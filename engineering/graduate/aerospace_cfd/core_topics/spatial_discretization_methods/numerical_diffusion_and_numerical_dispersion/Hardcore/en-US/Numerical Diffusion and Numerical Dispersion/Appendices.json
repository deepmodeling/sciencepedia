{
    "hands_on_practices": [
        {
            "introduction": "A primary goal in analyzing numerical schemes is to understand their inherent error mechanisms. Modified equation analysis is a powerful technique that reveals the continuous partial differential equation, including leading-order error terms, that a discrete scheme actually approximates. This practice  guides you through deriving the \"equivalent diffusion coefficient\" for both the classic first-order upwind scheme and the higher-order QUICK scheme, providing a concrete measure of their numerical dissipation and highlighting the fundamental trade-offs between accuracy, complexity, and monotonicity.",
            "id": "3981448",
            "problem": "Aerospace Computational Fluid Dynamics (CFD) simulations of convective transport frequently rely on discretizations of the one-dimensional linear advection equation, which is the fundamental model for passive scalar transport in a uniform flow. Consider the advection of a passive scalar field governed by the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ with constant convective speed $a  0$. Let the spatial domain be discretized on a uniform grid with spacing $\\Delta x$, and advance in time with an explicit forward Euler method with time step $\\Delta t$. Define the Courant–Friedrichs–Lewy (CFL) parameter as $C = a\\,\\Delta t/\\Delta x$.\n\nTwo spatial discretizations are to be compared:\n\n- The donor-cell upwind (first-order upwind) finite difference scheme for $a0$: the update at grid index $j$ is $u_j^{n+1} = u_j^n - C\\left(u_j^n - u_{j-1}^n\\right)$.\n\n- The Quadratic Upstream Interpolation for Convective Kinematics (QUICK) finite volume scheme for $a0$: the face values are obtained by quadratic upstream interpolation. On a uniform grid, the interpolated face value at $x_{j+1/2}$ is $u_{j+1/2} = -\\frac{1}{8}u_{j-1} + \\frac{3}{4}u_j + \\frac{3}{8}u_{j+1}$. The flux divergence for cell $j$ is then approximated by $\\left(a\\,u_{j+1/2} - a\\,u_{j-1/2}\\right)/\\Delta x$ and advanced in time using explicit forward Euler.\n\nUsing a modified equation analysis that starts from the continuous equation $u_t + a\\,u_x = 0$ and consistently expands the discrete scheme in Taylor series in both space and time, derive the leading-order equivalent diffusion coefficient $\\alpha_h$ in the formal modified equation $u_t + a\\,u_x = \\alpha_h\\,u_{xx} + \\text{(higher-order terms)}$ for each scheme in terms of $a$, $\\Delta x$, and $C$.\n\nThen, for $a = 250\\,\\text{m/s}$, $\\Delta x = 1.5\\times 10^{-3}\\,\\text{m}$, and $C = 0.70$, compute the numerical values of the two diffusion coefficients $\\alpha_h^{\\text{upwind}}$ and $\\alpha_h^{\\text{QUICK}}$. Express the final result as a row matrix $\\begin{pmatrix}\\alpha_h^{\\text{upwind}}  \\alpha_h^{\\text{QUICK}}\\end{pmatrix}$ in $\\text{m}^2/\\text{s}$, and round your answer to four significant figures.\n\nAdditionally, in your derivation, briefly explain the monotonicity and dispersion trade-offs implied by the signs and leading-order terms of the modified equation for the two schemes, but do not include this discussion in the final numerical answer.",
            "solution": "The problem requires the derivation of the leading-order equivalent diffusion coefficient, $\\alpha_h$, for the first-order upwind scheme and the QUICK scheme when applied to the one-dimensional linear advection equation, $u_t + a\\,u_x = 0$, with a forward Euler time-stepping method. This is achieved through a modified equation analysis, which involves performing Taylor series expansions of the discrete scheme to find the continuous partial differential equation that it represents more accurately.\n\nThe core of the analysis relies on the Taylor series expansions for a function $u(x, t)$ around the point $(x_j, t_n)$:\n$u_j^{n+1} = u(x_j, t_n+\\Delta t) = u_j^n + \\Delta t \\left(\\frac{\\partial u}{\\partial t}\\right)_j^n + \\frac{(\\Delta t)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial t^2}\\right)_j^n + \\frac{(\\Delta t)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial t^3}\\right)_j^n + \\dots$\n$u_{j\\pm 1}^n = u(x_j\\pm\\Delta x, t_n) = u_j^n \\pm \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_j^n + \\frac{(\\Delta x)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_j^n \\pm \\frac{(\\Delta x)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial x^3}\\right)_j^n + \\dots$\n\nTo ensure consistency, time derivatives are replaced by spatial derivatives using the original partial differential equation, $u_t = -a\\,u_x$.\n$\\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial}{\\partial t}(-a\\,u_x) = -a\\,\\frac{\\partial}{\\partial x}(u_t) = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_x) = a^2\\,\\frac{\\partial^2 u}{\\partial x^2}$.\n$\\frac{\\partial^3 u}{\\partial t^3} = \\frac{\\partial}{\\partial t}(a^2\\,u_{xx}) = a^2\\,\\frac{\\partial^2}{\\partial x^2}(u_t) = a^2\\,\\frac{\\partial^2}{\\partial x^2}(-a\\,u_x) = -a^3\\,\\frac{\\partial^3 u}{\\partial x^3}$.\nHereafter, derivatives are denoted by subscripts, e.g., $u_t$, $u_{xx}$. All expansions are about $(x_j, t_n)$.\n\n**1. First-Order Upwind (Donor-Cell) Scheme**\n\nThe discrete equation is given as $u_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n)$, where $C = a\\,\\Delta t / \\Delta x$.\nRearranging the scheme gives:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{C}{\\Delta t} (u_j^n - u_{j-1}^n) = - \\frac{a}{\\Delta x} (u_j^n - u_{j-1}^n) $$\nWe expand the left-hand side (LHS) and right-hand side (RHS) in Taylor series.\n\nLHS expansion:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{(\\Delta t)^2}{6} u_{ttt} + O((\\Delta t)^3) $$\nSubstituting the time derivatives with spatial derivatives:\n$$ \\text{LHS} = u_t + \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\frac{(\\Delta t)^2}{6} (-a^3 u_{xxx}) + \\dots = u_t + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a^3 (\\Delta t)^2}{6} u_{xxx} + \\dots $$\n\nRHS expansion:\n$$ -\\frac{a}{\\Delta x} (u_j^n - u_{j-1}^n) = -\\frac{a}{\\Delta x} \\left( u - \\left[ u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\dots \\right] \\right) $$\n$$ \\text{RHS} = -\\frac{a}{\\Delta x} \\left( \\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\dots \\right) = -a\\,u_x + \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx} + \\dots $$\n\nEquating the LHS and RHS:\n$$ u_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a\\,u_x + \\frac{a \\Delta x}{2} u_{xx} + \\dots $$\nRearranging to match the form $u_t + a\\,u_x = \\alpha_h u_{xx} + \\dots$:\n$$ u_t + a\\,u_x = \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.} $$\nThe coefficient of the $u_{xx}$ term is the equivalent diffusion coefficient $\\alpha_h^{\\text{upwind}}$. Factoring out $\\frac{a \\Delta x}{2}$ and using $C = a \\Delta t / \\Delta x$:\n$$ \\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2} \\left( 1 - \\frac{a \\Delta t}{\\Delta x} \\right) = \\frac{a \\Delta x}{2} (1 - C) $$\n\n**2. Quadratic Upstream Interpolation for Convective Kinematics (QUICK) Scheme**\n\nThe QUICK scheme with forward Euler time integration is:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{a}{\\Delta x} (u_{j+1/2} - u_{j-1/2}) $$\nThe face values are given by:\n$u_{j+1/2} = -\\frac{1}{8}u_{j-1} + \\frac{3}{4}u_j + \\frac{3}{8}u_{j+1}$\n$u_{j-1/2} = -\\frac{1}{8}u_{j-2} + \\frac{3}{4}u_{j-1} + \\frac{3}{8}u_{j}$\n\nFirst, we find the Taylor expansion for the flux difference term $u_{j+1/2} - u_{j-1/2}$:\n$$ u_{j+1/2} - u_{j-1/2} = \\frac{1}{8}u_{j-2} - \\left(\\frac{1}{8}+\\frac{3}{4}\\right)u_{j-1} + \\left(\\frac{3}{4}-\\frac{3}{8}\\right)u_j + \\frac{3}{8}u_{j+1} $$\n$$ u_{j+1/2} - u_{j-1/2} = \\frac{1}{8}u_{j-2} - \\frac{7}{8}u_{j-1} + \\frac{3}{8}u_j + \\frac{3}{8}u_{j+1} $$\nExpanding each term around $x_j$ and collecting coefficients of derivatives:\nCoefficient of $u$: $\\frac{1}{8} - \\frac{7}{8} + \\frac{3}{8} + \\frac{3}{8} = 0$.\nCoefficient of $u_x$: $\\Delta x \\left[ \\frac{1}{8}(-2) - \\frac{7}{8}(-1) + \\frac{3}{8}(0) + \\frac{3}{8}(1) \\right] = \\Delta x \\left( \\frac{-2+7+3}{8} \\right) = \\Delta x$.\nThe QUICK spatial discretization is third-order accurate, so the $u_{xx}$ term must vanish. Let's verify:\nCoefficient of $u_{xx}$: $(\\Delta x)^2 \\left[ \\frac{1}{8}\\frac{(-2)^2}{2} - \\frac{7}{8}\\frac{(-1)^2}{2} + \\frac{3}{8}(0) + \\frac{3}{8}\\frac{(1)^2}{2} \\right] = (\\Delta x)^2 \\left[ \\frac{1}{8}(2) - \\frac{7}{8}(\\frac{1}{2}) + \\frac{3}{8}(\\frac{1}{2}) \\right] = (\\Delta x)^2 \\left( \\frac{4}{16} - \\frac{7}{16} + \\frac{3}{16} \\right) = 0$.\nCoefficient of $u_{xxx}$: $(\\Delta x)^3 \\left[ \\frac{1}{8}\\frac{(-2)^3}{6} - \\frac{7}{8}\\frac{(-1)^3}{6} + \\frac{3}{8}(0) + \\frac{3}{8}\\frac{(1)^3}{6} \\right] = (\\Delta x)^3 \\left[ \\frac{-8}{48} - \\frac{-7}{48} + \\frac{3}{48} \\right] = (\\Delta x)^3 \\left( \\frac{-8+7+3}{48} \\right) = \\frac{2}{48}(\\Delta x)^3 = \\frac{1}{24}(\\Delta x)^3$. There seems to be a mistake in the original calculation.\nLet's re-calculate $u_{xxx}$ coefficient for $u_{j+1/2}-u_{j-1/2}$.\n$u_{j-2}$: $u_j - 2\\Delta x u_x + 2(\\Delta x)^2 u_{xx} - \\frac{4}{3}(\\Delta x)^3 u_{xxx} + \\dots$\n$u_{j-1}$: $u_j - \\Delta x u_x + \\frac{1}{2}(\\Delta x)^2 u_{xx} - \\frac{1}{6}(\\Delta x)^3 u_{xxx} + \\dots$\n$u_{j+1}$: $u_j + \\Delta x u_x + \\frac{1}{2}(\\Delta x)^2 u_{xx} + \\frac{1}{6}(\\Delta x)^3 u_{xxx} + \\dots$\nCoefficient of $u_{xxx}$: $(\\Delta x)^3 \\left[ \\frac{1}{8}(-\\frac{4}{3}) - \\frac{7}{8}(-\\frac{1}{6}) + \\frac{3}{8}(0) + \\frac{3}{8}(\\frac{1}{6}) \\right] = (\\Delta x)^3 \\left( -\\frac{4}{24} + \\frac{7}{48} + \\frac{3}{48} \\right) = (\\Delta x)^3 \\left( \\frac{-8+7+3}{48} \\right) = \\frac{2}{48}(\\Delta x)^3 = \\frac{1}{24}(\\Delta x)^3$.\nThe original calculation yielded $\\frac{1}{12}(\\Delta x)^3$. Let's re-check the original.\n`Coefficient of u_xxx: (Δx)³ ( (1/8)(-4/3) - (7/8)(-1/6) + (3/8)(1/6) ) = (Δx)³ ( (-8+7+3)/24 ) = 2/24 (Δx)³ = 1/12 (Δx)³`. Ah, the common denominator is 24, but `7/8*(-1/6)` is `-7/48`. The original calculation had an error. It should be `(Δx)³ ( (-8/48) + (7/48) + (3/48) ) = 2/48 (Δx)³`. So the spatial flux term is ` -a u_x - a(Δx)²/24 u_xxx + ...`.\nThis modifies the modified equation for QUICK to:\n$$ u_t + a\\,u_x = - \\frac{a^2 \\Delta t}{2} u_{xx} + \\left(\\frac{a^3 (\\Delta t)^2}{6} - \\frac{a(\\Delta x)^2}{24}\\right) u_{xxx} + \\text{H.O.T.} $$\nThe leading-order error term is still the second-derivative term. The diffusion coefficient is unchanged. So the final answer is still correct, but the derivation had an error in the $u_{xxx}$ coefficient. I will correct this derivation.\n\nThus, the spatial flux term expands to:\n$$ -\\frac{a}{\\Delta x}(u_{j+1/2} - u_{j-1/2}) = -\\frac{a}{\\Delta x}\\left( \\Delta x u_x + \\frac{(\\Delta x)^3}{24}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a(\\Delta x)^2}{24}u_{xxx} + \\dots $$\nThe LHS is the same as for the upwind scheme: $u_t + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a^3 (\\Delta t)^2}{6} u_{xxx} + \\dots$.\n\nEquating LHS and RHS for the QUICK scheme:\n$$ u_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a u_x - \\frac{a(\\Delta x)^2}{24}u_{xxx} + \\dots $$\nRearranging gives the modified equation:\n$$ u_t + a\\,u_x = - \\frac{a^2 \\Delta t}{2} u_{xx} + \\left(\\frac{a^3 (\\Delta t)^2}{6} - \\frac{a(\\Delta x)^2}{24}\\right) u_{xxx} + \\text{H.O.T.} $$\nThe leading-order error term is the second-derivative term introduced by the first-order time integration. The equivalent diffusion coefficient is:\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a^2 \\Delta t}{2} $$\nExpressing this in terms of $C = a \\Delta t / \\Delta x$:\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x}{2} \\left( \\frac{a \\Delta t}{\\Delta x} \\right) = - \\frac{a \\Delta x C}{2} $$\n\n**Discussion on Monotonicity and Dispersion**\n\nThe leading error term in the modified equation, a second-order spatial derivative term, governs the numerical dissipation or diffusion of the scheme.\n- For the **first-order upwind scheme**, $\\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2}(1 - C)$. For a stable explicit scheme, the CFL number $C$ must be in the range $0 \\le C \\le 1$. In this range, $\\alpha_h^{\\text{upwind}} \\ge 0$. A positive diffusion coefficient corresponds to numerical dissipation, which has the effect of smearing sharp gradients in the solution. This property ensures that the scheme is monotonic (does not create new extrema or oscillations), but at the cost of accuracy, as it introduces excessive diffusion.\n- For the **QUICK scheme**, $\\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x C}{2}$. Since $a  0$, $\\Delta x  0$, and typically $C  0$, the diffusion coefficient $\\alpha_h^{\\text{QUICK}}$ is negative. This corresponds to anti-diffusion, which can artificially steepen gradients and, more importantly, leads to non-physical oscillations (wiggles) near discontinuities or sharp gradients. This loss of monotonicity is a typical trade-off for achieving higher-order accuracy. While the spatial discretization of QUICK is third-order (leading to a smaller third-order dispersion error term compared to upwind), its combination with forward Euler time-stepping makes the scheme non-monotonic.\n\nThe third-order derivative term in the modified equation governs numerical dispersion, which causes different wave components of the solution to propagate at incorrect, wavenumber-dependent speeds, leading to a distortion of the solution profile. The trade-off is clear: the upwind scheme is overly diffusive but monotonic, while the QUICK scheme is much less diffusive (in fact, anti-diffusive), has smaller dispersion errors from its spatial part, but is not monotonic due to the combination with forward Euler time integration.\n\n**3. Numerical Calculation**\n\nGiven the values: $a = 250\\,\\text{m/s}$, $\\Delta x = 1.5 \\times 10^{-3}\\,\\text{m}$, and $C = 0.70$.\nFirst, we compute the product $a \\Delta x$:\n$$ a \\Delta x = (250) \\times (1.5 \\times 10^{-3}) = 0.375\\,\\text{m}^2/\\text{s} $$\n\nNow, we compute the two diffusion coefficients:\nFor the upwind scheme:\n$$ \\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2}(1 - C) = \\frac{0.375}{2}(1 - 0.70) = 0.1875 \\times 0.30 = 0.05625\\,\\text{m}^2/\\text{s} $$\nFor the QUICK scheme:\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x C}{2} = - \\frac{0.375 \\times 0.70}{2} = - \\frac{0.2625}{2} = -0.13125\\,\\text{m}^2/\\text{s} $$\n\nThe problem asks for the results to be rounded to four significant figures.\n$\\alpha_h^{\\text{upwind}} = 0.05625$ (This value has exactly four significant figures).\n$\\alpha_h^{\\text{QUICK}} = -0.13125 \\approx -0.1313$ (Rounding to four significant figures).\n\nThe final answer is to be presented as a row matrix $\\begin{pmatrix}\\alpha_h^{\\text{upwind}}  \\alpha_h^{\\text{QUICK}}\\end{pmatrix}$.\n$$ \\begin{pmatrix} 0.05625  -0.1313 \\end{pmatrix} $$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.05625  -0.1313 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Beyond the amplitude-damping effects of numerical diffusion, numerical dispersion distorts the solution by causing different wave components to travel at incorrect, wavenumber-dependent speeds. This leads to non-physical oscillations and a loss of solution fidelity. This analytical exercise  uses von Neumann analysis to isolate and quantify this phase error for the second-order Lax-Wendroff scheme. By determining the leading-order scaling of the phase error for long wavelengths, you will uncover a key characteristic of the scheme's accuracy and its dispersive nature.",
            "id": "3981497",
            "problem": "Consider the one-dimensional linear advection equation in the form $u_{t} - a\\,u_{x} = 0$ with constant advection speed $a0$, representative of passive-scalar transport in an aerospace Computational Fluid Dynamics (CFD) setting. Let the spatial grid be uniform with spacing $\\Delta x$ and time step $\\Delta t$, and define the Courant-Friedrichs-Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$. Assume $|\\nu|1$. Discretize the equation using the second-order Lax–Wendroff scheme constructed from a Taylor expansion in time and centered differences in space:\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right).\n$$\nPerform a von Neumann (Fourier) analysis by considering a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,j\\,\\theta\\right)$, where $\\theta = k\\,\\Delta x$ is the nondimensional wavenumber associated with the physical wavenumber $k$ and grid spacing $\\Delta x$. Let $G(\\theta)$ be the resulting complex amplification factor for one time step. Define the per–time-step phase error as\n$$\n\\phi_{\\mathrm{err}}(\\theta) = k\\,a\\,\\Delta t - \\arg\\!\\big(G(\\theta)\\big),\n$$\nand assume $\\theta$ is measured in radians. Starting from the governing equation and the stated discretization, derive $G(\\theta)$ and determine the leading-order scaling of $\\phi_{\\mathrm{err}}(\\theta)$ for small $\\theta$ (i.e., $\\theta \\to 0$), retaining the first nonzero term in the asymptotic expansion. Express your final answer as a single closed-form analytic expression in terms of $\\nu$ and $\\theta$.",
            "solution": "The objective is to determine the leading-order scaling of the per–time-step phase error, $\\phi_{\\mathrm{err}}(\\theta)$, for the second-order Lax–Wendroff scheme applied to the linear advection equation $u_t - a u_x = 0$, as the nondimensional wavenumber $\\theta$ approaches zero.\n\nFirst, we derive the amplification factor $G(\\theta)$ of the numerical scheme. The given scheme is:\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\nUsing the definition of the CFL number, $\\nu = a\\,\\Delta t/\\Delta x$, the scheme can be written as:\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{\\nu}{2}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\nWe perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$, where $\\theta = k\\,\\Delta x$. At the next time step, $u_{j}^{n+1} = G(\\theta)u_{j}^{n}$. Substituting these expressions into the numerical scheme gives:\n$$\nG(\\theta)\\,u_{j}^{n} = u_{j}^{n} + \\frac{\\nu}{2}\\left(u_{j}^{n}\\,e^{i\\,\\theta}-u_{j}^{n}\\,e^{-i\\,\\theta}\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j}^{n}\\,e^{i\\,\\theta}-2\\,u_{j}^{n}+u_{j}^{n}\\,e^{-i\\,\\theta}\\right)\n$$\nDividing by the common factor $u_{j}^{n}$ and using Euler's identities, $\\exp(i\\,\\theta)-\\exp(-i\\,\\theta) = 2\\,i\\,\\sin(\\theta)$ and $\\exp(i\\,\\theta)+\\exp(-i\\,\\theta) = 2\\,\\cos(\\theta)$, we simplify $G(\\theta)$:\n$$\nG(\\theta) = 1 + \\frac{\\nu}{2}\\left(2\\,i\\,\\sin(\\theta)\\right) + \\frac{\\nu^{2}}{2}\\left(2\\,\\cos(\\theta)-2\\right)\n$$\n$$\nG(\\theta) = 1 + i\\,\\nu\\,\\sin(\\theta) + \\nu^{2}\\left(\\cos(\\theta)-1\\right)\n$$\nThe argument of the amplification factor is $\\arg(G(\\theta)) = \\arctan\\left(\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))}\\right)$.\nTo find the leading-order behavior for small $\\theta$ ($\\theta \\to 0$), we use Taylor series expansions:\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^{3}}{6} + O(\\theta^{5})\n$$\n$$\n\\cos(\\theta) = 1 - \\frac{\\theta^{2}}{2} + O(\\theta^{4}) \\implies \\cos(\\theta)-1 = -\\frac{\\theta^{2}}{2} + O(\\theta^{4})\n$$\nSubstituting these into the real and imaginary parts of $G(\\theta)$:\n$$\n\\mathrm{Im}(G(\\theta)) = \\nu\\left(\\theta - \\frac{\\theta^{3}}{6} + O(\\theta^{5})\\right)\n$$\n$$\n\\mathrm{Re}(G(\\theta)) = 1 + \\nu^{2}\\left(-\\frac{\\theta^{2}}{2} + O(\\theta^{4})\\right) = 1 - \\frac{\\nu^{2}\\,\\theta^{2}}{2} + O(\\theta^{4})\n$$\nThe argument of the $\\arctan$ function becomes:\n$$\n\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))} = \\frac{\\nu\\,\\theta - \\frac{\\nu\\,\\theta^{3}}{6} + O(\\theta^{5})}{1 - \\frac{\\nu^{2}\\,\\theta^{2}}{2} + O(\\theta^{4})}\n$$\nUsing the geometric series expansion $(1-z)^{-1} = 1+z+O(z^{2})$ with $z=\\frac{\\nu^{2}\\,\\theta^{2}}{2}$:\n$$\n\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))} = \\left(\\nu\\,\\theta - \\frac{\\nu\\,\\theta^{3}}{6}\\right)\\left(1 + \\frac{\\nu^{2}\\,\\theta^{2}}{2}\\right) + O(\\theta^{5}) = \\nu\\,\\theta + \\left(\\frac{3\\,\\nu^{3}-\\nu}{6}\\right)\\theta^{3} + O(\\theta^{5})\n$$\nLet this expression be $X$. For small $X$, the Taylor expansion of $\\arctan(X)$ is $X - \\frac{X^{3}}{3} + O(X^{5})$.\n$$\n\\arg(G(\\theta)) = \\left(\\nu\\,\\theta + \\frac{\\nu(3\\,\\nu^{2}-1)}{6}\\theta^{3}\\right) - \\frac{(\\nu\\,\\theta)^{3}}{3} + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta + \\frac{3\\,\\nu^{3}-\\nu-2\\,\\nu^{3}}{6}\\theta^{3} + O(\\theta^{5}) = \\nu\\,\\theta + \\frac{\\nu^{3}-\\nu}{6}\\theta^{3} + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta - \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} + O(\\theta^{5})\n$$\nThe phase error is defined as $\\phi_{\\mathrm{err}}(\\theta) = k\\,a\\,\\Delta t - \\arg(G(\\theta))$. The term $k\\,a\\,\\Delta t$ represents the phase shift of the exact solution over one time step. For the governing equation $u_t - a u_x = 0$, a Fourier mode has angular frequency $\\omega = ak$. Thus, the exact phase shift is $\\omega \\Delta t = ak\\Delta t$. We rewrite this using nondimensional parameters:\n$$\nk\\,a\\,\\Delta t = (k\\,\\Delta x)\\left(\\frac{a\\,\\Delta t}{\\Delta x}\\right) = \\theta\\,\\nu\n$$\nNow, we compute the phase error:\n$$\n\\phi_{\\mathrm{err}}(\\theta) = \\nu\\,\\theta - \\left(\\nu\\,\\theta - \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} + O(\\theta^{5})\\right)\n$$\n$$\n\\phi_{\\mathrm{err}}(\\theta) = \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} + O(\\theta^{5})\n$$\nThe leading-order term of the phase error for small $\\theta$ is the first nonzero term in this expansion.\n\nTherefore, the leading-order scaling of $\\phi_{\\mathrm{err}}(\\theta)$ is $\\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3}$. This cubic dependence on the wavenumber is characteristic of the dispersive error of a second-order accurate scheme like Lax-Wendroff.",
            "answer": "$$\n\\boxed{\\frac{\\nu(1-\\nu^2)}{6}\\theta^3}\n$$"
        },
        {
            "introduction": "Theoretical tools like von Neumann analysis provide invaluable predictions about a scheme's behavior, but it is essential to verify these predictions against the results of a computational simulation. This hands-on coding practice  bridges the gap between theory and application by using the method of manufactured solutions. You will implement both first-order upwind and Lax-Wendroff schemes, run a numerical experiment with a simple sine wave, and use the Fast Fourier Transform (FFT) to measure the actual dissipation rate from the simulation data, confirming that it matches the theoretical prediction from the scheme's amplification factor.",
            "id": "3981445",
            "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ on a periodic domain of length $L$, where $x$ is in meters and $t$ is in seconds, and $a$ is the constant advection speed in meters per second. Use the manufactured solution $u(x,t) = \\sin(\\kappa x - \\omega t)$, where $\\kappa$ is the physical wavenumber in radians per meter and $\\omega$ is the temporal frequency in radians per second, consistent with the governing equation. Assume angles are measured in radians.\n\nYou will analyze two explicit, linear, finite difference schemes on a uniform grid with $N$ points and grid spacing $\\Delta x = L/N$, with time step $\\Delta t$ chosen to achieve a specified Courant–Friedrichs–Lewy (CFL) number $\\sigma = a\\Delta t/\\Delta x$:\n- A first-order upwind scheme for $a  0$.\n- A second-order Lax–Wendroff scheme.\n\nUsing a discrete realization of $u(x,t)$ on the grid, do the following for a single time step starting from $t=0$:\n1. Initialize the wave $u_j^0 = \\sin\\left(\\frac{2\\pi m}{L}\\,x_j\\right)$ with $x_j = j\\,\\Delta x$ and integer mode count $m$ (number of complete cycles over the domain), which implies the physical wavenumber $\\kappa = \\frac{2\\pi m}{L}$ and manufactured angular frequency $\\omega = a\\,\\kappa$.\n2. Advance the solution by one time step using the specified numerical scheme to obtain $u_j^1$ with periodic boundary conditions.\n3. Estimate the numerical dissipation rate per time step by measuring the amplitude decay of the Fourier component at mode $m$. Define the discrete Fourier transform (using any consistent normalization) of $u_j^n$ as $\\hat{u}^n(k)$, and compute the measured logarithmic amplitude change per step as $\\Lambda_{\\text{meas}} = \\log\\left(\\left|\\hat{u}^1(m)\\right|/\\left|\\hat{u}^0(m)\\right|\\right)$.\n4. Let $G(\\theta)$ denote the von Neumann amplification factor of the chosen scheme for the Fourier mode, where $\\theta = \\kappa\\,\\Delta x = \\frac{2\\pi m}{N}$. Compute the theoretical logarithmic amplitude change per step as $\\Lambda_{\\text{theory}} = \\Re\\left[\\log G(\\theta)\\right]$.\n5. Report the absolute error $E = \\left|\\Lambda_{\\text{meas}} - \\Lambda_{\\text{theory}}\\right|$ for each test case.\n\nYour program must implement both schemes, perform the one-step update for each test parameter set, estimate $\\Lambda_{\\text{meas}}$ via the discrete Fourier transform at mode $m$, compute $\\Lambda_{\\text{theory}}$ from the scheme’s amplification factor obtained by von Neumann analysis, and output the absolute error $E$ for each case.\n\nUse the following test suite, which varies scheme type, grid resolution, wavenumber, and Courant number to probe typical behavior, near-stability limits, and high-wavenumber edges:\n\n- Test case $1$: first-order upwind, $N=128$, $L=2\\pi$, $m=4$, $a=1$, $\\sigma=0.5$.\n- Test case $2$: first-order upwind, $N=64$, $L=2\\pi$, $m=16$, $a=1$, $\\sigma=0.5$.\n- Test case $3$: first-order upwind, $N=128$, $L=2\\pi$, $m=4$, $a=1$, $\\sigma=0.95$.\n- Test case $4$: Lax–Wendroff, $N=128$, $L=2\\pi$, $m=4$, $a=1$, $\\sigma=0.5$.\n- Test case $5$: Lax–Wendroff, $N=64$, $L=2\\pi$, $m=16$, $a=1$, $\\sigma=0.5$.\n- Test case $6$: Lax–Wendroff, $N=128$, $L=2\\pi$, $m=4$, $a=1$, $\\sigma=0.95$.\n\nAll angles must be in radians. The final outputs are dimensionless real numbers.\n\nFinal output format: Your program should produce a single line of output containing the absolute errors for all six test cases as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6\\right]$). Each $\\text{result}_i$ must be a floating-point number.",
            "solution": "The problem requires a validation of the numerical dissipation predicted by von Neumann stability analysis against measurements from a direct numerical simulation for two finite difference schemes. We will analyze the first-order upwind scheme and the second-order Lax-Wendroff scheme for the linear advection equation, $u_t + a\\,u_x = 0$. The core of the task is to confirm that for a linear, constant-coefficient partial differential equation on a periodic domain, the amplification factor $G$ derived from von Neumann analysis precisely describes the evolution of discrete Fourier modes.\n\nFirst, we establish the theoretical framework using von Neumann analysis. This method assumes a single Fourier mode is a solution to the discretized equation, in the form $u_j^n = G^n e^{i j \\theta}$, where $u_j^n$ is the numerical solution at grid point $j$ and time level $n$, $\\theta = \\kappa \\Delta x$ is the dimensionless wavenumber, and $G$ is the complex amplification factor per time step. The magnitude $|G(\\theta)|$ represents the change in amplitude of the mode, quantifying numerical dissipation (if $|G(\\theta)|1$) or amplification (if $|G(\\theta)|1$).\n\nThe two schemes to be analyzed are:\n1.  The first-order upwind scheme (for $a0$):\n    $$u_j^{n+1} = u_j^n - \\sigma(u_j^n - u_{j-1}^n)$$\n    where $\\sigma = a \\Delta t / \\Delta x$ is the Courant number. Substituting the Fourier mode $u_j^n = G^n e^{i j \\theta}$ yields:\n    $$G^{n+1} e^{i j \\theta} = G^n e^{i j \\theta} - \\sigma(G^n e^{i j \\theta} - G^n e^{i (j-1) \\theta})$$\n    Dividing by $G^n e^{i j \\theta}$ gives the amplification factor:\n    $$G_{\\text{upwind}}(\\theta) = 1 - \\sigma(1 - e^{-i\\theta})$$\n\n2.  The second-order Lax-Wendroff scheme:\n    $$u_j^{n+1} = u_j^n - \\frac{\\sigma}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\sigma^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n    Substituting the Fourier mode and using the identities $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$ leads to:\n    $$G_{\\text{LW}}(\\theta) = 1 - \\frac{\\sigma}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\sigma^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})$$\n    $$G_{\\text{LW}}(\\theta) = 1 - i\\sigma\\sin\\theta + \\sigma^2(\\cos\\theta - 1)$$\n\nFor a given mode with wavenumber parameter $\\theta = \\kappa \\Delta x = \\frac{2\\pi m}{N}$, the theoretical logarithmic amplitude change per step is $\\Lambda_{\\text{theory}} = \\Re[\\log G(\\theta)]$. Since for any complex number $z$, $\\log(z) = \\log|z| + i \\arg(z)$, the real part is simply the natural logarithm of its magnitude:\n$$\\Lambda_{\\text{theory}} = \\log|G(\\theta)|$$\n\nNext, we design the numerical experiment. We initialize a discrete grid $x_j = j \\Delta x = j (L/N)$ for $j=0, 1, \\dots, N-1$ with a pure sine wave, $u_j^0 = \\sin(\\kappa x_j)$, where $\\kappa = 2\\pi m/L$. This initial condition is a real-valued function, which can be expressed as a superposition of two complex exponential modes: $u_j^0 = \\frac{1}{2i}(e^{i\\kappa x_j} - e^{-i\\kappa x_j})$. These correspond to Fourier modes with indices $m$ and $-m$ (or $N-m$ in discrete Fourier space).\n\nThe solution is advanced by a single time step $\\Delta t = \\sigma \\Delta x / a$ to obtain $u_j^1$. This is done by applying the update rule for the specified scheme, using periodic boundary conditions such that indices are taken modulo $N$.\n\nTo measure the dissipation, we use the Discrete Fourier Transform (DFT), which decomposes the grid function into its constituent Fourier modes. Let $\\hat{u}^n(k)$ be the DFT of the solution $u_j^n$ at discrete wavenumber index $k$. For a linear scheme, the DFT coefficients evolve according to the amplification factor: $\\hat{u}^1(k) = G(\\theta_k)\\hat{u}^0(k)$, where $\\theta_k = 2\\pi k/N$. Therefore, we can measure the amplification factor's magnitude for mode $m$ directly from the numerical results:\n$$\\frac{|\\hat{u}^1(m)|}{|\\hat{u}^0(m)|} = |G(\\theta_m)|$$\nThe measured logarithmic amplitude change is then computed as:\n$$\\Lambda_{\\text{meas}} = \\log\\left(\\frac{|\\hat{u}^1(m)|}{|\\hat{u}^0(m)|}\\right)$$\n\nFinally, we compute the absolute error $E = |\\Lambda_{\\text{meas}} - \\Lambda_{\\text{theory}}|$. Because the relationship between the DFT and the von Neumann analysis is exact for this class of problems (linear, constant coefficients, periodic domain), this error is expected to be near machine floating-point precision. The algorithm is implemented in a Python script which iterates through the given test cases, computes $E$ for each, and reports the results. The implementation uses `NumPy` for efficient array operations and `SciPy`'s Fast Fourier Transform (`fft`) for the spectral analysis. Periodic boundary conditions are handled cleanly using array-rolling functions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between theoretical and measured numerical dissipation\n    for finite difference schemes applied to the linear advection equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (scheme, N, L, m, a, sigma)\n        ('upwind', 128, 2 * np.pi, 4, 1.0, 0.5),\n        ('upwind', 64, 2 * np.pi, 16, 1.0, 0.5),\n        ('upwind', 128, 2 * np.pi, 4, 1.0, 0.95),\n        ('lax-wendroff', 128, 2 * np.pi, 4, 1.0, 0.5),\n        ('lax-wendroff', 64, 2 * np.pi, 16, 1.0, 0.5),\n        ('lax-wendroff', 128, 2 * np.pi, 4, 1.0, 0.95),\n    ]\n\n    results = []\n    for case in test_cases:\n        scheme, N, L, m, a, sigma = case\n\n        # --- Theoretical Calculation ---\n        # Calculate derived parameters\n        dx = L / N\n        kappa = 2 * np.pi * m / L\n        theta = kappa * dx  # a.k.a. 2 * pi * m / N\n\n        # Calculate amplification factor G(theta)\n        if scheme == 'upwind':\n            G = 1 - sigma * (1 - np.exp(-1j * theta))\n        elif scheme == 'lax-wendroff':\n            G = 1 - 1j * sigma * np.sin(theta) + sigma**2 * (np.cos(theta) - 1)\n        else:\n            raise ValueError(\"Unknown scheme type\")\n\n        # Theoretical logarithmic amplitude change\n        # Re[log(G)] is equivalent to log|G|\n        lambda_theory = np.log(np.abs(G))\n\n        # --- Numerical Simulation and Measurement ---\n        # Set up grid and initial condition\n        x = np.arange(N) * dx\n        u0 = np.sin(kappa * x)\n\n        # Advance one time step with periodic boundary conditions\n        if scheme == 'upwind':\n            u0_jm1 = np.roll(u0, 1)\n            u1 = u0 - sigma * (u0 - u0_jm1)\n        elif scheme == 'lax-wendroff':\n            u0_jp1 = np.roll(u0, -1)\n            u0_jm1 = np.roll(u0, 1)\n            u1 = u0 - 0.5 * sigma * (u0_jp1 - u0_jm1) + \\\n                 0.5 * sigma**2 * (u0_jp1 - 2 * u0 + u0_jm1)\n\n        # Perform Discrete Fourier Transform (DFT)\n        u_hat0 = fft(u0)\n        u_hat1 = fft(u1)\n\n        # Get amplitude of mode m\n        amp0 = np.abs(u_hat0[m])\n        amp1 = np.abs(u_hat1[m])\n\n        # Measured logarithmic amplitude change\n        # A check for amp0 being non-zero is prudent in general,\n        # but not strictly necessary for the given test cases.\n        if amp0 > 1e-15:  # Use a small threshold for floating point robustness\n             lambda_meas = np.log(amp1 / amp0)\n        else:\n             # This case should not be reached with the problem's setup\n             lambda_meas = np.nan\n\n        # --- Error Calculation ---\n        error = np.abs(lambda_meas - lambda_theory)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}