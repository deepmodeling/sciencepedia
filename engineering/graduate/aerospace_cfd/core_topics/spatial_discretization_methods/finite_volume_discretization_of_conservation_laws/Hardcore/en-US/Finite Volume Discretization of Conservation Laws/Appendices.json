{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the finite volume method is the partitioning of the domain into discrete control volumes. Before applying conservation laws, we must first accurately describe the geometry of each cell. This exercise focuses on calculating the most fundamental geometric properties of a tetrahedral cell: its volume $V_i$ and the area vectors $\\mathbf{n}_{f} A_{f}$ for each face, which are critical for evaluating surface integrals via the divergence theorem. ",
            "id": "3958977",
            "problem": "In Computational Fluid Dynamics (CFD), face-normal area vectors and cell volumes provide the geometric closure needed by the finite volume discretization of conservation laws. Consider a tetrahedral control volume with vertex coordinates given in meters by\n$$\\mathbf{x}_{A} = (0,\\,0,\\,0),\\quad \\mathbf{x}_{B} = (1,\\,0,\\,0),\\quad \\mathbf{x}_{C} = (0,\\,2,\\,0),\\quad \\mathbf{x}_{D} = (0,\\,0,\\,3).$$\nStarting from geometric first principles and definitions that are consistent with conservation-law fluxes and the divergence theorem, compute:\n- the cell volume $V_{i}$,\n- the outward-pointing face-normal area vectors $\\mathbf{n}_{f} A_{f}$ for the four triangular faces. The faces are to be labeled as follows: the face opposite vertex $A$ is the triangle $(B,C,D)$, opposite $B$ is $(A,C,D)$, opposite $C$ is $(A,B,D)$, and opposite $D$ is $(A,B,C)$.\n\nUse the following orientation convention for outward direction: the outward normal on each face must point away from the cell centroid. Express the volume in $\\mathrm{m}^{3}$ and each area vector in $\\mathrm{m}^{2}$. Report your final result as a single row vector in the order\n$$ \\left[V_{i},\\; (\\mathbf{n}A)_{BCD,x},\\;(\\mathbf{n}A)_{BCD,y},\\;(\\mathbf{n}A)_{BCD,z},\\;(\\mathbf{n}A)_{ACD,x},\\;(\\mathbf{n}A)_{ACD,y},\\;(\\mathbf{n}A)_{ACD,z},\\;(\\mathbf{n}A)_{ABD,x},\\;(\\mathbf{n}A)_{ABD,y},\\;(\\mathbf{n}A)_{ABD,z},\\;(\\mathbf{n}A)_{ABC,x},\\;(\\mathbf{n}A)_{ABC,y},\\;(\\mathbf{n}A)_{ABC,z}\\right] $$\nRound each reported numerical entry to four significant figures.",
            "solution": "The user has provided a valid, well-posed problem in computational geometry as it applies to Computational Fluid Dynamics (CFD). The problem asks for the calculation of the volume and the outward-pointing face-normal area vectors for a given tetrahedral control volume.\n\nThe vertices of the tetrahedron are given as:\n$\\mathbf{x}_{A} = (0, 0, 0)$\n$\\mathbf{x}_{B} = (1, 0, 0)$\n$\\mathbf{x}_{C} = (0, 2, 0)$\n$\\mathbf{x}_{D} = (0, 0, 3)$\n\nThe solution proceeds in two main parts: the calculation of the cell volume $V_{i}$ and the calculation of the four face-normal area vectors $\\mathbf{S}_{f} = \\mathbf{n}_{f} A_{f}$.\n\nFirst, we compute the volume of the tetrahedron. The volume $V_i$ of a tetrahedron defined by vertices $A, B, C, D$ can be calculated using the scalar triple product of the vectors forming three of its edges originating from a common vertex. With vertex $A$ at the origin, we define the edge vectors:\n$\\mathbf{v}_{AB} = \\mathbf{x}_{B} - \\mathbf{x}_{A} = (1, 0, 0)$\n$\\mathbf{v}_{AC} = \\mathbf{x}_{C} - \\mathbf{x}_{A} = (0, 2, 0)$\n$\\mathbf{v}_{AD} = \\mathbf{x}_{D} - \\mathbf{x}_{A} = (0, 0, 3)$\n\nThe volume $V_{i}$ is given by $\\frac{1}{6}$ of the absolute value of the scalar triple product $(\\mathbf{v}_{AB} \\times \\mathbf{v}_{AC}) \\cdot \\mathbf{v}_{AD}$. This is equivalent to $\\frac{1}{6}$ of the absolute value of the determinant of the matrix formed by these vectors:\n$$V_{i} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\right| = \\frac{1}{6} |(1)(2)(3) - 0| = \\frac{6}{6} = 1$$\nThus, the volume of the cell is $V_{i} = 1\\; \\mathrm{m}^{3}$.\n\nNext, we compute the face-normal area vectors. The area vector $\\mathbf{S}$ for a triangular face defined by vertices $P_1, P_2, P_3$ (in that order) is given by the cross product:\n$$\\mathbf{S} = \\frac{1}{2} (\\mathbf{x}_{P_2} - \\mathbf{x}_{P_1}) \\times (\\mathbf{x}_{P_3} - \\mathbf{x}_{P_1})$$\nThe direction of this vector determines the normal. The problem requires that the normal vector points outward from the cell. To determine the outward direction, we first calculate the centroid of the tetrahedron, which is always located inside the volume. The centroid $\\mathbf{x}_{\\text{cent}}$ is the average of the vertex coordinates:\n$$\\mathbf{x}_{\\text{cent}} = \\frac{1}{4}(\\mathbf{x}_{A} + \\mathbf{x}_{B} + \\mathbf{x}_{C} + \\mathbf{x}_{D}) = \\frac{1}{4} \\left( (0,0,0) + (1,0,0) + (0,2,0) + (0,0,3) \\right) = \\frac{1}{4}(1, 2, 3) = (0.25, 0.5, 0.75)$$\nAn area vector $\\mathbf{S}_{f}$ is outward-pointing if the vector from the centroid to any point on the face, $\\mathbf{x}_{f} - \\mathbf{x}_{\\text{cent}}$, has a positive dot product with $\\mathbf{S}_{f}$. That is, $(\\mathbf{x}_{f} - \\mathbf{x}_{\\text{cent}}) \\cdot \\mathbf{S}_{f}  0$. If the dot product is negative, the calculated area vector must be reversed.\n\nWe now compute the area vector for each of the four faces.\n\nFace 1: BCD (opposite vertex A)\nVertices: $\\mathbf{x}_{B} = (1,0,0)$, $\\mathbf{x}_{C} = (0,2,0)$, $\\mathbf{x}_{D} = (0,0,3)$.\nLet's compute a candidate area vector $\\mathbf{S}'_{BCD}$ using the vertex order B, C, D:\n$$\\mathbf{S}'_{BCD} = \\frac{1}{2} (\\mathbf{x}_{C} - \\mathbf{x}_{B}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{B}) = \\frac{1}{2} (-1, 2, 0) \\times (-1, 0, 3)$$\n$$\\mathbf{S}'_{BCD} = \\frac{1}{2} \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ -1  2  0 \\\\ -1  0  3 \\end{pmatrix} = \\frac{1}{2} ( (2)(3)\\mathbf{i} - (-1)(3)\\mathbf{j} + (-1)(0 - 2)\\mathbf{k} ) = \\frac{1}{2}(6, 3, 2) = (3, 1.5, 1)$$\nTo check its orientation, we take the vector from the centroid to vertex B: $\\mathbf{x}_{B} - \\mathbf{x}_{\\text{cent}} = (1,0,0) - (0.25, 0.5, 0.75) = (0.75, -0.5, -0.75)$.\nThe dot product is $(\\mathbf{x}_{B} - \\mathbf{x}_{\\text{cent}}) \\cdot \\mathbf{S}'_{BCD} = (0.75)(3) + (-0.5)(1.5) + (-0.75)(1) = 2.25 - 0.75 - 0.75 = 0.75$.\nSince $0.75  0$, the vector is already outward-pointing. So, $(\\mathbf{n}A)_{BCD} = (3, 1.5, 1)$.\n\nFace 2: ACD (opposite vertex B)\nVertices: $\\mathbf{x}_{A} = (0,0,0)$, $\\mathbf{x}_{C} = (0,2,0)$, $\\mathbf{x}_{D} = (0,0,3)$.\n$$\\mathbf{S}'_{ACD} = \\frac{1}{2} (\\mathbf{x}_{C} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{A}) = \\frac{1}{2} (0, 2, 0) \\times (0, 0, 3) = \\frac{1}{2} (6, 0, 0) = (3, 0, 0)$$\nThis face lies on the plane $x=0$, while the centroid has an x-coordinate of $0.25$. An outward normal must point in the negative x-direction. Thus, the calculated vector is inward. We must reverse its sign.\n$(\\mathbf{n}A)_{ACD} = -(3, 0, 0) = (-3, 0, 0)$.\n\nFace 3: ABD (opposite vertex C)\nVertices: $\\mathbf{x}_{A} = (0,0,0)$, $\\mathbf{x}_{B} = (1,0,0)$, $\\mathbf{x}_{D} = (0,0,3)$.\n$$\\mathbf{S}'_{ABD} = \\frac{1}{2} (\\mathbf{x}_{B} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{A}) = \\frac{1}{2} (1, 0, 0) \\times (0, 0, 3) = \\frac{1}{2} (0, -3, 0) = (0, -1.5, 0)$$\nThis face lies on the plane $y=0$, while the centroid has a y-coordinate of $0.5$. An outward normal must point in the negative y-direction. The calculated vector is already pointing this way, so it is outward.\n$(\\mathbf{n}A)_{ABD} = (0, -1.5, 0)$.\n\nFace 4: ABC (opposite vertex D)\nVertices: $\\mathbf{x}_{A} = (0,0,0)$, $\\mathbf{x}_{B} = (1,0,0)$, $\\mathbf{x}_{C} = (0,2,0)$.\n$$\\mathbf{S}'_{ABC} = \\frac{1}{2} (\\mathbf{x}_{B} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{C} - \\mathbf{x}_{A}) = \\frac{1}{2} (1, 0, 0) \\times (0, 2, 0) = \\frac{1}{2} (0, 0, 2) = (0, 0, 1)$$\nThis face lies on the plane $z=0$, while the centroid has a z-coordinate of $0.75$. An outward normal must point in the negative z-direction. The calculated vector is inward, so we reverse its sign.\n$(\\mathbf{n}A)_{ABC} = -(0, 0, 1) = (0, 0, -1)$.\n\nAs a verification, the sum of all outward-pointing area vectors for a closed volume must be the zero vector, which is a requirement of the divergence theorem known as geometric closure.\n$$\\sum_{f} \\mathbf{S}_{f} = (3, 1.5, 1) + (-3, 0, 0) + (0, -1.5, 0) + (0, 0, -1)$$\n$$\\sum_{f} \\mathbf{S}_{f} = (3-3, 1.5-1.5, 1-1) = (0, 0, 0)$$\nThe condition is satisfied, confirming the correctness of the vectors.\n\nFinally, we assemble the results into a single row vector as requested, rounding each entry to four significant figures. For the integer and half-integer results obtained, this is equivalent to formatting them to three decimal places.\n\n$V_{i} = 1.000$\n$(\\mathbf{n}A)_{BCD} = (3.000, 1.500, 1.000)$\n$(\\mathbf{n}A)_{ACD} = (-3.000, 0.000, 0.000)$\n$(\\mathbf{n}A)_{ABD} = (0.000, -1.500, 0.000)$\n$(\\mathbf{n}A)_{ABC} = (0.000, 0.000, -1.000)$\n\nThe final vector ordered as requested is:\n$[1.000, 3.000, 1.500, 1.000, -3.000, 0.000, 0.000, 0.000, -1.500, 0.000, 0.000, 0.000, -1.000]$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.000  3.000  1.500  1.000  -3.000  0.000  0.000  0.000  -1.500  0.000  0.000  0.000  -1.000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Once the control volume is defined, we can apply the integral form of a conservation law, which states that the change of a quantity within the volume is balanced by sources inside and fluxes across its boundary. This problem provides a direct application of this principle. By integrating given boundary fluxes and a volumetric source term over a simple rectangular cell, you will compute the net rate of change of the conserved quantity, reinforcing the core concept of balance that underpins all finite volume methods. ",
            "id": "3958990",
            "problem": "Consider the integral conservation of a transported scalar density $U$ in the context of Computational Fluid Dynamics (CFD), over a stationary rectangular control volume $\\Omega = [0,L_x] \\times [0,L_y] \\times [0,L_z]$ with $L_x = 2\\,\\mathrm{m}$, $L_y = 1\\,\\mathrm{m}$, and $L_z = 0.5\\,\\mathrm{m}$. The outward unit normal is denoted by $\\mathbf{n}$. On each boundary face of $\\Omega$, the outward normal flux $\\mathbf{F}\\cdot\\mathbf{n}$ is prescribed in $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ as follows:\n- On $x=0$: $\\mathbf{F}\\cdot\\mathbf{n}(x=0,y,z) = 1 + 2y + z$ for $(y,z) \\in [0,L_y] \\times [0,L_z]$.\n- On $x=L_x$: $\\mathbf{F}\\cdot\\mathbf{n}(x=L_x,y,z) = 0.5 + y - 3z$ for $(y,z) \\in [0,L_y] \\times [0,L_z]$.\n- On $y=0$: $\\mathbf{F}\\cdot\\mathbf{n}(y=0,x,z) = -0.25 + 0.5x + z$ for $(x,z) \\in [0,L_x] \\times [0,L_z]$.\n- On $y=L_y$: $\\mathbf{F}\\cdot\\mathbf{n}(y=L_y,x,z) = 0.75 - x + 2z$ for $(x,z) \\in [0,L_x] \\times [0,L_z]$.\n- On $z=0$: $\\mathbf{F}\\cdot\\mathbf{n}(z=0,x,y) = 0.1 + x + y$ for $(x,y) \\in [0,L_x] \\times [0,L_y]$.\n- On $z=L_z$: $\\mathbf{F}\\cdot\\mathbf{n}(z=L_z,x,y) = -0.6 + 2x - y$ for $(x,y) \\in [0,L_x] \\times [0,L_y]$.\n\nInside the control volume, the volumetric source $S$ is specified in $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$ as $S(x,y,z) = 1 + x - 2y + 3z$ for $(x,y,z) \\in \\Omega$.\n\nStarting from first principles of conservation and without invoking any pre-stated target formulas, derive the expression for the rate of change $\\frac{d}{dt}\\int_{\\Omega} U\\,dV$ based on the specified boundary fluxes and volumetric source. Evaluate all required surface and volume integrals exactly, and compute the resulting value of $\\frac{d}{dt}\\int_{\\Omega} U\\,dV$. Express the final rate in $\\mathrm{kg\\,s^{-1}}$ and round your answer to four significant figures.\n\nAdditionally, verify conservation in the special case where $S=0$ and the net outward boundary flux satisfies $\\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA = 0$, by determining the corresponding value of $\\frac{d}{dt}\\int_{\\Omega} U\\,dV$ in that case. Provide both the computed rate for the given data and the verification value as your final answer.",
            "solution": "The problem asks for the time rate of change of the total amount of a scalar quantity $U$ within a fixed control volume $\\Omega$, based on specified source terms and boundary fluxes.\n\nThe first principle governing this process is the integral form of a general conservation law, often referred to as the Reynolds transport theorem for a fixed volume. This principle states that the time rate of change of the total amount of a quantity within a control volume is equal to the rate at which the quantity is generated by sources within the volume, minus the net rate at which the quantity flows out across the control volume's boundary.\n\nLet the scalar density be $U$ (in units of $\\mathrm{kg\\,m^{-3}}$), the control volume be $\\Omega$, the volumetric source term be $S$ (in $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$), and the flux vector be $\\mathbf{F}$ (in $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$). The integral conservation law is expressed as:\n$$\n\\frac{d}{dt}\\int_{\\Omega} U\\,dV = \\int_{\\Omega} S\\,dV - \\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA\n$$\nwhere $\\partial\\Omega$ is the boundary of the control volume and $\\mathbf{n}$ is the outward unit normal vector on the boundary. The term on the left, $\\frac{d}{dt}\\int_{\\Omega} U\\,dV$, represents the rate of change of the total mass of the scalar in $\\Omega$. The first term on the right, $\\int_{\\Omega} S\\,dV$, is the total rate of production from sources inside $\\Omega$. The second term on the right, $\\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA$, is the net outward flux of the scalar across the boundary $\\partial\\Omega$.\n\nTo find the value of $\\frac{d}{dt}\\int_{\\Omega} U\\,dV$, we must evaluate the two integrals on the right-hand side using the given data.\n\nThe control volume is a rectangular box $\\Omega = [0,L_x] \\times [0,L_y] \\times [0,L_z]$ with dimensions $L_x = 2\\,\\mathrm{m}$, $L_y = 1\\,\\mathrm{m}$, and $L_z = 0.5\\,\\mathrm{m}$.\n\nFirst, we calculate the total source term, $I_S = \\int_{\\Omega} S\\,dV$. The source function is given as $S(x,y,z) = 1 + x - 2y + 3z$.\n$$\nI_S = \\int_{0}^{L_z} \\int_{0}^{L_y} \\int_{0}^{L_x} (1 + x - 2y + 3z) \\,dx\\,dy\\,dz\n$$\nWe integrate with respect to $x$ first:\n$$\n\\int_{0}^{L_x} (1 + x - 2y + 3z) \\,dx = \\left[x + \\frac{x^2}{2} - 2yx + 3zx\\right]_0^{L_x} = L_x + \\frac{L_x^2}{2} - 2yL_x + 3zL_x\n$$\nSubstituting $L_x = 2$:\n$$\n2 + \\frac{2^2}{2} - 2y(2) + 3z(2) = 2 + 2 - 4y + 6z = 4 - 4y + 6z\n$$\nNext, we integrate this result with respect to $y$:\n$$\n\\int_{0}^{L_y} (4 - 4y + 6z) \\,dy = \\left[4y - 2y^2 + 6zy\\right]_0^{L_y}\n$$\nSubstituting $L_y = 1$:\n$$\n4(1) - 2(1)^2 + 6z(1) = 4 - 2 + 6z = 2 + 6z\n$$\nFinally, we integrate with respect to $z$:\n$$\nI_S = \\int_{0}^{L_z} (2 + 6z) \\,dz = \\left[2z + 3z^2\\right]_0^{L_z}\n$$\nSubstituting $L_z = 0.5$:\n$$\nI_S = 2(0.5) + 3(0.5)^2 = 1 + 3(0.25) = 1 + 0.75 = 1.75\\,\\mathrm{kg\\,s^{-1}}\n$$\n\nSecond, we calculate the net outward flux, $I_F = \\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA$. The boundary $\\partial\\Omega$ consists of six faces. We must sum the flux integrals over all faces. The problem provides the outward normal flux $\\mathbf{F}\\cdot\\mathbf{n}$ for each face.\n\n1.  Face at $x=0$: $\\int_0^{L_z}\\int_0^{L_y} (1+2y+z)\\,dy\\,dz = \\int_0^{0.5} [y+y^2+zy]_0^1\\,dz = \\int_0^{0.5} (1+1+z)\\,dz = \\int_0^{0.5} (2+z)\\,dz = [2z+\\frac{z^2}{2}]_0^{0.5} = 2(0.5)+\\frac{(0.5)^2}{2} = 1 + \\frac{0.25}{2} = 1.125$.\n2.  Face at $x=L_x$: $\\int_0^{L_z}\\int_0^{L_y} (0.5+y-3z)\\,dy\\,dz = \\int_0^{0.5} [0.5y+\\frac{y^2}{2}-3zy]_0^1\\,dz = \\int_0^{0.5} (0.5+0.5-3z)\\,dz = \\int_0^{0.5} (1-3z)\\,dz = [z-\\frac{3z^2}{2}]_0^{0.5} = 0.5 - \\frac{3(0.5)^2}{2} = 0.5 - \\frac{0.75}{2} = 0.5 - 0.375 = 0.125$.\n3.  Face at $y=0$: $\\int_0^{L_z}\\int_0^{L_x} (-0.25+0.5x+z)\\,dx\\,dz = \\int_0^{0.5} [-0.25x+0.25x^2+zx]_0^2\\,dz = \\int_0^{0.5} (-0.5+1+2z)\\,dz = \\int_0^{0.5} (0.5+2z)\\,dz = [0.5z+z^2]_0^{0.5} = 0.5(0.5)+(0.5)^2 = 0.25+0.25 = 0.5$.\n4.  Face at $y=L_y$: $\\int_0^{L_z}\\int_0^{L_x} (0.75-x+2z)\\,dx\\,dz = \\int_0^{0.5} [0.75x-\\frac{x^2}{2}+2zx]_0^2\\,dz = \\int_0^{0.5} (1.5-2+4z)\\,dz = \\int_0^{0.5} (-0.5+4z)\\,dz = [-0.5z+2z^2]_0^{0.5} = -0.5(0.5)+2(0.5)^2 = -0.25+0.5 = 0.25$.\n5.  Face at $z=0$: $\\int_0^{L_y}\\int_0^{L_x} (0.1+x+y)\\,dx\\,dy = \\int_0^1 [0.1x+\\frac{x^2}{2}+yx]_0^2\\,dy = \\int_0^1 (0.2+2+2y)\\,dy = \\int_0^1 (2.2+2y)\\,dy = [2.2y+y^2]_0^1 = 2.2+1 = 3.2$.\n6.  Face at $z=L_z$: $\\int_0^{L_y}\\int_0^{L_x} (-0.6+2x-y)\\,dx\\,dy = \\int_0^1 [-0.6x+x^2-yx]_0^2\\,dy = \\int_0^1 (-1.2+4-2y)\\,dy = \\int_0^1 (2.8-2y)\\,dy = [2.8y-y^2]_0^1 = 2.8-1 = 1.8$.\n\nThe total net outward flux is the sum of these values:\n$$\nI_F = 1.125 + 0.125 + 0.5 + 0.25 + 3.2 + 1.8 = 1.25 + 0.75 + 5.0 = 7.0\\,\\mathrm{kg\\,s^{-1}}\n$$\n\nNow, we can compute the rate of change of the total quantity:\n$$\n\\frac{d}{dt}\\int_{\\Omega} U\\,dV = I_S - I_F = 1.75 - 7.0 = -5.25\\,\\mathrm{kg\\,s^{-1}}\n$$\nThe problem asks for the answer rounded to four significant figures, which is $-5.250\\,\\mathrm{kg\\,s^{-1}}$.\n\nFor the second part of the problem, we must verify conservation in the special case where the source term is zero ($S=0$) and the net outward boundary flux is also zero ($\\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA = 0$).\nStarting from the same conservation principle:\n$$\n\\frac{d}{dt}\\int_{\\Omega} U\\,dV = \\int_{\\Omega} S\\,dV - \\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA\n$$\nIf $S=0$, then the volume integral of the source is $\\int_{\\Omega} 0\\,dV = 0$.\nThe problem also states that the net outward flux is zero, i.e., $\\int_{\\partial\\Omega} \\mathbf{F}\\cdot\\mathbf{n}\\,dA = 0$.\nSubstituting these two conditions into the conservation equation gives:\n$$\n\\frac{d}{dt}\\int_{\\Omega} U\\,dV = 0 - 0 = 0\n$$\nThis result confirms that if there are no internal sources or sinks and no net flow across the boundaries, the total amount of the quantity within the volume is conserved, meaning its time rate of change is zero. The value for this verification case is $0$.\n\nThe final answer requires both the computed rate for the given data and the verification value.\nThe computed rate is $-5.250\\,\\mathrm{kg\\,s^{-1}}$.\nThe verification value is $0\\,\\mathrm{kg\\,s^{-1}}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -5.250  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In a real simulation, the fluxes across cell boundaries are not given; they must be approximated from the solution states in adjacent cells, which is the role of a numerical flux function. This exercise introduces the widely-used Rusanov (or Local Lax-Friedrichs) scheme to compute the mass flux for the Euler equations. This demonstrates how to handle the discontinuous states at a cell interface and incorporate physical wave speeds to ensure a stable and consistent approximation. ",
            "id": "3958926",
            "problem": "Consider the two-dimensional compressible Euler equations in conservation form for a calorically perfect gas with ratio of specific heats $\\gamma$:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\nwhere the conserved variable vector is $\\mathbf{U} = [\\rho,\\ \\rho u,\\ \\rho v,\\ \\rho E]^{\\top}$, with $\\rho$ the density, $u$ and $v$ the velocity components, and $E$ the specific total energy. The inviscid fluxes in the $x$- and $y$-directions are $\\mathbf{F}_x(\\mathbf{U})$ and $\\mathbf{F}_y(\\mathbf{U})$, respectively, corresponding to the Euler system. For a face with outward unit normal $\\mathbf{n} = (n_x, n_y)$, the physical normal flux is $\\mathbf{F}_n(\\mathbf{U}) = \\mathbf{F}_x(\\mathbf{U}) n_x + \\mathbf{F}_y(\\mathbf{U}) n_y$. In a finite volume method, the numerical flux $\\hat{\\mathbf{F}}(\\mathbf{U}_L,\\mathbf{U}_R)\\cdot \\mathbf{n}$ provides a consistent approximation of the physical normal flux at the face, based on left and right reconstructed states $\\mathbf{U}_L$ and $\\mathbf{U}_R$.\n\nAssume the fluid is air modeled as a calorically perfect gas with $\\gamma = 1.4$. At a particular face, the outward unit normal is $\\mathbf{n} = (\\cos\\theta,\\ \\sin\\theta)$ with $\\theta = \\pi/6$ radians. The left and right reconstructed primitive states are:\n- Left: density $\\rho_L = 1.2$, velocity components $u_L = 150$ and $v_L = 0$, pressure $p_L = 100000$.\n- Right: density $\\rho_R = 1.8$, velocity components $u_R = 100$ and $v_R = 20$, pressure $p_R = 150000$.\n\nUse the Local Lax–Friedrichs (LLF, also called Rusanov) numerical flux aligned with the face normal to determine the mass flux crossing the face, defined as the first component of $\\hat{\\mathbf{F}}(\\mathbf{U}_L,\\mathbf{U}_R)\\cdot \\mathbf{n}$. The speed of sound $a$ in a calorically perfect gas is given by $a = \\sqrt{\\gamma p/\\rho}$.\n\nCompute the scalar mass flux across the face using the specified numerical flux and the given data. Round your final result to four significant figures. Express your answer in $\\mathrm{kg}/(\\mathrm{m}^2\\cdot\\mathrm{s})$.",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the principles of computational fluid dynamics, well-posed with all necessary information provided, and objective in its formulation. We can therefore proceed with the solution.\n\nThe problem asks for the mass flux across a face as determined by the Local Lax–Friedrichs (LLF), or Rusanov, numerical flux scheme. The general form of the LLF numerical flux for a face with outward unit normal $\\mathbf{n}$ is given by:\n$$\n\\hat{\\mathbf{F}}_n(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{1}{2} \\left[ \\mathbf{F}_n(\\mathbf{U}_L) + \\mathbf{F}_n(\\mathbf{U}_R) \\right] - \\frac{1}{2} S_{\\max} (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nHere, $\\mathbf{U}_L$ and $\\mathbf{U}_R$ are the reconstructed states of the conserved variables on the left and right sides of the face, respectively. $\\mathbf{F}_n(\\mathbf{U}) = \\mathbf{F}_x(\\mathbf{U}) n_x + \\mathbf{F}_y(\\mathbf{U}) n_y$ is the physical flux normal to the face. The term $S_{\\max}$ represents the maximum signal velocity (wave speed) at the face, which provides the numerical dissipation.\n\nThe vector of conserved variables is $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top}$. The mass flux is the first component of the numerical flux vector $\\hat{\\mathbf{F}}_n$. Let's denote the components of a vector $\\mathbf{V}$ as $(\\mathbf{V})_i$. The mass flux is $(\\hat{\\mathbf{F}}_n)_1$.\n\nThe first component of the conserved variable vector is $(\\mathbf{U})_1 = \\rho$.\nThe first component of the physical flux vector $\\mathbf{F}_x$ is $\\rho u$, and for $\\mathbf{F}_y$ it is $\\rho v$.\nTherefore, the first component of the normal physical flux $\\mathbf{F}_n$ is:\n$$\n(\\mathbf{F}_n(\\mathbf{U}))_1 = (\\mathbf{F}_x(\\mathbf{U}))_1 n_x + (\\mathbf{F}_y(\\mathbf{U}))_1 n_y = \\rho u n_x + \\rho v n_y = \\rho (u n_x + v n_y) = \\rho v_n\n$$\nwhere $v_n = \\vec{v} \\cdot \\mathbf{n} = u n_x + v n_y$ is the component of the velocity vector normal to the face.\n\nThe mass flux component of the LLF scheme is then:\n$$\n(\\hat{\\mathbf{F}}_n)_1 = \\frac{1}{2} \\left[ (\\mathbf{F}_n(\\mathbf{U}_L))_1 + (\\mathbf{F}_n(\\mathbf{U}_R))_1 \\right] - \\frac{1}{2} S_{\\max} ((\\mathbf{U}_R)_1 - (\\mathbf{U}_L)_1)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 = \\frac{1}{2} (\\rho_L v_{n,L} + \\rho_R v_{n,R}) - \\frac{1}{2} S_{\\max} (\\rho_R - \\rho_L)\n$$\n\nThe maximum signal velocity $S_{\\max}$ for the Euler equations is given by:\n$$\nS_{\\max} = \\max(|v_{n,L}| + a_L, |v_{n,R}| + a_R)\n$$\nwhere $a_L$ and $a_R$ are the speeds of sound for the left and right states.\n\nWe now compute the necessary quantities step-by-step using the given data.\nThe ratio of specific heats is $\\gamma = 1.4$.\nThe face normal vector is $\\mathbf{n} = (n_x, n_y)$ with angle $\\theta = \\pi/6$ radians.\n$$\nn_x = \\cos(\\pi/6) = \\frac{\\sqrt{3}}{2}\n$$\n$$\nn_y = \\sin(\\pi/6) = \\frac{1}{2}\n$$\n\nThe primitive variables are:\nLeft state: $\\rho_L = 1.2$, $u_L = 150$, $v_L = 0$, $p_L = 100000$.\nRight state: $\\rho_R = 1.8$, $u_R = 100$, $v_R = 20$, $p_R = 150000$.\n\nFirst, we calculate the normal velocities, $v_{n,L}$ and $v_{n,R}$:\n$$\nv_{n,L} = u_L n_x + v_L n_y = (150)\\left(\\frac{\\sqrt{3}}{2}\\right) + (0)\\left(\\frac{1}{2}\\right) = 75\\sqrt{3}\n$$\n$$\nv_{n,R} = u_R n_x + v_R n_y = (100)\\left(\\frac{\\sqrt{3}}{2}\\right) + (20)\\left(\\frac{1}{2}\\right) = 50\\sqrt{3} + 10\n$$\n\nNext, we calculate the speeds of sound, $a_L$ and $a_R$, using the formula $a = \\sqrt{\\gamma p/\\rho}$:\n$$\n\\frac{p_L}{\\rho_L} = \\frac{100000}{1.2} = \\frac{250000}{3}\n$$\n$$\n\\frac{p_R}{\\rho_R} = \\frac{150000}{1.8} = \\frac{1500000}{18} = \\frac{250000}{3}\n$$\nSince $p_L/\\rho_L = p_R/\\rho_R$, the speeds of sound are equal: $a_L = a_R$. Let's call this common value $a_c$.\n$$\na_c = a_L = a_R = \\sqrt{\\gamma \\frac{p_L}{\\rho_L}} = \\sqrt{1.4 \\times \\frac{250000}{3}} = \\sqrt{\\frac{350000}{3}}\n$$\n\nNow we find the maximum signal velocity $S_{\\max}$:\n$$\nS_{\\max} = \\max(|v_{n,L}| + a_c, |v_{n,R}| + a_c)\n$$\nWe evaluate the normal velocities:\n$v_{n,L} = 75\\sqrt{3} \\approx 129.90$\n$v_{n,R} = 50\\sqrt{3} + 10 \\approx 96.60$\nBoth are positive. Since $v_{n,L}  v_{n,R}$, we have $|v_{n,L}|  |v_{n,R}|$. Therefore:\n$$\nS_{\\max} = |v_{n,L}| + a_c = v_{n,L} + a_c = 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}}\n$$\n\nWe can now assemble the expression for the mass flux.\nThe average physical flux term is:\n$$\n\\frac{1}{2} (\\rho_L v_{n,L} + \\rho_R v_{n,R}) = \\frac{1}{2} \\left[ 1.2 \\times (75\\sqrt{3}) + 1.8 \\times (50\\sqrt{3} + 10) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ 90\\sqrt{3} + 90\\sqrt{3} + 18 \\right] = \\frac{1}{2} [180\\sqrt{3} + 18] = 90\\sqrt{3} + 9\n$$\nThe dissipation term is:\n$$\n\\frac{1}{2} S_{\\max} (\\rho_R - \\rho_L) = \\frac{1}{2} \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right) (1.8 - 1.2)\n$$\n$$\n= \\frac{1}{2} \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right) (0.6) = 0.3 \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right)\n$$\n$$\n= 22.5\\sqrt{3} + 0.3\\sqrt{\\frac{350000}{3}}\n$$\nCombining the terms, the numerical mass flux is:\n$$\n(\\hat{\\mathbf{F}}_n)_1 = (90\\sqrt{3} + 9) - \\left( 22.5\\sqrt{3} + 0.3\\sqrt{\\frac{350000}{3}} \\right)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 = 67.5\\sqrt{3} + 9 - 0.3\\sqrt{\\frac{350000}{3}}\n$$\nNow, we compute the numerical value:\n$\\sqrt{3} \\approx 1.73205$\n$\\sqrt{\\frac{350000}{3}} = \\sqrt{116666.\\overline{6}} \\approx 341.565$\n$$\n(\\hat{\\mathbf{F}}_n)_1 \\approx 67.5 \\times (1.73205) + 9 - 0.3 \\times (341.565)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 \\approx 116.9134 + 9 - 102.4695 = 125.9134 - 102.4695 = 23.4439\n$$\nThe problem requires rounding the result to four significant figures.\nThe calculated value is $23.4439...$. The fifth significant digit is $3$, so we round down.\nThe final result is $23.44$.\nThe units are implicitly $\\mathrm{kg}/(\\mathrm{m}^2\\cdot\\mathrm{s})$ based on the SI units of the input quantities.",
            "answer": "$$\n\\boxed{23.44}\n$$"
        }
    ]
}