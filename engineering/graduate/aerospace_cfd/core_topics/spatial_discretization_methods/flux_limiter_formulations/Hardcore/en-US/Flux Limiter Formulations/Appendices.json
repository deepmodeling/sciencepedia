{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of high-resolution schemes, it is essential to master the fundamental mechanics of flux limiting. This first exercise provides a concrete, hands-on calculation using the Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction approach. By working with a specific set of hypothetical data and the well-known minmod limiter, you will directly compute the limited slope and the resulting interface values, reinforcing the core procedure that prevents spurious oscillations in numerical solutions. ",
            "id": "3959625",
            "problem": "Consider the one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized by a finite-volume method on a uniform grid with spacing $\\Delta x = 1$. To achieve second-order accuracy while maintaining Total Variation Diminishing (TVD) behavior, use a Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) piecewise linear reconstruction with a minmod flux limiter. In this setting, the reconstructed states at cell interfaces are defined by\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{\\Delta x}{2}\\, s_{i}, \\qquad\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{\\Delta x}{2}\\, s_{i},\n$$\nwhere $s_{i}$ is the limited slope in cell $i$. The minmod limiter acts on the one-sided slopes to enforce local monotonicity and TVD constraints. The limited slope $s_{i}$ is obtained from the one-sided differences via\n$$\ns_{i} = \\minmod\\!\\left(\\frac{u_{i} - u_{i-1}}{\\Delta x},\\, \\frac{u_{i+1} - u_{i}}{\\Delta x}\\right),\n$$\nwhere the two-argument minmod function is defined by\n$$\n\\minmod(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\, \\min\\!\\left(|a|,\\, |b|\\right),  \\text{if } \\operatorname{sign}(a) = \\operatorname{sign}(b), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nGiven the cell-average data $u_{i-1} = 0$, $u_{i} = 1$, $u_{i+1} = 1.1$, and $u_{i+2} = 1.2$ (dimensionless), compute the limited slope $s_{i}$ and report the interface states $u_{i+\\frac{1}{2}}^{-}$ and $u_{i-\\frac{1}{2}}^{+}$ as exact decimal values. No rounding is required. Provide the final answer as a two-entry row matrix $\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big)$.",
            "solution": "The goal is to compute the limited slope $s_i$ and the reconstructed interface states $u_{i+1/2}^{-}$ and $u_{i-1/2}^{+}$ for cell $i$.\n\n1.  **Identify the given data:**\n    We are given the cell-average values $u_{i-1} = 0$, $u_i = 1$, and $u_{i+1} = 1.1$, with a grid spacing of $\\Delta x = 1$. The value $u_{i+2}$ is not needed for the calculation in cell $i$.\n\n2.  **Calculate the one-sided slopes:**\n    The two arguments for the minmod function are the backward and forward difference approximations of the slope in cell $i$.\n    -   Backward difference slope: $a = \\frac{u_i - u_{i-1}}{\\Delta x} = \\frac{1 - 0}{1} = 1$.\n    -   Forward difference slope: $b = \\frac{u_{i+1} - u_i}{\\Delta x} = \\frac{1.1 - 1}{1} = 0.1$.\n\n3.  **Apply the minmod function to find the limited slope $s_i$:**\n    The limited slope is $s_i = \\minmod(a, b) = \\minmod(1, 0.1)$.\n    Since both arguments are positive ($\\operatorname{sign}(a) = \\operatorname{sign}(b)$), the minmod function returns the argument with the smaller absolute value, multiplied by the common sign.\n    $$\n    s_i = \\operatorname{sign}(1) \\min(|1|, |0.1|) = 1 \\times 0.1 = 0.1\n    $$\n\n4.  **Compute the reconstructed interface states:**\n    Now, substitute the limited slope $s_i=0.1$ into the reconstruction formulas:\n    -   State at the right interface of cell $i$:\n        $$\n        u_{i+\\frac{1}{2}}^{-} = u_i + \\frac{\\Delta x}{2} s_i = 1 + \\frac{1}{2} (0.1) = 1 + 0.05 = 1.05\n        $$\n    -   State at the left interface of cell $i$:\n        $$\n        u_{i-\\frac{1}{2}}^{+} = u_i - \\frac{\\Delta x}{2} s_i = 1 - \\frac{1}{2} (0.1) = 1 - 0.05 = 0.95\n        $$\n\n5.  **Final Answer:**\n    The requested interface states are $(u_{i+1/2}^{-}, u_{i-1/2}^{+}) = (1.05, 0.95)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.05  0.95 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After learning the mechanics of applying a limiter, it is crucial to understand the theoretical implications and inherent compromises of Total Variation Diminishing (TVD) schemes. This practice guides you through a thought experiment to analyze the scheme's behavior near a smooth extremum, a region where high-order accuracy is often lost. By using Taylor series expansions, you will uncover the reason why limiters like minmod, while ensuring stability, locally reduce the scheme to first-order accuracy, a phenomenon central to Godunov's theorem. ",
            "id": "3959553",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ with constant advection speed $a0$ on a uniform grid with spacing $\\Delta x$. A conservative finite-volume discretization with Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction and the minmod flux limiter is used to obtain left/right interface states for an upwind Godunov flux. In each cell $i$, define the backward and forward undivided differences $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$, and the limited slope $s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i)$, where the minmod function is\n$$\n\\operatorname{minmod}(p,q) =\n\\begin{cases}\n\\operatorname{sgn}(p)\\,\\min\\{|p|,|q|\\},  pq0,\\\\\n0,  pq \\le 0.\n\\end{cases}\n$$\nThe left state at $x_{i+1/2}$ is $u_{i+1/2}^- = u_i + \\tfrac{1}{2}s_i$, and the numerical flux is $F_{i+1/2} = a\\,u_{i+1/2}^-$. Assume the exact solution is smooth and has a strict local extremum in cell $i$ located at $x_i$, so that $u_x(x_i)=0$ and $u_{xx}(x_i)\\neq 0$ while higher derivatives are bounded. Using only fundamental definitions (conservation law, Taylor expansions about $x_i$, and the definition of the minmod limiter), determine the local spatial order of accuracy of the semi-discrete scheme at $x_i$ and identify the mechanism by which the scheme loses second-order behavior there.\n\nWhich statement best characterizes the order of accuracy and the mechanism near $x_i$?\n\nA. The limiter yields $s_i=0$ to leading order because $\\Delta^+ u_i$ and $\\Delta^- u_i$ have opposite signs when $u_{xx}(x_i)\\neq 0$, so the reconstruction becomes piecewise constant, the scheme reduces locally to upwind differencing, and the spatial truncation error at $x_i$ scales as $\\mathcal{O}(\\Delta x)$.\n\nB. The scheme remains second order because each interface flux $F_{i\\pm 1/2}$ differs from the exact flux by $\\mathcal{O}(\\Delta x^2)$ even if $s_i=0$, which ensures a $\\mathcal{O}(\\Delta x^2)$ truncation error at $x_i$.\n\nC. The scheme becomes third order exactly at the extremum since $u_x(x_i)=0$ cancels the leading error term, leaving a truncation error that scales as $\\mathcal{O}(\\Delta x^3)$.\n\nD. The limiter produces nonzero slopes of opposite signs in adjacent cells, leading to dispersive oscillations and no well-defined order near $x_i$.",
            "solution": "The problem requires an analysis of the local order of accuracy of a MUSCL scheme with a minmod limiter at a smooth extremum.\n\n1.  **Analyze the limiter's arguments at the extremum.**\n    We are given that the solution has a smooth, strict extremum at $x_i$, so $u_x(x_i) = 0$ and $u_{xx}(x_i) \\neq 0$. We use Taylor series expansions around $x_i$ to approximate the cell-average values $u_{i\\pm 1}$ (treating them as point values for this analysis):\n    $$ u_{i+1} = u(x_i + \\Delta x) = u_i + u_x(x_i)\\Delta x + \\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) = u_i + \\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) $$\n    $$ u_{i-1} = u(x_i - \\Delta x) = u_i - u_x(x_i)\\Delta x + \\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) = u_i + \\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) $$\n    Now we compute the undivided differences, which are the arguments for the minmod function:\n    $$ \\Delta^+ u_i = u_{i+1} - u_i = \\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) $$\n    $$ \\Delta^- u_i = u_i - u_{i-1} = -\\frac{u_{xx}(x_i)}{2}\\Delta x^2 + \\mathcal{O}(\\Delta x^3) $$\n    To leading order, $\\Delta^+ u_i$ and $\\Delta^- u_i$ have opposite signs because $u_{xx}(x_i) \\neq 0$.\n\n2.  **Determine the limited slope.**\n    According to the definition of the minmod function, if the arguments have a non-positive product ($pq \\le 0$), the function returns 0. Since $\\Delta^+ u_i$ and $\\Delta^- u_i$ have opposite signs, their product is negative. Therefore, the limited slope is:\n    $$ s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i) = 0 $$\n\n3.  **Analyze the consequence for the numerical scheme.**\n    -   **Reconstruction:** With a limited slope of zero, the reconstruction within cell $i$ becomes piecewise constant: $u(x) = u_i$. This is a first-order reconstruction.\n    -   **Numerical Flux:** Since the advection speed $a > 0$, the upwind Godunov flux takes the state from the left. The reconstructed left state at the interface $x_{i+1/2}$ is $u_{i+1/2}^- = u_i + \\frac{1}{2}s_i = u_i$. The numerical flux is thus $F_{i+1/2} = a u_i$. This is exactly the flux of the first-order upwind scheme.\n    -   **Truncation Error:** The semi-discrete scheme is $\\frac{du_i}{dt} = -\\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$. The spatial truncation error $\\tau_i$ is the residual when the exact solution is plugged in: $\\tau_i = u_t(x_i) + \\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$. Since $u_t = -a u_x$, and $u_x(x_i)=0$, the exact time derivative is zero. The error is $\\tau_i = \\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$. The flux difference is proportional to $(u_i - u_{i-1})$ (after analyzing the flux $F_{i-1/2}$), which scales as $\\mathcal{O}(\\Delta x^2)$. When divided by $\\Delta x$, the truncation error becomes $\\mathcal{O}(\\Delta x)$. The scheme is therefore locally first-order accurate.\n\n4.  **Evaluate the options.**\n    -   **A:** This statement correctly identifies that the limiter sets the slope $s_i$ to zero because the differences have opposite signs. It correctly concludes that this reduces the reconstruction to piecewise constant, the scheme behaves like first-order upwind, and the resulting truncation error is $\\mathcal{O}(\\Delta x)$. This matches our analysis perfectly.\n    -   **B:** This is incorrect. While individual flux errors might be small, their difference, when divided by $\\Delta x$, results in an $\\mathcal{O}(\\Delta x)$ truncation error.\n    -   **C:** This is incorrect. The scheme's order degenerates to first order, it does not improve to third.\n    -   **D:** This is incorrect. TVD schemes are designed to prevent, not create, dispersive oscillations. The error at an extremum is dissipative (smearing), not dispersive. The order is well-defined as first-order.\n\nTherefore, statement A provides the correct characterization.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from idealized one-dimensional grids to the complexities of practical Computational Fluid Dynamics (CFD) requires a more general approach to flux limiting. This final exercise challenges you to derive the formulation for the classic Barth-Jespersen limiter, which is designed for the multi-dimensional, unstructured meshes used in advanced aerospace simulations. By starting from the fundamental requirement of preserving a local maximum principle, you will construct the limiter to ensure that reconstructed values at cell faces remain within the bounds set by neighboring cells, a key technique for robust, high-fidelity simulations. ",
            "id": "3959579",
            "problem": "Consider a finite-volume discretization of a scalar conservative variable $u$ for inviscid compressible flow in Computational Fluid Dynamics (CFD). On an unstructured tessellation, let cell $i$ have centroid $\\boldsymbol{x}_{i}$, volume $V_{i}$, and the set of its faces $\\mathcal{F}(i)$. Denote by $u_{i}$ the cell-averaged value in cell $i$, and by $\\nabla u_{i}$ a consistent linear reconstruction gradient (e.g., from a least-squares procedure) satisfying the compatibility condition with neighboring cell averages. Define the unconstrained linear face-center reconstruction from cell $i$ as\n$$\nu_{i}^{\\mathrm{rec}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i),\n$$\nwhere $\\boldsymbol{x}_{f}$ is the geometric face center of face $f$. Introduce a scalar limiter coefficient $\\alpha_{i}\\in[0,1]$ that scales the gradient and yields the limited face-center reconstruction\n$$\nu_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i).\n$$\nLet the local monotonicity bounds in cell $i$ be defined from the immediate face-neighbor stencil $\\mathcal{N}(i)$ (including $i$ itself) as\n$$\nu_{i}^{\\min}\\equiv \\min_{j\\in \\mathcal{N}(i)} u_{j}, \\qquad u_{i}^{\\max}\\equiv \\max_{j\\in \\mathcal{N}(i)} u_{j}.\n$$\nImpose the discrete local maximum principle that each limited face-center value lies within the local bounds:\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\\quad \\text{for all } f\\in \\mathcal{F}(i).\n$$\nStarting only from these definitions and the requirement $\\,\\alpha_{i}\\in[0,1]\\,$, derive the explicit closed-form expression for the Barthâ€“Jespersen limiter coefficient $\\,\\alpha_{i}\\,$ that is as large as possible while ensuring the above face-center inequalities for all faces $f\\in \\mathcal{F}(i)$. Your final expression must be written solely in terms of $\\,u_{i}$, $\\,u_{i}^{\\min}$, $\\,u_{i}^{\\max}$, the geometric offsets $\\,\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}$, and the gradient $\\,\\nabla u_{i}$. Define any intermediate symbols you introduce. Express your final answer as a single closed-form analytic expression. No numerical evaluation is required and no units are involved.",
            "solution": "The derivation for the Barth-Jespersen limiter coefficient, $\\alpha_{i}$, starts from the imposed discrete local maximum principle. For every face $f \\in \\mathcal{F}(i)$ of cell $i$, the limited reconstructed value at the face center, $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f})$, must lie within the local minimum and maximum values of the neighboring cell averages.\n\n1.  **State the governing inequalities:**\n    The condition is expressed as a pair of inequalities for each face $f$:\n    $$\n    u_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\n    $$\n    Substituting the definition of the limited reconstruction gives:\n    $$\n    u_{i}^{\\min} \\le u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right) \\le u_{i}^{\\max}\n    $$\n\n2.  **Isolate the limiter term:**\n    Let's define the unconstrained change from the cell center to the face center as $\\Delta u_{if} \\equiv \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$. Subtracting $u_i$ from all parts of the inequality yields:\n    $$\n    u_{i}^{\\min} - u_{i} \\le \\alpha_{i} \\Delta u_{if} \\le u_{i}^{\\max} - u_{i}\n    $$\n    By definition of the local bounds, we know $u_{i}^{\\min} \\le u_{i} \\le u_{i}^{\\max}$, so $u_{i}^{\\min} - u_{i} \\le 0$ and $u_{i}^{\\max} - u_{i} \\ge 0$.\n\n3.  **Derive the constraint on $\\alpha_i$ for a single face:**\n    We need to find the upper bound on $\\alpha_i$ imposed by this inequality. The analysis depends on the sign of $\\Delta u_{if}$.\n    -   **Case 1: $\\Delta u_{if} > 0$ (reconstruction increases towards the face).**\n        Dividing by the positive $\\Delta u_{if}$ preserves the inequality direction. We are interested in the upper bound on $\\alpha_i$:\n        $$ \\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}} $$\n    -   **Case 2: $\\Delta u_{if}  0$ (reconstruction decreases towards the face).**\n        Dividing by the negative $\\Delta u_{if}$ reverses the inequality direction. We again isolate the upper bound on $\\alpha_i$:\n        $$ \\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}} $$\n        Note that both numerator and denominator are negative, so the ratio is non-negative.\n    -   **Case 3: $\\Delta u_{if} = 0$.**\n        The inequality becomes $u_{i}^{\\min} - u_{i} \\le 0 \\le u_{i}^{\\max} - u_{i}$, which is always true. This face imposes no constraint on $\\alpha_i$. The upper bound is effectively infinite.\n\n4.  **Combine cases and generalize to all faces:**\n    We can express the upper bound imposed by a single face $f$, let's call it $\\alpha_{if}$, in a single piecewise form:\n    $$\n    \\alpha_{if} = \\begin{cases}\n    \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if} > 0 \\\\\n    \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n    +\\infty  \\text{if } \\Delta u_{if} = 0\n    \\end{cases}\n    $$\n    To satisfy the local maximum principle, the limiter $\\alpha_i$ must be less than or equal to the bound imposed by *every* face of the cell. Therefore, $\\alpha_i$ must be no larger than the minimum of all these individual bounds:\n    $$\n    \\alpha_i \\le \\min_{f \\in \\mathcal{F}(i)} \\alpha_{if}\n    $$\n\n5.  **Apply final constraints and state the expression:**\n    The problem specifies that $\\alpha_i$ must be in the range $[0,1]$. Since all $\\alpha_{if}$ are non-negative, the lower bound $\\alpha_i \\ge 0$ is naturally handled by seeking the largest possible value. We must explicitly enforce the upper bound $\\alpha_i \\le 1$. The largest possible value for $\\alpha_i$ that satisfies all conditions is therefore:\n    $$\n    \\alpha_i = \\min\\left(1, \\min_{f \\in \\mathcal{F}(i)} \\alpha_{if}\\right)\n    $$\n    Substituting the expression for $\\alpha_{if}$ gives the final closed-form expression for the Barth-Jespersen limiter coefficient.",
            "answer": "$$\n\\boxed{\\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\begin{cases} \\frac{u_{i}^{\\max} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ \\frac{u_{i}^{\\min} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ +\\infty  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}) = 0 \\end{cases} \\right)}\n$$"
        }
    ]
}