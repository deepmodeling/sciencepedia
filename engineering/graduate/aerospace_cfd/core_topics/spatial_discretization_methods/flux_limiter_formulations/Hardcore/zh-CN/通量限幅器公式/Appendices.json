{
    "hands_on_practices": [
        {
            "introduction": "在掌握了minmod限制器的基本应用后，我们将探索另一种具有不同特性的限制器——Superbee。与minmod相比，Superbee限制器更为“压缩”，倾向于在间断附近产生更陡峭的梯度，这在捕捉激波等特征时可能更具优势。这个练习将展示如何应用Superbee限制器，并让你通过计算比较其与minmod在特定数据下的不同行为，从而深化对不同限制器设计哲学的理解。",
            "id": "3959641",
            "problem": "考虑标量线性平流方程 $u_{t} + a\\,u_{x} = 0$，其波速为正 $a>0$。该方程在均匀网格上离散，网格单元中心的值为 $\\{u_{j}\\}$，索引为 $j \\in \\mathbb{Z}$。使用总变差递减的单调上游中心守恒律格式（MUSCL-TVD）重构，以在每个网格单元内获得分段线性数据，其斜率由一个通量限制器函数限制，以强制执行总变差递减（TVD）属性。\n\n定义单边离散梯度 $\\delta_{i}^{-} = u_{i} - u_{i-1}$ 和 $\\delta_{i}^{+} = u_{i+1} - u_{i}$。对于 $a>0$，定义比率\n$$\nr_{i} = \\frac{\\delta_{i}^{-}}{\\delta_{i}^{+}},\n$$\n以及 Superbee 限制器\n$$\n\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\; \\min(2r,\\,1),\\; \\min(r,\\,2)\\big).\n$$\n网格单元 $i$ 中的受限斜率为\n$$\ns_{i} = \\phi_{\\mathrm{SB}}(r_{i})\\,\\delta_{i}^{+},\n$$\n与网格单元 $i$ 相关的界面重构为\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{1}{2}s_{i}, \n\\qquad\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{1}{2}s_{i}.\n$$\n给定离散剖面值 $u_{i-1}=0$、$u_{i}=1$、$u_{i+1}=2$ 和 $u_{i+2}=2$，计算当 $a>0$ 时的 $r_{i}$、Superbee 限制的斜率 $s_{i}$ 以及界面状态 $u_{i-\\frac{1}{2}}^{+}$ 和 $u_{i+\\frac{1}{2}}^{-}$。以行向量 $\\big(r_{i},\\, s_{i},\\, u_{i-\\frac{1}{2}}^{+},\\, u_{i+\\frac{1}{2}}^{-}\\big)$ 的顺序给出你的最终答案。不需要四舍五入。",
            "solution": "该问题要求计算与一维线性平流方程的总变差递减（TVD）通量限制器的单调上游中心守恒律格式（MUSCL）相关的几个量。我们已知必要的公式和一组离散数据点。我们将通过系统地将所提供的定义应用于给定数据来进行计算。\n\n相关的给定信息如下：\n- 离散数据剖面：$u_{i-1}=0$，$u_{i}=1$，$u_{i+1}=2$。虽然也给出了 $u_{i+2}=2$ 的值，但在网格单元 $i$ 的计算中不需要它。\n- 波速为正，$a>0$。\n- 单边离散梯度的定义为 $\\delta_{i}^{-} = u_{i} - u_{i-1}$ 和 $\\delta_{i}^{+} = u_{i+1} - u_{i}$。\n- 梯度之比为 $r_{i} = \\frac{\\delta_{i}^{-}}{\\delta_{i}^{+}}$。\n- Superbee 通量限制器函数为 $\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\; \\min(2r,\\,1),\\; \\min(r,\\,2)\\big)$。\n- 网格单元 $i$ 中的受限斜率为 $s_{i} = \\phi_{\\mathrm{SB}}(r_{i})\\,\\delta_{i}^{+}$。\n- 重构的界面状态为 $u_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{1}{2}s_{i}$ 和 $u_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{1}{2}s_{i}$。\n\n我们的任务是计算 $r_{i}$、$s_{i}$、$u_{i-\\frac{1}{2}}^{+}$ 和 $u_{i+\\frac{1}{2}}^{-}$。\n\n步骤 1：计算单边离散梯度 $\\delta_{i}^{-}$ 和 $\\delta_{i}^{+}$。\n使用网格单元 $i$ 的给定数据点：\n$$\n\\delta_{i}^{-} = u_{i} - u_{i-1} = 1 - 0 = 1.\n$$\n$$\n\\delta_{i}^{+} = u_{i+1} - u_{i} = 2 - 1 = 1.\n$$\n\n步骤 2：计算梯度之比 $r_{i}$。\n对于 $a>0$ 的定义是 $r_{i} = \\frac{\\delta_{i}^{-}}{\\delta_{i}^{+}}$。分母 $\\delta_{i}^{+}$ 非零，因此该比率是良定义的。\n$$\nr_{i} = \\frac{1}{1} = 1.\n$$\n\n步骤 3：计算 Superbee 限制器函数 $\\phi_{\\mathrm{SB}}(r_{i})$ 的值。\n我们将 $r_i=1$ 代入 Superbee 限制器的公式中：\n$$\n\\phi_{\\mathrm{SB}}(r_{i}) = \\phi_{\\mathrm{SB}}(1) = \\max\\!\\big(0,\\; \\min(2 \\cdot 1,\\,1),\\; \\min(1,\\,2)\\big).\n$$\n首先，我们计算 $\\max$ 函数的参数：\n- $\\min(2,\\,1) = 1$。\n- $\\min(1,\\,2) = 1$。\n所以，表达式变为：\n$$\n\\phi_{\\mathrm{SB}}(1) = \\max(0, 1, 1) = 1.\n$$\n\n步骤 4：计算受限斜率 $s_{i}$。\n受限斜率由 $s_{i} = \\phi_{\\mathrm{SB}}(r_{i})\\,\\delta_{i}^{+}$ 给出。使用我们已计算出的值：\n$$\ns_{i} = (1) \\cdot (1) = 1.\n$$\n这个结果是符合预期的。对于 $r_{i}=1$，数据是局部线性的，TVD 格式不应引入任何额外的限制，因此保留了数据的原始斜率，即 $1$。\n\n步骤 5：计算界面状态 $u_{i-\\frac{1}{2}}^{+}$ 和 $u_{i+\\frac{1}{2}}^{-}$。\n这些是网格单元 $i$ 左右界面的值，使用网格中心值 $u_i$ 和受限斜率 $s_i$ 重构得到。\n网格单元 $i$ 右界面 $x_{i+\\frac{1}{2}}$ 处的值是：\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{1}{2}s_{i} = 1 + \\frac{1}{2}(1) = 1 + \\frac{1}{2} = \\frac{3}{2}.\n$$\n网格单元 $i$ 左界面 $x_{i-\\frac{1}{2}}$ 处的值是：\n$$\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{1}{2}s_{i} = 1 - \\frac{1}{2}(1) = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n\n计算出的量为：\n- $r_i = 1$\n- $s_i = 1$\n- $u_{i-\\frac{1}{2}}^{+} = \\frac{1}{2}$\n- $u_{i+\\frac{1}{2}}^{-} = \\frac{3}{2}$\n\n我们将这些结果组合成所要求的行向量格式 $\\big(r_{i},\\, s_{i},\\, u_{i-\\frac{1}{2}}^{+},\\, u_{i+\\frac{1}{2}}^{-}\\big)$。\n最终的向量是 $\\left(1, 1, \\frac{1}{2}, \\frac{3}{2}\\right)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & \\frac{1}{2} & \\frac{3}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "前面的练习集中在一维均匀网格上，然而，实际的航空航天CFD问题通常涉及复杂外形和非结构网格。这就要求限制器的构造必须具有几何无关性。本练习将引导你从一个更根本的物理原则——离散局部极值原理出发，推导Barth–Jespersen限制器。这个推导过程将帮助你理解如何将单调性约束推广到多维非结构网格上，这是设计健壮的高阶格式以解决复杂流动问题的关键一步。",
            "id": "3959579",
            "problem": "考虑计算流体动力学 (CFD) 中无粘可压缩流的标量守恒变量 $u$ 的有限体积离散化。在一个非结构化网格上，设单元 $i$ 的形心为 $\\boldsymbol{x}_{i}$，体积为 $V_{i}$，其面集为 $\\mathcal{F}(i)$。记 $u_{i}$ 为单元 $i$ 内的单元平均值，$\\nabla u_{i}$ 为一个满足与相邻单元平均值相容性条件的一致线性重构梯度（例如，通过最小二乘法得到）。将从单元 $i$ 出发的无约束线性面心重构定义为\n$$\nu_{i}^{\\mathrm{rec}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i),\n$$\n其中 $\\boldsymbol{x}_{f}$ 是面 $f$ 的几何中心。引入一个标量限制器系数 $\\alpha_{i}\\in[0,1]$，它缩放梯度并得到受限的面心重构\n$$\nu_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i).\n$$\n设单元 $i$ 中的局部单调性界限由直接面相邻模板 $\\mathcal{N}(i)$（包括 $i$ 本身）定义为\n$$\nu_{i}^{\\min}\\equiv \\min_{j\\in \\mathcal{N}(i)} u_{j}, \\qquad u_{i}^{\\max}\\equiv \\max_{j\\in \\mathcal{N}(i)} u_{j}.\n$$\n施加离散局部极值原理，即每个受限的面心值都位于局部界限内：\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\\quad \\text{for all } f\\in \\mathcal{F}(i).\n$$\n仅从这些定义和要求 $\\,\\alpha_{i}\\in[0,1]\\,$ 出发，推导 Barth–Jespersen 限制器系数 $\\,\\alpha_{i}\\,$ 的显式闭式表达式，该系数应在确保对所有面 $f\\in \\mathcal{F}(i)$ 上述面心不等式成立的前提下尽可能大。您的最终表达式必须仅用 $\\,u_{i}$、$\\,u_{i}^{\\min}$、$\\,u_{i}^{\\max}$、几何偏移量 $\\,\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}$ 以及梯度 $\\,\\nabla u_{i}$ 来书写。定义您引入的任何中间符号。将您的最终答案表示为单一的闭式解析表达式。不需要进行数值计算，也不涉及单位。",
            "solution": "Barth-Jespersen限制器系数 $\\alpha_{i}$ 的推导始于施加的离散局部极值原理。对于单元 $i$ 的每个面 $f \\in \\mathcal{F}(i)$，面心的受限重构值 $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f})$ 必须位于相邻单元平均值的局部最小值和最大值之间。该条件表示为一对不等式：\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\n$$\n代入受限重构的定义 $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) = u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$，我们得到：\n$$\nu_{i}^{\\min} \\le u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right) \\le u_{i}^{\\max}\n$$\n为简化表示，我们将面上无约束重构值与单元中心值之差定义为：\n$$\n\\Delta u_{if} \\equiv \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)\n$$\n从不等式各部分减去 $u_{i}$，可将其改写为：\n$$\nu_{i}^{\\min} - u_{i} \\le \\alpha_{i} \\Delta u_{if} \\le u_{i}^{\\max} - u_{i}\n$$\n根据局部界限的定义，$u_{i}$ 是集合 $\\{u_j\\}_{j\\in\\mathcal{N}(i)}$ 中的一个值，因此可以保证 $u_{i}^{\\min} \\le u_{i} \\le u_{i}^{\\max}$。因此，项 $u_{i}^{\\min} - u_{i}$ 是非正的，而项 $u_{i}^{\\max} - u_{i}$ 是非负的。\n\n我们的目标是找到满足对所有面 $f \\in \\mathcal{F}(i)$ 成立的最大 $\\alpha_i \\in [0,1]$。为此，我们首先找到由每个面单独施加的 $\\alpha_i$ 的上界。分析取决于 $\\Delta u_{if}$ 的符号。\n\n情况 1：$\\Delta u_{if} > 0$\n将不等式两边同除以正值 $\\Delta u_{if}$，不等式方向保持不变：\n$$\n\\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}} \\le \\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}\n$$\n由于 $u_{i}^{\\min} - u_{i} \\le 0$ 且 $\\Delta u_{if} > 0$，$\\alpha_{i}$ 的下界是非正的。考虑到约束条件 $\\alpha_{i} \\ge 0$，这个下界没有施加新的限制。因此，有效约束是上界：\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}\n$$\n\n情况 2：$\\Delta u_{if}  0$\n将不等式两边同除以负值 $\\Delta u_{if}$，不等式方向反转：\n$$\n\\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}} \\le \\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}\n$$\n由于 $u_{i}^{\\max} - u_{i} \\ge 0$ 且 $\\Delta u_{if}  0$，$\\alpha_{i}$ 的下界是非正的。同样，这被要求 $\\alpha_{i} \\ge 0$ 所取代。有效约束是上界。注意 $u_{i}^{\\min} - u_{i} \\le 0$，所以该比值为非负，这符合对 $\\alpha_{i}$ 上界的要求：\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}\n$$\n\n情况 3：$\\Delta u_{if} = 0$\n不等式变为 $u_{i}^{\\min} - u_{i} \\le 0 \\le u_{i}^{\\max} - u_{i}$，这永远成立。在这种情况下，$\\alpha_{i}$ 的值不受此特定面的约束。我们可以认为此面的上界是无穷大。\n\n综合这些情况，对于每个面 $f \\in \\mathcal{F}(i)$，我们可以定义一个限制值 $\\phi_f$ 使得 $\\alpha_i \\le \\phi_f$：\n$$\n\\phi_f = \\begin{cases}\n\\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n\\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n+\\infty  \\text{if } \\Delta u_{if} = 0\n\\end{cases}\n$$\n其中 $\\Delta u_{if} = \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})$。\n\n为了使单调性原理成立，所选的限制器 $\\alpha_i$ 必须同时满足所有面的条件。因此，$\\alpha_i$ 必须小于或等于所有这些单独界限的最小值：\n$$\n\\alpha_i \\le \\min_{f \\in \\mathcal{F}(i)} \\phi_f\n$$\n最后，我们还必须强制执行给定的约束条件 $\\alpha_i \\in [0,1]$。由于每个 $\\phi_f$ 都是非负的，如果我们寻求最大可能值，那么约束 $\\alpha_i \\ge 0$ 自然得到满足。约束 $\\alpha_i \\le 1$ 必须明确地包括进来。因此，最终的限制器系数 $\\alpha_i$ 是满足所有约束的最大值，通过取 1 和所有基于面的界限的最小值得到：\n$$\n\\alpha_i = \\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\phi_f \\right)\n$$\n代入 $\\phi_f$ 的分段定义，即可得出 Barth-Jespersen 限制器系数的完整表达式。",
            "answer": "$$\n\\boxed{\\alpha_i = \\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\begin{cases} \\frac{u_{i}^{\\max} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ \\frac{u_{i}^{\\min} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ +\\infty  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}) = 0 \\end{cases} \\right)}\n$$"
        }
    ]
}