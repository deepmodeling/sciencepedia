{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with the fundamental mechanics of a flux-limited scheme. This exercise provides a concrete numerical example of the Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) using the classic `minmod` limiter. By working through this calculation , you will see precisely how a limited slope is computed from local data and then used to reconstruct the solution values at cell interfaces, which are the building blocks for high-resolution numerical fluxes.",
            "id": "3959625",
            "problem": "Consider the one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized by a finite-volume method on a uniform grid with spacing $\\Delta x = 1$. To achieve second-order accuracy while maintaining Total Variation Diminishing (TVD) behavior, use a Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) piecewise linear reconstruction with a minmod flux limiter. In this setting, the reconstructed states at cell interfaces are defined by\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{\\Delta x}{2}\\, s_{i}, \\qquad\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{\\Delta x}{2}\\, s_{i},\n$$\nwhere $s_{i}$ is the limited slope in cell $i$. The minmod limiter acts on the one-sided slopes to enforce local monotonicity and TVD constraints. The limited slope $s_{i}$ is obtained from the one-sided differences via\n$$\ns_{i} = \\minmod\\!\\left(\\frac{u_{i} - u_{i-1}}{\\Delta x},\\, \\frac{u_{i+1} - u_{i}}{\\Delta x}\\right),\n$$\nwhere the two-argument minmod function is defined by\n$$\n\\minmod(a,b) = \n\\begin{cases}\n\\operatorname{sgn}(a)\\,\\min\\{|a|, |b|\\}, & \\text{if } ab > 0, \\\\\n0, & \\text{if } ab \\le 0.\n\\end{cases}\n$$\nGiven the cell-average data $u_{i-1} = 0$, $u_{i} = 1$, $u_{i+1} = 1.1$, and $u_{i+2} = 1.2$ (dimensionless), compute the limited slope $s_{i}$ and report the interface states $u_{i+\\frac{1}{2}}^{-}$ and $u_{i-\\frac{1}{2}}^{+}$ as exact decimal values. No rounding is required. Provide the final answer as a two-entry row matrix $\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big)$.",
            "solution": "We are asked to compute the limited slope $s_i$ and the reconstructed interface states $u_{i+\\frac{1}{2}}^{-}$ and $u_{i-\\frac{1}{2}}^{+}$ for cell $i$.\n\n**Step 1: Compute the one-sided slopes.**\nThe inputs for the minmod function are the backward and forward difference slopes.\nGiven data: $u_{i-1} = 0$, $u_{i} = 1$, $u_{i+1} = 1.1$, and $\\Delta x = 1$.\nThe backward difference slope is:\n$$ a = \\frac{u_{i} - u_{i-1}}{\\Delta x} = \\frac{1 - 0}{1} = 1 $$\nThe forward difference slope is:\n$$ b = \\frac{u_{i+1} - u_{i}}{\\Delta x} = \\frac{1.1 - 1}{1} = 0.1 $$\n\n**Step 2: Apply the minmod limiter.**\nNow we compute the limited slope $s_i$ using the minmod function with the slopes calculated above.\n$$ s_i = \\minmod(a, b) = \\minmod(1, 0.1) $$\nWe check the condition $ab > 0$. Here, $1 \\times 0.1 = 0.1 > 0$, so we use the first case of the definition:\n$$ s_i = \\operatorname{sgn}(a)\\,\\min\\{|a|, |b|\\} = \\operatorname{sgn}(1)\\,\\min\\{|1|, |0.1|\\} = 1 \\cdot 0.1 = 0.1 $$\nThe limited slope for cell $i$ is $s_i = 0.1$.\n\n**Step 3: Compute the reconstructed interface states.**\nUsing the limited slope $s_i$, we can now find the values at the left and right interfaces of cell $i$.\nThe reconstructed state at the right interface, $x_{i+\\frac{1}{2}}$, is:\n$$ u_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{\\Delta x}{2} s_{i} = 1 + \\frac{1}{2} (0.1) = 1 + 0.05 = 1.05 $$\nThe reconstructed state at the left interface, $x_{i-\\frac{1}{2}}$, is:\n$$ u_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{\\Delta x}{2} s_{i} = 1 - \\frac{1}{2} (0.1) = 1 - 0.05 = 0.95 $$\n\n**Step 4: Format the final answer.**\nThe problem asks for the result as a two-entry row matrix $\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big)$.\nThe final result is $(1.05, 0.95)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.05 & 0.95 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While flux limiters are essential for ensuring Total Variation Diminishing (TVD) properties and preventing spurious oscillations near shocks, this stability comes at a cost. This next practice shifts our focus from computation to a critical theoretical analysis . We will investigate the behavior of a `minmod`-limited scheme near a smooth extremum, revealing the mechanism by which these schemes can lose their second-order accuracy—a phenomenon known as 'extremum clipping' that is vital to understand when assessing the fidelity of numerical simulations.",
            "id": "3959553",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ with constant advection speed $a>0$ on a uniform grid with spacing $\\Delta x$. A conservative finite-volume discretization with Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction and the minmod flux limiter is used to obtain left/right interface states for an upwind Godunov flux. In each cell $i$, define the backward and forward undivided differences $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$, and the limited slope $s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i)$, where the minmod function is\n$$\n\\operatorname{minmod}(p,q) =\n\\begin{cases}\n\\operatorname{sgn}(p)\\,\\min\\{|p|,|q|\\}, & pq>0,\\\\\n0, & pq \\le 0.\n\\end{cases}\n$$\nThe left state at $x_{i+1/2}$ is $u_{i+1/2}^- = u_i + \\tfrac{1}{2}s_i$, and the numerical flux is $F_{i+1/2} = a\\,u_{i+1/2}^-$. Assume the exact solution is smooth and has a strict local extremum in cell $i$ located at $x_i$, so that $u_x(x_i)=0$ and $u_{xx}(x_i)\\neq 0$ while higher derivatives are bounded. Using only fundamental definitions (conservation law, Taylor expansions about $x_i$, and the definition of the minmod limiter), determine the local spatial order of accuracy of the semi-discrete scheme at $x_i$ and identify the mechanism by which the scheme loses second-order behavior there.\n\nWhich statement best characterizes the order of accuracy and the mechanism near $x_i$?\n\nA. The limiter yields $s_i=0$ to leading order because $\\Delta^+ u_i$ and $\\Delta^- u_i$ have opposite signs when $u_{xx}(x_i)\\neq 0$, so the reconstruction becomes piecewise constant, the scheme reduces locally to upwind differencing, and the spatial truncation error at $x_i$ scales as $\\mathcal{O}(\\Delta x)$.\n\nB. The scheme remains second order because each interface flux $F_{i\\pm 1/2}$ differs from the exact flux by $\\mathcal{O}(\\Delta x^2)$ even if $s_i=0$, which ensures a $\\mathcal{O}(\\Delta x^2)$ truncation error at $x_i$.\n\nC. The scheme becomes third order exactly at the extremum since $u_x(x_i)=0$ cancels the leading error term, leaving a truncation error that scales as $\\mathcal{O}(\\Delta x^3)$.\n\nD. The limiter produces nonzero slopes of opposite signs in adjacent cells, leading to dispersive oscillations and no well-defined order near $x_i$.",
            "solution": "The correct answer is A. Here is the step-by-step reasoning:\n\n1.  **Analyze the behavior of the limiter at the extremum.**\n    The core of the problem lies in how the `minmod` limiter behaves when the solution has a smooth extremum. We are given that at the center of cell $i$, $u_x(x_i) = 0$ and $u_{xx}(x_i) \\neq 0$. To analyze the limiter's inputs, $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$, we use Taylor series expansions around $x_i$:\n    $$ u_{i \\pm 1} = u(x_i \\pm \\Delta x) \\approx u(x_i) + (\\pm \\Delta x)u_x(x_i) + \\frac{(\\Delta x)^2}{2}u_{xx}(x_i) $$\n    Since $u_x(x_i) = 0$, this simplifies to:\n    $$ u_{i \\pm 1} \\approx u_i + \\frac{(\\Delta x)^2}{2}u_{xx}(x_i) $$\n    Now we can approximate the undivided differences:\n    $$ \\Delta^+ u_i = u_{i+1} - u_i \\approx \\frac{(\\Delta x)^2}{2}u_{xx}(x_i) $$\n    $$ \\Delta^- u_i = u_i - u_{i-1} \\approx u_i - \\left( u_i + \\frac{(-\\Delta x)^2}{2}u_{xx}(x_i) \\right) = -\\frac{(\\Delta x)^2}{2}u_{xx}(x_i) $$\n    Since $u_{xx}(x_i) \\neq 0$, the two differences, $\\Delta^+ u_i$ and $\\Delta^- u_i$, have opposite signs to leading order. Their product is negative.\n\n2.  **Determine the limited slope.**\n    According to the definition of the minmod function, if the product of its arguments is non-positive ($pq \\le 0$), the function returns 0.\n    $$ s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i) = 0 $$\n    This is the key mechanism: the limiter detects the change in the sign of the slope at the extremum and sets the reconstruction slope to zero to prevent the creation of a new, unphysical oscillation.\n\n3.  **Analyze the consequence for the numerical scheme.**\n    With a limited slope $s_i = 0$, the reconstruction within cell $i$ becomes piecewise constant: $u(x) = u_i$. The value extrapolated to the right face is simply $u_{i+1/2}^- = u_i + \\frac{1}{2}s_i = u_i$.\n    Because the advection speed $a > 0$, the upwind Godunov flux uses the state from the left. Thus, the flux at the downstream face $x_{i+1/2}$ is:\n    $$ F_{i+1/2} = a u_{i+1/2}^- = a u_i $$\n    This is exactly the numerical flux of the first-order upwind scheme.\n\n4.  **Determine the local truncation error.**\n    The semi-discrete scheme is $\\frac{du_i}{dt} = -\\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$. The local truncation error is $\\tau_i = \\frac{du_i}{dt} + a u_x(x_i)$. Since $u_x(x_i)=0$, the error is simply the numerical flux divergence. A full analysis of $F_{i-1/2}$ (which depends on $s_{i-1}$) and substitution into the formula shows that the flux difference does not cancel to second order. The scheme degenerates, and the resulting truncation error is found to be:\n    $$ \\tau_i \\approx \\frac{a \\Delta x}{4} u_{xx}(x_i) $$\n    Since $u_{xx}(x_i) \\neq 0$, the error is proportional to $\\Delta x$, which means the scheme is locally first-order accurate.\n\nThis entire sequence of events—opposite-signed differences, zero limited slope, piecewise-constant reconstruction, and a final truncation error of $\\mathcal{O}(\\Delta x)$—is perfectly described by statement A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Our discussion so far has focused on one-dimensional, structured grids. However, practical aerospace applications demand methods that work on complex, unstructured meshes. This final practice challenges you to derive the celebrated Barth–Jespersen limiter from first principles . This powerful, multi-dimensional limiter enforces monotonicity by ensuring that reconstructed values at cell faces remain within the bounds set by neighboring cell averages, providing a robust foundation for high-resolution schemes in real-world CFD.",
            "id": "3959579",
            "problem": "Consider a finite-volume discretization of a scalar conservative variable $u$ for inviscid compressible flow in Computational Fluid Dynamics (CFD). On an unstructured tessellation, let cell $i$ have centroid $\\boldsymbol{x}_{i}$, volume $V_{i}$, and the set of its faces $\\mathcal{F}(i)$. Denote by $u_{i}$ the cell-averaged value in cell $i$, and by $\\nabla u_{i}$ a consistent linear reconstruction gradient (e.g., from a least-squares procedure) satisfying the compatibility condition with neighboring cell averages. Define the unconstrained linear face-center reconstruction from cell $i$ as\n$$\nu_{i}^{\\mathrm{rec}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i),\n$$\nwhere $\\boldsymbol{x}_{f}$ is the geometric face center of face $f$. Introduce a scalar limiter coefficient $\\alpha_{i}\\in[0,1]$ that scales the gradient and yields the limited face-center reconstruction\n$$\nu_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i).\n$$\nLet the local monotonicity bounds in cell $i$ be defined from the immediate face-neighbor stencil $\\mathcal{N}(i)$ (including $i$ itself) as\n$$\nu_{i}^{\\min}\\equiv \\min_{j\\in \\mathcal{N}(i)} u_{j}, \\qquad u_{i}^{\\max}\\equiv \\max_{j\\in \\mathcal{N}(i)} u_{j}.\n$$\nImpose the discrete local maximum principle that each limited face-center value lies within the local bounds:\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\\quad \\text{for all } f\\in \\mathcal{F}(i).\n$$\nStarting only from these definitions and the requirement $\\,\\alpha_{i}\\in[0,1]\\,$, derive the explicit closed-form expression for the Barth–Jespersen limiter coefficient $\\,\\alpha_{i}\\,$ that is as large as possible while ensuring the above face-center inequalities for all faces $f\\in \\mathcal{F}(i)$. Your final expression must be written solely in terms of $\\,u_{i}$, $\\,u_{i}^{\\min}$, $\\,u_{i}^{\\max}$, the geometric offsets $\\,\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}$, and the gradient $\\,\\nabla u_{i}$. Define any intermediate symbols you introduce. Express your final answer as a single closed-form analytic expression. No numerical evaluation is required and no units are involved.",
            "solution": "The derivation for the Barth-Jespersen limiter coefficient, $\\alpha_{i}$, begins with the imposed discrete local maximum principle. For every face $f \\in \\mathcal{F}(i)$ of cell $i$, the limited reconstructed value at the face center, $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f})$, must lie within the local minimum and maximum values of the neighboring cell averages. The condition is expressed as a pair of inequalities:\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\n$$\nSubstituting the definition of the limited reconstruction, $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) = u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$, we get:\n$$\nu_{i}^{\\min} \\le u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right) \\le u_{i}^{\\max}\n$$\nTo simplify the notation, let us define the difference between the unconstrained reconstructed value at the face and the cell-center value as:\n$$\n\\Delta u_{if} \\equiv \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)\n$$\nThe inequalities can be rewritten by subtracting $u_{i}$ from all parts:\n$$\nu_{i}^{\\min} - u_{i} \\le \\alpha_{i} \\Delta u_{if} \\le u_{i}^{\\max} - u_{i}\n$$\nBy definition of the local bounds, $u_{i}$ is one of the values in the set $\\{u_j\\}_{j\\in\\mathcal{N}(i)}$, so it is guaranteed that $u_{i}^{\\min} \\le u_{i} \\le u_{i}^{\\max}$. Consequently, the term $u_{i}^{\\min} - u_{i}$ is non-positive, and $u_{i}^{\\max} - u_{i}$ is non-negative.\n\nOur goal is to find the largest $\\alpha_i \\in [0,1]$ that satisfies this for all faces $f \\in \\mathcal{F}(i)$. To do this, we first find the upper bound on $\\alpha_i$ imposed by each face individually. The analysis depends on the sign of $\\Delta u_{if}$.\n\n**Case 1: $\\Delta u_{if} > 0$**\nThe reconstruction extrapolates to a value greater than $u_i$. To prevent overshoots, we must enforce the upper bound: $\\alpha_i \\Delta u_{if} \\le u_i^{\\max} - u_i$. Dividing by the positive $\\Delta u_{if}$ gives:\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}\n$$\n\n**Case 2: $\\Delta u_{if}  0$**\nThe reconstruction extrapolates to a value less than $u_i$. To prevent undershoots, we must enforce the lower bound: $u_i^{\\min} - u_i \\le \\alpha_i \\Delta u_{if}$. Dividing by the negative $\\Delta u_{if}$ reverses the inequality:\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}\n$$\n\n**Case 3: $\\Delta u_{if} = 0$**\nThe inequalities become $u_{i}^{\\min} - u_{i} \\le 0 \\le u_{i}^{\\max} - u_{i}$, which is always true. In this case, the value of $\\alpha_{i}$ is unconstrained by this particular face. The upper bound from this face can be considered infinite.\n\nWe can combine these cases into a single expression for the maximum allowable limiter $\\phi_f$ for each face $f$:\n$$\n\\phi_f = \\begin{cases}\n\\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n\\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n+\\infty  \\text{if } \\Delta u_{if} = 0\n\\end{cases}\n$$\nFor the monotonicity principle to hold, the chosen limiter $\\alpha_i$ must satisfy the condition for all faces simultaneously. Therefore, $\\alpha_i$ must be less than or equal to the most restrictive (smallest) of all these bounds:\n$$\n\\alpha_i \\le \\min_{f \\in \\mathcal{F}(i)} \\phi_f\n$$\nFinally, we must enforce the given constraint that $\\alpha_i \\in [0,1]$. A fully second-order scheme corresponds to $\\alpha_i=1$. To be as accurate as possible while satisfying all constraints, we take the largest possible value for $\\alpha_i$, which is the minimum of 1 and the most restrictive face-based bound. This gives the final expression for the Barth–Jespersen limiter:\n$$\n\\alpha_i = \\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\phi_f \\right)\n$$",
            "answer": "$$\n\\boxed{\\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\begin{cases} \\frac{u_{i}^{\\max} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ \\frac{u_{i}^{\\min} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ +\\infty  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}) = 0 \\end{cases} \\right)}\n$$"
        }
    ]
}