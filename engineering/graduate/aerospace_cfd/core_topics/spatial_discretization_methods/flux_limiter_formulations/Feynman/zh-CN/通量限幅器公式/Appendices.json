{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在提供一个具体的计算实践，帮助您掌握通量限制器在MUSCL重构中的基本应用。通过使用`minmod`限制器为给定的数据点计算限定斜率和界面状态 [@problem-id:3959625]，您将熟悉高分辨率格式的核心机制，并为理解更复杂的数值通量计算打下坚实基础。",
            "id": "3959625",
            "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，其在间距为 $\\Delta x = 1$ 的均匀网格上通过有限体积法进行离散。为达到二阶精度并同时保持总变差递减 (TVD) 特性，使用一种带有 minmod 通量限制器的守恒律单调上游中心格式 (MUSCL) 分段线性重构。在此设置中，单元界面处的重构状态由以下公式定义：\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{\\Delta x}{2}\\, s_{i}, \\qquad\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{\\Delta x}{2}\\, s_{i},\n$$\n其中 $s_{i}$ 是单元 $i$ 中的受限斜率。minmod 限制器作用于单边斜率，以强制施加局部单调性和 TVD 约束。受限斜率 $s_{i}$ 可通过单边差分得到：\n$$\ns_{i} = \\operatorname{minmod}\\!\\left(\\frac{u_{i} - u_{i-1}}{\\Delta x},\\, \\frac{u_{i+1} - u_{i}}{\\Delta x}\\right),\n$$\n其中，双参数 minmod 函数定义为：\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\, \\min\\!\\left(|a|,\\, |b|\\right),  \\text{if } \\operatorname{sign}(a) = \\operatorname{sign}(b), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n给定单元平均数据 $u_{i-1} = 0$、$u_{i} = 1$、$u_{i+1} = 1.1$ 和 $u_{i+2} = 1.2$ (无量纲)，计算受限斜率 $s_{i}$ 并以精确小数值的形式报告界面状态 $u_{i+\\frac{1}{2}}^{-}$ 和 $u_{i-\\frac{1}{2}}^{+}$。无需四舍五入。请以一个二元行矩阵 $\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big)$ 的形式提供最终答案。",
            "solution": "此问题要求我们使用带有 minmod 限制器的 MUSCL 格式，根据一组给定的单元平均值，计算受限斜率 $s_i$ 以及重构的界面状态 $u_{i+1/2}^-$ 和 $u_{i-1/2}^+$。\n\n首先，我们计算单元 $i$ 的两个单边斜率。\n后向差分（左侧斜率）为：\n$$\n\\text{slope}_{\\text{left}} = \\frac{u_{i} - u_{i-1}}{\\Delta x} = \\frac{1 - 0}{1} = 1.\n$$\n前向差分（右侧斜率）为：\n$$\n\\text{slope}_{\\text{right}} = \\frac{u_{i+1} - u_{i}}{\\Delta x} = \\frac{1.1 - 1}{1} = 0.1.\n$$\n接下来，我们将 minmod 限制器应用于这两个斜率，以求得单元 $i$ 的受限斜率 $s_i$。minmod 函数定义为：\n$$\ns_i = \\operatorname{minmod}(\\text{slope}_{\\text{left}}, \\text{slope}_{\\text{right}}) = \\operatorname{minmod}(1, 0.1).\n$$\n由于两个参数 1 和 0.1 均为正数（即 $\\operatorname{sign}(1) = \\operatorname{sign}(0.1)$），minmod 函数返回绝对值较小的那个参数：\n$$\ns_i = \\min(|1|, |0.1|) = 0.1.\n$$\n现在，我们可以计算单元 $i$ 界面处的重构状态了。\n单元 $i$ 右侧界面（$x_{i+1/2}$）处的状态为：\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i} + \\frac{\\Delta x}{2}\\, s_{i} = 1 + \\frac{1}{2} \\times 0.1 = 1 + 0.05 = 1.05.\n$$\n单元 $i$ 左侧界面（$x_{i-1/2}$）处的状态为：\n$$\nu_{i-\\frac{1}{2}}^{+} = u_{i} - \\frac{\\Delta x}{2}\\, s_{i} = 1 - \\frac{1}{2} \\times 0.1 = 1 - 0.05 = 0.95.\n$$\n计算中用不到 $u_{i+2}=1.2$ 这个值，因为单元 $i$ 中的斜率 $s_i$ 仅依赖于单元 $i-1$、$i$ 和 $i+1$ 中的值。\n\n所求答案为行矩阵 $\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big)$：\n$$\n\\big(u_{i+\\frac{1}{2}}^{-},\\, u_{i-\\frac{1}{2}}^{+}\\big) = (1.05, 0.95).\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.05  0.95 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了限制器的基本计算后，我们来探讨其理论性能。本练习引导您分析一个经典的TVD格式问题：在解的光滑极值点处精度下降 [@problem-id:3959553]。通过推导`minmod`限制器在该情况下的行为，您将揭示高分辨率格式为何会“削平”解的峰值，并从一阶截断误差的角度理解其内在机制。",
            "id": "3959553",
            "problem": "考虑一维线性平流方程 $u_t + a\\,u_x = 0$，其中平流速度 $a0$ 为常数，且方程在一个间距为 $\\Delta x$ 的均匀网格上求解。使用带有守恒律的单调上游中心格式 (Monotonic Upstream-centered Schemes for Conservation Laws, MUSCL) 重构和 minmod 通量限制器的守恒有限体积离散化方法，以获得用于迎风 Godunov 通量的左右界面状态。在每个单元 $i$ 中，定义后向差分 $\\Delta^- u_i = u_i - u_{i-1}$ 和前向差分 $\\Delta^+ u_i = u_{i+1} - u_i$，以及受限斜率 $s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i)$，其中 minmod 函数为\n$$\n\\operatorname{minmod}(p,q) =\n\\begin{cases}\n\\operatorname{sgn}(p)\\,\\min\\{|p|,|q|\\},  \\text{if } pq>0,\\\\\n0,  \\text{if } pq \\le 0.\n\\end{cases}\n$$\n在 $x_{i+1/2}$ 处的左状态为 $u_{i+1/2}^- = u_i + \\tfrac{1}{2}s_i$，数值通量为 $F_{i+1/2} = a\\,u_{i+1/2}^-.$。假设精确解是光滑的，并且在位于 $x_i$ 处的单元 $i$ 中有一个严格的局部极值点，因此 $u_x(x_i)=0$ 且 $u_{xx}(x_i)\\neq 0$，同时高阶导数有界。仅使用基本定义（守恒律、关于 $x_i$ 的泰勒展开以及 minmod 限制器的定义），确定该半离散格式在 $x_i$ 处的局部空间精度阶，并阐明该格式在该处失去二阶特性的机制。\n\n哪种说法最能描述 $x_i$ 附近的精度阶及其机制？\n\nA. 由于当 $u_{xx}(x_i)\\neq 0$ 时，$\\Delta^+ u_i$ 和 $\\Delta^- u_i$ 的符号相反，限制器在一阶上得到 $s_i=0$。因此，重构变为分段常数，格式局部退化为迎风差分，且在 $x_i$ 处的空间截断误差量级为 $\\mathcal{O}(\\Delta x)$。\n\nB. 格式保持二阶，因为即使 $s_i=0$，每个界面通量 $F_{i\\pm 1/2}$ 与精确通量之差也为 $\\mathcal{O}(\\Delta x^2)$，这确保了在 $x_i$ 处的截断误差为 $\\mathcal{O}(\\Delta x^2)$。\n\nC. 由于 $u_x(x_i)=0$ 消除了主误差项，格式在极值点处恰好变为三阶，留下的截断误差量级为 $\\mathcal{O}(\\Delta x^3)$。\n\nD. 限制器在相邻单元中产生符号相反的非零斜率，导致色散振荡，并且在 $x_i$ 附近没有明确定义的精度阶。",
            "solution": "用户希望我解决并分析一个关于偏微分方程数值方法的问题，具体是关于带有 minmod 限制器的 MUSCL 格式在光滑极值点处的行为。\n\n### 第一步：提取已知条件\n\n-   **控制方程**：一维线性平流方程，$u_t + a\\,u_x = 0$，平流速度 $a0$ 为常数。\n-   **网格**：间距为 $\\Delta x$ 的均匀网格。\n-   **离散化方法**：带有守恒律的单调上游中心格式 (MUSCL) 重构的守恒有限体积法。\n-   **通量计算**：迎风 Godunov 通量。\n-   **单元 i 的定义**：\n    -   后向未除差分：$\\Delta^- u_i = u_i - u_{i-1}$。\n    -   前向未除差分：$\\Delta^+ u_i = u_{i+1} - u_i$。\n    -   受限斜率：$s_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i)$。\n-   **Minmod 函数定义**：\n    $$\n    \\operatorname{minmod}(p,q) =\n    \\begin{cases}\n    \\operatorname{sgn}(p)\\,\\min\\{|p|,|q|\\},  pq0,\\\\\n    0,  pq \\le 0.\n    \\end{cases}\n    $$\n-   **界面状态与通量**：\n    -   $x_{i+1/2}$ 处的左状态：$u_{i+1/2}^- = u_i + \\tfrac{1}{2}s_i$。\n    -   $x_{i+1/2}$ 处的数值通量：$F_{i+1/2} = a\\,u_{i+1/2}^-$。\n-   **解的性质**：精确解 $u(x,t)$ 是光滑的，并且在位于 $x_i$ 处的单元 $i$ 中有一个严格的局部极值点。\n-   **极值点处的条件**：在 $x_i$ 处，$u_x(x_i)=0$ 且 $u_{xx}(x_i)\\neq 0$。高阶导数有界。\n\n### 第二步：使用提取的已知条件进行验证\n\n问题陈述描述了高分辨率、激波捕捉数值格式分析中的一个标准场景。线性平流方程是一个基本的模型方程。带有通量限制器的 MUSCL 方法是现代计算流体动力学的基石。minmod 限制器是最简单和最常见的总变差递减 (TVD) 限制器之一。分析这种格式在光滑极值点处的行为是评估其属性的经典方法，特别是对于著名的“极值削平”或精度损失现象。\n\n所有术语都定义精确，提供的数据是自洽的。该问题具有科学依据，是适定的，并且是客观陈述的。这是一个数值分析中的形式化问题，需要从所提供的定义出发进行推导。\n\n### 结论与行动\n\n问题陈述是**有效的**。我将继续进行推导和分析。\n\n### 基于原理的推导\n\n单元 $i$ 的半离散有限体积格式由守恒律给出：\n$$\n\\frac{du_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n在 $x_i$ 处的局部空间截断误差定义为将精确解代入半离散格式后得到的残差：\n$$\n\\tau_i = \\frac{du_i}{dt} - (-a\\,u_x(x_i)) = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) + a\\,u_x(x_i)\n$$\n问题指明，在我们关心的点 $x_i$ 处，精确解有一个严格的局部极值点，所以 $u_x(x_i)=0$。截断误差简化为：\n$$\n\\tau_i = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n我们必须确定当 $\\Delta x \\to 0$ 时该项的主阶行为。这需要计算数值通量 $F_{i+1/2}$ 和 $F_{i-1/2}$。\n\n**1. 分析单元 $i$ 中的限制器：**\n受限斜率 $s_i$ 取决于未除差分 $\\Delta^- u_i = u_i - u_{i-1}$ 和 $\\Delta^+ u_i = u_{i+1} - u_i$。我们围绕 $x_i$ 对精确解 $u(x)$ 进行泰勒级数展开，为了确定精度阶，我们假设单元平均值 $u_j$ 等于点值 $u(x_j)$。\n$$\nu(x_j) = u(x_i + (j-i)\\Delta x) = u(x_i) + (j-i)\\Delta x u_x(x_i) + \\frac{((j-i)\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n使用 $u_x(x_i)=0$，我们有：\n$$\nu_{i-1} \\approx u(x_{i-1}) = u_i + \\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n$$\nu_{i+1} \\approx u(x_{i+1}) = u_i + \\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n现在我们计算差分：\n$$\n\\Delta^- u_i = u_i - u_{i-1} = u_i - \\left(u_i + \\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\dots\\right) = -\\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n$$\n\\Delta^+ u_i = u_{i+1} - u_i = \\left(u_i + \\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\dots\\right) - u_i = \\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n由于 $u_{xx}(x_i)\\neq 0$，$\\Delta^- u_i$ 和 $\\Delta^+ u_i$ 的主阶项符号相反。它们的乘积为负：$(\\Delta^- u_i)(\\Delta^+ u_i)  0$。\n根据 minmod 函数的定义，如果参数的乘积非正，则结果为零。因此，单元 $i$ 中的受限斜率为：\n$$\ns_i = \\operatorname{minmod}(\\Delta^- u_i, \\Delta^+ u_i) = 0\n$$\n\n**2. 计算通量 $F_{i+1/2}$：**\n由于 $s_i=0$，单元 $i$ 中的重构是分段常数。界面 $x_{i+1/2}$ 处的左状态为：\n$$\nu_{i+1/2}^- = u_i + \\frac{1}{2}s_i = u_i\n$$\n由于 $a0$，Godunov 通量是迎风通量，它取自左侧（迎风侧）的状态：\n$$\nF_{i+1/2} = a\\,u_{i+1/2}^- = a\\,u_i\n$$\n这正是一阶迎风格式的数值通量。\n\n**3. 计算通量 $F_{i-1/2}$：**\n$x_{i-1/2}$ 处的通量由单元 $i-1$ 中的重构决定。由于 $a0$，$F_{i-1/2} = a\\,u_{i-1/2}^{-}$，其中 $u_{i-1/2}^- = u_{i-1} + \\frac{1}{2}s_{i-1}$。我们需要找到 $s_{i-1}$。\n$$\ns_{i-1} = \\operatorname{minmod}(\\Delta^- u_{i-1}, \\Delta^+ u_{i-1}) = \\operatorname{minmod}(u_{i-1}-u_{i-2}, u_i-u_{i-1})\n$$\n我们需要 $u_{i-2} \\approx u(x_i - 2\\Delta x)$ 的泰勒展开：\n$$\nu_{i-2} = u_i - 2\\Delta x u_x(x_i) + \\frac{(2\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3) = u_i + 2(\\Delta x)^2 u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n限制器的参数为：\n$$\n\\Delta^+ u_{i-1} = u_i - u_{i-1} = -\\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n$$\n\\Delta^- u_{i-1} = u_{i-1} - u_{i-2} = \\left(u_i + \\frac{(\\Delta x)^2}{2} u_{xx}(x_i)\\right) - \\left(u_i + 2(\\Delta x)^2 u_{xx}(x_i)\\right) + \\mathcal{O}(\\Delta x^3) = -\\frac{3}{2}(\\Delta x)^2 u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)\n$$\n两个参数符号相同（与 $u_{xx}(x_i)$ 的符号相反），因此它们的乘积为正。minmod 函数将返回绝对值较小的参数。\n$$\n|\\Delta^+ u_{i-1}| = \\frac{(\\Delta x)^2}{2} |u_{xx}(x_i)|, \\quad |\\Delta^- u_{i-1}| = \\frac{3(\\Delta x)^2}{2} |u_{xx}(x_i)|\n$$\n显然，$|\\Delta^+ u_{i-1}|$ 更小。因此：\n$$\ns_{i-1} = \\operatorname{sgn}(\\Delta^+ u_{i-1}) \\min(|\\Delta^- u_{i-1}|, |\\Delta^+ u_{i-1}|) = \\Delta^+ u_{i-1} = u_i - u_{i-1}\n$$\n现在，我们找到重构的状态和通量：\n$$\nu_{i-1/2}^- = u_{i-1} + \\frac{1}{2}s_{i-1} = u_{i-1} + \\frac{1}{2}(u_i - u_{i-1}) = \\frac{u_i + u_{i-1}}{2}\n$$\n$$\nF_{i-1/2} = a\\,u_{i-1/2}^- = a\\frac{u_i + u_{i-1}}{2}\n$$\n\n**4. 计算截断误差：**\n将通量代回 $\\tau_i$ 的表达式中：\n$$\n\\tau_i = -\\frac{1}{\\Delta x} \\left(a\\,u_i - a\\frac{u_i + u_{i-1}}{2}\\right) = -\\frac{a}{\\Delta x} \\left(\\frac{2u_i - u_i - u_{i-1}}{2}\\right) = -\\frac{a}{2\\Delta x}(u_i - u_{i-1})\n$$\n最后，代入 $u_i - u_{i-1}$ 的泰勒展开：\n$$\n\\tau_i = -\\frac{a}{2\\Delta x} \\left( -\\frac{(\\Delta x)^2}{2} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3) \\right) = \\frac{a \\Delta x}{4} u_{xx}(x_i) + \\mathcal{O}(\\Delta x^2)\n$$\n由于 $u_{xx}(x_i) \\neq 0$，截断误差的主项与 $\\Delta x$ 成正比。格式的空间精度在极值点退化为一阶。\n\n### 逐项分析选项\n\n**A. 由于当 $u_{xx}(x_i)\\neq 0$ 时，$\\Delta^+ u_i$ 和 $\\Delta^- u_i$ 的符号相反，限制器在一阶上得到 $s_i=0$。因此，重构变为分段常数，格式局部退化为迎风差分，且在 $x_i$ 处的空间截断误差量级为 $\\mathcal{O}(\\Delta x)$。**\n- **机制 ($s_i=0$)**：我的推导表明，由于 $u_x(x_i)=0$ 和 $u_{xx}(x_i)\\neq 0$，前向和后向差分 $\\Delta^+ u_i$ 和 $\\Delta^- u_i$ 的确符号相反。minmod 限制器根据其定义，在这种情况下返回 0。这是正确的。\n- **重构**：当 $s_i=0$ 时，重构 $u(x) = u_i + s_i(x-x_i)/\\Delta x$（在其正确缩放的形式下）变为 $u(x)=u_i$，即分段常数。这是正确的。\n- **格式退化**：单元下游界面 $F_{i+1/2}$ 处的通量变为 $a\\,u_i$，这正是一阶迎风格式的通量。虽然 $du_i/dt$ 的整个模板与标准一阶迎风格式不完全相同（因为通量 $F_{i-1/2}$ 的原因），但这种描述是常见的，并抓住了精度损失的本质原因。格式局部变得耗散且为一阶，这是一阶迎风格式的标志。\n- **截断误差**：我的推导证实了截断误差 $\\tau_i$ 是 $\\mathcal{O}(\\Delta x)$。\n这个陈述准确地描述了整个因果链。\n**结论：正确**\n\n**B. 格式保持二阶，因为即使 $s_i=0$，每个界面通量 $F_{i\\pm 1/2}$ 与精确通量之差也为 $\\mathcal{O}(\\Delta x^2)$，这确保了在 $x_i$ 处的截断误差为 $\\mathcal{O}(\\Delta x^2)$。**\n- **前提（通量误差）**：我们来检查单个通量的误差。界面 $x_{i+1/2}$ 处的精确通量是 $a\\,u(x_{i+1/2})$。\n    - $F_{i+1/2} - a\\,u(x_{i+1/2}) = a\\,u_i - a(u_i + \\frac{\\Delta x}{2}u_x(x_i) + \\frac{(\\Delta x)^2}{8}u_{xx}(x_i) + \\dots) = -a\\frac{(\\Delta x)^2}{8}u_{xx}(x_i) + \\mathcal{O}(\\Delta x^3)$。误差是 $\\mathcal{O}(\\Delta x^2)$。\n    - $F_{i-1/2} - a\\,u(x_{i-1/2}) = a\\frac{u_i+u_{i-1}}{2} - a(u_i - \\frac{\\Delta x}{2}u_x(x_i) + \\frac{(\\Delta x)^2}{8}u_{xx}(x_i) + \\dots)$。代入 $u_{i-1} \\approx u_i + \\frac{(\\Delta x)^2}{2}u_{xx}(x_i)$，我们得到 $a\\frac{2u_i + (\\Delta x)^2/2 u_{xx}}{2} - a(u_i + \\frac{(\\Delta x)^2}{8}u_{xx}) = a(u_i + \\frac{(\\Delta x)^2}{4}u_{xx}) - a(u_i + \\frac{(\\Delta x)^2}{8}u_{xx}) = a\\frac{\\Delta x^2}{8}u_{xx} + \\dots$。通量*确实*是单个二阶精确的。\n- **结论（总截断误差）**：该陈述声称这确保了 $\\mathcal{O}(\\Delta x^2)$ 的总截断误差。这是错误的。截断误差是 $\\tau_i = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}$。两个通量的误差分别为 $-a\\frac{(\\Delta x)^2}{8}u_{xx}$ 和 $+a\\frac{(\\Delta x)^2}{8}u_{xx}$ 左右。通量差的误差是 $\\mathcal{O}(\\Delta x^2)$，除以 $\\Delta x$ 后得到一个 $\\mathcal{O}(\\Delta x)$ 的截断误差。这些误差没有像二阶格式所要求的那样相互抵消。\n该陈述做出了一个正确的观察，但得出了一个错误的结论。\n**结论：错误**\n\n**C. 由于 $u_x(x_i)=0$ 消除了主误差项，格式在极值点处恰好变为三阶，留下的截断误差量级为 $\\mathcal{O}(\\Delta x^3)$。**\n二阶格式的主误差项通常与 $u_{xxx}(\\Delta x)^2$ 成正比。条件 $u_x(x_i)=0$ 不影响此项。相反，条件 $u_x(x_i)=0$ 与 $u_{xx}(x_i) \\neq 0$ 结合会触发限制器，从而从根本上将格式改变为一阶。声称变为三阶是没有根据的。\n**结论：错误**\n\n**D. 限制器在相邻单元中产生符号相反的非零斜率，导致色散振荡，并且在 $x_i$ 附近没有明确定义的精度阶。**\n- **相邻单元中的斜率**：我们发现 $s_i=0$。对于相邻单元，$s_{i-1}=u_i-u_{i-1} \\approx -\\frac{(\\Delta x)^2}{2}u_{xx}(x_i)$，对 $s_{i+1}$ 进行类似计算可得 $s_{i+1}=u_{i+1}-u_i \\approx \\frac{(\\Delta x)^2}{2}u_{xx}(x_i)$。它们是非零的且符号相反。陈述的这一部分是正确的。\n- **结论（振荡和阶）**：关于“色散振荡”的说法是不正确的。TVD 格式根据其设计是非振荡的。极值的削平是一种耗散误差，而不是色散误差。关于“没有明确定义的阶”的说法也是错误的，因为我们的分析清楚地显示了一个明确定义的一阶截断误差，$\\tau_i = \\mathcal{O}(\\Delta x)$。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "前面的练习集中于一维结构化网格上的预定义限制器，而本练习将概念推广到更普遍的非结构化网格场景。您将从局部最大值原理这一基本原则出发，推导Barth-Jespersen限制器的表达式 [@problem-id:3959579]。这个过程展示了如何在复杂的几何构型中保证数值解的单调性，是高级CFD实践中的一项核心技能。",
            "id": "3959579",
            "problem": "考虑在计算流体动力学（CFD）中，对无粘可压缩流的标量守恒变量 $u$ 进行有限体积离散化。在一个非结构化网格上，设单元 $i$ 的形心为 $\\boldsymbol{x}_{i}$，体积为 $V_{i}$，其面集为 $\\mathcal{F}(i)$。将单元 $i$ 内的单元平均值记为 $u_{i}$，将满足与相邻单元平均值兼容性条件的一致性线性重构梯度（例如，通过最小二乘法得到）记为 $\\nabla u_{i}$。定义从单元 $i$ 出发的无约束线性面心重构为\n$$\nu_{i}^{\\mathrm{rec}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i),\n$$\n其中 $\\boldsymbol{x}_{f}$ 是面 $f$ 的几何面心。引入一个标量限制器系数 $\\alpha_{i}\\in[0,1]$，它缩放梯度并产生受限的面心重构\n$$\nu_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right), \\quad f\\in \\mathcal{F}(i).\n$$\n设单元 $i$ 中的局部单调性界限由紧邻的面相邻模板 $\\mathcal{N}(i)$（包括 $i$ 本身）定义为\n$$\nu_{i}^{\\min}\\equiv \\min_{j\\in \\mathcal{N}(i)} u_{j}, \\qquad u_{i}^{\\max}\\equiv \\max_{j\\in \\mathcal{N}(i)} u_{j}.\n$$\n施加离散局部极值原理，即每个受限的面心值都位于局部界限内：\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\\quad \\text{for all } f\\in \\mathcal{F}(i).\n$$\n仅从这些定义和要求 $\\,\\alpha_{i}\\in[0,1]\\,$ 出发，推导 Barth–Jespersen 限制器系数 $\\,\\alpha_{i}\\,$ 的显式闭式表达式，该系数应在确保对所有面 $f\\in \\mathcal{F}(i)$ 满足上述面心不等式的前提下尽可能大。你的最终表达式必须仅用 $\\,u_{i}$、$\\,u_{i}^{\\min}$、$\\,u_{i}^{\\max}$、几何偏移量 $\\,\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}$ 以及梯度 $\\,\\nabla u_{i}$ 来表示。定义你引入的任何中间符号。将你的最终答案表示为单个闭式解析表达式。无需进行数值评估，也不涉及单位。",
            "solution": "所述问题需要经过验证。\n\n### 步骤 1：提取已知条件\n-   标量守恒变量: $u$\n-   单元索引: $i$\n-   单元形心: $\\boldsymbol{x}_{i}$\n-   单元体积: $V_{i}$\n-   单元 $i$ 的面集: $\\mathcal{F}(i)$\n-   单元平均值: $u_{i}$\n-   重构梯度: $\\nabla u_{i}$\n-   无约束面心重构: $u_{i}^{\\mathrm{rec}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$\n-   面心: $\\boldsymbol{x}_{f}$\n-   限制器系数: $\\alpha_{i} \\in [0,1]$\n-   受限面心重构: $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\equiv u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$\n-   单元 $i$ 的相邻模板: $\\mathcal{N}(i)$ (包含 $i$ 及其面相邻单元)\n-   局部单调性界限: $u_{i}^{\\min}\\equiv \\min_{j\\in \\mathcal{N}(i)} u_{j}$ 和 $u_{i}^{\\max}\\equiv \\max_{j\\in \\mathcal{N}(i)} u_{j}$\n-   需要强制执行的离散局部极值原理: 对所有面 $f\\in \\mathcal{F}(i)$，$u_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}$。\n-   目标: 找到满足给定条件的最大可能 $\\alpha_{i}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了 Barth-Jespersen 通量限制器的标准推导过程，这是计算流体动力学（CFD）中用于在二阶有限体积格式中强制执行单调性的一项基本技术。该问题是适定的、客观的且自洽的。所有术语均按该领域的常规方式定义。没有矛盾、歧义或缺失的信息。前提条件在事实上是合理的，并直接关系到已建立的数学和物理建模原理。\n\n### 步骤 3：结论与行动\n该问题有效。将制定一个合理的解决方案。\n\nBarth-Jespersen 限制器系数 $\\alpha_{i}$ 的推导始于所施加的离散局部极值原理。对于单元 $i$ 的每个面 $f \\in \\mathcal{F}(i)$，面心处的受限重构值 $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f})$ 必须位于相邻单元平均值的局部最小值和最大值之间。该条件表示为一对不等式：\n$$\nu_{i}^{\\min} \\le u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) \\le u_{i}^{\\max}\n$$\n代入受限重构的定义 $u_{i}^{\\mathrm{lim}}(\\boldsymbol{x}_{f}) = u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)$，我们得到：\n$$\nu_{i}^{\\min} \\le u_{i} + \\alpha_{i}\\,\\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right) \\le u_{i}^{\\max}\n$$\n为了简化符号，我们将面上的无约束重构值与单元中心值之差定义为：\n$$\n\\Delta u_{if} \\equiv \\nabla u_{i}\\cdot\\left(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}\\right)\n$$\n通过从所有部分减去 $u_{i}$，不等式可以重写为：\n$$\nu_{i}^{\\min} - u_{i} \\le \\alpha_{i} \\Delta u_{if} \\le u_{i}^{\\max} - u_{i}\n$$\n根据局部界限的定义，$u_{i}$ 是集合 $\\{u_j\\}_{j\\in\\mathcal{N}(i)}$ 中的值之一，因此可以保证 $u_{i}^{\\min} \\le u_{i} \\le u_{i}^{\\max}$。因此，项 $u_{i}^{\\min} - u_{i}$ 是非正的，而 $u_{i}^{\\max} - u_{i}$ 是非负的。\n\n我们的目标是找到满足对所有面 $f \\in \\mathcal{F}(i)$ 成立的此条件的最大 $\\alpha_i \\in [0,1]$。为此，我们首先找到每个面单独对 $\\alpha_i$ 施加的上限。分析取决于 $\\Delta u_{if}$ 的符号。\n\n情况 1：$\\Delta u_{if}  0$\n将不等式两边同除以正值 $\\Delta u_{if}$，不等式方向不变：\n$$\n\\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}} \\le \\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}\n$$\n由于 $u_{i}^{\\min} - u_{i} \\le 0$ 且 $\\Delta u_{if}  0$，所以 $\\alpha_{i}$ 的下界是非正的。考虑到约束 $\\alpha_{i} \\ge 0$，这个下界没有施加新的限制。因此，有效的约束是上限：\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}\n$$\n\n情况 2：$\\Delta u_{if}  0$\n将不等式两边同除以负值 $\\Delta u_{if}$，不等式方向反转：\n$$\n\\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}} \\le \\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}\n$$\n由于 $u_{i}^{\\max} - u_{i} \\ge 0$ 且 $\\Delta u_{if}  0$，所以 $\\alpha_{i}$ 的下界是非正的。同样，这被 $\\alpha_{i} \\ge 0$ 的要求所取代。有效的约束是上限。注意到 $u_{i}^{\\min} - u_{i} \\le 0$，所以该比值为非负，满足作为 $\\alpha_{i}$ 上限的要求：\n$$\n\\alpha_{i} \\le \\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}\n$$\n\n情况 3：$\\Delta u_{if} = 0$\n不等式变为 $u_{i}^{\\min} - u_{i} \\le 0 \\le u_{i}^{\\max} - u_{i}$，这总是成立的。在这种情况下，$\\alpha_{i}$ 的值不受这个特定面的约束。我们可以认为这个面的上限是无穷大。\n\n综合这些情况，对于每个面 $f \\in \\mathcal{F}(i)$，我们可以定义一个限制值 $\\phi_f$，使得 $\\alpha_i \\le \\phi_f$：\n$$\n\\phi_f = \\begin{cases}\n\\frac{u_{i}^{\\max} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n\\frac{u_{i}^{\\min} - u_{i}}{\\Delta u_{if}}  \\text{if } \\Delta u_{if}  0 \\\\\n+\\infty  \\text{if } \\Delta u_{if} = 0\n\\end{cases}\n$$\n其中 $\\Delta u_{if} = \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})$。\n\n为使单调性原理成立，所选的限制器 $\\alpha_i$ 必须同时满足所有面的条件。因此，$\\alpha_i$ 必须小于或等于所有这些单独界限的最小值：\n$$\n\\alpha_i \\le \\min_{f \\in \\mathcal{F}(i)} \\phi_f\n$$\n最后，我们还必须强制执行给定的约束 $\\alpha_i \\in [0,1]$。由于每个 $\\phi_f$ 都是非负的，如果我们寻求最大可能值，则约束 $\\alpha_i \\ge 0$ 自然得到满足。必须明确包含约束 $\\alpha_i \\le 1$。因此，最终的限制器系数 $\\alpha_i$ 是满足所有约束的最大值，通过取 $1$ 和所有基于面的界限的最小值得到：\n$$\n\\alpha_i = \\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\phi_f \\right)\n$$\n代入 $\\phi_f$ 的分段定义，即可得到 Barth-Jespersen 限制器系数的完整表达式。",
            "answer": "$$\n\\boxed{\\min \\left( 1, \\min_{f \\in \\mathcal{F}(i)} \\begin{cases} \\frac{u_{i}^{\\max} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}) > 0 \\\\ \\frac{u_{i}^{\\min} - u_{i}}{\\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})}  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i})  0 \\\\ +\\infty  \\text{if } \\nabla u_{i}\\cdot(\\boldsymbol{x}_{f}-\\boldsymbol{x}_{i}) = 0 \\end{cases} \\right)}\n$$"
        }
    ]
}