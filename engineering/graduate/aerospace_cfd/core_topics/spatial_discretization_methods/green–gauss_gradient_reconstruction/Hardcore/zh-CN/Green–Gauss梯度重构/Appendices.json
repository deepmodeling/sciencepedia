{
    "hands_on_practices": [
        {
            "introduction": "格林-高斯梯度重构的核心在于将体积分转化为面积分，而这一过程始于对控制体几何特性的精确描述。本练习将带你从基本原理出发，为四面体控制体的每个面计算其有向面积矢量，并验证构成一个封闭控制体所必需的基本几何属性，即所有面矢量之和为零。",
            "id": "3963607",
            "problem": "在计算流体力学（CFD）的有限体积法（FVM）中使用的Green–Gauss（GG）梯度重构中，每个面对离散梯度的贡献与其定向面矢量成正比。控制体的封闭性意味着一个封闭多面体的所有定向面矢量的和为零。仅从散度定理和定向面矢量的定义出发，推导出一个三角形面的面矢量关于其顶点坐标的计算上一致的表达式，包括一个基于单元中心的稳健的向外定向准则。\n\n考虑一个四面体控制体，其顶点坐标（单位：米）如下：\n- $\\mathbf{r}_1 = (0,\\,0,\\,0)$,\n- $\\mathbf{r}_2 = (1,\\,0,\\,0)$,\n- $\\mathbf{r}_3 = (0,\\,2,\\,0)$,\n- $\\mathbf{r}_4 = (0,\\,0,\\,3)$.\n\n任务：\n1. 仅使用散度定理和曲面积分的几何定义，推导出一个顶点为 $\\mathbf{r}_a$、$\\mathbf{r}_b$、$\\mathbf{r}_c$ 的三角形面的面矢量关于其边向量的表达式。你的推导必须明确展示面矢量的方向是如何确定的，以及如何使用单元中心 $\\mathbf{r}_P$ 来强制向外定向。\n2. 计算四个面 $(1,2,3)$、$(1,2,4)$、$(1,3,4)$ 和 $(2,3,4)$ 的定向面矢量 $\\mathbf{S}_f$，确保其相对于四面体中心是向外定向的。\n3. 通过将四个面矢量求和来数值验证封闭性，并计算残差向量的欧几里得范数 $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$。\n\n提供 $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$ 的值作为最终答案，单位为平方米，并保留六位有效数字。以 $\\mathrm{m}^2$ 表示最终值。",
            "solution": "问题要求推导三角形定向面矢量的公式，将其应用于一个特定的四面体，并验证其封闭性（$\\sum_f \\mathbf{S}_f = \\mathbf{0}$）。\n\n### 步骤1：面矢量表达式的推导\n\n问题要求从散度定理开始推导。广义斯托克斯定理（也称为开尔文-斯托克斯定理或高维散度定理）为此提供了必要的基础。对于体积 $V$ 内边界为曲面 $S = \\partial V$ 的向量场 $\\mathbf{F}$，该定理表述为：\n$$ \\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_S \\mathbf{F} \\cdot d\\mathbf{S} $$\n其中 $d\\mathbf{S} = \\mathbf{n} dS$ 是向外定向的面元矢量。\n\n题目要求得到单个面 $\\mathbf{S}_f = \\int_f d\\mathbf{S}$ 的面积矢量表达式。一个有效的方法是使用一个相关的定理，通常也称为斯托克斯定理，它将曲面积分与其边界曲线 $C = \\partial f$ 上的线积分联系起来：\n$$ \\int_f (\\nabla \\times \\mathbf{F}) \\cdot d\\mathbf{S} = \\oint_C \\mathbf{F} \\cdot d\\mathbf{l} $$\n这个形式可以从广义散度定理推导出来。为了找到 $\\mathbf{S}_f$ 的表达式，我们需要找到一个向量场 $\\mathbf{F}$，使其旋度为一个常向量。设 $\\mathbf{c}$ 为任意常向量，并考虑场 $\\mathbf{F} = \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r})$，其中 $\\mathbf{r}$ 是位置向量 $\\mathbf{r} = x\\mathbf{i} + y\\mathbf{j} + z\\mathbf{k}$。\n\n$\\mathbf{F}$ 的旋度是：\n$$ \\nabla \\times \\mathbf{F} = \\nabla \\times \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) = \\frac{1}{2} \\left[ (\\mathbf{r} \\cdot \\nabla)\\mathbf{c} - (\\mathbf{c} \\cdot \\nabla)\\mathbf{r} + \\mathbf{c}(\\nabla \\cdot \\mathbf{r}) - \\mathbf{r}(\\nabla \\cdot \\mathbf{c}) \\right] $$\n已知 $\\mathbf{c}$ 是一个常向量，则 $(\\mathbf{r} \\cdot \\nabla)\\mathbf{c} = \\mathbf{0}$ 且 $\\nabla \\cdot \\mathbf{c} = 0$。我们还有 $\\nabla \\cdot \\mathbf{r} = 3$ 和 $(\\mathbf{c} \\cdot \\nabla)\\mathbf{r} = \\mathbf{c}$。将这些代入旋度表达式中得到：\n$$ \\nabla \\times \\mathbf{F} = \\frac{1}{2} [ \\mathbf{0} - \\mathbf{c} + 3\\mathbf{c} - \\mathbf{0} ] = \\mathbf{c} $$\n现在，将 $\\nabla \\times \\mathbf{F} = \\mathbf{c}$ 代入斯托克斯定理：\n$$ \\int_f \\mathbf{c} \\cdot d\\mathbf{S} = \\oint_C \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) \\cdot d\\mathbf{l} $$\n由于 $\\mathbf{c}$ 是常数，我们可以将其从左侧积分中提出。在右侧，我们使用标量三重积恒等式 $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{C} \\cdot (\\mathbf{A} \\times \\mathbf{B})$：\n$$ \\mathbf{c} \\cdot \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C (\\mathbf{c} \\times \\mathbf{r}) \\cdot d\\mathbf{l} = \\frac{1}{2} \\oint_C \\mathbf{c} \\cdot (\\mathbf{r} \\times d\\mathbf{l}) $$\n同样，由于 $\\mathbf{c}$ 是常数：\n$$ \\mathbf{c} \\cdot \\left( \\int_f d\\mathbf{S} \\right) = \\mathbf{c} \\cdot \\left( \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} \\right) $$\n这个等式必须对任意常向量 $\\mathbf{c}$ 都成立，这意味着向量本身必须相等：\n$$ \\mathbf{S}_f = \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} $$\n对于按顺序遍历的顶点为 $\\mathbf{r}_a, \\mathbf{r}_b, \\mathbf{r}_c$ 的三角形面，其边界 $C$ 由三条直边组成。线积分变为一个和式：\n$$ \\mathbf{S}_f = \\frac{1}{2} \\left[ \\int_{\\mathbf{r}_a}^{\\mathbf{r}_b} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_b}^{\\mathbf{r}_c} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_c}^{\\mathbf{r}_a} \\mathbf{r} \\times d\\mathbf{r} \\right] $$\n沿从 $\\mathbf{r}_a$ 到 $\\mathbf{r}_b$ 的边的积分计算结果为 $\\mathbf{r}_a \\times \\mathbf{r}_b$。类似地，其他积分的值分别为 $\\mathbf{r}_b \\times \\mathbf{r}_c$ 和 $\\mathbf{r}_c \\times \\mathbf{r}_a$。因此，\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_a \\times \\mathbf{r}_b + \\mathbf{r}_b \\times \\mathbf{r}_c + \\mathbf{r}_c \\times \\mathbf{r}_a) $$\n这个表达式等价于使用边向量的更常见的形式：\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a) $$\n\n$\\mathbf{S}_f$ 的方向取决于顶点的顺序。对于一个封闭的控制体，该矢量必须指向外部。一个稳健的准则是将其方向与从单元中心 $\\mathbf{r}_P$ 指向面中心 $\\mathbf{r}_f$ 的向量进行比较。向量 $\\mathbf{d}_f = \\mathbf{r}_f - \\mathbf{r}_P$ 从单元内部指向该面。向外的法向量 $\\mathbf{S}_f$ 在该向量上的投影必须为正。\n步骤如下：\n1.  使用任意（但一致）的顶点顺序计算一个临时面积矢量 $\\mathbf{S}_{\\text{tentative}}$，例如 $\\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a)$。\n2.  计算单元中心 $\\mathbf{r}_P = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{r}_i$ 和面中心 $\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_a + \\mathbf{r}_b + \\mathbf{r}_c)$。\n3.  检查点积的符号：$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P)$。\n4.  如果点积为正，则方向正确：$\\mathbf{S}_f = \\mathbf{S}_{\\text{tentative}}$。\n5.  如果点积为负，则方向不正确，必须反转：$\\mathbf{S}_f = -\\mathbf{S}_{\\text{tentative}}$。\n\n### 步骤2：定向面矢量的计算\n\n给定顶点为 $\\mathbf{r}_1 = (0,\\,0,\\,0)$，$\\mathbf{r}_2 = (1,\\,0,\\,0)$，$\\mathbf{r}_3 = (0,\\,2,\\,0)$ 和 $\\mathbf{r}_4 = (0,\\,0,\\,3)$。\n四面体的单元中心 $\\mathbf{r}_P$ 为：\n$$ \\mathbf{r}_P = \\frac{1}{4}(\\mathbf{r}_1 + \\mathbf{r}_2 + \\mathbf{r}_3 + \\mathbf{r}_4) = \\frac{1}{4}( (0+1+0+0), (0+0+2+0), (0+0+0+3) ) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}) $$\n$$ \\mathbf{r}_P = (0.25, 0.5, 0.75) $$\n\n**面 1: $(1,2,3)$**\n设 $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_3$。\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_1)) = \\frac{1}{2} ((1,\\,0,\\,0) \\times (0,\\,2,\\,0)) = \\frac{1}{2}(0,\\,0,\\,2) = (0,\\,0,\\,1)$。\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_3) = \\frac{1}{3}(1,\\,2,\\,0) = (\\frac{1}{3}, \\frac{2}{3}, 0)$。\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 0 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4})$。\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0,\\,0,\\,1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4}) = -\\frac{3}{4} < 0$。\n矢量指向内部。反转符号：$\\mathbf{S}_1 = -(0,\\,0,\\,1) = (0,\\,0,\\,-1)$。\n\n**面 2: $(1,2,4)$**\n设 $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_4$。\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((1,\\,0,\\,0) \\times (0,\\,0,\\,3)) = \\frac{1}{2}(0,\\,-3,\\,0) = (0,\\,-1.5,\\,0)$。\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_4) = \\frac{1}{3}(1,\\,0,\\,3) = (\\frac{1}{3}, 0, 1)$。\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, 0 - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4})$。\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0,\\,-1.5,\\,0) \\cdot (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4}) = (-1.5)(-\\frac{1}{2}) = 0.75 > 0$。\n矢量指向外部。$\\mathbf{S}_2 = (0,\\,-1.5,\\,0)$。\n\n**面 3: $(1,3,4)$**\n设 $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$。\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((0,\\,2,\\,0) \\times (0,\\,0,\\,3)) = \\frac{1}{2}(6,\\,0,\\,0) = (3,\\,0,\\,0)$。\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(0,\\,2,\\,3) = (0, \\frac{2}{3}, 1)$。\n$\\mathbf{r}_f - \\mathbf{r}_P = (0 - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4})$。\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3,\\,0,\\,0) \\cdot (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4}) = 3(-\\frac{1}{4}) = -0.75 < 0$。\n矢量指向内部。反转符号：$\\mathbf{S}_3 = -(3,\\,0,\\,0) = (-3,\\,0,\\,0)$。\n\n**面 4: $(2,3,4)$**\n设 $\\mathbf{r}_a=\\mathbf{r}_2, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$。\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_2) \\times (\\mathbf{r}_4 - \\mathbf{r}_2)) = \\frac{1}{2} ((-1,\\,2,\\,0) \\times (-1,\\,0,\\,3)) = \\frac{1}{2}(6,\\,3,\\,2) = (3,\\,1.5,\\,1)$。\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_2+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(1,\\,2,\\,3) = (\\frac{1}{3}, \\frac{2}{3}, 1)$。\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4})$。\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3,\\,1.5,\\,1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4}) = \\frac{3}{12} + \\frac{1.5}{6} + \\frac{1}{4} = 0.25 + 0.25 + 0.25 = 0.75 > 0$。\n矢量指向外部。$\\mathbf{S}_4 = (3,\\,1.5,\\,1)$。\n\n### 步骤3：封闭性验证\n\n对于一个封闭多面体，其封闭性要求所有定向面矢量的和为零向量。我们将计算出的四个矢量相加：\n$$ \\sum_{f=1}^4 \\mathbf{S}_f = \\mathbf{S}_1 + \\mathbf{S}_2 + \\mathbf{S}_3 + \\mathbf{S}_4 $$\n$$ \\sum \\mathbf{S}_f = (0,\\,0,\\,-1) + (0,\\,-1.5,\\,0) + (-3,\\,0,\\,0) + (3,\\,1.5,\\,1) $$\n$$ \\sum \\mathbf{S}_f = (0+0-3+3, \\quad 0-1.5+0+1.5, \\quad -1+0+0+1) $$\n$$ \\sum \\mathbf{S}_f = (0,\\,0,\\,0) $$\n残差向量为 $\\mathbf{R} = (0,\\,0,\\,0)$。残差向量的欧几里得范数为：\n$$ \\|\\mathbf{R}\\| = \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = \\sqrt{0^2 + 0^2 + 0^2} = 0 $$\n坐标单位为米，因此面面积的单位为平方米（$\\mathrm{m}^2$）。问题要求结果保留六位有效数字。\n$$ \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = 0.00000 \\ \\mathrm{m}^2 $$",
            "answer": "$$\\boxed{0.00000}$$"
        },
        {
            "introduction": "一个可靠的数值格式应在理想条件下表现出“精确性”，即能够无误差地复现简单场的梯度。在  的练习为我们奠定了坚实的几何基础后，我们将在此基础上，于均匀的笛卡尔网格上检验格林-高斯方法对线性标量场的梯度重构，从而验证其理论上的精确性。",
            "id": "3963600",
            "problem": "您的任务是从第一性原理出发，为均匀笛卡尔网格上的标量场设计并实现一个适用于计算流体力学 (CFD) 的格林-高斯梯度重构验证程序。其目标是通过测试多种配置来验证该方法对线性场的精确性，并证明计算出的梯度误差在机器精度范围内为零。该程序必须从散度定理和均匀笛卡尔网格上控制体积分的定义开始推导，不得依赖任何预先推导出的离散重构公式。\n\n均匀笛卡尔网格由 $x$ 和 $y$ 方向上的单元数量（记为 $n_x$ 和 $n_y$）、间距 $\\Delta x$ 和 $\\Delta y$ 以及区域左下角原点坐标 $(x_0,y_0)$ 定义。单元中心的坐标为 $x_i = x_0 + (i + \\tfrac{1}{2}) \\Delta x$（其中 $i \\in \\{0,1,\\dots,n_x-1\\}$）和 $y_j = y_0 + (j + \\tfrac{1}{2}) \\Delta y$（其中 $j \\in \\{0,1,\\dots,n_y-1\\}$）。考虑一个形式为 $\\phi(x,y) = a x + b y + c$ 的标量场，其中 $a$、$b$ 和 $c$ 为常数。\n\n您的任务是：\n- 从散度定理和基本的控制体定义出发，通过逻辑步骤推导出一个离散程序，该程序仅使用与均匀笛卡尔网格和线性场一致的单元中心值和面心近似值，在内部单元处重构梯度 $\\nabla \\phi$。\n- 在一个程序中实现所推导的程序，该程序能够构建网格，在所有单元中心计算 $\\phi$ 的值，在指定的内部单元处计算格林-高斯梯度重构，并将其与精确的解析梯度进行比较。\n- 使用重构梯度与精确解析梯度之差的无穷范数来量化误差，并在误差小于指定容差时宣布测试通过。对于本问题，除非另有说明，否则将“机器精度”视为绝对容差阈值 $\\epsilon = 10^{-12}$。\n\n您必须将评估限制在内部单元，以确保所有需要的相邻单元都存在，并且不需要进行边界建模（例如虚拟单元）。\n\n测试套件：\n对于每个测试用例，参数为 $(n_x,n_y,\\Delta x,\\Delta y,x_0,y_0,i,j,a,b,c,\\text{tol})$，其中 $(i,j)$ 分别表示目标内部单元在 $x$ 和 $y$ 方向上的索引，$\\text{tol}$ 是该用例要使用的误差容差。请使用以下五个测试用例：\n- 用例 1：$(16,12,0.2,0.3,-0.7,1.1,7,6,2.5,-1.25,0.7,10^{-12})$。\n- 用例 2：$(10,10,0.1,0.1,0.33,-0.42,1,8,-3.0,4.0,0.0,10^{-12})$。\n- 用例 3：$(6,6,10^{-8},2\\times 10^{-8},0.0,0.0,2,2,10.0,-20.0,0.3,10^{-12})$。\n- 用例 4：$(25,7,3.0,4\\times 10^{-4},-5.5,2.2,12,5,0.125,-0.75,10.0,10^{-12})$。\n- 用例 5：$(30,30,\\tfrac{1}{3},0.4,-0.2,0.6,14,13,-3.14159,2.71828,-1.0,10^{-12})$。\n\n对于每个用例，计算指定内部单元处的重构梯度，并将其与精确梯度 $(a,b)$ 进行比较。每个测试用例的结果必须是一个布尔值，表示无穷范数误差是否严格小于指定的容差。不涉及角度；不需要物理单位。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$），其中每个条目是对应于相应测试用例通过/失败结果的布尔值。",
            "solution": "任务是为均匀笛卡尔网格上的线性标量场推导并实现一个格林-高斯梯度重构方法的验证程序。推导必须源于第一性原理，特别是散度定理，并证明其精确性。\n\n格林-高斯定理是散度定理的一个推论，它提供了标量场 $\\phi$ 梯度的体积分与该场在体积边界上的面积分之间的关系。对于一个控制体 $V$ 及其边界面 $\\partial V$，该定理表述为：\n$$\n\\int_V \\nabla \\phi \\, dV = \\oint_{\\partial V} \\phi \\, \\mathbf{n} \\, dS\n$$\n其中 $\\mathbf{n}$ 是指向面元 $dS$ 外部的单位法向量。在有限体积法的背景下，我们对该恒等式进行近似。\n\n让我们考虑一个二维均匀笛卡尔网格上的目标内部单元 $(i,j)$。该单元本身构成了我们的控制体 $V_{i,j}$。此单元的中心坐标为 $(x_i, y_j)$，其中 $x_i = x_0 + (i + \\tfrac{1}{2}) \\Delta x$ 且 $y_j = y_0 + (j + \\tfrac{1}{2}) \\Delta y$。单元的体积（在二维情况下，即为面积）是恒定的，$A_{cell} = \\Delta x \\Delta y$。\n\n我们的目标是计算该单元内的平均梯度 $(\\nabla \\phi)_{i,j}$。我们将左侧（LHS）的体积分近似为：\n$$\n\\int_{V_{i,j}} \\nabla \\phi \\, dV \\approx (\\nabla \\phi)_{i,j} A_{cell} = (\\nabla \\phi)_{i,j} \\Delta x \\Delta y\n$$\n此近似假设梯度在整个单元 $V_{i,j}$ 内是恒定的。\n\n右侧（RHS）的面积分是在单元边界 $\\partial V_{i,j}$ 上进行的。该边界由四个平面组成：东 (e)、西 (w)、北 (n) 和南 (s)。该积分可以写为在这些面上的积分之和：\n$$\n\\oint_{\\partial V_{i,j}} \\phi \\, \\mathbf{n} \\, dS = \\sum_{f \\in \\{\\text{e, w, n, s}\\}} \\int_{S_f} \\phi \\, \\mathbf{n}_f \\, dS\n$$\n在有限体积法中，每个面 $f$ 上的积分是通过假设标量场值 $\\phi$ 在整个面上是恒定的，并等于其在面中心的值 $\\phi_f$ 来近似的。这得到：\n$$\n\\int_{S_f} \\phi \\, \\mathbf{n}_f \\, dS \\approx \\phi_f \\int_{S_f} \\mathbf{n}_f \\, dS = \\phi_f (\\mathbf{n}_f S_f) = \\phi_f \\mathbf{S}_f\n$$\n其中 $S_f$ 是面的表面积（在二维中为长度），$\\mathbf{S}_f = \\mathbf{n}_f S_f$ 是指向外部的面面积矢量。\n\n对于我们的均匀笛卡尔单元 $(i,j)$，这些矢量是：\n- 东面 (e): $\\mathbf{S}_e = (\\Delta y, 0)$\n- 西面 (w): $\\mathbf{S}_w = (-\\Delta y, 0)$\n- 北面 (n): $\\mathbf{S}_n = (0, \\Delta x)$\n- 南面 (s): $\\mathbf{S}_s = (0, -\\Delta x)$\n\n然后，RHS 近似为以下总和：\n$$\n\\oint_{\\partial V_{i,j}} \\phi \\, \\mathbf{n} \\, dS \\approx \\phi_e \\mathbf{S}_e + \\phi_w \\mathbf{S}_w + \\phi_n \\mathbf{S}_n + \\phi_s \\mathbf{S}_s = (\\phi_e - \\phi_w)\\Delta y \\, \\mathbf{i} + (\\phi_n - \\phi_s)\\Delta x \\, \\mathbf{j}\n$$\n其中 $\\mathbf{i}$ 和 $\\mathbf{j}$ 分别是 $x$ 和 $y$ 方向上的单位矢量。\n\n令离散化的 LHS 和 RHS 相等：\n$$\n(\\nabla \\phi)_{i,j} \\Delta x \\Delta y \\approx ((\\phi_e - \\phi_w)\\Delta y, (\\phi_n - \\phi_s)\\Delta x)\n$$\n从这个矢量方程中，我们可以提取梯度的分量，$(\\nabla \\phi)_{i,j} = ((\\frac{\\partial \\phi}{\\partial x})_{i,j}, (\\frac{\\partial \\phi}{\\partial y})_{i,j})$：\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} \\approx \\frac{\\phi_e - \\phi_w}{\\Delta x} \\quad \\text{and} \\quad \\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} \\approx \\frac{\\phi_n - \\phi_s}{\\Delta y}\n$$\n\n推导的最后一步是使用可用的单元中心值 $\\phi_{k,l}$ 来近似面中心值 $\\phi_f$。问题指定使用与线性场一致的近似。对于均匀网格上的线性场，面中心的值恰好是共享该面的两个单元中心值的算术平均值。\n- 东面 'e' 位于单元 $(i,j)$ 和 $(i+1,j)$ 之间。因此，$\\phi_e = \\frac{\\phi_{i,j} + \\phi_{i+1,j}}{2}$。\n- 西面 'w' 位于单元 $(i,j)$ 和 $(i-1,j)$ 之间。因此，$\\phi_w = \\frac{\\phi_{i,j} + \\phi_{i-1,j}}{2}$。\n- 北面 'n' 位于单元 $(i,j)$ 和 $(i,j+1)$ 之间。因此，$\\phi_n = \\frac{\\phi_{i,j} + \\phi_{i,j+1}}{2}$。\n- 南面 's' 位于单元 $(i,j)$ 和 $(i,j-1)$ 之间。因此，$\\phi_s = \\frac{\\phi_{i,j} + \\phi_{i,j-1}}{2}$。\n\n将这些面值的表达式代入我们的梯度公式中：\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} \\approx \\frac{1}{\\Delta x} \\left( \\frac{\\phi_{i,j} + \\phi_{i+1,j}}{2} - \\frac{\\phi_{i,j} + \\phi_{i-1,j}}{2} \\right) = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x}\n$$\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} \\approx \\frac{1}{\\Delta y} \\left( \\frac{\\phi_{i,j} + \\phi_{i,j+1}}{2} - \\frac{\\phi_{i,j} + \\phi_{i,j-1}}{2} \\right) = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y}\n$$\n这些是一阶导数的标准二阶中心差分格式。此推导表明，当对面值使用线性插值时，它们在均匀笛卡尔网格上等效于以单元为中心的格林-高斯方法。\n\n现在，我们必须验证该格式对于线性标量场 $\\phi(x,y) = ax + by + c$ 是精确的。精确的解析梯度为 $\\nabla \\phi = (a, b)$。\n单元中心值在 $x_k = x_0 + (k + \\tfrac{1}{2})\\Delta x$ 和 $y_l = y_0 + (l + \\tfrac{1}{2})\\Delta y$ 处计算。$\\phi_{k,l} = a x_k + b y_l + c$。\n\n让我们评估重构的 $x$ 方向梯度：\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x} = \\frac{(a x_{i+1} + b y_j + c) - (a x_{i-1} + b y_j + c)}{2\\Delta x}\n$$\n$$\n= \\frac{a (x_{i+1} - x_{i-1})}{2\\Delta x}\n$$\n距离 $x_{i+1} - x_{i-1}$ 是 $(x_0 + (i+1 + \\tfrac{1}{2})\\Delta x) - (x_0 + (i-1 + \\tfrac{1}{2})\\Delta x) = ((i + \\tfrac{3}{2}) - (i - \\tfrac{1}{2}))\\Delta x = 2\\Delta x$。\n因此，\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} = \\frac{a (2\\Delta x)}{2\\Delta x} = a\n$$\n这是精确的。\n\n类似地，对于 $y$ 方向梯度：\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y} = \\frac{(a x_i + b y_{j+1} + c) - (a x_i + b y_{j-1} + c)}{2\\Delta y}\n$$\n$$\n= \\frac{b (y_{j+1} - y_{j-1})}{2\\Delta y}\n$$\n距离 $y_{j+1} - y_{j-1}$ 是 $(y_0 + (j+1 + \\tfrac{1}{2})\\Delta y) - (y_0 + (j-1 + \\tfrac{1}{2})\\Delta y) = ((j + \\tfrac{3}{2}) - (j - \\tfrac{1}{2}))\\Delta y = 2\\Delta y$。\n因此，\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} = \\frac{b (2\\Delta y)}{2\\Delta y} = b\n$$\n这也是精确的。\n\n该推导表明，格林-高斯梯度重构（在均匀笛卡尔网格上简化为中心差分格式）对于任何线性标量场都是解析精确的。实现将计算此值并验证数值误差在指定的机器精度容差 $\\epsilon$ 内。误差通过重构梯度矢量与精确梯度矢量 $(a,b)$ 之差的无穷范数量化。如果此误差严格小于给定的容差 $\\text{tol}$，则测试用例通过。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and verifies the Green-Gauss gradient reconstruction for a linear\n    scalar field on a uniform Cartesian grid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (nx, ny, dx, dy, x0, y0, i, j, a, b, c, tol)\n    test_cases = [\n        (16, 12, 0.2, 0.3, -0.7, 1.1, 7, 6, 2.5, -1.25, 0.7, 10**-12),\n        (10, 10, 0.1, 0.1, 0.33, -0.42, 1, 8, -3.0, 4.0, 0.0, 10**-12),\n        (6, 6, 10**-8, 2*10**-8, 0.0, 0.0, 2, 2, 10.0, -20.0, 0.3, 10**-12),\n        (25, 7, 3.0, 4*10**-4, -5.5, 2.2, 12, 5, 0.125, -0.75, 10.0, 10**-12),\n        (30, 30, 1/3, 0.4, -0.2, 0.6, 14, 13, -3.14159, 2.71828, -1.0, 10**-12),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        nx, ny, dx, dy, x0, y0, i, j, a, b, c, tol = case\n\n        # Step 1: Construct the grid and evaluate the scalar field at cell centers.\n        # Create 1D arrays for cell-center coordinates in x and y.\n        x_coords_cc = x0 + (np.arange(nx) + 0.5) * dx\n        y_coords_cc = y0 + (np.arange(ny) + 0.5) * dy\n\n        # Create 2D arrays of coordinates for all cell centers using meshgrid.\n        # Use 'ij' indexing to match loop order (i for columns, j for rows).\n        # This means X_cc and Y_cc will have shape (ny, nx).\n        X_cc, Y_cc = np.meshgrid(x_coords_cc, y_coords_cc, indexing='ij')\n\n        # To match the implementation with the derivation (j, i) indexing for a matrix,\n        # we can transpose the meshgrid output.\n        X_cc, Y_cc = X_cc.T, Y_cc.T\n\n        # Evaluate the linear scalar field phi at all cell centers.\n        # phi_field will have shape (ny, nx), accessible as phi_field[j, i].\n        phi_field = a * X_cc + b * Y_cc + c\n\n        # Step 2: Compute the Green-Gauss gradient at the specified interior cell (i, j).\n        # As derived, this simplifies to the central difference scheme.\n        \n        # We need values from neighboring cells: (i-1, j), (i+1, j), (i, j-1), (i, j+1).\n        # The indices for phi_field are (j, i).\n        phi_im1_j = phi_field[j, i-1]\n        phi_ip1_j = phi_field[j, i+1]\n        \n        phi_i_jm1 = phi_field[j-1, i]\n        phi_i_jp1 = phi_field[j+1, i]\n        \n        # Compute the gradient components.\n        grad_x_recon = (phi_ip1_j - phi_im1_j) / (2 * dx)\n        grad_y_recon = (phi_i_jp1 - phi_i_jm1) / (2 * dy)\n        \n        reconstructed_grad = np.array([grad_x_recon, grad_y_recon])\n\n        # Step 3: Compare the reconstructed gradient to the exact analytical gradient.\n        # The exact gradient for phi(x,y) = ax + by + c is (a, b).\n        exact_grad = np.array([a, b])\n        \n        # Calculate the error vector.\n        error_vector = reconstructed_grad - exact_grad\n        \n        # Quantify the error using the infinity norm.\n        error_inf_norm = np.linalg.norm(error_vector, ord=np.inf)\n        \n        # Step 4: Declare the test passed if the error is within the tolerance.\n        test_passed = error_inf_norm  tol\n        results.append(test_passed)\n\n    # Final print statement in the exact required format.\n    # Convert list of booleans [True, False, ...] to the string \"[True,False,...]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的计算流体动力学（CFD）应用中，网格往往不像  中的那样完美正交。本练习将模拟一个更贴近实际的场景，在一个倾斜的二维控制体上计算扩散通量，并将其与精确解进行比较，从而让你亲手量化由网格质量不佳（如倾斜）所导致的梯度重构误差。",
            "id": "3963598",
            "problem": "考虑二维(2D)计算流体力学(CFD)中的一个平面控制体，其顶点按逆时针顺序定义为 $V_{1}=(0,0)$, $V_{2}=(1,0.2)$, $V_{3}=(1.1,1)$ 和 $V_{4}=(0,1)$。一个扩散标量场的解析形式为 $\\phi(x,y)=x^{2}+xy+y^{2}$，扩散系数为常数 $\\Gamma=1$ (无量纲)。重点研究穿过面 $\\overline{V_{2}V_{3}}$ 的扩散通量。\n\n从散度定理出发，仅使用通量和几何量的基本定义，通过在多边形的每个面上使用面中点求积来近似边界积分，推导单元平均梯度的离散格林-高斯梯度重构。使用与逆时针顶点排序一致的指向外的面法向量。然后：\n- 通过将重构的单元平均梯度与面 $\\overline{V_{2}V_{3}}$ 的外法向量进行缩并，并乘以面长，计算穿过该面的离散扩散通量。\n- 通过沿面 $\\overline{V_{2}V_{3}}$ 对解析梯度 $\\nabla \\phi$ 和外法向量进行线积分，计算穿过该面的精确扩散通量。\n- 将离散通量与精确通量之差的绝对值，确定为由梯度重构引起的绝对误差。\n\n假设所有物理量均为无量纲。将最终答案表示为单一的最简分数，不带单位。不要四舍五入；请提供精确值。",
            "solution": "该问题是适定的，具有科学依据，并包含了获得唯一解所需的所有信息。所指定的方法是计算流体力学中的一种标准方法，对此存在明确的验证程序。因此，该问题是有效的。\n\n求解过程主要包括以下几个部分：\n1.  使用带有中点求积的格林-高斯方法计算单元平均梯度 $(\\nabla \\phi)_{GG}$。\n2.  使用重构的梯度计算穿过面 $\\overline{V_2V_3}$ 的离散扩散通量 $F_{23, \\text{discrete}}$。\n3.  通过沿面 $\\overline{V_2V_3}$ 直接积分计算精确扩散通量 $F_{23, \\text{exact}}$。\n4.  确定离散通量和精确通量之间的绝对误差。\n\n扩散通量矢量定义为 $\\vec{J} = -\\Gamma \\nabla \\phi$。给定扩散系数 $\\Gamma=1$，通量矢量即为 $\\vec{J} = -\\nabla \\phi$。流出法向量为 $\\vec{S}$ 的面的总通量为 $F = \\vec{J} \\cdot \\vec{S} = -(\\nabla \\phi) \\cdot \\vec{S}$。\n\n**第一部分：格林-高斯梯度重构**\n\n梯度定理是散度定理的一个推论，它指出标量场 $\\phi$ 的梯度在体积（二维中为面积）$\\Omega$ 上的积分等于该标量场在边界 $\\partial \\Omega$ 上的积分：\n$$ \\int_{\\Omega} \\nabla \\phi \\, d\\Omega = \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\n单元平均梯度的定义为 $\\overline{\\nabla \\phi} = \\frac{1}{A} \\int_{\\Omega} \\nabla \\phi \\, d\\Omega$，其中 $A$ 是单元的面积。因此，\n$$ \\overline{\\nabla \\phi} = \\frac{1}{A} \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\n格林-高斯方法将边界积分近似为对单元所有面的求和。使用中点求积，重构的梯度 $(\\nabla \\phi)_{GG}$ 为：\n$$ (\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum_{f=1}^{N} \\phi(\\vec{r}_f) \\vec{S}_f $$\n其中 $\\vec{r}_f$ 是面 $f$ 的中点，$\\vec{S}_f$ 是其指向外的法向量。对于由逆时针顺序的顶点 $(x_i, y_i)$ 和 $(x_j, y_j)$ 定义的面，$\\vec{S}_f = (y_j - y_i, -(x_j - x_i)) = (\\Delta y, -\\Delta x)$。\n\n顶点为 $V_{1}=(0,0)$, $V_{2}=(1, \\frac{1}{5})$, $V_{3}=(\\frac{11}{10}, 1)$ 和 $V_{4}=(0,1)$。标量场为 $\\phi(x,y)=x^{2}+xy+y^{2}$。\n\n首先，我们使用鞋带公式计算四边形的面积 $A$：\n$$ A = \\frac{1}{2} |(x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1)| $$\n$$ A = \\frac{1}{2} |(0 \\cdot \\frac{1}{5} + 1 \\cdot 1 + \\frac{11}{10} \\cdot 1 + 0 \\cdot 0) - (0 \\cdot 1 + \\frac{1}{5} \\cdot \\frac{11}{10} + 1 \\cdot 0 + 1 \\cdot 0)| $$\n$$ A = \\frac{1}{2} |(1 + \\frac{11}{10}) - (\\frac{11}{50})| = \\frac{1}{2} |\\frac{21}{10} - \\frac{11}{50}| = \\frac{1}{2} |\\frac{105 - 11}{50}| = \\frac{1}{2} \\frac{94}{50} = \\frac{47}{50} $$\n\n接下来，我们计算每个面的属性：\n面 1 ($\\overline{V_1V_2}$):\n$\\vec{S}_1 = (\\frac{1}{5}-0, -(1-0)) = (\\frac{1}{5}, -1)$。\n中点 $\\vec{r}_1 = (\\frac{0+1}{2}, \\frac{0+1/5}{2}) = (\\frac{1}{2}, \\frac{1}{10})$。\n$\\phi(\\vec{r}_1) = (\\frac{1}{2})^2 + (\\frac{1}{2})(\\frac{1}{10}) + (\\frac{1}{10})^2 = \\frac{1}{4} + \\frac{1}{20} + \\frac{1}{100} = \\frac{25+5+1}{100} = \\frac{31}{100}$。\n$\\phi(\\vec{r}_1)\\vec{S}_1 = \\frac{31}{100}(\\frac{1}{5}, -1) = (\\frac{31}{500}, -\\frac{31}{100})$。\n\n面 2 ($\\overline{V_2V_3}$):\n$\\vec{S}_2 = (1-\\frac{1}{5}, -(\\frac{11}{10}-1)) = (\\frac{4}{5}, -\\frac{1}{10})$。\n中点 $\\vec{r}_2 = (\\frac{1+11/10}{2}, \\frac{1/5+1}{2}) = (\\frac{21/10}{2}, \\frac{6/5}{2}) = (\\frac{21}{20}, \\frac{3}{5})$。\n$\\phi(\\vec{r}_2) = (\\frac{21}{20})^2 + (\\frac{21}{20})(\\frac{3}{5}) + (\\frac{3}{5})^2 = \\frac{441}{400} + \\frac{63}{100} + \\frac{9}{25} = \\frac{441+252+144}{400} = \\frac{837}{400}$。\n$\\phi(\\vec{r}_2)\\vec{S}_2 = \\frac{837}{400}(\\frac{4}{5}, -\\frac{1}{10}) = (\\frac{837}{500}, -\\frac{837}{4000})$。\n\n面 3 ($\\overline{V_3V_4}$):\n$\\vec{S}_3 = (1-1, - (0-\\frac{11}{10})) = (0, \\frac{11}{10})$。\n中点 $\\vec{r}_3 = (\\frac{11/10+0}{2}, \\frac{1+1}{2}) = (\\frac{11}{20}, 1)$。\n$\\phi(\\vec{r}_3) = (\\frac{11}{20})^2 + (\\frac{11}{20})(1) + 1^2 = \\frac{121}{400} + \\frac{11}{20} + 1 = \\frac{121+220+400}{400} = \\frac{741}{400}$。\n$\\phi(\\vec{r}_3)\\vec{S}_3 = \\frac{741}{400}(0, \\frac{11}{10}) = (0, \\frac{8151}{4000})$。\n\n面 4 ($\\overline{V_4V_1}$):\n$\\vec{S}_4 = (0-1, -(0-0)) = (-1, 0)$。\n中点 $\\vec{r}_4 = (\\frac{0+0}{2}, \\frac{1+0}{2}) = (0, \\frac{1}{2})$。\n$\\phi(\\vec{r}_4) = 0^2 + 0(\\frac{1}{2}) + (\\frac{1}{2})^2 = \\frac{1}{4}$。\n$\\phi(\\vec{r}_4)\\vec{S}_4 = \\frac{1}{4}(-1, 0) = (-\\frac{1}{4}, 0)$。\n\n现在，我们将各项 $\\phi_f \\vec{S}_f$ 相加：\n$\\sum \\phi_f \\vec{S}_f = (\\frac{31}{500}+\\frac{837}{500}-\\frac{1}{4}, -\\frac{31}{100}-\\frac{837}{4000}+\\frac{8151}{4000}+0)$\nx分量：$\\frac{868}{500} - \\frac{125}{500} = \\frac{743}{500}$。\ny分量：$\\frac{-1240 - 837 + 8151}{4000} = \\frac{6074}{4000} = \\frac{3037}{2000}$。\n$\\sum \\phi_f \\vec{S}_f = (\\frac{743}{500}, \\frac{3037}{2000})$。\n\n重构的梯度为：\n$(\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum \\phi_f \\vec{S}_f = \\frac{1}{47/50} (\\frac{743}{500}, \\frac{3037}{2000}) = \\frac{50}{47} (\\frac{743}{500}, \\frac{3037}{2000})$\n$(\\nabla \\phi)_{GG} = (\\frac{50 \\cdot 743}{47 \\cdot 500}, \\frac{50 \\cdot 3037}{47 \\cdot 2000}) = (\\frac{743}{470}, \\frac{3037}{1880})$。\n\n**第二部分：离散扩散通量**\n\n穿过面 $\\overline{V_2V_3}$ 的离散扩散通量为 $F_{23, \\text{discrete}} = -(\\nabla \\phi)_{GG} \\cdot \\vec{S}_2$。\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743}{470}, \\frac{3037}{1880}\\right) \\cdot \\left(\\frac{4}{5}, -\\frac{1}{10}\\right) $$\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743 \\cdot 4}{470 \\cdot 5} - \\frac{3037 \\cdot 1}{1880 \\cdot 10}\\right) = - \\left(\\frac{2972}{2350} - \\frac{3037}{18800}\\right) $$\n分母 $2350 = 50 \\cdot 47$ 和 $18800 = 400 \\cdot 47$ 的最小公倍数是 $400 \\cdot 47 = 18800$。\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{2972 \\cdot 8}{18800} - \\frac{3037}{18800}\\right) = - \\left(\\frac{23776 - 3037}{18800}\\right) = - \\frac{20739}{18800} $$\n\n**第三部分：精确扩散通量**\n\n精确通量是线积分 $F_{23, \\text{exact}} = \\int_{\\overline{V_2V_3}} -\\nabla\\phi \\cdot d\\vec{S}$。\n面 $\\overline{V_2V_3}$ 可参数化为 $\\vec{r}(t) = V_2(1-t) + V_3t$，其中 $t \\in [0, 1]$。\n$\\vec{r}(t) = (1, \\frac{1}{5})(1-t) + (\\frac{11}{10}, 1)t = (1-t+\\frac{11}{10}t, \\frac{1-t}{5}+t) = (1+\\frac{1}{10}t, \\frac{1}{5}+\\frac{4}{5}t)$。\n微分法向量为 $d\\vec{S} = (\\frac{dy}{dt}, -\\frac{dx}{dt})dt = (\\frac{4}{5}, -\\frac{1}{10})dt = \\vec{S}_2 dt$。\n$\\phi(x,y)=x^2+xy+y^2$ 的解析梯度为 $\\nabla \\phi = (2x+y, x+2y)$。\n在直线 $\\vec{r}(t)$ 上计算梯度：\n$\\frac{\\partial \\phi}{\\partial x} = 2(1+\\frac{t}{10}) + (\\frac{1}{5}+\\frac{4t}{5}) = 2+\\frac{t}{5}+\\frac{1}{5}+\\frac{4t}{5} = \\frac{11}{5}+t$。\n$\\frac{\\partial \\phi}{\\partial y} = (1+\\frac{t}{10}) + 2(\\frac{1}{5}+\\frac{4t}{5}) = 1+\\frac{t}{10}+\\frac{2}{5}+\\frac{8t}{5} = \\frac{7}{5}+\\frac{17t}{10}$。\n$\\nabla \\phi(\\vec{r}(t)) = (\\frac{11}{5}+t, \\frac{7}{5}+\\frac{17t}{10})$。\n\n被积函数为 $\\nabla\\phi \\cdot \\vec{S}_2$：\n$(\\frac{11}{5}+t)(\\frac{4}{5}) + (\\frac{7}{5}+\\frac{17t}{10})(-\\frac{1}{10}) = (\\frac{44}{25}+\\frac{4t}{5}) - (\\frac{7}{50}+\\frac{17t}{100})$\n$= \\frac{88-7}{50} + \\frac{80t-17t}{100} = \\frac{81}{50} + \\frac{63t}{100} = \\frac{162+63t}{100}$。\n\n现在我们从 $t=0$ 到 $t=1$ 进行积分：\n$\\int_0^1 \\frac{162+63t}{100} dt = \\frac{1}{100} \\left[ 162t + \\frac{63}{2}t^2 \\right]_0^1 = \\frac{1}{100}(162+\\frac{63}{2}) = \\frac{1}{100}(\\frac{324+63}{2}) = \\frac{387}{200}$。\n精确通量为 $F_{23, \\text{exact}} = -1 \\cdot \\frac{387}{200} = -\\frac{387}{200}$。\n\n**第四部分：绝对误差**\n\n绝对误差为 $E = |F_{23, \\text{discrete}} - F_{23, \\text{exact}}|$。\n$$ E = \\left| -\\frac{20739}{18800} - \\left(-\\frac{387}{200}\\right) \\right| = \\left| \\frac{387}{200} - \\frac{20739}{18800} \\right| $$\n为了进行减法，我们找到公分母，即 $18800$。注意 $18800/200 = 94$。\n$$ E = \\left| \\frac{387 \\cdot 94}{18800} - \\frac{20739}{18800} \\right| = \\left| \\frac{36378}{18800} - \\frac{20739}{18800} \\right| $$\n$$ E = \\left| \\frac{36378 - 20739}{18800} \\right| = \\frac{15639}{18800} $$\n为检查此分数是否可以化简，我们找出分子和分母的质因数。\n$15639 = 3 \\cdot 13 \\cdot 401$。\n$18800 = 188 \\cdot 100 = 2^2 \\cdot 47 \\cdot 10^2 = 2^2 \\cdot 47 \\cdot (2 \\cdot 5)^2 = 2^4 \\cdot 5^2 \\cdot 47$。\n分子和分母没有共同的质因数。因此，该分数为最简分数。",
            "answer": "$$\n\\boxed{\\frac{15639}{18800}}\n$$"
        }
    ]
}