{
    "hands_on_practices": [
        {
            "introduction": "Before we can accurately approximate physical gradients, we must first ensure the geometric integrity of our discrete control volumes. A fundamental consequence of the divergence theorem is that any closed polyhedron must satisfy the geometric closure condition, $\\sum_f \\mathbf{S}_f = \\mathbf{0}$, where the sum of its outward-pointing face area vectors is zero. This exercise  provides hands-on practice in computing these area vectors for a simple tetrahedron and numerically verifying this crucial property, which underpins the consistency of all finite volume methods.",
            "id": "3963607",
            "problem": "In the Green–Gauss (GG) gradient reconstruction used in the Finite Volume Method (FVM) within Computational Fluid Dynamics (CFD), the contribution of each face to the discrete gradient is proportional to its oriented face area vector. The closure of a control volume implies that the sum of all oriented face area vectors of a closed polyhedron is zero. Starting only from the divergence theorem and the definition of the oriented area vector, derive a computationally consistent expression for the face area vector of a triangular face in terms of its vertex coordinates, including a robust outward-orientation criterion based on the cell centroid.\n\nConsider the tetrahedral control volume with vertices (coordinates in meters)\n- $\\mathbf{r}_1 = (0,\\,0,\\,0)$,\n- $\\mathbf{r}_2 = (1,\\,0,\\,0)$,\n- $\\mathbf{r}_3 = (0,\\,2,\\,0)$,\n- $\\mathbf{r}_4 = (0,\\,0,\\,3)$.\n\nTasks:\n1. Using only the divergence theorem and the geometric definition of surface integrals, derive an expression for the face area vector of a triangular face with vertices $\\mathbf{r}_a$, $\\mathbf{r}_b$, $\\mathbf{r}_c$ in terms of edge vectors. Your derivation must explicitly show how the orientation of the face area vector is determined and how to enforce outward orientation using the cell centroid $\\mathbf{r}_P$.\n2. Compute the oriented face area vectors $\\mathbf{S}_f$ for the four faces $(1,2,3)$, $(1,2,4)$, $(1,3,4)$, and $(2,3,4)$, ensuring outward orientation with respect to the tetrahedron’s centroid.\n3. Verify the closure property numerically by summing the four face area vectors and compute the Euclidean norm of the residual vector $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$.\n\nProvide as your final answer the value of $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$ in square meters, rounded to six significant figures. Express the final value in $\\mathrm{m}^2$.",
            "solution": "The problem asks for the derivation of a formula for the oriented face area vector of a triangle, its application to a specific tetrahedron, and the verification of the closure property ($\\sum_f \\mathbf{S}_f = \\mathbf{0}$).\n\n### Step 1: Derivation of the Face Area Vector Expression\n\nThe problem requests a derivation starting from the divergence theorem. The generalized Stokes theorem (also known as the Kelvin-Stokes theorem or divergence theorem in higher dimensions) provides the necessary foundation. For a vector field $\\mathbf{F}$ in a volume $V$ with boundary surface $S = \\partial V$, the theorem states:\n$$ \\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_S \\mathbf{F} \\cdot d\\mathbf{S} $$\nwhere $d\\mathbf{S} = \\mathbf{n} dS$ is the outward-oriented differential surface area vector.\n\nThe prompt requires an expression for the area vector of a single face, $\\mathbf{S}_f = \\int_f d\\mathbf{S}$. A powerful technique involves using a related theorem, often also called Stokes' theorem, which relates a surface integral to a line integral over its boundary curve $C = \\partial f$:\n$$ \\int_f (\\nabla \\times \\mathbf{F}) \\cdot d\\mathbf{S} = \\oint_C \\mathbf{F} \\cdot d\\mathbf{l} $$\nThis form can be derived from the general divergence theorem. To find an expression for $\\mathbf{S}_f$, we need to find a vector field $\\mathbf{F}$ such that its curl is a constant vector. Let $\\mathbf{c}$ be an arbitrary constant vector and consider the field $\\mathbf{F} = \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r})$, where $\\mathbf{r}$ is the position vector $\\mathbf{r} = x\\mathbf{i} + y\\mathbf{j} + z\\mathbf{k}$.\n\nThe curl of $\\mathbf{F}$ is:\n$$ \\nabla \\times \\mathbf{F} = \\nabla \\times \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) = \\frac{1}{2} \\left[ (\\mathbf{r} \\cdot \\nabla)\\mathbf{c} - (\\mathbf{c} \\cdot \\nabla)\\mathbf{r} + \\mathbf{c}(\\nabla \\cdot \\mathbf{r}) - \\mathbf{r}(\\nabla \\cdot \\mathbf{c}) \\right] $$\nGiven that $\\mathbf{c}$ is a constant vector, $(\\mathbf{r} \\cdot \\nabla)\\mathbf{c} = \\mathbf{0}$ and $\\nabla \\cdot \\mathbf{c} = 0$. We also have $\\nabla \\cdot \\mathbf{r} = 3$ and $(\\mathbf{c} \\cdot \\nabla)\\mathbf{r} = \\mathbf{c}$. Substituting these into the expression for the curl gives:\n$$ \\nabla \\times \\mathbf{F} = \\frac{1}{2} [ \\mathbf{0} - \\mathbf{c} + 3\\mathbf{c} - \\mathbf{0} ] = \\mathbf{c} $$\nNow, substituting $\\nabla \\times \\mathbf{F} = \\mathbf{c}$ into Stokes' theorem:\n$$ \\int_f \\mathbf{c} \\cdot d\\mathbf{S} = \\oint_C \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) \\cdot d\\mathbf{l} $$\nSince $\\mathbf{c}$ is constant, we can take it out of the integral on the left. On the right, we use the scalar triple product identity $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{C} \\cdot (\\mathbf{A} \\times \\mathbf{B})$:\n$$ \\mathbf{c} \\cdot \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C (\\mathbf{c} \\times \\mathbf{r}) \\cdot d\\mathbf{l} = \\frac{1}{2} \\oint_C \\mathbf{c} \\cdot (\\mathbf{r} \\times d\\mathbf{l}) $$\nAgain, since $\\mathbf{c}$ is constant:\n$$ \\mathbf{c} \\cdot \\left( \\int_f d\\mathbf{S} \\right) = \\mathbf{c} \\cdot \\left( \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} \\right) $$\nThis equality must hold for any arbitrary constant vector $\\mathbf{c}$, which implies that the vectors themselves must be equal:\n$$ \\mathbf{S}_f = \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} $$\nFor a triangular face with vertices $\\mathbf{r}_a, \\mathbf{r}_b, \\mathbf{r}_c$ traversed in that order, the boundary $C$ consists of three straight edges. The line integral becomes a sum:\n$$ \\mathbf{S}_f = \\frac{1}{2} \\left[ \\int_{\\mathbf{r}_a}^{\\mathbf{r}_b} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_b}^{\\mathbf{r}_c} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_c}^{\\mathbf{r}_a} \\mathbf{r} \\times d\\mathbf{r} \\right] $$\nThe integral along the edge from $\\mathbf{r}_a$ to $\\mathbf{r}_b$ evaluates to $\\mathbf{r}_a \\times \\mathbf{r}_b$. Similarly, the other integrals are $\\mathbf{r}_b \\times \\mathbf{r}_c$ and $\\mathbf{r}_c \\times \\mathbf{r}_a$. Thus,\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_a \\times \\mathbf{r}_b + \\mathbf{r}_b \\times \\mathbf{r}_c + \\mathbf{r}_c \\times \\mathbf{r}_a) $$\nThis expression is equivalent to the more common form using edge vectors:\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a) $$\n\nThe direction of $\\mathbf{S}_f$ depends on the order of the vertices. For a closed control volume, the vector must point outwards. A robust criterion is to compare its direction with the vector from the cell centroid $\\mathbf{r}_P$ to the face centroid $\\mathbf{r}_f$. The vector $\\mathbf{d}_f = \\mathbf{r}_f - \\mathbf{r}_P$ points from inside the cell towards the face. The outward normal $\\mathbf{S}_f$ must have a positive projection onto this vector.\nThe procedure is:\n1.  Calculate a tentative area vector $\\mathbf{S}_{\\text{tentative}}$ using an arbitrary (but consistent) vertex ordering, e.g., $\\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a)$.\n2.  Calculate the cell centroid $\\mathbf{r}_P = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{r}_i$ and the face centroid $\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_a + \\mathbf{r}_b + \\mathbf{r}_c)$.\n3.  Check the sign of the dot product: $\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P)$.\n4.  If the dot product is positive, the orientation is correct: $\\mathbf{S}_f = \\mathbf{S}_{\\text{tentative}}$.\n5.  If the dot product is negative, the orientation is incorrect and must be flipped: $\\mathbf{S}_f = -\\mathbf{S}_{\\text{tentative}}$.\n\n### Step 2: Computation of Oriented Face Area Vectors\n\nThe vertices are given as $\\mathbf{r}_1 = (0,\\,0,\\,0)$, $\\mathbf{r}_2 = (1,\\,0,\\,0)$, $\\mathbf{r}_3 = (0,\\,2,\\,0)$, and $\\mathbf{r}_4 = (0,\\,0,\\,3)$.\nThe cell centroid $\\mathbf{r}_P$ of the tetrahedron is:\n$$ \\mathbf{r}_P = \\frac{1}{4}(\\mathbf{r}_1 + \\mathbf{r}_2 + \\mathbf{r}_3 + \\mathbf{r}_4) = \\frac{1}{4}( (0+1+0+0), (0+0+2+0), (0+0+0+3) ) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}) $$\n$$ \\mathbf{r}_P = (0.25, 0.5, 0.75) $$\n\n**Face 1: $(1,2,3)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_3$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_1)) = \\frac{1}{2} ((1,\\,0,\\,0) \\times (0,\\,2,\\,0)) = \\frac{1}{2}(0,\\,0,\\,2) = (0,\\,0,\\,1)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_3) = \\frac{1}{3}(1,\\,2,\\,0) = (\\frac{1}{3}, \\frac{2}{3}, 0)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 0 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0,\\,0,\\,1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4}) = -\\frac{3}{4}  0$.\nThe vector points inward. Flip the sign: $\\mathbf{S}_1 = -(0,\\,0,\\,1) = (0,\\,0,\\,-1)$.\n\n**Face 2: $(1,2,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((1,\\,0,\\,0) \\times (0,\\,0,\\,3)) = \\frac{1}{2}(0,\\,-3,\\,0) = (0,\\,-1.5,\\,0)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_4) = \\frac{1}{3}(1,\\,0,\\,3) = (\\frac{1}{3}, 0, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, 0 - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0,\\,-1.5,\\,0) \\cdot (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4}) = (-1.5)(-\\frac{1}{2}) = 0.75 > 0$.\nThe vector points outward. $\\mathbf{S}_2 = (0,\\,-1.5,\\,0)$.\n\n**Face 3: $(1,3,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((0,\\,2,\\,0) \\times (0,\\,0,\\,3)) = \\frac{1}{2}(6,\\,0,\\,0) = (3,\\,0,\\,0)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(0,\\,2,\\,3) = (0, \\frac{2}{3}, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (0 - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3,\\,0,\\,0) \\cdot (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4}) = 3(-\\frac{1}{4}) = -0.75  0$.\nThe vector points inward. Flip the sign: $\\mathbf{S}_3 = -(3,\\,0,\\,0) = (-3,\\,0,\\,0)$.\n\n**Face 4: $(2,3,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_2, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_2) \\times (\\mathbf{r}_4 - \\mathbf{r}_2)) = \\frac{1}{2} ((-1,\\,2,\\,0) \\times (-1,\\,0,\\,3)) = \\frac{1}{2}(6,\\,3,\\,2) = (3,\\,1.5,\\,1)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_2+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(1,\\,2,\\,3) = (\\frac{1}{3}, \\frac{2}{3}, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3,\\,1.5,\\,1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4}) = \\frac{3}{12} + \\frac{1.5}{6} + \\frac{1}{4} = 0.25 + 0.25 + 0.25 = 0.75 > 0$.\nThe vector points outward. $\\mathbf{S}_4 = (3,\\,1.5,\\,1)$.\n\n### Step 3: Verification of Closure Property\n\nThe closure property for a closed polyhedron requires that the sum of all oriented face area vectors is the zero vector. We sum the four computed vectors:\n$$ \\sum_{f=1}^4 \\mathbf{S}_f = \\mathbf{S}_1 + \\mathbf{S}_2 + \\mathbf{S}_3 + \\mathbf{S}_4 $$\n$$ \\sum \\mathbf{S}_f = (0,\\,0,\\,-1) + (0,\\,-1.5,\\,0) + (-3,\\,0,\\,0) + (3,\\,1.5,\\,1) $$\n$$ \\sum \\mathbf{S}_f = (0+0-3+3, \\quad 0-1.5+0+1.5, \\quad -1+0+0+1) $$\n$$ \\sum \\mathbf{S}_f = (0,\\,0,\\,0) $$\nThe residual vector is $\\mathbf{R} = (0,\\,0,\\,0)$. The Euclidean norm of the residual vector is:\n$$ \\|\\mathbf{R}\\| = \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = \\sqrt{0^2 + 0^2 + 0^2} = 0 $$\nThe coordinates are in meters, so the face areas are in square meters ($\\mathrm{m}^2$). The problem asks for the result rounded to six significant figures.\n$$ \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = 0.00000 \\ \\mathrm{m}^2 $$",
            "answer": "$$\\boxed{0.00000}$$"
        },
        {
            "introduction": "A key benchmark for any gradient scheme is its ability to exactly reproduce the gradient of a linear function, a property known as linear exactness. This practice  demonstrates that for the idealized case of a uniform Cartesian grid, the Green-Gauss method elegantly simplifies to the well-known central difference formula. By implementing a verification test, you will confirm this exactness, building intuition about the scheme's behavior and learning the essential practice of code verification in computational science.",
            "id": "3963600",
            "problem": "You are to design and implement, from first principles, a verification procedure for the Green–Gauss gradient reconstruction of a scalar field on a uniform Cartesian grid, suitable for Computational Fluid Dynamics (CFD). The objective is to demonstrate exactness for linear fields by testing multiple configurations and showing that the computed gradient error is zero within machine precision. The procedure must be derived starting from the divergence theorem and the definition of a control-volume integral on a uniform Cartesian mesh, without relying on any pre-derived discrete reconstruction formulas.\n\nA uniform Cartesian grid is defined by the number of cells in the $x$- and $y$-directions, denoted by $n_x$ and $n_y$, the spacings $\\Delta x$ and $\\Delta y$, and the origin coordinates $(x_0,y_0)$ for the lower-left corner of the domain. Cell centers are located at coordinates $x_i = x_0 + (i + \\tfrac{1}{2}) \\Delta x$ for $i \\in \\{0,1,\\dots,n_x-1\\}$ and $y_j = y_0 + (j + \\tfrac{1}{2}) \\Delta y$ for $j \\in \\{0,1,\\dots,n_y-1\\}$. Consider a scalar field of the form $\\phi(x,y) = a x + b y + c$, where $a$, $b$, and $c$ are constants.\n\nYour tasks are:\n- Derive, in logical steps starting from the divergence theorem and basic control-volume definitions, a discrete procedure that reconstructs the gradient $\\nabla \\phi$ at an interior cell using only cell-centered values and face-centered approximations consistent with a uniform Cartesian grid and a linear field.\n- Implement the derived procedure in a program that constructs the grid, evaluates $\\phi$ at all cell centers, computes the Green–Gauss gradient reconstruction at a specified interior cell, and compares it to the exact analytical gradient.\n- Quantify the error using the infinity norm of the difference between the reconstructed gradient and the exact analytical gradient, and declare a test as passed if the error is less than a specified tolerance. For the purposes of this problem, treat “machine precision” as an absolute tolerance threshold of $\\epsilon = 10^{-12}$, unless otherwise specified.\n\nYou must restrict your evaluation to interior cells so that all needed neighbor cells exist and no boundary modeling (such as ghost cells) is required.\n\nTest Suite:\nFor each test case, the parameters are $(n_x,n_y,\\Delta x,\\Delta y,x_0,y_0,i,j,a,b,c,\\text{tol})$, where $(i,j)$ denotes the target interior cell index in the $x$- and $y$-directions respectively, and $\\text{tol}$ is the error tolerance to be used for that case. Use the following five test cases:\n- Case $1$: $(16,12,0.2,0.3,-0.7,1.1,7,6,2.5,-1.25,0.7,10^{-12})$.\n- Case $2$: $(10,10,0.1,0.1,0.33,-0.42,1,8,-3.0,4.0,0.0,10^{-12})$.\n- Case $3$: $(6,6,10^{-8},2\\times 10^{-8},0.0,0.0,2,2,10.0,-20.0,0.3,10^{-12})$.\n- Case $4$: $(25,7,3.0,4\\times 10^{-4},-5.5,2.2,12,5,0.125,-0.75,10.0,10^{-12})$.\n- Case $5$: $(30,30,\\tfrac{1}{3},0.4,-0.2,0.6,14,13,-3.14159,2.71828,-1.0,10^{-12})$.\n\nFor each case, compute the reconstructed gradient at the specified interior cell and compare it to the exact gradient $(a,b)$. The result for each test case must be a boolean indicating whether the infinity-norm error is strictly less than the specified tolerance. Angles are not involved; no physical units are required.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$), where each entry is a boolean corresponding to the pass/fail outcome of the respective test case.",
            "solution": "The task is to derive and implement a verification procedure for the Green–Gauss gradient reconstruction method on a uniform Cartesian grid for a linear scalar field. The derivation must originate from first principles, specifically the divergence theorem, and demonstrate exactness.\n\nThe Green–Gauss theorem, a consequence of the divergence theorem, provides a relationship between the volume integral of the gradient of a scalar field, $\\phi$, and the surface integral of the field over the boundary of that volume. For a control volume $V$, with boundary surface $\\partial V$, the theorem states:\n$$\n\\int_V \\nabla \\phi \\, dV = \\oint_{\\partial V} \\phi \\, \\mathbf{n} \\, dS\n$$\nwhere $\\mathbf{n}$ is the outward-pointing unit normal vector to the surface element $dS$. In a finite volume context, we approximate this identity.\n\nLet's consider a target interior cell $(i,j)$ on a two-dimensional uniform Cartesian grid. The cell itself forms our control volume, $V_{i,j}$. The center of this cell is at coordinates $(x_i, y_j)$, where $x_i = x_0 + (i + \\tfrac{1}{2}) \\Delta x$ and $y_j = y_0 + (j + \\tfrac{1}{2}) \\Delta y$. The volume (in 2D, this is the area) of the cell is constant, $A_{cell} = \\Delta x \\Delta y$.\n\nThe goal is to compute the average gradient in this cell, $(\\nabla \\phi)_{i,j}$. We approximate the volume integral on the left-hand side (LHS) as:\n$$\n\\int_{V_{i,j}} \\nabla \\phi \\, dV \\approx (\\nabla \\phi)_{i,j} A_{cell} = (\\nabla \\phi)_{i,j} \\Delta x \\Delta y\n$$\nThis approximation assumes that the gradient is constant throughout the cell $V_{i,j}$.\n\nThe surface integral on the right-hand side (RHS) is taken over the boundary of the cell, $\\partial V_{i,j}$. This boundary consists of four planar faces: east (e), west (w), north (n), and south (s). The integral can be written as a sum of integrals over these faces:\n$$\n\\oint_{\\partial V_{i,j}} \\phi \\, \\mathbf{n} \\, dS = \\sum_{f \\in \\{\\text{e, w, n, s}\\}} \\int_{S_f} \\phi \\, \\mathbf{n}_f \\, dS\n$$\nWithin the finite volume method, the integral over each face $f$ is approximated by assuming the scalar field value $\\phi$ is constant across the face and equal to its value at the face center, $\\phi_f$. This gives:\n$$\n\\int_{S_f} \\phi \\, \\mathbf{n}_f \\, dS \\approx \\phi_f \\int_{S_f} \\mathbf{n}_f \\, dS = \\phi_f (\\mathbf{n}_f S_f) = \\phi_f \\mathbf{S}_f\n$$\nwhere $S_f$ is the surface area (length in 2D) of the face and $\\mathbf{S}_f = \\mathbf{n}_f S_f$ is the outward-pointing face area vector.\n\nFor our uniform Cartesian cell $(i,j)$, these vectors are:\n- East face (e): $\\mathbf{S}_e = (\\Delta y, 0)$\n- West face (w): $\\mathbf{S}_w = (-\\Delta y, 0)$\n- North face (n): $\\mathbf{S}_n = (0, \\Delta x)$\n- South face (s): $\\mathbf{S}_s = (0, -\\Delta x)$\n\nThe RHS is then approximated as the sum:\n$$\n\\oint_{\\partial V_{i,j}} \\phi \\, \\mathbf{n} \\, dS \\approx \\phi_e \\mathbf{S}_e + \\phi_w \\mathbf{S}_w + \\phi_n \\mathbf{S}_n + \\phi_s \\mathbf{S}_s = (\\phi_e - \\phi_w)\\Delta y \\, \\mathbf{i} + (\\phi_n - \\phi_s)\\Delta x \\, \\mathbf{j}\n$$\nwhere $\\mathbf{i}$ and $\\mathbf{j}$ are the unit vectors in the $x$ and $y$ directions, respectively.\n\nEquating the discretized LHS and RHS:\n$$\n(\\nabla \\phi)_{i,j} \\Delta x \\Delta y \\approx ((\\phi_e - \\phi_w)\\Delta y, (\\phi_n - \\phi_s)\\Delta x)\n$$\nFrom this vector equation, we can extract the components of the gradient, $(\\nabla \\phi)_{i,j} = ((\\frac{\\partial \\phi}{\\partial x})_{i,j}, (\\frac{\\partial \\phi}{\\partial y})_{i,j})$:\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} \\approx \\frac{\\phi_e - \\phi_w}{\\Delta x} \\quad \\text{and} \\quad \\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} \\approx \\frac{\\phi_n - \\phi_s}{\\Delta y}\n$$\n\nThe final step in the derivation is to approximate the face-center values $\\phi_f$ using the available cell-center values $\\phi_{k,l}$. The problem specifies using an approximation consistent with a linear field. For a linear field on a uniform grid, the value at the center of a face is exactly the arithmetic average of the values at the centers of the two cells sharing that face.\n- The east face 'e' is between cell $(i,j)$ and $(i+1,j)$. Thus, $\\phi_e = \\frac{\\phi_{i,j} + \\phi_{i+1,j}}{2}$.\n- The west face 'w' is between cell $(i,j)$ and $(i-1,j)$. Thus, $\\phi_w = \\frac{\\phi_{i,j} + \\phi_{i-1,j}}{2}$.\n- The north face 'n' is between cell $(i,j)$ and $(i,j+1)$. Thus, $\\phi_n = \\frac{\\phi_{i,j} + \\phi_{i,j+1}}{2}$.\n- The south face 's' is between cell $(i,j)$ and $(i,j-1)$. Thus, $\\phi_s = \\frac{\\phi_{i,j} + \\phi_{i,j-1}}{2}$.\n\nSubstituting these expressions for the face values into our gradient formulas:\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} \\approx \\frac{1}{\\Delta x} \\left( \\frac{\\phi_{i,j} + \\phi_{i+1,j}}{2} - \\frac{\\phi_{i,j} + \\phi_{i-1,j}}{2} \\right) = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x}\n$$\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} \\approx \\frac{1}{\\Delta y} \\left( \\frac{\\phi_{i,j} + \\phi_{i,j+1}}{2} - \\frac{\\phi_{i,j} + \\phi_{i,j-1}}{2} \\right) = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y}\n$$\nThese are the standard second-order central difference formulas for the first derivative. This derivation shows their equivalence to the cell-centered Green-Gauss method on a uniform Cartesian grid when linear interpolation is used for face values.\n\nNow, we must verify that this scheme is exact for a linear scalar field $\\phi(x,y) = ax + by + c$. The exact analytical gradient is $\\nabla \\phi = (a, b)$.\nThe cell-centered values are computed at $x_k = x_0 + (k + \\tfrac{1}{2})\\Delta x$ and $y_l = y_0 + (l + \\tfrac{1}{2})\\Delta y$.\n$\\phi_{k,l} = a x_k + b y_l + c$.\n\nLet's evaluate the reconstructed $x$-gradient:\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x} = \\frac{(a x_{i+1} + b y_j + c) - (a x_{i-1} + b y_j + c)}{2\\Delta x}\n$$\n$$\n= \\frac{a (x_{i+1} - x_{i-1})}{2\\Delta x}\n$$\nThe distance $x_{i+1} - x_{i-1}$ is $(x_0 + (i+1 + \\tfrac{1}{2})\\Delta x) - (x_0 + (i-1 + \\tfrac{1}{2})\\Delta x) = ((i + \\tfrac{3}{2}) - (i - \\tfrac{1}{2}))\\Delta x = 2\\Delta x$.\nTherefore,\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} = \\frac{a (2\\Delta x)}{2\\Delta x} = a\n$$\nThis is exact.\n\nSimilarly, for the $y$-gradient:\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y} = \\frac{(a x_i + b y_{j+1} + c) - (a x_i + b y_{j-1} + c)}{2\\Delta y}\n$$\n$$\n= \\frac{b (y_{j+1} - y_{j-1})}{2\\Delta y}\n$$\nThe distance $y_{j+1} - y_{j-1}$ is $(y_0 + (j+1 + \\tfrac{1}{2})\\Delta y) - (y_0 + (j-1 + \\tfrac{1}{2})\\Delta y) = ((j + \\tfrac{3}{2}) - (j - \\tfrac{1}{2}))\\Delta y = 2\\Delta y$.\nTherefore,\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} = \\frac{b (2\\Delta y)}{2\\Delta y} = b\n$$\nThis is also exact.\n\nThe derivation demonstrates that the Green–Gauss gradient reconstruction, which simplifies to the central difference scheme on a uniform Cartesian grid, is analytically exact for any linear scalar field. The implementation will compute this and verify that the numerical error is within the specified machine precision tolerance, $\\epsilon$. The error is quantified using the infinity norm of the difference between the reconstructed gradient vector and the exact gradient vector $(a,b)$. A test case passes if this error is strictly less than the given tolerance, $\\text{tol}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and verifies the Green-Gauss gradient reconstruction for a linear\n    scalar field on a uniform Cartesian grid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (nx, ny, dx, dy, x0, y0, i, j, a, b, c, tol)\n    test_cases = [\n        (16, 12, 0.2, 0.3, -0.7, 1.1, 7, 6, 2.5, -1.25, 0.7, 10**-12),\n        (10, 10, 0.1, 0.1, 0.33, -0.42, 1, 8, -3.0, 4.0, 0.0, 10**-12),\n        (6, 6, 10**-8, 2*10**-8, 0.0, 0.0, 2, 2, 10.0, -20.0, 0.3, 10**-12),\n        (25, 7, 3.0, 4*10**-4, -5.5, 2.2, 12, 5, 0.125, -0.75, 10.0, 10**-12),\n        (30, 30, 1/3, 0.4, -0.2, 0.6, 14, 13, -3.14159, 2.71828, -1.0, 10**-12),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        nx, ny, dx, dy, x0, y0, i, j, a, b, c, tol = case\n\n        # Step 1: Construct the grid and evaluate the scalar field at cell centers.\n        # Create 1D arrays for cell-center coordinates in x and y.\n        x_coords_cc = x0 + (np.arange(nx) + 0.5) * dx\n        y_coords_cc = y0 + (np.arange(ny) + 0.5) * dy\n\n        # Create 2D arrays of coordinates for all cell centers using meshgrid.\n        # Use 'ij' indexing to match loop order (i for columns, j for rows).\n        # This means X_cc and Y_cc will have shape (ny, nx).\n        X_cc, Y_cc = np.meshgrid(x_coords_cc, y_coords_cc, indexing='ij')\n\n        # To match the implementation with the derivation (j, i) indexing for a matrix,\n        # we can transpose the meshgrid output.\n        X_cc, Y_cc = X_cc.T, Y_cc.T\n\n        # Evaluate the linear scalar field phi at all cell centers.\n        # phi_field will have shape (ny, nx), accessible as phi_field[j, i].\n        phi_field = a * X_cc + b * Y_cc + c\n\n        # Step 2: Compute the Green-Gauss gradient at the specified interior cell (i, j).\n        # As derived, this simplifies to the central difference scheme.\n        \n        # We need values from neighboring cells: (i-1, j), (i+1, j), (i, j-1), (i, j+1).\n        # The indices for phi_field are (j, i).\n        phi_im1_j = phi_field[j, i-1]\n        phi_ip1_j = phi_field[j, i+1]\n        \n        phi_i_jm1 = phi_field[j-1, i]\n        phi_i_jp1 = phi_field[j+1, i]\n        \n        # Compute the gradient components.\n        grad_x_recon = (phi_ip1_j - phi_im1_j) / (2 * dx)\n        grad_y_recon = (phi_i_jp1 - phi_i_jm1) / (2 * dy)\n        \n        reconstructed_grad = np.array([grad_x_recon, grad_y_recon])\n\n        # Step 3: Compare the reconstructed gradient to the exact analytical gradient.\n        # The exact gradient for phi(x,y) = ax + by + c is (a, b).\n        exact_grad = np.array([a, b])\n        \n        # Calculate the error vector.\n        error_vector = reconstructed_grad - exact_grad\n        \n        # Quantify the error using the infinity norm.\n        error_inf_norm = np.linalg.norm(error_vector, ord=np.inf)\n        \n        # Step 4: Declare the test passed if the error is within the tolerance.\n        test_passed = error_inf_norm  tol\n        results.append(test_passed)\n\n    # Final print statement in the exact required format.\n    # Convert list of booleans [True, False, ...] to the string \"[True,False,...]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the Green-Gauss method is exact for linear fields, real-world engineering problems involve complex non-linear fields and distorted, non-orthogonal meshes. This exercise  moves into this more realistic territory, asking you to compute the gradient and resulting diffusive flux for a quadratic field on a skewed cell. By comparing the numerical result to the exact analytical solution, you will quantify the discretization error introduced by the gradient reconstruction, gaining a critical understanding of the method's accuracy limitations in practical applications.",
            "id": "3963598",
            "problem": "Consider a single planar control volume in Two-Dimensional (2D) Computational Fluid Dynamics (CFD), defined by the counterclockwise vertex sequence $V_1=(0,0)$, $V_2=(1,0.2)$, $V_3=(1.1,1)$, and $V_4=(0,1)$. A diffusing scalar field is given analytically by $\\phi(x,y)=x^2+xy+y^2$, and the diffusion coefficient is constant, $\\Gamma=1$ (dimensionless). Focus on the diffusive flux across the face $\\overline{V_2V_3}$.\n\nStarting from the divergence theorem and using only fundamental definitions of fluxes and geometric quantities, derive a discrete Green–Gauss gradient reconstruction for the cell-averaged gradient by approximating the boundary integral with a face-midpoint quadrature over each face of the polygon. Use outward-pointing face normals consistent with the counterclockwise vertex ordering. Then:\n- Compute the discrete diffusive flux across the face $\\overline{V_2V_3}$ by contracting the reconstructed cell-averaged gradient with the outward normal for that face and multiplying by the face length.\n- Compute the exact diffusive flux across the same face by line-integrating the analytic gradient $\\nabla \\phi$ over the face with the outward normal.\n- Determine the absolute error attributable to gradient reconstruction as the absolute value of the difference between the discrete flux and the exact flux.\n\nAssume all quantities are dimensionless. Express the final answer as a single reduced fraction, with no units. Do not round; provide the exact value.",
            "solution": "The solution proceeds in three main parts:\n1.  Calculation of the cell-averaged gradient, $(\\nabla \\phi)_{GG}$, using the Green–Gauss method with midpoint quadrature.\n2.  Calculation of the discrete diffusive flux, $F_{23, \\text{discrete}}$, across the face $\\overline{V_2V_3}$ using the reconstructed gradient.\n3.  Calculation of the exact diffusive flux, $F_{23, \\text{exact}}$, by direct integration along the face $\\overline{V_2V_3}$.\n4.  Determination of the absolute error between the discrete and exact fluxes.\n\nThe diffusive flux vector is defined as $\\vec{J} = -\\Gamma \\nabla \\phi$. With the given diffusion coefficient $\\Gamma=1$, the flux vector is simply $\\vec{J} = -\\nabla \\phi$. The total flux out of a face with normal vector $\\vec{S}$ is $F = \\vec{J} \\cdot \\vec{S} = -(\\nabla \\phi) \\cdot \\vec{S}$.\n\n**Part 1: Green–Gauss Gradient Reconstruction**\n\nThe gradient theorem, a consequence of the divergence theorem, states that the integral of the gradient of a scalar field $\\phi$ over a volume (or area in 2D) $\\Omega$ is equal to the integral of the scalar field over the boundary $\\partial \\Omega$:\n$$ \\int_{\\Omega} \\nabla \\phi \\, d\\Omega = \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\nThe cell-averaged gradient is defined as $\\overline{\\nabla \\phi} = \\frac{1}{A} \\int_{\\Omega} \\nabla \\phi \\, d\\Omega$, where $A$ is the area of the cell. Thus,\n$$ \\overline{\\nabla \\phi} = \\frac{1}{A} \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\nThe Green–Gauss method approximates the boundary integral as a sum over the cell faces. Using midpoint quadrature, the reconstructed gradient $(\\nabla \\phi)_{GG}$ is:\n$$ (\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum_{f=1}^{N} \\phi(\\vec{r}_f) \\vec{S}_f $$\nwhere $\\vec{r}_f$ is the midpoint of face $f$ and $\\vec{S}_f$ is its outward normal vector. For a face defined by vertices $(x_i, y_i)$ and $(x_j, y_j)$ in counterclockwise order, $\\vec{S}_f = (y_j - y_i, -(x_j - x_i)) = (\\Delta y, -\\Delta x)$.\n\nThe vertices are $V_1=(0,0)$, $V_2=(1, \\frac{1}{5})$, $V_3=(\\frac{11}{10}, 1)$, and $V_4=(0,1)$. The scalar field is $\\phi(x,y)=x^2+xy+y^2$.\n\nFirst, we calculate the area $A$ of the quadrilateral using the shoelace formula:\n$$ A = \\frac{1}{2} |(x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1)| $$\n$$ A = \\frac{1}{2} |(0 \\cdot \\frac{1}{5} + 1 \\cdot 1 + \\frac{11}{10} \\cdot 1 + 0 \\cdot 0) - (0 \\cdot 1 + \\frac{1}{5} \\cdot \\frac{11}{10} + 1 \\cdot 0 + 1 \\cdot 0)| $$\n$$ A = \\frac{1}{2} |(1 + \\frac{11}{10}) - (\\frac{11}{50})| = \\frac{1}{2} |\\frac{21}{10} - \\frac{11}{50}| = \\frac{1}{2} |\\frac{105 - 11}{50}| = \\frac{1}{2} \\frac{94}{50} = \\frac{47}{50} $$\n\nNext, we calculate the properties for each face:\nFace 1 ($\\overline{V_1V_2}$):\n$\\vec{S}_1 = (\\frac{1}{5}-0, -(1-0)) = (\\frac{1}{5}, -1)$.\nMidpoint $\\vec{r}_1 = (\\frac{0+1}{2}, \\frac{0+1/5}{2}) = (\\frac{1}{2}, \\frac{1}{10})$.\n$\\phi(\\vec{r}_1) = (\\frac{1}{2})^2 + (\\frac{1}{2})(\\frac{1}{10}) + (\\frac{1}{10})^2 = \\frac{1}{4} + \\frac{1}{20} + \\frac{1}{100} = \\frac{25+5+1}{100} = \\frac{31}{100}$.\n$\\phi(\\vec{r}_1)\\vec{S}_1 = \\frac{31}{100}(\\frac{1}{5}, -1) = (\\frac{31}{500}, -\\frac{31}{100})$.\n\nFace 2 ($\\overline{V_2V_3}$):\n$\\vec{S}_2 = (1-\\frac{1}{5}, -(\\frac{11}{10}-1)) = (\\frac{4}{5}, -\\frac{1}{10})$.\nMidpoint $\\vec{r}_2 = (\\frac{1+11/10}{2}, \\frac{1/5+1}{2}) = (\\frac{21/10}{2}, \\frac{6/5}{2}) = (\\frac{21}{20}, \\frac{3}{5})$.\n$\\phi(\\vec{r}_2) = (\\frac{21}{20})^2 + (\\frac{21}{20})(\\frac{3}{5}) + (\\frac{3}{5})^2 = \\frac{441}{400} + \\frac{63}{100} + \\frac{9}{25} = \\frac{441+252+144}{400} = \\frac{837}{400}$.\n$\\phi(\\vec{r}_2)\\vec{S}_2 = \\frac{837}{400}(\\frac{4}{5}, -\\frac{1}{10}) = (\\frac{837}{500}, -\\frac{837}{4000})$.\n\nFace 3 ($\\overline{V_3V_4}$):\n$\\vec{S}_3 = (1-1, - (0-\\frac{11}{10})) = (0, \\frac{11}{10})$.\nMidpoint $\\vec{r}_3 = (\\frac{11/10+0}{2}, \\frac{1+1}{2}) = (\\frac{11}{20}, 1)$.\n$\\phi(\\vec{r}_3) = (\\frac{11}{20})^2 + (\\frac{11}{20})(1) + 1^2 = \\frac{121}{400} + \\frac{11}{20} + 1 = \\frac{121+220+400}{400} = \\frac{741}{400}$.\n$\\phi(\\vec{r}_3)\\vec{S}_3 = \\frac{741}{400}(0, \\frac{11}{10}) = (0, \\frac{8151}{4000})$.\n\nFace 4 ($\\overline{V_4V_1}$):\n$\\vec{S}_4 = (0-1, -(0-0)) = (-1, 0)$.\nMidpoint $\\vec{r}_4 = (\\frac{0+0}{2}, \\frac{1+0}{2}) = (0, \\frac{1}{2})$.\n$\\phi(\\vec{r}_4) = 0^2 + 0(\\frac{1}{2}) + (\\frac{1}{2})^2 = \\frac{1}{4}$.\n$\\phi(\\vec{r}_4)\\vec{S}_4 = \\frac{1}{4}(-1, 0) = (-\\frac{1}{4}, 0)$.\n\nNow, we sum the $\\phi_f \\vec{S}_f$ terms:\n$\\sum \\phi_f \\vec{S}_f = (\\frac{31}{500}+\\frac{837}{500}-\\frac{1}{4}, -\\frac{31}{100}-\\frac{837}{4000}+\\frac{8151}{4000}+0)$\nx-component: $\\frac{868}{500} - \\frac{125}{500} = \\frac{743}{500}$.\ny-component: $\\frac{-1240 - 837 + 8151}{4000} = \\frac{6074}{4000} = \\frac{3037}{2000}$.\n$\\sum \\phi_f \\vec{S}_f = (\\frac{743}{500}, \\frac{3037}{2000})$.\n\nThe reconstructed gradient is:\n$(\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum \\phi_f \\vec{S}_f = \\frac{1}{47/50} (\\frac{743}{500}, \\frac{3037}{2000}) = \\frac{50}{47} (\\frac{743}{500}, \\frac{3037}{2000})$\n$(\\nabla \\phi)_{GG} = (\\frac{50 \\cdot 743}{47 \\cdot 500}, \\frac{50 \\cdot 3037}{47 \\cdot 2000}) = (\\frac{743}{470}, \\frac{3037}{1880})$.\n\n**Part 2: Discrete Diffusive Flux**\n\nThe discrete diffusive flux across face $\\overline{V_2V_3}$ is $F_{23, \\text{discrete}} = -(\\nabla \\phi)_{GG} \\cdot \\vec{S}_2$.\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743}{470}, \\frac{3037}{1880}\\right) \\cdot \\left(\\frac{4}{5}, -\\frac{1}{10}\\right) $$\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743 \\cdot 4}{470 \\cdot 5} - \\frac{3037 \\cdot 1}{1880 \\cdot 10}\\right) = - \\left(\\frac{2972}{2350} - \\frac{3037}{18800}\\right) $$\nThe least common multiple of the denominators $2350 = 50 \\cdot 47$ and $18800 = 400 \\cdot 47$ is $400 \\cdot 47 = 18800$.\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{2972 \\cdot 8}{18800} - \\frac{3037}{18800}\\right) = - \\left(\\frac{23776 - 3037}{18800}\\right) = - \\frac{20739}{18800} $$\n\n**Part 3: Exact Diffusive Flux**\n\nThe exact flux is the line integral $F_{23, \\text{exact}} = \\int_{\\overline{V_2V_3}} -\\nabla\\phi \\cdot d\\vec{S}$.\nThe face $\\overline{V_2V_3}$ is parameterized by $\\vec{r}(t) = V_2(1-t) + V_3t$ for $t \\in [0, 1]$.\n$\\vec{r}(t) = (1, \\frac{1}{5})(1-t) + (\\frac{11}{10}, 1)t = (1-t+\\frac{11}{10}t, \\frac{1-t}{5}+t) = (1+\\frac{1}{10}t, \\frac{1}{5}+\\frac{4}{5}t)$.\nThe differential normal vector is $d\\vec{S} = (\\frac{dy}{dt}, -\\frac{dx}{dt})dt = (\\frac{4}{5}, -\\frac{1}{10})dt = \\vec{S}_2 dt$.\nThe analytical gradient of $\\phi(x,y)=x^2+xy+y^2$ is $\\nabla \\phi = (2x+y, x+2y)$.\nEvaluating the gradient on the line $\\vec{r}(t)$:\n$\\frac{\\partial \\phi}{\\partial x} = 2(1+\\frac{t}{10}) + (\\frac{1}{5}+\\frac{4t}{5}) = 2+\\frac{t}{5}+\\frac{1}{5}+\\frac{4t}{5} = \\frac{11}{5}+t$.\n$\\frac{\\partial \\phi}{\\partial y} = (1+\\frac{t}{10}) + 2(\\frac{1}{5}+\\frac{4t}{5}) = 1+\\frac{t}{10}+\\frac{2}{5}+\\frac{8t}{5} = \\frac{7}{5}+\\frac{17t}{10}$.\n$\\nabla \\phi(\\vec{r}(t)) = (\\frac{11}{5}+t, \\frac{7}{5}+\\frac{17t}{10})$.\n\nThe integrand is $\\nabla\\phi \\cdot \\vec{S}_2$:\n$(\\frac{11}{5}+t)(\\frac{4}{5}) + (\\frac{7}{5}+\\frac{17t}{10})(-\\frac{1}{10}) = (\\frac{44}{25}+\\frac{4t}{5}) - (\\frac{7}{50}+\\frac{17t}{100})$\n$= \\frac{88-7}{50} + \\frac{80t-17t}{100} = \\frac{81}{50} + \\frac{63t}{100} = \\frac{162+63t}{100}$.\n\nNow we integrate from $t=0$ to $t=1$:\n$\\int_0^1 \\frac{162+63t}{100} dt = \\frac{1}{100} \\left[ 162t + \\frac{63}{2}t^2 \\right]_0^1 = \\frac{1}{100}(162+\\frac{63}{2}) = \\frac{1}{100}(\\frac{324+63}{2}) = \\frac{387}{200}$.\nThe exact flux is $F_{23, \\text{exact}} = -1 \\cdot \\frac{387}{200} = -\\frac{387}{200}$.\n\n**Part 4: Absolute Error**\n\nThe absolute error is $E = |F_{23, \\text{discrete}} - F_{23, \\text{exact}}|$.\n$$ E = \\left| -\\frac{20739}{18800} - \\left(-\\frac{387}{200}\\right) \\right| = \\left| \\frac{387}{200} - \\frac{20739}{18800} \\right| $$\nTo subtract, we find a common denominator, which is $18800$. Note that $18800/200 = 94$.\n$$ E = \\left| \\frac{387 \\cdot 94}{18800} - \\frac{20739}{18800} \\right| = \\left| \\frac{36378}{18800} - \\frac{20739}{18800} \\right| $$\n$$ E = \\left| \\frac{36378 - 20739}{18800} \\right| = \\frac{15639}{18800} $$\nTo check if this fraction can be reduced, we find the prime factors of the numerator and denominator.\n$15639 = 3 \\cdot 13 \\cdot 401$.\n$18800 = 188 \\cdot 100 = 2^2 \\cdot 47 \\cdot 10^2 = 2^2 \\cdot 47 \\cdot (2 \\cdot 5)^2 = 2^4 \\cdot 5^2 \\cdot 47$.\nThere are no common prime factors. Therefore, the fraction is irreducible.",
            "answer": "$$\n\\boxed{\\frac{15639}{18800}}\n$$"
        }
    ]
}