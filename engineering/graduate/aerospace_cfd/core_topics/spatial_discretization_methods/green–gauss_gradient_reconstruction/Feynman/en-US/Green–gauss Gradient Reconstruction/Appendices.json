{
    "hands_on_practices": [
        {
            "introduction": "The Green-Gauss method fundamentally relies on converting a volume integral into a sum of fluxes over the faces of a control volume. This first practice focuses on the geometric integrity of the control volume itself, a prerequisite for any accurate physical calculation. You will compute the oriented face area vectors, $\\mathbf{S}_f$, for a simple tetrahedron and demonstrate that they satisfy the closure property, $\\sum_f \\mathbf{S}_f = \\mathbf{0}$, which is a direct consequence of the divergence theorem applied to a constant field .",
            "id": "3963607",
            "problem": "In the Green–Gauss (GG) gradient reconstruction used in the Finite Volume Method (FVM) within Computational Fluid Dynamics (CFD), the contribution of each face to the discrete gradient is proportional to its oriented face area vector. The closure of a control volume implies that the sum of all oriented face area vectors of a closed polyhedron is zero. Starting only from the divergence theorem and the definition of the oriented area vector, derive a computationally consistent expression for the face area vector of a triangular face in terms of its vertex coordinates, including a robust outward-orientation criterion based on the cell centroid.\n\nConsider the tetrahedral control volume with vertices (coordinates in meters)\n- $\\mathbf{r}_1 = (0, 0, 0)$,\n- $\\mathbf{r}_2 = (1, 0, 0)$,\n- $\\mathbf{r}_3 = (0, 2, 0)$,\n- $\\mathbf{r}_4 = (0, 0, 3)$.\n\nTasks:\n1. Using only the divergence theorem and the geometric definition of surface integrals, derive an expression for the face area vector of a triangular face with vertices $\\mathbf{r}_a$, $\\mathbf{r}_b$, $\\mathbf{r}_c$ in terms of edge vectors. Your derivation must explicitly show how the orientation of the face area vector is determined and how to enforce outward orientation using the cell centroid $\\mathbf{r}_P$.\n2. Compute the oriented face area vectors $\\mathbf{S}_f$ for the four faces $(1,2,3)$, $(1,2,4)$, $(1,3,4)$, and $(2,3,4)$, ensuring outward orientation with respect to the tetrahedron’s centroid.\n3. Verify the closure property numerically by summing the four face area vectors and compute the Euclidean norm of the residual vector $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$.\n\nProvide as your final answer the value of $\\left\\|\\sum_f \\mathbf{S}_f\\right\\|$ in square meters, rounded to six significant figures. Express the final value in $\\mathrm{m}^2$.",
            "solution": "The problem asks for the derivation of a formula for the oriented face area vector of a triangle, its application to a specific tetrahedron, and the verification of the closure property ($\\sum_f \\mathbf{S}_f = \\mathbf{0}$).\n\n### Step 1: Derivation of the Face Area Vector Expression\n\nThe problem requests a derivation starting from the divergence theorem. The generalized Stokes theorem (also known as the Kelvin-Stokes theorem or divergence theorem in higher dimensions) provides the necessary foundation. For a vector field $\\mathbf{F}$ in a volume $V$ with boundary surface $S = \\partial V$, the theorem states:\n$$ \\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_S \\mathbf{F} \\cdot d\\mathbf{S} $$\nwhere $d\\mathbf{S} = \\mathbf{n} dS$ is the outward-oriented differential surface area vector.\n\nThe prompt requires an expression for the area vector of a single face, $\\mathbf{S}_f = \\int_f d\\mathbf{S}$. A powerful technique involves using a related theorem, often also called Stokes' theorem, which relates a surface integral to a line integral over its boundary curve $C = \\partial f$:\n$$ \\int_f (\\nabla \\times \\mathbf{F}) \\cdot d\\mathbf{S} = \\oint_C \\mathbf{F} \\cdot d\\mathbf{l} $$\nThis form can be derived from the general divergence theorem. To find an expression for $\\mathbf{S}_f$, we need to find a vector field $\\mathbf{F}$ such that its curl is a constant vector. Let $\\mathbf{c}$ be an arbitrary constant vector and consider the field $\\mathbf{F} = \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r})$, where $\\mathbf{r}$ is the position vector $\\mathbf{r} = x\\mathbf{i} + y\\mathbf{j} + z\\mathbf{k}$.\n\nThe curl of $\\mathbf{F}$ is:\n$$ \\nabla \\times \\mathbf{F} = \\nabla \\times \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) = \\frac{1}{2} \\left[ (\\mathbf{r} \\cdot \\nabla)\\mathbf{c} - (\\mathbf{c} \\cdot \\nabla)\\mathbf{r} + \\mathbf{c}(\\nabla \\cdot \\mathbf{r}) - \\mathbf{r}(\\nabla \\cdot \\mathbf{c}) \\right] $$\nGiven that $\\mathbf{c}$ is a constant vector, $(\\mathbf{r} \\cdot \\nabla)\\mathbf{c} = \\mathbf{0}$ and $\\nabla \\cdot \\mathbf{c} = 0$. We also have $\\nabla \\cdot \\mathbf{r} = 3$ and $(\\mathbf{c} \\cdot \\nabla)\\mathbf{r} = \\mathbf{c}$. Substituting these into the expression for the curl gives:\n$$ \\nabla \\times \\mathbf{F} = \\frac{1}{2} [ \\mathbf{0} - \\mathbf{c} + 3\\mathbf{c} - \\mathbf{0} ] = \\mathbf{c} $$\nNow, substituting $\\nabla \\times \\mathbf{F} = \\mathbf{c}$ into Stokes' theorem:\n$$ \\int_f \\mathbf{c} \\cdot d\\mathbf{S} = \\oint_C \\left( \\frac{1}{2}(\\mathbf{c} \\times \\mathbf{r}) \\right) \\cdot d\\mathbf{l} $$\nSince $\\mathbf{c}$ is constant, we can take it out of the integral on the left. On the right, we use the scalar triple product identity $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{C} \\cdot (\\mathbf{A} \\times \\mathbf{B})$:\n$$ \\mathbf{c} \\cdot \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C (\\mathbf{c} \\times \\mathbf{r}) \\cdot d\\mathbf{l} = \\frac{1}{2} \\oint_C \\mathbf{c} \\cdot (\\mathbf{r} \\times d\\mathbf{l}) $$\nAgain, since $\\mathbf{c}$ is constant:\n$$ \\mathbf{c} \\cdot \\left( \\int_f d\\mathbf{S} \\right) = \\mathbf{c} \\cdot \\left( \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} \\right) $$\nThis equality must hold for any arbitrary constant vector $\\mathbf{c}$, which implies that the vectors themselves must be equal:\n$$ \\mathbf{S}_f = \\int_f d\\mathbf{S} = \\frac{1}{2} \\oint_C \\mathbf{r} \\times d\\mathbf{l} $$\nFor a triangular face with vertices $\\mathbf{r}_a, \\mathbf{r}_b, \\mathbf{r}_c$ traversed in that order, the boundary $C$ consists of three straight edges. The line integral becomes a sum:\n$$ \\mathbf{S}_f = \\frac{1}{2} \\left[ \\int_{\\mathbf{r}_a}^{\\mathbf{r}_b} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_b}^{\\mathbf{r}_c} \\mathbf{r} \\times d\\mathbf{r} + \\int_{\\mathbf{r}_c}^{\\mathbf{r}_a} \\mathbf{r} \\times d\\mathbf{r} \\right] $$\nThe integral along the edge from $\\mathbf{r}_a$ to $\\mathbf{r}_b$ evaluates to $\\mathbf{r}_a \\times \\mathbf{r}_b$. Similarly, the other integrals are $\\mathbf{r}_b \\times \\mathbf{r}_c$ and $\\mathbf{r}_c \\times \\mathbf{r}_a$. Thus,\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_a \\times \\mathbf{r}_b + \\mathbf{r}_b \\times \\mathbf{r}_c + \\mathbf{r}_c \\times \\mathbf{r}_a) $$\nThis expression is equivalent to the more common form using edge vectors:\n$$ \\mathbf{S}_f = \\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a) $$\n\nThe direction of $\\mathbf{S}_f$ depends on the order of the vertices. For a closed control volume, the vector must point outwards. A robust criterion is to compare its direction with the vector from the cell centroid $\\mathbf{r}_P$ to the face centroid $\\mathbf{r}_f$. The vector $\\mathbf{d}_f = \\mathbf{r}_f - \\mathbf{r}_P$ points from inside the cell towards the face. The outward normal $\\mathbf{S}_f$ must have a positive projection onto this vector.\nThe procedure is:\n1.  Calculate a tentative area vector $\\mathbf{S}_{\\text{tentative}}$ using an arbitrary (but consistent) vertex ordering, e.g., $\\frac{1}{2} (\\mathbf{r}_b - \\mathbf{r}_a) \\times (\\mathbf{r}_c - \\mathbf{r}_a)$.\n2.  Calculate the cell centroid $\\mathbf{r}_P = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{r}_i$ and the face centroid $\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_a + \\mathbf{r}_b + \\mathbf{r}_c)$.\n3.  Check the sign of the dot product: $\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P)$.\n4.  If the dot product is positive, the orientation is correct: $\\mathbf{S}_f = \\mathbf{S}_{\\text{tentative}}$.\n5.  If the dot product is negative, the orientation is incorrect and must be flipped: $\\mathbf{S}_f = -\\mathbf{S}_{\\text{tentative}}$.\n\n### Step 2: Computation of Oriented Face Area Vectors\n\nThe vertices are given as $\\mathbf{r}_1 = (0, 0, 0)$, $\\mathbf{r}_2 = (1, 0, 0)$, $\\mathbf{r}_3 = (0, 2, 0)$, and $\\mathbf{r}_4 = (0, 0, 3)$.\nThe cell centroid $\\mathbf{r}_P$ of the tetrahedron is:\n$$ \\mathbf{r}_P = \\frac{1}{4}(\\mathbf{r}_1 + \\mathbf{r}_2 + \\mathbf{r}_3 + \\mathbf{r}_4) = \\frac{1}{4}( (0+1+0+0), (0+0+2+0), (0+0+0+3) ) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}) $$\n$$ \\mathbf{r}_P = (0.25, 0.5, 0.75) $$\n\n**Face 1: $(1,2,3)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_3$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_1)) = \\frac{1}{2} ((1, 0, 0) \\times (0, 2, 0)) = \\frac{1}{2}(0, 0, 2) = (0, 0, 1)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_3) = \\frac{1}{3}(1, 2, 0) = (\\frac{1}{3}, \\frac{2}{3}, 0)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 0 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0, 0, 1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, -\\frac{3}{4}) = -\\frac{3}{4} < 0$.\nThe vector points inward. Flip the sign: $\\mathbf{S}_1 = -(0, 0, 1) = (0, 0, -1)$.\n\n**Face 2: $(1,2,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_2, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((1, 0, 0) \\times (0, 0, 3)) = \\frac{1}{2}(0, -3, 0) = (0, -1.5, 0)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_2+\\mathbf{r}_4) = \\frac{1}{3}(1, 0, 3) = (\\frac{1}{3}, 0, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, 0 - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (0, -1.5, 0) \\cdot (\\frac{1}{12}, -\\frac{1}{2}, \\frac{1}{4}) = (-1.5)(-\\frac{1}{2}) = 0.75 > 0$.\nThe vector points outward. $\\mathbf{S}_2 = (0, -1.5, 0)$.\n\n**Face 3: $(1,3,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_1, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_1) \\times (\\mathbf{r}_4 - \\mathbf{r}_1)) = \\frac{1}{2} ((0, 2, 0) \\times (0, 0, 3)) = \\frac{1}{2}(6, 0, 0) = (3, 0, 0)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_1+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(0, 2, 3) = (0, \\frac{2}{3}, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (0 - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3, 0, 0) \\cdot (-\\frac{1}{4}, \\frac{1}{6}, \\frac{1}{4}) = 3(-\\frac{1}{4}) = -0.75 < 0$.\nThe vector points inward. Flip the sign: $\\mathbf{S}_3 = -(3, 0, 0) = (-3, 0, 0)$.\n\n**Face 4: $(2,3,4)$**\nLet $\\mathbf{r}_a=\\mathbf{r}_2, \\mathbf{r}_b=\\mathbf{r}_3, \\mathbf{r}_c=\\mathbf{r}_4$.\n$\\mathbf{S}_{\\text{tentative}} = \\frac{1}{2} ((\\mathbf{r}_3 - \\mathbf{r}_2) \\times (\\mathbf{r}_4 - \\mathbf{r}_2)) = \\frac{1}{2} ((-1, 2, 0) \\times (-1, 0, 3)) = \\frac{1}{2}(6, 3, 2) = (3, 1.5, 1)$.\n$\\mathbf{r}_f = \\frac{1}{3}(\\mathbf{r}_2+\\mathbf{r}_3+\\mathbf{r}_4) = \\frac{1}{3}(1, 2, 3) = (\\frac{1}{3}, \\frac{2}{3}, 1)$.\n$\\mathbf{r}_f - \\mathbf{r}_P = (\\frac{1}{3} - \\frac{1}{4}, \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}) = (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4})$.\n$\\mathbf{S}_{\\text{tentative}} \\cdot (\\mathbf{r}_f - \\mathbf{r}_P) = (3, 1.5, 1) \\cdot (\\frac{1}{12}, \\frac{1}{6}, \\frac{1}{4}) = \\frac{3}{12} + \\frac{1.5}{6} + \\frac{1}{4} = 0.25 + 0.25 + 0.25 = 0.75 > 0$.\nThe vector points outward. $\\mathbf{S}_4 = (3, 1.5, 1)$.\n\n### Step 3: Verification of Closure Property\n\nThe closure property for a closed polyhedron requires that the sum of all oriented face area vectors is the zero vector. We sum the four computed vectors:\n$$ \\sum_{f=1}^4 \\mathbf{S}_f = \\mathbf{S}_1 + \\mathbf{S}_2 + \\mathbf{S}_3 + \\mathbf{S}_4 $$\n$$ \\sum \\mathbf{S}_f = (0, 0, -1) + (0, -1.5, 0) + (-3, 0, 0) + (3, 1.5, 1) $$\n$$ \\sum \\mathbf{S}_f = (0+0-3+3, \\quad 0-1.5+0+1.5, \\quad -1+0+0+1) $$\n$$ \\sum \\mathbf{S}_f = (0, 0, 0) $$\nThe residual vector is $\\mathbf{R} = (0, 0, 0)$. The Euclidean norm of the residual vector is:\n$$ \\|\\mathbf{R}\\| = \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = \\sqrt{0^2 + 0^2 + 0^2} = 0 $$\nThe coordinates are in meters, so the face areas are in square meters ($\\mathrm{m}^2$). The problem asks for the result rounded to six significant figures.\n$$ \\left\\|\\sum_f \\mathbf{S}_f\\right\\| = 0.00000 \\ \\mathrm{m}^2 $$",
            "answer": "$$\\boxed{0.00000}$$"
        },
        {
            "introduction": "Building upon the geometric foundation from the previous exercise, we now investigate the direct consequences of violating the closure property. This thought experiment models a common type of mesh error where a single face normal is incorrectly oriented, causing the sum of face area vectors to be non-zero . By applying the Green-Gauss reconstruction to a constant field, which has an analytical gradient of zero, you will quantify the spurious gradient generated purely by this geometric inconsistency, demonstrating a fundamental test of numerical fidelity.",
            "id": "3325687",
            "problem": "Consider a single hexahedral control volume used in a finite-volume method for computational fluid dynamics, specifically a cube of side length $L$ centered at the origin with faces located at $x=\\pm L/2$, $y=\\pm L/2$, and $z=\\pm L/2$. Let each face area vector be defined as $\\mathbf{S}_f = \\mathbf{n}_f A_f$, where $\\mathbf{n}_f$ is the face unit normal and $A_f$ is the face area. In a correctly oriented mesh, the outward normals satisfy $\\sum_f \\mathbf{S}_f = \\mathbf{0}$ for any closed control volume.\n\nSuppose that due to a mesh preprocessing bug, one face normal is incorrectly oriented: the face at $x=-L/2$ is assigned the normal $\\mathbf{n} = +\\hat{\\mathbf{i}}$ instead of the correct $\\mathbf{n} = -\\hat{\\mathbf{i}}$. All other face normals are correct and outward pointing. The face areas are all $A_f = L^2$ and the control-volume measure is $V = L^3$.\n\nA constant scalar field $\\phi(\\mathbf{x}) \\equiv \\phi_0$ is sampled on this control volume. Starting from the divergence theorem and standard continuum definitions, derive the discrete Green–Gauss gradient reconstruction expression for a control volume in terms of face area vectors and face values, then apply it to this specific cell with the incorrect face normal to obtain the reconstructed gradient in the cell interior.\n\nDefine the dimensionless error\n$$\ne \\equiv \\frac{\\left\\|\\left.\\nabla \\phi\\right|_{\\text{rec}}\\right\\|\\,L}{|\\phi_0|},\n$$\nwhere $\\left.\\nabla \\phi\\right|_{\\text{rec}}$ is the reconstructed gradient inside the control volume and $\\|\\cdot\\|$ denotes the Euclidean norm. Compute $e$ for the described configuration. Express your final answer as a pure number (dimensionless). Do not include any units. No rounding is required.",
            "solution": "The problem requires the calculation of a dimensionless error in the Green-Gauss gradient reconstruction for a constant scalar field within a cubic control volume that has one incorrectly oriented face normal.\n\nFirst, we derive the general formula for the Green-Gauss gradient reconstruction. The foundation is a corollary of the divergence theorem, often called the gradient theorem, which states that for a scalar field $\\phi$ and a control volume $V$ enclosed by a surface $S$:\n$$ \\int_V \\nabla \\phi \\, dV = \\oint_S \\phi \\, \\mathbf{n} \\, dS $$\nwhere $\\mathbf{n}$ is the local outward unit normal vector on the surface $S$.\n\nIn the finite volume method, we approximate the average gradient within the control volume. The average gradient is defined as:\n$$ \\left.\\nabla \\phi\\right|_{\\text{avg}} = \\frac{1}{V} \\int_V \\nabla \\phi \\, dV $$\nSubstituting the gradient theorem, we get:\n$$ \\left.\\nabla \\phi\\right|_{\\text{avg}} = \\frac{1}{V} \\oint_S \\phi \\, \\mathbf{n} \\, dS $$\nTo obtain a discrete numerical scheme, the continuous surface integral is replaced by a sum over the discrete faces $f$ that form the boundary of the control volume:\n$$ \\oint_S \\phi \\, \\mathbf{n} \\, dS = \\sum_{f} \\int_{S_f} \\phi \\, \\mathbf{n} \\, dS $$\nThe integral over each face $S_f$ is approximated by assuming the scalar field $\\phi$ has a constant value $\\phi_f$ over that face (typically the value at the face centroid). This allows us to write:\n$$ \\int_{S_f} \\phi \\, \\mathbf{n} \\, dS \\approx \\phi_f \\int_{S_f} \\mathbf{n} \\, dS $$\nThe integral of the unit normal vector over the face area is the face area vector, $\\mathbf{S}_f = A_f \\mathbf{n}_f$, where $A_f$ is the area of face $f$ and $\\mathbf{n}_f$ is its unit normal vector.\nSubstituting this back, the discrete approximation for the gradient in the control volume, denoted as $\\left.\\nabla \\phi\\right|_{\\text{rec}}$, is:\n$$ \\left.\\nabla \\phi\\right|_{\\text{rec}} = \\frac{1}{V} \\sum_{f} \\phi_f \\mathbf{S}_f $$\nThis is the Green-Gauss gradient reconstruction formula.\n\nNow, we apply this formula to the specific problem. The scalar field is given as a constant, $\\phi(\\mathbf{x}) \\equiv \\phi_0$. This means the value of the field at any point, including all face centroids, is simply $\\phi_0$. Therefore, for all faces $f$, we have $\\phi_f = \\phi_0$. The formula simplifies to:\n$$ \\left.\\nabla \\phi\\right|_{\\text{rec}} = \\frac{1}{V} \\sum_{f} \\phi_0 \\mathbf{S}_f = \\frac{\\phi_0}{V} \\sum_{f} \\mathbf{S}_f $$\nThe problem is reduced to calculating the sum of the face area vectors, $\\sum_f \\mathbf{S}_f$, for the given cube. The cube has a side length of $L$ and is centered at the origin. Its volume is $V = L^3$, and each face has an area $A_f = L^2$.\n\nLet's list the face area vectors for the six faces of the cube, paying close attention to the specified bug. We use a standard Cartesian coordinate system with unit vectors $\\hat{\\mathbf{i}}$, $\\hat{\\mathbf{j}}$, and $\\hat{\\mathbf{k}}$.\n\n1.  Face at $x=L/2$: Correct outward normal is $\\mathbf{n} = \\hat{\\mathbf{i}}$. The area vector is $\\mathbf{S}_{x+} = A_f \\hat{\\mathbf{i}} = L^2 \\hat{\\mathbf{i}}$.\n2.  Face at $x=-L/2$: The correct outward normal would be $\\mathbf{n} = -\\hat{\\mathbf{i}}$. However, due to the bug, it is assigned the normal $\\mathbf{n} = \\hat{\\mathbf{i}}$. The area vector is $\\mathbf{S}_{x-} = A_f \\hat{\\mathbf{i}} = L^2 \\hat{\\mathbf{i}}$.\n3.  Face at $y=L/2$: Correct outward normal is $\\mathbf{n} = \\hat{\\mathbf{j}}$. The area vector is $\\mathbf{S}_{y+} = A_f \\hat{\\mathbf{j}} = L^2 \\hat{\\mathbf{j}}$.\n4.  Face at $y=-L/2$: Correct outward normal is $\\mathbf{n} = -\\hat{\\mathbf{j}}$. The area vector is $\\mathbf{S}_{y-} = -A_f \\hat{\\mathbf{j}} = -L^2 \\hat{\\mathbf{j}}$.\n5.  Face at $z=L/2$: Correct outward normal is $\\mathbf{n} = \\hat{\\mathbf{k}}$. The area vector is $\\mathbf{S}_{z+} = A_f \\hat{\\mathbf{k}} = L^2 \\hat{\\mathbf{k}}$.\n6.  Face at $z=-L/2$: Correct outward normal is $\\mathbf{n} = -\\hat{\\mathbf{k}}$. The area vector is $\\mathbf{S}_{z-} = -A_f \\hat{\\mathbf{k}} = -L^2 \\hat{\\mathbf{k}}$.\n\nThe sum of these vectors is:\n$$ \\sum_{f} \\mathbf{S}_f = \\mathbf{S}_{x+} + \\mathbf{S}_{x-} + \\mathbf{S}_{y+} + \\mathbf{S}_{y-} + \\mathbf{S}_{z+} + \\mathbf{S}_{z-} $$\n$$ \\sum_{f} \\mathbf{S}_f = (L^2 \\hat{\\mathbf{i}} + L^2 \\hat{\\mathbf{i}}) + (L^2 \\hat{\\mathbf{j}} - L^2 \\hat{\\mathbf{j}}) + (L^2 \\hat{\\mathbf{k}} - L^2 \\hat{\\mathbf{k}}) $$\n$$ \\sum_{f} \\mathbf{S}_f = 2L^2 \\hat{\\mathbf{i}} + \\mathbf{0} + \\mathbf{0} = 2L^2 \\hat{\\mathbf{i}} $$\nFor a correctly oriented closed volume, this sum would be $\\mathbf{0}$. The non-zero result is entirely due to the mesh error.\n\nNow, we can compute the reconstructed gradient:\n$$ \\left.\\nabla \\phi\\right|_{\\text{rec}} = \\frac{\\phi_0}{V} \\sum_{f} \\mathbf{S}_f = \\frac{\\phi_0}{L^3} (2L^2 \\hat{\\mathbf{i}}) = \\frac{2\\phi_0}{L} \\hat{\\mathbf{i}} $$\nAnalytically, the gradient of a constant field is zero ($\\nabla\\phi_0 = \\mathbf{0}$). The numerical scheme produces a non-zero gradient due to the geometric inconsistency.\n\nFinally, we compute the dimensionless error $e$, defined as:\n$$ e \\equiv \\frac{\\left\\|\\left.\\nabla \\phi\\right|_{\\text{rec}}\\right\\|\\,L}{|\\phi_0|} $$\nThe Euclidean norm of the reconstructed gradient is:\n$$ \\left\\|\\left.\\nabla \\phi\\right|_{\\text{rec}}\\right\\| = \\left\\| \\frac{2\\phi_0}{L} \\hat{\\mathbf{i}} \\right\\| = \\left| \\frac{2\\phi_0}{L} \\right| = \\frac{2|\\phi_0|}{L} $$\nSubstituting this norm into the expression for $e$:\n$$ e = \\frac{\\left(\\frac{2|\\phi_0|}{L}\\right)L}{|\\phi_0|} = \\frac{2|\\phi_0|}{|\\phi_0|} $$\nAssuming $\\phi_0 \\neq 0$, we find:\n$$ e = 2 $$\nThis dimensionless value quantifies the error in the gradient calculation introduced by the single incorrect face normal.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "So far, we have focused on geometric integrity and its impact on the simplest case of a constant field. We now turn our attention to quantifying the approximation error inherent in the Green-Gauss method for more general scenarios . This practice involves a skewed, non-orthogonal cell and a non-linear scalar field, a situation where the reconstruction is no longer exact. By comparing the diffusive flux computed from the reconstructed gradient against the exact analytical flux, you will directly measure the discretization error and gain insight into how mesh quality impacts accuracy.",
            "id": "3963598",
            "problem": "Consider a single planar control volume in Two-Dimensional (2D) Computational Fluid Dynamics (CFD), defined by the counterclockwise vertex sequence $V_1=(0,0)$, $V_2=(1,0.2)$, $V_3=(1.1,1)$, and $V_4=(0,1)$. A diffusing scalar field is given analytically by $\\phi(x,y)=x^2+xy+y^2$, and the diffusion coefficient is constant, $\\Gamma=1$ (dimensionless). Focus on the diffusive flux across the face $\\overline{V_2V_3}$.\n\nStarting from the divergence theorem and using only fundamental definitions of fluxes and geometric quantities, derive a discrete Green–Gauss gradient reconstruction for the cell-averaged gradient by approximating the boundary integral with a face-midpoint quadrature over each face of the polygon. Use outward-pointing face normals consistent with the counterclockwise vertex ordering. Then:\n- Compute the discrete diffusive flux across the face $\\overline{V_2V_3}$ by contracting the reconstructed cell-averaged gradient with the outward normal for that face and multiplying by the face length.\n- Compute the exact diffusive flux across the same face by line-integrating the analytic gradient $\\nabla \\phi$ over the face with the outward normal.\n- Determine the absolute error attributable to gradient reconstruction as the absolute value of the difference between the discrete flux and the exact flux.\n\nAssume all quantities are dimensionless. Express the final answer as a single reduced fraction, with no units. Do not round; provide the exact value.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The methodology specified is a standard approach in computational fluid dynamics for which a clear verification procedure exists. Therefore, the problem is valid.\n\nThe solution proceeds in three main parts:\n1.  Calculation of the cell-averaged gradient, $(\\nabla \\phi)_{GG}$, using the Green–Gauss method with midpoint quadrature.\n2.  Calculation of the discrete diffusive flux, $F_{23, \\text{discrete}}$, across the face $\\overline{V_2V_3}$ using the reconstructed gradient.\n3.  Calculation of the exact diffusive flux, $F_{23, \\text{exact}}$, by direct integration along the face $\\overline{V_2V_3}$.\n4.  Determination of the absolute error between the discrete and exact fluxes.\n\nThe diffusive flux vector is defined as $\\vec{J} = -\\Gamma \\nabla \\phi$. With the given diffusion coefficient $\\Gamma=1$, the flux vector is simply $\\vec{J} = -\\nabla \\phi$. The total flux out of a face with normal vector $\\vec{S}$ is $F = \\vec{J} \\cdot \\vec{S} = -(\\nabla \\phi) \\cdot \\vec{S}$.\n\n**Part 1: Green–Gauss Gradient Reconstruction**\n\nThe gradient theorem, a consequence of the divergence theorem, states that the integral of the gradient of a scalar field $\\phi$ over a volume (or area in 2D) $\\Omega$ is equal to the integral of the scalar field over the boundary $\\partial \\Omega$:\n$$ \\int_{\\Omega} \\nabla \\phi \\, d\\Omega = \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\nThe cell-averaged gradient is defined as $\\overline{\\nabla \\phi} = \\frac{1}{A} \\int_{\\Omega} \\nabla \\phi \\, d\\Omega$, where $A$ is the area of the cell. Thus,\n$$ \\overline{\\nabla \\phi} = \\frac{1}{A} \\oint_{\\partial \\Omega} \\phi \\, d\\vec{S} $$\nThe Green–Gauss method approximates the boundary integral as a sum over the cell faces. Using midpoint quadrature, the reconstructed gradient $(\\nabla \\phi)_{GG}$ is:\n$$ (\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum_{f=1}^{N} \\phi(\\vec{r}_f) \\vec{S}_f $$\nwhere $\\vec{r}_f$ is the midpoint of face $f$ and $\\vec{S}_f$ is its outward normal vector. For a face defined by vertices $(x_i, y_i)$ and $(x_j, y_j)$ in counterclockwise order, $\\vec{S}_f = (y_j - y_i, -(x_j - x_i)) = (\\Delta y, -\\Delta x)$.\n\nThe vertices are $V_1=(0,0)$, $V_2=(1, \\frac{1}{5})$, $V_3=(\\frac{11}{10}, 1)$, and $V_4=(0,1)$. The scalar field is $\\phi(x,y)=x^2+xy+y^2$.\n\nFirst, we calculate the area $A$ of the quadrilateral using the shoelace formula:\n$$ A = \\frac{1}{2} |(x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1)| $$\n$$ A = \\frac{1}{2} |(0 \\cdot \\frac{1}{5} + 1 \\cdot 1 + \\frac{11}{10} \\cdot 1 + 0 \\cdot 0) - (0 \\cdot 1 + \\frac{1}{5} \\cdot \\frac{11}{10} + 1 \\cdot 0 + 1 \\cdot 0)| $$\n$$ A = \\frac{1}{2} |(1 + \\frac{11}{10}) - (\\frac{11}{50})| = \\frac{1}{2} |\\frac{21}{10} - \\frac{11}{50}| = \\frac{1}{2} |\\frac{105 - 11}{50}| = \\frac{1}{2} \\frac{94}{50} = \\frac{47}{50} $$\n\nNext, we calculate the properties for each face:\nFace 1 ($\\overline{V_1V_2}$):\n$\\vec{S}_1 = (\\frac{1}{5}-0, -(1-0)) = (\\frac{1}{5}, -1)$.\nMidpoint $\\vec{r}_1 = (\\frac{0+1}{2}, \\frac{0+1/5}{2}) = (\\frac{1}{2}, \\frac{1}{10})$.\n$\\phi(\\vec{r}_1) = (\\frac{1}{2})^2 + (\\frac{1}{2})(\\frac{1}{10}) + (\\frac{1}{10})^2 = \\frac{1}{4} + \\frac{1}{20} + \\frac{1}{100} = \\frac{25+5+1}{100} = \\frac{31}{100}$.\n$\\phi(\\vec{r}_1)\\vec{S}_1 = \\frac{31}{100}(\\frac{1}{5}, -1) = (\\frac{31}{500}, -\\frac{31}{100})$.\n\nFace 2 ($\\overline{V_2V_3}$):\n$\\vec{S}_2 = (1-\\frac{1}{5}, -(\\frac{11}{10}-1)) = (\\frac{4}{5}, -\\frac{1}{10})$.\nMidpoint $\\vec{r}_2 = (\\frac{1+11/10}{2}, \\frac{1/5+1}{2}) = (\\frac{21/10}{2}, \\frac{6/5}{2}) = (\\frac{21}{20}, \\frac{3}{5})$.\n$\\phi(\\vec{r}_2) = (\\frac{21}{20})^2 + (\\frac{21}{20})(\\frac{3}{5}) + (\\frac{3}{5})^2 = \\frac{441}{400} + \\frac{63}{100} + \\frac{9}{25} = \\frac{441+252+144}{400} = \\frac{837}{400}$.\n$\\phi(\\vec{r}_2)\\vec{S}_2 = \\frac{837}{400}(\\frac{4}{5}, -\\frac{1}{10}) = (\\frac{837}{500}, -\\frac{837}{4000})$.\n\nFace 3 ($\\overline{V_3V_4}$):\n$\\vec{S}_3 = (1-1, - (0-\\frac{11}{10})) = (0, \\frac{11}{10})$.\nMidpoint $\\vec{r}_3 = (\\frac{11/10+0}{2}, \\frac{1+1}{2}) = (\\frac{11}{20}, 1)$.\n$\\phi(\\vec{r}_3) = (\\frac{11}{20})^2 + (\\frac{11}{20})(1) + 1^2 = \\frac{121}{400} + \\frac{11}{20} + 1 = \\frac{121+220+400}{400} = \\frac{741}{400}$.\n$\\phi(\\vec{r}_3)\\vec{S}_3 = \\frac{741}{400}(0, \\frac{11}{10}) = (0, \\frac{8151}{4000})$.\n\nFace 4 ($\\overline{V_4V_1}$):\n$\\vec{S}_4 = (0-1, -(0-0)) = (-1, 0)$.\nMidpoint $\\vec{r}_4 = (\\frac{0+0}{2}, \\frac{1+0}{2}) = (0, \\frac{1}{2})$.\n$\\phi(\\vec{r}_4) = 0^2 + 0(\\frac{1}{2}) + (\\frac{1}{2})^2 = \\frac{1}{4}$.\n$\\phi(\\vec{r}_4)\\vec{S}_4 = \\frac{1}{4}(-1, 0) = (-\\frac{1}{4}, 0)$.\n\nNow, we sum the $\\phi_f \\vec{S}_f$ terms:\n$\\sum \\phi_f \\vec{S}_f = (\\frac{31}{500}+\\frac{837}{500}-\\frac{1}{4}, -\\frac{31}{100}-\\frac{837}{4000}+\\frac{8151}{4000}+0)$\nx-component: $\\frac{868}{500} - \\frac{125}{500} = \\frac{743}{500}$.\ny-component: $\\frac{-1240 - 837 + 8151}{4000} = \\frac{6074}{4000} = \\frac{3037}{2000}$.\n$\\sum \\phi_f \\vec{S}_f = (\\frac{743}{500}, \\frac{3037}{2000})$.\n\nThe reconstructed gradient is:\n$(\\nabla \\phi)_{GG} = \\frac{1}{A} \\sum \\phi_f \\vec{S}_f = \\frac{1}{47/50} (\\frac{743}{500}, \\frac{3037}{2000}) = \\frac{50}{47} (\\frac{743}{500}, \\frac{3037}{2000})$\n$(\\nabla \\phi)_{GG} = (\\frac{50 \\cdot 743}{47 \\cdot 500}, \\frac{50 \\cdot 3037}{47 \\cdot 2000}) = (\\frac{743}{470}, \\frac{3037}{1880})$.\n\n**Part 2: Discrete Diffusive Flux**\n\nThe discrete diffusive flux across face $\\overline{V_2V_3}$ is $F_{23, \\text{discrete}} = -(\\nabla \\phi)_{GG} \\cdot \\vec{S}_2$.\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743}{470}, \\frac{3037}{1880}\\right) \\cdot \\left(\\frac{4}{5}, -\\frac{1}{10}\\right) $$\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{743 \\cdot 4}{470 \\cdot 5} - \\frac{3037 \\cdot 1}{1880 \\cdot 10}\\right) = - \\left(\\frac{2972}{2350} - \\frac{3037}{18800}\\right) $$\nThe least common multiple of the denominators $2350 = 50 \\cdot 47$ and $18800 = 400 \\cdot 47$ is $400 \\cdot 47 = 18800$.\n$$ F_{23, \\text{discrete}} = - \\left(\\frac{2972 \\cdot 8}{18800} - \\frac{3037}{18800}\\right) = - \\left(\\frac{23776 - 3037}{18800}\\right) = - \\frac{20739}{18800} $$\n\n**Part 3: Exact Diffusive Flux**\n\nThe exact flux is the line integral $F_{23, \\text{exact}} = \\int_{\\overline{V_2V_3}} -\\nabla\\phi \\cdot d\\vec{S}$.\nThe face $\\overline{V_2V_3}$ is parameterized by $\\vec{r}(t) = V_2(1-t) + V_3t$ for $t \\in [0, 1]$.\n$\\vec{r}(t) = (1, \\frac{1}{5})(1-t) + (\\frac{11}{10}, 1)t = (1-t+\\frac{11}{10}t, \\frac{1-t}{5}+t) = (1+\\frac{1}{10}t, \\frac{1}{5}+\\frac{4}{5}t)$.\nThe differential normal vector is $d\\vec{S} = (\\frac{dy}{dt}, -\\frac{dx}{dt})dt = (\\frac{4}{5}, -\\frac{1}{10})dt = \\vec{S}_2 dt$.\nThe analytical gradient of $\\phi(x,y)=x^2+xy+y^2$ is $\\nabla \\phi = (2x+y, x+2y)$.\nEvaluating the gradient on the line $\\vec{r}(t)$:\n$\\frac{\\partial \\phi}{\\partial x} = 2(1+\\frac{t}{10}) + (\\frac{1}{5}+\\frac{4t}{5}) = 2+\\frac{t}{5}+\\frac{1}{5}+\\frac{4t}{5} = \\frac{11}{5}+t$.\n$\\frac{\\partial \\phi}{\\partial y} = (1+\\frac{t}{10}) + 2(\\frac{1}{5}+\\frac{4t}{5}) = 1+\\frac{t}{10}+\\frac{2}{5}+\\frac{8t}{5} = \\frac{7}{5}+\\frac{17t}{10}$.\n$\\nabla \\phi(\\vec{r}(t)) = (\\frac{11}{5}+t, \\frac{7}{5}+\\frac{17t}{10})$.\n\nThe integrand is $\\nabla\\phi \\cdot \\vec{S}_2$:\n$(\\frac{11}{5}+t)(\\frac{4}{5}) + (\\frac{7}{5}+\\frac{17t}{10})(-\\frac{1}{10}) = (\\frac{44}{25}+\\frac{4t}{5}) - (\\frac{7}{50}+\\frac{17t}{100})$\n$= \\frac{88-7}{50} + \\frac{80t-17t}{100} = \\frac{81}{50} + \\frac{63t}{100} = \\frac{162+63t}{100}$.\n\nNow we integrate from $t=0$ to $t=1$:\n$\\int_0^1 \\frac{162+63t}{100} dt = \\frac{1}{100} \\left[ 162t + \\frac{63}{2}t^2 \\right]_0^1 = \\frac{1}{100}(162+\\frac{63}{2}) = \\frac{1}{100}(\\frac{324+63}{2}) = \\frac{387}{200}$.\nThe exact flux is $F_{23, \\text{exact}} = -1 \\cdot \\frac{387}{200} = -\\frac{387}{200}$.\n\n**Part 4: Absolute Error**\n\nThe absolute error is $E = |F_{23, \\text{discrete}} - F_{23, \\text{exact}}|$.\n$$ E = \\left| -\\frac{20739}{18800} - \\left(-\\frac{387}{200}\\right) \\right| = \\left| \\frac{387}{200} - \\frac{20739}{18800} \\right| $$\nTo subtract, we find a common denominator, which is $18800$. Note that $18800/200 = 94$.\n$$ E = \\left| \\frac{387 \\cdot 94}{18800} - \\frac{20739}{18800} \\right| = \\left| \\frac{36378}{18800} - \\frac{20739}{18800} \\right| $$\n$$ E = \\left| \\frac{36378 - 20739}{18800} \\right| = \\frac{15639}{18800} $$\nTo check if this fraction can be reduced, we find the prime factors of the numerator and denominator.\n$15639 = 3 \\cdot 13 \\cdot 401$.\n$18800 = 188 \\cdot 100 = 2^2 \\cdot 47 \\cdot 10^2 = 2^2 \\cdot 47 \\cdot (2 \\cdot 5)^2 = 2^4 \\cdot 5^2 \\cdot 47$.\nThere are no common prime factors. Therefore, the fraction is irreducible.",
            "answer": "$$\n\\boxed{\\frac{15639}{18800}}\n$$"
        }
    ]
}