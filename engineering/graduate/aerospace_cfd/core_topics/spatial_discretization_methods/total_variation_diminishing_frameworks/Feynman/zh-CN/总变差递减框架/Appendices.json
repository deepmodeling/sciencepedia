{
    "hands_on_practices": [
        {
            "introduction": "在探索先进的激波捕捉格式之前，我们首先要理解其最基本的构件。本练习通过分析一阶迎风格式在处理一个简单的阶跃间断时的行为，来揭示其总变差不增（Total Variation Non-Increasing, TVNI）的关键特性。这个性质虽然伴随着数值耗散，但它保证了解的单调性，为我们构建更高阶的无振荡格式奠定了基础。",
            "id": "4001350",
            "problem": "考虑一个简化的航空航天喷管管道中，一个代表被对流输运的混合分数的被动标量场 $u(x,t)$ 的一维线性平流，该过程由标量守恒律 $u_{t} + a\\,u_{x} = 0$ 建模，其中平流速度 $a > 0$ 为常数。使用间距为 $\\Delta x$ 的均匀网格，该场由时间层 $t^{n}$ 上的单元平均值 $\\{u_{i}^{n}\\}$ 表示。时间步长为 $\\Delta t$，无量纲的 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a\\,\\Delta t / \\Delta x$，满足 $0  \\nu  1$。从 $t^{n}$ 到 $t^{n+1}$ 的更新通过针对 $a0$ 的一阶迎风格式执行：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right).\n$$\n假设一个周期性计算域和一个分段常数的初始状态，该状态在索引为 $j$ 的单元界面处存在一个单一跳跃，定义为：对于所有 $i \\leq j$，有 $u_{i}^{n} = U_{L}$；对于所有 $i \\geq j+1$，有 $u_{i}^{n} = U_{R}$，其中 $U_{L}$ 和 $U_{R}$ 是常数且 $U_{L} \\neq U_{R}$。在时间层 $t^{n}$ 的离散总变差定义为：\n$$\nTV^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|.\n$$\n仅使用给定的定义和数据，计算 $TV^{n}$ 和 $TV^{n+1}$，然后确定总变差的变化量\n$$\n\\Delta TV = TV^{n+1} - TV^{n}.\n$$\n根据你的计算，推断一阶迎风步长是保持 $TV$ 不变、减小它还是增加它，但只报告 $\\Delta TV$ 的值。将最终答案表示为一个无量纲量。无需进行四舍五入。",
            "solution": "经验证，该问题是自洽的、一致的且科学上合理的。我们着手解决它。\n\n目标是计算应用于具有指定分段常数初始条件的一维线性平流问题的一阶迎风格式的总变差变化量 $\\Delta TV = TV^{n+1} - TV^{n}$。\n\n首先，我们计算初始时间层 $t^{n}$ 的总变差，记作 $TV^{n}$。离散总变差定义为：\n$$\nTV^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|\n$$\n初始状态由 $u_{i}^{n} = U_{L}$ (对所有 $i \\leq j$) 和 $u_{i}^{n} = U_{R}$ (对所有 $i \\geq j+1$) 给出，其中 $U_{L}$ 和 $U_{R}$ 是常数且 $U_{L} \\neq U_{R}$。我们检查求和中的差分项 $|u_{i+1}^{n} - u_{i}^{n}|$：\n- 对于任意索引 $i  j$， $u_{i+1}^{n}$ 和 $u_{i}^{n}$ 都等于 $U_{L}$。差值为 $|U_{L} - U_{L}| = 0$。\n- 对于索引 $i = j$，差值为 $|u_{j+1}^{n} - u_{j}^{n}| = |U_{R} - U_{L}|$。\n- 对于任意索引 $i > j$， $u_{i+1}^{n}$ 和 $u_{i}^{n}$ 都等于 $U_{R}$。差值为 $|U_{R} - U_{R}| = 0$。\n\n因此，求和中只包含一个非零项，该项出现在间断点处。时间 $t^{n}$ 的总变差为：\n$$\nTV^{n} = |U_{R} - U_{L}|\n$$\n\n接下来，我们计算下一个时间层 $t^{n+1}$ 的场的状态。对于 $a  0$ 的一阶迎风格式由下式给出：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\n其中 $\\nu = a\\,\\Delta t / \\Delta x$ 是 CFL 数，满足 $0  \\nu  1$。我们将此格式应用于所有网格索引 $i$ 的初始状态 $u_{i}^{n}$：\n- 对于任意索引 $i \\leq j$：我们有 $u_{i}^{n} = U_{L}$ 和 $u_{i-1}^{n} = U_{L}$。\n  $$\n  u_{i}^{n+1} = U_{L} - \\nu(U_{L} - U_{L}) = U_{L}\n  $$\n- 对于索引 $i = j+1$：我们有 $u_{j+1}^{n} = U_{R}$ 和 $u_{j}^{n} = U_{L}$。\n  $$\n  u_{j+1}^{n+1} = U_{R} - \\nu(U_{R} - U_{L}) = (1-\\nu)U_{R} + \\nu U_{L}\n  $$\n- 对于任意索引 $i \\geq j+2$：我们有 $u_{i}^{n} = U_{R}$ 和 $u_{i-1}^{n} = U_{R}$。\n  $$\n  u_{i}^{n+1} = U_{R} - \\nu(U_{R} - U_{R}) = U_{R}\n  $$\n\n所以，在时间 $t^{n+1}$ 的场为：\n- 对于 $i \\leq j$，$u_{i}^{n+1} = U_{L}$。\n- $u_{j+1}^{n+1} = (1-\\nu)U_{R} + \\nu U_{L}$。\n- 对于 $i \\geq j+2$，$u_{i}^{n+1} = U_{R}$。\n原本尖锐的跳跃被抹平到索引为 $j+1$ 的单元上。\n\n现在，我们计算时间层 $t^{n+1}$ 的总变差，即 $TV^{n+1} = \\sum_{i} |u_{i+1}^{n+1} - u_{i}^{n+1}|$。我们检查差分项：\n- 对于任意索引 $i  j$，差值为 $|u_{i+1}^{n+1} - u_{i}^{n+1}| = |U_{L} - U_{L}| = 0$。\n- 对于索引 $i = j$，差值为：\n  $$\n  |u_{j+1}^{n+1} - u_{j}^{n+1}| = |((1-\\nu)U_{R} + \\nu U_{L}) - U_{L}| = |(1-\\nu)U_{R} - (1-\\nu)U_{L}| = |(1-\\nu)(U_{R} - U_{L})|\n  $$\n  由于 $0  \\nu  1$，项 $(1-\\nu)$ 是正的。因此，这个差值是 $(1-\\nu)|U_{R} - U_{L}|$。\n- 对于索引 $i = j+1$，差值为：\n  $$\n  |u_{j+2}^{n+1} - u_{j+1}^{n+1}| = |U_{R} - ((1-\\nu)U_{R} + \\nu U_{L})| = |\\nu U_{R} - \\nu U_{L}| = |\\nu(U_{R} - U_{L})|\n  $$\n  由于 $\\nu  0$，这个差值是 $\\nu|U_{R} - U_{L}|$。\n- 对于任意索引 $i > j+1$，差值为 $|u_{i+1}^{n+1} - u_{i}^{n+1}| = |U_{R} - U_{R}| = 0$。\n\n$TV^{n+1}$ 的求和仅包含两个非零项：\n$$\nTV^{n+1} = (1-\\nu)|U_{R} - U_{L}| + \\nu|U_{R} - U_{L}|\n$$\n提取公因式 $|U_{R} - U_{L}|$：\n$$\nTV^{n+1} = ((1-\\nu) + \\nu)|U_{R} - U_{L}| = (1)|U_{R} - U_{L}| = |U_{R} - U_{L}|\n$$\n\n最后，我们计算总变差的变化量 $\\Delta TV$：\n$$\n\\Delta TV = TV^{n+1} - TV^{n} = |U_{R} - U_{L}| - |U_{R} - U_{L}| = 0\n$$\n计算表明，对于单一阶跃函数的初始条件，一阶迎风格式精确地保持总变差守恒。这表明，虽然该格式是耗散的（它会抹平尖锐的锋面），但其方式是总变差不增的，并且对于这种特定的单调剖面，总变差保持不变。问题陈述中提到，标量场代表混合分数，该量本身是无量纲的。因此，$U_{L}$、$U_{R}$ 以及 $\\Delta TV$ 都是无量纲的。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "为了追求更高的精度，我们自然会从一阶格式转向经典的二阶格式，如Lax-Wendroff格式。然而，精度的提升往往伴随着代价。本练习将通过对Lax-Wendroff格式的分析，定量地展示它在间断附近如何引入非物理的数值振荡，并导致总变差的增加。 这个结果清晰地揭示了开发TVD格式的必要性。",
            "id": "4001392",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，定义在间距为 $\\Delta x$ 的均匀网格和时间步长为 $\\Delta t$ 上。定义 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t / \\Delta x$，并假设 $0  \\nu  1$。设数值方法为经典的 Lax–Wendroff 格式\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\nu^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right).\n$$\n用阶梯（黎曼型）数据初始化解：\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x \\le 0, \\\\\nu_{R},  x  0,\n\\end{cases}\n$$\n离散化为 $u^{0}_{j} = u_{L}$ (对于 $j \\leq 0$) 和 $u^{0}_{j} = u_{R}$ (对于 $j \\geq 1$)，跳跃量为 $\\Delta u = u_{R} - u_{L} \\neq 0$。定义在时间层 $n$ 的总变差为\n$$\n\\mathrm{TV}^{n} = \\sum_{j \\in \\mathbb{Z}} \\left|u^{n}_{j+1} - u^{n}_{j}\\right|.\n$$\n从控制偏微分方程和数值方法的定义出发，推导 Lax–Wendroff 格式在原始方程之外满足的最低非零阶修正方程（也称为后向误差或相容性展开），并找出与 $u_{xxx}$ 成正比的最低阶色散修正项。然后，仅使用该格式和给定的初始数据，计算精确的单步值 $u^{1}_{j}$ 并确定 $\\mathrm{TV}^{1}$ 和 $\\mathrm{TV}^{0}$。最后，提供一个时间步长后总变差增量的精确解析表达式，\n$$\n\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0},\n$$\n用 CFL 数 $\\nu$ 和跳跃的绝对值 $\\left|\\Delta u\\right|$ 表示。无需四舍五入。最终答案必须是单一的封闭形式表达式。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：一维线性平流方程，$u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数。\n- **离散化**：均匀网格，间距为 $\\Delta x$，时间步长为 $\\Delta t$。\n- **定义**：\n    - Courant–Friedrichs–Lewy (CFL) 数：$\\nu = a\\,\\Delta t / \\Delta x$。\n    - 在时间层 $n$ 的总变差：$\\mathrm{TV}^{n} = \\sum_{j \\in \\mathbb{Z}} \\left|u^{n}_{j+1} - u^{n}_{j}\\right|$。\n    - 初始数据的跳跃量：$\\Delta u = u_{R} - u_{L} \\neq 0$。\n- **数值格式**：Lax–Wendroff 格式，$u^{n+1}_{j} = u^{n}_{j} - \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\nu^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right)$。\n- **初始条件**：阶梯函数（黎曼问题），$u(x,0) = \\begin{cases} u_{L},  x \\le 0 \\\\ u_{R},  x  0 \\end{cases}$，离散化为 $u^{0}_{j} = u_{L}$ (对于 $j \\leq 0$) 和 $u^{0}_{j} = u_{R}$ (对于 $j \\geq 1$)。\n- **约束条件**：$a  0$ 和 $0  \\nu  1$。\n- **任务**：\n    1. 推导 Lax–Wendroff 格式的最低非零阶修正方程，并找出与 $u_{xxx}$ 成正比的项。\n    2. 计算单步值 $u^{1}_{j}$。\n    3. 确定 $\\mathrm{TV}^{1}$ 和 $\\mathrm{TV}^{0}$。\n    4. 提供总变差增量 $\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0}$ 的精确解析表达式，用 $\\nu$ 和 $|\\Delta u|$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学性**：该问题基于偏微分方程数值分析的基本概念，特别是针对线性平流方程的 Lax–Wendroff 格式的分析。这些是计算流体动力学和应用数学中的标准课题。\n- **适定性**：问题定义清晰，包含所有必要信息。任务具体，能导出一个唯一的解析解。对 $\\nu$ 的约束确保了格式的稳定性。\n- **客观性**：问题使用精确的数学语言和定义进行陈述。没有主观或含糊的元素。\n\n问题是自洽的、一致的且科学合理的。它不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题是**有效**的。将提供完整解答。\n\n***\n\n按照要求，解答分三部分进行：推导修正方程，计算一个时间步长后的解及相关的总变差，以及最后计算总变差的变化。\n\n**第一部分：修正方程**\n\n为推导修正方程，我们对 Lax–Wendroff 格式中的每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开，其中 $x_j = j\\Delta x$ 且 $t_n = n\\Delta t$。令 $u \\equiv u(x_j, t_n)$。\n\n格式中的各项展开如下：\n$$\nu^{n+1}_{j} = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\frac{\\Delta t^3}{6} u_{ttt} + O(\\Delta t^4)\n$$\n$$\nu^{n}_{j \\pm 1} = u \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\frac{\\Delta x^4}{24} u_{xxxx} + O(\\Delta x^5)\n$$\n由此，我们构成有限差分算子：\n$$\nu^{n}_{j+1} - u^{n}_{j-1} = 2\\Delta x u_x + \\frac{\\Delta x^3}{3} u_{xxx} + O(\\Delta x^5)\n$$\n$$\nu^{n}_{j+1} - 2u^{n}_{j} + u^{n}_{j-1} = \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12} u_{xxxx} + O(\\Delta x^6)\n$$\n将这些代入 Lax–Wendroff 格式：\n$$\nu^{n+1}_{j} - u^{n}_{j} = -\\frac{\\nu}{2}\\left(2\\Delta x u_x + \\frac{\\Delta x^3}{3} u_{xxx}\\right) + \\frac{\\nu^2}{2}\\left(\\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12} u_{xxxx}\\right) + \\dots\n$$\n两边同除以 $\\Delta t$ 并代入 $\\nu = a \\Delta t / \\Delta x$：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = -\\frac{a \\Delta t}{2\\Delta x \\Delta t}\\left(2\\Delta x u_x + \\dots\\right) + \\frac{a^2 \\Delta t^2}{2\\Delta x^2 \\Delta t}\\left(\\Delta x^2 u_{xx} + \\dots\\right)\n$$\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\frac{a^2 \\Delta t}{2}u_{xx} + \\dots\n$$\n左侧是时间上的向前差分，其展开为：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{\\Delta t^2}{6} u_{ttt} + O(\\Delta t^3)\n$$\n令两个表达式相等，得到截断误差：\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{\\Delta t^2}{6} u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\n重新整理以匹配原始偏微分方程的形式：\n$$\nu_t + a u_x = -\\frac{\\Delta t}{2} u_{tt} + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a \\Delta x^2}{6} u_{xxx} - \\frac{\\Delta t^2}{6} u_{ttt} + \\dots\n$$\n对于修正方程，我们使用偏微分方程本身将时间导数递归地替换为空间导数。由 $u_t = -a u_x$ 可得 $u_{tt} = \\partial_t(-a u_x) = -a (\\partial_t u)_x = -a(-a u_x)_x = a^2 u_{xx}$，以及 $u_{ttt} = \\partial_t(a^2 u_{xx}) = a^2 (\\partial_t u)_{xx} = a^2(-a u_x)_{xx} = -a^3 u_{xxx}$。\n将这些代入整理后的方程：\n$$\nu_t + a u_x = -\\frac{\\Delta t}{2} (a^2 u_{xx}) + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a \\Delta x^2}{6} u_{xxx} + \\frac{\\Delta t^2}{6} (a^3 u_{xxx}) + \\dots\n$$\n二阶导数项相互抵消，证实了该格式是二阶精度的。\n$$\nu_t + a u_x = \\left(\\frac{a^3 \\Delta t^2}{6} - \\frac{a \\Delta x^2}{6}\\right) u_{xxx} + \\dots\n$$\n最低非零阶误差项是色散项。我们通过代入 $\\Delta t = \\nu \\Delta x / a$ 将其系数用 $\\nu$ 表示：\n$$\n\\frac{a^3}{6}\\left(\\frac{\\nu \\Delta x}{a}\\right)^2 - \\frac{a \\Delta x^2}{6} = \\frac{a^3 \\nu^2 \\Delta x^2}{6 a^2} - \\frac{a \\Delta x^2}{6} = \\frac{a \\nu^2 \\Delta x^2}{6} - \\frac{a \\Delta x^2}{6} = \\frac{a \\Delta x^2}{6} (\\nu^2 - 1)\n$$\n最低阶修正方程为：\n$$\nu_t + a u_x = \\frac{a \\Delta x^2}{6}(\\nu^2 - 1) u_{xxx}\n$$\n最低阶色散修正项是 $\\frac{a \\Delta x^2}{6}(\\nu^2 - 1) u_{xxx}$。\n\n**第二部分：总变差计算**\n\n首先，我们计算初始时刻 $t=0$（或 $n=0$）的总变差。\n初始数据为 $u^{0}_{j} = u_{L}$ (对于 $j \\leq 0$) 和 $u^{0}_{j} = u_{R}$ (对于 $j \\geq 1$)。\n总变差为 $\\mathrm{TV}^{0} = \\sum_{j} |u^{0}_{j+1} - u^{0}_{j}|$。唯一的非零差分出现在 $j=0$ 处。\n$$\n\\mathrm{TV}^{0} = |u^{0}_{1} - u^{0}_{0}| = |u_{R} - u_{L}| = |\\Delta u|\n$$\n接下来，我们通过将 Lax-Wendroff 格式应用于初始数据 $u^0_j$ 来计算下一个时间步的解 $u^{1}_{j}$。\n- 对于 $j \\leq -1$：模板点 $(j-1, j, j+1)$ 均在 $u^0=u_L$ 的区域内。因此，$u^{0}_{j-1} = u^{0}_{j} = u^{0}_{j+1} = u_L$。格式得到 $u^{1}_{j} = u_L$。\n- 对于 $j \\geq 2$：模板点均在 $u^0=u_R$ 的区域内。因此，$u^{0}_{j-1} = u^{0}_{j} = u^{0}_{j+1} = u_R$。格式得到 $u^{1}_{j} = u_R$。\n- 对于 $j=0$：模板值为 $u^{0}_{-1} = u_L$, $u^{0}_{0} = u_L$, $u^{0}_{1} = u_R$。\n$$\nu^{1}_{0} = u^{0}_{0} - \\frac{\\nu}{2}(u^{0}_{1} - u^{0}_{-1}) + \\frac{\\nu^2}{2}(u^{0}_{1} - 2u^{0}_{0} + u^{0}_{-1})\n$$\n$$\nu^{1}_{0} = u_L - \\frac{\\nu}{2}(u_R - u_L) + \\frac{\\nu^2}{2}(u_R - 2u_L + u_L) = u_L - \\frac{\\nu}{2}\\Delta u + \\frac{\\nu^2}{2}(u_R - u_L) = u_L + \\Delta u \\left(\\frac{\\nu^2-\\nu}{2}\\right)\n$$\n- 对于 $j=1$：模板值为 $u^{0}_{0} = u_L$, $u^{0}_{1} = u_R$, $u^{0}_{2} = u_R$。\n$$\nu^{1}_{1} = u^{0}_{1} - \\frac{\\nu}{2}(u^{0}_{2} - u^{0}_{0}) + \\frac{\\nu^2}{2}(u^{0}_{2} - 2u^{0}_{1} + u^{0}_{0})\n$$\n$$\nu^{1}_{1} = u_R - \\frac{\\nu}{2}(u_R - u_L) + \\frac{\\nu^2}{2}(u_R - 2u_R + u_L) = u_R - \\frac{\\nu}{2}\\Delta u + \\frac{\\nu^2}{2}(u_L - u_R) = u_R - \\Delta u \\left(\\frac{\\nu+\\nu^2}{2}\\right)\n$$\n在 $n=1$ 时的解仅在 $j=0$ 和 $j=1$ 处不平凡。我们现在计算 $\\mathrm{TV}^{1} = \\sum_{j} |u^{1}_{j+1} - u^{1}_{j}|$。非零差分出现在 $j=-1, 0, 1$ 处。\n- 对于 $j=-1$：$u^{1}_{0} - u^{1}_{-1} = \\left(u_L + \\Delta u \\frac{\\nu^2-\\nu}{2}\\right) - u_L = \\Delta u \\frac{\\nu(\\nu-1)}{2}$。\n- 对于 $j=0$：$u^{1}_{1} - u^{1}_{0} = \\left(u_R - \\Delta u \\frac{\\nu+\\nu^2}{2}\\right) - \\left(u_L + \\Delta u \\frac{\\nu^2-\\nu}{2}\\right) = (u_R-u_L) - \\Delta u \\left(\\frac{\\nu+\\nu^2}{2} + \\frac{\\nu^2-\\nu}{2}\\right) = \\Delta u - \\Delta u\\left(\\frac{2\\nu^2}{2}\\right) = \\Delta u (1-\\nu^2)$。\n- 对于 $j=1$：$u^{1}_{2} - u^{1}_{1} = u_R - \\left(u_R - \\Delta u \\frac{\\nu+\\nu^2}{2}\\right) = \\Delta u \\frac{\\nu(\\nu+1)}{2}$。\n\n我们取绝对值并求和。由于 $0  \\nu  1$，我们有 $\\nu-1  0$，$1-\\nu^2 > 0$ 和 $\\nu+1 > 0$。\n$$\n|u^{1}_{0} - u^{1}_{-1}| = \\left|\\Delta u \\frac{\\nu(\\nu-1)}{2}\\right| = |\\Delta u| \\frac{\\nu(1-\\nu)}{2}\n$$\n$$\n|u^{1}_{1} - u^{1}_{0}| = |\\Delta u (1-\\nu^2)| = |\\Delta u| (1-\\nu^2)\n$$\n$$\n|u^{1}_{2} - u^{1}_{1}| = \\left|\\Delta u \\frac{\\nu(\\nu+1)}{2}\\right| = |\\Delta u| \\frac{\\nu(1+\\nu)}{2}\n$$\n将这些贡献相加得到 $\\mathrm{TV}^1$：\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{\\nu(1-\\nu)}{2} + (1-\\nu^2) + \\frac{\\nu(1+\\nu)}{2} \\right)\n$$\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{\\nu-\\nu^2}{2} + 1-\\nu^2 + \\frac{\\nu+\\nu^2}{2} \\right)\n$$\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{2\\nu}{2} + 1 - \\nu^2 \\right) = |\\Delta u| (1 + \\nu - \\nu^2)\n$$\n\n**第三部分：总变差的变化**\n\n总变差的增量为 $\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0}$。\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (1 + \\nu - \\nu^2) - |\\Delta u|\n$$\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (1 + \\nu - \\nu^2 - 1)\n$$\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (\\nu - \\nu^2) = |\\Delta u| \\nu (1 - \\nu)\n$$\n对于 $0  \\nu  1$，该结果为正，表明 Lax–Wendroff 格式对于此问题不是总变差递减 (TVD) 的，因为它会产生伪振荡，从而增加了数值解的总变差。",
            "answer": "$$ \\boxed{\\nu(1-\\nu)|\\Delta u|} $$"
        },
        {
            "introduction": "TVD框架的核心思想是通过引入通量限制器（flux limiter）来控制数值通量，从而在高梯度区域抑制振荡，同时在光滑区域保持高阶精度。本练习将引导你从一个物理直观的斜率构造方法（调和平均）出发，推导出一个著名的通量限制器函数。通过验证该限制器满足Sweby图中的TVD条件，你将亲身体验现代激波捕捉格式的设计精髓。",
            "id": "4001334",
            "problem": "考虑在计算流体力学（CFD）中使用的MUSCL（Monotonic Upstream-centered Schemes for Conservation Laws）框架下，具有光滑解重构的一维标量守恒律。在总变差递减（TVD）格式中，单元内的重构斜率通过一个通量限制器函数 $\\phi(r)$ 进行限制，其中斜率比 $r$ 定义为 $r = \\Delta^{-}/\\Delta^{+}$，$\\Delta^{-}$ 和 $\\Delta^{+}$ 分别表示守恒变量的后向和前向单边差分。一个光滑、可微限制器的经典构造规定，当单边斜率 $\\Delta^{-}$ 和 $\\Delta^{+}$ 同号时，受限斜率等于这两个单边斜率的调和平均值；否则它为零。具体来说，当 $\\Delta^{-}\\Delta^{+}  0$ 时，受限斜率 $s_{\\text{L}}$ 由 $s_{\\text{L}} = 2\\Big/\\Big(\\frac{1}{\\Delta^{+}} + \\frac{1}{\\Delta^{-}}\\Big)$ 给出；否则 $s_{\\text{L}} = 0$。通过设置 $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$ 来定义通量限制器。\n\n使用此调和平均值规定以及当单边斜率异号时重构为零的TVD要求，推导所得限制器 $\\phi(r)$ 作为 $r$ 的函数在 $\\mathbb{R}$ 上连续的解析形式，然后通过证明以下每个性质来验证它属于TVD Sweby区域：\n- 对于 $r \\leq 0$，$\\phi(r) = 0$，\n- 对于 $r \\geq 0$，有 $0 \\leq \\phi(r) \\leq \\min\\{2r,\\,2\\}$，\n- $\\phi(1) = 1$。\n\n最后，为了定量地确定该限制器相对于TVD上界的位置，定义垂直间隔\n$$\\Delta(r) = \\min\\{2r,\\,2\\} - \\phi(r), \\quad r \\geq 0.$$\n求出 $\\Delta(r)$ 在 $r \\geq 0$ 上的精确最大值。将你的最终答案表示为一个无量纲数。无需进行四舍五入。",
            "solution": "用户提供了一个基于计算流体力学总变差递减（TVD）方案理论的有效问题陈述。该问题提法恰当、客观，并包含足够的信息以获得唯一解。我们将按要求进行推导和分析。\n\n该问题要求推导通量限制器函数 $\\phi(r)$，验证其位于TVD区域内，以及一个涉及该函数的后续优化问题。\n\n首先，我们推导通量限制器函数 $\\phi(r)$ 的解析形式。\n受限斜率 $s_{\\text{L}}$ 通过定义与通量限制器 $\\phi(r)$ 相关联：\n$$s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$$\n斜率比 $r$ 定义为 $r = \\Delta^{-}/\\Delta^{+}$，这意味着 $\\Delta^{-} = r\\,\\Delta^{+}$。\n\n受限斜率 $s_{\\text{L}}$ 的规定根据 $\\Delta^{-}\\Delta^{+}$ 的符号分为两种情况。\n条件 $\\Delta^{-}\\Delta^{+}  0$ 可以用 $r$ 的定义重写。假设 $\\Delta^{+} \\neq 0$，我们有 $(r\\,\\Delta^{+})\\Delta^{+}  0$，化简为 $r\\,(\\Delta^{+})^2  0$。因为 $(\\Delta^{+})^2  0$，所以该条件等价于 $r  0$。\n类似地，条件 $\\Delta^{-}\\Delta^{+} \\leq 0$ 等价于 $r \\leq 0$。\n\n情况1：$r  0$\n在这种情况下，受限斜率是 $\\Delta^{-}$ 和 $\\Delta^{+}$ 的调和平均值：\n$$s_{\\text{L}} = \\frac{2}{\\frac{1}{\\Delta^{+}} + \\frac{1}{\\Delta^{-}}}$$\n将 $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$ 和 $\\Delta^{-} = r\\,\\Delta^{+}$ 代入此方程，得到：\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2}{\\frac{1}{\\Delta^{+}} + \\frac{1}{r\\,\\Delta^{+}}}$$\n我们可以从右侧分母中提出因子 $1/\\Delta^{+}$：\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2}{\\frac{1}{\\Delta^{+}}\\left(1 + \\frac{1}{r}\\right)} = \\frac{2\\Delta^{+}}{1 + \\frac{1}{r}}$$\n化简分母得到 $1 + \\frac{1}{r} = \\frac{r+1}{r}$：\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2\\Delta^{+}}{\\frac{r+1}{r}} = \\frac{2r}{r+1}\\Delta^{+}$$\n假设 $\\Delta^{+} \\neq 0$，我们可以两边除以 $\\Delta^{+}$ 来找到 $\\phi(r)$ 的表达式：\n$$\\phi(r) = \\frac{2r}{r+1} \\quad \\text{for } r  0$$\n\n情况2：$r \\leq 0$\n在这种情况下，受限斜率规定为零：$s_{\\text{L}} = 0$。\n使用定义 $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$：\n$$\\phi(r)\\,\\Delta^{+} = 0$$\n假设 $\\Delta^{+} \\neq 0$，我们必有 $\\phi(r) = 0$。\n$$\\phi(r) = 0 \\quad \\text{for } r \\leq 0$$\n\n综合这两种情况，我们得到限制器函数的完整定义，它在 $\\mathbb{R}$ 上是连续的：\n$$\n\\phi(r) = \\begin{cases}\n    \\frac{2r}{r+1}  \\text{if } r  0 \\\\\n    0  \\text{if } r \\leq 0\n\\end{cases}\n$$\n\n接下来，我们通过检查三个指定的性质来验证该限制器属于 TVD Sweby 区域。\n\n性质1：对于 $r \\leq 0$，$\\phi(r) = 0$。\n这根据问题中对 $\\Delta^{-}\\Delta^{+} \\leq 0$ 情况的规定直接推导出的定义是成立的。\n\n性质2：对于 $r \\geq 0$，有 $0 \\leq \\phi(r) \\leq \\min\\{2r,\\,2\\}$。\n对于 $r=0$，$\\phi(0)=0$ 且 $\\min\\{2(0), 2\\}=0$，因此 $0 \\leq 0 \\leq 0$ 成立。\n对于 $r0$，我们有 $\\phi(r) = \\frac{2r}{r+1}$。\n-  第一个不等式：$0 \\leq \\phi(r)$。因为 $r0$，分子 $2r$ 和分母 $r+1$ 都是正数，所以 $\\phi(r)  0$。此不等式成立。\n-  第二个不等式：$\\phi(r) \\leq 2r$。我们必须检查 $\\frac{2r}{r+1} \\leq 2r$ 是否成立。因为 $r0$，我们可以两边除以 $2r$ 得到 $\\frac{1}{r+1} \\leq 1$。由于 $r0$，有 $r+1  1$，所以 $\\frac{1}{r+1}  1$。此不等式成立。\n-  第三个不等式：$\\phi(r) \\leq 2$。我们必须检查 $\\frac{2r}{r+1} \\leq 2$ 是否成立。因为 $r+1  0$，我们可以两边乘以 $r+1$ 得到 $2r \\leq 2(r+1)$，即 $2r \\leq 2r+2$，或 $0 \\leq 2$。这总是成立的。\n由于 $\\phi(r)$ 小于或等于 $2r$ 和 $2$，它必定小于或等于它们的最小值。因此，对于所有 $r \\geq 0$，$0 \\leq \\phi(r) \\leq \\min\\{2r, 2\\}$ 得以验证。\n\n性质3：$\\phi(1) = 1$。\n使用 $r0$ 的公式，我们在 $r=1$ 处求值：\n$$\\phi(1) = \\frac{2(1)}{1+1} = \\frac{2}{2} = 1$$\n此性质得到验证。这证实了当上游和下游斜率相等时，该格式简化为二阶中心差分斜率，这是一个理想的特性。\n\n最后，我们确定垂直间隔 $\\Delta(r) = \\min\\{2r, 2\\} - \\phi(r)$ 在 $r \\geq 0$ 上的最大值。\n函数 $\\min\\{2r, 2\\}$ 有一个分段定义，取决于 $r \\leq 1$ 还是 $r  1$。\n- 对于 $0 \\leq r \\leq 1$，我们有 $\\min\\{2r, 2\\} = 2r$。\n- 对于 $r  1$，我们有 $\\min\\{2r, 2\\} = 2$。\n\n所以，我们可以将 $\\Delta(r)$ 写成分段函数的形式：\n$$\n\\Delta(r) = \\begin{cases}\n    2r - \\frac{2r}{r+1}  \\text{if } 0 \\leq r \\leq 1 \\\\\n    2 - \\frac{2r}{r+1}  \\text{if } r  1\n\\end{cases}\n$$\n我们来分析每一段。\n\n对于 $0 \\leq r \\leq 1$：\n$$\\Delta(r) = 2r - \\frac{2r}{r+1} = \\frac{2r(r+1) - 2r}{r+1} = \\frac{2r^2 + 2r - 2r}{r+1} = \\frac{2r^2}{r+1}$$\n为了求最大值，我们计算关于 $r$ 的导数：\n$$\\frac{d\\Delta}{dr} = \\frac{d}{dr}\\left(\\frac{2r^2}{r+1}\\right) = \\frac{(4r)(r+1) - (2r^2)(1)}{(r+1)^2} = \\frac{4r^2 + 4r - 2r^2}{(r+1)^2} = \\frac{2r^2+4r}{(r+1)^2} = \\frac{2r(r+2)}{(r+1)^2}$$\n对于 $r \\in (0, 1]$，项 $2r$、$r+2$ 和 $(r+1)^2$ 均为正。因此，在 $(0, 1]$ 上 $\\frac{d\\Delta}{dr}  0$。这意味着 $\\Delta(r)$ 在区间 $[0, 1]$ 上是严格递增的。该区间上的最大值出现在右端点 $r=1$ 处：\n$$\\Delta(1) = \\frac{2(1)^2}{1+1} = \\frac{2}{2} = 1$$\n在左端点处，$\\Delta(0)=0$。\n\n对于 $r  1$：\n$$\\Delta(r) = 2 - \\frac{2r}{r+1} = \\frac{2(r+1) - 2r}{r+1} = \\frac{2r + 2 - 2r}{r+1} = \\frac{2}{r+1}$$\n为了求最大值，我们计算导数：\n$$\\frac{d\\Delta}{dr} = \\frac{d}{dr}\\left(\\frac{2}{r+1}\\right) = -\\frac{2}{(r+1)^2}$$\n对于 $r  1$，导数 $\\frac{d\\Delta}{dr}$ 总是负的。这意味着 $\\Delta(r)$ 在区间 $(1, \\infty)$ 上是严格递减的。该区间上的 $\\Delta(r)$ 值总是小于在 $r=1$ 处的值。该开区间上的上确界在 $r \\to 1^{+}$ 时达到，即 $\\lim_{r\\to 1^{+}}\\frac{2}{r+1} = \\frac{2}{2} = 1$。\n\n综合对两个区间的分析，我们看到 $\\Delta(r)$ 在 $[0,1]$ 上从 $0$ 增加到 $1$，然后在 $(1, \\infty)$ 上从 $1$ 减少到 $0$。因此，$\\Delta(r)$ 的全局最大值在 $r=1$ 处取得。\n最大值为 $\\Delta(1)=1$。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}