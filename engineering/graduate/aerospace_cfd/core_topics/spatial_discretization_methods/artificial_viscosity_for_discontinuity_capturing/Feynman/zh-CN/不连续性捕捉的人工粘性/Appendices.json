{
    "hands_on_practices": [
        {
            "introduction": "在我们数值地捕捉激波之前，我们必须首先理解它的物理性质。这个练习将带您回到第一性原理，要求您从欧拉方程的积分形式推导出朗肯-雨贡纽跳跃条件。这个推导为我们的数值解（通过人工粘性进行正则化）必须近似的基本物理约束提供了依据，使其成为理解激波捕捉方法的关键第一步 。",
            "id": "3944623",
            "problem": "在一个高阶有限体积计算流体动力学 (CFD) 求解器中，通过使用一个在远离间断处消失的人工（体积）粘性项来捕捉一维激波。在无粘性极限下，跨越激波的弱解必须满足一维可压缩欧拉方程的质量、动量和能量的积分守恒律。考虑一个理想气体（比热比为 $\\gamma$）的一维可压缩欧拉方程组的守恒形式，其中涉及密度 $\\rho$、速度 $u$、压力 $p$ 和总能量密度 $E$：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(E + p)\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\n其热力学封闭关系为 $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$。一个平面间断（激波）以速度 $S$ 传播，进入一个均匀的左状态 $(\\rho_{L},u_{L},p_{L})$，并留下一个均匀的右状态 $(\\rho_{R},u_{R},p_{R})$。人工粘性是足够局域化的，因此在渐进的粘性消失极限下，朗肯-雨贡纽跳跃条件在激波两侧成立。\n\n从上述方程组在一个跨越移动间断的时空控制体上的积分形式守恒律出发，推导关联左右状态和激波速度 $S$ 的朗肯-雨贡纽跳跃条件。然后，利用这些条件，为比热比 $\\gamma = \\frac{7}{5}$ 的理想气体的以下给定状态计算激波速度 $S$：\n- 左状态：$\\rho_{L} = 1$ $\\mathrm{kg/m^{3}}$，$u_{L} = 800$ $\\mathrm{m/s}$，$p_{L} = 1.0\\times 10^{5}$ $\\mathrm{Pa}$。\n- 右状态：$\\rho_{R} = \\frac{108}{53}$ $\\mathrm{kg/m^{3}}$，$u_{R} = \\frac{4450}{9}$ $\\mathrm{m/s}$，$p_{R} = \\frac{17}{6}\\times 10^{5}$ $\\mathrm{Pa}$。\n\n请以米/秒 (m/s) 为单位表示最终的激波速度。如果在任何步骤中使用了中间舍入，请保留足够的精度以避免有效位的损失，并且不要对最终答案进行舍入；本题要求一个精确值。",
            "solution": "问题要求从一维可压缩欧拉方程的积分形式推导朗肯-雨贡纽跳跃条件，并随后为一组给定的左右状态计算激波速度 $S$。\n\n首先，我们来推导朗肯-雨贡纽条件。一维欧拉方程以守恒形式给出：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = \\mathbf{0}\n$$\n其中 $\\mathbf{U}$ 是守恒变量向量，$\\mathbf{F}$ 是通量向量：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\n此处，$\\rho$ 是密度， $u$ 是速度， $p$ 是压力， $E$ 是单位体积的总能量，由理想气体封闭关系给出：\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\n其中 $\\gamma$ 是比热比。\n\n为推导跨越间断的跳跃条件，我们考虑在一个包含激波前沿（位于位置 $x_s(t)$）的固定空间区域 $[x_a, x_b]$ 上的守恒律积分形式。\n$$\n\\int_{x_a}^{x_b} \\left( \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} \\right) dx = \\mathbf{0}\n$$\n应用莱布尼兹积分法则并积分，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\n状态向量 $\\mathbf{U}$ 在激波前沿 $x_s(t)$ 处是不连续的。我们假设它在激波左侧取常数值 $\\mathbf{U}_L$，在右侧取常数值 $\\mathbf{U}_R$。该积分可以被拆分为：\n$$\n\\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\int_{x_a}^{x_s(t)} \\mathbf{U}_L \\, dx + \\int_{x_s(t)}^{x_b} \\mathbf{U}_R \\, dx = \\mathbf{U}_L (x_s(t) - x_a) + \\mathbf{U}_R (x_b - x_s(t))\n$$\n对此式关于时间 $t$ 求导，并注意到激波速度为 $S = \\frac{dx_s}{dt}$，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\mathbf{U}_L \\frac{dx_s}{dt} - \\mathbf{U}_R \\frac{dx_s}{dt} = S (\\mathbf{U}_L - \\mathbf{U}_R) = -S (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\n我们将跨越激波的物理量 $q$ 的跳跃定义为 $[\\![q]\\!] = q_R - q_L$。因此，时间导数项为 $-S [\\![\\mathbf{U}]\\!]$。\n将此代回积分守恒律：\n$$\n-S [\\![\\mathbf{U}]\\!] + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\n现在，我们取区间收缩至激波前沿的极限，即 $x_a \\to x_s^-$ 且 $x_b \\to x_s^+$。在此极限下，$\\mathbf{F}(x_a) \\to \\mathbf{F}(\\mathbf{U}_L)$ 且 $\\mathbf{F}(x_b) \\to \\mathbf{F}(\\mathbf{U}_R)$。方程变为：\n$$\n-S [\\![\\mathbf{U}]\\!] + [\\![\\mathbf{F}]\\!] = \\mathbf{0}\n$$\n这就得到了朗肯-雨贡纽跳跃条件的一般形式：\n$$\nS [\\![\\mathbf{U}]\\!] = [\\![\\mathbf{F}]\\!]\n$$\n对欧拉方程组的每个分量写出此式，我们得到具体的跳跃条件：\n1.  质量守恒：$S [\\![\\rho]\\!] = [\\![\\rho u]\\!]$\n    $$S (\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L$$\n2.  动量守恒：$S [\\![\\rho u]\\!] = [\\![\\rho u^2 + p]\\!]$\n    $$S (\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L)$$\n3.  能量守恒：$S [\\![E]\\!] = [\\![u(E+p)]\\!]$\n    $$S (E_R - E_L) = u_R(E_R + p_R) - u_L(E_L + p_L)$$\n这些就是关联激波左右两侧状态与激波速度 $S$ 的朗肯-雨贡纽条件。\n\n接下来，我们使用所提供的数据计算激波速度 $S$：\n-   $\\gamma = \\frac{7}{5}$\n-   左状态：$\\rho_L = 1 \\ \\mathrm{kg/m^3}$，$u_L = 800 \\ \\mathrm{m/s}$，$p_L = 1.0 \\times 10^5 \\ \\mathrm{Pa}$。\n-   右状态：$\\rho_R = \\frac{108}{53} \\ \\mathrm{kg/m^3}$，$u_R = \\frac{4450}{9} \\ \\mathrm{m/s}$，$p_R = \\frac{17}{6} \\times 10^5 \\ \\mathrm{Pa}$。\n\n我们可以使用三个跳跃条件中的任意一个。质量守恒方程提供了计算 $S$ 的最直接方法：\n$$S = \\frac{\\rho_R u_R - \\rho_L u_L}{\\rho_R - \\rho_L}$$\n我们代入给定的数值，并保持其分数形式以维持精度。\n分子是：\n$$\n\\rho_R u_R - \\rho_L u_L = \\left(\\frac{108}{53}\\right) \\left(\\frac{4450}{9}\\right) - (1)(800)\n$$\n化简第一项：$\\frac{108}{9} = 12$。\n$$\n= \\frac{12 \\times 4450}{53} - 800 = \\frac{53400}{53} - \\frac{800 \\times 53}{53} = \\frac{53400 - 42400}{53} = \\frac{11000}{53}\n$$\n分母是：\n$$\n\\rho_R - \\rho_L = \\frac{108}{53} - 1 = \\frac{108 - 53}{53} = \\frac{55}{53}\n$$\n现在，我们可以计算激波速度 $S$：\n$$\nS = \\frac{\\frac{11000}{53}}{\\frac{55}{53}} = \\frac{11000}{55}\n$$\n为简化此分数，我们可以将分子和分母同时除以 $55$：\n$$\nS = \\frac{11000}{55} = \\frac{200 \\times 55}{55} = 200\n$$\n激波速度为 $S = 200 \\ \\mathrm{m/s}$。\n\n为确保所提供状态的一致性，可以验证这个 $S$ 值是否也满足动量和能量跳跃条件。我们用动量方程来检验。从质量和动量跳跃条件推导出的一个方便形式是 $[\\![p]\\!] = \\rho_L(u_L-S)(u_L-u_R)$。\n等式左边：\n$$\np_R - p_L = \\frac{17}{6} \\times 10^5 - 1 \\times 10^5 = \\left(\\frac{17}{6} - 1\\right) \\times 10^5 = \\frac{11}{6} \\times 10^5\n$$\n等式右边：\n$$\n\\rho_L (u_L - S) (u_L - u_R) = (1) (800 - 200) \\left(800 - \\frac{4450}{9}\\right)\n$$\n$$\n= 600 \\left(\\frac{7200 - 4450}{9}\\right) = 600 \\left(\\frac{2750}{9}\\right) = \\frac{200}{3} \\times 2750 = \\frac{550000}{3} = \\frac{5.5 \\times 10^5}{3}\n$$\n我们检验 $\\frac{11}{6} \\times 10^5 = \\frac{5.5 \\times 10^5}{3}$ 是否成立。确实，$\\frac{11}{6} = \\frac{2 \\times 5.5}{2 \\times 3} = \\frac{5.5}{3}$。动量方程得到满足，这证实了数据的一致性和所计算出的激波速度的正确性。类似的检验可以表明能量方程也得到满足。\n激波速度为 $200$ 米/秒。",
            "answer": "$$\\boxed{200}$$"
        },
        {
            "introduction": "虽然人工粘性对于稳定激波计算至关重要，但它不可避免地会引入数值扩散，从而模糊尖锐的特征。这个实践问题分离并量化了这种效应对接触间断（一种更简单的跳跃类型）的影响。通过推导界面厚度随时间变化的解析解，您将具体理解人工粘性如何影响远离激波处的解的精度 。",
            "id": "3944585",
            "problem": "为了量化间断涂抹，将在具有恒定速度的无粘可压缩流中的一维接触间断建模为一个被动标量 $\\phi(x,t)$ 的平流，在 $t=0$ 时，该标量在左侧状态为 $1$，在右侧状态为 $0$。为了在数值上捕捉该间断，添加了一个常系数为 $\\nu_{a}$ 的人工粘性，从而产生一个平流-扩散方程。从被动标量的守恒和 Fick 扩散定律出发，推导一个由于人工粘性导致的界面厚度增长的解析预测，并用它来计算在均匀网格上经过 $N$ 个显式时间步长后涂抹的 $10$–$90$ 厚度。\n\n假设以下科学上一致的设置，这在航空航天计算流体力学（CFD）中间断捕捉方面具有代表性：\n- 该标量由守恒律 $\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi = 0$ 控制，并增加了一个形式为 $\\partial_{x}(\\nu_{a}\\,\\partial_{x}\\phi)$ 的人工粘性项，其中 $u_{0}$ 和 $\\nu_{a}$ 是常数。\n- 在 $t=0$ 时的初始条件是一个位于 $x=0$ 的清晰接触面，对于 $x0$ 有 $\\phi(x,0)=1$，对于 $x>0$ 有 $\\phi(x,0)=0$。计算域实际上是无限的，因此在所关心的时间段内边界效应可以忽略不计。\n- 均匀网格间距为 $\\Delta x = 5.0\\times 10^{-4}\\,\\mathrm{m}$，恒定平流速度为 $u_{0}=250\\,\\mathrm{m/s}$，人工粘性系数为 $\\nu_{a}=5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s}$，Courant–Friedrichs–Lewy (CFL) 数为 $\\mathrm{CFL}=0.40$。显式时间步长取为 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/|u_{0}|$，步数为 $N=250$。\n- 将界面厚度 $w_{10\\text{–}90}(t)$ 定义为 $\\phi(x,t)=0.9$ 和 $\\phi(x,t)=0.1$ 所在位置之间的空间距离。\n\n仅使用这些信息并从控制原理出发，计算 $N$ 步后 $w_{10\\text{–}90}$ 的预测值。将最终答案四舍五入到四位有效数字，并以米为单位表示。",
            "solution": "带有人工粘性的被动标量的基本方程是\n$$\n\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi \\;=\\; \\nu_{a}\\,\\partial_{x}^{2}\\phi,\n$$\n该方程结合了平流物理量的守恒和一个由 Fick 定律给出的扩散通量，其中通量为 $-\\,\\nu_{a}\\,\\partial_{x}\\phi$。由于系数 $u_{0}$ 和 $\\nu_{a}$ 是常数，伽利略变换（Galilean transformation）将此平流-扩散方程简化为在以恒定速度 $u_{0}$ 移动的参考系中的纯扩散方程。具体来说，定义随动坐标\n$$\n\\xi \\;=\\; x - u_{0}t.\n$$\n然后，根据链式法则，\n$$\n\\partial_{t}\\phi(x,t) \\;=\\; \\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}\\phi(x,t) \\;=\\; \\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}^{2}\\phi(x,t) \\;=\\; \\partial_{\\xi}^{2}\\phi,\n$$\n因此方程变为\n$$\n\\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi + u_{0}\\,\\partial_{\\xi}\\phi \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi\n\\;\\;\\Rightarrow\\;\\;\n\\left.\\partial_{t}\\phi\\right|_{\\xi} \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi.\n$$\n因此，在移动参考系中，$\\phi(\\xi,t)$ 满足具有恒定扩散系数 $\\nu_{a}$ 的一维扩散方程。初始条件是位于 $\\xi=0$ 的赫维赛德阶跃函数（Heaviside step）：对于 $\\xi0$ 有 $\\phi(\\xi,0)=1$，对于 $\\xi>0$ 有 $\\phi(\\xi,0)=0$。\n\n具有此初始数据的扩散方程存在一个由高斯格林函数（Gaussian Green’s function）构建的相似解。其解是余误差函数（complementary error function）剖面\n$$\n\\phi(\\xi,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{\\xi}{2\\sqrt{\\nu_{a}t}}\\right),\n$$\n该剖面从 $1$ 平滑过渡到 $0$，其特征扩散厚度随 $\\sqrt{\\nu_{a}t}$ 增长。返回到实验室坐标系，有 $\\xi=x-u_{0}t$，得到\n$$\n\\phi(x,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{x-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right).\n$$\n定义 $x_{\\alpha}(t)$ 为 $\\phi(x_{\\alpha},t)=\\alpha$ 时的位置。为求解此位置，我们使用解的误差函数形式，$\\phi(x,t) = \\frac{1}{2}\\left(1 - \\mathrm{erf}\\left(\\frac{x-u_0 t}{2\\sqrt{\\nu_a t}}\\right)\\right)$。\n$$\n\\alpha = \\frac{1}{2}\\left(1 - \\mathrm{erf}\\left(\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right)\\right) \\implies \\mathrm{erf}\\left(\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right) = 1-2\\alpha\n$$\n由此可得 $x_\\alpha(t) = u_0 t + 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(1-2\\alpha)$。\n对于 $10$–$90$ 厚度，我们设置 $\\alpha=0.9$ 和 $\\alpha=0.1$：\n$x_{0.9}(t) = u_0 t + 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(1-1.8) = u_0 t + 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(-0.8) = u_0 t - 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(0.8)$\n$x_{0.1}(t) = u_0 t + 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(1-0.2) = u_0 t + 2\\sqrt{\\nu_a t} \\, \\mathrm{erf}^{-1}(0.8)$\n厚度 $w_{10\\text{–}90}(t)$ 定义为 $x_{0.1}(t) - x_{0.9}(t)$（因为当 $x$ 增加时 $\\phi$ 减小）：\n$$\nw_{10\\text{–}90}(t) = \\left(u_0 t + 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8)\\right) - \\left(u_0 t - 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8)\\right) = 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8).\n$$\n值得注意的是，平移运动 $u_{0}t$ 从厚度计算中抵消了。在显式时间步长为 $\\Delta t$ 的情况下，经过 $N$ 步后的总时间为\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; N\\,\\frac{\\mathrm{CFL}\\,\\Delta x}{|u_{0}|}.\n$$\n根据给定值，\n$$\n\\Delta t \\;=\\; \\frac{0.40\\times 5.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; \\frac{2.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; 8.0\\times 10^{-7}\\,\\mathrm{s},\n$$\n以及\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; 250 \\times 8.0\\times 10^{-7}\\,\\mathrm{s} \\;=\\; 2.0\\times 10^{-4}\\,\\mathrm{s}.\n$$\n因此，\n$$\n\\sqrt{\\nu_{a}t} \\;=\\; \\sqrt{(5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s})\\,(2.0\\times 10^{-4}\\,\\mathrm{s})}\n\\;=\\; \\sqrt{1.0\\times 10^{-7}\\,\\mathrm{m^{2}}}\n\\;=\\; 3.162277660168379\\times 10^{-4}\\,\\mathrm{m}.\n$$\n使用 $\\mathrm{erf}^{-1}(0.8) \\approx 0.906193802436823$，预测的厚度为\n$$\nw_{10\\text{–}90} \\;=\\; 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8)\n\\;=\\; 4\\,(3.162277660168379\\times 10^{-4}\\,\\mathrm{m})\\,(0.906193802436823)\n\\;\\approx\\; 1.146254624045021\\times 10^{-3}\\,\\mathrm{m}.\n$$\n四舍五入到四位有效数字并以米表示，经过 $N$ 个时间步长后，预测的 $10$–$90$ 界面厚度为 $0.001146\\,\\mathrm{m}$。",
            "answer": "$$\\boxed{0.001146}$$"
        },
        {
            "introduction": "人工粘性的有效性取决于选择合适的系数——太小会导致振荡，而太大则会引起过度的模糊。本练习提供了一种实用的动手方法，可根据物理推理和网格参数来校准该系数。通过将粘性与目标激波厚度联系起来，您将学会在真实的计算流体力学（CFD）环境中如何控制数值格式的行为 。",
            "id": "3944604",
            "problem": "您的任务是，在计算流体力学（CFD）的框架内，推导并实现一个用于标定人工粘性系数的公式。该系数用于在一维激波管问题（即索德激波管问题）中捕捉不连续性。考虑一个理想气体的一维欧拉方程，其中增加了一个恒定的标量人工粘性项，该项通过添加一个与守恒变量梯度成比例的扩散通量来对不连续性进行正则化。流体是比热比为 $\\gamma$ 的理想气体，左右初始状态分别为 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$，其中 $\\rho$ 表示密度，单位为 $\\mathrm{kg/m^3}$；$u$ 表示速度，单位为 $\\mathrm{m/s}$；$p$ 表示压力，单位为 $\\mathrm{Pa}$。网格间距为 $\\Delta x$ 米。\n\n从基本原理出发：\n- 理想气体的一维欧拉方程（无源项）表达了状态向量 $U$ 和通量 $F(U)$ 的质量、动量和能量守恒。\n- 人工粘性正则化通过添加一个形式为 $\\partial_x (\\mu_a \\partial_x U)$ 的扩散项来建模，其中常数系数 $\\mu_a$ 的单位为 $\\mathrm{m^2/s}$。\n- 欧拉系统的特征速度是通量雅可比矩阵的特征值，近似地由 $|u| + c$ 界定，其中 $c = \\sqrt{\\gamma p / \\rho}$ 是局部声速。\n\n您必须从第一性原理出发，通过将激波建模为一个稳态行波（其中以特征波速进行的对流输运与扩散输运相平衡），推导出目标激波厚度 $\\delta$ 与所需人工粘性系数 $\\mu_a$ 之间的关系。您必须：\n1. 在激波附着坐标系中建立稳态行波平衡方程，解释与特征速度成比例的对流项和与 $\\mu_a$ 成比例的扩散项如何决定粘性激波剖面的长度尺度。\n2. 论证使用欧拉系统的最大特征速度作为对流尺度是合理的，并使用 Roe 平均状态为该速度选择一个物理上一致的估计值。定义 Roe 平均速度 $\\tilde{u}$ 和 Roe 平均总焓 $\\tilde{h}$，用 $(\\rho_L, u_L, h_L)$ 和 $(\\rho_R, u_R, h_R)$ 表示，其中 $h = \\frac{\\gamma}{\\gamma - 1}\\frac{p}{\\rho} + \\frac{1}{2}u^2$。然后定义 Roe 平均声速 $\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2}\\tilde{u}^2\\right)}$。\n3. 基于此推理，推导出 $\\mu_a$ 的显式表达式，用目标激波厚度 $\\delta$、网格间距 $\\Delta x$ 和 Roe 平均谱半径 $\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}$ 来表示。目标激波厚度设定为 $N$ 个计算单元，因此 $\\delta = N \\Delta x$。\n4. 将得到的公式在一个程序中实现，该程序能根据给定的 $(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$ 计算出 $\\mu_a$。\n\n您的程序必须处理以下测试套件，为每个案例计算所需的 $\\mu_a$，并以 $\\mathrm{m^2/s}$ 为单位输出结果，四舍五入到六位小数：\n- 案例 $1$：$\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 0.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 1.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$。\n- 案例 $2$：与案例 $1$ 相同，但 $\\Delta x = 5.0\\times10^{-4}\\,\\mathrm{m}$。\n- 案例 $3$：与案例 $1$ 相同，但 $\\Delta x = 1.0\\times10^{-6}\\,\\mathrm{m}$。\n- 案例 $4$：$\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 50.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 1.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$。\n- 案例 $5$：$\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 0.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 2.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，例如 $[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$，其中每个 $\\mu_{a,i}$ 以 $\\mathrm{m^2/s}$ 为单位表示，并四舍五入到六位小数。",
            "solution": "我们从理想气体的一维欧拉方程开始，其状态向量为 $U = [\\rho, \\rho u, E]^T$，通量为 $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$。对于理想气体，压力 $p$ 满足 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$，声速为 $c = \\sqrt{\\gamma p / \\rho}$。为了捕捉激波等不连续性，引入人工粘性作为扩散正则化。一种常见的模型是向系统中添加一个恒定的标量人工粘性系数 $\\mu_a$，得到修正后的平衡方程\n$$\n\\partial_t U + \\partial_x F(U) = \\partial_x\\left(\\mu_a \\partial_x U\\right).\n$$\n\n为了标定 $\\mu_a$，我们考虑一个在激波附着坐标系中代表激波剖面的稳态行波。设激波以速度 $s$ 移动，并引入坐标 $\\xi = x - s t$。对于一个稳态剖面 $U(\\xi)$，在移动坐标系中时间导数消失，对于一个特征模式，对流与扩散的主导阶平衡变为\n$$\n- \\lambda \\,\\frac{d U}{d \\xi} + \\mu_a \\,\\frac{d^2 U}{d \\xi^2} \\approx 0,\n$$\n其中 $\\lambda$ 是一个缩放该模式对流输运的特征速度。这是一个线性常微分方程，其解为指数形式 $U(\\xi) \\sim \\exp\\left(\\frac{\\lambda}{\\mu_a}\\xi\\right)$，这意味着激波过渡的特征长度尺度为\n$$\n\\delta \\sim \\frac{\\mu_a}{\\lambda}.\n$$\n该尺度是通过平衡对流项 $|\\lambda \\, dU/d\\xi|$ 和扩散项 $|\\mu_a \\, d^2U/d\\xi^2|$ 的量级而得到的，从而得出指数衰减长度 $\\delta$。\n\n对于一维欧拉方程，物理上相关的对流尺度由通量雅可比矩阵 $A(U) = \\partial F / \\partial U$ 的最大特征速度决定，对于理想气体，其特征值为 $u - c$、$u$ 和 $u + c$。在存在不连续性的情况下，对谱半径的一个稳健估计是使用 Roe 平均状态得到的。定义 Roe 平均速度 $\\tilde{u}$ 和总焓 $\\tilde{h}$ 为\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}},\n\\quad\nh = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho} + \\frac{1}{2} u^2,\n\\quad\n\\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\n则 Roe 平均声速 $\\tilde{a}$ 为\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\n与 Roe 线性化相关的最大特征速度是\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\n这个选择在物理上是一致的，因为它是 Roe 平均雅可比矩阵的谱半径，并且界定了压缩波跨界面传播的速度。\n\n将目标激波厚度 $\\delta$ 与粘性长度尺度相等，得到\n$$\n\\delta = \\frac{\\mu_a}{\\lambda_{\\max}}.\n$$\n如果目标激波厚度被设定为 $N$ 个计算单元，则\n$$\n\\delta = N \\Delta x,\n$$\n所需的人工粘性系数为\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\n这个关系在量纲上是一致的：$\\lambda_{\\max}$ 的单位是 $\\mathrm{m/s}$，$\\Delta x$ 的单位是 $\\mathrm{m}$，所以 $\\mu_a$ 的单位是 $\\mathrm{m^2/s}$。\n\n为每个测试案例计算 $\\mu_a$ 的算法步骤：\n1. 给定 $(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$，计算左右两侧的总焓\n$$\nh_L = \\frac{\\gamma}{\\gamma - 1} \\frac{p_L}{\\rho_L} + \\frac{1}{2} u_L^2, \\quad h_R = \\frac{\\gamma}{\\gamma - 1} \\frac{p_R}{\\rho_R} + \\frac{1}{2} u_R^2.\n$$\n2. 计算 Roe 平均速度和焓\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}, \\quad \\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\n3. 计算 Roe 平均声速\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\n4. 计算最大特征速度\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\n5. 计算所需的人工粘性系数\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\n6. 将结果四舍五入到六位小数，并以 $\\mathrm{m^2/s}$ 为单位表示。\n\n所提供的测试套件探讨了：\n- 代表 Sod 激波管的标准左右状态的一般情况（案例 1）。\n- 对网格加密（将 $\\Delta x$ 减半）的敏感性（案例 2）以及一个极细网格（案例 3）。\n- 非零入流速度的影响（案例 4）。\n- 右侧压力增加（从而改变声速）的影响（案例 5）。\n\n您的程序应生成一行包含列表 $[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$ 的输出，每个值都以 $\\mathrm{m^2/s}$ 为单位四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR):\n    # Compute total enthalpies\n    hL = (gamma / (gamma - 1.0)) * (pL / rhoL) + 0.5 * uL**2\n    hR = (gamma / (gamma - 1.0)) * (pR / rhoR) + 0.5 * uR**2\n\n    sqrL = np.sqrt(rhoL)\n    sqrR = np.sqrt(rhoR)\n    denom = sqrL + sqrR\n\n    u_tilde = (sqrL * uL + sqrR * uR) / denom\n    h_tilde = (sqrL * hL + sqrR * hR) / denom\n\n    a_tilde = np.sqrt((gamma - 1.0) * (h_tilde - 0.5 * u_tilde**2))\n\n    # Largest characteristic speed\n    lambda_max = abs(u_tilde) + a_tilde\n    return lambda_max\n\ndef required_mu(lambda_max, dx, Ncells):\n    # mu_a = lambda_max * Ncells * dx\n    return lambda_max * Ncells * dx\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells)\n    test_cases = [\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 5.0e-4, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-6, 3),\n        (1.4, 1.0, 50.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 2.0e4, 1.0e-3, 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells = case\n        lambda_max = roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR)\n        mu_a = required_mu(lambda_max, dx, Ncells)\n        # Round to six decimal places\n        mu_a_rounded = float(f\"{mu_a:.6f}\")\n        results.append(mu_a_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}