{
    "hands_on_practices": [
        {
            "introduction": "This problem goes back to first principles, exploring the mathematical foundation of shock waves. Before we can numerically capture a discontinuity, we must understand its physical properties as described by the governing conservation laws. This exercise tasks you with deriving the Rankine-Hugoniot jump conditions from the integral form of the Euler equations, which form the basis of weak solutions for hyperbolic systems and provide the exact relations across a shock that any valid numerical scheme must approximate. ",
            "id": "3944623",
            "problem": "A one-dimensional shock is captured in a high-order finite-volume Computational Fluid Dynamics (CFD) solver using an artificial (bulk) viscosity term that vanishes away from discontinuities. In the inviscid limit, the weak solution across the shock must satisfy the integral conservation laws of mass, momentum, and energy for the one-dimensional compressible Euler equations. Consider the one-dimensional compressible Euler system in conservation form for density $\\rho$, velocity $u$, pressure $p$, and total energy density $E$ of an ideal gas with ratio of specific heats $\\gamma$:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(E + p)\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\nwith the thermodynamic closure $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$. A planar discontinuity (shock) propagates at speed $S$ into a uniform left state $(\\rho_{L},u_{L},p_{L})$ and leaves a uniform right state $(\\rho_{R},u_{R},p_{R})$. The artificial viscosity is sufficiently localized that, in the asymptotic vanishing-viscosity limit, the Rankine–Hugoniot jump conditions hold across the shock.\n\nStarting from the integral form of the conservation laws for the above system over a space–time control volume that straddles the moving discontinuity, derive the Rankine–Hugoniot jump conditions that relate the left and right states and the shock speed $S$. Then, using those conditions, compute the shock speed $S$ for the following prescribed states of an ideal gas with $\\gamma = \\frac{7}{5}$:\n- Left state: $\\rho_{L} = 1$ $\\mathrm{kg/m^{3}}$, $u_{L} = 800$ $\\mathrm{m/s}$, $p_{L} = 1.0\\times 10^{5}$ $\\mathrm{Pa}$.\n- Right state: $\\rho_{R} = \\frac{108}{53}$ $\\mathrm{kg/m^{3}}$, $u_{R} = \\frac{4450}{9}$ $\\mathrm{m/s}$, $p_{R} = \\frac{17}{6}\\times 10^{5}$ $\\mathrm{Pa}$.\n\nExpress your final answer for the shock speed in meters per second (m/s). If intermediate rounding is used at any step, carry enough precision to avoid loss of significance and do not round the final answer; an exact value is expected in this case.",
            "solution": "The problem asks for the derivation of the Rankine–Hugoniot jump conditions from the integral form of the one-dimensional compressible Euler equations and subsequently for the calculation of the shock speed $S$ for a given set of left and right states.\n\nFirst, we address the derivation of the Rankine–Hugoniot conditions. The one-dimensional Euler equations are given in conservation form:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = \\mathbf{0}\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}$ is the flux vector:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume, given by the ideal gas closure relation:\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $\\gamma$ is the ratio of specific heats.\n\nTo derive the jump conditions across a discontinuity, we consider the integral form of the conservation law over a fixed spatial domain $[x_a, x_b]$ that contains the shock front, located at position $x_s(t)$.\n$$\n\\int_{x_a}^{x_b} \\left( \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} \\right) dx = \\mathbf{0}\n$$\nApplying the Leibniz integral rule and integrating, we get:\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\nThe state vector $\\mathbf{U}$ is discontinuous at the shock front $x_s(t)$. We assume it takes constant values $\\mathbf{U}_L$ to the left of the shock and $\\mathbf{U}_R$ to the right. The integral can be split:\n$$\n\\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\int_{x_a}^{x_s(t)} \\mathbf{U}_L \\, dx + \\int_{x_s(t)}^{x_b} \\mathbf{U}_R \\, dx = \\mathbf{U}_L (x_s(t) - x_a) + \\mathbf{U}_R (x_b - x_s(t))\n$$\nDifferentiating this with respect to time $t$, and noting that the shock speed is $S = \\frac{dx_s}{dt}$, we obtain:\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\mathbf{U}_L \\frac{dx_s}{dt} - \\mathbf{U}_R \\frac{dx_s}{dt} = S (\\mathbf{U}_L - \\mathbf{U}_R) = -S (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nWe define the jump in a quantity $q$ across the shock as $[q] = q_R - q_L$. Thus, the time derivative term is $-S [\\mathbf{U}]$.\nSubstituting this back into the integral conservation law:\n$$\n-S [\\mathbf{U}] + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\nNow, we take the limit as the interval shrinks to the shock front, i.e., $x_a \\to x_s^-$ and $x_b \\to x_s^+$. In this limit, $\\mathbf{F}(x_a) \\to \\mathbf{F}(\\mathbf{U}_L)$ and $\\mathbf{F}(x_b) \\to \\mathbf{F}(\\mathbf{U}_R)$. The equation becomes:\n$$\n-S [\\mathbf{U}] + [\\mathbf{F}] = \\mathbf{0}\n$$\nThis yields the general form of the Rankine–Hugoniot jump conditions:\n$$\nS [\\mathbf{U}] = [\\mathbf{F}]\n$$\nWriting this out for each component of the Euler system, we get the specific jump conditions:\n1.  Mass conservation: $S [\\rho] = [\\rho u]$\n    $$S (\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L$$\n2.  Momentum conservation: $S [\\rho u] = [\\rho u^2 + p]$\n    $$S (\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L)$$\n3.  Energy conservation: $S [E] = [u(E+p)]$\n    $$S (E_R - E_L) = u_R(E_R + p_R) - u_L(E_L + p_L)$$\nThese are the Rankine–Hugoniot conditions relating the states on the left and right of the shock to the shock speed $S$.\n\nNext, we compute the shock speed $S$ using the provided data:\n-   $\\gamma = \\frac{7}{5}$\n-   Left state: $\\rho_L = 1 \\ \\mathrm{kg/m^3}$, $u_L = 800 \\ \\mathrm{m/s}$, $p_L = 1.0 \\times 10^5 \\ \\mathrm{Pa}$.\n-   Right state: $\\rho_R = \\frac{108}{53} \\ \\mathrm{kg/m^3}$, $u_R = \\frac{4450}{9} \\ \\mathrm{m/s}$, $p_R = \\frac{17}{6} \\times 10^5 \\ \\mathrm{Pa}$.\n\nWe can use any of the three jump conditions. The mass conservation equation provides the most direct way to calculate $S$:\n$$S = \\frac{\\rho_R u_R - \\rho_L u_L}{\\rho_R - \\rho_L}$$\nWe substitute the given values, keeping them in fractional form to maintain precision.\nThe numerator is:\n$$\n\\rho_R u_R - \\rho_L u_L = \\left(\\frac{108}{53}\\right) \\left(\\frac{4450}{9}\\right) - (1)(800)\n$$\nSimplifying the first term: $\\frac{108}{9} = 12$.\n$$\n= \\frac{12 \\times 4450}{53} - 800 = \\frac{53400}{53} - \\frac{800 \\times 53}{53} = \\frac{53400 - 42400}{53} = \\frac{11000}{53}\n$$\nThe denominator is:\n$$\n\\rho_R - \\rho_L = \\frac{108}{53} - 1 = \\frac{108 - 53}{53} = \\frac{55}{53}\n$$\nNow, we can compute the shock speed $S$:\n$$\nS = \\frac{\\frac{11000}{53}}{\\frac{55}{53}} = \\frac{11000}{55}\n$$\nTo simplify this fraction, we can divide the numerator and denominator by $55$:\n$$\nS = \\frac{11000}{55} = \\frac{200 \\times 55}{55} = 200\n$$\nThe shock speed is $S = 200 \\ \\mathrm{m/s}$.\n\nTo ensure consistency of the provided states, one could verify that this value of $S$ also satisfies the momentum and energy jump conditions. Let's check with the momentum equation. A convenient form derived from the momentum and mass jump conditions is $[p] = \\rho_L(u_L-S)(u_L-u_R)$.\nLeft-hand side:\n$$\np_R - p_L = \\frac{17}{6} \\times 10^5 - 1 \\times 10^5 = \\left(\\frac{17}{6} - 1\\right) \\times 10^5 = \\frac{11}{6} \\times 10^5\n$$\nRight-hand side:\n$$\n\\rho_L (u_L - S) (u_L - u_R) = (1) (800 - 200) \\left(800 - \\frac{4450}{9}\\right)\n$$\n$$\n= 600 \\left(\\frac{7200 - 4450}{9}\\right) = 600 \\left(\\frac{2750}{9}\\right) = \\frac{200}{3} \\times 2750 = \\frac{550000}{3} = \\frac{5.5 \\times 10^5}{3}\n$$\nWe check if $\\frac{11}{6} \\times 10^5 = \\frac{5.5 \\times 10^5}{3}$. Indeed, $\\frac{11}{6} = \\frac{2 \\times 5.5}{2 \\times 3} = \\frac{5.5}{3}$. The momentum equation is satisfied, confirming the consistency of the data and the calculated shock speed. A similar check shows the energy equation is also satisfied.\nThe shock speed is $200$ meters per second.",
            "answer": "$$\\boxed{200}$$"
        },
        {
            "introduction": "Artificial viscosity introduces a diffusive mechanism to smooth sharp gradients, but this inevitably leads to the smearing of discontinuities. To quantify this effect in a controlled setting, this practice models a contact discontinuity as a passive scalar governed by an advection-diffusion equation. By solving this simplified problem analytically, you can derive an exact prediction for the growth of the interface thickness, providing a powerful tool for verifying the dissipative properties of a CFD code. ",
            "id": "3944585",
            "problem": "A one-dimensional contact discontinuity in inviscid compressible flow with constant velocity is modeled, for the purpose of quantifying discontinuity smearing, as the advection of a passive scalar $\\phi(x,t)$ that equals $1$ in the left state and $0$ in the right state at $t=0$. To capture the discontinuity numerically, an artificial viscosity of constant coefficient $\\nu_{a}$ is added, producing an advection–diffusion equation. Starting from the conservation of the advected scalar and Fick’s law of diffusion, derive an analytical prediction for the growth of the interface thickness due to artificial viscosity and use it to compute the smeared $10$–$90$ thickness after $N$ explicit time steps on a uniform grid.\n\nAssume the following scientifically consistent setup that is representative in aerospace Computational Fluid Dynamics (CFD) for discontinuity capturing:\n- The scalar is governed by the conservation law $\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi = 0$ augmented by an artificial viscosity term of the form $\\partial_{x}(\\nu_{a}\\,\\partial_{x}\\phi)$, where $u_{0}$ and $\\nu_{a}$ are constants.\n- The initial condition at $t=0$ is a sharp contact located at $x=0$ with $\\phi(x,0)=1$ for $x0$ and $\\phi(x,0)=0$ for $x0$, and the domain is effectively infinite so that boundary effects are negligible over the time of interest.\n- The uniform grid spacing is $\\Delta x = 5.0\\times 10^{-4}\\,\\mathrm{m}$, the constant advection speed is $u_{0}=250\\,\\mathrm{m/s}$, the artificial viscosity coefficient is $\\nu_{a}=5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s}$, and the Courant–Friedrichs–Lewy (CFL) number is $\\mathrm{CFL}=0.40$. The explicit time step is taken as $\\Delta t = \\mathrm{CFL}\\,\\Delta x/|u_{0}|$ and the number of steps is $N=250$.\n- Define the interface thickness $w_{10\\text{–}90}(t)$ as the spatial distance between the locations where $\\phi(x,t)=0.9$ and $\\phi(x,t)=0.1$.\n\nUsing only this information and starting from the governing principles, compute the predicted value of $w_{10\\text{–}90}$ after $N$ steps. Round your final answer to four significant figures and express it in meters.",
            "solution": "The base equation for the passive scalar with artificial viscosity is\n$$\n\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi \\;=\\; \\nu_{a}\\,\\partial_{x}^{2}\\phi,\n$$\nwhich combines the conservation of the advected quantity with a diffusive flux given by Fick’s law, where the flux is $-\\,\\nu_{a}\\,\\partial_{x}\\phi$. Because the coefficients $u_{0}$ and $\\nu_{a}$ are constants, a Galilean transformation reduces this advection–diffusion equation to a pure diffusion equation in a frame moving with the constant speed $u_{0}$. Specifically, define the comoving coordinate\n$$\n\\xi \\;=\\; x - u_{0}t.\n$$\nThen, by the chain rule,\n$$\n\\partial_{t}\\phi(x,t) \\;=\\; \\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}\\phi(x,t) \\;=\\; \\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}^{2}\\phi(x,t) \\;=\\; \\partial_{\\xi}^{2}\\phi,\n$$\nso the equation becomes\n$$\n\\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi + u_{0}\\,\\partial_{\\xi}\\phi \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi\n\\;\\;\\Rightarrow\\;\\;\n\\left.\\partial_{t}\\phi\\right|_{\\xi} \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi.\n$$\nHence, in the moving frame, $\\phi(\\xi,t)$ satisfies the one-dimensional diffusion equation with constant diffusivity $\\nu_{a}$. The initial condition is a Heaviside step located at $\\xi=0$: $\\phi(\\xi,0)=1$ for $\\xi0$ and $\\phi(\\xi,0)=0$ for $\\xi0$.\n\nThe diffusion equation with this initial data admits the similarity solution constructed from the Gaussian Green’s function. The solution is the complementary error function profile\n$$\n\\phi(\\xi,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{\\xi}{2\\sqrt{\\nu_{a}t}}\\right),\n$$\nwhich transitions smoothly from $1$ to $0$ with a characteristic diffusive thickness that grows like $\\sqrt{\\nu_{a}t}$. Returning to the laboratory frame with $\\xi=x-u_{0}t$ gives\n$$\n\\phi(x,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{x-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right).\n$$\nDefine $x_{\\alpha}(t)$ as the location where $\\phi(x_{\\alpha},t)=\\alpha$. To find the corresponding argument of the error function, $z_\\alpha = (x_\\alpha - u_0 t) / (2\\sqrt{\\nu_a t})$, we solve $\\alpha = \\frac{1}{2}\\mathrm{erfc}(z_\\alpha)$.\nFor $\\alpha=0.9$: $0.9 = \\frac{1}{2}\\mathrm{erfc}(z_{0.9}) \\Rightarrow \\mathrm{erfc}(z_{0.9}) = 1.8$. Using $\\mathrm{erfc}(z) = 1 - \\mathrm{erf}(z)$, this gives $\\mathrm{erf}(z_{0.9}) = -0.8$, so $z_{0.9} = \\mathrm{erf}^{-1}(-0.8) = -\\mathrm{erf}^{-1}(0.8)$.\nFor $\\alpha=0.1$: $0.1 = \\frac{1}{2}\\mathrm{erfc}(z_{0.1}) \\Rightarrow \\mathrm{erfc}(z_{0.1}) = 0.2$. This gives $\\mathrm{erf}(z_{0.1}) = 0.8$, so $z_{0.1} = \\mathrm{erf}^{-1}(0.8)$.\nFrom $z = (x - u_0 t) / (2\\sqrt{\\nu_a t})$, we have $x(z) = u_0 t + 2z\\sqrt{\\nu_a t}$. The locations are:\n$$ x_{0.9}(t) = u_0 t - 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8) $$\n$$ x_{0.1}(t) = u_0 t + 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8) $$\nTherefore, the $10$–$90$ thickness $w_{10\\text{–}90}(t)=x_{0.1}(t)-x_{0.9}(t)$ is:\n$$ w_{10\\text{–}90}(t) = \\left(u_0 t + 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8)\\right) - \\left(u_0 t - 2\\sqrt{\\nu_a t}\\,\\mathrm{erf}^{-1}(0.8)\\right) = 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8). $$\nNotably, the translational motion $u_{0}t$ cancels from the thickness. The elapsed time after $N$ steps with explicit time step $\\Delta t$ is\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; N\\,\\frac{\\mathrm{CFL}\\,\\Delta x}{|u_{0}|}.\n$$\nWith the given values,\n$$\n\\Delta t \\;=\\; \\frac{0.40\\times 5.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; \\frac{2.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; 8.0\\times 10^{-7}\\,\\mathrm{s},\n$$\nand\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; 250 \\times 8.0\\times 10^{-7}\\,\\mathrm{s} \\;=\\; 2.0\\times 10^{-4}\\,\\mathrm{s}.\n$$\nThus,\n$$\n\\sqrt{\\nu_{a}t} \\;=\\; \\sqrt{(5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s})\\,(2.0\\times 10^{-4}\\,\\mathrm{s})}\n\\;=\\; \\sqrt{1.0\\times 10^{-7}\\,\\mathrm{m^{2}}}\n\\;=\\; 3.162277660168379\\times 10^{-4}\\,\\mathrm{m}.\n$$\nUsing $\\mathrm{erf}^{-1}(0.8) \\approx 0.906193802436823$, the predicted thickness is\n$$\nw_{10\\text{–}90} \\;=\\; 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8)\n\\;=\\; 4\\,(3.162277660168379\\times 10^{-4}\\,\\mathrm{m})\\,(0.906193802436823)\n\\;\\approx\\; 1.146254624045021\\times 10^{-3}\\,\\mathrm{m}.\n$$\nRounded to four significant figures and expressed in meters, the predicted $10$–$90$ interface thickness after $N$ time steps is $0.001146\\,\\mathrm{m}$.",
            "answer": "$$\\boxed{0.001146}$$"
        },
        {
            "introduction": "The effectiveness of an artificial viscosity model hinges on the proper calibration of its coefficients—too little viscosity leads to oscillations, while too much causes excessive smearing. This hands-on exercise guides you through a practical calibration procedure based on a steady traveling-wave analysis, a cornerstone technique in analyzing shock structures. You will derive and implement a formula to determine the artificial viscosity coefficient $\\mu_a$ required to capture a shock within a specified number of grid cells, a crucial skill for developing robust shock-capturing schemes. ",
            "id": "3944604",
            "problem": "You are tasked with deriving and implementing a calibration formula for an artificial viscosity coefficient used to capture discontinuities in the one-dimensional shock tube problem known as the Sod shock tube, within the framework of Computational Fluid Dynamics (CFD). Consider the one-dimensional Euler equations for an ideal gas augmented by a constant scalar artificial viscosity term that regularizes discontinuities by adding a diffusive flux proportional to the gradient of the conserved variables. The fluid is an ideal gas with ratio of specific heats $\\gamma$, and the left and right initial states are $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$, respectively, where $\\rho$ denotes density in $\\mathrm{kg/m^3}$, $u$ denotes velocity in $\\mathrm{m/s}$, and $p$ denotes pressure in $\\mathrm{Pa}$. The grid spacing is $\\Delta x$ in $\\mathrm{m}$.\n\nStarting from the fundamental base:\n- The one-dimensional Euler equations for an ideal gas (without source terms) express conservation of mass, momentum, and energy for the state vector $U$ and flux $F(U)$.\n- Artificial viscosity regularization is modeled by adding a diffusive term of the form $\\partial_x (\\mu_a \\partial_x U)$, with constant coefficient $\\mu_a$ having units of $\\mathrm{m^2/s}$.\n- The characteristic speeds of the Euler system are the eigenvalues of the flux Jacobian, approximately bounded by $|u| + c$ where $c = \\sqrt{\\gamma p / \\rho}$ is the local sound speed.\n\nDerive, from first principles, a relation between the target shock thickness $\\delta$ and the required artificial viscosity coefficient $\\mu_a$ by modeling the shock as a steady traveling wave where convective transport at a characteristic wave speed is balanced by diffusive transport. You must:\n1. Formulate the steady traveling-wave balance in the shock-attached frame, explaining how a convective term proportional to a characteristic speed and a diffusive term proportional to $\\mu_a$ determine the length scale of the viscous shock profile.\n2. Justify the use of the largest characteristic speed of the Euler system as the convective scale and select a physically consistent estimate for this speed using Roe-averaged states. Define the Roe-averaged velocity $\\tilde{u}$ and Roe-averaged total enthalpy $\\tilde{h}$ in terms of $(\\rho_L, u_L, h_L)$ and $(\\rho_R, u_R, h_R)$, where $h = \\frac{\\gamma}{\\gamma - 1}\\frac{p}{\\rho} + \\frac{1}{2}u^2$, and then define the Roe-averaged sound speed $\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2}\\tilde{u}^2\\right)}$.\n3. From this reasoning, derive an explicit expression for $\\mu_a$ in terms of the target shock thickness $\\delta$, the grid spacing $\\Delta x$, and the Roe-averaged spectral radius $\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}$. The target shock thickness is prescribed as $N$ computational cells, so $\\delta = N \\Delta x$.\n4. Implement the resulting relation in a program that computes $\\mu_a$ given $(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$.\n\nYour program must process the following test suite, compute the required $\\mu_a$ for each case, and output the results in $\\mathrm{m^2/s}$, rounded to six decimal places:\n- Case $1$: $\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 0.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 1.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$.\n- Case $2$: Identical to Case $1$ except $\\Delta x = 5.0\\times10^{-4}\\,\\mathrm{m}$.\n- Case $3$: Identical to Case $1$ except $\\Delta x = 1.0\\times10^{-6}\\,\\mathrm{m}$.\n- Case $4$: $\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 50.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 1.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$.\n- Case $5$: $\\gamma = 1.4$, $\\rho_L = 1.0\\,\\mathrm{kg/m^3}$, $u_L = 0.0\\,\\mathrm{m/s}$, $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $\\rho_R = 0.125\\,\\mathrm{kg/m^3}$, $u_R = 0.0\\,\\mathrm{m/s}$, $p_R = 2.0\\times10^4\\,\\mathrm{Pa}$, $\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$, $N = 3$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$, where each $\\mu_{a,i}$ is expressed in $\\mathrm{m^2/s}$, rounded to six decimal places.",
            "solution": "We begin from the one-dimensional Euler equations for an ideal gas with state vector $U = [\\rho, \\rho u, E]^T$ and flux $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$. For an ideal gas, the pressure $p$ satisfies $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$, and the sound speed is $c = \\sqrt{\\gamma p / \\rho}$. To capture discontinuities such as shocks, artificial viscosity is introduced as a diffusive regularization. A common model adds a constant scalar artificial viscosity coefficient $\\mu_a$ to the system, yielding a modified balance\n$$\n\\partial_t U + \\partial_x F(U) = \\partial_x\\left(\\mu_a \\partial_x U\\right).\n$$\n\nTo calibrate $\\mu_a$, we consider a steady traveling wave representing the shock profile in a shock-attached frame. Let the shock move at speed $s$ and introduce the coordinate $\\xi = x - s t$. For a steady profile $U(\\xi)$, the temporal derivative vanishes in the moving frame, and the leading-order balance of convection against diffusion for a characteristic mode becomes\n$$\n- \\lambda \\,\\frac{d U}{d \\xi} + \\mu_a \\,\\frac{d^2 U}{d \\xi^2} \\approx 0,\n$$\nwhere $\\lambda$ is a characteristic speed that scales the convective transport of the mode. This ordinary differential equation is linear and has exponential solutions of the form $U(\\xi) \\sim \\exp\\left(\\frac{\\lambda}{\\mu_a}\\xi\\right)$, implying that the characteristic length scale of the shock transition is\n$$\n\\delta \\sim \\frac{\\mu_a}{\\lambda}.\n$$\nThis scale arises by balancing the magnitude of the convective term, $|\\lambda \\, dU/d\\xi|$, and the diffusive term, $|\\mu_a \\, d^2U/d\\xi^2|$, which yields the exponential decay length $\\delta$.\n\nFor the one-dimensional Euler equations, the physically relevant convective scale is governed by the largest characteristic speed of the flux Jacobian $A(U) = \\partial F / \\partial U$, which for an ideal gas has eigenvalues $u - c$, $u$, and $u + c$. A robust estimate of the spectral radius in the presence of a discontinuity is obtained using Roe-averaged states. Define the Roe-averaged velocity $\\tilde{u}$ and total enthalpy $\\tilde{h}$ as\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}},\n\\quad\nh = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho} + \\frac{1}{2} u^2,\n\\quad\n\\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\nThe Roe-averaged sound speed $\\tilde{a}$ is then\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\nThe largest characteristic speed associated with the Roe linearization is\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\nThis choice is physically consistent because it is the spectral radius of the Roe-averaged Jacobian and bounds the propagation speed of compressive waves across the interface.\n\nEquating the target shock thickness $\\delta$ to the viscous length scale yields\n$$\n\\delta = \\frac{\\mu_a}{\\lambda_{\\max}}.\n$$\nIf the target shock thickness is prescribed as $N$ computational cells, then\n$$\n\\delta = N \\Delta x,\n$$\nand the required artificial viscosity coefficient is\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\nThis relation is dimensionally consistent: $\\lambda_{\\max}$ has units of $\\mathrm{m/s}$, $\\Delta x$ has units of $\\mathrm{m}$, so $\\mu_a$ has units of $\\mathrm{m^2/s}$.\n\nAlgorithmic steps to compute $\\mu_a$ for each test case:\n1. Given $(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$, compute the left and right total enthalpies\n$$\nh_L = \\frac{\\gamma}{\\gamma - 1} \\frac{p_L}{\\rho_L} + \\frac{1}{2} u_L^2, \\quad h_R = \\frac{\\gamma}{\\gamma - 1} \\frac{p_R}{\\rho_R} + \\frac{1}{2} u_R^2.\n$$\n2. Compute the Roe-averaged velocity and enthalpy\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}, \\quad \\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\n3. Compute the Roe-averaged sound speed\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\n4. Compute the largest characteristic speed\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\n5. Compute the required artificial viscosity coefficient\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\n6. Round the result to six decimal places and express it in $\\mathrm{m^2/s}$.\n\nThe provided test suite explores:\n- A general case representative of the Sod shock tube with standard left and right states (Case $1$).\n- Sensitivity to grid refinement by halving $\\Delta x$ (Case $2$) and an extreme fine grid (Case $3$).\n- Influence of nonzero inflow velocity (Case $4$).\n- Effect of increased right pressure, altering the acoustic speeds (Case $5$).\n\nYour program should produce a single line with the list $[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$, each rounded to six decimals in $\\mathrm{m^2/s}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR):\n    # Compute total enthalpies\n    hL = (gamma / (gamma - 1.0)) * (pL / rhoL) + 0.5 * uL**2\n    hR = (gamma / (gamma - 1.0)) * (pR / rhoR) + 0.5 * uR**2\n\n    sqrL = np.sqrt(rhoL)\n    sqrR = np.sqrt(rhoR)\n    denom = sqrL + sqrR\n\n    u_tilde = (sqrL * uL + sqrR * uR) / denom\n    h_tilde = (sqrL * hL + sqrR * hR) / denom\n\n    a_tilde = np.sqrt((gamma - 1.0) * (h_tilde - 0.5 * u_tilde**2))\n\n    # Largest characteristic speed\n    lambda_max = abs(u_tilde) + a_tilde\n    return lambda_max\n\ndef required_mu(lambda_max, dx, Ncells):\n    # mu_a = lambda_max * Ncells * dx\n    return lambda_max * Ncells * dx\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells)\n    test_cases = [\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 5.0e-4, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-6, 3),\n        (1.4, 1.0, 50.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 2.0e4, 1.0e-3, 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells = case\n        lambda_max = roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR)\n        mu_a = required_mu(lambda_max, dx, Ncells)\n        # Round to six decimal places\n        mu_a_rounded = float(f\"{mu_a:.6f}\")\n        results.append(mu_a_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}