{
    "hands_on_practices": [
        {
            "introduction": "理解数值通量的基本特性是构建任何有限体积法的基石。修正方程分析是一种强大的理论工具，它通过泰勒展开揭示了离散格式中隐含的数值误差项。本练习将通过对线性平流方程应用中心通量和迎风通量，并推导其修正方程，来帮助您直观地理解数值耗散与色散的来源及其对计算结果的影响 。",
            "id": "3981805",
            "problem": "考虑一维空间中的线性标量平流方程，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n其中平流速度 $a0$ 为常数，方程定义在周期性域上，并在均匀网格上离散化，网格中心为 $x_i$，间距为 $\\Delta x$。使用守恒型有限体积格式，用 $U_{i}(t)$ 表示网格单元 $i$ 中的单元平均值。半离散的线方法形式为\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},\n$$\n其中界面 $i+\\tfrac{1}{2}$ 处的数值通量取为 $F_{i+\\frac{1}{2}} = a\\,u^{\\ast}_{i+\\frac{1}{2}}$，在界面处采用以下两种重构方式之一：\n- 中心（对称）通量：$u^{\\ast}_{i+\\frac{1}{2}} = \\tfrac{1}{2}\\big(U_{i}+U_{i+1}\\big)$，\n- 适用于 $a0$ 的迎风通量：$u^{\\ast}_{i+\\frac{1}{2}} = U_{i}$。\n\n假设解是光滑的，因此 $U_{i}(t)$ 一致地逼近 $u(x_{i},t)$，并允许在 $x_i$ 附近进行泰勒展开。从守恒的第一性原理和光滑函数的泰勒展开出发，对每种数值通量进行修正方程分析，在残差中保留截至并包括 $\\mathcal{O}(\\Delta x^{3})$ 的项，从而使半离散格式可以用一个离散解近似满足的连续偏微分方程来表示。然后，通过判断是否存在与 $u_{xx}$ 成正比的项，并若存在，确定其系数，来比较两种通量的领头阶数值耗散。\n\n最后，将迎风通量修正方程中 $u_{xx}$ 的系数报告为一个关于 $a$ 和 $\\Delta x$ 的单一闭式表达式。此表达式是您必须提供的最终答案。最终答案中不要包含单位。",
            "solution": "我们从线性平流方程的守恒型有限体积半离散格式开始，\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},\\qquad F_{i+\\frac{1}{2}} \\;=\\; a\\,u^{\\ast}_{i+\\frac{1}{2}}.\n$$\n在光滑性假设下，$U_{i}(t)$ 在忽略高阶项的情况下等同于 $u(x_{i},t)$，并且可以对 $u(x_{i\\pm 1},t)$ 在 $x_{i}$ 处进行泰勒展开：\n$$\nu(x_{i\\pm 1},t) \\;=\\; u \\,\\pm\\, \\Delta x\\,u_{x} \\,+\\, \\frac{\\Delta x^{2}}{2}\\,u_{xx} \\,\\pm\\, \\frac{\\Delta x^{3}}{6}\\,u_{xxx} \\,+\\, \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} \\,\\pm\\, \\frac{\\Delta x^{5}}{120}\\,u_{xxxxx} \\,+\\, \\mathcal{O}(\\Delta x^{6}),\n$$\n为简洁起见，所有导数均在 $(x_{i},t)$ 处求值。\n\n中心（对称）通量。当 $u^{\\ast}_{i+\\frac{1}{2}} = \\tfrac{1}{2}(U_{i}+U_{i+1})$ 且 $u^{\\ast}_{i-\\frac{1}{2}} = \\tfrac{1}{2}(U_{i-1}+U_{i})$ 时，通量差变为\n$$\nF_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\;=\\; a\\,\\frac{U_{i+1} - U_{i-1}}{2}.\n$$\n因此半离散格式为\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,\\frac{a}{2\\Delta x}\\,\\big(U_{i+1}-U_{i-1}\\big).\n$$\n用 $u(x_{i\\pm 1},t)$ 的泰勒级数替换 $U_{i\\pm 1}$，\n$$\nU_{i+1} - U_{i-1} \\;=\\; \\big(u + \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} + \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + \\frac{\\Delta x^{5}}{120}\\,u_{xxxxx} + \\cdots\\big) \\,-\\, \\big(u - \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} - \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} - \\frac{\\Delta x^{5}}{120}\\,u_{xxxxx} + \\cdots\\big),\n$$\n简化后得到\n$$\nU_{i+1}-U_{i-1} \\;=\\; 2\\,\\Delta x\\,u_{x} \\;+\\; \\frac{\\Delta x^{3}}{3}\\,u_{xxx} \\;+\\; \\frac{\\Delta x^{5}}{60}\\,u_{xxxxx} \\;+\\; \\mathcal{O}(\\Delta x^{7}).\n$$\n因此，\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,a\\left[u_{x} \\;+\\; \\frac{\\Delta x^{2}}{6}\\,u_{xxx} \\;+\\; \\frac{\\Delta x^{4}}{120}\\,u_{xxxxx} \\;+\\; \\mathcal{O}(\\Delta x^{6})\\right].\n$$\n将 $U_{i}(t)$ 解释为 $u(x_{i},t)$，中心通量半离散解满足的修正方程为\n$$\nu_{t} \\;+\\; a\\,u_{x} \\;=\\; -\\,a\\,\\frac{\\Delta x^{2}}{6}\\,u_{xxx} \\;-\\; a\\,\\frac{\\Delta x^{4}}{120}\\,u_{xxxxx} \\;+\\; \\mathcal{O}(\\Delta x^{6}).\n$$\n领头修正项是与 $u_{xxx}$ 成正比的色散项；值得注意的是，没有 $u_{xx}$ 项，因此中心通量不引入领头阶数值耗散。\n\n适用于 $a0$ 的迎风通量。当 $u^{\\ast}_{i+\\frac{1}{2}} = U_{i}$ 且 $u^{\\ast}_{i-\\frac{1}{2}} = U_{i-1}$ 时，通量差变为\n$$\nF_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\;=\\; a\\,(U_{i} - U_{i-1}),\n$$\n因此\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,\\frac{a}{\\Delta x}\\,\\big(U_{i}-U_{i-1}\\big).\n$$\n使用 $U_{i-1} = u(x_{i-\\!1},t)$ 的泰勒展开，\n$$\nU_{i}-U_{i-1} \\;=\\; u \\,-\\, \\left(u - \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} - \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} - \\frac{\\Delta x^{5}}{120}\\,u_{xxxxx} + \\cdots\\right) \\;=\\; \\Delta x\\,u_{x} \\;-\\; \\frac{\\Delta x^{2}}{2}\\,u_{xx} \\;+\\; \\frac{\\Delta x^{3}}{6}\\,u_{xxx} \\;-\\; \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} \\;+\\; \\mathcal{O}(\\Delta x^{5}).\n$$\n于是，\n$$\n\\frac{\\mathrm{d}U_{i}}{\\mathrm{d}t} \\;=\\; -\\,a\\left[u_{x} \\;-\\; \\frac{\\Delta x}{2}\\,u_{xx} \\;+\\; \\frac{\\Delta x^{2}}{6}\\,u_{xxx} \\;-\\; \\frac{\\Delta x^{3}}{24}\\,u_{xxxx} \\;+\\; \\mathcal{O}(\\Delta x^{4})\\right].\n$$\n等价地，修正方程为\n$$\nu_{t} \\;+\\; a\\,u_{x} \\;=\\; a\\,\\frac{\\Delta x}{2}\\,u_{xx} \\;-\\; a\\,\\frac{\\Delta x^{2}}{6}\\,u_{xxx} \\;+\\; a\\,\\frac{\\Delta x^{3}}{24}\\,u_{xxxx} \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n此处的领头修正项是一个与 $u_{xx}$ 成正比的扩散项，其系数为正，这代表了数值耗散。\n\n数值耗散的比较。中心通量的修正方程在领头阶没有 $u_{xx}$ 项，因此不引入领头阶数值耗散；相反，它通过 $u_{xxx}$ 项表现出色散性。迎风通量表现出一个领头阶人工扩散项 $a\\,\\tfrac{\\Delta x}{2}\\,u_{xx}$，因此其数值耗散系数（修正方程中 $u_{xx}$ 的乘积系数）为\n$$\n\\nu_{\\mathrm{num}} \\;=\\; \\frac{a\\,\\Delta x}{2}.\n$$\n\n所要求的最终答案正是这个用 $a$ 和 $\\Delta x$ 表示的系数。",
            "answer": "$$\\boxed{\\frac{a\\,\\Delta x}{2}}$$"
        },
        {
            "introduction": "在处理非线性守恒律（如欧拉方程）时，会涌现出激波和稀疏波等复杂现象，这对数值通量的构造提出了更高的要求。Godunov 通量通过求解界面处的局部黎曼问题得到，它为构建物理上一致的数值格式提供了理论基准。通过解决经典的伯格斯方程 (Burgers' equation) 的黎曼问题，本练习将带您深入探索激波和稀疏波解的结构，并理解熵条件在保证解的物理正确性方面所起的关键作用 。",
            "id": "3981755",
            "problem": "在计算流体动力学 (CFD) 的一维无粘性可压缩流建模中，Godunov 有限体积法在单元界面上所基于的标量守恒律被特化为无粘性 Burgers 方程，\n$$\nu_{t} + \\left(\\tfrac{1}{2} u^{2}\\right)_{x} = 0,\n$$\n其通量函数为 $f(u) = \\tfrac{1}{2} u^{2}$。单元界面上的 Godunov 数值通量是通过求解在界面处具有左右状态 $u_{L}$ 和 $u_{R}$ 的黎曼问题，并计算在 $t0$ 时到达界面 $x=0$ 的状态下的物理通量来获得的。仅从守恒律、Rankine–Hugoniot 跳跃条件以及用于具有凸通量的标量守恒的特征线法出发，确定界面状态并计算得到的 Godunov 通量。然后，使用用于激波的 Lax 熵条件和用于凸通量的稀疏扇的可容许性来验证熵相容性。\n\n将此方案应用于以下四个黎曼数据集，其中包括激波和稀疏波两种情况：\n$$\n\\text{Case A: } (u_{L},u_{R}) = (\\,3,\\,1\\,), \\quad\n\\text{Case B: } (u_{L},u_{R}) = (\\,-1,\\,-3\\,), \\quad\n\\text{Case C: } (u_{L},u_{R}) = (\\,-2,\\,1\\,), \\quad\n\\text{Case D: } (u_{L},u_{R}) = \\left(\\,\\tfrac{1}{2},\\,\\tfrac{3}{2}\\,\\right).\n$$\n对于每种情况，确定在 $x=0, t0$ 处的精确黎曼解结构，识别撞击界面的状态，并计算相应的 Godunov 通量 $f_{G} = f\\!\\left(u(0,t)\\right)$。在每种情况下，通过检查激波的 Lax 条件和稀疏扇的可容許性来验证熵相容性。最后，定义\n$$\nF_{\\text{total}} \\equiv f_{G}^{\\text{(A)}} + f_{G}^{\\text{(B)}} + f_{G}^{\\text{(C)}} + f_{G}^{\\text{(D)}},\n$$\n并将 $F_{\\text{total}}$ 以精确有理数的形式报告。不需要单位。",
            "solution": "首先验证问题的有效性。给定的是无粘性 Burgers 方程 $u_{t} + \\left(\\tfrac{1}{2} u^{2}\\right)_{x} = 0$，其通量函数为 $f(u) = \\tfrac{1}{2} u^{2}$，四组黎曼初始数据 $(u_{L}, u_{R})$，以及 Godunov 通量的定义 $f_{G} = f(u(0,t))$。该问题在科学上基于双曲守恒律理论，是适定的、客观的，并包含了获得唯一解所需的所有必要信息。因此，该问题是有效的。\n\nBurgers 方程的黎曼问题的解是通过分析特征速度并应用适用于激波和稀疏波的相应条件来构造的。特征速度由通量函数的导数给出，$a(u) = f'(u) = u$。由于二阶导数 $f''(u) = 1  0$，通量函数是严格凸的。这个性质决定了解的结构。\n\n黎曼问题的解 $u(x,t)$ 是变量 $\\xi = x/t$ 的自相似函数。Godunov 通量由该解在单元界面处（即 $\\xi=0$ 处）的值确定。我们将这个状态记为 $u(0,t) = u^{*}$。于是 Godunov 通量为 $f_{G} = f(u^{*})$。\n\n解的结构主要有两种情况，取决于初始数据 $(u_{L}, u_{R})$。\n\n1.  如果 $u_{L}  u_{R}$，特征线会相交，并且必须形成一个间断解（激波）。该激波的速度 $s$ 由 Rankine–Hugoniot 跳跃条件给出：\n    $$\n    s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\tfrac{1}{2}u_{R}^{2} - \\tfrac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2}(u_{L} + u_{R}).\n    $$\n    对于一个物理上相关的、满足熵条件的激波，Lax 熵条件必须成立：$f'(u_L)  s  f'(u_R)$。对于 Burgers 方程，这简化为 $u_L  s  u_R$。解则为当 $x/t  s$ 时 $u(x,t) = u_{L}$，当 $x/t  s$ 时 $u(x,t) = u_{R}$。在界面 $x=0$ 处的状态 $u(0,t)$ 是：如果 $s0$ (激波向右移动)，则为 $u_{L}$；如果 $s0$ (激波向左移动)，则为 $u_{R}$。\n\n2.  如果 $u_{L}  u_{R}$，特征线发散，形成一个称为稀疏扇的连续解。对于凸通量，此解是可容许的。解由下式给出：\n    $$\n    u(x,t) =\n    \\begin{cases}\n    u_{L},  \\text{if } x/t \\le u_{L} \\\\\n    x/t,  \\text{if } u_{L}  x/t  u_{R} \\\\\n    u_{R},  \\text{if } x/t \\ge u_{R}\n    \\end{cases}\n    $$\n    界面处的状态 $u(0,t)$ 取决于区间 $[u_{L}, u_{R}]$ 相对于 0 的位置。如果 $u_{L} > 0$，则 $u(0,t) = u_{L}$。如果 $u_{R}  0$，则 $u(0,t) = u_{R}$。如果 $u_{L} \\le 0 \\le u_{R}$，则 $u(0,t) = 0$。\n\n我们现在将此框架应用于四种情况中的每一种。\n\n**情况 A: $(u_{L}, u_{R}) = (3, 1)$**\n这里，$u_{L} = 3$ 且 $u_{R} = 1$。由于 $u_{L}  u_{R}$，解为激波。\n激波速度为 $s = \\frac{1}{2}(3 + 1) = 2$。\n为验证熵条件，我们检查是否有 $u_{L}  s  u_{R}$：$3  2  1$。条件满足。\n激波向右移动 ($s=2  0$)。对于任何 $t0$，界面 $x=0$ 位于激波位置 $x=st$ 的左侧。因此，界面处的状态是左状态。\n$u(0,t) = u_{L} = 3$。\nGodunov 通量为 $f_{G}^{\\text{(A)}} = f(3) = \\frac{1}{2}(3)^{2} = \\frac{9}{2}$。\n\n**情况 B: $(u_{L}, u_{R}) = (-1, -3)$**\n这里，$u_{L} = -1$ 且 $u_{R} = -3$。由于 $u_{L}  u_{R}$，解为激波。\n激波速度为 $s = \\frac{1}{2}(-1 + (-3)) = -2$。\n为验证熵条件，我们检查是否有 $u_{L}  s  u_{R}$：$-1  -2  -3$。条件满足。\n激波向左移动 ($s=-2  0$)。对于任何 $t0$，界面 $x=0$ 位于激波位置 $x=st$ 的右侧。因此，界面处的状态是右状态。\n$u(0,t) = u_{R} = -3$。\nGodunov 通量为 $f_{G}^{\\text{(B)}} = f(-3) = \\frac{1}{2}(-3)^{2} = \\frac{9}{2}$。\n\n**情况 C: $(u_{L}, u_{R}) = (-2, 1)$**\n这里，$u_{L} = -2$ 且 $u_{R} = 1$。由于 $u_{L}  u_{R}$，解为稀疏波。由于通量是凸的，这是一个可容许解。\n界定稀疏扇的特征速度为 $u_{L} = -2$ 和 $u_{R} = 1$。\n对于 $-2  x/t  1$，解由 $u(x,t) = x/t$ 给出。\n界面 $x=0$ 对应于 $x/t = 0$，因为 $-2  0  1$，该值位于稀疏扇内部。\n因此，界面处的状态为 $u(0,t) = 0$。\nGodunov 通量为 $f_{G}^{\\text{(C)}} = f(0) = \\frac{1}{2}(0)^{2} = 0$。\n\n**情况 D: $(u_{L}, u_{R}) = (\\frac{1}{2}, \\frac{3}{2})$**\n这里，$u_{L} = \\frac{1}{2}$ 且 $u_{R} = \\frac{3}{2}$。由于 $u_{L}  u_{R}$，解为稀疏波。由于通量是凸的，这是一个可容许解。\n界定稀疏扇的特征速度为 $u_{L} = \\frac{1}{2}$ 和 $u_{R} = \\frac{3}{2}$。\n界面 $x=0$ 对应于 $x/t = 0$。该值小于稀疏扇中最慢的特征速度，因为 $0  u_{L} = \\frac{1}{2}$。这意味着整个稀疏扇向右移动，并且对于 $t  0$ 总是位于界面的下游。因此，界面处的状态是左状态。\n$u(0,t) = u_{L} = \\frac{1}{2}$。\nGodunov 通量为 $f_{G}^{\\text{(D)}} = f(\\frac{1}{2}) = \\frac{1}{2}(\\frac{1}{2})^{2} = \\frac{1}{2} \\cdot \\frac{1}{4} = \\frac{1}{8}$。\n\n最后，我们通过将各个 Godunov 通量相加来计算总通量 $F_{\\text{total}}$。\n$$\nF_{\\text{total}} = f_{G}^{\\text{(A)}} + f_{G}^{\\text{(B)}} + f_{G}^{\\text{(C)}} + f_{G}^{\\text{(D)}}\n$$\n$$\nF_{\\text{total}} = \\frac{9}{2} + \\frac{9}{2} + 0 + \\frac{1}{8}\n$$\n$$\nF_{\\text{total}} = 9 + \\frac{1}{8} = \\frac{72}{8} + \\frac{1}{8} = \\frac{73}{8}.\n$$\n该值要求为精确有理数。",
            "answer": "$$\n\\boxed{\\frac{73}{8}}\n$$"
        },
        {
            "introduction": "在 Godunov 通量的理论基础上，现代计算流体力学（CFD）求解器广泛采用高分辨率格式，以在保证计算效率的同时精确捕捉流动特征。本练习将引导您完整地实践一个现代 MUSCL (Monotone Upstream-centered Schemes for Conservation Laws) 格式的计算流程，该流程集成了分段线性数据重构、用于抑制数值振荡的 TVD (Total Variation Diminishing) 限制器以及高效的近似黎曼求解器（Rusanov 格式）。通过这个具体的计算实例，您将亲身体验这些关键部件如何协同工作，从而使格式能够在光滑区达到高精度，并在间断处保持稳定和无振荡的特性 。",
            "id": "3981825",
            "problem": "考虑计算流体动力学 (CFD) 中使用的均匀一维网格上的标量守恒律 $u_{t} + f(u)_{x} = 0$。在有限体积法中，对单元平均值 $U_{i}(t)$ 的半离散更新涉及到在单元面上计算的数值通量 $\\hat{F}_{i+\\frac{1}{2}}$。为了构造一个总变差递减 (TVD) 的二阶格式，我们在每个单元 $i$ 中采用带有受限斜率 $s_{i}$ 的分段线性 MUSCL (Monotone Upstream-centered Schemes for Conservation Laws) 重构，并从近似黎曼求解器中获取数值通量。\n\n假设以下经过充分检验的要素作为您的基础：\n1. 单元 $i$ 内部的 MUSCL 线性重构为 $U_{i}(x) = U_{i} + s_{i}\\,(x - x_{i})$，其中 $x_{i}$ 是单元中心，$s_{i}$ 是一个受限斜率，由单边差分 $\\,\\delta^{-}_{i} = (U_{i} - U_{i-1})/\\Delta x\\,$ 和 $\\,\\delta^{+}_{i} = (U_{i+1} - U_{i})/\\Delta x$ 计算得出。\n2. 使用由下式定义的 Monotonized Central (MC) 限制器\n$$\ns_{i} = \\operatorname{minmod}\\!\\left(2\\,\\delta^{-}_{i}, \\ \\frac{\\delta^{-}_{i} + \\delta^{+}_{i}}{2}, \\ 2\\,\\delta^{+}_{i}\\right),\n$$\n其中 minmod 函数为\n$$\n\\operatorname{minmod}(z_{1},z_{2},\\dots) = \n\\begin{cases}\n\\operatorname{sign}(z_{1}) \\,\\min\\left(|z_{1}|,|z_{2}|,\\dots\\right),  \\text{如果所有 } z_{k} \\text{ 符号相同} \\\\\n0,  \\text{否则}\n\\end{cases}\n$$\n3. 通过以下公式在 $x_{i+\\frac{1}{2}}$ 处重构左右界面状态\n$$\nU_{i+\\frac{1}{2}}^{-} = U_{i} + \\frac{\\Delta x}{2}\\,s_{i}, \n\\qquad\nU_{i+\\frac{1}{2}}^{+} = U_{i+1} - \\frac{\\Delta x}{2}\\,s_{i+1}.\n$$\n4. 对于非线性通量 $f(u) = \\tfrac{1}{2}u^{2}$，采用 Rusanov (局部 Lax–Friedrichs) 数值通量\n$$\n\\hat{F}(U_{L},U_{R}) = \\frac{1}{2}\\big(f(U_{L}) + f(U_{R})\\big) - \\frac{1}{2}\\,a\\,\\big(U_{R} - U_{L}\\big),\n$$\n其中局部波速为 $a = \\max\\big(|f'(U_{L})|,\\,|f'(U_{R})|\\big)$ 且 $f'(u)=u$。\n\n给定一个间距为 $\\Delta x = 0.2$ 的均匀网格以及单元平均值\n$$\nU_{i-1} = 1.8,\\quad U_{i} = 1.2,\\quad U_{i+1} = 0.4,\\quad U_{i+2} = 0.6.\n$$\n\n任务：\n1. 使用 MC 限制器计算受限斜率 $s_{i}$ 和 $s_{i+1}$。\n2. 使用这些斜率，在界面 $x_{i+\\frac{1}{2}}$ 处重构左右状态 $U_{i+\\frac{1}{2}}^{-}$ 和 $U_{i+\\frac{1}{2}}^{+}$。\n3. 对于 $f(u)=\\tfrac{1}{2}u^{2}$，使用 Rusanov 通量计算数值通量 $\\hat{F}_{i+\\frac{1}{2}} = \\hat{F}\\!\\left(U_{i+\\frac{1}{2}}^{-}, U_{i+\\frac{1}{2}}^{+}\\right)$。\n\n将 $\\hat{F}_{i+\\frac{1}{2}}$ 的最终值以单个实数的形式给出，四舍五入到 4 位有效数字。无需单位。",
            "solution": "该问题要求使用基于 MUSCL 重构、MC 限制器和 Rusanov 近似黎曼求解器的二阶 TVD 格式，在单元面 $x_{i+\\frac{1}{2}}$ 处计算数值通量 $\\hat{F}_{i+\\frac{1}{2}}$。计算过程如问题陈述中所概述，分为三个不同的步骤。\n\n给定数据为单元平均值 $U_{i-1} = 1.8$, $U_{i} = 1.2$, $U_{i+1} = 0.4$ 和 $U_{i+2} = 0.6$，位于单元宽度为 $\\Delta x = 0.2$ 的均匀网格上。非线性通量函数为 $f(u) = \\frac{1}{2}u^{2}$。\n\n**第1步：计算受限斜率 $s_{i}$ 和 $s_{i+1}$**\n\n首先，我们计算单元 $i$ 中的受限斜率 $s_{i}$。这需要单边差分 $\\delta^{-}_{i}$ 和 $\\delta^{+}_{i}$。\n$$\n\\delta^{-}_{i} = \\frac{U_{i} - U_{i-1}}{\\Delta x} = \\frac{1.2 - 1.8}{0.2} = \\frac{-0.6}{0.2} = -3.0\n$$\n$$\n\\delta^{+}_{i} = \\frac{U_{i+1} - U_{i}}{\\Delta x} = \\frac{0.4 - 1.2}{0.2} = \\frac{-0.8}{0.2} = -4.0\n$$\nMC 限制器定义为 $s_{i} = \\operatorname{minmod}(2\\,\\delta^{-}_{i}, (\\delta^{-}_{i} + \\delta^{+}_{i})/2, 2\\,\\delta^{+}_{i})$。我们计算 minmod 函数的参数：\n$$\n2\\,\\delta^{-}_{i} = 2 \\times (-3.0) = -6.0\n$$\n$$\n\\frac{\\delta^{-}_{i} + \\delta^{+}_{i}}{2} = \\frac{-3.0 + (-4.0)}{2} = \\frac{-7.0}{2} = -3.5\n$$\n$$\n2\\,\\delta^{+}_{i} = 2 \\times (-4.0) = -8.0\n$$\n所有三个参数（$-6.0$, $-3.5$, $-8.0$）的符号相同（均为负）。因此，minmod 函数返回具有最小绝对值的值，并冠以共同的符号。\n$$\ns_{i} = \\operatorname{minmod}(-6.0, -3.5, -8.0) = \\operatorname{sign}(-3.5) \\min(|-6.0|, |-3.5|, |-8.0|) = - \\min(6.0, 3.5, 8.0) = -3.5\n$$\n接下来，我们计算单元 $i+1$ 中的受限斜率 $s_{i+1}$。这需要单边差分 $\\delta^{-}_{i+1}$ 和 $\\delta^{+}_{i+1}$。\n$$\n\\delta^{-}_{i+1} = \\frac{U_{i+1} - U_{i}}{\\Delta x} = \\frac{0.4 - 1.2}{0.2} = \\frac{-0.8}{0.2} = -4.0\n$$\n$$\n\\delta^{+}_{i+1} = \\frac{U_{i+2} - U_{i+1}}{\\Delta x} = \\frac{0.6 - 0.4}{0.2} = \\frac{0.2}{0.2} = 1.0\n$$\n$s_{i+1}$ 的 MC 限制器的参数是：\n$$\n2\\,\\delta^{-}_{i+1} = 2 \\times (-4.0) = -8.0\n$$\n$$\n\\frac{\\delta^{-}_{i+1} + \\delta^{+}_{i+1}}{2} = \\frac{-4.0 + 1.0}{2} = \\frac{-3.0}{2} = -1.5\n$$\n$$\n2\\,\\delta^{+}_{i+1} = 2 \\times (1.0) = 2.0\n$$\n参数（$-8.0$, $-1.5$, $2.0$）的符号不完全相同。根据 minmod 函数的定义，结果为零。\n$$\ns_{i+1} = \\operatorname{minmod}(-8.0, -1.5, 2.0) = 0\n$$\n\n**第2步：重构界面状态 $U_{i+\\frac{1}{2}}^{-}$ 和 $U_{i+\\frac{1}{2}}^{+}$**\n\n使用受限斜率，我们在单元面 $x_{i+\\frac{1}{2}}$ 的左右两侧重构状态。\n左状态 $U_{i+\\frac{1}{2}}^{-}$ 由单元 $i$ 中的重构确定：\n$$\nU_{i+\\frac{1}{2}}^{-} = U_{i} + \\frac{\\Delta x}{2} s_{i} = 1.2 + \\frac{0.2}{2} (-3.5) = 1.2 + 0.1 \\times (-3.5) = 1.2 - 0.35 = 0.85\n$$\n右状态 $U_{i+\\frac{1}{2}}^{+}$ 由单元 $i+1$ 中的重构确定：\n$$\nU_{i+\\frac{1}{2}}^{+} = U_{i+1} - \\frac{\\Delta x}{2} s_{i+1} = 0.4 - \\frac{0.2}{2} (0) = 0.4 - 0 = 0.4\n$$\n因此，界面处黎曼问题的左右状态为 $U_L = 0.85$ 和 $U_R = 0.4$。\n\n**第3步：计算 Rusanov 数值通量 $\\hat{F}_{i+\\frac{1}{2}}$**\n\nRusanov 通量由以下公式给出：\n$$\n\\hat{F}(U_{L}, U_{R}) = \\frac{1}{2} \\left[ f(U_{L}) + f(U_{R}) \\right] - \\frac{1}{2} a \\left( U_{R} - U_{L} \\right)\n$$\n其中 $a = \\max(|f'(U_{L})|, |f'(U_{R})|)$。对于通量函数 $f(u) = \\frac{1}{2}u^{2}$，其导数为 $f'(u) = u$。\n\n首先，我们计算在左右状态处的通量函数值：\n$$\nf(U_L) = f(0.85) = \\frac{1}{2} (0.85)^{2} = \\frac{1}{2} (0.7225) = 0.36125\n$$\n$$\nf(U_R) = f(0.4) = \\frac{1}{2} (0.4)^{2} = \\frac{1}{2} (0.16) = 0.08\n$$\n接下来，我们计算局部波速 $a$：\n$$\na = \\max(|f'(U_L)|, |f'(U_R)|) = \\max(|U_L|, |U_R|) = \\max(|0.85|, |0.4|) = 0.85\n$$\n现在我们将这些值代入 Rusanov 通量公式：\n$$\n\\hat{F}_{i+\\frac{1}{2}} = \\frac{1}{2} \\left( 0.36125 + 0.08 \\right) - \\frac{1}{2} (0.85) \\left( 0.4 - 0.85 \\right)\n$$\n$$\n\\hat{F}_{i+\\frac{1}{2}} = \\frac{1}{2} (0.44125) - \\frac{1}{2} (0.85) (-0.45)\n$$\n$$\n\\hat{F}_{i+\\frac{1}{2}} = 0.220625 - (-0.19125)\n$$\n$$\n\\hat{F}_{i+\\frac{1}{2}} = 0.220625 + 0.19125 = 0.411875\n$$\n题目要求最终答案四舍五入到 4 位有效数字。\n$$\n\\hat{F}_{i+\\frac{1}{2}} \\approx 0.4119\n$$",
            "answer": "$$\n\\boxed{0.4119}\n$$"
        }
    ]
}