{
    "hands_on_practices": [
        {
            "introduction": "任何有限元分析的核心都是在离散的单元上逼近真实的解。这个过程依赖于使用形函数和节点值来构建一个插值多项式。这个基础练习将引导您在一个简单的线性三角形单元上，亲手构建一个函数的插值，并使用 $L^2$ 范数来精确量化插值误差，这是评估离散方案准确性的基本技能 。",
            "id": "3956616",
            "problem": "在一个使用有限元法（FEM）的二维计算流体动力学（CFD）离散化中，考虑一个线性三角形单元，其顶点物理坐标分别为 $\\mathbf{P}_{1}=(0,0)$、$\\mathbf{P}_{2}=(1,0)$ 和 $\\mathbf{P}_{3}=(0,1)$。在此三角形上，1次拉格朗日形函数被定义为在顶点处满足克罗内克（Kronecker）$\\delta$性质的唯一线性多项式。设标量场为多项式 $u(x,y)=x^{2}+xy$。使用该单元上的1次拉格朗日形函数，构建节点插值 $I_{h}u$，并计算插值误差 $e=u-I_{h}u$。然后，计算该单元上误差的$L^{2}$范数，其定义为\n$$\n\\|e\\|_{L^{2}(T)}=\\left(\\int_{T} e(x,y)^{2}\\,\\mathrm{d}A\\right)^{\\frac{1}{2}},\n$$\n其中 $T$ 表示该三角形单元。将最终答案表示为精确值，不进行四舍五入，且不带单位。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个来自数值分析领域（特别是有限元法）的适定的、具有科学依据的问题，而有限元法是许多现代计算流体动力学（CFD）代码的核心组成部分。所有必要信息均已提供，问题没有矛盾或含糊之处。\n\n该问题要求计算给定标量场在线性三角形单元上的插值误差的$L^2$范数。求解过程包括四个主要步骤：\n1.  推导给定单元的1次拉格朗日形函数。\n2.  构建标量场 $u(x,y)$ 的节点插值 $I_h u$。\n3.  确定插值误差函数 $e(x,y)$。\n4.  通过在单元面积上积分，计算误差函数的$L^2$范数。\n\n三角形单元（记作 $T$）在笛卡尔坐标系 $(x,y)$ 中由三个顶点 $\\mathbf{P}_{1}=(0,0)$、$\\mathbf{P}_{2}=(1,0)$ 和 $\\mathbf{P}_{3}=(0,1)$ 定义。\n\n首先，我们确定1次拉格朗日形函数 $N_1(x,y)$、$N_2(x,y)$ 和 $N_3(x,y)$。它们是形如 $N_i(x,y) = a_i + b_i x + c_i y$ 的线性多项式，必须在节点处满足克罗内克$\\delta$性质，即 $N_i(\\mathbf{P}_j) = \\delta_{ij}$，其中当 $i=j$ 时 $\\delta_{ij}$ 为 $1$，当 $i \\neq j$ 时为 $0$。\n\n对于形函数 $N_1(x,y)$：\n$N_1(\\mathbf{P}_1) = N_1(0,0) = a_1 = 1$\n$N_1(\\mathbf{P}_2) = N_1(1,0) = a_1 + b_1 = 0 \\implies b_1 = -1$\n$N_1(\\mathbf{P}_3) = N_1(0,1) = a_1 + c_1 = 0 \\implies c_1 = -1$\n因此，$N_1(x,y) = 1 - x - y$。\n\n对于形函数 $N_2(x,y)$：\n$N_2(\\mathbf{P}_1) = N_2(0,0) = a_2 = 0$\n$N_2(\\mathbf{P}_2) = N_2(1,0) = a_2 + b_2 = 1 \\implies b_2 = 1$\n$N_2(\\mathbf{P}_3) = N_2(0,1) = a_2 + c_2 = 0 \\implies c_2 = 0$\n因此，$N_2(x,y) = x$。\n\n对于形函数 $N_3(x,y)$：\n$N_3(\\mathbf{P}_1) = N_3(0,0) = a_3 = 0$\n$N_3(\\mathbf{P}_2) = N_3(1,0) = a_3 + b_3 = 0 \\implies b_3 = 0$\n$N_3(\\mathbf{P}_3) = N_3(0,1) = a_3 + c_3 = 1 \\implies c_3 = 1$\n因此，$N_3(x,y) = y$。\n\n接下来，我们构建标量场 $u(x,y)=x^2+xy$ 的节点插值 $I_h u$。插值函数定义为：\n$$I_h u(x,y) = \\sum_{i=1}^{3} u(\\mathbf{P}_i) N_i(x,y)$$\n我们在顶点处计算 $u(x,y)$ 的值：\n$u_1 = u(\\mathbf{P}_1) = u(0,0) = 0^2 + (0)(0) = 0$\n$u_2 = u(\\mathbf{P}_2) = u(1,0) = 1^2 + (1)(0) = 1$\n$u_3 = u(\\mathbf{P}_3) = u(0,1) = 0^2 + (0)(1) = 0$\n\n将这些节点值代入插值公式：\n$I_h u(x,y) = u_1 N_1(x,y) + u_2 N_2(x,y) + u_3 N_3(x,y) = (0)N_1(x,y) + (1)N_2(x,y) + (0)N_3(x,y) = N_2(x,y) = x$。\n\n插值误差 $e(x,y)$ 是原始函数与其插值函数之差：\n$e(x,y) = u(x,y) - I_h u(x,y) = (x^2 + xy) - x = x^2 + xy - x$。\n\n最后，我们计算误差的$L^2$范数 $\\|e\\|_{L^2(T)}$，这需要将误差函数的平方在三角形域 $T$ 上进行积分。\n$$\\|e\\|_{L^2(T)}^2 = \\int_T e(x,y)^2 \\, \\mathrm{d}A = \\int_T (x^2 + xy - x)^2 \\, \\mathrm{d}A$$\n域 $T$ 由不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 描述。我们可以将二重积分写为：\n$$\\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\int_{0}^{1-x} (x^2 + xy - x)^2 \\, \\mathrm{d}y \\, \\mathrm{d}x$$\n被积函数可以简化为：$(x^2 + xy - x)^2 = (x(x+y-1))^2 = x^2(x+y-1)^2$。\n首先，我们对 $y$ 进行积分：\n$$ \\int_{0}^{1-x} x^2(x+y-1)^2 \\, \\mathrm{d}y $$\n令 $z = x+y-1$，则 $\\mathrm{d}z = \\mathrm{d}y$。$z$ 的积分限从 $x-1$（当 $y=0$ 时）到 $0$（当 $y=1-x$ 时）。\n$$ \\int_{x-1}^{0} x^2 z^2 \\, \\mathrm{d}z = x^2 \\left[ \\frac{z^3}{3} \\right]_{x-1}^{0} = x^2 \\left( 0 - \\frac{(x-1)^3}{3} \\right) = -\\frac{x^2(x-1)^3}{3} = \\frac{x^2(1-x)^3}{3} $$\n接下来，我们将此结果对 $x$ 从 $0$ 到 $1$ 进行积分：\n$$ \\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\frac{x^2(1-x)^3}{3} \\, \\mathrm{d}x = \\frac{1}{3} \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x $$\n该积分是贝塔（Beta）函数的一个实例，$B(m,n) = \\int_{0}^{1} t^{m-1}(1-t)^{n-1} \\, \\mathrm{d}t = \\frac{\\Gamma(m)\\Gamma(n)}{\\Gamma(m+n)}$。\n在我们的例子中，$m-1=2$ 且 $n-1=3$，所以 $m=3$ 且 $n=4$。\n$$ \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x = B(3,4) = \\frac{\\Gamma(3)\\Gamma(4)}{\\Gamma(3+4)} = \\frac{2! \\cdot 3!}{6!} = \\frac{2 \\cdot 6}{720} = \\frac{12}{720} = \\frac{1}{60} $$\n或者，我们可以展开多项式并逐项积分：\n$$ \\int_{0}^{1} x^2(1 - 3x + 3x^2 - x^3) \\, \\mathrm{d}x = \\int_{0}^{1} (x^2 - 3x^3 + 3x^4 - x^5) \\, \\mathrm{d}x $$\n$$ = \\left[ \\frac{x^3}{3} - \\frac{3x^4}{4} + \\frac{3x^5}{5} - \\frac{x^6}{6} \\right]_{0}^{1} = \\frac{1}{3} - \\frac{3}{4} + \\frac{3}{5} - \\frac{1}{6} $$\n分母的最小公倍数是 $60$：\n$$ = \\frac{20 - 45 + 36 - 10}{60} = \\frac{56 - 55}{60} = \\frac{1}{60} $$\n所以，我们得到：\n$$ \\|e\\|_{L^2(T)}^2 = \\frac{1}{3} \\cdot \\frac{1}{60} = \\frac{1}{180} $$\n$L^2$范数是该值的平方根：\n$$ \\|e\\|_{L^2(T)} = \\sqrt{\\frac{1}{180}} = \\frac{1}{\\sqrt{180}} = \\frac{1}{\\sqrt{36 \\cdot 5}} = \\frac{1}{6\\sqrt{5}} $$\n为使分母有理化，我们将分子和分母同乘以 $\\sqrt{5}$：\n$$ \\|e\\|_{L^2(T)} = \\frac{\\sqrt{5}}{6 \\cdot 5} = \\frac{\\sqrt{5}}{30} $$",
            "answer": "$$\\boxed{\\frac{\\sqrt{5}}{30}}$$"
        },
        {
            "introduction": "对于瞬态计算流体力学（CFD）问题，解的时间演化由一个包含质量矩阵的常微分方程组控制。质量矩阵源于将时间导数项投影到有限元基函数上，其结构（一致质量矩阵或集总质量矩阵）对计算效率和求解精度有深远影响。本练习将引导您推导“数学上精确”的一致质量矩阵和计算上高效的集总质量矩阵，从而揭示在显式时间积分方案中所面临的关键权衡 。",
            "id": "3956605",
            "problem": "在计算流体动力学（CFD）中标量守恒律的半离散Galerkin格式中，单个线性三角形有限元$K$（具有恒定密度$\\rho$和面积$A$）上的单元质量矩阵由基函数（形函数）的双线性形式定义。设$\\{N_{1},N_{2},N_{3}\\}$是与$K$的顶点相关联的标准线性形函数，在顶点$\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$处满足克罗内克$\\delta$性质$N_{i}(\\mathbf{x}_{j})=\\delta_{ij}$，并且满足单位分解$\\sum_{i=1}^{3}N_{i}=1$。一致单元质量矩阵定义为\n$$\nM_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A.\n$$\n任务：\n1) 从参考三角形上的形函数定义以及到$K$的仿射映射出发，推导$M_{ij}^{\\text{cons}}$的精确项（用$\\rho$和$A$表示）。\n2) 通过使用一个三点求积法则来近似积分，构造一个对角（集总）质量矩阵$M_{ij}^{\\text{lump}}$。该求积法则使用$K$的三个顶点作为求积点，并选择相等的权重，以使该法则对所有总次数至多为$1$的多项式都是精确的。利用此方法推导$M_{ij}^{\\text{lump}}$对角线项的解析表达式（用$\\rho$和$A$表示）。\n3) 简要讨论（无需进一步计算）在对流主导问题的显式时间积分中，采用对角集总质量矩阵与保持插值精度之间的权衡。\n\n仅报告$M_{ij}^{\\text{lump}}$的对角线项关于$\\rho$和$A$的解析表达式作为你的最终答案。不包括单位。如果引入任何附加符号，请清晰地定义它们。不需要进行数值四舍五入；提供一个精确表达式。",
            "solution": "首先验证该问题，以确保其具有科学依据、适定且客观。\n\n**第1步：提取已知条件**\n-   格式：计算流体动力学中标量守恒律的半离散Galerkin格式。\n-   单元：一个线性三角形有限元，$K$。\n-   参数：恒定密度$\\rho$，面积$A$。\n-   基函数：$\\{N_{1}, N_{2}, N_{3}\\}$，标准线性形函数。\n-   基函数性质：\n    1.  在顶点$\\{\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3}\\}$处的克罗内克$\\delta$性质：$N_{i}(\\mathbf{x}_{j})=\\delta_{ij}$。\n    2.  单位分解：$\\sum_{i=1}^{3}N_{i}=1$。\n-   一致单元质量矩阵定义：$M_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$。\n-   任务1：推导$M_{ij}^{\\text{cons}}$的项（用$\\rho$和$A$表示）。\n-   任务2：使用一个在顶点处具有相等权重的3点求积法则构造一个对角（集总）质量矩阵$M_{ij}^{\\text{lump}}$，该法则对总次数至多为1的多项式是精确的。推导$M_{ij}^{\\text{lump}}$对角线项的解析表达式。\n-   任务3：讨论使用集总质量矩阵与保持精度之间的权衡。\n-   最终答案：提供$M_{ij}^{\\text{lump}}$对角线项的解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n该问题是有限元方法（FEM）理论应用于计算流体动力学（CFD）的一个标准练习。\n-   **科学依据**：线性形函数、Galerkin方法、一致质量矩阵以及通过数值求积进行质量集总的定义都是有限元方法中基本且成熟的概念。该问题在科学和数学上是合理的。\n-   **适定性**：问题定义清晰。任务具体，并能得出一个唯一、可推导的结果。形函数的性质和求积法则的条件足以确定所需的矩阵。\n-   **客观性**：问题以数学和工程学中常见的精确、正式的语言陈述，没有主观或模糊的术语。\n\n**第3步：结论与行动**\n该问题有效。将提供完整的解法。\n\n**解题推导**\n\n**任务1：一致质量矩阵$M_{ij}^{\\text{cons}}$的推导**\n\n一致质量矩阵的项由$M_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$给出。由于密度$\\rho$是常数，可以将其从积分中提出：$M_{ij}^{\\text{cons}}=\\rho\\int_{K}N_{i}N_{j}\\,\\mathrm{d}A$。\n\n对于线性三角形单元，形函数$N_i$与重心坐标（通常记作$L_i$）相同。在面积为$A$的三角形$K$上，重心坐标乘积的标准积分公式为：\n$$\n\\int_{K} L_{1}^{a} L_{2}^{b} L_{3}^{c} \\, \\mathrm{d}A = \\frac{a! \\, b! \\, c!}{(a+b+c+2)!} 2A\n$$\n其中$a, b, c$是非负整数指数。\n\n我们应用此公式来计算$N_i N_j$的积分。\n\n对于对角线项（$i=j$）：\n我们需要计算$\\int_{K} N_{i}^{2} \\, \\mathrm{d}A$。根据对称性，此积分对所有$i \\in \\{1, 2, 3\\}$都是相同的。让我们为$i=1$计算它。这对应于在公式中设置$a=2, b=0, c=0$。\n$$\n\\int_{K} N_{1}^{2} \\, \\mathrm{d}A = \\int_{K} N_{1}^{2} N_{2}^{0} N_{3}^{0} \\, \\mathrm{d}A = \\frac{2! \\, 0! \\, 0!}{(2+0+0+2)!} 2A = \\frac{2}{4!} 2A = \\frac{2}{24} 2A = \\frac{A}{6}\n$$\n因此，对角线项为$M_{ii}^{\\text{cons}} = \\rho \\frac{A}{6}$。\n\n对于非对角线项（$i \\ne j$）：\n我们需要计算$\\int_{K} N_{i}N_{j} \\, \\mathrm{d}A$。根据对称性，此积分对任意$i \\ne j$的序对$(i, j)$都是相同的。让我们为$i=1, j=2$计算它。这对应于在公式中设置$a=1, b=1, c=0$。\n$$\n\\int_{K} N_{1}N_{2} \\, \\mathrm{d}A = \\int_{K} N_{1}^{1} N_{2}^{1} N_{3}^{0} \\, \\mathrm{d}A = \\frac{1! \\, 1! \\, 0!}{(1+1+0+2)!} 2A = \\frac{1}{4!} 2A = \\frac{1}{24} 2A = \\frac{A}{12}\n$$\n因此，当$i \\ne j$时，非对角线项为$M_{ij}^{\\text{cons}} = \\rho \\frac{A}{12}$。\n\n完整的一致单元质量矩阵为：\n$$\nM^{\\text{cons}} = \\frac{\\rho A}{12}\n\\begin{pmatrix}\n2  1  1 \\\\\n1  2  1 \\\\\n1  1  2\n\\end{pmatrix}\n$$\n\n**任务2：集总质量矩阵$M_{ij}^{\\text{lump}}$的推导**\n\n质量矩阵的积分将使用一个求积法则来近似，该法则使用三角形的3个顶点$\\{\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3}\\}$作为求积点，权重相等，记为$w$。对于函数$f$，这种法则的一般形式是：\n$$\n\\int_{K} f(\\mathbf{x}) \\, \\mathrm{d}A \\approx \\sum_{k=1}^{3} w f(\\mathbf{x}_{k}) = w \\left( f(\\mathbf{x}_{1}) + f(\\mathbf{x}_{2}) + f(\\mathbf{x}_{3}) \\right)\n$$\n权重$w$是通过要求该法则对所有总次数至多为1的多项式都精确来确定的。我们可以通过强制其对最简单的此类多项式——常数函数$f(\\mathbf{x})=1$——精确来找到$w$。\n精确积分为$\\int_{K} 1 \\, \\mathrm{d}A = A$。\n求积近似为$w(1+1+1) = 3w$。\n令两者相等得到$3w = A$，所以权重为$w = \\frac{A}{3}$。\n\n因此，求积法则为：\n$$\n\\int_{K} f(\\mathbf{x}) \\, \\mathrm{d}A \\approx \\frac{A}{3} \\sum_{k=1}^{3} f(\\mathbf{x}_{k})\n$$\n我们将此法则应用于质量矩阵积分，$M_{ij}^{\\text{lump}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$。被积函数为$f(\\mathbf{x}) = \\rho N_i(\\mathbf{x}) N_j(\\mathbf{x})$。\n$$\nM_{ij}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})\n$$\n我们使用形函数的克罗内克$\\delta$性质，$N_{i}(\\mathbf{x}_{j}) = \\delta_{ij}$。\n\n对于对角线项（$i=j$）：\n$$\nM_{ii}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{i}(\\mathbf{x}_{k}) = \\rho \\frac{A}{3} \\sum_{k=1}^{3} \\left( N_{i}(\\mathbf{x}_{k}) \\right)^{2}\n$$\n对于一个特定的索引，比如$i=1$，求和为：\n$$\n\\left( N_{1}(\\mathbf{x}_{1}) \\right)^{2} + \\left( N_{1}(\\mathbf{x}_{2}) \\right)^{2} + \\left( N_{1}(\\mathbf{x}_{3}) \\right)^{2} = (1)^{2} + (0)^{2} + (0)^{2} = 1\n$$\n这对任意$i \\in \\{1, 2, 3\\}$都成立。这个和总是$1$。\n因此，对角线项为：\n$$\nM_{ii}^{\\text{lump}} = \\rho \\frac{A}{3} \\cdot 1 = \\frac{\\rho A}{3}\n$$\n\n对于非对角线项（$i \\ne j$）：\n$$\nM_{ij}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})\n$$\n对于任意不同的索引对$i \\ne j$，以及任意顶点$\\mathbf{x}_k$，$N_i(\\mathbf{x}_k)$或$N_j(\\mathbf{x}_k)$中至少有一个必须为零。这是因为在任意顶点$\\mathbf{x}_k$处，只有形函数$N_k$不为零（且等于$1$）。因此，对于$i \\ne j$，乘积$N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})$总是$0$。\n例如，对于$i=1, j=2$：\n$$\n\\sum_{k=1}^{3} N_{1}(\\mathbf{x}_{k}) N_{2}(\\mathbf{x}_{k}) = N_{1}(\\mathbf{x}_{1})N_{2}(\\mathbf{x}_{1}) + N_{1}(\\mathbf{x}_{2})N_{2}(\\mathbf{x}_{2}) + N_{1}(\\mathbf{x}_{3})N_{2}(\\mathbf{x}_{3}) = (1)(0) + (0)(1) + (0)(0) = 0\n$$\n因此，当$i \\ne j$时，非对角线项为$M_{ij}^{\\text{lump}} = 0$。\n\n集总质量矩阵为：\n$$\nM^{\\text{lump}} = \\frac{\\rho A}{3}\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n\n**任务3：权衡讨论**\n\n在时间相关问题的半离散有限元格式中，可以得到一个形如$M \\frac{d\\mathbf{u}}{dt} = \\mathbf{r}(\\mathbf{u})$的常微分方程组，其中$M$是全局质量矩阵，$\\mathbf{u}$是节点自由度向量，$\\mathbf{r}$是包含空间导数项的残差向量。\n\n对于显式时间积分格式（例如，前向欧拉法），每个时间步的更新为$\\mathbf{u}^{n+1} = \\mathbf{u}^{n} + \\Delta t \\, M^{-1} \\mathbf{r}(\\mathbf{u}^{n})$。权衡的核心在于$M$的结构以及计算$M^{-1}\\mathbf{r}$的成本。\n\n1.  **集总质量矩阵 ($M^{\\text{lump}}$)**：\n    -   **优点**：根据其构造，$M^{\\text{lump}}$是一个对角矩阵。它的逆矩阵$(M^{\\text{lump}})^{-1}$也是对角的，其项是$M^{\\text{lump}}$对角线项的倒数。操作$M^{-1}\\mathbf{r}$变成了一个简单的、计算成本低的向量-向量缩放（逐元素除法）。这使得显式时间步进极其高效，这在可能需要数百万个时间步的大规模CFD中是一个主要优点。\n    -   **缺点**：质量集总是一种降低空间离散化精度的近似。虽然线性元的一致质量矩阵提供了色散关系（相位误差）的四阶精度近似，但集总质量矩阵将其降至二阶。对于对流主导的问题，这表现为增加的数值色散，意味着不同频率的波以不正确的速度传播，导致拖尾振荡和尖锐锋面的模糊化。空间格式的形式精度阶因此受损。\n\n2.  **一致质量矩阵 ($M^{\\text{cons}}$)**：\n    -   **优点**：$M^{\\text{cons}}$直接源于Galerkin投影，因而是数学上最忠实的表示。它保持了底层有限元空间的最优精度。如前所述，它提供了更优的色散特性，这对于精确模拟对流主导流动中固有的波传播现象至关重要。这就是提示中所谓的“保持插值精度”。\n    -   **缺点**：$M^{\\text{cons}}$是一个稀疏但非对角的矩阵。计算$M^{-1}\\mathbf{r}$需要在每个时间步求解一个线性方程组$M\\mathbf{x} = \\mathbf{r}$。尽管$M$是对称正定且良态的，但这个求解步骤（例如，使用像Jacobi或共轭梯度法这样的迭代求解器）比集总矩阵所需的逐元素除法要昂贵得多。这可能使显式格式在计算上变得不可行。\n\n**权衡总结**：对于对流主导问题的显式时间积分，选择在于集总质量矩阵的高计算效率和一致质量矩阵的更高精度（特别是更低的色散误差）之间。在实践中，质量集总带来的效率增益是如此显著，以至于它成为大多数大规模显式CFD代码的默认选择，但需要了解的是，所引入的色散误差必须通过其他方式（例如，高分辨率平流格式）进行监控或减缓。",
            "answer": "$$\n\\boxed{\\frac{\\rho A}{3}}\n$$"
        },
        {
            "introduction": "实际的工程问题，例如翼型绕流，通常涉及无法用直线单元精确描述的弯曲边界。为了处理这种复杂性，我们采用等参元的概念，即使用相同的形函数来描述几何形状和逼近待求解的物理量，而雅可比矩阵正是描述这种几何映射的关键。这个高级练习将让您为一个弯曲的二次单元构建几何映射，并计算雅可比行列式，这是将物理单元上的积分变换到标准参考单元上进行数值计算所必需的步骤 。",
            "id": "4006148",
            "problem": "考虑一个用于计算流体力学（CFD）的空气动力学网格中的二维曲边单元，该方法基于有限元法（FEM）和伽辽金加权余量法。该单元是一个二次六节点三角形，用于表示翼型的局部弯曲部分。参考单元是参数空间中的标准单位直角三角形，其局部坐标为 $\\boldsymbol{\\xi} = (\\xi,\\eta)$，顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。三个顶点节点和三个边中节点在物理空间中的位置如下：\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\n其中，节点 $1$、$2$ 和 $3$ 分别是对应于参考三角形上 $(\\xi,\\eta) = (0,0)$、$(1,0)$ 和 $(0,1)$ 的顶点，而节点 $4$、$5$ 和 $6$ 分别是对应于 $(\\xi,\\eta) = (0.5,0)$、$(0.5,0.5)$ 和 $(0,0.5)$ 的边中节点。\n\n从等参概念的基本定义出发，即用于解近似的同一多项式基也用于几何插值，执行以下操作：\n\n1. 对于此弯曲的六节点三角形单元，根据定义在参考三角形上的二次拉格朗日形函数，推导其等参映射 $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$。清晰地表达几何形状是如何通过节点坐标插值得到的。\n\n2. 使用该映射，计算雅可比矩阵\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\n及其在参考三角形形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的行列式 $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$。\n\n3. 解释在伽辽金加权余量法下，雅可比行列式在变换弱形式积分中的作用，特别是对于单元 $E$ 上的局部 $L^{2}$ 内积，\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\n其中 $N_1$ 是与节点 1 相关联的单元的第一个二次形函数，$\\mathrm{d}\\Omega$ 是物理面积微分。\n\n4. 在参考三角形上使用单点求积（对线性多项式精确），通过在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处求值来近似变换后的积分，求积权重等于参考三角形的面积。将 $I$ 的近似值的最终答案表示为一个精确的有理数。不包含任何物理单位，也不要四舍五入；以最简分数形式给出精确值。",
            "solution": "有限元法（FEM）中的等参概念将几何和解的近似设置在同一多项式空间上。对于一个二次六节点三角形单元，几何形状通过二次拉格朗日形函数从参考三角形映射到物理三角形。用 $L_1 = 1 - \\xi - \\eta$，$L_2 = \\xi$ 和 $L_3 = \\eta$ 表示参考面积（重心）坐标。参考三角形上的六个二次拉格朗日形函数为\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\n通过几何的等参插值，从参考坐标 $\\boldsymbol{\\xi}=(\\xi,\\eta)$ 到物理坐标 $\\boldsymbol{x}=(x,y)$ 的映射为\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中 $(x_i,y_i)$ 是单元的物理节点坐标。\n\n该映射的雅可比矩阵为\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\n我们现在计算形函数在参考三角形形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的导数。在形心处，重心坐标为 $L_1=L_2=L_3=\\frac{1}{3}$。形函数在形心处的值为：\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\n重心坐标的导数为\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\n使用乘法法则和链式法则，形函数在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的导数为：\n- 对于 $N_1 = L_1(2L_1 - 1)$,\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = 1-4 L_1 = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = 1-4 L_1 = -\\frac{1}{3}.\n$$\n- 对于 $N_2 = L_2(2L_2 - 1)$,\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = 4 L_2 - 1 = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- 对于 $N_3 = L_3(2L_3 - 1)$,\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = 4 L_3 - 1 = \\frac{1}{3}.\n$$\n- 对于 $N_4 = 4 L_1 L_2$,\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = -4 L_2 = -\\frac{4}{3}.\n$$\n- 对于 $N_5 = 4 L_2 L_3$,\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4 L_2 = \\frac{4}{3}.\n$$\n- 对于 $N_6 = 4 L_3 L_1$,\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_1 - L_3) = 0.\n$$\n利用给定的节点坐标，我们计算形心处的雅可比矩阵各项。首先，对于 $\\frac{\\partial x}{\\partial \\xi}$：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + 0\\cdot 0 + 0\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\n接下来，对于 $\\frac{\\partial x}{\\partial \\eta}$：\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\xi}$：\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\eta}$：\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\n因此，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵为\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3}  -\\frac{2}{5} \\\\\n\\frac{2}{5}  \\frac{32}{15}\n\\end{pmatrix},\n$$\n其行列式为\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{676}{225}.\n$$\n\n在伽辽金加权余量法下，雅可比行列式在变换弱形式积分中的作用由变量替换公式给出。对于定义在弯曲物理单元 $E$ 上的任何被积函数 $g(\\boldsymbol{x})$，面积分变换到参考单元 $\\hat{E}$ 如下\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ 解释了由映射引起的局部度量畸变和面积缩放。\n\n对于单元上指定的弱形式内积，\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\n在参考单元上的变换积分为\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n在形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处使用单点求积，权重等于参考三角形的面积，\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\n我们得到近似值\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\n我们已经计算出 $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ 和 $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$。因此，\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{225 \\cdot 162}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\n这是对弯曲单元上的局部 $L^{2}$ 内积使用指定单点求积近似得到的精确有理数值。",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        }
    ]
}