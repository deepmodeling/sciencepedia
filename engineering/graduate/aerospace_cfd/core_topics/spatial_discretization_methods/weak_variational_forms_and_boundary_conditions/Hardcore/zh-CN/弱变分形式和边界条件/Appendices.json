{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，通过分部积分将强形式微分方程转换为弱形式，这一过程会自然地产生边界积分项。这些边界项为施加某些类型的边界条件（如力、应力或通量）提供了一个优雅的框架，这类边界条件被称为“自然边界条件”。本练习将通过经典的不可压缩斯托克斯流问题，指导您推导其弱形式，并计算由出口压力引起的“自然”边界项，从而加深您对这一基本概念的理解 。",
            "id": "4005885",
            "problem": "考虑在计算流体动力学 (CFD) 背景下的一个二维、稳态、不可压缩、极低雷诺数（蠕动流）的牛顿流体流动。设区域为单位正方形 $\\Omega = (0,1)\\times(0,1)$，其边界为 $\\partial \\Omega$。用 $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^2$ 表示速度，用 $p:\\Omega \\to \\mathbb{R}$ 表示压力。柯西应力张量为 $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$，其中 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$ 且 $\\mu>0$ 为动力粘度。控制方程为\n$$\n-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}\\quad \\text{in }\\Omega,\\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in }\\Omega.\n$$\n在边界上，对 $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ 施加齐次速度 (Dirichlet) 条件 $\\boldsymbol{u}=\\boldsymbol{0}$，并在右边界 $\\Gamma_{N} = \\{(x,y)\\in \\partial \\Omega: x=1,\\, y\\in(0,1)\\}$ 上施加形式为\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}\\quad \\text{on }\\Gamma_{N},\n$$\n的压力 (曳力) 边界条件，其中 $\\boldsymbol{n}$ 是单位外法向量，且 $p_{\\text{out}}(y) = 1 + y^{2}$。假设所有量均为无量纲。\n\n(a) 从线性动量守恒和柯西应力的定义出发，推导 Stokes 问题的弱 (变分) 形式：找到 $(\\boldsymbol{u},p)$，其位于适当的空间中，使得对于所有在 $\\Gamma_{D}$ 上满足 $\\boldsymbol{w}=\\boldsymbol{0}$ 的测试函数 $(\\boldsymbol{w},q)$，下式成立：\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\n并确定给定的压力边界条件所蕴含的曳力 $\\boldsymbol{t}$。清楚地用 $p_{\\text{out}}$ 和 $\\boldsymbol{w}$ 表示在 $\\Gamma_{N}$ 上得到的自然边界贡献泛函。\n\n(b) 设特定的测试函数为 $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$。计算在 $\\Gamma_{N}$ 上对 $\\boldsymbol{w}$ 求值的自然边界贡献泛函的标量值，即\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\n其中 $\\Gamma_{N}$ 上的单位外法向量为 $\\boldsymbol{n}$，给定的 $p_{\\text{out}}(y)=1+y^{2}$。请以单个精确实数的形式给出最终答案。不要四舍五入。所有量均为无量纲，因此不需要单位。",
            "solution": "首先验证问题以确保其具有科学依据、是适定的，并且所有必要信息都已提供。已知条件是单位正方形区域 $\\Omega = (0,1)\\times(0,1)$ 内二维、稳态、不可压缩牛顿流动的 Stokes 控制方程。动量守恒方程为 $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}$，质量守恒方程为 $\\nabla \\cdot \\boldsymbol{u} = 0$。柯西应力张量为 $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$，其中 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$。边界条件包括在 $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ 上的齐次 Dirichlet 条件 $\\boldsymbol{u}=\\boldsymbol{0}$ 和在右边界 $\\Gamma_{N} = \\{(x,y): x=1, y\\in(0,1)\\}$ 上的曳力条件 $\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}$，其中 $p_{\\text{out}}(y) = 1 + y^{2}$。该问题定义明确，且与连续介质力学原理一致。我们可以开始求解。\n\n(a) 弱变分形式的推导。\n\n我们从动量方程（也称为线性动量守恒）$-\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$ 开始。为推导弱形式，我们将其乘以一个矢量测试函数 $\\boldsymbol{w}$，并在区域 $\\Omega$ 上积分。测试函数 $\\boldsymbol{w}$ 必须属于一个合适的函数空间，并且为了施加 Dirichlet 边界条件，要求它在边界的 Dirichlet 部分为零，即在 $\\Gamma_D$ 上 $\\boldsymbol{w} = \\boldsymbol{0}$。\n$$\n- \\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\boldsymbol{0}\n$$\n我们应用散度定理，或更具体地说，张量场的格林第一恒等式，即 $\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{T}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\Omega = -\\int_{\\Omega} \\boldsymbol{T} : \\nabla \\boldsymbol{v} \\,\\mathrm{d}\\Omega + \\int_{\\partial \\Omega} (\\boldsymbol{T} \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}S$。令 $\\boldsymbol{T} = \\boldsymbol{\\sigma}$ 和 $\\boldsymbol{v} = \\boldsymbol{w}$，我们得到：\n$$\n- \\left( -\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega + \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S \\right) = \\boldsymbol{0}\n$$\n这可以简化为：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\n接下来，我们将柯西应力张量的定义 $\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ 代入左边：\n$$\n\\int_{\\Omega} (-p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\Omega} -p\\,(\\boldsymbol{I} : \\nabla\\boldsymbol{w}) + 2\\mu\\,(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\nabla\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\n我们分别分析被积函数中的两项。第一项涉及单位张量 $\\boldsymbol{I}$ 和 $\\boldsymbol{w}$ 的梯度的双点积，即 $\\nabla\\boldsymbol{w}$ 的迹，$\\boldsymbol{I}:\\nabla\\boldsymbol{w} = \\operatorname{tr}(\\nabla\\boldsymbol{w}) = \\nabla \\cdot \\boldsymbol{w}$。第二项涉及应变率张量 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ 和 $\\nabla\\boldsymbol{w}$ 的乘积。由于 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ 是对称的，它与任意张量 $\\nabla\\boldsymbol{w}$ 的双点积等价于它与该张量对称部分 $\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\frac{1}{2}(\\nabla\\boldsymbol{w} + \\nabla\\boldsymbol{w}^\\top)$ 的乘积。与反对称部分的乘积为零。因此，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\nabla\\boldsymbol{w} = \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})$。\n因此左边变为：\n$$\n-\\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega + \\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\n右边的边值积分被分解到 Dirichlet 和 Neumann 边界上：\n$$\n\\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_D} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S + \\int_{\\Gamma_N} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\n根据构造，速度的测试函数在 $\\Gamma_D$ 上满足 $\\boldsymbol{w} = \\boldsymbol{0}$，因此在 $\\Gamma_D$ 上的积分为零。在 $\\Gamma_N$ 上，给定曳力条件 $\\boldsymbol{\\sigma}\\boldsymbol{n} = -p_{\\text{out}}(y)\\boldsymbol{n}$。我们定义曳力向量为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$。因此，在 $\\Gamma_N$ 上，$\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$。边值积分简化为：\n$$\n\\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_N} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\n结合这些部分，动量方程的弱形式为：\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega = \\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\n最后，我们引入不可压缩约束 $\\nabla \\cdot \\boldsymbol{u} = 0$。在混合格式中，我们将其乘以一个标量压力测试函数 $q$，并在 $\\Omega$ 上积分。由于 $\\nabla \\cdot \\boldsymbol{u} = 0$，这得到 $\\int_{\\Omega} q\\,(\\nabla \\cdot \\boldsymbol{u}) \\,\\mathrm{d}\\Omega = 0$。将此零项加到左边，得到所要求的最终弱形式：\n找到 $(\\boldsymbol{u}, p)$，使得对于所有有效的测试函数 $(\\boldsymbol{w}, q)$：\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\n边界条件所蕴含的曳力 $\\boldsymbol{t}$ 是 $\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$。$\\Gamma_N$ 上的自然边界贡献泛函是右端项，即：\n$$\n\\int_{\\Gamma_{N}} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\n\n(b) 自然边界贡献泛函的计算。\n\n我们需要为特定的函数 $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$ 计算泛函 $I_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S$ 的值。值得注意的是，该函数并不在 Dirichlet 边界 $\\Gamma_D$ 的所有部分都满足 $\\boldsymbol{w}=\\boldsymbol{0}$（例如，在 $(0.5, 0)$ 处，$\\boldsymbol{w} \\neq \\boldsymbol{0}$），因此它不是该变分问题的有效测试函数。然而，为此函数计算积分是一个适定的数学任务。\n\n边界 $\\Gamma_N$ 是 $x=1$ 且 $y \\in (0,1)$ 的线段。此边界上的单位外法向量为 $\\boldsymbol{n} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。线元为 $\\mathrm{d}S = \\mathrm{d}y$。\n根据 (a) 部分，被积函数为 $\\boldsymbol{t} \\cdot \\boldsymbol{w} = (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}$。\n代入给定的函数和向量：\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -\\left(1+y^2\\right)\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}\n$$\n点积计算结果为：\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -(1+y^2) \\left(1 \\cdot y(1-y) + 0 \\cdot x(1-x) \\right) = -(1+y^2)y(1-y)\n$$\n积分是在 $\\Gamma_N$ 上计算的，所以我们必须在 $\\boldsymbol{w}$ 的表达式中设置 $x=1$，尽管在这种情况下，$w_y$ 分量无论如何都要乘以零。在 $\\Gamma_N$ 上的函数 $\\boldsymbol{w}$ 为 $\\boldsymbol{w}(1,y) = \\begin{pmatrix} y(1-y) \\\\ 1(1-1) \\end{pmatrix} = \\begin{pmatrix} y(1-y) \\\\ 0 \\end{pmatrix}$。\n在 $\\Gamma_N$ 上的被积函数为：\n$$\n-(1+y^2)(y-y^2) = -(y - y^2 + y^3 - y^4) = y^4 - y^3 + y^2 - y\n$$\n现在我们计算 $y$ 从 $0$ 到 $1$ 的定积分：\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\int_{0}^{1} (y^4 - y^3 + y^2 - y) \\,\\mathrm{d}y\n$$\n使用积分的幂法则：\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left[ \\frac{y^5}{5} - \\frac{y^4}{4} + \\frac{y^3}{3} - \\frac{y^2}{2} \\right]_{0}^{1}\n$$\n在积分限处计算表达式：\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left( \\frac{1^5}{5} - \\frac{1^4}{4} + \\frac{1^3}{3} - \\frac{1^2}{2} \\right) - \\left( 0 \\right)\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{1}{5} - \\frac{1}{4} + \\frac{1}{3} - \\frac{1}{2}\n$$\n为求得最终值，我们使用公分母，即 $2$、$3$、$4$ 和 $5$ 的最小公倍数 $60$。\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{12}{60} - \\frac{15}{60} + \\frac{20}{60} - \\frac{30}{60} = \\frac{12 - 15 + 20 - 30}{60}\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{-3 + 20 - 30}{60} = \\frac{17 - 30}{60} = \\frac{-13}{60}\n$$\n对于给定的函数 $\\boldsymbol{w}$，自然边界贡献泛函的值为 $-\\frac{13}{60}$。",
            "answer": "$$\n\\boxed{-\\frac{13}{60}}\n$$"
        },
        {
            "introduction": "在航空航天CFD中，当流体的对流效应远大于扩散效应时，标准的伽辽金有限元法可能会产生非物理的数值振荡，导致解的不稳定。为了解决这一问题，研究人员发展了多种稳定化方法。本练习将探讨一种核心技术——流线迎风/皮特洛夫-伽辽金 (SUPG) 方法，它通过在弱形式中引入一个附加项，沿着流线方向增加人工耗散来抑制振荡。您将亲手计算这个稳定项对单个单元的贡献，深入理解如何通过修正弱形式来提升数值解的质量 。",
            "id": "4005903",
            "problem": "我们考虑一个航空航天计算流体动力学 (CFD) 环境下，沿流线的被动标量 $\\phi(x)$ 的稳态一维对流扩散模型。该模型在区间 $x \\in (0,L)$ 上定义，具有恒定的对流速度 $a>0$ 和恒定的扩散系数 $\\kappa>0$。其控制守恒律为\n$$\n- \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi}{dx}\\right) + a\\,\\frac{d\\phi}{dx} = 0 \\quad \\text{in } (0,L).\n$$\n施加入口 Dirichlet 条件 $\\phi(0)=\\phi_{\\mathrm{in}}$，并让出口 $x=L$ 处由弱形式自然处理。从该强形式出发，通过乘以一个容许的测试函数 $w(x)$，在 $(0,L)$ 上积分，并对扩散项应用分部积分，来推导弱变分形式。清楚地指明边界项以及与入口处本质边界条件一致的 $w(0)=0$ 的作用。\n\n现在考虑在邻近入口的第一个单元 $e=[0,h]$ 上的连续线性有限元离散化，其节点值在 $x=0$ 处为 $\\phi_1$，在 $x=h$ 处为 $\\phi_2$。Dirichlet 边界条件被强施加，因此 $\\phi_1=\\phi_{\\mathrm{in}}$。在单元 $e$ 上使用标准线性形函数，即 $N_1(x)=1-x/h$ 和 $N_2(x)=x/h$，因此单元 $e$ 上的试探场为 $\\phi_h(x)=\\phi_1 N_1(x)+\\phi_2 N_2(x)$，并取 Galerkin 测试函数为 $w(x)=N_2(x)$，该函数满足 $w(0)=0$。\n\n使用一个在入口边界处斜坡式衰减的、基于残差的 Streamline-Upwind/Petrov–Galerkin (SUPG) 稳定化项来增强单元弱形式：\n$$\n\\int_{e} \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx,\n$$\n其中逐点残差为 $r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}$，边界阻尼稳定化参数为 $\\tau(x)=\\tau_0\\,\\frac{x}{h}$，其中 $\\tau_0>0$ 为常数。\n\n以闭合形式计算在单元 $e=[0,h]$ 上使用 $w=N_2$ 计算的总的稳定化单元左侧。该计算需包括由分部积分产生的扩散项、对流项和边界项，以及 SUPG 贡献项。将最终结果表示为包含 $a$、$\\kappa$、$h$、$\\tau_0$、$\\phi_{\\mathrm{in}}$ 和 $\\phi_2$ 的单一解析表达式。无需进行数值计算，也无需四舍五入。您的最终答案必须是单一的闭合形式解析表达式。",
            "solution": "用户希望我解决一个关于一维对流扩散方程的有限元方法 (FEM) 问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **控制方程：** $- \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi}{dx}\\right) + a\\,\\frac{d\\phi}{dx} = 0$ 在定义域 $x \\in (0,L)$ 上。\n*   **参数：** 对流速度 $a>0$ 和扩散系数 $\\kappa>0$ 为常数。\n*   **边界条件：** 入口 Dirichlet 条件 $\\phi(0)=\\phi_{\\mathrm{in}}$。出口 $x=L$ 处由弱形式自然处理。\n*   **离散化任务：** 从强形式推导弱变分形式。\n*   **有限元设置：**\n    *   **单元：** 第一个单元是 $e=[0,h]$。\n    *   **节点值：** $x=0$ 处为 $\\phi_1$，$x=h$ 处为 $\\phi_2$。\n    *   **Dirichlet 施加：** $\\phi_1=\\phi_{\\mathrm{in}}$ 被强施加。\n    *   **形函数：** 单元 $e$ 上的线性形函数为 $N_1(x)=1-x/h$ 和 $N_2(x)=x/h$。\n    *   **试探函数：** $\\phi_h(x)=\\phi_1 N_1(x)+\\phi_2 N_2(x)$。\n    *   **测试函数：** Galerkin 测试函数为 $w(x)=N_2(x)$，满足 $w(0)=0$。\n*   **稳定化：**\n    *   **SUPG 项：** $\\int_{e} \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx$。\n    *   **逐点残差：** $r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}$。\n    *   **稳定化参数：** $\\tau(x)=\\tau_0\\,\\frac{x}{h}$，其中 $\\tau_0>0$。\n*   **目标：** 使用测试函数 $w=N_2(x)$ 计算单元 $e=[0,h]$ 的总稳定化单元左侧。表达式应包括标准的 Galerkin 项（扩散项、对流项和由分部积分产生的边界项）加上 SUPG 贡献项。最终结果必须是关于 $a$、$\\kappa$、$h$、$\\tau_0$、$\\phi_{\\mathrm{in}}$ 和 $\\phi_2$ 的单一闭合形式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 问题陈述描述了将 Streamline-Upwind/Petrov-Galerkin (SUPG) 有限元方法应用于一维稳态对流扩散方程。这是计算流体动力学和偏微分方程数值分析中的一个标准和基础课题。该模型和方法是成熟且科学合理的。\n2.  **适定的：** 该问题在数学上是适定的。它提供了一个控制方程、边界条件，以及一套用于推导和计算特定量的清晰指令。所有必要的函数和参数都已明确定义。\n3.  **客观性：** 问题使用精确的数学和工程术语进行陈述，没有主观或模糊的表述。\n4.  **完整与一致：** 提供了执行计算所需的所有信息。形函数、试探/测试函数和稳定化项的定义是完整的，并与标准文献一致。\n5.  **未检测到其他缺陷：** 该问题是有限元方法应用中的一个标准练习，不是微不足道、隐喻性或矛盾的。\n\n**步骤 3：结论与行动**\n\n问题有效。将按要求推导解答。\n\n### 解答\n\n目标是计算第一个单元 $e=[0,h]$ 的总稳定化单元贡献。该量是在给定试探函数 $\\phi_h(x)$ 和测试函数 $w(x)$ 下，对稳定化弱形式求值的结果。我们记总表达式为 $T$，它是标准 Galerkin 贡献 $I_{G}$ 和 Streamline-Upwind/Petrov-Galerkin (SUPG) 贡献 $I_{SUPG}$ 的和。\n\n$$\nT = I_{G} + I_{SUPG}\n$$\n\nGalerkin 贡献 $I_G$ 是通过将控制方程乘以测试函数 $w(x)$ 并在单元域 $e=[0,h]$ 上积分得到的。问题明确指出，此计算必须包括对扩散项应用分部积分时产生的边界项。\n\n$$\nI_G = \\int_0^h w(x) \\left( - \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi_h}{dx}\\right) + a\\,\\frac{d\\phi_h}{dx} \\right) dx\n$$\n\n对扩散项 $\\int_0^h -w \\frac{d}{dx}(\\kappa \\frac{d\\phi_h}{dx}) dx$ 应用分部积分得到：\n\n$$\n\\int_0^h \\kappa \\frac{d\\phi_h}{dx} \\frac{dw}{dx} dx - \\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h\n$$\n\n因此，完整的 Galerkin 贡献为：\n\n$$\nI_G = \\underbrace{\\int_0^h \\kappa \\frac{d\\phi_h}{dx} \\frac{dw}{dx} dx}_{\\text{扩散}} + \\underbrace{\\int_0^h w(x) a \\frac{d\\phi_h}{dx} dx}_{\\text{对流}} - \\underbrace{\\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h}_{\\text{边界}}\n$$\n\nSUPG 贡献由下式给出：\n\n$$\nI_{SUPG} = \\int_0^h \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx, \\quad \\text{其中 } r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}\n$$\n\n现在我们使用为单元 $e=[0,h]$ 提供的函数来计算这些项。\n试探函数为 $\\phi_h(x) = \\phi_1 N_1(x) + \\phi_2 N_2(x)$。由于 $\\phi_1=\\phi_{\\mathrm{in}}$，$N_1(x) = 1 - x/h$ 且 $N_2(x) = x/h$，我们有：\n\n$$\n\\phi_h(x) = \\phi_{\\mathrm{in}}(1 - \\frac{x}{h}) + \\phi_2 \\frac{x}{h}\n$$\n\n$\\phi_h(x)$ 的一阶和二阶导数是：\n\n$$\n\\frac{d\\phi_h}{dx} = \\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h} \\quad (\\text{一个常数})\n$$\n$$\n\\frac{d^2\\phi_h}{dx^2} = 0\n$$\n\n测试函数为 $w(x) = N_2(x) = x/h$。其导数为：\n\n$$\n\\frac{dw}{dx} = \\frac{1}{h} \\quad (\\text{一个常数})\n$$\n\n我们还注意到测试函数的边界值：$w(0)=0$ 和 $w(h)=1$。\n\n**1. Galerkin 贡献 ($I_G$) 的计算**\n\n*   **扩散项：**\n    $$\n    \\int_0^h \\kappa \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) \\left(\\frac{1}{h}\\right) dx = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\int_0^h dx = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} [x]_0^h = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n    $$\n*   **对流项：**\n    $$\n    \\int_0^h \\left(\\frac{x}{h}\\right) a \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) dx = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\int_0^h x\\,dx = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\left[\\frac{x^2}{2}\\right]_0^h = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{2}\n    $$\n*   **边界项：**\n    $$\n    - \\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h = - \\left( w(h) \\kappa \\frac{d\\phi_h}{dx}(h) - w(0) \\kappa \\frac{d\\phi_h}{dx}(0) \\right)\n    $$\n    由于 $\\frac{d\\phi_h}{dx}$ 是常数，$w(0)=0$ 且 $w(h)=1$：\n    $$\n    - \\left( 1 \\cdot \\kappa \\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h} - 0 \\right) = - \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n    $$\n将这三部分相加，我们发现扩散项和边界项相互抵消：\n$$\nI_G = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h} + \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{2} - \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h} = \\frac{a}{2} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n\n**2. SUPG 贡献 ($I_{SUPG}$) 的计算**\n\n首先，我们计算逐点残差 $r(\\phi_h)$：\n$$\nr(\\phi_h) = -\\kappa \\frac{d^2\\phi_h}{dx^2} + a \\frac{d\\phi_h}{dx} = -\\kappa(0) + a \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) = \\frac{a(\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n$$\n残差在整个单元上是常数。现在我们计算 SUPG 积分：\n$$\nI_{SUPG} = \\int_0^h \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx = \\int_0^h \\left(\\tau_0 \\frac{x}{h}\\right) a \\left(\\frac{1}{h}\\right) \\left(\\frac{a(\\phi_2 - \\phi_{\\mathrm{in}})}{h}\\right) dx\n$$\n我们可以将所有常数因子移到积分符号外：\n$$\nI_{SUPG} = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\int_0^h x\\,dx\n$$\n计算积分：\n$$\nI_{SUPG} = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\left[\\frac{x^2}{2}\\right]_0^h = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\left(\\frac{h^2}{2}\\right) = \\frac{\\tau_0 a^2}{2h} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n\n**3. 总的稳定化单元左侧**\n\n总表达式 $T$ 是 Galerkin 和 SUPG 贡献之和：\n$$\nT = I_G + I_{SUPG} = \\frac{a}{2} (\\phi_2 - \\phi_{\\mathrm{in}}) + \\frac{\\tau_0 a^2}{2h} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n提取公因式得到最终的闭合形式表达式：\n$$\nT = \\left(\\frac{a}{2} + \\frac{\\tau_0 a^2}{2h}\\right) (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n该表达式代表了第一个有限元的完整的、稳定化后的第二个方程。",
            "answer": "$$\\boxed{\\left(\\frac{a}{2} + \\frac{\\tau_0 a^{2}}{2h}\\right) (\\phi_2 - \\phi_{\\mathrm{in}})}$$"
        },
        {
            "introduction": "对于控制高速可压缩流动的双曲型方程组（如欧拉方程），边界条件的设置至关重要，它直接决定了问题的适定性与解的物理真实性。一个核心原则是：边界条件必须与信息的传播方向（即特征方向）相容，我们只能对传入计算区域的信息进行指定。本练习将引导您对线性化欧拉方程进行特征分析，以确定在亚音速出口处哪些信息是传入的。掌握这一方法是为复杂的航空航天流动问题设计稳定、无反射边界条件的关键一步 。",
            "id": "4005907",
            "problem": "考虑在航空航天应用中与计算流体动力学（CFD）相关的，围绕均匀、稳定的一维（$1$-D）平均流的小扰动的线性化等熵欧拉方程。设平均态由恒定密度 $\\rho_{0} > 0$、恒定压力 $p_{0} > 0$、恒定流速 $u_{0} > 0$ 和恒定声速 $c_{0} > 0$ 表征，其中亚音速平均流满足 $0  u_{0}  c_{0}$。将扰动量表示为 $p'(x,t)$ 和 $u'(x,t)$，假设它们足够光滑，并采用等熵闭合，使得声速满足 $c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$，其中 $\\gamma  1$ 是比热比。$(p',u')$ 的线性化方程为\n$$\np'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0, \\qquad\nu'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0,\n$$\n定义在空间区间 $x \\in (0,L)$ 和时间 $t \\ge 0$ 上，其中 $L0$ 为一固定值。考虑一个 Galerkin 弱形式：选择一个测试函数 $\\varphi(x) \\in H^{1}(0,L)$，将方程组乘以 $\\varphi$ 并在 $(0,L)$ 上对空间变量进行分部积分，从而写出其弱形式。关注右边界 $x=L$，此处必须施加一个物理上可容许的特征边界条件，以确保亚音速出流的能量稳定性和无反射特性。\n\n从质量和动量守恒、声速的定义以及线性化系统的双曲结构出发，推导 $x$ 方向上的特征分解。使用能量法，并结合适用于等熵声学子系统的对称正定对称化子，以及在 $x=L$ 处指向正 $x$ 方向的边界法向，确定当 $0  u_{0}  c_{0}$ 时，哪个特征在 $x=L$ 处是入射的。然后，为了在弱变分形式中构建一个无反射特征边界条件，请将在 $x=L$ 处的入射特征组合表示为原始变量 $p'$ 和 $u'$ 的单个线性表达式。\n\n你的最终答案必须是那个单一的解析表达式，其中所有符号如上文所定义。不要提供不等式或方程；仅提供在指定的亚音速区域中，$x=L$ 处对应于入射特征的 $p'$ 和 $u'$ 的显式线性组合。",
            "solution": "首先验证该问题，以确保其科学上合理、内容自洽且适定。\n\n**步骤 1：提取已知条件**\n-   **系统**：关于小扰动 $(p', u')$ 的线性化等熵欧拉方程。\n-   **方程**：\n    $$\n    p'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0\n    $$\n    $$\n    u'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0\n    $$\n-   **定义域**：$x \\in (0,L)$ 和 $t \\ge 0$。\n-   **平均态**：均匀态，具有恒定密度 $\\rho_{0}  0$、恒定压力 $p_{0}  0$、恒定流速 $u_{0}  0$ 和恒定声速 $c_{0}  0$。\n-   **流动状态**：亚音速平均流，$0  u_{0}  c_{0}$。\n-   **等熵闭合**：$c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$，其中 $\\gamma  1$。\n-   **目标**：在右边界 $x=L$ 处，识别入射特征并将其表示为 $p'$ 和 $u'$ 的线性组合。\n\n**步骤 2：验证**\n该问题具有科学依据，因为它涉及线性化欧拉方程，这是流体动力学和声学中的一个标准模型。特征分解和无反射边界条件的概念是双曲型偏微分方程理论和数值解法的基础。所有术语都有明确定义，且问题在数学上是自洽和客观的。不存在矛盾、缺失数据或不科学的前提。\n\n**步骤 3：结论**\n该问题有效。\n\n**求解推导**\n所给的偏微分方程组可以表示为矩阵-向量形式。设状态向量为 $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$。方程组可写为：\n$$\n\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}\n$$\n其中系数矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} = \\begin{pmatrix} u_{0}  \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}}  u_{0} \\end{pmatrix}\n$$\n通过求解矩阵 $\\mathbf{A}$ 的特征值和特征向量来分析该系统的双曲性质。特征值，记为 $\\lambda$，代表波传播的特征速度。它们通过求解特征方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$ 来找到，其中 $\\mathbf{I}$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} u_{0}-\\lambda  \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}}  u_{0}-\\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到：\n$$\n(u_{0} - \\lambda)^{2} - \\left(\\rho_{0} c_{0}^{2}\\right) \\left(\\frac{1}{\\rho_{0}}\\right) = 0\n$$\n$$\n(u_{0} - \\lambda)^{2} - c_{0}^{2} = 0\n$$\n$$\nu_{0} - \\lambda = \\pm c_{0}\n$$\n这得到了两个不同的实特征值，证实了该系统是严格双曲的：\n$$\n\\lambda_{1} = u_{0} + c_{0}\n$$\n$$\n\\lambda_{2} = u_{0} - c_{0}\n$$\n问题要求解在右边界 $x=L$ 处的入射特征。在此边界，向外的法向量指向正 $x$ 方向。如果一个特征对应的波传播到计算域内部，即它沿负 $x$ 方向传播，则该特征被定义为“入射”的。因此，入射特征与负特征值 $\\lambda  0$ 相关联。\n\n给定平均流是亚音速的，即 $0  u_{0}  c_{0}$。我们可以根据此条件判断每个特征值的符号：\n-   对于 $\\lambda_{1} = u_{0} + c_{0}$：因为 $u_{0}  0$ 且 $c_{0}  0$，所以 $\\lambda_{1}  0$。这对应一个出射特征。与该波相关的信息在 $x=L$ 处传播出计算域。\n-   对于 $\\lambda_{2} = u_{0} - c_{0}$：因为 $u_{0}  c_{0}$，所以 $\\lambda_{2}  0$。这对应一个入射特征。与该波相关的信息在 $x=L$ 处传入计算域。\n\n一个基于物理的无反射边界条件要求指定任何入射特征的幅值。问题要求用原始变量 $p'$ 和 $u'$ 来表示这个入射特征组合的表达式。该表达式通过确定与特征值 $\\lambda_{2}$ 对应的左特征向量 $\\mathbf{l}_{2}^{T}$ 来找到。\n\n设 $\\mathbf{l}_{2}^{T} = \\begin{pmatrix} l_{a}  l_{b} \\end{pmatrix}$ 是 $\\lambda_{2}$ 的左特征向量。它必须满足 $\\mathbf{l}_{2}^{T} \\mathbf{A} = \\lambda_{2} \\mathbf{l}_{2}^{T}$。\n$$\n\\begin{pmatrix} l_{a}  l_{b} \\end{pmatrix} \\begin{pmatrix} u_{0}  \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}}  u_{0} \\end{pmatrix} = (u_{0} - c_{0}) \\begin{pmatrix} l_{a}  l_{b} \\end{pmatrix}\n$$\n这个矩阵方程产生一个关于 $l_{a}$ 和 $l_{b}$ 的两个线性代数方程组：\n1.  $l_{a} u_{0} + l_{b} \\frac{1}{\\rho_{0}} = l_{a} (u_{0} - c_{0}) \\implies \\frac{l_{b}}{\\rho_{0}} = -l_{a} c_{0} \\implies l_{b} = - \\rho_{0} c_{0} l_{a}$\n2.  $l_{a} \\rho_{0} c_{0}^{2} + l_{b} u_{0} = l_{b} (u_{0} - c_{0}) \\implies l_{a} \\rho_{0} c_{0}^{2} = -l_{b} c_{0} \\implies l_{a} \\rho_{0} c_{0} = -l_{b}$\n\n两个方程给出相同的关系，$l_{b} = - \\rho_{0} c_{0} l_{a}$。我们可以选择一个方便的缩放比例，例如，$l_{a}=1$。那么 $l_{b} = -\\rho_{0} c_{0}$。左特征向量为：\n$$\n\\mathbf{l}_{2}^{T} = \\begin{pmatrix} 1  -\\rho_{0} c_{0} \\end{pmatrix}\n$$\n特征变量，或称“特征组合”$W_{2}$，是通过将状态向量 $\\mathbf{q}$ 投影到左特征向量 $\\mathbf{l}_{2}^{T}$ 上得到的：\n$$\nW_{2} = \\mathbf{l}_{2}^{T} \\mathbf{q} = \\begin{pmatrix} 1  -\\rho_{0} c_{0} \\end{pmatrix} \\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = p' - \\rho_{0} c_{0} u'\n$$\n这个表达式 $p' - \\rho_{0} c_{0} u'$ 是对应于亚音速出流边界 $x=L$ 处的入射特征的线性组合。这就是构建一个适定的无反射边界条件所必须指定的量。问题陈述中提到的能量法为这一过程提供了严格的论证，因为它识别出哪些特征模态对边界能量通量有负贡献，因此需要通过边界条件进行控制以确保稳定性。上述基于通量雅可比矩阵 $\\mathbf{A}$ 的特征值符号的分析，直接识别了这些模态。",
            "answer": "$$\n\\boxed{p' - \\rho_{0} c_{0} u'}\n$$"
        }
    ]
}