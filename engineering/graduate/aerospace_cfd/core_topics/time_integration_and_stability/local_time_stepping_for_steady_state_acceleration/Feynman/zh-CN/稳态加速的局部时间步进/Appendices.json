{
    "hands_on_practices": [
        {
            "introduction": "要掌握局部时间步进（LTS），第一步是理解如何为单个网格单元确定其自身允许的最大稳定时间步长。这个过程源于计算流体力学中一个最基本的稳定性准则——Courant–Friedrichs–Lewy (CFL) 条件。本练习  将指导您从半离散守恒律方程出发，推导出适用于非结构网格中任意单元的局部时间步长计算公式，并将其应用于一个具体的四边形单元。通过这个实践，您将深刻理解单元的几何形状（体积、面长）和局部波速是如何共同决定其在定常计算中的“前进速度”的。",
            "id": "3974157",
            "problem": "在二维可压缩计算流体动力学 (CFD) 中，考虑一种用于在非结构网格上加速收敛至稳态的有限体积、显式伪时间推进方法。一个索引为 $i$ 的单一控制体（单元）具有一个由索引为 $f$ 的面组成的多边形边界，每个面都有外法向单位矢量、面元尺度，以及通过迎风线性化计算的数值通量，该线性化的雅可比矩阵沿面法向的最大特征速度大小表示为 $|\\lambda_{f}|$。对于前向欧拉伪时间更新的稳定性，通过选择一个单元伪时间步长 $\\Delta t_{i}$ 来强制执行局部的 Courant–Friedrichs–Lewy (CFL) 约束。\n\n从一般双曲系统的半离散有限体积守恒形式出发，并根据显式更新在线性化离散算子的谱半径界下必须稳定的要求，推导 $\\Delta t_{i}$ 的单元局部稳定性限制，用单元体积 $V_{i}$、面元尺度 $A_{f}$ 和面法向特征速度大小 $|\\lambda_{f}|$ 表示。然后，为以下非结构四边形单元计算 $\\Delta t_{i}$。\n\n该单元的顶点按逆时针顺序排列如下：\n- $P_{1} = (0, 0)$，\n- $P_{2} = (1.2, 0.1)$，\n- $P_{3} = (1.0, 0.9)$，\n- $P_{4} = (-0.1, 0.8)$。\n\n使用多边形面积公式计算 $V_{i}$，并使用连续顶点之间的欧几里得距离计算面 $(P_{1},P_{2})$、$(P_{2},P_{3})$、$(P_{3},P_{4})$ 和 $(P_{4},P_{1})$ 的面元尺度 $A_{f}$。给定的面法向最大特征速度大小为：\n- $|\\lambda_{(P_{1},P_{2})}| = 290~\\text{m/s}$，\n- $|\\lambda_{(P_{2},P_{3})}| = 260~\\text{m/s}$，\n- $|\\lambda_{(P_{3},P_{4})}| = 300~\\text{m/s}$，\n- $|\\lambda_{(P_{4},P_{1})}| = 250~\\text{m/s}$。\n\n设 CFL 数为 $\\mathrm{CFL} = 0.7$。使用推导出的限制条件计算 $\\Delta t_{i}$。最终答案以秒为单位，并将数值结果四舍五入至四位有效数字。",
            "solution": "该问题要求分为两部分：第一部分是推导在非结构网格上的显式有限体积格式的局部时间步长限制，第二部分是为一个特定的四边形单元计算此时间步长。\n\n**第一部分：局部时间步长限制的推导**\n\n我们从控制体（单元）$V_i$ 上的双曲守恒律方程组的积分形式开始：\n$$ \\frac{d}{dt} \\int_{V_i} \\mathbf{U} \\, dV + \\oint_{\\partial V_i} \\mathbf{F} \\cdot \\mathbf{n} \\, dA = \\mathbf{0} $$\n其中 $\\mathbf{U}$ 是守恒状态变量矢量，$\\mathbf{F}$ 是通量张量，$\\mathbf{n}$ 是边界 $\\partial V_i$ 的外法向单位矢量。\n\n在有限体积法中，我们考虑单元平均状态矢量 $\\mathbf{U}_i = \\frac{1}{V_i} \\int_{V_i} \\mathbf{U} \\, dV$。方程的半离散形式通过将边界积分近似为单元各面上的数值通量之和得到：\n$$ V_i \\frac{d\\mathbf{U}_i}{dt} = - \\sum_{f \\in \\partial V_i} \\mathcal{F}_f A_f = \\mathbf{R}_i(\\mathbf{U}) $$\n在这里，$V_i$ 是单元 $i$ 的体积（在二维中是面积），$A_f$ 是面 $f$ 的尺度（在二维中是长度），$\\mathcal{F}_f$ 是垂直于面 $f$ 的数值通量矢量，$\\mathbf{R}_i(\\mathbf{U})$ 是单元 $i$ 的离散残差。\n\n为了加速向稳态收敛，使用了伪时间推进。一个简单的一阶显式前向欧拉格式由下式给出：\n$$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n + \\frac{\\Delta t_i}{V_i} \\mathbf{R}_i(\\mathbf{U}^n) = \\mathbf{U}_i^n - \\frac{\\Delta t_i}{V_i} \\sum_{f \\in \\partial V_i} \\mathcal{F}_f A_f $$\n其中 $\\Delta t_i$ 是单元 $i$ 的局部伪时间步长。\n\n该显式格式的稳定性由迭代矩阵的谱半径决定。对于分隔单元 $i$ 和 $j$ 的面 $f$ 上的迎风类格式（如 Roe 的近似黎曼求解器），数值通量 $\\mathcal{F}_f$ 可以用在适当的界面状态下求值的通量雅可比矩阵 $\\mathbf{A}_{n,f} = \\frac{\\partial(\\mathbf{F} \\cdot \\mathbf{n}_f)}{\\partial \\mathbf{U}}$ 来表示。整个系统的稳定性分析是复杂的。一种常见且实用的方法是强制执行一个基于物理依赖域的条件，这通常通过考虑 Courant–Friedrichs–Lewy (CFL) 条件的矩阵版本来推导。\n\n$\\mathbf{U}_i$ 的更新取决于其自身的状态及其相邻单元的状态。对 $\\Delta t_i$ 的稳定性限制源于确保更新规则中乘以 $\\mathbf{U}_i^n$ 的系数矩阵不会导致误差放大。相邻单元的影响以特征速度传播到单元 $i$ 中。垂直于面 $f$ 的最快速度由 $|\\lambda_f|$ 给出，它是面法向通量雅可比矩阵的谱半径，即 $\\rho(\\mathbf{A}_{n,f})$。\n\n对于应用到空间算子谱半径为 $\\rho(\\mathbf{L}_i)$ 的系统的前向欧拉格式，其稳定性判据是 $\\Delta t_i \\rho(\\mathbf{L}_i) \\le \\mathrm{CFL_{max}}$。对于有限体积算子，单元 $i$ 的谱半径的估计值由其所有面影响的总和构成：\n$$ \\rho(\\mathbf{L}_i) \\approx \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} \\rho(\\mathbf{A}_{n,f}) A_f = \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} |\\lambda_f| A_f $$\n该估计基于这样一种思想：在一个时间步内，信息穿过面 $f$ 的距离为 $|\\lambda_f|\\Delta t_i$。进入单元的总“信息通量”必须相对于单元的“容量”（即其体积 $V_i$）受到限制。\n\n将此谱半径估计值代入稳定性条件，得到：\n$$ \\Delta t_i \\left( \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} |\\lambda_f| A_f \\right) \\le \\mathrm{CFL} $$\n题目给出了一个期望的 CFL 数，因此我们重新整理以求得最大允许的局部时间步长 $\\Delta t_i$：\n$$ \\Delta t_i \\le \\frac{\\mathrm{CFL} \\cdot V_i}{\\sum_{f \\in \\partial V_i} |\\lambda_f| A_f} $$\n为最大化收敛速度，使用等式：\n$$ \\Delta t_i = \\mathrm{CFL} \\frac{V_i}{\\sum_{f \\in \\partial V_i} |\\lambda_f| A_f} $$\n这就是推导出的单元局部稳定性限制。\n\n**第二部分：特定单元的计算**\n\n我们将推导出的公式应用于给定的四边形单元。所需的量是单元面积 $V_i$、面元长度 $A_f$、特征速度 $|\\lambda_f|$ 和 CFL 数。\n\n**给定数据：**\n- 顶点：$P_1 = (0, 0)$, $P_2 = (1.2, 0.1)$, $P_3 = (1.0, 0.9)$, $P_4 = (-0.1, 0.8)$。\n- 速度：$|\\lambda_1| = |\\lambda_{(P_1,P_2)}| = 290$, $|\\lambda_2| = |\\lambda_{(P_2,P_3)}| = 260$, $|\\lambda_3| = |\\lambda_{(P_3,P_4)}| = 300$, $|\\lambda_4| = |\\lambda_{(P_4,P_1)}| = 250$。\n- CFL 数：$\\mathrm{CFL} = 0.7$。\n\n**步骤1：计算单元面积 $V_i$**\n使用鞋带公式计算顶点为 $(x_1, y_1), \\dots, (x_4, y_4)$ 的多边形面积：\n$$ V_i = \\frac{1}{2} | (x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1) | $$\n$$ V_i = \\frac{1}{2} | \\left(0 \\cdot 0.1 + 1.2 \\cdot 0.9 + 1.0 \\cdot 0.8 + (-0.1) \\cdot 0\\right) - \\left(0 \\cdot 1.2 + 0.1 \\cdot 1.0 + 0.9 \\cdot (-0.1) + 0.8 \\cdot 0\\right) | $$\n$$ V_i = \\frac{1}{2} | (0 + 1.08 + 0.8 + 0) - (0 + 0.1 - 0.09 + 0) | $$\n$$ V_i = \\frac{1}{2} | 1.88 - 0.01 | = \\frac{1.87}{2} = 0.935 $$\n\n**步骤2：计算面元长度 $A_f$**\n$A_f$ 的长度是连续顶点之间的欧几里得距离。\n- 面 1 ($P_1 \\to P_2$): $A_1 = \\sqrt{(1.2 - 0)^2 + (0.1 - 0)^2} = \\sqrt{1.44 + 0.01} = \\sqrt{1.45}$。\n- 面 2 ($P_2 \\to P_3$): $A_2 = \\sqrt{(1.0 - 1.2)^2 + (0.9 - 0.1)^2} = \\sqrt{(-0.2)^2 + (0.8)^2} = \\sqrt{0.04 + 0.64} = \\sqrt{0.68}$。\n- 面 3 ($P_3 \\to P_4$): $A_3 = \\sqrt{(-0.1 - 1.0)^2 + (0.8 - 0.9)^2} = \\sqrt{(-1.1)^2 + (-0.1)^2} = \\sqrt{1.21 + 0.01} = \\sqrt{1.22}$。\n- 面 4 ($P_4 \\to P_1$): $A_4 = \\sqrt{(0 - (-0.1))^2 + (0 - 0.8)^2} = \\sqrt{(0.1)^2 + (-0.8)^2} = \\sqrt{0.01 + 0.64} = \\sqrt{0.65}$。\n\n**步骤3：计算分母 $\\sum_{f} |\\lambda_f| A_f$**\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f = |\\lambda_1|A_1 + |\\lambda_2|A_2 + |\\lambda_3|A_3 + |\\lambda_4|A_4 $$\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f = 290\\sqrt{1.45} + 260\\sqrt{0.68} + 300\\sqrt{1.22} + 250\\sqrt{0.65} $$\n对各项进行数值计算：\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f \\approx 290(1.204159) + 260(0.824621) + 300(1.104536) + 250(0.806226) $$\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f \\approx 349.2061 + 214.4015 + 331.3608 + 201.5565 \\approx 1096.5249 $$\n\n**步骤4：计算局部时间步长 $\\Delta t_i$**\n$$ \\Delta t_i = \\mathrm{CFL} \\frac{V_i}{\\sum_{f} |\\lambda_f| A_f} = 0.7 \\times \\frac{0.935}{1096.5249} $$\n$$ \\Delta t_i \\approx 0.7 \\times 0.000852701 \\approx 0.0005968907 $$\n\n**步骤5：对结果进行四舍五入**\n结果必须四舍五入至四位有效数字。\n$$ \\Delta t_i \\approx 0.0005969~\\text{s} $$\n用科学记数法表示，即为 $5.969 \\times 10^{-4}~\\text{s}$。",
            "answer": "$$\\boxed{5.969 \\times 10^{-4}}$$"
        },
        {
            "introduction": "在真实的航空航天应用中，我们处理的流动通常具有粘性，需要通过求解Navier-Stokes方程来模拟。粘性项的引入在数值上带来了新的挑战，因为它引入了扩散（抛物线型）稳定性约束，这通常比对流（双曲线型）约束更为严格。本练习  旨在让您掌握如何处理这种混合了对流和扩散效应的复杂情况。您将推导一个统一的时间步长约束，该约束同时考虑了由波传播速度决定的对流限制和由运动粘度、热导率等决定的扩散限制，并计算出最终的允许时间步长。",
            "id": "3974120",
            "problem": "考虑以守恒形式写出的二维可压缩纳维-斯托克斯方程，该方程应用于面积为 $A$、边长为 $\\Delta x$ 和 $\\Delta y$ 的控制体。采用显式有限体积 (FV) 离散化方法，每个面的数值通量由两部分组成：一部分是通过局部Lax–Friedrichs (LLF，也称为Rusanov) 通量计算的无粘对流贡献，另一部分是通过中心梯度计算的粘性扩散贡献。在单位法向量为 $\\boldsymbol{n}$ 的面上，无粘LLF通量的耗散与局部谱半径 $\\lambda_{f}$ 成正比。对于可压缩流，一个标准的上界是 $\\lambda_{f} = |\\boldsymbol{u}\\cdot\\boldsymbol{n}| + a$，其中 $a$ 是局部声速，$\\boldsymbol{u}$ 是局部速度。粘性通量涉及动力粘度 $\\mu$ 和热导率 $\\kappa$；其显式处理引入了一个抛物线型稳定性约束，该约束由输运模态中的最大扩散率决定，此处取为 $\\alpha_{\\max} = \\max\\left(\\nu, \\kappa/(\\rho c_{p})\\right)$，其中 $\\nu = \\mu/\\rho$ 是运动粘度，$\\rho$ 是密度， $c_{p}$ 是定压比热。\n\n从单元上的半离散守恒律和显式前向欧拉时间更新出发，运用稳定性第一原理（要求在由通量引起的离散算子作用下，更新过程保持为收缩映射），推导出一个守恒的局部显式时间步长约束，该约束同时考虑了对流（双曲）和扩散（抛物）的贡献。组合这些约束，使得单一的最紧约束控制时间步长。然后，对于下面给出的特定单元和状态，计算允许的局部时间步长，用于采用局部时间步进 (LTS) 稳态加速方法，并给定一个Courant–Friedrichs–Lewy (CFL) 数：\n- 单元尺寸：$\\Delta x = 4.0 \\times 10^{-3}~\\text{m}$，$\\Delta y = 2.0 \\times 10^{-3}~\\text{m}$。\n- 局部分速度分量：$u = 120~\\text{m/s}$，$v = 30~\\text{m/s}$。\n- 热力学和输运性质：$\\gamma = 1.4$，$R = 287~\\text{J/(kg}\\cdot\\text{K)}$，$T = 300~\\text{K}$，$\\rho = 0.8~\\text{kg/m}^3$，$\\mu = 1.8 \\times 10^{-5}~\\text{Pa}\\cdot\\text{s}$，$\\kappa = 0.026~\\text{W/(m}\\cdot\\text{K)}$，$c_p = 1005~\\text{J/(kg}\\cdot\\text{K)}$。\n- 使用 $a = \\sqrt{\\gamma R T}$ 计算声速。\n- 使用 $\\alpha_{\\max} = \\max(\\nu, \\kappa/(\\rho c_{p}))$，其中 $\\nu = \\mu/\\rho$。\n- 用于LTS的给定Courant–Friedrichs–Lewy (CFL) 数：$\\text{CFL} = 0.70$。\n\n以秒为单位表示最终的时间步长，并将答案四舍五入到四位有效数字。",
            "solution": "本问题要求为一个使用显式有限体积方法的二维可压缩纳维-斯托克斯模拟推导局部时间步长约束。然后必须针对特定的单元和流动状态计算其最终值。\n\n首先，我们为稳定性约束建立理论基础。对于一个在空间上离散的通用守恒律系统，给定单元 $i$ 的半离散形式为：\n$$\n\\frac{d\\boldsymbol{W}_i}{dt} = \\mathcal{R}(\\boldsymbol{W})\n$$\n其中 $\\boldsymbol{W}_i$ 是单元 $i$ 中的守恒变量向量，$\\mathcal{R}(\\boldsymbol{W})$ 是离散残差算子，表示流入该单元的净通量。对于一个显式前向欧拉时间积分格式，更新过程如下：\n$$\n\\boldsymbol{W}_i^{n+1} = \\boldsymbol{W}_i^n + \\Delta t \\mathcal{R}(\\boldsymbol{W}^n)\n$$\n为使此格式稳定，时间步长 $\\Delta t$ 必须受到限制，以使更新过程保持为收缩映射。这导致了对残差雅可比矩阵 $\\boldsymbol{J}_{\\mathcal{R}}$ 的谱半径（最大特征值模） $\\rho(\\boldsymbol{J}_{\\mathcal{R}})$ 的一个条件：\n$$\n\\Delta t \\le \\frac{C}{\\rho(\\boldsymbol{J}_{\\mathcal{R}})}\n$$\n其中 $C$ 是一个取决于具体格式的常数，对于双曲问题，通常等同于Courant–Friedrichs–Lewy (CFL) 数。\n\n残差算子 $\\mathcal{R}$ 是无粘（对流）通量和粘性（扩散）通量贡献的总和。根据矩阵范数的三角不等式，组合算子的雅可比矩阵的谱半径可以被保守地限制为各个雅可比矩阵谱半径之和：\n$$\n\\rho(\\boldsymbol{J}_{\\mathcal{R}}) \\le \\rho(\\boldsymbol{J}_{\\text{adv}}) + \\rho(\\boldsymbol{J}_{\\text{diff}})\n$$\n这使我们能够通过将与每个物理过程相关的时间尺度的倒数相加，来构建一个组合的稳定性约束。\n\n让我们推导面积为 $A=\\Delta x \\Delta y$ 的矩形单元的各个约束。\n\n1.  **对流（双曲）约束：**\n    通量的对流部分使用局部Lax-Friedrichs (LLF) 格式进行离散化。这种显式格式的稳定性受到信息穿过单元传播速度的限制。对于二维笛卡尔网格，x和y方向通量的贡献在稳定性约束中是相加的。对于x方向上使用LLF通量的一维欧拉方程，其谱半径与 $\\frac{\\lambda_x}{\\Delta x}$ 成正比，其中 $\\lambda_x$ 是该方向上的最大波速。根据问题描述，$\\lambda_f = |\\boldsymbol{u}\\cdot\\boldsymbol{n}| + a$。\n    对于x方向，面法向量为 $\\boldsymbol{n}=(1,0)$，所以 $\\lambda_x = |u| + a$。\n    对于y方向，面法向量为 $\\boldsymbol{n}=(0,1)$，所以 $\\lambda_y = |v| + a$。\n    因此，二维单元的组合双曲谱半径可近似为一维贡献之和：\n    $$\n    \\rho(\\boldsymbol{J}_{\\text{adv}}) \\approx \\frac{\\lambda_x}{\\Delta x} + \\frac{\\lambda_y}{\\Delta y} = \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y}\n    $$\n    相应的包含给定CFL数的时间步长限制为 $\\Delta t_{adv} = \\text{CFL} / \\rho(\\boldsymbol{J}_{\\text{adv}})$。\n\n2.  **扩散（抛物）约束：**\n    粘性项的行为类似于扩散方程或热方程。二维拉普拉斯算子 $\\nabla^2$ 的显式中心差分离散在以下条件下是稳定的：\n    $$\n    \\Delta t \\le \\frac{1}{2 \\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n    $$\n    其中 $\\alpha$ 是扩散率。问题指出，此约束由输运模态中的最大扩散率 $\\alpha_{\\max}$ 决定。因此，扩散算子的谱半径为：\n    $$\n    \\rho(\\boldsymbol{J}_{\\text{diff}}) \\approx 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)\n    $$\n    注意，CFL数是双曲系统的一个惯例，通常不以相同的方式应用于此抛物线型约束。因子 $1/2$ 是数值格式本身稳定性极限所固有的。\n\n3.  **组合约束：**\n    结合这两个贡献，总的局部时间步长 $\\Delta t_{local}$ 受到谱半径之和的限制：\n    $$\n    \\Delta t_{local} \\le \\frac{\\text{CFL}}{\\rho(\\boldsymbol{J}_{\\text{adv}}) + \\rho(\\boldsymbol{J}_{\\text{diff}})}\n    $$\n    问题要求一个组合约束的表达式，此公式直接满足了该要求。我们将给定的CFL数解释为整个算子的缩放因子 $C$。在CFD求解器中，一个常见的做法是使用CFL数来缩放整个时间步长倒数之和。\n    $$\n    \\Delta t_{local} = \\text{CFL} \\left[ \\left( \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y} \\right) + 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\right]^{-1}\n    $$\n    这就是我们将要使用的保守的、组合的局部时间步长公式。\n\n现在，我们使用所提供的数据计算数值。\n-   单元尺寸：$\\Delta x = 4.0 \\times 10^{-3}~\\text{m}$，$\\Delta y = 2.0 \\times 10^{-3}~\\text{m}$。\n-   速度分量：$u = 120~\\text{m/s}$，$v = 30~\\text{m/s}$。所以 $|u| = 120~\\text{m/s}$ 且 $|v| = 30~\\text{m/s}$。\n-   热力学和输运性质：$\\gamma = 1.4$，$R = 287~\\text{J/(kg}\\cdot\\text{K)}$，$T = 300~\\text{K}$，$\\rho = 0.8~\\text{kg/m}^3$，$\\mu = 1.8 \\times 10^{-5}~\\text{Pa}\\cdot\\text{s}$，$\\kappa = 0.026~\\text{W/(m}\\cdot\\text{K)}$，$c_p = 1005~\\text{J/(kg}\\cdot\\text{K)}$。\n-   给定的CFL数：$\\text{CFL} = 0.70$。\n\n首先，我们计算必要的中间量。\n-   **声速 ($a$):**\n    $a = \\sqrt{\\gamma R T} = \\sqrt{1.4 \\times 287 \\times 300} = \\sqrt{120540} \\approx 347.1887~\\text{m/s}$。\n-   **运动粘度 ($\\nu$):**\n    $\\nu = \\frac{\\mu}{\\rho} = \\frac{1.8 \\times 10^{-5}}{0.8} = 2.25 \\times 10^{-5}~\\text{m}^2/\\text{s}$。\n-   **热扩散率 ($\\alpha_T$):**\n    $\\alpha_T = \\frac{\\kappa}{\\rho c_{p}} = \\frac{0.026}{0.8 \\times 1005} = \\frac{0.026}{804} \\approx 3.2338 \\times 10^{-5}~\\text{m}^2/\\text{s}$。\n-   **最大扩散率 ($\\alpha_{\\max}$):**\n    $\\alpha_{\\max} = \\max(\\nu, \\alpha_T) = \\max(2.25 \\times 10^{-5}, 3.2338 \\times 10^{-5}) = 3.2338 \\times 10^{-5}~\\text{m}^2/\\text{s}$。\n\n接下来，我们计算 $\\Delta t_{local}$ 表达式分母中的两项。\n-   **对流项贡献 ($S_{adv}$):**\n    $$\n    S_{adv} = \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y} = \\frac{120 + 347.1887}{4.0 \\times 10^{-3}} + \\frac{30 + 347.1887}{2.0 \\times 10^{-3}}\n    $$\n    $$\n    S_{adv} = \\frac{467.1887}{4.0 \\times 10^{-3}} + \\frac{377.1887}{2.0 \\times 10^{-3}} = 116797.175 + 188594.35 = 305391.525~\\text{s}^{-1}\n    $$\n-   **扩散项贡献 ($S_{diff}$):**\n    $$\n    S_{diff} = 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) = 2(3.2338 \\times 10^{-5}) \\left( \\frac{1}{(4.0 \\times 10^{-3})^2} + \\frac{1}{(2.0 \\times 10^{-3})^2} \\right)\n    $$\n    $$\n    S_{diff} = 6.4676 \\times 10^{-5} \\left( \\frac{1}{1.6 \\times 10^{-5}} + \\frac{1}{4.0 \\times 10^{-6}} \\right) = 6.4676 \\times 10^{-5} (62500 + 250000)\n    $$\n    $$\n    S_{diff} = 6.4676 \\times 10^{-5} (312500) = 20.21125~\\text{s}^{-1}\n    $$\n\n最后，我们计算总的局部时间步长 $\\Delta t_{local}$。\n$$\n\\Delta t_{local} = \\text{CFL} \\left[ S_{adv} + S_{diff} \\right]^{-1} = 0.70 \\left[ 305391.525 + 20.21125 \\right]^{-1}\n$$\n$$\n\\Delta t_{local} = 0.70 \\left[ 305411.73625 \\right]^{-1} \\approx 0.70 \\times (3.27429 \\times 10^{-6}) \\approx 2.292 \\times 10^{-6}~\\text{s}\n$$\n\n根据要求将结果四舍五入到四位有效数字，我们得到 $2.292 \\times 10^{-6}~\\text{s}$。",
            "answer": "$$\n\\boxed{2.292 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "局部时间步进的一个核心挑战在于，当相邻的网格单元以不同的时间步长演化时，如何保证整个计算域的严格守恒性。如果处理不当，一个单元流出的通量可能不等于相邻单元接收到的通量，从而导致质量、动量和能量的虚假产生或消失。本练习  通过一个简化的双单元系统，深入探讨了维持守恒性的关键技术。您将为一个采用不同局部时间步长的系统推导守恒更新方案，这需要在一个宏观同步步长内匹配界面通量。这个思想实验对于理解和开发稳健的LTS求解器至关重要。",
            "id": "3974175",
            "problem": "考虑一个一维、无粘性、线性的单一标量守恒量 $u(x,t)$ 的平流过程，该过程由守恒律 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( a u \\right) = 0$ 控制，其中平流速度为常数 $a > 0$。在计算流体动力学 (CFD) 的有限体积离散化中，两个相邻的控制体（单元）$\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 共享一个面积为 $A_f$ 的内部面，其单位法向量 $\\boldsymbol{n}$ 从 $\\mathcal{C}_1$ 指向 $\\mathcal{C}_2$。单元的体积分别为 $V_1$ 和 $V_2$。不存在其他面或源项；因此，守恒量的所有交换仅通过共享面发生。在伪时间 $t=0$ 时，初始的单元平均状态在 $\\mathcal{C}_1$ 中为 $u_1^0$，在 $\\mathcal{C}_2$ 中为 $u_2^0$。\n\n我们采用局部时间步进 (LTS) 来加速稳态计算。在一个持续时间为 $\\Delta T$ 的宏观步长内，$\\mathcal{C}_1$ 的局部伪时间步长为 $\\Delta t_1 = \\tau$，$\\mathcal{C}_2$ 的局部伪时间步长为 $\\Delta t_2 = 2 \\tau$，其中 $\\tau > 0$ 是给定的。因此，同步宏观步长为 $\\Delta T = 2 \\tau$。在单元更新的每个子区间内，我们使用前向欧拉有限体积法进行更新，并采用迎风数值通量计算共享面上的平流，其定义为 $F_f = a\\,u_{\\text{upwind}}$，其中 $u_{\\text{upwind}}$ 等于迎风侧的状态。因为 $a>0$，迎风侧是 $\\mathcal{C}_1$，所以在每个子区间的开始时刻，通量为 $F_f = a\\,u_1$。\n\n为保证在非均匀局部时间步长下共享面上的精确守恒，面通量的贡献在宏观步长内进行匹配：两个单元在 $\\Delta T$ 内使用相同的积分面通量。具体来说，对于 $\\mathcal{C}_1$，我们将宏观步长划分为两个子区间 $[0,\\tau]$ 和 $[\\tau,2\\tau]$，而 $\\mathcal{C}_2$ 仅在 $t=2\\tau$ 时更新。在每个子区间上，面通量被视为分段常数，并使用该子区间开始时的迎风状态进行评估。在 $\\Delta T$ 上的积分面通量随后被用于在 $t=2\\tau$ 时更新一次 $\\mathcal{C}_2$，以确保流入 $\\mathcal{C}_2$ 的量等于流出 $\\mathcal{C}_1$ 的量。\n\n从守恒律和有限体积更新的定义出发，根据上述匹配面通量贡献的描述，推导在宏观步长 $\\Delta T = 2\\tau$ 内应用于 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 单元平均状态的守恒净更新量 $\\Delta u_1$ 和 $\\Delta u_2$。将你的最终答案表示为关于 $A_f$、$V_1$、$V_2$、$a$、$\\tau$ 和 $u_1^0$ 的闭式解析表达式。你可以假设在每个子区间内，面通量仅取决于迎风状态 $u_1$，并且 $\\mathcal{C}_2$ 不在宏观步长中间进行更新。请提供序对 $\\left( \\Delta u_1, \\Delta u_2 \\right)$ 作为你的最终答案。不需要四舍五入，最终答案中也不应包含单位。",
            "solution": "用户希望在一个使用局部时间步进 (LTS) 方案的双单元系统中，求出单元平均量的净更新量。\n\n### 第 1 步：提取已知条件\n- **控制方程**：$\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( a u \\right) = 0$，其中平流速度为常数 $a > 0$。\n- **单元**：两个相邻的控制体，$\\mathcal{C}_1$ 和 $\\mathcal{C}_2$，体积分别为 $V_1$ 和 $V_2$。\n- **面**：一个共享面，面积为 $A_f$，法向量从 $\\mathcal{C}_1$ 指向 $\\mathcal{C}_2$。\n- **初始条件**：在 $t=0$ 时，单元平均状态为 $u_1(0) = u_1^0$ 和 $u_2(0) = u_2^0$。\n- **时间步进**：\n    - 宏观步长持续时间：$\\Delta T = 2\\tau$。\n    - $\\mathcal{C}_1$ 的局部时间步长：$\\Delta t_1 = \\tau$。$\\mathcal{C}_1$ 在 $[0, \\tau]$ 和 $[\\tau, 2\\tau]$ 上更新。\n    - $\\mathcal{C}_2$ 的局部时间步长：$\\Delta t_2 = 2\\tau$。$\\mathcal{C}_2$ 在宏观步长结束时更新一次。\n- **数值格式**：\n    - 离散化：有限体积法。\n    - 时间积分：前向欧拉法。\n    - 通量函数：迎风数值通量，$F_f = a\\,u_{\\text{upwind}}$。由于 $a > 0$，迎风状态来自 $\\mathcal{C}_1$，因此 $F_f = a u_1$。\n- **通量计算**：面通量是分段常数，使用每个子区间开始时迎风单元（$\\mathcal{C}_1$）的状态进行计算。\n- **守恒约束**：在宏观步长 $\\Delta T$ 内，跨面传递的总通量是守恒的。流出 $\\mathcal{C}_1$ 的积分通量等于流入 $\\mathcal{C}_2$ 的积分通量。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一种用于CFD中基本偏微分方程（线性平流方程）的标准数值方法（带LTS的有限体积法）。术语和概念——如迎风通量、前向欧拉法和守恒通量匹配——都是该领域的标准。问题设定是自洽的，并为更新单元状态提供了清晰、确定性的程序。该问题是适定的、客观的，没有歧义、矛盾或非科学性的主张。满足有效问题的所有标准。\n\n### 第 3 步：结论与行动\n问题有效。将提供详细的解答。\n\n### 解题推导\n\n将有限体积法应用于控制体 $\\mathcal{C}_i$（体积为 $V_i$）的守恒律 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial (au)}{\\partial x} = 0$，得到单元平均状态 $u_i$ 的半离散常微分方程：\n$$ V_i \\frac{d u_i}{dt} + \\sum_{f \\in \\partial \\mathcal{C}_i} F_f A_f (\\boldsymbol{v} \\cdot \\boldsymbol{n})_f = 0 $$\n对于我们的一维问题，在 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 之间只有一个面，且法向量 $\\boldsymbol{n}$ 从 $\\mathcal{C}_1$ 指向 $\\mathcal{C}_2$，则 $u_1$ 和 $u_2$ 的方程为：\n$$ V_1 \\frac{d u_1}{dt} = -F_f A_f $$\n$$ V_2 \\frac{d u_2}{dt} = +F_f A_f $$\n此处，$F_f = a u_1$ 因为 $a>0$ (迎风格式) 并且流动方向是从 $\\mathcal{C}_1$ 到 $\\mathcal{C}_2$。通用单元更新的前向欧拉时间推进格式为 $u_i^{n+1} = u_i^n + \\frac{\\Delta t}{V_i} (\\text{流入单元的净通量})$。\n\n#### 单元 $\\mathcal{C}_1$ 的更新\n\n单元 $\\mathcal{C}_1$ 在两个持续时间均为 $\\tau$ 的子区间上演化。\n\n**第一个子区间：$t \\in [0, \\tau]$**\n更新使用的时间步长为 $\\Delta t_1 = \\tau$。在此区间内通量是恒定的，由初始时刻 $t=0$ 的状态决定。\n状态为 $u_1(0) = u_1^0$。\n流出 $\\mathcal{C}_1$ 的通量为 $F_f A_f = (a u_1(0)) A_f = a A_f u_1^0$。\n在此子区间末尾，$t=\\tau$ 时 $\\mathcal{C}_1$ 的状态为：\n$$ u_1(\\tau) = u_1(0) - \\frac{\\tau}{V_1} (a A_f u_1(0)) = u_1^0 - \\frac{a A_f \\tau}{V_1} u_1^0 $$\n$$ u_1(\\tau) = u_1^0 \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right) $$\n\n**第二个子区间：$t \\in [\\tau, 2\\tau]$**\n再次使用时间步长 $\\Delta t_1 = \\tau$ 进行更新。通量由该区间开始时刻 $t=\\tau$ 的状态决定。\n状态为 $u_1(\\tau)$。\n流出 $\\mathcal{C}_1$ 的通量为 $F_f A_f = (a u_1(\\tau)) A_f$。\n在宏观步长末尾，$t=2\\tau$ 时 $\\mathcal{C}_1$ 的状态为：\n$$ u_1(2\\tau) = u_1(\\tau) - \\frac{\\tau}{V_1} (a A_f u_1(\\tau)) = u_1(\\tau) \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right) $$\n代入 $u_1(\\tau)$ 的表达式：\n$$ u_1(2\\tau) = \\left[ u_1^0 \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right) \\right] \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right) = u_1^0 \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right)^2 $$\n\n**$\\mathcal{C}_1$ 的净更新量**\n在宏观步长 $\\Delta T = 2\\tau$ 内，$u_1$ 的净更新量为 $\\Delta u_1 = u_1(2\\tau) - u_1(0)$。\n$$ \\Delta u_1 = u_1^0 \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right)^2 - u_1^0 = u_1^0 \\left[ \\left( 1 - \\frac{a A_f \\tau}{V_1} \\right)^2 - 1 \\right] $$\n展开平方项：\n$$ \\Delta u_1 = u_1^0 \\left[ 1 - 2\\frac{a A_f \\tau}{V_1} + \\left(\\frac{a A_f \\tau}{V_1}\\right)^2 - 1 \\right] = u_1^0 \\left[ \\frac{a^2 A_f^2 \\tau^2}{V_1^2} - \\frac{2 a A_f \\tau}{V_1} \\right]$$\n提取公因式，得到 $\\Delta u_1$ 的最终表达式：\n$$ \\Delta u_1 = \\frac{a A_f \\tau u_1^0}{V_1} \\left( \\frac{a A_f \\tau}{V_1} - 2 \\right) $$\n\n#### 单元 $\\mathcal{C}_2$ 的更新\n\n单元 $\\mathcal{C}_2$ 仅在 $t=2\\tau$ 时使用时间步长 $\\Delta t_2 = 2\\tau$ 更新一次。守恒原理规定，在宏观步长 $\\Delta T = 2\\tau$ 内，$\\mathcal{C}_2$ 中物理量的总变化量必须等于流入其内的总积分通量。这个积分通量（记为 $J$）对应于从 $\\mathcal{C}_1$ 流出的总物理量。\n\n**积分通量计算**\n在 $[0, 2\\tau]$ 时间段内，从 $\\mathcal{C}_1$ 转移到 $\\mathcal{C}_2$ 的总通量 $J$ 是分段常数通量函数的积分：\n$$ J = \\int_0^{2\\tau} F_f(t) A_f dt = \\int_0^{\\tau} F_f(t) A_f dt + \\int_{\\tau}^{2\\tau} F_f(t) A_f dt $$\n- 对于 $t \\in [0, \\tau]$，有 $F_f(t) A_f = a A_f u_1(0) = a A_f u_1^0$。\n- 对于 $t \\in [\\tau, 2\\tau]$，有 $F_f(t) A_f = a A_f u_1(\\tau) = a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau}{V_1}\\right)$。\n$$ J = (a A_f u_1^0) \\int_0^{\\tau} dt + \\left(a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau}{V_1}\\right)\\right) \\int_{\\tau}^{2\\tau} dt $$\n$$ J = (a A_f u_1^0) \\tau + \\left(a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau}{V_1}\\right)\\right) \\tau $$\n提取公因式 $a A_f u_1^0 \\tau$：\n$$ J = a A_f u_1^0 \\tau \\left[ 1 + \\left(1 - \\frac{a A_f \\tau}{V_1}\\right) \\right] = a A_f u_1^0 \\tau \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) $$\n\n**$\\mathcal{C}_2$ 的净更新量**\n单元 $\\mathcal{C}_2$ 中总量的变化为 $V_2 \\Delta u_2 = J$。因此，单元平均状态 $u_2$ 的净更新量为：\n$$ \\Delta u_2 = \\frac{J}{V_2} = \\frac{1}{V_2} \\left[ a A_f u_1^0 \\tau \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) \\right] $$\n$$ \\Delta u_2 = \\frac{a A_f \\tau u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) $$\n\n此结果遵循守恒律 $V_1 \\Delta u_1 + V_2 \\Delta u_2 = 0$，可以验证：\n$V_1 \\Delta u_1 = V_1 \\left[ \\frac{a A_f \\tau u_1^0}{V_1} \\left( \\frac{a A_f \\tau}{V_1} - 2 \\right) \\right] = a A_f \\tau u_1^0 \\left( \\frac{a A_f \\tau}{V_1} - 2 \\right)$。\n$V_2 \\Delta u_2 = V_2 \\left[ \\frac{a A_f \\tau u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) \\right] = a A_f \\tau u_1^0 \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right)$。\n显然，$V_1 \\Delta u_1 = -V_2 \\Delta u_2$。\n\n最终答案是序对 $(\\Delta u_1, \\Delta u_2)$。\n$$ \\Delta u_1 = \\frac{a A_f \\tau u_1^0}{V_1} \\left( \\frac{a A_f \\tau}{V_1} - 2 \\right) $$\n$$ \\Delta u_2 = \\frac{a A_f \\tau u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) $$\n这些就是所要求的闭式解析表达式。",
            "answer": "$$ \\boxed{ \\left( \\frac{a A_f \\tau u_1^0}{V_1} \\left( \\frac{a A_f \\tau}{V_1} - 2 \\right) , \\frac{a A_f \\tau u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau}{V_1} \\right) \\right) } $$"
        }
    ]
}