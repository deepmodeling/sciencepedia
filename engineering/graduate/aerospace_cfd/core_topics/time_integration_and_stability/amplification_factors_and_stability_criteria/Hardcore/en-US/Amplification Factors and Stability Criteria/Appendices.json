{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of understanding numerical stability is the von Neumann analysis. This first practice provides a fundamental walkthrough of this essential technique by applying it to the Lax-Friedrichs scheme for the linear advection equation . By deriving the amplification factor and its corresponding stability constraint, you will gain hands-on experience with the core mechanics that dictate whether a numerical solution will remain bounded or grow uncontrollably.",
            "id": "3943389",
            "problem": "Consider the linear advection equation $u_{t}+a\\,u_{x}=0$ with constant advection speed $a \\in \\mathbb{R}\\setminus\\{0\\}$ on a uniform spatial grid $x_{j}=j\\,\\Delta x$ and uniform time steps $t^{n}=n\\,\\Delta t$. The Lax–Friedrichs finite difference scheme updates the solution via\n$$\nu_{j}^{n+1}=\\tfrac{1}{2}\\left(u_{j+1}^{n}+u_{j-1}^{n}\\right)-\\tfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\nUsing a von Neumann Fourier-mode analysis with the ansatz $u_{j}^{n}=\\hat{u}^{n}\\exp\\!\\left(i\\,j\\,\\theta\\right)$, where $\\theta \\in [-\\pi,\\pi]$ is the dimensionless wave number in radians, derive the one-step amplification factor $G(\\theta)=\\hat{u}^{n+1}/\\hat{u}^{n}$ as a function of $\\theta$ and the Courant–Friedrichs–Lewy (CFL) number $C=a\\,\\Delta t/\\Delta x$. Then determine the stability requirement that ensures $|G(\\theta)|\\le 1$ for all $\\theta \\in [-\\pi,\\pi]$.\n\nFinally, provide the single closed-form expression for the maximum allowable time step $\\Delta t_{\\max}$, in seconds, in terms of $\\Delta x$ and $a$, that guarantees $|G(\\theta)|\\le 1$ for all $\\theta$. Your final answer should be only this analytic expression for $\\Delta t_{\\max}$.",
            "solution": "The problem requires the derivation of the amplification factor for the Lax–Friedrichs scheme applied to the linear advection equation, the subsequent determination of the stability criterion, and the expression for the maximum allowable time step.\n\nThe governing partial differential equation is the one-dimensional linear advection equation:\n$$\nu_{t} + a \\, u_{x} = 0\n$$\nwhere $a \\in \\mathbb{R}\\setminus\\{0\\}$ is a constant advection speed. The given finite difference scheme is the Lax–Friedrichs scheme on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\nTo perform a von Neumann stability analysis, we substitute the Fourier mode ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ into the scheme. Here, $\\hat{u}^{n}$ is the amplitude of the mode at time level $n$, $j$ is the spatial index, and $\\theta = k\\,\\Delta x$ is the dimensionless wave number, where $k$ is the wave number. The terms in the scheme become:\n$$\nu_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i\\,j\\,\\theta)\n$$\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\exp(i\\,(j+1)\\,\\theta) = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\n$$\nSubstituting these expressions into the Lax–Friedrichs scheme yields:\n$$\n\\hat{u}^{n+1}\\exp(i\\,j\\,\\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta) + \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(\\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta) - \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\\right)\n$$\nThe common factor $\\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ can be divided out, as it is non-zero, to find the one-step amplification factor $G(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$:\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i\\,\\theta) + \\exp(-i\\,\\theta)\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)\\right)\n$$\nUsing Euler's identities, $\\cos(\\theta) = \\frac{1}{2}(\\exp(i\\,\\theta) + \\exp(-i\\,\\theta))$ and $\\sin(\\theta) = \\frac{1}{2i}(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta))$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{a\\,\\Delta t}{\\Delta x}\\left( i\\,\\sin(\\theta) \\right)\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number, $C = \\frac{a\\,\\Delta t}{\\Delta x}$, the amplification factor becomes:\n$$\nG(\\theta) = \\cos(\\theta) - i\\,C\\,\\sin(\\theta)\n$$\nThis is the amplification factor as a function of $\\theta$ and $C$.\n\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wave number $\\theta \\in [-\\pi, \\pi]$. That is, we require $|G(\\theta)| \\le 1$. We analyze the squared magnitude:\n$$\n|G(\\theta)|^2 = |\\cos(\\theta) - i\\,C\\,\\sin(\\theta)|^2 = (\\text{Re}(G(\\theta)))^2 + (\\text{Im}(G(\\theta)))^2\n$$\n$$\n|G(\\theta)|^2 = (\\cos(\\theta))^2 + (-C\\,\\sin(\\theta))^2 = \\cos^2(\\theta) + C^2\\,\\sin^2(\\theta)\n$$\nThe stability requirement $|G(\\theta)|^2 \\le 1$ translates to:\n$$\n\\cos^2(\\theta) + C^2\\,\\sin^2(\\theta) \\le 1\n$$\nUsing the trigonometric identity $\\cos^2(\\theta) = 1 - \\sin^2(\\theta)$, we have:\n$$\n(1 - \\sin^2(\\theta)) + C^2\\,\\sin^2(\\theta) \\le 1\n$$\n$$\n1 + (C^2 - 1)\\sin^2(\\theta) \\le 1\n$$\nSubtracting $1$ from both sides gives the inequality:\n$$\n(C^2 - 1)\\sin^2(\\theta) \\le 0\n$$\nSince $\\theta \\in [-\\pi, \\pi]$, the term $\\sin^2(\\theta)$ is always non-negative, i.e., $\\sin^2(\\theta) \\ge 0$. For the inequality $(C^2 - 1)\\sin^2(\\theta) \\le 0$ to hold for all possible values of $\\theta$, the coefficient $(C^2 - 1)$ must be non-positive. If $(C^2 - 1)$ were positive, then for any $\\theta$ such that $\\sin(\\theta) \\neq 0$, the inequality would be violated. Therefore, we must have:\n$$\nC^2 - 1 \\le 0 \\implies C^2 \\le 1\n$$\nTaking the square root of both sides, we obtain the stability requirement for the Lax–Friedrichs scheme:\n$$\n|C| \\le 1\n$$\nFinally, we are asked to find the maximum allowable time step $\\Delta t_{\\max}$ that guarantees stability. We substitute the definition of the CFL number $C = \\frac{a\\,\\Delta t}{\\Delta x}$ into the stability condition:\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1\n$$\nSince $\\Delta t > 0$ and $\\Delta x > 0$, we can rewrite this as:\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x} \\le 1\n$$\nSolving for $\\Delta t$ gives:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the value that satisfies this condition with equality:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\nThis expression provides the upper limit on the time step for any given spatial grid size $\\Delta x$ and advection speed $a$ to ensure the stability of the Lax–Friedrichs scheme.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|a|}}$$"
        },
        {
            "introduction": "While linear analysis is foundational, real fluid dynamics are nonlinear. This exercise explores a more profound aspect of stability by examining how different discrete forms of the nonlinear convective term affect the conservation of kinetic energy . By analyzing the advective, divergence, and skew-symmetric formulations, you will discover how mimicking a physical conservation law at the discrete level can guarantee stability for a nonlinear system, a critical concept in designing robust CFD solvers.",
            "id": "3943401",
            "problem": "Consider a two-dimensional, inviscid, incompressible flow on a doubly periodic domain discretized by a uniform, collocated grid with spacings $\\Delta x$ and $\\Delta y$. Let the discrete velocity field be $\\boldsymbol{u} = (u,v)$ stored at cell centers. Denote the standard centered-difference first-derivative operators in the $x$- and $y$-directions by $D_x$ and $D_y$, respectively, acting componentwise on grid functions. Assume periodic boundary conditions in both directions and define the discrete inner product $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\Delta x \\Delta y \\sum_{i,j} \\boldsymbol{a}_{i,j} \\cdot \\boldsymbol{b}_{i,j}$, with associated discrete kinetic energy $K(t) = \\tfrac{1}{2} \\langle \\boldsymbol{u}, \\boldsymbol{u} \\rangle$. The discrete centered differences satisfy a summation-by-parts property on this periodic grid, namely $\\langle \\phi, D_\\alpha \\psi \\rangle = - \\langle D_\\alpha \\phi, \\psi \\rangle$ for $\\alpha \\in \\{x,y\\}$ and any grid functions $\\phi,\\psi$. The flow is assumed to be incompressible in the discrete sense, i.e., $D_x u + D_y v = 0$.\n\nDefine three semi-discrete convective operators for the momentum equation:\n- The advective form $N_{\\mathrm{adv}}(\\boldsymbol{u}) = \\left( u D_x u + v D_y u,\\ u D_x v + v D_y v \\right)$.\n- The divergence form $N_{\\mathrm{div}}(\\boldsymbol{u}) = \\left( D_x(u u) + D_y(v u),\\ D_x(u v) + D_y(v v) \\right)$.\n- The skew-symmetric form $N_{\\mathrm{skew}}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left( N_{\\mathrm{adv}}(\\boldsymbol{u}) + N_{\\mathrm{div}}(\\boldsymbol{u}) \\right)$.\n\nAssume that the semi-discrete momentum equation without pressure or viscosity is $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} \\boldsymbol{u} + N(\\boldsymbol{u}) = \\boldsymbol{0}$, where $N$ is one of the above operators.\n\nTasks:\n1) Starting from the definitions above and using only the properties stated in this problem, derive the semi-discrete kinetic energy balance $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} K(t)$ due solely to the convective term for each of the three formulations $N_{\\mathrm{adv}}$, $N_{\\mathrm{div}}$, and $N_{\\mathrm{skew}}$. Express each balance in terms of the discrete inner product and show how the summation-by-parts property enters the derivation.\n\n2) To connect the energy balance with amplification factors and stability criteria, linearize each convective operator about a uniform base flow $\\boldsymbol{U}_0 = (U,0)$ with constant $U \\in \\mathbb{R}$, by writing $\\boldsymbol{u} = \\boldsymbol{U}_0 + \\boldsymbol{u}'$ and discarding nonlinear terms in the perturbation $\\boldsymbol{u}'$. For a single Fourier mode perturbation $\\boldsymbol{u}'_{i,j}(t) = \\Re\\left\\{ \\widehat{\\boldsymbol{u}}(t) \\exp\\!\\left( \\mathrm{i} (k_x i \\Delta x + k_y j \\Delta y) \\right) \\right\\}$ with wavenumbers $k_x,k_y \\in \\mathbb{R}$, derive the semi-discrete symbol of the linearized convective operator and the corresponding forward Euler one-step amplification factor $G$ as a function of the Courant numbers $C_x = U \\Delta t / \\Delta x$ and $C_y = 0$, and the phase $\\theta_x = k_x \\Delta x$. State the magnitude $|G|$ and discuss whether forward Euler is stable for any nonzero $\\Delta t$.\n\n3) Based on your derivation in Task 1, determine the exact value of the convective contribution to $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} K(t)$ when $N = N_{\\mathrm{skew}}$ under the stated assumptions. Your final answer must be a single real number or a closed-form analytic expression. No rounding is required and no units are needed.",
            "solution": "The semi-discrete momentum equation is given as $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} \\boldsymbol{u} = -N(\\boldsymbol{u})$. The rate of change of the discrete kinetic energy $K(t) = \\tfrac{1}{2} \\langle \\boldsymbol{u}, \\boldsymbol{u} \\rangle$ is found by differentiating with respect to time $t$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( \\frac{1}{2} \\langle \\boldsymbol{u}, \\boldsymbol{u} \\rangle \\right) = \\frac{1}{2} \\left( \\left\\langle \\frac{\\mathrm{d}\\boldsymbol{u}}{\\mathrm{d}t}, \\boldsymbol{u} \\right\\rangle + \\left\\langle \\boldsymbol{u}, \\frac{\\mathrm{d}\\boldsymbol{u}}{\\mathrm{d}t} \\right\\rangle \\right)\n$$\nSince the discrete inner product is symmetric, this simplifies to:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = \\left\\langle \\boldsymbol{u}, \\frac{\\mathrm{d}\\boldsymbol{u}}{\\mathrm{d}t} \\right\\rangle\n$$\nSubstituting the momentum equation, we obtain the general expression for the kinetic energy balance due to the convective term $N(\\boldsymbol{u})$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\langle \\boldsymbol{u}, N(\\boldsymbol{u}) \\rangle\n$$\nWe will now evaluate this expression for each of the three given convective operators.\n\n**Task 1: Semi-discrete Kinetic Energy Balance**\n\nA key relationship must be established first. We evaluate the inner product $\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle$. By definition:\n$$\n\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = \\langle u, D_x(u^2) + D_y(vu) \\rangle + \\langle v, D_x(uv) + D_y(v^2) \\rangle\n$$\nWe expand this and apply the summation-by-parts (SBP) property, $\\langle \\phi, D_\\alpha \\psi \\rangle = - \\langle D_\\alpha \\phi, \\psi \\rangle$, to each term:\n\\begin{align*}\n\\langle u, D_x(u^2) \\rangle = - \\langle D_x u, u^2 \\rangle \\\\\n\\langle u, D_y(vu) \\rangle = - \\langle D_y u, vu \\rangle \\\\\n\\langle v, D_x(uv) \\rangle = - \\langle D_x v, uv \\rangle \\\\\n\\langle v, D_y(v^2) \\rangle = - \\langle D_y v, v^2 \\rangle\n\\end{align*}\nSubstituting these back into the expression for $\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle$:\n$$\n\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\langle D_x u, u^2 \\rangle - \\langle D_y u, vu \\rangle - \\langle D_x v, uv \\rangle - \\langle D_y v, v^2 \\rangle\n$$\nRearranging the terms:\n$$\n\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\left( \\langle u, u D_x u \\rangle + \\langle u, v D_y u \\rangle + \\langle v, u D_x v \\rangle + \\langle v, v D_y v \\rangle \\right)\n$$\n$$\n\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\left( \\langle u, u D_x u + v D_y u \\rangle + \\langle v, u D_x v + v D_y v \\rangle \\right)\n$$\nThe expression in the parentheses is precisely $\\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle$. Thus, we have derived the crucial identity:\n$$\n\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle\n$$\nThis identity relies only on the definition of the inner product and the SBP property. The discrete incompressibility condition $D_x u + D_y v = 0$ is not required for this specific result.\n\nNow we can determine the energy balance for each form.\n\n1) Advective form, $N_{\\mathrm{adv}}(\\boldsymbol{u})$:\nThe energy balance is given directly by:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle\n$$\nUsing only the given properties, this term cannot be shown to be zero in general. For standard centered differences, it represents a source or sink of energy due to aliasing errors.\n\n2) Divergence form, $N_{\\mathrm{div}}(\\boldsymbol{u})$:\nThe energy balance is $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle$. Using the identity derived above:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\left( - \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle \\right) = \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle\n$$\nThe divergence form generates/dissipates energy at a rate exactly opposite to the advective form.\n\n3) Skew-symmetric form, $N_{\\mathrm{skew}}(\\boldsymbol{u})$:\nThe energy balance is $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\langle \\boldsymbol{u}, N_{\\mathrm{skew}}(\\boldsymbol{u}) \\rangle$. Substituting the definition $N_{\\mathrm{skew}}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left( N_{\\mathrm{adv}}(\\boldsymbol{u}) + N_{\\mathrm{div}}(\\boldsymbol{u}) \\right)$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\frac{1}{2} \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) + N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\frac{1}{2} \\left( \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle + \\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle \\right)\n$$\nNow, substituting the identity $\\langle \\boldsymbol{u}, N_{\\mathrm{div}}(\\boldsymbol{u}) \\rangle = - \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\frac{1}{2} \\left( \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle - \\langle \\boldsymbol{u}, N_{\\mathrm{adv}}(\\boldsymbol{u}) \\rangle \\right) = 0\n$$\nThe skew-symmetric formulation exactly conserves discrete kinetic energy.\n\n**Task 2: Linearization, Symbol, and Stability**\n\nWe linearize the operators about the uniform base flow $\\boldsymbol{U}_0 = (U,0)$, where $U$ is a constant. We set $\\boldsymbol{u} = \\boldsymbol{U}_0 + \\boldsymbol{u}'$ where $\\boldsymbol{u}' = (u', v')$ is the perturbation, and discard terms of order $\\mathcal{O}(\\|\\boldsymbol{u}'\\|^2)$. The perturbation must satisfy the discrete incompressibility condition $D_x u' + D_y v' = 0$.\n\nLinearization of $N_{\\mathrm{adv}}(\\boldsymbol{u})$:\n$$\nN_{\\mathrm{adv}}(\\boldsymbol{U}_0 + \\boldsymbol{u}') = \\begin{pmatrix} (U+u')D_x(U+u') + v'D_y(U+u') \\\\ (U+u')D_x(v') + v'D_y(v') \\end{pmatrix} \\approx \\begin{pmatrix} U D_x u' \\\\ U D_x v' \\end{pmatrix} = U D_x \\boldsymbol{u}'\n$$\nLinearization of $N_{\\mathrm{div}}(\\boldsymbol{u})$:\n$$\nN_{\\mathrm{div}}(\\boldsymbol{U}_0 + \\boldsymbol{u}') = \\begin{pmatrix} D_x((U+u')^2) + D_y(v'(U+u')) \\\\ D_x((U+u')v') + D_y((v')^2) \\end{pmatrix} \\approx \\begin{pmatrix} D_x(2Uu') + D_y(Uv') \\\\ D_x(Uv') \\end{pmatrix} = \\begin{pmatrix} 2U D_x u' + U D_y v' \\\\ U D_x v' \\end{pmatrix}\n$$\nUsing the incompressibility of the perturbation, $D_y v' = -D_x u'$, the first component becomes $2U D_x u' + U(-D_x u') = U D_x u'$. Thus, the linearized operator is:\n$$\nL_{\\mathrm{div}}(\\boldsymbol{u}') = \\begin{pmatrix} U D_x u' \\\\ U D_x v' \\end{pmatrix} = U D_x \\boldsymbol{u}'\n$$\nLinearization of $N_{\\mathrm{skew}}(\\boldsymbol{u})$:\nSince $L_{\\mathrm{adv}} = L_{\\mathrm{div}}$, the linearized skew-symmetric operator is $L_{\\mathrm{skew}} = \\tfrac{1}{2}(L_{\\mathrm{adv}} + L_{\\mathrm{div}}) = U D_x \\boldsymbol{u}'$. All three formulations have the identical linearization $L(\\boldsymbol{u}') = U D_x \\boldsymbol{u}'$.\n\nThe linearized semi-discrete equation is $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} \\boldsymbol{u}' + U D_x \\boldsymbol{u}' = \\boldsymbol{0}$. To find the symbol of the operator $L = U D_x$, we analyze its action on a single Fourier mode $\\boldsymbol{u}' \\propto \\exp(\\mathrm{i}(k_x x + k_y y))$. The action of the centered difference operator $D_x$ on the spatial part is:\n$$\nD_x \\exp(\\mathrm{i} k_x x) = \\frac{\\exp(\\mathrm{i} k_x (x+\\Delta x)) - \\exp(\\mathrm{i} k_x (x-\\Delta x))}{2\\Delta x} = \\exp(\\mathrm{i} k_x x) \\frac{\\exp(\\mathrm{i} k_x \\Delta x) - \\exp(-\\mathrm{i} k_x \\Delta x)}{2\\Delta x}\n$$\n$$\nD_x \\exp(\\mathrm{i} k_x x) = \\exp(\\mathrm{i} k_x x) \\frac{2\\mathrm{i}\\sin(k_x \\Delta x)}{2\\Delta x} = \\exp(\\mathrm{i} k_x x) \\frac{\\mathrm{i}\\sin(k_x \\Delta x)}{\\Delta x}\n$$\nThe symbol of the operator $D_x$ is $\\widehat{D_x}(k_x) = \\frac{\\mathrm{i}\\sin(k_x \\Delta x)}{\\Delta x}$. Therefore, the semi-discrete symbol of the linearized convective operator $L = U D_x$ is:\n$$\n\\widehat{L}(k_x) = U \\widehat{D_x}(k_x) = \\frac{\\mathrm{i} U \\sin(k_x \\Delta x)}{\\Delta x}\n$$\nApplying the forward Euler method to the Fourier-transformed ODE $\\tfrac{\\mathrm{d}}{\\mathrm{d}t}\\widehat{\\boldsymbol{u}}' = -\\widehat{L}\\widehat{\\boldsymbol{u}}'$ gives $\\widehat{\\boldsymbol{u}}'^{n+1} = \\widehat{\\boldsymbol{u}}'^n - \\Delta t \\widehat{L} \\widehat{\\boldsymbol{u}}'^n = (1 - \\Delta t \\widehat{L}) \\widehat{\\boldsymbol{u}}'^n$.\nThe amplification factor $G$ is:\n$$\nG(k_x) = 1 - \\Delta t \\widehat{L}(k_x) = 1 - \\Delta t \\frac{\\mathrm{i} U \\sin(k_x \\Delta x)}{\\Delta x} = 1 - \\mathrm{i} \\frac{U \\Delta t}{\\Delta x} \\sin(k_x \\Delta x)\n$$\nUsing the definitions $C_x = U \\Delta t / \\Delta x$ and $\\theta_x = k_x \\Delta x$, the amplification factor is $G(\\theta_x) = 1 - \\mathrm{i} C_x \\sin(\\theta_x)$.\n\nFor stability, we require $|G| \\leq 1$. The magnitude of $G$ is:\n$$\n|G| = |1 - \\mathrm{i} C_x \\sin(\\theta_x)| = \\sqrt{1^2 + (-C_x \\sin(\\theta_x))^2} = \\sqrt{1 + C_x^2 \\sin^2(\\theta_x)}\n$$\nThe stability condition $|G| \\leq 1$ becomes $\\sqrt{1 + C_x^2 \\sin^2(\\theta_x)} \\leq 1$, which requires $C_x^2 \\sin^2(\\theta_x) \\leq 0$. Since both $C_x^2$ and $\\sin^2(\\theta_x)$ are non-negative real numbers, this inequality can only be satisfied if $C_x^2 \\sin^2(\\theta_x) = 0$. This implies either $C_x=0$ (i.e., $\\Delta t = 0$ or $U=0$) or $\\sin(\\theta_x)=0$ (i.e., for wavenumbers $k_x$ such that $k_x \\Delta x$ is an integer multiple of $\\pi$). For any general wave mode where $\\sin(\\theta_x) \\neq 0$ and any non-zero time step $\\Delta t > 0$, we have $|G| > 1$. Therefore, the forward Euler scheme is unconditionally unstable for this spatial discretization of the advection equation.\n\n**Task 3: Final Answer Calculation**\n\nTask 3 asks for the exact value of the convective contribution to $\\tfrac{\\mathrm{d}}{\\mathrm{d}t} K(t)$ when $N = N_{\\mathrm{skew}}$ under the stated assumptions. As derived in Task 1, the skew-symmetric formulation is constructed specifically to conserve kinetic energy at the semi-discrete level. The derivation showed:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} K(t) = - \\langle \\boldsymbol{u}, N_{\\mathrm{skew}}(\\boldsymbol{u}) \\rangle = 0\n$$\nThis result is exact and holds for any velocity field $\\boldsymbol{u}$ satisfying the problem's conditions. It is a direct consequence of the SBP property of the discrete operators. The convective contribution to the rate of change of kinetic energy is identically zero.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "This practice addresses a sophisticated but crucial topic in modern stability theory: the limitation of eigenvalue-based analysis. It cautions against a naive reliance on eigenvalues, which only predict long-term asymptotic behavior, and introduces the concept of non-normality . Through a concrete example, you will quantify how non-normality—a common feature of fluid dynamics operators—can cause significant short-term transient amplification, even when the scheme is asymptotically stable.",
            "id": "3943412",
            "problem": "Consider a linear, constant-coefficient, semi-discrete system arising in Computational Fluid Dynamics (CFD), written as $\\,\\frac{d\\mathbf{y}}{dt} = \\mathbf{A}\\,\\mathbf{y}\\,$, where $\\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$ represents the spatial discretization of a dissipative linear operator (e.g., a Fourier-mode-resolved convection–diffusion operator). The one-step explicit Euler time-integration scheme advances the solution via the amplification operator $\\mathbf{G}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}$.\n\nYou are asked to construct two semi-discrete schemes with identical eigenvalues but different non-normality, and then quantify their single-step transient amplification at the same time step $\\,\\Delta t\\,$:\n- Define the first scheme by the normal matrix $\\mathbf{A}_{\\mathrm{N}} = \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix}$.\n- Define the second scheme by the non-normal matrix $\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{A}_{\\mathrm{N}}\\,\\mathbf{S}^{-1}$, where $\\mathbf{S} = \\begin{pmatrix} 1  \\kappa \\\\ 0  1 \\end{pmatrix}$ with $\\kappa  0$.\n\nBoth schemes share identical eigenvalues $\\,\\{-2,-1\\}\\,$ by construction, but they differ in non-normality because $\\mathbf{S}$ is not orthogonal. For the explicit Euler time step, the amplification operators are $\\mathbf{G}_{\\mathrm{N}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{N}}$ and $\\mathbf{G}_{\\mathrm{NN}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\,\\mathbf{S}^{-1}$.\n\nLet the time step be $\\Delta t = 0.3$ and the non-normality parameter be $\\kappa = 2$. Using the induced Euclidean operator norm (the matrix $2$-norm), compute the ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(\\Delta t)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\right\\|_{2}} \\, ,\n$$\nand report its value. This ratio measures how much larger the single-step transient amplification of the more non-normal scheme is, compared to the normal scheme, under the same $\\Delta t$ and identical eigenvalues.\n\nRound your final answer to $4$ significant figures. The ratio is dimensionless; do not include any units.",
            "solution": "The problem asks for the ratio of the matrix 2-norms of two amplification operators, $\\mathbf{G}_{\\mathrm{NN}}$ and $\\mathbf{G}_{\\mathrm{N}}$, for a given time step $\\Delta t = 0.3$ and non-normality parameter $\\kappa = 2$.\n\n**1. Analyze the Normal Scheme**\n\nFirst, we compute the amplification operator for the normal scheme, $\\mathbf{G}_{\\mathrm{N}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{N}}$.\n$$\n\\mathbf{G}_{\\mathrm{N}}(0.3) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + 0.3 \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 1 - 0.6  0 \\\\ 0  1 - 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.4  0 \\\\ 0  0.7 \\end{pmatrix}\n$$\nSince $\\mathbf{G}_{\\mathrm{N}}(0.3)$ is a normal matrix (specifically, a diagonal matrix), its 2-norm is equal to its spectral radius, which is the maximum of the absolute values of its eigenvalues. The eigenvalues are the diagonal entries, $0.4$ and $0.7$.\n$$\n\\left\\|\\mathbf{G}_{\\mathrm{N}}(0.3)\\right\\|_{2} = \\rho(\\mathbf{G}_{\\mathrm{N}}(0.3)) = \\max(|0.4|, |0.7|) = 0.7\n$$\n\n**2. Analyze the Non-Normal Scheme**\n\nNext, we construct the amplification operator for the non-normal scheme, $\\mathbf{G}_{\\mathrm{NN}}(\\Delta t) = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\,\\mathbf{S}^{-1}$. With $\\kappa=2$, the similarity matrix and its inverse are:\n$$\n\\mathbf{S} = \\begin{pmatrix} 1  2 \\\\ 0  1 \\end{pmatrix}, \\quad \\mathbf{S}^{-1} = \\begin{pmatrix} 1  -2 \\\\ 0  1 \\end{pmatrix}\n$$\nNow we compute $\\mathbf{G}_{\\mathrm{NN}}(0.3)$:\n$$\n\\mathbf{G}_{\\mathrm{NN}}(0.3) = \\begin{pmatrix} 1  2 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0.4  0 \\\\ 0  0.7 \\end{pmatrix} \\begin{pmatrix} 1  -2 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.4  1.4 \\\\ 0  0.7 \\end{pmatrix} \\begin{pmatrix} 1  -2 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.4  -0.8 + 1.4 \\\\ 0  0.7 \\end{pmatrix} = \\begin{pmatrix} 0.4  0.6 \\\\ 0  0.7 \\end{pmatrix}\n$$\nTo find the 2-norm of the non-normal matrix $\\mathbf{G}_{\\mathrm{NN}}$, we calculate $\\|\\mathbf{G}_{\\mathrm{NN}}\\|_{2} = \\sqrt{\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}})}$. First, we compute the product $\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}}$:\n$$\n\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}} = \\begin{pmatrix} 0.4  0 \\\\ 0.6  0.7 \\end{pmatrix} \\begin{pmatrix} 0.4  0.6 \\\\ 0  0.7 \\end{pmatrix} = \\begin{pmatrix} 0.16  0.24 \\\\ 0.24  0.36 + 0.49 \\end{pmatrix} = \\begin{pmatrix} 0.16  0.24 \\\\ 0.24  0.85 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of this matrix are found from its characteristic equation:\n$$\n\\det\\begin{pmatrix} 0.16-\\lambda  0.24 \\\\ 0.24  0.85-\\lambda \\end{pmatrix} = (0.16 - \\lambda)(0.85 - \\lambda) - (0.24)^2 = 0\n$$\n$$\n\\lambda^2 - 1.01\\lambda + 0.136 - 0.0576 = 0 \\implies \\lambda^2 - 1.01\\lambda + 0.0784 = 0\n$$\nUsing the quadratic formula, the largest eigenvalue is:\n$$\n\\lambda_{\\max} = \\frac{1.01 + \\sqrt{(-1.01)^2 - 4(1)(0.0784)}}{2} = \\frac{1.01 + \\sqrt{1.0201 - 0.3136}}{2} = \\frac{1.01 + \\sqrt{0.7065}}{2} \\approx 0.925268\n$$\nThe 2-norm is the square root of $\\lambda_{\\max}$:\n$$\n\\left\\|\\mathbf{G}_{\\mathrm{NN}}(0.3)\\right\\|_{2} = \\sqrt{\\lambda_{\\max}} \\approx \\sqrt{0.925268} \\approx 0.961908\n$$\n\n**3. Compute the Ratio**\n\nFinally, we compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(0.3)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(0.3)\\right\\|_{2}} \\approx \\frac{0.961908}{0.7} \\approx 1.37415\n$$\nRounding to 4 significant figures gives $1.374$.",
            "answer": "$$\n\\boxed{1.374}\n$$"
        }
    ]
}