{
    "hands_on_practices": [
        {
            "introduction": "The abstract concept of a stability domain becomes concrete through computation. This first practice focuses on the widely-used classical four-stage Runge-Kutta (RK4) method, tasking you with numerically constructing its stability boundary. By translating the mathematical definition of stability, $|R(z)| \\le 1$, into a practical computational tool, you will develop the foundational skill of determining maximum stable time steps for a given set of eigenvalues .",
            "id": "3996033",
            "problem": "Consider the linear test equation $y'(t) = \\lambda y(t)$ with $\\lambda \\in \\mathbb{C}$ and a one-step explicit integrator characterized by its stability function $R(z)$, where $z = \\Delta t \\lambda$ and $\\Delta t > 0$ is the time step. The absolute stability domain is defined as $\\mathcal{S} = \\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$. In aerospace Computational Fluid Dynamics (CFD), time integration schemes are often applied to semi-discrete systems whose eigenvalues determine allowable time steps through this stability domain.\n\nStarting from the definition of the stability function for one-step methods applied to the linear test equation, derive the stability function $R(z)$ for the classical four-stage Runge–Kutta (RK4) method. Using that function, you must implement a program that:\n1. Computes the boundary curve defined by $|R(z)| = 1$ for RK4 by sampling rays $z = r e^{i \\theta}$ from the origin with angles $\\theta$ uniformly distributed in $[0, 2\\pi)$, and for each $\\theta$ numerically determines the smallest positive radius $r(\\theta)$ such that $|R(r(\\theta) e^{i \\theta})| = 1$. Angles must be treated in radians.\n2. Determines the intersection of the boundary curve with the negative real axis, expressed as a real number $x^\\star  0$ such that $|R(x^\\star)| = 1$ and $x^\\star \\in \\mathbb{R}$.\n3. Given a finite set of eigenvalues $\\{\\lambda_j\\}_{j=1}^m \\subset \\mathbb{C}$, computes the maximum admissible time step $h_{\\max}$ such that $h_{\\max} \\lambda_j \\in \\mathcal{S}$ for all $j$, i.e., $\\max_j |R(h_{\\max} \\lambda_j)| \\le 1$.\n\nAll quantities in this problem are dimensionless, and all angles must be handled in radians.\n\nYour implementation must employ robust numerical bracketing and bisection to locate roots of scalar functions of one variable. You must ensure scientific realism by using appropriate search intervals that fully cover the RK4 stability region and terminate reliably.\n\nTest Suite:\n- Case 1 (Boundary intersection on negative real axis): Compute $x^\\star$, the largest-magnitude negative real number with $|R(x^\\star)| = 1$.\n- Case 2 (Real eigenvalues, scaling behavior): For $\\lambda_1 = -1$ and $\\lambda_2 = -10$, compute $h_{\\max}$ such that $h_{\\max}\\lambda_j \\in \\mathcal{S}$ for both $j=1,2$.\n- Case 3 (Complex eigenvalue, directional boundary): For $\\lambda_3 = -2 + 3 i$, compute $h_{\\max}$ such that $h_{\\max}\\lambda_3 \\in \\mathcal{S}$.\n\nAnswer Specification and Output Format:\n- For each case, the answer must be a floating-point number.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n- The three outputs must be ordered as $[x^\\star, h_{\\max} \\text{ for Case 2}, h_{\\max} \\text{ for Case 3}]$.\n- Each floating-point number must be rounded to six decimal places.",
            "solution": "The problem requires the derivation of the stability function for the classical four-stage Runge-Kutta (RK4) method and its use to determine stability limits for given eigenvalue spectra. The process involves three main parts: deriving the stability function $R(z)$, finding the stability boundary on the negative real axis, and calculating the maximum stable time step $h_{\\max}$ for sets of eigenvalues.\n\n### Step 1: Derivation of the RK4 Stability Function\n\nThe stability function, $R(z)$, of a numerical one-step method is defined by the relation $y_{n+1} = R(z) y_n$ when the method is applied to the linear test equation $y'(t) = \\lambda y(t)$, where $z = \\Delta t \\lambda$ with $\\Delta t$ being the time step.\n\nThe classical four-stage Runge-Kutta method is given by:\n$$y_{n+1} = y_n + \\frac{\\Delta t}{6} (k_1 + 2k_2 + 2k_3 + k_4)$$\nwhere the stages $k_i$ are computed as:\n\\begin{align*}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2}k_1) \\\\\nk_3 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2}k_2) \\\\\nk_4 = f(t_n + \\Delta t, y_n + \\Delta t k_3)\n\\end{align*}\nFor the linear test equation, $f(t, y) = \\lambda y$. Substituting this into the stage calculations yields:\n\\begin{align*}\nk_1 = \\lambda y_n \\\\\nk_2 = \\lambda \\left(y_n + \\frac{\\Delta t}{2}k_1\\right) = \\lambda \\left(y_n + \\frac{\\Delta t}{2}(\\lambda y_n)\\right) = \\lambda y_n \\left(1 + \\frac{\\Delta t\\lambda}{2}\\right) \\\\\nk_3 = \\lambda \\left(y_n + \\frac{\\Delta t}{2}k_2\\right) = \\lambda \\left(y_n + \\frac{\\Delta t}{2}\\lambda y_n \\left(1 + \\frac{\\Delta t\\lambda}{2}\\right)\\right) = \\lambda y_n \\left(1 + \\frac{\\Delta t\\lambda}{2} + \\frac{(\\Delta t\\lambda)^2}{4}\\right) \\\\\nk_4 = \\lambda \\left(y_n + \\Delta t k_3\\right) = \\lambda \\left(y_n + \\Delta t \\lambda y_n \\left(1 + \\frac{\\Delta t\\lambda}{2} + \\frac{(\\Delta t\\lambda)^2}{4}\\right)\\right) = \\lambda y_n \\left(1 + \\Delta t\\lambda + \\frac{(\\Delta t\\lambda)^2}{2} + \\frac{(\\Delta t\\lambda)^3}{4}\\right)\n\\end{align*}\nLet $z = \\Delta t\\lambda$. The stages can be rewritten in terms of $z$:\n\\begin{align*}\nk_1 = \\lambda y_n \\\\\nk_2 = \\lambda y_n \\left(1 + \\frac{z}{2}\\right) \\\\\nk_3 = \\lambda y_n \\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) \\\\\nk_4 = \\lambda y_n \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right)\n\\end{align*}\nNow, we substitute these expressions back into the update formula for $y_{n+1}$:\n$$y_{n+1} = y_n + \\frac{\\Delta t}{6} \\left[\\lambda y_n + 2\\lambda y_n \\left(1 + \\frac{z}{2}\\right) + 2\\lambda y_n \\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\lambda y_n \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right)\\right]$$\nFactoring out $y_n$ gives the relation $y_{n+1} = R(z) y_n$:\n$$R(z) = \\frac{y_{n+1}}{y_n} = 1 + \\frac{\\Delta t\\lambda}{6} \\left[1 + 2\\left(1 + \\frac{z}{2}\\right) + 2\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right)\\right]$$\n$$R(z) = 1 + \\frac{z}{6} \\left[1 + (2+z) + (2+z+\\frac{z^2}{2}) + (1+z+\\frac{z^2}{2}+\\frac{z^3}{4})\\right]$$\nSumming the terms inside the brackets:\n\\begin{align*}\n\\text{Constant}:  \\quad 1+2+2+1 = 6 \\\\\n\\text{Linear } (z):  \\quad z+z+z = 3z \\\\\n\\text{Quadratic } (z^2):  \\quad \\frac{z^2}{2} + \\frac{z^2}{2} = z^2 \\\\\n\\text{Cubic } (z^3):  \\quad \\frac{z^3}{4} \\\\\n\\text{Total in bracket}:  \\quad 6 + 3z + z^2 + \\frac{z^3}{4}\n\\end{align*}\nSubstituting this sum back into the expression for $R(z)$:\n$$R(z) = 1 + \\frac{z}{6} \\left(6 + 3z + z^2 + \\frac{z^3}{4}\\right) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}$$\nThis can be written compactly as the fourth-order Taylor series expansion of $e^z$:\n$$R(z) = \\sum_{k=0}^{4} \\frac{z^k}{k!}$$\nThe absolute stability domain is $\\mathcal{S} = \\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$. The boundary of this domain is given by the curve $|R(z)| = 1$.\n\n### Step 2: Algorithmic Approach\n\nThe problem requires solving three related tasks using this stability function. A core component is a numerical root-finding algorithm. We will implement the bisection method to find a root of a function $f(x)$ within an interval $[a, b]$, provided $f(a)$ and $f(b)$ have opposite signs.\n\n**Part 1: Boundary Intersection on the Negative Real Axis ($x^\\star$)**\nWe must find the largest-magnitude negative real number $x^\\star  0$ such that $|R(x^\\star)|=1$. For $z=x \\in \\mathbb{R}$, $R(x)$ is real. For RK4, it can be shown that $R(x)$ is always greater than -1 for real $x$. Thus, the boundary is determined by $R(x) = 1$.\n- $R(x) = 1 \\implies 1 + x + \\frac{x^2}{2} + \\frac{x^3}{6} + \\frac{x^4}{24} = 1 \\implies x(1 + \\frac{x}{2} + \\frac{x^2}{6} + \\frac{x^3}{24}) = 0$. This has a trivial solution $x=0$. The other boundary point $x^\\star$ is the non-trivial solution.\n- We must find the negative root of $P(x) = 1 + \\frac{x}{2} + \\frac{x^2}{6} + \\frac{x^3}{24}$. A search interval can be established: $P(-4) = -1$ and $P(-2) \\approx 0.333$. A root must exist in $(-4, -2)$. We use bisection to find this root, which is $x^\\star$.\n\n**Part 2: Maximum Admissible Time Step ($h_{\\max}$)**\nGiven a set of eigenvalues $\\{\\lambda_j\\}$, the time step $\\Delta t$ is stable if $\\Delta t\\lambda_j \\in \\mathcal{S}$ for all $j$. This is equivalent to $|R(\\Delta t\\lambda_j)| \\le 1$ for all $j$. We seek the maximum $\\Delta t$, denoted $h_{\\max}$, that satisfies this condition.\nFor each eigenvalue $\\lambda_j = |\\lambda_j|e^{i\\theta_j}$, the condition can be written as $\\Delta t|\\lambda_j| \\le r(\\theta_j)$, where $r(\\theta_j)$ is the radius of the stability boundary at angle $\\theta_j$. This radius is the smallest positive root of the equation $|R(re^{i\\theta_j})|=1$.\nThis gives a constraint on $\\Delta t$ for each eigenvalue: $\\Delta t \\le \\frac{r(\\theta_j)}{|\\lambda_j|}$. To satisfy the condition for all eigenvalues simultaneously, $\\Delta t$ must be less than or equal to the minimum of these individual limits:\n$$h_{\\max} = \\min_{j} \\frac{r(\\theta_j)}{|\\lambda_j|}$$\nTo find $r(\\theta_j)$ for a given $\\theta_j$, we solve the equation $g(r) = |R(re^{i\\theta_j})|-1 = 0$ for $r>0$. For any $\\theta_j$ corresponding to an eigenvalue in the left half-plane ($\\text{Re}(\\lambda_j)  0$), $g(r)$ will be negative for small $r>0$ and positive for large $r$. This allows the use of bisection to find $r(\\theta_j)$.\n\n**Application to Test Cases:**\n\n**Case 1:** $\\lambda \\in \\mathbb{R}$, $\\lambda  0$. We seek $x^\\star$.\nAs derived above, this entails finding the root of $P(x) = 1 + \\frac{x}{2} + \\frac{x^2}{6} + \\frac{x^3}{24}$ in the interval $[-4, -2]$.\n\n**Case 2:** $\\lambda_1 = -1$, $\\lambda_2 = -10$.\nBoth eigenvalues are on the negative real axis ($\\theta = \\pi$). The radius of the stability boundary is $r(\\pi) = |x^\\star|$.\nThe individual time step limits are:\n$h_1 = \\frac{r(\\pi)}{|\\lambda_1|} = \\frac{|x^\\star|}{1} = |x^\\star|$\n$h_2 = \\frac{r(\\pi)}{|\\lambda_2|} = \\frac{|x^\\star|}{10}$\nThe maximum admissible time step is $h_{\\max} = \\min(h_1, h_2) = \\frac{|x^\\star|}{10}$.\n\n**Case 3:** $\\lambda_3 = -2 + 3i$.\nWe first calculate the polar representation of $\\lambda_3$:\n$|\\lambda_3| = \\sqrt{(-2)^2 + 3^2} = \\sqrt{13}$\n$\\theta_3 = \\text{atan2}(3, -2)$\nNext, we find the stability radius $r(\\theta_3)$ by numerically solving $|R(re^{i\\theta_3})| - 1 = 0$ for $r$ using bisection. A suitable search interval for $r$ is $[0, 5]$, as for large $r$, $|R(z)| \\approx |z|^4/24$ grows rapidly.\nThe maximum admissible time step is then $h_{\\max} = \\frac{r(\\theta_3)}{|\\lambda_3|}$.\n\nThe implementation will follow this logic precisely, using a bisection solver and the derived stability function.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the three test cases related to the stability of the RK4 integrator.\n    \"\"\"\n\n    # --- Numerical Utilities ---\n\n    def bisection(f, a, b, tol=1e-12, max_iter=100):\n        \"\"\"\n        Finds a root of function f in the interval [a, b] using the bisection method.\n        Assumes f(a) and f(b) have opposite signs.\n        \"\"\"\n        fa = f(a)\n        if fa == 0:\n            return a\n        fb = f(b)\n        if fb == 0:\n            return b\n        \n        if np.sign(fa) == np.sign(fb):\n            raise ValueError(\"Function has the same sign at the interval endpoints.\")\n\n        for _ in range(max_iter):\n            c = a + (b - a) / 2\n            fc = f(c)\n            if abs(b - a) / 2  tol or fc == 0:\n                return c\n            if np.sign(fc) == np.sign(fa):\n                a = c\n                fa = fc\n            else:\n                b = c\n        return (a + b) / 2\n\n    # --- RK4 Stability Function ---\n\n    def R_rk4(z: complex) -> complex:\n        \"\"\"\n        Computes the stability function for the classical RK4 method.\n        R(z) = 1 + z + z^2/2! + z^3/3! + z^4/4!\n        \"\"\"\n        z2 = z * z\n        z3 = z2 * z\n        z4 = z3 * z\n        return 1 + z + z2 / 2.0 + z3 / 6.0 + z4 / 24.0\n\n    results = []\n\n    # --- Case 1: Boundary intersection on the negative real axis ---\n    \n    # We need to find the root of R(x) = 1 for x  0.\n    # This is equivalent to finding the root of P(x) = 1 + x/2 + x^2/6 + x^3/24 = 0.\n    def p_poly(x: float) -> float:\n        return 1.0 + x/2.0 + x**2/6.0 + x**3/24.0\n\n    # The interval [-4.0, -2.0] brackets the root.\n    # p_poly(-4) = -1.0\n    # p_poly(-2) = 1/3\n    x_star = bisection(p_poly, -4.0, -2.0)\n    results.append(x_star)\n\n    # --- Case 2: Real eigenvalues, scaling behavior ---\n\n    # For eigenvalues lambda_j, h_max = min_j( r(theta_j) / |lambda_j| ).\n    # Lambda = -1 and -10 are on the negative real axis (theta = pi).\n    # The boundary radius r(pi) is |x_star|.\n    # h_max = min( |x_star|/|-1|, |x_star|/|-10| ) = |x_star|/10.\n    \n    hmax_case2 = abs(x_star) / 10.0\n    results.append(hmax_case2)\n\n    # --- Case 3: Complex eigenvalue, directional boundary ---\n\n    # For lambda = -2 + 3i, find h_max.\n    lambda3 = -2.0 + 3.0j\n    abs_lambda3 = np.abs(lambda3)\n    theta3 = np.angle(lambda3)\n\n    # We need to find the radius r(theta3) of the stability boundary.\n    # This is done by solving |R(r * exp(i*theta))| - 1 = 0 for r.\n    def boundary_radius_func(r: float) -> float:\n        z = r * np.exp(1j * theta3)\n        return np.abs(R_rk4(z)) - 1.0\n\n    # For r=0, func=-0. For large r, func>0. The search interval [0, 5] is safe.\n    # Using a small positive lower bound to avoid r=0 being found.\n    r_theta3 = bisection(boundary_radius_func, 1e-9, 5.0)\n    \n    hmax_case3 = r_theta3 / abs_lambda3\n    results.append(hmax_case3)\n\n    # --- Final Output Formatting ---\n    \n    output_str = f\"[{results[0]:.6f},{results[1]:.6f},{results[2]:.6f}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the ability to define a stability domain, this exercise connects the theory of ordinary differential equation (ODE) integrators to the analysis of partial differential equations (PDEs). You will analyze the semi-discretized 2D heat equation, a canonical diffusion problem in CFD, to derive the spectrum of the spatial operator from first principles. This practice culminates in deriving a precise analytical formula for the maximum stable time step, linking the spectral radius of the PDE discretization directly to the stability limits of the RK4 integrator .",
            "id": "3996110",
            "problem": "Consider the two-dimensional ($2$D) heat equation in Computational Fluid Dynamics (CFD) on a square periodic domain discretized by the method of lines. Let the thermal diffusivity be $\\kappa$ (with units $\\mathrm{m^2/s}$). On a uniform Cartesian grid with spacing $h$ in both directions, approximate the Laplacian $\\nabla^2$ by the standard second-order five-point finite difference stencil with periodic boundary conditions, yielding a linear autonomous semi-discrete system $\\mathbf{u}_{t} = \\mathbf{A} \\mathbf{u}$, where $\\mathbf{A} = \\kappa L_{h}$ and $L_{h}$ is the discrete Laplacian matrix.\n\nUsing only:\n- the definition of the discrete Fourier modes on a periodic uniform grid,\n- the fact that absolute stability of a one-step method applied to $y'=\\lambda y$ requires $\\max_{\\lambda \\in \\sigma(\\mathbf{A})} |R(\\Delta t\\,\\lambda)| \\le 1$, where $R$ is the method’s stability function and $\\sigma(\\mathbf{A})$ is the spectrum of $\\mathbf{A}$,\n- and the classical $4$-stage explicit Runge–Kutta method (RK$4$) as the time integrator,\n\nderive from first principles:\n$1)$ the spectral radius $\\rho(\\mathbf{A})$ for the operator $\\mathbf{A}=\\kappa L_{h}$, and\n$2)$ the maximum stable explicit time step $\\Delta t_{\\max}$ for RK$4$ such that $\\max_{z \\in \\Delta t\\,\\sigma(\\mathbf{A})} |R(z)| \\le 1$.\n\nReport your final answer as a single symbolic expression for $\\Delta t_{\\max}$ in terms of $h$ and $\\kappa$, using a single numerical constant rounded to four significant figures. Express the final time step in seconds.",
            "solution": "The problem asks for the derivation of the maximum stable time step for the 2D heat equation discretized with a standard finite difference scheme and integrated with the RK4 method. The derivation proceeds from first principles.\n\nThe semi-discrete system is given by $\\mathbf{u}_t = \\mathbf{A} \\mathbf{u}$, where $\\mathbf{A} = \\kappa L_h$. Here, $L_h$ is the matrix representation of the second-order five-point finite difference stencil for the Laplacian $\\nabla^2$ on a uniform Cartesian grid with spacing $h$. For a grid function $u_{i,j}$ defined at grid points $(x_i, y_j)$, the action of the discrete Laplacian is:\n$$ (L_h \\mathbf{u})_{i,j} = \\frac{u_{i+1, j} + u_{i-1, j} + u_{i, j+1} + u_{i, j-1} - 4 u_{i, j}}{h^2} $$\n\n**$1)$ Derivation of the Spectrum and Spectral Radius of $\\mathbf{A}$**\n\nTo find the eigenvalues of the operator $\\mathbf{A}$, we analyze its action on the discrete Fourier modes, which are the eigenfunctions for a linear, constant-coefficient operator on a periodic domain. A generic $2$D discrete Fourier mode is given by:\n$$ u_{i,j}^{(k_x, k_y)} = \\exp(i(k_x x_i + k_y y_j)) = \\exp(i(k_x i h + k_y j h)) $$\nwhere $i = \\sqrt{-1}$ is the imaginary unit, and $k_x$ and $k_y$ are the wavenumbers in the $x$ and $y$ directions, respectively.\n\nApplying the operator $L_h$ to this mode yields:\n$$ (L_h \\mathbf{u}^{(k_x, k_y)})_{i,j} = \\frac{1}{h^2} \\left[ \\exp(i(k_x(i+1)h + k_yjh)) + \\exp(i(k_x(i-1)h + k_yjh)) + \\dots - 4u_{i,j}^{(k_x, k_y)} \\right] $$\nFactoring out the term $u_{i,j}^{(k_x, k_y)}$:\n$$ (L_h \\mathbf{u}^{(k_x, k_y)})_{i,j} = \\frac{u_{i,j}^{(k_x, k_y)}}{h^2} \\left[ \\exp(i k_x h) + \\exp(-i k_x h) + \\exp(i k_y h) + \\exp(-i k_y h) - 4 \\right] $$\nUsing the identity $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$, we find the eigenvalues of $L_h$:\n$$ \\lambda_{L_h}(k_x, k_y) = \\frac{1}{h^2} \\left[ 2\\cos(k_x h) + 2\\cos(k_y h) - 4 \\right] = \\frac{2}{h^2} \\left[ \\cos(k_x h) + \\cos(k_y h) - 2 \\right] $$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we can rewrite this as:\n$$ \\lambda_{L_h}(k_x, k_y) = -\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] $$\nThe eigenvalues of the operator $\\mathbf{A} = \\kappa L_h$ are $\\lambda_{\\mathbf{A}} = \\kappa \\lambda_{L_h}$:\n$$ \\lambda_{\\mathbf{A}}(k_x, k_y) = -\\frac{4\\kappa}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] $$\nThese eigenvalues are real and non-positive, which is characteristic of a diffusion operator.\n\nThe spectral radius, $\\rho(\\mathbf{A})$, is the maximum of the absolute values of the eigenvalues in the spectrum $\\sigma(\\mathbf{A})$.\n$$ \\rho(\\mathbf{A}) = \\max_{k_x, k_y} |\\lambda_{\\mathbf{A}}(k_x, k_y)| = \\max_{k_x, k_y} \\left| -\\frac{4\\kappa}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] \\right| $$\nThe maximum value is achieved when the sinusoidal terms are maximized. The term $\\sin^2(\\theta/2)$ is maximized to $1$ when $\\theta = \\pm\\pi$. For the grid, the dimensionless wavenumbers $k_x h$ and $k_y h$ range over $[-\\pi, \\pi]$. The maximum is thus found at the highest resolvable frequencies, $k_x h = \\pi$ and $k_y h = \\pi$.\n$$ \\rho(\\mathbf{A}) = \\frac{4\\kappa}{h^2} \\left[ \\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) \\right] = \\frac{4\\kappa}{h^2} [1 + 1] = \\frac{8\\kappa}{h^2} $$\n\n**$2)$ Derivation of the Maximum Stable Time Step $\\Delta t_{\\max}$**\n\nThe stability of a one-step integrator is governed by its stability function, $R(z)$. For a method to be stable, the quantity $z = \\Delta t \\lambda$ must lie within the method's region of absolute stability for all eigenvalues $\\lambda$ of the system matrix. This is expressed as $|R(\\Delta t \\lambda)| \\le 1$ for all $\\lambda \\in \\sigma(\\mathbf{A})$.\n\nFor the classical $4$-stage explicit Runge-Kutta method (RK$4$), the stability function is the fourth-order Taylor polynomial of the exponential function:\n$$ R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} $$\nThe eigenvalues of our operator $\\mathbf{A}$ are all real and negative. Therefore, we only need to consider the interval of absolute stability of RK$4$ on the negative real axis. This interval is of the form $[-S, 0]$, where $S>0$. For the RK4 method, the stability function $R(x)$ for real $x0$ is always greater than $-1$. Thus, the boundary of the stability region on the negative real axis is determined by the first non-zero root of $R(x) = 1$. Let $S = -x$. The equation becomes $R(-S)=1$:\n$$ 1 - S + \\frac{S^2}{2} - \\frac{S^3}{6} + \\frac{S^4}{24} = 1 $$\nFor $S \\ne 0$, this simplifies to the cubic equation:\n$$ -1 + \\frac{S}{2} - \\frac{S^2}{6} + \\frac{S^3}{24} = 0 $$\nSolving this for the smallest positive real root yields $S \\approx 2.7852915 \\ldots$.\n\nThe stability condition requires that for all eigenvalues $\\lambda_{\\mathbf{A}} \\in \\sigma(\\mathbf{A})$, we must have $\\Delta t \\lambda_{\\mathbf{A}} \\in [-S, 0]$. Since all $\\lambda_{\\mathbf{A}}$ are non-positive, this condition simplifies to:\n$$ \\Delta t \\lambda_{\\min} \\ge -S $$\nwhere $\\lambda_{\\min}$ is the most negative eigenvalue of $\\mathbf{A}$. This eigenvalue corresponds to the spectral radius:\n$$ \\lambda_{\\min} = - \\rho(\\mathbf{A}) = -\\frac{8\\kappa}{h^2} $$\nSubstituting this into the stability inequality:\n$$ \\Delta t \\left(-\\frac{8\\kappa}{h^2}\\right) \\ge -S $$\nMultiplying by $-1$ and reversing the inequality sign:\n$$ \\Delta t \\frac{8\\kappa}{h^2} \\le S $$\nThe maximum stable time step, $\\Delta t_{\\max}$, is found when this inequality is an equality:\n$$ \\Delta t_{\\max} = \\frac{S h^2}{8\\kappa} $$\nSubstituting the numerical value for $S$ and computing the constant coefficient:\n$$ \\Delta t_{\\max} = \\frac{2.7852915 \\ldots}{8} \\frac{h^2}{\\kappa} \\approx 0.3481614 \\frac{h^2}{\\kappa} $$\nRounding the numerical constant to four significant figures as required:\n$$ \\Delta t_{\\max} = 0.3482 \\frac{h^2}{\\kappa} $$\nThe units of this expression are $(\\mathrm{m}^2) / (\\mathrm{m}^2/\\mathrm{s}) = \\mathrm{s}$, which is consistent with a time step.",
            "answer": "$$\\boxed{0.3482 \\frac{h^2}{\\kappa}}$$"
        },
        {
            "introduction": "The choice of time integrator is not arbitrary; it depends on the physics of the problem being solved. This practice shifts focus from diffusion-dominated problems (with real eigenvalues) to advection-dominated ones (with purely imaginary eigenvalues), a common scenario in aerospace CFD. By comparing the stability properties of a Runge-Kutta method with a linear multistep method (Adams-Bashforth), you will develop critical insight into selecting an appropriate scheme based on the shape of its stability domain and its robustness to numerical dissipation .",
            "id": "3996080",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ with constant speed $a > 0$ on a periodic domain, semi-discretized in space on a uniform grid of spacing $\\Delta x$ using the centered difference operator for $u_x$. Let $\\mathbf{y}(t)$ denote the vector of grid point values. The method-of-lines semi-discrete system can be written as $\\mathbf{y}'(t) = \\mathbf{L}\\,\\mathbf{y}(t)$, where $\\mathbf{L}$ is the spatial discretization matrix. For the centered difference operator on a periodic grid, the Fourier symbols of $\\mathbf{L}$ are purely imaginary, so its eigenvalues can be written as $\\lambda_k = i\\,\\omega_k$, where $\\omega_k \\in \\mathbb{R}$ depends on $a$ and $\\Delta x$ via the discrete wavenumber.\n\nDefine the Courant number $C = a\\,\\Delta t / \\Delta x$ associated with a time step $\\Delta t$. Consider two explicit time integrators applied to the scalar linear test equation $y' = \\lambda y$ (representing each eigenmode), with $z = \\lambda \\Delta t$:\n\n- The second-order Adams–Bashforth method (AB2), a two-step linear multistep method, given by $y_{n+1} = y_n + \\Delta t\\left(\\frac{3}{2} f(y_n) - \\frac{1}{2} f(y_{n-1})\\right)$.\n- A classical two-stage, second-order explicit Runge–Kutta method (RK2) with stages $k_1 = f(y_n)$, $k_2 = f\\left(y_n + \\Delta t\\,k_1\\right)$, and update $y_{n+1} = y_n + \\frac{\\Delta t}{2}\\left(k_1 + k_2\\right)$.\n\nStarting from the fundamental base of (i) the method-of-lines formulation for hyperbolic advection with centered differences (purely imaginary semi-discrete spectrum) and (ii) the linear test equation $y' = \\lambda y$, analyze the absolute stability of AB2 and RK2 along the imaginary axis ($z = i\\,\\beta$, $\\beta \\in \\mathbb{R}$). Then, using first principles, determine and compare the largest continuous interval on the negative real axis ($z \\in \\mathbb{R}_{-}$) contained in the absolute stability regions of AB2 and RK2. Finally, based on these findings, reason about robustness for advection-dominated Computational Fluid Dynamics (CFD) semi-discretizations in which modest upwinding or filtering adds a small negative real part to the spectrum, shifting eigenvalues to $z \\approx -\\alpha + i\\,\\beta$ with $\\alpha > 0$ small.\n\nWhich statement is most accurate?\n\nA. Along $z = i\\,\\beta$, both AB2 and RK2 are absolutely stable for $|\\beta| \\le 1$, and AB2 is more robust for advection-dominated CFD because its real-negative stability interval is wider than that of RK2.\n\nB. Along $z = i\\,\\beta$, both AB2 and RK2 are absolutely unstable for any nonzero $\\beta$; for real-negative $z$, RK2 admits $z \\in [-2, 0]$ whereas AB2 admits only $z \\in [-1, 0]$. Thus, with advection-dominated CFD semi-discretizations that introduce a small negative real part, RK2 allows larger Courant numbers and AB2 is less robust.\n\nC. RK2 is absolutely stable on the entire imaginary axis while AB2 is not; therefore RK2 is always more robust for advection-dominated CFD.\n\nD. AB2 is absolutely stable for $|z| \\le 1$ on the imaginary axis while RK2 is absolutely unstable there; therefore AB2 is more robust for advection-dominated CFD.",
            "solution": "This problem requires a comparative stability analysis of the second-order Adams-Bashforth (AB2) method and a specific second-order Runge-Kutta (RK2) method. The analysis focuses on their behavior on the imaginary and negative real axes of the complex plane, which corresponds to pure advection and pure diffusion problems, respectively.\n\n### Step 1: Derive Stability Functions/Polynomials\n\nThe stability of a time integrator is analyzed by applying it to the linear test equation $y' = \\lambda y$. We define $z = \\lambda \\Delta t$.\n\n**RK2 Method (Explicit Midpoint Rule):**\nThe method is defined by $k_1 = f(y_n)$, $k_2 = f(y_n + \\Delta t k_1)$, and $y_{n+1} = y_n + \\frac{\\Delta t}{2}(k_1 + k_2)$.\nApplying to $y' = \\lambda y$:\n$k_1 = \\lambda y_n$\n$k_2 = \\lambda(y_n + \\Delta t (\\lambda y_n)) = \\lambda y_n (1 + z)$\n$y_{n+1} = y_n + \\frac{\\Delta t}{2}(\\lambda y_n + \\lambda y_n(1+z)) = y_n (1 + \\frac{z}{2}(1 + 1+z)) = y_n (1 + z + \\frac{z^2}{2})$\nThe stability function (or amplification factor) for this one-step method is $R_{\\text{RK2}}(z) = 1 + z + \\frac{z^2}{2}$. The method is stable if $|R_{\\text{RK2}}(z)| \\le 1$.\n\n**AB2 Method:**\nThe two-step method is $y_{n+1} = y_n + \\Delta t (\\frac{3}{2} f(y_n) - \\frac{1}{2} f(y_{n-1}))$.\nApplying to $y' = \\lambda y$:\n$y_{n+1} = y_n + \\Delta t (\\frac{3}{2} \\lambda y_n - \\frac{1}{2} \\lambda y_{n-1})$\n$y_{n+1} - (1 + \\frac{3}{2}z) y_n + \\frac{1}{2}z y_{n-1} = 0$\nThis is a linear recurrence relation. We look for solutions of the form $y_n = \\xi^n$, which leads to the stability polynomial:\n$\\pi_{\\text{AB2}}(\\xi, z) = \\xi^2 - (1 + \\frac{3}{2}z)\\xi + \\frac{1}{2}z = 0$\nThe method is stable if both roots $\\xi$ of this polynomial satisfy $|\\xi| \\le 1$ (the root condition).\n\n### Step 2: Analyze Stability on the Imaginary Axis ($z = i\\beta, \\beta \\in \\mathbb{R}$)\n\n**RK2:** We check the stability condition $|R_{\\text{RK2}}(i\\beta)| \\le 1$.\n$R_{\\text{RK2}}(i\\beta) = 1 + i\\beta + \\frac{(i\\beta)^2}{2} = (1 - \\frac{\\beta^2}{2}) + i\\beta$\n$|R_{\\text{RK2}}(i\\beta)|^2 = (1 - \\frac{\\beta^2}{2})^2 + \\beta^2 = 1 - \\beta^2 + \\frac{\\beta^4}{4} + \\beta^2 = 1 + \\frac{\\beta^4}{4}$\nThe stability condition $|R_{\\text{RK2}}(i\\beta)|^2 \\le 1$ requires $1 + \\frac{\\beta^4}{4} \\le 1$, which implies $\\beta^4 \\le 0$. This is only true for $\\beta=0$. Thus, RK2 is unstable for any non-zero point on the imaginary axis.\n\n**AB2:** We check the roots of $\\pi_{\\text{AB2}}(\\xi, i\\beta) = 0$. For a method to be stable on the imaginary axis, the roots of its stability polynomial must be on or inside the unit circle. A common way for multistep methods to become unstable is for one root to immediately leave the unit circle for any infinitesimal $z$. At $z=0$, the roots are $\\xi=0$ and $\\xi=1$. For a small perturbation $z=i\\beta$, one root is approximately $\\xi_1 \\approx 1 + \\frac{3}{2}z = 1 + i\\frac{3}{2}\\beta$. The modulus is $|\\xi_1|^2 \\approx 1 + (\\frac{3}{2}\\beta)^2 > 1$ for any $\\beta \\neq 0$. Thus, AB2 is also unstable for any non-zero point on the imaginary axis.\n\n**Conclusion for Imaginary Axis:** Both methods are unstable for purely imaginary eigenvalues, as generated by centered differencing of the advection equation.\n\n### Step 3: Analyze Stability on the Negative Real Axis ($z=x \\le 0$)\n\n**RK2:** We need $|1 + x + \\frac{x^2}{2}| \\le 1$. Since $x$ is real, this is $-1 \\le 1 + x + \\frac{x^2}{2} \\le 1$.\n1.  $1 + x + \\frac{x^2}{2} \\le 1 \\implies x + \\frac{x^2}{2} \\le 0 \\implies x(1 + \\frac{x}{2}) \\le 0$. For $x \\le 0$, this means $1 + \\frac{x}{2} \\ge 0$, so $x \\ge -2$.\n2.  $1 + x + \\frac{x^2}{2} \\ge -1 \\implies x^2 + 2x + 4 \\ge 0$. The discriminant is $2^2 - 4(1)(4) = -12  0$. Since the parabola opens upwards, this is true for all real $x$.\nCombining the conditions, the stability interval for RK2 is $[-2, 0]$.\n\n**AB2:** We need the roots of $\\xi^2 - (1 + \\frac{3}{2}x)\\xi + \\frac{1}{2}x = 0$ to satisfy $|\\xi| \\le 1$. The boundary of the stability interval is where a root first has magnitude 1. This occurs when $\\xi=1$ or $\\xi=-1$.\n1.  Set $\\xi = 1$: $1 - (1 + \\frac{3}{2}x) + \\frac{1}{2}x = 0 \\implies -x = 0 \\implies x = 0$.\n2.  Set $\\xi = -1$: $1 - (1 + \\frac{3}{2}x)(-1) + \\frac{1}{2}x = 0 \\implies 1 + 1 + \\frac{3}{2}x + \\frac{1}{2}x = 0 \\implies 2 + 2x = 0 \\implies x = -1$.\nChecking a point between, like $x=-0.5$, gives roots with magnitude less than 1. For $x  -1$, at least one root has magnitude greater than 1.\nThe stability interval for AB2 is $[-1, 0]$.\n\n**Conclusion for Real Axis:** RK2 has a stability interval on the negative real axis of $[-2, 0]$, which is twice as wide as that of AB2, which is $[-1, 0]$.\n\n### Step 4: Final Reasoning and Option Selection\n\n*   **Premise:** CFD semi-discretizations for advection-dominated flows often have eigenvalues that are primarily imaginary but have a small negative real part due to numerical or artificial dissipation ($z \\approx -\\alpha + i\\beta$).\n*   **Reasoning:** A robust scheme should have a stability region that accommodates these eigenvalues. Although both schemes are unstable on the pure imaginary axis, their stability regions have non-zero area in the left-half complex plane. The size of this region dictates the maximum allowable time step (and Courant number). Our analysis of the negative real axis intercept gives a strong indication of the overall size of the stability region in the left half-plane.\n*   **Comparison:** The RK2 method's stability region extends to $z=-2$ on the real axis, while the AB2 region only extends to $z=-1$. This indicates that the RK2 stability domain is significantly larger. Therefore, for a given set of eigenvalues with small negative real parts, RK2 will allow for a larger time step before an eigenvalue leaves the stability region. This makes RK2 more robust and allows for larger Courant numbers compared to AB2 in this context.\n\n**Evaluating the Options:**\n*   A: Incorrect. Both are unstable on the imaginary axis, and AB2's real stability interval is narrower, making it less robust.\n*   B: Correct. It correctly states that both are unstable on the imaginary axis for non-zero $\\beta$. It correctly identifies the real stability intervals as $[-2, 0]$ for RK2 and $[-1, 0]$ for AB2. It correctly concludes that RK2 is more robust and allows larger Courant numbers for the described CFD problem.\n*   C: Incorrect. RK2 is not stable on the entire imaginary axis.\n*   D: Incorrect. AB2 is not stable on the imaginary axis.\n\nTherefore, statement B is the most accurate description of the situation.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}