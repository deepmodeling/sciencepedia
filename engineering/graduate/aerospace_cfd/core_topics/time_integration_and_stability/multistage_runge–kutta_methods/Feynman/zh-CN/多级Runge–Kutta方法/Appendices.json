{
    "hands_on_practices": [
        {
            "introduction": "理解多级龙格-库塔方法的第一步是熟悉其标准表示法。本练习将指导您将经典的四级四阶龙格-库塔（RK4）方法，从其传统的 $k$ 斜率形式转换为更通用和强大的布彻表（Butcher tableau）。掌握这种表示法至关重要，因为它是分析、比较和实现各种龙格-库塔格式的通用语言。",
            "id": "3978547",
            "problem": "一个基于线方法的压缩流求解器，通过对可压缩Navier–Stokes方程中的空间算子进行离散化，得到一个形式为 $\\frac{d\\boldsymbol{U}}{dt}=\\boldsymbol{L}(\\boldsymbol{U},t)$ 的关于时间的常微分方程组（ODE）。其中，$\\boldsymbol{U}$ 是守恒变量向量，$\\boldsymbol{L}$ 是半离散空间算子。时间推进通过一个 $s$ 级显式龙格-库塔（RK）方法进行，该方法由一个包含系数矩阵 $A=\\{a_{ij}\\}$、权重 $\\boldsymbol{b}=\\{b_i\\}$ 和节点横坐标 $\\boldsymbol{c}=\\{c_i\\}$ 的布彻表表示。\n\n考虑标准的经典四级四阶显式龙格-库塔方法（常用于航空航天计算流体动力学 (CFD)）。\n\n任务：\n- 写出其布彻表 $(A,\\boldsymbol{b},\\boldsymbol{c})$。\n- 对于应用于 $\\frac{dy}{dt}=f(t,y)$ 的显式龙格-库塔方法，其阶段更新公式为 $Y_i=y^n+\\Delta t\\sum_{j=1}^{i-1}a_{ij}f(t^n+c_j\\Delta t,Y_j)$ 和 $y^{n+1}=y^n+\\Delta t\\sum_{i=1}^s b_i f(t^n+c_i\\Delta t,Y_i)$。利用这些定义，推导并验证该显式方法每个阶段 $i$ 的内部一致性条件 $c_i=\\sum_{j=1}^{i-1}a_{ij}$。\n- 定义标量残差\n$$\nR \\equiv \\sum_{i=1}^{s}\\left(c_i-\\sum_{j=1}^{i-1}a_{ij}\\right)^{2}.\n$$\n计算经典四级四阶显式龙格-库塔方法的 $R$ 值。将最终结果表示为一个精确的、无量纲的、无舍入的实数。",
            "solution": "该问题已被验证为具有科学依据、适定、客观和完整。它提出了一套与经典四级四阶显式龙格-库塔方法相关的标准任务，该方法是常微分方程数值分析的基石。所提供的定义和背景在计算科学与工程领域是标准的。因此，我们可以进行完整解答。\n\n该问题要求完成关于应用于形式为 $\\frac{dy}{dt} = f(t,y)$ 的常微分方程（ODE）的经典四级四阶显式龙格-库塔（RK4）方法的三个任务。\n\n**任务1：经典RK4方法的布彻表**\n\n经典RK4方法由以下从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的一个步长内的阶段计算序列定义：\n$$\nk_1 = f(t^n, y^n) \\\\\nk_2 = f\\left(t^n + \\frac{1}{2}\\Delta t, y^n + \\frac{1}{2}\\Delta t k_1\\right) \\\\\nk_3 = f\\left(t^n + \\frac{1}{2}\\Delta t, y^n + \\frac{1}{2}\\Delta t k_2\\right) \\\\\nk_4 = f\\left(t^n + \\Delta t, y^n + \\Delta t k_3\\right)\n$$\n然后，解通过这些阶段导数的加权平均进行推进：\n$$\ny^{n+1} = y^n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n一个 $s$ 级显式龙格-库塔方法的一般形式由一个布彻表给出：\n$$\n\\begin{array}{c|c}\n\\boldsymbol{c}  A \\\\\n\\hline\n  \\boldsymbol{b}^T\n\\end{array}\n=\n\\begin{array}{c|cccc}\nc_1  a_{11}  a_{12}  \\dots  a_{1s} \\\\\nc_2  a_{21}  a_{22}  \\dots  a_{2s} \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\nc_s  a_{s1}  a_{s2}  \\dots  a_{ss} \\\\\n\\hline\n  b_1  b_2  \\dots  b_s\n\\end{array}\n$$\n阶段值 $Y_i$ 和阶段导数 $k_i$ 定义为：\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{s} a_{ij} k_j \\quad \\text{和} \\quad k_i = f(t^n + c_i \\Delta t, Y_i)\n$$\n对于显式方法，矩阵 $A$ 是严格下三角矩阵，即当 $j \\ge i$ 时 $a_{ij} = 0$。因此 $Y_i$ 的求和变为 $\\sum_{j=1}^{i-1} a_{ij} k_j$。\n\n通过将标准RK4公式与一般形式进行比较，我们可以提取出系数。\n阶段时间分数 $c_i$ 是 $f$ 的时间自变量中 $\\Delta t$ 的系数：\n$c_1 = 0$, $c_2 = \\frac{1}{2}$, $c_3 = \\frac{1}{2}$, $c_4 = 1$。向量 $\\boldsymbol{c}$ 是 $\\boldsymbol{c} = \\begin{pmatrix} 0  \\frac{1}{2}  \\frac{1}{2}  1 \\end{pmatrix}^T$。\n\n系数 $a_{ij}$ 是用于计算第 $i$ 阶段的 $f$ 的自变量时 $\\Delta t k_j$ 的系数。\n对于 $k_1$：自变量是 $y^n$。这对应于 $Y_1 = y^n$。求和 $\\sum a_{1j}k_j$ 为空。\n对于 $k_2$：自变量是 $y^n + \\frac{1}{2} \\Delta t k_1$。这意味着 $Y_2 = y^n + \\frac{1}{2}\\Delta t k_1$。与 $Y_2 = y^n + \\Delta t (a_{21} k_1 + \\dots)$ 比较，我们发现 $a_{21} = \\frac{1}{2}$，其他 $a_{2j}$ 为 $0$。\n对于 $k_3$：自变量是 $y^n + \\frac{1}{2} \\Delta t k_2$。这意味着 $Y_3 = y^n + \\frac{1}{2}\\Delta t k_2$。与 $Y_3 = y^n + \\Delta t (a_{31} k_1 + a_{32} k_2 + \\dots)$ 比较，我们发现 $a_{31} = 0$，$a_{32} = \\frac{1}{2}$。\n对于 $k_4$：自变量是 $y^n + \\Delta t k_3$。这意味着 $Y_4 = y^n + \\Delta t k_3$。与 $Y_4 = y^n + \\Delta t (a_{41} k_1 + a_{42} k_2 + a_{43} k_3 + \\dots)$ 比较，我们发现 $a_{41} = 0$，$a_{42} = 0$，$a_{43} = 1$。\n因此矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  0  0  0 \\\\\n\\frac{1}{2}  0  0  0 \\\\\n0  \\frac{1}{2}  0  0 \\\\\n0  0  1  0\n\\end{pmatrix}\n$$\n最终的权重 $b_i$ 是更新公式 $y^{n+1} = y^n + \\Delta t \\sum_{i=1}^s b_i k_i$ 中的系数。\n从 $y^{n+1} = y^n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)$，我们得到：\n$b_1 = \\frac{1}{6}$, $b_2 = \\frac{2}{6} = \\frac{1}{3}$, $b_3 = \\frac{2}{6} = \\frac{1}{3}$, $b_4 = \\frac{1}{6}$。向量 $\\boldsymbol{b}$ 是 $\\boldsymbol{b} = \\begin{pmatrix} \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6} \\end{pmatrix}^T$。\n\n综合这些，经典RK4方法的布彻表为：\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\n\n**任务2：一致性条件的推导与验证**\n\n内部一致性条件 $c_i = \\sum_{j=1}^{i-1} a_{ij}$ 将阶段时间分数与方法系数联系起来。它确保每个阶段提供的近似至少具有一阶精度。\n\n为了推导这个条件，我们考虑一个简单的测试问题：自治ODE $\\frac{dy}{dt} = 1$，初始条件为 $y(t^n)=t^n$。其精确解为 $y(t)=t$。\n阶段导数为 $k_j = f(t^n + c_j \\Delta t, Y_j) = 1$ 对所有 $j$ 成立。\n阶段值 $Y_i$ 按照问题陈述中对显式方法的规定计算：\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} f(t^n+c_j \\Delta t, Y_j) = y^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} (1) = t^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij}\n$$\n阶段计算的目的是为了近似在中间时间点 $t^n + c_i \\Delta t$ 的解。对于我们的测试问题，此时间点的精确解为 $y(t^n + c_i \\Delta t) = t^n + c_i \\Delta t$。\n为了使数值阶段值 $Y_i$ 与阶段时间点的精确解保持一致，我们必须令两个表达式相等：\n$$\nt^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} = t^n + c_i \\Delta t\n$$\n两边减去 $t^n$ 并除以 $\\Delta t \\neq 0$ 即可得到该条件：\n$$\nc_i = \\sum_{j=1}^{i-1} a_{ij}\n$$\n这个推导表明，该条件是方法能够正确积分函数 $y(t)=t$ 的必要条件。\n\n现在，我们使用经典RK4方法的布彻表中的系数，对每个阶段（$i=1, \\dots, 4$）验证此条件。\n-   对于阶段 $i=1$：\n    $c_1 = 0$。求和项为 $\\sum_{j=1}^{0} a_{1j}$，这是一个空和，定义为 $0$。因此，$0 = 0$。条件成立。\n-   对于阶段 $i=2$：\n    $c_2 = \\frac{1}{2}$。求和项为 $\\sum_{j=1}^{1} a_{2j} = a_{21} = \\frac{1}{2}$。因此，$\\frac{1}{2} = \\frac{1}{2}$。条件成立。\n-   对于阶段 $i=3$：\n    $c_3 = \\frac{1}{2}$。求和项为 $\\sum_{j=1}^{2} a_{3j} = a_{31} + a_{32} = 0 + \\frac{1}{2} = \\frac{1}{2}$。因此，$\\frac{1}{2} = \\frac{1}{2}$。条件成立。\n-   对于阶段 $i=4$：\n    $c_4 = 1$。求和项为 $\\sum_{j=1}^{3} a_{4j} = a_{41} + a_{42} + a_{43} = 0 + 0 + 1 = 1$。因此，$1 = 1$。条件成立。\n\n内部一致性条件 $c_i = \\sum_{j=1}^{i-1}a_{ij}$ 对于经典RK4方法的所有四个阶段都满足。\n\n**任务3：标量残差 $R$ 的计算**\n\n标量残差 $R$ 定义为：\n$$\nR \\equiv \\sum_{i=1}^{s}\\left(c_i-\\sum_{j=1}^{i-1}a_{ij}\\right)^{2}\n$$\n对于经典RK4方法，级数 $s=4$。在前面的任务中，我们验证了对于每个阶段 $i \\in \\{1, 2, 3, 4\\}$，括号内的项都恰好为零。\n让我们写出 $R$ 的求和式：\n$$\nR = \\left(c_1 - \\sum_{j=1}^{0} a_{1j}\\right)^{2} + \\left(c_2 - \\sum_{j=1}^{1} a_{2j}\\right)^{2} + \\left(c_3 - \\sum_{j=1}^{2} a_{3j}\\right)^{2} + \\left(c_4 - \\sum_{j=1}^{3} a_{4j}\\right)^{2}\n$$\n代入我们在验证步骤中计算出的值：\n-   第1项 ($i=1$)： $(0 - 0)^2 = 0^2 = 0$\n-   第2项 ($i=2$)： $(\\frac{1}{2} - \\frac{1}{2})^2 = 0^2 = 0$\n-   第3项 ($i=3$)： $(\\frac{1}{2} - \\frac{1}{2})^2 = 0^2 = 0$\n-   第4项 ($i=4$)： $(1 - 1)^2 = 0^2 = 0$\n\n将这些项相加，得到 $R$ 的值：\n$$\nR = 0 + 0 + 0 + 0 = 0\n$$\n经典四级四阶显式龙格-库塔方法的标量残差 $R$ 的值为 $0$。这个结果是该方法在每个阶段都满足内部一致性条件的直接推论。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在掌握了布彻表表示法之后，下一步是将其与方法的实际性能联系起来。本练习通过验证经典的 RK4 方法的阶条件，深入探讨了其四阶精度的来源 。此外，您将推导其稳定性函数 $R(z)$，这是评估数值方法在求解不同类型微分方程时的稳定性和选择合适时间步长的核心工具。",
            "id": "3978527",
            "problem": "考虑航空航天计算流体力学 (CFD) 中出现的可压缩欧拉方程的半离散形式，其被写为关于守恒变量向量 $\\boldsymbol{q}(t)$ 的自治常微分方程组（ODE），\n$$\n\\frac{d\\boldsymbol{q}}{dt} = \\boldsymbol{L}(\\boldsymbol{q}),\n$$\n其中 $\\boldsymbol{L}$ 是空间离散算子。应用于一般自治常微分方程 $\\frac{dy}{dt} = f(y)$ 的单步 $s$ 级显式龙格-库塔方法定义为\n$$\nY_{i} = y_{n} + h \\sum_{j=1}^{s} a_{ij} K_{j}, \\quad K_{i} = f(Y_{i}), \\quad i = 1,\\dots,s, \\qquad y_{n+1} = y_{n} + h \\sum_{i=1}^{s} b_{i} K_{i},\n$$\n其中步长为 $h$，系数为 $a_{ij}$、$b_{i}$，横坐标为 $c_{i}$，对于显式方法，满足 $c_{i} = \\sum_{j=1}^{s} a_{ij}$。\n\n给定经典的 4 级龙格-库塔方法 (RK4)，其布彻表为\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\n于是 $s=4$，$b = \\left(\\frac{1}{6}, \\frac{1}{3}, \\frac{1}{3}, \\frac{1}{6}\\right)$，$c = \\left(0, \\frac{1}{2}, \\frac{1}{2}, 1\\right)$，且 $A$ 是一个严格下三角矩阵，其非零项为 $a_{21} = \\frac{1}{2}$，$a_{32} = \\frac{1}{2}$，$a_{43} = 1$。\n\n从第一性原理出发，不借助根树理论，通过将自治常微分方程 $\\frac{dy}{dt} = f(y)$ 的精确流映射 $y(t+h)$ 以 $f$ 的 Fréchet 导数表示的泰勒级数与龙格-库塔更新式的形式展开进行匹配，推导出直至 $p=4$ 阶的基本阶条件。验证所给的 RK4 系数满足所有推导出的直至 $p=4$ 阶的基本代数阶条件。\n\n最后，对于线性测试方程 $\\frac{dy}{dt} = \\lambda y$（其中 $z = \\lambda h$），计算给定 RK4 方法的稳定性函数 $R(z)$，当该方法应用于此测试问题时，$R(z)$ 由 $y_{n+1} = R(z)\\,y_{n}$ 定义。以单一的闭式解析表达式形式提供 $R(z)$ 作为您的最终答案。最终表达式无需四舍五入，也不涉及任何物理单位。",
            "solution": "我们从自治常微分方程 $\\frac{dy}{dt} = f(y)$ 开始，其中 $f$ 足够光滑。其精确解在 $t$ 点的泰勒展开为：\n$$\ny(t+h) = y(t) + h f + \\frac{h^{2}}{2} f^{(1)} f + \\frac{h^{3}}{6}\\left[f^{(2)}(f,f) + f^{(1)} f^{(1)} f\\right] + \\frac{h^{4}}{24}\\left[f^{(3)}(f,f,f) + 3 f^{(2)}(f^{(1)} f, f) + f^{(1)} f^{(2)}(f,f) + f^{(1)} f^{(1)} f^{(1)} f\\right] + \\mathcal{O}(h^{5}),\n$$\n其中 $f^{(k)}$ 表示 $f$ 在 $y(t)$ 处的 $k$ 阶 Fréchet 导数，而像 $f^{(1)} f$ 这样的乘积表示雅可比矩阵 $f^{(1)}$ 作用于 $f$ 等。这种分解列举了高达 4 阶的基本微分，而无需使用根树理论。\n\n对于一个 $s$ 级显式龙格-库塔方法，\n$$\nY_{i} = y_{n} + h \\sum_{j=1}^{s} a_{ij} K_{j}, \\quad K_{i} = f(Y_{i}), \\quad y_{n+1} = y_{n} + h \\sum_{i=1}^{s} b_{i} K_{i}.\n$$\n将 $K_{i} = f(Y_{i})$ 在 $y_{n}$ 处进行泰勒级数展开，截至所需阶数，得到：\n$$\nK_{i} = f + h f^{(1)} \\sum_{j} a_{ij} K_{j} + \\frac{h^{2}}{2} f^{(2)}\\!\\left(\\sum_{j} a_{ij} K_{j}, \\sum_{k} a_{ik} K_{k}\\right) + \\frac{h^{3}}{6} f^{(3)}\\!\\left(\\sum_{j} a_{ij} K_{j}, \\sum_{k} a_{ik} K_{k}, \\sum_{\\ell} a_{i\\ell} K_{\\ell}\\right) + \\mathcal{O}(h^{4}).\n$$\n将这些级数展开式递归地代入更新式 $y_{n+1} = y_{n} + h \\sum_{i} b_{i} K_{i}$，并收集基本微分 $f$、$f^{(1)} f$、$f^{(2)}(f,f)$、$f^{(1)} f^{(1)} f$ 以及上面列出的四阶项前面的系数，可以得到一组关于 $(A,b,c)$ 的代数约束，称为基本阶条件。对于自治系统和显式 $A$ (严格下三角)，直至 $p=4$ 阶，这些条件可以用向量-矩阵表示法表示。设 $e$ 表示全 1 向量，$c$ 表示横坐标向量且 $c = A e$，并定义逐元素幂 $c^{\\circ k}$ 为 $(c^{\\circ k})_{i} = c_{i}^{k}$。那么，直至四阶的基本阶条件是：\n- 1 阶：\n$$\nb^{\\mathrm{T}} e = 1.\n$$\n- 2 阶：\n$$\nb^{\\mathrm{T}} c = \\frac{1}{2}.\n$$\n- 3 阶：\n$$\nb^{\\mathrm{T}} c^{\\circ 2} = \\frac{1}{3}, \\qquad b^{\\mathrm{T}} A c = \\frac{1}{6}.\n$$\n- 4 阶：\n$$\nb^{\\mathrm{T}} c^{\\circ 3} = \\frac{1}{4}, \\qquad b^{\\mathrm{T}} A c^{\\circ 2} = \\frac{1}{12}, \\qquad b^{\\mathrm{T}} (C A c) = \\frac{1}{8}, \\qquad b^{\\mathrm{T}} A^{2} c = \\frac{1}{24},\n$$\n其中 $C = \\mathrm{diag}(c)$ 并且 $(C A c)_{i} = c_{i}\\,(A c)_{i}$。这些约束是通过将龙格-库塔展开式中的系数与每个给定阶数下不同基本微分结构的精确泰勒展开式中的系数相匹配而得到的。\n\n我们现在验证经典的 RK4 表是否满足这些条件。对于 RK4，\n$$\nb = \\left(\\frac{1}{6}, \\frac{1}{3}, \\frac{1}{3}, \\frac{1}{6}\\right), \\quad c = \\left(0, \\frac{1}{2}, \\frac{1}{2}, 1\\right), \\quad\nA = \\begin{pmatrix}\n0  0  0  0 \\\\\n\\frac{1}{2}  0  0  0 \\\\\n0  \\frac{1}{2}  0  0 \\\\\n0  0  1  0\n\\end{pmatrix}.\n$$\n首先，计算 $b^{\\mathrm{T}} e$：\n$$\nb^{\\mathrm{T}} e = \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} = 1.\n$$\n接着，$b^{\\mathrm{T}} c$：\n$$\nb^{\\mathrm{T}} c = \\frac{1}{6}\\cdot 0 + \\frac{1}{3}\\cdot \\frac{1}{2} + \\frac{1}{3}\\cdot \\frac{1}{2} + \\frac{1}{6}\\cdot 1 = \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{2}.\n$$\n对于 $b^{\\mathrm{T}} c^{\\circ 2}$：\n$$\nc^{\\circ 2} = \\left(0, \\frac{1}{4}, \\frac{1}{4}, 1\\right), \\quad b^{\\mathrm{T}} c^{\\circ 2} = \\frac{1}{3}\\cdot \\frac{1}{4} + \\frac{1}{3}\\cdot \\frac{1}{4} + \\frac{1}{6}\\cdot 1 = \\frac{1}{12} + \\frac{1}{12} + \\frac{1}{6} = \\frac{1}{3}.\n$$\n逐分量计算 $A c$：\n$$\nA c = \\begin{pmatrix}\n0 \\\\\n\\frac{1}{2}\\cdot 0 \\\\\n\\frac{1}{2}\\cdot \\frac{1}{2} \\\\\n1 \\cdot \\frac{1}{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\ 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{2}\n\\end{pmatrix},\n\\quad b^{\\mathrm{T}} A c = \\frac{1}{3}\\cdot \\frac{1}{4} + \\frac{1}{6}\\cdot \\frac{1}{2} = \\frac{1}{12} + \\frac{1}{12} = \\frac{1}{6}.\n$$\n对于四阶条件，首先是 $b^{\\mathrm{T}} c^{\\circ 3}$：\n$$\nc^{\\circ 3} = \\left(0, \\frac{1}{8}, \\frac{1}{8}, 1\\right), \\quad b^{\\mathrm{T}} c^{\\circ 3} = \\frac{1}{3}\\cdot \\frac{1}{8} + \\frac{1}{3}\\cdot \\frac{1}{8} + \\frac{1}{6}\\cdot 1 = \\frac{1}{24} + \\frac{1}{24} + \\frac{1}{6} = \\frac{1}{4}.\n$$\n接着，$A c^{\\circ 2}$：\n$$\nA c^{\\circ 2} = \\begin{pmatrix}\n0 \\\\\n\\frac{1}{2}\\cdot 0 \\\\\n\\frac{1}{2}\\cdot \\frac{1}{4} \\\\\n1 \\cdot \\frac{1}{4}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{4}\n\\end{pmatrix}, \\quad b^{\\mathrm{T}} A c^{\\circ 2} = \\frac{1}{3}\\cdot \\frac{1}{8} + \\frac{1}{6}\\cdot \\frac{1}{4} = \\frac{1}{24} + \\frac{1}{24} = \\frac{1}{12}.\n$$\n现在，是 $C A c$，其中 $C = \\mathrm{diag}(c)$：\n$$\nC A c = \\begin{pmatrix}\n0 \\cdot 0 \\\\\n\\frac{1}{2} \\cdot 0 \\\\\n\\frac{1}{2} \\cdot \\frac{1}{4} \\\\\n1 \\cdot \\frac{1}{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{2}\n\\end{pmatrix}, \\quad b^{\\mathrm{T}} (C A c) = \\frac{1}{3}\\cdot \\frac{1}{8} + \\frac{1}{6}\\cdot \\frac{1}{2} = \\frac{1}{24} + \\frac{1}{12} = \\frac{1}{8}.\n$$\n最后，是 $A^{2} c$：\n$$\nA^{2} c = A (A c) = \\begin{pmatrix}\n0 \\\\\n\\frac{1}{2} \\cdot 0 \\\\\n\\frac{1}{2} \\cdot 0 \\\\\n1 \\cdot \\frac{1}{4}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\ 0 \\\\ 0 \\\\ \\frac{1}{4}\n\\end{pmatrix}, \\quad b^{\\mathrm{T}} A^{2} c = \\frac{1}{6}\\cdot \\frac{1}{4} = \\frac{1}{24}.\n$$\n经典 RK4 的系数满足了所有直至 $p=4$ 阶的基本阶条件，从而证实了它对于诸如航空航天 CFD 中使用的半离散可压缩欧拉系统这样的一般自治常微分方程具有四阶精度。\n\n我们现在计算线性测试方程 $\\frac{dy}{dt} = \\lambda y$ 的稳定性函数 $R(z)$，其中 $z = \\lambda h$。对于一个显式龙格-库塔方法，当应用于 $y' = \\lambda y$ 时，阶段导数变得与 $y_{n}$ 成正比，更新式简化为\n$$\ny_{n+1} = R(z)\\, y_{n}.\n$$\n对于给定的 RK4 方法，其各阶段为\n$$\nK_{1} = \\lambda y_{n}, \\quad\nK_{2} = \\lambda \\left(y_{n} + \\frac{h}{2} K_{1}\\right) = \\lambda y_{n} \\left(1 + \\frac{z}{2}\\right),\n$$\n$$\nK_{3} = \\lambda \\left(y_{n} + \\frac{h}{2} K_{2}\\right) = \\lambda y_{n} \\left(1 + \\frac{z}{2} + \\frac{z^{2}}{4}\\right),\n$$\n$$\nK_{4} = \\lambda \\left(y_{n} + h K_{3}\\right) = \\lambda y_{n} \\left(1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{4}\\right).\n$$\nRK4 更新式得到\n$$\ny_{n+1} = y_{n} + h \\frac{1}{6}\\left(K_{1} + 2 K_{2} + 2 K_{3} + K_{4}\\right) = y_{n} \\left[1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}\\right],\n$$\n所以稳定性函数为\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\n该多项式与 $\\exp(z)$ 的泰勒级数在 $z^{4}$ 项之前都匹配，这与已验证的四阶条件一致；第一个被忽略的项是 $\\frac{z^{5}}{120}$，它决定了线性测试方程的主阶局部截断误差。\n\n因此，经典的 RK4 方法满足所有直至 $p=4$ 阶的基本阶条件，其对线性测试方程的稳定性函数是上面所示的指数函数的四次泰勒多项式。",
            "answer": "$$\\boxed{1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}}$$"
        },
        {
            "introduction": "许多航空航天 CFD 问题，特别是涉及粘性流或化学反应的问题，本质上是“刚性”的，这使得像 RK4 这样的显式方法效率低下。本练习将引导您从分析现有方法转向为应对这些挑战而设计新方法 。您将构建一个单对角隐式龙格-库塔（SDIRK）方法，这是一种求解刚性系统的强大工具，并通过施加 A-稳定性和刚性精度等理想属性来确定其系数。",
            "id": "3978520",
            "problem": "考虑在非结构网格上通过空间离散化得到的可压缩Navier–Stokes方程的半离散格式，这会产生一个形如 $\\dot{\\mathbf{u}} = \\mathbf{f}(\\mathbf{u})$ 的常微分方程刚性系统。为了以一种鲁棒的方式对该系统进行时间推进，设计一个两阶段单对角隐式龙格-库塔（SDIRK）方法，即一种在其系数矩阵中对角线系数相同的龙格-库塔方法。\n\n根据航空航天计算流体力学实践中的设计选择，构建一个阶数为 $2$ 的两阶段SDIRK方法：\n1. 第二阶段的横坐标位于时间步的末端，即 $c_{2} = 1$。\n2. 该方法是刚性精确的，即解的更新权重等于龙格-库塔矩阵最后一行的系数。\n\n从基本的龙格-库塔定义和阶数条件出发，用共同的对角线值符号化地推导该方法的系数，并强制其精度达到 $2$ 阶。然后，使用线性测试方程 $y' = \\lambda y$（其中 $z = h \\lambda$）和龙格-库塔方法的基本稳定性函数定义，推导该方法的稳定性函数，并确定确保在整个复平面的左半部分（A-稳定性）上绝对稳定的对角线系数值。\n\n将最终答案表示为对角线系数的精确符号值。无需四舍五入。最终答案中不报告单位。",
            "solution": "该问题要求设计一个两阶段、二阶、刚性精确的单对角隐式龙格-库塔（SDIRK）方法，其最后一个阶段位于时间步的末端，并确定其对角线系数以确保A-稳定性。\n\n一个通用的 $s$ 阶段龙格-库塔方法由其布彻表定义：\n$$\n\\begin{array}{c|c}\n\\mathbf{c}  \\mathbf{A} \\\\\n\\hline\n  \\mathbf{b}^T\n\\end{array}\n$$\n其中 $\\mathbf{c}$ 是阶段时间向量，$\\mathbf{A}$ 是龙格-库塔系数矩阵，$\\mathbf{b}$ 是解更新权重向量。\n\n对于指定的两阶段（$s=2$）SDIRK方法，其布彻表具有特定的结构。“单对角隐式”一词意味着系数矩阵 $\\mathbf{A}$ 是下三角矩阵，并且其所有对角元素都等于一个共同的值，我们将其表示为 $\\gamma$。\n$$\n\\mathbf{A} = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix} = \\begin{pmatrix} \\gamma  0 \\\\ a_{21}  \\gamma \\end{pmatrix}\n$$\n阶段时间横坐标 $c_i$ 通过行和条件 $c_i = \\sum_{j=1}^{s} a_{ij}$ 与矩阵系数相关。对于我们的两阶段方法，这给出：\n$$\nc_1 = \\gamma \\\\\nc_2 = a_{21} + \\gamma\n$$\n问题指定了两个设计选择：\n1.  第二阶段位于时间步的末端：$c_2 = 1$。将此代入第二行的行和条件得到 $1 = a_{21} + \\gamma$，这使我们能够用 $\\gamma$ 表示 $a_{21}$：$a_{21} = 1 - \\gamma$。\n2.  该方法是刚性精确的。这意味着解的更新权重与 $\\mathbf{A}$ 矩阵最后一行的系数相同：$b_j = a_{sj}$，其中 $j=1, ..., s$。对于 $s=2$，这意味着 $b_1 = a_{21}$ 和 $b_2 = a_{22}$。因此，$b_1 = 1 - \\gamma$ 且 $b_2 = \\gamma$。\n\n在这些约束条件下，布彻表完全由单个参数 $\\gamma$ 表征：\n$$\n\\begin{array}{c|cc}\n\\gamma  \\gamma  0 \\\\\n1  1-\\gamma  \\gamma \\\\\n\\hline\n  1-\\gamma  \\gamma\n\\end{array}\n$$\n接下来，我们强制要求该方法的阶数必须为 $2$。龙格-库塔方法的阶数条件是：\n- 1阶条件：$\\sum_{i=1}^s b_i = 1$。\n  检验此条件：$b_1 + b_2 = (1-\\gamma) + \\gamma = 1$。对于 $\\gamma$ 的任何选择，1阶条件都满足。这是刚性精确方法在 $c_s = 1$ 时的已知属性。\n- 2阶条件：$\\sum_{i=1}^s b_i c_i = \\frac{1}{2}$。\n  代入我们的系数：$b_1 c_1 + b_2 c_2 = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\gamma - \\gamma^2 + \\gamma = 2\\gamma - \\gamma^2$。\n  将其等于 $\\frac{1}{2}$ 得到关于 $\\gamma$ 的方程：\n  $$\n  2\\gamma - \\gamma^2 = \\frac{1}{2}\n  $$\n  将此重新排列为标准二次型：\n  $$\n  \\gamma^2 - 2\\gamma + \\frac{1}{2} = 0\n  $$\n  两边乘以 $2$ 得到 $2\\gamma^2 - 4\\gamma + 1 = 0$。我们使用二次公式求解 $\\gamma$：\n  $$\n  \\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4} = 1 \\pm \\frac{\\sqrt{2}}{2}\n  $$\n  这给出了 $\\gamma$ 的两个可能值：$\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2}$ 和 $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}$。\n\n现在，我们必须推导稳定性函数，并确定哪个 $\\gamma$ 值能确保A-稳定性。龙格-库塔方法的稳定性函数为 $R(z) = 1 + z\\mathbf{b}^T(\\mathbf{I} - z\\mathbf{A})^{-1}\\mathbf{1}$，其中 $z = h\\lambda$。对于SDIRK方法，这可以简化为一个有理函数。一个二阶SDIRK方法的稳定性函数可以表示为：\n$$\nR(z) = \\frac{1+(1-2\\gamma)z}{(1-\\gamma z)^2}\n$$\n如果一个方法的绝对稳定区域包含整个复平面的左半部分 $\\{z \\in \\mathbb{C} \\mid \\text{Re}(z) \\leq 0\\}$，则该方法是A-稳定的。这需要满足两个条件：\n1.  对于 $\\text{Re}(z)  0$，$R(z)$ 必须是解析的。$R(z)$ 的极点出现在分母为零的地方，即 $z = \\frac{1}{\\gamma}$。为了在左半平面内是解析的，这个极点必须位于右半平面或虚轴上，即 $\\text{Re}(\\frac{1}{\\gamma}) \\ge 0$。这等价于 $\\text{Re}(\\gamma) \\ge 0$。两个可能的 $\\gamma$ 值，$1 \\pm \\frac{\\sqrt{2}}{2}$，都是实数且为正，因此这个条件得到满足。\n2.  在虚轴上，稳定性函数必须对所有实数 $y$ 满足 $|R(iy)| \\le 1$。\n    $$\n    |R(iy)|^2 = \\frac{|1+iy(1-2\\gamma)|^2}{|(1-i\\gamma y)^2|^2} = \\frac{1^2 + y^2(1-2\\gamma)^2}{(|1-i\\gamma y|^2)^2} = \\frac{1+y^2(1-4\\gamma+4\\gamma^2)}{(1+y^2\\gamma^2)^2}\n    $$\n    条件 $|R(iy)|^2 \\le 1$ 要求：\n    $$\n    1+y^2(1-4\\gamma+4\\gamma^2) \\le (1+y^2\\gamma^2)^2 = 1+2y^2\\gamma^2+y^4\\gamma^4\n    $$\n    $$\n    y^2(1-4\\gamma+4\\gamma^2) \\le 2y^2\\gamma^2+y^4\\gamma^4\n    $$\n    对于 $y \\neq 0$，我们两边除以 $y^2$：\n    $$\n    1-4\\gamma+2\\gamma^2 \\le y^2\\gamma^4\n    $$\n    $\\gamma$ 的阶数条件是 $2\\gamma^2 - 4\\gamma + 1 = 0$。将此代入不等式得到：\n    $$\n    0 \\le y^2\\gamma^4\n    $$\n    因为对于实数 $\\gamma$，$y^2 \\ge 0$ 且 $\\gamma^4 \\ge 0$，所以这个不等式总是成立的。因此，两个 $\\gamma$ 值都能产生一个A-稳定的方法。\n\n然而，问题要求的是“那个”对角线系数值，这意味着答案是唯一的。我们必须诉诸于提示中提到的实用设计原则，即方法应是“鲁棒的”，并且其动机来源于“航空航天计算流体力学实践”。在此类应用中，鲁棒性的一个关键考虑是避免布彻表中出现负系数，特别是对于权重 $b_j$，因为负系数可能引入非物理振荡或导致解（如密度或浓度）变为负值。\n权重为 $b_1 = 1-\\gamma$ 和 $b_2 = \\gamma$。非负性条件是对于所有 $i$，$b_i \\ge 0$。\n- $b_2 = \\gamma \\ge 0$。\n- $b_1 = 1-\\gamma \\ge 0 \\implies \\gamma \\le 1$。\n因此，$\\gamma$ 必须在区间 $[0, 1]$ 内。我们来检验我们的两个解：\n1.  $\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 1 - 0.707 = 0.293$。此值在 $[0, 1]$ 区间内。\n2.  $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1 + 0.707 = 1.707$。此值大于 $1$，这将使得权重 $b_1 = 1 - (1 + \\frac{\\sqrt{2}}{2}) = -\\frac{\\sqrt{2}}{2}$ 为负。\n\n为了确保方法鲁棒且权重非负，我们必须选择第一个解。因此，满足所有设计标准的唯一对角线系数是 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$。",
            "answer": "$$\n\\boxed{1 - \\frac{\\sqrt{2}}{2}}\n$$"
        }
    ]
}