{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of using explicit time integration for wave-like phenomena is understanding the relationship between the time step, grid spacing, and wave speed. This relationship is famously captured by the Courant-Friedrichs-Lewy (CFL) condition, which places a fundamental upper limit on the size of the time step $ \\Delta t $ for a given spatial mesh. This practice challenges you to derive this critical stability constraint from first principles for the linear advection equation, using the powerful technique of von Neumann stability analysis. Mastering this derivation provides deep insight into why explicit methods are often called 'conditionally stable'.",
            "id": "3879098",
            "problem": "Consider a one-dimensional periodic channel of length $L$ representing a zonally uniform flow in an Earth system model advecting a passive tracer $q(x,t)$ with constant velocity $u \\neq 0$. The governing partial differential equation is the linear advection equation $q_t + u q_x = 0$ on a uniform grid with spacing $\\Delta x$. The time integration is performed with explicit forward Euler, and the spatial derivative is approximated with the first-order upwind finite difference chosen according to the sign of $u$. Using von Neumann stability analysis and assuming periodic boundary conditions, determine the largest dimensionless Courant-Friedrichs-Lewy (CFL) prefactor $C$ such that the time step $\\Delta t$ satisfying $\\Delta t \\le C\\,\\Delta x/|u|$ ensures linear stability of this explicit upwind-forward Euler discretization for all Fourier modes. Report your final answer as the single real number $C$.",
            "solution": "Let $q_j^n$ denote the numerical approximation of $q(x_j, t_n)$ at grid point $j$ and time step $n$. The forward Euler time discretization of $q_t + u q_x = 0$ is:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} + u (q_x)_j^n = 0\n$$\nwhere $(q_x)_j^n$ is the first-order upwind spatial discretization.\n\n**Case 1: $u  0$**\nThe upwind direction is from the left, so we use a backward difference for $q_x$:\n$$\n(q_x)_j^n = \\frac{q_j^n - q_{j-1}^n}{\\Delta x}\n$$\nSubstituting this into the time-discretized equation gives:\n$$\nq_j^{n+1} = q_j^n - \\frac{u \\Delta t}{\\Delta x}(q_j^n - q_{j-1}^n)\n$$\nLet the Courant number be $\\sigma = \\frac{u \\Delta t}{\\Delta x}$. Since $u>0$, $\\sigma > 0$. The equation becomes $q_j^{n+1} = (1-\\sigma)q_j^n + \\sigma q_{j-1}^n$.\n\nIn von Neumann analysis, we substitute a single Fourier mode $q_j^n = G^n e^{i k j \\Delta x}$, where $G$ is the amplification factor and $k$ is the wavenumber.\n$$\nG^{n+1} e^{i k j \\Delta x} = (1-\\sigma)G^n e^{i k j \\Delta x} + \\sigma G^n e^{i k (j-1) \\Delta x}\n$$\nDividing by $G^n e^{i k j \\Delta x}$ yields the amplification factor:\n$$\nG = (1-\\sigma) + \\sigma e^{-i k \\Delta x} = (1-\\sigma) + \\sigma(\\cos(k\\Delta x) - i\\sin(k\\Delta x))\n$$\nFor stability, we require $|G|^2 \\le 1$. Let $\\theta = k\\Delta x$.\n$$\n|G|^2 = (1-\\sigma + \\sigma \\cos\\theta)^2 + (-\\sigma\\sin\\theta)^2 = 1 - 2\\sigma(1-\\sigma)(1-\\cos\\theta)\n$$\nSince $\\sigma>0$ and $(1-\\cos\\theta) \\ge 0$, the stability condition $|G|^2 \\le 1$ implies $-2\\sigma(1-\\sigma)(1-\\cos\\theta) \\le 0$, which simplifies to $\\sigma(1-\\sigma) \\ge 0$. As $\\sigma>0$, we must have $1-\\sigma \\ge 0$, so $\\sigma \\le 1$.\n\n**Case 2: $u  0$**\nThe upwind direction is from the right, so we use a forward difference for $q_x$:\n$$\n(q_x)_j^n = \\frac{q_{j+1}^n - q_j^n}{\\Delta x}\n$$\nThe scheme is $q_j^{n+1} = q_j^n - \\sigma(q_{j+1}^n - q_j^n)$, where $\\sigma = \\frac{u \\Delta t}{\\Delta x}  0$.\nThe amplification factor is:\n$$\nG = 1 - \\sigma(e^{i\\theta} - 1) = (1+\\sigma - \\sigma\\cos\\theta) - i\\sigma\\sin\\theta\n$$\nThe squared magnitude is:\n$$\n|G|^2 = (1+\\sigma - \\sigma \\cos\\theta)^2 + (-\\sigma\\sin\\theta)^2 = 1 + 2\\sigma(1+\\sigma)(1-\\cos\\theta)\n$$\nThe stability condition $|G|^2 \\le 1$ implies $\\sigma(1+\\sigma) \\le 0$. As $\\sigma0$, we must have $1+\\sigma \\ge 0$, so $\\sigma \\ge -1$.\n\n**Conclusion**\nFor $u>0$, stability requires $0  \\frac{u \\Delta t}{\\Delta x} \\le 1$.\nFor $u0$, stability requires $-1 \\le \\frac{u \\Delta t}{\\Delta x}  0$.\nBoth conditions can be combined into a single expression using the absolute value of the velocity:\n$$\n\\frac{|u| \\Delta t}{\\Delta x} \\le 1\n$$\nRewriting this gives $\\Delta t \\le 1 \\cdot \\frac{\\Delta x}{|u|}$. Comparing this to the problem's required form $\\Delta t \\le C\\,\\Delta x/|u|$, we see that the largest possible prefactor is $C=1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "While the CFL condition governs stability for advective problems, many systems in aerospace engineering, such as those involving chemical kinetics or viscous boundary layers, are governed by 'stiff' dynamics with very fast decay rates. For these problems, explicit schemes face a different, often far more restrictive, stability limit related to the fastest timescale in the system. This exercise provides a dramatic and quantitative look at what happens when this stability bound is violated. By directly computing the ratio of the numerical solution to the exact solution after just a few steps with an unstable time step, you will gain a tangible appreciation for the explosive, non-physical error growth characteristic of stiffness-induced instability.",
            "id": "3879025",
            "problem": "In a chemical kinetics module of an environmental and earth system model, a single reactive tracer undergoes first-order decay governed by the ordinary differential equation (ODE) $y'(t)=\\lambda\\,y(t)$ with a constant rate $\\lambda0$. You apply a first-order explicit time-stepping method that approximates the time derivative by a forward difference over a uniform time step $\\Delta t$ to advance the numerical solution. Consider the following concrete experiment intended to probe stiffness-induced instability: take $\\lambda=-5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$, $\\Delta t=1.0\\times 10^{-4}\\ \\mathrm{s}$, and $N=10$ time steps from an initial condition of magnitude $\\lvert y(0)\\rvert=1$. Let $T=N\\,\\Delta t$ denote the final time.\n\nStarting only from the forward-difference definition of the method and the ODE, and without invoking any pre-stated stability criterion, do the following:\n- Derive the closed-form expression for the numerical solution after $N$ steps in terms of $\\lambda$, $\\Delta t$, $N$, and $y(0)$.\n- Derive the exact analytic solution at time $T$.\n- Using these, construct and simplify the expression for the dimensionless ratio $R$ defined as the magnitude of the numerical solution divided by the magnitude of the exact solution at the same final time $T$.\n- Evaluate $R$ for the given $\\lambda$, $\\Delta t$, and $N$.\n\nReport the final value of $R$ as a single real number in scientific notation, rounded to $4$ significant figures. The ratio $R$ is dimensionless; do not include units in your final answer.",
            "solution": "The ODE is $y'(t)=\\lambda\\,y(t)$ with constant $\\lambda0$. The first principle we use is the definition of the forward difference approximation to the time derivative at time $t_{n}$:\n$$\n\\frac{y_{n+1}-y_{n}}{\\Delta t}\\approx y'(t_{n})=\\lambda\\,y_{n},\n$$\nwhere $y_{n}\\approx y(t_{n})$ and $t_{n}=n\\,\\Delta t$. Rearranging gives the explicit one-step recursion\n$$\ny_{n+1}=y_{n}+\\Delta t\\,\\lambda\\,y_{n}=\\left(1+\\lambda\\,\\Delta t\\right)y_{n}.\n$$\nIterating this $N$ times from $y_{0}=y(0)$ yields the closed-form numerical solution after $N$ steps:\n$$\ny_{N}=\\left(1+\\lambda\\,\\Delta t\\right)^{N}y_{0}.\n$$\n\nThe exact analytic solution of the ODE with constant $\\lambda$ is obtained by separation of variables or by recognizing it as a linear homogeneous ODE with constant coefficients:\n$$\ny(t)=y_{0}\\,\\exp\\!\\left(\\lambda\\,t\\right).\n$$\nAt the final time $T=N\\,\\Delta t$, the exact solution is\n$$\ny_{\\text{exact}}(T)=y_{0}\\,\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right).\n$$\n\nDefine the dimensionless ratio $R$ between the magnitudes of the numerical and exact solutions at time $T$:\n$$\nR \\equiv \\frac{\\lvert y_{N}\\rvert}{\\lvert y_{\\text{exact}}(T)\\rvert}=\\frac{\\left| \\left(1+\\lambda\\,\\Delta t\\right)^{N} y_{0}\\right|}{\\left| y_{0}\\,\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)\\right|}=\\frac{\\left|1+\\lambda\\,\\Delta t\\right|^{N}}{\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)}.\n$$\nThis expression quantifies, in a single number, the instability growth when the time step $\\Delta t$ violates the stability requirement for the explicit method on the stiff linear test equation.\n\nNow evaluate $R$ for the given parameters $\\lambda=-5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$, $\\Delta t=1.0\\times 10^{-4}\\ \\mathrm{s}$, and $N=10$:\n- Compute the nondimensional product:\n$$\n\\lambda\\,\\Delta t=\\left(-5.0\\times 10^{4}\\right)\\left(1.0\\times 10^{-4}\\right)=-5.0.\n$$\n- Hence,\n$$\n1+\\lambda\\,\\Delta t=1+(-5.0)=-4.0,\\quad \\left|1+\\lambda\\,\\Delta t\\right|=4.0.\n$$\n- The final time is\n$$\nT=N\\,\\Delta t=10\\times 1.0\\times 10^{-4}=1.0\\times 10^{-3}.\n$$\n- The exponential factor is\n$$\n\\exp\\!\\left(\\lambda\\,N\\,\\Delta t\\right)=\\exp\\!\\left(\\lambda\\,T\\right)=\\exp\\!\\left((-5.0\\times 10^{4})\\times (1.0\\times 10^{-3})\\right)=\\exp(-50).\n$$\nTherefore,\n$$\nR=\\frac{4.0^{10}}{\\exp(-50)}=4.0^{10}\\,\\exp(50).\n$$\nEvaluate numerically:\n$$\n4.0^{10}=\\left(2.0^{2}\\right)^{10}=2.0^{20}=1,048,576,\n$$\nand\n$$\n\\exp(50)\\approx 5.184705528587072\\times 10^{21}.\n$$\nThus,\n$$\nR\\approx \\left(1.048576\\times 10^{6}\\right)\\times \\left(5.184705528587072\\times 10^{21}\\right) \\approx 5.436557784342718\\times 10^{27}.\n$$\nRounded to $4$ significant figures, this is\n$$\nR\\approx 5.437\\times 10^{27}.\n$$\nThis very large value reflects the severe instability induced by choosing $\\Delta t$ such that $\\left|1+\\lambda\\,\\Delta t\\right|1$ for a stiff decay with large negative $\\lambda$.",
            "answer": "$$\\boxed{5.437\\times 10^{27}}$$"
        },
        {
            "introduction": "After analyzing the limitations of first-order schemes, we often turn to higher-order methods like the classical fourth-order Runge-Kutta (RK4) to achieve better accuracy. However, a successful CFD practitioner must bridge the gap between abstract mathematical algorithms and their efficient implementation on real-world hardware. This practice addresses a crucial aspect of this translation: memory efficiency. You will re-formulate the standard RK4 method into a 'low-storage' variant that minimizes memory usage, a vital technique for solving large-scale problems, and verify that this new formulation retains the desirable properties of the original scheme.",
            "id": "3958149",
            "problem": "Consider a semi-discrete formulation of the compressible Euler equations arising in Computational Fluid Dynamics (CFD), written abstractly as an Ordinary Differential Equation (ODE) system\n$$\n\\frac{d \\boldsymbol{U}}{dt} = \\boldsymbol{R}(\\boldsymbol{U}),\n$$\nwhere $\\boldsymbol{U} \\in \\mathbb{R}^{m}$ is the vector of conserved variables and $\\boldsymbol{R}$ is the discrete spatial residual operator. An explicit Runge–Kutta (RK) method with $s$ stages advances $\\boldsymbol{U}^{n}$ at time $t^{n}$ to $\\boldsymbol{U}^{n+1}$ at time $t^{n+1} = t^{n} + \\Delta t$ by forming intermediate stage values and combining their residual evaluations with prescribed coefficients. The classical fourth-order Runge–Kutta method (RK4) has the Butcher weights\n$$\nb_{1} = \\frac{1}{6}, \\quad b_{2} = \\frac{1}{3}, \\quad b_{3} = \\frac{1}{3}, \\quad b_{4} = \\frac{1}{6},\n$$\nand stage abscissae\n$$\nc_{1} = 0, \\quad c_{2} = \\frac{1}{2}, \\quad c_{3} = \\frac{1}{2}, \\quad c_{4} = 1.\n$$\nLow-storage two-register implementations are widely used in aerospace CFD due to memory constraints on large meshes. In the two-register low-storage formulation, one register stores the evolving solution $\\boldsymbol{Y}$ and one register stores a running accumulation $\\boldsymbol{K}$ of scaled residuals. A generic two-register update has the form\n$$\n\\boldsymbol{Y} \\leftarrow \\boldsymbol{Y} + \\alpha_{i}\\,\\boldsymbol{K}, \\qquad \\boldsymbol{K} \\leftarrow \\beta_{i}\\,\\boldsymbol{K} + \\Delta t\\,\\boldsymbol{R}(\\boldsymbol{Y}),\n$$\napplied sequentially over the stages with appropriately chosen coefficients $\\alpha_{i}$ and $\\beta_{i}$. Your tasks are:\n- Starting from the general explicit Runge–Kutta construction and the definitions above, derive a two-register low-storage formulation that accumulates the classical RK4 final combination of residuals, preserving the classical RK4 weights $b_{i}$ in the final update to obtain $\\boldsymbol{U}^{n+1}$.\n- Rewrite the classical RK4 scheme into a concrete sequence of two-register updates using specific $\\alpha_{i}$ and $\\beta_{i}$ that yield the same final RK4 combination $\\sum_{i=1}^{4} b_{i} \\Delta t\\,\\boldsymbol{R}(\\text{stage}_{i})$ when producing $\\boldsymbol{U}^{n+1}$, even if the intermediate stage locations differ from the classical staging.\n- Apply your low-storage RK4 to the linear test equation $u'(t) = \\lambda\\,u(t)$, where $\\lambda \\in \\mathbb{C}$ is a constant and $u(t) \\in \\mathbb{C}$. Let $z = \\lambda\\,\\Delta t$. Derive the one-step amplification factor $G(z)$ defined by $u^{n+1} = G(z)\\,u^{n}$ for your low-storage RK4 that preserves the classical RK4 final weights. Present $G(z)$ as a single closed-form analytic polynomial in $z$.\n\nAnswer format requirements:\n- Provide the final $G(z)$ as a single analytic expression in $z$.\n- No rounding is required.\n- Do not include units with the final expression.",
            "solution": "The problem asks for the amplification factor $G(z)$ of a low-storage fourth-order Runge-Kutta (RK4) method applied to the linear test equation $u'(t) = \\lambda u(t)$. The key insight is that all Runge-Kutta methods of the same order of accuracy must have the same amplification factor when applied to this linear test equation. The specific coefficients of the scheme, $\\{\\alpha_i, \\beta_i\\}$, affect the locations of the intermediate stages but are chosen precisely to ensure the final result has the desired order of accuracy. The amplification factor is determined by this order, not the specific path taken to achieve it.\n\nA time integration method is said to be $p$-th order accurate if its numerical solution's Taylor series expansion in the time step $\\Delta t$ matches the exact solution's Taylor series expansion up to the term of order $(\\Delta t)^p$.\n\nFor the test equation $u'(t) = \\lambda u(t)$, the exact solution advancing from $t^n$ to $t^{n+1} = t^n + \\Delta t$ is:\n$$\nu(t^{n+1}) = u(t^n) e^{\\lambda \\Delta t}\n$$\nThe exact amplification factor is $e^z$, where $z = \\lambda \\Delta t$. The Taylor series expansion of $e^z$ is:\n$$\ne^z = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} + \\mathcal{O}(z^5)\n$$\n\nThe numerical solution is given by $u^{n+1} = G(z)u^n$, where $G(z)$ is the amplification factor, which for an explicit $s$-stage RK method is a polynomial in $z$ of degree at most $s$. For the method to be fourth-order accurate ($p=4$), the polynomial $G(z)$ must match the Taylor series of $e^z$ up to the term of order $z^4$.\n\nTherefore, for any valid low-storage (or classical) implementation of a fourth-order Runge-Kutta method, the amplification factor must be:\n$$\nG(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\nThis uniquely defines the amplification factor without needing to solve for the specific set of low-storage coefficients $\\{\\alpha_i, \\beta_i\\}$. The existence of such coefficients that yield this polynomial is a prerequisite for any scheme to be called a low-storage RK4 method. The derivation is thus one of definition: to be a fourth-order method, the scheme must reproduce this specific stability polynomial.",
            "answer": "$$\n\\boxed{1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 + \\frac{1}{24}z^4}\n$$"
        }
    ]
}