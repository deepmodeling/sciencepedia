{
    "hands_on_practices": [
        {
            "introduction": "The one-dimensional linear advection equation is the simplest useful model for wave propagation, making it the perfect laboratory for analyzing numerical methods. This exercise  challenges you to derive the celebrated Courant-Friedrichs-Lewy (CFL) condition from first principles for a forward-Euler time-stepping scheme with an upwind spatial discretization. Mastering this derivation using von Neumann stability analysis is a foundational skill, providing deep insight into why explicit schemes have a limited time step size.",
            "id": "3879098",
            "problem": "Consider a one-dimensional periodic channel of length $L$ representing a zonally uniform flow in an Earth system model advecting a passive tracer $q(x,t)$ with constant velocity $u \\neq 0$. The governing partial differential equation is the linear advection equation $q_t + u q_x = 0$ on a uniform grid with spacing $\\Delta x$. The time integration is performed with explicit forward Euler, and the spatial derivative is approximated with the first-order upwind finite difference chosen according to the sign of $u$. Using von Neumann stability analysis and assuming periodic boundary conditions, determine the largest dimensionless Courant-Friedrichs-Lewy (CFL) prefactor $C$ such that the time step $\\Delta t$ satisfying $\\Delta t \\le C\\,\\Delta x/|u|$ ensures linear stability of this explicit upwind-forward Euler discretization for all Fourier modes. Report your final answer as the single real number $C$.",
            "solution": "To perform von Neumann stability analysis, we substitute a single Fourier mode, $q_j^n = \\hat{q}^n(k) e^{i k x_j}$, into the discretized equation. Here, $x_j = j\\Delta x$ is the grid point location, $k$ is the wavenumber, and $\\hat{q}^n(k)$ is the amplitude of the mode at time step $n$. We seek the amplification factor $G(k) = \\hat{q}^{n+1}(k) / \\hat{q}^n(k)$, which describes how the mode's amplitude changes over one time step. The scheme is stable if and only if $|G(k)| \\le 1$ for all wavenumbers $k$.\n\nThe upwind scheme depends on the sign of the advection velocity $u$.\n\n**Case 1: $u > 0$**\nThe upwind spatial difference is a first-order backward difference: $q_x \\approx (q_j^n - q_{j-1}^n)/\\Delta x$. The forward Euler time-stepping scheme becomes:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} + u \\frac{q_j^n - q_{j-1}^n}{\\Delta x} = 0\n$$\nRearranging and substituting the Fourier mode gives:\n$$\n\\hat{q}^{n+1} e^{i k j \\Delta x} = \\hat{q}^n e^{i k j \\Delta x} - \\frac{u \\Delta t}{\\Delta x} (\\hat{q}^n e^{i k j \\Delta x} - \\hat{q}^n e^{i k (j-1) \\Delta x})\n$$\nLet $\\sigma = \\frac{u \\Delta t}{\\Delta x}$ be the Courant number (here $\\sigma > 0$) and $\\theta = k\\Delta x$ be the dimensionless wavenumber. Dividing by $\\hat{q}^n e^{i k j \\Delta x}$ yields the amplification factor:\n$$\nG(\\theta) = 1 - \\sigma (1 - e^{-i\\theta}) = (1 - \\sigma + \\sigma\\cos\\theta) + i\\sigma\\sin\\theta\n$$\nFor stability, we require $|G(\\theta)|^2 \\le 1$:\n$$\n|G(\\theta)|^2 = (1 - \\sigma + \\sigma\\cos\\theta)^2 + (\\sigma\\sin\\theta)^2 = 1 - 2\\sigma(1-\\sigma)(1-\\cos\\theta)\n$$\nSince $u>0$, $\\Delta t > 0$, and $\\Delta x > 0$, we have $\\sigma > 0$. The term $(1-\\cos\\theta)$ is always non-negative. Thus, for $|G|^2 \\le 1$, we must have $-2\\sigma(1-\\sigma)(1-\\cos\\theta) \\le 0$, which requires $\\sigma(1-\\sigma) \\ge 0$. As $\\sigma > 0$, this simplifies to $1-\\sigma \\ge 0$, or $\\sigma \\le 1$.\n\n**Case 2: $u  0$**\nThe upwind spatial difference is a first-order forward difference: $q_x \\approx (q_{j+1}^n - q_j^n)/\\Delta x$. The scheme is:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} + u \\frac{q_{j+1}^n - q_j^n}{\\Delta x} = 0\n$$\nThe Courant number $\\sigma = \\frac{u \\Delta t}{\\Delta x}$ is now negative. The amplification factor is:\n$$\nG(\\theta) = 1 - \\sigma (e^{i\\theta} - 1) = (1 + \\sigma - \\sigma\\cos\\theta) - i\\sigma\\sin\\theta\n$$\nThe squared magnitude is:\n$$\n|G(\\theta)|^2 = (1 + \\sigma - \\sigma\\cos\\theta)^2 + (-\\sigma\\sin\\theta)^2 = 1 + 2\\sigma(1+\\sigma)(1-\\cos\\theta)\n$$\nFor stability, we require $2\\sigma(1+\\sigma)(1-\\cos\\theta) \\le 0$. As $\\sigma  0$ and $(1-\\cos\\theta) \\ge 0$, this requires $1+\\sigma \\ge 0$, or $\\sigma \\ge -1$.\n\n**Conclusion**\nCombining the two cases, the stability condition on the Courant number $\\sigma = u \\Delta t / \\Delta x$ is:\n- If $u>0$, $0  \\sigma \\le 1$.\n- If $u0$, $-1 \\le \\sigma  0$.\nBoth conditions can be unified using the absolute value: $|\\sigma| = \\frac{|u|\\Delta t}{\\Delta x} \\le 1$.\nThis inequality can be written as $\\Delta t \\le 1 \\cdot \\frac{\\Delta x}{|u|}$. Comparing this to the problem's formulation $\\Delta t \\le C\\,\\Delta x/|u|$, we find that the largest possible dimensionless prefactor is $C=1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "While the CFL condition ensures a simulation does not become unstable, it does not guarantee accuracy. This practice  moves beyond stability to the crucial concept of numerical error, investigating how the choice of time step $\\Delta t$ directly impacts the solution's precision. By analyzing the forward Euler scheme, you will quantify the trade-off between computational cost and accuracy, a central challenge in all CFD simulations.",
            "id": "3958191",
            "problem": "Consider the semi-discrete form of a linearized viscous mode arising in Computational Fluid Dynamics (CFD) benchmarks, where a single Fourier mode amplitude $a(t)$ satisfies the scalar ordinary differential equation $a'(t) = \\lambda a(t)$ with constant $\\lambda  0$. An explicit forward Euler time integration scheme computes $a^{n+1}$ from $a^{n}$ over a time step $\\Delta t$ by replacing the time derivative with a finite difference. Your tasks are:\n\n1. Starting from the Taylor series of the exact solution $a(t)$ about a generic time $t_{n}$ and the definition of the forward Euler scheme, derive the local truncation error and use it to argue the global order of accuracy in time.\n\n2. For the scalar mode $a'(t) = \\lambda a(t)$, derive the leading-order asymptotic expression for the absolute global error at a fixed final time $T$ after $n = T / \\Delta t$ forward Euler steps, expressed in terms of $\\lambda$, $T$, $\\Delta t$, and $a(0)$.\n\n3. In a representative CFD benchmark, suppose $\\lambda = -2\\,\\mathrm{s}^{-1}$, $T = 4\\,\\mathrm{s}$, and $a(0) = 1$. Impose the forward Euler stability requirement for real negative $\\lambda$ and enforce that the absolute global error at $t = T$ does not exceed a target $\\varepsilon = 1.00 \\times 10^{-3}$. Determine the largest time step $\\Delta t$ that simultaneously satisfies both the accuracy and stability constraints. Express your final $\\Delta t$ in seconds and round your answer to four significant figures.\n\nYour derivations must start from first principles (Taylor series and the finite difference definition of forward Euler). Do not quote pre-derived error formulas. Ensure scientific realism by clearly stating assumptions used in your analysis.",
            "solution": "We consider the scalar ordinary differential equation $a'(t) = \\lambda a(t)$ with constant $\\lambda  0$. The explicit forward Euler scheme updates the numerical solution by\n$$\na^{n+1} = a^{n} + \\Delta t\\, \\lambda\\, a^{n},\n$$\nwhich follows from approximating $a'(t_{n}) \\approx \\frac{a^{n+1} - a^{n}}{\\Delta t}$.\n\n1. To establish the local truncation error and global order, we start from the Taylor series of the exact solution about $t_{n}$:\n$$\na(t_{n+1}) = a(t_{n}) + \\Delta t\\, a'(t_{n}) + \\frac{\\Delta t^{2}}{2} a''(t_{n}) + \\frac{\\Delta t^{3}}{6} a^{(3)}(t_{n}) + \\cdots.\n$$\nUsing $a'(t) = \\lambda a(t)$, $a''(t) = \\lambda^{2} a(t)$, and $a^{(3)}(t) = \\lambda^{3} a(t)$, we can rewrite\n$$\na(t_{n+1}) = a(t_{n}) + \\Delta t\\, \\lambda a(t_{n}) + \\frac{\\Delta t^{2}}{2} \\lambda^{2} a(t_{n}) + \\frac{\\Delta t^{3}}{6} \\lambda^{3} a(t_{n}) + \\cdots.\n$$\nThe forward Euler update produces\n$$\na^{n+1} = a^{n} + \\Delta t\\, \\lambda a^{n}.\n$$\nIf we insert the exact solution $a(t_{n})$ into the discrete formula, the one-step defect (local truncation error) is\n$$\n\\tau_{n+1} = a(t_{n+1}) - \\left[a(t_{n}) + \\Delta t\\, \\lambda a(t_{n})\\right] = \\frac{\\Delta t^{2}}{2} \\lambda^{2} a(t_{n}) + \\mathcal{O}(\\Delta t^{3}),\n$$\nwhich is of order $\\mathcal{O}(\\Delta t^{2})$ per step. For a fixed final time $T$ with $n = T / \\Delta t$ steps, the accumulation of these local errors yields a global error of order $\\mathcal{O}(\\Delta t)$, so forward Euler is first-order accurate in time.\n\n2. For the scalar problem, the exact solution at time $t$ is\n$$\na(t) = \\exp(\\lambda t)\\, a(0).\n$$\nAfter $n$ forward Euler steps of size $\\Delta t$ starting from $a(0)$, the numerical solution is\n$$\na^{n} = (1 + \\lambda \\Delta t)^{n}\\, a(0),\n$$\nwith $n = \\frac{T}{\\Delta t}$. The absolute global error at time $T$ is\n$$\nE_{n}(T) = \\left|a^{n} - a(T)\\right| = \\left|(1 + \\lambda \\Delta t)^{n} - \\exp(\\lambda T)\\right|\\, |a(0)|.\n$$\nWe obtain a leading-order asymptotic expression for small $\\Delta t$ by comparing $(1 + \\lambda \\Delta t)^{n}$ to $\\exp(\\lambda T)$. Note that\n$$\n(1 + \\lambda \\Delta t)^{n} = \\exp\\!\\left(n \\ln(1 + \\lambda \\Delta t)\\right).\n$$\nUsing the series $\\ln(1 + x) = x - \\frac{x^{2}}{2} + \\frac{x^{3}}{3} + \\mathcal{O}(x^{4})$ with $x = \\lambda \\Delta t$, we have\n$$\nn \\ln(1 + \\lambda \\Delta t) = n\\left(\\lambda \\Delta t - \\frac{\\lambda^{2} \\Delta t^{2}}{2} + \\frac{\\lambda^{3} \\Delta t^{3}}{3} + \\mathcal{O}(\\Delta t^{4})\\right) = \\lambda T - \\frac{\\lambda^{2} T}{2}\\Delta t + \\frac{\\lambda^{3} T}{3}\\Delta t^{2} + \\mathcal{O}(\\Delta t^{3}).\n$$\nTherefore,\n$$\n(1 + \\lambda \\Delta t)^{n} = \\exp(\\lambda T)\\, \\exp\\!\\left(-\\frac{\\lambda^{2} T}{2}\\Delta t + \\mathcal{O}(\\Delta t^{2})\\right).\n$$\nSubtracting the exact solution and retaining leading-order terms yields\n$$\nE_{n}(T) = \\left|\\exp(\\lambda T)\\left(\\exp\\!\\left(-\\frac{\\lambda^{2} T}{2}\\Delta t + \\mathcal{O}(\\Delta t^{2})\\right) - 1\\right)\\right|\\, |a(0)|.\n$$\nFor small $\\Delta t$, $\\exp(-\\frac{\\lambda^{2} T}{2}\\Delta t) - 1 \\approx -\\frac{\\lambda^{2} T}{2}\\Delta t$, so the leading-order asymptotic expression for the absolute global error is\n$$\nE_{n}(T) \\approx \\exp(\\lambda T)\\, \\frac{\\lambda^{2} T}{2}\\, \\Delta t\\, |a(0)|.\n$$\n\n3. We impose two constraints:\n- Accuracy: $E_{n}(T) \\leq \\varepsilon$.\n- Stability for forward Euler with real negative $\\lambda$: the amplification factor $g = 1 + \\lambda \\Delta t$ must satisfy $|g| \\leq 1$, which for $\\lambda  0$ implies $0  \\Delta t \\le -\\frac{2}{\\lambda}$.\n\nUsing the leading-order error expression,\n$$\n\\exp(\\lambda T)\\, \\frac{\\lambda^{2} T}{2}\\, \\Delta t\\, |a(0)| \\leq \\varepsilon\n\\quad \\Rightarrow \\quad\n\\Delta t \\leq \\frac{2\\, \\varepsilon\\, \\exp(-\\lambda T)}{\\lambda^{2} T\\, |a(0)|}.\n$$\nSubstitute the given values $\\lambda = -2\\,\\mathrm{s}^{-1}$, $T = 4\\,\\mathrm{s}$, $a(0) = 1$, and $\\varepsilon = 1.00 \\times 10^{-3}$:\n$$\n\\exp(-\\lambda T) = \\exp(8),\n\\quad\n\\lambda^{2} T = (-2)^{2} \\cdot 4 = 16,\n\\quad\n|a(0)| = 1.\n$$\nHence,\n$$\n\\Delta t_{\\text{acc}} \\leq \\frac{2 \\times (1.00 \\times 10^{-3}) \\times \\exp(8)}{16} = \\frac{2.00 \\times 10^{-3} \\exp(8)}{16}.\n$$\nCalculating this value:\n$$\n\\Delta t_{\\text{acc}} \\le \\frac{2.00 \\times 10^{-3} \\times 2980.958}{16} \\approx 0.37261975\\,\\mathrm{s}.\n$$\nThe forward Euler stability bound for $\\lambda = -2\\,\\mathrm{s}^{-1}$ is\n$$\n0  \\Delta t \\le -\\frac{2}{\\lambda} = 1\\,\\mathrm{s}.\n$$\nTherefore the largest time step that satisfies both constraints is the minimum of the accuracy- and stability-limited steps:\n$$\n\\Delta t_{\\max} = \\min\\!\\left(0.37261975\\,\\mathrm{s},\\, 1\\,\\mathrm{s}\\right) = 0.37261975\\,\\mathrm{s}.\n$$\nRounded to four significant figures and expressed in seconds, this is $0.3726\\,\\mathrm{s}$.",
            "answer": "$$\\boxed{0.3726}$$"
        },
        {
            "introduction": "In practical aerospace CFD, especially for large-eddy or direct numerical simulations, memory can be a significant bottleneck. This exercise  bridges the gap between the theoretical formulation of Runge-Kutta methods and their efficient implementation in production codes. You will learn how to convert the classical fourth-order Runge-Kutta scheme into a \"low-storage\" variant that dramatically reduces memory requirements, a vital technique for tackling large-scale problems.",
            "id": "3958149",
            "problem": "Consider a semi-discrete formulation of the compressible Euler equations arising in Computational Fluid Dynamics (CFD), written abstractly as an Ordinary Differential Equation (ODE) system\n$$\n\\frac{d \\boldsymbol{U}}{dt} = \\boldsymbol{R}(\\boldsymbol{U}),\n$$\nwhere $\\boldsymbol{U} \\in \\mathbb{R}^{m}$ is the vector of conserved variables and $\\boldsymbol{R}$ is the discrete spatial residual operator. An explicit Runge–Kutta (RK) method with $s$ stages advances $\\boldsymbol{U}^{n}$ at time $t^{n}$ to $\\boldsymbol{U}^{n+1}$ at time $t^{n+1} = t^{n} + \\Delta t$ by forming intermediate stage values and combining their residual evaluations with prescribed coefficients. The classical fourth-order Runge–Kutta method (RK4) has the Butcher weights\n$$\nb_{1} = \\frac{1}{6}, \\quad b_{2} = \\frac{1}{3}, \\quad b_{3} = \\frac{1}{3}, \\quad b_{4} = \\frac{1}{6},\n$$\nand stage abscissae\n$$\nc_{1} = 0, \\quad c_{2} = \\frac{1}{2}, \\quad c_{3} = \\frac{1}{2}, \\quad c_{4} = 1.\n$$\nLow-storage two-register implementations are widely used in aerospace CFD due to memory constraints on large meshes. In the two-register low-storage formulation, one register stores the evolving solution $\\boldsymbol{Y}$ and one register stores a running accumulation $\\boldsymbol{K}$ of scaled residuals. A generic two-register update has the form\n$$\n\\boldsymbol{Y} \\leftarrow \\boldsymbol{Y} + \\alpha_{i}\\,\\boldsymbol{K}, \\qquad \\boldsymbol{K} \\leftarrow \\beta_{i}\\,\\boldsymbol{K} + \\Delta t\\,\\boldsymbol{R}(\\boldsymbol{Y}),\n$$\napplied sequentially over the stages with appropriately chosen coefficients $\\alpha_{i}$ and $\\beta_{i}$. Your tasks are:\n- Starting from the general explicit Runge–Kutta construction and the definitions above, derive a two-register low-storage formulation that accumulates the classical RK4 final combination of residuals, preserving the classical RK4 weights $b_{i}$ in the final update to obtain $\\boldsymbol{U}^{n+1}$.\n- Rewrite the classical RK4 scheme into a concrete sequence of two-register updates using specific $\\alpha_{i}$ and $\\beta_{i}$ that yield the same final RK4 combination $\\sum_{i=1}^{4} b_{i} \\Delta t\\,\\boldsymbol{R}(\\text{stage}_{i})$ when producing $\\boldsymbol{U}^{n+1}$, even if the intermediate stage locations differ from the classical staging.\n- Apply your low-storage RK4 to the linear test equation $u'(t) = \\lambda\\,u(t)$, where $\\lambda \\in \\mathbb{C}$ is a constant and $u(t) \\in \\mathbb{C}$. Let $z = \\lambda\\,\\Delta t$. Derive the one-step amplification factor $G(z)$ defined by $u^{n+1} = G(z)\\,u^{n}$ for your low-storage RK4 that preserves the classical RK4 final weights. Present $G(z)$ as a single closed-form analytic polynomial in $z$.\n\nAnswer format requirements:\n- Provide the final $G(z)$ as a single analytic expression in $z$.\n- No rounding is required.\n- Do not include units with the final expression.",
            "solution": "The problem asks for the amplification factor $G(z)$ of a low-storage fourth-order Runge-Kutta (RK4) scheme. A fundamental property of any Runge-Kutta method is that its order of accuracy is determined by how well its amplification factor, $G(z)$, matches the Taylor series expansion of the exact solution's amplification factor, $e^z$.\n\nFor the linear test equation $u'(t) = \\lambda u(t)$, the exact solution evolves as $u(t^n + \\Delta t) = e^{\\lambda \\Delta t} u(t^n) = e^z u(t^n)$, where $z = \\lambda \\Delta t$.\nThe Taylor series expansion of $e^z$ is:\n$$\ne^z = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} + \\mathcal{O}(z^5)\n$$\nA numerical method is defined to be $p$-th order accurate if its amplification factor $G(z)$ matches the series for $e^z$ up to and including the term of order $z^p$.\n$$\nG(z) = e^z + \\mathcal{O}(z^{p+1})\n$$\nThe problem specifies that we must construct a fourth-order Runge-Kutta scheme ($p=4$) using a low-storage formulation. Regardless of the specific choice of the internal coefficients $\\{\\alpha_i, \\beta_i\\}$ used to construct the scheme, for the method to be fourth-order accurate, its amplification factor must be the truncation of the Taylor series of $e^z$ at the $z^4$ term.\n\nTherefore, the amplification factor $G(z)$ for any valid RK4 scheme, including any low-storage variant that is constructed to be fourth order, is uniquely determined as:\n$$\nG(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}\n$$\nThis polynomial is often called the stability polynomial of the RK4 method. The analysis of the two-register update structure confirms that it is possible to construct a polynomial of degree 4 in $z$ by the end of the final stage, and the order conditions for a fourth-order method fix its coefficients to these specific values.",
            "answer": "$$\n\\boxed{1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 + \\frac{1}{24}z^4}\n$$"
        }
    ]
}