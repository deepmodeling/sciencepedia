{
    "hands_on_practices": [
        {
            "introduction": "The defining feature of high-entropy alloys is the stabilization of a simple, single-phase solid solution by a high configurational entropy of mixing. This exercise provides a hands-on calculation of the Gibbs free energy of mixing, $\\Delta G_{\\text{mix}}$, which is the key thermodynamic quantity governing phase stability. By applying fundamental principles, you will assess the driving force for forming a random solid solution, a foundational step in any hierarchical model that starts from the material's thermodynamic viability. ",
            "id": "3752559",
            "problem": "In a hierarchical multi-scale workflow for a quinary high-entropy alloy (HEA), atomistic simulations have provided an effective isobaric enthalpy of mixing per mole that is approximately composition-independent over a small neighborhood of the processing state. Consider a single-phase substitutional random solution of elements A, B, C, D, and E with mole fractions $x_{\\mathrm{A}}=0.25$, $x_{\\mathrm{B}}=0.25$, $x_{\\mathrm{C}}=0.20$, $x_{\\mathrm{D}}=0.15$, and $x_{\\mathrm{E}}=0.15$ at temperature $T=1200\\,\\mathrm{K}$. The mixing enthalpy per mole supplied by the lower-scale calculation is $\\Delta H_{\\mathrm{mix}}=-5.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Assume that pressure effects are negligible and that non-configurational entropic contributions (vibrational, electronic, magnetic) are small compared to the ideal configurational contribution for this state. The universal gas constant is $R=8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and logarithms are natural.\n\nUsing only fundamental thermodynamic definitions for the Gibbs free energy and the ideal configurational entropy of mixing for a substitutional solution, determine the molar Gibbs free energy of mixing for this state. Express the final energy in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ and round your answer to four significant figures.\n\nBriefly justify, in your working, how the sign of the result would inform the tendency toward chemical ordering versus disordering in a concurrent atomisticâ€“continuum coupling, but report only the requested numerical value as your final answer.",
            "solution": "The primary task is to calculate the molar Gibbs free energy of mixing, $\\Delta G_{\\mathrm{mix}}$, for a quinary high-entropy alloy at a given state. The fundamental thermodynamic relationship defining this quantity is:\n$$\n\\Delta G_{\\mathrm{mix}} = \\Delta H_{\\mathrm{mix}} - T \\Delta S_{\\mathrm{mix}}\n$$\nwhere $\\Delta H_{\\mathrm{mix}}$ is the molar enthalpy of mixing, $T$ is the absolute temperature, and $\\Delta S_{\\mathrm{mix}}$ is the molar entropy of mixing.\n\nThe problem provides the following values:\nThe molar enthalpy of mixing, $\\Delta H_{\\mathrm{mix}} = -5.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\nThe temperature, $T = 1200\\,\\mathrm{K}$.\n\nThe molar entropy of mixing, $\\Delta S_{\\mathrm{mix}}$, must be calculated. The problem states that non-configurational entropic contributions (vibrational, electronic, etc.) are negligible. Therefore, the total entropy of mixing can be approximated by the ideal configurational entropy of mixing, $\\Delta S_{\\mathrm{mix}}^{\\mathrm{config}}$. For a multi-component substitutional random solution with $N$ components, this is given by the statistical mechanical formula:\n$$\n\\Delta S_{\\mathrm{mix}} \\approx \\Delta S_{\\mathrm{mix}}^{\\mathrm{config}} = -R \\sum_{i=1}^{N} x_i \\ln(x_i)\n$$\nwhere $R$ is the universal gas constant and $x_i$ is the mole fraction of component $i$.\n\nThe system is a quinary alloy (A, B, C, D, E) with the following mole fractions:\n$x_{\\mathrm{A}} = 0.25$\n$x_{\\mathrm{B}} = 0.25$\n$x_{\\mathrm{C}} = 0.20$\n$x_{\\mathrm{D}} = 0.15$\n$x_{\\mathrm{E}} = 0.15$\nThe sum is $\\sum x_i = 0.25+0.25+0.20+0.15+0.15 = 1.00$, as required.\n\nThe universal gas constant is given as $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nFirst, we calculate the summation term $\\sum x_i \\ln(x_i)$:\n$$\n\\sum_{i} x_i \\ln(x_i) = x_{\\mathrm{A}}\\ln(x_{\\mathrm{A}}) + x_{\\mathrm{B}}\\ln(x_{\\mathrm{B}}) + x_{\\mathrm{C}}\\ln(x_{\\mathrm{C}}) + x_{\\mathrm{D}}\\ln(x_{\\mathrm{D}}) + x_{\\mathrm{E}}\\ln(x_{\\mathrm{E}})\n$$\n$$\n\\sum_{i} x_i \\ln(x_i) = 2 \\times 0.25\\ln(0.25) + 0.20\\ln(0.20) + 2 \\times 0.15\\ln(0.15)\n$$\nUsing the values for the natural logarithms:\n$\\ln(0.25) \\approx -1.386294$\n$\\ln(0.20) \\approx -1.609438$\n$\\ln(0.15) \\approx -1.897120$\nThe sum becomes:\n$$\n\\sum_{i} x_i \\ln(x_i) \\approx 2 \\times 0.25(-1.386294) + 0.20(-1.609438) + 2 \\times 0.15(-1.897120)\n$$\n$$\n\\sum_{i} x_i \\ln(x_i) \\approx -0.693147 - 0.321888 - 0.569136 = -1.584171\n$$\nNow, we calculate the molar entropy of mixing:\n$$\n\\Delta S_{\\mathrm{mix}} \\approx - (8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (-1.584171)\n$$\n$$\n\\Delta S_{\\mathrm{mix}} \\approx 13.1706\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}\n$$\nNext, we calculate the entropic contribution to the Gibbs free energy, $T \\Delta S_{\\mathrm{mix}}$:\n$$\nT \\Delta S_{\\mathrm{mix}} \\approx (1200\\,\\mathrm{K}) \\times (13.1706\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})\n$$\n$$\nT \\Delta S_{\\mathrm{mix}} \\approx 15804.7\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\n$$\nTo combine this with the enthalpy of mixing, we must express it in the same units, $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$:\n$$\nT \\Delta S_{\\mathrm{mix}} \\approx 15.8047\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\nFinally, we substitute the known values of $\\Delta H_{\\mathrm{mix}}$ and the calculated value of $T \\Delta S_{\\mathrm{mix}}$ into the Gibbs free energy equation:\n$$\n\\Delta G_{\\mathrm{mix}} = \\Delta H_{\\mathrm{mix}} - T \\Delta S_{\\mathrm{mix}}\n$$\n$$\n\\Delta G_{\\mathrm{mix}} \\approx -5.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - 15.8047\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\n$$\n\\Delta G_{\\mathrm{mix}} \\approx -20.8047\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta G_{\\mathrm{mix}} \\approx -20.80\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\nAs requested for justification, the sign of $\\Delta G_{\\mathrm{mix}}$ informs the stability of the phase. A negative value for $\\Delta G_{\\mathrm{mix}}$, as calculated here, indicates that the formation of the random solid solution from its pure constituent elements is a thermodynamically spontaneous process. The large magnitude of the negative value ($|\\Delta G_{\\mathrm{mix}}| \\gg 0$) suggests a high driving force for mixing and, consequently, a high stability of the disordered, single-phase solid solution at this temperature. This stability arises from both an energetically favorable (negative) enthalpy of mixing and a large, positive configurational entropy of mixing, which is characteristic of high-entropy alloys. In a concurrent atomistic-continuum model, this result from continuum-level thermodynamics implies that the system has a strong tendency to remain a disordered solid solution. It would resist phenomena such as chemical ordering (formation of intermetallic compounds) or phase separation into multiple phases, which would correspond to less negative, or even positive, changes in Gibbs free energy. An atomistic simulation coupled with this continuum model would be expected to show atomic configurations that are consistent with a random distribution, thereby validating the assumption of a high-entropy state.",
            "answer": "$$\n\\boxed{-20.80}\n$$"
        },
        {
            "introduction": "Hierarchical multi-scale modeling relies on the concept of a Representative Volume Element (RVE) to bridge the microstructural scale to the macroscopic continuum. A crucial question is: how large must an RVE be to accurately represent the bulk material's properties? This practice explores the statistical foundation of homogenization, guiding you to derive the scaling relationship between property variance and RVE size to determine the minimum length scale required for statistical representativeness. ",
            "id": "3752508",
            "problem": "In a hierarchical multi-scale framework for High-Entropy Alloys (HEA), the macroscopic constitutive response is obtained by homogenizing over a Representative Volume Element (RVE) of edge length $L$ taken from a statistically homogeneous microstructure with finite correlation length $\\ell$. Let $X(\\mathbf{x})$ denote a stationary ergodic scalar property field (e.g., local elastic modulus) with ensemble mean $\\mu$ and microscopic variance $\\sigma_{0}^{2}$. The apparent homogenized property at scale $L$ is the volume average $\\bar{X}_{L}=\\frac{1}{V}\\int_{V} X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}$ over a cubic RVE of volume $V=L^{d}$, with $d=3$. \n\nStarting from the central limit theorem for spatially averaged random fields and the definition of the two-point correlation function $C(\\mathbf{r})=\\langle\\delta X(\\mathbf{x})\\delta X(\\mathbf{x}+\\mathbf{r})\\rangle/\\sigma_{0}^{2}$ with $\\delta X(\\mathbf{x})=X(\\mathbf{x})-\\mu$, assume short-range correlations that decay over a correlation length $\\ell$ and define an effective correlation volume $V_{c}\\approx \\ell^{d}$. Using these fundamentals, derive the scaling of the normalized variance $\\mathrm{Var}[\\bar{X}_{L}]/\\sigma_{0}^{2}$ with $L$ and determine the minimal edge length $L_{RVE}$ required to ensure that the normalized variance satisfies $\\mathrm{Var}[\\bar{X}_{L}]/\\sigma_{0}^{2}\\leq 0.01$ in $d=3$. \n\nExpress the final answer as a closed-form analytic expression in terms of $\\ell$. Do not include units in the final answer. No rounding is required.",
            "solution": "The primary task is to derive the scaling of the variance of the volume-averaged property, $\\mathrm{Var}[\\bar{X}_{L}]$. The variance of $\\bar{X}_{L}$ is defined as $\\mathrm{Var}[\\bar{X}_{L}] = \\langle (\\bar{X}_{L} - \\langle \\bar{X}_{L} \\rangle)^{2} \\rangle$.\n\nFirst, we establish the mean of the averaged property, $\\langle \\bar{X}_{L} \\rangle$. Due to the linearity of the expectation operator and the integral, and because the field $X(\\mathbf{x})$ is stationary, its mean $\\langle X(\\mathbf{x}) \\rangle = \\mu$ is constant.\n$$\n\\langle \\bar{X}_{L} \\rangle = \\left\\langle \\frac{1}{V}\\int_{V} X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} \\right\\rangle = \\frac{1}{V}\\int_{V} \\langle X(\\mathbf{x})\\rangle\\,\\mathrm{d}\\mathbf{x} = \\frac{1}{V}\\int_{V} \\mu\\,\\mathrm{d}\\mathbf{x} = \\frac{\\mu}{V} \\int_{V} \\mathrm{d}\\mathbf{x} = \\frac{\\mu V}{V} = \\mu\n$$\nThe fluctuation of the volume-averaged property is then:\n$$\n\\bar{X}_{L} - \\mu = \\frac{1}{V}\\int_{V} X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} - \\mu = \\frac{1}{V}\\int_{V} (X(\\mathbf{x}) - \\mu)\\,\\mathrm{d}\\mathbf{x} = \\frac{1}{V}\\int_{V} \\delta X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\n$$\nNow we can write the variance $\\mathrm{Var}[\\bar{X}_{L}]$:\n$$\n\\mathrm{Var}[\\bar{X}_{L}] = \\left\\langle \\left( \\frac{1}{V}\\int_{V} \\delta X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} \\right)^2 \\right\\rangle = \\frac{1}{V^2} \\left\\langle \\left(\\int_{V} \\delta X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\\right) \\left(\\int_{V} \\delta X(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y}\\right) \\right\\rangle\n$$\nWe can exchange the expectation and integration operators:\n$$\n\\mathrm{Var}[\\bar{X}_{L}] = \\frac{1}{V^2} \\int_{V}\\int_{V} \\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle \\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\n$$\nThe term $\\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle$ is related to the two-point correlation function $C(\\mathbf{r})$. For a stationary process, this correlation depends only on the separation vector $\\mathbf{r} = \\mathbf{y}-\\mathbf{x}$. Using the provided definition, $C(\\mathbf{y}-\\mathbf{x}) = \\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle / \\sigma_{0}^{2}$, we have $\\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle = \\sigma_{0}^{2} C(\\mathbf{y}-\\mathbf{x})$.\nSubstituting this gives the exact expression for the variance:\n$$\n\\mathrm{Var}[\\bar{X}_{L}] = \\frac{\\sigma_{0}^{2}}{V^2} \\int_{V}\\int_{V} C(\\mathbf{y}-\\mathbf{x}) \\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\n$$\nThe problem guides us to use a simpler, more intuitive argument based on the central limit theorem. For a set of $N$ independent and identically distributed random variables, the variance of their mean scales as $1/N$. In our spatially extended system, the data points are not independent due to spatial correlations up to a length scale $\\ell$.\n\nThe key idea is to conceptually partition the RVE of volume $V = L^d$ into effectively independent sub-volumes. Since the correlations decay over a length $\\ell$, the characteristic volume of a correlated region is the correlation volume, $V_c$. The problem provides the approximation $V_c \\approx \\ell^d$. The number of such effectively independent blocks, $N_{eff}$, within the RVE can be approximated as the ratio of the total volume to the correlation volume:\n$$\nN_{eff} \\approx \\frac{V}{V_c}\n$$\nBy analogy with the standard CLT, the variance of the spatial average $\\bar{X}_L$ is the microscopic (point-wise) variance $\\sigma_0^2$ divided by the number of effective independent samples $N_{eff}$:\n$$\n\\mathrm{Var}[\\bar{X}_{L}] \\approx \\frac{\\sigma_{0}^{2}}{N_{eff}} \\approx \\frac{\\sigma_{0}^{2}}{V/V_c} = \\sigma_{0}^{2} \\frac{V_c}{V}\n$$\nSubstituting $V = L^d$ and $V_c = \\ell^d$, we obtain the scaling law for the normalized variance:\n$$\n\\frac{\\mathrm{Var}[\\bar{X}_{L}]}{\\sigma_{0}^{2}} \\approx \\frac{\\ell^d}{L^d} = \\left(\\frac{\\ell}{L}\\right)^d\n$$\nThis result shows that the variance of the homogenized property decays with the RVE size to the power of the spatial dimension, which is a fundamental result in homogenization theory for systems with short-range correlations.\n\nThe second part of the problem is to find the minimal RVE edge length, $L_{RVE}$, required to satisfy the condition:\n$$\n\\frac{\\mathrm{Var}[\\bar{X}_{L}]}{\\sigma_{0}^{2}} \\leq 0.01\n$$\nThe minimal length $L_{RVE}$ is found by setting the derived expression for the variance to the tolerance limit:\n$$\n\\left(\\frac{\\ell}{L_{RVE}}\\right)^d = 0.01\n$$\nThe problem specifies the dimension $d=3$:\n$$\n\\left(\\frac{\\ell}{L_{RVE}}\\right)^3 = 0.01\n$$\nWe now solve for $L_{RVE}$:\n$$\n\\frac{\\ell^3}{L_{RVE}^3} = \\frac{1}{100}\n$$\n$$\nL_{RVE}^3 = 100 \\ell^3\n$$\nTaking the cube root of both sides gives the expression for $L_{RVE}$:\n$$\nL_{RVE} = (100 \\ell^3)^{1/3} = 100^{1/3} \\ell\n$$\nThis is the required closed-form analytic expression for the minimal RVE edge length in terms of the correlation length $\\ell$.",
            "answer": "$$\\boxed{100^{1/3} \\ell}$$"
        },
        {
            "introduction": "Unlike hierarchical models, concurrent frameworks simulate different physical scales simultaneously, requiring a seamless \"handshake\" between them. A major challenge in these atomistic-continuum couplings is the creation of artificial wave reflections at the interface, which can contaminate the simulation. This practice delves into the core of this problem, using a transfer matrix method to analyze wave propagation and find an optimal overlap region that balances physical accuracy against computational cost. ",
            "id": "3752618",
            "problem": "Consider a one-dimensional longitudinal elastic wave propagating along a bar representing a High-Entropy Alloy (HEA). The left domain is modeled at the atomistic scale via Molecular Dynamics (MD), and the right domain is modeled at the continuum scale via the Finite Element (FE) method. A concurrent coupling is effected through an overlap region of length $L_{\\mathrm{o}}$ in which material properties are blended smoothly. Assume a uniform cross-sectional area $A$, and let the MD and FE regions be characterized by density and Young's modulus pairs $\\left(\\rho_{\\mathrm{MD}},E_{\\mathrm{MD}}\\right)$ and $\\left(\\rho_{\\mathrm{FE}},E_{\\mathrm{FE}}\\right)$, respectively. The overlap region blends the properties linearly from the MD values at $x=0$ to the FE values at $x=L_{\\mathrm{o}}$. A time-harmonic longitudinal wave of angular frequency $\\omega$ is incident from the MD side.\n\nFundamental base:\n- Newton's Second Law and linear elasticity yield the one-dimensional wave equation, which under a time-harmonic ansatz $u(x,t)=\\Re\\left\\{U(x)\\mathrm{e}^{\\mathrm{i}\\omega t}\\right\\}$ reduces to the Helmholtz-type equation $U''(x)+k(x)^{2}U(x)=0$, where $k(x)=\\omega/c(x)$ and $c(x)=\\sqrt{E(x)/\\rho(x)}$.\n- At every material interface, the continuity of displacement $U(x)$ and traction $\\sigma(x)=E(x)\\,\\partial u/\\partial x$ must hold.\n\nIn the frequency domain, the field in a homogeneous segment admits the representation $U(x)=A\\,\\mathrm{e}^{\\mathrm{i}k x}+B\\,\\mathrm{e}^{-\\mathrm{i}k x}$, where $A$ and $B$ are, respectively, the right-going and left-going wave amplitudes. Across an interface from segment $j$ to segment $j+1$, the continuity conditions imply a linear relation between $\\left(A_{j},B_{j}\\right)$ and $\\left(A_{j+1},B_{j+1}\\right)$; and traversing a homogeneous segment of length $d$ induces a phase shift of $\\mathrm{e}^{\\pm \\mathrm{i}k d}$ on $A$ and $B$. By composing these linear maps from the MD side to the FE side across the overlap region, one obtains a global transfer operator that determines the reflection amplitude $R$ at the MD entrance when imposing an outgoing-only condition on the FE side.\n\nDefine an objective function $J(L_{\\mathrm{o}})=\\left|R(L_{\\mathrm{o}})\\right|+\\alpha\\,L_{\\mathrm{o}}$, where the first term penalizes spurious reflections and the second term penalizes computational cost proportional to the overlap size. Your task is to compute, for each test case, the overlap length $L_{\\mathrm{o}}$ (chosen from a provided discrete candidate set) that minimizes $J(L_{\\mathrm{o}})$.\n\nDiscretization and modeling requirements:\n- Discretize the overlap region into $N$ homogeneous cells of uniform width $\\Delta x$, where $N=\\left\\lfloor L_{\\mathrm{o}}/\\Delta x \\right\\rfloor$ and $N\\geq 1$.\n- Within the overlap, define the linearly blended properties at cell $j\\in\\{0,\\dots,N-1\\}$ using the normalized coordinate $s_{j}=j/N$ as $E_{j}=E_{\\mathrm{MD}}+(E_{\\mathrm{FE}}-E_{\\mathrm{MD}})\\,s_{j}$ and $\\rho_{j}=\\rho_{\\mathrm{MD}}+(\\rho_{\\mathrm{FE}}-\\rho_{\\mathrm{MD}})\\,s_{j}$, and $k_{j}=\\omega/\\sqrt{E_{j}/\\rho_{j}}$.\n- For each homogeneous cell $j$, the phase map is represented by the diagonal operator with entries $\\mathrm{e}^{\\mathrm{i}k_{j}\\Delta x}$ and $\\mathrm{e}^{-\\mathrm{i}k_{j}\\Delta x}$ acting on $(A_{j},B_{j})$.\n- At each interface between consecutive cells, and at the MD-to-first-cell and last-cell-to-FE interfaces, enforce continuity of displacement and traction to construct a $2\\times 2$ interface operator. Use the traction coefficient $r=Ek$ for each side of the interface.\n- Compose these operators to obtain the total transfer operator from the MD entrance to the FE exit, and use an outgoing-only condition on the FE side to extract the reflection amplitude $R$ at the MD entrance in a purely mathematical manner.\n- For each candidate $L_{\\mathrm{o}}$, compute $J(L_{\\mathrm{o}})$ and select the minimizer.\n\nUnits and reporting:\n- Use $\\rho$ in $\\mathrm{kg}/\\mathrm{m}^{3}$, $E$ in $\\mathrm{Pa}$, $\\omega$ in $\\mathrm{rad}/\\mathrm{s}$, $A$ in $\\mathrm{m}^{2}$ (note $A$ cancels in the one-dimensional longitudinal formulation here), $L_{\\mathrm{o}}$ and $\\Delta x$ in $\\mathrm{m}$, and $\\alpha$ in $\\mathrm{m}^{-1}$.\n- Express the optimal overlap length $L_{\\mathrm{o}}^{\\star}$ in $\\mathrm{m}$, rounded to six decimal places.\n- Angles must be in radians.\n\nTest suite:\n- Case $1$ (moderate mismatch, moderate frequency): $\\rho_{\\mathrm{MD}}=7800\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{MD}}=1.60\\times 10^{11}\\,\\mathrm{Pa}$, $\\rho_{\\mathrm{FE}}=8000\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{FE}}=1.90\\times 10^{11}\\,\\mathrm{Pa}$, $\\omega=2\\pi\\times 8.0\\times 10^{6}\\,\\mathrm{rad}/\\mathrm{s}$, $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$, $\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$, candidate $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$, $\\alpha=20\\,\\mathrm{m}^{-1}$.\n- Case $2$ (near match, lower frequency): $\\rho_{\\mathrm{MD}}=7900\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{MD}}=1.80\\times 10^{11}\\,\\mathrm{Pa}$, $\\rho_{\\mathrm{FE}}=7950\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{FE}}=1.82\\times 10^{11}\\,\\mathrm{Pa}$, $\\omega=2\\pi\\times 5.0\\times 10^{6}\\,\\mathrm{rad}/\\mathrm{s}$, $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$, $\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$, candidate $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$, $\\alpha=50\\,\\mathrm{m}^{-1}$.\n- Case $3$ (strong mismatch, higher frequency): $\\rho_{\\mathrm{MD}}=7500\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{MD}}=1.30\\times 10^{11}\\,\\mathrm{Pa}$, $\\rho_{\\mathrm{FE}}=8200\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $E_{\\mathrm{FE}}=2.10\\times 10^{11}\\,\\mathrm{Pa}$, $\\omega=2\\pi\\times 1.50\\times 10^{7}\\,\\mathrm{rad}/\\mathrm{s}$, $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$, $\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$, candidate $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$, $\\alpha=10\\,\\mathrm{m}^{-1}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the optimal $L_{\\mathrm{o}}^{\\star}$ in meters rounded to six decimal places, for the cases in the order listed above (for example, $\\left[0.001000,0.000500,0.002000\\right]$).",
            "solution": "The physical system is a one-dimensional bar with spatially varying material properties, leading to the Helmholtz-type equation for the spatial part of a time-harmonic longitudinal wave, $U(x)$:\n$$\n\\frac{d^2U(x)}{dx^2} + k(x)^2 U(x) = 0\n$$\nwhere $k(x) = \\omega / c(x)$ is the spatially varying wavenumber, $\\omega$ is the angular frequency, and $c(x) = \\sqrt{E(x)/\\rho(x)}$ is the local wave speed derived from the Young's modulus $E(x)$ and density $\\rho(x)$.\n\nThe core of the solution is the transfer matrix method, which relates the amplitudes of forward- and backward-propagating waves across different sections of the material. In any homogeneous region with wavenumber $k$, the solution is a superposition of plane waves:\n$$\nU(x) = A e^{\\mathrm{i}k x} + B e^{-\\mathrm{i}k x}\n$$\nwhere $A$ and $B$ are the complex amplitudes of the right-going and left-going waves, respectively. We can represent the state of the wave field by a vector $\\mathbf{v} = \\begin{pmatrix} A \\\\ B \\end{pmatrix}$.\n\nThe specified model divides the system into three parts: a semi-infinite MD region ($x<0$), a finite overlap region of length $L_o$ ($0 \\le x \\le L_o$), and a semi-infinite FE region ($x>L_o$). The overlap region is further discretized into $N = \\lfloor L_{\\mathrm{o}}/\\Delta x \\rfloor$ homogeneous cells of width $\\Delta x$.\n\nThe solution involves two types of operators:\n1.  **Interface Transfer Matrix $\\mathbf{T}$**: This matrix relates the wave amplitudes across an interface between two different media.\n2.  **Propagation Matrix $\\mathbf{P}$**: This matrix describes the phase evolution of the wave amplitudes as they travel across a homogeneous cell.\n\nBy composing these matrices in the correct order, we construct a total transfer matrix $\\mathbf{M}$ that relates the wave amplitudes in the MD region, $\\mathbf{v}_{\\mathrm{MD}}$, to those in the FE region, $\\mathbf{v}_{\\mathrm{FE}}$:\n$$\n\\mathbf{v}_{\\mathrm{FE}} = \\mathbf{M} \\mathbf{v}_{\\mathrm{MD}}\n$$\n\n**Step 1: Derivation of the Interface Transfer Matrix**\nAt an interface between a \"left\" medium (L) and a \"right\" medium (R), we enforce the continuity of displacement $U(x)$ and traction. The problem defines traction amplitude as $\\Sigma(x) = E(x)\\frac{dU}{dx}$. Let the interface be at $x_i$.\nContinuity of displacement: $U_L(x_i) = U_R(x_i)$\n$$\nA_L + B_L = A_R + B_R\n$$\nContinuity of traction: $E_L U_L'(x_i) = E_R U_R'(x_i)$\n$$\nE_L (\\mathrm{i}k_L A_L - \\mathrm{i}k_L B_L) = E_R (\\mathrm{i}k_R A_R - \\mathrm{i}k_R B_R)\n$$\nUsing the 'traction coefficient' $r = E k = E (\\omega/c) = \\omega\\sqrt{E\\rho}$, this simplifies to:\n$$\nr_L (A_L - B_L) = r_R (A_R - B_R)\n$$\nSolving these two linear equations for $A_R$ and $B_R$ in terms of $A_L$ and $B_L$ yields the interface transfer matrix $\\mathbf{T}_{L\\to R}$:\n$$\n\\begin{pmatrix} A_R \\\\ B_R \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 + r_L/r_R & 1 - r_L/r_R \\\\ 1 - r_L/r_R & 1 + r_L/r_R \\end{pmatrix} \\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix}\n$$\nThus, $\\mathbf{T}_{L\\to R} = \\frac{1}{2r_R} \\begin{pmatrix} r_R+r_L & r_R-r_L \\\\ r_R-r_L & r_R+r_L \\end{pmatrix}$.\n\n**Step 2: Derivation of the Propagation Matrix**\nWithin a homogeneous cell $j$ of width $\\Delta x$ and wavenumber $k_j$, the wave propagates from its entrance at $x_{in}$ to its exit at $x_{out} = x_{in} + \\Delta x$. The amplitudes at the exit ($A_{out}, B_{out}$) are related to the amplitudes at the entrance ($A_{in}, B_{in}$) by a simple phase shift:\n$$\nA_{out} = A_{in} e^{\\mathrm{i}k_j \\Delta x} \\quad , \\quad B_{out} = B_{in} e^{-\\mathrm{i}k_j \\Delta x}\n$$\nThis defines the propagation matrix $\\mathbf{P}_j$:\n$$\n\\mathbf{P}_j = \\begin{pmatrix} e^{\\mathrm{i}k_j \\Delta x} & 0 \\\\ 0 & e^{-\\mathrm{i}k_j \\Delta x} \\end{pmatrix}\n$$\n\n**Step 3: Construction of the Total Transfer Matrix**\nThe overlap region consists of $N$ cells, indexed $j=0, \\dots, N-1$. The material properties for cell $j$ are calculated using a linear blending rule with the normalized coordinate $s_j = j/N$:\n$E_j = E_{\\mathrm{MD}} + (E_{\\mathrm{FE}} - E_{\\mathrm{MD}})s_j$\n$\\rho_j = \\rho_{\\mathrm{MD}} + (\\rho_{\\mathrm{FE}} - \\rho_{\\mathrm{MD}})s_j$\nFrom these, we compute $k_j = \\omega/\\sqrt{E_j/\\rho_j}$ and $r_j = \\omega\\sqrt{E_j\\rho_j}$.\n\nNote that for cell $j=0$, $s_0=0$, which implies $E_0=E_{\\mathrm{MD}}$ and $\\rho_0=\\rho_{\\mathrm{MD}}$. Consequently, the interface between the MD region and cell $0$ is non-reflecting, and its transfer matrix $\\mathbf{T}_{\\mathrm{MD}\\to 0}$ is the identity matrix.\n\nThe total transfer matrix $\\mathbf{M}$ is the ordered product of all propagation and interface matrices from the beginning of the overlap region to the FE region:\n$$\n\\mathbf{M} = \\mathbf{T}_{N-1 \\to \\mathrm{FE}} \\cdot \\mathbf{P}_{N-1} \\cdot \\mathbf{T}_{N-2 \\to N-1} \\cdots \\mathbf{T}_{0 \\to 1} \\cdot \\mathbf{P}_0\n$$\nwhere the matrix for the first interface $\\mathbf{T}_{\\mathrm{MD}\\to 0}$ is omitted as it is the identity.\n\n**Step 4: Calculation of the Reflection Coefficient**\nThe incident wave comes from the MD side, so we can normalize its amplitude to $A_{\\mathrm{MD}}=1$. The reflected amplitude is $B_{\\mathrm{MD}} = R$, where $R$ is the reflection coefficient. Thus, $\\mathbf{v}_{\\mathrm{MD}} = \\begin{pmatrix} 1 \\\\ R \\end{pmatrix}$.\nThe outgoing-only condition on the FE side means there is no wave coming from $x=+\\infty$, so $B_{\\mathrm{FE}} = 0$. Hence, $\\mathbf{v}_{\\mathrm{FE}} = \\begin{pmatrix} A_{\\mathrm{FE}} \\\\ 0 \\end{pmatrix}$.\n\nSubstituting these into the global relation $\\mathbf{v}_{\\mathrm{FE}} = \\mathbf{M} \\mathbf{v}_{\\mathrm{MD}}$:\n$$\n\\begin{pmatrix} A_{\\mathrm{FE}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} M_{11} & M_{12} \\\\ M_{21} & M_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ R \\end{pmatrix}\n$$\nThe second row gives the equation $0 = M_{21} \\cdot 1 + M_{22} \\cdot R$, from which we solve for $R$:\n$$\nR = - \\frac{M_{21}}{M_{22}}\n$$\n\n**Step 5: Optimization**\nFor each candidate overlap length $L_{\\mathrm{o}}$, we perform the above calculation to find the reflection coefficient $R(L_{\\mathrm{o}})$. Then, we evaluate the objective function:\n$$\nJ(L_{\\mathrm{o}}) = |R(L_{\\mathrm{o}})| + \\alpha L_{\\mathrm{o}}\n$$\nWe compute $J(L_{\\mathrm{o}})$ for every $L_{\\mathrm{o}}$ in the provided candidate set and select the one that yields the minimum value of $J$. This $L_{\\mathrm{o}}$ is the optimal overlap length, $L_{\\mathrm{o}}^{\\star}$. This entire procedure is repeated for each test case.\n\nThe algorithm to be implemented is as follows:\nFor each test case:\n1. Initialize a list to store results $(J, L_{\\mathrm{o}})$.\n2. For each candidate $L_{\\mathrm{o}}$:\n    a. Calculate $N = \\lfloor L_{\\mathrm{o}}/\\Delta x \\rfloor$.\n    b. Compute material properties ($r_j$, $k_j$) for all $N$ cells, as well as for the FE region ($r_{\\mathrm{FE}}$).\n    c. Sequentially construct the total transfer matrix $\\mathbf{M}$ by pre-multiplying the constituent matrices in reverse order of propagation, starting from $\\mathbf{P}_0$ up to $\\mathbf{T}_{N-1 \\to \\mathrm{FE}}$.\n    d. Calculate $R = -M_{21}/M_{22}$.\n    e. Calculate $J(L_{\\mathrm{o}}) = |R| + \\alpha L_{\\mathrm{o}}$.\n    f. Store the pair $(J(L_{\\mathrm{o}}), L_{\\mathrm{o}})$.\n3. Find the pair with the minimum $J$ value. The corresponding $L_{\\mathrm{o}}$ is the optimal length $L_{\\mathrm{o}}^{\\star}$ for this test case.\n4. After processing all test cases, the final results are formatted and printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the final result.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1\n        {\n            \"rho_md\": 7800.0, \"e_md\": 1.60e11,\n            \"rho_fe\": 8000.0, \"e_fe\": 1.90e11,\n            \"omega\": 2 * np.pi * 8.0e6,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 20.0\n        },\n        # Case 2\n        {\n            \"rho_md\": 7900.0, \"e_md\": 1.80e11,\n            \"rho_fe\": 7950.0, \"e_fe\": 1.82e11,\n            \"omega\": 2 * np.pi * 5.0e6,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 50.0\n        },\n        # Case 3\n        {\n            \"rho_md\": 7500.0, \"e_md\": 1.30e11,\n            \"rho_fe\": 8200.0, \"e_fe\": 2.10e11,\n            \"omega\": 2 * np.pi * 1.50e7,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 10.0\n        }\n    ]\n\n    optimal_los = []\n\n    for case in test_cases:\n        optimal_los.append(find_optimal_lo(case))\n\n    # Format and print the final output as specified.\n    print(f\"[{','.join([f'{lo:.6f}' for lo in optimal_los])}]\")\n\n\ndef find_optimal_lo(params):\n    \"\"\"\n    Finds the optimal overlap length Lo for a single test case.\n    \"\"\"\n    rho_md, e_md = params[\"rho_md\"], params[\"e_md\"]\n    rho_fe, e_fe = params[\"rho_fe\"], params[\"e_fe\"]\n    omega = params[\"omega\"]\n    dx = params[\"dx\"]\n    lo_candidates = params[\"lo_candidates\"]\n    alpha = params[\"alpha\"]\n\n    min_j = float('inf')\n    optimal_lo = -1.0\n\n    r_fe = omega * np.sqrt(e_fe * rho_fe)\n    \n    for lo in lo_candidates:\n        n_cells = int(np.floor(lo / dx))\n        if n_cells  1:\n            # Per problem spec, N must be >= 1.\n            # This case won't be hit with the given test data.\n            continue\n        \n        # --- Pre-calculate properties for all cells ---\n        s_vals = np.arange(n_cells) / n_cells\n        e_cells = e_md + (e_fe - e_md) * s_vals\n        rho_cells = rho_md + (rho_fe - rho_md) * s_vals\n        \n        r_cells = omega * np.sqrt(e_cells * rho_cells)\n        k_cells = omega / np.sqrt(e_cells / rho_cells)\n\n        # --- Construct total transfer matrix M ---\n        # The first interface T_{MD -> 0} is identity because cell 0 has MD properties.\n        # So, the chain starts with P_0.\n        \n        # P_0\n        phase = 1j * k_cells[0] * dx\n        M = np.array([[np.exp(phase), 0], [0, np.exp(-phase)]], dtype=np.cdouble)\n\n        # Chain multiplication for the rest of the cells\n        for j in range(1, n_cells):\n            # Interface T_{j-1 -> j}\n            r_left = r_cells[j-1]\n            r_right = r_cells[j]\n            p = r_left / r_right\n            t11 = 0.5 * (1 + p)\n            t12 = 0.5 * (1 - p)\n            T_interface = np.array([[t11, t12], [t12, t11]], dtype=np.cdouble)\n            M = T_interface @ M\n            \n            # Propagation P_j\n            phase = 1j * k_cells[j] * dx\n            P_prop = np.array([[np.exp(phase), 0], [0, np.exp(-phase)]], dtype=np.cdouble)\n            M = P_prop @ M\n            \n        # Final interface T_{N-1 -> FE}\n        r_left = r_cells[n_cells - 1]\n        r_right = r_fe\n        p = r_left / r_right\n        t11 = 0.5 * (1 + p)\n        t12 = 0.5 * (1 - p)\n        T_final = np.array([[t11, t12], [t12, t11]], dtype=np.cdouble)\n        M = T_final @ M\n\n        # --- Calculate reflection and objective function J ---\n        m21, m22 = M[1, 0], M[1, 1]\n        \n        if np.abs(m22)  1e-12:\n            # Avoid division by zero, though unlikely with physical properties.\n            # A very large reflection would be implied.\n            R = complex(1e12, 0)\n        else:\n            R = -m21 / m22\n            \n        J = np.abs(R) + alpha * lo\n        \n        if J  min_j:\n            min_j = J\n            optimal_lo = lo\n            \n    return optimal_lo\n\n\nsolve()\n```"
        }
    ]
}