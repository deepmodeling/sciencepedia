{
    "hands_on_practices": [
        {
            "introduction": "This practice provides a direct, hands-on opportunity to implement the core Green-Kubo relation for shear viscosity. By starting with a known analytical model for the stress autocorrelation function, you will focus on the essential numerical steps: integrating the function over time and applying the correct physical prefactors and unit conversions . This foundational exercise bridges the gap between the abstract formula, $\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} \\langle \\sigma_{xy}(0) \\sigma_{xy}(t) \\rangle dt$, and a concrete numerical value, building a robust understanding of how transport coefficients are extracted from fluctuation data.",
            "id": "3813719",
            "problem": "You are asked to design and implement a complete, runnable program that computes the shear viscosity of a monatomic Lennard-Jones fluid from equilibrium stress fluctuations and then nondimensionalizes the result using Lennard-Jones reduced units. The physical and mathematical basis must be established from first principles. Do not begin from any pre-given transport formulas. Instead, construct the computation from the fundamental definitions of equilibrium time correlation functions in Linear Response Theory (LRT) and the Fluctuation-Dissipation Theorem (FDT), together with the microscopic definition of the stress tensor. The program should:\n\n- Begin from the statement that in LRT, transport coefficients are obtained as equilibrium time integrals of appropriate autocorrelation functions of the corresponding fluxes. For an isotropic fluid, the relevant flux for shear viscosity is the off-diagonal microscopic stress component, which you should denote by $\\sigma_{xy}(t)$.\n- Use the following parametric equilibrium autocorrelation model for the off-diagonal stress component:\n$$\nC(t) = C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right),\n$$\nwhere $C_{0}$ has units of pressure squared in the International System of Units (SI), $t$ is time in SI seconds, $\\tau$ is the characteristic relaxation time in SI seconds, and $\\beta$ is a dimensionless stretching exponent. This functional form, with $\\beta$ in the range $[1,2]$, represents physically plausible relaxation behaviors that cover simple exponential decay and compressed or Gaussian-like decays in liquids.\n\n- Compute the volume $V$ from a given number of particles $N$ and number density $\\rho$ according to $V = N/\\rho$. The number density may be provided in reduced form $\\rho^{\\ast}$, defined below, which must be converted to SI using the Lennard-Jones length scale.\n- Numerically integrate the autocorrelation function over time from $t=0$ to $t=\\infty$ by using a finite cutoff $t_{\\max}$ and a time step $\\Delta t$ chosen to control the numerical error. Use $t_{\\max} = \\alpha\\, \\tau$ with $\\alpha = 20$ and $\\Delta t = \\tau/2000$. Implement the numerical integral using a stable quadrature method suitable for equally spaced samples. The integral must be evaluated in SI units, yielding a quantity with units of pressure squared times time.\n- Combine the time integral with the equilibrium prefactor implied by LRT to produce the dimensional shear viscosity in Pascal-seconds. You must express the final dimensional viscosity in $\\mathrm{Pa\\cdot s}$, as a float.\n- Nondimensionalize the result using Lennard-Jones reduced units. For a Lennard-Jones fluid characterized by length scale $\\sigma$ (in meters), energy scale $\\varepsilon$ (in Joules), and particle mass $m$ (in kilograms), use:\n  - Reduced temperature $T^{\\ast} = \\frac{k_{\\mathrm{B}} T}{\\varepsilon}$,\n  - Reduced number density $\\rho^{\\ast} = \\rho\\, \\sigma^{3}$,\n  - Reduced time $t^{\\ast} = \\frac{t}{\\sigma \\sqrt{m/\\varepsilon}}$,\n  - Reduced viscosity $\\eta^{\\ast} = \\frac{\\eta}{\\sqrt{m \\varepsilon}/\\sigma^{2}}$,\n  - Reduced volume $V^{\\ast} = \\frac{V}{\\sigma^{3}}$,\n  - Reduced stress $\\sigma_{xy}^{\\ast} = \\frac{\\sigma_{xy}}{\\varepsilon/\\sigma^{3}}$ and reduced autocorrelation amplitude $C_{0}^{\\ast} = \\frac{C_{0}}{(\\varepsilon/\\sigma^{3})^{2}}$.\n  Here $k_{\\mathrm{B}}$ is the Boltzmann constant. Your program must compute both the dimensional viscosity $\\eta$ in $\\mathrm{Pa\\cdot s}$ and the reduced viscosity $\\eta^{\\ast}$ as defined above, for each test case.\n\n- Use the Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$ in SI units and convert $\\varepsilon$ from a provided temperature scale $T_{\\varepsilon}$ via $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$.\n\nScientific and numerical specifications:\n- Use $N$ as an integer number of particles, $\\rho^{\\ast}$ as the dimensionless reduced number density, and convert to SI number density via $\\rho = \\rho^{\\ast} / \\sigma^{3}$.\n- Use $V = N/\\rho$ for the prefactor volume.\n- Integrate $C(t)$ on a uniform time grid $t_{i} = i \\Delta t$ for $i = 0,1,\\dots,M$ with $M$ such that $M \\Delta t = t_{\\max}$, using the trapezoidal rule.\n\nRequired final outputs:\n- For each test case, compute two floats: the dimensional shear viscosity $\\eta$ in $\\mathrm{Pa\\cdot s}$, and the reduced viscosity $\\eta^{\\ast}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is itself a two-element list in the order $[\\eta,\\eta^{\\ast}]$. For example: $[\\,[\\eta_{1},\\eta_{1}^{\\ast}],\\,[\\eta_{2},\\eta_{2}^{\\ast}]\\,]$.\n\nTest suite:\nImplement the program for the following three scientifically plausible Lennard-Jones fluid cases using Argon-like parameters. For all cases, use $\\sigma = 3.405\\times 10^{-10}\\,\\mathrm{m}$, $m = 6.6335209\\times 10^{-26}\\,\\mathrm{kg}$, and $T_{\\varepsilon} = 119.8\\,\\mathrm{K}$ so that $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$. The Boltzmann constant is $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n\n- Case $1$ (dense liquid, stretched exponential decay):\n  - $N = 1000$,\n  - $T = 120\\,\\mathrm{K}$,\n  - $\\rho^{\\ast} = 0.85$,\n  - $C_{0} = 3.6\\times 10^{12}\\,\\mathrm{Pa^{2}}$,\n  - $\\tau = 2.0\\times 10^{-12}\\,\\mathrm{s}$,\n  - $\\beta = 1.2$.\n\n- Case $2$ (dilute gas-like, simple exponential decay):\n  - $N = 1000$,\n  - $T = 300\\,\\mathrm{K}$,\n  - $\\rho^{\\ast} = 0.05$,\n  - $C_{0} = 1.05\\times 10^{11}\\,\\mathrm{Pa^{2}}$,\n  - $\\tau = 5.0\\times 10^{-13}\\,\\mathrm{s}$,\n  - $\\beta = 1.0$.\n\n- Case $3$ (high density, near-solid-like, compressed decay):\n  - $N = 1000$,\n  - $T = 90\\,\\mathrm{K}$,\n  - $\\rho^{\\ast} = 0.95$,\n  - $C_{0} = 8.9\\times 10^{12}\\,\\mathrm{Pa^{2}}$,\n  - $\\tau = 1.0\\times 10^{-11}\\,\\mathrm{s}$,\n  - $\\beta = 2.0$.\n\nImplementation notes:\n- Your numerical integration choices $t_{\\max} = 20\\,\\tau$ and $\\Delta t = \\tau/2000$ must be used consistently for all cases. These values are chosen to make the residual tail contribution negligible for $\\beta \\ge 1$ while keeping computational cost manageable.\n- The program must perform all unit conversions internally and must not require any user input or external files.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case’s result as $[\\eta,\\eta^{\\ast}]$ in that order, for all three cases: $[\\,[\\eta_{1},\\eta_{1}^{\\ast}],\\,[\\eta_{2},\\eta_{2}^{\\ast}],\\,[\\eta_{3},\\eta_{3}^{\\ast}]\\,]$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and all necessary data and definitions are provided for a unique solution. The task is to compute the shear viscosity of a Lennard-Jones fluid from a model of its equilibrium stress fluctuations, based on the principles of Linear Response Theory (LRT).\n\nThe fundamental starting point, as stipulated, is the Green-Kubo relation for shear viscosity, $\\eta$, which is a cornerstone of LRT applied to transport phenomena. For an isotropic fluid in a volume $V$ at temperature $T$, the shear viscosity is related to the time integral of the equilibrium autocorrelation function of an off-diagonal component of the microscopic stress tensor, which we denote $\\sigma_{xy}$. The precise expression is:\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} \\langle \\sigma_{xy}(0) \\sigma_{xy}(t) \\rangle dt\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\langle \\cdot \\rangle$ denotes an equilibrium ensemble average.\n\nThe problem provides a specific parametric model for the stress autocorrelation function, $C(t)$, which represents the ensemble average $\\langle \\sigma_{xy}(0) \\sigma_{xy}(t) \\rangle$. This model is the stretched exponential, or Kohlrausch-Williams-Watts (KWW), function:\n$$\nC(t) = C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right)\n$$\nHere, $C_{0}$ is the initial value of the autocorrelation function in units of pressure-squared ($\\mathrm{Pa^2}$), $\\tau$ is the characteristic relaxation time in seconds, and $\\beta$ is a dimensionless stretching exponent. Substituting this model into the Green-Kubo formula yields the expression for viscosity that we must evaluate:\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right) dt\n$$\n\nThe computational procedure involves determining all quantities in SI units, performing the integration numerically, and then nondimensionalizing the result.\n\nFirst, we calculate the physical parameters in SI units for each test case.\nThe Boltzmann constant is $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\nThe Lennard-Jones energy scale, $\\varepsilon$, is derived from the given characteristic temperature $T_{\\varepsilon} = 119.8\\,\\mathrm{K}$ as $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$.\nThe system volume, $V$, is calculated from the number of particles, $N$, and the number density, $\\rho$. The number density is given in reduced units, $\\rho^{\\ast}$, and must be converted to SI units using the Lennard-Jones length scale, $\\sigma = 3.405\\times 10^{-10}\\,\\mathrm{m}$, via the definition $\\rho^{\\ast} = \\rho \\sigma^3$. This gives $\\rho = \\rho^{\\ast} / \\sigma^3$. Then, the volume is $V = N/\\rho$. All other parameters for each case are provided directly in SI units.\n\nSecond, we address the numerical evaluation of the integral $I = \\int_{0}^{\\infty} C(t) dt$. The integral's upper limit is infinite, so for numerical computation, we must truncate it at a finite time, $t_{\\max}$. The problem specifies $t_{\\max} = \\alpha \\tau$ with $\\alpha = 20$. This cutoff is justified because for $\\beta \\ge 1.0$, the integrand $C(t)$ decays extremely rapidly. At $t=t_{\\max}$, the argument of the exponential is $-(t_{\\max}/\\tau)^{\\beta} = -20^{\\beta}$, making the value of the exponential, and thus the contribution of the tail for $tt_{\\max}$, negligible. The problem dictates the use of the trapezoidal rule for integration over a uniform time grid. The time step is specified as $\\Delta t = \\tau/2000$. This implies the number of intervals for the integration is $M = t_{\\max}/\\Delta t = (20\\tau)/(\\tau/2000) = 40000$. The time grid is therefore $t_i = i \\Delta t$ for $i = 0, 1, \\dots, M$. The integral $I$ is approximated as:\n$$\nI \\approx \\int_{0}^{t_{\\max}} C(t) dt = \\Delta t \\left( \\frac{C(t_0) + C(t_M)}{2} + \\sum_{i=1}^{M-1} C(t_i) \\right)\n$$\nwhere $C(t_i) = C_{0}\\, \\exp\\!\\left(-\\left(t_i/\\tau\\right)^{\\beta}\\right)$.\n\nThird, once the integral $I$ is computed in units of $\\mathrm{Pa^2 \\cdot s}$, the dimensional shear viscosity, $\\eta$, is calculated by multiplying by the prefactor:\n$$\n\\eta = \\left( \\frac{V}{k_{\\mathrm{B}} T} \\right) I\n$$\nThe units of the prefactor are $\\mathrm{m^3 / J}$, and since $\\mathrm{J = N \\cdot m}$ and $\\mathrm{Pa = N / m^2}$, the final unit for $\\eta$ is $(\\mathrm{m^3 / (N \\cdot m)}) \\cdot (\\mathrm{Pa^2 \\cdot s}) = (\\mathrm{m^2 / N}) \\cdot (\\mathrm{N^2 / m^4 \\cdot s}) = \\mathrm{N \\cdot s / m^2} = \\mathrm{Pa \\cdot s}$, as required.\n\nFourth, we nondimensionalize the resulting viscosity. In the Lennard-Jones system of reduced units, the characteristic unit of viscosity is determined by the fundamental parameters of the system: mass $m$, energy $\\varepsilon$, and length $\\sigma$. This characteristic viscosity is $\\eta_0 = \\sqrt{m \\varepsilon} / \\sigma^2$. The reduced viscosity, $\\eta^{\\ast}$, is the ratio of the dimensional viscosity to this characteristic unit:\n$$\n\\eta^{\\ast} = \\frac{\\eta}{\\eta_0} = \\eta \\frac{\\sigma^2}{\\sqrt{m \\varepsilon}}\n$$\nThis dimensionless quantity is computed for each case using the provided values for $m$ and $\\sigma$ and the calculated value for $\\varepsilon$.\n\nThe algorithmic summary for each test case is as follows:\n1.  Calculate $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$.\n2.  Calculate SI number density $\\rho = \\rho^{\\ast} / \\sigma^3$.\n3.  Calculate volume $V = N / \\rho$.\n4.  Set up the numerical integration parameters: $t_{\\max} = 20\\tau$ and the number of points $M+1=40001$.\n5.  Generate the time grid $t_i$ from $0$ to $t_{\\max}$.\n6.  Evaluate the function $C(t_i)$ for all points on the grid.\n7.  Compute the integral $I$ using the trapezoidal rule.\n8.  Calculate dimensional viscosity $\\eta = (V / (k_{\\mathrm{B}} T)) \\times I$.\n9.  Calculate the scaling factor $\\eta_0 = \\sqrt{m\\varepsilon}/\\sigma^2$ and the reduced viscosity $\\eta^{\\ast} = \\eta / \\eta_0$.\nThe final output is a list containing the pair $[\\eta, \\eta^{\\ast}]$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensional and reduced shear viscosity for a Lennard-Jones fluid\n    based on the Green-Kubo relations and a model for the stress autocorrelation function.\n    \"\"\"\n    # Define physical constants\n    KB_SI = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define Lennard-Jones parameters for an Argon-like fluid\n    SIGMA_SI = 3.405e-10      # Lennard-Jones length scale in meters\n    MASS_SI = 6.6335209e-26  # Particle mass in kilograms\n    T_EPSILON_K = 119.8      # Lennard-Jones energy scale in Kelvin\n    EPSILON_SI = KB_SI * T_EPSILON_K  # Lennard-Jones energy scale in Joules\n\n    # Define numerical integration parameters\n    ALPHA = 20.0             # t_max = ALPHA * tau\n    TIME_STEP_FACTOR = 2000.0  # delta_t = tau / TIME_STEP_FACTOR\n\n    # Test suite with three cases\n    test_cases = [\n        # Case 1: dense liquid, stretched exponential decay\n        {'N': 1000, 'T_K': 120.0, 'rho_star': 0.85, 'C0_Pa2': 3.6e12, 'tau_s': 2.0e-12, 'beta': 1.2},\n        # Case 2: dilute gas-like, simple exponential decay\n        {'N': 1000, 'T_K': 300.0, 'rho_star': 0.05, 'C0_Pa2': 1.05e11, 'tau_s': 5.0e-13, 'beta': 1.0},\n        # Case 3: high density, near-solid-like, compressed decay\n        {'N': 1000, 'T_K': 90.0, 'rho_star': 0.95, 'C0_Pa2': 8.9e12, 'tau_s': 1.0e-11, 'beta': 2.0}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        N = case['N']\n        T_K = case['T_K']\n        rho_star = case['rho_star']\n        C0_Pa2 = case['C0_Pa2']\n        tau_s = case['tau_s']\n        beta = case['beta']\n\n        # Step 1: Calculate physical quantities in SI units\n        rho_si = rho_star / (SIGMA_SI**3)\n        V_m3 = N / rho_si\n\n        # Step 2: Set up for numerical integration\n        t_max_s = ALPHA * tau_s\n        # The number of intervals M is derived from t_max = M * delta_t\n        # and delta_t = tau / 2000.\n        # M = (alpha * tau) / (tau / 2000) = alpha * 2000\n        num_intervals = int(ALPHA * TIME_STEP_FACTOR)\n        \n        # Create a uniform time grid with num_intervals+1 points\n        t_grid = np.linspace(0, t_max_s, num_intervals + 1)\n\n        # Step 3: Evaluate the autocorrelation function C(t) on the grid\n        # The expression (t_grid / tau_s) is safe, no division by zero at t=0\n        C_t_values = C0_Pa2 * np.exp(-(t_grid / tau_s)**beta)\n\n        # Step 4: Numerically integrate C(t) from 0 to t_max using the trapezoidal rule\n        integral_val = np.trapz(C_t_values, t_grid)\n\n        # Step 5: Calculate the dimensional shear viscosity (eta)\n        prefactor = V_m3 / (KB_SI * T_K)\n        eta_pascal_seconds = prefactor * integral_val\n\n        # Step 6: Nondimensionalize the viscosity\n        # Characteristic viscosity unit in LJ system\n        eta_lj_unit = np.sqrt(MASS_SI * EPSILON_SI) / (SIGMA_SI**2)\n        eta_star = eta_pascal_seconds / eta_lj_unit\n        \n        all_results.append([eta_pascal_seconds, eta_star])\n\n    # Final print statement in the exact required format.\n    # The format [ [...] , [...] ] is achieved by using the default list-to-string conversion.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Obtaining a reliable transport coefficient requires more than just evaluating an integral; it demands a carefully designed molecular dynamics simulation to generate the underlying correlation data. This practice focuses on the crucial decisions made before a simulation runs, such as selecting the total trajectory length $T_{\\mathrm{run}}$, the data sampling interval $\\Delta t$, and the thermostatting method . Mastering these parameters is key to ensuring that the collected data is both statistically converged and physically meaningful, avoiding common pitfalls that can lead to inaccurate results.",
            "id": "3813722",
            "problem": "A researcher plans to compute a transport coefficient of a three-dimensional material using the Green-Kubo (GK) relations, which express the coefficient as a time integral of an equilibrium flux autocorrelation function. The simulation will be performed with Molecular Dynamics (MD). Let the stationary equilibrium flux be denoted by $J(t)$ and its autocorrelation by $C_{JJ}(t)=\\langle J(0)J(t)\\rangle$, where $\\langle \\cdot \\rangle$ is an equilibrium ensemble average. Assume $C_{JJ}(t)$ decays to zero for large $t$ in a manner that is initially fast on a microscopic time scale and may exhibit a hydrodynamic long-time tail. Define the characteristic (integral) correlation time $\\tau_c$ as the minimal time such that the contribution to the time integral from $t\\tau_c$ is small compared to the target precision, and let $\\omega_{\\max}$ denote the largest physically relevant angular frequency associated with the fastest flux fluctuations in the material (for example, a highest phonon frequency or collision frequency). Denote the MD sampling interval by $\\Delta t$, the total trajectory length used for data collection by $T_{\\mathrm{run}}$, and the thermostat relaxation time by $\\tau_T$ if a thermostat is applied.\n\nFrom equilibrium statistical mechanics, the GK estimator involves time correlations in an appropriate equilibrium ensemble. Convergence of the estimated transport coefficient is controlled by (i) discretization error in numerically approximating the time integral of $C_{JJ}(t)$ from samples separated by $\\Delta t$, (ii) truncation error from cutting off the integral at a finite $t_{\\max}$, and (iii) statistical error that decreases with the effective number of independent correlation samples, which scales with $T_{\\mathrm{run}}/\\tau_c$. Thermostat choice can affect both the sampled equilibrium distribution and the dynamical correlations if coupling is too strong.\n\nWhich of the following sets of criteria are physically sound and sufficient to achieve converged GK transport coefficients for a generic material system, while balancing numerical accuracy and statistical efficiency? Select all that apply.\n\nA. Choose $\\Delta t$ much smaller than both the fastest flux time scale and the correlation time, specifically $\\Delta t \\ll \\min\\!\\big(\\pi/\\omega_{\\max},\\,\\tau_c\\big)$, so the short-time structure of $C_{JJ}(t)$ is resolved and numerical quadrature is accurate. Ensure the trajectory length satisfies $T_{\\mathrm{run}} \\gtrsim 100\\,\\tau_c$ so that the statistical uncertainty in the time integral scales as $O\\!\\big(\\sqrt{\\tau_c/T_{\\mathrm{run}}}\\big)$ and is small. Use either microcanonical dynamics (constant number, volume, energy; NVE) or a weakly coupled canonical thermostat (constant number, volume, temperature; NVT) with $\\tau_T \\gg \\tau_c$ so the equilibrium distribution is sampled while minimally perturbing flux dynamics, and truncate the integral at the smallest $t_{\\max}$ where $C_{JJ}(t)$ has decayed to within noise.\n\nB. Choose $\\Delta t \\approx \\tau_c$ to reduce data storage while still covering the decay window, take $T_{\\mathrm{run}} \\approx 5\\,\\tau_c$ to avoid unnecessarily long runs, and apply a strongly coupled velocity-rescaling thermostat with $\\tau_T \\approx \\tau_c/10$ to tightly control temperature during data collection; truncate the integral at $t_{\\max}=\\tau_c$.\n\nC. Choose $\\Delta t$ such that the Nyquist frequency equals the fastest flux frequency, $\\Delta t = \\pi/\\omega_{\\max}$, take $T_{\\mathrm{run}}=\\tau_c$, and replace equilibrium sampling with a small non-equilibrium gradient to accelerate convergence; estimate the coefficient from the time-correlation measured under the gradient since the equilibrium integral is recovered in the linear response limit.\n\nD. Equilibrate under a thermostat, then switch to microcanonical dynamics (NVE) for data collection. Choose $\\Delta t \\ll \\pi/\\omega_{\\max}$ so the discretized $C_{JJ}(t)$ captures the correct short-time curvature, and take $T_{\\mathrm{run}} \\gg \\tau_c$ so that the number of effectively independent samples $T_{\\mathrm{run}}/\\tau_c$ is large. Use block averaging to assess statistical convergence of the time integral and treat any slow hydrodynamic tail by fitting $C_{JJ}(t)$ beyond the noise floor to a theoretically motivated long-time form before truncation.\n\nE. Use a stochastic Langevin thermostat with large friction to suppress high-frequency noise in $J(t)$ during measurement, set $\\Delta t  \\tau_c$ to minimize serial correlations between successive samples, and integrate $C_{JJ}(t)$ only up to $t_{\\max}=\\tau_c$ to avoid contamination by long-time tails.",
            "solution": "This problem tests the understanding of the practical requirements for obtaining accurate transport coefficients from equilibrium Molecular Dynamics (MD) simulations via the Green-Kubo (GK) relations. A correct procedure must balance several competing factors: accurately resolving the correlation function in time, running the simulation long enough to achieve statistical convergence, and ensuring the simulation dynamics correctly sample the desired physical ensemble. Let's analyze each option.\n\n**Option A:** This option presents a comprehensive and physically sound strategy.\n-   **$\\Delta t \\ll \\min(\\pi/\\omega_{\\max}, \\tau_c)$:** The condition $\\Delta t \\ll \\pi/\\omega_{\\max}$ ensures that the fastest physical oscillations are well-sampled, satisfying the Nyquist-Shannon sampling theorem and preventing aliasing. This is crucial for accurately capturing the initial decay of $C_{JJ}(t)$ and correctly evaluating the time integral.\n-   **$T_{\\mathrm{run}} \\gtrsim 100\\,\\tau_c$:** The statistical error of the GK integral decreases as $\\sqrt{\\tau_c/T_{\\mathrm{run}}}$. A long trajectory ($T_{\\mathrm{run}} \\gg \\tau_c$) is essential to gather a sufficient number of statistically independent segments of length $\\tau_c$, thereby reducing the statistical noise. The factor of 100 is a good rule of thumb for achieving convergence.\n-   **NVE or weakly coupled NVT ($\\tau_T \\gg \\tau_c$):** GK theory is derived for Hamiltonian dynamics (NVE). Using a thermostat (NVT) is permissible for data collection only if its coupling to the system is weak, meaning its characteristic time scale $\\tau_T$ is much longer than the correlation time $\\tau_c$ of the physical process. This ensures the thermostat does not artificially alter the natural decay of the flux correlations.\n-   **Truncation:** Truncating the integral where the signal decays into the noise is the correct practical approach.\nThis option is a standard, correct protocol.\n\n**Option B:** This option is incorrect on multiple fronts.\n-   **$\\Delta t \\approx \\tau_c$:** This sampling interval is far too large. It would completely miss the short-time decay of the correlation function, leading to a massive discretization error in the integral.\n-   **$T_{\\mathrm{run}} \\approx 5\\,\\tau_c$:** This run length is too short for good statistical convergence. It would only provide a handful of independent samples.\n-   **Strongly coupled thermostat ($\\tau_T \\approx \\tau_c/10$):** Using a thermostat with a relaxation time shorter than the physical correlation time will heavily perturb the system's natural dynamics, corrupting the correlation function and yielding an incorrect transport coefficient.\n\n**Option C:** This option confuses equilibrium and non-equilibrium methods.\n-   The Green-Kubo method is an equilibrium method. Applying a non-equilibrium gradient to compute the coefficient is the principle behind Non-Equilibrium Molecular Dynamics (NEMD), which is a different (though related) technique. This option incorrectly mixes the two approaches.\n-   $T_{\\mathrm{run}}=\\tau_c$ is too short for statistical convergence.\n-   Sampling exactly at the Nyquist frequency ($\\Delta t = \\pi/\\omega_{\\max}$) is borderline and risky; one should sample significantly faster.\n\n**Option D:** This option describes another excellent and widely-used protocol, which complements option A.\n-   **Equilibrate (NVT/NPT) then produce (NVE):** This is the canonical and most rigorous approach. It ensures the system is at the correct state point (temperature, density) and then collects dynamical data from the unperturbed, energy-conserving dynamics for which the GK formulas are formally derived.\n-   **$\\Delta t \\ll \\pi/\\omega_{\\max}$ and $T_{\\mathrm{run}} \\gg \\tau_c$:** These are the correct criteria for numerical accuracy and statistical convergence, as explained for option A.\n-   **Block averaging:** This is a standard and robust technique for estimating the statistical error in time-correlated data, which is essential for judging convergence.\n-   **Fitting the long-time tail:** For systems known to have hydrodynamic long-time tails (e.g., $t^{-d/2}$), the statistical noise in the simulation can obscure this slow decay. Fitting the simulated $C_{JJ}(t)$ to the known theoretical form beyond a certain time and integrating the fitted function analytically can provide a more accurate estimate of the tail's contribution than direct numerical integration of the noisy data. This is an advanced and correct technique.\nThis option represents a best-practice protocol.\n\n**Option E:** This option is fundamentally flawed.\n-   **Langevin with large friction:** A Langevin thermostat with large friction introduces significant stochastic forces that heavily damp the system's dynamics. This will artificially shorten the correlation time and lead to a completely wrong transport coefficient. The goal is to measure the intrinsic transport, not transport in the presence of a strong external damping force.\n-   **$\\Delta t > \\tau_c$:** This sampling rate is far too low and would miss the entire decay process.\n\nIn summary, options A and D both describe physically sound and computationally robust methods for calculating Green-Kubo transport coefficients. They represent two slightly different, but equally valid, best-practice approaches. Options B, C, and E contain fundamental errors in their understanding of sampling theory, statistical convergence, thermostat application, or the distinction between equilibrium and non-equilibrium methods.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "Many complex materials, such as supercooled liquids or high-entropy alloys, exhibit viscoelastic behavior that a single viscosity value cannot fully capture. This advanced practice moves beyond the steady-state viscosity to explore the frequency-dependent response, $\\eta(\\omega)$, which provides a much richer picture of material dynamics . By applying the Fourier-Laplace transform to the stress autocorrelation function, you will learn how to extract the full viscoelastic spectrum, a powerful tool for characterizing materials with complex relaxation processes.",
            "id": "3744370",
            "problem": "You are tasked with implementing a principled numerical extraction of viscoelastic relaxation spectra and the associated frequency-dependent viscosity for synthetic stress autocorrelation functions representative of a liquid High-Entropy Alloy (HEA) near the crystallization line. Your program must use a first-principles approach grounded in linear response theory and the fluctuation-dissipation framework, without invoking pre-specified target formulas.\n\nThe fundamental base to use includes the following scientifically established principles:\n- Linear response theory connecting small-amplitude shear perturbations to stress response.\n- The fluctuation-dissipation theorem relating equilibrium fluctuations to transport coefficients.\n- The definition of stress autocorrelation in equilibrium for the off-diagonal stress component.\n- The concept that the complex, frequency-dependent viscosity arises from a causal time convolution and is connected to the stress autocorrelation via a Fourier-Laplace transform under equilibrium conditions.\n- The Green-Kubo framework for transport coefficients, whereby time integrals of equilibrium autocorrelation functions yield macroscopic coefficients.\n\nYour program must proceed as follows for each test case:\n1. Construct a discrete time series for the stress autocorrelation function $C(t_i)$ at $t_i = i\\,\\Delta t$ for $i = 0, 1, \\dots, N-1$, using the model and parameters specified in the test suite. The autocorrelation is to be constructed from one of the following parametric forms:\n   - Maxwell spectrum of relaxation modes: a finite sum of decaying exponentials $C(t) = \\sum_{j=1}^{M} G_j \\exp\\!\\left(-t/\\tau_j\\right)$, where $G_j \\ge 0$ are mode strengths and $\\tau_j  0$ are relaxation times.\n   - Stretched exponential form $C(t) = G \\exp\\!\\left(-(t/\\tau_0)^\\beta\\right)$, with $G \\ge 0$, $\\tau_0  0$, and $0  \\beta  1$ capturing broad relaxation spectra.\n\n2. Estimate a non-negative viscoelastic relaxation spectrum $S(\\tau)$ over a logarithmically spaced grid of relaxation times $\\{\\tau_k\\}_{k=1}^{K}$ by solving a constrained least-squares approximation to $C(t)$ using the representation $C(t) \\approx \\sum_{k=1}^{K} S(\\tau_k) \\exp\\!\\left(-t/\\tau_k\\right)$, with $S(\\tau_k) \\ge 0$. The spectrum should be estimated using non-negative least squares, and the grid $\\{\\tau_k\\}$ must cover a physically relevant decade range encompassing the sampling window defined by $\\Delta t$ and $N$.\n\n3. Compute the zero-frequency (steady) viscosity by numerically integrating the autocorrelation function in time consistent with the Green-Kubo framework and express the final answer in Pascal-second (Pa·s). The numerical integration must be performed over the available time window using an appropriate quadrature rule.\n\n4. Compute the complex, frequency-dependent viscosity at two specified angular frequencies $\\omega_1$ and $\\omega_2$ (in radians per second) by numerically evaluating the causal Fourier-Laplace transform of $C(t)$ over the available time window. Report the real and imaginary parts for both frequencies with units of Pascal-second (Pa·s). The angle unit is radians.\n\n5. Aggregate results for each test case into a list of five decimal numbers in Pascal-second (Pa·s), in the order: $[\\eta_0, \\operatorname{Re}\\,\\eta(\\omega_1), \\operatorname{Im}\\,\\eta(\\omega_1), \\operatorname{Re}\\,\\eta(\\omega_2), \\operatorname{Im}\\,\\eta(\\omega_2)]$.\n\nTest suite and parameters:\n- Physical constants and units:\n  - Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ Joule per Kelvin (J/K).\n  - All stresses in Pascal ($\\mathrm{Pa}$), times in seconds ($\\mathrm{s}$), volumes in cubic meters ($\\mathrm{m}^3$), temperature in Kelvin ($\\mathrm{K}$), angular frequency in radians per second.\n\n- Test Case A (happy path, single Maxwell mode):\n  - Temperature $T = 1800$.\n  - Volume $V = 10^{-6}$.\n  - Time step $\\Delta t = 10^{-11}$.\n  - Number of samples $N = 5000$.\n  - Angular frequencies $\\omega_1 = 10^{9}$ and $\\omega_2 = 5\\times 10^{10}$.\n  - Autocorrelation model: Maxwell with one mode $G_1 = 10^{-6}$ and $\\tau_1 = 2\\times 10^{-11}$.\n\n- Test Case B (multi-mode, widely separated time scales):\n  - Temperature $T = 1800$.\n  - Volume $V = 10^{-6}$.\n  - Time step $\\Delta t = 10^{-11}$.\n  - Number of samples $N = 8000$.\n  - Angular frequencies $\\omega_1 = 5\\times 10^{8}$ and $\\omega_2 = 10^{10}$.\n  - Autocorrelation model: Maxwell with two modes $G_1 = 10^{-6}$, $\\tau_1 = 5\\times 10^{-12}$ and $G_2 = 4\\times 10^{-7}$, $\\tau_2 = 5\\times 10^{-10}$.\n\n- Test Case C (edge case, broad relaxation via stretched exponential):\n  - Temperature $T = 1800$.\n  - Volume $V = 10^{-6}$.\n  - Time step $\\Delta t = 10^{-11}$.\n  - Number of samples $N = 5000$.\n  - Angular frequencies $\\omega_1 = 5\\times 10^{8}$ and $\\omega_2 = 10^{10}$.\n  - Autocorrelation model: Stretched exponential with $G = 1.88\\times 10^{-8}$, $\\tau_0 = 2\\times 10^{-9}$, and $\\beta = 0.4$.\n\nAlgorithmic and numerical requirements:\n- The non-negative least squares fit must be computed on a logarithmically spaced grid $\\{\\tau_k\\}$ that spans at least from $10^{-12}$ to $10^{-8}$ seconds with at least $K = 60$ points.\n- The numerical time integrals and transforms must be computed using stable quadrature over the sampled window; use a method appropriate for smooth decays over finite intervals.\n- The final viscosity values must be expressed in Pascal-second (Pa·s). Each reported number must be a decimal float.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist in the specified order. For example: \"[[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n,o]]\".",
            "solution": "The problem statement is a valid, well-posed, and scientifically grounded exercise in computational materials physics. It requires the implementation of numerical methods based on the Green-Kubo relations, which are a cornerstone of statistical mechanics, to compute the viscoelastic properties of a model system representative of a High-Entropy Alloy. The problem provides all necessary physical parameters, model definitions, and numerical constraints to proceed with a unique and verifiable solution.\n\nThe theoretical foundation of this problem lies in linear response theory and the fluctuation-dissipation theorem. The shear viscosity, a macroscopic transport coefficient, can be related to the time integral of the equilibrium fluctuations of the off-diagonal components of the stress tensor. The zero-frequency (or steady-state) shear viscosity, $\\eta_0$, is given by the Green-Kubo formula:\n$$ \\eta_0 = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\, dt $$\nwhere $V$ is the system volume, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $C(t)$ is the stress-stress autocorrelation function (SSACF), defined as $C(t) = \\langle \\sigma_{\\alpha\\beta}(0) \\sigma_{\\alpha\\beta}(t) \\rangle$ for an off-diagonal component $\\alpha\\beta$ (e.g., $xy$).\n\nThe frequency-dependent complex viscosity, $\\eta(\\omega)$, is obtained via a causal Fourier-Laplace transform of the same autocorrelation function:\n$$ \\eta(\\omega) = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) e^{-i\\omega t} \\, dt $$\nThe real and imaginary parts of $\\eta(\\omega)$ are therefore:\n$$ \\operatorname{Re}\\,\\eta(\\omega) = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\cos(\\omega t) \\, dt $$\n$$ \\operatorname{Im}\\,\\eta(\\omega) = - \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\sin(\\omega t) \\, dt $$\nWe will implement a numerical solution following the sequence of steps outlined in the problem.\n\n**Step 1: Construct the Stress Autocorrelation Function, $C(t)$**\nFor each test case, we generate a discrete time series $C(t_i)$ for $t_i = i \\Delta t$, where $i = 0, 1, \\dots, N-1$. The functional form of $C(t)$ is given by either a sum of Maxwell modes or a stretched exponential.\n\n**Step 2: Estimate the Viscoelastic Relaxation Spectrum, $S(\\tau)$**\nThe problem requires estimating a non-negative relaxation spectrum $S(\\tau)$ by solving the constrained least-squares problem that approximates the continuous relaxation spectrum integral:\n$$ C(t) = \\int_0^\\infty S(\\tau) e^{-t/\\tau} \\, d\\tau \\approx \\sum_{k=1}^{K} S(\\tau_k) e^{-t/\\tau_k} $$\nThis is a linear inverse problem, which we discretize for our sampled times $t_i$ and a chosen grid of relaxation times $\\tau_k$. Let $\\mathbf{c}$ be the vector of $C(t_i)$ values, $\\mathbf{s}$ be the vector of unknown spectral weights $S(\\tau_k)$, and $\\mathbf{A}$ be the matrix with elements $A_{ik} = \\exp(-t_i/\\tau_k)$. We must solve the system $\\mathbf{A}\\mathbf{s} \\approx \\mathbf{c}$ under the constraint $s_k \\ge 0$ for all $k$. This is achieved using a Non-Negative Least Squares (NNLS) algorithm, which finds the vector $\\mathbf{s}$ that minimizes $\\|\\mathbf{A}\\mathbf{s} - \\mathbf{c}\\|_2^2$. This step is performed as required, though its results are not used for the final viscosity calculations, which are based directly on the provided analytical forms of $C(t)$. The relaxation time grid $\\{\\tau_k\\}$ is specified as $K=60$ logarithmically spaced points spanning from $10^{-12} \\, \\mathrm{s}$ to $10^{-8} \\, \\mathrm{s}$.\n\n**Step 3: Compute the Zero-Frequency Viscosity, $\\eta_0$**\nThe integral for $\\eta_0$ is computed numerically over the available time window $[0, (N-1)\\Delta t]$. Since the provided time series is discretely and uniformly sampled, the trapezoidal rule is a simple, stable, and appropriate quadrature method. The integral is thus approximated as:\n$$ \\int_0^{t_{\\text{max}}} C(t) \\, dt \\approx \\sum_{i=0}^{N-2} \\frac{C(t_i) + C(t_{i+1})}{2} \\Delta t $$\nThis numerical integral is then multiplied by the prefactor $\\frac{V}{k_{\\mathrm{B}} T}$ to obtain $\\eta_0$.\n\n**Step 4: Compute the Complex Viscosity, $\\eta(\\omega)$**\nSimilarly, the Fourier cosine and sine transforms required for $\\operatorname{Re}\\,\\eta(\\omega)$ and $\\operatorname{Im}\\,\\eta(\\omega)$ are computed using the trapezoidal rule. The integrands are $C(t) \\cos(\\omega t)$ and $C(t) \\sin(\\omega t)$, respectively. The numerical evaluation is performed for the specified frequencies $\\omega_1$ and $\\omega_2$.\n$$ \\operatorname{Re}\\,\\eta(\\omega) \\approx \\frac{V}{k_{\\mathrm{B}} T} \\times \\text{trapz}(C(t_i) \\cos(\\omega t_i), t_i) $$\n$$ \\operatorname{Im}\\,\\eta(\\omega) \\approx - \\frac{V}{k_{\\mathrm{B}} T} \\times \\text{trapz}(C(t_i) \\sin(\\omega t_i), t_i) $$\n\n**Step 5: Aggregate and Report Results**\nThe calculated values for each test case—$\\eta_0$, $\\operatorname{Re}\\,\\eta(\\omega_1)$, $\\operatorname{Im}\\,\\eta(\\omega_1)$, $\\operatorname{Re}\\,\\eta(\\omega_2)$, and $\\operatorname{Im}\\,\\eta(\\omega_2)$—are collected and formatted into the specified list-of-lists structure. All calculations are performed in base SI units, and the final viscosities are reported in $\\mathrm{Pa \\cdot s}$.\n\nThe implementation will proceed by iterating through each test case, performing these five steps, and collating the final numerical results as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the viscoelasticity problem for the given test cases.\n    \"\"\"\n    # Physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Test suite definition\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 5000,\n            \"omegas\": [1.0e9, 5.0e10],\n            \"model\": \"maxwell\",\n            \"params\": {\"modes\": [(1.0e-6, 2.0e-11)]}\n        },\n        {\n            \"name\": \"Case B\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 8000,\n            \"omegas\": [5.0e8, 1.0e10],\n            \"model\": \"maxwell\",\n            \"params\": {\"modes\": [(1.0e-6, 5.0e-12), (4.0e-7, 5.0e-10)]}\n        },\n        {\n            \"name\": \"Case C\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 5000,\n            \"omegas\": [5.0e8, 1.0e10],\n            \"model\": \"stretched_exp\",\n            \"params\": {\"G\": 1.88e-8, \"tau0\": 2.0e-9, \"beta\": 0.4}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        T = case[\"T\"]\n        V = case[\"V\"]\n        dt = case[\"dt\"]\n        N = case[\"N\"]\n        omega1, omega2 = case[\"omegas\"]\n        model = case[\"model\"]\n        params = case[\"params\"]\n\n        # Step 1: Construct the stress autocorrelation function C(t)\n        t = np.arange(N) * dt\n\n        if model == \"maxwell\":\n            C_t = np.zeros_like(t, dtype=float)\n            for G_j, tau_j in params[\"modes\"]:\n                C_t += G_j * np.exp(-t / tau_j)\n        elif model == \"stretched_exp\":\n            G = params[\"G\"]\n            tau0 = params[\"tau0\"]\n            beta = params[\"beta\"]\n            # To avoid division by zero or NaN at t=0 when tau0 is very small\n            # we handle t=0 separately. (t/tau0)**beta for t=0 is 0.\n            # np.power correctly handles 0**positive_power = 0.\n            # However, to be safe against potential floating point issues.\n            C_t = G * np.exp(-np.power(t / tau0, beta, where=t0, out=np.zeros_like(t, dtype=float)))\n        \n        # Step 2: Estimate the viscoelastic relaxation spectrum S(tau) via NNLS\n        # This step is performed as required, but its output is not used for viscosity calculations.\n        K = 60\n        tau_k = np.logspace(-12, -8, K)\n        # Construct the matrix A for the least squares problem\n        # A_ik = exp(-t_i / tau_k)\n        A = np.exp(-t[:, np.newaxis] / tau_k[np.newaxis, :])\n        \n        # Solve the non-negative least squares problem\n        S_tau_k, _ = nnls(A, C_t)\n\n        # Step 3  4: Compute viscosities using numerical integration on C(t)\n        prefactor = V / (K_B * T)\n\n        # Compute zero-frequency viscosity eta_0\n        eta_0 = prefactor * np.trapz(C_t, t)\n\n        # Compute complex viscosity at omega_1 and omega_2\n        omegas = [omega1, omega2]\n        case_results = [eta_0]\n        \n        for omega in omegas:\n            # Integrand for Real part: C(t) * cos(omega*t)\n            integrand_real = C_t * np.cos(omega * t)\n            re_eta = prefactor * np.trapz(integrand_real, t)\n            \n            # Integrand for Imaginary part: C(t) * sin(omega*t)\n            integrand_imag = C_t * np.sin(omega * t)\n            # Note the negative sign in the formula for Im(eta)\n            im_eta = -prefactor * np.trapz(integrand_imag, t)\n            \n            case_results.extend([re_eta, im_eta])\n\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format\n    # Example format: [[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n,o]]\n    formatted_results = f\"[{','.join([f'[{\",\".join(map(str, res))}]' for res in all_results])}]\"\n    print(formatted_results)\n\nsolve()\n```"
        }
    ]
}