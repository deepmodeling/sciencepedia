{
    "hands_on_practices": [
        {
            "introduction": "掌握格林-久保关系的第一步是将其核心积分公式转化为可执行的计算。本练习提供了一个直接的动手实践机会，您将通过对一个给定的应力自相关函数模型进行数值积分来计算剪切粘度。这个过程不仅能加深您对理论与代码之间联系的理解，还能锻炼您在计算物理中处理单位转换和无量纲化的关键技能。",
            "id": "3813719",
            "problem": "您的任务是设计并实现一个完整、可运行的程序，该程序基于平衡态应力涨落计算单原子Lennard-Jones流体的剪切黏度，然后使用Lennard-Jones约化单位对结果进行无量纲化处理。其物理和数学基础必须从第一性原理出发建立。不要从任何预先给定的输运公式开始，而应基于线性响应理论（LRT）和涨落-耗散定理（FDT）中平衡态时间相关函数的基本定义，并结合应力张量的微观定义来构建计算。程序应满足以下要求：\n\n- 从LRT中的一个论断开始：输运系数是通过对相应“流”的自相关函数进行平衡态时间积分得到的。对于各向同性流体，与剪切黏度相关的“流”是微观应力张量的非对角分量，您应将其表示为 $\\sigma_{xy}(t)$。\n- 对非对角应力分量使用以下参数化平衡自相关模型：\n$$\nC(t) = C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right),\n$$\n其中，$C_{0}$ 在国际单位制（SI）中的单位是压力的平方，$t$ 是以SI秒为单位的时间，$\\tau$ 是以SI秒为单位的特征弛豫时间，$\\beta$ 是一个无量纲的拉伸指数。当 $\\beta$ 在 $[1,2]$ 范围内时，该函数形式能够表示物理上合理的弛豫行为，涵盖了从简单指数衰减到液体中的压缩或类高斯衰减等情况。\n\n- 根据给定的粒子数 $N$ 和数密度 $\\rho$，通过公式 $V = N/\\rho$ 计算体积 $V$。数密度可能以如下定义的约化形式 $\\rho^{\\ast}$ 给出，必须使用Lennard-Jones长度标度将其转换为SI单位。\n- 使用有限截断时间 $t_{\\max}$ 和为控制数值误差而选择的时间步长 $\\Delta t$，对自相关函数在时间上从 $t=0$ 到 $t=\\infty$ 进行数值积分。使用 $t_{\\max} = \\alpha\\, \\tau$（其中 $\\alpha = 20$）和 $\\Delta t = \\tau/2000$。采用适用于等间距样本的稳定求积方法实现数值积分。该积分必须在SI单位下计算，得到一个单位为压力平方乘以时间的量。\n- 将时间积分与LRT所隐含的平衡态前置因子结合，以计算出以帕斯卡·秒为单位的有量纲剪切黏度。您必须将最终的有量纲黏度表示为 $\\mathrm{Pa\\cdot s}$，并作为浮点数。\n- 使用Lennard-Jones约化单位对结果进行无量纲化。对于由长度标度 $\\sigma$（米）、能量标度 $\\varepsilon$（焦耳）和粒子质量 $m$（千克）表征的Lennard-Jones流体，使用以下定义：\n  - 约化温度 $T^{\\ast} = \\frac{k_{\\mathrm{B}} T}{\\varepsilon}$，\n  - 约化数密度 $\\rho^{\\ast} = \\rho\\, \\sigma^{3}$，\n  - 约化时间 $t^{\\ast} = \\frac{t}{\\sigma \\sqrt{m/\\varepsilon}}$，\n  - 约化黏度 $\\eta^{\\ast} = \\frac{\\eta}{\\sqrt{m \\varepsilon}/\\sigma^{2}}$，\n  - 约化体积 $V^{\\ast} = \\frac{V}{\\sigma^{3}}$，\n  - 约化应力 $\\sigma_{xy}^{\\ast} = \\frac{\\sigma_{xy}}{\\varepsilon/\\sigma^{3}}$ 及约化自相关振幅 $C_{0}^{\\ast} = \\frac{C_{0}}{(\\varepsilon/\\sigma^{3})^{2}}$。\n  这里的 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。您的程序必须为每个测试案例计算有量纲黏度 $\\eta$（单位为 $\\mathrm{Pa\\cdot s}$）和如上定义的约化黏度 $\\eta^{\\ast}$。\n\n- 在SI单位制下使用玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$，并通过 $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$ 从给定的温标 $T_{\\varepsilon}$ 转换得到 $\\varepsilon$。\n\n科学与数值规范：\n- 使用 $N$ 作为整数粒子数，$\\rho^{\\ast}$ 作为无量纲的约化数密度，并通过 $\\rho = \\rho^{\\ast} / \\sigma^{3}$ 将其转换为SI单位的数密度。\n- 使用 $V = N/\\rho$ 计算前置因子中的体积。\n- 在均匀时间网格 $t_{i} = i \\Delta t$（其中 $i = 0,1,\\dots,M$ 且 $M$ 满足 $M \\Delta t = t_{\\max}$）上，使用梯形法则对 $C(t)$ 进行积分。\n\n最终输出要求：\n- 对每个测试案例，计算两个浮点数：有量纲的剪切黏度 $\\eta$（单位为 $\\mathrm{Pa\\cdot s}$）和约化黏度 $\\eta^{\\ast}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身是一个包含两个值的列表，顺序为 $[\\eta,\\eta^{\\ast}]$。例如：$[\\,[\\eta_{1},\\eta_{1}^{\\ast}],\\,[\\eta_{2},\\eta_{2}^{\\ast}]\\,]$。\n\n测试套件：\n使用类似氩的参数，为以下三个科学上合理的Lennard-Jones流体案例实现程序。对于所有案例，均使用 $\\sigma = 3.405\\times 10^{-10}\\,\\mathrm{m}$，$m = 6.6335209\\times 10^{-26}\\,\\mathrm{kg}$，以及 $T_{\\varepsilon} = 119.8\\,\\mathrm{K}$，因此 $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$。玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n\n- 案例1（稠密液体，拉伸指数衰减）：\n  - $N = 1000$，\n  - $T = 120\\,\\mathrm{K}$，\n  - $\\rho^{\\ast} = 0.85$，\n  - $C_{0} = 3.6\\times 10^{12}\\,\\mathrm{Pa^{2}}$，\n  - $\\tau = 2.0\\times 10^{-12}\\,\\mathrm{s}$，\n  - $\\beta = 1.2$。\n\n- 案例2（类稀疏气体，简单指数衰减）：\n  - $N = 1000$，\n  - $T = 300\\,\\mathrm{K}$，\n  - $\\rho^{\\ast} = 0.05$，\n  - $C_{0} = 1.05\\times 10^{11}\\,\\mathrm{Pa^{2}}$，\n  - $\\tau = 5.0\\times 10^{-13}\\,\\mathrm{s}$，\n  - $\\beta = 1.0$。\n\n- 案例3（高密度，类固体，压缩衰减）：\n  - $N = 1000$，\n  - $T = 90\\,\\mathrm{K}$，\n  - $\\rho^{\\ast} = 0.95$，\n  - $C_{0} = 8.9\\times 10^{12}\\,\\mathrm{Pa^{2}}$，\n  - $\\tau = 1.0\\times 10^{-11}\\,\\mathrm{s}$，\n  - $\\beta = 2.0$。\n\n实现说明：\n- 您的数值积分选择 $t_{\\max} = 20\\,\\tau$ 和 $\\Delta t = \\tau/2000$ 必须在所有案例中保持一致。选择这些值是为了在保持计算成本可控的同时，使 $\\beta \\ge 1$ 时的剩余尾部贡献可以忽略不计。\n- 程序必须在内部执行所有单位转换，并且不得要求任何用户输入或外部文件。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个案例的结果按 $[\\eta, \\eta^{\\ast}]$ 的顺序排列，包含所有三个案例：$[\\,[\\eta_{1},\\eta_{1}^{\\ast}],\\,[\\eta_{2},\\eta_{2}^{\\ast}],\\,[\\eta_{3},\\eta_{3}^{\\ast}]\\,]$。",
            "solution": "该问题是有效的，因为它具有科学依据，提法明确，并且为获得唯一解提供了所有必要的数据和定义。任务是基于线性响应理论（LRT）的原理，根据平衡态应力涨落模型计算Lennard-Jones流体的剪切黏度。\n\n按规定，基本出发点是剪切黏度 $\\eta$ 的Green-Kubo关系式，这是应用于输运现象的LRT的基石。对于在体积 $V$ 和温度 $T$ 下的各向同性流体，剪切黏度与微观应力张量非对角分量（我们记为 $\\sigma_{xy}$）的平衡自相关函数的时间积分有关。精确表达式为：\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} \\langle \\sigma_{xy}(0) \\sigma_{xy}(t) \\rangle dt\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\langle \\cdot \\rangle$ 表示平衡系综平均。\n\n问题为应力自相关函数 $C(t)$ 提供了一个特定的参数模型，它代表了系综平均 $\\langle \\sigma_{xy}(0) \\sigma_{xy}(t) \\rangle$。这个模型是拉伸指数函数，或称Kohlrausch-Williams-Watts（KWW）函数：\n$$\nC(t) = C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right)\n$$\n在这里，$C_{0}$ 是自相关函数的初始值，单位是压力的平方（$\\mathrm{Pa^2}$），$\\tau$ 是特征弛豫时间（秒），$\\beta$ 是无量纲的拉伸指数。将此模型代入Green-Kubo公式，得到我们必须计算的黏度表达式：\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} C_{0}\\, \\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{\\beta}\\right) dt\n$$\n\n计算过程包括：确定所有量的SI单位，进行数值积分，然后对结果进行无量纲化。\n\n首先，我们为每个测试案例计算SI单位下的物理参数。\n玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\nLennard-Jones能量标度 $\\varepsilon$ 由给定的特征温度 $T_{\\varepsilon} = 119.8\\,\\mathrm{K}$ 导出，即 $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$。\n系统体积 $V$ 由粒子数 $N$ 和数密度 $\\rho$ 计算得出。数密度以约化单位 $\\rho^{\\ast}$ 给出，必须通过定义 $\\rho^{\\ast} = \\rho \\sigma^3$ 使用Lennard-Jones长度标度 $\\sigma = 3.405\\times 10^{-10}\\,\\mathrm{m}$ 将其转换为SI单位。这得到 $\\rho = \\rho^{\\ast} / \\sigma^3$。然后，体积为 $V = N/\\rho$。每个案例的所有其他参数都直接以SI单位提供。\n\n其次，我们处理积分 $I = \\int_{0}^{\\infty} C(t) dt$ 的数值计算。积分的上限是无穷大，因此在数值计算中，我们必须在有限时间 $t_{\\max}$ 处截断它。问题指定 $t_{\\max} = \\alpha \\tau$，其中 $\\alpha = 20$。这个截断是合理的，因为对于 $\\beta \\ge 1.0$，被积函数 $C(t)$ 衰减得非常快。在 $t=t_{\\max}$ 时，指数的参数为 $-(t_{\\max}/\\tau)^{\\beta} = -20^{\\beta}$，这使得指数的值以及 $tt_{\\max}$ 的尾部贡献可以忽略不计。问题规定使用梯形法则在均匀时间网格上进行积分。时间步长指定为 $\\Delta t = \\tau/2000$。这意味着积分的区间数为 $M = t_{\\max}/\\Delta t = (20\\tau)/(\\tau/2000) = 40000$。因此，时间网格为 $t_i = i \\Delta t$，其中 $i = 0, 1, \\dots, M$。积分 $I$ 近似为：\n$$\nI \\approx \\int_{0}^{t_{\\max}} C(t) dt = \\Delta t \\left( \\frac{C(t_0) + C(t_M)}{2} + \\sum_{i=1}^{M-1} C(t_i) \\right)\n$$\n其中 $C(t_i) = C_{0}\\, \\exp\\!\\left(-\\left(t_i/\\tau\\right)^{\\beta}\\right)$。\n\n第三，一旦积分 $I$ 以 $\\mathrm{Pa^2 \\cdot s}$ 为单位计算出来，有量纲的剪切黏度 $\\eta$ 就通过乘以预因子来计算：\n$$\n\\eta = \\left( \\frac{V}{k_{\\mathrm{B}} T} \\right) I\n$$\n前置因子的单位是 $\\mathrm{m^3 / J}$，并且由于 $\\mathrm{J = N \\cdot m}$ 和 $\\mathrm{Pa = N / m^2}$，$\\eta$ 的最终单位是 $(\\mathrm{m^3 / (N \\cdot m)}) \\cdot (\\mathrm{Pa^2 \\cdot s}) = (\\mathrm{m^2 / N}) \\cdot (\\mathrm{N^2 / m^4 \\cdot s}) = \\mathrm{N \\cdot s / m^2} = \\mathrm{Pa \\cdot s}$，符合要求。\n\n第四，我们对得到的黏度进行无量纲化。在Lennard-Jones约化单位体系中，黏度的特征单位由系统的基本参数决定：质量 $m$、能量 $\\varepsilon$ 和长度 $\\sigma$。这个特征黏度是 $\\eta_0 = \\sqrt{m \\varepsilon} / \\sigma^2$。约化黏度 $\\eta^{\\ast}$ 是有量纲黏度与此特征单位的比值：\n$$\n\\eta^{\\ast} = \\frac{\\eta}{\\eta_0} = \\eta \\frac{\\sigma^2}{\\sqrt{m \\varepsilon}}\n$$\n对于每个案例，使用提供的 $m$ 和 $\\sigma$ 值以及计算出的 $\\varepsilon$ 值来计算这个无量纲量。\n\n每个测试案例的算法摘要如下：\n1.  计算 $\\varepsilon = k_{\\mathrm{B}} T_{\\varepsilon}$。\n2.  计算SI单位的数密度 $\\rho = \\rho^{\\ast} / \\sigma^3$。\n3.  计算体积 $V = N / \\rho$。\n4.  设置数值积分参数：$t_{\\max} = 20\\tau$ 和点数 $M+1=40001$。\n5.  生成从 $0$ 到 $t_{\\max}$ 的时间网格 $t_i$。\n6.  计算网格上所有点的函数值 $C(t_i)$。\n7.  使用梯形法则计算积分 $I$。\n8.  计算有量纲黏度 $\\eta = (V / (k_{\\mathrm{B}} T)) \\times I$。\n9.  计算换算因子 $\\eta_0 = \\sqrt{m\\varepsilon}/\\sigma^2$ 和约化黏度 $\\eta^{\\ast} = \\eta / \\eta_0$。\n最终输出是一个列表，其中包含每个测试案例的 $[\\eta, \\eta^{\\ast}]$ 对。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensional and reduced shear viscosity for a Lennard-Jones fluid\n    based on the Green-Kubo relations and a model for the stress autocorrelation function.\n    \"\"\"\n    # Define physical constants\n    KB_SI = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define Lennard-Jones parameters for an Argon-like fluid\n    SIGMA_SI = 3.405e-10      # Lennard-Jones length scale in meters\n    MASS_SI = 6.6335209e-26  # Particle mass in kilograms\n    T_EPSILON_K = 119.8      # Lennard-Jones energy scale in Kelvin\n    EPSILON_SI = KB_SI * T_EPSILON_K  # Lennard-Jones energy scale in Joules\n\n    # Define numerical integration parameters\n    ALPHA = 20.0             # t_max = ALPHA * tau\n    TIME_STEP_FACTOR = 2000.0  # delta_t = tau / TIME_STEP_FACTOR\n\n    # Test suite with three cases\n    test_cases = [\n        # Case 1: dense liquid, stretched exponential decay\n        {'N': 1000, 'T_K': 120.0, 'rho_star': 0.85, 'C0_Pa2': 3.6e12, 'tau_s': 2.0e-12, 'beta': 1.2},\n        # Case 2: dilute gas-like, simple exponential decay\n        {'N': 1000, 'T_K': 300.0, 'rho_star': 0.05, 'C0_Pa2': 1.05e11, 'tau_s': 5.0e-13, 'beta': 1.0},\n        # Case 3: high density, near-solid-like, compressed decay\n        {'N': 1000, 'T_K': 90.0, 'rho_star': 0.95, 'C0_Pa2': 8.9e12, 'tau_s': 1.0e-11, 'beta': 2.0}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        N = case['N']\n        T_K = case['T_K']\n        rho_star = case['rho_star']\n        C0_Pa2 = case['C0_Pa2']\n        tau_s = case['tau_s']\n        beta = case['beta']\n\n        # Step 1: Calculate physical quantities in SI units\n        rho_si = rho_star / (SIGMA_SI**3)\n        V_m3 = N / rho_si\n\n        # Step 2: Set up for numerical integration\n        t_max_s = ALPHA * tau_s\n        # The number of intervals M is derived from t_max = M * delta_t\n        # and delta_t = tau / 2000.\n        # M = (alpha * tau) / (tau / 2000) = alpha * 2000\n        num_intervals = int(ALPHA * TIME_STEP_FACTOR)\n        \n        # Create a uniform time grid with num_intervals+1 points\n        t_grid = np.linspace(0, t_max_s, num_intervals + 1)\n\n        # Step 3: Evaluate the autocorrelation function C(t) on the grid\n        # The expression (t_grid / tau_s) is safe, no division by zero at t=0\n        C_t_values = C0_Pa2 * np.exp(-(t_grid / tau_s)**beta)\n\n        # Step 4: Numerically integrate C(t) from 0 to t_max using the trapezoidal rule\n        integral_val = np.trapz(C_t_values, t_grid)\n\n        # Step 5: Calculate the dimensional shear viscosity (eta)\n        prefactor = V_m3 / (KB_SI * T_K)\n        eta_pascal_seconds = prefactor * integral_val\n\n        # Step 6: Nondimensionalize the viscosity\n        # Characteristic viscosity unit in LJ system\n        eta_lj_unit = np.sqrt(MASS_SI * EPSILON_SI) / (SIGMA_SI**2)\n        eta_star = eta_pascal_seconds / eta_lj_unit\n        \n        all_results.append([eta_pascal_seconds, eta_star])\n\n    # Final print statement in the exact required format.\n    # The format [ [...] , [...] ] is achieved by using the default list-to-string conversion.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何从已知的相关函数计算输运系数后，下一个关键问题是如何通过模拟获得可靠的相关函数。本练习引导您像一名经验丰富的实践者一样思考，为分子动力学模拟选择合适的参数，例如总运行时长 $T_{\\mathrm{run}}$、采样时间间隔 $\\Delta t$ 和温控器弛豫时间 $\\tau_T$。正确地做出这些选择，是最小化格林-久保计算中统计误差和系统误差，并最终获得收敛结果的核心。",
            "id": "3813722",
            "problem": "一位研究人员计划使用Green-Kubo (GK) 关系式计算一种三维材料的输运系数，该关系式将输运系数表示为一个平衡态通量自相关函数的时间积分。该模拟将通过分子动力学 (MD) 进行。设稳态平衡通量用 $J(t)$ 表示，其自相关用 $C_{JJ}(t)=\\langle J(0)J(t)\\rangle$ 表示，其中 $\\langle \\cdot \\rangle$ 是平衡系综平均。假设 $C_{JJ}(t)$ 在 $t$ 很大时会衰减至零，其方式是在微观时间尺度上初始衰减很快，并且可能表现出流体动力学长时尾。将特征（积分）关联时间 $\\tau_c$ 定义为这样一个最小时间：当 $t\\tau_c$ 时，对时间积分的贡献与目标精度相比很小。并令 $\\omega_{\\max}$ 表示与材料中最快通量涨落相关的最大物理相关角频率（例如，最高声子频率或碰撞频率）。用 $\\Delta t$ 表示 MD 采样间隔，用 $T_{\\mathrm{run}}$ 表示用于数据收集的总轨迹长度，如果使用了恒温器，则用 $\\tau_T$ 表示恒温器弛豫时间。\n\n根据平衡态统计力学，GK 估计量涉及在一个适当的平衡系综中的时间关联。估算的输运系数的收敛性受以下因素控制：(i) 从间隔为 $\\Delta t$ 的样本数值近似计算 $C_{JJ}(t)$ 的时间积分时产生的离散化误差；(ii) 在有限的 $t_{\\max}$ 处截断积分所产生的截断误差；以及 (iii) 随独立关联样本有效数量（其与 $T_{\\mathrm{run}}/\\tau_c$ 成比例）增加而减小的统计误差。如果耦合太强，恒温器的选择可能会影响采样的平衡分布和动力学关联。\n\n对于一个通用的材料体系，下列哪几组标准在物理上是合理的，并且足以在平衡数值精度和统计效率的同时获得收敛的 GK 输运系数？选择所有适用的选项。\n\nA. 选择远小于最快通量时间尺度和关联时间的 $\\Delta t$，具体来说 $\\Delta t \\ll \\min\\!\\big(\\pi/\\omega_{\\max},\\,\\tau_c\\big)$，以便分辨出 $C_{JJ}(t)$ 的短时结构且数值积分准确。确保轨迹长度满足 $T_{\\mathrm{run}} \\gtrsim 100\\,\\tau_c$，以便时间积分的统计不确定性与 $O\\!\\big(\\sqrt{\\tau_c/T_{\\mathrm{run}}}\\big)$ 成比例并且很小。使用微正则动力学（粒子数、体积、能量恒定；NVE）或 $\\tau_T \\gg \\tau_c$ 的弱耦合正则恒温器（粒子数、体积、温度恒定；NVT），以便在对通量动力学扰动最小的情况下对平衡分布进行采样，并在 $C_{JJ}(t)$ 已衰减到噪声范围内的最小 $t_{\\max}$ 处截断积分。\n\nB. 选择 $\\Delta t \\approx \\tau_c$ 以减少数据存储，同时仍覆盖衰减窗口；取 $T_{\\mathrm{run}} \\approx 5\\,\\tau_c$ 以避免不必要的长时运行；并应用 $\\tau_T \\approx \\tau_c/10$ 的强耦合速度标度恒温器，在数据收集期间严格控制温度；在 $t_{\\max}=\\tau_c$ 处截断积分。\n\nC. 选择 $\\Delta t$ 使得奈奎斯特频率等于最快通量频率，即 $\\Delta t = \\pi/\\omega_{\\max}$；取 $T_{\\mathrm{run}}=\\tau_c$；并用一个小的非平衡梯度代替平衡采样以加速收敛；从在梯度下测量的时间关联来估计系数，因为在线性响应极限下可以恢复平衡积分。\n\nD. 在恒温器下进行平衡，然后切换到微正则动力学 (NVE) 进行数据收集。选择 $\\Delta t \\ll \\pi/\\omega_{\\max}$ 以便离散化的 $C_{JJ}(t)$ 能够捕捉到正确的短时曲率，并取 $T_{\\mathrm{run}} \\gg \\tau_c$ 以便有效独立样本数 $T_{\\mathrm{run}}/\\tau_c$ 很大。使用分块平均法来评估时间积分的统计收敛性，并通过在截断前将超出噪声基底的 $C_{JJ}(t)$ 拟合到一个有理论依据的长时形式来处理任何缓慢的流体动力学尾。\n\nE. 在测量过程中使用具有大摩擦力的随机朗之万恒温器来抑制 $J(t)$ 中的高频噪声，设置 $\\Delta t  \\tau_c$ 以最小化连续样本间的序列相关性，并且只对 $C_{JJ}(t)$ 积分到 $t_{\\max}=\\tau_c$ 以避免长时尾的污染。",
            "solution": "选项A和D描述了进行格林-久保（GK）计算的有效且严谨的最佳实践方法。选项B、C和E包含严重的方法学错误。\n\n- **选项A和D是正确的**：\n  - **采样间隔 $\\Delta t$**：必须远小于系统中最快的时间尺度（由最高频率 $\\omega_{\\max}$ 决定）和关联时间 $\\tau_c$，即 $\\Delta t \\ll \\pi/\\omega_{\\max}$。这确保了能够精确地解析关联函数的短时行为，并使数值积分的离散化误差足够小。\n  - **模拟总时长 $T_{\\mathrm{run}}$**：必须远大于关联时间 $\\tau_c$（例如，$T_{\\mathrm{run}} \\gg \\tau_c$）。这是为了获得足够多的统计独立的数据块（有效数量约为 $T_{\\mathrm{run}}/\\tau_c$），从而减小最终计算结果的统计误差。\n  - **系综选择**：GK理论严格建立在孤立系统（微正则系综，NVE）的基础上。因此，最理想的做法是在NVE系综中进行数据采集（如D所述）。如果必须使用正则系综（NVT），恒温器必须是弱耦合的（即恒温器弛豫时间 $\\tau_T \\gg \\tau_c$），以最大限度地减少对系统自然动力学的干扰（如A所述）。\n  - **积分截断和误差分析**：积分应在关联函数衰减到噪声水平时截断。对于存在长时尾的情况，通过拟合理论形式来处理可以提高精度。使用分块平均法是评估统计收敛性的标准方法（如D所述）。\n\n- **选项B是错误的**：\n  - $\\Delta t \\approx \\tau_c$ 的采样间隔过大，无法解析关联函数的衰减过程。\n  - $T_{\\mathrm{run}} \\approx 5\\tau_c$ 的模拟时间太短，会导致巨大的统计误差。\n  - $\\tau_T \\approx \\tau_c/10$ 的强耦合恒温器会严重干扰系统动力学，破坏GK计算的基础。\n\n- **选项C是错误的**：\n  - 此选项混淆了平衡态（GK）方法和非平衡分子动力学（NEMD）方法。NEMD通过施加外部梯度并测量响应来计算输运系数，而不是计算平衡态的时间关联函数。\n\n- **选项E是错误的**：\n  - 强摩擦力的朗之万恒温器会完全改变系统的动力学行为。\n  - $\\Delta t > \\tau_c$ 的采样间隔使得无法计算关联函数本身。\n  - 仅积分到 $t_{\\max} = \\tau_c$ 会导致系统性的截断误差。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "在前两项实践的基础上，我们可以从简单的稳态输运系数计算，进展到提取更丰富的、依赖于频率的材料属性。本练习将重点转向粘弹性，这是高熵合金等复杂流体的一个关键力学行为。您将通过对相关函数进行傅里叶变换，来计算复数粘度 $\\eta(\\omega)$，从而揭示材料在不同时间尺度下的响应特性。",
            "id": "3744370",
            "problem": "您的任务是为代表接近结晶线的液态高熵合金（HEA）的合成应力自相关函数，实现一种基于第一性原理的数值方法，用于提取粘弹性弛豫谱及相关的频率依赖性粘度。您的程序必须使用基于线性响应理论和涨落-耗散框架的第一性原理方法，而不调用任何预先指定的目标公式。\n\n使用的基本原理包括以下已获科学验证的原则：\n- 将小振幅剪切扰动与应力响应联系起来的线性响应理论。\n- 将平衡涨落与输运系数关联的涨落-耗散定理。\n- 平衡态下非对角应力分量的应力自相关定义。\n- 复数频率依赖性粘度源于因果时间卷积，并在平衡条件下通过傅里叶-拉普拉斯变换与应力自相关相联系的概念。\n- 用于计算输运系数的 Green-Kubo 框架，即通过对平衡自相关函数进行时间积分来得到宏观系数。\n\n对于每个测试用例，您的程序必须按以下步骤执行：\n1. 使用测试套件中指定的模型和参数，为应力自相关函数 $C(t_i)$ 在 $t_i = i\\,\\Delta t$（其中 $i = 0, 1, \\dots, N-1$）处构建一个离散时间序列。该自相关函数将根据以下参数化形式之一构建：\n   - 弛豫模式的 Maxwell 谱：一个衰减指数的有限和 $C(t) = \\sum_{j=1}^{M} G_j \\exp\\!\\left(-t/\\tau_j\\right)$，其中 $G_j \\ge 0$ 是模式强度，$\\tau_j  0$ 是弛豫时间。\n   - 拉伸指数形式 $C(t) = G \\exp\\!\\left(-(t/\\tau_0)^\\beta\\right)$，其中 $G \\ge 0$，$\\tau_0  0$，且 $0  \\beta  1$ 用于捕捉宽弛豫谱。\n\n2. 通过求解 $C(t)$ 的约束最小二乘近似，估算一个在弛豫时间 $\\{\\tau_k\\}_{k=1}^{K}$ 的对数间隔网格上的非负粘弹性弛豫谱 $S(\\tau)$。该近似使用表示式 $C(t) \\approx \\sum_{k=1}^{K} S(\\tau_k) \\exp\\!\\left(-t/\\tau_k\\right)$，并满足 $S(\\tau_k) \\ge 0$ 的约束。该谱应使用非负最小二乘法进行估算，且网格 $\\{\\tau_k\\}$ 必须覆盖一个物理相关的、包含由 $\\Delta t$ 和 $N$ 定义的采样窗口的数量级范围。\n\n3. 根据 Green-Kubo 框架，通过对自相关函数进行时间上的数值积分来计算零频（稳态）粘度，并以帕斯卡-秒（Pa·s）为单位表示最终答案。数值积分必须在可用的时间窗口内使用适当的求积法则进行。\n\n4. 在两个指定的角频率 $\\omega_1$ 和 $\\omega_2$（单位为弧度每秒）下，通过对可用时间窗口内的 $C(t)$ 进行因果傅里叶-拉普拉斯变换的数值计算，来计算复数频率依赖性粘度。报告这两个频率下粘度的实部和虚部，单位为帕斯卡-秒（Pa·s）。角度单位是弧度。\n\n5. 将每个测试用例的结果汇总为一个包含五个十进制数的列表，单位为帕斯卡-秒（Pa·s），顺序为：$[\\eta_0, \\operatorname{Re}\\,\\eta(\\omega_1), \\operatorname{Im}\\,\\eta(\\omega_1), \\operatorname{Re}\\,\\eta(\\omega_2), \\operatorname{Im}\\,\\eta(\\omega_2)]$。\n\n测试套件和参数：\n- 物理常数和单位：\n  - 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ 焦耳每开尔文（J/K）。\n  - 所有应力单位为帕斯卡（$\\mathrm{Pa}$），时间单位为秒（$\\mathrm{s}$），体积单位为立方米（$\\mathrm{m}^3$），温度单位为开尔文（$\\mathrm{K}$），角频率单位为弧度每秒。\n\n- 测试用例 A（正常路径，单一 Maxwell 模式）：\n  - 温度 $T = 1800$。\n  - 体积 $V = 10^{-6}$。\n  - 时间步长 $\\Delta t = 10^{-11}$。\n  - 样本数 $N = 5000$。\n  - 角频率 $\\omega_1 = 10^{9}$ 和 $\\omega_2 = 5\\times 10^{10}$。\n  - 自相关模型：Maxwell 模型，含一个模式 $G_1 = 10^{-6}$ 和 $\\tau_1 = 2\\times 10^{-11}$。\n\n- 测试用例 B（多模式，宽分离时间尺度）：\n  - 温度 $T = 1800$。\n  - 体积 $V = 10^{-6}$。\n  - 时间步长 $\\Delta t = 10^{-11}$。\n  - 样本数 $N = 8000$。\n  - 角频率 $\\omega_1 = 5\\times 10^{8}$ 和 $\\omega_2 = 10^{10}$。\n  - 自相关模型：Maxwell 模型，含两个模式 $G_1 = 10^{-6}$，$\\tau_1 = 5\\times 10^{-12}$ 和 $G_2 = 4\\times 10^{-7}$，$\\tau_2 = 5\\times 10^{-10}$。\n\n- 测试用例 C（边缘情况，通过拉伸指数实现的宽弛豫）：\n  - 温度 $T = 1800$。\n  - 体积 $V = 10^{-6}$。\n  - 时间步长 $\\Delta t = 10^{-11}$。\n  - 样本数 $N = 5000$。\n  - 角频率 $\\omega_1 = 5\\times 10^{8}$ 和 $\\omega_2 = 10^{10}$。\n  - 自相关模型：拉伸指数模型，参数为 $G = 1.88\\times 10^{-8}$，$\\tau_0 = 2\\times 10^{-9}$ 和 $\\beta = 0.4$。\n\n算法和数值要求：\n- 非负最小二乘拟合必须在一个对数间隔的网格 $\\{\\tau_k\\}$ 上计算，该网格至少跨越从 $10^{-12}$ 秒到 $10^{-8}$ 秒的范围，并包含至少 $K = 60$ 个点。\n- 数值时间积分和变换必须在采样窗口上使用稳定的求积法进行计算；应使用适合有限区间上平滑衰减的方法。\n- 最终的粘度值必须以帕斯卡-秒（Pa·s）表示。每个报告的数字都必须是十进制浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例按指定顺序贡献一个子列表。例如：\"[[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n,o]]\"。",
            "solution": "该问题陈述是计算材料物理学中一个有效、适定且有科学依据的练习。它要求实现一种基于格林-久保关系的数值方法，以计算代表高熵合金的模型体系的粘弹性。格林-久保关系是统计力学的基石之一。该问题提供了所有必要的物理参数、模型定义和数值约束，从而可以获得唯一且可验证的解。\n\n该问题的理论基础在于线性响应理论和涨落-耗散定理。剪切粘度是一个宏观输运系数，它可以与应力张量非对角分量在平衡态下的涨落的时间积分相关联。零频（或稳态）剪切粘度 $\\eta_0$ 由格林-久保公式给出：\n$$ \\eta_0 = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\, dt $$\n其中 $V$ 是系统体积，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$C(t)$ 是应力-应力自相关函数（SSACF），对于非对角分量 $\\alpha\\beta$（例如 $xy$），定义为 $C(t) = \\langle \\sigma_{\\alpha\\beta}(0) \\sigma_{\\alpha\\beta}(t) \\rangle$。为确保量纲一致性，SSACF 振幅参数 $G_j$ 和 $G$ 的单位是压力的平方，即 $\\mathrm{Pa}^2$，这导致粘度单位为 $\\mathrm{Pa \\cdot s}$。\n\n频率依赖的复数粘度 $\\eta(\\omega)$ 是通过对同一自相关函数进行因果傅里叶-拉普拉斯变换得到的：\n$$ \\eta(\\omega) = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) e^{-i\\omega t} \\, dt $$\n因此，$\\eta(\\omega)$ 的实部和虚部分别为：\n$$ \\operatorname{Re}\\,\\eta(\\omega) = \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\cos(\\omega t) \\, dt $$\n$$ \\operatorname{Im}\\,\\eta(\\omega) = - \\frac{V}{k_{\\mathrm{B}} T} \\int_0^\\infty C(t) \\sin(\\omega t) \\, dt $$\n我们将按照问题中概述的步骤顺序实现一个数值解。\n\n**第 1 步：构建应力自相关函数 $C(t)$**\n对于每个测试用例，我们为 $t_i = i \\Delta t$（其中 $i = 0, 1, \\dots, N-1$）生成一个离散时间序列 $C(t_i)$。$C(t)$ 的函数形式由 Maxwell 模式之和或拉伸指数给出。\n\n**第 2 步：估算粘弹性弛豫谱 $S(\\tau)$**\n问题要求通过求解约束最小二乘问题来估算非负弛豫谱 $S(\\tau)$，该问题近似于连续弛豫谱积分：\n$$ C(t) = \\int_0^\\infty S(\\tau) e^{-t/\\tau} \\, d\\tau \\approx \\sum_{k=1}^{K} S(\\tau_k) e^{-t/\\tau_k} $$\n这是一个线性逆问题，我们针对采样时间 $t_i$ 和选定的弛豫时间网格 $\\tau_k$ 对其进行离散化。设 $\\mathbf{c}$ 是 $C(t_i)$ 值的向量，$\\mathbf{s}$ 是未知谱权重 $S(\\tau_k)$ 的向量，$\\mathbf{A}$ 是元素为 $A_{ik} = \\exp(-t_i/\\tau_k)$ 的矩阵。我们必须在所有 $k$ 满足 $s_k \\ge 0$ 的约束下求解系统 $\\mathbf{A}\\mathbf{s} \\approx \\mathbf{c}$。这可以通过使用非负最小二乘（NNLS）算法来实现，该算法找到最小化 $\\|\\mathbf{A}\\mathbf{s} - \\mathbf{c}\\|_2^2$ 的向量 $\\mathbf{s}$。此步骤按要求执行，但其结果不用于最终的粘度计算，最终计算直接基于所提供的 $C(t)$ 的解析形式。弛豫时间网格 $\\{\\tau_k\\}$ 被指定为在 $10^{-12} \\, \\mathrm{s}$ 到 $10^{-8} \\, \\mathrm{s}$ 范围内对数间隔的 $K=60$ 个点。\n\n**第 3 步：计算零频粘度 $\\eta_0$**\n$\\eta_0$ 的积分在可用时间窗口 $[0, (N-1)\\Delta t]$ 内进行数值计算。由于所提供的时间序列是离散且均匀采样的，梯形法则是一种简单、稳定且合适的求积方法。因此，积分可近似为：\n$$ \\int_0^{t_{\\text{max}}} C(t) \\, dt \\approx \\sum_{i=0}^{N-2} \\frac{C(t_i) + C(t_{i+1})}{2} \\Delta t $$\n然后将该数值积分乘以预因子 $\\frac{V}{k_{\\mathrm{B}} T}$ 以获得 $\\eta_0$。\n\n**第 4 步：计算复数粘度 $\\eta(\\omega)$**\n类似地，计算 $\\operatorname{Re}\\,\\eta(\\omega)$ 和 $\\operatorname{Im}\\,\\eta(\\omega)$ 所需的傅里叶余弦和正弦变换也使用梯形法则计算。被积函数分别为 $C(t) \\cos(\\omega t)$ 和 $C(t) \\sin(\\omega t)$。数值计算是针对指定的频率 $\\omega_1$ 和 $\\omega_2$进行的。\n$$ \\operatorname{Re}\\,\\eta(\\omega) \\approx \\frac{V}{k_{\\mathrm{B}} T} \\times \\text{trapz}(C(t_i) \\cos(\\omega t_i), t_i) $$\n$$ \\operatorname{Im}\\,\\eta(\\omega) \\approx - \\frac{V}{k_{\\mathrm{B}} T} \\times \\text{trapz}(C(t_i) \\sin(\\omega t_i), t_i) $$\n\n**第 5 步：汇总和报告结果**\n每个测试用例的计算值——$\\eta_0$、$\\operatorname{Re}\\,\\eta(\\omega_1)$、$\\operatorname{Im}\\,\\eta(\\omega_1)$、$\\operatorname{Re}\\,\\eta(\\omega_2)$ 和 $\\operatorname{Im}\\,\\eta(\\omega_2)$——被收集并格式化为指定的列表的列表结构。所有计算均使用 SI 基本单位进行，最终粘度以 $\\mathrm{Pa \\cdot s}$ 报告。\n\n实现过程将通过迭代每个测试用例，执行这五个步骤，并按要求整理最终的数值结果来完成。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the viscoelasticity problem for the given test cases.\n    \"\"\"\n    # Physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Test suite definition\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 5000,\n            \"omegas\": [1.0e9, 5.0e10],\n            \"model\": \"maxwell\",\n            \"params\": {\"modes\": [(1.0e-6, 2.0e-11)]}\n        },\n        {\n            \"name\": \"Case B\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 8000,\n            \"omegas\": [5.0e8, 1.0e10],\n            \"model\": \"maxwell\",\n            \"params\": {\"modes\": [(1.0e-6, 5.0e-12), (4.0e-7, 5.0e-10)]}\n        },\n        {\n            \"name\": \"Case C\",\n            \"T\": 1800.0,\n            \"V\": 1.0e-6,\n            \"dt\": 1.0e-11,\n            \"N\": 5000,\n            \"omegas\": [5.0e8, 1.0e10],\n            \"model\": \"stretched_exp\",\n            \"params\": {\"G\": 1.88e-8, \"tau0\": 2.0e-9, \"beta\": 0.4}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        T = case[\"T\"]\n        V = case[\"V\"]\n        dt = case[\"dt\"]\n        N = case[\"N\"]\n        omega1, omega2 = case[\"omegas\"]\n        model = case[\"model\"]\n        params = case[\"params\"]\n\n        # Step 1: Construct the stress autocorrelation function C(t)\n        t = np.arange(N) * dt\n\n        if model == \"maxwell\":\n            C_t = np.zeros_like(t, dtype=float)\n            for G_j, tau_j in params[\"modes\"]:\n                C_t += G_j * np.exp(-t / tau_j)\n        elif model == \"stretched_exp\":\n            G = params[\"G\"]\n            tau0 = params[\"tau0\"]\n            beta = params[\"beta\"]\n            # To avoid division by zero or NaN at t=0 when tau0 is very small\n            # we handle t=0 separately. (t/tau0)**beta for t=0 is 0.\n            # np.power correctly handles 0**positive_power = 0.\n            # However, to be safe against potential floating point issues.\n            C_t = G * np.exp(-np.power(t / tau0, beta, where=t0, out=np.zeros_like(t, dtype=float)))\n        \n        # Step 2: Estimate the viscoelastic relaxation spectrum S(tau) via NNLS\n        # This step is performed as required, but its output is not used for viscosity calculations.\n        K = 60\n        tau_k = np.logspace(-12, -8, K)\n        # Construct the matrix A for the least squares problem\n        # A_ik = exp(-t_i / tau_k)\n        A = np.exp(-t[:, np.newaxis] / tau_k[np.newaxis, :])\n        \n        # Solve the non-negative least squares problem\n        S_tau_k, _ = nnls(A, C_t)\n\n        # Step 3  4: Compute viscosities using numerical integration on C(t)\n        prefactor = V / (K_B * T)\n\n        # Compute zero-frequency viscosity eta_0\n        eta_0 = prefactor * np.trapz(C_t, t)\n\n        # Compute complex viscosity at omega_1 and omega_2\n        omegas = [omega1, omega2]\n        case_results = [eta_0]\n        \n        for omega in omegas:\n            # Integrand for Real part: C(t) * cos(omega*t)\n            integrand_real = C_t * np.cos(omega * t)\n            re_eta = prefactor * np.trapz(integrand_real, t)\n            \n            # Integrand for Imaginary part: C(t) * sin(omega*t)\n            integrand_imag = C_t * np.sin(omega * t)\n            # Note the negative sign in the formula for Im(eta)\n            im_eta = -prefactor * np.trapz(integrand_imag, t)\n            \n            case_results.extend([re_eta, im_eta])\n\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format\n    # Example format: [[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n,o]]\n    formatted_results = f\"[{','.join([f'[{\",\".join(map(str, res))}]' for res in all_results])}]\"\n    print(formatted_results)\n\nsolve()\n```"
        }
    ]
}