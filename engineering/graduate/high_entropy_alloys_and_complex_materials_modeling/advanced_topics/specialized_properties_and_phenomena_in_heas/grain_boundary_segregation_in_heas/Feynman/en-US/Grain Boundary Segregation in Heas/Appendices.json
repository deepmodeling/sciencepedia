{
    "hands_on_practices": [
        {
            "introduction": "The driving force for an atom to segregate to a grain boundary is not a single phenomenon but a combination of factors. This practice explores the two primary drivers: the chemical preference for the unique bonding environment at the boundary and the elastic relief gained by placing a misfit atom in a distorted region. By calculating the critical stress at which these two effects have equal magnitude, you will develop a quantitative feel for the competition that governs segregation behavior in mechanically stressed materials. ",
            "id": "3743998",
            "problem": "In a substitutional solute segregation problem at a grain boundary in High-Entropy Alloys (HEAs), the segregation enthalpy per solute atom is decomposed into a chemical term and an elastic term as follows: $\\Delta E_{\\mathrm{seg}} = \\Delta E_{\\mathrm{chem}} + \\Delta E_{\\mathrm{el}}$. Consider a single solute species $X$ in an equiatomic face-centered cubic HEA matrix segregating to a symmetric tilt Grain Boundary (GB). The chemical term $\\Delta E_{\\mathrm{chem}}$ reflects the bonding preference of $X$ for the GB environment relative to the bulk lattice and is taken as independent of stress. The elastic term $\\Delta E_{\\mathrm{el}}$ arises from the interaction of the solute’s relaxation volume with the local hydrostatic stress field at the GB.\n\nStarting from the fundamental result that the energy of a point defect of relaxation volume $\\Delta V$ under hydrostatic pressure $p$ (taken positive in compression) is $\\Delta E_{\\mathrm{el}} = - p \\, \\Delta V$, derive an expression for the hydrostatic stress magnitude $p^{\\star}$ at which the elastic and chemical drivers have equal magnitude, i.e., $|\\Delta E_{\\mathrm{chem}}| = |\\Delta E_{\\mathrm{el}}|$. Then evaluate $p^{\\star}$ numerically for a solute with $\\Delta E_{\\mathrm{chem}} = -0.08 \\ \\mathrm{eV}$ (from Density Functional Theory (DFT) binding calculations) and $\\Delta V = +2.0 \\ \\mathrm{\\AA}^{3}$. In your reasoning, clearly state the inequalities defining the chemical-dominated and elastic-dominated regimes in terms of $|p|$ relative to $p^{\\star}$.\n\nExpress the final $p^{\\star}$ in $\\mathrm{GPa}$ and round your answer to three significant figures.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of materials science and continuum mechanics, well-posed with sufficient information for a unique solution, and expressed in objective, formal language. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe problem requires the derivation and calculation of a critical hydrostatic pressure magnitude, denoted as $p^{\\star}$, at which the elastic and chemical contributions to the solute segregation enthalpy have equal magnitude.\n\nThe segregation enthalpy, $\\Delta E_{\\mathrm{seg}}$, is given as the sum of a chemical term, $\\Delta E_{\\mathrm{chem}}$, and an elastic term, $\\Delta E_{\\mathrm{el}}$:\n$$ \\Delta E_{\\mathrm{seg}} = \\Delta E_{\\mathrm{chem}} + \\Delta E_{\\mathrm{el}} $$\nThe elastic energy contribution is defined as the interaction between the solute's relaxation volume, $\\Delta V$, and the local hydrostatic pressure, $p$. The fundamental relation is given as:\n$$ \\Delta E_{\\mathrm{el}} = -p \\, \\Delta V $$\nHere, pressure $p$ is defined as positive in compression. A positive relaxation volume ($\\Delta V  0$) under compressive pressure ($p  0$) results in a negative (favorable) elastic energy, as expected.\n\nThe core condition of the problem is that the magnitudes of the chemical and elastic drivers are equal. We express this as:\n$$ |\\Delta E_{\\mathrm{chem}}| = |\\Delta E_{\\mathrm{el}}| $$\nSubstituting the expression for $\\Delta E_{\\mathrm{el}}$, we obtain:\n$$ |\\Delta E_{\\mathrm{chem}}| = |-p \\, \\Delta V| $$\nUsing the property of absolute values, $|ab| = |a||b|$, this becomes:\n$$ |\\Delta E_{\\mathrm{chem}}| = |p| \\, |\\Delta V| $$\nThe problem asks for the hydrostatic stress magnitude $p^{\\star}$. This corresponds to the value of $|p|$ that satisfies the condition. Therefore, we can write:\n$$ p^{\\star} = |p| = \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|} $$\nThis is the symbolic expression for the critical pressure magnitude $p^{\\star}$.\n\nNext, we evaluate this expression numerically using the provided data:\n$\\Delta E_{\\mathrm{chem}} = -0.08 \\ \\mathrm{eV}$\n$\\Delta V = +2.0 \\ \\mathrm{\\AA}^{3}$\n\nFirst, we determine the magnitudes of these quantities:\n$|\\Delta E_{\\mathrm{chem}}| = |-0.08 \\ \\mathrm{eV}| = 0.08 \\ \\mathrm{eV}$\n$|\\Delta V| = |+2.0 \\ \\mathrm{\\AA}^{3}| = 2.0 \\ \\mathrm{\\AA}^{3}$\n\nTo calculate the pressure $p^{\\star}$ in SI units (Pascals, $\\mathrm{Pa}$), we must convert the energy to Joules ($\\mathrm{J}$) and the volume to cubic meters ($\\mathrm{m}^3$). The unit of pressure, Pascal, is equivalent to $\\mathrm{N}/\\mathrm{m}^2$ or $\\mathrm{J}/\\mathrm{m}^3$.\n\nThe conversion factors are:\n$1 \\ \\mathrm{eV} \\approx 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$\n$1 \\ \\mathrm{\\AA} = 10^{-10} \\ \\mathrm{m}$, which implies $1 \\ \\mathrm{\\AA}^{3} = (10^{-10} \\ \\mathrm{m})^3 = 10^{-30} \\ \\mathrm{m}^3$.\n\nApplying these conversions:\n$$ |\\Delta E_{\\mathrm{chem}}| = 0.08 \\ \\mathrm{eV} \\times (1.602176634 \\times 10^{-19} \\ \\mathrm{J}/\\mathrm{eV}) \\approx 1.28174 \\times 10^{-20} \\ \\mathrm{J} $$\n$$ |\\Delta V| = 2.0 \\ \\mathrm{\\AA}^3 \\times (10^{-30} \\ \\mathrm{m}^3/\\mathrm{\\AA}^3) = 2.0 \\times 10^{-30} \\ \\mathrm{m}^3 $$\n\nNow, we can calculate $p^{\\star}$:\n$$ p^{\\star} = \\frac{1.28174 \\times 10^{-20} \\ \\mathrm{J}}{2.0 \\times 10^{-30} \\ \\mathrm{m}^3} = 0.64087 \\times 10^{10} \\ \\frac{\\mathrm{J}}{\\mathrm{m}^3} = 6.4087 \\times 10^9 \\ \\mathrm{Pa} $$\nThe problem asks for the answer in gigapascals ($\\mathrm{GPa}$), where $1 \\ \\mathrm{GPa} = 10^9 \\ \\mathrm{Pa}$.\n$$ p^{\\star} = 6.4087 \\ \\mathrm{GPa} $$\nRounding to three significant figures, we get:\n$$ p^{\\star} \\approx 6.41 \\ \\mathrm{GPa} $$\n\nFinally, we define the chemical-dominated and elastic-dominated regimes based on the relative magnitudes of the energy terms. The segregation is:\n- **Chemical-dominated** when $|\\Delta E_{\\mathrm{chem}}|  |\\Delta E_{\\mathrm{el}}|$. Substituting $|\\Delta E_{\\mathrm{el}}| = |p||\\Delta V|$, this inequality becomes $|\\Delta E_{\\mathrm{chem}}|  |p||\\Delta V|$. Rearranging gives $|p|  \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|}$, which is $|p|  p^{\\star}$.\n- **Elastic-dominated** when $|\\Delta E_{\\mathrm{el}}|  |\\Delta E_{\\mathrm{chem}}|$. This inequality becomes $|p||\\Delta V|  |\\Delta E_{\\mathrm{chem}}|$, which rearranges to $|p|  \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|}$, or $|p|  p^{\\star}$.\n\nIn summary, for local hydrostatic pressure magnitudes $|p|$ less than $p^{\\star}$, the chemical bonding preference dictates segregation behavior. For magnitudes greater than $p^{\\star}$, the mechanical interaction between the solute and the local stress field becomes the dominant driving force.",
            "answer": "$$\n\\boxed{6.41}\n$$"
        },
        {
            "introduction": "Building on the concept of segregation energy, we now examine how this energy depends critically on the local atomic geometry of the grain boundary site. This exercise utilizes the Cluster Expansion (CE) formalism, a cornerstone of computational materials science, to model how the energy of a site changes based on its specific arrangement of neighboring atoms. By comparing two different grain boundary structures, you will see how atomistic modeling can rationalize and predict structure-sensitive segregation, a key feature of complex interfaces. ",
            "id": "3744032",
            "problem": "Consider a high-entropy alloy (HEA) comprising five elements in equiatomic proportion on a face-centered cubic (FCC) lattice. Focus on the segregation of a single distinguished species, hereafter called species $A$, to a grain boundary (GB). Model the configurational energy with the cluster expansion (CE), truncated to a single-site point cluster and two distinct pair-cluster orbits that are sensitive to local GB geometry: an in-plane short pair orbit $\\alpha$ and a cross-boundary longer pair orbit $\\beta$. Let the effective cluster interactions (ECIs) for these clusters be $J_{\\mathrm{p}}$, $J_{\\alpha}$, and $J_{\\beta}$, respectively. Assume the following values: $J_{\\mathrm{p}} = -0.035\\,\\mathrm{eV}$, $J_{\\alpha} = 0.020\\,\\mathrm{eV}$, and $J_{\\beta} = -0.015\\,\\mathrm{eV}$. The equiatomic composition gives a bulk mole fraction $c_{A} = 0.20$.\n\nRepresent species occupancy on the underlying lattice by an Ising-like variable $\\sigma_{i} \\in \\{+1,-1\\}$, where $\\sigma_{i} = +1$ if site $i$ is occupied by species $A$ and $\\sigma_{i} = -1$ otherwise. Treat the environment outside the central site in a mean-field random-mixing approximation at the bulk composition, so that the neighbor spin expectation is $\\langle \\sigma \\rangle = 2 c_{A} - 1$. Consider two distinct GB structures, $\\mathrm{GB}_{1}$ and $\\mathrm{GB}_{2}$, that differ only in how many symmetry-equivalent pairs in each orbit couple the central site to its neighbors. Let the multiplicities for the central site be $m_{\\alpha}^{(1)} = 6$, $m_{\\beta}^{(1)} = 4$ for $\\mathrm{GB}_{1}$, and $m_{\\alpha}^{(2)} = 4$, $m_{\\beta}^{(2)} = 8$ for $\\mathrm{GB}_{2}$.\n\nDefine the segregation energy at a given GB as the energy change for flipping the central site from $\\sigma_{0} = -1$ (matrix species) to $\\sigma_{0} = +1$ (species $A$) while the surrounding environment remains at the bulk composition. Using only the CE truncated to the specified point and pair clusters, derive from first principles an analytical expression for the difference in segregation energies $\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2})$ in terms of the ECIs, multiplicities, and $\\langle \\sigma \\rangle$, and then evaluate it numerically for the data above. Express the final energy in electronvolts (eV) and round your answer to four significant figures.",
            "solution": "The problem asks for the difference in segregation energies, $\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2})$, for a species $A$ at two different grain boundary (GB) structures within a high-entropy alloy (HEA). The solution will be derived from the principles of the Cluster Expansion (CE) formalism under a mean-field approximation.\n\nFirst, we establish the theoretical framework. The configurational energy of the alloy is described by a CE Hamiltonian, truncated to the specified point and pair clusters. The occupancy of site $i$ is given by an Ising-like spin variable $\\sigma_i$, where $\\sigma_i = +1$ for species $A$ and $\\sigma_i = -1$ for any other species. The total energy $H$ of a configuration $\\{\\sigma_i\\}$ is a sum over all clusters in the system. The change in energy when the occupancy of a single site, the central site $0$, is altered depends only on the terms in the Hamiltonian that include $\\sigma_0$. These terms are the point-cluster energy at site $0$ and the pair-cluster energies for pairs connecting site $0$ to its neighbors.\n\nThe part of the total energy that depends on the state of site $0$ can be written as:\n$$E(\\sigma_0) = J_{\\mathrm{p}} \\sigma_0 + \\sum_{i \\in N(0)} E_{\\text{pair}}(\\sigma_0, \\sigma_i)$$\nwhere $J_{\\mathrm{p}}$ is the point-cluster effective cluster interaction (ECI), and the sum runs over all neighbors $i$ of the central site $0$. The problem specifies two types of pair interactions, $\\alpha$ and $\\beta$, with ECIs $J_{\\alpha}$ and $J_{\\beta}$, respectively. The number of neighbors connected by these pairs is given by the multiplicities $m_{\\alpha}$ and $m_{\\beta}$. Thus, we can write the energy associated with site $0$ as:\n$$E(\\sigma_0) = J_{\\mathrm{p}} \\sigma_0 + \\sigma_0 \\sum_{i=1}^{m_{\\alpha}} J_{\\alpha} \\sigma_i + \\sigma_0 \\sum_{j=1}^{m_{\\beta}} J_{\\beta} \\sigma_j$$\nThe problem states that the environment surrounding the central site is to be treated in a mean-field approximation. This means we replace the spin variables $\\sigma_i$ and $\\sigma_j$ of the neighboring sites with their thermal expectation value in the bulk, $\\langle \\sigma \\rangle$.\nThe mean-field energy expression for the central site becomes:\n$$E_{\\mathrm{MF}}(\\sigma_0) = J_{\\mathrm{p}} \\sigma_0 + m_{\\alpha} J_{\\alpha} \\sigma_0 \\langle \\sigma \\rangle + m_{\\beta} J_{\\beta} \\sigma_0 \\langle \\sigma \\rangle$$\nThis can be factored as:\n$$E_{\\mathrm{MF}}(\\sigma_0) = \\sigma_0 (J_{\\mathrm{p}} + m_{\\alpha} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta} J_{\\beta} \\langle \\sigma \\rangle)$$\nThe segregation energy, $\\Delta E_{\\mathrm{seg}}$, is defined as the energy change for flipping the central site from $\\sigma_0 = -1$ (occupied by a matrix atom) to $\\sigma_0 = +1$ (occupied by an $A$ atom).\n$$\\Delta E_{\\mathrm{seg}} = E_{\\mathrm{MF}}(\\sigma_0 = +1) - E_{\\mathrm{MF}}(\\sigma_0 = -1)$$\nSubstituting the expression for $E_{\\mathrm{MF}}(\\sigma_0)$:\n$$\\Delta E_{\\mathrm{seg}} = (+1) (J_{\\mathrm{p}} + m_{\\alpha} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta} J_{\\beta} \\langle \\sigma \\rangle) - (-1) (J_{\\mathrm{p}} + m_{\\alpha} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta} J_{\\beta} \\langle \\sigma \\rangle)$$\n$$\\Delta E_{\\mathrm{seg}} = 2 (J_{\\mathrm{p}} + m_{\\alpha} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta} J_{\\beta} \\langle \\sigma \\rangle)$$\nThis is the general expression for the segregation energy at a site with pair multiplicities $m_{\\alpha}$ and $m_{\\beta}$.\n\nNext, we apply this formula to the two specified grain boundaries, $\\mathrm{GB}_{1}$ and $\\mathrm{GB}_{2}$.\nFor $\\mathrm{GB}_{1}$, the multiplicities are $m_{\\alpha}^{(1)} = 6$ and $m_{\\beta}^{(1)} = 4$. The segregation energy is:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) = 2 (J_{\\mathrm{p}} + m_{\\alpha}^{(1)} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta}^{(1)} J_{\\beta} \\langle \\sigma \\rangle)$$\nFor $\\mathrm{GB}_{2}$, the multiplicities are $m_{\\alpha}^{(2)} = 4$ and $m_{\\beta}^{(2)} = 8$. The segregation energy is:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2 (J_{\\mathrm{p}} + m_{\\alpha}^{(2)} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta}^{(2)} J_{\\beta} \\langle \\sigma \\rangle)$$\nWe are asked to find the difference between these two segregation energies:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2 (J_{\\mathrm{p}} + m_{\\alpha}^{(1)} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta}^{(1)} J_{\\beta} \\langle \\sigma \\rangle) - 2 (J_{\\mathrm{p}} + m_{\\alpha}^{(2)} J_{\\alpha} \\langle \\sigma \\rangle + m_{\\beta}^{(2)} J_{\\beta} \\langle \\sigma \\rangle)$$\nThe point-cluster term $2 J_{\\mathrm{p}}$ cancels out:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2 \\langle \\sigma \\rangle (m_{\\alpha}^{(1)} J_{\\alpha} + m_{\\beta}^{(1)} J_{\\beta} - m_{\\alpha}^{(2)} J_{\\alpha} - m_{\\beta}^{(2)} J_{\\beta})$$\nGrouping terms by the ECIs, we arrive at the final analytical expression:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2 \\langle \\sigma \\rangle \\left[ (m_{\\alpha}^{(1)} - m_{\\alpha}^{(2)}) J_{\\alpha} + (m_{\\beta}^{(1)} - m_{\\beta}^{(2)}) J_{\\beta} \\right]$$\nNow, we evaluate this expression numerically using the provided data.\nFirst, we calculate the average spin $\\langle \\sigma \\rangle$ for the bulk composition. Given the bulk mole fraction of species $A$ is $c_{A} = 0.20$, the average spin is:\n$$\\langle \\sigma \\rangle = (+1) \\cdot c_{A} + (-1) \\cdot (1 - c_{A}) = 2 c_{A} - 1$$\n$$\\langle \\sigma \\rangle = 2(0.20) - 1 = 0.40 - 1 = -0.60$$\nThe differences in multiplicities are:\n$$m_{\\alpha}^{(1)} - m_{\\alpha}^{(2)} = 6 - 4 = 2$$\n$$m_{\\beta}^{(1)} - m_{\\beta}^{(2)} = 4 - 8 = -4$$\nThe ECIs are given as $J_{\\alpha} = 0.020\\,\\mathrm{eV}$ and $J_{\\beta} = -0.015\\,\\mathrm{eV}$.\nSubstituting all values into the derived expression for the energy difference:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2 (-0.60) \\left[ (2)(0.020\\,\\mathrm{eV}) + (-4)(-0.015\\,\\mathrm{eV}) \\right]$$\nWe calculate the term in the square brackets first:\n$$(2)(0.020\\,\\mathrm{eV}) = 0.040\\,\\mathrm{eV}$$\n$$(-4)(-0.015\\,\\mathrm{eV}) = 0.060\\,\\mathrm{eV}$$\nSumming these gives:\n$$0.040\\,\\mathrm{eV} + 0.060\\,\\mathrm{eV} = 0.100\\,\\mathrm{eV}$$\nFinally, we multiply by the prefactor $2 \\langle \\sigma \\rangle$:\n$$\\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{1}) - \\Delta E_{\\mathrm{seg}}(\\mathrm{GB}_{2}) = 2(-0.60)(0.100\\,\\mathrm{eV}) = -1.20(0.100\\,\\mathrm{eV}) = -0.120\\,\\mathrm{eV}$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the final numerical value is $-0.1200\\,\\mathrm{eV}$.",
            "answer": "$$\\boxed{-0.1200}$$"
        },
        {
            "introduction": "This final practice integrates the preceding concepts into a predictive computational model for equilibrium grain boundary composition in a multi-component alloy. Starting from first principles of statistical mechanics, you will implement a grand canonical model that accounts for competition between multiple segregating species and the availability of empty sites. This exercise goes beyond simple calculation to build a robust tool that also quantifies the sensitivity of the results to uncertainties in the input parameters, a crucial skill for practical materials modeling. ",
            "id": "3744018",
            "problem": "You are tasked with deriving, implementing, and testing a program that computes the Grain Boundary (GB) composition vector for a multicomponent High-Entropy Alloy (HEA), given per-species segregation energies, bulk chemical potentials, absolute temperature, and a finite GB site density. You must start from a principled statistical mechanics base and avoid any shortcut formulas. Your derivation must begin from the grand canonical ensemble for a non-interacting lattice gas with single-occupancy constraints and an explicit empty-site state. You must clearly articulate how to obtain the GB site partition function and the normalized per-site occupancy probabilities that define the GB composition vector. Additionally, you must quantify the sensitivity of the GB composition vector to uncertainties in the bulk chemical potentials.\n\nScientific base and requirements to use:\n- Begin from the grand canonical ensemble for a single GB site with mutually exclusive microstates: either empty or occupied by species $i$. The grand canonical probability of a microstate of energy $E$ with species-specific chemical potential $\\mu_i$ at absolute temperature $T$ is proportional to $\\exp\\left(\\beta \\left(\\mu_i N_i - E\\right)\\right)$, where $N_i$ is the number of particles of species $i$ in the microstate, $\\beta = 1/(k_{\\mathrm{B}} T)$, and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- Use a segregation energy $ \\epsilon_i $ to represent the energetic preference of species $i$ to occupy a GB site relative to a bulk reference, so that the energy contribution for occupying the site by species $i$ is shifted by $ \\epsilon_i $ in the GB.\n- Enforce the finite site capacity via a single-occupancy constraint and include an explicit empty state. The site partition function must include the empty state and all species-occupied states.\n- Define the GB composition vector $ \\boldsymbol{\\theta} = (\\theta_1, \\dots, \\theta_n) $ as the vector of probabilities that a GB site is occupied by species $i$, normalized over the empty state and all species. The sum of $ \\theta_i $ over species must be less than or equal to $ 1$, with the difference equal to the empty-site probability.\n- The finite site density $ s $ (in sites per square nanometer) scales the GB areal number density of species $i$ as $ \\gamma_i = s \\, \\theta_i $ (in sites per square nanometer).\n- To quantify sensitivity to the bulk chemical potentials, compute the Jacobian $ \\partial \\theta_i / \\partial \\mu_j $ and use first-order uncertainty propagation for independent chemical potential uncertainties $ \\sigma_{\\mu_j} $ to obtain an uncertainty estimate $ u_{\\theta_i} $.\n\nPhysical constants and units:\n- Use the Boltzmann constant $ k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5} $ electronvolts per kelvin (eV/K).\n- Segregation energies $ \\epsilon_i $ and chemical potentials $ \\mu_i $ are provided in electronvolts (eV).\n- Absolute temperature $ T $ is given in kelvin (K).\n- Site density $ s $ is given in sites per square nanometer.\n- All computed GB composition components $ \\theta_i $ are dimensionless.\n- All computed GB areal densities $ \\gamma_i $ must be reported in sites per square nanometer.\n- All uncertainty inputs $ \\sigma_{\\mu_i} $ and propagated outputs $ u_{\\theta_i} $ must be in electronvolts and dimensionless, respectively.\n- Express all floating-point outputs rounded to $ 6 $ decimal places. Do not use percentages; express fractional quantities as decimals.\n\nComputational tasks to implement:\n- For each test case, compute:\n  1. The GB composition vector $ \\boldsymbol{\\theta} $ using the grand canonical ensemble with single-occupancy and an explicit empty state.\n  2. The uncertainty vector $ \\boldsymbol{u}_{\\theta} $ obtained by first-order propagation from independent $ \\mu_i $ uncertainties $ \\sigma_{\\mu_i} $ using the Jacobian $ \\partial \\theta_i / \\partial \\mu_j $.\n  3. The GB areal density vector $ \\boldsymbol{\\gamma} $ where $ \\gamma_i = s \\, \\theta_i $ and the corresponding uncertainty vector $ \\boldsymbol{u}_{\\gamma} $ with $ u_{\\gamma_i} = s \\, u_{\\theta_i} $.\n- Implement numerically stable computation suitable for low and high $ T $ by using a log-sum-exp stabilization for the partition function normalization so that contributions from both the empty state and all species remain well-conditioned.\n\nTest suite:\nFor each case below, compute and report the required outputs. All inputs are listed as $(\\boldsymbol{\\epsilon}, \\boldsymbol{\\mu}, T, s, \\boldsymbol{\\sigma}_{\\mu})$ with units as specified above.\n\n- Case $ 1 $ (general multicomponent case):\n  - $ \\boldsymbol{\\epsilon} = [-0.20, -0.05, 0.00, 0.10] $\n  - $ \\boldsymbol{\\mu} = [-0.50, -0.55, -0.52, -0.51] $\n  - $ T = 1000 $\n  - $ s = 16.0 $\n  - $ \\boldsymbol{\\sigma}_{\\mu} = [0.03, 0.02, 0.02, 0.03] $\n- Case $ 2 $ (low temperature with a strongly segregating species):\n  - $ \\boldsymbol{\\epsilon} = [-0.50, 0.00, 0.05, 0.10] $\n  - $ \\boldsymbol{\\mu} = [-0.60, -0.60, -0.60, -0.60] $\n  - $ T = 300 $\n  - $ s = 12.0 $\n  - $ \\boldsymbol{\\sigma}_{\\mu} = [0.01, 0.01, 0.01, 0.01] $\n- Case $ 3 $ (high temperature, weak energetic preferences):\n  - $ \\boldsymbol{\\epsilon} = [-0.01, 0.00, 0.01, 0.02] $\n  - $ \\boldsymbol{\\mu} = [-0.50, -0.50, -0.50, -0.50] $\n  - $ T = 2000 $\n  - $ s = 20.0 $\n  - $ \\boldsymbol{\\sigma}_{\\mu} = [0.05, 0.05, 0.05, 0.05] $\n- Case $ 4 $ (heterogeneous bulk chemical potentials with one poorly known component):\n  - $ \\boldsymbol{\\epsilon} = [-0.10, -0.15, 0.05, -0.05] $\n  - $ \\boldsymbol{\\mu} = [-0.45, -0.60, -0.40, -0.55] $\n  - $ T = 800 $\n  - $ s = 18.0 $\n  - $ \\boldsymbol{\\sigma}_{\\mu} = [0.02, 0.08, 0.02, 0.02] $\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with no spaces.\n- Each case’s result must be a list containing $ 4 $ sublists in this order:\n  1. $ \\boldsymbol{\\theta} $ rounded to $ 6 $ decimal places.\n  2. $ \\boldsymbol{u}_{\\theta} $ rounded to $ 6 $ decimal places.\n  3. $ \\boldsymbol{\\gamma} $ rounded to $ 6 $ decimal places.\n  4. $ \\boldsymbol{u}_{\\gamma} $ rounded to $ 6 $ decimal places.\n- Therefore, the final output must have the structure: \n  $ [ [ [\\theta_1,\\dots,\\theta_n],[u_{\\theta_1},\\dots,u_{\\theta_n}],[\\gamma_1,\\dots,\\gamma_n],[u_{\\gamma_1},\\dots,u_{\\gamma_n}] ], \\dots ] $ across all test cases, printed on a single line with no spaces.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of statistical mechanics, specifically the grand canonical ensemble, as applied to surface/interface segregation phenomena. The problem is well-posed, providing all necessary physical constants, parameters, and a clear set of computational objectives. The language is objective and the definitions are precise and internally consistent. It does not violate any of the specified invalidity criteria. Therefore, a full solution is warranted.\n\nThe derivation of the grain boundary (GB) composition begins with the statistical mechanics of a single GB site in thermodynamic equilibrium with a bulk reservoir. The system is the GB site, and the reservoir is the bulk of the High-Entropy Alloy (HEA). We use the grand canonical ensemble, which is appropriate for a system that can exchange both energy and particles with a reservoir at constant temperature $T$ and chemical potentials $\\mu_i$.\n\nThe state of the single GB site is described by a set of mutually exclusive microstates: the site can either be empty (a vacancy) or occupied by an atom of one of the $n$ species in the alloy.\nLet the energy of an empty site be the reference energy, $E_0 = 0$.\nThe problem defines a segregation energy $\\epsilon_i$ for each species $i$. This represents the energy change when an atom of species $i$ moves from a bulk site to a GB site. Thus, the energy of a GB site occupied by species $i$ is $E_i = \\epsilon_i$.\n\nThe probability $P_\\nu$ of a system being in a microstate $\\nu$ with energy $E_\\nu$ and particle numbers $N_{k, \\nu}$ (for species $k$) is given by the grand canonical distribution:\n$$ P_\\nu = \\frac{1}{\\mathcal{Z}} \\exp\\left(-\\beta\\left(E_\\nu - \\sum_{k=1}^n N_{k, \\nu} \\mu_k\\right)\\right) $$\nwhere $\\beta = 1/(k_{\\mathrm{B}} T)$, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $\\mathcal{Z}$ is the grand partition function.\n\nThe statistical weight of each microstate is the term in the numerator.\nFor the empty site microstate, denoted $\\nu_0$, we have $E_0=0$ and $N_{k, 0}=0$ for all $k$. The statistical weight is:\n$$ w_0 = \\exp\\left(-\\beta\\left(0 - \\sum_{k=1}^n 0 \\cdot \\mu_k\\right)\\right) = \\exp(0) = 1 $$\nFor the microstate where the site is occupied by species $i$, denoted $\\nu_i$, we have $E_i = \\epsilon_i$, $N_{i, i}=1$, and $N_{k, i}=0$ for $k \\neq i$. The statistical weight is:\n$$ w_i = \\exp\\left(-\\beta\\left(\\epsilon_i - \\mu_i\\right)\\right) = \\exp\\left(\\beta(\\mu_i - \\epsilon_i)\\right) $$\n\nThe grand partition function $\\mathcal{Z}$ for the single site is the sum of the statistical weights of all possible microstates. Due to the single-occupancy constraint, these are the empty state and the $n$ occupied states:\n$$ \\mathcal{Z} = w_0 + \\sum_{i=1}^n w_i = 1 + \\sum_{i=1}^n \\exp\\left(\\beta(\\mu_i - \\epsilon_i)\\right) $$\n\nThe probability that a GB site is occupied by species $i$, which defines the $i$-th component of the GB composition vector $\\boldsymbol{\\theta}$, is given by $\\theta_i = P(\\nu_i) = w_i/\\mathcal{Z}$.\n$$ \\theta_i = \\frac{\\exp\\left(\\beta(\\mu_i - \\epsilon_i)\\right)}{1 + \\sum_{k=1}^n \\exp\\left(\\beta(\\mu_k - \\epsilon_k)\\right)} $$\nThe probability that the site is empty is $\\theta_0 = w_0/\\mathcal{Z} = 1/\\mathcal{Z}$. By construction, $\\theta_0 + \\sum_{i=1}^n \\theta_i = 1$.\n\nFor numerical stability, especially at low temperatures (large $\\beta$) or for large values of $\\mu_i - \\epsilon_i$, direct computation of the exponential terms can lead to overflow. We employ the log-sum-exp trick. Let $A_i = \\beta(\\mu_i - \\epsilon_i)$ for $i \\in \\{1, \\dots, n\\}$ and define $A_0 = 0$. Let $A_{\\max} = \\max\\{A_0, A_1, \\dots, A_n\\}$. We can then write $\\theta_i$ as:\n$$ \\theta_i = \\frac{\\exp(A_i)}{\\exp(A_0) + \\sum_{k=1}^n \\exp(A_k)} = \\frac{\\exp(A_i - A_{\\max})}{\\sum_{k=0}^n \\exp(A_k - A_{\\max})} $$\nThis expression is numerically stable as the arguments to the exponential function are always less than or equal to $0$.\n\nThe areal number density $\\gamma_i$ of species $i$ at the GB is obtained by scaling the occupancy probability $\\theta_i$ by the total density of available sites $s$:\n$$ \\gamma_i = s \\cdot \\theta_i $$\n\nTo quantify the sensitivity of the composition vector $\\boldsymbol{\\theta}$ to uncertainties in the bulk chemical potentials $\\boldsymbol{\\mu}$, we compute the Jacobian matrix $J$ with elements $J_{ij} = \\partial \\theta_i / \\partial \\mu_j$. Using the quotient rule on the expression for $\\theta_i$:\n$$ \\frac{\\partial \\theta_i}{\\partial \\mu_j} = \\frac{\\frac{\\partial w_i}{\\partial \\mu_j} \\mathcal{Z} - w_i \\frac{\\partial \\mathcal{Z}}{\\partial \\mu_j}}{\\mathcal{Z}^2} $$\nThe required derivatives are $\\frac{\\partial w_k}{\\partial \\mu_j} = \\beta w_k \\delta_{kj}$ (where $\\delta_{kj}$ is the Kronecker delta) and $\\frac{\\partial \\mathcal{Z}}{\\partial \\mu_j} = \\sum_{k=1}^n \\frac{\\partial w_k}{\\partial \\mu_j} = \\beta w_j$.\nSubstituting these in gives:\n$$ J_{ij} = \\frac{\\partial \\theta_i}{\\partial \\mu_j} = \\frac{(\\beta w_i \\delta_{ij})\\mathcal{Z} - w_i(\\beta w_j)}{\\mathcal{Z}^2} = \\beta \\frac{w_i}{\\mathcal{Z}} \\delta_{ij} - \\beta \\frac{w_i}{\\mathcal{Z}}\\frac{w_j}{\\mathcal{Z}} = \\beta \\theta_i \\delta_{ij} - \\beta \\theta_i \\theta_j $$\nThis can be written more explicitly for the diagonal and off-diagonal terms:\n$$ J_{ij} = \\frac{\\partial \\theta_i}{\\partial \\mu_j} = \\begin{cases} \\beta \\theta_i (1 - \\theta_i)  \\text{if } i = j \\\\ -\\beta \\theta_i \\theta_j  \\text{if } i \\neq j \\end{cases} $$\n\nUsing first-order uncertainty propagation for independent uncertainties $\\sigma_{\\mu_j}$ in the chemical potentials, the variance in $\\theta_i$ is $(\\sigma_{\\theta_i})^2 = \\sum_{j=1}^n (J_{ij})^2 (\\sigma_{\\mu_j})^2$. The uncertainty $u_{\\theta_i}$ is the standard deviation $\\sigma_{\\theta_i}$:\n$$ u_{\\theta_i} = \\sqrt{ \\left(\\beta \\theta_i(1-\\theta_i)\\right)^2 (\\sigma_{\\mu_i})^2 + \\sum_{j \\neq i} \\left(-\\beta \\theta_i \\theta_j\\right)^2 (\\sigma_{\\mu_j})^2 } $$\n$$ u_{\\theta_i} = \\beta \\theta_i \\sqrt{ (1-\\theta_i)^2 (\\sigma_{\\mu_i})^2 + \\sum_{j \\neq i} \\theta_j^2 (\\sigma_{\\mu_j})^2 } $$\nThe uncertainty in the areal density, $u_{\\gamma_i}$, assuming the site density $s$ is known exactly, is simply a linear scaling of $u_{\\theta_i}$:\n$$ u_{\\gamma_i} = s \\cdot u_{\\theta_i} $$\nThese equations form the complete basis for the required computation.",
            "answer": "[[[0.720233,0.145890,0.063134,0.007559],[0.046522,0.021021,0.009363,0.002237],[11.523735,2.334236,1.010151,0.120942],[0.744349,0.336338,0.149814,0.035787]],[[0.222838,0.000000,0.000000,0.000000],[0.027050,0.000003,0.000001,0.000000],[2.674052,0.000000,0.000000,0.000000],[0.324604,0.000034,0.000012,0.000005]],[[0.060128,0.060714,0.059550,0.058983],[0.001691,0.001700,0.001669,0.001654],[1.202553,1.214282,1.191000,1.179654],[0.033816,0.033994,0.033388,0.033075]],[[0.335359,0.158737,0.000676,0.134267],[0.029831,0.076878,0.000078,0.016335],[6.036465,2.857270,0.012165,2.416805],[0.536962,1.383808,0.001407,0.294032]]]"
        }
    ]
}