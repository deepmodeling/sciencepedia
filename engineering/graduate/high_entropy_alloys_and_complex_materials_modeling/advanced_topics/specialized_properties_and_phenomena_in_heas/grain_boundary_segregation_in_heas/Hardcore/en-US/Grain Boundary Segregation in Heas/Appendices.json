{
    "hands_on_practices": [
        {
            "introduction": "The tendency for a solute to segregate to a grain boundary is governed by a complex interplay of energetic factors. At a fundamental level, the segregation energy can be decomposed into a chemical component, reflecting intrinsic bonding preferences, and an elastic component, arising from the interaction of the solute's size misfit with the local stress field of the boundary. This exercise  provides a direct way to quantify the competition between these two driving forces by calculating the critical pressure at which the elastic contribution matches the chemical one, offering crucial insight into which effect dominates in different microstructural environments.",
            "id": "3743998",
            "problem": "In a substitutional solute segregation problem at a grain boundary in High-Entropy Alloys (HEAs), the segregation enthalpy per solute atom is decomposed into a chemical term and an elastic term as follows: $\\Delta E_{\\mathrm{seg}} = \\Delta E_{\\mathrm{chem}} + \\Delta E_{\\mathrm{el}}$. Consider a single solute species $X$ in an equiatomic face-centered cubic HEA matrix segregating to a symmetric tilt Grain Boundary (GB). The chemical term $\\Delta E_{\\mathrm{chem}}$ reflects the bonding preference of $X$ for the GB environment relative to the bulk lattice and is taken as independent of stress. The elastic term $\\Delta E_{\\mathrm{el}}$ arises from the interaction of the solute’s relaxation volume with the local hydrostatic stress field at the GB.\n\nStarting from the fundamental result that the energy of a point defect of relaxation volume $\\Delta V$ under hydrostatic pressure $p$ (taken positive in compression) is $\\Delta E_{\\mathrm{el}} = - p \\, \\Delta V$, derive an expression for the hydrostatic stress magnitude $p^{\\star}$ at which the elastic and chemical drivers have equal magnitude, i.e., $|\\Delta E_{\\mathrm{chem}}| = |\\Delta E_{\\mathrm{el}}|$. Then evaluate $p^{\\star}$ numerically for a solute with $\\Delta E_{\\mathrm{chem}} = -0.08 \\ \\mathrm{eV}$ (from Density Functional Theory (DFT) binding calculations) and $\\Delta V = +2.0 \\ \\mathrm{\\AA}^{3}$. In your reasoning, clearly state the inequalities defining the chemical-dominated and elastic-dominated regimes in terms of $|p|$ relative to $p^{\\star}$.\n\nExpress the final $p^{\\star}$ in $\\mathrm{GPa}$ and round your answer to three significant figures.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of materials science and continuum mechanics, well-posed with sufficient information for a unique solution, and expressed in objective, formal language. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe problem requires the derivation and calculation of a critical hydrostatic pressure magnitude, denoted as $p^{\\star}$, at which the elastic and chemical contributions to the solute segregation enthalpy have equal magnitude.\n\nThe segregation enthalpy, $\\Delta E_{\\mathrm{seg}}$, is given as the sum of a chemical term, $\\Delta E_{\\mathrm{chem}}$, and an elastic term, $\\Delta E_{\\mathrm{el}}$:\n$$ \\Delta E_{\\mathrm{seg}} = \\Delta E_{\\mathrm{chem}} + \\Delta E_{\\mathrm{el}} $$\nThe elastic energy contribution is defined as the interaction between the solute's relaxation volume, $\\Delta V$, and the local hydrostatic pressure, $p$. The fundamental relation is given as:\n$$ \\Delta E_{\\mathrm{el}} = -p \\, \\Delta V $$\nHere, pressure $p$ is defined as positive in compression. A positive relaxation volume ($\\Delta V > 0$) under compressive pressure ($p > 0$) results in a negative (favorable) elastic energy, as expected.\n\nThe core condition of the problem is that the magnitudes of the chemical and elastic drivers are equal. We express this as:\n$$ |\\Delta E_{\\mathrm{chem}}| = |\\Delta E_{\\mathrm{el}}| $$\nSubstituting the expression for $\\Delta E_{\\mathrm{el}}$, we obtain:\n$$ |\\Delta E_{\\mathrm{chem}}| = |-p \\, \\Delta V| $$\nUsing the property of absolute values, $|ab| = |a||b|$, this becomes:\n$$ |\\Delta E_{\\mathrm{chem}}| = |p| \\, |\\Delta V| $$\nThe problem asks for the hydrostatic stress magnitude $p^{\\star}$. This corresponds to the value of $|p|$ that satisfies the condition. Therefore, we can write:\n$$ p^{\\star} = |p| = \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|} $$\nThis is the symbolic expression for the critical pressure magnitude $p^{\\star}$.\n\nNext, we evaluate this expression numerically using the provided data:\n$\\Delta E_{\\mathrm{chem}} = -0.08 \\ \\mathrm{eV}$\n$\\Delta V = +2.0 \\ \\mathrm{\\AA}^{3}$\n\nFirst, we determine the magnitudes of these quantities:\n$|\\Delta E_{\\mathrm{chem}}| = |-0.08 \\ \\mathrm{eV}| = 0.08 \\ \\mathrm{eV}$\n$|\\Delta V| = |+2.0 \\ \\mathrm{\\AA}^{3}| = 2.0 \\ \\mathrm{\\AA}^{3}$\n\nTo calculate the pressure $p^{\\star}$ in SI units (Pascals, $\\mathrm{Pa}$), we must convert the energy to Joules ($\\mathrm{J}$) and the volume to cubic meters ($\\mathrm{m}^3$). The unit of pressure, Pascal, is equivalent to $\\mathrm{N}/\\mathrm{m}^2$ or $\\mathrm{J}/\\mathrm{m}^3$.\n\nThe conversion factors are:\n$1 \\ \\mathrm{eV} \\approx 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$\n$1 \\ \\mathrm{\\AA} = 10^{-10} \\ \\mathrm{m}$, which implies $1 \\ \\mathrm{\\AA}^{3} = (10^{-10} \\ \\mathrm{m})^3 = 10^{-30} \\ \\mathrm{m}^3$.\n\nApplying these conversions:\n$$ |\\Delta E_{\\mathrm{chem}}| = 0.08 \\ \\mathrm{eV} \\times (1.602176634 \\times 10^{-19} \\ \\mathrm{J}/\\mathrm{eV}) \\approx 1.28174 \\times 10^{-20} \\ \\mathrm{J} $$\n$$ |\\Delta V| = 2.0 \\ \\mathrm{\\AA}^3 \\times (10^{-30} \\ \\mathrm{m}^3/\\mathrm{\\AA}^3) = 2.0 \\times 10^{-30} \\ \\mathrm{m}^3 $$\n\nNow, we can calculate $p^{\\star}$:\n$$ p^{\\star} = \\frac{1.28174 \\times 10^{-20} \\ \\mathrm{J}}{2.0 \\times 10^{-30} \\ \\mathrm{m}^3} = 0.64087 \\times 10^{10} \\ \\frac{\\mathrm{J}}{\\mathrm{m}^3} = 6.4087 \\times 10^9 \\ \\mathrm{Pa} $$\nThe problem asks for the answer in gigapascals ($\\mathrm{GPa}$), where $1 \\ \\mathrm{GPa} = 10^9 \\ \\mathrm{Pa}$.\n$$ p^{\\star} = 6.4087 \\ \\mathrm{GPa} $$\nRounding to three significant figures, we get:\n$$ p^{\\star} \\approx 6.41 \\ \\mathrm{GPa} $$\n\nFinally, we define the chemical-dominated and elastic-dominated regimes based on the relative magnitudes of the energy terms. The segregation is:\n- **Chemical-dominated** when $|\\Delta E_{\\mathrm{chem}}| > |\\Delta E_{\\mathrm{el}}|$. Substituting $|\\Delta E_{\\mathrm{el}}| = |p||\\Delta V|$, this inequality becomes $|\\Delta E_{\\mathrm{chem}}| > |p||\\Delta V|$. Rearranging gives $|p| < \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|}$, which is $|p| < p^{\\star}$.\n- **Elastic-dominated** when $|\\Delta E_{\\mathrm{el}}| > |\\Delta E_{\\mathrm{chem}}|$. This inequality becomes $|p||\\Delta V| > |\\Delta E_{\\mathrm{chem}}|$, which rearranges to $|p| > \\frac{|\\Delta E_{\\mathrm{chem}}|}{|\\Delta V|}$, or $|p| > p^{\\star}$.\n\nIn summary, for local hydrostatic pressure magnitudes $|p|$ less than $p^{\\star}$, the chemical bonding preference dictates segregation behavior. For magnitudes greater than $p^{\\star}$, the mechanical interaction between the solute and the local stress field becomes the dominant driving force.",
            "answer": "$$\n\\boxed{6.41}\n$$"
        },
        {
            "introduction": "The Gibbs Adsorption Isotherm is a cornerstone of interfacial thermodynamics, providing a rigorous and model-independent link between macroscopic properties and microscopic composition. It elegantly states that the excess concentration of a species at an interface, $\\Gamma_i$, is directly related to the change in interfacial energy, $\\gamma$, with respect to that species' chemical potential, $\\mu_i$. This powerful practice  demonstrates how to apply this theorem to analyze data from computational simulations, allowing you to extract quantitative segregation information from the measured thermodynamic response of the system.",
            "id": "3744028",
            "problem": "Consider a face-centered cubic High-Entropy Alloy (HEA) of equiatomic composition $\\text{CoCrFeMnNi}$ containing a $\\Sigma 5$ symmetric tilt grain boundary. The boundary is in equilibrium with a bulk reservoir at constant temperature $T$ and pressure $p$, and the system is treated in the grand canonical ensemble. The boundary energy per unit area $\\gamma$ is measured as a function of the chemical potential $\\mu_{\\text{Ni}}$ of nickel while the chemical potentials of the other species $\\mu_{j}$ for $j \\in \\{\\text{Co}, \\text{Cr}, \\text{Fe}, \\text{Mn}\\}$ are kept fixed to maintain the equiatomic bulk reference. In a Grand Canonical Monte Carlo (GCMC) simulation, the dependence of $\\gamma$ on $\\mu_{\\text{Ni}}$ at fixed $T$, $p$, and $\\mu_{j \\neq \\text{Ni}}$ is well fit over the range of interest by the polynomial\n$$\n\\gamma(\\mu_{\\text{Ni}}) = \\gamma_{0} + A\\left(\\mu_{\\text{Ni}} - \\mu_{\\text{ref}}\\right) + B\\left(\\mu_{\\text{Ni}} - \\mu_{\\text{ref}}\\right)^{2},\n$$\nwith $\\gamma_{0} = 0.825$ J m$^{-2}$, $A = -0.30$ J m$^{-2}$ eV$^{-1}$, $B = 0.10$ J m$^{-2}$ eV$^{-2}$, and $\\mu_{\\text{ref}} = -0.72$ eV. Here, $\\mu_{\\text{Ni}}$ is reported in electronvolts (eV) per atom, and the energy unit conversion is $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}$ J.\n\nStarting from fundamental interfacial thermodynamics at fixed $T$ and $p$, derive an expression that relates the surface excess (adsorption) $\\Gamma_{\\text{Ni}}$ of nickel at the grain boundary to the sensitivity of $\\gamma$ with respect to $\\mu_{\\text{Ni}}$ under the constraint that $\\mu_{j \\neq \\text{Ni}}$ are held constant. Then evaluate $\\Gamma_{\\text{Ni}}$ at $\\mu_{\\text{Ni}} = -0.57$ eV using the given fit for $\\gamma(\\mu_{\\text{Ni}})$.\n\nExpress the final numerical value of $\\Gamma_{\\text{Ni}}$ in atoms nm$^{-2}$, and round your answer to three significant figures. Clearly state and justify the thermodynamic assumptions under which holding $\\mu_{j \\neq \\text{Ni}}$ constant leads to a meaningful single-component derivative with respect to $\\mu_{\\text{Ni}}$.",
            "solution": "The problem requires the derivation of an expression for the surface excess of nickel, $\\Gamma_{\\text{Ni}}$, at a grain boundary and its subsequent calculation based on a given polynomial fit for the grain boundary energy, $\\gamma$, as a function of the chemical potential of nickel, $\\mu_{\\text{Ni}}$.\n\nFirst, we establish the thermodynamic relationship between $\\gamma$ and $\\Gamma_{\\text{Ni}}$. We begin with the fundamental equation for the energy of a multi-component system containing an interface of area $\\mathcal{A}$, which can be expressed as:\n$$\ndU = T dS - p dV + \\gamma d\\mathcal{A} + \\sum_{i} \\mu_i dN_i\n$$\nwhere $U$ is the internal energy, $T$ is temperature, $S$ is entropy, $p$ is pressure, $V$ is volume, $\\mu_i$ is the chemical potential of species $i$, and $N_i$ is the number of particles of species $i$.\n\nThe integrated form of this equation, based on Euler's theorem for extensive variables, is:\n$$\nU = TS - pV + \\gamma \\mathcal{A} + \\sum_{i} \\mu_i N_i\n$$\nTaking the total differential of this integrated form gives:\n$$\ndU = T dS + S dT - p dV - V dp + \\gamma d\\mathcal{A} + \\mathcal{A} d\\gamma + \\sum_{i} \\mu_i dN_i + \\sum_{i} N_i d\\mu_i\n$$\nEquating the two expressions for $dU$ yields the Gibbs-Duhem equation for the entire system:\n$$\nS dT - V dp + \\mathcal{A} d\\gamma + \\sum_{i} N_i d\\mu_i = 0\n$$\nAn analogous Gibbs-Duhem relation holds for each of the bulk phases ($\\alpha$ and $\\beta$) adjoining the interface:\n$$\nS^{\\alpha,\\beta} dT - V^{\\alpha,\\beta} dp + \\sum_{i} N_i^{\\alpha,\\beta} d\\mu_i = 0\n$$\nThe excess properties at the interface are defined by subtracting the bulk contributions from the total system properties. Applying this principle, we subtract the bulk Gibbs-Duhem relations from the total system relation, which results in the Gibbs adsorption isotherm for the interface:\n$$\nS^{\\text{ex}} dT - V^{\\text{ex}} dp + \\mathcal{A} d\\gamma + \\sum_{i} N_i^{\\text{ex}} d\\mu_i = 0\n$$\nwhere $X^{\\text{ex}}$ is the excess quantity of $X$. Dividing by the interfacial area $\\mathcal{A}$ and defining the surface excess concentration of species $i$ as $\\Gamma_i = N_i^{\\text{ex}} / \\mathcal{A}$ (in atoms per unit area), we get:\n$$\ns^{\\text{ex}} dT - \\tau^{\\text{ex}} dp + d\\gamma + \\sum_{i} \\Gamma_i d\\mu_i = 0\n$$\nwhere $s^{\\text{ex}}$ and $\\tau^{\\text{ex}}$ are the excess entropy and volume per unit area, respectively. By choosing the Gibbs dividing surface appropriately, the excess volume $\\tau^{\\text{ex}}$ can be set to zero.\n\nThe problem states that the measurements are performed at constant temperature $T$ and pressure $p$, so $dT = 0$ and $dp = 0$. The Gibbs adsorption isotherm simplifies to:\n$$\nd\\gamma = - \\sum_{i} \\Gamma_i d\\mu_i\n$$\nFor the five-component system CoCrFeMnNi, this is:\n$$\nd\\gamma = - (\\Gamma_{\\text{Co}} d\\mu_{\\text{Co}} + \\Gamma_{\\text{Cr}} d\\mu_{\\text{Cr}} + \\Gamma_{\\text{Fe}} d\\mu_{\\text{Fe}} + \\Gamma_{\\text{Mn}} d\\mu_{\\text{Mn}} + \\Gamma_{\\text{Ni}} d\\mu_{\\text{Ni}})\n$$\nThe problem specifies that $\\gamma$ is measured as a function of $\\mu_{\\text{Ni}}$ while the chemical potentials of all other species $j \\in \\{\\text{Co}, \\text{Cr}, \\text{Fe}, \\text{Mn}\\}$ are held constant. This means $d\\mu_{j \\neq \\text{Ni}} = 0$. Under this constraint, the differential $d\\gamma$ simplifies to:\n$$\nd\\gamma = - \\Gamma_{\\text{Ni}} d\\mu_{\\text{Ni}}\n$$\nThis yields the desired expression for the surface excess of nickel:\n$$\n\\Gamma_{\\text{Ni}} = - \\left( \\frac{\\partial \\gamma}{\\partial \\mu_{\\text{Ni}}} \\right)_{T, p, \\mu_{j \\neq \\text{Ni}}}\n$$\n\nThe problem also asks for a justification of the constraint that $\\mu_{j \\neq \\text{Ni}}$ are held constant. In a single-phase bulk material at equilibrium, the chemical potentials of its components are not all independent and must satisfy the bulk Gibbs-Duhem relation, $\\sum_i x_i d\\mu_i = 0$ at constant $T$ and $p$. This would imply that one cannot vary one chemical potential while holding all others fixed. However, the system is treated in the grand canonical ensemble, which is in equilibrium with a hypothetical external particle reservoir. In this ensemble, the chemical potentials $\\{\\mu_i\\}$ (along with $T$ and volume $V$) are the independent thermodynamic variables that define the state of the reservoir. It is therefore a well-defined thermodynamic process to vary one potential, $\\mu_{\\text{Ni}}$, while holding the others constant in the reservoir. The bulk alloy within the simulation volume will respond to these imposed external potentials by adjusting its composition $\\{x_i\\}$ to satisfy its internal Gibbs-Duhem constraint. The derivative $(\\partial \\gamma / \\partial \\mu_{\\text{Ni}})_{T, p, \\mu_{j \\neq \\text{Ni}}}$ is thus a well-defined measure of the interfacial response along a specific path in the thermodynamic state space defined by the reservoir.\n\nNow we proceed to the calculation. The given polynomial fit for $\\gamma$ is:\n$$\n\\gamma(\\mu_{\\text{Ni}}) = \\gamma_{0} + A(\\mu_{\\text{Ni}} - \\mu_{\\text{ref}}) + B(\\mu_{\\text{Ni}} - \\mu_{\\text{ref}})^{2}\n$$\nWe compute the derivative with respect to $\\mu_{\\text{Ni}}$:\n$$\n\\frac{d\\gamma}{d\\mu_{\\text{Ni}}} = A + 2B(\\mu_{\\text{Ni}} - \\mu_{\\text{ref}})\n$$\nThe problem gives the following values: $A = -0.30$ J m$^{-2}$ eV$^{-1}$, $B = 0.10$ J m$^{-2}$ eV$^{-2}$, and $\\mu_{\\text{ref}} = -0.72$ eV. We need to evaluate the derivative at $\\mu_{\\text{Ni}} = -0.57$ eV.\n$$\n\\mu_{\\text{Ni}} - \\mu_{\\text{ref}} = (-0.57 \\text{ eV}) - (-0.72 \\text{ eV}) = 0.15 \\text{ eV}\n$$\nSubstituting the values into the derivative expression:\n$$\n\\frac{d\\gamma}{d\\mu_{\\text{Ni}}} = -0.30 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}} + 2 \\left( 0.10 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}^2} \\right) (0.15 \\text{ eV})\n$$\n$$\n\\frac{d\\gamma}{d\\mu_{\\text{Ni}}} = -0.30 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}} + 0.03 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}} = -0.27 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}}\n$$\nThis derivative has mixed energy units. The thermodynamic relation for $\\Gamma_{\\text{Ni}}$ requires consistent units. If $\\mu'_{\\text{Ni}}$ is the chemical potential in Joules and $\\mu_{\\text{Ni}}$ is in electronvolts, then $\\mu'_{\\text{Ni}} = k \\mu_{\\text{Ni}}$, where $k = 1.602176634 \\times 10^{-19}$ J/eV. The surface excess in units of atoms/m$^2$ is:\n$$\n\\Gamma_{\\text{Ni}} = - \\frac{\\partial \\gamma}{\\partial \\mu'_{\\text{Ni}}} = - \\frac{\\partial \\gamma}{\\partial \\mu_{\\text{Ni}}} \\frac{d\\mu_{\\text{Ni}}}{d\\mu'_{\\text{Ni}}} = - \\frac{1}{k} \\frac{d\\gamma}{d\\mu_{\\text{Ni}}}\n$$\nSubstituting the calculated derivative and the value of $k$:\n$$\n\\Gamma_{\\text{Ni}} = - \\frac{1}{1.602176634 \\times 10^{-19} \\frac{\\text{J}}{\\text{eV}}} \\left( -0.27 \\frac{\\text{J}}{\\text{m}^2 \\text{eV}} \\right)\n$$\nThe units cancel appropriately, leaving atoms/m$^2$:\n$$\n\\Gamma_{\\text{Ni}} = \\frac{0.27}{1.602176634 \\times 10^{-19}} \\frac{\\text{atoms}}{\\text{m}^2} = 1.68521... \\times 10^{18} \\frac{\\text{atoms}}{\\text{m}^2}\n$$\nThe problem asks for the answer in atoms per square nanometer (atoms nm$^{-2}$). We use the conversion $1$ m $= 10^9$ nm, so $1$ m$^2 = (10^9 \\text{ nm})^2 = 10^{18}$ nm$^2$.\n$$\n\\Gamma_{\\text{Ni}} = \\left( 1.68521... \\times 10^{18} \\frac{\\text{atoms}}{\\text{m}^2} \\right) \\times \\left( \\frac{1 \\text{ m}^2}{10^{18} \\text{ nm}^2} \\right) = 1.68521... \\frac{\\text{atoms}}{\\text{nm}^2}\n$$\nRounding to three significant figures, we get:\n$$\n\\Gamma_{\\text{Ni}} \\approx 1.69 \\frac{\\text{atoms}}{\\text{nm}^2}\n$$\nThe positive value of $\\Gamma_{\\text{Ni}}$ indicates that nickel segregates to the grain boundary under these conditions.",
            "answer": "$$\n\\boxed{1.69}\n$$"
        },
        {
            "introduction": "Segregation at grain boundaries is not merely a change in local composition; it can drive cooperative structural transformations, creating distinct interfacial phases known as \"complexions.\" This advanced exercise  challenges you to model this coupled phenomenon by integrating a statistical mechanics model for segregation with a Landau-type free energy model for a structural order parameter. By solving this coupled problem, you will explore how temperature and the chemical environment can induce sharp transitions between disordered and ordered grain boundary states, a frontier topic in the design of advanced materials.",
            "id": "3743988",
            "problem": "Consider a planar grain boundary in a high-entropy alloy modeled as a stack of discrete layers indexed by the nonnegative integer $\\ell \\in \\{0,1,\\dots,L-1\\}$, with $\\ell=0$ at the grain boundary plane. Each layer has an areal density of sites that can be either empty or occupied by exactly one solute species among $M$ possibilities, enforcing a strict single-occupancy constraint per site. Assume the following for each independent site in layer $\\ell$:\n- The microstate energy contribution associated with occupying the site by species $i \\in \\{1,\\dots,M\\}$ is lowered by a binding energy $\\Delta E_i(\\ell)$ relative to the bulk, and the empty state defines the zero of energy. The binding energy decays from the grain boundary plane as $\\Delta E_i(\\ell) = E_{b,i} \\exp(-\\ell/\\xi)$, where $E_{b,i}$ is a species-specific binding amplitude and $\\xi$ is a positive decay length in units of layers.\n- The system is in contact with particle reservoirs for each species with fixed chemical potentials $\\{\\mu_i\\}_{i=1}^M$ at absolute temperature $T$. The microstate probabilities are governed by the grand canonical ensemble with inverse temperature $\\beta = 1/(k_B T)$, where $k_B$ is Boltzmann’s constant.\n\nDefine the layer-dependent segregation profile as the vector of equilibrium site-occupancy fractions $\\boldsymbol{\\theta}(\\ell) = (\\theta_1(\\ell),\\dots,\\theta_M(\\ell))$, where $\\theta_i(\\ell)$ is the probability that a site in layer $\\ell$ is occupied by species $i$. These probabilities must be derived from the grand canonical partition function at fixed $\\{\\mu_i\\}$, $T$, and the single-occupancy constraint including the empty state.\n\nTo capture grain boundary structural complexions, introduce a scalar structural order parameter $\\eta \\ge 0$ that distinguishes disordered ($\\eta=0$) from ordered ($\\eta>0$) grain boundary states. Consider a Landau free energy density per site for the grain boundary,\n$$\nf(\\eta;T,W) = a\\,(T - T_{c0})\\,\\eta^2 + b\\,\\eta^4 - \\kappa\\,W\\,\\eta^2,\n$$\nwhere $a>0$, $b>0$, and $\\kappa>0$ are material parameters, $T_{c0}$ is a reference critical temperature in Kelvin, and $W$ is a segregation-driven stabilizing field defined by a weighted sum of the grain boundary plane occupancies,\n$$\nW = \\sum_{i=1}^{M} w_i\\,\\theta_i(0),\n$$\nwith given coupling weights $w_i$ that can be positive or negative. The equilibrium structural state at given $T$ and $\\{\\mu_i\\}$ minimizes $f(\\eta;T,W)$ with respect to $\\eta$. Define a complexion indicator $C$ as $C=1$ if the equilibrium $\\eta^\\star>0$ and $C=0$ if the equilibrium $\\eta^\\star=0$.\n\nYour task is to compute, for specified parameters, both the segregation profile $\\boldsymbol{\\theta}(\\ell)$ and the equilibrium structural order parameter $\\eta^\\star$ by:\n- Using the grand canonical ensemble with the single-occupancy constraint to obtain $\\theta_i(\\ell)$ for each layer $\\ell$ and species $i$ from first principles.\n- Using thermodynamic minimization of $f(\\eta;T,W)$ to obtain $\\eta^\\star$ and the complexion indicator $C$.\n\nPhysical units:\n- Temperature $T$ must be in Kelvin.\n- Energies $\\mu_i$, $\\Delta E_i$, $E_{b,i}$, $f$, $a T$, $b \\eta^4$, and $\\kappa W \\eta^2$ must be in electronvolts per site.\n- Boltzmann’s constant $k_B$ must be used in electronvolts per Kelvin.\n\nImplementation details:\n- Use $k_B = 8.617333262\\times 10^{-5}$ in units of electronvolts per Kelvin.\n- Use $M=3$ species and $L=4$ layers.\n- Use binding amplitudes $E_{b,1} = 0.25$, $E_{b,2} = 0.08$, $E_{b,3} = -0.03$ in electronvolts, and decay length $\\xi = 1.2$ in layers.\n- Use coupling weights $w_1 = 1.0$, $w_2 = 0.6$, $w_3 = -0.2$ (dimensionless).\n- Use Landau parameters $a = 1.2\\times 10^{-4}$ in electronvolts per Kelvin, $b = 0.015$ in electronvolts, $\\kappa = 0.06$ in electronvolts, and $T_{c0} = 1000.0$ in Kelvin.\n\nComputation requirements:\n- For each test case, compute the full layer-resolved segregation profile $\\{\\boldsymbol{\\theta}(\\ell)\\}_{\\ell=0}^{L-1}$ and evaluate $W$ using $\\boldsymbol{\\theta}(0)$.\n- Determine the equilibrium $\\eta^\\star$ that minimizes $f(\\eta;T,W)$ at fixed $T$ and $W$, and then determine the complexion indicator $C$ as defined.\n- Report, for each test case, only the grain boundary plane coverage vector $\\boldsymbol{\\theta}(0)$, the equilibrium $\\eta^\\star$, and the complexion indicator $C$.\n\nNumerical output specification:\n- Express $\\theta_i(0)$ and $\\eta^\\star$ as decimal floats rounded to exactly six digits after the decimal point.\n- Express the complexion indicator $C$ as an integer $0$ or $1$.\n- The final program output must be a single line containing a list of per-test-case results, where each test case result is a list of length $M+2$ ordered as $[\\theta_1(0), \\theta_2(0), \\theta_3(0), \\eta^\\star, C]$.\n\nTest suite:\n- Use the following four test cases, each specified by $(T,\\mu_1,\\mu_2,\\mu_3)$, with all energies in electronvolts and temperature in Kelvin:\n    1. $(T,\\mu_1,\\mu_2,\\mu_3) = (800.0,-0.20,-0.25,-0.30)$\n    2. $(T,\\mu_1,\\mu_2,\\mu_3) = (1200.0,-0.20,-0.25,-0.30)$\n    3. $(T,\\mu_1,\\mu_2,\\mu_3) = (1400.0,-0.20,-0.25,-0.30)$\n    4. $(T,\\mu_1,\\mu_2,\\mu_3) = (900.0,-0.50,-0.50,-0.50)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the format specified above. For example, an output with two hypothetical test cases would look like $[[x_{11},x_{12},x_{13},y_1,c_1],[x_{21},x_{22},x_{23},y_2,c_2]]$, but you must follow the exact test suite provided and the rounding rules specified.",
            "solution": "The problem requires the determination of the equilibrium state of a grain boundary in a high-entropy alloy, characterized by both its chemical composition (segregation profile) and its local structure (order parameter). The solution involves a two-part modeling approach: first, a statistical mechanics calculation of solute segregation using the grand canonical ensemble, and second, a thermodynamic minimization of a Landau-type free energy for the structural order parameter, which is coupled to the segregation.\n\n### 1. Equilibrium Segregation Profile\n\nThe system consists of independent layers, and the sites within each layer are also assumed to be independent. Therefore, we can determine the equilibrium occupancy statistics by analyzing a single representative site in a given layer $\\ell$. The site can be in one of $M+1$ microstates: empty, or occupied by one of the $M$ solute species. The system is in thermal and chemical equilibrium with particle reservoirs at temperature $T$ and chemical potentials $\\{\\mu_i\\}_{i=1}^M$. The microstate probabilities are thus governed by the grand canonical ensemble.\n\nThe grand canonical energy, $\\mathcal{E} = E - \\sum_i \\mu_i N_i$, for each possible state of a site in layer $\\ell$ is as follows:\n- **Empty State**: The site is unoccupied. The energy is $E_0=0$ (by definition) and the number of particles of all species is zero ($N_i=0$ for all $i$). Thus, the grand canonical energy is $\\mathcal{E}_0 = 0$.\n- **Occupied State (Species $i$)**: The site is occupied by a single particle of species $i$. The energy is $E_i(\\ell) = -\\Delta E_i(\\ell)$, where the binding energy is given by $\\Delta E_i(\\ell) = E_{b,i} \\exp(-\\ell/\\xi)$. The number of particles is $N_i=1$, and $N_j=0$ for $j \\ne i$. The grand canonical energy for this state is $\\mathcal{E}_i(\\ell) = E_i(\\ell) - \\mu_i N_i = -\\Delta E_i(\\ell) - \\mu_i$.\n\nThe single-site grand canonical partition function for layer $\\ell$, denoted $\\mathcal{Z}_\\ell$, is the sum of the Boltzmann factors for all possible states:\n$$\n\\mathcal{Z}_\\ell = e^{-\\beta \\mathcal{E}_0} + \\sum_{i=1}^{M} e^{-\\beta \\mathcal{E}_i(\\ell)}\n$$\nwhere $\\beta = 1/(k_B T)$ is the inverse temperature. Substituting the expressions for the grand canonical energies:\n$$\n\\mathcal{Z}_\\ell = e^0 + \\sum_{i=1}^{M} e^{-\\beta(-\\Delta E_i(\\ell) - \\mu_i)} = 1 + \\sum_{i=1}^{M} e^{\\beta(\\Delta E_i(\\ell) + \\mu_i)}\n$$\nThe probability that a site in layer $\\ell$ is occupied by species $i$, which by definition is the equilibrium site-occupancy fraction $\\theta_i(\\ell)$, is the ratio of the Boltzmann factor for that state to the partition function:\n$$\n\\theta_i(\\ell) = \\frac{e^{\\beta(\\Delta E_i(\\ell) + \\mu_i)}}{\\mathcal{Z}_\\ell} = \\frac{e^{\\beta(\\Delta E_i(\\ell) + \\mu_i)}}{1 + \\sum_{j=1}^{M} e^{\\beta(\\Delta E_j(\\ell) + \\mu_j)}}\n$$\nThis expression, analogous to the multi-component Langmuir adsorption isotherm, allows for the calculation of the segregation profile $\\boldsymbol{\\theta}(\\ell) = (\\theta_1(\\ell), \\dots, \\theta_M(\\ell))$ for any layer $\\ell$.\n\n### 2. Equilibrium Structural Order Parameter\n\nThe structural state of the grain boundary is described by a scalar order parameter $\\eta \\ge 0$. Its equilibrium value, $\\eta^\\star$, is found by minimizing the Landau free energy density per site, $f(\\eta;T,W)$, given by:\n$$\nf(\\eta;T,W) = a\\,(T - T_{c0})\\,\\eta^2 + b\\,\\eta^4 - \\kappa\\,W\\,\\eta^2\n$$\nThe parameter $W = \\sum_{i=1}^{M} w_i\\,\\theta_i(0)$ represents the influence of segregation at the grain boundary plane ($\\ell=0$) on the structural transition. The problem specifies that $\\boldsymbol{\\theta}(0)$ is determined independently, so $W$ can be treated as a fixed parameter once the segregation is computed for a given temperature $T$ and chemical potentials $\\{\\mu_i\\}$.\n\nTo find the minimum of $f$, we can group the terms quadratic in $\\eta$:\n$$\nf(\\eta;T,W) = \\left[a(T - T_{c0}) - \\kappa W\\right]\\eta^2 + b\\eta^4\n$$\nLet us define an effective quadratic coefficient $A(T,W) = a(T-T_{c0}) - \\kappa W$. The free energy expression becomes:\n$$\nf(\\eta; T, W) = A(T,W) \\eta^2 + b \\eta^4\n$$\nSince $\\eta \\ge 0$, we are looking for the minimum of $f$ for $\\eta \\in [0, \\infty)$. We analyze the derivative with respect to $\\eta$:\n$$\n\\frac{\\partial f}{\\partial \\eta} = 2 A(T,W) \\eta + 4 b \\eta^3 = 2\\eta \\left( A(T,W) + 2b\\eta^2 \\right)\n$$\nSetting the derivative to zero gives potential extrema at $\\eta=0$ and, if $A(T,W) \\le 0$, at $\\eta^2 = -A(T,W)/(2b)$. We analyze the stability of these solutions based on the sign of $A(T,W)$, given that $b>0$:\n\n- **Case 1: $A(T,W) > 0$**\nThe coefficient of the $\\eta^2$ term is positive. Since the $\\eta^4$ term is also positive for $\\eta \\ne 0$, the free energy $f$ is a monotonically increasing function of $\\eta^2$ for $\\eta^2 \\ge 0$. The global minimum is at the lowest possible value of $\\eta^2$, which is $\\eta^2=0$. Therefore, the equilibrium order parameter is $\\eta^\\star = 0$. The grain boundary is in the disordered state, and the complexion indicator is $C=0$.\n\n- **Case 2: $A(T,W) \\le 0$**\nThe coefficient of the $\\eta^2$ term is non-positive. The solution $\\eta=0$ corresponds to a local maximum (for $A<0$) or an inflection point (for $A=0$), since the second derivative $\\frac{\\partial^2 f}{\\partial \\eta^2}|_{\\eta=0} = 2A \\le 0$. The stable minimum occurs at a non-zero value of $\\eta$. The minimum is found by setting $A(T,W) + 2b\\eta^2 = 0$, which yields $\\eta^2 = -A(T,W)/(2b)$. The equilibrium order parameter is thus:\n$$\n\\eta^\\star = \\sqrt{\\frac{-A(T,W)}{2b}} = \\sqrt{\\frac{\\kappa W - a(T - T_{c0})}{2b}}\n$$\nSince $\\eta^\\star > 0$ (for $A<0$) or $\\eta^\\star=0$ (for $A=0$), the grain boundary is in an ordered state, and the complexion indicator is $C=1$.\n\n### 3. Computational Procedure\n\nFor each test case specified by $(T, \\mu_1, \\mu_2, \\mu_3)$, the calculation proceeds as follows:\n1.  Calculate the inverse temperature $\\beta = 1/(k_B T)$.\n2.  Calculate the grain boundary plane segregation profile $\\boldsymbol{\\theta}(0)$. At $\\ell=0$, the binding energy is $\\Delta E_i(0) = E_{b,i} \\exp(-0/\\xi) = E_{b,i}$. The occupancies are given by:\n    $$\n    \\theta_i(0) = \\frac{e^{\\beta(E_{b,i} + \\mu_i)}}{1 + \\sum_{j=1}^{M} e^{\\beta(E_{b,j} + \\mu_j)}} \\quad \\text{for } i=1, \\dots, M\n    $$\n3.  Calculate the segregation-driven field $W = \\sum_{i=1}^{M} w_i \\theta_i(0)$.\n4.  Calculate the Landau coefficient $A(T,W) = a(T-T_{c0}) - \\kappa W$.\n5.  Determine the equilibrium order parameter $\\eta^\\star$ and complexion indicator $C$ based on the sign of $A(T,W)$ as derived above.\n6.  Format the results $[\\theta_1(0), \\theta_2(0), \\theta_3(0), \\eta^\\star, C]$ according to the specified numerical precision.\n\nThis procedure is implemented for each test case provided. The Python code below demonstrates the implementation.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grain boundary segregation and complexion transition problem\n    for the specified test cases.\n    \"\"\"\n    \n    # ------------------ Constants and Parameters ------------------\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    M = 3                 # Number of solute species\n    \n    # Segregation parameters\n    E_b = np.array([0.25, 0.08, -0.03])  # Binding amplitudes in eV\n    \n    # Coupling parameters\n    w = np.array([1.0, 0.6, -0.2])       # Coupling weights (dimensionless)\n    \n    # Landau parameters\n    a = 1.2e-4            # in eV/K\n    b = 0.015             # in eV\n    kappa = 0.06          # in eV\n    T_c0 = 1000.0         # in K\n    \n    # ------------------ Test Cases --------------------------------\n    test_cases = [\n        # (T [K], [mu_1, mu_2, mu_3] [eV])\n        (800.0, [-0.20, -0.25, -0.30]),\n        (1200.0, [-0.20, -0.25, -0.30]),\n        (1400.0, [-0.20, -0.25, -0.30]),\n        (900.0, [-0.50, -0.50, -0.50]),\n    ]\n\n    # ------------------ Main Calculation Loop ---------------------\n    all_results = []\n    \n    for T, mu_vec in test_cases:\n        mu = np.array(mu_vec)\n        \n        # 1. Calculate equilibrium segregation at the grain boundary plane (l=0)\n        beta = 1.0 / (k_B * T)\n        \n        # At l=0, Delta_E_i(0) = E_b_i\n        exponents = beta * (E_b + mu)\n        boltzmann_factors = np.exp(exponents)\n        \n        partition_func = 1.0 + np.sum(boltzmann_factors)\n        \n        theta_at_0 = boltzmann_factors / partition_func\n        \n        # 2. Calculate the segregation-driven field W\n        W = np.sum(w * theta_at_0)\n        \n        # 3. Determine the equilibrium structural order parameter eta_star\n        # Calculate the effective quadratic coefficient A for the Landau free energy\n        A = a * (T - T_c0) - kappa * W\n        \n        eta_star = 0.0\n        C = 0  # Complexion indicator\n        \n        # If A <= 0, the ordered state (eta > 0) is stable.\n        if A = 0:\n            eta_star_sq = -A / (2 * b)\n            eta_star = np.sqrt(eta_star_sq)\n            C = 1\n            \n        current_result = [\n            theta_at_0[0], \n            theta_at_0[1], \n            theta_at_0[2],\n            eta_star,\n            float(C) # Store as float for uniform formatting later\n        ]\n        all_results.append(current_result)\n\n    # ------------------ Format Output -----------------------------\n    # The output must be a single string '[[...],[...]]' with no spaces\n    # and specified floating point precision.\n    \n    case_strings = []\n    for res in all_results:\n        # Format floats to 6 decimal places, format C as an integer\n        formatted_items = [f\"{v:.6f}\" for v in res[:-1]] + [str(int(res[-1]))]\n        case_strings.append(f\"[{','.join(formatted_items)}]\")\n\n    # Final print statement must match the problem specification exactly.\n    # print(f\"[{','.join(case_strings)}]\")\n```",
            "answer": "[[0.653818,0.026909,0.002595,1.462612,1],[0.742880,0.015507,0.000628,0.000000,0],[0.763660,0.012543,0.000378,0.000000,0],[0.046559,0.012759,0.005118,0.957640,1]]"
        }
    ]
}