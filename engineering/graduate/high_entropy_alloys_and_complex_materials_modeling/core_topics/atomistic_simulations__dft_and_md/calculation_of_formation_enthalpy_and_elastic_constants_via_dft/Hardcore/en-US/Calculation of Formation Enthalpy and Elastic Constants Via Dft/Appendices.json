{
    "hands_on_practices": [
        {
            "introduction": "Calculating the formation enthalpy is a cornerstone of computational materials science, providing a direct measure of a material's thermodynamic stability. This exercise provides a foundational hands-on practice in applying the standard thermodynamic definition at zero temperature, using total energies from a Density Functional Theory (DFT) supercell calculation . Mastering this calculation is the first step toward predicting phase stability and guiding materials design.",
            "id": "3732165",
            "problem": "A density functional theory (DFT) study of a quaternary equiatomic high-entropy alloy uses a fully relaxed $N$-atom supercell at zero temperature and zero external pressure. The supercell contains $N=\\!128$ atoms with $n_{\\mathrm{A}}=\\!32$, $n_{\\mathrm{B}}=\\!32$, $n_{\\mathrm{C}}=\\!32$, and $n_{\\mathrm{D}}=\\!32$. The total energy of the relaxed alloy supercell is reported as $E_{\\mathrm{tot}}^{\\text{cell}}=\\!-1059.168$ eV. The elemental reference states are the ground-state crystalline structures at zero temperature and zero pressure, with DFT per-atom energies $E_{\\mathrm{A}}^{\\text{ref}}=\\!-8.123$ eV, $E_{\\mathrm{B}}^{\\text{ref}}=\\!-7.987$ eV, $E_{\\mathrm{C}}^{\\text{ref}}=\\!-8.541$ eV, and $E_{\\mathrm{D}}^{\\text{ref}}=\\!-8.256$ eV.\n\nUsing only the standard thermodynamic definitions appropriate for zero temperature and zero pressure, compute the formation enthalpy per atom of the alloy relative to these elemental references. Express your final answer in meV per atom (meV/atom) and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard calculation in computational materials science using clearly defined terms and providing all necessary data.\n\nThe formation enthalpy, $\\Delta H_{\\text{form}}$, of a compound is the change in enthalpy when one mole (or, in this context, one formula unit or one atom) of the compound is formed from its constituent elements in their stable reference states. For theoretical calculations at zero temperature ($T=0$) and zero external pressure ($P=0$), the enthalpy $H$ is equivalent to the internal energy $U$, which is given by the total energy $E_{\\mathrm{tot}}$ computed from density functional theory (DFT). Thus, under these conditions, the formation enthalpy is identical to the formation energy, $\\Delta E_{\\text{form}}$.\n\nThe formation enthalpy for the entire $N$-atom supercell, $\\Delta H_{\\text{form}}^{\\text{cell}}$, is calculated by subtracting the total energy of the constituent elements in their reference states from the total energy of the alloy supercell. The general formula is:\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = E_{\\mathrm{tot}}^{\\text{cell}} - \\sum_{i} n_i E_{i}^{\\text{ref}} $$\nwhere $E_{\\mathrm{tot}}^{\\text{cell}}$ is the total energy of the relaxed alloy supercell, $i$ indexes the constituent elements, $n_i$ is the number of atoms of element $i$ in the supercell, and $E_{i}^{\\text{ref}}$ is the per-atom energy of element $i$ in its reference state.\n\nThe problem provides the following data:\n- Total number of atoms in the supercell: $N = 128$.\n- Number of atoms for each element: $n_{\\mathrm{A}} = 32$, $n_{\\mathrm{B}} = 32$, $n_{\\mathrm{C}} = 32$, and $n_{\\mathrm{D}} = 32$.\n- Total energy of the alloy supercell: $E_{\\mathrm{tot}}^{\\text{cell}} = -1059.168 \\text{ eV}$.\n- Per-atom reference energies:\n  - $E_{\\mathrm{A}}^{\\text{ref}} = -8.123 \\text{ eV}$\n  - $E_{\\mathrm{B}}^{\\text{ref}} = -7.987 \\text{ eV}$\n  - $E_{\\mathrm{C}}^{\\text{ref}} = -8.541 \\text{ eV}$\n  - $E_{\\mathrm{D}}^{\\text{ref}} = -8.256 \\text{ eV}$\n\nFirst, we calculate the total energy of the reference elements, $E_{\\text{ref}}^{\\text{total}}$, corresponding to the composition of the supercell:\n$$ E_{\\text{ref}}^{\\text{total}} = n_{\\mathrm{A}} E_{\\mathrm{A}}^{\\text{ref}} + n_{\\mathrm{B}} E_{\\mathrm{B}}^{\\text{ref}} + n_{\\mathrm{C}} E_{\\mathrm{C}}^{\\text{ref}} + n_{\\mathrm{D}} E_{\\mathrm{D}}^{\\text{ref}} $$\nSubstituting the given values:\n$$ E_{\\text{ref}}^{\\text{total}} = 32(-8.123 \\text{ eV}) + 32(-7.987 \\text{ eV}) + 32(-8.541 \\text{ eV}) + 32(-8.256 \\text{ eV}) $$\n$$ E_{\\text{ref}}^{\\text{total}} = 32 \\times (-8.123 - 7.987 - 8.541 - 8.256) \\text{ eV} $$\n$$ E_{\\text{ref}}^{\\text{total}} = 32 \\times (-32.907) \\text{ eV} $$\n$$ E_{\\text{ref}}^{\\text{total}} = -1053.024 \\text{ eV} $$\n\nNext, we calculate the formation enthalpy for the supercell, $\\Delta H_{\\text{form}}^{\\text{cell}}$:\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = E_{\\mathrm{tot}}^{\\text{cell}} - E_{\\text{ref}}^{\\text{total}} $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -1059.168 \\text{ eV} - (-1053.024 \\text{ eV}) $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -1059.168 \\text{ eV} + 1053.024 \\text{ eV} $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -6.144 \\text{ eV} $$\n\nThe problem asks for the formation enthalpy per atom, which we denote as $\\Delta H_{\\text{form}}$. This is obtained by dividing the supercell formation enthalpy by the total number of atoms, $N$.\n$$ \\Delta H_{\\text{form}} = \\frac{\\Delta H_{\\text{form}}^{\\text{cell}}}{N} $$\nThe total number of atoms is $N = n_{\\mathrm{A}} + n_{\\mathrm{B}} + n_{\\mathrm{C}} + n_{\\mathrm{D}} = 32 + 32 + 32 + 32 = 128$.\n$$ \\Delta H_{\\text{form}} = \\frac{-6.144 \\text{ eV}}{128 \\text{ atoms}} $$\n$$ \\Delta H_{\\text{form}} = -0.048 \\text{ eV/atom} $$\n\nFinally, we must convert the result to units of millielectron-volts per atom (meV/atom) and round to four significant figures.\n$1 \\text{ eV} = 1000 \\text{ meV}$.\n$$ \\Delta H_{\\text{form}} = -0.048 \\frac{\\text{eV}}{\\text{atom}} \\times \\frac{1000 \\text{ meV}}{1 \\text{ eV}} $$\n$$ \\Delta H_{\\text{form}} = -48 \\text{ meV/atom} $$\nThe value $-48$ has two significant figures. To express this result with four significant figures, we add trailing zeros after the decimal point.\n$$ \\Delta H_{\\text{form}} = -48.00 \\text{ meV/atom} $$\nThe negative sign indicates that the formation of the alloy from its elemental constituents is an exothermic process, meaning the alloy is thermodynamically stable with respect to phase separation into its pure components at $T=0$.",
            "answer": "$$\\boxed{-48.00}$$"
        },
        {
            "introduction": "The accuracy of formation enthalpy calculations hinges on a physically meaningful choice of elemental reference states. This practice problem delves into a critical detail for magnetic alloys, highlighting how an inconsistent choice of magnetic ordering for the reference elements can introduce significant, non-physical errors . Understanding this principle is crucial for obtaining reliable predictions of stability in complex magnetic systems like many high-entropy alloys.",
            "id": "3732172",
            "problem": "In atomistic modeling of high-entropy alloys using Density Functional Theory (DFT), the thermodynamic formation enthalpy is defined relative to elemental reference states at the same thermodynamic conditions. Consider an equiatomic alloy of five $3d$ transition metals: iron $\\mathrm{(Fe)}$, cobalt $\\mathrm{(Co)}$, nickel $\\mathrm{(Ni)}$, chromium $\\mathrm{(Cr)}$, and manganese $\\mathrm{(Mn)}$, intended to represent a high-temperature disordered paramagnetic state. The calculation is performed at pressure $P \\approx 0$, and the per-atom enthalpy of solids is approximated by the per-atom total energy in electron volt $\\mathrm{(eV)}$. The alloy is modeled as paramagnetic (PM), while the elemental reference energies can be taken in different magnetic orders: ferromagnetic (FM), antiferromagnetic (AFM), or paramagnetic (PM). The following DFT per-atom total energies are available:\n$\\mathrm{Fe}$: $E^{\\mathrm{FM}}_{\\mathrm{Fe}} = -8.20 \\ \\mathrm{eV}$, $E^{\\mathrm{PM}}_{\\mathrm{Fe}} = -8.05 \\ \\mathrm{eV}$;\n$\\mathrm{Co}$: $E^{\\mathrm{FM}}_{\\mathrm{Co}} = -8.15 \\ \\mathrm{eV}$, $E^{\\mathrm{PM}}_{\\mathrm{Co}} = -8.04 \\ \\mathrm{eV}$;\n$\\mathrm{Ni}$: $E^{\\mathrm{FM}}_{\\mathrm{Ni}} = -7.80 \\ \\mathrm{eV}$, $E^{\\mathrm{PM}}_{\\mathrm{Ni}} = -7.74 \\ \\mathrm{eV}$;\n$\\mathrm{Cr}$: $E^{\\mathrm{AFM}}_{\\mathrm{Cr}} = -9.20 \\ \\mathrm{eV}$, $E^{\\mathrm{PM}}_{\\mathrm{Cr}} = -9.15 \\ \\mathrm{eV}$;\n$\\mathrm{Mn}$: $E^{\\mathrm{AFM}}_{\\mathrm{Mn}} = -8.95 \\ \\mathrm{eV}$, $E^{\\mathrm{PM}}_{\\mathrm{Mn}} = -8.85 \\ \\mathrm{eV}$.\nThe equiatomic alloy in the disordered paramagnetic state has per-atom total energy $E^{\\mathrm{PM}}_{\\mathrm{alloy}} = -8.60 \\ \\mathrm{eV}$.\nWhich option best explains, on a first-principles basis, why the magnetic ordering of the elemental references must be matched to the alloy’s intended state to avoid spurious contributions to the formation enthalpy, and what is the magnitude and sign of the spurious contribution per atom if one mistakenly uses $\\mathrm{FM}$ references for $\\mathrm{Fe}$, $\\mathrm{Co}$, $\\mathrm{Ni}$ and $\\mathrm{AFM}$ references for $\\mathrm{Cr}$, $\\mathrm{Mn}$ instead of the $\\mathrm{PM}$ references?\n\nA. Using ordered elemental references instead of paramagnetic ones introduces a spurious increase of about $+0.094 \\ \\mathrm{eV}$ per atom into the computed formation enthalpy, because enthalpy is a state function and magnetic exchange contributions only cancel when elemental references and the alloy share the same magnetic state.\n\nB. No spurious contribution arises; spin polarization does not affect enthalpy differences in Density Functional Theory.\n\nC. The spurious contribution is approximately $-0.094 \\ \\mathrm{eV}$ per atom, since subtracting lower-energy ordered references makes the alloy appear more stable.\n\nD. Only iron matters; the error is about $+0.030 \\ \\mathrm{eV}$ per atom, corresponding to the iron difference divided by five.\n\nE. The error equals the sum of per-element differences, about $+0.470 \\ \\mathrm{eV}$ per atom, because the formation enthalpy adds all elemental energies without compositional weighting.",
            "solution": "The problem is scientifically valid, well-posed, and requires understanding the subtle but critical concept of reference states in calculating formation enthalpies, especially for systems with complex magnetic behavior like high-entropy alloys.\n\nThe goal is to calculate the spurious contribution to the formation enthalpy that arises from using an inconsistent set of elemental references. The formation enthalpy per atom ($\\Delta E_f$) is defined as the difference between the alloy's per-atom energy and the compositionally-weighted average of the elemental reference energies:\n$$ \\Delta E_f = E_{\\text{alloy}}^{\\text{PM}} - E_{\\text{ref, avg}} $$\nwhere $E_{\\text{ref, avg}} = \\sum_i x_i E_{\\text{element}, i}^{\\text{ref}}$. Here, $x_i = 1/5$ for each of the five elements.\n\nTo isolate the energy of mixing in the paramagnetic (PM) state, the thermodynamically correct reference state for the elements should also be the (hypothetical) paramagnetic state. Using the ground-state magnetic ordering (FM for Fe, Co, Ni; AFM for Cr, Mn) conflates the mixing energy with the energy required to magnetically disorder the pure elements.\n\nThe spurious contribution ($\\delta E_f$) is the difference between the formation enthalpy calculated with the mistaken references and the one calculated with the correct references:\n$$ \\delta E_f = \\Delta E_f^{\\text{mistaken}} - \\Delta E_f^{\\text{correct}} $$\n$$ \\delta E_f = (E_{\\text{alloy}}^{\\text{PM}} - E_{\\text{ref, avg}}^{\\text{mistaken}}) - (E_{\\text{alloy}}^{\\text{PM}} - E_{\\text{ref, avg}}^{\\text{correct}}) $$\n$$ \\delta E_f = E_{\\text{ref, avg}}^{\\text{correct}} - E_{\\text{ref, avg}}^{\\text{mistaken}} $$\n\n1.  **Calculate the correct average reference energy ($E_{\\text{ref, avg}}^{\\text{correct}}$)** using the paramagnetic (PM) elemental energies:\n    $$ E_{\\text{ref, avg}}^{\\text{correct}} = \\frac{1}{5} (E_{\\mathrm{Fe}}^{\\mathrm{PM}} + E_{\\mathrm{Co}}^{\\mathrm{PM}} + E_{\\mathrm{Ni}}^{\\mathrm{PM}} + E_{\\mathrm{Cr}}^{\\mathrm{PM}} + E_{\\mathrm{Mn}}^{\\mathrm{PM}}) $$\n    $$ E_{\\text{ref, avg}}^{\\text{correct}} = \\frac{1}{5} (-8.05 - 8.04 - 7.74 - 9.15 - 8.85) \\ \\mathrm{eV} $$\n    $$ E_{\\text{ref, avg}}^{\\text{correct}} = \\frac{-41.83}{5} \\ \\mathrm{eV} = -8.366 \\ \\mathrm{eV} $$\n\n2.  **Calculate the mistaken average reference energy ($E_{\\text{ref, avg}}^{\\text{mistaken}}$)** using the ground-state ordered (FM/AFM) elemental energies:\n    $$ E_{\\text{ref, avg}}^{\\text{mistaken}} = \\frac{1}{5} (E_{\\mathrm{Fe}}^{\\mathrm{FM}} + E_{\\mathrm{Co}}^{\\mathrm{FM}} + E_{\\mathrm{Ni}}^{\\mathrm{FM}} + E_{\\mathrm{Cr}}^{\\mathrm{AFM}} + E_{\\mathrm{Mn}}^{\\mathrm{AFM}}) $$\n    $$ E_{\\text{ref, avg}}^{\\text{mistaken}} = \\frac{1}{5} (-8.20 - 8.15 - 7.80 - 9.20 - 8.95) \\ \\mathrm{eV} $$\n    $$ E_{\\text{ref, avg}}^{\\text{mistaken}} = \\frac{-42.30}{5} \\ \\mathrm{eV} = -8.460 \\ \\mathrm{eV} $$\n\n3.  **Calculate the spurious contribution ($\\delta E_f$):**\n    $$ \\delta E_f = (-8.366 \\ \\mathrm{eV}) - (-8.460 \\ \\mathrm{eV}) = +0.094 \\ \\mathrm{eV} $$\n\nThe spurious contribution is a positive value of $+0.094 \\ \\mathrm{eV}$ per atom. This means that using the more stable (lower energy) ordered ground-state references artificially increases the calculated formation enthalpy, making the alloy appear less stable than it would be relative to its constituent elements in a comparable paramagnetic state.\n\n*   **Option A** correctly identifies the sign and magnitude of the spurious contribution as $+0.094 \\ \\mathrm{eV}$ per atom and provides the correct physical reasoning. The energy of mixing can only be isolated if the reference state matches the alloy's state.\n*   **Option B** is incorrect. Spin polarization and magnetic ordering have a significant effect on total energies in DFT.\n*   **Option C** has the wrong sign. Using a lower-energy reference makes the *difference* ($E_{\\text{alloy}} - E_{\\text{ref}}$) larger (more positive), not smaller.\n*   **Option D** is incorrect because the error comes from all elements that have different energies in their ordered and PM states.\n*   **Option E** is incorrect because it neglects the compositional weighting ($1/5$ for each element) required for a per-atom quantity.\n\nTherefore, option A is the only correct choice.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from thermodynamic stability to mechanical properties, this exercise simulates a complete computational workflow for determining elastic constants using the stress-strain method. You will implement a least-squares fitting procedure to extract the cubic elastic constants ($C_{11}$, $C_{12}$, and $C_{44}$) from a synthetic DFT dataset, observing the important physical difference between clamped-ion and relaxed-ion results . This practice bridges theory and application by translating fundamental equations into a practical computational tool.",
            "id": "3732147",
            "problem": "You are asked to write a complete program that implements the stress–strain method for extracting elastic stiffness constants and computes formation enthalpies per atom, in the context of Density Functional Theory (DFT) modeling of high-entropy alloys. The method must start from the small-strain linear elasticity relation and the thermodynamic definition of formation enthalpy. The program should take a provided test suite of strain–stress pairs and total energies and produce numerically verified results with specified units and format.\n\nThe fundamental base to use is:\n- Small-strain linear elasticity (Hooke’s law): $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$, where $\\,\\boldsymbol{\\sigma}\\,$ is the Cauchy stress tensor, $\\,\\boldsymbol{\\varepsilon}\\,$ is the infinitesimal strain tensor, and $\\,\\mathbf{C}\\,$ is the fourth-order elastic stiffness tensor. In Voigt notation for cubic symmetry, only $\\,C_{11}\\,$, $\\,C_{12}\\,$, and $\\,C_{44}\\,$ are independent, and the shear components use engineering shear strain $\\,\\gamma = 2 \\varepsilon_{\\text{shear}}\\,$.\n- Formation enthalpy per atom definition: $\\,\\Delta H_f = E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} - \\sum_i x_i \\mu_i\\,$, where $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}}\\,$ is the DFT total energy per atom of the multi-component phase, $\\,x_i\\,$ is the atomic fraction of element $\\,i\\,$, and $\\,\\mu_i\\,$ is the per-atom reference energy (chemical potential) of pure element $\\,i\\,$ in its stable phase.\n\nYour tasks:\n- Implement a least-squares estimator for $\\,C_{11}\\,$, $\\,C_{12}\\,$, and $\\,C_{44}\\,$ using the provided strain–stress dataset. Treat the clamped-ion (no internal relaxation) and relaxed-ion (internal coordinates relaxed at each applied strain) datasets separately to obtain two sets of elastic constants in units of gigapascal ($\\mathrm{GPa}$). The need to relax internal coordinates for accurate results must be reflected by the different fitted values between clamped-ion and relaxed-ion data.\n- Implement formation enthalpy per atom calculations for provided alloy compositions using the definition above, expressed in electronvolt per atom ($\\mathrm{eV/atom}$).\n\nUse the following test suite. In all items below, strains are dimensionless and stresses are in $\\mathrm{GPa}$. Voigt strain vector ordering is $\\,\\left[\\varepsilon_{xx},\\varepsilon_{yy},\\varepsilon_{zz},\\gamma_{yz},\\gamma_{xz},\\gamma_{xy}\\right]\\,$, and stress vector ordering is $\\,\\left[\\sigma_{xx},\\sigma_{yy},\\sigma_{zz},\\sigma_{yz},\\sigma_{xz},\\sigma_{xy}\\right]\\,$. The clamped-ion and relaxed-ion stress readings are synthetic DFT outputs assumed to be taken after electronic relaxation, with relaxed-ion including internal coordinate relaxation.\n\n- Strain–stress dataset for a hypothetical cubic high-entropy alloy:\n  - Uniaxial strain along $\\,x\\,$ with $\\,\\varepsilon_{xx} = \\delta\\,$:\n    - Case $\\,\\delta = 0.005\\,$: strain $\\,\\left[0.005,0,0,0,0,0\\right]\\,$\n      - Clamped-ion stress $\\,\\left[1.15,\\,0.675,\\,0.675,\\,0,\\,0,\\,0\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[1.10,\\,0.625,\\,0.625,\\,0,\\,0,\\,0\\right]\\,$\n    - Case $\\,\\delta = 0.010\\,$: strain $\\,\\left[0.010,0,0,0,0,0\\right]\\,$\n      - Clamped-ion stress $\\,\\left[2.30,\\,1.35,\\,1.35,\\,0,\\,0,\\,0\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[2.20,\\,1.25,\\,1.25,\\,0,\\,0,\\,0\\right]\\,$\n    - Case $\\,\\delta = 0.000\\,$ (boundary condition): strain $\\,\\left[0.000,0,0,0,0,0\\right]\\,$\n      - Clamped-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n  - Pure shear on $\\,xy\\,$ with engineering shear strain $\\,\\gamma = 2 \\varepsilon_{xy}\\,$:\n    - Case $\\,\\gamma = 0.004\\,$: strain $\\,\\left[0,0,0,0,0,0.004\\right]\\,$\n      - Clamped-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.48\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.44\\right]\\,$\n    - Case $\\,\\gamma = 0.008\\,$: strain $\\,\\left[0,0,0,0,0,0.008\\right]\\,$\n      - Clamped-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.96\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.88\\right]\\,$\n  - Hydrostatic strain $\\,\\varepsilon_{xx} = \\varepsilon_{yy} = \\varepsilon_{zz} = \\delta_h\\,$:\n    - Case $\\,\\delta_h = 0.003\\,$: strain $\\,\\left[0.003,0.003,0.003,0,0,0\\right]\\,$\n      - Clamped-ion stress $\\,\\left[1.50,\\,1.50,\\,1.50,\\,0,\\,0,\\,0\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[1.41,\\,1.41,\\,1.41,\\,0,\\,0,\\,0\\right]\\,$\n  - Orthorhombic volume-conserving strain $\\,\\varepsilon_{xx} = \\delta_o\\,$, $\\,\\varepsilon_{yy} = -\\delta_o\\,$, $\\,\\varepsilon_{zz} = 0\\,$:\n    - Case $\\,\\delta_o = 0.006\\,$: strain $\\,\\left[0.006,-0.006,0,0,0,0\\right]\\,$\n      - Clamped-ion stress $\\,\\left[0.57,\\,-0.57,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n      - Relaxed-ion stress $\\,\\left[0.57,\\,-0.57,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n\n- Formation enthalpy dataset. Reference elemental per-atom energies (chemical potentials) are:\n  - $\\,\\mu_{\\mathrm{A}} = -4.00\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{C}} = -3.50\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{D}} = -4.50\\,\\mathrm{eV/atom}\\,$\n  Test compositions and total energies per atom:\n  - Case $\\,1\\,$ (equiatomic quaternary): $\\,x_{\\mathrm{A}} = 0.25\\,$, $\\,x_{\\mathrm{B}} = 0.25\\,$, $\\,x_{\\mathrm{C}} = 0.25\\,$, $\\,x_{\\mathrm{D}} = 0.25\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.30\\,\\mathrm{eV/atom}\\,$\n  - Case $\\,2\\,$ (ternary, non-equiatomic): $\\,x_{\\mathrm{A}} = 0.50\\,$, $\\,x_{\\mathrm{B}} = 0.30\\,$, $\\,x_{\\mathrm{C}} = 0.20\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.35\\,\\mathrm{eV/atom}\\,$\n  - Case $\\,3\\,$ (pure element edge case): $\\,x_{\\mathrm{B}} = 1.00\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -5.00\\,\\mathrm{eV/atom}\\,$\n\nRequirements:\n- Compute $\\,C_{11}\\,$, $\\,C_{12}\\,$, and $\\,C_{44}\\,$ in $\\mathrm{GPa}$ separately for clamped-ion and relaxed-ion datasets using a principled least-squares approach that enforces the cubic symmetry structure in Voigt form.\n- Compute $\\,\\Delta H_f\\,$ for each formation enthalpy case in $\\mathrm{eV/atom}\\,$. Express the results as floats. Do not use a percentage sign for any quantity.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, of the form $\\,\\left[\\left[\\Delta H_1,\\Delta H_2,\\Delta H_3\\right],\\left[C_{11}^{\\text{clamped}},C_{12}^{\\text{clamped}},C_{44}^{\\text{clamped}}\\right],\\left[C_{11}^{\\text{relaxed}},C_{12}^{\\text{relaxed}},C_{44}^{\\text{relaxed}}\\right]\\right]\\,$.\n- Express stresses and elastic constants in $\\mathrm{GPa}$ and formation enthalpies in $\\mathrm{eV/atom}$, with values printed as floating-point numbers.\n\nCoverage in the test suite:\n- Happy path estimation with multiple strain modes.\n- Shear-only cases to isolate $\\,C_{44}\\,$.\n- Hydrostatic case to constrain volumetric response.\n- Boundary strain case $\\,\\delta = 0\\,$ to verify zero-stress behavior.\n- Formation enthalpy edge case where a pure element has zero formation enthalpy by definition.\n\nNo external inputs are required; the program must be self-contained and execute deterministically.",
            "solution": "The problem requires the implementation of two distinct calculations common in computational materials science: the determination of elastic constants from stress-strain data and the calculation of formation enthalpies from total energy data. The validity of the problem has been confirmed, as it is scientifically grounded, self-contained, and well-posed. We will proceed with a systematic solution.\n\n### Part 1: Calculation of Formation Enthalpy ($\\Delta H_f$)\n\nThe formation enthalpy per atom, $\\Delta H_f$, is defined as the difference between the total energy per atom of the alloyed phase and the weighted average of the chemical potentials of its constituent elements in their stable reference phases. The governing equation is:\n$$\n\\Delta H_f = \\frac{E_{\\text{tot}}^{\\text{phase}}}{N_{\\text{atoms}}} - \\sum_i x_i \\mu_i\n$$\nwhere $E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}}$ is the total energy per atom of the alloy, $x_i$ is the atomic fraction of element $i$, and $\\mu_i$ is the reference energy (chemical potential) per atom of pure element $i$. The sum $\\sum_i x_i \\mu_i$ represents the energy of a mechanical mixture of the constituents.\n\nThe provided reference energies are:\n- $\\mu_{\\mathrm{A}} = -4.00\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{C}} = -3.50\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{D}} = -4.50\\,\\mathrm{eV/atom}$\n\nWe calculate $\\Delta H_f$ for the three given cases:\n\n**Case 1: Equiatomic Quaternary Alloy**\n- Composition: $x_{\\mathrm{A}} = 0.25$, $x_{\\mathrm{B}} = 0.25$, $x_{\\mathrm{C}} = 0.25$, $x_{\\mathrm{D}} = 0.25$\n- Total energy per atom: $E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.30\\,\\mathrm{eV/atom}$\n- The weighted sum of reference energies is:\n$$\n\\sum_i x_i \\mu_i = (0.25 \\times -4.00) + (0.25 \\times -5.00) + (0.25 \\times -3.50) + (0.25 \\times -4.50) = 0.25 \\times (-17.00) = -4.25\\,\\mathrm{eV/atom}\n$$\n- The formation enthalpy is:\n$$\n\\Delta H_{f,1} = (-4.30) - (-4.25) = -0.05\\,\\mathrm{eV/atom}\n$$\n\n**Case 2: Ternary Alloy**\n- Composition: $x_{\\mathrm{A}} = 0.50$, $x_{\\mathrm{B}} = 0.30$, $x_{\\mathrm{C}} = 0.20$\n- Total energy per atom: $E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.35\\,\\mathrm{eV/atom}$\n- The weighted sum of reference energies is:\n$$\n\\sum_i x_i \\mu_i = (0.50 \\times -4.00) + (0.30 \\times -5.00) + (0.20 \\times -3.50) = -2.00 - 1.50 - 0.70 = -4.20\\,\\mathrm{eV/atom}\n$$\n- The formation enthalpy is:\n$$\n\\Delta H_{f,2} = (-4.35) - (-4.20) = -0.15\\,\\mathrm{eV/atom}\n$$\n\n**Case 3: Pure Element**\n- Composition: $x_{\\mathrm{B}} = 1.00$\n- Total energy per atom: $E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -5.00\\,\\mathrm{eV/atom}$\n- The weighted sum of reference energies is simply:\n$$\n\\sum_i x_i \\mu_i = 1.00 \\times \\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}\n$$\n- The formation enthalpy is:\n$$\n\\Delta H_{f,3} = (-5.00) - (-5.00) = 0.00\\,\\mathrm{eV/atom}\n$$\nThis result correctly shows that the formation enthalpy of a pure element in its reference state is zero by definition.\n\n### Part 2: Calculation of Elastic Constants ($C_{ij}$)\n\nThe elastic constants are determined from the linear relationship between stress and strain (Hooke's Law), $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}$. For a material with cubic symmetry, this relationship can be expressed in Voigt notation using a $6 \\times 6$ stiffness matrix $\\mathbf{C}$ with three independent elastic constants: $C_{11}$, $C_{12}$, and $C_{44}$. The strain vector uses engineering shear strains, e.g., $\\varepsilon_6 = \\gamma_{xy}$.\n$$\n\\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\\\\nC_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\\\\nC_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{44} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & C_{44}\n\\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\\\ \\varepsilon_4 \\\\ \\varepsilon_5 \\\\ \\varepsilon_6 \\end{pmatrix}\n$$\nwhere the indices are $1 \\leftrightarrow xx, 2 \\leftrightarrow yy, 3 \\leftrightarrow zz, 4 \\leftrightarrow yz, 5 \\leftrightarrow xz, 6 \\leftrightarrow xy$.\n\nThis system of equations can be written as a linear model $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$, where $\\mathbf{y}$ is a vector of observed stress components, $\\boldsymbol{\\beta} = [C_{11}, C_{12}, C_{44}]^T$ is the vector of unknown constants, and $\\mathbf{X}$ is the design matrix constructed from the strain components. For each stress component $\\sigma_i$, we can write a linear equation in terms of the parameters $\\boldsymbol{\\beta}$. For instance:\n- $\\sigma_1 = C_{11}\\varepsilon_1 + C_{12}(\\varepsilon_2 + \\varepsilon_3)$\n- $\\sigma_2 = C_{11}\\varepsilon_2 + C_{12}(\\varepsilon_1 + \\varepsilon_3)$\n- $\\sigma_3 = C_{11}\\varepsilon_3 + C_{12}(\\varepsilon_1 + \\varepsilon_2)$\n- $\\sigma_4 = C_{44}\\varepsilon_4$, $\\sigma_5 = C_{44}\\varepsilon_5$, $\\sigma_6 = C_{44}\\varepsilon_6$\n\nThese can be mapped to rows of the matrix $\\mathbf{X}$. For example, the equation for $\\sigma_1$ corresponds to a row $[\\varepsilon_1, \\varepsilon_2 + \\varepsilon_3, 0]$ in $\\mathbf{X}$ and a value of $\\sigma_1$ in $\\mathbf{y}$. By aggregating all non-trivial stress-strain relations from the provided dataset, we construct an overdetermined system. The best-fit values for $\\boldsymbol{\\beta}$ are found using the method of linear least squares, whose solution is given by $\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$.\n\nWe apply this procedure separately for the clamped-ion and relaxed-ion datasets.\n\n**Clamped-Ion Elastic Constants ($C_{ij}^{\\text{clamped}}$)**\nThe provided dataset for clamped-ion stresses is perfectly linear and consistent across different strain modes.\n- From uniaxial strain ($\\varepsilon_1 = 0.005$): $\\sigma_1 = 1.15\\,\\mathrm{GPa}$ and $\\sigma_2 = 0.675\\,\\mathrm{GPa}$. This directly implies $C_{11} = 1.15/0.005 = 230\\,\\mathrm{GPa}$ and $C_{12} = 0.675/0.005 = 135\\,\\mathrm{GPa}$.\n- From shear strain ($\\varepsilon_6 = 0.004$): $\\sigma_6 = 0.48\\,\\mathrm{GPa}$. This implies $C_{44} = 0.48/0.004 = 120\\,\\mathrm{GPa}$.\n- These values are confirmed by the other strain modes. For example, for hydrostatic strain, the bulk modulus is $K = (C_{11} + 2C_{12})/3$. The pressure is $P = -(\\sigma_1+\\sigma_2+\\sigma_3)/3 = -1.50\\,\\mathrm{GPa}$ for a volume strain of $\\Delta V/V = 3\\delta_h=0.009$. So $K= -P/(\\Delta V/V) \\approx 1.50/0.009 \\approx 166.67\\,\\mathrm{GPa}$. From our constants, $(230 + 2 \\times 135)/3 = 500/3 \\approx 166.67\\,\\mathrm{GPa}$.\nThe full least-squares fit on all data points yields:\n$$\nC_{11}^{\\text{clamped}} = 230.0\\,\\mathrm{GPa}, \\quad C_{12}^{\\text{clamped}} = 135.0\\,\\mathrm{GPa}, \\quad C_{44}^{\\text{clamped}} = 120.0\\,\\mathrm{GPa}\n$$\n\n**Relaxed-Ion Elastic Constants ($C_{ij}^{\\text{relaxed}}$)**\nSimilarly, for the relaxed-ion dataset, which accounts for the relaxation of internal atomic coordinates under strain:\n- From uniaxial strain ($\\varepsilon_1 = 0.005$): $\\sigma_1 = 1.10\\,\\mathrm{GPa}$ and $\\sigma_2 = 0.625\\,\\mathrm{GPa}$, implying $C_{11} = 1.10/0.005 = 220\\,\\mathrm{GPa}$ and $C_{12} = 0.625/0.005 = 125\\,\\mathrm{GPa}$.\n- From shear strain ($\\varepsilon_6 = 0.004$): $\\sigma_6 = 0.44\\,\\mathrm{GPa}$, implying $C_{44} = 0.44/0.004 = 110\\,\\mathrm{GPa}$.\n- These values are also consistent across all applied strain modes in the relaxed-ion dataset. The relaxation of atomic positions allows the material to accommodate strain more easily, resulting in lower stresses and thus smaller elastic constants compared to the clamped-ion case, which is a physically correct behavior.\nThe full least-squares fit yields:\n$$\nC_{11}^{\\text{relaxed}} = 220.0\\,\\mathrm{GPa}, \\quad C_{12}^{\\text{relaxed}} = 125.0\\,\\mathrm{GPa}, \\quad C_{44}^{\\text{relaxed}} = 110.0\\,\\mathrm{GPa}\n$$\n\nThe final results are compiled into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute formation enthalpies and elastic constants.\n    \"\"\"\n\n    # --- Part 1: Calculation of Formation Enthalpy ---\n\n    # Define elemental reference energies (chemical potentials)\n    mu_refs = {\n        'A': -4.00,  # eV/atom\n        'B': -5.00,  # eV/atom\n        'C': -3.50,  # eV/atom\n        'D': -4.50   # eV/atom\n    }\n\n    # Define test cases for formation enthalpy\n    enthalpy_cases = [\n        # Case 1: Equiatomic quaternary\n        ({'A': 0.25, 'B': 0.25, 'C': 0.25, 'D': 0.25}, -4.30),\n        # Case 2: Ternary, non-equiatomic\n        ({'A': 0.50, 'B': 0.30, 'C': 0.20}, -4.35),\n        # Case 3: Pure element edge case\n        ({'B': 1.00}, -5.00),\n    ]\n\n    hf_results = []\n    for composition, total_energy_per_atom in enthalpy_cases:\n        # Calculate the weighted sum of reference energies\n        sum_xi_mui = sum(\n            fraction * mu_refs[element]\n            for element, fraction in composition.items()\n        )\n        # Calculate the formation enthalpy\n        delta_hf = total_energy_per_atom - sum_xi_mui\n        hf_results.append(delta_hf)\n\n    # --- Part 2: Calculation of Elastic Constants ---\n\n    # Define the strain-stress dataset\n    # Strain vector: [exx, eyy, ezz, gyz, gxz, gxy]\n    # Stress vector: [sxx, syy, szz, syz, sxz, sxy] (GPa)\n    strain_stress_data = [\n        # Uniaxial strain\n        {'strain': [0.005, 0, 0, 0, 0, 0], 'clamped': [1.15, 0.675, 0.675, 0, 0, 0], 'relaxed': [1.10, 0.625, 0.625, 0, 0, 0]},\n        {'strain': [0.010, 0, 0, 0, 0, 0], 'clamped': [2.30, 1.35, 1.35, 0, 0, 0], 'relaxed': [2.20, 1.25, 1.25, 0, 0, 0]},\n        # Pure shear\n        {'strain': [0, 0, 0, 0, 0, 0.004], 'clamped': [0, 0, 0, 0, 0, 0.48], 'relaxed': [0, 0, 0, 0, 0, 0.44]},\n        {'strain': [0, 0, 0, 0, 0, 0.008], 'clamped': [0, 0, 0, 0, 0, 0.96], 'relaxed': [0, 0, 0, 0, 0, 0.88]},\n        # Hydrostatic strain\n        {'strain': [0.003, 0.003, 0.003, 0, 0, 0], 'clamped': [1.50, 1.50, 1.50, 0, 0, 0], 'relaxed': [1.41, 1.41, 1.41, 0, 0, 0]},\n        # Orthorhombic strain\n        {'strain': [0.006, -0.006, 0, 0, 0, 0], 'clamped': [0.57, -0.57, 0, 0, 0, 0], 'relaxed': [0.57, -0.57, 0, 0, 0, 0]},\n        # Zero strain (boundary condition) - will result in trivial 0=0 equations, included for completeness but won't affect fit\n        {'strain': [0, 0, 0, 0, 0, 0], 'clamped': [0, 0, 0, 0, 0, 0], 'relaxed': [0, 0, 0, 0, 0, 0]},\n    ]\n    \n    def calculate_elastic_constants(data, ion_state):\n        \"\"\"\n        Calculates C11, C12, C44 using linear least squares from strain-stress data.\n        \"\"\"\n        X = []  # Design matrix\n        y = []  # Observation vector (stresses)\n\n        # The linear relations for cubic symmetry in Voigt notation:\n        # s1 = C11*e1 + C12*(e2+e3)\n        # s2 = C11*e2 + C12*(e1+e3)\n        # s3 = C11*e3 + C12*(e1+e2)\n        # s4 = C44*e4\n        # s5 = C44*e5\n        # s6 = C44*e6\n        # The parameters to fit are beta = [C11, C12, C44]\n        \n        for item in data:\n            strain = item['strain']\n            stress = item[ion_state]\n            \n            e1, e2, e3, e4, e5, e6 = strain\n            s1, s2, s3, s4, s5, s6 = stress\n\n            # Add rows to X and y for each non-zero stress component\n            if s1 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e1, e2 + e3, 0])\n                y.append(s1)\n            if s2 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e2, e1 + e3, 0])\n                y.append(s2)\n            if s3 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e3, e1 + e2, 0])\n                y.append(s3)\n            if s4 != 0 or e4 != 0:\n                X.append([0, 0, e4])\n                y.append(s4)\n            if s5 != 0 or e5 != 0:\n                X.append([0, 0, e5])\n                y.append(s5)\n            if s6 != 0 or e6 != 0:\n                X.append([0, 0, e6])\n                y.append(s6)\n        \n        X_matrix = np.array(X)\n        y_vector = np.array(y)\n        \n        # Solve the linear least squares problem y = X * beta\n        # rcond=None to use the machine-precision default\n        constants, _, _, _ = np.linalg.lstsq(X_matrix, y_vector, rcond=None)\n        \n        return constants.tolist()\n\n    c_clamped_results = calculate_elastic_constants(strain_stress_data, 'clamped')\n    c_relaxed_results = calculate_elastic_constants(strain_stress_data, 'relaxed')\n\n    # --- Part 3: Format and Print Final Output ---\n    \n    # Format the lists into strings without spaces\n    str_hf = f\"[{','.join(map(str, hf_results))}]\"\n    str_c_clamped = f\"[{','.join(f'{c:.1f}' for c in c_clamped_results)}]\"\n    str_c_relaxed = f\"[{','.join(f'{c:.1f}' for c in c_relaxed_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(f\"[{str_hf},{str_c_clamped},{str_c_relaxed}]\")\n\nsolve()\n```"
        }
    ]
}