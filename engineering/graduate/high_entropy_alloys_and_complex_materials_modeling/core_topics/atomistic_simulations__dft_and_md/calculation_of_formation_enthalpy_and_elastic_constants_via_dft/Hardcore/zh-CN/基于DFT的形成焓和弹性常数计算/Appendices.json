{
    "hands_on_practices": [
        {
            "introduction": "本次练习将聚焦于计算材料科学中的一项基石计算：确定合金的生成焓。生成焓是衡量材料热力学稳定性的首要指标。通过完成这项练习 ，您将学会如何利用密度泛函理论（DFT）计算得到的合金及其组分元素的总能量，来预测该合金相对于其纯组分分解是否稳定。",
            "id": "3732165",
            "problem": "一项关于四元等原子高熵合金的密度泛函理论(DFT)研究使用了一个在零温零压下完全弛豫的含$N$个原子的超胞。该超胞包含 $N=\\!128$ 个原子，其中 $n_{\\mathrm{A}}=\\!32$，$n_{\\mathrm{B}}=\\!32$，$n_{\\mathrm{C}}=\\!32$，$n_{\\mathrm{D}}=\\!32$。据报告，弛豫后的合金超胞的总能量为 $E_{\\mathrm{tot}}^{\\text{cell}}=\\!-1059.168$ eV。元素参考态是零温零压下的基态晶体结构，其DFT计算的单原子能量分别为 $E_{\\mathrm{A}}^{\\text{ref}}=\\!-8.123$ eV，$E_{\\mathrm{B}}^{\\text{ref}}=\\!-7.987$ eV，$E_{\\mathrm{C}}^{\\text{ref}}=\\!-8.541$ eV 和 $E_{\\mathrm{D}}^{\\text{ref}}=\\!-8.256$ eV。\n\n仅使用适用于零温零压的标准热力学定义，计算该合金相对于这些元素参考态的单原子生成焓。请以每原子毫电子伏特（meV/atom）为单位表示您的最终答案，并四舍五入至四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它使用明确定义的术语并提供所有必要数据，展示了计算材料科学中的一个标准计算。\n\n化合物的生成焓 $\\Delta H_{\\text{form}}$，是指一摩尔（或在此背景下，一个化学式单位或一个原子）化合物由其处于稳定参考态的组分元素形成时的焓变。对于零温（$T=0$）零外压（$P=0$）下的理论计算，焓 $H$ 等同于内能 $U$，而内能 $U$ 由密度泛函理论(DFT)计算得到的总能量 $E_{\\mathrm{tot}}$ 给出。因此，在这些条件下，生成焓与生成能 $\\Delta E_{\\text{form}}$ 相同。\n\n整个含$N$个原子的超胞的生成焓 $\\Delta H_{\\text{form}}^{\\text{cell}}$，是通过从合金超胞的总能量中减去其组分元素在参考态下的总能量来计算的。通用公式为：\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = E_{\\mathrm{tot}}^{\\text{cell}} - \\sum_{i} n_i E_{i}^{\\text{ref}} $$\n其中 $E_{\\mathrm{tot}}^{\\text{cell}}$ 是弛豫后的合金超胞的总能量，$i$ 为组分元素的索引，$n_i$ 是超胞中元素 $i$ 的原子数，$E_{i}^{\\text{ref}}$ 是元素 $i$ 在其参考态下的单原子能量。\n\n该问题提供了以下数据：\n- 超胞中的总原子数：$N = 128$。\n- 各元素的原子数：$n_{\\mathrm{A}} = 32$，$n_{\\mathrm{B}} = 32$，$n_{\\mathrm{C}} = 32$，$n_{\\mathrm{D}} = 32$。\n- 合金超胞的总能量：$E_{\\mathrm{tot}}^{\\text{cell}} = -1059.168 \\text{ eV}$。\n- 单原子参考能量：\n  - $E_{\\mathrm{A}}^{\\text{ref}} = -8.123 \\text{ eV}$\n  - $E_{\\mathrm{B}}^{\\text{ref}} = -7.987 \\text{ eV}$\n  - $E_{\\mathrm{C}}^{\\text{ref}} = -8.541 \\text{ eV}$\n  - $E_{\\mathrm{D}}^{\\text{ref}} = -8.256 \\text{ eV}$\n\n首先，我们计算与超胞成分相对应的参考元素的总能量 $E_{\\text{ref}}^{\\text{total}}$：\n$$ E_{\\text{ref}}^{\\text{total}} = n_{\\mathrm{A}} E_{\\mathrm{A}}^{\\text{ref}} + n_{\\mathrm{B}} E_{\\mathrm{B}}^{\\text{ref}} + n_{\\mathrm{C}} E_{\\mathrm{C}}^{\\text{ref}} + n_{\\mathrm{D}} E_{\\mathrm{D}}^{\\text{ref}} $$\n代入给定值：\n$$ E_{\\text{ref}}^{\\text{total}} = 32(-8.123 \\text{ eV}) + 32(-7.987 \\text{ eV}) + 32(-8.541 \\text{ eV}) + 32(-8.256 \\text{ eV}) $$\n$$ E_{\\text{ref}}^{\\text{total}} = 32 \\times (-8.123 - 7.987 - 8.541 - 8.256) \\text{ eV} $$\n$$ E_{\\text{ref}}^{\\text{total}} = 32 \\times (-32.907) \\text{ eV} $$\n$$ E_{\\text{ref}}^{\\text{total}} = -1053.024 \\text{ eV} $$\n\n接下来，我们计算超胞的生成焓 $\\Delta H_{\\text{form}}^{\\text{cell}}$：\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = E_{\\mathrm{tot}}^{\\text{cell}} - E_{\\text{ref}}^{\\text{total}} $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -1059.168 \\text{ eV} - (-1053.024 \\text{ eV}) $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -1059.168 \\text{ eV} + 1053.024 \\text{ eV} $$\n$$ \\Delta H_{\\text{form}}^{\\text{cell}} = -6.144 \\text{ eV} $$\n\n该问题要求计算单原子生成焓，我们记为 $\\Delta H_{\\text{form}}$。这可以通过将超胞生成焓除以总原子数 $N$ 得到。\n$$ \\Delta H_{\\text{form}} = \\frac{\\Delta H_{\\text{form}}^{\\text{cell}}}{N} $$\n总原子数为 $N = n_{\\mathrm{A}} + n_{\\mathrm{B}} + n_{\\mathrm{C}} + n_{\\mathrm{D}} = 32 + 32 + 32 + 32 = 128$。\n$$ \\Delta H_{\\text{form}} = \\frac{-6.144 \\text{ eV}}{128 \\text{ atoms}} $$\n$$ \\Delta H_{\\text{form}} = -0.048 \\text{ eV/atom} $$\n\n最后，我们必须将结果转换为每原子毫电子伏特（meV/atom）的单位，并四舍五入到四位有效数字。\n$1 \\text{ eV} = 1000 \\text{ meV}$。\n$$ \\Delta H_{\\text{form}} = -0.048 \\frac{\\text{eV}}{\\text{atom}} \\times \\frac{1000 \\text{ meV}}{1 \\text{ eV}} $$\n$$ \\Delta H_{\\text{form}} = -48 \\text{ meV/atom} $$\n数值 $-48$ 有两位有效数字。为了用四位有效数字表示此结果，我们在小数点后添加尾随零。\n$$ \\Delta H_{\\text{form}} = -48.00 \\text{ meV/atom} $$\n负号表示从其元素组分形成该合金是一个放热过程，这意味着该合金在 $T=0$ 时相对于相分离成其纯组分是热力学稳定的。",
            "answer": "$$\\boxed{-48.00}$$"
        },
        {
            "introduction": "除了热力学稳定性，材料的力学响应也至关重要。本练习  将指导您完成从原始应力-应变数据中计算材料基本弹性常数的全过程，模拟典型的 DFT 工作流程。您将实现一个最小二乘法拟合程序，并探索“钳定离子”（clamped-ion）和“弛豫离子”（relaxed-ion）弹性常数之间的关键物理差异，这反映了在有无内部原子弛豫情况下材料的不同响应。",
            "id": "3732147",
            "problem": "要求您编写一个完整的程序，在密度泛函理论（DFT）模拟高熵合金的背景下，实现用于提取弹性刚度常数的应力-应变方法，并计算每原子生成焓。该方法必须从微小应变线性弹性关系和生成焓的热力学定义出发。程序应接受一个提供的应变-应力对和总能量的测试套件，并以指定的单位和格式生成经过数值验证的结果。\n\n使用的基本原理是：\n- 小应变线性弹性（胡克定律）：$\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$，其中 $\\,\\boldsymbol{\\sigma}\\,$ 是柯西应力张量，$\\,\\boldsymbol{\\varepsilon}\\,$ 是无穷小应变张量，$\\,\\mathbf{C}\\,$ 是四阶弹性刚度张量。在立方对称性的 Voigt 标记法中，只有 $\\,C_{11}\\,$, $\\,C_{12}\\,$ 和 $\\,C_{44}\\,$ 是独立的，并且剪切分量使用工程剪切应变 $\\,\\gamma = 2 \\varepsilon_{\\text{shear}}\\,$。\n- 每原子生成焓的定义：$\\,\\Delta H_f = E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} - \\sum_i x_i \\mu_i\\,$，其中 $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}}\\,$ 是多组分相的每原子 DFT 总能量，$\\,x_i\\,$ 是元素 $\\,i\\,$ 的原子分数，$\\,\\mu_i\\,$ 是纯元素 $\\,i\\,$ 在其稳定相中的每原子参考能量（化学势）。\n\n您的任务：\n- 使用提供的应变-应力数据集，为 $\\,C_{11}\\,$, $\\,C_{12}\\,$ 和 $\\,C_{44}\\,$ 实现一个最小二乘估计器。分别处理钳制离子（无内部弛豫）和弛豫离子（在每个施加的应变下内部坐标都已弛豫）数据集，以获得两组以吉帕斯卡（$\\mathrm{GPa}$）为单位的弹性常数。为了获得精确结果而需要弛豫内部坐标这一点，必须通过钳制离子和弛豫离子数据之间不同的拟合值来体现。\n- 使用上述定义，为提供的合金成分实现每原子生成焓的计算，结果以每原子电子伏特（$\\mathrm{eV/atom}$）表示。\n\n使用以下测试套件。在以下所有项目中，应变为无量纲，应力单位为 $\\mathrm{GPa}$。Voigt 应变向量的顺序是 $\\,\\left[\\varepsilon_{xx},\\varepsilon_{yy},\\varepsilon_{zz},\\gamma_{yz},\\gamma_{xz},\\gamma_{xy}\\right]\\,$，应力向量的顺序是 $\\,\\left[\\sigma_{xx},\\sigma_{yy},\\sigma_{zz},\\sigma_{yz},\\sigma_{xz},\\sigma_{xy}\\right]\\,$。钳制离子和弛豫离子的应力读数是合成的 DFT 输出，假定是在电子弛豫后获得的，其中弛豫离子数据包括内部坐标的弛豫。\n\n- 某种假设的立方高熵合金的应变-应力数据集：\n  - 沿 $\\,x\\,$ 轴的单轴应变，$\\,\\varepsilon_{xx} = \\delta\\,$：\n    - 情况 $\\,\\delta = 0.005\\,$：应变 $\\,\\left[0.005,0,0,0,0,0\\right]\\,$\n      - 钳制离子应力 $\\,\\left[1.15,\\,0.675,\\,0.675,\\,0,\\,0,\\,0\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[1.10,\\,0.625,\\,0.625,\\,0,\\,0,\\,0\\right]\\,$\n    - 情况 $\\,\\delta = 0.010\\,$：应变 $\\,\\left[0.010,0,0,0,0,0\\right]\\,$\n      - 钳制离子应力 $\\,\\left[2.30,\\,1.35,\\,1.35,\\,0,\\,0,\\,0\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[2.20,\\,1.25,\\,1.25,\\,0,\\,0,\\,0\\right]\\,$\n    - 情况 $\\,\\delta = 0.000\\,$（边界条件）：应变 $\\,\\left[0.000,0,0,0,0,0\\right]\\,$\n      - 钳制离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n  - 在 $\\,xy\\,$ 平面上的纯剪切，工程剪切应变 $\\,\\gamma = 2 \\varepsilon_{xy}\\,$：\n    - 情况 $\\,\\gamma = 0.004\\,$：应变 $\\,\\left[0,0,0,0,0,0.004\\right]\\,$\n      - 钳制离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.48\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.44\\right]\\,$\n    - 情况 $\\,\\gamma = 0.008\\,$：应变 $\\,\\left[0,0,0,0,0,0.008\\right]\\,$\n      - 钳制离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.96\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[0,\\,0,\\,0,\\,0,\\,0,\\,0.88\\right]\\,$\n  - 静水压应变 $\\,\\varepsilon_{xx} = \\varepsilon_{yy} = \\varepsilon_{zz} = \\delta_h\\,$：\n    - 情况 $\\,\\delta_h = 0.003\\,$：应变 $\\,\\left[0.003,0.003,0.003,0,0,0\\right]\\,$\n      - 钳制离子应力 $\\,\\left[1.50,\\,1.50,\\,1.50,\\,0,\\,0,\\,0\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[1.41,\\,1.41,\\,1.41,\\,0,\\,0,\\,0\\right]\\,$\n  - 正交保持体积应变 $\\,\\varepsilon_{xx} = \\delta_o\\,$, $\\,\\varepsilon_{yy} = -\\delta_o\\,$, $\\,\\varepsilon_{zz} = 0\\,$：\n    - 情况 $\\,\\delta_o = 0.006\\,$：应变 $\\,\\left[0.006,-0.006,0,0,0,0\\right]\\,$\n      - 钳制离子应力 $\\,\\left[0.57,\\,-0.57,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n      - 弛豫离子应力 $\\,\\left[0.57,\\,-0.57,\\,0,\\,0,\\,0,\\,0\\right]\\,$\n\n- 生成焓数据集。参考元素的每原子能量（化学势）如下：\n  - $\\,\\mu_{\\mathrm{A}} = -4.00\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{C}} = -3.50\\,\\mathrm{eV/atom}\\,$\n  - $\\,\\mu_{\\mathrm{D}} = -4.50\\,\\mathrm{eV/atom}\\,$\n  测试成分和每原子总能量：\n  - 情况 $\\,1\\,$（等原子四元）：$\\,x_{\\mathrm{A}} = 0.25\\,$, $\\,x_{\\mathrm{B}} = 0.25\\,$, $\\,x_{\\mathrm{C}} = 0.25\\,$, $\\,x_{\\mathrm{D}} = 0.25\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.30\\,\\mathrm{eV/atom}\\,$\n  - 情况 $\\,2\\,$（三元，非等原子）：$\\,x_{\\mathrm{A}} = 0.50\\,$, $\\,x_{\\mathrm{B}} = 0.30\\,$, $\\,x_{\\mathrm{C}} = 0.20\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.35\\,\\mathrm{eV/atom}\\,$\n  - 情况 $\\,3\\,$（纯元素边界情况）：$\\,x_{\\mathrm{B}} = 1.00\\,$, $\\,E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -5.00\\,\\mathrm{eV/atom}\\,$\n\n要求：\n- 使用一种遵循原理的最小二乘法，该方法强制执行 Voigt 形式的立方对称结构，分别为钳制离子和弛豫离子数据集计算以 $\\mathrm{GPa}$ 为单位的 $\\,C_{11}\\,$, $\\,C_{12}\\,$ 和 $\\,C_{44}\\,$。\n- 为每种生成焓情况计算以 $\\mathrm{eV/atom}\\,$ 为单位的 $\\,\\Delta H_f\\,$。结果表示为浮点数。任何量都不要使用百分号。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，格式为 $\\,\\left[\\left[\\Delta H_1,\\Delta H_2,\\Delta H_3\\right],\\left[C_{11}^{\\text{clamped}},C_{12}^{\\text{clamped}},C_{44}^{\\text{clamped}}\\right],\\left[C_{11}^{\\text{relaxed}},C_{12}^{\\text{relaxed}},C_{44}^{\\text{relaxed}}\\right]\\right]\\,$。\n- 应力和弹性常数以 $\\mathrm{GPa}$ 表示，生成焓以 $\\mathrm{eV/atom}$ 表示，数值以浮点数形式打印。\n\n测试套件覆盖范围：\n- 具有多种应变模式的理想路径估计。\n- 仅剪切情况以分离 $\\,C_{44}\\,$. \n- 静水压情况以约束体积响应。\n- 边界应变情况 $\\,\\delta = 0\\,$ 以验证零应力行为。\n- 生成焓边界情况，即根据定义，纯元素的生成焓为零。\n\n不需要外部输入；程序必须是自包含的并确定性地执行。",
            "solution": "该问题要求实现计算材料科学中常见的两种不同计算：从应力-应变数据确定弹性常数，以及从总能量数据计算生成焓。该问题的有效性已得到确认，因为它具有科学依据、自成体系且定义明确。我们将进行系统性的解答。\n\n### 第一部分：生成焓（$\\Delta H_f$）的计算\n\n每原子生成焓 $\\Delta H_f$ 定义为合金相的每原子总能量与其构成元素在稳定参考相中的化学势的加权平均值之间的差值。控制方程为：\n$$\n\\Delta H_f = \\frac{E_{\\text{tot}}^{\\text{phase}}}{N_{\\text{atoms}}} - \\sum_i x_i \\mu_i\n$$\n其中 $E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}}$ 是合金的每原子总能量，$x_i$ 是元素 $i$ 的原子分数，$\\mu_i$ 是纯元素 $i$ 的每原子参考能量（化学势）。总和 $\\sum_i x_i \\mu_i$ 代表了组分的机械混合物的能量。\n\n提供的参考能量为：\n- $\\mu_{\\mathrm{A}} = -4.00\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{C}} = -3.50\\,\\mathrm{eV/atom}$\n- $\\mu_{\\mathrm{D}} = -4.50\\,\\mathrm{eV/atom}$\n\n我们为给定的三种情况计算 $\\Delta H_f$：\n\n**情况1：等原子四元合金**\n- 成分：$x_{\\mathrm{A}} = 0.25$, $x_{\\mathrm{B}} = 0.25$, $x_{\\mathrm{C}} = 0.25$, $x_{\\mathrm{D}} = 0.25$\n- 每原子总能量：$E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.30\\,\\mathrm{eV/atom}$\n- 参考能量的加权和为：\n$$\n\\sum_i x_i \\mu_i = (0.25 \\times -4.00) + (0.25 \\times -5.00) + (0.25 \\times -3.50) + (0.25 \\times -4.50) = 0.25 \\times (-17.00) = -4.25\\,\\mathrm{eV/atom}\n$$\n- 生成焓为：\n$$\n\\Delta H_{f,1} = (-4.30) - (-4.25) = -0.05\\,\\mathrm{eV/atom}\n$$\n\n**情况2：三元合金**\n- 成分：$x_{\\mathrm{A}} = 0.50$, $x_{\\mathrm{B}} = 0.30$, $x_{\\mathrm{C}} = 0.20$\n- 每原子总能量：$E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -4.35\\,\\mathrm{eV/atom}$\n- 参考能量的加权和为：\n$$\n\\sum_i x_i \\mu_i = (0.50 \\times -4.00) + (0.30 \\times -5.00) + (0.20 \\times -3.50) = -2.00 - 1.50 - 0.70 = -4.20\\,\\mathrm{eV/atom}\n$$\n- 生成焓为：\n$$\n\\Delta H_{f,2} = (-4.35) - (-4.20) = -0.15\\,\\mathrm{eV/atom}\n$$\n\n**情况3：纯元素**\n- 成分：$x_{\\mathrm{B}} = 1.00$\n- 每原子总能量：$E_{\\text{tot}}^{\\text{phase}}/N_{\\text{atoms}} = -5.00\\,\\mathrm{eV/atom}$\n- 参考能量的加权和为：\n$$\n\\sum_i x_i \\mu_i = 1.00 \\times \\mu_{\\mathrm{B}} = -5.00\\,\\mathrm{eV/atom}\n$$\n- 生成焓为：\n$$\n\\Delta H_{f,3} = (-5.00) - (-5.00) = 0.00\\,\\mathrm{eV/atom}\n$$\n此结果正确地表明，根据定义，纯元素在其参考状态下的生成焓为零。\n\n### 第二部分：弹性常数（$C_{ij}$）的计算\n\n弹性常数由应力与应变之间的线性关系（胡克定律）$\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}$ 确定。对于具有立方对称性的材料，该关系可以用 Voigt 标记法表示，使用一个包含三个独立弹性常数 $C_{11}$、$C_{12}$ 和 $C_{44}$ 的 $6 \\times 6$ 刚度矩阵 $\\mathbf{C}$。应变向量使用工程剪切应变，例如 $\\varepsilon_6 = \\gamma_{xy}$。\n$$\n\\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{11}  C_{12}  C_{12}  0  0  0 \\\\\nC_{12}  C_{11}  C_{12}  0  0  0 \\\\\nC_{12}  C_{12}  C_{11}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{44}  0 \\\\\n0  0  0  0  0  C_{44}\n\\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\\\ \\varepsilon_4 \\\\ \\varepsilon_5 \\\\ \\varepsilon_6 \\end{pmatrix}\n$$\n其中下标对应关系为 $1 \\leftrightarrow xx, 2 \\leftrightarrow yy, 3 \\leftrightarrow zz, 4 \\leftrightarrow yz, 5 \\leftrightarrow xz, 6 \\leftrightarrow xy$。\n\n该方程组可以写成线性模型 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$，其中 $\\mathbf{y}$ 是观测到的应力分量向量，$\\boldsymbol{\\beta} = [C_{11}, C_{12}, C_{44}]^T$ 是未知常数向量，$\\mathbf{X}$ 是由应变分量构成的设计矩阵。对于每个应力分量 $\\sigma_i$，我们可以写出一个关于参数 $\\boldsymbol{\\beta}$ 的线性方程。例如：\n- $\\sigma_1 = C_{11}\\varepsilon_1 + C_{12}(\\varepsilon_2 + \\varepsilon_3)$\n- $\\sigma_2 = C_{11}\\varepsilon_2 + C_{12}(\\varepsilon_1 + \\varepsilon_3)$\n- $\\sigma_3 = C_{11}\\varepsilon_3 + C_{12}(\\varepsilon_1 + \\varepsilon_2)$\n- $\\sigma_4 = C_{44}\\varepsilon_4$, $\\sigma_5 = C_{44}\\varepsilon_5$, $\\sigma_6 = C_{44}\\varepsilon_6$\n\n这些可以映射到矩阵 $\\mathbf{X}$ 的行。例如，$\\sigma_1$ 的方程对应于 $\\mathbf{X}$ 中的一行 $[\\varepsilon_1, \\varepsilon_2 + \\varepsilon_3, 0]$ 和 $\\mathbf{y}$ 中的一个值 $\\sigma_1$。通过聚合所提供数据集中的所有非平凡应力-应变关系，我们构建了一个超定系统。$\\boldsymbol{\\beta}$ 的最佳拟合值是使用线性最小二乘法找到的，其解由 $\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$ 给出。\n\n我们对钳制离子和弛豫离子数据集分别应用此过程。\n\n**钳制离子弹性常数 ($C_{ij}^{\\text{clamped}}$)**\n所提供的钳制离子应力数据集在不同应变模式下是完全线性的且一致的。\n- 从单轴应变（$\\varepsilon_1 = 0.005$）：$\\sigma_1 = 1.15\\,\\mathrm{GPa}$ 和 $\\sigma_2 = 0.675\\,\\mathrm{GPa}$。这直接意味着 $C_{11} = 1.15/0.005 = 230\\,\\mathrm{GPa}$ 和 $C_{12} = 0.675/0.005 = 135\\,\\mathrm{GPa}$。\n- 从剪切应变（$\\varepsilon_6 = 0.004$）：$\\sigma_6 = 0.48\\,\\mathrm{GPa}$。这意味着 $C_{44} = 0.48/0.004 = 120\\,\\mathrm{GPa}$。\n- 这些值被其他应变模式所证实。例如，对于静水压应变，体积模量为 $K = (C_{11} + 2C_{12})/3$。对于体积应变为 $\\Delta V/V = 3\\delta_h=0.009$ 的情况，压力是 $P = -(\\sigma_1+\\sigma_2+\\sigma_3)/3 = -1.50\\,\\mathrm{GPa}$。所以 $K= -P/(\\Delta V/V) \\approx 1.50/0.009 \\approx 166.67\\,\\mathrm{GPa}$。根据我们的常数，$(230 + 2 \\times 135)/3 = 500/3 \\approx 166.67\\,\\mathrm{GPa}$。\n对所有数据点的完整最小二乘拟合得出：\n$$\nC_{11}^{\\text{clamped}} = 230.0\\,\\mathrm{GPa}, \\quad C_{12}^{\\text{clamped}} = 135.0\\,\\mathrm{GPa}, \\quad C_{44}^{\\text{clamped}} = 120.0\\,\\mathrm{GPa}\n$$\n\n**弛豫离子弹性常数 ($C_{ij}^{\\text{relaxed}}$)**\n类似地，对于弛豫离子数据集，它考虑了应变下内部原子坐标的弛豫：\n- 从单轴应变（$\\varepsilon_1 = 0.005$）：$\\sigma_1 = 1.10\\,\\mathrm{GPa}$ 和 $\\sigma_2 = 0.625\\,\\mathrm{GPa}$，这意味着 $C_{11} = 1.10/0.005 = 220\\,\\mathrm{GPa}$ 和 $C_{12} = 0.625/0.005 = 125\\,\\mathrm{GPa}$。\n- 从剪切应变（$\\varepsilon_6 = 0.004$）：$\\sigma_6 = 0.44\\,\\mathrm{GPa}$，这意味着 $C_{44} = 0.44/0.004 = 110\\,\\mathrm{GPa}$。\n- 在弛豫离子数据集中，这些值在所有施加的应变模式下也是一致的。原子位置的弛豫使得材料更容易适应应变，导致应力降低，从而与钳制离子情况相比，弹性常数更小，这是一种物理上正确的行为。\n完整的最小二乘拟合得出：\n$$\nC_{11}^{\\text{relaxed}} = 220.0\\,\\mathrm{GPa}, \\quad C_{12}^{\\text{relaxed}} = 125.0\\,\\mathrm{GPa}, \\quad C_{44}^{\\text{relaxed}} = 110.0\\,\\mathrm{GPa}\n$$\n\n最终结果被编译成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute formation enthalpies and elastic constants.\n    \"\"\"\n\n    # --- Part 1: Calculation of Formation Enthalpy ---\n\n    # Define elemental reference energies (chemical potentials)\n    mu_refs = {\n        'A': -4.00,  # eV/atom\n        'B': -5.00,  # eV/atom\n        'C': -3.50,  # eV/atom\n        'D': -4.50   # eV/atom\n    }\n\n    # Define test cases for formation enthalpy\n    enthalpy_cases = [\n        # Case 1: Equiatomic quaternary\n        ({'A': 0.25, 'B': 0.25, 'C': 0.25, 'D': 0.25}, -4.30),\n        # Case 2: Ternary, non-equiatomic\n        ({'A': 0.50, 'B': 0.30, 'C': 0.20}, -4.35),\n        # Case 3: Pure element edge case\n        ({'B': 1.00}, -5.00),\n    ]\n\n    hf_results = []\n    for composition, total_energy_per_atom in enthalpy_cases:\n        # Calculate the weighted sum of reference energies\n        sum_xi_mui = sum(\n            fraction * mu_refs[element]\n            for element, fraction in composition.items()\n        )\n        # Calculate the formation enthalpy\n        delta_hf = total_energy_per_atom - sum_xi_mui\n        hf_results.append(delta_hf)\n\n    # --- Part 2: Calculation of Elastic Constants ---\n\n    # Define the strain-stress dataset\n    # Strain vector: [exx, eyy, ezz, gyz, gxz, gxy]\n    # Stress vector: [sxx, syy, szz, syz, sxz, sxy] (GPa)\n    strain_stress_data = [\n        # Uniaxial strain\n        {'strain': [0.005, 0, 0, 0, 0, 0], 'clamped': [1.15, 0.675, 0.675, 0, 0, 0], 'relaxed': [1.10, 0.625, 0.625, 0, 0, 0]},\n        {'strain': [0.010, 0, 0, 0, 0, 0], 'clamped': [2.30, 1.35, 1.35, 0, 0, 0], 'relaxed': [2.20, 1.25, 1.25, 0, 0, 0]},\n        # Pure shear\n        {'strain': [0, 0, 0, 0, 0, 0.004], 'clamped': [0, 0, 0, 0, 0, 0.48], 'relaxed': [0, 0, 0, 0, 0, 0.44]},\n        {'strain': [0, 0, 0, 0, 0, 0.008], 'clamped': [0, 0, 0, 0, 0, 0.96], 'relaxed': [0, 0, 0, 0, 0, 0.88]},\n        # Hydrostatic strain\n        {'strain': [0.003, 0.003, 0.003, 0, 0, 0], 'clamped': [1.50, 1.50, 1.50, 0, 0, 0], 'relaxed': [1.41, 1.41, 1.41, 0, 0, 0]},\n        # Orthorhombic strain\n        {'strain': [0.006, -0.006, 0, 0, 0, 0], 'clamped': [0.57, -0.57, 0, 0, 0, 0], 'relaxed': [0.57, -0.57, 0, 0, 0, 0]},\n        # Zero strain (boundary condition) - will result in trivial 0=0 equations, included for completeness but won't affect fit\n        {'strain': [0, 0, 0, 0, 0, 0], 'clamped': [0, 0, 0, 0, 0, 0], 'relaxed': [0, 0, 0, 0, 0, 0]},\n    ]\n    \n    def calculate_elastic_constants(data, ion_state):\n        \"\"\"\n        Calculates C11, C12, C44 using linear least squares from strain-stress data.\n        \"\"\"\n        X = []  # Design matrix\n        y = []  # Observation vector (stresses)\n\n        # The linear relations for cubic symmetry in Voigt notation:\n        # s1 = C11*e1 + C12*(e2+e3)\n        # s2 = C11*e2 + C12*(e1+e3)\n        # s3 = C11*e3 + C12*(e1+e2)\n        # s4 = C44*e4\n        # s5 = C44*e5\n        # s6 = C44*e6\n        # The parameters to fit are beta = [C11, C12, C44]\n        \n        for item in data:\n            strain = item['strain']\n            stress = item[ion_state]\n            \n            e1, e2, e3, e4, e5, e6 = strain\n            s1, s2, s3, s4, s5, s6 = stress\n\n            # Add rows to X and y for each non-zero stress component\n            if s1 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e1, e2 + e3, 0])\n                y.append(s1)\n            if s2 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e2, e1 + e3, 0])\n                y.append(s2)\n            if s3 != 0 or e1 != 0 or e2 != 0 or e3 != 0:\n                X.append([e3, e1 + e2, 0])\n                y.append(s3)\n            if s4 != 0 or e4 != 0:\n                X.append([0, 0, e4])\n                y.append(s4)\n            if s5 != 0 or e5 != 0:\n                X.append([0, 0, e5])\n                y.append(s5)\n            if s6 != 0 or e6 != 0:\n                X.append([0, 0, e6])\n                y.append(s6)\n        \n        X_matrix = np.array(X)\n        y_vector = np.array(y)\n        \n        # Solve the linear least squares problem y = X * beta\n        # rcond=None to use the machine-precision default\n        constants, _, _, _ = np.linalg.lstsq(X_matrix, y_vector, rcond=None)\n        \n        return constants.tolist()\n\n    c_clamped_results = calculate_elastic_constants(strain_stress_data, 'clamped')\n    c_relaxed_results = calculate_elastic_constants(strain_stress_data, 'relaxed')\n\n    # --- Part 3: Format and Print Final Output ---\n    \n    # Format the lists into strings without spaces\n    str_hf = f\"[{','.join(map(str, hf_results))}]\"\n    str_c_clamped = f\"[{','.join(f'{c:.1f}' for c in c_clamped_results)}]\"\n    str_c_relaxed = f\"[{','.join(f'{c:.1f}' for c in c_relaxed_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(f\"[{str_hf},{str_c_clamped},{str_c_relaxed}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从模拟中获得准确的结果不仅仅是运行代码，更需要对方法论的局限性有批判性的理解。本练习  深入探讨了弹性常数计算中数值验证和最佳实践这一核心议题。它挑战您识别出选择应变幅度和诊断潜在错误的稳健策略，以确保您计算出的值能真实地代表材料的线弹性行为。",
            "id": "3732119",
            "problem": "一位研究人员正在使用密度泛函理论（DFT）在一个包含 $128$ 个原子的特殊准随机结构（SQS）超胞上，于零温下计算一种化学无序的面心立方高熵合金的二阶弹性常数。他们计划通过拟合总能量随微小均匀应变的变化或应力-应变响应来提取弹性常数。已知或假设如下：\n\n- 对于足够小的应变 $\\varepsilon_{kl}$，线性弹性由关系 $\\sigma_{ij} = C_{ijkl} \\,\\varepsilon_{kl}$ 定义，其中 $\\sigma_{ij}$ 是应力，$C_{ijkl}$ 是二阶弹性常数。\n- 弹性储能密度在零应变点可以进行应变泰勒展开，\n$$\nu(\\varepsilon) \\equiv \\frac{U(\\varepsilon)}{V_0} = u_0 + \\frac{1}{2} \\, C^{(2)}_{ijkl} \\,\\varepsilon_{ij}\\varepsilon_{kl} + \\frac{1}{6} \\, C^{(3)}_{ijklmn} \\,\\varepsilon_{ij}\\varepsilon_{kl}\\varepsilon_{mn} + \\cdots,\n$$\n其中 $C^{(3)}_{ijklmn}$ 表示三阶弹性常数，$V_0$ 是未形变体积。\n- 对于用于提取一个有效弹性模量的代表性单参数形变模式，根据先前关于类似合金的文献，研究人员预计 $C^{(2)}_{\\mathrm{eff}} \\approx 150 \\,\\mathrm{GPa}$ 和 $C^{(3)}_{\\mathrm{eff}} \\approx 1000 \\,\\mathrm{GPa}$。\n- 经过仔细的电子收敛后，DFT的数值噪声特征为：应力分量的标准差约为 $\\sigma_{\\mathrm{num}} \\approx 0.05 \\,\\mathrm{GPa}$，总能量噪声约为每个原子 $0.1 \\,\\mathrm{meV}$。该超胞含有 $128$ 个原子，典型的单原子体积为 $12 \\,\\text{\\AA}^3$。\n- 在每个施加的应变下，内部原子位置都会被弛豫，直到作用力低于 $10^{-3} \\,\\mathrm{eV/\\text{\\AA}}$，且晶胞形状受所选均匀应变模式的约束。\n- 在所考虑的小应变振幅下，材料保持相同的相（没有触发不稳定性）。\n\n在选择应变振幅 $\\varepsilon$ 时，研究人员担心两个数值陷阱：如果 $\\varepsilon$ 太大，$C^{(3)}$ 及更高阶项的影响会使拟合的 $C^{(2)}$ 产生偏差；如果 $\\varepsilon$ 太小，DFT的数值噪声会淹没信号。仅使用上述信息以及线性弹性和泰勒展开的基本原理，评估以下策略和诊断方法，以确保捕获线性区域并避免数值陷阱。选择所有合理的选项。\n\nA. 为每个形变模式选择一个对称的应变集合 $\\{\\pm \\varepsilon\\}$，范围大约在 $\\varepsilon \\in [0.2\\%, 0.5\\%]$，对能量进行二次拟合，对应力进行线性模型拟合，并验证当最大振幅减半时，提取的模量变化小于 $1\\%$。如果通过此不变性测试，则接受结果。\n\nB. 使用 $\\varepsilon = 2\\%$ 的单个大应变，以确保能量和应力信号远超数值噪声；三阶弹性贡献在 $\\varepsilon = 5\\%$ 以下总是可以忽略不计，因此二次拟合是足够的。\n\nC. 对于每个形变模式，通过比较在 $+\\varepsilon$ 和 $-\\varepsilon$ 处的数据，检查应力-应变关系是否为 $\\varepsilon$ 的奇函数，能量-应变关系是否为偶函数。如果偏离奇/偶对称性的程度等于或低于数值噪声水平，则宣布已捕获线性区域。\n\nD. 在给定的噪声水平和超胞尺寸下，在 $\\varepsilon = 0.2\\%$ 时，基于能量的拟合比基于应力的拟合更稳健，因为总能量是标量，对应力来说，它对数值噪声的敏感度较低。\n\nE. 通过从两个在立方晶体中对称等价的独立形变模式中提取相同的弹性常数线性组合来交叉验证模量，并要求其符合度在 $1$–$2\\%$ 以内。如果它们的差异超出此容差，则得出结论：要么应变振幅超出了线性范围，要么计算未达到数值收敛。\n\nF. 如果仅使用正应变，将能量拟合为 $\\varepsilon$ 的三次多项式可以消除三阶项的偏差，因此高达 $\\varepsilon = 1\\%$ 的应变对于确定二阶弹性常数总是安全的。\n\nG. 通过要求对二次能量项的立方修正分数低于 $1\\%$ 来估计 $\\varepsilon$ 的上限，使用比率 $C^{(3)}_{\\mathrm{eff}}/C^{(2)}_{\\mathrm{eff}}$；并通过要求应力信噪比至少为 $5$ 来估计下限。在这些边界的重叠区域内选择 $\\varepsilon$。\n\nH. 在拟合应力-应变数据之前，通过从所有应力值中减去在零应变下测得的任何近似恒定的偏移应力（例如，Pulay应力），使得拟合的截距被约束为零，并且只有斜率决定模量。\n\n选择所有适用的选项。",
            "solution": "问题陈述描述了计算材料科学中的一个标准情景：使用密度泛函理论（DFT）计算高熵合金的二阶弹性常数（$C_{ijkl}$）。该过程涉及对超胞施加微小均匀应变（$\\varepsilon_{kl}$），并计算产生的应力（$\\sigma_{ij}$）或总能量的变化（$U$）。核心挑战是选择一个应变振幅范围，该范围要足够大以产生可与数值噪声区分的信号，但又足够小以避免来自非线性、更高阶弹性效应的显著污染。该问题提供了充分、科学上合理且一致的信息来评估所提出的策略。因此，该问题是有效的。\n\n我们首先建立关键关系并估计相关量。对于具有应变 $\\varepsilon$ 的单个有效形变模式，能量密度（$u$）和应力（$\\sigma$）由泰勒级数给出：\n$$\nu(\\varepsilon) = u_0 + \\frac{1}{2} C^{(2)}_{\\mathrm{eff}} \\varepsilon^2 + \\frac{1}{6} C^{(3)}_{\\mathrm{eff}} \\varepsilon^3 + \\mathcal{O}(\\varepsilon^4)\n$$\n$$\n\\sigma(\\varepsilon) = \\frac{\\partial u}{\\partial \\varepsilon} = C^{(2)}_{\\mathrm{eff}} \\varepsilon + \\frac{1}{2} C^{(3)}_{\\mathrm{eff}} \\varepsilon^2 + \\mathcal{O}(\\varepsilon^3)\n$$\n在这里，$C^{(2)}_{\\mathrm{eff}}$ 是待确定的二阶弹性模量，$C^{(3)}_{\\mathrm{eff}}$ 是非线性误差的主要来源。\n\n让我们量化两种相互竞争的效应：数值噪声和非线性偏差。\n\n**数值噪声：**\n超胞含有 $N=128$ 个原子。\n总能量噪声为 $0.1 \\,\\mathrm{meV}/\\text{atom}$。超胞总能量的噪声为 $\\Delta U_{\\mathrm{noise}} = (0.1 \\times 10^{-3} \\,\\mathrm{eV}/\\text{atom}) \\times 128 \\,\\text{atoms} = 12.8 \\,\\mathrm{meV} \\approx 2.05 \\times 10^{-21} \\,\\mathrm{J}$。\n应力分量噪声为 $\\sigma_{\\mathrm{num}} \\approx 0.05 \\,\\mathrm{GPa}$。\n\n**信号强度：**\n未形变体积为 $V_0 = (12 \\,\\text{\\AA}^3/\\text{atom}) \\times 128 \\,\\text{atoms} = 1536 \\,\\text{\\AA}^3 = 1.536 \\times 10^{-27} \\,\\mathrm{m}^3$。\n能量信号（与基态能量的差值）为 $\\Delta U(\\varepsilon) = U(\\varepsilon) - U(0) \\approx \\frac{1}{2} C^{(2)}_{\\mathrm{eff}} V_0 \\varepsilon^2$。\n使用 $C^{(2)}_{\\mathrm{eff}} \\approx 150 \\,\\mathrm{GPa} = 1.5 \\times 10^{11} \\,\\mathrm{J/m^3}$：\n$\\Delta U(\\varepsilon) \\approx \\frac{1}{2} (1.5 \\times 10^{11}) (1.536 \\times 10^{-27}) \\varepsilon^2 \\approx 1.15 \\times 10^{-16} \\varepsilon^2 \\,\\mathrm{J}$。\n应力信号为 $\\sigma(\\varepsilon) \\approx C^{(2)}_{\\mathrm{eff}} \\varepsilon \\approx 150 \\varepsilon \\,\\mathrm{GPa}$。\n\n**信噪比（SNR）：**\n能量信噪比：$SNR_U = \\frac{\\Delta U(\\varepsilon)}{\\Delta U_{\\mathrm{noise}}} \\approx \\frac{1.15 \\times 10^{-16} \\varepsilon^2}{2.05 \\times 10^{-21}} \\approx 5.6 \\times 10^4 \\varepsilon^2$。\n应力信噪比：$SNR_\\sigma = \\frac{\\sigma(\\varepsilon)}{\\sigma_{\\mathrm{num}}} \\approx \\frac{150 \\varepsilon}{0.05} = 3000 \\varepsilon$。\n\n**非线性偏差：**\n三阶项对能量的相对贡献是非线性偏差的一种度量：\n$$\n\\text{Bias} \\approx \\frac{|\\frac{1}{6} C^{(3)}_{\\mathrm{eff}} V_0 \\varepsilon^3|}{|\\frac{1}{2} C^{(2)}_{\\mathrm{eff}} V_0 \\varepsilon^2|} = \\frac{1}{3} \\frac{|C^{(3)}_{\\mathrm{eff}}|}{|C^{(2)}_{\\mathrm{eff}}|} \\varepsilon\n$$\n使用给定的估计值，$C^{(2)}_{\\mathrm{eff}} \\approx 150 \\,\\mathrm{GPa}$ 和 $C^{(3)}_{\\mathrm{eff}} \\approx 1000 \\,\\mathrm{GPa}$：\n$$\n\\text{Bias} \\approx \\frac{1}{3} \\frac{1000}{150} \\varepsilon \\approx 2.22 \\varepsilon\n$$\n\n在这个框架下，我们现在分析每个选项。\n\n**A. 为每个形变模式选择一个对称的应变集合 $\\{\\pm \\varepsilon\\}$，范围大约在 $\\varepsilon \\in [0.2\\%, 0.5\\%]$，对能量进行二次拟合，对应力进行线性模型拟合，并验证当最大振幅减半时，提取的模量变化小于 $1\\%$。如果通过此不变性测试，则接受结果。**\n该选项提出了一种高度稳健和标准的方法。\n1.  使用对称的应变集合 $\\{\\pm\\varepsilon\\}$ 是很好的做法，因为它允许检查对称性，并可以帮助消除能量展开中奇次项的误差。\n2.  应变范围 $\\varepsilon \\in [0.002, 0.005]$ 是合理的。在 $\\varepsilon=0.002$ 时，应力信噪比为 $3000 \\times 0.002 = 6$，非线性偏差为 $2.22 \\times 0.002 \\approx 0.44\\%$。在 $\\varepsilon=0.005$ 时，应力信噪比为 $15$，偏差为 $2.22 \\times 0.005 \\approx 1.1\\%$。这个范围在各种权衡之间取得了平衡。\n3.  关键部分是不变性测试：使用更小的最大应变重新计算模量。如果结果稳定（例如，变化小于 $1\\%$），这提供了强有力的证据，表明拟合没有受到高阶项的显著影响。这是确保处于线性区域的主要方法之一。\n这个策略在方法论上是合理的。**正确**。\n\n**B. 使用 $\\varepsilon = 2\\%$ 的单个大应变，以确保能量和应力信号远超数值噪声；三阶弹性贡献在 $\\varepsilon = 5\\%$ 以下总是可以忽略不计，因此二次拟合是足够的。**\n这个策略有严重缺陷。\n1.  使用单个应变点（除了零应变点）不允许进行拟合或评估线性度。它假设在该点之前是完全线性的。\n2.  在 $\\varepsilon = 0.02$ ($2\\%$) 的应变下，非线性偏差约为 $2.22 \\times 0.02 = 4.44\\%$。这是一个显著的误差，与二次拟合足够的断言相矛盾。\n3.  “三阶弹性贡献在 $\\varepsilon = 5\\%$ 以下总是可以忽略不计”的说法是一种危险的概括，并且根据问题本身的数据来看是错误的。$\\varepsilon=0.05$ 的应变意味着超过 $11\\%$ 的偏差。\n这个策略是不合理的。**不正确**。\n\n**C. 对于每个形变模式，通过比较在 $+\\varepsilon$ 和 $-\\varepsilon$ 处的数据，检查应力-应变关系是否为 $\\varepsilon$ 的奇函数，能量-应变关系是否为偶函数。如果偏离奇/偶对称性的程度等于或低于数值噪声水平，则宣布已捕获线性区域。**\n这是一个极好的诊断工具。破坏能量 $u(\\varepsilon)$ 偶对称性的最低阶项是三次项 $\\frac{1}{6} C^{(3)} \\varepsilon^3$。破坏应力 $\\sigma(\\varepsilon)$ 奇对称性的最低阶项是二次项 $\\frac{1}{2} C^{(3)} \\varepsilon^2$。\n能量偏离偶对称性的程度为 $u(\\varepsilon) - u(-\\varepsilon) = \\frac{1}{3} C^{(3)} \\varepsilon^3$。\n应力偏离奇对称性的程度为 $\\sigma(\\varepsilon) + \\sigma(-\\varepsilon) = C^{(3)} \\varepsilon^2$。\n将这些破坏对称性的项的大小与数值噪声进行比较，是直接测试 $C^{(3)}$ 重要性的方法。如果这些偏差在统计上不显著（即，它们“在噪声中”），那么 $C^{(3)}$ 对 $C^{(2)}$ 拟合的偏置效应也将很小。这是一个有效且强大的检查方法。**正确**。\n\n**D. 在给定的噪声水平和超胞尺寸下，在 $\\varepsilon = 0.2\\%$ 时，基于能量的拟合比基于应力的拟合更稳健，因为总能量是标量，对应力来说，它对数值噪声的敏感度较低。**\n让我们在 $\\varepsilon = 0.002$ ($0.2\\%$) 时评估两种方法的信噪比。\n$SNR_\\sigma = 3000 \\times 0.002 = 6$。\n$SNR_U \\approx 5.6 \\times 10^4 \\times (0.002)^2 = 0.224$。\n基于应力的信噪比显著高于（$25\\times$）基于能量的信噪比。原因是能量信号与 $\\varepsilon^2$ 成正比，而应力信号与 $\\varepsilon$ 成正比。对于小 $\\varepsilon$，能量信号减小得快得多。“能量是标量”这个定性论证在定量比较显示基于应力的拟合在这个低应变区域更优越时是无关紧要的。因此，该陈述是错误的。**不正确**。\n\n**E. 通过从两个在立方晶体中对称等价的独立形变模式中提取相同的弹性常数线性组合来交叉验证模量，并要求其符合度在 $1$–$2\\%$ 以内。如果它们的差异超出此容差，则得出结论：要么应变振幅超出了线性范围，要么计算未达到数值收敛。**\n这描述了一个关键的一致性检查。对于具有立方对称性的系统，有多种独立的应变路径可以确定相同的弹性常数或其组合（例如，$C_{11}$、$C_{44}$ 或体模量 $K = (C_{11} + 2C_{12})/3$）。虽然有限的SQS超胞打破了完美的立方对称性，但来自对称等价形变的结果应该在统计不确定性范围内一致。显著的差异（例如，超过百分之几）是一个危险信号，表明计算方案中存在系统误差。此类误差最常见的来源确实是使用过大的应变（非线性）或不完全的数值收敛（k点、能量截断等）。这是一个仔细研究的标准和必要部分。**正确**。\n\n**F. 如果仅使用正应变，将能量拟合为 $\\varepsilon$ 的三次多项式可以消除三阶项的偏差，因此高达 $\\varepsilon = 1\\%$ 的应变对于确定二阶弹性常数总是安全的。**\n这个陈述包含多个谬误。\n1. 将能量 $U(\\varepsilon)$ 拟合为三次多项式 $a_0 + a_1\\varepsilon + a_2\\varepsilon^2+a_3\\varepsilon^3$ 可以从系数 $a_2$ 中估计 $C^{(2)}$。然而，这个拟合现在容易受到四阶项（$C^{(4)}$）的偏差影响，这在像 $\\varepsilon = 0.01$ ($1\\%$) 这样较大的应变下可能很显著。它并不能“消除”偏差，只是考虑了 $C^{(3)}$ 项。\n2. 声称高达 $1\\%$ 的应变“总是安全”是言过其实。其安全性取决于更高阶常数（$C^{(4)}, C^{(5)}, \\dots$）的大小，而这些是未知的。\n3. 仅使用正（或仅负）应变是糟糕的实验设计。一个对称的应变集合 $\\{\\pm\\varepsilon\\}$ 能为拟合提供更好的约束，有助于清晰地分离展开式中的偶次和奇次幂。\n这个策略不够稳健，且其断言过于强烈。**不正确**。\n\n**G. 通过要求对二次能量项的立方修正分数低于 $1\\%$ 来估计 $\\varepsilon$ 的上限，使用比率 $C^{(3)}_{\\mathrm{eff}}/C^{(2)}_{\\mathrm{eff}}$；并通过要求应力信噪比至少为 $5$ 来估计下限。在这些边界的重叠区域内选择 $\\varepsilon$。**\n该选项提出了一种定量和系统的方法来寻找最佳应变窗口。\n- **上限（来自非线性）：** 分数偏差为 $2.22\\varepsilon$。要求其小于 $1\\%$（$0.01$）给出 $2.22\\varepsilon  0.01 \\implies \\varepsilon  0.0045$，即 $0.45\\%$。\n- **下限（来自噪声）：** 应力信噪比为 $3000\\varepsilon$。要求其至少为 $5$ 给出 $3000\\varepsilon  5 \\implies \\varepsilon  5/3000 \\approx 0.00167$，即 $0.17\\%$。\n这个过程通过明确平衡获得良好信号的需求与最小化非线性效应的需求，确定了应变振幅的一个“最佳范围”，大约为 $\\varepsilon \\in [0.17\\%, 0.45\\%]$。这是一个仔细的数值实验的标志。**正确**。\n\n**H. 在拟合应力-应变数据之前，通过从所有应力值中减去在零应变下测得的任何近似恒定的偏移应力（例如，Pulay应力），使得拟合的截距被约束为零，并且只有斜率决定模量。**\n这是DFT计算中的一个标准且正确的程序。由于有限基组和/或不完全的离子弛豫，DFT计算可能在零施加应变下产生非零的残余应力 $\\sigma_0$。真正的弹性响应关联了应力的*变化*与施加的应变。因此，物理上相关的量是 $\\Delta\\sigma(\\varepsilon) = \\sigma_{DFT}(\\varepsilon) - \\sigma_{DFT}(0)$。通过减去零应变偏移 $\\sigma_0 = \\sigma_{DFT}(0)$，可以分离出弹性响应，$\\Delta\\sigma \\approx C^{(2)}\\varepsilon$。将这个修正后的数据拟合到一条通过原点的直线上，是提取模量 $C^{(2)}$ 的正确方法，并避免将数值赝像 $\\sigma_0$ 误解为物理响应的一部分。**正确**。",
            "answer": "$$\\boxed{ACEGH}$$"
        }
    ]
}