{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational derivation of key thermodynamic quantities from first principles within the quasi-harmonic approximation. By starting with the quantum energy levels of a single harmonic oscillator, you will derive its contribution to the Helmholtz free energy $F_{\\mathrm{vib}}(T,V)$ and the resulting thermal pressure $P_{\\mathrm{th}}$. This practice is crucial for understanding how the volume-dependence of phonon frequencies, encapsulated by the Grüneisen parameter $\\gamma$, directly translates microscopic quantum mechanics into a macroscopic pressure that influences a material's equation of state .",
            "id": "3755384",
            "problem": "A single, non-degenerate vibrational mode in a chemically disordered face-centered cubic high-entropy alloy can be modeled within the quasi-harmonic approximation as a quantum harmonic oscillator of angular frequency $\\omega(V)$ that depends on the crystal volume $V$ through a constant mode Grüneisen parameter $\\gamma0$ according to the power-law relation $\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$, where $\\omega_0$ is the mode frequency at a reference volume $V_0$. Assume a canonical ensemble at temperature $T$ and take the Helmholtz free energy definition $F=-k_B T \\ln Z$, where $Z$ is the canonical partition function built from the quantum energy spectrum of a harmonic oscillator with energy levels $E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$ for $n=0,1,2,\\dots$, with reduced Planck constant $\\hbar$ and Boltzmann constant $k_B$. Within the quasi-harmonic approximation, treat $\\omega$ as fixed at a given $V$ when performing thermal averages. Derive, from first principles, the closed-form expression for the contribution of this single mode to the vibrational Helmholtz free energy $F_{\\mathrm{vib}}(T,V)$ and then compute its thermal pressure defined by $P_{\\mathrm{th}}(T,V)=-\\partial F_{\\mathrm{vib}}/\\partial V$ at fixed $T$. Express your final result as closed-form analytic expressions in terms of $\\hbar$, $k_B$, $T$, $V$, $\\omega_0$, $V_0$, and $\\gamma$. Provide your answer as two expressions collected together, with no numerical evaluation required.",
            "solution": "The user has asked for the derivation of the vibrational Helmholtz free energy, $F_{\\mathrm{vib}}(T,V)$, and the thermal pressure, $P_{\\mathrm{th}}(T,V)$, for a single vibrational mode within the quasi-harmonic approximation.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **System**: A single, non-degenerate vibrational mode in a high-entropy alloy.\n- **Model**: Quasi-harmonic approximation (QHA), modeled as a quantum harmonic oscillator.\n- **Angular Frequency**: $\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$, where $V$ is the crystal volume, $\\gamma0$ is a constant mode Grüneisen parameter, $\\omega_0$ is the frequency at a reference volume $V_0$.\n- **Thermodynamic Ensemble**: Canonical ensemble at temperature $T$.\n- **Energy Spectrum**: $E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$ for $n=0,1,2,\\dots$, where $\\hbar$ is the reduced Planck constant.\n- **Helmholtz Free Energy Definition**: $F=-k_B T \\ln Z$, where $k_B$ is the Boltzmann constant and $Z$ is the canonical partition function.\n- **Thermal Pressure Definition**: $P_{\\mathrm{th}}(T,V)=-\\partial F_{\\mathrm{vib}}/\\partial V$ at fixed $T$.\n- **QHA Constraint**: $\\omega$ is treated as a fixed parameter at a given $V$ when performing thermal averages.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in standard statistical mechanics and solid-state physics. The quasi-harmonic approximation, the energy levels of a quantum harmonic oscillator, the definition of the canonical partition function, Helmholtz free energy, and thermal pressure are all fundamental and standard concepts. The Grüneisen parameter and its use in defining the volume dependence of vibrational frequencies is a cornerstone of the QHA.\n- **Well-Posed**: The problem is well-posed. It provides all necessary definitions and starting points to derive the two requested quantities, $F_{\\mathrm{vib}}(T,V)$ and $P_{\\mathrm{th}}(T,V)$, in a unique and meaningful way.\n- **Objective**: The problem is stated using precise, objective scientific language.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. All required parameters and relationships are provided.\n- **Unrealistic/Infeasible**: The model is an approximation but is physically plausible and widely used in materials modeling.\n- **Other Flaws**: The problem is not trivial, ill-posed, or unverifiable.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Derivation of the Vibrational Helmholtz Free Energy, $F_{\\mathrm{vib}}(T,V)$\n\nThe first step is to compute the canonical partition function $Z$ for a single quantum harmonic oscillator with energy levels $E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$.\n$$Z = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{E_n}{k_B T}\\right) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)}{k_B T}\\right)$$\nWe can separate the sum into two exponential factors:\n$$Z = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{n\\hbar \\omega(V)}{k_B T}\\right) = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right]^n$$\nThe summation is a geometric series of the form $\\sum_{n=0}^{\\infty} x^n = \\frac{1}{1-x}$ with $x = \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)$. Since $\\hbar$, $\\omega(V)$, $k_B$, and $T$ are all positive, we have $0  x  1$, so the series converges.\n$$Z = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\frac{1}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} = \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}$$\nThe vibrational Helmholtz free energy $F_{\\mathrm{vib}}$ is given by $F_{\\mathrm{vib}} = -k_B T \\ln Z$.\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\ln\\left[\\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}\\right]$$\nUsing the properties of logarithms, $\\ln(a/b) = \\ln(a) - \\ln(b)$:\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\left[ \\ln\\left(\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)\\right) - \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right) \\right]$$\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\left[ -\\frac{\\hbar \\omega(V)}{2k_B T} - \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right) \\right]$$\n$$F_{\\mathrm{vib}}(T,V) = \\frac{1}{2}\\hbar \\omega(V) + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)$$\nThis expression separates the free energy into the zero-point energy term, $\\frac{1}{2}\\hbar \\omega(V)$, and a temperature-dependent term originating from thermal excitations.\n\nFinally, we substitute the given volume dependence of the frequency, $\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$:\n$$F_{\\mathrm{vib}}(T,V) = \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + k_B T \\ln\\left(1 - \\exp\\left[-\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right]\\right)$$\nThis is the final expression for the vibrational Helmholtz free energy.\n\n### Step 3: Derivation of the Thermal Pressure, $P_{\\mathrm{th}}(T,V)$\n\nThe thermal pressure is defined as $P_{\\mathrm{th}}(T,V) = -\\frac{\\partial F_{\\mathrm{vib}}}{\\partial V}$ at constant $T$. We differentiate the derived expression for $F_{\\mathrm{vib}}(T,V)$ with respect to $V$. It is useful to first find the derivative of $\\omega(V)$ with respect to $V$:\n$$\\omega(V) = \\omega_0 \\left(\\frac{1}{V_0}\\right)^{-\\gamma} V^{-\\gamma} = \\omega_0 V_0^{\\gamma} V^{-\\gamma}$$\n$$\\frac{\\partial \\omega(V)}{\\partial V} = \\omega_0 V_0^{\\gamma} (-\\gamma) V^{-\\gamma-1} = -\\gamma \\frac{\\omega_0 V_0^{\\gamma} V^{-\\gamma}}{V} = -\\gamma \\frac{\\omega(V)}{V}$$\nNow, we differentiate $F_{\\mathrm{vib}}(T,V)$ term by term:\n$$P_{\\mathrm{th}}(T,V) = -\\frac{\\partial}{\\partial V}\\left[\\frac{1}{2}\\hbar \\omega(V) + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)\\right]$$\nLet's differentiate the two terms separately.\nFirst term:\n$$-\\frac{\\partial}{\\partial V}\\left(\\frac{1}{2}\\hbar \\omega(V)\\right) = -\\frac{1}{2}\\hbar \\frac{\\partial \\omega(V)}{\\partial V} = -\\frac{1}{2}\\hbar \\left(-\\gamma \\frac{\\omega(V)}{V}\\right) = \\frac{\\gamma}{V} \\frac{1}{2}\\hbar \\omega(V)$$\nSecond term (using the chain rule):\n$$-\\frac{\\partial}{\\partial V}\\left[k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)\\right] = -k_B T \\frac{1}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\frac{\\partial}{\\partial V}\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)$$\n$$-k_B T \\frac{-\\left[\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right) \\cdot \\left(-\\frac{\\hbar}{k_B T}\\right) \\frac{\\partial \\omega(V)}{\\partial V}\\right]}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} = - \\hbar \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\frac{\\partial \\omega(V)}{\\partial V}$$\nSubstituting $\\frac{\\partial \\omega(V)}{\\partial V} = -\\gamma \\frac{\\omega(V)}{V}$:\n$$- \\hbar \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\left(-\\gamma \\frac{\\omega(V)}{V}\\right) = \\frac{\\gamma}{V} \\frac{\\hbar \\omega(V) \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}$$\nTo simplify this fraction, we multiply the numerator and denominator by $\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right)$:\n$$\\frac{\\gamma}{V} \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}$$\nCombining the derivatives of both terms:\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\frac{1}{2}\\hbar \\omega(V) + \\frac{\\gamma}{V} \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}$$\nFactoring out the common term $\\frac{\\gamma}{V}$:\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\left[\\frac{1}{2}\\hbar \\omega(V) + \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}\\right]$$\nThe term in the square brackets is the total vibrational internal energy $U_{\\mathrm{vib}}(T,V)$ of the oscillator, consisting of the zero-point energy and the thermal energy.\nFinally, we substitute the expression for $\\omega(V)$:\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\left[ \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + \\frac{\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma}}{\\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right) - 1} \\right]$$\nThis is the final expression for the thermal pressure.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right)\\right)  \\frac{\\gamma}{V} \\left[ \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + \\frac{\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma}}{\\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right) - 1} \\right] \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the concept of vibrational pressure, this practice explores a tangible and purely quantum mechanical consequence: the expansion of a crystal lattice due to zero-point energy, even at a temperature of absolute zero. You will employ the Debye model to represent the solid's full vibrational spectrum and combine it with the static lattice's equation of state. This exercise demonstrates how to determine the new equilibrium volume by balancing the internal zero-point pressure against the material's elastic stiffness, providing a quantitative prediction of a fundamental quantum effect in solids .",
            "id": "3755403",
            "problem": "A single-phase equiatomic high-entropy alloy is modeled as an isotropic Debye solid within the Quasi-Harmonic Approximation (QHA). At zero temperature, the Helmholtz free energy is the sum of the static lattice energy and the zero-point vibrational energy. The sample is held under an external hydrostatic pressure $P_{0}$, and the cold (static-lattice) equilibrium volume at $P_{0}$ is $V_{0}$. The isothermal bulk modulus at this state is $B_{0}$, defined by $B_{0}=-V\\left(\\partial P_{\\mathrm{cold}}/\\partial V\\right)\\big|_{V_{0}}$. The Debye temperature depends on volume as $\\Theta_{D}(V)=\\Theta_{D0}\\left(V/V_{0}\\right)^{-\\gamma}$, where $\\gamma$ is a constant Grüneisen parameter and $\\Theta_{D0}=\\Theta_{D}(V_{0})$. The system contains $N$ atoms.\n\nStarting from fundamental definitions—pressure $P(V)=-\\partial F/\\partial V$ at fixed temperature and the Debye-model zero-point vibrational energy at $T=0$—and working consistently to leading order in the small fractional volumetric change $\\Delta V/V_{0}$, determine the analytic expression for the volumetric shift $\\Delta V=V-V_{0}$ at $T=0$ produced by zero-point vibrations by solving $P_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V)=P_{0}$ to first order. Express your final answer symbolically in terms of $N$, $k_{B}$, $\\gamma$, $\\Theta_{D0}$, and $B_{0}$. No numerical evaluation is required.",
            "solution": "We begin from the Quasi-Harmonic Approximation (QHA) at zero temperature, where the Helmholtz free energy is\n$$\nF(V,T=0)=U_{\\mathrm{cold}}(V)+E_{\\mathrm{ZP}}(V),\n$$\nwith $U_{\\mathrm{cold}}(V)$ the static lattice energy and $E_{\\mathrm{ZP}}(V)$ the zero-point vibrational energy. The mechanical pressure at fixed temperature is defined by\n$$\nP(V)=-\\frac{\\partial F}{\\partial V}=-\\frac{\\partial U_{\\mathrm{cold}}}{\\partial V}-\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V}\\equiv P_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V).\n$$\n\nFor a Debye solid with $N$ atoms, the well-tested Debye-model expression for the zero-point energy is\n$$\nE_{\\mathrm{ZP}}(V)=\\frac{9}{8}N k_{B}\\,\\Theta_{D}(V),\n$$\nwhere $\\Theta_{D}(V)$ is the Debye temperature. Therefore, the zero-point vibrational pressure is\n$$\nP_{\\mathrm{ZP}}(V)=-\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V}=-\\frac{9}{8}N k_{B}\\,\\frac{\\partial \\Theta_{D}(V)}{\\partial V}.\n$$\nGiven $\\Theta_{D}(V)=\\Theta_{D0}\\left(\\frac{V}{V_{0}}\\right)^{-\\gamma}$, its derivative is\n$$\n\\frac{\\partial \\Theta_{D}}{\\partial V}=\\Theta_{D0}\\left(-\\gamma\\right)\\left(\\frac{V}{V_{0}}\\right)^{-\\gamma-1}\\frac{1}{V_{0}}=-\\gamma\\,\\frac{\\Theta_{D}(V)}{V}.\n$$\nThus,\n$$\nP_{\\mathrm{ZP}}(V)=-\\frac{9}{8}N k_{B}\\left(-\\gamma\\,\\frac{\\Theta_{D}(V)}{V}\\right)=\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D}(V)}{V}.\n$$\n\nWe next linearize the static-lattice (cold) equation of state near $V_{0}$ at $P_{0}$. The isothermal bulk modulus at this state is\n$$\nB_{0}=-V\\left(\\frac{\\partial P_{\\mathrm{cold}}}{\\partial V}\\right)\\Big|_{V_{0}},\n$$\nso the first-order Taylor expansion of $P_{\\mathrm{cold}}(V)$ about $V_{0}$ is\n$$\nP_{\\mathrm{cold}}(V)\\approx P_{0}-\\frac{B_{0}}{V_{0}}\\,(V-V_{0})=P_{0}-\\frac{B_{0}}{V_{0}}\\,\\Delta V,\n$$\nwhere $\\Delta V\\equiv V-V_{0}$.\n\nMechanical equilibrium at $T=0$ with external pressure $P_{0}$ requires\n$$\nP_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V)=P_{0}.\n$$\nSubstituting the linearized $P_{\\mathrm{cold}}$ and evaluating $P_{\\mathrm{ZP}}$ to leading order at $V\\approx V_{0}$ (so $\\Theta_{D}(V)\\approx \\Theta_{D0}$ and $V\\approx V_{0}$) yields\n$$\nP_{0}-\\frac{B_{0}}{V_{0}}\\,\\Delta V+\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}=P_{0}.\n$$\nThe approximation $P_{\\mathrm{ZP}}(V)\\approx P_{\\mathrm{ZP}}(V_{0})$ is consistent to first order because the fractional change in $P_{\\mathrm{ZP}}$ due to $\\Delta V$ is $\\mathcal{O}(\\gamma\\,\\Delta V/V_{0})$, and $\\Delta V$ itself is first order in the small ratio $E_{\\mathrm{ZP}}/B_{0}V_{0}$; thus the product is second order and negligible at leading order.\n\nCanceling $P_{0}$ on both sides and solving for $\\Delta V$ gives\n$$\n-\\frac{B_{0}}{V_{0}}\\,\\Delta V+\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}=0\n\\quad\\Longrightarrow\\quad\n\\Delta V=\\frac{V_{0}}{B_{0}}\\left(\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}\\right)=\\frac{9}{8}\\,\\frac{N k_{B}\\,\\gamma\\,\\Theta_{D0}}{B_{0}}.\n$$\n\nThis is the leading-order volumetric shift at $T=0$ induced by zero-point vibrational pressure for a Debye solid with $\\Theta_{D}(V)\\propto V^{-\\gamma}$.",
            "answer": "$$\\boxed{\\frac{9}{8}\\,\\frac{N k_{B}\\,\\gamma\\,\\Theta_{D0}}{B_{0}}}$$"
        },
        {
            "introduction": "This final practice integrates the preceding concepts into a complete computational workflow, a task central to modern materials modeling and design. You will develop a program to calculate the full Gibbs free energy $G(T,P)$ as a function of temperature and pressure. The exercise involves combining a realistic equation of state for the static lattice energy with the quasi-harmonic Debye model for the vibrational free energy, and then performing a numerical minimization to find the equilibrium volume. This task bridges theory and application, turning physical models into a predictive tool for thermodynamic properties .",
            "id": "3755401",
            "problem": "You are asked to implement a quasi-harmonic approximation for vibrational free energy in the context of high-entropy alloys and complex materials modeling. The fundamental thermodynamic objective is to obtain, for each specified temperature and pressure, the equilibrium volume that minimizes the Legendre transform of the Helmholtz free energy, and to report the corresponding Gibbs free energy. The modeling assumptions are as follows: the static lattice energy is described by a third-order Birch–Murnaghan cold curve, and the vibrational free energy is modeled by the Debye approximation with a volume-dependent Debye temperature that follows a power law.\n\nStarting from the following foundations:\n- The Helmholtz free energy $F(T,V)$ equals the internal energy minus the product of temperature and entropy, namely $F(T,V) = U(T,V) - T S(T,V)$.\n- In the quasi-harmonic approximation, write $F(T,V)$ as a sum of the static lattice energy and the vibrational free energy, $F(T,V) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V)$.\n- The Gibbs free energy $G(T,P)$ at a pressure $P$ is the minimum, with respect to volume $V$, of the Legendre transform $F(T,V) + P V$.\n- For a Debye solid, the vibrational free energy can be written as a frequency integral over the phonon density of states, which for the Debye model is a quadratic function with a cut-off, and the Debye temperature $\\Theta_D(V)$ is proportional to a negative power of the volume according to a Grüneisen-like law.\n\nYour tasks:\n1. From the definition of Gibbs free energy as the Legendre transform of Helmholtz free energy, and using the quasi-harmonic decomposition and the Debye model with a volume-dependent Debye temperature, derive the expression for $G(T,P)$ as the minimum of a scalar function of $V$ built from $E_{\\mathrm{static}}(V)$, $F_{\\mathrm{vib}}(T,V)$, and $P V$. The derivation should start only from well-tested formulas and facts: the relation $G=F+PV$ at equilibrium, the definition of Helmholtz free energy, the Debye integral representation with a cut-off frequency proportional to $\\Theta_D(V)$, and the functional form $\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}$ with constants $\\Theta_{D0}$, $V_0$, and $\\gamma$.\n2. Explicitly construct a numerically stable procedure to locate the $V$ that minimizes the scalar function $\\Phi(V;T,P) = F(T,V) + P V$, with $F(T,V)$ built from a third-order Birch–Murnaghan static energy and a Debye-model vibrational contribution. Your procedure must:\n   - Use a bounded one-dimensional minimization algorithm over a physically sensible interval for $V$ around the reference volume $V_0$.\n   - Evaluate the Debye vibrational free energy using its integral representation in terms of the dimensionless integration variable and the upper limit $\\Theta_D(V)/T$, correctly including the zero-point term when $T$ is close to $0$.\n   - Handle unit conversions rigorously. Use $k_B$ in electronvolts per kelvin, and convert pressure from gigapascals to electronvolts per cubic angstrom using the identity $1\\,\\mathrm{eV}/\\text{\\AA}^3 = 160.21766208\\,\\mathrm{GPa}$.\n3. Implement the complete procedure in a single, runnable program that, for each test case, returns the minimizing volume and the corresponding Gibbs free energy.\n\nPhysical and numerical units, and output specification:\n- Volumes must be expressed in cubic angstroms per atom ($\\text{\\AA}^3$/atom).\n- Temperatures must be in kelvin ($\\mathrm{K}$).\n- Pressures must be in gigapascals ($\\mathrm{GPa}$).\n- Energies must be expressed in electronvolts per atom ($\\mathrm{eV}$/atom).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result is a two-element list $[V^\\ast, G(T,P)]$ with both entries rounded to six decimal places, for example, $[[12.000000,-3.000000],[\\dots,\\dots],\\dots]$.\n\nTest suite:\nUse the following material parameters, which are representative of a single-atom surrogate for a random solid solution in a high-entropy alloy:\n- Reference energy $E_0 = -3.000000\\,\\mathrm{eV}$/atom.\n- Reference volume $V_0 = 12.000000\\,\\text{\\AA}^3$/atom.\n- Bulk modulus at $V_0$ equal to $B_0 = 180.000000\\,\\mathrm{GPa}$.\n- First derivative of the bulk modulus at $V_0$ equal to $B_0' = 5.000000$.\n- Reference Debye temperature $\\Theta_{D0} = 350.000000\\,\\mathrm{K}$.\n- Grüneisen parameter $\\gamma = 1.800000$, entering $\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}$.\n\nRun your program on the following set of temperature-pressure conditions to test multiple regimes:\n- Case A (edge case, zero temperature and pressure): $T = 0.000000\\,\\mathrm{K}$, $P = 0.000000\\,\\mathrm{GPa}$.\n- Case B (thermal expansion at ambient pressure): $T = 1200.000000\\,\\mathrm{K}$, $P = 0.000000\\,\\mathrm{GPa}$.\n- Case C (hot and moderately compressed): $T = 1200.000000\\,\\mathrm{K}$, $P = 30.000000\\,\\mathrm{GPa}$.\n- Case D (room temperature, high pressure): $T = 300.000000\\,\\mathrm{K}$, $P = 50.000000\\,\\mathrm{GPa}$.\n\nAlgorithmic requirements:\n- Use a bounded minimization over $V \\in [0.600000\\,V_0,\\,1.400000\\,V_0]$.\n- Treat the $T \\to 0$ limit by retaining only the zero-point term in the Debye free energy.\n- Ensure numerical integration of the Debye free energy converges robustly for large $\\Theta_D(V)/T$.\n\nFinal output format:\nYour program should produce a single line of output containing the four two-element lists for Cases A–D, in order, as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places: $[[V_A^\\ast,G_A],[V_B^\\ast,G_B],[V_C^\\ast,G_C],[V_D^\\ast,G_D]]$.",
            "solution": "The problem requires the implementation of a quasi-harmonic approximation (QHA) to determine the equilibrium thermodynamic properties of a material. Specifically, for a given temperature $T$ and pressure $P$, we must find the equilibrium volume $V^\\ast$ that minimizes the Gibbs free energy functional $\\Phi(V; T, P)$, and report both $V^\\ast$ and the corresponding minimized Gibbs free energy $G(T,P) = \\Phi(V^\\ast; T, P)$. The functional is defined as the Legendre transform of the Helmholtz free energy $F(T,V)$:\n$$\n\\Phi(V; T, P) = F(T,V) + P V\n$$\nWithin the QHA framework, the Helmholtz free energy is decomposed into a static lattice energy $E_{\\mathrm{static}}(V)$ and a volume-dependent vibrational free energy $F_{\\mathrm{vib}}(T,V)$:\n$$\nF(T,V) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V)\n$$\nTherefore, our objective is to find the minimum of the following function with respect to volume $V$:\n$$\n\\Phi(V; T, P) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V) + P V\n$$\nThe problem specifies the models for each term, which we will now elaborate. All energies and volumes are expressed per atom.\n\n**Static Lattice Energy: Third-Order Birch–Murnaghan Equation of State**\n\nThe static energy of the crystal lattice as a function of volume, $E_{\\mathrm{static}}(V)$, is described by the third-order Birch–Murnaghan equation of state. This equation is derived from the expansion of the free energy in terms of the Eulerian finite strain. The energy per atom is given by:\n$$\nE_{\\mathrm{static}}(V) = E_0 + \\frac{9 V_0 B_0}{16} \\left\\{ \\left[ \\left(\\frac{V_0}{V}\\right)^{2/3} - 1 \\right]^3 B_0' + \\left[ \\left(\\frac{V_0}{V}\\right)^{2/3} - 1 \\right]^2 \\left[ 6 - 4 \\left(\\frac{V_0}{V}\\right)^{2/3} \\right] \\right\\}\n$$\nHere, $E_0$ is the reference energy, $V_0$ is the reference volume, $B_0$ is the bulk modulus at $V_0$, and $B_0'$ is the first pressure derivative of the bulk modulus at $V_0$. For consistency in our energy calculations, the bulk modulus $B_0$, given in gigapascals (GPa), must be converted to electronvolts per cubic angstrom ($\\mathrm{eV}/\\text{\\AA}^3$) using the provided conversion factor $1\\,\\mathrm{eV}/\\text{\\AA}^3 = 160.21766208\\,\\mathrm{GPa}$.\n\n**Vibrational Free Energy: Debye Model**\n\nThe vibrational contribution to the free energy, $F_{\\mathrm{vib}}(T,V)$, is calculated using the Debye model. In this model, the vibrational free energy per atom is the sum of the athermal zero-point energy (ZPE) and the temperature-dependent thermal free energy:\n$$\nF_{\\mathrm{vib}}(T,V) = E_{\\mathrm{ZPE}}(V) + F_{\\mathrm{th}}(T,V)\n$$\nThe zero-point energy is given by:\n$$\nE_{\\mathrm{ZPE}}(V) = \\frac{9}{8} k_B \\Theta_D(V)\n$$\nwhere $k_B$ is the Boltzmann constant and $\\Theta_D(V)$ is the volume-dependent Debye temperature. The thermal component of the vibrational free energy is:\n$$\nF_{\\mathrm{th}}(T,V) = k_B T \\left[ 3 \\ln\\left(1 - e^{-\\Theta_D(V)/T}\\right) - D_3\\left(\\frac{\\Theta_D(V)}{T}\\right) \\right]\n$$\nHere, $D_3(y)$ is the third-order Debye function, defined by the integral:\n$$\nD_3(y) = \\frac{3}{y^3} \\int_0^y \\frac{t^3}{e^t - 1} dt\n$$\nThe Debye temperature's dependence on volume is modeled by a power law, consistent with Grüneisen theory:\n$$\n\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}\n$$\nwhere $\\Theta_{D0}$ is the Debye temperature at the reference volume $V_0$, and $\\gamma$ is the Grüneisen parameter.\n\nCombining these terms, the full expression for the vibrational free energy is:\n$$\nF_{\\mathrm{vib}}(T,V) = \\frac{9}{8} k_B \\Theta_D(V) + k_B T \\left[ 3 \\ln\\left(1 - e^{-\\Theta_D(V)/T}\\right) - D_3\\left(\\frac{\\Theta_D(V)}{T}\\right) \\right]\n$$\nFor the special case of $T=0\\,\\mathrm{K}$, the thermal term $F_{\\mathrm{th}}(T,V)$ vanishes, and the vibrational free energy reduces to the zero-point energy, $F_{\\mathrm{vib}}(0,V) = E_{\\mathrm{ZPE}}(V)$.\n\n**Pressure-Volume Term and Unit Consistency**\n\nThe final term in the Gibbs functional is the work term, $P V$. To maintain unit consistency with the energy terms calculated in electronvolts ($\\mathrm{eV}$), the pressure $P$ given in gigapascals ($\\mathrm{GPa}$) must be converted to $\\mathrm{eV}/\\text{\\AA}^3$. The energy of this term is calculated as:\n$$\nE_{PV} = P\\,[\\mathrm{GPa}] \\times V\\,[\\text{\\AA}^3] \\times \\frac{1}{160.21766208} \\,[\\mathrm{eV}/(\\mathrm{GPa}\\cdot\\text{\\AA}^3)]\n$$\n\n**Numerical Minimization Procedure**\n\nThe equilibrium volume $V^\\ast$ for a given pair $(T, P)$ is found by numerically minimizing the objective function $\\Phi(V; T, P)$ with respect to $V$. We employ a bounded one-dimensional minimization algorithm, `scipy.optimize.minimize_scalar` with `method='bounded'`, over the physically reasonable interval $V \\in [0.600000\\,V_0, 1.400000\\,V_0]$.\n\nThe numerical implementation requires careful handling of certain aspects:\n1.  **Zero Temperature Limit**: For $T  10^{-6}\\,\\mathrm{K}$, we explicitly set $F_{\\mathrm{vib}}(T,V) = E_{\\mathrm{ZPE}}(V)$ to avoid division by zero and other numerical instabilities.\n2.  **Debye Integral**: The integral for the Debye function $D_3(y)$ is evaluated numerically using `scipy.integrate.quad`. For large values of the upper limit $y = \\Theta_D(V)/T$, the integral rapidly converges to the known analytical limit $\\int_0^\\infty \\frac{t^3}{e^t - 1} dt = \\frac{\\pi^4}{15}$. This asymptotic value is used for $y  100$ to ensure stability and efficiency. The integrand at $t=0$ is non-singular, and `scipy.integrate.quad` can handle it correctly. The expression `np.expm1(t)` is used in the denominator `e^t-1` for improved precision at small $t$.\n3.  **Logarithmic Term**: The term $\\ln(1 - e^{-y})$ is evaluated as `np.log1p(-np.exp(-y))` to maintain numerical precision when $y$ is large and $e^{-y}$ is close to zero.\n\nThe procedure is executed for each test case $(T,P)$. The minimization routine returns the optimal volume $V^\\ast$ and the minimized value of the function $\\Phi(V^\\ast; T,P)$, which corresponds to the Gibbs free energy $G(T,P)$. The final results are collected and formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the equilibrium volume and Gibbs free energy for a material\n    using the quasi-harmonic approximation with a Birch-Murnaghan static energy\n    term and a Debye model for vibrational free energy.\n    \"\"\"\n\n    # Physical constants\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    GPA_TO_EV_PER_A3 = 1.0 / 160.21766208  # Conversion factor\n\n    # Material parameters from the problem statement\n    E0 = -3.000000         # Reference energy in eV/atom\n    V0 = 12.000000         # Reference volume in A^3/atom\n    B0 = 180.000000        # Bulk modulus in GPa\n    B0_PRIME = 5.000000    # First derivative of bulk modulus\n    THETA_D0 = 350.000000  # Reference Debye temperature in K\n    GAMMA = 1.800000       # Grüneisen parameter\n\n    # Test cases: (Temperature [K], Pressure [GPa])\n    test_cases = [\n        (0.000000, 0.000000),    # Case A\n        (1200.000000, 0.000000), # Case B\n        (1200.000000, 30.000000),# Case C\n        (300.000000, 50.000000), # Case D\n    ]\n\n    # Pre-calculate constants for efficiency\n    B0_EV_A3 = B0 * GPA_TO_EV_PER_A3\n    DEBYE_INTEGRAL_INF = np.pi**4 / 15.0\n\n    memoized_debye_integrals = {}\n\n    def get_debye_integral(y):\n        \"\"\"\n        Numerically calculates the integral component of the Debye function,\n        with memoization and an asymptotic limit for large y.\n        \"\"\"\n        if y in memoized_debye_integrals:\n            return memoized_debye_integrals[y]\n        \n        if y > 100.0:  # Use asymptotic limit for large y\n            result = DEBYE_INTEGRAL_INF\n        else:\n            integrand = lambda t: t**3 / np.expm1(t)\n            result, _ = quad(integrand, 0, y)\n        \n        memoized_debye_integrals[y] = result\n        return result\n\n    def static_energy(V):\n        \"\"\"Calculates the static lattice energy using the 3rd-order Birch-Murnaghan EOS.\"\"\"\n        eta = (V0 / V)**(2.0/3.0)\n        term1 = (eta - 1)**3 * B0_PRIME\n        term2 = (eta - 1)**2 * (6 - 4 * eta)\n        return E0 + (9 * V0 * B0_EV_A3 / 16) * (term1 + term2)\n\n    def vibrational_free_energy(T, V):\n        \"\"\"Calculates the vibrational free energy using the Debye model.\"\"\"\n        if V = 1e-9: # Avoid division by zero for volume\n            return np.inf\n        \n        theta_d_v = THETA_D0 * (V / V0)**(-GAMMA)\n        \n        # Zero-point energy (athermal component)\n        zpe = 9.0 / 8.0 * KB_EV_K * theta_d_v\n\n        # Handle T=0 K case explicitly to avoid numerical issues\n        if T  1e-6:\n            return zpe\n\n        y = theta_d_v / T\n\n        # Thermal component\n        debye_integral_val = get_debye_integral(y)\n        d3 = (3.0 / y**3) * debye_integral_val\n        \n        # Use np.log1p for precision: log(1-exp(-y))\n        log_term = np.log1p(-np.exp(-y)) if y  700 else 0.0\n\n        f_thermal = KB_EV_K * T * (3.0 * log_term - d3)\n        \n        return zpe + f_thermal\n\n    def objective_function(V, T, P):\n        \"\"\"The Gibbs free energy functional to be minimized.\"\"\"\n        e_static = static_energy(V)\n        f_vib = vibrational_free_energy(T, V)\n        pv_term = P * GPA_TO_EV_PER_A3 * V\n        return e_static + f_vib + pv_term\n\n    results = []\n    for T, P in test_cases:\n        # Clear memoization cache for each new minimization\n        memoized_debye_integrals.clear()\n\n        # Define the function to be minimized for the current T and P\n        func_to_minimize = lambda v: objective_function(v, T, P)\n        \n        # Define bounds for the minimization\n        bounds = (0.6 * V0, 1.4 * V0)\n        \n        # Perform bounded scalar minimization\n        res = minimize_scalar(\n            func_to_minimize,\n            bounds=bounds,\n            method='bounded',\n            options={'xatol': 1e-9, 'maxiter': 500}\n        )\n        \n        v_star = res.x\n        g_min = res.fun\n        \n        results.append([v_star, g_min])\n\n    # Format the final output string exactly as specified\n    formatted_results = [f'[{v:.6f},{g:.6f}]' for v, g in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}