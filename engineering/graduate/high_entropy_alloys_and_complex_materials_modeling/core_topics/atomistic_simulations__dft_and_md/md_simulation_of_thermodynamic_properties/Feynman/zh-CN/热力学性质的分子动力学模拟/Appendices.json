{
    "hands_on_practices": [
        {
            "introduction": "分子动力学模拟的准确性在很大程度上取决于所用力场的物理真实性。在实践中，为了计算效率，通常会对原子间相互作用势进行截断，但这会引入需要校正的误差。本练习旨在通过推导伦纳德-琼斯势的“长程校正”项，来加深您对这一常用技术的理解，并更进一步，挑战您批判性地思考，对于像高熵合金这样的复杂金属体系，这种校正的物理适用性 。这项实践将理论推导与物理直觉相结合，突显了在应用计算方法时审视其基本假设的重要性。",
            "id": "3751171",
            "problem": "一个研究小组正在进行分子动力学（MD）模拟，以估算一种稠密流体的热力学性质。该流体用于模拟原子相互作用中的排斥核及吸引色散部分。该流体由兰纳-琼斯形式的对心相互作用势 $u(r) = 4 \\varepsilon \\left[ \\left( \\sigma / r \\right)^{12} - \\left( \\sigma / r \\right)^{6} \\right]$ 描述，该势在截断距离 $r_{c}$ 处被截断，且没有任何平移。该系统在数密度为 $\\rho$ 时是均匀且各向同性的。在截断距离之外，他们采用标准假设，即径向分布函数为1，即对于 $r \\ge r_{c}$ 有 $g(r) \\approx 1$。\n\n仅从以下基本原理出发：\n- 通过对心势相互作用的均匀各向同性系统中每个粒子的势能定义，以及\n- 通过对心势相互作用的均匀各向同性系统中压力的维里表达式，\n\n推导为计入被忽略的、超出 $r_{c}$ 的相互作用而必须添加的长程（尾部）校正的闭合形式表达式：\n- 缺失的每个粒子的势能 $U_{\\mathrm{tail}}/N$，以及\n- 缺失的压力贡献 $P_{\\mathrm{tail}}$。\n\n在 $r \\ge r_{c}$ 时 $g(r) = 1$ 的假设下，最终公式仅用 $\\rho$、$\\varepsilon$、$\\sigma$ 和 $r_{c}$ 表示。不要进行数值计算。如果要对这些公式进行求值，每个粒子的能量应以焦耳表示，压力应以帕斯卡表示，但不要在方框内的表达式中附加单位。\n\n最后，考虑使用多体势（如嵌入原子方法，EAM）建模的金属高熵合金（HEAs）。基于相互作用模型的第一性原理以及金属中的屏蔽效应，论证将这些兰纳-琼斯类型的尾部校正应用于 $U$ 和 $P$ 对于金属高熵合金在物理上是否合适。\n\n你的最终答案必须仅包含 $U_{\\mathrm{tail}}/N$ 和 $P_{\\mathrm{tail}}$ 这两个解析表达式，形式为单行矩阵。无需四舍五入。",
            "solution": "该问题具有科学依据，提法恰当，并包含足够的信息以获得唯一解。其前提基于统计力学和计算物理学的标准原理。因此，该问题是有效的。我们开始推导。\n\n任务是为一个通过截断的兰纳-琼斯势相互作用的系统，推导其每个粒子的势能和压力的长程（尾部）校正。我们从数密度为 $\\rho=N/V$ 的均匀各向同性系统中这些量的基本统计力学表达式开始。\n\n每个粒子的势能 $U/N$ 由对势 $u(r)$ 乘以径向分布函数 $g(r)$ 进行加权积分给出：\n$$ \\frac{U}{N} = \\frac{1}{2} \\rho \\int_0^\\infty 4 \\pi r^2 g(r) u(r) \\,dr $$\n压力 $P$ 由维里表达式给出：\n$$ P = \\rho k_B T - \\frac{2\\pi \\rho^2}{3} \\int_0^\\infty r^3 g(r) \\frac{du(r)}{dr} \\,dr $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度。第一项是理想气体贡献，第二项是来自粒子间相互作用的贡献。\n\n在势被截断距离 $r_c$ 截断的模拟中，这些积分只计算到 $r_c$。尾部校正是被忽略的积分部分（从 $r_c$ 到 $\\infty$）的贡献。问题指定在 $r \\ge r_c$ 时使用近似 $g(r) \\approx 1$。兰纳-琼斯势由以下公式给出：\n$$ u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] $$\n\n**1. 势能尾部校正 ($U_{\\mathrm{tail}}/N$)**\n\n每个粒子的势能的尾部校正 $U_{\\mathrm{tail}}/N$ 是从 $r_c$ 到 $\\infty$ 的积分值：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = \\frac{1}{2} \\rho \\int_{r_c}^\\infty 4 \\pi r^2 g(r) u(r) \\,dr $$\n代入 $g(r)=1$ 和兰纳-琼斯势：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 2 \\pi \\rho \\int_{r_c}^\\infty r^2 \\left( 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] \\right) \\,dr $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\int_{r_c}^\\infty r^2 \\left( \\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^6}{r^6} \\right) \\,dr $$\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr $$\n我们进行积分：\n$$ \\int \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^6\\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} $$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$ \\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^\\infty = \\lim_{r \\to \\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) $$\n$$ = (0 - 0) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} $$\n将此结果代回，得到能量校正的表达式：\n$$ \\frac{U_{\\mathrm{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) $$\n\n**2. 压力尾部校正 ($P_{\\mathrm{tail}}$)**\n\n压力的尾部校正 $P_{\\mathrm{tail}}$ 是相互作用项中来自距离 $r \\ge r_c$ 的贡献：\n$$ P_{\\mathrm{tail}} = - \\frac{2\\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 g(r) \\frac{du(r)}{dr} \\,dr $$\n首先，我们求兰纳-琼斯势的导数：\n$$ \\frac{du(r)}{dr} = 4 \\varepsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^6(-6)r^{-7} \\right] = 4 \\varepsilon \\left( -12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^6}{r^7} \\right) $$\n将此式和 $g(r)=1$ 代入 $P_{\\mathrm{tail}}$ 的积分中：\n$$ P_{\\mathrm{tail}} = - \\frac{2\\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\left[ 4 \\varepsilon \\left( -12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^6}{r^7} \\right) \\right] \\,dr $$\n$$ P_{\\mathrm{tail}} = - \\frac{8\\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( -12\\sigma^{12}r^{-10} + 6\\sigma^6r^{-4} \\right) \\,dr $$\n我们现在对括号中的表达式进行积分，这在能量校正的推导过程中已经计算过：\n$$ \\int_{r_c}^\\infty \\left( -12\\sigma^{12}r^{-10} + 6\\sigma^6r^{-4} \\right) \\,dr = \\left[ -12\\frac{\\sigma^{12}r^{-9}}{-9} + 6\\frac{\\sigma^6r^{-3}}{-3} \\right]_{r_c}^\\infty $$\n$$ = \\left[ \\frac{4\\sigma^{12}}{3r^9} - \\frac{2\\sigma^6}{r^3} \\right]_{r_c}^\\infty = (0 - 0) - \\left( \\frac{4\\sigma^{12}}{3r_c^9} - \\frac{2\\sigma^6}{r_c^3} \\right) = 2\\frac{\\sigma^6}{r_c^3} - \\frac{4\\sigma^{12}}{3r_c^9} $$\n将此结果代回 $P_{\\mathrm{tail}}$ 的表达式中：\n$$ P_{\\mathrm{tail}} = - \\frac{8\\pi \\rho^2 \\varepsilon}{3} \\left( 2\\frac{\\sigma^6}{r_c^3} - \\frac{4\\sigma^{12}}{3r_c^9} \\right) $$\n$$ P_{\\mathrm{tail}} = \\frac{8\\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{4\\sigma^{12}}{3r_c^9} - 2\\frac{\\sigma^6}{r_c^3} \\right) = \\frac{16\\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{2\\sigma^{12}}{3r_c^9} - \\frac{\\sigma^6}{r_c^3} \\right) $$\n\n**3. 对高熵合金（HEAs）的适用性**\n\n将这些兰纳-琼斯类型的尾部校正应用于像高熵合金（HEAs）这样的金属体系（使用如EAM等多体势进行建模）在物理上是不合适的。其原因在于原子相互作用性质上的根本差异。\n\n*   **相互作用类型**：兰纳-琼斯势是一种对势。其长程吸引项 $u(r) \\propto -r^{-6}$ 在物理上代表了由非极性原子中涨落的诱导偶极子产生的范德华力（或伦敦色散力）。这些力相对较弱且作用范围长。\n*   **金属键**：相比之下，金属和像高熵合金这样的金属合金中的成键，主要由遍布整个系统的共享离域价电子海洋所主导。这本质上是一种**多体**现象。一个原子的能量是其整个局域环境（特别是局域电子密度）的函数，而不仅仅是独立对键的总和。嵌入原子方法（EAM）就是为了捕捉这种多体特性而设计的。\n*   **屏蔽效应**：金属的一个关键特征是**静电屏蔽**。移动的传导电子会重新排列以屏蔽离子核的静电场。这导致有效的离子间势随距离衰减得非常快，通常是指数级的（例如，像汤川势中那样，$\\propto e^{-\\lambda r}/r$），而不是像 $r^{-6}$ 那样的缓慢幂律衰减。\n*   **结论**：由于强屏蔽效应，金属中的相互作用是短程的。像EAM这样的原子间势是在考虑到这一物理现实的情况下构建的，并且通常在一个距离（例如，$5-6$ 埃）处截断，超过该距离的相互作用被认为是可忽略的。因此，没有显著的长程 $r^{-6}$ 尾部需要考虑。将为范德华相互作用推导出的尾部校正应用于金属体系是一个概念性错误，它强加了一种不存在的物理相互作用。\n\n下面给出了尾部校正的最终推导表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)  \\frac{16\\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{2\\sigma^{12}}{3r_c^9} - \\frac{\\sigma^6}{r_c^3} \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "能量均分定理是连接微观动能与宏观温度的关键桥梁，但它的正确应用依赖于对系统“自由度”的精确计数。在模拟包含刚性原子团簇等约束条件的复杂系统时，系统的有效自由度会减少。本练习将引导您从第一性原理出发，推导在存在约束条件下（例如，模拟高熵合金中的刚性析出相）温度的修正表达式 ，从而揭示忽略这些约束将如何导致对系统温度的系统性低估，并强调在分子动力学模拟中正确处理约束的必要性。",
            "id": "3751144",
            "problem": "一种高熵合金（HEA）在微正则系综中通过经典分子动力学（MD）进行模拟，在两次恒温器相互作用之间进行短时间间隔的模拟。该系统总共包含 $N$ 个原子，这些原子可能具有不同的质量。这些原子的一部分形成了 $M$ 个不重叠的非线性刚性析出物团簇，其中第 $i$ 个刚性团簇包含 $n_i$ 个原子。剩余的原子不受约束并自由移动。MD的实现使用完整约束来强制每个团簇的刚性（团簇内部没有相对运动），并且它还对整个系统施加了总线性动量为零的约束（质心的平动被移除）。设由所有原子速度计算出的瞬时总动能为 $K$，并设 $k_B$ 表示玻尔兹曼常数。\n\n仅从经典能量均分定理和经典力学中动能的定义出发，推导出一个修正的瞬时动理学温度 $T$ 的闭式表达式，该表达式要考虑到因刚体约束和质心平动的移除而导致的可及二次自由度的减少。用 $K$、$k_B$、$N$、$M$ 以及集合 $\\{n_i\\}_{i=1}^{M}$ 来表示你的最终答案。你可以假设每个刚性团簇都是非线性的，因此它有三个转动自由度和三个平动自由度。在你的推导过程中，解释为什么在这个受约束的HEA模拟中使用 $3N$ 作为自由度数会导致有偏差的温度估计。\n\n以开尔文为单位表示最终温度。你的最终答案必须是一个单一的闭式解析表达式。",
            "solution": "该问题要求推导一个通过分子动力学模拟的、包含 $N$ 个原子且受到特定约束的系统的瞬时动理学温度 $T$。推导必须从经典能量均分定理开始。\n\n步骤1：提取已知条件\n- 原子总数：$N$\n- 不重叠、非线性的刚性析出物团簇数量：$M$\n- 第 $i$ 个团簇中的原子数：$n_i$，其中 $i = 1, \\dots, M$\n- 约束条件：\n  1. 强制 $M$ 个团簇中每一个都保持刚性的完整约束。\n  2. 整个 $N$ 原子系统的总线性动量为零。\n- 所有原子速度计算出的瞬时总动能：$K$\n- 玻尔兹曼常数：$k_B$\n- 不在团簇中的原子不受约束并自由移动。\n- 每个刚性团簇都是非线性的。\n\n步骤2：使用提取的已知条件进行验证\n该问题在科学上基于经典统计力学和计算物理学，特别是分子动力学模拟背后的理论。动理学温度、自由度、能量均分定理、刚体运动和质心约束等概念都是标准且定义明确的。问题设置，即含有析出物的高熵合金，是材料建模中的一个现实情景。该问题是适定的，提供了推导唯一解所需的所有必要信息和清晰定义。术语客观而精确。该问题不违反任何无效标准。因此，该问题被认为是有效的，并将提供解答。\n\n步骤3：求解推导\n经典能量均分定理指出，对于一个处于温度 $T$ 的热平衡系统，与每个二次自由度（即哈密顿量中与坐标或动量的平方成正比的项）相关的平均能量为 $\\frac{1}{2}k_B T$。\n\n系统的总动能 $K$ 是其所有组分动能的总和。在经典力学中，动能纯粹是动量（或速度）分量的函数，这些分量是哈密顿量中的二次项。如果系统有 $N_{dof}$ 个动能自由度，总动能就分布在这些模式中。瞬时动理学温度 $T$ 是通过将能量均分定理推广到系统的瞬时状态来定义的：\n$$K = \\frac{1}{2} N_{dof} k_B T$$\n从这个关系式中，温度 $T$ 可以表示为：\n$$T = \\frac{2K}{N_{dof} k_B}$$\n核心任务是通过考虑施加在系统上的所有约束，正确地确定动能自由度的总数 $N_{dof}$。\n\n1.  **初始自由度：** 在没有任何约束的情况下，系统由 $N$ 个独立的原子组成。每个原子有3个平动自由度，对应于其在 $x$、$y$ 和 $z$ 方向上的速度分量。因此，无约束自由度的总数将是 $3N$。\n\n2.  **由刚性团簇引起的约束：** 系统包含 $M$ 个刚性团簇。让我们分析由单个团簇 $i$ 施加的约束，该团簇由 $n_i$ 个原子组成。\n    - 如果这 $n_i$ 个原子是自由粒子，它们将共同贡献 $3n_i$ 个平动自由度。\n    - 然而，它们被绑定在一个刚体中。刚体的运动完全由其质心的平动和围绕质心的转动来描述。\n    - 对于一个非线性刚体（如问题中所述），有3个平动自由度和3个转动自由度。该刚性团簇的总自由度数为 $3 + 3 = 6$。\n    - 因此，这个刚性团簇的形成将自由度数从 $3n_i$ 减少到 $6$。对于团簇 $i$，由完整约束*移除*的自由度数为 $3n_i - 6$。\n    - 对所有 $M$ 个团簇求和，由于刚性约束而移除的总自由度数为 $\\sum_{i=1}^{M} (3n_i - 6)$。\n\n3.  **由总线性动量为零引起的约束：** 问题指出，整个 $N$ 原子系统的总线性动量为零。系统的质心定义为 $\\vec{R}_{CM} = \\frac{1}{\\sum m_j} \\sum_{j=1}^{N} m_j \\vec{r}_j$。其速度为 $\\vec{V}_{CM} = \\frac{1}{\\sum m_j} \\sum_{j=1}^{N} m_j \\vec{v}_j = \\frac{\\vec{P}_{total}}{\\sum m_j}$。\n    - 约束 $\\vec{P}_{total} = \\vec{0}$ 意味着 $\\vec{V}_{CM} = \\vec{0}$。\n    - 这个约束移除了与系统整体质心运动相关的3个平动自由度。\n\n4.  **计算净自由度（$N_{dof}$）：** 我们现在可以通过从总的无约束自由度数开始，减去所有约束移除的自由度数来计算最终的自由度数。\n    $$N_{dof} = (\\text{初始自由度}) - (\\text{团簇移除的自由度}) - (\\text{质心约束移除的自由度})$$\n    $$N_{dof} = 3N - \\sum_{i=1}^{M} (3n_i - 6) - 3$$\n    让我们简化这个表达式：\n    $$N_{dof} = 3N - \\left( \\sum_{i=1}^{M} 3n_i - \\sum_{i=1}^{M} 6 \\right) - 3$$\n    $$N_{dof} = 3N - 3 \\sum_{i=1}^{M} n_i + 6M - 3$$\n    为清晰起见，可将此表达式进行因式分解：\n    $$N_{dof} = 3 \\left( N - \\sum_{i=1}^{M} n_i + 2M - 1 \\right)$$\n\n5.  **温度的最终表达式：** 现在我们将这个 $N_{dof}$ 的表达式代入我们的温度方程中：\n    $$T = \\frac{2K}{k_B N_{dof}} = \\frac{2K}{k_B \\left( 3N - 3\\sum_{i=1}^{M} n_i + 6M - 3 \\right)}$$\n    $$T = \\frac{2K}{3 k_B \\left( N - \\sum_{i=1}^{M} n_i + 2M - 1 \\right)}$$\n这正是修正的瞬时动理学温度的闭式表达式。\n\n最后，我们来讨论为什么使用 $3N$ 作为自由度数会导致有偏差的温度估计。\n使用 $3N$ 个自由度计算出的温度将是 $T_{biased} = \\frac{2K}{3Nk_B}$。正确的自由度数是 $N_{dof} = 3N - 3\\sum_{i=1}^{M} n_i + 6M - 3$。\n为了证明 $N_{dof}  3N$，我们检查其差值：\n$$3N - N_{dof} = 3N - \\left( 3N - 3 \\sum_{i=1}^{M} n_i + 6M - 3 \\right) = 3 \\sum_{i=1}^{M} n_i - 6M + 3$$\n问题陈述了团簇是非线性的，这要求每个团簇最少有3个原子，所以对所有 $i$ 都有 $n_i \\ge 3$。\n这意味着 $\\sum_{i=1}^{M} n_i \\ge 3M$。\n将这个下界代入差值中：\n$$3\\sum_{i=1}^{M} n_i - 6M + 3 \\ge 3(3M) - 6M + 3 = 9M - 6M + 3 = 3M + 3$$\n因为至少有一个团簇（$M \\ge 1$），所以项 $3M + 3$ 是严格为正的。因此，$3N - N_{dof} > 0$，这意味着 $N_{dof}  3N$。\n因为温度与自由度数成反比（$T \\propto 1/N_{dof}$），在分母中使用更大且不正确的数值 $3N$ 将会系统性地导致对真实动理学温度的低估。与完全无约束的系统相比，该系统的动能分布在更少的有效运动模式中，因此每个模式平均拥有更多的能量，对应于更高的温度。",
            "answer": "$$\\boxed{\\frac{2K}{3k_B \\left(N - \\sum_{i=1}^{M} n_i + 2M - 1\\right)}}$$"
        },
        {
            "introduction": "分子动力学模拟生成的是时间上前后关联的数据序列，而非统计独立的样本，因此，直接套用标准统计公式计算平均值的误差会得出错误的结果。本练习将深入探讨分子动力学时间序列分析的核心问题，通过推导“有效样本量”$N_{\\mathrm{eff}}$ 的概念，来量化时间相关性如何增大了平均值的方差 。掌握这项技能对于报告可靠的热力学性质（如焓或体积）的统计不确定度至关重要，是确保计算结果科学严谨性的关键一步。",
            "id": "3751157",
            "problem": "使用分子动力学 (MD) 模拟一种五元等原子高熵合金 (HEA)，以估算其平衡焓。以均匀的时间间隔对瞬时焓进行采样，生成一个离散的平稳时间序列 $\\{H_{t}\\}_{t=1}^{N}$，其样本均值为 $\\bar{H} = \\frac{1}{N} \\sum_{t=1}^{N} H_{t}$。由于 MD 轨迹在时间上是相关的，对 $\\bar{H}$ 的不确定性估计必须考虑时间自相关性。设该过程为二阶平稳过程，其方差为 $\\sigma^{2} = \\operatorname{Var}(H_{t})$，归一化自相关函数为 $\\rho_{k} = \\frac{\\operatorname{Cov}(H_{t}, H_{t+k})}{\\sigma^{2}}$，且满足 $|\\rho_{k}| \\leq 1$。假设归一化自相关遵循一阶自回归 (AR) 模型，$\\rho_{k} = \\rho^{k}$ (对于 $k \\geq 1$)，其中 $|\\rho|  1$。从方差和协方差的核心定义出发，且不使用任何关于相关平均值的预先推导出的公式，完成以下任务：\n\n1. 对于一个通用的二阶平稳过程，推导一个用 $N$、$\\sigma^{2}$ 和 $\\{\\rho_{k}\\}$ 表示 $\\operatorname{Var}(\\bar{H})$ 的表达式。\n2. 将有效样本量 $N_{\\mathrm{eff}}$ 定义为对于相关样本满足 $\\operatorname{Var}(\\bar{H}) = \\sigma^{2}/N_{\\mathrm{eff}}$ 的数值，这类似于独立样本中的 $\\sigma^{2}/N$。使用 AR(1) 模型，推导一个用 $N$ 和 $\\rho$ 表示 $N_{\\mathrm{eff}}$ 的闭式表达式。\n3. 对于一次包含 $N = 5.0 \\times 10^{5}$ 个样本且延迟为 1 的自相关为 $\\rho = 0.85$ 的长时间 MD 运行，数值计算 $N_{\\mathrm{eff}}$。将最终数值答案四舍五入至三位有效数字，并将其报告为一个无量纲的计数值。",
            "solution": "用户要求我基于以下给定条件和任务解决一个问题：\n- **给定条件**：\n  - 一个离散的二阶平稳时间序列 $\\{H_{t}\\}_{t=1}^{N}$。\n  - 样本均值 $\\bar{H} = \\frac{1}{N} \\sum_{t=1}^{N} H_{t}$。\n  - 过程方差 $\\sigma^{2} = \\operatorname{Var}(H_{t})$。\n  - 归一化自相关函数 $\\rho_{k} = \\frac{\\operatorname{Cov}(H_{t}, H_{t+k})}{\\sigma^{2}}$。\n  - 假设的自相关模型：$\\rho_{k} = \\rho^{k}$ (对于 $k \\geq 1$)，其中 $|\\rho|  1$。\n  - 任务3的数值：$N = 5.0 \\times 10^{5}$ 和 $\\rho = 0.85$。\n- **任务**：\n  1. 用 $N$、$\\sigma^{2}$ 和 $\\{\\rho_{k}\\}$ 表示 $\\operatorname{Var}(\\bar{H})$ 并进行推导。\n  2. 定义 $N_{\\mathrm{eff}}$ 使其满足 $\\operatorname{Var}(\\bar{H}) = \\sigma^{2}/N_{\\mathrm{eff}}$，并针对 AR(1) 模型，推导一个用 $N$ 和 $\\rho$ 表示 $N_{\\mathrm{eff}}$ 的闭式表达式。\n  3. 使用给定数据计算 $N_{\\mathrm{eff}}$ 的数值，并四舍五入至三位有效数字。\n\n该问题在统计力学和时间序列分析方面具有科学依据，提法得当，提供了所有必要信息，并且陈述客观。这是一个有效的问题。\n\n以下是详细的推导和解答。\n\n**第1部分：$\\operatorname{Var}(\\bar{H})$ 的推导**\n\n我们从样本均值 $\\bar{H}$ 的定义开始：\n$$\n\\bar{H} = \\frac{1}{N} \\sum_{t=1}^{N} H_{t}\n$$\n样本均值的方差 $\\operatorname{Var}(\\bar{H})$ 由下式给出：\n$$\n\\operatorname{Var}(\\bar{H}) = \\operatorname{Var}\\left(\\frac{1}{N} \\sum_{t=1}^{N} H_{t}\\right)\n$$\n使用方差的性质 $\\operatorname{Var}(aX) = a^2\\operatorname{Var}(X)$（其中 $a$ 是常数），我们可以将 $\\frac{1}{N}$ 因子提出来：\n$$\n\\operatorname{Var}(\\bar{H}) = \\frac{1}{N^2} \\operatorname{Var}\\left(\\sum_{t=1}^{N} H_{t}\\right)\n$$\n一组随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\operatorname{Var}\\left(\\sum_{t=1}^{N} H_{t}\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\operatorname{Cov}(H_{i}, H_{j})\n$$\n由于该过程是二阶平稳的，协方差 $\\operatorname{Cov}(H_{i}, H_{j})$ 仅取决于时间延迟 $k = |i-j|$。我们可以用过程方差 $\\sigma^2$ 和归一化自相关函数 $\\rho_k$ 来表示它：\n$$\n\\operatorname{Cov}(H_{i}, H_{j}) = \\sigma^2 \\rho_{|i-j|}\n$$\n将此代入 $\\operatorname{Var}(\\bar{H})$ 的表达式中：\n$$\n\\operatorname{Var}(\\bar{H}) = \\frac{\\sigma^2}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\rho_{|i-j|}\n$$\n这个双重求和可以按延迟 $k = |i-j|$ 重新索引。对于一个固定的延迟 $k$，我们需要计算有多少对 $(i,j)$ 满足 $|i-j|=k$。\n对于 $k=0$，我们有 $i=j$，这给出了 $N$ 对。自相关为 $\\rho_0 = \\frac{\\operatorname{Cov}(H_t, H_t)}{\\sigma^2} = \\frac{\\sigma^2}{\\sigma^2} = 1$。\n对于任何延迟 $k$（其中 $1 \\leq k \\leq N-1$），有 $2(N-k)$ 对 $(i,j)$ 满足 $|i-j|=k$。\n因此，求和可以写成：\n$$\n\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\rho_{|i-j|} = N \\rho_0 + \\sum_{k=1}^{N-1} 2(N-k) \\rho_{k} = N + 2 \\sum_{k=1}^{N-1} (N-k) \\rho_{k}\n$$\n将此代回 $\\operatorname{Var}(\\bar{H})$ 的表达式，得到第1部分的最终结果：\n$$\n\\operatorname{Var}(\\bar{H}) = \\frac{\\sigma^2}{N^2} \\left[ N + 2 \\sum_{k=1}^{N-1} (N-k) \\rho_{k} \\right] = \\frac{\\sigma^2}{N} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho_{k} \\right]\n$$\n\n**第2部分：AR(1) 模型下 $N_{\\mathrm{eff}}$ 的推导**\n\n有效样本量 $N_{\\mathrm{eff}}$ 由以下关系定义：\n$$\n\\operatorname{Var}(\\bar{H}) = \\frac{\\sigma^2}{N_{\\mathrm{eff}}}\n$$\n将此与第1部分的结果相等，我们得到：\n$$\n\\frac{\\sigma^2}{N_{\\mathrm{eff}}} = \\frac{\\sigma^2}{N} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho_{k} \\right]\n$$\n这意味着：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho_{k}\n$$\n现在，我们代入 AR(1) 模型，$\\rho_{k} = \\rho^{k}$ (对于 $k \\ge 1$)：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho^{k} = 1 + 2 \\sum_{k=1}^{N-1} \\rho^{k} - \\frac{2}{N} \\sum_{k=1}^{N-1} k \\rho^{k}\n$$\n第一个和是一个标准的几何级数：\n$$\n\\sum_{k=1}^{N-1} \\rho^{k} = \\frac{\\rho(1 - \\rho^{N-1})}{1 - \\rho} = \\frac{\\rho - \\rho^N}{1 - \\rho}\n$$\n第二个和是一个算术-几何级数，可以计算为：\n$$\n\\sum_{k=1}^{n} k x^{k} = x \\frac{d}{dx} \\left(\\sum_{k=0}^{n} x^k\\right) = x \\frac{d}{dx} \\left(\\frac{x^{n+1}-1}{x-1}\\right) = \\frac{x - (n+1)x^{n+1} + nx^{n+2}}{(1-x)^2}\n$$\n当 $n = N-1$ 和 $x = \\rho$ 时，我们有：\n$$\n\\sum_{k=1}^{N-1} k \\rho^{k} = \\frac{\\rho - N\\rho^N + (N-1)\\rho^{N+1}}{(1-\\rho)^2}\n$$\n将这些和代回 $\\frac{N}{N_{\\mathrm{eff}}}$ 的表达式中：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = 1 + 2 \\frac{\\rho - \\rho^N}{1 - \\rho} - \\frac{2}{N} \\frac{\\rho - N\\rho^N + (N-1)\\rho^{N+1}}{(1-\\rho)^2}\n$$\n为了简化，我们找到一个公分母 $N(1-\\rho)^2$：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = \\frac{N(1-\\rho)^2 + 2N(\\rho-\\rho^N)(1-\\rho) - 2(\\rho - N\\rho^N + (N-1)\\rho^{N+1})}{N(1-\\rho)^2}\n$$\n展开分子：\n$$\nN(1-2\\rho+\\rho^2) + 2N(\\rho-\\rho^2-\\rho^N+\\rho^{N+1}) - 2\\rho + 2N\\rho^N - 2(N-1)\\rho^{N+1}\n$$\n$$\n= (N - 2N\\rho + N\\rho^2) + (2N\\rho - 2N\\rho^2 - 2N\\rho^N + 2N\\rho^{N+1}) - 2\\rho + 2N\\rho^N - (2N-2)\\rho^{N+1}\n$$\n按 $\\rho$ 的幂次对各项进行分组：\n$$\n= N - 2\\rho - N\\rho^2 + (-2N\\rho^N + 2N\\rho^N) + (2N\\rho^{N+1} - (2N-2)\\rho^{N+1})\n$$\n$$\n= N - 2\\rho - N\\rho^2 + 2\\rho^{N+1} = N(1-\\rho^2) - 2\\rho(1-\\rho^N)\n$$\n因此，我们得到了一个更简单的表达式：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = \\frac{N(1-\\rho^2) - 2\\rho(1-\\rho^N)}{N(1-\\rho)^2}\n$$\n将其取倒数，得到 $N_{\\mathrm{eff}}$ 的闭式表达式：\n$$\nN_{\\mathrm{eff}} = \\frac{N^2 (1-\\rho)^2}{N(1-\\rho^2) - 2\\rho(1-\\rho^N)}\n$$\n\n**第3部分：$N_{\\mathrm{eff}}$ 的数值计算**\n\n给定 $N = 5.0 \\times 10^5$ 和 $\\rho = 0.85$。我们使用推导出的 $\\frac{N}{N_{\\mathrm{eff}}}$ 表达式，这更便于计算：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} = \\frac{N(1-\\rho^2) - 2\\rho(1-\\rho^N)}{N(1-\\rho)^2} = \\frac{1-\\rho^2}{(1-\\rho)^2} - \\frac{2\\rho(1-\\rho^N)}{N(1-\\rho)^2} = \\frac{1+\\rho}{1-\\rho} - \\frac{2\\rho(1-\\rho^N)}{N(1-\\rho)^2}\n$$\n首先，我们计算 $\\rho^N$ 项：\n$$\n\\rho^N = (0.85)^{5.0 \\times 10^5}\n$$\n该项的对数为 $N \\ln(\\rho) = (5.0 \\times 10^5) \\ln(0.85) \\approx (5.0 \\times 10^5)(-0.1625) = -81250$。\n所以，$\\rho^N = \\exp(-81250)$，这个数字非常小，以至于在计算上与零无法区分。因此，我们可以设定 $\\rho^N \\approx 0$。\n表达式简化为：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} \\approx \\frac{1+\\rho}{1-\\rho} - \\frac{2\\rho}{N(1-\\rho)^2}\n$$\n现在，我们代入数值：\n$$\n\\frac{1+\\rho}{1-\\rho} = \\frac{1+0.85}{1-0.85} = \\frac{1.85}{0.15} = \\frac{185}{15} = \\frac{37}{3} \\approx 12.33333\n$$\n修正项是：\n$$\n\\frac{2\\rho}{N(1-\\rho)^2} = \\frac{2(0.85)}{(5.0 \\times 10^5)(0.15)^2} = \\frac{1.7}{(5.0 \\times 10^5)(0.0225)} = \\frac{1.7}{11250} \\approx 0.0001511\n$$\n所以，我们有：\n$$\n\\frac{N}{N_{\\mathrm{eff}}} \\approx 12.33333 - 0.0001511 \\approx 12.33318\n$$\n现在我们可以计算 $N_{\\mathrm{eff}}$：\n$$\nN_{\\mathrm{eff}} = \\frac{N}{12.33318} = \\frac{5.0 \\times 10^5}{12.33318} \\approx 40540.94\n$$\n题目要求答案四舍五入至三位有效数字。\n$$\nN_{\\mathrm{eff}} \\approx 4.05 \\times 10^4\n$$",
            "answer": "$$\n\\boxed{4.05 \\times 10^{4}}\n$$"
        }
    ]
}