{
    "hands_on_practices": [
        {
            "introduction": "相图计算的核心在于确定不同相在给定温度、压力和成分下的平衡状态。本练习利用公切线构造法，这是从吉布斯自由能曲线确定两相平衡区的经典方法。通过对一个伪二元系统的分析，您将亲手解出平衡相的成分，并运用杠杆定律计算相分数，从而深刻理解吉布斯自由能最小化原理如何直观地对应于相图上的特定几何关系。",
            "id": "3732586",
            "problem": "考虑在固定温度下，一个成分复杂的五元面心立方（FCC）和体心立方（BCC）固溶体高熵合金的伪二元截面，该截面在相图计算（CALPHAD）框架内进行建模。设成分坐标为沿伪二元线的某一成分的摩尔分数 $x \\in [0,1]$。在此温度下，FCC 和 BCC 相的摩尔吉布斯自由能由关于 $x$ 的二次函数表示：\n$$G^{\\mathrm{FCC}}(x) = 4 x^{2} - 0.5 x + 0.27,$$\n$$G^{\\mathrm{BCC}}(x) = x^{2} + 0.5 x + 0.2.$$\n考虑一个总成分为 $x_{0} = 0.246$ 的块体合金。您需要使用多组分合金的 $G(\\mathbf{x})$ 的凸包构造（此处限于沿伪二元线的一维成分坐标 $x$）来算法确定平衡相区，并与数值吉布斯能量最小化的输出进行比较。\n\n从第一性原理出发，利用热力学中的平衡定义和 CALPHAD 方法，构建在质量守恒约束下，FCC 和 BCC 两相混合物使总吉布斯能量最小化的条件。从这些条件中，推导出构建 $G^{\\mathrm{FCC}}(x)$ 和 $G^{\\mathrm{BCC}}(x)$ 的下凸包所必需的公切线关系，求解平衡端元成分 $x_{\\mathrm{FCC}}$ 和 $x_{\\mathrm{BCC}}$，并确定对应于 FCC–BCC 两相区的 $x$ 区间。利用如此获得的端元成分，使用适当的质量平衡关系计算块体成分为 $x_{0}$ 时的 FCC 相分数 $f_{\\mathrm{FCC}}$。\n\n一个独立的数值吉布斯能量最小化计算报告平衡端元成分为 $x_{\\mathrm{FCC}}^{\\mathrm{num}} = 0.198$ 和 $x_{\\mathrm{BCC}}^{\\mathrm{num}} = 0.302$。使用这些数值，计算 $x_{0} = 0.246$ 时对应的 $f_{\\mathrm{FCC}}^{\\mathrm{num}}$，并评估绝对偏差\n$$\\Delta f = \\left| f_{\\mathrm{FCC}} - f_{\\mathrm{FCC}}^{\\mathrm{num}} \\right|.$$\n\n以无量纲分数形式报告绝对偏差，并将您的最终答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于热力学平衡原理和用于相图计算的CALPHAD方法。问题陈述清晰，提供了所有必要的函数和参数以得出一个唯一的、有意义的解。语言客观，设置一致。\n\n在恒定温度和压力下，多相多组分体系中相平衡的确定受总吉布斯自由能最小化原则的支配。对于位于两相区内的总成分为 $x_0$ 的合金，其 FCC 和 BCC 两相混合物的体系每摩尔总吉布斯自由能 $G_{\\mathrm{total}}$ 由各相的摩尔吉布斯自由能的加权平均给出：\n$$G_{\\mathrm{total}} = f_{\\mathrm{FCC}} G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) + f_{\\mathrm{BCC}} G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}})$$\n其中 $f_{\\mathrm{FCC}}$ 和 $f_{\\mathrm{BCC}}$ 分别是 FCC 和 BCC 相的摩尔分数，而 $x_{\\mathrm{FCC}}$ 和 $x_{\\mathrm{BCC}}$ 是它们的平衡成分。\n\n当每个组分在所有共存相中的化学势相等时，达到平衡。对于成分坐标为 $x$ 的伪二元体系，这意味着：\n$$ \\mu_A^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) = \\mu_A^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) $$\n$$ \\mu_B^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) = \\mu_B^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) $$\n其中组分 A 对应于 $x=0$，组分 B 对应于 $x=1$。化学势与摩尔吉布斯自由能 $G(x)$ 的关系为：\n$$ \\mu_A(x) = G(x) - x \\frac{dG}{dx} $$\n$$ \\mu_B(x) = G(x) + (1-x) \\frac{dG}{dx} $$\n将这些关系代入平衡条件得到两个方程。用第二个方程减去第一个方程，得到：\n$$ \\frac{dG^{\\mathrm{FCC}}}{dx}\\bigg|_{x=x_{\\mathrm{FCC}}} = \\frac{dG^{\\mathrm{BCC}}}{dx}\\bigg|_{x=x_{\\mathrm{BCC}}} $$\n这表明吉布斯自由能曲线在平衡成分处的斜率是相等的。设这个公共斜率为 $m$。\n条件 $\\mu_A^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) = \\mu_A^{\\mathrm{BCC}}(x_{\\mathrm{BCC}})$ 可以写成：\n$$ G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) - x_{\\mathrm{FCC}}\\frac{dG^{\\mathrm{FCC}}}{dx}\\bigg|_{x=x_{\\mathrm{FCC}}} = G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) - x_{\\mathrm{BCC}}\\frac{dG^{\\mathrm{BCC}}}{dx}\\bigg|_{x=x_{\\mathrm{BCC}}} $$\n用 $m$ 代替导数：\n$$ G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) - x_{\\mathrm{FCC}}m = G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) - x_{\\mathrm{BCC}}m $$\n重新整理得到公切线条件：\n$$ m = \\frac{G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) - G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}})}{x_{\\mathrm{BCC}} - x_{\\mathrm{FCC}}} $$\n这证实了连接两点 $(x_{\\mathrm{FCC}}, G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}))$ 和 $(x_{\\mathrm{BCC}}, G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}))$ 的直线的斜率等于每条曲线在各自点上的导数。\n\n给定的吉布斯自由能函数为：\n$$G^{\\mathrm{FCC}}(x) = 4 x^{2} - 0.5 x + 0.27$$\n$$G^{\\mathrm{BCC}}(x) = x^{2} + 0.5 x + 0.2$$\n其导数为：\n$$ \\frac{dG^{\\mathrm{FCC}}}{dx} = 8x - 0.5 $$\n$$ \\frac{dG^{\\mathrm{BCC}}}{dx} = 2x + 0.5 $$\n根据导数相等，我们有：\n$$ 8x_{\\mathrm{FCC}} - 0.5 = 2x_{\\mathrm{BCC}} + 0.5 $$\n$$ 8x_{\\mathrm{FCC}} - 1 = 2x_{\\mathrm{BCC}} \\implies x_{\\mathrm{BCC}} = 4x_{\\mathrm{FCC}} - 0.5 $$\n令 $m = 8x_{\\mathrm{FCC}} - 0.5$。现在我们使用第二个条件：\n$$ m \\left( x_{\\mathrm{BCC}} - x_{\\mathrm{FCC}} \\right) = G^{\\mathrm{BCC}}(x_{\\mathrm{BCC}}) - G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) $$\n代入 $x_{\\mathrm{BCC}} = 4x_{\\mathrm{FCC}} - 0.5$：\n$$ (8x_{\\mathrm{FCC}} - 0.5)( (4x_{\\mathrm{FCC}} - 0.5) - x_{\\mathrm{FCC}}) = G^{\\mathrm{BCC}}(4x_{\\mathrm{FCC}}-0.5) - G^{\\mathrm{FCC}}(x_{\\mathrm{FCC}}) $$\n$$ (8x_{\\mathrm{FCC}} - 0.5)(3x_{\\mathrm{FCC}} - 0.5) = \\left[(4x_{\\mathrm{FCC}}-0.5)^2 + 0.5(4x_{\\mathrm{FCC}}-0.5) + 0.2\\right] - \\left[4x_{\\mathrm{FCC}}^2 - 0.5x_{\\mathrm{FCC}} + 0.27\\right] $$\n$$ 24x_{\\mathrm{FCC}}^2 - 4x_{\\mathrm{FCC}} - 1.5x_{\\mathrm{FCC}} + 0.25 = \\left[16x_{\\mathrm{FCC}}^2 - 4x_{\\mathrm{FCC}} + 0.25 + 2x_{\\mathrm{FCC}} - 0.25 + 0.2\\right] - (4x_{\\mathrm{FCC}}^2 - 0.5x_{\\mathrm{FCC}} + 0.27) $$\n$$ 24x_{\\mathrm{FCC}}^2 - 5.5x_{\\mathrm{FCC}} + 0.25 = \\left[16x_{\\mathrm{FCC}}^2 - 2x_{\\mathrm{FCC}} + 0.2\\right] - (4x_{\\mathrm{FCC}}^2 - 0.5x_{\\mathrm{FCC}} + 0.27) $$\n$$ 24x_{\\mathrm{FCC}}^2 - 5.5x_{\\mathrm{FCC}} + 0.25 = 12x_{\\mathrm{FCC}}^2 - 1.5x_{\\mathrm{FCC}} - 0.07 $$\n$$ 12x_{\\mathrm{FCC}}^2 - 4x_{\\mathrm{FCC}} + 0.32 = 0 $$\n除以 $4$：\n$$ 3x_{\\mathrm{FCC}}^2 - x_{\\mathrm{FCC}} + 0.08 = 0 $$\n使用二次方程求根公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$ x_{\\mathrm{FCC}} = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(3)(0.08)}}{2(3)} = \\frac{1 \\pm \\sqrt{1 - 0.96}}{6} = \\frac{1 \\pm \\sqrt{0.04}}{6} = \\frac{1 \\pm 0.2}{6} $$\n这给出了 $x_{\\mathrm{FCC}}$ 的两个可能解：\n1. $x_{\\mathrm{FCC}} = \\frac{1 + 0.2}{6} = \\frac{1.2}{6} = 0.2$\n2. $x_{\\mathrm{FCC}} = \\frac{1 - 0.2}{6} = \\frac{0.8}{6} = \\frac{2}{15} \\approx 0.1333$\n\n对每种情况，我们求出相应的 $x_{\\mathrm{BCC}}$：\n1. 如果 $x_{\\mathrm{FCC}} = 0.2$，则 $x_{\\mathrm{BCC}} = 4(0.2) - 0.5 = 0.8 - 0.5 = 0.3$。在这种情况下，$x_{\\mathrm{FCC}}  x_{\\mathrm{BCC}}$，这是物理上正确的。\n2. 如果 $x_{\\mathrm{FCC}} = 2/15$，则 $x_{\\mathrm{BCC}} = 4(2/15) - 0.5 = 8/15 - 1/2 = 1/30$。在这种情况下，$x_{\\mathrm{FCC}}  x_{\\mathrm{BCC}}$，这是非物理的，因为它意味着在指定组分中更富集的相具有更低的摩尔分数。该解对应于不稳定的上公切线。\n\n因此，平衡端元成分为 $x_{\\mathrm{FCC}} = 0.2$ 和 $x_{\\mathrm{BCC}} = 0.3$。两相区存在于总成分 $x_0 \\in [0.2, 0.3]$ 的范围内。由于给定的总成分 $x_{0} = 0.246$ 在此区间内，该合金将处于两相 FCC+BCC 状态。\n\nFCC 的相分数 $f_{\\mathrm{FCC}}$ 使用杠杆定律计算，该定律源于质量守恒（$f_{\\mathrm{FCC}} + f_{\\mathrm{BCC}} = 1$ 和 $f_{\\mathrm{FCC}}x_{\\mathrm{FCC}} + f_{\\mathrm{BCC}}x_{\\mathrm{BCC}} = x_0$）：\n$$ f_{\\mathrm{FCC}} = \\frac{x_{\\mathrm{BCC}} - x_0}{x_{\\mathrm{BCC}} - x_{\\mathrm{FCC}}} $$\n使用我们计算出的成分：\n$$ f_{\\mathrm{FCC}} = \\frac{0.3 - 0.246}{0.3 - 0.2} = \\frac{0.054}{0.1} = 0.54 $$\n\n接下来，我们使用提供的数值结果计算相分数：$x_{\\mathrm{FCC}}^{\\mathrm{num}} = 0.198$ 和 $x_{\\mathrm{BCC}}^{\\mathrm{num}} = 0.302$。\n$$ f_{\\mathrm{FCC}}^{\\mathrm{num}} = \\frac{x_{\\mathrm{BCC}}^{\\mathrm{num}} - x_0}{x_{\\mathrm{BCC}}^{\\mathrm{num}} - x_{\\mathrm{FCC}}^{\\mathrm{num}}} = \\frac{0.302 - 0.246}{0.302 - 0.198} = \\frac{0.056}{0.104} = \\frac{56}{104} = \\frac{7}{13} $$\n\n最后，我们评估绝对偏差 $\\Delta f$：\n$$ \\Delta f = \\left| f_{\\mathrm{FCC}} - f_{\\mathrm{FCC}}^{\\mathrm{num}} \\right| = \\left| 0.54 - \\frac{7}{13} \\right| = \\left| \\frac{54}{100} - \\frac{7}{13} \\right| = \\left| \\frac{27}{50} - \\frac{7}{13} \\right| $$\n$$ \\Delta f = \\left| \\frac{27 \\times 13 - 7 \\times 50}{50 \\times 13} \\right| = \\left| \\frac{351 - 350}{650} \\right| = \\frac{1}{650} $$\n将此表示为四舍五入到四位有效数字的小数：\n$$ \\Delta f = \\frac{1}{650} \\approx 0.00153846... $$\n四舍五入到四位有效数字得到 $0.001538$。用标准科学记数法表示为 $1.538 \\times 10^{-3}$。",
            "answer": "$$\\boxed{1.538 \\times 10^{-3}}$$"
        },
        {
            "introduction": "真实世界的合金通常是多组分的，这要求我们的热力学模型必须在复杂的成分空间中保持内在一致性。本练习将带您进入一个三元体系，通过数值方法验证热力学基本关系之一——吉布斯-杜亥姆方程。完成这个挑战，您将学会如何计算多组分体系中的化学势，并验证模型在成分变化时的热力学自洽性，这是开发和应用可靠CALPHAD数据库的一项关键能力。",
            "id": "3732712",
            "problem": "您需要对多组元合金的相图计算（CALPHAD）方法学中的一个核心热力学恒等式进行数值验证。考虑一个由组元 $A$、$B$ 和 $C$构成的三元置换固溶体相，其温度 $T$ 和压力 $P$ 恒定。该相的摩尔 Gibbs 能量被建模为具有理想构型熵的对称正规溶体：\n$$\ng(T,\\mathbf{x}) = \\sum_{i \\in \\{A,B,C\\}} x_i G_i^0(T) + R T \\sum_{i \\in \\{A,B,C\\}} x_i \\ln x_i + \\sum_{ij \\in \\{A,B,C\\}} x_i x_j L_{ij}\n$$\n其中 $x_i$ 是组元的摩尔分数， $G_i^0(T) = a_i + b_i T$ 是纯组元 $i$ 的吉布斯自由能，$L_{ij}$ 是二元相互作用参数。\n\n使用 Python 编程，根据给定的参数和三个测试案例，计算吉布斯-杜亥姆残差的绝对值 $E = \\left| \\sum_i x_{i, \\text{initial}} \\Delta\\mu_i \\right|$。在计算中，成分从 $\\mathbf{x}_{\\text{initial}}$ 沿着方向向量 $\\mathbf{v}$ 移动一个微小的步长 $dt$ ($\\Delta \\mathbf{x} = \\mathbf{v} \\cdot dt$)。\n\n**参数:**\n*   $R = 8.314 \\, \\mathrm{J/(mol \\cdot K)}$\n*   $G_A^0(T) = -12000 + 5.0 T \\, (\\mathrm{J/mol})$\n*   $G_B^0(T) = -10000 + 6.0 T \\, (\\mathrm{J/mol})$\n*   $G_C^0(T) = -8000 + 7.0 T \\, (\\mathrm{J/mol})$\n*   $L_{AB} = 2000$, $L_{AC} = -1000$, $L_{BC} = 500$ (单位均为 J/mol)\n\n**案例:**\n1.  $T=1000\\,\\text{K}$, $\\mathbf{x}_{\\text{initial}}=(1/3, 1/3, 1/3)$, $\\mathbf{v}=(0.2, -0.1, -0.1)$, $dt=10^{-5}$\n2.  $T=1200\\,\\text{K}$, $\\mathbf{x}_{\\text{initial}}=(0.01, 0.495, 0.495)$, $\\mathbf{v}=(0.01, -0.005, -0.005)$, $dt=5 \\times 10^{-5}$\n3.  $T=800\\,\\text{K}$, $\\mathbf{x}_{\\text{initial}}=(0.6, 0.3, 0.1)$, $\\mathbf{v}=(-0.05, 0.02, 0.03)$, $dt=10^{-5}$\n\n将三个案例的计算结果以 Python 列表的形式输出。",
            "solution": "用户提供的问题已经过验证，并被确定为是合理的。它具有科学依据、问题明确且客观。它提出了一个计算热力学中的标准练习，要求对特定化学体系的 Gibbs-Duhem 关系进行数值验证。所有参数、常数和程序步骤都已明确定义，使得问题可解。\n\n问题的核心是验证 Gibbs-Duhem 关系。对于一个在恒定温度 $T$ 和压力 $P$ 下的多组元体系，该关系由下式给出：\n$$\n\\sum_{i} x_i \\, d\\mu_i = 0\n$$\n此处，$x_i$ 是组元 $i$ 的摩尔分数，$\\mu_i$ 是其化学势。该关系是 Gibbs 自由能广延性质的一个基本推论。我们将为一个由对称正规溶体模型描述的三元体系（$A$、$B$、$C$）对该关系进行数值验证。\n\n三元溶液的摩尔 Gibbs 能量 $g$ 如下所示：\n$$\ng(T,\\mathbf{x}) = \\underbrace{\\sum_{i \\in \\{A,B,C\\}} x_i G_i^0(T)}_{\\text{纯组分}} + \\underbrace{R T \\sum_{i \\in \\{A,B,C\\}} x_i \\ln x_i}_{\\text{理想混合}} + \\underbrace{\\sum_{ij \\in \\{A,B,C\\}} x_i x_j L_{ij}}_{\\text{过剩自由能}}\n$$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Numerically verifies the Gibbs-Duhem relation for a ternary regular solution model.\n    \"\"\"\n\n    # Constants and Model Parameters\n    R = 8.314  # J/mol-K\n    params_A = (-12000.0, 5.0)  # (a_A, b_A)\n    params_B = (-10000.0, 6.0)  # (a_B, b_B)\n    params_C = (-8000.0, 7.0)   # (a_C, b_C)\n    L_params = (2000.0, -1000.0, 500.0) # (L_AB, L_AC, L_BC)\n\n    class CalphadModel:\n        \"\"\"Encapsulates the thermodynamic model for the ternary alloy.\"\"\"\n        def __init__(self, R_const, pA, pB, pC, L_p):\n            self.R = R_const\n            self.a_A, self.b_A = pA\n            self.a_B, self.b_B = pB\n            self.a_C, self.b_C = pC\n            self.L_AB, self.L_AC, self.L_BC = L_p\n\n        def get_G0(self, T):\n            \"\"\"Calculates pure component Gibbs energies.\"\"\"\n            G0_A = self.a_A + self.b_A * T\n            G0_B = self.a_B + self.b_B * T\n            G0_C = self.a_C + self.b_C * T\n            return np.array([G0_A, G0_B, G0_C])\n\n        def get_g(self, T, x):\n            \"\"\"Calculates the molar Gibbs energy of the solution.\"\"\"\n            xA, xB, xC = x\n            G0s = self.get_G0(T)\n            \n            g_pure = np.sum(x * G0s)\n            # Ensure x_i > 0 for np.log\n            if np.any(x == 0):\n                return np.inf\n            g_ideal = self.R * T * np.sum(x * np.log(x))\n            g_excess = xA * xB * self.L_AB + xA * xC * self.L_AC + xB * xC * self.L_BC\n            \n            return g_pure + g_ideal + g_excess\n\n        def get_dg_dx(self, T, x):\n            \"\"\"Calculates the partial derivatives of g with respect to x_i.\"\"\"\n            xA, xB, xC = x\n            G0s = self.get_G0(T)\n            \n            # Ensure x_i > 0 for np.log\n            if np.any(x == 0):\n                return np.array([np.inf, np.inf, np.inf])\n            \n            dg_dxA = G0s[0] + self.R * T * (np.log(xA) + 1) + xB * self.L_AB + xC * self.L_AC\n            dg_dxB = G0s[1] + self.R * T * (np.log(xB) + 1) + xA * self.L_AB + xC * self.L_BC\n            dg_dxC = G0s[2] + self.R * T * (np.log(xC) + 1) + xA * self.L_AC + xB * self.L_BC\n            \n            return np.array([dg_dxA, dg_dxB, dg_dxC])\n            \n        def get_mu(self, T, x):\n            \"\"\"Calculates the chemical potentials of all components.\"\"\"\n            g_val = self.get_g(T, x)\n            dg_dx_vals = self.get_dg_dx(T, x)\n            \n            sum_x_dg_dx = np.sum(x * dg_dx_vals)\n            \n            mu_vals = g_val + dg_dx_vals - sum_x_dg_dx\n            return mu_vals\n\n    # Instantiate the model with the given parameters\n    model = CalphadModel(R, params_A, params_B, params_C, L_params)\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1: T=1000, x=(1/3,1/3,1/3), v=(0.2,-0.1,-0.1), h=1e-6, dt=1e-5\n        (1000.0, (1/3, 1/3, 1/3), (0.2, -0.1, -0.1), 1e-6, 1e-5),\n        # Case 2: T=1200, x=(0.01,0.495,0.495), v=(0.01,-0.005,-0.005), h=1e-6, dt=5e-5\n        (1200.0, (0.01, 0.495, 0.495), (0.01, -0.005, -0.005), 1e-6, 5e-5),\n        # Case 3: T=800, x=(0.6,0.3,0.1), v=(-0.05,0.02,0.03), h=1e-6, dt=1e-5\n        (800.0, (0.6, 0.3, 0.1), (-0.05, 0.02, 0.03), 1e-6, 1e-5),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, x_tuple, v_tuple, h, dt = case\n        x_initial = np.array(x_tuple)\n        v = np.array(v_tuple)\n        \n        # Calculate the compositional step\n        delta_x = dt * v\n        x_final = x_initial + delta_x\n        \n        # Calculate chemical potentials at initial and final points\n        mu_initial = model.get_mu(T, x_initial)\n        mu_final = model.get_mu(T, x_final)\n        \n        # Calculate the change in chemical potential\n        delta_mu = mu_final - mu_initial\n        \n        # Calculate the Gibbs-Duhem residual\n        residual = np.abs(np.sum(x_initial * delta_mu))\n        results.append(residual)\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}