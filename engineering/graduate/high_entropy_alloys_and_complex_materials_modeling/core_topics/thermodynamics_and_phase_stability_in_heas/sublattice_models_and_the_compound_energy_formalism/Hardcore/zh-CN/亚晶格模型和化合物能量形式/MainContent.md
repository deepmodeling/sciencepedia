## 引言
在现代材料科学中，[高熵合金](@entry_id:141320)、功能[陶瓷](@entry_id:148626)和复杂[金属间化合物](@entry_id:158824)等先进材料的设计与开发，极大地依赖于我们对其[热力学稳定性](@entry_id:142877)的深刻理解。然而，这些材料往往具有复杂的[晶体结构](@entry_id:140373)和[化学有序](@entry_id:1122349)性，传统的单亚点阵替代[固溶体模型](@entry_id:1131929)由于其假设所有[晶格](@entry_id:148274)点等效，无法准确捕捉这些关键特征，从而限制了其预测能力。为了弥补这一知识鸿沟，**亚点阵模型（Sublattice Models）**与**化合物能量形式主义（Compound Energy Formalism, CEF）**应运而生，为精确建模复杂相提供了强大而灵活的理论框架，并成为计算[相图](@entry_id:144015)（CALPHAD）方法的核心。

本文旨在系统性地剖析化合物能量形式主义的理论精髓及其在材料科学中的广泛应用。读者将通过本文学习到：

- 在**“原理与机制”**章节中，我们将深入探讨CEF的基础，包括如何将[晶体结构](@entry_id:140373)分解为亚点阵，如何使用位点分数描述化学有序性，以及如何构建包含参考能、构型熵和过剩能的吉布斯能函数。
- 接着，在**“应用与跨学科交叉”**章节中，我们将展示CEF如何被应用于[高熵合金](@entry_id:141320)、[非化学计量化合物](@entry_id:145835)和离子陶瓷等真实材料的建模，如何预测相平衡与相变，以及它如何与[第一性原理计算](@entry_id:198754)和动力学理论等前沿方法相结合。
- 最后，**“动手实践”**部分将通过一系列精心设计的计算问题，引导读者将理论知识付诸实践，加深对模型核心概念的理解。

通过这三个章节的层层递进，本文将带领读者从基本原理出发，逐步掌握CEF这一强大的计算工具，并领会其作为连接基础理论与工程应用的桥梁所扮演的关键角色。

## 原理与机制

为了在[热力学](@entry_id:172368)上描述复杂多组分材料（如[高熵合金](@entry_id:141320)和功能氧化物）中的晶相，我们需要一个能够精确捕捉其[晶体结构](@entry_id:140373)和[化学有序](@entry_id:1122349)性的理论框架。单亚点阵的替代[固溶体模型](@entry_id:1131929)，虽然在描述完全无序的相时很有用，但其基本假设——所有[晶格](@entry_id:148274)点在化学和晶体学上都是等效的——限制了其适用范围。当一个相表现出长程有序、包含间隙原子或具有离子特性时，我们必须采用一种更精细的方法。**化合物能量形式主义（Compound Energy Formalism, CEF）**正是为此目的而设计的，它提供了一个强大而灵活的框架，是计算相图（CALPHAD）方法的核心。本章将深入探讨CEF的基本原理和核心机制。

### 亚点阵模型：晶相的结构化表示

CEF的核心思想是将一个[晶体结构](@entry_id:140373)分解为其组成**亚点阵（sublattices）**的集合。每个亚点阵代表一组在[晶体学](@entry_id:140656)上等效的位置（例如，一个特定的[Wyckoff位置](@entry_id:185405)）。这种分解允许我们区分不同类型的原子位点，例如，B2结构中的角顶和体心位置，或金属基体中的主体原子位点和间隙位点。

一个完整的亚点阵模型由以下几个关键要素定义：

1.  **亚[点阵和](@entry_id:189839)组分（Constituents）**：模型中的每个相都由一个或多个亚点阵构成。每个亚点阵上可以占据一组特定的化学元素或物种。例如，一个包含金属A和B以及间隙原子C的相，可以表示为两个亚点阵的模型：一个由A和B占据的**构成亚点阵（constitutional sublattice）**，以及一个由C和空位占据的**间隙亚点阵（interstitial sublattice）**。

2.  **位点重复度（Site Multiplicity）**：每个亚点阵 $k$ 在一个[化学式单位](@entry_id:145960)（formula unit）中拥有特定数量的[晶格](@entry_id:148274)点，这被称为**位点重复度**，记为 $a_k$。例如，在Ni-Al基合金的$L1_2$结构（如 $\gamma'$ 相）中，一个[化学式单位](@entry_id:145960)通常表示为 $X_1Y_3$。这可以建模为两个亚点阵：一个位点重复度 $a_1=1$ 的亚点阵（角顶位置）和一个位点重复度 $a_2=3$ 的亚点阵（面心位置）。

3.  **位点分数（Site Fraction）**：描述亚点阵上化学构成的变量是**位点分数**，记为 $y_i^{(k)}$。它表示在亚点阵 $k$ 上随机选择一个位点时，该位点被物种 $i$ 占据的概率。根据定义，对于任何给定的亚点阵 $k$，其上位点分数的总和必须为1：
    $$
    \sum_{i} y_i^{(k)} = 1
    $$
    特别地，对于间隙亚点阵，为了描述其可变的填充率，我们引入一个形式上的组分——**空位（vacancy）**，记为 $\mathrm{Va}$。$\mathrm{Va}$ 代表一个空的间隙位点。因此，间隙亚点阵上的组分通常是间隙原子（如C）和空位（$\mathrm{Va}$），其位点分数的和 $y_C^{(\text{int})} + y_{\mathrm{Va}}^{(\text{int})} = 1$ 必须始终成立。

#### 从位点分数到总原子分数

亚点阵模型的一个核心功能是连接内部[状态变量](@entry_id:138790)（位点分数 $y_i^{(k)}$）和宏观可测量的量（总原子分数 $x_i$）。$y_i^{(k)}$ 是一个[条件概率](@entry_id:151013)，描述的是在**给定**亚点阵 $k$ 上的成分。而 $x_i$ 是一个全局量，描述的是整个相中物种 $i$ 的原子比例。

通过对一个[化学式单位](@entry_id:145960)中的原子进行计数，我们可以推导出两者之间的关系。一个[化学式单位](@entry_id:145960)中的总位点数是所有亚点阵位点重复度的总和 $\sum_k a_k$。物种 $i$ 在亚点阵 $k$ 上的[原子数](@entry_id:746561)贡献为 $a_k y_i^{(k)}$。因此，一个[化学式单位](@entry_id:145960)中物种 $i$ 的总原子数为 $\sum_k a_k y_i^{(k)}$。

当相中不含空位时，总[原子数](@entry_id:746561)等于总位点数。此时，物种 $i$ 的总原子分数 $x_i$ 是其总原子数与总位点数之比：
$$
x_i = \frac{\sum_k a_k y_i^{(k)}}{\sum_k a_k}
$$
这个公式本质上是位点分数以位点重复度为权重的加权平均  。

例如，考虑前面提到的$L1_2$相，其模型为 $(\mathrm{Al}, \mathrm{Co})_1(\mathrm{Ni}, \mathrm{Fe}, \mathrm{Cr})_3$。一个[化学式单位](@entry_id:145960)中有 $a_1+a_2 = 1+3=4$ 个原子。若位点分数为 $y_{\mathrm{Al}}^{(1)}=0.8$, $y_{\mathrm{Co}}^{(1)}=0.2$ 和 $y_{\mathrm{Ni}}^{(2)}=0.5$, $y_{\mathrm{Fe}}^{(2)}=0.25$, $y_{\mathrm{Cr}}^{(2)}=0.25$，则Al的总原子分数为：
$$
x_{\mathrm{Al}} = \frac{a_1 y_{\mathrm{Al}}^{(1)} + a_2 y_{\mathrm{Al}}^{(2)}}{a_1 + a_2} = \frac{(1 \times 0.8) + (3 \times 0)}{4} = 0.2
$$
类似地，可以计算出所有其他元素的总原子分数 。

如果模型中包含空位（例如，构成亚点阵上的空位），则总[原子数](@entry_id:746561)将小于总位点数。在这种情况下，计算 $x_i$ 的分母应为总[原子数](@entry_id:746561)，即 $\sum_k a_k (1 - y_{\mathrm{Va}}^{(k)})$ 。

### 多亚点阵相的吉布斯能

在CEF中，一个相的摩尔吉布斯能 $G$（每个[化学式单位](@entry_id:145960)的摩尔数）被构建为三个主要部分的和：
$$
G = G^{\text{surf}} + G^{\text{conf}} + G^{\text{ex}}
$$
其中 $G^{\text{surf}}$ 是**参考面能（surface of reference）**，它由纯组元“端元（endmembers）”的能量构成；$G^{\text{conf}}$ 是**理想[构型熵](@entry_id:147820)（ideal configurational entropy）**的贡献；而 $G^{\text{ex}}$ 是**过剩吉布斯能（excess Gibbs energy）**，用于描述原子间相互作用引起的非[理想混合](@entry_id:150763)行为。

#### 参考面能：端元的能量

一个**端元**是指每个亚点阵都只被一种纯组分占据的假想化合物。例如，对于一个 $(A,B):(C,D)$ 的二亚点阵模型，存在四个端元：$(A:C)$, $(A:D)$, $(B:C)$ 和 $(B:D)$。每个端元 $\alpha$ 都有一个对应的参考吉布斯能 $G_{\alpha}^0$。

CEF的基本假设（在平均场近似下）是，相的平均能量是所有端元能量的加权平均。其权重 $w_{\alpha}$ 是在[晶格](@entry_id:148274)中随机选择一个[化学式单位](@entry_id:145960)时，其构型恰好对应于端元 $\alpha$ 的概率。在[理想混合](@entry_id:150763)的极限下，不同亚点阵上的原子占据是[相互独立](@entry_id:273670)的统计事件。因此，找到一个特定端元构型 $(i_1, i_2, \dots, i_m)$ 的概率是找到每个组分 $i_k$ 在其对应亚点阵 $k$ 上的概率的乘积 。这个概率就是位点分数 $y_{i_k}^{(k)}$。因此，端元 $\alpha=(i_1, \dots, i_m)$ 的权重为：
$$
w_{\alpha} = \prod_{k=1}^{m} y_{i_k}^{(k)}
$$
参考面能 $G^{\text{surf}}$ 就是所有端元能量 $G_{\alpha}^0$ 以这些概率为权重的[期望值](@entry_id:150961)：
$$
G^{\text{surf}} = \sum_{\alpha} w_{\alpha} G_{\alpha}^0 = \sum_{\alpha} \left( \prod_{k=1}^{m} y_{i_k}^{(k)} \right) G_{\alpha}^0
$$
这个项也被称为“参考表面”。例如，对于一个简单的二元二亚点阵相 $(A,B):(A,B)$，其参考面能明确地写作 ：
$$
G^{\text{surf}} = y_A^{(1)} y_A^{(2)} G^0_{AA} + y_A^{(1)} y_B^{(2)} G^0_{AB} + y_B^{(1)} y_A^{(2)} G^0_{BA} + y_B^{(1)} y_B^{(2)} G^0_{BB}
$$

#### 理想构型熵

根据统计力学，构型熵来源于原子在[晶格](@entry_id:148274)位点上的不同排列方式。由于CEF假设不同亚点阵上的混合是独立的，总的[构型熵](@entry_id:147820)是每个亚点阵上[理想混合](@entry_id:150763)熵的总和。

对于单个亚点阵 $k$，每摩尔位点的[理想混合](@entry_id:150763)熵由经典的[玻尔兹曼公式](@entry_id:152285)给出：$-R \sum_i y_i^{(k)} \ln y_i^{(k)}$。由于一个[化学式单位](@entry_id:145960)中有 $a_k$ 个亚点阵 $k$ 的位点，因此亚点阵 $k$ 对每摩尔[化学式单位](@entry_id:145960)的总[构型熵](@entry_id:147820)的贡献是其每摩尔位点熵乘以其位点重复度 $a_k$。将所有亚点阵的贡献相加，得到总的摩尔[构型熵](@entry_id:147820) $S_{\text{conf}}$ ：
$$
S_{\text{conf}} = -R \sum_{k=1}^{m} a_k \sum_{i} y_i^{(k)} \ln y_i^{(k)}
$$
对吉布斯能的贡献项是 $-T S_{\text{conf}}$。

综合以上两部分，一个理想多亚点阵[固溶体](@entry_id:137535)的摩尔吉布斯能表达式为 ：
$$
G^{\text{ideal}} = G^{\text{surf}} - T S_{\text{conf}} = \sum_{\alpha} \left( \prod_{k=1}^{m} y_{i_k}^{(k)} \right) G_{\alpha}^0 + RT \sum_{k=1}^{m} a_k \sum_{i} y_i^{(k)} \ln y_i^{(k)}
$$

### 模拟非理想相互作用：过剩吉布斯能

真实材料中的原子相互作用很少是理想的。$G^{\text{ex}}$ 项就是用来描述这种偏离[理想混合](@entry_id:150763)行为的。在CEF中，过剩能通常被建模为原子间相互作用的函数，这些相互作用可以发生在同一亚点阵内部（**亚点阵内相互作用**）或不同亚点阵之间（**跨亚点阵相互作用**）。

#### 亚点阵内相互作用

当同一亚点阵上的不同组分（例如A和B）混合时，它们的相互作用能可以用**[Redlich-Kister多项式](@entry_id:158238)**来描述。对于亚点阵 $k$ 上的 A-B [二元相互作用](@entry_id:195364)，其对过剩能的贡献 $G^{\text{ex}}_{AB,(k)}$ 必须满足几个物理原则：当A或B任何一方不存在时（即 $y_A^{(k)}=0$ 或 $y_B^{(k)}=0$），过剩能应为零；并且它应该与发生相互作用的位点数量成正比，即与位点重复度 $a^{(k)}$ 成正比。这导致了以下标准形式 ：
$$
G^{\text{ex}}_{AB,(k)} = a^{(k)} y_A^{(k)} y_B^{(k)} L_{A,B}^{(k)}
$$
其中 $L_{A,B}^{(k)}$ 是一个与成分相关的[相互作用参数](@entry_id:750714)，通常展开为[Redlich-Kister多项式](@entry_id:158238)：
$$
L_{A,B}^{(k)} = \sum_{n=0}^{N} L_{A,B}^{(k,n)} (y_A^{(k)} - y_B^{(k)})^n
$$
这里的 $L_{A,B}^{(k,n)}$ 是与温度相关的系数。

#### 跨亚点阵相互作用

类似地，不同亚点阵上的原子之间也可能存在相互作用。例如，在亚点阵1上的物种 $i$ 和亚点阵2上的物种 $j$ 之间的相互作用。在Bragg-Williams[平均场近似](@entry_id:144121)下，这种相互作用的概率与位点分数 $y_i^{(1)}$ 和 $y_j^{(2)}$ 的乘积成正比。因此，跨亚点阵相互作用对过剩能的贡献可以表示为 ：
$$
G_{\mathrm{xs}}^{(1,2)} = \sum_{i}\sum_{j} y_{i}^{(1)} y_{j}^{(2)} L_{i:j}^{(1,2)}
$$
其中 $L_{i:j}^{(1,2)}$ 是描述 $i$ 和 $j$ 在不同亚点阵上相互作用的有效参数。

### 应用与物理解释

CEF之所以成为一个强大的工具，是因为它能够自然地描述多种复杂的物理现象，而这是单亚点阵模型无法做到的。这些现象包括[长程有序](@entry_id:155156)、间隙固溶和[离子化合物](@entry_id:137573)的形成 。

#### 描述长程有序

长程有序的本质是不同化学组分优先占据晶体中不同的亚点阵。例如，在B2结构的A-B合金中，有序状态对应于A原子主要占据角顶亚点阵，而B原子主要占据体心亚点阵。在CEF中，这表现为位点分数的不等：$y_A^{(\text{corner})} \neq y_A^{(\text{center})}$。

这种有序性在能量上的驱动力来自于端元能量的差异。如果代表有序结构的端元 $(A:B)$ 的能量 $G_{A:B}^0$ 远低于代表纯组元（或无序参考）的端元 $(A:A)$ 和 $(B:B)$ 的能量，那么在低温下，系统将通过最大化有序端元 $(A:B)$ 的权重（即 $y_A^{(\text{corner})} \to 1$ 和 $y_B^{(\text{center})} \to 1$）来最小化其吉布斯能 。

随着温度升高，熵的贡献（$-T S_{\text{conf}}$）变得越来越重要。[构型熵](@entry_id:147820)在原子随机分布时最大，即当 $y_A^{(\text{corner})} = y_A^{(\text{center})} = x_A$ 时。因此，熵倾向于破坏有序。能量和熵之间的竞争导致了从低温下的有序态到高温下的无序态的转变，这是一个经典的序-乱相变。CEF通过最小化包含这两个竞争项的吉布斯能，能够精确地模拟这一过程。

例如，对于一个[化学计量](@entry_id:137450)比为 $x_A=x_B=0.5$ 的二元B2相，其完全无序状态下的[构型熵](@entry_id:147820)（每摩尔原子）为 $R \ln 2$，这是因为每个原子（A或B）在任何一个位点上出现的概率都是0.5。而在完全有序状态下，[构型熵](@entry_id:147820)为零 。CEF能够平滑地连接这两个[极限状态](@entry_id:756280)。

#### 模拟[间隙固溶体](@entry_id:139696)和[离子化合物](@entry_id:137573)

对于[间隙固溶体](@entry_id:139696)，如钢中的碳，CEF通过区分主体金属原子占据的构成亚[点阵和](@entry_id:189839)碳原子占据的间隙亚点阵，提供了物理上正确的描述。通过在间隙亚点阵上引入空位 $\mathrm{Va}$ 作为一个组分，模型可以自然地处理间隙原子的溶解度极限。当所有间隙位点都被填满时（$y_C^{(\text{int})} \to 1, y_{\mathrm{Va}}^{(\text{int})} \to 0$），系统达到饱和，构型熵的驱动力消失，这正确地反映了间隙溶解度的物理限制 。

对于[离子化合物](@entry_id:137573)，如[陶瓷](@entry_id:148626)和矿物，原子占据特定的阳离子和阴离子亚点阵，并带有电荷。一个基本物理约束是**[电中性原理](@entry_id:139787)（electroneutrality）**，即每个[化学式单位](@entry_id:145960)的总电荷必须为零。这个约束可以表示为：
$$
\sum_{k=1}^{m} a_k \sum_i z_i^{(k)} y_i^{(k)} = 0
$$
其中 $z_i^{(k)}$ 是物种 $i$ 在亚点阵 $k$ 上的电荷。这个方程直接关联了不同亚点阵上的位点分数，是CEF模型在处理离子相时的一个关键附加约束 。

总之，化合物能量形式主义通过其分层和结构化的方法，为理解和预测复杂材料的[热力学](@entry_id:172368)行为和相稳定性提供了一个坚实而通用的理论基础。