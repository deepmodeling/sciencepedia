{
    "hands_on_practices": [
        {
            "introduction": "在使用特殊准随机结构（SQS）对随机合金进行建模之前，我们必须首先理解其背后的数学原理。本练习将指导您构建描述多元合金中不同原子类型的正交基函数，并利用这些函数推导出理想随机合金的一个基本性质。通过这个过程，您将明白为什么在SQS方法中，我们的目标是使相关函数趋近于零 ()。",
            "id": "3758041",
            "problem": "考虑一种用于特殊准随机结构（SQS）建模和团簇展开的五组分（五元）等原子随机合金。假设单个晶格点被五种原子中的一种占据，该原子由状态变量 $s \\in \\{1,2,3,4,5\\}$ 标记，并假设各原子随机混合，概率均等 $p_{s} = \\frac{1}{5}$，且不同格点之间相互独立。单点团簇基由一个常数函数和四个非平凡基函数组成，这些基函数是实值的，并且相对于由下式定义的组分加权内积是标准正交的：\n$$\n\\langle f, g \\rangle \\equiv \\sum_{s=1}^{5} p_{s} \\, f(s) \\, g(s) .\n$$\n从这些定义出发，仅使用克罗内克δ函数和线性组合等基本工具，显式地构造一个由四个非平凡单点基函数组成的最小标准正交集 $\\{\\gamma^{(a)}(s)\\}_{a=1}^{4}$，其中每个函数的组分加权平均值为零。然后，对于两个不同的晶格点 $i \\neq j$，在随机混合、概率均等且相互独立的假设下，计算两点相关期望\n$$\n\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle\n$$\n。将最终答案表示为一个实数或一个闭式解析表达式。如果需要数值近似，将会要求您四舍五入到指定的有效数字位数；此处无需四舍五入，也不涉及物理单位。",
            "solution": "该问题被验证为具有科学依据、良定、客观且自洽。它涉及材料科学中团簇展开理论的核心概念。\n\n该问题要求完成两项任务：首先，构造一组具有特定性质的基函数；其次，使用这些函数计算两点相关期望。\n\n首先，我们来澄清一下符号。问题中使用了尖括号来表示两种不同的目的。符号 $\\langle f, g \\rangle$ 表示两个单点函数 $f(s)$ 和 $g(s)$ 之间的组分加权内积，定义如下：\n$$\n\\langle f, g \\rangle = \\sum_{s=1}^{5} p_{s} f(s) g(s)\n$$\n其中对于 $s \\in \\{1, 2, 3, 4, 5\\}$ 有 $p_{s} = \\frac{1}{5}$。在 $\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle$ 的上下文中，符号 $\\left\\langle \\dots \\right\\rangle$ 表示对晶格点上原子种类分布的统计期望值（构型平均值）。\n\n**第一部分：标准正交基函数的构造**\n\n我们需要构造一组四个实值函数 $\\{\\gamma^{(a)}(s)\\}_{a=1}^{4}$，它们相对于给定的内积是标准正交的，并且组分加权平均值为零。在五种原子集合上所有函数的空间是一个5维向量空间。常数函数 $\\gamma^{(0)}(s) = 1$ 是一个基向量。它的范数为 $\\langle 1, 1 \\rangle = \\sum_{s=1}^5 p_s (1)^2 = \\sum_{s=1}^5 \\frac{1}{5} = 1$。其余四个基函数必须与 $\\gamma^{(0)}(s)$ 正交。这个正交条件恰好就是组分加权平均值为零的条件：\n$$\n\\langle \\gamma^{(a)}, 1 \\rangle = \\sum_{s=1}^{5} p_{s} \\gamma^{(a)}(s) (1) = \\frac{1}{5} \\sum_{s=1}^{5} \\gamma^{(a)}(s) = 0 \\quad \\text{for } a \\in \\{1, 2, 3, 4\\}\n$$\n对于集合 $\\{\\gamma^{(a)}(s)\\}_{a=1}^{4}$ 的标准正交条件为：\n$$\n\\langle \\gamma^{(a)}, \\gamma^{(b)} \\rangle = \\frac{1}{5} \\sum_{s=1}^{5} \\gamma^{(a)}(s) \\gamma^{(b)}(s) = \\delta_{ab} \\quad \\text{for } a,b \\in \\{1, 2, 3, 4\\}\n$$\n其中 $\\delta_{ab}$ 是克罗内克δ。\n\n我们可以使用类似于格拉姆-施密特(Gram-Schmidt)过程的方法来构造这样一组函数，从包含克罗内克δ $\\delta_{sk}$ 的函数开始。一个系统且常用的构造方法如下：\n对于 $k=1, 2, 3, 4$，定义一个未归一化函数序列 $f^{(k)}(s)$：\n$$\nf^{(k)}(s) = \\sum_{j=1}^{k} \\delta_{sj} - k \\delta_{s, k+1}\n$$\n根据构造，每个 $f^{(k)}(s)$ 的平均值为零：$\\sum_{s=1}^{5} f^{(k)}(s) = k \\cdot 1 - k \\cdot 1 = 0$。这些函数是相互正交的。例如，考虑 $f^{(1)}(s) = \\delta_{s1} - \\delta_{s2}$ 和 $f^{(2)}(s) = \\delta_{s1} + \\delta_{s2} - 2\\delta_{s3}$。它们的内积是：\n$$\n\\langle f^{(1)}, f^{(2)} \\rangle = \\frac{1}{5} \\sum_s (\\delta_{s1} - \\delta_{s2})(\\delta_{s1} + \\delta_{s2} - 2\\delta_{s3}) = \\frac{1}{5} \\left( (1)(1) + (-1)(1) \\right) = 0\n$$\n为了得到最终的标准正交基函数 $\\gamma^{(a)}(s)$，我们对每个 $f^{(a)}(s)$ 进行归一化。其范数的平方为 $\\langle f^{(k)}, f^{(k)} \\rangle = \\frac{1}{5}\\sum_s (f^{(k)}(s))^2$。\n对于 $f^{(1)}(s) = \\delta_{s1} - \\delta_{s2}$，$\\langle f^{(1)}, f^{(1)} \\rangle = \\frac{1}{5} (1^2 + (-1)^2) = \\frac{2}{5}$。\n对于 $f^{(2)}(s) = \\delta_{s1} + \\delta_{s2} - 2\\delta_{s3}$，$\\langle f^{(2)}, f^{(2)} \\rangle = \\frac{1}{5} (1^2 + 1^2 + (-2)^2) = \\frac{6}{5}$。\n通常，对于一个五元体系（$N=5$），范数的平方为 $\\langle f^{(k)}, f^{(k)} \\rangle = \\frac{k(k+1)}{5}$。\n归一化常数为 $C_k = 1 / \\sqrt{\\langle f^{(k)}, f^{(k)} \\rangle} = \\sqrt{\\frac{5}{k(k+1)}}$。\n由此可得显式的标准正交集：\n$$\n\\gamma^{(1)}(s) = \\sqrt{\\frac{5}{2}} (\\delta_{s1} - \\delta_{s2})\n$$\n$$\n\\gamma^{(2)}(s) = \\sqrt{\\frac{5}{6}} (\\delta_{s1} + \\delta_{s2} - 2\\delta_{s3})\n$$\n$$\n\\gamma^{(3)}(s) = \\sqrt{\\frac{5}{12}} (\\delta_{s1} + \\delta_{s2} + \\delta_{s3} - 3\\delta_{s4})\n$$\n$$\n\\gamma^{(4)}(s) = \\sqrt{\\frac{5}{20}} (\\delta_{s1} + \\delta_{s2} + \\delta_{s3} + \\delta_{s4} - 4\\delta_{s5}) = \\frac{1}{2} (\\delta_{s1} + \\delta_{s2} + \\delta_{s3} + \\delta_{s4} - 4\\delta_{s5})\n$$\n这组函数满足所有要求的性质。\n\n**第二部分：两点相关期望的计算**\n\n我们需要计算对于两个不同格点 $i \\neq j$ 的两点相关期望 $\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle$。问题陈述该合金是随机的，概率均等，且不同格点上的占据是独立的。\n\n期望值是通过对格点 $i$ 和 $j$ 上所有可能的原子构型进行平均来计算的。由于独立性，格点 $i$ 上的原子种类 $s_i$ 和格点 $j$ 上的原子种类 $s_j$ 的联合概率分布是各自概率的乘积：$p(s_i, s_j) = p(s_i) p(s_j)$。\n因此，期望值为：\n$$\n\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle = \\sum_{s_i=1}^{5} \\sum_{s_j=1}^{5} p(s_i) p(s_j) \\gamma^{(a)}(s_{i}) \\gamma^{(b)}(s_{j})\n$$\n因为被加数是一个关于 $s_i$ 的函数与一个关于 $s_j$ 的函数的乘积，所以这个双重求和可以分解为两个单一求和的乘积：\n$$\n\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle = \\left( \\sum_{s_i=1}^{5} p(s_i) \\gamma^{(a)}(s_{i}) \\right) \\left( \\sum_{s_j=1}^{5} p(s_j) \\gamma^{(b)}(s_{j}) \\right)\n$$\n这个乘积中的每一项都是一个基函数的单点期望值。我们来考察其中一项：\n$$\n\\sum_{s=1}^{5} p(s) \\gamma^{(a)}(s)\n$$\n这个表达式恰好是函数 $\\gamma^{(a)}(s)$ 的组分加权平均值。问题陈述明确要求基函数 $\\{\\gamma^{(a)}(s)\\}_{a=1}^4$ 具有“零组分加权平均值”。如前所示，这等价于基函数与常数函数 $\\gamma^{(0)}(s)=1$ 正交：\n$$\n\\sum_{s=1}^{5} p(s) \\gamma^{(a)}(s) = \\langle \\gamma^{(a)}, 1 \\rangle = 0 \\quad \\text{for } a \\in \\{1, 2, 3, 4\\}\n$$\n同理，对于函数 $\\gamma^{(b)}(s)$，其组分加权平均值也为零：\n$$\n\\sum_{s=1}^{5} p(s) \\gamma^{(b)}(s) = \\langle \\gamma^{(b)}, 1 \\rangle = 0 \\quad \\text{for } b \\in \\{1, 2, 3, 4\\}\n$$\n将这些结果代回两点相关的表达式中：\n$$\n\\left\\langle \\gamma^{(a)}(s_{i}) \\, \\gamma^{(b)}(s_{j}) \\right\\rangle = (0) \\cdot (0) = 0\n$$\n这个结果对任意选择的 $a, b \\in \\{1, 2, 3, 4\\}$ 以及任意一对不同的格点 $i \\neq j$ 都成立。该结果是随机合金的团簇展开基函数的定义性质的直接推论，并且不依赖于这些函数的具体显式构造，只依赖于它们与常数函数正交这一事实。",
            "answer": "$$ \\boxed{0} $$"
        },
        {
            "introduction": "理论为我们指明了方向，但真正的理解来自于实践。本练习将理论付诸实践，要求您编写代码来计算给定原子构型的实际相关函数 ()。通过亲自计算并验证不同结构（包括一个优秀的SQS、一个有序结构和一个边界情况）的对相关和三体相关，您将掌握评估SQS质量的核心技能。",
            "id": "3758078",
            "problem": "给定一个由$L$个格点组成的一维周期性晶格（一个环），其中填充了五元等原子合金，这意味着有$5$种不同的原子种类，且每种原子种类的组成为$1/5$。在特殊准随机结构 (SQS) 中，我们用赝自旋矢量来表示原子种类，从而使有限元胞中的关联函数与理想的完全无规合金的关联函数相匹配。本题的目的是计算具体 SQS 构型的对和三体赝自旋关联，并通过数值检验来验证它们与无规等原子目标值的一致性。\n\n基本原理和定义：\n- 特殊准随机结构 (SQS) 是一种有限的周期性排列，旨在尽可能精确地再现无规合金的关联函数。一个五元合金有$5$种原子种类，在每个格点上出现的概率相等，均为$1/5$。\n- 设原子种类集合为 $\\{\\sigma=0,1,2,3,4\\}$。通过在$\\mathbb{R}^5$空间中放置$5$个标准基矢$\\mathbf{e}_\\sigma$并减去其质心$\\boldsymbol{\\mu}=\\frac{1}{5}\\sum_{\\sigma=0}^{4}\\mathbf{e}_\\sigma$来定义原子种类$\\sigma$的赝自旋矢量。因此，原子种类$\\sigma$的赝自旋为$\\mathbf{s}(\\sigma)=\\mathbf{e}_\\sigma-\\boldsymbol{\\mu}$。对于任何一个种类标签为$\\sigma_i$的格点$i$，其赝自旋为$\\mathbf{s}_i=\\mathbf{s}(\\sigma_i)$。\n- 对于等原子无规合金，每个格点的占位是独立同分布的，每种原子种类的概率为$1/5$。通过上述中心化处理，$\\mathbb{E}[\\mathbf{s}_i]=\\mathbf{0}$，因此无规目标值满足：对于任意对$(i,j)$，$\\mathbb{E}[\\mathbf{s}_i\\cdot\\mathbf{s}_j]=0$；对于任意三体$(i,j,k)$，$\\mathbb{E}[\\sum_{\\alpha=1}^{5}s_i^{\\alpha}s_j^{\\alpha}s_k^{\\alpha}]=0$，其中$s_i^{\\alpha}$表示$\\mathbf{s}_i$的第$\\alpha$个分量。\n\n晶格几何和环中的团簇定义：\n- 该环具有周期性边界条件。用整数$i\\in\\{0,1,\\dots,L-1\\}$对格点进行索引，并将$i+s$解释为对$L$取模。\n- 对壳层$R=1$由$L$个无序最近邻对$\\{(i,(i+1)\\bmod L):i=0,\\dots,L-1\\}$组成。\n- 对壳层$R=2$由$L$个无序次近邻对$\\{(i,(i+2)\\bmod L):i=0,\\dots,L-1\\}$组成。\n- 三体团簇集$\\mathcal{T}$由所有$L$个有序连续格点三联体$\\{(i,(i+1)\\bmod L,(i+2)\\bmod L): i=0,\\dots,L-1\\}$组成。\n\n待计算的关联函数：\n- 壳层$R\\in\\{1,2\\}$的对关联为\n$$\nC_2(R)=\\frac{1}{L}\\sum_{i=0}^{L-1}\\mathbf{s}_i\\cdot\\mathbf{s}_{(i+R)\\bmod L}.\n$$\n- 三体关联为\n$$\nC_3=\\frac{1}{L}\\sum_{i=0}^{L-1}\\sum_{\\alpha=1}^{5} s_i^{\\alpha}\\,s_{(i+1)\\bmod L}^{\\alpha}\\,s_{(i+2)\\bmod L}^{\\alpha}.\n$$\n无规等原子目标值为：对于任何$R$，$C_2(R)=0$；且$C_3=0$。\n\n数值验证方案：\n- 对于每种构型，计算$C_2(1)$、$C_2(2)$和$C_3$，并检查每个值是否在无规等原子目标值$0$的绝对容差范围内。如果对于指定的容差，$\\lvert C_2(R)\\rvert\\le\\varepsilon_{\\text{pair},R}$且$\\lvert C_3\\rvert\\le\\varepsilon_{\\text{triplet}}$，则认为该结果与无规目标值一致。\n\n测试套件：\n提供以下参数集。每个参数集是一个元组$(L,\\text{config},\\varepsilon_{\\text{pair},1},\\varepsilon_{\\text{pair},2},\\varepsilon_{\\text{triplet}})$，其中构型是一个长度为$L$的原子种类标签$\\sigma_i\\in\\{0,1,2,3,4\\}$列表。\n1. 理想路径的 SQS 情况，设计用于精确匹配对壳层：\n   - $(L=\\;10,\\;\\text{config}=[0,0,2,4,2,1,1,3,4,3],\\;\\varepsilon_{\\text{pair},1}=10^{-12},\\;\\varepsilon_{\\text{pair},2}=10^{-12},\\;\\varepsilon_{\\text{triplet}}=0.4)$。\n2. 有序边缘情况（块状），预计会与无规情况有很大偏差：\n   - $(L=\\;10,\\;\\text{config}=[0,0,1,1,2,2,3,3,4,4],\\;\\varepsilon_{\\text{pair},1}=10^{-3},\\;\\varepsilon_{\\text{pair},2}=10^{-3},\\;\\varepsilon_{\\text{triplet}}=0.1)$。\n3. 最小环$L=\\;5$的边界尺寸情况，每种原子种类按序排列：\n   - $(L=\\;5,\\;\\text{config}=[0,1,2,3,4],\\;\\varepsilon_{\\text{pair},1}=10^{-12},\\;\\varepsilon_{\\text{pair},2}=10^{-12},\\;\\varepsilon_{\\text{triplet}}=10^{-12})$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于上述三个测试用例中的每一个，按$[C_2(1)\\text{ 一致},\\;C_2(2)\\text{ 一致},\\;C_3\\text{ 一致}]$的顺序输出三个布尔值，表示是否与无规目标值一致。将所有测试用例的布尔值按顺序汇总到一个列表中。例如，输出形式应为$”[b_{1,1},b_{1,2},b_{1,3},b_{2,1},b_{2,2},b_{2,3},b_{3,1},b_{3,2},b_{3,3}]”$，其中每个$b_{k,m}$为$\\text{True}$或$\\text{False}$。本次计算不涉及物理单位。",
            "solution": "用户提供的问题是计算材料科学领域中一个明确定义的计算任务，具体涉及特殊准随机结构（SQS）的验证。该问题有科学依据，数学上一致，并提供了所有必要的参数和定义。因此，该问题是有效的，可以构建解决方案。\n\n问题的核心是计算一维周期性晶格上给定原子构型的对关联函数和三体关联函数，并将它们与完全无规合金的理论值进行比较。\n\n首先，我们必须形式化原子种类的表示方法。一个五元合金包含$N=5$种不同的原子种类，我们可以用整数$\\sigma \\in \\{0, 1, 2, 3, 4\\}$来标记。在SQS形式体系中，每个原子种类$\\sigma$被映射到$N$维空间（$\\mathbb{R}^5$）中的一个赝自旋矢量$\\mathbf{s}(\\sigma)$。这些矢量的构建旨在使其具有模拟统计独立性的特定正交性质。构建过程从标准基矢$\\mathbf{e}_\\sigma \\in \\mathbb{R}^5$开始，其中$\\mathbf{e}_\\sigma$是一个在第$\\sigma$个位置为1，其余位置为0的矢量。对于等原子合金，在某个格点上发现任何原子种类的概率为$p_\\sigma=1/N = 1/5$。通过减去基矢的质心$\\boldsymbol{\\mu}$来对赝自旋矢量进行中心化：\n$$\n\\boldsymbol{\\mu} = \\frac{1}{N} \\sum_{\\sigma=0}^{N-1} \\mathbf{e}_\\sigma = \\left(\\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}, \\frac{1}{5}\\right)^T\n$$\n原子种类$\\sigma$的赝自旋矢量为：\n$$\n\\mathbf{s}(\\sigma) = \\mathbf{e}_\\sigma - \\boldsymbol{\\mu}\n$$\n对于一个给定的晶格构型，由一系列原子种类标签$(\\sigma_0, \\sigma_1, \\dots, \\sigma_{L-1})$指定，每个格点$i$都被赋予相应的赝自旋矢量$\\mathbf{s}_i = \\mathbf{s}(\\sigma_i)$。\n\n这些矢量的性质至关重要。两个此类矢量的点积为：\n$$\n\\mathbf{s}(\\sigma) \\cdot \\mathbf{s}(\\tau) = (\\mathbf{e}_\\sigma - \\boldsymbol{\\mu}) \\cdot (\\mathbf{e}_\\tau - \\boldsymbol{\\mu}) = \\mathbf{e}_\\sigma \\cdot \\mathbf{e}_\\tau - \\mathbf{e}_\\sigma \\cdot \\boldsymbol{\\mu} - \\mathbf{e}_\\tau \\cdot \\boldsymbol{\\mu} + \\boldsymbol{\\mu} \\cdot \\boldsymbol{\\mu}\n$$\n使用$\\mathbf{e}_\\sigma \\cdot \\mathbf{e}_\\tau = \\delta_{\\sigma\\tau}$（克罗内克 delta 符号），$\\mathbf{e}_\\sigma \\cdot \\boldsymbol{\\mu} = 1/N$，以及$\\boldsymbol{\\mu} \\cdot \\boldsymbol{\\mu} = N(1/N^2) = 1/N$，我们得到：\n$$\n\\mathbf{s}(\\sigma) \\cdot \\mathbf{s}(\\tau) = \\delta_{\\sigma\\tau} - \\frac{1}{N} - \\frac{1}{N} + \\frac{1}{N} = \\delta_{\\sigma\\tau} - \\frac{1}{N}\n$$\n对于我们的情况，$N=5$：\n$$\n\\mathbf{s}(\\sigma) \\cdot \\mathbf{s}(\\tau) =\n\\begin{cases}\n1 - 1/5 = 4/5  \\text{if } \\sigma = \\tau \\\\\n-1/5  \\text{if } \\sigma \\neq \\tau\n\\end{cases}\n$$\n这些值是计算对关联函数的基础。\n\n该问题要求为长度为$L$、具有周期性边界条件的晶格计算两种类型的关联函数。\n\n1.  **对关联函数, $C_2(R)$**: 这衡量了沿环相距为$R$的格点对之间的平均关联。\n    $$\n    C_2(R) = \\frac{1}{L} \\sum_{i=0}^{L-1} \\mathbf{s}_i \\cdot \\mathbf{s}_{(i+R) \\bmod L}\n    $$\n    我们需要为最近邻（$R=1$）和次近邻（$R=2$）计算这个值。对于给定的构型，我们将原子种类列表映射为赝自旋矢量序列。然后，对每个$R$，我们计算每对$(i, (i+R)\\bmod L)$的点积，将这些乘积求和，再除以$L$。\n\n2.  **三体关联函数, $C_3$**: 这衡量了相邻格点的三联体之间的平均关联。\n    $$\n    C_3 = \\frac{1}{L} \\sum_{i=0}^{L-1} \\sum_{\\alpha=1}^{5} s_i^{\\alpha}\\,s_{(i+1)\\bmod L}^{\\alpha}\\,s_{(i+2)\\bmod L}^{\\alpha}\n    $$\n    这里，$s_i^{\\alpha}$是矢量$\\mathbf{s}_i$的第$\\alpha$个分量。计算过程包括：对于每个起始格点$i$，取三个连续的赝自旋矢量$\\mathbf{s}_i$、$\\mathbf{s}_{(i+1)\\bmod L}$和$\\mathbf{s}_{(i+2)\\bmod L}$，计算它们的逐元素乘积，对结果矢量的分量求和，最后对所有可能的起始格点$i$的这些和值进行平均。\n\n完全无规合金的目标值为$C_2(R)=0$和$C_3=0$。数值验证方案包括检查计算出的关联的绝对值是否落在指定的容差范围内：$|C_2(R)| \\le \\varepsilon_{\\text{pair},R}$和$|C_3| \\le \\varepsilon_{\\text{triplet}}$。\n\n对于每个测试用例，总体算法如下：\n1.  定义原子种类数$N=5$。构建$5 \\times 5$的赝自旋矢量矩阵，其中第$\\sigma$行是矢量$\\mathbf{s}(\\sigma)$。\n2.  给定一个长度为$L$的构型，创建一个$L \\times 5$的矩阵，表示晶格上的赝自旋矢量序列。\n3.  要计算$C_2(R)$，创建晶格自旋矩阵的一个副本，并将其周期性地平移$-R$个格点位置。将原始矩阵和移位后的矩阵逐元素相乘，并对结果矩阵的所有元素求和。再除以$L$。\n4.  要计算$C_3$，创建晶格自旋矩阵的两个移位副本，一个移位$-1$，另一个移位$-2$。将原始矩阵和两个移位后的矩阵逐元素相乘。对最终乘积的所有元素求和，再除以$L$。\n5.  将计算出的$C_2(1)$、$C_2(2)$和$C_3$的绝对值与它们各自的容差进行比较，以产生三个布尔结果。\n6.  将所有测试用例的布尔结果连接成一个列表作为最终输出。\n\n这个过程将使用`numpy`库在Python中实现，以进行高效的数组运算。",
            "answer": "[True,True,True,False,False,True,False,False,False]"
        },
        {
            "introduction": "在现实的研究中，生成高质量的SQS并非总是一帆风顺，它是一个涉及多种参数权衡的复杂优化问题。本练习模拟了一个常见的研究场景：初步尝试生成SQS失败了 ()。您的任务是像一位经验丰富的研究者一样，分析失败的原因，并从多个选项中选择最合理的策略来解决问题，同时平衡计算精度与成本。",
            "id": "3758133",
            "problem": "一个研究小组正在使用 Alloy Theoretic Automated Toolkit (ATAT) 中的蒙特卡洛 SQS 搜索 (mcsqs) 代码，为一个等原子比的 $5$ 组分高熵合金在面心立方 (fcc) 晶格上构建特殊准随机结构 (SQS)。SQS 的目标是匹配目标随机合金的团簇关联函数，这些团簇包括所有直至第 $4$ 近邻壳层的不同原子对，以及顶点间距不超过第 $3$ 近邻距离的三体团簇。初始设置使用一个 $2\\times 2\\times 2$ 的 fcc 常规晶胞的超胞，其中包含 $N=32$ 个原子位置，组分为精确的等原子比，所有列出的团簇具有相同的权重，并采用一个简短的模拟退火方案。经过多次独立运行后，最佳目标函数值仍高于规定的容差，且代码报告没有候选结构满足该阈值。\n\n从第一性原理出发，随机替代式合金的特征是由组分决定的可分解的团簇关联函数，而 SQS 通过强制实现这些函数在有限胞元内的平均值来近似这种随机性。在有限的超胞中，团簇计数是离散的，并受到对称性和组分的约束，这可能使得对于给定的团簇列表和胞元尺寸，某个关联目标变得不可行。模拟退火通过有限温度采样探索位点交换构型，并随着退火方案的降温过程逐渐收敛。\n\n你需要通过提出一个具体的修改计划并解释其权衡利弊，来解决未能找到良好 SQS 的问题。以下哪个选项是能够可靠地获得一个在容差范围内再现短程对关联，同时保持下游密度泛函理论 (DFT) 计算成本合理的最佳方案？请选择一项。\n\nA. 将超胞增加到 $3\\times 3\\times 3$ ($N=108$)，修剪团簇列表，使其包含直至第 $2$ 近邻壳层的原子对和一个小的、有物理动机的紧凑三体团簇子集，重新加权目标函数以强调前两个对壳层，并使用一个温度更高、时间更长的模拟退火方案，该方案具有缓慢的冷却速率和每次运行 $10^{6}$ 到 $10^{7}$ 次的交换尝试，并运行多个随机种子。\n\nB. 保持 $2\\times 2\\times 2$ ($N=32$) 的超胞，扩展团簇列表以包括直至第 $6$ 近邻壳层的所有原子对以及大截断半径内的所有三体和四体团簇，将退火温度迅速降至零以强力施加约束，并减少蒙特卡洛步数以防止过拟合。\n\nC. 保持团簇列表和退火方案不变，但允许每个物种的组分偏差高达 $\\pm 10\\%$，以使优化器能够在 $2\\times 2\\times 2$ 超胞中匹配更多的团簇关联；接受组分误差相对于关联精度而言可以忽略不计。\n\nD. 将超胞增加到 $4\\times 4\\times 4$ ($N=256$)，对所有团簇保持相同的权重，将每次运行的退火交换尝试限制在 $10^{3}$ 次以控制计算时间，并接受所获得的任何目标函数值，因为大尺寸的胞元本身就应该能保证接近随机的关联，即使没有仔细优化。\n\nE. 保持 $2\\times 2\\times 2$ 的超胞和精确的团簇列表，但仅修改模拟退火方案，从更高的初始温度开始并更缓慢地冷却，将交换尝试增加到 $10^{6}$ 次；避免对团簇列表、权重或胞元尺寸进行任何更改，以保留原始设定。",
            "solution": "在进行求解之前，首先对问题陈述的有效性进行严格评估。\n\n### 第1步：提取已知条件\n- **体系：** 等原子比 $5$ 组分高熵合金。\n- **晶格结构：** 面心立方 (fcc)。\n- **方法：** 特殊准随机结构 (SQS) 生成。\n- **计算工具：** Alloy Theoretic Automated Toolkit (ATAT) 中的 `mcsqs` 代码。\n- **SQS 目标：** 匹配目标随机合金的团簇关联函数，包括：\n    1. 所有直至第 $4$ 近邻壳层的不同原子对。\n    2. 所有顶点间距不超过第 $3$ 近邻距离的不同三体团簇。\n- **初始构型：**\n    - **超胞：** $2\\times 2\\times 2$ 的 fcc 常规晶胞，其中包含 $N=32$ 个原子位置。\n    - **组分：** “精确的等原子比”。\n    - **目标函数：** 所有列出的团簇具有相同权重。\n    - **优化：** 简短的模拟退火方案。\n- **报告结果：** SQS 搜索失败；最佳目标函数值仍高于规定容差，且未找到满足阈值的候选结构。\n- **问题：** 提出一个最合适的计划，以可靠地获得一个合适的 SQS，同时平衡关联精度与合理的下游密度泛函理论 (DFT) 计算成本。\n\n### 第2步：使用提取的已知条件进行验证\n该问题描述了计算材料科学中一个标准且现实的场景。所呈现的概念——SQS、团簇关联函数、模拟退火、`mcsqs`/ATAT 以及与 DFT 计算成本的权衡——在科学上是合理的，并且是该领域的核心。整个设定是客观且明确的。\n\n问题陈述中存在一个微小的不精确之处。它指定了一个 $5$ 组分合金在包含 $N=32$ 个位置的超胞中具有“精确的等原子比”组分。一个等原子比的 $5$ 组分合金要求每个组分的浓度为 $1/5 = 0.2$。对于 $N=32$ 个位置，这将需要每种 ‘$i$’ 物种有 $N_i = 32 \\times 0.2 = 6.4$ 个原子。由于原子数必须是整数，因此“精确的”等原子比组分是不可能的。实际操作中会使用最接近的整数近似，例如，三种组分各含 $6$ 个原子，两种组分各含 $7$ 个原子 $(6+6+6+7+7=32)$。这种微小但不可避免的与理想组分的偏差使得优化问题更加受限和困难。这个不精确之处并未使问题无效；相反，它突显了一个现实世界中的约束，使得所述的寻找解决方案失败的情形更加合理。问题的核心，即为一个过度约束的优化问题进行故障排除，仍然是有效且定义明确的。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。关于组分的轻微不精确性是实践中的一个细微差别，并不会破坏问题的基本科学和逻辑结构。将推导出一个完整的解决方案。\n\n### 解决方案推导\n\n使用初始参数未能生成令人满意的 SQS，表明约束数量与可用自由度之间存在根本冲突，而搜索方法不充分又加剧了这一问题。\n\n**第一性原理：**\n1.  **SQS 与随机性：** 对于一个尺寸为 $N$ 的超胞，一个完美的 SQS 是一个周期性结构，其团簇关联函数（在胞元内所有对称等价团簇上取平均）与无限大随机合金的团簇关联函数完全匹配。在随机合金中，一个团簇 $\\alpha$ 的关联函数是可分解的：$\\langle \\Pi_\\alpha \\rangle_{\\text{random}} = \\prod_{i \\in \\alpha} x_i$，其中 $x_i$ 是团簇中位置 $i$ 处物种的浓度。\n2.  **约束与自由度：** 目标关联的数量（即约束）可能非常大，特别是对于多组分体系（如此处的 $5$ 组分合金）和长程团簇（直至第 $4$ 壳层的原子对和许多三体团簇）。自由度是超胞中 $N$ 个原子的可能排列方式。对于一个小超胞 ($N=32$)，自由度的数量有限，因此可能在数学上无法同时满足大量的关联约束，尤其是在组分也固定的情况下。\n3.  **优化：** 模拟退火是一种随机优化算法，用于寻找目标函数的全局最小值。“简短的”方案意味着算法没有足够的时间来探索巨大的构型空间，很可能陷入一个较差的局部最小值中。\n\n最初的失败是以下因素共同作用的结果：\n- **过度约束的系统：** 对于一个小的 $N=32$ 胞元，目标团簇关联过多。\n- **搜索不充分：** “简短的”退火方案对于如此复杂的优化情景是不够的。\n\n目标是找到一个能够纠正这些问题，同时遵守“合理的”DFT 成本约束的计划。DFT 计算成本大约按 $O(N^3)$ 比例增长，因此超胞尺寸 $N$ 的选择至关重要。\n\n### 逐项分析选项\n\n**A. 将超胞增加到 $3\\times 3\\times 3$ ($N=108$)，修剪团簇列表，使其包含直至第 $2$ 近邻壳层的原子对和一个小的、有物理动机的紧凑三体团簇子集，重新加权目标函数以强调前两个对壳层，并使用一个温度更高、时间更长的模拟退火方案，该方案具有缓慢的冷却速率和每次运行 $10^{6}$ 到 $10^{7}$ 次的交换尝试，并运行多个随机种子。**\n\n- **超胞尺寸 ($N=108$)：** 将胞元尺寸从 $N=32$ 增加到 $N=108$ 提供了显著更多的构型自由度，使得找到满足约束的结构的可能性大大增加。虽然这会增加后续的 DFT 计算成本，但一个包含 $N=108$ 个原子的胞元通常被认为是高熵合金计算中一个可控的、尽管计算量大的尺寸。这代表了一个很好的折衷。\n- **修剪和重新加权团簇：** 通过关注物理上最重要的关联（短程对、紧凑三体团簇）来减少约束数量是一种标准且必要的做法。化学相互作用通常由前几个近邻壳层主导。重新加权目标函数以优先考虑这些关键关联，可以引导优化器朝向物理上有意义的解。\n- **改进的退火方案：** 一个更长、更慢的退火方案（$10^6 - 10^7$ 次交换）对于彻底探索构型空间至关重要，它能极大地增加找到全局最小值或代表高质量 SQS 的极深局部最小值的概率。\n- **结论：** 该选项提出了一个全面且科学合理的策略，以平衡的方式解决了所有已识别的失败原因。它通过同时增加自由度和减少不必要的约束使问题变得易于处理，同时也确保了优化算法的鲁棒性。\n\n**结论：正确**\n\n**B. 保持 $2\\times 2\\times 2$ ($N=32$) 的超胞，扩展团簇列表以包括直至第 $6$ 近邻壳层的所有原子对以及大截断半径内的所有三体和四体团簇，将退火温度迅速降至零以强力施加约束，并减少蒙特卡洛步数以防止过拟合。**\n\n- **保持小超胞 ($N=32$)：** 这未能解决自由度不足的主要问题。\n- **扩展团簇列表：** 这会给一个已经过度约束的系统增加更多约束，从而加剧了问题，使解存在的可能性更小。\n- **快速冷却（淬火）：** 这是一种糟糕的优化策略，它保证系统会陷入遇到的第一个局部最小值，而这不大可能是一个好的解。\n- **减少蒙特卡洛步数：** 这会严重削弱搜索过程。“过拟合”的概念在这里被误用；目标*就是*拟合目标关联。简短的搜索会妨碍收敛。\n- **结论：** 此选项中提出的每一项行动都适得其反，并显示出对 SQS 生成过程的误解。\n\n**结论：错误**\n\n**C. 保持团簇列表和退火方案不变，但允许每个物种的组分偏差高达 $\\pm 10\\%$，以使优化器能够在 $2\\times 2\\times 2$ 超胞中匹配更多的团簇关联；接受组分误差相对于关联精度而言可以忽略不计。**\n\n- **放宽组分：** 虽然放宽组分约束增加了自由度，但与等原子比组分相差 $\\pm 10\\%$ 的偏差是巨大的，并从根本上改变了所模拟的体系。高熵合金的性质可能对这种组分变化很敏感。声称这种误差“可以忽略”是一个很强的断言，而且通常是错误的。\n- **保持其他参数不变：** 该选项未能解决其他关键问题：过度约束的团簇列表和不充分的退火方案。小的 $N=32$ 胞元的主要局限性仍然存在。\n- **结论：** 这种方法试图通过牺牲模型组分的保真度来进行表面修复，而组分是合金的一个关键定义参数。这不是一个鲁棒或可靠的策略。\n\n**结论：错误**\n\n**D. 将超胞增加到 $4\\times 4\\times 4$ ($N=256$)，对所有团簇保持相同的权重，将每次运行的退火交换尝试限制在 $10^{3}$ 次以控制计算时间，并接受所获得的任何目标函数值，因为大尺寸的胞元本身就应该能保证接近随机的关联，即使没有仔细优化。**\n\n- **超胞尺寸 ($N=256$)：** 如此尺寸的超胞对于 DFT 计算来说要求极高。其成本大约是选项 A 中胞元的 $(256/108)^3 \\approx 13.3$ 倍，是原始胞元的 $(256/32)^3 = 512$ 倍，对于大多数项目来说，这很可能违反了“合理的 DFT 成本”约束。\n- **退火不充分：** 对于一个包含 $N=256$ 个原子的胞元，$10^3$ 次交换尝试是完全不够的搜索。系统将保持在其初始随机构型附近。\n- **前提有误：** 认为仅凭大尺寸胞元就能在没有优化的情况下“保证”接近随机的关联，这种假设是错误的。一个特定的有限尺寸胞元，即使很大，其短程有序也可能存在显著的统计涨落。SQS 方法的全部目的就是在一个给定的胞元尺寸下，确定性地最小化这些涨落。\n- **结论：** 该选项在计算上不切实际，并且基于一个有缺陷的物理假设。\n\n**结论：错误**\n\n**E. 保持 $2\\times 2\\times 2$ 的超胞和精确的团簇列表，但仅修改模拟退火方案，从更高的初始温度开始并更缓慢地冷却，将交换尝试增加到 $10^{6}$ 次；避免对团簇列表、权重或胞元尺寸进行任何更改，以保留原始设定。**\n\n- **改进的退火方案：** 这是一个积极的改变，因为它允许进行更彻底的搜索。\n- **保持胞元和团簇列表不变：** 这是致命的缺陷。如果问题在数学上是过度约束的（这很有可能），那么任何优化都无法找到一个不存在的解。为一个不可能的目标进行更长时间的搜索是徒劳的。虽然与最初的短时间运行相比可能会找到一个更好的目标函数值，但它极不可能满足所需的容差。\n- **结论：** 这个计划只解决了搜索算法的弱点，却忽略了系统过度约束这一更根本的问题。这是一个不完整的解决方案，不大可能成功。\n\n**结论：错误**",
            "answer": "$$ \\boxed{A} $$"
        }
    ]
}