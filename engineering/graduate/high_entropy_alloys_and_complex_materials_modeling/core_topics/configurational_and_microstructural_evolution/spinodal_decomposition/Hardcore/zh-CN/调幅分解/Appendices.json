{
    "hands_on_practices": [
        {
            "introduction": "对旋节分解的理解始于其热力学根源——均相自由能的不稳定性。本练习  提供了一个具体的解析实践，指导你使用经典的规则溶体模型，通过确定自由能曲线的曲率变为负值的临界点，来精确地推导出不稳定的成分区间。这项基本功训练有助于你深入掌握相分离发生的根本“原因”。",
            "id": "3758622",
            "problem": "一个多组分高熵合金的二元子体系在固定温度下，使用平均场规整溶体单位晶格点自由能进行建模\n$$\nf(c)=\\Omega\\,c\\,(1-c)+k_{B}\\,T\\left[c\\,\\ln c+(1-c)\\,\\ln(1-c)\\right],\n$$\n其中，$c\\in(0,1)$ 是一个组分的摩尔分数，$\\Omega0$ 是一个由异类键合能量产生的、不依赖于温度的有效相互作用参数，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。在旋节线分解的框架内，固定温度 $T$ 下不稳定区域的边界成分是指在固定温度 $T$ 和压力下，均匀自由能相对于成分 $c$ 出现局部拐点的成分。\n\n仅从上述自由能 $f(c)$以及旋节线是均匀自由能相对于成分的曲率为零的轨迹这一定义出发，确定两个旋节线成分 $c_{-}(T)$ 和 $c_{+}(T)$，将其表示为 $\\Omega$、$k_{B}$ 和 $T$ 的显式函数。将您的最终答案以精确闭合形式表示为行矩阵 $\\left(c_{-}\\ \\ c_{+}\\right)$。然后，在您的推导过程中，解释不稳定成分区间宽度 $c_{+}(T)-c_{-}(T)$ 如何依赖于温度，并确定不存在不稳定成分的温度上限。无需进行数值计算，也不允许四舍五入。最终答案中请勿包含单位。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **均匀自由能（单位晶格点）**: $f(c)=\\Omega\\,c\\,(1-c)+k_{B}\\,T\\left[c\\,\\ln c+(1-c)\\,\\ln(1-c)\\right]$\n-   **成分**: $c \\in (0,1)$ 是一个组分的摩尔分数。\n-   **相互作用参数**: $\\Omega  0$，不依赖于温度。\n-   **常数**: $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n-   **旋节线边界的定义**: 自由能相对于成分的曲率为零的轨迹。在数学上，这对应于 $\\frac{d^2f}{dc^2}=0$ 时的成分 $c$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**: 该问题基于规整溶体模型，这是经典材料热力学的基石，用于描述二元体系的混合行为。旋节线边界的定义——自由能对成分的二阶导数为零（$\\frac{d^2f}{dc^2}=0$）的点之轨迹——是 Cahn-Hilliard 旋节线分解理论中使用的基本定义。条件 $\\Omega  0$ 正确地模拟了一个具有正混合焓的体系，这是发生相分离的先决条件。该问题在科学上和事实上都是合理的。\n2.  **适定性**: 该问题提供了一个明确定义的数学函数 $f(c)$ 和一个清晰、形式化的待解条件（$\\frac{d^2f}{dc^2}=0$）。寻找旋节线成分 $c_{-}(T)$ 和 $c_{+}(T)$ 的目标是明确的。所提供的信息足以推导出唯一解。\n3.  **客观性**: 该问题以物理冶金学和材料热力学领域的标准语言陈述，精确、定量且客观。所有术语都有明确定义。\n\n### 第3步：结论与行动\n该问题是**有效的**，因为它具有科学依据、适定性、客观性和自洽性。可以继续求解过程。\n\n---\n\n旋节线边界定义为自由能曲面相对于成分的曲率为零的成分和温度集合。这表明了均匀相抵抗无穷小成分涨落的稳定性极限。在数学上，这个条件表示为：\n$$\n\\frac{d^2f}{dc^2} = 0\n$$\n我们从给定的单位晶格点自由能表达式开始：\n$$\nf(c) = \\Omega c(1-c) + k_B T [c \\ln c + (1-c) \\ln(1-c)]\n$$\n为了找到旋节线成分，我们必须计算 $f(c)$ 对 $c$ 的二阶导数。首先，我们计算一阶导数 $\\frac{df}{dc}$：\n$$\n\\frac{df}{dc} = \\frac{d}{dc} \\left( \\Omega c - \\Omega c^2 \\right) + k_B T \\frac{d}{dc} \\left[ c \\ln c + (1-c) \\ln(1-c) \\right]\n$$\n焓项的导数是：\n$$\n\\frac{d}{dc} \\left( \\Omega c - \\Omega c^2 \\right) = \\Omega - 2\\Omega c = \\Omega(1-2c)\n$$\n熵项的导数是：\n$$\n\\frac{d}{dc} \\left[ c \\ln c + (1-c) \\ln(1-c) \\right] = \\left( 1 \\cdot \\ln c + c \\cdot \\frac{1}{c} \\right) + \\left( -1 \\cdot \\ln(1-c) + (1-c) \\cdot \\frac{-1}{1-c} \\right)\n$$\n$$\n= (\\ln c + 1) + (-\\ln(1-c) - 1) = \\ln c - \\ln(1-c) = \\ln\\left(\\frac{c}{1-c}\\right)\n$$\n结合这些结果，一阶导数是：\n$$\n\\frac{df}{dc} = \\Omega(1-2c) + k_B T \\ln\\left(\\frac{c}{1-c}\\right)\n$$\n接下来，我们通过对 $\\frac{df}{dc}$求导来计算二阶导数 $\\frac{d^2f}{dc^2}$：\n$$\n\\frac{d^2f}{dc^2} = \\frac{d}{dc} \\left[ \\Omega(1-2c) \\right] + k_B T \\frac{d}{dc} \\left[ \\ln c - \\ln(1-c) \\right]\n$$\n第一项的导数是：\n$$\n\\frac{d}{dc} \\left[ \\Omega(1-2c) \\right] = -2\\Omega\n$$\n第二项的导数是：\n$$\nk_B T \\left( \\frac{1}{c} - \\frac{-1}{1-c} \\right) = k_B T \\left( \\frac{1}{c} + \\frac{1}{1-c} \\right) = k_B T \\left( \\frac{1-c+c}{c(1-c)} \\right) = \\frac{k_B T}{c(1-c)}\n$$\n因此，自由能的二阶导数是：\n$$\n\\frac{d^2f}{dc^2} = -2\\Omega + \\frac{k_B T}{c(1-c)}\n$$\n为了找到旋节线成分，我们将此表达式设为零：\n$$\n-2\\Omega + \\frac{k_B T}{c(1-c)} = 0\n$$\n$$\n\\frac{k_B T}{c(1-c)} = 2\\Omega\n$$\n整理这个方程得到一个关于成分 $c$ 的二次方程：\n$$\nc(1-c) = \\frac{k_B T}{2\\Omega}\n$$\n$$\nc - c^2 = \\frac{k_B T}{2\\Omega}\n$$\n$$\nc^2 - c + \\frac{k_B T}{2\\Omega} = 0\n$$\n我们使用二次方程求根公式 $c = \\frac{-b \\pm \\sqrt{b^2-4ac_{q}}}{2a}$ 来解这个二次方程，其中 $a=1$, $b=-1$, $c_{q}=\\frac{k_B T}{2\\Omega}$：\n$$\nc = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(1)\\left(\\frac{k_B T}{2\\Omega}\\right)}}{2(1)}\n$$\n$$\nc = \\frac{1 \\pm \\sqrt{1 - \\frac{2k_B T}{\\Omega}}}{2}\n$$\n这两个解代表了旋节线区域的边界，$c_{-}(T)$ 和 $c_{+}(T)$：\n$$\nc_{-}(T) = \\frac{1}{2}\\left(1 - \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right)\n$$\n$$\nc_{+}(T) = \\frac{1}{2}\\left(1 + \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right)\n$$\n不稳定成分区间的宽度为 $\\Delta c(T) = c_{+}(T) - c_{-}(T)$：\n$$\n\\Delta c(T) = \\frac{1}{2}\\left(1 + \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right) - \\frac{1}{2}\\left(1 - \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right) = \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\n$$\n随着温度 $T$升高，项 $\\frac{2k_B T}{\\Omega}$ 增大，导致平方根下的项 $1 - \\frac{2k_B T}{\\Omega}$ 减小。因此，不稳定区间的宽度 $\\Delta c(T)$ 随着温度的升高而减小。\n\n只有当 $c$ 的解是实数且不相等时，才存在不稳定成分。这要求二次方程的判别式为正：\n$$\n1 - \\frac{2k_B T}{\\Omega} > 0 \\implies 1 > \\frac{2k_B T}{\\Omega} \\implies T  \\frac{\\Omega}{2k_B}\n$$\n不稳定区域存在的上限是临界温度 $T_c$，此时判别式为零。高于此温度，判别式为负，导致 $c$ 没有实数解，这意味着对于所有成分 $\\frac{d^2f}{dc^2} > 0$，体系处处稳定/可混溶。我们通过将判别式设为零来求 $T_c$：\n$$\n1 - \\frac{2k_B T_c}{\\Omega} = 0 \\implies T_c = \\frac{\\Omega}{2k_B}\n$$\n因此，对于任何温度 $T > \\frac{\\Omega}{2k_B}$，都不存在不稳定成分。在 $T=T_c$ 时，两个旋节线成分在 $c=\\frac{1}{2}$ 处合并。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}\\left(1 - \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right)  \\frac{1}{2}\\left(1 + \\sqrt{1 - \\frac{2k_B T}{\\Omega}}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从静态的热力学条件出发，我们现在转向微观结构演化的动态过程。Cahn-Hilliard 方程是描述这一过程的核心动力学模型。本练习  将引导你推导并实现一种强大而高效的数值方法——半隐式傅里叶谱方法，用于求解 Cahn-Hilliard 方程。通过这项实践，你将能够把抽象的偏微分方程转化为可观察的相分离过程模拟，亲眼见证从无序到有序的微观结构形成。",
            "id": "3758544",
            "problem": "考虑使用 Cahn-Hilliard 方程对高熵合金中的调幅分解进行相场描述。设组分场为一维长度为 $L$ 的周期性域上的标量函数 $c(\\mathbf{x},t)$。该演化是自由能泛函的变分梯度流。假设迁移率 $M0$ 为常数，自由能密度为 Ginzburg-Landau 类型的 $f(c)$，并带有梯度能量正则化项。基本要素包括：\n- 自由能泛函的定义 $F[c] = \\int \\left( f(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) \\, d\\mathbf{x}$，其中 $\\kappa0$。\n- Cahn-Hilliard 动力学 $ \\partial_t c = M \\nabla^2 \\mu$，其中化学势是泛函导数 $\\mu = \\delta F / \\delta c$。\n- 周期性域上空间导数的链式法则和傅里叶表示。\n\n利用这些基本要素，推导一个半隐式傅里叶谱方法时间积分格式。该格式通过对线性刚性项进行隐式处理、对非线性项进行显式处理并采用稳定的线性分裂，从而在较大时间步长下保持数值稳定性。具体步骤如下：\n1. 从自由能密度 $f(c) = \\frac{\\lambda}{4} (c^2 - 1)^2$（其中 $\\lambda0$）出发，计算化学势 $\\mu$（用 $c$ 及其拉普拉斯量表示）。\n2. 在长度为 $L$ 的一维周期性域上，将控制方程表示在傅里叶空间中，使用与傅里叶模相关的波数 $k$（其中 $k = 2\\pi m / L$，$m$ 为整数）来表示空间导数。\n3. 设计一个半隐式稳定分裂，通过加减一个常数线性项来确保对所有傅里叶模 $k$ 的隐式分母都严格为正，并根据 $f(c)$ 的曲率来证明稳定化常数 $S$ 选择的合理性。\n4. 推导在傅里叶空间中从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的单时间步更新公式，将每个波数 $k$ 处的组分傅里叶系数更新表示为一个包含 $M$, $\\kappa$, $\\lambda$, $S$, $\\Delta t$ 以及在时间 $t^n$ 计算的三次非线性项 $c^3$ 的离散傅里叶变换的有理表达式。确保推导出的公式保持零模（质量守恒），并对任意时间步长 $\\Delta t0$ 都能得到一个严格为正的隐式分母。\n\n实现一个基于一维快速傅里叶变换 (FFT) 的求解器，在均匀网格上使用您推导的格式执行单个时间步。将空间域表示为 $[0,L)$，包含 $N$ 个等距点和周期性边界条件。使用标准的离散傅里愈变换及其逆变换，并根据 FFT 频率约定来计算波数 $k$。\n\n对于下述每个测试用例，计算以下量：\n- $q_1$：一个布尔值，指示隐式分母 $1 + \\Delta t \\, M \\, k^2 \\, (S + \\kappa k^2)$ 对于所有离散傅里叶模 $k$（包括 $k=0$）是否严格为正。以布尔值形式返回 $q_1$。\n- $q_2$：一个布尔值，指示一个时间步后的质量守恒，定义为 $\\left|\\overline{c}^{\\, n+1} - \\overline{c}^{\\, n}\\right|  10^{-12}$，其中 $\\overline{c}$ 是空间平均值。以布尔值形式返回 $q_2$。\n- $q_3$：忽略显式非线性项时，在所有非零离散波数 $k$ 上的线性放大因子的最大幅值，定义为\n$$\ng(k) = \\frac{1 - \\Delta t \\, M \\, k^2 \\, (A - S)}{1 + \\Delta t \\, M \\, k^2 \\, (S + \\kappa k^2)}, \\quad \\text{with } A = -\\lambda.\n$$\n以浮点数形式返回 $q_3$。\n- $q_4$：自由能变化量 $\\Delta F = F[c^{n+1}] - F[c^{n}]$，使用 $F[c] = \\int \\left( \\frac{\\lambda}{4} (c^2 - 1)^2 + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx$ 的离散近似进行计算。以浮点数形式返回 $q_4$。\n\n使用以下参数值和初始条件的测试套件（格式中的所有变量都是无量纲的，因此不需要物理单位）：\n- 测试用例 1：$N=128$，$L=1$，$\\lambda=1$，$\\kappa=0.01$，$M=1$，$\\Delta t=5$，$S=\\lambda$，初始条件 $c(x) = 0 + 0.01 \\cos(2\\pi \\cdot 4 \\, x / L)$。\n- 测试用例 2：$N=128$，$L=1$，$\\lambda=2$，$\\kappa=0.02$，$M=1$，$\\Delta t=50$，$S=\\lambda$，初始条件 $c(x) = 0 + 0.02 \\cos(2\\pi \\cdot 3 \\, x / L)$。\n- 测试用例 3：$N=256$，$L=1$，$\\lambda=1$，$\\kappa=0.2$，$M=0.5$，$\\Delta t=100$，$S=\\lambda$，初始条件 $c(x) = 0 + 0.01 \\cos(2\\pi \\cdot 6 \\, x / L)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的扁平列表，其顺序为 $[q_1^{(1)}, q_2^{(1)}, q_3^{(1)}, q_4^{(1)}, q_1^{(2)}, q_2^{(2)}, q_3^{(2)}, q_4^{(2)}, q_1^{(3)}, q_2^{(3)}, q_3^{(3)}, q_4^{(3)}]$，其中上标表示测试用例索引。所有布尔值必须打印为 True 或 False。所有浮点数必须以十进制形式打印。",
            "solution": "该问题具有科学依据，是适定的，并且为获得唯一解提供了所有必要的数据和条件。因此，该问题被认为是**有效的**。\n\n解决方案要求推导 Cahn-Hilliard 方程的半隐式傅里叶谱方法，并实现该方法以求解特定的测试用例。推导和实现步骤概述如下。\n\n### 步骤 1：半隐式数值格式的推导\n\n**1.1. 化学势和控制方程**\n\nCahn-Hilliard 动力学由方程 $\\partial_t c = M \\nabla^2 \\mu$ 控制，其中 M 是恒定迁移率，μ 是化学势。化学势是 Ginzburg-Landau 自由能泛函 F[c] 的变分导数：\n$$\nF[c] = \\int \\left( f(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) \\, d\\mathbf{x}\n$$\n自由能密度由 $f(c) = \\frac{\\lambda}{4} (c^2 - 1)^2$ 给出。变分导数 $\\mu = \\delta F / \\delta c$ 使用欧拉-拉格朗日方程求得：\n$$\n\\mu = \\frac{\\partial f}{\\partial c} - \\nabla \\cdot \\frac{\\partial}{\\partial(\\nabla c)}\\left(\\frac{\\kappa}{2} |\\nabla c|^2\\right)\n$$\n体自由能密度的导数为：\n$$\n\\frac{\\partial f}{\\partial c} = \\frac{\\partial}{\\partial c} \\left( \\frac{\\lambda}{4} (c^4 - 2c^2 + 1) \\right) = \\frac{\\lambda}{4} (4c^3 - 4c) = \\lambda(c^3 - c)\n$$\n关于梯度的导数为：\n$$\n\\nabla \\cdot \\frac{\\partial}{\\partial(\\nabla c)}\\left(\\frac{\\kappa}{2} |\\nabla c|^2\\right) = \\nabla \\cdot (\\kappa \\nabla c) = \\kappa \\nabla^2 c\n$$\n将这些结合起来，化学势为：\n$$\n\\mu(c) = \\lambda(c^3 - c) - \\kappa \\nabla^2 c\n$$\n将此代入 Cahn-Hilliard 方程，得到完整的控制偏微分方程：\n$$\n\\partial_t c = M \\nabla^2 \\left( \\lambda c^3 - \\lambda c - \\kappa \\nabla^2 c \\right)\n$$\n\n**1.2. 傅里叶空间中的公式化**\n\n在一维长度为 L 的周期性域上，我们可以使用傅里叶级数来表示浓度场 c(x,t) 及其导数。令 $\\hat{c}(k,t) = \\mathcal{F}\\{c(x,t)\\}$ 表示 $c(x,t)$ 的傅里叶变换，其中 $k = 2\\pi m / L$（$m$ 为整数）是波数。傅里叶空间中的空间导数算子变为乘以 $(ik)$，其中 $i$ 是虚数单位。因此，$\\mathcal{F}\\{\\nabla c\\} = ik\\hat{c}$ 且 $\\mathcal{F}\\{\\nabla^2 c\\} = (ik)^2\\hat{c} = -k^2\\hat{c}$。对控制方程应用傅里叶变换可得：\n$$\n\\partial_t \\hat{c}(k,t) = M(-k^2) \\mathcal{F}\\{\\lambda c^3 - \\lambda c - \\kappa \\nabla^2 c\\}\n$$\n$$\n\\partial_t \\hat{c} = -M k^2 \\left( \\lambda \\widehat{c^3} - \\lambda \\hat{c} - \\kappa(-k^2)\\hat{c} \\right)\n$$\n$$\n\\partial_t \\hat{c} = -M k^2 \\left( \\lambda \\widehat{c^3} - (\\lambda - \\kappa k^2)\\hat{c} \\right)\n$$\n$$\n\\partial_t \\hat{c} = -M \\lambda k^2 \\widehat{c^3} + M k^2 (\\lambda - \\kappa k^2)\\hat{c}\n$$\n对于每个傅里叶模 $\\hat{c}(k,t)$，这是一个关于时间的常微分方程。项 $-M\\kappa \\nabla^4 c$ 在傅里叶空间中变为 $-M\\kappa k^4 \\hat{c}$，对于大波数 $k$ 而言是高度刚性的，这使得对于大时间步长 $\\Delta t$ 的数值稳定性需要采用隐式或半隐式时间积分格式。\n\n**1.3. 稳定化半隐式格式设计**\n\n为了构建一个稳定的半隐式格式，我们将演化方程的右端项分裂为将要进行显式处理的项和将要进行隐式处理的项。刚性线性项进行隐式处理，而非线性项进行显式处理。为了提高稳定性，我们加减一个线性稳定项 $S c$，其中 $S$ 是一个正常数。\n\n通过加减 $M \\nabla^2 (S c)$，重写控制方程：\n$$\n\\partial_t c = M \\nabla^2 (\\lambda c^3 - \\lambda c - \\kappa \\nabla^2 c + Sc - Sc)\n$$\n对于从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的半隐式（IMEX）时间离散化，我们将各项分组如下：\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = \\underbrace{M \\nabla^2 (\\lambda (c^n)^3 - (\\lambda+S)c^n)}_{\\text{Explicit part}} + \\underbrace{M \\nabla^2 (S c^{n+1} - \\kappa \\nabla^2 c^{n+1})}_{\\text{Implicit part}}\n$$\n将这个离散化方程变换到傅里叶空间：\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M(-k^2)[\\lambda \\widehat{(c^n)^3} - (\\lambda+S)\\hat{c}^n] + M(-k^2)[S\\hat{c}^{n+1} - \\kappa(-k^2)\\hat{c}^{n+1}]\n$$\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = -M k^2(\\lambda \\widehat{(c^n)^3} - (\\lambda+S)\\hat{c}^n) - M k^2(S\\hat{c}^{n+1} + \\kappa k^2\\hat{c}^{n+1})\n$$\n现在，我们重新整理以求解 $\\hat{c}^{n+1}$：\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -\\Delta t M k^2(\\lambda \\widehat{(c^n)^3} - (\\lambda+S)\\hat{c}^n) - \\Delta t M k^2(S + \\kappa k^2)\\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1} (1 + \\Delta t M k^2(S + \\kappa k^2)) = \\hat{c}^n - \\Delta t M k^2 \\lambda \\widehat{(c^n)^3} + \\Delta t M k^2 (\\lambda+S)\\hat{c}^n\n$$\n$$\n\\hat{c}^{n+1} (1 + \\Delta t M k^2(S + \\kappa k^2)) = \\hat{c}^n (1 + \\Delta t M k^2(\\lambda+S)) - \\Delta t M k^2 \\lambda \\widehat{(c^n)^3}\n$$\n\n**1.4. 最终更新公式及其性质**\n\n这给出了每个模 $k$ 的傅里叶系数的最终更新公式：\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k)(1 + \\Delta t \\, M \\, k^2(\\lambda+S)) - \\Delta t \\, M \\, k^2 \\, \\lambda \\, \\mathcal{F}((c^n)^3)(k)}{1 + \\Delta t \\, M \\, k^2 \\, (S + \\kappa k^2)}\n$$\n- **稳定化常数 $S$**：该格式的稳定性与能量泛函的凸性有关。体能量密度的曲率为 $f''(c) = \\lambda(3c^2-1)$。通过添加一个二次项 $\\frac{S}{2}c^2$（其中 $S \\ge \\max(-f''(c))$），可以使项 $-f(c)$ 变为凸的。$f''(c)$ 的最小值为 $-\\lambda$（在 $c=0$ 处），因此选择 $S \\ge \\lambda$ 是合适的。问题指定 $S=\\lambda$，这满足了此稳定性要求。\n\n- **正分母**：更新公式的分母为 $D(k) = 1 + \\Delta t M k^2 (S + \\kappa k^2)$。鉴于 $\\Delta t  0$，$M  0$，$\\kappa  0$，并且我们选择 $S = \\lambda  0$，乘积中的所有项都是非负的。因此，对于所有波数 $k$，$D(k) \\ge 1$，确保了分母严格为正，并且该格式对于任何 $\\Delta t  0$ 都是良定义的。\n\n- **质量守恒（零模）**：对于零模（$k=0$），更新公式显著简化。分子变为 $\\hat{c}^n(0)(1+0) - 0 = \\hat{c}^n(0)$。分母变为 $1+0=1$。因此，$\\hat{c}^{n+1}(0) = \\hat{c}^n(0)$。由于空间平均值 $\\overline{c}$ 与 $\\hat{c}(0)$ 成正比，这直接意味着 $\\overline{c}^{\\, n+1} = \\overline{c}^{\\, n}$，因此总质量（或平均浓度）在该格式下是守恒的。\n\n### 步骤 2：求解器的实现\n\n该实现将在离散网格上使用快速傅里叶变换 (FFT)。\n\n- **离散化**：域 $[0,L)$ 被离散为 $N$ 个点 $x_j = j(L/N)$，其中 $j=0, \\dots, N-1$。\n- **波数**：与 FFT 对应的离散波数通过 `numpy.fft.fftfreq(N, d=L/N)` 计算，并乘以 $2\\pi$ 以从频率转换为角波数。\n- **算法**：\n  1. 在网格上初始化浓度场 $c^n(x_j)$。\n  2. 计算三次项 $(c^n)^3$。\n  3. 计算 FFTs $\\hat{c}^n = \\mathcal{F}\\{c^n\\}$ 和 $\\widehat{(c^n)^3} = \\mathcal{F}\\{(c^n)^3\\}$。\n  4. 对每个离散波数 $k$，计算推导出的更新公式的分子和分母。\n  5. 计算更新后的傅里叶系数 $\\hat{c}^{n+1}$。\n  6. 通过对 $\\hat{c}^{n+1}$ 应用逆 FFT 并取实部，计算新的浓度场 $c^{n+1}$。\n- **要计算的量**：\n  - $q_1$：检查分母数组的所有值是否大于 $0$。\n  - $q_2$：检查 $c^{n+1}$ 和 $c^n$ 的平均值之间的绝对差是否低于一个小容差 ($10^{-12}$)。\n  - $q_3$：计算所有非零 $k$ 的线性放大因子 $g(k)$，并求其绝对值的最大值。该因子为 $g(k) = (1 + \\Delta t M k^2(\\lambda+S)) / (1 + \\Delta t M k^2(S+\\kappa k^2))$。\n  - $q_4$：计算总自由能的变化，$\\Delta F = F[c^{n+1}] - F[c^{n}]$。自由能 $F[c]$ 作为网格上的离散和计算：\n    $F[c] \\approx \\frac{L}{N} \\sum_{j=0}^{N-1} \\left( \\frac{\\lambda}{4}(c_j^2 - 1)^2 + \\frac{\\kappa}{2} (\\nabla c)_j^2 \\right)$。\n    梯度项 $(\\nabla c)_j$ 通过对 $(ik\\hat{c}_k)$ 进行傅里叶逆变换来以谱方法计算。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_free_energy(c, L, lam, kap):\n    \"\"\"\n    Computes the discrete free energy of the concentration field c.\n    F[c] = integral( f(c) + kappa/2 * |grad(c)|^2 ) dx\n    \"\"\"\n    N = c.shape[0]\n    dx = L / N\n    \n    # Wavenumbers for spectral differentiation\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    \n    # Chemical energy part\n    f_chem = 0.25 * lam * (c**2 - 1)**2\n    F_chem = np.sum(f_chem) * dx\n    \n    # Gradient energy part (computed spectrally)\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    \n    F_grad = np.sum(0.5 * kap * grad_c**2) * dx\n    \n    return F_chem + F_grad\n\ndef single_step_solver(N, L, lam, kap, M, dt, S, c_initial):\n    \"\"\"\n    Performs a single time step of the Cahn-Hilliard equation\n    using the derived semi-implicit Fourier spectral scheme.\n    \"\"\"\n    # Grid and initial condition\n    cn = c_initial\n    \n    # Wavenumbers\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    k2 = k**2\n    \n    # ----- Time-stepping -----\n    \n    # Compute nonlinear term and its FFT\n    cn_cubed = cn**3\n    cn_cubed_hat = np.fft.fft(cn_cubed)\n    \n    # Compute FFT of the current concentration field\n    cn_hat = np.fft.fft(cn)\n    \n    # Numerator of the update formula\n    numer = cn_hat * (1 + dt * M * k2 * (lam + S)) - dt * M * lam * k2 * cn_cubed_hat\n    \n    # Denominator of the update formula\n    denom = 1 + dt * M * k2 * (S + kap * k2)\n    \n    # Update in Fourier space\n    cn1_hat = numer / denom\n    \n    # Transform back to real space\n    cn1 = np.real(np.fft.ifft(cn1_hat))\n    \n    # ----- Calculate quantities of interest -----\n    \n    # q1: Denominator positivity\n    q1 = np.all(denom > 0)\n    \n    # q2: Mass conservation\n    mean_cn = np.mean(cn)\n    mean_cn1 = np.mean(cn1)\n    q2 = np.abs(mean_cn1 - mean_cn)  1e-12\n    \n    # q3: Max linear amplification factor for k != 0\n    # The linear amplification factor g(k) is defined in the problem.\n    # A = -lambda\n    # g(k) = (1 - dt * M * k^2 * (A - S)) / (1 + dt * M * k^2 * (S + kap * k^2))\n    # g(k) = (1 - dt * M * k^2 * (-lam - S)) / (1 + dt * M * k^2 * (S + kap * k^2))\n    # g(k) = (1 + dt * M * k^2 * (lam + S)) / (1 + dt * M * k^2 * (S + kap * k^2))\n    k_nonzero_indices = np.where(k != 0)\n    k2_nonzero = k2[k_nonzero_indices]\n    \n    g_k_numer = 1 + dt * M * k2_nonzero * (lam + S)\n    g_k_denom = 1 + dt * M * k2_nonzero * (S + kap * k2_nonzero)\n    g_k = g_k_numer / g_k_denom\n    q3 = np.max(np.abs(g_k))\n    \n    # q4: Change in free energy\n    F_n = calculate_free_energy(cn, L, lam, kap)\n    F_n1 = calculate_free_energy(cn1, L, lam, kap)\n    q4 = F_n1 - F_n\n    \n    return q1, q2, q3, q4\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (N, L, lam, kap, M, dt, S, initial_condition_func)\n        (128, 1.0, 1.0, 0.01, 1.0, 5.0, 1.0, lambda x, L: 0.0 + 0.01 * np.cos(2 * np.pi * 4 * x / L)),\n        (128, 1.0, 2.0, 0.02, 1.0, 50.0, 2.0, lambda x, L: 0.0 + 0.02 * np.cos(2 * np.pi * 3 * x / L)),\n        (256, 1.0, 1.0, 0.2, 0.5, 100.0, 1.0, lambda x, L: 0.0 + 0.01 * np.cos(2 * np.pi * 6 * x / L)),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, L, lam, kap, M, dt, S, ic_func = case\n        \n        # Create the spatial grid and initial condition\n        x = np.linspace(0, L, N, endpoint=False)\n        c_initial = ic_func(x, L)\n        \n        # Run the solver for one step\n        q1, q2, q3, q4 = single_step_solver(N, L, lam, kap, M, dt, S, c_initial)\n        \n        results.extend([q1, q2, q3, q4])\n        \n    # Format the final output string\n    # Booleans are printed as True/False, floats in standard decimal form.\n    formatted_results = []\n    for r in results:\n        if isinstance(r, (bool, np.bool_)):\n            formatted_results.append(str(r))\n        else:\n            formatted_results.append(f\"{r}\")\n            \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型最终需要与实验现实相结合。材料科学家的一个核心任务便是从实验数据中确定模型的关键物理参数。这项高级实践  旨在搭建理论与实验之间的桥梁，指导你构建一个现代化的贝叶斯推断工作流，从模拟的散射数据中提取 Cahn-Hilliard 模型的有效迁移率 $M$ 和梯度能系数 $\\kappa$。更重要的是，你将学会如何量化这些估计参数的不确定性，这是严谨科学研究中不可或缺的一环。",
            "id": "3758542",
            "problem": "考虑一种正在发生旋节线分解的高熵合金（HEA），其过程由Cahn-Hilliard（CH）方程建模。假设单一主导的成分模式可以通过一个有效的标量迁移率和曲率来描述，这与在均匀成分附近对CH方程进行的线性化处理相一致。小振幅体系允许将时间分辨散射强度与成分场的傅里叶模式的放大关联起来。您必须构建一个贝叶斯工作流，从基本定律和核心定义出发（而不是使用预先指定的目标公式），从时间分辨散射数据中推断有效参数并量化其不确定性。\n\n给定以下基于物理的背景：\n\n- 在连续介质极限下，二元混合物的自由能泛函定义为一个局部自由能密度和一个梯度惩罚项的空间积分。\n- 化学势是自由能相对于成分场的泛函导数。\n- CH动力学由一个守恒序参量方程控制，其中扩散通量与化学势的梯度成正比。\n- 在小涨落体系中，傅里叶模式的线性化演化和由此产生的结构因子决定了散射强度的增长或衰减。\n- 初始结构因子可能是未知的，但通过在每个波数下用初始强度进行归一化，可以消除模型对初始振幅的依赖。\n\n基于这些基本点，推导归一化散射强度与模型参数之间的适当线性化增长关系。\n\n假设使用以下建模框架进行推断：\n\n- 噪声模型在归一化强度的对数上是加性的高斯噪声，其标准差已知。\n- 每个参数的先验是在物理上合理的界限内的对数均匀分布。\n- 后验必须在参数空间的网格上进行评估，并且必须报告最大后验（MAP）估计和边缘可信区间。\n\n需要推断的参数：\n\n- 有效迁移率 $M$，单位为 $\\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$。\n- 梯度能量系数 $\\kappa$，单位为 $\\mathrm{J} / \\mathrm{m}$。\n\n已知常数：\n\n- 旋节线驱动参数 $\\alpha$（均匀自由能密度的二阶导数的负值），单位为 $\\mathrm{J} / \\mathrm{m}^3$，在所有测试案例中均已提供。\n\n噪声模型：\n\n- 令 $y_{k,t}$ 表示在波数 $k$ 和时间 $t$ 处的归一化强度的对数。假设 $y_{k,t}$ 围绕理论预测值呈高斯分布，其标准差 $\\sigma$ 已知。\n\n先验模型：\n\n- $M$ 在 $[10^{-21}, 10^{-17}]$ $\\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$ 范围内呈对数均匀分布。\n- $\\kappa$ 在 $[10^{-10}, 10^{-8}]$ $\\mathrm{J} / \\mathrm{m}$ 范围内呈对数均匀分布。\n\n您必须实现一个程序，该程序：\n\n1. 从CH基本原理推导傅里叶模式线性增长的表达式，以及它与以 $M$、$\\kappa$ 和 $\\alpha$ 表示的归一化散射强度之间的联系。\n2. 使用此表达式为观测数据点 $(k_i, t_j, y_{i,j})$ 构建似然函数。\n3. 在 $(M, \\kappa)$ 的二维网格上使用对数均匀先验评估对数后验，并计算：\n   - 最大后验（MAP）估计 $(M_{\\mathrm{MAP}}, \\kappa_{\\mathrm{MAP}})$。\n   - 通过在网格上对后验进行积分形成边缘分布，并在累积概率 $0.025$ 和 $0.975$ 处提取下界和上界，从而得到 $M$ 和 $\\kappa$ 的 $95\\%$ 边缘可信区间。\n4. 以要求的格式打印一行输出，其中包含所有测试案例的结果。\n\n物理和数值单位：\n\n- 报告的 $M$ 单位为 $\\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$，$\\kappa$ 单位为 $\\mathrm{J} / \\mathrm{m}$。\n- 将报告的每个数字四舍五入到三位有效数字。\n\n测试套件：\n\n对于所有案例，取已知常数 $\\alpha = 5 \\times 10^5 \\ \\mathrm{J} / \\mathrm{m}^3$。每个案例的合成数据由波数 $k$（单位 $\\mathrm{m}^{-1}$）、时间 $t$（单位 $\\mathrm{s}$）和一个对数归一化强度 $y_{k,t}$ 组成，该强度是根据一组真实参数并在对数域中加入高斯噪声生成的。每个 $k$ 的初始强度用于归一化时间序列，因此观测值为 $y_{k,t} = \\log(I(k,t)) - \\log(I(k,0))$。\n\n- 案例 A（理想路径）：\n  - 真实参数：$M_{\\text{true}} = 1.0 \\times 10^{-19} \\ \\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9} \\ \\mathrm{J} / \\mathrm{m}$。\n  - 波数：$k \\in \\{4.0 \\times 10^{6}, 7.0 \\times 10^{6}, 9.0 \\times 10^{6}\\} \\ \\mathrm{m}^{-1}$。\n  - 时间：$t \\in \\{0.5, 1.0, 2.0\\} \\ \\mathrm{s}$。\n  - 对数域中的噪声标准差：$\\sigma = 0.05$。\n\n- 案例 B（接近增长截止边界）：\n  - 真实参数：$M_{\\text{true}} = 1.2 \\times 10^{-19} \\ \\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9} \\ \\mathrm{J} / \\mathrm{m}$。\n  - 波数：$k \\in \\{9.0 \\times 10^{6}, 1.0 \\times 10^{7}, 1.1 \\times 10^{7}\\} \\ \\mathrm{m}^{-1}$。\n  - 时间：$t \\in \\{0.5, 1.0, 2.0\\} \\ \\mathrm{s}$。\n  - 对数域中的噪声标准差：$\\sigma = 0.05$。\n\n- 案例 C（慢速增长，较大噪声）：\n  - 真实参数：$M_{\\text{true}} = 5.0 \\times 10^{-20} \\ \\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9} \\ \\mathrm{J} / \\mathrm{m}$。\n  - 波数：$k \\in \\{4.0 \\times 10^{6}, 6.0 \\times 10^{6}, 8.0 \\times 10^{6}\\} \\ \\mathrm{m}^{-1}$。\n  - 时间：$t \\in \\{1.0, 2.0, 3.0\\} \\ \\mathrm{s}$。\n  - 对数域中的噪声标准差：$\\sigma = 0.10$。\n\n在所有案例中，合成测量值均满足小振幅线性化体系的要求。数据生成必须与从CH方程和线性化热力学推导出的模型一致。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 对于每个案例，按以下顺序输出六个数字：\n  - $M_{\\mathrm{MAP}}$、$ \\kappa_{\\mathrm{MAP}}$、$M_{\\mathrm{low}}$、$M_{\\mathrm{high}}$、$ \\kappa_{\\mathrm{low}}$、$ \\kappa_{\\mathrm{high}}$，\n  其中 low/high 界限是 $95\\%$ 边缘可信区间的界限。\n- 按案例 A、案例 B、案例 C 的顺序连接三个案例的结果。\n- 将每个数字四舍五入到三位有效数字。\n\n例如，输出格式应为：\"[M_A_MAP,kappa_A_MAP,M_A_low,M_A_high,kappa_A_low,kappa_A_high,M_B_MAP,kappa_B_MAP,M_B_low,M_B_high,kappa_B_low,kappa_B_high,M_C_MAP,kappa_C_MAP,M_C_low,M_C_high,kappa_C_low,kappa_C_high]\"。",
            "solution": "该问题要求开发一个贝叶斯推断工作流，以从合成的时间分辨散射数据中估计有效迁移率 $M$ 和梯度能量系数 $\\kappa$。该模型基于线性化的Cahn-Hilliard (CH) 方程。此过程涉及两个主要阶段：首先，从基本原理推导理论模型；其次，实现贝叶斯推断算法。\n\n首先，执行问题陈述的验证。\n\n**步骤 1：提取给定信息**\n- **控制物理学**：系统由用于旋节线分解的Cahn-Hilliard (CH)方程描述。\n- **物理模型**：自由能泛函为 $F[c] = \\int (f(c) + \\frac{1}{2}\\kappa (\\nabla c)^2) dV$。化学势为 $\\mu = \\delta F / \\delta c$。通量由 $\\partial c / \\partial t = \\nabla \\cdot (M \\nabla \\mu)$ 控制。分析在小振幅（线性化）体系中进行。\n- **推断参数**：有效迁移率 $M$ (单位 $\\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$)，梯度能量系数 $\\kappa$ (单位 $\\mathrm{J} / \\mathrm{m}$)。\n- **已知常数**：旋节线驱动参数 $\\alpha = 5 \\times 10^5 \\ \\mathrm{J} / \\mathrm{m}^3$。\n- **数据**：可观测值为对数归一化强度 $y_{k,t} = \\log(I(k,t)) - \\log(I(k,0))$，对应给定的波数 $k$ 和时间 $t$。\n- **噪声模型**：$y_{k,t}$ 围绕理论预测值呈高斯分布，其标准差 $\\sigma$ 已知。\n- **先验模型**：\n    - $M$：在 $[10^{-21}, 10^{-17}] \\ \\mathrm{m}^5 / (\\mathrm{J} \\cdot \\mathrm{s})$ 上呈对数均匀分布。\n    - $\\kappa$：在 $[10^{-10}, 10^{-8}] \\ \\mathrm{J} / \\mathrm{m}$ 上呈对数均匀分布。\n- **任务**：\n    1. 推导归一化散射强度的线性增长关系。\n    2. 在 $(M, \\kappa)$ 的二维网格上构建对数后验。\n    3. 计算最大后验（MAP）估计 $(M_{\\mathrm{MAP}}, \\kappa_{\\mathrm{MAP}})$。\n    4. 计算 $M$ 和 $\\kappa$ 的 $95\\%$ 边缘可信区间。\n- **测试案例**：\n    - **案例 A**：$M_{\\text{true}} = 1.0 \\times 10^{-19}$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9}$，$k \\in \\{4.0 \\times 10^{6}, 7.0 \\times 10^{6}, 9.0 \\times 10^{6}\\}$，$t \\in \\{0.5, 1.0, 2.0\\}$，$\\sigma = 0.05$。\n    - **案例 B**：$M_{\\text{true}} = 1.2 \\times 10^{-19}$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9}$，$k \\in \\{9.0 \\times 10^{6}, 1.0 \\times 10^{7}, 1.1 \\times 10^{7}\\}$，$t \\in \\{0.5, 1.0, 2.0\\}$，$\\sigma = 0.05$。\n    - **案例 C**：$M_{\\text{true}} = 5.0 \\times 10^{-20}$，$\\kappa_{\\text{true}} = 5.0 \\times 10^{-9}$，$k \\in \\{4.0 \\times 10^{6}, 6.0 \\times 10^{6}, 8.0 \\times 10^{6}\\}$，$t \\in \\{1.0, 2.0, 3.0\\}$，$\\sigma = 0.10$。\n- **输出**：一行包含所有案例的连接结果，每个数字四舍五入到三位有效数字。\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学依据**：该问题基于Cahn-Hilliard理论，这是材料物理学中模拟相分离的基石。对小涨落的线性化（Cahn-Hilliard-Cook模型）是一种标准且有效的方法。结构因子和散射强度之间的联系是散射理论的基础。该问题在科学上是合理的。\n- **适定性**：提供了贝叶斯推断问题的所有必要组成部分：物理模型、似然函数（由噪声模型隐含）、先验分布和数据。目标是计算明确定义的统计量（MAP估计、可信区间）。该问题是适定的。\n- **客观性**：问题以精确、定量的语言表述。所有参数、常数和数据都已数值定义。任务是明确的。\n- **完整性与一致性**：问题是自洽的。它提供了求解所需的所有常数、参数范围和数据规范。单位已提供且在量纲上是一致的，这将在推导中显示。没有矛盾之处。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。我们可以继续进行求解。\n\n**理论模型的推导**\n\n推导从Cahn-Hilliard方程开始，该方程描述了守恒序参量场——成分 $c(\\mathbf{r}, t)$ 的时间演化。\n\n1.  **自由能与化学势**：非均匀系统的Ginzburg-Landau自由能泛函 $F$ 由下式给出：\n    $$F[c] = \\int_V \\left( f(c(\\mathbf{r}, t)) + \\frac{1}{2}\\kappa (\\nabla c(\\mathbf{r}, t))^2 \\right) dV$$\n    这里，$f(c)$ 是均匀系统的局部自由能密度，带有系数 $\\kappa$ 的项惩罚尖锐界面。化学势 $\\mu$ 是 $F$ 相对于 $c$ 的泛函导数：\n    $$\\mu = \\frac{\\delta F}{\\delta c} = \\frac{\\partial f}{\\partial c} - \\kappa \\nabla^2 c$$\n\n2.  **Cahn-Hilliard方程**：成分的演化由连续性方程控制，其通量与化学势的梯度成正比：\n    $$\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} = \\nabla \\cdot (M \\nabla \\mu)$$\n    其中 $M$ 是迁移率。代入 $\\mu$ 的表达式得到：\n    $$\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( M \\nabla \\left( \\frac{\\partial f}{\\partial c} - \\kappa \\nabla^2 c \\right) \\right)$$\n\n3.  **线性化**：对于旋节线分解，我们分析围绕平均成分 $c_0$ 的小成分涨落 $\\delta c(\\mathbf{r}, t) = c(\\mathbf{r}, t) - c_0$。我们将 $\\partial f / \\partial c$ 在 $c_0$ 附近进行泰勒级数展开：\n    $$\\frac{\\partial f}{\\partial c} \\approx \\left.\\frac{\\partial f}{\\partial c}\\right|_{c_0} + \\left.\\frac{\\partial^2 f}{\\partial c^2}\\right|_{c_0} (c - c_0)$$\n    在旋节线区域内，自由能曲线是向下凹的，所以 $\\partial^2 f / \\partial c^2  0$。我们定义旋节线驱动参数 $\\alpha = -(\\partial^2 f / \\partial c^2)|_{c_0}$，它是一个正数。项 $(\\partial f / \\partial c)|_{c_0}$ 是一个常数，其梯度为零。线性化的Cahn-Hilliard方程变为：\n    $$\\frac{\\partial(\\delta c)}{\\partial t} = \\nabla \\cdot \\left( M \\nabla \\left( -\\alpha \\delta c - \\kappa \\nabla^2 \\delta c \\right) \\right) = M \\nabla^2 (-\\alpha \\delta c - \\kappa \\nabla^2 \\delta c)$$\n\n4.  **傅里叶空间分析**：我们将方程变换到傅里叶空间。令 $\\delta\\hat{c}(\\mathbf{k}, t)$ 为 $\\delta c(\\mathbf{r}, t)$ 的傅里叶变换。梯度算子 $\\nabla$ 变为 $i\\mathbf{k}$，拉普拉斯算子 $\\nabla^2$ 变为 $-k^2$，其中 $k = |\\mathbf{k}|$ 是波数。偏微分方程变换为每个傅里叶模式 $\\delta\\hat{c}_k(t)$ 的常微分方程：\n    $\\frac{d}{dt}\\delta\\hat{c}_k = M(-k^2) [-\\alpha \\delta\\hat{c}_k - \\kappa(-k^2)\\delta\\hat{c}_k] = -M k^2 (-\\alpha + \\kappa k^2)\\delta\\hat{c}_k$\n    $$\\frac{d}{dt}\\delta\\hat{c}_k(t) = M k^2 (\\alpha - \\kappa k^2) \\delta\\hat{c}_k(t)$$\n    我们定义放大因子 $R(k)$：\n    $$R(k) = M k^2 (\\alpha - \\kappa k^2)$$\n    这个常微分方程的解是 $\\delta\\hat{c}_k(t) = \\delta\\hat{c}_k(0) e^{R(k)t}$。\n\n5.  **散射强度**：散射强度 $I(k,t)$ 与结构因子 $S(k,t)$ 成正比，而结构因子又与成分傅里叶模式的振幅平方的系综平均成正比：$I(k,t) \\propto S(k,t) \\propto \\langle |\\delta\\hat{c}_k(t)|^2 \\rangle$。\n    $$I(k,t) \\propto \\langle |\\delta\\hat{c}_k(0) e^{R(k)t}|^2 \\rangle = \\langle |\\delta\\hat{c}_k(0)|^2 \\rangle e^{2R(k)t} \\propto I(k,0) e^{2R(k)t}$$\n    这建立了关系 $I(k,t) = I(k,0) e^{2R(k)t}$。\n\n6.  **观测的最终模型**：可观测值为对数归一化强度 $y_{k,t}$：\n    $$y_{k,t} = \\log(I(k,t)) - \\log(I(k,0)) = \\log\\left(I(k,0) e^{2R(k)t}\\right) - \\log(I(k,0))$$\n    $$y_{k,t} = \\log(I(k,0)) + 2R(k)t - \\log(I(k,0)) = 2R(k)t$$\n    代入 $R(k)$ 的表达式，数据的最终理论模型为：\n    $$y_{\\text{theory}}(k, t; M, \\kappa) = 2 M k^2 (\\alpha - \\kappa k^2) t$$\n    该模型将可观测值 $y_{k,t}$ 与参数 $M$ 和 $\\kappa$ 以及已知量 $k, t, \\alpha$ 联系起来。\n\n**贝叶斯推断实现策略**\n\n1.  **变量替换**：$M$ 和 $\\kappa$ 的先验是对数均匀分布，这意味着 $u = \\log_{10}(M)$ 和 $v = \\log_{10}(\\kappa)$ 的先验是均匀分布。这简化了后验计算。我们将在 $(u, v)$ 空间中的均匀网格上进行推断。\n    - $u \\in [\\log_{10}(10^{-21}), \\log_{10}(10^{-17})] = [-21, -17]$\n    - $v \\in [\\log_{10}(10^{-10}), \\log_{10}(10^{-8})] = [-10, -8]$\n\n2.  **后验分布**：根据贝叶斯定理，$p(u, v | D) \\propto L(D | u, v) p(u, v)$，其中 $D$ 代表数据 $\\{y_{i,j}\\}$。由于先验 $p(u, v)$ 在指定域上是均匀的，后验分布正比于似然函数：$p(u, v | D) \\propto L(D | u, v)$。\n    因此，对数后验为 $\\log p(u, v | D) = \\log L(D | u, v) + \\text{constant}$。\n\n3.  **似然函数**：噪声是标准差为 $\\sigma$ 的高斯噪声。整个数据集 $D$ 的对数似然函数为：\n    $$\\log L(D | u, v) = -\\frac{1}{2\\sigma^2} \\sum_{i,j} \\left( y_{i,j}^{\\text{obs}} - y_{\\text{theory}}(k_i, t_j; M=10^u, \\kappa=10^v) \\right)^2$$\n    其中求和遍及所有数据点 $(k_i, t_j)$。\n\n4.  **数值评估**：\n    - 为参数 $(u, v)$ 创建一个二维网格。\n    - 使用向量化操作高效地计算网格上每个点的对数后验（即对数似然）。\n    - MAP估计 $(u_{\\text{MAP}}, v_{\\text{MAP}})$ 对应于具有最大对数后验值的网格点。然后将它们转换回 $(M_{\\mathrm{MAP}}, \\kappa_{\\mathrm{MAP}})$。\n    - 通过取指数（在减去最大值以防止数值溢出后）将对数后验网格转换为后验概率网格，然后进行归一化。\n    - 沿着一个轴对二维后验网格进行积分（求和）以获得另一个参数的一维边缘后验。例如，$p(u|D) = \\int p(u,v|D) dv$。\n    - 从每个归一化的边缘分布计算累积分布函数（CDF）。\n    - 使用线性插值找到对应于CDF分位数 $0.025$ 和 $0.975$ 的值。这些是 $95\\%$ 可信区间的下界和上界。将这些在 $(u,v)$ 空间中的界限转换回 $(M, \\kappa)$ 空间。\n\n5.  **数据生成**：对于每个测试案例，使用真实参数 ($M_{\\text{true}}, \\kappa_{\\text{true}}$) 和理论模型生成合成数据 $y_{i,j}$，并添加高斯噪声：\n    $$y_{i,j}^{\\text{obs}} = 2 M_{\\text{true}} k_i^2 (\\alpha - \\kappa_{\\text{true}} k_i^2) t_j + \\mathcal{N}(0, \\sigma^2)$$\n\n这个全面的过程构成了所提供的Python实现的基础。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Performs Bayesian inference for Cahn-Hilliard parameters from synthetic scattering data.\n    \"\"\"\n\n    # --- Problem Constants and Definitions ---\n    ALPHA = 5e5  # J/m^3\n    M_PRIOR_BOUNDS = (1e-21, 1e-17)\n    KAPPA_PRIOR_BOUNDS = (1e-10, 1e-8)\n    GRID_SIZE = 256\n    RNG_SEED = 42\n\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"m_true\": 1.0e-19, \"kappa_true\": 5.0e-9,\n            \"k_vals\": np.array([4.0e6, 7.0e6, 9.0e6]),\n            \"t_vals\": np.array([0.5, 1.0, 2.0]),\n            \"sigma\": 0.05,\n        },\n        {\n            \"name\": \"Case B\",\n            \"m_true\": 1.2e-19, \"kappa_true\": 5.0e-9,\n            \"k_vals\": np.array([9.0e6, 1.0e7, 1.1e7]),\n            \"t_vals\": np.array([0.5, 1.0, 2.0]),\n            \"sigma\": 0.05,\n        },\n        {\n            \"name\": \"Case C\",\n            \"m_true\": 5.0e-20, \"kappa_true\": 5.0e-9,\n            \"k_vals\": np.array([4.0e6, 6.0e6, 8.0e6]),\n            \"t_vals\": np.array([1.0, 2.0, 3.0]),\n            \"sigma\": 0.10,\n        },\n    ]\n\n    final_results = []\n    \n    # Use a fixed seed for reproducible data generation\n    rng = np.random.default_rng(RNG_SEED)\n\n    for case in test_cases:\n        m_true, kappa_true = case[\"m_true\"], case[\"kappa_true\"]\n        k_vals, t_vals, sigma = case[\"k_vals\"], case[\"t_vals\"], case[\"sigma\"]\n\n        # --- 1. Generate Synthetic Data ---\n        y_obs = np.zeros((len(k_vals), len(t_vals)))\n        for i, k in enumerate(k_vals):\n            for j, t in enumerate(t_vals):\n                y_theory = 2 * m_true * k**2 * (ALPHA - kappa_true * k**2) * t\n                y_obs[i, j] = y_theory + rng.normal(0, sigma)\n\n        # --- 2. Set up Parameter Grid ---\n        # Grid in log10 space for uniform priors\n        log10_m_vals = np.linspace(np.log10(M_PRIOR_BOUNDS[0]), np.log10(M_PRIOR_BOUNDS[1]), GRID_SIZE)\n        log10_k_vals = np.linspace(np.log10(KAPPA_PRIOR_BOUNDS[0]), np.log10(KAPPA_PRIOR_BOUNDS[1]), GRID_SIZE)\n\n        m_grid = 10**log10_m_vals\n        kappa_grid = 10**log10_k_vals\n\n        # --- 3. Compute Log-Posterior on the Grid ---\n        # Vectorized calculation using broadcasting\n        y_theory_grid = (2 * m_grid[:, None, None, None] * \n                         k_vals[None, None, :, None]**2 * \n                         (ALPHA - kappa_grid[None, :, None, None] * k_vals[None, None, :, None]**2) * \n                         t_vals[None, None, None, :])\n        \n        y_obs_b = y_obs[None, None, :, :]\n        \n        # Sum of squared errors for each (M, kappa) pair\n        sse = np.sum((y_theory_grid - y_obs_b)**2, axis=(2, 3))\n        \n        # Since prior is uniform in log-space, log-posterior is proportional to log-likelihood\n        log_posterior = -sse / (2 * sigma**2)\n\n        # --- 4. Find MAP Estimate ---\n        max_idx = np.unravel_index(np.argmax(log_posterior), log_posterior.shape)\n        m_map = m_grid[max_idx[0]]\n        kappa_map = kappa_grid[max_idx[1]]\n        \n        # --- 5. Compute Marginal Credible Intervals ---\n        # Stabilize exponentiation by subtracting the max\n        posterior = np.exp(log_posterior - np.max(log_posterior))\n\n        # Marginal for M (by integrating over kappa dimension in log space)\n        marginal_m = trapezoid(posterior, log10_k_vals, axis=1)\n        marginal_m /= trapezoid(marginal_m, log10_m_vals) # Normalize\n        \n        # Marginal for Kappa\n        marginal_kappa = trapezoid(posterior, log10_m_vals, axis=0)\n        marginal_kappa /= trapezoid(marginal_kappa, log10_k_vals)\n\n        # Calculate CDFs\n        cdf_m = np.cumsum((marginal_m[:-1] + marginal_m[1:]) / 2) * np.diff(log10_m_vals)\n        cdf_m = np.insert(cdf_m, 0, 0)\n        cdf_m /= cdf_m[-1]\n\n        cdf_kappa = np.cumsum((marginal_kappa[:-1] + marginal_kappa[1:]) / 2) * np.diff(log10_k_vals)\n        cdf_kappa = np.insert(cdf_kappa, 0, 0)\n        cdf_kappa /= cdf_kappa[-1]\n\n        # Interpolate to find 95% CI bounds in log10 space\n        quantiles = [0.025, 0.975]\n        log10_m_ci = np.interp(quantiles, cdf_m, log10_m_vals)\n        log10_kappa_ci = np.interp(quantiles, cdf_kappa, log10_k_vals)\n        \n        # Convert CI bounds back to M, kappa space\n        m_ci = 10**log10_m_ci\n        kappa_ci = 10**log10_kappa_ci\n        m_low, m_high = m_ci[0], m_ci[1]\n        kappa_low, kappa_high = kappa_ci[0], kappa_ci[1]\n        \n        # --- 6. Format and Store Results ---\n        results_formatted = [\n            f\"{val:.3g}\" for val in [m_map, kappa_map, m_low, m_high, kappa_low, kappa_high]\n        ]\n        final_results.extend(results_formatted)\n\n    # --- Final Output ---\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}