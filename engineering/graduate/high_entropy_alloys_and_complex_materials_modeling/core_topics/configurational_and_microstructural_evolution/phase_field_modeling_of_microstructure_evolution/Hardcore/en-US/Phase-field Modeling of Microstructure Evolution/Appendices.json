{
    "hands_on_practices": [
        {
            "introduction": "Transitioning from the physical formulation of the Cahn-Hilliard equation to a computational model often begins with nondimensionalization. This essential step simplifies the governing equation by scaling it with characteristic length and time units intrinsic to the system's physics. By doing so, we reduce the number of free parameters and ensure that variables in the simulation are of order one, which is crucial for numerical stability and for revealing the universal behavior of the system, independent of specific material constants. This exercise  will guide you through this fundamental procedure, starting from the free energy functional and ending with the clean, dimensionless form of the evolution equation.",
            "id": "2508063",
            "problem": "A binary alloy is modeled with a conserved order parameter $c(\\mathbf{x},t)$, interpreted as a dimensionless composition field. The Helmholtz free energy functional is\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\nwhere the homogeneous free-energy density is $f_{0}(c) \\;=\\; \\frac{A}{4}\\,(c^{2}-1)^{2}$ with $A0$ setting the energy scale, and $\\kappa0$ is the gradient energy coefficient. The chemical potential is defined by the variational derivative $\\mu \\,=\\, \\delta F/\\delta c$, and the dynamics follow the Cahn–Hilliard equation with constant mobility $M0$,\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right).\n$$\nUsing only these definitions as the starting point, nondimensionalize the equation by introducing the characteristic length $l_{0} \\,=\\, \\sqrt{\\kappa/A}$ and time $t_{0} \\,=\\, l_{0}^{2}/(M A)$, and the dimensionless variables $\\tilde{\\mathbf{x}} \\,=\\, \\mathbf{x}/l_{0}$ and $\\tilde{t} \\,=\\, t/t_{0}$, with the convention that $c$ itself is already dimensionless. Denote spatial derivatives with respect to $\\tilde{\\mathbf{x}}$ by $\\tilde{\\nabla}$. Derive the resulting dimensionless evolution law in the form\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}} \\;=\\; \\tilde{\\nabla}^{2}\\,\\tilde{\\mu}(c),\n$$\nand write the explicit analytic expression for the dimensionless chemical potential $\\tilde{\\mu}(c)$ as a function of $c$ and its spatial derivatives.\n\nAnswer specification:\n- Your final answer must be a single closed-form analytic expression for $\\tilde{\\mu}(c)$.\n- Do not include units.\n- No rounding is required.",
            "solution": "We begin from the given Helmholtz free energy functional\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\nwith $f_{0}(c) \\,=\\, \\frac{A}{4}\\,(c^{2}-1)^{2}$. The chemical potential is defined as the variational derivative\n$$\n\\mu \\;=\\; \\frac{\\delta F}{\\delta c} \\;=\\; \\frac{\\partial f_{0}}{\\partial c} \\;-\\; \\kappa\\,\\nabla^{2} c.\n$$\nWe first compute the homogeneous contribution. Differentiating $f_{0}(c)$ with respect to $c$, we have\n$$\n\\frac{\\partial f_{0}}{\\partial c}\n\\;=\\;\n\\frac{A}{4}\\,\\frac{\\mathrm{d}}{\\mathrm{d}c}\\left( (c^{2}-1)^{2} \\right)\n\\;=\\;\n\\frac{A}{4}\\,\\left( 2\\,(c^{2}-1)\\,\\frac{\\mathrm{d}}{\\mathrm{d}c}(c^{2}-1) \\right)\n\\;=\\;\n\\frac{A}{4}\\,\\left( 2\\,(c^{2}-1)\\,(2c) \\right)\n\\;=\\;\nA\\,c\\,(c^{2}-1)\n\\;=\\;\nA\\,(c^{3}-c).\n$$\nTherefore,\n$$\n\\mu \\;=\\; A\\,(c^{3}-c) \\;-\\; \\kappa\\,\\nabla^{2} c.\n$$\nWith constant mobility $M$, the Cahn–Hilliard dynamics are\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right) \\;=\\; M\\,\\nabla^{2}\\mu\n\\;=\\; M\\,\\nabla^{2}\\!\\left( A\\,(c^{3}-c) \\;-\\; \\kappa\\,\\nabla^{2} c \\right).\n$$\n\nWe now nondimensionalize. Introduce the characteristic scales $l_{0} \\,=\\, \\sqrt{\\kappa/A}$ and $t_{0} \\,=\\, l_{0}^{2}/(M A)$, and define the dimensionless variables\n$$\n\\tilde{\\mathbf{x}} \\,=\\, \\frac{\\mathbf{x}}{l_{0}}, \n\\qquad\n\\tilde{t} \\,=\\, \\frac{t}{t_{0}},\n\\qquad\n\\tilde{\\nabla} \\,=\\, l_{0}\\,\\nabla.\n$$\nBecause $c$ is already dimensionless, it is left unchanged. Using the chain rule, the time derivative transforms as\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\frac{1}{t_{0}}\\,\\frac{\\partial c}{\\partial \\tilde{t}},\n$$\nand the Laplacian transforms as\n$$\n\\nabla^{2} \\;=\\; \\frac{1}{l_{0}^{2}}\\,\\tilde{\\nabla}^{2}.\n$$\nSubstituting these relations into the dimensional equation gives\n$$\n\\frac{1}{t_{0}}\\,\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\nM\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\n\\tilde{\\nabla}^{2}\n\\!\\left(\nA\\,(c^{3}-c) \\;-\\; \\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\\tilde{\\nabla}^{2} c\n\\right).\n$$\nMultiplying both sides by $t_{0}$ yields\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\n\\left( \\frac{t_{0}\\,M}{l_{0}^{2}} \\right)\\,\n\\tilde{\\nabla}^{2}\n\\!\\left(\nA\\,(c^{3}-c) \\;-\\; \\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\\tilde{\\nabla}^{2} c\n\\right).\n$$\nBy the definitions $t_{0} \\,=\\, l_{0}^{2}/(M A)$ and $l_{0}^{2} \\,=\\, \\kappa/A$, we have\n$$\n\\frac{t_{0}\\,M}{l_{0}^{2}} \\,A \\;=\\; 1,\n\\qquad\n\\frac{t_{0}\\,M}{l_{0}^{2}} \\,\\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right) \\;=\\; \\frac{\\kappa}{A\\,l_{0}^{2}} \\;=\\; 1.\n$$\nTherefore,\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\n\\tilde{\\nabla}^{2}\\!\\left( (c^{3}-c) \\;-\\; \\tilde{\\nabla}^{2} c \\right).\n$$\nIn the standard compact notation,\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}} \\;=\\; \\tilde{\\nabla}^{2}\\,\\tilde{\\mu}(c),\n\\qquad\n\\text{with}\n\\qquad\n\\tilde{\\mu}(c) \\;=\\; c^{3} - c - \\tilde{\\nabla}^{2} c.\n$$\nThus, the explicit dimensionless chemical potential is the analytic expression\n$$\n\\tilde{\\mu}(c) \\;=\\; c^{3} - c - \\tilde{\\nabla}^{2} c.\n$$",
            "answer": "$$\\boxed{c^{3}-c-\\tilde{\\nabla}^{2}c}$$"
        },
        {
            "introduction": "A partial differential equation is only well-posed when supplemented with appropriate boundary conditions, which define the system's interaction with its surroundings. For the Cahn-Hilliard equation, which models a conserved quantity like composition, the choice of boundary conditions has a profound physical implication: it determines whether the total mass (or average composition) within the domain is conserved. This practice  challenges you to think critically about the link between the mathematical statement of different boundary conditions—such as Dirichlet, Neumann, and periodic—and the physical principle of mass conservation, a crucial consideration for any valid simulation.",
            "id": "2508078",
            "problem": "Let $\\Omega \\subset \\mathbb{R}^{d}$ be a bounded domain with smooth boundary $\\partial \\Omega$ and outward unit normal $\\mathbf{n}$. Let $c(\\mathbf{x},t)$ be a conserved phase-field variable (composition-like order parameter) and $\\mu(\\mathbf{x},t)$ its chemical potential in a Cahn–Hilliard description of microstructure evolution. The total mass is $M(t) = \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V$. Boundary conditions are to be imposed on $\\partial \\Omega$ for both $c$ and $\\mu$. Dirichlet conditions prescribe the value of the field on $\\partial \\Omega$; Neumann conditions prescribe the normal derivative on $\\partial \\Omega$; periodic conditions require equality of the field (and of its normal derivative) at paired boundary points of opposite faces. Using only first principles of conservation and well-posedness of conservative diffusion, identify which of the following statements correctly define boundary-condition types for $c$ and $\\mu$ and, as stated, guarantee conservation of the total mass $M(t)$ for all $t \\ge 0$. Select all that apply.\n\nA. Dirichlet for both fields: prescribe $c = c_{b}(\\mathbf{x},t)$ and $\\mu = \\mu_{b}(\\mathbf{x},t)$ on $\\partial \\Omega$. This combination conserves mass.\n\nB. Homogeneous Neumann for both fields: impose $\\mathbf{n}\\cdot \\nabla c = 0$ and $\\mathbf{n}\\cdot \\nabla \\mu = 0$ on $\\partial \\Omega$. This combination conserves mass.\n\nC. Periodic for both fields on opposite faces: at paired boundary points $\\mathbf{x}_{L}$ and $\\mathbf{x}_{R}$, require $c(\\mathbf{x}_{L},t) = c(\\mathbf{x}_{R},t)$, $\\mu(\\mathbf{x}_{L},t) = \\mu(\\mathbf{x}_{R},t)$, and matching normal derivatives $\\mathbf{n}\\cdot \\nabla c(\\mathbf{x}_{L},t) = -\\mathbf{n}\\cdot \\nabla c(\\mathbf{x}_{R},t)$, $\\mathbf{n}\\cdot \\nabla \\mu(\\mathbf{x}_{L},t) = -\\mathbf{n}\\cdot \\nabla \\mu(\\mathbf{x}_{R},t)$. This combination conserves mass.\n\nD. Homogeneous Neumann for $c$ only: impose $\\mathbf{n}\\cdot \\nabla c = 0$ on $\\partial \\Omega$ but leave $\\mu$ arbitrary on $\\partial \\Omega$. This alone conserves mass regardless of the boundary condition on $\\mu$.\n\nE. Dirichlet for $c$ and homogeneous Neumann for $\\mu$: prescribe $c = c_{b}(\\mathbf{x},t)$ on $\\partial \\Omega$ and impose $\\mathbf{n}\\cdot \\nabla \\mu = 0$ on $\\partial \\Omega$. This combination conserves mass.\n\nNote: “Homogeneous” means the prescribed boundary data is identically $0$; for periodic conditions, the pairing is taken with opposite outward normals so that fluxes are compared with appropriate sign.",
            "solution": "The validity of the proposed statements rests upon the fundamental principle of conservation for a quantity $c(\\mathbf{x},t)$ within a domain $\\Omega$. The total amount, or mass, of this quantity is given by the integral $M(t) = \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V$. For the total mass to be conserved, its time derivative must be zero for all time $t \\ge 0$.\n\nLet us derive the condition for mass conservation from first principles. Taking the time derivative of $M(t)$:\n$$ \\frac{dM}{dt} = \\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V $$\nUnder the assumption of sufficient smoothness of the field $c(\\mathbf{x},t)$, we may interchange the derivative and the integral:\n$$ \\frac{dM}{dt} = \\int_{\\Omega} \\frac{\\partial c(\\mathbf{x},t)}{\\partial t}\\,\\mathrm{d}V $$\nThe Cahn-Hilliard description is based on a continuity equation for the conserved variable $c$, which states that the local rate of change of $c$ is equal to the negative divergence of a flux $\\mathbf{J}(\\mathbf{x},t)$:\n$$ \\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} $$\nIn the Cahn-Hilliard model, this flux is driven by the gradient of the chemical potential, $\\mu(\\mathbf{x},t)$, such that $\\mathbf{J} = -L \\nabla \\mu$, where $L$ is a positive-definite mobility parameter, here taken as a positive constant for simplicity.\n\nSubstituting the continuity equation into the expression for $\\frac{dM}{dt}$:\n$$ \\frac{dM}{dt} = \\int_{\\Omega} (-\\nabla \\cdot \\mathbf{J})\\,\\mathrm{d}V $$\nBy applying the divergence theorem (Gauss's theorem), the volume integral of the divergence is converted to a surface integral of the flux over the boundary $\\partial \\Omega$:\n$$ \\frac{dM}{dt} = - \\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S $$\nwhere $\\mathbf{n}$ is the outward unit normal vector on the boundary $\\partial \\Omega$.\nTherefore, for mass to be conserved, i.e., $\\frac{dM}{dt}=0$, we must have zero net flux across the boundary:\n$$ \\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S = 0 $$\nSubstituting the constitutive relation for the flux, $\\mathbf{J}=-L\\nabla\\mu$, the condition becomes:\n$$ \\oint_{\\partial \\Omega} (-L \\nabla \\mu) \\cdot \\mathbf{n}\\,\\mathrm{d}S = -L \\oint_{\\partial \\Omega} (\\mathbf{n} \\cdot \\nabla \\mu)\\,\\mathrm{d}S = 0 $$\nSince $L > 0$, this is equivalent to requiring that the integral of the normal derivative of the chemical potential over the boundary is zero:\n$$ \\oint_{\\partial \\Omega} (\\mathbf{n} \\cdot \\nabla \\mu)\\,\\mathrm{d}S = 0 $$\nA sufficient, though not strictly necessary, condition is that the integrand itself is identically zero everywhere on the boundary, i.e., $\\mathbf{n} \\cdot \\nabla \\mu = 0$ on $\\partial \\Omega$. This is the no-flux boundary condition. The Cahn-Hilliard equation, being fourth-order in $c(\\mathbf{x},t)$, requires two boundary conditions for a well-posed problem.\n\nWe now evaluate each statement based on this derived principle.\n\nA. Dirichlet for both fields: prescribe $c = c_{b}(\\mathbf{x},t)$ and $\\mu = \\mu_{b}(\\mathbf{x},t)$ on $\\partial \\Omega$.\nThis statement is incorrect. Prescribing the value of the chemical potential $\\mu = \\mu_{b}$ on the boundary does not, in general, constrain its normal derivative $\\mathbf{n} \\cdot \\nabla \\mu$ to be zero or to have a zero integral over $\\partial \\Omega$. A non-uniform distribution of $\\mu_{b}$ on the boundary will typically induce a non-zero flux $\\mathbf{J} \\cdot \\mathbf{n} \\neq 0$. Therefore, mass is not guaranteed to be conserved. Furthermore, specifying both $c$ and $\\mu$ on the boundary over-constrains the problem, as $\\mu$ is related to $c$ and its spatial derivatives. Verdict: **Incorrect**.\n\nB. Homogeneous Neumann for both fields: impose $\\mathbf{n}\\cdot \\nabla c = 0$ and $\\mathbf{n}\\cdot \\nabla \\mu = 0$ on $\\partial \\Omega$.\nThis statement is correct. The condition $\\mathbf{n} \\cdot \\nabla \\mu = 0$ is imposed on the entire boundary $\\partial \\Omega$. This means the integrand in the total flux integral, $\\mathbf{J} \\cdot \\mathbf{n} = -L(\\mathbf{n} \\cdot \\nabla \\mu)$, is identically zero at every point on the boundary. Consequently, the integral $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$ is guaranteed to be zero, and total mass $M(t)$ is conserved. The additional condition $\\mathbf{n}\\cdot \\nabla c = 0$ makes the problem well-posed and corresponds to the natural boundary condition for an isolated system. Verdict: **Correct**.\n\nC. Periodic for both fields on opposite faces: at paired boundary points $\\mathbf{x}_{L}$ and $\\mathbf{x}_{R}$, require $c(\\mathbf{x}_{L},t) = c(\\mathbf{x}_{R},t)$, $\\mu(\\mathbf{x}_{L},t) = \\mu(\\mathbf{x}_{R},t)$, and matching normal derivatives.\nThis statement is correct. Periodic boundary conditions imply that the domain $\\Omega$ can be viewed as a unit cell in an infinite, repeating lattice. For any pair of opposite faces, say $\\Gamma_{L}$ and $\\Gamma_{R}$, the outward normal vectors are opposed, $\\mathbf{n}_{L} = -\\mathbf{n}_{R}$. The periodicity of the fields $c$ and $\\mu$ implies that their gradients, and thus the flux vector $\\mathbf{J}$, must also be periodic: $\\mathbf{J}(\\mathbf{x}_{L},t) = \\mathbf{J}(\\mathbf{x}_{R},t)$ for corresponding points $\\mathbf{x}_{L} \\in \\Gamma_{L}$ and $\\mathbf{x}_{R} \\in \\Gamma_{R}$. The total flux across this pair of faces is $\\int_{\\Gamma_{L}} \\mathbf{J} \\cdot \\mathbf{n}_{L}\\,\\mathrm{d}S + \\int_{\\Gamma_{R}} \\mathbf{J} \\cdot \\mathbf{n}_{R}\\,\\mathrm{d}S$. Using the periodicity relations, this becomes $\\int_{\\text{face}} \\mathbf{J} \\cdot (-\\mathbf{n}_{R})\\,\\mathrm{d}S + \\int_{\\text{face}} \\mathbf{J} \\cdot \\mathbf{n}_{R}\\,\\mathrm{d}S = 0$. Since the net flux is zero for every pair of opposing faces, the total flux integral over the entire boundary, $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$, is zero. Mass is conserved. The wording regarding matching normal derivatives correctly reflects the consequence of field periodicity. Verdict: **Correct**.\n\nD. Homogeneous Neumann for $c$ only: impose $\\mathbf{n}\\cdot \\nabla c = 0$ on $\\partial \\Omega$ but leave $\\mu$ arbitrary on $\\partial \\Omega$.\nThis statement is incorrect. Mass conservation is governed by the flux, which depends on $\\nabla \\mu$, not $\\nabla c$. The condition $\\mathbf{n} \\cdot \\nabla c = 0$ does not constrain the flux $\\mathbf{J} \\cdot \\mathbf{n}$. If the boundary condition on $\\mu$ is left \"arbitrary\", one can easily choose a condition (e.g., a non-constant Dirichlet condition) that leads to non-zero boundary flux and thus violates mass conservation. The statement is fundamentally flawed. Verdict: **Incorrect**.\n\nE. Dirichlet for $c$ and homogeneous Neumann for $\\mu$: prescribe $c = c_{b}(\\mathbf{x},t)$ on $\\partial \\Omega$ and impose $\\mathbf{n}\\cdot \\nabla \\mu = 0$ on $\\partial \\Omega$.\nThis statement is correct. The condition that guarantees mass conservation is the one on the flux. As in option B, the specific imposition of a homogeneous Neumann condition on the chemical potential, $\\mathbf{n}\\cdot \\nabla \\mu = 0$, ensures that the normal component of the flux $\\mathbf{J} \\cdot \\mathbf{n} = -L(\\mathbf{n}\\cdot\\nabla\\mu)$ is zero everywhere on the boundary $\\partial \\Omega$. This directly forces the total flux integral $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$ to be zero, thus guaranteeing mass conservation. The accompanying Dirichlet condition on $c$, $c=c_{b}(\\mathbf{x},t)$, simply serves as the second boundary condition required to pose the problem; it has no bearing on the mathematical guarantee of mass conservation provided by the no-flux condition on $\\mu$. Verdict: **Correct**.",
            "answer": "$$\\boxed{BCE}$$"
        },
        {
            "introduction": "The ultimate goal of theoretical modeling is often a predictive simulation. This capstone practice  brings together the preceding concepts by asking you to implement a working numerical solver for the Cahn-Hilliard equation using a powerful Fourier pseudo-spectral method. Beyond just coding the algorithm, a critical component of this task is verification: you will monitor the system's total free energy to confirm that it monotonically decreases over time. This check ensures your simulation not only runs but also correctly captures the dissipative nature of the underlying physics, a fundamental test of any phase-field code.",
            "id": "2847487",
            "problem": "Consider the Cahn–Hilliard equation for a conserved phase field $c(x,t)$ on a one–dimensional periodic domain of length $L$,\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\nwhere the free-energy functional is\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\nwith mobility $Mgt;0$ and gradient-energy coefficient $\\kappagt;0$. Assume periodic boundary conditions and nondimensional variables so that no physical units are required anywhere in the computation or the output.\n\nYour task is to start from these definitions and first principles, and, by invoking the variational derivative and the definition of the chemical potential, derive a first-order accurate in time, Fourier pseudo-spectral semi-implicit discretization in which the contribution to the chemical potential arising from the gradient-energy term is handled implicitly while the nonlinear bulk derivative $F'(c)$ is handled explicitly. Discretize space using a uniform grid with $N$ points on a periodic interval of length $L$, and use the Fast Fourier Transform to represent spatial derivatives spectrally. Evolve the phase field $c$ forward in time for a specified number of time steps $\\Delta t$ and compute the discrete free energy at each time step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\nwhere $\\Delta x = L/N$, $c_j = c(x_j)$, $x_j = j\\,\\Delta x$, and $\\partial_x c$ is to be computed spectrally by multiplying the Fourier coefficients of $c$ by $\\mathrm{i}k$ with the standard wave numbers $k$ corresponding to the chosen $L$ and $N$. You must verify, for each test case, whether the discrete free energy sequence $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$, where $N_t$ is the number of time steps, is monotonically non-increasing, that is, whether $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ for all $n$. Because of floating-point roundoff, you may allow a small non-negative tolerance determined algorithmically, but you must explain and justify your choice in your solution.\n\nImplement your derivation as an executable program that constructs the spectral operators, advances the semi-implicit scheme, computes the discrete free energy at every step, and returns a boolean indicating whether the free energy decreased monotonically over the entire run for each specified parameter set.\n\nUse the following test suite of parameter sets. For every case, let the domain length be $L=2\\pi$, and use nondimensional parameters. The initial condition in the “noise” cases is a spatially uncorrelated Gaussian perturbation with zero mean and specified amplitude, made reproducible by the indicated pseudorandom seed. The initial condition in the “uniform” case is spatially constant. For each case, report whether the free energy is monotonically non-increasing over the steps taken.\n\n- Case $1$ (happy path): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-5}$, number of steps $N_t=2000$, initial condition type “noise” with amplitude $10^{-2}$ and seed $1$.\n- Case $2$ (moderately small time step): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 10^{-4}$, number of steps $N_t=400$, initial condition type “noise” with amplitude $10^{-2}$ and seed $2$.\n- Case $3$ (boundary condition at a bulk minimum): $N=64$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 5\\times 10^{-4}$, number of steps $N_t=200$, initial condition type “uniform” with value $+1$.\n- Case $4$ (larger time step, potential to violate monotonic decay): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-3}$, number of steps $N_t=100$, initial condition type “noise” with amplitude $10^{-2}$ and seed $3$.\n\nAll variables and parameters are nondimensional; no physical units are required for any quantity. Your program must produce, in a single line, a list of four booleans corresponding to the four cases above, in the order stated. The final output format must be exactly one line containing the results as a comma-separated list enclosed in square brackets, for example, “[True,False,True,True]”.\n\nYour implementation must be self-contained, use a Fourier pseudo-spectral representation for spatial derivatives, and follow the semi-implicit time discretization you derive from the stated principles, without relying on any external data. Do not include any extraneous output. The only acceptable output is the final single-line list of booleans as specified.",
            "solution": "The Cahn-Hilliard equation describes the evolution of a conserved phase field $c(x,t)$ and is given by\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\nwhere $M$ is the mobility and $\\mu$ is the chemical potential. The chemical potential is defined as the variational derivative of the Ginzburg-Landau free-energy functional $\\mathcal{F}[c]$ with respect to the phase field $c$:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\nThe free-energy functional is given as\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\nwith a double-well bulk energy density $F(c) = \\frac{1}{4}(c^2-1)^2$ and a gradient-energy coefficient $\\kappa > 0$.\n\nFirst, we derive the explicit form of the chemical potential $\\mu$. The integrand of the functional is $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$. The variational derivative is found using the Euler-Lagrange equation:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c} = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\nSubstituting these into the expression for $\\mu$ yields:\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\nInserting this into the Cahn-Hilliard equation gives the full fourth-order nonlinear partial differential equation:\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\nFor the numerical solution, we employ a Fourier pseudo-spectral method for spatial discretization and a semi-implicit first-order scheme for time integration. The spatial domain $[0, L]$ is discretized into $N$ grid points $x_j = j \\Delta x$ with grid spacing $\\Delta x = L/N$. The phase field $c(x,t)$ is represented by its values $c_j(t)$ on this grid. In the Fourier spectral method, spatial derivatives are computed in Fourier space. A function $f(x)$ is transformed to its Fourier coefficients $\\hat{f}(k)$, where $k$ are the wavenumbers. The $n$-th derivative in Fourier space corresponds to multiplication by $(ik)^n$. Thus, $\\nabla^2$ becomes multiplication by $-k^2$ and $\\nabla^4$ becomes multiplication by $k^4$.\n\nThe problem requires a semi-implicit time-stepping scheme where the nonlinear bulk term's contribution, which comes from $F'(c) = c^3-c$, is treated explicitly, and the stiff gradient energy term, $-\\kappa\\nabla^2 c$, is treated implicitly. Using a first-order forward Euler for the explicit part and backward Euler for the implicit part, the time-discretized equation for a time step $\\Delta t$ from step $n$ to $n+1$ is:\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\nThis equation is algebraic in Fourier space, which makes it easy to solve for $\\hat{c}^{n+1}$. Let $\\hat{c}^n(k)$ be the discrete Fourier transform of $c^n(x_j)$. Transforming the equation, we get:\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\nThe term $\\widehat{((c^n)^3 - c^n)}$ is computed pseudo-spectrally: the expression $(c^n)^3 - c^n$ is evaluated in real space at each grid point, and the result is then transformed to Fourier space.\nWe rearrange the equation to solve for $\\hat{c}^{n+1}(k)$:\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\nThis yields the update rule for the Fourier coefficients at each time step:\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\nAt each time step, we start with $c^n$, compute its Fourier transform $\\hat{c}^n$, compute the nonlinear term and its transform, apply the update rule to find $\\hat{c}^{n+1}$, and then perform an inverse Fourier transform to obtain $c^{n+1}$.\n\nThe discrete free energy $\\mathcal{F}_h$ is calculated at each step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\nThe spatial derivative $\\partial_x c$ is computed spectrally by taking the Fourier transform of $c$, multiplying the coefficients $\\hat{c}(k)$ by $ik$, and then taking the inverse Fourier transform.\n\nWe must verify if the energy sequence $\\{\\mathcal{F}_h^n\\}$ is monotonically non-increasing. Numerical computation with finite-precision arithmetic introduces roundoff errors. A check for strict inequality $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ is therefore inappropriate. An energy increase is considered significant only if it exceeds a tolerance. A robust tolerance must account for both the absolute magnitude of potential roundoff errors in near-zero energies and the relative error when energy is large. We define the tolerance $\\epsilon_{tol}$ as a sum of an absolute component $\\tau_{abs}$ and a relative component $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$. The condition for a non-monotonic step is then $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n > \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$. For the double-precision floating-point numbers used, we choose conservative values $\\tau_{abs} = 10^{-12}$ and $\\tau_{rel} = 10^{-10}$. An energy sequence is deemed non-monotonic if this condition is met for any time step $n$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}