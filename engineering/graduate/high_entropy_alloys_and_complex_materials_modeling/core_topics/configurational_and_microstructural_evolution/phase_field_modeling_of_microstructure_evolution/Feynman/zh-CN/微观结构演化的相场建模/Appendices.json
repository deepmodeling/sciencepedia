{
    "hands_on_practices": [
        {
            "introduction": "在深入研究相场模型的复杂数值解之前，一个关键的初始步骤是对方程进行无量纲化。这个练习将指导你如何通过引入特征长度和时间尺度来简化Cahn-Hilliard方程，从而揭示控制微观结构演化的基本参数组合。掌握这一技能不仅能使模拟更加高效，还能让你对物理过程的内在尺度有更深刻的理解。",
            "id": "2508063",
            "problem": "一个二元合金由一个守恒的序参量 $c(\\mathbf{x},t)$ 建模，该序参量被解释为无量纲的成分场。亥姆霍兹自由能泛函为\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\n其中，均匀自由能密度为 $f_{0}(c) \\;=\\; \\frac{A}{4}\\,(c^{2}-1)^{2}$，$A>0$ 设定了能量尺度，$\\kappa>0$ 是梯度能量系数。化学势由变分导数 $\\mu \\,=\\, \\delta F/\\delta c$ 定义，其动力学遵循具有恒定迁移率 $M>0$ 的 Cahn-Hilliard 方程，\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right).\n$$\n仅以此些定义为出发点，通过引入特征长度 $l_{0} \\,=\\, \\sqrt{\\kappa/A}$ 和特征时间 $t_{0} \\,=\\, l_{0}^{2}/(M A)$，以及无量纲变量 $\\tilde{\\mathbf{x}} \\,=\\, \\mathbf{x}/l_{0}$ 和 $\\tilde{t} \\,=\\, t/t_{0}$，来对该方程进行无量纲化，并约定 $c$ 本身已是无量纲的。用 $\\tilde{\\nabla}$ 表示对 $\\tilde{\\mathbf{x}}$ 的空间导数。推导所得的无量纲演化定律，其形式为\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}} \\;=\\; \\tilde{\\nabla}^{2}\\,\\tilde{\\mu}(c),\n$$\n并写出无量纲化学势 $\\tilde{\\mu}(c)$ 作为 $c$ 及其空间导数的函数的显式解析表达式。\n\n答案规格：\n- 你的最终答案必须是 $\\tilde{\\mu}(c)$ 的单个闭式解析表达式。\n- 不要包含单位。\n- 无需四舍五入。",
            "solution": "我们从给定的亥姆霍兹自由能泛函开始\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\n其中 $f_{0}(c) \\,=\\, \\frac{A}{4}\\,(c^{2}-1)^{2}$。化学势定义为变分导数\n$$\n\\mu \\;=\\; \\frac{\\delta F}{\\delta c} \\;=\\; \\frac{\\partial f_{0}}{\\partial c} \\;-\\; \\kappa\\,\\nabla^{2} c.\n$$\n我们首先计算均匀部分的贡献。对 $f_{0}(c)$ 关于 $c$ 求导，我们有\n$$\n\\frac{\\partial f_{0}}{\\partial c}\n\\;=\\;\n\\frac{A}{4}\\,\\frac{\\mathrm{d}}{\\mathrm{d}c}\\left( (c^{2}-1)^{2} \\right)\n\\;=\\;\n\\frac{A}{4}\\,\\left( 2\\,(c^{2}-1)\\,\\frac{\\mathrm{d}}{\\mathrm{d}c}(c^{2}-1) \\right)\n\\;=\\;\n\\frac{A}{4}\\,\\left( 2\\,(c^{2}-1)\\,(2c) \\right)\n\\;=\\;\nA\\,c\\,(c^{2}-1)\n\\;=\\;\nA\\,(c^{3}-c).\n$$\n因此，\n$$\n\\mu \\;=\\; A\\,(c^{3}-c) \\;-\\; \\kappa\\,\\nabla^{2} c.\n$$\n对于恒定的迁移率 $M$，Cahn-Hilliard 动力学为\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right) \\;=\\; M\\,\\nabla^{2}\\mu\n\\;=\\; M\\,\\nabla^{2}\\!\\left( A\\,(c^{3}-c) \\;-\\; \\kappa\\,\\nabla^{2} c \\right).\n$$\n\n现在我们进行无量纲化。引入特征尺度 $l_{0} \\,=\\, \\sqrt{\\kappa/A}$ 和 $t_{0} \\,=\\, l_{0}^{2}/(M A)$，并定义无量纲变量\n$$\n\\tilde{\\mathbf{x}} \\,=\\, \\frac{\\mathbf{x}}{l_{0}}, \n\\qquad\n\\tilde{t} \\,=\\, \\frac{t}{t_{0}},\n\\qquad\n\\tilde{\\nabla} \\,=\\, l_{0}\\,\\nabla.\n$$\n由于 $c$ 已经是无量纲的，它保持不变。使用链式法则，时间导数变换为\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\frac{1}{t_{0}}\\,\\frac{\\partial c}{\\partial \\tilde{t}},\n$$\n拉普拉斯算子变换为\n$$\n\\nabla^{2} \\;=\\; \\frac{1}{l_{0}^{2}}\\,\\tilde{\\nabla}^{2}.\n$$\n将这些关系代入有量纲的方程中，得到\n$$\n\\frac{1}{t_{0}}\\,\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\nM\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\n\\tilde{\\nabla}^{2}\n\\!\\left(\nA\\,(c^{3}-c) \\;-\\; \\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\\tilde{\\nabla}^{2} c\n\\right).\n$$\n两边同乘以 $t_{0}$，得到\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\n\\left( \\frac{t_{0}\\,M}{l_{0}^{2}} \\right)\\,\n\\tilde{\\nabla}^{2}\n\\!\\left(\nA\\,(c^{3}-c) \\;-\\; \\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right)\\,\\tilde{\\nabla}^{2} c\n\\right).\n$$\n根据定义 $t_{0} \\,=\\, l_{0}^{2}/(M A)$ 和 $l_{0}^{2} \\,=\\, \\kappa/A$，我们有\n$$\n\\frac{t_{0}\\,M}{l_{0}^{2}} \\,A \\;=\\; 1,\n\\qquad\n\\frac{t_{0}\\,M}{l_{0}^{2}} \\,\\kappa\\,\\left(\\frac{1}{l_{0}^{2}}\\right) \\;=\\; \\frac{\\kappa}{A\\,l_{0}^{2}} \\;=\\; 1.\n$$\n因此，\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}}\n\\;=\\;\n\\tilde{\\nabla}^{2}\\!\\left( (c^{3}-c) \\;-\\; \\tilde{\\nabla}^{2} c \\right).\n$$\n在标准的紧凑表示法中，\n$$\n\\frac{\\partial c}{\\partial \\tilde{t}} \\;=\\; \\tilde{\\nabla}^{2}\\,\\tilde{\\mu}(c),\n\\qquad\n\\text{其中}\n\\qquad\n\\tilde{\\mu}(c) \\;=\\; c^{3} - c - \\tilde{\\nabla}^{2} c.\n$$\n因此，显式的无量纲化学势是解析表达式\n$$\n\\tilde{\\mu}(c) \\;=\\; c^{3} - c - \\tilde{\\nabla}^{2} c.\n$$",
            "answer": "$$\\boxed{c^{3}-c-\\tilde{\\nabla}^{2}c}$$"
        },
        {
            "introduction": "一个数值模型的物理真实性在很大程度上取决于边界条件的正确设置，尤其是在处理像Cahn-Hilliard方程这样的守恒系统时。本练习探讨了不同类型的边界条件（Dirichlet、Neumann和周期性）如何影响系统总质量的守恒。通过分析这些条件，你将学会如何为你的相场模拟选择合适的边界，以确保其既数学上适定又物理上合理。",
            "id": "2508078",
            "problem": "设 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个具有光滑边界 $\\partial \\Omega$ 和单位外法向量 $\\mathbf{n}$ 的有界域。设 $c(\\mathbf{x},t)$ 是一个守恒相场变量（类似成分的序参量），$\\mu(\\mathbf{x},t)$ 是其在 Cahn-Hilliard 微观结构演化描述中的化学势。总质量为 $M(t) = \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V$。需要在边界 $\\partial \\Omega$ 上对 $c$ 和 $\\mu$ 施加边界条件。Dirichlet 条件规定了场在 $\\partial \\Omega$ 上的值；Neumann 条件规定了在 $\\partial \\Omega$ 上的法向导数；周期性条件要求在相对面上的成对边界点处，场（及其法向导数）的值相等。仅使用守恒第一性原理和守恒扩散的适定性，判断下列哪些陈述正确定义了 $c$ 和 $\\mu$ 的边界条件类型，并能如其所述保证总质量 $M(t)$ 在所有 $t \\ge 0$ 时守恒。选择所有适用项。\n\nA. 两个场均为 Dirichlet 条件：在 $\\partial \\Omega$ 上规定 $c = c_{b}(\\mathbf{x},t)$ 和 $\\mu = \\mu_{b}(\\mathbf{x},t)$。这种组合能守恒质量。\n\nB. 两个场均为齐次 Neumann 条件：在 $\\partial \\Omega$ 上施加 $\\mathbf{n}\\cdot \\nabla c = 0$ 和 $\\mathbf{n}\\cdot \\nabla \\mu = 0$。这种组合能守恒质量。\n\nC. 两个场在相对面上均为周期性条件：在成对的边界点 $\\mathbf{x}_{L}$ 和 $\\mathbf{x}_{R}$ 处，要求 $c(\\mathbf{x}_{L},t) = c(\\mathbf{x}_{R},t)$，$\\mu(\\mathbf{x}_{L},t) = \\mu(\\mathbf{x}_{R},t)$，以及匹配的法向导数 $\\mathbf{n}\\cdot \\nabla c(\\mathbf{x}_{L},t) = -\\mathbf{n}\\cdot \\nabla c(\\mathbf{x}_{R},t)$，$\\mathbf{n}\\cdot \\nabla \\mu(\\mathbf{x}_{L},t) = -\\mathbf{n}\\cdot \\nabla \\mu(\\mathbf{x}_{R},t)$。这种组合能守恒质量。\n\nD. 仅对 $c$ 施加齐次 Neumann 条件：在 $\\partial \\Omega$ 上施加 $\\mathbf{n}\\cdot \\nabla c = 0$，但让 $\\mu$ 在 $\\partial \\Omega$ 上任意。仅此条件即可守恒质量，无论对 $\\mu$ 施加何种边界条件。\n\nE. 对 $c$ 施加 Dirichlet 条件，对 $\\mu$ 施加齐次 Neumann 条件：在 $\\partial \\Omega$ 上规定 $c = c_{b}(\\mathbf{x},t)$ 并施加 $\\mathbf{n}\\cdot \\nabla \\mu = 0$。这种组合能守恒质量。\n\n注：“齐次”意味着规定的边界数据恒为 $0$；对于周期性条件，配对的边界点具有相反的单位外法向量，以便在比较通量时具有适当的符号。",
            "solution": "所提陈述的有效性取决于域 $\\Omega$ 内物理量 $c(\\mathbf{x},t)$ 的基本守恒原理。该物理量的总量，或质量，由积分 $M(t) = \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V$ 给出。为了使总质量守恒，其时间导数必须在所有时间 $t \\ge 0$ 内为零。\n\n让我们从第一性原理推导质量守恒的条件。对 $M(t)$ 求时间导数：\n$$ \\frac{dM}{dt} = \\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x},t)\\,\\mathrm{d}V $$\n假设场 $c(\\mathbf{x},t)$ 足够光滑，我们可以交换求导和积分的顺序：\n$$ \\frac{dM}{dt} = \\int_{\\Omega} \\frac{\\partial c(\\mathbf{x},t)}{\\partial t}\\,\\mathrm{d}V $$\nCahn-Hilliard 描述基于守恒变量 $c$ 的连续性方程，该方程指出 $c$ 的局域变化率等于通量 $\\mathbf{J}(\\mathbf{x},t)$ 的负散度：\n$$ \\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} $$\n在 Cahn-Hilliard 模型中，该通量由化学势 $\\mu(\\mathbf{x},t)$ 的梯度驱动，即 $\\mathbf{J} = -L \\nabla \\mu$，其中 $L$ 是一个正定的迁移率参数，为简化起见，此处取为正常数。\n\n将连续性方程代入 $\\frac{dM}{dt}$ 的表达式中：\n$$ \\frac{dM}{dt} = \\int_{\\Omega} (-\\nabla \\cdot \\mathbf{J})\\,\\mathrm{d}V $$\n通过应用散度定理（Gauss 定理），散度的体积分可以转化为边界 $\\partial \\Omega$ 上通量的面积分：\n$$ \\frac{dM}{dt} = - \\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S $$\n其中 $\\mathbf{n}$ 是边界 $\\partial \\Omega$ 上的单位外法向量。\n因此，为了使质量守恒，即 $\\frac{dM}{dt}=0$，我们必须使穿过边界的净通量为零：\n$$ \\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S = 0 $$\n代入通量的本构关系 $\\mathbf{J}=-L\\nabla\\mu$，条件变为：\n$$ \\oint_{\\partial \\Omega} (-L \\nabla \\mu) \\cdot \\mathbf{n}\\,\\mathrm{d}S = -L \\oint_{\\partial \\Omega} (\\mathbf{n} \\cdot \\nabla \\mu)\\,\\mathrm{d}S = 0 $$\n由于 $L > 0$，这等价于要求化学势在边界上的法向导数的积分为零：\n$$ \\oint_{\\partial \\Omega} (\\mathbf{n} \\cdot \\nabla \\mu)\\,\\mathrm{d}S = 0 $$\n一个充分但不严格必要的条件是，被积函数本身在边界上处处为零，即在 $\\partial \\Omega$ 上有 $\\mathbf{n} \\cdot \\nabla \\mu = 0$。这就是无通量边界条件。Cahn-Hilliard 方程是关于 $c(\\mathbf{x},t)$ 的四阶方程，需要两个边界条件才能构成一个适定问题。\n\n现在我们基于这个推导出的原理来评估每个陈述。\n\nA. 两个场均为 Dirichlet 条件：在 $\\partial \\Omega$ 上规定 $c = c_{b}(\\mathbf{x},t)$ 和 $\\mu = \\mu_{b}(\\mathbf{x},t)$。\n该陈述不正确。规定化学势 $\\mu = \\mu_{b}$ 在边界上的值，通常并不能约束其法向导数 $\\mathbf{n} \\cdot \\nabla \\mu$ 为零或其在 $\\partial \\Omega$ 上的积分为零。边界上 $\\mu_{b}$ 的非均匀分布通常会引起非零通量 $\\mathbf{J} \\cdot \\mathbf{n} \\neq 0$。因此，不能保证质量守恒。此外，在边界上同时指定 $c$ 和 $\\mu$ 会使问题过约束，因为 $\\mu$ 与 $c$ 及其空间导数相关。结论：**不正确**。\n\nB. 两个场均为齐次 Neumann 条件：在 $\\partial \\Omega$ 上施加 $\\mathbf{n}\\cdot \\nabla c = 0$ 和 $\\mathbf{n}\\cdot \\nabla \\mu = 0$。\n该陈述正确。条件 $\\mathbf{n} \\cdot \\nabla \\mu = 0$ 被施加在整个边界 $\\partial \\Omega$ 上。这意味着总通量积分中的被积函数 $\\mathbf{J} \\cdot \\mathbf{n} = -L(\\mathbf{n} \\cdot \\nabla \\mu)$ 在边界上的每一点都恒为零。因此，积分 $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$ 保证为零，总质量 $M(t)$ 守恒。附加条件 $\\mathbf{n}\\cdot \\nabla c = 0$ 使问题适定，并对应于孤立系统的自然边界条件。结论：**正确**。\n\nC. 两个场在相对面上均为周期性条件：在成对的边界点 $\\mathbf{x}_{L}$ 和 $\\mathbf{x}_{R}$ 处，要求 $c(\\mathbf{x}_{L},t) = c(\\mathbf{x}_{R},t)$，$\\mu(\\mathbf{x}_{L},t) = \\mu(\\mathbf{x}_{R},t)$，以及匹配的法向导数。\n该陈述正确。周期性边界条件意味着域 $\\Omega$ 可以被看作是无限重复晶格中的一个晶胞。对于任意一对相对面，比如 $\\Gamma_{L}$ 和 $\\Gamma_{R}$，其单位外法向量相反，$\\mathbf{n}_{L} = -\\mathbf{n}_{R}$。场 $c$ 和 $\\mu$ 的周期性意味着它们的梯度，以及通量矢量 $\\mathbf{J}$，也必须是周期性的：对于对应的点 $\\mathbf{x}_{L} \\in \\Gamma_{L}$ 和 $\\mathbf{x}_{R} \\in \\Gamma_{R}$，有 $\\mathbf{J}(\\mathbf{x}_{L},t) = \\mathbf{J}(\\mathbf{x}_{R},t)$。穿过这对面的总通量为 $\\int_{\\Gamma_{L}} \\mathbf{J} \\cdot \\mathbf{n}_{L}\\,\\mathrm{d}S + \\int_{\\Gamma_{R}} \\mathbf{J} \\cdot \\mathbf{n}_{R}\\,\\mathrm{d}S$。利用周期性关系，这变为 $\\int_{\\text{face}} \\mathbf{J} \\cdot (-\\mathbf{n}_{R})\\,\\mathrm{d}S + \\int_{\\text{face}} \\mathbf{J} \\cdot \\mathbf{n}_{R}\\,\\mathrm{d}S = 0$。由于每对相对面的净通量都为零，因此整个边界上的总通量积分 $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$ 为零。质量守恒。关于匹配法向导数的措辞正确地反映了场周期性的结果。结论：**正确**。\n\nD. 仅对 $c$ 施加齐次 Neumann 条件：在 $\\partial \\Omega$ 上施加 $\\mathbf{n}\\cdot \\nabla c = 0$，但让 $\\mu$ 在 $\\partial \\Omega$ 上任意。\n该陈述不正确。质量守恒由通量决定，而通量取决于 $\\nabla \\mu$，而非 $\\nabla c$。条件 $\\mathbf{n} \\cdot \\nabla c = 0$ 并不约束通量 $\\mathbf{J} \\cdot \\mathbf{n}$。如果对 $\\mu$ 的边界条件是“任意的”，那么很容易选择一个条件（例如，一个非恒定的 Dirichlet 条件）导致非零边界通量，从而违反质量守恒。该陈述从根本上是错误的。结论：**不正确**。\n\nE. 对 $c$ 施加 Dirichlet 条件，对 $\\mu$ 施加齐次 Neumann 条件：在 $\\partial \\Omega$ 上规定 $c = c_{b}(\\mathbf{x},t)$ 并施加 $\\mathbf{n}\\cdot \\nabla \\mu = 0$。\n该陈述正确。保证质量守恒的条件是关于通量的条件。与选项 B 一样，对化学势特别施加齐次 Neumann 条件 $\\mathbf{n}\\cdot \\nabla \\mu = 0$，确保了通量的法向分量 $\\mathbf{J} \\cdot \\mathbf{n} = -L(\\mathbf{n}\\cdot\\nabla\\mu)$ 在边界 $\\partial \\Omega$ 上处处为零。这直接使得总通量积分 $\\oint_{\\partial \\Omega} \\mathbf{J} \\cdot \\mathbf{n}\\,\\mathrm{d}S$ 为零，从而保证了质量守恒。附带的对 $c$ 的 Dirichlet 条件 $c=c_{b}(\\mathbf{x},t)$ 仅作为提出问题所需的第二个边界条件；它对由 $\\mu$ 上的无通量条件所提供的质量守恒的数学保证没有影响。结论：**正确**。",
            "answer": "$$\\boxed{BCE}$$"
        },
        {
            "introduction": "理论知识的最终检验在于实践应用。这个压轴练习将引导你从零开始，使用傅里叶谱方法编写一个Cahn-Hilliard方程的求解器，模拟相分离过程。你不仅需要实现一个半隐式时间推进格式，还需计算并验证系统的自由能随时间单调递减这一基本物理原理，从而将理论与计算紧密结合。",
            "id": "2847487",
            "problem": "考虑在一个长度为 $L$ 的一维周期性区域上，用于守恒相场 $c(x,t)$ 的 Cahn–Hilliard 方程，\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\n其中自由能泛函为\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\n其中迁移率 $M>0$ 且梯度能量系数 $\\kappa>0$。假设采用周期性边界条件和无量纲变量，因此在计算或输出的任何部分都不需要物理单位。\n\n您的任务是从这些定义和第一性原理出发，通过调用变分导数和化学势的定义，推导出一个时间上一阶精确的傅里叶伪谱半隐式离散化方法。在该方法中，由梯度能量项引起的化学势贡献被隐式处理，而非线性体导数 $F'(c)$ 则被显式处理。在长度为 $L$ 的周期性区间上，使用包含 $N$ 个点的均匀网格对空间进行离散化，并使用快速傅里叶变换以谱方法表示空间导数。将相场 $c$ 向前演化指定数量的时间步长 $\\Delta t$，并使用网格上的梯形法则计算每个时间步的离散自由能：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\n其中 $\\Delta x = L/N$，$c_j = c(x_j)$，$x_j = j\\,\\Delta x$，而 $\\partial_x c$ 将通过将 $c$ 的傅里叶系数与 $\\mathrm{i}k$ 相乘来以谱方法计算，其中 $k$ 是对应于所选 $L$ 和 $N$ 的标准波数。对于每个测试用例，您必须验证离散自由能序列 $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$（其中 $N_t$ 是时间步数）是否单调非增，即对于所有 $n$ 是否有 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$。由于浮点舍入误差，您可以允许一个通过算法确定的小的非负容差，但您必须在您的解答中解释并证明您的选择。\n\n将您的推导实现为一个可执行程序，该程序构建谱算子，推进半隐式格式，计算每一步的离散自由能，并为每个指定的参数集返回一个布尔值，指示在整个运行过程中自由能是否单调递减。\n\n使用以下参数集测试套件。对于每个用例，设区域长度为 $L=2\\pi$，并使用无量纲参数。“noise”（噪声）用例中的初始条件是具有零均值和指定振幅的空间不相关高斯微扰，通过指定的伪随机种子使其可复现。“uniform”（均匀）用例中的初始条件是空间常数。对于每个用例，报告在所采取的步骤中自由能是否单调非增。\n\n- 用例 1（正常路径）：$N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-5}$, 步数 $N_t=2000$, 初始条件类型“noise”，振幅 $10^{-2}$，种子 $1$。\n- 用例 2（适度小时间步长）：$N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 10^{-4}$, 步数 $N_t=400$, 初始条件类型“noise”，振幅 $10^{-2}$，种子 $2$。\n- 用例 3（体相极小值处的边界条件）：$N=64$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 5\\times 10^{-4}$, 步数 $N_t=200$, 初始条件类型“uniform”，值 $+1$。\n- 用例 4（较大时间步长，可能违反单调衰减）：$N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-3}$, 步数 $N_t=100$, 初始条件类型“noise”，振幅 $10^{-2}$，种子 $3$。\n\n所有变量和参数都是无量纲的；任何量都不需要物理单位。您的程序必须在单行中生成一个包含四个布尔值的列表，按上述顺序对应四个用例。最终输出格式必须是仅包含一行结果的方括号内逗号分隔列表，例如，“[True,False,True,True]”。\n\n您的实现必须是自包含的，使用傅里叶伪谱表示法来处理空间导数，并遵循您从所述原理推导出的半隐式时间离散化方法，不依赖任何外部数据。不要包含任何无关的输出。唯一可接受的输出是指定的单行布尔值列表。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提出了一个计算材料物理学中的标准数值任务，并提供了所有必要的信息。我们继续进行推导和求解。\n\nCahn-Hilliard 方程描述了守恒相场 $c(x,t)$ 的演化，其形式如下\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\n其中 $M$ 是迁移率，$\\mu$ 是化学势。化学势定义为 Ginzburg-Landau 自由能泛函 $\\mathcal{F}[c]$ 相对于相场 $c$ 的变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\n自由能泛函由下式给出\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\n其中包含一个双阱体能量密度 $F(c) = \\frac{1}{4}(c^2-1)^2$ 和一个梯度能量系数 $\\kappa > 0$。\n\n首先，我们推导化学势 $\\mu$ 的显式形式。泛函的被积函数为 $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$。变分导数通过 Euler-Lagrange 方程求得：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c} = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\n将这些代入 $\\mu$ 的表达式中，得到：\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\n将此代入 Cahn-Hilliard 方程，得到完整的四阶非线性偏微分方程：\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\n对于数值解，我们采用傅里叶伪谱方法进行空间离散，并采用半隐式一阶格式进行时间积分。空间域 $[0, L]$ 被离散化为 $N$ 个网格点 $x_j = j \\Delta x$，网格间距为 $\\Delta x = L/N$。相场 $c(x,t)$ 由其在网格上的值 $c_j(t)$ 表示。在傅里叶谱方法中，空间导数在傅里叶空间中计算。函数 $f(x)$ 变换为其傅里叶系数 $\\hat{f}(k)$，其中 $k$ 是波数。傅里叶空间中的 $n$ 阶导数对应于乘以 $(ik)^n$。因此，$\\nabla^2$ 变为乘以 $-k^2$，$\\nabla^4$ 变为乘以 $k^4$。\n\n问题要求一个半隐式时间步进格式，其中来自 $F'(c) = c^3-c$ 的非线性体项的贡献被显式处理，而刚性的梯度能量项 $-\\kappa\\nabla^2 c$ 被隐式处理。对显式部分使用一阶前向欧拉法，对隐式部分使用后向欧拉法，从时间步 $n$ 到 $n+1$，步长为 $\\Delta t$ 的时间离散方程为：\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\n这个方程在傅里叶空间中是代数的，这使得求解 $\\hat{c}^{n+1}$ 变得容易。设 $\\hat{c}^n(k)$ 是 $c^n(x_j)$ 的离散傅里叶变换。对该方程进行变换，我们得到：\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\n项 $\\widehat{((c^n)^3 - c^n)}$ 是通过伪谱方法计算的：表达式 $(c^n)^3 - c^n$ 在每个网格点的实空间中被求值，然后将结果变换到傅里叶空间。\n我们重排方程以求解 $\\hat{c}^{n+1}(k)$：\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\n这就得出了每个时间步傅里叶系数的更新规则：\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\n在每个时间步，我们从 $c^n$ 开始，计算其傅里叶变换 $\\hat{c}^n$，计算非线性项及其变换，应用更新规则找到 $\\hat{c}^{n+1}$，然后执行逆傅里叶变换以获得 $c^{n+1}$。\n\n离散自由能 $\\mathcal{F}_h$ 在每一步都使用网格上的梯形法则计算：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\n空间导数 $\\partial_x c$ 通过对 $c$ 进行傅里叶变换，将其系数 $\\hat{c}(k)$ 乘以 $ik$，然后进行逆傅里叶变换来以谱方法计算。\n\n我们必须验证能量序列 $\\{\\mathcal{F}_h^n\\}$ 是否单调非增。使用有限精度算术的数值计算会引入舍入误差。因此，检查严格不等式 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ 是不合适的。只有当能量增加超过一个容差时，才被认为是显著的。一个稳健的容差必须同时考虑接近零能量时潜在舍入误差的绝对量级和能量较大时的相对误差。我们将容差 $\\epsilon_{tol}$ 定义为一个绝对分量 $\\tau_{abs}$ 和一个相对分量 $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$ 的和。非单调步骤的条件则是 $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n > \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$。对于所使用的双精度浮点数，我们选择保守值 $\\tau_{abs} = 10^{-12}$ 和 $\\tau_{rel} = 10^{-10}$。如果任何时间步 $n$ 满足此条件，则认为能量序列是非单调的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}