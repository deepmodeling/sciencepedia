{
    "hands_on_practices": [
        {
            "introduction": "现实世界中的合金很少能达到完美的化学计量比。本练习探讨了“结构性反位”这一基本机制，它使得长程有序（LRO）能够在非化学计量组分中持续存在，尽管有序度会有所降低。掌握这一概念对于理解和设计实际应用的有序合金至关重要 。",
            "id": "3749843",
            "problem": "考虑一种高熵合金 (HEA)，其在 B2 型体心立方亚晶格结构上表现出两种组元（记为 $A$ 和 $B$）的二元亚晶格有序化。该结构具有两个尺寸相等的互穿亚晶格 $\\alpha$ 和 $\\beta$。HEA 中存在的其他化学组元（统称为 $R$）相对于此有序化是化学中性的，并随机且均等地分布在两个亚晶格上。设中性组元集的总摩尔分数为 $x_{R}$，其中 $0 \\leq x_R  1$。$A$ 和 $B$ 的摩尔分数分别为 $x_{A}$ 和 $x_{B}$，满足 $x_{A} + x_{B} + x_{R} = 1$。\n\n定义 $A$-$B$ 有序化的长程有序 (LRO) 参数为\n$$\n\\eta \\equiv \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}},\n$$\n其中 $p_{A}^{\\alpha}$ 和 $p_{A}^{\\beta}$ 分别是在随机选择的 $\\alpha$ 或 $\\beta$ 格点上找到一个 $A$ 原子的概率，分母通过可用于有序原子对 $(A,B)$ 的格点分数进行归一化。\n\n假设在低温区，热致反位缺陷可以忽略不计，非化学计量仅通过结构反位来调节。考虑在固定 $x_{R}$ 的情况下，与 $A$-$B$ 化学计量的偏差由下式给出：\n$$\nx_{A} = \\frac{1 - x_{R}}{2} + \\delta, \\quad x_{B} = \\frac{1 - x_{R}}{2} - \\delta,\n$$\n其中 $\\delta$ 表示在 $(A,B)$ 子集内与等原子比 $A$-$B$ 成分的偏差，并满足 $|\\delta| \\leq \\frac{1 - x_{R}}{2}$，以使概率保持在 $[0,1]$ 的物理范围内。中性组元集 $R$ 保持随机分布，即 $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$。\n\n从亚晶格占据概率的定义、质量平衡约束以及结构反位的物理机制出发，推导长程有序在非化学计量下如何持续存在，并计算由此导致的 $\\eta$ 值随偏差 $\\delta$ 的减小。将 $\\eta(\\delta)$ 的最终答案表示为关于 $\\delta$ 和 $x_{R}$ 的封闭形式表达式。无需进行数值计算或四舍五入。答案无需单位。",
            "solution": "对用户提供的问题进行验证。\n\n### 第 1 步：提取已知条件\n- **系统**：一种具有 B2 型体心立方 (BCC) 亚晶格结构的高熵合金 (HEA)。\n- **亚晶格**：两个尺寸相等的互穿亚晶格 $\\alpha$ 和 $\\beta$。\n- **组元**：三种类型的组元：$A$、$B$ 和一个统称的中性组元集 $R$。\n- **摩尔分数**：$x_{A}$、$x_{B}$、$x_{R}$，满足 $x_{A} + x_{B} + x_{R} = 1$ 且 $0 \\leq x_R  1$。\n- **R 的分布**：中性组元集 $R$ 随机且均等地分布在两个亚晶格上，使得 $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$，其中 $p_{S}^{\\sigma}$ 是在亚晶格 $\\sigma$ 的一个格点上找到组元 $S$ 的概率。\n- **长程有序 (LRO) 参数定义**：$\\eta \\equiv \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}}$。\n- **成分偏差**：$A$ 和 $B$ 的摩尔分数用偏差参数 $\\delta$ 定义：\n  $$x_{A} = \\frac{1 - x_{R}}{2} + \\delta$$\n  $$x_{B} = \\frac{1 - x_{R}}{2} - \\delta$$\n  约束条件为 $|\\delta| \\leq \\frac{1 - x_{R}}{2}$。\n- **物理假设**：系统处于低温区，热致反位缺陷可以忽略不计。非化学计量完全通过结构反位来调节。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于物理冶金学和合金统计力学的原理。B2 结构、亚晶格有序化、结构缺陷和长程有序都是标准的、公认的概念。将这些概念应用于高熵合金是当前材料科学研究中一个有效的研究领域。\n2.  **问题定义明确**：该问题定义明确。它为 LRO 参数提供了清晰的定义，指明了所有必要的摩尔分数及其关系，并陈述了控制原子排列的物理机制（结构反位）。其目标——推导 $\\eta$ 关于 $\\delta$ 和 $x_{R}$ 的表达式——是明确的，并且可以根据所提供的信息实现。\n3.  **客观性**：该问题以精确、客观和形式化的科学语言陈述，不含任何主观或基于意见的主张。\n4.  **完整性与一致性**：定义和约束是自洽且一致的。摩尔分数之和为 1 ($x_A+x_B+x_R = (\\frac{1 - x_{R}}{2} + \\delta) + (\\frac{1 - x_{R}}{2} - \\delta) + x_R = 1 - x_R + x_R = 1$) 。对 $\\delta$ 的约束确保了摩尔分数 $x_A$ 和 $x_B$ 保持非负。\n5.  **无其他缺陷**：该问题不违反任何其他验证标准。这是一个可形式化且非平凡的问题，需要基于物理原理进行演绎推理。\n\n### 第 3 步：结论与操作\n该问题有效。将构建严谨的解答。\n\n### 解题推导\n\n分析始于建立基本的质量平衡和格点占据约束。B2 结构由两个尺寸相等的亚晶格 $\\alpha$ 和 $\\beta$ 组成。因此，每个亚晶格的格点分数为 $f^{\\alpha} = f^{\\beta} = \\frac{1}{2}$。\n\n任何组元 $S$ 的总摩尔分数 $x_S$ 是其在各亚晶格上占据概率的加权平均值：\n$$x_{S} = f^{\\alpha} p_{S}^{\\alpha} + f^{\\beta} p_{S}^{\\beta} = \\frac{1}{2} (p_{S}^{\\alpha} + p_{S}^{\\beta})$$\n此外，对于任何亚晶格上的任何给定格点，占据概率之和必须为 1：\n$$p_{A}^{\\sigma} + p_{B}^{\\sigma} + p_{R}^{\\sigma} = 1 \\quad \\text{for } \\sigma \\in \\{\\alpha, \\beta\\}$$\n问题陈述中性原子 $R$ 是随机分布的，即 $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$。这意味着每个亚晶格上可供有序组元 $A$ 和 $B$ 使用的格点分数为 $1 - x_{R}$。\n$$p_{A}^{\\alpha} + p_{B}^{\\alpha} = 1 - p_{R}^{\\alpha} = 1 - x_{R}$$\n$$p_{A}^{\\beta} + p_{B}^{\\beta} = 1 - p_{R}^{\\beta} = 1 - x_{R}$$\n\n核心物理假设是，在低温下，有序化程度达到最大，非化学计量由结构反位来调节。这意味着（在 $A$-$B$ 原子对中）主要组元占据其“优先”亚晶格上所有未被中性组元 $R$ 占据的格点，而主要组元的过量原子则占据“另一”亚晶格上的格点。\n\n按照惯例，设 $\\alpha$ 亚晶格为组元 $A$ 的优先亚晶格，$\\beta$ 亚晶格为组元 $B$ 的优先亚晶格。我们必须根据 $\\delta$ 的符号考虑两种情况。\n\n**情况 1：$\\delta \\ge 0$（A 组分过量）**\n在这种情况下，$x_{A} \\ge x_{B}$。组元 $A$ 是 $(A,B)$ 子集中的主要组元。根据结构反位机制，组元 $A$ 将填充其优先亚晶格 $\\alpha$ 上所有可用的格点。可供 $(A,B)$ 原子对使用的 $\\alpha$-格点数为 $1 - x_R$。因此，$A$ 在 $\\alpha$ 上的占据率达到最大值：\n$$p_{A}^{\\alpha} = 1 - x_{R}$$\n由于可用的 $\\alpha$-格点完全被 $A$ 填充，次要组元 $B$ 在 $\\alpha$ 亚晶格上的占据率必须为零：\n$$p_{B}^{\\alpha} = 0$$\n接下来，我们确定 $\\beta$ 亚晶格上的占据情况。使用组元 $A$ 的质量平衡方程：\n$$x_{A} = \\frac{1}{2} (p_{A}^{\\alpha} + p_{A}^{\\beta})$$\n代入 $x_A$ 和 $p_A^\\alpha$ 的表达式：\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1}{2} ((1 - x_{R}) + p_{A}^{\\beta})$$\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1 - x_{R}}{2} + \\frac{1}{2} p_{A}^{\\beta}$$\n这可以简化为 $\\delta = \\frac{1}{2} p_{A}^{\\beta}$，从而得出在 $\\beta$ 亚晶格上找到一个结构反位 $A$ 原子的概率：\n$$p_{A}^{\\beta} = 2\\delta$$\n$B$ 在 $\\beta$ 亚晶格上的占据率 $p_{B}^{\\beta}$ 可以通过 $\\beta$ 上的格点求和规则找到：\n$$p_{A}^{\\beta} + p_{B}^{\\beta} + p_{R}^{\\beta} = 1$$\n$$2\\delta + p_{B}^{\\beta} + x_{R} = 1$$\n$$p_{B}^{\\beta} = 1 - x_{R} - 2\\delta$$\n这个结果与 $B$ 的质量平衡是一致的：$x_B = \\frac{1}{2}(p_B^\\alpha+p_B^\\beta) = \\frac{1}{2}(0 + 1-x_R-2\\delta) = \\frac{1-x_R}{2} - \\delta$。\n\n利用这些概率，当 $\\delta \\ge 0$ 时，LRO 参数 $\\eta$ 为：\n$$\\eta = \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}} = \\frac{(1 - x_{R}) - (2\\delta)}{1 - x_{R}} = 1 - \\frac{2\\delta}{1 - x_{R}}$$\n\n**情况 2：$\\delta   0$（B 组分过量）**\n在这种情况下，$x_{B}  x_{A}$。组元 $B$ 是 $(A,B)$ 子集中的主要组元。它将填充其优先亚晶格 $\\beta$ 上所有可用的格点。\n$$p_{B}^{\\beta} = 1 - x_{R}$$\n这意味着次要组元 $A$ 在 $\\beta$ 亚晶格上的占据率必须为零：\n$$p_{A}^{\\beta} = 0$$\n现在，我们使用组元 $A$ 的质量平衡来求解 $p_A^\\alpha$：\n$$x_{A} = \\frac{1}{2} (p_{A}^{\\alpha} + p_{A}^{\\beta})$$\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1}{2} (p_{A}^{\\alpha} + 0)$$\n$$p_{A}^{\\alpha} = 2 \\left(\\frac{1 - x_{R}}{2} + \\delta\\right) = 1 - x_{R} + 2\\delta$$\n$B$ 在 $\\alpha$ 亚晶格上的占据率 $p_{B}^{\\alpha}$ 由结构反位构成。根据 $\\alpha$ 上的格点求和规则：\n$$p_{A}^{\\alpha} + p_{B}^{\\alpha} + p_{R}^{\\alpha} = 1$$\n$$(1 - x_{R} + 2\\delta) + p_{B}^{\\alpha} + x_{R} = 1$$\n$$p_{B}^{\\alpha} = -2\\delta$$\n由于 $\\delta  0$， $p_{B}^{\\alpha}$ 为正值，这在物理上是正确的。这个结果也与 $B$ 的质量平衡是一致的：$x_B = \\frac{1}{2}(p_B^\\alpha+p_B^\\beta) = \\frac{1}{2}(-2\\delta + 1-x_R) = \\frac{1-x_R}{2} - \\delta$。\n\n当 $\\delta  0$ 时，LRO 参数 $\\eta$ 为：\n$$\\eta = \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}} = \\frac{(1 - x_{R} + 2\\delta) - 0}{1 - x_{R}} = 1 + \\frac{2\\delta}{1 - x_{R}}$$\n\n**通用表达式**\n这两种情况可以使用绝对值函数 $|\\delta|$ 统一成一个表达式。\n对于 $\\delta \\ge 0$，我们有 $|\\delta| = \\delta$，所以 $\\eta = 1 - \\frac{2|\\delta|}{1 - x_{R}}$。\n对于 $\\delta  0$，我们有 $|\\delta| = -\\delta$，所以 $\\eta = 1 + \\frac{2\\delta}{1 - x_{R}} = 1 - \\frac{2(-\\delta)}{1-x_R} = 1 - \\frac{2|\\delta|}{1 - x_{R}}$。\n两种情况都由同一个公式描述。LRO 的降低与化学计量偏差的大小 $|\\delta|$ 成正比，与有序格点分数 $1-x_R$ 成反比。在化学计量比时（$\\delta=0$），$\\eta=1$，表示 $(A,B)$ 子集内完全有序。在最大非化学计量时（$|\\delta| = \\frac{1-x_R}{2}$），$\\eta=0$，因为其中一种组元消失，有序的概念变得没有意义。\n\nLRO 参数作为 $\\delta$ 和 $x_R$ 的函数的最终表达式为：\n$$\\eta(\\delta, x_{R}) = 1 - \\frac{2|\\delta|}{1 - x_{R}}$$",
            "answer": "$$ \\boxed{1 - \\frac{2|\\delta|}{1 - x_{R}}} $$"
        },
        {
            "introduction": "本练习旨在连接原子占位偏好这一抽象概念与其在实验中的具体表现。通过本练习，您将学习如何计算超晶格衍射峰的晶体学结构因子，其强度与长程有序度直接相关 。这项技能是解读有序材料衍射图谱的关键。",
            "id": "3749850",
            "problem": "考虑一种具有B2（氯化铯型）有序结构的五元高熵合金（HEA），它由两个互穿的简单立方子晶格组成：位于分数坐标 $(0,0,0)$ 的 $\\alpha$ 子晶格和位于分数坐标 $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$ 的 $\\beta$ 子晶格。该合金包含五种标记为 $A$、$B$、$C$、$D$ 和 $E$ 的化学组元，且总体上为等原子比。合金中的长程有序（LRO）由一个标量有序参数 $\\eta$ 来表征，该参数在保持整体成分不变的同时，使两个子晶格之间的格点占有率产生偏向。子晶格的格点占有概率被指定为 $\\eta$ 的函数，如下所示：\n$$\np_{A}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\n$$\n和\n$$\np_{A}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\n$$\n这确保了对于所有的 $\\eta$ 值，$\\sum_{X}p_{X}^{\\alpha}=1$ 和 $\\sum_{X}p_{X}^{\\beta}=1$ 都成立，其中 $X\\in\\{A,B,C,D,E\\}$。假设存在依赖于组元的原子散射因子 $f_{A},f_{B},f_{C},f_{D},f_{E}$，它们与子晶格无关，并且对于与(100)反射相关的散射矢量大小是恒定的。使用晶体结构因子的第一性原理定义，推导(100)型结构因子振幅关于 $f_{A},f_{B},f_{C},f_{D},f_{E}$ 和 $\\eta$ 的解析表达式。将最终答案表示为单一的简化闭式表达式。不需要进行数值计算或四舍五入。",
            "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。推导所要求的量所需的所有必要参数和定义均已提供。该物理模型通过依赖于有序参数的格点占有概率来描述多组分合金中的长程有序，这是计算材料科学和固态物理学中的一种标准且有效的方法。因此，该问题被认为是有效的，并且可以构建一个严谨的解。\n\n对应于密勒指数 $(hkl)$ 的散射矢量 $\\mathbf{G}$ 的晶体结构因子，记为 $F_{\\mathbf{G}}$ 或 $F_{hkl}$，定义为单个晶胞内所有原子散射波的总和。对于一个基元中有 $N$ 个原子，其位置为 $\\mathbf{r}_j$，原子散射因子为 $f_j$ 的晶体，结构因子由下式给出：\n$$\nF_{hkl} = \\sum_{j=1}^{N} f_j \\exp(2\\pi i (h x_j + k y_j + l z_j))\n$$\n其中 $(x_j, y_j, z_j)$ 是原子 $j$ 的分数坐标。\n\n在部分有序合金的情况下，特定格点 $j$ 的散射因子 $f_j$ 被替换为可能占据该格点的元素的散射因子的统计平均值。这个平均散射因子 $\\bar{f}_j$ 是通过将每个组元 $X$ 的散射因子按其各自的格点占有概率 $p_{X}^{j}$ 加权求和来计算的：\n$$\n\\bar{f}_j = \\sum_{X} p_{X}^{j} f_{X}\n$$\n\n问题描述的是一种B2有序五元合金，其每个晶胞的基元由两个原子组成。这些原子位于两个不同的子晶格 $\\alpha$ 和 $\\beta$ 上。这些格点的分数坐标如下：\n- $\\alpha$ 子晶格: $\\mathbf{r}_{\\alpha} = (0, 0, 0)$\n- $\\beta$ 子晶格: $\\mathbf{r}_{\\beta} = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n\n因此，结构因子可以写成每个子晶格的平均散射因子 $\\bar{f}_{\\alpha}$ 和 $\\bar{f}_{\\beta}$ 的形式：\n$$\nF_{hkl} = \\bar{f}_{\\alpha} \\exp[2\\pi i (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)] + \\bar{f}_{\\beta} \\exp[2\\pi i (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})]\n$$\n这可以简化为：\n$$\nF_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta} \\exp[\\pi i (h+k+l)]\n$$\n如果密勒指数之和 $(h+k+l)$ 是偶数，则指数项的值为 $+1$；如果和是奇数，则值为 $-1$。\n- 对于 $(h+k+l) = \\text{偶数}$: $F_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta}$ (基本反射)\n- 对于 $(h+k+l) = \\text{奇数}$: $F_{hkl} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$ (超晶格反射)\n\n问题要求计算(100)反射的结构因子。在这种情况下，$(h, k, l) = (1, 0, 0)$，其和 $h+k+l = 1$ 是奇数。这对应于超晶格反射，是B2有序结构的一个标志。因此，结构因子为：\n$$\nF_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}\n$$\n\n现在我们必须使用所提供的、对于子晶格 $\\gamma \\in \\{\\alpha, \\beta\\}$ 上的组元 $X \\in \\{A, B, C, D, E\\}$ 的格点占有概率 $p_{X}^{\\gamma}$，来计算平均散射因子 $\\bar{f}_{\\alpha}$ 和 $\\bar{f}_{\\beta}$。\n\n$\\alpha$ 子晶格的平均散射因子是：\n$$\n\\bar{f}_{\\alpha} = \\sum_{X} p_{X}^{\\alpha} f_{X} = p_{A}^{\\alpha}f_{A} + p_{B}^{\\alpha}f_{B} + p_{C}^{\\alpha}f_{C} + p_{D}^{\\alpha}f_{D} + p_{E}^{\\alpha}f_{E}\n$$\n代入给定的 $p_{X}^{\\alpha}$ 表达式：\n$$\n\\bar{f}_{\\alpha} = \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{E}\n$$\n我们可以根据项对有序参数 $\\eta$ 的依赖性进行分组：\n$$\n\\bar{f}_{\\alpha} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) + \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\n类似地，$\\beta$ 子晶格的平均散射因子是：\n$$\n\\bar{f}_{\\beta} = \\sum_{X} p_{X}^{\\beta} f_{X} = p_{A}^{\\beta}f_{A} + p_{B}^{\\beta}f_{B} + p_{C}^{\\beta}f_{C} + p_{D}^{\\beta}f_{D} + p_{E}^{\\beta}f_{E}\n$$\n代入给定的 $p_{X}^{\\beta}$ 表达式：\n$$\n\\bar{f}_{\\beta} = \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{E}\n$$\n分组各项：\n$$\n\\bar{f}_{\\beta} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) - \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\n现在，我们计算差值 $F_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$：\n$$\nF_{100} = \\left[\\frac{1}{5}\\sum_{X}f_{X} + \\eta\\left(\\dots\\right)\\right] - \\left[\\frac{1}{5}\\sum_{X}f_{X} - \\eta\\left(\\dots\\right)\\right]\n$$\n与 $\\eta$ 无关的项相消，剩下：\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n为了将此表达式简化为单一分数，我们找到公分母，即15。注意 $\\frac{1}{5} = \\frac{3}{15}$。\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{3}{15}f_{D} - \\frac{3}{15}f_{E}\\right)\n$$\n提取公因式 $\\frac{1}{15}$：\n$$\nF_{100} = \\frac{2\\eta}{15}(2f_{A}+2f_{B}+2f_{C} - 3f_{D} - 3f_{E})\n$$\n通过对散射因子进行分组，该表达式可以写得更紧凑：\n$$\nF_{100} = \\frac{2\\eta}{15}\\left[2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right]\n$$\n这就是(100)结构因子振幅的最终简化闭式表达式。“振幅”一词指的是结构因子本身的值，在本例中它是一个实数。其大小决定了衍射峰的强度。该表达式正确地表明，对于完全无序的合金（$\\eta=0$），超晶格反射强度为零，并随着长程有序度的增加而增长。",
            "answer": "$$\n\\boxed{\\frac{2\\eta}{15}\\left(2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right)}\n$$"
        },
        {
            "introduction": "本练习将带您进入现代计算材料科学的前沿领域，在该领域中，理论模型需要与实验数据进行直接验证。您将学习构建一个贝叶斯推断框架，从充满噪声的衍射强度测量中推断出临界温度和其他长程有序参数 。此练习展示了如何量化不确定性，并从实验结果中提取最深刻的物理洞见。",
            "id": "3749823",
            "problem": "考虑一种由连续有序-无序相变驱动的具有长程有序（LRO）的高熵合金（HEA）。令强度标量有序参量表示为 $\\eta(T)$，其定义为亚晶格占有率之差，并假设其在相变点附近的平衡行为可以用以下形式的 Landau 自由能 $F(\\eta,T)$ 来描述\n$$\nF(\\eta,T) = a\\,(T - T_c)\\,\\eta^2 + b\\,\\eta^4,\n$$\n其中 $a>0$，$b>0$，$T_c$ 是以开尔文表示的临界温度。对于 $T  T_c$，最小化 $F$ 得到的平衡有序参量的温度依赖性为 $\\eta(T) \\propto \\sqrt{T_c - T}$。实验上，超晶格衍射峰的强度与 $\\eta^2$ 成正比。因此，预测的强度 $I_{\\text{pred}}$ 可以建模为\n$$\nI_{\\text{pred}}(T; T_c, \\eta_0) =\n\\begin{cases}\n\\eta_0^2\\left(1 - \\frac{T}{T_c}\\right)  \\text{if } T  T_c \\\\\n0  \\text{if } T \\ge T_c\n\\end{cases}\n$$\n其中 $\\eta_0$ 是零温时的有序参量振幅。您获得了一组在不同温度 $T_i$ 下测得的衍射强度 $I_i$ 的实验数据集。已知测量值受到加性、独立的高斯噪声的干扰，其均值为零，标准差为 $\\sigma$。\n\n您的任务是使用贝叶斯推断来计算参数 $T_c$ 和 $\\eta_0$ 的后验均值和标准差。假设参数的先验分布是独立的且均匀的：$T_c$ 在 $[T_{\\min}, T_{\\max}]$ 区间内均匀分布，$\\eta_0$ 在 $[\\eta_{\\min}, \\eta_{\\max}]$ 区间内均匀分布。\n\n**输入**：\n您将收到三组不同的数据集，每组数据集包含：\n- `temps`: 一个 NumPy 数组，包含测量温度 $T_i$（单位：开尔文）。\n- `intensities`: 一个 NumPy 数组，包含相应的测量强度 $I_i$。\n- `sigma`: 噪声标准差 $\\sigma$。\n- `tc_bounds`: $T_c$ 的先验边界 $[T_{\\min}, T_{\\max}]$。\n- `eta0_bounds`: $\\eta_0$ 的先验边界 $[\\eta_{\\min}, \\eta_{\\max}]$。\n\n**输出**：\n对于每个数据集，在 $401 \\times 401$ 的 $(T_c, \\eta_0)$ 参数网格上计算后验分布。然后，计算并返回每个参数的后验均值和后验标准差。您的最终输出应该是单个 Python 列表，其中包含三个子列表。每个子列表对应一个数据集的四个计算值：$[\\text{mean}(T_c), \\text{std}(T_c), \\text{mean}(\\eta_0), \\text{std}(\\eta_0)]$。\n\n**示例输出格式**：\n```python\n[[tc1_mean, tc1_std, eta01_mean, eta01_std], [tc2_mean, tc2_std, eta02_mean, eta02_std], [tc3_mean, tc3_std, eta03_mean, eta03_std]]\n```",
            "solution": "该问题要求在给定一组实验测量值的情况下，为一个高熵合金长程有序模型确定参数 $(T_c, \\eta_0)$ 的后验概率分布。这些参数是临界温度 $T_c$ 和零温有序参量振幅 $\\eta_0$。该解决方案在离散参数网格上采用贝叶斯框架。\n\n**1. 贝叶斯框架**\n\n分析的基础是贝叶斯定理，它将参数 $\\theta = (T_c, \\eta_0)$ 的后验概率与数据的似然和参数的先验概率联系起来：\n$$\np(\\theta | \\{I_i\\}) \\propto p(\\{I_i\\} | \\theta) \\cdot p(\\theta)\n$$\n这里，$p(\\theta | \\{I_i\\})$ 是给定观测强度 $\\{I_i\\}$ 的后验分布，$p(\\{I_i\\} | \\theta)$ 是给定参数观测到数据的似然，而 $p(\\theta)$ 是参数的先验分布。\n\n**2. 先验分布**\n\n问题指定了 $T_c$ 和 $\\eta_0$ 在它们各自区间上的独立均匀先验：\n$$\np(T_c) = \\begin{cases} \\frac{1}{T_{\\max} - T_{\\min}}  \\text{if } T_c \\in [T_{\\min}, T_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n$$\np(\\eta_0) = \\begin{cases} \\frac{1}{\\eta_{\\max} - \\eta_{\\min}}  \\text{if } \\eta_0 \\in [\\eta_{\\min}, \\eta_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n联合先验是 $p(\\theta) = p(T_c, \\eta_0) = p(T_c)p(\\eta_0)$，它在由先验边界定义的矩形域内是一个常数值，在域外为零。\n\n**3. 似然函数**\n\n在温度 $T$ 下的预测强度 $I_{\\text{pred}}$ 的模型由有序参量 $\\eta(T)$ 的平方给出：\n$$\nI_{\\text{pred}}(T; T_c, \\eta_0) = \\eta^2(T) =\n\\begin{cases}\n\\eta_0^2 \\left(1 - \\frac{T}{T_c}\\right),  T  T_c \\\\\n0,  T \\ge T_c\n\\end{cases}\n$$\n测量值 $I(T_i)$ 受到加性、独立的 高斯噪声 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 的干扰。因此，观测到单个数据点 $I_i = I(T_i)$ 的似然由高斯概率密度函数给出：\n$$\np(I_i | T_c, \\eta_0) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\n由于噪声项是独立的，数据集 $\\{I_i\\}$ 的总似然是单个似然的乘积：\n$$\np(\\{I_i\\} | T_c, \\eta_0) = \\prod_i p(I_i | T_c, \\eta_0)\n$$\n出于计算目的，使用对数似然 $\\mathcal{L}(T_c, \\eta_0) = \\log p(\\{I_i\\} | T_c, \\eta_0)$ 更为方便：\n$$\n\\mathcal{L}(T_c, \\eta_0) = \\sum_i \\left( -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\n在寻找后验分布的形状时，可以舍去相对于参数 $(T_c, \\eta_0)$ 为常数的项。因此，我们关注与平方误差和成比例的项：\n$$\n\\mathcal{L}(T_c, \\eta_0) \\propto -\\frac{1}{2\\sigma^2} \\sum_i (I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2\n$$\n\n**4. 后验的数值计算**\n\n后验分布在离散网格上进行数值计算。\n\n- **网格构建**：将连续参数空间离散化为一个大小为 $n_{T_c} \\times n_{\\eta_0}$ 的均匀网格，其中 $n_{T_c} = 401$ 且 $n_{\\eta_0} = 401$。网格点为 $(T_{c,j}, \\eta_{0,k})$，其中 $j=0, \\dots, n_{T_c}-1$ 且 $k=0, \\dots, n_{\\eta_0}-1$。网格步长为 $\\Delta T_c = (T_{\\max} - T_{\\min}) / (n_{T_c}-1)$ 和 $\\Delta \\eta_0 = (\\eta_{\\max} - \\eta_{\\min}) / (n_{\\eta_0}-1)$。\n\n- **后验计算**：由于先验在网格上是均匀的，未归一化的后验与似然成正比。我们在每个网格点计算对数似然 $\\mathcal{L}_{jk} = \\mathcal{L}(T_{c,j}, \\eta_{0,k})$。为避免在指数运算期间出现数值下溢，我们使用标准的稳定性技巧：\n$$\nP'_{jk} = \\exp(\\mathcal{L}_{jk} - \\mathcal{L}_{\\max})\n$$\n其中 $\\mathcal{L}_{\\max} = \\max_{j,k} (\\mathcal{L}_{jk})$。\n\n- **归一化**：后验必须归一化以使其积分为一。我们用网格上的黎曼和来近似归一化积分（证据，Z）：\n$$\nZ = \\int_{T_{\\min}}^{T_{\\max}} \\int_{\\eta_{\\min}}^{\\eta_{\\max}} p(\\{I_i\\}|T_c, \\eta_0) p(T_c, \\eta_0) \\, d\\eta_0 \\, dT_c \\approx C \\sum_{j,k} P'_{jk} \\Delta T_c \\Delta \\eta_0\n$$\n其中 $C$ 是一个比例常数。每个网格点上归一化的后验概率质量为：\n$$\nP_{jk} = \\frac{P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n相应的概率密度为 $p_{jk} = P_{jk} / (\\Delta T_c \\Delta \\eta_0)$。\n\n**5. 矩的计算**\n\n每个参数的后验均值和标准差是通过在归一化网格上用离散和来近似期望积分来计算的。对于一个通用参数 $\\theta$，其后验均值为：\n$$\n\\langle \\theta \\rangle = E[\\theta | \\{I_i\\}] = \\iint \\theta \\cdot p(\\theta' | \\{I_i\\}) \\, d\\theta' \\approx \\sum_{j,k} \\theta_{jk} \\cdot P_{jk}\n$$\n后验方差为：\n$$\n\\text{Var}(\\theta) = E[\\theta^2 | \\{I_i\\}] - \\langle \\theta \\rangle^2 \\approx \\left(\\sum_{j,k} \\theta_{jk}^2 \\cdot P_{jk}\\right) - \\langle \\theta \\rangle^2\n$$\n后验标准差是 $\\sigma_\\theta = \\sqrt{\\text{Var}(\\theta)}$。这些求和被实现以找到 $T_c$ 和 $\\eta_0$ 所需的统计数据。对于 $T_c$：\n$$\n\\langle T_c \\rangle = \\frac{\\sum_{j,k} T_{c,j} \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\langle T_c^2 \\rangle = \\frac{\\sum_{j,k} T_{c,j}^2 \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\sigma_{T_c} = \\sqrt{\\langle T_c^2 \\rangle - \\langle T_c \\rangle^2}\n$$\n对于 $\\eta_0$ 使用类似的表达式。\n实现中为了效率使用了向量化的 NumPy 操作。观测温度和强度的数组与参数网格进行广播，以同时计算每个参数对 $(T_c, \\eta_0)$ 在所有数据点上的平方误差和。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Bayesian inference for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"temps\": np.array([300.0, 500.0, 700.0, 820.0, 880.0, 910.0, 950.0]),\n            \"intensities\": np.array([0.245, 0.158, 0.082, 0.034, 0.009, 0.002, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [600.0, 1100.0],\n            \"eta0_bounds\": [0.1, 1.0],\n        },\n        # Test case 2 (near-critical and high-noise)\n        {\n            \"temps\": np.array([950.0, 980.0, 990.0, 1005.0, 1020.0, 1100.0]),\n            \"intensities\": np.array([0.010, 0.001, 0.002, 0.003, 0.000, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [900.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n        # Test case 3 (edge case with all T > Tc)\n        {\n            \"temps\": np.array([820.0, 900.0, 1000.0]),\n            \"intensities\": np.array([0.002, 0.001, 0.002]),\n            \"sigma\": 0.005,\n            \"tc_bounds\": [700.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n    ]\n\n    all_results = []\n    \n    n_tc = 401\n    n_eta0 = 401\n\n    for case in test_cases:\n        results = compute_posterior_moments(\n            T_obs=case[\"temps\"],\n            I_obs=case[\"intensities\"],\n            sigma=case[\"sigma\"],\n            tc_bounds=case[\"tc_bounds\"],\n            eta0_bounds=case[\"eta0_bounds\"],\n            n_tc=n_tc,\n            n_eta0=n_eta0,\n        )\n        all_results.append(results)\n\n    # Format output as a Python-style list of lists.\n    # The str() representation of a list of lists matches the required output format.\n    print(str(all_results))\n\ndef compute_posterior_moments(T_obs, I_obs, sigma, tc_bounds, eta0_bounds, n_tc, n_eta0):\n    \"\"\"\n    Computes the posterior means and standard deviations for Tc and eta0.\n\n    Args:\n        T_obs (np.ndarray): Observed temperatures in Kelvin.\n        I_obs (np.ndarray): Observed intensities.\n        sigma (float): Standard deviation of Gaussian noise.\n        tc_bounds (list): Prior bounds [min, max] for Tc.\n        eta0_bounds (list): Prior bounds [min, max] for eta0.\n        n_tc (int): Number of grid points for Tc.\n        n_eta0 (int): Number of grid points for eta0.\n\n    Returns:\n        list: [Tc_mean, Tc_std, eta0_mean, eta0_std]\n    \"\"\"\n    # 1. Construct the parameter grid\n    Tc_vals = np.linspace(tc_bounds[0], tc_bounds[1], n_tc)\n    eta0_vals = np.linspace(eta0_bounds[0], eta0_bounds[1], n_eta0)\n\n    # 2. Compute log-likelihood over the grid using broadcasting\n    # Reshape inputs for broadcasting:\n    # T_obs_b: (M, 1, 1), I_obs_b: (M, 1, 1)\n    # Tc_vals_b: (1, n_tc, 1), eta0_vals_b: (1, 1, n_eta0)\n    # M is the number of observations.\n    T_obs_b = T_obs.reshape(-1, 1, 1)\n    I_obs_b = I_obs.reshape(-1, 1, 1)\n    Tc_vals_b = Tc_vals.reshape(1, -1, 1)\n    eta0_vals_b = eta0_vals.reshape(1, 1, -1)\n    \n    # Calculate predicted intensity I_pred, shape (M, n_tc, n_eta0)\n    # This automatically broadcasts the arrays to a common shape.\n    temp_ratio = T_obs_b / Tc_vals_b\n    I_pred = np.where(temp_ratio  1.0, eta0_vals_b**2 * (1.0 - temp_ratio), 0.0)\n\n    # Sum of squared errors, shape (n_tc, n_eta0)\n    sse = np.sum((I_obs_b - I_pred)**2, axis=0)\n\n    # Log-likelihood (propto sum of squared errors), shape (n_tc, n_eta0)\n    log_likelihood_grid = -0.5 * sse / (sigma**2)\n\n    # 3. Compute the unnormalized posterior with a stability trick\n    log_likelihood_grid -= np.max(log_likelihood_grid)\n    unnormalized_posterior = np.exp(log_likelihood_grid)\n\n    # 4. Normalize the posterior\n    # The sum of unnormalized_posterior is proportional to the normalization constant Z.\n    # To get moments, we can use this sum directly.\n    posterior_sum = np.sum(unnormalized_posterior)\n    if posterior_sum == 0:\n        # Avoid division by zero in pathological cases\n        return [np.nan, np.nan, np.nan, np.nan]\n        \n    normalized_posterior_mass = unnormalized_posterior / posterior_sum\n\n    # 5. Compute posterior moments\n    # We need meshgrids for calculating expectations. `indexing='ij'` ensures\n    # the grid corresponds to our (n_tc, n_eta0) array shapes.\n    Tc_grid, eta0_grid = np.meshgrid(Tc_vals, eta0_vals, indexing='ij')\n\n    # Mean of Tc\n    Tc_mean = np.sum(Tc_grid * normalized_posterior_mass)\n    \n    # Mean of eta0\n    eta0_mean = np.sum(eta0_grid * normalized_posterior_mass)\n    \n    # Variance of Tc\n    Tc2_mean = np.sum(Tc_grid**2 * normalized_posterior_mass)\n    Tc_var = Tc2_mean - Tc_mean**2\n    Tc_std = np.sqrt(Tc_var)\n\n    # Variance of eta0\n    eta02_mean = np.sum(eta0_grid**2 * normalized_posterior_mass)\n    eta0_var = eta02_mean - eta0_mean**2\n    eta0_std = np.sqrt(eta0_var)\n\n    return [Tc_mean, Tc_std, eta0_mean, eta0_std]\n\n# Run the main program\nsolve()\n```"
        }
    ]
}