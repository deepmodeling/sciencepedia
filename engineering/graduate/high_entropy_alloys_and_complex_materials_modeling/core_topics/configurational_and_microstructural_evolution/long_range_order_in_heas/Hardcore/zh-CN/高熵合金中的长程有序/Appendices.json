{
    "hands_on_practices": [
        {
            "introduction": "在高熵合金等复杂多组分材料中，如何精确地量化长程有序（LRO）的程度是一个核心问题。本练习旨在引导您超越简单的二元合金模型，推导出一个适用于多组分、多亚点阵体系的、具有物种标签置换不变性的标量长程有序度量。掌握这种形式化定义的能力，是深入研究和描述复杂有序结构的关键一步。",
            "id": "3749881",
            "problem": "考虑一种高熵合金 (HEA)，此处定义为一种具有近似等原子比或近等原子比成分的多组分金属体系，其在晶体学亚晶格上表现出潜在的长程有序 (LRO)。设晶体被划分为 $S$ 个不同的亚晶格，标记为 $\\alpha \\in \\{1,\\dots,S\\}$，每个亚晶格占据总晶格格点的一部分，比例为 $f_{\\alpha}$，其中 $\\sum_{\\alpha=1}^{S} f_{\\alpha} = 1$ 且 $0  f_{\\alpha}  1$。设该合金包含 $n$ 种化学元素，索引为 $i \\in \\{1,\\dots,n\\}$，其全局成分向量为 $\\mathbf{c} = (c_{1},\\dots,c_{n})$，满足 $\\sum_{i=1}^{n} c_{i} = 1$ 且 $0  c_{i}  1$。定义亚晶格条件占有概率 $p_{\\alpha i}$ 为亚晶格 $\\alpha$ 上的一个格点被元素 $i$ 占据的概率，对于每个 $\\alpha$ 均满足归一化条件 $\\sum_{i=1}^{n} p_{\\alpha i} = 1$。全局成分可通过亚晶格平均 $c_{i} = \\sum_{\\alpha=1}^{S} f_{\\alpha} p_{\\alpha i}$ 计算得出。\n\n从这些定义以及概率和对称性的第一性原理（包括在元素标号置换下的不变性）出发，构建一个归一化的亚晶格占有矩阵 $\\mathbf{P} \\in \\mathbb{R}^{S \\times n}$，其元素为 $p_{\\alpha i}$，用于表示对长程有序敏感的格点偏好。然后，推导一个标量长程有序度 $\\mathcal{Q}(\\mathbf{P},\\mathbf{c},\\mathbf{f})$，该度量满足：\n- 在元素标号 $i$ 的任何置换下保持不变，\n- 当所有亚晶格均被随机占据时（即对于所有 $\\alpha,i$，有 $p_{\\alpha i} = c_{i}$），其值为零，\n- 随着格点偏好的增强而单调增加，且\n- 被归一化为无量纲，并且当理想分配状态与成分向量和亚晶格分数兼容时，其值达到 1。\n\n在推导出您的标量度量后，为以下物理上一致的双亚晶格（$S=2$）、四组分（$n=4$）的类高熵合金情景计算其值，该情景模拟了具有相等亚晶格分数的二元有序（B2型）晶体：\n- 亚晶格分数：$f_{A} = f_{B} = 0.5$。\n- 亚晶格条件占有矩阵：\n$$\n\\mathbf{P} \\;=\\;\n\\begin{pmatrix}\np_{A,1}  p_{A,2}  p_{A,3}  p_{A,4} \\\\\np_{B,1}  p_{B,2}  p_{B,3}  p_{B,4}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.45  0.15  0.25  0.15 \\\\\n0.05  0.35  0.15  0.45\n\\end{pmatrix}.\n$$\n首先，验证行上的归一化约束，并从 $\\mathbf{P}$ 和 $\\mathbf{f}$ 计算出隐含的全局成分向量 $\\mathbf{c} = (c_{1},c_{2},c_{3},c_{4})$。然后，使用您推导的标量度量 $\\mathcal{Q}$，计算其在此情况下的数值。将您的最终数值答案四舍五入至四位有效数字。将最终答案表示为无量纲量。",
            "solution": "该问题陈述经评估具有科学依据、问题适定、客观且内部一致。它提出了计算材料科学领域中一个关于量化高熵合金 (HEA) 中长程有序 (LRO) 的有效任务。我们将继续推导长程有序度，并随后针对指定情况进行计算。\n\n**第一部分：长程有序度 $\\mathcal{Q}$ 的推导**\n\n问题要求构建一个满足四个特定标准的标量长程有序度 $\\mathcal{Q}(\\mathbf{P}, \\mathbf{c}, \\mathbf{f})$。我们将基于亚晶格占有率 $p_{\\alpha i}$ 与完全无序（随机）状态（即对于所有亚晶格 $\\alpha$ 和元素 $i$，$p_{\\alpha i} = c_i$）的偏差来构建该度量。\n\n让我们将元素 $i$ 在亚晶格 $\\alpha$ 上与随机占有的偏差定义为 $\\Delta_{\\alpha i} = p_{\\alpha i} - c_i$。\n$\\mathcal{Q}$ 对于随机合金必须为零的条件表明，它应该是这些偏差的函数。这些偏差的平方和 $\\Delta_{\\alpha i}^2$ 是一个自然的选择，因为它始终是非负的，并且仅当所有偏差都为零时才为零。\n\n为了为整个晶体创建一个单一的标量度量，我们必须对所有元素 $i$ 和所有亚晶格 $\\alpha$ 进行求和。使用各自的分数 $f_{\\alpha}$ 对亚晶格进行加权求和是合适的，以考虑每个亚晶格对晶体贡献的格点比例。对元素标号 $i$ 的置换不变性要求通过对索引 $i$ 求和自然得到满足。\n\n让我们定义一个未归一化的平方偏差度量 $\\mathcal{X}$ 如下：\n$$\n\\mathcal{X} = \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} (p_{\\alpha i} - c_i)^2\n$$\n该量当且仅当对于所有 $\\alpha, i$ 都有 $p_{\\alpha i} = c_i$（随机状态）时为零，并且随着亚晶格占有率偏离全局成分而增加，从而满足了前两个要求。它对于格点偏好的强度也是单调的。\n\n为了简化此表达式并找到一个合适的归一化常数，我们展开平方项：\n$$\n\\mathcal{X} = \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} (p_{\\alpha i}^2 - 2 p_{\\alpha i} c_i + c_i^2)\n$$\n分配求和符号：\n$$\n\\mathcal{X} = \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} p_{\\alpha i}^2 - 2 \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} p_{\\alpha i} c_i + \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} c_i^2\n$$\n我们可以使用给定的定义来简化第二项和第三项。对于第二项，我们重新排列求和顺序并使用关系式 $c_i = \\sum_{\\alpha=1}^{S} f_{\\alpha} p_{\\alpha i}$：\n$$\n-2 \\sum_{i=1}^{n} c_i \\left( \\sum_{\\alpha=1}^{S} f_{\\alpha} p_{\\alpha i} \\right) = -2 \\sum_{i=1}^{n} c_i^2\n$$\n对于第三项，我们使用 $\\sum_{\\alpha=1}^{S} f_{\\alpha} = 1$：\n$$\n\\left( \\sum_{\\alpha=1}^{S} f_{\\alpha} \\right) \\left( \\sum_{i=1}^{n} c_i^2 \\right) = 1 \\cdot \\sum_{i=1}^{n} c_i^2 = \\sum_{i=1}^{n} c_i^2\n$$\n将这些代回到 $\\mathcal{X}$ 的表达式中：\n$$\n\\mathcal{X} = \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} p_{\\alpha i}^2 - 2 \\sum_{i=1}^{n} c_i^2 + \\sum_{i=1}^{n} c_i^2 = \\sum_{\\alpha=1}^{S} f_{\\alpha} \\sum_{i=1}^{n} p_{\\alpha i}^2 - \\sum_{i=1}^{n} c_i^2\n$$\n这是我们长程有序参数 $\\mathcal{Q}$ 的分子。\n\n接下来，我们需要找到一个归一化因子，使得 $\\mathcal{Q}$ 对于理想分配状态是无量纲的且等于 1。理想分配状态代表了最大可能的有序度。当亚晶格上没有化学混合时，就会出现这种状态。这并不意味着每个亚晶格都是纯元素，而是对于给定的亚晶格 $\\alpha$，每个格点都由相同的原子分布占据，并且这种分布是“纯”的。最大的化学偏析对应于这样一种情况：对于每个亚晶格 $\\alpha$，所有格点都由单一元素 $j$ 占据。在这种情况下，$p_{\\alpha j} = 1$ 且对于 $i \\neq j$ 有 $p_{\\alpha i} = 0$。对于这样的状态，对于每个 $\\alpha$，项 $\\sum_{i=1}^n p_{\\alpha i}^2 = 1^2 = 1$。\n\n分子 $\\mathcal{X}$ 的最大可能值，我们称之为 $\\mathcal{X}_{max}$，将对应于这种理想分配。将 $\\sum_i p_{\\alpha i}^2 = 1$ 代入我们对 $\\mathcal{X}$ 的表达式中：\n$$\n\\mathcal{X}_{max} = \\sum_{\\alpha=1}^{S} f_{\\alpha} (1) - \\sum_{i=1}^{n} c_i^2 = 1 - \\sum_{i=1}^{n} c_i^2\n$$\n该项也可以写作 $\\sum_{i=1}^n c_i (1-c_i)$，它是在随机合金中各元素方差的总和，代表了无序状态下的总成分涨落。使用它作为归一化因子可确保如果达到这样的理想状态，$\\mathcal{Q}$ 将变为 1。\n\n因此，推导出的长程有序度为：\n$$\n\\mathcal{Q}(\\mathbf{P}, \\mathbf{c}, \\mathbf{f}) = \\frac{\\mathcal{X}}{\\mathcal{X}_{max}} = \\frac{\\sum_{\\alpha=1}^S f_\\alpha \\sum_{i=1}^n (p_{\\alpha i} - c_i)^2}{1 - \\sum_{i=1}^n c_i^2}\n$$\n或者，使用计算上更简单的形式：\n$$\n\\mathcal{Q}(\\mathbf{P}, \\mathbf{c}, \\mathbf{f}) = \\frac{\\sum_{\\alpha=1}^S f_\\alpha \\sum_{i=1}^n p_{\\alpha i}^2 - \\sum_{i=1}^n c_i^2}{1 - \\sum_{i=1}^n c_i^2}\n$$\n该度量满足所有要求的标准。\n\n**第二部分：针对特定情况的计算**\n\n给定一个双亚晶格（$S=2$）、四组分（$n=4$）的体系。\n已知条件为：\n- 亚晶格分数：$f_{A} = 0.5$, $f_{B} = 0.5$。\n- 亚晶格条件占有矩阵：\n$$\n\\mathbf{P} =\n\\begin{pmatrix}\n0.45  0.15  0.25  0.15 \\\\\n0.05  0.35  0.15  0.45\n\\end{pmatrix}\n$$\n\n首先，我们验证 $\\mathbf{P}$ 的行和归一化：\n- 亚晶格 A 对应的行：$0.45 + 0.15 + 0.25 + 0.15 = 1.00$。已正确归一化。\n- 亚晶格 B 对应的行：$0.05 + 0.35 + 0.15 + 0.45 = 1.00$。也已正确归一化。\n\n接下来，我们使用 $c_i = f_A p_{A,i} + f_B p_{B,i}$ 计算全局成分向量 $\\mathbf{c} = (c_{1}, c_{2}, c_{3}, c_{4})$：\n- $c_{1} = (0.5)(0.45) + (0.5)(0.05) = 0.225 + 0.025 = 0.250$\n- $c_{2} = (0.5)(0.15) + (0.5)(0.35) = 0.075 + 0.175 = 0.250$\n- $c_{3} = (0.5)(0.25) + (0.5)(0.15) = 0.125 + 0.075 = 0.200$\n- $c_{4} = (0.5)(0.15) + (0.5)(0.45) = 0.075 + 0.225 = 0.300$\n全局成分向量为 $\\mathbf{c} = (0.250, 0.250, 0.200, 0.300)$。成分之和为 $0.25+0.25+0.20+0.30 = 1.00$，符合要求。\n\n现在，我们计算 $\\mathcal{Q}$ 所需的各项。\n分子的第一项：$\\sum_{\\alpha} f_\\alpha \\sum_{i} p_{\\alpha i}^2 = f_A \\sum_i p_{A,i}^2 + f_B \\sum_i p_{B,i}^2$。\n- $\\sum_{i=1}^4 p_{A,i}^2 = (0.45)^2 + (0.15)^2 + (0.25)^2 + (0.15)^2 = 0.2025 + 0.0225 + 0.0625 + 0.0225 = 0.3100$\n- $\\sum_{i=1}^4 p_{B,i}^2 = (0.05)^2 + (0.35)^2 + (0.15)^2 + (0.45)^2 = 0.0025 + 0.1225 + 0.0225 + 0.2025 = 0.3500$\n- $\\sum_{\\alpha} f_\\alpha \\sum_{i} p_{\\alpha i}^2 = (0.5)(0.3100) + (0.5)(0.3500) = 0.1550 + 0.1750 = 0.3300$\n\n分子和分母共有的第二项：$\\sum_{i=1}^4 c_i^2$。\n- $\\sum_{i=1}^4 c_i^2 = (0.250)^2 + (0.250)^2 + (0.200)^2 + (0.300)^2 = 0.0625 + 0.0625 + 0.0400 + 0.0900 = 0.2550$\n\n现在，我们计算 $\\mathcal{Q}$ 的分子和分母。\n- 分子 = $\\sum_{\\alpha} f_\\alpha \\sum_{i} p_{\\alpha i}^2 - \\sum_i c_i^2 = 0.3300 - 0.2550 = 0.0750$\n- 分母 = $1 - \\sum_i c_i^2 = 1 - 0.2550 = 0.7450$\n\n最后，我们计算长程有序度 $\\mathcal{Q}$ 的值：\n$$\n\\mathcal{Q} = \\frac{0.0750}{0.7450} \\approx 0.10067114...\n$$\n四舍五入到四位有效数字，我们得到 $0.1007$。\n这个值代表了一种部分长程有序的状态。值为 $0$ 意味着完全随机的固溶体，而值为 $1$ 则表示理想分配（对于此特定成分，这可能达到也可能无法达到）。计算出的值表明在两个亚晶格上存在可测量的原子有序度。",
            "answer": "$$\n\\boxed{0.1007}\n$$"
        },
        {
            "introduction": "长程有序最直接的实验证据来自衍射实验，其中原子有序排列会产生超晶格衍射峰。本练习将指导您完成一个B2有序五元高熵合金中超晶格结构因子的基础推导，从而将抽象的有序参数与可测量的衍射强度直接联系起来。这个过程揭示了有序结构如何在倒易空间中留下其独特的“指纹”。",
            "id": "3749850",
            "problem": "考虑一种具有 B2（氯化铯型）有序结构的五元高熵合金 (HEA)，该合金由两个互穿的简单立方亚晶格组成：一个位于分数坐标 $(0,0,0)$ 的 $\\alpha$ 亚晶格和一个位于分数坐标 $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$ 的 $\\beta$ 亚晶格。该合金包含标记为 $A$, $B$, $C$, $D$, 和 $E$ 的五种化学组分，且总体上是等原子比的。合金中的长程有序 (LRO) 由一个标量有序参数 $\\eta$ 来表征，该参数使两个亚晶格之间的格点占位发生偏向，同时保持总体成分不变。亚晶格格点占位概率由 $\\eta$ 的函数指定如下：\n$$\np_{A}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\n$$\n和\n$$\np_{A}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\n$$\n这确保了对于所有的 $\\eta$，$\\sum_{X}p_{X}^{\\alpha}=1$ 和 $\\sum_{X}p_{X}^{\\beta}=1$ 均成立，其中 $X\\in\\{A,B,C,D,E\\}$。假设原子散射因子 $f_{A},f_{B},f_{C},f_{D},f_{E}$ 取决于组分，但与亚晶格无关，并且对于与 $(100)$ 反射相关的散射矢量大小是恒定的。使用晶体结构因子的第一性原理定义，推导 $(100)$ 型结构因子振幅的解析表达式，用 $f_{A},f_{B},f_{C},f_{D},f_{E}$ 和 $\\eta$ 表示。请将最终答案表示为单一的简化闭式表达式。无需进行数值计算或四舍五入。",
            "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。所有必要的参数和定义都已提供，以推导所求的量。该物理模型通过依赖于有序参数的格点占位概率来描述多组分合金中的长程有序，是计算材料科学和固态物理学中的一种标准且有效的方法。因此，该问题被认为是有效的，可以构建一个严谨的解。\n\n晶体结构因子，记作 $F_{\\mathbf{G}}$ 或 $F_{hkl}$，对于一个对应于密勒指数 $(hkl)$ 的散射矢量 $\\mathbf{G}$，其定义为单个晶胞内所有原子散射波的总和。对于一个基元中包含 $N$ 个原子，位置为 $\\mathbf{r}_j$，原子散射因子为 $f_j$ 的晶体，其结构因子由下式给出：\n$$\nF_{hkl} = \\sum_{j=1}^{N} f_j \\exp(2\\pi i (h x_j + k y_j + l z_j))\n$$\n其中 $(x_j, y_j, z_j)$ 是原子 $j$ 的分数坐标。\n\n在部分有序合金的情况下，特定格点 $j$ 的散射因子 $f_j$ 被可能占据该格点的元素的散射因子的统计平均值所取代。这个平均散射因子 $\\bar{f}_j$ 的计算方法是，将每个组分 $X$ 的散射因子按其各自的格点占位概率 $p_{X}^{j}$ 加权求和：\n$$\n\\bar{f}_j = \\sum_{X} p_{X}^{j} f_{X}\n$$\n\n该问题描述了一种 B2 有序五元合金，其每个晶胞的基元由两个原子组成。这些原子位于两个不同的亚晶格 $\\alpha$ 和 $\\beta$ 上。这些格点的分数坐标如下：\n- $\\alpha$ 亚晶格：$\\mathbf{r}_{\\alpha} = (0, 0, 0)$\n- $\\beta$ 亚晶格：$\\mathbf{r}_{\\beta} = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n\n因此，结构因子可以写成每个亚晶格的平均散射因子 $\\bar{f}_{\\alpha}$ 和 $\\bar{f}_{\\beta}$ 的形式：\n$$\nF_{hkl} = \\bar{f}_{\\alpha} \\exp[2\\pi i (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)] + \\bar{f}_{\\beta} \\exp[2\\pi i (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})]\n$$\n这可以简化为：\n$$\nF_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta} \\exp[\\pi i (h+k+l)]\n$$\n如果密勒指数之和 $(h+k+l)$ 为偶数，指数项的值为 $+1$；如果和为奇数，则值为 $-1$。\n- 当 $(h+k+l) = \\text{偶数}$: $F_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta}$ (基本反射)\n- 当 $(h+k+l) = \\text{奇数}$: $F_{hkl} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$ (超晶格反射)\n\n问题要求计算 $(100)$ 反射的结构因子。在这种情况下，$(h, k, l) = (1, 0, 0)$，其和 $h+k+l = 1$ 为奇数。这对应于一个超晶格反射，是 B2 有序结构的标志。因此，结构因子为：\n$$\nF_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}\n$$\n\n我们现在必须使用所提供的、对于亚晶格 $\\gamma \\in \\{\\alpha, \\beta\\}$ 上的组分 $X \\in \\{A, B, C, D, E\\}$ 的格点占位概率 $p_{X}^{\\gamma}$，来计算平均散射因子 $\\bar{f}_{\\alpha}$ 和 $\\bar{f}_{\\beta}$。\n\n$\\alpha$ 亚晶格的平均散射因子是：\n$$\n\\bar{f}_{\\alpha} = \\sum_{X} p_{X}^{\\alpha} f_{X} = p_{A}^{\\alpha}f_{A} + p_{B}^{\\alpha}f_{B} + p_{C}^{\\alpha}f_{C} + p_{D}^{\\alpha}f_{D} + p_{E}^{\\alpha}f_{E}\n$$\n代入给定的 $p_{X}^{\\alpha}$ 表达式：\n$$\n\\bar{f}_{\\alpha} = \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{E}\n$$\n我们可以根据对有序参数 $\\eta$ 的依赖性对各项进行分组：\n$$\n\\bar{f}_{\\alpha} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) + \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\n类似地，$\\beta$ 亚晶格的平均散射因子是：\n$$\n\\bar{f}_{\\beta} = \\sum_{X} p_{X}^{\\beta} f_{X} = p_{A}^{\\beta}f_{A} + p_{B}^{\\beta}f_{B} + p_{C}^{\\beta}f_{C} + p_{D}^{\\beta}f_{D} + p_{E}^{\\beta}f_{E}\n$$\n代入给定的 $p_{X}^{\\beta}$ 表达式：\n$$\n\\bar{f}_{\\beta} = \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{E}\n$$\n分组各项：\n$$\n\\bar{f}_{\\beta} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) - \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\n现在，我们计算差值 $F_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$：\n$$\nF_{100} = \\left[\\frac{1}{5}\\sum_{X}f_{X} + \\eta\\left(\\dots\\right)\\right] - \\left[\\frac{1}{5}\\sum_{X}f_{X} - \\eta\\left(\\dots\\right)\\right]\n$$\n与 $\\eta$ 无关的项相互抵消，剩下：\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n为了将此表达式简化为单个分数，我们找到一个公分母，即 $15$。注意 $\\frac{1}{5} = \\frac{3}{15}$。\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{3}{15}f_{D} - \\frac{3}{15}f_{E}\\right)\n$$\n提出公因子 $\\frac{1}{15}$：\n$$\nF_{100} = \\frac{2\\eta}{15}(2f_{A}+2f_{B}+2f_{C} - 3f_{D} - 3f_{E})\n$$\n通过对散射因子进行分组，此表达式可以更紧凑地写成：\n$$\nF_{100} = \\frac{2\\eta}{15}\\left[2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right]\n$$\n这是 $(100)$ 结构因子振幅的最终简化闭式表达式。“振幅”一词指的是结构因子本身的值，在本例中它是一个实数。其大小决定了衍射峰的强度。该表达式正确地表明，对于完全无序的合金 ($\\eta=0$)，超晶格反射强度为零，并随长程有序度的增加而增长。",
            "answer": "$$\n\\boxed{\\frac{2\\eta}{15}\\left(2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right)}\n$$"
        },
        {
            "introduction": "材料科学的一个核心目标是将理论模型与实验现实联系起来。这个高级编程练习将朗道相变理论与贝叶斯推断相结合，用于分析含噪声的衍射数据。通过这项实践，您将能够从实验测量中提取出临界温度 $T_c$ 等关键参数，并量化您推断结果的不确定性，这在现代材料研究中是一项至关重要的技能。",
            "id": "3749823",
            "problem": "考虑一个由连续有序-无序相变驱动的、具有长程有序（LRO）的高熵合金（HEA）。设强度标量序参量记为 $\\eta(T)$，其定义为亚晶格占位之差，并假设其在相变点附近的平衡行为可用以下形式的朗道自由能 $F(\\eta,T)$ 来描述：\n$$\nF(\\eta,T) = a\\,(T - T_c)\\,\\eta^2 + b\\,\\eta^4,\n$$\n其中 $a>0$，$b>0$，$T_c$ 是以开尔文表示的临界温度。对于 $T  T_c$，最小化 $F$ 可得平衡序参量 $\\eta(T) = \\eta_0 \\sqrt{1 - T/T_c}$，其中 $\\eta_0=\\sqrt{aT_c/2b}$ 是外推至零温的序参量。对于 $T \\ge T_c$，平衡序参量为 $\\eta(T)=0$。LRO 超晶格衍射峰的积分强度 $I(T)$ 与序参量的平方成正比，即 $I(T) \\propto \\eta^2(T)$。为简单起见，我们设比例常数为 1。\n\n您将得到一组在不同温度 $T_i$ 下测量的积分强度 $I_i$，这些测量值受到加性高斯白噪声的干扰，该噪声服从均值为零、标准差为 $\\sigma$ 的正态分布 $\\mathcal{N}(0,\\sigma^2)$。您将获得三个独立的测试用例，每个用例都包含一组观测温度和强度，以及噪声标准差 $\\sigma$ 和模型参数 $T_c$ 与 $\\eta_0$ 的均匀先验边界。\n\n您的任务是为每个测试用例实现一个 Python 3 程序，执行贝叶斯推断，以确定模型参数 $(T_c, \\eta_0)$ 的后验概率分布。在由先验边界定义的 $(T_c, \\eta_0)$ 参数空间中构建一个 $401 \\times 401$ 的均匀网格。在此网格上，计算每个参数对的后验概率（与似然乘以均匀先验成正比）。然后，从此离散化的后验分布中，计算每个参数的后验均值和后验标准差。\n\n输出应为一个 Python 风格的列表，其中包含三个子列表，每个子列表对应一个测试用例的推断结果。每个子列表应包含四个浮点数，顺序为：$[T_c^{\\text{mean}}, T_c^{\\text{std}}, \\eta_0^{\\text{mean}}, \\eta_0^{\\text{std}}]$。\n\n**测试用例**\n1.  **通用案例**:\n    - 温度 (K): `[300.0, 500.0, 700.0, 820.0, 880.0, 910.0, 950.0]`\n    - 强度: `[0.245, 0.158, 0.082, 0.034, 0.009, 0.002, 0.001]`\n    - 噪声标准差 $\\sigma$: `0.01`\n    - 先验边界 $T_c$: `[600.0, 1100.0]`\n    - 先验边界 $\\eta_0$: `[0.1, 1.0]`\n\n2.  **近临界与高噪声案例**:\n    - 温度 (K): `[950.0, 980.0, 990.0, 1005.0, 1020.0, 1100.0]`\n    - 强度: `[0.010, 0.001, 0.002, 0.003, 0.000, 0.001]`\n    - 噪声标准差 $\\sigma$: `0.01`\n    - 先验边界 $T_c$: `[900.0, 1200.0]`\n    - 先验边界 $\\eta_0$: `[0.1, 0.8]`\n\n3.  **所有 T > Tc 的边缘案例**:\n    - 温度 (K): `[820.0, 900.0, 1000.0]`\n    - 强度: `[0.002, 0.001, 0.002]`\n    - 噪声标准差 $\\sigma$: `0.005`\n    - 先验边界 $T_c$: `[700.0, 1200.0]`\n    - 先验边界 $\\eta_0$: `[0.1, 0.8]`",
            "solution": "问题要求在给定一组实验测量值的情况下，为一个高熵合金长程有序模型确定其参数 $(T_c, \\eta_0)$ 的后验概率分布。这些参数是临界温度 $T_c$ 和零温序参量振幅 $\\eta_0$。该解决方案在离散的参数网格上采用贝叶斯框架。\n\n**1. 贝叶斯框架**\n\n分析的基础是贝叶斯定理，该定理将参数 $\\theta = (T_c, \\eta_0)$ 的后验概率与数据的似然以及参数的先验概率联系起来：\n$$\np(\\theta | \\{I_i\\}) \\propto p(\\{I_i\\} | \\theta) \\cdot p(\\theta)\n$$\n此处，$p(\\theta | \\{I_i\\})$ 是在给定观测强度 $\\{I_i\\}$ 条件下的后验分布，$p(\\{I_i\\} | \\theta)$ 是在给定参数条件下观测到该数据的似然，$p(\\theta)$ 是参数的先验分布。\n\n**2. 先验分布**\n\n问题指定了 $T_c$ 和 $\\eta_0$ 在它们各自区间上的独立均匀先验：\n$$\np(T_c) = \\begin{cases} \\frac{1}{T_{\\max} - T_{\\min}}  \\text{if } T_c \\in [T_{\\min}, T_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n$$\np(\\eta_0) = \\begin{cases} \\frac{1}{\\eta_{\\max} - \\eta_{\\min}}  \\text{if } \\eta_0 \\in [\\eta_{\\min}, \\eta_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n联合先验为 $p(\\theta) = p(T_c, \\eta_0) = p(T_c)p(\\eta_0)$，它在由先验边界定义的矩形域内是一个常数，在域外为零。\n\n**3. 似然函数**\n\n在温度 $T$ 下的预测强度 $I_{\\text{pred}}$ 的模型由序参量 $\\eta(T)$ 的平方给出：\n$$\nI_{\\text{pred}}(T; T_c, \\eta_0) = \\eta^2(T) =\n\\begin{cases}\n\\eta_0^2 \\left(1 - \\frac{T}{T_c}\\right),  T  T_c \\\\\n0,  T \\ge T_c\n\\end{cases}\n$$\n测量值 $I(T_i)$ 受到附加的、独立的、服从 $\\mathcal{N}(0, \\sigma^2)$ 的高斯噪声 $\\varepsilon_i$ 的干扰。因此，观测到单个数据点 $I_i = I(T_i)$ 的似然由高斯概率密度函数给出：\n$$\np(I_i | T_c, \\eta_0) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\n由于噪声项是独立的，数据集 $\\{I_i\\}$ 的总似然是各个似然的乘积：\n$$\np(\\{I_i\\} | T_c, \\eta_0) = \\prod_i p(I_i | T_c, \\eta_0)\n$$\n为便于计算，使用对数似然 $\\mathcal{L}(T_c, \\eta_0) = \\log p(\\{I_i\\} | T_c, \\eta_0)$ 更为方便：\n$$\n\\mathcal{L}(T_c, \\eta_0) = \\sum_i \\left( -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\n在寻找后验分布的形状时，可以舍去相对于参数 $(T_c, \\eta_0)$ 的常数项。因此，我们关注与残差平方和成正比的项：\n$$\n\\mathcal{L}(T_c, \\eta_0) \\propto -\\frac{1}{2\\sigma^2} \\sum_i (I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2\n$$\n\n**4. 数值后验计算**\n\n后验分布在离散网格上进行数值计算。\n\n- **网格构建**：将连续的参数空间离散化为一个大小为 $n_{T_c} \\times n_{\\eta_0}$ 的均匀网格，其中 $n_{T_c} = 401$，$n_{\\eta_0} = 401$。网格点为 $(T_{c,j}, \\eta_{0,k})$，其中 $j=0, \\dots, n_{T_c}-1$，$k=0, \\dots, n_{\\eta_0}-1$。网格步长为 $\\Delta T_c = (T_{\\max} - T_{\\min}) / (n_{T_c}-1)$ 和 $\\Delta \\eta_0 = (\\eta_{\\max} - \\eta_{\\min}) / (n_{\\eta_0}-1)$。\n\n- **后验计算**：由于先验在网格上是均匀的，未归一化的后验分布与似然成正比。我们在每个网格点计算对数似然 $\\mathcal{L}_{jk} = \\mathcal{L}(T_{c,j}, \\eta_{0,k})$。为避免在取指数时发生数值下溢，我们使用标准的稳定性技巧：\n$$\nP'_{jk} = \\exp(\\mathcal{L}_{jk} - \\mathcal{L}_{\\max})\n$$\n其中 $\\mathcal{L}_{\\max} = \\max_{j,k} (\\mathcal{L}_{jk})$。\n\n- **归一化**：后验分布必须归一化以使其积分为一。我们用网格上的黎曼和来近似归一化积分（即证据因子 $Z$）：\n$$\nZ = \\int_{T_{\\min}}^{T_{\\max}} \\int_{\\eta_{\\min}}^{\\eta_{\\max}} p(\\{I_i\\}|T_c, \\eta_0) p(T_c, \\eta_0) \\, d\\eta_0 \\, dT_c \\approx C \\sum_{j,k} P'_{jk} \\Delta T_c \\Delta \\eta_0\n$$\n其中 $C$ 是一个比例常数。每个网格点上归一化的后验概率质量为：\n$$\nP_{jk} = \\frac{P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n对应的概率密度为 $p_{jk} = P_{jk} / (\\Delta T_c \\Delta \\eta_0)$。\n\n**5. 矩的计算**\n\n每个参数的后验均值和标准差是通过在归一化网格上用离散求和来近似期望积分计算的。对于一个通用参数 $\\theta$，其后验均值为：\n$$\n\\langle \\theta \\rangle = E[\\theta | \\{I_i\\}] = \\iint \\theta \\cdot p(\\theta' | \\{I_i\\}) \\, d\\theta' \\approx \\sum_{j,k} \\theta_{jk} \\cdot P_{jk}\n$$\n后验方差为：\n$$\n\\text{Var}(\\theta) = E[\\theta^2 | \\{I_i\\}] - \\langle \\theta \\rangle^2 \\approx \\left(\\sum_{j,k} \\theta_{jk}^2 \\cdot P_{jk}\\right) - \\langle \\theta \\rangle^2\n$$\n后验标准差为 $\\sigma_\\theta = \\sqrt{\\text{Var}(\\theta)}$。通过执行这些求和来找到 $T_c$ 和 $\\eta_0$ 所需的统计量。对于 $T_c$：\n$$\n\\langle T_c \\rangle = \\frac{\\sum_{j,k} T_{c,j} \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\langle T_c^2 \\rangle = \\frac{\\sum_{j,k} T_{c,j}^2 \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\sigma_{T_c} = \\sqrt{\\langle T_c^2 \\rangle - \\langle T_c \\rangle^2}\n$$\n对于 $\\eta_0$ 也使用类似的表达式。\n该实现使用向量化的 NumPy 操作以提高效率。观测温度和强度的数组与参数网格进行广播，从而为每个参数对 $(T_c, \\eta_0)$ 同时计算所有数据点的残差平方和。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Bayesian inference for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"temps\": np.array([300.0, 500.0, 700.0, 820.0, 880.0, 910.0, 950.0]),\n            \"intensities\": np.array([0.245, 0.158, 0.082, 0.034, 0.009, 0.002, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [600.0, 1100.0],\n            \"eta0_bounds\": [0.1, 1.0],\n        },\n        # Test case 2 (near-critical and high-noise)\n        {\n            \"temps\": np.array([950.0, 980.0, 990.0, 1005.0, 1020.0, 1100.0]),\n            \"intensities\": np.array([0.010, 0.001, 0.002, 0.003, 0.000, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [900.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n        # Test case 3 (edge case with all T  Tc)\n        {\n            \"temps\": np.array([820.0, 900.0, 1000.0]),\n            \"intensities\": np.array([0.002, 0.001, 0.002]),\n            \"sigma\": 0.005,\n            \"tc_bounds\": [700.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n    ]\n\n    all_results = []\n    \n    n_tc = 401\n    n_eta0 = 401\n\n    for case in test_cases:\n        results = compute_posterior_moments(\n            T_obs=case[\"temps\"],\n            I_obs=case[\"intensities\"],\n            sigma=case[\"sigma\"],\n            tc_bounds=case[\"tc_bounds\"],\n            eta0_bounds=case[\"eta0_bounds\"],\n            n_tc=n_tc,\n            n_eta0=n_eta0,\n        )\n        all_results.append(results)\n\n    # Format output as a Python-style list of lists.\n    # The str() representation of a list of lists matches the required output format.\n    print(str(all_results))\n\ndef compute_posterior_moments(T_obs, I_obs, sigma, tc_bounds, eta0_bounds, n_tc, n_eta0):\n    \"\"\"\n    Computes the posterior means and standard deviations for Tc and eta0.\n\n    Args:\n        T_obs (np.ndarray): Observed temperatures in Kelvin.\n        I_obs (np.ndarray): Observed intensities.\n        sigma (float): Standard deviation of Gaussian noise.\n        tc_bounds (list): Prior bounds [min, max] for Tc.\n        eta0_bounds (list): Prior bounds [min, max] for eta0.\n        n_tc (int): Number of grid points for Tc.\n        n_eta0 (int): Number of grid points for eta0.\n\n    Returns:\n        list: [Tc_mean, Tc_std, eta0_mean, eta0_std]\n    \"\"\"\n    # 1. Construct the parameter grid\n    Tc_vals = np.linspace(tc_bounds[0], tc_bounds[1], n_tc)\n    eta0_vals = np.linspace(eta0_bounds[0], eta0_bounds[1], n_eta0)\n\n    # 2. Compute log-likelihood over the grid using broadcasting\n    # Reshape inputs for broadcasting:\n    # T_obs_b: (M, 1, 1), I_obs_b: (M, 1, 1)\n    # Tc_vals_b: (1, n_tc, 1), eta0_vals_b: (1, 1, n_eta0)\n    # M is the number of observations.\n    T_obs_b = T_obs.reshape(-1, 1, 1)\n    I_obs_b = I_obs.reshape(-1, 1, 1)\n    Tc_vals_b = Tc_vals.reshape(1, -1, 1)\n    eta0_vals_b = eta0_vals.reshape(1, 1, --1)\n    \n    # Calculate predicted intensity I_pred, shape (M, n_tc, n_eta0)\n    # This automatically broadcasts the arrays to a common shape.\n    temp_ratio = T_obs_b / Tc_vals_b\n    I_pred = np.where(temp_ratio  1.0, eta0_vals_b**2 * (1.0 - temp_ratio), 0.0)\n\n    # Sum of squared errors, shape (n_tc, n_eta0)\n    sse = np.sum((I_obs_b - I_pred)**2, axis=0)\n\n    # Log-likelihood (propto sum of squared errors), shape (n_tc, n_eta0)\n    log_likelihood_grid = -0.5 * sse / (sigma**2)\n\n    # 3. Compute the unnormalized posterior with a stability trick\n    log_likelihood_grid -= np.max(log_likelihood_grid)\n    unnormalized_posterior = np.exp(log_likelihood_grid)\n\n    # 4. Normalize the posterior\n    # The sum of unnormalized_posterior is proportional to the normalization constant Z.\n    # To get moments, we can use this sum directly.\n    posterior_sum = np.sum(unnormalized_posterior)\n    if posterior_sum == 0:\n        # Avoid division by zero in pathological cases\n        return [np.nan, np.nan, np.nan, np.nan]\n        \n    normalized_posterior_mass = unnormalized_posterior / posterior_sum\n\n    # 5. Compute posterior moments\n    # We need meshgrids for calculating expectations. `indexing='ij'` ensures\n    # the grid corresponds to our (n_tc, n_eta0) array shapes.\n    Tc_grid, eta0_grid = np.meshgrid(Tc_vals, eta0_vals, indexing='ij')\n\n    # Mean of Tc\n    Tc_mean = np.sum(Tc_grid * normalized_posterior_mass)\n    \n    # Mean of eta0\n    eta0_mean = np.sum(eta0_grid * normalized_posterior_mass)\n    \n    # Variance of Tc\n    Tc2_mean = np.sum(Tc_grid**2 * normalized_posterior_mass)\n    Tc_var = Tc2_mean - Tc_mean**2\n    Tc_std = np.sqrt(Tc_var)\n\n    # Variance of eta0\n    eta02_mean = np.sum(eta0_grid**2 * normalized_posterior_mass)\n    eta0_var = eta02_mean - eta0_mean**2\n    eta0_std = np.sqrt(eta0_var)\n\n    return [Tc_mean, Tc_std, eta0_mean, eta0_std]\n\n# Run the main program\nsolve()\n```"
        }
    ]
}