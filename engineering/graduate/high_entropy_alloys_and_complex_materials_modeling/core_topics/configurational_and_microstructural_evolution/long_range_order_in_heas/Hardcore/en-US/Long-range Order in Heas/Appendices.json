{
    "hands_on_practices": [
        {
            "introduction": "The most direct experimental evidence for long-range order (LRO) comes from diffraction experiments, where new Bragg peaks known as superlattice reflections appear. These reflections arise because preferential sublattice occupation creates a larger, more complex repeating unit—a superlattice—than what exists in a random solid solution. This exercise  provides fundamental practice in calculating the crystallographic structure factor, $F_{hkl}$, for such a reflection, allowing you to analytically connect the microscopic LRO parameter, $\\eta$, to this key experimental observable.",
            "id": "3749850",
            "problem": "Consider a quinary high-entropy alloy (HEA) with B2 (Cesium Chloride-type) ordering, which consists of two interpenetrating simple-cubic sublattices: an $\\alpha$ sublattice at fractional coordinates $(0,0,0)$ and a $\\beta$ sublattice at fractional coordinates $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$. The alloy contains five chemical species labeled $A$, $B$, $C$, $D$, and $E$, and is overall equiatomic. Long-range order (LRO) in the alloy is characterized by a scalar order parameter $\\eta$ that biases the site occupancies between the two sublattices while preserving the overall composition. The sublattice site occupancy probabilities are specified as functions of $\\eta$ by\n$$\np_{A}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\alpha}=\\frac{1}{5}+\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\alpha}=\\frac{1}{5}-\\frac{1}{5}\\,\\eta,\n$$\nand\n$$\np_{A}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{B}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{C}^{\\beta}=\\frac{1}{5}-\\frac{2}{15}\\,\\eta,\\quad p_{D}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\\quad p_{E}^{\\beta}=\\frac{1}{5}+\\frac{1}{5}\\,\\eta,\n$$\nwhich ensure $\\sum_{X}p_{X}^{\\alpha}=1$ and $\\sum_{X}p_{X}^{\\beta}=1$ for all $\\eta$, with $X\\in\\{A,B,C,D,E\\}$. Assume species-dependent atomic scattering factors $f_{A},f_{B},f_{C},f_{D},f_{E}$ that are independent of sublattice and constant for the scattering vector magnitude associated with the $(100)$ reflection. Using the first-principles definition of the crystallographic structure factor, derive the analytic expression for the $(100)$-type structure factor amplitude in terms of $f_{A},f_{B},f_{C},f_{D},f_{E}$ and $\\eta$. Express your final answer as a single simplified closed-form expression. No numerical evaluation or rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. All necessary parameters and definitions are provided to derive the requested quantity. The physical model, describing long-range order in a multicomponent alloy via site occupancy probabilities dependent on an order parameter, is a standard and valid approach in computational materials science and solid-state physics. Therefore, the problem is deemed valid and a rigorous solution can be constructed.\n\nThe crystallographic structure factor, denoted as $F_{\\mathbf{G}}$ or $F_{hkl}$, for a scattering vector $\\mathbf{G}$ corresponding to the Miller indices $(hkl)$, is defined as the sum of scattered waves from all atoms within a single unit cell. For a crystal with $N$ atoms in the basis at positions $\\mathbf{r}_j$ with atomic scattering factors $f_j$, the structure factor is given by:\n$$\nF_{hkl} = \\sum_{j=1}^{N} f_j \\exp(2\\pi i (h x_j + k y_j + l z_j))\n$$\nwhere $(x_j, y_j, z_j)$ are the fractional coordinates of atom $j$.\n\nIn the case of a partially ordered alloy, the scattering factor $f_j$ for a specific site $j$ is replaced by the statistical average of the scattering factors of the elements that may occupy that site. This average scattering factor, $\\bar{f}_j$, is calculated by summing the scattering factors of each species $X$, weighted by their respective site occupancy probabilities $p_{X}^{j}$:\n$$\n\\bar{f}_j = \\sum_{X} p_{X}^{j} f_{X}\n$$\n\nThe problem describes a B2-ordered quinary alloy, which has a basis composed of two atoms per unit cell. These atoms are located on two distinct sublattices, $\\alpha$ and $\\beta$. The fractional coordinates for the sites are given as:\n- Sublattice $\\alpha$: $\\mathbf{r}_{\\alpha} = (0, 0, 0)$\n- Sublattice $\\beta$: $\\mathbf{r}_{\\beta} = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n\nThe structure factor can thus be written in terms of the average scattering factors for each sublattice, $\\bar{f}_{\\alpha}$ and $\\bar{f}_{\\beta}$:\n$$\nF_{hkl} = \\bar{f}_{\\alpha} \\exp[2\\pi i (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)] + \\bar{f}_{\\beta} \\exp[2\\pi i (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})]\n$$\nThis simplifies to:\n$$\nF_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta} \\exp[\\pi i (h+k+l)]\n$$\nThe exponential term evaluates to $+1$ if the sum of the Miller indices $(h+k+l)$ is an even integer, and to $-1$ if the sum is an odd integer.\n- For $(h+k+l) = \\text{even}$: $F_{hkl} = \\bar{f}_{\\alpha} + \\bar{f}_{\\beta}$ (Fundamental reflections)\n- For $(h+k+l) = \\text{odd}$: $F_{hkl} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$ (Superlattice reflections)\n\nThe problem requires the calculation of the structure factor for the $(100)$ reflection. For this case, $(h, k, l) = (1, 0, 0)$, and the sum $h+k+l = 1$, which is odd. This corresponds to a superlattice reflection, a signature of the B2 ordering. The structure factor is therefore:\n$$\nF_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}\n$$\n\nWe now must compute the average scattering factors $\\bar{f}_{\\alpha}$ and $\\bar{f}_{\\beta}$ using the provided site occupancy probabilities $p_{X}^{\\gamma}$ for species $X \\in \\{A, B, C, D, E\\}$ on sublattice $\\gamma \\in \\{\\alpha, \\beta\\}$.\n\nThe average scattering factor for the $\\alpha$ sublattice is:\n$$\n\\bar{f}_{\\alpha} = \\sum_{X} p_{X}^{\\alpha} f_{X} = p_{A}^{\\alpha}f_{A} + p_{B}^{\\alpha}f_{B} + p_{C}^{\\alpha}f_{C} + p_{D}^{\\alpha}f_{D} + p_{E}^{\\alpha}f_{E}\n$$\nSubstituting the given expressions for $p_{X}^{\\alpha}$:\n$$\n\\bar{f}_{\\alpha} = \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}+\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}-\\frac{1}{5}\\eta\\right)f_{E}\n$$\nWe can group terms by their dependence on the order parameter $\\eta$:\n$$\n\\bar{f}_{\\alpha} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) + \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\nSimilarly, the average scattering factor for the $\\beta$ sublattice is:\n$$\n\\bar{f}_{\\beta} = \\sum_{X} p_{X}^{\\beta} f_{X} = p_{A}^{\\beta}f_{A} + p_{B}^{\\beta}f_{B} + p_{C}^{\\beta}f_{C} + p_{D}^{\\beta}f_{D} + p_{E}^{\\beta}f_{E}\n$$\nSubstituting the given expressions for $p_{X}^{\\beta}$:\n$$\n\\bar{f}_{\\beta} = \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{A} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{B} + \\left(\\frac{1}{5}-\\frac{2}{15}\\eta\\right)f_{C} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{D} + \\left(\\frac{1}{5}+\\frac{1}{5}\\eta\\right)f_{E}\n$$\nGrouping terms:\n$$\n\\bar{f}_{\\beta} = \\frac{1}{5}(f_{A}+f_{B}+f_{C}+f_{D}+f_{E}) - \\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\n\nNow, we compute the difference $F_{100} = \\bar{f}_{\\alpha} - \\bar{f}_{\\beta}$:\n$$\nF_{100} = \\left[\\frac{1}{5}\\sum_{X}f_{X} + \\eta\\left(\\dots\\right)\\right] - \\left[\\frac{1}{5}\\sum_{X}f_{X} - \\eta\\left(\\dots\\right)\\right]\n$$\nThe terms independent of $\\eta$ cancel, leaving:\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{1}{5}f_{D} - \\frac{1}{5}f_{E}\\right)\n$$\nTo simplify this expression into a single fraction, we find a common denominator, which is $15$. Note that $\\frac{1}{5} = \\frac{3}{15}$.\n$$\nF_{100} = 2\\eta\\left(\\frac{2}{15}f_{A}+\\frac{2}{15}f_{B}+\\frac{2}{15}f_{C} - \\frac{3}{15}f_{D} - \\frac{3}{15}f_{E}\\right)\n$$\nFactoring out the common term $\\frac{1}{15}$:\n$$\nF_{100} = \\frac{2\\eta}{15}(2f_{A}+2f_{B}+2f_{C} - 3f_{D} - 3f_{E})\n$$\nThis expression can be written more compactly by grouping the scattering factors:\n$$\nF_{100} = \\frac{2\\eta}{15}\\left[2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right]\n$$\nThis is the final simplified closed-form expression for the $(100)$ structure factor amplitude. The term \"amplitude\" refers to the value of the structure factor itself, which in this case is a real number. Its magnitude is what determines the intensity of the diffraction peak. The expression correctly shows that the superlattice reflection intensity is zero for a fully disordered alloy ($\\eta=0$) and grows with the degree of long-range order.",
            "answer": "$$\n\\boxed{\\frac{2\\eta}{15}\\left(2(f_{A}+f_{B}+f_{C}) - 3(f_{D}+f_{E})\\right)}\n$$"
        },
        {
            "introduction": "While perfect long-range order is ideally achieved at specific stoichiometric compositions, real-world high-entropy alloys often deviate from these ratios. Understanding how an ordered structure accommodates this off-stoichiometry is crucial for predicting its stability and properties. In this exercise , you will explore the concept of constitutional defects, where excess atoms are forced onto the 'wrong' sublattice, thereby placing a fundamental limit on the maximum achievable order. By deriving the relationship between compositional deviation, $\\delta$, and the LRO parameter, $\\eta$, you will develop a quantitative understanding of the interplay between alloy chemistry and structural order.",
            "id": "3749843",
            "problem": "Consider a High-Entropy Alloy (HEA) exhibiting binary sublattice ordering of two species, denoted $A$ and $B$, on a body-centered cubic sublattice structure of the B2 type with two interpenetrating sublattices $\\alpha$ and $\\beta$ of equal size. The other chemical species present in the HEA, collectively denoted $R$, are chemically neutral with respect to this ordering and distribute randomly and equally over the two sublattices. Let the total mole fraction of the neutral set be $x_{R}$, with $0 \\leq x_{R}  1$. The mole fractions of $A$ and $B$ are $x_{A}$ and $x_{B}$, respectively, satisfying $x_{A} + x_{B} + x_{R} = 1$.\n\nDefine the Long-Range Order (LRO) parameter for the $A$-$B$ ordering as\n$$\n\\eta \\equiv \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}},\n$$\nwhere $p_{A}^{\\alpha}$ and $p_{A}^{\\beta}$ are the probabilities of finding an $A$ atom on a randomly chosen $\\alpha$ or $\\beta$ site, respectively, and the denominator normalizes by the fraction of sites available to the ordering pair $(A,B)$.\n\nAssume a low-temperature regime where thermal antisite defects are negligible and off-stoichiometry is accommodated only through constitutional antisites. Consider deviations from $A$-$B$ stoichiometry at fixed $x_{R}$ given by\n$$\nx_{A} = \\frac{1 - x_{R}}{2} + \\delta, \\quad x_{B} = \\frac{1 - x_{R}}{2} - \\delta,\n$$\nwith $\\delta$ denoting the deviation from equiatomic $A$-$B$ composition within the $(A,B)$ subset and satisfying $|\\delta| \\leq \\frac{1 - x_{R}}{2}$ so that probabilities remain in the physical range $[0,1]$. The neutral set $R$ remains randomly distributed, with $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$.\n\nStarting from the definitions of sublattice occupancy probabilities, the mass-balance constraints, and the physical mechanism of constitutional antisites, derive how LRO persists at off-stoichiometry and compute the resulting reduction in $\\eta$ as a function of the deviation $\\delta$. Express your final answer for $\\eta(\\delta)$ as a closed-form expression in terms of $\\delta$ and $x_{R}$. No numerical evaluation or rounding is required. No units are required for your answer.",
            "solution": "The user-provided problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **System**: A High-Entropy Alloy (HEA) with a body-centered cubic (BCC) B2-type sublattice structure.\n- **Sublattices**: Two interpenetrating sublattices, $\\alpha$ and $\\beta$, of equal size.\n- **Species**: Three types of species: $A$, $B$, and a collective neutral set $R$.\n- **Mole Fractions**: $x_{A}$, $x_{B}$, $x_{R}$, with $x_{A} + x_{B} + x_{R} = 1$ and $0 \\leq x_{R}  1$.\n- **Distribution of R**: The neutral set $R$ distributes randomly and equally over the sublattices, such that $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$, where $p_{S}^{\\sigma}$ is the probability of finding species $S$ on a site of sublattice $\\sigma$.\n- **Long-Range Order (LRO) Parameter Definition**: $\\eta \\equiv \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}}$.\n- **Compositional Deviation**: The mole fractions of $A$ and $B$ are defined in terms of a deviation parameter $\\delta$:\n  $$x_{A} = \\frac{1 - x_{R}}{2} + \\delta$$\n  $$x_{B} = \\frac{1 - x_{R}}{2} - \\delta$$\n  with the constraint $|\\delta| \\leq \\frac{1 - x_{R}}{2}$.\n- **Physical Assumption**: The system is in a low-temperature regime where thermal antisite defects are negligible. Off-stoichiometry is accommodated exclusively through constitutional antisites.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is grounded in the principles of physical metallurgy and statistical mechanics of alloys. The B2 structure, sublattice ordering, constitutional defects, and long-range order are all standard, well-established concepts. Applying these concepts to High-Entropy Alloys is a current and valid area of materials science research.\n2.  **Well-Posed**: The problem is well-posed. It provides a clear definition for the LRO parameter, specifies all necessary mole fractions and their relationships, and states the physical mechanism (constitutional antisites) governing the atomic arrangement. The goal—to derive an expression for $\\eta$ in terms of $\\delta$ and $x_{R}$—is unambiguous and achievable from the provided information.\n3.  **Objective**: The problem is stated in precise, objective, and formal scientific language, free of any subjective or opinion-based claims.\n4.  **Completeness and Consistency**: The definitions and constraints are self-contained and consistent. The sum of mole fractions is unity ($x_A+x_B+x_R = (\\frac{1 - x_{R}}{2} + \\delta) + (\\frac{1 - x_{R}}{2} - \\delta) + x_R = 1 - x_R + x_R = 1$). The constraint on $\\delta$ ensures that the mole fractions $x_A$ and $x_B$ remain non-negative.\n5.  **No Other Flaws**: The problem does not violate any other validation criteria. It is a formalizable and non-trivial problem that requires deductive reasoning based on physical principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A rigorous solution will be formulated.\n\n### Solution Derivation\n\nThe analysis begins by establishing fundamental mass-balance and site-occupancy constraints. The B2 structure consists of two equally sized sublattices, $\\alpha$ and $\\beta$. Thus, the site fraction of each sublattice is $f^{\\alpha} = f^{\\beta} = \\frac{1}{2}$.\n\nThe overall mole fraction $x_S$ of any species $S$ is the weighted average of its occupancy probabilities on the sublattices:\n$$x_{S} = f^{\\alpha} p_{S}^{\\alpha} + f^{\\beta} p_{S}^{\\beta} = \\frac{1}{2} (p_{S}^{\\alpha} + p_{S}^{\\beta})$$\nAdditionally, for any given site on any sublattice, the sum of occupancy probabilities must be unity:\n$$p_{A}^{\\sigma} + p_{B}^{\\sigma} + p_{R}^{\\sigma} = 1 \\quad \\text{for } \\sigma \\in \\{\\alpha, \\beta\\}$$\nThe problem states that the neutral atoms $R$ are distributed randomly, with $p_{R}^{\\alpha} = p_{R}^{\\beta} = x_{R}$. This implies that the fraction of sites on each sublattice available to the ordering species $A$ and $B$ is $1 - x_{R}$.\n$$p_{A}^{\\alpha} + p_{B}^{\\alpha} = 1 - p_{R}^{\\alpha} = 1 - x_{R}$$\n$$p_{A}^{\\beta} + p_{B}^{\\beta} = 1 - p_{R}^{\\beta} = 1 - x_{R}$$\n\nThe core physical assumption is that at low temperatures, ordering is maximized, and off-stoichiometry is accommodated by constitutional antisites. This means the majority species (within the $A$-$B$ pair) occupies all of its \"preferred\" sublattice sites that are not already occupied by the neutral species $R$, and the excess atoms of the majority species occupy sites on the \"other\" sublattice.\n\nBy convention, let the $\\alpha$ sublattice be the preferred sublattice for species $A$, and the $\\beta$ sublattice be the preferred sublattice for species $B$. We must consider two cases based on the sign of $\\delta$.\n\n**Case 1: $\\delta \\ge 0$ (Excess of species A)**\nIn this case, $x_{A} \\ge x_{B}$. Species $A$ is the majority species in the $(A,B)$ subset. According to the constitutional antisite mechanism, species $A$ will fill all available sites on its preferred sublattice, $\\alpha$. The number of $\\alpha$-sites available to the $(A,B)$ pair is $1 - x_R$. Thus, the occupancy of $A$ on $\\alpha$ is maximized:\n$$p_{A}^{\\alpha} = 1 - x_{R}$$\nSince the available $\\alpha$-sites are completely filled by $A$, the occupancy of the minority species $B$ on the $\\alpha$ sublattice must be zero:\n$$p_{B}^{\\alpha} = 0$$\nNext, we determine the occupations on the $\\beta$ sublattice. Using the mass-balance equation for species $A$:\n$$x_{A} = \\frac{1}{2} (p_{A}^{\\alpha} + p_{A}^{\\beta})$$\nSubstituting the expressions for $x_A$ and $p_A^\\alpha$:\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1}{2} ((1 - x_{R}) + p_{A}^{\\beta})$$\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1 - x_{R}}{2} + \\frac{1}{2} p_{A}^{\\beta}$$\nThis simplifies to $\\delta = \\frac{1}{2} p_{A}^{\\beta}$, which yields the probability of finding a constitutional antisite $A$ atom on the $\\beta$ sublattice:\n$$p_{A}^{\\beta} = 2\\delta$$\nThe occupancy of $B$ on the $\\beta$ sublattice, $p_{B}^{\\beta}$, can be found from the site-sum rule on $\\beta$:\n$$p_{A}^{\\beta} + p_{B}^{\\beta} + p_{R}^{\\beta} = 1$$\n$$2\\delta + p_{B}^{\\beta} + x_{R} = 1$$\n$$p_{B}^{\\beta} = 1 - x_{R} - 2\\delta$$\nThis result is consistent with the mass balance for $B$: $x_B = \\frac{1}{2}(p_B^\\alpha+p_B^\\beta) = \\frac{1}{2}(0 + 1-x_R-2\\delta) = \\frac{1-x_R}{2} - \\delta$.\n\nWith these probabilities, the LRO parameter $\\eta$ for $\\delta \\ge 0$ is:\n$$\\eta = \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}} = \\frac{(1 - x_{R}) - (2\\delta)}{1 - x_{R}} = 1 - \\frac{2\\delta}{1 - x_{R}}$$\n\n**Case 2: $\\delta  0$ (Excess of species B)**\nIn this case, $x_{B}  x_{A}$. Species $B$ is the majority species in the $(A,B)$ subset. It will fill all available sites on its preferred sublattice, $\\beta$.\n$$p_{B}^{\\beta} = 1 - x_{R}$$\nThis implies that the occupancy of the minority species $A$ on the $\\beta$ sublattice must be zero:\n$$p_{A}^{\\beta} = 0$$\nNow, we use the mass balance for species $A$ to find $p_A^\\alpha$:\n$$x_{A} = \\frac{1}{2} (p_{A}^{\\alpha} + p_{A}^{\\beta})$$\n$$\\frac{1 - x_{R}}{2} + \\delta = \\frac{1}{2} (p_{A}^{\\alpha} + 0)$$\n$$p_{A}^{\\alpha} = 2 \\left(\\frac{1 - x_{R}}{2} + \\delta\\right) = 1 - x_{R} + 2\\delta$$\nThe occupancy of $B$ on the $\\alpha$ sublattice, $p_{B}^{\\alpha}$, consists of constitutional antisites. From the site-sum rule on $\\alpha$:\n$$p_{A}^{\\alpha} + p_{B}^{\\alpha} + p_{R}^{\\alpha} = 1$$\n$$(1 - x_{R} + 2\\delta) + p_{B}^{\\alpha} + x_{R} = 1$$\n$$p_{B}^{\\alpha} = -2\\delta$$\nSince $\\delta  0$, $p_{B}^{\\alpha}$ is positive, which is physically correct. This result is also consistent with the mass balance for $B$: $x_B = \\frac{1}{2}(p_B^\\alpha+p_B^\\beta) = \\frac{1}{2}(-2\\delta + 1-x_R) = \\frac{1-x_R}{2} - \\delta$.\n\nThe LRO parameter $\\eta$ for $\\delta  0$ is:\n$$\\eta = \\frac{p_{A}^{\\alpha} - p_{A}^{\\beta}}{1 - x_{R}} = \\frac{(1 - x_{R} + 2\\delta) - 0}{1 - x_{R}} = 1 + \\frac{2\\delta}{1 - x_{R}}$$\n\n**General Expression**\nThe two cases can be unified into a single expression using the absolute value function, $|\\delta|$.\nFor $\\delta \\ge 0$, we have $|\\delta| = \\delta$, so $\\eta = 1 - \\frac{2|\\delta|}{1 - x_{R}}$.\nFor $\\delta  0$, we have $|\\delta| = -\\delta$, so $\\eta = 1 + \\frac{2\\delta}{1 - x_{R}} = 1 - \\frac{2(-\\delta)}{1-x_R} = 1 - \\frac{2|\\delta|}{1 - x_{R}}$.\nBoth cases are described by the same formula. The reduction in LRO is directly proportional to the magnitude of the stoichiometric deviation, $|\\delta|$, and inversely proportional to the fraction of ordering sites, $1-x_R$. At stoichiometry ($\\delta=0$), $\\eta=1$, representing perfect order within the $(A,B)$ subset. At maximum off-stoichiometry ($|\\delta| = \\frac{1-x_R}{2}$), $\\eta=0$, as one of the species vanishes and the concept of order becomes meaningless.\n\nThe final expression for the LRO parameter as a function of $\\delta$ and $x_R$ is:\n$$\\eta(\\delta, x_{R}) = 1 - \\frac{2|\\delta|}{1 - x_{R}}$$",
            "answer": "$$ \\boxed{1 - \\frac{2|\\delta|}{1 - x_{R}}} $$"
        },
        {
            "introduction": "The degree of long-range order is not static; it diminishes with increasing temperature and vanishes at a critical temperature, $T_c$. This order-disorder transition can be described by physical models like Landau theory, but extracting key parameters from noisy experimental data requires a robust statistical approach. This advanced coding exercise  places you in the role of a computational materials scientist, challenging you to implement a Bayesian inference framework to analyze simulated diffraction data. You will develop a complete program to estimate $T_c$ and the zero-temperature order parameter amplitude, $\\eta_0$, demonstrating how to bridge the gap between theoretical models and modern data analysis.",
            "id": "3749823",
            "problem": "Consider a High-Entropy Alloy (HEA) with Long-Range Order (LRO) driven by a continuous order-disorder transition. Let the intensive scalar order parameter be denoted by $\\eta(T)$, defined as the difference in sublattice occupations, and assume that its equilibrium behavior near the transition is captured by a Landau free energy $F(\\eta,T)$ of the form\n$$\nF(\\eta,T) = a\\,(T - T_c)\\,\\eta^2 + b\\,\\eta^4,\n$$\nwhere $a0$, $b0$ and $T_c$ is the critical temperature expressed in Kelvin. For $TT_c$, equilibrium minimizes $F(\\eta,T)$ with respect to $\\eta$, and for $T\\geq T_c$ the equilibrium value is $\\eta(T)=0$. The integrated intensity of a superlattice diffraction peak is modeled as being proportional to the square of the order parameter, which is a well-tested relationship in diffraction of ordered alloys, so that the predicted intensity at temperature $T$ is $I_{\\text{pred}}(T) = \\eta^2(T)$. Measurements of intensity $I(T_i)$ at discrete temperatures $T_i$ are corrupted by additive independent Gaussian noise $\\varepsilon_i$ of known standard deviation $\\sigma$, with $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$.\n\nStarting from these fundamental bases and facts, derive a Bayesian framework to infer the posterior distribution of $(T_c,\\eta_0)$ given observed intensities $\\{I(T_i)\\}$, where $\\eta_0$ is defined by the Landau solution as the zero-temperature order parameter amplitude,\n$$\n\\eta_0 = \\sqrt{\\frac{a\\,T_c}{2b}},\n$$\nand the mean-field solution yields\n$$\n\\eta(T) =\n\\begin{cases}\n\\eta_0 \\sqrt{1 - \\frac{T}{T_c}},  T  T_c, \\\\\n0,  T \\ge T_c.\n\\end{cases}\n$$\nAssume uniform priors on $T_c$ over a specified interval $[T_{\\min},T_{\\max}]$ in Kelvin and on $\\eta_0$ over a specified interval $[\\eta_{\\min},\\eta_{\\max}]$ (dimensionless). The likelihood of the data under parameters $(T_c,\\eta_0)$ is the product of Gaussian densities with mean $I_{\\text{pred}}(T_i)$ and standard deviation $\\sigma$.\n\nYour task is to implement a complete program that:\n- Constructs a uniform grid over $(T_c,\\eta_0)$ on the specified bounds.\n- Computes the unnormalized posterior over this grid using the Gaussian likelihood and uniform priors.\n- Numerically normalizes the posterior by approximating the integral with a Riemann sum over the grid cell area.\n- Outputs, for each test case, four quantities: the posterior mean of $T_c$ in Kelvin, the posterior standard deviation of $T_c$ in Kelvin, the posterior mean of $\\eta_0$ (dimensionless), and the posterior standard deviation of $\\eta_0$ (dimensionless).\n\nScientific realism requirements:\n- All temperatures must be treated in Kelvin and any outputs involving temperature must be in Kelvin.\n- Intensities are dimensionless.\n- Angles do not appear in this problem.\n- Percentages must not be used.\n\nTest suite:\nUse the following three test cases. Each test case provides $(T_i)$, observed intensities $I(T_i)$, the noise level $\\sigma$, and the uniform prior bounds for $T_c$ and $\\eta_0$. The arrays are to be used exactly as provided.\n\n- Test case $1$ (general case with mixed temperatures below and above $T_c$ and moderate noise):\n  - Temperatures $T$ in Kelvin: $[300.0, 500.0, 700.0, 820.0, 880.0, 910.0, 950.0]$.\n  - Observed intensities $I$: $[0.245, 0.158, 0.082, 0.034, 0.009, 0.002, 0.001]$.\n  - Noise standard deviation $\\sigma$: $0.01$.\n  - Prior bounds: $T_c \\in [600.0, 1100.0]$ Kelvin, $\\eta_0 \\in [0.1, 1.0]$ (dimensionless).\n\n- Test case $2$ (near-critical and high-noise regime):\n  - Temperatures $T$ in Kelvin: $[950.0, 980.0, 990.0, 1005.0, 1020.0, 1100.0]$.\n  - Observed intensities $I$: $[0.010, 0.001, 0.002, 0.003, 0.000, 0.001]$.\n  - Noise standard deviation $\\sigma$: $0.01$.\n  - Prior bounds: $T_c \\in [900.0, 1200.0]$ Kelvin, $\\eta_0 \\in [0.1, 0.8]$ (dimensionless).\n\n- Test case $3$ (edge case with all temperatures above the true $T_c$):\n  - Temperatures $T$ in Kelvin: $[820.0, 900.0, 1000.0]$.\n  - Observed intensities $I$: $[0.002, 0.001, 0.002]$.\n  - Noise standard deviation $\\sigma$: $0.005$.\n  - Prior bounds: $T_c \\in [700.0, 1200.0]$ Kelvin, $\\eta_0 \\in [0.1, 0.8]$ (dimensionless).\n\nAlgorithmic and output requirements:\n- Use a rectangular grid with $n_{T_c}$ points uniformly spanning $[T_{\\min},T_{\\max}]$ and $n_{\\eta_0}$ points uniformly spanning $[\\eta_{\\min},\\eta_{\\max}]$ for each test case. Use $n_{T_c} = 401$ and $n_{\\eta_0} = 401$.\n- For each grid point $(T_c,\\eta_0)$, compute the predicted intensities $I_{\\text{pred}}(T_i)$ according to the mean-field solution above, then compute the Gaussian log-likelihood over all $i$ and exponentiate after subtracting the maximum log-likelihood on the grid to maintain numerical stability.\n- Normalize the posterior using the grid cell area $\\Delta T_c \\cdot \\Delta \\eta_0$ to approximate integrals.\n- Compute posterior means and standard deviations via discrete sums over the normalized posterior.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, one inner list per test case, in the order $[T_c\\_\\text{mean},T_c\\_\\text{std},\\eta_0\\_\\text{mean},\\eta_0\\_\\text{std}]$, for all test cases combined, for example: $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],[x_3,y_3,z_3,w_3]]$.",
            "solution": "The problem requires the determination of the posterior probability distribution for the parameters $(T_c, \\eta_0)$ of a model for long-range order in a high-entropy alloy, given a set of experimental measurements. The parameters are the critical temperature $T_c$ and the zero-temperature order parameter amplitude $\\eta_0$. The solution employs a Bayesian framework on a discrete parameter grid.\n\n**1. Bayesian Framework**\n\nThe foundation of the analysis is Bayes' theorem, which relates the posterior probability of the parameters $\\theta = (T_c, \\eta_0)$ to the likelihood of the data and the prior probability of the parameters:\n$$\np(\\theta | \\{I_i\\}) \\propto p(\\{I_i\\} | \\theta) \\cdot p(\\theta)\n$$\nHere, $p(\\theta | \\{I_i\\})$ is the posterior distribution given the observed intensities $\\{I_i\\}$, $p(\\{I_i\\} | \\theta)$ is the likelihood of observing the data given the parameters, and $p(\\theta)$ is the prior distribution of the parameters.\n\n**2. Prior Distribution**\n\nThe problem specifies independent uniform priors for $T_c$ and $\\eta_0$ over their respective intervals:\n$$\np(T_c) = \\begin{cases} \\frac{1}{T_{\\max} - T_{\\min}}  \\text{if } T_c \\in [T_{\\min}, T_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n$$\np(\\eta_0) = \\begin{cases} \\frac{1}{\\eta_{\\max} - \\eta_{\\min}}  \\text{if } \\eta_0 \\in [\\eta_{\\min}, \\eta_{\\max}] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe joint prior is $p(\\theta) = p(T_c, \\eta_0) = p(T_c)p(\\eta_0)$, which is a constant value within the rectangular domain defined by the prior bounds and zero elsewhere.\n\n**3. Likelihood Function**\n\nThe model for the predicted intensity $I_{\\text{pred}}$ at a temperature $T$ is given by the square of the order parameter $\\eta(T)$:\n$$\nI_{\\text{pred}}(T; T_c, \\eta_0) = \\eta^2(T) =\n\\begin{cases}\n\\eta_0^2 \\left(1 - \\frac{T}{T_c}\\right),  T  T_c \\\\\n0,  T \\ge T_c\n\\end{cases}\n$$\nThe measurements $I(T_i)$ are corrupted by additive, independent Gaussian noise $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$. The likelihood of observing a single data point $I_i = I(T_i)$ is therefore given by the Gaussian probability density function:\n$$\np(I_i | T_c, \\eta_0) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\nSince the noise terms are independent, the total likelihood for the dataset $\\{I_i\\}$ is the product of the individual likelihoods:\n$$\np(\\{I_i\\} | T_c, \\eta_0) = \\prod_i p(I_i | T_c, \\eta_0)\n$$\nFor computational purposes, it is more convenient to work with the log-likelihood, $\\mathcal{L}(T_c, \\eta_0) = \\log p(\\{I_i\\} | T_c, \\eta_0)$:\n$$\n\\mathcal{L}(T_c, \\eta_0) = \\sum_i \\left( -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2}{2\\sigma^2} \\right)\n$$\nWhen finding the shape of the posterior, terms constant with respect to the parameters $(T_c, \\eta_0)$ can be dropped. Thus, we focus on the term proportional to the sum of squared errors:\n$$\n\\mathcal{L}(T_c, \\eta_0) \\propto -\\frac{1}{2\\sigma^2} \\sum_i (I_i - I_{\\text{pred}}(T_i; T_c, \\eta_0))^2\n$$\n\n**4. Numerical Posterior Computation**\n\nThe posterior distribution is computed numerically on a discrete grid.\n\n- **Grid Construction**: The continuous parameter space is discretized into a uniform grid of size $n_{T_c} \\times n_{\\eta_0}$, where $n_{T_c} = 401$ and $n_{\\eta_0} = 401$. The grid points are $(T_{c,j}, \\eta_{0,k})$ for $j=0, \\dots, n_{T_c}-1$ and $k=0, \\dots, n_{\\eta_0}-1$. The grid steps are $\\Delta T_c = (T_{\\max} - T_{\\min}) / (n_{T_c}-1)$ and $\\Delta \\eta_0 = (\\eta_{\\max} - \\eta_{\\min}) / (n_{\\eta_0}-1)$.\n\n- **Posterior Calculation**: The unnormalized posterior is proportional to the likelihood, since the prior is uniform on the grid. We compute the log-likelihood $\\mathcal{L}_{jk} = \\mathcal{L}(T_{c,j}, \\eta_{0,k})$ at each grid point. To avoid numerical underflow during exponentiation, we use the standard stability trick:\n$$\nP'_{jk} = \\exp(\\mathcal{L}_{jk} - \\mathcal{L}_{\\max})\n$$\nwhere $\\mathcal{L}_{\\max} = \\max_{j,k} (\\mathcal{L}_{jk})$.\n\n- **Normalization**: The posterior must be normalized to integrate to one. We approximate the normalization integral (the evidence, $Z$) with a Riemann sum over the grid:\n$$\nZ = \\int_{T_{\\min}}^{T_{\\max}} \\int_{\\eta_{\\min}}^{\\eta_{\\max}} p(\\{I_i\\}|T_c, \\eta_0) p(T_c, \\eta_0) \\, d\\eta_0 \\, dT_c \\approx C \\sum_{j,k} P'_{jk} \\Delta T_c \\Delta \\eta_0\n$$\nwhere $C$ is a proportionality constant. The normalized posterior probability mass at each grid point is:\n$$\nP_{jk} = \\frac{P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\nThe corresponding probability density is $p_{jk} = P_{jk} / (\\Delta T_c \\Delta \\eta_0)$.\n\n**5. Moment Calculation**\n\nThe posterior mean and standard deviation of each parameter are calculated by approximating the expectation integrals with discrete sums over the normalized grid. For a general parameter $\\theta$, its posterior mean is:\n$$\n\\langle \\theta \\rangle = E[\\theta | \\{I_i\\}] = \\iint \\theta \\cdot p(\\theta' | \\{I_i\\}) \\, d\\theta' \\approx \\sum_{j,k} \\theta_{jk} \\cdot P_{jk}\n$$\nThe posterior variance is:\n$$\n\\text{Var}(\\theta) = E[\\theta^2 | \\{I_i\\}] - \\langle \\theta \\rangle^2 \\approx \\left(\\sum_{j,k} \\theta_{jk}^2 \\cdot P_{jk}\\right) - \\langle \\theta \\rangle^2\n$$\nThe posterior standard deviation is $\\sigma_\\theta = \\sqrt{\\text{Var}(\\theta)}$. These summations are implemented to find the required statistics for $T_c$ and $\\eta_0$. For $T_c$:\n$$\n\\langle T_c \\rangle = \\frac{\\sum_{j,k} T_{c,j} \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\langle T_c^2 \\rangle = \\frac{\\sum_{j,k} T_{c,j}^2 \\cdot P'_{jk}}{\\sum_{j,k} P'_{jk}}\n$$\n$$\n\\sigma_{T_c} = \\sqrt{\\langle T_c^2 \\rangle - \\langle T_c \\rangle^2}\n$$\nAnalogous expressions are used for $\\eta_0$.\nThe implementation uses vectorized NumPy operations for efficiency. The arrays of observation temperatures and intensities are broadcast against the parameter grid to compute the sum of squared errors across all data points for each parameter pair $(T_c, \\eta_0)$ simultaneously.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Bayesian inference for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"temps\": np.array([300.0, 500.0, 700.0, 820.0, 880.0, 910.0, 950.0]),\n            \"intensities\": np.array([0.245, 0.158, 0.082, 0.034, 0.009, 0.002, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [600.0, 1100.0],\n            \"eta0_bounds\": [0.1, 1.0],\n        },\n        # Test case 2 (near-critical and high-noise)\n        {\n            \"temps\": np.array([950.0, 980.0, 990.0, 1005.0, 1020.0, 1100.0]),\n            \"intensities\": np.array([0.010, 0.001, 0.002, 0.003, 0.000, 0.001]),\n            \"sigma\": 0.01,\n            \"tc_bounds\": [900.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n        # Test case 3 (edge case with all T  Tc)\n        {\n            \"temps\": np.array([820.0, 900.0, 1000.0]),\n            \"intensities\": np.array([0.002, 0.001, 0.002]),\n            \"sigma\": 0.005,\n            \"tc_bounds\": [700.0, 1200.0],\n            \"eta0_bounds\": [0.1, 0.8],\n        },\n    ]\n\n    all_results = []\n    \n    n_tc = 401\n    n_eta0 = 401\n\n    for case in test_cases:\n        results = compute_posterior_moments(\n            T_obs=case[\"temps\"],\n            I_obs=case[\"intensities\"],\n            sigma=case[\"sigma\"],\n            tc_bounds=case[\"tc_bounds\"],\n            eta0_bounds=case[\"eta0_bounds\"],\n            n_tc=n_tc,\n            n_eta0=n_eta0,\n        )\n        all_results.append(results)\n\n    # Format output as a Python-style list of lists.\n    # The str() representation of a list of lists matches the required output format.\n    print(str(all_results))\n\ndef compute_posterior_moments(T_obs, I_obs, sigma, tc_bounds, eta0_bounds, n_tc, n_eta0):\n    \"\"\"\n    Computes the posterior means and standard deviations for Tc and eta0.\n\n    Args:\n        T_obs (np.ndarray): Observed temperatures in Kelvin.\n        I_obs (np.ndarray): Observed intensities.\n        sigma (float): Standard deviation of Gaussian noise.\n        tc_bounds (list): Prior bounds [min, max] for Tc.\n        eta0_bounds (list): Prior bounds [min, max] for eta0.\n        n_tc (int): Number of grid points for Tc.\n        n_eta0 (int): Number of grid points for eta0.\n\n    Returns:\n        list: [Tc_mean, Tc_std, eta0_mean, eta0_std]\n    \"\"\"\n    # 1. Construct the parameter grid\n    Tc_vals = np.linspace(tc_bounds[0], tc_bounds[1], n_tc)\n    eta0_vals = np.linspace(eta0_bounds[0], eta0_bounds[1], n_eta0)\n\n    # 2. Compute log-likelihood over the grid using broadcasting\n    # Reshape inputs for broadcasting:\n    # T_obs_b: (M, 1, 1), I_obs_b: (M, 1, 1)\n    # Tc_vals_b: (1, n_tc, 1), eta0_vals_b: (1, 1, n_eta0)\n    # M is the number of observations.\n    T_obs_b = T_obs.reshape(-1, 1, 1)\n    I_obs_b = I_obs.reshape(-1, 1, 1)\n    Tc_vals_b = Tc_vals.reshape(1, -1, 1)\n    eta0_vals_b = eta0_vals.reshape(1, 1, -1)\n    \n    # Calculate predicted intensity I_pred, shape (M, n_tc, n_eta0)\n    # This automatically broadcasts the arrays to a common shape.\n    temp_ratio = T_obs_b / Tc_vals_b\n    I_pred = np.where(temp_ratio  1.0, eta0_vals_b**2 * (1.0 - temp_ratio), 0.0)\n\n    # Sum of squared errors, shape (n_tc, n_eta0)\n    sse = np.sum((I_obs_b - I_pred)**2, axis=0)\n\n    # Log-likelihood (propto sum of squared errors), shape (n_tc, n_eta0)\n    log_likelihood_grid = -0.5 * sse / (sigma**2)\n\n    # 3. Compute the unnormalized posterior with a stability trick\n    log_likelihood_grid -= np.max(log_likelihood_grid)\n    unnormalized_posterior = np.exp(log_likelihood_grid)\n\n    # 4. Normalize the posterior\n    # The sum of unnormalized_posterior is proportional to the normalization constant Z.\n    # To get moments, we can use this sum directly.\n    posterior_sum = np.sum(unnormalized_posterior)\n    if posterior_sum == 0:\n        # Avoid division by zero in pathological cases\n        return [np.nan, np.nan, np.nan, np.nan]\n        \n    normalized_posterior_mass = unnormalized_posterior / posterior_sum\n\n    # 5. Compute posterior moments\n    # We need meshgrids for calculating expectations. `indexing='ij'` ensures\n    # the grid corresponds to our (n_tc, n_eta0) array shapes.\n    Tc_grid, eta0_grid = np.meshgrid(Tc_vals, eta0_vals, indexing='ij')\n\n    # Mean of Tc\n    Tc_mean = np.sum(Tc_grid * normalized_posterior_mass)\n    \n    # Mean of eta0\n    eta0_mean = np.sum(eta0_grid * normalized_posterior_mass)\n    \n    # Variance of Tc\n    Tc2_mean = np.sum(Tc_grid**2 * normalized_posterior_mass)\n    Tc_var = Tc2_mean - Tc_mean**2\n    Tc_std = np.sqrt(Tc_var)\n\n    # Variance of eta0\n    eta02_mean = np.sum(eta0_grid**2 * normalized_posterior_mass)\n    eta0_var = eta02_mean - eta0_mean**2\n    eta0_std = np.sqrt(eta0_var)\n\n    return [Tc_mean, Tc_std, eta0_mean, eta0_std]\n\n# Run the main program\nsolve()\n```"
        }
    ]
}