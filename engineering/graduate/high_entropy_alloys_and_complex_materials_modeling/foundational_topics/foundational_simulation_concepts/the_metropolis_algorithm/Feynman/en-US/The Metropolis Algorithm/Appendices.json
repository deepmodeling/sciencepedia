{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Metropolis algorithm is its acceptance criterion, which ensures that the resulting Markov chain correctly samples the desired target distribution. This first exercise isolates this core mechanism from the other complexities of a full simulation. By directly calculating the acceptance probability for a single proposed move, you will solidify your understanding of how the algorithm balances exploration of the state space with the need to favor more probable states. ",
            "id": "1371728",
            "problem": "A data scientist is implementing a Markov Chain Monte Carlo (MCMC) simulation to draw samples from a posterior probability distribution for a parameter $x$. The target distribution, $\\pi(x)$, is proportional to the exponential of the negative absolute value of the parameter, such that $\\pi(x) \\propto \\exp(-|x|)$.\n\nThe scientist uses the Metropolis algorithm with a symmetric proposal distribution $q(x'|x)$, where the probability of proposing a new state $x'$ given the current state $x$ is equal to the probability of proposing $x$ given $x'$ (i.e., $q(x'|x) = q(x|x')$).\n\nSuppose that at a certain step in the simulation, the current state of the chain is $x = 1.5$. The algorithm then proposes a move to a new candidate state $x' = 2.0$.\n\nCalculate the acceptance probability for this specific move. Your answer should be a dimensionless real number. Round your final answer to four significant figures.",
            "solution": "The Metropolis acceptance probability for a move from $x$ to $x'$ with a symmetric proposal $q(x'|x)=q(x|x')$ is\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\nGiven the target distribution $\\pi(x)\\propto \\exp(-|x|)$, the ratio simplifies to\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\nWith $x=1.5$ and $x'=2.0$, we have $|x|=1.5$ and $|x'|=2.0$, so\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\nTherefore,\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\nNumerically, $\\exp(-0.5)\\approx 0.6065$ when rounded to four significant figures.",
            "answer": "$$\\boxed{0.6065}$$"
        },
        {
            "introduction": "Building on the fundamental acceptance rule, this practice applies the Metropolis algorithm to a simple yet illustrative physical system: a particle on a one-dimensional lattice. The problem sets up an energy landscape with a distinct barrier, allowing you to compare the probabilities of moving \"uphill\" into a high-energy region versus moving \"downhill\" to a lower-energy state. This exercise provides a tangible link between the abstract probabilities of the algorithm and the physical concepts of energy, temperature, and thermal fluctuations that govern systems in statistical mechanics. ",
            "id": "2006008",
            "problem": "A single particle is confined to a one-dimensional lattice consisting of 10 sites, which are indexed by $i = 0, 1, 2, \\dots, 9$. The lattice employs periodic boundary conditions, which means that site $i=9$ is adjacent to site $i=0$. The energy of the particle, $E(i)$, is dependent on its position on the lattice. Specifically, the energy is a positive constant $\\epsilon$ for sites $i \\in \\{3, 4, 5\\}$, and it is zero for all other sites.\n\nThe system is maintained at a constant temperature $T$ and is simulated using the Metropolis algorithm. In this simulation, the algorithm proposes moves for the particle to an adjacent site. The proposal distribution is symmetric, meaning the probability of proposing a move from site $i$ to an adjacent site $j$ is the same as proposing a move from $j$ to $i$.\n\nWe consider two specific elementary moves:\n1.  **Move A**: The particle attempts to move from its current position at site $i_A = 2$ to the adjacent site $j_A = 3$.\n2.  **Move B**: The particle attempts to move from its current position at site $i_B = 5$ to the adjacent site $j_B = 6$.\n\nLet $P_A$ be the acceptance probability for Move A and $P_B$ be the acceptance probability for Move B, according to the Metropolis acceptance criterion.\n\nDetermine the ratio $\\frac{P_B}{P_A}$ as an analytic expression in terms of $\\epsilon$, $T$, and the Boltzmann constant $k_B$.",
            "solution": "For a Metropolis update with a symmetric proposal distribution, the acceptance probability to move from site $i$ to site $j$ is\n$$\nP_{\\text{acc}}(i\\to j)=\\min\\left(1,\\exp\\left(-\\beta\\left[E(j)-E(i)\\right]\\right)\\right),\n$$\nwhere $\\beta=\\frac{1}{k_{B}T}$.\n\nEnergies on the lattice are $E(i)=\\epsilon$ for $i\\in\\{3,4,5\\}$ and $E(i)=0$ otherwise.\n\nFor Move A: $i_{A}=2$ and $j_{A}=3$. Then $E(2)=0$ and $E(3)=\\epsilon$, so\n$$\n\\Delta E_{A}=E(3)-E(2)=\\epsilon.\n$$\nThus,\n$$\nP_{A}=\\min\\left(1,\\exp\\left(-\\beta\\epsilon\\right)\\right)=\\exp\\left(-\\frac{\\epsilon}{k_{B}T}\\right),\n$$\nsince $\\epsilon0$ implies $\\exp(-\\beta\\epsilon)1$.\n\nFor Move B: $i_{B}=5$ and $j_{B}=6$. Then $E(5)=\\epsilon$ and $E(6)=0$, so\n$$\n\\Delta E_{B}=E(6)-E(5)=-\\epsilon.\n$$\nThus,\n$$\nP_{B}=\\min\\left(1,\\exp\\left(-\\beta(-\\epsilon)\\right)\\right)=\\min\\left(1,\\exp\\left(\\beta\\epsilon\\right)\\right)=1.\n$$\n\nTherefore, the ratio is\n$$\n\\frac{P_{B}}{P_{A}}=\\frac{1}{\\exp\\left(-\\frac{\\epsilon}{k_{B}T}\\right)}=\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right).\n$$",
            "answer": "$$\\boxed{\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}$$"
        },
        {
            "introduction": "A true Monte Carlo simulation consists of a long sequence of these elementary steps, generating a trajectory through the system's state space. This final practice offers a hands-on walk-through of a short, five-step Metropolis simulation for a particle in a double-well potential, a classic model for systems with multiple stable states. By manually tracing the particle's path, you will see how the interplay of proposed moves and probabilistic acceptance allows the system to explore its energy landscape and can reveal important phenomena like metastability and thermal activation over barriers. ",
            "id": "2005950",
            "problem": "A nanotechnologist is studying a molecular switch whose state can be represented by the one-dimensional position, $x$, of a particle. The potential energy of the particle, in arbitrary units, is described by the double-well potential function $U(x) = \\alpha x^4 - \\gamma x^2$, with constants $\\alpha = 1.0$ and $\\gamma = 8.0$. The particle is in contact with a heat bath, and its behavior can be modeled using a Monte Carlo simulation based on the Metropolis algorithm. The system is characterized by a constant inverse temperature $\\beta = \\frac{1}{k_B T} = 2.0$.\n\nThe simulation proceeds in discrete steps. At each step, a trial move is proposed by changing the particle's current position $x_{current}$ to a new position $x_{trial} = x_{current} + \\Delta x$. The displacement $\\Delta x$ is a pre-determined random value. This proposed move is then accepted or rejected based on the Metropolis criterion:\n1. If the change in energy, $\\Delta U = U(x_{trial}) - U(x_{current})$, is less than or equal to zero, the move is always accepted.\n2. If $\\Delta U  0$, the move is accepted with a probability $P_{accept} = \\exp(-\\beta \\Delta U)$. To implement this, a random number $r$ is drawn from a uniform distribution on $[0,1)$. If $r  P_{accept}$, the move is accepted; otherwise, it is rejected.\n3. If a move is accepted, the new position is $x_{trial}$. If it is rejected, the particle remains at $x_{current}$.\n\nThe particle is initially placed at the position corresponding to the *negative-valued* local minimum of the potential energy function $U(x)$. You are to calculate the position of the particle after exactly 5 Metropolis steps.\n\nYou are provided with the following two sequences of 5 pre-determined random numbers:\n- Sequence of proposed step displacements, $\\Delta x$: $\\{0.30, -0.40, 0.10, 0.20, -0.25\\}$\n- Sequence of random numbers for acceptance check, $r$: $\\{0.51, 0.12, 0.65, 0.83, 0.47\\}$\n\nCalculate the final position of the particle after these 5 steps. Report your answer as a numerical value, rounded to three significant figures.",
            "solution": "The potential energy is given by $U(x)=\\alpha x^{4}-\\gamma x^{2}$ with $\\alpha=1$ and $\\gamma=8$, so $U(x)=x^{4}-8x^{2}$. The stationary points satisfy $U'(x)=4x^{3}-16x=4x(x^{2}-4)=0$, giving $x=0,\\pm 2$. The second derivative $U''(x)=12x^{2}-16$ yields $U''(0)=-160$ (a local maximum) and $U''(\\pm 2)=320$ (local minima). The particle starts at the negative-valued minimum, so $x_{0}=-2$.\n\nAt each Metropolis step, with proposed displacement $\\Delta x$, the trial position is $x_{\\text{trial}}=x_{\\text{current}}+\\Delta x$, the energy change is $\\Delta U=U(x_{\\text{trial}})-U(x_{\\text{current}})$, and the move is accepted if either $\\Delta U\\leq 0$ or, if $\\Delta U0$, with probability $P_{\\text{accept}}=\\exp(-\\beta\\Delta U)$ where $\\beta=2$. Acceptance is implemented by comparing a uniform $r$ to $P_{\\text{accept}}$.\n\nStep 1: $\\Delta x=0.30$.\n$$x_{\\text{trial}}=-2+0.30=-1.70,$$\n$$U(-2)=(-2)^{4}-8(-2)^{2}=16-32=-16,$$\n$$U(-1.7)=(-1.7)^{4}-8(-1.7)^{2}=8.3521-8\\cdot 2.89=8.3521-23.12=-14.7679,$$\n$$\\Delta U=-14.7679-(-16)=1.23210,$$\n$$P_{\\text{accept}}=\\exp(-2\\cdot 1.2321)=\\exp(-2.4642)\\approx 0.085.$$\nGiven $r=0.51$, $rP_{\\text{accept}}$, so reject. Thus $x$ remains $-2$.\n\nStep 2: $\\Delta x=-0.40$.\n$$x_{\\text{trial}}=-2-0.40=-2.40,$$\n$$U(-2.4)=(-2.4)^{4}-8(-2.4)^{2}=33.1776-8\\cdot 5.76=33.1776-46.08=-12.9024,$$\n$$\\Delta U=-12.9024-(-16)=3.09760,$$\n$$P_{\\text{accept}}=\\exp(-2\\cdot 3.0976)=\\exp(-6.1952)\\approx 2.0\\times 10^{-3}.$$\nGiven $r=0.12$, $rP_{\\text{accept}}$, so reject. Thus $x$ remains $-2$.\n\nStep 3: $\\Delta x=0.10$.\n$$x_{\\text{trial}}=-2+0.10=-1.90,$$\n$$U(-1.9)=(-1.9)^{4}-8(-1.9)^{2}=13.0321-8\\cdot 3.61=13.0321-28.88=-15.8479,$$\n$$\\Delta U=-15.8479-(-16)=0.15210,$$\n$$P_{\\text{accept}}=\\exp(-2\\cdot 0.1521)=\\exp(-0.3042)\\approx 0.738.$$\nGiven $r=0.65$, $rP_{\\text{accept}}$, so accept. Thus $x=-1.9$.\n\nStep 4: $\\Delta x=0.20$.\n$$x_{\\text{trial}}=-1.9+0.20=-1.70,$$\n$$U(-1.7)=-14.7679 \\text{ (from Step 1)},\\quad U(-1.9)=-15.8479,$$\n$$\\Delta U=-14.7679-(-15.8479)=1.08000,$$\n$$P_{\\text{accept}}=\\exp(-2\\cdot 1.08)=\\exp(-2.16)\\approx 0.115.$$\nGiven $r=0.83$, $rP_{\\text{accept}}$, so reject. Thus $x$ remains $-1.9$.\n\nStep 5: $\\Delta x=-0.25$.\n$$x_{\\text{trial}}=-1.9-0.25=-2.15,$$\n$$x^{2}=4.6225,\\quad x^{4}=4.6225^{2}=21.36750625,$$\n$$U(-2.15)=21.36750625-8\\cdot 4.6225=21.36750625-36.98=-15.61249375,$$\n$$\\Delta U=-15.61249375-(-15.8479)=0.235406250,$$\n$$P_{\\text{accept}}=\\exp(-2\\cdot 0.23540625)=\\exp(-0.4708125)\\approx 0.625.$$\nGiven $r=0.47$, $rP_{\\text{accept}}$, so accept. Thus $x=-2.15$.\n\nAfter 5 steps, the final position is $-2.15$. Rounded to three significant figures, this is $-2.15$.",
            "answer": "$$\\boxed{-2.15}$$"
        }
    ]
}