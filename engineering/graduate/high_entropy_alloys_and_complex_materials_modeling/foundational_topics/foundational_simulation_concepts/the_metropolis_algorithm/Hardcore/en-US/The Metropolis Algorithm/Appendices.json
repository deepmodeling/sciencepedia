{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Metropolis algorithm is its elegant acceptance criterion, which ensures that the simulation correctly samples the desired target distribution. This first exercise provides a focused drill on this core mechanic, asking you to compute the acceptance probability, $\\alpha(x \\to x')$, for a proposed move given a specific target distribution and a symmetric proposal function.  Mastering this fundamental calculation is the first step toward building and understanding complex Monte Carlo simulations.",
            "id": "1371728",
            "problem": "A data scientist is implementing a Markov Chain Monte Carlo (MCMC) simulation to draw samples from a posterior probability distribution for a parameter $x$. The target distribution, $\\pi(x)$, is proportional to the exponential of the negative absolute value of the parameter, such that $\\pi(x) \\propto \\exp(-|x|)$.\n\nThe scientist uses the Metropolis algorithm with a symmetric proposal distribution $q(x'|x)$, where the probability of proposing a new state $x'$ given the current state $x$ is equal to the probability of proposing $x$ given $x'$ (i.e., $q(x'|x) = q(x|x')$).\n\nSuppose that at a certain step in the simulation, the current state of the chain is $x = 1.5$. The algorithm then proposes a move to a new candidate state $x' = 2.0$.\n\nCalculate the acceptance probability for this specific move. Your answer should be a dimensionless real number. Round your final answer to four significant figures.",
            "solution": "The Metropolis acceptance probability for a move from $x$ to $x'$ with a symmetric proposal $q(x'|x)=q(x|x')$ is\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\nGiven the target distribution $\\pi(x)\\propto \\exp(-|x|)$, the ratio simplifies to\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\nWith $x=1.5$ and $x'=2.0$, we have $|x|=1.5$ and $|x'|=2.0$, so\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\nTherefore,\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\nNumerically, $\\exp(-0.5)\\approx 0.6065$ when rounded to four significant figures.",
            "answer": "$$\\boxed{0.6065}$$"
        },
        {
            "introduction": "Moving from abstract distributions to physical systems, this problem applies the Metropolis algorithm to a classic scenario in statistical mechanics: a particle on a discrete lattice with a defined energy landscape. By comparing the acceptance probabilities of moving into a high-energy region versus moving out of it, you will develop an intuition for how the algorithm balances the drive toward lower energy with the necessity of thermal fluctuations to explore the entire state space.  This balance is fundamental to simulating systems at thermal equilibrium.",
            "id": "2006008",
            "problem": "A single particle is confined to a one-dimensional lattice consisting of 10 sites, which are indexed by $i = 0, 1, 2, \\dots, 9$. The lattice employs periodic boundary conditions, which means that site $i=9$ is adjacent to site $i=0$. The energy of the particle, $E(i)$, is dependent on its position on the lattice. Specifically, the energy is a positive constant $\\epsilon$ for sites $i \\in \\{3, 4, 5\\}$, and it is zero for all other sites.\n\nThe system is maintained at a constant temperature $T$ and is simulated using the Metropolis algorithm. In this simulation, the algorithm proposes moves for the particle to an adjacent site. The proposal distribution is symmetric, meaning the probability of proposing a move from site $i$ to an adjacent site $j$ is the same as proposing a move from $j$ to $i$.\n\nWe consider two specific elementary moves:\n1.  **Move A**: The particle attempts to move from its current position at site $i_A = 2$ to the adjacent site $j_A = 3$.\n2.  **Move B**: The particle attempts to move from its current position at site $i_B = 5$ to the adjacent site $j_B = 6$.\n\nLet $P_A$ be the acceptance probability for Move A and $P_B$ be the acceptance probability for Move B, according to the Metropolis acceptance criterion.\n\nDetermine the ratio $\\frac{P_B}{P_A}$ as an analytic expression in terms of $\\epsilon$, $T$, and the Boltzmann constant $k_B$.",
            "solution": "For a Metropolis update with a symmetric proposal distribution, the acceptance probability to move from site $i$ to site $j$ is\n$$\nP_{\\text{acc}}(i\\to j)=\\min\\left(1,\\exp\\left(-\\beta\\left[E(j)-E(i)\\right]\\right)\\right),\n$$\nwhere $\\beta=\\frac{1}{k_{B}T}$.\n\nEnergies on the lattice are $E(i)=\\epsilon$ for $i\\in\\{3,4,5\\}$ and $E(i)=0$ otherwise.\n\nFor Move A: $i_{A}=2$ and $j_{A}=3$. Then $E(2)=0$ and $E(3)=\\epsilon$, so\n$$\n\\Delta E_{A}=E(3)-E(2)=\\epsilon.\n$$\nThus,\n$$\nP_{A}=\\min\\left(1,\\exp\\left(-\\beta\\epsilon\\right)\\right)=\\exp\\left(-\\frac{\\epsilon}{k_{B}T}\\right),\n$$\nsince $\\epsilon0$ implies $\\exp(-\\beta\\epsilon)1$.\n\nFor Move B: $i_{B}=5$ and $j_{B}=6$. Then $E(5)=\\epsilon$ and $E(6)=0$, so\n$$\n\\Delta E_{B}=E(6)-E(5)=-\\epsilon.\n$$\nThus,\n$$\nP_{B}=\\min\\left(1,\\exp\\left(-\\beta(-\\epsilon)\\right)\\right)=\\min\\left(1,\\exp\\left(\\beta\\epsilon\\right)\\right)=1.\n$$\n\nTherefore, the ratio is\n$$\n\\frac{P_{B}}{P_{A}}=\\frac{1}{\\exp\\left(-\\frac{\\epsilon}{k_{B}T}\\right)}=\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right).\n$$",
            "answer": "$$\\boxed{\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}$$"
        },
        {
            "introduction": "An effective Monte Carlo simulation is not just correct, but also efficient. The efficiency of the Metropolis algorithm is highly sensitive to the choice of the proposal distribution, particularly the size of the proposed moves. This practice challenges you to analyze this crucial aspect by calculating the expected acceptance rate as a function of the maximum step size.  Understanding this relationship is key to the practical art of tuning a simulation for optimal performance, avoiding situations where nearly all moves are rejected or the system explores the state space too slowly.",
            "id": "2005960",
            "problem": "A classical particle is confined to a one-dimensional region from $x=0$ to $x=L$. Within this region, it experiences a linear potential $V(x) = \\alpha x$, where $\\alpha$ is a positive constant. Outside this region, the potential is infinite. The system is in thermal contact with a heat reservoir at temperature $T$.\n\nA Metropolis Monte Carlo simulation is employed to sample the particle's position according to the Boltzmann distribution. At each step of the simulation, a trial move is proposed from the current position $x_i$ to a new position $x_p = x_i + \\delta$. The step size $\\delta$ is a random variable drawn from a uniform probability distribution over the interval $[-\\Delta x_{max}, \\Delta x_{max}]$.\n\nSuppose the particle is currently located at the exact center of the box, $x_i = L/2$. The maximum step size is set to $\\Delta x_{max} = L/4$. The physical parameters of the system and the temperature are such that the dimensionless quantity $\\beta \\alpha \\Delta x_{max} = 2.0$, where $\\beta = 1/(k_B T)$ and $k_B$ is the Boltzmann constant.\n\nCalculate the expected acceptance rate for this next proposed move, averaging over all possible steps $\\delta$ that can be generated. Express your answer as a decimal rounded to four significant figures.",
            "solution": "The Metropolis acceptance probability for a proposed move from $x_{i}$ to $x_{p}=x_{i}+\\delta$ in the canonical ensemble with a symmetric proposal is\n$$\nA(\\delta)=\\min\\left(1,\\exp\\left[-\\beta\\left(V(x_{p})-V(x_{i})\\right)\\right]\\right).\n$$\nWith $V(x)=\\alpha x$ and $x_{i}=L/2$, the energy change is\n$$\n\\Delta E=V(x_{i}+\\delta)-V(x_{i})=\\alpha\\delta,\n$$\nso\n$$\nA(\\delta)=\\min\\left(1,\\exp(-\\beta\\alpha\\,\\delta)\\right).\n$$\nBecause $\\Delta x_{\\max}=L/4$ and $x_{i}=L/2$, the proposed positions $x_{p}\\in[L/4,3L/4]\\subset[0,L]$, so there are no boundary rejections. The step $\\delta$ is uniformly distributed on $[-\\Delta,\\Delta]$ with $\\Delta=\\Delta x_{\\max}$, hence the expected acceptance rate is\n$$\nR=\\frac{1}{2\\Delta}\\int_{-\\Delta}^{\\Delta}A(\\delta)\\,d\\delta\n=\\frac{1}{2\\Delta}\\left(\\int_{-\\Delta}^{0}1\\,d\\delta+\\int_{0}^{\\Delta}\\exp(-\\beta\\alpha\\,\\delta)\\,d\\delta\\right).\n$$\nEvaluating the integrals,\n$$\n\\int_{-\\Delta}^{0}1\\,d\\delta=\\Delta,\\qquad\n\\int_{0}^{\\Delta}\\exp(-\\beta\\alpha\\,\\delta)\\,d\\delta=\\frac{1}{\\beta\\alpha}\\left(1-\\exp(-\\beta\\alpha\\Delta)\\right).\n$$\nTherefore,\n$$\nR=\\frac{1}{2\\Delta}\\left[\\Delta+\\frac{1}{\\beta\\alpha}\\left(1-\\exp(-\\beta\\alpha\\Delta)\\right)\\right].\n$$\nIntroduce $s=\\beta\\alpha\\Delta$, to obtain\n$$\nR=\\frac{1}{2}\\left[1+\\frac{1}{s}\\left(1-\\exp(-s)\\right)\\right].\n$$\nGiven $s=\\beta\\alpha\\Delta x_{\\max}=2.0$, this becomes\n$$\nR=\\frac{1}{2}\\left[1+\\frac{1}{2}\\left(1-\\exp(-2)\\right)\\right].\n$$\nNumerically, $\\exp(-2)\\approx 0.135335283$, so\n$$\nR\\approx \\frac{1}{2}\\left[1+0.5\\times(1-0.135335283)\\right]\n=\\frac{1}{2}\\left[1+0.4323323585\\right]\n\\approx 0.7161661792.\n$$\nRounded to four significant figures, the expected acceptance rate is $0.7162$.",
            "answer": "$$\\boxed{0.7162}$$"
        }
    ]
}