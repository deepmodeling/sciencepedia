{
    "hands_on_practices": [
        {
            "introduction": "A point defect, such as a vacancy, is more than just a missing atom; it is a source of strain that distorts the surrounding crystal lattice. A powerful way to conceptualize this is to model the lattice as an elastic continuum, a cornerstone of solid mechanics. This practice  challenges you to apply the principles of linear elasticity to derive the energy stored in this strain field, providing a foundational understanding of the size-misfit contribution to a vacancy's formation energy.",
            "id": "3754656",
            "problem": "Consider a chemically disordered High-Entropy Alloy (HEA) that is modeled as an infinite, homogeneous, isotropic elastic continuum characterized by bulk modulus $K$ and shear modulus $\\mu$. Let the mean lattice site volume be $V_0$, and consider a particular species $i$ whose atomic volume is $V_i \\neq V_0$. Treat the presence of species $i$ on a lattice site as a spherical inclusion of volume $V_0$ embedded in the elastic matrix, endowed with a uniform hydrostatic eigenstrain $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\,\\delta_{ij}$, where the dilatational misfit $\\eta$ is defined by $\\eta = \\frac{V_i - V_0}{V_0}$. Assume identical elastic moduli inside and outside the inclusion and no external loads.\n\nA vacancy is formed by removing the atom of species $i$ from the site, and we define the size-misfit contribution to the vacancy formation energy as the elastic energy change associated solely with the removal of the eigenstrain of the misfitting atom, neglecting any species-independent relaxation associated with the vacancy itself. That is, the contribution is the difference between the final and initial elastic self-energy of the inclusion problem, with the final elastic self-energy taken to be zero once the eigenstrain is removed.\n\nStarting from isotropic linear elasticity and the constitutive relation with an eigenstrain,\n$$\n\\sigma_{ij} = 2\\mu\\left(\\varepsilon_{ij} - \\varepsilon^{*}_{ij}\\right) + \\lambda\\,\\delta_{ij}\\left(\\varepsilon_{kk} - \\varepsilon^{*}_{kk}\\right),\n$$\nwhere $\\lambda$ is Lamé’s first parameter and $K = \\lambda + \\frac{2}{3}\\mu$, and using spherical symmetry for the displacement field inside and outside the inclusion, derive the elastic self-energy stored by the misfitting atom and compute the size-misfit contribution to the vacancy formation energy. Express your final answer as a single closed-form analytic expression in terms of $K$, $\\mu$, $V_i$, and $V_0$, and report it in Joules. Do not perform any numerical evaluation.",
            "solution": "The problem requires the derivation of the size-misfit contribution to the vacancy formation energy in a high-entropy alloy, modeled as an isotropic elastic continuum. This contribution is defined as the change in elastic energy upon removal of the eigenstrain associated with a misfitting atom. The initial state contains a misfitting atom, which stores an elastic self-energy, $E_{self}$. The final state, after the atom is removed, is defined to have zero elastic self-energy from this source. Therefore, the required contribution is $E_{contribution} = E_{final} - E_{initial} = 0 - E_{self} = -E_{self}$. The primary task is to calculate $E_{self}$.\n\nThe misfitting atom is modeled as a spherical inclusion of volume $V_0$ in an infinite matrix. The inclusion has a uniform, hydrostatic eigenstrain $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\,\\delta_{ij}$, where $\\eta = \\frac{V_i - V_0}{V_0}$ is the dilatational misfit. The elastic moduli (bulk modulus $K$ and shear modulus $\\mu$) are identical inside and outside the inclusion. This is a classic Eshelby inclusion problem.\n\nDue to spherical symmetry, the displacement field $\\vec{u}$ must be purely radial, $u_r(r)$. In spherical coordinates, the general solution for the displacement field that satisfies the equilibrium equations is of the form $u_r(r) = Ar + B/r^2$.\nInside the inclusion ($r \\le R_0$, where $V_0 = \\frac{4}{3}\\pi R_0^3$), the displacement must be finite at the origin $r=0$, which requires $B=0$. Thus, the displacement field inside is:\n$$u_r^{in}(r) = Ar$$\nOutside the inclusion ($r > R_0$), the displacement must vanish as $r \\to \\infty$, which requires $A=0$. Thus, the displacement field outside is:\n$$u_r^{out}(r) = \\frac{C}{r^2}$$\nThe constants $A$ and $C$ are determined from boundary conditions at the interface $r=R_0$.\n\nThe components of the total strain tensor $\\varepsilon_{ij}$ are derived from the displacement field.\nInside the inclusion ($r \\le R_0$):\nThe radial and tangential strains are $\\varepsilon_{rr}^{in} = \\frac{du_r^{in}}{dr} = A$ and $\\varepsilon_{\\theta\\theta}^{in} = \\varepsilon_{\\phi\\phi}^{in} = \\frac{u_r^{in}}{r} = A$.\nThe trace of the strain tensor (volumetric strain) is $\\varepsilon_{kk}^{in} = \\varepsilon_{rr}^{in} + 2\\varepsilon_{\\theta\\theta}^{in} = 3A$.\n\nOutside the inclusion ($r > R_0$):\nThe strains are $\\varepsilon_{rr}^{out} = \\frac{du_r^{out}}{dr} = -\\frac{2C}{r^3}$ and $\\varepsilon_{\\theta\\theta}^{out} = \\varepsilon_{\\phi\\phi}^{out} = \\frac{u_r^{out}}{r} = \\frac{C}{r^3}$.\nThe trace is $\\varepsilon_{kk}^{out} = \\varepsilon_{rr}^{out} + 2\\varepsilon_{\\theta\\theta}^{out} = -\\frac{2C}{r^3} + 2\\frac{C}{r^3} = 0$.\n\nThe stress tensor $\\sigma_{ij}$ is given by the constitutive relation $\\sigma_{ij} = 2\\mu(\\varepsilon_{ij} - \\varepsilon^{*}_{ij}) + \\lambda\\,\\delta_{ij}(\\varepsilon_{kk} - \\varepsilon^{*}_{kk})$. The eigenstrain is $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\delta_{ij}$ inside the inclusion and zero outside. Its trace is $\\varepsilon^{*}_{kk}=\\eta$.\n\nInside the inclusion ($r \\le R_0$):\n$\\sigma_{rr}^{in} = 2\\mu(\\varepsilon_{rr}^{in} - \\varepsilon_{rr}^{*}) + \\lambda(\\varepsilon_{kk}^{in} - \\varepsilon_{kk}^{*}) = 2\\mu\\left(A - \\frac{1}{3}\\eta\\right) + \\lambda(3A - \\eta)$.\nRearranging terms, $\\sigma_{rr}^{in} = (3\\lambda+2\\mu)A - (\\lambda + \\frac{2}{3}\\mu)\\eta$.\nUsing the relations $K = \\lambda + \\frac{2}{3}\\mu$ and $3K = 3\\lambda + 2\\mu$, we get $\\sigma_{rr}^{in} = 3KA - K\\eta$.\nSimilarly, $\\sigma_{\\theta\\theta}^{in} = \\sigma_{\\phi\\phi}^{in} = \\sigma_{rr}^{in}$. The stress is hydrostatic: $\\sigma_{ij}^{in} = (3KA - K\\eta)\\delta_{ij}$.\n\nOutside the inclusion ($r > R_0$), $\\varepsilon^{*}_{ij}=0$:\n$\\sigma_{rr}^{out} = 2\\mu\\varepsilon_{rr}^{out} + \\lambda\\varepsilon_{kk}^{out} = 2\\mu\\left(-\\frac{2C}{r^3}\\right) + \\lambda(0) = -\\frac{4\\mu C}{r^3}$.\n\nAt the interface $r=R_0$, both displacement and radial stress must be continuous.\n1. Continuity of displacement: $u_r^{in}(R_0) = u_r^{out}(R_0) \\implies AR_0 = \\frac{C}{R_0^2} \\implies C = AR_0^3$.\n2. Continuity of radial stress: $\\sigma_{rr}^{in}(R_0) = \\sigma_{rr}^{out}(R_0) \\implies 3KA - K\\eta = -\\frac{4\\mu C}{R_0^3}$.\nSubstituting $C=AR_0^3$ into the stress continuity equation:\n$3KA - K\\eta = -4\\mu A \\implies (3K+4\\mu)A = K\\eta \\implies A = \\frac{K\\eta}{3K+4\\mu}$.\n\nThe stress inside the inclusion is uniform and can now be calculated:\n$\\sigma_{rr}^{in} = 3KA - K\\eta = K(3A-\\eta) = K\\left(3\\frac{K\\eta}{3K+4\\mu} - \\eta\\right) = K\\eta\\left(\\frac{3K - (3K+4\\mu)}{3K+4\\mu}\\right)$.\n$$\\sigma_{rr}^{in} = -\\frac{4\\mu K \\eta}{3K+4\\mu}$$\nThus, the stress tensor inside is $\\sigma_{ij}^{in} = \\left(-\\frac{4\\mu K \\eta}{3K+4\\mu}\\right)\\delta_{ij}$.\n\nThe elastic self-energy $E_{self}$ is the total strain energy stored in the body, given by the work done by the internal stresses on the eigenstrains. For a uniform eigenstrain in an inclusion, this is:\n$$E_{self} = -\\frac{1}{2} \\int_{V_{inclusion}} \\sigma_{ij}^{in} \\varepsilon_{ij}^* dV = -\\frac{1}{2} V_0 (\\sigma_{ij}^{in} \\varepsilon_{ij}^*)$$\nThe tensor contraction is $\\sigma_{ij}^{in} \\varepsilon_{ij}^* = \\left(-\\frac{4\\mu K \\eta}{3K+4\\mu}\\delta_{ij}\\right) \\left(\\frac{1}{3}\\eta\\delta_{ij}\\right) = -\\frac{4\\mu K \\eta^2}{3(3K+4\\mu)} (\\delta_{ij}\\delta_{ij})$.\nSince $\\delta_{ij}\\delta_{ij} = \\delta_{11}+\\delta_{22}+\\delta_{33}=3$, we have:\n$\\sigma_{ij}^{in} \\varepsilon_{ij}^* = -\\frac{4\\mu K \\eta^2}{3K+4\\mu}$.\nSubstituting this into the energy expression:\n$$E_{self} = -\\frac{1}{2} V_0 \\left(-\\frac{4\\mu K \\eta^2}{3K+4\\mu}\\right) = \\frac{2\\mu K V_0 \\eta^2}{3K+4\\mu}$$\nThis is the elastic self-energy stored by the misfitting atom. The problem defines the size-misfit contribution to the vacancy formation energy as $E_{contribution} = -E_{self}$.\n$$E_{contribution} = -\\frac{2\\mu K V_0 \\eta^2}{3K+4\\mu}$$\nFinally, substituting the definition of the misfit parameter $\\eta = \\frac{V_i - V_0}{V_0}$:\n$$E_{contribution} = -\\frac{2\\mu K V_0}{3K+4\\mu} \\left(\\frac{V_i - V_0}{V_0}\\right)^2 = -\\frac{2\\mu K}{3K+4\\mu} \\frac{(V_i - V_0)^2}{V_0}$$\nThis expression gives the size-misfit contribution to the vacancy formation energy in Joules.",
            "answer": "$$\n\\boxed{-\\frac{2\\mu K}{3K+4\\mu} \\frac{(V_i - V_0)^2}{V_0}}\n$$"
        },
        {
            "introduction": "The long-range elastic field of a defect, as explored in the previous exercise, has crucial implications for atomistic simulations, which typically use periodic boundary conditions. These boundary conditions create artificial interactions between a defect and its periodic images, introducing a \"finite-size error\" into calculated energies. This practice  provides a vital skill for computational materials science: using the theoretical scaling of elastic interactions to analyze simulation data, correct for these errors, and extrapolate to the physically meaningful infinite-system limit.",
            "id": "3754746",
            "problem": "Consider a chemically disordered equiatomic body-centered cubic high-entropy alloy (HEA) composed of five refractory elements under Born–von Karman periodic boundary conditions. A single neutral vacancy is introduced in a sequence of cubic Special Quasirandom Structure (SQS) supercells of linear dimension $L$, such that the vacancy concentration is $c \\sim L^{-3}$. The vacancy formation energy $E_{f}(L)$ is obtained from Density Functional Theory (DFT) total energies via the standard definition $E_{f}(L) = E^{\\mathrm{def}}(L) - E^{\\mathrm{perf}}(L) + \\mu$, where $E^{\\mathrm{def}}(L)$ and $E^{\\mathrm{perf}}(L)$ are the total energies of the defective and perfect supercells, respectively, and $\\mu$ is the appropriate elemental chemical potential. In metallic systems, the vacancy is neutral, and long-range electrostatic terms are absent. The elastic response of the medium is well described by linear elasticity, and the point defect is modeled by an elastic dipole tensor $P_{ij}$ in an effectively isotropic medium characterized by Lamé parameters $\\lambda$ and $\\mu$ (shear modulus). \n\nYou are given the following measured vacancy formation energies for three cubic supercells:\n- $L_{1} = 10\\,\\mathrm{\\AA}$ with $E_{f}(L_{1}) = 1.79\\,\\mathrm{eV}$,\n- $L_{2} = 12\\,\\mathrm{\\AA}$ with $E_{f}(L_{2}) = 1.7520833\\,\\mathrm{eV}$,\n- $L_{3} = 14\\,\\mathrm{\\AA}$ with $E_{f}(L_{3}) = 1.732815\\,\\mathrm{eV}$.\n\nTasks:\n1. Starting from the continuum mechanics description of a point defect as a localized force distribution producing an elastic dipole tensor $P_{ij}$, and using the asymptotic far-field of the defect under periodic boundary conditions, reason about the leading-order $L$-dependence of the interaction energy between periodic images. Justify the functional form of the leading finite-size error for a neutral vacancy in a metallic HEA and propose a scaling law for $E_{f}(L)$ as $L \\to \\infty$.\n2. Using the proposed scaling law, fit the given data to extract the infinite-size limit $E_{f}(\\infty)$ and the leading finite-size coefficient. Then compute the finite-size error at $L_{2}$ via $\\Delta E(L_{2}) = E_{f}(L_{2}) - E_{f}(\\infty)$.\n3. Provide the final extrapolated infinite-size vacancy formation energy $E_{f}(\\infty)$ in electronvolts. Round your final answer to four significant figures and express the energy in $\\mathrm{eV}$.",
            "solution": "The problem asks for the determination of the infinite-size vacancy formation energy, $E_{f}(\\infty)$, in a high-entropy alloy by extrapolating from a series of finite-size supercell calculations. The process requires first establishing a theoretical scaling law for the finite-size error and then fitting the provided data to this law.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens:**\n- System: Chemically disordered equiatomic BCC HEA of five refractory elements.\n- Boundary Conditions: Born–von Karman periodic boundary conditions (PBC).\n- Defect: Single neutral vacancy.\n- Supercells: Cubic Special Quasirandom Structure (SQS) of linear dimension $L$.\n- Vacancy Formation Energy Definition: $E_{f}(L) = E^{\\mathrm{def}}(L) - E^{\\mathrm{perf}}(L) + \\mu$.\n- Physical Model: The vacancy is neutral in a metal, so long-range electrostatic interactions are absent. The system's response is governed by linear elasticity theory, with the defect modeled as an elastic dipole tensor $P_{ij}$ in an effectively isotropic medium with Lamé parameters $\\lambda$ and $\\mu$.\n- Data:\n  - $L_{1} = 10\\,\\mathrm{\\AA}$, $E_{f}(L_{1}) = 1.79\\,\\mathrm{eV}$.\n  - $L_{2} = 12\\,\\mathrm{\\AA}$, $E_{f}(L_{2}) = 1.7520833\\,\\mathrm{eV}$.\n  - $L_{3} = 14\\,\\mathrm{\\AA}$, $E_{f}(L_{3}) = 1.732815\\,\\mathrm{eV}$.\n\n**1.2. Validation:**\n- **Scientific Grounding:** The problem is firmly grounded in the principles of computational materials science and continuum mechanics. The use of DFT, SQS supercells, and the analysis of finite-size effects due to periodic boundary conditions are standard practices. The theoretical framework for elastic interactions of point defects under PBC is well-established (cf. Leslie & Gillan, J. Phys. C, 1985).\n- **Well-Posedness:** The problem provides three data points to determine the parameters of a physically motivated scaling law. This is a sufficient and well-defined mathematical task.\n- **Objectivity and Completeness:** The problem is stated in precise, objective language. The provided data are sufficient to perform the required tasks. The numerical values are given with high precision, suggesting they are constructed to allow for a clear solution.\n\n**1.3. Verdict:**\nThe problem is scientifically sound, well-posed, and internally consistent. It is therefore deemed **valid**.\n\n### Step 2: Derivation and Solution\n\n**Task 1: Finite-Size Scaling Law**\nThe calculated formation energy $E_{f}(L)$ in a finite supercell of size $L$ under PBC can be expressed as the sum of the true infinite-size value $E_{f}(\\infty)$ and a size-dependent error term, $E_{\\mathrm{err}}(L)$:\n$$E_{f}(L) = E_{f}(\\infty) + E_{\\mathrm{err}}(L)$$\nThis error term arises from the spurious interaction of the defect with its own periodic images. For a neutral point defect in a metallic system, the dominant long-range interaction is elastic, not electrostatic. The defect induces a strain field in the surrounding lattice, which can be described in the far-field by an elastic dipole tensor $P_{ij}$. The interaction energy between the defect in the central cell and its periodic images is the leading source of error.\n\nIn an isotropic elastic medium, the interaction energy between two identical elastic dipoles separated by a large distance $r$ scales as $r^{-3}$. Under PBC in a cubic supercell of side length $L$, the periodic images are located at lattice vectors $\\mathbf{R}_{\\mathbf{n}} = L(n_x, n_y, n_z)$ for integers $(n_x, n_y, n_z)$ not all zero. The total interaction energy is a sum over all periodic images:\n$$E_{\\mathrm{err}}(L) \\propto \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n}\\neq\\mathbf{0}} \\frac{1}{|\\mathbf{R}_{\\mathbf{n}}|^3} = \\frac{1}{L^3} \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n}\\neq\\mathbf{0}} \\frac{1}{(n_x^2+n_y^2+n_z^2)^{3/2}}$$\nThe sum is a dimensionless constant known as a lattice sum. Therefore, the leading-order finite-size error due to elastic interactions scales as $L^{-3}$. Higher-order terms, such as those scaling as $L^{-5}$, can arise from discreteness effects or higher-order multipole moments, but the $L^{-3}$ term is dominant. The proposed scaling law for the vacancy formation energy is:\n$$E_{f}(L) = E_{f}(\\infty) + \\frac{A}{L^3}$$\nwhere $A$ is a coefficient that depends on the elastic constants of the material and the trace of the elastic dipole tensor of the vacancy. This equation represents a linear relationship between $E_f(L)$ and $L^{-3}$.\n\n**Task 2: Data Fitting and Error Calculation**\nWe are to fit the given data to the derived scaling law $y = b + mx$, where $y = E_f(L)$, $x = L^{-3}$, $b = E_f(\\infty)$, and $m = A$.\nThe data points are:\n1. $(x_1, y_1) = ( (10\\,\\mathrm{\\AA})^{-3}, 1.79\\,\\mathrm{eV} ) = (0.001\\,\\mathrm{\\AA}^{-3}, 1.79\\,\\mathrm{eV})$\n2. $(x_2, y_2) = ( (12\\,\\mathrm{\\AA})^{-3}, 1.7520833\\,\\mathrm{eV} ) = (\\frac{1}{1728}\\,\\mathrm{\\AA}^{-3}, 1.7520833\\,\\mathrm{eV})$\n3. $(x_3, y_3) = ( (14\\,\\mathrm{\\AA})^{-3}, 1.732815\\,\\mathrm{eV} ) = (\\frac{1}{2744}\\,\\mathrm{\\AA}^{-3}, 1.732815\\,\\mathrm{eV})$\n\nLet us use the first two data points to determine the parameters $A$ and $E_f(\\infty)$. The high precision of the second data point, $1.7520833\\,\\mathrm{eV}$, suggests it may represent a repeating decimal, $1.75208\\overline{3}\\,\\mathrm{eV}$. This is a common feature in well-posed academic problems.\nLet us verify this hypothesis. As a fraction, $0.05208\\overline{3} = \\frac{5}{96}$.\nSo we test the hypothesis that $E_f(L_2) = 1.7 + \\frac{5}{96} = 1.75208\\overline{3}\\,\\mathrm{eV}$.\nLet's set up the system of two linear equations:\n$$1.79 = E_f(\\infty) + A \\cdot (10^{-3})$$\n$$1.75208\\overline{3} = E_f(\\infty) + A \\cdot (12^{-3})$$\nSubtracting the second equation from the first:\n$$1.79 - 1.75208\\overline{3} = A \\left(\\frac{1}{1000} - \\frac{1}{1728}\\right)$$\nThe left-hand side is $0.03791\\overline{6}$. In fractional form, this is $1.79 = \\frac{179}{100}$ and $1.75208\\overline{3} = 1.7 + \\frac{5}{96} = \\frac{17}{10} + \\frac{5}{96} = \\frac{17 \\cdot 48 + 25}{480} = \\frac{816+25}{480} = \\frac{841}{480}$.\n$$LHS = \\frac{179}{100} - \\frac{841}{480} = \\frac{179 \\cdot 24 - 841 \\cdot 5}{2400} = \\frac{4296 - 4205}{2400} = \\frac{91}{2400}$$\nThe right-hand side term is:\n$$RHS = A \\left(\\frac{1}{1000} - \\frac{1}{1728}\\right) = A \\left(\\frac{1728 - 1000}{1728000}\\right) = A \\left(\\frac{728}{1728000}\\right)$$\nSince $728 = 8 \\times 91$, we have:\n$$RHS = A \\left(\\frac{91 \\cdot 8}{1728000}\\right)$$\nEquating the two sides:\n$$\\frac{91}{2400} = A \\frac{91 \\cdot 8}{1728000}$$\nSolving for $A$:\n$$A = \\frac{91}{2400} \\cdot \\frac{1728000}{91 \\cdot 8} = \\frac{1}{2400} \\cdot \\frac{1728000}{8} = \\frac{17280}{24 \\cdot 8} = \\frac{17280}{192}$$\nSince $1728 = 12^3=192 \\times 9$:\n$$A = \\frac{9 \\times 192 \\times 10}{192} = 90\\,\\mathrm{eV}\\cdot\\mathrm{\\AA}^3$$\nNow we solve for $E_f(\\infty)$ using the first data point:\n$$E_f(\\infty) = 1.79 - A \\cdot (10^{-3}) = 1.79 - 90 \\cdot 0.001 = 1.79 - 0.09 = 1.70\\,\\mathrm{eV}$$\nThe resulting scaling law is $E_{f}(L) = 1.70 + 90 L^{-3}$.\n\nLet's check this law against the third data point:\n$$E_f(L_3) = 1.70 + \\frac{90}{14^3} = 1.70 + \\frac{90}{2744} \\approx 1.70 + 0.0327988 \\approx 1.7327988\\,\\mathrm{eV}$$\nThis is very close to the given value of $1.732815\\,\\mathrm{eV}$. The small discrepancy of $\\approx 0.000016\\,\\mathrm{eV}$ is physically reasonable and can be attributed to the specific atomic configuration of the SQS supercell of size $L_3$, which introduces minor statistical fluctuations (\"chemical noise\") around the idealized continuum scaling law.\n\nThe finite-size error at $L_2$ is $\\Delta E(L_2) = E_f(L_2) - E_f(\\infty)$. Using our derived law, this is precisely the correction term:\n$$\\Delta E(L_2) = \\frac{A}{L_2^3} = \\frac{90}{12^3} = \\frac{90}{1728} = \\frac{5}{96}\\,\\mathrm{eV} \\approx 0.0520833\\,\\mathrm{eV}$$\n\n**Task 3: Final Extrapolated Energy**\nFrom the analysis above, the extrapolated vacancy formation energy in the infinite-size limit is:\n$$E_f(\\infty) = 1.70\\,\\mathrm{eV}$$\nThe problem requires the final answer to be rounded to four significant figures. Thus, $1.70$ is written as $1.700$.",
            "answer": "$$\n\\boxed{1.700}\n$$"
        },
        {
            "introduction": "The formation of a vacancy is a thermodynamic process, and its free energy depends on both the local environment and the macroscopic chemical state of the alloy. This exercise  bridges the atomistic and thermodynamic scales by asking you to develop a computational model for the vacancy formation Gibbs free energy in a complex alloy. You will learn to integrate a local, mean-field bond-breaking model with species-specific chemical potentials, which can be obtained from thermodynamic databases like those used in CALPHAD, to arrive at a more complete and realistic description of defect energetics.",
            "id": "3754682",
            "problem": "You are tasked with building a complete, runnable program that, for a random multicomponent substitutional alloy modeled as a single-lattice solution, computes the vacancy formation Gibbs free energy for removing a site-occupying atom of each species. The computation must be based on first principles using the definition of chemical potential and thermodynamic reversible work needed to create a vacancy while exchanging mass with a reservoir, together with a physically motivated nearest-neighbor mean-field interaction model for the local broken-bond enthalpy. The alloy is assumed to be random so that the nearest-neighbor species probabilities are given by the bulk composition. The approach must use species chemical potentials extracted from Computer Coupling of Phase Diagrams and Thermochemistry (CALPHAD) assessments and convert units when necessary.\n\nFundamental bases to use:\n- The Gibbs free energy definition at constant temperature and pressure, where the chemical potential of species $i$, denoted $\\,\\mu_i\\,$, is the partial derivative $\\,\\mu_i = \\left( \\partial G / \\partial n_i \\right)_{T,P,n_{j \\neq i}}\\,\\,$.\n- The reversible work to form a vacancy by removing one atom of species $i$ and placing it in a reservoir with chemical potential $\\,\\mu_i\\,$ equals the intrinsic Gibbs free energy change of the system due to bond breaking plus the reservoir exchange work term.\n- A nearest-neighbor pair interaction model for a random solution in mean-field, where removing an atom of species $i$ breaks $\\,z\\,$ bonds with its neighbors. The average broken-bond enthalpy is the coordination number $\\,z\\,$ multiplied by the composition-weighted average of pair breaking energies $\\,W_{ij}\\,$.\n\nScientific realism constraints:\n- Energies must be expressed in electron-volts per atom ($\\,\\mathrm{eV/atom}\\,$).\n- If a chemical potential is provided in kilojoules per mole ($\\,\\mathrm{kJ/mol}\\,$), it must be converted to electron-volts per atom using $\\,1\\,\\mathrm{eV/atom} = 96.485332123\\,\\mathrm{kJ/mol}\\,$.\n- Temperatures are given in kelvin ($\\,\\mathrm{K}\\,$).\n- Coordination numbers $\\,z\\,$ are physically plausible for metallic lattices, e.g., face-centered cubic with $\\,z=12\\,$, body-centered cubic with $\\,z=8\\,$, and hexagonal close-packed with $\\,z=12\\,$.\n\nProgram requirements:\n- For each test case, accept the temperature $\\,T\\,$, the composition vector $\\,\\boldsymbol{x} = (x_1,\\dots,x_m)\\,$ with $\\,\\sum_i x_i = 1\\,$ expressed as decimal fractions (not with a percentage sign), the list of species chemical potentials $\\,(\\mu_1,\\dots,\\mu_m)\\,$ with a unit flag indicating either $\\,\\mathrm{kJ/mol}\\,$ or $\\,\\mathrm{eV/atom}\\,$, the symmetric matrix of pair breaking energies $\\,W_{ij}\\,$ at a reference temperature $\\,T_{\\mathrm{ref}}\\,$, the optional linear temperature coefficient matrix $\\,\\alpha_{ij}\\,$ defined via $\\,W_{ij}(T) = W_{ij}(T_{\\mathrm{ref}}) + \\alpha_{ij}\\,(T - T_{\\mathrm{ref}})\\,$, and the coordination number $\\,z\\,$.\n- Convert all $\\,\\mu_i\\,$ to $\\,\\mathrm{eV/atom}\\,$ when needed.\n- Use the random-solution mean-field to compute the average broken-bond enthalpy per vacancy for removing species $\\,i\\,$ as $\\,z\\,\\sum_{j=1}^m x_j\\,W_{ij}(T)\\,$.\n- Combine the intrinsic change with the reservoir exchange term determined by $\\,\\mu_i\\,$ to output the vacancy formation Gibbs free energies for removing each species, in $\\,\\mathrm{eV}\\,$ per vacancy.\n\nNumerical output requirements:\n- For each test case, return the list $\\,\\big(G_{f,1}^{v},\\dots,G_{f,m}^{v}\\big)\\,$ of floats, each rounded to six decimal places, representing the vacancy formation Gibbs free energy for removing species $\\,i\\,$.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. For example, the final printed line must look like $\\,\\left[\\left[g_{1,1},\\dots,g_{1,m}\\right],\\left[g_{2,1},\\dots\\right],\\dots\\right]\\,$, where each $\\,g_{k,i}\\,$ is a float rounded to six decimals in $\\,\\mathrm{eV}\\,$.\n\nTest suite:\n- Case $\\,1\\,$ (happy path, equiatomic four-component, face-centered cubic):\n  - $\\,T = 1200\\,\\mathrm{K}\\,$, $\\,T_{\\mathrm{ref}} = 1200\\,\\mathrm{K}\\,$, $\\,z = 12\\,$\n  - $\\,\\boldsymbol{x} = (0.25, 0.25, 0.25, 0.25)\\,$\n  - $\\,\\boldsymbol{\\mu}\\,$ in $\\,\\mathrm{kJ/mol}\\,$: $\\,(-20.0, -19.5, -21.0, -20.2)\\,$\n  - $\\,W_{ij}\\,$ in $\\,\\mathrm{eV}\\,$:\n    - $\\,W = \\begin{bmatrix}\n    0.10 & 0.11 & 0.09 & 0.10 \\\\\n    0.11 & 0.10 & 0.10 & 0.09 \\\\\n    0.09 & 0.10 & 0.10 & 0.11 \\\\\n    0.10 & 0.09 & 0.11 & 0.10\n    \\end{bmatrix}\\,$\n  - No temperature coefficient, so $\\,\\alpha_{ij}\\,$ is omitted.\n- Case $\\,2\\,$ (equiatomic five-component, one species with weaker bonding):\n  - $\\,T = 1000\\,\\mathrm{K}\\,$, $\\,T_{\\mathrm{ref}} = 1000\\,\\mathrm{K}\\,$, $\\,z = 12\\,$\n  - $\\,\\boldsymbol{x} = (0.2, 0.2, 0.2, 0.2, 0.2)\\,$\n  - $\\,\\boldsymbol{\\mu}\\,$ in $\\,\\mathrm{eV/atom}\\,$: $\\,(-0.220, -0.210, -0.230, -0.220, -0.215)\\,$\n  - $\\,W_{ij}\\,$ in $\\,\\mathrm{eV}\\,$:\n    - $\\,W = \\begin{bmatrix}\n    0.100 & 0.090 & 0.100 & 0.095 & 0.098 \\\\\n    0.090 & 0.070 & 0.080 & 0.075 & 0.078 \\\\\n    0.100 & 0.080 & 0.100 & 0.095 & 0.094 \\\\\n    0.095 & 0.075 & 0.095 & 0.100 & 0.096 \\\\\n    0.098 & 0.078 & 0.094 & 0.096 & 0.100\n    \\end{bmatrix}\\,$\n  - No temperature coefficient, so $\\,\\alpha_{ij}\\,$ is omitted.\n- Case $\\,3\\,$ (binary near-limit, body-centered cubic):\n  - $\\,T = 900\\,\\mathrm{K}\\,$, $\\,T_{\\mathrm{ref}} = 900\\,\\mathrm{K}\\,$, $\\,z = 8\\,$\n  - $\\,\\boldsymbol{x} = (0.9, 0.1)\\,$\n  - $\\,\\boldsymbol{\\mu}\\,$ in $\\,\\mathrm{kJ/mol}\\,$: $\\,(-15.0, -12.0)\\,$\n  - $\\,W_{ij}\\,$ in $\\,\\mathrm{eV}\\,$:\n    - $\\,W = \\begin{bmatrix}\n    0.12 & 0.10 \\\\\n    0.10 & 0.08\n    \\end{bmatrix}\\,$\n  - No temperature coefficient, so $\\,\\alpha_{ij}\\,$ is omitted.\n- Case $\\,4\\,$ (equiatomic three-component, temperature-dependent pair energies):\n  - $\\,T = 1600\\,\\mathrm{K}\\,$, $\\,T_{\\mathrm{ref}} = 1000\\,\\mathrm{K}\\,$, $\\,z = 12\\,$\n  - $\\,\\boldsymbol{x} = (1/3, 1/3, 1/3)\\,$\n  - $\\,\\boldsymbol{\\mu}\\,$ in $\\,\\mathrm{kJ/mol}\\,$: $\\,(-18.0, -19.0, -17.5)\\,$\n  - $\\,W_{ij}(T_{\\mathrm{ref}})\\,$ in $\\,\\mathrm{eV}\\,$:\n    - $\\,W = \\begin{bmatrix}\n    0.110 & 0.100 & 0.095 \\\\\n    0.100 & 0.105 & 0.098 \\\\\n    0.095 & 0.098 & 0.110\n    \\end{bmatrix}\\,$\n  - $\\,\\alpha_{ij}\\,$ in $\\,\\mathrm{eV/K}\\,$:\n    - $\\,\\alpha = \\begin{bmatrix}\n    -1.0\\times 10^{-5} & -1.2\\times 10^{-5} & -0.9\\times 10^{-5} \\\\\n    -1.2\\times 10^{-5} & -1.1\\times 10^{-5} & -1.0\\times 10^{-5} \\\\\n    -0.9\\times 10^{-5} & -1.0\\times 10^{-5} & -1.05\\times 10^{-5}\n    \\end{bmatrix}\\,$\n- Case $\\,5\\,$ (three-component, non-equiatomic, hexagonal close-packed-like coordination):\n  - $\\,T = 700\\,\\mathrm{K}\\,$, $\\,T_{\\mathrm{ref}} = 700\\,\\mathrm{K}\\,$, $\\,z = 12\\,$\n  - $\\,\\boldsymbol{x} = (0.5, 0.3, 0.2)\\,$\n  - $\\,\\boldsymbol{\\mu}\\,$ in $\\,\\mathrm{eV/atom}\\,$: $\\,(-0.180, -0.160, -0.150)\\,$\n  - $\\,W_{ij}\\,$ in $\\,\\mathrm{eV}\\,$:\n    - $\\,W = \\begin{bmatrix}\n    0.090 & 0.085 & 0.080 \\\\\n    0.085 & 0.090 & 0.082 \\\\\n    0.080 & 0.082 & 0.095\n    \\end{bmatrix}\\,$\n  - No temperature coefficient, so $\\,\\alpha_{ij}\\,$ is omitted.\n\nFinal output format:\n- Your program must print a single line containing the vacancy formation free energies for all test cases as a comma-separated list of lists enclosed in square brackets, with each numeric entry rounded to six decimals and expressed in $\\,\\mathrm{eV}\\,$. For example: $\\,\\left[[g_{1,1},g_{1,2},\\dots],[g_{2,1},\\dots],\\dots\\right]\\,$.",
            "solution": "The problem is assessed to be **valid**. It is scientifically grounded in the principles of materials thermodynamics, well-posed with a clear and computable model, and specified with all necessary objective data and constraints.\n\nThe task is to compute the Gibbs free energy of forming a vacancy, $G_{f,i}^{v}$, by removing an atom of species $i$ from a multicomponent random substitutional alloy. The theoretical framework is based on a thermodynamic cycle where the atom is removed from the crystal lattice and transferred to a chemical reservoir maintained at constant temperature $T$ and pressure $P$.\n\nThe total Gibbs free energy change of the system for this process is the sum of two contributions:\n1.  The intrinsic free energy change in the crystal due to the creation of a vacant site.\n2.  The free energy change associated with transferring one atom of species $i$ to the reservoir.\n\nThe first term, the intrinsic change, is dominated by the energy required to break the local atomic bonds of the removed atom. The problem specifies a nearest-neighbor mean-field model for this contribution. In this model, an atom of species $i$ has a coordination number $z$ (number of nearest neighbors). In a random alloy with composition vector $\\boldsymbol{x} = (x_1, \\dots, x_m)$, the probability that a neighboring site is occupied by an atom of species $j$ is given by its mole fraction $x_j$. The energy to break an $i-j$ pair bond is related to the pair breaking energy parameter $W_{ij}$. The total broken-bond enthalpy for removing atom $i$, denoted $\\Delta H_{\\text{bonds}, i}$, is the coordination number multiplied by the composition-weighted average of these pair breaking energies:\n$$\n\\Delta H_{\\text{bonds}, i} = z \\sum_{j=1}^{m} x_j W_{ij}(T)\n$$\nThis enthalpy term, $\\Delta H_{\\text{bonds}, i}$, approximates the intrinsic free energy change in the crystal.\n\nThe second term relates to the chemical reservoir. By definition, the chemical potential of species $i$, $\\mu_i$, is the change in the Gibbs free energy of a system when one particle of species $i$ is added at constant $T$ and $P$. Therefore, when the removed atom is added to the reservoir, the reservoir's free energy changes by $+\\mu_i$. Consequently, the change in the system's (the crystal's) free energy due to this exchange is $-\\mu_i$.\n\nCombining these two contributions, the vacancy formation Gibbs free energy for removing an atom of species $i$ is given by the equation:\n$$\nG_{f,i}^{v} = \\Delta H_{\\text{bonds}, i} - \\mu_i = \\left( z \\sum_{j=1}^{m} x_j W_{ij}(T) \\right) - \\mu_i\n$$\nThe problem provides that the pair breaking energies $W_{ij}$ may be temperature-dependent, following a linear relationship:\n$$\nW_{ij}(T) = W_{ij}(T_{\\mathrm{ref}}) + \\alpha_{ij}(T - T_{\\mathrm{ref}})\n$$\nwhere $T_{\\mathrm{ref}}$ is a reference temperature, and $\\alpha_{ij}$ is the linear temperature coefficient. If $\\alpha_{ij}$ is not specified, it is taken to be zero.\n\nThe chemical potentials $\\mu_i$ are provided either in electron-volts per atom ($\\mathrm{eV/atom}$) or kilojoules per mole ($\\mathrm{kJ/mol}$). If the latter, they must be converted to $\\mathrm{eV/atom}$ using the provided conversion factor:\n$$\n\\mu_i \\, [\\mathrm{eV/atom}] = \\frac{\\mu_i \\, [\\mathrm{kJ/mol}]}{96.485332123 \\, [\\mathrm{kJ/mol \\cdot (eV/atom)^{-1}}]}\n$$\n\nThe algorithm to solve the problem for each test case is as follows:\n1.  Identify all input parameters: temperature $T$, reference temperature $T_{\\mathrm{ref}}$, coordination number $z$, composition vector $\\boldsymbol{x}$, chemical potentials $\\boldsymbol{\\mu}$ along with their units, the reference pair breaking energy matrix $W(T_{\\mathrm{ref}})$, and the temperature coefficient matrix $\\alpha$ (if provided).\n2.  If the units of $\\boldsymbol{\\mu}$ are $\\mathrm{kJ/mol}$, convert each $\\mu_i$ to $\\mathrm{eV/atom}$ using the specified conversion constant.\n3.  Calculate the temperature-dependent pair breaking energy matrix $W(T)$. If $\\alpha$ is provided and $T \\neq T_{\\mathrm{ref}}$, compute $W_{ij}(T) = W_{ij}(T_{\\mathrm{ref}}) + \\alpha_{ij}(T - T_{\\mathrm{ref}})$ for all pairs $(i, j)$. Otherwise, $W(T) = W(T_{\\mathrm{ref}})$.\n4.  For each species $i$ in the alloy:\n    a. Compute the broken-bond enthalpy $\\Delta H_{\\text{bonds}, i}$ using the mean-field formula: $\\Delta H_{\\text{bonds}, i} = z \\sum_{j=1}^{m} x_j W_{ij}(T)$. This is equivalent to the dot product of the $i$-th row of the $z \\cdot W(T)$ matrix and the composition vector $\\boldsymbol{x}$.\n    b. Compute the vacancy formation free energy $G_{f,i}^{v} = \\Delta H_{\\text{bonds}, i} - \\mu_i$.\n5.  Collect the calculated $G_{f,i}^{v}$ values for all species into a list for the current test case.\n6.  Repeat for all test cases and format the final collection of lists into a single string as specified, with all numerical values rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the vacancy formation Gibbs free energy for removing an atom of each\n    species in a random multicomponent substitutional alloy based on a mean-field model.\n    \"\"\"\n    KJ_PER_MOL_TO_EV_PER_ATOM = 96.485332123\n\n    test_cases = [\n        # Case 1\n        {\n            \"T\": 1200, \"T_ref\": 1200, \"z\": 12,\n            \"x\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"mu\": np.array([-20.0, -19.5, -21.0, -20.2]),\n            \"mu_units\": \"kJ/mol\",\n            \"W_ref\": np.array([\n                [0.10, 0.11, 0.09, 0.10],\n                [0.11, 0.10, 0.10, 0.09],\n                [0.09, 0.10, 0.10, 0.11],\n                [0.10, 0.09, 0.11, 0.10]\n            ]),\n            \"alpha\": None\n        },\n        # Case 2\n        {\n            \"T\": 1000, \"T_ref\": 1000, \"z\": 12,\n            \"x\": np.array([0.2, 0.2, 0.2, 0.2, 0.2]),\n            \"mu\": np.array([-0.220, -0.210, -0.230, -0.220, -0.215]),\n            \"mu_units\": \"eV/atom\",\n            \"W_ref\": np.array([\n                [0.100, 0.090, 0.100, 0.095, 0.098],\n                [0.090, 0.070, 0.080, 0.075, 0.078],\n                [0.100, 0.080, 0.100, 0.095, 0.094],\n                [0.095, 0.075, 0.095, 0.100, 0.096],\n                [0.098, 0.078, 0.094, 0.096, 0.100]\n            ]),\n            \"alpha\": None\n        },\n        # Case 3\n        {\n            \"T\": 900, \"T_ref\": 900, \"z\": 8,\n            \"x\": np.array([0.9, 0.1]),\n            \"mu\": np.array([-15.0, -12.0]),\n            \"mu_units\": \"kJ/mol\",\n            \"W_ref\": np.array([\n                [0.12, 0.10],\n                [0.10, 0.08]\n            ]),\n            \"alpha\": None\n        },\n        # Case 4\n        {\n            \"T\": 1600, \"T_ref\": 1000, \"z\": 12,\n            \"x\": np.array([1/3, 1/3, 1/3]),\n            \"mu\": np.array([-18.0, -19.0, -17.5]),\n            \"mu_units\": \"kJ/mol\",\n            \"W_ref\": np.array([\n                [0.110, 0.100, 0.095],\n                [0.100, 0.105, 0.098],\n                [0.095, 0.098, 0.110]\n            ]),\n            \"alpha\": np.array([\n                [-1.0e-5, -1.2e-5, -0.9e-5],\n                [-1.2e-5, -1.1e-5, -1.0e-5],\n                [-0.9e-5, -1.0e-5, -1.05e-5]\n            ])\n        },\n        # Case 5\n        {\n            \"T\": 700, \"T_ref\": 700, \"z\": 12,\n            \"x\": np.array([0.5, 0.3, 0.2]),\n            \"mu\": np.array([-0.180, -0.160, -0.150]),\n            \"mu_units\": \"eV/atom\",\n            \"W_ref\": np.array([\n                [0.090, 0.085, 0.080],\n                [0.085, 0.090, 0.082],\n                [0.080, 0.082, 0.095]\n            ]),\n            \"alpha\": None\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        T, T_ref, z = case[\"T\"], case[\"T_ref\"], case[\"z\"]\n        x, mu, mu_units = case[\"x\"], case[\"mu\"], case[\"mu_units\"]\n        W_ref, alpha = case[\"W_ref\"], case[\"alpha\"]\n\n        # 1. Convert chemical potentials to eV/atom if necessary\n        mu_eV = mu\n        if mu_units == \"kJ/mol\":\n            mu_eV = mu / KJ_PER_MOL_TO_EV_PER_ATOM\n\n        # 2. Calculate temperature-dependent pair breaking energies W(T)\n        delta_T = T - T_ref\n        W_T = W_ref\n        if alpha is not None and delta_T != 0:\n            W_T = W_ref + alpha * delta_T\n        \n        # 3. Compute broken-bond enthalpy for each species i\n        # np.dot(W_T, x) computes sum_j(W_ij * x_j) for each row i\n        delta_H_bonds = z * np.dot(W_T, x)\n        \n        # 4. Compute vacancy formation Gibbs free energy\n        G_f_v = delta_H_bonds - mu_eV\n        \n        all_results.append(G_f_v)\n\n    # Format the final output string\n    formatted_results = []\n    for res_list in all_results:\n        formatted_list_str = \"[\" + \",\".join([f\"{val:.6f}\" for val in res_list]) + \"]\"\n        formatted_results.append(formatted_list_str)\n    \n    final_output_str = \"[\" + \",\".join(formatted_results) + \"]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}