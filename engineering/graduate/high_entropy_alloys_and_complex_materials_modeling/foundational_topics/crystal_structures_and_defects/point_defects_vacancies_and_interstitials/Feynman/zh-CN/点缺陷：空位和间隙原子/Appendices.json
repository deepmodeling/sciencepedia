{
    "hands_on_practices": [
        {
            "introduction": "在高熵合金中，空位形成能是决定其热力学稳定性和动力学行为的关键参数。由于化学复杂性，不同尺寸的原子占据晶格点会引入局部应变场，该练习将引导你从连续介质弹性力学的第一性原理出发，推导这种原子尺寸错配对空位形成能的贡献 。通过这个推导，你将深入理解微观原子结构与宏观弹性响应之间的联系。",
            "id": "3754656",
            "problem": "考虑一种化学无序的高熵合金 (HEA)，该合金被建模为一个无限、均匀、各向同性的弹性连续体，其特征为体积模量 $K$ 和剪切模量 $\\mu$。设平均晶格位置的体积为 $V_0$，并考虑一种特定的原子种类 $i$，其原子体积为 $V_i \\neq V_0$。将晶格位置上的原子种类 $i$ 的存在视为一个嵌入在弹性基体中的体积为 $V_0$ 的球形夹杂物，该夹杂物被赋予了均匀的静水本征应变 $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\,\\delta_{ij}$，其中膨胀错配 $\\eta$ 定义为 $\\eta = \\frac{V_i - V_0}{V_0}$。假设夹杂物内外的弹性模量相同，且无外部载荷。\n\n通过从该位置移除原子种类 $i$ 形成一个空位，我们将尺寸错配对空位形成能的贡献定义为仅与移除错配原子的本征应变相关的弹性应变能变化，而忽略任何与空位本身相关的、不依赖于原子种类的弛豫。也就是说，该贡献是夹杂物问题的最终弹性自能与初始弹性自能之差，其中一旦本征应变被移除，最终的弹性自能即为零。\n\n从各向同性线弹性理论和包含本征应变的本构关系出发，\n$$\n\\sigma_{ij} = 2\\mu\\left(\\varepsilon_{ij} - \\varepsilon^{*}_{ij}\\right) + \\lambda\\,\\delta_{ij}\\left(\\varepsilon_{kk} - \\varepsilon^{*}_{kk}\\right)\n$$\n其中 $\\lambda$ 是 Lamé 第一参数且 $K = \\lambda + \\frac{2}{3}\\mu$，并利用夹杂物内外位移场的球对称性，推导由错配原子储存的弹性自能，并计算尺寸错配对空位形成能的贡献。将您的最终答案表示为由 $K$、$ \\mu$、$V_i$ 和 $V_0$ 构成的单一闭合形式解析表达式，并以焦耳为单位报告。不要进行任何数值计算。",
            "solution": "该问题要求推导高熵合金中尺寸错配对空位形成能的贡献，该合金被建模为各向同性弹性连续体。该贡献定义为移除与错配原子相关的本征应变时的弹性应变能变化。初始状态包含一个错配原子，它储存了弹性自能 $E_{self}$。移除该原子后的最终状态，其来自该来源的弹性自能被定义为零。因此，所要求的贡献为 $E_{contribution} = E_{final} - E_{initial} = 0 - E_{self} = -E_{self}$。主要任务是计算 $E_{self}$。\n\n错配原子被建模为无限基体中体积为 $V_0$ 的球形夹杂物。该夹杂物具有均匀的静水本征应变 $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\,\\delta_{ij}$，其中 $\\eta = \\frac{V_i - V_0}{V_0}$ 是膨胀错配。夹杂物内外的弹性模量（体积模量 $K$ 和剪切模量 $\\mu$）相同。这是一个经典的 Eshelby 夹杂物问题。\n\n由于球对称性，位移场 $\\vec{u}$ 必须是纯径向的，即 $u_r(r)$。在球坐标中，满足平衡方程的位移场的通解形式为 $u_r(r) = Ar + B/r^2$。\n在夹杂物内部（$r \\le R_0$，其中 $V_0 = \\frac{4}{3}\\pi R_0^3$），位移在原点 $r=0$ 处必须是有限的，这要求 $B=0$。因此，内部的位移场为：\n$$u_r^{in}(r) = Ar$$\n在夹杂物外部（$r  R_0$），位移必须在 $r \\to \\infty$ 时趋于零，这要求 $A=0$。因此，外部的位移场为：\n$$u_r^{out}(r) = \\frac{C}{r^2}$$\n常数 $A$ 和 $C$ 由界面 $r=R_0$ 处的边界条件确定。\n\n总应变张量 $\\varepsilon_{ij}$ 的分量由位移场推导得出。\n在夹杂物内部（$r \\le R_0$）：\n径向应变和切向应变为 $\\varepsilon_{rr}^{in} = \\frac{du_r^{in}}{dr} = A$ 和 $\\varepsilon_{\\theta\\theta}^{in} = \\varepsilon_{\\phi\\phi}^{in} = \\frac{u_r^{in}}{r} = A$。\n应变张量的迹（体积应变）为 $\\varepsilon_{kk}^{in} = \\varepsilon_{rr}^{in} + 2\\varepsilon_{\\theta\\theta}^{in} = 3A$。\n\n在夹杂物外部（$r  R_0$）：\n应变为 $\\varepsilon_{rr}^{out} = \\frac{du_r^{out}}{dr} = -\\frac{2C}{r^3}$ 和 $\\varepsilon_{\\theta\\theta}^{out} = \\varepsilon_{\\phi\\phi}^{out} = \\frac{u_r^{out}}{r} = \\frac{C}{r^3}$。\n迹为 $\\varepsilon_{kk}^{out} = \\varepsilon_{rr}^{out} + 2\\varepsilon_{\\theta\\theta}^{out} = -\\frac{2C}{r^3} + 2\\frac{C}{r^3} = 0$。\n\n应力张量 $\\sigma_{ij}$ 由本构关系 $\\sigma_{ij} = 2\\mu(\\varepsilon_{ij} - \\varepsilon^{*}_{ij}) + \\lambda\\,\\delta_{ij}(\\varepsilon_{kk} - \\varepsilon^{*}_{kk})$ 给出。本征应变在夹杂物内部为 $\\varepsilon^{*}_{ij} = \\frac{1}{3}\\eta\\delta_{ij}$，在外部为零。其迹为 $\\varepsilon^{*}_{kk}=\\eta$。\n\n在夹杂物内部（$r \\le R_0$）：\n$\\sigma_{rr}^{in} = 2\\mu(\\varepsilon_{rr}^{in} - \\varepsilon_{rr}^{*}) + \\lambda(\\varepsilon_{kk}^{in} - \\varepsilon_{kk}^{*}) = 2\\mu\\left(A - \\frac{1}{3}\\eta\\right) + \\lambda(3A - \\eta)$。\n重新整理各项，$\\sigma_{rr}^{in} = (3\\lambda+2\\mu)A - (\\lambda + \\frac{2}{3}\\mu)\\eta$。\n使用关系式 $K = \\lambda + \\frac{2}{3}\\mu$ 和 $3K = 3\\lambda + 2\\mu$，我们得到 $\\sigma_{rr}^{in} = 3KA - K\\eta$。\n类似地，$\\sigma_{\\theta\\theta}^{in} = \\sigma_{\\phi\\phi}^{in} = \\sigma_{rr}^{in}$。应力是静水应力：$\\sigma_{ij}^{in} = (3KA - K\\eta)\\delta_{ij}$。\n\n在夹杂物外部（$r  R_0$），$\\varepsilon^{*}_{ij}=0$：\n$\\sigma_{rr}^{out} = 2\\mu\\varepsilon_{rr}^{out} + \\lambda\\varepsilon_{kk}^{out} = 2\\mu\\left(-\\frac{2C}{r^3}\\right) + \\lambda(0) = -\\frac{4\\mu C}{r^3}$。\n\n在界面 $r=R_0$ 处，位移和径向应力都必须是连续的。\n1. 位移的连续性：$u_r^{in}(R_0) = u_r^{out}(R_0) \\implies AR_0 = \\frac{C}{R_0^2} \\implies C = AR_0^3$。\n2. 径向应力的连续性：$\\sigma_{rr}^{in}(R_0) = \\sigma_{rr}^{out}(R_0) \\implies 3KA - K\\eta = -\\frac{4\\mu C}{R_0^3}$。\n将 $C=AR_0^3$ 代入应力连续性方程：\n$3KA - K\\eta = -4\\mu A \\implies (3K+4\\mu)A = K\\eta \\implies A = \\frac{K\\eta}{3K+4\\mu}$。\n\n夹杂物内部的应力是均匀的，现在可以计算得出：\n$\\sigma_{rr}^{in} = 3KA - K\\eta = K(3A-\\eta) = K\\left(3\\frac{K\\eta}{3K+4\\mu} - \\eta\\right) = K\\eta\\left(\\frac{3K - (3K+4\\mu)}{3K+4\\mu}\\right)$。\n$$\\sigma_{rr}^{in} = -\\frac{4\\mu K \\eta}{3K+4\\mu}$$\n因此，内部的应力张量为 $\\sigma_{ij}^{in} = \\left(-\\frac{4\\mu K \\eta}{3K+4\\mu}\\right)\\delta_{ij}$。\n\n弹性自能 $E_{self}$ 是储存在物体中的总应变能，由内应力对本征应变做功给出。对于夹杂物中的均匀本征应变，其表达式为：\n$$E_{self} = -\\frac{1}{2} \\int_{V_{inclusion}} \\sigma_{ij}^{in} \\varepsilon_{ij}^* dV = -\\frac{1}{2} V_0 (\\sigma_{ij}^{in} \\varepsilon_{ij}^*)$$\n张量缩并为 $\\sigma_{ij}^{in} \\varepsilon_{ij}^* = \\left(-\\frac{4\\mu K \\eta}{3K+4\\mu}\\delta_{ij}\\right) \\left(\\frac{1}{3}\\eta\\delta_{ij}\\right) = -\\frac{4\\mu K \\eta^2}{3(3K+4\\mu)} (\\delta_{ij}\\delta_{ij})$。\n因为 $\\delta_{ij}\\delta_{ij} = \\delta_{11}+\\delta_{22}+\\delta_{33}=3$，我们有：\n$\\sigma_{ij}^{in} \\varepsilon_{ij}^* = -\\frac{4\\mu K \\eta^2}{3K+4\\mu}$。\n将此代入能量表达式：\n$$E_{self} = -\\frac{1}{2} V_0 \\left(-\\frac{4\\mu K \\eta^2}{3K+4\\mu}\\right) = \\frac{2\\mu K V_0 \\eta^2}{3K+4\\mu}$$\n这就是由错配原子储存的弹性自能。问题将尺寸错配对空位形成能的贡献定义为 $E_{contribution} = -E_{self}$。\n$$E_{contribution} = -\\frac{2\\mu K V_0 \\eta^2}{3K+4\\mu}$$\n最后，代入错配参数的定义 $\\eta = \\frac{V_i - V_0}{V_0}$：\n$$E_{contribution} = -\\frac{2\\mu K V_0}{3K+4\\mu} \\left(\\frac{V_i - V_0}{V_0}\\right)^2 = -\\frac{2\\mu K}{3K+4\\mu} \\frac{(V_i - V_0)^2}{V_0}$$\n该表达式给出了尺寸错配对空位形成能的贡献，单位为焦耳。",
            "answer": "$$\n\\boxed{-\\frac{2\\mu K}{3K+4\\mu} \\frac{(V_i - V_0)^2}{V_0}}\n$$"
        },
        {
            "introduction": "在理论推导的基础上，我们将转向现代计算材料科学中的一个核心实际问题。虽然第一性原理方法（如密度泛函理论）是计算缺陷形成能的有力工具，但这些计算总是在有限尺寸的超胞中进行，并受周期性边界条件的影响。这项实践将指导你推导并应用一个标度律来校正由此产生的有限尺寸效应，这是从原子模拟中获得精确热力学数据的关键一步 。",
            "id": "3754746",
            "problem": "考虑一种由五种难熔元素组成的化学无序等原子体心立方高熵合金 (HEA)，其处于 Born–von Karman 周期性边界条件下。在一个线性尺寸为 $L$ 的立方特殊准随机结构 (SQS) 超胞序列中引入单个中性空位，使得空位浓度 $c \\sim L^{-3}$。空位形成能 $E_{f}(L)$ 是通过密度泛函理论 (DFT) 的总能量，根据标准定义 $E_{f}(L) = E^{\\mathrm{def}}(L) - E^{\\mathrm{perf}}(L) + \\mu$ 得到的，其中 $E^{\\mathrm{def}}(L)$ 和 $E^{\\mathrm{perf}}(L)$ 分别是含缺陷超胞和完美超胞的总能量，$\\mu$ 是相应的元素化学势。在金属体系中，空位是中性的，不存在长程静电项。介质的弹性响应可以通过线性弹性理论很好地描述，点缺陷在有效各向同性介质中被建模为一个弹性偶极子张量 $P_{ij}$，该介质由 Lamé 参数 $\\lambda$ 和 $\\mu$ (剪切模量) 表征。\n\n您已获得三个立方超胞测得的空位形成能：\n- $L_{1} = 10\\,\\mathrm{\\AA}$，其 $E_{f}(L_{1}) = 1.79\\,\\mathrm{eV}$，\n- $L_{2} = 12\\,\\mathrm{\\AA}$，其 $E_{f}(L_{2}) = 1.7520833\\,\\mathrm{eV}$，\n- $L_{3} = 14\\,\\mathrm{\\AA}$，其 $E_{f}(L_{3}) = 1.732815\\,\\mathrm{eV}$。\n\n任务：\n1. 从将点缺陷描述为产生弹性偶极子张量 $P_{ij}$ 的局域力分布的连续介质力学描述出发，并利用周期性边界条件下缺陷的渐近远场，推断周期性镜像之间相互作用能的主导阶 $L$-依赖性。论证金属 HEA 中中性空位的主导有限尺寸误差的函数形式，并为 $E_{f}(L)$ 在 $L \\to \\infty$ 时的行为提出一个标度律。\n2. 使用提出的标度律，拟合给定数据以提取无限大尺寸极限 $E_{f}(\\infty)$ 和主导的有限尺寸系数。然后通过 $\\Delta E(L_{2}) = E_{f}(L_{2}) - E_{f}(\\infty)$ 计算在 $L_{2}$ 处的有限尺寸误差。\n3. 提供最终外推得到的无限大尺寸空位形成能 $E_{f}(\\infty)$，单位为电子伏特。将您的最终答案四舍五入到四位有效数字，并以 $\\mathrm{eV}$ 为单位表示能量。",
            "solution": "该问题要求通过对一系列有限尺寸超胞计算结果进行外推，来确定高熵合金中无限大尺寸的空位形成能 $E_{f}(\\infty)$。该过程首先需要建立一个理论标度律，然后将所提供的数据拟合到该定律上。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 体系：化学无序的等原子体心立方高熵合金 (BCC HEA)，由五种难熔元素组成。\n- 边界条件：Born–von Karman 周期性边界条件 (PBC)。\n- 缺陷：单个中性空位。\n- 超胞：线性尺寸为 $L$ 的立方特殊准随机结构 (SQS)。\n- 空位形成能定义：$E_{f}(L) = E^{\\mathrm{def}}(L) - E^{\\mathrm{perf}}(L) + \\mu$。\n- 物理模型：在金属中空位是中性的，因此长程静电相互作用不存在。体系的响应由线性弹性理论控制，缺陷被建模为有效各向同性介质中的弹性偶极子张量 $P_{ij}$，该介质具有 Lamé 参数 $\\lambda$ 和 $\\mu$。\n- 数据：\n  - $L_{1} = 10\\,\\mathrm{\\AA}$，$E_{f}(L_{1}) = 1.79\\,\\mathrm{eV}$。\n  - $L_{2} = 12\\,\\mathrm{\\AA}$，$E_{f}(L_{2}) = 1.7520833\\,\\mathrm{eV}$。\n  - $L_{3} = 14\\,\\mathrm{\\AA}$，$E_{f}(L_{3}) = 1.732815\\,\\mathrm{eV}$。\n\n**1.2. 验证：**\n- **科学依据：** 该问题牢固地植根于计算材料科学和连续介质力学的原理。使用 DFT、SQS 超胞以及分析由周期性边界条件引起的有限尺寸效应是标准做法。PBC下点缺陷弹性相互作用的理论框架是完善的（参见 Leslie  Gillan, J. Phys. C, 1985）。\n- **适定性：** 问题提供了三个数据点来确定一个具有物理动机的标度律的参数。这是一个充分且定义明确的数学任务。\n- **客观性和完整性：** 问题以精确、客观的语言陈述。所提供的数据足以执行所需任务。数值以高精度给出，表明它们是为了得到一个清晰的解而构建的。\n\n**1.3. 结论：**\n该问题在科学上是合理的、适定的且内部一致的。因此，被判定为 **有效**。\n\n### 步骤 2：推导与求解\n\n**任务 1：有限尺寸标度律**\n在周期性边界条件下，尺寸为 $L$ 的有限超胞中计算得到的形成能 $E_{f}(L)$ 可以表示为真实的无限大尺寸值 $E_{f}(\\infty)$ 与一个依赖于尺寸的误差项 $E_{\\mathrm{err}}(L)$ 之和：\n$$E_{f}(L) = E_{f}(\\infty) + E_{\\mathrm{err}}(L)$$\n该误差项源于缺陷与其自身周期性镜像之间的伪相互作用。对于金属体系中的中性点缺陷，主导的长程相互作用是弹性的，而非静电的。缺陷在周围晶格中引起应变场，在远场可以用弹性偶极子张量 $P_{ij}$ 来描述。中心原胞中的缺陷与其周期性镜像之间的相互作用能是误差的主要来源。\n\n在各向同性弹性介质中，两个相距为 $r$ 的相同弹性偶极子之间的相互作用能与 $r^{-3}$ 成比例。在边长为 $L$ 的立方超胞中，周期性边界条件下的镜像位于晶格矢量 $\\mathbf{R}_{\\mathbf{n}} = L(n_x, n_y, n_z)$ 处，其中整数 $(n_x, n_y, n_z)$ 不全为零。总相互作用能是对所有周期性镜像的求和：\n$$E_{\\mathrm{err}}(L) \\propto \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n}\\neq\\mathbf{0}} \\frac{1}{|\\mathbf{R}_{\\mathbf{n}}|^3} = \\frac{1}{L^3} \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n}\\neq\\mathbf{0}} \\frac{1}{(n_x^2+n_y^2+n_z^2)^{3/2}}$$\n该和式是一个无量纲常数，称为晶格和。因此，由弹性相互作用引起的主导阶有限尺寸误差与 $L^{-3}$ 成比例。更高阶的项，例如与 $L^{-5}$ 成比例的项，可能源于离散效应或更高阶的多极矩，但 $L^{-3}$ 项是主导的。因此，提出的空位形成能标度律为：\n$$E_{f}(L) = E_{f}(\\infty) + \\frac{A}{L^3}$$\n其中 $A$ 是一个系数，取决于材料的弹性常数和空位的弹性偶极子张量的迹。该方程表示 $E_f(L)$ 和 $L^{-3}$ 之间的线性关系。\n\n**任务 2：数据拟合与误差计算**\n我们需要将给定数据拟合到导出的标度律 $y = b + mx$，其中 $y = E_f(L)$，$x = L^{-3}$，$b = E_f(\\infty)$，$m = A$。\n数据点为：\n1. $(x_1, y_1) = ( (10\\,\\mathrm{\\AA})^{-3}, 1.79\\,\\mathrm{eV} ) = (0.001\\,\\mathrm{\\AA}^{-3}, 1.79\\,\\mathrm{eV})$\n2. $(x_2, y_2) = ( (12\\,\\mathrm{\\AA})^{-3}, 1.7520833\\,\\mathrm{eV} ) = (\\frac{1}{1728}\\,\\mathrm{\\AA}^{-3}, 1.7520833\\,\\mathrm{eV})$\n3. $(x_3, y_3) = ( (14\\,\\mathrm{\\AA})^{-3}, 1.732815\\,\\mathrm{eV} ) = (\\frac{1}{2744}\\,\\mathrm{\\AA}^{-3}, 1.732815\\,\\mathrm{eV})$\n\n我们利用前两个数据点来确定参数 $A$ 和 $E_f(\\infty)$。第二个数据点 $1.7520833\\,\\mathrm{eV}$ 的高精度表明它可能表示一个循环小数 $1.75208\\overline{3}\\,\\mathrm{eV}$。这是适定性学术问题中的一个常见特征。\n我们来验证这个假设。作为分数，$0.05208\\overline{3} = \\frac{5}{96}$。\n所以我们检验假设 $E_f(L_2) = 1.7 + \\frac{5}{96} = 1.75208\\overline{3}\\,\\mathrm{eV}$。\n我们建立一个二元线性方程组：\n$$1.79 = E_f(\\infty) + A \\cdot (10^{-3})$$\n$$1.75208\\overline{3} = E_f(\\infty) + A \\cdot (12^{-3})$$\n第一个方程减去第二个方程：\n$$1.79 - 1.75208\\overline{3} = A \\left(\\frac{1}{1000} - \\frac{1}{1728}\\right)$$\n左边是 $0.03791\\overline{6}$。用分数形式表示，即 $1.79 = \\frac{179}{100}$ 和 $1.75208\\overline{3} = 1.7 + \\frac{5}{96} = \\frac{17}{10} + \\frac{5}{96} = \\frac{17 \\cdot 48 + 25}{480} = \\frac{816+25}{480} = \\frac{841}{480}$。\n$$LHS = \\frac{179}{100} - \\frac{841}{480} = \\frac{179 \\cdot 24 - 841 \\cdot 5}{2400} = \\frac{4296 - 4205}{2400} = \\frac{91}{2400}$$\n右边的项是：\n$$RHS = A \\left(\\frac{1}{1000} - \\frac{1}{1728}\\right) = A \\left(\\frac{1728 - 1000}{1728000}\\right) = A \\left(\\frac{728}{1728000}\\right)$$\n由于 $728 = 8 \\times 91$，我们有：\n$$RHS = A \\left(\\frac{91 \\cdot 8}{1728000}\\right)$$\n令两边相等：\n$$\\frac{91}{2400} = A \\frac{91 \\cdot 8}{1728000}$$\n解出 $A$：\n$$A = \\frac{91}{2400} \\cdot \\frac{1728000}{91 \\cdot 8} = \\frac{1}{2400} \\cdot \\frac{1728000}{8} = \\frac{17280}{24 \\cdot 8} = \\frac{17280}{192}$$\n由于 $1728 = 12^3=192 \\times 9$：\n$$A = \\frac{9 \\times 192 \\times 10}{192} = 90\\,\\mathrm{eV}\\cdot\\mathrm{\\AA}^3$$\n现在我们使用第一个数据点来求解 $E_f(\\infty)$：\n$$E_f(\\infty) = 1.79 - A \\cdot (10^{-3}) = 1.79 - 90 \\cdot 0.001 = 1.79 - 0.09 = 1.70\\,\\mathrm{eV}$$\n得到的标度律是 $E_{f}(L) = 1.70 + 90 L^{-3}$。\n\n我们用第三个数据点来检验这个定律：\n$$E_f(L_3) = 1.70 + \\frac{90}{14^3} = 1.70 + \\frac{90}{2744} \\approx 1.70 + 0.0327988 \\approx 1.7327988\\,\\mathrm{eV}$$\n这非常接近给定值 $1.732815\\,\\mathrm{eV}$。约 $\\approx 0.000016\\,\\mathrm{eV}$ 的微小差异在物理上是合理的，可以归因于尺寸为 $L_3$ 的 SQS 超胞的特定原子构型，这种构型在理想化的连续介质标度律周围引入了微小的统计涨落（“化学噪声”）。\n\n在 $L_2$ 处的有限尺寸误差是 $\\Delta E(L_2) = E_f(L_2) - E_f(\\infty)$。使用我们导出的定律，这正是修正项：\n$$\\Delta E(L_2) = \\frac{A}{L_2^3} = \\frac{90}{12^3} = \\frac{90}{1728} = \\frac{5}{96}\\,\\mathrm{eV} \\approx 0.0520833\\,\\mathrm{eV}$$\n\n**任务 3：最终外推能量**\n根据以上分析，外推得到的无限大尺寸极限下的空位形成能为：\n$$E_f(\\infty) = 1.70\\,\\mathrm{eV}$$\n问题要求最终答案四舍五入到四位有效数字。因此，$1.70$ 写作 $1.700$。",
            "answer": "$$\n\\boxed{1.700}\n$$"
        },
        {
            "introduction": "最后，我们将探讨如何利用精确计算的缺陷性质来预测材料的宏观动力学行为。这项高级实践要求你构建一个连接热力学（通过CALPHAD化学势）和动力学（通过动力学蒙特卡洛模拟）的桥梁。你将实现一个工作流，以确保动力学模拟中的速率参数满足热力学一致性，并用它来计算材料的扩散系数，这正是现代多尺度材料建模的基石之一 。",
            "id": "3754738",
            "problem": "您必须编写一个完整且可运行的程序，该程序在一个高熵合金（HEA）中，实现相图计算与热化学耦合（CALPHAD）热力学与动力学蒙特卡洛（kMC）扩散事件速率之间基于数学原理的耦合，重点关注点缺陷（空位和填隙原子）。该耦合必须强制执行巨正则细致平衡，以使kMC事件速率与CALPHAD化学势在热力学上保持一致。对于给定的一组测试用例，该程序必须计算最大细致平衡违背度的数值度量和总示踪扩散系数，并生成一行输出，将所有测试用例的结果聚合到一个用方括号括起来的逗号分隔列表中。\n\n推导和实现所需的基本原理如下：\n\n- 在温度为 $T$、化学势为 $\\{\\mu_s\\}$ 的条件下，一个能量为 $E$、物种 $s$ 的粒子数为 $\\{N_s\\}$ 的微观状态的巨正则系综权重正比于 $\\exp\\!\\left(-\\beta\\left[E - \\sum_s \\mu_s N_s\\right]\\right)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 在巨正则系综设定中，与物种 $s$ 关联的空位的平衡形成自由能表示为 $F^{\\mathrm{v}}_s$，其值为 $F^{\\mathrm{v}}_s = F^{\\mathrm{v},0}_s + \\mu_s$，其中 $F^{\\mathrm{v},0}_s$ 是一个与 $\\mu_s$ 无关的参考形成能。物种 $s$ 的填隙原子的平衡形成自由能表示为 $F^{\\mathrm{i}}_s$，其值为 $F^{\\mathrm{i}}_s = F^{\\mathrm{i},0}_s - \\mu_s$，其中 $F^{\\mathrm{i},0}_s$ 是一个参考形成能。\n- 在稀缺陷极限下，物种 $s$ 的空位和填隙原子的平衡浓度（分数）分别为 $c^{\\mathrm{v}}_s = g^{\\mathrm{v}}_s \\exp\\!\\left(-\\beta F^{\\mathrm{v}}_s\\right)$ 和 $c^{\\mathrm{i}}_s = g^{\\mathrm{i}}_s \\exp\\!\\left(-\\beta F^{\\mathrm{i}}_s\\right)$，其中 $g^{\\mathrm{v}}_s$ 和 $g^{\\mathrm{i}}_s$ 是简并因子，您必须对所有 $s$ 取 $g^{\\mathrm{v}}_s = g^{\\mathrm{i}}_s = 1$。\n- 动力学蒙特卡洛中的事件速率遵循阿伦尼乌斯形式。对于物种 $s$ 的空位介导的跳跃，其跳跃速率贡献为 $w^{\\mathrm{v}}_s = \\nu^{\\mathrm{jump,v}}_s \\, c^{\\mathrm{v}}_s \\, \\exp\\!\\left(-\\beta E^{\\mathrm{m,v}}_s\\right)$，其中 $\\nu^{\\mathrm{jump,v}}_s$ 是尝试频率，$E^{\\mathrm{m,v}}_s$ 是迁移势垒。对于填隙原子介导的跳跃，$w^{\\mathrm{i}}_s = \\nu^{\\mathrm{jump,i}}_s \\, c^{\\mathrm{i}}_s \\, \\exp\\!\\left(-\\beta E^{\\mathrm{m,i}}_s\\right)$，其定义类似。\n- 缺陷产生和湮灭之间的细致平衡要求在平衡时正向和反向倾向相等。对于物种 $s$ 的空位，如果产生倾向为 $r^{\\mathrm{create,v}}_s = \\nu^{\\mathrm{form,v}}_s \\, \\exp\\!\\left(-\\beta F^{\\mathrm{v}}_s\\right)$，湮灭倾向为 $r^{\\mathrm{ann,v}}_s = \\nu^{\\mathrm{ann,v}}_s \\, c^{\\mathrm{v}}_s$，则细致平衡强制要求 $r^{\\mathrm{create,v}}_s = r^{\\mathrm{ann,v}}_s$。对于填隙原子，情况类似，其产生倾向为 $r^{\\mathrm{create,i}}_s = \\nu^{\\mathrm{form,i}}_s \\, \\exp\\!\\left(-\\beta F^{\\mathrm{i}}_s\\right)$，湮灭倾向为 $r^{\\mathrm{ann,i}}_s = \\nu^{\\mathrm{ann,i}}_s \\, c^{\\mathrm{i}}_s$。\n\n根据这些原理，您必须实现一个工作流程，在给定CALPHAD化学势、特定物种的缺陷能量学和尝试频率的情况下，计算缺陷浓度、kMC跳跃速率，强制执行（或检查）缺陷产生/湮灭的细致平衡，并报告：\n- 一个定义为 $v_{\\max} = \\max_s \\left\\{ \\left| \\ln r^{\\mathrm{create,v}}_s - \\ln r^{\\mathrm{ann,v}}_s \\right|, \\left| \\ln r^{\\mathrm{create,i}}_s - \\ln r^{\\mathrm{ann,i}}_s \\right| \\right\\}$ 的细致平衡违背度量。\n- 总示踪扩散系数 $D_{\\mathrm{tot}} = \\sum_s D_s$，其中 $D_s = \\dfrac{a^2}{6} \\left(w^{\\mathrm{v}}_s + w^{\\mathrm{i}}_s\\right)$，$a$ 是晶格常数。\n\n所有能量必须以电子伏特（eV）为单位处理，温度以开尔文（K）为单位，尝试频率以秒的倒数（s⁻¹）为单位，晶格常数以米（m）为单位，最终的示踪扩散系数以平方米每秒（m²/s）为单位。细致平衡违背度是无量纲的。使用以电子伏特每开尔文为单位的玻尔兹曼常数：$k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5} \\, \\mathrm{eV/K}$。所有指数计算必须在数值上是稳健的。\n\n实现程序以计算以下测试套件。每个测试用例是一个元组，包含：\n- 温度 $T$（单位 K）。\n- 三物种CALPHAD化学势 $\\mu = [\\mu_A,\\mu_B,\\mu_C]$（单位 eV）。\n- 空位形成能 $F^{\\mathrm{v},0} = [F^{\\mathrm{v},0}_A, F^{\\mathrm{v},0}_B, F^{\\mathrm{v},0}_C]$（单位 eV）。\n- 填隙原子形成能 $F^{\\mathrm{i},0} = [F^{\\mathrm{i},0}_A, F^{\\mathrm{i},0}_B, F^{\\mathrm{i},0}_C]$（单位 eV）。\n- 空位迁移势垒 $E^{\\mathrm{m,v}} = [E^{\\mathrm{m,v}}_A, E^{\\mathrm{m,v}}_B, E^{\\mathrm{m,v}}_C]$（单位 eV）。\n- 填隙原子迁移势垒 $E^{\\mathrm{m,i}} = [E^{\\mathrm{m,i}}_A, E^{\\mathrm{m,i}}_B, E^{\\mathrm{m,i}}_C]$（单位 eV）。\n- 空位产生尝试频率 $\\nu^{\\mathrm{form,v}} = [\\nu^{\\mathrm{form,v}}_A, \\nu^{\\mathrm{form,v}}_B, \\nu^{\\mathrm{form,v}}_C]$（单位 s⁻¹）。\n- 空位湮灭尝试频率 $\\nu^{\\mathrm{ann,v}} = [\\nu^{\\mathrm{ann,v}}_A, \\nu^{\\mathrm{ann,v}}_B, \\nu^{\\mathrm{ann,v}}_C]$（单位 s⁻¹）。\n- 填隙原子产生尝试频率 $\\nu^{\\mathrm{form,i}} = [\\nu^{\\mathrm{form,i}}_A, \\nu^{\\mathrm{form,i}}_B, \\nu^{\\mathrm{form,i}}_C]$（单位 s⁻¹）。\n- 填隙原子湮灭尝试频率 $\\nu^{\\mathrm{ann,i}} = [\\nu^{\\mathrm{ann,i}}_A, \\nu^{\\mathrm{ann,i}}_B, \\nu^{\\mathrm{ann,i}}_C]$（单位 s⁻¹）。\n- 空位跳跃尝试频率 $\\nu^{\\mathrm{jump,v}} = [\\nu^{\\mathrm{jump,v}}_A, \\nu^{\\mathrm{jump,v}}_B, \\nu^{\\mathrm{jump,v}}_C]$（单位 s⁻¹）。\n- 填隙原子跳跃尝试频率 $\\nu^{\\mathrm{jump,i}} = [\\nu^{\\mathrm{jump,i}}_A, \\nu^{\\mathrm{jump,i}}_B, \\nu^{\\mathrm{jump,i}}_C]$（单位 s⁻¹）。\n- 晶格常数 $a$（单位 m）。\n\n使用以下四个测试用例，旨在探测不同的区域和边缘条件：\n\n1. 中等温度，平衡的物种能量学（理想情况）：\n   - $T = 1200$\n   - $\\mu = [-0.25, -0.30, -0.28]$\n   - $F^{\\mathrm{v},0} = [1.20, 1.40, 1.30]$\n   - $F^{\\mathrm{i},0} = [2.50, 2.10, 2.30]$\n   - $E^{\\mathrm{m,v}} = [0.60, 0.50, 0.55]$\n   - $E^{\\mathrm{m,i}} = [0.20, 0.30, 0.25]$\n   - $\\nu^{\\mathrm{form,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{form,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,i}} = [5.0\\times 10^{12}, 5.0\\times 10^{12}, 5.0\\times 10^{12}]$\n   - $a = 3.0\\times 10^{-10}$\n\n2. 低温，缺陷被强烈抑制（边界条件）：\n   - $T = 300$\n   - $\\mu = [-0.25, -0.30, -0.28]$\n   - $F^{\\mathrm{v},0} = [1.20, 1.40, 1.30]$\n   - $F^{\\mathrm{i},0} = [2.50, 2.10, 2.30]$\n   - $E^{\\mathrm{m,v}} = [0.60, 0.50, 0.55]$\n   - $E^{\\mathrm{m,i}} = [0.20, 0.30, 0.25]$\n   - $\\nu^{\\mathrm{form,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{form,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,i}} = [5.0\\times 10^{12}, 5.0\\times 10^{12}, 5.0\\times 10^{12}]$\n   - $a = 3.0\\times 10^{-10}$\n\n3. 高温，缺陷数量增多（边缘情况）：\n   - $T = 1800$\n   - $\\mu = [-0.25, -0.30, -0.28]$\n   - $F^{\\mathrm{v},0} = [1.20, 1.40, 1.30]$\n   - $F^{\\mathrm{i},0} = [2.50, 2.10, 2.30]$\n   - $E^{\\mathrm{m,v}} = [0.60, 0.50, 0.55]$\n   - $E^{\\mathrm{m,i}} = [0.20, 0.30, 0.25]$\n   - $\\nu^{\\mathrm{form,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{form,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,i}} = [5.0\\times 10^{12}, 5.0\\times 10^{12}, 5.0\\times 10^{12}]$\n   - $a = 3.0\\times 10^{-10}$\n\n4. 混合机制，具有依赖于物种的势垒（覆盖非对称动力学）：\n   - $T = 1200$\n   - $\\mu = [-0.20, -0.35, -0.32]$\n   - $F^{\\mathrm{v},0} = [1.10, 1.50, 1.40]$\n   - $F^{\\mathrm{i},0} = [2.60, 2.00, 2.40]$\n   - $E^{\\mathrm{m,v}} = [0.70, 0.45, 0.60]$\n   - $E^{\\mathrm{m,i}} = [0.15, 0.35, 0.30]$\n   - $\\nu^{\\mathrm{form,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,v}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{form,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{ann,i}} = [1.0\\times 10^{13}, 1.0\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,v}} = [8.0\\times 10^{12}, 1.2\\times 10^{13}, 1.0\\times 10^{13}]$\n   - $\\nu^{\\mathrm{jump,i}} = [6.0\\times 10^{12}, 4.0\\times 10^{12}, 5.0\\times 10^{12}]$\n   - $a = 3.0\\times 10^{-10}$\n\n您的程序必须为每个测试用例计算细致平衡违背度量 $v_{\\max}$ 和总示踪扩散系数 $D_{\\mathrm{tot}}$（单位 $\\mathrm{m}^2/\\mathrm{s}$）。最终输出必须是一行，包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：$[v_{\\max}^{(1)}, D_{\\mathrm{tot}}^{(1)}, v_{\\max}^{(2)}, D_{\\mathrm{tot}}^{(2)}, v_{\\max}^{(3)}, D_{\\mathrm{tot}}^{(3)}, v_{\\max}^{(4)}, D_{\\mathrm{tot}}^{(4)}]$。\n\n本问题不涉及角度。不得使用百分比；任何分数都应以小数处理。\n\n确保您的算法遵循上述基本原则，除了那些由基本定律和定义证明的快捷公式外，不使用任何其他快捷公式。所有计算必须内部一致且科学上现实，并按规定使用稀缺陷极限和阿伦尼乌斯动力学。",
            "solution": "所提出的问题是计算材料科学中一个有效且定义明确的练习。它要求在一种高熵合金（HEA）中，为点缺陷介导的扩散，实现源自CALPHAD的化学势与动力学蒙特卡洛（kMC）事件速率之间的热力学上一致的耦合。解决方案涉及应用统计力学和固态物理的基本原理。下面将进行分析，随后是计算实现。\n\n### 理论框架与推导\n\n问题的核心在于建立热力学状态变量（温度 $T$，化学势 $\\{\\mu_s\\}$）与动力学参数（缺陷浓度，跳跃速率）之间的关系。这是通过巨正则系综和细致平衡原理实现的。\n\n**1. 热力学量与缺陷浓度**\n\n我们首先定义热能因子 $\\beta = 1/(k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数（$k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5} \\, \\mathrm{eV/K}$），$T$ 是以开尔文为单位的绝对温度。\n\n问题指出系统处于巨正则系综中，可以与化学库交换粒子。因此，点缺陷的平衡形成自由能依赖于与该缺陷关联的物种 $s$ 的化学势。\n\n对于一个**空位**，它通过从晶格位置移除一个物种 $s$ 的原子并将其置于化学库中而产生，其形成自由能 $F^{\\mathrm{v}}_s$ 由下式给出：\n$$F^{\\mathrm{v}}_s = F^{\\mathrm{v},0}_s + \\mu_s$$\n这里，$F^{\\mathrm{v},0}_s$ 是一个不依赖于化学势的参考形成能分量。\n\n对于一个**填隙原子**，它通过从化学库中取一个物种 $s$ 的原子并将其插入晶格的填隙位置而产生，其形成自由能 $F^{\\mathrm{i}}_s$ 为：\n$$F^{\\mathrm{i}}_s = F^{\\mathrm{i},0}_s - \\mu_s$$\n这里，$F^{\\mathrm{i},0}_s$ 是填隙原子的参考形成能。\n\n在**稀缺陷极限**的假设下，每种类型缺陷的平衡位点分数（浓度）可以使用类玻尔兹曼表达式计算。鉴于简并因子 $g^{\\mathrm{v}}_s$ 和 $g^{\\mathrm{i}}_s$ 被指定为 $1$，浓度为：\n$$c^{\\mathrm{v}}_s = \\exp(-\\beta F^{\\mathrm{v}}_s) = \\exp(-\\beta (F^{\\mathrm{v},0}_s + \\mu_s))$$\n$$c^{\\mathrm{i}}_s = \\exp(-\\beta F^{\\mathrm{i}}_s) = \\exp(-\\beta (F^{\\mathrm{i},0}_s - \\mu_s))$$\n\n**2. 细致平衡与违背度量**\n\n细致平衡是热力学平衡的一个基本条件，它指出每个微观过程的速率等于其逆过程的速率。对于缺陷的产生和湮灭，这为动力学参数提供了一个强大的约束。\n\n物种 $s$ 的空位的正向过程（产生）和反向过程（湮灭）由以下倾向给出：\n- 产生：$r^{\\mathrm{create,v}}_s = \\nu^{\\mathrm{form,v}}_s \\, \\exp(-\\beta F^{\\mathrm{v}}_s)$\n- 湮灭：$r^{\\mathrm{ann,v}}_s = \\nu^{\\mathrm{ann,v}}_s \\, c^{\\mathrm{v}}_s$\n\n在平衡状态下，细致平衡要求 $r^{\\mathrm{create,v}}_s = r^{\\mathrm{ann,v}}_s$。将平衡浓度 $c^{\\mathrm{v}}_s = \\exp(-\\beta F^{\\mathrm{v}}_s)$ 代入湮灭倾向表达式，得到：\n$$\\nu^{\\mathrm{form,v}}_s \\, \\exp(-\\beta F^{\\mathrm{v}}_s) = \\nu^{\\mathrm{ann,v}}_s \\, \\exp(-\\beta F^{\\mathrm{v}}_s)$$\n这个等式成立的充要条件是尝试频率相等：$\\nu^{\\mathrm{form,v}}_s = \\nu^{\\mathrm{ann,v}}_s$。\n\n同样的逻辑适用于填隙原子，细致平衡意味着 $\\nu^{\\mathrm{form,i}}_s = \\nu^{\\mathrm{ann,i}}_s$。\n\n问题要求一个度量来量化对这一条件的任何违背。该度量定义为 $v_{\\max} = \\max_s \\left\\{ \\left| \\ln r^{\\mathrm{create,v}}_s - \\ln r^{\\mathrm{ann,v}}_s \\right|, \\left| \\ln r^{\\mathrm{create,i}}_s - \\ln r^{\\mathrm{ann,i}}_s \\right| \\right\\}$。我们来分析空位的项：\n$$\\ln r^{\\mathrm{create,v}}_s - \\ln r^{\\mathrm{ann,v}}_s = \\ln\\left( \\frac{r^{\\mathrm{create,v}}_s}{r^{\\mathrm{ann,v}}_s} \\right) = \\ln\\left( \\frac{\\nu^{\\mathrm{form,v}}_s \\, \\exp(-\\beta F^{\\mathrm{v}}_s)}{\\nu^{\\mathrm{ann,v}}_s \\, c^{\\mathrm{v}}_s} \\right)$$\n通过使用 $c^{\\mathrm{v}}_s$ 的平衡表达式，指数项被消去：\n$$\\ln r^{\\mathrm{create,v}}_s - \\ln r^{\\mathrm{ann,v}}_s = \\ln\\left( \\frac{\\nu^{\\mathrm{form,v}}_s}{\\nu^{\\mathrm{ann,v}}_s} \\right)$$\n因此，特定物种的违背度就是产生和湮灭尝试频率之比的对数的绝对值。总体违背度量 $v_{\\max}$ 是这些值在所有物种和两种缺陷类型（空位和填隙原子）上的最大值：\n$$v_{\\max} = \\max_{s \\in \\{A,B,C\\}} \\left\\{ \\left| \\ln\\left(\\frac{\\nu^{\\mathrm{form,v}}_s}{\\nu^{\\mathrm{ann,v}}_s}\\right) \\right|, \\left| \\ln\\left(\\frac{\\nu^{\\mathrm{form,i}}_s}{\\nu^{\\mathrm{ann,i}}_s}\\right) \\right| \\right\\}$$\n对于所提供的测试用例，所有的产生和湮灭频率都是相同的（$\\nu^{\\mathrm{form}} = \\nu^{\\mathrm{ann}} = 1.0 \\times 10^{13} \\, \\mathrm{s}^{-1}$），所以它们的比值为 $1$。$1$ 的自然对数是 $0$，这意味着对于所有测试用例，细致平衡违背度 $v_{\\max}$ 都将是 $0$。\n\n**3. 扩散与kMC跳跃速率**\n\n每种缺陷机制对原子扩散的贡献由kMC跳跃速率决定。这些速率遵循阿伦尼乌斯形式，取决于缺陷浓度、迁移势垒和跳跃本身的尝试频率。\n\n对于物种 $s$ 的空位介导的跳跃，速率为：\n$$w^{\\mathrm{v}}_s = \\nu^{\\mathrm{jump,v}}_s \\, c^{\\mathrm{v}}_s \\, \\exp(-\\beta E^{\\mathrm{m,v}}_s)$$\n其中 $E^{\\mathrm{m,v}}_s$ 是迁移能垒。为了数值稳定性，将指数项合并是有利的：\n$$w^{\\mathrm{v}}_s = \\nu^{\\mathrm{jump,v}}_s \\, \\exp(-\\beta (F^{\\mathrm{v}}_s + E^{\\mathrm{m,v}}_s)) = \\nu^{\\mathrm{jump,v}}_s \\, \\exp(-\\beta (F^{\\mathrm{v},0}_s + \\mu_s + E^{\\mathrm{m,v}}_s))$$\n\n类似地，对于物种 $s$ 的填隙原子介导的跳跃：\n$$w^{\\mathrm{i}}_s = \\nu^{\\mathrm{jump,i}}_s \\, c^{\\mathrm{i}}_s \\, \\exp(-\\beta E^{\\mathrm{m,i}}_s)$$\n$$w^{\\mathrm{i}}_s = \\nu^{\\mathrm{jump,i}}_s \\, \\exp(-\\beta (F^{\\mathrm{i}}_s + E^{\\mathrm{m,i}}_s)) = \\nu^{\\mathrm{jump,i}}_s \\, \\exp(-\\beta (F^{\\mathrm{i},0}_s - \\mu_s + E^{\\mathrm{m,i}}_s))$$\n\n物种 $s$ 的一个原子的总有效跳跃频率是两种机制贡献的总和，即 $(w^{\\mathrm{v}}_s + w^{\\mathrm{i}}_s)$。\n\n**4. 总示踪扩散系数**\n\n物种 $s$ 的示踪扩散系数 $D_s$ 与其跳跃频率和跳跃距离的平方（由晶格常数 $a$ 近似）有关。根据规定，我们使用以下公式计算：\n$$D_s = \\frac{a^2}{6} (w^{\\mathrm{v}}_s + w^{\\mathrm{i}}_s)$$\n因子 $1/6$ 是三维立方晶格中扩散的特征。总示踪扩散系数 $D_{\\mathrm{tot}}$ 是各物种扩散系数的总和：\n$$D_{\\mathrm{tot}} = \\sum_s D_s = \\frac{a^2}{6} \\sum_{s \\in \\{A,B,C\\}} (w^{\\mathrm{v}}_s + w^{\\mathrm{i}}_s)$$\n\n### 单个测试用例的算法\n\n每个测试用例的计算过程如下：\n1.  初始化 $D_{\\mathrm{tot}} = 0$ 和一个用于存储违背项的列表。\n2.  从输入中获取标量参数 $T$ 和 $a$，以及每个物种 $s \\in \\{A, B, C\\}$ 的矢量参数：$\\mu_s$, $F^{\\mathrm{v},0}_s$, $F^{\\mathrm{i},0}_s$, $E^{\\mathrm{m,v}}_s$, $E^{\\mathrm{m,i}}_s$，以及所有尝试频率 $\\nu$。\n3.  计算 $\\beta = 1 / (k_{\\mathrm{B}} T)$。\n4.  对于每个物种 $s$：\n    a. 计算违背项 $|\\ln(\\nu^{\\mathrm{form,v}}_s / \\nu^{\\mathrm{ann,v}}_s)|$ 和 $|\\ln(\\nu^{\\mathrm{form,i}}_s / \\nu^{\\mathrm{ann,i}}_s)|$，并将它们添加到违背项列表中。\n    b. 计算总空位激活能 $Q^{\\mathrm{v}}_s = F^{\\mathrm{v},0}_s + \\mu_s + E^{\\mathrm{m,v}}_s$。\n    c. 计算总填隙原子激活能 $Q^{\\mathrm{i}}_s = F^{\\mathrm{i},0}_s - \\mu_s + E^{\\mathrm{m,i}}_s$。\n    d. 计算跳跃速率 $w^{\\mathrm{v}}_s = \\nu^{\\mathrm{jump,v}}_s \\exp(-\\beta Q^{\\mathrm{v}}_s)$ 和 $w^{\\mathrm{i}}_s = \\nu^{\\mathrm{jump,i}}_s \\exp(-\\beta Q^{\\mathrm{i}}_s)$。\n    e. 计算物种扩散系数 $D_s = \\frac{a^2}{6} (w^{\\mathrm{v}}_s + w^{\\mathrm{i}}_s)$。\n    f. 将 $D_s$ 加到 $D_{\\mathrm{tot}}$ 的累加和中。\n5.  通过在违背项列表中找到最大值来确定最终度量 $v_{\\max}$。\n6.  该测试用例的结果是数对 $(v_{\\max}, D_{\\mathrm{tot}})$。\n\n此算法将针对所提供的测试用例进行实现，并将结果汇总成所需的输出格式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a detailed-balance violation metric and total tracer diffusivity\n    for point defects in a high-entropy alloy, based on a coupling between\n    CALPHAD thermodynamics and kMC kinetics.\n    \"\"\"\n    \n    # Boltzmann constant in eV/K\n    KB = 8.617333262e-5\n\n    # Test cases as defined in the problem statement.\n    # Each case is a tuple containing all parameters. For clarity, a dictionary\n    # structure is used internally for unpacking.\n    test_cases_data = [\n        # Case 1: Moderate temperature, balanced species energetics\n        {\n            \"T\": 1200.0, \"mu\": [-0.25, -0.30, -0.28],\n            \"F_v0\": [1.20, 1.40, 1.30], \"F_i0\": [2.50, 2.10, 2.30],\n            \"E_mv\": [0.60, 0.50, 0.55], \"E_mi\": [0.20, 0.30, 0.25],\n            \"nu_form_v\": [1e13, 1e13, 1e13], \"nu_ann_v\": [1e13, 1e13, 1e13],\n            \"nu_form_i\": [1e13, 1e13, 1e13], \"nu_ann_i\": [1e13, 1e13, 1e13],\n            \"nu_jump_v\": [1e13, 1e13, 1e13], \"nu_jump_i\": [5e12, 5e12, 5e12],\n            \"a\": 3.0e-10\n        },\n        # Case 2: Low temperature, strong defect suppression\n        {\n            \"T\": 300.0, \"mu\": [-0.25, -0.30, -0.28],\n            \"F_v0\": [1.20, 1.40, 1.30], \"F_i0\": [2.50, 2.10, 2.30],\n            \"E_mv\": [0.60, 0.50, 0.55], \"E_mi\": [0.20, 0.30, 0.25],\n            \"nu_form_v\": [1e13, 1e13, 1e13], \"nu_ann_v\": [1e13, 1e13, 1e13],\n            \"nu_form_i\": [1e13, 1e13, 1e13], \"nu_ann_i\": [1e13, 1e13, 1e13],\n            \"nu_jump_v\": [1e13, 1e13, 1e13], \"nu_jump_i\": [5e12, 5e12, 5e12],\n            \"a\": 3.0e-10\n        },\n        # Case 3: High temperature, enhanced defect populations\n        {\n            \"T\": 1800.0, \"mu\": [-0.25, -0.30, -0.28],\n            \"F_v0\": [1.20, 1.40, 1.30], \"F_i0\": [2.50, 2.10, 2.30],\n            \"E_mv\": [0.60, 0.50, 0.55], \"E_mi\": [0.20, 0.30, 0.25],\n            \"nu_form_v\": [1e13, 1e13, 1e13], \"nu_ann_v\": [1e13, 1e13, 1e13],\n            \"nu_form_i\": [1e13, 1e13, 1e13], \"nu_ann_i\": [1e13, 1e13, 1e13],\n            \"nu_jump_v\": [1e13, 1e13, 1e13], \"nu_jump_i\": [5e12, 5e12, 5e12],\n            \"a\": 3.0e-10\n        },\n        # Case 4: Mixed mechanism with species-dependent barriers\n        {\n            \"T\": 1200.0, \"mu\": [-0.20, -0.35, -0.32],\n            \"F_v0\": [1.10, 1.50, 1.40], \"F_i0\": [2.60, 2.00, 2.40],\n            \"E_mv\": [0.70, 0.45, 0.60], \"E_mi\": [0.15, 0.35, 0.30],\n            \"nu_form_v\": [1e13, 1e13, 1e13], \"nu_ann_v\": [1e13, 1e13, 1e13],\n            \"nu_form_i\": [1e13, 1e13, 1e13], \"nu_ann_i\": [1e13, 1e13, 1e13],\n            \"nu_jump_v\": [8e12, 1.2e13, 1e13], \"nu_jump_i\": [6e12, 4e12, 5e12],\n            \"a\": 3.0e-10\n        }\n    ]\n\n    results = []\n\n    for case in test_cases_data:\n        # Unpack parameters and convert lists to numpy arrays for vectorized operations\n        T = case[\"T\"]\n        mu = np.array(case[\"mu\"])\n        F_v0 = np.array(case[\"F_v0\"])\n        F_i0 = np.array(case[\"F_i0\"])\n        E_mv = np.array(case[\"E_mv\"])\n        E_mi = np.array(case[\"E_mi\"])\n        nu_form_v = np.array(case[\"nu_form_v\"])\n        nu_ann_v = np.array(case[\"nu_ann_v\"])\n        nu_form_i = np.array(case[\"nu_form_i\"])\n        nu_ann_i = np.array(case[\"nu_ann_i\"])\n        nu_jump_v = np.array(case[\"nu_jump_v\"])\n        nu_jump_i = np.array(case[\"nu_jump_i\"])\n        a = case[\"a\"]\n\n        # Calculate thermal energy factor beta\n        beta = 1.0 / (KB * T)\n\n        # 1. Calculate detailed-balance violation metric (v_max)\n        # The metric simplifies to comparing the log of frequency ratios\n        with np.errstate(divide='ignore', invalid='ignore'): # Handle potential division by zero\n            log_ratio_v = np.log(nu_form_v / nu_ann_v)\n            log_ratio_i = np.log(nu_form_i / nu_ann_i)\n        \n        # Replace NaN from 0/0 and -inf from log(0) with 0, as log(1)=0\n        log_ratio_v = np.nan_to_num(log_ratio_v, nan=0.0, posinf=np.inf, neginf=-np.inf)\n        log_ratio_i = np.nan_to_num(log_ratio_i, nan=0.0, posinf=np.inf, neginf=-np.inf)\n\n        # The metric is the maximum of the absolute values of these log ratios\n        v_max = np.max(np.abs(np.concatenate((log_ratio_v, log_ratio_i))))\n\n        # 2. Calculate total tracer diffusivity (D_tot)\n        \n        # Activation energies for vacancy and interstitial mechanisms\n        # Q_v = F_v + E_m = (F_v0 + mu) + E_mv\n        Q_v = F_v0 + mu + E_mv\n        \n        # Q_i = F_i + E_m = (F_i0 - mu) + E_mi\n        Q_i = F_i0 - mu + E_mi\n\n        # kMC jump rates for vacancy and interstitial mechanisms\n        # Using numerically robust combined exponential form\n        w_v = nu_jump_v * np.exp(-beta * Q_v)\n        w_i = nu_jump_i * np.exp(-beta * Q_i)\n\n        # Species-specific diffusivities\n        D_s = (a**2 / 6.0) * (w_v + w_i)\n\n        # Total tracer diffusivity\n        D_tot = np.sum(D_s)\n\n        results.extend([v_max, D_tot])\n\n    # Format the final output string as specified\n    print(f\"[{','.join(f'{r:.7e}' if isinstance(r, float) and r != 0.0 else str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}