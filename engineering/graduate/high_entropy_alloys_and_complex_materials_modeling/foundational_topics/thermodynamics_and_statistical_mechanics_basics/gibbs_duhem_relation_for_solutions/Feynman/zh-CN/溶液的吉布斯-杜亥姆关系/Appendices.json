{
    "hands_on_practices": [
        {
            "introduction": "吉布斯-杜亥姆关系式是多组分体系热力学性质的内在约束。在一个二元溶液中，如果我们知道了其中一个组分的活度系数随浓度的变化关系，那么另一个组分的行为就不是独立的。这个练习将指导你如何利用吉布斯-杜亥姆关系，从一个已知的活度系数表达式解析地推导出另一个，这是热力学模型构建中的一项基本技能。",
            "id": "3743533",
            "problem": "考虑一个嵌入在多元高熵合金（HEA, High-Entropy Alloy）中的二元置换合金子系统 $A$–$B$，在恒定温度 $T$ 和压力 $P$ 下进行建模。设溶液的摩尔吉布斯自由能为 $G(T,P,n_A,n_B)$，其化学势定义为 $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\neq i}}$，其中 $i \\in \\{A,B\\}$。活度遵循关系式 $\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$，其中每个组分的参考态是其在相同 $T$ 和 $P$ 下的纯液态（拉乌尔定律参考态）。对于等温、等压的二元溶液，Gibbs-Duhem 关系式适用。\n\n假设活度表示为 $a_i = \\gamma_i x_i$，其中 $x_i$ 是摩尔分数，$\\gamma_i$ 是活度系数。在该高熵合金子系统中，假设基于第一性原理的相互作用模型得出 B 组元依赖于组分的活度系数具有以下形式：\n$$\n\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3},\n$$\n其中 $a$ 和 $b$ 是与组分无关的参数，且 $x_A + x_B = 1$。在所述的参考态（拉乌尔定律）下，当 $x_A \\to 1$ 时，有 $\\gamma_A \\to 1$；当 $x_B \\to 1$ 时，有 $\\gamma_B \\to 1$。\n\n仅使用化学势和活度的基本定义，结合在恒定 $T$ 和 $P$ 下的 Gibbs-Duhem 关系式，推导由给定的 $\\ln \\gamma_B(x_A)$ 所隐含的 $\\ln \\gamma_A(x_A)$ 的闭合形式解析表达式。将您的最终结果表示为 $x_A$、$a$ 和 $b$ 的函数。无需进行数值计算，也无需四舍五入。只提供表达式；最终答案中不包含单位。",
            "solution": "根据规定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统：** 多元高熵合金 (HEA) 内的二元置换合金子系统 A–B。\n- **热力学条件：** 恒定温度 $T$ 和恒定压力 $P$。\n- **热力学势：** 摩尔吉布斯自由能为 $G(T,P,n_A,n_B)$。\n- **化学势定义：** 对于组分 $i \\in \\{A,B\\}$，$\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\neq i}}$。\n- **活度定义：** $\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$。\n- **活度系数定义：** $a_i = \\gamma_i x_i$，其中 $x_i$ 是摩尔分数，$\\gamma_i$ 是活度系数。\n- **参考态：** 每个组分的参考态是其在相同 $T$ 和 $P$ 下的纯液态。这对应于拉乌尔定律参考态。\n- **控制方程：** 等温、等压二元溶液的 Gibbs-Duhem 关系式。\n- **摩尔分数约束：** $x_A + x_B = 1$。\n- **给定函数形式：** B 组元的活度系数由 $\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$ 给出，其中 $a$ 和 $b$ 是常数。\n- **边界条件：** 根据拉乌尔定律参考态的定义，当 $x_i \\to 1$ 时 $\\gamma_i \\to 1$。具体来说，当 $x_A \\to 1$ 时 $\\gamma_A \\to 1$，当 $x_B \\to 1$ 时 $\\gamma_B \\to 1$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行有效性评估。\n- **科学依据：** 该问题牢固地植根于经典化学热力学。Gibbs-Duhem 关系式是多组分系统的基本状态方程之一。使用活度系数对数的多项式展开是溶液建模中的标准方法（例如，Margules 或 Redlich-Kister 方程）。高熵合金的背景具有科学相关性。\n- **适定性：** 该问题提供了一个活度系数的函数形式，并要求求解另一个。Gibbs-Duhem 关系式提供了必要的微分约束。此外，还为待求的活度系数提供了边界条件（当 $x_A \\to 1$ 时 $\\gamma_A \\to 1$），这允许确定积分常数，从而确保了唯一解。\n- **一致性检查：** 给定的 $\\ln \\gamma_B$ 形式必须与其边界条件一致。条件“当 $x_B \\to 1$ 时 $\\gamma_B \\to 1$”等价于“当 $x_A \\to 0$ 时 $\\ln \\gamma_B \\to 0$”。将 $x_A=0$ 代入给定表达式可得 $\\ln \\gamma_B(0) = a(0)^2 + b(0)^3 = 0$。这是一致的。\n- **客观性：** 该问题使用精确、无歧义的科学语言陈述。\n\n该问题未表现出验证清单中列出的任何缺陷（例如，科学不健全性、不完整性、矛盾、模糊性）。它是物理化学或材料科学领域一个标准的可解问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将推导解答。\n\n### 推导过程\n推导始于恒定温度 $T$ 和压力 $P$ 下二元混合物的 Gibbs-Duhem 关系式。用摩尔量表示，该关系式为：\n$$x_A d\\mu_A + x_B d\\mu_B = 0$$\n其中 $x_i$ 是组分 $i$ 的摩尔分数，$\\mu_i$ 是其化学势。\n\n根据定义，化学势与活度 $a_i$ 的关系为：\n$$\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$$\n由于 $T$ 和 $P$ 是常数，参考化学势 $\\mu_i^{\\mathrm{ref}}$ 也是常数。对 $\\mu_i$ 取微分可得：\n$$d\\mu_i = R T d(\\ln a_i)$$\n将此式代入 Gibbs-Duhem 方程并消去非零因子 $R T$ 可得：\n$$x_A d(\\ln a_A) + x_B d(\\ln a_B) = 0$$\n活度 $a_i$ 与活度系数 $\\gamma_i$ 和摩尔分数 $x_i$ 的关系为 $a_i = \\gamma_i x_i$。因此，$\\ln a_i = \\ln \\gamma_i + \\ln x_i$。将此代入前一个方程：\n$$x_A d(\\ln \\gamma_A + \\ln x_A) + x_B d(\\ln \\gamma_B + \\ln x_B) = 0$$\n展开微分项：\n$$x_A d\\ln \\gamma_A + x_A d\\ln x_A + x_B d\\ln \\gamma_B + x_B d\\ln x_B = 0$$\n使用关系式 $d\\ln u = du/u$：\n$$x_A d\\ln \\gamma_A + x_A \\frac{dx_A}{x_A} + x_B d\\ln \\gamma_B + x_B \\frac{dx_B}{x_B} = 0$$\n$$x_A d\\ln \\gamma_A + dx_A + x_B d\\ln \\gamma_B + dx_B = 0$$\n根据摩尔分数约束 $x_A + x_B = 1$，我们有 $dx_A + dx_B = 0$。方程简化为活度系数的 Gibbs-Duhem 关系式：\n$$x_A d\\ln \\gamma_A + x_B d\\ln \\gamma_B = 0$$\n为了求得 $\\ln \\gamma_A$，我们重排该方程：\n$$d\\ln \\gamma_A = -\\frac{x_B}{x_A} d\\ln \\gamma_B$$\n问题提供了 $\\ln \\gamma_B$ 关于 $x_A$ 的函数形式：\n$$\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$$\n我们对该表达式关于 $x_A$ 求导以求得 $d\\ln \\gamma_B$：\n$$\\frac{d(\\ln \\gamma_B)}{dx_A} = 2a\\, x_A + 3b\\, x_A^{2}$$\n因此，$d\\ln \\gamma_B = (2a\\, x_A + 3b\\, x_A^{2}) dx_A$。\n\n将此式与 $x_B = 1 - x_A$ 一同代入重排后的 Gibbs-Duhem 方程：\n$$d\\ln \\gamma_A = -\\frac{1 - x_A}{x_A} (2a\\, x_A + 3b\\, x_A^{2}) dx_A$$\n通过从第二个括号中提出因子 $x_A$ 来简化该项：\n$$d\\ln \\gamma_A = -(1 - x_A) (2a + 3b\\, x_A) dx_A$$\n展开乘积：\n$$d\\ln \\gamma_A = -(2a + 3b\\, x_A - 2a\\, x_A - 3b\\, x_A^{2}) dx_A$$\n$$d\\ln \\gamma_A = -[2a + (3b - 2a)x_A - 3b\\, x_A^{2}] dx_A$$\n为了求得 $\\ln \\gamma_A$，我们必须对这个微分表达式进行积分。我们从参考态（纯组分 A，其中 $x_A=1$）积分到任意组分 $x_A$。边界条件是当 $x_A=1$ 时，$\\gamma_A=1$，这意味着 $\\ln \\gamma_A = 0$。\n$$\\int_{\\ln \\gamma_A(1)}^{\\ln \\gamma_A(x_A)} d(\\ln \\gamma_A') = \\int_{1}^{x_A} -[2a + (3b - 2a)x_A' - 3b\\, (x_A')^{2}] dx_A'$$\n$$\\ln \\gamma_A(x_A) - \\ln \\gamma_A(1) = -\\left[ 2a x_A' + (3b - 2a)\\frac{(x_A')^2}{2} - 3b\\frac{(x_A')^3}{3} \\right]_1^{x_A}$$\n由于 $\\ln \\gamma_A(1) = 0$：\n$$\\ln \\gamma_A(x_A) = - \\left[ 2a x_A' + \\frac{3b-2a}{2}(x_A')^2 - b(x_A')^3 \\right]_1^{x_A}$$\n在积分上下限处计算表达式的值：\n$$\\ln \\gamma_A(x_A) = - \\left( \\left( 2a x_A + \\frac{3b-2a}{2}x_A^2 - b x_A^3 \\right) - \\left( 2a(1) + \\frac{3b-2a}{2}(1)^2 - b(1)^3 \\right) \\right)$$\n在 $x_A=1$ 处计算的常数项为：\n$$2a + \\frac{3b-2a}{2} - b = \\frac{4a + 3b - 2a - 2b}{2} = \\frac{2a+b}{2} = a + \\frac{b}{2}$$\n将此代回 $\\ln \\gamma_A(x_A)$ 的表达式中：\n$$\\ln \\gamma_A(x_A) = - \\left( 2a x_A + \\left(\\frac{3b}{2} - a\\right)x_A^2 - b x_A^3 \\right) + \\left(a + \\frac{b}{2}\\right)$$\n分配负号得到最终表达式：\n$$\\ln \\gamma_A(x_A) = a + \\frac{b}{2} - 2a x_A - \\left(\\frac{3b}{2} - a\\right)x_A^2 + b x_A^3$$\n按 $x_A$ 的升幂次序重新排列各项：\n$$\\ln \\gamma_A(x_A) = \\left(a + \\frac{b}{2}\\right) - 2a x_A + \\left(a - \\frac{3b}{2}\\right)x_A^2 + b x_A^3$$\n这就是 $\\ln \\gamma_A$ 作为 $x_A$、$a$ 和 $b$ 的函数的闭合形式解析表达式。",
            "answer": "$$\n\\boxed{b x_A^3 + \\left(a - \\frac{3b}{2}\\right)x_A^2 - 2a x_A + a + \\frac{b}{2}}\n$$"
        },
        {
            "introduction": "吉布斯-杜亥姆关系的应用远不止于关联组分性质，它更是理解材料相稳定性的基石。该关系与吉布斯自由能曲面的曲率紧密相关，直接决定了固溶体是保持均匀，还是会发生相分离。在这个练习中，你将推导固溶体稳定性的判据（即旋节线判据 $d^2g/dx^2 = 0$），并将其应用于规则溶体模型，从而深刻理解热力学约束如何控制相变行为。",
            "id": "3743554",
            "problem": "考虑一种在恒温恒压下的化学无序高熵合金 (HEA)，该合金沿组分 $A$ 和 $B$ 之间的准二元连接线建模，并存在摩尔分数固定的其他元素的旁观背景。设该系统由摩尔混合吉布斯自由能 $g(x)$ 描述：\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x),\n$$\n其中 $x$ 是组分 $A$ 的摩尔分数，$R$ 是气体常数，$T$ 是绝对温度，$\\Omega$ 是一个与成分无关的对称相互作用参数，表征了 HEA 环境中 $A$–$B$ 的混合焓。\n\n从多组分溶液的吉布斯自由能微分的基本定义、化学势的定义以及恒温恒压下的 Gibbs-Duhem 关系出发，推导局域稳定性条件，该条件由 $g(x)$ 在 Gibbs-Duhem 约束下的成分流形上的凸性表示。利用此条件，求出上述正规溶体模型的解析旋节线判据以及旋节线成分 $x_{-}$ 和 $x_{+}$ 的闭式表达式。\n\n然后，对于 $T = 1200\\,\\mathrm{K}$，$\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}}$ 和 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$（使用一致的单位），计算两个旋节线成分。将最终结果四舍五入至四位有效数字。将最终成分表示为小数形式（不带百分号）。",
            "solution": "该问题具有科学依据、适定、客观，并包含完整求解所需的所有信息。因此，该问题被认定为有效。\n\n求解过程分为两部分：首先，从基本热力学原理推导旋节线稳定性判据；其次，将此判据应用于给定的正规溶体模型，以求出具体的旋节线成分。\n\n**第一部分：旋节线稳定性判据的推导**\n\n一个多组分系统的总吉布斯自由能 $G$ 是温度 $T$、压力 $P$ 和各组分摩尔数 $n_i$ 的函数。其全微分为：\n$$\ndG = -SdT + VdP + \\sum_{i} \\mu_i dn_i\n$$\n其中 $S$ 是熵，$V$ 是体积，$\\mu_i$ 是组分 $i$ 的化学势。\n\n在恒温（$dT=0$）和恒压（$dP=0$）下，该式简化为：\n$$\ndG_{T,P} = \\sum_{i} \\mu_i dn_i\n$$\n由于 $G$ 是一个广延性质，并且是关于摩尔数 $n_i$ 的一次齐次函数，根据关于齐次函数的 Euler 定理可得 $G = \\sum_{i} n_i \\mu_i$。此表达式的全微分为 $dG = \\sum_{i} n_i d\\mu_i + \\sum_{i} \\mu_i dn_i$。在恒定 $T$ 和 $P$ 下，令 $dG$ 的两个表达式相等，即可得到 Gibbs-Duhem 关系：\n$$\n\\sum_{i} n_i d\\mu_i = 0 \\quad (\\text{at constant } T, P)\n$$\n对于所讨论的含组分 $A$ 和 $B$ 的准二元系统，该关系变为 $n_A d\\mu_A + n_B d\\mu_B = 0$。用总摩尔数 $N = n_A + n_B$ 除，并使用摩尔分数 $x_A = x = n_A/N$ 和 $x_B = 1-x = n_B/N$，我们得到：\n$$\nx\\, d\\mu_A + (1-x)\\, d\\mu_B = 0\n$$\n如果任何微小的局域成分涨落都导致吉布斯自由能增加，那么均匀溶液对于这种涨落就是热力学稳定的。这个稳定区域的边界是旋节线。不稳定的条件（即发生旋节线分解）是当系统可以通过分离成两个成分略有不同的相来降低其自由能时。这对应于摩尔吉布斯自由能函数 $g(x)$ 的负曲率。因此，稳定性的极限，即旋节线，由曲率为零的条件定义。\n\n为了将其形式化，我们将化学势与摩尔吉布斯自由能 $g(x) = G/N$ 联系起来。化学势由切线截距法给出：\n$$\n\\mu_A = g(x) + (1-x)\\frac{dg}{dx}\n$$\n$$\n\\mu_B = g(x) - x\\frac{dg}{dx}\n$$\n根据这些定义，化学势之差与摩尔吉布斯自由能的一阶导数直接相关：\n$$\n\\mu_A - \\mu_B = \\left( g + (1-x)\\frac{dg}{dx} \\right) - \\left( g - x\\frac{dg}{dx} \\right) = \\frac{dg}{dx}\n$$\n稳定性判据可以表示为 $\\frac{d(\\mu_A - \\mu_B)}{dx} > 0$。如果一个区域的组分 $A$ 稍富集（即 $x$ 增加），化学势之差必须增加，以驱动系统恢复均匀。将 $\\mu_A - \\mu_B = \\frac{dg}{dx}$ 代入稳定性条件，得到：\n$$\n\\frac{d}{dx}\\left(\\frac{dg}{dx}\\right) > 0 \\implies \\frac{d^2g}{dx^2} > 0\n$$\n因此，当摩尔吉布斯自由能函数 $g(x)$ 是凸函数时，系统是稳定的。旋节线是稳定区和非稳定区之间的边界，由凸性消失的条件定义：\n$$\n\\frac{d^2g}{dx^2} = 0\n$$\n\n**第二部分：应用于正规溶体模型**\n\n正规溶体模型的摩尔混合吉布斯自由能由下式给出：\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x)\n$$\n我们需要计算 $g(x)$ 对 $x$ 的二阶导数。\n一阶导数：\n$$\n\\frac{dg}{dx} = \\frac{d}{dx} \\left( R T x \\ln x + R T (1 - x) \\ln(1 - x) + \\Omega x - \\Omega x^2 \\right)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + x\\frac{1}{x} - \\ln(1-x) - (1-x)\\frac{1}{1-x} \\right) + \\Omega(1 - 2x)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + 1 - \\ln(1-x) - 1 \\right) + \\Omega(1-2x) = RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x)\n$$\n二阶导数：\n$$\n\\frac{d^2g}{dx^2} = \\frac{d}{dx} \\left( RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x) \\right)\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1-x}{x} \\right) \\left( \\frac{(1-x) - x(-1)}{(1-x)^2} \\right) - 2\\Omega\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1}{x(1-x)} \\right) - 2\\Omega\n$$\n应用旋节线判据 $\\frac{d^2g}{dx^2} = 0$：\n$$\n\\frac{RT}{x(1-x)} - 2\\Omega = 0 \\implies x(1-x) = \\frac{RT}{2\\Omega}\n$$\n这可以重写为关于 $x$ 的二次方程：\n$$\nx^2 - x + \\frac{RT}{2\\Omega} = 0\n$$\n使用二次方程求根公式 $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a=1$，$b=-1$，$c=\\frac{RT}{2\\Omega}$，我们求得其根为：\n$$\nx = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(1)\\left(\\frac{RT}{2\\Omega}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{2RT}{\\Omega}}}{2}\n$$\n这就是两个旋节线成分 $x_{-}$ 和 $x_{+}$ 的闭式表达式。\n$$\nx_{-} = \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n$$\nx_{+} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n\n**数值计算**\n\n给定以下数值：\n$T = 1200\\,\\mathrm{K}$\n$\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}} = 20000\\,\\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n首先，我们计算无量纲项 $\\frac{2RT}{\\Omega}$：\n$$\n\\frac{2RT}{\\Omega} = \\frac{2 \\times (8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (1200\\,\\mathrm{K})}{20000\\,\\mathrm{J\\,mol^{-1}}} = \\frac{19953.6}{20000} = 0.99768\n$$\n现在，将此值代入 $x_{-}$ 和 $x_{+}$ 的表达式中：\n$$\nx = \\frac{1 \\pm \\sqrt{1 - 0.99768}}{2} = \\frac{1 \\pm \\sqrt{0.00232}}{2}\n$$\n计算平方根：\n$$\n\\sqrt{0.00232} \\approx 0.048166378\n$$\n两个旋节线成分为：\n$$\nx_{-} = \\frac{1 - 0.048166378}{2} = \\frac{0.951833622}{2} = 0.475916811...\n$$\n$$\nx_{+} = \\frac{1 + 0.048166378}{2} = \\frac{1.048166378}{2} = 0.524083189...\n$$\n按要求将这些值四舍五入至四位有效数字，得到：\n$x_{-} = 0.4759$\n$x_{+} = 0.5241$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4759 & 0.5241 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本练习将带你进入一个更接近现代材料研究的场景，在这些场景中，实验数据往往是不完整的。我们将利用吉布斯-杜亥姆关系，根据在某一成分路径上测得的两个组分的信息，来推断三元体系中第三个组分的热力学性质。此练习不仅涉及数值积分，还引入了至关重要的实验不确定性传播分析，展示了该关系式作为数据验证和补全的强大实用工具。",
            "id": "3743539",
            "problem": "考虑一个代表高熵合金的多组分置换固溶体，该固溶体在恒定温度和压力下被建模为一个伪三元切片。设溶液的总吉布斯自由能 $G$ 是由各组分的量 $\\{n_i\\}$ 定义的，其化学势 $\\{\\mu_i\\}$ 满足基本微分关系 $dG = \\sum_i \\mu_i \\, dn_i$。在恒定温度和压力下，利用化学势的标准定义以及 $G$ 关于 $\\{n_i\\}$ 的一次齐次性，推导 $\\{d\\mu_i\\}$ 之间应满足的约束条件。\n\n定义摩尔分数 $\\{x_i\\}$ 为 $x_i = n_i / \\sum_j n_j$，活度 $\\{a_i\\}$ 为 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$，其中 $R$ 是理想气体常数，$T$ 是温度。假设活度 $a_i$ 可分解为 $a_i = \\gamma_i x_i$，其中 $\\gamma_i$ 是活度系数。考虑一个由 $s \\in [0,1]$ 参数化的成分路径，使得 $x_i = x_i(s)$。假设沿此路径仅实验测量了导数 $d(\\ln \\gamma_1)/ds$ 和 $d(\\ln \\gamma_2)/ds$，且各自的标准不确定度已知。任务是利用恒定 $T$ 和 $P$ 下的热力学约束来计算沿路径的 $d(\\ln \\gamma_3)/ds$，然后在给定初始条件 $\\ln \\gamma_3(s=0) = 0$ 的情况下通过数值积分恢复 $\\ln \\gamma_3(s)$，最后传播测量不确定度以估计积分后 $\\ln \\gamma_3(s=1)$ 的标准差。\n\n推导必须从以下基本出发点开始：\n- 微分关系 $dG = \\sum_i \\mu_i \\, dn_i$。\n- 化学势 $\\mu_i$ 和摩尔分数 $x_i$ 的定义。\n- 溶液的表达式 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$ 以及分解式 $a_i = \\gamma_i x_i$。\n\n您的程序必须：\n- 使用梯形法则，在 $s \\in [0,1]$ 的均匀网格上实现 $d(\\ln \\gamma_3)/ds$ 的数值积分。\n- 根据所提供的路径函数，解析地计算导数 $dx_i/ds$。\n- 将 $d(\\ln \\gamma_1)/ds$ 和 $d(\\ln \\gamma_2)/ds$ 视为每个测试用例中指定的确定性函数；不允许进行随机抽样。\n- 通过假设 $d(\\ln \\gamma_1)/ds$ 和 $d(\\ln \\gamma_2)/ds$ 具有独立的高斯不确定度，并使用线性误差传播方法，通过 Gibbs-Duhem 约束和梯形积分权重来传播不确定度，以获得 $\\ln \\gamma_3(s=1)$ 的标准差。\n- 将所有最终结果表示为无量纲浮点数。\n- 生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$）。\n\n测试套件：\n在 $s \\in [0,1]$ 上使用包含 $N = 401$ 个点的均匀网格。对于每个测试用例，按如下方式定义 $x_1(s)$、$x_2(s)$、$x_3(s) = 1 - x_1(s) - x_2(s)$、测量的导数 $d(\\ln \\gamma_1)/ds$、$d(\\ln \\gamma_2)/ds$ 及其标准不确定度 $\\sigma_1(s)$、$\\sigma_2(s)$。\n\n- 测试用例 1（理想路径，中等变化）：\n  - $x_1(s) = 0.3 + 0.2 s$。\n  - $x_2(s) = 0.4 - 0.1 s + 0.1 s^2$。\n  - $x_3(s) = 1 - x_1(s) - x_2(s)$。\n  - 测量的导数：\n    - $d(\\ln \\gamma_1)/ds = A_{12} \\, x_2(s) \\, \\frac{dx_2}{ds} + A_{13} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{11} \\, \\frac{dx_1}{ds}$。\n    - $d(\\ln \\gamma_2)/ds = A_{21} \\, x_1(s) \\, \\frac{dx_1}{ds} + A_{23} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{22} \\, \\frac{dx_2}{ds}$。\n  - 常数：$A_{12} = 0.8$，$A_{13} = -0.3$，$B_{11} = 0.1$，$A_{21} = 0.5$，$A_{23} = 0.2$，$B_{22} = -0.05$。\n  - 标准不确定度：$\\sigma_1(s) = 0.02 (1 + s)$，$\\sigma_2(s) = 0.03 \\sqrt{s + \\epsilon}$，其中 $\\epsilon = 10^{-12}$。\n\n- 测试用例 2（边界逼近，当 $s$ 接近 1 时 $x_3$ 很小）：\n  - $x_1(s) = 0.48 + 0.45 s^2$。\n  - $x_2(s) = 0.43 - 0.39 s$。\n  - $x_3(s) = 1 - x_1(s) - x_2(s)$。\n  - 测量的导数：\n    - $d(\\ln \\gamma_1)/ds = A_{12} \\, x_2(s) \\, \\frac{dx_2}{ds} + A_{13} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{11} \\, \\frac{dx_1}{ds}$。\n    - $d(\\ln \\gamma_2)/ds = A_{21} \\, x_1(s) \\, \\frac{dx_1}{ds} + A_{23} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{22} \\, \\frac{dx_2}{ds}$。\n  - 常数：$A_{12} = -0.2$，$A_{13} = 0.7$，$B_{11} = -0.08$，$A_{21} = 0.4$，$A_{23} = -0.5$，$B_{22} = 0.03$。\n  - 标准不确定度：$\\sigma_1(s) = 0.05 (1 + 0.5 s)$，$\\sigma_2(s) = 0.02 (1 + s^2)$。\n\n- 测试用例 3（振荡路径，非单调成分变化）：\n  - $x_1(s) = 0.33 + 0.1 \\sin(\\pi s)$。\n  - $x_2(s) = 0.33 + 0.1 \\cos\\!\\left(\\frac{\\pi}{2} s\\right)$。\n  - $x_3(s) = 1 - x_1(s) - x_2(s)$。\n  - 测量的导数：\n    - $d(\\ln \\gamma_1)/ds = A_{12} \\, x_2(s) \\, \\frac{dx_2}{ds} + A_{13} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{11} \\, \\frac{dx_1}{ds}$。\n    - $d(\\ln \\gamma_2)/ds = A_{21} \\, x_1(s) \\, \\frac{dx_1}{ds} + A_{23} \\, x_3(s) \\, \\frac{dx_3}{ds} + B_{22} \\, \\frac{dx_2}{ds}$。\n  - 常数：$A_{12} = 0.6$，$A_{13} = -0.4$，$B_{11} = 0.02$，$A_{21} = -0.3$，$A_{23} = 0.5$，$B_{22} = 0.07$。\n  - 标准不确定度：$\\sigma_1(s) = 0.025 \\left(1 + 0.2 \\sin(\\pi s)\\right)$，$\\sigma_2(s) = 0.03 \\left(1 + 0.2 \\cos(\\pi s)\\right)$。\n\n算法任务：\n- 使用在恒定 $T$ 和 $P$ 下从 $dG = \\sum_i \\mu_i \\, dn_i$ 推导出的基本约束，将 $d(\\ln a_3)/ds$ 表示为路径上 $x_1$、$x_2$、$x_3$、$d(\\ln a_1)/ds$ 和 $d(\\ln a_2)/ds$ 的函数。\n- 根据 $a_i = \\gamma_i x_i$，将 $d(\\ln a_i)/ds$ 与 $d(\\ln \\gamma_i)/ds$ 和 $dx_i/ds$ 关联起来。\n- 实现具有均匀间距的梯形法则，根据 $d(\\ln \\gamma_3)/ds$ 和初始条件 $\\ln \\gamma_3(s=0) = 0$ 计算 $\\ln \\gamma_3(s=1)$。\n- 将 $\\sigma_1(s)$ 和 $\\sigma_2(s)$ 分别视为 $d(\\ln \\gamma_1)/ds$ 和 $d(\\ln \\gamma_2)/ds$ 的标准差来传播不确定度，并根据约束和积分权重的线性组合计算 $\\ln \\gamma_3(s=1)$ 的最终标准差。假设不同组分和不同网格点上的测量不确定度是独立的。\n- 数值稳定性：当构造分母中含有 $x_3(s)$ 的比率时，使用一个小的正数 $\\epsilon = 10^{-12}$ 来避免除以零。\n\n所需输出：\n- 对于每个测试用例，输出两个值：最终积分值 $\\ln \\gamma_3(s=1)$ 及其传播的标准差，两者均为无量纲浮点数。\n- 将三个测试用例的结果汇总到单行输出中，形式为用方括号括起来的逗号分隔列表，顺序为 $[\\ln \\gamma_3^{(1)}(1), \\sigma^{(1)}, \\ln \\gamma_3^{(2)}(1), \\sigma^{(2)}, \\ln \\gamma_3^{(3)}(1), \\sigma^{(3)}]$。\n\n您的程序必须是一个完整的、可运行的程序，不需要任何输入，并且只使用指定的库。它必须严格按照指定格式生成一行输出。",
            "solution": "该问题要求推导并应用 Gibbs-Duhem 关系于伪三元溶液，以根据另外两种组分的测量值确定其中一种组分的活度系数。解决方案涉及解析推导、数值积分和不确定度传播。\n\n### 理论推导\n\n出发点是多组分体系在恒定温度 $T$ 和压力 $P$ 下吉布斯自由能 $G$ 的基本性质。作为一个广延性质，$G$ 是组分摩尔数 $\\{n_i\\}$ 的一次齐次函数。根据齐次函数的欧拉定理，我们可以写出：\n$$ G = \\sum_{i} n_i \\mu_i $$\n其中 $\\mu_i = (\\partial G / \\partial n_i)_{T, P, n_{j \\neq i}}$ 是组分 $i$ 的化学势。\n\n该表达式的全微分为：\n$$ dG = \\sum_{i} n_i d\\mu_i + \\sum_{i} \\mu_i dn_i $$\n问题还给出了恒定 $T$ 和 $P$ 下 $G$ 的基本微分关系：\n$$ dG = \\sum_{i} \\mu_i dn_i $$\n令这两个 $dG$ 的表达式相等，即可得到 Gibbs-Duhem 关系：\n$$ \\sum_{i} n_i d\\mu_i = 0 $$\n该关系对各组分化学势的同时变化施加了约束。为了用强度变量来表示，我们将其除以总摩尔数 $N = \\sum_j n_j$，从而得到以摩尔分数 $x_i = n_i / N$ 表示的关系：\n$$ \\sum_i x_i d\\mu_i = 0 $$\n对于指定的三元体系（$i=1,2,3$），这变为：\n$$ x_1 d\\mu_1 + x_2 d\\mu_2 + x_3 d\\mu_3 = 0 $$\n化学势 $\\mu_i$ 通过 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$ 与活度 $a_i$ 相关，其中 $\\mu_i^\\circ$ 是标准态化学势，$R$ 是理想气体常数，$T$ 是绝对温度。由于 $\\mu_i^\\circ$、$R$ 和 $T$ 是常数，其微分为 $d\\mu_i = RT \\, d(\\ln a_i)$。将此代入 Gibbs-Duhem 关系，得到：\n$$ x_1 RT \\, d(\\ln a_1) + x_2 RT \\, d(\\ln a_2) + x_3 RT \\, d(\\ln a_3) = 0 $$\n除以常数非零项 $RT$，得到活度之间的关系：\n$$ \\sum_i x_i \\, d(\\ln a_i) = 0 $$\n活度 $a_i$ 表示为活度系数 $\\gamma_i$ 和摩尔分数 $x_i$ 的乘积，即 $a_i = \\gamma_i x_i$。取自然对数，我们有 $\\ln a_i = \\ln \\gamma_i + \\ln x_i$。其微分为 $d(\\ln a_i) = d(\\ln \\gamma_i) + d(\\ln x_i)$。将此代入前一个方程：\n$$ \\sum_i x_i (d(\\ln \\gamma_i) + d(\\ln x_i)) = 0 $$\n$$ \\sum_i x_i \\, d(\\ln \\gamma_i) + \\sum_i x_i \\, d(\\ln x_i) = 0 $$\n第二项可以简化，因为 $d(\\ln x_i) = dx_i / x_i$。因此，$\\sum_i x_i \\, (dx_i / x_i) = \\sum_i dx_i$。由于摩尔分数的总和为 1（$\\sum_i x_i = 1$），其微分的总和必须为零（$\\sum_i dx_i = d(1) = 0$）。这样就得到了用活度系数表示的 Gibbs-Duhem 方程：\n$$ \\sum_i x_i \\, d(\\ln \\gamma_i) = 0 $$\n成分路径由 $s$ 参数化，因此我们可以写出关于 $s$ 的导数：\n$$ x_1 \\frac{d(\\ln \\gamma_1)}{ds} + x_2 \\frac{d(\\ln \\gamma_2)}{ds} + x_3 \\frac{d(\\ln \\gamma_3)}{ds} = 0 $$\n我们已知 $\\frac{d(\\ln \\gamma_1)}{ds}$ 和 $\\frac{d(\\ln \\gamma_2)}{ds}$ 的函数。我们可以解出未知的导数 $\\frac{d(\\ln \\gamma_3)}{ds}$：\n$$ \\frac{d(\\ln \\gamma_3)}{ds} = - \\frac{1}{x_3} \\left( x_1 \\frac{d(\\ln \\gamma_1)}{ds} + x_2 \\frac{d(\\ln \\gamma_2)}{ds} \\right) $$\n这是我们计算的核心方程。在分母 $x_3$ 中加入一个小的正常数 $\\epsilon$，以确保在 $x_3$ 趋近于零时的数值稳定性。\n\n### 数值积分\n给定导数 $\\frac{d(\\ln \\gamma_3)}{ds} = F(s)$，我们可以通过积分求得 $\\ln \\gamma_3(s)$。在初始条件 $\\ln \\gamma_3(0) = 0$ 下， $s=1$ 处的值为：\n$$ \\ln \\gamma_3(1) = \\int_0^1 F(s) \\, ds $$\n该积分使用梯形法则在一个包含 $N$ 个点 $\\{s_j\\}_{j=0}^{N-1}$ 的均匀网格上进行数值计算，步长为 $h = 1/(N-1)$。该积分由加权和近似：\n$$ \\ln \\gamma_3(1) \\approx \\sum_{j=0}^{N-1} w_j F(s_j) $$\n其中权重 $w_j$ 为 $w_0 = w_{N-1} = h/2$，$w_j = h$ (对于 $j = 1, \\dots, N-2$）。\n\n### 不确定度传播\n量 $\\frac{d(\\ln \\gamma_1)}{ds}$ 和 $\\frac{d(\\ln \\gamma_2)}{ds}$ 是测量值，分别具有标准不确定度 $\\sigma_1(s)$ 和 $\\sigma_2(s)$。令 $g'_i(s) = \\frac{d(\\ln \\gamma_i)}{ds}$。$g'_3(s) = F(s)$ 的方差通过线性误差传播求得。假设 $g'_1$ 和 $g'_2$ 的测量值是独立的，方差 $\\sigma_F^2(s)$ 为：\n$$ \\sigma_F^2(s) = \\text{Var}\\left( - \\frac{x_1(s)}{x_3(s)} g'_1(s) - \\frac{x_2(s)}{x_3(s)} g'_2(s) \\right) = \\left(\\frac{x_1(s)}{x_3(s)}\\right)^2 \\sigma_1^2(s) + \\left(\\frac{x_2(s)}{x_3(s)}\\right)^2 \\sigma_2^2(s) $$\n摩尔分数 $x_i(s)$ 被视为精确函数。最终的积分值 $I = \\ln \\gamma_3(1)$ 是离散值 $F(s_j)$ 的加权和。假设不同网格点 $s_j$ 处的测量不确定度是独立的，积分的方差是方差的加权和：\n$$ \\sigma_I^2 = \\text{Var}(I) = \\text{Var}\\left(\\sum_{j=0}^{N-1} w_j F(s_j)\\right) = \\sum_{j=0}^{N-1} w_j^2 \\text{Var}(F(s_j)) = \\sum_{j=0}^{N-1} w_j^2 \\sigma_F^2(s_j) $$\n$\\ln \\gamma_3(1)$ 的标准差即为 $\\sigma_I = \\sqrt{\\sigma_I^2}$。\n\n### 算法摘要\n1.  定义一个从 0 到 1，包含 $N=401$ 个点的均匀网格 $s$。\n2.  对每个测试用例，定义 $x_i(s)$ 及其导数 $dx_i/ds$ 的解析函数。\n3.  在网格上计算 $x_i(s)$ 和 $dx_i/ds$ 的值。\n4.  在网格上计算给定的测量导数 $d(\\ln \\gamma_1)/ds$ 和 $d(\\ln \\gamma_2)/ds$ 的值。\n5.  使用推导出的 Gibbs-Duhem 约束在网格上计算 $d(\\ln \\gamma_3)/ds$，为保证稳定性，在分母 $x_3$ 上加上 $\\epsilon$。\n6.  使用梯形法则对 $d(\\ln \\gamma_3)/ds$ 从 $s=0$ 到 $s=1$ 进行积分，以求得 $\\ln \\gamma_3(1)$。\n7.  在网格上计算不确定度函数 $\\sigma_1(s)$ 和 $\\sigma_2(s)$ 的值。\n8.  使用误差传播公式计算每个网格点上 $d(\\ln \\gamma_3)/ds$ 的方差。\n9.  计算梯形积分权重 $w_j$。\n10. 通过对权重平方与网格点方差的乘积求和，计算积分结果的总方差。\n11. 最终标准差是总方差的平方根。\n12. 对所有测试用例重复以上步骤，并格式化输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the activity coefficient and its uncertainty for a ternary system\n    using the Gibbs-Duhem relation.\n    \"\"\"\n    N = 401\n    epsilon = 1e-12\n\n    test_cases = [\n        # Test Case 1: happy path, moderate variation\n        {\n            \"x1_func\": lambda s: 0.3 + 0.2 * s,\n            \"x2_func\": lambda s: 0.4 - 0.1 * s + 0.1 * s**2,\n            \"dx1ds_func\": lambda s: 0.2 + 0 * s, # for vectorization\n            \"dx2ds_func\": lambda s: -0.1 + 0.2 * s,\n            \"consts\": {'A12': 0.8, 'A13': -0.3, 'B11': 0.1, 'A21': 0.5, 'A23': 0.2, 'B22': -0.05},\n            \"sigma1_func\": lambda s: 0.02 * (1 + s),\n            \"sigma2_func\": lambda s: 0.03 * np.sqrt(s + epsilon),\n        },\n        # Test Case 2: boundary approach, small x3 near s = 1\n        {\n            \"x1_func\": lambda s: 0.48 + 0.45 * s**2,\n            \"x2_func\": lambda s: 0.43 - 0.39 * s,\n            \"dx1ds_func\": lambda s: 0.9 * s,\n            \"dx2ds_func\": lambda s: -0.39 + 0 * s,\n            \"consts\": {'A12': -0.2, 'A13': 0.7, 'B11': -0.08, 'A21': 0.4, 'A23': -0.5, 'B22': 0.03},\n            \"sigma1_func\": lambda s: 0.05 * (1 + 0.5 * s),\n            \"sigma2_func\": lambda s: 0.02 * (1 + s**2),\n        },\n        # Test Case 3: oscillatory path\n        {\n            \"x1_func\": lambda s: 0.33 + 0.1 * np.sin(np.pi * s),\n            \"x2_func\": lambda s: 0.33 + 0.1 * np.cos(np.pi / 2 * s),\n            \"dx1ds_func\": lambda s: 0.1 * np.pi * np.cos(np.pi * s),\n            \"dx2ds_func\": lambda s: -0.1 * (np.pi / 2) * np.sin(np.pi / 2 * s),\n            \"consts\": {'A12': 0.6, 'A13': -0.4, 'B11': 0.02, 'A21': -0.3, 'A23': 0.5, 'B22': 0.07},\n            \"sigma1_func\": lambda s: 0.025 * (1 + 0.2 * np.sin(np.pi * s)),\n            \"sigma2_func\": lambda s: 0.03 * (1 + 0.2 * np.cos(np.pi * s)),\n        },\n    ]\n\n    results = []\n    \n    s = np.linspace(0, 1, N)\n    h = s[1] - s[0]\n\n    for case in test_cases:\n        # 1. Calculate compositions and their derivatives\n        x1_s = case[\"x1_func\"](s)\n        x2_s = case[\"x2_func\"](s)\n        x3_s = 1 - x1_s - x2_s\n\n        dx1ds_s = case[\"dx1ds_func\"](s)\n        dx2ds_s = case[\"dx2ds_func\"](s)\n        dx3ds_s = -(dx1ds_s + dx2ds_s)\n\n        # 2. Calculate measured derivatives d(ln_gamma_i)/ds\n        C = case[\"consts\"]\n        dg1ds_s = C['A12'] * x2_s * dx2ds_s + C['A13'] * x3_s * dx3ds_s + C['B11'] * dx1ds_s\n        dg2ds_s = C['A21'] * x1_s * dx1ds_s + C['A23'] * x3_s * dx3ds_s + C['B22'] * dx2ds_s\n\n        # 3. Use Gibbs-Duhem to find d(ln_gamma_3)/ds\n        x3_stable = x3_s + epsilon\n        dg3ds_s = -(x1_s / x3_stable) * dg1ds_s - (x2_s / x3_stable) * dg2ds_s\n        \n        # 4. Integrate to find ln_gamma_3(1)\n        ln_gamma3_at_1 = np.trapz(dg3ds_s, x=s)\n        results.append(ln_gamma3_at_1)\n        \n        # 5. Propagate uncertainty\n        # 5a. Calculate uncertainties of measured derivatives\n        sigma1_s = case[\"sigma1_func\"](s)\n        sigma2_s = case[\"sigma2_func\"](s)\n        \n        # 5b. Calculate variance of d(ln_gamma_3)/ds\n        var_dg3ds_s = ((x1_s / x3_stable)**2 * sigma1_s**2) + \\\n                      ((x2_s / x3_stable)**2 * sigma2_s**2)\n        \n        # 5c. Define trapezoidal weights\n        weights = np.full(N, h)\n        weights[0] = h / 2\n        weights[-1] = h / 2\n        \n        # 5d. Calculate variance of the integral\n        var_ln_gamma3_at_1 = np.sum(weights**2 * var_dg3ds_s)\n        \n        # 5e. Calculate standard deviation\n        std_ln_gamma3_at_1 = np.sqrt(var_ln_gamma3_at_1)\n        results.append(std_ln_gamma3_at_1)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}