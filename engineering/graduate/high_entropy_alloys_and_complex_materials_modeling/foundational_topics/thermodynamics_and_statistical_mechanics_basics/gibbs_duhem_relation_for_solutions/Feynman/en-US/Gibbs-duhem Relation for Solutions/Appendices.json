{
    "hands_on_practices": [
        {
            "introduction": "In any valid thermodynamic model of a solution, the chemical potentials and activities of the components are not independent; they are linked by the Gibbs-Duhem relation. This exercise provides a direct, hands-on demonstration of this principle by asking you to derive the functional form for one component's activity coefficient from the known form of another. This practice is fundamental to ensuring that solution models are thermodynamically self-consistent, a critical requirement for accurate materials modeling .",
            "id": "3743533",
            "problem": "Consider a binary substitutional alloy subsystem $A$–$B$ embedded within a multicomponent High-Entropy Alloy (HEA), modeled at constant temperature $T$ and pressure $P$. Let the molar Gibbs free energy of the solution be $G(T,P,n_A,n_B)$ with chemical potentials defined by $\\mu_i = \\left(\\partial G/\\partial n_i\\right)_{T,P,n_{j \\neq i}}$ for $i \\in \\{A,B\\}$. The activities obey $\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$, where the reference state for each component is its pure liquid at the same $T$ and $P$ (Raoult’s law reference). For an isothermal, isobaric binary solution, the Gibbs-Duhem relation applies.\n\nAssume the activities are written as $a_i = \\gamma_i x_i$, where $x_i$ is the mole fraction and $\\gamma_i$ is the activity coefficient. In this HEA subsystem, suppose ab initio-informed interaction modeling yields a composition-dependent activity coefficient for component $B$ of the form\n$$\n\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3},\n$$\nwhere $a$ and $b$ are composition-independent parameters and $x_A + x_B = 1$. Under the stated reference states (Raoult’s law) one has $\\gamma_A \\to 1$ as $x_A \\to 1$ and $\\gamma_B \\to 1$ as $x_B \\to 1$.\n\nUsing only fundamental definitions of chemical potential and activity together with the Gibbs-Duhem relation at constant $T$ and $P$, derive the closed-form analytic expression for $\\ln \\gamma_A(x_A)$ implied by the given $\\ln \\gamma_B(x_A)$. Express your final result as a function of $x_A$, $a$, and $b$. No numerical evaluation is required, and no rounding is needed. Provide the expression only; do not include units in your final answer.",
            "solution": "The problem is subjected to validation against the stipulated criteria.\n\n### Step 1: Extract Givens\n- **System:** A binary substitutional alloy subsystem A–B within a multicomponent High-Entropy Alloy (HEA).\n- **Thermodynamic Conditions:** Constant temperature $T$ and constant pressure $P$.\n- **Thermodynamic Potential:** Molar Gibbs free energy is $G(T,P,n_A,n_B)$.\n- **Chemical Potential Definition:** $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\neq i}}$ for components $i \\in \\{A,B\\}$.\n- **Activity Definition:** $\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$.\n- **Activity Coefficient Definition:** $a_i = \\gamma_i x_i$, where $x_i$ is the mole fraction and $\\gamma_i$ is the activity coefficient.\n- **Reference State:** The reference state for each component is its pure liquid at the same $T$ and $P$. This corresponds to a Raoult's law reference state.\n- **Governing Equation:** The Gibbs-Duhem relation for an isothermal, isobaric binary solution.\n- **Mole Fraction Constraint:** $x_A + x_B = 1$.\n- **Given Functional Form:** The activity coefficient for component $B$ is given by $\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$, where $a$ and $b$ are constants.\n- **Boundary Conditions:** From the Raoult's law reference state definition, $\\gamma_i \\to 1$ as $x_i \\to 1$. Specifically, $\\gamma_A \\to 1$ as $x_A \\to 1$ and $\\gamma_B \\to 1$ as $x_B \\to 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientific Grounding:** The problem is firmly rooted in classical chemical thermodynamics. The Gibbs-Duhem relation is a fundamental equation of state for multicomponent systems. The use of a polynomial expansion for the logarithm of an activity coefficient is a standard approach in solution modeling (e.g., Margules or Redlich-Kister equations). The context of high-entropy alloys is scientifically relevant.\n- **Well-Posedness:** The problem provides a functional form for one activity coefficient and asks for the other. The Gibbs-Duhem relation provides the necessary differential constraint. Furthermore, a boundary condition for the activity coefficient to be determined ($\\gamma_A \\to 1$ as $x_A \\to 1$) is provided, which allows for the determination of the integration constant, ensuring a unique solution.\n- **Consistency Check:** The given form for $\\ln \\gamma_B$ must be consistent with its boundary condition. The condition $\\gamma_B \\to 1$ as $x_B \\to 1$ is equivalent to $\\ln \\gamma_B \\to 0$ as $x_A \\to 0$. Substituting $x_A=0$ into the given expression yields $\\ln \\gamma_B(0) = a(0)^2 + b(0)^3 = 0$. This is consistent.\n- **Objectivity:** The problem is stated using precise, unambiguous scientific language.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist (e.g., scientific unsoundness, incompleteness, contradiction, ambiguity). It is a standard, solvable problem in physical chemistry or materials science.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Derivation\nThe derivation begins with the Gibbs-Duhem relation for a binary mixture at constant temperature $T$ and pressure $P$. In terms of molar quantities, this relation is expressed as:\n$$x_A d\\mu_A + x_B d\\mu_B = 0$$\nwhere $x_i$ is the mole fraction of component $i$ and $\\mu_i$ is its chemical potential.\n\nThe chemical potential is related to activity $a_i$ by the definition:\n$$\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$$\nSince $T$ and $P$ are constant, the reference chemical potential $\\mu_i^{\\mathrm{ref}}$ is also constant. Taking the differential of $\\mu_i$ gives:\n$$d\\mu_i = R T d(\\ln a_i)$$\nSubstituting this into the Gibbs-Duhem equation and canceling the non-zero factor $R T$ yields:\n$$x_A d(\\ln a_A) + x_B d(\\ln a_B) = 0$$\nThe activity $a_i$ is related to the activity coefficient $\\gamma_i$ and mole fraction $x_i$ by $a_i = \\gamma_i x_i$. Therefore, $\\ln a_i = \\ln \\gamma_i + \\ln x_i$. Substituting this into the previous equation:\n$$x_A d(\\ln \\gamma_A + \\ln x_A) + x_B d(\\ln \\gamma_B + \\ln x_B) = 0$$\nExpanding the differentials:\n$$x_A d\\ln \\gamma_A + x_A d\\ln x_A + x_B d\\ln \\gamma_B + x_B d\\ln x_B = 0$$\nUsing the relation $d\\ln u = du/u$:\n$$x_A d\\ln \\gamma_A + x_A \\frac{dx_A}{x_A} + x_B d\\ln \\gamma_B + x_B \\frac{dx_B}{x_B} = 0$$\n$$x_A d\\ln \\gamma_A + dx_A + x_B d\\ln \\gamma_B + dx_B = 0$$\nFrom the mole fraction constraint $x_A + x_B = 1$, we have $dx_A + dx_B = 0$. The equation simplifies to the Gibbs-Duhem relation for activity coefficients:\n$$x_A d\\ln \\gamma_A + x_B d\\ln \\gamma_B = 0$$\nTo find $\\ln \\gamma_A$, we rearrange this equation:\n$$d\\ln \\gamma_A = -\\frac{x_B}{x_A} d\\ln \\gamma_B$$\nThe problem provides the functional form for $\\ln \\gamma_B$ in terms of $x_A$:\n$$\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$$\nWe differentiate this expression with respect to $x_A$ to find $d\\ln \\gamma_B$:\n$$\\frac{d(\\ln \\gamma_B)}{dx_A} = 2a\\, x_A + 3b\\, x_A^{2}$$\nThus, $d\\ln \\gamma_B = (2a\\, x_A + 3b\\, x_A^{2}) dx_A$.\n\nSubstituting this and $x_B = 1 - x_A$ into the rearranged Gibbs-Duhem equation:\n$$d\\ln \\gamma_A = -\\frac{1 - x_A}{x_A} (2a\\, x_A + 3b\\, x_A^{2}) dx_A$$\nSimplifying the term by factoring out $x_A$ from the second parenthesis:\n$$d\\ln \\gamma_A = -(1 - x_A) (2a + 3b\\, x_A) dx_A$$\nExpanding the product:\n$$d\\ln \\gamma_A = -(2a + 3b\\, x_A - 2a\\, x_A - 3b\\, x_A^{2}) dx_A$$\n$$d\\ln \\gamma_A = -[2a + (3b - 2a)x_A - 3b\\, x_A^{2}] dx_A$$\nTo find $\\ln \\gamma_A$, we must integrate this differential expression. We perform a definite integration from the reference state (pure component A, where $x_A=1$) to an arbitrary composition $x_A$. The boundary condition is that for $x_A=1$, $\\gamma_A=1$, which means $\\ln \\gamma_A = 0$.\n$$\\int_{\\ln \\gamma_A(1)}^{\\ln \\gamma_A(x_A)} d(\\ln \\gamma_A') = \\int_{1}^{x_A} -[2a + (3b - 2a)x_A' - 3b\\, (x_A')^{2}] dx_A'$$\n$$\\ln \\gamma_A(x_A) - \\ln \\gamma_A(1) = -\\left[ 2a x_A' + (3b - 2a)\\frac{(x_A')^2}{2} - 3b\\frac{(x_A')^3}{3} \\right]_1^{x_A}$$\nWith $\\ln \\gamma_A(1) = 0$:\n$$\\ln \\gamma_A(x_A) = - \\left[ 2a x_A' + \\frac{3b-2a}{2}(x_A')^2 - b(x_A')^3 \\right]_1^{x_A}$$\nEvaluating the expression at the limits of integration:\n$$\\ln \\gamma_A(x_A) = - \\left( \\left( 2a x_A + \\frac{3b-2a}{2}x_A^2 - b x_A^3 \\right) - \\left( 2a(1) + \\frac{3b-2a}{2}(1)^2 - b(1)^3 \\right) \\right)$$\nThe constant term evaluated at $x_A=1$ is:\n$$2a + \\frac{3b-2a}{2} - b = \\frac{4a + 3b - 2a - 2b}{2} = \\frac{2a+b}{2} = a + \\frac{b}{2}$$\nSubstituting this back into the expression for $\\ln \\gamma_A(x_A)$:\n$$\\ln \\gamma_A(x_A) = - \\left( 2a x_A + \\left(\\frac{3b}{2} - a\\right)x_A^2 - b x_A^3 \\right) + \\left(a + \\frac{b}{2}\\right)$$\nDistributing the negative sign gives the final expression:\n$$\\ln \\gamma_A(x_A) = a + \\frac{b}{2} - 2a x_A - \\left(\\frac{3b}{2} - a\\right)x_A^2 + b x_A^3$$\nRearranging the terms in order of ascending powers of $x_A$:\n$$\\ln \\gamma_A(x_A) = \\left(a + \\frac{b}{2}\\right) - 2a x_A + \\left(a - \\frac{3b}{2}\\right)x_A^2 + b x_A^3$$\nThis is the closed-form analytic expression for $\\ln \\gamma_A$ as a function of $x_A$, $a$, and $b$.",
            "answer": "$$\n\\boxed{b x_A^3 + \\left(a - \\frac{3b}{2}\\right)x_A^2 - 2a x_A + a + \\frac{b}{2}}\n$$"
        },
        {
            "introduction": "Building upon the concept of thermodynamic consistency, we now explore a powerful physical application: predicting the stability of a solution. This practice connects the Gibbs-Duhem relation to the curvature of the molar Gibbs free energy function, $g(x)$, which determines whether a homogeneous alloy is stable or prone to spontaneous phase separation. By deriving the spinodal criterion from fundamental principles, you will gain insight into how thermodynamic models are used to construct phase diagrams and predict microstructural evolution in materials .",
            "id": "3743554",
            "problem": "Consider a chemically disordered High-Entropy Alloy (HEA) at constant temperature and pressure, modeled along a pseudo-binary tie-line between components $A$ and $B$ in the presence of a spectating background of other elements with fixed mole fractions. Let the system be described by the molar Gibbs free energy of mixing per mole,\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x),\n$$\nwhere $x$ is the mole fraction of component $A$, $R$ is the gas constant, $T$ is the absolute temperature, and $\\Omega$ is a composition-independent symmetric interaction parameter characterizing the $A$–$B$ enthalpy of mixing within the HEA environment.\n\nStarting from the fundamental definition of the Gibbs free energy differential for a multicomponent solution, the chemical potential definition, and the Gibbs-Duhem relation at constant temperature and pressure, derive the local stability condition in terms of the convexity of $g(x)$ restricted to the composition manifold enforced by the Gibbs-Duhem constraint. Use this to obtain the analytic spinodal criterion and the closed-form expression for the spinodal compositions $x_{-}$ and $x_{+}$ for the regular solution model given above.\n\nThen, for $T = 1200\\,\\mathrm{K}$, $\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}}$, and $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ (use consistent units), compute the two spinodal compositions. Round your final values to four significant figures. Express the final compositions as decimal fractions (no percentage sign).",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. Therefore, it is deemed valid.\n\nThe solution proceeds in two parts: first, the derivation of the spinodal stability criterion from fundamental thermodynamic principles; second, the application of this criterion to the given regular solution model to find the specific spinodal compositions.\n\n**Part 1: Derivation of the Spinodal Stability Criterion**\n\nThe total Gibbs free energy, $G$, of a multicomponent system is a function of temperature $T$, pressure $P$, and the number of moles of each component, $n_i$. Its total differential is:\n$$\ndG = -SdT + VdP + \\sum_{i} \\mu_i dn_i\n$$\nwhere $S$ is the entropy, $V$ is the volume, and $\\mu_i$ is the chemical potential of component $i$.\n\nAt constant temperature ($dT=0$) and pressure ($dP=0$), this simplifies to:\n$$\ndG_{T,P} = \\sum_{i} \\mu_i dn_i\n$$\nSince $G$ is an extensive property and homogeneous of first degree in the mole numbers $n_i$, Euler's theorem on homogeneous functions gives $G = \\sum_{i} n_i \\mu_i$. The total differential of this expression is $dG = \\sum_{i} n_i d\\mu_i + \\sum_{i} \\mu_i dn_i$. Equating the two expressions for $dG$ at constant $T$ and $P$ leads to the Gibbs-Duhem relation:\n$$\n\\sum_{i} n_i d\\mu_i = 0 \\quad (\\text{at constant } T, P)\n$$\nFor the pseudo-binary system in question, with components $A$ and $B$, this becomes $n_A d\\mu_A + n_B d\\mu_B = 0$. Dividing by the total number of moles, $N = n_A + n_B$, and using the mole fractions $x_A = x = n_A/N$ and $x_B = 1-x = n_B/N$, we obtain:\n$$\nx\\, d\\mu_A + (1-x)\\, d\\mu_B = 0\n$$\nA homogeneous solution is thermodynamically stable with respect to small, local fluctuations in composition if any such fluctuation leads to an increase in the Gibbs free energy. The boundary of this stability region is the spinodal. The condition for instability (spinodal decomposition) is when the system can lower its free energy by separating into two phases of slightly different compositions. This corresponds to a negative curvature of the molar Gibbs free energy function, $g(x)$. The limit of stability, the spinodal, is thus defined by the condition where the curvature is zero.\n\nTo formalize this, we relate the chemical potentials to the molar Gibbs free energy, $g(x) = G/N$. The chemical potentials are given by the tangent intercept method:\n$$\n\\mu_A = g(x) + (1-x)\\frac{dg}{dx}\n$$\n$$\n\\mu_B = g(x) - x\\frac{dg}{dx}\n$$\nFrom these definitions, the difference in chemical potentials is directly related to the first derivative of the molar Gibbs energy:\n$$\n\\mu_A - \\mu_B = \\left( g + (1-x)\\frac{dg}{dx} \\right) - \\left( g - x\\frac{dg}{dx} \\right) = \\frac{dg}{dx}\n$$\nThe stability criterion can be expressed as $\\frac{d(\\mu_A - \\mu_B)}{dx} > 0$. If a region becomes slightly richer in component $A$ (i.e., $x$ increases), the chemical potential difference must increase to drive the system back to homogeneity. Substituting $\\mu_A - \\mu_B = \\frac{dg}{dx}$ into the stability condition gives:\n$$\n\\frac{d}{dx}\\left(\\frac{dg}{dx}\\right) > 0 \\implies \\frac{d^2g}{dx^2} > 0\n$$\nThus, the system is stable when the molar Gibbs free energy function $g(x)$ is convex. The spinodal, which marks the boundary between the stable and unstable regions, is defined by the condition where the convexity vanishes:\n$$\n\\frac{d^2g}{dx^2} = 0\n$$\n\n**Part 2: Application to the Regular Solution Model**\n\nThe molar Gibbs free energy of mixing for the regular solution model is given as:\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x)\n$$\nWe need to compute the second derivative of $g(x)$ with respect to $x$.\nFirst derivative:\n$$\n\\frac{dg}{dx} = \\frac{d}{dx} \\left( R T x \\ln x + R T (1 - x) \\ln(1 - x) + \\Omega x - \\Omega x^2 \\right)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + x\\frac{1}{x} - \\ln(1-x) - (1-x)\\frac{1}{1-x} \\right) + \\Omega(1 - 2x)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + 1 - \\ln(1-x) - 1 \\right) + \\Omega(1-2x) = RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x)\n$$\nSecond derivative:\n$$\n\\frac{d^2g}{dx^2} = \\frac{d}{dx} \\left( RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x) \\right)\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1-x}{x} \\right) \\left( \\frac{(1-x) - x(-1)}{(1-x)^2} \\right) - 2\\Omega\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1}{x(1-x)} \\right) - 2\\Omega\n$$\nApplying the spinodal criterion $\\frac{d^2g}{dx^2} = 0$:\n$$\n\\frac{RT}{x(1-x)} - 2\\Omega = 0 \\implies x(1-x) = \\frac{RT}{2\\Omega}\n$$\nThis can be rewritten as a quadratic equation for $x$:\n$$\nx^2 - x + \\frac{RT}{2\\Omega} = 0\n$$\nUsing the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=1$, $b=-1$, and $c=\\frac{RT}{2\\Omega}$, we find the roots:\n$$\nx = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(1)\\left(\\frac{RT}{2\\Omega}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{2RT}{\\Omega}}}{2}\n$$\nThese are the closed-form expressions for the two spinodal compositions, $x_{-}$ and $x_{+}$.\n$$\nx_{-} = \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n$$\nx_{+} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n\n**Numerical Calculation**\n\nWe are given the following values:\n$T = 1200\\,\\mathrm{K}$\n$\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}} = 20000\\,\\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nFirst, we compute the dimensionless term $\\frac{2RT}{\\Omega}$:\n$$\n\\frac{2RT}{\\Omega} = \\frac{2 \\times (8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (1200\\,\\mathrm{K})}{20000\\,\\mathrm{J\\,mol^{-1}}} = \\frac{19953.6}{20000} = 0.99768\n$$\nNow, substitute this value into the expressions for $x_{-}$ and $x_{+}$:\n$$\nx = \\frac{1 \\pm \\sqrt{1 - 0.99768}}{2} = \\frac{1 \\pm \\sqrt{0.00232}}{2}\n$$\nCalculating the square root:\n$$\n\\sqrt{0.00232} \\approx 0.048166378\n$$\nThe two spinodal compositions are:\n$$\nx_{-} = \\frac{1 - 0.048166378}{2} = \\frac{0.951833622}{2} = 0.475916811...\n$$\n$$\nx_{+} = \\frac{1 + 0.048166378}{2} = \\frac{1.048166378}{2} = 0.524083189...\n$$\nRounding these values to four significant figures as requested gives:\n$x_{-} = 0.4759$\n$x_{+} = 0.5241$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4759 & 0.5241 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and the practical modeling of complex, multicomponent systems like high-entropy alloys (HEAs). You will implement a multicomponent regular solution model to compute chemical potentials and activities, skills central to computational thermodynamics methods like CALPHAD. The exercise culminates in performing a numerical check to verify that your model correctly satisfies the Gibbs-Duhem relation, a crucial step in validating any thermodynamic simulation .",
            "id": "3743526",
            "problem": "Consider a multicomponent substitutional solution representative of a High-Entropy Alloy (HEA). The system consists of $N=4$ components with mole fractions $\\mathbf{x}=(x_1,x_2,x_3,x_4)$ such that $\\sum_{i=1}^{4} x_i = 1$. Let the molar Gibbs free energy of mixing at constant temperature $T$ and pressure $P$ be modeled as the sum of an ideal mixing term and an excess term from a binary-interaction regular solution model, namely\n$$\ng(\\mathbf{x},T) = g^{\\text{ideal}}(\\mathbf{x},T) + g^{\\text{excess}}(\\mathbf{x},T),\n$$\nwhere the ideal term is\n$$\ng^{\\text{ideal}}(\\mathbf{x},T) = R T \\sum_{i=1}^{4} x_i \\ln x_i,\n$$\nand the excess term is\n$$\ng^{\\text{excess}}(\\mathbf{x},T) = \\sum_{1 \\le i < j \\le 4} x_i x_j L_{ij}(T), \\quad L_{ij}(T) = A_{ij} + B_{ij} T.\n$$\nHere $R$ denotes the universal gas constant, and $A_{ij}$ and $B_{ij}$ are temperature-independent coefficients with units of $\\text{J mol}^{-1}$ and $\\text{J mol}^{-1} \\text{K}^{-1}$, respectively.\n\nThe chemical potential of component $i$, $\\mu_i$, is defined by the fundamental thermodynamic relation\n$$\n\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j\\ne i}},\n$$\nwhere $G$ is the total Gibbs free energy and $n_i$ is the amount of substance of component $i$. The activity of component $i$, $a_i$, referenced to the Raoult’s law standard state, is defined by\n$$\n\\mu_i = \\mu_i^{0}(T,P) + R T \\ln a_i,\n$$\nand the activity coefficient $\\gamma_i$ satisfies $a_i = \\gamma_i x_i$.\n\nYour task is to write a program that, for each test case specified below, performs the following:\n\n1. Computes the per-component chemical potentials $\\mu_i$ in $\\text{J mol}^{-1}$ at the given temperature $T$ and composition $\\mathbf{x}$, from first principles starting at the definitions above.\n2. Computes the activities $a_i$ via the activity coefficients derived from the excess contribution to the chemical potentials. Explicitly, use the decomposition $\\mu_i = \\mu_i^{\\text{ideal}} + \\mu_i^{\\text{excess}}$ and define the activity coefficient by $\\gamma_i = \\exp(\\mu_i^{\\text{excess}} / (RT))$ so that $a_i = \\gamma_i x_i$.\n3. Evaluates a discrete check motivated by the Gibbs-Duhem relation at constant $T$ and $P$, by forming small zero-sum composition perturbations $\\delta \\mathbf{x}$ and computing the residual\n$$\n\\Delta(\\mathbf{x},\\delta \\mathbf{x}) = \\left| \\sum_{i=1}^{4} x_i \\left[ \\mu_i(\\mathbf{x} + \\delta \\mathbf{x}, T) - \\mu_i(\\mathbf{x}, T) \\right] \\right|,\n$$\nusing two perturbations:\n   - $\\delta \\mathbf{x}^{(1)} = (\\varepsilon, -\\varepsilon, 0, 0)$,\n   - $\\delta \\mathbf{x}^{(2)} = (\\varepsilon, 0, -\\varepsilon/2, -\\varepsilon/2)$,\n   with $\\varepsilon = 10^{-8}$.\n   If any component of $\\mathbf{x} + \\delta \\mathbf{x}$ would become negative, uniformly scale $\\varepsilon$ downward until all components remain strictly positive. Report, for each test case, the maximum of the two residuals, in $\\text{J mol}^{-1}$.\n\nUse $R = 8.314462618\\ \\text{J mol}^{-1}\\text{K}^{-1}$. All chemical potentials and residuals must be expressed in $\\text{J mol}^{-1}$. Activities are dimensionless. Angles are not involved in this problem.\n\nImplement the computation for the following test suite of parameter values. In each case, the binary-interaction parameters are symmetric, that is, $A_{ij} = A_{ji}$ and $B_{ij} = B_{ji}$.\n\nTest Case 1 (general HEA-like, equimolar composition):\n- $T = 1400\\ \\text{K}$,\n- $\\mathbf{x} = (0.25, 0.25, 0.25, 0.25)$,\n- Nonzero binary interaction parameters:\n  - $(i,j) = (1,2)$: $A_{12} = 4000$, $B_{12} = -1.5$,\n  - $(1,3)$: $A_{13} = 8000$, $B_{13} = 0.0$,\n  - $(1,4)$: $A_{14} = -3000$, $B_{14} = 0.5$,\n  - $(2,3)$: $A_{23} = 2000$, $B_{23} = -0.8$,\n  - $(2,4)$: $A_{24} = 1000$, $B_{24} = 0.2$,\n  - $(3,4)$: $A_{34} = -5000$, $B_{34} = 1.0$.\n\nTest Case 2 (ideal solution, skewed composition near boundary):\n- $T = 1200\\ \\text{K}$,\n- $\\mathbf{x} = (0.70, 0.20, 0.09, 0.01)$,\n- All binary interaction parameters are zero: $A_{ij} = 0$, $B_{ij} = 0$ for all $i \\ne j$.\n\nTest Case 3 (strongly nonideal interactions, non-equimolar composition):\n- $T = 1700\\ \\text{K}$,\n- $\\mathbf{x} = (0.25, 0.35, 0.25, 0.15)$,\n- Nonzero binary interaction parameters:\n  - $(i,j) = (1,2)$: $A_{12} = 15000$, $B_{12} = -5.0$,\n  - $(1,3)$: $A_{13} = -8000$, $B_{13} = 3.0$,\n  - $(1,4)$: $A_{14} = 2000$, $B_{14} = 0.0$,\n  - $(2,3)$: $A_{23} = 5000$, $B_{23} = 1.0$,\n  - $(2,4)$: $A_{24} = -2000$, $B_{24} = 0.5$,\n  - $(3,4)$: $A_{34} = 10000$, $B_{34} = -2.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, return a sublist with three floats:\n- the maximum discrete residual $\\max\\{\\Delta(\\mathbf{x},\\delta \\mathbf{x}^{(1)}),\\Delta(\\mathbf{x},\\delta \\mathbf{x}^{(2)})\\}$ in $\\text{J mol}^{-1}$,\n- the activity $a_1$ of component 1,\n- the activity $a_2$ of component 2.\n\nThus, the final output must have the form\n$$\n[ [r_1, a_{1,1}, a_{2,1}], [r_2, a_{1,2}, a_{2,2}], [r_3, a_{1,3}, a_{2,3}] ],\n$$\nwith each $r_k$ in $\\text{J mol}^{-1}$ and each $a_{i,k}$ dimensionless, all printed on a single line.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in classical chemical thermodynamics, specifically the theory of solutions. The problem is well-posed, with all necessary data and functional forms provided to ensure a unique, meaningful solution exists for each test case. The language is objective and precise, and the framework presented—a multicomponent regular solution model—is a standard and appropriate model for the system described (High-Entropy Alloys). There are no internal contradictions, missing information, or violations of physical principles.\n\nThe solution proceeds as follows. First, we must derive a computable expression for the chemical potential, $\\mu_k$, of component $k$. Second, we use this expression to compute the activities and to perform a numerical check of the Gibbs-Duhem relation.\n\nThe chemical potential of component $k$, $\\mu_k$, is the partial molar Gibbs free energy of that component. The total Gibbs free energy of the system is $G = \\sum_{i=1}^N n_i \\mu_i^0 + G_{\\text{mix}}$, where $\\mu_i^0$ is the chemical potential of pure component $i$ in its standard state, $n_i$ are the mole numbers, and $G_{\\text{mix}}$ is the total Gibbs free energy of mixing. The molar Gibbs free energy of mixing, $g$, is given, so $G_{\\text{mix}} = n_t g$, where $n_t = \\sum_i n_i$ is the total number of moles.\nThe chemical potential is defined as $\\mu_k = (\\partial G / \\partial n_k)_{T,P,n_{j\\ne k}}$. Applying this yields:\n$$\n\\mu_k = \\mu_k^0 + \\left(\\frac{\\partial (n_t g)}{\\partial n_k}\\right)_{T,P,n_{j\\ne k}}\n$$\nThe term involving the derivative of the mixing energy is the partial molar Gibbs free energy of mixing for component $k$. A standard thermodynamic relation for any partial molar quantity $\\bar{Y}_k$ corresponding to a molar quantity $Y$ is:\n$$\n\\bar{Y}_k = Y + \\frac{\\partial Y}{\\partial x_k} - \\sum_{j=1}^{N} x_j \\frac{\\partial Y}{\\partial x_j}\n$$\nwhere the derivatives with respect to mole fractions $x_k$ are taken while treating $N-1$ of them as independent. Let us apply this formula to $g = g^{\\text{ideal}} + g^{\\text{excess}}$. We will denote the partial molar Gibbs free energy of mixing as $\\mu_k^{\\text{mix}} = \\mu_k - \\mu_k^0$.\n\nFor the ideal part, $g^{\\text{ideal}} = R T \\sum_{i=1}^{4} x_i \\ln x_i$:\nThe partial derivative with respect to $x_k$ is $\\frac{\\partial g^{\\text{ideal}}}{\\partial x_k} = R T (\\ln x_k + 1)$.\nThe summation term is $\\sum_{j=1}^{4} x_j \\frac{\\partial g^{\\text{ideal}}}{\\partial x_j} = \\sum_{j=1}^{4} x_j (R T (\\ln x_j + 1)) = R T \\sum_{j=1}^{4} x_j \\ln x_j + R T \\sum_{j=1}^{4} x_j = g^{\\text{ideal}} + R T$.\nThus, the ideal contribution to the mixing chemical potential is:\n$$\n\\mu_k^{\\text{ideal, mix}} = g^{\\text{ideal}} + (R T (\\ln x_k + 1)) - (g^{\\text{ideal}} + R T) = R T \\ln x_k\n$$\nThis is the expected result.\n\nFor the excess part, $g^{\\text{excess}} = \\sum_{1 \\le i < j \\le 4} x_i x_j L_{ij}(T)$, where $L_{ij} = L_{ji}$:\nThe partial derivative with respect to $x_k$ is $\\frac{\\partial g^{\\text{excess}}}{\\partial x_k} = \\sum_{j \\ne k} x_j L_{kj}$.\nThe summation term is $\\sum_{j=1}^{4} x_j \\frac{\\partial g^{\\text{excess}}}{\\partial x_j} = \\sum_{j=1}^{4} x_j \\sum_{l \\ne j} x_l L_{jl} = \\sum_{j \\ne l} x_j x_l L_{jl}$. Since $L_{jl} = L_{lj}$, this sum counts each pair $(j,l)$ twice, so $\\sum_{j \\ne l} x_j x_l L_{jl} = 2 \\sum_{j < l} x_j x_l L_{jl} = 2 g^{\\text{excess}}$.\nThus, the excess chemical potential is:\n$$\n\\mu_k^{\\text{excess}} = g^{\\text{excess}} + \\left( \\sum_{j \\ne k} x_j L_{kj} \\right) - (2 g^{\\text{excess}}) = \\sum_{j \\ne k} x_j L_{kj} - \\sum_{1 \\le i < j \\le 4} x_i x_j L_{ij}\n$$\nCombining these results, the full expression for the mixing chemical potential is:\n$$\n\\mu_k^{\\text{mix}}(\\mathbf{x}, T) = \\mu_k - \\mu_k^0 = R T \\ln x_k + \\sum_{j \\ne k} x_j L_{kj}(T) - \\sum_{1 \\le i < j \\le 4} x_i x_j L_{ij}(T)\n$$\nThe problem asks for computation of $\\mu_i$, but does not provide $\\mu_i^0$. However, the subsequent tasks (activity and Gibbs-Duhem check) depend only on the mixing or excess parts of the chemical potential. We interpret the instruction \"computes the per-component chemical potentials\" as the task to calculate the mixing chemical potential, $\\mu_k^{\\text{mix}}$, which is equivalent to setting the standard state potentials $\\mu_k^0$ to $0$.\n\nThe tasks can now be addressed algorithmically:\n\n1.  **Chemical Potential Calculation**: We implement a function that takes composition $\\mathbf{x}$, temperature $T$, and interaction parameters $A_{ij}$ and $B_{ij}$ as input. This function first computes the temperature-dependent interaction matrix $L_{ij}(T) = A_{ij} + B_{ij}T$. It then calculates $g^{\\text{excess}}$ and finally evaluates $\\mu_k^{\\text{mix}}$ for each component $k=1,2,3,4$ using the derived formula.\n\n2.  **Activity Calculation**: The activity coefficient $\\gamma_k$ is given by $\\gamma_k = \\exp(\\mu_k^{\\text{excess}} / (R T))$. The activity is $a_k = \\gamma_k x_k$. The required term $\\mu_k^{\\text{excess}}$ is computed as an intermediate step in the calculation of $\\mu_k^{\\text{mix}}$. We will calculate $a_1$ and $a_2$ for each test case.\n\n3.  **Gibbs-Duhem Check**: The Gibbs-Duhem relation at constant $T$ and $P$ states that $\\sum_{i} x_i d\\mu_i = 0$. For a small, discrete change in composition from $\\mathbf{x}$ to $\\mathbf{x} + \\delta\\mathbf{x}$, this implies that the sum $\\sum_{i} x_i [\\mu_i(\\mathbf{x}+\\delta\\mathbf{x}) - \\mu_i(\\mathbf{x})]$ should be close to zero. The residual $\\Delta(\\mathbf{x}, \\delta\\mathbf{x})$ is the absolute value of this sum. The changes in $\\mu_i$ are identical to the changes in $\\mu_i^{\\text{mix}}$, as $\\mu_i^0$ is constant. We compute $\\mu_i^{\\text{mix}}(\\mathbf{x}, T)$ and $\\mu_i^{\\text{mix}}(\\mathbf{x}+\\delta\\mathbf{x}, T)$ for the two given perturbations, calculate the corresponding residuals $\\Delta(\\mathbf{x}, \\delta\\mathbf{x}^{(1)})$ and $\\Delta(\\mathbf{x}, \\delta\\mathbf{x}^{(2)})$, and report the maximum of the two. The perturbation magnitude $\\varepsilon = 10^{-8}$ is small enough for the given compositions that no component becomes negative, so no scaling of $\\varepsilon$ is required.\n\nThe implementation will process each of the three test cases, performing these calculations and aggregating the required outputs (maximum residual, $a_1$, $a_2$) into a final list for printing.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamics problem for multicomponent solutions as specified.\n    \"\"\"\n    \n    R_GAS_CONSTANT = 8.314462618  # J mol^-1 K^-1\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"T\": 1400.0,\n            \"x\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"params\": {\n                (1, 2): (4000.0, -1.5), (1, 3): (8000.0, 0.0), (1, 4): (-3000.0, 0.5),\n                (2, 3): (2000.0, -0.8), (2, 4): (1000.0, 0.2), (3, 4): (-5000.0, 1.0)\n            }\n        },\n        {\n            \"T\": 1200.0,\n            \"x\": np.array([0.70, 0.20, 0.09, 0.01]),\n            \"params\": {}\n        },\n        {\n            \"T\": 1700.0,\n            \"x\": np.array([0.25, 0.35, 0.25, 0.15]),\n            \"params\": {\n                (1, 2): (15000.0, -5.0), (1, 3): (-8000.0, 3.0), (1, 4): (2000.0, 0.0),\n                (2, 3): (5000.0, 1.0), (2, 4): (-2000.0, 0.5), (3, 4): (10000.0, -2.0)\n            }\n        }\n    ]\n\n    def get_mu_mix(x_vec, T, L_mat):\n        \"\"\"\n        Calculates the mixing chemical potentials and excess chemical potentials.\n        \n        Args:\n            x_vec (np.ndarray): Mole fraction vector (4,).\n            T (float): Temperature in Kelvin.\n            L_mat (np.ndarray): Matrix of interaction parameters L_ij (4x4).\n            \n        Returns:\n            tuple: (mu_mix, mu_excess) where each is a (4,) numpy array.\n        \"\"\"\n        N = 4\n        \n        # Calculate excess Gibbs energy\n        g_excess = 0.0\n        for i in range(N):\n            for j in range(i + 1, N):\n                g_excess += x_vec[i] * x_vec[j] * L_mat[i, j]\n\n        mu_mix = np.zeros(N)\n        mu_excess = np.zeros(N)\n        RT = R_GAS_CONSTANT * T\n\n        for k in range(N):\n            # Term for sum over j != k\n            sum_term = 0.0\n            for j in range(N):\n                if k != j:\n                    sum_term += x_vec[j] * L_mat[k, j]\n            \n            # Excess chemical potential\n            mu_excess_k = sum_term - g_excess\n            mu_excess[k] = mu_excess_k\n            \n            # Ideal mixing chemical potential part\n            # Use small epsilon to avoid log(0) if a component is zero, although not in test cases\n            mu_ideal_mix_k = RT * np.log(x_vec[k] if x_vec[k] > 0 else 1e-100)\n            \n            # Total mixing chemical potential\n            mu_mix[k] = mu_ideal_mix_k + mu_excess_k\n            \n        return mu_mix, mu_excess\n\n    final_results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        x = case[\"x\"]\n        \n        # Setup interaction parameter matrices\n        N_COMPONENTS = 4\n        A = np.zeros((N_COMPONENTS, N_COMPONENTS))\n        B = np.zeros((N_COMPONENTS, N_COMPONENTS))\n        \n        for (i, j), (A_val, B_val) in case[\"params\"].items():\n            A[i-1, j-1] = A_val\n            A[j-1, i-1] = A_val # Symmetric\n            B[i-1, j-1] = B_val\n            B[j-1, i-1] = B_val # Symmetric\n            \n        # Calculate L_ij(T) matrix\n        L = A + B * T\n        \n        # --- Base calculation ---\n        mu_mix_base, mu_excess_base = get_mu_mix(x, T, L)\n        \n        # --- Activity calculation (Task 2) ---\n        RT = R_GAS_CONSTANT * T\n        gamma = np.exp(mu_excess_base / RT)\n        activities = gamma * x\n        a1, a2 = activities[0], activities[1]\n\n        # --- Gibbs-Duhem Check (Task 3) ---\n        epsilon = 1e-8\n        \n        # Perturbation 1\n        delta_x1 = np.array([epsilon, -epsilon, 0.0, 0.0])\n        x_perturbed1 = x + delta_x1\n        # The problem statement guarantees no component will be <= 0 for the given test cases.\n        mu_mix_pert1, _ = get_mu_mix(x_perturbed1, T, L)\n        residual1 = np.abs(np.sum(x * (mu_mix_pert1 - mu_mix_base)))\n        \n        # Perturbation 2\n        delta_x2 = np.array([epsilon, 0.0, -epsilon / 2.0, -epsilon / 2.0])\n        x_perturbed2 = x + delta_x2\n        mu_mix_pert2, _ = get_mu_mix(x_perturbed2, T, L)\n        residual2 = np.abs(np.sum(x * (mu_mix_pert2 - mu_mix_base)))\n        \n        max_residual = max(residual1, residual2)\n        \n        final_results.append([max_residual, a1, a2])\n\n    # Format the output as specified\n    output_str = str(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}