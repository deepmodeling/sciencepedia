{
    "hands_on_practices": [
        {
            "introduction": "This practice begins with first principles—the Boltzmann relation and Stirling's approximation—to derive the foundational equation for ideal configurational entropy in a multi-component system. This exercise is crucial for understanding how compositional disorder contributes to the thermodynamic stability of materials like high-entropy alloys. By comparing the entropy of a specific non-equimolar alloy to its maximum possible value, you will gain a quantitative feel for how composition dictates the entropic landscape .",
            "id": "3734886",
            "problem": "Consider an ideal, randomly mixed, substitutional quaternary alloy on a fixed lattice with a very large number $N$ of lattice sites. Let the macroscopic composition be specified by the site fractions $x_{i}$ for species $i \\in \\{1,2,3,4\\}$, with $\\sum_{i=1}^{4} x_{i} = 1$. Assume atoms of the same species are indistinguishable and lattice sites are distinguishable. Take the thermodynamic limit $N \\to \\infty$, and assume the ideal mixing model with no energetic preference among species and no short-range order. Using the Boltzmann relation $S = k_{B} \\ln \\Omega$ for the entropy, where $\\Omega$ is the number of distinct microstates consistent with the macroscopic composition, and treating the problem at fixed $N$ and $\\{x_{i}\\}$, derive the expression for the ideal configurational entropy per mole, $S_{\\text{ideal}}$, normalized by the gas constant $R$.\n\nThen, evaluate this normalized entropy for the composition $x = \\{0.4, 0.3, 0.2, 0.1\\}$ and for the equimolar quaternary case $x = \\{0.25, 0.25, 0.25, 0.25\\}$. Report, as your final answer, the single dimensionless ratio\n$$\\frac{S_{\\text{ideal}}(x=\\{0.4,0.3,0.2,0.1\\})/R}{S_{\\text{ideal}}(x=\\{0.25,0.25,0.25,0.25\\})/R}.$$\nRound your final ratio to five significant figures. No units are required for the final ratio.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of statistical mechanics, well-posed with sufficient and consistent information, and objectively stated. The problem requires the derivation of the ideal configurational entropy for a multi-component system and the calculation of a specific ratio, which is a standard procedure in materials thermodynamics.\n\nThe first step is to derive the general expression for the ideal configurational entropy per mole, $S_{\\text{ideal}}$, normalized by the gas constant, $R$. The system is a quaternary alloy on a fixed lattice of $N$ sites, where $N$ is very large. The composition is given by the site fractions $x_i$ for the four species ($i \\in \\{1, 2, 3, 4\\}$), with $\\sum_{i=1}^{4} x_i = 1$. The number of atoms of species $i$ is $N_i = x_i N$.\n\nAccording to the postulates of statistical mechanics for this problem, atoms of the same species are indistinguishable, while the lattice sites are distinguishable. The number of distinct microstates, $\\Omega$, corresponding to a given macroscopic composition $\\{x_i\\}$, is the number of ways to arrange the $N_1, N_2, N_3, N_4$ atoms on the $N$ available lattice sites. This is given by the multinomial coefficient:\n$$\n\\Omega = \\frac{N!}{N_1! N_2! N_3! N_4!} = \\frac{N!}{\\prod_{i=1}^{4} (x_i N)!}\n$$\nThe configurational entropy, $S$, is given by the Boltzmann relation, $S = k_B \\ln \\Omega$, where $k_B$ is the Boltzmann constant.\n$$\nS = k_B \\ln\\left(\\frac{N!}{\\prod_{i=1}^{4} (x_i N)!}\\right) = k_B \\left( \\ln(N!) - \\sum_{i=1}^{4} \\ln((x_i N)!) \\right)\n$$\nSince the problem specifies the thermodynamic limit $N \\to \\infty$, both $N$ and each $N_i = x_i N$ are very large numbers. We can therefore apply Stirling's approximation for the natural logarithm of a factorial, $\\ln(k!) \\approx k \\ln k - k$. Applying this to our expression for $S$:\n$$\nS \\approx k_B \\left[ (N \\ln N - N) - \\sum_{i=1}^{4} (x_i N \\ln(x_i N) - x_i N) \\right]\n$$\nWe can expand the term $\\ln(x_i N) = \\ln x_i + \\ln N$:\n$$\nS \\approx k_B \\left[ N \\ln N - N - \\sum_{i=1}^{4} (x_i N (\\ln x_i + \\ln N) - x_i N) \\right]\n$$\n$$\nS \\approx k_B \\left[ N \\ln N - N - \\sum_{i=1}^{4} x_i N \\ln x_i - \\sum_{i=1}^{4} x_i N \\ln N + \\sum_{i=1}^{4} x_i N \\right]\n$$\nFactoring out common terms:\n$$\nS \\approx k_B \\left[ N \\ln N - N - N \\sum_{i=1}^{4} x_i \\ln x_i - N \\ln N \\left(\\sum_{i=1}^{4} x_i\\right) + N \\left(\\sum_{i=1}^{4} x_i\\right) \\right]\n$$\nUsing the compositional constraint $\\sum_{i=1}^{4} x_i = 1$:\n$$\nS \\approx k_B \\left[ N \\ln N - N - N \\sum_{i=1}^{4} x_i \\ln x_i - N \\ln N (1) + N (1) \\right]\n$$\nThe terms $(N \\ln N - N \\ln N)$ and $(-N + N)$ cancel out, yielding the expression for the total configurational entropy:\n$$\nS = -N k_B \\sum_{i=1}^{4} x_i \\ln x_i\n$$\nThe problem asks for the entropy per mole, $S_{\\text{ideal}}$. A system of $N$ atoms corresponds to $n = N/N_A$ moles, where $N_A$ is Avogadro's constant. The molar entropy is $S_{\\text{ideal}} = S/n = S / (N/N_A) = S N_A / N$.\n$$\nS_{\\text{ideal}} = \\frac{N_A}{N} \\left(-N k_B \\sum_{i=1}^{4} x_i \\ln x_i\\right) = -N_A k_B \\sum_{i=1}^{4} x_i \\ln x_i\n$$\nRecognizing that the molar gas constant is $R = N_A k_B$, we obtain the expression for the ideal molar configurational entropy:\n$$\nS_{\\text{ideal}} = -R \\sum_{i=1}^{4} x_i \\ln x_i\n$$\nThe normalized entropy is therefore:\n$$\n\\frac{S_{\\text{ideal}}}{R} = - \\sum_{i=1}^{4} x_i \\ln x_i\n$$\nNow, we evaluate this expression for the two specified compositions.\n\nCase 1: Composition $x_A = \\{0.4, 0.3, 0.2, 0.1\\}$.\nLet the normalized entropy be $S_{A, \\text{norm}} = S_{\\text{ideal}}(x_A)/R$.\n$$\nS_{A, \\text{norm}} = - \\left( 0.4 \\ln(0.4) + 0.3 \\ln(0.3) + 0.2 \\ln(0.2) + 0.1 \\ln(0.1) \\right)\n$$\nUsing the values of the natural logarithm:\n$\\ln(0.4) \\approx -0.9162907$\n$\\ln(0.3) \\approx -1.2039728$\n$\\ln(0.2) \\approx -1.6094379$\n$\\ln(0.1) \\approx -2.3025851$\n$$\nS_{A, \\text{norm}} \\approx - \\left( 0.4(-0.9162907) + 0.3(-1.2039728) + 0.2(-1.6094379) + 0.1(-2.3025851) \\right)\n$$\n$$\nS_{A, \\text{norm}} \\approx - \\left( -0.3665163 - 0.3611918 - 0.3218876 - 0.2302585 \\right)\n$$\n$$\nS_{A, \\text{norm}} \\approx -(-1.2798542) = 1.2798542\n$$\n\nCase 2: Equimolar composition $x_B = \\{0.25, 0.25, 0.25, 0.25\\}$.\nLet the normalized entropy be $S_{B, \\text{norm}} = S_{\\text{ideal}}(x_B)/R$.\n$$\nS_{B, \\text{norm}} = - \\sum_{i=1}^{4} 0.25 \\ln(0.25) = -4 \\times (0.25 \\ln(0.25)) = -\\ln(0.25)\n$$\nSince $\\ln(0.25) = \\ln(1/4) = -\\ln(4)$, we have:\n$$\nS_{B, \\text{norm}} = \\ln(4)\n$$\nNumerically, $S_{B, \\text{norm}} \\approx 1.3862944$. This value corresponds to the maximum possible configurational entropy for a quaternary system.\n\nFinally, we compute the required ratio:\n$$\n\\text{Ratio} = \\frac{S_{\\text{ideal}}(x_A)/R}{S_{\\text{ideal}}(x_B)/R} = \\frac{S_{A, \\text{norm}}}{S_{B, \\text{norm}}} = \\frac{- \\sum_{i=1}^{4} x_{A,i} \\ln x_{A,i}}{\\ln(4)}\n$$\n$$\n\\text{Ratio} = \\frac{1.2798542}{1.3862944} \\approx 0.9232238\n$$\nRounding this result to five significant figures as requested gives $0.92322$.",
            "answer": "$$\\boxed{0.92322}$$"
        },
        {
            "introduction": "Moving beyond the ideal thermodynamic limit, this practice explores the impact of finite system size on configurational entropy, a critical consideration in nanomaterials and computational simulations. You will use a more precise form of Stirling's approximation to derive a finite-size correction to the standard entropy formula. This exercise  illuminates the subtle but important differences between macroscopic systems and the finite models we often work with, enhancing your ability to critically assess theoretical calculations.",
            "id": "3734844",
            "problem": "A substitutional binary alloy of species $A$ and $B$ occupies a rigid lattice with $N=10^{5}$ distinguishable sites. The composition is fixed at $x_{A}=0.01$ and $x_{B}=1-x_{A}$. Assume ideal random mixing without energetic interactions, and that the only constraint is the fixed composition (no vacancies or interstitials). Starting from the microcanonical definition of entropy $S=k_{B}\\ln\\Omega$, where $k_{B}$ is the Boltzmann constant and $\\Omega$ is the number of distinct configurations consistent with the composition constraint, and using the exact combinatorial count of configurations for $N_{A}=x_{A}N$ atoms of $A$ and $N_{B}=x_{B}N$ atoms of $B$, derive the configurational entropy density $s=S/N$ in the thermodynamic limit and quantify the leading finite-size correction due to finite $N$ and small $x_{A}$. Evaluate the corrected entropy density $s_{\\text{corr}}/k_{B}$ for $N=10^{5}$ and $x_{A}=0.01$.\n\nYour derivation must begin from the definitions above, use asymptotic expansions appropriate for large factorials, and show how composition enters the entropy density. In your analysis, briefly explain how finite composition at small $x_{A}$ affects the entropy density and the sign of the finite-size correction. Report the final numerical value of the corrected entropy density $s_{\\text{corr}}/k_{B}$ as a dimensionless number, and round your answer to six significant figures.",
            "solution": "The problem is valid as it is a standard, well-posed problem in statistical mechanics that is scientifically grounded, objective, and internally consistent.\n\nThe system is a substitutional binary alloy on a lattice of $N$ sites with $N_A$ atoms of species $A$ and $N_B$ atoms of species $B$. The total number of sites is $N = N_A + N_B$. The composition is given by the mole fractions $x_A = N_A/N$ and $x_B = N_B/N = 1-x_A$.\n\nThe number of distinct configurations $\\Omega$ for arranging $N_A$ atoms of type $A$ on $N$ sites is given by the binomial coefficient:\n$$\n\\Omega = \\binom{N}{N_A} = \\frac{N!}{N_A! N_B!}\n$$\nThe microcanonical entropy $S$ is defined as $S = k_B \\ln \\Omega$, where $k_B$ is the Boltzmann constant.\n$$\nS = k_B \\ln\\left(\\frac{N!}{N_A! N_B!}\\right) = k_B (\\ln N! - \\ln N_A! - \\ln N_B!)\n$$\nTo evaluate this for large numbers of atoms, we use an asymptotic expansion for the factorial, commonly known as Stirling's approximation. To find the finite-size correction, we must use a form more accurate than the leading-order approximation. We use:\n$$\n\\ln n! \\approx n \\ln n - n + \\frac{1}{2}\\ln(2\\pi n) + O(1/n)\n$$\nSubstituting this into the expression for entropy:\n$$\n\\frac{S}{k_B} \\approx \\left(N \\ln N - N + \\frac{1}{2}\\ln(2\\pi N)\\right) - \\left(N_A \\ln N_A - N_A + \\frac{1}{2}\\ln(2\\pi N_A)\\right) - \\left(N_B \\ln N_B - N_B + \\frac{1}{2}\\ln(2\\pi N_B)\\right)\n$$\nWe group the terms. The terms linear in particle number are:\n$$\n(N \\ln N - N) - (N_A \\ln N_A - N_A) - (N_B \\ln N_B - N_B)\n$$\nSince $N = N_A + N_B$, the linear terms $-N$, $-(-N_A)$, and $-(-N_B)$ cancel out. We are left with:\n$$\nN \\ln N - N_A \\ln N_A - N_B \\ln N_B\n$$\nSubstituting $N_A = x_A N$ and $N_B = x_B N = (1-x_A)N$:\n$$\nN \\ln N - (x_A N) \\ln(x_A N) - (x_B N) \\ln(x_B N)\n$$\n$$\n= N \\ln N - x_A N (\\ln x_A + \\ln N) - x_B N (\\ln x_B + \\ln N)\n$$\n$$\n= N (\\ln N - x_A \\ln N - x_B \\ln N) - N(x_A \\ln x_A + x_B \\ln x_B)\n$$\nSince $x_A + x_B = 1$, the first parenthesis becomes $\\ln N - (x_A+x_B)\\ln N = \\ln N - \\ln N = 0$. This leaves the leading contribution to the entropy:\n$$\nS_{\\text{thermo}} = -k_B N (x_A \\ln x_A + x_B \\ln x_B)\n$$\nIn the thermodynamic limit ($N \\to \\infty$), the entropy density $s = S/N$ is:\n$$\ns = \\frac{S_{\\text{thermo}}}{N} = -k_B (x_A \\ln x_A + x_B \\ln x_B)\n$$\nNow, we analyze the correction terms from the Stirling expansion, which we denote as $\\Delta S$:\n$$\n\\frac{\\Delta S}{k_B} = \\frac{1}{2}\\ln(2\\pi N) - \\frac{1}{2}\\ln(2\\pi N_A) - \\frac{1}{2}\\ln(2\\pi N_B)\n$$\n$$\n= \\frac{1}{2} [\\ln(2\\pi N) - \\ln(2\\pi N_A) - \\ln(2\\pi N_B)]\n$$\n$$\n= \\frac{1}{2} \\ln\\left(\\frac{2\\pi N}{(2\\pi N_A)(2\\pi N_B)}\\right) = \\frac{1}{2} \\ln\\left(\\frac{N}{2\\pi N_A N_B}\\right)\n$$\nSubstituting $N_A = x_A N$ and $N_B = x_B N$:\n$$\n\\frac{\\Delta S}{k_B} = \\frac{1}{2} \\ln\\left(\\frac{N}{2\\pi (x_A N)(x_B N)}\\right) = \\frac{1}{2} \\ln\\left(\\frac{1}{2\\pi N x_A x_B}\\right) = -\\frac{1}{2} \\ln(2\\pi N x_A x_B)\n$$\nThe total corrected entropy is $S_{\\text{corr}} = S_{\\text{thermo}} + \\Delta S$. The corrected entropy density $s_{\\text{corr}} = S_{\\text{corr}}/N$ is:\n$$\ns_{\\text{corr}} = s + \\frac{\\Delta S}{N} = -k_B (x_A \\ln x_A + x_B \\ln x_B) - \\frac{k_B}{2N} \\ln(2\\pi N x_A x_B)\n$$\nThe dimensionless corrected entropy density is:\n$$\n\\frac{s_{\\text{corr}}}{k_B} = -(x_A \\ln x_A + x_B \\ln x_B) - \\frac{1}{2N} \\ln(2\\pi N x_A (1-x_A))\n$$\nThe finite-size correction term is $\\Delta s/k_B = -\\frac{1}{2N}\\ln(2\\pi N x_A(1-x_A))$. Its sign is determined by the argument of the logarithm. The use of this correction is valid when the argument of the square root in the Gaussian approximation of the binomial coefficient is large, i.e., $2\\pi N x_A(1-x_A) \\gg 1$. Given $N=10^5$ and $x_A=0.01$, the argument is $2\\pi(10^5)(0.01)(0.99) = 1980\\pi \\approx 6220$, which is much greater than $1$. Therefore, its logarithm is positive. The entire correction term $\\Delta s$ is thus negative. This negative sign indicates that the entropy of a finite system is lower than the value predicted by the simple thermodynamic limit formula, which effectively overestimates the number of available configurations. The small value of $x_A=0.01$ places the alloy in a composition regime of low entropy, far from the maximum at $x_A=0.5$. The magnitude of the finite-size correction, which depends on $x_A(1-x_A)$, is also smaller than it would be for an equimolar composition.\n\nWe now evaluate the corrected entropy density for the given parameters: $N=10^5$ and $x_A=0.01$. Thus, $x_B = 1 - 0.01 = 0.99$.\nThe expression to evaluate is:\n$$\n\\frac{s_{\\text{corr}}}{k_B} = -[0.01 \\ln(0.01) + 0.99 \\ln(0.99)] - \\frac{1}{2 \\times 10^5} \\ln(2\\pi \\times 10^5 \\times 0.01 \\times 0.99)\n$$\nFirst, calculate the thermodynamic term:\n$$\nT_1 = -[0.01 \\ln(0.01) + 0.99 \\ln(0.99)] \\approx -[0.01 \\times (-4.605170) + 0.99 \\times (-0.010050)]\n$$\n$$\nT_1 \\approx -[-0.0460517 - 0.0099495] = 0.0560012\n$$\nNext, calculate the correction term:\n$$\nT_2 = -\\frac{1}{2 \\times 10^5} \\ln(1980\\pi) \\approx -\\frac{1}{2 \\times 10^5} \\ln(6220.353) \\approx -\\frac{8.735593}{2 \\times 10^5}\n$$\n$$\nT_2 \\approx -0.000043678\n$$\nAdding the two terms with higher precision:\n$$\nT_1 \\approx 0.0560015344\n$$\n$$\nT_2 \\approx -0.0000436780\n$$\n$$\n\\frac{s_{\\text{corr}}}{k_B} = T_1 + T_2 \\approx 0.0560015344 - 0.0000436780 = 0.0559578564\n$$\nRounding to six significant figures, we get $0.0559579$.",
            "answer": "$$\\boxed{0.0559579}$$"
        },
        {
            "introduction": "This advanced computational exercise generalizes our understanding of configurational entropy by moving from a fixed-composition system to one in equilibrium with a chemical reservoir. You will derive the probability distribution of compositions within a semi-grand canonical framework and compute the entropy using the Gibbs formulation, $S = -k_{\\mathrm{B}} \\sum P \\ln P$. This practice  provides a powerful tool for modeling systems where composition can fluctuate, connecting abstract statistical mechanics principles to a practical, code-based implementation.",
            "id": "3734828",
            "problem": "Consider a lattice model for a multi-component substitutional solid solution relevant to High-Entropy Alloys (HEA) and complex materials. The lattice has $M$ sites, and there are $K$ chemically distinct species labeled $i \\in \\{1,2,\\dots,K\\}$. Each lattice site is occupied by exactly one species, and $n_i$ denotes the number of sites occupied by species $i$, subject to the constraint $\\sum_{i=1}^K n_i = M$. The system is in contact with a reservoir characterized by chemical potentials $\\{\\mu_i\\}$ and a temperature $T$. Assume that site energies are equivalent and interactions beyond species identity are negligible, so that the only energetic driving terms are the chemical potentials.\n\nStarting from the Grand Canonical Ensemble (GCE) and elementary combinatorics of lattice occupations, derive the composition distribution $P(\\{n_i\\})$ over the allowed vectors $\\{n_i\\}$ and use it to compute the configurational entropy, defined as $S = - k_{\\mathrm{B}} \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. You must express the final results in units of $k_{\\mathrm{B}}$, i.e., report $S/k_{\\mathrm{B}}$ as dimensionless real numbers. Angles do not appear in this problem. No percentages are involved.\n\nYour program must:\n- Enumerate all integer compositions $\\{n_i\\}$ such that each $n_i \\ge 0$ and $\\sum_{i=1}^K n_i = M$.\n- Use the GCE weighting consistent with the fundamental principle that probabilities are proportional to the exponential of the energy divided by $k_{\\mathrm{B}} T$, together with the combinatorial multiplicity of configurations for a given composition.\n- Normalize the distribution $P(\\{n_i\\})$ exactly (to within numerical precision) over all compositions.\n- Compute $S/k_{\\mathrm{B}}$ exactly by summing $- \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$.\n\nUse the Boltzmann constant in electronvolt per Kelvin, $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5} \\,\\mathrm{eV/K}$, and chemical potentials $\\mu_i$ specified in electronvolt (eV). Temperature $T$ is in Kelvin (K). The parameter $M$ is dimensionless.\n\nTest Suite:\nEvaluate $S/k_{\\mathrm{B}}$ for the following cases. In all cases, $M$, $K$, $\\{\\mu_i\\}$, and $T$ are provided, with $\\mu_i$ in electronvolt and $T$ in Kelvin.\n\n- Case $1$: $M = 5$, $K = 3$, $\\{\\mu_i\\} = \\{0.2, 0.0, -0.1\\}$, $T = 1000$.\n- Case $2$: $M = 4$, $K = 3$, $\\{\\mu_i\\} = \\{0.0, 0.0, 0.0\\}$, $T = 1000$.\n- Case $3$: $M = 6$, $K = 3$, $\\{\\mu_i\\} = \\{1.0, -1.0, -1.0\\}$, $T = 300$.\n- Case $4$: $M = 1$, $K = 4$, $\\{\\mu_i\\} = \\{0.0, 0.0, 0.0, 0.0\\}$, $T = 500$.\n- Case $5$: $M = 7$, $K = 5$, $\\{\\mu_i\\} = \\{-0.05, 0.1, 0.0, 0.2, -0.15\\}$, $T = 1200$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases listed above. For example, the output should look like $[s_1,s_2,s_3,s_4,s_5]$, where each $s_j$ is the computed $S/k_{\\mathrm{B}}$ for Case $j$ as a floating-point number.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of statistical mechanics as applied to materials science, specifically using a lattice model for a multi-component alloy. The problem is well-posed, with all necessary parameters and definitions provided for a unique and meaningful solution. The methodology is clearly specified, and the test cases are computationally feasible.\n\nThe task is to compute the configurational entropy of the distribution of compositions in a multi-component system. This quantity is explicitly defined as $S = - k_{\\mathrm{B}} \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$, where $P(\\{n_i\\})$ is the probability of finding the system in a state with a specific composition vector $\\{n_i\\} = (n_1, n_2, \\dots, n_K)$. The system consists of $M$ lattice sites occupied by $K$ species, with the total number of sites being fixed, $\\sum_{i=1}^K n_i = M$. The system's energetics are governed by the chemical potentials $\\{\\mu_i\\}$ and temperature $T$.\n\nFirst, we derive the probability distribution $P(\\{n_i\\})$. The problem directs us to use the Grand Canonical Ensemble (GCE) framework. However, the total number of particles (or sites) $M$ is fixed. This configuration corresponds to a semi-grand canonical ensemble, where particle types can be exchanged with a reservoir, but the total number of particles is conserved.\n\nThe Hamiltonian of the system is taken to be zero, as site energies are equivalent and there are no interactions. In the presence of a chemical potential reservoir, the effective Hamiltonian is $H' = H - \\sum_{i=1}^K \\mu_i N_i = - \\sum_{i=1}^K \\mu_i N_i$, where $N_i$ is the number operator for species $i$.\n\nThe partition function $Z$ is the sum over all possible microscopic configurations of the lattice. A microstate is a specific assignment of a species $s_j \\in \\{1, \\dots, K\\}$ to each site $j \\in \\{1, \\dots, M\\}$.\n$$ Z = \\sum_{\\text{microstates}} \\exp\\left( - \\frac{H'}{k_{\\mathrm{B}} T} \\right) = \\sum_{s_1=1}^K \\dots \\sum_{s_M=1}^K \\exp\\left( \\frac{\\sum_{j=1}^M \\mu_{s_j}}{k_{\\mathrm{B}} T} \\right) $$\nSince the sites are independent, we can separate the sums:\n$$ Z = \\prod_{j=1}^M \\left( \\sum_{s_j=1}^K \\exp\\left( \\frac{\\mu_{s_j}}{k_{\\mathrm{B}} T} \\right) \\right) = \\left( \\sum_{i=1}^K \\exp\\left( \\frac{\\mu_i}{k_{\\mathrm{B}} T} \\right) \\right)^M $$\nLet's define a single-site partition function $z = \\sum_{i=1}^K \\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)$. Then $Z = z^M$.\nLet $p_i$ be the probability that a given site is occupied by species $i$. This is given by the Boltzmann weight for that species divided by the single-site partition function:\n$$ p_i = \\frac{\\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)}{z} = \\frac{\\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)}{\\sum_{k=1}^K \\exp\\left(\\frac{\\mu_k}{k_{\\mathrm{B}} T}\\right)} $$\nNote that $\\sum_{i=1}^K p_i = 1$. The probability of a specific microstate with composition $\\{n_i\\}$ (i.e., $n_1$ particles of species $1$, $n_2$ of species $2$, etc.) is the product of the probabilities for each site, since the sites are independent: $\\prod_{i=1}^K p_i^{n_i}$.\n\nThe problem asks for the probability of the composition $\\{n_i\\}$ itself, which is a macrostate. To find this, we must multiply the probability of one microstate with that composition by the number of ways to arrange the particles on the lattice to achieve that composition. This combinatorial factor is the multinomial coefficient, $\\Omega(\\{n_i\\}) = \\frac{M!}{n_1! n_2! \\dots n_K!}$.\nThus, the probability distribution of the compositions is the multinomial distribution:\n$$ P(\\{n_i\\}) = \\frac{M!}{\\prod_{i=1}^K n_i!} \\prod_{i=1}^K p_i^{n_i} $$\nwhere $\\{n_i\\}$ is any vector of non-negative integers such that $\\sum_{i=1}^K n_i = M$.\n\nThe final step is to compute the configurational entropy as defined in the problem, $S/k_{\\mathrm{B}} = - \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$. The summation is over all possible composition vectors $\\{n_i\\}$.\n\nThe algorithm for the computation is as follows:\n1.  For each test case, define the parameters $M$, $K$, $\\{\\mu_i\\}$, and $T$, and the value of $k_{\\mathrm{B}}$.\n2.  Generate all unique integer compositions $\\{n_i\\}$ such that $n_i \\ge 0$ and $\\sum_{i=1}^K n_i = M$. A recursive function is well-suited for this combinatorial enumeration.\n3.  Calculate the single-site probabilities $\\{p_i\\}$. To ensure numerical stability, we can define a shifted set of chemical potentials $\\mu'_i = \\mu_i - \\max(\\{\\mu_k\\})$. The probabilities $p_i$ are invariant under this shift:\n    $$ p_i = \\frac{\\exp\\left(\\frac{\\mu'_i}{k_{\\mathrm{B}} T}\\right)}{\\sum_{k=1}^K \\exp\\left(\\frac{\\mu'_k}{k_{\\mathrm{B}} T}\\right)} $$\n    This prevents floating-point overflow when calculating the exponentials.\n4.  For each composition $\\{n_i\\}$, calculate its probability $P(\\{n_i\\})$. To avoid both overflow with the factorials and underflow with the probability products, it is best to compute the logarithm of the probability first:\n    $$ \\ln P(\\{n_i\\}) = \\ln(M!) - \\sum_{i=1}^K \\ln(n_i!) + \\sum_{i=1}^K n_i \\ln(p_i) $$\n    The log-factorial term, $\\ln(n!)$, is accurately computed using the log-gamma function, $\\ln(n!) = \\text{gammaln}(n+1)$. From $\\ln P(\\{n_i\\})$, we can find $P(\\{n_i\\}) = \\exp(\\ln P(\\{n_i\\}))$.\n5.  Iterate through all compositions, and for each, calculate the term $-P(\\{n_i\\}) \\ln(P(\\{n_i\\}))$ and add it to a running sum. A check for $P(\\{n_i\\}) > 0$ is necessary, as computationally $P \\ln P \\to 0$ as $P \\to 0$.\n6.  The final sum is the desired value of $S/k_{\\mathrm{B}}$.\nThis procedure is exact and robust for the given range of parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    test_cases = [\n        # Case 1: M = 5, K = 3, {mu_i} = {0.2, 0.0, -0.1}, T = 1000\n        {'M': 5, 'K': 3, 'mu': [0.2, 0.0, -0.1], 'T': 1000},\n        # Case 2: M = 4, K = 3, {mu_i} = {0.0, 0.0, 0.0}, T = 1000\n        {'M': 4, 'K': 3, 'mu': [0.0, 0.0, 0.0], 'T': 1000},\n        # Case 3: M = 6, K = 3, {mu_i} = {1.0, -1.0, -1.0}, T = 300\n        {'M': 6, 'K': 3, 'mu': [1.0, -1.0, -1.0], 'T': 300},\n        # Case 4: M = 1, K = 4, {mu_i} = {0.0, 0.0, 0.0, 0.0}, T = 500\n        {'M': 1, 'K': 4, 'mu': [0.0, 0.0, 0.0, 0.0], 'T': 500},\n        # Case 5: M = 7, K = 5, {mu_i} = {-0.05, 0.1, 0.0, 0.2, -0.15}, T = 1200\n        {'M': 7, 'K': 5, 'mu': [-0.05, 0.1, 0.0, 0.2, -0.15], 'T': 1200},\n    ]\n\n    def generate_compositions(m, k):\n        \"\"\"\n        Recursively generates all integer compositions of m into k parts.\n        A composition is a tuple (n_1, n_2, ..., n_k) such that sum(n_i) = m.\n        \"\"\"\n        if k == 1:\n            yield (m,)\n            return\n        for i in range(m + 1):\n            for comp in generate_compositions(m - i, k - 1):\n                yield (i,) + comp\n\n    def calculate_entropy(M, K, mu, T):\n        \"\"\"\n        Calculates the configurational entropy S/k_B for a given set of parameters.\n        \"\"\"\n        beta = 1.0 / (k_B * T)\n        mu_np = np.array(mu, dtype=np.float64)\n\n        # Numerically stable calculation of single-site probabilities p_i\n        mu_max = np.max(mu_np)\n        exp_terms = np.exp(beta * (mu_np - mu_max))\n        Z_site = np.sum(exp_terms)\n        p = exp_terms / Z_site\n        \n        # Handle cases where p_i can be zero to avoid log(0)\n        log_p = np.full_like(p, -np.inf)\n        non_zero_mask = p > 0\n        log_p[non_zero_mask] = np.log(p[non_zero_mask])\n\n        compositions = list(generate_compositions(M, K))\n        \n        total_entropy = 0.0\n        log_M_factorial = gammaln(M + 1)\n\n        for comp in compositions:\n            n = np.array(comp, dtype=np.int64)\n            \n            # Calculate log-probability of the composition\n            log_sum_n_factorial = np.sum(gammaln(n + 1))\n            log_p_terms = np.sum(n * log_p)\n            \n            log_P = log_M_factorial - log_sum_n_factorial + log_p_terms\n            \n            # Check for -inf which results from a_i * log(0) where a_i > 0\n            if log_P == -np.inf:\n                continue\n\n            P = np.exp(log_P)\n\n            # The term P * log(P) = 0 if P = 0.\n            if P > 0:\n                total_entropy -= P * log_P\n        \n        return total_entropy\n\n    results = []\n    for case in test_cases:\n        result = calculate_entropy(case['M'], case['K'], case['mu'], case['T'])\n        results.append(f\"{result:.10f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}