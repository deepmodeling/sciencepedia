{
    "hands_on_practices": [
        {
            "introduction": "固定优先级调度是实时系统的基石。在混合关键级环境中，我们必须在两种截然不同的模式下验证其可调度性：所有任务都运行的低关键级模式，以及系统行为改变以保护关键任务的高关键级模式。本练习将指导您完成响应时间分析（Response Time Analysis, RTA），这是一种计算最坏情况时序行为和保证自适应混合关键级（Adaptive Mixed-Criticality, AMC）系统可调度性的基本技术。",
            "id": "4230844",
            "problem": "在一个带有用于安全监控的数字孪生的信息物理系统中，考虑一个由固定优先级抢占式调度在自适应混合关键性 (AMC) 语义下调度的混合关键性工作负载。该系统实现隐式截止时间，因此对于每个任务 $i$，其相对截止时间 $D_i$ 等于其周期 $T_i$。优先级按速率单调顺序分配（周期越短，优先级越高）；当两个任务共享相同的周期时，较高关键性的任务被赋予比低关键性任务更高的优先级。在 AMC 语义下，当所有任务都以其低关键性最坏情况执行时间执行时，系统在低关键性模式（LO 模式）下运行；如果任何高关键性（HI）任务超出了其低关键性预算，系统将转换到高关键性模式（HI 模式），在此模式下，低关键性任务被丢弃（不再执行），而 HI 任务以其高关键性最坏情况执行时间执行。任务的最坏情况响应时间定义为从释放到完成的最大时间，期间可能被更高优先级的任务抢占，并考虑了在响应时间窗口内可以被释放的那些更高优先级任务的所有作业。在 HI 模式下对于 HI 任务，低关键性任务仅可能因为在模式切换前释放的作业而产生干扰；来自低关键性任务的干扰在模式切换后不会持续。\n\n任务集为：\n- 高关键性任务：$\\tau_{H1}$，其 $(C^{LO}, C^{HI}, T) = (2, 4, 10)$，以及 $\\tau_{H2}$，其 $(C^{LO}, C^{HI}, T) = (1, 3, 20)$。\n- 低关键性任务：$\\tau_{L1}$，其 $(C^{LO}, T) = (1, 10)$，以及 $\\tau_{L2}$，其 $(C^{LO}, T) = (2, 20)$。\n\n假设时间单位为毫秒。使用上述语义，并从固定优先级抢占式调度下的最坏情况响应时间的基本定义以及 LO 模式和 HI 模式之间的 AMC 区别出发，确定该任务集在 AMC-FP（自适应混合关键性固定优先级）下是否可调度，并为每个 HI 任务计算其跨两种模式的最大响应时间。报告 $\\tau_{H1}$ 和 $\\tau_{H2}$ 的两个最大响应时间（以毫秒为单位），并报告一个可调度性指标 $s$，如果任务集在 AMC-FP 下可调度，则 $s=1$，否则 $s=0$。将最终输出表示为单个行向量。无需四舍五入；提供精确值。",
            "solution": "该问题要求分析一个混合关键性任务集，以确定其在自适应混合关键性固定优先级 (AMC-FP) 调度策略下的可调度性。我们还必须计算高关键性任务在所有操作模式下的最大响应时间。\n\n首先，我们确定任务的优先级分配。策略是速率单调 (RM)，即周期越短，优先级越高。对于周期相同的任务，关键性较高的任务被分配更高的优先级。任务集为：\n- $\\tau_{H1}$: $(C_{H1}^{LO}, C_{H1}^{HI}, T_{H1}) = (2, 4, 10)$\n- $\\tau_{H2}$: $(C_{H2}^{LO}, C_{H2}^{HI}, T_{H2}) = (1, 3, 20)$\n- $\\tau_{L1}$: $(C_{L1}^{LO}, T_{L1}) = (1, 10)$\n- $\\tau_{L2}$: $(C_{L2}^{LO}, T_{L2}) = (2, 20)$\n\n任务 $\\tau_{H1}$ 和 $\\tau_{L1}$ 具有最短的周期 $T=10$。由于 $\\tau_{H1}$ 是高关键性 (HI) 任务，而 $\\tau_{L1}$ 是低关键性 (LO) 任务，因此 $\\tau_{H1}$ 的优先级高于 $\\tau_{L1}$。\n任务 $\\tau_{H2}$ 和 $\\tau_{L2}$ 具有次短的周期 $T=20$。$\\tau_{H2}$ 是 HI 任务，$\\tau_{L2}$ 是 LO 任务，因此 $\\tau_{H2}$ 的优先级高于 $\\tau_{L2}$。\n比较周期，周期为 $T=10$ 的任务比周期为 $T=20$ 的任务具有更高的优先级。\n因此，从最高到最低的完整优先级顺序是：$\\tau_{H1}  \\tau_{L1}  \\tau_{H2}  \\tau_{L2}$。\n\n一个任务集在 AMC-FP 下可调度，当且仅当满足以下两个条件：\n1. 所有任务在 LO 关键性模式下都是可调度的。这意味着每个任务 $\\tau_i$ 在 LO 模式下的最坏情况响应时间 $R_i^{LO}$ 不得超过其截止时间 $D_i$。由于截止时间是隐式的，$D_i=T_i$。因此，$\\forall i, R_i^{LO} \\le T_i$。\n2. 所有高关键性任务在 HI 关键性模式下都是可调度的。这意味着每个 HI 任务 $\\tau_i$ 在 HI 模式下的最坏情况响应时间 $R_i^{HI}$ 不得超过其截止时间。因此，对于所有 HI 任务 $\\tau_i$，$R_i^{HI} \\le T_i$。\n\n我们使用响应时间分析 (RTA) 来计算最坏情况响应时间。令 $hp(i)$ 表示比任务 $\\tau_i$ 优先级更高的任务集合。\n\n**LO 模式可调度性分析**\n在 LO 模式下，所有任务都以其低关键性最坏情况执行时间 ($C_i^{LO}$) 执行。任务 $\\tau_i$ 的最坏情况响应时间由以下递推关系给出：\n$$R_i^{(k+1)} = C_i^{LO} + \\sum_{j \\in hp(i)} \\left\\lceil \\frac{R_i^{(k)}}{T_j} \\right\\rceil C_j^{LO}$$\n迭代从 $R_i^{(0)} = C_i^{LO}$ 开始，并持续直到 $R_i^{(k+1)} = R_i^{(k)}$。\n\n- **任务 $\\tau_{H1}$：** $hp(H1) = \\emptyset$。\n$R_{H1}^{LO} = C_{H1}^{LO} = 2$。\n检查：$R_{H1}^{LO} = 2 \\le T_{H1} = 10$。可调度。\n\n- **任务 $\\tau_{L1}$：** $hp(L1) = \\{\\tau_{H1}\\}$。\n$R_{L1}^{LO} = C_{L1}^{LO} + \\left\\lceil \\frac{R_{L1}^{LO}}{T_{H1}} \\right\\rceil C_{H1}^{LO} = 1 + \\left\\lceil \\frac{R_{L1}^{LO}}{10} \\right\\rceil 2$。\n$R^{(0)} = 1$。\n$R^{(1)} = 1 + \\left\\lceil \\frac{1}{10} \\right\\rceil 2 = 1 + 1 \\times 2 = 3$。\n$R^{(2)} = 1 + \\left\\lceil \\frac{3}{10} \\right\\rceil 2 = 1 + 1 \\times 2 = 3$。\n$R_{L1}^{LO} = 3$。\n检查：$R_{L1}^{LO} = 3 \\le T_{L1} = 10$。可调度。\n\n- **任务 $\\tau_{H2}$：** $hp(H2) = \\{\\tau_{H1}, \\tau_{L1}\\}$。\n$R_{H2}^{LO} = C_{H2}^{LO} + \\left\\lceil \\frac{R_{H2}^{LO}}{T_{H1}} \\right\\rceil C_{H1}^{LO} + \\left\\lceil \\frac{R_{H2}^{LO}}{T_{L1}} \\right\\rceil C_{L1}^{LO} = 1 + \\left\\lceil \\frac{R_{H2}^{LO}}{10} \\right\\rceil 2 + \\left\\lceil \\frac{R_{H2}^{LO}}{10} \\right\\rceil 1 = 1 + \\left\\lceil \\frac{R_{H2}^{LO}}{10} \\right\\rceil 3$。\n$R^{(0)} = 1$。\n$R^{(1)} = 1 + \\left\\lceil \\frac{1}{10} \\right\\rceil 3 = 1 + 1 \\times 3 = 4$。\n$R^{(2)} = 1 + \\left\\lceil \\frac{4}{10} \\right\\rceil 3 = 1 + 1 \\times 3 = 4$。\n$R_{H2}^{LO} = 4$。\n检查：$R_{H2}^{LO} = 4 \\le T_{H2} = 20$。可调度。\n\n- **任务 $\\tau_{L2}$：** $hp(L2) = \\{\\tau_{H1}, \\tau_{L1}, \\tau_{H2}\\}$。\n$R_{L2}^{LO} = C_{L2}^{LO} + \\left\\lceil \\frac{R_{L2}^{LO}}{T_{H1}} \\right\\rceil C_{H1}^{LO} + \\left\\lceil \\frac{R_{L2}^{LO}}{T_{L1}} \\right\\rceil C_{L1}^{LO} + \\left\\lceil \\frac{R_{L2}^{LO}}{T_{H2}} \\right\\rceil C_{H2}^{LO} = 2 + \\left\\lceil \\frac{R_{L2}^{LO}}{10} \\right\\rceil 2 + \\left\\lceil \\frac{R_{L2}^{LO}}{10} \\right\\rceil 1 + \\left\\lceil \\frac{R_{L2}^{LO}}{20} \\right\\rceil 1 = 2 + \\left\\lceil \\frac{R_{L2}^{LO}}{10} \\right\\rceil 3 + \\left\\lceil \\frac{R_{L2}^{LO}}{20} \\right\\rceil 1$。\n$R^{(0)} = 2$。\n$R^{(1)} = 2 + \\left\\lceil \\frac{2}{10} \\right\\rceil 3 + \\left\\lceil \\frac{2}{20} \\right\\rceil 1 = 2 + 1 \\times 3 + 1 \\times 1 = 6$。\n$R^{(2)} = 2 + \\left\\lceil \\frac{6}{10} \\right\\rceil 3 + \\left\\lceil \\frac{6}{20} \\right\\rceil 1 = 2 + 1 \\times 3 + 1 \\times 1 = 6$。\n$R_{L2}^{LO} = 6$。\n检查：$R_{L2}^{LO} = 6 \\le T_{L2} = 20$。可调度。\n\n所有任务在 LO 模式下均可调度。\n\n**HI 模式可调度性分析**\n在 HI 模式下，LO 任务被丢弃，HI 任务以其高关键性最坏情况执行时间 ($C_i^{HI}$) 执行。HI 任务 $\\tau_i$ 的最坏情况响应时间考虑了来自以其 $C_j^{HI}$ 运行的更高优先级 HI 任务的干扰，以及可能在模式切换前已释放的更高优先级 LO 任务的干扰。标准 RTA 方程为：\n$$R_i^{HI} = C_i^{HI} + \\sum_{j \\in hp(i) \\cap \\text{HI}} \\left\\lceil \\frac{R_i^{HI}}{T_j} \\right\\rceil C_j^{HI} + \\sum_{k \\in hp(i) \\cap \\text{LO}} \\left\\lceil \\frac{R_i^{LO}}{T_k} \\right\\rceil C_k^{LO}$$\n求解该迭代以得到 $R_i^{HI}$。\n\n- **任务 $\\tau_{H1}$：** $hp(H1) = \\emptyset$，因此没有干扰。\n$R_{H1}^{HI} = C_{H1}^{HI} = 4$。\n检查：$R_{H1}^{HI} = 4 \\le T_{H1} = 10$。可调度。\n\n- **任务 $\\tau_{H2}$：** $hp(H2) = \\{\\tau_{H1}, \\tau_{L1}\\}$。更高优先级的 HI 任务集为 $hp(H2) \\cap \\text{HI} = \\{\\tau_{H1}\\}$，更高优先级的 LO 任务集为 $hp(H2) \\cap \\text{LO} = \\{\\tau_{L1}\\}$。\n我们使用先前计算出的值 $R_{H2}^{LO} = 4$。\n$R_{H2}^{HI} = C_{H2}^{HI} + \\left\\lceil \\frac{R_{H2}^{HI}}{T_{H1}} \\right\\rceil C_{H1}^{HI} + \\left\\lceil \\frac{R_{H2}^{LO}}{T_{L1}} \\right\\rceil C_{L1}^{LO} = 3 + \\left\\lceil \\frac{R_{H2}^{HI}}{10} \\right\\rceil 4 + \\left\\lceil \\frac{4}{10} \\right\\rceil 1$。\nLO 任务干扰项为 $\\left\\lceil \\frac{4}{10} \\right\\rceil 1 = 1 \\times 1 = 1$。\n方程简化为 $R_{H2}^{HI} = 3 + 1 + \\left\\lceil \\frac{R_{H2}^{HI}}{10} \\right\\rceil 4 = 4 + \\left\\lceil \\frac{R_{H2}^{HI}}{10} \\right\\rceil 4$。\n我们通过迭代求解，初始猜测值为 $R^{(0)} = C_{H2}^{HI} + \\text{(来自 } \\tau_{L1} \\text{ 的干扰)} = 3+1 = 4$。\n$R^{(0)} = 4$。\n$R^{(1)} = 4 + \\left\\lceil \\frac{4}{10} \\right\\rceil 4 = 4 + 1 \\times 4 = 8$。\n$R^{(2)} = 4 + \\left\\lceil \\frac{8}{10} \\right\\rceil 4 = 4 + 1 \\times 4 = 8$。\n$R_{H2}^{HI} = 8$。\n检查：$R_{H2}^{HI} = 8 \\le T_{H2} = 20$。可调度。\n\n两个高关键性任务在 HI 模式下均可调度。\n\n**关于可调度性和最终值的结论**\n由于所有任务在 LO 模式下均可调度，且所有 HI 任务在 HI 模式下也均可调度，因此整个任务集在 AMC-FP 下是可调度的。因此，可调度性指标 $s=1$。\n\n每个 HI 任务的最大响应时间是其在两种模式下响应时间的最大值。\n- 对于 $\\tau_{H1}$：$R_{H1}^{max} = \\max(R_{H1}^{LO}, R_{H1}^{HI}) = \\max(2, 4) = 4$。\n- 对于 $\\tau_{H2}$：$R_{H2}^{max} = \\max(R_{H2}^{LO}, R_{H2}^{HI}) = \\max(4, 8) = 8$。\n\n需要报告的最终结果是 $\\tau_{H1}$ 和 $\\tau_{H2}$ 的最大响应时间以及可调度性指标 $s$。这些值分别为 $4$ 毫秒、$8$ 毫秒和 $1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  8  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从固定优先级转向动态优先级调度，例如使用虚拟截止时间的 EDF (EDF-VD)，可以提供更高的可调度利用率。EDF-VD 通过创建“虚拟截止时间”来管理需求，但其有效性受到与跨模式任务利用率相关的基本限制的约束。本练习要求您推导并应用 EDF-VD 的核心可行性条件，从而深入理解一个系统何时是根本上可调度的，以及何时无论如何选择调度参数都无法实现调度。",
            "id": "4230834",
            "problem": "一个信息物理系统的数字孪生必须使用虚拟截止时间的最早截止时间优先（EDF-VD）算法，在单个单位速度处理器上共同调度一个双临界性工作负载。低临界性（LO）工作负载模拟数字孪生中的估计器和异常检测器，而高临界性（HI）工作负载模拟安全关键型控制器。设聚合利用率定义如下：$U_{L}^{LO}$ 是所有 LO 任务在其 LO 最坏情况执行时间下的利用率之和，$U_{H}^{LO}$ 是所有 HI 任务在其 LO 最坏情况执行时间下的利用率之和，而 $U_{H}^{HI}$ 是所有 HI 任务在其 HI 最坏情况执行时间下的利用率之和。在EDF-VD下，HI 任务在 LO 模式下的截止时间按因子 $x \\in (0,1]$ 进行缩放（其虚拟截止时间是其实际截止时间的 $x$ 倍），而 LO 任务则保留其实际截止时间。模式切换后，LO 任务被丢弃，HI 任务以其实际截止时间和 HI 最坏情况执行时间执行。\n\n从隐式截止时间任务集的基本EDF可调度性原理——即总利用率至多为 $1$ 的任务集在单位速度处理器上是可调度的——以及截止时间缩放的处理器需求解释（截止时间按因子 $x$ 压缩会将有效利用率扩大 $1/x$ 倍）出发，推导 $x$ 必须满足的必要可行性条件，以确保 LO 模式下的可调度性，并确保在最坏情况的模式切换时，剩余的 HI 工作负载能在每个作业的实际截止时间前完成。然后，对于给定的聚合利用率 $U_{L}^{LO} = 0.35$，$U_{H}^{LO} = 0.25$ 和 $U_{H}^{HI} = 0.9$，确定满足这些 EDF-VD 可行性条件的所有 $x \\in (0,1]$ 组成的集合的勒贝格测度。将最终答案表示为一个不带单位的实数。",
            "solution": "该问题要求推导在使用最早截止时间优先与虚拟截止时间（EDF-VD）调度的双临界性系统中，截止时间缩放因子 $x$ 的可行性条件。随后，对于一组给定的聚合利用率，我们必须确定在区间 $(0,1]$ 内所有有效 $x$ 组成的集合的勒贝格测度。\n\n首先，我们推导 $x$ 的必要可行性条件。该系统由在单个单位速度处理器上运行的低临界性（LO）任务和高临界性（HI）任务组成。聚合利用率给定为 $U_{L}^{LO}$，$U_{H}^{LO}$ 和 $U_{H}^{HI}$。\n\n条件1：LO临界模式下的可调度性。\n在 LO 模式下，所有任务都处于活动状态。LO 任务以其指定的 LO 最坏情况执行时间（WCET）执行，贡献的总利用率为 $U_{L}^{LO}$。HI 任务也以其 LO-WCET 执行，贡献的基础利用率为 $U_{H}^{LO}$。然而，在 EDF-VD 下，HI 任务的截止时间按因子 $x \\in (0,1]$ 进行缩放。如问题所述，这种按因子 $x$ 的截止时间压缩会将有效处理器利用率需求扩大 $1/x$ 倍。因此，HI 任务在 LO 模式下的有效利用率为 $\\frac{U_{H}^{LO}}{x}$。\n\n为了使整个任务集在 EDF 下可调度，总利用率不能超过处理器容量，对于单位速度处理器，该容量为 $1$。\n$$U_{L}^{LO} + \\frac{U_{H}^{LO}}{x} \\le 1$$\n由于 $x  0$，我们可以重排这个不等式来找到 $x$ 的一个下界。\n$$\\frac{U_{H}^{LO}}{x} \\le 1 - U_{L}^{LO}$$\n$$x \\ge \\frac{U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n这个不等式提供了第一个条件，即缩放因子 $x$ 的下界。我们将其记为 $x_{min}$。\n$$x_{min} = \\frac{U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n\n条件2：在向 HI 临界模式切换期间及之后的可调度性。\n如果一个 HI 任务超出了其 LO-WCET，就会发生模式切换。此时，所有 LO 任务被丢弃，而 HI 任务被允许执行至其 HI-WCET，同时仍需满足其原始的、未缩放的截止时间。我们必须确保系统在这种转换过程中保持可调度。这要求有足够的处理器容量来容纳 HI 任务带来的额外工作负载，即其 HI 模式利用率 ($U_{H}^{HI}$) 与其 LO 模式利用率 ($U_{H}^{LO}$) 之差。\n\n对于隐式截止时间任务，在EDF-VD下转换的可调度性的标准充分条件建立了HI模式超额需求与调度策略提供的容量之间的关系。通过在虚拟截止时间（实际截止时间的 $x$ 倍）内完成HI任务，在每个实际截止时间 $D_i$ 之前，实际上保留了一个长度为 $(1-x)D_i$ 的时间间隔。这个分布在时间轴上的“裕量”为处理超额运行提供了容量。在切换之前，可用于HI任务的处理器容量已经受到LO任务存在的限制，相当于总容量的 $1 - U_{L}^{LO}$ 部分。基于供需边界函数的严格推导表明，HI任务的超额利用率需求 $U_{H}^{HI} - U_{H}^{LO}$ 必须能由处理器容量部分 $1 - U_{L}^{LO}$ 服务，该容量部分再乘以时间裕量因子 $1-x$。得到的不等式是：\n$$(1-x)(1 - U_{L}^{LO}) \\ge U_{H}^{HI} - U_{H}^{LO}$$\n假设 $U_{H}^{HI}  U_{H}^{LO}$，我们必须有 $x  1$。我们可以重排这个不等式来找到 $x$ 的一个上界。\n$$1-x \\ge \\frac{U_{H}^{HI} - U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n$$x \\le 1 - \\frac{U_{H}^{HI} - U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n这个不等式提供了第二个条件，即 $x$ 的上界。我们将其记为 $x_{max}$。\n$$x_{max} = 1 - \\frac{U_{H}^{HI} - U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n\n为了存在一个有效的缩放因子 $x$，我们必须有 $x_{min} \\le x_{max}$。这意味着：\n$$\\frac{U_{H}^{LO}}{1 - U_{L}^{LO}} \\le 1 - \\frac{U_{H}^{HI} - U_{H}^{LO}}{1 - U_{L}^{LO}}$$\n两边乘以 $1 - U_{L}^{LO}$（对于一个非平凡系统，该值必须为正，我们的数据满足此条件）：\n$$U_{H}^{LO} \\le (1 - U_{L}^{LO}) - (U_{H}^{HI} - U_{H}^{LO})$$\n$$U_{H}^{LO} \\le 1 - U_{L}^{LO} - U_{H}^{HI} + U_{H}^{LO}$$\n$$0 \\le 1 - U_{L}^{LO} - U_{H}^{HI}$$\n$$U_{L}^{LO} + U_{H}^{HI} \\le 1$$\n这是系统在 EDF-VD 下可调度的一个基本条件。\n\n现在，我们应用问题中提供的具体聚合利用率：$U_{L}^{LO} = 0.35$，$U_{H}^{LO} = 0.25$ 和 $U_{H}^{HI} = 0.9$。\n让我们首先检查基本可行性条件：\n$$U_{L}^{LO} + U_{H}^{HI} = 0.35 + 0.9 = 1.25$$\n由于 $1.25  1$，存在有效 $x$ 的必要条件未被满足。这意味着有效缩放因子的集合是空的。为了证实这一点，我们将计算 $x_{min}$ 和 $x_{max}$。\n\n计算 $x$ 的下界：\n$$x_{min} = \\frac{U_{H}^{LO}}{1 - U_{L}^{LO}} = \\frac{0.25}{1 - 0.35} = \\frac{0.25}{0.65} = \\frac{25}{65} = \\frac{5}{13}$$\n\n计算 $x$ 的上界：\n$$x_{max} = 1 - \\frac{U_{H}^{HI} - U_{H}^{LO}}{1 - U_{L}^{LO}} = 1 - \\frac{0.9 - 0.25}{1 - 0.35} = 1 - \\frac{0.65}{0.65} = 1 - 1 = 0$$\n\n推导出的可行性条件要求 $x$ 属于区间 $[x_{min}, x_{max}]$，所以我们必须有：\n$$\\frac{5}{13} \\le x \\le 0$$\n问题陈述 $x \\in (0, 1]$。所有满足可行性条件的 $x$ 的集合是区间 $[\\frac{5}{13}, 0]$ 和区间 $(0, 1]$ 的交集。\n由于 $\\frac{5}{13}  0$，区间 $[\\frac{5}{13}, 0]$ 是空集，记为 $\\emptyset$。\n空集与任何其他集合的交集是空集。\n$$S = \\left[\\frac{5}{13}, 0\\right] \\cap (0, 1] = \\emptyset$$\n问题要求计算这个集合 $S$ 的勒贝格测度。实线上的勒贝格测度推广了长度的概念。根据定义，空集的测度为 $0$。\n\n因此，对于给定的系统参数，不存在可以保证可调度性的缩放因子 $x$ 的值，有效 $x$ 集合的勒贝格测度为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在分析了具有给定优先级分配的系统之后，一个自然的进阶问题是如何首先得出一个有效的分配方案。对于混合关键级任务集，像速率单调这样的简单启发式方法可能并非最优。Audsley 算法通过从最低优先级开始迭代检查可调度性，为分配固定优先级提供了一种系统化且最优的方法。本练习将引导您从分析转向综合设计，掌握一种设计可调度固定优先级系统的算法方法，这是构建稳健实时系统的一项关键技能。",
            "id": "4230842",
            "problem": "考虑一个单处理器、完全抢占式、固定优先级调度问题，该问题基于零星任务模型且任务截止期受限，其中每个任务的相对截止期等于其最小到达间隔时间。该系统为混合关键级系统，具有两个关键级别（低和高）。在低关键级操作模式下，所有任务必须使用其低关键级最坏情况执行时间来满足截止期，而在切换到高关键级操作模式后，只有高关键级任务必须继续使用其高关键级最坏情况执行时间来满足截止期，低关键级任务可能会被丢弃。假设没有释放抖动，并且同步释放是最坏情况。\n\n给定四个零星任务 $\\tau_1, \\tau_2, \\tau_3, \\tau_4$，其参数如下。对于每个任务 $\\tau_i$，$T_i$ 表示最小到达间隔时间（也等于相对截止期 $D_i$），$C_i^{\\mathrm{LO}}$ 表示低关键级最坏情况执行时间，$C_i^{\\mathrm{HI}}$ 表示高关键级最坏情况执行时间（仅为高关键级任务定义）。任务的关键级别在括号中注明。\n\n- $\\tau_1$（高关键级）：$T_1 = D_1 = 40$，$C_1^{\\mathrm{LO}} = 4$，$C_1^{\\mathrm{HI}} = 8$。\n- $\\tau_2$（高关键级）：$T_2 = D_2 = 25$，$C_2^{\\mathrm{LO}} = 5$，$C_2^{\\mathrm{HI}} = 9$。\n- $\\tau_3$（低关键级）：$T_3 = D_3 = 20$，$C_3^{\\mathrm{LO}} = 3$。\n- $\\tau_4$（低关键级）：$T_4 = D_4 = 10$，$C_4^{\\mathrm{LO}} = 2$。\n\n使用适用于混合关键级设置（具有两种操作模式）的 Audsley 算法进行固定优先级分配，确定一个有效的固定优先级顺序，具体规则如下：\n\n- 在每一步中，从未被分配优先级的任务中，找出一个可以被赋予剩余任务中最低优先级的任务，使得在低关键级模式下，当所有其他剩余任务都被假定为具有更高优先级时，该任务能够满足其截止期；并且，如果候选任务是高关键级的，那么它还必须在高关键级模式下满足其截止期，此时假定只有高关键级任务在执行（低关键级任务可能仅在模式切换时根据标准的高级混合关键级（AMC）语义产生影响）。低关键级任务无需在高关键级模式下可调度。\n- 如果在任何步骤中有多个任务可作为最低优先级，则选择索引 $i$ 最小的任务来打破平局。\n\n使用以下规则，将最终从高到低的固定优先级顺序编码为一个整数 $E$。如果从高到低的最终顺序是 $(\\tau_{i_1}, \\tau_{i_2}, \\tau_{i_3}, \\tau_{i_4})$，定义\n$$\nE \\;=\\; 1000\\, i_1 \\;+\\; 100\\, i_2 \\;+\\; 10\\, i_3 \\;+\\; i_4.\n$$\n\n计算 $E$。以单个整数形式提供最终答案。无需四舍五入。",
            "solution": "我们从零星任务的固定优先级响应时间分析的基本原理开始。在单处理器上的固定优先级抢占式调度下，给定优先级水平的任务 $\\tau_i$ 的最坏情况响应时间 $R_i$ 是以下递推式的最小不动点\n$$\nR_i \\;=\\; C_i \\;+\\; \\sum_{\\tau_j \\in \\mathrm{hp}(i)} \\left\\lceil \\frac{R_i}{T_j} \\right\\rceil C_j,\n$$\n其中 $\\mathrm{hp}(i)$ 表示比 $\\tau_i$ 优先级严格更高的任务集合，$C_i$ 是所考虑的操作模式下使用的最坏情况执行时间，而每一项 $\\left\\lceil \\frac{R_i}{T_j} \\right\\rceil C_j$ 是在长度为 $R_i$ 的区间内来自任务 $\\tau_j$ 的干扰的上限。如果 $R_i \\leq D_i$，则任务 $\\tau_i$ 被认为是可调度的。\n\n根据高级混合关键级（AMC）语义，在双模式混合关键级设置中，低关键级（LO）模式要求每个任务 $\\tau_i$ 在使用 $C_i^{\\mathrm{LO}}$ 时是可调度的，其中来自所有更高优先级任务的干扰也使用其 $C_j^{\\mathrm{LO}}$。在高关键级（HI）模式下，只有高关键级任务必须保持可调度。高关键级任务 $\\tau_i$ 在 HI 模式下的一个保守响应时间界限由 AMC 响应时间界限（AMC-rtb）给出，它考虑了（i）在整个 HI 模式响应区间 $R_i^{\\mathrm{HI}}$ 内，来自更高优先级高关键级任务使用其 $C_j^{\\mathrm{HI}}$ 所产生的干扰，以及（ii）由于更高优先级低关键级任务在 $R_i^{\\mathrm{LO}}$ 时间内可能产生的带入干扰。具体来说，我们应用的界限是：\n- 任何任务 $\\tau_i$ 的低模式：\n$$\nR_i^{\\mathrm{LO}} \\;=\\; C_i^{\\mathrm{LO}} \\;+\\; \\sum_{\\tau_j \\in \\mathrm{hp}(i)} \\left\\lceil \\frac{R_i^{\\mathrm{LO}}}{T_j} \\right\\rceil C_j^{\\mathrm{LO}}.\n$$\n- 高关键级任务 $\\tau_i$ 的高模式：\n$$\nR_i^{\\mathrm{HI}} \\;=\\; C_i^{\\mathrm{HI}} \\;+\\; \\sum_{\\tau_j \\in \\mathrm{hp}_H(i)} \\left\\lceil \\frac{R_i^{\\mathrm{HI}}}{T_j} \\right\\rceil C_j^{\\mathrm{HI}} \\;+\\; \\sum_{\\tau_k \\in \\mathrm{hp}_L(i)} \\left\\lceil \\frac{R_i^{\\mathrm{LO}}}{T_k} \\right\\rceil C_k^{\\mathrm{LO}},\n$$\n其中 $\\mathrm{hp}_H(i)$ 和 $\\mathrm{hp}_L(i)$ 分别表示相对于 $\\tau_i$ 的更高优先级的高关键级和低关键级任务。\n\nAudsley 算法通过迭代地在每一步中使用上述可调度性检查，选择一个可以安全地置于剩余任务中最低优先级的任务，从而从最低到最高分配优先级。如果在任何迭代中有一个以上的任务满足条件，我们根据问题中的平局打破规则，选择索引最小的任务。\n\n我们按步骤进行。\n\n步骤 1：确定在所有四个任务 $\\{\\tau_1,\\tau_2,\\tau_3,\\tau_4\\}$ 中，哪个任务可以被分配最低优先级。\n\n- 候选者 $\\tau_4$（低关键级）作为最低优先级：\n低模式，$\\mathrm{hp}(4)=\\{\\tau_1,\\tau_2,\\tau_3\\}$：\n迭代 $w^{(0)}=C_4^{\\mathrm{LO}}=2$，\n$$\nw^{(1)} \\;=\\; 2 \\;+\\; \\left\\lceil \\frac{w^{(0)}}{T_1} \\right\\rceil 4 \\;+\\; \\left\\lceil \\frac{w^{(0)}}{T_2} \\right\\rceil 5 \\;+\\; \\left\\lceil \\frac{w^{(0)}}{T_3} \\right\\rceil 3 \\;=\\; 2 \\;+\\; 1\\cdot 4 \\;+\\; 1\\cdot 5 \\;+\\; 1\\cdot 3 \\;=\\; 14.\n$$\n再次使用 $w^{(1)}=14$ 检查：$\\left\\lceil \\frac{14}{40} \\right\\rceil = 1$，$\\left\\lceil \\frac{14}{25} \\right\\rceil = 1$，$\\left\\lceil \\frac{14}{20} \\right\\rceil = 1$，因此 $w^{(2)}=14$。于是 $R_4^{\\mathrm{LO}}=14$。由于 $D_4=10$，我们有 $R_4^{\\mathrm{LO}}  D_4$，所以 $\\tau_4$ 不能是最低优先级。\n\n- 候选者 $\\tau_3$（低关键级）作为最低优先级：\n低模式，$\\mathrm{hp}(3)=\\{\\tau_1,\\tau_2,\\tau_4\\}$：\n从 $w^{(0)}=3$ 开始，\n$$\nw^{(1)} \\;=\\; 3 \\;+\\; \\left\\lceil \\frac{3}{40} \\right\\rceil 4 \\;+\\; \\left\\lceil \\frac{3}{25} \\right\\rceil 5 \\;+\\; \\left\\lceil \\frac{3}{10} \\right\\rceil 2 \\;=\\; 3 \\;+\\; 4 \\;+\\; 5 \\;+\\; 2 \\;=\\; 14.\n$$\n使用 $w^{(1)}=14$，我们得到 $\\left\\lceil \\frac{14}{40} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{25} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{10} \\right\\rceil=2$，所以\n$$\nw^{(2)} \\;=\\; 3 \\;+\\; 4 \\;+\\; 5 \\;+\\; 2\\cdot 2 \\;=\\; 16.\n$$\n使用 $w^{(2)}=16$ 重新评估：$\\left\\lceil \\frac{16}{40} \\right\\rceil=1$，$\\left\\lceil \\frac{16}{25} \\right\\rceil=1$，$\\left\\lceil \\frac{16}{10} \\right\\rceil=2$，因此 $w^{(3)}=16$ 是一个不动点。因此 $R_3^{\\mathrm{LO}}=16 \\leq D_3=20$。由于 $\\tau_3$ 是低关键级任务，无需进行高模式检查。因此 $\\tau_3$ 作为最低优先级是可行的。\n\n- 候选者 $\\tau_1$（高关键级）作为最低优先级：\n低模式，$\\mathrm{hp}(1)=\\{\\tau_2,\\tau_3,\\tau_4\\}$：\n从 $w^{(0)}=4$ 开始，\n$$\nw^{(1)} \\;=\\; 4 \\;+\\; \\left\\lceil \\frac{4}{25} \\right\\rceil 5 \\;+\\; \\left\\lceil \\frac{4}{20} \\right\\rceil 3 \\;+\\; \\left\\lceil \\frac{4}{10} \\right\\rceil 2 \\;=\\; 4 \\;+\\; 5 \\;+\\; 3 \\;+\\; 2 \\;=\\; 14.\n$$\n使用 $w^{(1)}=14$：$\\left\\lceil \\frac{14}{25} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{20} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{10} \\right\\rceil=2$，所以\n$$\nw^{(2)} \\;=\\; 4 \\;+\\; 5 \\;+\\; 3 \\;+\\; 2\\cdot 2 \\;=\\; 16.\n$$\n使用 $w^{(2)}=16$，取整结果不变，因此 $R_1^{\\mathrm{LO}}=16 \\leq D_1=40$。\n\n$\\tau_1$ 的高模式（AMC-rtb），其中 $\\mathrm{hp}_H(1)=\\{\\tau_2\\}$ 且 $\\mathrm{hp}_L(1)=\\{\\tau_3,\\tau_4\\}$。首先使用 $R_1^{\\mathrm{LO}}=16$ 计算低模式带入项：\n$$\n\\left\\lceil \\frac{R_1^{\\mathrm{LO}}}{T_3} \\right\\rceil C_3^{\\mathrm{LO}} \\;=\\; \\left\\lceil \\frac{16}{20} \\right\\rceil \\cdot 3 \\;=\\; 1\\cdot 3 \\;=\\; 3, \\qquad\n\\left\\lceil \\frac{R_1^{\\mathrm{LO}}}{T_4} \\right\\rceil C_4^{\\mathrm{LO}} \\;=\\; \\left\\lceil \\frac{16}{10} \\right\\rceil \\cdot 2 \\;=\\; 2\\cdot 2 \\;=\\; 4.\n$$\n因此，总的低关键级带入干扰是 $3+4=7$。现在迭代 $R_1^{\\mathrm{HI}}$：\n从 $w^{(0)} = C_1^{\\mathrm{HI}} + 7 = 8 + 7 = 15$ 开始，\n$$\nw^{(1)} \\;=\\; 8 \\;+\\; \\left\\lceil \\frac{w^{(0)}}{T_2} \\right\\rceil 9 \\;+\\; 7 \\;=\\; 8 \\;+\\; 1\\cdot 9 \\;+\\; 7 \\;=\\; 24.\n$$\n使用 $w^{(1)}=24$，$\\left\\lceil \\frac{24}{25} \\right\\rceil=1$，因此 $w^{(2)}=24$ 是一个不动点。因此 $R_1^{\\mathrm{HI}}=24 \\leq D_1=40$。因此 $\\tau_1$ 作为最低优先级是可行的。\n\n- 候选者 $\\tau_2$（高关键级）作为最低优先级：\n低模式，$\\mathrm{hp}(2)=\\{\\tau_1,\\tau_3,\\tau_4\\}$：\n从 $w^{(0)}=5$ 开始，\n$$\nw^{(1)} \\;=\\; 5 \\;+\\; \\left\\lceil \\frac{5}{40} \\right\\rceil 4 \\;+\\; \\left\\lceil \\frac{5}{20} \\right\\rceil 3 \\;+\\; \\left\\lceil \\frac{5}{10} \\right\\rceil 2 \\;=\\; 5 \\;+\\; 4 \\;+\\; 3 \\;+\\; 2 \\;=\\; 14.\n$$\n使用 $w^{(1)}=14$：$\\left\\lceil \\frac{14}{40} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{20} \\right\\rceil=1$，$\\left\\lceil \\frac{14}{10} \\right\\rceil=2$，所以\n$$\nw^{(2)} \\;=\\; 5 \\;+\\; 4 \\;+\\; 3 \\;+\\; 2\\cdot 2 \\;=\\; 16,\n$$\n这是一个不动点，有 $R_2^{\\mathrm{LO}}=16 \\leq D_2=25$。\n\n$\\tau_2$ 的高模式（AMC-rtb），其中 $\\mathrm{hp}_H(2)=\\{\\tau_1\\}$ 且 $\\mathrm{hp}_L(2)=\\{\\tau_3,\\tau_4\\}$：\n使用 $R_2^{\\mathrm{LO}}=16$ 的低模式带入干扰：\n$$\n\\left\\lceil \\frac{16}{20} \\right\\rceil \\cdot 3 \\;=\\; 3, \\qquad \\left\\lceil \\frac{16}{10} \\right\\rceil \\cdot 2 \\;=\\; 4,\n$$\n总和 $=7$。因此 $R_2^{\\mathrm{HI}}$ 的迭代方程为：\n$$ R_2^{\\mathrm{HI}} = C_2^{\\mathrm{HI}} + \\left\\lceil \\frac{R_2^{\\mathrm{HI}}}{T_1} \\right\\rceil C_1^{\\mathrm{HI}} + 7 = 9 + \\left\\lceil \\frac{R_2^{\\mathrm{HI}}}{40} \\right\\rceil 8 + 7 = 16 + \\left\\lceil \\frac{R_2^{\\mathrm{HI}}}{40} \\right\\rceil 8. $$\n从 $w^{(0)}=16$ 开始，我们得到 $w^{(1)} = 16 + \\lceil 16/40 \\rceil 8 = 16+8=24$。再次迭代，$w^{(2)} = 16 + \\lceil 24/40 \\rceil 8 = 24$。因此 $R_2^{\\mathrm{HI}}=24 \\leq D_2=25$。因此 $\\tau_2$ 作为最低优先级是可行的。\n\n步骤 1 结论：可行的最低优先级候选者是 $\\tau_1$、$\\tau_2$ 和 $\\tau_3$；$\\tau_4$ 不可行。根据平局打破规则（最小索引），选择 $\\tau_1$ 作为所有四个任务中的最低优先级。\n\n步骤 2：移除 $\\tau_1$ 并确定剩余任务 $\\{\\tau_2,\\tau_3,\\tau_4\\}$ 中的最低优先级。\n\n- 候选者 $\\tau_4$（低关键级）作为最低优先级，$\\mathrm{hp}(4)=\\{\\tau_2,\\tau_3\\}$：\n低模式：\n从 $w^{(0)}=2$ 开始，\n$$\nw^{(1)} \\;=\\; 2 \\;+\\; \\left\\lceil \\frac{2}{25} \\right\\rceil 5 \\;+\\; \\left\\lceil \\frac{2}{20} \\right\\rceil 3 \\;=\\; 2 \\;+\\; 5 \\;+\\; 3 \\;=\\; 10.\n$$\n使用 $w^{(1)}=10$：$\\left\\lceil \\frac{10}{25} \\right\\rceil=1$，$\\left\\lceil \\frac{10}{20} \\right\\rceil=1$，所以 $w^{(2)}=10$，因此 $R_4^{\\mathrm{LO}}=10 \\leq D_4=10$。可行。\n\n- 候选者 $\\tau_3$（低关键级）作为最低优先级，$\\mathrm{hp}(3)=\\{\\tau_2,\\tau_4\\}$：\n低模式：\n从 $w^{(0)}=3$ 开始，\n$$\nw^{(1)} \\;=\\; 3 \\;+\\; \\left\\lceil \\frac{3}{25} \\right\\rceil 5 \\;+\\; \\left\\lceil \\frac{3}{10} \\right\\rceil 2 \\;=\\; 3 \\;+\\; 5 \\;+\\; 2 \\;=\\; 10,\n$$\n这是一个不动点，有 $R_3^{\\mathrm{LO}}=10 \\leq D_3=20$。可行。\n\n- 候选者 $\\tau_2$（高关键级）作为最低优先级，$\\mathrm{hp}(2)=\\{\\tau_3,\\tau_4\\}$：\n低模式：\n从 $w^{(0)}=5$ 开始，\n$$\nw^{(1)} \\;=\\; 5 \\;+\\; \\left\\lceil \\frac{5}{20} \\right\\rceil 3 \\;+\\; \\left\\lceil \\frac{5}{10} \\right\\rceil 2 \\;=\\; 5 \\;+\\; 3 \\;+\\; 2 \\;=\\; 10,\n$$\n因此 $R_2^{\\mathrm{LO}}=10 \\leq 25$。高模式（AMC-rtb），其中 $\\mathrm{hp}_H(2)=\\{\\}$ 且 $\\mathrm{hp}_L(2)=\\{\\tau_3,\\tau_4\\}$：\n使用 $R_2^{\\mathrm{LO}}=10$ 的低模式带入干扰：\n$$\n\\left\\lceil \\frac{10}{20} \\right\\rceil \\cdot 3 \\;=\\; 3, \\qquad \\left\\lceil \\frac{10}{10} \\right\\rceil \\cdot 2 \\;=\\; 2,\n$$\n总和 $=5$。因此\n$$\nR_2^{\\mathrm{HI}} \\;=\\; C_2^{\\mathrm{HI}} \\;+\\; 5 \\;=\\; 9 \\;+\\; 5 \\;=\\; 14 \\;\\leq\\; D_2=25.\n$$\n可行。\n\n步骤 2 结论：所有三个候选者都可行；根据平局打破规则，选择 $\\tau_2$ 作为次低优先级。现在最低的两个优先级从下到上是：$\\tau_1$（最低），$\\tau_2$。\n\n步骤 3：移除 $\\tau_2$；剩余任务是 $\\{\\tau_3,\\tau_4\\}$。\n\n- 候选者 $\\tau_4$（低关键级）作为最低优先级，$\\mathrm{hp}(4)=\\{\\tau_3\\}$：\n低模式：\n从 $w^{(0)}=2$ 开始，\n$$\nw^{(1)} \\;=\\; 2 \\;+\\; \\left\\lceil \\frac{2}{20} \\right\\rceil 3 \\;=\\; 2 \\;+\\; 3 \\;=\\; 5,\n$$\n且使用 $w^{(1)}=5$，$\\left\\lceil \\frac{5}{20} \\right\\rceil=1$，所以 $R_4^{\\mathrm{LO}}=5 \\leq 10$。可行。\n\n- 候选者 $\\tau_3$（低关键级）作为最低优先级，$\\mathrm{hp}(3)=\\{\\tau_4\\}$：\n低模式：\n从 $w^{(0)}=3$ 开始，\n$$\nw^{(1)} \\;=\\; 3 \\;+\\; \\left\\lceil \\frac{3}{10} \\right\\rceil 2 \\;=\\; 3 \\;+\\; 2 \\;=\\; 5,\n$$\n且使用 $w^{(1)}=5$，$\\left\\lceil \\frac{5}{10} \\right\\rceil=1$，所以 $R_3^{\\mathrm{LO}}=5 \\leq 20$。可行。\n\n步骤 3 结论：两个候选者都可行；根据平局打破规则，选择 $\\tau_3$ 作为次低优先级。剩余未分配的任务是 $\\tau_4$，因此它获得最高优先级。\n\n最终从高到低的固定优先级顺序是 $(\\tau_4, \\tau_3, \\tau_2, \\tau_1)$。\n\n根据编码规则，当 $(i_1,i_2,i_3,i_4)=(4,3,2,1)$ 时，我们得到\n$$\nE \\;=\\; 1000\\cdot 4 \\;+\\; 100\\cdot 3 \\;+\\; 10\\cdot 2 \\;+\\; 1 \\;=\\; 4321.\n$$\n因此，所要求的编码后的优先级分配整数是 $4321$。",
            "answer": "$$\\boxed{4321}$$"
        }
    ]
}