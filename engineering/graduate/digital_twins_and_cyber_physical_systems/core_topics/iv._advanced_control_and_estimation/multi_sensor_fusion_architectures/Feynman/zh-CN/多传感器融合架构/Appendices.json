{
    "hands_on_practices": [
        {
            "introduction": "许多先进的多传感器融合算法，其核心都源于一个优雅的贝叶斯统计原理。本练习将通过一个基础场景，即融合两个独立高斯传感器的测量值，来揭示这一核心思想。通过从第一性原理推导，您将亲手验证融合后的最优估计是如何通过精度（方差的倒数）进行加权平均的，这为理解更复杂滤波器中信息如何整合提供了关键的直觉。",
            "id": "4233215",
            "problem": "一个信息物理系统（CPS）的数字孪生（DT）使用一个中心化的多传感器融合架构来监测一个未被观测的标量状态 $x$（电池模块的内部核心温度），该架构聚合了一个物理温度传感器和一个基于软件的观测器。在一个固定的时间瞬间，以 $x$ 为条件的测量模型是独立的，并由以下高斯似然描述：物理传感器产生 $y_1$，其中 $y_1 \\mid x \\sim \\mathcal{N}(x,\\sigma_1^2)$；DT观测器产生 $y_2$，其中 $y_2 \\mid x \\sim \\mathcal{N}(x,\\sigma_2^2)$。假设在感兴趣的范围内，先验为无信息平坦先验 $p(x) \\propto 1$，并且给定 $x$ 时，$y_1$ 和 $y_2$ 条件独立。从贝叶斯法则和高斯似然的定义出发，通过配方法推导出后验密度 $p(x \\mid y_1,y_2)$，并在平坦先验下，将后验均值确定为 $x$ 的最小均方误差估计量。\n\n在某个特定时间瞬间，测量值和已知噪声水平如下：\n- $y_1 = 335.6$ K，其中 $\\sigma_1 = 0.4$ K，\n- $y_2 = 336.9$ K，其中 $\\sigma_2 = 0.9$ K。\n\n计算 $x$ 的融合后验均值估计值（以开尔文为单位）。最终数值答案以 K 为单位表示，并四舍五入到四位有效数字。",
            "solution": "目标是针对给定两个独立测量值 $y_1$ 和 $y_2$ 的未观测状态 $x$，推导出后验概率密度函数 $p(x \\mid y_1, y_2)$，然后计算后验均值。\n\n根据贝叶斯法则，后验分布正比于似然和先验分布的乘积：\n$$\np(x \\mid y_1, y_2) \\propto p(y_1, y_2 \\mid x) p(x)\n$$\n问题陈述了测量值 $y_1$ 和 $y_2$ 在给定状态 $x$ 的情况下是条件独立的。因此，联合似然 $p(y_1, y_2 \\mid x)$ 可以分解为各个似然的乘积：\n$$\np(y_1, y_2 \\mid x) = p(y_1 \\mid x) p(y_2 \\mid x)\n$$\n$x$ 的先验分布被给定为无信息平坦先验，$p(x) \\propto 1$。将这些代入贝叶斯法则表达式中，得到：\n$$\np(x \\mid y_1, y_2) \\propto p(y_1 \\mid x) p(y_2 \\mid x)\n$$\n似然被给定为高斯分布：\n$y_1 \\mid x \\sim \\mathcal{N}(x, \\sigma_1^2)$，所以其概率密度函数 (PDF) 为\n$$\np(y_1 \\mid x) = \\frac{1}{\\sqrt{2\\pi\\sigma_1^2}} \\exp\\left( -\\frac{(y_1 - x)^2}{2\\sigma_1^2} \\right)\n$$\n且 $y_2 \\mid x \\sim \\mathcal{N}(x, \\sigma_2^2)$，所以其 PDF 为\n$$\np(y_2 \\mid x) = \\frac{1}{\\sqrt{2\\pi\\sigma_2^2}} \\exp\\left( -\\frac{(y_2 - x)^2}{2\\sigma_2^2} \\right)\n$$\n后验分布正比于这两个函数的乘积。因为我们处理的是比例关系，所以可以忽略归一化常数：\n$$\np(x \\mid y_1, y_2) \\propto \\exp\\left( -\\frac{(x - y_1)^2}{2\\sigma_1^2} \\right) \\exp\\left( -\\frac{(x - y_2)^2}{2\\sigma_2^2} \\right)\n$$\n合并指数项：\n$$\np(x \\mid y_1, y_2) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(x - y_1)^2}{\\sigma_1^2} + \\frac{(x - y_2)^2}{\\sigma_2^2} \\right] \\right)\n$$\n为了确定该分布的形式，我们分析指数的参数，记为 $L(x)$：\n$$\nL(x) = \\frac{(x - y_1)^2}{\\sigma_1^2} + \\frac{(x - y_2)^2}{\\sigma_2^2}\n$$\n我们展开平方项，并按 $x$ 的幂次进行分组：\n$$\nL(x) = \\frac{x^2 - 2xy_1 + y_1^2}{\\sigma_1^2} + \\frac{x^2 - 2xy_2 + y_2^2}{\\sigma_2^2}\n$$\n$$\nL(x) = \\left( \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} \\right)x^2 - 2\\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right)x + \\left( \\frac{y_1^2}{\\sigma_1^2} + \\frac{y_2^2}{\\sigma_2^2} \\right)\n$$\n这是 $x$ 的一个二次函数。我们可以看到后验分布也是高斯分布，因为其对数概率密度函数（log-PDF）是 $x$ 的一个二次函数。对于均值为 $\\mu_{post}$、方差为 $\\sigma_{post}^2$ 的 $x$ 的一般高斯 PDF 具有以下形式：\n$$\np(x) \\propto \\exp\\left( -\\frac{(x - \\mu_{post})^2}{2\\sigma_{post}^2} \\right)\n$$\n指数中的参数是 $-\\frac{1}{2} \\left( \\frac{x^2 - 2x\\mu_{post} + \\mu_{post}^2}{\\sigma_{post}^2} \\right)$。将我们推导的 $L(x)$ 表达式中 $x^2$ 和 $x$ 项的系数与标准形式进行比较，我们可以确定 $\\mu_{post}$ 和 $\\sigma_{post}^2$。\n比较 $x^2$ 项：\n$$\n\\frac{1}{\\sigma_{post}^2} = \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}\n$$\n这表明后验的精度（方差的倒数）是各个测量值精度的总和。\n\n比较 $x$ 项：\n$$\n\\frac{2\\mu_{post}}{\\sigma_{post}^2} = 2\\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right)\n$$\n求解后验均值 $\\mu_{post}$：\n$$\n\\mu_{post} = \\sigma_{post}^2 \\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right) = \\frac{\\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2}}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}}\n$$\n因此，后验分布 $p(x \\mid y_1, y_2)$ 是一个高斯分布 $\\mathcal{N}(\\mu_{post}, \\sigma_{post}^2)$。后验均值 $\\mu_{post}$ 是测量值 $y_1$ 和 $y_2$ 的精度加权平均值。\n\n对于任何后验分布，参数 $x$ 的最小均方误差（MMSE）估计量被定义为在该后验分布下 $x$ 的期望，即 $\\hat{x}_{MMSE} = E[x \\mid y_1, y_2]$。对于高斯后验分布，期望值就是其均值。因此，推导出的后验均值 $\\mu_{post}$ 就是 $x$ 的 MMSE 估计量。\n\n现在，我们使用给定的数据计算此估计的数值：\n- $y_1 = 335.6$ K\n- $\\sigma_1 = 0.4$ K $\\implies \\sigma_1^2 = 0.16$ K$^2$\n- $y_2 = 336.9$ K\n- $\\sigma_2 = 0.9$ K $\\implies \\sigma_2^2 = 0.81$ K$^2$\n\n首先，计算精度（方差的倒数）：\n$$\n\\frac{1}{\\sigma_1^2} = \\frac{1}{0.16} = 6.25 \\text{ K}^{-2}\n$$\n$$\n\\frac{1}{\\sigma_2^2} = \\frac{1}{0.81} \\text{ K}^{-2}\n$$\n现在，将这些值代入 $\\mu_{post}$ 的公式中：\n$$\n\\mu_{post} = \\frac{y_1 \\left(\\frac{1}{\\sigma_1^2}\\right) + y_2 \\left(\\frac{1}{\\sigma_2^2}\\right)}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}} = \\frac{(335.6)(6.25) + (336.9)\\left(\\frac{1}{0.81}\\right)}{6.25 + \\frac{1}{0.81}}\n$$\n$$\n\\mu_{post} = \\frac{2097.5 + \\frac{336.9}{0.81}}{6.25 + \\frac{1}{0.81}} = \\frac{2097.5 + 415.9259...}{6.25 + 1.2345...}\n$$\n$$\n\\mu_{post} = \\frac{2513.4259...}{7.4845...} \\approx 335.8144329... \\text{ K}\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3$、$3$、$5$ 和 $8$。后一位数字是 $1$，所以我们向下取整。\n融合后的后验均值估计值为 $335.8$ K。",
            "answer": "$$\\boxed{335.8}$$"
        },
        {
            "introduction": "在掌握了基本的高斯信息融合原理后，我们将其扩展到更接近现实世界的动态系统，这些系统通常用状态空间模型来描述。当一个系统同时被多个线性传感器监测时，我们需要一种系统化的方法来整合所有信息。本练习将指导您如何在卡尔曼滤波器的框架内，通过构建增广测量矩阵来处理多个传感器的同步更新，这是在数字孪生和控制系统中实现多传感器融合的一项标准工程实践。",
            "id": "4233186",
            "problem": "一个信息物理系统 (Cyber-Physical System, CPS) 的数字孪生 (Digital Twin, DT) 在离散时间 $k$ 维持一个二维隐状态向量 $x_{k} \\in \\mathbb{R}^{2}$ 的概率状态估计。在更新时间 $k$，该数字孪生接收到两个独立的线性传感器测量值，每个测量值都受到零均值高斯噪声的干扰，定义如下\n$$\ny_{1,k} = C_{1} x_{k} + v_{1,k}, \\quad y_{2,k} = C_{2} x_{k} + v_{2,k},\n$$\n其中 $v_{1,k} \\sim \\mathcal{N}(0,R_{1})$，$v_{2,k} \\sim \\mathcal{N}(0,R_{2})$，且 $v_{1,k}$ 与 $v_{2,k}$ 统计独立。先验状态估计是协方差为 $P_{k|k-1}$ 的高斯分布。为了执行多传感器融合，将测量值堆叠起来，并构建增广线性模型，其中\n$$\n\\tilde{C} = \\begin{bmatrix} C_{1} \\\\ C_{2} \\end{bmatrix}, \\qquad \\tilde{R} = \\mathrm{diag}(R_{1}, R_{2}).\n$$\n从线性高斯模型的基本定义和高斯条件化的 Bayes 法则出发，推导融合更新的后验协方差 $P_{k|k}$。对于一个归一化的无量纲状态，使用以下数值上给定且物理上合理的量：\n$$\nP_{k|k-1} = \\begin{bmatrix} 2  0.5 \\\\ 0.5  1 \\end{bmatrix}, \\quad C_{1} = \\begin{bmatrix} 1  2 \\end{bmatrix}, \\quad C_{2} = \\begin{bmatrix} 2  -1 \\end{bmatrix}, \\quad R_{1} = 0.2, \\quad R_{2} = 0.5.\n$$\n通过明确构造 $\\tilde{C}$ 和 $\\tilde{R}$ 来演示融合过程，并进行完整的推导以获得 $P_{k|k}$。作为最终报告的量，计算 $P_{k|k}$ 的行列式。将最终的行列式表示为一个精确的、无单位的简化分数，不要进行四舍五入。",
            "solution": "任务是为一个用两个独立传感器测量值更新的状态估计推导后验协方差矩阵 $P_{k|k}$，然后计算其行列式。该过程从用于线性高斯系统的 Bayesian 推断原理开始。\n\n概率状态和测量模型由以下公式给出：\n先验状态分布：$p(x_k) = \\mathcal{N}(x_k; \\hat{x}_{k|k-1}, P_{k|k-1})$\n测量似然：$p(y_k | x_k) = \\mathcal{N}(y_k; C x_k, R)$\n\n根据 Bayes 法则，后验分布与似然和先验的乘积成正比：\n$$p(x_k | y_k) \\propto p(y_k | x_k) p(x_k)$$\n由于两个高斯函数的乘积是另一个（未归一化的）高斯函数，因此后验分布也是高斯分布，$p(x_k | y_k) = \\mathcal{N}(x_k; \\hat{x}_{k|k}, P_{k|k})$。\n\n为了找到后验分布的参数，处理对数分布很方便。多元高斯分布 $\\mathcal{N}(z; \\mu, \\Sigma)$ 的指数部分具有二次型 $-\\frac{1}{2}(z-\\mu)^T \\Sigma^{-1} (z-\\mu)$。忽略归一化常数，对数后验为：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} (y_k - C x_k)^T R^{-1} (y_k - C x_k) - \\frac{1}{2} (x_k - \\hat{x}_{k|k-1})^T P_{k|k-1}^{-1} (x_k - \\hat{x}_{k|k-1}) + \\text{const.}\n$$\n对状态向量 $x_k$ 展开二次项：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} \\left[ (x_k^T C^T R^{-1} C x_k - 2y_k^T R^{-1} C x_k) + (x_k^T P_{k|k-1}^{-1} x_k - 2\\hat{x}_{k|k-1}^T P_{k|k-1}^{-1} x_k) \\right] + \\text{const.'}\n$$\n合并关于 $x_k$ 的项：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} \\left[ x_k^T (P_{k|k-1}^{-1} + C^T R^{-1} C) x_k - 2(y_k^T R^{-1} C + \\hat{x}_{k|k-1}^T P_{k|k-1}^{-1}) x_k \\right] + \\text{const.'}\n$$\n该表达式是关于 $x_k$ 的二次型。通过将其与一般的对数后验形式 $-\\frac{1}{2}(x_k - \\hat{x}_{k|k})^T P_{k|k}^{-1} (x_k - \\hat{x}_{k|k})$ 进行比较，我们可以从二次项 $x_k^T(\\dots)x_k$ 中识别出后验协方差 $P_{k|k}$ 的逆：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + C^T R^{-1} C\n$$\n这是 Kalman 滤波器更新的信息形式。它表明后验信息（协方差的逆）是先验信息与从测量中获得的信息之和。\n\n对于当前的多传感器融合问题，我们使用增广测量模型：\n$$\n\\tilde{y}_k = \\begin{bmatrix} y_{1,k} \\\\ y_{2,k} \\end{bmatrix} = \\tilde{C} x_k + \\tilde{v}_k, \\quad \\tilde{v}_k \\sim \\mathcal{N}(0, \\tilde{R})\n$$\n更新方程变为：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + \\tilde{C}^T \\tilde{R}^{-1} \\tilde{C}\n$$\n我们现在代入给定的数值来计算 $P_{k|k}$ 及其行列式。为了保证精度，将这些值转换为精确分数。\n$$\nP_{k|k-1} = \\begin{bmatrix} 2  0.5 \\\\ 0.5  1 \\end{bmatrix} = \\begin{bmatrix} 2  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{bmatrix}\n$$\n$$\nC_{1} = \\begin{bmatrix} 1  2 \\end{bmatrix}, \\quad C_{2} = \\begin{bmatrix} 2  -1 \\end{bmatrix}\n$$\n$$\nR_{1} = 0.2 = \\frac{1}{5}, \\quad R_{2} = 0.5 = \\frac{1}{2}\n$$\n首先，我们构造增广矩阵 $\\tilde{C}$ 和 $\\tilde{R}$：\n$$\n\\tilde{C} = \\begin{bmatrix} C_{1} \\\\ C_{2} \\end{bmatrix} = \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix}\n$$\n$$\n\\tilde{R} = \\mathrm{diag}(R_{1}, R_{2}) = \\begin{bmatrix} \\frac{1}{5}  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix}\n$$\n接下来，我们计算更新方程所需的各项。\n先验协方差矩阵 $P_{k|k-1}$ 的逆：\n$$\n\\det(P_{k|k-1}) = (2)(1) - (\\frac{1}{2})(\\frac{1}{2}) = 2 - \\frac{1}{4} = \\frac{7}{4}\n$$\n$$\nP_{k|k-1}^{-1} = \\frac{1}{\\det(P_{k|k-1})} \\begin{bmatrix} 1  -\\frac{1}{2} \\\\ -\\frac{1}{2}  2 \\end{bmatrix} = \\frac{4}{7} \\begin{bmatrix} 1  -\\frac{1}{2} \\\\ -\\frac{1}{2}  2 \\end{bmatrix} = \\begin{bmatrix} \\frac{4}{7}  -\\frac{2}{7} \\\\ -\\frac{2}{7}  \\frac{8}{7} \\end{bmatrix}\n$$\n增广测量噪声协方差 $\\tilde{R}$ 的逆：\n$$\n\\tilde{R}^{-1} = \\begin{bmatrix} 5  0 \\\\ 0  2 \\end{bmatrix}\n$$\n现在，我们计算来自测量的信​​息贡献，$\\tilde{C}^T \\tilde{R}^{-1} \\tilde{C}$：\n$$\n\\tilde{C}^T \\tilde{R}^{-1} \\tilde{C} = \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix}^T \\begin{bmatrix} 5  0 \\\\ 0  2 \\end{bmatrix} \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix} \\begin{bmatrix} 5  0 \\\\ 0  2 \\end{bmatrix} \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 5  4 \\\\ 10  -2 \\end{bmatrix} \\begin{bmatrix} 1  2 \\\\ 2  -1 \\end{bmatrix} = \\begin{bmatrix} 5(1)+4(2)  5(2)+4(-1) \\\\ 10(1)+(-2)(2)  10(2)+(-2)(-1) \\end{bmatrix} = \\begin{bmatrix} 13  6 \\\\ 6  22 \\end{bmatrix}\n$$\n我们将先验信息和测量信息相加，得到后验信息矩阵 $P_{k|k}^{-1}$：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + \\tilde{C}^T \\tilde{R}^{-1} \\tilde{C} = \\begin{bmatrix} \\frac{4}{7}  -\\frac{2}{7} \\\\ -\\frac{2}{7}  \\frac{8}{7} \\end{bmatrix} + \\begin{bmatrix} 13  6 \\\\ 6  22 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} \\frac{4}{7} + \\frac{91}{7}  -\\frac{2}{7} + \\frac{42}{7} \\\\ -\\frac{2}{7} + \\frac{42}{7}  \\frac{8}{7} + \\frac{154}{7} \\end{bmatrix} = \\begin{bmatrix} \\frac{95}{7}  \\frac{40}{7} \\\\ \\frac{40}{7}  \\frac{162}{7} \\end{bmatrix}\n$$\n问题要求计算后验协方差的行列式 $\\det(P_{k|k})$。使用性质 $\\det(A^{-1}) = 1/\\det(A)$，我们有 $\\det(P_{k|k}) = 1/\\det(P_{k|k}^{-1})$。\n首先，我们计算后验信息矩阵的行列式：\n$$\n\\det(P_{k|k}^{-1}) = \\left(\\frac{95}{7}\\right)\\left(\\frac{162}{7}\\right) - \\left(\\frac{40}{7}\\right)\\left(\\frac{40}{7}\\right) = \\frac{95 \\times 162 - 40 \\times 40}{49}\n$$\n$$\n95 \\times 162 = 15390\n$$\n$$\n40 \\times 40 = 1600\n$$\n$$\n\\det(P_{k|k}^{-1}) = \\frac{15390 - 1600}{49} = \\frac{13790}{49}\n$$\n最后，后验协方差矩阵的行列式是其倒数：\n$$\n\\det(P_{k|k}) = \\frac{1}{\\det(P_{k|k}^{-1})} = \\frac{49}{13790}\n$$\n我们化简所得的分数。我们注意到 $13790 = 10 \\times 1379$，且 $49 = 7^2$。我们检查 $1379$ 是否能被 $7$ 整除：\n$$\n1379 = 7 \\times 197\n$$\n因此，我们可以化简分数：\n$$\n\\det(P_{k|k}) = \\frac{49}{10 \\times 7 \\times 197} = \\frac{7 \\times 7}{10 \\times 7 \\times 197} = \\frac{7}{10 \\times 197} = \\frac{7}{1970}\n$$\n这就是后验协方差行列式的最终精确简化分数。",
            "answer": "$$\n\\boxed{\\frac{7}{1970}}\n$$"
        },
        {
            "introduction": "线性模型为我们提供了坚实的理论基础，然而在自主导航等诸多实际应用中，传感器（如雷达、声纳或摄像头）与系统状态之间的关系通常是非线性的。为了应对这一挑战，扩展卡尔曼滤波器（EKF）应运而生，它通过对非线性模型进行局部线性化来近似求解。本练习将模拟一个水下航行器的定位任务，您需要处理距离和方位角这两种典型的非线性测量值，通过计算雅可比矩阵并执行EKF更新步骤，从而将线性滤波的理论成功应用于复杂的非线性场景。",
            "id": "4233142",
            "problem": "在一个信息物理系统（CPS）中，一个水下自主航行器的数字孪生（DT）使用了一个集中式多传感器融合架构。在离散时间索引 $k$ 时，DT 维持着对航行器平面位置的先验高斯状态估计，该位置建模为 $x \\in \\mathbb{R}^{2}$，其中 $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$，其先验均值为 $\\hat{x}_{k|k-1}$，先验协方差为 $P_{k|k-1}$。两个异构传感器独立地观测位于原点的静止目标：一个前视声纳提供距离测量，一个单目摄像头提供方位角测量。融合测量向量为\n$$\ny = \\begin{pmatrix} y_{r} \\\\ y_{\\theta} \\end{pmatrix} = h(x) + v,\n$$\n其中 $h(x) = \\begin{pmatrix} \\sqrt{x_{1}^{2} + x_{2}^{2}} \\\\ \\arctan2(x_{2}, x_{1}) \\end{pmatrix}$ 且 $v \\sim \\mathcal{N}(0, R)$，$R \\in \\mathbb{R}^{2 \\times 2}$ 为正定矩阵。假设在给定状态下，传感器是条件独立的，因此 $R$ 是对角矩阵。需要通过围绕先验均值线性化非线性测量模型，并应用线性高斯贝叶斯更新，从基本原理推导扩展卡尔曼滤波器（EKF）的测量更新。\n\n给定：\n- 先验均值 $\\hat{x}_{k|k-1} = \\begin{pmatrix} 30 \\\\ 40 \\end{pmatrix}$ (单位：米)，\n- 先验协方差 $P_{k|k-1} = \\begin{pmatrix} 9  3 \\\\ 3  16 \\end{pmatrix}$ (单位：平方米)，\n- 测量噪声协方差 $R = \\begin{pmatrix} 4.0  0 \\\\ 0  1.0 \\times 10^{-4} \\end{pmatrix}$，其中距离方差单位为平方米，方位角方差单位为平方弧度，\n- 实际融合测量值 $y = \\begin{pmatrix} 49.0 \\\\ 0.93 \\end{pmatrix}$，其中距离单位为米，方位角单位为弧度。\n\n任务：\n1. 严格地从 $h(x)$ 在 $\\hat{x}_{k|k-1}$ 处的一阶泰勒线性化和线性高斯贝叶斯估计法则出发，推导以后验均值 $\\hat{x}_{k|k}$ 表示的EKF测量更新，该表达式应包含雅可比矩阵 $H = \\left.\\frac{\\partial h}{\\partial x}\\right|_{x=\\hat{x}_{k|k-1}}$、先验协方差 $P_{k|k-1}$ 和测量噪声协方差 $R$。\n2. 对于给定的 $h(x)$，计算在 $x = \\hat{x}_{k|k-1}$ 处的雅可比矩阵 $H$。\n3. 使用推导出的更新公式，为所提供的数据数值计算后验均值 $\\hat{x}_{k|k}$。\n\n将最终的后验状态分量四舍五入至四位有效数字。每个分量以米为单位表示。以单个行向量的形式提供最终答案。",
            "solution": "该解答按指定顺序处理三个任务。\n\n**任务 1：EKF测量更新的推导**\n\n扩展卡尔曼滤波器（EKF）测量更新的基础是将非线性测量函数 $h(x)$ 在先验状态估计 $\\hat{x}_{k|k-1}$ 附近进行线性化。测量模型为\n$$y_k = h(x_k) + v_k, \\quad v_k \\sim \\mathcal{N}(0, R_k)$$\n我们对 $h(x_k)$ 在先验均值 $\\hat{x}_{k|k-1}$ 附近进行一阶泰勒级数展开：\n$$h(x_k) \\approx h(\\hat{x}_{k|k-1}) + \\left.\\frac{\\partial h}{\\partial x}\\right|_{x=\\hat{x}_{k|k-1}} (x_k - \\hat{x}_{k|k-1})$$\n令 $H_k = \\left.\\frac{\\partial h}{\\partial x}\\right|_{x=\\hat{x}_{k|k-1}}$ 为在先验均值处计算的测量函数的雅可比矩阵。测量模型可以近似为：\n$$y_k \\approx h(\\hat{x}_{k|k-1}) + H_k (x_k - \\hat{x}_{k|k-1}) + v_k$$\n这个方程可以重新排列，以定义新息（或称测量残差） $\\tilde{y}_k$：\n$$\\tilde{y}_k = y_k - h(\\hat{x}_{k|k-1}) \\approx H_k (x_k - \\hat{x}_{k|k-1}) + v_k$$\n令先验估计误差为 $e_{k|k-1} = x_k - \\hat{x}_{k|k-1}$。根据定义，此误差的均值为零，协方差为 $P_{k|k-1}$，所以 $e_{k|k-1} \\sim \\mathcal{N}(0, P_{k|k-1})$。新息现在可以表示为：\n$$\\tilde{y}_k \\approx H_k e_{k|k-1} + v_k$$\n这建立了新息 $\\tilde{y}_k$ 和先验误差 $e_{k|k-1}$ 之间的线性关系。我们现在处于线性高斯贝叶斯估计的框架内。我们寻求误差的最小均方误差（MMSE）估计，即 $\\hat{e}_{k|k} = \\mathbb{E}[e_{k|k-1} | \\tilde{y}_k]$。\n\n对于联合高斯变量，条件期望由下式给出：\n$$\\hat{e}_{k|k} = \\mathbb{E}[e_{k|k-1}] + \\text{Cov}(e_{k|k-1}, \\tilde{y}_k) \\text{Var}(\\tilde{y}_k)^{-1} (\\tilde{y}_k - \\mathbb{E}[\\tilde{y}_k])$$\n所需的期望和协方差为：\n1.  $\\mathbb{E}[e_{k|k-1}] = 0$。\n2.  $\\mathbb{E}[\\tilde{y}_k] \\approx \\mathbb{E}[H_k e_{k|k-1} + v_k] = H_k \\mathbb{E}[e_{k|k-1}] + \\mathbb{E}[v_k] = 0$。\n3.  新息协方差 $S_k = \\text{Var}(\\tilde{y}_k) = \\mathbb{E}[\\tilde{y}_k \\tilde{y}_k^T] \\approx \\mathbb{E}[(H_k e_{k|k-1} + v_k)(H_k e_{k|k-1} + v_k)^T]$。由于状态误差 $e_{k|k-1}$ 和测量噪声 $v_k$ 不相关，展开得：\n    $$S_k = H_k \\mathbb{E}[e_{k|k-1}e_{k|k-1}^T] H_k^T + \\mathbb{E}[v_k v_k^T] = H_k P_{k|k-1} H_k^T + R_k$$\n4.  状态误差和新息之间的互协方差为 $\\text{Cov}(e_{k|k-1}, \\tilde{y}_k) = \\mathbb{E}[e_{k|k-1} \\tilde{y}_k^T] \\approx \\mathbb{E}[e_{k|k-1}(H_k e_{k|k-1} + v_k)^T]$。再次利用 $e_{k|k-1}$ 和 $v_k$ 的不相关性：\n    $$\\text{Cov}(e_{k|k-1}, \\tilde{y}_k) = \\mathbb{E}[e_{k|k-1}e_{k|k-1}^T]H_k^T = P_{k|k-1}H_k^T$$\n将这些代入条件期望公式，得到误差修正的估计：\n$$\\hat{e}_{k|k} = (P_{k|k-1}H_k^T) (H_k P_{k|k-1} H_k^T + R_k)^{-1} \\tilde{y}_k$$\n我们定义卡尔曼增益 $K_k$ 为：\n$$K_k = P_{k|k-1}H_k^T S_k^{-1} = P_{k|k-1}H_k^T (H_k P_{k|k-1} H_k^T + R_k)^{-1}$$\n后验状态估计 $\\hat{x}_{k|k}$ 是先验估计加上估计的修正量：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + \\hat{e}_{k|k}$$\n代入 $\\hat{e}_{k|k}$ 和 $\\tilde{y}_k$ 的表达式，我们得到最终的EKF测量更新后验均值方程：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k (y_k - h(\\hat{x}_{k|k-1}))$$\n\n**任务 2：雅可比矩阵的计算**\n\n测量函数是 $h(x) = \\begin{pmatrix} h_1(x_1, x_2) \\\\ h_2(x_1, x_2) \\end{pmatrix} = \\begin{pmatrix} \\sqrt{x_{1}^{2} + x_{2}^{2}} \\\\ \\arctan2(x_{2}, x_{1}) \\end{pmatrix}$。雅可比矩阵 $H$ 是所有一阶偏导数组成的矩阵：\n$$H = \\frac{\\partial h}{\\partial x} = \\begin{pmatrix} \\frac{\\partial h_1}{\\partial x_1}  \\frac{\\partial h_1}{\\partial x_2} \\\\ \\frac{\\partial h_2}{\\partial x_1}  \\frac{\\partial h_2}{\\partial x_2} \\end{pmatrix}$$\n偏导数是：\n$\\frac{\\partial h_1}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} (x_1^2 + x_2^2)^{1/2} = \\frac{1}{2}(x_1^2 + x_2^2)^{-1/2}(2x_1) = \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}$\n$\\frac{\\partial h_1}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} (x_1^2 + x_2^2)^{1/2} = \\frac{1}{2}(x_1^2 + x_2^2)^{-1/2}(2x_2) = \\frac{x_2}{\\sqrt{x_1^2 + x_2^2}}$\n$\\frac{\\partial h_2}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\arctan\\left(\\frac{x_2}{x_1}\\right) = \\frac{1}{1 + (x_2/x_1)^2} \\left(-\\frac{x_2}{x_1^2}\\right) = \\frac{-x_2}{x_1^2 + x_2^2}$\n$\\frac{\\partial h_2}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\arctan\\left(\\frac{x_2}{x_1}\\right) = \\frac{1}{1 + (x_2/x_1)^2} \\left(\\frac{1}{x_1}\\right) = \\frac{x_1}{x_1^2 + x_2^2}$\n所以，雅可比矩阵是：\n$$H(x) = \\begin{pmatrix} \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}  \\frac{x_2}{\\sqrt{x_1^2 + x_2^2}} \\\\ \\frac{-x_2}{x_1^2 + x_2^2}  \\frac{x_1}{x_1^2 + x_2^2} \\end{pmatrix}$$\n我们在先验均值 $\\hat{x}_{k|k-1} = \\begin{pmatrix} 30 \\\\ 40 \\end{pmatrix}$ 处计算该矩阵。首先，我们计算距离 $r = \\sqrt{30^2 + 40^2} = \\sqrt{900 + 1600} = \\sqrt{2500} = 50$ 米。\n$$H_k = H(\\hat{x}_{k|k-1}) = \\begin{pmatrix} \\frac{30}{50}  \\frac{40}{50} \\\\ \\frac{-40}{50^2}  \\frac{30}{50^2} \\end{pmatrix} = \\begin{pmatrix} 0.6  0.8 \\\\ \\frac{-40}{2500}  \\frac{30}{2500} \\end{pmatrix} = \\begin{pmatrix} 0.6  0.8 \\\\ -0.016  0.012 \\end{pmatrix}$$\n\n**任务 3：后验均值的数值计算**\n\n我们使用推导出的更新方程 $\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k (y_k - h(\\hat{x}_{k|k-1}))$。步骤如下：\n\n1.  **计算预测测量值和新息：**\n    预测测量值是 $h(\\hat{x}_{k|k-1})$:\n    $$h(\\hat{x}_{k|k-1}) = \\begin{pmatrix} \\sqrt{30^2 + 40^2} \\\\ \\arctan2(40, 30) \\end{pmatrix} = \\begin{pmatrix} 50 \\\\ \\arctan(4/3) \\end{pmatrix} \\approx \\begin{pmatrix} 50 \\\\ 0.927295 \\end{pmatrix}$$\n    新息 $\\tilde{y}_k$ 是实际测量值 $y_k$ 和预测测量值之间的差：\n    $$\\tilde{y}_k = y_k - h(\\hat{x}_{k|k-1}) = \\begin{pmatrix} 49.0 \\\\ 0.93 \\end{pmatrix} - \\begin{pmatrix} 50 \\\\ 0.927295 \\end{pmatrix} = \\begin{pmatrix} -1.0 \\\\ 0.002705 \\end{pmatrix}$$\n\n2.  **计算新息协方差 $S_k$：**\n    $$S_k = H_k P_{k|k-1} H_k^T + R_k$$\n    $$H_k P_{k|k-1} = \\begin{pmatrix} 0.6  0.8 \\\\ -0.016  0.012 \\end{pmatrix} \\begin{pmatrix} 9  3 \\\\ 3  16 \\end{pmatrix} = \\begin{pmatrix} 7.8  14.6 \\\\ -0.108  0.144 \\end{pmatrix}$$\n    $$H_k P_{k|k-1} H_k^T = \\begin{pmatrix} 7.8  14.6 \\\\ -0.108  0.144 \\end{pmatrix} \\begin{pmatrix} 0.6  -0.016 \\\\ 0.8  0.012 \\end{pmatrix} = \\begin{pmatrix} 16.36  0.0504 \\\\ 0.0504  0.003456 \\end{pmatrix}$$\n    $$S_k = \\begin{pmatrix} 16.36  0.0504 \\\\ 0.0504  0.003456 \\end{pmatrix} + \\begin{pmatrix} 4.0  0 \\\\ 0  0.0001 \\end{pmatrix} = \\begin{pmatrix} 20.36  0.0504 \\\\ 0.0504  0.003556 \\end{pmatrix}$$\n\n3.  **计算卡尔曼增益 $K_k$：**\n    $$K_k = P_{k|k-1} H_k^T S_k^{-1}$$\n    $$P_{k|k-1} H_k^T = \\begin{pmatrix} 9  3 \\\\ 3  16 \\end{pmatrix} \\begin{pmatrix} 0.6  -0.016 \\\\ 0.8  0.012 \\end{pmatrix} = \\begin{pmatrix} 7.8  -0.108 \\\\ 14.6  0.144 \\end{pmatrix}$$\n    $S_k$ 的逆矩阵是 $S_k^{-1} = \\frac{1}{\\det(S_k)} \\begin{pmatrix} 0.003556  -0.0504 \\\\ -0.0504  20.36 \\end{pmatrix}$。\n    $\\det(S_k) = (20.36)(0.003556) - (0.0504)^2 = 0.07238016 - 0.00254016 = 0.06984$。\n    $$K_k = \\frac{1}{0.06984} \\begin{pmatrix} 7.8  -0.108 \\\\ 14.6  0.144 \\end{pmatrix} \\begin{pmatrix} 0.003556  -0.0504 \\\\ -0.0504  20.36 \\end{pmatrix}$$\n    $$K_k = \\frac{1}{0.06984} \\begin{pmatrix} 0.03318  -2.592 \\\\ 0.04466  2.196 \\end{pmatrix} \\approx \\begin{pmatrix} 0.47514  -37.1134 \\\\ 0.63946  31.4433 \\end{pmatrix}$$\n\n4.  **计算后验均值 $\\hat{x}_{k|k}$：**\n    状态更新为 $K_k \\tilde{y}_k$:\n    $$\\begin{pmatrix} 0.47514  -37.1134 \\\\ 0.63946  31.4433 \\end{pmatrix} \\begin{pmatrix} -1.0 \\\\ 0.002705 \\end{pmatrix} = \\begin{pmatrix} -0.47514 - 0.10038 \\\\ -0.63946 + 0.08505 \\end{pmatrix} = \\begin{pmatrix} -0.57552 \\\\ -0.55441 \\end{pmatrix}$$\n    最后，我们将此修正量加到先验均值上：\n    $$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k \\tilde{y}_k = \\begin{pmatrix} 30 \\\\ 40 \\end{pmatrix} + \\begin{pmatrix} -0.57552 \\\\ -0.55441 \\end{pmatrix} = \\begin{pmatrix} 29.42448 \\\\ 39.44559 \\end{pmatrix}$$\n\n将最终分量四舍五入到四位有效数字，我们得到：\n$\\hat{x}_{k|k,1} = 29.42$ 米。\n$\\hat{x}_{k|k,2} = 39.45$ 米。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 29.42  39.45 \\end{pmatrix}}\n$$"
        }
    ]
}