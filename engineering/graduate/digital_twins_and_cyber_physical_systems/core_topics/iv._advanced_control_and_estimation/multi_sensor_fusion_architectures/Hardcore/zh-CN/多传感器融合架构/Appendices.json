{
    "hands_on_practices": [
        {
            "introduction": "本次练习旨在为贝叶斯传感器融合奠定基础。通过融合对单一状态的两个独立高斯测量，我们将从第一性原理推导出信息如何被最优地组合，并揭示融合后的估计是各个独立测量的精度加权平均。这个练习为理解更复杂的融合算法提供了核心的直观认识。",
            "id": "4233215",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 使用一个集中式多传感器融合架构来监测一个未观测到的标量状态 $x$（电池模块的内部核心温度），该架构聚合了一个物理温度传感器和一个基于软件的观测器。在一个固定的时间瞬间，以 $x$ 为条件的测量模型是独立的，并由以下高斯似然描述：物理传感器产生 $y_1$，其满足 $y_1 \\mid x \\sim \\mathcal{N}(x,\\sigma_1^2)$；DT 观测器产生 $y_2$，其满足 $y_2 \\mid x \\sim \\mathcal{N}(x,\\sigma_2^2)$。假设在感兴趣的范围内存在一个无信息平坦先验 $p(x) \\propto 1$，并且给定 $x$ 时 $y_1$ 和 $y_2$ 条件独立。从贝叶斯法则和高斯似然的定义出发，通过配方法推导后验密度 $p(x \\mid y_1,y_2)$，并将在平坦先验下，将后验均值确定为 $x$ 的最小均方误差估计量。\n\n在一个特定的时间瞬间，测量值和已知的噪声水平为：\n- $y_1 = 335.6$ K，其中 $\\sigma_1 = 0.4$ K，\n- $y_2 = 336.9$ K，其中 $\\sigma_2 = 0.9$ K。\n\n计算 $x$ 的融合后验均值估计值（以开尔文为单位）。将您的最终数值答案以 K 表示，并四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它在科学上基于贝叶斯统计推断，是适定的（有足够信息得出唯一解），并使用客观、正式的语言陈述。它代表了工程学中一个标准的传感器融合问题，并且没有指定的缺陷。\n\n目标是对于一个未观测状态 $x$ 和两个独立测量值 $y_1$ 和 $y_2$，推导出后验概率密度函数 $p(x \\mid y_1, y_2)$，然后计算后验均值。\n\n根据贝叶斯法则，后验分布与似然和先验分布的乘积成正比：\n$$\np(x \\mid y_1, y_2) \\propto p(y_1, y_2 \\mid x) p(x)\n$$\n问题陈述了测量值 $y_1$ 和 $y_2$ 在给定状态 $x$ 的条件下是条件独立的。因此，联合似然 $p(y_1, y_2 \\mid x)$ 可以分解为各个似然的乘积：\n$$\np(y_1, y_2 \\mid x) = p(y_1 \\mid x) p(y_2 \\mid x)\n$$\n$x$ 的先验分布被给定为一个无信息平坦先验，$p(x) \\propto 1$。将这些代入贝叶斯法则表达式，得到：\n$$\np(x \\mid y_1, y_2) \\propto p(y_1 \\mid x) p(y_2 \\mid x)\n$$\n似然函数被给定为高斯分布：\n$y_1 \\mid x \\sim \\mathcal{N}(x, \\sigma_1^2)$，所以其概率密度函数 (PDF) 是\n$$\np(y_1 \\mid x) = \\frac{1}{\\sqrt{2\\pi\\sigma_1^2}} \\exp\\left( -\\frac{(y_1 - x)^2}{2\\sigma_1^2} \\right)\n$$\n以及 $y_2 \\mid x \\sim \\mathcal{N}(x, \\sigma_2^2)$，所以其 PDF 是\n$$\np(y_2 \\mid x) = \\frac{1}{\\sqrt{2\\pi\\sigma_2^2}} \\exp\\left( -\\frac{(y_2 - x)^2}{2\\sigma_2^2} \\right)\n$$\n后验分布与这两个函数的乘积成正比。因为我们处理的是比例关系，可以忽略归一化常数：\n$$\np(x \\mid y_1, y_2) \\propto \\exp\\left( -\\frac{(x - y_1)^2}{2\\sigma_1^2} \\right) \\exp\\left( -\\frac{(x - y_2)^2}{2\\sigma_2^2} \\right)\n$$\n合并指数项：\n$$\np(x \\mid y_1, y_2) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(x - y_1)^2}{\\sigma_1^2} + \\frac{(x - y_2)^2}{\\sigma_2^2} \\right] \\right)\n$$\n为了确定此分布的形式，我们分析指数的参数，我们将其表示为 $L(x)$：\n$$\nL(x) = \\frac{(x - y_1)^2}{\\sigma_1^2} + \\frac{(x - y_2)^2}{\\sigma_2^2}\n$$\n我们展开平方项，并按 $x$ 的幂次分组：\n$$\nL(x) = \\frac{x^2 - 2xy_1 + y_1^2}{\\sigma_1^2} + \\frac{x^2 - 2xy_2 + y_2^2}{\\sigma_2^2}\n$$\n$$\nL(x) = \\left( \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2} \\right)x^2 - 2\\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right)x + \\left( \\frac{y_1^2}{\\sigma_1^2} + \\frac{y_2^2}{\\sigma_2^2} \\right)\n$$\n这是 $x$ 的一个二次函数。我们可以看到后验分布也是高斯分布，因为其对数概率密度函数是 $x$ 的二次函数。一个关于 $x$ 的通用高斯 PDF，其均值为 $\\mu_{post}$、方差为 $\\sigma_{post}^2$，形式如下：\n$$\np(x) \\propto \\exp\\left( -\\frac{(x - \\mu_{post})^2}{2\\sigma_{post}^2} \\right)\n$$\n指数中的参数是 $-\\frac{1}{2} \\left( \\frac{x^2 - 2x\\mu_{post} + \\mu_{post}^2}{\\sigma_{post}^2} \\right)$。将我们推导出的 $L(x)$ 表达式中 $x^2$ 和 $x$ 项的系数与标准形式进行比较，我们可以确定 $\\mu_{post}$ 和 $\\sigma_{post}^2$。\n比较 $x^2$ 项：\n$$\n\\frac{1}{\\sigma_{post}^2} = \\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}\n$$\n这表明后验的精度（方差的倒数）是各个测量精度的总和。\n\n比较 $x$ 项：\n$$\n\\frac{2\\mu_{post}}{\\sigma_{post}^2} = 2\\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right)\n$$\n求解后验均值 $\\mu_{post}$：\n$$\n\\mu_{post} = \\sigma_{post}^2 \\left( \\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2} \\right) = \\frac{\\frac{y_1}{\\sigma_1^2} + \\frac{y_2}{\\sigma_2^2}}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}}\n$$\n因此，后验分布 $p(x \\mid y_1, y_2)$ 是一个高斯分布 $\\mathcal{N}(\\mu_{post}, \\sigma_{post}^2)$。后验均值 $\\mu_{post}$ 是测量值 $y_1$ 和 $y_2$ 的精度加权平均值。\n\n对于任何后验分布，参数 $x$ 的最小均方误差 (MMSE) 估计量定义为在该后验分布下 $x$ 的期望，即 $\\hat{x}_{MMSE} = E[x \\mid y_1, y_2]$。对于高斯后验分布，期望值就是其均值。因此，推导出的后验均值 $\\mu_{post}$ 就是 $x$ 的 MMSE 估计量。\n\n现在，我们使用给定的数据计算此估计的数值：\n- $y_1 = 335.6$ K\n- $\\sigma_1 = 0.4$ K $\\implies \\sigma_1^2 = 0.16$ K$^2$\n- $y_2 = 336.9$ K\n- $\\sigma_2 = 0.9$ K $\\implies \\sigma_2^2 = 0.81$ K$^2$\n\n首先，计算精度（方差的倒数）：\n$$\n\\frac{1}{\\sigma_1^2} = \\frac{1}{0.16} = 6.25 \\text{ K}^{-2}\n$$\n$$\n\\frac{1}{\\sigma_2^2} = \\frac{1}{0.81} \\text{ K}^{-2}\n$$\n现在，将这些值代入 $\\mu_{post}$ 的公式中：\n$$\n\\mu_{post} = \\frac{y_1 \\left(\\frac{1}{\\sigma_1^2}\\right) + y_2 \\left(\\frac{1}{\\sigma_2^2}\\right)}{\\frac{1}{\\sigma_1^2} + \\frac{1}{\\sigma_2^2}} = \\frac{(335.6)(6.25) + (336.9)\\left(\\frac{1}{0.81}\\right)}{6.25 + \\frac{1}{0.81}}\n$$\n$$\n\\mu_{post} = \\frac{2097.5 + \\frac{336.9}{0.81}}{6.25 + \\frac{1}{0.81}} = \\frac{2097.5 + 415.9259...}{6.25 + 1.2345...}\n$$\n$$\n\\mu_{post} = \\frac{2513.4259...}{7.4845...} \\approx 335.8144329... \\text{ K}\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3$、$3$、$5$ 和 $8$。后一位数字是 $1$，因此我们向下舍入。\n融合后的后验均值估计为 $335.8$ K。",
            "answer": "$$\\boxed{335.8}$$"
        },
        {
            "introduction": "在标量情况的基础上，本练习将融合概念推广到由多个线性传感器观测的多维状态向量。您将构建一个增广测量模型，并推导后验协方差的更新过程，这是卡尔曼滤波器的基石。本次实践展示了中心化架构如何在矩阵-向量域中通过整合信息来系统地减少状态不确定性。",
            "id": "4233186",
            "problem": "一个信息物理系统（CPS）的数字孪生（DT）在离散时间 $k$ 维护一个二维潜在状态向量 $x_{k} \\in \\mathbb{R}^{2}$ 的概率性状态估计。在更新时刻 $k$，DT 接收到两个独立的线性传感器测量值，每个都受到零均值高斯噪声的干扰，定义如下：\n$$\ny_{1,k} = C_{1} x_{k} + v_{1,k}, \\quad y_{2,k} = C_{2} x_{k} + v_{2,k},\n$$\n其中 $v_{1,k} \\sim \\mathcal{N}(0,R_{1})$，$v_{2,k} \\sim \\mathcal{N}(0,R_{2})$，且 $v_{1,k}$ 与 $v_{2,k}$ 统计独立。先验状态估计是协方差为 $P_{k|k-1}$ 的高斯分布。为了执行多传感器融合，堆叠测量值并构造具有以下参数的增广线性模型：\n$$\n\\tilde{C} = \\begin{bmatrix} C_{1} \\\\ C_{2} \\end{bmatrix}, \\qquad \\tilde{R} = \\mathrm{diag}(R_{1}, R_{2}).\n$$\n从线性高斯模型的基本定义和高斯条件作用的 Bayes 法则出发，推导融合更新的后验协方差 $P_{k|k}$。对于一个归一化的无量纲状态，使用以下数值给定且物理上合理的量：\n$$\nP_{k|k-1} = \\begin{bmatrix} 2 & 0.5 \\\\ 0.5 & 1 \\end{bmatrix}, \\quad C_{1} = \\begin{bmatrix} 1 & 2 \\end{bmatrix}, \\quad C_{2} = \\begin{bmatrix} 2 & -1 \\end{bmatrix}, \\quad R_{1} = 0.2, \\quad R_{2} = 0.5.\n$$\n通过显式构造 $\\tilde{C}$ 和 $\\tilde{R}$ 来演示该融合过程，并进行完整推导以获得 $P_{k|k}$。作为最终报告的量，计算 $P_{k|k}$ 的行列式。将最终的行列式表示为一个无单位的精确简化分数，不要四舍五入。",
            "solution": "所述问题具有科学依据、是良定的且客观的。这是在线性高斯状态估计框架（通常称为 Kalman 滤波器）内多传感器融合的一个标准应用。所有必要的数据和定义都已给出，并且它们的维度和值在归一化情境下是一致且物理上合理的。因此，该问题被视为**有效的**。\n\n任务是为一个用两个独立传感器测量值更新的状态估计推导其后验协方差矩阵 $P_{k|k}$，然后计算其行列式。该过程从针对线性高斯系统的 Bayesian 推断原理开始。\n\n概率性状态和测量模型由下式给出：\n先验状态分布：$p(x_k) = \\mathcal{N}(x_k; \\hat{x}_{k|k-1}, P_{k|k-1})$\n测量似然：$p(y_k | x_k) = \\mathcal{N}(y_k; C x_k, R)$\n\n根据 Bayes 法则，后验分布与似然和先验的乘积成正比：\n$$p(x_k | y_k) \\propto p(y_k | x_k) p(x_k)$$\n由于两个高斯函数的乘积是另一个（未归一化的）高斯函数，因此后验分布也是高斯分布，$p(x_k | y_k) = \\mathcal{N}(x_k; \\hat{x}_{k|k}, P_{k|k})$。\n\n为了找到后验分布的参数，处理对数分布会很方便。一个多元高斯分布 $\\mathcal{N}(z; \\mu, \\Sigma)$ 的指数部分具有一个二次型 $-\\frac{1}{2}(z-\\mu)^T \\Sigma^{-1} (z-\\mu)$。忽略归一化常数，对数后验为：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} (y_k - C x_k)^T R^{-1} (y_k - C x_k) - \\frac{1}{2} (x_k - \\hat{x}_{k|k-1})^T P_{k|k-1}^{-1} (x_k - \\hat{x}_{k|k-1}) + \\text{const.}\n$$\n展开关于状态向量 $x_k$ 的二次项：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} \\left[ (x_k^T C^T R^{-1} C x_k - 2y_k^T R^{-1} C x_k) + (x_k^T P_{k|k-1}^{-1} x_k - 2\\hat{x}_{k|k-1}^T P_{k|k-1}^{-1} x_k) \\right] + \\text{const.'}\n$$\n合并 $x_k$ 的项：\n$$\n\\ln p(x_k|y_k) = -\\frac{1}{2} \\left[ x_k^T (P_{k|k-1}^{-1} + C^T R^{-1} C) x_k - 2(y_k^T R^{-1} C + \\hat{x}_{k|k-1}^T P_{k|k-1}^{-1}) x_k \\right] + \\text{const.'}\n$$\n这个表达式是关于 $x_k$ 的一个二次型。通过将其与一般的对数后验形式 $-\\frac{1}{2}(x_k - \\hat{x}_{k|k})^T P_{k|k}^{-1} (x_k - \\hat{x}_{k|k})$ 进行比较，我们可以从二次项 $x_k^T(\\dots)x_k$ 中识别出后验协方差 $P_{k|k}$ 的逆：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + C^T R^{-1} C\n$$\n这是 Kalman 滤波器更新的信息形式。这表明后验信息（协方差的逆）是先验信息与从测量中获得的信息之和。\n\n对于当前的多传感器融合问题，我们使用增广测量模型：\n$$\n\\tilde{y}_k = \\begin{bmatrix} y_{1,k} \\\\ y_{2,k} \\end{bmatrix} = \\tilde{C} x_k + \\tilde{v}_k, \\quad \\tilde{v}_k \\sim \\mathcal{N}(0, \\tilde{R})\n$$\n更新方程变为：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + \\tilde{C}^T \\tilde{R}^{-1} \\tilde{C}\n$$\n现在我们代入给定的数值来计算 $P_{k|k}$ 及其行列式。为了保证精度，这些值被转换为精确分数。\n$$\nP_{k|k-1} = \\begin{bmatrix} 2 & \\frac{1}{2} \\\\ \\frac{1}{2} & 1 \\end{bmatrix}\n$$\n$$\nC_{1} = \\begin{bmatrix} 1 & 2 \\end{bmatrix}, \\quad C_{2} = \\begin{bmatrix} 2 & -1 \\end{bmatrix}\n$$\n$$\nR_{1} = 0.2 = \\frac{1}{5}, \\quad R_{2} = 0.5 = \\frac{1}{2}\n$$\n首先，我们构造增广矩阵 $\\tilde{C}$ 和 $\\tilde{R}$：\n$$\n\\tilde{C} = \\begin{bmatrix} C_{1} \\\\ C_{2} \\end{bmatrix} = \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix}\n$$\n$$\n\\tilde{R} = \\mathrm{diag}(R_{1}, R_{2}) = \\begin{bmatrix} \\frac{1}{5} & 0 \\\\ 0 & \\frac{1}{2} \\end{bmatrix}\n$$\n接下来，我们计算更新方程所需的各项。\n先验协方差矩阵 $P_{k|k-1}$ 的逆：\n$$\n\\det(P_{k|k-1}) = (2)(1) - (\\frac{1}{2})(\\frac{1}{2}) = 2 - \\frac{1}{4} = \\frac{7}{4}\n$$\n$$\nP_{k|k-1}^{-1} = \\frac{1}{\\det(P_{k|k-1})} \\begin{bmatrix} 1 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 2 \\end{bmatrix} = \\frac{4}{7} \\begin{bmatrix} 1 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 2 \\end{bmatrix} = \\begin{bmatrix} \\frac{4}{7} & -\\frac{2}{7} \\\\ -\\frac{2}{7} & \\frac{8}{7} \\end{bmatrix}\n$$\n增广测量噪声协方差 $\\tilde{R}$ 的逆：\n$$\n\\tilde{R}^{-1} = \\begin{bmatrix} 5 & 0 \\\\ 0 & 2 \\end{bmatrix}\n$$\n现在，我们计算来自测量的信​​息贡献 $\\tilde{C}^T \\tilde{R}^{-1} \\tilde{C}$：\n$$\n\\tilde{C}^T \\tilde{R}^{-1} \\tilde{C} = \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix}^T \\begin{bmatrix} 5 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix} = \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix} \\begin{bmatrix} 5 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 5 & 4 \\\\ 10 & -2 \\end{bmatrix} \\begin{bmatrix} 1 & 2 \\\\ 2 & -1 \\end{bmatrix} = \\begin{bmatrix} 5(1)+4(2) & 5(2)+4(-1) \\\\ 10(1)+(-2)(2) & 10(2)+(-2)(-1) \\end{bmatrix} = \\begin{bmatrix} 13 & 6 \\\\ 6 & 22 \\end{bmatrix}\n$$\n我们将先验信息和测量信息相加，得到后验信息矩阵 $P_{k|k}^{-1}$：\n$$\nP_{k|k}^{-1} = P_{k|k-1}^{-1} + \\tilde{C}^T \\tilde{R}^{-1} \\tilde{C} = \\begin{bmatrix} \\frac{4}{7} & -\\frac{2}{7} \\\\ -\\frac{2}{7} & \\frac{8}{7} \\end{bmatrix} + \\begin{bmatrix} 13 & 6 \\\\ 6 & 22 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} \\frac{4}{7} + \\frac{91}{7} & -\\frac{2}{7} + \\frac{42}{7} \\\\ -\\frac{2}{7} + \\frac{42}{7} & \\frac{8}{7} + \\frac{154}{7} \\end{bmatrix} = \\begin{bmatrix} \\frac{95}{7} & \\frac{40}{7} \\\\ \\frac{40}{7} & \\frac{162}{7} \\end{bmatrix}\n$$\n问题要求计算后验协方差的行列式 $\\det(P_{k|k})$。利用性质 $\\det(A^{-1}) = 1/\\det(A)$，我们有 $\\det(P_{k|k}) = 1/\\det(P_{k|k}^{-1})$。\n首先，我们计算后验信息矩阵的行列式：\n$$\n\\det(P_{k|k}^{-1}) = \\left(\\frac{95}{7}\\right)\\left(\\frac{162}{7}\\right) - \\left(\\frac{40}{7}\\right)\\left(\\frac{40}{7}\\right) = \\frac{95 \\times 162 - 40 \\times 40}{49}\n$$\n$$\n95 \\times 162 = 15390\n$$\n$$\n40 \\times 40 = 1600\n$$\n$$\n\\det(P_{k|k}^{-1}) = \\frac{15390 - 1600}{49} = \\frac{13790}{49}\n$$\n最后，后验协方差矩阵的行列式是其倒数：\n$$\n\\det(P_{k|k}) = \\frac{1}{\\det(P_{k|k}^{-1})} = \\frac{49}{13790}\n$$\n我们简化所得的分数。我们注意到 $13790 = 10 \\times 1379$，$49 = 7^2$。我们检查 $1379$ 是否能被 $7$ 整除：\n$$\n1379 = 7 \\times 197\n$$\n因此，我们可以简化分数：\n$$\n\\det(P_{k|k}) = \\frac{49}{10 \\times 7 \\times 197} = \\frac{7 \\times 7}{10 \\times 7 \\times 197} = \\frac{7}{10 \\times 197} = \\frac{7}{1970}\n$$\n这就是后验协方差行列式的最终、精确的简化分数。",
            "answer": "$$\n\\boxed{\\frac{7}{1970}}\n$$"
        },
        {
            "introduction": "一个有效的融合架构不仅能组合数据，还能以最优的方式进行组合。本次练习引入克拉美-罗下界（Cramér–Rao lower bound, CRLB）作为评估估计器性能的基准工具。通过为一个多传感器估计问题推导CRLB，并将其与一个朴素估计器的性能进行比较，您将定量地理解最优融合策略的价值以及估计器效率的概念。",
            "id": "4233217",
            "problem": "一个信息物理系统数字孪生监控一个刚体的平面位置，其真实状态向量为 $\\boldsymbol{\\theta} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$。一个多传感器融合架构产生三个独立的标量测量值 $\\{z_{i}\\}_{i=1}^{3}$，其测量模型为线性模型，且噪声为零均值高斯噪声：\n$z_{1} = x + n_{1}$，$z_{2} = y + n_{2}$，$z_{3} = x + y + n_{3}$，\n其中 $n_{1}$、$n_{2}$ 和 $n_{3}$ 是相互独立的零均值高斯噪声，其方差分别为 $\\operatorname{Var}(n_{1}) = 0.04$、$\\operatorname{Var}(n_{2}) = 0.01$ 和 $\\operatorname{Var}(n_{3}) = 0.09$。堆叠后的测量模型可以写成 $\\mathbf{z} = \\mathbf{H}\\boldsymbol{\\theta} + \\mathbf{n}$，其中\n$\\mathbf{H} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}$ 且 $\\mathbf{R} = \\operatorname{diag}\\!\\big(0.04,\\,0.01,\\,0.09\\big)$。\n\n从独立高斯测量的似然函数定义及其相关的对数似然函数出发，推导 $\\boldsymbol{\\theta}$ 的费雪信息矩阵 (FIM)，然后通过计算 FIM 逆矩阵的相应元素，求出 $x$ 的任意无偏估计量的克拉默-拉奥下界 (CRLB)。接下来，考虑忽略异方差性的朴素非加权最小二乘 (LS) 估计量，其定义为 $\\hat{\\boldsymbol{\\theta}}_{\\text{LS}} = \\big(\\mathbf{H}^{\\top}\\mathbf{H}\\big)^{-1}\\mathbf{H}^{\\top}\\mathbf{z}$。在真实噪声协方差 $\\mathbf{R}$ 下，推导 $\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}$ 的协方差，并计算其第一个分量（$x$ 的估计量）的方差。求该方差与 $x$ 的 CRLB 之间的比值 $r$。\n\n报告最终比值 $r$ 的精确值。不要四舍五入。最终答案必须是单个不带单位的实数。",
            "solution": "本题要求计算状态分量 $x$ 的非加权最小二乘 (LS) 估计量的方差与该分量的克拉默-拉奥下界 (CRLB) 之间的比值。解题过程分为三个主要步骤：\n1.  推导费雪信息矩阵 (FIM)，并计算 $x$ 的任意无偏估计量方差的 CRLB。\n2.  推导非加权 LS 估计量 $\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}$ 的协方差矩阵，并求出其第一个分量 $\\hat{x}_{\\text{LS}}$ 的方差。\n3.  计算步骤2中得到的方差与步骤1中得到的 CRLB 的比值。\n\n状态向量为 $\\boldsymbol{\\theta} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$。线性测量模型为 $\\mathbf{z} = \\mathbf{H}\\boldsymbol{\\theta} + \\mathbf{n}$，其中 $\\mathbf{z} \\in \\mathbb{R}^3$，$\\mathbf{n} \\in \\mathbb{R}^3$ 是一个由零均值、相互独立的高斯噪声组成的向量。测量矩阵 $\\mathbf{H}$ 和噪声协方差矩阵 $\\mathbf{R}$ 由下式给出：\n$$\n\\mathbf{H} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad \\mathbf{R} = \\operatorname{Cov}(\\mathbf{n}) = \\begin{pmatrix} 0.04 & 0 & 0 \\\\ 0 & 0.01 & 0 \\\\ 0 & 0 & 0.09 \\end{pmatrix}\n$$\n噪声向量 $\\mathbf{n}$ 服从多元高斯分布 $\\mathcal{N}(\\mathbf{0}, \\mathbf{R})$。因此，测量向量 $\\mathbf{z}$ 服从分布 $\\mathbf{z} \\sim \\mathcal{N}(\\mathbf{H}\\boldsymbol{\\theta}, \\mathbf{R})$。\n\n**步骤 1：费雪信息矩阵与克拉默-拉奥下界**\n\n在给定参数 $\\boldsymbol{\\theta}$ 的条件下，测量值 $\\mathbf{z}$ 的似然函数 $p(\\mathbf{z}|\\boldsymbol{\\theta})$ 是多元正态分布的概率密度函数：\n$$\np(\\mathbf{z}|\\boldsymbol{\\theta}) = \\frac{1}{(2\\pi)^{3/2} \\det(\\mathbf{R})^{1/2}} \\exp\\left( -\\frac{1}{2} (\\mathbf{z} - \\mathbf{H}\\boldsymbol{\\theta})^{\\top} \\mathbf{R}^{-1} (\\mathbf{z} - \\mathbf{H}\\boldsymbol{\\theta}) \\right)\n$$\n对数似然函数 $\\mathcal{L}(\\boldsymbol{\\theta})$ 为：\n$$\n\\mathcal{L}(\\boldsymbol{\\theta}) = \\ln p(\\mathbf{z}|\\boldsymbol{\\theta}) = C - \\frac{1}{2} (\\mathbf{z} - \\mathbf{H}\\boldsymbol{\\theta})^{\\top} \\mathbf{R}^{-1} (\\mathbf{z} - \\mathbf{H}\\boldsymbol{\\theta})\n$$\n其中 $C$ 是一个不依赖于 $\\boldsymbol{\\theta}$ 的常数。费雪信息矩阵 (FIM) $\\mathbf{J}$ 定义为 $\\mathbf{J} = -E\\left[ \\frac{\\partial^2 \\mathcal{L}(\\boldsymbol{\\theta})}{\\partial \\boldsymbol{\\theta} \\partial \\boldsymbol{\\theta}^{\\top}} \\right]$。对于线性高斯模型，这可以简化为众所周知的形式：\n$$\n\\mathbf{J} = \\mathbf{H}^{\\top} \\mathbf{R}^{-1} \\mathbf{H}\n$$\n我们首先计算 $\\mathbf{R}^{-1}$。给定的方差为 $\\sigma_1^2 = 0.04 = \\frac{4}{100} = \\frac{1}{25}$，$\\sigma_2^2 = 0.01 = \\frac{1}{100}$ 和 $\\sigma_3^2 = 0.09 = \\frac{9}{100}$。\n$$\n\\mathbf{R}^{-1} = \\begin{pmatrix} 1/0.04 & 0 & 0 \\\\ 0 & 1/0.01 & 0 \\\\ 0 & 0 & 1/0.09 \\end{pmatrix} = \\begin{pmatrix} 25 & 0 & 0 \\\\ 0 & 100 & 0 \\\\ 0 & 0 & 100/9 \\end{pmatrix}\n$$\n现在，我们计算 FIM, $\\mathbf{J}$：\n$$\n\\mathbf{J} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 25 & 0 & 0 \\\\ 0 & 100 & 0 \\\\ 0 & 0 & 100/9 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{J} = \\begin{pmatrix} 25 & 0 & 100/9 \\\\ 0 & 100 & 100/9 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{J} = \\begin{pmatrix} 25 + 100/9 & 100/9 \\\\ 100/9 & 100 + 100/9 \\end{pmatrix} = \\begin{pmatrix} (225+100)/9 & 100/9 \\\\ 100/9 & (900+100)/9 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 325 & 100 \\\\ 100 & 1000 \\end{pmatrix}\n$$\n克拉默-拉奥下界矩阵是 FIM 的逆矩阵，即 $\\mathbf{C}_{\\text{CRLB}} = \\mathbf{J}^{-1}$。对于任何无偏估计量 $\\hat{\\boldsymbol{\\theta}}$，其协方差矩阵满足 $\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}) \\succeq \\mathbf{J}^{-1}$（在勒夫纳序下）。$x$ 的估计量方差的 CRLB 是 $\\mathbf{J}^{-1}$ 的第一个对角元素。\n$$\n\\det(\\mathbf{J}) = \\left(\\frac{1}{9}\\right)^2 (325 \\times 1000 - 100 \\times 100) = \\frac{1}{81} (325000 - 10000) = \\frac{315000}{81}\n$$\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} J_{22} & -J_{12} \\\\ -J_{21} & J_{11} \\end{pmatrix} = \\frac{81}{315000} \\frac{1}{9} \\begin{pmatrix} 1000 & -100 \\\\ -100 & 325 \\end{pmatrix} = \\frac{9}{315000} \\begin{pmatrix} 1000 & -100 \\\\ -100 & 325 \\end{pmatrix}\n$$\n$x$ 的 CRLB，我们记为 $V_{\\text{CRLB}}$，是 $\\mathbf{J}^{-1}$ 的 $(1,1)$ 元素：\n$$\nV_{\\text{CRLB}} = (\\mathbf{J}^{-1})_{11} = \\frac{9 \\times 1000}{315000} = \\frac{9000}{315000} = \\frac{9}{315} = \\frac{1}{35}\n$$\n\n**步骤 2：非加权最小二乘估计量的方差**\n\n非加权 LS 估计量由 $\\hat{\\boldsymbol{\\theta}}_{\\text{LS}} = \\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}\\mathbf{H}^{\\top}\\mathbf{z}$ 给出。我们需要在真实噪声协方差 $\\mathbf{R}$ 下求出该估计量的协方差。随机向量 $\\mathbf{z}$ 的线性变换 $\\mathbf{A}\\mathbf{z}$ 的协方差为 $\\mathbf{A}\\operatorname{Cov}(\\mathbf{z})\\mathbf{A}^{\\top}$。在此，$\\mathbf{A} = \\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}\\mathbf{H}^{\\top}$ 且 $\\operatorname{Cov}(\\mathbf{z})=\\mathbf{R}$。\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}\\mathbf{H}^{\\top} \\mathbf{R} \\mathbf{H} \\left(\\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}\\right)^{\\top}\n$$\n由于 $\\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}$ 是对称的，上式可简化为：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1} \\left(\\mathbf{H}^{\\top}\\mathbf{R}\\mathbf{H}\\right) \\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1}\n$$\n首先，我们计算各个组成部分：\n$$\n\\mathbf{H}^{\\top}\\mathbf{H} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n$$\n\\left(\\mathbf{H}^{\\top}\\mathbf{H}\\right)^{-1} = \\frac{1}{2 \\cdot 2 - 1 \\cdot 1} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n接下来，我们计算 $\\mathbf{H}^{\\top}\\mathbf{R}\\mathbf{H}$：\n$$\n\\mathbf{H}^{\\top}\\mathbf{R}\\mathbf{H} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/25 & 0 & 0 \\\\ 0 & 1/100 & 0 \\\\ 0 & 0 & 9/100 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{H}^{\\top}\\mathbf{R}\\mathbf{H} = \\frac{1}{100} \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 4 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 9 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\frac{1}{100} \\begin{pmatrix} 4 & 0 & 9 \\\\ 0 & 1 & 9 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{H}^{\\top}\\mathbf{R}\\mathbf{H} = \\frac{1}{100} \\begin{pmatrix} 4+9 & 9 \\\\ 9 & 1+9 \\end{pmatrix} = \\frac{1}{100} \\begin{pmatrix} 13 & 9 \\\\ 9 & 10 \\end{pmatrix}\n$$\n现在组装完整的协方差矩阵：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\frac{1}{100} \\begin{pmatrix} 13 & 9 \\\\ 9 & 10 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\frac{1}{900} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} 13 & 9 \\\\ 9 & 10 \\end{pmatrix} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\frac{1}{900} \\begin{pmatrix} 2(13)-1(9) & 2(9)-1(10) \\\\ -1(13)+2(9) & -1(9)+2(10) \\end{pmatrix} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{1}{900} \\begin{pmatrix} 17 & 8 \\\\ 5 & 11 \\end{pmatrix} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_{\\text{LS}}) = \\frac{1}{900} \\begin{pmatrix} 17(2)+8(-1) & 17(-1)+8(2) \\\\ 5(2)+11(-1) & 5(-1)+11(2) \\end{pmatrix} = \\frac{1}{900} \\begin{pmatrix} 26 & -1 \\\\ -1 & 17 \\end{pmatrix}\n$$\n$x$ 的 LS 估计量的方差，记为 $V_{\\text{LS}}$，是该矩阵的 $(1,1)$ 元素：\n$$\nV_{\\text{LS}} = \\operatorname{Var}(\\hat{x}_{\\text{LS}}) = \\frac{26}{900}\n$$\n\n**步骤 3：计算比值**\n\n最后一步是计算比值 $r = \\frac{V_{\\text{LS}}}{V_{\\text{CRLB}}}$。\n$$\nr = \\frac{26/900}{1/35} = \\frac{26}{900} \\times 35 = \\frac{26 \\times 35}{900}\n$$\n分子为 $26 \\times 35 = 910$。\n$$\nr = \\frac{910}{900} = \\frac{91}{90}\n$$\n该比值表示非加权 LS 估计量相对于无偏估计量的理论最佳性能的效率。由于 LS 估计量没有考虑噪声的异方差性（即方差不相等），因此它是次优的，并且其方差严格大于 CRLB，所以 $r > 1$，这与我们的结果一致。",
            "answer": "$$\\boxed{\\frac{91}{90}}$$"
        }
    ]
}