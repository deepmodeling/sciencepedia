{
    "hands_on_practices": [
        {
            "introduction": "Understanding the limits of stability is a cornerstone of controller design. The root locus plot provides a powerful visual for how closed-loop poles move as gain increases, and a critical feature of this plot is where it crosses the imaginary axis. This exercise  guides you through a fundamental, first-principles calculation to pinpoint the exact frequency of this crossing, which marks the onset of instability and corresponds to sustained oscillations in the system.",
            "id": "4242034",
            "problem": "A digital twin (DT) of a cyber-physical system (CPS) models an inner-loop actuator dynamics used for torque regulation under unity feedback with a proportional controller of gain $K$. The DT-identified open-loop transfer function is\n$$\nG(s) \\;=\\; \\frac{s + 8}{s \\,(s + 1)\\,(s + 4)}.\n$$\nUsing the closed-loop characteristic equation for unity feedback, derive from first principles the condition under which a conjugate pair of closed-loop poles lies on the imaginary axis, and determine the smallest positive angular frequency $\\omega$ (in radians per second) at which this occurs. Treat $K$ as an unknown constant to be eliminated during the derivation. Round your final numerical value of $\\omega$ to four significant figures and express it in radians per second.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- System configuration: Unity feedback control.\n- Controller: Proportional controller with gain $K$.\n- Open-loop plant transfer function: $G(s) = \\frac{s + 8}{s(s + 1)(s + 4)}$.\n- Objective: Derive the condition for a conjugate pair of closed-loop poles on the imaginary axis and find the corresponding smallest positive angular frequency $\\omega$.\n- Constraint: The derivation must eliminate the gain $K$.\n- Final answer precision: Round $\\omega$ to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is set within the standard framework of classical control theory. The provided open-loop transfer function is a rational function of the complex variable $s$, which is a standard representation for linear time-invariant (LTI) systems. The task of finding the frequency at which the closed-loop poles cross the imaginary axis (the point of marginal stability) is a fundamental problem in stability analysis, often solved using the Routh-Hurwitz criterion or by analyzing the root locus. The context of a \"digital twin\" and \"cyber-physical system\" serves as a modern application scenario but does not alter the underlying mathematical principles. The problem is self-contained, with all necessary information provided to derive the characteristic equation and solve for the unknown frequency. There are no scientific or logical contradictions, no ambiguities, and the premises are physically plausible for an actuator model. The problem is therefore deemed **valid**.\n\n**Step 3: Derivation and Solution**\nThe system consists of a proportional controller with gain $K$ and a plant with transfer function $G(s)$ in a unity feedback loop. The total open-loop transfer function of the system is $L(s) = K \\cdot G(s)$.\n$$\nL(s) = K \\frac{s + 8}{s(s + 1)(s + 4)}\n$$\nFor a unity feedback system, the closed-loop transfer function $T(s)$ is given by:\n$$\nT(s) = \\frac{L(s)}{1 + L(s)}\n$$\nThe closed-loop poles are the roots of the characteristic equation, which is obtained by setting the denominator of the closed-loop transfer function to zero:\n$$\n1 + L(s) = 0\n$$\nSubstituting the expression for $L(s)$:\n$$\n1 + K \\frac{s + 8}{s(s + 1)(s + 4)} = 0\n$$\nTo clear the fraction, we multiply by the denominator, yielding the characteristic equation in polynomial form:\n$$\ns(s + 1)(s + 4) + K(s + 8) = 0\n$$\nExpanding the polynomial terms:\n$$\ns(s^2 + 4s + s + 4) + Ks + 8K = 0\n$$\n$$\ns(s^2 + 5s + 4) + Ks + 8K = 0\n$$\n$$\ns^3 + 5s^2 + 4s + Ks + 8K = 0\n$$\nThe final form of the characteristic equation is:\n$$\ns^3 + 5s^2 + (4 + K)s + 8K = 0\n$$\nThe problem asks for the condition under which a conjugate pair of poles lies on the imaginary axis. Such poles take the form $s = j\\omega$ and $s = -j\\omega$, where $\\omega$ is a real, positive angular frequency. This corresponds to the system being on the verge of instability, exhibiting sustained oscillations. To find this condition, we substitute $s = j\\omega$ into the characteristic equation:\n$$\n(j\\omega)^3 + 5(j\\omega)^2 + (4 + K)(j\\omega) + 8K = 0\n$$\nUsing the property $j^2 = -1$, we simplify the powers of $j$:\n$$\n-j\\omega^3 - 5\\omega^2 + j(4 + K)\\omega + 8K = 0\n$$\nFor this complex equation to be true, both its real and imaginary parts must be equal to zero. We group the terms accordingly:\n$$\n(\\text{Real Part}) + j(\\text{Imaginary Part}) = 0\n$$\n$$\n(-5\\omega^2 + 8K) + j(-\\omega^3 + (4 + K)\\omega) = 0\n$$\nThis gives us a system of two equations with two unknowns, $K$ and $\\omega$:\n1. Real part equals zero: $-5\\omega^2 + 8K = 0$\n2. Imaginary part equals zero: $-\\omega^3 + (4 + K)\\omega = 0$\n\nThe problem requires us to find $\\omega$ by eliminating $K$. From the second equation, we can factor out $\\omega$:\n$$\n\\omega(-\\omega^2 + 4 + K) = 0\n$$\nSince we are looking for the smallest *positive* angular frequency, we can assume $\\omega \\neq 0$. Thus, we can divide by $\\omega$ to get:\n$$\n-\\omega^2 + 4 + K = 0\n$$\nThis gives an expression for $K$:\n$$\nK = \\omega^2 - 4\n$$\nNow, we use the first equation from our system:\n$$\n-5\\omega^2 + 8K = 0\n$$\nSubstitute the expression for $K$ into this equation to eliminate it:\n$$\n-5\\omega^2 + 8(\\omega^2 - 4) = 0\n$$\nNow we solve this equation for $\\omega$:\n$$\n-5\\omega^2 + 8\\omega^2 - 32 = 0\n$$\n$$\n3\\omega^2 = 32\n$$\n$$\n\\omega^2 = \\frac{32}{3}\n$$\nTaking the positive square root to find the smallest positive angular frequency:\n$$\n\\omega = \\sqrt{\\frac{32}{3}}\n$$\nTo provide the final answer, we compute the numerical value and round it to four significant figures.\n$$\n\\omega = \\sqrt{\\frac{32}{3}} \\approx \\sqrt{10.6666...} \\approx 3.265986...\n$$\nRounding to four significant figures, we get:\n$$\n\\omega \\approx 3.266 \\text{ rad/s}\n$$",
            "answer": "$$\\boxed{3.266}$$"
        },
        {
            "introduction": "While root locus techniques are powerful for nominal models, a key challenge in designing controllers for real-world cyber-physical systems is ensuring they are robust to model uncertainty. A common but perilous design strategy is to cancel an unstable plant pole with a controller zero, which can make the nominal system appear deceptively stable. This thought experiment  reveals the profound fragility of this approach, demonstrating how a minuscule discrepancy between the digital twin model and the physical plant can lead to instability, regardless of controller gain.",
            "id": "4242063",
            "problem": "A cyber-physical system (CPS) axis is represented in a digital twin by the nominal single-input single-output plant $P_{n}(s) = \\dfrac{1}{(s - 0.50)(s + 2)}$, which has one unstable pole at $s = +0.50$ due to an internal positive feedback loop and one stable pole at $s = -2$. A controller engineer proposes to cancel the unstable nominal pole using a proportional-derivative structure $C(s) = K(s - 0.50)$ and to use unity feedback. The resulting nominal loop transfer function is $L_{n}(s) = C(s)P_{n}(s) = \\dfrac{K(s - 0.50)}{(s - 0.50)(s + 2)}$. The digital twin suggests that the cancellation in $C(s)$ simplifies the nominal root locus and yields a large phase margin in the nominal frequency response.\n\nHowever, the physical plant has an uncertainty in the unstable pole location due to thermal drift and actuator saturation, modeled as $P_{a}(s) = \\dfrac{1}{(s - 0.55)(s + 2)}$ when the true unstable pole is at $s = +0.55$ while the controller zero remains at $s = +0.50$. For unity feedback, the actual loop is $L_{a}(s) = \\dfrac{K(s - 0.50)}{(s - 0.55)(s + 2)}$.\n\nBased on root locus and frequency-response fundamentals for cyber-physical systems and digital twins, which of the following statements are correct? Select all that apply.\n\nA. With exact cancellation in $C(s)$, the nominal root locus reduces to a single real pole and the nominal closed-loop is stable for all $K  0$; therefore, the design is robust to small errors in the canceled pole position.\n\nB. If the actual unstable plant pole is at $s = +0.55$ while the controller zero is at $s = +0.50$, then for unity feedback the actual closed-loop characteristic polynomial has one positive real root for all $K \\ge 0$, implying closed-loop instability regardless of gain.\n\nC. The Nyquist plot of $L_{n}(j\\omega)$ has a large phase margin; therefore, the actual system with $P_{a}(s)$ remains stable provided $K$ is sufficiently large.\n\nD. The complementary sensitivity function $T(s) = \\dfrac{L(s)}{1 + L(s)}$ must be kept small near the frequency associated with the canceled dynamics to ensure robust stability under multiplicative uncertainty; exact pole-zero cancellation in $C(s)$ tends to increase fragility because it removes stabilizing roll-off around uncertain dynamics.",
            "solution": "The core of this problem lies in the consequences of attempting to cancel a right-half-plane (RHP) pole with a RHP zero.\n\n**Analysis of the Nominal System (with exact cancellation)**\n\nThe nominal loop transfer function is $L_{n}(s) = \\dfrac{K(s - 0.50)}{(s - 0.50)(s + 2)}$. A common mistake is to algebraically cancel the $(s - 0.50)$ terms, yielding a simplified transfer function $L_{n, \\text{simplified}}(s) = \\dfrac{K}{s + 2}$. However, this cancellation is not permissible when analyzing internal stability. The state associated with the unstable pole at $s=0.50$ becomes either unobservable from the output or uncontrollable from the input, but it still exists within the system.\n\nThe stability of the closed-loop system is determined by the roots of the characteristic equation, $1 + L_{n}(s) = 0$.\n$$1 + \\frac{K(s - 0.50)}{(s - 0.50)(s + 2)} = 0$$\nTo find the roots, we find the zeros of the numerator of $1 + L_n(s)$:\n$$(s - 0.50)(s + 2) + K(s - 0.50) = 0$$\nFactoring out the $(s - 0.50)$ term:\n$$(s - 0.50)[(s + 2) + K] = 0$$\nThe roots of the characteristic equation (i.e., the closed-loop poles) are $s_1 = 0.50$ and $s_2 = -2 - K$.\nSince one of the closed-loop poles, $s_1 = 0.50$, is in the RHP, the nominal closed-loop system is **unstable** for any value of $K$. This is a fundamental result: canceling an unstable pole with a zero leads to internal instability.\n\n**Analysis of the Actual System (with imperfect cancellation)**\n\nThe actual loop transfer function is $L_{a}(s) = \\dfrac{K(s - 0.50)}{(s - 0.55)(s + 2)}$.\nThe actual closed-loop characteristic equation is $1 + L_{a}(s) = 0$.\n$$1 + \\frac{K(s - 0.50)}{(s - 0.55)(s + 2)} = 0$$\n$$(s - 0.55)(s + 2) + K(s - 0.50) = 0$$\nExpanding this polynomial:\n$$s^2 + (2 - 0.55)s - (0.55)(2) + Ks - 0.50K = 0$$\n$$s^2 + (1.45 + K)s - (1.1 + 0.50K) = 0$$\nLet the roots of this quadratic polynomial be $s_1$ and $s_2$. According to Vieta's formulas, the product of the roots is given by the constant term:\n$$s_1 s_2 = -(1.1 + 0.50K)$$\nFor any gain $K \\ge 0$, the term $(1.1 + 0.50K)$ is positive. Therefore, the product of the roots $s_1 s_2$ is always negative.\nIf the product of two numbers is negative, one must be positive and the other must be negative. Since the coefficients of the polynomial are real, the roots must be real. Thus, for any $K \\ge 0$, the actual closed-loop system has one positive real pole and one negative real pole. The presence of a positive real pole (a pole in the RHP) means the actual closed-loop system is **unstable** for all gains $K \\ge 0$.\n\nNow we evaluate each option.\n\n**A. With exact cancellation in $C(s)$, the nominal root locus reduces to a single real pole and the nominal closed-loop is stable for all $K  0$; therefore, the design is robust to small errors in the canceled pole position.**\n\nThis statement is based on the incorrect simplification of $L_n(s)$ to $\\dfrac{K}{s+2}$. Based on this simplification, the closed-loop pole would be at $s=-2-K$, which is stable for all $K0$. However, as shown in our analysis, the correct characteristic equation for the nominal system yields closed-loop poles at $s=0.50$ and $s=-2-K$. The pole at $s=0.50$ makes the system internally unstable. Therefore, the premise \"the nominal closed-loop is stable for all $K  0$\" is false. Consequently, the conclusion that the \"design is robust\" is also false. In fact, such a design is known to be exceedingly fragile.\n\n**Verdict: Incorrect.**\n\n**B. If the actual unstable plant pole is at $s = +0.55$ while the controller zero is at $s = +0.50$, then for unity feedback the actual closed-loop characteristic polynomial has one positive real root for all $K \\ge 0$, implying closed-loop instability regardless of gain.**\n\nOur analysis of the actual system led to the characteristic polynomial $s^2 + (1.45 + K)s - (1.1 + 0.50K) = 0$. We demonstrated that for any $K \\ge 0$, the product of the roots is $s_1 s_2 = -(1.1 + 0.50K)  0$. This forces one root to be a positive real number and the other to be a negative real number. A positive real root guarantees instability. The statement is a precise and accurate description of the actual system's behavior.\n\n**Verdict: Correct.**\n\n**C. The Nyquist plot of $L_{n}(j\\omega)$ has a large phase margin; therefore, the actual system with $P_{a}(s)$ remains stable provided $K$ is sufficiently large.**\n\nThe claim of a \"large phase margin\" comes from analyzing the simplified (and incorrect) nominal loop transfer function $L_{n, \\text{simplified}}(s) = \\dfrac{K}{s + 2}$. This is a first-order system whose phase never drops below $-90^\\circ$, resulting in a phase margin always greater than $90^\\circ$. However, the Nyquist Stability Criterion must be applied to the un-simplified open-loop system. The open-loop transfer function $P_n(s)$ has one RHP pole ($P=1$). For closed-loop stability, the Nyquist plot of $L_n(s)$ must encircle the point $-1+j0$ one time in the counter-clockwise direction ($N=-1$, assuming the standard system definition where $N=Z-P$, although many texts use $N=P-Z$, requiring a clockwise encirclement. The result is the same: $N \\neq 0$). The plot for the simplified system, $K/(s+2)$, is a semi-circle in the fourth quadrant and does not encircle $-1$ at all ($N=0$). Since $N \\neq P$, the nominal system is unstable, despite the misleading \"large phase margin\" of the simplified model. The premise is misleading, and the conclusion is false, as we proved in the analysis for option B that the actual system is unstable for all $K \\ge 0$.\n\n**Verdict: Incorrect.**\n\n**D. The complementary sensitivity function $T(s) = \\dfrac{L(s)}{1 + L(s)}$ must be kept small near the frequency associated with the canceled dynamics to ensure robust stability under multiplicative uncertainty; exact pole-zero cancellation in $C(s)$ tends to increase fragility because it removes stabilizing roll-off around uncertain dynamics.**\n\nThis statement addresses the issue from a robust control perspective. The condition for robust stability against multiplicative uncertainty $\\Delta_m(s)$ is $|T(j\\omega)| |\\Delta_m(j\\omega)|  1$ for all $\\omega$. This implies that where uncertainty is large (i.e., $|\\Delta_m(j\\omega)|$ is large), the magnitude of the complementary sensitivity function, $|T(j\\omega)|$, must be small. Uncertainty about an unstable pole at $s=p_u$ implies large uncertainty around the corresponding frequency $\\omega \\approx |p_u|$. In our case, this is near $\\omega = 0.5$ rad/s.\n\nLet's examine $T_a(s)$ for the actual system, particularly for large $K$, near the pole we tried to cancel.\n$$T_a(s) = \\frac{L_a(s)}{1+L_a(s)} = \\frac{\\frac{K(s - 0.50)}{(s - 0.55)(s + 2)}}{1 + \\frac{K(s - 0.50)}{(s - 0.55)(s + 2)}} = \\frac{K(s - 0.50)}{(s - 0.55)(s + 2) + K(s - 0.50)}$$\nFor large $K$, the terms involving $K$ dominate the denominator. Therefore, for $s$ not equal to $0.50$:\n$$T_a(s) \\approx \\frac{K(s - 0.50)}{K(s - 0.50)} = 1$$\nThis holds true for frequencies around $\\omega=0.5$ rad/s. Having $|T(j\\omega)| \\approx 1$ is the worst-case scenario for robustness, as it allows for no multiplicative uncertainty. The pole-zero cancellation strategy actively works to make $|T(j\\omega)|$ large (close to $1$) near the critical frequency, which is the exact opposite of what is required for robustness. The statement correctly identifies that this fragility arises because the controller's zero $C(s)=K(s-0.50)$ adds gain with increasing frequency, counteracting the plant's natural roll-off and preventing the loop gain $L(s)$ from becoming small. This is a classic and correct explanation of the fragility of RHP pole cancellation.\n\n**Verdict: Correct.**",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "After understanding the conceptual danger of non-robust designs, we now turn to a modern, quantitative method for analyzing and certifying robustness. This is especially critical for digital twins, which must be validated against real-world uncertainties. This hands-on coding practice  introduces the structured singular value ($\\mu$) to evaluate a controller's resilience to specific, structured model errors, such as unmodeled high-frequency dynamics and low-frequency sensor drift, allowing you to identify exactly where your model may need more fidelity.",
            "id": "4242005",
            "problem": "A cyber-physical system is represented by a low-order digital twin model whose nominal continuous-time plant is modeled as a mass–spring–damper with transfer function $G_0(s) = \\frac{1}{m s^2 + b s + k}$, where $m$, $b$, and $k$ are strictly positive real constants, and $s$ denotes the Laplace variable. The digital twin is controlled by a proper Proportional–Derivative (PD) controller with a first-order roll-off, $C(s) = K \\frac{s + z}{s + \\omega_d}$, where $K  0$, $z  0$, and $\\omega_d  0$. The open-loop transfer function is $L(s) = C(s) G_0(s)$. The closed-loop sensitivity and complementary sensitivity are defined by $S(s) = \\frac{1}{1 + L(s)}$ and $T(s) = \\frac{L(s)}{1 + L(s)}$, respectively.\n\nTo capture model discrepancy for validation, two structured scalar complex uncertainties are considered:\n\n- A multiplicative output uncertainty weighted by $W_m(s) = \\alpha \\frac{s}{\\omega_h + s}$, which grows at high frequency and is parameterized by strictly positive real constants $\\alpha$ and $\\omega_h$.\n- A sensor drift uncertainty weighted by $W_p(s) = \\beta \\frac{\\omega_\\ell}{s + \\omega_\\ell}$, which emphasizes low-frequency bias and is parameterized by strictly positive real constants $\\beta$ and $\\omega_\\ell$.\n\nAssume a block-diagonal uncertainty structure $\\Delta = \\mathrm{diag}(\\delta_m, \\delta_p)$, where $\\delta_m, \\delta_p \\in \\mathbb{C}$ are independent scalar uncertainties. The corresponding frequency-domain interconnection defining the worst-case effect of uncertainties on the closed loop can be expressed via the $2 \\times 2$ diagonal transfer matrix\n$$\nM(j\\omega) = \\mathrm{diag}\\!\\big( T(j\\omega) W_m(j\\omega),\\; S(j\\omega) W_p(j\\omega) \\big),\n$$\nwhere $\\omega$ is the angular frequency in $\\mathrm{rad/s}$ and $j$ is the imaginary unit. The structured singular value (worst-case $\\mu$) for this diagonal, scalar-block structure reduces to\n$$\n\\mu\\!\\big(M(j\\omega)\\big) = \\max\\!\\Big( \\big|T(j\\omega) W_m(j\\omega)\\big|,\\; \\big|S(j\\omega) W_p(j\\omega)\\big| \\Big).\n$$\nThis quantity provides a frequency-dependent certificate of worst-case amplification by the uncertainty structure. Robust stability with respect to the modeled structure is guaranteed if and only if $\\sup_{\\omega \\ge 0} \\mu\\!\\big(M(j\\omega)\\big)  1$.\n\nYour task is to implement a program that, for a given set of parameters, evaluates $\\mu\\!\\big(M(j\\omega)\\big)$ over a specified logarithmically spaced frequency grid and uses it to identify frequency ranges where higher-fidelity dynamics are required for validation of the digital twin model. For this purpose, define a caution threshold $\\theta \\in (0, 1)$: any frequency where $\\mu\\!\\big(M(j\\omega)\\big) \\ge \\theta$ is marked as requiring higher-fidelity modeling. Also, flag robust instability if $\\mu\\!\\big(M(j\\omega)\\big) \\ge 1$ at any frequency.\n\nStarting from the fundamental definitions above, compute for each test case:\n- The peak value $\\,\\mu_{\\max} = \\max_{\\omega} \\mu\\!\\big(M(j\\omega)\\big)$.\n- The frequency $\\,\\omega_{\\max}$ (in $\\mathrm{rad/s}$) where the peak occurs.\n- A boolean robust stability flag defined by whether $\\,\\mu_{\\max}  1$.\n- The integer count of frequency grid points where $\\,\\mu\\!\\big(M(j\\omega)\\big) \\ge \\theta$.\n\nAll floating-point outputs must be rounded to six decimal places. Frequency must be expressed in $\\mathrm{rad/s}$.\n\nUse the following test suite of parameter values:\n- Test case $1$ (happy path):\n    - Plant: $m = 1.0$, $b = 0.8$, $k = 4.0$.\n    - Controller: $K = 3.0$, $z = 1.0$, $\\omega_d = 50.0$.\n    - Weights: $\\alpha = 0.8$, $\\omega_h = 15.0$, $\\beta = 0.4$, $\\omega_\\ell = 0.5$.\n    - Grid: $\\omega_{\\min} = 0.01$, $\\omega_{\\max} = 200.0$, $N = 1000$ points logarithmically spaced.\n    - Threshold: $\\theta = 0.7$.\n- Test case $2$ (near-boundary robust instability):\n    - Plant: $m = 1.0$, $b = 0.8$, $k = 4.0$.\n    - Controller: $K = 25.0$, $z = 2.0$, $\\omega_d = 30.0$.\n    - Weights: $\\alpha = 1.2$, $\\omega_h = 8.0$, $\\beta = 0.6$, $\\omega_\\ell = 0.6$.\n    - Grid: $\\omega_{\\min} = 0.01$, $\\omega_{\\max} = 500.0$, $N = 1200$ points logarithmically spaced.\n    - Threshold: $\\theta = 0.7$.\n- Test case $3$ (low-gain edge case):\n    - Plant: $m = 1.2$, $b = 0.5$, $k = 3.0$.\n    - Controller: $K = 0.8$, $z = 0.5$, $\\omega_d = 20.0$.\n    - Weights: $\\alpha = 0.6$, $\\omega_h = 20.0$, $\\beta = 0.7$, $\\omega_\\ell = 0.3$.\n    - Grid: $\\omega_{\\min} = 0.01$, $\\omega_{\\max} = 200.0$, $N = 900$ points logarithmically spaced.\n    - Threshold: $\\theta = 0.8$.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list with four entries in the exact order $[\\mu_{\\max}, \\omega_{\\max}, \\text{robust\\_stable}, \\text{count\\_above\\_threshold}]$. For example, the output format is $[[a_1, b_1, c_1, d_1],[a_2, b_2, c_2, d_2],[a_3, b_3, c_3, d_3]]$, where $a_i$ and $b_i$ are floats rounded to six decimal places, $c_i$ is a boolean, and $d_i$ is an integer.",
            "solution": "The objective is to analyze the robust stability of a feedback control system representing a digital twin of a cyber-physical system. The analysis hinges on computing the structured singular value, $\\mu$, which provides a frequency-dependent measure of the worst-case performance degradation or instability risk due to modeled uncertainties.\n\nLet us begin by precisely defining the constituent components of the system.\n\nThe nominal plant is a second-order mass-spring-damper system with the transfer function:\n$$\nG_0(s) = \\frac{1}{m s^2 + b s + k}\n$$\nwhere $m$, $b$, and $k$ are the mass, damping coefficient, and spring constant, respectively. These are all strictly positive real numbers.\n\nThe plant is regulated by a Proportional-Derivative (PD) controller with a high-frequency roll-off. Its transfer function is:\n$$\nC(s) = K \\frac{s + z}{s + \\omega_d}\n$$\nwhere $K  0$ is the proportional gain, $z  0$ is the derivative zero, and $\\omega_d  0$ is the pole providing the roll-off.\n\nThe open-loop transfer function, $L(s)$, is the product of the controller and the plant:\n$$\nL(s) = C(s) G_0(s) = K \\frac{s + z}{(s + \\omega_d)(m s^2 + b s + k)}\n$$\n\nFrom the open-loop function, we derive two critical closed-loop transfer functions. The sensitivity function, $S(s)$, quantifies the closed-loop system's sensitivity to disturbances at the plant output. The complementary sensitivity function, $T(s)$, represents the closed-loop transfer function from the reference to the output and is crucial for analyzing the effects of multiplicative uncertainty. They are defined as:\n$$\nS(s) = \\frac{1}{1 + L(s)}\n$$\n$$\nT(s) = \\frac{L(s)}{1 + L(s)} = 1 - S(s)\n$$\n\nThe analysis accounts for two sources of model uncertainty, each bounded by a frequency-dependent weighting function:\n1.  A multiplicative output uncertainty, modeling unmodeled high-frequency dynamics, weighted by:\n    $$\n    W_m(s) = \\alpha \\frac{s}{\\omega_h + s}\n    $$\n2.  A sensor drift or bias uncertainty, modeling low-frequency measurement errors, weighted by:\n    $$\n    W_p(s) = \\beta \\frac{\\omega_\\ell}{s + \\omega_\\ell}\n    $$\nHere, $\\alpha, \\omega_h, \\beta, \\omega_\\ell$ are all strictly positive real constants that shape the frequency content of the uncertainty bounds.\n\nThe analysis is conducted in the frequency domain by setting the Laplace variable $s = j\\omega$, where $j$ is the imaginary unit and $\\omega$ is the angular frequency in $\\mathrm{rad/s}$. This transforms each transfer function into a complex-valued function of $\\omega$. For instance, for the plant:\n$$\nG_0(j\\omega) = \\frac{1}{(k - m\\omega^2) + j(b\\omega)}\n$$\nAll other transfer functions are evaluated similarly, yielding complex numbers at each frequency $\\omega$.\n\nThe problem specifies a diagonal uncertainty structure, $\\Delta = \\mathrm{diag}(\\delta_m, \\delta_p)$, where $\\delta_m$ and $\\delta_p$ are independent complex scalars. For this specific structure, the structured singular value, $\\mu$, simplifies from its general definition to the maximum of the magnitudes of the diagonal elements of the interconnection matrix $M(j\\omega)$. This yields the core quantity for our analysis:\n$$\n\\mu(M(j\\omega)) = \\max\\Big( \\big|T(j\\omega) W_m(j\\omega)\\big|, \\big|S(j\\omega) W_p(j\\omega)\\big| \\Big)\n$$\nThe first term, $|T(j\\omega) W_m(j\\omega)|$, is the robust stability metric for multiplicative uncertainty. The second term, $|S(j\\omega) W_p(j\\omega)|$, is a robust performance metric related to disturbance rejection under sensor uncertainty. The $\\mu$ value represents the worst-case amplification at a given frequency. Robust stability for the entire family of plants described by the uncertainty model is guaranteed if and only if $\\sup_{\\omega \\ge 0} \\mu(M(j\\omega))  1$.\n\nThe computational procedure to solve the problem for each test case is as follows:\n1.  Define all system parameters: $m, b, k, K, z, \\omega_d, \\alpha, \\omega_h, \\beta, \\omega_\\ell$.\n2.  Construct a logarithmically spaced frequency vector $\\omega$ of $N$ points, spanning the range $[\\omega_{\\min}, \\omega_{\\max}]$.\n3.  Vectorize the computation. For the entire frequency vector $\\omega$, calculate the corresponding complex vector $s = j\\omega$.\n4.  Evaluate the transfer functions $G_0(s), C(s), L(s), S(s), T(s), W_m(s), W_p(s)$ over this complex vector $s$, resulting in vectors of complex numbers.\n5.  Compute the magnitudes of the two components of the $\\mu$ function: term1 = $|T(j\\omega) W_m(j\\omega)|$ and term2 = $|S(j\\omega) W_p(j\\omega)|$. These operations are performed element-wise on the vectors.\n6.  Calculate the $\\mu$ value at each frequency by taking the element-wise maximum of the two component vectors: $\\mu_{\\text{values}} = \\max(\\text{term1}, \\text{term2})$.\n7.  From the resulting vector $\\mu_{\\text{values}}$:\n    a. Find the peak value $\\mu_{\\max} = \\max(\\mu_{\\text{values}})$.\n    b. Identify the frequency $\\omega_{\\max}$ at which this peak occurs.\n    c. Determine the robust stability status: a boolean flag which is true if $\\mu_{\\max}  1$.\n    d. Count the number of frequency grid points where $\\mu_{\\text{values}} \\ge \\theta$, where $\\theta$ is the specified caution threshold.\n8.  Collect these four results, rounding the floating-point values as required, into a list for the given test case. This procedure is repeated for all test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_case(params):\n    \"\"\"\n    Evaluates robust stability metrics for a single set of system parameters.\n\n    Args:\n        params (tuple): A tuple containing all parameters for a test case.\n\n    Returns:\n        list: A list containing [mu_max, omega_max, robust_stable, count_above_threshold].\n    \"\"\"\n    # Unpack parameters from the input tuple\n    m, b, k, K, z, wd, alpha, wh, beta, wl, w_min, w_max, N, theta = params\n\n    # 1. Create a logarithmically spaced frequency grid\n    omega = np.logspace(np.log10(w_min), np.log10(w_max), N)\n    s = 1j * omega\n\n    # 2. Evaluate all transfer functions in the frequency domain\n    # Plant G0(s)\n    G0_jw = 1.0 / (m * s**2 + b * s + k)\n    \n    # Controller C(s)\n    C_jw = K * (s + z) / (s + wd)\n    \n    # Open-loop L(s) = C(s)G0(s)\n    L_jw = C_jw * G0_jw\n    \n    # Sensitivity S(s) and Complementary Sensitivity T(s)\n    S_jw = 1.0 / (1.0 + L_jw)\n    T_jw = L_jw / (1.0 + L_jw)\n    \n    # Uncertainty weights Wm(s) and Wp(s)\n    Wm_jw = alpha * s / (wh + s)\n    Wp_jw = beta * wl / (s + wl)\n    \n    # 3. Calculate the two terms for mu analysis\n    # |T(jw) * Wm(jw)|\n    mu_term_T = np.abs(T_jw * Wm_jw)\n    # |S(jw) * Wp(jw)|\n    mu_term_S = np.abs(S_jw * Wp_jw)\n    \n    # 4. Compute mu as the maximum of the two terms at each frequency\n    mu_values = np.maximum(mu_term_T, mu_term_S)\n    \n    # 5. Extract the required metrics from the mu_values vector\n    # Peak value of mu\n    mu_max = np.max(mu_values)\n    \n    # Frequency at which the peak occurs\n    max_idx = np.argmax(mu_values)\n    omega_max = omega[max_idx]\n    \n    # Robust stability flag (mu_max  1)\n    robust_stable = mu_max  1.0\n    \n    # Integer count of frequency points where mu = theta\n    count_above_threshold = np.sum(mu_values = theta)\n\n    # 6. Format the results as specified\n    return [round(mu_max, 6), round(omega_max, 6), robust_stable, int(count_above_threshold)]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: m, b, k, K, z, wd, alpha, wh, beta, wl, w_min, w_max, N, theta\n        (1.0, 0.8, 4.0, 3.0, 1.0, 50.0, 0.8, 15.0, 0.4, 0.5, 0.01, 200.0, 1000, 0.7),\n        # Case 2\n        (1.0, 0.8, 4.0, 25.0, 2.0, 30.0, 1.2, 8.0, 0.6, 0.6, 0.01, 500.0, 1200, 0.7),\n        # Case 3\n        (1.2, 0.5, 3.0, 0.8, 0.5, 20.0, 0.6, 20.0, 0.7, 0.3, 0.01, 200.0, 900, 0.8),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() function on a list and boolean produces the correct representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}