{
    "hands_on_practices": [
        {
            "introduction": "The Nyquist stability criterion is fundamentally about counting how many times the open-loop frequency response plot, $L(j\\omega)$, encircles the critical point $-1$. This exercise provides a practical, algorithmic method for determining this count, $N$, by simply tracking when and how the plot crosses the negative real axis. Developing this skill is essential for a robust interpretation of Nyquist diagrams, allowing for a quick and accurate stability assessment directly from the plot's geometry. ",
            "id": "4234124",
            "problem": "A cyber-physical system (CPS) deploys a Digital Twin (DT) that continuously monitors the loop transfer function $L(s)$ of a networked control system to assess closed-loop stability in real time. The DT uses the Nyquist method, where the Nyquist plot of $L(j\\omega)$ is traversed for increasing frequency $\\omega$ over the standard Nyquist contour, and the net number $N$ of clockwise encirclements of the point $-1$ determines stability via the classical Nyquist criterion. Assume $L(s)$ is a real-rational function with no poles on the imaginary axis, and that the standard Nyquist contour and its mapping are used. The DT must compute $N$ quickly by tracking the events at which the Nyquist plot crosses the real axis and by counting how those crossings segment loops around $-1$, with a consistent sign convention for each loop.\n\nThe DT labels each real-axis crossing by the pair $(x,\\text{dir})$, where $x=\\operatorname{Re}\\{L(j\\omega_c)\\}$ is the real part of the crossing location and $\\text{dir}\\in\\{\\text{up},\\text{down}\\}$ indicates whether $\\operatorname{Im}\\{L(j\\omega)\\}$ increases ($\\text{up}$) or decreases ($\\text{down}$) with $\\omega$ through the crossing. The DT only treats crossings that satisfy $x-1$ as relevant to potential encirclements of $-1$ and ignores all crossings with $x\\ge -1$.\n\nWhich option best specifies a correct algorithm for computing $N$ from this crossing log, including the sign convention for each loop? As a check, apply your chosen method to the following crossing log recorded over $\\omega\\in(0,\\infty)$:\n- $\\left(-2.4,\\ \\text{up}\\right)$\n- $\\left(-1.3,\\ \\text{down}\\right)$\n- $\\left(-0.7,\\ \\text{up}\\right)$\n- $\\left(-3.1,\\ \\text{down}\\right)$\n\nChoose one:\n\nA. Define $U$ as the number of $\\text{up}$ crossings with $x-1$ and $D$ as the number of $\\text{down}$ crossings with $x-1$. Compute $N=U-D$, and interpret $N0$ as a net counterclockwise encirclement count.\n\nB. Define $U$ as the number of $\\text{up}$ crossings with $x-1$ and $D$ as the number of $\\text{down}$ crossings with $x-1$. Compute $N=D-U$, and interpret $N0$ as a net clockwise encirclement count.\n\nC. Compute $N$ as the total number of real-axis crossings with $x-1$, regardless of $\\text{dir}$, and interpret $N0$ as a net clockwise encirclement count.\n\nD. Compute $N$ as the number of $\\text{up}$ crossings with $x-1$ only; treat $\\text{down}$ crossings as non-contributing because the lower half-plane branch cancels them.\n\nE. Define $U$ and $D$ as in A and B, but compute $N=\\dfrac{D-U}{2}$ to compensate for the negative-frequency branch, and interpret $N0$ as a net clockwise encirclement count.\n\nYour answer must be a single choice. For the check dataset above, report the value of $N$ implied by the method in your chosen option as part of your reasoning in the solution.",
            "solution": "The number of encirclements of the point $-1$ by the full Nyquist plot can be determined by analyzing the crossings of the negative real axis for the positive frequency range, $\\omega \\in (0, \\infty)$. Let's analyze the contribution of each type of crossing to the total number of clockwise encirclements, $N$.\n\n1.  A **\"down\" crossing** at a point $x  -1$ means the locus moves from the upper half-plane to the lower half-plane. This corresponds to a half-turn (π radians) in the clockwise direction around the point $-1$.\n2.  An **\"up\" crossing** at a point $x  -1$ means the locus moves from the lower half-plane to the upper half-plane. This corresponds to a half-turn (π radians) in the counter-clockwise direction around the point $-1$.\n\nFor the positive-frequency portion of the plot, each \"down\" crossing contributes $+1/2$ to the clockwise encirclement count, and each \"up\" crossing contributes $-1/2$. If $D$ is the count of \"down\" crossings and $U$ is the count of \"up\" crossings (both for $x-1$), the net encirclement count for $\\omega \\in (0, \\infty)$ is $(D-U)/2$.\n\nSince the transfer function $L(s)$ is real-rational, the Nyquist plot for negative frequencies ($\\omega  0$) is the complex conjugate of the plot for positive frequencies. This means the negative-frequency branch contributes an identical number of encirclements. The total number of clockwise encirclements, $N$, for the full contour is therefore twice the count from the positive-frequency branch:\n\n$N = 2 \\times \\frac{D-U}{2} = D - U$\n\nA positive result for $N$ indicates a net clockwise encirclement. This corresponds to Option B.\n\nApplying this algorithm to the check dataset:\n-   Log: $\\left(-2.4,\\ \\text{up}\\right)$, $\\left(-1.3,\\ \\text{down}\\right)$, $\\left(-0.7,\\ \\text{up}\\right)$, $\\left(-3.1,\\ \\text{down}\\right)$\n-   First, filter for crossings with $x  -1$: $\\left(-2.4,\\ \\text{up}\\right)$, $\\left(-1.3,\\ \\text{down}\\right)$, $\\left(-3.1,\\ \\text{down}\\right)$. The crossing at $-0.7$ is ignored.\n-   Count the relevant crossings: $U=1$ and $D=2$.\n-   Compute the total number of clockwise encirclements: $N = D - U = 2 - 1 = 1$.\nThe result is 1 net clockwise encirclement.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Stability margins are not merely abstract indicators; they are tangible measures of a system's robustness that can be directly linked to physical limitations. This practice problem builds that connection by guiding you to derive the relationship between a system's phase margin (PM) and the maximum time delay, $\\tau_{\\max}$, it can tolerate before becoming unstable. This analysis is particularly crucial in the design of modern cyber-physical systems, where network-induced delays are a common and critical source of instability. ",
            "id": "4234157",
            "problem": "A networked Cyber-Physical System (CPS) employing unity feedback operates over a shared communication fabric. Its Digital Twin (DT) provides the open-loop frequency response of the plant-controller composite, denoted by $L(s)$, under nominal (zero-delay) conditions. The DT reports a unity gain crossover at angular frequency $\\omega_{c} = 37\\,\\mathrm{rad/s}$ and an open-loop phase at crossover of $-150^{\\circ}$. Subsequently, a transport delay $\\tau$ is introduced due to variable network latency and is well modeled as a factor $\\exp(-s\\tau)$ multiplying $L(s)$ in series. Assume the open-loop $L(s)$ has no right-half-plane poles and the system remains minimum phase under nominal conditions.\n\nUsing only the fundamental definitions of the Nyquist stability criterion (the closed-loop is stable if the Nyquist plot of $L(\\mathrm{j}\\omega)$ produces no net clockwise encirclements of $-1$ when accounting for the open-loop right-half-plane poles) and the definition of phase margin (the additional phase lag at the gain crossover frequency needed to bring the total loop phase to $-\\pi$), derive from first principles an analytic relationship between the phase margin and the maximum allowable transport delay $\\tau_{\\max}$ that preserves closed-loop stability at the gain crossover frequency.\n\nThen, using the reported DT measurements, evaluate $\\tau_{\\max}$ numerically. Convert any angles to radians where appropriate. Round your final numerical answer to four significant figures. Express the answer in seconds. The final answer must be a single real number.",
            "solution": "The nominal open-loop transfer function of the system is denoted by $L(s)$. The introduction of a transport delay $\\tau$ modifies this to a new open-loop transfer function, which we will call $L'(s)$. This is represented as the series connection of the nominal system and the delay element:\n$$L'(s) = L(s) \\exp(-s\\tau)$$\nTo analyze stability using frequency-domain methods, we evaluate the transfer function along the imaginary axis by setting $s = j\\omega$, where $j = \\sqrt{-1}$ and $\\omega$ is the angular frequency.\n$$L'(j\\omega) = L(j\\omega) \\exp(-j\\omega\\tau)$$\nThe frequency response $L'(j\\omega)$ is a complex number, which can be represented in polar form by its magnitude and phase.\nThe magnitude is given by:\n$$|L'(j\\omega)| = |L(j\\omega)| |\\exp(-j\\omega\\tau)|$$\nSince $|\\exp(-j\\omega\\tau)| = |\\cos(-\\omega\\tau) + j\\sin(-\\omega\\tau)| = \\sqrt{\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau)} = 1$, the magnitude is unaffected by the delay:\n$$|L'(j\\omega)| = |L(j\\omega)|$$\nThe phase is given by:\n$$\\angle L'(j\\omega) = \\angle L(j\\omega) + \\angle \\exp(-j\\omega\\tau)$$\nThe phase of the delay term is $-\\omega\\tau$. Therefore, the total phase of the delayed system is:\n$$\\angle L'(j\\omega) = \\angle L(j\\omega) - \\omega\\tau$$\nThe transport delay introduces a phase lag that increases linearly with frequency, but it does not alter the gain-frequency response.\n\nThe problem provides the nominal unity gain crossover frequency, $\\omega_c = 37\\,\\mathrm{rad/s}$. By definition, this is the frequency at which the magnitude of the nominal open-loop transfer function is unity:\n$$|L(j\\omega_c)| = 1$$\nSince the delay does not affect the magnitude, the gain crossover frequency of the delayed system, $L'(s)$, remains at $\\omega_c$.\n\nThe problem also provides the nominal phase at this frequency: $\\angle L(j\\omega_c) = -150^{\\circ}$.\n\nThe phase margin, $\\phi_m$, is defined as the additional phase lag required at the gain crossover frequency, $\\omega_c$, to bring the system to the brink of instability, where the phase is $-\\pi$ radians (or $-180^{\\circ}$). For the nominal system, the phase margin is:\n$$\\phi_m = \\pi + \\angle L(j\\omega_c)$$\nIt is crucial to express angles in radians for consistency in the final formula.\n\nAccording to the Nyquist stability criterion, for a system with no unstable open-loop poles ($P=0$), the closed-loop system is stable if and only if the Nyquist plot of the open-loop transfer function does not encircle the critical point $-1+j0$. A time delay does not introduce any poles, so the delayed system $L'(s)$ also has $P=0$. Stability is therefore maintained as long as the plot of $L'(j\\omega)$ does not encircle $-1$.\n\nThe system becomes marginally stable when the Nyquist plot passes through the point $-1+j0$. This occurs at a frequency $\\omega$ where $|L'(j\\omega)|=1$ and $\\angle L'(j\\omega) = -\\pi$ (or any odd multiple of $-\\pi$). The maximum allowable transport delay, $\\tau_{\\max}$, will be the value of $\\tau$ that brings the system to this condition. Since the gain crossover frequency $\\omega_c$ is a fixed frequency where the magnitude is $1$, the critical condition for instability will occur at this frequency when an introduced delay $\\tau_{\\max}$ causes the phase to become $-\\pi$.\nSo, for marginal stability at $\\tau = \\tau_{\\max}$:\n$$\\angle L'(j\\omega_c) = -\\pi$$\nSubstituting the expression for the phase of the delayed system:\n$$\\angle L(j\\omega_c) - \\omega_c \\tau_{\\max} = -\\pi$$\nWe can rearrange the definition of phase margin to express the nominal phase: $\\angle L(j\\omega_c) = \\phi_m - \\pi$. Substituting this into our stability condition:\n$$(\\phi_m - \\pi) - \\omega_c \\tau_{\\max} = -\\pi$$\nAdding $\\pi$ to both sides yields a simple relationship:\n$$\\phi_m - \\omega_c \\tau_{\\max} = 0$$\nSolving for $\\tau_{\\max}$ gives the desired analytic relationship between the maximum allowable delay and the nominal phase margin:\n$$\\tau_{\\max} = \\frac{\\phi_m}{\\omega_c}$$\nHere, $\\phi_m$ must be in radians.\n\nNow, we use the numerical data provided.\nThe nominal phase margin is calculated in degrees:\n$$\\phi_m = 180^{\\circ} + \\angle L(j\\omega_c) = 180^{\\circ} + (-150^{\\circ}) = 30^{\\circ}$$\nTo use our derived formula, we must convert the phase margin to radians:\n$$\\phi_m = 30^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{\\pi}{6}\\,\\mathrm{rad}$$\nWe are given the gain crossover frequency $\\omega_c = 37\\,\\mathrm{rad/s}$. Substituting these values into our expression for $\\tau_{\\max}$:\n$$\\tau_{\\max} = \\frac{\\pi/6}{37} = \\frac{\\pi}{6 \\times 37} = \\frac{\\pi}{222}\\,\\mathrm{s}$$\nNow we compute the numerical value:\n$$\\tau_{\\max} \\approx \\frac{3.14159265}{222} \\approx 0.014151318\\,\\mathrm{s}$$\nRounding the result to four significant figures, we get:\n$$\\tau_{\\max} \\approx 0.01415\\,\\mathrm{s}$$",
            "answer": "$$\\boxed{0.01415}$$"
        },
        {
            "introduction": "While Gain Margin (GM) and Phase Margin (PM) are the workhorses of classical control analysis, they can sometimes paint an incomplete or even misleading picture of a system's true robustness. This exercise explores a scenario where two systems with identical classical margins exhibit profoundly different resilience to modeling uncertainties, highlighting the limitations of these single-point metrics. You will investigate why GM and PM can fail and develop a more sophisticated geometric margin, derived from the Nyquist plot, that more faithfully quantifies robustness against simultaneous gain and phase uncertainties. ",
            "id": "4234134",
            "problem": "A cyber-physical system with a high-fidelity Digital Twin (DT) is used to design and verify a single-input single-output feedback controller for a plant whose open-loop transfer function is denoted by $L(\\mathrm{j}\\omega)$. The DT reports that two candidate controllers $C_1$ and $C_2$ yield open-loop functions $L_1(\\mathrm{j}\\omega)$ and $L_2(\\mathrm{j}\\omega)$ whose classical stability margins—gain margin (GM) and phase margin (PM)—are identical when computed in the standard way from the Bode plot. However, the Nyquist plots of $L_1(\\mathrm{j}\\omega)$ and $L_2(\\mathrm{j}\\omega)$ differ in their local geometry near the critical point $-1$: for $L_1(\\mathrm{j}\\omega)$ the locus passes near $-1$ with relatively large normal clearance and gentle curvature, whereas for $L_2(\\mathrm{j}\\omega)$ the locus grazes the neighborhood of $-1$ with small normal clearance and high curvature.\n\nThe DT must certify robust closed-loop stability under simultaneous gain and phase deviations arising from modeling errors and implementation, which are abstracted as a complex multiplicative uncertainty on the loop $L(\\mathrm{j}\\omega)$ of the form $L_{\\Delta}(\\mathrm{j}\\omega) = L(\\mathrm{j}\\omega)\\left(1 + \\Delta(\\mathrm{j}\\omega)\\right)$ with $|\\Delta(\\mathrm{j}\\omega)| \\le \\bar{\\delta}$ for all $\\omega$. The certification is to be based on first principles: the Nyquist stability criterion (encirclements of $-1$ by the Nyquist locus of the open-loop function) and the geometric interpretation of uncertainty as perturbations of points on the Nyquist plot.\n\nWhich option best explains why identical GM or PM values in different loops may correspond to different levels of robustness when the Nyquist plot’s local shape near $-1$ differs, and proposes a refined geometric margin metric that correctly captures robustness to simultaneous gain and phase uncertainty using only the Nyquist geometry?\n\nA. Identical GM and PM are computed at specific crossover conditions and only quantify radial and angular separations along chosen rays or circles; they do not account for the global minimum clearance of the Nyquist locus from $-1$ nor the local orientation of the curve. Under complex multiplicative uncertainty $L_{\\Delta}(\\mathrm{j}\\omega) = L(\\mathrm{j}\\omega)(1+\\Delta(\\mathrm{j}\\omega))$ with $|\\Delta| \\le \\bar{\\delta}$, the admissible perturbation at each frequency is an isotropic disk in the complex plane centered at $L(\\mathrm{j}\\omega)$ with radius $|L(\\mathrm{j}\\omega)|\\bar{\\delta}$. Robust stability is certified if these disks exclude $-1$ for all $\\omega$, which is equivalent to requiring $\\min_{\\omega} |1 + L(\\mathrm{j}\\omega)|  0$ relative to the uncertainty scale. A refined geometric margin is the disk margin defined by $$m_{\\mathrm{disk}} = \\min_{\\omega} \\frac{|1 + L(\\mathrm{j}\\omega)|}{|L(\\mathrm{j}\\omega)|},$$ which measures the smallest Euclidean distance from $-1$ to the Nyquist locus, normalized by the local loop magnitude, thereby capturing differences in robustness that GM and PM can miss.\n\nB. Identical GM and PM imply identical robust stability for any admissible uncertainty because the Nyquist shape near $-1$ does not affect the encirclement count; a refined metric is unnecessary if GM and PM are equal.\n\nC. Differences in Nyquist shape near $-1$ affect only steady-state accuracy and not stability; a refined margin should be the integral $\\int_{0}^{\\infty} |L(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega$, which averages the loop magnitude over frequency and thereby reflects robustness.\n\nD. The correct refinement is to project the separation vector $1 + L(\\mathrm{j}\\omega)$ onto the local normal of the Nyquist curve at $L(\\mathrm{j}\\omega)$ and define the margin as $$m_{\\mathrm{normal}} = \\min_{\\omega} \\left(|1 + L(\\mathrm{j}\\omega)| \\cos\\theta(\\omega)\\right),$$ where $\\theta(\\omega)$ is the angle between $1 + L(\\mathrm{j}\\omega)$ and the unit normal; this projection penalizes grazing and therefore fully characterizes robustness under complex multiplicative uncertainty without further normalization by $|L(\\mathrm{j}\\omega)|$.",
            "solution": "The problem highlights a well-known limitation of classical stability margins (Gain Margin and Phase Margin). These metrics are insufficient for fully characterizing robustness because they only measure the distance to the critical point $-1$ along two specific directions (the negative real axis for GM, and the unit circle for PM) and at two specific frequencies (the phase and gain crossover frequencies, respectively). A system can have good GM and PM but still have a Nyquist locus that passes very close to the $-1$ point at other frequencies, indicating poor robustness. This is the situation described for controller $C_2$.\n\nTo properly quantify robustness against the given complex multiplicative uncertainty, $L_{\\Delta}(\\mathrm{j}\\omega) = L(\\mathrm{j}\\omega)(1 + \\Delta(\\mathrm{j}\\omega))$ with $|\\Delta(\\mathrm{j}\\omega)| \\le \\bar{\\delta}$, we must consider the geometry of the perturbation at every frequency.\n\n1.  **Geometric Interpretation of Uncertainty:** At each frequency $\\omega$, the perturbation term $L(\\mathrm{j}\\omega)\\Delta(\\mathrm{j}\\omega)$ describes a set of possible additive changes to the nominal locus point $L(\\mathrm{j}\\omega)$. Since $\\Delta(\\mathrm{j}\\omega)$ can be any complex number with magnitude up to $\\bar{\\delta}$, the set of all possible perturbed points $L_{\\Delta}(\\mathrm{j}\\omega)$ forms a disk in the complex plane centered at $L(\\mathrm{j}\\omega)$ with a radius of $R(\\omega) = |L(\\mathrm{j}\\omega)|\\bar{\\delta}$.\n\n2.  **Robust Stability Condition:** According to the Nyquist criterion, the system remains stable as long as the perturbed locus $L_{\\Delta}(\\mathrm{j}\\omega)$ does not encircle the $-1$ point. This is guaranteed if, for every frequency $\\omega$, the uncertainty disk around $L(\\mathrm{j}\\omega)$ does not contain the point $-1$.\n\n3.  **Derivation of the Margin:** The condition that the disk does not contain $-1$ is equivalent to requiring that the distance from the center of the disk, $L(\\mathrm{j}\\omega)$, to the point $-1$ is greater than the disk's radius. This gives the inequality:\n    $$|L(\\mathrm{j}\\omega) - (-1)| > |L(\\mathrm{j}\\omega)|\\bar{\\delta}$$\n    $$|1 + L(\\mathrm{j}\\omega)| > |L(\\mathrm{j}\\omega)|\\bar{\\delta}$$\n    To find the maximum tolerable uncertainty level $\\bar{\\delta}$, we can rearrange this:\n    $$\\bar{\\delta}  \\frac{|1 + L(\\mathrm{j}\\omega)|}{|L(\\mathrm{j}\\omega)|}$$\n    Since this must hold for all frequencies, the system is robustly stable for any uncertainty size $\\bar{\\delta}$ that is less than the minimum value of this ratio. This minimum value defines the robust stability margin, often called the disk margin:\n    $$m_{\\mathrm{disk}} = \\min_{\\omega} \\frac{|1 + L(\\mathrm{j}\\omega)|}{|L(\\mathrm{j}\\omega)|}$$\n\nThis metric, unlike GM and PM, evaluates the \"normalized\" distance to the critical point over all frequencies. The normalization by $|L(\\mathrm{j}\\omega)|$ is crucial because the size of the uncertainty disk itself scales with the loop gain. This margin correctly captures that the system with locus $L_2(\\mathrm{j}\\omega)$, which \"grazes\" the critical point, is less robust.\n\nOption A correctly describes the limitations of GM/PM, accurately interprets the uncertainty model as a disk, and derives the correct refined metric. The other options are incorrect: B falsely claims GM/PM are sufficient, C proposes an irrelevant metric, and D proposes an incorrect geometric construction that lacks the necessary normalization.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}