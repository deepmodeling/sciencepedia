{
    "hands_on_practices": [
        {
            "introduction": "在设计扰动观测器时，$Q$ 滤波器的选择至关重要，因为它直接决定了系统的性能。其设计过程必然涉及一个核心权衡：宽带宽的滤波器能更快速地跟踪和抑制扰动，但同时也更容易放大高频测量噪声。本练习将通过一个理想化的场景，指导您运用频率域分析方法，量化这一权衡关系，并推导出最小化总估计误差的最优滤波器带宽 ()。这个过程将帮助您深入理解扰动跟踪与噪声抑制之间的内在矛盾。",
            "id": "4218779",
            "problem": "一个信息物理系统由一个数字孪生（DT）监控，该数字孪生实现了一个扰动观测器（DO）来估计一个加性输出扰动。该物理对象是线性时不变（LTI）的，并且在工作区域内，DT提供了一个精确的标称模型，因此实际对象等于标称对象。标称对象由 $P_{n}(s)=\\frac{1}{s+1}$ 给出。DO使用标准残差 $y(s)-P_{n}(s)u(s)$，其中 $y(s)$ 是测量输出， $u(s)$ 是控制输入，且测量值受到加性传感器噪声的干扰。DO的估计值是通过用一个一阶低通$Q$滤波器 $Q(s)=\\frac{\\omega_{c}}{s+\\omega_{c}}$ 对该残差进行滤波而形成的，其中 $\\omega_{c}0$ 是待选的截止角频率。\n\n假设信号结构和模型如下：\n- 真实输出为 $y(s)=P_{n}(s)u(s)+d(s)+n(s)$，其中 $d(s)$ 是加性输出扰动，$n(s)$ 是加性传感器噪声。\n- 因为DT提供了精确的标称匹配，$P(s)=P_{n}(s)$，所以不存在模型失配项。\n- 加性扰动 $d(t)$ 是一个宽平稳过程，其单边功率谱密度（PSD）$S_{d}(\\omega)$ 在 $0\\leq \\omega\\leq \\omega_{d}$ 范围内为常数 $S_{d0}$，在 $\\omega\\omega_{d}$ 时为零。\n- 传感器噪声 $n(t)$ 是白噪声，其单边PSD对于所有 $\\omega\\geq 0$ 均为 $S_{n}(\\omega)=S_{n0}$。\n- 所有过程都相互不相关。\n\n从频域中的基本LTI输入输出关系和通过单边PSD定义的均方误差出发，推导由 $d(t)$ 和 $n(t)$ 引起的、针对DO估计值 $\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$ 的频域扰动估计误差。然后，通过对误差谱进行频率积分，获得一个等于单边均方估计误差的标量成本 $J(\\omega_{c})$，作为 $\\omega_{c}$ 的函数。最后，对于数值 $S_{d0}=2\\pi$, $S_{n0}=\\pi-2$ 和 $\\omega_{d}=10$，确定使 $J(\\omega_{c})$ 最小化的截止角频率 $\\omega_{c}^{\\star}$。\n\n以弧度/秒为单位表示最终的最优截止角频率。无需四舍五入；请提供精确值。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n- **标称对象模型**: $P_{n}(s)=\\frac{1}{s+1}$。\n- **对象-模型关系**: 标称模型是精确的，$P(s)=P_{n}(s)$。\n- **输出方程**: $y(s)=P_{n}(s)u(s)+d(s)+n(s)$，其中 $d(s)$ 是扰动，$n(s)$ 是传感器噪声。\n- **扰动观测器（DO）估计值**: $\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$。\n- **Q滤波器**: $Q(s)=\\frac{\\omega_{c}}{s+\\omega_{c}}$，其中 $\\omega_{c}0$。\n- **扰动PSD**: $d(t)$ 的单边功率谱密度（PSD）在 $0\\leq \\omega\\leq \\omega_{d}$ 时为 $S_{d}(\\omega) = S_{d0}$，在 $\\omega\\omega_{d}$ 时为 $S_{d}(\\omega)=0$。\n- **噪声PSD**: $n(t)$ 的单边PSD对于所有 $\\omega\\geq 0$ 均为 $S_{n}(\\omega)=S_{n0}$。\n- **信号特性**: 过程 $d(t)$ 和 $n(t)$ 是宽平稳且相互不相关的。\n- **数值**: $S_{d0}=2\\pi$, $S_{n0}=\\pi-2$, 和 $\\omega_{d}=10$。\n- **目标**: 找到最小化均方估计误差 $J(\\omega_c)$ 的最优截止角频率 $\\omega_c^{\\star}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **有科学依据**: 该问题在控制理论和扰动观测器设计的既定领域内，使用了线性时不变（LTI）系统、随机过程（PSD）和优化的标准原理。所有概念均有效。\n- **适定性**: 问题是完全指定的。所有必要的模型、信号特性和数值都已提供，足以构建和解决该优化问题。给出了物理约束 $\\omega_c0$。PSD值 $S_{d0}=2\\pi  0$ 和 $S_{n0}=\\pi-2  0$ 具有物理意义。\n- **客观性**: 问题陈述精确、量化，并且没有主观因素。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供完整的解答。\n\n### 均方估计误差的推导\n\n拉普拉斯域中的扰动估计误差为 $\\tilde{d}(s) = d(s) - \\hat{d}(s)$。\n扰动估计值由 $\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$ 给出。\n代入输出 $y(s)$ 的表达式，我们得到：\n$$y(s)-P_{n}(s)u(s) = \\big(P_{n}(s)u(s)+d(s)+n(s)\\big) - P_{n}(s)u(s) = d(s) + n(s)$$\n因此，扰动估计值为 $\\hat{d}(s) = Q(s) \\big(d(s) + n(s)\\big)$。\n于是，估计误差为：\n$$\\tilde{d}(s) = d(s) - Q(s)\\big(d(s) + n(s)\\big) = \\big(1 - Q(s)\\big)d(s) - Q(s)n(s)$$\n误差信号 $\\tilde{d}(t)$ 是一个具有两个输入 $d(t)$ 和 $n(t)$ 的LTI系统的输出。从 $d(t)$到 $\\tilde{d}(t)$ 的传递函数是 $T_{d\\tilde{d}}(s) = 1 - Q(s)$，从 $n(t)$ 到 $\\tilde{d}(t)$ 的传递函数是 $T_{n\\tilde{d}}(s) = -Q(s)$。\n由于 $d(t)$ 和 $n(t)$ 不相关，估计误差的单边PSD $S_{\\tilde{d}}(\\omega)$ 是各个输出PSD的和：\n$$S_{\\tilde{d}}(\\omega) = |T_{d\\tilde{d}}(j\\omega)|^2 S_{d}(\\omega) + |T_{n\\tilde{d}}(j\\omega)|^2 S_{n}(\\omega) = |1 - Q(j\\omega)|^2 S_{d}(\\omega) + |Q(j\\omega)|^2 S_{n}(\\omega)$$\n我们计算给定 $Q$ 滤波器 $Q(s) = \\frac{\\omega_c}{s+\\omega_c}$ 的频率响应幅值：\n$$Q(j\\omega) = \\frac{\\omega_c}{j\\omega + \\omega_c} \\implies |Q(j\\omega)|^2 = Q(j\\omega)Q(-j\\omega) = \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2}$$\n$$1 - Q(j\\omega) = 1 - \\frac{\\omega_c}{j\\omega + \\omega_c} = \\frac{j\\omega}{j\\omega + \\omega_c} \\implies |1 - Q(j\\omega)|^2 = \\frac{\\omega^2}{\\omega^2 + \\omega_c^2}$$\n将这些代入 $S_{\\tilde{d}}(\\omega)$ 的表达式中：\n$$S_{\\tilde{d}}(\\omega) = \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} S_{d}(\\omega) + \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2} S_{n}(\\omega)$$\n标量成本 $J(\\omega_c)$ 是均方估计误差，通过对单边误差PSD在所有频率上积分得到：\n$$J(\\omega_c) = E[\\tilde{d}^2(t)] = \\frac{1}{2\\pi} \\int_0^\\infty S_{\\tilde{d}}(\\omega) d\\omega$$\n我们可以将成本分解为由扰动引起的分量 $J_d(\\omega_c)$ 和由噪声引起的分量 $J_n(\\omega_c)$。\n$$J(\\omega_c) = J_d(\\omega_c) + J_n(\\omega_c)$$\n使用给定的扰动PSD，第一个分量是：\n$$J_d(\\omega_c) = \\frac{1}{2\\pi} \\int_0^\\infty \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} S_{d}(\\omega) d\\omega = \\frac{S_{d0}}{2\\pi} \\int_0^{\\omega_d} \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} d\\omega$$\n$$J_d(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\int_0^{\\omega_d} \\left(1 - \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2}\\right) d\\omega = \\frac{S_{d0}}{2\\pi} \\left[ \\omega - \\omega_c \\arctan\\left(\\frac{\\omega}{\\omega_c}\\right) \\right]_0^{\\omega_d}$$\n$$J_d(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right)$$\n使用给定的噪声PSD，第二个分量是：\n$$J_n(\\omega_c) = \\frac{1}{2\\pi} \\int_0^\\infty \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2} S_{n}(\\omega) d\\omega = \\frac{S_{n0}\\omega_c^2}{2\\pi} \\int_0^\\infty \\frac{1}{\\omega^2 + \\omega_c^2} d\\omega$$\n该积分的计算结果为 $\\int_0^\\infty \\frac{1}{\\omega^2 + \\omega_c^2} d\\omega = \\left[ \\frac{1}{\\omega_c} \\arctan\\left(\\frac{\\omega}{\\omega_c}\\right) \\right]_0^\\infty = \\frac{1}{\\omega_c}\\left(\\frac{\\pi}{2} - 0\\right) = \\frac{\\pi}{2\\omega_c}$。\n$$J_n(\\omega_c) = \\frac{S_{n0}\\omega_c^2}{2\\pi} \\left( \\frac{\\pi}{2\\omega_c} \\right) = \\frac{S_{n0}\\omega_c}{4}$$\n总成本函数为：\n$$J(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) + \\frac{S_{n0}\\omega_c}{4}$$\n\n### 截止频率的优化\n\n为了找到最小化 $J(\\omega_c)$ 的最优截止频率 $\\omega_c^{\\star}$，我们将其关于 $\\omega_c$ 的导数置为零。\n$$\\frac{dJ}{d\\omega_c} = \\frac{d}{d\\omega_c} \\left[ \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) + \\frac{S_{n0}\\omega_c}{4} \\right] = 0$$\n让我们计算各项的导数：\n$$\\frac{d}{d\\omega_c} \\left( \\frac{S_{n0}\\omega_c}{4} \\right) = \\frac{S_{n0}}{4}$$\n$$\\frac{d}{d\\omega_c} \\left( \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) = \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) + \\omega_c \\left( \\frac{1}{1+(\\omega_d/\\omega_c)^2} \\cdot \\left(-\\frac{\\omega_d}{\\omega_c^2}\\right) \\right) = \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2}$$\n所以，总导数为：\n$$\\frac{dJ}{d\\omega_c} = \\frac{S_{d0}}{2\\pi} \\left( -\\left[ \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2} \\right] \\right) + \\frac{S_{n0}}{4} = 0$$\n整理各项得到最优性条件：\n$$\\frac{S_{n0}}{4} = \\frac{S_{d0}}{2\\pi} \\left( \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2} \\right)$$\n现在我们代入给定的数值：$S_{d0}=2\\pi$, $S_{n0}=\\pi-2$ 和 $\\omega_d=10$。\n$$\\frac{\\pi-2}{4} = \\frac{2\\pi}{2\\pi} \\left( \\arctan\\left(\\frac{10}{\\omega_c}\\right) - \\frac{10\\omega_c}{\\omega_c^2 + 10^2} \\right)$$\n$$\\frac{\\pi-2}{4} = \\arctan\\left(\\frac{10}{\\omega_c}\\right) - \\frac{10\\omega_c}{\\omega_c^2 + 100}$$\n我们需要求解这个关于 $\\omega_c$ 的超越方程。让我们测试一个潜在解 $\\omega_c = \\omega_d = 10$。\n将 $\\omega_c=10$ 代入方程的右边：\n$$\\text{右边} = \\arctan\\left(\\frac{10}{10}\\right) - \\frac{10(10)}{10^2 + 100} = \\arctan(1) - \\frac{100}{200} = \\frac{\\pi}{4} - \\frac{1}{2}$$\n化简右边得到：\n$$\\frac{\\pi}{4} - \\frac{2}{4} = \\frac{\\pi-2}{4}$$\n这与方程的左边完全相同。因此，$\\omega_c^{\\star} = 10$ 是满足最优性条件的解。可以证明 $J(\\omega_c)$ 的二阶导数为正，这证实了该驻点是一个最小值点。\n最优截止角频率为 $10$ 弧度/秒。",
            "answer": "$$\n\\boxed{10}\n$$"
        },
        {
            "introduction": "尽管前面的练习假设我们拥有精确的系统模型，但在现实世界的数字孪生和控制应用中，模型不确定性是不可避免的。本练习将探讨鲁棒稳定性的关键概念，揭示一个设计过于“激进”的扰动观测器如何与未建模的动态（例如机械系统的轻阻尼柔性模态）相互作用，并最终导致系统失稳 ()。通过运用小增益定理，我们将推导出一个明确的、可计算的条件，以确保在存在模型不确定性的情况下，闭环系统仍能保持稳定。",
            "id": "4218791",
            "problem": "考虑一个装备了用于通过扰动观测器（DOB）进行扰动补偿的数字孪生模型的线性时不变信息物理系统。设拉普拉斯域中真实对象的输入输出关系为 $Y(s) = P(s) U(s) + D(s)$，其中 $P(s)$ 是真实对象，$U(s)$ 是指令输入，$D(s)$ 是外部扰动。数字孪生使用一个标称模型 $P_n(s)$，并通过一个稳定的、严格正常的低通滤波器 $Q(s)$ 和标称逆模型 $P_n^{-1}(s)$ 形成扰动估计，作为标准DOB架构的一部分。假设乘性模型不确定性写作 $P(s) = P_n(s) \\left( 1 + W_m(s) \\Delta(s) \\right)$，其中 $W_m(s)$ 是一个已知的频率相关的加权函数，用于捕捉不确定性（具有轻阻尼柔性模态行为），而 $\\Delta(s)$ 是满足 $\\left\\| \\Delta(j\\omega) \\right\\|_\\infty \\leq 1$ 的任何稳定的有界扰动。频率必须以弧度/秒为单位。\n\n仅从线性时不变系统、卷积、拉普拉斯变换以及针对反馈互联的小增益定理的定义出发，推导一个在存在乘性不确定性的情况下保证DOB补偿内部稳定性的数学上严格的条件。您的推导必须明确指出DOB内环中不确定性输入和输出之间的反馈互联映射，并且必须量化 $Q(s)$ 滤波器的带宽如何影响该互联的鲁棒性。然后，使用不确定性加权中的一个轻阻尼柔性模态构建一个反例，并提供一个逻辑上合理的论证，解释为什么将 $Q(s)$ 的带宽设置得过于激进会降低鲁棒性。\n\n为具体起见并进行数值验证，请使用以下低通滤波器和乘性不确定性加权的参数化形式：\n- $Q(s) = \\dfrac{\\omega_q}{s + \\omega_q}$，带宽参数 $\\omega_q  0$，单位为弧度/秒。\n- $W_m(s) = k_w \\dfrac{\\omega_f^2}{s^2 + 2 \\zeta_f \\omega_f s + \\omega_f^2}$，其中 $\\omega_f  0$ 是柔性模态的自然频率，单位为弧度/秒，$\\zeta_f \\in (0, 1)$ 是其阻尼比，$k_w  0$ 是一个无量纲不确定性尺度因子。\n\n在推导条件之后，实现一个程序，对于任何给定的参数集 $(\\omega_q,\\omega_f,\\zeta_f,k_w)$，该程序能在频率 $\\omega \\in [10^{-1}, 10^{4}]$ 弧度/秒的范围内，数值计算您的推导所蕴含的、从不确定性到其自身的DOB内环环路增益幅值的上确界。基于此上确界，返回一个布尔值，指示在与乘性不确定性模型一致的所有容许的 $\\Delta(s)$ 下，是否能保证鲁棒稳定性。程序必须以弧度处理角度，以弧度/秒处理频率。输出中不需要其他物理单位。\n\n测试套件：\n使用以下四组参数集来展示覆盖范围，包括一个一般情况、一个破坏鲁棒性的激进带宽情况、一个通过增加阻尼恢复鲁棒性的情况，以及一个接近失去鲁棒性的边界情况：\n1. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (30,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n2. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (400,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n3. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (400,\\ 200,\\ 0.10,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n4. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (90,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含鲁棒性结果，格式为一个用方括号括起来的、由逗号分隔的布尔值列表（例如，$[result_1,result_2,result_3,result_4]$）。如果对于第$i$个测试用例，您推导的条件保证了鲁棒稳定性，则 $result_i$ 为 $True$，否则为 $False$。",
            "solution": "根据指定的验证程序，对问题陈述进行严格评估。\n\n### 第1步：提取已知条件\n- 对象输入输出关系：$Y(s) = P(s) U(s) + D(s)$，其中 $Y(s)$ 是输出，$P(s)$ 是真实对象，$U(s)$ 是指令输入，$D(s)$ 是外部扰动。\n- 标称对象模型：$P_n(s)$。\n- 扰动观测器滤波器：$Q(s)$，一个稳定的、严格正常的低通滤波器。\n- 标称对象逆模型：$P_n^{-1}(s)$。\n- 乘性不确定性模型：$P(s) = P_n(s) \\left( 1 + W_m(s) \\Delta(s) \\right)$。\n- 不确定性加权函数：$W_m(s)$。\n- 扰动模块：$\\Delta(s)$，任何满足 $\\left\\| \\Delta(s) \\right\\|_\\infty \\leq 1$ 的稳定系统。\n- 频率单位：弧度/秒。\n- $Q$滤波器参数化形式：$Q(s) = \\dfrac{\\omega_q}{s + \\omega_q}$，带宽为 $\\omega_q  0$。\n- 不确定性加权参数化形式：$W_m(s) = k_w \\dfrac{\\omega_f^2}{s^2 + 2 \\zeta_f \\omega_f s + \\omega_f^2}$，柔性模态频率为 $\\omega_f  0$，阻尼比为 $\\zeta_f \\in (0, 1)$，不确定性尺度因子为 $k_w  0$。\n- 数值计算范围：$\\omega \\in [10^{-1}, 10^{4}]$ 弧度/秒。\n- 测试用例：\n  1. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (30, 200, 0.02, 0.1)$\n  2. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (400, 200, 0.02, 0.1)$\n  3. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (400, 200, 0.10, 0.1)$\n  4. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (90, 200, 0.02, 0.1)$\n\n### 第2步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题牢固地植根于现代控制理论的原理，特别是鲁棒控制和观测器设计。扰动观测器（DOB）、乘性不确定性建模、小增益定理和频域分析等概念是该学科中的经典内容。该设置在科学和数学上是合理的。\n- **适定性：** 该问题是适定的。它要求推导一个标准的鲁棒稳定性条件，并在给定特定参数化形式的情况下进行数值评估。所要求的输出由所提供的数据和既定理论唯一确定。\n- **客观性：** 问题陈述使用精确、正式、客观的语言编写，没有歧义或主观论断。\n- **完整性与一致性：** 问题提供了推导条件和执行数值计算所需的所有定义、模型和参数。没有内部矛盾。\n- **现实性：** 滤波器和不确定性加权的建模，特别是轻阻尼柔性模态的表示，在控制机械系统的背景下是标准且现实的，这是信息物理系统和数字孪生的常见应用。\n\n### 第3步：结论与行动\n该问题有效。下面提供了完整的解决方案。\n\n### 基于原理的设计与推导\n\n主要目标是为由对象和扰动观测器（DOB）构成的闭环系统推导一个内部稳定性条件。我们首先形式化所描述的DOB结构。一个标准的DOB估计一个集总扰动，并向控制输入中注入一个补偿信号。该估计是通过比较对象输出和标称模型输出而形成的。\n\n设 $U_r(s)$ 为外部参考指令。施加到对象的实际输入 $U(s)$ 是该参考指令与补偿信号 $U_{comp}(s)$ 的和。所描述的DOB公式意味着补偿信号是折算到输入端的扰动估计。我们如下构建此估计。\n\n一个可称为“测量扰动”的中间信号 $d_m(s)$，是通过对象输入 $U(s)$ 与在对象为标称模型时产生输出 $Y(s)$ 所需的输入（即 $P_n^{-1}(s)Y(s)$）之间的差值形成的。\n$$d_m(s) = P_n^{-1}(s)Y(s) - U(s)$$\n该信号随后通过低通滤波器 $Q(s)$ 以生成估计的扰动，该扰动作为补偿信号：\n$$U_{comp}(s) = -Q(s)d_m(s)$$\n负号表示该信号从参考指令中减去。因此，施加到对象的总输入为：\n$$U(s) = U_r(s) + U_{comp}(s) = U_r(s) - Q(s)d_m(s)$$\n代入 $d_m(s)$ 的表达式：\n$$U(s) = U_r(s) - Q(s) \\left( P_n^{-1}(s)Y(s) - U(s) \\right)$$\n为分析内部DOB环路的稳定性，我们必须理解它如何与建模不确定性相互作用。我们将对象和不确定性模型，$Y(s) = P(s)U(s) + D(s)$ 和 $P(s) = P_n(s)(1+W_m(s)\\Delta(s))$，代入 $U(s)$ 的方程中。\n$$U(s) = U_r(s) - Q(s) \\left( P_n^{-1}(s)\\left[ P_n(s)(1+W_m(s)\\Delta(s))U(s) + D(s) \\right] - U(s) \\right)$$\n简化括号内的项：\n$$P_n^{-1}(s)P_n(s)(1+W_m(s)\\Delta(s))U(s) - U(s) = (1+W_m(s)\\Delta(s))U(s) - U(s) = W_m(s)\\Delta(s)U(s)$$\n因此，$U(s)$ 的方程变为：\n$$U(s) = U_r(s) - Q(s) \\left( W_m(s)\\Delta(s)U(s) + P_n^{-1}(s)D(s) \\right)$$\n为分析内部稳定性，我们考虑齐次系统，即将所有外部输入设为零，即 $U_r(s) = 0$ 和 $D(s) = 0$。\n$$U(s) = -Q(s)W_m(s)\\Delta(s)U(s)$$\n该方程揭示了决定内部稳定性的反馈结构。我们可以将其重新排列为：\n$$U(s) + Q(s)W_m(s)\\Delta(s)U(s) = 0$$\n$$\\left[ 1 + Q(s)W_m(s)\\Delta(s) \\right] U(s) = 0$$\n对于非平凡解 $U(s) \\neq 0$，此环路的特征方程为 $1 + Q(s)W_m(s)\\Delta(s) = 0$。当且仅当对于所有容许的扰动 $\\Delta(s)$，该方程在复平面的闭右半平面中没有根时，系统是内部稳定的。\n\n至此，反馈互联结构已经明确。我们可以将系统建模为一个负反馈环路，其中前向路径是 $\\Delta(s)$，反馈路径是 $M(s) = Q(s)W_m(s)$。对于一族不确定但稳定的模块 $\\Delta(s)$，这种连接的稳定性由小增益定理保证。\n\n小增益定理指出，如果两个稳定系统 $M$ 和 $\\Delta$ 的增益乘积小于1，则它们的反馈互联是稳定的。增益定义为 $H_\\infty$范数，即 $\\|G\\|_\\infty = \\sup_{\\omega} |G(j\\omega)|$。\n鲁棒稳定性的条件是：\n$$\\| M(s) \\|_\\infty \\cdot \\| \\Delta(s) \\|_\\infty  1$$\n我们已知 $\\Delta(s)$ 是任何满足 $\\| \\Delta(s) \\|_\\infty \\leq 1$ 的稳定传递函数。为保证在最坏情况 $\\Delta(s)$（其范数为1）下的稳定性，我们必须对我们的标称系统施加以下严格条件：\n$$\\| M(s) \\|_\\infty  1$$\n代入 $M(s) = Q(s)W_m(s)$，鲁棒内部稳定性的严格条件是：\n$$\\| Q(s)W_m(s) \\|_\\infty  1$$\n这等价于：\n$$\\sup_{\\omega \\ge 0} \\left| Q(j\\omega)W_m(j\\omega) \\right|  1$$\n\n现在，我们将分析 $Q(s)$ 滤波器的带宽 $\\omega_q$ 如何影响鲁棒性，并构建一个反例。不确定性加权 $W_m(s)$ 代表一个轻阻尼柔性模态。其幅频响应 $|W_m(j\\omega)| = \\left| k_w \\frac{\\omega_f^2}{-\\omega^2 + 2j\\zeta_f \\omega_f \\omega + \\omega_f^2} \\right|$ 在自然频率 $\\omega \\approx \\omega_f$ 处表现出一个尖锐的谐振峰。近似的峰值幅值为 $|W_m(j\\omega_f)| \\approx \\frac{k_w}{2\\zeta_f}$。对于小阻尼 $\\zeta_f$，该峰值可能远大于1。\n\n滤波器 $Q(s)$ 的幅频响应为 $|Q(j\\omega)| = \\frac{\\omega_q}{\\sqrt{\\omega^2 + \\omega_q^2}}$，这是一阶低通滤波器的典型特征。其增益在频率 $\\omega \\ll \\omega_q$ 时约为1，在频率 $\\omega \\gg \\omega_q$ 时衰减。\n\n鲁棒稳定性条件 $\\sup_{\\omega} |Q(j\\omega)W_m(j\\omega)|  1$ 必须对所有频率都成立。最具挑战性的频率在 $W_m(s)$ 的谐振峰附近，即 $\\omega \\approx \\omega_f$。在此频率下，我们必须满足 $|Q(j\\omega_f)||W_m(j\\omega_f)|  1$。由于 $|W_m(j\\omega_f)|$ 很大，这要求 $|Q(j\\omega_f)|$ 必须足够小。为了使 $|Q(j\\omega_f)| = \\frac{\\omega_q}{\\sqrt{\\omega_f^2 + \\omega_q^2}}$ 足够小，滤波器的带宽 $\\omega_q$ 必须选择得远小于柔性模态频率 $\\omega_f$。\n\n这说明了DOB设计中的一个基本权衡。高带宽滤波器（大的 $\\omega_q$）对于抑制大范围的扰动是理想的。然而，过于激进（高）的带宽会将DOB的作用扩展到模型不准确的高频区域，正如 $W_m(s)$ 的大幅值所捕捉的那样。这可能导致DOB放大测量噪声，更关键的是，通过正反馈到未建模动态中而使系统失稳。\n\n通过比较两种情况来构建一个反例。\n1. 一个保守设计，其中 $\\omega_q \\ll \\omega_f$（例如，测试用例1，$\\omega_q=30$，$\\omega_f=200$）。在这里，在 $\\omega_f=200$ 时，$Q$滤波器会大幅衰减信号，确保 $|Q(j\\omega_f)W_m(j\\omega_f)|  1$。\n2. 一个激进设计，其中 $\\omega_q \\ge \\omega_f$（例如，测试用例2，$\\omega_q=400$，$\\omega_f=200$）。在这里，在 $\\omega_f=200$ 时，$Q$滤波器的增益接近1。乘积 $|Q(j\\omega_f)W_m(j\\omega_f)|$ 将近似为 $|W_m(j\\omega_f)| \\approx \\frac{k_w}{2\\zeta_f}$，这很容易超过1，从而违反稳定性条件。\n\n数值实现将为每个参数集评估 $\\sup_{\\omega \\in [10^{-1}, 10^{4}]} |Q(j\\omega)W_m(j\\omega)|$，如果该上确界小于1，则返回 `True`，否则返回 `False`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically validates the robust stability condition for a\n    Disturbance Observer (DOB) in the presence of multiplicative uncertainty.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (omega_q, omega_f, zeta_f, k_w)\n    test_cases = [\n        (30.0, 200.0, 0.02, 0.1),\n        (400.0, 200.0, 0.02, 0.1),\n        (400.0, 200.0, 0.10, 0.1),\n        (90.0, 200.0, 0.02, 0.1),\n    ]\n\n    results = []\n\n    # Define the frequency range for numerical evaluation of the H-infinity norm.\n    # A logarithmic space is used to cover the wide range efficiently.\n    # 20000 points ensure an accurate capture of the resonant peak.\n    omega = np.logspace(-1, 4, 20000) # Frequencies in rad/s\n\n    for case in test_cases:\n        omega_q, omega_f, zeta_f, k_w = case\n\n        # The complex frequency variable s = j*omega\n        s = 1j * omega\n\n        # Calculate the frequency response of the Q(s) filter.\n        # Q(s) = omega_q / (s + omega_q)\n        q_s_freq_response = omega_q / (s + omega_q)\n\n        # Calculate the frequency response of the uncertainty weighting W_m(s).\n        # W_m(s) = k_w * omega_f^2 / (s^2 + 2*zeta_f*omega_f*s + omega_f^2)\n        wm_s_freq_response = (k_w * omega_f**2) / (s**2 + 2 * zeta_f * omega_f * s + omega_f**2)\n\n        # The transfer function from the uncertainty output to its input is T(s) = Q(s) * W_m(s).\n        t_s_freq_response = q_s_freq_response * wm_s_freq_response\n\n        # According to the small-gain theorem, for robust stability, the H_infinity norm\n        # of T(s) must be less than 1. The H_infinity norm is the supremum of the\n        # magnitude of the frequency response.\n        h_inf_norm_approx = np.max(np.abs(t_s_freq_response))\n\n        # Check the robust stability condition.\n        is_robustly_stable = h_inf_norm_approx  1.0\n        results.append(is_robustly_stable)\n\n    # Final print statement in the exact required format.\n    # The output is a list of booleans indicating robust stability for each case.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了经典的频率域设计方法，我们还可以从最优估计的视角来构建扰动观测器。本练习将扰动建模为一个随机游走过程，并将其作为增广状态与原系统状态一同考虑，从而将扰动观测问题转化为一个标准的卡尔曼滤波问题。您将学习如何通过求解离散时间代数Riccati方程来计算最优的稳态卡尔曼增益 ()。此外，本练习还将分析滤波器增益对其关键调节参数——过程噪声和测量噪声协方差——的敏感性，这对于在实践中调试和优化观测器性能至关重要。",
            "id": "4218744",
            "problem": "考虑一个离散时间线性时不变信息物理系统 (CPS)，其带有一个数字孪生 (DT) 模型。该系统的对象状态受到一个未知的、缓慢变化的扰动影响。通过将对象状态与扰动进行增广来构建扰动观测器，从而通过一个最优线性估计器实现联合估计。目标是计算用于扰动估计的卡尔曼滤波器 (KF) 的稳态增益，并分析该增益对噪声协方差错误指定的灵敏度。\n\n对象动态建模如下。设增广状态为 $z_k \\in \\mathbb{R}^3$，定义为 $z_k = \\begin{bmatrix} x_{p,k} \\\\ x_{v,k} \\\\ d_k \\end{bmatrix}$，其中 $x_{p,k}$ 是位置，$x_{v,k}$ 是速度，$d_k$ 是一个作为未知加速度并遵循随机游走的标量扰动。离散时间增广动态为\n$$\nz_{k+1} = A z_k + w_k,\\quad y_k = C z_k + v_k,\n$$\n采样间隔为 $0.1$ 秒，其中\n$$\nA = \\begin{bmatrix}\n1  0.1  0 \\\\\n0  1  0.1 \\\\\n0  0  1\n\\end{bmatrix},\\quad\nC = \\begin{bmatrix}\n1  0  0\n\\end{bmatrix}.\n$$\n过程噪声 $w_k \\in \\mathbb{R}^3$ 和测量噪声 $v_k \\in \\mathbb{R}$ 是独立的、零均值的高斯随机变量，其协方差为\n$$\n\\mathbb{E}[w_k w_k^\\top] = Q_w \\in \\mathbb{R}^{3 \\times 3},\\quad \\mathbb{E}[v_k^2] = R_v \\in \\mathbb{R}_{0}.\n$$\n所有矩阵 $Q_w$ 和 $R_v$ 均为适当的对称正（半）定矩阵。\n\n从线性高斯估计的基本原理以及误差协方差传播和新息的定义出发，在标准的可检测性条件下，增广系统的稳态卡尔曼滤波器增益 $K_\\infty \\in \\mathbb{R}^{3 \\times 1}$ 是存在的。其通过求解离散时间代数黎卡提方程得到稳态估计误差协方差，并构建相应的最优增益表达式来获得。您必须为给定的测试用例数值计算 $K_\\infty$。为评估对协方差错误指定的灵敏度，定义灵敏度指数\n$$\nS := \\frac{\\|K_\\infty(Q_w', R_v') - K_\\infty(Q_w, R_v)\\|_F}{\\|K_\\infty(Q_w, R_v)\\|_F},\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数，$K_\\infty(Q_w, R_v)$ 是使用基线协方差计算的稳态增益，而 $K_\\infty(Q_w', R_v')$ 是使用错误指定的协方差 $Q_w' = s_Q Q_w$ 和 $R_v' = s_R R_v$ 计算的稳态增益，其中 $s_Q$ 和 $s_R$ 为正常数。\n\n您必须实现一个程序，对每个提供的测试用例，计算：\n- 基线稳态增益的弗罗贝尼乌斯范数 $\\|K_\\infty(Q_w, R_v)\\|_F$，以及\n- 针对指定的 $(s_Q, s_R)$ 的灵敏度指数 $S$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个形如 $[\\|K_\\infty\\|_F, S]$ 的双元素列表，两个值均为浮点数。例如，输出应类似于 $[[a,b],[c,d],\\ldots]$，不含空格。\n\n测试套件：\n使用上述固定矩阵 $A$ 和 $C$ 以及以下基线协方差和错误指定缩放因子。对于每个测试用例，$Q_w$ 是具有给定对角线元素的对角矩阵，$R_v$ 是标量。\n\n- 测试用例 1 (均衡基线，中等测量噪声):\n  - $Q_w = \\mathrm{diag}(1\\times 10^{-4},\\, 1\\times 10^{-3},\\, 1\\times 10^{-2})$,\n  - $R_v = 1\\times 10^{-2}$,\n  - $s_Q = 10$, $s_R = 0.1$.\n\n- 测试用例 2 (极小扰动方差，中等测量噪声):\n  - $Q_w = \\mathrm{diag}(1\\times 10^{-5},\\, 1\\times 10^{-5},\\, 1\\times 10^{-6})$,\n  - $R_v = 1\\times 10^{-2}$,\n  - $s_Q = 100$, $s_R = 1$.\n\n- 测试用例 3 (大过程噪声，极小测量噪声):\n  - $Q_w = \\mathrm{diag}(1\\times 10^{-2},\\, 1\\times 10^{-2},\\, 1\\times 10^{-1})$,\n  - $R_v = 1\\times 10^{-4}$,\n  - $s_Q = 0.1$, $s_R = 10$.\n\n- 测试用例 4 (中等过程噪声，大测量噪声):\n  - $Q_w = \\mathrm{diag}(1\\times 10^{-4},\\, 1\\times 10^{-3},\\, 1\\times 10^{-2})$,\n  - $R_v = 1$,\n  - $s_Q = 1$, $s_R = 100$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如 $[[r_1,s_1],[r_2,s_2],[r_3,s_3],[r_4,s_4]]$），其中 $r_i$ 是测试用例 $i$ 的基线稳态卡尔曼增益的弗罗贝尼乌斯范数，$s_i$ 是对应的灵敏度指数。无需单位，所有量都必须表示为浮点数。",
            "solution": "该问题要求计算一个离散时间线性增广系统的稳态卡尔曼滤波器增益，并分析其对噪声协方差矩阵错误指定的灵敏度。该系统描述了一个受缓慢变化扰动影响的对象动态，这是信息物理系统和控制工程中的常见场景。\n\n解决方案的基础在于状态空间模型的最优线性估计理论。给定的系统是一个离散时间线性时不变 (LTI) 系统，由以下状态空间方程描述：\n$$\nz_{k+1} = A z_k + w_k\n$$\n$$\ny_k = C z_k + v_k\n$$\n其中 $z_k \\in \\mathbb{R}^3$ 是增广状态向量，$y_k \\in \\mathbb{R}$ 是测量值，$A \\in \\mathbb{R}^{3 \\times 3}$ 是状态转移矩阵，$C \\in \\mathbb{R}^{1 \\times 3}$ 是测量矩阵。项 $w_k \\in \\mathbb{R}^3$ 和 $v_k \\in \\mathbb{R}$ 分别代表零均值、独立的高斯过程噪声和测量噪声，其协方差矩阵分别为 $Q_w = \\mathbb{E}[w_k w_k^\\top]$ 和 $R_v = \\mathbb{E}[v_k^2]$。\n\n卡尔曼滤波器是状态 $z_k$ 的最优估计器。它分两步运行：预测和更新。我们关心的是滤波器的稳态行为，此时滤波器增益收敛到一个常数值 $K_\\infty$。这发生在估计误差协方差达到稳态时。稳态先验误差协方差，记作 $P_\\infty$，是离散时间代数黎卡提方程 (DARE) 的唯一的、对称的、半正定解：\n$$\nP_\\infty = A P_\\infty A^\\top - A P_\\infty C^\\top (C P_\\infty C^\\top + R_v)^{-1} C P_\\infty A^\\top + Q_w\n$$\n为使唯一的稳定解存在，必须满足特定的可镇定性和可检测性条件。矩阵对 $(A, C)$ 必须是可检测的，矩阵对 $(A, \\sqrt{Q_w})$ 必须是可镇定的。对于给定的系统矩阵 $A$ 和 $C$，矩阵对 $(A, C)$ 是可观测的（比可检测性更强的条件），对于给定的正定 $Q_w$ 矩阵，矩阵对 $(A, \\sqrt{Q_w})$ 是可控的（比可镇定性更强的条件）。因此，保证存在唯一的解 $P_\\infty$。\n\n滤波 DARE 通常不直接求解。标准的数值求解器是为 LQR（线性二次调节器）控制 DARE 设计的。根据对偶原理，我们可以使用 LQR DARE 求解器。控制 DARE 是 $X = \\mathcal{A}^\\top X \\mathcal{A} - (\\mathcal{A}^\\top X \\mathcal{B})(\\mathcal{R} + \\mathcal{B}^\\top X \\mathcal{B})^{-1}(\\mathcal{B}^\\top X \\mathcal{A}) + \\mathcal{Q}$。通过设置 $\\mathcal{A}=A^\\top$，$\\mathcal{B}=C^\\top$，$\\mathcal{Q}=Q_w$ 和 $\\mathcal{R}=R_v$，求解 $X$ 即可得到所需的滤波协方差矩阵 $P_\\infty$。\n\n一旦找到稳态协方差 $P_\\infty$，稳态卡尔曼增益 $K_\\infty$ 按如下方式计算：\n$$\nK_\\infty = P_\\infty C^\\top (C P_\\infty C^\\top + R_v)^{-1}\n$$\n\n第一个目标是计算此基线增益的弗罗贝尼乌斯范数 $\\|K_\\infty(Q_w, R_v)\\|_F$。\n\n第二个目标是评估此增益对噪声协方差变化的灵敏度。错误指定的协方差定义为 $Q_w' = s_Q Q_w$ 和 $R_v' = s_R R_v$。通过用这些新的协方差求解 DARE，计算出新的稳态增益 $K_\\infty(Q_w', R_v')$。然后，灵敏度指数 $S$ 计算为弗罗贝尼乌斯范数的相对变化：\n$$\nS := \\frac{\\|K_\\infty(Q_w', R_v') - K_\\infty(Q_w, R_v)\\|_F}{\\|K_\\infty(Q_w, R_v)\\|_F}\n$$\n\n每个测试用例的总体算法如下：\n1.  定义系统矩阵 A、C 以及基线噪声协方差 Qw 和 Rv。\n2.  使用基线协方差求解 DARE，以获得稳态误差协方差 $P_\\infty$。\n3.  计算基线稳态卡尔曼增益 $K_\\infty(Q_w, R_v)$ 及其弗罗贝尼乌斯范数。\n4.  使用给定的缩放因子 $s_Q$ 和 $s_R$ 定义错误指定的噪声协方差 $Q_w' = s_Q Q_w$ 和 $R_v' = s_R R_v$。\n5.  再次使用错误指定的协方差求解 DARE，以获得 $P'_\\infty$。\n6.  计算新的稳态卡尔曼增益 $K_\\infty(Q_w', R_v')$。\n7.  计算灵敏度指数 $S$。\n8.  收集结果对：$[\\|K_\\infty(Q_w, R_v)\\|_F, S]$。\n\n对所提供的四个测试用例中的每一个都实施此程序。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_discrete_are\n\ndef compute_gain_and_sensitivity(A, C, Qw, Rv, sQ, sR):\n    \"\"\"\n    Computes the steady-state Kalman gain and its sensitivity to covariance mis-specification.\n    \n    Args:\n        A (np.ndarray): State transition matrix.\n        C (np.ndarray): Measurement matrix.\n        Qw (np.ndarray): Process noise covariance matrix.\n        Rv (float): Measurement noise variance.\n        sQ (float): Scaling factor for Qw.\n        sR (float): Scaling factor for Rv.\n        \n    Returns:\n        tuple[float, float]: A tuple containing the Frobenius norm of the baseline\n                             steady-state gain and the sensitivity index S.\n    \"\"\"\n    \n    # 1. Compute baseline steady-state Kalman gain\n    # The DARE for filtering P = A*P*A' - A*P*C'*(C*P*C' + R)^-1*C*P*A' + Q\n    # is solved using the dual LQR DARE solver solve_discrete_are by passing\n    # A.T, C.T, Qw, and Rv.\n    P_inf = solve_discrete_are(A.T, C.T, Qw, np.array([[Rv]]))\n    \n    # K_inf = P_inf * C' * inv(C * P_inf * C' + R)\n    K_inf = P_inf @ C.T @ np.linalg.inv(C @ P_inf @ C.T + Rv)\n    \n    # Compute the Frobenius norm of the baseline gain\n    norm_K_inf = np.linalg.norm(K_inf, 'fro')\n    \n    # 2. Compute gain with mis-specified covariances\n    Qw_prime = sQ * Qw\n    Rv_prime = sR * Rv\n    \n    P_inf_prime = solve_discrete_are(A.T, C.T, Qw_prime, np.array([[Rv_prime]]))\n    K_inf_prime = P_inf_prime @ C.T @ np.linalg.inv(C @ P_inf_prime @ C.T + Rv_prime)\n    \n    # 3. Compute the sensitivity index S\n    norm_diff = np.linalg.norm(K_inf_prime - K_inf, 'fro')\n    \n    # Avoid division by zero if the baseline gain happens to be zero.\n    if norm_K_inf == 0:\n        sensitivity = np.inf if norm_diff > 0 else 0.0\n    else:\n        sensitivity = norm_diff / norm_K_inf\n        \n    return norm_K_inf, sensitivity\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    \n    # Fixed system matrices\n    T = 0.1  # Sampling interval of 0.1 seconds\n    A = np.array([\n        [1.0, T, 0.0],\n        [0.0, 1.0, T],\n        [0.0, 0.0, 1.0]\n    ])\n    C = np.array([[1.0, 0.0, 0.0]])\n    \n    # Test Suite\n    test_cases = [\n        # Test case 1\n        {'Qw_diag': [1e-4, 1e-3, 1e-2], 'Rv': 1e-2, 'sQ': 10.0, 'sR': 0.1},\n        # Test case 2\n        {'Qw_diag': [1e-5, 1e-5, 1e-6], 'Rv': 1e-2, 'sQ': 100.0, 'sR': 1.0},\n        # Test case 3\n        {'Qw_diag': [1e-2, 1e-2, 1e-1], 'Rv': 1e-4, 'sQ': 0.1, 'sR': 10.0},\n        # Test case 4\n        {'Qw_diag': [1e-4, 1e-3, 1e-2], 'Rv': 1.0, 'sQ': 1.0, 'sR': 100.0},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        Qw = np.diag(case['Qw_diag'])\n        Rv = case['Rv']\n        sQ = case['sQ']\n        sR = case['sR']\n        \n        norm_k, sensitivity = compute_gain_and_sensitivity(A, C, Qw, Rv, sQ, sR)\n        results.append([norm_k, sensitivity])\n\n    # Format the final output string as [[r1,s1],[r2,s2],...] with no spaces.\n    inner_strings = [f\"[{r},{s}]\" for r, s in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}