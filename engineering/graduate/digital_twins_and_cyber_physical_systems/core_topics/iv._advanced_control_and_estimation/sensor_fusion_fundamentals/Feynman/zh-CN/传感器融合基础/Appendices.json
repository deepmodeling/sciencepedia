{
    "hands_on_practices": [
        {
            "introduction": "卡尔曼滤波器是现代状态估计的基石。第一个实践练习聚焦于其最关键的步骤：测量更新。通过手动计算一个简单二维系统的更新过程，您将具体理解滤波器如何将先验预测与新的测量值进行最优组合，从而精确修正其对系统状态的估计 。",
            "id": "4245541",
            "problem": "一个信息物理系统 (CPS) 内的一维传输线的数字孪生 (DT) 使用线性高斯传感器融合模型来估计其运动学状态。状态是二维的，$x_k = \\begin{pmatrix} p_k \\\\ v_k \\end{pmatrix}$，其中 $p_k$ 是以米为单位的位置，$v_k$ 是以米/秒为单位的速度。过程模型和测量模型是线性的：\n- 过程：$x_k = F x_{k-1} + w_{k-1}$，其中过程噪声 $w_{k-1} \\sim \\mathcal{N}(0, Q)$ 是零均值高斯噪声。\n- 测量：$z_k = H x_k + v_k$，其中测量噪声 $v_k \\sim \\mathcal{N}(0, R)$ 是零均值高斯噪声。\n\n在时间步 $k$，给定以下模型和数据：\n- 状态转移矩阵 $F = \\begin{pmatrix} 1  0.1 \\\\ 0  1 \\end{pmatrix}$。\n- 测量矩阵 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n- 过程噪声协方差是具有已知谱密度的连续白噪声加速度形式，但为完整起见，这里仅提供其离散协方差：$Q = \\sigma_a^2 \\begin{pmatrix} \\frac{(0.1)^4}{4}  \\frac{(0.1)^3}{2} \\\\ \\frac{(0.1)^3}{2}  (0.1)^2 \\end{pmatrix}$，对于某个已知的 $\\sigma_a$。该协方差在本次更新前已用于获得下述的先验协方差。\n- 测量噪声协方差 $R = \\begin{pmatrix} 0.25 \\end{pmatrix}$。\n- 先验（预测）状态估计 $\\hat{x}_{k \\mid k-1} = \\begin{pmatrix} 10.0 \\\\ 1.0 \\end{pmatrix}$，其先验协方差为 $P_{k \\mid k-1} = \\begin{pmatrix} 2.0  0.4 \\\\ 0.4  0.5 \\end{pmatrix}$。\n- 一个新的标量位置测量值 $z_k = 10.2$。\n\n使用作为卡尔曼滤波器 (KF) 基础的线性高斯贝叶斯估计基本原理，在时间 $k$ 执行一次测量更新。具体来说，推导并计算：\n- 新息 $\\nu_k$。\n- 新息协方差 $S_k$。\n- 卡尔曼增益 $K_k$。\n- 后验状态估计 $\\hat{x}_{k \\mid k}$。\n- 后验协方差 $P_{k \\mid k}$。\n\n最后，将更新后的位置分量，即 $\\hat{x}_{k \\mid k}$ 的第一个分量，作为最终答案报告，以米为单位并四舍五入到四位有效数字。不应报告任何其他量作为最终答案。所有中间计算都应与提供的统计模型和数据内部一致。",
            "solution": "在尝试求解之前，将首先对问题进行验证，以确保其科学上合理、良构且完整。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n问题陈述中提供的数据如下：\n- 状态向量：$x_k = \\begin{pmatrix} p_k \\\\ v_k \\end{pmatrix}$，其中 $p_k$ 是位置，$v_k$ 是速度。\n- 过程模型：$x_k = F x_{k-1} + w_{k-1}$，其中 $w_{k-1} \\sim \\mathcal{N}(0, Q)$。\n- 测量模型：$z_k = H x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0, R)$。\n- 状态转移矩阵：$F = \\begin{pmatrix} 1  0.1 \\\\ 0  1 \\end{pmatrix}$。\n- 测量矩阵：$H = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n- 过程噪声协方差上下文：$Q = \\sigma_a^2 \\begin{pmatrix} \\frac{(0.1)^4}{4}  \\frac{(0.1)^3}{2} \\\\ \\frac{(0.1)^3}{2}  (0.1)^2 \\end{pmatrix}$。\n- 测量噪声协方差：$R = \\begin{pmatrix} 0.25 \\end{pmatrix}$。\n- 时间 k 的先验状态估计：$\\hat{x}_{k \\mid k-1} = \\begin{pmatrix} 10.0 \\\\ 1.0 \\end{pmatrix}$。\n- 时间 k 的先验误差协方差：$P_{k \\mid k-1} = \\begin{pmatrix} 2.0  0.4 \\\\ 0.4  0.5 \\end{pmatrix}$。\n- 时间 k 的测量值：$z_k = 10.2$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n该问题描述了卡尔曼滤波器在线性高斯系统中进行状态估计的标准应用。\n- **科学依据**：该问题基于贝叶斯估计和卡尔曼滤波器的基本原理，这是现代控制理论和信号处理的基石。所用的物理模型（匀速运动）是对许多系统在短时间间隔内的标准且有效的近似。\n- **良构性**：该问题是良构的。卡尔曼滤波器测量更新步骤所需的所有输入——先验估计 ($\\hat{x}_{k \\mid k-1}$)、先验协方差 ($P_{k \\mid k-1}$)、测量值 ($z_k$)、测量矩阵 ($H$) 和测量噪声协方差 ($R$)——均已提供。所有矩阵和向量的维度对于执行所需的矩阵运算是一致的。\n- **客观性**：问题使用精确、客观的数学语言和数值进行陈述，没有主观或模棱两可的术语。\n- **完整性与一致性**：问题提供了一套自洽的信息，足以执行所要求的计算。矩阵 $F$ 和 $Q$ 是为产生先验估计的预测步骤提供上下文，但对于作为本问题重点的测量更新步骤而言并非必需。这并不构成不一致。协方差矩阵 $P_{k \\mid k-1}$ 和 $R$ 是对称的，且对角线元素为正，这与它们的定义相符。\n\n#### 步骤 3：结论与行动\n问题有效。这是一个关于应用卡尔曼滤波器测量更新方程的定义明确的标准练习。下面将进行求解。\n\n### 求解推导\n\n卡尔曼滤波器的测量更新步骤使用新的测量值 ($z_k$) 来修正预测的状态估计 ($\\hat{x}_{k \\mid k-1}$)。要计算的五个量按顺序推导如下。\n\n1.  **新息 ($\\nu_k$)**：新息，或称测量残差，是实际测量值 $z_k$ 与从先验状态估计预测出的测量值 $\\hat{z}_{k \\mid k-1} = H \\hat{x}_{k \\mid k-1}$ 之间的差。\n    $$\n    \\nu_k = z_k - H \\hat{x}_{k \\mid k-1}\n    $$\n    代入给定的值：\n    $$\n    H \\hat{x}_{k \\mid k-1} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 10.0 \\\\ 1.0 \\end{pmatrix} = 10.0\n    $$\n    因此，新息为：\n    $$\n    \\nu_k = 10.2 - 10.0 = 0.2\n    $$\n\n2.  **新息协方差 ($S_k$)**：这是新息的协方差，代表预测测量中的总不确定性。它是投影状态不确定性与测量噪声不确定性之和。\n    $$\n    S_k = H P_{k \\mid k-1} H^T + R\n    $$\n    代入给定的值：\n    $$\n    H P_{k \\mid k-1} H^T = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 2.0  0.4 \\\\ 0.4  0.5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2.0  0.4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 2.0\n    $$\n    加上测量噪声协方差：\n    $$\n    S_k = 2.0 + 0.25 = 2.25\n    $$\n    由于测量值是标量，$S_k$ 也是一个标量。\n\n3.  **卡尔曼增益 ($K_k$)**：卡尔曼增益是使后验状态误差协方差最小化的最优权重。它平衡了对先验估计的置信度与对测量值的置信度。\n    $$\n    K_k = P_{k \\mid k-1} H^T S_k^{-1}\n    $$\n    首先，我们计算 $P_{k \\mid k-1} H^T$ 项：\n    $$\n    P_{k \\mid k-1} H^T = \\begin{pmatrix} 2.0  0.4 \\\\ 0.4  0.5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2.0 \\\\ 0.4 \\end{pmatrix}\n    $$\n    标量新息协方差的逆是 $S_k^{-1} = (2.25)^{-1} = \\frac{1}{2.25} = \\frac{1}{9/4} = \\frac{4}{9}$。\n    现在，我们计算增益：\n    $$\n    K_k = \\begin{pmatrix} 2.0 \\\\ 0.4 \\end{pmatrix} \\frac{4}{9} = \\begin{pmatrix} 8.0/9 \\\\ 1.6/9 \\end{pmatrix} = \\begin{pmatrix} 8/9 \\\\ 8/45 \\end{pmatrix}\n    $$\n\n4.  **后验状态估计 ($\\hat{x}_{k \\mid k}$)**：更新后的状态估计是先验估计加上由卡尔曼增益加权的新息修正量。\n    $$\n    \\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + K_k \\nu_k\n    $$\n    代入计算出的值：\n    $$\n    \\hat{x}_{k \\mid k} = \\begin{pmatrix} 10.0 \\\\ 1.0 \\end{pmatrix} + \\begin{pmatrix} 8/9 \\\\ 8/45 \\end{pmatrix} (0.2)\n    $$\n    使用 $0.2 = \\frac{1}{5}$：\n    $$\n    \\hat{x}_{k \\mid k} = \\begin{pmatrix} 10.0 \\\\ 1.0 \\end{pmatrix} + \\begin{pmatrix} (8/9) \\times (1/5) \\\\ (8/45) \\times (1/5) \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 8/45 \\\\ 8/225 \\end{pmatrix} = \\begin{pmatrix} 10 + 8/45 \\\\ 1 + 8/225 \\end{pmatrix} = \\begin{pmatrix} 450/45 + 8/45 \\\\ 225/225 + 8/225 \\end{pmatrix} = \\begin{pmatrix} 458/45 \\\\ 233/225 \\end{pmatrix}\n    $$\n    以小数形式表示，$\\hat{x}_{k \\mid k} \\approx \\begin{pmatrix} 10.1778 \\\\ 1.0356 \\end{pmatrix}$。\n\n5.  **后验协方差 ($P_{k \\mid k}$)**：更新后的误差协方差反映了因测量而导致的不确定性的减小。一种常用且数值稳定的形式是 Joseph 形式，但这里使用更简单的形式 $P_{k \\mid k} = (I - K_k H) P_{k \\mid k-1}$ 是充分且精确的。\n    $$\n    P_{k \\mid k} = (I - K_k H) P_{k \\mid k-1}\n    $$\n    首先，计算 $I - K_k H$：\n    $$\n    K_k H = \\begin{pmatrix} 8/9 \\\\ 8/45 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 8/9  0 \\\\ 8/45  0 \\end{pmatrix}\n    $$\n    $$\n    I - K_k H = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 8/9  0 \\\\ 8/45  0 \\end{pmatrix} = \\begin{pmatrix} 1/9  0 \\\\ -8/45  1 \\end{pmatrix}\n    $$\n    现在，乘以先验协方差：\n    $$\n    P_{k \\mid k} = \\begin{pmatrix} 1/9  0 \\\\ -8/45  1 \\end{pmatrix} \\begin{pmatrix} 2.0  0.4 \\\\ 0.4  0.5 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{9}(2.0)  \\frac{1}{9}(0.4) \\\\ -\\frac{8}{45}(2.0) + 0.4  -\\frac{8}{45}(0.4) + 0.5 \\end{pmatrix}\n    $$\n    转换为分数：$2.0 = 2$，$0.4 = \\frac{2}{5}$，$0.5 = \\frac{1}{2}$。\n    $$\n    P_{k \\mid k} = \\begin{pmatrix} \\frac{2}{9}  \\frac{2}{45} \\\\ -\\frac{16}{45} + \\frac{2}{5}  -\\frac{16}{225} + \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{9}  \\frac{2}{45} \\\\ -\\frac{16}{45} + \\frac{18}{45}  -\\frac{32}{450} + \\frac{225}{450} \\end{pmatrix} = \\begin{pmatrix} 2/9  2/45 \\\\ 2/45  193/450 \\end{pmatrix}\n    $$\n\n问题要求的是更新后的位置分量，即后验状态估计 $\\hat{x}_{k \\mid k}$ 的第一个元素。\n$$\np_k^{\\text{updated}} = (\\hat{x}_{k \\mid k})_1 = \\frac{458}{45} \\approx 10.1777...\n$$\n将此值四舍五入至四位有效数字，得到 $10.18$。",
            "answer": "$$\n\\boxed{10.18}\n$$"
        },
        {
            "introduction": "现实世界中的系统通常是非线性的，这是标准卡尔曼滤波器无法直接应对的挑战。本练习将介绍无迹卡尔曼滤波器（UKF），这是一种功能强大的替代方案，它避免了分析线性化。您将应用无迹变换来传播通过非线性函数的不确定性，从而掌握一种最有效的非线性状态估计方法的实践技能 。",
            "id": "4245570",
            "problem": "一个信息物理系统 (CPS) 的数字孪生使用无迹卡尔曼滤波器 (UKF) 跟踪一个标量潜状态 $x$，该状态代表一个物理量（例如，归一化的热参数）。在接收到新的传感器读数之前，对 $x$ 的先验信念是均值为 $\\mu$、协方差为 $\\Sigma$（由于 $x$ 是标量，即方差）的高斯分布。传感器提供一个非线性测量，模型为 $z = h(x) + v$，其中 $h(x) = x^{2}$，$v$ 是均值为零、协方差为 $R$ 的高斯测量噪声，且与 $x$ 无关。\n\n给定以下用于单次测量更新的数值参数：\n- 先验均值 $\\mu = 1.2$ 和先验协方差 $\\Sigma = 0.25$。\n- 测量值 $z = 1.8$。\n- UKF 缩放参数 $\\alpha = 0.4$，$\\beta = 2$ 和 $\\kappa = 0$。\n- 测量噪声协方差 $R = 0.04$。\n\n从高斯先验的贝叶斯估计原理和无迹变换的矩匹配原理出发，对该标量系统执行一次 UKF 测量更新。计算 sigma 点，将它们通过 $h(x)$ 传播，并用它们来确定预测的测量均值、新息协方差、互协方差、卡尔曼增益 $K$，以及测量更新后的后验均值和协方差。\n\n以行矩阵的形式报告您的最终结果，顺序为 $K$、后验均值 $\\mu^{+}$ 和后验协方差 $\\Sigma^{+}$。将您的答案四舍五入到六位有效数字。最终报告的值中不要包含任何单位。",
            "solution": "首先验证问题，以确保其科学基础扎实、定义明确且客观。\n\n### 步骤 1：提取给定条件\n提供了以下数据和定义：\n- **潜状态：** 标量状态 $x$。状态维度为 $L=1$。\n- **先验信念：** 均值为 $\\mu = 1.2$、协方差为 $\\Sigma = 0.25$ 的高斯分布。\n- **测量模型：** $z = h(x) + v$，其中 $h(x) = x^2$。\n- **测量噪声：** 均值为零、协方差为 $R = 0.04$ 的高斯噪声 $v$。\n- **接收到的测量值：** $z = 1.8$。\n- **UKF 缩放参数：** $\\alpha = 0.4$，$\\beta = 2$，$\\kappa = 0$。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题是无迹卡尔曼滤波器 (UKF) 在非线性系统中进行测量更新的直接和标准应用。\n- **科学基础扎实：** UKF 是非线性状态估计中一个成熟的基础算法，广泛应用于工程和科学领域。所提供的模型是用于说明此类滤波器操作的典型示例。所有原理都是合理的。\n- **定义明确：** 该问题已完全指定，包含了计算单次更新步骤唯一解所需的所有必要参数（先验状态、测量模型、噪声统计、UKF 参数）。\n- **客观性：** 该问题使用精确的数学和工程术语陈述，不含主观性语言。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n无迹卡尔曼滤波器的测量更新主要分三个阶段进行：\n1.  生成 sigma 点及其权重。\n2.  使用无迹变换预测测量值及相关协方差。\n3.  更新状态估计及其协方差。\n\n**1. Sigma 点生成**\n\n首先，根据给定的 UKF 参数 $\\alpha$、$\\kappa$ 和状态维度 $L=1$ 计算复合缩放参数 $\\lambda$。\n$$ \\lambda = \\alpha^2(L + \\kappa) - L $$\n代入给定值：\n$$ \\lambda = (0.4)^2(1 + 0) - 1 = 0.16 - 1 = -0.84 $$\n共有 $2L+1 = 3$ 个 sigma 点。它们的生成方式如下：\n$$ \\mathcal{X}_0 = \\mu $$\n$$ \\mathcal{X}_i = \\mu + \\left(\\sqrt{(L+\\lambda)\\Sigma}\\right)_i \\quad \\text{for } i=1, \\dots, L $$\n$$ \\mathcal{X}_{i+L} = \\mu - \\left(\\sqrt{(L+\\lambda)\\Sigma}\\right)_i \\quad \\text{for } i=1, \\dots, L $$\n对于我们的标量情况 ($L=1$)，平方根项是一个标量：\n$$ \\sqrt{(L+\\lambda)\\Sigma} = \\sqrt{(1 - 0.84) \\times 0.25} = \\sqrt{0.16 \\times 0.25} = \\sqrt{0.04} = 0.2 $$\n这些 sigma 点是：\n$$ \\mathcal{X}_0 = 1.2 $$\n$$ \\mathcal{X}_1 = 1.2 + 0.2 = 1.4 $$\n$$ \\mathcal{X}_2 = 1.2 - 0.2 = 1.0 $$\n\n接下来，计算均值 ($W_m$) 和协方差 ($W_c$) 的权重：\n$$ W_{m,0} = \\frac{\\lambda}{L+\\lambda} = \\frac{-0.84}{1 - 0.84} = \\frac{-0.84}{0.16} = -5.25 $$\n$$ W_{c,0} = \\frac{\\lambda}{L+\\lambda} + (1 - \\alpha^2 + \\beta) = -5.25 + (1 - (0.4)^2 + 2) = -5.25 + (1 - 0.16 + 2) = -5.25 + 2.84 = -2.41 $$\n$$ W_{m,i} = W_{c,i} = \\frac{1}{2(L+\\lambda)} = \\frac{1}{2(1 - 0.84)} = \\frac{1}{2(0.16)} = \\frac{1}{0.32} = 3.125 \\quad \\text{for } i=1, 2 $$\n\n**2. 使用无迹变换进行预测**\n\n将 sigma 点通过非线性测量函数 $h(x) = x^2$ 传播，以获得预测的测量 sigma 点 $\\mathcal{Z}_i$：\n$$ \\mathcal{Z}_0 = h(\\mathcal{X}_0) = (1.2)^2 = 1.44 $$\n$$ \\mathcal{Z}_1 = h(\\mathcal{X}_1) = (1.4)^2 = 1.96 $$\n$$ \\mathcal{Z}_2 = h(\\mathcal{X}_2) = (1.0)^2 = 1.00 $$\n\n预测的测量均值 $\\hat{z}$ 是这些传播点的加权平均值：\n$$ \\hat{z} = \\sum_{i=0}^{2L} W_{m,i} \\mathcal{Z}_i = W_{m,0}\\mathcal{Z}_0 + W_{m,1}\\mathcal{Z}_1 + W_{m,2}\\mathcal{Z}_2 $$\n$$ \\hat{z} = (-5.25)(1.44) + (3.125)(1.96) + (3.125)(1.00) = -7.56 + 6.125 + 3.125 = 1.69 $$\n\n新息协方差 $S_{zz}$ 是传播点的加权协方差，加上测量噪声协方差 $R$：\n$$ S_{zz} = \\sum_{i=0}^{2L} W_{c,i} (\\mathcal{Z}_i - \\hat{z})(\\mathcal{Z}_i - \\hat{z})^T + R $$\n$$ S_{zz} = W_{c,0}(\\mathcal{Z}_0 - \\hat{z})^2 + W_{c,1}(\\mathcal{Z}_1 - \\hat{z})^2 + W_{c,2}(\\mathcal{Z}_2 - \\hat{z})^2 + R $$\n$$ S_{zz} = (-2.41)(1.44 - 1.69)^2 + (3.125)(1.96 - 1.69)^2 + (3.125)(1.00 - 1.69)^2 + 0.04 $$\n$$ S_{zz} = (-2.41)(-0.25)^2 + (3.125)(0.27)^2 + (3.125)(-0.69)^2 + 0.04 $$\n$$ S_{zz} = (-2.41)(0.0625) + (3.125)(0.0729) + (3.125)(0.4761) + 0.04 $$\n$$ S_{zz} = -0.150625 + 0.2278125 + 1.4878125 + 0.04 = 1.565 + 0.04 = 1.605 $$\n\n状态-测量互协方差 $S_{xz}$ 计算如下：\n$$ S_{xz} = \\sum_{i=0}^{2L} W_{c,i} (\\mathcal{X}_i - \\mu)(\\mathcal{Z}_i - \\hat{z})^T $$\n$$ S_{xz} = W_{c,0}(\\mathcal{X}_0 - \\mu)(\\mathcal{Z}_0 - \\hat{z}) + W_{c,1}(\\mathcal{X}_1 - \\mu)(\\mathcal{Z}_1 - \\hat{z}) + W_{c,2}(\\mathcal{X}_2 - \\mu)(\\mathcal{Z}_2 - \\hat{z}) $$\n由于 $\\mathcal{X}_0 - \\mu = 0$，第一项为零。\n$$ S_{xz} = (3.125)(1.4 - 1.2)(1.96 - 1.69) + (3.125)(1.0 - 1.2)(1.00 - 1.69) $$\n$$ S_{xz} = (3.125)(0.2)(0.27) + (3.125)(-0.2)(-0.69) $$\n$$ S_{xz} = 0.16875 + 0.43125 = 0.6 $$\n\n**3. 状态更新**\n\n计算卡尔曼增益 $K$：\n$$ K = S_{xz} S_{zz}^{-1} $$\n$$ K = \\frac{0.6}{1.605} \\approx 0.3738317757... $$\n\n使用卡尔曼增益和测量新息 $(z - \\hat{z})$ 更新后验状态均值 $\\mu^+$：\n$$ \\mu^+ = \\mu + K(z - \\hat{z}) $$\n$$ \\mu^+ = 1.2 + (\\frac{0.6}{1.605})(1.8 - 1.69) = 1.2 + (\\frac{0.6}{1.605})(0.11) $$\n$$ \\mu^+ = 1.2 + \\frac{0.066}{1.605} \\approx 1.2 + 0.0411214953... = 1.2411214953... $$\n\n更新后验状态协方差 $\\Sigma^+$：\n$$ \\Sigma^+ = \\Sigma - K S_{zz} K^T = \\Sigma - K S_{xz}^T $$\n$$ \\Sigma^+ = 0.25 - \\left(\\frac{0.6}{1.605}\\right) (1.605) \\left(\\frac{0.6}{1.605}\\right)^T = 0.25 - \\frac{(0.6)^2}{1.605} $$\n$$ \\Sigma^+ = 0.25 - \\frac{0.36}{1.605} \\approx 0.25 - 0.2242990654... = 0.0257009345... $$\n\n按要求将最终结果四舍五入到六位有效数字：\n- 卡尔曼增益 $K \\approx 0.373832$\n- 后验均值 $\\mu^+ \\approx 1.24112$\n- 后验协方差 $\\Sigma^+ \\approx 0.0257009$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.373832  1.24112  0.0257009 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在传感器融合中，一个常见但至关重要的错误是天真地组合误差相关的估计值，这会导致危险的过度自信。这个高级实践将直面这一问题。通过在信息域中进行推导，您将理解为何这种天真的方法会失败，并学会如何正确地融合相关数据，这是构建稳健可靠的信息物理系统的一项至关重要的技能 。",
            "id": "4245591",
            "problem": "一个信息物理系统 (CPS) 中的移动机器人数字孪生 (DT) 必须融合由两个感知管道产生的两个标量位置估计，这两个管道部分共享来自激光雷达 (LiDAR) 传感器的上游数据。由于这些管道重用了特征和预处理阶段，其估计误差在统计上是相关的。设潜在的真实标量状态为 $x \\in \\mathbb{R}$。每个管道产生一个测量值，建模为 $z_{1} = x + n_{1}$ 和 $z_{2} = x + n_{2}$，其中噪声 $n_{1}$ 和 $n_{2}$ 服从联合零均值高斯分布，其协方差矩阵为\n$$\nR = \\begin{pmatrix}\n\\sigma_{1}^{2}  \\sigma_{12} \\\\\n\\sigma_{12}  \\sigma_{2}^{2}\n\\end{pmatrix}.\n$$\n在许多工程栈中，一种朴素的融合方法将 $n_{1}$ 和 $n_{2}$ 视为独立的，但这在这里是不合适的。从线性模型的多元高斯推断和估计的信息形式的基本定义出发，请从第一性原理解释为什么忽略互相关性会导致过分自信的融合协方差。然后，使用联合信息矩阵方法，在互协方差 $\\sigma_{12}$ 已知的情况下，推导 $x$ 的校正后融合后验协方差。\n\n最后，对于一个具体实例，假设 DT 知道 $\\sigma_{1}^{2} = 0.04$ (平方米)，$\\sigma_{2}^{2} = 0.09$ (平方米)，以及 $\\sigma_{12} = 0.018$ (平方米)。请通过联合信息矩阵恰当地考虑相关性，计算 $x$ 的校正后融合后验方差。将最终方差以平方米为单位表示，并将您的答案四舍五入到五位有效数字。",
            "solution": "我们从多元高斯线性测量模型及其信息形式开始。状态 $x \\in \\mathbb{R}$ 由两个通道测量\n$$\nz = \\begin{pmatrix} z_{1} \\\\ z_{2} \\end{pmatrix} = H x + n, \\quad H = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n其中 $n \\sim \\mathcal{N}(0, R)$ 且\n$$\nR = \\begin{pmatrix}\n\\sigma_{1}^{2}  \\sigma_{12} \\\\\n\\sigma_{12}  \\sigma_{2}^{2}\n\\end{pmatrix}.\n$$\n我们假设 $x$ 服从无信息（非正常平坦）先验，因此后验完全由似然驱动。对数似然在相差一个加性常数的情况下为：\n$$\n\\ell(x) = -\\frac{1}{2} (z - H x)^{\\top} R^{-1} (z - H x).\n$$\n根据标准信息形式，$x$ 的后验精度（信息）为\n$$\nJ = H^{\\top} R^{-1} H,\n$$\n且后验协方差为\n$$\nP = J^{-1}.\n$$\n\n为什么朴素融合会过分自信：如果错误地假设独立性，就会将 $R$ 的非对角线元素设为零，即 $R_{\\text{naive}} = \\operatorname{diag}(\\sigma_{1}^{2}, \\sigma_{2}^{2})$。那么\n$$\nJ_{\\text{naive}} = \\frac{1}{\\sigma_{1}^{2}} + \\frac{1}{\\sigma_{2}^{2}},\n$$\n这重复计算了存在于相关误差中的共享信息内容。在正确的模型中，非对角项 $\\sigma_{12}$ 会减少有效信息，因为联合求逆 $R^{-1}$ 会降低冗余测量的权重。从数学上讲，在正相关（即 $\\sigma_{12} > 0$）的情况下，$H^{\\top} R^{-1} H \\leq \\frac{1}{\\sigma_{1}^{2}} + \\frac{1}{\\sigma_{2}^{2}}$，与朴素情况相比，这会产生更大（不那么过分自信）的方差 $P = J^{-1}$。直观地讲，相关性意味着两个通道不提供独立的证据；将它们视为独立的会高估精度并低估不确定性。\n\n使用联合信息矩阵推导校正后融合协方差：计算对称 $2 \\times 2$ 协方差的 $R^{-1}$，\n$$\nR = \\begin{pmatrix}\na  b \\\\\nb  c\n\\end{pmatrix}, \\quad a = \\sigma_{1}^{2}, \\quad b = \\sigma_{12}, \\quad c = \\sigma_{2}^{2}.\n$$\n其逆矩阵为\n$$\nR^{-1} = \\frac{1}{\\det(R)} \\begin{pmatrix}\nc  -b \\\\\n-b  a\n\\end{pmatrix}, \\quad \\det(R) = a c - b^{2}.\n$$\n因此，\n$$\nJ = H^{\\top} R^{-1} H = \\begin{pmatrix} 1  1 \\end{pmatrix} \\left( \\frac{1}{a c - b^{2}} \\begin{pmatrix}\nc  -b \\\\\n-b  a\n\\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{a + c - 2 b}{a c - b^{2}}.\n$$\n因此，校正后的融合协方差为\n$$\nP = J^{-1} = \\frac{a c - b^{2}}{a + c - 2 b} = \\frac{\\sigma_{1}^{2} \\sigma_{2}^{2} - \\sigma_{12}^{2}}{\\sigma_{1}^{2} + \\sigma_{2}^{2} - 2 \\sigma_{12}}.\n$$\n\n代入给定值 $\\sigma_{1}^{2} = 0.04$, $\\sigma_{2}^{2} = 0.09$, 以及 $\\sigma_{12} = 0.018$：\n$$\na = 0.04, \\quad c = 0.09, \\quad b = 0.018.\n$$\n计算行列式项：\n$$\na c - b^{2} = (0.04)(0.09) - (0.018)^{2} = 0.0036 - 0.000324 = 0.003276.\n$$\n计算分母：\n$$\na + c - 2 b = 0.04 + 0.09 - 2 \\times 0.018 = 0.13 - 0.036 = 0.094.\n$$\n因此，校正后的融合后验方差为\n$$\nP = \\frac{0.003276}{0.094} = 0.0348510638297872\\ldots\n$$\n四舍五入到五位有效数字，\n$$\nP \\approx 0.034851.\n$$\n这个以平方米为单位表示的值，大于朴素独立融合方差\n$$\nP_{\\text{naive}} = \\left( \\frac{1}{0.04} + \\frac{1}{0.09} \\right)^{-1} = (25 + 11.\\overline{1})^{-1} \\approx 0.027682,\n$$\n这证实了忽略相关性会导致一个过分自信（过小）的协方差估计。联合信息矩阵通过非对角协方差正确地考虑了冗余性，并得出了一个更符合实际的不确定性。",
            "answer": "$$\\boxed{0.034851}$$"
        }
    ]
}