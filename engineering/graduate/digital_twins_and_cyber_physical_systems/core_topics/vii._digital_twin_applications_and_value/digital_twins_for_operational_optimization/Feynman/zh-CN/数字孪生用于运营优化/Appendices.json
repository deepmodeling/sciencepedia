{
    "hands_on_practices": [
        {
            "introduction": "数字孪生的价值取决于它能否精确反映其物理实体的状态。本练习  介绍了扩展卡尔曼滤波器 (Extended Kalman Filter, EKF)，这是一种利用实时、非线性的传感器数据来更新孪生体状态的核心算法。通过推导 EKF 的更新方程并分析其稳态行为，您将对数字孪生如何保持其保真度获得基础性的理解。",
            "id": "4215646",
            "problem": "一个用于信息物理系统 (CPS) 运行优化的数字孪生维护一个潜在运行效率指标 $x_t \\in \\mathbb{R}$ 的估计值，该指标随加性、零均值的高斯过程噪声进行随机游走演化。状态演化和测量模型由下式给出\n$$x_{t+1} = x_t + w_t,$$\n$$y_t = h(x_t) + v_t,$$\n其中 $w_t \\sim \\mathcal{N}(0,Q)$ 和 $v_t \\sim \\mathcal{N}(0,R)$ 相互独立且在时间上不相关。该数字孪生使用扩展卡尔曼滤波器 (EKF) 实时同化测量值。测量函数为\n$$h(x) = \\arctan(x).$$\n在时刻 $t$，EKF 具有一个高斯先验信念 $x_t \\sim \\mathcal{N}(\\hat{x}_t^{-},P_t^{-})$。\n\n任务1（推导）：严格从第一性原理出发——即高斯先验的贝叶斯法则、$w_t$ 和 $v_t$ 的独立性和高斯性、以及关于先验均值对 $h(x)$ 进行的一阶泰勒线性化——推导后验均值 $\\hat{x}_t$ 和后验协方差 $P_t$ 的 EKF 测量更新方程，用雅可比矩阵 $H_t = \\frac{d h}{d x}\\big|_{x=\\hat{x}_t^{-}}$、先验协方差 $P_t^{-}$ 和测量噪声方差 $R$ 来表示。\n\n任务2（稳态计算）：为了生产规划，数字孪生在工作点 $x^{\\ast} = 1$ 处进行一致的线性化。假设工作点由一个监控控制器维持，因此局部线性化斜率是恒定的，\n$$H = \\frac{d h}{d x}\\bigg|_{x=1}.$$\n假设随机游走状态模型的状态转移雅可比矩阵为 $A=1$，并且过程噪声方差和测量噪声方差固定为\n$$Q = 0.01, \\quad R = 0.04.$$\n在时不变的 $A$、$H$、$Q$ 和 $R$ 以及重复同化测量的条件下，EKF 后验协方差 $P_t$ 会收敛到一个稳态值 $P$，该值是预测和更新循环所产生的时不变标量离散代数 Riccati 方程的定点解。计算这个稳态后验协方差 $P$。\n\n答案规格：\n- 将最终的稳态协方差表示为一个无量纲的实数。\n- 将最终数值答案四舍五入到四位有效数字。",
            "solution": "该问题分为两个任务。第一个任务是推导扩展卡尔曼滤波器 (EKF) 的测量更新方程。第二个任务是计算滤波器特定实例的稳态后验协方差。\n\n**任务1：EKF 测量更新方程的推导**\n\n推导从贝叶斯法则开始，该法则将给定测量值 $y_t$ 时状态 $x_t$ 的后验概率密度与先验密度和测量的似然函数联系起来。\n$$p(x_t | y_t) \\propto p(y_t | x_t) p(x_t)$$\n问题指定了先验和测量模型，它们定义了等式右侧的分布。\n\n关于状态 $x_t$ 的先验信念是高斯分布的：\n$$p(x_t) = \\mathcal{N}(x_t; \\hat{x}_t^-, P_t^-) = \\frac{1}{\\sqrt{2\\pi P_t^-}} \\exp\\left(-\\frac{1}{2} \\frac{(x_t - \\hat{x}_t^-)^2}{P_t^-}\\right)$$\n其中 $\\hat{x}_t^-$ 是先验均值，$P_t^-$ 是先验协方差。\n\n测量模型为 $y_t = h(x_t) + v_t$，其中测量噪声 $v_t$ 来自均值为零、方差为 $R$ 的高斯分布，即 $v_t \\sim \\mathcal{N}(0, R)$。这意味着在给定状态 $x_t$ 的条件下观测到 $y_t$ 的似然函数也是高斯的：\n$$p(y_t | x_t) = \\mathcal{N}(y_t; h(x_t), R) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2} \\frac{(y_t - h(x_t))^2}{R}\\right)$$\n\n这两个分布的乘积给出了后验分布。\n$$p(x_t | y_t) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(y_t - h(x_t))^2}{R}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(x_t - \\hat{x}_t^-)^2}{P_t^-}\\right)$$\n\n由于测量函数 $h(x_t)$ 是非线性的，得到的后验分布 $p(x_t | y_t)$ 是非高斯的。EKF 通过在先验均值 $\\hat{x}_t^-$ 附近将测量函数 $h(x_t)$ 线性化，从而将后验分布近似为高斯分布。一阶泰勒级数展开给出：\n$$h(x_t) \\approx h(\\hat{x}_t^-) + H_t (x_t - \\hat{x}_t^-)$$\n其中 $H_t$ 是 $h(x)$ 在先验均值处求值的雅可比矩阵（在此标量情况下为导数）：\n$$H_t = \\frac{d h}{d x}\\bigg|_{x=\\hat{x}_t^-}$$\n将线性化的 $h(x_t)$ 代入后验表达式，指数部分（忽略 $-\\frac{1}{2}$ 因子）变为：\n$$J(x_t) = \\frac{(y_t - [h(\\hat{x}_t^-) + H_t (x_t - \\hat{x}_t^-)])^2}{R} + \\frac{(x_t - \\hat{x}_t^-)^2}{P_t^-}$$\n令测量新息为 $e_t = y_t - h(\\hat{x}_t^-)$。则表达式简化为：\n$$J(x_t) = \\frac{(e_t - H_t (x_t - \\hat{x}_t^-))^2}{R} + \\frac{(x_t - \\hat{x}_t^-)^2}{P_t^-}$$\n展开各项，我们得到一个关于 $x_t$ 的二次函数：\n$$J(x_t) = \\frac{e_t^2 - 2 e_t H_t (x_t - \\hat{x}_t^-) + H_t^2 (x_t - \\hat{x}_t^-)^2}{R} + \\frac{(x_t - \\hat{x}_t^-)^2}{P_t^-}$$\n$$J(x_t) = (x_t - \\hat{x}_t^-)^2 \\left(\\frac{H_t^2}{R} + \\frac{1}{P_t^-}\\right) - 2(x_t - \\hat{x}_t^-) \\frac{e_t H_t}{R} + \\frac{e_t^2}{R}$$\n后验分布 $p(x_t | y_t)$ 近似为高斯分布，$p(x_t | y_t) \\approx \\mathcal{N}(x_t; \\hat{x}_t, P_t)$，其形式为 $\\exp(-\\frac{1}{2} \\frac{(x_t - \\hat{x}_t)^2}{P_t})$。通过配方法或比较二次型 $J(x_t)$ 的系数，我们可以确定后验均值 $\\hat{x}_t$ 和协方差 $P_t$。\n\n后验协方差 $P_t$ 的逆是指数中 $(x_t - \\dots)^2$ 项的系数，即逆协方差之和（信息形式）：\n$$(P_t)^{-1} = (P_t^-)^{-1} + H_t^T R^{-1} H_t = \\frac{1}{P_t^-} + \\frac{H_t^2}{R}$$\n求解后验协方差 $P_t$：\n$$P_t = \\left(\\frac{1}{P_t^-} + \\frac{H_t^2}{R}\\right)^{-1} = \\frac{P_t^- R}{R + P_t^- H_t^2}$$\n\n为了求后验均值 $\\hat{x}_t$，我们通过将其导数设为零来找到使 $J(x_t)$ 最小化的 $x_t$ 值：\n$$\\frac{d J(x_t)}{d x_t} = 2(x_t - \\hat{x}_t^-)\\left(\\frac{H_t^2}{R} + \\frac{1}{P_t^-}\\right) - 2\\frac{e_t H_t}{R} = 0$$\n$$(x_t - \\hat{x}_t^-)\\left(\\frac{1}{P_t}\\right) = \\frac{e_t H_t}{R}$$\n最小化者即后验均值 $\\hat{x}_t$，因此：\n$$\\hat{x}_t - \\hat{x}_t^- = P_t \\frac{H_t}{R} e_t = \\left(\\frac{P_t^- R}{R + P_t^- H_t^2}\\right) \\frac{H_t}{R} e_t = \\frac{P_t^- H_t}{R + P_t^- H_t^2} e_t$$\n这给出了后验均值更新方程：\n$$\\hat{x}_t = \\hat{x}_t^- + K_t (y_t - h(\\hat{x}_t^-))$$\n其中卡尔曼增益 $K_t$ 定义为：\n$$K_t = \\frac{P_t^- H_t}{H_t^2 P_t^- + R}$$\n后验协方差更新也可以用卡尔曼增益表示：\n$$P_t = (1 - K_t H_t) P_t^-$$\n\n因此，EKF 测量更新方程为：\n后验均值：$\\hat{x}_t = \\hat{x}_t^{-} + K_t (y_t - h(\\hat{x}_t^{-}))$\n后验协方差：$P_t = (1 - K_t H_t) P_t^{-}$\n其中卡尔曼增益 $K_t = P_t^{-} H_t (H_t^2 P_t^{-} + R)^{-1}$。如上所述，后验协方差的一个等价形式是 $P_t = ( (P_t^{-})^{-1} + H_t^2 R^{-1} )^{-1}$。\n\n**任务2：稳态协方差计算**\n\nEKF 在一个两步循环中运行：预测和更新。对于协方差，这些步骤是：\n1.  **预测：** 下一时刻的先验协方差 $P_{t+1}^{-}$ 是根据当前后验协方差 $P_t$ 预测的。\n    $$P_{t+1}^{-} = A P_t A^T + Q$$\n2.  **更新：** 后验协方差 $P_{t+1}$ 是根据先验 $P_{t+1}^{-}$ 计算的。\n    $$P_{t+1} = (1 - K_{t+1} H_{t+1}) P_{t+1}^{-}$$\n\n在本问题中，假设系统一直运行直到协方差收敛到一个稳态值。这意味着 $P_t = P_{t+1} = P$ 并且 $P_t^- = P_{t+1}^- = P^-$。雅可比矩阵和噪声方差也是时不变的。稳态协方差 $P$ 和 $P^-$ 必须满足以下代数方程：\n$$P^{-} = A P A^T + Q$$\n$$P = \\frac{R P^{-}}{H^2 P^{-} + R}$$\n这里我们使用了协方差更新的 Joseph 形式，这种形式通常更稳定。\n给定值为：\n状态转移雅可比矩阵 $A = 1$。\n过程噪声方差 $Q = 0.01$。\n测量噪声方差 $R = 0.04$。\n测量函数为 $h(x) = \\arctan(x)$，所以其导数为 $\\frac{dh}{dx} = \\frac{1}{1+x^2}$。\n线性化在恒定的工作点 $x^* = 1$ 处执行。\n$$H = \\frac{d h}{d x}\\bigg|_{x=1} = \\frac{1}{1+1^2} = \\frac{1}{2} = 0.5$$\n\n将 $A=1$ 代入预测方程得到：\n$$P^{-} = P + Q$$\n将这个 $P^{-}$ 的表达式代入更新方程，得到关于后验协方差 $P$ 的标量离散代数 Riccati 方程 (DARE)：\n$$P = \\frac{R (P+Q)}{H^2 (P+Q) + R}$$\n重新整理方程以求解 $P$：\n$$P (H^2 (P+Q) + R) = R (P+Q)$$\n$$H^2 P^2 + H^2 Q P + R P = R P + R Q$$\n$$H^2 P^2 + H^2 Q P - R Q = 0$$\n这是一个关于 $P$ 的二次方程，形式为 $aP^2 + bP + c = 0$，系数为：\n$a = H^2 = (0.5)^2 = 0.25$\n$b = H^2 Q = 0.25 \\times 0.01 = 0.0025$\n$c = -R Q = -0.04 \\times 0.01 = -0.0004$\n\n二次方程为：\n$$0.25 P^2 + 0.0025 P - 0.0004 = 0$$\n我们使用二次公式 $P = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来求解 $P$：\n$$P = \\frac{-0.0025 \\pm \\sqrt{(0.0025)^2 - 4(0.25)(-0.0004)}}{2(0.25)}$$\n$$P = \\frac{-0.0025 \\pm \\sqrt{0.00000625 + 0.0004}}{0.5}$$\n$$P = \\frac{-0.0025 \\pm \\sqrt{0.00040625}}{0.5}$$\n平方根项的精确值可以通过注意到 $\\sqrt{0.00040625} = \\sqrt{6.25 \\times 65 \\times 10^{-6}} = 2.5 \\sqrt{65} \\times 10^{-3}$ 来找到，但使用数值就足够了。\n$$\\sqrt{0.00040625} \\approx 0.020155644$$\n$$P = \\frac{-0.0025 \\pm 0.020155644}{0.5}$$\n由于协方差 $P$ 必须为非负量，我们取正根：\n$$P = \\frac{-0.0025 + 0.020155644}{0.5} = \\frac{0.017655644}{0.5} = 0.035311288$$\n问题要求答案四舍五入到四位有效数字。\n$$P \\approx 0.03531$$\n该值代表了数字孪生所维护的运行效率指标估计的稳态后验方差。",
            "answer": "$$\\boxed{0.03531}$$"
        },
        {
            "introduction": "一旦数字孪生完成同步，它便成为一个强大的决策工具。本实践  聚焦于一个核心应用：在遵守物理约束的前提下，优化运行参数以实现利润最大化。您将应用 Karush-Kuhn-Tucker (KKT) 条件来解决这个问题，并且至关重要的是，将拉格朗日乘子解读为“影子价格”，从而揭示有限资源的经济价值。",
            "id": "4215652",
            "problem": "一个信息物理生产单元使用数字孪生 (DT) 进行操作，以优化两个并行的机器设定点，这两个设定点被建模为决策变量 $x_1$ 和 $x_2$，单位为单位/小时。该数字孪生的运营目标是在受限于根据传感器遥测数据建模的资源预算（电力和散热能力）的情况下，最大化具有收益递减特性的小时利润。利润模型是凹函数，由下式给出\n$$\nf(x_1,x_2) = a_1 x_1 - \\frac{b_1}{2} x_1^2 + a_2 x_2 - \\frac{b_2}{2} x_2^2,\n$$\n资源约束条件为\n$$\ne_1 x_1 + e_2 x_2 \\leq E_{\\max}, \\qquad t_1 x_1 + t_2 x_2 \\leq T_{\\max}, \\qquad x_1 \\geq 0, \\qquad x_2 \\geq 0.\n$$\n这里，$a_i$ 是单位收益，单位为美元/单位；$b_i$ 是参数化收益递减的参数，单位为美元/(单位/小时)²；$e_i$ 是电力强度，单位为$\\text{kW}$/(单位/小时)；$t_i$ 是热负荷强度，单位为$\\text{kW}$/(单位/小时)；$E_{\\max}$ 是可用电力容量，单位为$\\text{kW}$；$T_{\\max}$ 是可用散热能力，单位为$\\text{kW}$。对于此数字孪生实例，参数如下\n$$\na_1 = \\$\\,100, \\quad b_1 = \\$\\,2, \\quad a_2 = \\$\\,80, \\quad b_2 = \\$\\,1, \\quad e_1 = 3, \\quad e_2 = 2, \\quad t_1 = 1, \\quad t_2 = 3, \\quad E_{\\max} = 100, \\quad T_{\\max} = 90.\n$$\n从约束优化、拉格朗日对偶性和Karush-Kuhn-Tucker (KKT)条件的基本定义出发，推导此运营优化的KKT最优性条件，并将每个拉格朗日乘子解释为量化边际资源权衡的物理影子价格。然后，对于给定的数值参数，计算电力影子价格的数值，即在最优点与电力预算 $e_1 x_1 + e_2 x_2 \\leq E_{\\max}$ 相关联的拉格朗日乘子的值。请以美元/千瓦 ($\\$/\\text{kW}$) 为单位表示最终答案，并将答案四舍五入至四位有效数字。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤1：提取已知条件\n问题提供了以下数据和定义：\n- **决策变量**：机器设定点 $x_1$ 和 $x_2$，单位为单位/小时。\n- **目标函数 (利润)**：$f(x_1,x_2) = a_1 x_1 - \\frac{b_1}{2} x_1^2 + a_2 x_2 - \\frac{b_2}{2} x_2^2$，待最大化。\n- **资源约束**：\n  - 电力：$e_1 x_1 + e_2 x_2 \\leq E_{\\max}$\n  - 散热：$t_1 x_1 + t_2 x_2 \\leq T_{\\max}$\n  - 非负性：$x_1 \\geq 0$，$x_2 \\geq 0$\n- **参数定义和单位**：\n  - $a_i$：单位收益，单位为美元/单位。\n  - $b_i$：收益递减参数，单位为美元/(单位/小时)²。\n  - $e_i$：电力强度，单位为$\\text{kW}$/(单位/小时)。\n  - $t_i$：热负荷强度，单位为$\\text{kW}$/(单位/小时)。\n  - $E_{\\max}$：可用电力容量，单位为$\\text{kW}$。\n  - $T_{\\max}$：可用散热能力，单位为$\\text{kW}$。\n- **数值**：\n  - $a_1 = 100$\n  - $b_1 = 2$\n  - $a_2 = 80$\n  - $b_2 = 1$\n  - $e_1 = 3$\n  - $e_2 = 2$\n  - $t_1 = 1$\n  - $t_2 = 3$\n  - $E_{\\max} = 100$\n  - $T_{\\max} = 90$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是约束优化问题的一个标准实例，特别是二次规划。在工程与运筹学中，以资源约束（电力、热负荷）优化生产过程是一个成熟且现实的应用。通过凹二次利润函数来模拟收益递减也是一个标准的经济学原理。该问题不含伪科学，并依赖于基本的数学和工程原理。\n- **良态性**：目标函数是严格凹函数，约束是线性的，定义了一个凸且非空的可行集。在凸集上最大化一个严格凹函数是一个凸优化问题，保证有唯一解。该问题提供了所有必要的参数并定义了明確的目标。\n- **客观性**：问题陈述使用了精确、无歧义的数学和技术语言。它不含主观论断。\n- **其他标准**：问题是自洽的，其数据在量纲上是一致的，并且不是平凡或循环论证的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n任务是解决一个约束优化问题。该问题是在一组线性不等式约束下，最大化利润函数 $f(x_1, x_2)$。\n利润函数为\n$$f(x_1,x_2) = a_1 x_1 - \\frac{b_1}{2} x_1^2 + a_2 x_2 - \\frac{b_2}{2} x_2^2$$\n$f(x_1, x_2)$ 的Hessian矩阵是 $\\nabla^2 f = \\begin{pmatrix} -b_1  0 \\\\ 0  -b_2 \\end{pmatrix}$。已知 $b_1=2$ 和 $b_2=1$ 均为正数，所以Hessian矩阵是负定的。这证实了 $f(x_1, x_2)$ 是一个严格凹函数。可行域由线性不等式定义，形成一个凸集。在凸集上最大化一个凹函数是一个凸优化问题，对此问题，Karush-Kuhn-Tucker (KKT) 条件是全局最优的充分必要条件。\n\n我们定义拉格朗日函数 $\\mathcal{L}$ 以引入约束条件。对于最大化问题，约束的标准形式是 $g_i(\\mathbf{x}) \\leq 0$。约束条件为：\n$g_1(x_1, x_2) = e_1 x_1 + e_2 x_2 - E_{\\max} \\leq 0$\n$g_2(x_1, x_2) = t_1 x_1 + t_2 x_2 - T_{\\max} \\leq 0$\n$g_3(x_1, x_2) = -x_1 \\leq 0$\n$g_4(x_1, x_2) = -x_2 \\leq 0$\n\n设 $\\lambda_E, \\lambda_T, \\mu_1, \\mu_2$ 分别是与约束 $g_1, g_2, g_3, g_4$ 相关联的非负拉格朗日乘子。拉格朗日函数为：\n$$\\mathcal{L}(x_1, x_2, \\lambda_E, \\lambda_T, \\mu_1, \\mu_2) = f(x_1, x_2) - \\lambda_E(e_1 x_1 + e_2 x_2 - E_{\\max}) - \\lambda_T(t_1 x_1 + t_2 x_2 - T_{\\max}) - \\mu_1(-x_1) - \\mu_2(-x_2)$$\n\nKKT条件如下：\n1.  **平稳性**：拉格朗日函数相对于决策变量的梯度必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial x_1} = a_1 - b_1 x_1 - e_1 \\lambda_E - t_1 \\lambda_T + \\mu_1 = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial x_2} = a_2 - b_2 x_2 - e_2 \\lambda_E - t_2 \\lambda_T + \\mu_2 = 0 $$\n\n2.  **原始可行性**：必须满足原始约束条件。\n    $$ e_1 x_1 + e_2 x_2 \\leq E_{\\max} $$\n    $$ t_1 x_1 + t_2 x_2 \\leq T_{\\max} $$\n    $$ x_1 \\geq 0, \\quad x_2 \\geq 0 $$\n\n3.  **对偶可行性**：不等式约束的拉格朗日乘子必须为非负。\n    $$ \\lambda_E \\geq 0, \\quad \\lambda_T \\geq 0, \\quad \\mu_1 \\geq 0, \\quad \\mu_2 \\geq 0 $$\n\n4.  **互补松弛性**：每个拉格朗日乘子与其对应的约束（形式为 $g_i(\\mathbf{x})=0$）的乘积必须为零。\n    $$ \\lambda_E (e_1 x_1 + e_2 x_2 - E_{\\max}) = 0 $$\n    $$ \\lambda_T (t_1 x_1 + t_2 x_2 - T_{\\max}) = 0 $$\n    $$ \\mu_1 x_1 = 0 $$\n    $$ \\mu_2 x_2 = 0 $$\n\n### 拉格朗日乘子（影子价格）的解释\n在此问题背景下，拉格朗日乘子 $\\lambda_E$ 和 $\\lambda_T$ 具有直接的物理和经济解释。它们被称为影子价格。设 $f^*$ 为最优利润，它是资源预算的函数，即 $f^*(E_{\\max}, T_{\\max})$。\n- 乘子 $\\lambda_E$ 表示电力资源的边际价值，由 $\\lambda_E = \\frac{\\partial f^*}{\\partial E_{\\max}}$ 给出。它量化了当电力容量 $E_{\\max}$ 增加一个单位（一$\\text{kW}$）时，最大可能利润的增长率。其单位是美元/千瓦 ($\\$/\\text{kW}$)。\n- 类似地，$\\lambda_T = \\frac{\\partial f^*}{\\partial T_{\\max}}$ 表示散热能力的边际价值。它是当 $T_{\\max}$ 增加一个单位时，最大利润的增长率，其单位也是美元/千瓦 ($\\$/\\text{kW}$)。\n如果一个约束不活跃（即资源未被完全使用），其对应的拉格朗日乘子为零，表示拥有更多该资源不会提高利润。\n\n### 数值解\n现在我们将给定的数值参数代入KKT条件。\n$a_1 = 100, b_1 = 2, a_2 = 80, b_2 = 1, e_1 = 3, e_2 = 2, t_1 = 1, t_2 = 3, E_{\\max} = 100, T_{\\max} = 90$。\n\nKKT系统变为：\n1.  **平稳性**：\n    (i) $100 - 2x_1 - 3\\lambda_E - \\lambda_T + \\mu_1 = 0$\n    (ii) $80 - x_2 - 2\\lambda_E - 3\\lambda_T + \\mu_2 = 0$\n2.  **原始可行性**：\n    (iii) $3x_1 + 2x_2 \\leq 100$\n    (iv) $x_1 + 3x_2 \\leq 90$\n    (v) $x_1 \\geq 0, x_2 \\geq 0$\n3.  **对偶可行性**：\n    (vi) $\\lambda_E \\geq 0, \\lambda_T \\geq 0, \\mu_1 \\geq 0, \\mu_2 \\geq 0$\n4.  **互补松弛性**：\n    (vii) $\\lambda_E(3x_1 + 2x_2 - 100) = 0$\n    (viii) $\\lambda_T(x_1 + 3x_2 - 90) = 0$\n    (ix) $\\mu_1 x_1 = 0$\n    (x) $\\mu_2 x_2 = 0$\n\n我们通过考虑不同约束活跃的情况来解这个系统。由于无约束最优解 ($x_1=50, x_2=80$) 远离原点，我们可以合理假设 $x_1  0$ 和 $x_2  0$。这意味着 $\\mu_1 = 0$ 和 $\\mu_2 = 0$。\n\n**情况1**：两个主要约束 (iii) 和 (iv) 都不活跃。\n这意味着 $\\lambda_E = 0$ 和 $\\lambda_T = 0$。平稳性方程变为 $100 - 2x_1 = 0 \\Rightarrow x_1=50$ 和 $80-x_2=0 \\Rightarrow x_2=80$。检查可行性：$3(50) + 2(80) = 150+160=310$，这违反了 $310 \\leq 100$。这种情况不是解。\n\n**情况2**：电力约束 (iii) 活跃，散热约束 (iv) 不活跃。\n因此，$3x_1 + 2x_2 = 100$ 且 $\\lambda_T = 0$。平稳性方程变为：\n$100 - 2x_1 - 3\\lambda_E = 0 \\Rightarrow x_1 = 50 - \\frac{3}{2}\\lambda_E$\n$80 - x_2 - 2\\lambda_E = 0 \\Rightarrow x_2 = 80 - 2\\lambda_E$\n代入活跃约束：\n$3(50 - \\frac{3}{2}\\lambda_E) + 2(80 - 2\\lambda_E) = 100$\n$150 - \\frac{9}{2}\\lambda_E + 160 - 4\\lambda_E = 100 \\Rightarrow 310 - \\frac{17}{2}\\lambda_E = 100 \\Rightarrow \\frac{17}{2}\\lambda_E = 210 \\Rightarrow \\lambda_E = \\frac{420}{17}  0$。\n$x_1 = 50 - \\frac{3}{2}(\\frac{420}{17}) = \\frac{850-630}{17} = \\frac{220}{17}  0$。\n$x_2 = 80 - 2(\\frac{420}{17}) = \\frac{1360-840}{17} = \\frac{520}{17}  0$。\n检查不活跃的约束 (iv)：$x_1 + 3x_2 = \\frac{220}{17} + 3(\\frac{520}{17}) = \\frac{220+1560}{17} = \\frac{1780}{17} \\approx 104.7$。这违反了 $x_1+3x_2 \\leq 90$。这种情况不是解。\n\n**情况3**：散热约束 (iv) 活跃，电力约束 (iii) 不活跃。\n因此，$x_1 + 3x_2 = 90$ 且 $\\lambda_E = 0$。平稳性方程变为：\n$100 - 2x_1 - \\lambda_T = 0 \\Rightarrow x_1 = 50 - \\frac{1}{2}\\lambda_T$\n$80 - x_2 - 3\\lambda_T = 0 \\Rightarrow x_2 = 80 - 3\\lambda_T$\n代入活跃约束：\n$(50 - \\frac{1}{2}\\lambda_T) + 3(80 - 3\\lambda_T) = 90$\n$50 - \\frac{1}{2}\\lambda_T + 240 - 9\\lambda_T = 90 \\Rightarrow 290 - \\frac{19}{2}\\lambda_T = 90 \\Rightarrow \\frac{19}{2}\\lambda_T = 200 \\Rightarrow \\lambda_T = \\frac{400}{19}  0$。\n$x_1 = 50 - \\frac{1}{2}(\\frac{400}{19}) = \\frac{950-200}{19} = \\frac{750}{19}  0$。\n$x_2 = 80 - 3(\\frac{400}{19}) = \\frac{1520-1200}{19} = \\frac{320}{19}  0$。\n检查不活跃的约束 (iii)：$3x_1 + 2x_2 = 3(\\frac{750}{19}) + 2(\\frac{320}{19}) = \\frac{2250+640}{19} = \\frac{2890}{19} \\approx 152.1$。这违反了 $3x_1+2x_2 \\leq 100$。这种情况不是解。\n\n**情况4**：两个约束 (iii) 和 (iv) 都活跃。\n这意味着 $\\lambda_E  0$ 和 $\\lambda_T  0$。最优解 $(x_1, x_2)$ 是两条约束线的交点：\n$3x_1 + 2x_2 = 100$\n$x_1 + 3x_2 = 90$\n从第二个方程， $x_1 = 90 - 3x_2$。代入第一个方程：\n$3(90 - 3x_2) + 2x_2 = 100 \\Rightarrow 270 - 9x_2 + 2x_2 = 100 \\Rightarrow 170 = 7x_2 \\Rightarrow x_2 = \\frac{170}{7}$。\n然后 $x_1 = 90 - 3(\\frac{170}{7}) = \\frac{630-510}{7} = \\frac{120}{7}$。\n$x_1$ 和 $x_2$ 均为正，因此 $\\mu_1 = 0, \\mu_2 = 0$ 是一致的。\n我们现在使用平稳性方程 (i) 和 (ii) 来求解 $\\lambda_E$ 和 $\\lambda_T$：\n$100 - 2(\\frac{120}{7}) - 3\\lambda_E - \\lambda_T = 0 \\Rightarrow 3\\lambda_E + \\lambda_T = 100 - \\frac{240}{7} = \\frac{460}{7}$\n$80 - \\frac{170}{7} - 2\\lambda_E - 3\\lambda_T = 0 \\Rightarrow 2\\lambda_E + 3\\lambda_T = 80 - \\frac{170}{7} = \\frac{390}{7}$\n我们得到一个关于 $\\lambda_E, \\lambda_T$ 的二元一次方程组：\n(A) $3\\lambda_E + \\lambda_T = \\frac{460}{7}$\n(B) $2\\lambda_E + 3\\lambda_T = \\frac{390}{7}$\n从 (A)，$\\lambda_T = \\frac{460}{7} - 3\\lambda_E$。代入 (B)：\n$2\\lambda_E + 3(\\frac{460}{7} - 3\\lambda_E) = \\frac{390}{7}$\n$2\\lambda_E + \\frac{1380}{7} - 9\\lambda_E = \\frac{390}{7}$\n$-7\\lambda_E = \\frac{390 - 1380}{7} = \\frac{-990}{7}$\n$\\lambda_E = \\frac{990}{49}$\n现在求 $\\lambda_T$：\n$\\lambda_T = \\frac{460}{7} - 3(\\frac{990}{49}) = \\frac{460 \\times 7}{49} - \\frac{2970}{49} = \\frac{3220 - 2970}{49} = \\frac{250}{49}$\n$\\lambda_E = \\frac{990}{49}  0$ 和 $\\lambda_T = \\frac{250}{49}  0$ 均成立。由于所有KKT条件都已满足，这是唯一的全局最优解。\n\n问题要求计算电力影子价格的数值，即 $\\lambda_E$。\n$\\lambda_E = \\frac{990}{49} \\approx 20.2040816...$\n四舍五入到四位有效数字得到 $20.20$。单位是美元/千瓦 ($\\$/\\text{kW}$)。",
            "answer": "$$\\boxed{20.20}$$"
        },
        {
            "introduction": "有效的运营决策通常必须考虑未来的不确定性，例如预测中的误差。最后的这个练习  将从确定性优化推进到机会约束下的不确定性优化。您将学习如何将一个概率性要求——确保以高概率满足安全限制——转化为一个可处理的确定性约束，从而使您能够找到对随机扰动具有明确鲁棒性的最优决策。",
            "id": "4215614",
            "problem": "一个校园微电网的数字孪生 (DT) 被用于优化单周期电池放电决策，以在不确定的可再生能源预测误差下减轻馈线过载。该数字孪生将馈线功率流建模为决策和不确定性的函数，如下所示。设净馈线流量为 $F(x,\\xi) = d - x + \\xi$，其中 $x$ 是电池放电决策（正值表示减少馈线流量），$d$ 是没有电池时的净基线需求，$\\xi$ 是可再生能源发电的预测误差，建模为均值为 $\\mu$、标准差为 $\\sigma$ 的高斯随机变量。馈线有一个热极限 $c$，必须以高概率遵守。\n\n运营商寻求最小化一个凸二次运行成本，同时保证馈线极限的概率性满足。该优化问题是：\n在 $x$ 上最小化成本 $J(x) = \\tfrac{1}{2} q x^{2} + r x$\n服从机会约束 $\\mathbb{P}\\big(F(x,\\xi) \\le c\\big) \\ge 1 - \\alpha$\n和执行器边界 $0 \\le x \\le x_{\\max}$。\n\n仅从基础概率定义以及关于高斯随机变量及其累积分布函数的公认事实出发，首先为形式为 $\\mathbb{P}\\big(F(x,\\xi) \\le c\\big) \\ge 1 - \\alpha$ 的机会约束推导出一个关于 $x$ 的确定性等价不等式。然后，根据以下由数字孪生确定的参数，计算在等价确定性约束下使成本最小化的最优决策 $x^{\\star}$：\n- $d = 12$ 兆瓦 (MW),\n- $c = 10$ MW,\n- $\\mu = 1$ MW,\n- $\\sigma = 0.8$ MW,\n- $\\alpha = 0.01$,\n- $q = 1$,\n- $r = -3$,\n- $x_{\\max} = 8$ MW.\n\n假设在此期间，对 $\\xi$ 的高斯建模假设是有效的，并且二次成本包含了相关的退化和能源机会成本。将您的答案四舍五入到 $4$ 位有效数字。用兆瓦 (MW) 表示您的最终决策。最终的数值答案必须是一个实数。",
            "solution": "该问题要求推导机会约束的确定性等价形式，并求解由此产生的凸优化问题。\n\n**问题验证**\n\n首先，根据所需标准对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 净馈线流量模型：$F(x,\\xi) = d - x + \\xi$\n- 决策变量：$x$ (电池放电)\n- 基线需求：$d$\n- 随机预测误差：$\\xi \\sim \\mathcal{N}(\\mu, \\sigma^2)$\n- 误差均值：$\\mu$\n- 误差标准差：$\\sigma$\n- 馈线热极限：$c$\n- 成本函数：$J(x) = \\tfrac{1}{2} q x^{2} + r x$\n- 机会约束：$\\mathbb{P}\\big(F(x,\\xi) \\le c\\big) \\ge 1 - \\alpha$\n- 执行器边界：$0 \\le x \\le x_{\\max}$\n- 具体参数：\n  - $d = 12$\n  - $c = 10$\n  - $\\mu = 1$\n  - $\\sigma = 0.8$\n  - $\\alpha = 0.01$\n  - $q = 1$\n  - $r = -3$\n  - $x_{\\max} = 8$\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性：** 该问题使用了机会约束二次规划的标准形式，这是一种在包括电网在内的工程系统随机优化中被广泛接受的技术。该模型基于公认的概率论和优化原理，是科学合理的。\n- **适定性：** 目标函数 $J(x)$ 是严格凸的，因为二次项的系数 $q=1$ 是正数。由机会约束的确定性等价形式和箱式约束构成的约束集是一个凸集。在一个非空、闭合的凸集上最小化一个严格凸函数有唯一解。因此，该问题是适定的。\n- **客观性和完整性：** 该问题使用精确的数学定义和客观、明确定义的参数进行陈述。提供了求解所需的所有数据。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的，因为它是科学合理的、适定的、客观的和完整的。将推导求解过程。\n\n**求解推导**\n\n求解过程包括两个主要部分：将概率性的机会约束转换为确定性不等式，然后求解得到的确定性优化问题。\n\n**第一部分：确定性等价约束的推导**\n\n机会约束由下式给出：\n$$ \\mathbb{P}\\big(F(x,\\xi) \\le c\\big) \\ge 1 - \\alpha $$\n代入馈线流量的定义，$F(x,\\xi) = d - x + \\xi$：\n$$ \\mathbb{P}\\big(d - x + \\xi \\le c\\big) \\ge 1 - \\alpha $$\n为了分析这个概率，我们分离出随机变量 $\\xi$：\n$$ \\mathbb{P}\\big(\\xi \\le c - d + x\\big) \\ge 1 - \\alpha $$\n问题陈述中指出 $\\xi$ 是一个均值为 $\\mu$、标准差为 $\\sigma$ 的高斯随机变量，即 $\\xi \\sim \\mathcal{N}(\\mu, \\sigma^2)$。为了继续，我们对变量 $\\xi$ 进行标准化。设 $Z$ 是一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，由变换 $Z = \\frac{\\xi - \\mu}{\\sigma}$ 定义。\n我们将此变换应用于概率表达式内的不等式：\n$$ \\mathbb{P}\\left(\\frac{\\xi - \\mu}{\\sigma} \\le \\frac{c - d + x - \\mu}{\\sigma}\\right) \\ge 1 - \\alpha $$\n这等价于：\n$$ \\mathbb{P}\\left(Z \\le \\frac{c - d + x - \\mu}{\\sigma}\\right) \\ge 1 - \\alpha $$\n令 $\\Phi(z)$ 表示标准正态随机变量 $Z$ 的累积分布函数 (CDF)，其中 $\\Phi(z) = \\mathbb{P}(Z \\le z)$。该不等式可以用 CDF 表示为：\n$$ \\Phi\\left(\\frac{c - d + x - \\mu}{\\sigma}\\right) \\ge 1 - \\alpha $$\n由于 CDF $\\Phi(\\cdot)$ 是一个严格递增的函数，其反函数 $\\Phi^{-1}(\\cdot)$ 也是严格递增的。我们将 $\\Phi^{-1}(\\cdot)$ 应用于不等式两边，并保持其方向不变：\n$$ \\frac{c - d + x - \\mu}{\\sigma} \\ge \\Phi^{-1}(1 - \\alpha) $$\n项 $\\Phi^{-1}(1 - \\alpha)$ 是标准正态分布的 $(1 - \\alpha)$-分位数。我们将这个临界值表示为 $z_{\\alpha} = \\Phi^{-1}(1 - \\alpha)$。\n不等式变为：\n$$ \\frac{c - d + x - \\mu}{\\sigma} \\ge z_{\\alpha} $$\n求解决策变量 $x$ 可得机会约束的确定性等价形式，这是一个线性不等式：\n$$ x \\ge d - c + \\mu + \\sigma z_{\\alpha} $$\n\n**第二部分：求解确定性优化问题**\n\n原始问题现在被转换为一个确定性二次规划问题：\n$$ \\text{minimize} \\quad J(x) = \\tfrac{1}{2} q x^{2} + r x $$\n$$ \\text{subject to} \\quad x \\ge d - c + \\mu + \\sigma z_{\\alpha} $$\n$$ 0 \\le x \\le x_{\\max} $$\n我们将机会约束得到的下界定义为 $x_{\\min}^{\\text{cc}} = d - c + \\mu + \\sigma z_{\\alpha}$。$x$ 的完整可行区域是区间 $[L, U]$，其中：\n$$ L = \\max(0, x_{\\min}^{\\text{cc}}) $$\n$$ U = x_{\\max} $$\n目标函数 $J(x)$ 是一个开口向上的凸抛物线，因为 $q=1  0$。其无约束最小值 $x_{\\text{unc}}$ 出现在其导数为零的点：\n$$ \\frac{dJ}{dx} = qx + r = 0 \\implies x_{\\text{unc}} = -\\frac{r}{q} $$\n约束问题的最优解 $x^{\\star}$ 是将 $x_{\\text{unc}}$ 投影到可行区间 $[L, U]$ 上的结果。这可以写为：\n$$ x^{\\star} = \\max(L, \\min(U, x_{\\text{unc}})) $$\n\n**第三部分：数值计算**\n\n我们代入给定的参数值：$d = 12$, $c = 10$, $\\mu = 1$, $\\sigma = 0.8$, $\\alpha = 0.01$, $q = 1$, $r = -3$, 和 $x_{\\max} = 8$。\n\n首先，我们找到 $z_{\\alpha} = \\Phi^{-1}(1 - \\alpha)$ 的值：\n$$ z_{0.01} = \\Phi^{-1}(1 - 0.01) = \\Phi^{-1}(0.99) $$\n从标准正态分布表或计算工具中，可以查得该值为 $z_{0.01} \\approx 2.3263$。\n\n接下来，我们计算下界 $x_{\\min}^{\\text{cc}}$：\n$$ x_{\\min}^{\\text{cc}} = d - c + \\mu + \\sigma z_{0.01} \\approx 12 - 10 + 1 + (0.8)(2.3263) $$\n$$ x_{\\min}^{\\text{cc}} \\approx 2 + 1 + 1.86104 = 4.86104 $$\n\n现在，我们定义可行区间 $[L, U]$：\n$$ L = \\max(0, 4.86104) = 4.86104 $$\n$$ U = x_{\\max} = 8 $$\n$x$ 的可行区域是区间 $[4.86104, 8]$。\n\n然后，我们计算无约束最小值点 $x_{\\text{unc}}$：\n$$ x_{\\text{unc}} = -\\frac{r}{q} = -\\frac{-3}{1} = 3 $$\n\n最后，我们通过将 $x_{\\text{unc}}$ 投影到可行区间 $[4.86104, 8]$ 上来找到最优解 $x^{\\star}$。\n由于 $x_{\\text{unc}} = 3$ 小于可行区间的下界 $L = 4.86104$，成本函数 $J(x)$ 在可行集上的最小值出现在下边界 $L$ 处。\n$$ x^{\\star} = L = 4.86104 $$\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$ x^{\\star} \\approx 4.861 $$\n决策的单位是兆瓦 (MW)，这继承自问题的参数。",
            "answer": "$$\\boxed{4.861}$$"
        }
    ]
}