{
    "hands_on_practices": [
        {
            "introduction": "The foundational task in overlaying a Digital Twin onto its physical counterpart is establishing a common spatial understanding—a process known as registration. This practice guides you through the derivation of a mathematically rigorous and widely used method for aligning two coordinate systems based on a set of corresponding points. By mastering this least-squares estimation technique, you will understand how to compute the optimal rigid-body transformation that precisely maps the Digital Twin's coordinate frame onto the real-world frame observed by the AR/VR device .",
            "id": "4206803",
            "problem": "In an Augmented Reality (AR) and Virtual Reality (VR) interface for a digital twin, a headset tracks physical fiducial markers in the world coordinate frame $\\mathcal{W}$ and renders a virtual mesh in the twin coordinate frame $\\mathcal{T}$. To overlay the twin accurately onto the physical scene, one estimates a rigid body transformation $T_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$ that maps points from $\\mathcal{T}$ to $\\mathcal{W}$. Suppose you are given $n \\geq 3$ known correspondences $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$, where each $x_i^{\\mathcal{W}} \\in \\mathbb{R}^{3}$ is a fiducial location measured in $\\mathcal{W}$ and each $x_i^{\\mathcal{T}} \\in \\mathbb{R}^{3}$ is the location of the corresponding vertex in the twin’s mesh in $\\mathcal{T}$. The measurement model is $x_i^{\\mathcal{W}} = R x_i^{\\mathcal{T}} + t + \\varepsilon_i$, where $R \\in \\mathrm{SO}(3)$, $t \\in \\mathbb{R}^{3}$, and the noise $\\varepsilon_i$ is zero-mean with finite second moment, independent across $i$, and independent of $x_i^{\\mathcal{T}}$. You may assume the correspondences are correct and fixed.\n\nStarting from the constrained least-squares formulation built on the Euclidean norm and the rigid-body constraints, derive, from first principles, a closed-form analytic expression for the least-squares estimator $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ in terms of the given correspondences. You must:\n- Begin from the definitions of a rigid transformation, the Euclidean norm, and basic matrix identities, and proceed by logically eliminating the translation and reducing the rotation subproblem to an optimization over $\\mathrm{SO}(3)$ that can be solved using singular value decomposition.\n- Clearly show the derivation steps that lead to the final analytic form of the estimator.\n- State the minimal assumptions required for identifiability and uniqueness of the solution in $\\mathrm{SE}(3)$.\n\nExpress your final answer as a single closed-form analytic expression for $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ using $4 \\times 4$ homogeneous coordinates. No numerical rounding is required.",
            "solution": "The problem requires the derivation of the closed-form least-squares estimator for a rigid body transformation $T_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$ between two sets of $n$ corresponding $3$D points, $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$. The transformation maps points from the twin coordinate frame $\\mathcal{T}$ to the world coordinate frame $\\mathcal{W}$.\n\nA rigid body transformation is composed of a rotation $R \\in \\mathrm{SO}(3)$ and a translation $t \\in \\mathbb{R}^{3}$. A point $x^{\\mathcal{T}}$ is mapped to $x^{\\mathcal{W}}$ by the rule $x^{\\mathcal{W}} = R x^{\\mathcal{T}} + t$. Given the measurement model $x_i^{\\mathcal{W}} = R x_i^{\\mathcal{T}} + t + \\varepsilon_i$, the least-squares estimation problem seeks to find the transformation $(\\hat{R}, \\hat{t})$ that minimizes the sum of squared Euclidean norms of the residuals. The objective function $E(R, t)$ is:\n$$E(R, t) = \\sum_{i=1}^{n} \\| x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + t) \\|^2$$\nThis optimization is constrained by the condition that $R$ must be a proper rotation matrix, i.e., $R \\in \\mathrm{SO}(3)$, which means $R^T R = I$ and $\\det(R) = +1$, where $I$ is the $3 \\times 3$ identity matrix.\n\nThe derivation proceeds in two main stages: first, we solve for the translation $t$, and second, we solve for the rotation $R$.\n\nFirst, we find the optimal translation $\\hat{t}$ by minimizing $E(R, t)$ with respect to $t$ for a fixed $R$. We compute the partial derivative of $E(R, t)$ with respect to $t$ and set it to zero.\n$$ \\frac{\\partial E}{\\partial t} = \\frac{\\partial}{\\partial t} \\sum_{i=1}^{n} (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t)^T (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t) = 0 $$\n$$ \\sum_{i=1}^{n} -2(x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t) = 0 $$\n$$ \\sum_{i=1}^{n} t = \\sum_{i=1}^{n} (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}}) $$\n$$ n t = \\sum_{i=1}^{n} x_i^{\\mathcal{W}} - R \\sum_{i=1}^{n} x_i^{\\mathcal{T}} $$\nLet us define the centroids of the two point sets as $\\bar{x}^{\\mathcal{W}} = \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{W}}$ and $\\bar{x}^{\\mathcal{T}} = \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{T}}$. The optimal translation $\\hat{t}$ can then be expressed as a function of the rotation $R$:\n$$ \\hat{t} = \\bar{x}^{\\mathcal{W}} - R \\bar{x}^{\\mathcal{T}} $$\nThis result shows that the centroid of the transformed points $R x_i^{\\mathcal{T}}$ plus the translation must align with the centroid of the measured points $x_i^{\\mathcal{W}}$.\n\nNext, we substitute this expression for $\\hat{t}$ back into the objective function to obtain a problem that depends only on $R$.\n$$ x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + \\hat{t}) = x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + \\bar{x}^{\\mathcal{W}} - R \\bar{x}^{\\mathcal{T}}) $$\n$$ = (x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}}) - R(x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}) $$\nLet us define the centered coordinates for each point set: $y'_i = x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}}$ and $x'_i = x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}$. The objective function becomes:\n$$ E(R) = \\sum_{i=1}^{n} \\| y'_i - R x'_i \\|^2 $$\nWe must find the rotation $\\hat{R}$ that minimizes this new objective function. Let's expand the squared norm:\n$$ E(R) = \\sum_{i=1}^{n} (y'_i - R x'_i)^T (y'_i - R x'_i) $$\n$$ = \\sum_{i=1}^{n} ((y'_i)^T y'_i - (y'_i)^T R x'_i - (R x'_i)^T y'_i + (R x'_i)^T R x'_i) $$\nSince $(y'_i)^T R x'_i$ is a scalar, it is equal to its transpose $(R x'_i)^T y'_i$. Also, since $R \\in \\mathrm{SO}(3)$, we have $R^T R = I$, so $(R x'_i)^T R x'_i = (x'_i)^T R^T R x'_i = (x'_i)^T I x'_i = (x'_i)^T x'_i$. The expression simplifies to:\n$$ E(R) = \\sum_{i=1}^{n} (\\|y'_i\\|^2 + \\|x'_i\\|^2 - 2 (y'_i)^T R x'_i) $$\nThe terms $\\sum_{i=1}^{n} \\|y'_i\\|^2$ and $\\sum_{i=1}^{n} \\|x'_i\\|^2$ do not depend on $R$. Therefore, minimizing $E(R)$ is equivalent to maximizing the term $\\sum_{i=1}^{n} (y'_i)^T R x'_i$.\nUsing the trace operator, and its cyclic property $\\mathrm{Tr}(ABC) = \\mathrm{Tr}(BCA)$, we can rewrite the objective. Since $(y'_i)^T R x'_i$ is a scalar ($1 \\times 1$ matrix), it is equal to its own trace.\n$$ \\sum_{i=1}^{n} (y'_i)^T R x'_i = \\sum_{i=1}^{n} \\mathrm{Tr}((y'_i)^T R x'_i) = \\sum_{i=1}^{n} \\mathrm{Tr}(R x'_i (y'_i)^T) $$\nBy linearity of the trace, this is:\n$$ \\mathrm{Tr} \\left( R \\sum_{i=1}^{n} x'_i (y'_i)^T \\right) $$\nLet us define the $3 \\times 3$ covariance matrix $H = \\sum_{i=1}^{n} x'_i (y'_i)^T$. The rotation estimation problem is now reduced to:\n$$ \\hat{R} = \\arg\\max_{R \\in \\mathrm{SO}(3)} \\mathrm{Tr}(R H) $$\nTo solve this maximization, we use the Singular Value Decomposition (SVD) of $H$. Let $H = U \\Sigma V^T$, where $U, V \\in \\mathrm{O}(3)$ are orthogonal matrices and $\\Sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$ is a diagonal matrix of non-negative singular values, ordered $\\sigma_1 \\geq \\sigma_2 \\geq \\sigma_3 \\geq 0$.\nSubstituting the SVD of $H$ into the trace expression:\n$$ \\mathrm{Tr}(R H) = \\mathrm{Tr}(R U \\Sigma V^T) $$\nUsing the cyclic property of the trace again:\n$$ \\mathrm{Tr}(R U \\Sigma V^T) = \\mathrm{Tr}(\\Sigma V^T R U) $$\nLet $M = V^T R U$. Since $V^T$, $R$, and $U$ are orthogonal matrices, their product $M$ is also an orthogonal matrix ($M \\in \\mathrm{O}(3)$). The problem is to maximize $\\mathrm{Tr}(\\Sigma M) = \\sum_{j=1}^{3} \\sigma_j M_{jj}$. Since $M$ is orthogonal, its column vectors are unit vectors, which implies that its elements satisfy $|M_{jk}| \\leq 1$. To maximize this sum with non-negative $\\sigma_j$, we need to make the diagonal elements $M_{jj}$ as large as possible. The largest possible value for each $M_{jj}$ is $1$, which occurs if $M$ is the identity matrix, $M = I$.\nIf $M = I$, then $V^T \\hat{R} U = I$, which gives a candidate solution for the rotation:\n$$ \\hat{R} = V I U^T = V U^T $$\nHowever, we must satisfy the constraint that $\\hat{R} \\in \\mathrm{SO}(3)$, which requires $\\det(\\hat{R}) = +1$. The SVD matrices $U$ and $V$ are in $\\mathrm{O}(3)$, so their determinants can be either $+1$ or $-1$.\nWe have $\\det(\\hat{R}) = \\det(V U^T) = \\det(V) \\det(U^T) = \\det(V) \\det(U)$.\nIf $\\det(V)\\det(U) = +1$, then $\\hat{R} = V U^T$ is a valid rotation and is the optimal solution.\nIf $\\det(V)\\det(U) = -1$, then $\\det(\\hat{R}) = -1$. This solution represents a reflection, not a proper rotation. The true maximum over $\\mathrm{SO}(3)$ must be found. In this case, the maximum of $\\mathrm{Tr}(\\Sigma M)$ subject to $\\det(M) = -1$ is achieved when $M = \\mathrm{diag}(1, 1, -1)$, which makes the term with the smallest singular value $\\sigma_3$ negative. The trace becomes $\\sigma_1 + \\sigma_2 - \\sigma_3$, which is the maximum possible value under the reflection constraint.\nThis gives $V^T \\hat{R} U = \\mathrm{diag}(1, 1, -1)$. The corrected rotation is:\n$$ \\hat{R} = V \\, \\mathrm{diag}(1, 1, -1) \\, U^T $$\nWe can unify both cases into a single expression. Let $S = \\mathrm{diag}(1, 1, \\det(V U^T))$. Then the optimal rotation is always given by $\\hat{R} = V S U^T$.\n\nThe minimal assumptions for identifiability and uniqueness of the solution $\\hat{T}_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$ are:\n$1$. The number of correspondences must be $n \\geq 3$.\n$2$. The corresponding points $\\{x_i^\\mathcal{T}\\}_{i=1}^n$ must not be collinear. If they are collinear, the covariance matrix $H$ has rank at most $1$, and the rotation cannot be determined uniquely (there is an ambiguity in rotation around the axis of collinearity). If the points are non-collinear, the transformation is unique. For a robust solution where all rotational degrees of freedom are well-constrained by the data, the points should be non-coplanar, which ensures that $H$ is full rank (rank $3$).\n\nIn summary, the closed-form solution is found via the following steps:\n$1$. Compute the centroids $\\bar{x}^{\\mathcal{T}}$ and $\\bar{x}^{\\mathcal{W}}$.\n$2$. Compute the covariance matrix $H = \\sum_{i=1}^{n} (x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}})(x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}})^T$.\n$3$. Perform SVD on $H$ to get $H=U \\Sigma V^T$.\n$4$. Calculate the optimal rotation $\\hat{R} = V \\, \\mathrm{diag}(1, 1, \\det(V U^T)) \\, U^T$.\n$5$. Calculate the optimal translation $\\hat{t} = \\bar{x}^{\\mathcal{W}} - \\hat{R} \\bar{x}^{\\mathcal{T}}$.\n$6$. Assemble the homogeneous transformation matrix $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$.\n\nThe final expression for $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ combines these results. Let the following quantities be defined based on the input correspondences $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$:\n- The centroids: $\\bar{x}^{\\mathcal{T}} = \\frac{1}{n} \\sum_{i=1}^{n} x_i^{\\mathcal{T}}$ and $\\bar{x}^{\\mathcal{W}} = \\frac{1}{n} \\sum_{i=1}^{n} x_i^{\\mathcal{W}}$.\n- The covariance matrix: $H = \\sum_{i=1}^{n} (x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}) (x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}})^T$.\n- The SVD of $H$: $H = U \\Sigma V^T$.\n- The correction matrix for reflections: $S = \\mathrm{diag}(1, 1, \\det(V U^T))$.\n\nWith these definitions, the optimal rotation and translation are given by $\\hat{R} = V S U^T$ and $\\hat{t} = \\bar{x}^{\\mathcal{W}} - \\hat{R} \\bar{x}^{\\mathcal{T}}$, respectively.\nThe final transformation in homogeneous coordinates is:\n$$ \\hat{T}_{\\mathcal{W}\\mathcal{T}} = \\begin{pmatrix} \\hat{R} & \\hat{t} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix} = \\begin{pmatrix} V S U^T & \\bar{x}^{\\mathcal{W}} - (V S U^T) \\bar{x}^{\\mathcal{T}} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix} $$\nwhere $\\mathbf{0}^T$ is a $1 \\times 3$ row vector of zeros.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} V \\mathrm{diag}(1, 1, \\det(V U^T)) U^T & \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{W}} - (V \\mathrm{diag}(1, 1, \\det(V U^T)) U^T) \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{T}} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once initial registration is achieved, the fidelity of an AR overlay depends on the system's ability to track the camera's pose accurately in real-time. Even small errors in the estimated rotation and translation can lead to noticeable visual misalignment between the virtual and physical objects. This exercise delves into the sensitivity of the overlay to these tracking inaccuracies by deriving the first-order effect of pose perturbations on the projected pixel coordinates, a critical analysis for designing robust and visually stable AR interfaces .",
            "id": "4206845",
            "problem": "A Digital Twin (DT) of a robotic manipulator is being visualized through an Augmented Reality (AR) and Virtual Reality (VR) interface using a calibrated pinhole camera model. The world-to-camera rigid transformation is specified by a rotation matrix $R \\in \\mathrm{SO}(3)$ and a translation vector $t \\in \\mathbb{R}^{3}$, and the camera intrinsics are given by\n$$\nK \\;=\\; \\begin{pmatrix}\nf_{x} & 0 & c_{x}\\\\\n0 & f_{y} & c_{y}\\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\nwith focal lengths $f_{x}, f_{y}$ and principal point $(c_{x}, c_{y})$. A twin vertex in world coordinates is $\\mathbf{x}_{\\mathcal{W}} \\in \\mathbb{R}^{3}$, and its camera coordinates are given by the rigid transformation $\\mathbf{x}_{\\mathcal{C}} = R\\,\\mathbf{x}_{\\mathcal{W}} + t$. The pinhole projection defines pixel coordinates $(u,v)$ by normalizing $\\mathbf{x}_{\\mathcal{C}} = (X, Y, Z)^{\\top}$ and applying the intrinsics:\n$$\nu \\;=\\; f_{x}\\,\\frac{X}{Z} + c_{x}, \\quad v \\;=\\; f_{y}\\,\\frac{Y}{Z} + c_{y}.\n$$\nIn practice, small pose errors in the registration between the DT and the AR/VR camera cause misalignment. Model the small rotation error as $\\delta R \\approx \\exp\\!\\big([\\delta \\boldsymbol{\\theta}]_{\\times}\\big)$ with $\\delta \\boldsymbol{\\theta} \\in \\mathbb{R}^{3}$, where $[\\cdot]_{\\times}$ denotes the $3 \\times 3$ skew-symmetric matrix such that $[\\mathbf{a}]_{\\times}\\,\\mathbf{b} = \\mathbf{a} \\times \\mathbf{b}$, and model the small translation error as $\\delta \\mathbf{t} \\in \\mathbb{R}^{3}$. Assume right-multiplicative rotation error $R' = R\\,\\delta R$ and additive translation error $t' = t + \\delta \\mathbf{t}$ so that the perturbed camera coordinates are $\\mathbf{x}_{\\mathcal{C}}' = R'\\,\\mathbf{x}_{\\mathcal{W}} + t'$. Using first-order approximations valid for small $\\delta \\boldsymbol{\\theta}$, derive from first principles the first-order perturbation of the pixel coordinates, $\\delta \\mathbf{p} = (\\delta u, \\delta v)^{\\top}$, in terms of $R$, $\\mathbf{x}_{\\mathcal{W}}$, $t$, $\\delta \\boldsymbol{\\theta}$, and $\\delta \\mathbf{t}$, together with the intrinsics $f_{x}, f_{y}$ and the nominal camera coordinates $(X, Y, Z)$.\n\nYour derivation must start from the rigid-body kinematics and the pinhole camera normalization, and then use a first-order linearization of the exponential map for the rotation error. Express the final answer as a single closed-form analytic expression for $\\delta \\mathbf{p}$ that depends only on the quantities defined above. No numerical evaluation or rounding is required. Do not include any units in your final expression.",
            "solution": "The problem requires the derivation of the first-order perturbation in pixel coordinates, denoted $\\delta \\mathbf{p} = (\\delta u, \\delta v)^{\\top}$, resulting from small errors in the camera's pose. The derivation will be performed from first principles, starting with the kinematics of the rigid-body transformation and the pinhole projection model.\n\nLet $\\mathbf{x}_{\\mathcal{W}} \\in \\mathbb{R}^{3}$ be a vertex in the world coordinate system. The nominal transformation to the camera coordinate system is given by the rotation $R \\in \\mathrm{SO}(3)$ and translation $t \\in \\mathbb{R}^{3}$. The nominal coordinates of the point in the camera frame, $\\mathbf{x}_{\\mathcal{C}} = (X, Y, Z)^{\\top}$, are:\n$$\n\\mathbf{x}_{\\mathcal{C}} = R\\,\\mathbf{x}_{\\mathcal{W}} + t\n$$\n\nThe pinhole camera model projects $\\mathbf{x}_{\\mathcal{C}}$ onto the image plane to produce pixel coordinates $\\mathbf{p} = (u, v)^{\\top}$:\n$$\nu = f_{x}\\,\\frac{X}{Z} + c_{x}\n$$\n$$\nv = f_{y}\\,\\frac{Y}{Z} + c_{y}\n$$\nwhere $f_{x}$, $f_{y}$ are the focal lengths and $(c_{x}, c_{y})$ is the principal point, all given by the camera intrinsic matrix $K$.\n\nThe camera pose is subject to small errors. The perturbed rotation matrix is $R' = R\\,\\delta R$ and the perturbed translation vector is $t' = t + \\delta \\mathbf{t}$. The small rotation $\\delta R$ is modeled using the exponential map from the Lie algebra $\\mathfrak{so}(3)$ to the Lie group $\\mathrm{SO}(3)$, where $\\delta \\boldsymbol{\\theta} \\in \\mathbb{R}^3$ is a small rotation vector. To first order, this is:\n$$\n\\delta R = \\exp([\\delta \\boldsymbol{\\theta}]_{\\times}) \\approx I + [\\delta \\boldsymbol{\\theta}]_{\\times}\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix and $[\\delta \\boldsymbol{\\theta}]_{\\times}$ is the skew-symmetric matrix corresponding to $\\delta \\boldsymbol{\\theta}$.\n\nThe first step is to find the first-order perturbation in the camera coordinates, $\\delta \\mathbf{x}_{\\mathcal{C}}$. The perturbed coordinates $\\mathbf{x}_{\\mathcal{C}}'$ are given by:\n$$\n\\mathbf{x}_{\\mathcal{C}}' = R'\\,\\mathbf{x}_{\\mathcal{W}} + t' = (R\\,\\delta R)\\,\\mathbf{x}_{\\mathcal{W}} + (t + \\delta \\mathbf{t})\n$$\nSubstituting the first-order approximation for $\\delta R$:\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx R(I + [\\delta \\boldsymbol{\\theta}]_{\\times})\\,\\mathbf{x}_{\\mathcal{W}} + t + \\delta \\mathbf{t}\n$$\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx R\\,\\mathbf{x}_{\\mathcal{W}} + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + t + \\delta \\mathbf{t}\n$$\nBy grouping terms, we can identify the nominal coordinates $\\mathbf{x}_{\\mathcal{C}}$:\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx (R\\,\\mathbf{x}_{\\mathcal{W}} + t) + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} = \\mathbf{x}_{\\mathcal{C}} + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t}\n$$\nThe perturbation $\\delta \\mathbf{x}_{\\mathcal{C}}$ is the difference $\\mathbf{x}_{\\mathcal{C}}' - \\mathbf{x}_{\\mathcal{C}}$. To first order, this is:\n$$\n\\delta \\mathbf{x}_{\\mathcal{C}} = \\mathbf{x}_{\\mathcal{C}}' - \\mathbf{x}_{\\mathcal{C}} \\approx R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t}\n$$\nLet $\\delta \\mathbf{x}_{\\mathcal{C}} = (\\delta X, \\delta Y, \\delta Z)^{\\top}$.\n\nThe second step is to relate the perturbation in camera coordinates, $\\delta \\mathbf{x}_{\\mathcal{C}}$, to the perturbation in pixel coordinates, $\\delta \\mathbf{p}$. We use a first-order Taylor expansion of the projection function $\\mathbf{p}(\\mathbf{x}_{\\mathcal{C}})$ around the nominal point $\\mathbf{x}_{\\mathcal{C}}$:\n$$\n\\delta \\mathbf{p} \\approx \\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{x}_{\\mathcal{C}}} \\delta \\mathbf{x}_{\\mathcal{C}}\n$$\nThe term $\\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{x}_{\\mathcal{C}}}$ is the Jacobian matrix of the projection function, which we denote as $J_{proj}$.\n$$\nJ_{proj} = \\begin{pmatrix} \\frac{\\partial u}{\\partial X} & \\frac{\\partial u}{\\partial Y} & \\frac{\\partial u}{\\partial Z} \\\\ \\frac{\\partial v}{\\partial X} & \\frac{\\partial v}{\\partial Y} & \\frac{\\partial v}{\\partial Z} \\end{pmatrix}\n$$\nWe compute the partial derivatives from the projection equations:\n$$\n\\frac{\\partial u}{\\partial X} = \\frac{f_{x}}{Z} \\quad , \\quad \\frac{\\partial u}{\\partial Y} = 0 \\quad , \\quad \\frac{\\partial u}{\\partial Z} = -f_{x}\\frac{X}{Z^{2}}\n$$\n$$\n\\frac{\\partial v}{\\partial X} = 0 \\quad , \\quad \\frac{\\partial v}{\\partial Y} = \\frac{f_{y}}{Z} \\quad , \\quad \\frac{\\partial v}{\\partial Z} = -f_{y}\\frac{Y}{Z^{2}}\n$$\nSubstituting these into the Jacobian matrix:\n$$\nJ_{proj} = \\begin{pmatrix}\n\\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\\n0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}}\n\\end{pmatrix}\n$$\nThis can be rewritten more compactly as:\n$$\nJ_{proj} = \\begin{pmatrix} f_x & 0 \\\\ 0 & f_y \\end{pmatrix} \\begin{pmatrix} \\frac{1}{Z} & 0 & -\\frac{X}{Z^2} \\\\ 0 & \\frac{1}{Z} & -\\frac{Y}{Z^2} \\end{pmatrix}\n$$\n\nFinally, we combine the results to find the expression for $\\delta \\mathbf{p}$. We substitute the expressions for $J_{proj}$ and $\\delta \\mathbf{x}_{\\mathcal{C}}$ into the Taylor expansion $\\delta \\mathbf{p} \\approx J_{proj} \\delta \\mathbf{x}_{\\mathcal{C}}$:\n$$\n\\delta \\mathbf{p} \\approx \\begin{pmatrix}\n\\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\\n0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}}\n\\end{pmatrix} \\left( R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} \\right)\n$$\nThis expression provides the first-order perturbation of the pixel coordinates $\\delta \\mathbf{p}$ as a function of the camera intrinsics ($f_x, f_y$), the nominal state ($R, \\mathbf{x_W}, t$ through $X, Y, Z$), and the small pose errors ($\\delta \\boldsymbol{\\theta}, \\delta \\mathbf{t}$). This is the required closed-form analytic expression.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\ 0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}} \\end{pmatrix} \\left( R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} \\right)}\n$$"
        },
        {
            "introduction": "A true Digital Twin is not merely a static geometric model but a 'live' simulation that mirrors the dynamic behavior of the physical system. For an AR/VR interface to be effective, this underlying simulation must run accurately and in real-time, often on resource-constrained edge devices. This hands-on practice explores the crucial trade-off between computational efficiency and numerical stability in real-time simulation, challenging you to determine the maximum viable time-step for a simple dynamical system that satisfies both accuracy and stability requirements .",
            "id": "4206875",
            "problem": "A Digital Twin (DT) of a single-degree-of-freedom compliant mechanism is used to drive an Augmented Reality (AR) overlay in a head-mounted Virtual Reality (VR) display. The DT simulates the mechanism as a linear mass–spring–damper with generalized coordinate $q(t)$ and velocity $v(t) = \\dot{q}(t)$, mass $m$, stiffness $k$, and damping $c$. The continuous-time dynamics are written in first-order form as $\\dot{x}(t) = A x(t)$ with $x(t) = \\begin{pmatrix} q(t) \\\\ v(t) \\end{pmatrix}$ and \n$$\nA = \\begin{pmatrix}\n0 & 1 \\\\\n-\\frac{k}{m} & -\\frac{c}{m}\n\\end{pmatrix}.\n$$\nThe DT uses the explicit (forward) Euler time discretization with a fixed step size $\\Delta t$ to update the state for rendering each frame.\n\nAssume that the AR tracking module provides conservative bounds on motion during normal operation: $|q(t)| \\leq Q_{\\max}$ and $|v(t)| \\leq V_{\\max}$ for all $t$ between frames. The AR overlay alignment tolerance requires the per-step position local truncation error to satisfy $|e_q| \\leq \\varepsilon$, where $e_q$ denotes the local truncation error in the position $q$ over one step.\n\nGiven the parameters $m = $ $2$ $\\mathrm{kg}$, $k = $ $4 \\times 10^{5}$ $\\mathrm{N/m}$, $c = $ $360$ $\\mathrm{N\\,s/m}$, $Q_{\\max} = $ $0.010$ $\\mathrm{m}$, $V_{\\max} = $ $0.50$ $\\mathrm{m/s}$, and $\\varepsilon = $ $5.0 \\times 10^{-4}$ $\\mathrm{m}$, do the following:\n\n$1.$ Starting only from the Taylor expansion of the exact solution and the definition of the explicit Euler method, derive an upper bound on the per-step position local truncation error $|e_q|$ in terms of $\\Delta t$, $m$, $k$, $c$, $Q_{\\max}$, and $V_{\\max}$.\n\n$2.$ Using the linear stability condition of the explicit Euler method applied to linear time-invariant systems, derive a stability upper bound on $\\Delta t$ in terms of $m$, $k$, and $c$.\n\n$3.$ Combine the accuracy and stability requirements to compute the largest fixed step size $\\Delta t_{\\max}$ that simultaneously satisfies both the derived error bound $|e_q| \\leq \\varepsilon$ and the stability bound. Express your final numerical answer for $\\Delta t_{\\max}$ in milliseconds, and round your answer to three significant figures.\n\n$4.$ Propose an adaptive step size update criterion of the form $\\Delta t_{\\text{new}} = \\min\\{\\Delta t_{\\text{stab}}, s \\,\\Delta t \\, (\\varepsilon / \\widehat{e}_q)^{1/2}\\}$, where $\\widehat{e}_q$ is a computable local error estimate and $s \\in (0,1)$ is a safety factor. You do not need to compute a numerical value for this part; state a principled choice for $\\widehat{e}_q$ and $s$ consistent with your derivation in part $1$ and your stability bound in part $2$.\n\nReport only the value of $\\Delta t_{\\max}$ in milliseconds as your final answer.",
            "solution": "The problem requires finding the maximum permissible fixed time step, $\\Delta t_{\\max}$, for the simulation of a linear mass-spring-damper system using the explicit Euler method. This maximum step size is constrained by two requirements: a local accuracy tolerance and a numerical stability condition. We must derive the bounds for each requirement and then determine the most restrictive one.\n\nFirst, we address the accuracy requirement. The problem asks for a derivation of an upper bound on the per-step position local truncation error, $|e_q|$. The local truncation error is the difference between the exact solution after one step, assuming the state is exact at the beginning of the step, and the numerical approximation.\n\nThe state of the system is given by $x(t) = \\begin{pmatrix} q(t) \\\\ v(t) \\end{pmatrix}$, and its continuous-time evolution is $\\dot{x}(t) = A x(t)$. The first component of this system is $\\dot{q}(t) = v(t)$. The second component is $\\dot{v}(t) = -\\frac{k}{m}q(t) - \\frac{c}{m}v(t)$, which is equivalent to the second-order equation of motion $m\\ddot{q}(t) + c\\dot{q}(t) + kq(t) = 0$.\n\nThe exact solution for the position $q(t)$ at time $t_{n+1} = t_n + \\Delta t$ can be expressed via a Taylor series expansion around $t_n$:\n$$\nq(t_n + \\Delta t) = q(t_n) + \\dot{q}(t_n)\\Delta t + \\frac{1}{2}\\ddot{q}(t_n)\\Delta t^2 + O(\\Delta t^3)\n$$\nAssuming the solution is exact at time $t_n$, so $q_n = q(t_n)$ and $v_n = v(t_n) = \\dot{q}(t_n)$.\n\nThe explicit Euler method updates the position coordinate as:\n$$\nq_{n+1} = q_n + v_n \\Delta t\n$$\nThe local truncation error in position, $e_q$, is defined as $e_q = q(t_n + \\Delta t) - q_{n+1}$. Substituting the expressions above:\n$$\ne_q = \\left( q(t_n) + \\dot{q}(t_n)\\Delta t + \\frac{1}{2}\\ddot{q}(t_n)\\Delta t^2 + ... \\right) - (q_n + v_n \\Delta t)\n$$\nSince $q_n = q(t_n)$ and $v_n = \\dot{q}(t_n)$, the first two terms cancel, leaving the leading-order error term:\n$$\ne_q = \\frac{1}{2}\\ddot{q}(t_n)\\Delta t^2 + O(\\Delta t^3)\n$$\nTo bound this error, we need to find the maximum possible magnitude of the acceleration, $\\ddot{q}(t)$. From the equation of motion:\n$$\n\\ddot{q}(t) = -\\frac{k}{m}q(t) - \\frac{c}{m}v(t)\n$$\nTaking the absolute value and applying the triangle inequality:\n$$\n|\\ddot{q}(t)| = \\left| -\\frac{k}{m}q(t) - \\frac{c}{m}v(t) \\right| \\leq \\frac{k}{m}|q(t)| + \\frac{c}{m}|v(t)|\n$$\nThe problem provides conservative bounds $|q(t)| \\leq Q_{\\max}$ and $|v(t)| \\leq V_{\\max}$. Using these, we find an upper bound for the magnitude of acceleration:\n$$\n|\\ddot{q}(t)| \\leq \\frac{k}{m}Q_{\\max} + \\frac{c}{m}V_{\\max} = \\frac{1}{m}(kQ_{\\max} + cV_{\\max})\n$$\nSubstituting this into the expression for the magnitude of the local error $|e_q|$:\n$$\n|e_q| \\approx \\left| \\frac{1}{2}\\ddot{q}(t_n)\\Delta t^2 \\right| \\leq \\frac{\\Delta t^2}{2m}(kQ_{\\max} + cV_{\\max})\n$$\nThe accuracy requirement is $|e_q| \\leq \\varepsilon$. Thus, we derive the constraint on $\\Delta t$ from accuracy considerations:\n$$\n\\frac{\\Delta t^2}{2m}(kQ_{\\max} + cV_{\\max}) \\leq \\varepsilon \\implies \\Delta t \\leq \\sqrt{\\frac{2m\\varepsilon}{kQ_{\\max} + cV_{\\max}}}\n$$\nLet us denote this bound as $\\Delta t_{\\text{acc}}$.\n\nSecond, we address the stability requirement. The explicit Euler update rule for the system $\\dot{x} = Ax$ is $x_{n+1} = (I + \\Delta t A)x_n$. The method is numerically stable if and only if all eigenvalues of the amplification matrix $G = I + \\Delta t A$ have a magnitude no greater than $1$. The eigenvalues of $G$, denoted $\\mu_j$, are related to the eigenvalues of $A$, denoted $\\lambda_j$, by $\\mu_j = 1 + \\Delta t \\lambda_j$. The stability condition is therefore $|1 + \\Delta t \\lambda_j| \\leq 1$ for all eigenvalues $\\lambda_j$ of A.\n\nThe eigenvalues of $A = \\begin{pmatrix} 0 & 1 \\\\ -k/m & -c/m \\end{pmatrix}$ are found from the characteristic equation $\\det(A-\\lambda I)=0$:\n$$\n\\lambda^2 + \\frac{c}{m}\\lambda + \\frac{k}{m} = 0\n$$\nThe solutions are $\\lambda = -\\frac{c}{2m} \\pm \\sqrt{(\\frac{c}{2m})^2 - \\frac{k}{m}}$. Let's evaluate the discriminant with the given parameters: $m=2$, $c=360$, $k=4 \\times 10^5$.\n$$\n\\left(\\frac{c}{2m}\\right)^2 - \\frac{k}{m} = \\left(\\frac{360}{2 \\cdot 2}\\right)^2 - \\frac{4 \\times 10^5}{2} = 90^2 - 2 \\times 10^5 = 8100 - 200000 < 0\n$$\nThe discriminant is negative, so the eigenvalues are a complex conjugate pair: $\\lambda = -\\alpha \\pm i\\omega_d$, where $\\alpha = \\frac{c}{2m}$ and $\\omega_d = \\sqrt{\\frac{k}{m} - (\\frac{c}{2m})^2}$.\n\nThe stability condition $|1 + \\Delta t \\lambda| \\leq 1$ for complex $\\lambda$ can be expanded as:\n$$\n|1 + \\Delta t(-\\alpha \\pm i\\omega_d)|^2 \\leq 1^2 \\implies |(1-\\alpha\\Delta t) \\pm i(\\omega_d\\Delta t)|^2 \\leq 1\n$$\n$$\n(1-\\alpha\\Delta t)^2 + (\\omega_d\\Delta t)^2 \\leq 1 \\implies 1 - 2\\alpha\\Delta t + \\alpha^2\\Delta t^2 + \\omega_d^2\\Delta t^2 \\leq 1\n$$\n$$\n-2\\alpha\\Delta t + (\\alpha^2 + \\omega_d^2)\\Delta t^2 \\leq 0\n$$\nSince $\\Delta t > 0$, we can divide by it: $-2\\alpha + (\\alpha^2 + \\omega_d^2)\\Delta t \\leq 0$.\nThe term $\\alpha^2 + \\omega_d^2 = (\\frac{c}{2m})^2 + (\\frac{k}{m} - (\\frac{c}{2m})^2) = \\frac{k}{m}$. Also, $\\alpha=\\frac{c}{2m}$. Substituting these back:\n$$\n-2\\left(\\frac{c}{2m}\\right) + \\left(\\frac{k}{m}\\right)\\Delta t \\leq 0 \\implies -\\frac{c}{m} + \\frac{k}{m}\\Delta t \\leq 0\n$$\nSolving for $\\Delta t$ gives the stability bound:\n$$\n\\Delta t \\leq \\frac{c/m}{k/m} = \\frac{c}{k}\n$$\nLet us denote this bound as $\\Delta t_{\\text{stab}}$.\n\nFinally, we combine the two constraints to find the maximum allowed step size, $\\Delta t_{\\max}$. The step size must satisfy both conditions simultaneously, so $\\Delta t_{\\max} = \\min(\\Delta t_{\\text{acc}}, \\Delta t_{\\text{stab}})$. We now substitute the given numerical values:\n$m = 2.0~\\mathrm{kg}$, $k = 4.0 \\times 10^5~\\mathrm{N/m}$, $c = 360~\\mathrm{N\\,s/m}$, $Q_{\\max} = 0.010~\\mathrm{m}$, $V_{\\max} = 0.50~\\mathrm{m/s}$, and $\\varepsilon = 5.0 \\times 10^{-4}~\\mathrm{m}$.\n\nCalculating the accuracy bound, $\\Delta t_{\\text{acc}}$:\n$$\n\\Delta t_{\\text{acc}} = \\sqrt{\\frac{2m\\varepsilon}{kQ_{\\max} + cV_{\\max}}} = \\sqrt{\\frac{2(2.0)(5.0 \\times 10^{-4})}{(4.0 \\times 10^5)(0.010) + (360)(0.50)}}\n$$\n$$\n\\Delta t_{\\text{acc}} = \\sqrt{\\frac{2.0 \\times 10^{-3}}{4000 + 180}} = \\sqrt{\\frac{2.0 \\times 10^{-3}}{4180}} \\approx \\sqrt{4.78468... \\times 10^{-7}} \\approx 6.91714... \\times 10^{-4}~\\mathrm{s}\n$$\nCalculating the stability bound, $\\Delta t_{\\text{stab}}$:\n$$\n\\Delta t_{\\text{stab}} = \\frac{c}{k} = \\frac{360}{4.0 \\times 10^5} = 9.0 \\times 10^{-4}~\\mathrm{s}\n$$\nComparing the two bounds in milliseconds:\n$\\Delta t_{\\text{acc}} \\approx 0.6917~\\mathrm{ms}$\n$\\Delta t_{\\text{stab}} = 0.900~\\mathrm{ms}$\n\nThe most restrictive constraint is the one imposed by the accuracy requirement. Therefore, the maximum allowed fixed step size is:\n$$\n\\Delta t_{\\max} = \\min(0.6917...~\\mathrm{ms}, 0.900~\\mathrm{ms}) = 0.6917...~\\mathrm{ms}\n$$\nThe problem requires the answer in milliseconds, rounded to three significant figures.\n$$\n\\Delta t_{\\max} \\approx 0.692~\\mathrm{ms}\n$$\n\n4. For the adaptive step size update criterion $\\Delta t_{\\text{new}} = \\min\\{\\Delta t_{\\text{stab}}, s \\,\\Delta t \\, (\\varepsilon / \\widehat{e}_q)^{1/2}\\}$:\n- A principled choice for the local error estimate $\\widehat{e}_q$ is the leading term of the local truncation error, calculated using the current state $(q_n, v_n)$: $\\widehat{e}_q = \\frac{1}{2} |-\\frac{k}{m}q_n - \\frac{c}{m}v_n| \\Delta t^2$. This uses the known dynamics to estimate the second derivative, $\\ddot{q}(t_n)$, without requiring a second, more expensive integration step.\n- A principled choice for the safety factor $s$ is a value slightly less than 1, typically $s=0.9$, to provide a conservative margin against overshooting the error tolerance due to higher-order terms or rapid changes in the system's state. The stability bound $\\Delta t_{\\text{stab}} = c/k$ must always be respected as a hard upper limit.",
            "answer": "$$\n\\boxed{0.692}\n$$"
        }
    ]
}