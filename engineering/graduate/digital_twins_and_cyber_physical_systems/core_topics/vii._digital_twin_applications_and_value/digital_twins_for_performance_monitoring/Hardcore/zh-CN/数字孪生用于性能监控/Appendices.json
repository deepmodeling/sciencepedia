{
    "hands_on_practices": [
        {
            "introduction": "任何强大的数字孪生都依赖于其底层精确的模型。本练习将深入探讨一个基本问题：如何根据传感器数据校准模型参数，以及（更重要的）如何量化这种校准精度的根本极限。通过推导克拉默-拉奥下界（Cramér-Rao Lower Bound），您将学会为任何无偏估计量的最佳性能建立一个理论基准，这是评估和设计监控系统的一项关键技能 。",
            "id": "4215921",
            "problem": "一个赛博物理生产单元由一个数字孪生进行监控，其传感器输出向量的测量模型由 $y_k = h_{\\theta}(x_k, u_k) + v_k$ 给出，其中 $y_k \\in \\mathbb{R}^{m}$ 是在时间索引 $k$ 处的测量输出，$x_k \\in \\mathbb{R}^{n}$ 是已知状态，$u_k \\in \\mathbb{R}^{p}$ 是已知控制输入，而 $h_{\\theta} : \\mathbb{R}^{n} \\times \\mathbb{R}^{p} \\to \\mathbb{R}^{m}$ 是一个由 $\\theta \\in \\mathbb{R}^{d}$ 参数化的可微输出映射。噪声序列 $v_k$ 在 $k$ 上是独立的，其中 $v_k \\sim \\mathcal{N}(0, R)$，对于一个已知的正定协方差矩阵 $R \\in \\mathbb{R}^{m \\times m}$，且 $R$ 不依赖于 $\\theta$。数据集 $\\{(x_k, u_k, y_k)\\}_{k=1}^{K}$ 是可用的。\n\n该生产单元的性能由一个在特定操作条件 $(x_{\\mathrm{op}}, u_{\\mathrm{op}})$ 下定义的标量输出来概括，即 $g(\\theta) = a^{\\top} h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})$，其中 $a \\in \\mathbb{R}^{m}$ 是一个已知的权重向量。假设标准正则性条件对基于似然的推断成立，并假设通过参数估计然后在 $(x_{\\mathrm{op}}, u_{\\mathrm{op}})$ 处求值来构建 $g(\\theta)$ 的一个无偏估计器。\n\n从独立高斯测量噪声的似然的基本定义以及最大似然估计器 (MLE) 的定义出发，推导对数似然的形式以及 $\\theta$ 对应的估计器。然后，使用 Fisher Information Matrix (FIM) 和 Cramér–Rao Lower Bound (CRLB) 的定义，推导在真实参数值 $\\theta^{\\star}$ 处评估的任何 $g(\\theta)$ 无偏估计器方差的 CRLB 的闭式解析表达式。你的最终答案必须是单个闭式解析表达式。不要提供数值。你的最终答案必须明确地用雅可比矩阵 $\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}$ 和 $\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}$、协方差 $R$ 以及权重向量 $a$ 来表示。",
            "solution": "问题要求解性能标量 $g(\\theta) = a^{\\top} h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})$ 的无偏估计器方差的 Cramér–Rao Lower Bound (CRLB)。推导过程首先定义统计模型及其对数似然，然后计算 Fisher Information Matrix (FIM)，最后对估计参数的函数应用 CRLB 定理。\n\n测量模型由 $y_k = h_{\\theta}(x_k, u_k) + v_k$ 给出，其中噪声项 $v_k$ 服从独立同分布的高斯分布，$v_k \\sim \\mathcal{N}(0, R)$。这意味着在给定状态 $x_k$、输入 $u_k$ 和参数向量 $\\theta$ 的条件下，单个测量向量 $y_k$ 的条件概率分布也是高斯的：\n$$y_k | x_k, u_k, \\theta \\sim \\mathcal{N}(h_{\\theta}(x_k, u_k), R)$$\n因此，单个观测值 $y_k$ 的概率密度函数 (PDF) 为：\n$$p(y_k | \\theta) = \\frac{1}{(2\\pi)^{m/2} \\sqrt{\\det(R)}} \\exp\\left(-\\frac{1}{2} (y_k - h_{\\theta}(x_k, u_k))^{\\top} R^{-1} (y_k - h_{\\theta}(x_k, u_k))\\right)$$\n由于噪声项 $v_k$ 在时间索引 $k$ 上是独立的，整个数据集 $Y = \\{y_k\\}_{k=1}^{K}$ 的似然是各个 PDF 的乘积：\n$$L(\\theta | Y) = \\prod_{k=1}^{K} p(y_k | \\theta)$$\n对数似然函数 $\\mathcal{L}(\\theta) = \\ln(L(\\theta|Y))$ 是各个对数 PDF 的和：\n$$\\mathcal{L}(\\theta) = \\sum_{k=1}^{K} \\left[ -\\frac{m}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(R)) - \\frac{1}{2}(y_k - h_{\\theta}(x_k, u_k))^{\\top} R^{-1} (y_k - h_{\\theta}(x_k, u_k)) \\right]$$\n$\\theta$ 的最大似然估计器 (MLE)，记为 $\\hat{\\theta}_{MLE}$，是使 $\\mathcal{L}(\\theta)$ 最大化的 $\\theta$ 值。由于和中的前两项相对于 $\\theta$ 是常数，这等价于最小化加权残差平方和：\n$$\\hat{\\theta}_{MLE} = \\arg\\min_{\\theta} \\sum_{k=1}^{K} (y_k - h_{\\theta}(x_k, u_k))^{\\top} R^{-1} (y_k - h_{\\theta}(x_k, u_k))$$\n\nFisher Information Matrix (FIM) $I(\\theta)$ 提供了一个度量，衡量可观测数据 $Y$ 携带的关于未知参数 $\\theta$ 的信息量。在标准正则性条件下，它被定义为对数似然函数的海森矩阵（Hessian）在真实参数值 $\\theta^{\\star}$ 处取值的负期望：\n$$I(\\theta^{\\star}) = -E\\left[ \\left. \\frac{\\partial^2 \\mathcal{L}(\\theta)}{\\partial \\theta \\partial \\theta^{\\top}} \\right|_{\\theta=\\theta^{\\star}} \\right]$$\n让我们首先计算对数似然的梯度（得分函数）。令 $J_k(\\theta) = \\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}$ 为 $h_{\\theta}$ 关于 $\\theta$ 的 $m \\times d$ 雅可比矩阵。使用向量微积分恒等式，$\\mathcal{L}(\\theta)$ 的梯度为：\n$$\\frac{\\partial \\mathcal{L}(\\theta)}{\\partial \\theta} = \\sum_{k=1}^{K} J_k(\\theta)^{\\top} R^{-1} (y_k - h_{\\theta}(x_k, u_k))$$\n海森矩阵是得分函数关于 $\\theta^{\\top}$ 的导数：\n$$\\frac{\\partial^2 \\mathcal{L}(\\theta)}{\\partial \\theta \\partial \\theta^{\\top}} = \\sum_{k=1}^{K} \\frac{\\partial}{\\partial \\theta^{\\top}} \\left[ J_k(\\theta)^{\\top} R^{-1} (y_k - h_{\\theta}(x_k, u_k)) \\right]$$\n应用乘法法则求导得出：\n$$\\frac{\\partial^2 \\mathcal{L}(\\theta)}{\\partial \\theta \\partial \\theta^{\\top}} = \\sum_{k=1}^{K} \\left[ \\left(\\frac{\\partial (J_k(\\theta)^{\\top} R^{-1})}{\\partial \\theta^{\\top}}\\right) (y_k - h_{\\theta}(x_k, u_k)) - J_k(\\theta)^{\\top} R^{-1} J_k(\\theta) \\right]$$\n期望是关于数据分布计算的，其中 $E[y_k] = h_{\\theta^{\\star}}(x_k, u_k)$。因此，在真实参数值 $\\theta^{\\star}$ 处，我们有 $E[y_k - h_{\\theta^{\\star}}(x_k, u_k)] = E[v_k] = 0$。海森矩阵中第一项的期望为零：\n$$E\\left[ \\left. \\frac{\\partial^2 \\mathcal{L}(\\theta)}{\\partial \\theta \\partial \\theta^{\\top}} \\right|_{\\theta=\\theta^{\\star}} \\right] = - \\sum_{k=1}^{K} J_k(\\theta^{\\star})^{\\top} R^{-1} J_k(\\theta^{\\star})$$\n因此，在 $\\theta^{\\star}$ 处的 FIM 为：\n$$I(\\theta^{\\star}) = \\sum_{k=1}^{K} J_k(\\theta^{\\star})^{\\top} R^{-1} J_k(\\theta^{\\star}) = \\sum_{k=1}^{K} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right)_{\\theta=\\theta^{\\star}}^{\\top} R^{-1} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right)_{\\theta=\\theta^{\\star}}$$\nCramér–Rao Lower Bound 定理指出，对于 $\\theta$ 的任何无偏估计器 $\\hat{\\theta}$，其协方差矩阵的下界是 FIM 的逆：$\\mathrm{Cov}(\\hat{\\theta}) \\ge I(\\theta^{\\star})^{-1}$。\n\n我们需要标量函数 $g(\\theta) = a^{\\top} h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})$ 的估计器的 CRLB。对于参数的函数，CRLB 由 delta 方法（或不确定性传播）给出：\n$$\\mathrm{CRLB}(g(\\theta^{\\star})) = (\\nabla_{\\theta} g(\\theta^{\\star}))^{\\top} I(\\theta^{\\star})^{-1} (\\nabla_{\\theta} g(\\theta^{\\star}))$$\n其中 $\\nabla_{\\theta} g(\\theta^{\\star})$ 是 $g(\\theta)$ 在 $\\theta^{\\star}$ 处评估的梯度。让我们计算这个梯度。令 $J_{\\mathrm{op}}(\\theta) = \\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}$ 为输出映射在操作点处的 $m \\times d$ 雅可比矩阵。\n$$g(\\theta) = a^{\\top} h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})$$\n关于 $\\theta$ 的梯度是一个 $d \\times 1$ 的列向量：\n$$\\nabla_{\\theta} g(\\theta) = \\left(\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}\\right)^{\\top} a = J_{\\mathrm{op}}(\\theta)^{\\top} a$$\n该梯度的转置是 $(\\nabla_{\\theta} g(\\theta))^{\\top} = a^{\\top} J_{\\mathrm{op}}(\\theta)$。\n将梯度和 FIM 代入 CRLB 公式，我们得到在真实参数 $\\theta^{\\star}$ 处评估的任何 $g(\\theta)$ 无偏估计器方差的下界：\n$$\\mathrm{CRLB}(g(\\theta^{\\star})) = (a^{\\top} J_{\\mathrm{op}}(\\theta^{\\star})) I(\\theta^{\\star})^{-1} (J_{\\mathrm{op}}(\\theta^{\\star})^{\\top} a)$$\n代入 $I(\\theta^{\\star})^{-1}$ 的完整表达式：\n$$\\mathrm{CRLB}(g(\\theta^{\\star})) = a^{\\top} J_{\\mathrm{op}}(\\theta^{\\star}) \\left[ \\sum_{k=1}^{K} J_k(\\theta^{\\star})^{\\top} R^{-1} J_k(\\theta^{\\star}) \\right]^{-1} J_{\\mathrm{op}}(\\theta^{\\star})^{\\top} a$$\n按照要求，我们用指定的雅可比矩阵表示最终答案，为符号清晰起见，省略了在 $\\theta^{\\star}$ 处的显式评估，因为这已由问题上下文所暗示。\n$$\\mathrm{CRLB}(g) = a^{\\top} \\left(\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}\\right) \\left[ \\sum_{k=1}^{K} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right)^{\\top} R^{-1} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right) \\right]^{-1} \\left(\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}\\right)^{\\top} a$$\n这个表达式代表了基于所提供的数据和模型结构，对性能指标 $g(\\theta)$ 的任何无偏估计器可实现的最小方差。",
            "answer": "$$\n\\boxed{\na^{\\top} \\left(\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}\\right) \\left[ \\sum_{k=1}^{K} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right)^{\\top} R^{-1} \\left(\\frac{\\partial h_{\\theta}(x_k, u_k)}{\\partial \\theta}\\right) \\right]^{-1} \\left(\\frac{\\partial h_{\\theta}(x_{\\mathrm{op}}, u_{\\mathrm{op}})}{\\partial \\theta}\\right)^{\\top} a\n}\n$$"
        },
        {
            "introduction": "数字孪生的主要作用是监控性能，但其模型输入（即系统状态）的确定性从来都不是完美的。本练习将演示如何将这种不确定性从状态变量传播到最终的关键性能指标（KPI）。您将使用一阶泰勒近似，计算状态估计的方差和协方差如何影响一个非线性性能指标的方差，这是现实性能监控中的一项核心任务 。",
            "id": "4215971",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 将一个加工单元的循环时间作为一项关键性能指标进行监控。循环时间 $K$ 通过以下函数从状态向量 $x = (u, b, T)^\\top$ 建模：\n$$\nK = \\phi(x) = \\frac{\\eta}{1 - u} \\left( 1 + \\gamma b \\right) \\exp\\!\\left( \\beta \\left( T - T_{\\mathrm{ref}} \\right) \\right),\n$$\n其中 $u$ 是利用率（无量纲，以分数表示），$b$ 是归一化缓冲区占用率（无量纲，以分数表示），$T$ 是以摄氏度为单位的温度，$T_{\\mathrm{ref}}$ 是以摄氏度为单位的参考温度。常数分别为 $\\eta = 0.8$ (秒)，$\\gamma = 0.1$ (无量纲)，$\\beta = 0.02$ (每摄氏度)，以及 $T_{\\mathrm{ref}} = 35$ (摄氏度)。该数字孪生维持对状态的高斯估计，其均值（工作点）为\n$$\n\\mu_x = \\begin{pmatrix} u_0 \\\\ b_0 \\\\ T_0 \\end{pmatrix} = \\begin{pmatrix} 0.75 \\\\ 0.30 \\\\ 40 \\end{pmatrix},\n$$\n协方差为\n$$\n\\Sigma_x = \\begin{pmatrix}\n0.0004  0.0003  0.01 \\\\\n0.0003  0.0025  0.02 \\\\\n0.01  0.02  2.25\n\\end{pmatrix}.\n$$\n从方差、协方差和一阶泰勒展开的基本定义出发，推导 $K$ 在 $\\mu_x$ 附近方差的一阶近似值。然后，使用所提供的数值参数，计算 $K$ 的近似方差，单位为平方秒。假设 $\\mu_x$ 周围的噪声足够小，使得一阶近似有效。将您的最终数值答案四舍五入至四位有效数字。以 $\\mathrm{s}^2$ 为单位表示最终方差。",
            "solution": "问题要求计算循环时间 $K$ 的方差的一阶近似值，其中 $K$ 是状态向量 $x = (u, b, T)^\\top$ 的函数。状态向量 $x$ 是一个随机变量，其给定均值为 $\\mu_x$，协方差矩阵为 $\\Sigma_x$。\n\n函数由下式给出：\n$$\nK = \\phi(x) = \\frac{\\eta}{1 - u} \\left( 1 + \\gamma b \\right) \\exp\\!\\left( \\beta \\left( T - T_{\\mathrm{ref}} \\right) \\right)\n$$\n状态由均值为 $\\mu_x$、协方差为 $\\Sigma_x$ 的高斯分布所表征。\n函数 $K = \\phi(x)$ 在均值状态 $\\mu_x$ 附近的一阶泰勒级数展开为：\n$$\n\\phi(x) \\approx \\phi(\\mu_x) + \\nabla \\phi(\\mu_x)^\\top (x - \\mu_x)\n$$\n其中 $\\nabla \\phi(\\mu_x)$ 是 $\\phi$ 在 $\\mu_x$ 处求得的梯度。我们用 $J$ 表示此梯度。\n\n$K$ 的期望值可近似为：\n$$\nE[K] = E[\\phi(x)] \\approx E[\\phi(\\mu_x) + J^\\top (x - \\mu_x)] = \\phi(\\mu_x) + J^\\top E[x - \\mu_x]\n$$\n由于 $E[x - \\mu_x] = E[x] - \\mu_x = \\mu_x - \\mu_x = 0$，均值的一阶近似为 $E[K] \\approx \\phi(\\mu_x)$。\n\n$K$ 的方差定义为 $\\mathrm{Var}(K) = E[(K - E[K])^2]$。对 $K$ 和 $E[K]$ 均使用一阶近似：\n$$\n\\mathrm{Var}(K) \\approx E\\left[ \\left( (\\phi(\\mu_x) + J^\\top (x - \\mu_x)) - \\phi(\\mu_x) \\right)^2 \\right]\n$$\n$$\n\\mathrm{Var}(K) \\approx E\\left[ \\left( J^\\top (x - \\mu_x) \\right)^2 \\right]\n$$\n平方项可以写成矩阵乘积的形式：\n$$\n\\mathrm{Var}(K) \\approx E\\left[ \\left( J^\\top (x - \\mu_x) \\right) \\left( (x - \\mu_x)^\\top J \\right) \\right]\n$$\n由于 $J$ 是一个常数向量（在恒定均值 $\\mu_x$ 处求值），我们可以将其移到期望符号之外：\n$$\n\\mathrm{Var}(K) \\approx J^\\top E\\left[ (x - \\mu_x) (x - \\mu_x)^\\top \\right] J\n$$\n期望内的项是状态向量 $x$ 的协方差矩阵的定义，即 $\\Sigma_x = E\\left[ (x - \\mu_x) (x - \\mu_x)^\\top \\right]$。\n因此，$K$ 的方差的一阶近似为：\n$$\n\\mathrm{Var}(K) \\approx J^\\top \\Sigma_x J\n$$\n这是向量函数不确定性传播的通用公式，此处特化为标量输出。\n\n为应用此公式，我们首先需要计算梯度向量 $J = \\nabla \\phi(x)$，并在均值工作点 $\\mu_x = (u_0, b_0, T_0)^\\top$ 处对其求值。梯度的分量是关于 $u$、$b$ 和 $T$ 的偏导数。\n\n1.  关于 $u$ 的偏导数：\n    $$\n    \\frac{\\partial K}{\\partial u} = \\frac{\\partial}{\\partial u} \\left[ \\frac{\\eta}{1 - u} \\left( 1 + \\gamma b \\right) \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right) \\right] = \\frac{\\eta}{(1-u)^2} \\left( 1 + \\gamma b \\right) \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right)\n    $$\n    这可以用 $K$ 本身更简单地表示：\n    $$\n    \\frac{\\partial K}{\\partial u} = K \\cdot \\frac{1}{1-u}\n    $$\n\n2.  关于 $b$ 的偏导数：\n    $$\n    \\frac{\\partial K}{\\partial b} = \\frac{\\eta}{1 - u} \\left[ \\frac{\\partial}{\\partial b} (1 + \\gamma b) \\right] \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right) = \\frac{\\eta}{1 - u} \\gamma \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right)\n    $$\n    用 $K$ 表示：\n    $$\n    \\frac{\\partial K}{\\partial b} = K \\cdot \\frac{\\gamma}{1+\\gamma b}\n    $$\n\n3.  关于 $T$ 的偏导数：\n    $$\n    \\frac{\\partial K}{\\partial T} = \\frac{\\eta}{1 - u} (1 + \\gamma b) \\left[ \\frac{\\partial}{\\partial T} \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right) \\right] = \\frac{\\eta}{1 - u} (1 + \\gamma b) \\exp\\left( \\beta (T - T_{\\mathrm{ref}}) \\right) \\cdot \\beta\n    $$\n    用 $K$ 表示：\n    $$\n    \\frac{\\partial K}{\\partial T} = K \\cdot \\beta\n    $$\n\n接下来，我们在均值工作点 $\\mu_x$（其中 $u_0 = 0.75$，$b_0 = 0.30$，$T_0 = 40$）处计算这些导数的值。我们还使用给定的常数：$\\eta = 0.8$，$\\gamma = 0.1$，$\\beta = 0.02$ 和 $T_{\\mathrm{ref}} = 35$。\n\n首先，我们计算 $K$ 在均值点的值，即 $K_0 = \\phi(\\mu_x)$：\n$$\nK_0 = \\frac{0.8}{1 - 0.75} (1 + 0.1 \\cdot 0.30) \\exp(0.02(40 - 35))\n$$\n$$\nK_0 = \\frac{0.8}{0.25} (1 + 0.03) \\exp(0.02 \\cdot 5) = 3.2 \\cdot 1.03 \\cdot \\exp(0.1) = 3.296 \\exp(0.1)\n$$\n使用 $\\exp(0.1)$ 的数值，我们得到 $K_0 \\approx 3.296 \\cdot 1.1051709 = 3.6426633$ 秒。\n\n现在我们计算雅可比（梯度）向量 $J = (J_u, J_b, J_T)^\\top$ 在 $\\mu_x$ 处的分量：\n$$\nJ_u = \\frac{\\partial K}{\\partial u} \\bigg|_{\\mu_x} = \\frac{K_0}{1 - u_0} = \\frac{K_0}{1 - 0.75} = \\frac{K_0}{0.25} = 4 K_0 \\approx 4 \\cdot 3.6426633 = 14.570653\n$$\n$$\nJ_b = \\frac{\\partial K}{\\partial b} \\bigg|_{\\mu_x} = \\frac{K_0 \\gamma}{1 + \\gamma b_0} = \\frac{K_0 \\cdot 0.1}{1 + 0.1 \\cdot 0.30} = \\frac{0.1 K_0}{1.03} \\approx 0.097087 \\cdot K_0 \\approx 0.353686\n$$\n$$\nJ_T = \\frac{\\partial K}{\\partial T} \\bigg|_{\\mu_x} = K_0 \\beta = 0.02 K_0 \\approx 0.02 \\cdot 3.6426633 = 0.072853\n$$\n因此，梯度向量为 $J \\approx (14.570653, 0.353686, 0.072853)^\\top$。\n\n最后，我们使用 $\\mathrm{Var}(K) \\approx J^\\top \\Sigma_x J$ 计算方差。协方差矩阵如下所示：\n$$\n\\Sigma_x = \\begin{pmatrix}\n0.0004  0.0003  0.01 \\\\\n0.0003  0.0025  0.02 \\\\\n0.01  0.02  2.25\n\\end{pmatrix}\n$$\n方差由以下二次型给出：\n$$\n\\mathrm{Var}(K) \\approx J_u^2 \\sigma_{uu}^2 + J_b^2 \\sigma_{bb}^2 + J_T^2 \\sigma_{TT}^2 + 2(J_u J_b \\sigma_{ub} + J_u J_T \\sigma_{uT} + J_b J_T \\sigma_{bT})\n$$\n其中 $\\sigma_{ij}$ 是 $\\Sigma_x$ 的元素。\n\n让我们计算每一项：\n-   来自 $u$ 的方差贡献：$J_u^2 \\sigma_{uu}^2 = (14.570653)^2 \\cdot 0.0004 \\approx 0.0849215$\n-   来自 $b$ 的方差贡献：$J_b^2 \\sigma_{bb}^2 = (0.353686)^2 \\cdot 0.0025 \\approx 0.0003127$\n-   来自 $T$ 的方差贡献：$J_T^2 \\sigma_{TT}^2 = (0.072853)^2 \\cdot 2.25 \\approx 0.0119421$\n-   来自 $u, b$ 的协方差贡献：$2 J_u J_b \\sigma_{ub} = 2 \\cdot 14.570653 \\cdot 0.353686 \\cdot 0.0003 \\approx 0.0030930$\n-   来自 $u, T$ 的协方差贡献：$2 J_u J_T \\sigma_{uT} = 2 \\cdot 14.570653 \\cdot 0.072853 \\cdot 0.01 \\approx 0.0212318$\n-   来自 $b, T$ 的协方差贡献：$2 J_b J_T \\sigma_{bT} = 2 \\cdot 0.353686 \\cdot 0.072853 \\cdot 0.02 \\approx 0.0010308$\n\n将这些贡献相加：\n$$\n\\mathrm{Var}(K) \\approx 0.0849215 + 0.0003127 + 0.0119421 + 0.0030930 + 0.0212318 + 0.0010308\n$$\n$$\n\\mathrm{Var}(K) \\approx 0.1225319 \\;\\mathrm{s}^2\n$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$\n\\mathrm{Var}(K) \\approx 0.1225 \\;\\mathrm{s}^2\n$$",
            "answer": "$$\n\\boxed{0.1225}\n$$"
        },
        {
            "introduction": "除了被动监控，数字孪生还可用于主动优化其所代表的系统，包括其自身的数据采集网络。这个实践问题将挑战您在预算和带宽等实际约束下，对传感器选择做出战略决策。您将使用费雪信息（Fisher information）作为传感器价值的量化指标，学习如何将传感器选择任务构建为一个约束优化问题，以实现信息增益的最大化 。",
            "id": "4215953",
            "problem": "一个用于信息物理系统（Cyber-Physical System, CPS）的数字孪生（Digital Twin, DT）被部署来监控一个无量纲的性能相关参数 $\\theta$。该参数编码了归一化的吞吐量下降情况（$\\theta$ 值越低表示性能越差）。该数字孪生可以订阅一组有限的传感器数据流，其索引为 $i \\in \\{1,2,3,4\\}$。每个传感器提供的测量值由以下模型表示\n$$\ny_{i}[k] \\;=\\; h_{i}(\\theta) \\;+\\; v_{i}[k],\n$$\n其中 $v_{i}[k] \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ 是在时间和传感器上独立同分布的噪声，而局部灵敏度 $s_{i} \\equiv \\left.\\frac{\\partial h_{i}(\\theta)}{\\partial \\theta}\\right|_{\\theta=\\theta_{0}}$ 在感兴趣的工作邻域内为常数。每个传感器 $i$ 以固定的采样率 $r_{i}$（样本/秒）进行数据流传输，其消息大小为 $m_{i}$（千比特/样本），产生的带宽消耗为 $b_{i} = r_{i} m_{i}$（千比特/秒）。每个被选中的传感器还会产生一个固定的运行成本 $c_{i}$（任意单位）。数字孪生必须选择一个传感器子集，以在总带宽和总成本的约束下，最大化关于 $\\theta$ 的每秒费雪信息（Fisher information）。\n\n假设传感器的特性如下：\n- 传感器 $1$：$s_{1} = 1.8$，$\\sigma_{1} = 0.6$，$r_{1} = 10$，$m_{1} = 5$ 千比特，$c_{1} = 2$。\n- 传感器 $2$：$s_{2} = 3.0$，$\\sigma_{2} = 1.5$，$r_{2} = 30$，$m_{2} = 8$ 千比特，$c_{2} = 5$。\n- 传感器 $3$：$s_{3} = 0.9$，$\\sigma_{3} = 0.3$，$r_{3} = 5$，$m_{3} = 3$ 千比特，$c_{3} = 1$。\n- 传感器 $4$：$s_{4} = 2.0$，$\\sigma_{4} = 1.0$，$r_{4} = 50$，$m_{4} = 20$ 千比特，$c_{4} = 8$。\n\n数字孪生在以下约束条件下运行\n$$\n\\sum_{i \\in S} b_{i} \\;\\leq\\; B_{\\max} \\;=\\; 300 \\text{ 千比特/秒}, \\quad\n\\sum_{i \\in S} c_{i} \\;\\leq\\; C_{\\max} \\;=\\; 7,\n$$\n其中 $S$ 是所选的传感器子集，并且选择必须同时满足这两个约束。您可以假设跨传感器和时间的测量在统计上是独立的，并且在 $\\theta_{0}$ 附近的线性化是有效的。仅使用费雪信息的定义和高斯似然函数的标准性质，推导由所选子集 $S$ 贡献的每秒费雪信息的表达式，并计算在给定约束下可实现的最大每秒费雪信息。将最终的信息值表示为一个纯数字，无需单位，也无需四舍五入。",
            "solution": "该问题的目标是在带宽和成本约束下，最大化来自传感器子集 $S$ 的每秒总费雪信息。由于统计独立性的假设，总费雪信息是每个选定传感器信息贡献的总和。\n\n首先，我们推导来自传感器 $i$ 的单个样本所贡献的费雪信息。测量值 $y_{i}[k]$ 服从均值为 $h_{i}(\\theta)$、方差为 $\\sigma_{i}^{2}$ 的高斯分布。概率密度函数（单个样本的似然函数）为：\n$$\np(y_{i}[k] | \\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_{i}^{2}}} \\exp\\left( -\\frac{(y_{i}[k] - h_{i}(\\theta))^{2}}{2\\sigma_{i}^{2}} \\right)\n$$\n对数似然函数 $\\mathcal{L}(\\theta) = \\ln p(y_{i}[k] | \\theta)$ 为：\n$$\n\\mathcal{L}(\\theta) = -\\frac{1}{2}\\ln(2\\pi\\sigma_{i}^{2}) - \\frac{(y_{i}[k] - h_{i}(\\theta))^{2}}{2\\sigma_{i}^{2}}\n$$\n单个样本的费雪信息 $J_{i}^{\\text{sample}}$ 定义为对数似然函数关于参数 $\\theta$ 的二阶导数的负期望值：\n$$\nJ_{i}^{\\text{sample}} = -E\\left[ \\frac{\\partial^{2}\\mathcal{L}(\\theta)}{\\partial\\theta^{2}} \\right]\n$$\n我们计算导数：\n$$\n\\frac{\\partial\\mathcal{L}(\\theta)}{\\partial\\theta} = -\\frac{1}{2\\sigma_{i}^{2}} \\cdot 2(y_{i}[k] - h_{i}(\\theta)) \\cdot \\left(-\\frac{\\partial h_{i}(\\theta)}{\\partial\\theta}\\right) = \\frac{y_{i}[k] - h_{i}(\\theta)}{\\sigma_{i}^{2}} \\frac{\\partial h_{i}(\\theta)}{\\partial\\theta}\n$$\n$$\n\\frac{\\partial^{2}\\mathcal{L}(\\theta)}{\\partial\\theta^{2}} = -\\frac{1}{\\sigma_{i}^{2}} \\left(\\frac{\\partial h_{i}(\\theta)}{\\partial\\theta}\\right)^{2} + \\frac{y_{i}[k] - h_{i}(\\theta)}{\\sigma_{i}^{2}} \\frac{\\partial^{2}h_{i}(\\theta)}{\\partial\\theta^{2}}\n$$\n取期望值，我们注意到 $E[y_{i}[k] - h_{i}(\\theta)] = E[v_{i}[k]] = 0$。使用给定的局部灵敏度 $s_{i} = \\frac{\\partial h_{i}(\\theta)}{\\partial\\theta}$，二阶导数的期望值变为：\n$$\nE\\left[ \\frac{\\partial^{2}\\mathcal{L}(\\theta)}{\\partial\\theta^{2}} \\right] = -\\frac{s_{i}^{2}}{\\sigma_{i}^{2}}\n$$\n因此，来自单个样本的费雪信息为：\n$$\nJ_{i}^{\\text{sample}} = - \\left(-\\frac{s_{i}^{2}}{\\sigma_{i}^{2}}\\right) = \\frac{s_{i}^{2}}{\\sigma_{i}^{2}}\n$$\n传感器 $i$ 每秒提供 $r_{i}$ 个独立样本。来自传感器 $i$ 的每秒总费雪信息（记为 $J_{i}$）是该秒内每个样本信息之和：\n$$\nJ_{i} = r_{i} \\cdot J_{i}^{\\text{sample}} = r_{i} \\frac{s_{i}^{2}}{\\sigma_{i}^{2}}\n$$\n对于传感器子集 $S$，每秒的总费雪信息 $J(S)$ 是集合中每个传感器贡献的总和，这是由于传感器之间的独立性：\n$$\nJ(S) = \\sum_{i \\in S} J_{i} = \\sum_{i \\in S} r_{i} \\frac{s_{i}^{2}}{\\sigma_{i}^{2}}\n$$\n问题是找到子集 $S \\subseteq \\{1, 2, 3, 4\\}$，以最大化 $J(S)$，并满足以下约束：\n$$\n\\sum_{i \\in S} b_{i} \\leq B_{\\max} \\quad \\text{and} \\quad \\sum_{i \\in S} c_{i} \\leq C_{\\max}\n$$\n其中 $b_i = r_i m_i$，$B_{\\max} = 300$，$C_{\\max} = 7$。\n\n我们为每个传感器计算 $b_i$ 和 $J_i$ 的值：\n- **传感器 1：**\n  $b_1 = 10 \\times 5 = 50$ kb/s\n  $J_1 = 10 \\cdot \\frac{1.8^2}{0.6^2} = 10 \\cdot \\left(\\frac{1.8}{0.6}\\right)^2 = 10 \\cdot 3^2 = 90$\n- **传感器 2：**\n  $b_2 = 30 \\times 8 = 240$ kb/s\n  $J_2 = 30 \\cdot \\frac{3.0^2}{1.5^2} = 30 \\cdot \\left(\\frac{3.0}{1.5}\\right)^2 = 30 \\cdot 2^2 = 120$\n- **传感器 3：**\n  $b_3 = 5 \\times 3 = 15$ kb/s\n  $J_3 = 5 \\cdot \\frac{0.9^2}{0.3^2} = 5 \\cdot \\left(\\frac{0.9}{0.3}\\right)^2 = 5 \\cdot 3^2 = 45$\n- **传感器 4：**\n  $b_4 = 50 \\times 20 = 1000$ kb/s\n  $J_4 = 50 \\cdot \\frac{2.0^2}{1.0^2} = 50 \\cdot 2^2 = 200$\n\n该优化问题是从 $\\{1,2,3,4\\}$ 中选择一个子集 $S$，以最大化 $\\sum_{i \\in S} J_i$，同时满足约束 $\\sum_{i \\in S} b_i \\le 300$ 和 $\\sum_{i \\in S} c_i \\le 7$。由于只有 $2^4 = 16$ 个可能的子集，我们可以通过枚举法找到解。\n\n我们来评估所有可能的子集 $S$：\n1.  $S = \\emptyset$: $b=0$, $c=0$。有效。$J=0$。\n2.  $S = \\{1\\}$: $b=50 \\le 300$, $c=2 \\le 7$。有效。$J=90$。\n3.  $S = \\{2\\}$: $b=240 \\le 300$, $c=5 \\le 7$。有效。$J=120$。\n4.  $S = \\{3\\}$: $b=15 \\le 300$, $c=1 \\le 7$。有效。$J=45$。\n5.  $S = \\{4\\}$: $b=1000 > 300$ (且 $c=8 > 7$）。无效。\n6.  $S = \\{1, 2\\}$: $b = 50+240=290 \\le 300$, $c = 2+5=7 \\le 7$。有效。$J = 90+120=210$。\n7.  $S = \\{1, 3\\}$: $b = 50+15=65 \\le 300$, $c = 2+1=3 \\le 7$。有效。$J = 90+45=135$。\n8.  $S = \\{1, 4\\}$: 包含传感器 4。无效。\n9.  $S = \\{2, 3\\}$: $b=240+15=255 \\le 300$, $c=5+1=6 \\le 7$。有效。$J = 120+45=165$。\n10. $S = \\{2, 4\\}$: 包含传感器 4。无效。\n11. $S = \\{3, 4\\}$: 包含传感器 4。无效。\n12. $S = \\{1, 2, 3\\}$: $b=50+240+15=305 > 300$。无效。\n13. 所有其他大小为 3 或 4 的子集都包含传感器 4 或无效子集 $\\{1,2,3\\}$，因此也无效。\n\n比较所有有效子集的费雪信息值：\n- $J(\\emptyset) = 0$\n- $J(\\{1\\}) = 90$\n- $J(\\{2\\}) = 120$\n- $J(\\{3\\}) = 45$\n- $J(\\{1, 2\\}) = 210$\n- $J(\\{1, 3\\}) = 135$\n- $J(\\{2, 3\\}) = 165$\n\n最大值为 $210$，通过传感器子集 $S = \\{1, 2\\}$ 实现。",
            "answer": "$$\n\\boxed{210}\n$$"
        }
    ]
}