{
    "hands_on_practices": [
        {
            "introduction": "优化是指导性分析的核心。本练习将解决一个基础的二次规划问题，这是信息物理系统中性能优化的常用模型。通过推导对偶问题并解释拉格朗日乘子，您将深入理解“影子价格”这一概念，它揭示了系统资源的边际价值，为投资和运营决策提供关键洞见 ()。",
            "id": "4235979",
            "problem": "一个信息物理系统 (CPS) 的数字孪生协调着 $2$ 个共享通信带宽资源的联网控制子系统。令 $x \\in \\mathbb{R}^n$ 表示将由 CPS 控制器部署的指令性设定点（例如，驱动速率）向量。该数字孪生使用指令性分析，通过最小化形式为 $f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$ 的严格凸二次性能指标来选择 $x$，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 满足 $Q \\succ 0$ 且 $c \\in \\mathbb{R}^n$。这些设定点受到代表 CPS 资源限制和协调要求的线性约束。\n\n从凸规划的拉格朗日函数和拉格朗日对偶函数的定义出发，并且不假设任何预先推导的公式，执行以下操作：\n\n$1.$ 考虑具有线性约束的严格凸二次规划\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad  \\frac{1}{2} x^{\\top} Q x + c^{\\top} x \\\\\n\\text{s.t.} \\quad  A x \\leq b, \\\\\n E x = h,\n\\end{aligned}\n$$\n其中 $Q \\succ 0$，$A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^m$，$E \\in \\mathbb{R}^{p \\times n}$，以及 $h \\in \\mathbb{R}^p$。推导拉格朗日函数、拉格朗日对偶函数和对偶优化问题，包括对偶变量的定义域。清楚地说明对偶变量的符号或自由域条件。将对偶变量的经济意义解释为 CPS 资源的影子价格。\n\n$2.$ 现在，将问题具体化为一个具有 $n=2$ 的 $2$-子系统 CPS，其共享带宽资源由单个等式约束 $a^{\\top} x = b$ 表示，其中 $a = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$ 和 $b \\in \\mathbb{R}$，并且具有非负性约束 $x \\geq 0$。令\n$$\nQ = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}, \n\\qquad\nc = \\begin{bmatrix} -8 \\\\ -5 \\end{bmatrix},\n\\qquad\nb = 5.\n$$\n使用在第 1 部分中从第一性原理推导出的 Karush–Kuhn–Tucker (KKT) 最优性条件，计算与等式约束 $a^{\\top} x = b$ 相关的最优拉格朗日乘子，并将其解释为 CPS 中带宽资源的影子价格。然后，使用对偶变量的包络解释，确定在 $b=5$ 时最优目标值相对于 $b$ 的边际变化。以每单位带宽的成本单位表示此边际变化。将最终答案以单个精确实数的形式给出。无需四舍五入。最终的方框答案中不要包含单位。",
            "solution": "用户希望我先验证问题，然后解决它。\n\n### 第 1 步：提取已知条件\n问题提供了以下信息：\n- 一个数字孪生协调 $2$ 个联网控制子系统。\n- 控制设定点是一个向量 $x \\in \\mathbb{R}^n$。\n- 要最小化的性能指标是一个严格凸二次函数：$f(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x$，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是一个满足 $Q \\succ 0$（严格正定）的矩阵，而 $c \\in \\mathbb{R}^n$ 是一个向量。\n- $x$ 的约束是线性的。\n- **第 1 部分**：一般问题是一个严格凸二次规划 (QP)：\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad  \\frac{1}{2} x^{\\top} Q x + c^{\\top} x \\\\\n\\text{s.t.} \\quad  A x \\leq b, \\\\\n E x = h,\n\\end{aligned}\n$$\n其中 $Q \\succ 0$，$A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^m$，$E \\in \\mathbb{R}^{p \\times n}$，以及 $h \\in \\mathbb{R}^p$。\n- **第 2 部分**：一个针对 $n=2$ 的 $2$-子系统 CPS 的具体问题。\n- 约束条件是共享带宽资源 $a^{\\top} x = b$ 和非负性 $x \\geq 0$。\n- 具体参数为：\n$$\nQ = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}, \n\\qquad\nc = \\begin{bmatrix} -8 \\\\ -5 \\end{bmatrix},\n\\qquad\na = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix},\n\\qquad\nb = 5.\n$$\n- 任务是计算等式约束的最优拉格朗日乘子，将其解释为影子价格，并确定最优目标值相对于 $b$ 的边际变化。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于凸优化这一成熟领域，特别是二次规划。将其应用于信息物理系统 (CPS) 中的资源分配是此类模型的标准且现实的用例。条件 $Q \\succ 0$ 确保目标函数是严格凸的，这是保证唯一最小化子的基本属性。对于第 2 部分中的具体矩阵 $Q = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}$，其顺序主子式为 $4 > 0$ 和 $\\det(Q) = (4)(3) - (2)(2) = 12 - 4 = 8 > 0$。由于所有顺序主子式均为正，因此 $Q$ 确实是正定的，满足所述条件。\n2.  **适定性**：该问题是适定的。在非空、闭合、凸的可行点集上最小化一个严格凸目标函数，会得到一个唯一的全局最小值。第 1 部分和第 2 部分中的约束都是线性的，定义了一个凸可行集。第 2 部分中的可行集 $\\{x \\in \\mathbb{R}^2 \\mid x_1+x_2=5, x_1 \\ge 0, x_2 \\ge 0 \\}$ 是一个非空的紧凑线段，确保解存在且唯一。\n3.  **客观性**：问题陈述使用了精确、无歧义的数学语言。没有主观或基于意见的元素。\n4.  **完整性**：问题提供了进行推导和计算所需的所有数据和定义。它是自洽的。\n5.  **其他缺陷**：该问题不存在任何其他列出的无效标准。它不是矛盾的、不切实际的、琐碎的或不可验证的。\n\n### 第 3 步：结论与行动\n问题是有效且适定的。我将继续进行解答。\n\n### 第 1 部分：对偶问题的推导\n\n原始问题是一个凸二次规划，由下式给出：\n$$\n\\begin{aligned}\np^* = \\min_{x \\in \\mathbb{R}^n} \\quad  \\frac{1}{2} x^{\\top} Q x + c^{\\top} x \\\\\n\\text{s.t.} \\quad  A x \\leq b, \\\\\n E x = h.\n\\end{aligned}\n$$\n为了构造拉格朗日函数，我们引入拉格朗日乘子（对偶变量）。令 $\\lambda \\in \\mathbb{R}^m$ 为与 $m$ 个不等式约束 $A x - b \\leq 0$ 相关联的乘子向量，令 $\\nu \\in \\mathbb{R}^p$ 为与 $p$ 个等式约束 $E x - h = 0$ 相关联的乘子向量。按照惯例，形式为 $g(x) \\leq 0$ 的不等式约束的乘子必须是非负的。因此，对偶变量的定义域为 $\\lambda \\geq 0$（逐元素）和 $\\nu \\in \\mathbb{R}^p$。\n\n拉格朗日函数 $L(x, \\lambda, \\nu)$ 定义为：\n$$\nL(x, \\lambda, \\nu) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x + \\lambda^{\\top}(A x - b) + \\nu^{\\top}(E x - h)\n$$\n我们可以重新排列各项，将涉及 $x$ 的项组合在一起：\n$$\nL(x, \\lambda, \\nu) = \\frac{1}{2} x^{\\top} Q x + (c + A^{\\top}\\lambda + E^{\\top}\\nu)^{\\top} x - \\lambda^{\\top}b - \\nu^{\\top}h\n$$\n拉格朗日对偶函数 $g(\\lambda, \\nu)$ 是拉格朗日函数关于原始变量 $x$ 的下确界：\n$$\ng(\\lambda, \\nu) = \\inf_{x \\in \\mathbb{R}^n} L(x, \\lambda, \\nu)\n$$\n对于固定的 $\\lambda$ 和 $\\nu$，拉格朗日函数 $L(x, \\lambda, \\nu)$ 是关于 $x$ 的二次函数。由于 $Q \\succ 0$，该函数在 $x$ 上是严格凸的。下确界在相对于 $x$ 的梯度为零的唯一点处取得：\n$$\n\\nabla_x L(x, \\lambda, \\nu) = Q x + c + A^{\\top}\\lambda + E^{\\top}\\nu = 0\n$$\n求解 $x$，我们找到最小化子 $x^*(\\lambda, \\nu)$：\n$$\nx^*(\\lambda, \\nu) = -Q^{-1}(c + A^{\\top}\\lambda + E^{\\top}\\nu)\n$$\n注意，由于 $Q$ 是正定的，因此它是可逆的。\n\n为了找到对偶函数 $g(\\lambda, \\nu)$，我们将 $x^*$ 代回到 $L(x, \\lambda, \\nu)$ 的表达式中：\n$$\ng(\\lambda, \\nu) = \\frac{1}{2} (x^*)^{\\top} Q x^* + (c + A^{\\top}\\lambda + E^{\\top}\\nu)^{\\top} x^* - \\lambda^{\\top}b - \\nu^{\\top}h\n$$\n根据平稳性条件，我们有 $(c + A^{\\top}\\lambda + E^{\\top}\\nu) = -Qx^*$。将此代入第二项得到：\n$$\ng(\\lambda, \\nu) = \\frac{1}{2} (x^*)^{\\top} Q x^* + (-Qx^*)^{\\top} x^* - \\lambda^{\\top}b - \\nu^{\\top}h = \\frac{1}{2} (x^*)^{\\top} Q x^* - (x^*)^{\\top} Q x^* - \\lambda^{\\top}b - \\nu^{\\top}h\n$$\n$$\ng(\\lambda, \\nu) = -\\frac{1}{2} (x^*)^{\\top} Q x^* - \\lambda^{\\top}b - \\nu^{\\top}h\n$$\n现在，我们代入 $x^*$ 的表达式：\n$$\n(x^*)^{\\top} Q x^* = \\left(-Q^{-1}(c + A^{\\top}\\lambda + E^{\\top}\\nu)\\right)^{\\top} Q \\left(-Q^{-1}(c + A^{\\top}\\lambda + E^{\\top}\\nu)\\right)\n$$\n由于 $Q$ 和 $Q^{-1}$ 是对称的，这可以简化为：\n$$\n(x^*)^{\\top} Q x^* = (c + A^{\\top}\\lambda + E^{\\top}\\nu)^{\\top} (Q^{-1})^{\\top} Q Q^{-1} (c + A^{\\top}\\lambda + E^{\\top}\\nu) = (c + A^{\\top}\\lambda + E^{\\top}\\nu)^{\\top} Q^{-1} (c + A^{\\top}\\lambda + E^{\\top}\\nu)\n$$\n因此，拉格朗日对偶函数为：\n$$\ng(\\lambda, \\nu) = -\\frac{1}{2} (c + A^{\\top}\\lambda + E^{\\top}\\nu)^{\\top} Q^{-1} (c + A^{\\top}\\lambda + E^{\\top}\\nu) - b^{\\top}\\lambda - h^{\\top}\\nu\n$$\n对偶问题是在对偶变量的约束下最大化对偶函数：\n$$\n\\begin{aligned}\n\\max_{\\lambda, \\nu} \\quad  g(\\lambda, \\nu) \\\\\n\\text{s.t.} \\quad  \\lambda \\geq 0.\n\\end{aligned}\n$$\n对偶变量的定义域要求对于每个 $i=1, \\dots, m$ 都有 $\\lambda_i \\geq 0$，而变量 $\\nu_j$（对于 $j=1, \\dots, p$）是自由的（符号无约束）。\n\n对偶变量的经济解释是影子价格。对于一个 $b$ 代表资源限制、$h$ 代表性能目标的问题，最优对偶变量 $(\\lambda^*, \\nu^*)$ 量化了最优目标值 $p^*$ 对这些约束中扰动的敏感性。根据包络定理，在最优点，我们有 $\\frac{\\partial p^*}{\\partial b_i} = -\\lambda_i^*$ 和 $\\frac{\\partial p^*}{\\partial h_j} = -\\nu_j^*$。因此，$\\lambda_i^*$ 是当第 $i$ 个资源限制 $b_i$ 增加时，最优成本*下降*的边际率。$\\lambda_i^*>0$ 的值表示第 $i$ 个约束是活跃且稀缺的，增加供应 $b_i$ 会改善目标。类似地，$-\\nu_j^*$ 是当第 $j$ 个目标 $h_j$ 增加时，成本变化的边际率。\n\n### 第 2 部分：具体计算与解释\n\n我们得到具体问题如下：\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^2} \\quad  f(x) = \\frac{1}{2} x^{\\top} \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix} x + \\begin{bmatrix} -8 \\\\ -5 \\end{bmatrix}^{\\top} x \\\\\n\\text{s.t.} \\quad  x_1 + x_2 = 5, \\\\\n x_1 \\geq 0, \\quad x_2 \\geq 0.\n\\end{aligned}\n$$\n约束可以写成 $x_1+x_2-5=0$, $-x_1 \\le 0$ 和 $-x_2 \\le 0$。我们为等式约束引入拉格朗日乘子 $\\nu$，为非负性约束引入乘子 $\\mu_1, \\mu_2$。拉格朗日函数是：\n$$\nL(x_1, x_2, \\mu_1, \\mu_2, \\nu) = \\frac{1}{2}(4x_1^2 + 4x_1x_2 + 3x_2^2) - 8x_1 - 5x_2 - \\mu_1 x_1 - \\mu_2 x_2 + \\nu(x_1+x_2-5)\n$$\n最优解 $(x^*, \\mu^*, \\nu^*)$ 的 Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **平稳性**：$\\nabla_x L = 0$\n    $$ \\frac{\\partial L}{\\partial x_1} = 4x_1 + 2x_2 - 8 - \\mu_1 + \\nu = 0 $$\n    $$ \\frac{\\partial L}{\\partial x_2} = 2x_1 + 3x_2 - 5 - \\mu_2 + \\nu = 0 $$\n2.  **原始可行性**：\n    $$ x_1 + x_2 = 5 $$\n    $$ x_1 \\geq 0, \\quad x_2 \\geq 0 $$\n3.  **对偶可行性**：\n    $$ \\mu_1 \\geq 0, \\quad \\mu_2 \\geq 0 $$\n4.  **互补松弛性**：\n    $$ \\mu_1 x_1 = 0, \\quad \\mu_2 x_2 = 0 $$\n\n我们求解这个系统。互补松弛性条件建议根据哪些非负性约束是活跃的来分析情况。我们假设最优解位于 $x$ 的可行域内部，即 $x_1 > 0$ 且 $x_2 > 0$。\n\n情况 1：$x_1 > 0$ 且 $x_2 > 0$。\n根据互补松弛性，我们必须有 $\\mu_1 = 0$ 和 $\\mu_2 = 0$。平稳性条件简化为：\n(1) $4x_1 + 2x_2 + \\nu = 8$\n(2) $2x_1 + 3x_2 + \\nu = 5$\n我们还有原始可行性条件：\n(3) $x_1 + x_2 = 5$\n\n从方程 (1) 中减去方程 (2) 以消去 $\\nu$：\n$(4x_1 - 2x_1) + (2x_2 - 3x_2) = 8 - 5 \\implies 2x_1 - x_2 = 3$。\n现在我们有一个关于 $x_1$ 和 $x_2$ 的二元线性方程组：\n$$ 2x_1 - x_2 = 3 $$\n$$ x_1 + x_2 = 5 $$\n将这两个方程相加得到 $3x_1 = 8$，所以 $x_1 = \\frac{8}{3}$。\n代入 $x_1 + x_2 = 5$ 得到 $x_2 = 5 - \\frac{8}{3} = \\frac{15-8}{3} = \\frac{7}{3}$。\n我们必须验证我们的初始假设：$x_1 = \\frac{8}{3} > 0$ 且 $x_2 = \\frac{7}{3} > 0$。该假设是一致的。\n现在我们使用方程 (2) 来求 $\\nu$ 的值：\n$2(\\frac{8}{3}) + 3(\\frac{7}{3}) + \\nu = 5$\n$\\frac{16}{3} + \\frac{21}{3} + \\nu = 5$\n$\\frac{37}{3} + \\nu = 5 \\implies \\nu = 5 - \\frac{37}{3} = \\frac{15-37}{3} = -\\frac{22}{3}$。\n\n候选解为 $x^* = (\\frac{8}{3}, \\frac{7}{3})$，$\\mu^* = (0, 0)$，$\\nu^* = -\\frac{22}{3}$。所有 KKT 条件都满足：原始可行性（$x_1+x_2 = \\frac{15}{3} = 5$, $x_1,x_2 > 0$）、对偶可行性（$\\mu_1, \\mu_2 \\geq 0$）和互补松弛性均成立。由于问题是严格凸的，这是唯一的全局最优解。\n\n与等式约束 $a^{\\top}x = b$ 相关的最优拉格朗日乘子是 $\\nu^* = -\\frac{22}{3}$。\n在 CPS 的背景下，约束 $x_1 + x_2 = 5$ 代表总共享带宽为 $5$ 个单位。变量 $x_1$ 和 $x_2$ 是分配给两个子系统的带宽。乘子 $\\nu^*$ 是与此资源约束相关的影子价格。\n根据第 1 部分中推导的包络定理的解释，最优成本 $p^*(b)$ 相对于资源限制 $b$ 的导数由 $\\frac{dp^*}{db} = -\\nu^*$ 给出。\n在 $b=5$ 时，最优目标值相对于 $b$ 的边际变化是：\n$$ -\\nu^* = - \\left(-\\frac{22}{3}\\right) = \\frac{22}{3} $$\n这个值代表了增加共享带宽的边际效益。总带宽增加一个单位，将导致可达到的最低性能成本降低 $\\frac{22}{3}$ 个成本单位。因此，带宽资源的边际价值或影子价格是每单位带宽 $\\frac{22}{3}$ 个成本单位。所要求的量就是这个边际变化。",
            "answer": "$$\n\\boxed{\\frac{22}{3}}\n$$"
        },
        {
            "introduction": "现实世界的决策很少只涉及单一目标；通常需要在成本、性能和能耗等相互冲突的目标之间取得平衡。本练习将探讨多目标优化领域，重点关注帕累托最优性的核心概念 ()。您将学习使用加权和标量化方法来处理不同目标之间的权衡，并理解其在非凸帕累托前沿情况下的局限性，这对于在没有唯一最优解的情况下做出明智决策至关重要。",
            "id": "4235973",
            "problem": "一个信息物理系统（CPS）的数字孪生（DT）被用来支持一个制造单元的规范性决策，该制造单元可以在几种控制策略中的一种下运行。该DT为每种策略持续估计两个相互竞争的运营绩效结果：单位产品的平均能耗，用 $f_{1}(x)$ 表示，单位为 $\\mathrm{kJ}$；以及与目标值的平均周期时间偏差，用 $f_{2}(x)$ 表示，单位为 $\\mathrm{s}$。决策者寻求同时最小化这两个目标。\n\n从多目标最小化的帕累托支配和帕累托最优的核心定义出发，并假设决策者对向量值成本进行标量化时遵循以下基本原则：\n- 相对于每个目标的单调性（如果所有目标值都弱改善，并且至少有一个严格改善，则标量化值严格改善），\n- 相对于目标量值缩放的正齐次性，\n- 对于可分离目标的加法性，\n\n推导出一个标量目标 $g(x)$，它能在与帕累托改进一致的决策上导出一个全预序。然后，利用目标空间中可达目标集的凸分析，建立当帕累托前沿为凸时，最小化 $g(x)$ 能产生帕累托最优解的条件，并解释当帕累托前沿为非凸时出现的局限性。\n\n该DT评估了三种离散的控制策略，$x_{A}$、$x_{B}$ 和 $x_{C}$，得到以下二维目标向量：\n- $f(x_{A}) = (10\\,\\mathrm{kJ},\\, 6\\,\\mathrm{s})$，\n- $f(x_{B}) = (12\\,\\mathrm{kJ},\\, 5.3\\,\\mathrm{s})$，\n- $f(x_{C}) = (14\\,\\mathrm{kJ},\\, 3.8\\,\\mathrm{s})$。\n\n假设您的推导标量化方法针对双目标问题进行了特化，其中单个权重 $w \\in (0,1)$ 以符合上述原则的方式调节 $f_{1}(x)$ 与 $f_{2}(x)$ 的相对重要性。确定唯一的 $w^{\\star} \\in (0,1)$ 值，在该值下，决策 $x_{A}$ 和 $x_{C}$ 在标量化下完全相等。基于此分析以及可达目标集的几何结构，论证当帕累托前沿为非凸时，$x_{B}$ 是否可以被任何 $w \\in (0,1)$ 选中。\n\n将 $w^{\\star}$ 的最终值表示为最简分数。不需要四舍五入，且 $w^{\\star}$ 不应包含单位。",
            "solution": "该决策问题涉及两个需要最小化的目标，$f_{1}(x)$ 和 $f_{2}(x)$，其向量目标为 $\\mathbf{f}(x) = \\big(f_{1}(x), f_{2}(x)\\big)$。如果 $\\mathbf{f}(x) \\le \\mathbf{f}(y)$ 按分量成立且至少有一个不等式是严格的，则称决策 $x$ 帕累托支配 $y$。如果一个决策没有被其他任何决策所支配，则称其为帕累托最优。\n\n我们寻求一种标量化方法 $g(x)$，它将 $\\mathbf{f}(x)$ 映射为一个标量，并与决策者的原则保持一致：\n- 单调性：如果 $\\mathbf{z}, \\mathbf{z}' \\in \\mathbb{R}^{m}$ 满足 $\\mathbf{z} \\le \\mathbf{z}'$ 按分量成立，并且对于某个 $i$ 有 $z_{i}  z'_{i}$，那么 $g(\\mathbf{z})  g(\\mathbf{z}')$。\n- 正齐次性：对于 $\\alpha \\ge 0$，有 $g(\\alpha \\mathbf{z}) = \\alpha g(\\mathbf{z})$。\n- 对于可分离目标的加法性：对于 $\\mathbf{z}, \\mathbf{z}' \\in \\mathbb{R}^{m}$，有 $g(\\mathbf{z} + \\mathbf{z}') = g(\\mathbf{z}) + g(\\mathbf{z}')$。\n\n假设在各分量上可分离，设 $g(\\mathbf{z}) = \\sum_{i=1}^{m} h_{i}(z_{i})$。加法性与正齐次性共同约束每个 $h_{i}$ 为一个线性函数：对于所有 $u, v \\in \\mathbb{R}$ 和 $\\alpha \\ge 0$，有 $h_{i}(u+v) = h_{i}(u) + h_{i}(v)$ 和 $h_{i}(\\alpha u) = \\alpha h_{i}(u)$，而单调性要求 $h_{i}$ 是严格递增的。满足这些性质和连续性（工程系统中决策支持的一个标准正则性假设）的唯一函数是 $h_{i}(z_{i}) = w_{i} z_{i}$，其中权重 $w_{i}  0$。因此，\n$$\ng(\\mathbf{f}(x)) = \\sum_{i=1}^{m} w_{i} f_{i}(x),\n$$\n其中 $w_{i}  0$ 编码了决策者的相对侧重。由于 $w_{i}$ 的正性，这种标量化方法在帕累托支配关系下是保序的：如果 $\\mathbf{f}(x) \\le \\mathbf{f}(y)$ 且至少有一个不等式是严格的，那么 $g(\\mathbf{f}(x))  g(\\mathbf{f}(y))$。\n\n当可达目标集 $\\mathcal{Y} = \\{\\mathbf{f}(x) : x \\in \\mathcal{X}\\} \\subset \\mathbb{R}^{m}$ 是凸集，并且我们考虑在 $\\mathbf{y} \\in \\mathcal{Y}$ 上最小化 $g(\\mathbf{y})$（其中 $w_{i}  0$）时，其最小化者是帕累托最优的，因为任何分量的严格改善都会降低标量化值。此外，根据凸分析中的支撑超平面定理，$\\mathcal{Y}$ 的凸下边界上的每个帕累托最优点都存在一个具有正法向量 $\\mathbf{w} \\in \\mathbb{R}^{m}_{++}$ 的支撑超平面，使得该点在 $\\mathcal{Y}$ 上最小化 $\\mathbf{w}^{\\top} \\mathbf{y}$。因此，在凸的情况下，加权和标量化可以恢复所有帕累托最优点。\n\n相比之下，当帕累托前沿为非凸时，存在一些帕累托最优点，它们不能被任何具有正法向量的超平面所支撑；这些点被称为非支撑帕累托点。对于任何正权重的选择，使用 $\\sum_{i} w_{i} f_{i}(x)$ 的线性标量化方法都无法选中这些点，这是一个根本性的局限性。\n\n我们现在将问题特化为两个目标和给定的三种策略。设 $w \\in (0,1)$ 是 $f_{1}(x)$ 的权重，$1-w$ 是 $f_{2}(x)$ 的权重。标量化目标为\n$$\ng_{w}(x) = w f_{1}(x) + (1-w) f_{2}(x).\n$$\n计算每种策略的标量化值：\n- 对于 $x_{A}$，其 $f(x_{A}) = (10, 6)$：\n$$\ng_{w}(x_{A}) = w \\cdot 10 + (1-w) \\cdot 6 = 6 + 4w.\n$$\n- 对于 $x_{B}$，其 $f(x_{B}) = (12, 5.3)$：\n$$\ng_{w}(x_{B}) = w \\cdot 12 + (1-w) \\cdot 5.3 = 5.3 + 6.7w.\n$$\n- 对于 $x_{C}$，其 $f(x_{C}) = (14, 3.8)$：\n$$\ng_{w}(x_{C}) = w \\cdot 14 + (1-w) \\cdot 3.8 = 3.8 + 10.2w.\n$$\n\n确定唯一的 $w^{\\star} \\in (0,1)$，使得 $g_{w^{\\star}}(x_{A}) = g_{w^{\\star}}(x_{C})$：\n$$\n6 + 4w^{\\star} \\;=\\; 3.8 + 10.2 w^{\\star}\n\\;\\;\\Longrightarrow\\;\\;\n6 - 3.8 \\;=\\; (10.2 - 4) w^{\\star}\n\\;\\;\\Longrightarrow\\;\\;\n2.2 \\;=\\; 6.2\\, w^{\\star}\n\\;\\;\\Longrightarrow\\;\\;\nw^{\\star} \\;=\\; \\frac{2.2}{6.2} \\;=\\; \\frac{11}{31}.\n$$\n\n为了分析 $x_{B}$ 是否对于任何 $w \\in (0,1)$ 都是最优的，我们将 $g_{w}(x_{B})$ 与 $g_{w}(x_{A})$ 和 $g_{w}(x_{C})$ 进行比较：\n- 比较 $x_{B}$ 与 $x_{A}$：\n$$\ng_{w}(x_{B}) - g_{w}(x_{A})\n\\;=\\; (5.3 + 6.7w) - (6 + 4w)\n\\;=\\; -0.7 + 2.7w.\n$$\n当 $w \\ge \\frac{0.7}{2.7} = \\frac{7}{27} \\approx 0.259259$ 时，该值为非负，因此对于 $w \\ge \\frac{7}{27}$，$x_{B}$ 在标量化下比 $x_{A}$ 差或相等。\n- 比较 $x_{B}$ 与 $x_{C}$：\n$$\ng_{w}(x_{B}) - g_{w}(x_{C})\n\\;=\\; (5.3 + 6.7w) - (3.8 + 10.2w)\n\\;=\\; 1.5 - 3.5w.\n$$\n当 $w \\le \\frac{1.5}{3.5} = \\frac{3}{7} \\approx 0.428571$ 时，该值为非负，因此对于 $w \\le \\frac{3}{7}$，$x_{B}$ 在标量化下比 $x_{C}$ 差或相等。\n\n综合这些，对于 $w \\in (0, \\frac{7}{27})$，$x_{C}$ 严格优于 $x_{B}$；对于 $w \\in [\\frac{7}{27}, \\frac{3}{7}]$，$x_{B}$ 比 $x_{A}$ 和 $x_{C}$ 都差；对于 $w \\in (\\frac{3}{7}, 1)$，$x_{A}$ 严格优于 $x_{B}$。因此，$x_{B}$ 对于任何 $w \\in (0,1)$ 都不是最优的。\n\n从几何上看，可达的目标点是 $\\{(10,6), (12,5.3), (14,3.8)\\}$。由于在最小化问题的目标空间中，点 $(12,5.3)$ 严格位于连接 $(10,6)$ 和 $(14,3.8)$ 的线段之上，因此它是一个非支撑帕累托点。线性标量化对应于滑动一条法向量为 $(w, 1-w)$ 的直线以接触下凸包；只有支撑的极点 $(10,6)$ 和 $(14,3.8)$ 会被选中。这说明了当帕累托前沿为非凸时，加权和标量化方法的局限性。\n\n因此，唯一的使两者相等的权重是 $w^{\\star} = \\frac{11}{31}$，而在推导出的标量化方法下，$x_{B}$ 对于任何 $w \\in (0,1)$ 都不是最优的。",
            "answer": "$$\\boxed{\\frac{11}{31}}$$"
        },
        {
            "introduction": "不确定性是控制现代信息物理系统时面临的关键挑战。这个动手编程练习深入研究了不确定性下的模型预测控制（MPC），比较了一种简单的确定性方法与一种更复杂的随机策略 ()。通过实施和比较这两种策略，您将能够量化“随机解的价值”，从而具体地展示出在模型中明确考虑不确定性如何带来更优的决策和更好的长期性能。",
            "id": "4235990",
            "problem": "考虑一个线性时不变信息物理系统 (CPS)，其数字孪生 (DT) 用于在存在预测不确定性的情况下进行模型预测控制 (MPC)。系统动力学由标量线性模型 $x_{t+1} = a x_t + b u_t + w_t$ 给出，其中 $x_t$ 是时间 $t$ 的状态，$u_t$ 是时间 $t$ 的控制输入，$w_t$ 是一个外生扰动，代表时间 $t$ 的预测误差。在长度为 $N$ 的有限预测时域内，控制目标是最小化期望二次成本 $\\sum_{t=0}^{N-1} \\left( q x_t^2 + r u_t^2 \\right)$，其中 $q  0$ 和 $r  0$ 是标量权重。初始状态 $x_0$ 是已知的。\n\n需要比较两种规范性决策策略：\n1. 模型预测控制 (MPC)，在时域内嵌入情景树，并强制执行非预见性：在每个阶段 $t$，决策 $u_t$ 可能依赖于截至阶段 $t$ 观测到的历史，但不能依赖于未来的扰动。这为每个由截至 $t-1$ 的扰动历史定义的阶段 $t$ 的节点 $s$ 产生了一个特定于节点的策略 $u_{t,s}$。\n2. 确定性等效 (CE) MPC：计算一个单一的开环控制序列 $\\{u_t\\}_{t=0}^{N-1}$，该序列使用在每个阶段等于扰动均值的确定性预测，并在时域内应用，不对已实现的扰动进行调整。\n\n扰动 $w_t$ 在各个阶段之间是独立的，并取情景树指定的离散值。每个阶段 $t$ 的情景树由一组扰动值 $\\{w^{(k)}\\}$ 和相关的概率 $\\{p^{(k)}\\}$ 组成，这组值在每个阶段重复出现，并且由于阶段间的独立性，路径概率是阶段概率的乘积。\n\n仅从以下基本定义出发：\n- 离散时间线性系统动力学 $x_{t+1} = a x_t + b u_t + w_t$，\n- 二次阶段成本 $q x_t^2 + r u_t^2$，\n- 基于情景的决策中的非预见性（决策可依赖于过去但不能依赖于未来的扰动），\n- 期望值是情景树上的概率加权和，\n推导出一个有原则的算法，用以为给定的时域 $N$ 计算基于情景的 MPC 策略的期望成本和确定性等效 MPC 策略的期望成本。两种策略的推导和评估方式都应能在任何现代编程语言中普遍实现，纯粹以数学和逻辑术语表示，通过枚举情景树的所有路径来形成作为路径成本的概率加权和的期望成本。\n\n您的程序必须实现这两种策略，通过显式情景树枚举评估它们的期望成本，并为每个提供的测试用例输出期望成本的差值（确定性等效减去基于情景的），结果为浮点数，无需物理单位。最终输出必须是单行，包含一个由逗号分隔并用方括号括起来的结果列表。\n\n使用以下测试套件，其中每个元组指定 $(a, b, q, r, N, x_0, \\text{w\\_values}, \\text{w\\_probabilities})$：\n- 测试用例 1：$a = 1.0$, $b = 1.0$, $q = 1.0$, $r = 0.1$, $N = 3$, $x_0 = 2.0$, $\\text{w\\_values} = [-1.0, 0.0, 1.0]$, $\\text{w\\_probabilities} = [0.2, 0.6, 0.2]$。\n- 测试用例 2：$a = 1.0$, $b = 1.0$, $q = 1.0$, $r = 5.0$, $N = 3$, $x_0 = 2.0$, $\\text{w\\_values} = [-1.0, 0.0, 1.0]$, $\\text{w\\_probabilities} = [0.2, 0.6, 0.2]$。\n- 测试用例 3：$a = 1.0$, $b = 1.0$, $q = 1.0$, $r = 0.1$, $N = 3$, $x_0 = 2.0$, $\\text{w\\_values} = [0.0]$, $\\text{w\\_probabilities} = [1.0]$。\n- 测试用例 4：$a = 1.2$, $b = 1.0$, $q = 1.0$, $r = 0.1$, $N = 3$, $x_0 = 2.0$, $\\text{w\\_values} = [-1.0, 0.0, 1.0]$, $\\text{w\\_probabilities} = [0.2, 0.6, 0.2]$。\n\n您的程序应生成单行输出，包含一个由逗号分隔并用方括号括起来的结果列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是测试用例 $i$ 的确定性等效 MPC 的期望成本与基于情景的 MPC 的期望成本之间的差值的浮点数。",
            "solution": "该问题要求推导一种算法，用于计算和比较线性随机系统的两种不同控制策略的期望成本：一种是基于情景的模型预测控制 (SMPC) 策略，另一种是确定性等效 (CE) MPC 策略。比较的度量是它们在完整情景树上评估的期望成本之差。\n\n系统动力学由线性时不变 (LTI) 模型给出：\n$$x_{t+1} = a x_t + b u_t + w_t$$\n其中 $x_t$ 是状态，$u_t$ 是控制输入，$w_t$ 是在阶段 $t \\in \\{0, 1, ..., N-1\\}$ 的独立同分布 (i.i.d.) 随机扰动。目标是最小化长度为 $N$ 的时域内的总期望二次成本：\n$$J = \\mathbb{E}\\left[ \\sum_{t=0}^{N-1} (q x_t^2 + r u_t^2) \\right]$$\n其中 $q  0$ 且 $r  0$。初始状态 $x_0$ 是已知的。每个阶段的扰动 $w_t$ 遵循一个离散概率分布，由值 $\\{w^{(k)}\\}$ 和相应的概率 $\\{p^{(k)}\\}$ 给出。\n\n我们将基于动态规划原理推导这两种策略的算法，然后描述基于显式情景枚举的评估过程。\n\n### 策略 1：基于情景的 MPC (SMPC) 策略\n\n该策略对于随机问题是最优的，并遵守非预见性原则，即控制 $u_t$ 是状态 $x_t$（它隐含了直到 $t-1$ 的扰动历史）的函数，但不是未来扰动的函数。最优策略可以使用随机动态规划 (SDP) 找到。\n\n设 $V_t(x)$ 为从阶段 $t$ 的状态 $x$ 到时域结束的最优期望未来成本。终端成本为零，所以 $V_N(x) = 0$。贝尔曼方程提供了价值函数的反向递推：\n$$V_t(x_t) = \\min_{u_t} \\left\\{ q x_t^2 + r u_t^2 + \\mathbb{E}_{w_t} [V_{t+1}(x_{t+1})] \\right\\}$$\n其中 $x_{t+1} = a x_t + b u_t + w_t$。期望 $\\mathbb{E}_{w_t}[\\cdot]$ 是对扰动 $w_t$ 的分布求得的。\n\n对于具有二次成本的线性系统，价值函数在状态上也是二次的：\n$$V_t(x) = P_t x^2 + S_t x + K_t$$\n终端条件为 $P_N = 0$, $S_N = 0$ 和 $K_N = 0$。\n\n我们将 $V_{t+1}$ 的形式代入贝尔曼方程：\n$$V_t(x_t) = \\min_{u_t} \\left\\{ q x_t^2 + r u_t^2 + \\mathbb{E}_{w_t} [P_{t+1}(a x_t + b u_t + w_t)^2 + S_{t+1}(a x_t + b u_t + w_t) + K_{t+1}] \\right\\}$$\n设 $\\bar{w} = \\mathbb{E}[w_t]$ 和 $\\mathbb{E}[w_t^2]$ 分别是扰动的一阶矩和二阶矩。期望项变为：\n$$ \\mathbb{E}[\\cdot] = P_{t+1} \\left((a x_t + b u_t)^2 + 2(a x_t + b u_t)\\bar{w} + \\mathbb{E}[w_t^2]\\right) + S_{t+1}(a x_t + b u_t + \\bar{w}) + K_{t+1} $$\n需要对 $u_t$ 最小化的表达式是 $u_t$ 的二次函数。为找到最小值，我们将其对 $u_t$ 的导数设为零：\n$$ \\frac{\\partial}{\\partial u_t}(\\cdot) = 2 r u_t + 2b P_{t+1}(a x_t + b u_t + \\bar{w}) + b S_{t+1} = 0 $$\n求解 $u_t$ 得到阶段 $t$ 的最优控制律：\n$$ u_t^*(x_t) = -\\frac{abP_{t+1}}{r+b^2P_{t+1}} x_t - \\frac{b(P_{t+1}\\bar{w} + S_{t+1}/2)}{r+b^2P_{t+1}} $$\n这是一个形式为 $u_t^*(x_t) = L_t x_t + l_t$ 的线性反馈策略，其中：\n$$ L_t = -\\frac{abP_{t+1}}{r+b^2P_{t+1}} \\quad \\text{和} \\quad l_t = -\\frac{b(P_{t+1}\\bar{w} + S_{t+1}/2)}{r+b^2P_{t+1}} $$\n通过将 $u_t^*(x_t)$ 代回 $V_t(x_t)$ 的贝尔曼方程，并收集 $x_t^2$、$x_t$ 和常数项的系数，我们推导出 $P_t$、$S_t$ 和 $K_t$ 的反向类黎卡提递推。设 $A_t = a + bL_t$ 和 $B_t = bl_t$。则：\n$$ P_t = q + rL_t^2 + P_{t+1}A_t^2 $$\n$$ S_t = 2rL_tl_t + 2P_{t+1}A_t(B_t+\\bar{w}) + S_{t+1}A_t $$\n$$ K_t = rl_t^2 + P_{t+1}((B_t+\\bar{w})^2 + \\mathbb{E}[w_t^2] - \\bar{w}^2) + S_{t+1}(B_t+\\bar{w}) + K_{t+1} $$\n项 $\\mathbb{E}[w_t^2] - \\bar{w}^2$ 是扰动的方差，$\\text{Var}(w_t)$。\n\n该算法首先从 $t=N-1$ 反向迭代至 $t=0$ 来计算系数序列 $\\{P_t, S_t, K_t\\}$ 和策略增益 $\\{L_t, l_t\\}$。然后，SMPC 策略的总最小期望成本由 $J^{\\text{SMPC}} = V_0(x_0) = P_0 x_0^2 + S_0 x_0 + K_0$ 给出。\n\n### 策略 2：确定性等效 (CE) MPC 策略\n\nCE-MPC 策略通过将其均值 $\\bar{w}$ 替换随机扰动 $w_t$ 来简化问题。这创建了一个确定性最优控制问题：\n$$ \\min_{\\{u_t\\}_{t=0}^{N-1}} \\sum_{t=0}^{N-1} (q x_t^2 + r u_t^2) $$\n受确定性动力学 $x_{t+1} = a x_t + b u_t + \\bar{w}$ 约束，初始状态为 $x_0$。\n\n这个问题可以使用相同的动态规划框架来解决，这等同于在 SMPC 公式中将扰动的方差设置为零。由此产生的最优策略也是一个线性状态反馈，$u_t(x_t) = L_t^{\\text{CE}}x_t + l_t^{\\text{CE}}$，其中增益通过相同的黎卡提递推计算，但 $\\mathbb{E}[w_t^2] = \\bar{w}^2$。\n\nCE-MPC 策略通过前向模拟确定性系统来计算一个单一的开环控制序列 $\\{u_t^{\\text{CE}}\\}_{t=0}^{N-1}$：\n1. 初始化确定性状态 $\\hat{x}_0 = x_0$。\n2. 对于 $t = 0, ..., N-1$：\n   a. 计算控制：$u_t^{\\text{CE}} = L_t^{\\text{CE}}\\hat{x}_t + l_t^{\\text{CE}}$。\n   b. 更新确定性状态：$\\hat{x}_{t+1} = a \\hat{x}_t + b u_t^{\\text{CE}} + \\bar{w}$。\n这产生一个固定的控制动作序列，将应用于真实的随机系统。\n\n### 通过情景枚举进行评估\n\n问题要求通过枚举所有可能的扰动路径来评估两种策略的期望成本，这与指定的情景树结构一致。假设每个阶段有 $M$ 个可能的扰动值。对于长度为 $N$ 的时域，存在 $M^N$ 条唯一的扰动路径 $W_j = (w_{0,j}, w_{1,j}, ..., w_{N-1,j})$。路径 $j$ 的概率是 $p_j = \\prod_{t=0}^{N-1} p(w_{t,j})$。\n\n**CE-MPC 策略的期望成本**：\n应用固定的开环序列 $\\{u_t^{\\text{CE}}\\}$。对于每个路径 $j$，状态轨迹 $\\{x_{t,j}\\}$ 根据以下公式演化：\n$$ x_{t+1,j} = a x_{t,j} + b u_t^{\\text{CE}} + w_{t,j} $$\n此路径的成本为 $C_j^{\\text{CE}} = \\sum_{t=0}^{N-1} (q x_{t,j}^2 + r (u_t^{\\text{CE}})^2)$。\n总期望成本是所有路径的概率加权平均：\n$$ \\mathbb{E}[C^{\\text{CE}}] = \\sum_{j} p_j C_j^{\\text{CE}} $$\n\n**SMPC 策略的期望成本**：\n应用反馈策略 $u_t(x_t) = L_t x_t + l_t$。对于每个路径 $j$，状态和控制一起演化：\n$$ u_{t,j} = L_t x_{t,j} + l_t $$\n$$ x_{t+1,j} = a x_{t,j} + b u_{t,j} + w_{t,j} $$\n此路径的成本为 $C_j^{\\text{SMPC}} = \\sum_{t=0}^{N-1} (q x_{t,j}^2 + r u_{t,j}^2)$。\n总期望成本是概率加权平均：\n$$ \\mathbb{E}[C^{\\text{SMPC}}] = \\sum_{j} p_j C_j^{\\text{SMPC}} $$\n作为验证，该值必须等于通过 SDP 解计算出的最优成本 $V_0(x_0)$。\n\n最终输出是差值 $\\mathbb{E}[C^{\\text{CE}}] - \\mathbb{E}[C^{\\text{SMPC}}]$，它代表了随机解的价值 (Value of the Stochastic Solution, VSS)。该值非负，量化了使用适应扰动的反馈策略相对于固定开环计划的好处。",
            "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the calculation of expected costs for both SMPC and CE-MPC policies\n    and prints the difference as required.\n    \"\"\"\n    test_cases = [\n        # a, b, q, r, N, x0, w_values, w_probs\n        (1.0, 1.0, 1.0, 0.1, 3, 2.0, [-1.0, 0.0, 1.0], [0.2, 0.6, 0.2]),\n        (1.0, 1.0, 1.0, 5.0, 3, 2.0, [-1.0, 0.0, 1.0], [0.2, 0.6, 0.2]),\n        (1.0, 1.0, 1.0, 0.1, 3, 2.0, [0.0], [1.0]),\n        (1.2, 1.0, 1.0, 0.1, 3, 2.0, [-1.0, 0.0, 1.0], [0.2, 0.6, 0.2]),\n    ]\n\n    results = []\n    for params in test_cases:\n        cost_ce = calculate_ce_mpc_cost(*params)\n        cost_smpc = calculate_smpc_cost(*params)\n        results.append(cost_ce - cost_smpc)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_smpc_cost(a, b, q, r, N, x0, w_values, w_probs):\n    \"\"\"\n    Calculates the optimal expected cost for the Scenario-based MPC policy.\n\n    This function first solves the stochastic dynamic programming problem backward in time\n    to find the optimal state-feedback policy (L_t, l_t). It then evaluates the expected cost\n    of this policy by enumerating all possible disturbance paths and averaging the path costs.\n    \"\"\"\n    w_values = np.array(w_values)\n    w_probs = np.array(w_probs)\n    \n    w_mean = np.sum(w_values * w_probs)\n    w_mean_sq = np.sum(w_values**2 * w_probs)\n\n    # Backward pass: Stochastic Dynamic Programming\n    P, S, K = np.zeros(N + 1), np.zeros(N + 1), np.zeros(N + 1)\n    L, l = np.zeros(N), np.zeros(N)\n\n    for t in range(N - 1, -1, -1):\n        denom = r + b**2 * P[t+1]\n        \n        L[t] = - (a * b * P[t+1]) / denom\n        l[t] = - (b * (P[t+1] * w_mean + S[t+1] / 2.0)) / denom\n        \n        A_t = a + b * L[t]\n        B_t = b * l[t]\n\n        P[t] = q + r * L[t]**2 + P[t+1] * A_t**2\n        S[t] = 2 * r * L[t] * l[t] + 2 * P[t+1] * A_t * (B_t + w_mean) + S[t+1] * A_t\n        K[t] = r * l[t]**2 + P[t+1] * (B_t**2 + 2 * B_t * w_mean + w_mean_sq) + S[t+1] * (B_t + w_mean) + K[t+1]\n        \n    # Forward pass: Evaluate cost by path enumeration\n    dist_scenarios = list(itertools.product(zip(w_values, w_probs), repeat=N))\n    \n    total_expected_cost = 0.0\n    for scenario in dist_scenarios:\n        path_w = [item[0] for item in scenario]\n        path_p = np.prod([item[1] for item in scenario])\n        \n        path_cost = 0.0\n        x = x0\n        for t in range(N):\n            u = L[t] * x + l[t]\n            path_cost += q * x**2 + r * u**2\n            x = a * x + b * u + path_w[t]\n            \n        total_expected_cost += path_p * path_cost\n        \n    return total_expected_cost\n\n\ndef calculate_ce_mpc_cost(a, b, q, r, N, x0, w_values, w_probs):\n    \"\"\"\n    Calculates the expected cost for the Certainty-Equivalent MPC policy.\n\n    First, it computes the optimal open-loop control sequence {u_t} by solving a\n    deterministic DP problem where the disturbance is fixed at its mean value.\n    Then, it evaluates the expected cost of applying this fixed control sequence\n    to the true stochastic system by enumerating all disturbance paths.\n    \"\"\"\n    w_values = np.array(w_values)\n    w_probs = np.array(w_probs)\n    \n    w_mean = np.sum(w_values * w_probs)\n\n    # Backward pass: Deterministic Dynamic Programming\n    P_ce, S_ce, K_ce = np.zeros(N + 1), np.zeros(N + 1), np.zeros(N + 1)\n    L_ce, l_ce = np.zeros(N), np.zeros(N)\n\n    for t in range(N - 1, -1, -1):\n        denom = r + b**2 * P_ce[t+1]\n        \n        L_ce[t] = - (a * b * P_ce[t+1]) / denom\n        l_ce[t] = - (b * (P_ce[t+1] * w_mean + S_ce[t+1] / 2.0)) / denom\n        \n        A_t_ce = a + b * L_ce[t]\n        B_t_ce = b * l_ce[t]\n        \n        P_ce[t] = q + r * L_ce[t]**2 + P_ce[t+1] * A_t_ce**2\n        S_ce[t] = 2 * r * L_ce[t] * l_ce[t] + 2 * P_ce[t+1] * A_t_ce * (B_t_ce + w_mean) + S_ce[t+1] * A_t_ce\n        K_ce[t] = r * l_ce[t]**2 + P_ce[t+1] * (B_t_ce + w_mean)**2 + S_ce[t+1] * (B_t_ce + w_mean) + K_ce[t+1]\n    \n    # Generate open-loop control sequence\n    u_ce_seq = np.zeros(N)\n    x_det = x0\n    for t in range(N):\n        u_ce_seq[t] = L_ce[t] * x_det + l_ce[t]\n        x_det = a * x_det + b * u_ce_seq[t] + w_mean\n\n    # Forward pass: Evaluate cost by path enumeration\n    dist_scenarios = list(itertools.product(zip(w_values, w_probs), repeat=N))\n    \n    total_expected_cost = 0.0\n    for scenario in dist_scenarios:\n        path_w = [item[0] for item in scenario]\n        path_p = np.prod([item[1] for item in scenario])\n        \n        path_cost = 0.0\n        x = x0\n        for t in range(N):\n            u = u_ce_seq[t]\n            path_cost += q * x**2 + r * u**2\n            x = a * x + b * u + path_w[t]\n            \n        total_expected_cost += path_p * path_cost\n        \n    return total_expected_cost\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}