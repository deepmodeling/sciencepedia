{
    "hands_on_practices": [
        {
            "introduction": "在创建复杂的触觉体验之前，我们必须掌握其基本原理。本练习将探讨渲染虚拟墙壁的基本物理过程。通过运用功能原理，你将分析用户控制的质量块与柔性虚拟表面之间的碰撞动力学，并计算最大穿透深度 $x_{\\max}$ 和峰值接触力 $F_{\\max}$ 等关键参数。这项实践对于理解如何创建稳定且感觉逼真的虚拟接触至关重要。",
            "id": "4225645",
            "problem": "一个人类操作员通过一个接地的触觉接口与一个信息物理系统（CPS）进行交互，该接口的数字孪生（DT）将与虚拟墙的接触建模为一个线性柔性元件。虚拟接触模型由本构关系 $F=K x$ 定义，其中 $F$ 是接触力，$K$ 是刚度，$x$ 是侵入虚拟墙的深度。考虑一个等效末端执行器的集中质量 $M$ 以初速度 $v$ 接近墙壁，并在 $t=0$ 时刻以零初始侵入深度首次接触。假设以下理想化条件：无摩擦法向接触，无阻尼或时间延迟，除建模的柔性外环境为刚性，且触觉控制器被动地呈现虚拟刚度。参数为 $M=0.1\\,\\mathrm{kg}$，$v=0.5\\,\\mathrm{m/s}$ 和 $K=10^{5}\\,\\mathrm{N/m}$。\n\n从 Newton 第二定律和功能原理出发，推导接触过程中质量的运动，并确定此次交互的最大侵入深度 $x_{\\max}$ 和相应的峰值接触力 $F_{\\max}$。将最终数值答案表示为 $x_{\\max}$（单位为米）和 $F_{\\max}$（单位为牛顿），并四舍五入到四位有效数字。以单行矩阵的形式报告你的最终答案，顺序为 $\\left(x_{\\max},\\,F_{\\max}\\right)$。",
            "solution": "首先对问题陈述的科学合理性、完整性和客观性进行验证。\n\n**步骤1：提取已知条件**\n- 虚拟墙的本构关系：$F = Kx$\n- $F$：接触力\n- $K$：刚度，给定为 $K=10^{5}\\,\\mathrm{N/m}$\n- $x$：侵入深度\n- $M$：等效末端执行器质量，给定为 $M=0.1\\,\\mathrm{kg}$\n- $v$：质量首次接触时的初速度，给定为 $v=0.5\\,\\mathrm{m/s}$\n- $t=0$ 时的初始条件：$x(0) = 0$（零初始侵入），$\\dot{x}(0) = v$（初速度）\n- 理想化条件：无摩擦法向接触，无阻尼，无时间延迟，除建模的柔性外环境为刚性，被动触觉控制器。\n- 目标：推导运动过程，求出最大侵入深度 $x_{\\max}$ 和峰值接触力 $F_{\\max}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于经典力学的基本原理，特别是应用于简谐振子的 Newton 第二定律和功能原理。模型 $F=Kx$ 是 Hooke 定律。这是物理学和工程学中对柔性接触的标准且有效的表示。\n- **适定性：** 该问题是一个二阶线性常微分方程的适定初值问题。所有必要的参数（$M$，$K$，$v$）和初始条件（$x(0)$，$\\dot{x}(0)$）均已提供，确保存在唯一解。\n- **客观性：** 问题以精确、客观的语言和公认的科学术语表述。\n- **完整性与一致性：** 问题是自洽的。所提供的数据相互一致，并足以找到解决方案。理想化条件被明确说明，并用于定义物理模型的边界。\n- **真实性：** 质量、速度和刚度的数值对于触觉交互场景是物理上合理的。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它是科学合理的、适定的和完整的。将推导求解。\n\n**运动方程的推导**\n该相互作用被建模为一个质量块对抗线性弹簧的运动。在接触期间，作用在质量 $M$ 上的唯一力是来自虚拟墙的恢复力，该力与侵入方向相反。根据 Newton 第二定律，合力等于质量乘以加速度，$F_{net} = Ma$。加速度是侵入深度的二阶时间导数，$a = \\ddot{x}$。恢复力为 $F = -Kx$。\n\n因此，运动方程为：\n$$M\\ddot{x} = -Kx$$\n整理后得到简谐振子方程的标准形式：\n$$M\\ddot{x} + Kx = 0$$\n两边同除以 $M$，我们得到：\n$$\\ddot{x} + \\frac{K}{M}x = 0$$\n这通常写成 $\\ddot{x} + \\omega^2 x = 0$ 的形式，其中 $\\omega$ 是系统的固有角频率，定义为：\n$$\\omega = \\sqrt{\\frac{K}{M}}$$\n该微分方程的通解形式为 $x(t) = A \\cos(\\omega t) + B \\sin(\\omega t)$。为了求得特解，我们应用初始条件。\n在 $t=0$ 时，侵入深度为零：$x(0)=0$。\n$$x(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A$$\n因此，$A=0$。解简化为 $x(t) = B \\sin(\\omega t)$。\n\n接下来，我们使用初速度条件。速度是位置的一阶时间导数：$\\dot{x}(t) = B \\omega \\cos(\\omega t)$。\n在 $t=0$ 时，速度为 $v$：$\\dot{x}(0)=v$。\n$$\\dot{x}(0) = B \\omega \\cos(0) = B \\omega \\cdot 1 = B \\omega$$\n因此，$B \\omega = v$，得到 $B = \\frac{v}{\\omega}$。\n将 $B$ 代回到 $x(t)$ 的解中，接触过程中质量的运动由以下方程描述：\n$$x(t) = \\frac{v}{\\omega} \\sin(\\omega t)$$\n\n**最大侵入深度与峰值力的确定**\n问题要求使用功能原理。该原理提供了一条直接求出最大侵入深度 $x_{\\max}$ 的路径，而无需解出完整的随时间变化的运动过程。功能定理指出，对物体所做的功等于其动能的变化量。在这个保守系统（无摩擦、无阻尼）中，这等同于机械能守恒原理。\n\n在 $t=0$ 时（接触瞬间）的总初始能量：\n动能为 $E_{k,i} = \\frac{1}{2}Mv^2$。\n储存在虚拟弹簧中的势能为 $E_{p,i} = \\frac{1}{2}Kx(0)^2 = \\frac{1}{2}K(0)^2 = 0$。\n所以，总初始能量为 $E_{total} = E_{k,i} + E_{p,i} = \\frac{1}{2}Mv^2$。\n\n在最大侵入深度 $x_{\\max}$ 处的总末态能量：\n在最大侵入点，质量在反向运动前瞬间静止。因此，其速度为 $0$，末态动能为 $E_{k,f} = 0$。\n所有的初始动能都已转化为储存在虚拟弹簧中的势能：$E_{p,f} = \\frac{1}{2}Kx_{\\max}^2$。\n总末态能量为 $E_{total} = E_{k,f} + E_{p,f} = \\frac{1}{2}Kx_{\\max}^2$。\n\n根据能量守恒原理：\n$$E_{initial} = E_{final}$$\n$$\\frac{1}{2}Mv^2 = \\frac{1}{2}Kx_{\\max}^2$$\n求解 $x_{\\max}$：\n$$Mv^2 = Kx_{\\max}^2$$\n$$x_{\\max}^2 = \\frac{Mv^2}{K}$$\n$$x_{\\max} = \\sqrt{\\frac{Mv^2}{K}} = v\\sqrt{\\frac{M}{K}}$$\n\n根据本构关系 $F=Kx$，峰值接触力 $F_{\\max}$ 出现在最大侵入深度 $x_{\\max}$ 处。\n$$F_{\\max} = Kx_{\\max}$$\n代入 $x_{\\max}$ 的表达式：\n$$F_{\\max} = K \\left( v\\sqrt{\\frac{M}{K}} \\right) = v\\sqrt{K^2 \\frac{M}{K}} = v\\sqrt{MK}$$\n\n**数值计算**\n给定的参数是：\n- $M = 0.1\\,\\mathrm{kg}$\n- $v = 0.5\\,\\mathrm{m/s}$\n- $K = 10^{5}\\,\\mathrm{N/m}$\n\n首先，我们计算最大侵入深度 $x_{\\max}$：\n$$x_{\\max} = (0.5\\,\\mathrm{m/s}) \\sqrt{\\frac{0.1\\,\\mathrm{kg}}{10^{5}\\,\\mathrm{N/m}}} = 0.5 \\sqrt{\\frac{10^{-1}}{10^5}} = 0.5 \\sqrt{10^{-6}}\\,\\mathrm{m}$$\n$$x_{\\max} = 0.5 \\times 10^{-3}\\,\\mathrm{m} = 0.0005\\,\\mathrm{m}$$\n四舍五入到四位有效数字，结果为 $5.000 \\times 10^{-4}\\,\\mathrm{m}$。\n\n接下来，我们计算峰值接触力 $F_{\\max}$：\n$$F_{\\max} = Kx_{\\max} = (10^{5}\\,\\mathrm{N/m})(0.0005\\,\\mathrm{m})$$\n$$F_{\\max} = 10^5 \\times 5 \\times 10^{-4}\\,\\mathrm{N} = 5 \\times 10^1\\,\\mathrm{N} = 50\\,\\mathrm{N}$$\n四舍五入到四位有效数字，结果为 $50.00\\,\\mathrm{N}$。\n\n最终答案是 $x_{\\max} = 5.000 \\times 10^{-4}\\,\\mathrm{m}$ 和 $F_{\\max} = 50.00\\,\\mathrm{N}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.000 \\times 10^{-4}  50.00 \\end{pmatrix}}$$"
        },
        {
            "introduction": "信息物理系统中的触觉渲染是一个数字过程，这可能会引入连续物理世界中不存在的伪影。本问题将探讨混叠（aliasing）这一关键问题，即由于采样率不足，高频信号被错误地感知。你将确定一个违反奈奎斯特-香农采样定理的振动触觉信号的感知频率 $f_{\\mathrm{alias}}$，从而将信号处理的核心概念与其对人类感官知觉的影响直接联系起来。",
            "id": "4225609",
            "problem": "一个带数字孪生渲染管线的人在环信息物理系统 (CPS) 使用采样指令驱动一个振动触觉执行器。该执行器被指令产生一个频率为 $f_{0}$ 的连续时间正弦振动，该振动以速率 $f_{s}$ 被采样，并由一个标准的零阶保持器以相同速率再现。在没有抗混叠滤波和理想采样的情况下，由于采样相位的 $2\\pi$ 周期性，采样正弦波的感知相关分量可以被其在基带 $[0, f_{s}/2]$ 内的混叠的离散时间等效项来表征。\n\n考虑 $f_{0} = 600\\,\\mathrm{Hz}$ 和 $f_{s} = 1\\,\\mathrm{kHz}$。从正弦采样的定义出发，\n$$x(t) = A \\cos(2\\pi f_{0} t), \\quad x[n] = x\\!\\left(\\frac{n}{f_{s}}\\right) = A \\cos\\!\\left(2\\pi \\frac{f_{0}}{f_{s}} n\\right),$$\n确定当执行器由采样信号驱动时，人会感知到的混叠基带频率 $f_{\\mathrm{alias}} \\in [0, f_{s}/2]$。\n\n对于人类机械感受器通道的分类，请使用以下公认的指尖无毛皮肤的振动触觉敏感频带：\n- 快速适应1型 (RA1) 通道：$5\\,\\mathrm{Hz} \\leq f \\leq 40\\,\\mathrm{Hz}$，\n- 帕西尼小体 (PC) 通道：$50\\,\\mathrm{Hz} \\leq f \\leq 800\\,\\mathrm{Hz}$。\n如果 $f$ 位于两个频带之外，则视为“两者都不是”。\n\n将您的最终答案以一个包含两个条目的行矩阵形式报告：\n1. 混叠频率 $f_{\\mathrm{alias}}$，单位为 $\\mathrm{Hz}$，以及\n2. 一个通道代码，定义为 RA1 为 $1$，PC 为 $2$，两者都不是为 $0$。\n\n以 $\\mathrm{Hz}$ 表示混叠频率。无需四舍五入。",
            "solution": "问题要求确定采样正弦信号的感知混叠频率，并将其分类到人类机械感受器通道中。这是一个信号采样和混叠问题，受奈奎斯特-香农采样定理的约束。\n\n问题从连续时间正弦信号 $x(t)$ 及其采样对应信号 $x[n]$ 的定义开始：\n$$x(t) = A \\cos(2\\pi f_{0} t)$$\n$$x[n] = x\\left(\\frac{n}{f_{s}}\\right) = A \\cos\\left(2\\pi \\frac{f_{0}}{f_{s}} n\\right)$$\n其中 $f_0$ 是原始信号频率，$f_s$ 是采样频率。采样信号的表达式可以用离散时间角频率 $\\Omega_0$ 表示为：\n$$x[n] = A \\cos(\\Omega_0 n), \\quad \\text{其中} \\quad \\Omega_0 = 2\\pi \\frac{f_0}{f_s}$$\n问题指出，感知相关频率 $f_{\\mathrm{alias}}$ 是 $f_0$ 在基带 $[0, f_s/2]$ 内的离散时间等效项。物理频率域中的这个基带对应于 $[0, \\pi]$ 的离散时间角频率范围。\n\n首先，我们使用给定值 $f_0 = 600\\,\\mathrm{Hz}$ 和 $f_s = 1\\,\\mathrm{kHz} = 1000\\,\\mathrm{Hz}$ 计算离散时间角频率 $\\Omega_0$。\n$$\\Omega_0 = 2\\pi \\frac{600}{1000} = 2\\pi (0.6) = 1.2\\pi \\text{ 弧度/样本}$$\n奈奎斯特频率为 $f_s/2 = 1000/2 = 500\\,\\mathrm{Hz}$。由于 $f_0 = 600\\,\\mathrm{Hz}$ 大于奈奎斯特频率，将会发生混叠。\n\n在离散时间系统中，由于复指数基函数（或正弦函数）的周期性，频率仅在长度为 $2\\pi$ 的区间内是唯一的。如果对于任何整数 $k$，有 $\\Omega_1 = \\Omega_2 + 2\\pi k$，则任何两个角频率 $\\Omega_1$ 和 $\\Omega_2$ 都被认为是等效的。主混叠的标准区间是 $(-\\pi, \\pi]$。此外，对于实值信号，余弦函数是偶函数，意味着 $\\cos(\\theta) = \\cos(-\\theta)$。因此，负频率 $-\\Omega$ 与其对应的正频率 $\\Omega$ 是无法区分的。这就是为什么感知基带被指定为 $[0, f_s/2]$，它对应于离散时间角频率范围 $[0, \\pi]$。\n\n我们计算出的频率 $\\Omega_0 = 1.2\\pi$ 位于主混叠范围 $(-\\pi, \\pi]$ 之外。我们通过减去 $2\\pi$ 的整数倍来找到此范围内的等效频率。对于 $k=1$：\n$$\\Omega' = \\Omega_0 - 2\\pi \\cdot 1 = 1.2\\pi - 2\\pi = -0.8\\pi$$\n因此，采样信号与具有这个新频率的信号是无法区分的：\n$$x[n] = A \\cos(1.2\\pi n) = A \\cos(-0.8\\pi n)$$\n利用余弦函数的偶函数性质：\n$$\\cos(-0.8\\pi n) = \\cos(0.8\\pi n)$$\n得到的等效正角频率是 $\\Omega_{\\mathrm{alias}} = 0.8\\pi$。这个值位于所期望的范围 $[0, \\pi]$ 内。\n\n为了以赫兹为单位找到物理频率 $f_{\\mathrm{alias}}$，我们将 $\\Omega_{\\mathrm{alias}}$ 从离散时间域转换回来：\n$$f_{\\mathrm{alias}} = \\frac{\\Omega_{\\mathrm{alias}}}{2\\pi} f_s$$\n代入数值：\n$$f_{\\mathrm{alias}} = \\frac{0.8\\pi}{2\\pi} \\cdot 1000\\,\\mathrm{Hz} = 0.4 \\cdot 1000\\,\\mathrm{Hz} = 400\\,\\mathrm{Hz}$$\n人类将感知到的混叠频率是 $400\\,\\mathrm{Hz}$。\n\n任务的第二部分是将此频率分类到所提供的人类机械感受器通道之一。敏感频带是：\n- 快速适应1型 (RA1) 通道：$5\\,\\mathrm{Hz} \\leq f \\leq 40\\,\\mathrm{Hz}$\n- 帕西尼小体 (PC) 通道：$50\\,\\mathrm{Hz} \\leq f \\leq 800\\,\\mathrm{Hz}$\n\n我们将我们的结果 $f_{\\mathrm{alias}} = 400\\,\\mathrm{Hz}$ 与这些频带进行比较。\n- 对于RA1通道：$5 \\leq 400 \\leq 40$ 是假的。\n- 对于PC通道：$50 \\leq 400 \\leq 800$ 是真的。\n\n频率 $f_{\\mathrm{alias}} = 400\\,\\mathrm{Hz}$ 落在PC通道的敏感频带内。问题将通道代码定义为 RA1 为 $1$，PC 为 $2$，两者都不是为 $0$。因此，此频率的通道代码为 $2$。\n\n最终答案是一个包含混叠频率 $f_{\\mathrm{alias}}$ 和通道代码的行矩阵。这给出了两个条目为 $400$ 和 $2$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 400  2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个真正智能的数字孪生应该能够学习并适应其对物理世界的模型。本练习让你扮演系统设计者的角色，任务是从带噪声的传感器数据中识别未知环境的刚度估计值 $\\hat{K}$。通过实现一个最小二乘估计算法，你将构建一个用于数据驱动建模的实用工具，这是为触觉交互创建精确且响应迅速的数字孪生的基石。",
            "id": "4225627",
            "problem": "一个人类操作员在数字孪生中与一个支持触觉反馈的信息物理系统 (CPS) 的虚拟代理进行交互。接触环境可以很好地用一个线性弹性模型来近似，其中接触力与侵入位移成正比。其基本原理是胡克定律，即弹性力与位移成正比：$$F = K x,$$ 其中 $F$ 是力（单位：牛顿），$x$ 是位移（单位：米），$K$ 是刚度（单位：牛顿/米）。假设一个带有加性零均值噪声的测量模型：$$F_k = K x_k + \\epsilon_k,$$ 对于由 $k$ 索引的样本，其中 $\\epsilon_k$ 是独立的测量扰动，且 $\\mathbb{E}[\\epsilon_k] = 0$。您必须使用最小二乘法 (LS) 构建一个参数辨识程序，从测量的样本对 $(x_k, F_k)$ 中估计环境刚度 $K$，生成一个估计值 $\\hat{K}$，该估计值能够最小化测量力与预测力之间的残差平方和。您的推导和算法必须仅基于所述的基本原理和测量模型。然后，您的程序必须为所提供的测试套件中的每个数据集计算 $\\hat{K}$。\n\n物理单位和数值要求：\n- 以牛顿/米 (N/m) 为单位报告 $\\hat{K}$，四舍五入到 $3$ 位小数。\n- 不涉及角度，无需指定。\n- 最终输出必须是一行，包含一个用方括号括起来的逗号分隔列表（例如，$[k_1,k_2,k_3]$），其中每个 $k_i$ 是一个浮点数。\n\n测试套件（每个数据集包含 $5$ 个样本对 $(x_k, F_k)$，其中 $x_k$ 的单位是米，$F_k$ 的单位是牛顿）：\n- 数据集 $1$（具有中等测量噪声的典型交互）：\n  - $x$: $[0.005, 0.010, 0.015, 0.020, 0.025]$\n  - $F$: $[7.7, 15.3, 22.3, 29.8, 38.1]$\n- 数据集 $2$（包含零样本的混合符号位移）：\n  - $x$: $[0.000, -0.020, 0.020, -0.010, 0.010]$\n  - $F$: $[0.2, -39.8, 40.4, -19.7, 19.9]$\n- 数据集 $3$（具有一致比例性的近零位移）：\n  - $x$: $[0.000001, -0.000002, 0.000003, -0.000004, 0.000005]$\n  - $F$: $[0.1, -0.2, 0.3, -0.4, 0.5]$\n- 数据集 $4$（对数值加权构成考验的离群值主导样本）：\n  - $x$: $[0.010, 0.020, 0.030, 0.040, 0.500]$\n  - $F$: $[10.1, 19.6, 28.9, 39.7, 503.0]$\n- 数据集 $5$（导致负刚度的符号反转力测量）：\n  - $x$: $[0.010, 0.020, 0.030, 0.040, 0.050]$\n  - $F$: $[-10.5, -20.1, -29.8, -40.2, -50.3]$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[k_1,k_2,k_3,k_4,k_5]$），其中每个条目是对应数据集的 $\\hat{K}$ 值（单位：N/m），四舍五入到 $3$ 位小数。不应打印任何额外文本。",
            "solution": "已根据所需的验证标准对用户提供的问题陈述进行了评估。\n\n### 步骤 1：提取已知条件\n- **基本原理**：胡克定律，$F = K x$，其中 $F$ 是力（牛顿），$x$ 是位移（米），$K$ 是刚度（牛顿/米）。\n- **测量模型**：$F_k = K x_k + \\epsilon_k$，其中 $k$ 是样本索引，$F_k$ 是测量力，$x_k$ 是测量位移，$\\epsilon_k$ 是一个零均值的独立测量扰动，$\\mathbb{E}[\\epsilon_k] = 0$。\n- **目标**：使用最小二乘法 (LS) 构建一个参数辨识程序来估计刚度 $K$，得出一个能最小化残差平方和的估计值 $\\hat{K}$。\n- **输出要求**：以 N/m 为单位报告 $\\hat{K}$，四舍五入到 $3$ 位小数，并以方括号内的逗号分隔列表形式呈现。\n- **测试套件**：\n  - 数据集 $1$：\n    - $x = [0.005, 0.010, 0.015, 0.020, 0.025]$\n    - $F = [7.7, 15.3, 22.3, 29.8, 38.1]$\n  - 数据集 $2$：\n    - $x = [0.000, -0.020, 0.020, -0.010, 0.010]$\n    - $F = [0.2, -39.8, 40.4, -19.7, 19.9]$\n  - 数据集 $3$：\n    - $x = [0.000001, -0.000002, 0.000003, -0.000004, 0.000005]$\n    - $F = [0.1, -0.2, 0.3, -0.4, 0.5]$\n  - 数据集 $4$：\n    - $x = [0.010, 0.020, 0.030, 0.040, 0.500]$\n    - $F = [10.1, 19.6, 28.9, 39.7, 503.0]$\n  - 数据集 $5$：\n    - $x = [0.010, 0.020, 0.030, 0.040, 0.050]$\n    - $F = [-10.5, -20.1, -29.8, -40.2, -50.3]$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于线性弹性的基本原理——胡克定律，以及统计估计和系统辨识中的标准基础技术——最小二乘法。这些是物理学和工程学的基石。该问题在科学上是合理的。\n- **适定性**：该问题要求通过最小化一个明确定义的代价函数，从一组数据点中估计单个参数 $K$。这是一个经典的（过原点的）线性回归问题。只要并非所有的 $x_k$ 值都为零，$\\hat{K}$ 的唯一解就存在，而测试套件中的每个数据集都满足这个条件。\n- **客观性**：该问题以精确的数学术语陈述，没有歧义、主观看法或意见。\n- **结论**：该问题不违反任何无效性标准。它具有科学依据、适定性、客观性、自包含性且可形式化。\n\n### 步骤 3：判定与行动\n问题是有效的。将推导并实现一个解决方案。\n\n### 刚度的最小二乘估计器推导\n目标是找到刚度估计值 $\\hat{K}$，以最小化测量力 $F_k$ 与模型预测力 $\\hat{F}_k = \\hat{K} x_k$ 之间的残差平方和。我们将代价函数 $J(\\hat{K})$ 定义为 $N$ 个数据样本的残差平方和：\n$$J(\\hat{K}) = \\sum_{k=1}^{N} (F_k - \\hat{F}_k)^2 = \\sum_{k=1}^{N} (F_k - \\hat{K} x_k)^2$$\n\n为了找到该函数的最小值，我们必须计算它关于 $\\hat{K}$ 的导数，并将结果设为零。这是求极值的必要条件。\n$$\\frac{dJ}{d\\hat{K}} = \\frac{d}{d\\hat{K}} \\left[ \\sum_{k=1}^{N} (F_k - \\hat{K} x_k)^2 \\right]$$\n\n对和中的每一项应用链式求导法则：\n$$\\frac{dJ}{d\\hat{K}} = \\sum_{k=1}^{N} 2(F_k - \\hat{K} x_k) \\cdot \\frac{d}{d\\hat{K}}(F_k - \\hat{K} x_k)$$\n$$\\frac{dJ}{d\\hat{K}} = \\sum_{k=1}^{N} 2(F_k - \\hat{K} x_k) \\cdot (-x_k)$$\n$$\\frac{dJ}{d\\hat{K}} = -2 \\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2)$$\n\n将导数设为零，以找到最小化 $J$ 的 $\\hat{K}$ 值：\n$$-2 \\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2) = 0$$\n$$\\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2) = 0$$\n\n我们可以将和式分开：\n$$\\sum_{k=1}^{N} F_k x_k - \\sum_{k=1}^{N} \\hat{K} x_k^2 = 0$$\n\n由于 $\\hat{K}$ 相对于求和索引 $k$ 是一个常数，可以将其从第二个和式中提取出来：\n$$\\sum_{k=1}^{N} F_k x_k - \\hat{K} \\sum_{k=1}^{N} x_k^2 = 0$$\n\n求解 $\\hat{K}$：\n$$\\hat{K} \\sum_{k=1}^{N} x_k^2 = \\sum_{k=1}^{N} F_k x_k$$\n这就得出了刚度的最小二乘估计的最终表达式：\n$$\\hat{K} = \\frac{\\sum_{k=1}^{N} F_k x_k}{\\sum_{k=1}^{N} x_k^2}$$\n\n这个公式是稳健的，并且可以直接实现。对于给定的模型，它代表了最小二乘意义下的最优线性估计器。其二阶导数 $\\frac{d^2J}{d\\hat{K}^2} = 2 \\sum_{k=1}^{N} x_k^2$，只要至少有一个 $x_k$ 非零，它就是正的，这证实了该解对应于一个最小值。\n\n实现过程将把这个公式应用于测试套件中提供的每个数据集。在数值计算中，分子是力向量和位移向量的点积，分母是位移向量与自身的点积。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stiffness K for multiple datasets using the Least Squares method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset 1\n        (np.array([0.005, 0.010, 0.015, 0.020, 0.025]), \n         np.array([7.7, 15.3, 22.3, 29.8, 38.1])),\n        # Dataset 2\n        (np.array([0.000, -0.020, 0.020, -0.010, 0.010]),\n         np.array([0.2, -39.8, 40.4, -19.7, 19.9])),\n        # Dataset 3\n        (np.array([0.000001, -0.000002, 0.000003, -0.000004, 0.000005]),\n         np.array([0.1, -0.2, 0.3, -0.4, 0.5])),\n        # Dataset 4\n        (np.array([0.010, 0.020, 0.030, 0.040, 0.500]),\n         np.array([10.1, 19.6, 28.9, 39.7, 503.0])),\n        # Dataset 5\n        (np.array([0.010, 0.020, 0.030, 0.040, 0.050]),\n         np.array([-10.5, -20.1, -29.8, -40.2, -50.3]))\n    ]\n\n    results = []\n    \n    def estimate_stiffness(x_samples, f_samples):\n        \"\"\"\n        Calculates the stiffness estimate K-hat using the derived LS formula.\n        K_hat = sum(F_k * x_k) / sum(x_k^2)\n        \n        Args:\n            x_samples (np.ndarray): Array of displacement measurements.\n            f_samples (np.ndarray): Array of force measurements.\n        \n        Returns:\n            float: The estimated stiffness K_hat.\n        \"\"\"\n        # The numerator of the LS formula is the dot product of F and x.\n        sum_fx = np.dot(f_samples, x_samples)\n        \n        # The denominator is the dot product of x with itself.\n        sum_x_squared = np.dot(x_samples, x_samples)\n        \n        # Avoid division by zero, although problem constraints ensure this won't happen.\n        if sum_x_squared == 0:\n            return 0.0\n\n        k_hat = sum_fx / sum_x_squared\n        return k_hat\n\n    for x_data, f_data in test_cases:\n        # Calculate the stiffness for the current dataset.\n        k_estimate = estimate_stiffness(x_data, f_data)\n        \n        # Round the result to 3 decimal places as required.\n        # The format string ensures correct representation of numbers like 2000.0\n        rounded_k = round(k_estimate, 3)\n        results.append(f\"{rounded_k:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}