{
    "hands_on_practices": [
        {
            "introduction": "高保真数字孪生异常检测的基础是精确的系统物理数学模型。尽管许多现实世界系统本质上是非线性的，但强大的分析和检测算法（如卡尔曼滤波器）通常是为线性系统设计的。本练习 () 将引导您完成线性化这一关键的工程过程。通过处理一个直流电机的非线性模型，您将推导出其线性小信号等效模型，从而获得生成和分析残差所需的基本状态空间矩阵。",
            "id": "4215454",
            "problem": "一个由直流（DC）电机组成的网络物理系统（CPS）由一个基于模型的数字孪生进行监控。物理电机的动态特性包括粘性摩擦、弱三次摩擦、反电动势和负载转矩。标称连续时间非线性状态空间模型使用状态向量 $x = [\\omega\\ i]^{\\top}$、控制输入 $u$ 和输出 $y$，其中\n$$\n\\dot{\\omega} = \\frac{1}{J}\\left(K_{t} i - B \\omega - B_{\\text{nl}} \\omega^{3} - \\tau_{\\text{load}}\\right), \\quad\n\\dot{i} = \\frac{1}{L}\\left(u - R i - K_{e} \\omega\\right), \\quad\ny = \\omega,\n$$\n$\\omega$ 是角速度，$i$ 是电枢电流。数字孪生使用相同的标称模型和相同的指令输入 $u$ 来产生预测输出 $\\hat{y}$。异常被建模为仅作用于物理对象的负载转矩中的一个小的加性扰动 $d(t)$，因此物理对象的负载转矩变为 $\\tau_{\\text{load}} + d(t)$，而数字孪生使用标称的 $\\tau_{\\text{load}}$。\n\n参数为 $J = 0.01$、$B = 0.005$、$B_{\\text{nl}} = 1 \\times 10^{-7}$、$L = 0.05$、$R = 1$、$K_{t} = 0.5$ 和 $K_{e} = 0.5$。标称工作点由稳态值 $\\omega_{0} = 100$、$i_{0} = 1.6$、$u_{0} = 51.6$ 和 $\\tau_{\\text{load},0} = 0.2$ 表征，这些值满足标称模型的平衡条件。残差 $r(t)$ 定义为测量输出与预测输出之差 $r(t) = y(t) - \\hat{y}(t)$。\n\n从平衡点和一阶泰勒展开（雅可比线性化）在工作点 $(\\omega_{0}, i_{0}, u_{0})$ 附近的定义出发，执行以下操作：\n\n1. 推导物理对象和数字孪生在工作点 $(\\omega_{0}, i_{0}, u_{0})$ 附近的线性化小信号模型，并确定标称模型的矩阵 $A$、$B$ 和 $C$，以及从异常输入 $d(t)$ 到状态动态的扰动通道 $E$。\n2. 使用线性化模型，推导小异常的残差生成器动态，即当物理对象和数字孪生在工作点具有相同的初始条件并共享相同的指令输入 $u(t)$ 时，由 $d(t)$ 驱动的残差 $r(t)$ 的线性化动态。\n3. 对于一个恒定的阶跃异常 $d(t) = d_{0}$，其中 $d_{0} = 0.02$（单位为转矩），计算由线性化动态所蕴含的稳态残差值 $r_{\\text{ss}}$。以弧度每秒为单位表示最终数值答案，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先验证问题以确保其科学性、适定性和客观性。所提供的模型是直流电机的标准表示，参数在物理上是合理的。该任务涉及控制理论中的标准技术：线性化和残差分析。我们首先通过将时间导数设置为零来验证给定的工作点 $(\\omega_{0}, i_{0}, u_{0}, \\tau_{\\text{load},0}) = (100, 1.6, 51.6, 0.2)$ 是标称模型的一个平衡点：\n对于 $\\dot{\\omega} = 0$：\n$$K_{t} i_{0} - B \\omega_{0} - B_{\\text{nl}} \\omega_{0}^{3} - \\tau_{\\text{load},0} = (0.5)(1.6) - (0.005)(100) - (1 \\times 10^{-7})(100)^{3} - 0.2$$\n$$= 0.8 - 0.5 - (10^{-7})(10^{6}) - 0.2 = 0.8 - 0.5 - 0.1 - 0.2 = 0$$\n对于 $\\dot{i} = 0$：\n$$u_{0} - R i_{0} - K_{e} \\omega_{0} = 51.6 - (1)(1.6) - (0.5)(100) = 51.6 - 1.6 - 50 = 0$$\n平衡条件得到满足。问题有效，我们可以继续进行解答。\n\n非线性状态空间模型可以写成 $\\dot{x} = f(x, u)$ 的形式，其中 $x = [\\omega\\ i]^{\\top}$。\n$f(x, u) = \\begin{pmatrix} f_1 \\\\ f_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{J}\\left(K_{t} i - B \\omega - B_{\\text{nl}} \\omega^{3} - \\tau_{\\text{load}}\\right) \\\\ \\frac{1}{L}\\left(u - R i - K_{e} \\omega\\right) \\end{pmatrix}$。\n输出为 $y = h(x) = \\omega$。\n\n**1. 线性化模型的推导**\n\n系统在工作点 $(x_0, u_0)$ 附近进行线性化，其中 $x_0 = [\\omega_0 \\ i_0]^{\\top} = [100 \\ 1.6]^{\\top}$ 且 $u_0 = 51.6$。线性化模型由 $\\delta\\dot{x} = A \\delta x + B \\delta u$ 给出，其中 $\\delta x = x - x_0$ 且 $\\delta u = u - u_0$。矩阵 $A$ 和 $B$ 是 $f$ 关于 $x$ 和 $u$ 的雅可比矩阵，在工作点处求值。\n\n雅可比矩阵 $A$ 是：\n$$A = \\frac{\\partial f}{\\partial x}\\bigg|_{x_0, u_0} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial \\omega} & \\frac{\\partial f_1}{\\partial i} \\\\ \\frac{\\partial f_2}{\\partial \\omega} & \\frac{\\partial f_2}{\\partial i} \\end{pmatrix}_{x_0, u_0}$$\n偏导数为：\n$\\frac{\\partial f_1}{\\partial \\omega} = \\frac{1}{J}(-B - 3B_{\\text{nl}}\\omega^2)$。在 $\\omega_0=100$ 处求值：\n$\\frac{\\partial f_1}{\\partial \\omega}\\bigg|_{\\omega_0} = \\frac{1}{0.01}(-0.005 - 3(1 \\times 10^{-7})(100)^2) = 100(-0.005 - 0.003) = -0.8$。\n$\\frac{\\partial f_1}{\\partial i} = \\frac{K_t}{J} = \\frac{0.5}{0.01} = 50$。\n$\\frac{\\partial f_2}{\\partial \\omega} = -\\frac{K_e}{L} = -\\frac{0.5}{0.05} = -10$。\n$\\frac{\\partial f_2}{\\partial i} = -\\frac{R}{L} = -\\frac{1}{0.05} = -20$。\n因此，状态矩阵 $A$ 是：\n$$A = \\begin{pmatrix} -0.8 & 50 \\\\ -10 & -20 \\end{pmatrix}$$\n\n输入矩阵 $B$ 是：\n$$B = \\frac{\\partial f}{\\partial u}\\bigg|_{x_0, u_0} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u} \\\\ \\frac{\\partial f_2}{\\partial u} \\end{pmatrix}_{x_0, u_0} = \\begin{pmatrix} 0 \\\\ \\frac{1}{L} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{0.05} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 20 \\end{pmatrix}$$\n\n输出方程是 $y = \\omega$，它在状态变量中已经是线性的。输出矩阵 $C$ 是：\n$$C = \\frac{\\partial h}{\\partial x}\\bigg|_{x_0} = \\begin{pmatrix} \\frac{\\partial \\omega}{\\partial \\omega} & \\frac{\\partial \\omega}{\\partial i} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$$\n\n异常 $d(t)$ 作为加性负载转矩进入物理对象的动态。物理对象的 $\\dot{\\omega}$ 方程是 $\\dot{\\omega}_{\\text{plant}} = \\frac{1}{J}(K_{t} i - B \\omega - B_{\\text{nl}} \\omega^{3} - \\tau_{\\text{load},0} - d(t))$。扰动通道矩阵 $E$ 将扰动 $d(t)$ 映射到状态动态。\n$$E = \\frac{\\partial f}{\\partial d}\\bigg|_{d=0} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial d} \\\\ \\frac{\\partial f_2}{\\partial d} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{J} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{0.01} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -100 \\\\ 0 \\end{pmatrix}$$\n\n**2. 残差生成器动态的推导**\n\n令 $\\delta x_p(t)$ 为物理对象的小信号状态偏差，$\\delta \\hat{x}(t)$ 为数字孪生的小信号状态偏差。线性化模型为：\n物理对象：$\\delta \\dot{x}_p(t) = A \\delta x_p(t) + B \\delta u(t) + E d(t)$\n孪生体：$\\delta \\dot{\\hat{x}}(t) = A \\delta \\hat{x}(t) + B \\delta u(t)$\n小信号输出为 $\\delta y(t) = C \\delta x_p(t)$ 和 $\\delta \\hat{y}(t) = C \\delta \\hat{x}(t)$。\n\n残差是 $r(t) = y(t) - \\hat{y}(t) = (y_0 + \\delta y(t)) - (\\hat{y}_0 + \\delta\\hat{y}(t))$。由于工作点相同（$y_0 = \\hat{y}_0$），$r(t) = \\delta y(t) - \\delta \\hat{y}(t) = C(\\delta x_p(t) - \\delta \\hat{x}(t))$。\n令状态误差为 $e(t) = \\delta x_p(t) - \\delta \\hat{x}(t)$。状态误差的动态是通过从物理对象的状态方程中减去孪生体的状态方程得到的：\n$$\\dot{e}(t) = \\delta \\dot{x}_p(t) - \\delta \\dot{\\hat{x}}(t) = (A \\delta x_p + B \\delta u + E d) - (A \\delta \\hat{x} + B \\delta u)$$\n$$\\dot{e}(t) = A(\\delta x_p - \\delta \\hat{x}) + (B - B)\\delta u + E d = A e(t) + E d(t)$$\n残差则由 $r(t) = C e(t)$ 给出。\n问题陈述初始条件相同，所以 $e(0) = \\delta x_p(0) - \\delta \\hat{x}(0) = 0$。\n因此，残差生成器是线性时不变系统：\n$$ \\dot{e}(t) = A e(t) + E d(t), \\quad e(0)=0 $$\n$$ r(t) = C e(t) $$\n\n**3. 稳态残差的计算**\n\n对于一个恒定的阶跃异常 $d(t) = d_0 = 0.02$，通过将状态误差的时间导数设为零（$\\dot{e}(t) = 0$）来找到稳态响应，前提是假设系统矩阵 $A$ 是稳定的。矩阵 $A$ 的特征值具有负实部（特征方程为 $\\lambda^2+20.8\\lambda+516=0$），因此系统是稳定的。\n在稳态下，我们有 $0 = A e_{\\text{ss}} + E d_0$。\n求解稳态误差 $e_{\\text{ss}}$：\n$$e_{\\text{ss}} = -A^{-1}E d_0$$\n稳态残差 $r_{\\text{ss}}$ 则是：\n$$r_{\\text{ss}} = C e_{\\text{ss}} = -C A^{-1} E d_0$$\n这一项 $-C A^{-1} E$ 是从输入 $d$ 到输出 $r$ 的系统的直流增益。\n首先，我们计算 $A$ 的逆矩阵：\n$$\\det(A) = (-0.8)(-20) - (50)(-10) = 16 + 500 = 516$$\n$$A^{-1} = \\frac{1}{\\det(A)}\\begin{pmatrix} -20 & -50 \\\\ 10 & -0.8 \\end{pmatrix} = \\frac{1}{516}\\begin{pmatrix} -20 & -50 \\\\ 10 & -0.8 \\end{pmatrix}$$\n现在我们计算乘积 $C A^{-1} E$：\n$$C A^{-1} E = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\left(\\frac{1}{516}\\begin{pmatrix} -20 & -50 \\\\ 10 & -0.8 \\end{pmatrix}\\right) \\begin{pmatrix} -100 \\\\ 0 \\end{pmatrix}$$\n$$= \\frac{1}{516} \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} (-20)(-100) + (-50)(0) \\\\ (10)(-100) + (-0.8)(0) \\end{pmatrix} = \\frac{1}{516} \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 2000 \\\\ -1000 \\end{pmatrix} = \\frac{2000}{516}$$\n稳态残差是：\n$$r_{\\text{ss}} = - \\frac{2000}{516} d_0$$\n代入 $d_0 = 0.02$：\n$$r_{\\text{ss}} = - \\frac{2000}{516} \\times 0.02 = - \\frac{40}{516} \\approx -0.0775193798...$$\n四舍五入到四位有效数字，我们得到：\n$$r_{\\text{ss}} = -0.07752$$\n单位是弧度每秒，与 $\\omega$ 的单位相同。",
            "answer": "$$\\boxed{-0.07752}$$"
        },
        {
            "introduction": "有了系统的线性模型后，下一个挑战是如何处理来自过程噪声和传感器不确定性的内在不确定性。一个稳健的异常检测器必须能够区分真实异常与预期的噪声波动。本练习 () 深入探讨了这一问题的核心，要求您推导状态协方差传播的方程，这使得数字孪生能够动态地追踪自身随时间变化的不确定性。这为马氏距离 (Mahalanobis distance) 检验奠定了基础，该检验是一种强大的统计工具，用于设置动态的、自适应的检测阈值。",
            "id": "4215465",
            "problem": "一个信息物理系统（CPS）的数字孪生（DT）跟踪一个线性化的离散时间状态，时间索引为 $k \\in \\mathbb{N}$。真实状态根据 $x_{k+1} = A x_{k} + w_{k}$ 演化，其中 $x_{k} \\in \\mathbb{R}^{n}$，$A \\in \\mathbb{R}^{n \\times n}$ 是常数，过程噪声 $w_{k}$ 是一个零均值高斯随机向量，其协方差为 $Q \\in \\mathbb{R}^{n \\times n}$。该数字孪生（DT）维持一个无偏预测器 $\\hat{x}_{k \\mid k-1}$，其关联的状态预测误差为 $e_{k \\mid k-1} = x_{k} - \\hat{x}_{k \\mid k-1}$，协方差为 $P_{k} = \\mathbb{E}[e_{k \\mid k-1} e_{k \\mid k-1}^{\\top}]$。假设 $x_{0}$ 是零均值，协方差为 $P_{0}$，并且下面介绍的序列 $\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 相互独立且独立于 $x_{0}$。\n\n一个传感器提供测量值 $y_{k} = H x_{k} + v_{k}$，其中 $H \\in \\mathbb{R}^{m \\times n}$，测量噪声 $v_{k}$ 是零均值高斯分布，协方差为 $R \\in \\mathbb{R}^{m \\times m}$。用于异常检测的新息（或残差）为 $r_{k} = y_{k} - H \\hat{x}_{k \\mid k-1}$。该数字孪生通过马氏距离（Mahalanobis distance）检验进行新息门控，以决定是否标记异常。\n\n仅从协方差、独立性的定义以及高斯随机变量线性变换的性质出发，执行以下操作：\n1) 在给定的线性动力学和噪声假设下，推导将 $P_{k}$ 映射到 $P_{k+1}$ 的状态预测协方差递推关系。\n2) 展开此递推关系，以获得 $P_{k}$ 关于 $A$、$P_{0}$、$Q$ 和 $k$ 的闭式表达式，该表达式对任意 $k \\in \\mathbb{N}$ 均有效。\n3) 推导新息协方差 $S_{k} = \\mathbb{E}[r_{k} r_{k}^{\\top}]$ 关于 $H$、$P_{k}$ 和 $R$ 的表达式。\n4) 从 $r_{k}$ 的高斯性出发，证明马氏距离的平方 $d_{k}^{2} = r_{k}^{\\top} S_{k}^{-1} r_{k}$ 服从自由度为 $m$ 的卡方分布，并表示出一个动态门控阈值 $\\gamma_{k}$，该阈值可实现一个固定的虚警概率 $\\alpha \\in (0,1)$，将其表示为 $m$ 和 $\\alpha$ 的符号函数。解释在 $P_{k}$ 和 $S_{k}$ 中时变不确定性的背景下，为什么该阈值被称为“动态”的。\n\n将您的最终答案表示为第2项中推导出的 $P_{k}$ 的闭式表达式。不要提供任何数值计算。不需要四舍五入。单位不适用。",
            "solution": "问题陈述经验证，具有科学依据、问题明确且客观。它描述了线性系统状态估计和异常检测中的一个标准场景。解答过程将基于所提供的模型和定义推导所要求的量。\n\n我们按顺序解决这四个任务。\n\n**1) 状态预测协方差递推关系的推导**\n\n时刻 $k+1$ 的状态预测误差定义为 $e_{k+1 \\mid k} = x_{k+1} - \\hat{x}_{k+1 \\mid k}$。问题描述了一个维护预测器的数字孪生，但没有指定测量更新步骤（例如，卡尔曼滤波器的校正步骤）。新息门控用于异常检测的背景意味着我们将传入的测量值与纯粹基于模型的预测进行比较。因此，最合乎逻辑且一致的解释是，状态预测是基于前一个预测向前传播的，而没有结合测量更新。这意味着时刻 $k+1$ 的预测器是从时刻 $k$ 的预测器 $\\hat{x}_{k \\mid k-1}$ 通过系统动力学传播得出的：\n$$\n\\hat{x}_{k+1 \\mid k} = A \\hat{x}_{k \\mid k-1}\n$$\n状态本身根据 $x_{k+1} = A x_{k} + w_{k}$ 演化。将这些代入 $e_{k+1 \\mid k}$ 的定义中：\n$$\ne_{k+1 \\mid k} = (A x_{k} + w_{k}) - (A \\hat{x}_{k \\mid k-1}) = A (x_{k} - \\hat{x}_{k \\mid k-1}) + w_{k}\n$$\n识别出时刻 $k$ 的预测误差的定义，$e_{k \\mid k-1} = x_{k} - \\hat{x}_{k \\mid k-1}$，我们有：\n$$\ne_{k+1 \\mid k} = A e_{k \\mid k-1} + w_{k}\n$$\n时刻 $k+1$ 的状态预测误差协方差，在问题陈述中表示为 $P_{k+1}$（其中 $P_{k+1} = P_{k+1 \\mid k}$），由期望 $P_{k+1} = \\mathbb{E}[e_{k+1 \\mid k} e_{k+1 \\mid k}^{\\top}]$ 给出。代入 $e_{k+1 \\mid k}$ 的表达式：\n$$\nP_{k+1} = \\mathbb{E}[(A e_{k \\mid k-1} + w_{k})(A e_{k \\mid k-1} + w_{k})^{\\top}]\n$$\n展开乘积：\n$$\nP_{k+1} = \\mathbb{E}[A e_{k \\mid k-1} e_{k \\mid k-1}^{\\top} A^{\\top} + A e_{k \\mid k-1} w_{k}^{\\top} + w_{k} e_{k \\mid k-1}^{\\top} A^{\\top} + w_{k} w_{k}^{\\top}]\n$$\n根据期望的线性性：\n$$\nP_{k+1} = A \\mathbb{E}[e_{k \\mid k-1} e_{k \\mid k-1}^{\\top}] A^{\\top} + A \\mathbb{E}[e_{k \\mid k-1} w_{k}^{\\top}] + \\mathbb{E}[w_{k} e_{k \\mid k-1}^{\\top}] A^{\\top} + \\mathbb{E}[w_{k} w_{k}^{\\top}]\n$$\n根据问题定义，我们有 $\\mathbb{E}[e_{k \\mid k-1} e_{k \\mid k-1}^{\\top}] = P_{k}$ 和 $\\mathbb{E}[w_{k} w_{k}^{\\top}] = Q$。状态预测误差 $e_{k \\mid k-1}$ 是初始状态 $x_0$ 和直到时刻 $k-1$ 的过程噪声序列（即 $\\{w_0, w_1, \\dots, w_{k-1}\\}$）的函数。过程噪声 $w_k$ 独立于此历史。因此，$e_{k \\mid k-1}$ 和 $w_k$ 是统计上独立的。由于 $w_k$ 是零均值（$\\mathbb{E}[w_k] = 0$），它们是不相关的：\n$$\n\\mathbb{E}[e_{k \\mid k-1} w_{k}^{\\top}] = \\mathbb{E}[e_{k \\mid k-1}] \\mathbb{E}[w_{k}^{\\top}] = 0\n$$\n交叉项消失。状态预测协方差的递推关系为：\n$$\nP_{k+1} = A P_{k} A^{\\top} + Q\n$$\n\n**2) $P_{k}$ 的闭式表达式**\n\n我们从初始协方差 $P_0$ 开始展开递推关系 $P_{k+1} = A P_{k} A^{\\top} + Q$。问题假设 $\\hat{x}_{0 \\mid -1} = \\mathbb{E}[x_0] = 0$，所以 $e_{0 \\mid -1} = x_0$ 且 $P_0 = \\mathbb{E}[x_0 x_0^\\top]$。\n对于 $k=1$：\n$$\nP_{1} = A P_{0} A^{\\top} + Q\n$$\n对于 $k=2$：\n$$\nP_{2} = A P_{1} A^{\\top} + Q = A (A P_{0} A^{\\top} + Q) A^{\\top} + Q = A^{2} P_{0} (A^{\\top})^{2} + A Q A^{\\top} + Q\n$$\n对于 $k=3$：\n$$\nP_{3} = A P_{2} A^{\\top} + Q = A (A^{2} P_{0} (A^{\\top})^{2} + A Q A^{\\top} + Q) A^{\\top} + Q = A^{3} P_{0} (A^{\\top})^{3} + A^{2} Q (A^{\\top})^{2} + A Q A^{\\top} + Q\n$$\n通过观察，一个通用模式出现了。对于任意 $k \\in \\mathbb{N}$（假设 $\\mathbb{N}=\\{0, 1, 2, ...\\}$），$P_k$ 的闭式表达式为：\n$$\nP_{k} = A^{k} P_{0} (A^{\\top})^{k} + \\sum_{i=0}^{k-1} A^{i} Q (A^{\\top})^{i}\n$$\n这是关于 $P_k$ 的离散时间李雅普诺夫方程（Lyapunov equation）的解。对于 $k=0$，求和项为空，值为零，得到 $P_0 = A^0 P_0 (A^\\top)^0 = P_0$，这是一致的。\n\n**3) 新息协方差 $S_{k}$ 的推导**\n\n新息定义为 $r_{k} = y_{k} - H \\hat{x}_{k \\mid k-1}$。给定测量模型 $y_{k} = H x_{k} + v_{k}$。将其代入新息方程：\n$$\nr_{k} = (H x_{k} + v_{k}) - H \\hat{x}_{k \\mid k-1} = H (x_{k} - \\hat{x}_{k \\mid k-1}) + v_{k}\n$$\n这可以简化为 $r_{k} = H e_{k \\mid k-1} + v_{k}$。\n新息协方差为 $S_{k} = \\mathbb{E}[r_{k} r_{k}^{\\top}]$。代入 $r_k$ 的表达式：\n$$\nS_{k} = \\mathbb{E}[(H e_{k \\mid k-1} + v_{k})(H e_{k \\mid k-1} + v_{k})^{\\top}]\n$$\n展开乘积：\n$$\nS_{k} = \\mathbb{E}[H e_{k \\mid k-1} e_{k \\mid k-1}^{\\top} H^{\\top} + H e_{k \\mid k-1} v_{k}^{\\top} + v_{k} e_{k \\mid k-1}^{\\top} H^{\\top} + v_{k} v_{k}^{\\top}]\n$$\n根据期望的线性性：\n$$\nS_{k} = H \\mathbb{E}[e_{k \\mid k-1} e_{k \\mid k-1}^{\\top}] H^{\\top} + H \\mathbb{E}[e_{k \\mid k-1} v_{k}^{\\top}] + \\mathbb{E}[v_{k} e_{k \\mid k-1}^{\\top}] H^{\\top} + \\mathbb{E}[v_{k} v_{k}^{\\top}]\n$$\n我们有 $\\mathbb{E}[e_{k \\mid k-1} e_{k \\mid k-1}^{\\top}] = P_{k}$ 和 $\\mathbb{E}[v_{k} v_{k}^{\\top}] = R$。状态预测误差 $e_{k \\mid k-1}$ 依赖于 $x_0$ 和 $\\{w_0, \\dots, w_{k-1}\\}$。根据定义，测量噪声 $v_k$ 独立于初始状态 $x_0$ 和整个过程噪声序列 $\\{w_j\\}$。因此，$e_{k \\mid k-1}$ 和 $v_k$ 是统计上独立的。由于 $v_k$ 是零均值，它们是不相关的。交叉项为零：\n$$\n\\mathbb{E}[e_{k \\mid k-1} v_{k}^{\\top}] = 0\n$$\n因此，新息协方差为：\n$$\nS_{k} = H P_{k} H^{\\top} + R\n$$\n\n**4) 马氏距离分布和门控阈值**\n\n首先，我们确定新息 $r_k$ 的分布。初始状态 $x_0$、过程噪声 $w_k$ 和测量噪声 $v_k$ 都被指定为高斯随机向量。高斯向量的线性变换仍然是高斯向量。状态 $x_k$ 和预测误差 $e_{k \\mid k-1}$ 是通过对这些初始高斯变量的一系列线性运算生成的，因此它们也是高斯分布的。新息 $r_{k} = H e_{k \\mid k-1} + v_{k}$ 是高斯向量 $e_{k \\mid k-1}$ 和 $v_k$ 的线性组合，因此 $r_k$ 也是一个高斯随机向量。其均值为 $\\mathbb{E}[r_k] = H \\mathbb{E}[e_{k \\mid k-1}] + \\mathbb{E}[v_k]$。由于预测器是无偏的（$\\mathbb{E}[\\hat{x}_{k \\mid k-1}] = \\mathbb{E}[x_k]$），预测误差是零均值（$\\mathbb{E}[e_{k \\mid k-1}]=0$）。又因为 $\\mathbb{E}[v_k]=0$，我们得出 $\\mathbb{E}[r_k]=0$。因此，$r_k \\sim \\mathcal{N}(0, S_k)$。\n\n为了分析马氏距离的平方 $d_{k}^{2} = r_{k}^{\\top} S_{k}^{-1} r_{k}$，我们对新息向量进行归一化。令 $S_k^{1/2}$ 为 $S_k$ 的一个矩阵平方根（例如，通过乔列斯基分解 Cholesky decomposition），使得 $S_k = S_k^{1/2} (S_k^{1/2})^{\\top}$。我们定义一个归一化向量 $z_k = (S_k^{1/2})^{-1} r_k$。向量 $z_k$ 是高斯向量 $r_k$ 的线性变换，因此它也是高斯分布的，其均值为 $\\mathbb{E}[z_k] = (S_k^{1/2})^{-1} \\mathbb{E}[r_k] = 0$。其协方差为：\n$$\n\\mathbb{E}[z_k z_k^{\\top}] = \\mathbb{E}[(S_k^{1/2})^{-1} r_k r_k^{\\top} ((S_k^{1/2})^{-1})^{\\top}] = (S_k^{1/2})^{-1} \\mathbb{E}[r_k r_k^{\\top}] ((S_k^{1/2})^{-1})^{\\top} = (S_k^{1/2})^{-1} S_k ((S_k^{1/2})^{\\top})^{-1} = I_m\n$$\n其中 $I_m$ 是 $m \\times m$ 的单位矩阵。因此，$z_k$ 是一个标准多元正态随机向量，$z_k \\sim \\mathcal{N}(0, I_m)$，其 $m$ 个分量是独立的标准正态变量。\n马氏距离可以重写为：\n$$\nd_k^2 = r_{k}^{\\top} S_{k}^{-1} r_{k} = r_{k}^{\\top} (((S_{k}^{1/2})^{\\top})^{-1} (S_{k}^{1/2})^{-1}) r_{k} = ((S_{k}^{1/2})^{-1}r_k)^{\\top} ((S_{k}^{1/2})^{-1}r_k) = z_k^{\\top} z_k\n$$\n这是 $z_k$ 的 $m$ 个分量的平方和：$d_k^2 = \\sum_{i=1}^{m} z_{k,i}^2$。根据定义， $m$ 个独立标准正态随机变量的平方和服从自由度为 $m$ 的卡方分布。因此，$d_k^2 \\sim \\chi^2(m)$。\n\n如果 $d_k^2 > \\gamma_k$，则标记为异常。如果在系统正常运行时（即在推导的零假设 $d_k^2 \\sim \\chi^2(m)$ 下）满足此条件，则会发生虚警。虚警概率 $\\alpha$ 由下式给出：\n$$\n\\alpha = P(d_k^2 > \\gamma_k)\n$$\n令 $F_{\\chi^2(m)}$ 为自由度为 $m$ 的卡方分布的累积分布函数（CDF）。则 $P(d_k^2 \\le \\gamma_k) = F_{\\chi^2(m)}(\\gamma_k)$，因此 $\\alpha = 1 - F_{\\chi^2(m)}(\\gamma_k)$。阈值 $\\gamma_k$ 通过对CDF求逆得到：\n$$\n\\gamma_{k} = (F_{\\chi^2(m)})^{-1}(1 - \\alpha)\n$$\n该阈值仅取决于测量维度 $m$ 和期望的虚警概率 $\\alpha$，这两者都是常数。因此，$\\gamma_k$ 的数值对于所有 $k$ 都是恒定的。门控过程之所以被称为“动态”的，是因为检验本身 $r_{k}^{\\top} S_{k}^{-1} r_{k} > \\gamma_k$ 涉及随时间变化的创新协方差矩阵 $S_k$。新息的接受域，由椭球 $\\{ r \\in \\mathbb{R}^m \\mid r^{\\top} S_{k}^{-1} r \\le \\gamma_k \\}$ 定义，其大小和方向在每个时间步 $k$ 都会随着状态预测协方差 $P_k$ 的演化而改变。该阈值被应用于这个动态归一化的统计量。",
            "answer": "$$\\boxed{A^{k} P_{0} (A^{\\top})^{k} + \\sum_{i=0}^{k-1} A^{i} Q (A^{\\top})^{i}}$$"
        },
        {
            "introduction": "数字孪生的理论优势在于其能够融合多个数据流，从而更全面地了解系统健康状况。然而，简单地组合更多数据是否总能带来更好的异常检测性能？最后的这个练习 () 提出了一个具有警示意义但至关重要的场景。通过比较基于原始传感器测量的检测器和使用一个简单构造的残差的检测器，您将发现不恰当地融合数据实际上可能会引入更多噪声并降低性能。这个练习强调了数字孪生的真正价值不仅在于组合数据，更在于以最优方式进行组合以提高信噪比。",
            "id": "4215510",
            "problem": "一个直流 (DC) 电机数字孪生被在线部署，用于支持信息物理系统中的异常检测。该数字孪生利用直流电机的基本机电关系和传感器测量值，来推导无法直接测量的变量。其基础是以下稳态电机模型：转矩方程为 $\\tau = k_t i$，其中 $\\tau$ 是以牛顿-米为单位的转矩，$k_t$ 是以牛顿-米/安培为单位的转矩常数，$i$ 是以安培为单位的电枢电流。粘性摩擦模型为 $\\tau_f = b \\, \\omega$，其中 $\\tau_f$ 是以牛顿-米为单位的摩擦转矩，$b$ 是以牛顿-米-秒/弧度为单位的粘性摩擦系数，$\\omega$ 是以弧度/秒为单位的角速度。稳态下的机械平衡方程为 $b \\, \\omega + \\tau_{\\mathrm{load}} = \\tau$，其中 $\\tau_{\\mathrm{load}}$ 是以牛顿-米为单位的外部负载转矩。数字孪生可以通过结合 $i$ 和 $\\omega$ 来估计产生的转矩和残差，计算公式为 $\\hat{\\tau} = k_t \\, i$ 和 $\\hat{r} = \\hat{\\tau} - b \\, \\omega - \\tau_{\\mathrm{load},0}$，其中 $\\tau_{\\mathrm{load},0}$ 是以牛顿-米为单位的标称（预期）负载转矩。\n\n假设传感和操作遵循以下机制：\n- 系统在固定的设定点（稳态）附近被调节，因此在感兴趣的时间窗口内，惯性项与粘性摩擦和负载转矩相比可以忽略不计。\n- 测量的电枢电流 $i_{\\mathrm{meas}}$ 等于真实的电枢电流加上一个均值为零、标准差为 $\\sigma_i$（单位：安培）的高斯噪声；测量的角速度 $\\omega_{\\mathrm{meas}}$ 等于真实的速度加上一个均值为零、标准差为 $\\sigma_\\omega$（单位：弧度/秒）的高斯噪声。这些传感器噪声在彼此之间以及在时间上都是独立的。\n- 我们关注的一种异常是负载转矩在未知时间发生一个大小为 $\\Delta$（单位：牛顿-米）的正向阶跃增长（即 $\\Delta > 0$），而控制器通过调整电流来将速度维持在其设定点附近。\n\n在此高斯传感模型下，考虑一个用于检测异常的标量阈值检测器。为了分离数字孪生增强所带来的影响，我们比较两种检测器：\n1. 仅使用原始电流测量值 $i_{\\mathrm{meas}}$ 的检测器，其上尾阈值的选择是为了达到一个预设的假阳性率 $\\alpha$（以小数表示）。\n2. 仅使用孪生派生残差 $\\hat{r}$ 的检测器，其上尾阈值的选择是为了达到相同的假阳性率 $\\alpha$。\n\n对于每种检测器，在正常（无异常）操作下，必须设置阈值以达到指定的假阳性率。在发生阶跃增长 $\\Delta$ 的异常操作下，预期召回率是指标量特征超过其阈值的概率。\n\n任务：\n- 实现一个在线孪生估计器，它接收以安培为单位的测量电流 $i_{\\mathrm{meas}}$ 和以弧度/秒为单位的测量速度 $\\omega_{\\mathrm{meas}}$ 的时间序列，并使用稳态关系在每个时间步输出以牛顿-米为单位的估计转矩 $\\hat{\\tau}$ 和以牛顿-米为单位的残差 $\\hat{r}$。\n- 根据所述的高斯传感假设和稳态电机方程，推导当仅电流检测器和仅残差检测器都调整到相同的假阳性率 $\\alpha$ 时，各自的预期召回率。\n- 计算预期召回率的提升量，其定义为仅残差检测器的召回率减去仅电流检测器的召回率，并针对以下参数集进行计算。\n\n使用以下参数集测试套件，其中每个元组代表 $(k_t, b, \\sigma_i, \\sigma_\\omega, \\Delta, \\alpha, \\tau_{\\mathrm{load},0})$，单位分别为：$k_t$ 为牛顿-米/安培，$b$ 为牛顿-米-秒/弧度，$\\sigma_i$ 为安培，$\\sigma_\\omega$ 为弧度/秒，$\\Delta$ 为牛顿-米，$\\alpha$ 为小数，$\\tau_{\\mathrm{load},0}$ 为牛顿-米：\n- 测试 $1$（一般情况）：$(0.12, 0.001, 0.05, 0.5, 0.4, 0.01, 1.0)$。\n- 测试 $2$（近零噪声边界）：$(0.2, 0.002, 0.000001, 0.000001, 0.1, 0.01, 0.5)$。\n- 测试 $3$（速度噪声主导）：$(0.1, 0.005, 0.01, 5.0, 0.3, 0.05, 0.8)$。\n- 测试 $4$（电流噪声主导）：$(0.08, 0.0005, 0.5, 0.1, 0.6, 0.02, 0.3)$。\n- 测试 $5$（阈值附近的小异常）：$(0.15, 0.002, 0.02, 0.3, 0.02, 0.05, 0.7)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个浮点数四舍五入到六位小数，按顺序表示测试 $1$ 到测试 $5$ 的预期召回率提升量（即 $[\\mathrm{impr}_1,\\mathrm{impr}_2,\\mathrm{impr}_3,\\mathrm{impr}_4,\\mathrm{impr}_5]$）。角度必须以弧度处理，所有物理量必须使用上述指定单位。程序必须是自包含的，且不得读取任何外部输入或文件。",
            "solution": "该问题要求对用于直流电机系统的两种异常检测器进行严格比较，其中一种基于原始电流测量值，另一种基于数字孪生派生的残差。目标是计算在两种检测器都调整到相同假阳性率的情况下，基于残差的检测器相比于基于电流的检测器所能提供的召回率提升。\n\n首先，我们必须在正常操作（零假设, $H_0$）和异常操作（备择假设, $H_1$）两种情况下，对两种检测特征的统计特性进行形式化。问题提供了必要的物理模型和噪声特性。\n\n令 $i_{\\mathrm{true}}$ 和 $\\omega_{\\mathrm{true}}$ 分别为真实的电枢电流和角速度。测量值由以下公式给出：\n$$ i_{\\mathrm{meas}} = i_{\\mathrm{true}} + n_i, \\quad n_i \\sim \\mathcal{N}(0, \\sigma_i^2) $$\n$$ \\omega_{\\mathrm{meas}} = \\omega_{\\mathrm{true}} + n_\\omega, \\quad n_\\omega \\sim \\mathcal{N}(0, \\sigma_\\omega^2) $$\n其中 $n_i$ 和 $n_\\omega$ 是独立的、均值为零的高斯噪声项。\n\n用于检测的两个特征是测量的电流 $f_1 = i_{\\mathrm{meas}}$ 和计算的残差 $f_2 = \\hat{r}$。残差定义为：\n$$ \\hat{r} = k_t i_{\\mathrm{meas}} - b \\omega_{\\mathrm{meas}} - \\tau_{\\mathrm{load},0} $$\n\n**步骤 1：正常操作下的分析 ($H_0$)**\n\n在正常的稳态条件下，物理系统遵循带有标称负载 $\\tau_{\\mathrm{load},0}$ 的机械平衡方程：\n$$ k_t i_{\\mathrm{true},0} = b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},0} $$\n此处，下标 $0$ 表示正常操作状态。\n\n**$H_0$ 下电流特征 ($i_{\\mathrm{meas}}$) 的分布：**\n测量的电流是一个高斯随机变量。\n- 均值：$\\mu_{i,0} = \\mathbb{E}[i_{\\mathrm{meas}}] = \\mathbb{E}[i_{\\mathrm{true},0} + n_i] = i_{\\mathrm{true},0} = (b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},0})/k_t$。\n- 方差：$\\sigma_{i,0}^2 = \\mathrm{Var}(i_{\\mathrm{meas}}) = \\mathrm{Var}(i_{\\mathrm{true},0} + n_i) = \\sigma_i^2$。\n因此，在 $H_0$ 下，$i_{\\mathrm{meas}} \\sim \\mathcal{N}\\left(i_{\\mathrm{true},0}, \\sigma_i^2\\right)$。\n\n**$H_0$ 下残差特征 ($\\hat{r}$) 的分布：**\n我们将测量变量的表达式代入残差公式：\n$$ \\hat{r} = k_t (i_{\\mathrm{true},0} + n_i) - b (\\omega_{\\mathrm{true},0} + n_\\omega) - \\tau_{\\mathrm{load},0} $$\n$$ \\hat{r} = (k_t i_{\\mathrm{true},0} - b \\omega_{\\mathrm{true},0} - \\tau_{\\mathrm{load},0}) + k_t n_i - b n_\\omega $$\n根据 $H_0$ 下的稳态平衡方程，括号中的项为零。因此，残差简化为噪声项的线性组合：\n$$ \\hat{r} = k_t n_i - b n_\\omega $$\n作为独立高斯变量的线性组合，$\\hat{r}$ 也服从高斯分布。\n- 均值：$\\mu_{r,0} = \\mathbb{E}[k_t n_i - b n_\\omega] = k_t \\mathbb{E}[n_i] - b \\mathbb{E}[n_\\omega] = 0$。\n- 方差：$\\sigma_{r,0}^2 = \\mathrm{Var}(k_t n_i - b n_\\omega) = k_t^2 \\mathrm{Var}(n_i) + (-b)^2 \\mathrm{Var}(n_\\omega) = k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2$。\n因此，在 $H_0$ 下，$\\hat{r} \\sim \\mathcal{N}\\left(0, k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2\\right)$。\n\n**步骤 2：检测阈值的推导**\n\n两种检测器都使用上尾阈值，以达到为 $\\alpha$ 的假阳性率。令 $Z \\sim \\mathcal{N}(0, 1)$ 为标准正态变量，并令 $z_\\alpha = \\Phi^{-1}(1-\\alpha)$ 为标准正态分布的上 $\\alpha$-分位数，其中 $\\Phi$ 是累积分布函数 (CDF)。\n\n- **电流检测器阈值 ($T_i$):**\n  $P(i_{\\mathrm{meas}} > T_i | H_0) = \\alpha$。\n  标准化变量：$P\\left(\\frac{i_{\\mathrm{meas}} - i_{\\mathrm{true},0}}{\\sigma_i} > \\frac{T_i - i_{\\mathrm{true},0}}{\\sigma_i}\\right) = \\alpha$。\n  这意味着 $\\frac{T_i - i_{\\mathrm{true},0}}{\\sigma_i} = z_\\alpha$，所以 $T_i = i_{\\mathrm{true},0} + z_\\alpha \\sigma_i$。\n\n- **残差检测器阈值 ($T_r$):**\n  $P(\\hat{r} > T_r | H_0) = \\alpha$。\n  标准化变量：$P\\left(\\frac{\\hat{r} - 0}{\\sigma_{r,0}} > \\frac{T_r}{\\sigma_{r,0}}\\right) = \\alpha$。\n  这意味着 $\\frac{T_r}{\\sigma_{r,0}} = z_\\alpha$，所以 $T_r = z_\\alpha \\sigma_{r,0} = z_\\alpha \\sqrt{k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2}$。\n\n**步骤 3：异常操作下的分析 ($H_1$)**\n\n在 $H_1$ 下，负载转矩增加 $\\Delta$，因此 $\\tau_{\\mathrm{load},1} = \\tau_{\\mathrm{load},0} + \\Delta$。控制器调整电流以维持速度，因此我们假设 $\\omega_{\\mathrm{true},1} \\approx \\omega_{\\mathrm{true},0}$。新的稳态平衡方程为：\n$$ k_t i_{\\mathrm{true},1} = b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},1} = b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},0} + \\Delta $$\n由此，新的真实电流为 $i_{\\mathrm{true},1} = \\frac{b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},0}}{k_t} + \\frac{\\Delta}{k_t} = i_{\\mathrm{true},0} + \\frac{\\Delta}{k_t}$。\n异常导致真实电流的均值发生偏移。\n\n**$H_1$ 下电流特征 ($i_{\\mathrm{meas}}$) 的分布：**\n- 均值：$\\mu_{i,1} = \\mathbb{E}[i_{\\mathrm{true},1} + n_i] = i_{\\mathrm{true},1} = i_{\\mathrm{true},0} + \\Delta/k_t$。\n- 方差：$\\sigma_{i,1}^2 = \\sigma_i^2$（噪声统计数据不变）。\n因此，在 $H_1$ 下，$i_{\\mathrm{meas}} \\sim \\mathcal{N}\\left(i_{\\mathrm{true},0} + \\Delta/k_t, \\sigma_i^2\\right)$。\n\n**$H_1$ 下残差特征 ($\\hat{r}$) 的分布：**\n$$ \\hat{r} = k_t (i_{\\mathrm{true},1} + n_i) - b (\\omega_{\\mathrm{true},0} + n_\\omega) - \\tau_{\\mathrm{load},0} $$\n$$ \\hat{r} = (k_t i_{\\mathrm{true},1} - b \\omega_{\\mathrm{true},0} - \\tau_{\\mathrm{load},0}) + k_t n_i - b n_\\omega $$\n代入 $k_t i_{\\mathrm{true},1} = b \\omega_{\\mathrm{true},0} + \\tau_{\\mathrm{load},0} + \\Delta$，括号中的项变为 $\\Delta$。\n$$ \\hat{r} = \\Delta + k_t n_i - b n_\\omega $$\n- 均值：$\\mu_{r,1} = \\mathbb{E}[\\Delta + k_t n_i - b n_\\omega] = \\Delta$。\n- 方差：$\\sigma_{r,1}^2 = \\mathrm{Var}(\\Delta + k_t n_i - b n_\\omega) = k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2 = \\sigma_{r,0}^2$。\n因此，在 $H_1$ 下，$\\hat{r} \\sim \\mathcal{N}\\left(\\Delta, k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2\\right)$。\n\n**步骤 4：召回率和提升量的计算**\n\n召回率是在给定异常的情况下检测到异常的概率，即 $P(\\text{特征} > \\text{阈值} | H_1)$。\n- **电流检测器召回率 ($R_i$):**\n  $R_i = P(i_{\\mathrm{meas}} > T_i | H_1) = P\\left(\\frac{i_{\\mathrm{meas}} - \\mu_{i,1}}{\\sigma_i} > \\frac{T_i - \\mu_{i,1}}{\\sigma_i}\\right)$。\n  概率的参数为 $\\frac{(i_{\\mathrm{true},0} + z_\\alpha \\sigma_i) - (i_{\\mathrm{true},0} + \\Delta/k_t)}{\\sigma_i} = z_\\alpha - \\frac{\\Delta}{k_t \\sigma_i}$。\n  $R_i = P(Z > z_\\alpha - \\frac{\\Delta}{k_t \\sigma_i}) = \\Phi\\left(- (z_\\alpha - \\frac{\\Delta}{k_t \\sigma_i})\\right) = \\Phi\\left(\\frac{\\Delta}{k_t \\sigma_i} - z_\\alpha\\right)$。\n\n- **残差检测器召回率 ($R_r$):**\n  $R_r = P(\\hat{r} > T_r | H_1) = P\\left(\\frac{\\hat{r} - \\mu_{r,1}}{\\sigma_{r,0}} > \\frac{T_r - \\mu_{r,1}}{\\sigma_{r,0}}\\right)$。\n  概率的参数为 $\\frac{z_\\alpha \\sigma_{r,0} - \\Delta}{\\sigma_{r,0}} = z_\\alpha - \\frac{\\Delta}{\\sigma_{r,0}}$。\n  $R_r = P(Z > z_\\alpha - \\frac{\\Delta}{\\sigma_{r,0}}) = \\Phi\\left(\\frac{\\Delta}{\\sigma_{r,0}} - z_\\alpha\\right) = \\Phi\\left(\\frac{\\Delta}{\\sqrt{k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2}} - z_\\alpha\\right)$。\n\n**召回率的提升量 ($\\Delta R$):**\n需要计算的最终量是召回率的差值，$\\Delta R = R_r - R_i$。\n$$ \\Delta R = \\Phi\\left(\\frac{\\Delta}{\\sqrt{k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2}} - z_\\alpha\\right) - \\Phi\\left(\\frac{\\Delta}{k_t \\sigma_i} - z_\\alpha\\right) $$\n其中 $z_\\alpha = \\Phi^{-1}(1-\\alpha)$。该公式可以使用每个测试用例的参数直接实现。\n请注意，残差的噪声项 $\\sqrt{k_t^2 \\sigma_i^2 + b^2 \\sigma_\\omega^2}$ 总是大于或等于电流检测器的有效噪声（映射到转矩单位）$k_t \\sigma_i$。这意味着残差检测器的信噪比将小于或等于电流检测器的信噪比。因此，计算出的“提升量”将是非正的，这说明了一个简单地增加传感器信息可能会因为引入更多噪声而降低性能的场景。\n参数 $\\tau_{\\mathrm{load},0}$ 是系统操作环境的一部分，但如推导所示，它在最终的召回率计算中被抵消了。\n\n以下 Python 代码为每个测试用例实现了这个最终公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the expected improvement in recall for a residual-based anomaly detector\n    over a current-only detector for a DC motor digital twin.\n    \"\"\"\n    # Test suite of parameter sets.\n    # Each tuple represents (k_t, b, sigma_i, sigma_omega, Delta, alpha, tau_load_0).\n    test_cases = [\n        # Test 1 (general case)\n        (0.12, 0.001, 0.05, 0.5, 0.4, 0.01, 1.0),\n        # Test 2 (near-zero noise boundary)\n        (0.2, 0.002, 0.000001, 0.000001, 0.1, 0.01, 0.5),\n        # Test 3 (speed noise dominates)\n        (0.1, 0.005, 0.01, 5.0, 0.3, 0.05, 0.8),\n        # Test 4 (current noise dominates)\n        (0.08, 0.0005, 0.5, 0.1, 0.6, 0.02, 0.3),\n        # Test 5 (small anomaly near threshold)\n        (0.15, 0.002, 0.02, 0.3, 0.02, 0.05, 0.7),\n    ]\n\n    results = []\n    for case in test_cases:\n        k_t, b, sigma_i, sigma_omega, Delta, alpha, tau_load_0 = case\n\n        # Calculate z_alpha, the upper alpha-quantile of the standard normal distribution.\n        # z_alpha corresponds to the threshold in standard score units.\n        # P(Z > z_alpha) = alpha, where Z ~ N(0, 1).\n        # This is found using the percent-point function (inverse CDF) at 1-alpha.\n        z_alpha = norm.ppf(1 - alpha)\n\n        # ---- Detector 1: Current-only ----\n        # The change in the mean of the current due to the anomaly Delta is Delta / k_t.\n        # The noise standard deviation of the current measurement is sigma_i.\n        # To compare with the residual (which is in torque units), we can think of the\n        # effective \"signal\" as Delta and the effective noise std dev as k_t * sigma_i.\n        # The signal-to-noise ratio for the current detector is (Delta) / (k_t * sigma_i).\n        snr_i = Delta / (k_t * sigma_i)\n        \n        # The recall for the current detector is P(Z > z_alpha - snr_i), which is\n        # equivalent to Phi(snr_i - z_alpha), where Phi is the standard normal CDF.\n        recall_i = norm.cdf(snr_i - z_alpha)\n\n        # ---- Detector 2: Residual-only ----\n        # The change in the mean of the residual due to the anomaly is Delta.\n        # The noise standard deviation of the residual is sqrt( (k_t*sigma_i)^2 + (b*sigma_omega)^2 ).\n        # This is the variance of k_t*n_i - b*n_omega.\n        sigma_r = np.sqrt((k_t * sigma_i)**2 + (b * sigma_omega)**2)\n        \n        # The signal-to-noise ratio for the residual detector is Delta / sigma_r.\n        snr_r = Delta / sigma_r\n        \n        # The recall for the residual detector is P(Z > z_alpha - snr_r), which is\n        # equivalent to Phi(snr_r - z_alpha).\n        recall_r = norm.cdf(snr_r - z_alpha)\n\n        # --- Improvement in Recall ---\n        # The improvement is defined as residual-only recall minus current-only recall.\n        improvement = recall_r - recall_i\n        \n        results.append(improvement)\n\n    # Format the output as a comma-separated list of floats rounded to 6 decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}