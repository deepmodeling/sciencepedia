{
    "hands_on_practices": [
        {
            "introduction": "The fidelity of a digital twin is fundamentally limited by the quality of the data it receives from its physical counterpart. The Nyquist-Shannon sampling theorem provides the theoretical foundation for converting continuous analog signals into discrete digital data without losing critical information. This exercise reinforces this crucial first principle, requiring a derivation from the ground up to understand how sampling frequency directly impacts data integrity and prevents phenomena like aliasing, which can lead to catastrophic misinterpretations of the physical system's state .",
            "id": "4217854",
            "problem": "A Digital Twin (DT) of a smart milling cell in an Industry 4.0 cyber-physical system must stream a strain-gage force sensor signal from the physical machine to the DT analytics. To ensure model fidelity and prevent misinterpretation of tool engagement dynamics, the sampled data must be aliasing-free. Starting from the Fourier transform definition and the representation of ideal time-domain sampling as multiplication by a Dirac impulse train, derive the relationship between the sampling frequency and aliasing for a real-valued, baseband, bandlimited sensor signal. Your derivation must rely only on the following foundations: the continuous-time Fourier transform, linearity, and the duality between time-domain multiplication and frequency-domain convolution. Clearly state the condition that guarantees no aliasing in the sampled spectrum in terms of the sampling frequency and the one-sided bandwidth. Then, for a tool-load sensor whose analog front-end anti-aliasing stage produces an effectively bandlimited signal with one-sided bandwidth $B = 9.375\\,\\text{kHz}$ (i.e., negligible magnitude for $|f| > B$), determine the minimum sampling rate that satisfies the Nyquist criterion and thereby prohibits aliasing. Round your answer to $4$ significant figures and express the sampling rate in $\\text{kHz}$. The final answer must be a single real number.",
            "solution": "The problem requires the derivation of the Nyquist sampling criterion and its application to a specific sensor signal. The derivation must originate from the definition of the Fourier transform and the model of ideal sampling as multiplication by a Dirac impulse train.\n\nLet the continuous-time analog signal from the strain-gage force sensor be denoted by $x(t)$. Its continuous-time Fourier transform (CTFT) is defined as:\n$$X(f) = \\int_{-\\infty}^{\\infty} x(t) \\exp(-j 2 \\pi f t) dt$$\nThe problem states that this signal is real-valued, baseband, and effectively bandlimited with a one-sided bandwidth of $B$. This implies that its Fourier transform $X(f)$ is zero for frequencies beyond this bandwidth:\n$$X(f) = 0 \\quad \\text{for} \\quad |f| > B$$\nFor a real-valued signal $x(t)$, its spectrum exhibits conjugate symmetry, i.e., $X(-f) = X^*(f)$.\n\nIdeal sampling in the time domain is modeled as the multiplication of the continuous signal $x(t)$ by an infinite train of Dirac delta impulses, $p(t)$. This impulse train is defined as:\n$$p(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\nwhere $T_s$ is the sampling period. The resulting sampled signal, $x_s(t)$, is:\n$$x_s(t) = x(t) \\cdot p(t) = x(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\nUsing the sifting property of the Dirac delta function, which states that $g(t)\\delta(t-t_0) = g(t_0)\\delta(t-t_0)$, the expression for the sampled signal becomes:\n$$x_s(t) = \\sum_{n=-\\infty}^{\\infty} x(nT_s) \\delta(t - nT_s)$$\nThis represents a sequence of impulses located at integer multiples of the sampling period, $nT_s$, with each impulse weighted by the corresponding sample value $x(nT_s)$.\n\nTo understand the effect of sampling in the frequency domain, we must compute the Fourier transform of the sampled signal, $X_s(f) = \\mathcal{F}\\{x_s(t)\\}$. The problem specifies using the duality property that multiplication in the time domain corresponds to convolution in the frequency domain (and vice versa). Therefore:\n$$X_s(f) = \\mathcal{F}\\{x(t) \\cdot p(t)\\} = X(f) * P(f)$$\nwhere $P(f) = \\mathcal{F}\\{p(t)\\}$ and the symbol $*$ denotes the convolution operation.\n\nThe next step is to find the Fourier transform of the impulse train, $P(f)$. The impulse train $p(t)$ is a periodic function with period $T_s$. The Fourier transform of a periodic impulse train is another impulse train in the frequency domain. Specifically:\n$$P(f) = \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)\\right\\} = \\frac{1}{T_s} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(f - \\frac{k}{T_s}\\right)$$\nSubstituting the sampling frequency $f_s = 1/T_s$, we get:\n$$P(f) = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s)$$\n\nNow, we can compute the convolution to find $X_s(f)$:\n$$X_s(f) = X(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right)$$\nUsing the linearity of the convolution operator, we can move the summation and the constant factor $f_s$ outside:\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} \\left( X(f) * \\delta(f - kf_s) \\right)$$\nThe convolution of any function with a shifted Dirac impulse results in a shifted version of that function, following the property $g(f) * \\delta(f-f_0) = g(f-f_0)$. Applying this yields:\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} X(f - kf_s)$$\nThis fundamental result shows that the spectrum of the sampled signal, $X_s(f)$, consists of scaled replicas of the original signal's spectrum, $X(f)$, repeated at every integer multiple of the sampling frequency, $f_s$.\n\nAliasing occurs when these spectral replicas overlap. The original spectrum, corresponding to the $k=0$ term, is $f_s X(f)$ and occupies the frequency interval $[-B, B]$. The adjacent replicas, for $k=1$ and $k=-1$, are centered at $f_s$ and $-f_s$, respectively. The replica centered at $f_s$ occupies the interval $[f_s - B, f_s + B]$.\n\nTo prevent any overlap between the original spectrum and the adjacent replica, the upper-frequency end of the original spectrum must be less than or equal to the lower-frequency end of the replica at $f_s$. This gives the condition:\n$$B \\le f_s - B$$\nRearranging this inequality provides the condition for alias-free sampling:\n$$f_s \\ge 2B$$\nThis is the Nyquist criterion. It establishes that to perfectly reconstruct a bandlimited signal from its samples, the sampling frequency $f_s$ must be at least twice the highest frequency component $B$ in the signal. The minimum sampling rate, $f_{s, \\text{min}} = 2B$, is known as the Nyquist rate.\n\nFor the given problem, the one-sided bandwidth of the sensor signal is $B = 9.375\\,\\text{kHz}$. To prevent aliasing, the sampling rate $f_s$ must satisfy the Nyquist criterion. The minimum sampling rate required is:\n$$f_{s, \\text{min}} = 2B = 2 \\times 9.375\\,\\text{kHz} = 18.75\\,\\text{kHz}$$\nThe problem asks for the answer to be rounded to $4$ significant figures and expressed in kHz. The calculated value of $18.75$ already has four significant figures. Thus, the minimum sampling rate is $18.75\\,\\text{kHz}$.",
            "answer": "$$\\boxed{18.75}$$"
        },
        {
            "introduction": "At the heart of a sophisticated digital twin lies its ability to intelligently fuse sensor measurements with a predictive model of the physical asset. For systems with nonlinear dynamics, the Extended Kalman Filter (EKF) is a cornerstone algorithm for real-time state estimation, recursively updating the system's state by linearizing the dynamics around the current estimate. This practice provides a deep dive into the mathematical machinery of the EKF, requiring the derivation of the Jacobian matrices that enable this linearization and are essential for building twins that can accurately track and predict the behavior of complex, real-world manufacturing equipment .",
            "id": "4217830",
            "problem": "A digital twin for a smart manufacturing spindle in Industry $4.0$ is modeled as a continuous-time, nonlinear, stochastic state-space system. The state vector is $x=\\begin{pmatrix}\\theta \\\\ \\omega\\end{pmatrix}$, where $\\theta$ is the spindle angular position and $\\omega$ is the angular speed. The actuator input is the applied torque $u$. The twin’s dynamics include nonlinear load torque and speed-dependent dissipation, given by\n$$\n\\dot{x} = f(x,u) = \\begin{pmatrix}\n\\omega \\\\\n\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\n\\end{pmatrix} + \\begin{pmatrix}\n0 \\\\\nw\n\\end{pmatrix},\n$$\nwhere $J>0$ is the inertia, $k>0$ is the load torque coefficient, $c>0$ is a dissipation coefficient, and $w$ is zero-mean Gaussian process noise with variance $\\sigma_w^2$, entering additively in the second state equation. The measurement function is a scalar nonlinear signal associated with vibration magnitude and encoder phase,\n$$\ny = h(x) + v = \\alpha\\,\\omega^{2} + \\beta\\,\\sin(\\theta) + v,\n$$\nwhere $\\alpha>0$ and $\\beta>0$ are known coefficients, and $v$ is zero-mean Gaussian measurement noise with variance $\\sigma_v^2$. The cyber-physical system’s digital twin uses the Extended Kalman Filter (EKF) to fuse sensor information with the model.\n\nStarting from first principles of first-order Taylor linearization and Gaussian uncertainty propagation used by the Extended Kalman Filter (EKF), do the following:\n\n$1.$ Derive the continuous-time Jacobian matrices $F(x,u) = \\frac{\\partial f}{\\partial x}$ and $H(x) = \\frac{\\partial h}{\\partial x}$ required for EKF linearization. Carefully justify the derivative of the term $\\omega\\,|\\omega|$ and state any conditions needed for differentiability.\n\n$2.$ Evaluate these Jacobians at a nominal operating point $(\\bar{\\theta},\\bar{\\omega})$ and input $\\bar{u}$, assuming $\\bar{\\omega}\\neq 0$.\n\n$3.$ Suppose a measurement update is performed at the operating point with prior state covariance\n$$\nP^{-}=\\begin{pmatrix}\np_{11} & p_{12} \\\\\np_{12} & p_{22}\n\\end{pmatrix}\n$$\nand measurement noise variance $R=\\sigma_v^2$. Using the EKF innovation model, derive the scalar innovation covariance $S$ at the operating point in terms of $(p_{11},p_{12},p_{22})$, $(\\bar{\\theta},\\bar{\\omega})$, and $(\\alpha,\\beta,\\sigma_v^2)$.\n\nYour final answer must be the closed-form analytic expression for $S$.",
            "solution": "The solution is derived in three parts as requested by the problem statement.\n\n#### 1. Derivation of Jacobian Matrices $F(x,u)$ and $H(x)$\n\nThe state vector is $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} \\theta \\\\ \\omega \\end{pmatrix}$.\n\nThe nonlinear state dynamics function is:\n$$\nf(x,u) = \\begin{pmatrix} f_1(x,u) \\\\ f_2(x,u) \\end{pmatrix} = \\begin{pmatrix}\nx_2 \\\\\n\\frac{1}{J}\\Big(u - k \\sin(x_1) - c\\,x_2\\,|x_2|\\Big)\n\\end{pmatrix}\n$$\nThe Jacobian matrix $F(x,u)$ is defined as $F = \\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1} & \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1} & \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}$. The partial derivatives are computed as follows:\n- $\\frac{\\partial f_1}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}(\\omega) = 0$\n- $\\frac{\\partial f_1}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}(\\omega) = 1$\n- $\\frac{\\partial f_2}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}\\left(\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\\right) = -\\frac{k}{J}\\cos(\\theta)$\n- $\\frac{\\partial f_2}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}\\left(\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\\right) = -\\frac{c}{J}\\frac{d}{d\\omega}(\\omega\\,|\\omega|)$\n\nTo evaluate the last derivative, we analyze the term $\\omega\\,|\\omega|$. This function can be expressed piecewise:\n$$\ng(\\omega) = \\omega\\,|\\omega| = \\begin{cases} \\omega^2 & \\text{if } \\omega \\ge 0 \\\\ -\\omega^2 & \\text{if } \\omega < 0 \\end{cases}\n$$\nThe derivative with respect to $\\omega$ is:\n$$\n\\frac{dg}{d\\omega} = \\begin{cases} 2\\omega & \\text{if } \\omega > 0 \\\\ -2\\omega & \\text{if } \\omega < 0 \\end{cases}\n$$\nThis can be written compactly as $2|\\omega|$. At $\\omega=0$, the right-hand derivative is $\\lim_{h\\to 0^+} \\frac{(0+h)^2}{h} = 0$, and the left-hand derivative is $\\lim_{h\\to 0^-} \\frac{-(0+h)^2}{h} = 0$. Since the left and right derivatives are equal, the function is differentiable at $\\omega=0$ with a derivative of $0$. Thus, $\\frac{d}{d\\omega}(\\omega\\,|\\omega|) = 2|\\omega|$ is valid for all $\\omega \\in \\mathbb{R}$. No special conditions on $\\omega$ are needed for differentiability.\n\nSubstituting this result, we find:\n$\\frac{\\partial f_2}{\\partial \\omega} = -\\frac{c}{J}(2|\\omega|) = -\\frac{2c|\\omega|}{J}$.\n\nAssembling the Jacobian matrix $F(x,u)$:\n$$\nF(x,u) = \\begin{pmatrix}\n0 & 1 \\\\\n-\\frac{k}{J}\\cos(\\theta) & -\\frac{2c|\\omega|}{J}\n\\end{pmatrix}\n$$\n\nNext, we find the Jacobian of the measurement function. The scalar measurement function is:\n$$\nh(x) = \\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta) = \\alpha\\,x_2^2 + \\beta\\,\\sin(x_1)\n$$\nThe measurement Jacobian $H(x)$ is a row vector defined as $H = \\frac{\\partial h}{\\partial x} = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1} & \\frac{\\partial h}{\\partial x_2} \\end{pmatrix}$. The partial derivatives are:\n- $\\frac{\\partial h}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}(\\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta)) = \\beta\\,\\cos(\\theta)$\n- $\\frac{\\partial h}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}(\\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta)) = 2\\alpha\\,\\omega$\n\nAssembling the measurement Jacobian $H(x)$:\n$$\nH(x) = \\begin{pmatrix} \\beta\\,\\cos(\\theta) & 2\\alpha\\,\\omega \\end{pmatrix}\n$$\n\n#### 2. Evaluation of Jacobians at the Nominal Operating Point\n\nWe evaluate $F(x,u)$ and $H(x)$ at the nominal operating point $(\\bar{x}, \\bar{u})$, where $\\bar{x} = (\\bar{\\theta}, \\bar{\\omega})$, under the condition $\\bar{\\omega} \\neq 0$. Let the evaluated Jacobians be denoted $\\bar{F}$ and $\\bar{H}$.\n\n$$\n\\bar{F} = F(\\bar{x},\\bar{u}) = \\begin{pmatrix}\n0 & 1 \\\\\n-\\frac{k}{J}\\cos(\\bar{\\theta}) & -\\frac{2c|\\bar{\\omega}|}{J}\n\\end{pmatrix}\n$$\n$$\n\\bar{H} = H(\\bar{x}) = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta}) & 2\\alpha\\,\\bar{\\omega} \\end{pmatrix}\n$$\n\n#### 3. Derivation of the Innovation Covariance $S$\n\nThe EKF innovation covariance, $S$, is calculated during the measurement update step. It represents the variance of the innovation (or residual), which is the difference between the actual measurement and the predicted measurement. The formula for $S$ is:\n$$\nS = H P^{-} H^T + R\n$$\nWe evaluate this at the operating point, using the linearized measurement matrix $\\bar{H}$.\n- The linearized measurement Jacobian is $\\bar{H} = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta}) & 2\\alpha\\,\\bar{\\omega} \\end{pmatrix}$.\n- The prior state covariance is $P^{-} = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$.\n- The measurement noise covariance is the scalar $R = \\sigma_v^2$.\n\nWe first compute the term $\\bar{H} P^{-} \\bar{H}^T$. This is a quadratic form.\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta}) & 2\\alpha\\,\\bar{\\omega} \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta}) \\\\ 2\\alpha\\,\\bar{\\omega} \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\n\\bar{H} P^{-} = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta})p_{11} + 2\\alpha\\,\\bar{\\omega}p_{12} & \\beta\\,\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\,\\bar{\\omega}p_{22} \\end{pmatrix}\n$$\nMultiplying by $\\bar{H}^T$:\n$$\n\\bar{H} P^{-} \\bar{H}^T = (\\beta\\,\\cos(\\bar{\\theta})p_{11} + 2\\alpha\\,\\bar{\\omega}p_{12})(\\beta\\,\\cos(\\bar{\\theta})) + (\\beta\\,\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\,\\bar{\\omega}p_{22})(2\\alpha\\,\\bar{\\omega})\n$$\nExpanding the terms:\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\beta^2\\cos^2(\\bar{\\theta})p_{11} + 2\\alpha\\beta\\,\\bar{\\omega}\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\beta\\,\\bar{\\omega}\\cos(\\bar{\\theta})p_{12} + 4\\alpha^2\\bar{\\omega}^2p_{22}\n$$\nCombining the cross-terms:\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\beta^2 p_{11} \\cos^2(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^2 p_{22} \\bar{\\omega}^2\n$$\nFinally, we add the measurement noise variance $R = \\sigma_v^2$ to obtain the innovation covariance $S$:\n$$\nS = \\beta^2 p_{11} \\cos^2(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^2 p_{22} \\bar{\\omega}^2 + \\sigma_v^2\n$$\nThis is the final closed-form expression for the scalar innovation covariance $S$ at the specified operating point.",
            "answer": "$$\\boxed{\\beta^{2} p_{11} \\cos^{2}(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^{2} p_{22} \\bar{\\omega}^{2} + \\sigma_v^{2}}$$"
        },
        {
            "introduction": "A digital twin's value in Industry 4.0 is often realized within a closed-loop control system, where insights from the twin drive real-time actions on the factory floor. The effectiveness of such a Cyber-Physical System hinges on meeting strict end-to-end latency deadlines. This exercise challenges you to think like a systems engineer, analyzing the entire sample-to-actuation pipeline—from sensing and networking to computation and actuation—and strategically allocating a time budget to ensure the system is not only accurate but also responsive enough for its critical task .",
            "id": "4217803",
            "problem": "A smart manufacturing Cyber-Physical System (CPS) employs a Digital Twin (DT) to close a fast feedback loop for in-line quality control under Industry 4.0 (I4.0) requirements. Each loop iteration traverses a four-stage pipeline: sensing, network transport, compute, and actuation. The end-to-end deadline per iteration is $5$ ms, and the plant stability margin requires the worst-case realized loop time to be tightly controlled by allocating a delay budget to each stage.\n\nAssume the following scientifically realistic parameters for one loop iteration:\n- Sensing: An Analog-to-Digital Conversion (ADC) acquires $N_{s} = 1024$ samples at a sustained throughput $R_{\\mathrm{adc}} = 1.28 \\times 10^{6}$ samples/s after a front-end settling time $\\tau_{\\mathrm{sens}} = 0.35$ ms.\n- Network: A single packet of size $S = 16384$ bits is transmitted over a link with capacity $C = 10 \\times 10^{6}$ bits/s, over fiber of length $d = 150$ m with signal speed $v = 2.0 \\times 10^{8}$ m/s. Packet arrivals into the output queue are Poisson with rate $\\lambda = 150$ packets/s, and the link services packets with exponential service times at rate $\\mu = C/S$ packets/s (that is, an M/M/1 queue).\n- Compute: The DT inference and model update require $O = 10^{6}$ floating-point operations, implemented with $c_{\\mathrm{op}} = 3$ cycles per operation on a processor with clock $f = 3.0 \\times 10^{9}$ cycles/s.\n- Actuation: A Digital-to-Analog Conversion (DAC) outputs $N_{a} = 300$ samples at $R_{\\mathrm{dac}} = 2.0 \\times 10^{6}$ samples/s, followed by actuator settling $\\tau_{\\mathrm{act}} = 0.25$ ms.\n\nLet the dominant stochastic jitter in each stage be modeled by independent zero-mean sub-Gaussian fluctuations with standard deviations $\\sigma_{\\mathrm{sens}} = 0.08$ ms, $\\sigma_{\\mathrm{net}} = 0.15$ ms, $\\sigma_{\\mathrm{comp}} = 0.04$ ms, and $\\sigma_{\\mathrm{act}} = 0.02$ ms. Your design objective is to choose stage budgets $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, and $B_{\\mathrm{act}}$ such that:\n1. The sum of the budgets equals the end-to-end target, $\\sum B_{i} = 5$ ms.\n2. Each budget $B_{i}$ consists of the stage’s deterministic expected delay plus an added slack $s_{i}$ to absorb jitter, $B_{i} = t_{i} + s_{i}$.\n3. The slack allocation maximizes the minimum standardized margin $\\min_{i} \\left( s_{i}/\\sigma_{i} \\right)$ across the four stages, ensuring balanced robustness under tail bounds consistent with the one-sided Chebyshev inequality for sub-Gaussian noise.\n\nStarting only from fundamental rate-time definitions (time equals workload divided by throughput), physical propagation relations, and well-tested queueing results for M/M/1 systems, derive the deterministic expected delays $t_{\\mathrm{sens}}$, $t_{\\mathrm{net}}$, $t_{\\mathrm{comp}}$, and $t_{\\mathrm{act}}$. Then solve the slack optimization and report the resulting budgets $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, and $B_{\\mathrm{act}}$ that meet the $5$ ms target and the robustness criterion above. Express each budget in milliseconds and round your final numerical values to four significant figures. The final answer must be a single row matrix ordered as $\\left( B_{\\mathrm{sens}}, B_{\\mathrm{net}}, B_{\\mathrm{comp}}, B_{\\mathrm{act}} \\right)$.",
            "solution": "The problem requires us to determine the time budgets for four sequential stages of a cyber-physical control loop, denoted $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, and $B_{\\mathrm{act}}$. The total budget must sum to an end-to-end deadline of $T_{\\mathrm{total}} = 5$ ms. Each stage budget $B_i$ is composed of a deterministic expected delay $t_i$ and a slack time $s_i$, such that $B_i = t_i + s_i$. The slack is allocated to provide robustness against timing jitter, characterized by a standard deviation $\\sigma_i$ for each stage. The allocation must maximize the minimum standardized margin, $\\min_{i} (s_i / \\sigma_i)$, across all stages.\n\nThe solution proceeds in three parts:\n1.  Calculation of the deterministic expected delay $t_i$ for each of the four stages.\n2.  Formulation and solution of the slack allocation optimization problem.\n3.  Calculation of the final stage budgets $B_i$.\n\n**Part 1: Calculation of Deterministic Delays ($t_i$)**\n\nWe calculate the deterministic delay for each stage based on the provided parameters and fundamental principles. All calculations will be performed in SI units (seconds, meters, bits, etc.), with final results converted to milliseconds (ms) where appropriate.\n\n**1. Sensing Delay ($t_{\\mathrm{sens}}$)**\nThe total sensing delay is the sum of the ADC acquisition time and the front-end settling time $\\tau_{\\mathrm{sens}}$. The acquisition time is the number of samples $N_s$ divided by the sampling rate $R_{\\mathrm{adc}}$.\n$$t_{\\mathrm{sens}} = \\frac{N_{s}}{R_{\\mathrm{adc}}} + \\tau_{\\mathrm{sens}}$$\nGiven $N_{s} = 1024$, $R_{\\mathrm{adc}} = 1.28 \\times 10^{6}$ samples/s, and $\\tau_{\\mathrm{sens}} = 0.35$ ms $= 0.35 \\times 10^{-3}$ s:\n$$t_{\\mathrm{sens}} = \\frac{1024}{1.28 \\times 10^{6} \\text{ s}^{-1}} + 0.35 \\times 10^{-3} \\text{ s} = 0.8 \\times 10^{-3} \\text{ s} + 0.35 \\times 10^{-3} \\text{ s} = 1.15 \\times 10^{-3} \\text{ s} = 1.15 \\text{ ms}$$\n\n**2. Network Delay ($t_{\\mathrm{net}}$)**\nThe network delay comprises propagation delay and time spent in the M/M/1 queuing system (queuing delay plus service time).\nThe propagation delay is the fiber length $d$ divided by the signal speed $v$.\n$$t_{\\mathrm{prop}} = \\frac{d}{v} = \\frac{150 \\text{ m}}{2.0 \\times 10^{8} \\text{ m/s}} = 0.75 \\times 10^{-6} \\text{ s}$$\nThe system is modeled as an M/M/1 queue with arrival rate $\\lambda = 150$ packets/s. The service rate $\\mu$ is the link capacity $C$ divided by the packet size $S$.\n$$\\mu = \\frac{C}{S} = \\frac{10 \\times 10^{6} \\text{ bits/s}}{16384 \\text{ bits/packet}} = \\frac{10000000}{16384} \\text{ s}^{-1} \\approx 610.35 \\text{ s}^{-1}$$\nThe expected time spent in an M/M/1 system (sojourn time), $W$, which includes both waiting in the queue and being serviced, is given by:\n$$W = \\frac{1}{\\mu - \\lambda}$$\nThe total expected network delay $t_{\\mathrm{net}}$ is the sum of propagation delay and sojourn time.\n$$t_{\\mathrm{net}} = t_{\\mathrm{prop}} + W = \\frac{d}{v} + \\frac{1}{\\mu - \\lambda}$$\nSubstituting the values:\n$$t_{\\mathrm{net}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{1}{\\frac{10 \\times 10^{6}}{16384} \\text{ s}^{-1} - 150 \\text{ s}^{-1}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{10 \\times 10^{6} - 150 \\times 16384} \\text{ s}$$\n$$t_{\\mathrm{net}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{10000000 - 2457600} \\text{ s} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{7542400} \\text{ s}$$\n$$t_{\\mathrm{net}} \\approx 0.00000075 \\text{ s} + 0.00217224 \\text{ s} \\approx 0.00217299 \\text{ s} = 2.17299 \\text{ ms}$$\n\n**3. Compute Delay ($t_{\\mathrm{comp}}$)**\nThe compute delay is the total number of processor cycles required divided by the processor's clock frequency $f$. The total cycles are the number of operations $O$ multiplied by the cycles per operation $c_{\\mathrm{op}}$.\n$$t_{\\mathrm{comp}} = \\frac{O \\times c_{\\mathrm{op}}}{f}$$\nGiven $O = 10^{6}$ operations, $c_{\\mathrm{op}} = 3$ cycles/operation, and $f = 3.0 \\times 10^{9}$ cycles/s:\n$$t_{\\mathrm{comp}} = \\frac{10^{6} \\times 3}{3.0 \\times 10^{9} \\text{ s}^{-1}} = \\frac{3 \\times 10^{6}}{3 \\times 10^{9}} \\text{ s} = 1.0 \\times 10^{-3} \\text{ s} = 1.00 \\text{ ms}$$\n\n**4. Actuation Delay ($t_{\\mathrm{act}}$)**\nThe actuation delay is the sum of the DAC output time and the actuator settling time $\\tau_{\\mathrm{act}}$. The output time is the number of samples $N_a$ divided by the output rate $R_{\\mathrm{dac}}$.\n$$t_{\\mathrm{act}} = \\frac{N_{a}}{R_{\\mathrm{dac}}} + \\tau_{\\mathrm{act}}$$\nGiven $N_{a} = 300$, $R_{\\mathrm{dac}} = 2.0 \\times 10^{6}$ samples/s, and $\\tau_{\\mathrm{act}} = 0.25$ ms $= 0.25 \\times 10^{-3}$ s:\n$$t_{\\mathrm{act}} = \\frac{300}{2.0 \\times 10^{6} \\text{ s}^{-1}} + 0.25 \\times 10^{-3} \\text{ s} = 0.15 \\times 10^{-3} \\text{ s} + 0.25 \\times 10^{-3} \\text{ s} = 0.40 \\times 10^{-3} \\text{ s} = 0.40 \\text{ ms}$$\n\n**Part 2: Slack Allocation Optimization**\n\nThe total deterministic delay is the sum of the individual stage delays:\n$$\\sum_{i} t_i = t_{\\mathrm{sens}} + t_{\\mathrm{net}} + t_{\\mathrm{comp}} + t_{\\mathrm{act}}$$\n$$\\sum_{i} t_i \\approx 1.15 + 2.17299 + 1.00 + 0.40 = 4.72299 \\text{ ms}$$\nThe total available slack for all stages, $S_{\\mathrm{total}}$, is the difference between the end-to-end deadline and the total deterministic delay:\n$$S_{\\mathrm{total}} = T_{\\mathrm{total}} - \\sum_{i} t_i = 5 \\text{ ms} - 4.72299 \\text{ ms} = 0.27701 \\text{ ms}$$\nThe objective is to maximize $k = \\min_{i} (s_i / \\sigma_i)$, subject to the constraint that the sum of slacks equals the total available slack: $\\sum_{i} s_i = S_{\\mathrm{total}}$.\nTo maximize the minimum of a set of non-negative ratios whose numerators have a fixed sum, the optimal solution is achieved when all ratios are equal. Thus, we set $s_i / \\sigma_i = k$ for all $i$.\nThis implies $s_i = k \\sigma_i$. Substituting this into the sum constraint:\n$$\\sum_{i} s_i = \\sum_{i} (k \\sigma_i) = k \\sum_{i} \\sigma_i = S_{\\mathrm{total}}$$\nWe can solve for the optimal standardized margin $k$:\n$$k = \\frac{S_{\\mathrm{total}}}{\\sum_{i} \\sigma_i}$$\nThe standard deviations are given as $\\sigma_{\\mathrm{sens}} = 0.08$ ms, $\\sigma_{\\mathrm{net}} = 0.15$ ms, $\\sigma_{\\mathrm{comp}} = 0.04$ ms, and $\\sigma_{\\mathrm{act}} = 0.02$ ms. Their sum is:\n$$\\sum_{i} \\sigma_i = 0.08 + 0.15 + 0.04 + 0.02 = 0.29 \\text{ ms}$$\nNow, we calculate $k$:\n$$k = \\frac{0.27701 \\text{ ms}}{0.29 \\text{ ms}} \\approx 0.955203586$$\n\n**Part 3: Calculation of Final Budgets ($B_i$)**\n\nThe budget for each stage is $B_i = t_i + s_i = t_i + k \\sigma_i$. We use the unrounded values for $t_i$ and the calculated value of $k$ for precision.\n\n$$B_{\\mathrm{sens}} = t_{\\mathrm{sens}} + k \\sigma_{\\mathrm{sens}} \\approx 1.15 \\text{ ms} + (0.955203586 \\times 0.08 \\text{ ms}) \\approx 1.15 + 0.076416 = 1.226416 \\text{ ms}$$\n$$B_{\\mathrm{net}} = t_{\\mathrm{net}} + k \\sigma_{\\mathrm{net}} \\approx 2.17299 \\text{ ms} + (0.955203586 \\times 0.15 \\text{ ms}) \\approx 2.17299 + 0.143281 = 2.316271 \\text{ ms}$$\n$$B_{\\mathrm{comp}} = t_{\\mathrm{comp}} + k \\sigma_{\\mathrm{comp}} = 1.00 \\text{ ms} + (0.955203586 \\times 0.04 \\text{ ms}) \\approx 1.00 + 0.038208 = 1.038208 \\text{ ms}$$\n$$B_{\\mathrm{act}} = t_{\\mathrm{act}} + k \\sigma_{\\mathrm{act}} = 0.40 \\text{ ms} + (0.955203586 \\times 0.02 \\text{ ms}) \\approx 0.40 + 0.019104 = 0.419104 \\text{ ms}$$\n\nFinally, we round these budget values to four significant figures as requested.\n$B_{\\mathrm{sens}} \\approx 1.226$ ms\n$B_{\\mathrm{net}} \\approx 2.316$ ms\n$B_{\\mathrm{comp}} \\approx 1.038$ ms\n$B_{\\mathrm{act}} \\approx 0.4191$ ms\n\nThe final answer is the row matrix of these rounded budget values.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.226 & 2.316 & 1.038 & 0.4191\n\\end{pmatrix}\n}\n$$"
        }
    ]
}