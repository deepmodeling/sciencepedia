{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的诊断任务之前，我们必须首先掌握因果图的基本语言。这个练习的核心是 d-分离 (d-separation) 准则，它是一套图形规则，使我们能够直接从因果图中推断出变量之间的条件独立关系。熟练运用 d-分离是至关重要的，因为它构成了所有高级因果推断技术（如识别混杂因素和中介变量）的理论基础 。",
            "id": "4207427",
            "problem": "一个信息物理生产线的数字孪生被用于诊断振动异常并进行根本原因分析。该孪生的结构因果图是一个有向无环图，包含三个节点，形成一个单链：执行器指令 $A$（上游电机扭矩设定值）、内部动态状态 $B$（轴角加速度）和下游传感器 $C$（末端执行器振动幅度），箭头方向为 $A \\rightarrow B \\rightarrow C$。仅从有向无环图、d-分离和因果马尔可夫性质的定义出发，完成以下任务：\n- 枚举由d-分离所蕴含的、在 $\\{A,B,C\\}$ 中所有不同的、非平凡的条件独立关系的集合 $\\mathcal{S}$。“非平凡”意味着独立关系的任意一方都不包含另一方，条件集不包含被声明独立的变量，且该陈述不是重言式的。\n- 令 $I(A;C \\mid B)$ 表示在任何相对于给定图是马尔可夫的联合分布 $p(A,B,C)$ 下，$A$ 和 $C$ 在给定 $B$ 时的条件互信息（以纳特为单位）。计算 $I(A;C \\mid B)$ 的精确值。\n\n将最终答案表示为一个实数。无需四舍五入。",
            "solution": "用户提供的问题首先经过一个严格的验证过程。\n\n### 第1步：提取已知条件\n-   **系统**：由数字孪生表示的信息物理生产线。\n-   **因果结构**：一个有向无环图（DAG），包含三个节点：$A$（执行器指令）、$B$（内部动态状态）和 $C$（下游传感器）。\n-   **图拓扑**：一个单链结构：$A \\rightarrow B \\rightarrow C$。\n-   **假设**：解答必须从有向无环图（DAG）、d-分离和因果马尔可夫性质的定义出发。\n-   **任务1**：枚举由d-分离所蕴含的、在 $\\{A,B,C\\}$ 中所有不同的、非平凡的条件独立关系的集合 $\\mathcal{S}$。\n-   **“非平凡”的定义**：\n    1.  独立关系的任意一方都不包含另一方。\n    2.  条件集不包含被声明独立的变量。\n    3.  该陈述不是重言式的。\n-   **任务2**：对于任何相对于给定图是马尔可夫的联合分布 $p(A,B,C)$，计算条件互信息 $I(A;C \\mid B)$ 的精确值（以纳特为单位）。\n-   **任务2的输出要求**：一个实数。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于因果推断（结构因果模型、有向无环图、d-分离）和信息论（互信息）的既定数学形式体系。这些是统计学、计算机科学和工程学中用于分析数字孪生等系统的标准工具。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。因果图被明确定义（$A \\rightarrow B \\rightarrow C$）。任务陈述清晰，并依赖于标准的、无歧义的定义（d-分离、因果马尔可夫性质、条件互信息）。提供了构成“非平凡”关系的约束条件，确保了第一个任务有唯一答案。第二个任务要求计算一个值，该值是前提的直接且必然的推论。存在一个唯一的、稳定的、有意义的解。\n-   **客观性**：语言正式、精确，没有任何主观或模糊的术语。\n\n### 第3步：结论与行动\n该问题被判定为**有效**，因为它具有科学依据、适定性和客观性。它不包含逻辑矛盾、缺失信息或其他致命缺陷。现在开始解题过程。\n\n### 解题推导\n\n按照要求，问题分两部分解决。\n\n#### 第1部分：枚举条件独立关系\n\n给定的因果结构是一个有向无环图（DAG），表示为链 $A \\rightarrow B \\rightarrow C$。该图所蕴含的条件独立关系由d-分离准则确定。如果从节点集 $X$ 中的一个节点到节点集 $Y$ 中的一个节点的每条路径都被节点集 $Z$ “阻断”，则称 $X$ 和 $Y$ 被 $Z$ d-分离（记作 $X \\perp_g Y \\mid Z$）。一条路径如果包含以下情况之一，则被认为是阻断的：\n1.  一个链 $I \\rightarrow M \\rightarrow J$ 或一个分叉 $I \\leftarrow M \\rightarrow J$，其中中间节点 $M$ 属于条件集 $Z$。\n2.  一个对撞 $I \\rightarrow M \\leftarrow J$，其中中间节点 $M$ 及其所有后代都**不**在条件集 $Z$ 中。\n\n我们必须检验集合 $\\{A, B, C\\}$ 中所有不同变量对之间的独立性。\n\n-   **变量对 $\\{A, B\\}$**：在 $A$ 和 $B$ 之间有一条路径，即直接边 $A \\rightarrow B$。直接边永远不能被任何不包含 $A$ 或 $B$ 的条件集 $Z$ 阻断。因此，$A$ 和 $B$ 永远不会被d-分离。$A \\not\\perp_g B \\mid \\emptyset$ 且 $A \\not\\perp_g B \\mid C$。没有蕴含独立关系。\n\n-   **变量对 $\\{B, C\\}$**：与前一种情况类似，唯一的路径是直接边 $B \\rightarrow C$。它不能被任何有效的条件集阻断。因此，$B$ 和 $C$ 永远不会被d-分离。$B \\not\\perp_g C \\mid \\emptyset$ 且 $B \\not\\perp_g C \\mid A$。没有蕴含独立关系。\n\n-   **变量对 $\\{A, C\\}$**：在 $A$ 和 $C$ 之间有一条路径：$A \\rightarrow B \\rightarrow C$。这条路径是一个以 $B$ 为中间节点的链。\n    -   **以空集 ($\\emptyset$) 为条件**：条件集为 $Z = \\emptyset$。中间节点 $B$ 不在 $Z$ 中。根据规则1，路径未被阻断。因此，$A$ 和 $C$ **不**被空集d-分离：$A \\not\\perp_g C \\mid \\emptyset$。\n    -   **以节点 $B$ 为条件**：条件集为 $Z = \\{B\\}$。路径是 $A \\rightarrow B \\rightarrow C$。中间节点 $B$ 在条件集 $Z$ 中。根据规则1，路径被阻断。由于这是 $A$ 和 $C$ 之间的唯一路径，我们得出结论，$A$ 和 $C$ 被 $B$ d-分离：$A \\perp_g C \\mid B$。\n\n我们找到了一个独立关系：$A \\perp_g C \\mid B$。现在我们根据给定的标准检查它是否是“非平凡”的。\n1.  `独立关系的任意一方都不包含另一方`：涉及的集合是 $\\{A\\}$ 和 $\\{C\\}$。此条件满足。\n2.  `条件集不包含被声明独立的变量`：条件集是 $\\{B\\}$，它既不包含 $A$ 也不包含 $C$。此条件满足。\n3.  `该陈述不是重言式的`：该陈述断言了两个不同变量 $A$ 和 $C$ 之间的独立性，这是一个关于系统结构的非重言式声明。此条件满足。\n\n关系 $A \\perp C \\mid B$ 是该图蕴含的唯一非平凡独立关系。注意，关系 $C \\perp A \\mid B$ 是相同的。因此，不同的、非平凡的条件独立关系集合 $\\mathcal{S}$ 只包含一个元素。\n$\\mathcal{S} = \\{ (A \\perp C \\mid B) \\}$\n\n#### 第2部分：条件互信息的计算\n\n第二个任务是计算条件互信息 $I(A; C \\mid B)$ 的值（以纳特为单位）。这需要援引因果马尔可夫性质。\n\n**因果马尔可夫性质**指出，对于一个相对于有向无环图 $G$ 是马尔可夫的分布 $p$，如果在 $G$ 中两个节点 $X$ 和 $Y$ 被节点集 $Z$ d-分离（$X \\perp_g Y \\mid Z$），那么在分布 $p$ 中，$X$ 和 $Y$ 在给定 $Z$ 的条件下是条件独立的（$X \\perp_p Y \\mid Z$）。\n\n从第1部分中，我们确定了d-分离关系 $A \\perp_g C \\mid B$。由于给定的分布 $p(A,B,C)$ 相对于图 $A \\rightarrow B \\rightarrow C$ 是马尔可夫的，因此因果马尔可夫性质蕴含了统计上的条件独立性：\n$$A \\perp C \\mid B$$\n这种统计独立性意味着，给定 $B$ 时 $A$ 和 $C$ 的联合条件概率可以分解为各自条件概率的乘积：\n$$p(A, C \\mid B) = p(A \\mid B) p(C \\mid B)$$\n\n条件互信息 $I(A; C \\mid B)$ 定义为联合条件分布 $p(A,C|B)$ 与边际条件分布的乘积 $p(A|B)p(C|B)$ 之间的库尔贝克-莱布勒散度。在连续情况下，其公式（以纳特为单位）为：\n$$ I(A; C \\mid B) = \\int p(a,b,c) \\ln\\left( \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} \\right) da \\, db \\, dc $$\n或者，使用条件概率的定义 $p(a,b,c) = p(a,c|b)p(b)$：\n$$ I(A; C \\mid B) = \\int p(b) \\left[ \\int p(a,c|b) \\ln\\left( \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} \\right) da \\, dc \\right] db $$\n由于条件独立性 $A \\perp C \\mid B$，我们有 $p(a, c \\mid b) = p(a \\mid b) p(c \\mid b)$ 对所有值 $a, b, c$ 成立。将此代入对数内的分数，得到：\n$$ \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} = \\frac{p(a \\mid b) p(c \\mid b)}{p(a \\mid b) p(c \\mid b)} = 1 $$\n$1$ 的自然对数是 $0$：\n$$ \\ln(1) = 0 $$\n因此，条件互信息的表达式变为：\n$$ I(A; C \\mid B) = \\int p(a,b,c) \\ln(1) da \\, db \\, dc = \\int p(a,b,c) \\cdot 0 \\, da \\, db \\, dc = 0 $$\n这个结果对于任何相对于给定图是马尔可夫的分布 $p(A,B,C)$ 都成立，无论变量是离散的还是连续的，也无论具体的函数关系是什么。条件独立性本身就等价于条件互信息为零。\n\n$I(A; C \\mid B)$ 的精确值是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在现实世界的系统中，“相关不等于因果”是一个普遍的挑战，其根源通常在于混杂变量的存在。本练习将直接应对这一核心问题，您将运用因果推断的基石——后门调整 (backdoor adjustment) 公式，通过对一个可观测的混杂因素进行调整，来估算一个干预措施的真实因果效应。这个练习提供了一种具体的、定量的方法，帮助我们从观测数据中提炼出可用于决策的因果结论，这对于系统诊断和根因分析至关重要 。",
            "id": "4207465",
            "problem": "一个嵌入在信息物理系统（CPS）中的智能水泵的数字孪生，监控一个二元执行器设置 $X \\in \\{0,1\\}$ 和一个二元故障指示器 $Y \\in \\{0,1\\}$。环境条件 $Z$ 取三个离散水平 $Z \\in \\{z_0, z_1, z_2\\}$，代表影响所选执行器设置 $X$ 和故障可能性 $Y$ 的环境状况，这使得 $Z$ 成为 $X \\rightarrow Y$ 关系的一个混淆因子。其因果结构为 $Z$到$X$和$Y$均有有向箭头，且$X$到$Y$有有向箭头。假设相对于 $X$ 对 $Y$ 的因果效应，$Z$ 满足后门准则，并且干预 $do(X=1)$ 对应于将 $X$ 设置为 $1$ 同时保持生成 $Z$ 的机制不变。\n\n在每个环境条件水平下，条件故障概率的观测模型由一个逻辑斯蒂链接指定：\n$$\nP(Y=1 \\mid X=x, Z=z_k) \\;=\\; \\sigma\\!\\left(\\alpha_k + \\beta_k x\\right),\n$$\n其中 $\\sigma(t) = \\frac{1}{1 + \\exp(-t)}$，参数为\n$$\n\\alpha_0 = -2, \\quad \\beta_0 = 0.5; \\qquad \\alpha_1 = -1.5, \\quad \\beta_1 = 0.8; \\qquad \\alpha_2 = -1.0, \\quad \\beta_2 = 0.2.\n$$\n环境条件的分布为\n$$\nP(Z=z_0) = 0.2, \\qquad P(Z=z_1) = 0.5, \\qquad P(Z=z_2) = 0.3.\n$$\n\n使用因果推断中干预和后门准则的基本定义，从第一性原理出发，推导 $P(Y=1 \\mid do(X=1))$ 的表达式，并在给定模型下进行数值计算。将最终概率四舍五入到四位有效数字，并以小数形式表示。",
            "solution": "该问题要求计算一个干预概率 $P(Y=1 \\mid do(X=1))$，它表示如果执行器设置被强制为 $X=1$ 时，系统发生故障（$Y=1$）的概率。这个量不同于观测条件概率 $P(Y=1 \\mid X=1)$，因为后者会受到混淆变量 $Z$（环境条件）的影响。问题陈述因果结构由 $Z \\rightarrow X$、$Z \\rightarrow Y$ 和 $X \\rightarrow Y$ 给出，并且相对于 $X$ 对 $Y$ 的因果效应，$Z$ 满足后门准则。这使我们能够使用后门调整公式从观测数据中计算干预概率。\n\n我们从第一性原理推导该公式。干预 $do(X=x)$ 对应于修改潜在的因果系统，方法是移除所有指向 $X$ 的箭头并将 $X$ 设置为常数值 $x$。在这个修改后的系统中，概率分布表示为 $P_{do(X=x)}(\\cdot)$。我们感兴趣的量是 $P(Y=1 \\mid do(X=1))$，其定义为 $P_{do(X=1)}(Y=1)$。\n\n为了计算这个值，我们可以对混淆变量 $Z$进行边缘化：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P_{do(X=x)}(Y=y, Z=z) $$\n根据概率的链式法则，这变为：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P_{do(X=x)}(Y=y \\mid Z=z) P_{do(X=x)}(Z=z) $$\n对 $X$ 的干预不影响生成 $Z$ 的因果机制，因为在因果图中 $Z$ 不是 $X$ 的后代。因此，$Z$ 的分布保持不变：\n$$ P_{do(X=x)}(Z=z) = P(Z=z) $$\n此外，干预 $do(X=x)$ 将 $X$ 的值设为 $x$。从其直接原因 $X$ 和 $Z$ 决定 $Y$ 的机制保持不变。因此，在给定 $X$ 和 $Z$ 的情况下，$Y$ 的条件概率在干预和观测两种机制下是相同的：\n$$ P_{do(X=x)}(Y=y \\mid Z=z) = P(Y=y \\mid X=x, Z=z) $$\n将这两个等价关系代回到求和中，得到后门调整公式：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P(Y=y \\mid X=x, Z=z) P(Z=z) $$\n该公式允许通过调整 $Z$ 的混淆效应来估计 $X$ 对 $Y$ 的因果效应。\n\n对于这个具体问题，我们被要求计算 $P(Y=1 \\mid do(X=1))$。我们将 $y=1$ 和 $x=1$ 应用于该公式，并对 $Z$ 的三个离散水平 $Z \\in \\{z_0, z_1, z_2\\}$ 进行求和：\n$$ P(Y=1 \\mid do(X=1)) = \\sum_{k=0}^{2} P(Y=1 \\mid X=1, Z=z_k) P(Z=z_k) $$\n展开求和项得到：\n\\begin{align*} P(Y=1 \\mid do(X=1)) =  P(Y=1 \\mid X=1, Z=z_0) P(Z=z_0) \\\\  + P(Y=1 \\mid X=1, Z=z_1) P(Z=z_1) \\\\  + P(Y=1 \\mid X=1, Z=z_2) P(Z=z_2) \\end{align*}\n问题提供了必要的模型组成部分：\n条件概率模型为 $P(Y=1 \\mid X=x, Z=z_k) = \\sigma(\\alpha_k + \\beta_k x)$，其中 $\\sigma(t) = \\frac{1}{1 + \\exp(-t)}$。\n参数为：\n- 对于 $z_0$：$\\alpha_0 = -2$, $\\beta_0 = 0.5$\n- 对于 $z_1$：$\\alpha_1 = -1.5$, $\\beta_1 = 0.8$\n- 对于 $z_2$：$\\alpha_2 = -1.0$, $\\beta_2 = 0.2$\n$Z$ 的分布为：\n- $P(Z=z_0) = 0.2$\n- $P(Z=z_1) = 0.5$\n- $P(Z=z_2) = 0.3$\n\n首先，我们计算 $X=1$ 时的条件概率：\n\\begin{itemize}\n    \\item 对于 $Z=z_0$：$P(Y=1 \\mid X=1, Z=z_0) = \\sigma(\\alpha_0 + \\beta_0 \\cdot 1) = \\sigma(-2 + 0.5) = \\sigma(-1.5)$\n    \\item 对于 $Z=z_1$：$P(Y=1 \\mid X=1, Z=z_1) = \\sigma(\\alpha_1 + \\beta_1 \\cdot 1) = \\sigma(-1.5 + 0.8) = \\sigma(-0.7)$\n    \\item 对于 $Z=z_2$：$P(Y=1 \\mid X=1, Z=z_2) = \\sigma(\\alpha_2 + \\beta_2 \\cdot 1) = \\sigma(-1.0 + 0.2) = \\sigma(-0.8)$\n\\end{itemize}\nsigmoid函数值为：\n\\begin{itemize}\n    \\item $\\sigma(-1.5) = \\frac{1}{1 + \\exp(1.5)}$\n    \\item $\\sigma(-0.7) = \\frac{1}{1 + \\exp(0.7)}$\n    \\item $\\sigma(-0.8) = \\frac{1}{1 + \\exp(0.8)}$\n\\end{itemize}\n现在，我们将这些表达式和 $Z$ 的概率代入调整公式：\n$$ P(Y=1 \\mid do(X=1)) = \\sigma(-1.5) P(Z=z_0) + \\sigma(-0.7) P(Z=z_1) + \\sigma(-0.8) P(Z=z_2) $$\n$$ P(Y=1 \\mid do(X=1)) = \\left(\\frac{1}{1 + \\exp(1.5)}\\right) (0.2) + \\left(\\frac{1}{1 + \\exp(0.7)}\\right) (0.5) + \\left(\\frac{1}{1 + \\exp(0.8)}\\right) (0.3) $$\n我们进行数值计算：\n\\begin{itemize}\n    \\item $\\exp(1.5) \\approx 4.481689$，所以 $\\sigma(-1.5) \\approx \\frac{1}{1 + 4.481689} \\approx 0.1824255$\n    \\item $\\exp(0.7) \\approx 2.013753$，所以 $\\sigma(-0.7) \\approx \\frac{1}{1 + 2.013753} \\approx 0.3318122$\n    \\item $\\exp(0.8) \\approx 2.225541$，所以 $\\sigma(-0.8) \\approx \\frac{1}{1 + 2.225541} \\approx 0.3099904$\n\\end{itemize}\n代入这些值：\n$$ P(Y=1 \\mid do(X=1)) \\approx (0.1824255)(0.2) + (0.3318122)(0.5) + (0.3099904)(0.3) $$\n$$ P(Y=1 \\mid do(X=1)) \\approx 0.0364851 + 0.1659061 + 0.09299712 $$\n$$ P(Y=1 \\mid do(X=1)) \\approx 0.29538832 $$\n根据要求将最终结果四舍五入到四位有效数字，得到 $0.2954$。",
            "answer": "$$ \\boxed{0.2954} $$"
        },
        {
            "introduction": "如果我们面临一个关键混杂变量无法被观测到的情况，应该如何处理？这个练习探讨了一种在如此具有挑战性但又普遍存在的场景下进行因果推断的强大技术。您将使用前门准则 (front-door criterion)，通过巧妙地利用一个中介变量，来估算一个干预的因果效应，即便我们无法直接对未观测到的混杂因素进行调整。这个高级问题展示了对因果结构的深刻理解如何能够帮助我们解决那些使用传统统计方法看似无法攻克的难题 。",
            "id": "4207440",
            "problem": "一个用于控制半导体生产线中冷却剂流量的信息物理系统 (CPS) 的数字孪生被用来诊断过热事件。控制器发出一个离散的阀门指令信号 $X \\in \\{0,1\\}$，其中 $X=0$ 表示低开度，$X=1$ 表示高开度。一个下游流量传感器测量一个二元中介变量 $M \\in \\{0,1\\}$，其中 $M=1$ 表明达到了预期的高流量状态。一个过热指示器 $Y \\in \\{0,1\\}$ 被记录下来，其中 $Y=1$ 表示发生过热事件。存在一个未观测到的扰动 $U$，它代表了潜在的负载波动，该扰动对 $X$ 和 $Y$ 都有因果影响，但对 $M$ 没有影响。因果结构由一个有向无环图 (DAG) 表示，其中箭头为 $X \\rightarrow M \\rightarrow Y$，并且存在一个未观测到的 $U$，使得 $U \\rightarrow X$ 和 $U \\rightarrow Y$，但 $U$ 不会引起 $M$。\n\n在观测层面，该数字孪生从历史数据中估计出以下三个分布族：\n- 中介模型 $P(m \\mid x)$:\n  - $P(M=1 \\mid X=0) = 0.2$ 且 $P(M=1 \\mid X=1) = 0.8$。\n- 以中介变量和指令为条件的输出模型 $P(y \\mid m, x')$:\n  - $P(Y=1 \\mid M=0, X=0) = 0.1$， $P(Y=1 \\mid M=1, X=0) = 0.5$，\n  - $P(Y=1 \\mid M=0, X=1) = 0.3$， $P(Y=1 \\mid M=1, X=1) = 0.9$。\n- 指令的边缘分布 $P(x')$:\n  - $P(X=1) = 0.6$，所以 $P(X=0) = 0.4$。\n\n假设此有向无环图 (DAG) 中用于因果识别的所有标准正则性条件均成立，包括支撑集上的正性、因果马尔可夫假设和忠实性假设。使用干预算子 $do(\\cdot)$ 的定义和因果图模型的规则，从第一性原理推导出一个干预概率 $P(Y=1 \\mid do(X=1))$ 的表达式，该表达式尽管存在未观测的混杂因子 $U$，但仍可通过中介变量 $M$ 进行识别。然后，仅使用提供的分布 $\\{P(m \\mid x), P(y \\mid m,x'), P(x')\\}$ 计算其数值。将最终概率表示为精确小数。",
            "solution": "该问题是有效的。这是一个因果推断中的适定问题，它有科学依据、客观，并包含足够的信息以得到唯一解。所需的假设已明确说明。\n\n目标是计算干预概率 $P(Y=1 \\mid do(X=1))$，它表示如果通过外部干预将阀门指令设置为高开度 ($X=1$)，发生过热事件 ($Y=1$) 的概率。\n\n因果结构由一个包含变量 $X$（指令）、$M$（中介变量）、$Y$（结果）和未观测混杂因子 $U$ 的有向无环图 (DAG) 描述。因果路径为 $X \\rightarrow M \\rightarrow Y$，其中 $U$ 通过路径 $U \\rightarrow X$ 和 $U \\rightarrow Y$ 引入了混杂。通过观测条件概率 $P(Y=1 \\mid X=1)$ 直接计算 $X$ 对 $Y$ 的因果效应是不正确的，因为存在混杂的后门路径 $X \\leftarrow U \\rightarrow Y$。干预 $do(X=1)$ 会移除 $U \\rightarrow X$ 这条箭头，但由于 $U$ 是未观测的，我们无法使用标准的后门准则直接对其进行调整。\n\n然而，该问题可以使用前门准则来解决，该准则允许在有中介变量截断从处理到结果的因果路径时识别因果效应。前门准则有三个条件，给定的因果图满足所有这些条件：\n1.  中介变量 $M$ 截断了所有从 $X$到 $Y$ 的有向路径。在给定的 DAG 中，唯一的有向路径是 $X \\rightarrow M \\rightarrow Y$，这条路径确实被 $M$ 截断了。\n2.  从 $X$ 到 $M$ 没有未被阻断的后门路径。在 $X$ 和 $M$ 之间唯一包含指向 $X$ 的箭头的路径是 $X \\leftarrow U \\rightarrow Y \\leftarrow M$。这条路径在对撞点 $Y$ 处被阻断，因此该条件得到满足。因此，$X$ 对 $M$ 的因果效应是可识别的，并且等于观测条件概率：$P(m \\mid do(x)) = P(m \\mid x)$。\n3.  所有从 $M$ 到 $Y$ 的后门路径都被 $X$ 阻断。从 $M$ 到 $Y$ 唯一的后门路径是 $M \\leftarrow X \\leftarrow U \\rightarrow Y$。以 $X$ 为条件会在这条路径的 $X$ 处将其阻断，从而满足该条件。这意味着 $M$ 对 $Y$ 的因果效应可以通过对 $X$ 进行调整来识别。\n\n鉴于这些条件，前门调整公式允许我们仅使用可观测的量来表示因果效应 $P(y \\mid do(x))$：\n$$P(y \\mid do(x)) = \\sum_{m} P(m \\mid x) \\sum_{x'} P(y \\mid m, x')P(x')$$\n该公式是从因果推断的第一性原理推导出来的。它将 $X$ 对 $Y$ 的总效应分解为两部分：由 $P(m \\mid x)$ 给出的 $X$ 对中介变量 $M$ 的效应，以及通过对 $X$ 进行调整（对其状态 $x'$ 求和）计算出的中介变量 $M$ 对结果 $Y$ 的效应。\n\n我们需要计算 $P(Y=1 \\mid do(X=1))$。我们将 $y=1$ 和 $x=1$ 代入该公式：\n$$P(Y=1 \\mid do(X=1)) = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=1) \\left( \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=m, X=x')P(X=x') \\right)$$\n让我们首先计算内层求和，它代表了中介变量 $M$ 对结果 $Y$ 的因果效应，$P(Y=1 \\mid do(M=m))$。\n对于 $m=0$：\n$$P(Y=1 \\mid do(M=0)) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=0, X=x')P(X=x')$$\n$$P(Y=1 \\mid do(M=0)) = P(Y=1 \\mid M=0, X=0)P(X=0) + P(Y=1 \\mid M=0, X=1)P(X=1)$$\n使用给定的值：\n$P(X=1) = 0.6$，所以 $P(X=0) = 1 - 0.6 = 0.4$。\n$P(Y=1 \\mid M=0, X=0) = 0.1$。\n$P(Y=1 \\mid M=0, X=1) = 0.3$。\n$$P(Y=1 \\mid do(M=0)) = (0.1)(0.4) + (0.3)(0.6) = 0.04 + 0.18 = 0.22$$\n\n对于 $m=1$：\n$$P(Y=1 \\mid do(M=1)) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=1, X=x')P(X=x')$$\n$$P(Y=1 \\mid do(M=1)) = P(Y=1 \\mid M=1, X=0)P(X=0) + P(Y=1 \\mid M=1, X=1)P(X=1)$$\n使用给定的值：\n$P(Y=1 \\mid M=1, X=0) = 0.5$。\n$P(Y=1 \\mid M=1, X=1) = 0.9$。\n$$P(Y=1 \\mid do(M=1)) = (0.5)(0.4) + (0.9)(0.6) = 0.20 + 0.54 = 0.74$$\n\n现在我们可以通过将这些结果代回主公式来计算最终的干预概率：\n$$P(Y=1 \\mid do(X=1)) = P(M=0 \\mid X=1) P(Y=1 \\mid do(M=0)) + P(M=1 \\mid X=1) P(Y=1 \\mid do(M=1))$$\n给定 $P(M=1 \\mid X=1) = 0.8$。\n因此，$P(M=0 \\mid X=1) = 1 - P(M=1 \\mid X=1) = 1 - 0.8 = 0.2$。\n代入所有数值：\n$$P(Y=1 \\mid do(X=1)) = (0.2)(0.22) + (0.8)(0.74)$$\n$$P(Y=1 \\mid do(X=1)) = 0.044 + 0.592$$\n$$P(Y=1 \\mid do(X=1)) = 0.636$$\n因此，如果阀门指令设置为高，发生过热事件的概率为 $0.636$。",
            "answer": "$$\\boxed{0.636}$$"
        }
    ]
}