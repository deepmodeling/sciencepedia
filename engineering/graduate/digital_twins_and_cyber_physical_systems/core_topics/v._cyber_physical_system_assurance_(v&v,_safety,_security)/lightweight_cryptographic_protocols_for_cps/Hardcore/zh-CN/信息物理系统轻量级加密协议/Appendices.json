{
    "hands_on_practices": [
        {
            "introduction": "在为资源受限的设备选择轻量级密码协议时，首要任务是量化其基本性能指标。本练习将指导您如何根据底层的硬件规格（如时钟频率和功耗）和已知的算法性能（以每个数据块所需的CPU周期数衡量），来计算加密操作的吞吐量和单位比特能耗。这些核心指标是评估一个协议是否适用于特定物联网或信息物理系统节点的关键依据 。",
            "id": "4229436",
            "problem": "一个信息物理系统（CPS）边缘节点使用密钥长度为 $80$ 比特的轻量级分组密码（LBC）PRESENT 来加密遥测数据，其数字孪生（DT）必须预测性能和能源成本，以评估协议用于实时通信的可行性。该节点基于德州仪器（Texas Instruments）的 MSP430 微控制器（MSP430）构建，时钟频率为 $16 \\text{ MHz}$，执行 PRESENT-80 的软件实现时，处理每 $64$ 比特的数据块需要 $2400$ 个中央处理器（CPU）周期。该设备在加密期间的工作电压为 $3.3 \\text{ V}$，电流为 $5 \\text{ mA}$。假设系统处于稳态，CPU 完全被加密操作占用，外部输入/输出开销可忽略不计，所有数据块都被连续处理且无停顿，并且工作期间电源电流保持恒定。\n\n从时间、速率和能量的核心定义出发，推导该实现的吞吐量（单位：比特/秒）和每比特能量（单位：焦耳/比特）的表达式，然后使用给定参数进行数值计算。将吞吐量以比特/秒表示，每比特能量以纳焦耳/比特表示。将两个量均四舍五入至四位有效数字。",
            "solution": "该问题提法明确且有科学依据，提供了推导和计算所需性能指标的所有必要参数。我们可以开始求解。\n\n问题要求推导和计算嵌入式设备上密码学实现的两个关键性能指标：吞吐量和每比特能量。我们将从时间、速率、功率和能量的核心定义出发，利用所给参数推导所需表达式。\n\n根据给定条件，定义以下参数：\n- 时钟频率: $f_{clk} = 16 \\text{ MHz} = 16 \\times 10^6 \\text{ s}^{-1}$\n- 每块的CPU周期数: $C_{block} = 2400$\n- 分组大小: $B_{size} = 64 \\text{ bits}$\n- 电源电压: $V_{DD} = 3.3 \\text{ V}$\n- 电源电流: $I_{DD} = 5 \\text{ mA} = 5 \\times 10^{-3} \\text{ A}$\n\n首先，我们推导吞吐量的表达式，记为 $R$。\n处理单个数据块所需的时间 $T_{block}$，由操作所需的CPU周期数 $C_{block}$ 和CPU的时钟频率 $f_{clk}$ 决定。其关系如下：\n$$T_{block} = \\frac{C_{block}}{f_{clk}}$$\n吞吐量 $R$ 定义为单位时间内处理的比特数。在连续处理数据块的假设下，它等于以比特为单位的分组大小 $B_{size}$ 除以处理一个数据块的时间 $T_{block}$。\n$$R = \\frac{B_{size}}{T_{block}}$$\n代入 $T_{block}$ 的表达式，得到吞吐量的通用公式：\n$$R = \\frac{B_{size}}{\\left( \\frac{C_{block}}{f_{clk}} \\right)} = \\frac{B_{size} \\cdot f_{clk}}{C_{block}}$$\n接下来，我们推导每比特消耗的能量，记为 $E_{bit}$。\n设备在加密期间消耗的电功率 $P$ 是电源电压 $V_{DD}$ 和电源电流 $I_{DD}$ 的乘积。问题中指出，在此操作期间电流是恒定的。\n$$P = V_{DD} \\cdot I_{DD}$$\n加密单个数据块所消耗的能量 $E_{block}$ 是功率乘以操作的持续时间，即 $T_{block}$。\n$$E_{block} = P \\cdot T_{block} = (V_{DD} \\cdot I_{DD}) \\cdot \\left( \\frac{C_{block}}{f_{clk}} \\right)$$\n每比特能量 $E_{bit}$ 则等于每块的能量除以一个块中的比特数 $B_{size}$。\n$$E_{bit} = \\frac{E_{block}}{B_{size}} = \\frac{V_{DD} \\cdot I_{DD} \\cdot C_{block}}{B_{size} \\cdot f_{clk}}$$\n这个 $E_{bit}$ 的表达式与另一种推导方法——即功率与吞吐量的比值 $E_{bit} = \\frac{P}{R}$——的结果是一致的。\n\n现在，我们将给定的数值代入推导出的表达式中进行计算。\n对于吞吐量 $R$：\n$$R = \\frac{64 \\text{ bits} \\cdot (16 \\times 10^6 \\text{ s}^{-1})}{2400} = \\frac{1024 \\times 10^6}{2400} \\text{ bps} \\approx 426666.67 \\text{ bps}$$\n问题要求四舍五入到四位有效数字。\n$$R \\approx 4.267 \\times 10^5 \\text{ bps}$$\n\n对于每比特能量 $E_{bit}$：\n$$E_{bit} = \\frac{(3.3 \\text{ V}) \\cdot (5 \\times 10^{-3} \\text{ A}) \\cdot 2400}{64 \\cdot (16 \\times 10^6 \\text{ s}^{-1})}$$\n$$E_{bit} = \\frac{39.6}{1024 \\times 10^6} \\frac{\\text{J}}{\\text{bit}} \\approx 3.8671875 \\times 10^{-8} \\frac{\\text{J}}{\\text{bit}}$$\n问题要求答案以纳焦耳/比特（nJ/bit）为单位。因为 $1 \\text{ J} = 10^9 \\text{ nJ}$，我们进行单位换算：\n$$E_{bit} \\approx (3.8671875 \\times 10^{-8} \\frac{\\text{J}}{\\text{bit}}) \\cdot (10^9 \\frac{\\text{nJ}}{\\text{J}}) = 38.671875 \\frac{\\text{nJ}}{\\text{bit}}$$\n四舍五入到四位有效数字，每比特能量为：\n$$E_{bit} \\approx 38.67 \\frac{\\text{nJ}}{\\text{bit}}$$\n最终的两个数值是吞吐量（单位：比特/秒）和每比特能量（单位：纳焦耳/比特），均四舍五入至四位有效数字。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.267 \\times 10^5 & 38.67\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在信息物理系统中，尤其是在涉及实时控制回路的应用中，密码学操作的性能不仅关乎速度，更关乎是否能满足严格的时间期限。本练习将性能分析提升到一个新的层次，展示了如何将一个宏观的系统需求（如PID控制器的采样周期）转化为一个具体的计算预算（以最大允许的时钟周期数表示）。通过这种方式，我们可以判断一个特定的认证加密算法是否能够在不危及系统稳定性的前提下，可靠地集成到控制流程中 。",
            "id": "4229450",
            "problem": "一个网络物理系统（CPS）中的比例-积分-微分（PID）控制执行器以采样周期 $T_{s} = 2 \\text{ ms}$ 进行周期性采样。为保持闭环稳定性并限制抖动，用于消息认证的加密处理被限制在每个周期内消耗不超过采样周期的 $\\alpha = 0.10$ 的一部分。该执行器由一个时钟频率为 $f_{\\text{MCU}} = 48 \\text{ MHz}$ 的微控制器单元（MCU）驱动。认证采用带有关联数据的认证加密（AEAD）实现，对于 $L = 64$ 字节的有效载荷，测得的成本为每字节 $c_{b} = 30$ 个时钟周期。假设加密成本与有效载荷大小成线性关系，并忽略恒定时间的初始化成本、直接内存访问（DMA）效应和内存等待状态，因此时钟周期与MCU时钟下的执行时间成正比。\n\n从周期性实时调度的定义以及执行时间与时钟周期之间的关系出发，推导：\n\n1. 每个采样周期内可用于认证的最大时钟周期预算 $C_{\\max}$。\n2. 一个可行性指标 $\\varphi$，定义为：如果 AEAD 计算在允许的预算内（即所需时钟周期不超过 $C_{\\max}$），则 $\\varphi = 1$，否则 $\\varphi = 0$。\n\n将您的最终答案以行矩阵的形式给出，第一个条目等于 $C_{\\max}$，第二个条目等于 $\\varphi$。无需四舍五入，并根据需要以时钟周期和无单位指标表示所有中间和最终量。",
            "solution": "首先验证问题，以确保其科学上合理、良定且客观。\n\n**步骤1：提取给定信息**\n- 采样周期: $T_{s} = 2 \\text{ ms}$\n- 用于加密处理的采样周期比例: $\\alpha = 0.10$\n- 微控制器单元（MCU）时钟频率: $f_{\\text{MCU}} = 48 \\text{ MHz}$\n- 每字节的加密成本: $c_{b} = 30 \\text{ 周期/字节}$\n- 有效载荷大小: $L = 64 \\text{ 字节}$\n- 假设：加密成本与有效载荷大小成线性关系；忽略初始化成本、DMA效应和内存等待状态。\n- 要求输出：\n  1. 每个采样周期的最大时钟周期预算, $C_{\\max}$。\n  2. 可行性指标, $\\varphi$, 其中如果计算可行则 $\\varphi = 1$，否则 $\\varphi = 0$。\n\n**步骤2：使用提取的给定信息进行验证**\n该问题定义明确，科学上基于实时嵌入式系统和应用密码学的原理。所提供的参数（$T_s$, $f_{\\text{MCU}}$, $c_b$, $L$）对于现代网络物理系统（CPS）是切合实际的。问题陈述清晰明确、自成体系，且没有内部矛盾。它不违反任何基本原则，并且没有主观论断。因此，该问题被认为是有效的。\n\n**步骤3：进行求解**\n\n求解需要推导两个量：最大可用时钟周期预算 $C_{\\max}$ 和可行性指标 $\\varphi$。\n\n**1. 最大时钟周期预算 ($C_{\\max}$) 的推导**\n\n总采样周期给定为 $T_{s} = 2 \\text{ ms}$。这可以用国际单位制（SI）基本单位表示为：\n$$T_{s} = 2 \\times 10^{-3} \\text{ s}$$\n分配给加密处理的该周期比例为 $\\alpha = 0.10$。因此，用于认证的最大允许执行时间，记为 $T_{\\text{crypto,max}}$，是：\n$$T_{\\text{crypto,max}} = \\alpha \\times T_{s}$$\n代入给定值：\n$$T_{\\text{crypto,max}} = 0.10 \\times (2 \\times 10^{-3} \\text{ s}) = 2 \\times 10^{-4} \\text{ s}$$\nMCU 的时钟频率给定为 $f_{\\text{MCU}} = 48 \\text{ MHz}$，即：\n$$f_{\\text{MCU}} = 48 \\times 10^6 \\text{ Hz} = 48 \\times 10^6 \\text{ cycles/s}$$\n执行时间 $t$、时钟周期数 $C$ 和时钟频率 $f$ 之间的关系由 $t = C/f$ 给出。因此，在时间预算 $T_{\\text{crypto,max}}$ 内可以执行的最大时钟周期数 $C_{\\max}$ 是：\n$$C_{\\max} = T_{\\text{crypto,max}} \\times f_{\\text{MCU}}$$\n代入推导出的和给定的值：\n$$C_{\\max} = (2 \\times 10^{-4} \\text{ s}) \\times (48 \\times 10^6 \\text{ cycles/s})$$\n$$C_{\\max} = (2 \\times 48) \\times 10^{-4} \\times 10^6 \\text{ cycles}$$\n$$C_{\\max} = 96 \\times 10^2 \\text{ cycles}$$\n$$C_{\\max} = 9600 \\text{ cycles}$$\n\n**2. 可行性指标 ($\\varphi$) 的推导**\n\n为了确定可行性，我们必须首先计算 AEAD 认证所需的时钟周期数，记为 $C_{\\text{req}}$。问题陈述，加密成本与有效载荷大小成线性关系，且初始化成本可以忽略不计。每字节的成本是 $c_{b} = 30 \\text{ 周期/字节}$，有效载荷大小是 $L = 64 \\text{ 字节}$。\n因此，所需的时钟周期数是：\n$$C_{\\text{req}} = c_{b} \\times L$$\n代入给定值：\n$$C_{\\text{req}} = (30 \\text{ cycles/byte}) \\times (64 \\text{ bytes})$$\n$$C_{\\text{req}} = 1920 \\text{ cycles}$$\n可行性指标 $\\varphi$ 的定义基于所需时钟周期是否在最大允许预算之内：\n$$\\varphi = \\begin{cases} 1 & \\text{if } C_{\\text{req}} \\le C_{\\max} \\\\ 0 & \\text{if } C_{\\text{req}} > C_{\\max} \\end{cases}$$\n我们将计算出的所需时钟周期与最大时钟周期预算进行比较：\n$$1920 \\text{ cycles} \\le 9600 \\text{ cycles}$$\n条件 $C_{\\text{req}} \\le C_{\\max}$ 成立。因此，可行性指标是：\n$$\\varphi = 1$$\n\n最终答案要求一个包含 $C_{\\max}$ 和 $\\varphi$ 的行矩阵。\n计算出的值为 $C_{\\max} = 9600$ 和 $\\varphi = 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9600 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "如果一个密码协议不安全，那么其性能再高也毫无意义。因此，除了性能评估，我们还必须能够量化其提供的安全保障。本练习探讨了如何通过计算“碰撞”概率来评估轻量级哈希函数的可靠性，这是衡量其安全性的一个基本方面。理解和计算这种风险（在此以遥测数据去重的场景为例）对于构建可信赖的信息物理系统至关重要，因为它直接关系到数据的完整性和系统的可靠性 。",
            "id": "4229400",
            "problem": "一个用于数字孪生的信息物理系统（CPS）遥测管道使用轻量级哈希函数 PHOTON-$256$ 来对传感器帧进行去重。每个遥测帧都会被哈希，哈希表中的匹配会触发去重操作。假设 PHOTON-$256$ 的输出被建模为在一个大小为 $2^{256}$ 的空间上均匀随机且独立，这与随机预言机理想化模型一致。在一个给定的收集间隔内，恰好有 $q = 2^{20}$ 帧被哈希。以生日界限作为关于随机函数碰撞概率的基本事实，从第一性原理出发，推导对一个具有 $n=256$ 位输出的函数进行 $q$ 次独立查询后的碰撞概率。然后，使用给定的 $q$ 和 $n$ 计算该概率，并将最终结果表示为以 2 的幂为形式的单一闭式表达式。最后，在高等研究生水平的系统背景下，根据你的推导，简要讨论这对 CPS 遥测去重可靠性的影响。最终的数值表达式只提供碰撞概率。不要进行数值近似；不需要四舍五入，也不需要单位。",
            "solution": "问题陈述已经过评估并被认为是有效的。它在科学上基于密码学和概率论的原理，问题提法良好，信息充分且一致，并且其表述是客观的。因此，我们可以继续进行解答。\n\n该问题要求推导和评估一个哈希函数的碰撞概率。我们已知被哈希的项目数量 $q$ 和哈希函数输出空间的大小 $N$。\n\n具体参数如下：\n- 哈希的帧数, $q = 2^{20}$。\n- 哈希函数是 PHOTON-$256$，其输出为 $n=256$ 位。因此，上域（或输出空间）的大小为 $N = 2^{n} = 2^{256}$。\n- 哈希函数被建模为随机预言机，意味着 $q$ 个输出中的每一个都是从 $N$ 个可能值中独立且均匀随机的选择。\n\n如果 $q$ 个哈希帧中至少有两个产生相同的输出值，则发生碰撞。令 $P(C)$ 表示发生此类碰撞的概率。首先计算其互补概率 $P(C')$（即没有碰撞发生的概率）更为直接。那么碰撞概率为 $P(C) = 1 - P(C')$。\n\n要使不发生碰撞，所有 $q$ 个哈希输出必须是不同的。让我们考虑 $q$ 个哈希输出的序列 $h_1, h_2, \\ldots, h_q$。\n- 第一个哈希值 $h_1$ 可以是 $N$ 个值中的任意一个。\n- 第二个哈希值 $h_2$ 要与 $h_1$ 不同，它必须是剩下的 $N-1$ 个值之一。其概率为 $\\frac{N-1}{N}$。\n- 第三个哈希值 $h_3$ 要与 $h_1$ 和 $h_2$（它们已经互不相同）都不同，它必须是剩下的 $N-2$ 个值之一。其概率为 $\\frac{N-2}{N}$。\n- 这个过程一直持续到第 $q$ 个哈希值 $h_q$，它必须与之前的 $q-1$ 个不同的哈希值都不同。它必须是剩下的 $N-(q-1)$ 个值之一。其概率为 $\\frac{N-q+1}{N}$。\n\n由于哈希输出是独立的，没有碰撞的总概率 $P(C')$ 是这些独立概率的乘积：\n$$P(C') = \\frac{N}{N} \\times \\frac{N-1}{N} \\times \\frac{N-2}{N} \\times \\cdots \\times \\frac{N-q+1}{N}$$\n这可以用连乘符号表示为：\n$$P(C') = \\prod_{k=0}^{q-1} \\frac{N-k}{N} = \\prod_{k=0}^{q-1} \\left(1 - \\frac{k}{N}\\right)$$\n这就是无碰撞概率的精确第一性原理推导。因此，碰撞概率为：\n$$P(C) = 1 - \\prod_{k=0}^{q-1} \\left(1 - \\frac{k}{N}\\right)$$\n\n问题陈述中提到“以生日界限作为基本事实”。这表明需要使用此概率的标准近似，当 $q \\ll N$ 时，这个近似非常精确。该近似依赖于指数函数的泰勒级数展开，其中对于很小的 $x$，$1-x \\approx e^{-x}$。将此近似应用于乘积中的每一项：\n$$P(C') = \\prod_{k=0}^{q-1} \\left(1 - \\frac{k}{N}\\right) \\approx \\prod_{k=0}^{q-1} \\exp\\left(-\\frac{k}{N}\\right) = \\exp\\left(-\\sum_{k=0}^{q-1} \\frac{k}{N}\\right)$$\n指数中的求和是一个等差数列的和：\n$$\\sum_{k=0}^{q-1} k = \\frac{(q-1)q}{2}$$\n将此代回，得到无碰撞概率的近似值：\n$$P(C') \\approx \\exp\\left(-\\frac{q(q-1)}{2N}\\right)$$\n因此碰撞概率为：\n$$P(C) \\approx 1 - \\exp\\left(-\\frac{q(q-1)}{2N}\\right)$$\n在 $q$ 很大的情况下，项 $q(q-1)$ 非常接近 $q^2$。问题要求结果以 2 的幂表示，这表明题目意在让我们使用近似 $q(q-1) \\approx q^2$。由此引入的相对误差为 $\\frac{q^2 - q(q-1)}{q^2} = \\frac{q}{q^2} = \\frac{1}{q} = 2^{-20}$，这是可以忽略不计的。这导出了生日问题的经典近似：\n$$P(C) \\approx 1 - \\exp\\left(-\\frac{q^2}{2N}\\right)$$\n现在我们使用给定的值 $q = 2^{20}$ 和 $N = 2^{256}$ 来计算这个表达式。\n$$P(C) \\approx 1 - \\exp\\left(-\\frac{(2^{20})^2}{2 \\cdot 2^{256}}\\right)$$\n首先，我们简化指数部分：\n$$\\frac{(2^{20})^2}{2 \\cdot 2^{256}} = \\frac{2^{40}}{2^1 \\cdot 2^{256}} = \\frac{2^{40}}{2^{257}} = 2^{40-257} = 2^{-217}$$\n将此代回概率表达式，得到最终的闭式结果：\n$$P(C) \\approx 1 - \\exp(-2^{-217})$$\n\n最后，有必要简要讨论这对 CPS 遥测去重可靠性的影响。\n计算出的碰撞概率 $P(C) \\approx 1 - \\exp(-2^{-217})$ 是一个极小的数字。对于一个小的正值 $x$，近似式 $1-e^{-x} \\approx x$ 成立。因此，$P(C) \\approx 2^{-217}$。在这种情况下，碰撞意味着两个不同的传感器帧被错误地识别为相同，导致第二个帧被丢弃，从而造成数据丢失。去重组件的可靠性与此概率成反比。$2^{-217}$ 这个值是如此微小，以至于它比信息物理系统中任何其他可想到的错误来源（如硬件故障、网络数据损坏或软件错误）都要低几个数量级。\n从高等系统的角度来看，这一结果证实了对于 $2^{20}$ 个项目的负载使用一个 256 位的密码学哈希函数，其提供的针对意外碰撞的安全边际远远超出了任何实际需求。选择像 PHOTON 这样的密码学级别的函数还提供了对在安全敏感应用中需要关注的对抗性攻击（例如，第二原像攻击）的内在抵抗力。对于所述的简单去重目的，系统的可靠性瓶颈将在于其他地方；基于哈希的机制在所有实际应用中都是完全可靠的。",
            "answer": "$$\\boxed{1 - \\exp(-2^{-217})}$$"
        }
    ]
}