{
    "hands_on_practices": [
        {
            "introduction": "To effectively defend a system, one must first think like an attacker. This practice delves into the core principles of stealthy false data injection (FDI) attacks, a critical threat to the integrity of cyber-physical systems. You will derive the fundamental algebraic condition that allows an adversary to manipulate sensor measurements, such as those processed by a digital twin, without triggering common residual-based detectors . Understanding this \"unobservable subspace\" is the first step toward designing more robust monitoring and protection schemes.",
            "id": "4244500",
            "problem": "In a linearized monitoring layer of a Cyber-Physical System (CPS), the digital twin uses a static measurement model $y \\in \\mathbb{R}^{m}$ given by $y = Hx + e$, where $x \\in \\mathbb{R}^{n}$ is the system state, $H \\in \\mathbb{R}^{m \\times n}$ is the measurement matrix, and $e \\in \\mathbb{R}^{m}$ is measurement noise. The residual-based bad-data detector computes the residual $r = y - H\\hat{x}$, where the state estimate $\\hat{x}$ is obtained by the least-squares estimator $\\hat{x} \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y - Hz\\|_{2}$. An adversary injects a false data vector $a \\in \\mathbb{R}^{m}$ so that the measured vector becomes $y' = y + a$. An attack is said to be unobservable if the residual under attack equals the nominal residual, i.e., $r' = r$, where $r' = y' - H\\hat{x}'$ and $\\hat{x}'$ is the least-squares estimate from $y'$.\n\nStarting only from the definitions of least-squares projection in Euclidean space and the residual, derive the algebraic characterization of all unobservable attacks. Express the final result as a closed-form expression for a general unobservable attack vector solely in terms of $H$ and a free parameter. Your final answer must be a single closed-form expression and contain no words.",
            "solution": "The problem requires the derivation of the algebraic characterization of all unobservable attack vectors $a$. An attack is defined as unobservable if the measurement residual remains unchanged after the injection of false data.\n\nLet us begin with the definitions provided. The nominal measurement model is $y = Hx + e$, where $y \\in \\mathbb{R}^{m}$, $x \\in \\mathbb{R}^{n}$, $H \\in \\mathbb{R}^{m \\times n}$, and $e \\in \\mathbb{R}^{m}$. The state estimate $\\hat{x}$ is obtained via the least-squares method:\n$$ \\hat{x} \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y - Hz\\|_{2} $$\nThis minimization problem has a unique geometric interpretation. The vector $H\\hat{x}$ is the orthogonal projection of the measurement vector $y$ onto the column space of the matrix $H$, which we denote as $\\text{Im}(H)$. Let $P_{H}$ be the orthogonal projection matrix that projects vectors in $\\mathbb{R}^{m}$ onto the subspace $\\text{Im}(H)$. Then, we can write:\n$$ H\\hat{x} = P_{H}y $$\nThe nominal residual vector, $r$, is defined as $r = y - H\\hat{x}$. Substituting the expression for $H\\hat{x}$, we obtain:\n$$ r = y - P_{H}y = (I - P_{H})y $$\nHere, $I$ is the $m \\times m$ identity matrix. The matrix $I - P_{H}$ is itself a projection matrix. It projects vectors onto the orthogonal complement of $\\text{Im}(H)$, which is the null space of the transpose of $H$, denoted $\\mathcal{N}(H^T)$.\n\nNow, we consider the system under attack. An adversary injects a false data vector $a \\in \\mathbb{R}^{m}$, resulting in a new measurement vector $y' = y + a$. The least-squares estimate under attack, $\\hat{x}'$, is found by minimizing $\\|y' - Hz\\|_{2}$:\n$$ \\hat{x}' \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y' - Hz\\|_{2} $$\nAnalogous to the nominal case, the resulting vector $H\\hat{x}'$ is the orthogonal projection of the attacked measurement vector $y'$ onto the column space of $H$:\n$$ H\\hat{x}' = P_{H}y' $$\nThe residual under attack, $r'$, is then:\n$$ r' = y' - H\\hat{x}' = y' - P_{H}y' = (I - P_{H})y' $$\nAn attack is defined as unobservable if the residual does not change, i.e., $r' = r$. We enforce this condition using the derived expressions for the residuals:\n$$ (I - P_{H})y' = (I - P_{H})y $$\nSubstitute $y' = y + a$ into this equation:\n$$ (I - P_{H})(y + a) = (I - P_{H})y $$\nBy the linearity of the matrix-vector product, we can expand the left side of the equation:\n$$ (I - P_{H})y + (I - P_{H})a = (I - P_{H})y $$\nSubtracting the term $(I - P_{H})y$ from both sides, we are left with a condition solely on the attack vector $a$:\n$$ (I - P_{H})a = 0 $$\nThis equation signifies that the projection of the attack vector $a$ onto the subspace $\\mathcal{N}(H^T)$ is the zero vector. This is only true if the vector $a$ is orthogonal to every vector in $\\mathcal{N}(H^T)$. The set of all vectors orthogonal to $\\mathcal{N}(H^T)$ is precisely its orthogonal complement, $(\\mathcal{N}(H^T))^{\\perp}$. By the fundamental theorem of linear algebra, the orthogonal complement of the null space of $H^T$ is the column space (image) of $H$. Therefore, the condition is equivalent to:\n$$ a \\in \\text{Im}(H) $$\nThis means that for an attack to be unobservable, the attack vector $a$ must lie in the column space of the measurement matrix $H$. Any vector in the column space of $H$ can be expressed as a linear combination of the columns of $H$. This can be written in a compact form by stating that there must exist a vector $c \\in \\mathbb{R}^n$ such that:\n$$ a = Hc $$\nThe vector $c$ is a free parameter vector that defines a specific unobservable attack. This expression provides the complete algebraic characterization of all unobservable attack vectors.",
            "answer": "$$ \\boxed{Hc} $$"
        },
        {
            "introduction": "Theoretical vulnerabilities become tangible threats when they can precipitate dangerous physical consequences. This exercise bridges the abstract cyber domain with the physical world by analyzing a time-synchronization attack on a power grid, a classic example of a critical cyber-physical system . You will calculate how a subtle, adversary-induced time offset in a Phasor Measurement Unit (PMU) translates directly into a false differential current—a physical anomaly that could erroneously trip protection relays and jeopardize grid stability.",
            "id": "4244553",
            "problem": "A transmission line in a cyber-physical power system uses a line current differential protection scheme implemented with time-synchronized phasor measurements at terminals A and B. Each terminal hosts a Phasor Measurement Unit (PMU) that computes the fundamental-frequency current phasor from uniformly sampled data using a one-cycle Discrete Fourier Transform (DFT) at the nominal frequency. The sampling rate is $f_{s} = 4800\\,\\text{Hz}$ on a $f_{0} = 60\\,\\text{Hz}$ system, so that $N = 80$ samples per nominal cycle are used. The relay computes the differential current decision variable as the magnitude $I_{\\text{diff}} = \\left| \\hat{I}_{A} + \\hat{I}_{B} \\right|$, where $\\hat{I}_{A}$ and $\\hat{I}_{B}$ are the complex phasor estimates produced by the PMUs at A and B, respectively. Under secure operation with through-load (no internal fault), the true synchronized phasors satisfy $\\hat{I}_{B}^{\\text{true}} = -\\hat{I}_{A}^{\\text{true}}$ because the terminal currents are equal in magnitude and opposite in direction when referenced to a consistent sign convention.\n\nAn adversary successfully induces a Global Positioning System (GPS) time offset of $\\Delta t = 50\\,\\mu\\text{s}$ at terminal B only, causing terminal B’s PMU to compute its DFT phasor against a reference that is shifted in time relative to terminal A. Assume ideal anti-aliasing, no measurement noise, a rectangular one-cycle window, and that the fundamental input is a perfect sinusoid at the nominal frequency $f_{0}$. The through current magnitude at each terminal is $1.2$ per-unit on a $I_{\\text{base}} = 2\\,\\text{kA}$ base, and per-unit is defined on this base.\n\nStarting only from fundamental definitions of uniform sampling, the $N$-point DFT at the fundamental, and the relation between continuous-time shifts and complex exponentials in Fourier analysis, derive the resulting closed-form expression for the false differential current magnitude $I_{\\text{diff}}$ caused solely by the time offset at terminal B, and compute the minimum per-unit pickup threshold $T_{\\min}$ such that the relay decision rule $I_{\\text{diff}}  T$ does not falsely trip under the stated through-load. Express $T_{\\min}$ in per-unit and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the false differential current magnitude, $I_{\\text{diff}}$, resulting from a time synchronization error, and the subsequent calculation of a minimum relay setting to prevent a false trip.\n\nLet $\\hat{I}_{A}^{\\text{true}}$ and $\\hat{I}_{B}^{\\text{true}}$ be the true complex phasors at terminals A and B. For a through-load, the currents are equal and opposite: $\\hat{I}_{B}^{\\text{true}} = -\\hat{I}_{A}^{\\text{true}}$. The magnitude at each terminal is $I_{\\text{mag}} = |\\hat{I}_{A}^{\\text{true}}| = 1.2\\,\\text{p.u.}$.\n\nTerminal A's measurement is accurate: $\\hat{I}_{A} = \\hat{I}_{A}^{\\text{true}}$.\nTerminal B's measurement is subject to a time offset $\\Delta t$. A time shift of $\\Delta t$ in the time domain corresponds to a phase shift of $e^{j\\omega_0 \\Delta t}$ in the frequency domain, where $\\omega_0 = 2\\pi f_0$. The measured phasor at B is therefore:\n$$ \\hat{I}_{B} = \\hat{I}_{B}^{\\text{true}} e^{j2\\pi f_0 \\Delta t} $$\nThe differential current is $I_{\\text{diff}} = |\\hat{I}_{A} + \\hat{I}_{B}|$. Substituting the expressions for the measured phasors and the through-load condition:\n$$ I_{\\text{diff}} = |\\hat{I}_{A}^{\\text{true}} + (\\hat{I}_{B}^{\\text{true}} e^{j2\\pi f_0 \\Delta t})| = |\\hat{I}_{A}^{\\text{true}} - \\hat{I}_{A}^{\\text{true}} e^{j2\\pi f_0 \\Delta t}| $$\nFactoring out $\\hat{I}_{A}^{\\text{true}}$:\n$$ I_{\\text{diff}} = |\\hat{I}_{A}^{\\text{true}}| \\cdot |1 - e^{j2\\pi f_0 \\Delta t}| = I_{\\text{mag}} |1 - e^{j2\\pi f_0 \\Delta t}| $$\nTo simplify $|1 - e^{j\\theta}|$ where $\\theta = 2\\pi f_0 \\Delta t$, we use trigonometric identities:\n$$ |1 - e^{j\\theta}| = |1 - (\\cos\\theta + j\\sin\\theta)| = \\sqrt{(1-\\cos\\theta)^2 + \\sin^2\\theta} = \\sqrt{2(1 - \\cos\\theta)} $$\nUsing the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$ \\sqrt{2(1 - \\cos\\theta)} = \\sqrt{4\\sin^2(\\theta/2)} = |2\\sin(\\theta/2)| $$\nSubstituting back into the expression for $I_{\\text{diff}}$:\n$$ I_{\\text{diff}} = I_{\\text{mag}} \\left|2\\sin\\left(\\frac{2\\pi f_0 \\Delta t}{2}\\right)\\right| = 2I_{\\text{mag}} |\\sin(\\pi f_0 \\Delta t)| $$\nThe minimum pickup threshold $T_{\\min}$ to avoid a false trip must be equal to this calculated false differential current.\n$$ T_{\\min} = 2 I_{\\text{mag}} \\sin(\\pi f_0 \\Delta t) $$\nNow, we substitute the numerical values: $I_{\\text{mag}} = 1.2\\,\\text{p.u.}$, $f_0 = 60\\,\\text{Hz}$, and $\\Delta t = 50 \\times 10^{-6}\\,\\text{s}$.\n$$ T_{\\min} = 2(1.2) \\sin(\\pi \\cdot 60 \\cdot 50 \\times 10^{-6}) = 2.4 \\sin(0.003\\pi) $$\nThe argument $0.003\\pi$ is in radians.\n$$ T_{\\min} = 2.4 \\sin(0.009424778...) \\approx 2.4 \\times 0.009424433... $$\n$$ T_{\\min} \\approx 0.02261864\\,\\text{p.u.} $$\nRounding to four significant figures, we get:\n$$ T_{\\min} \\approx 0.02262\\,\\text{p.u.} $$",
            "answer": "$$ \\boxed{0.02262} $$"
        },
        {
            "introduction": "A sophisticated adversary does not attack randomly; they operate under constraints and optimize their strategy to maximize impact. This final practice places you in the role of such a strategic attacker, tasking you with designing an optimal attack sequence that maximizes physical damage while remaining below a given detection budget . By formulating and solving this constrained optimization problem, you will gain deep insight into the attacker's dilemma—the trade-off between effectiveness and stealth—and learn how this very trade-off can be exploited to develop more resilient control and detection systems.",
            "id": "4244570",
            "problem": "Consider a discrete-time Cyber-Physical System (CPS) with a single measured output and a single control input. The physical plant is modeled as a Linear Time-Invariant (LTI) system with state update equation $x_{t+1} = A_p x_t + B_p u_t$, and the deployed controller uses static output feedback $u_t = -K y_t$, where the measured signal is $y_t = x_t + a_t$. Here, $x_t$ is the true state, $u_t$ is the control input, $A_p$ and $B_p$ are constant system matrices (scalars in this problem), $K$ is a scalar static feedback gain, and $a_t$ is an attacker-injected false data (scalar) at discrete time $t$.\n\nAn operator deploys a detector based on the Generalized Likelihood Ratio Test (GLRT) for the measurement channel under independent and identically distributed zero-mean Gaussian noise with variance $\\sigma^2$. Under the absence of attack, the statistic of interest for a finite horizon of $T$ steps is modeled as the sum of squared standardized innovations, which follows a central chi-square distribution. Under a deterministic attack sequence $\\{a_t\\}_{t=0}^{T-1}$, the detection statistic corresponds to a noncentral chi-square distribution with noncentrality parameter proportional to the quadratic form $\\sum_{t=0}^{T-1} a_t^2 / \\sigma^2$. For a fixed false-alarm rate and detection threshold, minimizing the probability of detection over the horizon is equivalent to keeping this noncentrality parameter below a prescribed budget.\n\nAssume the initial state is zero, $x_0 = 0$. Let $A_c = A_p - B_p K$ denote the closed-loop matrix. The attacker aims to maximize physical damage quantified as a weighted squared deviation of the state at the terminal time $T$, namely $J_{\\text{dam}} = W x_T^2$ with $W \\ge 0$, while simultaneously minimizing the probability of detection by respecting an upper bound on the GLRT noncentrality. This yields the following constrained optimization problem over the attack sequence $a = [a_0,\\dots,a_{T-1}]^\\top$:\n- The closed-loop dynamics imply $x_{t+1} = A_c x_t - B_p K a_t$ and hence $x_T = \\sum_{k=0}^{T-1} h_k a_k$ with $h_k = -(B_p K) A_c^{T-1-k}$.\n- The damage objective is $J_{\\text{dam}} = W x_T^2 = W \\left(\\sum_{k=0}^{T-1} h_k a_k\\right)^2$.\n- The detection-energy budget constraint is $\\sum_{t=0}^{T-1} \\frac{a_t^2}{\\sigma^2} \\le \\gamma$, where $\\gamma \\ge 0$ is a prescribed bound derived from the detector design and acceptable miss-detection trade-off.\n\nYour task is to:\n- For each test case, compute an attack sequence $a^\\star$ that maximizes $J_{\\text{dam}}$ subject to the detection-energy budget constraint, and then report two scalars: the achieved optimal damage $J_{\\text{dam}}(a^\\star)$ and the corresponding detection-energy $\\sum_{t=0}^{T-1} \\frac{(a_t^\\star)^2}{\\sigma^2}$.\n- All quantities in this problem are dimensionless scalars; no physical units are required.\n\nFoundation to use:\n- Linear time-invariant dynamics $x_{t+1} = A_p x_t + B_p u_t$ and static output feedback $u_t = -K y_t$ with $y_t = x_t + a_t$.\n- For Gaussian noise with variance $\\sigma^2$, the GLRT noncentrality under a deterministic signal equals the weighted energy $\\sum_{t=0}^{T-1} a_t^2 / \\sigma^2$.\n- Properties of quadratic forms and generalized Rayleigh quotients.\n\nInput specification is implicit in the test suite below. You must implement the solution algorithmically; do not hard-code any closed-form expression specific to a particular numeric case other than algebraic consequences of the definitions.\n\nTest suite:\n- Case $1$: $T = 4$, $A_p = 1.1$, $B_p = 1.0$, $K = 0.6$, $W = 1.0$, $\\sigma^2 = 0.25$, $\\gamma = 1.0$.\n- Case $2$: $T = 4$, $A_p = 1.1$, $B_p = 1.0$, $K = 0.6$, $W = 1.0$, $\\sigma^2 = 0.25$, $\\gamma = 0.0$.\n- Case $3$: $T = 6$, $A_p = 1.05$, $B_p = 1.0$, $K = 0.3$, $W = 2.0$, $\\sigma^2 = 1.0$, $\\gamma = 5.0$.\n- Case $4$: $T = 3$, $A_p = 0.9$, $B_p = 1.0$, $K = 0.2$, $W = 1.0$, $\\sigma^2 = 0.01$, $\\gamma = 0.1$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a two-element list $[J_{\\text{dam}}(a^\\star), \\sum_{t=0}^{T-1} \\frac{(a_t^\\star)^2}{\\sigma^2}]$ in the same order as the test suite. For example, the output must look like $[[r_{1,1},r_{1,2}],[r_{2,1},r_{2,2}],\\dots]$ with no additional text.",
            "solution": "The problem is to find an attack sequence $\\mathbf{a} = [a_0, a_1, \\dots, a_{T-1}]^\\top$ that solves the following optimization problem:\n$$\n\\begin{align*}\n\\underset{\\mathbf{a} \\in \\mathbb{R}^T}{\\text{maximize}}  \\quad J_{\\text{dam}} = W \\left(\\sum_{k=0}^{T-1} h_k a_k\\right)^2 \\\\\n\\text{subject to}  \\quad \\sum_{k=0}^{T-1} \\frac{a_k^2}{\\sigma^2} \\le \\gamma\n\\end{align*}\n$$\nLet $\\mathbf{h} = [h_0, h_1, \\dots, h_{T-1}]^\\top$. The objective function is $J_{\\text{dam}} = W (\\mathbf{h}^\\top \\mathbf{a})^2$, and the constraint is $\\|\\mathbf{a}\\|_2^2 \\le \\gamma \\sigma^2$. The coefficients are given by $h_k = -(B_p K) A_c^{T-1-k}$, where $A_c = A_p - B_p K$.\n\nFirst, consider the trivial cases. If $W=0$, $\\gamma=0$, or $B_p K=0$ (which implies $\\mathbf{h}=\\mathbf{0}$), the maximum achievable damage is $0$. The optimal attack is $\\mathbf{a}^\\star = \\mathbf{0}$, which is feasible and uses zero detection energy.\n\nFor the general case ($W  0, \\gamma  0, \\mathbf{h} \\ne \\mathbf{0}$), we want to maximize $(\\mathbf{h}^\\top \\mathbf{a})^2$. By the Cauchy-Schwarz inequality, $(\\mathbf{h}^\\top \\mathbf{a})^2 \\le (\\|\\mathbf{h}\\|_2^2) (\\|\\mathbf{a}\\|_2^2)$.\nTo maximize the objective, the attacker should use the entire detection budget, meaning the constraint is met with equality: $\\|\\mathbf{a}\\|_2^2 = \\gamma \\sigma^2$. Substituting this into the inequality gives the upper bound on the squared term:\n$$ (\\mathbf{h}^\\top \\mathbf{a})^2 \\le \\|\\mathbf{h}\\|_2^2 (\\gamma \\sigma^2) $$\nThis bound is achievable when $\\mathbf{a}$ is collinear with $\\mathbf{h}$ (i.e., $\\mathbf{a} = c\\mathbf{h}$ for some scalar $c$). The optimal attack vector $\\mathbf{a}^\\star$ will be of this form and will satisfy the budget constraint with equality.\n$$ \\|\\mathbf{a}^\\star\\|_2^2 = \\|c \\mathbf{h}\\|_2^2 = c^2 \\|\\mathbf{h}\\|_2^2 = \\gamma \\sigma^2 $$\nThe maximum damage is achieved by substituting the upper bound into the objective function:\n$$ J_{\\text{dam}}^\\star = W \\cdot \\max_{\\mathbf{a}} (\\mathbf{h}^\\top \\mathbf{a})^2 = W (\\|\\mathbf{h}\\|_2^2)(\\gamma \\sigma^2) $$\nThe detection energy consumed by this optimal attack $\\mathbf{a}^\\star$ is, by design, the maximum allowed by the budget:\n$$ \\sum_{k=0}^{T-1} \\frac{(a_k^\\star)^2}{\\sigma^2} = \\frac{\\|\\mathbf{a}^\\star\\|_2^2}{\\sigma^2} = \\frac{\\gamma \\sigma^2}{\\sigma^2} = \\gamma $$\nThus, for non-trivial cases, the optimal damage is $W \\gamma \\sigma^2 \\|\\mathbf{h}\\|_2^2$, and the detection energy is $\\gamma$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained optimization problem for multiple test cases.\n    \"\"\"\n    # Test suite from the problem statement.\n    # Format: (T, A_p, B_p, K, W, sigma^2, gamma)\n    test_cases = [\n        (4, 1.1, 1.0, 0.6, 1.0, 0.25, 1.0),\n        (4, 1.1, 1.0, 0.6, 1.0, 0.25, 0.0),\n        (6, 1.05, 1.0, 0.3, 2.0, 1.0, 5.0),\n        (3, 0.9, 1.0, 0.2, 1.0, 0.01, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, A_p, B_p, K, W, sigma2, gamma = case\n\n        # If W, gamma, or Bp*K is zero, the damage is zero, and an optimal attack\n        # can be the zero vector, consuming zero energy.\n        bp_k_prod = B_p * K\n        if W == 0 or gamma == 0 or bp_k_prod == 0:\n            J_dam_star = 0.0\n            energy = 0.0\n            results.append([J_dam_star, energy])\n            continue\n\n        # Calculate closed-loop matrix Ac\n        A_c = A_p - bp_k_prod\n\n        # Construct the vector h\n        h_coeffs = np.zeros(T)\n        for k in range(T):\n            h_coeffs[k] = -bp_k_prod * (A_c**(T - 1 - k))\n\n        # Calculate the squared L2-norm of h\n        h_norm_sq = np.sum(h_coeffs**2)\n\n        # Calculate the optimal damage J_dam^*\n        # J_dam_star = W * (||h||^2 * gamma * sigma^2)\n        J_dam_star = W * gamma * sigma2 * h_norm_sq\n\n        # The detection energy consumed by an optimal attack is the budget gamma\n        energy = gamma\n\n        results.append([J_dam_star, energy])\n\n    # Final print statement in the exact required format.\n    # The format [[r11,r12],[r21,r22],...] is produced by default when printing a list of lists.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}