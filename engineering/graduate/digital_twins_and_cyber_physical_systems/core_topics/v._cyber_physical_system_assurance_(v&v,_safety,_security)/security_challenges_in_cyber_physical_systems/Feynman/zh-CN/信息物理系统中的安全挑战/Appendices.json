{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握信息物理系统（CPS）的安全性，不仅需要理论知识，还需要动手实践来分析漏洞和攻击策略。本章提供了一系列实践练习，旨在培养这些关键技能，从理解攻击的基本原理到评估其潜在影响，再到模拟高级攻击者的策略。\n\n首先，我们来探讨“隐蔽攻击”或“不可观测攻击”这一核心概念。这类攻击能够巧妙地篡改传感器读数，但不会触发基于模型的异常检测系统发出警报。本练习将引导你通过推导一个线性系统中此类攻击所需满足的精确数学条件，来建立对这一问题的基础理解，这对于认识基于残差的检测方法的根本局限性至关重要。",
            "id": "4244500",
            "problem": "在信息物理系统 (CPS) 的线性化监控层中，数字孪生使用静态测量模型 $y \\in \\mathbb{R}^{m}$，由 $y = Hx + e$ 给出，其中 $x \\in \\mathbb{R}^{n}$ 是系统状态，$H \\in \\mathbb{R}^{m \\times n}$ 是测量矩阵，$e \\in \\mathbb{R}^{m}$ 是测量噪声。基于残差的坏数据检测器计算残差 $r = y - H\\hat{x}$，其中状态估计 $\\hat{x}$ 是通过最小二乘估计器得到的，$\\hat{x} \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y - Hz\\|_{2}$。攻击者注入一个虚假数据向量 $a \\in \\mathbb{R}^{m}$，使得测量向量变为 $y' = y + a$。如果攻击下的残差等于标称残差，即 $r' = r$，则称该攻击是不可观测的，其中 $r' = y' - H\\hat{x}'$ 且 $\\hat{x}'$ 是从 $y'$ 得到的最小二乘估计。\n\n仅从欧几里得空间中的最小二乘投影和残差的定义出发，推导所有不可观测攻击的代数表征。将最终结果表示为一个通用不可观测攻击向量的闭式表达式，该表达式仅包含 $H$ 和一个自由参数。你的最终答案必须是一个单一的闭式表达式，且不包含任何文字。",
            "solution": "该问题要求推导所有不可观测攻击向量 $a$ 的代数表征。如果注入虚假数据后测量残差保持不变，则攻击被定义为不可观测的。\n\n让我们从给定的定义开始。标称测量模型为 $y = Hx + e$，其中 $y \\in \\mathbb{R}^{m}$，$x \\in \\mathbb{R}^{n}$，$H \\in \\mathbb{R}^{m \\times n}$，$e \\in \\mathbb{R}^{m}$。状态估计 $\\hat{x}$ 通过最小二乘法获得：\n$$ \\hat{x} \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y - Hz\\|_{2} $$\n这个最小化问题有一个独特的几何解释。向量 $H\\hat{x}$ 是测量向量 $y$ 在矩阵 $H$ 的列空间（我们记作 $\\text{Im}(H)$）上的正交投影。设 $P_{H}$ 是将 $\\mathbb{R}^{m}$ 中的向量投影到子空间 $\\text{Im}(H)$ 上的正交投影矩阵。那么，我们可以写出：\n$$ H\\hat{x} = P_{H}y $$\n标称残差向量 $r$ 定义为 $r = y - H\\hat{x}$。代入 $H\\hat{x}$ 的表达式，我们得到：\n$$ r = y - P_{H}y = (I - P_{H})y $$\n这里，$I$ 是 $m \\times m$ 的单位矩阵。矩阵 $I - P_{H}$ 本身也是一个投影矩阵。它将向量投影到 $\\text{Im}(H)$ 的正交补上，也就是 $H$ 的转置的零空间，记作 $\\mathcal{N}(H^T)$。\n\n现在，我们考虑受攻击的系统。攻击者注入一个虚假数据向量 $a \\in \\mathbb{R}^{m}$，产生一个新的测量向量 $y' = y + a$。攻击下的最小二乘估计 $\\hat{x}'$ 通过最小化 $\\|y' - Hz\\|_{2}$ 找到：\n$$ \\hat{x}' \\in \\arg\\min_{z \\in \\mathbb{R}^{n}} \\|y' - Hz\\|_{2} $$\n与标称情况类似，得到的向量 $H\\hat{x}'$ 是受攻击的测量向量 $y'$ 在 $H$ 的列空间上的正交投影：\n$$ H\\hat{x}' = P_{H}y' $$\n攻击下的残差 $r'$ 则为：\n$$ r' = y' - H\\hat{x}' = y' - P_{H}y' = (I - P_{H})y' $$\n如果残差不发生变化，即 $r' = r$，则攻击被定义为不可观测的。我们使用推导出的残差表达式来强制执行此条件：\n$$ (I - P_{H})y' = (I - P_{H})y $$\n将 $y' = y + a$ 代入此方程：\n$$ (I - P_{H})(y + a) = (I - P_{H})y $$\n根据矩阵-向量乘积的线性性质，我们可以展开方程的左侧：\n$$ (I - P_{H})y + (I - P_{H})a = (I - P_{H})y $$\n从两边减去项 $(I - P_{H})y$，我们得到一个仅关于攻击向量 $a$ 的条件：\n$$ (I - P_{H})a = 0 $$\n该方程表示攻击向量 $a$ 在子空间 $\\mathcal{N}(H^T)$ 上的投影是零向量。这仅当向量 $a$ 与 $\\mathcal{N}(H^T)$ 中的每个向量都正交时才成立。与 $\\mathcal{N}(H^T)$ 正交的所有向量的集合恰好是它的正交补 $(\\mathcal{N}(H^T))^{\\perp}$。根据线性代数基本定理，$H^T$ 的零空间的正交补是 $H$ 的列空间（像）。因此，该条件等价于：\n$$ a \\in \\text{Im}(H) $$\n这意味着要使攻击不可观测，攻击向量 $a$ 必须位于测量矩阵 $H$ 的列空间中。$H$ 的列空间中的任何向量都可以表示为 $H$ 的列的线性组合。这可以以一种紧凑的形式写出，即必须存在一个向量 $c \\in \\mathbb{R}^n$ 使得：\n$$ a = Hc $$\n向量 $c$ 是一个自由参数向量，它定义了一个特定的不可观测攻击。此表达式提供了所有不可观测攻击向量的完整代数表征。",
            "answer": "$$ \\boxed{Hc} $$"
        },
        {
            "introduction": "在理解了不可观测攻击的一般理论条件后，我们转向一个更具体的攻击场景，以分析其物理影响。时间同步在许多大型信息物理系统中至关重要，例如，广域电网保护系统依赖于来自不同地理位置的精确同步相量测量。本练习将探讨一个由网络攻击（例如GPS欺骗）引起的微小时间同步误差，如何导致系统对物理状态的严重误判，并可能引发保护继电器不必要的跳闸或在真实故障发生时未能动作。",
            "id": "4244553",
            "problem": "一个信息-物理电力系统中的输电线路采用线路电流差动保护方案，该方案通过在A和B两端进行时间同步相量测量来实现。每个终端都装有一个相量测量单元（PMU, Phasor Measurement Unit），该单元使用额定频率下的单周期离散傅里叶变换（DFT, Discrete Fourier Transform）根据均匀采样数据计算基频电流相量。在一个 $f_{0} = 60\\,\\text{Hz}$ 的系统中，采样率为 $f_{s} = 4800\\,\\text{Hz}$，因此每个额定周期使用 $N = 80$ 个样本。继电器计算差动电流决策变量，其值为幅值 $I_{\\text{diff}} = \\left| \\hat{I}_{A} + \\hat{I}_{B} \\right|$，其中 $\\hat{I}_{A}$ 和 $\\hat{I}_{B}$ 分别是A端和B端PMU产生的复相量估计值。在安全运行且为穿越性负荷（无内部故障）的情况下，真实的同步相量满足 $\\hat{I}_{B}^{\\text{true}} = -\\hat{I}_{A}^{\\text{true}}$，因为当采用一致的符号约定时，两端电流幅值相等，方向相反。\n\n一个攻击者成功地仅在B端引入了 $\\Delta t = 50\\,\\mu\\text{s}$ 的全球定位系统（GPS, Global Positioning System）时间偏移，导致B端的PMU在计算其DFT相量时，所使用的参考时间相对于A端发生了偏移。假设理想抗混叠、无测量噪声、采用矩形单周期窗，并且基频输入是额定频率 $f_{0}$ 下的完美正弦波。每个终端的穿越电流幅值为 $1.2$ 标幺值，基准值为 $I_{\\text{base}} = 2\\,\\text{kA}$，标幺值是在此基准上定义的。\n\n仅从均匀采样、基频下的N点DFT以及傅里叶分析中连续时间位移与复指数之间的关系等基本定义出发，推导仅由B端时间偏移引起的伪差动电流幅值 $I_{\\text{diff}}$ 的闭式表达式，并计算最小标幺值启动阈值 $T_{\\min}$，以确保继电器决策规则 $I_{\\text{diff}} > T$ 在所述穿越性负荷下不会误动。将 $T_{\\min}$ 以标幺值表示，并将您的答案四舍五入至四位有效数字。",
            "solution": "### 解\n\n该问题要求我们推导由两个测量终端之一的时间同步误差引起的伪差动电流幅值 $I_{\\text{diff}}$，然后确定防止误动的最小继电器整定值。\n\n设 $\\hat{I}_{A}^{\\text{true}}$ 和 $\\hat{I}_{B}^{\\text{true}}$ 分别为在穿越性负荷条件下，A端和B端电流的真实复相量。差动保护的一致性符号约定规定，流入被保护区域的电流为正。对于穿越性负荷，A端流入的电流等于B端流出的电流。因此，它们的真实相量幅值相等，方向相反：\n$$ \\hat{I}_{B}^{\\text{true}} = -\\hat{I}_{A}^{\\text{true}} $$\n每个终端的电流幅值给定为 $I_{\\text{mag}} = 1.2\\,\\text{p.u.}$。因此，我们有：\n$$ |\\hat{I}_{A}^{\\text{true}}| = |\\hat{I}_{B}^{\\text{true}}| = I_{\\text{mag}} = 1.2\\,\\text{p.u.} $$\n假设A端的PMU具有完美的时间参考。因此，其测量的相量 $\\hat{I}_{A}$ 等于真实相量：\n$$ \\hat{I}_{A} = \\hat{I}_{A}^{\\text{true}} $$\nB端的PMU受到 $\\Delta t = 50\\,\\mu\\text{s}$ 的时间偏移影响。这意味着其本地时钟相对于真实系统时间延迟了 $\\Delta t$。如果真实系统时间是 $t$，B端的PMU认为时间是 $t' = t - \\Delta t$。因此，当它在其认为的单周期窗口内执行DFT计算时，它实际上处理的是时间区间 $[t, t+T_0]$ 内的信号，而不是正确的时间区间 $[t', t'+T_0] = [t-\\Delta t, t-\\Delta t+T_0]$。这等效于分析信号的一个时间超前版本，$i_B(t'+\\Delta t)$。\n\n傅里叶变换的一个基本性质是，时域中的时间位移对应于频域中的相位移动。对于一个信号 $x(t)$，其傅里叶变换为 $X(\\omega)$，那么时移信号 $x(t - t_0)$ 的变换是 $X(\\omega)e^{-j\\omega t_0}$。反之，时间超前信号 $x(t+t_0)$ 的变换是 $X(\\omega)e^{j\\omega t_0}$。\n\nB端的PMU实际上测量的是信号 $i_B(t'+\\Delta t)$ 的相量。因此，测得的相量 $\\hat{I}_B$ 是真实相量 $\\hat{I}_B^{\\text{true}}$ 乘以一个对应于在基波角频率 $\\omega_0 = 2\\pi f_0$ 下时间超前 $\\Delta t$ 的复指数：\n$$ \\hat{I}_{B} = \\hat{I}_{B}^{\\text{true}} e^{j\\omega_0 \\Delta t} = \\hat{I}_{B}^{\\text{true}} e^{j2\\pi f_0 \\Delta t} $$\n现在，我们可以使用测量的相量来计算差动电流决策变量 $I_{\\text{diff}}$：\n$$ I_{\\text{diff}} = |\\hat{I}_{A} + \\hat{I}_{B}| $$\n代入测量相量的表达式：\n$$ I_{\\text{diff}} = |\\hat{I}_{A}^{\\text{true}} + \\hat{I}_{B}^{\\text{true}} e^{j2\\pi f_0 \\Delta t}| $$\n使用穿越性负荷条件 $\\hat{I}_{B}^{\\text{true}} = -\\hat{I}_{A}^{\\text{true}}$：\n$$ I_{\\text{diff}} = |\\hat{I}_{A}^{\\text{true}} - \\hat{I}_{A}^{\\text{true}} e^{j2\\pi f_0 \\Delta t}| $$\n提出因子 $\\hat{I}_{A}^{\\text{true}}$：\n$$ I_{\\text{diff}} = |\\hat{I}_{A}^{\\text{true}}(1 - e^{j2\\pi f_0 \\Delta t})| = |\\hat{I}_{A}^{\\text{true}}| |1 - e^{j2\\pi f_0 \\Delta t}| $$\n令 $\\theta = 2\\pi f_0 \\Delta t$。表达式变为：\n$$ I_{\\text{diff}} = I_{\\text{mag}} |1 - e^{j\\theta}| $$\n为计算幅值 $|1 - e^{j\\theta}|$，我们使用欧拉公式 $e^{j\\theta} = \\cos(\\theta) + j\\sin(\\theta)$：\n$$ |1 - e^{j\\theta}| = |1 - (\\cos(\\theta) + j\\sin(\\theta))| = |(1 - \\cos(\\theta)) - j\\sin(\\theta)| $$\n复数 $x+jy$ 的幅值为 $\\sqrt{x^2+y^2}$：\n$$ |1 - e^{j\\theta}| = \\sqrt{(1-\\cos(\\theta))^2 + (-\\sin(\\theta))^2} = \\sqrt{1 - 2\\cos(\\theta) + \\cos^2(\\theta) + \\sin^2(\\theta)} $$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$ |1 - e^{j\\theta}| = \\sqrt{1 - 2\\cos(\\theta) + 1} = \\sqrt{2(1 - \\cos(\\theta))} $$\n使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$ |1 - e^{j\\theta}| = \\sqrt{2(2\\sin^2\\left(\\frac{\\theta}{2}\\right))} = \\sqrt{4\\sin^2\\left(\\frac{\\theta}{2}\\right)} = \\left|2\\sin\\left(\\frac{\\theta}{2}\\right)\\right| $$\n将此结果代回 $I_{\\text{diff}}$ 的表达式：\n$$ I_{\\text{diff}} = I_{\\text{mag}} \\left|2\\sin\\left(\\frac{2\\pi f_0 \\Delta t}{2}\\right)\\right| = 2I_{\\text{mag}} |\\sin(\\pi f_0 \\Delta t)| $$\n因为 $f_0 = 60\\,\\text{Hz}$ 和 $\\Delta t = 50 \\times 10^{-6}\\,\\text{s}$ 均为正值，所以参数 $\\pi f_0 \\Delta t$ 是一个小的正角度，其正弦值为正。因此，绝对值是多余的。伪差动电流的最终闭式表达式为：\n$$ I_{\\text{diff}} = 2 I_{\\text{mag}} \\sin(\\pi f_0 \\Delta t) $$\n这完成了任务的第一部分。\n\n对于第二部分，我们必须找到防止误动的最小启动阈值 $T_{\\min}$。继电器的动作条件是 $I_{\\text{diff}} > T$。为了在这种情况下保持安全（不动作），阈值 $T$ 必须设置得大于或等于计算出的 $I_{\\text{diff}}$。因此，该阈值的最小值等于我们刚刚推导出的 $I_{\\text{diff}}$ 的值。\n$$ T_{\\min} = I_{\\text{diff}} = 2 I_{\\text{mag}} \\sin(\\pi f_0 \\Delta t) $$\n我们代入给定的数值：$I_{\\text{mag}} = 1.2\\,\\text{p.u.}$，$f_0 = 60\\,\\text{Hz}$，以及 $\\Delta t = 50 \\times 10^{-6}\\,\\text{s}$。\n$$ T_{\\min} = 2(1.2) \\sin(\\pi \\cdot 60 \\cdot 50 \\times 10^{-6}) $$\n$$ T_{\\min} = 2.4 \\sin(3000 \\pi \\times 10^{-6}) $$\n$$ T_{\\min} = 2.4 \\sin(0.003\\pi) $$\n正弦函数的参数以弧度为单位。现在我们计算数值：\n$$ 0.003\\pi \\approx 0.009424778\\,\\text{rad} $$\n$$ T_{\\min} = 2.4 \\times \\sin(0.009424778) \\approx 2.4 \\times 0.009424433 $$\n$$ T_{\\min} \\approx 0.02261864\\,\\text{p.u.} $$\n问题要求将答案四舍五入到四位有效数字。\n$$ T_{\\min} \\approx 0.02262\\,\\text{p.u.} $$\n这是为确保继电器不会因指定的 $50\\,\\mu\\text{s}$ 时间同步误差而误动所需的最小标幺值启动阈值。",
            "answer": "$$ \\boxed{0.02262} $$"
        },
        {
            "introduction": "在前述概念的基础上，我们将视角转换为攻击者，以一种更高级的方式审视系统脆弱性。一个理性的、资源充足的攻击者不仅仅是随机注入错误数据，而是会精心设计攻击策略，以在最小化自身暴露风险的同时最大化对物理系统的破坏。本练习将这种复杂的对抗行为建模为一个约束优化问题，要求你计算出在给定的检测预算内，能够造成最大物理损害的“最坏情况”攻击序列，这有助于从高级对抗性视角来评估和加固系统。",
            "id": "4244570",
            "problem": "考虑一个离散时间的网络物理系统 (CPS)，其具有单一测量输出和单一控制输入。物理设备被建模为一个线性时不变 (LTI) 系统，其状态更新方程为 $x_{t+1} = A_p x_t + B_p u_t$，部署的控制器使用静态输出反馈 $u_t = -K y_t$，其中测量信号为 $y_t = x_t + a_t$。此处，$x_t$ 是真实状态，$u_t$ 是控制输入，$A_p$ 和 $B_p$ 是常数系统矩阵（在此问题中为标量），$K$ 是一个标量静态反馈增益，$a_t$ 是攻击者在离散时间 $t$ 注入的虚假数据（标量）。\n\n一个操作员部署了一个基于广义似然比检验 (GLRT) 的检测器，用于在独立同分布的零均值高斯噪声（方差为 $\\sigma^2$）下的测量信道。在没有攻击的情况下，一个有限时域 $T$ 步内的关注统计量被建模为标准化新息的平方和，其服从中心卡方分布。在一个确定的攻击序列 $\\{a_t\\}_{t=0}^{T-1}$ 下，检测统计量对应于一个非中心卡方分布，其非中心化参数与二次型 $\\sum_{t=0}^{T-1} a_t^2 / \\sigma^2$ 成正比。对于固定的虚警率和检测阈值，最小化时域内的检测概率等同于将此非中心化参数保持在预定预算之下。\n\n假设初始状态为零，$x_0 = 0$。令 $A_c = A_p - B_p K$ 表示闭环矩阵。攻击者旨在最大化物理损害，该损害量化为终端时间 $T$ 时状态的加权平方偏差，即 $J_{\\text{dam}} = W x_T^2$（其中 $W \\ge 0$），同时通过遵守 GLRT 非中心化参数的上限来最小化检测概率。这产生了以下关于攻击序列 $a = [a_0,\\dots,a_{T-1}]^\\top$ 的约束优化问题：\n- 闭环动力学意味着 $x_{t+1} = A_c x_t - B_p K a_t$，因此 $x_T = \\sum_{k=0}^{T-1} h_k a_k$，其中 $h_k = -(B_p K) A_c^{T-1-k}$。\n- 损害目标是 $J_{\\text{dam}} = W x_T^2 = W \\left(\\sum_{k=0}^{T-1} h_k a_k\\right)^2$。\n- 检测能量预算约束为 $\\sum_{t=0}^{T-1} \\frac{a_t^2}{\\sigma^2} \\le \\gamma$，其中 $\\gamma \\ge 0$ 是一个根据检测器设计和可接受的漏检权衡得出的预定界限。\n\n你的任务是：\n- 对每个测试用例，计算一个攻击序列 $a^\\star$，该序列在检测能量预算约束下最大化 $J_{\\text{dam}}$，然后报告两个标量：实现的最优损害 $J_{\\text{dam}}(a^\\star)$ 和相应的检测能量 $\\sum_{t=0}^{T-1} \\frac{(a_t^\\star)^2}{\\sigma^2}$。\n- 此问题中的所有量都是无量纲的标量；不需要物理单位。\n\n使用的基础知识：\n- 线性时不变动力学 $x_{t+1} = A_p x_t + B_p u_t$ 和静态输出反馈 $u_t = -K y_t$，$y_t = x_t + a_t$。\n- 对于方差为 $\\sigma^2$ 的高斯噪声，确定性信号下的 GLRT 非中心化参数等于加权能量 $\\sum_{t=0}^{T-1} a_t^2 / \\sigma^2$。\n- 二次型和广义瑞利商的性质。\n\n输入规范隐含在下面的测试套件中。你必须通过算法实现解决方案；除了定义的代数结果外，不要硬编码任何特定于数值情况的封闭形式表达式。\n\n测试套件：\n- 情况 1：$T = 4$, $A_p = 1.1$, $B_p = 1.0$, $K = 0.6$, $W = 1.0$, $\\sigma^2 = 0.25$, $\\gamma = 1.0$。\n- 情况 2：$T = 4$, $A_p = 1.1$, $B_p = 1.0$, $K = 0.6$, $W = 1.0$, $\\sigma^2 = 0.25$, $\\gamma = 0.0$。\n- 情况 3：$T = 6$, $A_p = 1.05$, $B_p = 1.0$, $K = 0.3$, $W = 2.0$, $\\sigma^2 = 1.0$, $\\gamma = 5.0$。\n- 情况 4：$T = 3$, $A_p = 0.9$, $B_p = 1.0$, $K = 0.2$, $W = 1.0$, $\\sigma^2 = 0.01$, $\\gamma = 0.1$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按照测试套件的相同顺序输出一个双元素列表 $[J_{\\text{dam}}(a^\\star), \\sum_{t=0}^{T-1} \\frac{(a_t^\\star)^2}{\\sigma^2}]$。例如，输出必须类似于 $[[r_{1,1},r_{1,2}],[r_{2,1},r_{2,2}],\\dots]$，不带任何额外文本。",
            "solution": "问题是找到一个攻击序列 $\\mathbf{a} = [a_0, a_1, \\dots, a_{T-1}]^\\top$ 来解决以下优化问题：\n$$\n\\begin{align*}\n\\underset{\\mathbf{a} \\in \\mathbb{R}^T}{\\text{maximize}}  \\quad J_{\\text{dam}} = W \\left(\\sum_{k=0}^{T-1} h_k a_k\\right)^2 \\\\\n\\text{subject to}  \\quad \\sum_{k=0}^{T-1} \\frac{a_k^2}{\\sigma^2} \\le \\gamma\n\\end{align*}\n$$\n其中参数 $W$、$\\sigma^2$ 和 $\\gamma$ 是非负的，系数 $h_k$ 由系统动力学决定。\n\n首先，我们用向量表示法来表达该问题。令 $\\mathbf{h} = [h_0, h_1, \\dots, h_{T-1}]^\\top$。目标函数变为最大化 $J_{\\text{dam}} = W (\\mathbf{h}^\\top \\mathbf{a})^2$。约束可以写成欧几里得范数的平方形式，$\\|\\mathbf{a}\\|_2^2 = \\sum_{k=0}^{T-1} a_k^2$，即 $\\|\\mathbf{a}\\|_2^2 \\le \\gamma \\sigma^2$。\n\n系数 $h_k$ 定义为 $h_k = -(B_p K) A_c^{T-1-k}$，其中 $k \\in \\{0, 1, \\dots, T-1\\}$，且 $A_c = A_p - B_p K$。这些系数仅取决于系统参数和时间范围 $T$。\n\n我们分析这个优化问题。如果 $W=0$，目标 $J_{\\text{dam}}$ 总是 $0$。任何可行的攻击序列 $\\mathbf{a}$ 都是一个最大化解。一个规范的选择是零能量攻击 $\\mathbf{a}^\\star = \\mathbf{0}$，对于 $\\gamma \\ge 0$ 这总是可行的。这得到的最优损害为 $J_{\\text{dam}}^\\star = 0$，相应的检测能量为 $0$。\n\n类似地，如果 $\\gamma=0$，约束 $\\|\\mathbf{a}\\|_2^2 \\le 0$ 意味着唯一可行的攻击是 $\\mathbf{a} = \\mathbf{0}$。这导致 $J_{\\text{dam}}^\\star = 0$ 和检测能量为 $0$。\n\n最后，如果向量 $\\mathbf{h}$ 是零向量（即 $\\mathbf{h} = \\mathbf{0}$），这种情况在 $B_p K = 0$ 时发生，那么无论攻击 $\\mathbf{a}$ 如何，项 $\\mathbf{h}^\\top \\mathbf{a}$ 总是 $0$。因此目标 $J_{\\text{dam}}$ 恒为 $0$。与 $W=0$ 的情况一样，我们可以选择 $\\mathbf{a}^\\star = \\mathbf{0}$，从而得到 $J_{\\text{dam}}^\\star = 0$ 和零检测能量。\n\n现在，考虑一般情况，其中 $W > 0$，$\\gamma > 0$，且 $\\mathbf{h} \\ne \\mathbf{0}$。为了最大化 $W (\\mathbf{h}^\\top \\mathbf{a})^2$，我们必须最大化 $|\\mathbf{h}^\\top \\mathbf{a}|$。\n根据柯西-施瓦茨不等式，我们有：\n$$\n(\\mathbf{h}^\\top \\mathbf{a})^2 \\le (\\|\\mathbf{h}\\|_2^2) (\\|\\mathbf{a}\\|_2^2)\n$$\n将约束 $\\|\\mathbf{a}\\|_2^2 \\le \\gamma \\sigma^2$ 代入此不等式，得到目标核心项的一个上界：\n$$\n(\\mathbf{h}^\\top \\mathbf{a})^2 \\le \\|\\mathbf{h}\\|_2^2 (\\gamma \\sigma^2)\n$$\n这个上界是可以达到的。柯西-施瓦茨不等式中的等号成立当且仅当向量 $\\mathbf{a}$ 与向量 $\\mathbf{h}$ 共线，即 $\\mathbf{a} = c \\mathbf{h}$，其中 $c$ 是某个标量。\n\n为了最大化目标，攻击者应该利用全部可用预算。如果一个候选解 $\\mathbf{a}'$ 满足 $\\|\\mathbf{a}'\\|_2^2  \\gamma \\sigma^2$ 且 $\\mathbf{h}^\\top \\mathbf{a}' \\ne 0$，总可以通过一个因子 $\\alpha > 1$ 对其进行缩放，使得 $\\|\\alpha \\mathbf{a}'\\|_2^2 = \\gamma \\sigma^2$，这会增加目标值。因此，最优攻击 $\\mathbf{a}^\\star$ 必须使约束取等号：\n$$\n\\|\\mathbf{a}^\\star\\|_2^2 = \\gamma \\sigma^2\n$$\n将此与共线条件 $\\mathbf{a}^\\star = c \\mathbf{h}$ 结合，我们找到缩放因子 $c$ 的值：\n$$\n\\|\\mathbf{a}^\\star\\|_2^2 = \\|c \\mathbf{h}\\|_2^2 = c^2 \\|\\mathbf{h}\\|_2^2 = \\gamma \\sigma^2\n$$\n由于我们假设 $\\mathbf{h} \\ne \\mathbf{0}$，我们有 $\\|\\mathbf{h}\\|_2^2 > 0$，可以解出 $c^2$：\n$$\nc^2 = \\frac{\\gamma \\sigma^2}{\\|\\mathbf{h}\\|_2^2}\n$$\n$c$ 的符号不影响 $J_{\\text{dam}}$ 的值，该值取决于 $(\\mathbf{h}^\\top \\mathbf{a})^2$。因此，最优攻击序列为 $\\mathbf{a}^\\star = \\pm \\sqrt{\\frac{\\gamma \\sigma^2}{\\|\\mathbf{h}\\|_2^2}} \\mathbf{h}$。\n\n当 $(\\mathbf{h}^\\top \\mathbf{a})^2$ 达到其上界时，实现最大损害：\n$$\nJ_{\\text{dam}}^\\star = W \\cdot \\max_{\\mathbf{a}} (\\mathbf{h}^\\top \\mathbf{a})^2 = W (\\|\\mathbf{h}\\|_2^2)(\\gamma \\sigma^2)\n$$\n对应于此最优攻击 $\\mathbf{a}^\\star$ 的检测能量为：\n$$\n\\sum_{k=0}^{T-1} \\frac{(a_k^\\star)^2}{\\sigma^2} = \\frac{\\|\\mathbf{a}^\\star\\|_2^2}{\\sigma^2} = \\frac{\\gamma \\sigma^2}{\\sigma^2} = \\gamma\n$$\n\n总体算法如下：\n1.  对于给定的测试用例，其参数为 $T, A_p, B_p, K, W, \\sigma^2, \\gamma$，检查平凡情况。如果 $W=0$，$\\gamma=0$，或 $B_p K=0$，则最优损害为 $0$，报告的检测能量为 $0$。\n2.  否则，继续。计算 $A_c = A_p - B_p K$。\n3.  构建向量 $\\mathbf{h}$，其分量为 $h_k = -(B_p K) A_c^{T-1-k}$，其中 $k=0, \\dots, T-1$。\n4.  计算范数的平方 $\\|\\mathbf{h}\\|_2^2 = \\sum_{k=0}^{T-1} h_k^2$。\n5.  计算最大损害 $J_{\\text{dam}}^\\star = W \\gamma \\sigma^2 \\|\\mathbf{h}\\|_2^2$。\n6.  相应的检测能量为 $\\gamma$。\n7.  返回配对 $[J_{\\text{dam}}^\\star, \\gamma]$。",
            "answer": "[[0.11953125, 1.0], [0.0, 0.0], [17.5802264303125, 5.0], [0.00392, 0.1]]"
        }
    ]
}