{
    "hands_on_practices": [
        {
            "introduction": "A digital twin's value is directly tied to its fidelityâ€”how closely its behavior mirrors that of its physical counterpart. This first exercise provides a concrete method for quantifying this fidelity by calculating a time-averaged error metric between a model and a physical system . By analyzing the step responses of two first-order systems representing a digital twin and a physical thermal chamber, you will practice a fundamental skill in validation: translating dynamic performance into a single, meaningful score.",
            "id": "4246292",
            "problem": "A thermal chamber, modeled as a first-order linear time-invariant system, is part of a Cyber-Physical System (CPS) undergoing simulation-based testing with a digital twin. The chamber is excited by a unit step in heating power at time $t=0$, represented by an input $u(t)$ with $u(t)=1$ for $t\\ge 0$ and $u(t)=0$ for $t<0$. The digital twin uses a nominal energy balance model with scalar temperature state $x(t)$ satisfying the ordinary differential equation $\\tau_{m}\\,\\dot{x}(t)+x(t)=u(t)$, initial condition $x(0)=0$, and time constant $\\tau_{m}=10$ s. The physical chamber is well described by a similar first-order model but with a different gain and time constant, $\\tau_{p}\\,\\dot{x}(t)+x(t)=G\\,u(t)$, initial condition $x(0)=0$, where $G=0.9$ and $\\tau_{p}=12$ s. Both the simulation trace and the measurement sequence are thus represented by the continuous-time trajectories $x_{\\text{twin}}(t)$ and $x_{\\text{physical}}(t)$, respectively, for $t\\ge 0$.\n\nUsing the Euclidean norm on $\\mathbb{R}$ (which coincides with the absolute value), define the instantaneous fidelity error as $e(t)=\\|x_{\\text{twin}}(t)-x_{\\text{physical}}(t)\\|$ and the time-averaged fidelity metric over a finite horizon $[0,T]$ as $\\bar{e}=\\frac{1}{T}\\int_{0}^{T}e(t)\\,dt$. Taking $T=60$ s, compute $\\bar{e}$ by starting from the governing differential equations and their step responses. Express your final answer in Kelvin (K) and round your answer to four significant figures.",
            "solution": "The user wants to compute the time-averaged fidelity error $\\bar{e}$ between a digital twin and a physical thermal chamber, both modeled as first-order linear time-invariant (LTI) systems.\n\nThe governing ordinary differential equation (ODE) for the digital twin's temperature state, $x_{\\text{twin}}(t)$, is given by:\n$$ \\tau_{m}\\,\\dot{x}_{\\text{twin}}(t)+x_{\\text{twin}}(t)=u(t) $$\nwith initial condition $x_{\\text{twin}}(0)=0$ and time constant $\\tau_{m}=10$ s.\n\nThe governing ODE for the physical chamber's temperature state, $x_{\\text{physical}}(t)$, is given by:\n$$ \\tau_{p}\\,\\dot{x}_{\\text{physical}}(t)+x_{\\text{physical}}(t)=G\\,u(t) $$\nwith initial condition $x_{\\text{physical}}(0)=0$, gain $G=0.9$, and time constant $\\tau_{p}=12$ s.\n\nThe input $u(t)$ is a unit step function, meaning $u(t)=1$ for $t \\ge 0$ and $u(t)=0$ for $t < 0$. The temperature states $x_{\\text{twin}}(t)$ and $x_{\\text{physical}}(t)$ are therefore in units of Kelvin (K), assuming the input has units of Watts and the gain has units of K/W.\n\nFirst, we solve for the step response of each system for $t \\ge 0$. The general solution to the ODE $\\tau\\,\\dot{x}(t)+x(t)=K\\,u(t)$ with $x(0)=0$ and $u(t)=1$ is the standard first-order step response:\n$$ x(t) = K(1 - \\exp(-t/\\tau)) $$\n\nFor the digital twin, the steady-state gain is $K=1$ and the time constant is $\\tau = \\tau_m$. The solution is:\n$$ x_{\\text{twin}}(t) = 1 - \\exp(-t/\\tau_m) $$\n\nFor the physical chamber, the steady-state gain is $K=G$ and the time constant is $\\tau = \\tau_p$. The solution is:\n$$ x_{\\text{physical}}(t) = G(1 - \\exp(-t/\\tau_p)) $$\n\nThe instantaneous fidelity error is defined as $e(t)=|x_{\\text{twin}}(t)-x_{\\text{physical}}(t)|$. Let's compute the difference inside the absolute value:\n$$ x_{\\text{twin}}(t)-x_{\\text{physical}}(t) = \\left(1 - \\exp(-t/\\tau_m)\\right) - G\\left(1 - \\exp(-t/\\tau_p)\\right) $$\n$$ = 1 - \\exp(-t/\\tau_m) - G + G\\exp(-t/\\tau_p) $$\n$$ = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) $$\nLet's define the function $f(t) = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p)$. We need to determine the sign of $f(t)$ for $t \\ge 0$ to resolve the absolute value.\nAt $t=0$, $f(0) = (1-G) - \\exp(0) + G\\exp(0) = 1-G-1+G = 0$.\nAs $t \\to \\infty$, $f(t) \\to (1-G) - 0 + 0 = 1-G$. With $G=0.9$, this limit is $0.1$, which is positive.\nLet's analyze the derivative of $f(t)$:\n$$ f'(t) = \\frac{d}{dt}\\left[ (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) \\right] = \\frac{1}{\\tau_m}\\exp(-t/\\tau_m) - \\frac{G}{\\tau_p}\\exp(-t/\\tau_p) $$\nSubstituting the given values $\\tau_m=10$, $\\tau_p=12$, and $G=0.9$:\n$$ f'(t) = \\frac{1}{10}\\exp(-t/10) - \\frac{0.9}{12}\\exp(-t/12) = 0.1\\exp(-t/10) - 0.075\\exp(-t/12) $$\nAt $t=0$, $f'(0) = 0.1 - 0.075 = 0.025 > 0$.\nSince $f(0)=0$ and $f'(t)$ is initially positive, the function $f(t)$ increases from $0$ and becomes positive for small $t > 0$. The function eventually approaches a positive limit of $1-G$. A more detailed analysis shows that $f(t)$ has a single maximum and remains non-negative for all $t \\ge 0$. Therefore, we can drop the absolute value, so $e(t) = f(t)$.\n$$ e(t) = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) $$\n\nNext, we compute the time-averaged fidelity metric, $\\bar{e}$, over the horizon $[0, T]$:\n$$ \\bar{e} = \\frac{1}{T}\\int_{0}^{T}e(t)\\,dt = \\frac{1}{T}\\int_{0}^{T} \\left[ (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) \\right] dt $$\nWe integrate term by term:\n$$ \\int_{0}^{T} (1-G)\\,dt = (1-G)T $$\n$$ \\int_{0}^{T} -\\exp(-t/\\tau_m)\\,dt = \\left[ \\tau_m \\exp(-t/\\tau_m) \\right]_{0}^{T} = \\tau_m(\\exp(-T/\\tau_m) - 1) = -\\tau_m(1 - \\exp(-T/\\tau_m)) $$\n$$ \\int_{0}^{T} G\\exp(-t/\\tau_p)\\,dt = \\left[ -G\\tau_p \\exp(-t/\\tau_p) \\right]_{0}^{T} = -G\\tau_p(\\exp(-T/\\tau_p) - 1) = G\\tau_p(1 - \\exp(-T/\\tau_p)) $$\nCombining these results:\n$$ \\int_{0}^{T}e(t)\\,dt = (1-G)T - \\tau_m(1 - \\exp(-T/\\tau_m)) + G\\tau_p(1 - \\exp(-T/\\tau_p)) $$\nDividing by $T$ gives the average error $\\bar{e}$:\n$$ \\bar{e} = (1-G) - \\frac{\\tau_m}{T}(1 - \\exp(-T/\\tau_m)) + \\frac{G\\tau_p}{T}(1 - \\exp(-T/\\tau_p)) $$\nNow, we substitute the numerical values: $G=0.9$, $\\tau_m=10$ s, $\\tau_p=12$ s, and $T=60$ s.\n$$ \\bar{e} = (1 - 0.9) - \\frac{10}{60}(1 - \\exp(-60/10)) + \\frac{0.9 \\times 12}{60}(1 - \\exp(-60/12)) $$\n$$ \\bar{e} = 0.1 - \\frac{1}{6}(1 - \\exp(-6)) + \\frac{10.8}{60}(1 - \\exp(-5)) $$\n$$ \\bar{e} = 0.1 - \\frac{1}{6}(1 - \\exp(-6)) + 0.18(1 - \\exp(-5)) $$\nUsing a calculator for the exponential terms:\n$$ \\exp(-6) \\approx 0.00247875 $$\n$$ \\exp(-5) \\approx 0.00673795 $$\nSubstituting these values into the expression for $\\bar{e}$:\n$$ \\bar{e} \\approx 0.1 - \\frac{1}{6}(1 - 0.00247875) + 0.18(1 - 0.00673795) $$\n$$ \\bar{e} \\approx 0.1 - \\frac{1}{6}(0.99752125) + 0.18(0.99326205) $$\n$$ \\bar{e} \\approx 0.1 - 0.16625354 + 0.17878717 $$\n$$ \\bar{e} \\approx -0.06625354 + 0.17878717 $$\n$$ \\bar{e} \\approx 0.11253363 $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\bar{e} \\approx 0.1125 $$\nThe units of $\\bar{e}$ are the same as the units of $x(t)$, which are Kelvin (K).",
            "answer": "$$\\boxed{0.1125}$$"
        },
        {
            "introduction": "Beyond simple error metrics, simulation-based testing enables the verification of complex operational rules and safety requirements. This practice introduces Signal Temporal Logic (STL), a formal language for expressing such properties, and the key concept of quantitative robustness . By calculating the robustness score for a safety requirement imposed on a vehicle's velocity profile, you will learn how formal methods provide not just a pass/fail verdict, but also a measure of how well a system satisfies or violates a specification.",
            "id": "4246326",
            "problem": "A digital twin of a ground vehicle in a Cyber-Physical System (CPS) is used for simulation-based testing against formal safety requirements specified in Signal Temporal Logic (STL). Consider the STL formula $\\varphi = \\mathbf{G}_{[0,10]}(v < 30)$, which encodes the requirement that the vehicle velocity must remain strictly below $30$ over the first $10$ seconds of a simulated run. The simulated velocity signal is continuous-time and given by $v(t) = 29 + \\frac{t}{2} - \\frac{t^{2}}{40}$ for $t \\in [0,10]$, where $t$ is time in seconds and $v$ is velocity in $\\mathrm{m/s}$. \n\nStarting from the formal robust semantics of Signal Temporal Logic (STL) for atomic predicates and the $\\mathbf{G}$ (globally) operator over continuous-time signals, derive the robustness of $\\varphi$ with respect to $v(t)$ over the interval $[0,10]$. Then interpret the value in terms of pass/fail confidence of the simulation against the requirement. Express the final robustness value in $\\mathrm{m/s}$. Provide the exact value; no rounding is required. The final answer must be a single real-valued number.",
            "solution": "The solution requires applying the formal robust semantics of Signal Temporal Logic (STL). The given STL formula is $\\varphi = \\mathbf{G}_{[0,10]}(v < 30)$. This formula is composed of an atomic predicate, $\\mu \\equiv (v < 30)$, and a temporal operator, $\\mathbf{G}_{[0,10]}$ (Globally over the interval $[0,10]$).\n\nFirst, we define the robustness of the atomic predicate $\\mu$. For a signal value $v(t)$ at time $t$, the robustness of the predicate $(v < c)$ is defined as the signed distance from $v(t)$ to the boundary $v=c$. Formally, this is given by:\n$$\n\\rho(\\mu, v, t) = c - v(t)\n$$\nIn our case, $c=30$, so the robustness function for the atomic predicate is:\n$$\nr(t) = \\rho((v < 30), v, t) = 30 - v(t)\n$$\nA positive value of $r(t)$ at a given time $t$ indicates that the predicate is satisfied, while a negative value indicates it is violated.\n\nNext, we define the robustness for the \"Globally\" operator, $\\mathbf{G}_{[t_1, t_2]}$. The robustness of the formula $\\mathbf{G}_{[t_1, t_2]} \\mu$ with respect to a signal $v$ is the minimum (infimum for continuous time) of the robustness of the predicate $\\mu$ over the specified time interval. For our formula $\\varphi = \\mathbf{G}_{[0,10]}(v < 30)$, the robustness is:\n$$\n\\rho(\\varphi, v, 0) = \\inf_{t \\in [0,10]} r(t) = \\inf_{t \\in [0,10]} (30 - v(t))\n$$\nWe are given the velocity signal $v(t) = 29 + \\frac{t}{2} - \\frac{t^{2}}{40}$. We substitute this into the expression for $r(t)$:\n$$\nr(t) = 30 - \\left(29 + \\frac{t}{2} - \\frac{t^{2}}{40}\\right) = 1 - \\frac{t}{2} + \\frac{t^{2}}{40}\n$$\nTo find the infimum of $r(t)$ on the closed interval $[0,10]$, we must find the global minimum of this function on that interval. Since $r(t)$ is a continuous and differentiable function (a quadratic polynomial), the minimum will occur either at a critical point within the interval or at the boundaries of the interval ($t=0$ or $t=10$).\n\nWe find the critical points by taking the derivative of $r(t)$ with respect to $t$ and setting it to zero:\n$$\n\\frac{dr}{dt} = \\frac{d}{dt} \\left(1 - \\frac{t}{2} + \\frac{t^{2}}{40}\\right) = -\\frac{1}{2} + \\frac{2t}{40} = \\frac{t}{20} - \\frac{1}{2}\n$$\nSetting the derivative to zero to find the critical point $t_c$:\n$$\n\\frac{t_c}{20} - \\frac{1}{2} = 0 \\implies \\frac{t_c}{20} = \\frac{1}{2} \\implies t_c = 10\n$$\nThe only critical point occurs at $t=10$, which is one of the boundaries of our interval. The function $r(t)$ is a parabola opening upwards (since the coefficient of the $t^2$ term, $\\frac{1}{40}$, is positive), so its vertex is at this critical point. This means the function's minimum over any interval including $t=10$ and values less than $10$ will be at $t=10$.\n\nTo confirm, we can analyze the sign of the derivative for $t \\in [0,10)$. On this interval, $\\frac{dr}{dt} = \\frac{t-10}{20}$ is always negative. Therefore, the function $r(t)$ is monotonically decreasing over the entire interval $[0,10]$. Consequently, the minimum value of $r(t)$ on this interval must occur at the right endpoint, $t=10$.\n\nNow, we evaluate $r(t)$ at this minimum point:\n$$\n\\rho(\\varphi, v, 0) = r(10) = 1 - \\frac{10}{2} + \\frac{10^2}{40} = 1 - 5 + \\frac{100}{40} = 1 - 5 + \\frac{5}{2}\n$$\n$$\n\\rho(\\varphi, v, 0) = -4 + 2.5 = -1.5\n$$\nThe robustness of the formula $\\varphi$ with respect to the signal $v(t)$ is $-1.5 \\, \\mathrm{m/s}$.\n\nThe interpretation of this value is as follows:\n- A positive robustness value indicates that the specification is satisfied. The magnitude represents the 'margin of safety'.\n- A negative robustness value indicates that the specification is violated. The magnitude represents the 'degree of violation'.\n- A robustness of zero indicates the specification is met exactly at the boundary.\n\nSince our calculated robustness is $-1.5$, the specification $\\mathbf{G}_{[0,10]}(v < 30)$ is violated. The value $-1.5$ means that at the worst point in time within the interval $[0,10]$, the condition $v(t) < 30$ fails by a margin of $1.5 \\, \\mathrm{m/s}$. This worst-case violation occurs at $t=10 \\, \\mathrm{s}$. At this time, the velocity is:\n$$\nv(10) = 29 + \\frac{10}{2} - \\frac{10^2}{40} = 29 + 5 - 2.5 = 31.5 \\, \\mathrm{m/s}\n$$\nThe robustness at this point is $30 - v(10) = 30 - 31.5 = -1.5 \\, \\mathrm{m/s}$, confirming our result. In the context of simulation-based testing, this result corresponds to a definitive \"fail\" verdict for this specific test case.",
            "answer": "$$\n\\boxed{-1.5}\n$$"
        },
        {
            "introduction": "Estimating the probability of rare but critical failures is a common goal of simulation-based testing, yet one that can demand a prohibitive number of simulation runs using standard Monte Carlo methods. This exercise delves into powerful variance reduction techniques that significantly improve simulation efficiency . By deriving and comparing the performance of stratified sampling and antithetic variates against a baseline estimator, you will gain hands-on experience with methods that make the analysis of rare events computationally feasible.",
            "id": "4246362",
            "problem": "A Digital Twin of a Cyber-Physical System (CPS) for an autonomous ground vehicle is used to estimate a reliability metric: the probability that a braking controller fails to stop within a required distance under disturbances. The simulation-based testing models the aggregated disturbance-to-failure mechanism as a monotone threshold event driven by a single latent uncertainty variable with a continuous distribution. By the probability integral transform, assume without loss of generality that the simulator evaluates failure as the indicator of the event $\\{U > u_{0}\\}$ with $U \\sim \\mathrm{Unif}(0,1)$ and $u_{0} \\in (0,1)$. In this test campaign, the threshold is $u_{0} = 0.9$, so the true failure probability is $p = \\mathbb{P}(U > 0.9)$.\n\nYou will compare three unbiased estimators for $p$ under an equal simulation budget of $N$ independent calls to the simulator:\n- Baseline Monte Carlo using $N$ independent draws $U_{1},\\dots,U_{N}$.\n- Two-stratum stratified sampling on $[0,1]$ with strata $[0,0.8)$ and $[0.8,1]$, proportional allocation $n_{1} = 0.8N$ and $n_{2} = 0.2N$, and the standard weighted average of within-stratum sample means.\n- Antithetic variates using $N/2$ independent pairs $(U_{i}, 1 - U_{i})$, each pair producing the averaged indicator of failure.\n\nStarting only from the definitions of expectation, variance, independence, and conditional probability, and without assuming any pre-derived variance formulas, do the following:\n1. Derive the variance of the baseline estimator as a function of $N$.\n2. Derive the variance of the two-stratum stratified estimator as a function of $N$ using the strata and allocation specified above.\n3. Derive the variance of the antithetic estimator as a function of $N$ using the pairing construction.\n4. Define the variance reduction factor $R$ as the ratio of the baseline variance to the smaller of the two variances obtained with stratification and antithetic variates under the same total budget $N$. Compute $R$ for the given $u_{0} = 0.9$ and strata break at $0.8$.\n\nRound your final answer for $R$ to four significant figures. Express your answer as a pure number with no units.",
            "solution": "The problem requires the derivation of the variances for three different estimators of a probability $p$ and the computation of a variance reduction factor. The entire derivation will be performed from the fundamental definitions of expectation, variance, and probability.\n\nLet the failure event be $F = \\{U > u_0\\}$ where $U \\sim \\mathrm{Unif}(0,1)$ and $u_0 = 0.9$. The true failure probability is $p$.\n$$ p = \\mathbb{P}(F) = \\mathbb{P}(U > 0.9) = \\int_{0.9}^{1} 1 \\, du = 1 - 0.9 = 0.1 $$\nThe simulation outcome is modeled by the indicator random variable $I = \\mathbf{1}_{F} = \\mathbf{1}_{\\{U > u_0\\}}$. As $I$ is a Bernoulli variable, its expectation and variance are defined by $p$.\nThe expectation of $I$ is $\\mathbb{E}[I] = 1 \\cdot \\mathbb{P}(I=1) + 0 \\cdot \\mathbb{P}(I=0) = p$.\nThe variance of $I$ is $\\mathrm{Var}(I) = \\mathbb{E}[I^2] - (\\mathbb{E}[I])^2$. Since $I^2 = I$ for an indicator, $\\mathbb{E}[I^2] = \\mathbb{E}[I] = p$. Thus:\n$$ \\mathrm{Var}(I) = p - p^2 = p(1-p) $$\nFor $p=0.1$, the variance of a single trial is $\\mathrm{Var}(I) = 0.1(1-0.1) = 0.09$.\n\n**1. Derivation of the Variance of the Baseline Monte Carlo Estimator**\nThe baseline Monte Carlo (MC) estimator, $\\hat{p}_{MC}$, is the sample mean of $N$ independent and identically distributed (i.i.d.) random variables $I_j = \\mathbf{1}_{\\{U_j > u_0\\}}$, where each $U_j \\sim \\mathrm{Unif}(0,1)$.\n$$ \\hat{p}_{MC} = \\frac{1}{N} \\sum_{j=1}^{N} I_j $$\nThis estimator is unbiased as $\\mathbb{E}[\\hat{p}_{MC}] = \\frac{1}{N} \\sum_{j=1}^{N} \\mathbb{E}[I_j] = \\frac{1}{N}(Np) = p$.\nThe variance of $\\hat{p}_{MC}$ is derived using the property that for independent variables, the variance of the sum is the sum of the variances.\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{j=1}^{N} I_j\\right) = \\frac{1}{N^2} \\mathrm{Var}\\left(\\sum_{j=1}^{N} I_j\\right) = \\frac{1}{N^2} \\sum_{j=1}^{N} \\mathrm{Var}(I_j) $$\nSince each $I_j$ has variance $p(1-p)$:\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\frac{1}{N^2} (N p(1-p)) = \\frac{p(1-p)}{N} $$\nSubstituting $p=0.1$:\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\frac{0.1(0.9)}{N} = \\frac{0.09}{N} $$\n\n**2. Derivation of the Variance of the Two-Stratum Stratified Sampling Estimator**\nThe domain $[0,1]$ is partitioned into two strata, $S_1 = [0, 0.8)$ and $S_2 = [0.8, 1]$.\nThe stratum weights are their probabilities: $W_1 = \\mathbb{P}(U \\in S_1) = 0.8$ and $W_2 = \\mathbb{P}(U \\in S_2) = 0.2$.\nThe sample allocation is proportional: $n_1 = W_1 N = 0.8N$ and $n_2 = W_2 N = 0.2N$.\nThe stratified sampling estimator is $\\hat{p}_{SS} = W_1 \\hat{p}_1 + W_2 \\hat{p}_2$, where $\\hat{p}_k$ is the sample mean of the indicator within stratum $k$.\nFirst, we compute the conditional probabilities $p_k = \\mathbb{P}(U > u_0 | U \\in S_k)$.\nFor $S_1 = [0, 0.8)$ and $u_0=0.9$:\n$$ p_1 = \\frac{\\mathbb{P}(\\{U > 0.9\\} \\cap \\{U \\in [0, 0.8)\\})}{\\mathbb{P}(U \\in [0, 0.8))} = \\frac{\\mathbb{P}(\\emptyset)}{0.8} = 0 $$\nFor $S_2 = [0.8, 1]$ and $u_0=0.9$:\n$$ p_2 = \\frac{\\mathbb{P}(\\{U > 0.9\\} \\cap \\{U \\in [0.8, 1]\\})}{\\mathbb{P}(U \\in [0.8, 1])} = \\frac{\\mathbb{P}(U > 0.9)}{0.2} = \\frac{0.1}{0.2} = 0.5 $$\nThe estimator $\\hat{p}_k$ is the sample mean from $n_k$ draws within stratum $k$. Its variance is $\\mathrm{Var}(\\hat{p}_k) = \\frac{p_k(1-p_k)}{n_k}$.\nSince samples in different strata are drawn independently, $\\hat{p}_1$ and $\\hat{p}_2$ are independent.\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = \\mathrm{Var}(W_1 \\hat{p}_1 + W_2 \\hat{p}_2) = W_1^2 \\mathrm{Var}(\\hat{p}_1) + W_2^2 \\mathrm{Var}(\\hat{p}_2) $$\nSubstituting the expressions for variance:\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = W_1^2 \\frac{p_1(1-p_1)}{n_1} + W_2^2 \\frac{p_2(1-p_2)}{n_2} $$\nThe first term is zero since $p_1=0$.\nFor the second term, $p_2(1-p_2) = 0.5(1-0.5)=0.25$.\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = 0 + (0.2)^2 \\frac{0.25}{0.2N} = \\frac{0.04 \\times 0.25}{0.2N} = \\frac{0.01}{0.2N} = \\frac{0.05}{N} $$\n\n**3. Derivation of the Variance of the Antithetic Variates Estimator**\nThis method uses $M = N/2$ independent pairs of samples $(U_i, 1-U_i)$. For each pair, we form a new variable $Y_i = \\frac{1}{2}(\\mathbf{1}_{\\{U_i > u_0\\}} + \\mathbf{1}_{\\{1-U_i > u_0\\}})$. The estimator is the sample mean $\\hat{p}_{AV} = \\frac{1}{M} \\sum_{i=1}^{M} Y_i$.\nThe $Y_i$ are i.i.d. random variables. We first find the expectation and variance of $Y_1$. Let $I_1 = \\mathbf{1}_{\\{U_1 > u_0\\}}$ and $I'_1 = \\mathbf{1}_{\\{1-U_1 > u_0\\}}$.\n$\\mathbb{E}[I_1] = \\mathbb{P}(U_1 > u_0) = p$.\n$\\mathbb{E}[I'_1] = \\mathbb{P}(1-U_1 > u_0) = \\mathbb{P}(U_1 < 1-u_0) = 1-u_0 = p$.\n$\\mathbb{E}[Y_1] = \\frac{1}{2}(\\mathbb{E}[I_1] + \\mathbb{E}[I'_1]) = \\frac{1}{2}(p+p)=p$. The estimator is unbiased.\nThe variance of the estimator is $\\mathrm{Var}(\\hat{p}_{AV}) = \\frac{\\mathrm{Var}(Y_1)}{M} = \\frac{2\\mathrm{Var}(Y_1)}{N}$.\n$$ \\mathrm{Var}(Y_1) = \\mathrm{Var}\\left(\\frac{I_1 + I'_1}{2}\\right) = \\frac{1}{4}\\mathrm{Var}(I_1 + I'_1) = \\frac{1}{4}(\\mathrm{Var}(I_1) + \\mathrm{Var}(I'_1) + 2\\mathrm{Cov}(I_1, I'_1)) $$\nWe have $\\mathrm{Var}(I_1) = p(1-p)$ and $\\mathrm{Var}(I'_1) = p(1-p)$.\nThe covariance is $\\mathrm{Cov}(I_1, I'_1) = \\mathbb{E}[I_1 I'_1] - \\mathbb{E}[I_1]\\mathbb{E}[I'_1]$.\n$$ \\mathbb{E}[I_1 I'_1] = \\mathbb{E}[\\mathbf{1}_{\\{U_1 > u_0 \\text{ and } 1-U_1 > u_0\\}}] = \\mathbb{P}(U_1 > u_0 \\text{ and } U_1 < 1-u_0) $$\nFor $u_0=0.9$, we need $\\mathbb{P}(U_1 > 0.9 \\text{ and } U_1 < 0.1)$. The intersection of these events is the empty set, so the probability is $0$.\n$\\mathrm{Cov}(I_1, I'_1) = 0 - p \\cdot p = -p^2$.\n$$ \\mathrm{Var}(Y_1) = \\frac{1}{4}(p(1-p) + p(1-p) + 2(-p^2)) = \\frac{1}{4}(2p - 2p^2 - 2p^2) = \\frac{p-2p^2}{2} $$\nThe variance of the estimator is:\n$$ \\mathrm{Var}(\\hat{p}_{AV}) = \\frac{2}{N} \\mathrm{Var}(Y_1) = \\frac{2}{N}\\left(\\frac{p-2p^2}{2}\\right) = \\frac{p-2p^2}{N} $$\nSubstituting $p=0.1$:\n$$ \\mathrm{Var}(\\hat{p}_{AV}) = \\frac{0.1 - 2(0.1)^2}{N} = \\frac{0.1 - 0.02}{N} = \\frac{0.08}{N} $$\n\n**4. Computation of the Variance Reduction Factor R**\nWe have the following variances:\n$\\mathrm{Var}(\\hat{p}_{MC}) = \\frac{0.09}{N}$\n$\\mathrm{Var}(\\hat{p}_{SS}) = \\frac{0.05}{N}$\n$\\mathrm{Var}(\\hat{p}_{AV}) = \\frac{0.08}{N}$\n\nThe smaller of the two improved variances is:\n$$ \\min(\\mathrm{Var}(\\hat{p}_{SS}), \\mathrm{Var}(\\hat{p}_{AV})) = \\min\\left(\\frac{0.05}{N}, \\frac{0.08}{N}\\right) = \\frac{0.05}{N} $$\nThe variance reduction factor $R$ is the ratio of the baseline variance to this minimum variance:\n$$ R = \\frac{\\mathrm{Var}(\\hat{p}_{MC})}{\\min(\\mathrm{Var}(\\hat{p}_{SS}), \\mathrm{Var}(\\hat{p}_{AV}))} = \\frac{0.09/N}{0.05/N} = \\frac{0.09}{0.05} = 1.8 $$\nRounding to four significant figures gives $1.800$.",
            "answer": "$$\\boxed{1.800}$$"
        }
    ]
}