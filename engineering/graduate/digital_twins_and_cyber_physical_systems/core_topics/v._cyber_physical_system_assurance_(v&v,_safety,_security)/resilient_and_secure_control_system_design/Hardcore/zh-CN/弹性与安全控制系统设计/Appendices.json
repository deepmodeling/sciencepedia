{
    "hands_on_practices": [
        {
            "introduction": "在设计弹性和安全的控制系统时，第一步是建立一个精确的状态估计基准。本练习将引导你推导卡尔曼滤波器——在随机噪声存在的情况下，这是最优的线性状态估计算法。通过解决这个问题，你将掌握状态估计的核心原理，为理解和防御针对估计器的攻击奠定坚实的基础。",
            "id": "4241173",
            "problem": "在信息物理系统 (CPS) 中，一个数字孪生使用线性时不变 (LTI) 状态空间模型，在存在随机扰动和测量噪声的情况下估计物理系统的状态。离散时间对象和测量模型由以下基本随机动态关系给出\n$$x_{t+1} = A x_t + B u_t + w_t,$$\n$$y_t = C x_t + v_t,$$\n其中 $x_t$ 是状态， $u_t$ 是已知控制输入， $y_t$ 是测量值。假设过程噪声 $w_t$ 和测量噪声 $v_t$ 是相互独立的零均值高斯随机变量，其协方差分别为 $Q$ 和 $R$，并且独立于初始条件 $x_0$。控制输入 $u_t$ 对估计器是已知的，并且不带有不确定性。\n\n从联合高斯随机变量的条件期望定义以及全期望和全方差定律出发，为上述模型推导最优线性最小均方误差状态估计器（卡尔曼滤波器）。然后，在保证收敛的标准能检测性和能稳性条件下，将其特化到误差协方差收敛于一个常数矩阵 $P$ 的稳态机制，并给出 $P$ 必须满足的代数关系。\n\n最后，计算标量特例\n$$A = a = 0.9,\\quad C = 1,\\quad Q = q = 0.5,\\quad R = r = 2,$$\n的稳态误差协方差 $P$，并将最终数值表示为单个实数。答案四舍五入到四位有效数字。不需要物理单位，角度单位规范不适用。",
            "solution": "该问题是有效的，因为它提出了一个估计理论中标准的、适定的问题，特别是卡尔曼滤波器的推导和应用。所提供的模型和参数在科学上是合理的、完整的且一致的。\n\n目标是找到状态 $x_t$ 的最优线性估计器，以最小化均方误差 $\\mathbb{E}[\\|x_t - \\hat{x}_t\\|^2]$。对于一个带有高斯噪声的系统，最优估计器是条件均值，即 $\\hat{x}_t = \\mathbb{E}[x_t | Y_t]$，其中 $Y_t = \\{y_0, y_1, \\dots, y_t\\}$ 是截至时间 $t$ 的所有测量的历史记录。卡尔曼滤波器的推导是一个递归算法，包括一个时间更新步骤（预测）和一个测量更新步骤（校正）。该推导依赖于概率论的基本定律，包括全期望定律和联合高斯随机变量的条件期望性质。\n\n令 $\\hat{x}_{t|t-1}$ 为基于截至 $t-1$ 的测量值在时间 $t$ 的先验状态估计，令 $\\hat{x}_{t|t}$ 为基于截至 $t$ 的测量值在时间 $t$ 的后验状态估计。相应的误差协方差矩阵定义为 $P_{t|t-1} = \\mathbb{E}[(x_t - \\hat{x}_{t|t-1})(x_t - \\hat{x}_{t|t-1})^T]$ 和 $P_{t|t} = \\mathbb{E}[(x_t - \\hat{x}_{t|t})(x_t - \\hat{x}_{t|t})^T]$。\n\n首先，我们推导时间更新方程（预测）。先验估计 $\\hat{x}_{t|t-1}$ 是给定测量历史 $Y_{t-1}$ 时 $x_t$ 的条件期望。\n$$ \\hat{x}_{t|t-1} = \\mathbb{E}[x_t | Y_{t-1}] = \\mathbb{E}[A x_{t-1} + B u_{t-1} + w_{t-1} | Y_{t-1}] $$\n根据期望的线性性质，并且由于 $u_{t-1}$ 是一个已知的确定性输入，而 $w_{t-1}$ 是零均值且独立于过去的状态和测量：\n$$ \\hat{x}_{t|t-1} = A \\mathbb{E}[x_{t-1} | Y_{t-1}] + B u_{t-1} + \\mathbb{E}[w_{t-1}] = A \\hat{x}_{t-1|t-1} + B u_{t-1} $$\n先验误差为 $e_{t|t-1} = x_t - \\hat{x}_{t|t-1} = A(x_{t-1} - \\hat{x}_{t-1|t-1}) + w_{t-1} = A e_{t-1|t-1} + w_{t-1}$。那么先验误差协方差 $P_{t|t-1}$ 是：\n$$ P_{t|t-1} = \\mathbb{E}[e_{t|t-1}e_{t|t-1}^T] = \\mathbb{E}[(A e_{t-1|t-1} + w_{t-1})(A e_{t-1|t-1} + w_{t-1})^T] $$\n估计误差 $e_{t-1|t-1}$ 是 $x_0$ 和噪声项 $\\{w_0, \\dots, w_{t-2}\\}$ 与 $\\{v_0, \\dots, v_{t-1}\\}$ 的函数，因此它与 $w_{t-1}$ 不相关。期望中的交叉项为零。\n$$ P_{t|t-1} = A \\mathbb{E}[e_{t-1|t-1}e_{t-1|t-1}^T] A^T + \\mathbb{E}[w_{t-1}w_{t-1}^T] = A P_{t-1|t-1} A^T + Q $$\n\n接下来，我们推导测量更新方程（校正）。在时间 $t$，新的测量值 $y_t$ 可用。因为所有变量都是高斯的，所以以过去的数据 $Y_{t-1}$ 为条件，状态 $x_t$ 和测量值 $y_t$ 是联合高斯的。它们的条件均值和协方差是：\n$$ \\mathbb{E}[x_t | Y_{t-1}] = \\hat{x}_{t|t-1} $$\n$$ \\mathbb{E}[y_t | Y_{t-1}] = \\mathbb{E}[C x_t + v_t | Y_{t-1}] = C \\hat{x}_{t|t-1} $$\n$$ \\text{Cov}(x_t | Y_{t-1})_ = P_{t|t-1} $$\n$$ \\text{Cov}(y_t | Y_{t-1}) = \\text{Cov}(C x_t + v_t | Y_{t-1}) = C P_{t|t-1} C^T + R \\equiv S_t $$\n$$ \\text{Cov}(x_t, y_t | Y_{t-1}) = \\text{Cov}(x_t, C x_t + v_t | Y_{t-1}) = P_{t|t-1} C^T $$\n对于两个联合高斯随机向量 $X$ 和 $Y$，给定 $Y=y$ 时 $X$ 的条件期望是 $\\mathbb{E}[X|Y=y] = \\mathbb{E}[X] + \\text{Cov}(X,Y)\\text{Cov}(Y,Y)^{-1}(y - \\mathbb{E}[Y])$。将此规则应用于我们的问题：\n$$ \\hat{x}_{t|t} = \\mathbb{E}[x_t | Y_t] = \\mathbb{E}[x_t | y_t, Y_{t-1}] = \\hat{x}_{t|t-1} + (P_{t|t-1} C^T) S_t^{-1} (y_t - C \\hat{x}_{t|t-1}) $$\n这就定义了后验状态估计。项 $K_t = P_{t|t-1} C^T S_t^{-1} = P_{t|t-1} C^T (C P_{t|t-1} C^T + R)^{-1}$ 是卡尔曼增益。\n后验误差协方差矩阵 $P_{t|t}$ 由条件协方差公式 $\\text{Cov}(X|Y) = \\text{Cov}(X,X) - \\text{Cov}(X,Y)\\text{Cov}(Y,Y)^{-1}\\text{Cov}(Y,X)$ 给出：\n$$ P_{t|t} = P_{t|t-1} - (P_{t|t-1} C^T) S_t^{-1} (C P_{t|t-1}) = P_{t|t-1} - K_t S_t K_t^T $$\n使用 $K_t$ 的定义，这也可以写成 $P_{t|t} = (I - K_t C)P_{t|t-1}$。\n\n因此，完整的卡尔曼滤波器递归过程如下：\n时间更新：\n$$ \\hat{x}_{t|t-1} = A \\hat{x}_{t-1|t-1} + B u_{t-1} $$\n$$ P_{t|t-1} = A P_{t-1|t-1} A^T + Q $$\n测量更新：\n$$ K_t = P_{t|t-1} C^T (C P_{t|t-1} C^T + R)^{-1} $$\n$$ \\hat{x}_{t|t} = \\hat{x}_{t|t-1} + K_t (y_t - C \\hat{x}_{t|t-1}) $$\n$$ P_{t|t} = (I - K_t C) P_{t|t-1} $$\n\n在能稳性和能检测性条件下，误差协方差矩阵收敛到唯一的半正定解。令 $P = \\lim_{t\\to\\infty} P_{t|t-1}$ 为稳态先验误差协方差，令 $P_{post} = \\lim_{t\\to\\infty} P_{t|t}$ 为稳态后验误差协方差。协方差的递归方程变成了代数方程：\n$$ P = A P_{post} A^T + Q $$\n$$ P_{post} = P - P C^T (C P C^T + R)^{-1} C P $$\n将 $P_{post}$ 的表达式代入第一个方程，得到稳态先验误差协方差 $P$ 的离散代数黎卡提方程 (DARE)：\n$$ P = A \\left( P - P C^T (C P C^T + R)^{-1} C P \\right) A^T + Q $$\n这就是 $P$ 必须满足的代数关系。\n\n最后，我们根据给定的参数 $A=a=0.9$、$C=c=1$、$Q=q=0.5$ 和 $R=r=2$ 计算 $P$ 的标量值。标量 DARE 为：\n$$ P = a^2 \\left( P - \\frac{P^2 c^2}{c^2 P + r} \\right) + q = a^2 P \\left( \\frac{c^2 P + r - c^2 P}{c^2 P + r} \\right) + q = \\frac{a^2 Pr}{c^2 P + r} + q $$\n两边乘以 $(c^2 P + r)$ 以消去分母：\n$$ P(c^2 P + r) = a^2 Pr + q(c^2 P + r) $$\n$$ c^2 P^2 + rP = a^2 rP + c^2 qP + qr $$\n整理成标准二次型 $k_2 P^2 + k_1 P + k_0 = 0$：\n$$ c^2 P^2 + (r - a^2 r - c^2 q)P - qr = 0 $$\n代入数值：\n$$ (1)^2 P^2 + (2 - (0.9)^2(2) - (1)^2(0.5))P - (0.5)(2) = 0 $$\n$$ P^2 + (2 - (0.81)(2) - 0.5)P - 1 = 0 $$\n$$ P^2 + (2 - 1.62 - 0.5)P - 1 = 0 $$\n$$ P^2 - 0.12 P - 1 = 0 $$\n我们使用二次公式 $P = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解这个关于 $P$ 的二次方程：\n$$ P = \\frac{-(-0.12) \\pm \\sqrt{(-0.12)^2 - 4(1)(-1)}}{2(1)} = \\frac{0.12 \\pm \\sqrt{0.0144 + 4}}{2} = \\frac{0.12 \\pm \\sqrt{4.0144}}{2} $$\n由于误差协方差 $P$ 必须是正数，我们取正根：\n$$ P = \\frac{0.12 + \\sqrt{4.0144}}{2} \\approx \\frac{0.12 + 2.00359677}{2} \\approx \\frac{2.12359677}{2} \\approx 1.06179838 $$\n将结果四舍五入到四位有效数字，得到 $1.062$。",
            "answer": "$$\\boxed{1.062}$$"
        },
        {
            "introduction": "在掌握了最优状态估计之后，我们必须面对一个严峻的现实：即使是设计良好的观测器也可能存在固有的脆弱性。本练习将揭示一种被称为“隐形攻击”的严重威胁，即执行器攻击可以被完美地掩盖，使得基于创新的检测器完全失效。通过将这种脆弱性与误差系统的传输零点联系起来，你将学会从系统结构的角度识别和分析潜在的安全风险。",
            "id": "4241202",
            "problem": "考虑一个带有执行器扰动输入的离散时间线性时不变网络物理系统，其状态空间方程模型为\n$$\nx_{t+1} = A x_t + B u_t + G b_t + w_t, \\quad y_t = C x_t + v_t,\n$$\n其中 $x_t \\in \\mathbb{R}^n$ 是状态，$u_t \\in \\mathbb{R}^m$ 是已知控制输入，$b_t \\in \\mathbb{R}^r$ 是未知的执行器扰动（攻击），$w_t \\in \\mathbb{R}^n$ 是过程噪声，$y_t \\in \\mathbb{R}^p$ 是测量输出，$v_t \\in \\mathbb{R}^p$ 是测量噪声。使用一个 Luenberger 观测器来估计状态：\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big(y_t - C \\hat{x}_t \\big),\n$$\n其中观测器增益为 $L \\in \\mathbb{R}^{n \\times p}$。新息（也称为残差）定义为\n$$\n\\nu_t = y_t - C \\hat{x}_t.\n$$\n当 $\\nu_t$ 偏离其标称行为时，基于新息的检测器会标记异常。在面向数字孪生和网络物理系统的弹性与安全控制系统设计中，如果在一个理想化的无噪声极限（即 $w_t \\equiv 0$ 和 $v_t \\equiv 0$）下，仅由 $b_t$ 引起的新息序列对于所有 $t \\ge 0$ 都满足 $\\nu_t \\equiv 0$，则称执行器扰动序列 $b_t$ 被掩盖（在严格意义上未被检测到）。\n\n请仅从上述定义和观测器结构出发，且不引用任何未经证明的检测公式，推导出一个非零序列 $b_t$ 存在的充要条件，该序列能在 $w_t \\equiv 0$、$v_t \\equiv 0$ 和 $e_0 = x_0 - \\hat{x}_0 = 0$ 的情况下，使得对于所有 $t \\ge 0$ 都有 $\\nu_t \\equiv 0$。你的推导必须基于观测器误差动态的第一性原理和输出置零行为的概念。然后，对于具体系统\n$$\nA = \\begin{bmatrix} 1.1  0.1 \\\\ 0  0.9 \\end{bmatrix}, \\quad B \\in \\mathbb{R}^{2 \\times m} \\text{ arbitrary}, \\quad G = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix},\n$$\n计算该误差系统的传输零点 $\\lambda \\in \\mathbb{C}$，该传输零点证明了此类被掩盖的执行器扰动的存在。\n\n请以 $\\lambda$ 的数值作为你的最终答案。无需单位。如果你得到一个精确值，不要四舍五入；否则，将你的答案四舍五入到四位有效数字。",
            "solution": "该问题要求从基本原理出发，推导在何种条件下执行器扰动 $b_t$ 可以被掩盖，使得在没有过程噪声和测量噪声的情况下，新息 $\\nu_t$ 恒等于零，然后对一个给定的数值实例计算相应的传输零点。\n\n从观测器误差动态开始。定义估计误差 $e_t = x_t - \\hat{x}_t$。使用对象和观测器方程，\n$$\n\\begin{aligned}\nx_{t+1} = A x_t + B u_t + G b_t + w_t, \\\\\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L (y_t - C \\hat{x}_t) = A \\hat{x}_t + B u_t + L (C x_t + v_t - C \\hat{x}_t).\n\\end{aligned}\n$$\n将观测器方程从对象方程中减去，得到\n$$\n\\begin{aligned}\ne_{t+1} = x_{t+1} - \\hat{x}_{t+1} \\\\\n= A x_t + B u_t + G b_t + w_t - \\big(A \\hat{x}_t + B u_t + L (C x_t - C \\hat{x}_t) + L v_t \\big) \\\\\n= (A - L C) (x_t - \\hat{x}_t) + G b_t + w_t - L v_t \\\\\n= (A - L C) e_t + G b_t + w_t - L v_t.\n\\end{aligned}\n$$\n新息为\n$$\n\\nu_t = y_t - C \\hat{x}_t = C x_t + v_t - C \\hat{x}_t = C e_t + v_t.\n$$\n在理想化的无噪声极限下（$w_t \\equiv 0$ 和 $v_t \\equiv 0$），误差动态和新息简化为\n$$\ne_{t+1} = (A - L C) e_t + G b_t, \\quad \\nu_t = C e_t.\n$$\n根据所述准则，$b_t$ 被掩盖（严格未被检测到）的充要条件是，存在一个非零序列 $b_t$ 且 $e_0 = 0$，使得在动态 $e_{t+1} = (A - L C) e_t + G b_t$ 下，对于所有 $t \\ge 0$ 都有 $\\nu_t \\equiv 0$，即对于所有 $t \\ge 0$ 都有 $C e_t \\equiv 0$。\n\n这正是一个输出置零问题：我们寻找一个轨迹 $(e_t, b_t)$，其中 $e_0 = 0$ 且 $b_t$ 不恒为零，该轨迹能使 $C e_t = 0$ 对所有 $t$ 恒成立。一种标准方法是分析是否存在以下形式的非平凡解\n$$\ne_t = \\lambda^t \\bar{e}, \\quad b_t = \\lambda^t \\bar{b},\n$$\n其中 $\\lambda \\in \\mathbb{C}$ 且向量 $(\\bar{e}, \\bar{b}) \\neq (0,0)$。将其代入无噪声误差动态和输出约束中，得到\n$$\n\\lambda \\bar{e} = (A - L C) \\bar{e} + G \\bar{b}, \\quad C \\bar{e} = 0.\n$$\n等价地，\n$$\n\\big( (A - L C) - \\lambda I \\big) \\bar{e} + G \\bar{b} = 0, \\quad C \\bar{e} = 0.\n$$\n非平凡解 $(\\bar{e}, \\bar{b})$ 存在的充要条件是，与三元组 $\\big( A - L C, G, C \\big)$ 相关联的 $(n+p) \\times (n+r)$ Rosenbrock 系统矩阵在 $\\lambda$ 处降秩，即\n$$\n\\operatorname{rank} \\begin{bmatrix} (A - L C) - \\lambda I  G \\\\ C  0 \\end{bmatrix}  n + r.\n$$\n等价地，对于这里考虑的单输入单输出情况，$\\lambda$ 是误差系统的一个传输零点的充要条件是\n$$\n\\det \\begin{bmatrix} (A - L C) - \\lambda I  G \\\\ C  0 \\end{bmatrix} = 0.\n$$\n因此，存在一个产生 $\\nu_t \\equiv 0$ 的非零扰动序列 $b_t$ 的充要条件是，三元组 $\\big( A - L C, G, C \\big)$ 拥有一个传输零点 $\\lambda \\in \\mathbb{C}$，并且被掩盖的序列可以沿着相应的零动态方向构建。特别地，当这样一个 $\\lambda$ 严格位于单位圆盘内部时，零动态是稳定的，并且存在有界的被掩盖攻击。\n\n我们现在为给定的具体系统计算传输零点。已知\n$$\nA = \\begin{bmatrix} 1.1  0.1 \\\\ 0  0.9 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix}, \\quad G = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\n$$\n误差系统矩阵为\n$$\nF := A - L C = \\begin{bmatrix} 1.1  0.1 \\\\ 0  0.9 \\end{bmatrix} - \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} 0.6  0.1 \\\\ -0.2  0.9 \\end{bmatrix}.\n$$\n关于 $\\lambda$ 的 Rosenbrock 系统矩阵是\n$$\n\\mathcal{R}(\\lambda) = \\begin{bmatrix} F - \\lambda I  G \\\\ C  0 \\end{bmatrix} = \\begin{bmatrix} 0.6 - \\lambda  0.1  1 \\\\ -0.2  0.9 - \\lambda  0 \\\\ 1  0  0 \\end{bmatrix}.\n$$\n我们计算其行列式：\n$$\n\\det \\mathcal{R}(\\lambda) = \\det \\begin{bmatrix} 0.6 - \\lambda  0.1  1 \\\\ -0.2  0.9 - \\lambda  0 \\\\ 1  0  0 \\end{bmatrix}.\n$$\n沿第三列展开，\n$$\n\\det \\mathcal{R}(\\lambda) = 1 \\cdot \\det \\begin{bmatrix} -0.2  0.9 - \\lambda \\\\ 1  0 \\end{bmatrix} = 1 \\cdot \\big( (-0.2)\\cdot 0 - (0.9 - \\lambda)\\cdot 1 \\big) = \\lambda - 0.9.\n$$\n因此，传输零点是 $\\det \\mathcal{R}(\\lambda) = 0$ 的唯一根，即\n$$\n\\lambda = 0.9.\n$$\n根据推导，该传输零点的存在证明了存在非平凡的执行器扰动序列 $b_t$，这些序列能在无噪声极限下使新息序列 $\\nu_t$ 恒等于零，因此对基于新息的检测器是隐蔽的。值 $\\lambda = 0.9$ 位于单位圆盘内部，这表明零动态是稳定的，并且存在可行的有界被掩盖序列。\n\n所要求的最终答案是传输零点 $\\lambda$ 的数值。",
            "answer": "$$\\boxed{0.9}$$"
        },
        {
            "introduction": "分析漏洞是关键，但设计有弹性的防御对策更是目标所在。本练习将引导你从分析转向综合，学习如何主动设计一个能够抵御恶意攻击的观测器。你将运用鲁棒控制的原理，通过最小化有界对抗信号所能造成的最大估计误差（即最小化诱导 $\\ell_{\\infty}$ 增益），来优化观测器增益，从而将安全性直接融入系统设计中。",
            "id": "4241206",
            "problem": "考虑一个连续时间、线性时不变的对象-观测器对，该模型为一个带有测量端对抗性注入的信息物理系统，代表了一个物理过程的数字孪生。对象动态由 $\\dot{x}(t) = A x(t)$ 给出，测量输出为 $y(t) = C x(t) + a(t)$，其中 $x(t) \\in \\mathbb{R}^n$ 是对象状态，$y(t) \\in \\mathbb{R}^p$ 是测量值，而 $a(t) \\in \\mathbb{R}^p$ 是一个有界对抗信号，对于所有 $t \\geq 0$ 满足 $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$。观测器为 Luenberger 形式，\n$$\n\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L \\left( y(t) - C \\hat{x}(t) \\right),\n$$\n其中 $\\hat{x}(t) \\in \\mathbb{R}^n$ 是估计值，而 $L \\in \\mathbb{R}^{n \\times p}$ 是待设计的观测器增益。估计误差 $e(t) = x(t) - \\hat{x}(t)$ 则遵循\n$$\n\\dot{e}(t) = \\left( A - L C \\right) e(t) - L a(t).\n$$\n\n将最坏情况下的诱导 $\\ell_{\\infty}$ 性能水平 $\\gamma_{\\infty}$ 定义为满足\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\, \\bar{a}\n$$\n的最小非负数，该定义对所有满足约束 $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$ 的对抗信号 $a(t)$ 均成立。设计目标是在误差动态内部稳定的约束下，找到使 $\\gamma_{\\infty}$ 最小化的 $L$。\n\n任务：\n\n1) 从误差动态和线性时不变系统的诱导范数定义出发，推导一个充分的线性矩阵不等式（LMI）条件，该条件用对称矩阵变量 $P = P^{\\top} \\succ 0$、辅助变量 $Y = L P$ 和标量 $\\gamma_2  0$ 表示，保证从 $a(t)$ 到 $e(t)$ 的诱导 $\\ell_2$ 增益小于 $\\gamma_2$。然后，使用范数等价性 $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$ 和 $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$（对于 $v \\in \\mathbb{R}^n$ 和 $a \\in \\mathbb{R}^p$），推导出充分边界 $\\gamma_{\\infty} \\leq \\sqrt{p} \\, \\gamma_2$。你的推导应从连续时间系统的有界实引理开始，并使用 Schur 补来获得一个涉及 $A$、$C$、$P$、$Y$ 和 $\\gamma_2$ 的显式 LMI。\n\n2) 特化到 $C = I_n$（单位矩阵）且 $A$ 为对角矩阵，其元素为 $a_i \\in \\mathbb{R}$，$i = 1, \\dots, n$ 的情况。在这种解耦情况下，考虑标量误差通道\n$$\n\\dot{e}_i(t) = \\left( a_i - \\ell_i \\right) e_i(t) - \\ell_i \\, a_i(t),\n$$\n其中 $\\ell_i$ 是 $L$ 的第 $i$ 个对角元素，$a_i(t)$ 是 $a(t)$ 的第 $i$ 个分量。证明从 $a_i(t)$ 到 $e_i(t)$ 的诱导 $\\ell_{\\infty}$ 增益等于\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_{0}^{\\infty} \\left| \\ell_i \\, e^{\\left( a_i - \\ell_i \\right) t} \\right| \\, dt = \n\\begin{cases}\n\\dfrac{|\\ell_i|}{\\ell_i - a_i},  \\text{若 } \\ell_i  a_i, \\\\\n+\\infty,  \\text{其他情况},\n\\end{cases}\n$$\n并推导出在 $\\ell_i$ 上使标量通道稳定的最小化边界 $\\gamma_{\\infty,i}^{\\star}$。给出 $\\gamma_{\\infty}^{\\star} = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^{\\star}$ 的最终表达式。\n\n3) 实现一个程序，针对以下对角系统测试套件（其中 $C = I_n$ 且 $\\bar{a} = 1$（无单位）），根据任务2计算最小化的最坏情况诱导 $\\ell_{\\infty}$ 边界 $\\gamma_{\\infty}^{\\star}$。每个测试用例由 $A$ 的对角元素指定，如下所示：\n- 测试1（理想情况，需要观测器镇定的不稳定对象）：$A = \\mathrm{diag}(0.1, 0.3)$。\n- 测试2（混合稳定性）：$A = \\mathrm{diag}(-0.2, 0.4)$。\n- 测试3（稳定对象，最佳情况）：$A = \\mathrm{diag}(-0.7, -0.1)$。\n- 测试4（边界情况）：$A = \\mathrm{diag}(0.0, -0.3)$。\n\n在每种情况下，将最小化的 $\\gamma_{\\infty}^{\\star}$ 计算为浮点数。你的程序应产生单行输出，包含四个结果，形式为逗号分隔的列表并用方括号括起，例如 `[result1,result2,result3,result4]`。\n\n所有答案都是无单位的，应以浮点数形式提供。此问题不涉及角度单位或百分比。程序必须是独立自足的，仅使用指定的库，不接受用户输入，并遵循指定的输出格式。",
            "solution": "该问题被验证为具有科学依据、提法明确且客观。它提出了弹性控制理论中的一个标准问题，特别是旨在减轻对抗性攻击影响的观测器设计。所有提供的信息都是独立自足且一致的。\n\n### 任务1：LMI 条件推导与范数界定\n\n此任务的目标是为保证一定性能水平推导出一个充分的线性矩阵不等式（LMI）条件，然后关联不同的性能度量。\n\n估计误差动态由下式给出：\n$$\n\\dot{e}(t) = (A - LC) e(t) - L a(t)\n$$\n我们可以将其视为一个线性时不变（LTI）系统，其输入为 $w(t) = a(t)$，状态为 $e(t)$。如果我们将输出定义为状态本身，$z(t) = e(t)$，该系统可以写成状态空间形式：\n$$\n\\begin{cases}\n\\dot{e}(t) = A_e e(t) + B_e w(t) \\\\\nz(t) = C_e e(t) + D_e w(t)\n\\end{cases}\n$$\n其中 $A_e = A - LC$，$B_e = -L$，$C_e = I_n$（$n \\times n$ 单位矩阵），以及 $D_e = 0$。\n\n从输入 $a(t)$ 到输出 $e(t)$ 的诱导 $\\ell_2$ 增益是系统传递函数 $G(s) = C_e(sI-A_e)^{-1}B_e + D_e$ 的 $\\mathcal{H}_{\\infty}$ 范数。有界实引理为此增益小于标量 $\\gamma_2  0$ 提供了一个条件。它指出，$\\|G\\|_{\\mathcal{H}_{\\infty}}  \\gamma_2$ 当且仅当存在一个对称正定矩阵 $P = P^\\top \\succ 0$，使得以下矩阵不等式成立：\n$$\n\\begin{bmatrix}\nA_e^\\top P + P A_e + C_e^\\top C_e  P B_e \\\\\nB_e^\\top P  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n将我们误差系统的矩阵 $A_e$、$B_e$、$C_e$ 和 $D_e = 0$ 代入，我们得到：\n$$\n\\begin{bmatrix}\n(A - LC)^\\top P + P (A - LC) + I_n  -PL \\\\\n-L^\\top P  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n这个不等式在 $P$ 中是线性的，但包含乘积项 $PLC$，这在设计变量 $P$ 和 $L$ 中是非线性的。为了将其转换为 LMI，我们执行一个标准变量替换。我们定义一个新的矩阵变量 $Y = LP$。注意，由于 $P$ 必须是可逆的，我们在求解出 $P$ 和 $Y$ 之后，可以通过 $L=YP^{-1}$ 恢复观测器增益 $L$。\n\n将 $L = YP^{-1}$ 代入不等式得到：\n$$\n(A - YP^{-1}C)^\\top P + P (A - YP^{-1}C) = (A^\\top - C^\\top (P^{-1})^\\top Y^\\top)P + P(A - YP^{-1}C)\n$$\n由于 $P$ 是对称的，所以 $P=P^\\top$ 且 $P^{-1} = (P^{-1})^\\top$。\n$$\n= (A^\\top - C^\\top Y^\\top P^{-1})P + PA - PYP^{-1}C = A^\\top P - C^\\top Y^\\top + PA - YC\n$$\n项 $-PL$ 变为 $-P(YP^{-1}) = -Y$。项 $-L^\\top P$ 变为 $-(YP^{-1})^\\top P = - (P^{-1})^\\top Y^\\top P = -P^{-1}Y^\\top P$。这没有帮助。\n让我们重新审视这个代换。使用 $Y=LP$，我们有：\n$$\n\\begin{bmatrix}\nA^\\top P + PA - C^\\top L^\\top P - PLC + I_n  -PL \\\\\n-(PL)^\\top  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n代入 $Y=LP$ 得到：\n$$\n\\begin{bmatrix}\nA^\\top P + PA - C^\\top Y^\\top - YC + I_n  -Y \\\\\n-Y^\\top  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n这是一个关于变量 $P=P^\\top$、$Y$ 和 $\\nu = \\gamma_2^2$ 的线性矩阵不等式。这就是所要求的充分 LMI 条件。最小化 $\\ell_2$ 增益的问题可以作为一个凸优化问题来提出：\n$$\n\\min_{P \\succ 0, Y, \\nu > 0} \\nu \\quad \\text{subject to} \\quad \\begin{bmatrix} A^\\top P + PA - C^\\top Y^\\top - YC + I_n  -Y \\\\ -Y^\\top  -\\nu I_p \\end{bmatrix} \\prec 0\n$$\n最小 $\\ell_2$ 增益是 $\\gamma_{2}^{\\star} = \\sqrt{\\nu^{\\star}}$。\n\n接下来，我们将诱导 $\\ell_2$ 增益 $\\gamma_2$ 与诱导 $\\ell_\\infty$ 增益 $\\gamma_\\infty$ 关联起来。给定向量范数不等式 $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$（对于 $v \\in \\mathbb{R}^n$）和 $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$（对于 $a \\in \\mathbb{R}^p$）。\n误差系统的诱导 $\\ell_\\infty$ 范数定义为 $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\gamma_\\infty \\bar{a}$。\n对于稳定的 LTI 系统，一个关键结果是：从一个 $\\mathcal{L}_\\infty$ 输入信号（范数为 $\\sup_t \\|a(t)\\|_2$）到一个 $\\mathcal{L}_\\infty$ 输出信号（范数为 $\\sup_t \\|e(t)\\|_2$）的诱导增益也由传递函数的 $\\mathcal{H}_\\infty$ 范数 $\\gamma_2$ 给出。即：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\n使用给定的不等式，我们可以建立这个界。对于任何时间 $t$：\n$$\n\\lVert e(t) \\rVert_{\\infty} \\leq \\lVert e(t) \\rVert_2\n$$\n对两边取 $t \\geq 0$ 上的上确界：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2\n$$\n现在，我们使用诱导增益性质：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\n接下来，我们对输入向量 $a(t)$ 应用不等式：\n$$\n\\lVert a(t) \\rVert_2 \\leq \\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}\n$$\n对两边取 $t \\geq 0$ 上的上确界：\n$$\n\\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\sup_{t \\geq 0} (\\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}) = \\sqrt{p} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\sqrt{p} \\, \\bar{a}\n$$\n结合这些步骤：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\gamma_2 (\\sqrt{p} \\, \\bar{a})\n$$\n通过将其与定义 $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_\\infty \\bar{a}$ 进行比较，我们得出结论，诱导 $\\ell_\\infty$ 增益的一个充分界是：\n$$\n\\gamma_\\infty \\leq \\sqrt{p} \\, \\gamma_2\n$$\n\n### 任务2：解耦对角系统分析\n\n对于此任务，我们特化到 $A = \\mathrm{diag}(a_1, \\dots, a_n)$，$C = I_n$，并且观测器增益 $L$ 也被选为对角阵 $L = \\mathrm{diag}(\\ell_1, \\dots, \\ell_n)$ 的情况。误差动态解耦为 $n$ 个独立的标量系统：\n$$\n\\dot{e}_i(t) = (a_i - \\ell_i) e_i(t) - \\ell_i a_i(t) \\quad \\text{for } i=1, \\dots, n\n$$\n从标量输入 $a_i(t)$到标量输出 $e_i(t)$ 的诱导 $\\ell_\\infty$ 增益 $\\gamma_{\\infty,i}$ 由系统脉冲响应 $h_i(t) = -\\ell_i e^{(a_i - \\ell_i)t}$ 的 $\\ell_1$ 范数给出。\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_0^\\infty |h_i(t)| dt = \\int_0^\\infty |-\\ell_i e^{(a_i - \\ell_i)t}| dt = |\\ell_i| \\int_0^\\infty e^{(a_i - \\ell_i)t} dt\n$$\n为使系统稳定，该积分必须收敛，这要求指数为负：$a_i - \\ell_i  0$，即 $\\ell_i  a_i$。如果不满足此条件（$\\ell_i \\le a_i$），脉冲响应不衰减到零，增益为无穷大，$\\gamma_{\\infty,i} = +\\infty$。\n\n假设系统稳定，即 $\\ell_i  a_i$，积分计算结果为：\n$$\n\\int_0^\\infty e^{(a_i - \\ell_i)t} dt = \\left[ \\frac{e^{(a_i - \\ell_i)t}}{a_i - \\ell_i} \\right]_0^\\infty = 0 - \\frac{1}{a_i - \\ell_i} = \\frac{1}{\\ell_i - a_i}\n$$\n因此，增益为：\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}, \\quad \\text{for } \\ell_i  a_i\n$$\n这证实了问题陈述中给出的表达式。\n\n现在我们必须找到使该增益最小化的观测器增益 $\\ell_i$，$\\gamma_{\\infty,i}^\\star = \\min_{\\ell_i  a_i} \\gamma_{\\infty,i}(\\ell_i)$。我们根据 $a_i$ 的符号分情况进行分析。\n\n情况1：$a_i \\ge 0$。\n稳定性条件是 $\\ell_i  a_i \\ge 0$，这意味着 $\\ell_i  0$。因此，$|\\ell_i| = \\ell_i$。增益函数是：\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i} = \\frac{(\\ell_i - a_i) + a_i}{\\ell_i - a_i} = 1 + \\frac{a_i}{\\ell_i - a_i}\n$$\n如果 $a_i = 0$，那么对于任何 $\\ell_i  0$，$\\gamma_{\\infty,i}(\\ell_i) = 1$。最小增益是 $\\gamma_{\\infty,i}^\\star = 1$。\n如果 $a_i  0$，项 $\\frac{a_i}{\\ell_i - a_i}$ 为正。为了最小化增益，我们必须使该项尽可能小。这可以通过使分母 $\\ell_i - a_i$ 尽可能大来实现，即取 $\\ell_i \\to \\infty$。其极限是：\n$$\n\\lim_{\\ell_i \\to \\infty} \\left( 1 + \\frac{a_i}{\\ell_i - a_i} \\right) = 1 + 0 = 1\n$$\n所以，增益的下确界是 $1$。在这种情况下，最小化边界是 $\\gamma_{\\infty,i}^\\star = 1$。\n\n情况2：$a_i  0$。\n稳定性条件是 $\\ell_i  a_i$。我们在定义域 $(a_i, \\infty)$ 上分析函数 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}$。\n子情况2a：$\\ell_i \\ge 0$。此处，$|\\ell_i| = \\ell_i$。增益为 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i}$。其导数为 $\\frac{d\\gamma}{d\\ell_i} = \\frac{(\\ell_i-a_i) - \\ell_i}{(\\ell_i-a_i)^2} = \\frac{-a_i}{(\\ell_i-a_i)^2}$。由于 $a_i  0$，导数为正，因此函数在 $\\ell_i \\ge 0$ 上是递增的。此范围内的最小值在 $\\ell_i = 0$ 处取得，此时 $\\gamma_{\\infty,i}(0) = \\frac{0}{0-a_i} = 0$。\n子情况2b：$a_i  \\ell_i  0$。此处，$|\\ell_i| = -\\ell_i$。增益为 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{-\\ell_i}{\\ell_i - a_i}$。其导数为 $\\frac{d\\gamma}{d\\ell_i} = \\frac{-(\\ell_i-a_i) - (-\\ell_i)}{(\\ell_i-a_i)^2} = \\frac{a_i}{(\\ell_i-a_i)^2}$。由于 $a_i  0$，导数为负，因此函数在 $\\ell_i \\in (a_i, 0)$ 上是递减的。当下确界在 $\\ell_i \\to 0^-$ 时逼近，此时增益逼近0。\n\n结合这些子情况，对于 $a_i  0$，最小增益是 $\\gamma_{\\infty,i}^\\star = 0$，通过选择 $\\ell_i = 0$ 来实现。这是直观的：如果一个对象模态已经稳定，则不需要观测反馈来进行镇定，通过设置 $\\ell_i=0$，攻击信号 $a_i(t)$ 与该模态的误差动态完全解耦。\n\n最小化标量增益总结：\n$$\n\\gamma_{\\infty,i}^\\star =\n\\begin{cases}\n0,  \\text{若 } a_i  0 \\\\\n1,  \\text{若 } a_i \\ge 0\n\\end{cases}\n$$\n向量系统的整体最坏情况诱导 $\\ell_\\infty$ 增益是各个标量增益的最大值。这是因为 $\\|e(t)\\|_\\infty = \\max_i |e_i(t)|$。我们有 $|e_i(t)| \\le \\gamma_{\\infty,i} \\sup_t |a_i(t)| \\le \\gamma_{\\infty,i} \\|a(t)\\|_\\infty \\le \\gamma_{\\infty,i} \\bar{a}$。因此，$\\|e(t)\\|_\\infty \\le (\\max_i \\gamma_{\\infty,i}) \\bar{a}$。\n因此，最小化的整体增益是：\n$$\n\\gamma_\\infty^\\star = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^\\star\n$$\n这意味着如果所有对象模态都是稳定的（所有 $a_i  0$），则最优增益为 $\\gamma_\\infty^\\star = 0$。如果哪怕只有一个对象模态是不稳定或临界稳定的（$a_i \\ge 0$），则最优增益为 $\\gamma_\\infty^\\star = 1$。\n\n### 任务3：实现\n\n此逻辑直接应用于测试用例。\n- 测试1：$A = \\mathrm{diag}(0.1, 0.3)$。包含 $0.1 \\ge 0$ 和 $0.3 \\ge 0$。结果：$1.0$。\n- 测试2：$A = \\mathrm{diag}(-0.2, 0.4)$。包含 $0.4 \\ge 0$。结果：$1.0$。\n- 测试3：$A = \\mathrm{diag}(-0.7, -0.1)$。所有元素都 $ 0$。结果：$0.0$。\n- 测试4：$A = \\mathrm{diag}(0.0, -0.3)$。包含 $0.0 \\ge 0$。结果：$1.0$。\n预期输出为 `[1.0,1.0,0.0,1.0]`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used.\n\ndef solve():\n    \"\"\"\n    Computes the minimized worst-case induced l-infinity bound for a set of\n    decoupled linear systems based on the stability of their modes.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple of the diagonal entries of the matrix A.\n    test_cases = [\n        (0.1, 0.3),    # Test 1: Unstable plant\n        (-0.2, 0.4),   # Test 2: Mixed stability\n        (-0.7, -0.1),  # Test 3: Stable plant\n        (0.0, -0.3),   # Test 4: Boundary case (marginally stable)\n    ]\n\n    results = []\n    \n    # Process each test case.\n    for case in test_cases:\n        # Convert the tuple of diagonal entries into a numpy array for easy processing.\n        a_diag = np.array(case)\n        \n        # The logic derived in Task 2 is as follows:\n        # The minimized induced l-infinity gain for a single scalar channel i,\n        # gamma_infinity_i_star, is 0 if the plant mode a_i is stable (a_i  0),\n        # and 1 if the plant mode a_i is marginally stable or unstable (a_i >= 0).\n        #\n        # The overall minimized gain for the vector system, gamma_infinity_star,\n        # is the maximum of the individual scalar gains.\n        # gamma_infinity_star = max(gamma_infinity_i_star for all i).\n        #\n        # This implies that if any mode a_i is non-negative (>= 0), the overall\n        # minimized gain will be 1. If all modes are strictly negative ( 0),\n        # the overall minimized gain will be 0.\n        \n        # Check if any diagonal element is non-negative (>= 0).\n        # The `any()` method on a boolean numpy array returns True if at least\n        # one element is True.\n        if np.any(a_diag >= 0):\n            gamma_infinity_star = 1.0\n        else:\n            gamma_infinity_star = 0.0\n            \n        results.append(gamma_infinity_star)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float in the results list to a string.\n    # ','.join(...) concatenates these strings with a comma in between.\n    # The f-string places this comma-separated string inside square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function.\nsolve()\n\n```"
        }
    ]
}