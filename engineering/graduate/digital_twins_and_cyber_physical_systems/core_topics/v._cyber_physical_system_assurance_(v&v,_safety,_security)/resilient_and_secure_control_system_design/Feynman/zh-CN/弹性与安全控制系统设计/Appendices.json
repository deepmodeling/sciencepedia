{
    "hands_on_practices": [
        {
            "introduction": "在设计安全的控制系统之前，我们必须首先掌握在存在噪声的情况下如何最优地估计系统状态。卡尔曼滤波器是随机环境下状态估计的基石。这个练习将引导你从第一性原理推导卡尔曼滤波器，并计算其稳态性能，为理解和评估更复杂的安全机制奠定基础。",
            "id": "4241173",
            "problem": "信息物理系统 (CPS) 中的数字孪生使用线性时不变 (LTI) 状态空间模型，在存在随机扰动和测量噪声的情况下估计物理系统的状态。离散时间对象和测量模型由以下基本随机动态关系给出：\n$$x_{t+1} = A x_t + B u_t + w_t,$$\n$$y_t = C x_t + v_t,$$\n其中 $x_t$ 是状态， $u_t$ 是已知控制输入， $y_t$ 是测量值。假设过程噪声 $w_t$ 和测量噪声 $v_t$ 是相互独立的零均值高斯随机变量，其协方差分别为 $Q$ 和 $R$ ，并且与初始条件 $x_0$ 独立。控制输入 $u_t$ 对估计器是已知的，不带有不确定性。\n\n从联合高斯随机变量的条件期望以及全期望和全方差定律的定义出发，为上述模型推导出最优线性最小均方误差状态估计器（卡尔曼滤波器）。然后，在保证收敛的标准可检测性和可镇定性条件下，将其特化到误差协方差收敛于一个常数矩阵 $P$ 的稳态情况，并给出 $P$ 必须满足的代数关系。\n\n最后，对于标量特例\n$$A = a = 0.9,\\quad C = 1,\\quad Q = q = 0.5,\\quad R = r = 2,$$\n计算稳态误差协方差 $P$ ，并将最终数值表示为单个实数。答案四舍五入至四位有效数字。不需要物理单位，角度单位规范不适用。",
            "solution": "该问题是有效的，因为它提出了一个估计理论中的标准、适定的问题，特别是卡尔曼滤波器的推导和应用。所提供的模型和参数在科学上是合理的、完整的和一致的。\n\n目标是找到状态 $x_t$ 的最优线性估计器，以最小化均方误差 $\\mathbb{E}[\\|x_t - \\hat{x}_t\\|^2]$。对于具有高斯噪声的系统，最优估计器是条件均值 $\\hat{x}_t = \\mathbb{E}[x_t | Y_t]$，其中 $Y_t = \\{y_0, y_1, \\dots, y_t\\}$ 是截至时间 $t$ 的所有测量的历史记录。卡尔曼滤波器的推导是一个递归算法，包括时间更新步骤（预测）和测量更新步骤（校正）。此推导依赖于概率论的基本定律，包括全期望定律和联合高斯随机变量的条件期望性质。\n\n设 $\\hat{x}_{t|t-1}$ 是在给定截至 $t-1$ 的测量值时，在时间 $t$ 的先验状态估计，并设 $\\hat{x}_{t|t}$ 是在给定截至 $t$ 的测量值时，在时间 $t$ 的后验状态估计。相应的误差协方差矩阵定义为 $P_{t|t-1} = \\mathbb{E}[(x_t - \\hat{x}_{t|t-1})(x_t - \\hat{x}_{t|t-1})^T]$ 和 $P_{t|t} = \\mathbb{E}[(x_t - \\hat{x}_{t|t})(x_t - \\hat{x}_{t|t})^T]$。\n\n首先，我们推导时间更新方程（预测）。先验估计 $\\hat{x}_{t|t-1}$ 是在给定测量历史 $Y_{t-1}$ 的情况下 $x_t$ 的条件期望。\n$$ \\hat{x}_{t|t-1} = \\mathbb{E}[x_t | Y_{t-1}] = \\mathbb{E}[A x_{t-1} + B u_{t-1} + w_{t-1} | Y_{t-1}] $$\n根据期望的线性性质，并且由于 $u_{t-1}$ 是一个已知的确定性输入， $w_{t-1}$ 是零均值且独立于过去的状态和测量：\n$$ \\hat{x}_{t|t-1} = A \\mathbb{E}[x_{t-1} | Y_{t-1}] + B u_{t-1} + \\mathbb{E}[w_{t-1}] = A \\hat{x}_{t-1|t-1} + B u_{t-1} $$\n先验误差为 $e_{t|t-1} = x_t - \\hat{x}_{t|t-1} = A(x_{t-1} - \\hat{x}_{t-1|t-1}) + w_{t-1} = A e_{t-1|t-1} + w_{t-1}$。那么先验误差协方差 $P_{t|t-1}$ 是：\n$$ P_{t|t-1} = \\mathbb{E}[e_{t|t-1}e_{t|t-1}^T] = \\mathbb{E}[(A e_{t-1|t-1} + w_{t-1})(A e_{t-1|t-1} + w_{t-1})^T] $$\n估计误差 $e_{t-1|t-1}$ 是 $x_0$ 以及噪声项 $\\{w_0, \\dots, w_{t-2}\\}$ 和 $\\{v_0, \\dots, v_{t-1}\\}$ 的函数，因此它与 $w_{t-1}$ 不相关。期望中的交叉项为零。\n$$ P_{t|t-1} = A \\mathbb{E}[e_{t-1|t-1}e_{t-1|t-1}^T] A^T + \\mathbb{E}[w_{t-1}w_{t-1}^T] = A P_{t-1|t-1} A^T + Q $$\n\n接下来，我们推导测量更新方程（校正）。在时间 $t$，新的测量值 $y_t$ 变得可用。因为所有变量都是高斯的，所以状态 $x_t$ 和测量值 $y_t$ ，在以过去数据 $Y_{t-1}$ 为条件下，是联合高斯的。它们的条件均值和协方差是：\n$$ \\mathbb{E}[x_t | Y_{t-1}] = \\hat{x}_{t|t-1} $$\n$$ \\mathbb{E}[y_t | Y_{t-1}] = \\mathbb{E}[C x_t + v_t | Y_{t-1}] = C \\hat{x}_{t|t-1} $$\n$$ \\text{Cov}(x_t | Y_{t-1}) = P_{t|t-1} $$\n$$ \\text{Cov}(y_t | Y_{t-1}) = \\text{Cov}(C x_t + v_t | Y_{t-1}) = C P_{t|t-1} C^T + R \\equiv S_t $$\n$$ \\text{Cov}(x_t, y_t | Y_{t-1}) = \\text{Cov}(x_t, C x_t + v_t | Y_{t-1}) = P_{t|t-1} C^T $$\n对于两个联合高斯随机向量 $X$ 和 $Y$，给定 $Y=y$ 时 $X$ 的条件期望是 $\\mathbb{E}[X|Y=y] = \\mathbb{E}[X] + \\text{Cov}(X,Y)\\text{Cov}(Y,Y)^{-1}(y - \\mathbb{E}[Y])$。将此规则应用于我们的问题：\n$$ \\hat{x}_{t|t} = \\mathbb{E}[x_t | Y_t] = \\mathbb{E}[x_t | y_t, Y_{t-1}] = \\hat{x}_{t|t-1} + (P_{t|t-1} C^T) S_t^{-1} (y_t - C \\hat{x}_{t|t-1}) $$\n这定义了后验状态估计。项 $K_t = P_{t|t-1} C^T S_t^{-1} = P_{t|t-1} C^T (C P_{t|t-1} C^T + R)^{-1}$ 是卡尔曼增益。\n后验误差协方差矩阵 $P_{t|t}$ 由条件协方差公式 $\\text{Cov}(X|Y) = \\text{Cov}(X,X) - \\text{Cov}(X,Y)\\text{Cov}(Y,Y)^{-1}\\text{Cov}(Y,X)$ 给出：\n$$ P_{t|t} = P_{t|t-1} - (P_{t|t-1} C^T) S_t^{-1} (C P_{t|t-1}) = P_{t|t-1} - K_t S_t K_t^T $$\n使用 $K_t$ 的定义，这也可以写成 $P_{t|t} = (I - K_t C)P_{t|t-1}$。\n\n因此，完整的卡尔曼滤波器递归过程是：\n时间更新：\n$$ \\hat{x}_{t|t-1} = A \\hat{x}_{t-1|t-1} + B u_{t-1} $$\n$$ P_{t|t-1} = A P_{t-1|t-1} A^T + Q $$\n测量更新：\n$$ K_t = P_{t|t-1} C^T (C P_{t|t-1} C^T + R)^{-1} $$\n$$ \\hat{x}_{t|t} = \\hat{x}_{t|t-1} + K_t (y_t - C \\hat{x}_{t|t-1}) $$\n$$ P_{t|t} = (I - K_t C) P_{t|t-1} $$\n\n在可镇定性和可检测性条件下，误差协方差矩阵收敛到唯一的半正定解。设 $P = \\lim_{t\\to\\infty} P_{t|t-1}$ 为稳态先验误差协方差， $P_{post} = \\lim_{t\\to\\infty} P_{t|t}$ 为稳态后验误差协方差。协方差的递归方程变成了代数方程：\n$$ P = A P_{post} A^T + Q $$\n$$ P_{post} = P - P C^T (C P C^T + R)^{-1} C P $$\n将 $P_{post}$ 的表达式代入第一个方程，得到稳态先验误差协方差 $P$ 的离散代数黎卡提方程 (DARE)：\n$$ P = A \\left( P - P C^T (C P C^T + R)^{-1} C P \\right) A^T + Q $$\n这就是 $P$ 必须满足的代数关系。\n\n最后，我们根据给定的参数 $A=a=0.9$，$C=c=1$，$Q=q=0.5$，和 $R=r=2$ 计算 $P$ 的标量值。标量 DARE 是：\n$$ P = a^2 \\left( P - \\frac{P^2 c^2}{c^2 P + r} \\right) + q = a^2 P \\left( \\frac{c^2 P + r - c^2 P}{c^2 P + r} \\right) + q = \\frac{a^2 Pr}{c^2 P + r} + q $$\n乘以 $(c^2 P + r)$ 以消去分母：\n$$ P(c^2 P + r) = a^2 Pr + q(c^2 P + r) $$\n$$ c^2 P^2 + rP = a^2 rP + c^2 qP + qr $$\n整理成标准二次型 $k_2 P^2 + k_1 P + k_0 = 0$：\n$$ c^2 P^2 + (r - a^2 r - c^2 q)P - qr = 0 $$\n代入数值：\n$$ (1)^2 P^2 + (2 - (0.9)^2(2) - (1)^2(0.5))P - (0.5)(2) = 0 $$\n$$ P^2 + (2 - (0.81)(2) - 0.5)P - 1 = 0 $$\n$$ P^2 + (2 - 1.62 - 0.5)P - 1 = 0 $$\n$$ P^2 - 0.12 P - 1 = 0 $$\n我们使用二次公式 $P = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $P$ 的二次方程：\n$$ P = \\frac{-(-0.12) \\pm \\sqrt{(-0.12)^2 - 4(1)(-1)}}{2(1)} = \\frac{0.12 \\pm \\sqrt{0.0144 + 4}}{2} = \\frac{0.12 \\pm \\sqrt{4.0144}}{2} $$\n由于误差协方差 $P$ 必须是一个正量，我们取正根：\n$$ P = \\frac{0.12 + \\sqrt{4.0144}}{2} \\approx \\frac{0.12 + 2.00359677}{2} \\approx \\frac{2.12359677}{2} \\approx 1.06179838 $$\n将结果四舍五入至四位有效数字，得到 $1.062$。",
            "answer": "$$\\boxed{1.062}$$"
        },
        {
            "introduction": "一个设计良好的估计器也可能存在被攻击的弱点。本练习将探讨一种常见且隐蔽的威胁——重放攻击，攻击者通过重播旧的、看似“正常”的数据来欺骗异常检测系统 。通过亲手构建攻击信号并分析其对估计误差的影响，你将深刻理解隐蔽攻击的机制及其后果。",
            "id": "4241238",
            "problem": "考虑一个信息物理系统（CPS）中的离散时间线性时不变对象和状态观测器，该系统带有一个云托管的数字孪生（DT）。对象动态和传感器模型由标准的状态空间表示给出\n$$\nx_{t+1} = A x_t + B u_t + w_t, \\quad y_t = C x_t + v_t,\n$$\n其中 $x_t \\in \\mathbb{R}^{n}$ 是对象状态，$u_t \\in \\mathbb{R}^{m}$ 是控制输入，$y_t \\in \\mathbb{R}^{p}$ 是传感器测量值，$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$C \\in \\mathbb{R}^{p \\times n}$，以及 $w_t \\in \\mathbb{R}^{n}$ 和 $v_t \\in \\mathbb{R}^{p}$ 分别是任意的过程噪声和测量噪声序列（不一定为零）。数字孪生（DT）实现了一个增益为 $L \\in \\mathbb{R}^{n \\times p}$ 的 Luenberger 观测器：\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big),\n$$\n其中 $\\hat{x}_t \\in \\mathbb{R}^{n}$ 是状态估计值，$y_t^{a} \\in \\mathbb{R}^{p}$ 是通过网络从传感器接收的信号，该信号可能被攻击者篡改。用于异常检测的残差定义为\n$$\nr_t = y_t^{a} - C \\hat{x}_t.\n$$\n假设攻击者已经入侵了传感器通道，并且可以从网络上读取数字孪生（DT）的状态估计值 $\\hat{x}_t$，但无法更改估计器的内部状态或控制输入 $u_t$。攻击者记录了一段连续的过去残差序列 $\\{ r_{t_0}, r_{t_0+1}, \\dots, r_{t_0+N-1} \\}$，该序列对应于一个长度为 $N \\in \\mathbb{N}$ 的早期时间窗口。在选定的攻击开始时间 $t_a$，攻击者在时间区间 $t \\in \\{ t_a, t_a+1, \\dots, t_a+N-1 \\}$ 内发起重放攻击，通过将 $y_t^{a}$ 构造为当前 $\\hat{x}_t$ 和所记录序列的函数，来在每个时刻保持用于检测的残差不变。\n\n定义估计误差为 $e_t = x_t - \\hat{x}_t$。仅使用对象、观测器、残差和估计误差动态的基本定义，执行以下操作：\n- 构造攻击信号 $y_t^{a}$ 的显式表达式，保证对于所有 $t \\in \\{ t_a, t_a+1, \\dots, t_a+N-1 \\}$，都有 $r_t = r_{t_0 + (t - t_a)}$。\n- 推导在此重放攻击下的精确误差动态，并获得攻击窗口结束时估计误差 $e_{t_a+N}$ 的闭式表达式，该表达式用 $A$、$L$、初始误差 $e_{t_a}$、过程噪声序列 $\\{ w_t \\}$ 和记录的残差序列 $\\{ r_{t_0}, \\dots, r_{t_0+N-1} \\}$ 表示。\n\n将最终答案表示为 $e_{t_a+N}$ 的单个闭式解析表达式；无需数值舍入，也不涉及物理单位。",
            "solution": "所述问题具有科学依据，是适定的、客观的且内部一致的。它呈现了安全控制系统分析中的一个标准场景，并且是离散时间线性系统理论中的一个有效问题。因此，我们可以进行形式化推导。\n\n求解过程需要三步推导：第一，构造攻击信号 $y_t^{a}$；第二，推导由此产生的估计误差 $e_t$ 的动态；第三，求解误差动态，以找到攻击窗口结束时误差 $e_{t_a+N}$ 的闭式表达式。\n\n**第 1 步：构造攻击信号**\n\n攻击者的目标是注入一个恶意的传感器信号 $y_t^{a}$，使得数字孪生（DT）计算出的残差 $r_t$ 与预先记录的序列 $\\{r_{t_0}, r_{t_0+1}, \\dots, r_{t_0+N-1}\\}$ 相匹配。攻击发生在时间区间 $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$。\n\n残差定义为：\n$$\nr_t = y_t^{a} - C \\hat{x}_t\n$$\n为了执行重放攻击，攻击者必须确保在攻击窗口中的每个时间步 $t$，当前残差 $r_t$ 等于记录的残差 $r_{t_0 + (t - t_a)}$。因此，攻击者必须强制实现以下等式：\n$$\ny_t^{a} - C \\hat{x}_t = r_{t_0 + (t - t_a)}\n$$\n由于攻击者可以读取当前的状态估计值 $\\hat{x}_t$ 并能访问记录的残差序列，他们可以通过求解 $y_t^{a}$ 来构造所需的攻击信号：\n$$\ny_t^{a} = C \\hat{x}_t + r_{t_0 + (t - t_a)}\n$$\n此表达式定义了攻击者在每个 $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$ 注入的恶意信号。\n\n**第 2 步：推导估计误差动态**\n\n估计误差定义为 $e_t = x_t - \\hat{x}_t$。我们寻求此误差的动态，即一个用 $e_t$ 和其他已知量表示 $e_{t+1}$ 的表达式。我们首先写出 $e_{t+1}$ 的表达式：\n$$\ne_{t+1} = x_{t+1} - \\hat{x}_{t+1}\n$$\n现在，我们代入给定的对象动态 $x_{t+1}$ 和观测器动态 $\\hat{x}_{t+1}$ 的表达式：\n$$\nx_{t+1} = A x_t + B u_t + w_t\n$$\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big)\n$$\n将这些代入 $e_{t+1}$ 的方程得到：\n$$\ne_{t+1} = (A x_t + B u_t + w_t) - \\left( A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big) \\right)\n$$\n$y_t^{a} - C \\hat{x}_t$ 这一项正是残差 $r_t$。在攻击期间，攻击者确保 $r_t = r_{t_0 + (t - t_a)}$。将此代入观测器动态，得到：\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L r_{t_0 + (t - t_a)}\n$$\n现在，我们可以再次写出 $e_{t+1}$ 的表达式：\n$$\ne_{t+1} = (A x_t + B u_t + w_t) - ( A \\hat{x}_t + B u_t + L r_{t_0 + (t - t_a)} )\n$$\n通过分组项来简化表达式：\n$$\ne_{t+1} = A x_t - A \\hat{x}_t + B u_t - B u_t + w_t - L r_{t_0 + (t - t_a)}\n$$\n$$\ne_{t+1} = A (x_t - \\hat{x}_t) + w_t - L r_{t_0 + (t - t_a)}\n$$\n使用估计误差的定义 $e_t = x_t - \\hat{x}_t$，我们得到重放攻击下的误差动态：\n$$\ne_{t+1} = A e_t + w_t - L r_{t_0 + (t - t_a)}\n$$\n这个线性递推关系对所有 $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$ 成立。它表明，在这种特定攻击下，误差动态由过程噪声 $w_t$ 和一个由重放残差构成的强制项驱动，并且与真实的传感器测量噪声 $v_t$ 无关。至关重要的是要注意，表征健康观测器误差动态的项 $(A-LC)$ 已被 $A$ 替换，这表明来自测量的反馈校正已被破坏，并被攻击者注入的信号所取代。\n\n**第 3 步：最终误差的闭式表达式**\n\n我们现在求解导出的线性递推关系，以找到攻击窗口结束时误差 $e_{t_a+N}$ 的闭式表达式。该递推关系为：\n$$\ne_{t+1} = A e_t + d_t, \\quad \\text{其中 } d_t = w_t - L r_{t_0 + (t - t_a)}\n$$\n我们可以从攻击开始时的初始误差 $e_{t_a}$ 开始，展开这个递推关系。\n对于 $t = t_a$：\n$$\ne_{t_a+1} = A e_{t_a} + d_{t_a}\n$$\n对于 $t = t_a+1$：\n$$\ne_{t_a+2} = A e_{t_a+1} + d_{t_a+1} = A (A e_{t_a} + d_{t_a}) + d_{t_a+1} = A^2 e_{t_a} + A d_{t_a} + d_{t_a+1}\n$$\n对于 $t = t_a+2$：\n$$\ne_{t_a+3} = A e_{t_a+2} + d_{t_a+2} = A (A^2 e_{t_a} + A d_{t_a} + d_{t_a+1}) + d_{t_a+2} = A^3 e_{t_a} + A^2 d_{t_a} + A d_{t_a+1} + d_{t_a+2}\n$$\n通过归纳法，经过 $N$ 步后，在时间 $t_a+N$ 的误差由下式给出：\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} d_{t_a+j}\n$$\n现在，我们代回强制项 $d_{t_a+j}$ 的表达式：\n$$\nd_{t_a+j} = w_{t_a+j} - L r_{t_0 + (t_a+j - t_a)} = w_{t_a+j} - L r_{t_0+j}\n$$\n将其代入求和式：\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} (w_{t_a+j} - L r_{t_0+j})\n$$\n这个表达式可以分成两个和，一个与过程噪声有关，另一个与重放的残差有关：\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} w_{t_a+j} - \\sum_{j=0}^{N-1} A^{N-1-j} L r_{t_0+j}\n$$\n这是在时间 $t_a+N$ 的估计误差的最终闭式表达式。它用初始误差 $e_{t_a}$、系统矩阵 $A$、观测器增益 $L$、攻击期间的过程噪声序列 $\\{w_{t_a}, \\dots, w_{t_a+N-1}\\}$ 以及重放的残差序列 $\\{r_{t_0}, \\dots, r_{t_0+N-1}\\}$ 来表示。",
            "answer": "$$\n\\boxed{A^{N} e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} w_{t_a+j} - \\sum_{j=0}^{N-1} A^{N-1-j} L r_{t_0+j}}\n$$"
        },
        {
            "introduction": "在分析了系统的脆弱性之后，自然要进入设计的环节，即如何构建能够抵御攻击的弹性系统。本练习聚焦于鲁棒观测器设计，旨在最小化有界对抗信号所能造成的最大估计误差 。你将学习使用线性矩阵不等式（LMI）这一强大工具来系统地设计具有可证明弹性的估计器。",
            "id": "4241206",
            "problem": "考虑一个连续时间、线性时不变的被控对象-观测器对，该模型模拟了一个带有测量侧对抗性注入的信息物理系统，代表了物理过程的数字孪生。被控对象动态由 $\\dot{x}(t) = A x(t)$ 给出，测量输出为 $y(t) = C x(t) + a(t)$，其中 $x(t) \\in \\mathbb{R}^n$ 是被控对象状态，$y(t) \\in \\mathbb{R}^p$ 是测量值，$a(t) \\in \\mathbb{R}^p$ 是一个有界对抗信号，对于所有 $t \\geq 0$ 满足 $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$。观测器为 Luenberger 形式，\n$$\n\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L \\left( y(t) - C \\hat{x}(t) \\right),\n$$\n其中 $\\hat{x}(t) \\in \\mathbb{R}^n$ 是估计值，$L \\in \\mathbb{R}^{n \\times p}$ 是待设计的观测器增益。估计误差 $e(t) = x(t) - \\hat{x}(t)$ 于是服从\n$$\n\\dot{e}(t) = \\left( A - L C \\right) e(t) - L a(t).\n$$\n\n将最坏情况下的诱导 $\\ell_{\\infty}$ 性能水平 $\\gamma_{\\infty}$ 定义为满足\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\, \\bar{a}\n$$\n的最小非负数，该不等式对所有服从边界 $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$ 的对抗信号 $a(t)$ 均成立。设计目标是找到最小化 $\\gamma_{\\infty}$ 的 $L$，并满足误差动态内部稳定性的约束。\n\n任务：\n\n1) 从误差动态和线性时不变系统的诱导范数定义出发，推导一个充分的线性矩阵不等式（LMI）条件。该条件用对称矩阵变量 $P = P^{\\top} \\succ 0$、辅助变量 $Y = L P$ 和标量 $\\gamma_2 > 0$ 表示，保证从 $a(t)$ 到 $e(t)$ 的诱导 $\\ell_2$ 增益小于 $\\gamma_2$。然后，使用范数等价性 $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$ 和 $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$（其中 $v \\in \\mathbb{R}^n$，$a \\in \\mathbb{R}^p$），得出充分边界 $\\gamma_{\\infty} \\leq \\sqrt{p} \\, \\gamma_2$。你的推导应从连续时间系统的有界实引理开始，并使用 Schur 补来获得一个涉及 $A$、$C$、$P$、$Y$ 和 $\\gamma_2$ 的显式 LMI。\n\n2) 特化到 $C = I_n$（单位矩阵）且 $A$ 为对角矩阵的情况，其对角线元素为 $a_i \\in \\mathbb{R}$，$i = 1, \\dots, n$。在这种解耦情况下，考虑标量误差通道\n$$\n\\dot{e}_i(t) = \\left( a_i - \\ell_i \\right) e_i(t) - \\ell_i \\, a_i(t),\n$$\n其中 $\\ell_i$ 是 $L$ 的第 $i$ 个对角线元素，$a_i(t)$ 是 $a(t)$ 的第 $i$ 个分量。证明从 $a_i(t)$ 到 $e_i(t)$ 的诱导 $\\ell_{\\infty}$ 增益等于\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_{0}^{\\infty} \\left| \\ell_i \\, e^{\\left( a_i - \\ell_i \\right) t} \\right| \\, dt = \n\\begin{cases}\n\\dfrac{|\\ell_i|}{\\ell_i - a_i},  \\text{若 } \\ell_i > a_i, \\\\\n+\\infty,  \\text{其他情况},\n\\end{cases}\n$$\n并推导出在确保标量通道稳定性的条件下，关于 $\\ell_i$ 的最小化边界 $\\gamma_{\\infty,i}^{\\star}$。给出 $\\gamma_{\\infty}^{\\star} = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^{\\star}$ 的最终表达式。\n\n3) 实现一个程序，针对以下对角系统测试套件（其中 $C = I_n$ 且 $\\bar{a} = 1$（无单位）），根据任务 2 计算最小化的最坏情况诱导 $\\ell_{\\infty}$ 边界 $\\gamma_{\\infty}^{\\star}$。每个测试案例由 A 的对角线元素指定，如下所示：\n- 测试 1（顺利路径，需要观测器镇定的不稳定被控对象）：$A = \\mathrm{diag}(0.1, 0.3)$。\n- 测试 2（混合稳定性）：$A = \\mathrm{diag}(-0.2, 0.4)$。\n- 测试 3（稳定被控对象，最佳情况）：$A = \\mathrm{diag}(-0.7, -0.1)$。\n- 测试 4（边界情况）：$A = \\mathrm{diag}(0.0, -0.3)$。\n\n在每种情况下，将最小化的 $\\gamma_{\\infty}^{\\star}$ 计算为浮点数。你的程序应生成单行输出，其中包含四个结果，以逗号分隔并用方括号括起来，例如，“[result1,result2,result3,result4]”。\n\n所有答案都是无单位的，应以浮点数形式提供。本问题不涉及角度单位或百分比。程序必须是自包含的，仅使用指定的库，不接受用户输入，并遵循指定的输出格式。",
            "solution": "该问题被验证为科学上合理、适定且客观。它提出了弹性控制理论中的一个标准问题，特别是观测器设计以减轻对抗性攻击的影响。所有提供的信息都是自洽且一致的。\n\n### 任务 1：LMI 条件推导和范数界定\n\n此任务的目标是为保证一定性能水平推导一个充分的线性矩阵不等式（LMI）条件，然后将不同的性能度量联系起来。\n\n估计误差动态由下式给出：\n$$\n\\dot{e}(t) = (A - LC) e(t) - L a(t)\n$$\n我们可以将其视为一个输入为 $w(t) = a(t)$ 且状态为 $e(t)$ 的线性时不变（LTI）系统。如果我们将输出定义为状态本身，即 $z(t) = e(t)$，则该系统可以写成状态空间形式：\n$$\n\\begin{cases}\n\\dot{e}(t) = A_e e(t) + B_e w(t) \\\\\nz(t) = C_e e(t) + D_e w(t)\n\\end{cases}\n$$\n其中 $A_e = A - LC$，$B_e = -L$，$C_e = I_n$（$n \\times n$ 单位矩阵），以及 $D_e = 0$。\n\n从输入 $a(t)$ 到输出 $e(t)$ 的诱导 $\\ell_2$ 增益是系统传递函数 $G(s) = C_e(sI-A_e)^{-1}B_e + D_e$ 的 $\\mathcal{H}_{\\infty}$ 范数。有界实引理为此增益小于标量 $\\gamma_2 > 0$ 提供了一个条件。它指出，$\\|G\\|_{\\mathcal{H}_{\\infty}}  \\gamma_2$ 当且仅当存在一个对称正定矩阵 $P = P^\\top \\succ 0$，使得以下矩阵不等式成立：\n$$\n\\begin{bmatrix}\nA_e^\\top P + P A_e + C_e^\\top C_e  P B_e \\\\\nB_e^\\top P  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n将我们的误差系统的矩阵 $A_e$、$B_e$、$C_e$ 和 $D_e = 0$ 代入，我们得到：\n$$\n\\begin{bmatrix}\n(A - LC)^\\top P + P (A - LC) + I_n  -PL \\\\\n-L^\\top P  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n这个不等式在 $P$ 中是线性的，但包含乘积项 $PLC$，这在设计变量 $P$ 和 $L$ 中是非线性的。为了将其转换为 LMI，我们进行一次标准的变量代换。我们定义一个新的矩阵变量 $Y = LP$。注意，由于 $P$ 必须是可逆的，我们在解出 $P$ 和 $Y$ 后，可以通过 $L=YP^{-1}$ 恢复观测器增益 $L$。\n\n将 $L = YP^{-1}$ 代入不等式得到：\n$$\n(A - YP^{-1}C)^\\top P + P (A - YP^{-1}C) = (A^\\top - C^\\top (P^{-1})^\\top Y^\\top)P + P(A - YP^{-1}C)\n$$\n由于 $P$ 是对称的，$P=P^\\top$ 且 $P^{-1} = (P^{-1})^\\top$。\n$$\n= (A^\\top - C^\\top Y^\\top P^{-1})P + PA - PYP^{-1}C = A^\\top P - C^\\top Y^\\top + PA - YC\n$$\n项 $-PL$ 变为 $-P(YP^{-1}) = -Y$。项 $-L^\\top P$ 变为 $-(YP^{-1})^\\top P = - (P^{-1})^\\top Y^\\top P = -P^{-1}Y^\\top P$。这没有帮助。\n让我们重新审视代换。使用 $Y=LP$，我们有：\n$$\n\\begin{bmatrix}\nA^\\top P + PA - C^\\top L^\\top P - PLC + I_n  -PL \\\\\n-(PL)^\\top  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n代入 $Y=LP$ 得出：\n$$\n\\begin{bmatrix}\nA^\\top P + PA - C^\\top Y^\\top - YC + I_n  -Y \\\\\n-Y^\\top  -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\n这是一个关于变量 $P=P^\\top$、$Y$ 和 $\\nu = \\gamma_2^2$ 的线性矩阵不等式。这就是所要求的充分 LMI 条件。最小化 $\\ell_2$ 增益的问题可以表述为一个凸优化问题：\n$$\n\\min_{P \\succ 0, Y, \\nu > 0} \\nu \\quad \\text{约束条件为} \\quad \\begin{bmatrix} A^\\top P + PA - C^\\top Y^\\top - YC + I_n  -Y \\\\ -Y^\\top  -\\nu I_p \\end{bmatrix} \\prec 0\n$$\n最小 $\\ell_2$ 增益为 $\\gamma_{2}^{\\star} = \\sqrt{\\nu^{\\star}}$。\n\n接下来，我们将诱导 $\\ell_2$ 增益 $\\gamma_2$ 与诱导 $\\ell_\\infty$ 增益 $\\gamma_\\infty$ 联系起来。我们已知向量范数不等式 $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$（对于 $v \\in \\mathbb{R}^n$）和 $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$（对于 $a \\in \\mathbb{R}^p$）。\n误差系统的诱导 $\\ell_\\infty$ 范数定义为 $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\gamma_\\infty \\bar{a}$。\n对于稳定的 LTI 系统，一个关键结果是，从 $\\mathcal{L}_\\infty$ 输入信号（范数为 $\\sup_t \\|a(t)\\|_2$）到 $\\mathcal{L}_\\infty$ 输出信号（范数为 $\\sup_t \\|e(t)\\|_2$）的诱导增益也由传递函数的 $\\mathcal{H}_\\infty$ 范数 $\\gamma_2$ 给出。即：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\n利用给定的不等式，我们可以建立这个界。对于任何时间 $t$：\n$$\n\\lVert e(t) \\rVert_{\\infty} \\leq \\lVert e(t) \\rVert_2\n$$\n对两边取 $t \\geq 0$ 上的上确界：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2\n$$\n现在，我们使用诱导增益性质：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\n接下来，我们对输入向量 $a(t)$ 应用不等式：\n$$\n\\lVert a(t) \\rVert_2 \\leq \\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}\n$$\n对 $t \\geq 0$ 取上确界：\n$$\n\\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\sup_{t \\geq 0} (\\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}) = \\sqrt{p} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\sqrt{p} \\, \\bar{a}\n$$\n结合这些步骤：\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\gamma_2 (\\sqrt{p} \\, \\bar{a})\n$$\n通过与定义 $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_\\infty \\bar{a}$ 进行比较，我们得出结论，诱导 $\\ell_\\infty$ 增益的一个充分边界是：\n$$\n\\gamma_\\infty \\leq \\sqrt{p} \\, \\gamma_2\n$$\n\n### 任务 2：解耦对角系统分析\n\n对于这个任务，我们特化到 $A = \\mathrm{diag}(a_1, \\dots, a_n)$，$C = I_n$ 的情况，并且观测器增益 $L$ 也选择为对角矩阵 $L = \\mathrm{diag}(\\ell_1, \\dots, \\ell_n)$。误差动态解耦为 $n$ 个独立的标量系统：\n$$\n\\dot{e}_i(t) = (a_i - \\ell_i) e_i(t) - \\ell_i a_i(t) \\quad \\text{对于 } i=1, \\dots, n\n$$\n从标量输入 $a_i(t)$ 到标量输出 $e_i(t)$ 的诱导 $\\ell_\\infty$ 增益 $\\gamma_{\\infty,i}$ 由系统脉冲响应 $h_i(t) = -\\ell_i e^{(a_i - \\ell_i)t}$ 的 $\\ell_1$ 范数给出。\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_0^\\infty |h_i(t)| dt = \\int_0^\\infty |-\\ell_i e^{(a_i - \\ell_i)t}| dt = |\\ell_i| \\int_0^\\infty e^{(a_i - \\ell_i)t} dt\n$$\n为使系统稳定，该积分必须收敛，这要求指数为负：$a_i - \\ell_i  0$，即 $\\ell_i > a_i$。如果不满足此条件（$\\ell_i \\le a_i$），脉冲响应不会衰减到零，增益为无穷大，$\\gamma_{\\infty,i} = +\\infty$。\n\n假设稳定，即 $\\ell_i > a_i$，积分计算结果为：\n$$\n\\int_0^\\infty e^{(a_i - \\ell_i)t} dt = \\left[ \\frac{e^{(a_i - \\ell_i)t}}{a_i - \\ell_i} \\right]_0^\\infty = 0 - \\frac{1}{a_i - \\ell_i} = \\frac{1}{\\ell_i - a_i}\n$$\n因此，增益为：\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}, \\quad \\text{对于 } \\ell_i > a_i\n$$\n这证实了问题陈述中给出的表达式。\n\n现在我们必须找到使该增益最小化的观测器增益 $\\ell_i$，即 $\\gamma_{\\infty,i}^\\star = \\min_{\\ell_i > a_i} \\gamma_{\\infty,i}(\\ell_i)$。我们根据 $a_i$ 的符号分情况分析。\n\n情况 1：$a_i \\ge 0$。\n稳定性条件是 $\\ell_i > a_i \\ge 0$，这意味着 $\\ell_i > 0$。因此，$|\\ell_i| = \\ell_i$。增益函数为：\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i} = \\frac{(\\ell_i - a_i) + a_i}{\\ell_i - a_i} = 1 + \\frac{a_i}{\\ell_i - a_i}\n$$\n如果 $a_i = 0$，那么对于任何 $\\ell_i > 0$，$\\gamma_{\\infty,i}(\\ell_i) = 1$。最小增益为 $\\gamma_{\\infty,i}^\\star = 1$。\n如果 $a_i > 0$，项 $\\frac{a_i}{\\ell_i - a_i}$ 是正的。为了最小化增益，我们必须使此项尽可能小。这可以通过使分母 $\\ell_i - a_i$ 尽可能大来实现，即取 $\\ell_i \\to \\infty$。极限为：\n$$\n\\lim_{\\ell_i \\to \\infty} \\left( 1 + \\frac{a_i}{\\ell_i - a_i} \\right) = 1 + 0 = 1\n$$\n所以，增益的下确界是 $1$。在这种情况下，最小化边界是 $\\gamma_{\\infty,i}^\\star = 1$。\n\n情况 2：$a_i  0$。\n稳定性条件是 $\\ell_i > a_i$。我们分析函数 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}$ 在定义域 $(a_i, \\infty)$ 上的行为。\n子情况 2a：$\\ell_i \\ge 0$。这里，$|\\ell_i| = \\ell_i$。增益为 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i}$。其导数为 $\\frac{d\\gamma}{d\\ell_i} = \\frac{(\\ell_i-a_i) - \\ell_i}{(\\ell_i-a_i)^2} = \\frac{-a_i}{(\\ell_i-a_i)^2}$。由于 $a_i  0$，导数为正，因此函数在 $\\ell_i \\ge 0$ 时是递增的。此范围内的最小值在 $\\ell_i = 0$ 处取得，此时 $\\gamma_{\\infty,i}(0) = \\frac{0}{0-a_i} = 0$。\n子情况 2b：$a_i  \\ell_i  0$。这里，$|\\ell_i| = -\\ell_i$。增益为 $\\gamma_{\\infty,i}(\\ell_i) = \\frac{-\\ell_i}{\\ell_i - a_i}$。其导数为 $\\frac{d\\gamma}{d\\ell_i} = \\frac{-(\\ell_i-a_i) - (-\\ell_i)}{(\\ell_i-a_i)^2} = \\frac{a_i}{(\\ell_i-a_i)^2}$。由于 $a_i0$，导数为负，因此函数在 $\\ell_i \\in (a_i, 0)$ 时是递减的。下确界在 $\\ell_i \\to 0^-$ 时达到，此时增益趋近于 $0$。\n\n结合这些子情况，对于 $a_i  0$，最小增益为 $\\gamma_{\\infty,i}^\\star = 0$，通过选择 $\\ell_i = 0$ 实现。这是直观的：如果一个被控对象模态已经是稳定的，则不需要观测反馈来进行镇定，并且通过设置 $\\ell_i=0$，该模态的攻击信号 $a_i(t)$ 与误差动态完全解耦。\n\n最小化标量增益总结：\n$$\n\\gamma_{\\infty,i}^\\star =\n\\begin{cases}\n0,  \\text{若 } a_i  0 \\\\\n1,  \\text{若 } a_i \\ge 0\n\\end{cases}\n$$\n向量系统的总体最坏情况诱导 $\\ell_\\infty$ 增益是各个标量增益的最大值。这是因为 $\\|e(t)\\|_\\infty = \\max_i |e_i(t)|$。我们有 $|e_i(t)| \\le \\gamma_{\\infty,i} \\sup_t |a_i(t)| \\le \\gamma_{\\infty,i} \\|a(t)\\|_\\infty \\le \\gamma_{\\infty,i} \\bar{a}$。因此，$\\|e(t)\\|_\\infty \\le (\\max_i \\gamma_{\\infty,i}) \\bar{a}$。\n因此，最小化的总体增益是：\n$$\n\\gamma_\\infty^\\star = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^\\star\n$$\n这意味着如果所有被控对象模态都是稳定的（所有 $a_i  0$），最优增益为 $\\gamma_\\infty^\\star = 0$。如果哪怕只有一个被控对象模态是不稳定或临界稳定的（$a_i \\ge 0$），最优增益为 $\\gamma_\\infty^\\star = 1$。\n\n### 任务 3：实现\n\n此逻辑直接应用于测试案例。\n- 测试 1：$A = \\mathrm{diag}(0.1, 0.3)$。包含 $0.1 \\ge 0$ 和 $0.3 \\ge 0$。结果：$1.0$。\n- 测试 2：$A = \\mathrm{diag}(-0.2, 0.4)$。包含 $0.4 \\ge 0$。结果：$1.0$。\n- 测试 3：$A = \\mathrm{diag}(-0.7, -0.1)$。所有元素都 $ 0$。结果：$0.0$。\n- 测试 4：$A = \\mathrm{diag}(0.0, -0.3)$。包含 $0.0 \\ge 0$。结果：$1.0$。\n预期输出为 $[1.0, 1.0, 0.0, 1.0]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used.\n\ndef solve():\n    \"\"\"\n    Computes the minimized worst-case induced l-infinity bound for a set of\n    decoupled linear systems based on the stability of their modes.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple of the diagonal entries of the matrix A.\n    test_cases = [\n        (0.1, 0.3),    # Test 1: Unstable plant\n        (-0.2, 0.4),   # Test 2: Mixed stability\n        (-0.7, -0.1),  # Test 3: Stable plant\n        (0.0, -0.3),   # Test 4: Boundary case (marginally stable)\n    ]\n\n    results = []\n    \n    # Process each test case.\n    for case in test_cases:\n        # Convert the tuple of diagonal entries into a numpy array for easy processing.\n        a_diag = np.array(case)\n        \n        # The logic derived in Task 2 is as follows:\n        # The minimized induced l-infinity gain for a single scalar channel i,\n        # gamma_infinity_i_star, is 0 if the plant mode a_i is stable (a_i  0),\n        # and 1 if the plant mode a_i is marginally stable or unstable (a_i >= 0).\n        #\n        # The overall minimized gain for the vector system, gamma_infinity_star,\n        # is the maximum of the individual scalar gains.\n        # gamma_infinity_star = max(gamma_infinity_i_star for all i).\n        #\n        # This implies that if any mode a_i is non-negative (>= 0), the overall\n        # minimized gain will be 1. If all modes are strictly negative ( 0),\n        # the overall minimized gain will be 0.\n        \n        # Check if any diagonal element is non-negative (>= 0).\n        # The `any()` method on a boolean numpy array returns True if at least\n        # one element is True.\n        if np.any(a_diag >= 0):\n            gamma_infinity_star = 1.0\n        else:\n            gamma_infinity_star = 0.0\n            \n        results.append(gamma_infinity_star)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float in the results list to a string.\n    # ','.join(...) concatenates these strings with a comma in between.\n    # The f-string places this comma-separated string inside square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function.\nsolve()\n\n```"
        }
    ]
}