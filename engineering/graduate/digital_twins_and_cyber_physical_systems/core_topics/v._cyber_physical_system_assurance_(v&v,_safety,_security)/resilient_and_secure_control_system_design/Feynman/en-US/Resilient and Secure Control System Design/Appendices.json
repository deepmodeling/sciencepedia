{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of securing cyber-physical systems is the ability to detect anomalous behavior, often through residual-based anomaly detectors. However, sophisticated adversaries can devise attacks that remain invisible to such monitors. This first practice explores a classic example of a stealthy attack—the replay attack—where an adversary fools the system's digital twin by injecting a carefully crafted signal based on past observations . By deriving the attack's mechanics and its effect on the estimation error, you will gain a concrete understanding of how a system's defenses can be subverted.",
            "id": "4241238",
            "problem": "Consider a discrete-time linear time-invariant plant and state observer in a Cyber-Physical System (CPS) with a cloud-hosted Digital Twin (DT). The plant dynamics and sensor model are given by the standard state-space representation\n$$\nx_{t+1} = A x_t + B u_t + w_t, \\quad y_t = C x_t + v_t,\n$$\nwhere $x_t \\in \\mathbb{R}^{n}$ is the plant state, $u_t \\in \\mathbb{R}^{m}$ is the control input, $y_t \\in \\mathbb{R}^{p}$ is the sensor measurement, $A \\in \\mathbb{R}^{n \\times n}$, $B \\in \\mathbb{R}^{n \\times m}$, $C \\in \\mathbb{R}^{p \\times n}$, and $w_t \\in \\mathbb{R}^{n}$, $v_t \\in \\mathbb{R}^{p}$ are arbitrary process and measurement noise sequences (not necessarily zero), respectively. The DT implements a Luenberger observer with gain $L \\in \\mathbb{R}^{n \\times p}$:\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big),\n$$\nwhere $\\hat{x}_t \\in \\mathbb{R}^{n}$ is the state estimate and $y_t^{a} \\in \\mathbb{R}^{p}$ is the signal received from the sensor over the network, which may be altered by an adversary. The residual used for anomaly detection is defined by\n$$\nr_t = y_t^{a} - C \\hat{x}_t.\n$$\nAssume the adversary has compromised the sensor channel and can read the estimate $\\hat{x}_t$ from the DT over the network but cannot alter the estimator’s internal state or the control input $u_t$. The adversary recorded a contiguous past residual sequence $\\{ r_{t_0}, r_{t_0+1}, \\dots, r_{t_0+N-1} \\}$ corresponding to an earlier time window of length $N \\in \\mathbb{N}$. At a chosen attack start time $t_a$, the adversary launches a replay attack over the interval $t \\in \\{ t_a, t_a+1, \\dots, t_a+N-1 \\}$ that preserves the residual used for detection at each time by constructing $y_t^{a}$ as a function of the current $\\hat{x}_t$ and the recorded sequence.\n\nDefine the estimation error $e_t = x_t - \\hat{x}_t$. Using only fundamental definitions of the plant, observer, residual, and estimation error dynamics, perform the following:\n- Construct an explicit expression for the adversarial signal $y_t^{a}$ that guarantees $r_t = r_{t_0 + (t - t_a)}$ for all $t \\in \\{ t_a, t_a+1, \\dots, t_a+N-1 \\}$.\n- Derive the exact error dynamics under this replay attack and obtain a closed-form expression for the estimation error at the end of the attack window $e_{t_a+N}$ in terms of $A$, $L$, the initial error $e_{t_a}$, the process noise sequence $\\{ w_t \\}$, and the recorded residual sequence $\\{ r_{t_0}, \\dots, r_{t_0+N-1} \\}$.\n\nExpress the final answer as a single closed-form analytic expression for $e_{t_a+N}$; no numerical rounding is required and no physical units are involved.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard scenario in the analysis of secure control systems and is a valid problem in discrete-time linear systems theory. We may therefore proceed with a formal derivation.\n\nThe solution requires a three-step derivation: first, constructing the adversarial signal $y_t^{a}$; second, deriving the resulting dynamics of the estimation error $e_t$; and third, solving the error dynamics to find a closed-form expression for the error at the end of the attack window, $e_{t_a+N}$.\n\n**Step 1: Construction of the Adversarial Signal**\n\nThe adversary's goal is to inject a malicious sensor signal $y_t^{a}$ such that the residual computed by the Digital Twin (DT), $r_t$, matches a pre-recorded sequence $\\{r_{t_0}, r_{t_0+1}, \\dots, r_{t_0+N-1}\\}$. The attack occurs over the time interval $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$.\n\nThe residual is defined as:\n$$\nr_t = y_t^{a} - C \\hat{x}_t\n$$\nTo execute the replay attack, the adversary must ensure that for each time step $t$ in the attack window, the current residual $r_t$ is equal to the recorded residual $r_{t_0 + (t - t_a)}$. Therefore, the adversary must force the following equality:\n$$\ny_t^{a} - C \\hat{x}_t = r_{t_0 + (t - t_a)}\n$$\nSince the adversary can read the current state estimate $\\hat{x}_t$ and has access to the recorded residual sequence, they can construct the required adversarial signal by solving for $y_t^{a}$:\n$$\ny_t^{a} = C \\hat{x}_t + r_{t_0 + (t - t_a)}\n$$\nThis expression defines the malicious signal injected by the adversary for each $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$.\n\n**Step 2: Derivation of the Estimation Error Dynamics**\n\nThe estimation error is defined as $e_t = x_t - \\hat{x}_t$. We seek the dynamics of this error, i.e., an expression for $e_{t+1}$ in terms of $e_t$ and other known quantities. We start by writing the expression for $e_{t+1}$:\n$$\ne_{t+1} = x_{t+1} - \\hat{x}_{t+1}\n$$\nNow, we substitute the given expressions for the plant dynamics $x_{t+1}$ and the observer dynamics $\\hat{x}_{t+1}$:\n$$\nx_{t+1} = A x_t + B u_t + w_t\n$$\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big)\n$$\nSubstituting these into the equation for $e_{t+1}$ yields:\n$$\ne_{t+1} = (A x_t + B u_t + w_t) - \\left( A \\hat{x}_t + B u_t + L \\big( y_t^{a} - C \\hat{x}_t \\big) \\right)\n$$\nThe term $y_t^{a} - C \\hat{x}_t$ is precisely the residual $r_t$. During the attack, the adversary ensures that $r_t = r_{t_0 + (t - t_a)}$. Substituting this into the observer dynamics gives:\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L r_{t_0 + (t - t_a)}\n$$\nNow, we can write the expression for $e_{t+1}$ again:\n$$\ne_{t+1} = (A x_t + B u_t + w_t) - ( A \\hat{x}_t + B u_t + L r_{t_0 + (t - t_a)} )\n$$\nSimplifying the expression by grouping terms:\n$$\ne_{t+1} = A x_t - A \\hat{x}_t + B u_t - B u_t + w_t - L r_{t_0 + (t - t_a)}\n$$\n$$\ne_{t+1} = A (x_t - \\hat{x}_t) + w_t - L r_{t_0 + (t - t_a)}\n$$\nUsing the definition of the estimation error $e_t = x_t - \\hat{x}_t$, we arrive at the error dynamics under the replay attack:\n$$\ne_{t+1} = A e_t + w_t - L r_{t_0 + (t - t_a)}\n$$\nThis linear recurrence relation holds for all $t \\in \\{t_a, t_a+1, \\dots, t_a+N-1\\}$. It shows that under this specific attack, the error dynamics are driven by the process noise $w_t$ and a forcing term constructed from the replayed residual, and are independent of the true sensor measurement noise $v_t$. It is crucial to note that the term $(A-LC)$ which characterizes a healthy observer's error dynamics has been replaced by $A$, indicating the feedback correction from the measurements has been compromised and replaced by the adversary's injected signal.\n\n**Step 3: Closed-Form Expression for the Final Error**\n\nWe now solve the derived linear recurrence relation to find a closed-form expression for the error at the end of the attack window, $e_{t_a+N}$. The recurrence is:\n$$\ne_{t+1} = A e_t + d_t, \\quad \\text{where } d_t = w_t - L r_{t_0 + (t - t_a)}\n$$\nWe can unroll this recurrence starting from the initial error at the beginning of the attack, $e_{t_a}$.\nFor $t = t_a$:\n$$\ne_{t_a+1} = A e_{t_a} + d_{t_a}\n$$\nFor $t = t_a+1$:\n$$\ne_{t_a+2} = A e_{t_a+1} + d_{t_a+1} = A (A e_{t_a} + d_{t_a}) + d_{t_a+1} = A^2 e_{t_a} + A d_{t_a} + d_{t_a+1}\n$$\nFor $t = t_a+2$:\n$$\ne_{t_a+3} = A e_{t_a+2} + d_{t_a+2} = A (A^2 e_{t_a} + A d_{t_a} + d_{t_a+1}) + d_{t_a+2} = A^3 e_{t_a} + A^2 d_{t_a} + A d_{t_a+1} + d_{t_a+2}\n$$\nBy induction, after $N$ steps, the error at time $t_a+N$ is given by:\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} d_{t_a+j}\n$$\nNow, we substitute back the expression for the forcing term $d_{t_a+j}$:\n$$\nd_{t_a+j} = w_{t_a+j} - L r_{t_0 + (t_a+j - t_a)} = w_{t_a+j} - L r_{t_0+j}\n$$\nSubstituting this into the summation:\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} (w_{t_a+j} - L r_{t_0+j})\n$$\nThis expression can be separated into two sums, one related to the process noise and the other to the replayed residuals:\n$$\ne_{t_a+N} = A^N e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} w_{t_a+j} - \\sum_{j=0}^{N-1} A^{N-1-j} L r_{t_0+j}\n$$\nThis is the final closed-form expression for the estimation error at time $t_a+N$. It is expressed in terms of the initial error $e_{t_a}$, the system matrix $A$, the observer gain $L$, the sequence of process noise $\\{w_{t_a}, \\dots, w_{t_a+N-1}\\}$ during the attack, and the replayed residual sequence $\\{r_{t_0}, \\dots, r_{t_0+N-1}\\}$.",
            "answer": "$$\n\\boxed{A^{N} e_{t_a} + \\sum_{j=0}^{N-1} A^{N-1-j} w_{t_a+j} - \\sum_{j=0}^{N-1} A^{N-1-j} L r_{t_0+j}}\n$$"
        },
        {
            "introduction": "Moving beyond specific attack scenarios, it is crucial to develop general tools for assessing a system's inherent vulnerabilities. This exercise introduces a powerful method for analyzing a system's susceptibility to stealthy actuator attacks by investigating its \"zero dynamics\" . You will derive the fundamental condition under which an actuator disturbance can be perfectly masked from an innovation-based detector, linking this vulnerability to the existence of a transmission zero in the error system. This practice provides a deeper, structural perspective on system security.",
            "id": "4241202",
            "problem": "Consider a discrete-time linear time-invariant cyber-physical system with actuator disturbance input, modeled by the state-space equations\n$$\nx_{t+1} = A x_t + B u_t + G b_t + w_t, \\quad y_t = C x_t + v_t,\n$$\nwhere $x_t \\in \\mathbb{R}^n$ is the state, $u_t \\in \\mathbb{R}^m$ is a known control input, $b_t \\in \\mathbb{R}^r$ is an unknown actuator disturbance (attack), $w_t \\in \\mathbb{R}^n$ is process noise, $y_t \\in \\mathbb{R}^p$ is the measured output, and $v_t \\in \\mathbb{R}^p$ is measurement noise. A Luenberger observer is used to estimate the state:\n$$\n\\hat{x}_{t+1} = A \\hat{x}_t + B u_t + L \\big(y_t - C \\hat{x}_t \\big),\n$$\nwith observer gain $L \\in \\mathbb{R}^{n \\times p}$. The innovation (also called residual) is defined as\n$$\n\\nu_t = y_t - C \\hat{x}_t.\n$$\nAn innovation-based detector flags anomalies when $\\nu_t$ deviates from its nominal behavior. In resilient and secure control system design for digital twins and cyber-physical systems, an actuator disturbance sequence $b_t$ is said to be masked as process noise and remain undetected (in the strict sense) if, in the idealized noise-free limit $w_t \\equiv 0$ and $v_t \\equiv 0$, the innovation sequence due solely to $b_t$ satisfies $\\nu_t \\equiv 0$ for all $t \\ge 0$.\n\nStarting only from the above definitions and the observer structure, and without invoking any unproved detection formulas, derive a necessary and sufficient condition for the existence of a nonzero sequence $b_t$ that yields $\\nu_t \\equiv 0$ for all $t \\ge 0$ with $w_t \\equiv 0$, $v_t \\equiv 0$, and $e_0 = x_0 - \\hat{x}_0 = 0$. Your derivation must be based on first principles of observer error dynamics and the concept of output-nulling behavior. Then, for the specific system\n$$\nA = \\begin{bmatrix} 1.1 & 0.1 \\\\ 0 & 0.9 \\end{bmatrix}, \\quad B \\in \\mathbb{R}^{2 \\times m} \\text{ arbitrary}, \\quad G = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix},\n$$\ncompute the transmission zero $\\lambda \\in \\mathbb{C}$ of the error system that certifies the existence of such a masked actuator disturbance.\n\nProvide your final answer as the numerical value of $\\lambda$. No units are required. If you obtain an exact value, do not round; otherwise, round your answer to four significant figures.",
            "solution": "The problem asks for a fundamental derivation of the condition under which an actuator disturbance $b_t$ can be masked so that the innovation $\\nu_t$ remains identically zero in the absence of process and measurement noise, and then to compute the corresponding transmission zero for a given numerical instance.\n\nWe begin from the observer error dynamics. Define the estimation error $e_t = x_t - \\hat{x}_t$. Using the plant and observer equations,\n$$\n\\begin{aligned}\nx_{t+1} &= A x_t + B u_t + G b_t + w_t, \\\\\n\\hat{x}_{t+1} &= A \\hat{x}_t + B u_t + L (y_t - C \\hat{x}_t) = A \\hat{x}_t + B u_t + L (C x_t + v_t - C \\hat{x}_t).\n\\end{aligned}\n$$\nSubtracting the observer from the plant gives\n$$\n\\begin{aligned}\ne_{t+1} &= x_{t+1} - \\hat{x}_{t+1} \\\\\n&= A x_t + B u_t + G b_t + w_t - \\big(A \\hat{x}_t + B u_t + L (C x_t - C \\hat{x}_t) + L v_t \\big) \\\\\n&= (A - L C) (x_t - \\hat{x}_t) + G b_t + w_t - L v_t \\\\\n&= (A - L C) e_t + G b_t + w_t - L v_t.\n\\end{aligned}\n$$\nThe innovation is\n$$\n\\nu_t = y_t - C \\hat{x}_t = C x_t + v_t - C \\hat{x}_t = C e_t + v_t.\n$$\nIn the idealized noise-free limit $w_t \\equiv 0$ and $v_t \\equiv 0$, the error dynamics and innovation reduce to\n$$\ne_{t+1} = (A - L C) e_t + G b_t, \\quad \\nu_t = C e_t.\n$$\nBy the stated criterion, $b_t$ is masked (strictly undetected) if and only if there exists a nonzero sequence $b_t$ with $e_0 = 0$ such that $\\nu_t \\equiv 0$ for all $t \\ge 0$, that is, $C e_t \\equiv 0$ for all $t \\ge 0$ under the dynamics $e_{t+1} = (A - L C) e_t + G b_t$.\n\nThis is precisely an output-nulling problem: we seek a trajectory $(e_t, b_t)$ with $e_0 = 0$, not identically zero in $b_t$, that maintains $C e_t = 0$ for all $t$. A standard approach is to analyze the existence of nontrivial solutions of the form\n$$\ne_t = \\lambda^t \\bar{e}, \\quad b_t = \\lambda^t \\bar{b},\n$$\nfor some $\\lambda \\in \\mathbb{C}$ and vectors $(\\bar{e}, \\bar{b}) \\neq (0,0)$. Substituting into the noise-free error dynamics and the output constraint yields\n$$\n\\lambda \\bar{e} = (A - L C) \\bar{e} + G \\bar{b}, \\quad C \\bar{e} = 0.\n$$\nEquivalently,\n$$\n\\big( (A - L C) - \\lambda I \\big) \\bar{e} + G \\bar{b} = 0, \\quad C \\bar{e} = 0.\n$$\nA nontrivial solution $(\\bar{e}, \\bar{b})$ exists if and only if the $(n+p) \\times (n+r)$ Rosenbrock system matrix associated with the triple $\\big( A - L C, G, C \\big)$ loses rank at $\\lambda$, that is,\n$$\n\\operatorname{rank} \\begin{bmatrix} (A - L C) - \\lambda I & G \\\\ C & 0 \\end{bmatrix} < n + p.\n$$\nEquivalently, for the single-input, single-output case considered here, $\\lambda$ is a transmission zero of the error system if and only if\n$$\n\\det \\begin{bmatrix} (A - L C) - \\lambda I & G \\\\ C & 0 \\end{bmatrix} = 0.\n$$\nThus, the necessary and sufficient condition for the existence of a nonzero disturbance sequence $b_t$ producing $\\nu_t \\equiv 0$ is that the triple $\\big( A - L C, G, C \\big)$ possesses a transmission zero $\\lambda \\in \\mathbb{C}$, and the masked sequences can be constructed along the corresponding zero-dynamics direction. In particular, when such a $\\lambda$ lies strictly inside the unit disk, the zero-dynamics are stable, and bounded masked attacks exist.\n\nWe now compute the transmission zero for the given specific system. With\n$$\nA = \\begin{bmatrix} 1.1 & 0.1 \\\\ 0 & 0.9 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix}, \\quad G = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\n$$\nthe error system matrix is\n$$\nF := A - L C = \\begin{bmatrix} 1.1 & 0.1 \\\\ 0 & 0.9 \\end{bmatrix} - \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} 0.6 & 0.1 \\\\ -0.2 & 0.9 \\end{bmatrix}.\n$$\nThe Rosenbrock system matrix as a function of $\\lambda$ is\n$$\n\\mathcal{R}(\\lambda) = \\begin{bmatrix} F - \\lambda I & G \\\\ C & 0 \\end{bmatrix} = \\begin{bmatrix} 0.6 - \\lambda & 0.1 & 1 \\\\ -0.2 & 0.9 - \\lambda & 0 \\\\ 1 & 0 & 0 \\end{bmatrix}.\n$$\nWe compute its determinant:\n$$\n\\det \\mathcal{R}(\\lambda) = \\det \\begin{bmatrix} 0.6 - \\lambda & 0.1 & 1 \\\\ -0.2 & 0.9 - \\lambda & 0 \\\\ 1 & 0 & 0 \\end{bmatrix}.\n$$\nExpanding along the third column,\n$$\n\\det \\mathcal{R}(\\lambda) = 1 \\cdot \\det \\begin{bmatrix} -0.2 & 0.9 - \\lambda \\\\ 1 & 0 \\end{bmatrix} = 1 \\cdot \\big( (-0.2)\\cdot 0 - (0.9 - \\lambda)\\cdot 1 \\big) = \\lambda - 0.9.\n$$\nTherefore, the transmission zero is the unique root of $\\det \\mathcal{R}(\\lambda) = 0$, namely\n$$\n\\lambda = 0.9.\n$$\nBy the derivation, the existence of this transmission zero certifies that there exist nontrivial actuator disturbance sequences $b_t$ that render the innovation sequence $\\nu_t$ identically zero in the noise-free limit, hence masked from an innovation-based detector. The value $\\lambda = 0.9$ lies inside the unit disk, indicating stable zero-dynamics and the feasibility of bounded masked sequences.\n\nThe requested final answer is the numerical value of the transmission zero $\\lambda$.",
            "answer": "$$\\boxed{0.9}$$"
        },
        {
            "introduction": "After analyzing system vulnerabilities, the next logical step is to design systems that are inherently resilient to them. This final practice shifts our focus from analysis to synthesis by tackling the problem of robust observer design against adversarial signals . You will learn how to formulate the design of a resilient observer as an optimization problem, aiming to minimize the worst-case estimation error under bounded attacks. This exercise introduces you to key concepts in robust control, such as the induced $\\ell_{\\infty}$ gain and Linear Matrix Inequality (LMI) based design, providing a pathway to building provably secure systems.",
            "id": "4241206",
            "problem": "Consider a continuous-time, linear time-invariant plant-observer pair modeling a cyber-physical system with a measurement-side adversarial injection, representative of a digital twin of a physical process. The plant dynamics are given by $\\dot{x}(t) = A x(t)$ and the measured output is $y(t) = C x(t) + a(t)$, where $x(t) \\in \\mathbb{R}^n$ is the plant state, $y(t) \\in \\mathbb{R}^p$ is the measurement, and $a(t) \\in \\mathbb{R}^p$ is a bounded adversarial signal satisfying $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$ for all $t \\geq 0$. The observer is of Luenberger form,\n$$\n\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L \\left( y(t) - C \\hat{x}(t) \\right),\n$$\nwhere $\\hat{x}(t) \\in \\mathbb{R}^n$ is the estimate and $L \\in \\mathbb{R}^{n \\times p}$ is the observer gain to be designed. The estimation error $e(t) = x(t) - \\hat{x}(t)$ then obeys\n$$\n\\dot{e}(t) = \\left( A - L C \\right) e(t) - L a(t).\n$$\n\nDefine the worst-case induced $\\ell_{\\infty}$ performance level $\\gamma_{\\infty}$ as the smallest nonnegative number satisfying\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\, \\bar{a}\n$$\nfor all adversarial signals $a(t)$ obeying the bound $\\lVert a(t) \\rVert_{\\infty} \\leq \\bar{a}$. The design objective is to find $L$ that minimizes $\\gamma_{\\infty}$ subject to internal stability of the error dynamics.\n\nTasks:\n\n1) Starting from the error dynamics and the definition of induced norms for linear time-invariant systems, derive a sufficient Linear Matrix Inequality (LMI) condition, in terms of a symmetric matrix variable $P = P^{\\top} \\succ 0$, an auxiliary variable $Y = L P$, and a scalar $\\gamma_2 > 0$, that guarantees the induced $\\ell_2$ gain from $a(t)$ to $e(t)$ is less than $\\gamma_2$. Then, using norm equivalence $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$ and $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$ for $v \\in \\mathbb{R}^n$ and $a \\in \\mathbb{R}^p$, conclude a sufficient bound $\\gamma_{\\infty} \\leq \\sqrt{p} \\, \\gamma_2$. Your derivation should start from the bounded-real lemma for continuous-time systems and use Schur complements to obtain an explicit LMI involving $A$, $C$, $P$, $Y$, and $\\gamma_2$.\n\n2) Specialize to the case $C = I_n$ (the identity matrix) and $A$ diagonal with entries $a_i \\in \\mathbb{R}$, $i = 1, \\dots, n$. In this decoupled case, consider the scalar error channel\n$$\n\\dot{e}_i(t) = \\left( a_i - \\ell_i \\right) e_i(t) - \\ell_i \\, a_i(t),\n$$\nwhere $\\ell_i$ is the $i$-th diagonal entry of $L$ and $a_i(t)$ is the $i$-th component of $a(t)$. Show that the induced $\\ell_{\\infty}$ gain from $a_i(t)$ to $e_i(t)$ equals\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_{0}^{\\infty} \\left| \\ell_i \\, e^{\\left( a_i - \\ell_i \\right) t} \\right| \\, dt = \n\\begin{cases}\n\\dfrac{|\\ell_i|}{\\ell_i - a_i}, & \\text{if } \\ell_i > a_i, \\\\\n+\\infty, & \\text{otherwise},\n\\end{cases}\n$$\nand deduce the minimized bound $\\gamma_{\\infty,i}^{\\star}$ over $\\ell_i$ that ensures stability of the scalar channel. Provide the final expression of $\\gamma_{\\infty}^{\\star} = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^{\\star}$.\n\n3) Implement a program that, for the following test suite of diagonal systems with $C = I_n$ and $\\bar{a} = 1$ (unitless), computes the minimized worst-case induced $\\ell_{\\infty}$ bound $\\gamma_{\\infty}^{\\star}$ according to Task 2. Each test case is specified by the diagonal entries of $A$, as follows:\n- Test 1 (happy path, unstable plant requiring observer stabilization): $A = \\mathrm{diag}(0.1, 0.3)$.\n- Test 2 (mixed stability): $A = \\mathrm{diag}(-0.2, 0.4)$.\n- Test 3 (stable plant, best-case): $A = \\mathrm{diag}(-0.7, -0.1)$.\n- Test 4 (boundary case): $A = \\mathrm{diag}(0.0, -0.3)$.\n\nIn each case, compute the minimized $\\gamma_{\\infty}^{\\star}$ as a float. Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, \"[result1,result2,result3,result4]\".\n\nAll answers are unitless and should be provided as floats. No angle units or percentages are involved in this problem. The program must be self-contained, use only the specified libraries, take no user input, and follow the specified output format.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard problem in resilient control theory, specifically observer design to mitigate the effects of adversarial attacks. All provided information is self-contained and consistent.\n\n### Task 1: LMI Condition Derivation and Norm Bounding\n\nThe objective of this task is to derive a sufficient Linear Matrix Inequality (LMI) condition for a guaranteed level of performance and then relate different performance measures.\n\nThe estimation error dynamics are given by:\n$$\n\\dot{e}(t) = (A - LC) e(t) - L a(t)\n$$\nWe can view this as a linear time-invariant (LTI) system with input $w(t) = a(t)$ and state $e(t)$. If we define the output to be the state itself, $z(t) = e(t)$, the system can be written in state-space form as:\n$$\n\\begin{cases}\n\\dot{e}(t) = A_e e(t) + B_e w(t) \\\\\nz(t) = C_e e(t) + D_e w(t)\n\\end{cases}\n$$\nwhere $A_e = A - LC$, $B_e = -L$, $C_e = I_n$ (the $n \\times n$ identity matrix), and $D_e = 0$.\n\nThe induced $\\ell_2$ gain from the input $a(t)$ to the output $e(t)$ is the $\\mathcal{H}_{\\infty}$ norm of the system's transfer function $G(s) = C_e(sI-A_e)^{-1}B_e + D_e$. The Bounded-Real Lemma provides a condition for this gain to be less than a scalar $\\gamma_2 > 0$. It states that $\\|G\\|_{\\mathcal{H}_{\\infty}} < \\gamma_2$ if and only if there exists a symmetric positive definite matrix $P = P^\\top \\succ 0$ such that the following matrix inequality holds:\n$$\n\\begin{bmatrix}\nA_e^\\top P + P A_e + C_e^\\top C_e & P B_e \\\\\nB_e^\\top P & -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\nSubstituting the matrices $A_e$, $B_e$, $C_e$, and $D_e = 0$ for our error system, we obtain:\n$$\n\\begin{bmatrix}\n(A - LC)^\\top P + P (A - LC) + I_n & -PL \\\\\n-L^\\top P & -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\nThis inequality is linear in $P$ but contains the product $PLC$, which is nonlinear in the design variables $P$ and $L$. To convert this into an LMI, we perform a standard change of variables. We define a new matrix variable $Y = LP$. Note that since $P$ must be invertible, we can recover the observer gain $L$ via $L=YP^{-1}$ after solving for $P$ and $Y$.\n\nSubstituting $L = YP^{-1}$ into the inequality gives:\n$$\n(A - YP^{-1}C)^\\top P + P (A - YP^{-1}C) = (A^\\top - C^\\top (P^{-1})^\\top Y^\\top)P + P(A - YP^{-1}C)\n$$\nSince $P$ is symmetric, $P=P^\\top$ and $P^{-1} = (P^{-1})^\\top$.\n$$\n= (A^\\top - C^\\top Y^\\top P^{-1})P + PA - PYP^{-1}C = A^\\top P - C^\\top Y^\\top + PA - YC\n$$\nThe term $-PL$ becomes $-P(YP^{-1}) = -Y$.\nSubstituting $Y=LP$ into the original matrix inequality yields:\n$$\n\\begin{bmatrix}\nA^\\top P + PA - C^\\top Y^\\top - YC + I_n & -Y \\\\\n-Y^\\top & -\\gamma_2^2 I_p\n\\end{bmatrix} \\prec 0\n$$\nThis is a Linear Matrix Inequality in the variables $P=P^\\top$, $Y$, and $\\gamma_2^2$. The problem of minimizing the $\\ell_2$ gain can be posed as a convex optimization problem. Let $\\nu = \\gamma_2^2$.\n$$\n\\min_{P \\succ 0, Y, \\nu > 0} \\nu \\quad \\text{subject to} \\quad \\begin{bmatrix} A^\\top P + PA - C^\\top Y^\\top - YC + I_n & -Y \\\\ -Y^\\top & -\\nu I_p \\end{bmatrix} \\prec 0\n$$\nThe minimum $\\ell_2$ gain is $\\gamma_{2}^{\\star} = \\sqrt{\\nu^{\\star}}$.\n\nNext, we relate the induced $\\ell_2$ gain $\\gamma_2$ to the induced $\\ell_\\infty$ gain $\\gamma_\\infty$. We are given the vector norm inequalities $\\lVert v \\rVert_{\\infty} \\leq \\lVert v \\rVert_{2}$ for $v \\in \\mathbb{R}^n$ and $\\lVert a \\rVert_{2} \\leq \\sqrt{p} \\, \\lVert a \\rVert_{\\infty}$ for $a \\in \\mathbb{R}^p$.\nThe induced $\\ell_\\infty$ norm of the error system is defined by $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_{\\infty} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\gamma_\\infty \\bar{a}$.\nA key result for stable LTI systems is that the induced gain from an $\\mathcal{L}_\\infty$ input signal (with norm $\\sup_t \\|a(t)\\|_2$) to an $\\mathcal{L}_\\infty$ output signal (with norm $\\sup_t \\|e(t)\\|_2$) is also given by the $\\mathcal{H}_\\infty$ norm of the transfer function, $\\gamma_2$. That is:\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\nUsing the provided inequalities, we can establish the bound. For any time $t$:\n$$\n\\lVert e(t) \\rVert_{\\infty} \\leq \\lVert e(t) \\rVert_2\n$$\nTaking the supremum over $t \\geq 0$ on both sides:\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2\n$$\nNow, we use the induced gain property:\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2\n$$\nNext, we apply the inequality for the input vector $a(t)$:\n$$\n\\lVert a(t) \\rVert_2 \\leq \\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}\n$$\nTaking the supremum over $t \\geq 0$:\n$$\n\\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\sup_{t \\geq 0} (\\sqrt{p} \\, \\lVert a(t) \\rVert_{\\infty}) = \\sqrt{p} \\sup_{t \\geq 0} \\lVert a(t) \\rVert_{\\infty} = \\sqrt{p} \\, \\bar{a}\n$$\nCombining these steps:\n$$\n\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\sup_{t \\geq 0} \\lVert e(t) \\rVert_2 \\leq \\gamma_2 \\sup_{t \\geq 0} \\lVert a(t) \\rVert_2 \\leq \\gamma_2 (\\sqrt{p} \\, \\bar{a})\n$$\nBy comparing this with the definition $\\sup_{t \\geq 0} \\lVert e(t) \\rVert_{\\infty} \\leq \\gamma_\\infty \\bar{a}$, we conclude that a sufficient bound on the induced $\\ell_\\infty$ gain is:\n$$\n\\gamma_\\infty \\leq \\sqrt{p} \\, \\gamma_2\n$$\n\n### Task 2: Analysis of a Decoupled Diagonal System\n\nFor this task, we specialize to the case where $A = \\mathrm{diag}(a_1, \\dots, a_n)$, $C = I_n$, and the observer gain $L$ is also chosen to be diagonal, $L = \\mathrm{diag}(\\ell_1, \\dots, \\ell_n)$. The error dynamics decouple into $n$ independent scalar systems:\n$$\n\\dot{e}_i(t) = (a_i - \\ell_i) e_i(t) - \\ell_i a_i(t) \\quad \\text{for } i=1, \\dots, n\n$$\nThe induced $\\ell_\\infty$ gain $\\gamma_{\\infty,i}$ from the scalar input $a_i(t)$ to the scalar output $e_i(t)$ is given by the $\\ell_1$ norm of the system's impulse response, $h_i(t) = -\\ell_i e^{(a_i - \\ell_i)t}$.\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\int_0^\\infty |h_i(t)| dt = \\int_0^\\infty |-\\ell_i e^{(a_i - \\ell_i)t}| dt = |\\ell_i| \\int_0^\\infty e^{(a_i - \\ell_i)t} dt\n$$\nFor the system to be stable, the integral must converge, which requires the exponent to be negative: $a_i - \\ell_i < 0$, or $\\ell_i > a_i$. If this condition is not met ($\\ell_i \\le a_i$), the impulse response does not decay to zero, and the gain is infinite, $\\gamma_{\\infty,i} = +\\infty$.\n\nAssuming stability, i.e., $\\ell_i > a_i$, the integral evaluates to:\n$$\n\\int_0^\\infty e^{(a_i - \\ell_i)t} dt = \\left[ \\frac{e^{(a_i - \\ell_i)t}}{a_i - \\ell_i} \\right]_0^\\infty = 0 - \\frac{1}{a_i - \\ell_i} = \\frac{1}{\\ell_i - a_i}\n$$\nThus, the gain is:\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}, \\quad \\text{for } \\ell_i > a_i\n$$\nThis confirms the expression given in the problem statement.\n\nNow we must find the observer gain $\\ell_i$ that minimizes this gain, $\\gamma_{\\infty,i}^\\star = \\min_{\\ell_i > a_i} \\gamma_{\\infty,i}(\\ell_i)$. We analyze this by cases based on the sign of $a_i$.\n\nCase 1: $a_i \\ge 0$.\nThe stability condition is $\\ell_i > a_i \\ge 0$, which implies $\\ell_i > 0$. Therefore, $|\\ell_i| = \\ell_i$. The gain function is:\n$$\n\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i} = \\frac{(\\ell_i - a_i) + a_i}{\\ell_i - a_i} = 1 + \\frac{a_i}{\\ell_i - a_i}\n$$\nIf $a_i = 0$, then $\\gamma_{\\infty,i}(\\ell_i) = 1$ for any $\\ell_i > 0$. The minimum gain is $\\gamma_{\\infty,i}^\\star = 1$.\nIf $a_i > 0$, the term $\\frac{a_i}{\\ell_i - a_i}$ is positive. To minimize the gain, we must make this term as small as possible. This is achieved by making the denominator $\\ell_i - a_i$ as large as possible, which means taking $\\ell_i \\to \\infty$. The limit is:\n$$\n\\lim_{\\ell_i \\to \\infty} \\left( 1 + \\frac{a_i}{\\ell_i - a_i} \\right) = 1 + 0 = 1\n$$\nSo, the infimum of the gain is $1$. In this scenario, the minimized bound is $\\gamma_{\\infty,i}^\\star = 1$.\n\nCase 2: $a_i < 0$.\nThe stability condition is $\\ell_i > a_i$. We analyze the function $\\gamma_{\\infty,i}(\\ell_i) = \\frac{|\\ell_i|}{\\ell_i - a_i}$ on the domain $(a_i, \\infty)$.\nSubcase 2a: $\\ell_i \\ge 0$. Here, $|\\ell_i| = \\ell_i$. The gain is $\\gamma_{\\infty,i}(\\ell_i) = \\frac{\\ell_i}{\\ell_i - a_i}$. Its derivative is $\\frac{d\\gamma}{d\\ell_i} = \\frac{(\\ell_i-a_i) - \\ell_i}{(\\ell_i-a_i)^2} = \\frac{-a_i}{(\\ell_i-a_i)^2}$. Since $a_i < 0$, the derivative is positive, so the function is increasing for $\\ell_i \\ge 0$. The minimum value in this range is at $\\ell_i = 0$, where $\\gamma_{\\infty,i}(0) = \\frac{0}{0-a_i} = 0$.\nSubcase 2b: $a_i < \\ell_i < 0$. Here, $|\\ell_i| = -\\ell_i$. The gain is $\\gamma_{\\infty,i}(\\ell_i) = \\frac{-\\ell_i}{\\ell_i - a_i}$. Its derivative is $\\frac{d\\gamma}{d\\ell_i} = \\frac{-(\\ell_i-a_i) - (-\\ell_i)}{(\\ell_i-a_i)^2} = \\frac{a_i}{(\\ell_i-a_i)^2}$. Since $a_i<0$, the derivative is negative, so the function is decreasing for $\\ell_i \\in (a_i, 0)$. The infimum is approached as $\\ell_i \\to 0^-$, where the gain approaches $0$.\n\nCombining these subcases, for $a_i < 0$, the minimum gain is $\\gamma_{\\infty,i}^\\star = 0$, achieved by choosing $\\ell_i = 0$. This is intuitive: if a plant mode is already stable, no observation feedback is needed for stabilization, and by setting $\\ell_i=0$, the attack signal $a_i(t)$ is completely decoupled from the error dynamics for that mode.\n\nSummary of minimized scalar gains:\n$$\n\\gamma_{\\infty,i}^\\star =\n\\begin{cases}\n0, & \\text{if } a_i < 0 \\\\\n1, & \\text{if } a_i \\ge 0\n\\end{cases}\n$$\nThe overall worst-case induced $\\ell_\\infty$ gain for the vector system is the maximum of the individual scalar gains. This is because $\\|e(t)\\|_\\infty = \\max_i |e_i(t)|$. We have $|e_i(t)| \\le \\gamma_{\\infty,i} \\sup_t |a_i(t)| \\le \\gamma_{\\infty,i} \\|a(t)\\|_\\infty \\le \\gamma_{\\infty,i} \\bar{a}$. Therefore, $\\|e(t)\\|_\\infty \\le (\\max_i \\gamma_{\\infty,i}) \\bar{a}$.\nThe minimized overall gain is thus:\n$$\n\\gamma_\\infty^\\star = \\max_{i=1,\\dots,n} \\gamma_{\\infty,i}^\\star\n$$\nThis means that if all plant modes are stable (all $a_i < 0$), the optimal gain is $\\gamma_\\infty^\\star = 0$. If even one plant mode is unstable or marginally stable ($a_i \\ge 0$), the optimal gain is $\\gamma_\\infty^\\star = 1$.\n\n### Task 3: Implementation\n\nThis logic is directly applied to the test cases.\n- Test 1: $A = \\mathrm{diag}(0.1, 0.3)$. Contains $0.1 \\ge 0$ and $0.3 \\ge 0$. Result: $1.0$.\n- Test 2: $A = \\mathrm{diag}(-0.2, 0.4)$. Contains $0.4 \\ge 0$. Result: $1.0$.\n- Test 3: $A = \\mathrm{diag}(-0.7, -0.1)$. All entries are $< 0$. Result: $0.0$.\n- Test 4: $A = \\mathrm{diag}(0.0, -0.3)$. Contains $0.0 \\ge 0$. Result: $1.0$.\nThe expected output is $[1.0, 1.0, 0.0, 1.0]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used.\n\ndef solve():\n    \"\"\"\n    Computes the minimized worst-case induced l-infinity bound for a set of\n    decoupled linear systems based on the stability of their modes.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple of the diagonal entries of the matrix A.\n    test_cases = [\n        (0.1, 0.3),    # Test 1: Unstable plant\n        (-0.2, 0.4),   # Test 2: Mixed stability\n        (-0.7, -0.1),  # Test 3: Stable plant\n        (0.0, -0.3),   # Test 4: Boundary case (marginally stable)\n    ]\n\n    results = []\n    \n    # Process each test case.\n    for case in test_cases:\n        # Convert the tuple of diagonal entries into a numpy array for easy processing.\n        a_diag = np.array(case)\n        \n        # The logic derived in Task 2 is as follows:\n        # The minimized induced l-infinity gain for a single scalar channel i,\n        # gamma_infinity_i_star, is 0 if the plant mode a_i is stable (a_i < 0),\n        # and 1 if the plant mode a_i is marginally stable or unstable (a_i >= 0).\n        #\n        # The overall minimized gain for the vector system, gamma_infinity_star,\n        # is the maximum of the individual scalar gains.\n        # gamma_infinity_star = max(gamma_infinity_i_star for all i).\n        #\n        # This implies that if any mode a_i is non-negative (>= 0), the overall\n        # minimized gain will be 1. If all modes are strictly negative (< 0),\n        # the overall minimized gain will be 0.\n        \n        # Check if any diagonal element is non-negative (>= 0).\n        # The `any()` method on a boolean numpy array returns True if at least\n        # one element is True.\n        if np.any(a_diag >= 0):\n            gamma_infinity_star = 1.0\n        else:\n            gamma_infinity_star = 0.0\n            \n        results.append(gamma_infinity_star)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float in the results list to a string.\n    # ','.join(...) concatenates these strings with a comma in between.\n    # The f-string places this comma-separated string inside square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function.\nsolve()\n\n```"
        }
    ]
}