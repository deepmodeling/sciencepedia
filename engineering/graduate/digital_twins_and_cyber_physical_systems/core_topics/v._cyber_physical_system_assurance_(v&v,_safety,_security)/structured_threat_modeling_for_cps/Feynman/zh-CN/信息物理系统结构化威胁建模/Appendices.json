{
    "hands_on_practices": [
        {
            "introduction": "结构化威胁建模的第一步是系统地识别和评估潜在的攻击路径。攻击树是一种强大的图形化方法，用于将“未经授权的阀门开启”等顶层威胁事件分解为一系列更简单、可量化的攻击步骤。本练习将指导您如何构建和分析一个攻击树，通过结合单个攻击行为的基准概率和现有防御控制的有效性，来计算整个威胁场景的残余风险，从而掌握量化风险评估的核心技能。",
            "id": "4248547",
            "problem": "一个远程操作的隔离阀是化学过程系统 (CPS) 的一部分，该系统由一个数字孪生 (Digital Twin) 进行镜像，该数字孪生复制了阀门的物理状态和控制逻辑，用于监控和预测性维护。工业控制系统 (ICS) 网络包括一个可编程逻辑控制器 (PLC) 和一个人机界面 (HMI)。考虑顶层事件“在 $T = 24$ 小时的时间范围内未经授权的阀门开启”。使用攻击树对该顶层事件进行建模，其中内部节点是逻辑与门和或门，叶节点代表原子攻击步骤。使用以下科学上合理的结构和参数，并将攻击者行为和防御者控制视为概率上独立的，除非明确说明了条件性。\n\n顶层事件分支（所有三个分支在顶层事件处为逻辑或关系）：\n- 分支 $\\mathcal{B}_{1}$（远程命令注入）是两个子路径的逻辑或：\n  - 子路径 $\\mathcal{B}_{1a}$ 是叶节点 $L_{1}$（通过网络钓鱼泄露操作员凭据）和叶节点 $L_{2}$（由于缺少授权检查而接受远程命令）的逻辑与。\n  - 子路径 $\\mathcal{B}_{1b}$ 是叶节点 $L_{3}$（防火墙规则配置错误允许命令路径）和叶节点 $L_{4}$（PLC 的零日漏洞利用实现未经授权的命令）的逻辑与。\n- 分支 $\\mathcal{B}_{2}$（现场篡改）是叶节点 $L_{5}$（对控制器外壳的物理入侵）和叶节点 $L_{6}$（手动超控开关闭合且未被察觉）的逻辑与。$L_{6}$ 的发生以 $L_{5}$ 的发生为条件。\n- 分支 $\\mathcal{B}_{3}$（数字孪生失步）是叶节点 $L_{7}$（孪生数据完整性受损导致错误的“关闭”状态）和叶节点 $L_{8}$（在孪生误报时注入执行器命令）的逻辑与。\n\n对于每个叶节点 $L_{i}$，给定基准日发生概率 $p_{i}$（在没有防御者控制的情况下攻击者行动成功的概率）和防御者控制阻止概率 $b_{i}$（防御者控制阻止该叶节点事件的概率）。参数如下：\n- $p_{1} = 3.0 \\times 10^{-3}$，其中 $b_{1} = 0.95$，\n- $p_{2} = 1.0 \\times 10^{-3}$，其中 $b_{2} = 0.80$，\n- $p_{3} = 5.0 \\times 10^{-3}$，其中 $b_{3} = 0.90$，\n- $p_{4} = 2.0 \\times 10^{-4}$，其中 $b_{4} = 0.50$，\n- $p_{5} = 4.0 \\times 10^{-3}$，其中 $b_{5} = 0.90$，\n- $p_{6} = 5.0 \\times 10^{-3}$，其中 $b_{6} = 0.60$，\n- $p_{7} = 1.5 \\times 10^{-3}$，其中 $b_{7} = 0.85$，\n- $p_{8} = 8.0 \\times 10^{-4}$，其中 $b_{8} = 0.75$。\n\n使用概率公理和攻击树的标准语义（逻辑与对应于联合发生；逻辑或对应于至少一个子路径的发生），并假设除明确说明条件性（如 $L_{6}$ 给定 $L_{5}$）外，各叶节点之间相互独立，执行以下操作：\n1. 计算在相应防御者控制下，每个叶节点 $L_{i}$ 在 $T$ 时间内的残余可能性。\n2. 按照攻击树的规定，沿逻辑与和或进行聚合，以获得在 $T$ 时间内顶层事件的总体情景可能性。\n\n将最终情景可能性表示为科学记数法的小数，四舍五入到四位有效数字。不需要单位，答案不得为不等式或方程式。",
            "solution": "该问题要求在给定攻击树的逻辑结构和原子攻击步骤（叶节点）概率的情况下，计算顶层事件的概率。该问题定义明确，并在定量风险评估和概率建模的原则上具有科学依据。\n\n首先，我们将问题形式化。设 $E_i$ 为对应于叶节点 $L_i$ 的原子攻击成功的事件。问题为每个叶节点提供了基准日发生概率 $p_i$ 和防御者控制阻止概率 $b_i$。攻击步骤 $E_i$ 的成功要求基准攻击发生且相应的防御者控制失败。假设攻击行为和防御者控制是独立事件，则控制失败的概率为 $(1 - b_i)$。因此，每个叶节点事件 $E_i$ 成功的残余可能性，我们记为 $\\mathcal{L}_i$，由下式给出：\n$$ \\mathcal{L}_i = P(E_i) = p_i (1 - b_i) $$\n时间范围给定为 $T = 24$ 小时，概率 $p_i$ 以“日发生”概率给出，因此它们直接适用于此时间范围。\n\n我们为每个叶节点 $i=1, \\dots, 8$ 计算残余可能性 $\\mathcal{L}_i$：\n- $\\mathcal{L}_1 = p_1(1-b_1) = (3.0 \\times 10^{-3})(1 - 0.95) = (3.0 \\times 10^{-3})(0.05) = 1.5 \\times 10^{-4}$\n- $\\mathcal{L}_2 = p_2(1-b_2) = (1.0 \\times 10^{-3})(1 - 0.80) = (1.0 \\times 10^{-3})(0.20) = 2.0 \\times 10^{-4}$\n- $\\mathcal{L}_3 = p_3(1-b_3) = (5.0 \\times 10^{-3})(1 - 0.90) = (5.0 \\times 10^{-3})(0.10) = 5.0 \\times 10^{-4}$\n- $\\mathcal{L}_4 = p_4(1-b_4) = (2.0 \\times 10^{-4})(1 - 0.50) = (2.0 \\times 10^{-4})(0.50) = 1.0 \\times 10^{-4}$\n- $\\mathcal{L}_5 = p_5(1-b_5) = (4.0 \\times 10^{-3})(1 - 0.90) = (4.0 \\times 10^{-3})(0.10) = 4.0 \\times 10^{-4}$\n- $\\mathcal{L}_6 = p_6(1-b_6) = (5.0 \\times 10^{-3})(1 - 0.60) = (5.0 \\times 10^{-3})(0.40) = 2.0 \\times 10^{-3}$\n- $\\mathcal{L}_7 = p_7(1-b_7) = (1.5 \\times 10^{-3})(1 - 0.85) = (1.5 \\times 10^{-3})(0.15) = 2.25 \\times 10^{-4}$\n- $\\mathcal{L}_8 = p_8(1-b_8) = (8.0 \\times 10^{-4})(1 - 0.75) = (8.0 \\times 10^{-4})(0.25) = 2.0 \\times 10^{-4}$\n\n接下来，我们按照攻击树的结构聚合这些概率。\n顶层事件 $TE$ 是三个主分支的并集（逻辑或）：$TE = \\mathcal{B}_1 \\cup \\mathcal{B}_2 \\cup \\mathcal{B}_3$。\n这些分支由涉及不相交叶节点集的事件组成，因此我们可以将 $\\mathcal{B}_1$、$\\mathcal{B}_2$ 和 $\\mathcal{B}_3$ 视为相互独立的事件。它们的并集概率为：\n$$ P(TE) = 1 - (1 - P(\\mathcal{B}_1))(1 - P(\\mathcal{B}_2))(1 - P(\\mathcal{B}_3)) $$\n\n我们计算每个分支的概率。\n**分支 $\\mathcal{B}_1$（远程命令注入）：**\n此分支是两个子路径的并集：$\\mathcal{B}_1 = \\mathcal{B}_{1a} \\cup \\mathcal{B}_{1b}$。\n子路径 $\\mathcal{B}_{1a}$ 是 $E_1$ 和 $E_2$ 的交集（逻辑与）。由于 $E_1$ 和 $E_2$ 是独立的：\n$$ P(\\mathcal{B}_{1a}) = P(E_1 \\cap E_2) = P(E_1)P(E_2) = \\mathcal{L}_1 \\mathcal{L}_2 = (1.5 \\times 10^{-4})(2.0 \\times 10^{-4}) = 3.0 \\times 10^{-8} $$\n子路径 $\\mathcal{B}_{1b}$ 是 $E_3$ 和 $E_4$ 的交集。由于 $E_3$ 和 $E_4$ 是独立的：\n$$ P(\\mathcal{B}_{1b}) = P(E_3 \\cap E_4) = P(E_3)P(E_4) = \\mathcal{L}_3 \\mathcal{L}_4 = (5.0 \\times 10^{-4})(1.0 \\times 10^{-4}) = 5.0 \\times 10^{-8} $$\n子路径 $\\mathcal{B}_{1a}$ 和 $\\mathcal{B}_{1b}$ 涉及不相交的叶节点集，因此是独立的。它们的并集概率是：\n$$ P(\\mathcal{B}_1) = P(\\mathcal{B}_{1a} \\cup \\mathcal{B}_{1b}) = P(\\mathcal{B}_{1a}) + P(\\mathcal{B}_{1b}) - P(\\mathcal{B}_{1a})P(\\mathcal{B}_{1b}) $$\n$$ P(\\mathcal{B}_1) = (3.0 \\times 10^{-8}) + (5.0 \\times 10^{-8}) - (3.0 \\times 10^{-8})(5.0 \\times 10^{-8}) $$\n$$ P(\\mathcal{B}_1) = 8.0 \\times 10^{-8} - 1.5 \\times 10^{-15} \\approx 8.0 \\times 10^{-8} $$\n\n**分支 $\\mathcal{B}_2$（现场篡改）：**\n此分支是 $E_5$ 和 $E_6$ 的交集。问题陈述 $L_6$ 的发生以 $L_5$ 为条件。这证实了与逻辑，即分支的成功需要两个事件都发生。概率为 $P(\\mathcal{B}_2) = P(E_5 \\cap E_6) = P(E_6|E_5)P(E_5)$。在没有其他信息的情况下，所提供的概率 $p_6$ 被解释为与条件事件相关。因此，残余可能性 $\\mathcal{L}_6$ 代表 $P(E_6|E_5 \\text{ attempt})$。假设只有在 $E_5$ 成功时才会尝试 $E_6$，这导致 $P(\\mathcal{B}_2) = \\mathcal{L}_5 \\mathcal{L}_6$。\n$$ P(\\mathcal{B}_2) = \\mathcal{L}_5 \\mathcal{L}_6 = (4.0 \\times 10^{-4})(2.0 \\times 10^{-3}) = 8.0 \\times 10^{-7} $$\n\n**分支 $\\mathcal{B}_3$（数字孪生失步）：**\n此分支是 $E_7$ 和 $E_8$ 的交集。这些事件是独立的。\n$$ P(\\mathcal{B}_3) = P(E_7 \\cap E_8) = \\mathcal{L}_7 \\mathcal{L}_8 = (2.25 \\times 10^{-4})(2.0 \\times 10^{-4}) = 4.5 \\times 10^{-8} $$\n\n**顶层事件可能性：**\n现在我们结合三个主分支的概率。\n$P(\\mathcal{B}_1) \\approx 8.0 \\times 10^{-8}$\n$P(\\mathcal{B}_2) = 8.0 \\times 10^{-7}$\n$P(\\mathcal{B}_3) = 4.5 \\times 10^{-8}$\n由于这些概率非常小，其并集的概率可以很好地通过它们的和来近似：\n$P(TE) \\approx P(\\mathcal{B}_1) + P(\\mathcal{B}_2) + P(\\mathcal{B}_3) \\approx (8.0 \\times 10^{-8}) + (8.0 \\times 10^{-7}) + (4.5 \\times 10^{-8}) = 9.25 \\times 10^{-7}$。\n为了进行更精确的计算，我们使用独立事件并集的公式：\n$$ P(TE) = 1 - (1 - P(\\mathcal{B}_1))(1 - P(\\mathcal{B}_2))(1 - P(\\mathcal{B}_3)) $$\n$$ P(TE) = 1 - (1 - 7.999... \\times 10^{-8})(1 - 8.0 \\times 10^{-7})(1 - 4.5 \\times 10^{-8}) $$\n$$ P(TE) \\approx 1 - (1 - (8.0 \\times 10^{-8} + 8.0 \\times 10^{-7} + 4.5 \\times 10^{-8})) $$\n$$ P(TE) \\approx 9.25 \\times 10^{-7} $$\n进行精确计算：$1 - (1 - 8.0 \\times 10^{-8})(1 - 8.0 \\times 10^{-7})(1 - 4.5 \\times 10^{-8}) \\approx 9.2496 \\times 10^{-7}$。\n问题要求最终答案四舍五入到四位有效数字。\n$$ P(TE) \\approx 9.250 \\times 10^{-7} $$",
            "answer": "$$\\boxed{9.250 \\times 10^{-7}}$$"
        },
        {
            "introduction": "在量化了宏观威胁之后，深入分析特定漏洞的根本原因至关重要，尤其是那些源于网络与物理层面相互作用的漏洞。本练习通过一个关于时钟漂移影响自动导引车传感器融合的假设场景，探讨了这种深层脆弱性。您需要从基本物理和控制原理出发，推导出一个解析表达式，用以确定在触发安全警报之前系统所能容忍的最大时间同步误差，这有助于您理解如何对信息物理系统的底层扰动进行精确建模和风险界定。",
            "id": "4248517",
            "problem": "在一个信息物理系统 (CPS) 中，一个监控一维自动导引车的数字孪生 (DT) 使用了位置传感器和源自惯性测量单元 (IMU) 的速度传感器之间的传感器融合技术。时间同步漂移被建模为 $t' = t + \\delta t$，其中 $t'$ 表示应用于速度测量值的时间戳，而 $\\delta t$ 是时钟漂移。在结构化威胁建模评估中，时钟漂移被视为一种对抗性扰动，它会使融合后的状态估计产生偏差，并可能将系统推到既定的安全边界之外。该融合过程由一个基于匀速模型的离散时间线性卡尔曼滤波器执行。状态为 $[x, v]^{\\top}$，其中 $x$ 是位置，$v$ 是速度。该滤波器在时间 $t$ 使用位置和速度测量值执行一次测量更新，然后使用运动学关系 $x_{k+1} = x_{k} + v_{k} T_s$ 进行到 $t + T_s$ 的一步预测，其中 $T_s$ 是采样周期。由于时钟漂移，卡尔曼更新时刻 $t$ 的速度测量值存在时间误差，因此它是在 $t' = t + \\delta t$ 时的物理速度。对于较小的漂移，使用一阶近似 $v(t') \\approx v(t) + a(t) \\delta t$，其中 $a(t)$ 是瞬时加速度。\n\n假设以下内容已知且在科学上是合理的：\n- 采样周期为 $T_s = 0.1$ 秒。\n- 在测量更新时，先验速度估计方差为 $\\sigma_{v,p}^{2} = 0.19$ (单位 $\\text{m}^{2}/\\text{s}^{2}$)，速度测量噪声方差为 $\\sigma_{v}^{2} = 0.01$ (单位 $\\text{m}^{2}/\\text{s}^{2}$)。\n- 测量矩阵是单位矩阵，因此位置和速度都在更新时刻由传感器直接测量（其中速度测量存在 $\\delta t$ 的时间误差）。\n- 单步预测位置估计偏差绝对值的危险阈值为 $H_x = 0.01$ 米：如果在时间 $t + T_s$ 的融合位置估计偏差超过 $H_x$，安全分析将系统归类为越过危险阈值。\n- 对于所有 $t$，加速度大小满足 $|a(t)| \\leq a_{\\max}$，其中 $a_{\\max} = 5$ $\\text{m}/\\text{s}^{2}$。\n\n从离散时间运动学的基本定义、带偏差测量的卡尔曼滤波器更新以及时移信号的一阶近似出发，推导出一个解析表达式，用于计算最大允许时钟漂移 $\\delta t_{\\max}$，以保证在所有满足 $|a(t)| \\leq a_{\\max}$ 的加速度下，时间 $t + T_s$ 的融合位置估计都保持在危险阈值之内。然后，使用给定的参数计算 $\\delta t_{\\max}$ 的数值。\n\n将最终数值答案四舍五入到四位有效数字。以秒为单位表示最终漂移。",
            "solution": "对问题陈述进行分析后，认定其是有效的。它在科学上基于控制理论和卡尔曼滤波，是适定的，并以客观、正式的语言表述。它提供了充分、一致的信息来推导出一个唯一的解，但这取决于一个合理的简化假设，该假设在威胁建模和参数选择性提供的背景下是合理的。\n\n目标是确定最大允许时钟漂移 $\\delta t_{\\max}$，使得单步预测位置估计偏差 $b_{x, k+1|k}$ 不超过危险阈值 $H_x$。\n\n系统在离散时间步 $k$ 的状态是向量 $s_k = [x_k, v_k]^{\\top}$。在时间 $t_k$ 的测量值为 $z_k = [z_{x,k}, z_{v,k}]^{\\top}$。位置测量值 $z_{x,k}$ 假设是无偏的。速度测量值 $z_{v,k}$ 是在时间不准的瞬间 $t_k' = t_k + \\delta t$ 获取的。使用所提供的一阶近似，此时的物理速度为 $v(t_k') \\approx v(t_k) + a(t_k) \\delta t$，其中 $a(t_k)$ 是瞬时加速度。\n\n因此，速度测量值 $z_{v,k}$ 被建模为：\n$$z_{v,k} = v(t_k') + n_{v,k} \\approx v_k + a(t_k) \\delta t + n_{v,k}$$\n其中 $v_k = v(t_k)$ 是在时间 $t_k$ 的真实速度，$n_{v,k}$ 是方差为 $\\sigma_v^2$ 的零均值测量噪声。该测量值含有一个偏差项 $b_{v,\\text{meas}} = a(t_k) \\delta t$。\n\n卡尔曼滤波器执行测量更新。我们关心的是引入状态估计中的偏差。分析的重点是在第 $k$ 步新测量偏差的影响，假设在此步骤之前滤波器状态是无偏的，即先验偏差 $b_{k|k-1} = 0$。\n\n用于速度更新的卡尔曼增益是一个标量值，因为只提供了与速度相关的方差。这个我们记为 $K_v$ 的增益决定了测量残差在多大程度上更新状态。它由以下公式给出：\n$$K_v = \\frac{\\sigma_{v,p}^2}{\\sigma_{v,p}^2 + \\sigma_v^2}$$\n其中 $\\sigma_{v,p}^2$ 是先验速度估计方差，$\\sigma_v^2$ 是速度测量噪声方差。\n代入给定值：$\\sigma_{v,p}^2 = 0.19$ 和 $\\sigma_v^2 = 0.01$。\n$$K_v = \\frac{0.19}{0.19 + 0.01} = \\frac{0.19}{0.20} = 0.95$$\n\n更新后（后验）的速度估计为 $\\hat{v}_{k|k} = \\hat{v}_{k|k-1} + K_v(z_{v,k} - \\hat{v}_{k|k-1})$。该估计中的偏差 $b_{v,k|k} = E[v_k - \\hat{v}_{k|k}]$，可以通过求期望得到，假设先验估计是无偏的（$E[v_k - \\hat{v}_{k|k-1}] = 0$）且噪声是零均值的（$E[n_{v,k}]=0$）：\n$$b_{v,k|k} = E[v_k - (\\hat{v}_{k|k-1} + K_v(v_k + b_{v,\\text{meas}} + n_{v,k} - \\hat{v}_{k|k-1}))]$$\n$$b_{v,k|k} = E[(I-K_v)(v_k - \\hat{v}_{k|k-1}) - K_v b_{v,\\text{meas}} - K_v n_{v,k}]$$\n$$b_{v,k|k} = -K_v b_{v,\\text{meas}} = -K_v a(t_k) \\delta t$$\n\n接下来，我们将这个偏差传播到单步预测的位置。滤波器的预测模型由下式给出：\n$$\\hat{x}_{k+1|k} = \\hat{x}_{k|k} + \\hat{v}_{k|k} T_s$$\n这个预测位置中的偏差 $b_{x,k+1|k} = E[x_{k+1} - \\hat{x}_{k+1|k}]$，由第 $k$ 步的后验偏差传播得到：\n$$b_{x,k+1|k} = b_{x,k|k} + b_{v,k|k} T_s$$\n其中 $b_{x,k|k} = E[x_k - \\hat{x}_{k|k}]$ 是更新后位置估计的偏差。一个完整的卡尔曼滤波器分析会表明 $b_{x,k|k} = -K_{xv} b_{v,\\text{meas}}$，其中 $K_{xv}$ 是卡尔曼增益矩阵中的一个非对角项。然而，问题没有提供计算 $K_{xv}$ 所需的参数（例如，位置测量方差 $\\sigma_x^2$，或先验位置协方差元素 $P_{xx,p}, P_{xv,p}$）。这意味着问题旨在进行一次目标明确的分析，仅关注从速度误差到位置预测误差的直接传播路径。因此，我们对此类威胁分析做出标准的简化假设：位置测量足够精确，其更新在融合位置估计中占主导地位，使得来自速度测量的偏差贡献可以忽略不计，即 $b_{x,k|k} \\approx 0$。\n\n在此假设下，预测的位置偏差简化为：\n$$b_{x,k+1|k} \\approx b_{v,k|k} T_s$$\n代入速度偏差的表达式：\n$$b_{x,k+1|k} \\approx -K_v a(t_k) \\delta t T_s$$\n\n安全要求是，对于任何允许的加速度 $|a(t)| \\leq a_{\\max}$，该偏差的绝对值不得超过危险阈值 $H_x = 0.01$ 米。\n$$|b_{x,k+1|k}| \\leq H_x$$\n$$|-K_v a(t_k) \\delta t T_s| \\leq H_x$$\n$$K_v |a(t_k)| |\\delta t| T_s \\leq H_x$$\n\n为了保证对所有有效加速度都满足此条件，我们必须考虑最坏情况，即加速度大小达到其最大值 $|a(t_k)| = a_{\\max} = 5 \\, \\text{m}/\\text{s}^2$。最大允许时钟漂移 $\\delta t_{\\max}$ 是使该表达式取等号的 $|\\delta t|$ 的值。\n$$K_v a_{\\max} \\delta t_{\\max} T_s = H_x$$\n\n求解 $\\delta t_{\\max}$ 可得解析表达式：\n$$\\delta t_{\\max} = \\frac{H_x}{K_v a_{\\max} T_s}$$\n\n现在，我们代入数值：\n$H_x = 0.01$\n$K_v = 0.95$\n$a_{\\max} = 5$\n$T_s = 0.1$\n\n$$\\delta t_{\\max} = \\frac{0.01}{(0.95)(5)(0.1)} = \\frac{0.01}{0.475}$$\n$$\\delta t_{\\max} \\approx 0.02105263 \\, \\text{s}$$\n\n按要求将结果四舍五入到四位有效数字，得到：\n$$\\delta t_{\\max} \\approx 0.02105 \\, \\text{s}$$",
            "answer": "$$ \\boxed{0.02105} $$"
        },
        {
            "introduction": "威胁建模与漏洞分析的最终目的是指导和优化安全防御体系的设计。本练习聚焦于信任区域划分这一关键的架构级防御策略，它旨在通过隔离系统组件来限制攻击者的横向移动。您将通过一个优化问题，学习如何在最小化网络攻击面（即跨区域的通信流量）和保障系统关键性能（即控制回路的实时性）之间做出权衡，找到最佳的区域划分方案，从而体验安全设计中常见的约束与优化挑战。",
            "id": "4248537",
            "problem": "给定一个针对信息物理系统（CPS）的信任分区的形式化表述，该表述在控制性能约束下使用图分割方法。考虑一个CPS，其模型为一个加权无向图 $G = (V, E)$，其中 $V$ 是组件（节点）的集合，$E$ 是双向通信链路（边）的集合。每条边 $(u, v) \\in E$ 都有一个非负权重 $w_{uv}$，代表单位时间的平均流量，被视为暴露风险的代理指标。一个信任分区是将节点分配到两个区域的映射 $z: V \\to \\{0, 1\\}$，且这两个区域必须非空，即存在节点 $u$ 和 $v$ 使得 $z(u) = 0$ 且 $z(v) = 1$。目标是在保持控制性能的同时，最小化区域间的流量。\n\n定义一个分配方案 $z$ 的区域间流量（切割权重）为\n$$\nW(z) = \\sum_{(u, v) \\in E} w_{uv} \\cdot \\mathbf{1}\\big[z(u) \\neq z(v)\\big],\n$$\n其中 $\\mathbf{1}[\\cdot]$ 是指示函数。控制性能通过一组闭环控制路径来建模。每个路径 $p$ 是一个由有序的不同节点列表 $[v_0, v_1, \\dots, v_{m-1}]$ 表示的简单环路，这意味着存在一个由边 $(v_i, v_{i+1})$（$i = 0, \\dots, m-2$）和 $(v_{m-1}, v_0)$ 组成的环路。由于安全中介的存在，每次穿越信任区域边界会引入 $d_z$ 秒的额外延迟惩罚。每个控制路径 $p$ 都有一个最大允许附加延迟 $L_p^{\\max}$ 秒。对于一个分区分配 $z$，路径 $p$ 上的区域边界穿越次数为\n$$\nC_p(z) = \\sum_{i=0}^{m-1} \\mathbf{1}\\big[z(v_i) \\neq z(v_{(i+1) \\bmod m})\\big].\n$$\n每个路径 $p$ 的控制性能约束为\n$$\nC_p(z) \\le \\left\\lfloor \\frac{L_p^{\\max}}{d_z} \\right\\rfloor,\n$$\n其中 $\\lfloor \\cdot \\rfloor$ 表示向下取整函数。\n\n定义基线暴露面 $S_{\\text{base}}$ 为所有边的权重之和，\n$$\nS_{\\text{base}} = \\sum_{(u, v) \\in E} w_{uv}.\n$$\n在一个分区分配 $z$ 下，分区后的暴露面是切割权重 $S_{\\text{cut}} = W(z)$。暴露面的减少量量化为分数减少量\n$$\n\\rho = \\frac{S_{\\text{base}} - S_{\\text{cut}}}{S_{\\text{base}}},\n$$\n表示为一个四舍五入到四位小数的小数。如果没有非平凡分区分配（两个区域都非空）满足约束条件，则报告最小化区域间流量为 $-1$，减少比例为 $-1.0$。\n\n您的任务是实现一个程序，对于下面的每个测试用例，枚举所有非平凡的双区域分配方案 $z: V \\to \\{0, 1\\}$，检查每个控制路径的控制性能约束，并找到在约束条件下最小化 $W(z)$ 的分配方案。通过将一个节点固定在区域0中来使用穷举枚举，以避免重复标记（这可以减少对称性）。报告最优有效分配方案 $z^\\star$ 的最小化区域间流量 $W(z^\\star)$ 和减少比例 $\\rho$。如果没有两个区域都非空的有效分配方案，则对该测试用例输出 $-1$ 和 $-1.0$。\n\n所有延迟都必须以秒为单位处理。所有减少比例必须是四舍五入到四位小数的小数。\n\n测试套件：\n- 测试用例 1：\n  - 节点：$V = \\{0, 1, 2, 3, 4\\}$。\n  - 带权重的边：$(0,1)$ 权重 $w_{01} = 5$，$(1,2)$ 权重 $w_{12} = 4$，$(2,3)$ 权重 $w_{23} = 3$，$(3,0)$ 权重 $w_{30} = 2$，$(1,3)$ 权重 $w_{13} = 1$，$(2,4)$ 权重 $w_{24} = 2$，$(0,4)$ 权重 $w_{04} = 1$。\n  - 单个控制路径：$p_1 = [0, 1, 2, 3]$。\n  - 每次穿越的延迟惩罚：$d_z = 0.02$ 秒。\n  - 最大允许附加延迟：$L_{p_1}^{\\max} = 0.06$ 秒。\n- 测试用例 2（边界条件，只允许一次穿越）：\n  - 节点：$V = \\{0, 1, 2, 3\\}$。\n  - 带权重的边：$(0,1)$ 权重 $w_{01} = 6$，$(1,2)$ 权重 $w_{12} = 2$，$(2,3)$ 权重 $w_{23} = 2$，$(3,0)$ 权重 $w_{30} = 2$，$(0,2)$ 权重 $w_{02} = 1$。\n  - 单个控制路径：$p_1 = [0, 1, 2, 3]$。\n  - 每次穿越的延迟惩罚：$d_z = 0.05$ 秒。\n  - 最大允许附加延迟：$L_{p_1}^{\\max} = 0.05$ 秒。\n- 测试用例 3（具有不同预算的多个控制回路）：\n  - 节点：$V = \\{0, 1, 2, 3, 4\\}$。\n  - 带权重的边：$(0,1)$ 权重 $w_{01} = 3$，$(1,2)$ 权重 $w_{12} = 3$，$(2,0)$ 权重 $w_{20} = 3$，$(2,3)$ 权重 $w_{23} = 4$，$(3,4)$ 权重 $w_{34} = 1$，$(4,2)$ 权重 $w_{42} = 2$，$(1,3)$ 权重 $w_{13} = 2$。\n  - 两个控制路径：$p_1 = [0, 1, 2]$，$p_2 = [2, 3, 4]$。\n  - 每次穿越的延迟惩罚：$d_z = 0.01$ 秒。\n  - 最大允许附加延迟：$L_{p_1}^{\\max} = 0.02$ 秒，$L_{p_2}^{\\max} = 0.01$ 秒。\n- 测试用例 4（边界情况，约束可能使非平凡分区不可行）：\n  - 节点：$V = \\{0, 1, 2, 3\\}$。\n  - 带权重的边：$(0,1)$ 权重 $w_{01} = 7$，$(1,2)$ 权重 $w_{12} = 7$，$(2,3)$ 权重 $w_{23} = 7$，$(3,0)$ 权重 $w_{30} = 7$，$(0,2)$ 权重 $w_{02} = 1$，$(1,3)$ 权重 $w_{13} = 1$。\n  - 单个控制路径：$p_1 = [0, 1, 2, 3]$。\n  - 每次穿越的延迟惩罚：$d_z = 0.03$ 秒。\n  - 最大允许附加延迟：$L_{p_1}^{\\max} = 0.00$ 秒。\n\n您的程序应生成单行输出，包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个双元素列表 $[W(z^\\star), \\rho]$，其中减少比例四舍五入到四位小数。例如，总体输出应类似于 $[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]]$，其中每个 $a_i$ 是一个整数，每个 $b_i$ 是一个四舍五入到四位的小数。",
            "solution": "该问题要求我们为一个建模为加权无向图 $G = (V, E)$ 的信息物理系统（CPS）找到一个最优的信任分区方案。优化目标是将节点集 $V$ 划分为两个非空区域 $\\{0, 1\\}$，使得连接不同区域节点的边的总权重（切割权重 $W(z)$）最小化。此最小化过程受一组控制性能约束的限制，这些约束限制了任何指定的控制路径可以穿越区域边界的次数。\n\n此任务是一个带约束的图分割问题，是最小割问题的一个变体。鉴于每个测试用例中的节点数量很少（例如， $|V| \\le 5$ ），可以通过系统地枚举和评估所有可能的分区来找到精确解。\n\n总体方法如下：\n1.  **枚举分区**：我们必须考虑节点集 $V$ 的所有非平凡二分分区。一个二分分区是一个映射 $z: V \\to \\{0, 1\\}$，其中两个区域集合 $V_0 = \\{v \\in V | z(v) = 0\\}$ 和 $V_1 = \\{v \\in V | z(v) = 1\\}$ 均非空。总的分配方案数量为 $2^{|V|}$。其中，有两种是平凡的（所有节点都在一个区域中）。剩下的 $2^{|V|} - 2$ 种分配方案构成了 $(2^{|V|} - 2) / 2 = 2^{|V|-1} - 1$ 个唯一的非平凡分区，因为交换区域标签0和1会得到相同的分区。为了系统地、无重复地枚举这些唯一分区，我们可以固定一个节点的区域。让我们将节点0固定在区域0中，即 $z(0)=0$。然后我们遍历其余 $|V|-1$ 个节点的所有可能分配。这将产生 $2^{|V|-1}$ 种分配。所有其他节点也分配到区域0的情况对应于一个平凡分区，因此被排除。这样剩下 $2^{|V|-1} - 1$ 个非平凡分区需要检查，覆盖了整个搜索空间。\n\n2.  **验证约束**：对于 $2^{|V|-1} - 1$ 个候选分区中的每一个，我们必须验证它是否满足所有控制性能约束。对于每个控制路径 $p$，问题定义了一个最大允许的边界穿越次数 $C_p^{\\max}$，该次数由延迟预算得出：\n    $$C_p^{\\max} = \\left\\lfloor \\frac{L_p^{\\max}}{d_z} \\right\\rfloor$$\n    对于给定的分区 $z$，我们计算路径 $p = [v_0, v_1, \\dots, v_{m-1}]$ 的实际穿越次数：\n    $$C_p(z) = \\sum_{i=0}^{m-1} \\mathbf{1}\\big[z(v_i) \\neq z(v_{(i+1) \\bmod m})\\big]$$\n    如果对于任何路径 $p$ 有 $C_p(z) > C_p^{\\max}$，则分区 $z$ 是无效的，并被丢弃。分区平面上的简单环路有一个已知的性质，即穿越次数必须是偶数。这可以进一步修剪搜索或简化约束；例如，约束 $C_p(z) \\le 1$ 等价于 $C_p(z) = 0$。\n\n3.  **评估目标函数**：如果一个分区 $z$ 是有效的（满足所有约束），我们计算其成本，即区域间流量或切割权重 $W(z)$：\n    $$W(z) = \\sum_{(u, v) \\in E} w_{uv} \\cdot \\mathbf{1}\\big[z(u) \\neq z(v)\\big]$$\n    这是所有连接区域0中的节点到区域1中的节点的边的权重之和。\n\n4.  **寻找最优解**：我们维护一个变量 $W_{min}$，初始化为无穷大，用于存储在有效分区中找到的迄今为止的最小切割权重。每当找到一个有效分区 $z$ 时，就将其切割权重 $W(z)$ 与 $W_{min}$ 进行比较，如果 $W(z)$ 更小，则更新 $W_{min}$。\n\n5.  **计算最终指标**：遍历所有分区后，如果没有找到有效分区，我们按照问题规范报告 $W(z^\\star) = -1$ 和 $\\rho = -1.0$。否则，最终的最小化切割权重为 $W(z^\\star) = W_{min}$。然后计算暴露面的分数减少量 $\\rho$。首先，基线暴露面 $S_{\\text{base}}$ 是图中所有边的权重之和。\n    $$S_{\\text{base}} = \\sum_{(u, v) \\in E} w_{uv}$$\n    然后减少比例为：\n    $$\\rho = \\frac{S_{\\text{base}} - W(z^\\star)}{S_{\\text{base}}}$$\n    该值四舍五入到四位小数。这种穷举搜索保证能找到满足所有指定约束的全局最小切割权重。",
            "answer": "[[8,0.5556],[-1,-1.0],[5,0.7222],[-1,-1.0]]"
        }
    ]
}