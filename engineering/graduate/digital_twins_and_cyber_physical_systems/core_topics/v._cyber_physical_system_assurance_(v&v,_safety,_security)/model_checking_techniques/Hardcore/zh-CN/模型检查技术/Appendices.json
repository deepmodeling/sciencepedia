{
    "hands_on_practices": [
        {
            "introduction": "模型检测中最基本的问题是确定系统可以达到的所有状态的集合。符号化模型检测通过一次性操作整个状态集，而不是逐个状态进行分析，从而高效地解决了这个问题。本练习将通过一个简单的控制器示例，演示支撑多种验证技术的核心不动点迭代算法，并将抽象的算法与其收敛所需的具体迭代次数联系起来。",
            "id": "4231024",
            "problem": "考虑一个离散双模控制器的数字孪生，该控制器监控一个信息物理设备。该控制器-设备系统的状态由两个变量建模：一个模式位 $m \\in \\{0,1\\}$ 和一个整数设备状态 $x \\in \\{0,1,2,3,4,5\\}$。该控制器在两种模式下运行，具有以下动态特性，在有限状态空间 $\\{0,1\\} \\times \\{0,1,2,3,4,5\\}$ 上产生一个确定性的迁移系统：\n\n- 如果 $m=0$ 且 $x5$，则下一状态为 $(m',x')=(0,x+1)$。\n- 如果 $m=0$ 且 $x=5$，则下一状态为 $(m',x')=(1,5)$。\n- 如果 $m=1$ 且 $x0$，则下一状态为 $(m',x')=(1,x-1)$。\n- 如果 $m=1$ 且 $x=0$，则下一状态为 $(m',x')=(0,0)$。\n\n初始状态为 $(m,x)=(0,0)$。使用二元决策图（BDD）来符号化编码初始集和迁移关系的特征函数，该关系涉及当前状态变量 $(m,x)$ 和下一状态变量 $(m',x')$，并通过对当前状态变量进行存在量化来计算单步前向镜像。\n\n仅从有限状态模型检测中的符号可达性和格论不动点的基本原理出发，推导捕获给定迁移系统下所有从 $(0,0)$ 可达的状态的单调最小不动点。令迁移深度 $D$ 定义为从 $(0,0)$ 到迁移关系下任何可达状态的最长最短路径的长度。推导直到标准可达性迭代（从初始集开始，并重复与单步前向镜像取并集）检测到最小不动点所需的基于BDD的镜像迭代次数，并将最终答案表示为单个整数。答案无需四舍五入，也无需报告单位。",
            "solution": "问题要求计算一个标准的符号可达性算法在计算给定有限状态迁移系统的所有可达状态集时所需的迭代次数。该算法在检测到不动点时终止。\n\n令系统的状态空间为 $S = \\{0,1\\} \\times \\{0,1,2,3,4,5\\}$。状态是一个数对 $(m,x)$，其中 $m \\in \\{0,1\\}$ 是模式，$x \\in \\{0,1,2,3,4,5\\}$ 是设备状态。总状态数为 $2 \\times 6 = 12$。该系统是确定性的，其迁移关系 $T \\subseteq S \\times S$ 由所提供的四个规则定义。令 $(m', x')$ 为 $(m, x)$ 的唯一后继状态，记为 $(m,x) \\to (m',x')$。\n初始状态为 $(0,0)$。初始状态集为 $I = \\{(0,0)\\}$。\n\n所有可达状态的集合 $R_{all}$ 是算子 $F(Y) = I \\cup \\text{Image}(Y)$ 的最小不动点，其中 $Y \\subseteq S$ 且 $\\text{Image}(Y) = \\{s' \\in S \\mid \\exists s \\in Y, (s,s') \\in T\\}$。计算这个最小不动点的标准迭代算法从一个状态集开始，并重复地添加该集合的镜像。该过程定义如下：\n令 $S_0 = I$ 为 $0$ 次迭代后的状态集。\n对于 $k \\ge 1$，经过 $k$ 次迭代后的状态集由以下递推关系给出：\n$$S_k = S_{k-1} \\cup \\text{Image}(S_{k-1})$$\n当达到不动点时，即对于某个 $k$ 有 $S_k = S_{k-1}$ 时，算法终止。问题要求的是这个 $k$ 值，也就是检测到可达性集计算完成所需的迭代次数。\n\n让我们确定集合 $S_k$ 的含义。通过归纳法，$S_k$ 是从初始集 $I$ 出发，在至多 $k$ 步内可达的所有状态的集合。令 $\\text{dist}(s_0, s)$ 为从状态 $s_0$ 到状态 $s$ 的最短路径长度。那么，$S_k = \\{s \\in S \\mid \\text{dist}((0,0), s) \\le k\\}$。\n\n如果 $S_k = S_{k-1}$，则算法在第 $k$ 次迭代时终止。这等价于条件 $\\{s \\in S \\mid \\text{dist}((0,0), s) \\le k\\} = \\{s \\in S \\mid \\text{dist}((0,0), s) \\le k-1\\}$。这个等式成立当且仅当不存在任何状态 $s$ 满足 $\\text{dist}((0,0), s) = k$。这意味着所有可达状态在至多 $k-1$ 步内都是可达的。\n\n令 $D$ 为问题中定义的迁移深度：从初始状态 $(0,0)$ 到任何可达状态的最长最短路径的长度。\n$$D = \\max_{s \\in R_{all}} \\text{dist}((0,0), s)$$\n这意味着至少存在一个状态 $s_{max}$ 使得 $\\text{dist}((0,0), s_{max}) = D$，并且对于所有其他可达状态 $s'$，有 $\\text{dist}((0,0), s') \\le D$。\n根据我们对 $S_k$ 的定义，状态 $s_{max}$ 将首次出现在集合 $S_D$ 中，因为 $\\text{dist}((0,0), s_{max}) = D$。它不会在 $S_{D-1}$ 中。因此，$S_D \\neq S_{D-1}$，这意味着算法在第 $D$ 次迭代或之前不会终止。\n\n在第 $D$ 次迭代时，计算出的集合是 $S_D = \\{s \\in S \\mid \\text{dist}((0,0), s) \\le D\\}$。根据 $D$ 的定义，这个集合包含所有可达状态，所以 $S_D = R_{all}$。\n现在考虑下一次迭代，$k=D+1$：\n$$S_{D+1} = S_D \\cup \\text{Image}(S_D)$$\n由于 $S_D = R_{all}$ 是所有可达状态的集合，$\\text{Image}(S_D)$ 中的任何状态都是一个可达状态的后继状态，因此它本身也是一个可达状态。这意味着 $\\text{Image}(S_D) \\subseteq R_{all} = S_D$。\n因此，$S_{D+1} = S_D \\cup \\text{Image}(S_D) = S_D$。\n终止条件 $S_k = S_{k-1}$ 在 $k=D+1$ 时首次满足。因此，所需的迭代次数为 $D+1$。\n\n任务简化为求 $D$ 的值。我们必须从初始状态 $(0,0)$ 开始追踪路径，以确定到所有其他可达状态的最短路径距离。\n迁移规则是：\n1.  对于 $x \\in \\{0,1,2,3,4\\}$，$(0,x) \\to (0,x+1)$\n2.  $(0,5) \\to (1,5)$\n3.  对于 $x \\in \\{1,2,3,4,5\\}$，$(1,x) \\to (1,x-1)$\n4.  $(1,0) \\to (0,0)$\n\n让我们计算最短路径距离 $\\text{dist}((0,0), (m,x))$，从 $\\text{dist}((0,0),(0,0))=0$ 开始：\n- 从 $(0,0)$ 开始使用规则1的路径：\n$(0,0) \\to (0,1) \\to (0,2) \\to (0,3) \\to (0,4) \\to (0,5)$。\n这给出了距离：\n$\\text{dist}((0,0),(0,1)) = 1$\n$\\text{dist}((0,0),(0,2)) = 2$\n$\\text{dist}((0,0),(0,3)) = 3$\n$\\text{dist}((0,0),(0,4)) = 4$\n$\\text{dist}((0,0),(0,5)) = 5$\n\n- 从 $(0,5)$ 出发，下一个状态是 $(1,5)$（规则2）。距离是：\n$\\text{dist}((0,0),(1,5)) = \\text{dist}((0,0),(0,5)) + 1 = 5+1 = 6$。\n\n- 从 $(1,5)$ 出发，路径继续使用规则3：\n$(1,5) \\to (1,4) \\to (1,3) \\to (1,2) \\to (1,1) \\to (1,0)$。\n这给出了距离：\n$\\text{dist}((0,0),(1,4)) = \\text{dist}((0,0),(1,5)) + 1 = 6+1 = 7$\n$\\text{dist}((0,0),(1,3)) = \\text{dist}((0,0),(1,4)) + 1 = 7+1 = 8$\n$\\text{dist}((0,0),(1,2)) = \\text{dist}((0,0),(1,3)) + 1 = 8+1 = 9$\n$\\text{dist}((0,0),(1,1)) = \\text{dist}((0,0),(1,2)) + 1 = 9+1 = 10$\n$\\text{dist}((0,0),(1,0)) = \\text{dist}((0,0),(1,1)) + 1 = 10+1 = 11$\n\n- 从 $(1,0)$ 出发，下一个状态是 $(0,0)$（规则4），这形成了一个闭环。迁移图由一个长度为 $12$ 的单一环路组成，该环路包含了 $S$ 中的所有状态。\n\n从 $(0,0)$ 到所有可达状态（即整个状态空间 $S$）的最短路径距离集合是 $\\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11\\}$。\n该集合中的最大值即为迁移深度 $D$：\n$$D = \\max\\{0, 1, \\dots, 11\\} = 11$$\n距离初始状态最远的状态是 $(1,0)$，其最短路径距离为 $11$。\n\n检测到不动点所需的迭代次数为 $D+1$。\n迭代次数 = $11+1 = 12$。\n\n在第 11 次迭代时，将计算出集合 $S_{11}$，该集合首次包含所有 12 个状态。检查 $S_{11} \\stackrel{?}{=} S_{10}$ 会失败，因为状态 $(1,0)$ 是新加入的。\n在第 12 次迭代时，集合 $S_{12}$ 计算为 $S_{11} \\cup \\text{Image}(S_{11})$。由于 $S_{11}$ 是所有可达状态的全集，$\\text{Image}(S_{11}) \\subseteq S_{11}$，因此 $S_{12} = S_{11}$。检查 $S_{12} \\stackrel{?}{=} S_{11}$ 成功，算法终止。执行的总迭代次数为 $12$。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "在掌握确定性可达性分析的基础上，我们引入概率来处理不确定性。许多现实世界的系统表现出随机行为，我们通常需要回答“发生故障的概率是多少？”而不是仅仅“故障是否可能发生？”。本练习将引导您推导概率可达性分析的数学基础，并将其应用于一个具体的系统，从而巩固定量验证的原理。",
            "id": "4231030",
            "problem": "考虑一个离散时间马尔可夫链 (DTMC)，该模型为一个信息物理系统 (CPS) 中安全控制器的数字孪生的离散事件抽象，其具有有限状态空间 $S$，一个行随机的转移概率矩阵 $P$，以及一个指定的目标状态集 $T \\subseteq S$ 代表安全停机状态。令 $F$ 表示时序算子“最终”，并将可达性概率 $P(s \\models F\\,T)$ 定义为从状态 $s \\in S$ 开始，该 DTMC 在某个有限时间内访问到 $T$ 中任意状态的概率。仅使用 Kolmogorov 概率公理、马尔可夫性质和 Chapman–Kolmogorov 方程，推导函数 $x : S \\to [0,1]$（其中 $x(s) = P(s \\models F\\,T)$）所满足的线性方程组。\n\n证明对于有限 DTMC 上的可达性概率，标准值迭代序列 $(v^{(k)})_{k \\in \\mathbb{N}}$ 逐点收敛于 $x$。该序列定义为：当 $s \\in T$ 时 $v^{(0)}(s) = 1$，当 $s \\notin T$ 时 $v^{(0)}(s) = 0$；对于 $k \\geq 0$，\n$$\nv^{(k+1)}(s) =\n\\begin{cases}\n1,  s \\in T, \\\\\n\\sum\\limits_{s' \\in S} P(s,s')\\,v^{(k)}(s'),  s \\notin T.\n\\end{cases}\n$$\n\n然后，将推导出的方程应用于一个特定的 DTMC，其状态空间为 $S = \\{s_0,s_1,s_2,s_3,s_4\\}$，目标集为 $T = \\{s_3\\}$，转移概率矩阵 $P$ 如下（行序为 $s_0,s_1,s_2,s_3,s_4$；列序也为 $s_0,s_1,s_2,s_3,s_4$）：\n$$\nP =\n\\begin{pmatrix}\n0   0.6   0.4   0   0 \\\\\n0.3   0   0   0.5   0.2 \\\\\n0   0   0.2   0.4   0.4 \\\\\n0   0   0   1   0 \\\\\n0   0   0   0   1\n\\end{pmatrix}.\n$$\n计算 $P(s_0 \\models F\\,T)$ 的值，并将最终数值答案表示为一个实数。将答案四舍五入到六位有效数字。无需单位。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于马尔可夫链理论，是良定的、客观的且内部一致的。我们按要求分三部分进行解答。\n\n### 第1部分：线性方程组的推导\n\n设给定的离散时间马尔可夫链 (DTMC) 具有有限状态空间 $S$、转移概率矩阵 $P$ 和目标状态集 $T \\subseteq S$。我们需要推导可达性概率函数 $x: S \\to [0,1]$ 的线性方程组，其中 $x(s) = P(s \\models F\\,T)$ 是从状态 $s$ 开始的路径最终访问到 $T$ 中某个状态的概率。\n\n令 $\\omega = (\\omega_0, \\omega_1, \\omega_2, \\dots)$ 为 DTMC 中的一条路径（一个状态序列）。事件“$s \\models F\\,T$”对应于所有以 $\\omega_0=s$ 开始，且存在有限时间步 $k \\ge 0$ 使得 $\\omega_k \\in T$ 的路径集合。\n\n我们通过对状态 $s$ 进行条件分析来确定 $x(s)$：\n\n情况1：$s \\in T$。\n如果起始状态 $s$ 已经在目标集 $T$ 中，则在时间 $k=0$ 时满足到达 $T$ 的条件。因此，该事件的概率为 $1$。\n$$x(s) = 1, \\quad \\text{对于 } s \\in T$$\n\n情况2：$s \\notin T$。\n如果起始状态 $s$ 不在 $T$ 中，路径必须至少走一步。我们可以通过对第一步的结果 $\\omega_1$ 进行条件分析来应用全概率公式。令 $s'$ 为一步之后的状态，即 $\\omega_1=s'$。\n$$x(s) = P(\\text{最终到达 } T \\mid \\omega_0=s)$$\n根据全概率公式：\n$$x(s) = \\sum_{s' \\in S} P(\\text{最终到达 } T \\mid \\omega_1=s', \\omega_0=s) \\cdot P(\\omega_1=s' \\mid \\omega_0=s)$$\n$P(\\omega_1=s' \\mid \\omega_0=s)$ 这一项是从 $s$ 到 $s'$ 的转移概率，记为 $P(s,s')$。\n$P(\\text{最终到达 } T \\mid \\omega_1=s', \\omega_0=s)$ 这一项是在路径从 $s$ 开始并在第一步转移到 $s'$ 的条件下最终到达 $T$ 的概率。根据马尔可夫性质，从状态 $s'$ 开始的未来演化过程独立于其过去（即如何到达 $s'$）。因此，这个条件概率就是从状态 $s'$ 开始最终到达 $T$ 的概率。\n$$P(\\text{最终到达 } T \\mid \\omega_1=s', \\omega_0=s) = P(\\text{最终到达 } T \\mid \\omega_0=s') = x(s')$$\n将这些代入 $x(s)$ 的方程中：\n$$x(s) = \\sum_{s' \\in S} P(s,s') x(s'), \\quad \\text{对于 } s \\notin T$$\n\n综合两种情况，可达性概率 $\\{x(s)\\}_{s \\in S}$ 满足以下线性方程组：\n$$\nx(s) =\n\\begin{cases}\n1,  \\text{如果 } s \\in T, \\\\\n\\sum\\limits_{s' \\in S} P(s,s')\\,x(s'),  \\text{如果 } s \\notin T.\n\\end{cases}\n$$\n对于最小非负概率，该系统有唯一解，这些解即为可达性概率。\n\n### 第2部分：值迭代收敛性证明\n\n我们需要证明序列 $(v^{(k)})_{k \\in \\mathbb{N}}$ 逐点收敛于 $x(s) = P(s \\models F\\,T)$。该序列由 $v^{(0)}(s) = \\mathbf{1}_{T}(s)$（集合 $T$ 的指示函数）和以下递推关系定义：\n$$\nv^{(k+1)}(s) =\n\\begin{cases}\n1,  s \\in T, \\\\\n\\sum\\limits_{s' \\in S} P(s,s')\\,v^{(k)}(s'),  s \\notin T,\n\\end{cases}\n$$\n\n让我们确定 $v^{(k)}(s)$ 的概率意义。我们断言，$v^{(k)}(s)$ 是从状态 $s$ 开始，在最多 $k$ 步内到达 $T$ 中某个状态的概率。我们通过对 $k$ 进行数学归纳来证明这一点。\n\n归纳基础 ($k=0$)：\n$v^{(0)}(s)$ 定义为：如果 $s \\in T$ 则为 $1$，如果 $s \\notin T$ 则为 $0$。这恰好是在 $0$ 步内到达 $T$ 的概率（即从 $T$ 中开始）。该断言对 $k=0$ 成立。\n\n归纳步骤：\n假设对于某个 $k \\ge 0$，$v^{(k)}(s)$ 是对所有 $s \\in S$ 在最多 $k$ 步内到达 $T$ 的概率。我们来计算在最多 $k+1$ 步内到达 $T$ 的概率。\n如果 $s \\in T$，在最多 $k+1$ 步内到达 $T$ 的概率是 $1$。递推关系给出对于 $s \\in T$ 有 $v^{(k+1)}(s) = 1$，这与之一致。\n如果 $s \\notin T$，要在最多 $k+1$ 步内到达 $T$，过程必须在第一步转移到某个状态 $s' \\in S$，然后从 $s'$ 开始在剩下的 $k$ 步内到达 $T$。根据全概率公式和马尔可夫性质：\n$$P(\\text{在 } \\le k+1 \\text{ 步内到达 } T \\mid \\omega_0=s) = \\sum_{s' \\in S} P(\\omega_1=s' \\mid \\omega_0=s) \\cdot P(\\text{在 } \\le k \\text{ 步内到达 } T \\mid \\omega_0=s')$$\n使用归纳假设，$P(\\text{在 } \\le k \\text{ 步内到达 } T \\mid \\omega_0=s') = v^{(k)}(s')$。\n因此，对于 $s \\notin T$：\n$$P(\\text{在 } \\le k+1 \\text{ 步内到达 } T \\mid \\omega_0=s) = \\sum_{s' \\in S} P(s,s') v^{(k)}(s')$$\n这与 $v^{(k+1)}(s)$ 的递推关系相符。归纳完毕。\n\n现在，令 $E_k$ 为从 $s$ 开始的路径在最多 $k$ 步内到达 $T$ 的事件。根据我们的证明，$P(E_k) = v^{(k)}(s)$。\n事件序列 $(E_k)_{k \\in \\mathbb{N}}$ 是不减的，即对于所有 $k \\ge 0$ 都有 $E_k \\subseteq E_{k+1}$，因为如果一条路径在 $k$ 步内到达 $T$，它当然也在 $k+1$ 步内到达 $T$。\n从 $s$ 开始的路径最终到达 $T$ 的事件（我们可以记为 $E$）是所有 $E_k$ 的并集：\n$$E = \\bigcup_{k=0}^{\\infty} E_k$$\n根据概率测度的连续性（Kolmogorov 公理的一个推论），对于一个不减的事件序列，其并集的概率是概率的极限：\n$$P(E) = P\\left(\\bigcup_{k=0}^{\\infty} E_k\\right) = \\lim_{k \\to \\infty} P(E_k)$$\n根据定义，$x(s) = P(E)$，并且我们已经证明了 $v^{(k)}(s) = P(E_k)$。因此：\n$$x(s) = \\lim_{k \\to \\infty} v^{(k)}(s)$$\n这证明了值迭代序列对所有 $s \\in S$ 都逐点收敛于可达性概率 $x(s)$。\n\n### 第3部分：应用于特定DTMC\n\n给定 $S = \\{s_0, s_1, s_2, s_3, s_4\\}$，$T = \\{s_3\\}$，以及转移矩阵\n$$\nP =\n\\begin{pmatrix}\n0   0.6   0.4   0   0 \\\\\n0.3   0   0   0.5   0.2 \\\\\n0   0   0.2   0.4   0.4 \\\\\n0   0   0   1   0 \\\\\n0   0   0   0   1\n\\end{pmatrix}.\n$$\n我们要计算 $x_0 = P(s_0 \\models F\\,\\{s_3\\})$。令 $x_i = x(s_i)$。从第1部分，我们得到方程组。\n\n对于 $s_3 \\in T$：\n$x_3 = 1$\n\n注意到 $s_4$ 是一个吸收态，因为 $P(s_4, s_4)=1$。由于 $s_4 \\notin T$，任何到达 $s_4$ 的路径都将被困在那里，永远不会到达 $T$。因此，从 $s_4$ 到达 $T$ 的概率为 $0$。\n$x_4 = 0$。\n这也可以通过值迭代正式推导：$v^{(0)}(s_4)=0$，且 $v^{(k+1)}(s_4) = P(s_4, s_4)v^{(k)}(s_4) = 1 \\cdot v^{(k)}(s_4)$，所以通过归纳法可知对所有 $k$ 都有 $v^{(k)}(s_4)=0$，其极限为 $x_4=0$。\n\n对于剩下的状态 $s_0, s_1, s_2 \\notin T$，我们有：\n$x_0 = P(s_0,s_0)x_0 + P(s_0,s_1)x_1 + P(s_0,s_2)x_2 + P(s_0,s_3)x_3 + P(s_0,s_4)x_4$\n$x_0 = 0 \\cdot x_0 + 0.6 \\cdot x_1 + 0.4 \\cdot x_2 + 0 \\cdot x_3 + 0 \\cdot x_4 \\implies x_0 = 0.6 x_1 + 0.4 x_2$\n\n$x_1 = P(s_1,s_0)x_0 + P(s_1,s_1)x_1 + P(s_1,s_2)x_2 + P(s_1,s_3)x_3 + P(s_1,s_4)x_4$\n$x_1 = 0.3 \\cdot x_0 + 0 \\cdot x_1 + 0 \\cdot x_2 + 0.5 \\cdot x_3 + 0.2 \\cdot x_4 \\implies x_1 = 0.3 x_0 + 0.5 x_3 + 0.2 x_4$\n\n$x_2 = P(s_2,s_0)x_0 + P(s_2,s_1)x_1 + P(s_2,s_2)x_2 + P(s_2,s_3)x_3 + P(s_2,s_4)x_4$\n$x_2 = 0 \\cdot x_0 + 0 \\cdot x_1 + 0.2 \\cdot x_2 + 0.4 \\cdot x_3 + 0.4 \\cdot x_4 \\implies x_2 = 0.2 x_2 + 0.4 x_3 + 0.4 x_4$\n\n现在我们将已知值 $x_3=1$ 和 $x_4=0$ 代入这个方程组。\n$x_2$ 的方程变为：\n$x_2 = 0.2 x_2 + 0.4(1) + 0.4(0)$\n$x_2 - 0.2 x_2 = 0.4$\n$0.8 x_2 = 0.4$\n$x_2 = \\frac{0.4}{0.8} = 0.5$\n\n$x_1$ 的方程变为：\n$x_1 = 0.3 x_0 + 0.5(1) + 0.2(0)$\n$x_1 = 0.3 x_0 + 0.5$\n\n最后，将 $x_1$ 和 $x_2$ 的表达式代入 $x_0$ 的方程中：\n$x_0 = 0.6 x_1 + 0.4 x_2$\n$x_0 = 0.6 (0.3 x_0 + 0.5) + 0.4 (0.5)$\n$x_0 = 0.18 x_0 + 0.3 + 0.2$\n$x_0 = 0.18 x_0 + 0.5$\n$x_0 - 0.18 x_0 = 0.5$\n$0.82 x_0 = 0.5$\n$x_0 = \\frac{0.5}{0.82} = \\frac{50}{82} = \\frac{25}{41}$\n\n为了提供数值答案，我们计算该值并四舍五入到六位有效数字：\n$x_0 = \\frac{25}{41} \\approx 0.60975609756...$\n四舍五入到六位有效数字得到 $0.609756$。",
            "answer": "$$\n\\boxed{0.609756}\n$$"
        },
        {
            "introduction": "验证具有连续或无限状态空间的系统是信息物理系统领域的一大挑战。由于无法直接枚举所有状态，我们转而采用超近似方法。本练习介绍了一种强大的工具——带状多胞体（zonotope），用于可靠地包络所有可能的系统行为，并引导您完成一个带有不确定性的线性系统的完整安全性验证流程。",
            "id": "4231096",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 监控一个二维状态 $x \\in \\mathbb{R}^{2}$，该状态具有离散时间线性时不变 (LTI) 动态\n$$x_{k+1} = A x_{k} + w_{k},$$\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 且外源扰动 $w_{k}$ 位于有界凸不确定性集 $W \\subset \\mathbb{R}^{2}$ 中。该 DT 使用基于凸集的过近似可达性进行模型检验，以验证在一个给定的时间范围内，聚合量 $n^{\\top} x$ 保持在阈值 $h$ 以下的安全属性。安全规范是半空间 $\\{x \\in \\mathbb{R}^{2} \\mid n^{\\top} x \\leq h\\}$。\n\n考虑以下科学上现实的参数化：\n- 系统矩阵为 $A = \\mathrm{diag}(0.9, 0.8)$。\n- 初始状态集 $X_{0}$ 是一个中心-生成元形式为 $Z(c_{0}, G_{0})$ 的带状多胞体，其中心为 $c_{0} = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}$，生成矩阵为 $G_{0} = \\begin{pmatrix} 0.1  0 \\\\ 0  0.05 \\end{pmatrix}$，即 $X_{0} = \\{c_{0} + G_{0} \\xi \\mid \\xi \\in [-1,1]^{2}\\}$。\n- 扰动集 $W$ 是一个带状多胞体 $Z(0, G_{w})$，其生成矩阵为 $G_{w} = \\begin{pmatrix} 0.01  0 \\\\ 0  0.02 \\end{pmatrix}$，即 $W = \\{G_{w} \\eta \\mid \\eta \\in [-1,1]^{2}\\}$ 且中心为零。\n- 安全半空间由 $n = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和阈值 $h = 1.2$ 定义。\n\n仅使用凸分析和线性系统的基本定义，执行以下操作：\n1. 从给定动态下的可达集定义以及闵可夫斯基和与集合线性映像的定义出发，构造在时间范围 $N = 3$ 时的过近似可达集，该可达集为一个带状多胞体 $Z(c, G)$，包含所有从 $X_{0}$ 出发、在 $W$ 中的扰动下可达的真实状态 $x_{3}$。用 $A$, $c_{0}$, $G_{0}$, 和 $G_{w}$ 表示 $c$ 和 $G$ 的列。\n2. 对于一个凸集 $C$，使用支持函数 $h_{C}(n) = \\sup_{x \\in C} n^{\\top} x$ 的定义，纯粹根据闵可夫斯基和与线性映射的性质，推导出一个中心-生成元形式的带状多胞体的 $h_{Z(c,G)}(n)$ 的表达式。然后，使用所提供的 $n$，为构造出的 $Z(c,G)$ 计算 $h_{Z(c,G)}(n)$ 的数值。\n3. 从第一性原理出发，论证为何使用过近似可达带状多胞体 $Z(c,G)$ 对半空间 $n^{\\top} x \\leq h$ 进行安全检查是可靠的。最后，通过计算在 $N = 3$ 时的安全裕度 $m = h - h_{Z(c,G)}(n)$ 来得出结论。\n\n将最终答案表示为单个实数 $m$。无需四舍五入。",
            "solution": "该问题被验证为具有科学依据、适定、客观和完整。所有必要的数据和定义都已提供，以得出一个唯一且有意义的解。该问题的背景在控制系统的可达性分析中是标准的。\n\n解答过程按要求分为三部分。\n\n### 第1部分：过近似可达集的构造\n\n系统在时间步 $k+1$ 的状态由离散时间 LTI 动态 $x_{k+1} = A x_{k} + w_{k}$ 给出。初始状态 $x_{0}$ 位于集合 $X_{0}$ 中，每个扰动 $w_{k}$ 位于集合 $W$ 中。在未来时间 $N$ 的真实可达状态集，记为 $\\mathcal{R}_{N}$，是从任何初始状态 $x_{0} \\in X_{0}$ 出发，在任何有效扰动序列 $w_{0}, w_{1}, \\ldots, w_{N-1} \\in W$ 下可以到达的所有可能状态 $x_{N}$ 的集合。\n\n展开 $N=3$ 时的动态过程：\n$$x_{1} = A x_{0} + w_{0}$$\n$$x_{2} = A x_{1} + w_{1} = A (A x_{0} + w_{0}) + w_{1} = A^{2} x_{0} + A w_{0} + w_{1}$$\n$$x_{3} = A x_{2} + w_{2} = A (A^{2} x_{0} + A w_{0} + w_{1}) + w_{2} = A^{3} x_{0} + A^{2} w_{0} + A w_{1} + w_{2}$$\n在 $N=3$ 时的真实可达集 $\\mathcal{R}_{3}$ 是所有这类点 $x_{3}$ 的集合：\n$$\\mathcal{R}_{3} = \\{ A^{3} x_{0} + A^{2} w_{0} + A w_{1} + w_{2} \\mid x_{0} \\in X_{0}, w_{0} \\in W, w_{1} \\in W, w_{2} \\in W \\}$$\n这可以用集合的线性映像 $L(C) = \\{Lx \\mid x \\in C\\}$ 和集合的闵可夫斯基和 $C_{1} \\oplus C_{2} = \\{c_{1} + c_{2} \\mid c_{1} \\in C_{1}, c_{2} \\in C_{2}\\}$ 的基本定义来表示。\n$$\\mathcal{R}_{3} = A^{3}(X_{0}) \\oplus A^{2}(W) \\oplus A(W) \\oplus W$$\n为了计算该集合的过近似，我们使用带状多胞体，因为它们在线性映射和闵可夫斯基和运算下是封闭的。带状多胞体以中心-生成元形式定义为 $Z(c, G) = \\{c + G\\xi \\mid \\xi \\in [-1,1]^{p}\\}$，其中 $p$ 是生成元（$G$ 的列）的数量。\n\n关键性质如下：\n1.  线性映像：$L(Z(c, G)) = Z(Lc, LG)$。\n2.  闵可夫斯基和：$Z(c_{1}, G_{1}) \\oplus Z(c_{2}, G_{2}) = Z(c_{1} + c_{2}, [G_{1} \\ G_{2}])$，其中 $[G_{1} \\ G_{2}]$ 是由生成矩阵水平拼接而成的矩阵。\n\n初始集为 $X_{0} = Z(c_{0}, G_{0})$，扰动集为 $W = Z(0, G_{w})$。我们计算 $\\mathcal{R}_{3}$ 的带状多胞体过近似 $X_{3}$：\n$$X_{3} = A^{3}(Z(c_{0}, G_{0})) \\oplus A^{2}(Z(0, G_{w})) \\oplus A(Z(0, G_{w})) \\oplus Z(0, G_{w})$$\n$$X_{3} = Z(A^{3}c_{0}, A^{3}G_{0}) \\oplus Z(A^{2}0, A^{2}G_{w}) \\oplus Z(A0, AG_{w}) \\oplus Z(0, G_{w})$$\n$$X_{3} = Z(A^{3}c_{0}, A^{3}G_{0}) \\oplus Z(0, A^{2}G_{w}) \\oplus Z(0, AG_{w}) \\oplus Z(0, G_{w})$$\n将这些带状多胞体相加，得到最终的带状多胞体 $X_{3} = Z(c, G)$，其中中心 $c$ 是各个中心的和，生成矩阵 $G$ 是各个生成矩阵的拼接。\n$$c = A^{3}c_{0} + 0 + 0 + 0 = A^{3}c_{0}$$\n$$G = [A^{3}G_{0} \\ A^{2}G_{w} \\ AG_{w} \\ G_{w}]$$\n这就给出了在时间范围 $N=3$ 时过近似可达集 $Z(c, G)$ 的中心和生成元的解析表达式。\n\n### 第2部分：支持函数的推导与计算\n\n对于给定的方向向量 $n$，凸集 $C$ 的支持函数定义为 $h_{C}(n) = \\sup_{x \\in C} n^{\\top} x$。对于一个带状多胞体 $Z(c, G) = \\{ c + G\\xi \\mid \\xi \\in [-1,1]^{p} \\}$，任何点 $x$ 都可以写成 $x = c + \\sum_{i=1}^{p} g_{i} \\xi_{i}$，其中 $g_{i}$ 是 $G$ 的列，且 $\\xi_{i} \\in [-1,1]$。\n\n支持函数由此定义推导得出：\n$$h_{Z(c,G)}(n) = \\sup_{\\xi \\in [-1,1]^{p}} n^{\\top} \\left( c + \\sum_{i=1}^{p} g_{i} \\xi_{i} \\right)$$\n$$h_{Z(c,G)}(n) = \\sup_{\\xi \\in [-1,1]^{p}} \\left( n^{\\top}c + \\sum_{i=1}^{p} (n^{\\top}g_{i})\\xi_{i} \\right)$$\n利用上确界的线性性质，我们分离出常数项：\n$$h_{Z(c,G)}(n) = n^{\\top}c + \\sup_{\\xi \\in [-1,1]^{p}} \\sum_{i=1}^{p} (n^{\\top}g_{i})\\xi_{i}$$\n和的上确界等于上确界的和，因为每一项 $(n^{\\top}g_{i})\\xi_{i}$ 都是独立的。为了最大化每一项，我们必须选择 $\\xi_{i} = \\mathrm{sgn}(n^{\\top}g_{i})$。这得出：\n$$\\sup_{\\xi_{i} \\in [-1,1]} (n^{\\top}g_{i})\\xi_{i} = |n^{\\top}g_{i}|$$\n因此，带状多胞体的支持函数为：\n$$h_{Z(c,G)}(n) = n^{\\top}c + \\sum_{i=1}^{p} |n^{\\top}g_{i}|$$\n这个和可以用 $L_{1}$-范数紧凑地写成 $n^{\\top}c + \\|G^{\\top}n\\|_{1}$。\n\n现在我们计算当 $N=3$ 时带状多胞体 $X_{3} = Z(c,G)$ 的数值。\n给定的参数是：\n$$A = \\begin{pmatrix} 0.9   0 \\\\ 0   0.8 \\end{pmatrix}, \\ c_{0} = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}, \\ G_{0} = \\begin{pmatrix} 0.1   0 \\\\ 0   0.05 \\end{pmatrix}, \\ G_{w} = \\begin{pmatrix} 0.01   0 \\\\ 0   0.02 \\end{pmatrix}, \\ n = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n首先，我们计算 $A$ 的幂：\n$$A^{2} = \\begin{pmatrix} 0.9^{2}   0 \\\\ 0   0.8^{2} \\end{pmatrix} = \\begin{pmatrix} 0.81   0 \\\\ 0   0.64 \\end{pmatrix}, \\ A^{3} = \\begin{pmatrix} 0.9^{3}   0 \\\\ 0   0.8^{3} \\end{pmatrix} = \\begin{pmatrix} 0.729   0 \\\\ 0   0.512 \\end{pmatrix}$$\n$X_{3}$ 的中心是：\n$$c = A^{3}c_{0} = \\begin{pmatrix} 0.729   0 \\\\ 0   0.512 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix} = \\begin{pmatrix} 0.729 \\\\ 0.256 \\end{pmatrix}$$\n支持函数的首项是 $n^{\\top}c$：\n$$n^{\\top}c = \\begin{pmatrix} 1   1 \\end{pmatrix} \\begin{pmatrix} 0.729 \\\\ 0.256 \\end{pmatrix} = 0.729 + 0.256 = 0.985$$\n生成矩阵是：\n$$A^{3}G_{0} = \\begin{pmatrix} 0.0729   0 \\\\ 0   0.0256 \\end{pmatrix}$$\n$$A^{2}G_{w} = \\begin{pmatrix} 0.0081   0 \\\\ 0   0.0128 \\end{pmatrix}$$\n$$AG_{w} = \\begin{pmatrix} 0.009   0 \\\\ 0   0.016 \\end{pmatrix}$$\n$$G_{w} = \\begin{pmatrix} 0.01   0 \\\\ 0   0.02 \\end{pmatrix}$$\n完整的生成矩阵是 $G = [A^{3}G_{0}, A^{2}G_{w}, AG_{w}, G_{w}]$，它有 8 列（生成元）。\n项 $\\sum |n^{\\top}g_{i}|$ 是所有生成元 $g_{i}$ 的 $n^{\\top}g_{i}$ 的绝对值之和。由于 $n$ 和所有生成元的分量都是非负的，所以对于所有的 $i$ 都有 $n^{\\top}g_{i} \\geq 0$。因此，绝对值可以去掉，总和为 $\\sum n^{\\top}g_{i}$。这等同于对行向量 $n^{\\top}G$ 的所有元素求和。由于 $n=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，这又恰好等于矩阵 $G$ 所有元素的和。\n第一个分量的元素之和：$0.0729+0+0.0081+0+0.009+0+0.01+0 = 0.1$\n第二个分量的元素之和：$0+0.0256+0+0.0128+0+0.016+0+0.02 = 0.0744$\n总和 $\\sum |n^{\\top}g_{i}| = 0.1 + 0.0744 = 0.1744$。\n支持函数值为：\n$$h_{X_{3}}(n) = n^{\\top}c + \\sum |n^{\\top}g_{i}| = 0.985 + 0.1744 = 1.1594$$\n\n### 第3部分：论证与安全裕度计算\n\n安全属性要求所有可达状态 $x_{3} \\in \\mathcal{R}_{3}$ 满足条件 $n^{\\top}x_{3} \\leq h$。这等同于验证在整个集合 $\\mathcal{R}_{3}$ 上 $n^{\\top}x_{3}$ 的最大值不超过 $h$。用支持函数表示，这个条件是 $h_{\\mathcal{R}_{3}}(n) \\leq h$。\n\n可达性分析产生了一个过近似集 $X_{3}$，使得 $\\mathcal{R}_{3} \\subseteq X_{3}$。上确界算子的一个基本性质是，如果一个集合 $C_{1}$ 是另一个集合 $C_{2}$ 的子集，那么对于任何函数 $f$，都有 $\\sup_{x \\in C_{1}} f(x) \\leq \\sup_{x \\in C_{2}} f(x)$。将此应用于支持函数，我们得到：\n$$h_{\\mathcal{R}_{3}}(n) \\leq h_{X_{3}}(n)$$\n因此，如果我们在过近似集上验证安全属性，即如果我们证明 $h_{X_{3}}(n) \\leq h$，这就直接意味着 $h_{\\mathcal{R}_{3}}(n) \\leq h$。这保证了真实系统是安全的。这表明使用过近似可达集进行安全验证是一种可靠（即保守）的方法。\n\n在 $N=3$ 时的安全裕度定义为 $m = h - h_{X_{3}}(n)$。给定阈值 $h=1.2$ 和计算出的支持函数值 $h_{X_{3}}(n) = 1.1594$，裕度为：\n$$m = 1.2 - 1.1594 = 0.0406$$\n由于 $m  0$，因此在时间范围 $N=3$ 内，安全属性得到验证。",
            "answer": "$$\\boxed{0.0406}$$"
        }
    ]
}