{
    "hands_on_practices": [
        {
            "introduction": "A primary defense against replay attacks is the use of strictly increasing sequence numbers, a method at the core of protocols like IPsec. However, real-world networks are not perfect; they reorder packets, creating a conflict between security (rejecting old packets) and availability (accepting legitimate but delayed packets). This exercise  challenges you to determine the minimal anti-replay window size required to tolerate a specified degree of packet reordering, a fundamental task in designing robust and secure communication protocols for cyber-physical systems.",
            "id": "4240557",
            "problem": "A cyber-physical system links a physical plant to its Digital Twin via Internet Protocol Security (IPsec) Encapsulating Security Payload (ESP). The sender in ESP assigns strictly increasing sequence numbers $s \\in \\mathbb{N}$ to each packet. The receiver implements an anti-replay mechanism based on a sliding window of size $W \\in \\mathbb{N}$ anchored at the highest sequence number $H$ observed so far. The receiver enforces the following rules, which define the anti-replay behavior:\n\n- If a packet with sequence number $s$ arrives such that $s > H$, the receiver accepts it and advances the window anchor to $H \\leftarrow s$.\n- If $H - W  s \\leq H$, the receiver accepts it if and only if $s$ has not been seen before within the current window.\n- If $s \\leq H - W$, the receiver rejects it as an out-of-window replay.\n\nAssume the network can reorder packets such that, in the worst case, a packet sent $k$ positions earlier than another arrives later, i.e., the maximum out-of-order depth is $k \\in \\mathbb{N}$. In other words, a packet with sequence number $H - k$ may arrive after one or more packets up to sequence number $H$ have already been accepted.\n\nStarting only from the rules above and the definitions of sequence numbers and sliding windows, derive an expression for the minimal window size $W$ that guarantees acceptance of any legitimate packet subject to reordering up to depth $k$, while avoiding acceptance of out-of-window replays as defined by the rules. Your final answer must be a single closed-form analytic expression in terms of $k$. No numerical approximation is required, and no units are involved.\n\nAdditionally, in your derivation, explain the security-performance trade-offs of choosing $W$ larger or smaller in the context of Digital Twins and Cyber-Physical Systems, but ensure the final computed result is the analytical expression for the minimal $W$ in terms of $k$ alone.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The system involves a physical plant and its Digital Twin communicating via IPsec ESP.\n- Packets are assigned strictly increasing sequence numbers, $s \\in \\mathbb{N}$.\n- The receiver uses an anti-replay sliding window of size $W \\in \\mathbb{N}$.\n- $H$ is the highest sequence number observed by the receiver so far.\n- The anti-replay rules are:\n    1. If a packet with sequence number $s$ arrives such that $s > H$, it is accepted, and the window anchor is updated: $H \\leftarrow s$.\n    2. If $H - W  s \\leq H$, the packet is accepted if and only if $s$ has not been seen before.\n    3. If $s \\leq H - W$, the packet is rejected.\n- The network can reorder packets with a maximum out-of-order depth of $k \\in \\mathbb{N}$. This is defined as a packet sent $k$ positions earlier than another may arrive later.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes the standard anti-replay window mechanism specified in IPsec (RFC 4303). The concepts of sequence numbers, sliding windows, and out-of-order packet arrival are fundamental in network protocol engineering. The scenario is realistic and scientifically sound.\n- **Well-Posed:** The problem is self-contained. All necessary rules and definitions ($s, H, W, k$) are provided to derive the minimal window size. The objective to find a minimal $W$ is a clear and solvable optimization problem based on the given constraints.\n- **Objective:** The problem is stated using formal, precise language. The rules are given as mathematical inequalities and logical conditions, leaving no room for subjective interpretation.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid. It is scientifically sound, well-posed, and objective.\n- **Action:** Proceed with the derivation of the solution.\n\n**Derivation of the Solution**\n\nThe objective is to find the minimal window size $W$ that guarantees the acceptance of any legitimate packet, given that the network can reorder packets up to a maximum depth of $k$. A legitimate packet should never be rejected under Rule 3.\n\nLet's analyze the condition for packet rejection: a packet with sequence number $s$ is rejected if $s \\leq H - W$. To guarantee acceptance, we must ensure that for any legitimate packet, its sequence number $s$ satisfies the condition $s > H - W$.\n\nTo determine the minimal required $W$, we must consider the worst-case scenario for a legitimate packet. The worst case for a packet is that it experiences the maximum possible delay relative to subsequent packets. Let's denote the sequence number of this delayed packet as $s_{legit}$.\n\nThe problem defines the maximum out-of-order depth $k$ as the ability for a packet sent $k$ positions earlier to arrive later. This means a packet with sequence number $s_{legit}$ can arrive at the receiver *after* a packet with sequence number $s_{legit} + k$. The arrival of any packet with a sequence number greater than $s_{legit} + k$ after $s_{legit}$ is not the worst case for $s_{legit}$, because the arrival of $s_{legit}$ would have already been evaluated against a window anchored at a smaller $H$. The worst case happens when $H$ is maximized just before the arrival of $s_{legit}$.\n\nLet's construct this worst-case scenario:\n1. A sequence of packets is sent in the order $..., s_{legit}, s_{legit}+1, ..., s_{legit}+k, ...$.\n2. Due to maximum network reordering, the packet with sequence number $s_{legit}+k$ arrives at the receiver first (among this block of packets).\n3. At the moment this packet arrives, let's assume the previous highest sequence number was less than $s_{legit}+k$. According to Rule 1, the receiver accepts the packet $s_{legit}+k$ and updates its state by setting the anchor of the sliding window to $H \\leftarrow s_{legit}+k$.\n4. Now, the receiver's window of acceptable, potentially delayed packets is the interval $(H - W, H]$, which is $(s_{legit} + k - W, s_{legit} + k]$. The rejection region is for any sequence number $s$ such that $s \\leq H - W$.\n5. Subsequently, the delayed legitimate packet with sequence number $s_{legit}$ arrives.\n6. For this packet to not be immediately rejected by Rule 3, its sequence number $s_{legit}$ must not fall into the rejection region. The condition for non-rejection is:\n$$s_{legit} > H - W$$\n7. Substituting the value of $H$ from our worst-case scenario ($H = s_{legit} + k$), we get:\n$$s_{legit} > (s_{legit} + k) - W$$\n8. We can now solve this inequality for $W$:\n$$s_{legit} > s_{legit} + k - W$$\n$$0 > k - W$$\n$$W > k$$\nSince $W$ and $k$ are defined as natural numbers ($W, k \\in \\mathbb{N}$, i.e., positive integers), the minimal integer value for $W$ that satisfies the inequality $W > k$ is $W = k + 1$.\n\nIf $W = k+1$, the rejection condition becomes $s \\leq H - (k+1)$. In our worst-case scenario where $H=s_{legit}+k$, the packet $s_{legit}$ is checked against $s_{legit} \\leq (s_{legit}+k) - (k+1)$, which simplifies to $s_{legit} \\leq s_{legit}-1$. This is false, so the packet is not rejected. It falls into the condition for Rule 2 ($H-W  s \\leq H$), is checked against the record of already-seen packets within the window, and since it is a first-time legitimate arrival, it is accepted.\n\n**Security-Performance Trade-offs in Cyber-Physical Systems (CPS) and Digital Twins (DT)**\n\nThe choice of the window size $W$ involves a critical trade-off between performance (robustness) and security.\n\n- **Choosing $W$ smaller than the minimal value (e.g., $W \\leq k$):**\n  - **Performance:** This choice is detrimental. It would lead to the rejection of legitimate, but reordered, packets. In a CPS context, this could mean losing critical sensor measurements or control commands. For a Digital Twin, this would cause it to become desynchronized from its physical counterpart, leading to incorrect state estimation, flawed predictions, and potentially unsafe operational guidance. The system would suffer from reduced reliability and availability.\n- **Choosing the minimal value ($W = k+1$):**\n  - **Performance:** This is the analytically optimal value if the maximum out-of-order depth $k$ is accurately known and never exceeded. It guarantees that no legitimate packet is dropped due to reordering, ensuring the integrity of the data stream between the physical asset and the Digital Twin.\n  - **Security:** This choice minimizes the replay attack surface. The window of vulnerability, i.e., the range of sequence numbers an attacker could attempt to replay, is as small as possible while maintaining operational correctness. It provides the intended level of anti-replay protection.\n- **Choosing $W$ larger than the minimal value (e.g., $W > k+1$):**\n  - **Performance:** A larger window provides a safety margin, making the system more robust to network conditions where the out-of-order depth might occasionally exceed the expected value of $k$. This can improve system resilience in unpredictable network environments.\n  - **Security:** This choice enlarges the anti-replay window. A larger $W$ means the receiver must keep track of more sequence numbers in its \"seen\" list, increasing memory requirements, which can be a constraint for resource-limited embedded devices common in CPS. More importantly, it widens the interval of sequence numbers $(H-W, H]$ that are not immediately rejected. This gives an attacker a larger set of sequence numbers to potentially use in a replay attack and a longer time frame to mount such an attack before a captured packet's sequence number becomes too old (i.e., less than or equal to $H-W$). Therefore, a larger-than-necessary $W$ weakens the anti-replay defense.\n\nIn summary, the minimal value $W=k+1$ represents the ideal balance, strictly enforcing the security policy while guaranteeing performance under the specified network conditions. Any deviation from this value trades security for performance robustness, or vice-versa.",
            "answer": "$$\\boxed{k+1}$$"
        },
        {
            "introduction": "An alternative to sequence numbers for ensuring data freshness is the use of timestamps, which requires synchronized clocks across the system. The effectiveness of this countermeasure depends critically on the precision of this synchronization relative to network transmission delays. This practice  guides you through a first-principles derivation to find the tightest possible bound on acceptable clock skew, revealing the fundamental trade-off between clock accuracy, network latency, and the ability to reliably detect and reject replayed messages.",
            "id": "4240578",
            "problem": "A digital twin of a Cyber-Physical System (CPS) uses timestamp-based freshness to mitigate replay attacks. The sender attaches a timestamp $t_{s}$ obtained from its local clock $C_{s}(t)$ at the real generation time $t_{\\mathrm{gen}}$. The receiver, with local clock $C_{r}(t)$, accepts a packet only if the observed time difference $C_{r}(t_{\\mathrm{acc}})-t_{s}$ is less than a freshness window $W$, where $t_{\\mathrm{acc}}$ is the real acceptance time. Assume the following foundational properties, which are widely used in time-synchronization analyses for CPS:\n- Clocks are disciplined so that their instantaneous rate mismatch is negligible over the time scales of interest; the dominant error is a bounded offset (skew) between the two clocks. Formally, there exists a bound $\\delta$ such that for any real time $t$, the difference in readings satisfies $|C_{r}(t)-C_{s}(t)|\\leq \\delta$.\n- The one-way network delay is bounded by a known constant $\\Delta$, so any legitimate packet has real age $A:=t_{\\mathrm{acc}}-t_{\\mathrm{gen}}\\leq \\Delta$.\n- An attacker may replay any previously observed packet at a later time. To enforce freshness, the security objective is that any replay whose real age satisfies $A\\geq \\tau$ must be rejected.\n\nStarting only from these fundamental definitions and bounds, derive the tightest upper bound on the acceptable clock offset $\\delta$ (in seconds) for which there exists a freshness window $W$ that simultaneously guarantees:\n1. No false rejection of any legitimate packet delivered within the bounded network delay $\\Delta$.\n2. Guaranteed rejection of any replay older than $\\tau$.\n\nYour answer must be a single closed-form analytic expression for the maximum permissible $\\delta$ in terms of $\\tau$ and $\\Delta$. Express the bound in seconds. No numerical rounding is required.",
            "solution": "The problem requires the derivation of the tightest upper bound on the clock offset $\\delta$ that allows for the existence of a freshness window $W$ to distinguish between legitimate packets and aged replay attacks. We begin by formalizing the two primary conditions given in the problem statement.\n\nThe core of the security mechanism is the receiver's check: a packet is accepted if and only if its associated time difference is less than the freshness window $W$. The time difference is given by $C_{r}(t_{\\mathrm{acc}}) - t_{s}$, where $t_{s}$ is the timestamp applied by the sender, $t_{s} = C_{s}(t_{\\mathrm{gen}})$. Thus, the acceptance condition is:\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}})  W$$\nThe rejection condition is the negation:\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) \\geq W$$\n\nWe are given that the clock rates are synchronized, meaning their rate of progression matches that of real time, and the only error is a bounded offset. This can be modeled as $C_{s}(t) = t + o_{s}$ and $C_{r}(t) = t + o_{r}$ for some constant offsets $o_{s}$ and $o_{r}$. The bound on the clock offset is given as $|C_{r}(t) - C_{s}(t)| \\leq \\delta$ for any real time $t$. This simplifies to $|(t+o_{r}) - (t+o_{s})| \\leq \\delta$, or $|o_{r}-o_{s}| \\leq \\delta$. Let the constant clock difference be $\\epsilon = o_{r} - o_{s}$. Then $-\\delta \\leq \\epsilon \\leq \\delta$.\n\nThe time difference term can be rewritten by adding and subtracting $C_{s}(t_{\\mathrm{acc}})$:\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) = (C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{acc}})) + (C_{s}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}))$$\nDue to the synchronized rate, the second term is:\n$$C_{s}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) = (t_{\\mathrm{acc}} + o_{s}) - (t_{\\mathrm{gen}} + o_{s}) = t_{\\mathrm{acc}} - t_{\\mathrm{gen}}$$\nThis is the real age of the packet, denoted by $A$. The first term is the constant clock offset $\\epsilon$.\nSo, the inequality for the check becomes $\\epsilon + A  W$ for acceptance and $\\epsilon + A \\geq W$ for rejection.\n\nNow, we analyze the two conditions that must be satisfied by our choice of $W$.\n\n**1. No False Rejection of Legitimate Packets**\nThis condition requires that all legitimate packets are accepted. A legitimate packet has a real age $A = t_{\\mathrm{acc}} - t_{\\mathrm{gen}}$ such that $0 \\leq A \\leq \\Delta$. To guarantee acceptance, the condition $\\epsilon + A  W$ must hold for all possible values of $\\epsilon$ and $A$ corresponding to a legitimate packet. This means $W$ must be greater than the maximum possible value of $\\epsilon + A$.\nThe maximum value of $\\epsilon$ is $\\delta$.\nThe maximum value of $A$ for a legitimate packet is $\\Delta$.\nTherefore, the maximum value of the measured difference for a legitimate packet is $\\delta + \\Delta$.\nTo ensure all such packets are accepted, we must choose $W$ such that:\n$$W > \\delta + \\Delta$$\n\n**2. Guaranteed Rejection of Aged Replays**\nThis condition requires that any packet with a real age $A \\geq \\tau$ must be rejected. To guarantee rejection, the condition $\\epsilon + A \\geq W$ must hold for all possible values of $\\epsilon$ and $A$ corresponding to such a replay. This means $W$ must be less than or equal to the minimum possible value of $\\epsilon + A$.\nThe minimum value of $\\epsilon$ is $-\\delta$.\nThe minimum value of $A$ for a packet that must be rejected is $\\tau$.\nTherefore, the minimum value of the measured difference for a packet that must be rejected is $-\\delta + \\tau$.\nTo ensure all such packets are rejected, we must choose $W$ such that:\n$$W \\leq \\tau - \\delta$$\n\n**Deriving the Bound on $\\delta$**\nFor the system to function as required, there must exist a value for the freshness window $W$ that satisfies both derived inequalities simultaneously:\n$$\\delta + \\Delta  W \\leq \\tau - \\delta$$\nA real number $W$ satisfying these bounds can exist if and only if the lower bound is strictly less than the upper bound:\n$$\\delta + \\Delta  \\tau - \\delta$$\nWe rearrange this inequality to solve for $\\delta$:\n$$2\\delta  \\tau - \\Delta$$\n$$\\delta  \\frac{\\tau - \\Delta}{2}$$\nThis inequality gives the condition on the clock offset $\\delta$ under which a suitable freshness window $W$ can be configured. The problem asks for the tightest upper bound on $\\delta$. The set of all permissible values for $\\delta$ is the interval $[0, \\frac{\\tau - \\Delta}{2})$. The supremum, or the least upper bound, of this set is $\\frac{\\tau - \\Delta}{2}$.\n\nIt is crucial to note that for a non-trivial solution to exist where $\\delta > 0$, we must have $\\tau - \\Delta > 0$, which implies $\\tau > \\Delta$. This is physically intuitive: the threshold for rejecting a packet as \"old\" ($\\tau$) must be greater than the maximum possible transit time for a \"fresh\" legitimate packet ($\\Delta$). If $\\tau \\leq \\Delta$, the conditions for acceptance and rejection would be contradictory, and no solution would exist.\n\nThe tightest upper bound on the acceptable clock offset $\\delta$ is the value that $\\delta$ must be strictly less than. This bound is $\\frac{\\tau - \\Delta}{2}$.",
            "answer": "$$\\boxed{\\frac{\\tau - \\Delta}{2}}$$"
        },
        {
            "introduction": "The ultimate danger of a replay attack in a Cyber-Physical System lies in its potential to disrupt the physical world. A successful attack that re-injects stale sensor data can be modeled as introducing a time delay into the system's feedback control loop. This final exercise  bridges the gap between cybersecurity and control theory by asking you to calculate the maximum tolerable delay—the \"delay margin\"—before a stable system is driven into instability, providing a concrete measure of the physical impact of a cyber threat.",
            "id": "4240581",
            "problem": "A Cyber-Physical System (CPS) with a Digital Twin (DT) uses a networked sensor to close the loop. A replay attack on the sensor stream induces an effective constant measurement delay $d>0$ in the feedback signal used by the controller. Consider a single dominant mode of the plant-dynamics linearization described by the scalar system\n$$\\dot{x}(t)=a\\,x(t)+b\\,u(t),\\qquad y(t)=x(t),$$\nwith static output feedback implemented in the DT as\n$$u(t)=-k\\,y(t-d)=-k\\,x(t-d),$$\nwhere $a\\in\\mathbb{R}$, $b>0$, and $k>0$. The closed-loop dynamics under replay-induced delay are therefore\n$$\\dot{x}(t)=a\\,x(t)-b\\,k\\,x(t-d).$$\nStarting from first principles for time-delay systems, namely the exponential trial solution $x(t)=\\exp(s t)$ and the associated characteristic equation, use eigenvalue placement at $d=0$ and delay-margin analysis (imaginary-axis crossing conditions) to derive the necessary and sufficient condition on $(a,b,k)$ under which the measurement delay $d$ can degrade closed-loop stability, and then obtain the exact maximum tolerable delay $d^{\\star}$ (the delay margin) at which the closed-loop system loses stability. Assume $a>0$, $b>0$, $k>0$, and choose $k$ so that the zero-delay closed loop is stable.\n\nReport only the closed-form symbolic expression of $d^{\\star}$ in terms of $a$, $b$, and $k$. Use radians for all angles and express the final delay in seconds. No rounding is required.",
            "solution": "The problem requires the derivation of the stability boundary for a scalar linear time-delay system. The analysis begins with the provided closed-loop dynamical equation.\n\nThe closed-loop dynamics of the Cyber-Physical System under a replay attack are described by the first-order delay differential equation:\n$$\n\\dot{x}(t) = a\\,x(t) - b\\,k\\,x(t-d)\n$$\nwhere $a > 0$, $b > 0$, $k > 0$, and the delay $d > 0$. The stability of this system is determined by the location of the roots of its characteristic equation in the complex plane.\n\nTo find the characteristic equation, we postulate an exponential trial solution of the form $x(t) = C\\exp(st)$, where $C$ is a constant and $s \\in \\mathbb{C}$ is a characteristic root. Substituting this into the differential equation yields:\n$$\ns C\\exp(st) = a C\\exp(st) - b\\,k C\\exp(s(t-d))\n$$\nDividing by $C\\exp(st)$ (for a non-trivial solution, $C \\neq 0$) and simplifying gives:\n$$\ns = a - b\\,k\\exp(-sd)\n$$\nRearranging the terms, we obtain the characteristic equation for the system:\n$$\ns - a + b\\,k\\exp(-sd) = 0\n$$\nThe system is asymptotically stable if and only if all roots $s$ of this equation have a negative real part, i.e., $\\text{Re}(s)  0$.\n\nFirst, we must honor the explicit problem constraint that the system is stable for zero delay, i.e., for $d=0$. In this case, the characteristic equation simplifies to:\n$$\ns - a + b\\,k = 0\n$$\nThis equation has a single real root $s = a - b\\,k$. For stability, this root must be negative:\n$$\na - b\\,k  0 \\implies b\\,k > a\n$$\nThis condition on the controller gain $k$ is assumed to hold, as per the problem statement.\n\nThe system loses stability when, as the delay $d$ is increased from $0$, a pair of complex-conjugate roots crosses the imaginary axis. To find the critical delay $d^{\\star}$ at which this happens, we search for solutions of the form $s = j\\omega$, where $\\omega \\in \\mathbb{R}$ is the crossing frequency. Substituting $s = j\\omega$ into the characteristic equation:\n$$\nj\\omega - a + b\\,k\\exp(-j\\omega d) = 0\n$$\nUsing Euler's identity, $\\exp(-j\\omega d) = \\cos(\\omega d) - j\\sin(\\omega d)$, we get:\n$$\nj\\omega - a + b\\,k(\\cos(\\omega d) - j\\sin(\\omega d)) = 0\n$$\nWe separate this complex equation into its real and imaginary parts:\n\\begin{enumerate}\n    \\item Real part: $-a + b\\,k\\cos(\\omega d) = 0 \\implies b\\,k\\cos(\\omega d) = a$\n    \\item Imaginary part: $\\omega - b\\,k\\sin(\\omega d) = 0 \\implies b\\,k\\sin(\\omega d) = \\omega$\n\\end{enumerate}\nFor a non-trivial crossing, we must have $\\omega \\neq 0$. Since $b>0$ and $k>0$, this implies $\\sin(\\omega d) \\neq 0$. We can square both equations and add them to eliminate the delay $d$:\n$$\n(b\\,k\\cos(\\omega d))^2 + (b\\,k\\sin(\\omega d))^2 = a^2 + \\omega^2\n$$\n$$\n(b\\,k)^2(\\cos^2(\\omega d) + \\sin^2(\\omega d)) = a^2 + \\omega^2\n$$\nUsing the trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$, we find:\n$$\n(b\\,k)^2 = a^2 + \\omega^2\n$$\nThis allows us to solve for the crossing frequency $\\omega$:\n$$\n\\omega^2 = (b\\,k)^2 - a^2\n$$\nFor a real crossing frequency $\\omega$ to exist, we must have $\\omega^2 \\ge 0$, which implies $(b\\,k)^2 \\ge a^2$. Since $a, b, k$ are all positive, this is equivalent to $b\\,k \\ge a$. The case $b\\,k = a$ corresponds to $\\omega=0$, which means the root is at the origin, a situation that aligns with the zero-delay condition for marginal stability. For a delay to *degrade* stability from a stable state, the system must cross the imaginary axis at a non-zero frequency, which requires $\\omega^2 > 0$. Thus, the necessary and sufficient condition on $(a,b,k)$ for the delay $d$ to be capable of inducing oscillatory instability is $b\\,k > a$. This is precisely the condition required for the system to be stable at zero delay, confirming the self-consistency of the problem.\n\nUnder the condition $b\\,k > a$, the crossing frequency is given by:\n$$\n\\omega = \\sqrt{(b\\,k)^2 - a^2}\n$$\nWe take the positive root for $\\omega$ without loss of generality, as a negative $\\omega$ would correspond to the conjugate root crossing.\n\nNow, we can find the critical delay $d^{\\star}$ by returning to the real and imaginary part equations. Dividing the imaginary part by the real part:\n$$\n\\frac{b\\,k\\sin(\\omega d)}{b\\,k\\cos(\\omega d)} = \\tan(\\omega d) = \\frac{\\omega}{a}\n$$\nFrom the individual equations, we note that since $a, b, k, \\omega$ are all positive, we must have $\\cos(\\omega d) = a/(b\\,k) > 0$ and $\\sin(\\omega d) = \\omega/(b\\,k) > 0$. This implies that the angle $\\omega d$ must lie in the first quadrant. The smallest positive angle satisfying this is the principal value of the arccosine function.\n$$\n\\omega d = \\arccos\\left(\\frac{a}{b\\,k}\\right)\n$$\nThe system will lose stability at the smallest positive delay $d > 0$ that satisfies this condition. This smallest delay, $d^{\\star}$, is what we seek:\n$$\nd^{\\star} = \\frac{1}{\\omega} \\arccos\\left(\\frac{a}{b\\,k}\\right)\n$$\nFinally, substituting the expression for $\\omega$ gives the maximum tolerable delay:\n$$\nd^{\\star} = \\frac{1}{\\sqrt{(b\\,k)^2 - a^2}} \\arccos\\left(\\frac{a}{b\\,k}\\right)\n$$\nThis is the closed-form symbolic expression for the delay margin, expressed in terms of the system parameters $a, b, k$.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{(bk)^{2} - a^{2}}} \\arccos\\left(\\frac{a}{bk}\\right)}\n$$"
        }
    ]
}