{
    "hands_on_practices": [
        {
            "introduction": "基于时间戳的机制是确保数据新鲜度的基本方法，直接对抗重放攻击。本练习将深入探讨这种方法的物理限制。通过从基本原理出发，推导在给定的网络延迟和安全目标下，系统能容忍的最大时钟偏差，我们将理解在设计时间敏感的防御策略时所面临的核心权衡。",
            "id": "4240578",
            "problem": "信息物理系统 (CPS) 的数字孪生使用基于时间戳的新鲜度来抵御重放攻击。发送方在真实生成时间 $t_{\\mathrm{gen}}$ 从其本地时钟 $C_{s}(t)$ 获取一个时间戳 $t_{s}$ 并附加到数据包上。拥有本地时钟 $C_{r}(t)$ 的接收方，仅当观测到的时间差 $C_{r}(t_{\\mathrm{acc}})-t_{s}$ 小于一个新鲜度窗口 $W$ 时，才会接收数据包，其中 $t_{\\mathrm{acc}}$ 是真实接收时间。假设存在以下基本属性，这些属性在 CPS 的时间同步分析中被广泛使用：\n- 时钟经过校准，因此在所关注的时间尺度上，它们的瞬时速率失配可以忽略不计；主要误差是两个时钟之间的一个有界偏移（偏斜）。形式上，存在一个界限 $\\delta$，使得对于任意真实时间 $t$，时钟读数之差满足 $|C_{r}(t)-C_{s}(t)|\\leq \\delta$。\n- 单向网络延迟由一个已知常数 $\\Delta$ 界定，因此任何合法数据包的真实龄期 $A:=t_{\\mathrm{acc}}-t_{\\mathrm{gen}}\\leq \\Delta$。\n- 攻击者可能会在稍后的时间重放任何先前观测到的数据包。为了强制实现新鲜度，安全目标是任何真实龄期满足 $A\\geq \\tau$ 的重放包都必须被拒绝。\n\n仅从这些基本定义和界限出发，推导可接受的时钟偏移 $\\delta$（以秒为单位）的最紧上界，在该上界下存在一个新鲜度窗口 $W$ 能够同时保证：\n1. 不会错误地拒绝在有界网络延迟 $\\Delta$ 内传输的任何合法数据包。\n2. 保证拒绝任何龄期大于 $\\tau$ 的重放包。\n\n你的答案必须是关于最大允许 $\\delta$ 的单一闭式解析表达式，用 $\\tau$ 和 $\\Delta$ 表示。将该界限以秒为单位表示。不需要进行数值四舍五入。",
            "solution": "该问题要求推导时钟偏移 $\\delta$ 的最紧上界，该上界允许存在一个新鲜度窗口 $W$ 来区分合法数据包和老化的重放攻击。我们首先将问题陈述中给出的两个主要条件进行形式化。\n\n该安全机制的核心是接收方的检查：当且仅当一个数据包的关联时间差小于新鲜度窗口 $W$ 时，该数据包才被接受。时间差由 $C_{r}(t_{\\mathrm{acc}}) - t_{s}$ 给出，其中 $t_{s}$ 是发送方应用的时间戳，$t_{s} = C_{s}(t_{\\mathrm{gen}})$。因此，接受条件是：\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}})  W$$\n拒绝条件是其否定：\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) \\geq W$$\n\n题目给定，时钟速率是同步的，意味着它们的推进速率与真实时间相匹配，唯一的误差是一个有界的偏移。这可以建模为 $C_{s}(t) = t + o_{s}$ 和 $C_{r}(t) = t + o_{r}$，其中 $o_{s}$ 和 $o_{r}$ 是恒定的偏移量。时钟偏移的界限由 $|C_{r}(t) - C_{s}(t)| \\leq \\delta$ 给出，对于任意真实时间 $t$。这可以简化为 $|(t+o_{r}) - (t+o_{s})| \\leq \\delta$，即 $|o_{r}-o_{s}| \\leq \\delta$。设恒定的时钟差为 $\\epsilon = o_{r} - o_{s}$。那么 $-\\delta \\leq \\epsilon \\leq \\delta$。\n\n时间差项可以通过加上再减去 $C_{s}(t_{\\mathrm{acc}})$ 来重写：\n$$C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) = (C_{r}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{acc}})) + (C_{s}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}))$$\n由于速率同步，第二项是：\n$$C_{s}(t_{\\mathrm{acc}}) - C_{s}(t_{\\mathrm{gen}}) = (t_{\\mathrm{acc}} + o_{s}) - (t_{\\mathrm{gen}} + o_{s}) = t_{\\mathrm{acc}} - t_{\\mathrm{gen}}$$\n这是数据包的真实龄期，记为 $A$。第一项是恒定的时钟偏移 $\\epsilon$。\n因此，检查的不等式变为：接受条件为 $\\epsilon + A  W$，拒绝条件为 $\\epsilon + A \\geq W$。\n\n现在，我们分析我们选择的 $W$ 必须满足的两个条件。\n\n**1. 不会错误地拒绝合法数据包**\n这个条件要求所有合法数据包都被接受。一个合法数据包的真实龄期 $A = t_{\\mathrm{acc}} - t_{\\mathrm{gen}}$ 满足 $0 \\leq A \\leq \\Delta$。为保证接受，条件 $\\epsilon + A  W$ 必须对一个合法数据包对应的所有可能的 $\\epsilon$ 和 $A$ 值都成立。这意味着 $W$ 必须大于 $\\epsilon + A$ 的最大可能值。\n$\\epsilon$ 的最大值是 $\\delta$。\n一个合法数据包的 $A$ 的最大值是 $\\Delta$。\n因此，对于一个合法数据包，测量到的差值的最大值是 $\\delta + \\Delta$。\n为确保所有此类数据包都被接受，我们必须选择 $W$ 使得：\n$$W > \\delta + \\Delta$$\n\n**2. 保证拒绝老化的重放包**\n这个条件要求任何真实龄期 $A \\geq \\tau$ 的数据包都必须被拒绝。为保证拒绝，条件 $\\epsilon + A \\geq W$ 必须对这样一个重放包对应的所有可能的 $\\epsilon$ 和 $A$ 值都成立。这意味着 $W$ 必须小于或等于 $\\epsilon + A$ 的最小可能值。\n$\\epsilon$ 的最小值是 $-\\delta$。\n一个必须被拒绝的数据包的 $A$ 的最小值是 $\\tau$。\n因此，对于一个必须被拒绝的数据包，测量到的差值的最小值是 $-\\delta + \\tau$。\n为确保所有此类数据包都被拒绝，我们必须选择 $W$ 使得：\n$$W \\leq \\tau - \\delta$$\n\n**推导 $\\delta$ 的界限**\n为了让系统按要求工作，必须存在一个新鲜度窗口 $W$ 的值，该值能同时满足两个推导出的不等式：\n$$\\delta + \\Delta  W \\leq \\tau - \\delta$$\n一个满足这些界限的实数 $W$ 存在的充要条件是，下界严格小于上界：\n$$\\delta + \\Delta  \\tau - \\delta$$\n我们重新整理这个不等式以求解 $\\delta$：\n$$2\\delta  \\tau - \\Delta$$\n$$\\delta  \\frac{\\tau - \\Delta}{2}$$\n这个不等式给出了时钟偏移 $\\delta$ 所需满足的条件，在此条件下可以配置一个合适的新鲜度窗口 $W$。问题要求的是 $\\delta$ 的最紧上界。$\\delta$ 的所有允许值的集合是区间 $[0, \\frac{\\tau - \\Delta}{2})$。这个集合的上确界，即最小上界，是 $\\frac{\\tau - \\Delta}{2}$。\n\n必须注意的是，为了存在一个 $\\delta > 0$ 的非平凡解，我们必须有 $\\tau - \\Delta > 0$，这意味着 $\\tau > \\Delta$。这在物理上是直观的：将数据包作为“旧”包拒绝的阈值（$\\tau$）必须大于“新鲜”合法数据包的最大可能传输时间（$\\Delta$）。如果 $\\tau \\leq \\Delta$，那么接受和拒绝的条件将是矛盾的，解将不存在。\n\n可接受时钟偏移 $\\delta$ 的最紧上界是 $\\delta$ 必须严格小于的那个值。这个界限是 $\\frac{\\tau - \\Delta}{2}$。",
            "answer": "$$\\boxed{\\frac{\\tau - \\Delta}{2}}$$"
        },
        {
            "introduction": "虽然时间戳很直观，但许多网络协议（如IPsec）依赖序列号来实现抗重放攻击。本练习聚焦于一种广泛应用的对策：滑动窗口机制。通过推导能够容忍特定网络乱序深度的最小窗口尺寸，我们将学会如何在保证安全策略有效性的同时，兼顾真实世界网络的不可靠性。",
            "id": "4240557",
            "problem": "一个信息物理系统通过互联网协议安全（IPsec）的封装安全载荷（ESP）协议，将其物理设备与其数字孪生相连接。在ESP中，发送方为每个数据包分配严格递增的序列号 $s \\in \\mathbb{N}$。接收方实现了一种基于滑动窗口的抗重放机制，该窗口大小为 $W \\in \\mathbb{N}$，并锚定在迄今为止观测到的最高序列号 $H$ 上。接收方执行以下规则，这些规则定义了其抗重放行为：\n\n- 如果一个序列号为 $s$ 的数据包到达，且 $s  H$，接收方接受该数据包，并将窗口锚点前移至 $H \\leftarrow s$。\n- 如果 $H - W  s \\leq H$，只有当序列号 $s$ 在当前窗口内未曾见过时，接收方才接受该数据包。\n- 如果 $s \\leq H - W$，接收方将其作为窗外重放而拒绝。\n\n假设网络可以重排数据包，在最坏情况下，一个比另一个早发送 $k$ 个位置的数据包可能会晚到，即最大乱序深度为 $k \\in \\mathbb{N}$。换言之，一个序列号为 $H - k$ 的数据包可能会在序列号最高为 $H$ 的一个或多个数据包已被接受之后才到达。\n\n请仅从上述规则以及序列号和滑动窗口的定义出发，推导出最小窗口大小 $W$ 的表达式，该表达式需保证任何受到深度至多为 $k$ 的重排影响的合法数据包都能被接受，同时避免接受规则所定义的窗外重放。您的最终答案必须是一个关于 $k$ 的封闭形式解析表达式。无需进行数值近似，也不涉及任何单位。\n\n此外，在您的推导过程中，请解释在数字孪生和信息物理系统的背景下，选择更大或更小的 $W$ 所带来的安全性与性能之间的权衡，但要确保最终计算结果仅为最小 $W$ 关于 $k$ 的解析表达式。",
            "solution": "**解决方案的推导**\n\n目标是找到最小窗口大小 $W$，以保证在网络可将数据包重排最大深度为 $k$ 的情况下，任何合法数据包都能被接受。根据规则3，合法数据包永远不应被拒绝。\n\n让我们分析数据包被拒绝的条件：序列号为 $s$ 的数据包在 $s \\leq H - W$ 时被拒绝。为保证接受，我们必须确保对于任何合法数据包，其序列号 $s$ 都满足条件 $s > H - W$。\n\n为了确定所需的最小 $W$，我们必须考虑合法数据包的最坏情况。对于一个数据包而言，最坏的情况是它相对于后续数据包经历了最大可能的延迟。我们将这个延迟数据包的序列号表示为 $s_{legit}$。\n\n问题将最大乱序深度 $k$ 定义为一个早发送 $k$ 个位置的数据包可能晚到的能力。这意味着序列号为 $s_{legit}$ 的数据包可能在序列号为 $s_{legit} + k$ 的数据包*之后*到达接收方。任何序列号大于 $s_{legit} + k$ 的数据包在 $s_{legit}$ 之后到达，对于 $s_{legit}$ 来说并非最坏情况，因为 $s_{legit}$ 的到达本应是根据一个锚定在更小的 $H$ 上的窗口来评估的。最坏情况发生在 $H$ 在 $s_{legit}$ 到达前被最大化的时候。\n\n让我们构建这种最坏情况：\n1.  一系列数据包按 $..., s_{legit}, s_{legit}+1, ..., s_{legit}+k, ...$ 的顺序发送。\n2.  由于最大的网络重排，序列号为 $s_{legit}+k$ 的数据包（在这一批数据包中）最先到达接收方。\n3.  在该数据包到达的时刻，我们假设之前的最高序列号小于 $s_{legit}+k$。根据规则1，接收方接受数据包 $s_{legit}+k$ 并更新其状态，将滑动窗口的锚点设置为 $H \\leftarrow s_{legit}+k$。\n4.  现在，接收方可接受的、可能延迟的数据包窗口是区间 $(H - W, H]$，即 $(s_{legit} + k - W, s_{legit} + k]$。拒绝区域适用于任何满足 $s \\leq H - W$ 的序列号 $s$。\n5.  随后，序列号为 $s_{legit}$ 的延迟合法数据包到达。\n6.  为了使该数据包不被规则3立即拒绝，其序列号 $s_{legit}$ 必须不落入拒绝区域。不被拒绝的条件是：\n$$s_{legit} > H - W$$\n7.  将我们最坏情况下的 $H$ 值（$H = s_{legit} + k$）代入，得到：\n$$s_{legit} > (s_{legit} + k) - W$$\n8.  我们现在可以解这个关于 $W$ 的不等式：\n$$s_{legit} > s_{legit} + k - W$$\n$$0 > k - W$$\n$$W > k$$\n由于 $W$ 和 $k$ 被定义为自然数（$W, k \\in \\mathbb{N}$，即正整数），满足不等式 $W > k$ 的最小整数值是 $W = k + 1$。\n\n如果 $W = k+1$，拒绝条件变为 $s \\leq H - (k+1)$。在我们最坏情况中，$H=s_{legit}+k$，数据包 $s_{legit}$ 将根据条件 $s_{legit} \\leq (s_{legit}+k) - (k+1)$ 进行检查，该条件化简为 $s_{legit} \\leq s_{legit}-1$。这是错误的，所以数据包不会被拒绝。它将落入规则2的条件（$H-W  s \\leq H$），与窗口内已见数据包的记录进行核对，并且由于它是首次合法到达，因此会被接受。\n\n**信息物理系统（CPS）和数字孪生（DT）中的安全性与性能权衡**\n\n窗口大小 $W$ 的选择涉及性能（鲁棒性）和安全性之间的关键权衡。\n\n- **选择小于最小值的 $W$（例如，$W \\leq k$）：**\n  - **性能：** 这种选择是有害的。它将导致合法的、但被重排的数据包被拒绝。在CPS背景下，这可能意味着丢失关键的传感器测量值或控制命令。对于数字孪生，这将导致其与物理对应物失去同步，从而引向不正确的状态估计、错误的预测以及可能不安全的操作指导。系统将遭受可靠性和可用性的降低。\n- **选择最小值（$W = k+1$）：**\n  - **性能：** 如果最大乱序深度 $k$ 是精确已知且永远不会被超过，这便是解析上的最优值。它保证没有合法数据包会因重排而被丢弃，从而确保物理资产和数字孪生之间数据流的完整性。\n  - **安全性：** 这种选择最小化了重放攻击面。漏洞窗口，即攻击者可能尝试重放的序列号范围，在保持操作正确性的同时尽可能小。它提供了预期的抗重放保护级别。\n- **选择大于最小值的 $W$（例如，$W > k+1$）：**\n  - **性能：** 更大的窗口提供了一个安全边际，使系统对乱序深度可能偶尔超过预期值 $k$ 的网络条件更具鲁棒性。这可以提高系统在不可预测网络环境中的弹性。\n  - **安全性：** 这种选择扩大了抗重放窗口。更大的 $W$ 意味着接收方必须在其“已见”列表中跟踪更多的序列号，增加了内存需求，这对于CPS中常见的资源受限的嵌入式设备可能是一个制约。更重要的是，它扩大了不会被立即拒绝的序列号区间 $(H-W, H]$。这给了攻击者一个更大的序列号集合可用于重放攻击，以及更长的时间窗口来发起此类攻击，直到捕获的数据包序列号变得过时（即小于或等于 $H-W$）。因此，一个大于必要值的 $W$ 会削弱抗重放防御。\n\n总之，最小值 $W=k+1$ 代表了理想的平衡，它在保证指定网络条件下的性能的同时，严格执行安全策略。任何偏离该值的行为都是以牺牲安全性来换取性能鲁棒性，反之亦然。",
            "answer": "$$\\boxed{k+1}$$"
        }
    ]
}