## 应用与跨学科连接

在前面的章节中，我们已经详细探讨了信息物理系统（CPS）[威胁建模](@entry_id:924842)的核心原则与机制。这些基础知识为我们理解“如何”识别和分析潜在威胁提供了理论框架。然而，CPS[威胁建模](@entry_id:924842)的真正价值在于其应用——即在多样化的现实世界和跨学科背景下，“在哪里”以及“为什么”要应用这些原则。本章的目标正是要从理论走向实践，展示这些核心原则在解决具体工程问题、指导[系统设计](@entry_id:755777)以及满足多领域交叉需求时的实用性、扩展性和集成性。

我们将看到，对CPS的有效威胁建模远非一个孤立的网络安全学科活动。它是一门深度融合的科学，必须与控制理论、实时系统、人因工程、功能安全和法规科学等领域紧密结合。通过一系列源于实际应用场景的案例分析，本章将阐明CPS威胁建模如何成为连接这些不同学科的桥梁，最终帮助我们构建不仅在网络层面安全，更在物理环境中安全、可靠和可信的系统。

### 工业与嵌入式协议的安全分析

信息物理系统的核心在于“信息”与“物理”的连接，而实现这一连接的基石便是通信协议。因此，[威胁建模](@entry_id:924842)的一个关键起点就是对这些协议本身的安全特性进行深入分析。许多部署在关键基础设施中的CPS，如[工业控制系统](@entry_id:1126469)（ICS）和汽车网络，仍然依赖于数十年前设计的传统协议。这些协议在设计之初几乎没有考虑过来自恶意网络攻击者的威胁，因此普遍缺乏现代[网络安全](@entry_id:262820)所要求的核心属性。

以广泛应用于[工业自动化](@entry_id:276005)领域的Modbus/TCP和汽车电子系统中的控制器局域网（CAN）为例，它们在基础规范中均未提供应用层的身份验证、加密（保密性）或加密完整性保护。Modbus/TCP通常在TCP端口 $502$ 上以明文方式运行，这意味着任何能够访问网络的攻击者都可以发送控制指令（如线圈或寄存器写操作）、在传输过程中篡改数据包，或重放合法的控制命令。同样，CAN总线协议允许总线上的任何设备以任何标识符发送消息，其循环冗余校验（CRC）码仅能检测随机传输错误，而无法抵御能够重新计算CRC的恶意消息注入或身份伪装。相比之下，诸如[OPC UA](@entry_id:1129137)（统一开放平台通信架构）等现代协议则在设计中内置了安全机制，当配置了安全策略时，可通过[X.509](@entry_id:1134152)证书、用户令牌、消息加密和[数字签名](@entry_id:269311)提供强大的身份验证、保密性和完整性保障。然而，即便是这类“设计安全”的协议，其安全性也高度依赖于正确的配置和信任管理，例如避免使用“无”安全策略或盲目信任不受信的证书 。

这些协议层面的脆弱性为各种攻击提供了可能。在一个由多智能体（例如无人机集群）组成的CPS中，攻击者可以利用不同的协议层弱点发起攻击。例如，通过在物理信道上进行大功率宽带噪声干扰（**干扰攻击, Jamming**），攻击者可以显著降低[信噪比](@entry_id:271861)，导致通信中断，从而破坏系统的可用性。另一种更[隐蔽](@entry_id:196364)的攻击方式是针对系统的感知层，例如通过发射伪造的导航卫星信号（**欺骗攻击, Spoofing**），误导无人机的GNSS接收器，使其产生错误的位置、导航和授时（PNT）信息，进而破坏其完整性和真实性。这类攻击并不干扰通信信道本身，而是直接污染进入系统的数据源 。

### 与控制理论和状态估计的交叉

CPS的核心是反馈控制回路，其中物理过程的状态通过传感器测量，并用于计算控制决策。因此，高级的威胁模型必须超越单纯的网络通信，深入到控制回路的动态行为中。攻击者的一个主要目标是破坏系统的状态估计（State Estimation）过程，即[数字孪生](@entry_id:171650)或控制器用于理解物理世界状态的内部模型。

一种特别值得关注的攻击类型是**隐蔽式[虚假数据注入攻击](@entry_id:1124874)（Stealthy False Data Injection, FDI）**。与旨在使系统崩溃的拒绝服务攻击不同，FDI攻击的目标是巧妙地操纵传感器读数，使得控制器在不知不觉中将系统驱动到一个不安全或非预期的状态。这类攻击的“隐蔽性”在于，攻击者注入的虚假数据必须能够规避系统内置的[异常检测](@entry_id:635137)机制。在一个典型的基于观测器的检测系统中，系统会计算观测值与模型预测值之间的残差（residual），并当残差的某个范数超过阈值时发出警报。对于一个采用[Luenberger观测器](@entry_id:150581)和二次型残差检测（$r_k^\top W r_k \le \gamma$）的线性系统，攻击向量$a_k$要保持[隐蔽](@entry_id:196364)，就必须满足一个严格的数学条件。该条件确保即使在最坏情况下的正常系统噪声下，被攻击后的残差依然不会超出检测阈值。这个条件可以被精确地推导为 $\sqrt{a_k^\top W a_k} + \sqrt{\gamma_0} \le \sqrt{\gamma}$，其中$\gamma_0$是正常运行时的残差界。这个不等式从几何上诠释了隐蔽攻击的本质：攻击向量在加权范数下的“能量”，必须小于检测阈值与正常噪声阈值之间的“安全裕度” 。

面对这类基于模型的攻击，控制理论本身也提供了强有力的防御思路。传统的控制设计关注于稳定性和性能，而**[鲁棒控制](@entry_id:260994)（Robust Control）**理论则专注于在存在[模型不确定性](@entry_id:265539)和外部扰动的情况下维持系统的稳定与性能。我们可以将有界的恶意攻击[信号建模](@entry_id:181485)为一种外部扰动。通过应用[鲁棒控制](@entry_id:260994)中的$H_{\infty}$优化方法，可以设计一个[状态反馈控制器](@entry_id:203349)$u(t) = Kx(t)$，使得从攻击信号$w(t)$到某个关键性能输出$z(t)$（例如控制能量消耗）的“[最坏情况增益](@entry_id:262400)”最小化。这个增益由闭环[系统传递函数](@entry_id:908945)的$H_{\infty}$范数来衡量。对于一个一阶[线性时不变系统](@entry_id:178866)，可以解析地推导出，在满足[闭环系统](@entry_id:270770)稳定的前提下，可实现的最小[最坏情况增益](@entry_id:262400)为$\frac{e\sqrt{r}}{b}$，其中$e$是扰动输入增益，$b$是控制输入增益，$r$是控制能量的惩罚权重。这表明，我们可以通过控制律的设计，为系统提供一种内在的、可量化的弹性，以抵抗一定能量范围内的所有攻击信号 。

### [实时系统](@entry_id:754137)与物理约束的安全意义

信息物理系统的一个独特之处在于其对时间的高度敏感性。控制回路的性能，乃至整个系统的安全性，都依赖于在严格的时间限制内完成感知、计算和执行。这些[实时约束](@entry_id:754130)既可能成为攻击者利用的弱点，也可能成为防御者可以依赖的屏障。

一方面，攻击者若想成功实施需要实时交互的攻击（如[中间人攻击](@entry_id:274933)），就必须在不破坏系统正常时序的前提下完成其恶意操作。考虑一个场景，攻击者试图拦截、篡改并重放来自传感器的网络数据包。为了不被控制器的截止时间（deadline）检测机制发现，攻击者处理和转发数据包所引入的总延迟，必须小于原始网络延迟、[抖动](@entry_id:200248)和截止时间所共同构成的“时间裕度”。具体来说，攻击者的处理开销 $\delta_a + \delta_f$ 必须满足 $\delta_a + \delta_f \le d_{\max} - (d_n + J_{\max})$，其中 $d_{\max}$ 是端到端截止时间，$d_n$ 是标称[网络延迟](@entry_id:752433)，$J_{\max}$ 是最大网络[抖动](@entry_id:200248)。只有当攻击者能够在这个极其短暂的时间窗口内完成计算（例如，伪造一个能通过数字孪生[模型校验](@entry_id:634241)的欺骗性数据），攻击才可能成功 。

另一方面，这些严格的物理和时序约束也为系统防御提供了独特的优势。许多强大的网络攻击技术，在传统的I[T环](@entry_id:170218)境中或许可行，但在CPS的硬实时环境中则可能因为无法满足时序要求而变得不切实际或极易被检测。例如，对一个[可编程逻辑](@entry_id:164033)控制器（PLC）进行固件更新通常需要使其进入停止模式，整个过程（包括[数据传输](@entry_id:276754)和重启）可能耗时数秒。如果该PLC的控制回路有一个毫秒级的看门狗定时器（watchdog timer），任何试图在系统运行时发起固件篡改的攻击都会立即导致看门狗超时，从而触发系统进入安全停机状态。同样，在如EtherCAT这样的高速实时工业[以太](@entry_id:275233)网上，端到端的延迟和[抖动](@entry_id:200248)预算可能仅为几十微秒。一个物理上插入总线的[中间人攻击](@entry_id:274933)设备，哪怕只引入上百微秒的延迟，也会立刻破坏[网络同步](@entry_id:1128547)，导致总线故障。因此，在对CPS进行威胁建模时，必须利用MITRE ATT&CK for ICS等框架，并结合系统的物理和实时运行参数，来评估特定攻击技术（如“修改控制器固件”或“[中间人攻击](@entry_id:274933)”）的实际可行性。物理定律和[实时约束](@entry_id:754130)成为了系统内在的、可信的“防火墙” 。

### [结构化威胁建模](@entry_id:1132567)框架的实践应用

为了系统化地应对CPS的复杂性，学术界和工业界开发了多种结构化的威胁建模框架。这些框架提供了一套系统性的方法论，引导分析人员从不同维度审视系统，确保威胁识别的全面性和一致性。

**STRIDE** 是一种广为人知的[威胁建模](@entry_id:924842)方法，它根据攻击者的目标将威胁分为六类：欺骗（Spoofing）、篡改（Tampering）、抵赖（Repudiation）、信息泄露（Information Disclosure）、[拒绝服务](@entry_id:748298)（Denial of Service）和[权限提升](@entry_id:753756)（Elevation of Privilege）。在CPS中应用STRIDE时，不仅要识别威胁，还必须评估相应的缓解措施是否满足系统的实时性能约束。以自动驾驶汽车的[传感器融合](@entry_id:263414)管道为例，对于篡改威胁，我们可以采用消息认证码（MAC）来保护数据流的完整性。在选择具体算法时，必须进行性能计算，确保增加的加密[处理时间](@entry_id:196496)（例如，处理相机和激光雷达数据需要$7.5$毫秒）加上网络传输时间（$12$毫秒）和融合计算时间（$15$毫秒），其总和（$34.5$毫秒）不会超过系统端到端的延迟预算（例如$50$毫秒）。一个完整的STRIDE分析会为每个类别提出一套在功能上有效且在性能上可行的综合性缓解策略，例如：通过启动时证书交换和运行时消息认证码来防欺骗；通过[安全启动](@entry_id:754616)和固件签名来防篡改；通过[可信执行环境](@entry_id:756203)（TEE）进行硬件隔离来防[权限提升](@entry_id:753756)等 。

**MITRE ATT&CK for ICS** 框架则提供了一个关于[工业控制系统](@entry_id:1126469)领域内已知对手战术、技术和流程的知识库。它不是一个从零开始进行威胁分析的方法论，而是用于描述、分类和交流对手行为的通用语言。在CPS[威胁建模](@entry_id:924842)中，我们可以将识别出的具体攻击路径映射到ATT&CK框架中，例如，一个攻击可能从“初始访问”开始，通过“利用远程服务”，最终实现“危害过程控制”战术下的“修改控制器程序”技术 。

**PASTA（攻击模拟与威胁分析过程）** 是一个以风险为中心的七阶段方法论。它强调[威胁建模](@entry_id:924842)应从业务目标和风险评估出发，自顶向下地展开。这种方法与CPS及其数字孪生的结合尤为紧密。例如，在第一阶段，我们可以将[电力](@entry_id:264587)变电站的业务目标（如“维持电压稳定”）转化为[数字孪生](@entry_id:171650)中的具体关键性能指标（KPI）和测试断言。在后续阶段，通过分析系统架构识别攻击面，并基于威胁情报构建攻击图。最关键的是，在第六阶段（攻击建模与模拟），我们可以在[数字孪生](@entry_id:171650)上执行这些攻击场景，精确测量其对业务目标（即KPI）的物理影响$I_i$。最后，在第七阶段，将孪生仿真得到的物理影响$I_i$与外部获得的攻击可能性$p_i$相结合，依据风险公式 $R = \sum p_i \cdot I_i$ 计算总体风险，从而驱动缓解措施的优先级排序。这种方法将抽象的[威胁建模](@entry_id:924842)与可执行、可量化的系统验证过程无缝集成起来 。

### 人因要素：[人机界面](@entry_id:904987)与社会工程学

在许多CPS中，“人在环路”（human-in-the-loop）是一个不可或缺的组成部分。操作员通过[人机界面](@entry_id:904987)（HMI）监控系统状态、调整参数并响应异常。因此，HMI不仅是信息传递的窗口，也成为了一个关键的攻击面。针对人的攻击，无论是通过界面设计进行欺骗，还是通过社会工程学窃取凭证，其最终目的都是要通过人这个“代理”来影响物理过程。

HMI的设计直接关系到操作员对**欺骗攻击（Deception Attacks）**的抵御能力。当攻击者操纵传感器数据，在HMI上呈现误导性信息时，操作员能否正确决策，可以运用[信号检测论](@entry_id:924366)（Signal Detection Theory）进行建模。假设一个关键指标在正常和受攻击时服从不同的概率分布，操作员基于一个决策阈值$T$来判断是否存在攻击。最优阈值的设定不仅取决于信号本身的统计特性，还取决于两种错误的代价：漏报（未能检测到攻击）的代价$C_{MD}$和误报（将正常状态误判为攻击）的代价$C_{FA}$。当漏报的代价远大于误报时（$C_{MD} \gg C_{FA}$），最优决策阈值$T$应当被设定得更低，以牺牲一定的误报率为代价来提高检测的灵敏度。此外，HMI的设计可以通过降低显示信息的噪声方差$\sigma$（例如，通过[数据冗余](@entry_id:187031)和交叉验证）来增大正常与异常状态分布的“可分离性”，从而使欺骗攻击更难成功。同时，HMI的界面复杂度（可用信息熵$H$来度量）也直接影响**误配置攻击（Misconfiguration Attacks）**的概率。一个布局混乱、信息过载的界面会显著增加操作员混淆设定值与回读值，或输入错误参数的风险 。

除了界面设计，传统的IT安全威胁——**社会工程学（Social Engineering）**——也对CPS构成了严重威胁。针对ICS操作员的鱼叉式网络钓鱼攻击就是一个典型例子。攻击者通过诱骗操作员在伪造的登录页面输入凭证，从而获取[访问控制](@entry_id:746212)网络的权限。对这类攻击的[威胁建模](@entry_id:924842)可以采用量化[风险分析](@entry_id:140624)的方法。我们可以构建一个攻击图，将整个攻击过程分解为一系列独立的步骤（如“用户点击链接”、“用户输入凭证”、“攻击者绕过MFA”、“成功登录VPN”、“横向移动到ICS网络”等），并为每一步赋予一个成功概率。通过这种方式，我们可以计算出在有无多因子认证（MFA）等不同[安全控制](@entry_id:1131181)下的总攻击成功率，并结合单次入侵造成的预期经济损失，来量化不同防御策略带来的风险降低效益。例如，引入MFA会在攻击图中增加一个概率小于1的串联步骤（或一个包含多个旁路技术的并联步骤），从而显著降低整个攻击链的成功概率，有效减少预期损失 。

### 更广阔的生态系统：供应链、漏洞管理与法规遵从

一个CPS的安全远不止于其自身的设计和运行，它还深深地嵌入在一个更广阔的技术、商业和法律生态系统中。有效的威胁建模必须将视野扩展到系统的整个生命周期，包括其供应链、部署后的漏洞管理以及必须遵守的行业法规和安全标准。

#### [供应链安全](@entry_id:1132659)

许多安全威胁并非源于系统运行时的外部攻击，而是在其交付给最终用户之前就已被植入。这些**供应链攻击**可能发生在硬件制造、软件开发或分发等任何环节。例如，一个被植入了后门的编译器（“信任之信任”攻击）、在代码仓库中被篡改的二[进制](@entry_id:634389)文件，或是在采购过程中被植入的恶意硬件芯片，都可能对最终的CPS构成致命威胁。对这类威胁的建模需要识别供应链中的关键节点和脆弱环节，并评估相应的缓解措施。例如，**软件物料清单（SBOM）**可以帮助识别和跟踪软件中的所有第三方组件，从而有效检测已知的二[进制](@entry_id:634389)篡改；**可复现构建（Reproducible Builds）**，即使用多样化的工具链独立编译两次并验证其输出完全一致，是检测编译器级别后门的有力手段；而对于硬件植入，则需要依赖物理入厂检验、X射线扫描乃至破坏性抽样等手段。通过量化模型，我们可以计算并比较不同缓解措施组合（如“SBOM + 可复现构建 + 物理检验”）对降低不同供应链威胁的总体预期风险的贡献，从而做出[成本效益](@entry_id:894855)最优的决策 。

#### 漏洞管理与[风险评估](@entry_id:170894)

传统的IT漏洞管理实践，如依赖通用漏洞披露（CVE）、通用漏洞评分系统（C[VSS](@entry_id:635952)）和漏洞利用预测评分系统（EPSS），在直接应用于CPS时存在显著局限性。**CVE**仅为漏洞提供唯一标识，本身不包含任何风险信息。**CVSS**评分主要衡量漏洞对受影响“信息”组件本身的机密性、完整性和可用性的影响，它无法捕捉到该组件在特定物理系统中所能引发的“物理”后果的严重性。一个CVSS评分为9.8的远程代码执行漏洞，如果发生在一个非关键的监控传感器上，其物理影响可能为零；而一个CVSS评分中等的可用性漏洞，如果发生在关键的控制器上，则可能导致灾难性后果。**EPSS**预测的是漏洞在“野外”被广泛利用的概率，这对于防范大规模、机会主义攻击有效，但可能严重低估针对特定高价值CPS目标的、由高级持续性威胁（APT）发起的低频、高影响力[定向攻击](@entry_id:266897)的风险。因此，一个适用于CPS的成熟的[风险评估](@entry_id:170894)流程，应当将这些标准工具作为输入，但必须用一个能够模拟物理过程的领域特定模型（例如，数字孪生）来增强它们，从而得出更准确的物理影响$I_{\text{phys}}$，并结合针对性的威胁情报来调整攻击可能性$p$，最终实现对真实风险的精准评估 。

#### 功能安全与协同保障

在许多CPS领域，如汽车、航空和医疗设备，安全（Safety）是与信息安全（Security）同等重要甚至更重要的属性。**功能安全（Functional Safety）**旨在防范由随机硬件失效或系统性设计错误导致的不可接受的风险。然而，在一个互联的CPS中，网络攻击可能导致安全功能失效，这意味着信息安全问题直接转化为功能安全问题。因此，必须建立一个**协同保障（Co-assurance）**的论证体系，将安全证据正式地集成到安全论证（Safety Case）中。依据[IEC 61508](@entry_id:1126352)等标准，一个严谨的[安全论证](@entry_id:1131170)必须明确其所有主张、证据和假设。协同保障的最佳实践是在安全与信息安全的论证之间建立一个明确的、可量化的“接口”。这通常通过一个显式的安全假设来实现，例如，在[安全论证](@entry_id:1131170)中假设：“在[安全控制](@entry_id:1131181)措施的保护下，关键通信的完整性被破坏的概率不高于$\alpha$”。然后，信息安全论证的任务就是提供充分的证据（如渗透测试报告、[密码学](@entry_id:139166)分析、形式化验证结果等）来支撑这个概率边界$\alpha$的合理性。这种结构化的方法确保了来[自信息](@entry_id:262050)安全领域的风险被明确地计入总的系统风险预算中，避免了安全与信息安全“各自为政”所带来的系统性风险低估 。

#### 法律与法规遵从

最后，CPS的威胁建模和安全设计不仅仅是技术活动，更是法律和监管的强制要求。尤其是在医疗设备领域，制造商必须向美国[食品药品监督管理局](@entry_id:915985)（FDA）等监管机构证明其产品的安全性和有效性。对于一个包含[植入式设备](@entry_id:187126)、智能手机应用和云端数字孪生的先进医疗CPS，其整个系统（包括云端部分）都被视为受监管的“医疗器械”。制造商在上市前提交的文件中，必须包含详尽的网络安全风险管理材料，如依据[ISO 14971](@entry_id:901722)进行的威胁建模、风险分析、完整的软件物料清单（SBOM）以及覆盖整个安全开发生命周期的证据。上市后，制造商亦有持续的责任，包括主动监控漏洞、及时发布补丁，并在发生可能导致严重伤害的网络安全事件时，根据医疗器械报告（MDR）制度向FDA报告。这意味着，[威胁建模](@entry_id:924842)不仅是设计工具，也是满足法规遵从、获得市场准入和管理法律责任的基石 。

### 结论

本章通过一系列跨领域的应用案例，揭示了信息物理系统威胁建模的广度与深度。我们看到，有效的威胁建模始于对底层通信协议的剖析，深入到与控制理论和[实时系统](@entry_id:754137)的动态交互，并扩展至对结构化方法论、人因要素以及更广泛的供应链和法规生态系统的综合考量。

从这些例子中浮现的核心思想是：[CPS安全](@entry_id:1131376)是一个整体性问题。将[网络安全](@entry_id:262820)视为一个孤立的附加层，或简单地将IT领域的安全实践生搬硬套，都将导致灾难性的失败。真正的解决方案在于一种跨学科的、系统性的思维方式——将网络攻击视为物理系统必须抵御的一种扰动，将物理约束和实时性视为内在的安全机制，将人的行为和组织的流程纳入[风险评估](@entry_id:170894)的范畴。最终，CPS威胁建模的目标，是驱动我们构建能够在复杂、动态且充满不确定性的物理世界中，履行其关键使命的、真正可信赖的系统。