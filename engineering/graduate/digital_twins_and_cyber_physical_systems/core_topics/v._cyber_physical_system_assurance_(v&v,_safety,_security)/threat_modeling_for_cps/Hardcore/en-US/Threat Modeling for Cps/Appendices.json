{
    "hands_on_practices": [
        {
            "introduction": "The first step in quantitative threat modeling is often to assess the feasibility of a specific attack vector. This exercise provides a foundational model for calculating the expected time-to-compromise for a brute-force attack against a system's credentials. By connecting the information-theoretic concept of password entropy to the practical constraints of attack rate, you will derive a key metric used to evaluate the strength of authentication policies .",
            "id": "4250648",
            "problem": "A cyber-physical system (CPS) operator uses a digital twin to assess the risk of brute-force credential attacks against a safety-critical Programmable Logic Controller (PLC). The PLC enforces no account lockout and accepts online authentication attempts at a measured steady rate of $r$ guesses per second, as determined from the digital twin’s network and protocol emulation. The operator’s credential policy yields passwords that are uniformly distributed over their space with Shannon entropy $H$ bits. Typical planned maintenance windows for the PLC are short, and from a threat modeling perspective, an attacker seeks to complete a brute-force compromise within a maintenance window to minimize operational observability.\n\nStarting only from the definitions of Shannon entropy and expectation over a finite uniform set, and assuming the attacker guesses without replacement in a uniformly random order over the password space, derive the expected time-to-compromise $t_{\\mathrm{exp}}$ as a function of $H$ and $r$. Then define a maintenance window of duration $T_{m}$ seconds. Form the dimensionless ratio $\\xi$ of the expected time-to-compromise to the maintenance window length, $\\xi = t_{\\mathrm{exp}} / T_{m}$, which directly encodes feasibility for an attacker relative to the window (values less than $1$ indicate that the expected time fits within the window).\n\nProvide as your final answer the closed-form symbolic expression for $\\xi$ in terms of $H$, $r$, and $T_{m}$. Do not substitute numerical values. No rounding is required. The final ratio is dimensionless; do not include units in your final answer.",
            "solution": "The problem statement is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n-   The system is a cyber-physical system (CPS) with a Programmable Logic Controller (PLC).\n-   The attack vector is brute-force credential authentication.\n-   The PLC has no account lockout policy.\n-   The rate of authentication attempts is a steady rate of $r$ guesses per second.\n-   The passwords follow a uniform distribution over the password space.\n-   The Shannon entropy of the password distribution is $H$ bits.\n-   The attacker guesses without replacement in a uniformly random order.\n-   The objective is to derive the expected time-to-compromise, $t_{\\mathrm{exp}}$, as a function of $H$ and $r$.\n-   A maintenance window of duration $T_{m}$ seconds is defined.\n-   A dimensionless ratio $\\xi$ is defined as $\\xi = t_{\\mathrm{exp}} / T_{m}$.\n-   The final requested quantity is the closed-form symbolic expression for $\\xi$ in terms of $H$, $r$, and $T_{m}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is grounded in established principles of information theory and computer security. The concepts of Shannon entropy, uniform probability distributions, expected value, and brute-force attack modeling are standard and scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary variables ($H$, $r$, $T_{m}$) and a clear set of assumptions (uniform distribution, no replacement) to derive a unique solution. The objective is explicitly stated.\n-   **Objective**: The language is technical and precise, free from subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem is self-contained. It explicitly asks for a derivation \"Starting only from the definitions of Shannon entropy and expectation,\" which provides a clear and complete basis for the solution. There are no contradictions in the givens.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and all necessary information for a rigorous derivation is provided. The solution process may proceed.\n\n### Derivation of the Expected Time-to-Compromise and the Ratio $\\xi$\n\nThe derivation proceeds in four steps:\n1.  Relate the Shannon entropy $H$ to the size of the password space $N$.\n2.  Calculate the expected number of guesses to find the correct password.\n3.  Calculate the expected time-to-compromise $t_{\\mathrm{exp}}$.\n4.  Form the dimensionless ratio $\\xi$.\n\n**Step 1: Relate Shannon Entropy to Password Space Size**\n\nThe Shannon entropy $H$ for a discrete random variable with $N$ possible outcomes, each with probability $p_i$, is defined as:\n$$H = -\\sum_{i=1}^{N} p_i \\log_2(p_i)$$\nThe problem states that the passwords are uniformly distributed over their space. For a uniform distribution over a space of size $N$, the probability of any single password being the correct one is $p_i = \\frac{1}{N}$ for all $i \\in \\{1, 2, \\dots, N\\}$.\n\nSubstituting this into the entropy formula:\n$$H = -\\sum_{i=1}^{N} \\frac{1}{N} \\log_2\\left(\\frac{1}{N}\\right)$$\nSince the term inside the summation is constant for all $i$, we can simplify the sum:\n$$H = -N \\left( \\frac{1}{N} \\log_2\\left(\\frac{1}{N}\\right) \\right) = -\\log_2\\left(\\frac{1}{N}\\right)$$\nUsing the properties of logarithms, $\\log_b(1/x) = -\\log_b(x)$:\n$$H = -(-\\log_2(N)) = \\log_2(N)$$\nFrom this relationship, we can express the total number of possible passwords, $N$, as a function of the entropy $H$:\n$$N = 2^H$$\n\n**Step 2: Calculate the Expected Number of Guesses**\n\nLet $K$ be the discrete random variable representing the number of guesses required to find the correct password. The attacker guesses passwords from the space of size $N$ without replacement and in a uniformly random order. This implies that the correct password is equally likely to be at any position in the sequence of guesses, from the $1^{\\text{st}}$ to the $N^{\\text{th}}$.\n\nTherefore, the probability of finding the password on the $k^{\\text{th}}$ guess is $P(K=k) = \\frac{1}{N}$ for any $k \\in \\{1, 2, \\dots, N\\}$.\n\nThe expected number of guesses, $E[K]$, is defined by the expectation formula for a discrete random variable:\n$$E[K] = \\sum_{k=1}^{N} k \\cdot P(K=k)$$\nSubstituting the probability $P(K=k)$:\n$$E[K] = \\sum_{k=1}^{N} k \\cdot \\frac{1}{N} = \\frac{1}{N} \\sum_{k=1}^{N} k$$\nThe sum of the first $N$ positive integers is given by the well-known formula $\\sum_{k=1}^{N} k = \\frac{N(N+1)}{2}$.\nSubstituting this sum into the expression for $E[K]$:\n$$E[K] = \\frac{1}{N} \\left( \\frac{N(N+1)}{2} \\right) = \\frac{N+1}{2}$$\nThis is the expected number of guesses required to find the correct password.\n\n**Step 3: Calculate the Expected Time-to-Compromise ($t_{\\mathrm{exp}}$)**\n\nThe attacker can make guesses at a steady rate of $r$ guesses per second. Therefore, the time required for a single guess is $\\frac{1}{r}$ seconds. The total time to compromise is the number of guesses multiplied by the time per guess. The expected time-to-compromise, $t_{\\mathrm{exp}}$, is the expected number of guesses, $E[K]$, multiplied by the time per guess:\n$$t_{\\mathrm{exp}} = E[K] \\cdot \\frac{1}{r} = \\left(\\frac{N+1}{2}\\right) \\frac{1}{r} = \\frac{N+1}{2r}$$\nNow, we substitute the expression for $N$ from Step 1, $N = 2^H$:\n$$t_{\\mathrm{exp}} = \\frac{2^H + 1}{2r}$$\nThis is the expected time-to-compromise as a function of entropy $H$ and guessing rate $r$.\n\n**Step 4: Form the Dimensionless Ratio ($\\xi$)**\n\nThe problem defines a dimensionless ratio $\\xi$ as the expected time-to-compromise divided by the duration of the maintenance window, $T_m$:\n$$\\xi = \\frac{t_{\\mathrm{exp}}}{T_{m}}$$\nSubstituting the derived expression for $t_{\\mathrm{exp}}$:\n$$\\xi = \\frac{\\left(\\frac{2^H + 1}{2r}\\right)}{T_{m}}$$\nSimplifying this compound fraction gives the final closed-form expression for $\\xi$:\n$$\\xi = \\frac{2^H + 1}{2rT_{m}}$$\nThis expression represents the ratio of the expected compromise time to the available maintenance window, providing a direct measure of attack feasibility.",
            "answer": "$$\\boxed{\\frac{2^{H} + 1}{2rT_{m}}}$$"
        },
        {
            "introduction": "In cyber-physical systems, security measures are not independent of physical system performance; they are deeply intertwined. This practice explores the critical trade-off between enhancing cybersecurity and maintaining control stability, a central challenge in CPS design. By analyzing the impact of cryptographic latency on a control loop's delay margin, you will learn to quantify whether a security enhancement inadvertently pushes the physical system toward instability .",
            "id": "4250661",
            "problem": "A networked Cyber-Physical System (CPS) is secured using Advanced Encryption Standard in Galois/Counter Mode (AES-GCM), introducing cryptographic processing latency on each communication hop. A Digital Twin (DT) monitors control-loop performance and must verify whether the added cryptographic latency preserves closed-loop stability. The plant is modeled as a continuous-time, linear time-invariant system with transfer function $G(s) = \\frac{1}{(s+1)(s+2)}$, and the controller is a proportional-integral compensator $C(s) = K \\frac{s+3}{s}$ with $K = 1$. The loop transfer function is $L(s) = C(s)G(s)$. The baseline end-to-end latency (without cryptography) consists of sensor-to-controller network propagation delay $d_{1} = 12\\ \\text{ms}$, controller-to-actuator network propagation delay $d_{2} = 8\\ \\text{ms}$, scheduler-induced queuing/jitter $d_{q} = 5\\ \\text{ms}$, and controller computation time $d_{c} = 4\\ \\text{ms}$. Cryptographic overhead arises from two encryptions and two decryptions per cycle (sensor encrypts, controller decrypts; controller encrypts, actuator decrypts). Each AES-GCM operation has a fixed per-packet overhead $\\alpha = 20\\ \\mu\\text{s}$ and a per-byte cost $\\beta = 0.3125\\ \\mu\\text{s}/\\text{byte}$ for a packet length of $n = 512\\ \\text{bytes}$. All angles must be treated in radians.\n\nTasks:\n- Compute the total end-to-end delay with cryptographic overhead, treating each AES-GCM operation as an added processing delay in series.\n- Using fundamental frequency-domain stability concepts for time-delay in linear time-invariant loops, compute the time-delay margin and assess whether the added cryptographic latency preserves closed-loop stability.\n- Report the stability slack $s = \\tau_{\\text{dm}} - \\tau_{\\text{total}}$, where $\\tau_{\\text{dm}}$ is the time-delay margin and $\\tau_{\\text{total}}$ is the total loop delay including cryptographic processing.\n\nExpress the final stability slack $s$ in $\\text{ms}$ and round your answer to four significant figures.",
            "solution": "We begin from fundamental control principles for linear time-invariant feedback systems. The loop transfer function is $L(s) = C(s)G(s)$, and frequency-domain stability margins are evaluated at the gain crossover frequency $\\omega_{c}$ defined by $|L(j\\omega_{c})| = 1$. A pure time delay $\\tau$ in the loop contributes an additional phase lag of $-\\omega \\tau$ at frequency $\\omega$. Let $\\phi_{m}$ denote the phase margin of the loop without delay. The Nyquist stability criterion implies that closed-loop stability is preserved if the added time delay at $\\omega_{c}$ does not exhaust the phase margin, which yields the well-tested delay-margin relation\n$$\n\\tau_{\\text{dm}} = \\frac{\\phi_{m}}{\\omega_{c}},\n$$\nobtained by requiring that the additional phase lag $\\omega_{c}\\tau$ is strictly less than $\\phi_{m}$. We compute $\\omega_{c}$ and $\\phi_{m}$ from $L(s)$, then compare $\\tau_{\\text{dm}}$ against the total loop delay $\\tau_{\\text{total}}$ that includes baseline latencies and cryptographic processing.\n\nStep 1: Loop transfer function and gain crossover frequency. The plant and controller are\n$$\nG(s) = \\frac{1}{(s+1)(s+2)}, \\quad C(s) = K\\frac{s+3}{s}, \\quad K=1,\n$$\nso\n$$\nL(s) = \\frac{s+3}{s(s+1)(s+2)}.\n$$\nThe magnitude at frequency $\\omega$ is\n$$\n|L(j\\omega)| = \\frac{|j\\omega+3|}{|j\\omega|\\,|j\\omega+1|\\,|j\\omega+2|} = \\frac{\\sqrt{\\omega^{2}+9}}{\\omega\\,\\sqrt{\\omega^{2}+1}\\,\\sqrt{\\omega^{2}+4}}.\n$$\nAt $\\omega = 1$, we have\n$$\n|L(j\\cdot 1)| = \\frac{\\sqrt{1+9}}{1\\cdot \\sqrt{1+1}\\cdot \\sqrt{1+4}} = \\frac{\\sqrt{10}}{\\sqrt{2}\\sqrt{5}} = \\frac{\\sqrt{10}}{\\sqrt{10}} = 1,\n$$\nso the gain crossover frequency is $\\omega_{c} = 1$.\n\nStep 2: Phase margin. The phase of $L(j\\omega)$ is\n$$\n\\arg L(j\\omega) = \\arg(j\\omega+3) - \\arg(j\\omega) - \\arg(j\\omega+1) - \\arg(j\\omega+2).\n$$\nAt $\\omega = 1$, this becomes\n$$\n\\arg L(j\\cdot 1) = \\arctan\\!\\left(\\frac{1}{3}\\right) - \\frac{\\pi}{2} - \\arctan(1) - \\arctan\\!\\left(\\frac{1}{2}\\right).\n$$\nThus the phase margin is\n$$\n\\phi_{m} = \\pi + \\arg L(j\\omega_{c}) = \\pi + \\left[\\arctan\\!\\left(\\frac{1}{3}\\right) - \\frac{\\pi}{2} - \\frac{\\pi}{4} - \\arctan\\!\\left(\\frac{1}{2}\\right)\\right].\n$$\nEvaluating the arctangent terms symbolically and then numerically (keeping constants symbolic until the final evaluation),\n$$\n\\arctan\\!\\left(\\frac{1}{3}\\right) \\approx 0.3217505543966422,\\quad \\arctan(1) = \\frac{\\pi}{4} \\approx 0.7853981633974483,\n$$\n$$\n\\arctan\\!\\left(\\frac{1}{2}\\right) \\approx 0.4636476090008061,\\quad \\frac{\\pi}{2} \\approx 1.5707963267948966,\\quad \\pi \\approx 3.141592653589793.\n$$\nTherefore,\n$$\n\\arg L(j\\cdot 1) \\approx 0.3217505543966422 - 1.5707963267948966 - 0.7853981633974483 - 0.4636476090008061 \\approx -2.4980915447965087,\n$$\nand\n$$\n\\phi_{m} \\approx 3.141592653589793 - 2.4980915447965087 \\approx 0.6435011087932844.\n$$\nHence the delay margin is\n$$\n\\tau_{\\text{dm}} = \\frac{\\phi_{m}}{\\omega_{c}} = \\frac{0.6435011087932844}{1} \\approx 0.6435011087932844\\ \\text{s}.\n$$\n\nStep 3: Total end-to-end delay with cryptographic overhead. The baseline delay is the sum\n$$\n\\tau_{\\text{base}} = d_{1} + d_{2} + d_{q} + d_{c} = 12\\ \\text{ms} + 8\\ \\text{ms} + 5\\ \\text{ms} + 4\\ \\text{ms} = 29\\ \\text{ms} = 0.029\\ \\text{s}.\n$$\nEach AES-GCM operation has processing time\n$$\nt_{\\text{proc}} = \\alpha + \\beta n = 20\\ \\mu\\text{s} + (0.3125\\ \\mu\\text{s}/\\text{byte})\\cdot 512\\ \\text{bytes} = 20\\ \\mu\\text{s} + 160\\ \\mu\\text{s} = 180\\ \\mu\\text{s} = 0.00018\\ \\text{s}.\n$$\nThere are four operations per cycle (encrypt at sensor, decrypt at controller, encrypt at controller, decrypt at actuator), so the cryptographic total is\n$$\n\\tau_{\\text{enc}} = 4\\,t_{\\text{proc}} = 4 \\cdot 0.00018\\ \\text{s} = 0.00072\\ \\text{s}.\n$$\nThus the total loop delay including cryptography is\n$$\n\\tau_{\\text{total}} = \\tau_{\\text{base}} + \\tau_{\\text{enc}} = 0.029\\ \\text{s} + 0.00072\\ \\text{s} = 0.02972\\ \\text{s}.\n$$\n\nStep 4: Stability slack and verification. The stability slack is defined as\n$$\ns = \\tau_{\\text{dm}} - \\tau_{\\text{total}}.\n$$\nSubstituting the computed values,\n$$\ns \\approx 0.6435011087932844\\ \\text{s} - 0.02972\\ \\text{s} = 0.6137811087932844\\ \\text{s}.\n$$\nConverting to milliseconds,\n$$\ns \\approx 0.6137811087932844\\ \\text{s} \\times 1000\\ \\frac{\\text{ms}}{\\text{s}} = 613.7811087932844\\ \\text{ms}.\n$$\nRounded to four significant figures, the stability slack is\n$$\ns \\approx 613.8\\ \\text{ms}.\n$$\nBecause $s > 0$, the added cryptographic latency does not violate the closed-loop stability criterion under the time-delay margin analysis. The requested final answer is the rounded stability slack in $\\text{ms}$.",
            "answer": "$$\\boxed{613.8}$$"
        },
        {
            "introduction": "Effective defense requires not only understanding potential vulnerabilities but also anticipating the strategic behavior of an intelligent adversary. This advanced practice moves from static analysis to dynamic, game-theoretic reasoning by framing security as a Stackelberg game between an attacker and a defender. You will model the defender's problem of optimally allocating limited monitoring resources to minimize the damage a rational attacker can inflict, providing a powerful framework for strategic decision-making in security .",
            "id": "4250667",
            "problem": "A Digital Twin (DT) of a Cyber-Physical System (CPS) maintains real-time estimates of subsystem states and allocates computational monitoring resources to detect attacks across three subsystems: the actuator network ($i=1$), the sensor bus ($i=2$), and the control logic ($i=3$). Let the defender allocate a nonnegative monitoring intensity $x_i$ to subsystem $i$, incurring resource cost proportional to $x_i$. The defender has a total resource budget $b$ and must satisfy $\\sum_{i=1}^{3} c_i x_i \\leq b$ with $x_i \\geq 0$.\n\nAssume the following fundamental base:\n- The attacker moves after observing the defender’s allocation $(x_1,x_2,x_3)$, and chooses a single subsystem $i$ to attack.\n- For each subsystem $i$, the DT-induced detection probability under monitoring intensity $x_i$ obeys the standard saturating law $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$, where $\\alpha_i > 0$ represents detection efficacy per unit resource.\n- If the attack on subsystem $i$ is not detected, the attacker gains expected payoff $D_i$ (the attacker’s benefit equals the defender’s loss). If the attack is detected, the attacker incurs a disutility $K > 0$ (for example, resource expenditure failure, attribution risk, or counter-response), and gains no $D_i$. The attacker’s expected utility on subsystem $i$ is therefore the expected value under detection,\n$$\nU_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K.\n$$\n- The attacker best-responds by choosing subsystem $i$ maximizing $U_i(x_i)$. The defender is conservative and seeks to minimize the worst-case attacker utility across subsystems, i.e., minimize $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$ subject to the budget and nonnegativity constraints.\n\nTasks:\n1. Starting from the definitions above, formalize the bilevel Stackelberg attacker-defender model as a single-level optimization problem faced by the defender, expressing the objective solely in terms of $(x_1,x_2,x_3)$ and the given parameters.\n2. Derive, from first principles and without shortcut formulas, the optimality conditions characterizing an optimal allocation $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ under the case that all three subsystems receive positive allocation at optimum.\n3. For the parameter values $c_1 = c_2 = c_3 = 1$, $\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$, $K = 40$, $(D_1,D_2,D_3) = (60,80,100)$, and budget $b = 3 \\ln(2)$, compute the defender’s optimal allocation vector $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ in exact form (do not round). Express the allocation in dimensionless resource units. The final answer must be written as a single row vector using the $\\mathrm{pmatrix}$ environment.",
            "solution": "The user has provided a problem statement that successfully passes the validation protocol. It is scientifically grounded in game theory and optimization, well-posed, objective, and contains all necessary information for a rigorous solution. We may therefore proceed.\n\nThe problem describes a Stackelberg game where the defender (leader) allocates monitoring resources and the attacker (follower) chooses a subsystem to target. The defender's goal is to minimize the attacker's maximum possible utility. We will address the three tasks in order.\n\n### Task 1: Formalization of the Bilevel Model\n\nThe problem is a bilevel optimization problem, but since the follower's (attacker's) problem is simply to select the maximum of a set of values, it can be collapsed into a single-level minimax problem for the defender.\n\nFirst, we express the attacker's utility on subsystem $i$, $U_i(x_i)$, in terms of the defender's allocation $x_i$. The detection probability is given as $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$. The attacker's utility is $U_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K$.\nSubstituting the expression for $p_i(x_i)$:\n$$\nU_i(x_i) = \\Big(1 - \\big(1 - \\exp(-\\alpha_i x_i)\\big)\\Big) D_i - \\big(1 - \\exp(-\\alpha_i x_i)\\big) K\n$$\n$$\nU_i(x_i) = \\exp(-\\alpha_i x_i) D_i - K + K \\exp(-\\alpha_i x_i)\n$$\n$$\nU_i(x_i) = (D_i + K) \\exp(-\\alpha_i x_i) - K\n$$\nThe attacker, observing the defender's allocation $(x_1, x_2, x_3)$, will choose the subsystem $i$ that maximizes this utility. The attacker's best-response utility is therefore $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$.\n\nThe defender's objective is to choose the allocation $(x_1, x_2, x_3)$ to minimize this maximum utility, subject to budget and non-negativity constraints. The defender's optimization problem is:\n$$\n\\min_{x_1, x_2, x_3} \\left( \\max_{i \\in \\{1,2,3\\}} \\Big\\{ (D_i + K) \\exp(-\\alpha_i x_i) - K \\Big\\} \\right)\n$$\nsubject to:\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\nThis is the single-level formulation of the defender's problem. To make it more amenable to standard optimization techniques, we can convert this minimax problem into a constrained optimization problem using the epigraph formulation. We introduce an auxiliary variable $U$ which will represent the maximum utility.\nThe problem is equivalent to:\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\nsubject to:\n$$\nU_i(x_i) \\leq U \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\nSubstituting the expression for $U_i(x_i)$, the single-level optimization problem is:\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\nsubject to:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i) - K \\leq U \\quad \\text{for } i=1,2,3\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i - b \\leq 0\n$$\n$$\n-x_i \\leq 0 \\quad \\text{for } i=1,2,3\n$$\n\n### Task 2: Derivation of Optimality Conditions\n\nWe seek to derive the optimality conditions for the case where the optimal allocation is interior, i.e., $x_i^{\\star} > 0$ for all $i \\in \\{1,2,3\\}$. We use the Karush-Kuhn-Tucker (KKT) conditions for the constrained optimization problem formulated above.\n\nThe Lagrangian $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(x_1, x_2, x_3, U, \\lambda_1, \\lambda_2, \\lambda_3, \\mu, \\nu_1, \\nu_2, \\nu_3) = U + \\sum_{i=1}^{3} \\lambda_i \\left( (D_i + K) \\exp(-\\alpha_i x_i) - K - U \\right) + \\mu \\left( \\sum_{i=1}^{3} c_i x_i - b \\right) - \\sum_{i=1}^{3} \\nu_i x_i\n$$\nwhere $\\lambda_i, \\mu, \\nu_i$ are the non-negative Lagrange multipliers.\n\nThe KKT conditions for an optimal point $(x^\\star, U^\\star, \\lambda^\\star, \\mu^\\star, \\nu^\\star)$ are:\n1.  **Stationarity:** The gradient of the Lagrangian with respect to the primal variables must be zero.\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial U} = 1 - \\sum_{i=1}^{3} \\lambda_i = 0 \\implies \\sum_{i=1}^{3} \\lambda_i = 1$.\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial x_i} = \\lambda_i (D_i + K) (-\\alpha_i) \\exp(-\\alpha_i x_i) + \\mu c_i - \\nu_i = 0$ for $i=1,2,3$.\n\n2.  **Primal Feasibility:** The constraints must be satisfied.\n    -   $(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K \\leq U^{\\star}$ for $i=1,2,3$.\n    -   $\\sum_{i=1}^{3} c_i x_i^{\\star} \\leq b$.\n    -   $x_i^{\\star} \\geq 0$ for $i=1,2,3$.\n\n3.  **Dual Feasibility:** $\\lambda_i \\geq 0$, $\\mu \\geq 0$, $\\nu_i \\geq 0$ for $i=1,2,3$.\n\n4.  **Complementary Slackness:**\n    -   $\\lambda_i ((D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star}) = 0$ for $i=1,2,3$.\n    -   $\\mu (\\sum_{i=1}^{3} c_i x_i^{\\star} - b) = 0$.\n    -   $\\nu_i x_i^{\\star} = 0$ for $i=1,2,3$.\n\nWe are analyzing the case of an interior solution, where $x_i^{\\star} > 0$ for all $i$. By complementary slackness, this implies $\\nu_i = 0$ for all $i$. The stationarity condition for $x_i$ simplifies to:\n$$\n-\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) + \\mu c_i = 0\n$$\n$$\n\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = \\mu c_i\n$$\nSince $\\alpha_i > 0$, $D_i+K > 0$, $c_i > 0$, and $\\exp(-\\alpha_i x_i^{\\star}) > 0$, the right side, $\\mu c_i$, must be positive unless $\\lambda_i=0$. If $\\mu=0$, then $\\lambda_i=0$ for all $i$, which contradicts $\\sum \\lambda_i = 1$. Therefore, we must have $\\mu > 0$.\n\nSince $\\mu > 0$, complementary slackness for the budget constraint implies it must be active:\n$$\n\\sum_{i=1}^{3} c_i x_i^{\\star} = b\n$$\nFurthermore, since $\\mu > 0$ and $c_i > 0$, the term $\\mu c_i$ is strictly positive. This implies that for each $i$, $\\lambda_i$ must be strictly positive, $\\lambda_i > 0$. If $\\lambda_j = 0$ for some $j$, then $\\mu c_j=0$, which is a contradiction.\n\nSince $\\lambda_i > 0$ for all $i$, complementary slackness for the utility constraints implies they must all be active:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star} = 0 \\quad \\text{for } i=1,2,3\n$$\nThis means that at the optimum, the attacker's utility is the same for all three subsystems:\n$$\n(D_1 + K) \\exp(-\\alpha_1 x_1^{\\star}) - K = (D_2 + K) \\exp(-\\alpha_2 x_2^{\\star}) - K = (D_3 + K) \\exp(-\\alpha_3 x_3^{\\star}) - K\n$$\nThis is the \"equalized utility\" principle for this type of security game.\n\nThus, the optimality conditions characterizing an interior solution $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ are the following system of equations:\n1.  **Equal Attacker Utility:** $(D_1+K)\\exp(-\\alpha_1 x_1^{\\star}) = (D_2+K)\\exp(-\\alpha_2 x_2^{\\star}) = (D_3+K)\\exp(-\\alpha_3 x_3^{\\star})$.\n2.  **Active Budget Constraint:** $\\sum_{i=1}^{3} c_i x_i^{\\star} = b$.\n\nThese conditions form a system of equations that can be solved for $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$. Let the common value in the first condition be $C_U = U^{\\star}+K$. Then for each $i$:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = C_U \\implies x_i^{\\star} = \\frac{1}{\\alpha_i} \\ln\\left(\\frac{D_i+K}{C_U}\\right)\n$$\nSubstituting these into the budget constraint allows for the determination of $C_U$.\n\n### Task 3: Computation of the Optimal Allocation\n\nWe are given the parameters: $c_1 = c_2 = c_3 = 1$, $\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$, $K = 40$, $(D_1,D_2,D_3) = (60,80,100)$, and budget $b = 3 \\ln(2)$.\n\nWe assume an interior solution and apply the optimality conditions derived above.\nThe parameters simplify the conditions:\n1.  $(D_1+K)\\exp(-x_1^{\\star}) = (D_2+K)\\exp(-x_2^{\\star}) = (D_3+K)\\exp(-x_3^{\\star})$.\n2.  $x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = b$.\n\nLet's compute the values of $D_i+K$:\n$D_1 + K = 60 + 40 = 100$\n$D_2 + K = 80 + 40 = 120$\n$D_3 + K = 100 + 40 = 140$\n\nLet $C_U_s = (D_i+K)\\exp(-x_i^{\\star})$ be the common value.\nFrom this, we can express each $x_i^{\\star}$ in terms of $C_U_s$:\n$x_1^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right)$\n$x_2^{\\star} = \\ln\\left(\\frac{120}{C_U_s}\\right)$\n$x_3^{\\star} = \\ln\\left(\\frac{140}{C_U_s}\\right)$\n\nSubstitute these into the budget constraint:\n$x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right) + \\ln\\left(\\frac{120}{C_U_s}\\right) + \\ln\\left(\\frac{140}{C_U_s}\\right) = b$\nUsing logarithm properties:\n$\\ln(100) - \\ln(C_U_s) + \\ln(120) - \\ln(C_U_s) + \\ln(140) - \\ln(C_U_s) = b$\n$\\ln(100 \\times 120 \\times 140) - 3\\ln(C_U_s) = b$\n$\\ln(1680000) - 3\\ln(C_U_s) = 3\\ln(2)$\n$3\\ln(C_U_s) = \\ln(1680000) - 3\\ln(2) = \\ln(1680000) - \\ln(2^3) = \\ln(1680000) - \\ln(8)$\n$3\\ln(C_U_s) = \\ln\\left(\\frac{1680000}{8}\\right) = \\ln(210000)$\n$\\ln(C_U_s) = \\frac{1}{3}\\ln(210000) = \\ln((210000)^{1/3})$\n$C_U_s = (210000)^{1/3}$\n\nNow we can compute the individual allocations $x_i^{\\star}$:\n$x_1^{\\star} = \\ln(100) - \\ln(C_U_s) = \\ln(100) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(100) - \\ln(210000)}{3} = \\frac{\\ln(100^3) - \\ln(210000)}{3}$\n$x_1^{\\star} = \\frac{\\ln(1000000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1000000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{100}{21}\\right)$\n\n$x_2^{\\star} = \\ln(120) - \\ln(C_U_s) = \\ln(120) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(120) - \\ln(210000)}{3} = \\frac{\\ln(120^3) - \\ln(210000)}{3}$\n$x_2^{\\star} = \\frac{\\ln(1728000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1728000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{1728}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{288}{35}\\right)$\n\n$x_3^{\\star} = \\ln(140) - \\ln(C_U_s) = \\ln(140) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(140) - \\ln(210000)}{3} = \\frac{\\ln(140^3) - \\ln(210000)}{3}$\n$x_3^{\\star} = \\frac{\\ln(2744000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{2744000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{2744}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{196}{15}\\right)$\n\nSince $\\frac{100}{21} > 1$, $\\frac{288}{35} > 1$, and $\\frac{196}{15} > 1$, all $x_i^{\\star}$ are positive, which confirms our working assumption of an interior solution. The optimal allocation is $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} \\ln\\left(\\frac{100}{21}\\right) & \\frac{1}{3} \\ln\\left(\\frac{288}{35}\\right) & \\frac{1}{3} \\ln\\left(\\frac{196}{15}\\right) \\end{pmatrix}}\n$$"
        }
    ]
}