{
    "hands_on_practices": [
        {
            "introduction": "Understanding the financial implications of architectural decisions is paramount in cloud engineering. This first practice grounds your design skills in economic reality, tasking you with building a simple but powerful cost model for a cloud-hosted digital twin. By calculating the total monthly expense from fundamental resource metrics—compute, storage, and data egress—you will learn to identify dominant cost drivers and develop the crucial ability to forecast and optimize operational budgets .",
            "id": "4208230",
            "problem": "A cloud-hosted digital twin for an industrial cyber-physical system is deployed in a multi-tenant environment. The workload model predicts a monthly resource consumption profile with three components: compute, storage, and network egress. The compute workload is measured in virtual Central Processing Unit (vCPU) hours, the storage footprint in terabyte-months, and data egress in terabytes. The operator uses decimal billing units for storage and egress, specifically $1~\\mathrm{TB} = 1000~\\mathrm{GB}$, and linear on-demand pricing with no tiering or discounts. The measured monthly usage is $50{,}000$ vCPU-hours of compute, $100$ terabyte-months of storage, and $20$ terabytes of egress. The unit prices are $\\$0.03$ per vCPU-hour, $\\$0.02$ per gigabyte-month of storage, and $\\$0.05$ per gigabyte of egress. Let the components be indexed as follows: compute $i=1$, storage $i=2$, egress $i=3$.\n\nUsing only the principle that a linear resource pricing model yields a total monthly cost equal to the sum over components of (usage multiplied by unit price), compute the total monthly cost and determine the index $i$ of the dominant cost driver (the component contributing the largest portion of the total cost). Express the total monthly cost in United States dollars (USD). Provide your final answer as a row matrix $\\begin{pmatrix}C_{\\text{total}} & i_{\\text{dom}}\\end{pmatrix}$ with no units inside the matrix. No rounding is required; provide exact values.",
            "solution": "The problem is first validated to ensure it is self-contained, consistent, and scientifically sound.\n\n### Step 1: Extract Givens\n- Resource components: compute ($i=1$), storage ($i=2$), network egress ($i=3$).\n- Compute usage: $U_1 = 50,000$ vCPU-hours.\n- Storage usage: $U_2 = 100$ terabyte-months.\n- Egress usage: $U_3 = 20$ terabytes.\n- Compute unit price: $P_1 = \\$0.03$ per vCPU-hour.\n- Storage unit price: $P_2 = \\$0.02$ per gigabyte-month.\n- Egress unit price: $P_3 = \\$0.05$ per gigabyte.\n- Unit conversion definition: $1~\\mathrm{TB} = 1000~\\mathrm{GB}$.\n- Calculation principle: Total monthly cost is the sum over components of (usage multiplied by unit price).\n- Required outputs: Total monthly cost $C_{\\text{total}}$ and the index of the dominant cost driver $i_{\\text{dom}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard cost calculation for cloud computing resources. The terminology (vCPU-hours, terabyte-months), pricing model (linear on-demand), and unit conversions are consistent with industry practice. The problem is well-defined, providing all necessary data and a clear principle for calculation. It is objective, factual, and contains no contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe total monthly cost, $C_{\\text{total}}$, is determined by the principle that the total cost is the sum of the costs of individual components. Let $C_i$ be the cost for component $i$, calculated as the product of its usage, $U_i$, and its unit price, $P_i$.\n$$C_{\\text{total}} = \\sum_{i=1}^{3} C_i = \\sum_{i=1}^{3} (U_i \\cdot P_i)$$\nHowever, care must be taken to ensure the units of usage and price are consistent for each component before multiplication.\n\n**Component 1: Compute Cost ($C_1$)**\nThe usage is given as $U_1 = 50,000$ vCPU-hours and the unit price is $P_1 = \\$0.03$ per vCPU-hour. The units are already consistent.\n$$C_1 = U_1 \\times P_1 = 50,000 \\times 0.03 = 1500$$\nThe compute cost is $C_1 = \\$1500$.\n\n**Component 2: Storage Cost ($C_2$)**\nThe usage is given as $U_2 = 100$ terabyte-months, but the price is $P_2 = \\$0.02$ per gigabyte-month. We must convert the usage from terabyte-months to gigabyte-months using the provided conversion factor $1~\\mathrm{TB} = 1000~\\mathrm{GB}$.\nLet $U'_2$ be the usage in gigabyte-months.\n$$U'_2 = 100~\\text{TB-months} \\times \\frac{1000~\\text{GB-months}}{1~\\text{TB-month}} = 100,000~\\text{GB-months}$$\nNow we can calculate the storage cost.\n$$C_2 = U'_2 \\times P_2 = 100,000 \\times 0.02 = 2000$$\nThe storage cost is $C_2 = \\$2000$.\n\n**Component 3: Egress Cost ($C_3$)**\nThe usage is given as $U_3 = 20$ terabytes, but the price is $P_3 = \\$0.05$ per gigabyte. We must convert the usage from terabytes to gigabytes.\nLet $U'_3$ be the usage in gigabytes.\n$$U'_3 = 20~\\text{TB} \\times \\frac{1000~\\text{GB}}{1~\\text{TB}} = 20,000~\\text{GB}$$\nNow we can calculate the egress cost.\n$$C_3 = U'_3 \\times P_3 = 20,000 \\times 0.05 = 1000$$\nThe egress cost is $C_3 = \\$1000$.\n\n**Total Monthly Cost ($C_{\\text{total}}$)**\nThe total cost is the sum of the individual component costs.\n$$C_{\\text{total}} = C_1 + C_2 + C_3 = 1500 + 2000 + 1000 = 4500$$\nThe total monthly cost is $C_{\\text{total}} = \\$4500$.\n\n**Dominant Cost Driver ($i_{\\text{dom}}$)**\nThe dominant cost driver is the component with the highest monthly cost. We compare the calculated costs:\n- $C_1 = \\$1500$ (Compute)\n- $C_2 = \\$2000$ (Storage)\n- $C_3 = \\$1000$ (Egress)\nThe maximum cost is $\\max(C_1, C_2, C_3) = \\max(1500, 2000, 1000) = 2000$. This corresponds to the storage component, which has the index $i=2$.\nTherefore, the index of the dominant cost driver is $i_{\\text{dom}} = 2$.\n\nThe final answer is presented as a row matrix $\\begin{pmatrix}C_{\\text{total}} & i_{\\text{dom}}\\end{pmatrix}$.\nSubstituting the calculated values, we get $\\begin{pmatrix}4500 & 2\\end{pmatrix}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}4500 & 2\\end{pmatrix}}$$"
        },
        {
            "introduction": "For digital twins integrated with critical cyber-physical systems, high availability is not a feature but a core requirement. This exercise moves beyond static design to the dynamic reality of system reliability, challenging you to quantify the end-to-end availability of a multi-service pipeline. You will apply principles of probability to not only assess the current system's resilience but also to precisely measure the improvement gained from introducing architectural patterns like active-active redundancy .",
            "id": "4208208",
            "problem": "A cloud-hosted digital twin pipeline for a cyber-physical system consists of three sequential services: an ingestion gateway, a stream processing engine, and a visualization and alerting front-end. The twin is considered available if and only if all three services are simultaneously up. Assume the following:\n\n- The steady-state availability of the ingestion gateway is $0.999$, of the stream processor is $0.9995$, and of the visualization front-end is $0.9999$. Steady-state availability is defined as the long-run fraction of time a service is operational, which equals the stationary probability that the service is in its up state under an alternating renewal process model.\n- Service up/down states across services are statistically independent due to disjoint failure domains, and the twin requires the entire sequential path to be operational to serve requests.\n- An architectural change introduces active-active redundancy for the ingestion gateway by deploying two identical, independent instances, each with steady-state availability $0.999$. The twin remains available with respect to the ingestion stage as long as at least one of these two instances is up. Assume negligible switchover and no correlated failure between the two instances.\n\nStarting from the above foundational definitions and assumptions of availability as steady-state up probability and independence of events, compute the original end-to-end availability of the pipeline, compute the new end-to-end availability after introducing active-active redundancy for the ingestion gateway, and then report the improvement factor defined as the ratio of the new end-to-end availability to the original end-to-end availability. Express the final answer as a unitless decimal and round your final answer to six significant figures. Do not use a percentage sign anywhere.",
            "solution": "The problem requires the calculation of an improvement factor in system availability due to an architectural change. We begin by formalizing the system's availability based on the provided definitions.\n\nLet $A_1$, $A_2$, and $A_3$ represent the steady-state availabilities of the ingestion gateway, the stream processing engine, and the visualization front-end, respectively. According to the problem statement, these are given as:\n$A_1 = 0.999$\n$A_2 = 0.9995$\n$A_3 = 0.9999$\n\nThe availability of a component is the probability that it is operational. Let $U_i$ be the event that service $i$ is in its 'up' state. Then, $P(U_i) = A_i$.\n\nFirst, we compute the original end-to-end availability of the pipeline, denoted as $A_{orig}$. The problem states that the pipeline is a sequential system, meaning it is available if and only if all three services are simultaneously operational. The services are also stated to be statistically independent. Therefore, the probability of the entire system being up is the product of the individual service availabilities:\n$$A_{orig} = P(U_1 \\cap U_2 \\cap U_3) = P(U_1) \\times P(U_2) \\times P(U_3)$$\n$$A_{orig} = A_1 \\times A_2 \\times A_3$$\nSubstituting the given values:\n$$A_{orig} = 0.999 \\times 0.9995 \\times 0.9999$$\n\nNext, we consider the architectural change where the ingestion gateway is replaced by two identical, independent instances in an active-active redundant configuration. Let the availability of each gateway instance be $A_{1,inst}$. From the problem, $A_{1,inst} = 0.999$, which is the same as the original $A_1$. The new ingestion stage is available as long as at least one of the two instances is up.\n\nIt is more convenient to calculate the unavailability of this redundant stage. The unavailability of a single instance is $1 - A_{1,inst}$. Since the two instances are independent, the probability that both are simultaneously down (unavailable) is the product of their individual unavailabilities.\n$$P(\\text{ingestion stage is down}) = (1 - A_{1,inst}) \\times (1 - A_{1,inst}) = (1 - A_{1,inst})^2$$\nThe availability of the new ingestion stage, which we denote as $A'_{1}$, is $1$ minus the probability that the stage is down:\n$$A'_{1} = 1 - (1 - A_{1,inst})^2$$\nSubstituting $A_{1,inst} = A_1 = 0.999$:\n$$A'_{1} = 1 - (1 - 0.999)^2 = 1 - (0.001)^2 = 1 - 0.000001 = 0.999999$$\n\nThe new end-to-end availability of the pipeline, $A_{new}$, is then the product of the availabilities of the new ingestion stage, the stream processor, and the front-end. The latter two components remain unchanged.\n$$A_{new} = A'_{1} \\times A_2 \\times A_3$$\n$$A_{new} = (1 - (1 - A_1)^2) \\times A_2 \\times A_3$$\n\nFinally, we need to compute the improvement factor, $F$, which is defined as the ratio of the new end-to-end availability to the original end-to-end availability.\n$$F = \\frac{A_{new}}{A_{orig}}$$\nSubstituting the expressions for $A_{new}$ and $A_{orig}$:\n$$F = \\frac{(1 - (1 - A_1)^2) \\times A_2 \\times A_3}{A_1 \\times A_2 \\times A_3}$$\nThe terms $A_2$ and $A_3$ cancel out, simplifying the expression for the improvement factor significantly:\n$$F = \\frac{1 - (1 - A_1)^2}{A_1}$$\nThis shows that the improvement factor only depends on the availability of the component that was made redundant.\n\nNow, we substitute the numerical value for $A_1$:\n$$F = \\frac{1 - (1 - 0.999)^2}{0.999} = \\frac{1 - (0.001)^2}{0.999} = \\frac{1 - 0.000001}{0.999} = \\frac{0.999999}{0.999}$$\nPerforming the division:\n$$F = 1.001000001001...$$\nThe problem requires the final answer to be rounded to six significant figures. The first six significant figures are $1$, $0$, $0$, $1$, $0$, and $0$. The seventh significant figure is $0$, which is less than $5$, so we round down (i.e., keep the sixth digit as it is).\n$$F \\approx 1.00100$$",
            "answer": "$$\\boxed{1.00100}$$"
        },
        {
            "introduction": "Maintaining a consistent state across geographically distributed replicas is one of the most significant challenges in building scalable digital twins. This practice takes you to the heart of distributed data systems by exploring quorum-based protocols, which balance consistency, latency, and fault tolerance. Starting from fundamental set-theoretic principles, you will derive the classic quorum intersection rules and use them to configure a system that guarantees data integrity while optimizing for low-latency reads .",
            "id": "4208249",
            "problem": "A cloud-hosted digital twin orchestrator for cyber-physical assets replicates its command log across $N$ identical storage replicas using a quorum protocol. A write operation commits after acknowledgments from any $W$ distinct replicas, and a read operation returns the value with the highest version after collecting responses from any $R$ distinct replicas. Each operation selects its contacted replicas arbitrarily from the $N$ replicas. The orchestrator must ensure that the command log provides read-after-write visibility and prevents divergent committed writes for actuations on physical systems. Reads are prioritized for low latency; in this model, lowering $R$ reduces read completion time because a read finishes when the $R$-th fastest contacted replica responds.\n\nStarting only from set-theoretic reasoning about intersections of subsets of a finite set and from the operational definitions above, derive necessary and sufficient conditions on $(R,W,N)$ that ensure both of the following properties hold for all executions:\n- Strong write consistency: any two completed writes must have at least one common replica that acknowledged both writes, and\n- Read-after-write consistency: any completed read invoked after a completed write must intersect the replica set that acknowledged that write, so that the read can return its value.\n\nAdditionally, the orchestrator must remain able to complete both reads and writes in the presence of up to $f=1$ replica failure, meaning it must be possible to form both a read quorum and a write quorum out of the surviving replicas when at most one replica is unavailable.\n\nFor the concrete case $N=5$ and $f=1$, determine the minimal integer value of $R$ that satisfies all derived conditions while minimizing read latency. Provide a brief justification that your chosen $R$ is feasible by exhibiting a compatible $W$. Report only the minimal $R$ as your final answer. No rounding is required. Express the answer as an integer.",
            "solution": "The user has provided a valid problem statement.\n\nThe problem requires deriving necessary and sufficient conditions on the read quorum size $R$, the write quorum size $W$, and the total number of replicas $N$ to ensure two types of consistency and one fault-tolerance property. These conditions are then to be applied to a specific case to find a minimal value for $R$.\n\nLet $S$ be the set of all replicas, with $|S| = N$. A write operation is acknowledged by a subset of replicas $Q_W \\subseteq S$ where $|Q_W| = W$. A read operation collects responses from a subset of replicas $Q_R \\subseteq S$ where $|Q_R| = R$.\n\nFirst, we formalize the three required properties using set-theoretic reasoning.\n\n1.  **Strong write consistency:** This property states that any two completed writes must have at least one common replica. Let $Q_{W1}$ and $Q_{W2}$ be the sets of replicas that acknowledged two arbitrary completed writes. The condition is $Q_{W1} \\cap Q_{W2} \\neq \\emptyset$. To guarantee this for any choice of $Q_{W1}$ and $Q_{W2}$, we consider the worst-case scenario where the intersection is minimal. Using the principle of inclusion-exclusion for the union of these two sets:\n    $$|Q_{W1} \\cup Q_{W2}| = |Q_{W1}| + |Q_{W2}| - |Q_{W1} \\cap Q_{W2}|$$\n    Since the union is a subset of the total set of replicas $S$, its size cannot exceed $N$:\n    $$|Q_{W1} \\cup Q_{W2}| \\le N$$\n    Substituting the known sizes, $|Q_{W1}| = W$ and $|Q_{W2}| = W$:\n    $$N \\ge W + W - |Q_{W1} \\cap Q_{W2}|$$\n    Rearranging for the size of the intersection, we get:\n    $$|Q_{W1} \\cap Q_{W2}| \\ge 2W - N$$\n    To guarantee that the intersection is non-empty, its minimum possible size must be at least $1$.\n    $$2W - N \\ge 1 \\implies 2W > N$$\n    This is the necessary and sufficient condition for strong write consistency.\n\n2.  **Read-after-write consistency:** This property requires that any completed read intersects the replica set of any previously completed write. Let $Q_W$ be the replica set for a completed write and $Q_R$ be the replica set for a subsequent read. The condition is $Q_R \\cap Q_W \\neq \\emptyset$. The reasoning is analogous to the strong write consistency case:\n    $$|Q_R \\cup Q_W| = |Q_R| + |Q_W| - |Q_R \\cap Q_W| \\le N$$\n    Substituting $|Q_R| = R$ and $|Q_W| = W$:\n    $$N \\ge R + W - |Q_R \\cap Q_W|$$\n    $$|Q_R \\cap Q_W| \\ge R + W - N$$\n    To guarantee a non-empty intersection, we require:\n    $$R + W - N \\ge 1 \\implies R + W > N$$\n    This is the necessary and sufficient condition for read-after-write consistency.\n\n3.  **Fault tolerance:** The system must be able to complete both read and write operations in the presence of up to $f$ failures. With $f$ failures, the number of available replicas is $N-f$. To be able to form a write quorum, the number of available replicas must be at least $W$. Similarly, to form a read quorum, the number of available replicas must be at least $R$. This gives us two conditions:\n    $$W \\le N - f$$\n    $$R \\le N - f$$\n\nWe are given the concrete case where $N=5$ and $f=1$. The goal is to find the minimal integer value of $R$. We substitute these values into the derived inequalities:\n(i) $2W > 5$\n(ii) $R + W > 5$\n(iii) $W \\le 5 - 1 \\implies W \\le 4$\n(iv) $R \\le 5 - 1 \\implies R \\le 4$\n\nFrom inequality (i), since $W$ must be an integer, we have $W \\ge 3$.\nCombining this with inequality (iii), we find the possible integer values for $W$:\n$$3 \\le W \\le 4$$\nSo, $W$ can be either $3$ or $4$.\n\nThe problem states that read latency is minimized by lowering $R$. We seek the minimal integer $R$ that satisfies all conditions for some valid choice of $W$. We analyze the two possible cases for $W$.\n\nCase 1: $W=3$.\nWe substitute $W=3$ into inequality (ii):\n$$R + 3 > 5 \\implies R > 2$$\nSince $R$ is an integer, this means $R \\ge 3$. Inequality (iv) requires $R \\le 4$. Thus, for $W=3$, the possible values for $R$ are $3$ and $4$. The minimum value for $R$ in this case is $3$. The pair $(R=3, W=3)$ is a valid configuration.\n\nCase 2: $W=4$.\nWe substitute $W=4$ into inequality (ii):\n$$R + 4 > 5 \\implies R > 1$$\nSince $R$ is an integer, this means $R \\ge 2$. Inequality (iv) requires $R \\le 4$. Thus, for $W=4$, the possible values for $R$ are $2$, $3$, and $4$. The minimum value for $R$ in this case is $2$. The pair $(R=2, W=4)$ is a valid configuration.\n\nTo find the overall minimal integer value of $R$, we compare the minimums from both valid cases. The minimum of $\\{3, 2\\}$ is $2$.\nTherefore, the minimal integer value of $R$ that satisfies all conditions is $2$. This is feasible because it can be achieved with a compatible write quorum size, for example, $W=4$. Let's verify the pair $(R=2, W=4)$ with $N=5$ and $f=1$:\n(i) $2(4) > 5 \\implies 8 > 5$. (Satisfied)\n(ii) $2 + 4 > 5 \\implies 6 > 5$. (Satisfied)\n(iii) $4 \\le 5 - 1 \\implies 4 \\le 4$. (Satisfied)\n(iv) $2 \\le 5 - 1 \\implies 2 \\le 4$. (Satisfied)\nAll conditions hold. We must also check that $R=1$ is not possible. If $R=1$, inequality (ii) gives $1+W>5 \\implies W>4$. However, inequality (iii) requires $W \\le 4$. These conditions are contradictory, so $R=1$ is not a feasible solution.\n\nThe minimal integer value of $R$ is $2$.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}