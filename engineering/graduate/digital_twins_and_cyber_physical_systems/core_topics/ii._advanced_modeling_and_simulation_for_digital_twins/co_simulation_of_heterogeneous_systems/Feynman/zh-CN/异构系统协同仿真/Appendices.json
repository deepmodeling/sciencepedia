{
    "hands_on_practices": [
        {
            "introduction": "协同仿真的核心挑战之一是确保数值稳定性，尤其是在采用显式耦合方案时。这个练习提供了一个基础但至关重要的实践，通过分析一个简单的线性电路系统的协同仿真来揭示稳定性的本质。通过推导雅可比（Jacobi）方案下的最大稳定宏观步长，您将掌握如何运用特征值分析来量化由系统分区和离散化引入的潜在不稳定性，这是设计和验证协同仿真工作流的一项基本技能。",
            "id": "4208719",
            "problem": "一个线性阻容网络的数字孪生被划分为两个异构仿真器，它们使用宏步长为 $H$ 的雅可比方案进行协同仿真。子系统 $1$ 由一个到地的电容 $C_{1}$ 和一个到地的电导 $G_{1}$ 组成，其边界节点电压为 $V_{1}(t)$。子系统 $2$ 由一个到地的电容 $C_{2}$ 和一个到地的电导 $G_{2}$ 组成，其边界节点电压为 $V_{2}(t)$。两个子系统通过其边界节点之间的一个电导 $G_{c}$ 相互连接，使得连续时间节点动态遵循基尔霍夫电流定律 (KCL)。由于零阶保持交换，每个仿真器在每个宏步长内对其子系统进行积分，同时邻居的边界电压保持恒定。每个子系统都使用显式欧拉法在宏步长上进行推进。\n\n从 KCL 和显式欧拉法的定义出发，构建一个离散时间互连映射，将边界电压从 $t_{n}$ 时刻的 $\\begin{pmatrix} V_{1}^{n} \\\\ V_{2}^{n} \\end{pmatrix}$ 推进到 $t_{n+1} = t_{n} + H$ 时刻的 $\\begin{pmatrix} V_{1}^{n+1} \\\\ V_{2}^{n+1} \\end{pmatrix}$。使用这个 $2 \\times 2$ 离散更新的特征值分析，推导出最大的宏步长 $H_{\\max}$，使得更新矩阵的谱半径严格小于 $1$。将您的最终答案表示为关于 $C_{1}$、$C_{2}$、$G_{1}$、$G_{2}$ 和 $G_{c}$ 的 $H_{\\max}$ 的单一闭式解析表达式。以秒为单位表示 $H_{\\max}$。不要在方框内的最终答案中包含单位。",
            "solution": "问题陈述经评估是科学上合理的、适定的和客观的。它描述了线性时不变系统协同仿真方法的数值分析中的一个标准问题。所有必要的信息都已提供，问题没有矛盾或歧义。因此，该问题是有效的，并将推导出一个解。\n\n第一步是利用两个边界节点处的基尔霍夫电流定律 (KCL) 建立控制系统动态的连续时间常微分方程 (ODE)。\n\n在节点 $1$，流出节点的电流总和必须为零。流过电容 $C_1$ 的电流是 $C_1 \\frac{dV_1}{dt}$，流过到地电导 $G_1$ 的电流是 $G_1 V_1$，流过耦合电导 $G_c$ 的电流是 $G_c(V_1 - V_2)$。在节点 $1$ 应用 KCL：\n$$ C_1 \\frac{dV_1}{dt} + G_1 V_1 + G_c (V_1 - V_2) = 0 $$\n重新整理得到 $\\frac{dV_1}{dt}$：\n$$ \\frac{dV_1}{dt} = - \\frac{G_1 + G_c}{C_1} V_1 + \\frac{G_c}{C_1} V_2 $$\n\n类似地，在节点 $2$，流出节点的电流总和必须为零。流过电容 $C_2$ 的电流是 $C_2 \\frac{dV_2}{dt}$，流过到地电导 $G_2$ 的电流是 $G_2 V_2$，流过耦合电导 $G_c$ 的电流是 $G_c(V_2 - V_1)$。在节点 $2$ 应用 KCL：\n$$ C_2 \\frac{dV_2}{dt} + G_2 V_2 + G_c (V_2 - V_1) = 0 $$\n重新整理得到 $\\frac{dV_2}{dt}$：\n$$ \\frac{dV_2}{dt} = \\frac{G_c}{C_2} V_1 - \\frac{G_2 + G_c}{C_2} V_2 $$\n\n问题指定了宏步长为 $H$ 的雅可比协同仿真方案。在此方案中，每个子系统在区间 $[t_n, t_{n+1}]$ 上进行积分，使用的是邻近子系统在区间开始时 $t_n$ 的边界值。这是对耦合变量的零阶保持 (ZOH)。每个子系统内部使用的积分器是显式欧拉法。\n\n对于子系统 $1$，在 $[t_n, t_{n+1}]$ 上要积分的 ODE 将 $V_2$ 视为等于 $V_2^n = V_2(t_n)$ 的常数：\n$$ \\frac{dV_1}{dt} = - \\frac{G_1 + G_c}{C_1} V_1 + \\frac{G_c}{C_1} V_2^n $$\n应用显式欧拉法 $y_{k+1} = y_k + h f(t_k, y_k)$，步长为 $H = t_{n+1} - t_n$：\n$$ V_1^{n+1} = V_1^n + H \\left( - \\frac{G_1 + G_c}{C_1} V_1^n + \\frac{G_c}{C_1} V_2^n \\right) $$\n$$ V_1^{n+1} = \\left( 1 - H \\frac{G_1 + G_c}{C_1} \\right) V_1^n + \\left( H \\frac{G_c}{C_1} \\right) V_2^n $$\n\n对于子系统 $2$，要积分的 ODE 将 $V_1$ 视为等于 $V_1^n = V_1(t_n)$ 的常数：\n$$ \\frac{dV_2}{dt} = \\frac{G_c}{C_2} V_1^n - \\frac{G_2 + G_c}{C_2} V_2 $$\n应用步长为 $H$ 的显式欧拉法：\n$$ V_2^{n+1} = V_2^n + H \\left( \\frac{G_c}{C_2} V_1^n - \\frac{G_2 + G_c}{C_2} V_2^n \\right) $$\n$$ V_2^{n+1} = \\left( H \\frac{G_c}{C_2} \\right) V_1^n + \\left( 1 - H \\frac{G_2 + G_c}{C_2} \\right) V_2^n $$\n\n这两个离散时间方程可以写成矩阵形式，它定义了从时间 $t_n$ 的状态到时间 $t_{n+1}$ 的状态的互连映射：\n$$ \\begin{pmatrix} V_1^{n+1} \\\\ V_2^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - H \\frac{G_1 + G_c}{C_1} & H \\frac{G_c}{C_1} \\\\ H \\frac{G_c}{C_2} & 1 - H \\frac{G_2 + G_c}{C_2} \\end{pmatrix} \\begin{pmatrix} V_1^n \\\\ V_2^n \\end{pmatrix} $$\n设更新矩阵为 $M$。协同仿真是稳定的，当且仅当 $M$ 的谱半径 $\\rho(M)$ 严格小于 $1$。谱半径是 $M$ 的特征值的最大绝对值。我们通过求解特征方程 $\\det(M - \\lambda I) = 0$ 来找到 $M$ 的特征值 $\\lambda$。\n为简化符号，令：\n$a = \\frac{G_1+G_c}{C_1}$，$b = \\frac{G_c}{C_1}$，$c = \\frac{G_c}{C_2}$，$d = \\frac{G_2+G_c}{C_2}$。矩阵 $M$ 为：\n$$ M = \\begin{pmatrix} 1 - Ha & Hb \\\\ Hc & 1 - Hd \\end{pmatrix} $$\n特征方程是：\n$$ \\det \\begin{pmatrix} 1 - Ha - \\lambda & Hb \\\\ Hc & 1 - Hd - \\lambda \\end{pmatrix} = 0 $$\n$$ (1 - Ha - \\lambda)(1 - Hd - \\lambda) - H^2bc = 0 $$\n$$ \\lambda^2 - (2 - H(a+d))\\lambda + (1 - H(a+d) + H^2ad - H^2bc) = 0 $$\n$\\lambda$ 的解由二次公式给出：\n$$ \\lambda = \\frac{2 - H(a+d) \\pm \\sqrt{(2 - H(a+d))^2 - 4(1 - H(a+d) + H^2(ad - bc))}}{2} $$\n平方根下的项可以简化为：\n$$ (4 - 4H(a+d) + H^2(a+d)^2) - (4 - 4H(a+d) + 4H^2(ad - bc)) = H^2((a+d)^2 - 4ad + 4bc) = H^2((a-d)^2 + 4bc) $$\n所以，特征值为：\n$$ \\lambda = \\frac{2 - H(a+d) \\pm H\\sqrt{(a-d)^2 + 4bc}}{2} $$\n$$ \\lambda = 1 - \\frac{H}{2}(a+d) \\pm \\frac{H}{2}\\sqrt{(a-d)^2 + 4bc} $$\n由于所有物理参数 $C_1, C_2, G_1, G_2, G_c$ 都是非负的，所以项 $a, b, c, d$ 也是非负的。平方根下的项是正的，因此特征值是实数。令 $k = \\sqrt{(a-d)^2 + 4bc}$。\n两个特征值是 $\\lambda_1 = 1 - \\frac{H}{2}(a+d-k)$ 和 $\\lambda_2 = 1 - \\frac{H}{2}(a+d+k)$。\n为了稳定性，我们要求对于 $i=1, 2$，有 $|\\lambda_i| < 1$，对于实数特征值，这意味着 $-1 < \\lambda_i < 1$。\n\n我们可以证明 $a+d-k > 0$，因为 $(a+d)^2 = (a-d)^2+4ad > (a-d)^2+4bc = k^2$（由于 $ad>bc$）。因此，$a+d>k$。\n这意味着对于 $H>0$，$\\frac{H}{2}(a+d-k)$ 和 $\\frac{H}{2}(a+d+k)$ 都是正数，因此两个特征值都小于 $1$。稳定性受下界限制，即 $\\lambda_i > -1$。\n\n对 $\\lambda_1$ 的条件是：\n$$ 1 - \\frac{H}{2}(a+d-k) > -1 \\implies 2 > \\frac{H}{2}(a+d-k) \\implies H < \\frac{4}{a+d-k} $$\n对 $\\lambda_2$ 的条件是：\n$$ 1 - \\frac{H}{2}(a+d+k) > -1 \\implies 2 > \\frac{H}{2}(a+d+k) \\implies H < \\frac{4}{a+d+k} $$\n由于 $k>0$，我们有 $a+d+k > a+d-k$，这意味着 $\\frac{4}{a+d+k} < \\frac{4}{a+d-k}$。$H$ 的稳定域必须同时满足这两个不等式，因此它受到更严格的那个的限制。因此，最大的宏步长 $H_{\\max}$ 由两个界限中较小的一个给出：\n$$ H_{\\max} = \\frac{4}{a+d+k} $$\n将 $a, d$ 和 $k$ 的表达式代回：\n$$ H_{\\max} = \\frac{4}{(a+d) + \\sqrt{(a-d)^2 + 4bc}} $$\n$$ H_{\\max} = \\frac{4}{\\left(\\frac{G_1+G_c}{C_1} + \\frac{G_2+G_c}{C_2}\\right) + \\sqrt{\\left(\\frac{G_1+G_c}{C_1} - \\frac{G_2+G_c}{C_2}\\right)^2 + 4\\left(\\frac{G_c}{C_1}\\right)\\left(\\frac{G_c}{C_2}\\right)}} $$\n这个表达式可以写成：\n$$ H_{\\max} = \\frac{4}{\\left(\\frac{G_1+G_c}{C_1} + \\frac{G_2+G_c}{C_2}\\right) + \\sqrt{\\left(\\frac{G_1+G_c}{C_1} - \\frac{G_2+G_c}{C_2}\\right)^2 + \\frac{4G_c^2}{C_1 C_2}}} $$\n这是最大稳定宏步长 $H_{\\max}$ 的最终闭式表达式。$G/C$ 的单位是 $1/s$，因此 $H_{\\max}$ 的表达式正确地得出了秒的单位。",
            "answer": "$$\\boxed{\\frac{4}{\\left(\\frac{G_{1}+G_{c}}{C_{1}} + \\frac{G_{2}+G_{c}}{C_{2}}\\right) + \\sqrt{\\left(\\frac{G_{1}+G_{c}}{C_{1}} - \\frac{G_{2}+G_{c}}{C_{2}}\\right)^{2} + \\frac{4G_{c}^{2}}{C_{1} C_{2}}}}}$$"
        },
        {
            "introduction": "当互连的子系统之间存在瞬时依赖关系（即直接馈通）时，协同仿真中会出现代数环路，这使得显式耦合方案失效。本练习将引导您解决这一高级挑战，通过构建牛顿迭代法来求解这些非线性方程组。掌握如何利用接口雅可比矩阵来迭代求解每个宏观步长中的一致性问题，对于精确仿真紧耦合系统至关重要，并能显著提高求解器的鲁棒性和效率。",
            "id": "4208753",
            "problem": "考虑在数字孪生协同仿真框架中，两个分别表示为子系统 $\\mathcal{A}$ 和子系统 $\\mathcal{B}$ 的异构仿真器的协同仿真，它们在每个宏观步长通过一个直接馈通的代数环路耦合。在一个固定的宏观步长 $k$，每个子系统提供一个瞬时接口输出，该输出取决于当前的接口输入及其内部宏观步长状态，建模为 $y_{\\mathcal{A}} = \\phi_{\\mathcal{A}}(u_{\\mathcal{A}}; x_{\\mathcal{A}}(k))$ 和 $y_{\\mathcal{B}} = \\phi_{\\mathcal{B}}(u_{\\mathcal{B}}; x_{\\mathcal{B}}(k))$，其中 $x_{\\mathcal{A}}(k)$ 和 $x_{\\mathcal{B}}(k)$ 是此宏观步长的固定参数。代数环路闭合条件为 $u_{\\mathcal{A}} = y_{\\mathcal{B}}$ 和 $u_{\\mathcal{B}} = y_{\\mathcal{A}}$。假设 $\\phi_{\\mathcal{A}}$ 和 $\\phi_{\\mathcal{B}}$ 在所求一致性解附近对其输入参数是连续可微的。\n\n定义残差映射\n$$\nF(y_{\\mathcal{A}}, y_{\\mathcal{B}}) \\;=\\; \\begin{pmatrix}\ny_{\\mathcal{A}} - \\phi_{\\mathcal{A}}(y_{\\mathcal{B}}; x_{\\mathcal{A}}(k)) \\\\\ny_{\\mathcal{B}} - \\phi_{\\mathcal{B}}(y_{\\mathcal{A}}; x_{\\mathcal{B}}(k))\n\\end{pmatrix},\n$$\n及其接口雅可比矩阵\n$$\nJ(y_{\\mathcal{A}}, y_{\\mathcal{B}}) \\;=\\; \\frac{\\partial F}{\\partial (y_{\\mathcal{A}}, y_{\\mathcal{B}})} \\;=\\; \\begin{pmatrix}\n1 & -\\dfrac{\\partial \\phi_{\\mathcal{A}}}{\\partial u_{\\mathcal{A}}}(y_{\\mathcal{B}}; x_{\\mathcal{A}}(k)) \\\\\n-\\dfrac{\\partial \\phi_{\\mathcal{B}}}{\\partial u_{\\mathcal{B}}}(y_{\\mathcal{A}}; x_{\\mathcal{B}}(k)) & 1\n\\end{pmatrix}.\n$$\n构建使用接口雅可比矩阵在每个宏观步长求解代数环路的牛顿迭代，通过推导在通用迭代次数 $m$ 下牛顿步长 $\\Delta y = (\\Delta y_{\\mathcal{A}}, \\Delta y_{\\mathcal{B}})$ 的闭式解析表达式，该步长求解\n$$\nJ(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)}) \\, \\Delta y^{(m)} \\;=\\; -F(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)}).\n$$\n引入简写\n$$\nF_1 \\;=\\; y_{\\mathcal{A}}^{(m)} - \\phi_{\\mathcal{A}}(y_{\\mathcal{B}}^{(m)}; x_{\\mathcal{A}}(k)), \\quad\nF_2 \\;=\\; y_{\\mathcal{B}}^{(m)} - \\phi_{\\mathcal{B}}(y_{\\mathcal{A}}^{(m)}; x_{\\mathcal{B}}(k)),\n$$\n$$\n\\alpha \\;=\\; \\left.\\dfrac{\\partial \\phi_{\\mathcal{A}}}{\\partial u_{\\mathcal{A}}}\\right|_{u_{\\mathcal{A}} = y_{\\mathcal{B}}^{(m)}} \\!, \\quad\n\\beta \\;=\\; \\left.\\dfrac{\\partial \\phi_{\\mathcal{B}}}{\\partial u_{\\mathcal{B}}}\\right|_{u_{\\mathcal{B}} = y_{\\mathcal{A}}^{(m)}}.\n$$\n将牛顿步长 $\\Delta y^{(m)}$ 用 $F_1$, $F_2$, $\\alpha$ 和 $\\beta$ 表示。\n\n此外，根据牛顿法的基本原理，陈述在该协同仿真背景下，代数环路求解的迭代过程呈现局部二次收敛的条件，需要考虑接口雅可比矩阵的平滑性和可逆性，以及初始猜测值与一致性解的接近程度。\n\n以行矩阵的形式，用 $F_1$、$F_2$、$\\alpha$ 和 $\\beta$ 写出牛顿步长向量 $\\Delta y^{(m)}$ 的单个解析表达式。此表达式不要求数值近似或四舍五入，也不适用任何物理单位。",
            "solution": "在进行求解之前，对问题陈述的有效性进行严格评估。\n\n### 步骤 1：提取已知条件\n- 子系统模型：$y_{\\mathcal{A}} = \\phi_{\\mathcal{A}}(u_{\\mathcal{A}}; x_{\\mathcal{A}}(k))$ 和 $y_{\\mathcal{B}} = \\phi_{\\mathcal{B}}(u_{\\mathcal{B}}; x_{\\mathcal{B}}(k))$。\n- 状态参数：$x_{\\mathcal{A}}(k)$ 和 $x_{\\mathcal{B}}(k)$ 在宏观步长 $k$ 是固定的。\n- 代数环路闭合：$u_{\\mathcal{A}} = y_{\\mathcal{B}}$ 和 $u_{\\mathcal{B}} = y_{\\mathcal{A}}$。\n- 可微性：$\\phi_{\\mathcal{A}}$ 和 $\\phi_{\\mathcal{B}}$ 对其输入参数是连续可微的。\n- 残差映射：\n$$\nF(y_{\\mathcal{A}}, y_{\\mathcal{B}}) \\;=\\; \\begin{pmatrix}\ny_{\\mathcal{A}} - \\phi_{\\mathcal{A}}(y_{\\mathcal{B}}; x_{\\mathcal{A}}(k)) \\\\\ny_{\\mathcal{B}} - \\phi_{\\mathcal{B}}(y_{\\mathcal{A}}; x_{\\mathcal{B}}(k))\n\\end{pmatrix}\n$$\n- 接口雅可比矩阵：\n$$\nJ(y_{\\mathcal{A}}, y_{\\mathcal{B}}) \\;=\\; \\frac{\\partial F}{\\partial (y_{\\mathcal{A}}, y_{\\mathcal{B}})} \\;=\\; \\begin{pmatrix}\n1 & -\\dfrac{\\partial \\phi_{\\mathcal{A}}}{\\partial u_{\\mathcal{A}}}(y_{\\mathcal{B}}; x_{\\mathcal{A}}(k)) \\\\\n-\\dfrac{\\partial \\phi_{\\mathcal{B}}}{\\partial u_{\\mathcal{B}}}(y_{\\mathcal{A}}; x_{\\mathcal{B}}(k)) & 1\n\\end{pmatrix}\n$$\n- 牛顿迭代方程：$J(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)}) \\, \\Delta y^{(m)} \\;=\\; -F(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)})$。\n- 迭代次数 m 时的简写符号：\n$$ F_1 \\;=\\; y_{\\mathcal{A}}^{(m)} - \\phi_{\\mathcal{A}}(y_{\\mathcal{B}}^{(m)}; x_{\\mathcal{A}}(k)) $$\n$$ F_2 \\;=\\; y_{\\mathcal{B}}^{(m)} - \\phi_{\\mathcal{B}}(y_{\\mathcal{A}}^{(m)}; x_{\\mathcal{B}}(k)) $$\n$$ \\alpha \\;=\\; \\left.\\dfrac{\\partial \\phi_{\\mathcal{A}}}{\\partial u_{\\mathcal{A}}}\\right|_{u_{\\mathcal{A}} = y_{\\mathcal{B}}^{(m)}} $$\n$$ \\beta \\;=\\; \\left.\\dfrac{\\partial \\phi_{\\mathcal{B}}}{\\partial u_{\\mathcal{B}}}\\right|_{u_{\\mathcal{B}} = y_{\\mathcal{A}}^{(m)}} $$\n- 任务：推导牛顿步长 $\\Delta y^{(m)} = (\\Delta y_{\\mathcal{A}}^{(m)}, \\Delta y_{\\mathcal{B}}^{(m)})$ 的闭式解析表达式，用 $F_1$, $F_2$, $\\alpha$ 和 $\\beta$ 表示。陈述局部二次收敛的条件。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了两个仿真器之间标准的 Gauss-Seidel 或类 Jacobi 耦合，从而产生一个代数环路。使用牛顿法（具体来说，如果雅可比矩阵不是在每个微观步长都更新，则为准牛顿法，但此处是 Newton-Raphson 法）来求解此类非线性代数方程组，是耦合系统数值分析中的一种基本且广泛应用的技术，尤其是在协同仿真和微分代数方程（DAE）的背景下。其公式在数学上是合理的。\n2.  **适定性：** 该问题是适定的。它要求推导一个特定的数学表达式，并陈述已有完善理论的收敛条件，这两者都由给定的定义唯一确定。\n3.  **客观性：** 语言正式、精确且完全客观。\n4.  **完整性和一致性：** 所有必要的函数（$F$）、矩阵（$J$）、变量（$\\Delta y$）和简写符号（$\\alpha, \\beta, F_1, F_2$）都已明确定义。整个设置是内部一致的。\n5.  **未检测到其他缺陷：** 该问题并非不切实际、不适定、微不足道或无法验证。这是一个应用于工程仿真的数值方法中的标准、正式问题。\n\n### 步骤 3：结论与行动\n**该问题被判定为有效。** 将提供完整解答。\n\n任务是求解由牛顿迭代定义的关于步长 $\\Delta y^{(m)}$ 的线性系统。该系统由下式给出：\n$$\nJ(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)}) \\, \\Delta y^{(m)} \\;=\\; -F(y_{\\mathcal{A}}^{(m)}, y_{\\mathcal{B}}^{(m)})\n$$\n使用所提供的简写符号，该系统可以写为：\n$$\n\\begin{pmatrix}\n1 & -\\alpha \\\\\n-\\beta & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Delta y_{\\mathcal{A}}^{(m)} \\\\\n\\Delta y_{\\mathcal{B}}^{(m)}\n\\end{pmatrix}\n\\;=\\;\n-\n\\begin{pmatrix}\nF_1 \\\\\nF_2\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n-F_1 \\\\\n-F_2\n\\end{pmatrix}\n$$\n为了求出牛顿步长向量 $\\Delta y^{(m)}$，我们必须求解这个 $2 \\times 2$ 线性系统。最直接的方法是求雅可比矩阵 $J$ 的逆。$J$ 的行列式为：\n$$\n\\det(J) = (1)(1) - (-\\alpha)(-\\beta) = 1 - \\alpha\\beta\n$$\n$J$ 的逆（记为 $J^{-1}$）存在的充要条件是 $\\det(J) \\neq 0$，即 $1 - \\alpha\\beta \\neq 0$。假设此条件成立，一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。将此公式应用于 $J$：\n$$\nJ^{-1} = \\frac{1}{1 - \\alpha\\beta}\n\\begin{pmatrix}\n1 & \\alpha \\\\\n\\beta & 1\n\\end{pmatrix}\n$$\n现在，我们可以求解 $\\Delta y^{(m)}$：\n$$\n\\Delta y^{(m)} = J^{-1} \\left( -F^{(m)} \\right)\n$$\n$$\n\\begin{pmatrix}\n\\Delta y_{\\mathcal{A}}^{(m)} \\\\\n\\Delta y_{\\mathcal{B}}^{(m)}\n\\end{pmatrix}\n\\;=\\;\n\\frac{1}{1 - \\alpha\\beta}\n\\begin{pmatrix}\n1 & \\alpha \\\\\n\\beta & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n-F_1 \\\\\n-F_2\n\\end{pmatrix}\n$$\n执行矩阵-向量乘法，得到牛顿步长的各个分量：\n$$\n\\Delta y_{\\mathcal{A}}^{(m)} = \\frac{1}{1 - \\alpha\\beta} \\left( (1)(-F_1) + (\\alpha)(-F_2) \\right) = \\frac{-F_1 - \\alpha F_2}{1 - \\alpha\\beta} = -\\frac{F_1 + \\alpha F_2}{1 - \\alpha\\beta}\n$$\n$$\n\\Delta y_{\\mathcal{B}}^{(m)} = \\frac{1}{1 - \\alpha\\beta} \\left( (\\beta)(-F_1) + (1)(-F_2) \\right) = \\frac{-\\beta F_1 - F_2}{1 - \\alpha\\beta} = -\\frac{\\beta F_1 + F_2}{1 - \\alpha\\beta}\n$$\n因此，牛顿步长向量为 $\\Delta y^{(m)} = (\\Delta y_{\\mathcal{A}}^{(m)}, \\Delta y_{\\mathcal{B}}^{(m)})$。\n\n问题的第二部分要求给出牛顿迭代局部二次收敛的条件。设代数环路的一致性解为 $y^* = (y_{\\mathcal{A}}^*, y_{\\mathcal{B}}^*)$，其中 $F(y^*) = 0$。牛顿法的一般理论为收敛到根 $y^*$ 的局部二次收敛建立了以下条件：\n\n1.  **足够的平滑性：** 函数 $F$ 必须在解 $y^*$ 的一个开邻域内是二次连续可微的（即属于 $C^2$ 类）。在本问题的背景下，$F$ 的分量是 $F_1 = y_{\\mathcal{A}} - \\phi_{\\mathcal{A}}(y_{\\mathcal{B}})$ 和 $F_2 = y_{\\mathcal{B}} - \\phi_{\\mathcal{B}}(y_{\\mathcal{A}})$。$F$ 的一阶导数构成了雅可比矩阵 $J$，其中包含 $\\phi_{\\mathcal{A}}$ 和 $\\phi_{\\mathcal{B}}$ 的一阶导数。为了使 $F$ 属于 $C^2$ 类， $F$ 的二阶导数必须是连续的。这要求接口函数 $\\phi_{\\mathcal{A}}(u_{\\mathcal{A}})$ 和 $\\phi_{\\mathcal{B}}(u_{\\mathcal{B}})$ 在解的邻域内对其输入是二次连续可微的。\n\n2.  **解处的雅可比矩阵非奇异：** 接口雅可比矩阵 $J(y)$ 在解 $y^*$ 处必须是可逆的（非奇异的）。如前所计算，行列式为 $\\det(J) = 1 - \\alpha\\beta$。在解 $y^*$ 处，此条件变为 $1 - \\alpha^*\\beta^* \\neq 0$，其中 $\\alpha^*$ 和 $\\beta^*$ 是在解处计算的接口增益。物理上，这意味着两个子系统的直接馈通增益之积不能等于 $1$。乘积为 $1$ 对应于一个单位增益的不稳定正反馈环路，导致系统奇异。\n\n3.  **足够接近的初始猜测值：** 迭代的初始猜测值 $y^{(0)} = (y_{\\mathcal{A}}^{(0)}, y_{\\mathcal{B}}^{(0)})$ 必须足够接近真实解 $y^*$。这意味着 $y^{(0)}$ 必须位于 $y^*$ 周围一个特定的“吸引盆”内，在该区域内收敛性得到保证。该区域的大小取决于 $F$ 及其在 $y^*$ 附近的导数的性质。\n\n如果这三个条件都得到满足，由牛顿法更新规则 $y^{(m+1)} = y^{(m)} + \\Delta y^{(m)}$ 生成的迭代序列 $\\{y^{(m)}\\}$ 将以二次速率收敛到解 $y^*$。这意味着存在一个常数 $C$，使得对于所有足够大的 $m$，都有 $\\|y^{(m+1)} - y^*\\| \\le C \\|y^{(m)} - y^*\\|^2$ 成立，其中 $\\|\\cdot\\|$ 是一个向量范数。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{F_1 + \\alpha F_2}{1 - \\alpha \\beta} & -\\frac{\\beta F_1 + F_2}{1 - \\alpha \\beta} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在包含连续动态和离散事件的混合系统协同仿真中，确保仿真的正确性不仅意味着数值稳定，还必须保证不会错过关键的事件。这个练习将您的注意力从连续状态的演化转移到事件检测的可靠性上，这是一个在信息物理系统中普遍存在的挑战。通过利用状态导数的界限和事件函数的利普希茨（Lipschitz）常数来推导一个安全的宏观步长，您将学会如何从理论上保证在通信点之间不会遗漏任何零点穿越事件，从而确保混合系统仿真的有效性。",
            "id": "4208801",
            "problem": "考虑一个信息物理系统数字孪生中的异构系统协同仿真，其中一个连续时间常微分方程（ODE）子系统和一个离散事件子系统通过宏步长通信进行耦合。连续时间子系统由初值问题 $\\dot{x}(t) = f(x(t), u(t), t)$ 描述，其状态为 $x(t) \\in \\mathbb{R}^{n}$，输入 $u(t)$ 在每个宏步长内保持恒定。当事件保护函数 $g(x,t)$ 过零时，即 $g(x(t), t)$ 的符号发生改变时，离散事件子系统会触发一个事件。\n\n假设对于从时间 $t_{k}$ 开始的当前宏步长，在某个紧致、前向不变的域上，以下基本性质成立：\n- ODE 子系统为状态时间导数提供一个一致界：对于所有 $t \\in [t_{k}, t_{k} + H]$，都有 $\\|\\dot{x}(t)\\| \\leq B_{x}$。\n- 事件保护函数 $g(x,t)$ 关于状态和时间分别是利普希茨连续的，利普希茨常数分别为 $L_{x} \\geq 0$ 和 $L_{t} \\geq 0$，因此对于域中所有的 $(x,t)$ 和 $(y,s)$，有 $|g(x,t) - g(y,s)| \\leq L_{x}\\|x - y\\| + L_{t}|t - s|$。\n- 在通信时刻 $t_{k}$，已知状态 $x_{k} := x(t_{k})$ 得到的保护函数值 $g_{k} := g(x_{k}, t_{k}) \\neq 0$ 是非零的。\n\n你的任务是确定一个安全的宏步长 $H$，以保证在这些假设下，当仅使用宏步长端点处 $g$ 的边界评估来进行事件检测时，在开区间 $(t_{k}, t_{k} + H)$ 内不会错过 $g(x(t), t)$ 的任何过零点。从给定的界和定义出发，推导一个关于 $H$ 的最大阈值的解析表达式，该表达式保证保护函数在区间内不会过零，并且纯粹用 $g_{k}$、$B_{x}$、$L_{x}$ 和 $L_{t}$ 表示。\n\n以单个闭式表达式的形式提供最终答案。不需要进行数值计算。",
            "solution": "该问题要求为一个协同仿真框架推导一个安全的宏步长 $H$。在此背景下，安全意味着保证在开时间区间 $(t_{k}, t_{k} + H)$ 内不会错过事件保护函数 $g(x(t), t)$ 的任何过零点。系统的状态是 $x(t)$，仿真从时间 $t_{k}$ 开始以宏步长进行。我们已知步长开始时的状态 $x_{k} = x(t_{k})$ 和保护函数值 $g_{k} = g(x_{k}, t_{k})$，以及关键条件 $g_{k} \\neq 0$。\n\n如果函数 $g(x(t), t)$ 在某个时间 $t \\in (t_k, t_k+H)$ 的符号与 $g_{k}$ 的符号不同，那么就错过了一个过零点。根据介值定理，符号的改变意味着函数必定在区间内的某个点穿过了零。为保证不错过任何过零点，我们必须确保对于开区间 $(t_k, t_k+H)$ 内的所有 $t$，保护函数值的变化量 $|g(x(t), t) - g_{k}|$ 严格小于其初始时与零的距离，即 $|g_{k}|$。\n\n让我们为任意 $t \\in (t_{k}, t_{k} + H)$ 的变化量 $|g(x(t), t) - g_{k}|$ 建立一个上界。我们已知保护函数 $g$ 对其两个参数，状态 $x$ 和时间 $t$，都是利普希茨连续的，相应的利普希茨常数分别为 $L_{x} \\ge 0$ 和 $L_{t} \\ge 0$。将利普希茨连续性的定义应用于点 $(x(t), t)$ 和 $(x_k, t_k) = (x(t_k), t_k)$，我们得到：\n$$|g(x(t), t) - g(x_{k}, t_{k})| \\leq L_{x}\\|x(t) - x_{k}\\| + L_{t}|t - t_{k}|$$\n由于 $t > t_{k}$，我们可以写成 $|t - t_{k}| = t - t_{k}$。设 $\\delta t = t-t_k$。不等式变为：\n$$|g(x(t), t) - g_{k}| \\leq L_{x}\\|x(t) - x(t_k)\\| + L_{t}(t - t_{k})$$\n\n接下来，我们必须为 $\\|x(t) - x(t_k)\\|$ 这一项定界。状态向量 $x(t)$ 根据常微分方程 $\\dot{x}(t) = f(x(t), u(t), t)$ 演化。根据微积分基本定理，在区间 $[t_{k}, t]$ 上的状态变化是其导数的积分：\n$$x(t) - x(t_k) = \\int_{t_{k}}^{t} \\dot{x}(\\tau) d\\tau$$\n取范数并应用积分的三角不等式（也称为闵可夫斯基积分不等式），我们得到：\n$$\\|x(t) - x(t_k)\\| = \\left\\| \\int_{t_{k}}^{t} \\dot{x}(\\tau) d\\tau \\right\\| \\leq \\int_{t_{k}}^{t} \\|\\dot{x}(\\tau)\\| d\\tau$$\n我们已知在宏步长区间内，状态导数的范数有一个一致界 $\\|\\dot{x}(t)\\| \\leq B_{x}$。将此界代入积分中得到：\n$$\\int_{t_{k}}^{t} \\|\\dot{x}(\\tau)\\| d\\tau \\leq \\int_{t_{k}}^{t} B_{x} d\\tau = B_{x}(t - t_{k})$$\n因此，我们已经为状态偏差建立了一个界：\n$$\\|x(t) - x(t_k)\\| \\leq B_{x}(t - t_{k})$$\n\n现在我们将此界代回到保护函数变化的不等式中：\n$$|g(x(t), t) - g_{k}| \\leq L_{x} (B_{x}(t - t_{k})) + L_{t}(t - t_{k})$$\n提出公因式项 $(t-t_k)$，我们得到关于 $g$ 的变化的综合界：\n$$|g(x(t), t) - g_{k}| \\leq (L_{x}B_{x} + L_{t})(t - t_{k})$$\n\n为了防止在 $t \\in (t_{k}, t_{k}+H)$ 时发生过零，$g(x(t), t)$ 的符号必须与 $g_k$ 的符号保持一致。\n让我们根据 $g_k$ 的符号分析两种情况。\n设 $K = L_{x}B_{x} + L_{t}$。这个界是 $|g(x(t), t) - g_{k}| \\leq K(t - t_{k})$。\n\n情况1：$g_{k} > 0$。我们必须确保对于所有 $t \\in (t_k, t_k+H)$，$g(x(t), t) > 0$。\n根据反三角不等式，我们可以写出 $g(x(t), t) = g_k + (g(x(t), t) - g_k)$，这意味着 $g(x(t), t) \\geq g_k - |g(x(t), t) - g_k|$。\n使用我们推导出的界，我们有：\n$$g(x(t), t) \\geq g_k - K(t - t_{k})$$\n为了使 $g(x(t), t)$ 严格为正，我们需要 $g_k - K(t - t_{k}) > 0$，即 $g_k > K(t - t_{k})$。这必须对所有 $t \\in (t_k, t_k+H)$ 成立。对于最大的 $t-t_k$ 值（趋近于 $H$），该条件最为严格。因此，我们必须要求 $g_k \\geq \\sup_{t \\in (t_k, t_k+H)} K(t-t_k) = K H$。如果此条件成立，则对于任何 $t \\in (t_k, t_k+H)$，我们有 $t-t_k < H$，这意味着 $K(t-t_k) < KH \\le g_k$，从而确保 $g(x(t), t)>0$。\n\n情况2：$g_k < 0$。我们必须确保对于所有 $t \\in (t_k, t_k+H)$，$g(x(t), t) < 0$。\n根据三角不等式，$g(x(t), t) = g_k + (g(x(t), t) - g_k)$，这意味着 $g(x(t), t) \\leq g_k + |g(x(t), t) - g_k|$。\n使用我们的界：\n$$g(x(t), t) \\leq g_k + K(t - t_{k})$$\n为了使 $g(x(t), t)$ 严格为负，我们需要 $g_k + K(t - t_{k}) < 0$，即 $K(t - t_{k}) < -g_k$。由于 $g_k < 0$，所以 $-g_k = |g_k|$。条件是 $K(t - t_{k}) < |g_k|$。这必须对所有 $t \\in (t_k, t_k+H)$ 成立，这就要求 $KH \\leq |g_k|$。\n\n两种情况都导出了关于 $H$ 的相同条件：\n$$K H \\leq |g_k|$$\n将 $K = L_{x}B_{x} + L_{t}$ 代回，我们得到：\n$$(L_{x}B_{x} + L_{t}) H \\leq |g_{k}|$$\n\n问题要求 $H$ 的最大阈值。从不等式中，我们可以解出 $H$：\n$$H \\leq \\frac{|g_{k}|}{L_{x}B_{x} + L_{t}}$$\n这个不等式定义了所有安全步长的集合。保证安全的 $H$ 的最大可能值是这个集合的上界。我们必须考虑分母 $L_{x}B_{x} + L_{t}$ 为零的情况。鉴于 $L_x \\ge 0$，$L_t \\ge 0$ 和 $B_x \\ge 0$，分母仅在 $L_t=0$ 且 $L_x=0$ 或 $B_x=0$ 时为零。在这种情况下，保护函数的值在区间内不能改变，并且由于 $g_k \\neq 0$，它永远不会过零。该公式通过暗示对 $H$ 没有上限（除以零）来正确反映这一点。假设分母不为零，则 $H$ 的最大阈值为：\n$$H_{\\text{max}} = \\frac{|g_{k}|}{L_{x}B_{x} + L_{t}}$$\n这个表达式表示从时间 $t_k$ 开始可以采取的最大宏步长，同时保证在开区间 $(t_k, t_k+H)$ 内的任何过零事件都不会被漏检。\n最终表达式完全由所要求的变量 $g_k$、$B_x$、$L_x$ 和 $L_t$ 表示。",
            "answer": "$$\\boxed{\\frac{|g_{k}|}{L_{x}B_{x} + L_{t}}}$$"
        }
    ]
}