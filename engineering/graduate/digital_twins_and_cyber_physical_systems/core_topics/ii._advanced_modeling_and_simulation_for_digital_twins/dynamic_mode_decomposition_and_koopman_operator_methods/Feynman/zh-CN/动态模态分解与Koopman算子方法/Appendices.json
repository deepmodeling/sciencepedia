{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践是一个基础性练习，它使用了一个简单的圆周旋转映射。通过解析推导库普曼(Koopman)算子的本征函数和本征值，你将对算子谱如何直接编码系统动力学特性获得具体的理解。这个理想化的案例  是一个至关重要的基准，有助于我们理解动态模态分解(DMD)旨在从数据中近似的目标是什么。",
            "id": "4219100",
            "problem": "信息物理系统中的同步振荡器的数字孪生通过圆上的离散时间映射 $x_{k+1} = x_{k} + \\omega \\; \\mathrm{mod}\\; 2\\pi$ 来表示振荡器的相位，其中 $x_{k} \\in [0,2\\pi)$ 是离散时间 $k \\in \\mathbb{Z}_{\\ge 0}$ 时的相位，$\\omega \\in \\mathbb{R}$ 是一个恒定的角增量。角度以弧度为单位。该数字孪生使用库普曼(Koopman)算子框架来演化相位的可观测量 $f$。库普曼算子 $\\mathcal{U}$ 通过与动力学复合的方式作用于可观测量 $f$，即 $(\\mathcal{U}f)(x) = f(x+\\omega \\; \\mathrm{mod}\\; 2\\pi)$。考虑关于圆上归一化勒贝格（不变）测度的平方可积复值可观测量所构成的希尔伯特空间 $L^{2}([0,2\\pi),\\mathrm{d}x/(2\\pi))$。在实践中，动态模态分解（DMD）被用来从数据中估计 $\\mathcal{U}$ 的谱特性，但在此你应从第一性原理出发。\n\n仅从库普曼算子的定义以及关于 $L^{2}$ 空间和傅里叶级数的标准事实出发，完成以下任务：\n\n- 在 $L^{2}([0,2\\pi))$ 中构建一个完备的库普曼特征函数集，并推导其相关的特征值的闭式形式，作为 $\\omega$ 的函数。\n- 根据圆上旋转的基本性质和复指数的正交性，解释这些特征函数如何张成 $L^{2}([0,2\\pi))$，以及为什么库普曼算子在该空间上是酉算子。\n- 针对 $\\omega/(2\\pi)$ 是有理数与无理数这两种情况，解释库普曼谱。讨论点谱是有限的、可数的，以及它在单位圆上是否稠密。简要地将谱的性质与理想化的、无噪声的动态模态分解（DMD）从沿轨道均匀采样的数据中会恢复出什么结果联系起来。\n\n最后，设 $f_{n}(x) = \\exp(\\mathrm{i} n x)$，其中 $n \\in \\mathbb{Z}$ 是一个任意但固定的整数。作为你的最终答案，报告与 $f_{n}$ 相关联的库普曼特征值 $\\lambda_{n}$，以 $n$ 和 $\\omega$ 的精确符号形式表示。不需要数值近似，最终答案中不应包含任何单位。",
            "solution": "所给出的问题陈述是一个定义明确且具有科学依据的练习，旨在将库普曼算子理论应用于一个基本的动力系统——圆上的刚性旋转。这是一个用于介绍库普曼谱分析核心概念的标准模型。该问题是自洽的、数学上精确的，并且没有任何事实或逻辑上的不一致之处。所有术语在动力系统和泛函分析领域都是标准的。因此，该问题是有效的，并将提供解答。\n\n系统动力学由映射 $T: [0, 2\\pi) \\to [0, 2\\pi)$ 给出，定义为 $T(x) = x + \\omega \\pmod{2\\pi}$。与此映射相关的库普曼算子 $\\mathcal{U}$ 作用于希尔伯特空间 $\\mathcal{H} = L^{2}([0,2\\pi), \\frac{\\mathrm{d}x}{2\\pi})$ 中的函数 $f$，其方式是与动力学复合：$(\\mathcal{U}f)(x) = f(T(x)) = f(x+\\omega \\pmod{2\\pi})$。该空间上的内积为 $\\langle g, h \\rangle = \\int_0^{2\\pi} g(x) \\overline{h(x)} \\frac{\\mathrm{d}x}{2\\pi}$。\n\n库普曼算子的特征函数，也称为库普曼模态，是一个非零函数 $f \\in \\mathcal{H}$，它满足特征值方程：\n$$\n\\mathcal{U}f = \\lambda f\n$$\n其中某个复标量 $\\lambda$ 是对应的库普曼特征值。代入算子的定义，该方程变为：\n$$\nf(x+\\omega \\pmod{2\\pi}) = \\lambda f(x)\n$$\n\n为了找到特征函数和特征值，我们利用希尔伯特空间 $L^{2}([0,2\\pi))$ 的结构。傅里叶分析的一个基本结果指出，复指数函数集合 $\\{ \\exp(\\mathrm{i} n x) \\}_{n \\in \\mathbb{Z}}$ 构成了该空间的一个完备标准正交基。我们测试这些基函数是否为库普曼特征函数的候选。\n\n让我们定义 $f_n(x) = \\exp(\\mathrm{i} n x)$，对于任意整数 $n \\in \\mathbb{Z}$。这些函数是 $L^{2}([0,2\\pi))$ 的成员，因为它们的模长的平方是 $|\\exp(\\mathrm{i} n x)|^2 = 1$，这在 $[0, 2\\pi)$ 上显然是可积的。我们现在将库普曼算子 $\\mathcal{U}$ 应用于 $f_n(x)$：\n$$\n(\\mathcal{U}f_n)(x) = f_n(x+\\omega \\pmod{2\\pi}) = \\exp(\\mathrm{i} n (x+\\omega \\pmod{2\\pi}))\n$$\n由于 $\\exp(\\mathrm{i} z)$ 在其自变量 $z$ 上是 $2\\pi$-周期的，并且 $n$ 是一个整数，函数 $\\exp(\\mathrm{i} n z)$ 的周期为 $2\\pi/|n|$（如果 $n=0$ 则是常数）。这意味着对于任意整数 $k$，$\\exp(\\mathrm{i} n (z + 2\\pi k)) = \\exp(\\mathrm{i} n z)$。因为 $(x+\\omega \\pmod{2\\pi})$ 与 $(x+\\omega)$ 相差 $2\\pi$ 的一个整数倍，我们可以简化表达式：\n$$\n(\\mathcal{U}f_n)(x) = \\exp(\\mathrm{i} n (x+\\omega)) = \\exp(\\mathrm{i} n x) \\exp(\\mathrm{i} n \\omega)\n$$\n通过代回 $f_n(x) = \\exp(\\mathrm{i} n x)$，我们得到：\n$$\n(\\mathcal{U}f_n)(x) = (\\exp(\\mathrm{i} n \\omega)) f_n(x)\n$$\n这正是特征值方程 $\\mathcal{U}f_n = \\lambda_n f_n$，其中特征函数是 $f_n(x) = \\exp(\\mathrm{i} n x)$，相关的特征值是 $\\lambda_n = \\exp(\\mathrm{i} n \\omega)$。\n这对所有整数 $n \\in \\mathbb{Z}$ 都成立。因此，函数集 $\\{ \\exp(\\mathrm{i} n x) \\}_{n \\in \\mathbb{Z}}$ 构成了一个完备的库普曼特征函数集。\n\n接下来，我们讨论张成性质和算子的酉性。\n这些特征函数 $\\{f_n(x)\\}_{n \\in \\mathbb{Z}}$ 张成空间 $L^{2}([0,2\\pi))$ 这一事实是傅里叶分析的基石（与Riesz-Fischer定理相关）。任何函数 $g \\in L^{2}([0,2\\pi))$ 都可以唯一地由其傅里叶级数表示，$g(x) = \\sum_{n \\in \\mathbb{Z}} c_n \\exp(\\mathrm{i} n x)$，其中等式在 $L^2$ 意义下成立。这证实了我们的特征函数集是完备的。对于 $n \\neq m$，这些特征函数的正交性源于复指数的基本积分性质：\n$$\n\\langle f_n, f_m \\rangle = \\int_0^{2\\pi} \\exp(\\mathrm{i} n x) \\overline{\\exp(\\mathrm{i} m x)} \\frac{\\mathrm{d}x}{2\\pi} = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(\\mathrm{i} (n-m) x) \\mathrm{d}x = \\delta_{nm}\n$$\n其中 $\\delta_{nm}$ 是克罗内克(Kronecker)δ函数。这表明它们构成一个标准正交基。\n\n库普曼算子 $\\mathcal{U}$ 在该空间上是酉算子。如果一个算子保持内积，则它是酉的。设 $g, h \\in L^{2}([0,2\\pi))$。我们计算它们在 $\\mathcal{U}$ 作用下的像的内积：\n$$\n\\langle \\mathcal{U}g, \\mathcal{U}h \\rangle = \\int_0^{2\\pi} (\\mathcal{U}g)(x) \\overline{(\\mathcal{U}h)(x)} \\frac{\\mathrm{d}x}{2\\pi} = \\int_0^{2\\pi} g(x+\\omega) \\overline{h(x+\\omega)} \\frac{\\mathrm{d}x}{2\\pi}\n$$\n进行变量替换 $y = x+\\omega$，我们有 $\\mathrm{d}y = \\mathrm{d}x$。积分区间 $[0, 2\\pi)$ 变为 $[\\omega, 2\\pi+\\omega)$。由于被积函数 $g(y)\\overline{h(y)}$ 是一个 $2\\pi$-周期函数（因为它的组成部分是圆上的函数），在任何长度为 $2\\pi$ 的区间上积分都会得到相同的结果。\n$$\n\\langle \\mathcal{U}g, \\mathcal{U}h \\rangle = \\int_{\\omega}^{2\\pi+\\omega} g(y) \\overline{h(y)} \\frac{\\mathrm{d}y}{2\\pi} = \\int_{0}^{2\\pi} g(y) \\overline{h(y)} \\frac{\\mathrm{d}y}{2\\pi} = \\langle g, h \\rangle\n$$\n由于 $\\mathcal{U}$ 保持内积并且是满射的（其逆是逆映射 $T^{-1}(x) = x-\\omega$ 的库普曼算子），所以它是酉算子。所有特征值 $\\lambda_n = \\exp(\\mathrm{i} n \\omega)$ 都位于复平面的单位圆上，因为对于实数 $n$ 和 $\\omega$，有 $|\\lambda_n| = |\\exp(\\mathrm{i} n \\omega)| = 1$，这也证实了这一点。\n\n最后，我们解释谱。点谱是所有特征值的集合，即 $\\{\\lambda_n = \\exp(\\mathrm{i} n \\omega) \\mid n \\in \\mathbb{Z}\\}$。\n- 如果 $\\omega/(2\\pi)$ 是有理数，即 $\\omega/(2\\pi) = p/q$，其中 $p, q$ 是互质整数且 $q > 0$，则 $\\omega = 2\\pi p/q$。特征值为 $\\lambda_n = \\exp(\\mathrm{i} n (2\\pi p/q))$。这些值是 $q$ 次单位根，不同特征值的集合是 $\\{\\exp(2\\pi \\mathrm{i} k/q)\\}_{k=0}^{q-1}$。因此，点谱是**有限的**，由单位圆上的 $q$ 个点组成。动力学是周期性的，周期为 $q$。\n- 如果 $\\omega/(2\\pi)$ 是无理数，那么对于任何两个不同的整数 $n \\neq m$，特征值 $\\lambda_n$ 和 $\\lambda_m$ 是不同的。如果它们不不同，那么 $(n-m)\\omega$ 将是 $2\\pi$ 的倍数，这意味着 $\\omega/(2\\pi)$ 是有理数。因此，点谱是**可数无限的**。此外，根据关于丢番图逼近的Jacobi-Kronecker定理，点集 $\\{n\\omega \\pmod{2\\pi}\\}_{n \\in \\mathbb{Z}}$ 在 $[0, 2\\pi)$ 中是稠密的。这意味着特征值集合 $\\{\\lambda_n\\}_{n \\in \\mathbb{Z}}$ 在单位圆上是**稠密的**。动力学是准周期的。\n\n一个理想化的、无噪声的动态模态分解（DMD）算法，当应用于足够长的可观测量轨迹时，旨在近似库普曼算子的特征值和特征函数。\n- 在有理数情况下，系统的轨道是周期的，DMD将正确识别出对应于基频及其谐波的有限个 $q$ 个特征值。\n- 在无理数情况下，轨道是准周期的，从不重复。应用于有限数据集的DMD只能产生有限数量的特征值。这些DMD特征值将逼近真实稠密谱的一个子集，该子集对应于数据中存在的最主要频率（即，在被测观测量的展开式中具有大系数的特征函数）。随着数据量的增加，DMD可以解析更多频率，并提供对稠密谱更好的近似。\n\n问题要求给出与特征函数 $f_n(x) = \\exp(\\mathrm{i} n x)$ 相关联的特定特征值 $\\lambda_n$。根据我们的推导，这是：\n$\\lambda_n = \\exp(\\mathrm{i} n \\omega)$。",
            "answer": "$$\n\\boxed{\\exp(\\mathrm{i} n \\omega)}\n$$"
        },
        {
            "introduction": "在超越线性系统之后，这个练习将探讨一个简单的非线性映射：$x_{k+1} = x^2$。你会发现，即使对于简单的非线性，库普曼算子也可能将有限维的可观测量空间（如多项式空间）映射到无限维空间。这个实践  突显了为什么像DMD这样的有限秩近似是必要的，并揭示了在为复杂非线性动力学建模时存在的固有近似误差。",
            "id": "4219108",
            "problem": "考虑一个标量信息物理系统 (CPS) 的数字孪生，其离散时间状态 $x_{k} \\in \\mathbb{R}$ 遵循确定性非线性映射 $f(x) = x^{2}$ 进行演化。可观测量是用于从状态中提取可测量量的函数 $g : \\mathbb{R} \\to \\mathbb{R}$。在与动态模态分解 (DMD) 相关的算子理论建模背景下，Koopman 算子作用于由系统动力学引出的可观测量。对于特定可观测量 $g(x) = x$，计算 $(\\mathcal{K}g)(x)$ 的解析表达式。然后，仅使用离散时间动力学系统和 Koopman 算子的基本定义，解释为什么这个计算结果意味着对于此 $f$，多项式可观测量空间在 $\\mathcal{K}$ 作用下不是有限维不变的。请给出你的推理过程，但将你的最终答案表示为 $(\\mathcal{K}g)(x)$ 的解析表达式。无需四舍五入。",
            "solution": "该问题陈述被评估为具有科学依据、提法恰当且客观。它提供了一个离散时间动力学系统，其演化映射为 $f(x) = x^2$，状态为 $x_k \\in \\mathbb{R}$，可观察函数为 $g(x) = x$。任务是计算 Koopman 算子对这个特定可观量的作用，并利用此结果解释该算子在多项式可观测量空间上作用的一个性质。所有定义和条件在动力学系统和算子理论领域都是标准的。因此，该问题被认为是有效的。\n\n解答过程首先计算所需的表达式，然后给出后续的推理。\n\nKoopman 算子，记作 $\\mathcal{K}$，描述了定义在动力学系统状态空间上的可观察函数的演化。对于一个由映射 $x_{k+1} = f(x_k)$ 控制的离散时间系统，Koopman 算子对可观察函数 $g$ 的作用定义为：\n$$(\\mathcal{K}g)(x) = g(f(x))$$\n\n在本问题中，状态演化由非线性映射 $f(x) = x^2$ 给出。所考虑的特定可观测量是恒等函数 $g(x) = x$。\n\n为了计算 $(\\mathcal{K}g)(x)$ 的解析表达式，我们将给定的函数 $f$ 和 $g$ 代入 Koopman 算子的定义中：\n$$(\\mathcal{K}g)(x) = g(f(x)) = g(x^2)$$\n\n由于函数 $g$ 的定义为 $g(z) = z$（对任意输入 $z$），我们将 $g(x^2)$ 计算为：\n$$g(x^2) = x^2$$\n\n因此，Koopman 算子 $\\mathcal{K}$ 作用于可观测量 $g(x)=x$ 的解析表达式为：\n$$(\\mathcal{K}g)(x) = x^2$$\n\n接下来，我们必须解释为什么这个结果意味着对于给定的动力学 $f(x) = x^2$，多项式可观测量空间在 $\\mathcal{K}$ 作用下不是一个有限维不变子空间。\n\n如果对于一个向量空间 $\\mathcal{V}$ 中的每一个向量 $v \\in \\mathcal{V}$，向量 $\\mathcal{L}v$ 也在 $\\mathcal{V}$ 中，那么我们称 $\\mathcal{V}$ 是线性算子 $\\mathcal{L}$ 下的一个不变子空间。在我们的情景中，向量是可观察函数，算子是 Koopman 算子 $\\mathcal{K}$。\n\n设 $\\mathcal{P}$ 是 $\\mathbb{R}$ 上所有多项式可观量的空间。一个函数 $p \\in \\mathcal{P}$ 可以写成 $p(x) = \\sum_{j=0}^{d} c_j x^j$ 的形式，其中 $d \\in \\mathbb{N}_0$ 是某个有限的阶数，$c_j \\in \\mathbb{R}$ 是系数。\n\n让我们分析 $\\mathcal{K}$ 对一个一般单项式可观测量 $h_n(x) = x^n$（其中 $n$ 为某个非负整数）的作用。\n$$(\\mathcal{K}h_n)(x) = h_n(f(x)) = h_n(x^2) = (x^2)^n = x^{2n}$$\n这表明，该系统的 Koopman 算子将一个 $n$ 次单项式映射到一个 $2n$ 次单项式。\n\n现在，为了引出矛盾，我们假设存在一个多项式的有限维子空间 $\\mathcal{G}$，它在 $\\mathcal{K}$ 作用下是不变的且非平凡的（即，它不仅仅包含常数函数）。由于 $\\mathcal{G}$ 是一个多项式的有限维空间，对于 $\\mathcal{G}$ 中的任何多项式，必然存在一个最高阶数 $N$，其中 $N > 0$。设 $p(x) \\in \\mathcal{G}$ 是这个最高阶数 $N$ 的多项式。我们可以将其写为 $p(x) = a_N x^N + \\dots + a_1 x + a_0$，其中 $a_N \\neq 0$。\n\n将 Koopman 算子作用于 $p(x)$：\n$$(\\mathcal{K}p)(x) = p(f(x)) = p(x^2) = a_N (x^2)^N + \\dots + a_1 (x^2) + a_0 = a_N x^{2N} + \\dots + a_1 x^2 + a_0$$\n得到的函数 $(\\mathcal{K}p)(x)$ 是一个多项式。它的阶数由 $x$ 的最高次幂决定，即 $2N$。由于我们假设 $N>0$，可得出 $2N > N$。\n\n要使 $\\mathcal{G}$ 成为一个不变子空间，函数 $(\\mathcal{K}p)(x)$ 也必须是 $\\mathcal{G}$ 的一个元素。然而，$(\\mathcal{K}p)(x)$ 的阶数是 $2N$，这严格大于 $\\mathcal{G}$ 中任何多项式的最高阶数 $N$。这意味着 $(\\mathcal{K}p)(x) \\notin \\mathcal{G}$，这与我们假设 $\\mathcal{G}$ 是一个不变子空间相矛盾。\n\n避免这个矛盾的唯一方法是 $N \\le 0$。如果 $N=0$，该子空间仅由常数函数 $g(x)=c$ 组成。对于这样的函数，$(\\mathcal{K}g)(x) = g(x^2) = c$，它仍然是一个常数。所以，常数函数空间是一个平凡的一维不变子空间。然而，任何最高阶数 $N > 0$ 的有限维多项式空间都不可能是不变的。\n\n最初的计算 $(\\mathcal{K}\\{x\\})(x) = x^2$ 是该论证的基础案例。它表明一个 1 阶的可观测量被映射到一个 2 阶的可观测量。重复应用该算子会生成一个阶数无界增长的可观测量序列：\n$$g_0(x) = x$$\n$$(\\mathcal{K}g_0)(x) = x^2$$\n$$(\\mathcal{K}^2 g_0)(x) = \\mathcal{K}(x^2) = (x^2)^2 = x^4$$\n$$(\\mathcal{K}^n g_0)(x) = x^{2^n}$$\n任何有限维多项式空间都会有一个最高阶数，而对简单可观测量 $g(x)=x$ 应用足够多次 $\\mathcal{K}$ 算子将会产生一个超过此最高阶数的多项式，从而离开该空间。因此，所有多项式可观量的空间不能由此 Koopman 算子下的一个有限维不变子空间来表示。这就是为什么像 DMD 这样的有限维近似方法对于某些非线性系统可能具有挑战性的一个关键原因。",
            "answer": "$$\\boxed{x^2}$$"
        },
        {
            "introduction": "DMD在实际应用中涉及处理含噪声数据，以及一个关键的模型复杂度选择，即截断秩 $r$。这最后一个实践  旨在挑战你像从业者一样思考，评估选择 $r$ 的不同策略。理解如何平衡模型准确性（低偏差）和对噪声的鲁棒性（低方差），是构建具有预测性和泛化能力的DMD模型的关键。",
            "id": "4219089",
            "problem": "一个反馈稳定的信息物理系统（CPS）的数字孪生是使用动态模式分解（DMD）从状态快照的时间序列构建的。动态模式分解（DMD）旨在寻找一个低维线性模型，该模型将快照在时间上向前推进，并可被解释为作用于所选观测量上的 Koopman 算子的有限维近似。标准流程将奇异值分解（SVD）应用于快照矩阵，并在估计降维后的线性映射之前将其截断到秩 $r$。在实践中，截断秩 $r$ 控制模型复杂度：较大的 $r$ 允许模型拟合更精细的结构（包括噪声），而较小的 $r$ 则强制模型更平滑、方差更低，但可能会错过重要的动态特性。假设数据被具有近似高斯统计特性的传感器噪声污染，并且验证目标是在代表预期运行包络的预留轨迹上的多步预测误差。\n\n从第一性原理的视角来看，$r$ 的选择应平衡偏差与方差，反映 CPS 的物理特性，并以泛化性能而非训练拟合度为依据。考虑以下选择 $r$ 的候选程序：\n\nA. 选择 $r$ 为使快照矩阵前 $r$ 个奇异值捕获的累积能量超过一个从传感器噪声水平估计值得出的阈值 $\\tau$ 的最小值，然后通过对预留数据进行多步预测误差的 $k$ 折交叉验证来确认 $r$。对于闭环稳定的 CPS，作为后处理稳定性滤波器，丢弃那些离散时间特征值模长超过 $1$ 的模式。\n\nB. 选择数据矩阵维度允许的最大可能秩 $r$ 以最小化近似偏差，因为 DMD 模型是线性的，因此不太可能过拟合。\n\nC. 通过最小化仅在训练快照上的单步重构误差来选择 $r$，当增加 $r$ 带来的误差边际减少量低于一个固定容差时（例如，相对减少小于 $1\\%$）停止，不进行任何交叉验证或施加模型复杂度惩罚。\n\nD. 通过最小化一个最小描述长度（MDL）目标函数来选择 $r$，该目标函数权衡了在高斯噪声模型下（在验证数据上评估）的数据拟合编码长度与随秩 $r$ 引入的自由参数数量增加的模型编码长度；然后，为减少估计器方差，应用 1-标准差规则选择最小的 $r$，其验证分数位于最优值的单个估计标准差范围内。\n\n上述选项中，哪些是选择 DMD 截断秩 $r$ 的原则性标准，这些标准明确或隐含地平衡了偏差和方差，同时尊重 CPS 的背景并旨在实现样本外预测性能？选择所有适用项。\n\n重要定义：奇异值分解 (SVD)；动态模式分解 (DMD)；最小描述长度 (MDL)；Koopman 算子；交叉验证 (CV)。",
            "solution": "该问题要求评估四种不同的程序，用于在反馈稳定的信息物理系统（CPS）的动态模式分解（DMD）模型中选择截断秩 $r$。该模型的数据是带噪声的时间序列快照。既定目标是获得良好的泛化性能，通过在预留数据上的多步预测误差来衡量。这要求所选程序能恰当地平衡偏差-方差权衡。\n\n### 理论基础\n\n动态模式分解提供一个线性算子 $\\mathbf{A}$，该算子能最佳地逼近状态快照 $\\mathbf{x}_k \\in \\mathbb{R}^n$ 的演化，使得 $\\mathbf{x}_{k+1} \\approx \\mathbf{A} \\mathbf{x}_k$。标准算法操作于由 $m$ 个快照堆叠而成的两个矩阵：\n$$\n\\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_{m-1}] \\quad \\text{和} \\quad \\mathbf{X}' = [\\mathbf{x}_2, \\mathbf{x}_3, \\ldots, \\mathbf{x}_m]\n$$\n目标是找到 $\\mathbf{A}$ 以最小化 $\\|\\mathbf{X}' - \\mathbf{A}\\mathbf{X}\\|_F$。为了使问题良态并降低模型复杂度，首先通过其秩-$r$ 奇异值分解（SVD）来近似数据矩阵 $\\mathbf{X}$，即 $\\mathbf{X} \\approx \\mathbf{U}_r \\mathbf{\\Sigma}_r \\mathbf{V}_r^*$。然后，DMD 算子在前 $r$ 个 POD（本征正交分解）模式的降维空间中构建，得到一个 $r \\times r$ 的矩阵 $\\tilde{\\mathbf{A}} = \\mathbf{U}_r^* \\mathbf{X}' \\mathbf{V}_r \\mathbf{\\Sigma}_r^{-1}$。\n\n截断秩 $r$ 的选择至关重要。\n- 较小的 $r$ 会产生一个低复杂度的模型。这会导致高偏差（模型可能过于简单，无法捕捉真实的动态特性），但方差较低（模型对训练数据中的特定噪声实现不那么敏感）。\n- 较大的 $r$ 会产生一个高复杂度的模型。这会导致低偏差（模型可以很好地拟合训练数据），但方差较高（模型很可能拟合了噪声，导致在新数据上表现不佳，即过拟合）。\n\n因此，一个选择 $r$ 的“原则性标准”必须驾驭这种权衡，以优化样本外性能，而不仅仅是样本内（训练）的拟合。它还应结合关于数据（噪声特性）和系统（如稳定性等物理属性）的知识。\n\n### 候选程序评估\n\n**选项 A：选择 $r$ 为使快照矩阵前 $r$ 个奇异值捕获的累积能量超过一个从传感器噪声水平估计值得出的阈值 $\\tau$ 的最小值，然后通过对预留数据进行多步预测误差的 $k$ 折交叉验证来确认 $r$。对于闭环稳定的 CPS，作为后处理稳定性滤波器，丢弃那些离散时间特征值模长超过 $1$ 的模式。**\n\n此程序由三个方法论上合理的步骤组成：\n1.  **基于噪声的阈值法：** 前提说明数据被高斯噪声污染。随机矩阵理论提供了方法（例如，与 Marcenko-Pastur 分布相关的方法）来估计奇异值谱中可归因于噪声的部分。基于估计的噪声方差设置阈值 $\\tau$ 是对奇异值执行“最优硬阈值法”的一种原则性方法。这直接解决了从噪声中分离信号的问题，旨在选择一个能保留动态显著模式同时丢弃由噪声主导的模式的秩 $r$。这是一种直接的方差控制方法。\n2.  **交叉验证 (CV)：** $k$ 折交叉验证是估计模型泛化性能的一个稳健的经验标准。通过在预留数据上评估多步预测误差，此步骤直接解决了既定的验证目标。它提供了一个明确的检验，以确定秩 $r$（可能从第一步建议的一系列候选值中选择）是否产生了一个在未见数据上预测良好的模型。这是经验上管理偏差-方差权衡的经典方法。\n3.  **稳定性后处理：** 问题指出 CPS 是反馈稳定的，这意味着其动态是稳定的。离散时间 DMD 模型中的任何不稳定特征值（模长 $ 1$）很可能是噪声和过拟合的产物。移除这些伪模式或将动态投影到稳定子空间，是将先验物理知识融入模型的一种有效且常见的技术，可以提高其长期预测准确性和物理真实性。\n\n该选项结合了理论上合理的噪声去除启发式方法、模型选择的经验黄金标准（CV），以及先验物理知识的运用。这种多管齐下的策略是高度原则性的。\n\n**结论：正确**\n\n**选项 B：选择数据矩阵维度允许的最大可能秩 $r$ 以最小化近似偏差，因为 DMD 模型是线性的，因此不太可能过拟合。**\n\n此程序存在两个根本性缺陷：\n1.  **忽略方差：** 选择最大可能秩 $r$ 等同于最小化训练数据上的重构误差。这完全专注于最小化*相对于训练数据*（包含噪声）的偏差。它完全忽略了误差的方差部分。这样的模型将具有最大复杂度，几乎肯定会过拟合噪声，导致泛化性能不佳。\n2.  **不正确的理由：** 声称线性模型“不太可能过拟合”是错误的。一个具有大量参数的线性模型很容易过拟合。降维 DMD 算子 $\\tilde{\\mathbf{A}}$ 中的参数数量为 $r^2$。随着 $r$ 的增加，模型拟合噪声的能力呈二次方增长。动态方程 $\\mathbf{x}_{k+1} = \\mathbf{A} \\mathbf{x}_k$ 的线性性质绝不意味着在估计阶段可以避免矩阵 $\\mathbf{A}$ 本身的过拟合。\n这种方法违背了平衡偏差和方差的核心原则。\n\n**结论：不正确**\n\n**选项 C：通过最小化仅在训练快照上的单步重构误差来选择 $r$，当增加 $r$ 带来的误差边际减少量低于一个固定容差时（例如，相对减少小于 $1\\%$）停止，不进行任何交叉验证或施加模型复杂度惩罚。**\n\n此程序与选项 B 存在相同的根本问题，尽管它看起来更细致一些。\n1.  **关注训练误差：** 该标准完全基于训练数据上的单步重构误差（$\\|\\mathbf{X}' - \\mathbf{A}_r\\mathbf{X}\\|_F$）。该误差度量是 $r$ 的单调递减函数。在此度量上表现良好的模型不能保证泛化性能良好。\n2.  **启发式停止规则：** “肘部”法则（当性能的边际增益变得很小时停止）是一种常见但薄弱的启发式方法。它没有强有力的理论依据来找到泛化的最佳权衡点。训练误差曲线变平的点可能在模型已经开始显著拟合噪声之后很久才出现。\n3.  **明确拒绝原则性方法：** 该程序明确指出其执行时“不进行任何交叉验证或施加模型复杂度惩罚”。这突显了其主要弱点：它缺乏估计或控制样本外误差的机制。\n这种方法容易选择一个过于复杂的模型，从而过拟合训练数据。\n\n**结论：不正确**\n\n**选项 D：通过最小化一个最小描述长度（MDL）目标函数来选择 $r$，该目标函数权衡了在高斯噪声模型下（在验证数据上评估）的数据拟合编码长度与随秩 $r$ 引入的自由参数数量增加的模型编码长度；然后，为减少估计器方差，应用 1-标准差规则选择最小的 $r$，其验证分数位于最优值的单个估计标准差范围内。**\n\n此程序描述了一种植根于信息论和统计学的复杂且有原则的方法。\n1.  **最小描述长度 (MDL)：** MDL 是奥卡姆剃刀的正式实现。它旨在寻找能提供数据最紧凑描述的模型。这涉及最小化一个成本函数，该函数结合了编码模型预测误差的成本（数据拟合）和编码模型本身的成本（模型复杂度）。模型复杂度项起到正则化惩罚的作用。由于 DMD 模型中的参数数量随 $r$ 变化（如 $r^2$），MDL 提供了一种理论上合理的方法来平衡模型拟合度与模型复杂度，直接解决了偏差-方差权衡问题。在验证数据上评估这一点进一步确保了重点在于泛化。\n2.  **1-标准差规则：** 这是一个标准且稳健的统计启发式规则，与交叉验证或验证集评估结合使用。在找到具有最小验证误差的模型（“最优”模型）后，此规则选择性能与最优模型在统计上无法区分的最简单模型（最小的 $r$）（即，在最小误差的一个标准差范围内）。这明确地偏爱更简单、方差更低的模型，并有助于防止在验证集中“追逐噪声”，从而实现更稳健的模型选择。\n该选项描述了一种用于管理偏差-方差权衡的、形式化的、理论上合理的方​​法，并辅以一个稳健的统计规则以增强其鲁棒性。\n\n**结论：正确**\n\n### 结论\n\n选项 A 和 D 都描述了选择 DMD 秩 $r$ 的原则性、前沿的方法。选项 A 是一种务实的、经验驱动的方法，结合了噪声估计、交叉验证和基于物理的约束。选项 D 是一种形式化的、信息论的方法，结合了稳健的统计选择规则。两者都正确地解决了为优化样本外预测性能而需要平衡偏差和方差的问题。选项 B 和 C 存在缺陷，因为它们只关注训练集性能，并忽略或误解了过拟合问题。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}