{
    "hands_on_practices": [
        {
            "introduction": "模型降阶（Model Order Reduction, MOR）是从复杂的高保真物理仿真中创建高效低保真模型的主要方法。本练习将此概念置于结构动力学的具体物理背景中，通过将系统动力学投影到其主导模态构成的基上，来创建一个更小、计算更快的模型。此实践将培养您在模态分析方面的技能，并通过计算模态截断误差，让您对模型规模与精度之间的权衡有一个清晰的量化理解 。",
            "id": "4232599",
            "problem": "考虑一个与信息物理系统 (CPS) 的数字孪生 (DT) 相关的三自由度无阻尼结构动力学模型，其中高保真度二阶动力学遵循线性动量守恒基本原理和弹性储能，其形式为\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{0},\n$$\n其中质量矩阵 $\\,\\mathbf{M}\\,$ 和刚度矩阵 $\\,\\mathbf{K}\\,$ 为对称正定矩阵。设质量矩阵为单位矩阵 $\\,\\mathbf{M} = \\mathbf{I}_3\\,$，刚度矩阵为标准的离散二阶差分算子\n$$\n\\mathbf{K} = \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n您将通过一种多保真度建模策略构建一个降阶模型，该策略通过使用基于模态分析的合同变换来保持 $\\,\\mathbf{M}\\,$ 和 $\\,\\mathbf{K}\\,$ 的对称性。\n\n任务：\n1. 从二阶线性时不变系统的无阻尼简正模态的核心定义出发，构建广义特征值问题，该问题相对于动能内积对角化弹性势能。利用此问题构建一个基于 $\\,\\mathbf{M}\\,$-正交模态基的合同变换 $\\,\\mathbf{T} \\,$，该变换能保持变换后质量和刚度矩阵的对称性。明确选择两个最低频率的模态来定义一个降阶模型（模型降阶，MOR），并写出通过将合同变换 $\\,\\mathbf{T}\\,$ 限制在这些模态上所获得的降阶质量和刚度。\n\n2. 为了量化多保真度误差，设初始位移为 $\\,\\mathbf{x}(0) = (1,\\,0,\\,0)^{\\top}\\,$，初始速度为 $\\,\\dot{\\mathbf{x}}(0) = \\mathbf{0}\\,$。将模态截断误差定义为在 $\\,t=0\\,$ 时，当截断为双模态降阶基时损失的势能占总势能的比例（以小数或分数表示，不带百分号），即\n$$\n\\varepsilon \\equiv \\frac{\\text{在 } t=0 \\text{ 时被忽略的模态势能}}{\\text{在 } t=0 \\text{ 时的总势能}}。\n$$\n精确计算 $\\,\\varepsilon\\,$。将最终答案表示为单个闭式解析表达式。无需单位。如果选择给出数值近似值，请将答案四舍五入至六位有效数字。",
            "solution": "该问题被评估为有效，因为它在科学上基于线性结构动力学，问题设定良好并提供了所有必要信息，且其表述是客观的。该问题是模型降阶中的一个标准练习，与数字孪生背景下的多保真度建模直接相关。\n\n根据要求，解答分为两部分。\n\n第1部分：降阶模型的构建\n\n无阻尼系统的控制方程由下式给出\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{0}\n$$\n我们寻求形式为 $\\mathbf{x}(t) = \\boldsymbol{\\phi} e^{i\\omega t}$ 的简正模态解，其中 $\\boldsymbol{\\phi}$ 是模态振型向量，$\\omega$ 是固有频率。将此代入运动方程可得：\n$$\n\\mathbf{M}\\,(-\\omega^2 \\boldsymbol{\\phi} e^{i\\omega t}) + \\mathbf{K}\\,(\\boldsymbol{\\phi} e^{i\\omega t}) = \\mathbf{0}\n$$\n$$\n(\\mathbf{K} - \\omega^2 \\mathbf{M}) \\boldsymbol{\\phi} = \\mathbf{0}\n$$\n令 $\\lambda = \\omega^2$，我们得到广义特征值问题 (GEP)：\n$$\n\\mathbf{K}\\boldsymbol{\\phi} = \\lambda \\mathbf{M}\\boldsymbol{\\phi}\n$$\n给定质量矩阵 $\\mathbf{M} = \\mathbf{I}_3$，GEP 简化为标准特征值问题：\n$$\n\\mathbf{K}\\boldsymbol{\\phi} = \\lambda \\boldsymbol{\\phi}\n$$\n我们需要求出刚度矩阵 $\\mathbf{K}$ 的特征值 $\\lambda_i$ 和特征向量 $\\boldsymbol{\\phi}_i$：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n$$\n特征方程为 $\\det(\\mathbf{K} - \\lambda \\mathbf{I}) = 0$：\n$$\n\\det\\begin{pmatrix}\n2-\\lambda  -1  0 \\\\\n-1  2-\\lambda  -1 \\\\\n0  -1  2-\\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(2-\\lambda)\\left((2-\\lambda)^2 - (-1)(-1)\\right) - (-1)\\left((-1)(2-\\lambda) - 0\\right) = 0\n$$\n$$\n(2-\\lambda)((2-\\lambda)^2 - 1) - (2-\\lambda) = 0\n$$\n$$\n(2-\\lambda)\\left( (2-\\lambda)^2 - 1 - 1 \\right) = 0\n$$\n$$\n(2-\\lambda)(\\lambda^2 - 4\\lambda + 4 - 2) = 0\n$$\n$$\n(2-\\lambda)(\\lambda^2 - 4\\lambda + 2) = 0\n$$\n$\\lambda$ 的解为 $\\lambda = 2$ 以及 $\\lambda^2 - 4\\lambda + 2 = 0$ 的根，即 $\\lambda = \\frac{4 \\pm \\sqrt{16-8}}{2} = 2 \\pm \\sqrt{2}$。表示固有频率平方 $\\omega_i^2$ 的特征值按升序排列为：\n$$\n\\lambda_1 = 2 - \\sqrt{2} \\quad, \\quad \\lambda_2 = 2 \\quad, \\quad \\lambda_3 = 2 + \\sqrt{2}\n$$\n接下来，我们求解相应的特征向量 $\\boldsymbol{\\phi}_i$。\n\n对于 $\\lambda_1 = 2 - \\sqrt{2}$：$(\\mathbf{K} - \\lambda_1\\mathbf{I})\\boldsymbol{\\phi}_1 = \\mathbf{0}$\n$$\n\\begin{pmatrix} \\sqrt{2}  -1  0 \\\\ -1  \\sqrt{2}  -1 \\\\ 0  -1  \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} \\phi_{11} \\\\ \\phi_{12} \\\\ \\phi_{13} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\boldsymbol{\\phi}_1 \\propto \\begin{pmatrix} 1 \\\\ \\sqrt{2} \\\\ 1 \\end{pmatrix}\n$$\n对于 $\\lambda_2 = 2$：$(\\mathbf{K} - \\lambda_2\\mathbf{I})\\boldsymbol{\\phi}_2 = \\mathbf{0}$\n$$\n\\begin{pmatrix} 0  -1  0 \\\\ -1  0  -1 \\\\ 0  -1  0 \\end{pmatrix} \\begin{pmatrix} \\phi_{21} \\\\ \\phi_{22} \\\\ \\phi_{23} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\boldsymbol{\\phi}_2 \\propto \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n问题要求一个基于两个最低频率模态的模型，这对应于 $\\lambda_1$ 和 $\\lambda_2$。\n为构建合同变换，我们使用一个 $\\mathbf{M}$-正交基。由于 $\\mathbf{M}=\\mathbf{I}$，这等价于一个标准正交基。我们将特征向量 $\\boldsymbol{\\phi}_1$ 和 $\\boldsymbol{\\phi}_2$ 归一化，得到基向量 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$。\n$$\n\\|\\boldsymbol{\\phi}_1\\|^2 = 1^2 + (\\sqrt{2})^2 + 1^2 = 4 \\implies \\|\\boldsymbol{\\phi}_1\\| = 2\n$$\n$$\n\\mathbf{u}_1 = \\frac{\\boldsymbol{\\phi}_1}{\\|\\boldsymbol{\\phi}_1\\|} = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ \\sqrt{2} \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\|\\boldsymbol{\\phi}_2\\|^2 = 1^2 + 0^2 + (-1)^2 = 2 \\implies \\|\\boldsymbol{\\phi}_2\\| = \\sqrt{2}\n$$\n$$\n\\mathbf{u}_2 = \\frac{\\boldsymbol{\\phi}_2}{\\|\\boldsymbol{\\phi}_2\\|} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n用于降阶模型的变换矩阵 $\\mathbf{T}$ 由这两个模态向量构成：\n$$\n\\mathbf{T} = \\begin{pmatrix} \\mathbf{u}_1  \\mathbf{u}_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{\\sqrt{2}} \\\\ \\frac{\\sqrt{2}}{2}  0 \\\\ \\frac{1}{2}  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n降阶模型通过合同变换 $\\mathbf{x} = \\mathbf{T}\\mathbf{q}$ 获得，得到降阶系统 $\\mathbf{M}_r \\ddot{\\mathbf{q}} + \\mathbf{K}_r \\mathbf{q} = \\mathbf{0}$。降阶质量和刚度矩阵为：\n$$\n\\mathbf{M}_r = \\mathbf{T}^{\\top} \\mathbf{M} \\mathbf{T} = \\mathbf{T}^{\\top} \\mathbf{I} \\mathbf{T} = \\mathbf{T}^{\\top} \\mathbf{T}\n$$\n$$\n\\mathbf{K}_r = \\mathbf{T}^{\\top} \\mathbf{K} \\mathbf{T}\n$$\n根据模态向量的 $\\mathbf{M}$-正交性，即 $\\mathbf{u}_i^{\\top}\\mathbf{M}\\mathbf{u}_j = \\delta_{ij}$，降阶质量矩阵是单位矩阵：\n$$\n\\mathbf{M}_r = \\begin{pmatrix} \\mathbf{u}_1^{\\top}\\mathbf{u}_1  \\mathbf{u}_1^{\\top}\\mathbf{u}_2 \\\\ \\mathbf{u}_2^{\\top}\\mathbf{u}_1  \\mathbf{u}_2^{\\top}\\mathbf{u}_2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\mathbf{I}_2\n$$\n根据 $\\mathbf{M}$-正交性和特征向量的性质 ($\\mathbf{K}\\mathbf{u}_j = \\lambda_j \\mathbf{M}\\mathbf{u}_j$)，降阶刚度矩阵成为一个由相应特征值组成的对角矩阵：\n$$\n\\mathbf{K}_r = \\begin{pmatrix} \\mathbf{u}_1^{\\top}\\mathbf{K}\\mathbf{u}_1  \\mathbf{u}_1^{\\top}\\mathbf{K}\\mathbf{u}_2 \\\\ \\mathbf{u}_2^{\\top}\\mathbf{K}\\mathbf{u}_1  \\mathbf{u}_2^{\\top}\\mathbf{K}\\mathbf{u}_2 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix} = \\begin{pmatrix} 2 - \\sqrt{2}  0 \\\\ 0  2 \\end{pmatrix}\n$$\n\n第2部分：模态截断误差的计算\n\n系统的势能为 $V = \\frac{1}{2}\\mathbf{x}^{\\top}\\mathbf{K}\\mathbf{x}$。在 $t=0$ 时，总能量完全是势能，因为 $\\dot{\\mathbf{x}}(0) = \\mathbf{0}$。\n$$\nE_{\\text{total}} = V(0) = \\frac{1}{2}\\mathbf{x}(0)^{\\top}\\mathbf{K}\\mathbf{x}(0)\n$$\n当 $\\mathbf{x}(0) = \\begin{pmatrix} 1  0  0 \\end{pmatrix}^{\\top}$ 时，\n$$\nE_{\\text{total}} = \\frac{1}{2}\\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{2}(2) = 1\n$$\n为了找到模态能量分布，我们将初始位移 $\\mathbf{x}(0)$ 在完备模态基 $\\{\\mathbf{u}_1, \\mathbf{u}_2, \\mathbf{u}_3\\}$ 中展开。首先，我们求出 $\\mathbf{u}_3$：\n$$\n\\boldsymbol{\\phi}_3 \\propto \\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix} \\implies \\mathbf{u}_3 = \\frac{1}{2}\\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix}\n$$\n模态坐标 $c_i(0)$ 通过投影求得：$c_i(0) = \\mathbf{u}_i^{\\top}\\mathbf{x}(0)$。\n$$\nc_1(0) = \\mathbf{u}_1^{\\top}\\mathbf{x}(0) = \\frac{1}{2}(1) + \\frac{\\sqrt{2}}{2}(0) + \\frac{1}{2}(0) = \\frac{1}{2}\n$$\n$$\nc_2(0) = \\mathbf{u}_2^{\\top}\\mathbf{x}(0) = \\frac{1}{\\sqrt{2}}(1) + 0(0) - \\frac{1}{\\sqrt{2}}(0) = \\frac{1}{\\sqrt{2}}\n$$\n$$\nc_3(0) = \\mathbf{u}_3^{\\top}\\mathbf{x}(0) = \\frac{1}{2}(1) - \\frac{\\sqrt{2}}{2}(0) + \\frac{1}{2}(0) = \\frac{1}{2}\n$$\n势能可以写为模态势能之和：$V = \\sum_{i=1}^{3} V_i = \\sum_{i=1}^{3} \\frac{1}{2}c_i^2 \\lambda_i$。\n在 $t=0$ 时的总势能为：\n$$\nV(0) = \\frac{1}{2}\\left( c_1(0)^2 \\lambda_1 + c_2(0)^2 \\lambda_2 + c_3(0)^2 \\lambda_3 \\right)\n$$\n$$\nV(0) = \\frac{1}{2}\\left( \\left(\\frac{1}{2}\\right)^2(2-\\sqrt{2}) + \\left(\\frac{1}{\\sqrt{2}}\\right)^2(2) + \\left(\\frac{1}{2}\\right)^2(2+\\sqrt{2}) \\right)\n$$\n$$\nV(0) = \\frac{1}{2}\\left( \\frac{1}{4}(2-\\sqrt{2}) + \\frac{1}{2}(2) + \\frac{1}{4}(2+\\sqrt{2}) \\right) = \\frac{1}{2}\\left( \\frac{1}{2} - \\frac{\\sqrt{2}}{4} + 1 + \\frac{1}{2} + \\frac{\\sqrt{2}}{4} \\right) = \\frac{1}{2}(2) = 1\n$$\n这验证了直接计算的结果。\n降阶模型保留了模态1和模态2。被忽略的模态是模态3。被忽略的势能是模态3中的能量：\n$$\nV_{\\text{omitted}} = V_3(0) = \\frac{1}{2}c_3(0)^2 \\lambda_3 = \\frac{1}{2}\\left(\\frac{1}{2}\\right)^2 (2+\\sqrt{2}) = \\frac{1}{8}(2+\\sqrt{2})\n$$\n模态截断误差 $\\varepsilon$ 定义为在 $t=0$ 时，被忽略的势能与总势能之比：\n$$\n\\varepsilon = \\frac{V_{\\text{omitted}}}{V(0)} = \\frac{\\frac{1}{8}(2+\\sqrt{2})}{1} = \\frac{2+\\sqrt{2}}{8}\n$$\n简化表达式为：\n$$\n\\varepsilon = \\frac{2}{8} + \\frac{\\sqrt{2}}{8} = \\frac{1}{4} + \\frac{\\sqrt{2}}{8}\n$$\n这就是模态截断误差的精确解析表达式。",
            "answer": "$$\n\\boxed{\\frac{2+\\sqrt{2}}{8}}\n$$"
        },
        {
            "introduction": "除了创建降阶模型，多保真策略的一个关键任务是融合来自多个来源的现有数据，而高斯过程（Gaussian Processes, GPs）为此提供了一个强大的概率框架。本练习使用一个自回归高斯过程模型，其中高保真输出被建模为低保真输出的缩放版本加上一个偏差项。通过完成此计算，您将获得多保真高斯过程回归核心机制的实践经验，学习如何统计地组合不同保真度级别的信息以提高预测精度并量化不确定性 。",
            "id": "4232572",
            "problem": "在一个信息物理系统的数字孪生中，考虑一个双层多保真度自回归模型，其中高保真度函数 $f_H(x)$ 通过 $f_H(x) = \\rho f_L(x) + \\delta(x)$ 与低保真度函数 $f_L(x)$ 相关。低保真度分量 $f_L(x)$ 被建模为均值为零、协方差为 $k_L(x,x')$ 的高斯过程（GP），差异项 $\\delta(x)$ 被建模为独立的、均值为零、协方差为 $k_{\\Delta}(x,x')$ 的高斯过程。这些高斯过程分量是相互独立的。给定一个同位观测对和超参数如下：\n- 观测到的输入输出对：$(x_1, f_L(x_1), f_H(x_1)) = (\\,0,\\;0,\\;1\\,)$。\n- 自回归系数：$\\rho = \\frac{1}{2}$。\n- 低保真度协方差：$k_L(x,x') = \\sigma_L^2 \\exp\\!\\big(-\\frac{(x-x')^2}{2\\ell_L^2}\\big)$，其中 $\\sigma_L^2 = 1$ 且 $\\ell_L = 1$。\n- 差异协方差：$k_{\\Delta}(x,x') = \\sigma_{\\Delta}^2 \\exp\\!\\big(-\\frac{(x-x')^2}{2\\ell_{\\Delta}^2}\\big)$，其中 $\\sigma_{\\Delta}^2 = 1$ 且 $\\ell_{\\Delta} = 1$。\n- 观测噪声方差：$\\sigma_{n,L}^2 = 0$ 且 $\\sigma_{n,H}^2 = 0$。\n\n从高斯过程的核心定义和多元正态分布的性质出发，利用上述建模假设和超参数，计算高保真度函数 $f_H(x)$ 在测试输入 $x^{\\star} = 1$ 处的后验均值 $\\mu^{\\star}$ 和后验方差 $\\sigma_{\\star}^2$。将最终答案表示为行矩阵 $\\big(\\mu^{\\star},\\;\\sigma_{\\star}^2\\big)$ 的单个闭式解析表达式，并且不要四舍五入。",
            "solution": "该问题具有科学依据，提法恰当，客观且内部一致。它展示了多保真度高斯过程（GP）回归的一个标准应用。所有必要信息，包括模型结构、超参数和观测数据，均已提供。因此，该问题是有效的，并且可以推导出解。\n\n高保真度模型由以下自回归关系给出：\n$$f_H(x) = \\rho f_L(x) + \\delta(x)$$\n其中 $f_L(x)$ 和 $\\delta(x)$ 是独立的、均值为零的高斯过程。\n$f_L(x) \\sim \\mathcal{GP}(0, k_L(x,x'))$\n$\\delta(x) \\sim \\mathcal{GP}(0, k_{\\Delta}(x,x'))$\n\n我们的任务是，在给定观测值的条件下，求出 $f_H(x^{\\star})$ 在测试点 $x^{\\star} = 1$ 处的后验均值 $\\mu^{\\star}$ 和后验方差 $\\sigma_{\\star}^2$。\n\n$f_H(x^{\\star})$ 的后验分布是高斯分布，因为它是随机变量 $f_L(x^{\\star})$ 和 $\\delta(x^{\\star})$ 的线性组合，而这两个随机变量的后验分布也是高斯分布。$f_H(x^{\\star})$ 的后验均值和方差由随机变量线性组合的性质决定。\n\n根据期望的线性性质，后验均值为：\n$$\\mu^{\\star} = \\mathbb{E}[f_H(x^{\\star}) | \\text{data}] = \\mathbb{E}[\\rho f_L(x^{\\star}) + \\delta(x^{\\star}) | \\text{data}] = \\rho \\mathbb{E}[f_L(x^{\\star}) | \\text{data}] + \\mathbb{E}[\\delta(x^{\\star}) | \\text{data}]$$\n让我们记 $\\mu_{L}^{\\star} = \\mathbb{E}[f_L(x^{\\star}) | \\text{data}]$ 和 $\\mu_{\\delta}^{\\star} = \\mathbb{E}[\\delta(x^{\\star}) | \\text{data}]$。那么，$\\mu^{\\star} = \\rho \\mu_{L}^{\\star} + \\mu_{\\delta}^{\\star}$。\n\n鉴于高斯过程 $f_L(x)$ 和 $\\delta(x)$ 是独立的，并且它们各自的数据可以分离，因此它们的后验分布也是独立的。因此，后验方差是缩放后方差的和：\n$$\\sigma_{\\star}^2 = \\text{Var}[f_H(x^{\\star}) | \\text{data}] = \\text{Var}[\\rho f_L(x^{\\star}) + \\delta(x^{\\star}) | \\text{data}] = \\rho^2 \\text{Var}[f_L(x^{\\star}) | \\text{data}] + \\text{Var}[\\delta(x^{\\star}) | \\text{data}]$$\n让我们记 $\\sigma_{L, \\star}^2 = \\text{Var}[f_L(x^{\\star}) | \\text{data}]$ 和 $\\sigma_{\\delta, \\star}^2 = \\text{Var}[\\delta(x^{\\star}) | \\text{data}]$。那么，$\\sigma_{\\star}^2 = \\rho^2 \\sigma_{L, \\star}^2 + \\sigma_{\\delta, \\star}^2$。\n\n因此，该问题被分解为两个独立的 GP 回归任务。\n\n首先，我们必须确定每个过程的观测数据。我们得到了同位观测 $(x_1, f_L(x_1), f_H(x_1)) = (0, 0, 1)$，且噪声为零，因此这些是函数值的直接观测。\n- 对于低保真度过程 $f_L(x)$，我们有数据点 $D_L = \\{(x_1, y_L)\\}$，其中 $x_1 = 0$ 且 $y_L = f_L(0) = 0$。\n- 对于差异过程 $\\delta(x)$，我们可以从模型方程中推断其在 $x_1$ 处的值：\n$$\\delta(x_1) = f_H(x_1) - \\rho f_L(x_1)$$\n代入已知值 $\\rho = 1/2$，$f_H(0) = 1$ 和 $f_L(0) = 0$：\n$$y_{\\delta} = \\delta(0) = 1 - \\frac{1}{2}(0) = 1$$\n因此，对于差异过程 $\\delta(x)$，我们有数据点 $D_{\\delta} = \\{(x_1, y_{\\delta})\\}$，其中 $x_1 = 0$ 且 $y_{\\delta} = 1$。\n\n现在，我们应用标准的高斯过程条件公式。对于一个先验均值为 $0$、协方差为 $k(x,x')$ 的高斯过程，给定在输入 $X$ 处的观测值 $\\mathbf{y}$，其在测试点 $x^{\\star}$ 的后验分布是一个高斯分布，其均值 $\\mu_{\\star}$ 和方差 $\\sigma_{\\star}^2$ 由以下公式给出：\n$$\\mu_{\\star} = \\mathbf{k}_{\\star}^T (K + \\sigma_n^2 I)^{-1} \\mathbf{y}$$\n$$\\sigma_{\\star}^2 = k(x^{\\star}, x^{\\star}) - \\mathbf{k}_{\\star}^T (K + \\sigma_n^2 I)^{-1} \\mathbf{k}_{\\star}$$\n其中 $K = K(X, X)$ 是训练输入的协方差矩阵，$\\mathbf{k}_{\\star} = K(X, x^{\\star})$ 是训练输入和测试输入之间的协方差向量，$\\sigma_n^2$ 是观测噪声方差，在本问题中为 $0$。\n\n**1. $f_L(x^{\\star})$ 的后验分布**\n我们有一个训练点 $x_1 = 0$，其输出为 $y_L=0$。测试点是 $x^{\\star}=1$。\n协方差函数为 $k_L(x,x') = \\sigma_L^2 \\exp(-\\frac{(x-x')^2}{2\\ell_L^2}) = 1 \\cdot \\exp(-\\frac{(x-x')^2}{2})$。\n- $K = k_L(x_1, x_1) = k_L(0,0) = \\exp(0) = 1$。\n- $\\mathbf{k}_{\\star} = k_L(x_1, x^{\\star}) = k_L(0,1) = \\exp(-\\frac{(0-1)^2}{2}) = \\exp(-\\frac{1}{2})$。\n- $k(x^{\\star}, x^{\\star}) = k_L(1,1) = \\exp(0) = 1$。\n$f_L$ 的后验均值为：\n$$\\mu_{L}^{\\star} = k_L(1,0) [k_L(0,0)]^{-1} y_L = \\exp(-\\frac{1}{2}) \\cdot (1)^{-1} \\cdot 0 = 0$$\n$f_L$ 的后验方差为：\n$$\\sigma_{L, \\star}^2 = k_L(1,1) - k_L(1,0) [k_L(0,0)]^{-1} k_L(0,1) = 1 - \\exp(-\\frac{1}{2}) \\cdot (1)^{-1} \\cdot \\exp(-\\frac{1}{2}) = 1 - \\exp(-1)$$\n\n**2. $\\delta(x^{\\star})$ 的后验分布**\n我们有一个训练点 $x_1 = 0$，其输出为 $y_{\\delta}=1$。测试点是 $x^{\\star}=1$。\n协方差函数为 $k_{\\Delta}(x,x') = \\sigma_{\\Delta}^2 \\exp(-\\frac{(x-x')^2}{2\\ell_{\\Delta}^2}) = 1 \\cdot \\exp(-\\frac{(x-x')^2}{2})$。这与 $k_L$ 相同。\n- $K = k_{\\Delta}(0,0) = 1$。\n- $\\mathbf{k}_{\\star} = k_{\\Delta}(0,1) = \\exp(-\\frac{1}{2})$。\n- $k(x^{\\star}, x^{\\star}) = k_{\\Delta}(1,1) = 1$。\n$\\delta$ 的后验均值为：\n$$\\mu_{\\delta}^{\\star} = k_{\\Delta}(1,0) [k_{\\Delta}(0,0)]^{-1} y_{\\delta} = \\exp(-\\frac{1}{2}) \\cdot (1)^{-1} \\cdot 1 = \\exp(-\\frac{1}{2})$$\n$\\delta$ 的后验方差为：\n$$\\sigma_{\\delta, \\star}^2 = k_{\\Delta}(1,1) - k_{\\Delta}(1,0) [k_{\\Delta}(0,0)]^{-1} k_{\\Delta}(0,1) = 1 - \\exp(-\\frac{1}{2}) \\cdot (1)^{-1} \\cdot \\exp(-\\frac{1}{2}) = 1 - \\exp(-1)$$\n\n**3. 合并计算 $f_H(x^{\\star})$**\n使用来自两个独立回归的结果以及自回归系数 $\\rho = 1/2$：\n$f_H(x^{\\star})$ 的后验均值为：\n$$\\mu^{\\star} = \\rho \\mu_{L}^{\\star} + \\mu_{\\delta}^{\\star} = \\frac{1}{2} \\cdot 0 + \\exp(-\\frac{1}{2}) = \\exp(-\\frac{1}{2})$$\n$f_H(x^{\\star})$ 的后验方差为：\n$$\\sigma_{\\star}^2 = \\rho^2 \\sigma_{L, \\star}^2 + \\sigma_{\\delta, \\star}^2 = \\left(\\frac{1}{2}\\right)^2 (1 - \\exp(-1)) + (1 - \\exp(-1))$$\n$$\\sigma_{\\star}^2 = \\frac{1}{4}(1 - \\exp(-1)) + 1 \\cdot (1 - \\exp(-1)) = \\left(\\frac{1}{4} + 1\\right)(1 - \\exp(-1)) = \\frac{5}{4}(1 - \\exp(-1))$$\n$f_H(x^{\\star})$ 在 $x^{\\star} = 1$ 处的后验均值和方差分别为 $\\mu^{\\star} = \\exp(-\\frac{1}{2})$ 和 $\\sigma_{\\star}^2 = \\frac{5}{4}(1 - \\exp(-1))$。最终答案是行矩阵 $(\\mu^{\\star}, \\sigma_{\\star}^2)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp\\left(-\\frac{1}{2}\\right)  \\frac{5}{4}\\left(1 - \\exp(-1)\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在数字孪生等许多实际应用中，我们必须在预算限制下主动决定使用哪个模型或传感器来有效地收集信息。本练习要求您实现一个贪婪自适应策略，在每一步中最大化单位成本的预期信息增益。这项编码练习将理论付诸实践，挑战您构建一个能够进行经济权衡的智能代理，这对于在信息物理系统中设计高效的学习和控制策略至关重要 。",
            "id": "4232543",
            "problem": "您的任务是在数字孪生和信息物理系统 (CPS) 学科领域内，为一维传导环境中的热扩散系数参数识别问题，设计并实现一种自适应保真度选择策略。目标是在固定的总预算下，通过在每一步选择低保真度或高保真度传感器模型，来最小化估计的热扩散系数的后验不确定性，并将此自适应策略的效率与等效总成本下的固定保真度策略进行比较。\n\n基础理论：考虑一根长度为 $L$ 的杆上的一维热方程，其边界条件为零狄利克雷边界条件，\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2},\n$$\n其中 $u(x,t)$ 是温度场，$\\alpha$ 是热扩散系数（单位为 $\\mathrm{m}^2/\\mathrm{s}$），$x \\in [0,L]$ 是空间坐标，$t \\ge 0$ 是时间。假设初始条件为单个傅里叶正弦模态，\n$$\nu(x,0) = \\sin\\left(\\frac{\\pi x}{L}\\right),\n$$\n这会得到经过充分检验的解析解\n$$\nu(x,t;\\alpha) = \\sin\\left(\\frac{\\pi x}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{\\pi}{L}\\right)^2 t\\right).\n$$\n待识别的未知参数是 $\\alpha$。假设 $\\alpha$ 服从高斯先验分布，即 $\\alpha \\sim \\mathcal{N}(\\mu_0, s_0^2)$，其中 $\\mu_0$ 和 $s_0^2$ 分别表示先验均值和方差。\n\n定义两种传感器保真度模型：\n\n- 低保真度 ($L$)：一个结构阻尼模型，其缩放因子为 $\\chi_L = 1 - \\delta$，并带有标准差为 $\\sigma_L$ 的加性高斯噪声。其无噪声均值函数为\n$$\ng_L(\\alpha) = A \\exp\\left(-\\alpha \\chi_L k t\\right),\n$$\n其中 $A = \\sin\\left(\\frac{\\pi x}{L}\\right)$ 且 $k = \\left(\\frac{\\pi}{L}\\right)^2$。每次低保真度测量的成本为 $c_L$。\n\n- 高保真度 ($H$)：一个精确模型，其 $\\chi_H = 1$，并带有标准差为 $\\sigma_H$ 的加性高斯噪声，\n$$\ng_H(\\alpha) = A \\exp\\left(-\\alpha \\chi_H k t\\right) = A \\exp\\left(-\\alpha k t\\right),\n$$\n且每次高保真度测量的成本为 $c_H$。\n\n自适应选择策略要求：实现一个自适应保真度选择策略，在每一步中，该策略在当前后验均值附近的局部线性化下，选择 $L$ 或 $H$ 以最大化单位成本的后验方差期望减少量。使用单步线性高斯更新近似，其中雅可比矩阵在当前后验均值 $\\mu$ 处进行评估，\n$$\nJ_f(\\mu) \\equiv \\frac{\\partial g_f}{\\partial \\alpha}\\Big|_{\\alpha=\\mu} = -A \\chi_f k t \\exp\\left(-\\mu \\chi_f k t\\right),\n$$\n其中 $f \\in \\{L,H\\}$。对于带有高斯噪声 $\\mathcal{N}(0,\\sigma_f^2)$ 的线性化模型，进行一次保真度为 $f$ 的测量后的后验方差更新公式为\n$$\ns_{\\text{new}}^2 = s^2 - \\frac{s^4 J_f(\\mu)^2}{\\sigma_f^2 + s^2 J_f(\\mu)^2}.\n$$\n设计自适应策略以选择能最大化效率比的保真度 $f$，该效率比定义为单位成本的期望方差减少量，\n$$\n\\rho_f \\equiv \\frac{s^2 - s_{\\text{new}}^2}{c_f} = \\frac{s^4 J_f(\\mu)^2}{\\left(\\sigma_f^2 + s^2 J_f(\\mu)^2\\right) c_f}.\n$$\n贪婪地执行此过程，直到剩余预算无法承担任何一次测量。为了对期望信息进行确定性评估，在整个过程中，将后验均值固定为 $\\mu$ 用于雅可比矩阵的评估，并且在每一步之后仅更新后验方差 $s^2$。\n\n固定保真度基准：实现两个基准策略，它们将相同的总预算完全用于单一保真度：\n- 固定低保真度：重复选择 $L$ 直到预算耗尽。\n- 固定高保真度：重复选择 $H$ 直到预算耗尽。\n\n输出要求：对于每个测试用例，计算三个最终后验方差，以 $(\\mathrm{m}^2/\\mathrm{s})^2$ 为单位表示：$v_{\\text{adapt}}$、$v_{\\text{fixed-low}}$ 和 $v_{\\text{fixed-high}}$。您的程序应生成单行输出，其中包含结果，格式为一个由列表组成的逗号分隔列表，每个测试用例一个列表，每个内部列表的顺序为 $[v_{\\text{adapt}}, v_{\\text{fixed-low}}, v_{\\text{fixed-high}}]$。\n\n测试套件：使用以下四组科学上现实的参数集。每个测试用例指定为 $(L, x, t, \\mu_0, s_0, \\delta, \\sigma_L, \\sigma_H, c_L, c_H, B)$，其中 $L$ 的单位是米， $x$ 的单位是米， $t$ 的单位是秒，$\\mu_0$ 和 $s_0$ 的单位是 $\\mathrm{m}^2/\\mathrm{s}$ (注意 $s_0$ 是先验标准差)，$\\delta$ 是无量纲的，$\\sigma_L$ 和 $\\sigma_H$ 是温度幅值，与 $u$ 具有相同的无量纲单位，成本 $c_L$ 和 $c_H$ 使用任意成本单位，总预算 $B$ 也使用相同的成本单位。最终的后验方差必须以 $(\\mathrm{m}^2/\\mathrm{s})^2$ 表示。\n\n- 情况1（理想路径）：$(L,x,t,\\mu_0,s_0,\\delta,\\sigma_L,\\sigma_H,c_L,c_H,B) = (1.0, 0.5, 2.0, 0.2, 0.05, 0.1, 0.05, 0.01, 1.0, 5.0, 20.0)$。\n- 情况2（预算边界：不足以执行任何高保真度步骤）：$(1.0, 0.5, 2.0, 0.2, 0.05, 0.1, 0.05, 0.01, 1.0, 5.0, 1.0)$。\n- 情况3（低保真度相对便宜但噪声中等）：$(1.0, 0.5, 2.0, 0.2, 0.05, 0.0, 0.02, 0.01, 1.0, 10.0, 15.0)$。\n- 情况4（低保真度结构偏差大且观测时间更长）：$(1.0, 0.5, 5.0, 0.2, 0.05, 0.3, 0.05, 0.01, 1.0, 5.0, 20.0)$。\n\n实现细节：\n- 计算 $A = \\sin\\left(\\frac{\\pi x}{L}\\right)$ 和 $k = \\left(\\frac{\\pi}{L}\\right)^2$。\n- 使用 $\\chi_L = 1 - \\delta$ 和 $\\chi_H = 1$。\n- 从方差 $s^2 = s_0^2$ 开始；每次选择测量后，使用局部线性化公式更新 $s^2$。\n- 自适应策略必须在剩余预算可承受的保真度中，选择能最大化 $\\rho_f$ 的保真度 $f \\in \\{L,H\\}$；如果两者都无法承受，则中断。\n- 对于固定低保真度和固定高保真度策略，重复选择直到剩余预算无法承担下一次测量。\n- 不允许随机抽样；所有计算必须是确定性的，并且仅基于局部线性化和方差更新。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、由列表组成的逗号分隔列表，例如 $[[\\text{case1}], [\\text{case2}], [\\text{case3}], [\\text{case4}]]$，其中每个内部列表为 $[v_{\\text{adapt}}, v_{\\text{fixed-low}}, v_{\\text{fixed-high}}]$，每个 $v$ 是一个以 $(\\mathrm{m}^2/\\mathrm{s})^2$ 为单位的浮点数。",
            "solution": "已对用户提供的问题陈述进行分析，并确认其有效。该问题具有科学依据，问题定义明确，目标客观，并包含推导唯一、可验证解所需的所有必要信息。\n\n该问题要求设计并实现三种不同的策略，用于在一个一维热传导问题中分配固定的计算预算来估计热扩散系数参数 $\\alpha$。其目标是比较一种自适应多保真度采样策略与两种固定保真度基准策略在减少 $\\alpha$ 估计值的后验方差方面的有效性。\n\n物理系统是一根长度为 $L$ 的一维杆，由热方程控制：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n在指定的初始条件 $u(x,0) = \\sin\\left(\\frac{\\pi x}{L}\\right)$ 和零狄利克雷边界条件下，温度场 $u(x,t)$ 的解析解由下式给出：\n$$\nu(x,t;\\alpha) = \\sin\\left(\\frac{\\pi x}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{\\pi}{L}\\right)^2 t\\right)\n$$\n待推断的参数 $\\alpha$ 使用高斯先验分布建模，即 $\\alpha \\sim \\mathcal{N}(\\mu_0, s_0^2)$，其中 $\\mu_0$ 是先验均值，$s_0^2$ 是先验方差。\n\n测量值从两种不同保真度和成本的传感器模型中获得：\n1.  低保真度 ($L$) 模型，该模型存在结构性偏差且含有噪声。其无噪声均值函数为 $g_L(\\alpha) = A \\exp(-\\alpha \\chi_L k t)$，其中 $A = \\sin\\left(\\frac{\\pi x}{L}\\right)$，$k = \\left(\\frac{\\pi}{L}\\right)^2$，$\\chi_L = 1 - \\delta$ 是一个结构偏差因子。来自该模型的测量具有相关成本 $c_L$，并受到方差为 $\\sigma_L^2$ 的加性高斯噪声的干扰。\n2.  高保真度 ($H$) 模型，该模型在结构上是准确的。其无噪声均值函数为 $g_H(\\alpha) = A \\exp(-\\alpha \\chi_H k t)$，其中 $\\chi_H = 1$。测量的成本为 $c_H$，并受到方差为 $\\sigma_H^2$ 的加性高斯噪声的干扰。\n\n推断过程使用基于传感器模型局部线性化的简化贝叶斯更新。模型 $g_f$ (其中 $f \\in \\{L, H\\}$) 的雅可比矩阵在先验均值 $\\mu_0$ 处进行评估：\n$$\nJ_f(\\mu_0) \\equiv \\frac{\\partial g_f}{\\partial \\alpha}\\Big|_{\\alpha=\\mu_0} = -A \\chi_f k t \\exp\\left(-\\mu_0 \\chi_f k t\\right)\n$$\n根据问题规范，对于给定的测试用例，该雅可比矩阵在整个模拟过程中保持不变。给定 $\\alpha$ 的当前后验方差 $s^2$，来自模型 $f$ 的单次测量根据以下公式将方差更新为 $s_{\\text{new}}^2$：\n$$\ns_{\\text{new}}^2 = s^2 - \\frac{s^4 J_f(\\mu_0)^2}{\\sigma_f^2 + s^2 J_f(\\mu_0)^2}\n$$\n为保证数值稳定性和效率，此更新使用精度（方差的倒数）来实现。如果 $p = 1/s^2$ 是当前精度，则一次测量后的更新精度为 $p_{\\text{new}} = p + J_f(\\mu_0)^2 / \\sigma_f^2$。然后，新的方差为 $s_{\\text{new}}^2 = 1/p_{\\text{new}}$。\n\n为花费总预算 $B$，实现了三种策略：\n\n1.  **自适应策略**：在每一步，该策略贪婪地选择能最大化单位成本预期后验方差减少量的测量。每种保真度 $f$ 的效率度量 $\\rho_f$ 为：\n    $$\n    \\rho_f = \\frac{s^2 - s_{\\text{new}}^2}{c_f} = \\frac{s^4 J_f(\\mu_0)^2}{\\left(\\sigma_f^2 + s^2 J_f(\\mu_0)^2\\right) c_f}\n    $$\n    该策略根据当前后验方差 $s^2$ 计算 $\\rho_L$ 和 $\\rho_H$，并在剩余预算可承受的前提下，选择具有较高 $\\rho$ 值的保真度。当两种类型的测量都无法承担时，模拟终止。\n\n2.  **固定低保真度策略**：此基准策略仅使用低保真度模型。它重复使用模型 $L$ 进行测量，在每一步更新后验方差并将预算减少 $c_L$，直到剩余预算小于 $c_L$。\n\n3.  **固定高保真度策略**：此基准策略仅使用高保真度模型。它重复使用模型 $H$ 进行测量，每步成本为 $c_H$，直到预算耗尽。\n\n对于每个测试用例，这三种策略都独立运行，每种策略都以相同的初始方差 $s_0^2$ 和总预算 $B$ 开始。然后报告每种策略的最终后验方差（$v_{\\text{adapt}}$、$v_{\\text{fixed-low}}$、$v_{\\text{fixed-high}}$）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the adaptive fidelity selection problem for all test cases.\n    \"\"\"\n    # Test suite as specified in the problem statement.\n    # Each case: (L, x, t, mu_0, s_0, delta, sigma_L, sigma_H, c_L, c_H, B)\n    test_cases = [\n        (1.0, 0.5, 2.0, 0.2, 0.05, 0.1, 0.05, 0.01, 1.0, 5.0, 20.0), # Case 1\n        (1.0, 0.5, 2.0, 0.2, 0.05, 0.1, 0.05, 0.01, 1.0, 5.0, 1.0),   # Case 2\n        (1.0, 0.5, 2.0, 0.2, 0.05, 0.0, 0.02, 0.01, 1.0, 10.0, 15.0), # Case 3\n        (1.0, 0.5, 5.0, 0.2, 0.05, 0.3, 0.05, 0.01, 1.0, 5.0, 20.0),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        variances = run_simulation_for_case(case)\n        results.append(variances)\n    \n    # Format the final output as a comma-separated list of lists.\n    # The str() function on a list correctly produces the bracketed format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation_for_case(case):\n    \"\"\"\n    Runs the simulations for the adaptive, fixed-low, and fixed-high strategies for a single case.\n    Returns a list of final posterior variances [v_adapt, v_fixed_low, v_fixed_high].\n    \"\"\"\n    # Unpack parameters from the test case tuple\n    L, x, t, mu_0, s_0, delta, sigma_L, sigma_H, c_L, c_H, B = case\n\n    # Initial variance and noise variances\n    s2_initial = s_0 ** 2\n    sigma_L_sq = sigma_L ** 2\n    sigma_H_sq = sigma_H ** 2\n\n    # Pre-compute constants\n    A = np.sin(np.pi * x / L)\n    k = (np.pi / L) ** 2\n    chi_L = 1.0 - delta\n    chi_H = 1.0\n\n    # Pre-compute Jacobians (evaluated at mu_0 and held constant) and their squares\n    J_L = -A * chi_L * k * t * np.exp(-mu_0 * chi_L * k * t)\n    J_H = -A * chi_H * k * t * np.exp(-mu_0 * chi_H * k * t)\n    J_L_sq = J_L ** 2\n    J_H_sq = J_H ** 2\n\n    # --- Strategy 1: Adaptive Fidelity Selection ---\n    s2_adapt = s2_initial\n    budget_adapt = B\n    while True:\n        can_afford_L = budget_adapt >= c_L\n        can_afford_H = budget_adapt >= c_H\n\n        rho_L = -1\n        if can_afford_L:\n            # Efficiency for low-fidelity model\n            numerator_L = (s2_adapt ** 2) * J_L_sq\n            denominator_L = (sigma_L_sq + s2_adapt * J_L_sq) * c_L\n            rho_L = numerator_L / denominator_L\n\n        rho_H = -1\n        if can_afford_H:\n            # Efficiency for high-fidelity model\n            numerator_H = (s2_adapt ** 2) * J_H_sq\n            denominator_H = (sigma_H_sq + s2_adapt * J_H_sq) * c_H\n            rho_H = numerator_H / denominator_H\n        \n        # Decision logic\n        if not can_afford_L and not can_afford_H:\n            break\n        \n        # Use precision update for numerical stability: p_new = p_old + J^2/sigma^2\n        p_adapt = 1.0 / s2_adapt\n        if (can_afford_L and rho_L > rho_H) or (can_afford_L and not can_afford_H):\n            p_adapt += J_L_sq / sigma_L_sq\n            budget_adapt -= c_L\n        elif can_afford_H:\n            p_adapt += J_H_sq / sigma_H_sq\n            budget_adapt -= c_H\n        \n        s2_adapt = 1.0 / p_adapt\n            \n    v_adapt = s2_adapt\n\n    # --- Strategy 2: Fixed-Low Fidelity ---\n    s2_low = s2_initial\n    budget_low = B\n    p_low = 1.0 / s2_low\n    info_gain_low = J_L_sq / sigma_L_sq\n    while budget_low >= c_L:\n        p_low += info_gain_low\n        budget_low -= c_L\n    v_fixed_low = 1.0 / p_low if (1.0/s2_initial) != p_low else s2_initial\n\n    # --- Strategy 3: Fixed-High Fidelity ---\n    s2_high = s2_initial\n    budget_high = B\n    p_high = 1.0 / s2_high\n    info_gain_high = J_H_sq / sigma_H_sq\n    while budget_high >= c_H:\n        p_high += info_gain_high\n        budget_high -= c_H\n    v_fixed_high = 1.0 / p_high if (1.0/s2_initial) != p_high else s2_initial\n\n    return [v_adapt, v_fixed_low, v_fixed_high]\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}