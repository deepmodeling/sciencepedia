{
    "hands_on_practices": [
        {
            "introduction": "At the heart of fluid dynamics lies the principle of mass conservation. For incompressible flows, where density is treated as constant, this principle manifests as a strict mathematical constraint on the velocity field itself. This first exercise provides a foundational practice in connecting the physical law, expressed in its integral form, to its local differential form—the continuity equation—and then using it to verify the incompressibility of a given flow field, a crucial first step in analyzing or simulating any fluid system. ",
            "id": "4209477",
            "problem": "A Digital Twin (DT) of a Cyber-Physical System (CPS) is being validated against mass conservation for a two-dimensional computational fluid dynamics (CFD) surrogate velocity field. Consider the velocity field given by $\\mathbf{u}(x,y) = (a x,\\,-a y)$, where $a$ is a constant with dimensions of $\\text{s}^{-1}$, and the fluid density $\\rho$ is spatially uniform and constant in time. Starting from the integral statement of mass conservation for an arbitrary fixed control volume, derive the local differential form of the continuity equation. Then evaluate $\\nabla \\cdot \\mathbf{u}$ and use your derivation to assess whether the flow is incompressible under the stated conditions. Provide your computed value of $\\nabla \\cdot \\mathbf{u}$ expressed in $\\text{s}^{-1}$. No rounding is required; report the exact value.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Velocity field: $\\mathbf{u}(x,y) = (a x,\\,-a y)$\n- Constant: $a$ with dimensions of $\\text{s}^{-1}$\n- Fluid density: $\\rho$ is spatially uniform and constant in time.\n- Task 1: Start from the integral statement of mass conservation for an arbitrary fixed control volume and derive the local differential form of the continuity equation.\n- Task 2: Evaluate $\\nabla \\cdot \\mathbf{u}$.\n- Task 3: Use the derivation to assess whether the flow is incompressible.\n- Task 4: Provide the computed value of $\\nabla \\cdot \\mathbf{u}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on the fundamental principle of mass conservation in fluid dynamics (the continuity equation) and uses a standard, physically realistic velocity field (stagnation-point flow). The context of CFD for Digital Twins is appropriate. The problem is scientifically sound.\n- **Well-Posedness**: The problem provides all necessary information to perform the requested derivation and calculation. The objectives are clear, and a unique, meaningful solution exists.\n- **Objectivity**: The problem is stated using precise, objective, and technical language.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A full solution will be provided.\n\n**Derivation of the Differential Form of the Continuity Equation**\n\nThe principle of mass conservation states that for any arbitrary control volume $V$ fixed in space, with a boundary surface $S$, the rate of increase of mass within the volume must equal the net rate of mass flow into the volume. This is expressed in integral form as:\n$$\n\\frac{d}{dt} \\int_V \\rho \\, dV = - \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS\n$$\nwhere $\\rho$ is the fluid density, $\\mathbf{u}$ is the velocity field, and $\\mathbf{n}$ is the outward-pointing unit normal vector to the surface element $dS$. Rearranging gives the standard form:\n$$\n\\frac{d}{dt} \\int_V \\rho \\, dV + \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS = 0\n$$\n\nThe first term represents the rate of change of mass inside the control volume, and the second term represents the net mass flux out of the control volume through its surface $S$.\n\nSince the control volume $V$ is fixed, the time derivative can be moved inside the integral, acting on the density field:\n$$\n\\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS = 0\n$$\n\nNext, we apply the Divergence Theorem (or Gauss's Theorem) to the surface integral. The theorem states that for a vector field $\\mathbf{F}$, $\\oint_S \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\int_V \\nabla \\cdot \\mathbf{F} \\, dV$. In our case, the vector field is the mass flux density, $\\mathbf{F} = \\rho \\mathbf{u}$. Applying the theorem transforms the surface integral into a volume integral:\n$$\n\\oint_S (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV\n$$\n\nSubstituting this back into the conservation equation yields:\n$$\n\\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0\n$$\n\nCombining the two volume integrals gives:\n$$\n\\int_V \\left( \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) \\right) \\, dV = 0\n$$\n\nThis integral equation must hold for any arbitrary control volume $V$. This can only be true if the integrand itself is identically zero at every point in space. Therefore, we arrive at the local differential form of the continuity equation:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n\n**Application to Incompressible Flow**\n\nThe problem states that the fluid density $\\rho$ is spatially uniform and constant in time.\n- \"Constant in time\" implies that the partial derivative of density with respect to time is zero: $\\frac{\\partial \\rho}{\\partial t} = 0$.\n- \"Spatially uniform\" implies that the density does not vary with position, so its gradient is zero: $\\nabla \\rho = 0$.\n\nSubstituting $\\frac{\\partial \\rho}{\\partial t} = 0$ into the continuity equation gives:\n$$\n\\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n\nUsing the vector calculus identity $\\nabla \\cdot (f\\mathbf{A}) = f(\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot (\\nabla f)$, with $f = \\rho$ and $\\mathbf{A} = \\mathbf{u}$, we can expand the divergence term:\n$$\n\\rho (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot (\\nabla \\rho) = 0\n$$\n\nSince the density is spatially uniform, $\\nabla \\rho = 0$, and the second term vanishes:\n$$\n\\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n\nAs the fluid density $\\rho$ is a physical property and must be non-zero (i.e., $\\rho \\neq 0$), the equation can only be satisfied if the divergence of the velocity field is zero:\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\n\nThis condition, $\\nabla \\cdot \\mathbf{u} = 0$, is the mathematical definition of an incompressible flow. A velocity field is considered incompressible if its divergence is zero.\n\n**Evaluation for the Given Velocity Field**\n\nThe problem provides the two-dimensional velocity field $\\mathbf{u}(x,y) = (u,v)$, where the components are $u = ax$ and $v = -ay$. We will now compute the divergence of this field.\n\nThe divergence operator in two-dimensional Cartesian coordinates is given by $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$.\n\nFirst, we calculate the partial derivative of the $x$-component of velocity with respect to $x$:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(ax) = a\n$$\n\nNext, we calculate the partial derivative of the $y$-component of velocity with respect to $y$:\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(-ay) = -a\n$$\n\nNow, we sum these partial derivatives to find the divergence:\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = a + (-a) = 0\n$$\n\n**Assessment and Final Value**\n\nThe computed divergence of the velocity field is $\\nabla \\cdot \\mathbf{u} = 0$. Based on our derivation, this is precisely the condition for an incompressible flow. Therefore, the given velocity field $\\mathbf{u}(x,y) = (ax, -ay)$ represents an incompressible flow.\n\nThe problem asks for the computed value of $\\nabla \\cdot \\mathbf{u}$. The value is $0$. The constant $a$ has units of $\\text{s}^{-1}$, so the derivatives $\\frac{\\partial u}{\\partial x}$ and $\\frac{\\partial v}{\\partial y}$ also have units of $\\text{s}^{-1}$. Their sum, the divergence, therefore has units of $\\text{s}^{-1}$.\nThe final value is $0 \\, \\text{s}^{-1}$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Translating the continuous laws of physics into discrete algorithms for a computer is the essence of CFD, but this process brings the critical challenge of numerical stability. An unstable scheme can produce wildly oscillating, non-physical results, rendering a simulation useless. This practice introduces the rigorous von Neumann stability analysis, a cornerstone technique used to derive the conditions under which a numerical scheme remains stable, by examining how it amplifies or dampens errors in the solution. ",
            "id": "4209519",
            "problem": "A cyber-physical Digital Twin (DT) of a long, straight pipeline models the transport of a passive scalar field $\\phi(x,t)$ by a constant axial velocity $a$ using the linear advection equation $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$. The DT advances the field state on a uniform grid of spacing $\\Delta x$ with periodic boundary conditions by an explicit forward-Euler time integrator and a first-order ($1$) upwind spatial discretization consistent with the sign of $a$. Assume $a \\neq 0$. To ensure numerically stable synchronization between the DT and its physical counterpart, determine the largest allowable time step that guarantees linear stability of all Fourier modes of the discretized scheme.\n\nStarting only from the given partial differential equation, the stated discretization choices, and first principles (conservation, consistency, and mode-wise amplification boundedness), derive the stability constraint by requiring that the amplification factor of any spatial Fourier mode has magnitude at most $1$ for all wavenumbers. Then extract from this constraint the maximum stable time step as a closed-form expression in terms of $a$ and $\\Delta x$.\n\nProvide your final answer as a single closed-form symbolic expression in terms of $a$ and $\\Delta x$. Do not include units. No numerical rounding is required.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Partial Differential Equation (PDE)**: The linear advection equation for a passive scalar $\\phi(x,t)$ is $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$.\n- **Advection Velocity**: $a$ is a constant and $a \\neq 0$.\n- **Numerical Grid**: The spatial domain is discretized on a uniform grid with spacing $\\Delta x$.\n- **Boundary Conditions**: The domain has periodic boundary conditions.\n- **Time Integration Scheme**: An explicit forward-Euler method is used.\n- **Spatial Discretization Scheme**: A first-order upwind scheme is used, with the direction chosen based on the sign of $a$.\n- **Stability Criterion**: The amplification factor $\\lambda$ of any spatial Fourier mode must satisfy $|\\lambda| \\le 1$.\n- **Objective**: Derive the stability constraint and determine the largest allowable time step, $\\Delta t_{max}$, as a closed-form expression in terms of $a$ and $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic exercise in the von Neumann stability analysis of finite difference schemes for a fundamental PDE.\n- **Scientific Grounding**: The linear advection equation is a cornerstone of transport phenomena. The forward-Euler and first-order upwind methods are standard, albeit simple, numerical schemes. Von Neumann stability analysis is the canonical method for analyzing linear, constant-coefficient schemes on uniform grids with periodic boundary conditions. The problem is firmly rooted in the principles of numerical analysis and computational fluid dynamics.\n- **Well-Posedness**: All necessary components are provided: the governing equation, the temporal and spatial discretization methods, the grid structure, and the boundary conditions. The objective is clearly and unambiguously stated.\n- **Objectivity**: The problem is stated in precise, formal language, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is scientifically sound, well-posed, and all information required for a unique solution is provided. I will proceed with the derivation.\n\n### Solution Derivation\n\nThe analysis begins by constructing the fully discretized form of the governing PDE, $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$. Let $\\phi_j^n$ denote the numerical approximation of the scalar field $\\phi$ at spatial grid point $x_j = j\\Delta x$ and time $t_n = n\\Delta t$.\n\nThe temporal derivative is discretized using the explicit forward-Euler scheme:\n$$ \\partial_{t}\\phi \\approx \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} $$\n\nThe spatial derivative is discretized using a first-order upwind scheme, which depends on the sign of the velocity $a$. The \"upwind\" direction is the direction from which information is flowing.\n\n**Case 1: $a > 0$**\nThe flow is in the positive $x$-direction. Information at grid point $j$ arrives from the left (from point $j-1$). The upwind spatial derivative is a backward difference:\n$$ \\partial_{x}\\phi \\approx \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} $$\nSubstituting these discretizations into the PDE gives:\n$$ \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + a \\left( \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} \\right) = 0 $$\nSolving for the state at the next time step, $\\phi_j^{n+1}$:\n$$ \\phi_j^{n+1} = \\phi_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( \\phi_j^n - \\phi_{j-1}^n \\right) $$\nLet's define the Courant number $C$ as $C = \\frac{a \\Delta t}{\\Delta x}$. Since $a > 0$, we have $C > 0$. The equation becomes:\n$$ \\phi_j^{n+1} = (1 - C) \\phi_j^n + C \\phi_{j-1}^n $$\n\n**Case 2: $a  0$**\nThe flow is in the negative $x$-direction. Information at grid point $j$ arrives from the right (from point $j+1$). The upwind spatial derivative is a forward difference:\n$$ \\partial_{x}\\phi \\approx \\frac{\\phi_{j+1}^n - \\phi_j^n}{\\Delta x} $$\nSubstituting into the PDE:\n$$ \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + a \\left( \\frac{\\phi_{j+1}^n - \\phi_j^n}{\\Delta x} \\right) = 0 $$\nSolving for $\\phi_j^{n+1}$:\n$$ \\phi_j^{n+1} = \\phi_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( \\phi_{j+1}^n - \\phi_j^n \\right) $$\nUsing the same definition for the Courant number, $C = \\frac{a \\Delta t}{\\Delta x}$, which is now negative ($C  0$), we get:\n$$ \\phi_j^{n+1} = (1 + C) \\phi_j^n - C \\phi_{j+1}^n $$\nTo unify the analysis, it is more convenient to use the absolute Courant number, $C_{abs} = \\frac{|a| \\Delta t}{\\Delta x}$. Note that $C_{abs}$ is always non-negative.\nFor $a>0$, $C = C_{abs}$. The scheme is $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j-1}^n$.\nFor $a0$, $C = -C_{abs}$. The scheme becomes $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j+1}^n$.\n\nWe now perform a von Neumann stability analysis. A single Fourier mode of the solution is represented as:\n$$ \\phi_j^n = \\hat{\\phi}^n(k) e^{i k x_j} = \\hat{\\phi}^n(k) e^{i k j \\Delta x} $$\nwhere $k$ is the wavenumber and $i = \\sqrt{-1}$. The amplification factor, $\\lambda(k)$, relates the amplitude of the mode at successive time steps: $\\hat{\\phi}^{n+1}(k) = \\lambda(k) \\hat{\\phi}^n(k)$. Stability requires $|\\lambda(k)| \\le 1$ for all wavenumbers $k$.\n\nWe analyze the two cases for $a$.\n\n**Stability Analysis for $a > 0$:**\nSubstitute the Fourier mode into the discretized equation $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j-1}^n$:\n$$ \\lambda(k) \\hat{\\phi}^n(k) e^{i k j \\Delta x} = (1 - C_{abs}) \\hat{\\phi}^n(k) e^{i k j \\Delta x} + C_{abs} \\hat{\\phi}^n(k) e^{i k (j-1) \\Delta x} $$\nDividing by $\\hat{\\phi}^n(k) e^{i k j \\Delta x}$ yields the amplification factor:\n$$ \\lambda(k) = 1 - C_{abs} + C_{abs} e^{-i k \\Delta x} $$\nLet $\\theta = k \\Delta x$ be the dimensionless phase angle.\n$$ \\lambda(\\theta) = 1 - C_{abs} + C_{abs}(\\cos\\theta - i\\sin\\theta) = (1 - C_{abs} + C_{abs}\\cos\\theta) - i(C_{abs}\\sin\\theta) $$\nThe magnitude squared of the amplification factor is:\n$$ |\\lambda(\\theta)|^2 = (1 - C_{abs} + C_{abs}\\cos\\theta)^2 + (-C_{abs}\\sin\\theta)^2 $$\n$$ |\\lambda(\\theta)|^2 = (1-C_{abs})^2 + 2C_{abs}(1-C_{abs})\\cos\\theta + C_{abs}^2\\cos^2\\theta + C_{abs}^2\\sin^2\\theta $$\n$$ |\\lambda(\\theta)|^2 = (1-C_{abs})^2 + 2C_{abs}(1-C_{abs})\\cos\\theta + C_{abs}^2 $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs} + C_{abs}^2 + 2C_{abs}\\cos\\theta - 2C_{abs}^2\\cos\\theta + C_{abs}^2 $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - \\cos\\theta) + 2C_{abs}^2(1 - \\cos\\theta) $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) $$\nFor stability, $|\\lambda(\\theta)|^2 \\le 1$.\n$$ 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) \\le 1 $$\n$$ -2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) \\le 0 $$\nSince $C_{abs} = \\frac{|a|\\Delta t}{\\Delta x} > 0$ and the term $(1 - \\cos\\theta)$ is always non-negative (ranging from $0$ to $2$), the inequality is satisfied if and only if:\n$$ 1 - C_{abs} \\ge 0 \\implies C_{abs} \\le 1 $$\n\n**Stability Analysis for $a  0$:**\nSubstitute the Fourier mode into the discretized equation $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j+1}^n$:\n$$ \\lambda(k) \\hat{\\phi}^n(k) e^{i k j \\Delta x} = (1 - C_{abs}) \\hat{\\phi}^n(k) e^{i k j \\Delta x} + C_{abs} \\hat{\\phi}^n(k) e^{i k (j+1) \\Delta x} $$\nDividing by $\\hat{\\phi}^n(k) e^{i k j \\Delta x}$:\n$$ \\lambda(k) = 1 - C_{abs} + C_{abs} e^{i k \\Delta x} $$\n$$ \\lambda(\\theta) = 1 - C_{abs} + C_{abs}(\\cos\\theta + i\\sin\\theta) = (1 - C_{abs} + C_{abs}\\cos\\theta) + i(C_{abs}\\sin\\theta) $$\nThe magnitude squared is:\n$$ |\\lambda(\\theta)|^2 = (1 - C_{abs} + C_{abs}\\cos\\theta)^2 + (C_{abs}\\sin\\theta)^2 $$\nThe result is identical to the case $a > 0$:\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) $$\nThe stability condition is therefore also identical: $C_{abs} \\le 1$.\n\n**Conclusion on Stability:**\nFor any non-zero velocity $a$, the numerical scheme is stable if and only if the absolute Courant number is less than or equal to $1$.\n$$ C_{abs} = \\frac{|a| \\Delta t}{\\Delta x} \\le 1 $$\nThis is the celebrated Courant-Friedrichs-Lewy (CFL) condition for this particular numerical method. The largest allowable time step, $\\Delta t_{max}$, is found when this inequality becomes an equality:\n$$ \\frac{|a| \\Delta t_{max}}{\\Delta x} = 1 $$\nSolving for $\\Delta t_{max}$ yields the final expression:\n$$ \\Delta t_{max} = \\frac{\\Delta x}{|a|} $$",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|a|}}$$"
        },
        {
            "introduction": "Having established the incompressibility constraint, $\\nabla \\cdot \\mathbf{u} = 0$, and the importance of numerical stability, we now address how to enforce this constraint within a numerical solver. The projection method is an elegant and powerful algorithm that decouples the calculation of velocity and pressure in incompressible flow simulations. This exercise will guide you through the core logic of this method, demonstrating how an intermediate, non-divergence-free velocity field is corrected by a pressure field to produce a final velocity that rigorously satisfies mass conservation. ",
            "id": "4209490",
            "problem": "A Digital Twin (DT) of an internal flow within a Cyber-Physical System (CPS) pipeline segment is simulated using a standard staggered-grid projection method from Computational Fluid Dynamics (CFD) for incompressible flow. Consider a two-dimensional periodic domain $\\Omega = [0,2\\pi] \\times [0,2\\pi]$. The fluid density is constant and equal to $\\rho$, and the time-step size is $\\Delta t$. In a fractional-step update, an intermediate velocity field $\\mathbf{u}^{*}(x,y)$ is available from a provisional momentum step that excludes pressure. To enforce incompressibility in the DT at the next time step, a scalar pressure field $p(x,y)$ is introduced which satisfies the Poisson equation consistent with mass conservation on a periodic domain. Specifically, $p$ is determined such that the corrected velocity field $\\mathbf{u}^{n+1}(x,y)$ satisfies the incompressibility constraint and periodic boundary conditions.\n\nYou are given the intermediate velocity field\n$$\n\\mathbf{u}^{*}(x,y) = \\begin{pmatrix}\n\\sin(x)\\cos(y) \\\\\n\\cos(x)\\sin(y)\n\\end{pmatrix},\n$$\nand that the pressure field $p(x,y)$ solves the Poisson equation on $\\Omega$ with periodic boundary conditions and zero-mean condition,\n$$\n\\nabla^{2} p = \\frac{\\rho}{\\Delta t}\\,\\nabla \\cdot \\mathbf{u}^{*}, \\quad \\int_{\\Omega} p \\, dx\\,dy = 0.\n$$\n\nStarting only from the incompressibility constraint for the corrected velocity $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ and the definition of the fractional-step projection that enforces this constraint, derive the correction relation between $\\mathbf{u}^{n+1}$, $\\mathbf{u}^{*}$, and $p$. Then, using the given $\\mathbf{u}^{*}$ and the periodic Poisson equation for $p$, compute the closed-form expression of the projected velocity field $\\mathbf{u}^{n+1}(x,y)$ over $\\Omega$.\n\nExpress your final answer as a single analytic expression for the two components assembled as a row matrix using the $\\mathrm{pmatrix}$ environment. No rounding is required.",
            "solution": "The problem requires us to first derive the correction relation in a fractional-step projection method for incompressible flow and then apply this framework to find the final, divergence-free velocity field $\\mathbf{u}^{n+1}$ given a specific intermediate velocity field $\\mathbf{u}^{*}$.\n\nThe fractional-step projection method decouples the velocity and pressure updates for the incompressible Navier-Stokes equations. The update from time step $n$ to $n+1$ is split into two conceptual stages.\n\nFirst, a provisional or intermediate velocity field, which we denote as $\\mathbf{u}^{*}$, is computed by advancing the momentum equation in time, but explicitly omitting the pressure gradient term. This step typically accounts for convection, diffusion, and body forces. The problem provides this intermediate field directly, so we do not need to concern ourselves with its calculation.\n\nSecond, a correction or projection step is applied to enforce the incompressibility constraint, $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$. This step introduces the effect of the pressure field $p$. The relationship between the final velocity $\\mathbf{u}^{n+1}$, the intermediate velocity $\\mathbf{u}^{*}$, and the pressure $p$ is defined by considering only the pressure gradient's contribution to the change in momentum over the time step $\\Delta t$. Using a first-order time discretization for the pressure-correction part of the momentum equation, we have:\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^{*}}{\\Delta t} = -\\frac{1}{\\rho}\\nabla p\n$$\nThis equation isolates the role of the pressure gradient in correcting the velocity field. Rearranging this equation yields the required correction relation:\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p\n$$\nThis relation expresses the final, divergence-free velocity field $\\mathbf{u}^{n+1}$ as the sum of the intermediate field $\\mathbf{u}^{*}$ and a correction term that is proportional to the gradient of the pressure field. Physically, this correction \"projects\" the intermediate velocity field onto the space of divergence-free vector fields.\n\nTo find the specific pressure field $p$ that ensures this, we apply the incompressibility constraint $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ to the correction relation. Taking the divergence of both sides, we get:\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = \\nabla \\cdot \\left( \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p \\right)\n$$\nSetting $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ and using the identity $\\nabla \\cdot (\\nabla p) = \\nabla^2 p$, we obtain:\n$$\n0 = \\nabla \\cdot \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla^2 p\n$$\nRearranging for $\\nabla^2 p$ yields the pressure Poisson equation:\n$$\n\\nabla^2 p = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*}\n$$\nThis confirms that the structure of the problem is consistent with the standard projection method. Now, we proceed to solve for $\\mathbf{u}^{n+1}$ using the given data.\n\n**Step 1: Compute the divergence of the intermediate velocity field $\\mathbf{u}^{*}$.**\nThe given intermediate velocity field is:\n$$\n\\mathbf{u}^{*}(x,y) = \\begin{pmatrix} u^{*}(x,y) \\\\ v^{*}(x,y) \\end{pmatrix} = \\begin{pmatrix} \\sin(x)\\cos(y) \\\\ \\cos(x)\\sin(y) \\end{pmatrix}\n$$\nThe divergence is calculated as:\n$$\n\\nabla \\cdot \\mathbf{u}^{*} = \\frac{\\partial u^{*}}{\\partial x} + \\frac{\\partial v^{*}}{\\partial y} = \\frac{\\partial}{\\partial x}(\\sin(x)\\cos(y)) + \\frac{\\partial}{\\partial y}(\\cos(x)\\sin(y))\n$$\n$$\n\\nabla \\cdot \\mathbf{u}^{*} = \\cos(x)\\cos(y) + \\cos(x)\\cos(y) = 2\\cos(x)\\cos(y)\n$$\n\n**Step 2: Solve the pressure Poisson equation.**\nSubstituting the divergence into the Poisson equation gives:\n$$\n\\nabla^2 p = \\frac{\\rho}{\\Delta t} (2\\cos(x)\\cos(y)) = \\frac{2\\rho}{\\Delta t} \\cos(x)\\cos(y)\n$$\nWe need to solve this second-order partial differential equation on the periodic domain $\\Omega = [0,2\\pi] \\times [0,2\\pi]$ with the constraint $\\int_{\\Omega} p \\, dx\\,dy = 0$. Given the form of the right-hand side, we propose a solution of the form $p(x,y) = C \\cos(x)\\cos(y)$, where $C$ is a constant to be determined. We compute the Laplacian of this trial solution:\n$$\n\\frac{\\partial p}{\\partial x} = -C \\sin(x)\\cos(y) \\implies \\frac{\\partial^2 p}{\\partial x^2} = -C \\cos(x)\\cos(y)\n$$\n$$\n\\frac{\\partial p}{\\partial y} = -C \\cos(x)\\sin(y) \\implies \\frac{\\partial^2 p}{\\partial y^2} = -C \\cos(x)\\cos(y)\n$$\n$$\n\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -C \\cos(x)\\cos(y) - C \\cos(x)\\cos(y) = -2C \\cos(x)\\cos(y)\n$$\nEquating this to the right-hand side of the Poisson equation:\n$$\n-2C \\cos(x)\\cos(y) = \\frac{2\\rho}{\\Delta t} \\cos(x)\\cos(y)\n$$\nThis equality must hold for all $(x,y)$, so we can equate the coefficients:\n$$\n-2C = \\frac{2\\rho}{\\Delta t} \\implies C = -\\frac{\\rho}{\\Delta t}\n$$\nThe pressure field is therefore $p(x,y) = -\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)$. This solution satisfies the periodic boundary conditions. We verify the zero-mean condition:\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left(-\\frac{\\rho}{\\Delta t}\\cos(x)\\cos(y)\\right) dx\\,dy = -\\frac{\\rho}{\\Delta t} \\left(\\int_{0}^{2\\pi}\\cos(x)dx\\right) \\left(\\int_{0}^{2\\pi}\\cos(y)dy\\right) = -\\frac{\\rho}{\\Delta t} (0)(0) = 0\n$$\nThe condition is satisfied, so this is the unique solution for the pressure.\n\n**Step 3: Compute the pressure gradient $\\nabla p$.**\nWith the expression for $p(x,y)$, we compute its gradient:\n$$\n\\nabla p = \\begin{pmatrix} \\frac{\\partial p}{\\partial x} \\\\ \\frac{\\partial p}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial x}\\left(-\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)\\right) \\\\ \\frac{\\partial}{\\partial y}\\left(-\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)\\right) \\end{pmatrix}\n$$\n$$\n\\nabla p = \\begin{pmatrix} -\\frac{\\rho}{\\Delta t} (-\\sin(x)\\cos(y)) \\\\ -\\frac{\\rho}{\\Delta t} (\\cos(x)(-\\sin(y))) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\rho}{\\Delta t} \\sin(x)\\cos(y) \\\\ \\frac{\\rho}{\\Delta t} \\cos(x)\\sin(y) \\end{pmatrix}\n$$\nFactoring out the constant term, we find an interesting relationship:\n$$\n\\nabla p = \\frac{\\rho}{\\Delta t} \\begin{pmatrix} \\sin(x)\\cos(y) \\\\ \\cos(x)\\sin(y) \\end{pmatrix} = \\frac{\\rho}{\\Delta t} \\mathbf{u}^{*}\n$$\n\n**Step 4: Compute the final corrected velocity field $\\mathbf{u}^{n+1}$.**\nWe substitute the calculated pressure gradient back into the correction relation:\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p\n$$\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\left( \\frac{\\rho}{\\Delta t} \\mathbf{u}^{*} \\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\mathbf{u}^{*} = \\mathbf{0}\n$$\nThus, the final corrected velocity field is the zero vector field:\n$$\n\\mathbf{u}^{n+1}(x,y) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis result is a consequence of the Helmholtz-Hodge decomposition. The projection method decomposes $\\mathbf{u}^{*}$ into a divergence-free part (the rotational component) and a curl-free part (the gradient component). The final velocity $\\mathbf{u}^{n+1}$ is the divergence-free part. In this specific problem, the intermediate field $\\mathbf{u}^{*}$ is purely a gradient field (i.e., it is curl-free, as $\\frac{\\partial v^*}{\\partial x} - \\frac{\\partial u^*}{\\partial y} = -\\sin(x)\\sin(y) - (-\\sin(x)\\sin(y)) = 0$), corresponding to the irrotational component. The projection operation correctly identifies and removes this entire gradient component, leaving a zero velocity field as the divergence-free part.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}$$"
        }
    ]
}