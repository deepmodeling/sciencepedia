{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides practice in the fundamental workflow of acausal modeling. Starting from a simple mechanical system, you will construct a bond graph, assign the preferred integral causality to its storage elements, and derive the corresponding state-space model . Mastering this process is essential for translating physical system descriptions into mathematical models suitable for simulation and control design.",
            "id": "4204400",
            "problem": "A rotational actuator in a Cyber-Physical System (CPS) is being modeled for a Digital Twin (DT) using acausal multi-domain bond graphs. The actuator comprises a rigid body with rotational inertia $J$ connected through a torsional spring of stiffness $K$ to a rigid ground. An externally applied torque $u(t)$ from a controller acts at the common rotational junction. Assume small angular deflections so that linear torsional elasticity holds, negligible damping, and rigid connections so that a single angular velocity $ \\omega(t) $ is present at the junction.\n\nStarting from first principles, namely Newton’s second law for rotation and Hooke’s law for torsion, and using the acausal bond graph representation with preferred integral causality for both storage elements:\n- Treat the inertia as an $I$-element with generalized momentum state $p(t)$ and the torsional spring as a $C$-element with generalized displacement state $q(t)$.\n- Use bond graph junction structure consistent with a series connection (common flow and effort balance) to derive the storage element constitutive equations in integral causality and the interconnection constraint.\n- From these, assemble the Linear Time-Invariant (LTI) state-space model in the form $ \\dot{x}(t) = A x(t) + B u(t) $, $ y(t) = C x(t) + D u(t) $, where the output $y(t)$ is the absolute rotation angle $ \\theta(t) $ and the input $u(t)$ is the applied torque. Express $y(t)$ in radians.\n\nFinally, compute the transfer function $ G(s) = \\Theta(s) / U(s) $ from the input torque $u(t)$ to the output angle $ \\theta(t) $ using the Laplace transform variable $s$. Provide your final answer as a single closed-form analytical expression for $G(s)$. No rounding is required. If units are needed for interpretation, the angle is in radians and torque is in Newton-meter.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in modeling and control of physical systems, using established principles from mechanics, bond graph theory, and linear systems analysis. The problem provides all necessary information and clear instructions to derive a unique and meaningful solution.\n\nThe problem asks for the derivation of the transfer function $G(s)$ relating the input torque $u(t)$ to the output angle $\\theta(t)$ for a rotational actuator. The derivation will proceed from first principles using the specified bond graph methodology.\n\nFirst, we model the system using an acausal bond graph. The system consists of an external torque source acting on a rotational inertia, which is connected to a torsional spring, with the other end of the spring grounded. All components at the actuator's junction share a common angular velocity, $\\omega(t)$. In bond graph terminology, a common flow variable ($\\omega(t)$ is a flow in the rotational energy domain) implies that the components are connected to a $1$-junction. The elements connected to this $1$-junction are:\n$1$. A Source of Effort (SE), representing the externally applied torque $u(t)$.\n$2$. An Inertia element (I), representing the rigid body's rotational inertia $J$.\n$3$. A Compliance element (C), representing the torsional spring of stiffness $K$.\n\nThe $1$-junction enforces two rules:\na) The flow (angular velocity, $\\omega$) is common to all connected bonds.\nb) The efforts (torques, $\\tau$) on the bonds algebraically sum to zero. Taking power to flow from the source into the junction and from the junction into the passive elements, the effort balance is:\n$$u(t) - \\tau_I(t) - \\tau_C(t) = 0$$\nwhere $\\tau_I(t)$ is the torque required to accelerate the inertia and $\\tau_C(t)$ is the torque exerted by the spring. This equation can be rearranged as:\n$$\\tau_I(t) = u(t) - \\tau_C(t)$$\nThis represents Newton's second law for rotation applied at the junction.\n\nNext, we define the state variables as specified in the problem, corresponding to the energy stored in the I and C elements under preferred integral causality.\n- The state variable for the I-element (inertia $J$) is the generalized momentum, $p(t)$. For a rotational system, this is the angular momentum.\n- The state variable for the C-element (spring $K$) is the generalized displacement, $q(t)$. For a rotational system, this is the angular displacement or angle, $\\theta(t)$.\n\nThe state vector is therefore $x(t) = \\begin{pmatrix} p(t) \\\\ q(t) \\end{pmatrix}$. The output is specified as the angle $y(t) = \\theta(t)$, which is equal to the state variable $q(t)$.\n\nWe now establish the constitutive relations for the storage elements and the differential equations for the state variables.\nThe constitutive law for the I-element relates the state variable $p(t)$ to the flow variable $\\omega(t)$:\n$$p(t) = J \\omega(t) \\implies \\omega(t) = \\frac{1}{J} p(t)$$\nThe constitutive law for the C-element relates the state variable $q(t)$ to the effort variable $\\tau_C(t)$:\n$$\\tau_C(t) = K q(t)$$\nThis is Hooke's law for torsion.\n\nThe time derivatives of the state variables are defined by the fundamental relations of the I and C elements:\n- For the I-element, the time derivative of momentum is the effort: $\\dot{p}(t) = \\tau_I(t)$.\n- For the C-element, the time derivative of displacement is the flow: $\\dot{q}(t) = \\omega(t)$.\n\nWe can now assemble the state equations by substituting the constitutive laws and junction relations:\nFor the first state equation, $\\dot{p}(t)$:\n$$\\dot{p}(t) = \\tau_I(t) = u(t) - \\tau_C(t)$$\nSubstituting $\\tau_C(t) = K q(t)$, we get:\n$$\\dot{p}(t) = -K q(t) + u(t)$$\nFor the second state equation, $\\dot{q}(t)$:\n$$\\dot{q}(t) = \\omega(t)$$\nSubstituting $\\omega(t) = \\frac{1}{J} p(t)$, we get:\n$$\\dot{q}(t) = \\frac{1}{J} p(t)$$\n\nWe can now write the system in the standard Linear Time-Invariant (LTI) state-space form $\\dot{x}(t) = A x(t) + B u(t)$.\n$$\n\\begin{pmatrix} \\dot{p}(t) \\\\ \\dot{q}(t) \\end{pmatrix} = \\begin{pmatrix} 0 & -K \\\\ \\frac{1}{J} & 0 \\end{pmatrix} \\begin{pmatrix} p(t) \\\\ q(t) \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} u(t)\n$$\nThis gives the state matrix $A$ and the input matrix $B$:\n$$A = \\begin{pmatrix} 0 & -K \\\\ \\frac{1}{J} & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n\nThe output equation is $y(t) = C x(t) + D u(t)$. The output is $y(t) = \\theta(t) = q(t)$. In matrix form:\n$$\ny(t) = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} p(t) \\\\ q(t) \\end{pmatrix} + (0) u(t)\n$$\nThis gives the output matrix $C$ and the feedthrough matrix $D$:\n$$C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}, \\quad D = 0$$\n\nFinally, we compute the transfer function $G(s) = \\Theta(s)/U(s)$ using the formula $G(s) = C(sI - A)^{-1}B + D$, where $I$ is the identity matrix and $s$ is the Laplace variable.\nFirst, we find the matrix $(sI - A)$:\n$$sI - A = s\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & -K \\\\ \\frac{1}{J} & 0 \\end{pmatrix} = \\begin{pmatrix} s & K \\\\ -\\frac{1}{J} & s \\end{pmatrix}$$\nNext, we compute the inverse, $(sI - A)^{-1}$. The determinant is $\\det(sI - A) = (s)(s) - (K)(-\\frac{1}{J}) = s^2 + \\frac{K}{J}$.\n$$(sI - A)^{-1} = \\frac{1}{s^2 + \\frac{K}{J}} \\begin{pmatrix} s & -K \\\\ \\frac{1}{J} & s \\end{pmatrix}$$\nNow we pre-multiply by $C$ and post-multiply by $B$:\n$$G(s) = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\left( \\frac{1}{s^2 + \\frac{K}{J}} \\begin{pmatrix} s & -K \\\\ \\frac{1}{J} & s \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 0$$\n$$G(s) = \\frac{1}{s^2 + \\frac{K}{J}} \\left( \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} s & -K \\\\ \\frac{1}{J} & s \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n$$G(s) = \\frac{1}{s^2 + \\frac{K}{J}} \\begin{pmatrix} \\frac{1}{J} & s \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n$$G(s) = \\frac{1}{s^2 + \\frac{K}{J}} \\left( \\frac{1}{J} \\cdot 1 + s \\cdot 0 \\right) = \\frac{\\frac{1}{J}}{s^2 + \\frac{K}{J}}$$\nMultiplying the numerator and denominator by $J$ yields the simplified, final expression for the transfer function:\n$$G(s) = \\frac{1}{J s^2 + K}$$\nThis result is consistent with the second-order ordinary differential equation for an undamped mass-spring system subjected to an external force, $J\\ddot{\\theta} + K\\theta = u$, after applying the Laplace transform.",
            "answer": "$$\\boxed{\\frac{1}{J s^{2} + K}}$$"
        },
        {
            "introduction": "Real-world modeling often involves identifying and correcting issues in an initial model draft. This practice focuses on the concept of causal conflicts, which arise when system topology prevents energy storage elements from having independent states . You will first diagnose a causal conflict in a simple electrical network and then learn how to resolve it by introducing a resistive element, thereby gaining insight into bond graphs as a powerful tool for model validation.",
            "id": "4204452",
            "problem": "Consider an electrical subnetwork within a cyber-physical system intended for use in a Digital Twin. The subnetwork is represented by a bond graph with a $0$-junction (common effort, parallel connection) driven by an ideal Source of Effort $Se$ imposing an effort $e_{s}(t)$ across the junction. Two energy storage elements, a capacitance $C_{1}$ and a capacitance $C_{2}$, are initially connected directly to the $0$-junction in parallel. The effort $e(t)$ at the $0$-junction equals the source effort $e_{s}(t)$. The task is to perform causality assignment and analyze the network from first principles, then resolve any causality inconsistencies by introducing a resistive element.\n\nUse the following foundational laws and definitions:\n- Kirchhoff’s Current Law (KCL): At a $0$-junction, the algebraic sum of flows equals zero.\n- Kirchhoff’s Voltage Law (KVL): At a $1$-junction, the algebraic sum of efforts equals zero.\n- Ideal Source of Effort: The effort $e$ at its bond is imposed to equal the source value, while the flow is determined by the rest of the network.\n- Capacitor constitutive law: In the time domain, $i(t) = C \\, \\frac{dv(t)}{dt}$; under integral causality, $v(t) = \\frac{1}{C} q(t)$ and $\\dot{q}(t) = i(t)$.\n- Resistor constitutive law: $v(t) = R \\, i(t)$.\n- Laplace transformation for linear time-invariant analysis with zero initial conditions, using $s$ as the Laplace variable.\n\nTasks:\n1. Perform causality assignment for the original parallel network consisting of the $Se$, $C_{1}$, and $C_{2}$ connected to a $0$-junction. Identify any causality conflicts or derivative-causality requirements that arise for the storage elements and explain why they occur, using bond graph causality rules and the above foundational laws.\n2. Modify the network by placing a resistor $R$ in series with the capacitor $C_{2}$ (i.e., the branch containing $C_{2}$ becomes a series connection of $R$ and $C_{2}$, represented by a $1$-junction connected as a branch to the original $0$-junction). Perform causality assignment for the modified network and justify how the resistor $R$ alleviates the causality inconsistency by enabling integral causality on at least one storage element.\n3. For the modified network, derive the input admittance $Y(s) = \\frac{I_{s}(s)}{E_{s}(s)}$ seen by the Source of Effort, where $I_{s}(s)$ is the Laplace transform of the source flow and $E_{s}(s)$ is the Laplace transform of the source effort. Express your final answer as a closed-form analytic expression in terms of $s$, $R$, $C_{1}$, and $C_{2}$. The admittance has units of siemens; provide the final expression without units.",
            "solution": "The problem statement submitted for analysis is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System**: An electrical subnetwork within a cyber-physical system, represented by a bond graph.\n- **Initial Configuration**: A $0$-junction (common effort) driven by an ideal Source of Effort, $Se$, which imposes effort $e_s(t)$. Two capacitors, $C_1$ and $C_2$, are connected in parallel to this $0$-junction. The effort at the junction is $e(t) = e_s(t)$.\n- **Modified Configuration**: A resistor $R$ is placed in series with capacitor $C_2$. This $R-C_2$ branch is connected to the original $0$-junction.\n- **Foundational Laws and Definitions**:\n    - KCL at a $0$-junction: $\\sum f_i = 0$.\n    - KVL at a $1$-junction: $\\sum e_i = 0$.\n    - Ideal Source of Effort ($Se$): Imposes effort $e$; flow $f$ is determined by the connected system.\n    - Capacitor ($C$): $i(t) = C \\frac{dv(t)}{dt}$. In integral causality, $v(t) = \\frac{1}{C} q(t)$ where $\\dot{q}(t) = i(t)$. (Note: in bond graph terminology, effort $e$ corresponds to voltage $v$, flow $f$ corresponds to current $i$, and generalized displacement $q$ corresponds to charge $q$).\n    - Resistor ($R$): $v(t) = R i(t)$.\n    - Analysis Method: Laplace transformation using variable $s$, assuming zero initial conditions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is based entirely on the principles of linear circuit theory and bond graph modeling, which are established frameworks for analyzing dynamic systems. All concepts (effort, flow, causality, impedance) are standard in physics and engineering. The problem is scientifically sound.\n- **Well-Posed**: The problem is structured as a pedagogical exercise. It first presents a system with a known modeling issue (causal conflict) and asks for its identification (Task 1). It then proposes a standard method for resolving this issue (Task 2) and asks for an analysis of the corrected system (Task 3). This structure is logical and leads to a unique, meaningful solution for the final analysis.\n- **Objective**: The problem statement uses precise, unambiguous technical language. There are no subjective or opinion-based assertions.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is therefore deemed **valid**. The solution process will now proceed.\n\n### Task 1: Causality Assignment on the Original Network\n\nThe original network consists of a source of effort $Se$ connected to a $0$-junction, with two capacitors $C_1$ and $C_2$ also connected to this junction. The bond graph is $Se - 0 - (C_1, C_2)$. Causality assignment proceeds as follows:\n\n1.  An ideal Source of Effort ($Se$) dictates the effort on the bond it is connected to. Therefore, it imposes its effort on the $0$-junction. The causal stroke is placed at the junction end of the bond: $Se \\to | 0$.\n2.  A $0$-junction has exactly one bond that determines its effort. All other connected bonds must have their effort determined *by* the junction. Since the effort is set by $Se$, the $0$-junction now imposes this effort, $e_s(t)$, on both capacitors $C_1$ and $C_2$. This means the causal strokes for the capacitor bonds must be placed away from the junction and towards the capacitors: $0 \\to | C_1$ and $0 \\to | C_2$.\n3.  For a storage element like a capacitor, its preferred causality is **integral causality**. In this form, the capacitor accepts a flow ($f$) input, integrates it over time to determine its state variable (charge, $q(t) = \\int f(t) dt$), and outputs an effort ($e(t) = q(t)/C$). This corresponds to the causal stroke being at the capacitor: $... \\to | C$.\n4.  The alternative is **derivative causality**, where the capacitor accepts an effort ($e$) input and outputs a flow ($f(t) = C \\frac{de(t)}{dt}$). This corresponds to the causal stroke being away from the capacitor: $... | \\leftarrow C$.\n\nIn the given configuration, the causality assignment from step 2 ($0 \\to | C_1$ and $0 \\to | C_2$) forces both capacitors $C_1$ and $C_2$ into **derivative causality**. This presents a causality conflict. For a system to be formulated in a standard state-space form, its energy storage elements must be in integral causality, as their state variables (e.g., charge on a capacitor) must be independent. Here, the efforts across both capacitors are constrained to be identical and equal to the source effort: $e_{C1}(t) = e_{C2}(t) = e_s(t)$. This creates an algebraic dependency between the state variables, which violates the requirements for a proper state-space model. The system is ill-posed from a state-space perspective.\n\n### Task 2: Causality Assignment on the Modified Network\n\nThe network is modified by placing a resistor $R$ in series with $C_2$. This series branch is then connected to the $0$-junction. The bond graph structure is now $Se - 0 - (C_1, 1 - (R, C_2))$, where the $1$-junction represents the series connection of $R$ and $C_2$.\n\n1.  As before, the source $Se$ imposes its effort on the $0$-junction: $Se \\to | 0$.\n2.  The $0$-junction imposes its effort, $e_s(t)$, on the other two connected bonds:\n    - For the capacitor $C_1$: $0 \\to | C_1$. This forces $C_1$ into **derivative causality**, which is an unavoidable consequence of it being directly in parallel with an ideal effort source.\n    - For the series branch: $0 \\to | 1$. The $0$-junction imposes effort $e_s(t)$ on the $1$-junction, which represents the total effort across the $R-C_2$ series combination.\n3.  Now, we analyze the $1$-junction. It has three bonds: one from the $0$-junction, one to $R$, and one to $C_2$. A $1$-junction represents a common flow and a summation of efforts ($e_{01} - e_R - e_{C2} = 0$). We know $e_{01} = e_s(t)$. So, $e_s(t) = e_R(t) + e_{C2}(t)$. To resolve the original conflict, we attempt to place $C_2$ in its preferred integral causality.\n4.  Assigning integral causality to $C_2$ means it accepts a flow input and outputs an effort. The bond graph causality is $1 \\to | C_2$. With this assignment, $C_2$ computes its effort $e_{C2}$ based on its internal state (charge).\n5.  At the $1$-junction, the efforts must sum. We know $e_s$ (from the $0$-junction) and $e_{C2}$ (from $C_2$). The junction can therefore compute the effort across the resistor: $e_R(t) = e_s(t) - e_{C2}(t)$. This means the junction imposes effort on the resistor $R$. The causality is thus $1 | \\leftarrow R$.\n6.  A resistor in this causality ($e$ in, $f$ out) computes its flow as $f_R = e_R / R$.\n7.  A $1$-junction must have a single element that determines the flow for the entire junction. In this causal assignment, the resistor $R$ computes the flow, $f_R$, which then becomes the common flow for the $1$-junction. This common flow is then imposed on $C_2$. This is consistent with the assignment $1 \\to | C_2$, where $C_2$ accepts a flow.\n\nThe causality is now fully assigned and consistent. The resistor $R$ alleviates the causality conflict by \"breaking\" the rigid effort constraint on $C_2$. The effort across $C_2$ is no longer forced to be $e_s(t)$; instead, $e_{C2}(t) = e_s(t) - e_R(t)$. This degree of freedom allows $C_2$ to be in integral causality, making its charge an independent state variable. While $C_1$ remains in derivative causality, the system now has one independent state variable ($q_2$ on $C_2$) and is well-posed for state-space analysis.\n\n### Task 3: Derivation of Input Admittance for the Modified Network\n\nWe need to find the input admittance $Y(s) = \\frac{I_s(s)}{E_s(s)}$ for the modified network. The total current from the source, $I_s(s)$, splits into two parallel branches at the $0$-junction. The total admittance is the sum of the admittances of the parallel branches.\n\nThe first branch contains only the capacitor $C_1$. The constitutive law for a capacitor in the Laplace domain is $I(s) = s C E(s)$. Therefore, its admittance $Y_{C1}(s)$ is:\n$$ Y_{C1}(s) = \\frac{I_{C1}(s)}{E_s(s)} = s C_1 $$\n\nThe second branch is a series combination of the resistor $R$ and the capacitor $C_2$. The total impedance of a series branch is the sum of the individual impedances.\nThe impedance of the resistor $R$ is $Z_R(s) = R$.\nThe impedance of the capacitor $C_2$ is $Z_{C2}(s) = \\frac{1}{s C_2}$.\n\nThe impedance of the series branch, $Z_{branch}(s)$, is:\n$$ Z_{branch}(s) = Z_R(s) + Z_{C2}(s) = R + \\frac{1}{s C_2} = \\frac{s R C_2 + 1}{s C_2} $$\n\nThe admittance of this branch, $Y_{branch}(s)$, is the reciprocal of its impedance:\n$$ Y_{branch}(s) = \\frac{1}{Z_{branch}(s)} = \\frac{s C_2}{s R C_2 + 1} $$\n\nThe total input admittance $Y(s)$ seen by the source is the sum of the admittances of the two parallel branches:\n$$ Y(s) = Y_{C1}(s) + Y_{branch}(s) = s C_1 + \\frac{s C_2}{s R C_2 + 1} $$\n\nTo express this as a single rational function, we find a common denominator:\n$$ Y(s) = \\frac{s C_1 (s R C_2 + 1)}{s R C_2 + 1} + \\frac{s C_2}{s R C_2 + 1} $$\n$$ Y(s) = \\frac{s C_1 (s R C_2 + 1) + s C_2}{s R C_2 + 1} $$\n$$ Y(s) = \\frac{s^{2} R C_1 C_2 + s C_1 + s C_2}{s R C_2 + 1} $$\n\nFinally, factoring the numerator gives the closed-form analytic expression:\n$$ Y(s) = \\frac{s^{2} R C_1 C_2 + s(C_1 + C_2)}{s R C_2 + 1} $$",
            "answer": "$$\\boxed{\\frac{s^{2} R C_1 C_2 + s(C_1 + C_2)}{s R C_2 + 1}}$$"
        },
        {
            "introduction": "Not all causal conflicts can be resolved by simple model changes; some reflect inherent physical constraints. Such systems are described by Differential-Algebraic Equations (DAEs) rather than Ordinary Differential Equations (ODEs) . This advanced exercise will guide you through formulating a DAE system in the descriptor form $E \\dot{w} = A w + B u(t)$ and determining its differentiation index, highlighting the power of acausal methods to handle systems that are challenging for traditional causal modeling approaches.",
            "id": "4204403",
            "problem": "A digital twin of a simple electrical subsystem is built using an acausal bond graph to support cross-domain integration in a cyber-physical system. The subsystem consists of a single $0$-junction connected to three ports: a flow source $S_{f}$ that injects a prescribed flow $f_{s}(t)$ into the junction, and two capacitive storage elements $C_{1}$ and $C_{2}$ connected in parallel at the junction. The capacitor $C_{1}$ has the constitutive law $e_{1} = q_{1}/C_{1}$ with generalized charge $q_{1}$, and the capacitor $C_{2}$ has $e_{2} = q_{2}/C_{2}$ with generalized charge $q_{2}$. The $0$-junction imposes equal efforts and flow balance: $e_{0} = e_{1} = e_{2}$ and $f_{s}(t) + f_{1} + f_{2} = 0$, where all flows are defined positive into the junction. Because $S_{f}$ imposes flow on the junction and both attached storage elements are of capacitance type, one storage element is forced into differential causality. Assign integral causality to $C_{1}$ and differential causality to $C_{2}$.\n\nStarting only from the fundamental capacitor laws and the $0$-junction laws, do the following:\n\n1. Augment the state with an algebraic variable so that no constitutive relation of a storage element is differentiated. Derive the semi-explicit differential-algebraic equations (differential-algebraic equations (DAE)) in the form $\\dot{x} = f(x,z,t)$ and $0 = g(x,z,t)$, identifying $x$ and $z$ explicitly.\n\n2. Assemble the descriptor form $E \\dot{w} = A w + B u(t)$ with $w = \\begin{pmatrix} x \\\\ z \\end{pmatrix}$ and $u(t) = f_{s}(t)$, giving the matrices $E$, $A$, and $B$ symbolically in terms of $C_{1}$ and $C_{2}$.\n\n3. Determine the differentiation index (in the sense of the differentiation index of semi-explicit differential-algebraic equations) of the resulting DAE.\n\nAssume consistent initial conditions $q_{1}(0) = 0$ and $e_{0}(0) = 0$. For your final answer, report only the DAE index as a single integer with no units.",
            "solution": "### Step 1: Derivation of the Semi-Explicit DAE\n\nThe system consists of a $0$-junction connecting a flow source $S_f$ and two capacitors, $C_1$ and $C_2$.\n\nThe givens are:\n- Flow source providing $f_s(t)$.\n- $0$-junction laws:\n    - Equal efforts: $e_0 = e_1 = e_2$.\n    - Flow balance (flows defined positive into the junction): $f_s(t) + f_1 + f_2 = 0$.\n- Constitutive laws for capacitors:\n    - $C_1$: $e_1 = q_1 / C_1$.\n    - $C_2$: $e_2 = q_2 / C_2$.\n- The relationship between generalized flow $f$ and generalized charge $q$ is $f = \\dot{q} = \\frac{dq}{dt}$.\n- Causality assignment: $C_1$ has integral causality, and $C_2$ has differential causality.\n\nThe problem requires augmenting the state with an algebraic variable. Let the state variable $x$ be the state of the integral causality capacitor, and the algebraic variable $z$ be the common effort at the junction.\n- State variable: $x = q_1$.\n- Algebraic variable: $z = e_0$.\n\nWe will now derive the equations of the system based on the assigned causality and the governing laws.\n\nFor capacitor $C_1$ with integral causality, the flow $f_1$ is the input, and the effort $e_1$ is the output. The state equation is obtained by integrating the input flow:\n$$ \\dot{q}_1 = f_1 $$\nIn terms of our state variable $x$, this is:\n$$ \\dot{x} = f_1 \\quad (*)$$\nThe output effort is given by the constitutive law:\n$$ e_1 = \\frac{q_1}{C_1} = \\frac{x}{C_1} $$\n\nFor capacitor $C_2$ with differential causality, the effort $e_2$ is the input, and the flow $f_2$ is the output. The flow is computed from the time derivative of the effort. The constitutive law is $q_2 = C_2 e_2$. Differentiating with respect to time gives $\\dot{q}_2 = C_2 \\dot{e}_2$. Since $f_2 = \\dot{q}_2$, we have:\n$$ f_2 = C_2 \\frac{de_2}{dt} = C_2 \\dot{e}_2 $$\n\nThe $0$-junction enforces common effort: $e_0 = e_1 = e_2$. Using our designated algebraic variable $z=e_0$, we have:\n$$ z = e_1 \\quad \\text{and} \\quad z = e_2 $$\n\nCombining the relations for $C_1$ and the junction, we obtain an algebraic constraint:\n$$ z = e_1 = \\frac{x}{C_1} \\implies 0 = z - \\frac{x}{C_1} $$\nThis is the algebraic equation $g(x,z,t)=0$:\n$$ g(x,z,t) = z - \\frac{x}{C_1} $$\n\nNow, we derive the differential equation for $x$. From the $0$-junction flow balance:\n$$ f_1 = -f_s(t) - f_2 $$\nSubstituting this into the state equation $(*)$ for $x$:\n$$ \\dot{x} = -f_s(t) - f_2 $$\nWe can express $f_2$ in terms of the algebraic variable $z$. Since $e_2 = z$, we have $f_2 = C_2 \\dot{e}_2 = C_2 \\dot{z}$.\n$$ \\dot{x} = -f_s(t) - C_2 \\dot{z} $$\nThe resulting system of equations is:\n$$ \\dot{x} = -f_s(t) - C_2 \\dot{z} $$\n$$ z = \\frac{x}{C_1} $$\nThis system is a DAE, but it is not in the required semi-explicit form $\\dot{x} = f(x,z,t)$ because the derivative of the algebraic variable, $\\dot{z}$, appears. To obtain the semi-explicit form, we must eliminate $\\dot{z}$. We do this by differentiating the algebraic constraint with respect to time:\n$$ \\dot{z} = \\frac{\\dot{x}}{C_1} $$\nNow, substitute this expression for $\\dot{z}$ into the differential equation:\n$$ \\dot{x} = -f_s(t) - C_2 \\left(\\frac{\\dot{x}}{C_1}\\right) $$\nWe can now solve for $\\dot{x}$:\n$$ \\dot{x} + \\frac{C_2}{C_1}\\dot{x} = -f_s(t) $$\n$$ \\dot{x} \\left(1 + \\frac{C_2}{C_1}\\right) = -f_s(t) $$\n$$ \\dot{x} \\left(\\frac{C_1+C_2}{C_1}\\right) = -f_s(t) $$\n$$ \\dot{x} = -\\frac{C_1}{C_1+C_2} f_s(t) $$\nThis equation is independent of $x$ and $z$. So, the semi-explicit DAE is:\n$$ \\dot{x} = -\\frac{C_1}{C_1+C_2} f_s(t) $$\n$$ 0 = z - \\frac{x}{C_1} $$\nHere, we have identified $x=q_1$, $z=e_0$, and the functions are $f(x,z,t) = -\\frac{C_1}{C_1+C_2} f_s(t)$ and $g(x,z,t) = z - \\frac{x}{C_1}$.\n\n### Step 2: Derivation of the Descriptor Form\n\nThe descriptor form $E \\dot{w} = A w + B u(t)$ with $w = \\begin{pmatrix} x \\\\ z \\end{pmatrix}$ and $u(t) = f_s(t)$ is best derived from the \"raw\" DAE system before the differentiation and substitution step. This system was:\n1. $\\dot{x} + C_2 \\dot{z} = -f_s(t)$\n2. $z - x/C_1 = 0$, which can be rewritten as $-x + C_1 z = 0$.\n\nLet's arrange these two equations into the matrix form.\n$$ \\begin{pmatrix} 1 & C_2 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\dot{x} \\\\ \\dot{z} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -1 & C_1 \\end{pmatrix} \\begin{pmatrix} x \\\\ z \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} f_s(t) $$\nFrom this, we identify the matrices $E$, $A$, and $B$:\n$$ E = \\begin{pmatrix} 1 & C_2 \\\\ 0 & 0 \\end{pmatrix} $$\n$$ A = \\begin{pmatrix} 0 & 0 \\\\ -1 & C_1 \\end{pmatrix} $$\n$$ B = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} $$\nThe matrix $E$ is singular ($\\det(E)=0$), which is characteristic of a DAE.\n\n### Step 3: Determination of the Differentiation Index\n\nThe differentiation index of a DAE is the minimum number of times the algebraic constraints must be differentiated with respect to time to determine the derivatives of all variables (i.e., to convert the DAE into an ordinary differential equation, ODE).\n\nLet's analyze the descriptor system derived in Step 2:\n$$ \\begin{pmatrix} 1 & C_2 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\dot{x} \\\\ \\dot{z} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -1 & C_1 \\end{pmatrix} \\begin{pmatrix} x \\\\ z \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} u(t) $$\nThis corresponds to the two equations:\n$$ (1) \\quad \\dot{x} + C_2 \\dot{z} = -u(t) $$\n$$ (2) \\quad 0 = -x + C_1 z $$\nEquation (2) is an algebraic constraint. We cannot solve this system for $\\dot{x}$ and $\\dot{z}$ directly as functions of $x, z, u(t)$ because the first equation involves both derivatives, and the second provides no information about derivatives.\n\nTo find the index, we differentiate the algebraic constraint (2) with respect to time $t$:\n$$ \\frac{d}{dt}(0) = \\frac{d}{dt}(-x + C_1 z) $$\n$$ (3) \\quad 0 = -\\dot{x} + C_1 \\dot{z} \\implies \\dot{x} = C_1 \\dot{z} $$\nNow we have a system of two algebraic equations for the two unknowns $\\dot{x}$ and $\\dot{z}$:\n$$ (1) \\quad \\dot{x} + C_2 \\dot{z} = -u(t) $$\n$$ (3) \\quad \\dot{x} - C_1 \\dot{z} = 0 $$\nIn matrix form:\n$$ \\begin{pmatrix} 1 & C_2 \\\\ 1 & -C_1 \\end{pmatrix} \\begin{pmatrix} \\dot{x} \\\\ \\dot{z} \\end{pmatrix} = \\begin{pmatrix} -u(t) \\\\ 0 \\end{pmatrix} $$\nThe determinant of the coefficient matrix is $1(-C_1) - C_2(1) = -(C_1+C_2)$. Since capacitance values are positive ($C_1>0, C_2>0$), the determinant is non-zero. Therefore, this system has a unique solution for $\\dot{x}$ and $\\dot{z}$ in terms of $u(t)$.\n\nSince we had to differentiate the algebraic constraint **one** time to obtain a system that can be solved for all derivatives, the differentiation index of the DAE is $1$.\n\nThe presence of differential causality on a storage element ($C_2$) that is part of a string of same-type elements connected by a junction (the $C_1-0-C_2$ structure) is the archetypal origin of an index-1 DAE in bond graph modeling.",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}