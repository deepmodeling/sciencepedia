{
    "hands_on_practices": [
        {
            "introduction": "Ensuring the integrity of data exchanged between a physical asset and its digital twin is a cornerstone of cyber-physical system security. A Message Authentication Code (MAC) is a primary mechanism for this purpose, acting as a cryptographic seal on information. This exercise  provides a hands-on opportunity to connect the theoretical strength of a MAC, dictated by its tag length, to a concrete system safety requirement. By calculating the minimum tag size needed to defend against random forgery, you will engage in the fundamental process of security engineering: selecting parameters to meet a quantitative security target.",
            "id": "4244752",
            "problem": "A digital twin of a cyber-physical system enforces data integrity using a keyed Message Authentication Code (MAC; Message Authentication Code) with an $n$-bit tag on each telemetry message. In terms of the Confidentiality, Integrity, and Availability (CIA; Confidentiality, Integrity, and Availability) triad, the MAC specifically targets the Integrity property by making unauthorized modifications detectable. Assume a computationally bounded adversary with no access to the MAC key attempts tampering by submitting forged messages with randomly guessed tags. Treat each verification event as a single Bernoulli trial and assume the MAC produces tags that are uniformly distributed over the set of all $n$-bit strings.\n\nUsing only these foundational assumptions, derive from first principles the per-message probability that a random forgery is accepted and the complementary probability that tampering is detected. The system’s safety case requires that the probability of an undetected tamper per message is no greater than $10^{-9}$. Determine the minimal integer tag length $n$ that meets this requirement, and then provide the detection probability at that tag length as a single exact closed-form expression. No rounding is required. Express your final answer as a single real-valued expression without units.",
            "solution": "The problem asks for the derivation of the minimal tag length, $n$, for a Message Authentication Code (MAC) system that satisfies a given safety requirement, and then to provide the corresponding detection probability. The solution will be derived from the first principles of probability theory based on the assumptions provided.\n\nFirst, we analyze the properties of the MAC tag. The tag is an $n$-bit string. The total number of unique possible tags is the number of distinct values that an $n$-bit string can represent. This defines the size of our sample space, $S$.\n$$ |S| = 2^n $$\nThe problem states that the MAC produces tags that are uniformly distributed over this set of all $n$-bit strings. For a given message, a valid MAC function produces a single, deterministic tag. However, for an adversary who does not know the secret key, any of the $2^n$ possible tags is equally likely to be the correct one.\n\nThe adversary attempts to forge a message by guessing a tag randomly. The forgery is accepted if the guessed tag matches the correct tag for that message. Since the adversary's guess is random and there is only one correct tag out of $2^n$ possibilities, the probability of a single guess being correct is the ratio of favorable outcomes ($1$) to the total number of possible outcomes ($2^n$). This is the per-message probability that a random forgery is accepted, which we denote as $P_{\\text{accept}}$.\n$$ P_{\\text{accept}} = \\frac{1}{2^n} = 2^{-n} $$\nThis model corresponds to a single Bernoulli trial where \"success\" is defined as the adversary successfully forging a message.\n\nThe complementary event is the detection of tampering. The probability of detection, $P_{\\text{detect}}$, is the probability that a randomly guessed tag does not match the correct tag.\n$$ P_{\\text{detect}} = 1 - P_{\\text{accept}} = 1 - 2^{-n} $$\n\nThe system's safety case imposes a requirement on the probability of an undetected tamper. This probability is precisely $P_{\\text{accept}}$. The requirement is:\n$$ P_{\\text{accept}} \\le 10^{-9} $$\nSubstituting the expression for $P_{\\text{accept}}$ into the inequality gives:\n$$ 2^{-n} \\le 10^{-9} $$\nTo solve for the minimal integer tag length $n$, we can manipulate this inequality. Taking the reciprocal of both sides reverses the inequality sign:\n$$ 2^n \\ge 10^9 $$\nNow, we take the base-$2$ logarithm of both sides to isolate $n$:\n$$ \\log_2(2^n) \\ge \\log_2(10^9) $$\n$$ n \\ge 9 \\log_2(10) $$\nTo find the numerical value, we can use the change of base formula for logarithms, $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$:\n$$ n \\ge 9 \\frac{\\ln(10)}{\\ln(2)} $$\nUsing the approximate values $\\ln(10) \\approx 2.302585$ and $\\ln(2) \\approx 0.693147$:\n$$ n \\ge 9 \\times \\frac{2.302585}{0.693147} \\approx 9 \\times 3.321928 \\approx 29.89735 $$\nSince the tag length $n$ must be an integer, the minimal integer value for $n$ that satisfies this condition is the smallest integer greater than or equal to $29.89735$.\n$$ n_{\\text{min}} = 30 $$\n\nThe problem asks for the detection probability, $P_{\\text{detect}}$, at this minimal required tag length. We use the derived formula for $P_{\\text{detect}}$ with $n = 30$:\n$$ P_{\\text{detect}} = 1 - 2^{-n} = 1 - 2^{-30} $$\nThis is the final exact, closed-form expression for the detection probability.\nThe value of $2^{10}$ is $1024$, which is approximately $10^3$. Therefore, $2^{30} = (2^{10})^3 \\approx (10^3)^3 = 10^9$.\nSpecifically, $2^{30} = 1,073,741,824$.\nThe acceptance probability at $n=30$ is $P_{\\text{accept}} = 2^{-30} = \\frac{1}{1,073,741,824}$, which is less than $10^{-9} = \\frac{1}{1,000,000,000}$, so the condition is met.\nThe corresponding detection probability is $1 - 2^{-30}$.",
            "answer": "$$ \\boxed{1 - 2^{-30}} $$"
        },
        {
            "introduction": "While integrity ensures data isn't tampered with, confidentiality protects it from being read by unauthorized parties. In many CPS architectures, confidentiality relies on the secrecy of cryptographic keys. This practice  moves beyond static analysis to consider security as a function of time and adversarial capability. You will model a realistic brute-force attack and calculate the probability of success, learning how to quantify the erosion of a system's security margin over its operational lifetime.",
            "id": "4244777",
            "problem": "A remote-control channel in a cyber-physical system (CPS) fleet is mirrored in its Digital Twin and protected by a symmetric pre-shared key of length $k$ bits. The CPS vendor claims that confidentiality, integrity, and availability (CIA; Confidentiality, Integrity, Availability) are preserved because commands are encrypted and authenticated with a uniformly random key and the Digital Twin provides only telemetry. An adversary leverages publicly archived Digital Twin telemetry that includes known command structures to mount an offline brute-force key search: each key guess is independently tested by verifying whether a guessed key yields a valid decrypt-and-verify outcome on the archived data. Assume the following scientifically grounded model:\n- Keys are uniformly distributed over the $2^{k}$ possible values.\n- Each independent key guess has probability $p$ of success determined solely by key space size.\n- The adversary can sustain a constant rate $r$ of independent guesses per unit time over a continuous interval of length $T$.\n- Time is measured in seconds and the guess rate $r$ is in guesses per second.\n\nStarting from first principles for independent Bernoulli trials and standard stochastic modeling of rare events, derive an approximation for the probability of at least one successful brute-force within the time horizon $T$. Use a first-order approximation valid when the expected number of successes is small and apply a physically realistic cap that no probability exceeds $1$. Then, compute this approximate probability for a legacy CPS deployment with $k=80$ bits, $r = 2.5 \\times 10^{12}$ guesses per second, and $T = 90$ days. Express your final probability as a decimal and round to four significant figures. Explain briefly in your reasoning how this connects to the Confidentiality, Integrity, Availability (CIA) triad and articulate the implied security margin for CPS devices under the stated model, but ensure the final numeric answer is only the approximate probability.",
            "solution": "The problem asks for the derivation and calculation of the approximate probability of a successful brute-force key search in a specified time frame.\n\n### Derivation of the Attack Probability\n\nThe adversary performs a series of independent key guesses. Each guess is a trial that can either succeed or fail. This process can be modeled as a sequence of independent Bernoulli trials.\n\nLet $N$ be the total number of key guesses performed. The guess rate is $r$ and the duration is $T$. The time duration $T$ must be converted to seconds to be dimensionally consistent with $r$.\nLet $T_{sec}$ be the duration in seconds.\n$$T_{sec} = 90 \\text{ days} \\times \\frac{24 \\text{ hours}}{1 \\text{ day}} \\times \\frac{3600 \\text{ seconds}}{1 \\text{ hour}}$$\nThe total number of trials is:\n$$N = r T_{sec}$$\nThe key is chosen uniformly from a keyspace of size $2^k$. Therefore, the probability $p$ of any single guess being correct is:\n$$p = \\frac{1}{2^k} = 2^{-k}$$\nLet the random variable $X$ denote the number of successful guesses in $N$ trials. $X$ follows a binomial distribution, $X \\sim B(N, p)$. The probability of at least one success, $P_{success}$, is given by $1$ minus the probability of zero successes:\n$$P_{success} = P(X \\ge 1) = 1 - P(X=0)$$\nFor a binomial distribution, the probability of $0$ successes in $N$ trials is:\n$$P(X=0) = \\binom{N}{0} p^0 (1-p)^{N-0} = (1-p)^N$$\nThus, the exact probability is:\n$$P_{success} = 1 - (1-p)^N$$\nThe problem asks for an approximation valid when the expected number of successes is small. The expected number of successes, denoted by $\\lambda$, is the mean of the binomial distribution:\n$$\\lambda = E[X] = Np$$\nIn our scenario, $N$ is very large and $p$ is very small. In this limit, the binomial distribution can be accurately approximated by a Poisson distribution with parameter $\\lambda = Np$. For a Poisson-distributed variable, the probability of zero events is $P(X=0) = e^{-\\lambda}$.\nThe probability of at least one success is then approximated by:\n$$P_{success} \\approx 1 - e^{-\\lambda}$$\nThe problem further requests a first-order approximation, valid when $\\lambda$ itself is small (i.e., $\\lambda \\ll 1$). We can use the Taylor series expansion of the exponential function $e^{-x}$ around $x=0$, which is $e^{-x} = 1 - x + \\frac{x^2}{2!} - \\dots$.\nTaking only the first-order terms (up to the term linear in $\\lambda$):\n$$e^{-\\lambda} \\approx 1 - \\lambda$$\nSubstituting this into the probability expression:\n$$P_{success} \\approx 1 - (1 - \\lambda) = \\lambda$$\nSo, the derived first-order approximation is simply the expected number of successes:\n$$P_{approx} = \\lambda = Np = rT_{sec}2^{-k}$$\nThe problem states that a physically realistic cap must be applied, such that no probability exceeds $1$. This leads to the final expression for the approximate probability:\n$$P_{approx} = \\min(rT_{sec}2^{-k}, 1)$$\n\n### Connection to the CIA Triad and Security Margin\nThis calculation is central to assessing the security of the Cyber-Physical System (CPS).\n-   **Confidentiality**: The key is used for encryption. If the adversary finds the key (an event with probability $P_{approx}$), they can decrypt all past, present, and future communications on the remote-control channel, completely violating confidentiality.\n-   **Integrity**: In modern symmetric cryptographic systems (AEAD schemes), the same key is used for authentication. An adversary possessing the key can forge valid commands, altering the behavior of the physical system at will. This compromises the integrity of the control loop and the data reflected in the Digital Twin.\n-   **Availability**: By compromising integrity, the adversary can inject commands (e.g., \"shutdown\", \"erase firmware\") that render the CPS non-operational, causing a denial of service and thus violating availability.\n\nThe calculated probability $P_{approx}$ is a quantitative measure of the risk of a total security failure over the time horizon $T$. The \"security margin\" is inversely related to this probability. For a system to be considered secure, this probability must be astronomically small. The result of the calculation will reveal whether the claimed security for this legacy system holds against a determined adversary.\n\n### Numerical Calculation\nWe are given:\n-   $k = 80$\n-   $r = 2.5 \\times 10^{12} \\text{ s}^{-1}$\n-   $T = 90$ days\n\nFirst, we calculate $T_{sec}$:\n$$T_{sec} = 90 \\times 24 \\times 3600 = 7,776,000 \\text{ s} = 7.776 \\times 10^6 \\text{ s}$$\nNext, we calculate the total number of guesses, $N$:\n$$N = r T_{sec} = (2.5 \\times 10^{12}) \\times (7.776 \\times 10^6) = 1.944 \\times 10^{19}$$\nThe probability of a single success is:\n$$p = 2^{-80}$$\nThe approximate probability is $\\lambda = Np$:\n$$P_{approx} = (1.944 \\times 10^{19}) \\times 2^{-80}$$\nWe use the fact that $2^{80} = (2^{10})^8 \\approx 1.2089258 \\times 10^{24}$.\n$$P_{approx} = \\frac{1.944 \\times 10^{19}}{1.2089258 \\times 10^{24}} \\approx 1.60802 \\times 10^{-5}$$\nThis value is much less than $1$, so the cap is not active. The problem requires the answer to be rounded to four significant figures.\n$$P_{approx} \\approx 0.00001608$$\nThis small but non-negligible probability indicates a very low security margin for the CPS, suggesting that the vendor's claim of preserved CIA is questionable under this threat model. An attack of this nature has a small but tangible chance of success.",
            "answer": "$$\n\\boxed{0.00001608}\n$$"
        },
        {
            "introduction": "The pillars of the CIA triad are not independent; enhancing one can sometimes degrade another. This is especially true in time-critical cyber-physical systems, where the 'Availability' requirement extends to meeting strict control loop deadlines for system stability. This final exercise  explores this critical trade-off. By calculating the impact of cryptographic processing delay on the phase margin of a control loop, you will directly quantify how securing confidentiality and integrity can pose a risk to availability, illustrating one of the most sophisticated challenges in CPS and digital twin design.",
            "id": "4244745",
            "problem": "A networked cyber-physical system uses a Digital Twin to monitor and control a physical process via a sampled-data feedback loop. The system must satisfy Security Fundamentals under the Confidentiality, Integrity, and Availability (CIA) triad, where Availability is defined as the ability of the control loop to meet timing constraints and preserve stability under added security-induced delays. The controller is implemented digitally with sampling period $T_s$, and the communication between sensor, controller, and actuator is protected by authenticated encryption.\n\nAssume the following scientifically realistic scenario. The continuous-time loop without encryption has an open-loop phase margin $\\text{PM}_0$ at the design crossover frequency. The sampling period is $T_s$, and, to ensure adequate separation from the Nyquist limit per sampled-data control practice, the crossover frequency is chosen as $\\omega_c = \\gamma \\frac{\\pi}{T_s}$ for some design factor $\\gamma$ strictly less than $1$. Authenticated encryption is applied end-to-end on each packet over both the sensing (sensor-to-controller) and actuation (controller-to-actuator) paths. For each path, one encryption and one decryption are performed sequentially. Let the cryptographic processing rate be $R_{\\text{crypto}}$ in bits per second, the application payload be $P$ bytes, and the fixed per-packet metadata overhead (initialization vector, tag, headers) be $O$ bits. Treat the cryptographic processing as a pure computational delay. The total added delay per control sample due to encryption and decryption on both paths is the sum of the four sequential cryptographic operations.\n\nUsing the fundamental fact that a pure time delay of $\\Delta$ seconds contributes an additional phase lag of $-\\omega \\Delta$ at angular frequency $\\omega$, construct the expression for the new phase margin and evaluate it for the parameters\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$,\n- $\\gamma = \\frac{1}{4}$,\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$,\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{bits/s}$,\n- $P = 3000\\ \\text{bytes}$,\n- $O = 384\\ \\text{bits}$.\n\nExpress the final phase margin in radians, rounded to four significant figures. In addition, briefly justify how this computation quantifies the availability trade-off in the CIA triad for digital twins and cyber-physical systems via control timing and stability. The final numerical answer must be the new phase margin in radians.",
            "solution": "Availability under the Confidentiality, Integrity, and Availability (CIA) triad in cyber-physical systems refers to sustaining the timing and stability guarantees necessary for safe operation. In sampled-data control, stability margins such as phase margin characterize robustness to delays and modeling uncertainties. Adding authenticated encryption preserves confidentiality and integrity but introduces computational delay, which reduces phase margin and hence impacts availability.\n\nWe begin from first principles:\n1. In the frequency domain, a pure time delay of $\\Delta$ seconds is represented by the factor $\\exp(-s \\Delta)$ in the loop transfer function. Evaluated on the imaginary axis $s = j \\omega$, this contributes a phase lag of $-\\omega \\Delta$ at angular frequency $\\omega$.\n2. The phase margin of the open-loop system at the crossover frequency $\\omega_c$ is reduced by the additional lag due to delay. If the original phase margin is $\\text{PM}_0$ (with negligible delay), the new phase margin becomes\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta.\n$$\n3. In sampled-data control, the Nyquist angular frequency is $\\omega_N = \\frac{\\pi}{T_s}$. To avoid aliasing and preserve adequate phase margin, a well-tested design practice is to choose the crossover frequency as a fraction $\\gamma$ of the Nyquist frequency:\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s}, \\quad 0  \\gamma  1.\n$$\n\nWe now quantify the encryption-induced delay. Each packet of size $L$ bits incurs a cryptographic processing time of $\\frac{L}{R_{\\text{crypto}}}$ for encryption and likewise for decryption. For a single path (sensor-to-controller or controller-to-actuator), the processing includes one encryption and one decryption, for a delay per path of\n$$\n\\Delta_{\\text{path}} = \\frac{L}{R_{\\text{crypto}}} + \\frac{L}{R_{\\text{crypto}}} = \\frac{2 L}{R_{\\text{crypto}}}.\n$$\nThe control loop consists of two paths per sample (measurement and actuation), and these four operations occur sequentially within the sampling cycle, so the total added delay per control sample is\n$$\n\\Delta = 2 \\Delta_{\\text{path}} = \\frac{4 L}{R_{\\text{crypto}}}.\n$$\nThe packet bit length $L$ comprises the application payload and fixed metadata:\n$$\nL = 8 P + O,\n$$\nwith $P$ in bytes and $O$ in bits.\n\nSubstitute $\\Delta$ into the phase margin expression:\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta = \\text{PM}_0 - \\left( \\gamma \\frac{\\pi}{T_s} \\right) \\left( \\frac{4 (8 P + O)}{R_{\\text{crypto}}} \\right).\n$$\n\nWe now insert the given numerical values, keeping symbolic form until the final step:\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$,\n- $\\gamma = \\frac{1}{4}$,\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$,\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{bits/s}$,\n- $P = 3000\\ \\text{bytes}$,\n- $O = 384\\ \\text{bits}$.\n\nCompute $L$:\n$$\nL = 8 P + O = 8 \\times 3000 + 384 = 24000 + 384 = 24384\\ \\text{bits}.\n$$\nCompute the total delay:\n$$\n\\Delta = \\frac{4 L}{R_{\\text{crypto}}} = \\frac{4 \\times 24384}{1.50 \\times 10^{8}} = \\frac{97536}{1.50 \\times 10^{8}} \\ \\text{s} = 6.5024 \\times 10^{-4}\\ \\text{s}.\n$$\nCompute the crossover frequency:\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s} = \\frac{1}{4} \\cdot \\frac{\\pi}{6.0 \\times 10^{-3}} = \\frac{\\pi}{2.4 \\times 10^{-2}} \\ \\text{rad/s} \\approx 1.308996938995747 \\times 10^{2}\\ \\text{rad/s}.\n$$\nCompute the additional phase lag at $\\omega_c$ due to $\\Delta$:\n$$\n\\omega_c \\Delta \\approx \\left(1.308996938995747 \\times 10^{2}\\right) \\left(6.5024 \\times 10^{-4}\\right)\\ \\text{rad} \\approx 8.511621696 \\times 10^{-2}\\ \\text{rad}.\n$$\nFinally, compute the new phase margin:\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta \\approx 0.700 - 0.08511621696 = 0.61488378304\\ \\text{rad}.\n$$\nRounded to four significant figures and expressed in radians, the new phase margin is $0.6149\\ \\text{rad}$.\n\nJustification of availability trade-off: Under the CIA triad, enforcing confidentiality and integrity via authenticated encryption adds computational delay $\\Delta$, which introduces an extra phase lag $-\\omega_c \\Delta$ at the loop’s crossover frequency. This reduces the phase margin from $\\text{PM}_0$ to $\\text{PM}$, directly quantifying the impact on control robustness and the system’s ability to meet timing constraints. The computation shows how security overhead diminishes the stability margin, linking security configuration to availability in a digital twin-enabled cyber-physical system.",
            "answer": "$$\\boxed{0.6149}$$"
        }
    ]
}