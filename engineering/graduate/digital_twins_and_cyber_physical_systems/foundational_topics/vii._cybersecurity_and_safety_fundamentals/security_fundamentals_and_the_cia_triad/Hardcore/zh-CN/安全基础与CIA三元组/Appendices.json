{
    "hands_on_practices": [
        {
            "introduction": "保密性是CIA三元组的第一个支柱，旨在防止未经授权的信息泄露。本练习将引导您从第一性原理出发，量化评估一个加密密钥在面对持续的暴力破解攻击时的安全性 。通过计算在给定时间和计算资源下密钥被破解的概率，您将学会如何将抽象的安全声明转化为具体的风险指标，这是评估和加固信息物理系统安全边界的关键一步。",
            "id": "4244777",
            "problem": "在一个信息物理系统（CPS）集群中，一个远程控制信道在其数字孪生中被镜像，并由一个长度为 $k$ 比特的对称预共享密钥保护。CPS供应商声称，由于命令使用均匀随机的密钥进行加密和认证，并且数字孪生仅提供遥测数据，因此保密性、完整性和可用性（CIA；Confidentiality, Integrity, Availability）得到了保障。一个攻击者利用公开存档的、包含已知命令结构的数字孪生遥测数据，发起离线暴力破解密钥搜索：通过验证猜测的密钥是否能在存档数据上产生有效的解密和验证结果，来独立测试每一次密钥猜测。假设以下有科学依据的模型：\n- 密钥在 $2^{k}$ 个可能的值上均匀分布。\n- 每次独立的密钥猜测的成功概率 $p$ 仅由密钥空间大小决定。\n- 攻击者可以在长度为 $T$ 的连续时间间隔内，以恒定的速率 $r$（单位时间内的独立猜测次数）进行猜测。\n- 时间以秒为单位，猜测速率 $r$ 的单位是“次/秒”。\n\n从独立伯努利试验的基本原理和罕见事件的标准随机模型出发，推导在时间范围 $T$ 内至少有一次暴力破解成功的近似概率。使用在预期成功次数很少时有效的一阶近似，并应用一个物理上现实的上限，即概率不超过 $1$。然后，为一个传统的CPS部署计算这个近似概率，其中 $k=80$ 比特，$r = 2.5 \\times 10^{12}$ 次猜测/秒，以及 $T = 90$ 天。将最终概率表示为小数，并四舍五入到四位有效数字。在你的推理中简要解释这如何与保密性、完整性、可用性（CIA）三元组相关联，并阐明在所述模型下CPS设备所隐含的安全裕度，但确保最终的数值答案仅为近似概率。",
            "solution": "该问题要求推导和计算在指定时间范围内成功进行暴力破解密钥搜索的近似概率。\n\n首先根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   密钥长度：$k$ 比特。\n-   密钥分布：在 $2^k$ 个值上均匀分布。\n-   单次猜测的成功概率：$p$，仅由密钥空间大小决定。\n-   猜测速率：$r$，恒定，单位为“次/秒”。\n-   攻击持续时间：$T$，一个连续区间。\n-   时间单位：秒。\n-   任务：推导在时间 $T$ 内至少有一次成功的概率的一阶近似，该近似在预期成功次数较少时有效，并以 $1$ 为上限。\n-   用于计算的数值：\n    -   $k = 80$ 比特\n    -   $r = 2.5 \\times 10^{12}$ 次猜测/秒\n    -   $T = 90$ 天\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它使用一个完善的概率模型（伯努利试验及其近似）描述了一个标准的密码学攻击场景（暴力破解）。这些参数虽然代表了一个强大的攻击者，但在对一个传统系统进行理论安全分析时，处于一个合理的范围内。所有必要的数据都已提供，目标也已明确定义。该问题是有效的。\n\n### 步骤3：结论与行动\n该问题有效。将提供一个解决方案。\n\n### 攻击概率的推导\n\n攻击者进行一系列独立的密钥猜测。每次猜测都是一次可能成功或失败的试验。这个过程可以被建模为一系列独立的伯努利试验。\n\n设 $N$ 为执行的密钥猜测总次数。猜测速率为 $r$，持续时间为 $T$。持续时间 $T$ 必须转换为秒，以便与 $r$ 的量纲保持一致。\n设 $T_{sec}$ 为以秒为单位的持续时间。\n$$T_{sec} = 90 \\text{ days} \\times \\frac{24 \\text{ hours}}{1 \\text{ day}} \\times \\frac{3600 \\text{ seconds}}{1 \\text{ hour}}$$\n试验的总次数为：\n$$N = r T_{sec}$$\n密钥是从大小为 $2^k$ 的密钥空间中均匀选择的。因此，任何单次猜测正确的概率 $p$ 为：\n$$p = \\frac{1}{2^k} = 2^{-k}$$\n设随机变量 $X$ 表示在 $N$ 次试验中成功猜测的次数。$X$ 服从二项分布，$X \\sim B(N, p)$。至少有一次成功的概率 $P_{success}$ 由 $1$ 减去零次成功的概率得出：\n$$P_{success} = P(X \\ge 1) = 1 - P(X=0)$$\n对于二项分布，在 $N$ 次试验中 $0$ 次成功的概率是：\n$$P(X=0) = \\binom{N}{0} p^0 (1-p)^{N-0} = (1-p)^N$$\n因此，确切的概率是：\n$$P_{success} = 1 - (1-p)^N$$\n问题要求一个在预期成功次数很小时有效的近似。预期成功次数，用 $\\lambda$ 表示，是二项分布的均值：\n$$\\lambda = E[X] = Np$$\n在我们的场景中，$N$ 非常大而 $p$ 非常小。在此极限下，二项分布可以由参数为 $\\lambda = Np$ 的泊松分布精确近似。对于服从泊松分布的变量，零次事件的概率是 $P(X=0) = e^{-\\lambda}$。\n那么，至少有一次成功的概率近似为：\n$$P_{success} \\approx 1 - e^{-\\lambda}$$\n问题进一步要求一个一阶近似，当 $\\lambda$ 本身很小（即 $\\lambda \\ll 1$）时有效。我们可以使用指数函数 $e^{-x}$ 在 $x=0$ 附近的泰勒级数展开，即 $e^{-x} = 1 - x + \\frac{x^2}{2!} - \\dots$。\n只取一阶项（到关于 $\\lambda$ 的线性项为止）：\n$$e^{-\\lambda} \\approx 1 - \\lambda$$\n将此代入概率表达式中：\n$$P_{success} \\approx 1 - (1 - \\lambda) = \\lambda$$\n所以，推导得出的一阶近似就是预期的成功次数：\n$$P_{approx} = \\lambda = Np = rT_{sec}2^{-k}$$\n问题指出必须应用一个物理上现实的上限，使得概率不超过 $1$。这导出了近似概率的最终表达式：\n$$P_{approx} = \\min(rT_{sec}2^{-k}, 1)$$\n\n### 与CIA三元组和安全裕度的联系\n这个计算对于评估信息物理系统（CPS）的安全性至关重要。\n-   **保密性**：密钥用于加密。如果攻击者找到了密钥（一个概率为 $P_{approx}$ 的事件），他们就可以解密远程控制信道上所有过去、现在和未来的通信，从而完全破坏保密性。\n-   **完整性**：在现代对称密码系统（AEAD方案）中，同一个密钥也用于认证。拥有密钥的攻击者可以伪造有效的命令，随意改变物理系统的行为。这会损害控制回路的完整性以及数字孪生中反映的数据的完整性。\n-   **可用性**：通过破坏完整性，攻击者可以注入命令（例如，“关机”、“擦除固件”）使CPS无法运行，从而导致拒绝服务并破坏可用性。\n\n计算出的概率 $P_{approx}$ 是在时间范围 $T$ 内发生完全安全故障风险的定量度量。“安全裕度”与此概率成反比。要使一个系统被认为是安全的，这个概率必须是极小的。计算结果将揭示这个传统系统所声称的安全性在面对有决心的攻击者时是否成立。\n\n### 数值计算\n我们已知：\n-   $k = 80$\n-   $r = 2.5 \\times 10^{12} \\text{ s}^{-1}$\n-   $T = 90$ 天\n\n首先，我们计算 $T_{sec}$：\n$$T_{sec} = 90 \\times 24 \\times 3600 = 7,776,000 \\text{ s} = 7.776 \\times 10^6 \\text{ s}$$\n接下来，我们计算总猜测次数 $N$：\n$$N = r T_{sec} = (2.5 \\times 10^{12}) \\times (7.776 \\times 10^6) = 1.944 \\times 10^{19}$$\n单次成功的概率是：\n$$p = 2^{-80}$$\n近似概率为 $\\lambda = Np$：\n$$P_{approx} = (1.944 \\times 10^{19}) \\times 2^{-80}$$\n我们利用 $2^{80} = (2^{10})^8 \\approx 1.2089258 \\times 10^{24}$ 这一事实。\n$$P_{approx} = \\frac{1.944 \\times 10^{19}}{1.2089258 \\times 10^{24}} \\approx 1.60802 \\times 10^{-5}$$\n这个值远小于 $1$，因此上限未被激活。问题要求答案四舍五入到四位有效数字。\n$$P_{approx} \\approx 0.00001608$$\n这个虽小但不可忽略的概率表明该CPS的安全裕度非常低，这意味着在该威胁模型下，供应商关于CIA得以保障的声明是值得怀疑的。这种性质的攻击有微小但切实存在的成功机会。",
            "answer": "$$\n\\boxed{0.00001608}\n$$"
        },
        {
            "introduction": "完整性确保数据在传输和存储过程中未被篡改，是建立可信的数字孪生模型的基础。本练习聚焦于一种关键的完整性保障机制——消息认证码（MAC），并探讨其安全参数的设计 。您将通过计算，确定为满足严苛的安全标准（例如，随机伪造的成功概率低于十亿分之一），MAC标签所需的最小长度，从而将概率论基本原理应用于关键系统的安全设计决策中。",
            "id": "4244752",
            "problem": "一个信息物理系统的数字孪生使用带密钥的消息认证码 (MAC; Message Authentication Code)，通过为每条遥测消息附加一个 $n$ 比特的标签来保证数据完整性。在机密性、完整性和可用性 (CIA; Confidentiality, Integrity, and Availability) 三元组方面，MAC 通过使未经授权的修改可被检测，专门针对完整性这一属性。假设一个无法访问 MAC 密钥的计算受限的对手，试图通过提交带有随机猜测标签的伪造消息来进行篡改。将每次验证事件视为一次独立的伯努利试验，并假设 MAC 生成的标签在所有 $n$ 比特字符串的集合上均匀分布。\n\n仅使用这些基本假设，从第一性原理推导出单条消息的随机伪造被接受的概率，以及篡改被检测到的互补概率。系统的安全论证要求，每条消息的未检测篡改概率不大于 $10^{-9}$。确定满足此要求的最小整数标签长度 $n$，然后以单个精确的闭式表达式形式给出该标签长度下的检测概率。无需四舍五入。将你的最终答案表示为无单位的单个实值表达式。",
            "solution": "问题要求推导满足给定安全要求的消息认证码 (MAC) 系统的最小标签长度 $n$，然后给出相应的检测概率。解决方案将基于所提供的假设，从概率论的第一性原理推导得出。\n\n首先，我们分析 MAC 标签的属性。标签是一个 $n$ 比特字符串。唯一可能标签的总数是一个 $n$ 比特字符串可以表示的不同值的数量。这定义了我们样本空间 $S$ 的大小。\n$$ |S| = 2^n $$\n问题陈述，MAC 生成的标签在所有 $n$ 比特字符串的集合上均匀分布。对于给定的消息，一个有效的 MAC 函数会生成一个单一的、确定性的标签。然而，对于不知道密钥的对手来说，$2^n$ 个可能标签中的任何一个都有同等可能性是正确的那个。\n\n对手试图通过随机猜测标签来伪造消息。如果猜测的标签与该消息的正确标签匹配，则伪造被接受。由于对手的猜测是随机的，并且在 $2^n$ 种可能性中只有一个正确的标签，因此单次猜测正确的概率是有利结果（1个）与所有可能结果总数（$2^n$个）的比率。这就是单条消息随机伪造被接受的概率，我们将其表示为 $P_{\\text{accept}}$。\n$$ P_{\\text{accept}} = \\frac{1}{2^n} = 2^{-n} $$\n该模型对应于一次独立的伯努利试验，其中“成功”定义为对手成功伪造一条消息。\n\n互补事件是检测到篡改。检测概率 $P_{\\text{detect}}$ 是指随机猜测的标签与正确标签不匹配的概率。\n$$ P_{\\text{detect}} = 1 - P_{\\text{accept}} = 1 - 2^{-n} $$\n\n系统的安全论证对未被检测到的篡改概率提出了一项要求。这个概率正是 $P_{\\text{accept}}$。该要求是：\n$$ P_{\\text{accept}} \\le 10^{-9} $$\n将 $P_{\\text{accept}}$ 的表达式代入不等式，得到：\n$$ 2^{-n} \\le 10^{-9} $$\n为了求解最小整数标签长度 $n$，我们可以变换这个不等式。对两边取倒数会反转不等号：\n$$ 2^n \\ge 10^9 $$\n现在，我们对两边取以 2 为底的对数来分离出 $n$：\n$$ \\log_2(2^n) \\ge \\log_2(10^9) $$\n$$ n \\ge 9 \\log_2(10) $$\n为了求出数值，我们可以使用对数换底公式 $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$：\n$$ n \\ge 9 \\frac{\\ln(10)}{\\ln(2)} $$\n使用近似值 $\\ln(10) \\approx 2.302585$ 和 $\\ln(2) \\approx 0.693147$：\n$$ n \\ge 9 \\times \\frac{2.302585}{0.693147} \\approx 9 \\times 3.321928 \\approx 29.89735 $$\n由于标签长度 $n$ 必须是整数，因此满足此条件的 $n$ 的最小整数值是大于或等于 $29.89735$ 的最小整数。\n$$ n_{\\text{min}} = 30 $$\n\n问题要求计算在这个最小要求标签长度下的检测概率 $P_{\\text{detect}}$。我们使用推导出的 $P_{\\text{detect}}$ 公式，并代入 $n = 30$：\n$$ P_{\\text{detect}} = 1 - 2^{-n} = 1 - 2^{-30} $$\n这就是检测概率的最终精确闭式表达式。\n$2^{10}$ 的值是 $1024$，约等于 $10^3$。因此，$2^{30} = (2^{10})^3 \\approx (10^3)^3 = 10^9$。\n具体来说，$2^{30} = 1,073,741,824$。\n在 $n=30$ 时，接受概率为 $P_{\\text{accept}} = 2^{-30} = \\frac{1}{1,073,741,824}$，该值小于 $10^{-9} = \\frac{1}{1,000,000,000}$，因此条件得到滿足。\n相应的检测概率是 $1 - 2^{-30}$。",
            "answer": "$$ \\boxed{1 - 2^{-30}} $$"
        },
        {
            "introduction": "可用性是确保信息物理系统（CPS）能够在其预定功能所需的时间内可靠运行的能力，在时间敏感的控制应用中尤为重要。然而，增强保密性和完整性的安全措施并非没有代价。本练习将通过一个实际的控制系统场景，量化分析加密操作引入的计算延迟如何直接影响系统的稳定性裕度 。这项实践揭示了CIA三元组各元素之间固有的权衡关系，强调了在设计安全CPS时必须综合考量其对实时性能的影响。",
            "id": "4244745",
            "problem": "一个网络化的信息物理系统使用数字孪生（Digital Twin）通过采样数据反馈回路来监控物理过程。该系统必须满足保密性（Confidentiality）、完整性（Integrity）和可用性（Availability）（CIA）三元组下的安全基本原则，其中可用性被定义为控制回路在增加的安全引起的延迟下满足时序约束并保持稳定性的能力。控制器以采样周期 $T_s$ 进行数字化实现，传感器、控制器和执行器之间的通信受认证加密保护。\n\n假设存在以下科学上真实的情景。没有加密的连续时间回路在设计穿越频率处具有开环相位裕度 $\\text{PM}_0$。采样周期为 $T_s$，并且，为了根据采样数据控制实践确保与奈奎斯特（Nyquist）极限有足够的间隔，穿越频率被选为 $\\omega_c = \\gamma \\frac{\\pi}{T_s}$，其中设计因子 $\\gamma$ 严格小于 $1$。认证加密被端到端地应用于传感（传感器到控制器）和执行（控制器到执行器）两条路径上的每个数据包。对于每条路径，顺序执行一次加密和一次解密。设加密处理速率为 $R_{\\text{crypto}}$（单位为比特/秒），应用负载为 $P$ 字节，每个数据包的固定元数据开销（初始化向量、标签、报头）为 $O$ 比特。将加密处理视为纯粹的计算延迟。由于两条路径上的加密和解密，每个控制样本的总附加延迟是四个顺序加密操作的总和。\n\n利用纯时间延迟 $\\Delta$ 秒会在角频率 $\\omega$ 处产生一个附加相位滞后 $-\\omega \\Delta$ 这一基本事实，构建新相位裕度的表达式，并针对以下参数进行评估：\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$，\n- $\\gamma = \\frac{1}{4}$，\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$，\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{比特/秒}$，\n- $P = 3000\\ \\text{字节}$，\n- $O = 384\\ \\text{比特}$。\n\n将最终相位裕度以弧度表示，并四舍五入到四位有效数字。此外，简要说明该计算如何通过控制时序和稳定性来量化数字孪生和信息物理系统中CIA三元组的可用性权衡。最终的数值答案必须是新的相位裕度（以弧度为单位）。",
            "solution": "在信息物理系统中，保密性、完整性和可用性（CIA）三元组下的可用性指的是维持安全操作所需的时序和稳定性保证。在采样数据控制中，相位裕度等稳定性裕度表征了系统对延迟和建模不确定性的鲁棒性。添加认证加密可以保护保密性和完整性，但会引入计算延迟，这会减小相位裕度，从而影响可用性。\n\n我们从基本原理开始：\n1. 在频域中，一个 $\\Delta$ 秒的纯时间延迟在回路传递函数中由因子 $\\exp(-s \\Delta)$ 表示。在虚轴 $s = j \\omega$ 上求值，这会在角频率 $\\omega$ 处产生一个 $-\\omega \\Delta$ 的相位滞后。\n2. 开环系统在穿越频率 $\\omega_c$ 处的相位裕度会因延迟引起的附加滞后而减小。如果原始相位裕度为 $\\text{PM}_0$（延迟可忽略不计），则新的相位裕度变为\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta.\n$$\n3. 在采样数据控制中，奈奎斯特角频率为 $\\omega_N = \\frac{\\pi}{T_s}$。为避免混叠并保留足够的相位裕度，一种经过充分检验的设计实践是选择穿越频率为奈奎斯特频率的一部分 $\\gamma$：\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s}, \\quad 0  \\gamma  1.\n$$\n\n我们现在量化加密引起的延迟。每个大小为 $L$ 比特的数据包在加密时会产生 $\\frac{L}{R_{\\text{crypto}}}$ 的加密处理时间，解密时同样如此。对于单条路径（传感器到控制器或控制器到执行器），处理过程包括一次加密和一次解密，因此每条路径的延迟为\n$$\n\\Delta_{\\text{path}} = \\frac{L}{R_{\\text{crypto}}} + \\frac{L}{R_{\\text{crypto}}} = \\frac{2 L}{R_{\\text{crypto}}}.\n$$\n控制回路每个样本包含两条路径（测量和执行），这四个操作在采样周期内顺序发生，因此每个控制样本的总附加延迟为\n$$\n\\Delta = 2 \\Delta_{\\text{path}} = \\frac{4 L}{R_{\\text{crypto}}}.\n$$\n数据包的比特长度 $L$ 包括应用负载和固定的元数据：\n$$\nL = 8 P + O,\n$$\n其中 $P$ 的单位是字节，$O$ 的单位是比特。\n\n将 $\\Delta$ 代入相位裕度表达式：\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta = \\text{PM}_0 - \\left( \\gamma \\frac{\\pi}{T_s} \\right) \\left( \\frac{4 (8 P + O)}{R_{\\text{crypto}}} \\right).\n$$\n\n我们现在代入给定的数值，在最后一步之前保留符号形式：\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$，\n- $\\gamma = \\frac{1}{4}$，\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$，\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{比特/秒}$，\n- $P = 3000\\ \\text{字节}$，\n- $O = 384\\ \\text{比特}$。\n\n计算 $L$：\n$$\nL = 8 P + O = 8 \\times 3000 + 384 = 24000 + 384 = 24384\\ \\text{比特}。\n$$\n计算总延迟：\n$$\n\\Delta = \\frac{4 L}{R_{\\text{crypto}}} = \\frac{4 \\times 24384}{1.50 \\times 10^{8}} = \\frac{97536}{1.50 \\times 10^{8}} \\ \\text{s} = 6.5024 \\times 10^{-4}\\ \\text{s}。\n$$\n计算穿越频率：\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s} = \\frac{1}{4} \\cdot \\frac{\\pi}{6.0 \\times 10^{-3}} = \\frac{\\pi}{2.4 \\times 10^{-2}} \\ \\text{rad/s} \\approx 1.308996938995747 \\times 10^{2}\\ \\text{rad/s}。\n$$\n计算由 $\\Delta$ 在 $\\omega_c$ 处引起的附加相位滞后：\n$$\n\\omega_c \\Delta \\approx \\left(1.308996938995747 \\times 10^{2}\\right) \\left(6.5024 \\times 10^{-4}\\right)\\ \\text{rad} \\approx 8.511621696 \\times 10^{-2}\\ \\text{rad}。\n$$\n最后，计算新的相位裕度：\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta \\approx 0.700 - 0.08511621696 = 0.61488378304\\ \\text{rad}。\n$$\n四舍五入到四位有效数字并以弧度表示，新的相位裕度为 $0.6149\\ \\text{rad}$。\n\n可用性权衡的论证：在CIA三元组下，通过认证加密来强制执行保密性和完整性会增加计算延迟 $\\Delta$，这会在回路的穿越频率处引入一个额外的相位滞后 $-\\omega_c \\Delta$。这使得相位裕度从 $\\text{PM}_0$ 减小到 $\\text{PM}$，从而直接量化了对控制鲁棒性和系统满足时序约束能力的影响。该计算表明，安全开销如何削弱稳定性裕度，从而将安全配置与支持数字孪生的信息物理系统中的可用性联系起来。",
            "answer": "$$\\boxed{0.6149}$$"
        }
    ]
}