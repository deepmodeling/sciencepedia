{
    "hands_on_practices": [
        {
            "introduction": "In any cyber-physical system, ensuring data integrity is paramount, as decisions and physical actions are based on sensor readings and control commands. This first practice explores the fundamental mechanism for guaranteeing integrity: the Message Authentication Code (MAC). You will derive from first principles how a MAC's tag length directly determines its strength against random forgery attempts, providing a quantitative link between a design parameter and the level of security achieved . This exercise is crucial for learning how to engineer systems that meet specific, measurable safety and integrity standards.",
            "id": "4244752",
            "problem": "A digital twin of a cyber-physical system enforces data integrity using a keyed Message Authentication Code (MAC; Message Authentication Code) with an $n$-bit tag on each telemetry message. In terms of the Confidentiality, Integrity, and Availability (CIA; Confidentiality, Integrity, and Availability) triad, the MAC specifically targets the Integrity property by making unauthorized modifications detectable. Assume a computationally bounded adversary with no access to the MAC key attempts tampering by submitting forged messages with randomly guessed tags. Treat each verification event as a single Bernoulli trial and assume the MAC produces tags that are uniformly distributed over the set of all $n$-bit strings.\n\nUsing only these foundational assumptions, derive from first principles the per-message probability that a random forgery is accepted and the complementary probability that tampering is detected. The system’s safety case requires that the probability of an undetected tamper per message is no greater than $10^{-9}$. Determine the minimal integer tag length $n$ that meets this requirement, and then provide the detection probability at that tag length as a single exact closed-form expression. No rounding is required. Express your final answer as a single real-valued expression without units.",
            "solution": "The problem asks for the derivation of the minimal tag length, $n$, for a Message Authentication Code (MAC) system that satisfies a given safety requirement, and then to provide the corresponding detection probability. The solution will be derived from the first principles of probability theory based on the assumptions provided.\n\nFirst, we analyze the properties of the MAC tag. The tag is an $n$-bit string. The total number of unique possible tags is the number of distinct values that an $n$-bit string can represent. This defines the size of our sample space, $S$.\n$$ |S| = 2^n $$\nThe problem states that the MAC produces tags that are uniformly distributed over this set of all $n$-bit strings. For a given message, a valid MAC function produces a single, deterministic tag. However, for an adversary who does not know the secret key, any of the $2^n$ possible tags is equally likely to be the correct one.\n\nThe adversary attempts to forge a message by guessing a tag randomly. The forgery is accepted if the guessed tag matches the correct tag for that message. Since the adversary's guess is random and there is only one correct tag out of $2^n$ possibilities, the probability of a single guess being correct is the ratio of favorable outcomes ($1$) to the total number of possible outcomes ($2^n$). This is the per-message probability that a random forgery is accepted, which we denote as $P_{\\text{accept}}$.\n$$ P_{\\text{accept}} = \\frac{1}{2^n} = 2^{-n} $$\nThis model corresponds to a single Bernoulli trial where \"success\" is defined as the adversary successfully forging a message.\n\nThe complementary event is the detection of tampering. The probability of detection, $P_{\\text{detect}}$, is the probability that a randomly guessed tag does not match the correct tag.\n$$ P_{\\text{detect}} = 1 - P_{\\text{accept}} = 1 - 2^{-n} $$\n\nThe system's safety case imposes a requirement on the probability of an undetected tamper. This probability is precisely $P_{\\text{accept}}$. The requirement is:\n$$ P_{\\text{accept}} \\le 10^{-9} $$\nSubstituting the expression for $P_{\\text{accept}}$ into the inequality gives:\n$$ 2^{-n} \\le 10^{-9} $$\nTo solve for the minimal integer tag length $n$, we can manipulate this inequality. Taking the reciprocal of both sides reverses the inequality sign:\n$$ 2^n \\ge 10^9 $$\nNow, we take the base-$2$ logarithm of both sides to isolate $n$:\n$$ \\log_2(2^n) \\ge \\log_2(10^9) $$\n$$ n \\ge 9 \\log_2(10) $$\nTo find the numerical value, we can use the change of base formula for logarithms, $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$:\n$$ n \\ge 9 \\frac{\\ln(10)}{\\ln(2)} $$\nUsing the approximate values $\\ln(10) \\approx 2.302585$ and $\\ln(2) \\approx 0.693147$:\n$$ n \\ge 9 \\times \\frac{2.302585}{0.693147} \\approx 9 \\times 3.321928 \\approx 29.89735 $$\nSince the tag length $n$ must be an integer, the minimal integer value for $n$ that satisfies this condition is the smallest integer greater than or equal to $29.89735$.\n$$ n_{\\text{min}} = 30 $$\n\nThe problem asks for the detection probability, $P_{\\text{detect}}$, at this minimal required tag length. We use the derived formula for $P_{\\text{detect}}$ with $n = 30$:\n$$ P_{\\text{detect}} = 1 - 2^{-n} = 1 - 2^{-30} $$\nThis is the final exact, closed-form expression for the detection probability.\nThe value of $2^{10}$ is $1024$, which is approximately $10^3$. Therefore, $2^{30} = (2^{10})^3 \\approx (10^3)^3 = 10^9$.\nSpecifically, $2^{30} = 1,073,741,824$.\nThe acceptance probability at $n=30$ is $P_{\\text{accept}} = 2^{-30} = \\frac{1}{1,073,741,824}$, which is less than $10^{-9} = \\frac{1}{1,000,000,000}$, so the condition is met.\nThe corresponding detection probability is $1 - 2^{-30}$.",
            "answer": "$$ \\boxed{1 - 2^{-30}} $$"
        },
        {
            "introduction": "Security controls are not implemented in a vacuum; they interact with the system's primary functions, sometimes in non-obvious ways. This practice delves into a critical trade-off inherent in securing real-time cyber-physical systems: the tension between security and availability. By calculating the delay introduced by cryptographic processing, you will quantify its direct impact on the stability of a control loop, measured by the reduction in phase margin . This analysis demonstrates how the addition of confidentiality and integrity can potentially compromise availability, forcing engineers to make informed design choices that balance these competing requirements.",
            "id": "4244745",
            "problem": "A networked cyber-physical system uses a Digital Twin to monitor and control a physical process via a sampled-data feedback loop. The system must satisfy Security Fundamentals under the Confidentiality, Integrity, and Availability (CIA) triad, where Availability is defined as the ability of the control loop to meet timing constraints and preserve stability under added security-induced delays. The controller is implemented digitally with sampling period $T_s$, and the communication between sensor, controller, and actuator is protected by authenticated encryption.\n\nAssume the following scientifically realistic scenario. The continuous-time loop without encryption has an open-loop phase margin $\\text{PM}_0$ at the design crossover frequency. The sampling period is $T_s$, and, to ensure adequate separation from the Nyquist limit per sampled-data control practice, the crossover frequency is chosen as $\\omega_c = \\gamma \\frac{\\pi}{T_s}$ for some design factor $\\gamma$ strictly less than $1$. Authenticated encryption is applied end-to-end on each packet over both the sensing (sensor-to-controller) and actuation (controller-to-actuator) paths. For each path, one encryption and one decryption are performed sequentially. Let the cryptographic processing rate be $R_{\\text{crypto}}$ in bits per second, the application payload be $P$ bytes, and the fixed per-packet metadata overhead (initialization vector, tag, headers) be $O$ bits. Treat the cryptographic processing as a pure computational delay. The total added delay per control sample due to encryption and decryption on both paths is the sum of the four sequential cryptographic operations.\n\nUsing the fundamental fact that a pure time delay of $\\Delta$ seconds contributes an additional phase lag of $-\\omega \\Delta$ at angular frequency $\\omega$, construct the expression for the new phase margin and evaluate it for the parameters\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$,\n- $\\gamma = \\frac{1}{4}$,\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$,\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{bits/s}$,\n- $P = 3000\\ \\text{bytes}$,\n- $O = 384\\ \\text{bits}$.\n\nExpress the final phase margin in radians, rounded to four significant figures. In addition, briefly justify how this computation quantifies the availability trade-off in the CIA triad for digital twins and cyber-physical systems via control timing and stability. The final numerical answer must be the new phase margin in radians.",
            "solution": "Availability under the Confidentiality, Integrity, and Availability (CIA) triad in cyber-physical systems refers to sustaining the timing and stability guarantees necessary for safe operation. In sampled-data control, stability margins such as phase margin characterize robustness to delays and modeling uncertainties. Adding authenticated encryption preserves confidentiality and integrity but introduces computational delay, which reduces phase margin and hence impacts availability.\n\nWe begin from first principles:\n1. In the frequency domain, a pure time delay of $\\Delta$ seconds is represented by the factor $\\exp(-s \\Delta)$ in the loop transfer function. Evaluated on the imaginary axis $s = j \\omega$, this contributes a phase lag of $-\\omega \\Delta$ at angular frequency $\\omega$.\n2. The phase margin of the open-loop system at the crossover frequency $\\omega_c$ is reduced by the additional lag due to delay. If the original phase margin is $\\text{PM}_0$ (with negligible delay), the new phase margin becomes\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta.\n$$\n3. In sampled-data control, the Nyquist angular frequency is $\\omega_N = \\frac{\\pi}{T_s}$. To avoid aliasing and preserve adequate phase margin, a well-tested design practice is to choose the crossover frequency as a fraction $\\gamma$ of the Nyquist frequency:\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s}, \\quad 0 < \\gamma < 1.\n$$\n\nWe now quantify the encryption-induced delay. Each packet of size $L$ bits incurs a cryptographic processing time of $\\frac{L}{R_{\\text{crypto}}}$ for encryption and likewise for decryption. For a single path (sensor-to-controller or controller-to-actuator), the processing includes one encryption and one decryption, for a delay per path of\n$$\n\\Delta_{\\text{path}} = \\frac{L}{R_{\\text{crypto}}} + \\frac{L}{R_{\\text{crypto}}} = \\frac{2 L}{R_{\\text{crypto}}}.\n$$\nThe control loop consists of two paths per sample (measurement and actuation), and these four operations occur sequentially within the sampling cycle, so the total added delay per control sample is\n$$\n\\Delta = 2 \\Delta_{\\text{path}} = \\frac{4 L}{R_{\\text{crypto}}}.\n$$\nThe packet bit length $L$ comprises the application payload and fixed metadata:\n$$\nL = 8 P + O,\n$$\nwith $P$ in bytes and $O$ in bits.\n\nSubstitute $\\Delta$ into the phase margin expression:\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta = \\text{PM}_0 - \\left( \\gamma \\frac{\\pi}{T_s} \\right) \\left( \\frac{4 (8 P + O)}{R_{\\text{crypto}}} \\right).\n$$\n\nWe now insert the given numerical values, keeping symbolic form until the final step:\n- $T_s = 6.0 \\times 10^{-3}\\ \\text{s}$,\n- $\\gamma = \\frac{1}{4}$,\n- $\\text{PM}_0 = 0.700\\ \\text{rad}$,\n- $R_{\\text{crypto}} = 1.50 \\times 10^{8}\\ \\text{bits/s}$,\n- $P = 3000\\ \\text{bytes}$,\n- $O = 384\\ \\text{bits}$.\n\nCompute $L$:\n$$\nL = 8 P + O = 8 \\times 3000 + 384 = 24000 + 384 = 24384\\ \\text{bits}.\n$$\nCompute the total delay:\n$$\n\\Delta = \\frac{4 L}{R_{\\text{crypto}}} = \\frac{4 \\times 24384}{1.50 \\times 10^{8}} = \\frac{97536}{1.50 \\times 10^{8}} \\ \\text{s} = 6.5024 \\times 10^{-4}\\ \\text{s}.\n$$\nCompute the crossover frequency:\n$$\n\\omega_c = \\gamma \\frac{\\pi}{T_s} = \\frac{1}{4} \\cdot \\frac{\\pi}{6.0 \\times 10^{-3}} = \\frac{\\pi}{2.4 \\times 10^{-2}} \\ \\text{rad/s} \\approx 1.308996938995747 \\times 10^{2}\\ \\text{rad/s}.\n$$\nCompute the additional phase lag at $\\omega_c$ due to $\\Delta$:\n$$\n\\omega_c \\Delta \\approx \\left(1.308996938995747 \\times 10^{2}\\right) \\left(6.5024 \\times 10^{-4}\\right)\\ \\text{rad} \\approx 8.511621696 \\times 10^{-2}\\ \\text{rad}.\n$$\nFinally, compute the new phase margin:\n$$\n\\text{PM} = \\text{PM}_0 - \\omega_c \\Delta \\approx 0.700 - 0.08511621696 = 0.61488378304\\ \\text{rad}.\n$$\nRounded to four significant figures and expressed in radians, the new phase margin is $0.6149\\ \\text{rad}$.\n\nJustification of availability trade-off: Under the CIA triad, enforcing confidentiality and integrity via authenticated encryption adds computational delay $\\Delta$, which introduces an extra phase lag $-\\omega_c \\Delta$ at the loop’s crossover frequency. This reduces the phase margin from $\\text{PM}_0$ to $\\text{PM}$, directly quantifying the impact on control robustness and the system’s ability to meet timing constraints. The computation shows how security overhead diminishes the stability margin, linking security configuration to availability in a digital twin-enabled cyber-physical system.",
            "answer": "$$\\boxed{0.6149}$$"
        },
        {
            "introduction": "Effective security strategy requires a holistic view that goes beyond individual mechanisms and considers the entire landscape of potential threats. This final practice shifts the focus to quantitative risk management, a vital tool for decision-making and resource allocation. Using the fundamental concept of expected value, you will calculate the total expected annual loss for a system by aggregating the risks associated with various threats to confidentiality, integrity, and availability . This exercise provides a powerful framework for prioritizing security countermeasures based on their potential to reduce the most significant financial and operational risks.",
            "id": "4244759",
            "problem": "A digital twin orchestrates and synchronizes a cyber-physical system that operates an autonomous continuous manufacturing cell. The digital twin communicates with sensors and actuators, hosts predictive models, and performs scheduling and control advisory functions. In the context of the Confidentiality, Integrity, Availability (CIA) triad, the organization has enumerated the following annual threat scenarios with associated likelihoods and single-incident economic impacts, where $p_i$ denotes the annual probability of occurrence of threat $i$ and $L_i$ denotes the loss if threat $i$ occurs. All $L_i$ are expressed in million dollars.\n\nThe threats are:\n1. Confidentiality breach of proprietary twin models: $p_1 = 0.06$, $L_1 = 1.5$.\n2. Integrity drift in the digital twin’s calibration model leading to mis-setpoints: $p_2 = 0.12$, $L_2 = 0.9$.\n3. Availability degradation due to denial-of-service on the twin’s hypervisor: $p_3 = 0.35$, $L_3 = 0.25$.\n4. Integrity violation via spoofed sensor streams causing miscalibration: $p_4 = 0.10$, $L_4 = 0.6$.\n5. Availability reduction from orchestrator failure reducing throughput: $p_5 = 0.22$, $L_5 = 0.3$.\n6. Confidentiality compromise of client data managed by the twin, incurring regulatory penalties: $p_6 = 0.02$, $L_6 = 2.4$.\n7. Integrity failure from a malicious over-the-air patch causing a programmable logic controller crash: $p_7 = 0.01$, $L_7 = 3.5$.\n8. Availability impact due to network segmentation misconfiguration causing half-day downtime: $p_8 = 0.50$, $L_8 = 0.08$.\n\nAssume each threat $i$ corresponds to a Bernoulli event within the year with probability $p_i$, and the total annual loss is the sum of the realized losses across threats. Using first principles from probability theory and the core security definitions tied to the CIA triad, derive the expected annual economic loss for the system and compute its value.\n\nExpress the final expected annual loss in million dollars. Round your answer to four significant figures.",
            "solution": "The CIA triad—Confidentiality, Integrity, Availability—characterizes security properties: confidentiality protects information from unauthorized disclosure, integrity ensures correctness and trustworthiness of data and processes, and availability guarantees timely and reliable access to systems and information. In risk analysis, each threat aligned to these properties leads to a possible adverse event with some probability and impact.\n\nWe model each threat $i \\in \\{1,2,\\dots,8\\}$ as a Bernoulli random variable $I_i$ that takes value $1$ if the threat event occurs within the year and $0$ otherwise. By construction, $\\Pr(I_i = 1) = p_i$ and $\\Pr(I_i = 0) = 1 - p_i$. The loss contribution from threat $i$ in a given year is then $I_i L_i$, where $L_i$ is the economic impact if the event occurs. The total annual loss $X$ is the sum of contributions across all threats:\n$$\nX = \\sum_{i=1}^{8} I_i L_i.\n$$\nWe seek the expected annual loss $\\mathbb{E}[X]$. From the definition of expectation and the linearity of expectation, which holds regardless of dependence among the $I_i$, we have:\n$$\n\\mathbb{E}[X] = \\mathbb{E}\\!\\left[\\sum_{i=1}^{8} I_i L_i\\right] = \\sum_{i=1}^{8} \\mathbb{E}[I_i L_i].\n$$\nEach $L_i$ is a constant, so\n$$\n\\mathbb{E}[I_i L_i] = L_i \\mathbb{E}[I_i].\n$$\nFor a Bernoulli random variable $I_i$, $\\mathbb{E}[I_i] = \\Pr(I_i = 1) = p_i$. Therefore,\n$$\n\\mathbb{E}[X] = \\sum_{i=1}^{8} L_i p_i.\n$$\nWe now compute each term $L_i p_i$ (in million dollars):\n- $i=1$: $L_1 p_1 = 1.5 \\times 0.06 = 0.09$.\n- $i=2$: $L_2 p_2 = 0.9 \\times 0.12 = 0.108$.\n- $i=3$: $L_3 p_3 = 0.25 \\times 0.35 = 0.0875$.\n- $i=4$: $L_4 p_4 = 0.6 \\times 0.10 = 0.06$.\n- $i=5$: $L_5 p_5 = 0.3 \\times 0.22 = 0.066$.\n- $i=6$: $L_6 p_6 = 2.4 \\times 0.02 = 0.048$.\n- $i=7$: $L_7 p_7 = 3.5 \\times 0.01 = 0.035$.\n- $i=8$: $L_8 p_8 = 0.08 \\times 0.50 = 0.04$.\n\nSumming these contributions:\n$$\n\\mathbb{E}[X] = 0.09 + 0.108 + 0.0875 + 0.06 + 0.066 + 0.048 + 0.035 + 0.04 = 0.5345.\n$$\nThus, the expected annual economic loss is $0.5345$ million dollars. Rounding to four significant figures yields $0.5345$ (already at four significant figures).\n\nInterpretation for resource planning: The expected annual loss $0.5345$ million suggests a baseline financial risk from the digital twin’s security posture. Decomposing $\\mathbb{E}[X]$ highlights dominant contributors: integrity drift ($0.108$), confidentiality breach of models ($0.09$), and availability DoS ($0.0875$) are the top three. For prioritization, controls that reduce $p_2$, $p_1$, or $p_3$, or that reduce $L_2$, $L_1$, or $L_3$ (for example, stronger model validation and monitoring to mitigate integrity drift, hardened access controls and encryption for confidentiality, and resilient architecture for availability) are likely to yield the largest reduction in expected loss per unit resource. While dependencies or co-occurrence can affect variance and tail risk, linearity of expectation ensures the above computation remains valid for planning the mean annual exposure.",
            "answer": "$$\\boxed{0.5345}$$"
        }
    ]
}