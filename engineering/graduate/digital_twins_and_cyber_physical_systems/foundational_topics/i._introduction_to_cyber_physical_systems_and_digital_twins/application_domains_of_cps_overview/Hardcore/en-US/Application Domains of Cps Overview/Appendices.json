{
    "hands_on_practices": [
        {
            "introduction": "Cyber-Physical Systems in safety-critical domains like automotive control rely on predictable network performance to guarantee timely data delivery. This exercise delves into Time-Sensitive Networking (TSN), a key technology for achieving deterministic communication over Ethernet. By deriving the worst-case end-to-end latency from first principles, you will gain a practical understanding of how network parameters like scheduling, serialization, and guard bands impact system-level deadlines .",
            "id": "4205555",
            "problem": "Consider the deterministic control traffic of a Cyber-Physical System (CPS) in an automotive domain carried over a Time-Sensitive Networking (TSN) Ethernet with Time-Aware Shapers (IEEE 802.1Qbv). Each switch enforces a periodic Gate Control List (GCL) that opens a single window exclusively for scheduled traffic in each cycle. Assume the following foundational definitions:\n- The serialization delay of a frame of size $L_i$ bytes on a link of rate $C$ bits per second is $t_{\\mathrm{ser},i} = \\frac{8 L_i}{C}$.\n- A guard band of duration $t_{\\mathrm{gb}}$ is configured before the scheduled window to prevent non-preemptable frames from overlapping the scheduled window.\n- The gate opens once per cycle for scheduled traffic, with cycle period $T_{\\mathrm{cycle}}$ and exclusive scheduled window length $W$. If a scheduled frame arrives immediately after the window closes, it must wait until the next opening.\n\nA control message traverses $N$ Ethernet hops (links plus bridges). The system requirements and network parameters are:\n- Link rate $C = 1.0 \\times 10^{9}$ bits per second.\n- Per-cycle scheduled window length $W = 2.0 \\times 10^{-5}$ seconds and cycle period $T_{\\mathrm{cycle}} = 1.0 \\times 10^{-4}$ seconds at every hop.\n- Guard band duration $t_{\\mathrm{gb}} = 1.2 \\times 10^{-5}$ seconds at every hop.\n- The control frame size is the same at every hop, $L_i = 200$ bytes for all $i = 1, \\dots, N$.\n- Assume all bridges are synchronized to the same cycle period but have independent phase offsets, and no pipeline alignment is guaranteed across hops.\n\nTask:\n1. From first principles, derive a closed-form expression for the worst-case end-to-end latency across $N$ hops under the above TSN time-aware shaper configuration, explicitly accounting for worst-case gate waiting, guard band, and serialization at each hop.\n2. Using your expression, determine the maximum chain length $N_{\\max}$ (number of hops) such that the worst-case end-to-end latency does not exceed the domainâ€™s control deadline $T_{\\mathrm{deadline}} = 2.0 \\times 10^{-3}$ seconds. Provide your final answer as an integer number of hops. No rounding instruction is necessary beyond the requirement that $N_{\\max}$ must be an integer.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of Time-Sensitive Networking (TSN), well-posed with sufficient and consistent data, and objectively stated. We can proceed with the derivation and calculation.\n\nThe first task is to derive a closed-form expression for the worst-case end-to-end latency, $T_{\\text{E2E}}$, for a control message traversing $N$ hops. The problem states that the network consists of $N$ hops, and due to independent phase offsets and a lack of pipeline alignment, the worst-case delay scenario must be assumed at each hop. The total end-to-end latency is therefore the sum of the worst-case latencies at each of the $N$ hops. Since all network parameters are identical for each hop, the total latency is $N$ times the worst-case latency of a single hop, $d_{\\text{hop}}$.\n\n$$T_{\\text{E2E}} = N \\cdot d_{\\text{hop}}$$\n\nThe latency at a single hop, $d_{\\text{hop}}$, comprises several components as specified in the problem: serialization delay, worst-case gate waiting time, and guard band delay.\n\n1.  **Serialization Delay ($t_{\\text{ser}}$)**: This is the time required to transmit the frame's bits onto the physical link. The problem provides the formula and parameters. For a frame of size $L$ bytes on a link with rate $C$ bits per second, the serialization delay is:\n    $$t_{\\text{ser}} = \\frac{8L}{C}$$\n    The factor of $8$ converts the frame size from bytes to bits.\n\n2.  **Worst-Case Gate Waiting Time ($d_{\\text{wait,max}}$)**: The Time-Aware Shaper (TAS) mechanism operates on a periodic cycle of duration $T_{\\text{cycle}}$. Within each cycle, a specific time window of length $W$ is exclusively reserved for the scheduled traffic class of our control message. The worst-case arrival scenario for a frame at a switch's egress queue occurs when it arrives infinitesimally just after its scheduled window has closed. The frame must then wait for the remainder of the current cycle and until the gate opens in the next cycle. The duration of this waiting period is the cycle time minus the window length.\n    $$d_{\\text{wait,max}} = T_{\\text{cycle}} - W$$\n\n3.  **Guard Band Delay ($t_{\\text{gb}}$)**: The problem defines a guard band of duration $t_{\\text{gb}}$ before each scheduled window. This is to prevent frames from other traffic classes, which are non-preemptable, from \"spilling over\" into the scheduled window. In worst-case latency analysis, this is modeled as a blocking delay. A control frame, upon arrival at a switch, may find that a lower-priority (or other class) frame has just begun transmission. The control frame must wait for this transmission to complete before its own queuing and scheduling process can be considered. The problem specifies the maximum duration of this blocking as a fixed value, $t_{\\text{gb}}$. Therefore, we add this term to our per-hop latency calculation.\n\nCombining these components, the worst-case latency for a single hop is the sum of the blocking delay due to the guard band, the maximum gate waiting time, and the serialization delay.\n$$d_{\\text{hop}} = t_{\\text{gb}} + d_{\\text{wait,max}} + t_{\\text{ser}}$$\nSubstituting the expressions for each component, we get:\n$$d_{\\text{hop}} = t_{\\text{gb}} + (T_{\\text{cycle}} - W) + \\frac{8L}{C}$$\n\nConsequently, the closed-form expression for the worst-case end-to-end latency across $N$ hops is:\n$$T_{\\text{E2E}}(N) = N \\left( t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C} \\right)$$\nThis concludes the first task.\n\nThe second task is to find the maximum number of hops, $N_{\\max}$, such that the end-to-end latency does not exceed a specified deadline, $T_{\\text{deadline}}$. We establish the following inequality:\n$$T_{\\text{E2E}}(N) \\le T_{\\text{deadline}}$$\nSubstituting our derived expression for $T_{\\text{E2E}}(N)$:\n$$N \\left( t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C} \\right) \\le T_{\\text{deadline}}$$\nSolving for $N$:\n$$N \\le \\frac{T_{\\text{deadline}}}{t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C}}$$\nThe maximum number of hops, $N_{\\max}$, must be an integer, so we take the floor of the right-hand side.\n$$N_{\\max} = \\left\\lfloor \\frac{T_{\\text{deadline}}}{t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C}} \\right\\rfloor$$\nNow, we substitute the given numerical values:\n-   $T_{\\text{deadline}} = 2.0 \\times 10^{-3}$ s\n-   $t_{\\text{gb}} = 1.2 \\times 10^{-5}$ s\n-   $T_{\\text{cycle}} = 1.0 \\times 10^{-4}$ s\n-   $W = 2.0 \\times 10^{-5}$ s\n-   $L = 200$ bytes\n-   $C = 1.0 \\times 10^{9}$ bits/s\n\nFirst, we calculate the serialization delay, $t_{\\text{ser}}$:\n$$t_{\\text{ser}} = \\frac{8 \\times 200}{1.0 \\times 10^{9}} = \\frac{1600}{10^9} = 1.6 \\times 10^{-6} \\, \\text{s}$$\nNext, we calculate the total per-hop latency, $d_{\\text{hop}}$:\n$$d_{\\text{hop}} = (1.2 \\times 10^{-5}) + (1.0 \\times 10^{-4} - 2.0 \\times 10^{-5}) + (1.6 \\times 10^{-6})$$\n$$d_{\\text{hop}} = 1.2 \\times 10^{-5} + 8.0 \\times 10^{-5} + 0.16 \\times 10^{-5}$$\n$$d_{\\text{hop}} = (1.2 + 8.0 + 0.16) \\times 10^{-5} = 9.36 \\times 10^{-5} \\, \\text{s}$$\nAs an alternative calculation in microseconds:\n$$d_{\\text{hop}} = 12.0 \\, \\mu\\text{s} + (100.0 \\, \\mu\\text{s} - 20.0 \\, \\mu\\text{s}) + 1.6 \\, \\mu\\text{s}$$\n$$d_{\\text{hop}} = 12.0 \\, \\mu\\text{s} + 80.0 \\, \\mu\\text{s} + 1.6 \\, \\mu\\text{s} = 93.6 \\, \\mu\\text{s} = 9.36 \\times 10^{-5} \\, \\text{s}$$\n\nFinally, we calculate $N_{\\max}$:\n$$N_{\\max} = \\left\\lfloor \\frac{2.0 \\times 10^{-3}}{9.36 \\times 10^{-5}} \\right\\rfloor = \\left\\lfloor \\frac{200 \\times 10^{-5}}{9.36 \\times 10^{-5}} \\right\\rfloor = \\left\\lfloor \\frac{200}{9.36} \\right\\rfloor$$\n$$N_{\\max} = \\lfloor 21.3675... \\rfloor$$\nSince $N_{\\max}$ must be an integer representing a physical number of hops, we take the floor of this value.\n$$N_{\\max} = 21$$",
            "answer": "$$\\boxed{21}$$"
        },
        {
            "introduction": "The design of medical Cyber-Physical Systems, like an artificial pancreas, hinges on guaranteeing controller stability to ensure patient safety. This practice guides you through the stability analysis of a closed-loop glucose control system based on a linearized physiological model. You will use foundational control theory to derive the conditions for stable operation and analyze how sensitive the system is to variations in patient-specific parameters .",
            "id": "4205546",
            "problem": "A hospital-grade Artificial Pancreas Cyber-Physical System (CPS) integrates sensing, actuation, computation, and communication to manage blood glucose through closed-loop insulin delivery. Consider a digital twin-based controller designed for a patient modeled by a minimal glucose-insulin dynamics at small deviations around basal. Let $g(t)$ denote the deviation of plasma glucose concentration from basal, let $x(t)$ denote the insulin action state, and let $i(t)$ denote the deviation of plasma insulin concentration from basal. The external insulin infusion rate is the control input $u(t)$ delivered by the actuator. Meals and other exogenous inputs are modeled as bounded disturbances $d(t)$.\n\nAssume the following basal-linearized minimal model consistent with mass-balance and compartmental dynamics:\n$$\\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) + d(t),$$\n$$\\frac{dx(t)}{dt} = -p_2\\, x(t) + p_3\\, i(t),$$\n$$\\frac{di(t)}{dt} = -n\\, i(t) + u(t),$$\nwhere $S_G  0$ is the glucose effectiveness, $p_2  0$ is the insulin action decay rate, $p_3  0$ is the insulin action gain, and $n  0$ is the insulin clearance rate. The controller can access $g(t)$ through continuous glucose sensing and applies the proportional law $u(t) = -K\\, g(t)$, with $K  0$.\n\nFor infusion routes and devices with fast insulin kinetics relative to glucose and insulin action dynamics, assume a quasi-steady reduction for $i(t)$ under small-signal operation, i.e., $\\frac{di(t)}{dt} \\approx 0$ so that $i(t) \\approx \\frac{1}{n}\\, u(t)$. Under this approximation, the closed-loop dynamics reduce to the $2$-state system\n$$\\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t), \\quad \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t), \\quad u(t) = -K\\, g(t).$$\n\nTasks:\n- Starting from the given definitions and the reduction assumption, derive the closed-loop characteristic polynomial of the $2$-state system and determine the condition on $K$ that guarantees asymptotic stability of the equilibrium $g(t) = 0$, $x(t) = 0$ in the absence of disturbance $d(t)$.\n- Define the maximum stabilizing proportional gain $K_{\\text{max}}$ as the largest $K$ that maintains asymptotic stability. Using first principles of linear systems stability, express $K_{\\text{max}}$ in terms of $S_G$, $p_2$, $p_3$, and $n$.\n- Compute the normalized sensitivity of $K_{\\text{max}}$ with respect to the insulin action gain $p_3$, defined by the logarithmic sensitivity index $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$. Report the sensitivity index as a single real number. No rounding is required and no units should be included in your final answer.",
            "solution": "The problem statement is first subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\n- State variables: deviation of plasma glucose concentration $g(t)$, insulin action state $x(t)$, and deviation of plasma insulin concentration $i(t)$.\n- Control input: external insulin infusion rate $u(t)$.\n- Disturbance: bounded exogenous inputs $d(t)$.\n- Full 3-state linearized model:\n  $$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) + d(t) $$\n  $$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + p_3\\, i(t) $$\n  $$ \\frac{di(t)}{dt} = -n\\, i(t) + u(t) $$\n- Model parameters: glucose effectiveness $S_G  0$, insulin action decay rate $p_2  0$, insulin action gain $p_3  0$, insulin clearance rate $n  0$.\n- Control law: Proportional control $u(t) = -K\\, g(t)$, with gain $K  0$.\n- Model reduction assumption: Quasi-steady state for insulin dynamics, $\\frac{di(t)}{dt} \\approx 0$, which implies $i(t) \\approx \\frac{1}{n}\\, u(t)$.\n- Reduced 2-state closed-loop system dynamics (in the absence of disturbance, $d(t)=0$):\n  $$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) $$\n  $$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t) $$\n  $$ u(t) = -K\\, g(t) $$\n- Tasks:\n  1. Derive the closed-loop characteristic polynomial for the 2-state system and find the condition on $K$ for asymptotic stability.\n  2. Define and find the maximum stabilizing proportional gain, $K_{\\text{max}}$, in terms of $S_G$, $p_2$, $p_3$, and $n$.\n  3. Compute the normalized sensitivity index $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The model presented is a standard linearization of the Bergman minimal model, a cornerstone of glucose-insulin dynamics modeling. The use of a proportional controller and a quasi-steady-state assumption are common, valid techniques in control engineering for system analysis and design. The problem is well-posed; it asks for stability conditions and sensitivity analysis of a linear time-invariant (LTI) system, which are standard, formalizable tasks with unique solutions. The presentation is objective and uses precise terminology. All necessary parameters and equations are provided, and the constraints (e.g., $S_G  0$) are physically consistent. The problem is free of the specified invalidating flaws.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to analyze the stability of the provided 2-state system. First, we formulate the closed-loop system dynamics in state-space form. For the stability analysis, the disturbance is set to zero, $d(t)=0$.\n\nThe reduced system is given by:\n$$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) $$\n$$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t) $$\nSubstituting the proportional control law $u(t) = -K\\, g(t)$ into the second equation yields:\n$$ \\frac{dx(t)}{dt} = -p_2\\, x(t) - \\frac{p_3 K}{n}\\, g(t) $$\nWe can write the system in the standard state-space form $\\dot{\\mathbf{z}}(t) = A\\, \\mathbf{z}(t)$, where the state vector is $\\mathbf{z}(t) = \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix}$.\n$$ \\frac{d}{dt} \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix} = \\begin{pmatrix} -S_G  -1 \\\\ -\\frac{p_3 K}{n}  -p_2 \\end{pmatrix} \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix} $$\nThe matrix $A$ represents the closed-loop system dynamics:\n$$ A = \\begin{pmatrix} -S_G  -1 \\\\ -\\frac{p_3 K}{n}  -p_2 \\end{pmatrix} $$\n\n**Task 1: Characteristic Polynomial and Stability Condition**\n\nThe stability of this LTI system is determined by the eigenvalues of the matrix $A$, which are the roots of the characteristic polynomial $P(\\lambda) = \\det(\\lambda I - A) = 0$.\n$$ \\lambda I - A = \\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} - \\begin{pmatrix} -S_G  -1 \\\\ -\\frac{p_3 K}{n}  -p_2 \\end{pmatrix} = \\begin{pmatrix} \\lambda + S_G  1 \\\\ \\frac{p_3 K}{n}  \\lambda + p_2 \\end{pmatrix} $$\nThe characteristic polynomial is:\n$$ P(\\lambda) = \\det(\\lambda I - A) = (\\lambda + S_G)(\\lambda + p_2) - (1) \\left(\\frac{p_3 K}{n}\\right) $$\n$$ P(\\lambda) = \\lambda^2 + (S_G + p_2)\\lambda + S_G p_2 - \\frac{p_3 K}{n} $$\nFor a continuous-time system to be asymptotically stable, all roots of its characteristic polynomial must have negative real parts. For a second-order polynomial $\\lambda^2 + a_1 \\lambda + a_0 = 0$, the Routh-Hurwitz stability criterion requires all coefficients to be positive.\n1. The coefficient of a $\\lambda^2$ is $1$, which is positive.\n2. The coefficient of $\\lambda$, $a_1 = S_G + p_2$, must be positive. Given $S_G  0$ and $p_2  0$, this condition is always met.\n3. The constant term, $a_0 = S_G p_2 - \\frac{p_3 K}{n}$, must be positive.\n$$ S_G p_2 - \\frac{p_3 K}{n}  0 $$\nThis inequality provides the condition on the gain $K$. Rearranging for $K$:\n$$ S_G p_2  \\frac{p_3 K}{n} $$\n$$ K  \\frac{n S_G p_2}{p_3} $$\nSince the problem specifies $K  0$, the condition for asymptotic stability is $0  K  \\frac{n S_G p_2}{p_3}$.\n\n**Task 2: Maximum Stabilizing Gain $K_{\\text{max}}$**\n\nThe maximum stabilizing proportional gain, $K_{\\text{max}}$, is the supremum of the set of all gains $K$ for which the system is asymptotically stable. This corresponds to the stability boundary, where the constant term of the characteristic polynomial becomes zero.\nBased on the stability condition $K  \\frac{n S_G p_2}{p_3}$, the maximum value is the upper bound of this interval.\n$$ K_{\\text{max}} = \\frac{n S_G p_2}{p_3} $$\n\n**Task 3: Normalized Sensitivity of $K_{\\text{max}}$**\n\nWe are asked to compute the normalized sensitivity of $K_{\\text{max}}$ with respect to the parameter $p_3$, defined as $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$. This logarithmic derivative quantifies the percentage change in $K_{\\text{max}}$ for a percentage change in $p_3$.\n\nFirst, we express $\\ln K_{\\text{max}}$ using the expression derived in the previous task:\n$$ K_{\\text{max}} = \\frac{n S_G p_2}{p_3} $$\nTaking the natural logarithm of both sides:\n$$ \\ln K_{\\text{max}} = \\ln \\left( \\frac{n S_G p_2}{p_3} \\right) $$\nUsing the properties of logarithms:\n$$ \\ln K_{\\text{max}} = \\ln(n S_G p_2) - \\ln(p_3) $$\nThe sensitivity index is the partial derivative of $\\ln K_{\\text{max}}$ with respect to $\\ln p_3$. Let us define a variable $z = \\ln p_3$. Then we need to compute $\\frac{\\partial}{\\partial z} (\\ln K_{\\text{max}})$.\n$$ \\frac{\\partial}{\\partial (\\ln p_3)} (\\ln K_{\\text{max}}) = \\frac{\\partial}{\\partial (\\ln p_3)} (\\ln(n S_G p_2) - \\ln(p_3)) $$\nThe term $\\ln(n S_G p_2)$ is constant with respect to $p_3$, so its derivative is zero. The derivative of $\\ln(p_3)$ with respect to $\\ln(p_3)$ is, by definition, $1$.\n$$ S_{p_3}(K_{\\text{max}}) = 0 - 1 = -1 $$\nThe sensitivity index is a constant value of $-1$. This indicates that a $1\\%$ increase in the insulin action gain $p_3$ leads to a $1\\%$ decrease in the maximum stabilizing control gain $K_{\\text{max}}$. This inverse relationship is expected, as a higher $p_3$ implies a stronger effect of insulin on glucose, thus requiring a smaller controller gain to avoid over-correction and instability.\nThe final result is a dimensionless real number.",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "The integrity of modern CPS, such as the smart grid, is threatened by cyber-attacks that can manipulate sensor data. This practice provides hands-on experience with designing a secure state estimator capable of withstanding False Data Injection (FDI) attacks. By applying Maximum A Posteriori (MAP) estimation with a sparsity-promoting prior, you will derive an algorithm that can simultaneously estimate the true system state while identifying and rejecting malicious data inputs .",
            "id": "4205524",
            "problem": "A Cyber-Physical System (CPS) for wide-area monitoring and control in a smart grid (e.g., Supervisory Control and Data Acquisition (SCADA) state estimation) uses a linearized measurement model with potential False Data Injection (FDI). The measurement vector is modeled as $\\mathbf{y} \\in \\mathbb{R}^{m}$, the unknown state as $\\mathbf{x}^{\\star} \\in \\mathbb{R}^{n}$, the known measurement matrix as $\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$ with full column rank, an adversarial attack vector as $\\mathbf{a} \\in \\mathbb{R}^{m}$ that is sparse in the canonical basis, and zero-mean Gaussian sensor noise $\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I}_{m})$. The model is $\\mathbf{y}=\\mathbf{H}\\mathbf{x}^{\\star}+\\mathbf{a}+\\mathbf{w}$. Assume independence of noise components. The objective is to derive a secure state estimation method and a detection threshold from first principles using only the following fundamental bases: (i) the Gaussian likelihood for additive white noise, (ii) a Laplace prior for sparsity in the attack vector (independent and identically distributed coordinates), and (iii) standard properties of convex optimization and probability inequalities.\n\nTasks:\n1. Using Maximum A Posteriori (MAP) estimation with a Laplace prior of the form $p(\\mathbf{a}) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right)$, and treating $\\mathbf{x}^{\\star}$ as an unknown deterministic parameter with a noninformative prior, derive explicitly the optimization program in unknowns $\\mathbf{x},\\mathbf{a}$ that the joint MAP estimator solves.\n2. Under the additional structural assumption $\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$, derive the closed-form minimizer in $\\mathbf{a}$ for fixed $\\mathbf{x}$, and the closed-form minimizer in $\\mathbf{x}$ for fixed $\\mathbf{a}$. Clearly identify any thresholding or projection operations that arise and their parameters in terms of $\\beta$ and $\\sigma$.\n3. Consider a residual-based detector that, after estimating $\\widehat{\\mathbf{x}}$ and $\\widehat{\\mathbf{a}}$, raises an alarm if any coordinate of the innovation $\\mathbf{r}:=\\mathbf{y}-\\mathbf{H}\\widehat{\\mathbf{x}}$ exceeds a threshold in magnitude. Under the no-attack hypothesis $\\mathbf{a}=\\mathbf{0}$ and ideal modeling (so that $\\mathbf{r}$ is dominated by sensor noise), derive from first principles a conservative family-wise false-alarm threshold $\\tau$ that guarantees $\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$, using only the independence of $w_{i}$ and a standard exponential tail bound for Gaussian random variables. Express $\\tau$ in closed form in terms of $\\sigma,$ $m,$ and $\\alpha$.\n4. For $m=50,$ $\\sigma=0.2,$ and $\\alpha=0.01,$ compute the numerical value of the detection threshold $\\tau$ obtained in Task $3$.\n\nProvide the numerical value of $\\tau$ as your final answer. Round your answer to four significant figures. Express the final threshold as a unitless quantity.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Measurement model: $$\\mathbf{y}=\\mathbf{H}\\mathbf{x}^{\\star}+\\mathbf{a}+\\mathbf{w}$$\n- Measurement vector: $$\\mathbf{y} \\in \\mathbb{R}^{m}$$\n- Unknown state: $$\\mathbf{x}^{\\star} \\in \\mathbb{R}^{n}$$\n- Measurement matrix: $$\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$$ with full column rank.\n- Adversarial attack vector: $$\\mathbf{a} \\in \\mathbb{R}^{m}$$, sparse in the canonical basis.\n- Sensor noise: $$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I}_{m})$$, with independent components $$w_i$$.\n- Prior for $$\\mathbf{a}$$: $$p(\\mathbf{a}) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right)$$\n- Prior for $$\\mathbf{x}^{\\star}$$: Noninformative (uniform).\n- Additional assumption for Task 2: $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$\n- Detector property for Task 3: Raises an alarm if $$\\max_{1\\leq i\\leq m}|r_{i}|  \\tau$$, where $$\\mathbf{r}:=\\mathbf{y}-\\mathbf{H}\\widehat{\\mathbf{x}}$$.\n- Condition for threshold derivation in Task 3: Under the no-attack hypothesis $$\\mathbf{a}=\\mathbf{0}$$, find $$\\tau$$ to guarantee $$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$$.\n- Numerical values for Task 4: $$m=50$$, $$\\sigma=0.2$$, $$\\alpha=0.01$$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard robust estimation problem in signal processing and control systems (specifically, state estimation in the presence of sparse attacks). The methodology proposed (MAP estimation with a Laplace prior) is a well-established technique that leads to $$\\ell_1$$-norm regularization (Lasso). The tasks are well-posed, each building logically upon the previous one. The assumptions, such as $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$ for Task $2$, are standard simplifying assumptions in theoretical analyses. The derivation requested in Task $3$ relies on fundamental probability tools (union bound, Gaussian tail bounds) and is a standard approach for setting detection thresholds while controlling for false alarms. The problem is stated objectively with all necessary data.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution is provided below.\n\n### Task 1: Derivation of the MAP Optimization Program\nThe goal is to find the Maximum A Posteriori (MAP) estimate of the unknown parameters $$\\mathbf{x}$$ and $$\\mathbf{a}$$ given the measurement $$\\mathbf{y}$$. The posterior probability density function is given by Bayes' theorem:\n$$p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) \\propto p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a}) p(\\mathbf{x}, \\mathbf{a})$$\nThe prior distributions for $$\\mathbf{x}$$ and $$\\mathbf{a}$$ are assumed to be independent, so $$p(\\mathbf{x}, \\mathbf{a}) = p(\\mathbf{x})p(\\mathbf{a})$$. We are given that $$\\mathbf{x}$$ has a noninformative (uniform) prior, meaning $$p(\\mathbf{x})$$ is a constant. The prior for $$\\mathbf{a}$$ is a Laplace distribution:\n$$p(\\mathbf{a}) \\propto \\exp\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right) = \\exp(-\\beta \\|\\mathbf{a}\\|_{1})$$\nThe likelihood function $$p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a})$$ is determined by the noise model. From the system model, the noise vector is $$\\mathbf{w} = \\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}$$. Since $$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2\\mathbf{I}_m)$$, its probability density function is:\n$$p(\\mathbf{w}) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{\\|\\mathbf{w}\\|_{2}^2}{2\\sigma^2}\\right)$$\nSubstituting $$\\mathbf{w}$$, the likelihood is:\n$$p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a}) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2}{2\\sigma^2}\\right)$$\nCombining the likelihood and the priors, the posterior is:\n$$p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) \\propto \\exp\\left(-\\frac{\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2}{2\\sigma^2}\\right) \\exp(-\\beta \\|\\mathbf{a}\\|_{1})$$\nMaximizing the posterior probability is equivalent to minimizing its negative logarithm:\n$$\\hat{\\mathbf{x}}, \\hat{\\mathbf{a}} = \\arg\\max_{\\mathbf{x}, \\mathbf{a}} p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) = \\arg\\min_{\\mathbf{x}, \\mathbf{a}} \\left[ -\\ln(p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y})) \\right]$$\nThe negative log-posterior is:\n$$-\\ln(p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y})) = C + \\frac{1}{2\\sigma^2}\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\beta\\|\\mathbf{a}\\|_{1}$$\nwhere $$C$$ is a constant that does not depend on $$\\mathbf{x}$$ or $$\\mathbf{a}$$. The MAP estimation problem is therefore to solve the following optimization program:\n$$\\min_{\\mathbf{x}, \\mathbf{a}} \\left\\{ \\frac{1}{2\\sigma^2}\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\beta\\|\\mathbf{a}\\|_{1} \\right\\}$$\nThis can be rewritten by multiplying the objective function by the positive constant $$2\\sigma^2$$, which does not change the location of the minimum:\n$$\\min_{\\mathbf{x} \\in \\mathbb{R}^n, \\mathbf{a} \\in \\mathbb{R}^m} \\left\\{ \\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + 2\\sigma^2\\beta\\|\\mathbf{a}\\|_{1} \\right\\}$$\n\n### Task 2: Derivation of Closed-Form Minimizers\nUnder the additional assumption $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$, we can derive closed-form solutions for $$\\mathbf{x}$$ and $$\\mathbf{a}$$ by alternating minimization.\nThe objective function is $$J(\\mathbf{x}, \\mathbf{a}) = \\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\lambda\\|\\mathbf{a}\\|_{1}$$, where $$\\lambda = 2\\sigma^2\\beta$$.\n\n**Minimization with respect to $$\\mathbf{x}$$ for a fixed $$\\mathbf{a}$**:\nWe fix $$\\mathbf{a}$$ and solve for $$\\mathbf{x}$$. The problem reduces to a standard linear least-squares problem:\n$$\\min_{\\mathbf{x}} \\|\\mathbf{z} - \\mathbf{H}\\mathbf{x}\\|_{2}^2 \\quad \\text{where } \\mathbf{z} = \\mathbf{y} - \\mathbf{a}$$\nTo find the minimizer, we set the gradient with respect to $$\\mathbf{x}$$ to zero:\n$$\\nabla_{\\mathbf{x}} J(\\mathbf{x}, \\mathbf{a}) = \\nabla_{\\mathbf{x}} \\left( (\\mathbf{z} - \\mathbf{H}\\mathbf{x})^{\\top}(\\mathbf{z} - \\mathbf{H}\\mathbf{x}) \\right) = -2\\mathbf{H}^{\\top}(\\mathbf{z} - \\mathbf{H}\\mathbf{x}) = \\mathbf{0}$$\n$$\\mathbf{H}^{\\top}\\mathbf{H}\\mathbf{x} = \\mathbf{H}^{\\top}\\mathbf{z}$$\nUsing the assumption $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$, the solution for $$\\mathbf{x}$$ is:\n$$\\widehat{\\mathbf{x}} = \\mathbf{H}^{\\top}\\mathbf{z} = \\mathbf{H}^{\\top}(\\mathbf{y} - \\mathbf{a})$$\nThis operation represents the projection of the vector $$\\mathbf{y}-\\mathbf{a}$$ onto the subspace spanned by the orthonormal columns of $$\\mathbf{H}$$.\n\n**Minimization with respect to $$\\mathbf{a}$$ for a fixed $$\\mathbf{x}$**:\nWe fix $$\\mathbf{x}$$ and solve for $$\\mathbf{a}$$. The problem becomes:\n$$\\min_{\\mathbf{a}} \\|\\mathbf{r} - \\mathbf{a}\\|_{2}^2 + \\lambda\\|\\mathbf{a}\\|_{1} \\quad \\text{where } \\mathbf{r} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}$$\nThis problem is separable, meaning it can be solved independently for each component $$a_i$$:\n$$\\sum_{i=1}^{m} \\min_{a_i} \\left\\{ (r_i - a_i)^2 + \\lambda|a_i| \\right\\}$$\nWe solve the scalar problem $$ \\min_{u} (v - u)^2 + \\lambda|u| $$. The solution is given by the soft-thresholding operator, $$S_{\\lambda/2}(v)$$. We derive this from first principles using subgradient calculus. The subgradient of the objective with respect to $$u$$ is:\n$$\\partial_{u} \\left( (v-u)^2 + \\lambda|u| \\right) = -2(v-u) + \\lambda \\cdot \\partial|u|$$\nwhere $$\\partial|u| = \\text{sgn}(u)$$ if $$u \\neq 0$$ and $$\\partial|u| \\in [-1, 1]$$ if $$u=0$$.\nSetting the subgradient to contain zero: $$2(u-v) + \\lambda s = 0$$ for some $$s \\in \\partial|u|$$.\n- If $$u  0$$, $$s=1$$: $$2(u-v)+\\lambda=0 \\implies u = v - \\lambda/2$$. This is valid if $$v - \\lambda/2  0$$, i.e., $$v  \\lambda/2$$.\n- If $$u  0$$, $$s=-1$$: $$2(u-v)-\\lambda=0 \\implies u = v + \\lambda/2$$. This is valid if $$v + \\lambda/2  0$$, i.e., $$v  -\\lambda/2$$.\n- If $$u = 0$$, $$s\\in[-1, 1]$$: $$-2v + \\lambda s = 0 \\implies 2v = \\lambda s$$. This implies $$|2v| \\le \\lambda$$, or $$|v| \\le \\lambda/2$$.\nCombining these cases gives the soft-thresholding function:\n$$u = S_{\\lambda/2}(v) = \\text{sgn}(v) \\max(|v| - \\lambda/2, 0)$$\nApplying this to our vector problem, the minimizer $$\\widehat{\\mathbf{a}}$$ is:\n$$\\widehat{\\mathbf{a}} = S_{\\lambda/2}(\\mathbf{y} - \\mathbf{H}\\mathbf{x})$$\nThe thresholding parameter is $$\\lambda/2 = (2\\sigma^2\\beta)/2 = \\sigma^2\\beta$$.\nSo, the minimizer is $$\\widehat{\\mathbf{a}} = S_{\\sigma^2\\beta}(\\mathbf{y} - \\mathbf{H}\\mathbf{x})$$, which is a soft-thresholding operation with a threshold of $$\\sigma^2\\beta$$.\n\n### Task 3: Derivation of the Detection Threshold $$\\tau$$\nThe objective is to find a threshold $$\\tau$$ that guarantees a family-wise false-alarm rate of at most $$\\alpha$$. This is stated as finding $$\\tau$$ such that $$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$$. The noise components $$w_i$$ are independent and identically distributed as $$\\mathcal{N}(0, \\sigma^2)$$.\nLet $$E_i$$ be the event $$|w_i|  \\tau$$. We are interested in the probability of the union of these events, $$\\mathbb{P}(\\cup_{i=1}^m E_i)$$.\nUsing the union bound (Boole's inequality), we can write:\n$$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right) = \\mathbb{P}(\\cup_{i=1}^m E_i) \\leq \\sum_{i=1}^m \\mathbb{P}(E_i)$$\nSince the $$w_i$$ are identically distributed, $$\\mathbb{P}(E_i) = \\mathbb{P}(|w_1|  \\tau)$$ for all $$i$$. Thus:\n$$\\sum_{i=1}^m \\mathbb{P}(E_i) = m \\cdot \\mathbb{P}(|w_1|  \\tau)$$\nTo satisfy the overall constraint, we require $$m \\cdot \\mathbb{P}(|w_1|  \\tau) \\le \\alpha$$, which simplifies to:\n$$\\mathbb{P}(|w_1|  \\tau) \\le \\frac{\\alpha}{m}$$\nThe probability $$\\mathbb{P}(|w_1|  \\tau) = \\mathbb{P}(w_1  \\tau) + \\mathbb{P}(w_1  -\\tau)$$. By the symmetry of the zero-mean Gaussian distribution, $$\\mathbb{P}(w_1  -\\tau) = \\mathbb{P}(w_1  \\tau)$$.\nSo, $$2 \\cdot \\mathbb{P}(w_1  \\tau) \\le \\frac{\\alpha}{m} \\implies \\mathbb{P}(w_1  \\tau) \\le \\frac{\\alpha}{2m}$$\nWe now use a standard exponential tail bound for a Gaussian random variable $$X \\sim \\mathcal{N}(0, \\sigma_X^2)$$, which is $$\\mathbb{P}(X  t) \\le \\exp(-t^2 / (2\\sigma_X^2))$$ for $$t0$$. For $$w_1 \\sim \\mathcal{N}(0, \\sigma^2)$$, this becomes:\n$$\\mathbb{P}(w_1  \\tau) \\le \\exp\\left(-\\frac{\\tau^2}{2\\sigma^2}\\right)$$\nTo satisfy the inequality $$\\mathbb{P}(w_1  \\tau) \\le \\alpha/(2m)$$, we can set the bound equal to the desired upper limit:\n$$\\exp\\left(-\\frac{\\tau^2}{2\\sigma^2}\\right) = \\frac{\\alpha}{2m}$$\nSolving for $$\\tau$$:\n$$-\\frac{\\tau^2}{2\\sigma^2} = \\ln\\left(\\frac{\\alpha}{2m}\\right)$$\n$$\\frac{\\tau^2}{2\\sigma^2} = -\\ln\\left(\\frac{\\alpha}{2m}\\right) = \\ln\\left(\\left(\\frac{\\alpha}{2m}\\right)^{-1}\\right) = \\ln\\left(\\frac{2m}{\\alpha}\\right)$$\n$$\\tau^2 = 2\\sigma^2 \\ln\\left(\\frac{2m}{\\alpha}\\right)$$\n$$\\tau = \\sqrt{2\\sigma^2 \\ln\\left(\\frac{2m}{\\alpha}\\right)} = \\sigma \\sqrt{2 \\ln\\left(\\frac{2m}{\\alpha}\\right)}$$\nThis provides a closed-form expression for the conservative threshold $$\\tau$$ in terms of $$\\sigma$$, $$m$$, and $$\\alpha$$.\n\n### Task 4: Numerical Computation of $$\\tau$$\nGiven the values $$m=50$$, $$\\sigma=0.2$$, and $$\\alpha=0.01$$, we compute $$\\tau$$ using the derived formula:\n$$\\tau = \\sigma \\sqrt{2 \\ln\\left(\\frac{2m}{\\alpha}\\right)}$$\nFirst, calculate the term inside the logarithm:\n$$\\frac{2m}{\\alpha} = \\frac{2 \\times 50}{0.01} = \\frac{100}{0.01} = 10000$$\nNow, substitute this into the formula for $$\\tau$$:\n$$\\tau = 0.2 \\sqrt{2 \\ln(10000)}$$\nUsing the natural logarithm:\n$$\\ln(10000) \\approx 9.21034037$$\n$$2 \\ln(10000) \\approx 18.42068074$$\n$$\\sqrt{2 \\ln(10000)} \\approx \\sqrt{18.42068074} \\approx 4.29193182$$\nFinally, multiply by $$\\sigma$$:\n$$\\tau = 0.2 \\times 4.29193182 \\approx 0.85838636$$\nRounding the result to four significant figures gives:\n$$\\tau \\approx 0.8584$$",
            "answer": "$$\\boxed{0.8584}$$"
        }
    ]
}