{
    "hands_on_practices": [
        {
            "introduction": "数字孪生的构建始于精确地将物理世界的连续信号转化为数字世界的离散数据。本练习探讨了奈奎斯特-香农采样定理，这是确保此转换过程保真度的基石。通过理解和应用该定理，我们可以确定保证无信息损失所需的最小采样频率，这是构建任何高保真数字孪生的关键第一步 。",
            "id": "4213713",
            "problem": "一个来自信息物理系统 (CPS) 的连续时间传感器信号被流式传输到数字孪生 (DT) 的数据采集层。该信号测得的单边功率谱密度在 $120\\,\\mathrm{Hz}$ 以上可以忽略不计，且系统相关方报告称，具有物理意义的动态其主要频率成分最高可达 $120\\,\\mathrm{Hz}$。数字孪生 (DT) 要求采样数据在奈奎斯特-香农采样定理 (NSST) 的假设下足以实现完美重构，并且在采样前放置一个抗混叠模拟滤波器来实际抑制混叠现象。\n\n从奈奎斯特-香农采样定理的陈述和离散时间采样中混叠的定义出发，根据第一性原理推导，确定能保证对一个最高非零频率分量为 $120\\,\\mathrm{Hz}$ 的严格带限信号进行完美重构的最小采样频率。\n\n然后，讨论在 CPS 到 DT 的数据采集管道中，抗混叠滤波器必须满足哪些定性要求，才能使带限假设在实践中成立。根据采样频率和信号的主要内容，阐述通带和阻带的规格，并解释过渡带与可实现的带外能量抑制能力之间的关系。\n\n以赫兹 ($\\mathrm{Hz}$) 为单位，用数值表示最终的采样频率。无需四舍五入，报告精确值。",
            "solution": "该问题要求基于奈奎斯特-香农采样定理 (NSST) 确定一个带限信号的最小采样频率，然后定性讨论抗混叠滤波器的实际要求。\n\n首先，我们从第一性原理出发，确定最小采样频率。\n\n奈奎斯特-香农采样定理确立了从一个连续时间信号的均匀间隔采样序列中完美重构该信号的基本条件。设 $x(t)$ 为一个连续时间信号，其傅里叶变换为 $X(f)$。如果信号 $x(t)$ 的傅里叶变换 $X(f)$ 对于所有频率 $|f|  f_{\\text{max}}$ 都为零，则称该信号是带限于最大频率 $f_{\\text{max}}$ 的。\n$$X(f) = 0 \\quad \\text{for} \\quad |f|  f_{\\text{max}}$$\n以频率 $f_s$ 和采样周期 $T_s = 1/f_s$ 对信号 $x(t)$ 进行采样，会产生一个离散时间序列 $x[n] = x(nT_s)$。理想采样过程可以建模为将连续时间信号与一个脉冲序列相乘。采样后信号的傅里叶变换，记为 $X_s(f)$，是原始信号频谱的周期性求和：\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} X(f - kf_s)$$\n该方程表明，采样后信号的频谱由原始频谱 $X(f)$ 的副本组成，这些副本按 $f_s$ 比例缩放，并平移至以采样频率的整数倍 $kf_s$ 为中心的位置。\n\n当这些频谱副本发生重叠时，就会出现混叠。如果原始信号带限于 $f_{\\text{max}}$，则中心副本（对应 $k=0$）占据频带 $[-f_{\\text{max}}, f_{\\text{max}}]$。相邻的副本（对应 $k = \\pm 1$）以 $\\pm f_s$ 为中心，占据频带 $[f_s - f_{\\text{max}}, f_s + f_{\\text{max}}]$ 和 $[-f_s - f_{\\text{max}}, -f_s + f_{\\text{max}}]$。为使副本不重叠，中心副本的上边缘 ($f_{\\text{max}}$) 必须不超过第一个正频率副本的下边缘 ($f_s - f_{\\text{max}}$)。这导出了以下条件：\n$$f_{\\text{max}} \\le f_s - f_{\\text{max}}$$\n整理这个不等式，得到奈奎斯特准则：\n$$f_s \\ge 2f_{\\text{max}}$$\n如果满足此条件，通过将采样信号通过一个截止频率介于 $f_{\\text{max}}$ 和 $f_s - f_{\\text{max}}$ 之间的理想低通滤波器，就可以从其样本中完美重构原始信号。频率 $2f_{\\text{max}}$ 被称为奈奎斯特率。采样频率 $f_s$ 必须至少为奈奎斯特率。因此，保证完美重构的最小采样频率 $f_{s, \\text{min}}$ 正是奈奎斯特率。\n\n问题陈述该信号是严格带限的，其最高非零频率分量为 $f_{\\text{max}} = 120\\,\\mathrm{Hz}$。应用奈奎斯特准则，最小采样频率为：\n$$f_{s, \\text{min}} = 2 \\times f_{\\text{max}} = 2 \\times 120\\,\\mathrm{Hz} = 240\\,\\mathrm{Hz}$$\n\n接下来，我们讨论抗混叠滤波器的定性要求。\n\n“严格带限”信号的前提是一个数学上的理想化。现实世界中的信号，例如来自信息物理系统传感器的信号，通常不是严格带限的。问题文本承认了这一点，指出信号的功率谱密度在 $120\\,\\mathrm{Hz}$ 以上是“可以忽略的”。抗混叠滤波器是一种模拟低通滤波器，需要在模数转换器（采样器）之前放置，以在实践中强制满足带限条件。其功能是将高于某个截止频率的频率分量衰减到一个水平，使得它们在采样时不会引起显著的混叠。\n\n该滤波器的规格由其在三个区域的行为定义：通带、阻带和过渡带。\n\n$1$. **通带** (Passband)：这是滤波器必须以最小失真通过的频率范围。对于本问题，具有物理意义的动态其内容最高可达 $120\\,\\mathrm{Hz}$。因此，滤波器的通带必须延伸到此频率。通带边缘频率 $f_p$ 应设置在或略高于感兴趣的最高频率，即 $f_p \\ge 120\\,\\mathrm{Hz}$。在此频带 $[0, f_p]$ 内，滤波器理想情况下应具有平坦的幅度响应（例如，增益接近 $1$）和线性相位响应（恒定的群延迟），以避免信号失真。\n\n$2$. **阻带** (Stopband)：这是滤波器必须显著衰减的频率范围。混叠会将高于奈奎斯特频率 $f_s/2$ 的频率折叠回基带 $[0, f_s/2]$。因此，为防止混叠，滤波器的阻带必须在奈奎斯特频率或之前开始。阻带边缘频率记为 $f_{\\text{stop}}$。阻带内的衰减（例如，以分贝 dB 为单位测量）必须足以将任何带外噪声和干扰抑制到系统的本底噪声或量化误差以下。\n\n$3$. **过渡带** (Transition Band)：物理滤波器无法从通带瞬时过渡到阻带。这个从 $f_p$ 到 $f_{\\text{stop}}$ 的有限宽度区域就是过渡带。滤波器在此频带内响应的陡峭程度称为其“滚降”特性。\n\n这些参数与采样频率之间的关系至关重要。如果我们以理论最小值 $f_s = 240\\,\\mathrm{Hz}$ 进行采样，奈奎斯特频率将为 $f_s/2 = 120\\,\\mathrm{Hz}$。在这种情况下，通带必须延伸到 $f_{\\text{max}} = 120\\,\\mathrm{Hz}$，而阻带必须从 $f_s/2 = 120\\,\\mathrm{Hz}$ 开始。这意味着 $f_p = f_{\\text{stop}} = 120\\,\\mathrm{Hz}$，这对应于一个零宽度的过渡带。这种滤波器是“砖墙”滤波器，物理上是无法实现的。\n\n为了适应具有非零过渡带的现实世界滤波器，采样频率必须选择为大于奈奎斯特率 ($f_s  2f_{\\text{max}}$)。这种技术称为过采样，它在频域中感兴趣的最高频率 $f_{\\text{max}}$ 和奈奎斯特频率 $f_s/2$ 之间创建了一个“保护带”。此保护带的宽度为 $(f_s/2) - f_{\\text{max}}$。\n现在可以设计滤波器，使其通带边缘位于 $f_p \\approx f_{\\text{max}}~(=120\\,\\mathrm{Hz})$，阻带边缘位于 $f_{\\text{stop}} \\le f_s/2$。宽度为 $f_{\\text{stop}} - f_p$ 的过渡带现在完全位于保护带内。\n\n可实现的带外能量抑制能力取决于滤波器的阶数及其滚降特性。更陡峭的滚降（与更高阶的滤波器相关）允许更窄的过渡带。这意味着，在给定的阻带衰减水平下，更陡峭的滤波器允许采样频率 $f_s$ 更接近理论最小值 $2f_{\\text{max}}$。反之，使用更高的采样频率（更宽的保护带）会放宽对滤波器滚降的要求，从而可能允许使用更简单、阶数更低的滤波器来实现对混叠分量的必要抑制。",
            "answer": "$$\\boxed{240}$$"
        },
        {
            "introduction": "为了实现实时预测与控制，数字孪生通常需要依赖计算高效的降阶模型（ROM）而非完整的高保真仿真。本练习介绍了本征正交分解（POD），一种从系统快照数据中提取最优低维基的强大技术。通过将该方法与奇异值分解（SVD）联系起来，我们能够动手实践如何构建一个在保真度和计算成本之间达到理想平衡的代理模型 。",
            "id": "4213771",
            "problem": "一个信息物理系统数字孪生被构建为一个高维状态的降阶代理模型，该状态在感知和驱动下演化。考虑一个快照矩阵 $X \\in \\mathbb{R}^{m \\times n}$，其列收集了 $\\mathbb{R}^{m}$ 中的 $n$ 个零均值状态快照。本征正交分解 (Proper Orthogonal Decomposition, POD) 寻求一个标准正交降阶基，该基在最大化捕获快照变化的同时最小化最小二乘重构误差，这与数字孪生分类法中预测性孪生需维持一个由数据中捕获能量度量的特定保真度阈值的要求相一致。与一组快照相关的能量可以定义为数据的平方范数，而到降阶标准正交基上的投影量化了降阶表示捕获了多少能量。从标准正交投影和最小二乘最优性的定义出发，推导 POD 降阶基如何从 $X$ 的奇异值分解 (Singular Value Decomposition, SVD) 中产生，并用 $X$ 的奇异值表示秩为 $r$ 的 POD 模型所捕获的能量。然后，对于特定的数字孪生校准数据集\n$$\nX \\;=\\; \\begin{pmatrix}\n5  0  0 \\\\\n0  3  0 \\\\\n0  0  1\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3},\n$$\n确定最小秩 $r \\in \\{1,2,3\\}$，使得 POD 模型捕获的能量分数至少为 $\\alpha = 0.95$。将您的最终答案表示为 $r$ 的整数值。无需四舍五入，不涉及物理单位。",
            "solution": "我们从支撑本征正交分解 (POD) 和标准正交投影的基本定义开始。设 $X \\in \\mathbb{R}^{m \\times n}$ 按列收集了 $n$ 个零均值快照。一个秩为 $r$ 的 POD 寻求一个标准正交基 $U \\in \\mathbb{R}^{m \\times r}$（满足 $U^{\\top}U = I_{r}$），该基在标准正交投影下最大化捕获的快照能量，同时最小化数据的最小二乘重构误差。$X$ 到 $U$ 的列空间上的标准正交投影是 $U U^{\\top} X$，以 Frobenius 范数表示的最小二乘重构误差为\n$$\n\\|X - U U^{\\top} X\\|_{F}^{2}.\n$$\n等价地，捕获的能量为\n$$\n\\|U^{\\top} X\\|_{F}^{2} \\;=\\; \\operatorname{trace}\\!\\left( (U^{\\top} X)(U^{\\top} X)^{\\top} \\right) \\;=\\; \\operatorname{trace}\\!\\left( U^{\\top} X X^{\\top} U \\right),\n$$\n因为 $U^{\\top}U = I_{r}$ 且 Frobenius 范数在正交变换下是不变的。快照中的总能量是\n$$\n\\|X\\|_{F}^{2} \\;=\\; \\operatorname{trace}\\!\\left( X X^{\\top} \\right).\n$$\n因此，在所有满足 $U^{\\top}U = I_{r}$ 的 $U$ 上最大化 $\\|U^{\\top} X\\|_{F}^{2}$ 是一个 Rayleigh–Ritz 优化问题。根据 Courant–Fischer 最小-最大原理，最大化器 $U$ 由 $X X^{\\top}$ 的 $r$ 个主特征向量给出。如果我们将 $X$ 的奇异值分解 (SVD) 写为\n$$\nX \\;=\\; W \\Sigma V^{\\top},\n$$\n其中 $W \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角（矩形）矩阵，对角线上为非负奇异值 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\cdots \\ge 0$，则\n$$\nX X^{\\top} \\;=\\; W \\Sigma \\Sigma^{\\top} W^{\\top}.\n$$\n$X X^{\\top}$ 的特征值是 $\\sigma_{i}^{2}$，对应的特征向量是左奇异向量（$W$ 的列）。因此，秩为 $r$ 的最优 POD 基由前 $r$ 个左奇异向量给出，\n$$\nU_{r} \\;=\\; W_{[:,1:r]},\n$$\n秩为 $r$ 的 POD 模型捕获的能量为\n$$\n\\|U_{r}^{\\top} X\\|_{F}^{2} \\;=\\; \\sum_{i=1}^{r} \\sigma_{i}^{2}.\n$$\n最小二乘最优性源于最大化捕获能量与最小化重构误差之间的等价性，并由 Eckart–Young–Mirsky 定理经典地形式化：在所有秩为 $r$ 的近似中，$W_{[:,1:r]} \\Sigma_{[1:r,1:r]} V_{[:,1:r]}^{\\top}$ 最小化了 $\\|X - \\cdot \\|_{F}$，其误差为 $\\sum_{i=r+1}^{\\rho} \\sigma_{i}^{2}$，其中 $\\rho$ 是 $X$ 的秩。\n\n因此，秩为 $r$ 时捕获的能量分数为\n$$\n\\eta(r) \\;=\\; \\frac{\\sum_{i=1}^{r} \\sigma_{i}^{2}}{\\sum_{i=1}^{\\rho} \\sigma_{i}^{2}},\n$$\n满足保真度阈值 $\\alpha$ 的最小秩为\n$$\nr^{\\star} \\;=\\; \\min \\left\\{ r \\in \\{1,2,\\dots,\\rho\\} \\;:\\; \\eta(r) \\ge \\alpha \\right\\}.\n$$\n\n现在将此应用于给定的快照矩阵\n$$\nX \\;=\\; \\begin{pmatrix}\n5  0  0 \\\\\n0  3  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n这个矩阵 $X$ 已经是具有非负项的对角矩阵，所以其奇异值就是对角线上的元素：\n$$\n\\sigma_{1} \\;=\\; 5,\\quad \\sigma_{2} \\;=\\; 3,\\quad \\sigma_{3} \\;=\\; 1.\n$$\n总能量为\n$$\n\\sum_{i=1}^{3} \\sigma_{i}^{2} \\;=\\; 5^{2} + 3^{2} + 1^{2} \\;=\\; 25 + 9 + 1 \\;=\\; 35.\n$$\n计算随秩增加的累积捕获能量：\n- 对于 $r = 1$：$\\sum_{i=1}^{1} \\sigma_{i}^{2} = 25$，所以 $\\eta(1) = \\frac{25}{35} = \\frac{5}{7} \\approx 0.7142857$。\n- 对于 $r = 2$：$\\sum_{i=1}^{2} \\sigma_{i}^{2} = 25 + 9 = 34$，所以 $\\eta(2) = \\frac{34}{35} \\approx 0.9714286$。\n- 对于 $r = 3$：$\\sum_{i=1}^{3} \\sigma_{i}^{2} = 35$，所以 $\\eta(3) = 1$。\n\n给定阈值 $\\alpha = 0.95$，满足 $\\eta(r) \\ge 0.95$ 的最小秩为\n$$\nr^{\\star} \\;=\\; 2,\n$$\n因为 $\\eta(1) \\approx 0.7142857  0.95$ 且 $\\eta(2) \\approx 0.9714286 \\ge 0.95$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "数字孪生的一个核心功能是实时、准确地追踪其物理对应物的状态，即便测量数据受到噪声干扰。本练习深入探讨了卡尔曼滤波器，这是一种用于动态系统状态估计的基础性算法。通过从第一性原理推导并应用该滤波器，您将掌握数字孪生如何融合模型预测与带噪声的传感器数据，从而实现物理资产与虚拟模型之间的持续同步 。",
            "id": "4213735",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 使用概率状态估计来将其虚拟状态与物理资产同步。考虑一个具有高斯过程模型和采样测量的连续时间线性时不变 (LTI) 随机系统：\n$$\\dot{x}(t) = A x(t) + B u(t) + w(t), \\quad y_{k} = C x(t_{k}) + v_{k},$$\n其中 $x(t) \\in \\mathbb{R}^{n}$ 是物理状态， $u(t) \\in \\mathbb{R}^{m}$ 是已知输入， $y_{k} \\in \\mathbb{R}^{p}$ 是在采样时刻 $t_{k} = k \\Delta$ 的测量值， $w(t)$ 是谱密度（协方差率）为 $Q \\succeq 0$ 的零均值高斯白过程噪声，而 $v_{k}$ 是协方差为 $R \\succ 0$ 的零均值独立同分布高斯测量噪声。假设 $x(0)$ 是高斯分布的，且独立于 $w(t)$ 和 $v_{k}$。数字孪生的估计器必须从第一性原理（线性高斯建模、连续时间动力学的离散化和贝叶斯条件化）推导出来。\n\n任务1：使用线性系统离散化和高斯推断的基本法则，推导由数字孪生在采样间隔 $\\Delta$ 实现的离散时间卡尔曼滤波器 (KF) 递归。明确地用从连续时间模型获得的 $A_{\\Delta}$、$B_{\\Delta}$ 和 $Q_{\\Delta}$ 表示时间更新和测量更新方程。您的推导必须从连续时间随机模型开始，生成离散时间等价模型 $x_{k+1} = A_{\\Delta} x_{k} + B_{\\Delta} u_{k} + w_{k}$，$y_{k} = C x_{k} + v_{k}$，并使用科学上标准的积分和算子，根据 $A$、$B$、$Q$ 和 $\\Delta$ 表达 $A_{\\Delta}$、$B_{\\Delta}$ 和 $Q_{\\Delta}$。然后基于高斯条件化，推导 $(\\hat{x}_{k+1|k}, P_{k+1|k})$ 的卡尔曼时间更新，以及 $(\\hat{x}_{k+1|k+1}, P_{k+1|k+1})$ 和增益 $K_{k+1}$ 的测量更新，过程中不得引用任何未经证明的简化公式。\n\n任务2：将您推导的递归特化为一个标量数字孪生估计器，用于一个单输入单输出 CPS，其参数为 $A = -1$, $B = 0$, $C = 1$, $Q = 2$, $R = 1$，采样间隔 $\\Delta = 0.5$，所有 $k$ 的输入均为零 $u_{k} = 0$，初始后验协方差为 $P_{0|0} = 3$。计算经过两次完整测量更新后的后验协方差 $P_{2|2}$。将最终数值答案四舍五入到四位有效数字。您的答案应表示为无单位量。",
            "solution": "所提出的问题在科学上是合理的、良态的，并包含了唯一解所需的所有信息。这是一个线性系统状态估计中的标准问题，是控制理论及其在数字孪生中应用的核心。我们将按要求进行完整的推导和计算。\n\n解决方案分为两个任务。首先，从给定的连续时间模型推导通用的离散时间卡尔曼滤波器。其次，将此滤波器应用于特定的标量系统，以计算两步之后的后验协方差。\n\n**任务1：离散时间卡尔曼滤波器的推导**\n\n推导从连续时间随机微分方程开始，然后进行系统动力学的离散化，最后基于线性高斯系统的贝叶斯推断推导卡尔曼滤波器方程。\n\n**连续时间模型的离散化**\n物理系统的状态由以下线性随机微分方程决定：\n$$\n\\dot{x}(t) = A x(t) + B u(t) + w(t)\n$$\n该方程在时间区间 $[t_k, t_{k+1}]$（其中 $t_{k+1} - t_k = \\Delta$）上的形式解由常数变易法给出：\n$$\nx(t_{k+1}) = \\exp(A\\Delta) x(t_k) + \\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau)) [B u(\\tau) + w(\\tau)] d\\tau\n$$\n我们定义 $x_k \\equiv x(t_k)$。假设输入上采用零阶保持器，即对于 $\\tau \\in [t_k, t_{k+1})$ 有 $u(\\tau) = u_k$，则方程变为：\n$$\nx_{k+1} = \\exp(A\\Delta) x_k + \\left(\\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau)) d\\tau \\right) B u_k + \\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau)) w(\\tau) d\\tau\n$$\n通过在第一个积分中进行变量替换 $\\sigma = t_{k+1} - \\tau$，我们得到离散时间状态空间模型：\n$$\nx_{k+1} = A_{\\Delta} x_k + B_{\\Delta} u_k + w_k\n$$\n其中离散时间系统矩阵 $A_{\\Delta}$、输入矩阵 $B_{\\Delta}$ 和过程噪声项 $w_k$ 定义为：\n$$\nA_{\\Delta} = \\exp(A\\Delta)\n$$\n$$\nB_{\\Delta} = \\left(\\int_{0}^{\\Delta} \\exp(A\\sigma) d\\sigma\\right) B\n$$\n$$\nw_k = \\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau)) w(\\tau) d\\tau\n$$\n$w_k$ 项是一个零均值高斯随机变量，因为它是高斯过程 $w(t)$ 的线性变换。其协方差 $Q_{\\Delta}$ 由下式给出：\n$$\nQ_{\\Delta} = \\mathbb{E}[w_k w_k^T] = \\mathbb{E}\\left[ \\left(\\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau_1)) w(\\tau_1) d\\tau_1 \\right) \\left(\\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau_2)) w(\\tau_2) d\\tau_2 \\right)^T \\right]\n$$\n$$\nQ_{\\Delta} = \\int_{t_k}^{t_{k+1}} \\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau_1)) \\mathbb{E}[w(\\tau_1) w(\\tau_2)^T] \\exp(A(t_{k+1} - \\tau_2))^T d\\tau_1 d\\tau_2\n$$\n连续时间过程噪声 $w(t)$ 是白噪声，意味着其自相关为 $\\mathbb{E}[w(\\tau_1) w(\\tau_2)^T] = Q \\delta(\\tau_1 - \\tau_2)$，其中 $\\delta(\\cdot)$ 是狄拉克δ函数。代入此式并利用δ函数的筛选性质，我们得到：\n$$\nQ_{\\Delta} = \\int_{t_k}^{t_{k+1}} \\exp(A(t_{k+1} - \\tau)) Q \\exp(A(t_{k+1} - \\tau))^T d\\tau\n$$\n通过变量替换 $\\sigma = t_{k+1} - \\tau$，上式变为：\n$$\nQ_{\\Delta} = \\int_{0}^{\\Delta} \\exp(A\\sigma) Q \\exp(A\\sigma)^T d\\sigma\n$$\n因此，完整的离散时间模型为：\n$$\nx_{k+1} = A_{\\Delta} x_k + B_{\\Delta} u_k + w_k, \\quad w_k \\sim \\mathcal{N}(0, Q_{\\Delta})\n$$\n$$\ny_k = C x_k + v_k, \\quad v_k \\sim \\mathcal{N}(0, R)\n$$\n\n**卡尔曼滤波器递归的推导**\n卡尔曼滤波器是一种递归贝叶斯估计器。我们假设在时刻 $k$，给定截至时刻 $k$ 的所有测量值 $y_{1:k}$，状态 $x_k$ 的后验分布是高斯分布：$p(x_k | y_{1:k}) = \\mathcal{N}(x_k; \\hat{x}_{k|k}, P_{k|k})$。该递归包括两个步骤：时间更新和测量更新。\n\n**时间更新（预测）：**\n目标是求出给定测量值 $y_{1:k}$ 时 $x_{k+1}$ 的分布。这是第 $k+1$ 步的先验分布。\n$$\np(x_{k+1} | y_{1:k}) = \\int p(x_{k+1} | x_k) p(x_k | y_{1:k}) dx_k\n$$\n由于积分中的两个分布都是高斯分布，且关系式 $x_{k+1} = A_{\\Delta}x_k + B_{\\Delta}u_k + w_k$ 是线性的，因此 $x_{k+1}$ 的结果分布也是高斯分布。其均值和协方差如下求得。\n预测均值是在 $y_{1:k}$ 条件下 $x_{k+1}$ 的期望值：\n$$\n\\hat{x}_{k+1|k} = \\mathbb{E}[x_{k+1} | y_{1:k}] = \\mathbb{E}[A_{\\Delta} x_k + B_{\\Delta} u_k + w_k | y_{1:k}]\n$$\n$$\n\\hat{x}_{k+1|k} = A_{\\Delta} \\mathbb{E}[x_k | y_{1:k}] + B_{\\Delta} u_k + \\mathbb{E}[w_k] = A_{\\Delta} \\hat{x}_{k|k} + B_{\\Delta} u_k\n$$\n预测协方差是：\n$$\nP_{k+1|k} = \\mathbb{E}[(x_{k+1} - \\hat{x}_{k+1|k})(x_{k+1} - \\hat{x}_{k+1|k})^T | y_{1:k}]\n$$\n$$\nP_{k+1|k} = \\mathbb{E}[(A_{\\Delta}(x_k - \\hat{x}_{k|k}) + w_k)(A_{\\Delta}(x_k - \\hat{x}_{k|k}) + w_k)^T | y_{1:k}]\n$$\n由于估计误差 $(x_k - \\hat{x}_{k|k})$ 与未来的过程噪声 $w_k$ 无关，交叉项为零：\n$$\nP_{k+1|k} = A_{\\Delta} \\mathbb{E}[(x_k - \\hat{x}_{k|k})(x_k - \\hat{x}_{k|k})^T | y_{1:k}] A_{\\Delta}^T + \\mathbb{E}[w_k w_k^T]\n$$\n$$\nP_{k+1|k} = A_{\\Delta} P_{k|k} A_{\\Delta}^T + Q_{\\Delta}\n$$\n所以，第 $k+1$ 步的先验分布为 $p(x_{k+1} | y_{1:k}) = \\mathcal{N}(x_{k+1}; \\hat{x}_{k+1|k}, P_{k+1|k})$。\n\n**测量更新（校正）：**\n在接收到测量值 $y_{k+1}$ 后，我们更新先验分布以获得后验分布 $p(x_{k+1} | y_{1:k+1})$。使用贝叶斯法则：\n$$\np(x_{k+1} | y_{1:k+1}) \\propto p(y_{k+1} | x_{k+1}) p(x_{k+1} | y_{1:k})\n$$\n似然 $p(y_{k+1} | x_{k+1})$ 从测量模型 $y_{k+1} = C x_{k+1} + v_{k+1}$ 获得，这意味着 $p(y_{k+1} | x_{k+1}) = \\mathcal{N}(y_{k+1}; C x_{k+1}, R)$。我们在乘以两个高斯分布。所得后验分布的指数是先验分布和似然分布的指数之和（忽略常数项）：\n$$\nL = -\\frac{1}{2} (x_{k+1} - \\hat{x}_{k+1|k})^T P_{k+1|k}^{-1} (x_{k+1} - \\hat{x}_{k+1|k}) -\\frac{1}{2} (y_{k+1} - C x_{k+1})^T R^{-1} (y_{k+1} - C x_{k+1})\n$$\n展开并收集关于 $x_{k+1}$ 的二次项和一次项：\n$$\nL = -\\frac{1}{2} \\left( x_{k+1}^T(P_{k+1|k}^{-1} + C^T R^{-1} C)x_{k+1} - 2x_{k+1}^T(P_{k+1|k}^{-1} \\hat{x}_{k+1|k} + C^T R^{-1} y_{k+1}) + \\dots \\right)\n$$\n通过配方法，我们可以确定后验高斯分布的均值 $\\hat{x}_{k+1|k+1}$ 和协方差 $P_{k+1|k+1}$。后验协方差的逆为：\n$$\nP_{k+1|k+1}^{-1} = P_{k+1|k}^{-1} + C^T R^{-1} C\n$$\n后验均值满足：\n$$\nP_{k+1|k+1}^{-1} \\hat{x}_{k+1|k+1} = P_{k+1|k}^{-1} \\hat{x}_{k+1|k} + C^T R^{-1} y_{k+1}\n$$\n$$\n\\hat{x}_{k+1|k+1} = P_{k+1|k+1} (P_{k+1|k}^{-1} \\hat{x}_{k+1|k} + C^T R^{-1} y_{k+1})\n$$\n为了得到标准的滤波器方程，我们将 Woodbury 矩阵恒等式应用于 $P_{k+1|k+1}^{-1}$：\n$$\nP_{k+1|k+1} = (P_{k+1|k}^{-1} + C^T R^{-1} C)^{-1} = P_{k+1|k} - P_{k+1|k} C^T (C P_{k+1|k} C^T + R)^{-1} C P_{k+1|k}\n$$\n我们定义卡尔曼增益 $K_{k+1}$ 为：\n$$\nK_{k+1} = P_{k+1|k} C^T (C P_{k+1|k} C^T + R)^{-1}\n$$\n后验协方差可以写为：\n$$\nP_{k+1|k+1} = P_{k+1|k} - K_{k+1} C P_{k+1|k} = (I - K_{k+1} C) P_{k+1|k}\n$$\n将此代回 $\\hat{x}_{k+1|k+1}$ 的表达式中：\n$$\n\\hat{x}_{k+1|k+1} = (I - K_{k+1} C) P_{k+1|k} (P_{k+1|k}^{-1} \\hat{x}_{k+1|k} + C^T R^{-1} y_{k+1})\n$$\n$$\n\\hat{x}_{k+1|k+1} = (I - K_{k+1} C) \\hat{x}_{k+1|k} + (P_{k+1|k} - K_{k+1} C P_{k+1|k}) C^T R^{-1} y_{k+1}\n$$\n使用 $K_{k+1} (C P_{k+1|k} C^T + R) = P_{k+1|k} C^T$，这意味着 $K_{k+1} C P_{k+1|k} C^T + K_{k+1} R = P_{k+1|k} C^T$，我们可以证明 $(P_{k+1|k} - K_{k+1} C P_{k+1|k}) C^T R^{-1} = K_{k+1}$。\n因此，后验均值更新为：\n$$\n\\hat{x}_{k+1|k+1} = (I - K_{k+1} C) \\hat{x}_{k+1|k} + K_{k+1} y_{k+1} = \\hat{x}_{k+1|k} + K_{k+1}(y_{k+1} - C \\hat{x}_{k+1|k})\n$$\n\n**任务2：应用于标量系统**\n\n我们现在将这些推导出的方程应用于特定的标量系统。\n给定参数为：$A = -1$, $B = 0$, $C = 1$, $Q = 2$, $R = 1$, $\\Delta = 0.5$。\n初始后验协方差为 $P_{0|0} = 3$。\n\n**参数计算**\n首先，我们计算离散时间参数 $A_{\\Delta}$ 和 $Q_{\\Delta}$。\n$$\nA_{\\Delta} = \\exp(A\\Delta) = \\exp((-1)(0.5)) = \\exp(-0.5)\n$$\n由于 $B = 0$，我们有 $B_{\\Delta} = 0$。\n离散过程噪声协方差 $Q_{\\Delta}$ 为：\n$$\nQ_{\\Delta} = \\int_{0}^{\\Delta} \\exp(A\\sigma) Q \\exp(A\\sigma)^T d\\sigma = 2 \\int_{0}^{0.5} \\exp(-2\\sigma) d\\sigma\n$$\n$$\nQ_{\\Delta} = 2 \\left[ \\frac{\\exp(-2\\sigma)}{-2} \\right]_{0}^{0.5} = -[\\exp(-2 \\cdot 0.5) - \\exp(0)] = -(\\exp(-1) - 1) = 1 - \\exp(-1)\n$$\n\n**协方差传播**\n我们需要从 $P_{0|0} = 3$ 开始计算 $P_{2|2}$。该递归仅涉及协方差的传播。\n\n**第1步：从 $k=0$ 到 $k=1$**\n时间更新（对 $k=1$ 的预测）：\n$$\nP_{1|0} = A_{\\Delta} P_{0|0} A_{\\Delta}^T + Q_{\\Delta} = A_{\\Delta}^2 P_{0|0} + Q_{\\Delta}\n$$\n$$\nP_{1|0} = (\\exp(-0.5))^2 \\cdot 3 + (1 - \\exp(-1)) = 3\\exp(-1) + 1 - \\exp(-1) = 1 + 2\\exp(-1)\n$$\n测量更新（在 $k=1$ 处的校正）：\n对于标量情况，协方差更新方程得以简化。卡尔曼增益为 $K_1 = P_{1|0}C^T(C P_{1|0} C^T + R)^{-1} = P_{1|0}(1 \\cdot P_{1|0} \\cdot 1 + 1)^{-1} = \\frac{P_{1|0}}{P_{1|0}+1}$。\n后验协方差为 $P_{1|1} = (1 - K_1 C)P_{1|0} = (1 - K_1)P_{1|0}$。\n$$\nP_{1|1} = \\left(1 - \\frac{P_{1|0}}{P_{1|0}+1}\\right) P_{1|0} = \\left(\\frac{1}{P_{1|0}+1}\\right) P_{1|0} = \\frac{P_{1|0}}{P_{1|0}+1}\n$$\n代入 $P_{1|0}$ 的值：\n$$\nP_{1|1} = \\frac{1 + 2\\exp(-1)}{1 + 2\\exp(-1) + 1} = \\frac{1 + 2\\exp(-1)}{2 + 2\\exp(-1)}\n$$\n\n**第2步：从 $k=1$ 到 $k=2$**\n时间更新（对 $k=2$ 的预测）：\n$$\nP_{2|1} = A_{\\Delta}^2 P_{1|1} + Q_{\\Delta} = \\exp(-1) P_{1|1} + (1 - \\exp(-1))\n$$\n$$\nP_{2|1} = \\exp(-1)\\left(\\frac{1 + 2\\exp(-1)}{2 + 2\\exp(-1)}\\right) + (1 - \\exp(-1)) = \\frac{\\exp(-1) + 2\\exp(-2)}{2(1 + \\exp(-1))} + \\frac{(1 - \\exp(-1)) \\cdot 2(1 + \\exp(-1))}{2(1 + \\exp(-1))}\n$$\n$$\nP_{2|1} = \\frac{\\exp(-1) + 2\\exp(-2) + 2(1 - \\exp(-2))}{2(1 + \\exp(-1))} = \\frac{\\exp(-1) + 2\\exp(-2) + 2 - 2\\exp(-2)}{2(1 + \\exp(-1))}\n$$\n$$\nP_{2|1} = \\frac{2 + \\exp(-1)}{2(1 + \\exp(-1))}\n$$\n测量更新（在 $k=2$ 处的校正）：\n与上一步类似，后验协方差为 $P_{2|2} = \\frac{P_{2|1}}{P_{2|1}+1}$。\n$$\nP_{2|2} = \\frac{\\frac{2 + \\exp(-1)}{2(1 + \\exp(-1))}}{\\frac{2 + \\exp(-1)}{2(1 + \\exp(-1))} + 1} = \\frac{2 + \\exp(-1)}{2 + \\exp(-1) + 2(1 + \\exp(-1))}\n$$\n$$\nP_{2|2} = \\frac{2 + \\exp(-1)}{2 + \\exp(-1) + 2 + 2\\exp(-1)} = \\frac{2 + \\exp(-1)}{4 + 3\\exp(-1)}\n$$\n\n**数值结果**\n我们现在计算 $P_{2|2}$ 的最终数值。\n使用数值 $\\exp(-1) \\approx 0.36787944$：\n$$\nP_{2|2} = \\frac{2 + 0.36787944}{4 + 3(0.36787944)} = \\frac{2.36787944}{4 + 1.10363832} = \\frac{2.36787944}{5.10363832} \\approx 0.463953503\n$$\n四舍五入到四位有效数字，我们得到 $0.4640$。\n两次测量更新后的后验协方差为 $P_{2|2} \\approx 0.4640$。",
            "answer": "$$\n\\boxed{0.4640}\n$$"
        }
    ]
}