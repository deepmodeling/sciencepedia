{
    "hands_on_practices": [
        {
            "introduction": "The Routh-Hurwitz criterion is a powerful algebraic tool that allows us to determine the stability of a linear system by inspecting the coefficients of its characteristic polynomial, without the need to compute the poles directly. This first exercise  solidifies your understanding by tasking you with deriving the criterion from the argument principle of complex analysis, thus bridging the gap between abstract theory and a practical algorithm. You will then apply this method to a biomedical control model to determine the number of unstable poles, practicing a fundamental skill in system analysis.",
            "id": "3930104",
            "problem": "A linear time-invariant (LTI) biomedical control system is modeled by its characteristic polynomial $p(s)$, whose roots determine the poles of the closed-loop system. An LTI system is asymptotically stable if and only if all poles lie strictly in the open left half of the complex plane, which is equivalent to all roots of $p(s)$ having strictly negative real parts. Starting from the definition of asymptotic stability for LTI systems, the Laplace-domain representation of linear dynamics, and the argument principle for complex functions, derive the Routh-Hurwitz criterion for a real-coefficient polynomial $p(s)$ that provides a necessary and sufficient test for all roots to lie in the open left half-plane without computing the roots. Your derivation should explicitly connect the number of roots in the right half-plane to a computable signature associated with $p(s)$ constructed via a sequence of algebraic operations on its coefficients, and should justify why positivity of a certain set of quantities guarantees left-half-plane roots.\n\nThen, apply your derived criterion to the following physiologically motivated closed-loop controller characteristic. Consider a continuous glucose monitoring and insulin infusion system linearized about a normoglycemic equilibrium. The linearized plant combines glucose distribution and insulin action dynamics, while the controller is a proportional-integral action tuned around the operating point. The resulting closed-loop characteristic polynomial is\n$$\np(s) \\;=\\; s^{4} \\;+\\; 3\\,s^{3} \\;+\\; \\frac{1}{2}\\,s^{2} \\;+\\; 4\\,s \\;+\\; 1.\n$$\nUsing the Routh-Hurwitz criterion, determine the number of unstable poles (i.e., roots of $p(s)$ with strictly positive real parts) without computing any roots of $p(s)$. Express your final answer as a single integer. No rounding is required, and no units are involved.",
            "solution": "The problem requires a derivation of the Routh-Hurwitz stability criterion from first principles and its subsequent application to a specific polynomial.\n\n### Derivation of the Routh-Hurwitz Criterion\n\n**1. Foundation: Asymptotic Stability and the Argument Principle**\n\nAn LTI system is asymptotically stable if and only if all the poles of its transfer function lie in the open left half of the complex plane (LHP). The poles are the roots of the system's characteristic polynomial, $p(s)$. Thus, for stability, all roots of $p(s)$ must have strictly negative real parts.\n\nThe argument principle from complex analysis provides a method to count the number of zeros of an analytic function inside a closed contour. Let $p(s)$ be a polynomial, which is analytic everywhere. Let $\\Gamma$ be a simple closed contour in the complex $s$-plane, oriented counter-clockwise. If $p(s)$ has no roots on $\\Gamma$, then the number of roots (zeros) of $p(s)$ enclosed by $\\Gamma$, denoted by $Z$, is given by:\n$$Z = \\frac{1}{2\\pi} \\Delta_{\\Gamma} \\arg(p(s))$$\nwhere $\\Delta_{\\Gamma} \\arg(p(s))$ is the total change in the argument of $p(s)$ as $s$ traverses the contour $\\Gamma$ once. This is equivalent to the number of times the locus of $p(s)$ encircles the origin in the complex plane.\n\n**2. The Nyquist Contour and Counting RHP Roots**\n\nTo determine the number of roots in the open right-half plane (RHP), we choose a contour, known as the Nyquist contour, that encloses the entire RHP. This contour $\\Gamma$ consists of:\n- The imaginary axis from $s = -jR$ to $s = +jR$.\n- A large semicircle of radius $R$ in the RHP, centered at the origin, as $R \\to \\infty$.\n\nLet the characteristic polynomial be $p(s) = a_n s^n + a_{n-1}s^{n-1} + \\dots + a_1 s + a_0$, where the coefficients $a_i$ are real and $a_n  0$. We assume $p(s)$ has no roots on the imaginary axis (no purely imaginary roots).\n\nThe total change in argument around $\\Gamma$ is the sum of the changes along its segments:\n$$\\Delta_{\\Gamma} \\arg(p(s)) = \\Delta_{\\text{semicircle}} \\arg(p(s)) + \\Delta_{j\\omega} \\arg(p(s))$$\n\n*   **Change along the semicircle**: For very large $|s|=R$, the highest power term dominates: $p(s) \\approx a_n s^n$. On the semicircle, $s = R e^{j\\theta}$ where $\\theta$ varies from $\\frac{\\pi}{2}$ to $-\\frac{\\pi}{2}$.\n    $$p(R e^{j\\theta}) \\approx a_n (R e^{j\\theta})^n = a_n R^n e^{jn\\theta}$$\n    The argument of $p(s)$ is approximately $n\\theta$. The change in argument is $n \\times (\\text{final angle} - \\text{initial angle}) = n(-\\frac{\\pi}{2} - \\frac{\\pi}{2}) = -n\\pi$.\n    So, $\\Delta_{\\text{semicircle}} \\arg(p(s)) = -n\\pi$.\n\n*   **Change along the imaginary axis**: The number of RHP roots, $Z_{RHP}$, is given by:\n    $$Z_{RHP} = \\frac{1}{2\\pi} \\left( \\Delta_{\\text{semicircle}} \\arg(p(s)) + \\Delta_{j\\omega} \\arg(p(s)) \\right)$$\n    $$Z_{RHP} = \\frac{1}{2\\pi} \\left( -n\\pi + \\Delta_{j\\omega} \\arg(p(s)) \\right)$$\n    where $\\Delta_{j\\omega} \\arg(p(s))$ is the change in argument as $s=j\\omega$ goes from $\\omega = -\\infty$ to $\\omega = +\\infty$. Rearranging gives:\n    $$\\Delta_{j\\omega} \\arg(p(s)) = 2\\pi Z_{RHP} + n\\pi$$\n\nFor an asymptotically stable system, $Z_{RHP} = 0$. The condition for stability is therefore:\n$$\\Delta_{j\\omega} \\arg(p(s)) = n\\pi$$\nSince $p(s)$ has real coefficients, $p(-j\\omega)$ is the complex conjugate of $p(j\\omega)$, so $\\arg(p(-j\\omega)) = -\\arg(p(j\\omega))$. The argument plot is odd. The change in argument from $\\omega = -\\infty$ to $\\omega = +\\infty$ is twice the change from $\\omega=0$ to $\\omega=+\\infty$. Thus, the stability condition simplifies to:\n$$\\Delta_{\\omega=0 \\to \\infty} \\arg(p(j\\omega)) = n \\frac{\\pi}{2}$$\nThis means the vector $p(j\\omega)$ must sweep through exactly $n$ quadrants as $\\omega$ increases from $0$ to $\\infty$.\n\n**3. Algebraic Interpretation: The Routh Array**\n\nThe Routh-Hurwitz criterion provides a purely algebraic method to calculate the net change in angle, or, more directly, to count the number of RHP roots $Z_{RHP}$. This is achieved by constructing the Routh array.\n\nLet the polynomial be $p(s) = a_n s^n + a_{n-1} s^{n-1} + \\dots + a_0$. The array is constructed as follows:\nThe first two rows are formed from the coefficients of $p(s)$:\nRow $s^n$: $a_n, a_{n-2}, a_{n-4}, \\dots$\nRow $s^{n-1}$: $a_{n-1}, a_{n-3}, a_{n-5}, \\dots$\n\nSubsequent rows are computed recursively. For the row $s^{n-2}$, with elements $b_1, b_2, \\dots$:\n$$b_1 = \\frac{a_{n-1}a_{n-2} - a_n a_{n-3}}{a_{n-1}}$$\n$$b_2 = \\frac{a_{n-1}a_{n-4} - a_n a_{n-5}}{a_{n-1}}$$\n... and so on. The next row, $s^{n-3}$, is computed from the rows $s^{n-1}$ and $s^{n-2}$ in the same manner. This process continues until the $s^0$ row is computed, which will contain only one element.\n\nThis procedure is equivalent to performing a continued fraction expansion of the ratio of the odd and even parts of the polynomial, which is related to Sturm's theorem for counting real roots of a function. The key result, known as the **Routh-Hurwitz Theorem**, is:\n\n*The number of roots of the polynomial $p(s)$ with positive real parts is equal to the number of sign changes in the first column of the Routh array.*\n\nFor a system to be asymptotically stable ($Z_{RHP}=0$), there must be zero sign changes in the first column. Assuming $a_n  0$, this is equivalent to the condition that all elements of the first column must be positive. This guarantees that the condition $\\Delta_{\\omega=0 \\to \\infty} \\arg(p(j\\omega)) = n \\frac{\\pi}{2}$ is met.\n\n### Application to the Given System\n\nThe closed-loop characteristic polynomial is given by:\n$$p(s) = s^{4} + 3s^{3} + \\frac{1}{2}s^{2} + 4s + 1$$\nHere, the degree is $n=4$. The coefficients are $a_4=1$, $a_3=3$, $a_2=\\frac{1}{2}$, $a_1=4$, and $a_0=1$. A necessary (but not sufficient) condition for stability is that all coefficients are positive. This is true for the given polynomial. We now construct the Routh array to apply the necessary and sufficient test.\n\nThe first two rows are:\n$s^4 \\quad | \\quad 1 \\quad \\frac{1}{2} \\quad 1$\n$s^3 \\quad | \\quad 3 \\quad 4$\n\nNow we compute the subsequent rows.\n\n**Row $s^2$**: The elements are $b_1$ and $b_2$.\n$$b_1 = \\frac{(3)(\\frac{1}{2}) - (1)(4)}{3} = \\frac{\\frac{3}{2} - 4}{3} = \\frac{-\\frac{5}{2}}{3} = -\\frac{5}{6}$$\n$$b_2 = \\frac{(3)(1) - (1)(0)}{3} = \\frac{3}{3} = 1$$\nThe row is:\n$s^2 \\quad | \\quad -\\frac{5}{6} \\quad 1$\n\n**Row $s^1$**: The element is $c_1$.\n$$c_1 = \\frac{(-\\frac{5}{6})(4) - (3)(1)}{-\\frac{5}{6}} = \\frac{-\\frac{20}{6} - 3}{-\\frac{5}{6}} = \\frac{-\\frac{10}{3} - \\frac{9}{3}}{-\\frac{5}{6}} = \\frac{-\\frac{19}{3}}{-\\frac{5}{6}} = \\left(-\\frac{19}{3}\\right)\\left(-\\frac{6}{5}\\right) = \\frac{19 \\times 2}{5} = \\frac{38}{5}$$\nThe row is:\n$s^1 \\quad | \\quad \\frac{38}{5}$\n\n**Row $s^0$**: The element is $d_1$.\n$$d_1 = \\frac{(\\frac{38}{5})(1) - (-\\frac{5}{6})(0)}{\\frac{38}{5}} = 1$$\nThe row is:\n$s^0 \\quad | \\quad 1$\n\nThe complete Routh array is:\n$$\n\\begin{array}{c|ccc}\ns^4  1  \\frac{1}{2}  1 \\\\\ns^3  3  4  \\\\\ns^2  -\\frac{5}{6}  1  \\\\\ns^1  \\frac{38}{5}   \\\\\ns^0  1  \n\\end{array}\n$$\n\nTo determine the number of unstable poles, we examine the signs of the elements in the first column:\n$1$ (Positive)\n$3$ (Positive)\n$-\\frac{5}{6}$ (Negative) $\\implies$ First sign change ($+$ to $-$)\n$\\frac{38}{5}$ (Positive) $\\implies$ Second sign change ($-$ to $+$)\n$1$ (Positive)\n\nThere are two sign changes in the first column. According to the Routh-Hurwitz criterion, this indicates that there are exactly two roots of the characteristic polynomial $p(s)$ in the open right-half plane. These are the unstable poles of the system.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Moving from the algebraic to the time-domain, Lyapunov's direct method provides a profound way to analyze stability by considering a system's generalized energy. For discrete-time systems, which are crucial in digital control and cyber-physical applications, this involves finding a function that consistently decreases along system trajectories. This practice  challenges you to apply this concept by solving the discrete-time Lyapunov equation for a two-compartment biomedical model and, further, to use the solution to derive a guaranteed rate of convergence, offering deeper quantitative insight into the system's transient behavior.",
            "id": "3930077",
            "problem": "A discrete-time linear time-invariant (LTI) model of small deviations around a homeostatic operating point in a two-compartment biomedical control loop (for example, coupled deviations in arterial pressure and autonomic control signal) is given by the state dynamics $x_{k+1} = A x_{k}$, where $x_{k} \\in \\mathbb{R}^{2}$ is the deviation state vector sampled at a fixed period. The linearization and sampling around the equilibrium produced the matrix\n$$\nA = \\begin{pmatrix}\n0.85  0.10 \\\\\n-0.05  0.90\n\\end{pmatrix}.\n$$\nStarting from core definitions of stability for discrete-time linear systems and Lyapunov functions, use the notion of Schur stability (all eigenvalues of $A$ strictly inside the unit disk) and construct a quadratic Lyapunov function candidate $V(x) = x^{\\top} P x$ with $P \\succ 0$. Impose the discrete-time Lyapunov condition that the difference $V(x_{k+1}) - V(x_{k})$ be negative definite by requiring $A^{\\top} P A - P = -Q$ with a chosen $Q \\succ 0$. Take\n$$\nQ = I_2.\n$$\nProceed as follows:\n- Argue from first principles why, if $A$ is Schur stable, there exists a unique $P \\succ 0$ solving the discrete-time Lyapunov equation for any given $Q \\succ 0$.\n- Solve $A^{\\top} P A - P = -Q$ for the symmetric matrix $P \\in \\mathbb{R}^{2 \\times 2}$.\n- Using eigenvalue bounds that relate $x^{\\top} Q x$ and $x^{\\top} P x$, derive a guaranteed per-step contraction factor $r \\in (0,1)$ such that $V(x_{k+1}) \\leq r \\, V(x_{k})$ holds for all $x \\in \\mathbb{R}^{2}$.\n- Compute the numerical value of $r$ for the $P$ you found.\n\nExpress your final per-step contraction factor as a decimal (unitless) rounded to four significant figures.",
            "solution": "The user-provided problem is subjected to a rigorous validation procedure before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System Dynamics**: A discrete-time linear time-invariant (LTI) system is described by $x_{k+1} = A x_{k}$, where $x_{k} \\in \\mathbb{R}^{2}$.\n- **System Matrix**: The state matrix is given by $A = \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix}$.\n- **Lyapunov Function Candidate**: $V(x) = x^{\\top} P x$, with the condition that $P$ is a symmetric positive definite matrix ($P = P^{\\top} \\succ 0$).\n- **Lyapunov Equation**: The change in the Lyapunov function is constrained by the discrete-time Lyapunov equation $A^{\\top} P A - P = -Q$.\n- **Weighting Matrix**: The matrix $Q$ is chosen to be the $2 \\times 2$ identity matrix, $Q = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$.\n- **Objectives**:\n    1.  Prove that for a Schur stable matrix $A$, the Lyapunov equation has a unique, positive definite solution $P$ for any positive definite $Q$.\n    2.  Solve the Lyapunov equation for the matrix $P$.\n    3.  Derive a guaranteed per-step contraction factor $r \\in (0,1)$ such that $V(x_{k+1}) \\leq r \\, V(x_{k})$.\n    4.  Compute the numerical value of $r$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in Lyapunov stability theory for discrete-time systems. To confirm it is well-posed, we must verify that the matrix $A$ is Schur stable (all its eigenvalues lie strictly inside the unit circle in the complex plane).\n\nThe characteristic equation of $A$ is $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\left( \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = 0\n$$\n$$\n(0.85 - \\lambda)(0.90 - \\lambda) - (0.10)(-0.05) = 0\n$$\n$$\n\\lambda^2 - (0.85 + 0.90)\\lambda + (0.85)(0.90) + 0.005 = 0\n$$\n$$\n\\lambda^2 - 1.75\\lambda + 0.765 + 0.005 = 0\n$$\n$$\n\\lambda^2 - 1.75\\lambda + 0.77 = 0\n$$\nThe discriminant of this quadratic equation is $\\Delta = (-1.75)^2 - 4(1)(0.77) = 3.0625 - 3.08 = -0.0175  0$.\nSince the discriminant is negative, the eigenvalues are a complex conjugate pair. For a $2 \\times 2$ matrix with complex conjugate eigenvalues $\\lambda$ and $\\bar{\\lambda}$, the squared magnitude of the eigenvalues is equal to the determinant of the matrix, $|\\lambda|^2 = \\det(A)$.\nThe determinant is $\\det(A) = (0.85)(0.90) - (0.10)(-0.05) = 0.77$.\nThus, the magnitude of the eigenvalues is $|\\lambda| = \\sqrt{0.77} \\approx 0.8775$.\nSince $|\\lambda|  1$, both eigenvalues are strictly inside the unit disk. The matrix $A$ is Schur stable.\n\nThe problem is self-contained, scientifically sound, and all required data are provided. No contradictions or ambiguities are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n**1. Existence and Uniqueness of the Solution P**\n\nThe discrete-time Lyapunov equation is $A^{\\top} P A - P = -Q$. This equation is linear in the elements of the matrix $P$. It can be written in a vectorized form using the Kronecker product $\\otimes$. Let $p = \\text{vec}(P)$ and $q = \\text{vec}(Q)$. The equation becomes:\n$$\n(A^{\\top} \\otimes A^{\\top}) p - p = -q \\implies (I - A^{\\top} \\otimes A^{\\top}) p = q\n$$\nA unique solution for $p$ (and thus for $P$) exists if and only if the matrix $(I - A^{\\top} \\otimes A^{\\top})$ is invertible. This requires that none of its eigenvalues are zero.\nThe eigenvalues of a Kronecker product $M \\otimes N$ are the products of the eigenvalues of $M$ and $N$. Let the eigenvalues of $A$ (and $A^{\\top}$) be $\\lambda_1, \\dots, \\lambda_n$. The eigenvalues of $A^{\\top} \\otimes A^{\\top}$ are $\\lambda_i \\lambda_j$ for all pairs $i, j \\in \\{1, \\dots, n\\}$.\nThe eigenvalues of $(I - A^{\\top} \\otimes A^{\\top})$ are therefore $1 - \\lambda_i \\lambda_j$.\nThe matrix is invertible if and only if $1 - \\lambda_i \\lambda_j \\neq 0$ for all $i, j$. This is equivalent to $\\lambda_i \\lambda_j \\neq 1$.\nThe condition that $A$ is Schur stable means $|\\lambda_k|  1$ for all $k$. This implies $|\\lambda_i \\lambda_j| = |\\lambda_i||\\lambda_j|  1 \\times 1 = 1$. Consequently, $\\lambda_i \\lambda_j$ can never be equal to $1$.\nThus, for a Schur stable matrix $A$, a unique solution $P$ to the Lyapunov equation exists.\n\nTo show that this unique solution $P$ is positive definite ($P \\succ 0$) when $Q \\succ 0$, we can express $P$ as an infinite series. From $P = A^{\\top} P A + Q$, we can iterate:\n$$\nP = A^{\\top}(A^{\\top} P A + Q)A + Q = (A^{\\top})^2 P A^2 + A^{\\top} Q A + Q\n$$\nContinuing this iteration $k-1$ times yields:\n$$\nP = (A^{\\top})^k P A^k + \\sum_{j=0}^{k-1} (A^{\\top})^j Q A^j\n$$\nSince $A$ is Schur stable, $\\lim_{k \\to \\infty} A^k = 0$. Therefore, the term $(A^{\\top})^k P A^k$ vanishes in the limit. The unique solution $P$ is given by the convergent series:\n$$\nP = \\sum_{j=0}^{\\infty} (A^{\\top})^j Q A^j\n$$\nTo prove $P$ is positive definite, consider the quadratic form $x^{\\top} P x$ for any non-zero vector $x \\in \\mathbb{R}^n$:\n$$\nx^{\\top} P x = x^{\\top} \\left( \\sum_{j=0}^{\\infty} (A^{\\top})^j Q A^j \\right) x = \\sum_{j=0}^{\\infty} x^{\\top} (A^{\\top})^j Q A^j x = \\sum_{j=0}^{\\infty} (A^j x)^{\\top} Q (A^j x)\n$$\nSince $Q \\succ 0$, each term in the sum $(A^j x)^{\\top} Q (A^j x)$ is non-negative. For the sum to be positive, at least one term must be strictly positive. The first term ($j=0$) is $x^{\\top} Q x$. As $x \\neq 0$ and $Q \\succ 0$, we have $x^{\\top} Q x  0$.\nThus, $x^{\\top} P x  0$ for all $x \\neq 0$, which proves that $P$ is positive definite.\n\n**2. Solving for the Matrix P**\n\nLet $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ be the symmetric matrix to be found. The equation $A^{\\top} P A - P = -I$ leads to a system of linear equations for the elements of $P$.\n$$\n\\begin{pmatrix} 0.85  -0.05 \\\\ 0.10  0.90 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix} - \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\nPerforming the matrix multiplications and equating the elements yields the following system of three unique linear equations:\n\\begin{enumerate}\n    \\item $(1,1)$-element: $0.7225p_{11} - 0.085p_{12} + 0.0025p_{22} - p_{11} = -1 \\implies -0.2775p_{11} - 0.085p_{12} + 0.0025p_{22} = -1$\n    \\item $(1,2)$-element: $0.085p_{11} + 0.76p_{12} - 0.045p_{22} - p_{12} = 0 \\implies 0.085p_{11} - 0.24p_{12} - 0.045p_{22} = 0$\n    \\item $(2,2)$-element: $0.01p_{11} + 0.18p_{12} + 0.81p_{22} - p_{22} = -1 \\implies 0.01p_{11} + 0.18p_{12} - 0.19p_{22} = -1$\n\\end{enumerate}\nThis system can be written more cleanly by multiplying by constants:\n\\begin{enumerate}\n    \\item $111 p_{11} + 34 p_{12} - p_{22} = 400$\n    \\item $17 p_{11} - 48 p_{12} - 9 p_{22} = 0$\n    \\item $p_{11} + 18 p_{12} - 19 p_{22} = -100$\n\\end{enumerate}\nSolving this system of linear equations yields the exact solution:\n$$\np_{11} = \\frac{58125}{16192}, \\quad p_{12} = \\frac{3425}{16192}, \\quad p_{22} = \\frac{91525}{16192}\n$$\nSo, the matrix $P$ is:\n$$\nP = \\frac{1}{16192} \\begin{pmatrix} 58125  3425 \\\\ 3425  91525 \\end{pmatrix}\n$$\n\n**3. Derivation of the Contraction Factor**\n\nThe Lyapunov function is $V(x_k) = x_k^{\\top} P x_k$. The change in its value in one step is:\n$$\nV(x_{k+1}) - V(x_k) = x_{k+1}^{\\top} P x_{k+1} - x_k^{\\top} P x_k = (Ax_k)^{\\top}P(Ax_k) - x_k^{\\top}P x_k = x_k^{\\top}(A^{\\top}PA - P)x_k\n$$\nUsing the Lyapunov equation $A^{\\top}PA - P = -Q = -I$, we have:\n$$\nV(x_{k+1}) - V(x_k) = -x_k^{\\top} I x_k = -x_k^{\\top}x_k = -\\|x_k\\|_2^2\n$$\nThis gives $V(x_{k+1}) = V(x_k) - \\|x_k\\|_2^2$.\nWe seek a factor $r$ such that $V(x_{k+1}) \\leq r V(x_k)$. This is equivalent to finding an upper bound on the ratio $\\frac{V(x_{k+1})}{V(x_k)}$.\n$$\n\\frac{V(x_{k+1})}{V(x_k)} = \\frac{V(x_k) - \\|x_k\\|_2^2}{V(x_k)} = 1 - \\frac{\\|x_k\\|_2^2}{x_k^{\\top} P x_k}\n$$\nTo find a guaranteed contraction factor $r$ valid for all non-zero $x_k$, we must maximize this ratio. This is achieved by minimizing the term being subtracted:\n$$\nr = \\max_{x_k \\neq 0} \\left( 1 - \\frac{\\|x_k\\|_2^2}{x_k^{\\top} P x_k} \\right) = 1 - \\min_{x_k \\neq 0} \\frac{\\|x_k\\|_2^2}{x_k^{\\top} P x_k} = 1 - \\min_{x_k \\neq 0} \\frac{x_k^{\\top} I x_k}{x_k^{\\top} P x_k}\n$$\nThe minimum of the generalized Rayleigh quotient $\\frac{x^{\\top}Qx}{x^{\\top}Px}$ is the smallest eigenvalue of the matrix pencil $(Q,P)$, which is $\\lambda_{\\min}(P^{-1}Q)$. Since $Q=I$, this is $\\lambda_{\\min}(P^{-1})$. The eigenvalues of an inverse matrix are the reciprocals of the eigenvalues of the original matrix. Therefore, $\\lambda_{\\min}(P^{-1}) = \\frac{1}{\\lambda_{\\max}(P)}$.\nSubstituting this into the expression for $r$:\n$$\nr = 1 - \\frac{1}{\\lambda_{\\max}(P)}\n$$\n\n**4. Computation of the Numerical Value of r**\n\nFirst, we must find the eigenvalues of the matrix $P$. The eigenvalues $\\lambda$ of $P$ are the roots of the characteristic equation $\\det(P - \\lambda I) = 0$.\n$$\n\\lambda^2 - \\text{tr}(P)\\lambda + \\det(P) = 0\n$$\nThe trace and determinant of $P$ are:\n$$\n\\text{tr}(P) = p_{11} + p_{22} = \\frac{58125 + 91525}{16192} = \\frac{149650}{16192} \\approx 9.24218\n$$\n$$\n\\det(P) = p_{11}p_{22} - p_{12}^2 = \\frac{58125 \\times 91525 - 3425^2}{16192^2} = \\frac{5308778750}{262180864} \\approx 20.25615\n$$\nThe eigenvalues are $\\lambda = \\frac{\\text{tr}(P) \\pm \\sqrt{\\text{tr}(P)^2 - 4\\det(P)}}{2}$.\nThe maximum eigenvalue is:\n$$\n\\lambda_{\\max}(P) = \\frac{\\text{tr}(P) + \\sqrt{\\text{tr}(P)^2 - 4\\det(P)}}{2}\n$$\nNumerically evaluating this gives:\n$$\n\\lambda_{\\max}(P) \\approx 5.67490\n$$\n$$\n\\lambda_{\\min}(P) \\approx 3.56728\n$$\nThe contraction factor $r$ is:\n$$\nr = 1 - \\frac{1}{\\lambda_{\\max}(P)} \\approx 1 - \\frac{1}{5.67490} \\approx 1 - 0.1762145\n$$\n$$\nr \\approx 0.8237855\n$$\nRounding to four significant figures, we get $r = 0.8238$.",
            "answer": "$$\n\\boxed{0.8238}\n$$"
        },
        {
            "introduction": "Our final practice shifts to the frequency domain, employing the Nyquist stability criterion—a graphical method that is particularly insightful for systems with time delays. In the context of modern Cyber-Physical Systems and Digital Twins, where communication delays are inherent, accurately modeling and analyzing their impact is critical. This computational exercise  guides you to implement the Nyquist criterion to compare the stability of a system with an exact, transcendental delay model against its practical Padé approximations, providing hands-on experience with the practical trade-offs involved in system modeling for stability analysis.",
            "id": "4247062",
            "problem": "Consider a linear time-invariant open-loop actuator channel in a Cyber-Physical System (CPS) digital twin with an input-to-actuator delay. The open-loop transfer function is defined as $L(s) = K(s) G(s) D(s)$, where $s$ is the complex Laplace variable. The controller is proportional, given by $K(s) = k$, and the actuator plant is first-order, given by $G(s) = \\frac{1}{\\tau s + 1}$, where $\\tau$ is a positive time constant in seconds. The delay $D(s)$ is either the exact exponential $e^{-sT}$, where $T$ is a nonnegative delay in seconds, or a rational Padé approximation $D_n(s)$ of order $n$. For computational comparison, use the first-order Padé approximation $D_1(s) = \\frac{1 - \\frac{sT}{2}}{1 + \\frac{sT}{2}}$ and the second-order Padé approximation $D_2(s) = \\frac{1 - \\frac{sT}{2} + \\frac{(sT)^2}{12}}{1 + \\frac{sT}{2} + \\frac{(sT)^2}{12}}$. The closed-loop characteristic function is $F(s) = 1 + L(s)$.\n\nYour task is to implement a program that performs Nyquist stability analysis for both the exact delay and the Padé-approximated delay. The analysis must be grounded in the Principle of the Argument: the number of clockwise encirclements of the critical point in the appropriate complex mapping equals the net change of the argument along the Nyquist contour divided by $2\\pi$. Specifically, evaluate the image of the imaginary axis under $F(s)$, given by $F(j\\omega)$ for real frequency $\\omega$ (where $j$ is the imaginary unit), and compute the winding number of $F(j\\omega)$ about the origin to infer closed-loop stability. Angles must be computed in radians.\n\nFor each test case, do the following:\n- Evaluate $F_{\\text{exact}}(j\\omega) = 1 + k \\frac{1}{1 + j \\omega \\tau} e^{-j \\omega T}$ for a frequency grid spanning $\\omega \\in [-\\Omega_{\\max}, \\Omega_{\\max}]$, and compute the unwrapped net change in argument of $F_{\\text{exact}}(j\\omega)$ along the path from $-\\Omega_{\\max}$ to $\\Omega_{\\max}$, then divide by $2\\pi$ and round to the nearest integer to obtain the winding number $N_{\\text{exact}}$.\n- Evaluate $F_{\\text{pade}}(j\\omega) = 1 + k \\frac{1}{1 + j \\omega \\tau} D_n(j\\omega)$ for the same grid and compute $N_{\\text{pade}}$ similarly.\n- Assume the open-loop $L(s)$ has no right-half-plane poles for the exact delay and for the given Padé approximations (which is true for the specified plant and Padé orders). Conclude closed-loop stability for each representation as a boolean by checking whether the corresponding winding number is zero, i.e., stable if the integer winding number equals $0$ and unstable otherwise.\n- Use angles in radians. No physical units are required in the output because the requested outputs are booleans and integers.\n\nFrequency grid specification:\n- Construct a symmetric frequency grid that includes $0$ and spans negative to positive frequencies, using a logarithmic spacing on the positive side and mirroring to the negative side. Let $\\Omega_{\\max} = \\max\\left(\\frac{1000}{\\tau}, \\frac{100}{T + \\varepsilon}\\right)$ with $\\varepsilon$ a small positive number to avoid division by zero when $T = 0$, and use at least $400$ points on the positive side. Ensure numerical robustness by unwrapping the angle of $F(j\\omega)$ along the ordered grid from $-\\Omega_{\\max}$ to $\\Omega_{\\max}$.\n\nTest Suite:\n- Case $1$: $(\\tau, k, T, n) = (0.1 \\text{ s}, 1.0, 0.02 \\text{ s}, 1)$\n- Case $2$: $(\\tau, k, T, n) = (0.1 \\text{ s}, 4.0, 0.3 \\text{ s}, 1)$\n- Case $3$: $(\\tau, k, T, n) = (0.05 \\text{ s}, 5.0, 0.0 \\text{ s}, 1)$\n- Case $4$: $(\\tau, k, T, n) = (0.2 \\text{ s}, 3.0, 0.5 \\text{ s}, 2)$\n- Case $5$: $(\\tau, k, T, n) = (0.1 \\text{ s}, 2.0, 0.2 \\text{ s}, 2)$\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. For each test case, report a list with four entries: the integer $N_{\\text{exact}}$, the integer $N_{\\text{pade}}$, the boolean for exact-delay stability, and the boolean for Padé-approximation stability. The final output should look like a Python-style list of lists, for example, $[[0,0,True,True],[\\dots],\\dots]$.",
            "solution": "The problem is valid. It presents a well-posed and scientifically grounded task in the domain of control systems engineering, specifically the stability analysis of a linear time-invariant system with input delay. The provided methods, parameters, and objectives are clear, consistent, and computationally feasible.\n\nThe core of this problem is the application of the Nyquist stability criterion to a closed-loop system. The stability of a linear time-invariant (LTI) system is determined by the locations of the poles of its closed-loop transfer function in the complex $s$-plane. Poles in the right-half plane (RHP) result in an unstable system. The closed-loop characteristic equation is given by $F(s) = 1 + L(s) = 0$, where $L(s)$ is the open-loop transfer function. The roots of $F(s)$ are the closed-loop poles.\n\nThe Nyquist stability criterion, based on Cauchy's Principle of the Argument, provides a graphical method to determine closed-loop stability from the open-loop frequency response. The criterion states that $Z = P - N$, where $Z$ is the number of unstable (RHP) closed-loop poles, $P$ is the number of unstable (RHP) open-loop poles, and $N$ is the number of counter-clockwise encirclements of the critical point ($-1 + j0$) by the Nyquist plot of $L(j\\omega)$. An equivalent formulation, which is used here, considers the encirclements of the origin ($0 + j0$) by the plot of $F(j\\omega) = 1 + L(j\\omega)$.\n\nThe problem specifies that the open-loop transfer function $L(s) = K(s)G(s)D(s)$ has no poles in the RHP. Let us verify this. The controller $K(s) = k$ is a constant and contributes no poles. The plant $G(s) = \\frac{1}{\\tau s + 1}$ has a single pole at $s = -1/\\tau$. Since $\\tau$ is a positive time constant, this pole is in the left-half plane (LHP). The exact delay $D(s) = e^{-sT}$ is a transcendental function and introduces no poles. The Padé approximations, $D_1(s)$ and $D_2(s)$, are rational functions structured as all-pass filters. Their poles are the mirror images of their zeros across the imaginary axis; since their zeros are in the RHP, their poles are in the LHP. Thus, the assumption of $P=0$ is correct.\n\nWith $P=0$, the stability criterion simplifies to $Z = -N$. For the system to be stable, we require $Z=0$, which in turn requires the number of encirclements $N$ to be $0$. The system is stable if and only if the Nyquist plot of $F(j\\omega)$ does not encircle the origin.\n\nThe number of encirclements, or the winding number $N$, is calculated by tracking the total change in the argument (angle) of the complex function $F(j\\omega)$ as the frequency $\\omega$ sweeps along the Nyquist contour. The standard Nyquist contour encloses the entire RHP, consisting of the imaginary axis from $-j\\infty$ to $+j\\infty$ and a large semicircle closing the path on the right. For the given system, $L(s) \\to 0$ as $|s| \\to \\infty$ in the RHP. Consequently, $F(s) = 1 + L(s) \\to 1$. The large semicircle portion of the contour maps to a single point at $1$ and does not contribute to the encirclement of the origin. Therefore, we only need to evaluate the change in phase along the imaginary axis, from $\\omega = -\\infty$ to $\\omega = +\\infty$.\n\nIn practice, we evaluate over a finite but sufficiently large frequency range, $[-\\Omega_{\\max}, \\Omega_{\\max}]$. The winding number $N$ is then calculated as:\n$$\nN = \\frac{1}{2\\pi} \\left[ \\arg(F(j\\omega)) \\right]_{\\omega=-\\Omega_{\\max}}^{\\omega=\\Omega_{\\max}} = \\frac{\\phi(\\Omega_{\\max}) - \\phi(-\\Omega_{\\max})}{2\\pi}\n$$\nwhere $\\phi(\\omega)$ is the unwrapped phase of $F(j\\omega)$. The unwrapping is crucial to correctly accumulate the total angle change across branch cuts of the standard `atan2` function, which typically returns angles in $(-\\pi, \\pi]$. The final result is rounded to the nearest integer.\n\nThe analysis is performed for two representations of the delay:\n1.  **Exact Delay:** The frequency response is $F_{\\text{exact}}(j\\omega) = 1 + L_{\\text{exact}}(j\\omega)$, where\n    $$\n    L_{\\text{exact}}(j\\omega) = k \\cdot \\frac{1}{1 + j \\omega \\tau} \\cdot e^{-j \\omega T}\n    $$\n2.  **Padé Approximation:** The frequency response is $F_{\\text{pade}}(j\\omega) = 1 + L_{\\text{pade}}(j\\omega)$, where\n    $$\n    L_{\\text{pade}}(j\\omega) = k \\cdot \\frac{1}{1 + j \\omega \\tau} \\cdot D_n(j\\omega)\n    $$\n    For $n=1$, the first-order Padé approximation is used:\n    $$\n    D_1(j\\omega) = \\frac{1 - \\frac{j\\omega T}{2}}{1 + \\frac{j\\omega T}{2}}\n    $$\n    For $n=2$, the second-order Padé approximation is used:\n    $$\n    D_2(j\\omega) = \\frac{1 - \\frac{j\\omega T}{2} + \\frac{(j\\omega T)^2}{12}}{1 + \\frac{j\\omega T}{2} + \\frac{(j\\omega T)^2}{12}} = \\frac{\\left(1 - \\frac{(\\omega T)^2}{12}\\right) - j\\frac{\\omega T}{2}}{\\left(1 - \\frac{(\\omega T)^2}{12}\\right) + j\\frac{\\omega T}{2}}\n    $$\n\nThe algorithm proceeds as follows for each test case $(\\tau, k, T, n)$:\n1.  A symmetric frequency grid $\\omega$ is constructed, spanning from $-\\Omega_{\\max}$ to $\\Omega_{\\max}$ with logarithmic spacing on the positive side. The maximum frequency $\\Omega_{\\max} = \\max\\left(\\frac{1000}{\\tau}, \\frac{100}{T + \\varepsilon}\\right)$ is chosen to be large enough to capture the system's relevant dynamics.\n2.  The complex values of $F_{\\text{exact}}(j\\omega)$ and $F_{\\text{pade}}(j\\omega)$ are computed for all frequencies in the grid.\n3.  The `unwrap` function is applied to the arguments of the complex arrays $F_{\\text{exact}}(j\\omega)$ and $F_{\\text{pade}}(j\\omega)$ to obtain the continuous phase profiles.\n4.  The winding numbers $N_{\\text{exact}}$ and $N_{\\text{pade}}$ are computed from the net change in the unwrapped phases, divided by $2\\pi$, and rounded to the nearest integer.\n5.  Stability is determined for each model: `True` if the corresponding winding number is $0$, and `False` otherwise.\n6.  The results $[N_{\\text{exact}}, N_{\\text{pade}}, \\text{stable}_{\\text{exact}}, \\text{stable}_{\\text{pade}}]$ are compiled for all test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Nyquist stability analysis for an LTI system with exact and Padé-approximated delay.\n    \"\"\"\n    test_cases = [\n        # (tau, k, T, n)\n        (0.1, 1.0, 0.02, 1),\n        (0.1, 4.0, 0.3, 1),\n        (0.05, 5.0, 0.0, 1),\n        (0.2, 3.0, 0.5, 2),\n        (0.1, 2.0, 0.2, 2)\n    ]\n\n    all_results = []\n\n    def calculate_stability(tau, k, T, n):\n        \"\"\"\n        Calculates winding numbers and stability for a single test case.\n        \"\"\"\n        # 1. Frequency Grid Construction\n        eps = 1e-9  # Small number to prevent division by zero for T=0 and log(0)\n        omega_max = max(1000.0 / tau, 100.0 / (T + eps))\n        \n        # A dense grid is crucial for np.unwrap to work correctly.\n        # It's also important for the logspace to start at a very small non-zero frequency.\n        num_pos_points = 5000\n        w_start = 1e-6\n        \n        pos_w = np.logspace(np.log10(w_start), np.log10(omega_max), num_pos_points)\n        w = np.concatenate((-pos_w[::-1], np.array([0.0]), pos_w))\n        s = 1j * w\n\n        def get_winding_number(F_jw):\n            \"\"\"Computes the winding number N for a given frequency response F(jω).\"\"\"\n            # Calculate the angle of the complex numbers\n            angles = np.angle(F_jw)\n            \n            # Unwrap the angle to get the continuous phase profile\n            unwrapped_angles = np.unwrap(angles)\n            \n            # Net change in angle is the difference between the last and first value\n            net_angle_change = unwrapped_angles[-1] - unwrapped_angles[0]\n            \n            # Winding number is the net change divided by 2*pi, rounded to nearest integer\n            winding_number = np.round(net_angle_change / (2.0 * np.pi))\n            \n            return int(winding_number)\n\n        # 2. Plant Frequency Response G(jω)\n        G_jw = 1.0 / (tau * s + 1.0)\n\n        # 3. Exact Delay Case\n        D_jw_exact = np.exp(-s * T)\n        F_jw_exact = 1.0 + k * G_jw * D_jw_exact\n        N_exact = get_winding_number(F_jw_exact)\n        stable_exact = (N_exact == 0)\n\n        # 4. Padé Approximation Case\n        if n == 1:\n            # First-order Padé approximation\n            numerator = 1.0 - s * T / 2.0\n            denominator = 1.0 + s * T / 2.0\n        elif n == 2:\n            # Second-order Padé approximation\n            st_term = s * T\n            numerator = 1.0 - st_term / 2.0 + (st_term**2) / 12.0\n            denominator = 1.0 + st_term / 2.0 + (st_term**2) / 12.0\n        else:\n            # This case will not be reached based on the problem description\n            raise ValueError(f\"Unsupported Padé order n={n}\")\n        \n        D_jw_pade = numerator / denominator\n        F_jw_pade = 1.0 + k * G_jw * D_jw_pade\n        N_pade = get_winding_number(F_jw_pade)\n        stable_pade = (N_pade == 0)\n\n        return [N_exact, N_pade, stable_exact, stable_pade]\n\n    for case in test_cases:\n        result = calculate_stability(*case)\n        all_results.append(result)\n\n    # Format the final output as a string representing a Python list of lists.\n    print(f\"[[{','.join(str(r) for r in all_results[0])}],[{','.join(str(r) for r in all_results[1])}],[{','.join(str(r) for r in all_results[2])}],[{','.join(str(r) for r in all_results[3])}],[{','.join(str(r) for r in all_results[4])}]]\")\n\nsolve()\n```"
        }
    ]
}