{
    "hands_on_practices": [
        {
            "introduction": "Lyapunov 第二方法是稳定性理论的基石，它允许我们在不显式求解系统微分或差分方程的情况下评估其稳定性。这个练习  提供了离散时间 Lyapunov 方程的实践机会。通过构造一个二次 Lyapunov 函数，你不仅将证明一个给定系统的稳定性，还将通过推导一个确定的收敛速率来量化其性能，从而将抽象理论与具体的性能指标联系起来。",
            "id": "3930077",
            "problem": "一个双室生物医学控制回路（例如，动脉压和自主控制信号的耦合偏差）中，围绕一个稳态工作点的小偏差的离散时间线性时不变（LTI）模型由状态动力学 $x_{k+1} = A x_{k}$ 给出，其中 $x_{k} \\in \\mathbb{R}^{2}$ 是以固定周期采样的偏差状态向量。围绕平衡点的线性化和采样产生了矩阵\n$$\nA = \\begin{pmatrix}\n0.85  0.10 \\\\\n-0.05  0.90\n\\end{pmatrix}.\n$$\n从离散时间线性系统的稳定性和李雅普诺夫函数的核心定义出发，利用舒尔稳定性（Schur stability）的概念（即 $A$ 的所有特征值都严格位于单位圆盘内），并构造一个二次李雅普诺夫候选函数 $V(x) = x^{\\top} P x$，其中 $P \\succ 0$。通过要求 $A^{\\top} P A - P = -Q$（其中选择 $Q \\succ 0$），施加离散时间李雅普诺夫条件，使得差值 $V(x_{k+1}) - V(x_{k})$ 是负定的。取\n$$\nQ = I_2.\n$$\n按以下步骤进行：\n- 从第一性原理出发，论证为何如果 $A$ 是舒尔稳定的，对于任意给定的 $Q \\succ 0$，都存在一个唯一的 $P \\succ 0$ 来求解离散时间李雅普诺夫方程。\n- 求解 $A^{\\top} P A - P = -Q$ 以得到对称矩阵 $P \\in \\mathbb{R}^{2 \\times 2}$。\n- 使用关联 $x^{\\top} Q x$ 和 $x^{\\top} P x$ 的特征值界，推导出一个保证的每步收缩因子 $r \\in (0,1)$，使得对于所有 $x \\in \\mathbb{R}^{2}$，都有 $V(x_{k+1}) \\leq r \\, V(x_{k})$ 成立。\n- 计算你找到的 $P$ 所对应的 $r$ 的数值。\n\n将最终的每步收缩因子表示为四舍五入到四位有效数字的小数（无单位）。",
            "solution": "在尝试给出解答之前，用户提供的问题都经过了严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **系统动力学**：一个离散时间线性时不变（LTI）系统由 $x_{k+1} = A x_{k}$ 描述，其中 $x_{k} \\in \\mathbb{R}^{2}$。\n- **系统矩阵**：状态矩阵为 $A = \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix}$。\n- **李雅普诺夫候选函数**：$V(x) = x^{\\top} P x$，条件为 $P$ 是一个对称正定矩阵（$P = P^{\\top} \\succ 0$）。\n- **李雅普诺夫方程**：李雅普诺夫函数的变化受离散时间李雅普诺夫方程 $A^{\\top} P A - P = -Q$ 的约束。\n- **权重矩阵**：矩阵 $Q$ 被选为 $2 \\times 2$ 的单位矩阵，即 $Q = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n- **目标**：\n    1.  证明对于一个舒尔稳定的矩阵 $A$，李雅普诺夫方程对于任意正定矩阵 $Q$ 都有一个唯一的正定解 $P$。\n    2.  求解李雅普诺夫方程以得到矩阵 $P$。\n    3.  推导一个保证的每步收缩因子 $r \\in (0,1)$，使得 $V(x_{k+1}) \\leq r \\, V(x_{k})$。\n    4.  计算 $r$ 的数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当，且目标明确。这是离散时间系统李雅普诺夫稳定性理论中的一个标准练习。为确认其提法得当，我们必须验证矩阵 $A$ 是舒尔稳定的（即其所有特征值都严格位于复平面的单位圆内）。\n\n$A$ 的特征方程为 $\\det(A - \\lambda I) = 0$。\n$$\n\\det\\left( \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = 0\n$$\n$$\n(0.85 - \\lambda)(0.90 - \\lambda) - (0.10)(-0.05) = 0\n$$\n$$\n\\lambda^2 - (0.85 + 0.90)\\lambda + (0.85)(0.90) + 0.005 = 0\n$$\n$$\n\\lambda^2 - 1.75\\lambda + 0.765 + 0.005 = 0\n$$\n$$\n\\lambda^2 - 1.75\\lambda + 0.77 = 0\n$$\n该二次方程的判别式为 $\\Delta = (-1.75)^2 - 4(1)(0.77) = 3.0625 - 3.08 = -0.0175  0$。\n由于判别式为负，特征值为一对共轭复数。对于一个具有共轭复数特征值 $\\lambda$ 和 $\\bar{\\lambda}$ 的 $2 \\times 2$ 矩阵，特征值模长的平方等于矩阵的行列式，即 $|\\lambda|^2 = \\det(A)$。\n行列式为 $\\det(A) = (0.85)(0.90) - (0.10)(-0.05) = 0.77$。\n因此，特征值的模为 $|\\lambda| = \\sqrt{0.77} \\approx 0.8775$。\n由于 $|\\lambda|  1$，两个特征值都严格位于单位圆盘内部。矩阵 $A$ 是舒尔稳定的。\n\n该问题是自洽的，科学上是合理的，并且提供了所有必需的数据。不存在矛盾或模糊之处。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n**1. 解 P 的存在性与唯一性**\n\n离散时间李雅普诺夫方程为 $A^{\\top} P A - P = -Q$。该方程对矩阵 $P$ 的元素是线性的。可以使用克罗内克积 $\\otimes$ 将其写成向量化形式。令 $p = \\text{vec}(P)$ 和 $q = \\text{vec}(Q)$。方程变为：\n$$\n(A^{\\top} \\otimes A^{\\top}) p - p = -q \\implies (I - A^{\\top} \\otimes A^{\\top}) p = q\n$$\n当且仅当矩阵 $(I - A^{\\top} \\otimes A^{\\top})$ 可逆时，$p$（以及 $P$）存在唯一解。这要求该矩阵的特征值均不为零。\n克罗内克积 $M \\otimes N$ 的特征值是矩阵 $M$ 和 $N$ 特征值的乘积。设 $A$（和 $A^{\\top}$）的特征值为 $\\lambda_1, \\dots, \\lambda_n$。那么 $A^{\\top} \\otimes A^{\\top}$ 的特征值为所有数对 $i, j \\in \\{1, \\dots, n\\}$ 对应的 $\\lambda_i \\lambda_j$。\n因此，矩阵 $(I - A^{\\top} \\otimes A^{\\top})$ 的特征值为 $1 - \\lambda_i \\lambda_j$。该矩阵可逆当且仅当对于所有的 $i, j$ 都有 $1 - \\lambda_i \\lambda_j \\neq 0$。这等价于 $\\lambda_i \\lambda_j \\neq 1$。\n矩阵 $A$ 是舒尔稳定的条件意味着对所有 $k$ 都有 $|\\lambda_k|  1$。这意味着 $|\\lambda_i \\lambda_j| = |\\lambda_i||\\lambda_j|  1 \\times 1 = 1$。因此，$\\lambda_i \\lambda_j$ 永远不可能等于 $1$。所以，对于舒尔稳定的矩阵 $A$，李雅普诺夫方程存在唯一的解 $P$。\n\n为证明当 $Q \\succ 0$ 时，这个唯一解 $P$ 是正定的（$P \\succ 0$），我们可以将 $P$ 表示为一个无穷级数。从 $P = A^{\\top} P A + Q$，我们可以迭代：\n$$\nP = A^{\\top}(A^{\\top} P A + Q)A + Q = (A^{\\top})^2 P A^2 + A^{\\top} Q A + Q\n$$\n继续这个迭代 $k-1$ 次，得到：\n$$\nP = (A^{\\top})^k P A^k + \\sum_{j=0}^{k-1} (A^{\\top})^j Q A^j\n$$\n由于 $A$ 是舒尔稳定的，$\\lim_{k \\to \\infty} A^k = 0$。因此，项 $(A^{\\top})^k P A^k$ 在极限情况下消失。唯一解 $P$ 由收敛级数给出：\n$$\nP = \\sum_{j=0}^{\\infty} (A^{\\top})^j Q A^j\n$$\n为了证明 $P$ 是正定的，考虑对于任意非零向量 $x \\in \\mathbb{R}^n$ 的二次型 $x^{\\top} P x$：\n$$\nx^{\\top} P x = x^{\\top} \\left( \\sum_{j=0}^{\\infty} (A^{\\top})^j Q A^j \\right) x = \\sum_{j=0}^{\\infty} x^{\\top} (A^{\\top})^j Q A^j x = \\sum_{j=0}^{\\infty} (A^j x)^{\\top} Q (A^j x)\n$$\n由于 $Q \\succ 0$，级数中的每一项 $(A^j x)^{\\top} Q (A^j x)$ 都是非负的。要使和为正，至少要有一项是严格为正的。第一项（$j=0$）是 $x^{\\top} Q x$。因为 $x \\neq 0$ 且 $Q \\succ 0$，我们有 $x^{\\top} Q x > 0$。因此，对于所有 $x \\neq 0$，都有 $x^{\\top} P x > 0$，这证明了 $P$ 是正定的。\n\n**2. 求解矩阵 P**\n\n设待求的对称矩阵为 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$。方程 $A^{\\top} P A - P = -I$ 导出了一个关于 $P$ 元素的线性方程组。\n$$\n\\begin{pmatrix} 0.85  -0.05 \\\\ 0.10  0.90 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0.85  0.10 \\\\ -0.05  0.90 \\end{pmatrix} - \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n执行矩阵乘法并令对应元素相等，得到以下三个唯一的线性方程组成的方程组：\n\\begin{enumerate}\n    \\item (1,1)元素: $0.7225p_{11} - 0.085p_{12} + 0.0025p_{22} - p_{11} = -1 \\implies -0.2775p_{11} - 0.085p_{12} + 0.0025p_{22} = -1$\n    \\item (1,2)元素: $0.085p_{11} + 0.76p_{12} - 0.045p_{22} - p_{12} = 0 \\implies 0.085p_{11} - 0.24p_{12} - 0.045p_{22} = 0$\n    \\item (2,2)元素: $0.01p_{11} + 0.18p_{12} + 0.81p_{22} - p_{22} = -1 \\implies 0.01p_{11} + 0.18p_{12} - 0.19p_{22} = -1$\n\\end{enumerate}\n通过乘以常数，该方程组可以写得更简洁：\n\\begin{enumerate}\n    \\item $111 p_{11} + 34 p_{12} - p_{22} = 400$\n    \\item $17 p_{11} - 48 p_{12} - 9 p_{22} = 0$\n    \\item $p_{11} + 18 p_{12} - 19 p_{22} = -100$\n\\end{enumerate}\n解此线性方程组，得到精确解：\n$$\np_{11} = \\frac{58125}{16192}, \\quad p_{12} = \\frac{3425}{16192}, \\quad p_{22} = \\frac{91525}{16192}\n$$\n所以，矩阵 $P$ 为：\n$$\nP = \\frac{1}{16192} \\begin{pmatrix} 58125  3425 \\\\ 3425  91525 \\end{pmatrix}\n$$\n\n**3. 收缩因子的推导**\n\n李雅普诺夫函数为 $V(x_k) = x_k^{\\top} P x_k$。其值在一步内的变化为：\n$$\nV(x_{k+1}) - V(x_k) = x_{k+1}^{\\top} P x_{k+1} - x_k^{\\top} P x_k = (Ax_k)^{\\top}P(Ax_k) - x_k^{\\top}P x_k = x_k^{\\top}(A^{\\top}PA - P)x_k\n$$\n使用李雅普诺夫方程 $A^{\\top}PA - P = -Q = -I$，我们有：\n$$\nV(x_{k+1}) - V(x_k) = -x_k^{\\top} I x_k = -x_k^{\\top}x_k = -\\|x_k\\|^2\n$$\n这得到 $V(x_{k+1}) = V(x_k) - \\|x_k\\|^2$。我们寻求一个因子 $r$ 使得 $V(x_{k+1}) \\leq r V(x_k)$。这等价于找到比率 $\\frac{V(x_{k+1})}{V(x_k)}$ 的一个上界。\n$$\n\\frac{V(x_{k+1})}{V(x_k)} = \\frac{V(x_k) - \\|x_k\\|^2}{V(x_k)} = 1 - \\frac{\\|x_k\\|^2}{x_k^{\\top} P x_k}\n$$\n为了找到一个对所有非零 $x_k$ 都有效的保证收缩因子 $r$，我们必须最大化这个比率。这可以通过最小化被减去的项来实现：\n$$\nr = \\max_{x_k \\neq 0} \\left( 1 - \\frac{\\|x_k\\|^2}{x_k^{\\top} P x_k} \\right) = 1 - \\min_{x_k \\neq 0} \\frac{\\|x_k\\|^2}{x_k^{\\top} P x_k} = 1 - \\min_{x_k \\neq 0} \\frac{x_k^{\\top} I x_k}{x_k^{\\top} P x_k}\n$$\n广义瑞利商 $\\frac{x^{\\top}Qx}{x^{\\top}Px}$ 的最小值是矩阵束 $(Q,P)$ 的最小特征值，即 $\\lambda_{\\min}(P^{-1}Q)$。由于 $Q=I$，这等于 $\\lambda_{\\min}(P^{-1})$。逆矩阵的特征值是原矩阵特征值的倒数。因此，$\\lambda_{\\min}(P^{-1}) = \\frac{1}{\\lambda_{\\max}(P)}$。\n将此代入 $r$ 的表达式中：\n$$\nr = 1 - \\frac{1}{\\lambda_{\\max}(P)}\n$$\n\n**4. r 数值的计算**\n\n首先，我们必须求出矩阵 $P$ 的特征值。$P$ 的特征值 $\\lambda$ 是特征方程 $\\det(P - \\lambda I) = 0$ 的根。\n$$\n\\lambda^2 - \\text{tr}(P)\\lambda + \\det(P) = 0\n$$\n$P$ 的迹和行列式为：\n$$\n\\text{tr}(P) = p_{11} + p_{22} = \\frac{58125 + 91525}{16192} = \\frac{149650}{16192} \\approx 9.24218\n$$\n$$\n\\det(P) = p_{11}p_{22} - p_{12}^2 = \\frac{58125 \\times 91525 - 3425^2}{16192^2} = \\frac{5308778750}{262180864} \\approx 20.25615\n$$\n特征值为 $\\lambda = \\frac{\\text{tr}(P) \\pm \\sqrt{\\text{tr}(P)^2 - 4\\det(P)}}{2}$。最大特征值为：\n$$\n\\lambda_{\\max}(P) = \\frac{\\text{tr}(P) + \\sqrt{\\text{tr}(P)^2 - 4\\det(P)}}{2}\n$$\n对此进行数值计算，得到：\n$$\n\\lambda_{\\max}(P) \\approx 5.67490\n$$\n$$\n\\lambda_{\\min}(P) \\approx 3.56728\n$$\n收缩因子 $r$ 为：\n$$\nr = 1 - \\frac{1}{\\lambda_{\\max}(P)} \\approx 1 - \\frac{1}{5.67490} \\approx 1 - 0.1762145\n$$\n$$\nr \\approx 0.8237855\n$$\n四舍五入到四位有效数字，我们得到 $r = 0.8238$。",
            "answer": "$$\n\\boxed{0.8238}\n$$"
        },
        {
            "introduction": "在频率域中，劳斯-赫尔维茨（Routh-Hurwitz）判据提供了一种强大的代数方法，通过检查线性时不变系统特征多项式的系数来确定其稳定性。这种方法避免了直接求解多项式根的困难任务。此练习  将挑战你将此判据应用于一个更复杂的场景，该场景涉及一个带有通信延迟的信息物理系统，你将学习如何处理符号参数（如控制器增益 $k$），并确定临界稳定性的精确条件，这是控制器设计与整定中的一项关键技能。",
            "id": "4247112",
            "problem": "一个信息物理系统 (CPS) 的网络化数字孪生围绕一个物理被控对象构建了一个比例反馈闭环，该闭环受到孪生体与被控对象之间的双向通信延迟影响。前向通路包含一个比例增益 $k$ 和被控对象传递函数 $G(s)$，而反馈通路为单位反馈。环路通信延迟通过标准的一阶 Padé 近似模型来建模，并置于前向通路中，用于表示时间延迟。被控对象模型为一个带有积分环节和在 $-2$ 处的重复极点的级联执行机构，其传递函数为 $G(s) = \\frac{1}{s(s+2)^2}$。环路延迟为 $\\tau = 1$ 秒。使用一阶 Padé 近似 $ \\exp(-s \\tau) \\approx \\frac{1 - \\frac{s \\tau}{2}}{1 + \\frac{s \\tau}{2}} $。\n\n仅从 (i) 单位反馈闭环特征方程的定义，(ii) 上述一阶 Padé 近似，以及 (iii) 通过 Routh 阵列第一列符号结构来解释的 Routh-Hurwitz 稳定性判据出发，完成以下任务：\n\n- 推导以 $k$ 表示的四阶特征多项式 $p(s)$。\n- 构建 $p(s)$ 的符号 Routh 阵列，以 $k$ 表示。\n- 解释第一列元素的符号结构以陈述稳定性条件，并说明符号变化如何与右半平面根的数量相关。\n- 识别 Routh 阵列中整行变为零的特殊情况条件，解释相关的辅助多项式，并用它来描述具有纯虚根的临界稳定状态。\n- 确定出现这种特殊情况临界稳定时的比例增益 $k$ 的精确解析表达式。\n\n将最终答案表示为包含根式的精确解析表达式。不需要进行数值四舍五入。增益 $k$ 是无量纲的；最终答案中不要包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 系统：具有比例反馈的信息物理系统（CPS）的网络化数字孪生。\n- 反馈通路：单位反馈。\n- 前向通路组件：比例增益 $k$、被控对象 $G(s)$ 和通信延迟。\n- 被控对象传递函数：$G(s) = \\frac{1}{s(s+2)^2}$。\n- 通信延迟：环路延迟 $\\tau = 1$ 秒，在前向通路中建模。\n- 延迟近似：一阶 Padé 近似，$ \\exp(-s \\tau) \\approx \\frac{1 - \\frac{s \\tau}{2}}{1 + \\frac{s \\tau}{2}} $。\n- 任务：使用 Routh-Hurwitz 稳定性判据求出临界稳定时的精确比例增益 $k$。\n- 出发点：\n    (i) 单位反馈闭环特征方程的定义。\n    (ii) 指定的一阶 Padé 近似。\n    (iii) 通过 Routh 阵列的符号结构来解释的 Routh-Hurwitz 判据。\n- 要求步骤：\n    1. 推导四阶特征多项式 $p(s)$。\n    2. 构建 $p(s)$ 的符号 Routh 阵列。\n    3. 根据阵列的符号结构陈述稳定性条件。\n    4. 分析零行和辅助多项式的特殊情况。\n    5. 确定临界稳定时的 $k$ 的精确解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于线性控制理论，这是工程学和应用数学中的一个核心学科。被控对象模型、使用 Padé 近似处理时间延迟以及 Routh-Hurwitz 判据都是标准的、公认的概念。该问题在科学上是现实且合理的。\n- **适定性：** 该问题提供了所有必要的信息（传递函数、延迟值、近似方法）和一个明确的目标。所要求的步骤构成了一条通向稳定边界的唯一、有意义的解的逻辑路径。\n- **客观性：** 语言精确、量化，没有任何主观性或偏见。\n- **其他标准：** 该问题是完整的、一致的、可行的且非平凡的。它需要严格应用基本原理来解决。\n\n**第3步：结论与行动**\n该问题被判定为 **有效**。现在开始求解过程。\n\n### 求解推导\n\n分析首先从构建闭环系统的特征方程开始。开环传递函数 $L(s)$ 是增益 $k$、延迟的 Padé 近似 $P(s)$ 和被控对象传递函数 $G(s)$ 的乘积。\n\n延迟 $\\tau = 1$ 秒的一阶 Padé 近似为：\n$$ P(s) = \\frac{1 - \\frac{s(1)}{2}}{1 + \\frac{s(1)}{2}} = \\frac{1 - \\frac{s}{2}}{1 + \\frac{s}{2}} = \\frac{2-s}{2+s} $$\n开环传递函数为：\n$$ L(s) = k \\cdot P(s) \\cdot G(s) = k \\left( \\frac{2-s}{2+s} \\right) \\left( \\frac{1}{s(s+2)^2} \\right) $$\n单位反馈系统的特征方程为 $1 + L(s) = 0$。\n$$ 1 + k \\left( \\frac{2-s}{2+s} \\right) \\left( \\frac{1}{s(s+2)^2} \\right) = 0 $$\n为了得到特征多项式 $p(s)$，我们消去分母：\n$$ s(s+2)^2(s+2) + k(2-s) = 0 $$\n$$ s(s+2)^3 + k(2-s) = 0 $$\n展开多项式：\n$$ s(s^3 + 3s^2(2) + 3s(2^2) + 2^3) + 2k - ks = 0 $$\n$$ s(s^3 + 6s^2 + 12s + 8) + 2k - ks = 0 $$\n$$ s^4 + 6s^3 + 12s^2 + 8s + 2k - ks = 0 $$\n特征多项式 $p(s)$ 为：\n$$ p(s) = s^4 + 6s^3 + 12s^2 + (8-k)s + 2k = 0 $$\n这就是所求的四阶多项式，其系数为 $a_4=1$、$a_3=6$、$a_2=12$、$a_1=8-k$ 和 $a_0=2k$。\n\n接下来，我们为 $p(s)$ 构建 Routh 阵列以分析其稳定性。\n阵列构建如下：\n$$\n\\begin{array}{c|ccc}\ns^4   a_4  a_2  a_0 \\\\\ns^3   a_3  a_1  0 \\\\\ns^2   b_1  b_2  0 \\\\\ns^1   c_1  0  0 \\\\\ns^0   d_1  0  0\n\\end{array}\n\\quad \\Rightarrow \\quad\n\\begin{array}{c|ccc}\ns^4   1  12  2k \\\\\ns^3   6  8-k  0 \\\\\ns^2   b_1  b_2  0 \\\\\ns^1   c_1  0  0 \\\\\ns^0   d_1  0  0\n\\end{array}\n$$\n元素 $b_1, b_2, c_1, d_1$ 以 $k$ 的符号形式计算如下：\n$$ b_1 = \\frac{a_3 a_2 - a_4 a_1}{a_3} = \\frac{(6)(12) - (1)(8-k)}{6} = \\frac{72 - 8 + k}{6} = \\frac{64+k}{6} $$\n$$ b_2 = \\frac{a_3 a_0 - a_4 (0)}{a_3} = a_0 = 2k $$\n$$ c_1 = \\frac{b_1 a_1 - a_3 b_2}{b_1} = \\frac{(\\frac{64+k}{6})(8-k) - (6)(2k)}{\\frac{64+k}{6}} = \\frac{(64+k)(8-k) - 72k}{64+k} $$\n$c_1$ 的分子是 $(64+k)(8-k) - 72k = 512 + 8k - 64k - k^2 - 72k = -k^2 - 128k + 512$。\n$$ c_1 = \\frac{-k^2 - 128k + 512}{64+k} $$\n$$ d_1 = \\frac{c_1 b_2 - b_1(0)}{c_1} = b_2 = 2k $$\n完整的符号 Routh 阵列表为：\n$$\n\\begin{array}{c|c}\ns^4   1 \\\\\ns^3   6 \\\\\ns^2   \\frac{64+k}{6} \\\\\ns^1   \\frac{-k^2 - 128k + 512}{64+k} \\\\\ns^0   2k\n\\end{array}\n$$\n\n为了使系统稳定，Routh-Hurwitz 判据要求 Routh 阵列第一列的所有元素均为正。该列的符号变化次数等于 $p(s)$ 在复平面右半部分（RHP）的根的数量。\n1.  $1 > 0$（满足）。\n2.  $6 > 0$（满足）。\n3.  $2k > 0 \\implies k > 0$。\n4.  $\\frac{64+k}{6} > 0 \\implies 64+k > 0 \\implies k > -64$。结合前一个条件，我们需要 $k>0$。\n5.  $\\frac{-k^2 - 128k + 512}{64+k} > 0$。由于条件4意味着 $64+k > 0$，我们需要分子为正：\n    $$ -k^2 - 128k + 512 > 0 \\implies k^2 + 128k - 512  0 $$\n为了找到满足此不等式的 $k$ 的范围，我们使用二次公式求解 $k^2 + 128k - 512 = 0$ 的根：\n$$ k = \\frac{-128 \\pm \\sqrt{128^2 - 4(1)(-512)}}{2} = \\frac{-128 \\pm \\sqrt{16384 + 2048}}{2} $$\n$$ k = \\frac{-128 \\pm \\sqrt{18432}}{2} $$\n为简化根式，我们分解 $18432$：$18432 = 9216 \\times 2 = (96)^2 \\times 2$。因此，$\\sqrt{18432} = 96\\sqrt{2}$。\n$$ k = \\frac{-128 \\pm 96\\sqrt{2}}{2} = -64 \\pm 48\\sqrt{2} $$\n二次函数 $k^2 + 128k - 512$ 是一个开口向上的抛物线，因此它在两根之间为负。稳定性条件是：\n$$ -64 - 48\\sqrt{2}  k  -64 + 48\\sqrt{2} $$\n为了保证稳定，所有条件必须同时成立。$k > 0$ 和 $-64-48\\sqrt{2}  k  -64+48\\sqrt{2}$ 的交集是：\n$$ 0  k  -64 + 48\\sqrt{2} $$\n\n当 Routh 阵列的整行变为零时，出现具有纯虚根的临界稳定特殊情况。如果 $s^1$ 行唯一的非零元素 $c_1$ 变为零，就会发生这种情况。\n$$ c_1 = \\frac{-k^2 - 128k + 512}{64+k} = 0 $$\n这要求分子为零：\n$$ -k^2 - 128k + 512 = 0 \\implies k^2 + 128k - 512 = 0 $$\n该方程的根是 $k = -64 \\pm 48\\sqrt{2}$。这些是处于稳定边界上的 $k$ 值。由于物理增益 $k$ 必须为正才能稳定（如 $s^0$ 行元素 $2k > 0$ 所示），因此临界稳定时的增益是正根：\n$$ k_{marginal} = -64 + 48\\sqrt{2} $$\n在这个 $k$ 值下，$s^1$ 行为零。位于虚轴上的根可以从辅助多项式 $A(s)$ 中求出，该多项式由零行正上方一行（即 $s^2$ 行）的系数构成。\n$$ A(s) = b_1 s^2 + b_2 = \\left(\\frac{64+k}{6}\\right)s^2 + 2k $$\n在 $k = k_{marginal}$ 时，$A(s)=0$ 的根给出了 $p(s)$ 的纯虚根。将 $k = -64 + 48\\sqrt{2}$ 代入 $A(s)$：\n$s^2 = -\\frac{12k}{64+k} = -\\frac{12(-64+48\\sqrt{2})}{64+(-64+48\\sqrt{2})} = -\\frac{12(-64+48\\sqrt{2})}{48\\sqrt{2}} = -\\frac{-64+48\\sqrt{2}}{4\\sqrt{2}}$\n$s^2 = -(-\\frac{16}{\\sqrt{2}} + 12) = -(-8\\sqrt{2} + 12) = 8\\sqrt{2} - 12$。\n由于 $8\\sqrt{2} \\approx 8(1.414) = 11.312$， $s^2$ 的值为负 ($11.312 - 12 = -0.688$)，证实存在一对纯虚根 $s = \\pm j\\sqrt{12 - 8\\sqrt{2}}$，它们会导致持续振荡。\n\n问题要求的是出现这种特殊情况临界稳定时的比例增益 $k$ 的精确解析表达式。这就是使 Routh 阵列的 $s^1$ 行变零的 $k$ 的正值。\n$$ k = -64 + 48\\sqrt{2} $$",
            "answer": "$$\\boxed{-64 + 48\\sqrt{2}}$$"
        },
        {
            "introduction": "虽然像劳斯-赫尔维茨这样的代数方法对于由有理传递函数描述的系统非常有效，但它们不能直接处理像纯时间延迟这样的超越元。奈奎斯特（Nyquist）稳定性判据基于复分析中的辐角原理，提供了一种更通用、更直观的图形化方法，尤其擅长处理此类情况。这个计算练习  将指导你通过实施奈奎斯特判据来分析一个带有时延的系统，并将精确时延模型与 Padé 近似模型的稳定性结果进行比较，为现代控制工程中常见建模技术的保真度和计算分析的强大功能提供宝贵的见解。",
            "id": "4247062",
            "problem": "考虑一个信息物理系统（CPS）数字孪生中的线性时不变开环执行器通道，该通道具有输入到执行器的延迟。开环传递函数定义为 $L(s) = K(s) G(s) D(s)$，其中 $s$ 是拉普拉斯复变量。控制器是比例控制器，由 $K(s) = k$ 给出；执行器对象是一阶的，由 $G(s) = \\frac{1}{\\tau s + 1}$ 给出，其中 $\\tau$ 是以秒为单位的正时间常数。延迟 $D(s)$ 要么是精确的指数形式 $e^{-sT}$（其中 $T$ 是以秒为单位的非负延迟），要么是 n 阶有理帕德近似 $D_n(s)$。为了进行计算比较，使用一阶帕德近似 $D_1(s) = \\frac{1 - \\frac{sT}{2}}{1 + \\frac{sT}{2}}$ 和二阶帕德近似 $D_2(s) = \\frac{1 - \\frac{sT}{2} + \\frac{(sT)^2}{12}}{1 + \\frac{sT}{2} + \\frac{(sT)^2}{12}}$。闭环特征函数为 $F(s) = 1 + L(s)$。\n\n您的任务是实现一个程序，对精确延迟和帕德近似延迟进行奈奎斯特稳定性分析。该分析必须基于辐角原理：对临界点的顺时针环绕次数等于沿着奈奎斯特围线的辐角净变化量除以 $2\\pi$。具体来说，评估 $F(s)$ 下虚轴的像（对于实频率 $\\omega$，$j$ 是虚数单位，其像由 $F(j\\omega)$ 给出），并计算 $F(j\\omega)$ 关于原点的绕数，以推断闭环稳定性。角度必须以弧度计算。\n\n对于每个测试用例，执行以下操作：\n- 对于一个跨越 $\\omega \\in [-\\Omega_{\\max}, \\Omega_{\\max}]$ 的频率网格，评估 $F_{\\text{exact}}(j\\omega) = 1 + k \\frac{1}{1 + j \\omega \\tau} e^{-j \\omega T}$，并计算 $F_{\\text{exact}}(j\\omega)$ 沿从 $-\\Omega_{\\max}$ 到 $\\Omega_{\\max}$ 的路径展开后的净辐角变化量，然后除以 $2\\pi$ 并四舍五入到最接近的整数，以获得绕数 $N_{\\text{exact}}$。\n- 对于相同的网格，评估 $F_{\\text{pade}}(j\\omega) = 1 + k \\frac{1}{1 + j \\omega \\tau} D_n(j\\omega)$ 并以类似方式计算 $N_{\\text{pade}}$。\n- 假设对于精确延迟和给定的帕德近似，开环 $L(s)$ 没有右半平面极点（对于指定的对象和帕德阶数，这是成立的）。通过检查相应的绕数是否为零，将每个表示的闭环稳定性判断为布尔值，即如果整数绕数等于 $0$ 则稳定，否则不稳定。\n- 使用弧度作为角度单位。输出中不需要物理单位，因为要求的输出是布尔值和整数。\n\n频率网格规范：\n- 构建一个对称的频率网格，该网格包含 $0$ 并跨越负频率到正频率，在正半轴上使用对数间距，并镜像到负半轴。令 $\\Omega_{\\max} = \\max\\left(\\frac{1000}{\\tau}, \\frac{100}{T + \\varepsilon}\\right)$，其中 $\\varepsilon$ 是一个小的正数以避免当 $T = 0$ 时出现除零错误，并在正半轴上至少使用 $400$ 个点。通过沿从 $-\\Omega_{\\max}$ 到 $\\Omega_{\\max}$ 的有序网格展开 $F(j\\omega)$ 的角度来确保数值鲁棒性。\n\n测试套件：\n- 情况 1：$(\\tau, k, T, n) = (0.1 \\text{ s}, 1.0, 0.02 \\text{ s}, 1)$\n- 情况 2：$(\\tau, k, T, n) = (0.1 \\text{ s}, 4.0, 0.3 \\text{ s}, 1)$\n- 情况 3：$(\\tau, k, T, n) = (0.05 \\text{ s}, 5.0, 0.0 \\text{ s}, 1)$\n- 情况 4：$(\\tau, k, T, n) = (0.2 \\text{ s}, 3.0, 0.5 \\text{ s}, 2)$\n- 情况 5：$(\\tau, k, T, n) = (0.1 \\text{ s}, 2.0, 0.2 \\text{ s}, 2)$\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表。对于每个测试用例，报告一个包含四个条目的列表：整数 $N_{\\text{exact}}$、整数 $N_{\\text{pade}}$、精确延迟稳定性的布尔值和帕德近似稳定性的布尔值。最终输出应类似于 Python 风格的列表嵌套列表，例如 $[[0,0,True,True],[\\dots],\\dots]$。",
            "solution": "该问题是有效的。它在控制系统工程领域，特别是针对带输入延迟的线性时不变系统的稳定性分析，提出了一个提法恰当且具有科学依据的任务。所提供的方法、参数和目标清晰、一致且计算上可行。\n\n这个问题的核心是将奈奎斯特稳定性判据应用于一个闭环系统。线性时不变（LTI）系统的稳定性由其闭环传递函数在复 $s$ 平面中的极点位置决定。位于右半平面（RHP）的极点会导致系统不稳定。闭环特征方程由 $F(s) = 1 + L(s) = 0$ 给出，其中 $L(s)$ 是开环传递函数。$F(s)$ 的根即为闭环极点。\n\n基于柯西辐角原理的奈奎斯特稳定性判据提供了一种从开环频率响应确定闭环稳定性的图解法。该判据指出 $Z = P - N$，其中 Z 是不稳定（RHP）闭环极点的数量，P 是不稳定（RHP）开环极点的数量，N 是 $L(j\\omega)$ 的奈奎斯特图对临界点（$-1 + j0$）的逆时针环绕次数。这里使用的一种等效表述是考虑 $F(j\\omega) = 1 + L(j\\omega)$ 的图像对原点 ($0 + j0$) 的环绕。\n\n问题指明开环传递函数 $L(s) = K(s)G(s)D(s)$ 在 RHP 中没有极点。我们来验证这一点。控制器 $K(s) = k$ 是一个常数，不产生任何极点。对象 $G(s) = \\frac{1}{\\tau s + 1}$ 有一个位于 $s = -1/\\tau$ 的单极点。由于 $\\tau$ 是一个正的时间常数，该极点位于左半平面（LHP）。精确延迟 $D(s) = e^{-sT}$ 是一个超越函数，不引入任何极点。帕德近似 $D_1(s)$ 和 $D_2(s)$ 是构造为全通滤波器的有理函数。其极点是其零点跨虚轴的镜像；由于其零点在 RHP，所以其极点在 LHP。因此，$P=0$ 的假设是正确的。\n\n在 $P=0$ 的情况下，稳定性判据简化为 $Z = -N$。为使系统稳定，我们需要 $Z=0$，这又要求环绕次数 $N$ 为 $0$。当且仅当 $F(j\\omega)$ 的奈奎斯特图不环绕原点时，系统是稳定的。\n\n环绕次数，即绕数 $N$，是通过追踪复变函数 $F(j\\omega)$ 的辐角（角度）在频率 $\\omega$ 沿奈奎斯特围线扫描时的总变化量来计算的。标准奈奎斯特围线包围整个 RHP，由从 $-j\\infty$ 到 $+j\\infty$ 的虚轴和一个在右侧闭合路径的大半圆组成。对于给定的系统，当 $|s| \\to \\infty$ 且 $s$ 在 RHP 时，$L(s) \\to 0$。因此，$F(s) = 1 + L(s) \\to 1$。围线的大半圆部分映射到点 $1$，对环绕原点没有贡献。因此，我们只需要评估沿虚轴，从 $\\omega = -\\infty$ 到 $\\omega = +\\infty$ 的相位变化。\n\n在实践中，我们在一个有限但足够大的频率范围 $[-\\Omega_{\\max}, \\Omega_{\\max}]$ 上进行评估。绕数 $N$ 的计算公式如下：\n$$\nN = \\frac{1}{2\\pi} \\left[ \\arg(F(j\\omega)) \\right]_{\\omega=-\\Omega_{\\max}}^{\\omega=\\Omega_{\\max}} = \\frac{\\phi(\\Omega_{\\max}) - \\phi(-\\Omega_{\\max})}{2\\pi}\n$$\n其中 $\\phi(\\omega)$ 是 $F(j\\omega)$ 的展开相位。展开相位对于正确累积跨越标准 `atan2` 函数（其返回值通常在 $(-\\pi, \\pi]$ 区间内）支割线的总角度变化至关重要。最终结果四舍五入到最接近的整数。\n\n该分析针对两种延迟表示进行：\n1.  **精确延迟：** 频率响应为 $F_{\\text{exact}}(j\\omega) = 1 + L_{\\text{exact}}(j\\omega)$，其中\n    $$\n    L_{\\text{exact}}(j\\omega) = k \\cdot \\frac{1}{1 + j \\omega \\tau} \\cdot e^{-j \\omega T}\n    $$\n2.  **帕德近似：** 频率响应为 $F_{\\text{pade}}(j\\omega) = 1 + L_{\\text{pade}}(j\\omega)$，其中\n    $$\n    L_{\\text{pade}}(j\\omega) = k \\cdot \\frac{1}{1 + j \\omega \\tau} \\cdot D_n(j\\omega)\n    $$\n    对于 $n=1$，使用一阶帕德近似：\n    $$\n    D_1(j\\omega) = \\frac{1 - \\frac{j\\omega T}{2}}{1 + \\frac{j\\omega T}{2}}\n    $$\n    对于 $n=2$，使用二阶帕德近似：\n    $$\n    D_2(j\\omega) = \\frac{1 - \\frac{j\\omega T}{2} + \\frac{(j\\omega T)^2}{12}}{1 + \\frac{j\\omega T}{2} + \\frac{(j\\omega T)^2}{12}} = \\frac{\\left(1 - \\frac{(\\omega T)^2}{12}\\right) - j\\frac{\\omega T}{2}}{\\left(1 - \\frac{(\\omega T)^2}{12}\\right) + j\\frac{\\omega T}{2}}\n    $$\n\n对于每个测试用例 $(\\tau, k, T, n)$，算法按以下步骤进行：\n1.  构建一个对称的频率网格 $\\omega$，从 $-\\Omega_{\\max}$ 到 $\\Omega_{\\max}$，在正半轴上采用对数间距。选择最大频率 $\\Omega_{\\max} = \\max\\left(\\frac{1000}{\\tau}, \\frac{100}{T + \\varepsilon}\\right)$，使其足够大以捕捉系统的相关动态特性。\n2.  计算网格中所有频率下 $F_{\\text{exact}}(j\\omega)$ 和 $F_{\\text{pade}}(j\\omega)$ 的复数值。\n3.  对复数数组 $F_{\\text{exact}}(j\\omega)$ 和 $F_{\\text{pade}}(j\\omega)$ 的辐角应用 `unwrap` 函数，以获得连续的相位曲线。\n4.  根据展开相位的净变化量计算绕数 $N_{\\text{exact}}$ 和 $N_{\\text{pade}}$，将其除以 $2\\pi$ 并四舍五入到最接近的整数。\n5.  为每个模型确定稳定性：如果对应的绕数为 $0$，则为 `True`，否则为 `False`。\n6.  为所有测试用例汇总结果 $[N_{\\text{exact}}, N_{\\text{pade}}, \\text{stable}_{\\text{exact}}, \\text{stable}_{\\text{pade}}]$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Nyquist stability analysis for an LTI system with exact and Padé-approximated delay.\n    \"\"\"\n    test_cases = [\n        # (tau, k, T, n)\n        (0.1, 1.0, 0.02, 1),\n        (0.1, 4.0, 0.3, 1),\n        (0.05, 5.0, 0.0, 1),\n        (0.2, 3.0, 0.5, 2),\n        (0.1, 2.0, 0.2, 2)\n    ]\n\n    all_results = []\n\n    def calculate_stability(tau, k, T, n):\n        \"\"\"\n        Calculates winding numbers and stability for a single test case.\n        \"\"\"\n        # 1. Frequency Grid Construction\n        eps = 1e-9  # Small number to prevent division by zero for T=0 and log(0)\n        omega_max = max(1000.0 / tau, 100.0 / (T + eps))\n        \n        # A dense grid is crucial for np.unwrap to work correctly.\n        # It's also important for the logspace to start at a very small non-zero frequency.\n        num_pos_points = 5000\n        w_start = 1e-6\n        \n        pos_w = np.logspace(np.log10(w_start), np.log10(omega_max), num_pos_points)\n        w = np.concatenate((-pos_w[::-1], np.array([0.0]), pos_w))\n        s = 1j * w\n\n        def get_winding_number(F_jw):\n            \"\"\"Computes the winding number N for a given frequency response F(jω).\"\"\"\n            # Calculate the angle of the complex numbers\n            angles = np.angle(F_jw)\n            \n            # Unwrap the angle to get the continuous phase profile\n            unwrapped_angles = np.unwrap(angles)\n            \n            # Net change in angle is the difference between the last and first value\n            net_angle_change = unwrapped_angles[-1] - unwrapped_angles[0]\n            \n            # Winding number is the net change divided by 2*pi, rounded to nearest integer\n            winding_number = np.round(net_angle_change / (2.0 * np.pi))\n            \n            return int(winding_number)\n\n        # 2. Plant Frequency Response G(jω)\n        G_jw = 1.0 / (tau * s + 1.0)\n\n        # 3. Exact Delay Case\n        D_jw_exact = np.exp(-s * T)\n        F_jw_exact = 1.0 + k * G_jw * D_jw_exact\n        N_exact = get_winding_number(F_jw_exact)\n        stable_exact = (N_exact == 0)\n\n        # 4. Padé Approximation Case\n        if n == 1:\n            # First-order Padé approximation\n            numerator = 1.0 - s * T / 2.0\n            denominator = 1.0 + s * T / 2.0\n        elif n == 2:\n            # Second-order Padé approximation\n            st_term = s * T\n            numerator = 1.0 - st_term / 2.0 + (st_term**2) / 12.0\n            denominator = 1.0 + st_term / 2.0 + (st_term**2) / 12.0\n        else:\n            # This case will not be reached based on the problem description\n            raise ValueError(f\"Unsupported Padé order n={n}\")\n        \n        # Handle potential division by zero if denominator becomes zero for some frequency\n        # For stable Padé approximations, this shouldn't happen on the jw-axis.\n        denominator[denominator == 0] = eps\n        \n        D_jw_pade = numerator / denominator\n        F_jw_pade = 1.0 + k * G_jw * D_jw_pade\n        N_pade = get_winding_number(F_jw_pade)\n        stable_pade = (N_pade == 0)\n\n        return [N_exact, N_pade, stable_exact, stable_pade]\n\n    for case in test_cases:\n        result = calculate_stability(*case)\n        all_results.append(result)\n\n    # Format the final output as a string representing a Python list of lists.\n    # The expected output is a list of lists, but the string representation\n    # requires careful formatting.\n    output_str = \"[\" + \",\".join(str(res) for res in all_results) + \"]\"\n    \n    # The platform seems to run the code and expects the printout.\n    # The prompt asks for output similar to a Python list of lists. Let's reformat.\n    # e.g., [[0,0,True,True],[...],...]\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\n# The calling context for this code is specific to the platform.\n# We will assume calling `solve()` is the intended action.\nsolve()\n```"
        }
    ]
}