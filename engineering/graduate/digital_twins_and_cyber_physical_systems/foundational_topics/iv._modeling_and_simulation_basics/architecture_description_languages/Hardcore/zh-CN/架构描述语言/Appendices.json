{
    "hands_on_practices": [
        {
            "introduction": "在实时系统中，多个任务共享资源时可能会出现意想不到的时序问题，其中优先级反转便是一个典型且严重的例子。架构描述语言（ADL）使我们能够明确地对资源争用进行建模，并推理其对系统正确性（如满足最后期限）的影响。本练习将引导您识别一个经典的无界优先级反转场景，并评估可行的架构级缓解方案。",
            "id": "4205715",
            "problem": "一个架构描述语言（ADL）模型，用架构分析与设计语言（AADL）表示，指定了一个赛博物理系统及其数字孪生，它们在采用固定优先级、完全抢占式调度的实时操作系统（RTOS）下共享一个单核处理器。该ADL声明了三个绑定到同一处理器的线程和一个带有互斥锁的共享内存组件DataBuffer。该ADL将锁策略设置为默认无优先级继承的先进先出（first-in-first-out）互斥锁。这三个线程的优先级和时序参数声明如下：ActuatorControl线程 ($T_H$)，优先级$p_H = 90$，周期$T_H = 10$ ms，相对截止时间$D_H = 10$ ms，最坏情况执行时间$C_H = 2$ ms，其中包括一个在DataBuffer上的持续时间为$1$ ms的临界区；SensorFusion线程 ($T_M$)，优先级$p_M = 60$，周期$T_M = 15$ ms，相对截止时间$D_M = 15$ ms，最坏情况执行时间$C_M = 9$ ms，它不访问DataBuffer；Logger线程 ($T_L$)，优先级$p_L = 10$，周期$T_L = 50$ ms，相对截止时间$D_L = 50$ ms，最坏情况执行时间$C_L = 5$ ms，其中包括一个在DataBuffer上的持续时间为$3$ ms的临界区。ADL部署将共享的DataBuffer和所有三个线程绑定到同一个处理器和同一个内存上，采用上述默认的互斥锁策略。在最坏情况模式下，任务释放的偏移量为：$O_L = 0$ ms, $O_H = 1$ ms, $O_M = 1.5$ ms。所有执行时间和临界区持续时间都是可行的，并与硬件一致。\n\n仅使用固定优先级抢占式调度、互斥和阻塞的基本定义（不使用专门的协议公式），推断声明的配置是否会为$T_H$产生优先级反转，以及这种反转是否会导致$T_H$错过截止时间。然后，考虑ADL可以表达的架构性缓解措施（例如，通过属性更改或组件重新设计）来消除无界反转，同时保持有界延迟。选择所有正确识别此部署中优先级反转发生条件的选项，并提出一个可在ADL级别表达且在给定假设下正确的有效架构性缓解措施。\n\nA. 当$T_L$持有DataBuffer互斥锁，$T_H$请求同一互斥锁并被阻塞，而$T_M$在$T_L$释放互斥锁之前抢占了它时，发生优先级反转；一种缓解措施是在ADL中为DataBuffer互斥锁启用优先级继承，这样当$T_H$被阻塞时，$T_L$会临时以优先级$p_H$执行，从而防止被$T_M$抢占，并将$T_H$的阻塞时间限制在使用该资源的所有低优先级任务中最长的临界区时间。\n\nB. 在此部署中，只有当$T_M$也使用DataBuffer时才会发生优先级反转；一种缓解措施是用读写锁替换互斥锁，将$T_L$指定为写入者，将$T_H$指定为读取者，从而防止它们之间的阻塞。\n\nC. 在任何单核固定优先级系统中，只要有任何低优先级线程访问任何共享资源，就必然会发生优先级反转；一种缓解措施是在内核级别将所有互斥锁设置为不可抢占，这可以消除优先级反转，而不会影响高优先级线程的可调度性。\n\nD. 优先级反转的发生是因为共享资源通过ADL绑定到一个具有可变仲裁的非确定性总线上；一种缓解措施是将$T_H$迁移到一个总线访问具有更高优先级的核心，从而消除阻塞。\n\nE. 当$T_L$持有DataBuffer互斥锁，$T_H$请求该互斥锁并被阻塞，而$T_M$（尽管不使用DataBuffer）抢占了$T_L$时，发生优先级反转；一种缓解措施是将DataBuffer重新设计为一个无锁的单生产者单消费者（SPSC）环形缓冲区，该缓冲区具有有界原子操作和适当的内存屏障，在ADL中声明为一种无锁同步类型，其条件是$T_L$是唯一的生产者，$T_H$是唯一的消费者，并且缓冲区容量$N$的大小要足以避免由生产者引起的阻塞。",
            "solution": "该问题陈述是实时系统分析中的一个有效练习。它为在固定优先级抢占式策略下，调度在单核处理器上的三个线程提供了一套完整且一致的参数，包括它们的时序属性、优先级，以及通过一个没有优先级继承的标准互斥锁保护的共享资源的交互方式。该场景在科学上基于成熟的调度理论，并且问题设定良好，适合用于分析优先级反转现象及其对系统可调度性的影响。\n\n核心任务是分析影响最高优先级线程$T_H$的优先级反转的可能性，并评估所提出的架构性缓解措施。\n\n**1. 优先级反转条件分析**\n\n当一个高优先级线程被迫等待一个低优先级线程时，就会发生优先级反转。当等待的持续时间不仅取决于低优先级线程在其临界区内花费的时间，而且被中等优先级线程的执行所延长时，问题就变得严重，导致“无界”优先级反转。\n\n给定的系统是这种现象的一个教科书式的案例：\n-   $T_H$ 具有最高优先级（$p_H=90$）。\n-   $T_M$ 具有中等优先级（$p_M=60$）。\n-   $T_L$ 具有最低优先级（$p_L=10$）。\n-   $T_H$ 和 $T_L$ 共享一个由互斥锁保护的资源 `DataBuffer`。\n-   $T_M$ 不使用该资源但可以抢占 $T_L$。\n-   互斥锁策略不包括优先级继承。\n\n一个最坏情况的场景展开如下：\n1.  低优先级线程 $T_L$ 开始执行并获取 `DataBuffer` 的互斥锁。\n2.  高优先级线程 $T_H$ 被释放。它抢占 $T_L$ 并开始执行。\n3.  $T_H$ 尝试获取 `DataBuffer` 的互斥锁，发现它被 $T_L$ 锁定，于是阻塞（从“运行”状态转移到“阻塞”状态）。\n4.  调度器现在必须运行就绪队列中优先级最高的线程。由于 $T_H$ 被阻塞，调度器会考虑 $T_M$ 和 $T_L$。\n5.  准备运行的中等优先级线程 $T_M$ 的优先级高于 $T_L$（$p_M > p_L$）。因此，$T_M$ 抢占 $T_L$。\n6.  $T_M$ 运行。在这整个过程中，$T_H$ 仍然处于阻塞状态，等待 $T_L$ 释放互斥锁。然而，$T_L$ 无法运行以释放互斥锁，因为它正被 $T_M$ 抢占。\n\n$T_H$ 经历的阻塞持续时间是 $T_L$ 剩余的临界区时间和 $T_M$ 整个执行时间的总和。这是经典的无界优先级反转问题。\n\n**2. $T_H$ 错过截止时间的分析**\n\n我们将根据最坏情况的参数构建一个时间轴，以确定 $T_H$ 是否会错过其截止时间。\n-   偏移量：$O_L = 0$ ms, $O_H = 1$ ms, $O_M = 1.5$ ms。\n-   在时间 $t=0$ ms，$T_L$ 被释放。假设它开始执行并立即进入其最坏情况持续时间为 $3$ ms 的临界区。\n-   在时间 $t=1$ ms，$T_H$ 被释放。由于 $p_H > p_L$，$T_H$ 抢占 $T_L$。此时 $T_L$ 已在其临界区内执行了 $1$ ms。\n-   在时间 $t=1.5$ ms，$T_M$ 被释放。然而，$T_H$ 仍在运行（$p_H > p_M$），因此 $T_M$ 被放入就绪队列。\n-   $T_H$ 的最坏情况执行时间（WCET）为 $C_H = 2$ ms，其中包括一个 $1$ ms 的临界区。我们假设最坏的阻塞情况，即 $T_H$ 首先执行其非临界区部分。这需要 $C_H - (\\text{CS duration}) = 2 - 1 = 1$ ms。因此，$T_H$ 从 $t=1$ ms 运行到 $t=2$ ms。\n-   在时间 $t=2$ ms，$T_H$ 尝试锁定互斥锁。它发现互斥锁被 $T_L$ 持有，于是阻塞。\n-   调度器现在分派就绪队列中优先级最高的线程。这是 $T_M$（优先级 $60$），它在 $t=1.5$ ms 时被释放。\n-   $T_M$ 在 $t=2$ ms 开始执行。它运行其完整的 WCET，$C_M=9$ ms。\n-   $T_M$ 在 $t = 2 + 9 = 11$ ms 完成其执行。\n-   在时间 $t=11$ ms，就绪队列中优先级最高的线程是 $T_L$（优先级 $10$）。$T_H$ 仍处于阻塞状态。\n-   $T_L$ 恢复执行以完成其临界区。它已经运行了 $1$ ms，因此还需要 $3 - 1 = 2$ ms。它从 $t=11$ ms 运行到 $t=13$ ms。\n-   在时间 $t=13$ ms，$T_L$ 释放互斥锁。\n-   互斥锁一经释放，$T_H$ 就解除阻塞并变为就绪状态。由于它具有最高优先级，它会抢占 $T_L$ 并开始执行其临界区。\n-   $T_H$ 运行其 $1$ ms 的临界区，从 $t=13$ ms 到 $t=14$ ms。\n-   在时间 $t=14$ ms，$T_H$ 的第一个作业完成。\n-   这个 $T_H$ 作业的截止时间是其释放时间加上其相对截止时间：$D_{H,abs} = O_H + D_H = 1 + 10 = 11$ ms。\n-   由于该作业在 $14$ ms 完成，晚于其 $11$ ms 的截止时间，因此线程 $T_H$ 错过了其截止时间。\n分析证实，指定的配置会产生优先级反转，并且这种反转会直接导致高优先级线程错过截止时间。\n\n**3. 选项评估**\n\n**选项 A：**当$T_L$持有DataBuffer互斥锁，$T_H$请求同一互斥锁并被阻塞，而$T_M$在$T_L$释放互斥锁之前抢占了它时，发生优先级反转；一种缓解措施是在ADL中为DataBuffer互斥锁启用优先级继承，这样当$T_H$被阻塞时，$T_L$会临时以优先级$p_H$执行，从而防止被$T_M$抢占，并将$T_H$的阻塞时间限制在使用该资源的所有低优先级任务中最长的临界区时间。\n-   **分析**：此选项完美准确地描述了我们在分析中识别出的无界优先级反转场景。所提出的缓解措施，即启用优先级继承，是标准解决方案。当$T_L$持有锁并阻塞$T_H$时，$T_L$将继承$T_H$的优先级，变为$p_L' = p_H = 90$。因此，$T_M$（优先级为$p_M=60$）将无法抢占$T_L$。$T_L$将完成其临界区（最多$3$ ms），释放锁，然后$T_H$可以继续执行。这将$T_H$的阻塞时间限制为$T_L$临界区的持续时间（$3$ ms），从而避免错过截止时间（新的响应时间最多为$C_H + \\text{blocking} = 2+3=5$ ms，小于$D_H=10$ ms）。这种策略是实时操作系统（RTOSes）的标准功能，并且在像AADL这样的ADL中是可配置的。\n-   **结论**：**正确**。\n\n**选项 B：**在此部署中，只有当$T_M$也使用DataBuffer时才会发生优先级反转；一种缓解措施是用读写锁替换互斥锁，将$T_L$指定为写入者，将$T_H$指定为读取者，从而防止它们之间的阻塞。\n-   **分析**：该前提是错误的。严重的优先级反转问题恰恰是因为$T_M$不使用互斥锁并且可以自由抢占$T_L$。所提出的缓解措施也是有缺陷的。如果一个写入者（$T_L$）持有锁，读写锁不允许一个读取者（$T_H$）继续进行。写入者需要独占访问权。因此，$T_H$仍然会被$T_L$阻塞，而$T_M$抢占的优先级反转场景将保持不变。\n-   **结论**：**不正确**。\n\n**选项 C：**在任何单核固定优先级系统中，只要有任何低优先级线程访问任何共享资源，就必然会发生优先级反转；一种缓解措施是在内核级别将所有互斥锁设置为不可抢占，这可以消除优先级反转，而不会影响高优先级线程的可调度性。\n-   **分析**：最初的前提是一种过度概括。虽然高优先级线程被低优先级线程阻塞在技术上是一种优先级反转，但它并不总是“无界的”或有问题的。严重的情况需要特定的三级优先级交互。所提出的使用不可抢占临界区的缓解措施确实可以防止反转场景。然而，“不影响高优先级线程的可调度性”这一说法是错误的。由低优先级线程执行的不可抢占部分将阻止任何更高优先级的线程在其持续时间内运行，即使更高优先级的线程不使用共享资源。这引入了另一种形式的阻塞，可能对可调度性产生负面影响。\n-   **结论**：**不正确**。\n\n**选项 D：**优先级反转的发生是因为共享资源通过ADL绑定到一个具有可变仲裁的非确定性总线上；一种缓解措施是将$T_H$迁移到一个总线访问具有更高优先级的核心，从而消除阻塞。\n-   **分析**：该选项引入了问题陈述中未提供的事实。问题陈述明确指出是“单核处理器”，并将问题归因于调度和锁定策略。没有提到总线架构。由于系统只有一个核心，所提出的缓解措施是不可能实现的。其推理与所提供的问题描述完全脱节。\n-   **结论**：**不正确**。\n\n**选项 E：**当$T_L$持有DataBuffer互斥锁，$T_H$请求该互斥锁并被阻塞，而$T_M$（尽管不使用DataBuffer）抢占了$T_L$时，发生优先级反转；一种缓解措施是将DataBuffer重新设计为一个无锁的单生产者单消费者（SPSC）环形缓冲区，该缓冲区具有有界原子操作和适当的内存屏障，在ADL中声明为一种无锁同步类型，其条件是$T_L$是唯一的生产者，$T_H$是唯一的消费者，并且缓冲区容量$N$的大小要足以避免由生产者引起的阻塞。\n-   **分析**：对优先级反转条件的描述与选项A相同，是正确的。所提出的缓解措施涉及对共享组件进行根本性的架构重新设计，以使用无锁算法。SPSC队列是无锁数据结构的经典示例，它完全避免了互斥锁，从而消除了由于互斥而导致的阻塞以及相关的优先级反转的可能性。这是一种有效且先进的缓解策略。该选项正确地指出了这种特定设计模式的必要前提条件（单一生产者/消费者角色）。这种架构模式可以在ADL中表达，代表了组件设计和同步属性的改变。\n-   **结论**：**正确**。",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "除了时序行为，可靠性是网络物理系统的另一个关键质量属性。通过在 ADL 模型中为组件和连接器标注非功能性属性（如故障概率），我们可以对系统的可靠性进行定量分析。本练习演示了如何运用这些标注信息和概率论基本原理，计算一个考虑了网络状态和重传策略的复杂通信链路的端到端成功概率。",
            "id": "4205678",
            "problem": "一个信息物理系统的架构描述语言 (ADL) 模型指定了一个多跳连接器链，用于从物理传感器到其基于软件的数字孪生的端到端遥测。该连接器链包含三个串行连接器，表示为跳 $i \\in \\{1,2,3\\}$。每个连接器在 ADL 中都标注了以共享网络状态为条件的每次传输成功概率，以及与自动重传请求 (ARQ) 一致的链路级重试策略。对于任何单次端到端尝试，网络状态被建模为一个二元随机变量 $S \\in \\{\\text{Normal}, \\text{Congested}\\}$，在各次端到端尝试之间独立抽取，其中 $\\Pr(S=\\text{Normal})=\\theta$ 且 $\\Pr(S=\\text{Congested})=1-\\theta$。在给定 $S$ 的条件下，不同连接器上以及不同重试次数间的传输尝试结果是独立同分布的。\n\n对于第 $i$ 跳，ADL 标注提供了以下每次传输的成功概率：\n- 在 $S=\\text{Normal}$ 状态下：$p_{1,\\text{N}}=0.97$，$p_{2,\\text{N}}=0.95$，$p_{3,\\text{N}}=0.98$。\n- 在 $S=\\text{Congested}$ 状态下：$p_{1,\\text{C}}=0.82$，$p_{2,\\text{C}}=0.78$，$p_{3,\\text{C}}=0.88$。\n\nARQ 重试策略允许每次端到端尝试中，每一跳 $i$ 最多进行 $r_i$ 次总传输尝试（包括首次尝试），其中 $r_1=2$，$r_2=3$，$r_3=2$。一次端到端尝试仅在所有三跳都在该次尝试中各自的重试预算内成功时，才算成功。系统执行最多 $N$ 次端到端尝试，每次尝试都会经历一个独立抽取的网络状态 $S$。设 $\\theta=0.7$ 且 $N=2$。\n\n仅使用基本概率定义和独立性假设，计算在 $N$ 次端到端尝试中消息至少成功传递一次的概率。将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于概率论和计算机网络建模，问题设定良好，参数完整且一致，并且表述客观。因此，我们可以进行正式求解。\n\n目标是计算在 $N=2$ 次端到端尝试中消息至少成功传递一次的概率。设 $A$ 为至少有一次成功传递的事件。更直接的方法是计算其互补事件 $A^c$ 的概率，即所有 $N$ 次端到端尝试都失败。最终概率则为 $P(A) = 1 - P(A^c)$。\n\n问题陈述指出，每一次端到端尝试都是独立的。设 $E_k$ 为第 $k$ 次尝试中端到端成功传递的事件。由于各次尝试是独立同分布的，因此 $\\Pr(E_k)$ 对所有 $k$ 都相同。设单次尝试的成功概率为 $P_S = \\Pr(E_k)$。单次尝试失败的概率是 $\\Pr(E_k^c) = 1 - P_S$。\n\n事件 $A^c$ 是所有 $N$ 次尝试都失败的交集，即 $A^c = E_1^c \\cap E_2^c \\cap \\dots \\cap E_N^c$。由于独立性，其概率为：\n$$ \\Pr(A^c) = \\prod_{k=1}^{N} \\Pr(E_k^c) = (\\Pr(E_1^c))^N = (1 - P_S)^N $$\n因此，目标概率为：\n$$ P(A) = 1 - (1 - P_S)^N $$\n我们的首要任务是计算 $P_S$，即单次端到端尝试的成功概率。\n\n单次尝试的网络状态 $S$ 是一个随机变量，因此我们应用全概率公式：\n$$ P_S = \\Pr(E_1 | S=\\text{Normal}) \\Pr(S=\\text{Normal}) + \\Pr(E_1 | S=\\text{Congested}) \\Pr(S=\\text{Congested}) $$\n使用给定的记号 $\\theta = \\Pr(S=\\text{Normal})$ 以及提供的条件端到端成功概率 $P_{S|\\text{N}} = \\Pr(E_1|S=\\text{Normal})$ 和 $P_{S|\\text{C}} = \\Pr(E_1|S=\\text{Congested})$，上式变为：\n$$ P_S = P_{S|\\text{N}} \\cdot \\theta + P_{S|\\text{C}} \\cdot (1 - \\theta) $$\n我们现在必须计算 $P_{S|\\text{N}}$ 和 $P_{S|\\text{C}}$。一次端到端尝试仅在所有三个串行连接的跳都成功时才算成功。在给定状态 $S$ 的条件下，不同连接器上的结果是条件独立的。设 $H_{i, S}$ 表示在状态 $S$ 下第 $i$ 跳成功的事件。则：\n$$ P_{S|\\text{N}} = \\Pr(H_{1, \\text{N}}) \\cdot \\Pr(H_{2, \\text{N}}) \\cdot \\Pr(H_{3, \\text{N}}) $$\n$$ P_{S|\\text{C}} = \\Pr(H_{1, \\text{C}}) \\cdot \\Pr(H_{2, \\text{C}}) \\cdot \\Pr(H_{3, \\text{C}}) $$\n下一步是求出单个跳 $i$ 的成功概率 $\\Pr(H_{i, S})$。一跳 $i$ 被允许最多进行 $r_i$ 次传输尝试。设 $p_{i,S}$ 为在状态 $S$ 下第 $i$ 跳的单次传输成功概率。如果这 $r_i$ 次尝试中至少有一次成功，则该跳成功。其互补事件是所有 $r_i$ 次尝试都失败。单次传输失败的概率是 $1 - p_{i,S}$。考虑到条件独立性，所有 $r_i$ 次尝试都失败的概率是 $(1 - p_{i,S})^{r_i}$。\n因此，在给定状态 $S$ 下第 $i$ 跳的成功概率是：\n$$ \\Pr(H_{i, S}) = 1 - (1 - p_{i,S})^{r_i} $$\n我们现在代入给定值来计算这些概率。\n\n对于正常状态 ($S=\\text{Normal}$):\n每次传输的成功概率为 $p_{1,\\text{N}}=0.97$，$p_{2,\\text{N}}=0.95$，$p_{3,\\text{N}}=0.98$，重试次数上限为 $r_1=2$，$r_2=3$，$r_3=2$。\n$$ \\Pr(H_{1, \\text{N}}) = 1 - (1 - 0.97)^2 = 1 - (0.03)^2 = 1 - 0.0009 = 0.9991 $$\n$$ \\Pr(H_{2, \\text{N}}) = 1 - (1 - 0.95)^3 = 1 - (0.05)^3 = 1 - 0.000125 = 0.999875 $$\n$$ \\Pr(H_{3, \\text{N}}) = 1 - (1 - 0.98)^2 = 1 - (0.02)^2 = 1 - 0.0004 = 0.9996 $$\n在正常状态下，端到端的成功概率是：\n$$ P_{S|\\text{N}} = 0.9991 \\times 0.999875 \\times 0.9996 \\approx 0.998575345 $$\n\n对于拥塞状态 ($S=\\text{Congested}$):\n每次传输的成功概率为 $p_{1,\\text{C}}=0.82$，$p_{2,\\text{C}}=0.78$，$p_{3,\\text{C}}=0.88$，重试次数上限相同。\n$$ \\Pr(H_{1, \\text{C}}) = 1 - (1 - 0.82)^2 = 1 - (0.18)^2 = 1 - 0.0324 = 0.9676 $$\n$$ \\Pr(H_{2, \\text{C}}) = 1 - (1 - 0.78)^3 = 1 - (0.22)^3 = 1 - 0.010648 = 0.989352 $$\n$$ \\Pr(H_{3, \\text{C}}) = 1 - (1 - 0.88)^2 = 1 - (0.12)^2 = 1 - 0.0144 = 0.9856 $$\n在拥塞状态下，端到端的成功概率是：\n$$ P_{S|\\text{C}} = 0.9676 \\times 0.989352 \\times 0.9856 \\approx 0.94396005 $$\n\n现在，我们使用 $\\theta=0.7$ 计算单次尝试的总体成功概率 $P_S$：\n$$ P_S = P_{S|\\text{N}} \\cdot \\theta + P_{S|\\text{C}} \\cdot (1 - \\theta) $$\n$$ P_S \\approx (0.998575345)(0.7) + (0.94396005)(0.3) $$\n$$ P_S \\approx 0.6990027415 + 0.283188015 = 0.9821907565 $$\n单次尝试失败的概率是：\n$$ 1 - P_S \\approx 1 - 0.9821907565 = 0.0178092435 $$\n最后，我们计算在 $N=2$ 次尝试中至少有一次成功的概率：\n$$ P(A) = 1 - (1 - P_S)^N \\approx 1 - (0.0178092435)^2 $$\n$$ P(A) \\approx 1 - 0.0003171691 = 0.9996828309 $$\n按要求将结果四舍五入到四位有效数字，得到 $0.9997$。",
            "answer": "$$\n\\boxed{0.9997}\n$$"
        },
        {
            "introduction": "ADL 的威力不仅在于分析单个设计，更在于系统地探索和管理产品线中的可变性，从而进行有效的设计权衡。本练习构建了一个基于特征模型的产品线场景，您需要作为系统架构师，通过应用一系列源于 ADL 的结构和定量约束（如性能预算和硬件兼容性），从众多可能性中筛选出所有有效的系统配置。",
            "id": "4205712",
            "problem": "考虑一个信息物理系统数字孪生产品线，其可变性通过一个特征图进行建模。特征受到架构描述语言 (ADL) 属性的约束，这些属性强制施加了结构完整性和量化资源限制。该系统具有统一的处理流水线：对所有选定的传感器应用单一的压缩方法和单一的加密方法。以下定义、选项和约束成立。\n\n- 基本基础：\n  - 架构描述语言 (ADL) 指定了组件、连接器和属性。结构完整性要求传感器之间的数据流转换统一，且选择之间相互兼容。量化属性限制了端到端的资源使用。\n  - 特征图将可变性定义为在备选项和可选项之间的选择，并受制于从 ADL 属性派生的跨树约束。\n  - 总线容量约束要求传输数据速率的总和不超过所选总线的容量。\n  - 计算预算约束要求压缩和加密的总计算成本不超过所选计算平台的预算。\n\n- 缩略语：\n  - 架构描述语言 (ADL)。\n  - 信息物理系统 (CPS)。\n  - 控制器局域网络 (CAN)。\n  - 时间敏感网络 (TSN)。\n  - 高级加密标准 (AES)。\n\n- 传感器类型和原始数据速率：\n  - IMU: $5$ Mbps。\n  - Lidar: $100$ Mbps。\n  - Camera: $200$ Mbps。\n  每个配置必须从 $\\{\\text{IMU}, \\text{Lidar}, \\text{Camera}\\}$ 中选择恰好两个不同的传感器。\n\n- 通信总线备选项：\n  - CAN: 容量 $50$ Mbps。\n  - TSN: 容量 $1000$ Mbps。\n\n- 压缩方法备选项 (统一应用于所有选定传感器)：\n  - 无：压缩比 $r=1$，压缩成本系数 $k_{c}=0$ 单位/Mbps。\n  - LZ4：压缩比 $r=\\frac{3}{5}$，压缩成本系数 $k_{c}=0.2$ 单位/Mbps。\n  - Zstd：压缩比 $r=\\frac{2}{5}$，压缩成本系数 $k_{c}=0.5$ 单位/Mbps。\n\n- 加密方法备选项 (统一应用于所有选定传感器)：\n  - 无：开销因子 $\\alpha=0$，加密成本系数 $k_{e}=0$ 单位/Mbps。\n  - AES-128：开销因子 $\\alpha=0.1$，加密成本系数 $k_{e}=1.0$ 单位/Mbps。\n  - AES-256：开销因子 $\\alpha=0.2$，加密成本系数 $k_{e}=1.5$ 单位/Mbps。\n\n- 计算平台备选项和预算：\n  - 仅 CPU: 预算 $250$ 单位。\n  - CPU+GPU: 预算 $400$ 单位。\n  - CPU+FPGA: 预算 $500$ 单位。\n\n- ADL派生的结构完整性和跨树约束：\n  1. 统一性：必须选择单一的压缩方法和单一的加密方法，并统一应用于两个传感器。\n  2. 摄像头隐私策略：如果选择了任何摄像头，则加密方式不能为“无”（即加密必须是 AES-128 或 AES-256）。\n  3. 兼容性：AES-256 要求使用 TSN 作为总线。\n  4. 平台支持：在仅 CPU 的平台上，不允许使用 Zstd 和 AES-256。\n  5. 量化约束：\n     - 总线容量：传输速率的总和 $D_{\\text{tx}}$ 必须满足 $D_{\\text{tx}} \\leq$ 总线容量。\n     - 计算预算：总计算成本 $K_{\\text{tot}}$ 必须满足 $K_{\\text{tot}} \\leq$ 所选平台的预算。\n  单个传感器的传输速率为 $d \\cdot r \\cdot (1+\\alpha)$，其中 $d$ 是原始速率。两个传感器的总传输速率是所选传感器对的和。单个传感器的计算成本为 $k_{c}\\cdot d + k_{e}\\cdot (r\\cdot d)$，总计算成本是所选传感器对的和。\n\n计算满足所有结构完整性和量化约束的有效配置数量，其中一个配置是一套完整的选择，包括：\n- 恰好两个不同的传感器，\n- 一个总线，\n- 一种压缩方法，\n- 一种加密方法，\n- 一个计算平台。\n\n以精确整数（无单位）形式表示您的最终答案。不需要四舍五入。",
            "solution": "我们从 ADL 原则开始：组件（传感器、总线、处理平台）和连接器（压缩和加密转换）必须满足结构统一性和兼容性。量化属性通过总线容量和计算预算来限制资源使用。特征图提供了离散的可变性；有效配置是那些满足 ADL 派生约束的选择。\n\n设原始数据速率为 $d_{\\text{IMU}}=5$、$d_{\\text{Lidar}}=100$、$d_{\\text{Camera}}=200$（单位均为 Mbps）。从集合中恰好选择两个不同的传感器，产生三种可能的组合：\n- 组合A：IMU + Lidar，总原始速率 $D_{A}=5+100=105$。\n- 组合B：IMU + Camera，总原始速率 $D_{B}=5+200=205$。\n- 组合C：Lidar + Camera，总原始速率 $D_{C}=100+200=300$。\n\n统一的压缩和加密意味着：\n- 单个传感器的传输速率为 $d\\cdot r \\cdot (1+\\alpha)$，其中 $d$ 为原始速率。\n- 一对传感器的总传输速率为 $D \\cdot r \\cdot (1+\\alpha)$，其中 $D$ 是该组合的原始速率之和。\n- 单个传感器的计算成本为 $k_{c}\\cdot d + k_{e}\\cdot (r\\cdot d)$，因此一对传感器的总计算成本为 $K_{\\text{tot}}=D \\cdot (k_{c} + k_{e} r)$。\n\n压缩选项：无 $(r=1, k_{c}=0)$，LZ4 $(r=\\frac{3}{5}, k_{c}=0.2)$，Zstd $(r=\\frac{2}{5}, k_{c}=0.5)$。加密选项：无 $(\\alpha=0, k_{e}=0)$，AES-128 $(\\alpha=0.1, k_{e}=1.0)$，AES-256 $(\\alpha=0.2, k_{e}=1.5)$。总线容量：CAN $50$ Mbps，TSN $1000$ Mbps。平台预算：仅 CPU $250$，CPU+GPU $400$，CPU+FPGA $500$。结构约束：摄像头要求加密 $\\neq$ 无；AES-256 要求 TSN；仅 CPU 不允许 Zstd 和 AES-256。\n\n步骤 1：总线容量可行性分析。\n\n对于每对传感器组合 $D$ 和选择 $(r,\\alpha)$，总传输速率为 $D_{\\text{tx}}=D \\cdot r \\cdot (1+\\alpha)$。TSN 的容量为 $1000$ Mbps，因此所有组合在 TSN 上都是可行的。对于容量为 $50$ Mbps 的 CAN，我们检查其可行性：\n\n- 组合 A ($D_{A}=105$)：\n  - 无压缩 $(r=1)$：\n    - 无加密 $(\\alpha=0)$：$105 \\cdot 1 \\cdot 1 = 105$ (不可行)。\n    - AES-128 $(\\alpha=0.1)$：$105 \\cdot 1 \\cdot 1.1 = 115.5$ (不可行)。\n    - AES-256 $(\\alpha=0.2)$：$105 \\cdot 1 \\cdot 1.2 = 126$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$：\n    - 无：$105 \\cdot \\frac{3}{5} \\cdot 1 = 63$ (不可行)。\n    - AES-128：$105 \\cdot \\frac{3}{5} \\cdot 1.1 = 69.3$ (不可行)。\n    - AES-256：$105 \\cdot \\frac{3}{5} \\cdot 1.2 = 75.6$ (不可行)。\n  - Zstd $(r=\\frac{2}{5})$：\n    - 无：$105 \\cdot \\frac{2}{5} \\cdot 1 = 42$ (可行)。\n    - AES-128：$105 \\cdot \\frac{2}{5} \\cdot 1.1 = 46.2$ (可行)。\n    - AES-256：$105 \\cdot \\frac{2}{5} \\cdot 1.2 = 50.4$ (不可行)。\n  注意，无论如何 AES-256 在结构上都与 CAN 不兼容。\n\n- 组合 B ($D_{B}=205$，存在摄像头，要求加密)：\n  - Zstd $(r=\\frac{2}{5})$，AES-128：$205 \\cdot \\frac{2}{5} \\cdot 1.1 = 90.2$ (不可行)。\n  - Zstd, AES-256：$205 \\cdot \\frac{2}{5} \\cdot 1.2 = 98.4$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$，AES-128：$205 \\cdot \\frac{3}{5} \\cdot 1.1 = 135.3$ (不可行)。\n  - LZ4, AES-256：$205 \\cdot \\frac{3}{5} \\cdot 1.2 = 147.6$ (不可行)。\n  - 无 $(r=1)$，AES-128：$205 \\cdot 1 \\cdot 1.1 = 225.5$ (不可行)。\n  - 无, AES-256：$205 \\cdot 1 \\cdot 1.2 = 246$ (不可行)。\n  因此，没有包含摄像头的组合在 CAN 上是可行的。\n\n- 组合 C ($D_{C}=300$，存在摄像头，要求加密)：\n  - Zstd $(r=\\frac{2}{5})$，AES-128：$300 \\cdot \\frac{2}{5} \\cdot 1.1 = 132$ (不可行)。\n  - Zstd, AES-256：$300 \\cdot \\frac{2}{5} \\cdot 1.2 = 144$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$，AES-128：$300 \\cdot \\frac{3}{5} \\cdot 1.1 = 198$ (不可行)。\n  - LZ4, AES-256：$300 \\cdot \\frac{3}{5} \\cdot 1.2 = 216$ (不可行)。\n  - 无 $(r=1)$，AES-128：$300 \\cdot 1 \\cdot 1.1 = 330$ (不可行)。\n  - 无, AES-256：$300 \\cdot 1 \\cdot 1.2 = 360$ (不可行)。\n  因此，没有包含摄像头的组合在 CAN 上是可行的。唯一在 CAN 上可行的案例是组合 A 使用 Zstd 以及“无”或 AES-128 加密（受其他约束限制）。\n\n步骤 2：计算预算可行性分析。\n\n一个原始速率和为 $D$ 的传感器组合的总计算成本为 $K_{\\text{tot}}=D\\cdot(k_{c}+k_{e}r)$。\n\n计算组合 A 的值 ($D_{A}=105$)：\n- 无压缩 $(r=1)$：\n  - 无加密：$105\\cdot(0+0\\cdot 1)=0$。\n  - AES-128：$105\\cdot(0+1\\cdot 1)=105$。\n  - AES-256：$105\\cdot(0+1.5\\cdot 1)=157.5$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无：$105\\cdot(0.2+0\\cdot \\frac{3}{5})=21$。\n  - AES-128：$105\\cdot(0.2+1\\cdot \\frac{3}{5})=105\\cdot 0.8=84$。\n  - AES-256：$105\\cdot(0.2+1.5\\cdot \\frac{3}{5})=105\\cdot 1.1=115.5$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无：$105\\cdot(0.5+0\\cdot \\frac{2}{5})=52.5$。\n  - AES-128：$105\\cdot(0.5+1\\cdot \\frac{2}{5})=105\\cdot 0.9=94.5$。\n  - AES-256：$105\\cdot(0.5+1.5\\cdot \\frac{2}{5})=105\\cdot 1.1=115.5$。\n所有值都 $\\leq 250$、$\\leq 400$ 和 $\\leq 500$，因此计算预算对组合 A 没有约束力。\n\n计算组合 B 的值 ($D_{B}=205$)：\n- 无 $(r=1)$：\n  - AES-128：$205\\cdot 1=205$。\n  - AES-256：$205\\cdot 1.5=307.5$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无：$205\\cdot 0.2=41$。\n  - AES-128：$205\\cdot 0.8=164$。\n  - AES-256：$205\\cdot 1.1=225.5$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无：$205\\cdot 0.5=102.5$。\n  - AES-128：$205\\cdot 0.9=184.5$。\n  - AES-256：$205\\cdot 1.1=225.5$。\n所有值都 $\\leq 400$ 和 $\\leq 500$。在仅 CPU ($250$) 的平台上，只有“无压缩+AES-256”超过预算 ($307.5$)，但无论如何，仅 CPU 平台在结构上不允许 AES-256 和 Zstd。\n\n计算组合 C 的值 ($D_{C}=300$)：\n- 无 $(r=1)$：\n  - AES-128：$300\\cdot 1=300$。\n  - AES-256：$300\\cdot 1.5=450$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无：$300\\cdot 0.2=60$。\n  - AES-128：$300\\cdot 0.8=240$。\n  - AES-256：$300\\cdot 1.1=330$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无：$300\\cdot 0.5=150$。\n  - AES-128：$300\\cdot 0.9=270$。\n  - AES-256：$300\\cdot 1.1=330$。\n对于仅 CPU ($250$)，无压缩+AES-128 超过预算 ($300>250$)，LZ4+AES-256 和 Zstd+AES-128 也超过预算 ($330$, $270$)；然而，仅 CPU 平台在结构上不允许 AES-256 和 Zstd。对于 CPU+GPU ($400$)，除了无压缩+AES-256 ($450$) 外，所有组合都在预算内。对于 CPU+FPGA ($500$)，所有组合都在预算内。\n\n步骤 3：计算有效配置数量，同时遵守所有结构性约束。\n\n我们按总线类型和传感器组合进行计数。\n\n- CAN：\n  - 组合 A 仅在使用 Zstd 和加密方式在 $\\{\\text{无}, \\text{AES-128}\\}$ 中时可行。AES-256 与 CAN 不兼容；仅 CPU 平台不允许 Zstd，因此只允许 CPU+GPU 和 CPU+FPGA 平台。\n    - 加密选择：$2$ (无, AES-128)。\n    - 平台：$2$ (CPU+GPU, CPU+FPGA)。\n    - 组合 A 的 CAN 总配置数：$2 \\times 2 = 4$。\n  - 组合 B 和 C 因容量问题在 CAN 上不可行。\n  因此 CAN 总计：$4$。\n\n- TSN：\n  所有组合都满足容量要求。应用摄像头加密要求、AES-256 兼容性和平台支持。\n\n  - 组合 A (无摄像头要求)：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256。压缩在 $\\{\\text{无}, \\text{LZ4}\\}$ 中，加密在 $\\{\\text{无}, \\text{AES-128}\\}$ 中。组合数：$2 \\times 2 = 4$。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 所有 $3$ 种加密：$3 \\times 3 = 9$。\n    - CPU+FPGA：类似地为 $9$。\n    - 组合 A 在 TSN 上的总数：$4 + 9 + 9 = 22$。\n\n  - 组合 B (存在摄像头，加密 $\\in \\{\\text{AES-128}, \\text{AES-256}\\}$)：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256。压缩在 $\\{\\text{无}, \\text{LZ4}\\}$ 中，加密为 $\\{\\text{AES-128}\\}$：$2 \\times 1 = 2$ (满足预算)。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 两种加密：$3 \\times 2 = 6$ (满足预算)。\n    - CPU+FPGA：$3 \\times 2 = 6$。\n    - 组合 B 在 TSN 上的总数：$2 + 6 + 6 = 14$。\n\n  - 组合 C (存在摄像头，加密 $\\in \\{\\text{AES-128}, \\text{AES-256}\\}$)：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256；压缩为 $\\{\\text{无}, \\text{LZ4}\\}$，加密为 $\\{\\text{AES-128}\\}$。“无压缩+AES-128” 超过预算 ($300>250$)，“LZ4+AES-128” 在预算内 ($240\\leq 250$)。所以有 $1$ 个有效组合。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 两种加密 $=6$，但“无压缩+AES-256”超过预算 ($450>400$)，因此有 $5$ 个有效组合。\n    - CPU+FPGA：所有 $6$ 个都有效 (满足预算)。\n    - 组合 C 在 TSN 上的总数：$1 + 5 + 6 = 12$。\n\n  TSN 总计：$22 + 14 + 12 = 48$。\n\n将所有总线类型的配置加总，有效配置的总数为 $4$ (CAN) $+$ $48$ (TSN) $=$ $52$。\n\n因此，满足所有 ADL 派生的结构完整性和量化约束的有效配置数量为 $52$。",
            "answer": "$$\\boxed{52}$$"
        }
    ]
}