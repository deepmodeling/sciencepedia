{
    "hands_on_practices": [
        {
            "introduction": "架构描述语言 (ADL) 的一个核心功能是在系统实现之前进行定量分析。本练习将侧重于网络通信——许多信息物理系统 (CPS) 中的关键组件。我们将通过一个假设的 AADL 模型，来计算时间触发通信协议 (TDMA) 下总线利用率、延迟和抖动等基本指标，从而将抽象的 ADL 规范与具体的性能数值联系起来。",
            "id": "4205739",
            "problem": "一个网络化的信息物理系统 (CPS) 使用体系结构分析与设计语言 (AADL) 进行规范。该 AADL 模型声明了一个单一的共享通信资源，该资源被建模为一个 AADL 总线，其调度协议设置为时间触发，并具有长度为 $C$ 的统一时分多址 (TDMA) 主周期。总线线路速率为 $B$ 比特/秒，所有消息均使用固定大小的帧，其序列化延迟等于帧大小除以线路速率。假设除了等待分配的 TDMA 时隙开始之外，传播、交换和排队延迟均可忽略不计。\n\n该 AADL 模型包含映射到此总线的三个周期性流，每个流由帧大小 $S_i$（单位：比特）和周期 $T_i$（单位：秒）描述：\n- 流 $1$：$S_1 = 800$ 比特，$T_1 = 5 \\times 10^{-3}$ 秒。\n- 流 $2$：$S_2 = 1200$ 比特，$T_2 = 1.0 \\times 10^{-2}$ 秒。\n- 流 $3$：$S_3 = 400$ 比特，$T_3 = 2 \\times 10^{-3}$ 秒。\n\n总线的线路速率为 $B = 1.0 \\times 10^{7}$ 比特/秒，TDMA 主周期为 $C = 6.0 \\times 10^{-4}$ 秒。所考虑的控制回路是周期性流 $1$。该控制回路的端到端网络延迟要求为 $L_{\\mathrm{req}} = 1.0 \\times 10^{-3}$ 秒，其网络延迟抖动要求（定义为连续发布之间网络延迟的最大变化）为 $J_{\\mathrm{req}} = 7.0 \\times 10^{-4}$ 秒。AADL 调度为流 $1$ 在每个 TDMA 周期中分配一个专用时隙，并且流 $1$ 仅在其分配的时隙内有资格进行传输。在一个周期内，流 $1$ 的发布时间与时隙边界没有相位对齐。\n\n仅使用与吞吐量、利用率和时间触发调度语义相关的基本原理，完成以下任务：\n1. 确定由三个周期性流引起的总线利用率 $U$（作为一个无量纲分数）。\n2. 通过计算联合可行性裕度 $m$（单位为毫秒），确定总线是否同时满足控制回路的延迟和抖动要求。该裕度定义为 $m = \\min\\{L_{\\mathrm{req}} - L_{\\max},\\; J_{\\mathrm{req}} - J_{\\max}\\}$，其中 $L_{\\max}$ 是流 $1$ 的最坏情况网络延迟，而 $J_{\\max}$ 是仅由 TDMA 调度引起的流 $1$ 的最坏情况网络延迟抖动。\n\n将 $U$ 表示为无量纲分数，将 $m$ 表示为毫秒。将两个报告值都四舍五入到四位有效数字。最终答案必须是有序对 $\\left(U, m\\right)$。",
            "solution": "该问题要求评估一个网络化信息物理系统的通信总线性能。分析分为两个部分：首先，计算总线利用率；其次，根据延迟和抖动要求，对特定控制回路（流 $1$）进行可调度性分析。\n\n**第 1 部分：总线利用率 ($U$)**\n\n总线利用率 $U$ 是一个无量纲的量，表示数据流所使用的总线总容量的比例。它被计算为总所需数据速率与总线线路速率（容量）的比值。\n\n每个周期性流 $i$ 所需的数据速率，记为 $R_i$，是帧大小 $S_i$ 除以其周期 $T_i$。\n$$R_i = \\frac{S_i}{T_i}$$\n\n总所需数据速率 $R_{\\text{total}}$ 是所有三个流的单个数据速率之和：\n$$R_{\\text{total}} = R_1 + R_2 + R_3 = \\frac{S_1}{T_1} + \\frac{S_2}{T_2} + \\frac{S_3}{T_3}$$\n\n那么，总线利用率 $U$ 由下式给出：\n$$U = \\frac{R_{\\text{total}}}{B}$$\n其中 $B$ 是总线线路速率。\n\n代入给定值：\n- 流 $1$：$S_1 = 800$ 比特，$T_1 = 5 \\times 10^{-3}$ 秒。\n- 流 $2$：$S_2 = 1200$ 比特，$T_2 = 1.0 \\times 10^{-2}$ 秒。\n- 流 $3$：$S_3 = 400$ 比特，$T_3 = 2 \\times 10^{-3}$ 秒。\n- 总线线路速率：$B = 1.0 \\times 10^{7}$ 比特/秒。\n\n各个数据速率为：\n$$R_1 = \\frac{800}{5 \\times 10^{-3}} = 160000 \\text{ 比特/秒} = 1.6 \\times 10^5 \\text{ 比特/秒}$$\n$$R_2 = \\frac{1200}{1.0 \\times 10^{-2}} = 120000 \\text{ 比特/秒} = 1.2 \\times 10^5 \\text{ 比特/秒}$$\n$$R_3 = \\frac{400}{2 \\times 10^{-3}} = 200000 \\text{ 比特/秒} = 2.0 \\times 10^5 \\text{ 比特/秒}$$\n\n总数据速率为：\n$$R_{\\text{total}} = (1.6 + 1.2 + 2.0) \\times 10^5 = 4.8 \\times 10^5 \\text{ 比特/秒}$$\n\n总线利用率为：\n$$U = \\frac{4.8 \\times 10^5}{1.0 \\times 10^7} = 0.048$$\n\n四舍五入到四位有效数字，利用率为 $0.04800$。\n\n**第 2 部分：联合可行性裕度 ($m$)**\n\n流 $1$ 的联合可行性裕度 $m$ 定义为 $m = \\min\\{L_{\\mathrm{req}} - L_{\\max},\\; J_{\\mathrm{req}} - J_{\\max}\\}$。这需要计算流 $1$ 的最坏情况网络延迟 ($L_{\\max}$) 和最坏情况网络延迟抖动 ($J_{\\max}$)。\n\n系统使用时分多址 (TDMA) 调度，主周期为 $C = 6.0 \\times 10^{-4}$ 秒。流 $1$ 在每个 TDMA 周期中被分配一个专用时隙。这意味着流 $1$ 的传输在时间上与流 $2$ 和流 $3$ 是隔离的。因此，对流 $1$ 的延迟和抖动分析仅取决于其自身的参数和 TDMA 周期特性。\n\n消息的网络延迟是指从其发布到传输完成的总时间。它是等待分配时隙的时间与序列化（传输）延迟之和。\n\n流 $1$ 的序列化延迟 $d_{\\text{ser},1}$ 为：\n$$d_{\\text{ser},1} = \\frac{S_1}{B} = \\frac{800 \\text{ 比特}}{1.0 \\times 10^7 \\text{ 比特/秒}} = 8.0 \\times 10^{-5} \\text{ 秒}$$\n\n问题陈述，流 $1$ 消息的发布与 TDMA 周期没有相位对齐。这意味着消息可以在相对于其分配时隙的任何时间发布。\n\n最坏情况网络延迟 $L_{\\max}$ 发生在消息在其分配的时隙刚开始后就准备好传输的情况下。在这种情况下，消息必须等待下一个 TDMA 周期中的时隙。因此，最大等待时间是一个完整 TDMA 周期的持续时间，即 $C$。\n总的最坏情况延迟是这个最大等待时间与序列化延迟之和：\n$$L_{\\max} = C + d_{\\text{ser},1}$$\n$$L_{\\max} = 6.0 \\times 10^{-4} \\text{ s} + 8.0 \\times 10^{-5} \\text{ s} = 6.0 \\times 10^{-4} \\text{ s} + 0.8 \\times 10^{-4} \\text{ s} = 6.8 \\times 10^{-4} \\text{ s}$$\n\n最好情况网络延迟 $L_{\\min}$ 发生于消息在其时隙开始前一刻发布。等待时间实际上为零，延迟仅为序列化延迟。\n$$L_{\\min} = d_{\\text{ser},1} = 8.0 \\times 10^{-5} \\text{ s}$$\n\n网络延迟抖动 $J_{\\max}$ 定义为网络延迟的最大变化量。这是最坏情况延迟和最好情况延迟之间的差值。\n$$J_{\\max} = L_{\\max} - L_{\\min} = (C + d_{\\text{ser},1}) - d_{\\text{ser},1} = C$$\n$$J_{\\max} = 6.0 \\times 10^{-4} \\text{ s}$$\n\n现在，我们可以使用流 $1$ 的给定要求来计算可行性裕度：\n- 延迟要求：$L_{\\mathrm{req}} = 1.0 \\times 10^{-3}$ 秒。\n- 抖动要求：$J_{\\mathrm{req}} = 7.0 \\times 10^{-4}$ 秒。\n\n延迟裕度为：\n$$L_{\\mathrm{req}} - L_{\\max} = 1.0 \\times 10^{-3} - 6.8 \\times 10^{-4} = 10.0 \\times 10^{-4} - 6.8 \\times 10^{-4} = 3.2 \\times 10^{-4} \\text{ s}$$\n\n抖动裕度为：\n$$J_{\\mathrm{req}} - J_{\\max} = 7.0 \\times 10^{-4} - 6.0 \\times 10^{-4} = 1.0 \\times 10^{-4} \\text{ s}$$\n\n联合可行性裕度 $m$ 是这两个值中的最小值：\n$$m = \\min\\{3.2 \\times 10^{-4} \\text{ s}, 1.0 \\times 10^{-4} \\text{ s}\\} = 1.0 \\times 10^{-4} \\text{ s}$$\n\n问题要求将 $m$ 以毫秒表示。\n$$m = 1.0 \\times 10^{-4} \\text{ s} \\times \\frac{1000 \\text{ ms}}{1 \\text{ s}} = 0.1 \\text{ ms}$$\n\n四舍五入到四位有效数字，裕度为 $0.1000$ 毫秒。\n\n总而言之，计算出的值为：\n- 总线利用率 $U = 0.04800$。\n- 联合可行性裕度 $m = 0.1000$ 毫秒。\n最终答案是有序对 $(U, m)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.04800  0.1000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在评估了基本的性能指标之后，我们进一步探讨更复杂的动态系统行为。本练习将展示如何利用 ADL 来建模和推理并发问题，特别是“优先级反转”这一危险现象。通过分析一个在 AADL 中描述的场景，您将学习如何识别导致此问题的条件，并评估可在 ADL 中直接指定的不同架构性缓解措施（例如优先级继承），以保证系统的正确性。",
            "id": "4205715",
            "problem": "一种以体系结构分析与设计语言（AADL）表示的体系结构描述语言（ADL）模型，指定了一个赛博物理系统及其数字孪生，它们在实时操作系统（RTOS）下，使用固定优先级、完全抢占式调度共享一个单核处理器。ADL声明了三个绑定到同一处理器的线程和一个带有互斥锁的共享内存组件DataBuffer。ADL默认将锁策略设置为先进先出（FIFO）互斥锁，且不带优先级继承。三个线程的优先级和时序参数声明如下：ActuatorControl线程 ($T_H$) 的优先级 $p_H = 90$，周期 $T_H = 10$ ms，相对截止时间 $D_H = 10$ ms，最坏情况执行时间 $C_H = 2$ ms，其中包括一个在DataBuffer上的持续时间为 $1$ ms 的临界区；SensorFusion线程 ($T_M$) 的优先级 $p_M = 60$，周期 $T_M = 15$ ms，相对截止时间 $D_M = 15$ ms，最坏情况执行时间 $C_M = 9$ ms，该线程不访问DataBuffer；Logger线程 ($T_L$) 的优先级 $p_L = 10$，周期 $T_L = 50$ ms，相对截止时间 $D_L = 50$ ms，最坏情况执行时间 $C_L = 5$ ms，其中包括一个在DataBuffer上的持续时间为 $3$ ms 的临界区。ADL部署将共享的DataBuffer和所有三个线程绑定到同一处理器和同一内存上，并采用上述默认的互斥锁策略。在最坏情况模式下，释放的偏移量为：$O_L = 0$ ms，$O_H = 1$ ms，$O_M = 1.5$ ms。所有的执行时间和临界区持续时间都是可行的，并与硬件一致。\n\n仅使用固定优先级抢占式调度、互斥和阻塞的基本定义（不使用专门的协议公式），推断所声明的配置是否会为$T_H$产生优先级反转，以及这种反转是否会导致$T_H$的截止时间错失。然后，考虑ADL可以表达的体系结构缓解措施（例如，通过属性更改或组件重新设计）来消除无界反转，同时保持有界延迟。选择所有正确识别此部署中发生优先级反转的条件，并提出一种可在ADL级别表达且在给定假设下正确的有效体系结构缓解措施的选项。\n\nA. 当$T_L$持有DataBuffer互斥锁，$T_H$请求同一个互斥锁并被阻塞，而$T_M$在$T_L$释放互斥锁之前抢占了它时，发生优先级反转；一种缓解措施是在ADL中为DataBuffer互斥锁启用优先级继承，这样当$T_H$被阻塞时，$T_L$会临时以优先级$p_H$执行，从而防止被$T_M$抢占，并将$T_H$的阻塞时间限制在使用该资源的所有较低优先级线程的最长临界区时间内。\n\nB. 在此部署中，只有当$T_M$也使用DataBuffer时才会发生优先级反转；一种缓解措施是用读写锁替换互斥锁，将$T_L$指定为写入者，$T_H$指定为读取者，从而防止它们之间的阻塞。\n\nC. 在任何单核固定优先级系统中，只要有任何较低优先级的线程访问任何共享资源，就必然会发生优先级反转；一种缓解措施是在内核级别将所有互斥锁设为不可抢占，这可以消除优先级反转，而不会影响较高优先级线程的可调度性。\n\nD. 发生优先级反转是因为共享资源通过ADL绑定到一个具有可变仲裁的非确定性总线上；一种缓解措施是将$T_H$迁移到一个总线访问具有更高优先级的核心上，从而消除阻塞。\n\nE. 当$T_L$持有DataBuffer互斥锁，$T_H$请求该互斥锁并被阻塞，而$T_M$——尽管不使用DataBuffer——抢占了$T_L$时，发生优先级反转；一种缓解措施是将DataBuffer重新设计为一个无锁的单生产者单消费者（SPSC）环形缓冲区，具有有界原子操作和适当的内存屏障，在ADL中声明为一种无锁同步类型，条件是$T_L$是唯一的生产者，$T_H$是唯一的消费者，并且缓冲区容量$N$的大小足以避免由生产者引起的阻塞。",
            "solution": "问题陈述是实时系统分析中的一个有效练习。它为在单核处理器上根据固定优先级抢占策略调度的三个线程提供了一套完整且一致的参数，包括它们的时序属性、优先级以及通过一个没有优先级继承的标准互斥锁保护的共享资源的交互。该场景在既有的调度理论中有科学依据，并且为分析优先级反转现象及其对系统可调度性的影响提供了一个适定问题。\n\n中心任务是分析影响最高优先级线程$T_H$的优先级反转的可能性，并评估所提出的体系结构缓解措施。\n\n**1. 优先级反转条件分析**\n\n当高优先级线程被迫等待低优先级线程时，就会发生优先级反转。当这种等待的持续时间不仅取决于低优先级线程在其临界区花费的时间，而且被中等优先级线程的执行所延长时，问题就变得严重，导致“无界”优先级反转。\n\n给定的系统是这种现象的一个教科书式的案例：\n-   $T_H$ 具有最高优先级 ($p_H=90$)。\n-   $T_M$ 具有中等优先级 ($p_M=60$)。\n-   $T_L$ 具有最低优先级 ($p_L=10$)。\n-   $T_H$ 和 $T_L$ 共享一个由互斥锁保护的资源 `DataBuffer`。\n-   $T_M$ 不使用该资源，但可以抢占 $T_L$。\n-   互斥锁策略不包括优先级继承。\n\n一个最坏情况的场景如下展开：\n1.  低优先级线程 $T_L$ 开始执行并获取 `DataBuffer` 的互斥锁。\n2.  高优先级线程 $T_H$ 被释放。它抢占 $T_L$ 并开始执行。\n3.  $T_H$ 试图获取 `DataBuffer` 的互斥锁，发现它被 $T_L$ 锁定，于是阻塞（从“运行”状态转移到“阻塞”状态）。\n4.  调度器现在必须运行就绪队列中优先级最高的线程。由于 $T_H$ 被阻塞，调度器考虑 $T_M$ 和 $T_L$。\n5.  准备运行的中等优先级线程 $T_M$ 的优先级高于 $T_L$ ($p_M > p_L$)。因此，$T_M$ 抢占 $T_L$。\n6.  $T_M$ 运行。在这整个期间，$T_H$ 仍然被阻塞，等待 $T_L$ 释放互斥锁。然而，$T_L$ 无法运行以释放互斥锁，因为它正被 $T_M$ 抢占。\n\n$T_H$ 所经历的阻塞持续时间是 $T_L$ 剩余临界区时间和 $T_M$ 整个执行时间的总和。这是经典的无界优先级反转问题。\n\n**2. 对$T_H$的截止时间错失分析**\n\n我们将根据最坏情况参数构建一个时间轴，以确定$T_H$是否会错失其截止时间。\n-   偏移量: $O_L = 0$ ms, $O_H = 1$ ms, $O_M = 1.5$ ms。\n-   在时间 $t=0$ ms，$T_L$被释放。假设它开始执行并立即进入其最坏持续时间为 $3$ ms 的临界区。\n-   在时间 $t=1$ ms，$T_H$被释放。由于 $p_H > p_L$，$T_H$ 抢占 $T_L$。此时 $T_L$ 在其临界区内已执行了 $1$ ms。\n-   在时间 $t=1.5$ ms，$T_M$被释放。然而，$T_H$ 仍在运行（$p_H > p_M$），所以 $T_M$ 被放入就绪队列。\n-   $T_H$ 的最坏情况执行时间（WCET）为 $C_H = 2$ ms，其中包括一个 $1$ ms 的临界区。我们假设阻塞的最坏情况，即 $T_H$ 首先执行其非临界区部分。这需要 $C_H - (\\text{临界区持续时间}) = 2 - 1 = 1$ ms。所以，$T_H$ 从 $t=1$ ms 运行到 $t=2$ ms。\n-   在时间 $t=2$ ms，$T_H$ 试图锁定互斥锁。它发现互斥锁被 $T_L$ 持有，于是阻塞。\n-   调度器现在分派就绪队列中优先级最高的线程。这是在 $t=1.5$ ms 释放的 $T_M$（优先级 $60$）。\n-   $T_M$ 在 $t=2$ ms 开始执行。它运行其完整的WCET，$C_M=9$ ms。\n-   $T_M$ 在 $t = 2 + 9 = 11$ ms 完成执行。\n-   在时间 $t=11$ ms，就绪队列中优先级最高的线程是 $T_L$（优先级 $10$）。$T_H$ 仍处于阻塞状态。\n-   $T_L$ 恢复执行以完成其临界区。它已经运行了 $1$ ms，所以还需要 $3 - 1 = 2$ more ms。它从 $t=11$ ms 运行到 $t=13$ ms。\n-   在时间 $t=13$ ms，$T_L$ 释放互斥锁。\n-   互斥锁一经释放，$T_H$ 就变为非阻塞和就绪状态。由于它具有最高优先级，它抢占 $T_L$ 并开始执行其临界区。\n-   $T_H$ 运行其 $1$ ms 的临界区，从 $t=13$ ms 到 $t=14$ ms。\n-   在时间 $t=14$ ms，$T_H$ 的第一个作业完成。\n-   $T_H$ 这个作业的截止时间是其释放时间加上其相对截止时间：$D_{H,abs} = O_H + D_H = 1 + 10 = 11$ ms。\n-   由于作业在 $14$ ms 完成，晚于其 $11$ ms 的截止时间，线程 $T_H$ 错失了其截止时间。\n分析证实，指定的配置可以产生优先级反转，并且这种反转可以直接导致高优先级线程的截止时间错失。\n\n**3. 选项评估**\n\n**选项 A：** 当$T_L$持有DataBuffer互斥锁，$T_H$请求同一个互斥锁并被阻塞，而$T_M$在$T_L$释放互斥锁之前抢占了它时，发生优先级反转；一种缓解措施是在ADL中为DataBuffer互斥锁启用优先级继承，这样当$T_H$被阻塞时，$T_L$会临时以优先级$p_H$执行，从而防止被$T_M$抢占，并将$T_H$的阻塞时间限制在使用该资源的所有较低优先级线程的最长临界区时间内。\n-   **分析**：此选项完美准确地描述了我们在分析中识别出的无界优先级反转场景。所提出的缓解措施，即启用优先级继承，是标准的解决方案。当 $T_L$ 持有锁并阻塞 $T_H$ 时，$T_L$ 将继承 $T_H$ 的优先级，变为 $p_L' = p_H = 90$。因此，$T_M$（优先级为 $p_M=60$）将无法抢占 $T_L$。$T_L$ 将完成其临界区（最多 $3$ ms），释放锁，然后 $T_H$ 就可以继续。这将 $T_H$ 的阻塞时间限制在 $T_L$ 临界区的持续时间（$3$ ms）内，从而防止截止时间错失（新的响应时间最多为 $C_H + \\text{阻塞时间} = 2+3=5$ ms，小于 $D_H=10$ ms）。这样的策略是RTOS中的标准功能，并且在像AADL这样的ADL中是可配置的。\n-   **结论**：**正确**。\n\n**选项 B：** 在此部署中，只有当$T_M$也使用DataBuffer时才会发生优先级反转；一种缓解措施是用读写锁替换互斥锁，将$T_L$指定为写入者，$T_H$指定为读取者，从而防止它们之间的阻塞。\n-   **分析**：这个前提是错误的。严重的优先级反转问题恰恰是因为 $T_M$ *不*使用互斥锁并且可以自由抢占 $T_L$。提出的缓解措施也是有缺陷的。读写锁不允许在写入者（$T_L$）持有锁时让读取者（$T_H$）继续进行。写入者需要独占访问权。因此，$T_H$ 仍然会因 $T_L$ 而阻塞，并且被 $T_M$ 抢占的优先级反转场景将保持不变。\n-   **结论**：**不正确**。\n\n**选项 C：** 在任何单核固定优先级系统中，只要有任何较低优先级的线程访问任何共享资源，就必然会发生优先级反转；一种缓解措施是在内核级别将所有互斥锁设为不可抢占，这可以消除优先级反转，而不会影响较高优先级线程的可调度性。\n-   **分析**：最初的前提过于泛化。虽然高优先级线程被低优先级线程阻塞在技术上是优先级反转，但它并不总是“无界的”或有问题的。严重的情况需要特定的三级优先级交互。提出的缓解措施，即使用不可抢占的临界区，确实可以防止反转场景。然而，“不影响较高优先级线程的可调度性”这一说法是错误的。由低优先级线程执行的不可抢占区域将阻止任何更高优先级的线程在其持续时间内运行，即使更高优先级的线程不使用共享资源。这引入了另一种形式的阻塞，可能对可调度性产生负面影响。\n-   **结论**：**不正确**。\n\n**选项 D：** 发生优先级反转是因为共享资源通过ADL绑定到一个具有可变仲裁的非确定性总线上；一种缓解措施是将$T_H$迁移到一个总线访问具有更高优先级的核心上，从而消除阻塞。\n-   **分析**：该选项引入了问题中未提供的事实。问题陈述明确指出是“单核处理器”，并将问题归因于调度和锁定策略。没有提到总线架构。由于系统只有一个核心，所提出的缓解措施是不可能的。其推理与所提供的问题描述完全脱节。\n-   **结论**：**不正确**。\n\n**选项 E：** 当$T_L$持有DataBuffer互斥锁，$T_H$请求该互斥锁并被阻塞，而$T_M$——尽管不使用DataBuffer——抢占了$T_L$时，发生优先级反转；一种缓解措施是将DataBuffer重新设计为一个无锁的单生产者单消费者（SPSC）环形缓冲区，具有有界原子操作和适当的内存屏障，在ADL中声明为一种无锁同步类型，条件是$T_L$是唯一的生产者，$T_H$是唯一的消费者，并且缓冲区容量$N$的大小足以避免由生产者引起的阻塞。\n-   **分析**：对优先级反转条件的描述与选项A相同，是正确的。提出的缓解措施涉及对共享组件进行根本性的体系结构重新设计，以使用无锁算法。SPSC队列是无锁数据结构的经典示例，它完全避免了互斥锁，从而消除了因互斥而导致的阻塞以及相关的优先级反转的可能性。这是一种有效且先进的缓解策略。该选项正确地指出了此特定设计模式的必要前提条件（单一生产者/消费者角色）。这样的体系结构模式可以在ADL中表达，代表了组件设计和同步属性的变更。\n-   **结论**：**正确**。",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "本练习将视角从单个系统分析扩展到管理整个系统家族（即产品线）。它展示了 ADL 如何与特征模型相结合，为定义可变性与自动验证配置提供一个强大的框架。您将解决一个组合优化问题，在多个相互竞争的约束（如性能、成本、安全性和兼容性）之间进行权衡，以确定所有有效产品配置的集合，这体现了 ADL 在支持高层级设计空间探索与决策方面的能力。",
            "id": "4205712",
            "problem": "考虑一个信息物理系统数字孪生产品线，其可变性由一个特征图建模。特征受体系结构描述语言 (ADL) 属性的约束，这些属性强制要求结构完整性和定量资源边界。该系统具有统一的处理流水线：对所有选定的传感器应用单一的压缩方法和单一的加密方法。以下定义、选项和约束成立。\n\n- 基本基础：\n  - 体系结构描述语言 (ADL) 指定组件、连接件和属性。结构完整性要求跨传感器的数据流转换保持统一，以及选择之间的兼容性。定量属性限制了端到端的资源使用。\n  - 特征图将可变性定义为在备选项和可选项中的选择，并受制于从 ADL 属性派生的跨树约束。\n  - 总线容量约束要求传输数据速率的总和不超过所选总线的容量。\n  - 计算预算约束要求压缩和加密的总计算成本不超过所选计算平台的预算。\n\n- 缩略语：\n  - 体系结构描述语言 (ADL)。\n  - 信息物理系统 (CPS)。\n  - 控制器局域网络 (CAN)。\n  - 时间敏感网络 (TSN)。\n  - 高级加密标准 (AES)。\n\n- 传感器类型和原始数据速率：\n  - IMU: $5$ Mbps。\n  - Lidar: $100$ Mbps。\n  - Camera: $200$ Mbps。\n  每个配置必须从 $\\{\\text{IMU}, \\text{Lidar}, \\text{Camera}\\}$ 中选择恰好两个不同的传感器。\n\n- 通信总线备选项：\n  - CAN: 容量 $50$ Mbps。\n  - TSN: 容量 $1000$ Mbps。\n\n- 压缩方法备选项（统一应用于所有选定的传感器）：\n  - 无：压缩比 $r=1$，压缩成本系数 $k_{c}=0$ 单位/Mbps。\n  - LZ4：压缩比 $r=\\frac{3}{5}$，压缩成本系数 $k_{c}=0.2$ 单位/Mbps。\n  - Zstd：压缩比 $r=\\frac{2}{5}$，压缩成本系数 $k_{c}=0.5$ 单位/Mbps。\n\n- 加密方法备选项（统一应用于所有选定的传感器）：\n  - 无：开销因子 $\\alpha=0$，加密成本系数 $k_{e}=0$ 单位/Mbps。\n  - AES-128：开销因子 $\\alpha=0.1$，加密成本系数 $k_{e}=1.0$ 单位/Mbps。\n  - AES-256：开销因子 $\\alpha=0.2$，加密成本系数 $k_{e}=1.5$ 单位/Mbps。\n\n- 计算平台备选项和预算：\n  - 仅 CPU：预算 $250$ 单位。\n  - CPU+GPU：预算 $400$ 单位。\n  - CPU+FPGA：预算 $500$ 单位。\n\n- ADL 派生的结构完整性和跨树约束：\n  1. 统一性：必须选择单一的压缩方法和单一的加密方法，并统一应用于两个传感器。\n  2. 摄像头隐私策略：如果选择了任何摄像头，加密方式不能为“无”（即加密必须是 AES-128 或 AES-256）。\n  3. 兼容性：AES-256 要求使用 TSN 作为总线。\n  4. 平台支持：在“仅 CPU”平台上，不允许使用 Zstd 和 AES-256。\n  5. 定量约束：\n     - 总线容量：传输速率总和 $D_{\\text{tx}}$ 必须满足 $D_{\\text{tx}} \\leq$ 总线容量。\n     - 计算预算：总计算成本 $K_{\\text{tot}}$ 必须满足 $K_{\\text{tot}} \\leq$ 所选平台预算。\n  原始速率为 $d$ 的单个传感器的传输速率为 $d \\cdot r \\cdot (1+\\alpha)$。两个传感器的总传输速率是所选传感器对中各项速率的总和。单个传感器的计算成本为 $k_{c}\\cdot d + k_{e}\\cdot (r\\cdot d)$，总计算成本是所选传感器对中各项成本的总和。\n\n计算满足所有结构完整性和定量约束的有效配置的数量，其中一个配置是一套完整的选择，包括：\n- 恰好两个不同的传感器，\n- 一个总线，\n- 一种压缩方法，\n- 一种加密方法，\n- 一个计算平台。\n\n将您的最终答案表示为一个精确的整数（无单位）。无需四舍五入。",
            "solution": "我们从 ADL 原则开始：组件（传感器、总线、处理平台）和连接件（压缩和加密转换）必须满足结构统一性和兼容性。定量属性通过总线容量和计算预算来限制资源使用。特征图提供了离散的可变性；有效配置是那些满足 ADL 派生约束的选择。\n\n设原始数据速率为 $d_{\\text{IMU}}=5$，$d_{\\text{Lidar}}=100$，$d_{\\text{Camera}}=200$（单位均为 Mbps）。从集合中选择恰好两个不同的传感器，产生三种可能的组合：\n- 组合 A：IMU + Lidar，总原始速率 $D_{A}=5+100=105$。\n- 组合 B：IMU + Camera，总原始速率 $D_{B}=5+200=205$。\n- 组合 C：Lidar + Camera，总原始速率 $D_{C}=100+200=300$。\n\n统一的压缩和加密意味着：\n- 原始速率为 $d$ 的单个传感器的传输速率为 $d\\cdot r \\cdot (1+\\alpha)$。\n- 一个传感器组合的总传输速率为 $D \\cdot r \\cdot (1+\\alpha)$，其中 $D$ 是该组合的原始速率之和。\n- 单个传感器的计算成本为 $k_{c}\\cdot d + k_{e}\\cdot (r\\cdot d)$，因此一个组合的总计算成本为 $K_{\\text{tot}}=D \\cdot (k_{c} + k_{e} r)$。\n\n压缩选项：无 $(r=1, k_{c}=0)$，LZ4 $(r=\\frac{3}{5}, k_{c}=0.2)$，Zstd $(r=\\frac{2}{5}, k_{c}=0.5)$。加密选项：无 $(\\alpha=0, k_{e}=0)$，AES-128 $(\\alpha=0.1, k_{e}=1.0)$，AES-256 $(\\alpha=0.2, k_{e}=1.5)$。总线容量：CAN $50$ Mbps，TSN $1000$ Mbps。平台预算：仅 CPU $250$，CPU+GPU $400$，CPU+FPGA $500$。结构约束：摄像头要求加密 $\\neq$ 无；AES-256 要求 TSN；“仅 CPU”平台不允许使用 Zstd 和 AES-256。\n\n步骤1：总线容量可行性。\n\n对于每个组合 $D$ 和选择 $(r,\\alpha)$，总传输速率为 $D_{\\text{tx}}=D \\cdot r \\cdot (1+\\alpha)$。TSN 的容量为 $1000$ Mbps，因此所有组合在 TSN 上都是可行的。对于容量为 $50$ Mbps 的 CAN，我们检查其可行性：\n\n- 组合 A ($D_{A}=105$)：\n  - 无压缩 $(r=1)$：\n    - 无加密 $(\\alpha=0)$: $105 \\cdot 1 \\cdot 1 = 105$ (不可行)。\n    - AES-128 $(\\alpha=0.1)$: $105 \\cdot 1 \\cdot 1.1 = 115.5$ (不可行)。\n    - AES-256 $(\\alpha=0.2)$: $105 \\cdot 1 \\cdot 1.2 = 126$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$：\n    - 无: $105 \\cdot \\frac{3}{5} \\cdot 1 = 63$ (不可行)。\n    - AES-128: $105 \\cdot \\frac{3}{5} \\cdot 1.1 = 69.3$ (不可行)。\n    - AES-256: $105 \\cdot \\frac{3}{5} \\cdot 1.2 = 75.6$ (不可行)。\n  - Zstd $(r=\\frac{2}{5})$：\n    - 无: $105 \\cdot \\frac{2}{5} \\cdot 1 = 42$ (可行)。\n    - AES-128: $105 \\cdot \\frac{2}{5} \\cdot 1.1 = 46.2$ (可行)。\n    - AES-256: $105 \\cdot \\frac{2}{5} \\cdot 1.2 = 50.4$ (不可行)。\n  注意，无论如何，AES-256 在结构上与 CAN 不兼容。\n\n- 组合 B ($D_{B}=205$，存在摄像头，要求加密)：\n  - Zstd $(r=\\frac{2}{5})$，AES-128: $205 \\cdot \\frac{2}{5} \\cdot 1.1 = 90.2$ (不可行)。\n  - Zstd, AES-256: $205 \\cdot \\frac{2}{5} \\cdot 1.2 = 98.4$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$，AES-128: $205 \\cdot \\frac{3}{5} \\cdot 1.1 = 135.3$ (不可行)。\n  - LZ4, AES-256: $205 \\cdot \\frac{3}{5} \\cdot 1.2 = 147.6$ (不可行)。\n  - 无 $(r=1)$，AES-128: $205 \\cdot 1 \\cdot 1.1 = 225.5$ (不可行)。\n  - 无, AES-256: $205 \\cdot 1 \\cdot 1.2 = 246$ (不可行)。\n  因此，没有包含摄像头的组合在 CAN 上是可行的。\n\n- 组合 C ($D_{C}=300$，存在摄像头，要求加密)：\n  - Zstd $(r=\\frac{2}{5})$，AES-128: $300 \\cdot \\frac{2}{5} \\cdot 1.1 = 132$ (不可行)。\n  - Zstd, AES-256: $300 \\cdot \\frac{2}{5} \\cdot 1.2 = 144$ (不可行)。\n  - LZ4 $(r=\\frac{3}{5})$，AES-128: $300 \\cdot \\frac{3}{5} \\cdot 1.1 = 198$ (不可行)。\n  - LZ4, AES-256: $300 \\cdot \\frac{3}{5} \\cdot 1.2 = 216$ (不可行)。\n  - 无 $(r=1)$，AES-128: $300 \\cdot 1 \\cdot 1.1 = 330$ (不可行)。\n  - 无, AES-256: $300 \\cdot 1 \\cdot 1.2 = 360$ (不可行)。\n  因此，没有包含摄像头的组合在 CAN 上是可行的。唯一在 CAN 上可行的案例是组合 A 使用 Zstd 以及“无”或 AES-128 加密（受其他约束限制）。\n\n步骤2：计算预算可行性。\n\n原始速率和为 $D$ 的一个组合的总计算成本为 $K_{\\text{tot}}=D\\cdot(k_{c}+k_{e}r)$。\n\n计算组合 A ($D_{A}=105$) 的值：\n- 无压缩 $(r=1)$：\n  - 无加密: $105\\cdot(0+0\\cdot 1)=0$。\n  - AES-128: $105\\cdot(0+1\\cdot 1)=105$。\n  - AES-256: $105\\cdot(0+1.5\\cdot 1)=157.5$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无: $105\\cdot(0.2+0\\cdot \\frac{3}{5})=21$。\n  - AES-128: $105\\cdot(0.2+1\\cdot \\frac{3}{5})=105\\cdot 0.8=84$。\n  - AES-256: $105\\cdot(0.2+1.5\\cdot \\frac{3}{5})=105\\cdot 1.1=115.5$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无: $105\\cdot(0.5+0\\cdot \\frac{2}{5})=52.5$。\n  - AES-128: $105\\cdot(0.5+1\\cdot \\frac{2}{5})=105\\cdot 0.9=94.5$。\n  - AES-256: $105\\cdot(0.5+1.5\\cdot \\frac{2}{5})=105\\cdot 1.1=115.5$。\n所有值都 $\\leq 250$，$\\leq 400$ 和 $\\leq 500$，因此计算预算对组合 A 没有约束力。\n\n计算组合 B ($D_{B}=205$) 的值：\n- 无 $(r=1)$：\n  - AES-128: $205\\cdot 1=205$。\n  - AES-256: $205\\cdot 1.5=307.5$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无: $205\\cdot 0.2=41$。\n  - AES-128: $205\\cdot 0.8=164$。\n  - AES-256: $205\\cdot 1.1=225.5$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无: $205\\cdot 0.5=102.5$。\n  - AES-128: $205\\cdot 0.9=184.5$。\n  - AES-256: $205\\cdot 1.1=225.5$。\n所有值都 $\\leq 400$ 和 $\\leq 500$。在“仅 CPU”平台（预算 $250$）上，只有“无压缩+AES-256”超出预算（$307.5$），但无论如何，“仅 CPU”平台在结构上不允许使用 AES-256 和 Zstd。\n\n计算组合 C ($D_{C}=300$) 的值：\n- 无 $(r=1)$：\n  - AES-128: $300\\cdot 1=300$。\n  - AES-256: $300\\cdot 1.5=450$。\n- LZ4 $(r=\\frac{3}{5})$：\n  - 无: $300\\cdot 0.2=60$。\n  - AES-128: $300\\cdot 0.8=240$。\n  - AES-256: $300\\cdot 1.1=330$。\n- Zstd $(r=\\frac{2}{5})$：\n  - 无: $300\\cdot 0.5=150$。\n  - AES-128: $300\\cdot 0.9=270$。\n  - AES-256: $300\\cdot 1.1=330$。\n对于“仅 CPU”平台（预算 $250$），“无压缩+AES-128”超出预算（$300>250$），LZ4+AES-256 和 Zstd+AES-128 也超出预算（$330$，$270$）；然而，“仅 CPU”平台在结构上不允许使用 AES-256 和 Zstd。对于 CPU+GPU（预算 $400$），除了“无压缩+AES-256”（$450$）外，所有组合都在预算内。对于 CPU+FPGA（预算 $500$），所有组合都在预算内。\n\n步骤3：计算有效配置数量，同时遵守所有结构约束。\n\n我们按总线类型和传感器组合进行计数。\n\n- CAN:\n  - 组合 A 仅在使用 Zstd 且加密方式为 $\\{\\text{无}, \\text{AES-128}\\}$ 之一时可行。AES-256 与 CAN 不兼容；“仅 CPU”平台不允许使用 Zstd，因此只允许使用 CPU+GPU 和 CPU+FPGA 平台。\n    - 加密选择：$2$ 种（无，AES-128）。\n    - 平台：$2$ 种（CPU+GPU, CPU+FPGA）。\n    - 组合 A 的 CAN 配置总数：$2 \\times 2 = 4$。\n  - 组合 B 和 C 因容量问题在 CAN 上不可行。\n  因此 CAN 总数：$4$。\n\n- TSN:\n  所有组合都满足容量要求。应用摄像头加密要求、AES-256 兼容性和平台支持。\n\n  - 组合 A（无摄像头要求）：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256。压缩在 $\\{\\text{无}, \\text{LZ4}\\}$ 中，加密在 $\\{\\text{无}, \\text{AES-128}\\}$ 中。组合数：$2 \\times 2 = 4$。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 所有 $3$ 种加密：$3 \\times 3 = 9$。\n    - CPU+FPGA：同样为 $9$。\n    - 组合 A 在 TSN 上的总数：$4 + 9 + 9 = 22$。\n\n  - 组合 B（有摄像头，加密 $\\in \\{\\text{AES-128}, \\text{AES-256}\\}$）：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256。压缩在 $\\{\\text{无}, \\text{LZ4}\\}$ 中，加密为 $\\{\\text{AES-128}\\}$：$2 \\times 1 = 2$ （满足预算）。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 两种加密：$3 \\times 2 = 6$ （满足预算）。\n    - CPU+FPGA：$3 \\times 2 = 6$。\n    - 组合 B 在 TSN 上的总数：$2 + 6 + 6 = 14$。\n\n  - 组合 C（有摄像头，加密 $\\in \\{\\text{AES-128}, \\text{AES-256}\\}$）：\n    - 仅 CPU：不允许 Zstd，不允许 AES-256；压缩为 $\\{\\text{无}, \\text{LZ4}\\}$，加密为 $\\{\\text{AES-128}\\}$。“无压缩+AES-128”超出预算（$300>250$），LZ4+AES-128 在预算内（$240\\leq 250$）。所以有 $1$ 个有效组合。\n    - CPU+GPU：所有 $3$ 种压缩 $\\times$ 两种加密 $=6$，但“无压缩+AES-256”超出预算（$450>400$），因此有 $5$ 个有效组合。\n    - CPU+FPGA：所有 $6$ 个组合均有效（满足预算）。\n    - 组合 C 在 TSN 上的总数：$1 + 5 + 6 = 12$。\n\n  TSN 总数：$22 + 14 + 12 = 48$。\n\n总结所有总线类型，有效配置的总数为 $4$ (CAN) + $48$ (TSN) = $52$。\n\n因此，满足所有 ADL 派生的结构完整性和定量约束的有效配置数量为 $52$。",
            "answer": "$$\\boxed{52}$$"
        }
    ]
}