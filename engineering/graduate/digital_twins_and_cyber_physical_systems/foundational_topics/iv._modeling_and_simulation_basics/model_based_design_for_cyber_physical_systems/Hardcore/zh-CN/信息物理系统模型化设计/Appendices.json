{
    "hands_on_practices": [
        {
            "introduction": "信息物理系统（CPS）的数字孪生必须精确地模拟物理世界与数字世界之间的接口。模数转换器（ADC）是这一接口的关键，它将连续的物理信号转换为离散的数字数据。本练习从第一性原理出发，探讨量化过程中的基本性能指标——量化步长和信号量化噪声比（SQNR），帮助你理解传感数据数字孪生保真度的核心。",
            "id": "4231794",
            "problem": "一个信息物理系统配备了模数转换器 (ADC)，其数字孪生必须复制测量过程以忠实地捕捉闭环行为。该 ADC 是均匀的、中阶梯式的，具有 $N$ 位和 $V_{\\text{FS}}$ 的满量程峰峰值输入范围。在正常操作中，输入是一个正弦波，该正弦波在不产生削波的情况下使转换器遍历所有编码，并且抖动功能被禁用。假设以下基本建模事实：\n- 一个均匀的 $N$ 位量化器将满量程范围划分为 $2^{N}$ 个等宽的不相交编码区间。\n- 对于一个非线性但遍历地跨越所有编码且无过载的输入，瞬时量化误差 $e$ 可以被建模为一个在区间 $\\left[-\\Delta/2, \\Delta/2\\right]$ 上均匀分布的随机变量，其中 $\\Delta$ 是编码区间的宽度。\n- 对于一个正弦输入 $v(t)=A\\sin(\\omega t)$，其均方信号功率等于 $A^{2}/2$。\n- 信号量化噪声比 (SQNR) 以分贝为单位定义为 $10\\log_{10}(\\text{信号功率}/\\text{量化噪声功率})$。\n\n从这些基本定义（不使用其他公式）出发，为一个恰好适合 ADC 范围且不产生削波的满量程正弦输入，推导量化步长 $\\Delta$ 和以分贝为单位的 SQNR 的闭式表达式。然后，对于一个 $N=17$ 位且峰峰值为 $V_{\\text{FS}}=2.5$ 伏的 ADC，计算你的表达式的值。按如下要求对您的数值进行四舍五入：\n- 将 $\\Delta$ 四舍五入到六位有效数字，并以伏特为单位表示。\n- 将 SQNR 四舍五入到四位有效数字，并以分贝为单位表示。\n\n你的最终数值答案必须是按 $\\left(\\Delta,\\ \\text{SQNR}\\right)$ 顺序排列的一对值。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提出得当，并包含推导出唯一、有意义解所需的所有信息。其前提是分析模数转换器时使用的标准、教科书级别的假设。\n\n任务是推导量化步长 $\\Delta$ 和信号量化噪声比 (SQNR) 的表达式，然后为一个特定的 ADC 计算它们的值。\n\n**1. 量化步长 $\\Delta$ 的推导**\n\n问题陈述，一个均匀的 $N$ 位量化器将满量程范围 $V_{\\text{FS}}$ 划分为 $2^{N}$ 个等宽的不相交编码区间。单个编码区间的宽度，也称为量化步长或最低有效位 (LSB)，用 $\\Delta$ 表示。它通过将总范围除以编码区间的数量来计算。\n\n$$\n\\Delta = \\frac{V_{\\text{FS}}}{2^{N}}\n$$\n\n这就是所要求的量化步长的闭式表达式。\n\n**2. 信号量化噪声比 (SQNR) 的推导**\n\n以分贝 (dB) 为单位的 SQNR 定义为：\n\n$$\n\\text{SQNR} = 10\\log_{10}\\left(\\frac{\\text{信号功率}}{\\text{量化噪声功率}}\\right) = 10\\log_{10}\\left(\\frac{P_s}{P_q}\\right)\n$$\n\n为了找到 SQNR 的表达式，我们必须首先推导出信号功率 $P_s$ 和量化噪声功率 $P_q$ 的表达式。\n\n**2a. 量化噪声功率 ($P_q$)**\n\n问题指明，瞬时量化误差 $e$ 可以被建模为一个在区间 $\\left[-\\Delta/2, \\Delta/2\\right]$ 上均匀分布的随机变量。对于这样的分布，其概率密度函数 (PDF) $p(e)$ 为：\n\n$$\np(e) = \n\\begin{cases} \n\\frac{1}{\\Delta}  \\text{for } -\\frac{\\Delta}{2} \\le e \\le \\frac{\\Delta}{2} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n量化噪声功率 $P_q$ 是误差的均方值 $E[e^2]$。对于像这样的零均值分布，均方值等于方差。\n\n$$\nP_q = E[e^2] = \\int_{-\\infty}^{\\infty} e^2 p(e) \\, de = \\int_{-\\Delta/2}^{\\Delta/2} e^2 \\left(\\frac{1}{\\Delta}\\right) \\, de\n$$\n\n计算该积分：\n\n$$\nP_q = \\frac{1}{\\Delta} \\left[ \\frac{e^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left[ \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right] = \\frac{1}{3\\Delta} \\left[ \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right] = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right)\n$$\n\n$$\nP_q = \\frac{\\Delta^2}{12}\n$$\n\n**2b. 信号功率 ($P_s$)**\n\n输入信号是一个正弦波 $v(t) = A\\sin(\\omega t)$。问题陈述这是一个“恰好适合 ADC 范围且不产生削波的满量程正弦输入”。该 ADC 具有 $V_{\\text{FS}}$ 的满量程峰峰值范围。一个振幅为 $A$ 的正弦波的峰峰值为 $2A$。为了使信号恰好适合该范围，其峰峰值必须等于 $V_{\\text{FS}}$。\n\n$$\n2A = V_{\\text{FS}} \\implies A = \\frac{V_{\\text{FS}}}{2}\n$$\n\n问题提供了正弦波均方信号功率的公式：$P_s = A^2/2$。代入满量程输入的 $A$ 的表达式：\n\n$$\nP_s = \\frac{1}{2}\\left(\\frac{V_{\\text{FS}}}{2}\\right)^2 = \\frac{V_{\\text{FS}}^2}{8}\n$$\n\n**2c. 组合 SQNR 表达式**\n\n现在我们将 $P_s$ 和 $P_q$ 的表达式代入 SQNR 的定义中：\n\n$$\n\\text{SQNR} = 10\\log_{10}\\left(\\frac{P_s}{P_q}\\right) = 10\\log_{10}\\left(\\frac{V_{\\text{FS}}^2/8}{\\Delta^2/12}\\right) = 10\\log_{10}\\left(\\frac{12}{8} \\frac{V_{\\text{FS}}^2}{\\Delta^2}\\right) = 10\\log_{10}\\left(\\frac{3}{2} \\frac{V_{\\text{FS}}^2}{\\Delta^2}\\right)\n$$\n\n为了得到用 $N$ 表示的闭式表达式，我们代入 $\\Delta = V_{\\text{FS}}/2^N$：\n\n$$\n\\text{SQNR} = 10\\log_{10}\\left(\\frac{3}{2} \\frac{V_{\\text{FS}}^2}{(V_{\\text{FS}}/2^N)^2}\\right) = 10\\log_{10}\\left(\\frac{3}{2} \\frac{V_{\\text{FS}}^2}{V_{\\text{FS}}^2 / (2^N)^2}\\right) = 10\\log_{10}\\left(\\frac{3}{2} (2^N)^2\\right)\n$$\n\n$$\n\\text{SQNR} = 10\\log_{10}\\left(\\frac{3}{2} \\cdot 2^{2N}\\right)\n$$\n\n这是一个理想的 $N$ 位 ADC 在满量程正弦输入下的 SQNR 的最终闭式表达式。\n\n**3. 数值计算**\n\n问题提供了数值 $N=17$ 位和 $V_{\\text{FS}}=2.5$ 伏特。\n\n**3a. $\\Delta$ 的计算**\n\n使用推导出的 $\\Delta$ 的公式：\n\n$$\n\\Delta = \\frac{V_{\\text{FS}}}{2^N} = \\frac{2.5}{2^{17}} = \\frac{2.5}{131072} \\approx 1.90734863 \\times 10^{-5} \\, \\text{V}\n$$\n\n按要求四舍五入到六位有效数字：\n\n$$\n\\Delta \\approx 1.90735 \\times 10^{-5} \\, \\text{V}\n$$\n\n**3b. SQNR 的计算**\n\n使用 $N=17$ 时推导出的 SQNR 公式：\n\n$$\n\\text{SQNR} = 10\\log_{10}\\left(\\frac{3}{2} \\cdot 2^{2 \\times 17}\\right) = 10\\log_{10}\\left(1.5 \\cdot 2^{34}\\right)\n$$\n\n使用对数的性质，$\\log(ab) = \\log(a) + \\log(b)$ 和 $\\log(x^y) = y\\log(x)$：\n\n$$\n\\text{SQNR} = 10\\left(\\log_{10}(1.5) + 34\\log_{10}(2)\\right)\n$$\n\n使用数值 $\\log_{10}(1.5) \\approx 0.176091$ 和 $\\log_{10}(2) \\approx 0.301030$：\n\n$$\n\\text{SQNR} \\approx 10\\left(0.176091 + 34 \\times 0.301030\\right) \\approx 10\\left(0.176091 + 10.23502\\right) = 10(10.411111) \\approx 104.11111 \\, \\text{dB}\n$$\n\n按要求四舍五入到四位有效数字：\n\n$$\n\\text{SQNR} \\approx 104.1 \\, \\text{dB}\n$$\n\n最终的数值答案由序对 $(\\Delta, \\text{SQNR})$ 组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.90735 \\times 10^{-5}  104.1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在信息物理系统中，许多传感器模型本质上是非线性的，而扩展卡尔曼滤波器（EKF）等关键的状态估计算法依赖于对这些模型的线性化近似。本练习将通过一个移动机器人的实例，让你亲手实践如何使用雅可比矩阵进行非线性函数的线性化，并进一步分析测量灵敏度。掌握这项技能对于设计和调试现代机器人和自主系统中的状态估计器至关重要。",
            "id": "4231762",
            "problem": "一个平面地面机器人的数字孪生被用于在信息物理系统中进行状态估计器的基于模型的设计。机器人状态为 $x = [x, y, \\theta]^\\top$，其中 $x$ 和 $y$ 是平面坐标，$\\theta$ 是航向角。机器人通过一个方位-距离传感器观测一个位于 $(L_{x}, L_{y})$ 的固定路标，其测量函数为 $h(x) = [b(x), r(x)]^\\top$，定义如下\n$$\nb(x) = \\arctan2\\!\\big(L_{y} - y,\\, L_{x} - x\\big) - \\theta,\\quad r(x) = \\sqrt{\\big(L_{x} - x\\big)^{2} + \\big(L_{y} - y\\big)^{2}}.\n$$\n假设 $L_{x} = 5$，$L_{y} = -3$。工作点为 $x^{\\ast} = [1, -1, \\pi/4]^\\top$。该估计器是通过对测量函数在 $x^{\\ast}$ 附近进行一阶泰勒线性化来设计的，从而得到一个用于扩展卡尔曼滤波器 (EKF) 的测量雅可比矩阵。\n\n仅从 $h(x)$ 的定义和向量值函数的一阶泰勒展开出发，以符号形式推导测量雅可比矩阵 $H(x) = \\frac{\\partial h(x)}{\\partial x}$，然后计算 $H(x^{\\ast})$ 的值。将 $\\arctan2(\\cdot,\\cdot)$ 和平方根函数视为在奇点之外是光滑的，并确保所有步骤都由链式法则证明。\n\n使用你的线性化结果，考虑在归一化状态扰动下，方位分量 $b(x)$ 的测量灵敏度。设容许扰动集为\n$$\n\\mathcal{S} = \\left\\{\\, x \\in \\mathbb{R}^{3} : \\big\\|W\\big(x - x^{\\ast}\\big)\\big\\|_{\\infty} \\le \\delta \\,\\right\\},\n$$\n其中 $W = \\operatorname{diag}(0.5,\\, 0.5,\\, 1)$ 且 $\\delta = 3.1 \\times 10^{-2}$。仅使用范数对偶性和线性化中经过充分检验的结论，求出由 $\\mathcal{S}$ 中的扰动引起的方位偏差幅值 $\\big|b(x) - b(x^{\\ast})\\big|$ 的最坏情况下的线性化界，结果表示为单个实数（以弧度为单位）。将你的答案四舍五入到四位有效数字，并以弧度表示该界。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观，且不含可辨别缺陷的。它构成了状态估计中非线性系统分析的一个标准练习。因此，我们可以进行完整解答。\n\n该问题分为两部分。首先，我们为一个给定的传感器模型推导测量雅可比矩阵。其次，我们基于一阶线性化对方位测量进行最坏情况灵敏度分析。\n\n第1部分：测量雅可比矩阵的推导与求值\n\n状态向量为 $x = [x, y, \\theta]^\\top$。测量函数为 $h(x) = [b(x), r(x)]^\\top$，其中\n$$\nb(x) = \\arctan2(L_{y} - y, L_{x} - x) - \\theta\n$$\n$$\nr(x) = \\sqrt{(L_{x} - x)^{2} + (L_{y} - y)^{2}}\n$$\n测量雅可比矩阵是 $2 \\times 3$ 的矩阵 $H(x) = \\frac{\\partial h(x)}{\\partial x}$，定义为：\n$$\nH(x) = \\begin{pmatrix} \\frac{\\partial b}{\\partial x}  \\frac{\\partial b}{\\partial y}  \\frac{\\partial b}{\\partial \\theta} \\\\ \\frac{\\partial r}{\\partial x}  \\frac{\\partial r}{\\partial y}  \\frac{\\partial r}{\\partial \\theta} \\end{pmatrix}\n$$\n我们将以符号形式计算每个偏导数。为清晰起见，令 $\\Delta x = L_x - x$ 且 $\\Delta y = L_y - y$。距离的平方为 $r^2(x) = (\\Delta x)^2 + (\\Delta y)^2$。\n\n方位分量 $b(x)$ 的导数：\n函数 $f(v, u) = \\arctan2(v, u)$ 对其自变量的导数是 $\\frac{\\partial f}{\\partial u} = \\frac{-v}{u^2+v^2}$ 和 $\\frac{\\partial f}{\\partial v} = \\frac{u}{u^2+v^2}$。\n使用链式法则，令 $v = \\Delta y$ 和 $u = \\Delta x$：\n$$\n\\frac{\\partial b}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\arctan2(\\Delta y, \\Delta x) - \\theta \\right) = \\frac{\\partial \\arctan2(\\Delta y, \\Delta x)}{\\partial (\\Delta x)} \\frac{\\partial (\\Delta x)}{\\partial x} = \\frac{-\\Delta y}{(\\Delta x)^2 + (\\Delta y)^2} \\cdot (-1) = \\frac{\\Delta y}{(\\Delta x)^2 + (\\Delta y)^2} = \\frac{L_y - y}{(L_x - x)^2 + (L_y - y)^2}\n$$\n$$\n\\frac{\\partial b}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\arctan2(\\Delta y, \\Delta x) - \\theta \\right) = \\frac{\\partial \\arctan2(\\Delta y, \\Delta x)}{\\partial (\\Delta y)} \\frac{\\partial (\\Delta y)}{\\partial y} = \\frac{\\Delta x}{(\\Delta x)^2 + (\\Delta y)^2} \\cdot (-1) = \\frac{-\\Delta x}{(\\Delta x)^2 + (\\Delta y)^2} = \\frac{-(L_x - x)}{(L_x - x)^2 + (L_y - y)^2}\n$$\n对 $\\theta$ 的导数是直接的：\n$$\n\\frac{\\partial b}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\arctan2(\\Delta y, \\Delta x) - \\theta \\right) = -1\n$$\n\n距离分量 $r(x)$ 的导数：\n距离为 $r(x) = ((\\Delta x)^2 + (\\Delta y)^2)^{1/2}$。使用链式法则：\n$$\n\\frac{\\partial r}{\\partial x} = \\frac{1}{2} \\left((\\Delta x)^2 + (\\Delta y)^2\\right)^{-1/2} \\cdot \\frac{\\partial}{\\partial x}((\\Delta x)^2) = \\frac{1}{2r(x)} \\cdot 2(\\Delta x) \\frac{\\partial(\\Delta x)}{\\partial x} = \\frac{\\Delta x}{r(x)} \\cdot (-1) = \\frac{-\\Delta x}{r(x)} = \\frac{-(L_x - x)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}\n$$\n$$\n\\frac{\\partial r}{\\partial y} = \\frac{1}{2} \\left((\\Delta x)^2 + (\\Delta y)^2\\right)^{-1/2} \\cdot \\frac{\\partial}{\\partial y}((\\Delta y)^2) = \\frac{1}{2r(x)} \\cdot 2(\\Delta y) \\frac{\\partial(\\Delta y)}{\\partial y} = \\frac{\\Delta y}{r(x)} \\cdot (-1) = \\frac{-\\Delta y}{r(x)} = \\frac{-(L_y - y)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}\n$$\n距离 $r(x)$ 不依赖于 $\\theta$：\n$$\n\\frac{\\partial r}{\\partial \\theta} = 0\n$$\n\n组合成符号雅可比矩阵 $H(x)$：\n$$\nH(x) = \\begin{pmatrix}\n\\frac{L_y - y}{(L_x - x)^2 + (L_y - y)^2}  \\frac{-(L_x - x)}{(L_x - x)^2 + (L_y - y)^2}  -1 \\\\\n\\frac{-(L_x - x)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}  \\frac{-(L_y - y)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}  0\n\\end{pmatrix}\n$$\n\n现在，我们在工作点 $x^{\\ast} = [1, -1, \\pi/4]^\\top$ 和路标 $(L_x, L_y) = (5, -3)$ 处计算 $H(x)$ 的值。\n首先，计算差值和距离的平方：\n$$\n\\Delta x^{\\ast} = L_x - x^{\\ast} = 5 - 1 = 4\n$$\n$$\n\\Delta y^{\\ast} = L_y - y^{\\ast} = -3 - (-1) = -2\n$$\n$$\n(r(x^{\\ast}))^2 = (\\Delta x^{\\ast})^2 + (\\Delta y^{\\ast})^2 = 4^2 + (-2)^2 = 16 + 4 = 20\n$$\n$$\nr(x^{\\ast}) = \\sqrt{20} = 2\\sqrt{5}\n$$\n将这些值代入符号雅可比矩阵的各项中：\n$$\n\\frac{\\partial b}{\\partial x}\\bigg|_{x^{\\ast}} = \\frac{\\Delta y^{\\ast}}{(r(x^{\\ast}))^2} = \\frac{-2}{20} = -\\frac{1}{10}\n$$\n$$\n\\frac{\\partial b}{\\partial y}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta x^{\\ast}}{(r(x^{\\ast}))^2} = \\frac{-4}{20} = -\\frac{1}{5}\n$$\n$$\n\\frac{\\partial b}{\\partial \\theta}\\bigg|_{x^{\\ast}} = -1\n$$\n$$\n\\frac{\\partial r}{\\partial x}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta x^{\\ast}}{r(x^{\\ast})} = \\frac{-4}{2\\sqrt{5}} = -\\frac{2}{\\sqrt{5}} = -\\frac{2\\sqrt{5}}{5}\n$$\n$$\n\\frac{\\partial r}{\\partial y}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta y^{\\ast}}{r(x^{\\ast})} = \\frac{-(-2)}{2\\sqrt{5}} = \\frac{1}{\\sqrt{5}} = \\frac{\\sqrt{5}}{5}\n$$\n$$\n\\frac{\\partial r}{\\partial \\theta}\\bigg|_{x^{\\ast}} = 0\n$$\n求值后的雅可比矩阵为：\n$$\nH(x^{\\ast}) = \\begin{pmatrix} -1/10  -1/5  -1 \\\\ -2\\sqrt{5}/5  \\sqrt{5}/5  0 \\end{pmatrix}\n$$\n\n第2部分：测量灵敏度分析\n\n我们被要求求解在状态扰动 $x$ 属于集合 $\\mathcal{S}$ 的情况下，方位偏差幅值 $|b(x) - b(x^{\\ast})|$ 的最坏情况下的线性化界。\n$b(x)$ 在 $x^{\\ast}$ 附近的一阶泰勒展开由下式给出：\n$$\nb(x) \\approx b(x^{\\ast}) + \\nabla b(x^{\\ast})^{\\top} (x - x^{\\ast})\n$$\n其中 $\\nabla b(x^{\\ast})$ 是 $b$ 在 $x^{\\ast}$ 处求得的梯度。该梯度对应于雅可比矩阵 $H(x^{\\ast})$ 的第一行的转置：\n$$\n\\nabla b(x^{\\ast}) = \\begin{pmatrix} -1/10 \\\\ -1/5 \\\\ -1 \\end{pmatrix}\n$$\n线性化偏差为 $\\Delta b = b(x) - b(x^{\\ast}) \\approx \\nabla b(x^{\\ast})^{\\top} (x - x^{\\ast})$。我们希望找到当 $x \\in \\mathcal{S}$ 时 $|\\Delta b|$ 的最大值。令扰动向量为 $p = x - x^{\\ast}$。问题是求解：\n$$\n\\max_{p} \\left| \\nabla b(x^{\\ast})^{\\top} p \\right| \\quad \\text{约束条件为} \\quad \\|W p\\|_{\\infty} \\le \\delta\n$$\n这等价于在相同约束下求解 $\\max_{p} \\nabla b(x^{\\ast})^{\\top} p$，因为容许的 $p$ 集合是关于原点对称的。\n令 $c = \\nabla b(x^{\\ast})$。我们希望最大化 $c^{\\top}p$。令 $z = W p$，因为 $W$ 是可逆的，这意味着 $p = W^{-1} z$。问题转换为：\n$$\n\\max_{z} c^{\\top} (W^{-1} z) \\quad \\text{约束条件为} \\quad \\|z\\|_{\\infty} \\le \\delta\n$$\n这可以重写为 $\\max_{z} ( (W^{-1})^{\\top} c )^{\\top} z$。由于 $W$ 是一个对角矩阵，$W^{-1}$ 也是对角的，因此 $(W^{-1})^{\\top} = W^{-1}$。问题是：\n$$\n\\max_{\\|z\\|_{\\infty} \\le \\delta} (W^{-1} c)^{\\top} z\n$$\n在集合 $\\|z\\|_{\\infty} \\le \\delta$ 上，内积 $\\langle a, z \\rangle$ 的最大值由 $\\delta \\|a\\|_1$ 给出，这是范数对偶性的一个基本结果（$L_{\\infty}$范数的对偶范数是$L_1$范数）。这里，我们的向量 $a$ 是 $W^{-1} c$。\n因此，最大界是 $\\delta \\| W^{-1} c \\|_1$。\n\n我们来计算各分量。我们有：\n$$\nc = \\nabla b(x^{\\ast}) = \\begin{pmatrix} -0.1 \\\\ -0.2 \\\\ -1 \\end{pmatrix}\n$$\n权重矩阵是 $W = \\operatorname{diag}(0.5, 0.5, 1)$，所以其逆矩阵是 $W^{-1} = \\operatorname{diag}(2, 2, 1)$。\n$$\nW^{-1} c = \\begin{pmatrix} 2  0  0 \\\\ 0  2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -0.1 \\\\ -0.2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\times (-0.1) \\\\ 2 \\times (-0.2) \\\\ 1 \\times (-1) \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ -0.4 \\\\ -1 \\end{pmatrix}\n$$\n现在，我们计算这个向量的 $L_1$范数：\n$$\n\\| W^{-1} c \\|_1 = |-0.2| + |-0.4| + |-1| = 0.2 + 0.4 + 1.0 = 1.6\n$$\n给定的扰动界为 $\\delta = 3.1 \\times 10^{-2} = 0.031$。\n方位偏差的最坏情况下的线性化界是：\n$$\n\\max |b(x) - b(x^{\\ast})| \\approx \\delta \\| W^{-1} c \\|_1 = 0.031 \\times 1.6 = 0.0496\n$$\n问题要求将此值四舍五入到四位有效数字。计算出的值 $0.0496$ 有三位有效数字（第一个非零数字是 $4$，后面跟着 $9$ 和 $6$）。为了用四位有效数字表示这个值，我们附加一个零，得到 $0.04960$。单位是弧度。",
            "answer": "$$\n\\boxed{0.04960}\n$$"
        },
        {
            "introduction": "模型预测控制（MPC）是现代控制理论的支柱，它利用系统模型来预测未来行为并优化控制决策。本练习将MPC的核心思想浓缩为一个具体的单步优化问题，让你亲身体验如何在一个简单的线性系统中，结合模型、成本函数和约束条件来计算最优控制输入。通过这个练习，你将为理解更复杂的CPS应用中使用的先进MPC策略奠定坚实的基础。",
            "id": "4231801",
            "problem": "考虑一个用于信息物理系统（CPS）及其相应数字孪生的模型预测控制（MPC）中的离散时间线性时不变状态空间模型，由下式给出\n$$\nx_{k+1} = A x_k + B u_k,\n$$\n其中 $x_k \\in \\mathbb{R}^2$ 是步骤 $k$ 时的状态，$u_k \\in \\mathbb{R}$ 是步骤 $k$ 时的控制输入，$A \\in \\mathbb{R}^{2 \\times 2}$，且 $B \\in \\mathbb{R}^{2 \\times 1}$。假设全文使用无量纲的归一化变量。\n\n在某个特定时间步，数字孪生提供了模型矩阵和成本权重\n$$\nA = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = 1,\n$$\n以及当前测量到的状态\n$$\nx_k = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix}.\n$$\n对于单步时域（1步MPC），阶段成本为\n$$\nJ(u_k) = \\big(A x_k + B u_k\\big)^{\\top} Q \\big(A x_k + B u_k\\big) + u_k^{\\top} R u_k.\n$$\n执行器和状态约束由输入边界和对预测的第一个状态分量的安全要求给出：\n$$\n-1 \\leq u_k \\leq 1, \\quad -\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2},\n$$\n其中 $\\big(x_{k+1}\\big)_1$ 表示 $x_{k+1}$ 的第一个分量。\n\n任务：\n- 根据给定的模型和成本，从第一性原理推导出 $J(u_k)$ 的无约束极小值点。\n- 判断无约束极小值点在所述约束下是否可行。如果不可行，通过投影到由约束定义的可行集上计算有约束最优 $u_k$。\n- 简要讨论此单步MPC问题的可行性表征，并为CPS的MPC实现中使用的迭代二次规划（QP）求解器提出一种合适的热启动策略。\n\n请提供单个最优控制动作 $u_k^{\\star}$ 作为最终答案。请将您的最终数值答案表示为精确的有理数（不要四舍五入）。",
            "solution": "首先对问题进行验证，以确保其科学上合理、适定且完整。\n\n### 第1步：提取已知条件\n- 状态空间模型：$x_{k+1} = A x_k + B u_k$\n- 状态向量：$x_k \\in \\mathbb{R}^2$\n- 控制输入：$u_k \\in \\mathbb{R}$\n- 系统矩阵：$A = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix}$\n- 输入矩阵：$B = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$\n- 状态成本权重矩阵：$Q = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}$\n- 输入成本权重：$R = 1$\n- 当前状态：$x_k = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix}$\n- 单步MPC的成本函数：$J(u_k) = \\big(A x_k + B u_k\\big)^{\\top} Q \\big(A x_k + B u_k\\big) + u_k^{\\top} R u_k$\n- 输入约束：$-1 \\leq u_k \\leq 1$\n- 状态约束：$-\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2}$\n\n### 第2步：使用提取的已知条件进行验证\n该问题描述了一个标准的单步模型预测控制（MPC）公式，这是控制工程中一种成熟的方法。\n- **科学基础**：使用线性时不变状态空间模型、二次成本函数和线性约束是现代控制理论的基础。该问题在科学上和数学上都是合理的。\n- **适定性**：需要检验成本函数 $J(u_k)$。它可以展开为标量控制输入 $u_k$ 的二次函数。\n$J(u_k) = (x_k^\\top A^\\top + u_k B^\\top) Q (A x_k + B u_k) + u_k R u_k$\n$J(u_k) = x_k^\\top A^\\top Q A x_k + 2 u_k B^\\top Q A x_k + u_k^2 B^\\top Q B + u_k^2 R$\n$J(u_k) = (B^\\top Q B + R) u_k^2 + 2(B^\\top Q A x_k) u_k + (x_k^\\top A^\\top Q A x_k)$\n这是 $u_k$ 的一个二次函数。为了使该函数有唯一的极小值点， $u_k^2$ 项的系数必须为正。\n$B^\\top Q B + R = \\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} + 1 = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} + 1 = (\\frac{9}{4} + 1) + 1 = \\frac{13}{4} + 1 = \\frac{17}{4}$。\n由于 $\\frac{17}{4}  0$，成本函数 $J(u_k)$ 是一个严格凸的抛物线，这保证了唯一的无约束极小值点的存在。约束定义了一个闭合的凸集（一个区间）。在凸集上最小化一个严格凸函数是一个适定问题。\n- **完备性与一致性**：所有必需的矩阵、初始状态、成本函数和约束都已明确给出，并且维度一致。\n\n### 第3步：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答推导\n\n**任务1：无约束极小值点**\n\n为了找到凸二次成本函数 $J(u_k)$ 的无约束极小值点，我们对其关于 $u_k$ 求导并令其为零。\n$$\n\\frac{dJ}{du_k} = \\frac{d}{du_k} \\left[ (B^\\top Q B + R) u_k^2 + 2(B^\\top Q A x_k) u_k + \\text{const} \\right] = 0\n$$\n$$\n2 (B^\\top Q B + R) u_k + 2(B^\\top Q A x_k) = 0\n$$\n求解无约束最优控制输入 $u_k^{\\text{unc}}$：\n$$\nu_k^{\\text{unc}} = - (B^\\top Q B + R)^{-1} (B^\\top Q A x_k)\n$$\n我们已经计算出 $B^\\top Q B + R = \\frac{17}{4}$。现在我们计算 $B^\\top Q A x_k$ 这一项。\n首先，计算乘积 $A x_k$：\n$$\nA x_k = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 0 + \\frac{1}{4} \\cdot \\frac{1}{5} \\\\ 0 \\cdot 0 + 1 \\cdot \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{20} \\\\ \\frac{1}{5} \\end{pmatrix}\n$$\n接下来，计算 $B^\\top Q A x_k$：\n$$\nB^\\top Q = \\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix}\n$$\n$$\nB^\\top Q A x_k = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{20} \\\\ \\frac{1}{5} \\end{pmatrix} = \\frac{9}{2} \\cdot \\frac{1}{20} + 1 \\cdot \\frac{1}{5} = \\frac{9}{40} + \\frac{8}{40} = \\frac{17}{40}\n$$\n现在，将这些值代回 $u_k^{\\text{unc}}$ 的表达式中：\n$$\nu_k^{\\text{unc}} = - \\left( \\frac{17}{4} \\right)^{-1} \\left( \\frac{17}{40} \\right) = - \\frac{4}{17} \\cdot \\frac{17}{40} = - \\frac{4}{40} = -\\frac{1}{10}\n$$\n无约束极小值点为 $u_k^{\\text{unc}} = -\\frac{1}{10}$。\n\n**任务2：可行性与有约束最优解**\n\n我们现在必须通过对照给定的约束来检查 $u_k^{\\text{unc}} = -\\frac{1}{10}$ 是否可行。\n\n第一个约束（输入边界）：\n$$\n-1 \\leq u_k \\leq 1\n$$\n代入 $u_k^{\\text{unc}} = -\\frac{1}{10}$：\n$$\n-1 \\leq -\\frac{1}{10} \\leq 1\n$$\n这个不等式成立。\n\n第二个约束（状态安全要求）：\n$$\n-\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2}\n$$\n预测状态为 $x_{k+1} = A x_k + B u_k$。其第一个分量 $\\big(x_{k+1}\\big)_1$ 由下式给出：\n$$\n\\big(x_{k+1}\\big)_1 = \\big(A x_k\\big)_1 + \\big(B u_k\\big)_1 = \\frac{1}{20} + \\frac{1}{2} u_k\n$$\n代入 $u_k^{\\text{unc}} = -\\frac{1}{10}$：\n$$\n\\big(x_{k+1}\\big)_1 = \\frac{1}{20} + \\frac{1}{2} \\left( -\\frac{1}{10} \\right) = \\frac{1}{20} - \\frac{1}{20} = 0\n$$\n检查该预测状态分量的约束：\n$$\n-\\frac{1}{2} \\leq 0 \\leq \\frac{1}{2}\n$$\n这个不等式也成立。\n\n由于无约束极小值点满足所有约束，它位于可行集内。对于凸优化问题，如果无约束最优解是可行的，那么它也是有约束最优解。\n因此，最优控制动作为 $u_k^{\\star} = u_k^{\\text{unc}} = -\\frac{1}{10}$。\n\n如果无约束极小值点是不可行的，则最优解将是 $u_k^{\\text{unc}}$ 在 $u_k$ 可行集上的投影。$u_k$ 的可行集是两个约束区间的交集。\n根据第一个约束，$u_k \\in [-1, 1]$。\n根据第二个约束，$-\\frac{1}{2} \\leq \\frac{1}{20} + \\frac{1}{2} u_k \\leq \\frac{1}{2}$，可简化为：\n$-\\frac{11}{20} \\leq \\frac{1}{2} u_k \\leq \\frac{9}{20}$，或 $-\\frac{11}{10} \\leq u_k \\leq \\frac{9}{10}$。\n可行集是交集：$[-1, 1] \\cap [-\\frac{11}{10}, \\frac{9}{10}] = [-1, \\frac{9}{10}]$。\n由于我们的解 $u_k^{\\star} = -\\frac{1}{10}$ 在此区间内，我们的结论是正确的。\n\n**任务3：可行性与热启动策略**\n\n**可行性表征**：对于此问题，当且仅当由所有对 $u_k$ 的约束的交集定义的可行集非空时，才存在可行的控制动作 $u_k$。如上所述，可行集是区间 $[-1, \\frac{9}{10}]$。由于该区间非空，故存在可行解。通常，对于给定的状态 $x_k$，可行性要求输入域约束和状态域约束（映射回输入空间）的交集非空。这可以在求解优化问题之前进行解析检查，这是这种简单MPC设置的一个关键优势。\n\n**热启动策略**：MPC涉及在每个时间步求解一个相似的优化问题。迭代求解器，例如用于二次规划（QP）的求解器，可以通过提供一个好的初始猜测（称为热启动）来显著加速。一种非常有效且常见的策略是时间热启动。对于时间步 $k$ 的优化问题，决策变量 $u_k$ 的初始猜测值被设置为前一个时间步找到的最优解 $u_{k-1}^{\\star}$。该策略利用了这样一个事实：对于许多在MPC控制下的物理系统，最优控制序列在连续的时间步之间不会发生剧烈变化。因此，$u_{k-1}^{\\star}$ 通常是 $u_k^{\\star}$ 的一个很好的近似，从而减少了QP求解器找到新最优解所需的迭代次数。",
            "answer": "$$\n\\boxed{-\\frac{1}{10}}\n$$"
        }
    ]
}