{
    "hands_on_practices": [
        {
            "introduction": "在信息物理系统中，准确估计系统状态是实现可靠控制和决策的基础。由于传感器模型通常是非线性的，扩展卡尔曼滤波器（EKF）等高级估计算法通过对模型进行线性化来处理这种复杂性。这个练习将指导你为一个典型的机器人传感器模型推导雅可比矩阵，并利用它来分析测量的灵敏度，这是设计和调试状态估计器的关键实践技能。",
            "id": "4231762",
            "problem": "一个平面地面机器人的数字孪生被用于在信息物理系统中设计基于模型的状态估计器。机器人状态为 $x = [x, y, \\theta]^{\\top}$，其中 $x$ 和 $y$ 是平面坐标，$\\theta$ 是航向角。机器人通过一个方位-距离传感器观测一个位于 $(L_{x}, L_{y})$ 的固定地标，其测量函数为 $h(x) = [b(x), r(x)]^{\\top}$，定义如下：\n$$\nb(x) = \\operatorname{arctan2}(L_{y} - y, L_{x} - x) - \\theta,\\quad r(x) = \\sqrt{\\big(L_{x} - x\\big)^{2} + \\big(L_{y} - y\\big)^{2}}.\n$$\n假设 $L_{x} = 5$, $L_{y} = -3$。工作点为 $x^{\\ast} = [1, -1, \\pi/4]^{\\top}$。该估计器是通过对测量函数在 $x^{\\ast}$ 点进行一阶泰勒线性化来设计的，从而产生一个用于扩展卡尔曼滤波器（EKF）的测量雅可比矩阵。\n\n仅从 $h(x)$ 的定义和向量值函数的一阶泰勒展开式出发，以符号形式推导测量雅可比矩阵 $H(x) = \\frac{\\partial h(x)}{\\partial x}$，然后计算 $H(x^{\\ast})$。将 $\\operatorname{arctan2}(\\cdot,\\cdot)$ 和平方根函数视为在奇点之外是平滑的，并确保所有步骤都由链式法则证明。\n\n利用你的线性化结果，考虑在归一化状态扰动下，方位分量 $b(x)$ 的测量灵敏度。设容许扰动集为\n$$\n\\mathcal{S} = \\left\\{\\, x \\in \\mathbb{R}^{3} : \\big\\|W\\big(x - x^{\\ast}\\big)\\big\\|_{\\infty} \\le \\delta \\,\\right\\},\n$$\n其中 $W = \\operatorname{diag}(0.5,\\, 0.5,\\, 1)$ 且 $\\delta = 3.1 \\times 10^{-2}$。仅使用范数对偶性和线性化中经过充分检验的结论，求出由 $\\mathcal{S}$ 中的扰动引起的方位偏差 $\\big|b(x) - b(x^{\\ast})\\big|$ 大小的最坏情况线性化边界，表示为一个以弧度为单位的实数。将你的答案四舍五入到四位有效数字，并以弧度表示该边界。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、适定的、客观的，并且没有明显缺陷。它构成了非线性系统状态估计分析中的一个标准练习。因此，我们可以进行完整解答。\n\n问题分为两部分。首先，我们为一个给定的传感器模型推导测量雅可比矩阵。其次，我们基于一阶线性化对方位测量进行最坏情况灵敏度分析。\n\n第1部分：测量雅可比矩阵的推导与求值\n\n状态向量为 $x = [x, y, \\theta]^{\\top}$。测量函数为 $h(x) = [b(x), r(x)]^{\\top}$，其中\n$$\nb(x) = \\operatorname{arctan2}(L_{y} - y, L_{x} - x) - \\theta\n$$\n$$\nr(x) = \\sqrt{(L_{x} - x)^{2} + (L_{y} - y)^{2}}\n$$\n测量雅可比矩阵是一个 $2 \\times 3$ 矩阵 $H(x) = \\frac{\\partial h(x)}{\\partial x}$，定义为：\n$$\nH(x) = \\begin{pmatrix} \\frac{\\partial b}{\\partial x}  \\frac{\\partial b}{\\partial y}  \\frac{\\partial b}{\\partial \\theta} \\\\ \\frac{\\partial r}{\\partial x}  \\frac{\\partial r}{\\partial y}  \\frac{\\partial r}{\\partial \\theta} \\end{pmatrix}\n$$\n我们将以符号形式计算每个偏导数。为清晰起见，令 $\\Delta x = L_x - x$ 和 $\\Delta y = L_y - y$。距离的平方是 $r^2(x) = (\\Delta x)^2 + (\\Delta y)^2$。\n\n方位分量 $b(x)$ 的导数：\n函数 $f(v, u) = \\operatorname{arctan2}(v, u)$ 关于其参数的导数为 $\\frac{\\partial f}{\\partial u} = \\frac{-v}{u^2+v^2}$ 和 $\\frac{\\partial f}{\\partial v} = \\frac{u}{u^2+v^2}$。\n使用链式法则，令 $v = \\Delta y$ 且 $u = \\Delta x$：\n$$\n\\frac{\\partial b}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\operatorname{arctan2}(\\Delta y, \\Delta x) - \\theta \\right) = \\frac{\\partial \\operatorname{arctan2}(\\Delta y, \\Delta x)}{\\partial (\\Delta x)} \\frac{\\partial (\\Delta x)}{\\partial x} = \\frac{-\\Delta y}{(\\Delta x)^2 + (\\Delta y)^2} \\cdot (-1) = \\frac{\\Delta y}{(\\Delta x)^2 + (\\Delta y)^2} = \\frac{L_y - y}{(L_x - x)^2 + (L_y - y)^2}\n$$\n$$\n\\frac{\\partial b}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\operatorname{arctan2}(\\Delta y, \\Delta x) - \\theta \\right) = \\frac{\\partial \\operatorname{arctan2}(\\Delta y, \\Delta x)}{\\partial (\\Delta y)} \\frac{\\partial (\\Delta y)}{\\partial y} = \\frac{\\Delta x}{(\\Delta x)^2 + (\\Delta y)^2} \\cdot (-1) = \\frac{-\\Delta x}{(\\Delta x)^2 + (\\Delta y)^2} = \\frac{-(L_x - x)}{(L_x - x)^2 + (L_y - y)^2}\n$$\n关于 $\\theta$ 的导数很简单：\n$$\n\\frac{\\partial b}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\operatorname{arctan2}(\\Delta y, \\Delta x) - \\theta \\right) = -1\n$$\n\n距离分量 $r(x)$ 的导数：\n距离为 $r(x) = ((\\Delta x)^2 + (\\Delta y)^2)^{1/2}$。使用链式法则：\n$$\n\\frac{\\partial r}{\\partial x} = \\frac{1}{2} \\left((\\Delta x)^2 + (\\Delta y)^2\\right)^{-1/2} \\cdot \\frac{\\partial}{\\partial x}((\\Delta x)^2) = \\frac{1}{2r(x)} \\cdot 2(\\Delta x) \\frac{\\partial(\\Delta x)}{\\partial x} = \\frac{\\Delta x}{r(x)} \\cdot (-1) = \\frac{-\\Delta x}{r(x)} = \\frac{-(L_x - x)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}\n$$\n$$\n\\frac{\\partial r}{\\partial y} = \\frac{1}{2} \\left((\\Delta x)^2 + (\\Delta y)^2\\right)^{-1/2} \\cdot \\frac{\\partial}{\\partial y}((\\Delta y)^2) = \\frac{1}{2r(x)} \\cdot 2(\\Delta y) \\frac{\\partial(\\Delta y)}{\\partial y} = \\frac{\\Delta y}{r(x)} \\cdot (-1) = \\frac{-\\Delta y}{r(x)} = \\frac{-(L_y - y)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}\n$$\n距离 $r(x)$ 不依赖于 $\\theta$：\n$$\n\\frac{\\partial r}{\\partial \\theta} = 0\n$$\n\n组装符号雅可比矩阵 $H(x)$：\n$$\nH(x) = \\begin{pmatrix}\n\\frac{L_y - y}{(L_x - x)^2 + (L_y - y)^2}  \\frac{-(L_x - x)}{(L_x - x)^2 + (L_y - y)^2}  -1 \\\\\n\\frac{-(L_x - x)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}  \\frac{-(L_y - y)}{\\sqrt{(L_x - x)^2 + (L_y - y)^2}}  0\n\\end{pmatrix}\n$$\n\n现在，我们在工作点 $x^{\\ast} = [1, -1, \\pi/4]^{\\top}$ 和地标 $(L_x, L_y) = (5, -3)$ 处计算 $H(x)$。\n首先，计算差值和距离的平方：\n$$\n\\Delta x^{\\ast} = L_x - x^{\\ast} = 5 - 1 = 4\n$$\n$$\n\\Delta y^{\\ast} = L_y - y^{\\ast} = -3 - (-1) = -2\n$$\n$$\n(r(x^{\\ast}))^2 = (\\Delta x^{\\ast})^2 + (\\Delta y^{\\ast})^2 = 4^2 + (-2)^2 = 16 + 4 = 20\n$$\n$$\nr(x^{\\ast}) = \\sqrt{20} = 2\\sqrt{5}\n$$\n将这些值代入符号雅可比矩阵的各项中：\n$$\n\\frac{\\partial b}{\\partial x}\\bigg|_{x^{\\ast}} = \\frac{\\Delta y^{\\ast}}{(r(x^{\\ast}))^2} = \\frac{-2}{20} = -\\frac{1}{10}\n$$\n$$\n\\frac{\\partial b}{\\partial y}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta x^{\\ast}}{(r(x^{\\ast}))^2} = \\frac{-4}{20} = -\\frac{1}{5}\n$$\n$$\n\\frac{\\partial b}{\\partial \\theta}\\bigg|_{x^{\\ast}} = -1\n$$\n$$\n\\frac{\\partial r}{\\partial x}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta x^{\\ast}}{r(x^{\\ast})} = \\frac{-4}{2\\sqrt{5}} = -\\frac{2}{\\sqrt{5}} = -\\frac{2\\sqrt{5}}{5}\n$$\n$$\n\\frac{\\partial r}{\\partial y}\\bigg|_{x^{\\ast}} = \\frac{-\\Delta y^{\\ast}}{r(x^{\\ast})} = \\frac{-(-2)}{2\\sqrt{5}} = \\frac{1}{\\sqrt{5}} = \\frac{\\sqrt{5}}{5}\n$$\n$$\n\\frac{\\partial r}{\\partial \\theta}\\bigg|_{x^{\\ast}} = 0\n$$\n计算得到的雅可比矩阵为：\n$$\nH(x^{\\ast}) = \\begin{pmatrix} -1/10  -1/5  -1 \\\\ -2\\sqrt{5}/5  \\sqrt{5}/5  0 \\end{pmatrix}\n$$\n\n第2部分：测量灵敏度分析\n\n我们需要找到在状态扰动 $x$ 属于集合 $\\mathcal{S}$ 时，方位偏差大小 $|b(x) - b(x^{\\ast})|$ 的最坏情况线性化边界。\n$b(x)$ 在 $x^{\\ast}$ 附近的一阶泰勒展开式为：\n$$\nb(x) \\approx b(x^{\\ast}) + \\nabla b(x^{\\ast})^{\\top} (x - x^{\\ast})\n$$\n其中 $\\nabla b(x^{\\ast})$ 是 $b$ 在 $x^{\\ast}$ 点的梯度。该梯度对应于雅可比矩阵 $H(x^{\\ast})$ 的第一行的转置：\n$$\n\\nabla b(x^{\\ast}) = \\begin{pmatrix} -1/10 \\\\ -1/5 \\\\ -1 \\end{pmatrix}\n$$\n线性化偏差为 $\\Delta b = b(x) - b(x^{\\ast}) \\approx \\nabla b(x^{\\ast})^{\\top} (x - x^{\\ast})$。我们想要求出对于 $x \\in \\mathcal{S}$， $|\\Delta b|$ 的最大值。令扰动向量为 $p = x - x^{\\ast}$。问题是要求：\n$$\n\\max_{p} \\left| \\nabla b(x^{\\ast})^{\\top} p \\right| \\quad \\text{约束条件为} \\quad \\|W p\\|_{\\infty} \\le \\delta\n$$\n这等价于在相同约束下求 $\\max_{p} \\nabla b(x^{\\ast})^{\\top} p$，因为容许的 $p$ 集合是关于原点对称的。\n令 $c = \\nabla b(x^{\\ast})$。我们想要求 $c^{\\top}p$ 的最大值。令 $z = W p$，这意味着 $p = W^{-1} z$，因为 $W$ 是可逆的。问题转化为：\n$$\n\\max_{z} c^{\\top} (W^{-1} z) \\quad \\text{约束条件为} \\quad \\|z\\|_{\\infty} \\le \\delta\n$$\n这可以重写为 $\\max_{z} ( (W^{-1})^{\\top} c )^{\\top} z$。因为 $W$ 是一个对角矩阵，所以 $W^{-1}$ 也是对角矩阵，因此 $(W^{-1})^{\\top} = W^{-1}$。问题是：\n$$\n\\max_{\\|z\\|_{\\infty} \\le \\delta} (W^{-1} c)^{\\top} z\n$$\n在一个集合 $\\|z\\|_{\\infty} \\le \\delta$ 上，内积 $\\langle a, z \\rangle$ 的最大值由 $\\delta \\|a\\|_1$ 给出，这是范数对偶性（$L_{\\infty}$-范数的对偶范数是 $L_1$-范数）的一个基本结果。这里，我们的向量 $a$ 是 $W^{-1} c$。\n因此，最大边界是 $\\delta \\| W^{-1} c \\|_1$。\n\n让我们计算各个分量。我们有：\n$$\nc = \\nabla b(x^{\\ast}) = \\begin{pmatrix} -0.1 \\\\ -0.2 \\\\ -1 \\end{pmatrix}\n$$\n权重矩阵是 $W = \\operatorname{diag}(0.5, 0.5, 1)$，所以其逆矩阵是 $W^{-1} = \\operatorname{diag}(2, 2, 1)$。\n$$\nW^{-1} c = \\begin{pmatrix} 2  0  0 \\\\ 0  2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -0.1 \\\\ -0.2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\times (-0.1) \\\\ 2 \\times (-0.2) \\\\ 1 \\times (-1) \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ -0.4 \\\\ -1 \\end{pmatrix}\n$$\n现在，我们计算这个向量的 $L_1$-范数：\n$$\n\\| W^{-1} c \\|_1 = |-0.2| + |-0.4| + |-1| = 0.2 + 0.4 + 1.0 = 1.6\n$$\n给定的扰动边界为 $\\delta = 3.1 \\times 10^{-2} = 0.031$。\n方位偏差的最坏情况线性化边界是：\n$$\n\\max |b(x) - b(x^{\\ast})| \\approx \\delta \\| W^{-1} c \\|_1 = 0.031 \\times 1.6 = 0.0496\n$$\n问题要求将此值四舍五入到四位有效数字。计算出的值 $0.0496$ 有三位有效数字（第一个非零数字是 $4$，后面是 $9$ 和 $6$）。为了用四位有效数字表示这个值，我们追加一个零，得到 $0.04960$。单位是弧度。",
            "answer": "$$\n\\boxed{0.04960}\n$$"
        },
        {
            "introduction": "模型预测控制（MPC）是一种先进的控制策略，它利用系统模型来预测未来行为并在满足约束条件的同时计算最优控制输入。本练习将引导你解决一个单步MPC问题，让你亲身体验如何制定并求解这个二次规划问题。通过这个实践，你将学会如何推导最优控制律，并验证其在物理和安全约束下的可行性，从而深入理解预测控制的核心思想。",
            "id": "4231801",
            "problem": "考虑一个用于网络物理系统 (Cyber-Physical System, CPS) 及其相应数字孪生的模型预测控制 (Model Predictive Control, MPC) 的离散时间线性时不变状态空间模型，由下式给出\n$$\nx_{k+1} = A x_k + B u_k,\n$$\n其中 $x_k \\in \\mathbb{R}^2$ 是在步骤 $k$ 的状态， $u_k \\in \\mathbb{R}$ 是在步骤 $k$ 的控制输入， $A \\in \\mathbb{R}^{2 \\times 2}$，以及 $B \\in \\mathbb{R}^{2 \\times 1}$。假设全文使用无量纲的归一化变量。\n\n在某个特定时间步，数字孪生提供了模型矩阵和成本权重\n$$\nA = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = \\frac{1}{1},\n$$\n以及当前测量的状态\n$$\nx_k = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix}.\n$$\n对于单步预测时域（$1$-step MPC），阶段成本为\n$$\nJ(u_k) = \\big(A x_k + B u_k\\big)^{\\top} Q \\big(A x_k + B u_k\\big) + u_k^{\\top} R u_k.\n$$\n执行器和状态约束由输入边界和对预测的第一个状态分量的安全要求给出：\n$$\n-1 \\leq u_k \\leq 1, \\quad -\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2},\n$$\n其中 $\\big(x_{k+1}\\big)_1$ 表示 $x_{k+1}$ 的第一个分量。\n\n任务：\n- 使用给定的模型和成本，从第一性原理推导 $J(u_k)$ 的无约束最优解。\n- 判断无约束最优解在所述约束下是否可行。如果不可行，通过投影到由约束定义的可行集上来计算有约束的最优 $u_k$。\n- 简要讨论此单步 MPC 问题的可行性表征，并为用于 CPS 的 MPC 实现中的迭代二次规划 (Quadratic Programming, QP) 求解器提出一种合适的暖启动策略。\n\n提供单一的最优控制动作 $u_k^{\\star}$ 作为您的最终答案。请将最终数值答案表示为精确的有理数（不要四舍五入）。",
            "solution": "首先对问题进行验证，以确保其科学上合理、适定且完整。\n\n### 步骤 1：提取已知条件\n- 状态空间模型：$x_{k+1} = A x_k + B u_k$\n- 状态向量：$x_k \\in \\mathbb{R}^2$\n- 控制输入：$u_k \\in \\mathbb{R}$\n- 系统矩阵：$A = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix}$\n- 输入矩阵：$B = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$\n- 状态成本权重矩阵：$Q = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}$\n- 输入成本权重：$R = 1$\n- 当前状态：$x_k = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix}$\n- 单步 MPC 的成本函数：$J(u_k) = \\big(A x_k + B u_k\\big)^{\\top} Q \\big(A x_k + B u_k\\big) + u_k^{\\top} R u_k$\n- 输入约束：$-1 \\leq u_k \\leq 1$\n- 状态约束：$-\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了一个标准的单步模型预测控制 (MPC) 公式，这是控制工程中一种成熟的方法。\n- **科学依据**：使用线性时不变状态空间模型、二次成本函数和线性约束是现代控制理论的基础。该问题在科学上和数学上都是合理的。\n- **适定性**：需要检查成本函数 $J(u_k)$。它可以展开为标量控制输入 $u_k$ 的二次函数。\n$J(u_k) = (x_k^\\top A^\\top + u_k B^\\top) Q (A x_k + B u_k) + u_k R u_k$\n$J(u_k) = x_k^\\top A^\\top Q A x_k + 2 u_k B^\\top Q A x_k + u_k^2 B^\\top Q B + u_k^2 R$\n$J(u_k) = (B^\\top Q B + R) u_k^2 + 2(B^\\top Q A x_k) u_k + (x_k^\\top A^\\top Q A x_k)$\n这是一个关于 $u_k$ 的二次函数。为使该函数具有唯一的最优解，$u_k^2$ 项的系数必须为正。\n$B^\\top Q B + R = \\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} + 1 = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix} + 1 = (\\frac{9}{4} + 1) + 1 = \\frac{13}{4} + 1 = \\frac{17}{4}$。\n由于 $\\frac{17}{4}  0$，成本函数 $J(u_k)$ 是一个严格凸的抛物线，这保证了唯一的无约束最优解的存在。约束定义了一个闭合的凸集（一个区间）。在一个凸集上最小化一个严格凸函数是一个适定问题。\n- **完整性与一致性**：所有必需的矩阵、初始状态、成本函数和约束都已明确给出，并且在维度上是一致的。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个完整的解答。\n\n### 解题推导\n\n**任务 1：无约束最优解**\n\n为了找到凸二次成本函数 $J(u_k)$ 的无约束最优解，我们对其关于 $u_k$ 求导，并令其等于零。\n$$\n\\frac{dJ}{du_k} = \\frac{d}{du_k} \\left[ (B^\\top Q B + R) u_k^2 + 2(B^\\top Q A x_k) u_k + \\text{const} \\right] = 0\n$$\n$$\n2 (B^\\top Q B + R) u_k + 2(B^\\top Q A x_k) = 0\n$$\n求解无约束最优控制输入 $u_k^{\\text{unc}}$：\n$$\nu_k^{\\text{unc}} = - (B^\\top Q B + R)^{-1} (B^\\top Q A x_k)\n$$\n我们已经计算出 $B^\\top Q B + R = \\frac{17}{4}$。现在我们计算 $B^\\top Q A x_k$ 这一项。\n首先，计算乘积 $A x_k$：\n$$\nA x_k = \\begin{pmatrix} 1  \\frac{1}{4} \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 0 + \\frac{1}{4} \\cdot \\frac{1}{5} \\\\ 0 \\cdot 0 + 1 \\cdot \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{20} \\\\ \\frac{1}{5} \\end{pmatrix}\n$$\n接下来，计算 $B^\\top Q A x_k$：\n$$\nB^\\top Q = \\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix}\n$$\n$$\nB^\\top Q A x_k = \\begin{pmatrix} \\frac{9}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{20} \\\\ \\frac{1}{5} \\end{pmatrix} = \\frac{9}{2} \\cdot \\frac{1}{20} + 1 \\cdot \\frac{1}{5} = \\frac{9}{40} + \\frac{8}{40} = \\frac{17}{40}\n$$\n现在，将这些值代回到 $u_k^{\\text{unc}}$ 的表达式中：\n$$\nu_k^{\\text{unc}} = - \\left( \\frac{17}{4} \\right)^{-1} \\left( \\frac{17}{40} \\right) = - \\frac{4}{17} \\cdot \\frac{17}{40} = - \\frac{4}{40} = -\\frac{1}{10}\n$$\n无约束最优解是 $u_k^{\\text{unc}} = -\\frac{1}{10}$。\n\n**任务 2：可行性与约束最优解**\n\n我们现在必须通过对照给定的约束条件来检查 $u_k^{\\text{unc}} = -\\frac{1}{10}$ 是否可行。\n\n第一个约束（输入边界）：\n$$\n-1 \\leq u_k \\leq 1\n$$\n代入 $u_k^{\\text{unc}} = -\\frac{1}{10}$：\n$$\n-1 \\leq -\\frac{1}{10} \\leq 1\n$$\n这个不等式成立。\n\n第二个约束（状态安全要求）：\n$$\n-\\frac{1}{2} \\leq \\big(x_{k+1}\\big)_1 \\leq \\frac{1}{2}\n$$\n预测的状态是 $x_{k+1} = A x_k + B u_k$。它的第一个分量 $\\big(x_{k+1}\\big)_1$ 由下式给出：\n$$\n\\big(x_{k+1}\\big)_1 = \\big(A x_k\\big)_1 + \\big(B u_k\\big)_1 = \\frac{1}{20} + \\frac{1}{2} u_k\n$$\n代入 $u_k^{\\text{unc}} = -\\frac{1}{10}$：\n$$\n\\big(x_{k+1}\\big)_1 = \\frac{1}{20} + \\frac{1}{2} \\left( -\\frac{1}{10} \\right) = \\frac{1}{20} - \\frac{1}{20} = 0\n$$\n检查这个预测状态分量的约束：\n$$\n-\\frac{1}{2} \\leq 0 \\leq \\frac{1}{2}\n$$\n这个不等式也成立。\n\n由于无约束最优解满足所有约束，它位于可行集内。对于一个凸优化问题，如果无约束最优解是可行的，那么它也是约束最优解。\n因此，最优控制动作为 $u_k^{\\star} = u_k^{\\text{unc}} = -\\frac{1}{10}$。\n\n如果无约束最优解是不可行的，那么最优解将是 $u_k^{\\text{unc}}$ 在 $u_k$ 可行集上的投影。$u_k$ 的可行集是两个约束区间的交集。\n从第一个约束，我们得到 $u_k \\in [-1, 1]$。从第二个约束，我们得到 $-\\frac{1}{2} \\leq \\frac{1}{20} + \\frac{1}{2} u_k \\leq \\frac{1}{2}$，化简为：$-\\frac{11}{20} \\leq \\frac{1}{2} u_k \\leq \\frac{9}{20}$，即 $-\\frac{11}{10} \\leq u_k \\leq \\frac{9}{10}$。\n可行集是交集：$[-1, 1] \\cap [-\\frac{11}{10}, \\frac{9}{10}] = [-1, \\frac{9}{10}]$。由于我们的解 $u_k^{\\star} = -\\frac{1}{10}$ 在这个区间内，所以我们的结论是正确的。\n\n**任务 3：可行性与暖启动策略**\n\n**可行性表征**：对于此问题，当且仅当由所有关于 $u_k$ 的约束的交集定义的可行集非空时，才存在可行的控制动作 $u_k$。如上所述，可行集是区间 $[-1, \\frac{9}{10}]$。由于该区间非空，所以存在可行解。通常，对于给定的状态 $x_k$，可行性要求输入域约束和状态域约束（映射回输入空间）的交集非空。这可以在解决优化问题之前进行解析检查，这是这种简单 MPC 设置的一个关键优势。\n\n**暖启动策略**：MPC 涉及在每个时间步解决一个相似的优化问题。迭代求解器，例如用于二次规划 (QP) 的求解器，可以通过提供一个好的初始猜测（称为暖启动）来显著加速。一种高效且常见的策略是时间暖启动。对于时间步 $k$ 的优化问题，决策变量 $u_k$ 的初始猜测值被设置为前一个时间步找到的最优解 $u_{k-1}^{\\star}$。该策略利用了这样一个事实：对于许多在 MPC 控制下的物理系统，最优控制序列在连续的时间步之间不会发生剧烈变化。因此，$u_{k-1}^{\\star}$ 通常是 $u_k^{\\star}$ 的一个非常好的近似，从而减少了 QP 求解器找到新最优解所需的迭代次数。",
            "answer": "$$\n\\boxed{-\\frac{1}{10}}\n$$"
        },
        {
            "introduction": "对于安全关键的信息物理系统，我们不仅需要系统在大多数情况下正常工作，更需要形式化地证明其始终满足关键的安全属性。基于自动机的模型检测是一种强大的形式化验证方法，它能自动验证系统的有限状态模型是否满足以线性时序逻辑（LTL）等语言描述的规范。此练习将向你展示如何将高层系统需求转化为具体的验证流程，通过构建自动机并检查反例，你将深入了解保证系统安全性和正确性的算法基础。",
            "id": "4231799",
            "problem": "给定一个网络物理系统的有限状态模型族和两个基于原子命题的线性时序逻辑 (LTL) 属性。任务是使用模型检测的经典自动机论方法来判断每个模型是否满足其指定的属性：为 LTL 属性的否定构建非确定性布赫自动机 (NBA)，形成模型与 NBA 之间的同步积，并通过检测可达的接受环路来确定语言的空性。\n\n基本基础。使用有限标记迁移系统、无限迹上的 LTL 语义、非确定性布赫自动机和同步积构造的标准定义。具体来说，有限标记迁移系统是一个元组 $\\mathcal{T} = (S, S_0, \\rightarrow, L)$，其中 $S$ 是一个有限状态集，$S_0 \\in S$ 是一个初始状态，$\\rightarrow \\subseteq S \\times S$ 是迁移关系，以及 $L : S \\to 2^{\\mathsf{AP}}$ 为每个状态标记一组在该状态下为真的原子命题，$\\mathsf{AP}$ 是一个固定的原子命题集。对于 LTL，使用标准的无限迹语义。对于一个非确定性布赫自动机 $\\mathcal{A} = (Q, Q_0, \\Sigma, \\delta, F)$，其字母表为 $\\Sigma = 2^{\\mathsf{AP}}$，如果一个运行无限次访问 $F \\subseteq Q$ 中的状态，则该运行是接受的。对于同步积，根据状态标记和自动机在 $\\Sigma$ 上的转换守卫来定义积转换关系，积的状态对为 $(s,q) \\in S \\times Q$，并通过检测是否存在一个包含至少一个接受状态和环路的可达强连通分量来判断空性。\n\n关于无限运行的语义。如果状态 $s \\in S$ 没有出向迁移，则将其视为具有一个隐式的自环 $(s,s)$，从而使所有运行都是无限的。这是将迁移系统语义与无限迹上的 LTL 对齐的标准做法。\n\n待检查的属性。设 $\\mathsf{AP} = \\{p, r, g\\}$。您必须根据以下属性之一检查每个模型：\n- 属性 $\\varphi_1$: $\\mathbf{G}\\,\\mathbf{F}\\, p$，表示在每条运行中 $p$ 无限次出现。\n- 属性 $\\varphi_2$: $\\mathbf{G}\\,(r \\rightarrow \\mathbf{F}\\, g)$，表示每当 $r$ 成立时，$g$ 最终也会成立。此问题不涉及角度、物理单位和百分比。\n\n基于自动机论的决策过程。要判断迁移系统 $\\mathcal{T}$ 是否满足属性 $\\varphi$，需从第一性原理和语义出发，为否定式 $\\lnot \\varphi$ 构建 NBA，形成积 $\\mathcal{T} \\times \\mathcal{A}_{\\lnot \\varphi}$，从积的初始集计算可达状态，并通过检测可达的接受环路来判断空性。\n\n测试套件。对于每个测试用例，迁移系统 $\\mathcal{T}$ 由状态数、初始状态索引、显式迁移关系和标记函数给出。所有索引都是从零开始的，并且必须解释为整数。\n\n- 测试用例 1（$\\varphi_1$ 的“快乐路径”）：\n  - 状态 $S = \\{0, 1\\}$，初始 $S_0 = 0$。\n  - 迁移：$0 \\rightarrow 1$, $1 \\rightarrow 0$。\n  - 标记：$L(0) = \\{p\\}$, $L(1) = \\emptyset$。\n  - 属性：$\\varphi_1$。\n\n- 测试用例 2（因在 $\\lnot p$ 处稳定而违反 $\\varphi_1$）：\n  - 状态 $S = \\{0, 1\\}$，初始 $S_0 = 0$。\n  - 迁移：$0 \\rightarrow 1$, $1 \\rightarrow 1$。\n  - 标记：$L$ 如 $L(0) = \\{p\\}$, $L(1) = \\emptyset$。\n  - 属性：$\\varphi_1$。\n\n- 测试用例 3（$\\varphi_2$ 的“快乐路径”）：\n  - 状态 $S = \\{0, 1\\}$，初始 $S_0 = 0$。\n  - 迁移：$0 \\rightarrow 1$, $1 \\rightarrow 0$。\n  - 标记：$L(0) = \\{r\\}$, $L(1) = \\{g\\}$。\n  - 属性：$\\varphi_2$。\n\n- 测试用例 4（因请求后无授权而违反 $\\varphi_2$）：\n  - 状态 $S = \\{0, 1\\}$，初始 $S_0 = 0$。\n  - 迁移：$0 \\rightarrow 1$, $1 \\rightarrow 1$。\n  - 标记：$L(0) = \\{r\\}$, $L(1) = \\emptyset$。\n  - 属性：$\\varphi_2$。\n\n- 测试用例 5（边界条件：当 $r$ 从不成立时，$\\varphi_2$ 被空洞地满足）：\n  - 状态 $S = \\{0\\}$，初始 $S_0 = 0$。\n  - 迁移：$0 \\rightarrow 0$。\n  - 标记：$L(0) = \\emptyset$。\n  - 属性：$\\varphi_2$。\n\n要求的最终输出格式。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是一个布尔值，按测试套件的顺序指示给定模型是否满足其属性：例如，对于三个用例，格式为 $[\\text{True},\\text{False},\\text{True}]$。输出中不允许有任何额外的文本或格式。",
            "solution": "该问题要求判断一个给定的有限状态模型 $\\mathcal{T}$ 是否满足一个指定的线性时序逻辑 (LTL) 属性 $\\varphi$。规定的方法是自动机论方法，这是算法形式化验证的基石。该方法将模型检测问题 $\\mathcal{T} \\models \\varphi$ 转化为一个自动机语言空性问题。其核心原理是：一个模型满足一个属性，当且仅当其所有可能的行为（迹）都不违反该属性。这可以形式化地表述为：$\\mathcal{T} \\models \\varphi$ 当且仅当 $\\mathcal{L}(\\mathcal{T}) \\cap \\mathcal{L}(\\lnot\\varphi) = \\emptyset$，其中 $\\mathcal{L}(\\mathcal{T})$ 是模型 $\\mathcal{T}$ 生成的所有无限迹的集合，而 $\\mathcal{L}(\\lnot\\varphi)$ 是满足属性*否定*式 $\\lnot\\varphi$ 的所有无限迹的集合。\n\n该过程包括三个主要步骤：\n1.  **为否定属性构造一个非确定性布赫自动机 (NBA)。** 构造一个 NBA $\\mathcal{A}_{\\lnot\\varphi}$，使其语言 $\\mathcal{L}(\\mathcal{A}_{\\lnot\\varphi})$ 精确地是满足 $\\lnot\\varphi$ 的迹集合。\n2.  **构造同步积自动机。** 积 $\\mathcal{P} = \\mathcal{T} \\times \\mathcal{A}_{\\lnot\\varphi}$ 是一个自动机，其语言 $\\mathcal{L}(\\mathcal{P})$ 正是交集 $\\mathcal{L}(\\mathcal{T}) \\cap \\mathcal{L}(\\mathcal{A}_{\\lnot\\varphi})$。$\\mathcal{P}$ 的非空语言表示存在一个既由模型生成又违反属性的迹，即一个反例。\n3.  **检查语言空性。** 一个布赫自动机的语言非空，当且仅当存在一个从初始状态可达的接受状态，并且从该接受状态可以返回其自身。这对应于在积自动机的状态图中找到一个可达的接受环路。\n\n一个模型被定义为一个标记迁移系统 $\\mathcal{T} = (S, S_0, \\rightarrow, L)$，其中 $S$ 是一个状态集，$S_0$ 是初始状态，$\\rightarrow$ 是迁移关系，而 $L: S \\to 2^{\\mathsf{AP}}$ 是一个在原子命题集 $\\mathsf{AP} = \\{p, r, g\\}$ 上的标记函数。一个 NBA 是一个元组 $\\mathcal{A} = (Q, Q_0, \\Sigma, \\delta, F)$，其中 $Q$ 是一个状态集，$Q_0 \\subseteq Q$ 是一个初始状态集，$\\Sigma = 2^{\\mathsf{AP}}$ 是字母表（原子命题的集合），$\\delta \\subseteq Q \\times \\Sigma \\times Q$ 是迁移关系，$F \\subseteq Q$ 是接受状态集。\n\n**1. 否定属性的非确定性布赫自动机**\n\n我们为两个属性 $\\varphi_1$ 和 $\\varphi_2$ 的否定式构建 NBA。\n\n-   **属性 $\\varphi_1 = \\mathbf{G}\\,\\mathbf{F}\\, p$ (“$p$ 无限次出现”)：** 其否定式为 $\\lnot\\varphi_1 = \\lnot(\\mathbf{G}\\,\\mathbf{F}\\, p) \\equiv \\mathbf{F}\\,\\mathbf{G}\\,(\\lnot p)$，意为“最终，$p$ 永远为假”。NBA $\\mathcal{A}_{\\lnot\\varphi_1}$ 需要接受那些在某个有限前缀之后只包含 $p$ 不为真状态的迹。\n    -   $Q = \\{q_0, q_1\\}$，$q_0$ 为初始状态。\n    -   $F = \\{q_1\\}$。\n    -   迁移 $\\delta$：\n        -   $q_0 \\xrightarrow{\\text{true}} q_0$：自动机可以对任何输入停留在初始状态，等待“永远 $\\lnot p$”序列的开始。\n        -   $q_0 \\xrightarrow{\\lnot p} q_1$：非确定性地猜测当前状态标志着违规的开始。\n        -   $q_1 \\xrightarrow{\\lnot p} q_1$：一旦进入接受状态 $q_1$，迹中的所有后续状态都必须不满足 $p$。\n    一个接受运行必须最终进入并停留在 $q_1$ 中，从而无限次访问它。\n\n-   **属性 $\\varphi_2 = \\mathbf{G}\\,(r \\rightarrow \\mathbf{F}\\, g)$ (“总是，如果 $r$ 成立，则 $g$ 最终成立”)：** 其否定式为 $\\lnot\\varphi_2 = \\lnot(\\mathbf{G}\\,(r \\rightarrow \\mathbf{F}\\, g)) \\equiv \\mathbf{F}\\,(r \\land \\mathbf{G}\\,(\\lnot g))$，意为“最终，$r$ 成立，并从那时起 $g$ 永远不成立”。\n    -   $Q = \\{q_0, q_1\\}$，$q_0$ 为初始状态。\n    -   $F = \\{q_1\\}$。\n    -   迁移 $\\delta$：\n        -   $q_0 \\xrightarrow{\\text{true}} q_0$：自动机等待 $r$ 成立的违规状态。\n        -   $q_0 \\xrightarrow{r \\land \\lnot g} q_1$：在看到一个 $r$ 成立但 $g$ 不成立的状态时，非确定性地移动到接受状态，猜测这是违规的开始。\n        -   $q_1 \\xrightarrow{\\lnot g} q_1$：为了停留在接受状态 $q_1$，所有后续状态都必须不满足 $g$。\n    此自动机的一个接受运行对应于一个最终满足 $r$ 且此后永远满足 $\\lnot g$ 的迹。\n\n**2. 同步积构造**\n\n积自动机 $\\mathcal{P} = \\mathcal{T} \\times \\mathcal{A}_{\\lnot\\varphi}$ 定义如下：\n-   **状态：** $S_{\\mathcal{P}} = S \\times Q$。积中的一个状态 $(s, q)$ 对应于模型处于状态 $s$ 且 NBA 处于状态 $q$。\n-   **初始状态：** $S_{\\mathcal{P},0} = (S_0, q_0)$，其中 $S_0$ 是 $\\mathcal{T}$ 的初始状态，$q_0$ 是 $\\mathcal{A}_{\\lnot\\varphi}$ 的初始状态。\n-   **迁移关系：** 在 $\\mathcal{P}$ 中存在迁移 $(s, q) \\rightarrow (s', q')$ 当且仅当在 $\\mathcal{T}$ 中存在迁移 $s \\rightarrow s'$ 并且在 $\\mathcal{A}_{\\lnot\\varphi}$ 中存在迁移 $q \\xrightarrow{L(s)} q'$。NBA 的迁移由模型中*源*状态 $s$ 的标记 $L(s)$ 决定，这对应于在移动到状态 $s'$ 之前处理迹元素 $L(s)$。\n-   **接受状态：** $F_{\\mathcal{P}} = S \\times F$。如果 $q$ 是 $\\mathcal{A}_{\\lnot\\varphi}$ 中的接受状态，则积状态 $(s, q)$ 是接受的。\n\n**3. 通过可达接受环路进行空性检查**\n\n最后一步是检查 $\\mathcal{L}(\\mathcal{P})$ 是否为空。这通过在 $\\mathcal{P}$ 的状态图中搜索一个从初始状态可达且包含至少一个来自 $F_{\\mathcal{P}}$ 的接受状态的环路来完成。算法如下：\n1.  从初始积状态 $(S_0, q_0)$ 开始，通过图遍历（例如，深度优先搜索或广度优先搜索）构建积图的可达部分。\n2.  将可达子图分解为其强连通分量 (SCCs)。像 Tarjan 算法或 Kosaraju 算法是完成此任务的标准算法。\n3.  对每个 SCC，检查其是否满足两个条件：\n    a. 它包含至少一个接受状态 $(s, q) \\in F_{\\mathcal{P}}$。\n    b. 它表示一个环路（即，SCC 包含多个状态，或者它是一个带自环的单个状态）。\n4. 如果存在这样的 SCC，则找到了一个反例迹，语言非空，模型 $\\mathcal{T}$ *不*满足属性 $\\varphi$。如果没有找到这样的 SCC，则语言为空，$\\mathcal{T}$ 满足 $\\varphi$。\n\n对每个测试用例实施此完整过程，以确定布尔满足结果。",
            "answer": "[True,False,True,False,True]"
        }
    ]
}