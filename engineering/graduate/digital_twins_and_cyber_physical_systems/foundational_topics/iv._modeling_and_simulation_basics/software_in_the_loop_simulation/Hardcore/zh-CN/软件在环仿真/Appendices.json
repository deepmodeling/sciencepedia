{
    "hands_on_practices": [
        {
            "introduction": "在软件在环（SIL）仿真中，一个核心挑战是如何高效且稳定地对被控对象的连续动态进行数值求解。许多工程系统，如航空航天或汽车动力总成，本质上是“**刚性**”的，即它们包含时间尺度差异巨大的动态过程。本练习将通过第一性原理，揭示为何像显式欧拉法这样的简单积分器在处理刚性系统时会受到极其严格的步长限制，并由此突显在SIL仿真中选择合适数值积分方法（如隐式方法）的重要性。",
            "id": "4246751",
            "problem": "一个针对信息物理系统数字孪生的软件在环（SIL）实验，采用基于主机的数值积分器来模拟一个刚性连续时间被控对象，同时在环路中执行控制器软件。在标称工作点附近，该被控对象被线性化为时不变形式 $\\dot{x}(t) = A x(t)$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是被控对象动态特性的雅可比矩阵。该被控对象表现出刚性，因为矩阵 $A$ 的特征值具有很大的负实部。在一个特定的工作点，数值线性分析得出了三个实数特征值：$\\lambda_{1} = -2.0 \\times 10^{3}\\ \\text{s}^{-1}$，$\\lambda_{2} = -50\\ \\text{s}^{-1}$ 和 $\\lambda_{3} = -0.5\\ \\text{s}^{-1}$。\n\n在此 SIL 设置中，被控对象使用具有固定步长 $h > 0$ 的显式前向欧拉法进行时间推进，生成一个离散时间模型 $x_{k+1} = \\Phi(h)\\,x_{k}$，该模型用于每步更新一次被控对象的状态。仅使用线性化、模态分解和线性时不变系统的离散时间稳定性判据（状态转移矩阵的所有特征值必须严格位于单位圆盘内部）的基本原理，完成以下任务：\n\n- 从第一性原理出发，推导关于步长 $h$ 的绝对稳定域，以保证在线性化被控对象上使用显式欧拉法时每个特征模态的线性稳定性。\n- 由此推导出保证所有三个模态同时线性稳定的对 $h$ 的约束，并计算给定特征值所允许的最大统一的步长 $h$。\n- 作为比较，对应用于相同线性化被控对象的隐式后向欧拉法重复进行模态稳定性分析，并确定对于具有严格负实部的特征值，是否需要任何步长限制来维持线性稳定性。您必须从第一性原理证明您的结论，但无需在最终数值答案中报告它。\n\n用秒表示您最终的 $h$ 值，并将答案四舍五入到 $3$ 位有效数字。",
            "solution": "问题要求分析软件在环（SIL）仿真中的数值稳定性。被控对象动态特性在工作点附近被线性化，得到一个线性时不变（LTI）系统：\n$$\n\\dot{x}(t) = A x(t)\n$$\n其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$A \\in \\mathbb{R}^{n \\times n}$ 是系统雅可比矩阵。该系统由三个实数特征值表征：$\\lambda_{1} = -2.0 \\times 10^{3}\\ \\text{s}^{-1}$，$\\lambda_{2} = -50\\ \\text{s}^{-1}$，以及 $\\lambda_{3} = -0.5\\ \\text{s}^{-1}$。\n\n为了分析数值方法的稳定性，我们可以使用模态分解来解耦系统动态。假设矩阵 $A$ 是可对角化的（这里由于其具有不同的实数特征值而得到保证），则存在一个变换 $x(t) = P z(t)$，其中 $P$ 是 $A$ 的特征向量矩阵。将此代入状态方程可得：\n$$\nP \\dot{z}(t) = A P z(t)\n$$\n$$\n\\dot{z}(t) = P^{-1} A P z(t) = \\Lambda z(t)\n$$\n其中 $\\Lambda$ 是 $A$ 的特征值对角矩阵。该变换将 $n$ 维系统解耦为 $n$ 个独立的标量常微分方程（ODE），每个方程对应一个模态 $z_i(t)$：\n$$\n\\dot{z}_i(t) = \\lambda_i z_i(t) \\quad \\text{for } i = 1, 2, 3\n$$\n将数值方法应用于整个系统 $\\dot{x}(t) = A x(t)$ 的稳定性等同于将其应用于每个标量测试方程的稳定性。\n\n**第一部分：显式前向欧拉法的稳定性分析**\n\n显式前向欧拉法使用具有固定步长 $h > 0$ 的前向差分公式来近似导数 $\\dot{z}_i(t)$：\n$$\n\\dot{z}_i(t_k) \\approx \\frac{z_{i}(t_{k+1}) - z_{i}(t_k)}{h}\n$$\n其中 $t_k = kh$，我们使用记号 $z_{i,k} \\equiv z_i(t_k)$。将此应用于模态ODE $\\dot{z}_i(t) = \\lambda_i z_i(t)$ 可得：\n$$\n\\frac{z_{i,k+1} - z_{i,k}}{h} = \\lambda_i z_{i,k}\n$$\n求解 $z_{i,k+1}$ 可得第 $i$ 个模态的离散时间更新规则：\n$$\nz_{i,k+1} = z_{i,k} + h \\lambda_i z_{i,k} = (1 + h \\lambda_i) z_{i,k}\n$$\n为了使离散时间系统稳定，传播因子（即单模态离散时间状态转移矩阵的特征值）的模必须严格小于 $1$。这就是问题中提到的单位圆盘判据。因此，对于每个模态 $i$，我们需要：\n$$\n|1 + h \\lambda_i|  1\n$$\n该不等式定义了前向欧拉法的绝对稳定域。由于给定的特征值 $\\lambda_i$ 是负实数，步长 $h$ 是正实数，因此项 $h \\lambda_i$ 是一个负实数。绝对值不等式可以写成一对不等式：\n$$\n-1  1 + h \\lambda_i  1\n$$\n我们分别分析每个不等式：\n1.  右侧：$1 + h \\lambda_i  1 \\implies h \\lambda_i  0$。由于 $h > 0$ 且所有给定的 $\\lambda_i  0$，此条件始终满足。\n2.  左侧：$-1  1 + h \\lambda_i \\implies -2  h \\lambda_i$。由于 $\\lambda_i$ 是负数，除以它会反转不等号：\n$$\nh  -\\frac{2}{\\lambda_i}\n$$\n这是保证第 $i$ 个模态稳定性的对步长 $h$ 的约束。为了使整个系统稳定，该约束必须对所有模态同时满足。这意味着 $h$ 必须小于由每个特征值确定的上界中的最小值。\n\n**第二部分：最大允许步长的计算**\n\n我们将推导出的约束 $h  -2/\\lambda_i$ 应用于每个给定的特征值：\n- 对于 $\\lambda_1 = -2.0 \\times 10^3\\ \\text{s}^{-1}$:\n$$\nh  -\\frac{2}{-2.0 \\times 10^3} \\ \\text{s} = 1.0 \\times 10^{-3}\\ \\text{s}\n$$\n- 对于 $\\lambda_2 = -50\\ \\text{s}^{-1}$:\n$$\nh  -\\frac{2}{-50} \\ \\text{s} = \\frac{1}{25}\\ \\text{s} = 0.04\\ \\text{s}\n$$\n- 对于 $\\lambda_3 = -0.5\\ \\text{s}^{-1}$:\n$$\nh  -\\frac{2}{-0.5} \\ \\text{s} = 4\\ \\text{s}\n$$\n为确保所有三个模态的稳定性，步长 $h$ 必须满足所有三个不等式。最严格的约束是由模最大的特征值 $\\lambda_1$ 施加的，它对应于系统最快的动态模态。这是刚性微分方程的一个典型特征。\n$$\nh  \\min(1.0 \\times 10^{-3}, 0.04, 4)\\ \\text{s}\n$$\n$$\nh  1.0 \\times 10^{-3}\\ \\text{s}\n$$\n因此，允许的最大统一的步长 $h$ 是 $1.0 \\times 10^{-3}\\ \\text{s}$。四舍五入到 $3$ 位有效数字得到 $1.00 \\times 10^{-3}\\ \\text{s}$。\n\n**第三部分：隐式后向欧拉法的比较分析**\n\n作为比较，我们分析隐式后向欧拉法的稳定性。关键区别在于，导数是使用下一个时间步的状态 $z_{i,k+1}$ 来计算的：\n$$\n\\frac{z_{i,k+1} - z_{i,k}}{h} = \\lambda_i z_{i,k+1}\n$$\n我们求解 $z_{i,k+1}$：\n$$\nz_{i,k+1} - h \\lambda_i z_{i,k+1} = z_{i,k}\n$$\n$$\nz_{i,k+1} (1 - h \\lambda_i) = z_{i,k}\n$$\n$$\nz_{i,k+1} = \\left( \\frac{1}{1 - h \\lambda_i} \\right) z_{i,k}\n$$\n稳定性判据要求传播因子的模小于 $1$：\n$$\n\\left| \\frac{1}{1 - h \\lambda_i} \\right|  1 \\implies |1 - h \\lambda_i| > 1\n$$\n我们已知特征值 $\\lambda_i$ 具有严格的负实部。让我们对我们的负实数特征值进行分析。令 $\\lambda_i = -a_i$，其中 $a_i > 0$。稳定性条件变为：\n$$\n|1 - h(-a_i)| > 1 \\implies |1 + h a_i| > 1\n$$\n由于 $h > 0$ 和 $a_i > 0$，乘积 $h a_i$ 是一个正实数。因此，$1 + h a_i$ 是一个严格大于 $1$ 的实数。它的绝对值就是它本身，所以条件是：\n$$\n1 + h a_i > 1\n$$\n这个不等式对任何 $h > 0$ 和任何 $a_i > 0$ 都成立。这意味着当应用于特征值具有严格负实部的系统时，后向欧拉法对于任何正步长 $h$ 都是稳定的。这种方法被称为A-稳定。因此，对于给定的线性化被控对象，隐式后向欧拉法对步长 $h$ 没有施加上限来维持线性稳定性。这一特性使其非常适合模拟刚性系统，因为它允许比像前向欧拉法这样的条件稳定方法大得多的时间步长，从而降低了计算成本。\n\n最终要求的答案是前向欧拉法允许的最大步长。\n$h = 1.0 \\times 10^{-3}\\ \\text{s}$，四舍五入到 $3$ 位有效数字是 $1.00 \\times 10^{-3}\\ \\text{s}$。",
            "answer": "$$\n\\boxed{1.00 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "软件在环（SIL）仿真的一个基本任务是将连续时间的被控对象模型与离散时间的数字控制器连接起来。这个连接的关键环节是对被控对象的输出进行采样。本练习将从基本原理出发，推导著名的奈奎斯特-香农采样定理，从而揭示为避免信息丢失（即“混叠”）并确保控制器能准确感知被控对象行为所需的最小采样频率限制。",
            "id": "4246820",
            "problem": "在一个信息物理系统数字孪生的软件在环（SIL）场景中，一个输出为 $y(t)$ 的连续时间被控对象被仿真和采样，以产生一个离散时间信号 $y[k] = y(k T_{s})$，该信号被输入到一个数字控制器中。假设该被控对象是线性时不变的，其输出 $y(t)$ 是严格带限的，单边带宽为 $\\omega_{b}$，这意味着当 $|\\omega| > \\omega_{b}$ 时，其频谱幅值 $|Y(\\omega)|$ 可忽略不计。\n\n从理想采样的定义（即 $y(t)$ 与狄拉克冲激序列的乘积）以及傅里叶变换的相应基本性质出发，推导采样角频率 $\\omega_{s}$ 需满足的、以防止 $y[k]$ 在频域中发生混叠的条件。然后，利用该条件，计算在奈奎斯特极限下以 $\\omega_{b}$ 表示的采样周期 $T_{s}$。\n\n最终的采样周期以秒为单位表示。最终报告的量必须是单个闭式表达式。不需要进行数值四舍五入。",
            "solution": "我们首先对理想采样过程进行建模。连续时间信号 $y(t)$ 与一个无穷狄拉克δ函数序列 $p(t)$ 相乘，得到连续时间下的采样信号 $y_s(t)$。这个信号 $y_s(t)$ 是一个冲激序列，其幅值是采样值 $y[k]$。\n\n狄拉克冲激序列定义为：\n$$\np(t) = \\sum_{k=-\\infty}^{\\infty} \\delta(t - k T_s)\n$$\n其中 $T_s$ 是采样周期。因此，采样信号为：\n$$\ny_s(t) = y(t) \\cdot p(t) = y(t) \\sum_{k=-\\infty}^{\\infty} \\delta(t - k T_s) = \\sum_{k=-\\infty}^{\\infty} y(k T_s) \\delta(t - k T_s)\n$$\n\n为了分析采样在频域中的影响，我们使用傅里叶变换。卷积定理指出，时域中的乘法对应于频域中的卷积。如果 $Y(\\omega)$ 是 $y(t)$ 的傅里叶变换，$P(\\omega)$ 是 $p(t)$ 的傅里叶变换，那么采样信号的傅里叶变换 $Y_s(\\omega)$ 由下式给出：\n$$\nY_s(\\omega) = \\mathcal{F}\\{y_s(t)\\} = \\frac{1}{2\\pi} \\left( Y(\\omega) * P(\\omega) \\right)\n$$\n其中 $*$ 表示卷积。\n\n首先，我们必须求出冲激序列的傅里叶变换 $P(\\omega)$。冲激序列 $p(t)$ 是一个周期为 $T_s$ 的周期函数。我们可以用其傅里叶级数展开来表示它：\n$$\np(t) = \\sum_{n=-\\infty}^{\\infty} c_n e^{j n \\omega_s t}\n$$\n其中 $\\omega_s = \\frac{2\\pi}{T_s}$ 是采样角频率。傅里叶级数系数 $c_n$ 由下式给出：\n$$\nc_n = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} p(t) e^{-j n \\omega_s t} dt = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} \\delta(t) e^{-j n \\omega_s t} dt = \\frac{1}{T_s} e^0 = \\frac{1}{T_s}\n$$\n将系数代回级数得到：\n$$\np(t) = \\frac{1}{T_s} \\sum_{n=-\\infty}^{\\infty} e^{j n \\omega_s t}\n$$\n现在，我们对这个表达式逐项进行傅里叶变换。利用性质 $\\mathcal{F}\\{e^{j \\omega_0 t}\\} = 2\\pi \\delta(\\omega - \\omega_0)$，我们得到：\n$$\nP(\\omega) = \\mathcal{F}\\left\\{ \\frac{1}{T_s} \\sum_{n=-\\infty}^{\\infty} e^{j n \\omega_s t} \\right\\} = \\frac{1}{T_s} \\sum_{n=-\\infty}^{\\infty} 2\\pi \\delta(\\omega - n \\omega_s) = \\omega_s \\sum_{n=-\\infty}^{\\infty} \\delta(\\omega - n \\omega_s)\n$$\n时域中的狄拉克冲激序列的傅里葉變換是頻域中的另一個狄拉克衝激序列，並按 $\\omega_s$ 進行了縮放。\n\n现在我们可以通过执行卷积来计算采样信号的频谱 $Y_s(\\omega)$：\n$$\nY_s(\\omega) = \\frac{1}{2\\pi} \\left( Y(\\omega) * \\left( \\omega_s \\sum_{n=-\\infty}^{\\infty} \\delta(\\omega - n \\omega_s) \\right) \\right)\n$$\n利用与冲激函数卷积的筛选性质 $f(\\omega) * \\delta(\\omega - \\omega_0) = f(\\omega - \\omega_0)$，我们得到：\n$$\nY_s(\\omega) = \\frac{\\omega_s}{2\\pi} \\sum_{n=-\\infty}^{\\infty} Y(\\omega - n \\omega_s)\n$$\n代入 $\\omega_s = \\frac{2\\pi}{T_s}$：\n$$\nY_s(\\omega) = \\frac{1}{T_s} \\sum_{n=-\\infty}^{\\infty} Y(\\omega - n \\omega_s)\n$$\n这个方程是基础性的：采样信号的频谱由原始信号频谱 $Y(\\omega)$ 的无数个副本组成，这些副本按 $\\frac{1}{T_s}$ 缩放，并按采样频率 $\\omega_s$ 的整数倍平移。\n\n问题指出，原始信号 $y(t)$ 是严格带限的，单边带宽为 $\\omega_b$。这意味着其频谱 $Y(\\omega)$ 在频带 $[-\\omega_b, \\omega_b]$ 之外的所有频率上都为零：\n$$\nY(\\omega) = 0 \\quad \\text{for} \\quad |\\omega| > \\omega_b\n$$\n\n当 $Y_s(\\omega)$ 中的频谱副本发生重叠时，就会出现混叠。为防止混叠，频谱副本必须是不相交的。原始频谱（对应 $n=0$）占据区间 $[-\\omega_b, \\omega_b]$。相邻的副本（对应 $n=1$）以 $\\omega_s$ 为中心，占据区间 $[\\omega_s - \\omega_b, \\omega_s + \\omega_b]$。为避免这两个相邻副本之间的重叠，$n=1$ 副本的下界必须大于或等于 $n=0$ 副本的上界。\n$$\n\\omega_s - \\omega_b \\ge \\omega_b\n$$\n这简化为防止混叠的采样角频率条件：\n$$\n\\omega_s \\ge 2\\omega_b\n$$\n这就是奈奎斯特-香农采样准则。\n\n问题要求在奈奎斯特极限下的采样周期 $T_s$。奈奎斯特极限是采样频率取能防止混叠的最小可能值的临界情况，这对应于上述推导条件中的等式：\n$$\n\\omega_s = 2\\omega_b\n$$\n这个特定的频率被称为奈奎斯特速率。\n\n采样周期 $T_s$ 与采样角频率 $\\omega_s$ 之间的关系由下式给出：\n$$\n\\omega_s = \\frac{2\\pi}{T_s}\n$$\n将奈奎斯特极限条件代入此关系，我们得到：\n$$\n2\\omega_b = \\frac{2\\pi}{T_s}\n$$\n最后，我们解出奈奎斯特极限下的采样周期 $T_s$：\n$$\nT_s = \\frac{2\\pi}{2\\omega_b} = \\frac{\\pi}{\\omega_b}\n$$\n对于带限于 $\\omega_b$ 的信号，这是避免混叠的最大可能采样周期。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\omega_{b}}}\n$$"
        },
        {
            "introduction": "即使我们拥有稳定的仿真器和正确的采样率，一个更隐蔽但同样致命的问题也可能在组件集成时出现：数据接口错误。本练习将探讨一个常见的实际问题，即被控对象模型与控制器软件之间的单位不匹配（例如，米与毫米）。我们将量化这种看似简单的错误如何对闭环系统的稳定性产生灾难性影响，并演示如何诊断和修正这类关键的集成错误。",
            "id": "4246810",
            "problem": "一个信息物理系统由一个数字孪生表示，该数字孪生与一个在软件在环（SIL）中实现的控制器交换测量值。物理设备是一个平移质量-弹簧-阻尼器系统，其质量为 $m$，粘性阻尼为 $c$，刚度为 $k$。其运动 $y(t)$ 遵循牛顿第二定律 $m \\ddot{y}(t) = \\sum F(t)$，其中作用力包括弹簧力 $-k y(t)$、阻尼力 $-c \\dot{y}(t)$ 和执行器输入 $u(t)$。控制器是一个在国际单位制（SI）下设计的连续时间全状态反馈律，并期望输入的位置单位为米，速度单位为米/秒。测量值通过一个软件接口从数字孪生传输到SIL控制器。\n\n考虑以下参数和设计：\n\n- 设备参数：$m = 1\\,\\mathrm{kg}$，$c = 2\\,\\mathrm{N\\cdot s/m}$，$k = 5\\,\\mathrm{N/m}$。\n- 状态定义：$x(t) = \\begin{pmatrix} y(t) \\\\ \\dot{y}(t) \\end{pmatrix}$。\n- 国际单位制下的连续时间状态空间模型：$\\dot{x}(t) = A x(t) + B u(t)$，其中 $A = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{c}{m} \\end{pmatrix}$ 和 $B = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix}$。\n- 期望国际单位制输入的状态反馈控制器：$u(t) = -K x(t)$，其中 $K = \\begin{pmatrix} k_1  k_2 \\end{pmatrix}$，$k_1 = 15\\,\\mathrm{N/m}$，$k_2 = 8\\,\\mathrm{N\\cdot s/m}$。\n\n在SIL设置中，数字孪生无意中发送了以毫米和毫米/秒为单位的位置和速度，而不是以米和米/秒为单位。设单位不匹配的缩放由 $S = \\operatorname{diag}(s, s)$ 表示，其中 $s = 1000$，因此控制器处理的是 $\\tilde{x}(t) = S x(t)$ 而不是 $x(t)$，从而产生的实际控制为 $u(t) = -K \\tilde{x}(t) = -K S x(t)$。这产生了一个闭环系统矩阵 $A_{\\text{cl,mismatch}} = A - B K S$，而原始设计产生的是 $A_{\\text{cl,SI}} = A - B K$。\n\n任务：\n1. 从牛顿第二定律以及阻尼力和刚度力的定义出发，推导状态空间模型 $\\dot{x}(t) = A x(t) + B u(t)$，并用 $m$、$c$ 和 $k$ 表示 $A$ 和 $B$。然后，用 $A$、$B$、$K$ 和 $S$ 明确写出闭环系统矩阵 $A_{\\text{cl,SI}}$ 和 $A_{\\text{cl,mismatch}}$。\n2. 使用基本控制概念，解释单位缩放 $S$ 如何改变有效反馈增益，并讨论其对连续时间和采样实现（即SIL）中闭环稳定性和动态响应的定性影响，同时参考连续时间极点与其采样等效极点之间通过指数化的关系。\n3. 计算一个标量增益校正因子 $\\gamma$，用于在测量值 $\\tilde{x}(t)$ 进入控制器之前在软件中对其进行预缩放，即实现 $u(t) = -K \\left( \\gamma \\tilde{x}(t) \\right)$，使得最终的闭环动态特性与原始基于国际单位制的设计完全匹配。以单个实数形式提供 $\\gamma$。将您的答案四舍五入到四位有效数字。因为 $\\gamma$ 是无量纲的，所以最终答案不需要物理单位。",
            "solution": "该问题探讨了信息物理控制系统中单位缩放错误的后果及其纠正方法。我们将按顺序完成这三个任务。\n\n**任务1：状态空间模型和闭环矩阵的推导**\n\n物理设备的动态特性由平移质量-弹簧-阻尼器系统的牛顿第二定律描述。作用在质量 $m$ 上的合力等于质量乘以其加速度 $\\ddot{y}(t)$。\n这些力是外部控制输入 $u(t)$、弹簧力 $-k y(t)$ 和阻尼力 $-c \\doty}(t)$。\n运动方程为：\n$$m \\ddot{y}(t) = u(t) - c \\dot{y}(t) - k y(t)$$\n为了推导状态空间模型，我们首先分离出最高阶导数 $\\ddot{y}(t)$：\n$$\\ddot{y}(t) = -\\frac{k}{m} y(t) - \\frac{c}{m} \\dot{y}(t) + \\frac{1}{m} u(t)$$\n状态变量定义为 $x_1(t) = y(t)$ (位置) 和 $x_2(t) = \\dot{y}(t)$ (速度)。状态向量为 $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$。\n现在我们写出状态变量的一阶微分方程：\n第一个状态变量的导数是：\n$$\\dot{x}_1(t) = \\frac{d}{dt}(y(t)) = \\dot{y}(t) = x_2(t)$$\n第二个状态变量的导数是：\n$$\\dot{x}_2(t) = \\frac{d}{dt}(\\dot{y}(t)) = \\ddot{y}(t) = -\\frac{k}{m} y(t) - \\frac{c}{m} \\dot{y}(t) + \\frac{1}{m} u(t) = -\\frac{k}{m} x_1(t) - \\frac{c}{m} x_2(t) + \\frac{1}{m} u(t)$$\n这两个方程可以写成矩阵形式 $\\dot{x}(t) = A x(t) + B u(t)$：\n$$\\begin{pmatrix} \\dot{x}_1(t) \\\\ \\dot{x}_2(t) \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{c}{m} \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix} u(t)$$\n通过观察，用物理参数表示的状态空间矩阵为：\n$$A = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{c}{m} \\end{pmatrix} \\quad \\text{和} \\quad B = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix}$$\n这完成了所要求的推导。\n\n接下来，我们写出闭环系统矩阵。控制律为 $u(t) = -Kx(t)$。闭环系统动态特性通过将控制律代入状态方程得到：$\\dot{x}(t) = A x(t) + B(-Kx(t)) = (A - BK)x(t)$。\n正确配置的、全程使用国际单位制的闭环系统矩阵是：\n$$A_{\\text{cl,SI}} = A - B K$$\n在单位不匹配的情况下，控制器接收到缩放后的状态向量 $\\tilde{x}(t) = S x(t)$，因此实际实现的控制是 $u(t) = -K\\tilde{x}(t) = -K S x(t)$。闭环动态特性变为 $\\dot{x}(t) = A x(t) + B(-KSx(t)) = (A - BKS)x(t)$。\n因此，在单位不匹配下的闭环系统矩阵是：\n$$A_{\\text{cl,mismatch}} = A - B K S$$\n\n**任务2：单位不匹配的定性影响**\n\n单位不匹配导致控制器操作的是 $\\tilde{x}(t) = S x(t)$ 而不是 $x(t)$。缩放矩阵是 $S = sI$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$s = 1000$。实际实现的控制律是 $u(t) = -K\\tilde{x}(t) = -K(Sx(t))$。因为 $S = sI$，这变为 $u(t) = -K(sI)x(t) = -sKx(t)$。\n这意味着有效反馈增益矩阵是 $K_{\\text{eff}} = sK$。当 $s = 1000$ 时，反馈增益 $k_1$ 和 $k_2$ 被有效地放大了1000倍。这对系统的行为产生了深远的影响。\n\n闭环特征方程决定了系统的极点，极点支配着稳定性和动态响应。对于不匹配的系统，方程是 $\\det(\\lambda I - A_{\\text{cl,mismatch}}) = 0$。\n$$A_{\\text{cl,mismatch}} = A - B(sK) = \\begin{pmatrix} 0  1 \\\\ -k/m  -c/m \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1/m \\end{pmatrix} s\\begin{pmatrix} k_1  k_2 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -(k+sk_1)/m  -(c+sk_2)/m \\end{pmatrix}$$\n特征多项式是：\n$$\\lambda \\left(\\lambda + \\frac{c+sk_2}{m}\\right) + \\frac{k+sk_1}{m} = 0 \\implies \\lambda^2 + \\left(\\frac{c+sk_2}{m}\\right)\\lambda + \\left(\\frac{k+sk_1}{m}\\right) = 0$$\n这是一个二阶系统的特征方程 $\\lambda^2 + 2\\zeta\\omega_n\\lambda + \\omega_n^2 = 0$。有效的自然频率 $\\omega_{n,\\text{eff}}$ 和阻尼比 $\\zeta_{\\text{eff}}$ 由以下公式确定：\n$$\\omega_{n,\\text{eff}}^2 = \\frac{k+sk_1}{m} \\quad \\text{和} \\quad 2\\zeta_{\\text{eff}}\\omega_{n,\\text{eff}} = \\frac{c+sk_2}{m}$$\n由于 $s = 1000$，有效的闭环刚度 $(k+sk_1)$ 和阻尼 $(c+sk_2)$ 与预期的设计值 $(k+k_1)$ 和 $(c+k_2)$ 相比都极大地增加了。这急剧地提高了自然频率，使系统响应极其迅速。\n在连续时间域，因为所有参数（$m, c, k, k_1, k_2, s$）都是正的，特征多项式的系数也都是正的。根据劳斯-赫尔维茨稳定性判据，系统的极点将保持在复平面的左半部分，所以系统在技术上是稳定的。然而，如此高的增益会导致严重的过阻尼或剧烈的振荡响应、执行器饱和，并激发模型中未包含的高频动态，这在实践中是一种失效形式。\n\n在像SIL这样的采样实现中，后果甚至更严重。离散时间系统的稳定性取决于其极点是否在z平面的单位圆内。对于一个采样周期 $T$，连续时间极点 $\\lambda_c$ 与其离散时间等效极点 $\\lambda_d$ 之间的关系是 $\\lambda_d = \\exp(\\lambda_c T)$。$A_{\\text{cl,mismatch}}$ 的连续时间极点的模极大，这对采样时间 $T$ 施加了严格的约束。对于动态的前向欧拉近似，只有当 $(I + T A_{\\text{cl,mismatch}})$ 的所有特征值都在单位圆内时，离散系统才是稳定的。这导致了形如 $|\\lambda_c|  \\alpha/T$ 的稳定性条件，其中 $\\alpha$ 是某个常数（例如，对于实数极点 $\\alpha=2$）。巨大的增益 $s$ 使得 $|\\lambda_c|$ 变得非常大，对于任何实际的 $T$ 都很容易违反这个条件，导致离散仿真在数值上变得不稳定。\n\n**任务3：校正因子 $\\gamma$ 的计算**\n\n目标是找到一个标量校正因子 $\\gamma$，使得修正后的控制律 $u(t) = -K (\\gamma \\tilde{x}(t))$ 能恢复最初预期的系统行为。预期的闭环动态特性由状态空间方程 $\\dot{x}(t) = (A - BK)x(t)$ 给出。\n使用所提出的校正，控制律为 $u(t) = -K \\gamma \\tilde{x}(t)$。代入关系式 $\\tilde{x}(t) = Sx(t)$，我们得到：\n$$u(t) = -K \\gamma (S x(t)) = -(K \\gamma S) x(t)$$\n得到的闭环系统动态特性为：\n$$\\dot{x}(t) = A x(t) + B u(t) = A x(t) - B(K \\gamma S)x(t) = (A - B K \\gamma S) x(t)$$\n为了使这些动态特性对于任何状态 $x(t)$ 都与预期的动态特性相同，闭环矩阵必须相等：\n$$A - B K = A - B K \\gamma S$$\n该方程简化为：\n$$B K = B K \\gamma S$$\n矩阵 $S$ 已知为 $S = \\operatorname{diag}(s, s)$，可以写成 $S = sI$，其中 $I$ 是单位矩阵。因为 $\\gamma$ 和 $s$ 是标量，它们可以与所有矩阵交换位置。\n$$B K = B K \\gamma s I = \\gamma s (B K)$$\n矩阵乘积 $BK$ 是：\n$$BK = \\begin{pmatrix} 0 \\\\ 1/m \\end{pmatrix} \\begin{pmatrix} k_1  k_2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ k_1/m  k_2/m \\end{pmatrix}$$\n由于 $m$、$k_1$ 和 $k_2$ 都非零，$BK$ 不是一个零矩阵。因此，我们可以从方程 $BK = \\gamma s (BK)$ 中有效地得出结论：\n$$\\gamma s = 1$$\n解出校正因子 $\\gamma$：\n$$\\gamma = \\frac{1}{s}$$\n给定缩放因子 $s = 1000$：\n$$\\gamma = \\frac{1}{1000} = 0.001$$\n题目要求答案四舍五入到四位有效数字。精确值为 $0.001$。为了用四位有效数字表示，我们加上后缀零。\n$$\\gamma = 0.001000$$\n这个因子 $\\gamma$ 在测量值被控制器使用之前，有效地反转了由单位不匹配引入的错误缩放，从而恢复了预期的系统行为。",
            "answer": "$$\\boxed{0.001000}$$"
        }
    ]
}