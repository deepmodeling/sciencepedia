{
    "hands_on_practices": [
        {
            "introduction": "The convergence speed of a consensus algorithm is fundamentally tied to the underlying communication topology. This exercise provides a foundational link between algebraic graph theory and system dynamics. By constructing the graph Laplacian for a specific network and calculating its second-smallest eigenvalue, the algebraic connectivity $\\lambda_2(L)$, you will directly quantify the exponential rate at which agents reach an agreement in a continuous-time consensus protocol.",
            "id": "4209962",
            "problem": "Consider a four-agent coordination problem in the context of Digital Twin (DT) models for Cyber-Physical Systems (CPS), where each agent maintains a scalar state $x_i(t)$ and communicates over an undirected weighted graph. The continuous-time average consensus protocol is given by the coupled linear dynamics $\\dot{x}(t)=-L x(t)$, where $x(t)\\in\\mathbb{R}^{4}$ collects the agents' states and $L$ is the graph Laplacian derived from the network topology.\n\nThe communication graph is defined as follows: agents $1$, $2$, $3$, and $4$ form a cycle with unit-weight edges $\\{(1,2),(2,3),(3,4),(4,1)\\}$, and there is an additional chord $\\{(1,3)\\}$ of weight $w>0$. Assume nondimensionalized time so all weights and rates are dimensionless. Starting only from fundamental definitions of the Laplacian for undirected weighted graphs, eigenvalues of real symmetric matrices, and the standard continuous-time linear system solution $x(t)=\\exp(-L t)\\,x(0)$, do the following:\n\n- Construct the Laplacian matrix $L$ from the given topology.\n- Compute the algebraic connectivity $\\lambda_{2}(L)$, defined as the second-smallest eigenvalue of $L$, exactly (no approximations and no rounding).\n- Using first principles of spectral decomposition for linear time-invariant systems, relate $\\lambda_{2}(L)$ to the exponential convergence rate of the disagreement dynamics under average consensus, and determine the exact rate constant.\n\nReport only the exponential convergence rate constant as your final answer, expressed as an exact real number with no units. Do not round.",
            "solution": "The problem will be validated and, if valid, solved by following a strict, step-by-step procedure.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n-   System of agents: $N=4$ agents.\n-   Agent states: Scalar states $x_i(t)$ for $i \\in \\{1, 2, 3, 4\\}$. State vector is $x(t) \\in \\mathbb{R}^{4}$.\n-   System dynamics: $\\dot{x}(t) = -L x(t)$, where $L$ is the graph Laplacian.\n-   System solution form: $x(t) = \\exp(-L t) x(0)$.\n-   Graph topology: Undirected and weighted.\n    -   Cycle edges with unit weight: $\\{(1,2), (2,3), (3,4), (4,1)\\}$.\n    -   Chord edge: $\\{(1,3)\\}$ with weight $w > 0$.\n-   Key quantity: Algebraic connectivity $\\lambda_{2}(L)$, the second-smallest eigenvalue of $L$.\n-   Objective:\n    1.  Construct the Laplacian matrix $L$.\n    2.  Compute $\\lambda_{2}(L)$ exactly.\n    3.  Relate $\\lambda_{2}(L)$ to the exponential convergence rate of the disagreement dynamics and determine the exact rate constant.\n-   Final Answer Requirement: The exponential convergence rate constant, expressed as an exact real number.\n\n#### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is firmly grounded in algebraic graph theory and the theory of multi-agent systems, specifically in the context of consensus protocols. The model $\\dot{x}(t) = -L x(t)$ is the canonical representation for continuous-time average consensus. All concepts are standard within control theory, applied mathematics, and engineering. The problem is scientifically sound.\n2.  **Well-Posedness**: The graph is fully specified (up to the parameter $w$). The dynamics are defined. The questions asked are precise. The graph is connected for any $w > 0$, which ensures that $L$ has a single zero eigenvalue, and thus a well-defined algebraic connectivity $\\lambda_2(L) > 0$. The request for an \"exact real number\" as the final answer, despite the presence of the parameter $w > 0$, initially suggests a potential contradiction. However, a preliminary analysis shows that the quantity of interest, $\\lambda_2(L)$, is constant for all $w > 0$. Thus, the problem is well-posed.\n3.  **Objectivity**: The problem is stated in objective, mathematical language, free from ambiguity or subjective claims.\n\n#### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\n\nThe solution proceeds in three parts as requested by the problem statement.\n\n#### Part 1: Construction of the Laplacian Matrix $L$\n\nThe Laplacian matrix $L$ for an undirected, weighted graph is defined as $L = D - A$, where $D$ is the diagonal degree matrix and $A$ is the weighted adjacency matrix.\n\nThe agents are numbered $1, 2, 3, 4$. The edge weights are given by $w_{12}=w_{21}=1$, $w_{23}=w_{32}=1$, $w_{34}=w_{43}=1$, $w_{41}=w_{14}=1$, and $w_{13}=w_{31}=w$. All other weights are $0$.\n\nThe adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0  1  w  1 \\\\\n1  0  1  0 \\\\\nw  1  0  1 \\\\\n1  0  1  0\n\\end{pmatrix}\n$$\nThe degree of a node, $d_i$, is the sum of the weights of the edges connected to it.\n-   $d_1 = w_{12} + w_{13} + w_{14} = 1 + w + 1 = 2+w$\n-   $d_2 = w_{21} + w_{23} = 1 + 1 = 2$\n-   $d_3 = w_{31} + w_{32} + w_{34} = w + 1 + 1 = 2+w$\n-   $d_4 = w_{41} + w_{43} = 1 + 1 = 2$\n\nThe degree matrix $D$ is the diagonal matrix of these degrees:\n$$\nD = \\begin{pmatrix}\n2+w  0  0  0 \\\\\n0  2  0  0 \\\\\n0  0  2+w  0 \\\\\n0  0  0  2\n\\end{pmatrix}\n$$\nThe Laplacian matrix $L = D - A$ is therefore:\n$$\nL = \\begin{pmatrix}\n2+w  -1  -w  -1 \\\\\n-1  2  -1  0 \\\\\n-w  -1  2+w  -1 \\\\\n-1  0  -1  2\n\\end{pmatrix}\n$$\n\n#### Part 2: Computation of the Algebraic Connectivity $\\lambda_2(L)$\n\nThe algebraic connectivity is the second-smallest eigenvalue of $L$. Since the graph is undirected and connected, $L$ is a symmetric, positive semi-definite matrix. Its smallest eigenvalue is $\\lambda_1 = 0$, with the corresponding eigenvector $\\mathbf{1} = [1, 1, 1, 1]^T$.\n\nTo find the other eigenvalues, we can exploit the symmetry of the graph. The graph is symmetric with respect to swapping nodes $2$ and $4$. The Laplacian $L$ is invariant under the corresponding permutation. This implies that its eigenspace can be decomposed into subspaces of vectors that are symmetric ($v_2 = v_4$) and anti-symmetric ($v_2 = -v_4$) with respect to this swap.\n\nLet's test the anti-symmetric vector $u = [0, 1, 0, -1]^T$ as a potential eigenvector.\n$$\nL u = \\begin{pmatrix}\n2+w  -1  -w  -1 \\\\\n-1  2  -1  0 \\\\\n-w  -1  2+w  -1 \\\\\n-1  0  -1  2\n\\end{pmatrix}\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n= \\begin{pmatrix}\n(0) - 1 + (0) + 1 \\\\\n(0) + 2 + (0) + 0 \\\\\n(0) - 1 + (0) + 1 \\\\\n(0) + 0 + (0) - 2\n\\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n= 2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n= 2u\n$$\nThis shows that $\\lambda = 2$ is an eigenvalue of $L$.\n\nThe remaining three eigenvectors, including $\\mathbf{1}$, must be orthogonal to $u$, meaning they must be symmetric with respect to the swap of nodes $2$ and $4$. We can find the remaining three eigenvalues by solving the characteristic equation $\\det(L - \\lambda I) = 0$. The eigenvalues of $L$ are the roots of this polynomial.\nWe know the eigenvalues are $\\{0, 2, \\lambda_3, \\lambda_4\\}$. The sum of the eigenvalues equals the trace of the matrix.\n$$\n\\text{tr}(L) = (2+w) + 2 + (2+w) + 2 = 8+2w\n$$\nSo, $0 + 2 + \\lambda_3 + \\lambda_4 = 8+2w$, which implies $\\lambda_3 + \\lambda_4 = 6+2w$.\n\nTo find $\\lambda_3$ and $\\lambda_4$ without calculating the full characteristic polynomial, we can use the symmetry argument more formally. The matrix $L$ restricted to the symmetric subspace has eigenvalues $0, \\lambda_3, \\lambda_4$. The characteristic polynomial of this $3 \\times 3$ sub-problem can be shown to be $\\lambda(\\lambda^2 - (6+2w)\\lambda + 8(w+1)) = 0$. The non-zero roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{(6+2w) \\pm \\sqrt{(6+2w)^2 - 4(1)(8(w+1))}}{2}\n= \\frac{2(3+w) \\pm \\sqrt{4(3+w)^2 - 32(w+1)}}{2}\n$$\n$$\n\\lambda = (3+w) \\pm \\sqrt{(3+w)^2 - 8(w+1)}\n= (3+w) \\pm \\sqrt{(w^2 + 6w + 9) - (8w + 8)}\n$$\n$$\n\\lambda = (3+w) \\pm \\sqrt{w^2 - 2w + 1} = (3+w) \\pm \\sqrt{(w-1)^2} = (3+w) \\pm |w-1|\n$$\nSince $w > 0$ is given, we consider two cases for $|w-1|$.\n-   Case 1: $w \\ge 1$. Then $|w-1| = w-1$. The eigenvalues are $\\lambda = (3+w) \\pm (w-1)$, which gives $\\lambda_3 = (3+w) + (w-1) = 2w+2$ and $\\lambda_4 = (3+w) - (w-1) = 4$.\n-   Case 2: $0  w  1$. Then $|w-1| = 1-w$. The eigenvalues are $\\lambda = (3+w) \\pm (1-w)$, which gives $\\lambda_3 = (3+w) + (1-w) = 4$ and $\\lambda_4 = (3+w) - (1-w) = 2w+2$.\n\nIn both cases, the full set of eigenvalues of $L$ is $\\{0, 2, 4, 2w+2\\}$.\nTo find the algebraic connectivity $\\lambda_2(L)$, we must sort these eigenvalues in non-decreasing order: $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3 \\le \\lambda_4$.\nWe have $\\lambda_1 = 0$.\nThe non-zero eigenvalues are $\\{2, 4, 2w+2\\}$. Since $w > 0$, it follows that $2w > 0$, so $2w+2 > 2$.\nTherefore, the smallest positive eigenvalue is $2$.\nThe sorted eigenvalues are $0  2  \\min(4, 2w+2) \\le \\max(4, 2w+2)$.\nThe second-smallest eigenvalue, $\\lambda_2(L)$, is $2$.\n$$\n\\lambda_2(L) = 2\n$$\n\n#### Part 3: Relation of $\\lambda_2(L)$ to the Convergence Rate\n\nThe system is described by the linear time-invariant (LTI) dynamics $\\dot{x}(t) = -L x(t)$. Since $L$ is a real symmetric matrix, it is diagonalizable by an orthonormal matrix of its eigenvectors $V = [v_1, v_2, v_3, v_4]$. Let the corresponding eigenvalues be $\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4$.\nThe solution to the system is $x(t) = \\exp(-Lt)x(0)$. Using spectral decomposition, $L = V \\Lambda V^T$, where $\\Lambda = \\text{diag}(\\lambda_1, \\dots, \\lambda_4)$.\n$$\nx(t) = V \\exp(-\\Lambda t) V^T x(0)\n$$\nAny initial state $x(0)$ can be expressed in the basis of eigenvectors: $x(0) = \\sum_{i=1}^4 c_i v_i$, where $c_i = v_i^T x(0)$. The solution then becomes:\n$$\nx(t) = \\sum_{i=1}^4 c_i \\exp(-\\lambda_i t) v_i\n$$\nThe consensus value is the average of the initial states, $\\bar{x}(0) = \\frac{1}{4}\\sum_{i=1}^4 x_i(0)$. The steady-state is $x_{ss} = \\bar{x}(0)\\mathbf{1}$. This corresponds to the mode associated with $\\lambda_1=0$. Let $v_1 = \\frac{1}{\\sqrt{4}}\\mathbf{1} = \\frac{1}{2}\\mathbf{1}$. Then $c_1 v_1 = (v_1^T x(0))v_1 = (\\frac{1}{2}\\mathbf{1}^T x(0))(\\frac{1}{2}\\mathbf{1}) = \\frac{1}{4}(4\\bar{x}(0))\\mathbf{1} = \\bar{x}(0)\\mathbf{1} = x_{ss}$.\n\nThe disagreement vector, which measures the deviation from consensus, is $\\delta(t) = x(t) - x_{ss}$.\n$$\n\\delta(t) = x(t) - c_1 v_1 = \\sum_{i=2}^4 c_i \\exp(-\\lambda_i t) v_i\n$$\nThe convergence of $\\delta(t)$ to $0$ is determined by the exponential terms $\\exp(-\\lambda_i t)$ for $i=2,3,4$. Since all $\\lambda_i0$ for $i \\ge 2$, all these terms decay to zero. The rate of decay of the overall disagreement vector is limited by the slowest-decaying term, which corresponds to the smallest positive eigenvalue.\nThe convergence rate constant is therefore $\\min\\{\\lambda_2, \\lambda_3, \\lambda_4\\} = \\lambda_2(L)$.\nThe norm of the disagreement vector is bounded by:\n$$\n\\|\\delta(t)\\| \\le \\|\\delta(0)\\| \\exp(-\\lambda_2 t)\n$$\nFrom Part 2, we determined that $\\lambda_2(L) = 2$. Therefore, the exponential convergence rate constant is $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While average consensus is a powerful tool, many practical applications require agents to converge to a specific reference value rather than their own average. This scenario, known as leader-follower consensus or pinning control, is explored here by 'grounding' one agent's state. This practice demonstrates how to derive the modified dynamics for the remaining agents and calculate their steady-state bias in the presence of disturbances, a crucial skill for designing robust, reference-tracking networks.",
            "id": "4209968",
            "problem": "Consider a networked multi-agent estimation task in a Cyber-Physical System (CPS), where each physical agent is paired with its Digital Twin (DT). The agents exchange scalar estimates over an undirected communication graph. In continuous time, the DT consensus layer obeys the interaction rule that each agent relaxes its estimate toward those of its neighbors proportionally to edge weights. Let the communication graph be a path of length $4$ with nodes labeled $1$ through $4$ and unit weights on each edge. The weighted adjacency matrix is defined by $w_{12} = w_{21} = 1$, $w_{23} = w_{32} = 1$, $w_{34} = w_{43} = 1$, and all other $w_{ij} = 0$. The graph Laplacian $L$ is constructed from the standard definition $L = D - W$, where $D$ is the diagonal degree matrix.\n\nDue to calibration requirements, the DT of node $1$ is hard-pinned to the zero reference, enforcing $x_{1}(t) = 0$ for all $t \\geq 0$. Each remaining DT is subject to a constant model-mismatch disturbance that enters additively at its state channel. Denote the state vector by $x(t) = \\begin{pmatrix} x_{1}(t)  x_{2}(t)  x_{3}(t)  x_{4}(t) \\end{pmatrix}^{\\top}$ and the disturbance by $d(t) = \\begin{pmatrix} d_{1}  d_{2}  d_{3}  d_{4} \\end{pmatrix}^{\\top}$, with $d_{1} = 0$ and $d_{R} = \\begin{pmatrix} d_{2}  d_{3}  d_{4} \\end{pmatrix}^{\\top}$ constant. The DT consensus dynamics are\n$$\n\\dot{x}(t) = -L\\,x(t) + d_{R}^{\\mathrm{ext}},\n$$\nwhere $d_{R}^{\\mathrm{ext}}$ equals $d$ on nodes $2$ through $4$ and equals $0$ on node $1$.\n\nStarting from the fundamental consensus law on weighted graphs and the definition of the graph Laplacian, perform the following:\n\n1. Derive the modified reduced-order dynamics for the non-grounded agents, $x_{R}(t) = \\begin{pmatrix} x_{2}(t)  x_{3}(t)  x_{4}(t) \\end{pmatrix}^{\\top}$, explicitly showing how the grounded condition $x_{1}(t) = 0$ alters the generator of the dynamics relative to the ungrounded Laplacian.\n\n2. For a constant disturbance vector $d_{R} = \\begin{pmatrix} 2  -3  1 \\end{pmatrix}^{\\top}$, compute the steady-state bias vector $x_{R}^{\\star}$ attained by the remaining agents. Express the final answer as the ordered row vector $\\left(x_{2}^{\\star}, x_{3}^{\\star}, x_{4}^{\\star}\\right)$.\n\nThe underlying graph Laplacian is\n$$\nL = \\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}.\n$$\n\nYour derivation must begin from the fundamental consensus interaction rule and the definition of the Laplacian on weighted graphs, and it must logically justify any invertibility or stability properties employed. The final numerical answer must be exact (no rounding) and must be provided as a single row vector without units.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **System**: A continuous-time consensus process for $4$ agents in a Cyber-Physical System.\n- **Graph Topology**: An undirected path graph with nodes labeled $1, 2, 3, 4$.\n- **Edge Weights**: $w_{12} = w_{21} = 1$, $w_{23} = w_{32} = 1$, $w_{34} = w_{43} = 1$. All other weights $w_{ij} = 0$.\n- **Graph Laplacian ($L$)**: $L = D - W$, where $D$ is the degree matrix and $W$ is the weighted adjacency matrix. The problem provides the matrix:\n$$\nL = \\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n- **State Vector**: $x(t) = \\begin{pmatrix} x_{1}(t)  x_{2}(t)  x_{3}(t)  x_{4}(t) \\end{pmatrix}^{\\top}$.\n- **Boundary Condition**: Node $1$ is a grounded or pinned node, with its state fixed at $x_{1}(t) = 0$ for all $t \\geq 0$.\n- **System Dynamics**: $\\dot{x}(t) = -L\\,x(t) + d_{R}^{\\mathrm{ext}}$, where $d_{R}^{\\mathrm{ext}} = \\begin{pmatrix} 0  d_2  d_3  d_4 \\end{pmatrix}^{\\top}$.\n- **Disturbance**: A constant disturbance vector is applied to the non-grounded agents, given by $d_{R} = \\begin{pmatrix} d_{2}  d_{3}  d_{4} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 2  -3  1 \\end{pmatrix}^{\\top}$.\n- **Objective 1**: Derive the reduced-order dynamics for the non-grounded agents, $x_{R}(t) = \\begin{pmatrix} x_{2}(t)  x_{3}(t)  x_{4}(t) \\end{pmatrix}^{\\top}$.\n- **Objective 2**: Compute the steady-state bias vector $x_{R}^{\\star} = \\begin{pmatrix} x_{2}^{\\star}  x_{3}^{\\star}  x_{4}^{\\star} \\end{pmatrix}^{\\top}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard linear consensus protocol on a graph, a fundamental topic in control theory and multi-agent systems. The use of a graph Laplacian, a grounded node, and additive constant disturbances is canonical. The provided Laplacian matrix is consistent with the described path graph and unit weights. The problem is well-posed, as a stable linear time-invariant system with a constant input will have a unique steady-state solution. All terms are mathematically precise, and no information is missing or contradictory. The problem is therefore deemed valid.\n\n### Step 3: Derivation and Solution\n\n**1. Derivation of Reduced-Order Dynamics**\n\nWe begin from the fundamental continuous-time consensus interaction rule for an agent $i$ on a weighted, undirected graph. The rate of change of agent $i$'s state, $\\dot{x}_i(t)$, is proportional to the sum of differences between its state and the states of its neighbors, weighted by the edge weights.\n$$\n\\dot{x}_i(t) = \\sum_{j \\in \\mathcal{N}_i} w_{ij} (x_j(t) - x_i(t))\n$$\nwhere $\\mathcal{N}_i$ is the set of neighbors of agent $i$. This can be rewritten by separating the terms:\n$$\n\\dot{x}_i(t) = \\sum_{j \\in \\mathcal{N}_i} w_{ij} x_j(t) - \\left( \\sum_{j \\in \\mathcal{N}_i} w_{ij} \\right) x_i(t)\n$$\nThe term $\\sum_{j \\in \\mathcal{N}_i} w_{ij}$ is the weighted degree of node $i$, denoted $D_{ii}$.\nExpressing this for all agents in vector form, we have:\n$$\n\\dot{x}(t) = W x(t) - D x(t) = -(D - W)x(t)\n$$\nwhere $W$ is the weighted adjacency matrix and $D$ is the diagonal degree matrix. By definition, $L = D - W$ is the graph Laplacian, so the dynamics of the unperturbed system are $\\dot{x}(t) = -L x(t)$.\n\nThe problem states that the system includes an additive disturbance, with dynamics given by:\n$$\n\\dot{x}(t) = -L x(t) + d_{R}^{\\mathrm{ext}}\n$$\nTo derive the dynamics for the non-grounded agents, we partition the state vector $x(t)$ and the Laplacian matrix $L$ according to the grounded node (node $1$) and the remaining agents (nodes $R = \\{2, 3, 4\\}$). Let $x_1(t)$ be the state of agent $1$ and $x_R(t) = \\begin{pmatrix} x_2(t)  x_3(t)  x_4(t) \\end{pmatrix}^{\\top}$ be the vector of remaining states.\n$$\nx(t) = \\begin{pmatrix} x_1(t) \\\\ x_R(t) \\end{pmatrix}\n$$\nThe Laplacian $L$ is partitioned conformably:\n$$\nL = \\begin{pmatrix} L_{11}  L_{1R} \\\\ L_{R1}  L_{RR} \\end{pmatrix}\n$$\nUsing the provided matrix for $L$, the submatrices are:\n$$\nL_{11} = 1, \\quad L_{1R} = \\begin{pmatrix} -1  0  0 \\end{pmatrix}\n$$\n$$\nL_{R1} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad L_{RR} = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}\n$$\nThe disturbance vector is $d_{R}^{\\mathrm{ext}} = \\begin{pmatrix} 0 \\\\ d_R \\end{pmatrix}$, where $d_R = \\begin{pmatrix} d_2  d_3  d_4 \\end{pmatrix}^{\\top}$.\n\nThe partitioned system of differential equations is:\n$$\n\\begin{pmatrix} \\dot{x}_1(t) \\\\ \\dot{x}_R(t) \\end{pmatrix} = -\\begin{pmatrix} L_{11}  L_{1R} \\\\ L_{R1}  L_{RR} \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_R(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ d_R \\end{pmatrix}\n$$\nThis yields two coupled equations:\n$$\n\\dot{x}_1(t) = -L_{11} x_1(t) - L_{1R} x_R(t)\n$$\n$$\n\\dot{x}_R(t) = -L_{R1} x_1(t) - L_{RR} x_R(t) + d_R\n$$\nWe now apply the grounding condition, $x_1(t) = 0$ for all $t \\geq 0$. This implies $\\dot{x}_1(t) = 0$. Substituting $x_1(t)=0$ into the equation for $\\dot{x}_R(t)$:\n$$\n\\dot{x}_R(t) = -L_{R1} (0) - L_{RR} x_R(t) + d_R\n$$\n$$\n\\dot{x}_R(t) = -L_{RR} x_R(t) + d_R\n$$\nThis is the reduced-order dynamics for the non-grounded agents. The generator of the dynamics is the matrix $-L_{RR}$.  The matrix $L_{RR}$ is the principal submatrix of the full Laplacian $L$ corresponding to the non-grounded nodes. It is often referred to as the grounded Laplacian. The grounding of node $1$ effectively removes its dynamics from the system and turns its state into a constant input (in this case, $0$) for its neighbors, altering the overall system matrix from $L$ to $L_{RR}$.\n\n**2. Computation of the Steady-State Bias**\n\nThe steady state of the system is the equilibrium point $x_R^{\\star}$ where the states of the non-grounded agents no longer change, i.e., $\\dot{x}_R(t) = 0$. Setting the derivative in the reduced-order dynamics to zero:\n$$\n0 = -L_{RR} x_R^{\\star} + d_R\n$$\nThis gives the linear algebraic equation:\n$$\nL_{RR} x_R^{\\star} = d_R\n$$\nTo solve for $x_R^{\\star}$, we must demonstrate that $L_{RR}$ is invertible. The full Laplacian $L$ of a connected graph has a simple eigenvalue at $0$ and all other eigenvalues are positive. A key property of graph Laplacians is that for any connected graph, any principal submatrix formed by removing one or more rows and corresponding columns (as $L_{RR}$ is) is positive definite. A positive definite matrix has all positive eigenvalues and is therefore non-singular (invertible). Since $L_{RR}$ is invertible, a unique steady-state solution $x_R^{\\star}$ exists and is given by $x_R^{\\star} = L_{RR}^{-1} d_R$. Furthermore, because $L_{RR}$ is positive definite, all eigenvalues of $-L_{RR}$ have negative real parts, which means the reduced-order system is stable and will converge to this unique steady state from any initial condition.\n\nWe now solve the system $L_{RR} x_R^{\\star} = d_R$ with the given values:\n$$\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{pmatrix}\n\\begin{pmatrix}\nx_2^{\\star} \\\\\nx_3^{\\star} \\\\\nx_4^{\\star}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 \\\\\n-3 \\\\\n1\n\\end{pmatrix}\n$$\nThis corresponds to the following system of linear equations:\n1. $2x_2^{\\star} - x_3^{\\star} = 2$\n2. $-x_2^{\\star} + 2x_3^{\\star} - x_4^{\\star} = -3$\n3. $-x_3^{\\star} + x_4^{\\star} = 1$\n\nFrom equation (3), we can express $x_4^{\\star}$ in terms of $x_3^{\\star}$:\n$$\nx_4^{\\star} = 1 + x_3^{\\star}\n$$\nSubstitute this into equation (2):\n$$\n-x_2^{\\star} + 2x_3^{\\star} - (1 + x_3^{\\star}) = -3\n$$\n$$\n-x_2^{\\star} + x_3^{\\star} - 1 = -3\n$$\n$$\n-x_2^{\\star} + x_3^{\\star} = -2\n$$\nWe now have a $2 \\times 2$ system for $x_2^{\\star}$ and $x_3^{\\star}$:\n1. $2x_2^{\\star} - x_3^{\\star} = 2$\n4. $-x_2^{\\star} + x_3^{\\star} = -2$\n\nAdding equation (1) and equation (4):\n$$\n(2x_2^{\\star} - x_3^{\\star}) + (-x_2^{\\star} + x_3^{\\star}) = 2 + (-2)\n$$\n$$\nx_2^{\\star} = 0\n$$\nSubstitute $x_2^{\\star} = 0$ into equation (4):\n$$\n-(0) + x_3^{\\star} = -2 \\implies x_3^{\\star} = -2\n$$\nFinally, substitute $x_3^{\\star} = -2$ into the expression for $x_4^{\\star}$:\n$$\nx_4^{\\star} = 1 + x_3^{\\star} = 1 + (-2) = -1\n$$\nThe steady-state bias vector for the non-grounded agents is $x_R^{\\star} = \\begin{pmatrix} 0  -2  -1 \\end{pmatrix}^{\\top}$. The problem requests the answer as an ordered row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -2  -1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from analysis to design, a key engineering task is to allocate resources optimally to achieve the best possible system performance. This problem frames the design of a consensus network as a constrained optimization problem, a common challenge in engineering complex systems. You will determine how to distribute a limited 'coupling budget' across the network's edges to maximize the convergence rate, providing direct insight into how network structure can be actively engineered for speed.",
            "id": "4209945",
            "problem": "A Digital Twin (DT) of a networked Cyber-Physical System (CPS) is used to design coordination parameters for a group of $3$ agents whose scalar states $x_{i}(t)$ represent synchronized reference signals. The DT implements continuous-time linear consensus on an undirected interaction graph with node set $\\{1,2,3\\}$ and edges $\\{(1,2),(2,3)\\}$. The physical coupling between agents is modeled by nonnegative edge weights $a_{12} \\ge 0$ and $a_{23} \\ge 0$. Let $x(t) = [x_{1}(t), x_{2}(t), x_{3}(t)]^{\\top}$ denote the stacked state, and let the consensus dynamics be $ \\dot{x}(t) = -L(a) x(t)$, where $L(a)$ is the weighted graph Laplacian: for $i \\neq j$, $L_{ij}(a) = -a_{ij}$ when $(i,j)$ is an edge and $L_{ij}(a) = 0$ otherwise, and $L_{ii}(a) = \\sum_{j \\neq i} a_{ij}$.\n\nThe DT designer is given a total coupling budget $\\gamma  0$ and must choose $a_{12}$ and $a_{23}$ subject to $a_{12} \\ge 0$, $a_{23} \\ge 0$, and $a_{12} + a_{23} \\le \\gamma$.\n\nStarting only from the definitions above and standard spectral properties of real symmetric matrices, carry out the following:\n\n1. Define the deviation from consensus $y(t) = x(t) - \\bar{x}(t) \\mathbf{1}$, where $\\bar{x}(t) = \\frac{1}{3} \\mathbf{1}^{\\top} x(t)$ and $\\mathbf{1}$ is the vector of all ones. Using a quadratic Lyapunov function $V(t) = \\frac{1}{2} \\|y(t)\\|_{2}^{2}$, derive a bound on $\\dot{V}(t)$ in terms of the spectrum of $L(a)$ and argue from first principles why maximizing an appropriate spectral quantity of $L(a)$ subject to the budget constraint is a valid objective for accelerating convergence of $y(t)$ to $\\mathbf{0}$.\n\n2. For the given $3$-node line graph, write $L(a)$ in terms of $a_{12}$ and $a_{23}$, and determine the two positive eigenvalues of $L(a)$ explicitly as functions of $a_{12}$ and $a_{23}$.\n\n3. Formulate the resulting optimization problem induced by the budget constraint $a_{12} + a_{23} \\le \\gamma$, and solve it exactly for the maximum achievable worst-case exponential convergence rate of $y(t)$.\n\nReturn your final result as a single closed-form analytic expression in terms of $\\gamma$ for the maximum achievable convergence rate. Do not include any units. No rounding is required; provide the exact expression.",
            "solution": "The problem requires a three-part analysis of a continuous-time consensus algorithm on a $3$-agent system. We must first validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Number of agents: $N=3$.\n- Agent states: $x_{i}(t)$, scalar signals.\n- Interaction graph: Undirected, node set $\\{1,2,3\\}$, edge set $\\{(1,2),(2,3)\\}$.\n- Edge weights: $a_{12} \\ge 0$, $a_{23} \\ge 0$.\n- State vector: $x(t) = [x_{1}(t), x_{2}(t), x_{3}(t)]^{\\top}$.\n- Dynamics: $ \\dot{x}(t) = -L(a) x(t)$.\n- Graph Laplacian $L(a)$: For $i \\neq j$, $L_{ij}(a) = -a_{ij}$ if $(i,j)$ is an edge, $L_{ij}(a) = 0$ otherwise. $L_{ii}(a) = \\sum_{j \\neq i} a_{ij}$.\n- Budget constraint: $\\gamma  0$, $a_{12} \\ge 0$, $a_{23} \\ge 0$, and $a_{12} + a_{23} \\le \\gamma$.\n- Deviation from consensus: $y(t) = x(t) - \\bar{x}(t) \\mathbf{1}$, where $\\bar{x}(t) = \\frac{1}{3} \\mathbf{1}^{\\top} x(t)$ and $\\mathbf{1}$ is the vector of all ones.\n- Lyapunov function: $V(t) = \\frac{1}{2} \\|y(t)\\|_{2}^{2}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard problem in the field of multi-agent systems and control theory. The use of a graph Laplacian to model consensus dynamics is canonical. The analysis via a quadratic Lyapunov function is a fundamental technique in stability theory. The objective of maximizing the convergence rate, identified with the second smallest eigenvalue (algebraic connectivity) of the Laplacian, is a well-established design principle for such systems. The constraints are clearly defined, and the problem is mathematically self-contained. There are no contradictions, ambiguities, or violations of scientific principles.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. We proceed to the solution.\n\n---\n\n### Solution\n\nThe solution is presented in three parts as requested by the problem statement.\n\n**Part 1: Lyapunov Analysis and Convergence Rate Justification**\n\nThe deviation from consensus is defined as $y(t) = x(t) - \\bar{x}(t) \\mathbf{1}$, where $\\bar{x}(t) = \\frac{1}{3} \\mathbf{1}^{\\top} x(t)$ is the instantaneous average of the agent states and $\\mathbf{1} = [1, 1, 1]^{\\top}$. First, we analyze the time evolution of the average state $\\bar{x}(t)$.\n$$\n\\dot{\\bar{x}}(t) = \\frac{d}{dt} \\left( \\frac{1}{3} \\mathbf{1}^{\\top} x(t) \\right) = \\frac{1}{3} \\mathbf{1}^{\\top} \\dot{x}(t) = -\\frac{1}{3} \\mathbf{1}^{\\top} L(a) x(t)\n$$\nThe graph Laplacian $L(a)$ for an undirected graph is a real symmetric matrix. A fundamental property of the graph Laplacian is that the sum of the entries in each row is zero. This can be expressed as $L(a) \\mathbf{1} = \\mathbf{0}$. Since $L(a)$ is symmetric, $L(a)^{\\top} = L(a)$, which implies that the sum of the entries in each column is also zero, i.e., $\\mathbf{1}^{\\top} L(a) = \\mathbf{0}^{\\top}$. Substituting this into the equation for $\\dot{\\bar{x}}(t)$ yields:\n$$\n\\dot{\\bar{x}}(t) = -\\frac{1}{3} \\mathbf{0}^{\\top} x(t) = 0\n$$\nThis shows that the average state is conserved, i.e., $\\bar{x}(t) = \\bar{x}(0)$ for all $t \\ge 0$.\n\nNext, we find the dynamics of the deviation vector $y(t)$.\n$$\n\\dot{y}(t) = \\frac{d}{dt} \\left( x(t) - \\bar{x}(0) \\mathbf{1} \\right) = \\dot{x}(t) = -L(a) x(t)\n$$\nWe express the right-hand side in terms of $y(t)$:\n$$\n\\dot{y}(t) = -L(a) (y(t) + \\bar{x}(0) \\mathbf{1}) = -L(a)y(t) - \\bar{x}(0)L(a)\\mathbf{1}\n$$\nSince $L(a)\\mathbf{1} = \\mathbf{0}$, the second term vanishes, and we obtain the dynamics for the deviation from consensus:\n$$\n\\dot{y}(t) = -L(a) y(t)\n$$\nBy construction, the deviation vector $y(t)$ is orthogonal to the vector $\\mathbf{1}$, since $\\mathbf{1}^{\\top} y(t) = \\mathbf{1}^{\\top}(x(t) - \\bar{x}(t)\\mathbf{1}) = \\mathbf{1}^{\\top}x(t) - \\bar{x}(t)\\mathbf{1}^{\\top}\\mathbf{1} = 3\\bar{x}(t) - 3\\bar{x}(t) = 0$.\n\nNow, consider the Lyapunov function $V(t) = \\frac{1}{2} \\|y(t)\\|_{2}^{2} = \\frac{1}{2} y(t)^{\\top} y(t)$. Its time derivative is:\n$$\n\\dot{V}(t) = y(t)^{\\top} \\dot{y}(t) = y(t)^{\\top}(-L(a)y(t)) = -y(t)^{\\top}L(a)y(t)\n$$\nThe graph Laplacian $L(a)$ is a positive semi-definite matrix. Its eigenvalues are real and non-negative, and are ordered as $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_3$. For a connected graph on $3$ nodes, $\\lambda_2  0$. The eigenvalue $\\lambda_1 = 0$ has the corresponding eigenvector $\\mathbf{1}$. The term $-y(t)^{\\top}L(a)y(t)$ is a Rayleigh quotient. By the Courant-Fischer min-max theorem, the second smallest eigenvalue $\\lambda_2$ (the algebraic connectivity) satisfies:\n$$\n\\lambda_2(L(a)) = \\min_{z \\neq \\mathbf{0}, \\, z^{\\top}\\mathbf{1}=0} \\frac{z^{\\top}L(a)z}{z^{\\top}z}\n$$\nSince $y(t)$ is always orthogonal to $\\mathbf{1}$ (for $t  0$ if $y(0) \\ne \\mathbf{0}$), we can bound the quadratic form:\n$$\ny(t)^{\\top}L(a)y(t) \\ge \\lambda_2(L(a)) \\|y(t)\\|_{2}^{2}\n$$\nSubstituting this into the expression for $\\dot{V}(t)$:\n$$\n\\dot{V}(t) \\le -\\lambda_2(L(a)) \\|y(t)\\|_{2}^{2} = -2\\lambda_2(L(a)) V(t)\n$$\nBy Gr√∂nwall's inequality, this differential inequality implies exponential convergence of $V(t)$ to $0$:\n$$\nV(t) \\le V(0) \\exp(-2\\lambda_2(L(a)) t)\n$$\nIn terms of the norm of the deviation vector, this means $\\|y(t)\\|_{2} \\le \\|y(0)\\|_{2} \\exp(-\\lambda_2(L(a)) t)$. The rate of convergence of $y(t)$ to $\\mathbf{0}$ is thus determined by the eigenvalues of $L(a)$. The slowest decaying mode of $y(t)$ corresponds to the smallest non-zero eigenvalue, $\\lambda_2(L(a))$. Therefore, to maximize the worst-case (i.e., guaranteed) exponential convergence rate, one must maximize $\\lambda_2(L(a))$. This establishes the optimization objective.\n\n**Part 2: Laplacian Matrix and its Eigenvalues**\n\nThe interaction graph is the path graph $1-2-3$ with edge weights $a_{12}$ and $a_{23}$. The Laplacian matrix $L(a)$ is constructed according to its definition:\n- Diagonal entries: $L_{11} = a_{12}$, $L_{22} = a_{12} + a_{23}$, $L_{33} = a_{23}$.\n- Off-diagonal entries: $L_{12}=L_{21}=-a_{12}$, $L_{23}=L_{32}=-a_{23}$, $L_{13}=L_{31}=0$.\nSo, the matrix is:\n$$\nL(a) = \\begin{pmatrix} a_{12}  -a_{12}  0 \\\\ -a_{12}  a_{12}+a_{23}  -a_{23} \\\\ 0  -a_{23}  a_{23} \\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(L(a) - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} a_{12}-\\lambda  -a_{12}  0 \\\\ -a_{12}  a_{12}+a_{23}-\\lambda  -a_{23} \\\\ 0  -a_{23}  a_{23}-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant along the first row:\n$$\n(a_{12}-\\lambda) \\left[ (a_{12}+a_{23}-\\lambda)(a_{23}-\\lambda) - a_{23}^2 \\right] - (-a_{12}) \\left[ (-a_{12})(a_{23}-\\lambda) \\right] = 0\n$$\n$$\n(a_{12}-\\lambda) \\left[ (a_{12}+a_{23})a_{23} - (a_{12}+a_{23})\\lambda - a_{23}\\lambda + \\lambda^2 - a_{23}^2 \\right] - a_{12}^2(a_{23}-\\lambda) = 0\n$$\n$$\n(a_{12}-\\lambda) \\left[ a_{12}a_{23} - (a_{12}+2a_{23})\\lambda + \\lambda^2 \\right] - a_{12}^2a_{23} + a_{12}^2\\lambda = 0\n$$\n$a_{12}^2a_{23} - a_{12}(a_{12}+2a_{23})\\lambda + a_{12}\\lambda^2 - a_{12}a_{23}\\lambda + (a_{12}+2a_{23})\\lambda^2 - \\lambda^3 - a_{12}^2a_{23} + a_{12}^2\\lambda = 0$\nGrouping terms by powers of $\\lambda$:\n$$\n-\\lambda^3 + (a_{12} + a_{12}+2a_{23})\\lambda^2 + (-a_{12}^2 - 2a_{12}a_{23} - a_{12}a_{23} + a_{12}^2)\\lambda = 0\n$$\n$$\n-\\lambda^3 + (2a_{12}+2a_{23})\\lambda^2 - 3a_{12}a_{23}\\lambda = 0\n$$\n$$\n\\lambda \\left( -\\lambda^2 + (2a_{12}+2a_{23})\\lambda - 3a_{12}a_{23} \\right) = 0\n$$\nOne eigenvalue is $\\lambda_1 = 0$, as expected. The other two are the roots of the quadratic equation $\\lambda^2 - (2a_{12}+2a_{23})\\lambda + 3a_{12}a_{23} = 0$. Using the quadratic formula:\n$$\n\\lambda = \\frac{2(a_{12}+a_{23}) \\pm \\sqrt{4(a_{12}+a_{23})^2 - 4(3a_{12}a_{23})}}{2}\n$$\n$$\n\\lambda = (a_{12}+a_{23}) \\pm \\sqrt{(a_{12}+a_{23})^2 - 3a_{12}a_{23}}\n$$\n$$\n\\lambda = (a_{12}+a_{23}) \\pm \\sqrt{a_{12}^2 + 2a_{12}a_{23} + a_{23}^2 - 3a_{12}a_{23}}\n$$\n$$\n\\lambda = (a_{12}+a_{23}) \\pm \\sqrt{a_{12}^2 - a_{12}a_{23} + a_{23}^2}\n$$\nThe discriminant $a_{12}^2 - a_{12}a_{23} + a_{23}^2 = (a_{12} - a_{23}/2)^2 + \\frac{3}{4}a_{23}^2 \\ge 0$, so the eigenvalues are real. Since the graph is connected (assuming $a_{12}, a_{23}  0$), the other two eigenvalues are positive. The two positive eigenvalues are:\n$$\n\\lambda_2 = (a_{12}+a_{23}) - \\sqrt{a_{12}^2 - a_{12}a_{23} + a_{23}^2}\n$$\n$$\n\\lambda_3 = (a_{12}+a_{23}) + \\sqrt{a_{12}^2 - a_{12}a_{23} + a_{23}^2}\n$$\n\n**Part 3: Optimization Problem and Solution**\n\nThe objective is to maximize the worst-case exponential convergence rate, which is $\\lambda_2(L(a))$, subject to the given constraints. The optimization problem is:\n$$\n\\max_{a_{12}, a_{23}} \\quad (a_{12}+a_{23}) - \\sqrt{a_{12}^2 - a_{12}a_{23} + a_{23}^2}\n$$\n$$\n\\text{subject to} \\quad a_{12} \\ge 0, \\quad a_{23} \\ge 0, \\quad a_{12} + a_{23} \\le \\gamma\n$$\nLet $f(a_{12}, a_{23}) = (a_{12}+a_{23}) - \\sqrt{a_{12}^2 - a_{12}a_{23} + a_{23}^2}$. This function is homogeneous of degree $1$. For any $k  0$, $f(k a_{12}, k a_{23}) = k f(a_{12}, a_{23})$. The objective function is non-negative, so its maximum over the feasible region (a triangle with vertices $(0,0)$, $(\\gamma,0)$, $(0,\\gamma)$) must lie on the boundary furthest from the origin, i.e., on the line segment $a_{12} + a_{23} = \\gamma$.\n\nLet's analyze the problem on this boundary. Let $a_{12} = a$ and $a_{23} = b$. We have $a+b=\\gamma$, with $a,b \\ge 0$. Substituting $b = \\gamma - a$ into the objective function for $a \\in [0, \\gamma]$:\n$$\ng(a) = (a+(\\gamma-a)) - \\sqrt{a^2 - a(\\gamma-a) + (\\gamma-a)^2} = \\gamma - \\sqrt{a^2 - a\\gamma + a^2 + \\gamma^2 - 2a\\gamma + a^2}\n$$\n$$\ng(a) = \\gamma - \\sqrt{3a^2 - 3a\\gamma + \\gamma^2}\n$$\nTo maximize $g(a)$, we must minimize the term inside the square root, $h(a) = 3a^2 - 3a\\gamma + \\gamma^2$. This is a quadratic in $a$ opening upwards. Its minimum occurs at the vertex:\n$$\n\\frac{d h(a)}{da} = 6a - 3\\gamma = 0 \\implies a = \\frac{\\gamma}{2}\n$$\nThis value of $a$ lies within the interval $[0, \\gamma]$. The corresponding value for $b$ is $b = \\gamma - a = \\gamma - \\frac{\\gamma}{2} = \\frac{\\gamma}{2}$.\nThus, the maximum of $\\lambda_2$ is achieved when $a_{12} = a_{23} = \\frac{\\gamma}{2}$.\n\nThe maximum value is found by substituting these values back into the expression for $\\lambda_2$:\n$$\n\\lambda_{2, \\max} = \\left(\\frac{\\gamma}{2} + \\frac{\\gamma}{2}\\right) - \\sqrt{\\left(\\frac{\\gamma}{2}\\right)^2 - \\left(\\frac{\\gamma}{2}\\right)\\left(\\frac{\\gamma}{2}\\right) + \\left(\\frac{\\gamma}{2}\\right)^2}\n$$\n$$\n\\lambda_{2, \\max} = \\gamma - \\sqrt{\\frac{\\gamma^2}{4} - \\frac{\\gamma^2}{4} + \\frac{\\gamma^2}{4}} = \\gamma - \\sqrt{\\frac{\\gamma^2}{4}} = \\gamma - \\frac{\\gamma}{2} = \\frac{\\gamma}{2}\n$$\nThe maximum achievable worst-case exponential convergence rate of $y(t)$ is $\\frac{\\gamma}{2}$.",
            "answer": "$$\\boxed{\\frac{\\gamma}{2}}$$"
        }
    ]
}