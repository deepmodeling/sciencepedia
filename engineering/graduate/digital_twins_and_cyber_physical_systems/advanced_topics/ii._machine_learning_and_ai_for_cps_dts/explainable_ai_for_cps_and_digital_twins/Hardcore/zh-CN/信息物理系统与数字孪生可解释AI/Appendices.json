{
    "hands_on_practices": [
        {
            "introduction": "SHAP (SHapley Additive exPlanations) 是现代可解释人工智能的基石之一，它借鉴了合作博弈论的思想来公平地分配模型预测的贡献。在应用任何复杂工具之前，理解其数学基础至关重要。本练习将引导您推导一个简单线性模型的 SHAP 值，这个过程不仅能帮助您揭开 SHAP 复杂公式的神秘面纱，还能揭示其一个重要特性：对于具有独立特征的线性模型，SHAP 值会简化为特征的直接贡献项。",
            "id": "4220831",
            "problem": "信息物理系统 (CPS) 的数字孪生 (DT) 使用线性代理模型，根据标准化传感器特征向量预测标量性能指标。设特征表示为 $X = (X_{1},\\dots,X_{d})$，模型为 $f(x) = w^{\\top}x = \\sum_{j=1}^{d} w_{j} x_{j}$，无截距项。DT 用于 $X$ 的背景数据分布（在可解释性人工智能中用于定义缺失特征的语义）具有各分量相互独立且标准化的特性，即对所有 $j \\in \\{1,\\dots,d\\}$ 都有 $\\mathbb{E}[X_{j}] = 0$ 且 $X_{1},\\dots,X_{d}$ 相互独立。解释方法遵循 SHapley 加性解释 (SHAP) 框架：对于任意子集 $S \\subseteq \\{1,\\dots,d\\}$，将联盟值定义为 $v(S) = \\mathbb{E}\\!\\left[ f(X) \\mid X_{S} = x_{S} \\right]$，并将索引 $i$ 的特征归因定义为此博弈中的 Shapley 值，即\n$$\n\\phi_{i} \\;=\\; \\sum_{S \\subseteq N \\setminus \\{i\\}} \\frac{|S|!\\,(d-|S|-1)!}{d!} \\left( v(S \\cup \\{i\\}) - v(S) \\right),\n$$\n其中 $N = \\{1,\\dots,d\\}$。\n\n从这些定义和 $X$ 的给定统计特性出发，推导 $\\phi_{i}$ 关于 $w_{i}$ 和查询点坐标 $x_{i}$ 的闭式解析表达式。最终答案必须是单一表达式。除上述性质外，不要假设任何其他性质。最终答案不带单位。无需四舍五入。",
            "solution": "这个问题是有效的。这是一个基于可解释性人工智能 (XAI) 和统计学既定原则的适定数学推导。所有给定条件都是一致的，目标也已明确定义。我们现在开始推导。\n\n目标是为线性模型 $f(x) = \\sum_{j=1}^{d} w_{j} x_{j}$ 推导 Shapley 特征归因 $\\phi_i$ 的闭式表达式，其中特征向量 $X = (X_{1},\\dots,X_{d})$ 由均值为零的相互独立的随机变量组成，即对所有 $j \\in \\{1,\\dots,d\\}$ 都有 $\\mathbb{E}[X_{j}] = 0$。\n\n归因 $\\phi_i$ 由 Shapley 值公式定义：\n$$\n\\phi_{i} \\;=\\; \\sum_{S \\subseteq N \\setminus \\{i\\}} \\frac{|S|!\\,(d-|S|-1)!}{d!} \\left( v(S \\cup \\{i\\}) - v(S) \\right)\n$$\n其中 $N = \\{1,\\dots,d\\}$，联盟值函数 $v(S)$ 由模型输出的条件期望给出：\n$$\nv(S) = \\mathbb{E}\\!\\left[ f(X) \\mid X_{S} = x_{S} \\right]\n$$\n这里，$X_S = x_S$ 表示索引在集合 $S$ 中的特征取自查询点 $x$ 的特定值。\n\n我们的第一步是推导联盟值函数 $v(S)$ 的简化表达式。我们将线性模型 $f(X)$ 的定义代入 $v(S)$ 的表达式中：\n$$\nv(S) = \\mathbb{E}\\!\\left[ \\sum_{j=1}^{d} w_{j} X_{j} \\mid X_{S} = x_{S} \\right]\n$$\n根据期望算子的线性性质，我们可以将求和移到期望之外：\n$$\nv(S) = \\sum_{j=1}^{d} w_{j} \\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right]\n$$\n现在，我们必须为每个特征 $X_j$ 计算条件期望 $\\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right]$。我们根据索引 $j$ 是否在集合 $S$ 中来考虑两种情况。\n\n情况 1：$j \\in S$。\n如果索引 $j$ 在集合 $S$ 中，随机变量 $X_j$ 的值由条件 $X_S = x_S$ 固定。具体来说，$X_j$ 固定为值 $x_j$。常数的期望就是其本身，所以：\n$$\n\\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right] = x_{j} \\quad \\text{for } j \\in S\n$$\n\n情况 2：$j \\notin S$。\n如果索引 $j$ 不在集合 $S$ 中，我们必须考虑特征的统计特性。题目指出特征 $X_1, \\dots, X_d$ 是相互独立的。这意味着知道集合 $S$ 中特征的值（$X_S$）并不能提供任何关于 $j \\notin S$ 的特征 $X_j$ 值的信息。因此，条件期望等于无条件期望：\n$$\n\\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right] = \\mathbb{E}[X_{j}] \\quad \\text{for } j \\notin S\n$$\n题目还指出特征是标准化的，使得对所有 $j$ 都有 $\\mathbb{E}[X_j] = 0$。因此：\n$$\n\\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right] = 0 \\quad \\text{for } j \\notin S\n$$\n\n结合这两种情况，我们可以通过将求和拆分为对 $S$ 中索引和不在 $S$ 中索引的求和来写出 $v(S)$ 的表达式：\n$$\nv(S) = \\sum_{j \\in S} w_{j} \\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right] + \\sum_{j \\notin S} w_{j} \\mathbb{E}\\!\\left[ X_{j} \\mid X_{S} = x_{S} \\right]\n$$\n$$\nv(S) = \\sum_{j \\in S} w_{j} x_{j} + \\sum_{j \\notin S} w_{j} (0) = \\sum_{j \\in S} w_{j} x_{j}\n$$\n这为联盟值函数提供了一个简单的闭式表达式。\n\n下一步是计算特征 $i$ 的边际贡献，即 Shapley 公式中的项 $v(S \\cup \\{i\\}) - v(S)$。求和遍及 $N \\setminus \\{i\\}$ 的所有子集 $S$，这意味着 $i \\notin S$。\n使用我们关于 $v(\\cdot)$ 的表达式：\n$$\nv(S \\cup \\{i\\}) = \\sum_{j \\in S \\cup \\{i\\}} w_{j} x_{j} = w_i x_i + \\sum_{j \\in S} w_{j} x_{j}\n$$\n并且，如前所述：\n$$\nv(S) = \\sum_{j \\in S} w_{j} x_{j}\n$$\n因此，差值为：\n$$\nv(S \\cup \\{i\\}) - v(S) = \\left(w_i x_i + \\sum_{j \\in S} w_{j} x_{j}\\right) - \\left(\\sum_{j \\in S} w_{j} x_{j}\\right) = w_i x_i\n$$\n值得注意的是，对于任何联盟 $S \\subseteq N \\setminus \\{i\\}$，特征 $i$ 的边际贡献都是一个常数，等于 $w_i x_i$。\n\n现在我们将此结果代回 $\\phi_i$ 的 Shapley 值公式中：\n$$\n\\phi_{i} = \\sum_{S \\subseteq N \\setminus \\{i\\}} \\frac{|S|!\\,(d-|S|-1)!}{d!} (w_i x_i)\n$$\n由于项 $w_i x_i$ 与求和变量 $S$ 无关，我们可以将其提出：\n$$\n\\phi_{i} = (w_i x_i) \\left( \\sum_{S \\subseteq N \\setminus \\{i\\}} \\frac{|S|!\\,(d-|S|-1)!}{d!} \\right)\n$$\n最后一步是计算 Shapley 权重的总和。我们将此和表示为 $\\Sigma$：\n$$\n\\Sigma = \\sum_{S \\subseteq N \\setminus \\{i\\}} \\frac{|S|!\\,(d-|S|-1)!}{d!}\n$$\n求和是对 $N \\setminus \\{i\\}$（一个包含 $d-1$ 个元素的集合）的所有子集进行的。我们可以按子集 $S$ 的基数 $k = |S|$ 进行分组，其范围从 $k=0$ 到 $k=d-1$。对于任意给定的规模 $k$，满足 $|S|=k$ 的子集 $S \\subseteq N \\setminus \\{i\\}$ 的数量由二项式系数 $\\binom{d-1}{k}$ 给出。由于所有这些子集具有相同的基数，权重项 $\\frac{k!\\,(d-k-1)!}{d!}$ 对它们来说都是相同的。\n我们可以将和重写为：\n$$\n\\Sigma = \\sum_{k=0}^{d-1} \\binom{d-1}{k} \\frac{k!\\,(d-k-1)!}{d!}\n$$\n代入 $\\binom{d-1}{k} = \\frac{(d-1)!}{k!\\,(d-1-k)!}$ 的组合公式：\n$$\n\\Sigma = \\sum_{k=0}^{d-1} \\frac{(d-1)!}{k!\\,(d-1-k)!} \\cdot \\frac{k!\\,(d-k-1)!}{d!}\n$$\n我们可以消去 $k!$ 和 $(d-k-1)!$ 项：\n$$\n\\Sigma = \\sum_{k=0}^{d-1} \\frac{(d-1)!}{d!}\n$$\n由于 $d! = d \\cdot (d-1)!$，这可以简化为：\n$$\n\\Sigma = \\sum_{k=0}^{d-1} \\frac{1}{d}\n$$\n求和从 $k=0$ 到 $k=d-1$，共包含 $d$ 个相同的项。因此，和为：\n$$\n\\Sigma = d \\cdot \\frac{1}{d} = 1\n$$\nShapley 权重的总和为 1，这是 Shapley 值的一个已知属性。\n\n最后，我们将此结果代回我们的 $\\phi_i$ 表达式中：\n$$\n\\phi_{i} = (w_i x_i) \\cdot \\Sigma = (w_i x_i) \\cdot 1 = w_i x_i\n$$\n因此，对于具有独立、零均值特征的线性模型，特征 $i$ 的 SHAP 值（特征归因）就是其项贡献 $w_i x_i$。",
            "answer": "$$\\boxed{w_i x_i}$$"
        },
        {
            "introduction": "在处理复杂的“黑盒”模型时，一个常见的可解释性策略是使用一个更简单的、可解释的“代理模型”来近似其行为。本练习是一个编码实践，您将构建一个稀疏线性模型作为代理，并评估其性能。通过这个过程，您将亲身体验模型简单性（由稀疏性惩罚控制）与模型对原始黑盒的忠实度（使用保真度和完整性等指标衡量）之间的权衡。",
            "id": "4220836",
            "problem": "一个信息物理系统 (CPS) 由其数字孪生进行监控，该数字孪生将传感器状态聚合成特征向量，并计算一个黑盒异常分数。为了获得可解释性人工智能 (XAI) 意义上的透明解释，我们拟合一个稀疏线性代理模型来近似该黑盒异常检测器。考虑一个数据集，包含特征向量 $x_i \\in \\mathbb{R}^d$（其中 $i \\in \\{1,\\dots,n\\}$）和一个黑盒异常分数函数 $f:\\mathbb{R}^d \\to \\mathbb{R}$。代理模型为 $g(x)=w^{\\top}x$，其中 $w \\in \\mathbb{R}^d$，我们通过带有 $\\ell_0$ 稀疏性惩罚的经验风险最小化来训练 $w$。使用中心化目标 $y_i = f(x_i)-\\bar{f}$，其中 $\\bar{f} = \\frac{1}{n}\\sum_{i=1}^{n}f(x_i)$，以适应零截距的代理模型 $g(x)=w^{\\top}x$。\n\n基本基础：\n- 均方误差 (MSE) 下的经验风险定义为\n$$\n\\ell(w;X,y) = \\frac{1}{n}\\sum_{i=1}^{n}\\left(w^{\\top}x_i - y_i\\right)^2,\n$$\n其中 $X \\in \\mathbb{R}^{n\\times d}$ 是以 $x_i$ 为行的设计矩阵，$y \\in \\mathbb{R}^n$ 是以 $y_i$ 为条目的中心化目标向量。\n- $\\ell_0$ “范数”计算非零系数的数量：$$\\|w\\|_0 = |\\{j \\in \\{1,\\dots,d\\}: w_j \\neq 0\\}|.$$\n- 带惩罚的目标函数为\n$$\nJ_{\\lambda}(w) = \\ell(w;X,y) + \\lambda \\|w\\|_0,\n$$\n其中 $\\lambda \\ge 0$ 用于调节稀疏性。\n- 保真度通过决定系数来量化：\n$$\nF = 1 - \\frac{\\ell(w;X,y)}{\\mathrm{Var}(y)}, \\quad \\mathrm{Var}(y) = \\frac{1}{n}\\sum_{i=1}^{n}(y_i - \\bar{y})^2, \\quad \\bar{y}=\\frac{1}{n}\\sum_{i=1}^{n} y_i,\n$$\n因此 $F \\in (-\\infty,1]$，越高的 $F$ 值表示代理模型对黑盒异常分数的近似效果越好。\n- 相对于最佳无约束线性代理模型（无稀疏性惩罚，所有特征可用），将完整性定义为\n$$\nC(\\lambda) = \n\\begin{cases}\n\\frac{F(\\lambda)}{F(0^{\\star})},  \\text{如果 } F(0^{\\star})0,\\\\\n0,  \\text{否则,}\n\\end{cases}\n$$\n其中 $F(0^{\\star})$ 是使用所有特征的最小二乘解的保真度（即无稀疏性约束下的最大保真度线性代理模型）。\n\n您的任务：\n1. 对于下面的每个测试用例，完全按照规定构造 $X$ 和 $f$，计算 $y_i=f(x_i)-\\bar{f}$，并对每个给定的 $\\lambda$ 求解\n$$\nw^{\\star}_{\\lambda} \\in \\arg\\min_{w \\in \\mathbb{R}^d} \\left\\{ \\ell(w;X,y) + \\lambda \\|w\\|_0 \\right\\}.\n$$\n为确保非凸 $\\ell_0$ 惩罚问题得到全局最优解，将 $w$ 的支撑集限制在特征子集 $S \\subseteq \\{1,\\dots,d\\}$ 上，并对每个 $S$ 求得其上的最小二乘最小化器；然后选择使 $J_{\\lambda}$ 最小化的子集 $S$。\n2. 对于每个选定的 $w^{\\star}_{\\lambda}$，在数据集上计算 $F(\\lambda)$ 和 $C(\\lambda)$。\n3. 将所有结果按“最终输出格式”中指定的确切顺序汇总到一个列表中。\n\n测试套件（所有随机抽样必须使用指定的种子）：\n- 测试用例 A（部分线性黑盒）：\n  - $n=80$， $d=5$，种子 $=1$。\n  - 从标准正态分布 $\\mathcal{N}(0,1)$ 中独立抽取 $X$ 的条目。\n  - 定义\n    $$\n    f(x) = 0.9\\,x_1 - 0.6\\,x_2 + 0.4\\,x_3 + 0.2\\,\\sin(x_4) + \\epsilon,\n    $$\n    其中 $\\epsilon \\sim \\mathcal{N}(0,0.05^2)$ 且独立于 $X$。\n  - 稀疏性惩罚：$\\lambda \\in [0.0, 0.01, 0.05, 0.2]$。\n- 测试用例 B（完全线性黑盒）：\n  - $n=60$， $d=6$，种子 $=2$。\n  - 从 $\\mathcal{N}(0,1)$ 中独立抽取 $X$ 的条目。\n  - 定义\n    $$\n    f(x) = 1.0\\,x_1 - 1.0\\,x_2 + 0.5\\,x_3.\n    $$\n    不添加噪声。\n  - 稀疏性惩罚：$\\lambda \\in [0.0, 0.5, 1.5]$。\n- 测试用例 C（非线性黑盒）：\n  - $n=100$， $d=5$，种子 $=3$。\n  - 从标准正态分布 $\\mathcal{N}(0,1)$ 中独立抽取 $X$ 的条目。\n  - 定义\n    $$\n    f(x) = \\tanh(1.2\\,x_1 + 1.0\\,x_2) + 0.3\\,\\cos(x_3\\,x_4) + 0.1\\,\\sin(x_5) + \\epsilon,\n    $$\n    其中 $\\epsilon \\sim \\mathcal{N}(0,0.02^2)$ 且独立于 $X$。\n  - 稀疏性惩罚：$\\lambda \\in [0.0, 0.1, 0.3]$。\n\n角度单位：任何三角函数均以弧度为单位。\n\n输出规范：\n- 对于每个测试用例，并按给定顺序对每个 $\\lambda$ 计算数据集上的 $(F(\\lambda),C(\\lambda))$，然后将所有值按以下确切顺序作为浮点数的单个列表输出：\n  - 对于测试用例 A：$F(0.0),C(0.0),F(0.01),C(0.01),F(0.05),C(0.05),F(0.2),C(0.2)$。\n  - 对于测试用例 B：$F(0.0),C(0.0),F(0.5),C(0.5),F(1.5),C(1.5)$。\n  - 对于测试用例 C：$F(0.0),C(0.0),F(0.1),C(0.1),F(0.3),C(0.3)$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,\\dots,r_{14}]$。不应打印任何其他文本。",
            "solution": "用户提供的问题是有效的。这是一个在应用于信息物理系统的可解释性人工智能（XAI）领域内，定义明确且具有科学依据的问题。问题陈述是完整的，为可复现的解决方案提供了所有必要的数据、定义和约束。计算任务虽然密集，但对于指定的维度是可行的。\n\n核心任务是找到一个稀疏线性代理模型 $g(x) = w^{\\top}x$，该模型能够近似一个黑盒异常分数函数 $f(x)$。权重向量 $w \\in \\mathbb{R}^d$ 通过最小化一个带惩罚的经验风险函数进行训练。目标函数 $J_{\\lambda}(w)$ 结合了均方误差（MSE）损失和 $\\ell_0$ 稀疏性惩罚：\n$$\nJ_{\\lambda}(w) = \\ell(w;X,y) + \\lambda \\|w\\|_0 = \\frac{1}{n}\\sum_{i=1}^{n}\\left(w^{\\top}x_i - y_i\\right)^2 + \\lambda |\\{j : w_j \\neq 0\\}|\n$$\n这里，$X \\in \\mathbb{R}^{n\\times d}$ 是设计矩阵，$y \\in \\mathbb{R}^n$ 是中心化目标值的向量，即 $y_i = f(x_i) - \\bar{f}$，其中 $\\bar{f} = \\frac{1}{n}\\sum_i f(x_i)$。参数 $\\lambda \\ge 0$ 控制着模型对数据的保真度与其稀疏性之间的权衡。\n\n$\\ell_0$ 惩罚使得目标函数 $J_{\\lambda}(w)$ 成为非凸函数，通常情况下，找到其全局最小值是一个 NP-难问题。然而，该问题指定了一种保证获得全局最优解的方法：对所有可能的特征子集进行穷举搜索。由于在所有测试用例中特征维度 $d$ 都很小（$d=5$ 或 $d=6$），这种组合搜索在计算上是可行的。需要考虑 $2^d$ 个可能的特征子集。\n\n对于每个给定的测试用例和每个 $\\lambda$ 值，求解方法如下：\n\n1.  **数据生成**：对于每个测试用例，我们首先生成数据。使用指定的随机种子，创建一个设计矩阵 $X \\in \\mathbb{R}^{n\\times d}$，其条目从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取。对 $X$ 的每一行 $x_i$ 计算黑盒函数 $f(x)$，以产生分数 $f(x_i)$。如果指定了噪声 $\\epsilon$，也将其生成并添加。最后，通过对分数进行中心化来计算目标向量 $y$：$y_i = f(x_i) - \\frac{1}{n}\\sum_{j=1}^{n}f(x_j)$。根据构造， $y$ 的均值为 $\\bar{y} = 0$。\n\n2.  **最佳子集选择**：为了找到最小化 $J_{\\lambda}(w)$ 的最优权重向量 $w^{\\star}_{\\lambda}$，我们遍历所有 $2^d$ 个可能的特征索引子集 $S \\subseteq \\{1, \\dots, d\\}$。\n    *   对于每个大小为 $k = |S|$ 的子集 $S$，我们解决一个标准的普通最小二乘 (OLS) 回归问题。我们寻找一个权重向量 $w_S$，其非零元素仅限于 $S$ 中的索引，且该向量能最小化 MSE。这等价于将 $y$ 对 $X$ 中对应于子集 $S$ 的列（表示为 $X_S$）进行回归。OLS 解为 $w_S^* = (X_S^{\\top}X_S)^{-1}X_S^{\\top}y$。\n    *   此子集的最小化 MSE 为 $\\ell_S = \\frac{1}{n}\\|X_S w_S^* - y\\|_2^2$。\n    *   此子集的带惩罚目标值为 $J_{\\lambda, S} = \\ell_S + \\lambda k$。\n    *   我们比较所有 $2^d$ 个子集的 $J_{\\lambda, S}$ 值。产生最小值 $J_{\\lambda}^{\\star} = \\min_S J_{\\lambda, S}$ 的子集 $S^\\star$ 是给定 $\\lambda$ 的最优支撑集。相应的最小 MSE 是 $\\ell^{\\star}_{\\lambda}$。\n\n3.  **指标计算**：\n    *   **保真度 ($F(\\lambda)$)**：给定 $\\lambda$ 时，代理模型的保真度使用决定系数公式计算。它需要目标向量的方差，$\\mathrm{Var}(y) = \\frac{1}{n}\\sum_{i=1}^n (y_i - \\bar{y})^2 = \\frac{1}{n}\\sum_{i=1}^n y_i^2$（因为 $\\bar{y}=0$）。保真度则为：\n        $$\n        F(\\lambda) = 1 - \\frac{\\ell^{\\star}_{\\lambda}}{\\mathrm{Var}(y)}\n        $$\n    *   **完整性 ($C(\\lambda)$)**：首先，我们需要基线保真度 $F(0^{\\star})$，它对应于无稀疏性约束下的最佳线性模型。这可以通过使用所有 $d$ 个特征的 OLS 解（这也是 $\\lambda=0$ 时的解）来实现。设相应的 MSE 为 $\\ell_{OLS}$。那么 $F(0^{\\star}) = 1 - \\ell_{OLS} / \\mathrm{Var}(y)$。完整性则计算为该比率：\n        $$\n        C(\\lambda) = \\frac{F(\\lambda)}{F(0^{\\star})}, \\quad \\text{如果 } F(0^{\\star}) > 0, \\text{ 且 } C(\\lambda)=0 \\text{ 否则。}\n        $$\n\n对每个测试用例都执行这整个过程。对于给定的用例，为了优化计算，我们预先计算每个可能的特征子集的 MSE。然后，对于每个 $\\lambda$，我们只需找到使预先计算的 MSE 加上新的惩罚项 $\\lambda k$ 最小化的子集。最后，将所有计算出的 $(F(\\lambda), C(\\lambda))$ 对按问题指定的顺序收集到一个有序列表中。",
            "answer": "[0.96346, 1.0, 0.96264, 0.99915, 0.95995, 0.99636, 0.92319, 0.95820, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.89370, 1.0, 0.88796, 0.99358, 0.87189, 0.97560]"
        },
        {
            "introduction": "将 XAI 算法成功应用于网络物理系统 (CPS) 不仅仅是算法本身的设计，还必须考虑其在资源受限环境下的集成。在 CPS 中，计算资源通常需要与控制回路等安全关键型任务共享。本练习提出了一个实时调度问题，要求您应用最早截止时间优先 (EDF) 等调度理论，计算在不危及系统控制功能的前提下，可以分配给 XAI 任务的最大计算预算，从而保证整个系统的稳定性和可调度性。",
            "id": "4220860",
            "problem": "一个带有数字孪生的信息物理系统 (CPS) 运行周期性控制回路和一个可解释人工智能 (XAI) 模块，该模块计算系统决策的、人类可解释的说明。这些说明在一个由恒定带宽服务器 (CBS) 管理的资源预留机制下执行，单个处理器上的所有计算都由最早截止期优先 (EDF) 算法进行调度。假设任务是独立的、可抢占的，无自挂起，并且每个任务的相对截止期等于其周期。处理器是理想的，没有调度开销。\n\n您必须使用的基本假设：\n- 对于截止期等于周期的周期性任务，单处理器上的 EDF 可调度性成立当且仅当总利用率至多为 $1$。\n- 一个预算为 $Q_{x}$、周期为 $P_{x}$ 的 CBS 可以向全局 EDF 调度器表示为一个利用率为 $U_{x} = Q_{x}/P_{x}$ 的周期性任务。如果服务器的利用率至少是所有说明任务利用率之和，并且所有说明任务的截止期都等于其周期，则被服务器接纳的说明任务在服务器内部是可调度的。\n\n控制任务如下：\n- 控制任务 $1$：计算时间 $C_{1} = 4$ 毫秒，周期 $T_{1} = 20$ 毫秒，相对截止期 $D_{1} = 20$ 毫秒。\n- 控制任务 $2$：计算时间 $C_{2} = 10$ 毫秒，周期 $T_{2} = 50$ 毫秒，相对截止期 $D_{2} = 50$ 毫秒。\n- 控制任务 $3$：计算时间 $C_{3} = 15$ 毫秒，周期 $T_{3} = 100$ 毫秒，相对截止期 $D_{3} = 100$ 毫秒。\n\n说明服务器的周期为 $P_{x} = 40$ 毫秒，预算为 $Q_{x}$ (待确定)。服务器接纳的说明工作负载如下：\n- 说明流 $E_{1}$：计算时间 $C_{e1} = 6$ 毫秒，周期 $T_{e1} = 40$ 毫秒，相对截止期 $D_{e1} = 40$ 毫秒。\n- 说明流 $E_{2}$：计算时间 $C_{e2} = 8$ 毫秒，周期 $T_{e2} = 80$ 毫秒，相对截止期 $D_{e2} = 80$ 毫秒。\n\n根据上述基本假设，推导出一个调度策略，该策略通过为 EDF 下的 CBS 设置一个说明预算 $Q_{x}$ 来平衡说明计算和控制任务的截止期。具体要求如下：\n1. 推导 $Q_{x}$ 的可行区间，该区间能同时保证所有控制任务和所有说明任务的截止期。\n2. 在该区间内，选择一个最大允许的 $Q_{x}$，该值在保持控制任务可调度性的同时，也确保说明任务的可调度性。\n\n计算这个最大预算 $Q_{x}^{\\star}$ 并将其作为最终答案。将您的答案四舍五入到四位有效数字。以毫秒为单位表示最终预算。",
            "solution": "该问题要求确定用于调度说明任务的恒定带宽服务器 (CBS) 的最大允许预算 $Q_{x}^{\\star}$。该解决方案必须同时满足两个主要条件：\n1.  说明任务必须在 CBS 提供的资源内是可调度的。\n2.  整个任务集，包括三个控制任务和 CBS 本身（建模为一个周期性任务），必须能在单个处理器上通过最早截止期优先 (EDF) 调度策略进行调度。\n\n让我们分析每个条件，以推导对 CBS 预算 $Q_{x}$ 的约束。\n\n首先，我们解决 CBS 内部说明任务的可调度性问题。问题陈述，如果服务器的利用率 $U_{x}$ 至少是说明任务利用率之和，那么说明任务 ($E_1$, $E_2$) 是可调度的。一个计算时间为 $C_i$、周期为 $T_i$ 的周期性任务 $\\tau_i$ 的利用率由 $U_i = C_i / T_i$ 给出。\n\n两个说明流的利用率如下：\n- 对于 $E_1$：$U_{e1} = \\frac{C_{e1}}{T_{e1}} = \\frac{6 \\text{ ms}}{40 \\text{ ms}} = 0.15$。\n- 对于 $E_2$：$U_{e2} = \\frac{C_{e2}}{T_{e2}} = \\frac{8 \\text{ ms}}{80 \\text{ ms}} = 0.1$。\n\n说明工作负载所要求的总利用率是它们各自利用率之和：\n$$U_{exp} = U_{e1} + U_{e2} = 0.15 + 0.1 = 0.25$$\nCBS 的利用率由 $U_{x} = Q_{x}/P_{x}$ 给出。服务器周期 $P_{x} = 40$ 毫秒，因此我们有 $U_{x} = Q_{x}/40$。\n说明任务可调度性的条件是 $U_{x} \\ge U_{exp}$。\n$$\\frac{Q_{x}}{40} \\ge 0.25$$\n求解 $Q_{x}$，我们得到预算的下界：\n$$Q_{x} \\ge 0.25 \\times 40 = 10 \\text{ ms}$$\n因此，为保证说明任务的可调度性，CBS 预算 $Q_{x}$ 必须至少为 $10$ 毫秒。\n\n其次，我们解决处理器上所有任务的全局可调度性问题。全局 EDF 调度器管理三个控制任务 ($\\tau_1, \\tau_2, \\tau_3$) 和 CBS（表示为任务 $\\tau_x$）。根据给定的假设，对于一组截止期等于其周期的周期性任务，系统在 EDF 下是可调度的当且仅当总利用率不超过 $1$。\n$$U_{total} = U_1 + U_2 + U_3 + U_x \\le 1$$\n让我们计算控制任务的利用率：\n- 控制任务 $1$：$U_1 = \\frac{C_1}{T_1} = \\frac{4 \\text{ ms}}{20 \\text{ ms}} = 0.2$。\n- 控制任务 $2$：$U_2 = \\frac{C_2}{T_2} = \\frac{10 \\text{ ms}}{50 \\text{ ms}} = 0.2$。\n- 控制任务 $3$：$U_3 = \\frac{C_3}{T_3} = \\frac{15 \\text{ ms}}{100 \\text{ ms}} = 0.15$。\n\n控制任务的总利用率是：\n$$U_{ctrl} = U_1 + U_2 + U_3 = 0.2 + 0.2 + 0.15 = 0.55$$\n现在，我们可以将全局可调度性条件写为：\n$$U_{ctrl} + U_{x} \\le 1$$\n$$0.55 + \\frac{Q_x}{40} \\le 1$$\n求解最大允许服务器利用率 $U_x$：\n$$\\frac{Q_{x}}{40} \\le 1 - 0.55$$\n$$\\frac{Q_{x}}{40} \\le 0.45$$\n这给出了预算 $Q_{x}$ 的上界：\n$$Q_{x} \\le 0.45 \\times 40 = 18 \\text{ ms}$$\n为保证整个系统的可调度性，CBS 预算 $Q_{x}$ 不能超过 $18$ 毫秒。\n\n结合这两个条件，我们找到了能同时保证所有控制任务和说明任务截止期的 $Q_{x}$ 的可行区间：\n$$10 \\text{ ms} \\le Q_{x} \\le 18 \\text{ ms}$$\n问题要求的是最大允许的 $Q_{x}$，记为 $Q_{x}^{\\star}$。这是说明服务器在维持所有任务可调度性的前提下可能的最大预算。该值对应于可行区间的上界。\n$$Q_{x}^{\\star} = 18 \\text{ ms}$$\n问题要求答案四舍五入到四位有效数字。这得到 $18.00$。",
            "answer": "$$\\boxed{18.00}$$"
        }
    ]
}