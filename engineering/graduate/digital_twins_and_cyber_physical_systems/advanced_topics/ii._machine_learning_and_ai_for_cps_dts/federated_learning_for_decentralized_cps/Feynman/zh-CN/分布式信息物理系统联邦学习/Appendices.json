{
    "hands_on_practices": [
        {
            "introduction": "为任何信息物理系统（CPS）构建精确的数字孪生模型，其首要任务是准确地辨识其底层动态。本练习将指导您如何在一个去中心化的联邦学习框架中，为一组线性时不变（LTI）系统估计其动态矩阵。通过设计一个结合了物理先验知识和数据驱动证据的损失函数，您将推导出一个既能尊重物理规律又能保护数据隐私的闭式解，从而掌握物理信息联邦学习的核心思想。",
            "id": "4222039",
            "problem": "考虑一个由 $K$ 个分布式客户端组成的去中心化信息物理系统 (CPS)，每个客户端都维护一个数字孪生，其局部动态可以由一个线性时不变 (LTI) 模型良好近似。对于客户端 $k \\in \\{1,\\dots,K\\}$，其局部状态和输入时间序列满足离散时间动态 $x_{t+1}^{(k)} = A x_{t}^{(k)} + B u_{t}^{(k)} + \\epsilon_{t}^{(k)}$，其中 $x_{t}^{(k)} \\in \\mathbb{R}^{n}$，$u_{t}^{(k)} \\in \\mathbb{R}^{m}$，而 $\\epsilon_{t}^{(k)} \\in \\mathbb{R}^{n}$ 是模型失配和过程噪声。假设有一个基于物理的先验模型 $(A_{0}, B_{0})$，它是通过第一性原理建模和线性化得到的，其级联参数矩阵定义为 $\\Theta_{0} \\triangleq [A_{0}\\;B_{0}] \\in \\mathbb{R}^{n \\times (n+m)}$，并定义级联回归量为 $z_{t}^{(k)} \\triangleq \\begin{pmatrix} x_{t}^{(k)} \\\\ u_{t}^{(k)} \\end{pmatrix} \\in \\mathbb{R}^{n+m}$。每个客户端都有一条长度为 $T_{k}$ 的局部轨迹，样本索引为 $t \\in \\{0,\\dots,T_{k}-1\\}$。\n\n你的任务是设计一个能够惩罚对 LTI 动态违反的物理信息损失函数，并构建一个对 $(A,B)$ 的联邦估计器，该估计器在各客户端之间保持一致，同时保护数据局部性。该物理信息损失函数必须基于以下科学基础：\n- LTI 系统的定义及其残差 $r_{t}^{(k)} \\triangleq x_{t+1}^{(k)} - A x_{t}^{(k)} - B u_{t}^{(k)}$。\n- 一个经过充分检验的假设，即 $\\epsilon_{t}^{(k)}$ 是独立同分布的，且服从 $\\epsilon_{t}^{(k)} \\sim \\mathcal{N}(0,\\sigma^{2} I_{n})$，其中 $\\sigma^{2} > 0$ 是一个已知标量。\n- 需要使用正则化强度为 $\\lambda > 0$ 的 Tikhonov 惩罚项，将估计器向基于物理的先验 $\\Theta_{0}$ 正则化。\n\n形式上，推导一个在客户端和时间上可加的目标函数，该函数惩罚动态残差并向 $\\Theta_{0}$ 正则化。然后证明，对该目标函数关于 $\\Theta \\triangleq [A\\;B] \\in \\mathbb{R}^{n \\times (n+m)}$ 进行最小化，其解可以用客户端局部的充分统计量表示为一个闭式解，而这些统计量可以在不共享原始数据的情况下进行聚合。将你的最终估计器完全用以下跨客户端聚合的量来表示：\n- $S_{ZZ} \\triangleq \\sum_{k=1}^{K} \\sum_{t=0}^{T_{k}-1} z_{t}^{(k)} z_{t}^{(k)\\top} \\in \\mathbb{R}^{(n+m) \\times (n+m)}$,\n- $S_{XZ} \\triangleq \\sum_{k=1}^{K} \\sum_{t=0}^{T_{k}-1} x_{t+1}^{(k)} z_{t}^{(k)\\top} \\in \\mathbb{R}^{n \\times (n+m)}$。\n\n你的推导必须仅依赖于上述基础，并且不得引入任何未经检验的快捷公式。最终答案必须是关于 $\\Theta$ 的全局联邦估计的单一闭式解析表达式，写成 $S_{ZZ}$、$S_{XZ}$、$\\lambda$、$\\sigma^{2}$ 和 $\\Theta_{0}$ 的函数。不要包含任何数值，也不要提供不等式。最终答案中不要包含任何单位。",
            "solution": "该问题已经过验证。\n\n### 步骤 1：提取已知条件\n- **系统**：一个包含 $K$ 个客户端的去中心化信息物理系统 (CPS)。\n- **客户端动态**：对于客户端 $k \\in \\{1, \\dots, K\\}$ 的离散时间线性时不变 (LTI) 模型：$x_{t+1}^{(k)} = A x_{t}^{(k)} + B u_{t}^{(k)} + \\epsilon_{t}^{(k)}$。\n- **状态向量**：$x_{t}^{(k)} \\in \\mathbb{R}^{n}$。\n- **输入向量**：$u_{t}^{(k)} \\in \\mathbb{R}^{m}$。\n- **噪声项**：$\\epsilon_{t}^{(k)} \\in \\mathbb{R}^{n}$。\n- **基于物理的先验**：$(A_{0}, B_{0})$。\n- **级联先验矩阵**：$\\Theta_{0} \\triangleq [A_{0}\\;B_{0}] \\in \\mathbb{R}^{n \\times (n+m)}$。\n- **级联回归量**：$z_{t}^{(k)} \\triangleq \\begin{pmatrix} x_{t}^{(k)} \\\\ u_{t}^{(k)} \\end{pmatrix} \\in \\mathbb{R}^{n+m}$。\n- **数据轨迹**：对于每个客户端 $k$，一条长度为 $T_{k}$ 的轨迹，时间索引 $t \\in \\{0, \\dots, T_{k}-1\\}$。\n- **残差定义**：$r_{t}^{(k)} \\triangleq x_{t+1}^{(k)} - A x_{t}^{(k)} - B u_{t}^{(k)}$。\n- **噪声模型**：$\\epsilon_{t}^{(k)}$ 是独立同分布的 (i.i.d.)，服从高斯分布 $\\mathcal{N}(0,\\sigma^{2} I_{n})$，其中 $\\sigma^{2} > 0$ 是一个已知标量。\n- **正则化**：朝向 $\\Theta_{0}$ 的 Tikhonov 惩罚项，正则化强度为 $\\lambda > 0$。\n- **待估计参数矩阵**：$\\Theta \\triangleq [A\\;B] \\in \\mathbb{R}^{n \\times (n+m)}$。\n- **聚合的充分统计量**：\n  - $S_{ZZ} \\triangleq \\sum_{k=1}^{K} \\sum_{t=0}^{T_{k}-1} z_{t}^{(k)} z_{t}^{(k)\\top} \\in \\mathbb{R}^{(n+m) \\times (n+m)}$。\n  - $S_{XZ} \\triangleq \\sum_{k=1}^{K} \\sum_{t=0}^{T_{k}-1} x_{t+1}^{(k)} z_{t}^{(k)\\top} \\in \\mathbb{R}^{n \\times (n+m)}$。\n- **目标**：以闭式解形式推导 $\\Theta$ 的联邦估计器，表示为 $S_{ZZ}$、$S_{XZ}$、$\\lambda$、$\\sigma^{2}$ 和 $\\Theta_{0}$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、是良构的且客观的。\n1.  **科学依据**：该问题植根于系统辨识、统计估计和控制理论的基本原理。LTI 模型、高斯噪声假设、最大似然估计和 Tikhonov 正则化的使用是工程学和统计学中标准且经过严格验证的技术。联邦学习背景是这些原理的一个现代且有效的应用领域。\n2.  **良构性**：该问题要求推导一个目标函数的最小化子。该目标函数结合了平方和项（源自高斯似然）和二次正则化惩罚项，因此是凸的。这保证了解的存在性和唯一性。Tikhonov 正则化确保了即使数据矩阵之和 $S_{ZZ}$ 不是满秩的，问题仍然是良态的。\n3.  **客观性和完整性**：该问题使用精确的数学语言和符号进行陈述。构建目标函数和推导其最小化子所需的所有必要组成部分都已提供。定义是自洽且一致的。\n\n该问题不存在任何科学上不合理、信息缺失或歧义等缺陷。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个合理的解决方案。\n\n任务是通过最小化一个物理信息损失函数来推导参数矩阵 $\\Theta = [A\\;B]$ 的联邦估计器。该损失函数必须根据所提供的科学基础构建：惩罚动态残差并向先验模型 $\\Theta_0$ 正则化。该公式等价于寻找 $\\Theta$ 的最大后验 (MAP) 估计。\n\n我们要对 $\\Theta$ 最小化的总目标函数是数据保真项和正则化项的和。\n\n数据保真项源于观测数据的负对数似然。给定独立同分布的高斯噪声模型 $\\epsilon_{t}^{(k)} \\sim \\mathcal{N}(0, \\sigma^2 I_n)$，在给定回归量 $z_t^{(k)}$ 和参数 $\\Theta$ 的条件下，观测到状态 $x_{t+1}^{(k)}$ 的似然为：\n$$p(x_{t+1}^{(k)} | z_t^{(k)}, \\Theta) = \\frac{1}{(2\\pi\\sigma^2)^{n/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|x_{t+1}^{(k)} - \\Theta z_t^{(k)}\\|_2^2\\right)$$\n由于所有样本都是独立的，总对数似然是各个对数似然之和。忽略常数项，负对数似然与残差平方和成正比，并由噪声方差进行缩放：\n$$-\\ln \\mathcal{L}(\\Theta) \\propto \\frac{1}{2\\sigma^2} \\sum_{k=1}^{K} \\sum_{t=0}^{T_k-1} \\|x_{t+1}^{(k)} - \\Theta z_t^{(k)}\\|_2^2$$\n\n正则化项被指定为强度为 $\\lambda$ 的 Tikhonov 惩罚项：\n$$\\mathcal{R}(\\Theta) = \\frac{\\lambda}{2} \\|\\Theta - \\Theta_0\\|_F^2$$\n其中 $\\|\\cdot\\|_F$ 表示 Frobenius 范数。包含因子 $1/2$ 是为了便于求导。\n\n需要最小化的总目标函数是负对数似然项和正则化项的和，它代表了负对数后验：\n$$\\mathcal{J}(\\Theta) = \\frac{1}{2\\sigma^2} \\sum_{k=1}^{K} \\sum_{t=0}^{T_k-1} \\|x_{t+1}^{(k)} - \\Theta z_t^{(k)}\\|_2^2 + \\frac{\\lambda}{2} \\|\\Theta - \\Theta_0\\|_F^2$$\n该目标函数在客户端和时间上是可加的，这对于联邦方法至关重要。我们可以使用矩阵迹的符号重写该目标函数，注意到对于向量 $v$，有 $\\|v\\|_2^2 = v^\\top v = \\text{tr}(vv^\\top)$，对于矩阵 $M$，有 $\\|M\\|_F^2 = \\text{tr}(MM^\\top)$。\n\n让我们展开目标函数中的各项：\n$$\\sum_{k,t} \\|x_{t+1}^{(k)} - \\Theta z_t^{(k)}\\|_2^2 = \\sum_{k,t} \\text{tr}\\left((x_{t+1}^{(k)} - \\Theta z_t^{(k)})(x_{t+1}^{(k)} - \\Theta z_t^{(k)})^\\top\\right)$$\n$$= \\sum_{k,t} \\text{tr}\\left(x_{t+1}^{(k)}(x_{t+1}^{(k)})^\\top - x_{t+1}^{(k)}(z_t^{(k)})^\\top\\Theta^\\top - \\Theta z_t^{(k)}(x_{t+1}^{(k)})^\\top + \\Theta z_t^{(k)}(z_t^{(k)})^\\top\\Theta^\\top\\right)$$\n利用迹和求和算子的线性性质，上式变为：\n$$= \\text{tr}\\left(\\sum_{k,t} x_{t+1}^{(k)}(x_{t+1}^{(k)})^\\top\\right) - \\text{tr}\\left(\\left(\\sum_{k,t} x_{t+1}^{(k)}(z_t^{(k)})^\\top\\right)\\Theta^\\top\\right) - \\text{tr}\\left(\\Theta \\left(\\sum_{k,t} z_t^{(k)}(x_{t+1}^{(k)})^\\top\\right)\\right) + \\text{tr}\\left(\\Theta \\left(\\sum_{k,t} z_t^{(k)}(z_t^{(k)})^\\top\\right) \\Theta^\\top\\right)$$\n使用 $S_{XZ}$ 和 $S_{ZZ}$ 的给定定义以及性质 $\\text{tr}(A) = \\text{tr}(A^\\top)$：\n$$= C - 2\\text{tr}(S_{XZ} \\Theta^\\top) + \\text{tr}(\\Theta S_{ZZ} \\Theta^\\top)$$\n其中 $C$ 是一个与 $\\Theta$ 无关的常数。\n\n正则化项为：\n$$\\|\\Theta - \\Theta_0\\|_F^2 = \\text{tr}((\\Theta-\\Theta_0)(\\Theta-\\Theta_0)^\\top) = \\text{tr}(\\Theta\\Theta^\\top - \\Theta\\Theta_0^\\top - \\Theta_0\\Theta^\\top + \\Theta_0\\Theta_0^\\top)$$\n$$= \\text{tr}(\\Theta\\Theta^\\top) - 2\\text{tr}(\\Theta_0\\Theta^\\top) + \\text{const}$$\n\n将这些代回目标函数 $\\mathcal{J}(\\Theta)$：\n$$\\mathcal{J}(\\Theta) = \\frac{1}{2\\sigma^2}\\left(-2\\text{tr}(S_{XZ}\\Theta^\\top) + \\text{tr}(\\Theta S_{ZZ} \\Theta^\\top)\\right) + \\frac{\\lambda}{2}\\left(\\text{tr}(\\Theta\\Theta^\\top) - 2\\text{tr}(\\Theta_0\\Theta^\\top)\\right) + \\text{const}$$\n该目标函数是 $\\Theta$ 的二次函数，并且是凸函数。通过将其关于 $\\Theta$ 的梯度设置为零来找到最小值。我们使用矩阵微积分恒等式 $\\nabla_X \\text{tr}(AX^\\top) = A$ 和 $\\nabla_X \\text{tr}(X B X^\\top) = X(B+B^\\top)$。\n$$\\nabla_\\Theta \\mathcal{J}(\\Theta) = \\frac{1}{\\sigma^2}(-S_{XZ} + \\Theta S_{ZZ}) + \\lambda(\\Theta - \\Theta_0)$$\n由于 $S_{ZZ}$ 根据定义是对称的（$S_{ZZ} = S_{ZZ}^\\top$），上式可简化为：\n$$\\nabla_\\Theta \\mathcal{J}(\\Theta) = \\frac{1}{\\sigma^2}(-S_{XZ} + \\Theta S_{ZZ}) + \\lambda(\\Theta - \\Theta_0)$$\n将梯度设为零以找到最优的 $\\hat{\\Theta}$：\n$$\\frac{1}{\\sigma^2}(-S_{XZ} + \\hat{\\Theta} S_{ZZ}) + \\lambda(\\hat{\\Theta} - \\Theta_0) = 0$$\n我们现在求解 $\\hat{\\Theta}$。两边乘以 $\\sigma^2$：\n$$-S_{XZ} + \\hat{\\Theta} S_{ZZ} + \\lambda\\sigma^2(\\hat{\\Theta} - \\Theta_0) = 0$$\n$$\\hat{\\Theta} S_{ZZ} + \\lambda\\sigma^2 \\hat{\\Theta} = S_{XZ} + \\lambda\\sigma^2 \\Theta_0$$\n提出公因子 $\\hat{\\Theta}$：\n$$\\hat{\\Theta}(S_{ZZ} + \\lambda\\sigma^2 I) = S_{XZ} + \\lambda\\sigma^2 \\Theta_0$$\n其中 $I$ 是大小为 $(n+m) \\times (n+m)$ 的单位矩阵。\n通过右乘 $(S_{ZZ} + \\lambda\\sigma^2 I)$ 的逆矩阵，我们得到联邦估计 $\\hat{\\Theta}$ 的闭式解。当 $\\lambda > 0$ 和 $\\sigma^2 > 0$ 时，该矩阵是可逆的，因为 $S_{ZZ}$ 是半正定的，而 $\\lambda\\sigma^2 I$ 是正定的，使其和为正定矩阵，因此可逆。\n$$\\hat{\\Theta} = (S_{XZ} + \\lambda\\sigma^2 \\Theta_0)(S_{ZZ} + \\lambda\\sigma^2 I)^{-1}$$\n此解符合联邦设置。每个客户端 $k$ 计算其局部统计量 $\\sum_{t} z_{t}^{(k)} z_{t}^{(k)\\top}$ 和 $\\sum_{t} x_{t+1}^{(k)} z_{t}^{(k)\\top}$，然后这些统计量在中央服务器上聚合形成 $S_{ZZ}$ 和 $S_{XZ}$，而无需共享原始数据 $\\{x_t^{(k)}, u_t^{(k)}\\}$。然后，服务器使用推导出的公式计算最终估计值。",
            "answer": "$$\n\\boxed{(S_{XZ} + \\lambda\\sigma^{2}\\Theta_{0})(S_{ZZ} + \\lambda\\sigma^{2}I)^{-1}}\n$$"
        },
        {
            "introduction": "拥有系统模型后，下一步是利用它进行实时状态估计，例如通过融合来自多个传感器的测量数据。然而，当传感器具有不同的噪声特性时，简单地平均它们的读数是次优的。本练习将引导您从基本贝叶斯原理出发，推导在联邦设置下最优融合信息的卡尔曼滤波器（Kalman filter）的稳态误差协方差，并定量地展示按信息（噪声协方差的倒数）加权聚合相对于朴素平均的优越性。",
            "id": "4222026",
            "problem": "考虑一个去中心化的信息物理系统（CPS），其数字孪生（DT）运行一个联邦学习（FL）估算过程，用于估算一个标量潜藏状态。该物理过程根据离散时间线性时不变模型 $x_{k+1} = a x_k + w_k$ 演化，其中 $x_k \\in \\mathbb{R}$，$a \\in \\mathbb{R}$ 且为保证稳定性有 $|a|  1$，过程噪声 $w_k$ 为零均值高斯噪声，其方差为 $Q  0$。有 $m \\in \\mathbb{N}$ 个地理上分布的传感器；传感器 $i \\in \\{1,\\dots,m\\}$ 提供测量值 $y_{i,k} = x_k + v_{i,k}$，其中 $v_{i,k}$ 为零均值高斯噪声，其方差为 $R_i  0$，且在传感器之间和时间上相互独立，也与 $w_k$ 独立。\n\n数字孪生（DT）使用联邦聚合来维护一个卡尔曼式的估计器。在联邦设置中，原始测量数据不进行集中处理；而是由本地站点发送信息形式更新所需的必要统计数据。聚合器构建一个测量更新，该更新（在线性高斯意义上）等效于用每个传感器噪声协方差的逆 $R_i^{-1}$ 对其贡献进行加权。设测量更新后的后验误差协方差表示为 $P_k^{+}$，测量更新前的先验误差协方差表示为 $P_k^{-}$。时间更新遵循 $P_{k+1}^{-} = a^2 P_k^{+} + Q$。\n\n从线性高斯模型的基本贝叶斯估计原理以及传感器噪声的独立性出发，推导在逆协方差联邦聚合下的稳态后验误差协方差 $P^{\\star}$，并将其表示为关于 $a$、$Q$ 和 $\\{R_i\\}_{i=1}^{m}$ 的闭式解。然后，运用第一性原理，解释在稳态误差协方差方面，逆协方差加权与对测量值进行朴素均匀平均 $ \\bar{y}_k = \\frac{1}{m} \\sum_{i=1}^{m} y_{i,k}$ 相比有何不同，要求不依赖任何快捷公式。\n\n你的最终答案必须是 $P^{\\star}$ 的单一闭式解析表达式，并且不得包含任何不等式或方程比较。不需要四舍五入，也不需要单位。",
            "solution": "所述问题具有科学依据、提法恰当、客观且自成体系。它描述了一个标准的离散时间线性状态空间模型，并提出了一个关于在联邦传感场景下相关卡尔曼滤波器误差协方差黎卡提方程稳态解的问题。其模型和假设在估计理论和控制系统中是标准的。因此，该问题被认为是有效的。\n\n物理过程由线性时不变（LTI）模型描述：\n$$x_{k+1} = a x_k + w_k, \\quad w_k \\sim \\mathcal{N}(0, Q)$$\n其中 $x_k \\in \\mathbb{R}$ 是标量状态，稳定性条件 $|a|  1$ 成立，而 $w_k$ 是过程噪声。\n有 $m$ 个传感器，第 $i$ 个传感器提供测量值：\n$$y_{i,k} = x_k + v_{i,k}, \\quad v_{i,k} \\sim \\mathcal{N}(0, R_i)$$\n测量噪声 $v_{i,k}$ 相互独立，且与 $w_k$ 独立。\n\n所述联邦聚合方案的核心是信息融合原理。对于独立的高斯测量，关于状态的总信息是每个来源提供的信息之和。在这里，使用信息形式的卡尔曼滤波器最为自然。误差协方差矩阵（在本例中为标量 $P_k^{+}$）的信息更新由下式给出：\n$$(P_k^{+})^{-1} = (P_k^{-})^{-1} + \\sum_{i=1}^{m} H_i^T R_i^{-1} H_i$$\n在我们的例子中，每个传感器的测量矩阵 $H_i$ 就是标量 $1$。因此，后验误差协方差的更新方程变为：\n$$(P_k^{+})^{-1} = (P_k^{-})^{-1} + \\sum_{i=1}^{m} R_i^{-1}$$\n我们定义总测量精度 $S$ 为各个传感器精度之和：\n$$S = \\sum_{i=1}^{m} R_i^{-1}$$\n于是，测量更新方程为 $(P_k^{+})^{-1} = (P_k^{-})^{-1} + S$。量 $S^{-1}$ 可以被解释为有效测量噪声方差 $R_{eff}$，它代表了一个能最优地融合所有 $m$ 个传感器信息的单一等效传感器。\n\n误差协方差的时间更新由下式给出：\n$$P_{k+1}^{-} = a^2 P_k^{+} + Q$$\n\n我们寻求稳态后验误差协方差，记为 $P^{\\star}$。在稳态下，协方差不再随时间变化，因此 $P_k^{+} = P_{k+1}^{+} = P^{\\star}$ 且 $P_k^{-} = P_{k+1}^{-} = P^{-}$。稳态方程为：\n1. $(P^{\\star})^{-1} = (P^{-})^{-1} + S$\n2. $P^{-} = a^2 P^{\\star} + Q$\n\n我们可以解这个包含两个方程的方程组来求单个未知数 $P^{\\star}$。根据方程（1），我们可以用 $P^{\\star}$ 来表示 $P^{-}$：\n$$(P^{-})^{-1} = (P^{\\star})^{-1} - S = \\frac{1 - S P^{\\star}}{P^{\\star}} \\implies P^{-} = \\frac{P^{\\star}}{1 - S P^{\\star}}$$\n将此代入方程（2）：\n$$\\frac{P^{\\star}}{1 - S P^{\\star}} = a^2 P^{\\star} + Q$$\n这种方法会导致代数上的困难。一个更直接的代入方法是将方程（2）代入方程（1）：\n$$(P^{\\star})^{-1} = (a^2 P^{\\star} + Q)^{-1} + S$$\n$$\\frac{1}{P^{\\star}} = \\frac{1}{a^2 P^{\\star} + Q} + S$$\n为了消去分数，我们将整个方程乘以 $P^{\\star}(a^2 P^{\\star} + Q)$：\n$$a^2 P^{\\star} + Q = P^{\\star} + S P^{\\star}(a^2 P^{\\star} + Q)$$\n$$a^2 P^{\\star} + Q = P^{\\star} + a^2 S (P^{\\star})^2 + Q S P^{\\star}$$\n整理各项可得到一个关于 $P^{\\star}$ 的二次方程：\n$$a^2 S (P^{\\star})^2 + (1 + QS - a^2) P^{\\star} - Q = 0$$\n这是一个形式为 $A x^2 + B x + C = 0$ 的标准二次方程，其中 $x = P^{\\star}$，$A = a^2 S$，$B = 1-a^2+QS$，$C = -Q$。解由求根公式给出：\n$$P^{\\star} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$$\n代入我们的系数：\n$$P^{\\star} = \\frac{-(1-a^2+QS) \\pm \\sqrt{(1-a^2+QS)^2 - 4(a^2 S)(-Q)}}{2 a^2 S}$$\n$$P^{\\star} = \\frac{-(1-a^2+QS) \\pm \\sqrt{(1-a^2+QS)^2 + 4 a^2 Q S}}{2 a^2 S}$$\n由于 $P^{\\star}$ 代表误差方差，它必须是一个正实数。分母 $2a^2S$ 是正的（假设 $a \\neq 0$，这很典型，并且我们知道 $S  0$）。我们来分析分子。平方根下的项是严格正的。平方根项 $\\sqrt{(1-a^2+QS)^2 + 4 a^2 Q S}$ 严格大于 $\\sqrt{(1-a^2+QS)^2} = |1-a^2+QS|$。由于 $|a|1$，$Q0$ 且 $S0$，项 $1-a^2+QS$ 是正的。因此，平方根大于 $1-a^2+QS$。为了确保 $P^{\\star}$ 的结果为正，我们必须在分子中选择 `+' 号：\n$$P^{\\star} = \\frac{-(1-a^2+QS) + \\sqrt{(1-a^2+QS)^2 + 4 a^2 Q S}}{2 a^2 S}$$\n这就是在逆协方差联邦聚合下的稳态后验误差协方差的闭式表达式，其中 $S = \\sum_{i=1}^{m} R_i^{-1}$。\n\n接下来，我们将这种最优融合与对测量值进行朴素均匀平均进行比较。平均后的测量值为：\n$$\\bar{y}_k = \\frac{1}{m} \\sum_{i=1}^{m} y_{i,k} = \\frac{1}{m} \\sum_{i=1}^{m} (x_k + v_{i,k}) = x_k + \\frac{1}{m} \\sum_{i=1}^{m} v_{i,k}$$\n这对应于一个有效测量模型 $\\bar{y}_k = x_k + \\bar{v}_k$，其中有效测量噪声为 $\\bar{v}_k = \\frac{1}{m} \\sum_{i=1}^{m} v_{i,k}$。由于噪声 $v_{i,k}$ 是独立的，它们和的方差等于它们方差的和。有效噪声的方差为：\n$$R_{avg} = \\text{Var}(\\bar{v}_k) = \\text{Var}\\left(\\frac{1}{m} \\sum_{i=1}^{m} v_{i,k}\\right) = \\frac{1}{m^2} \\sum_{i=1}^{m} \\text{Var}(v_{i,k}) = \\frac{1}{m^2} \\sum_{i=1}^{m} R_i$$\n最优逆协方差加权的有效测量噪声方差为：\n$$R_{eff} = S^{-1} = \\left(\\sum_{i=1}^{m} R_i^{-1}\\right)^{-1}$$\n根据数学的第一性原理，特别是一组正数 $\\{R_i\\}$ 的算术平均值-调和平均值不等式，我们有：\n$$\\frac{\\sum_{i=1}^{m} R_i}{m} \\ge \\frac{m}{\\sum_{i=1}^{m} R_i^{-1}}$$\n两边同乘以 $1/m$ 得到：\n$$\\frac{1}{m^2}\\sum_{i=1}^{m} R_i \\ge \\frac{1}{\\sum_{i=1}^{m} R_i^{-1}}$$\n这直接可以转换为：\n$$R_{avg} \\ge R_{eff}$$\n等号成立的充要条件是所有测量噪声方差都相等，即 $R_1=R_2=\\dots=R_m$。\n\n根据估计的第一性原理，后验误差协方差是测量噪声方差的单调递增函数。较大的测量噪声方差意味着测量提供的关于状态的信息可靠性较低。因此，滤波器会减少对测量的权重，而更多地依赖模型预测，从而导致最终状态估计具有更大的不确定性（误差协方差）。因此，由于 $R_{avg} \\ge R_{eff}$，由朴素平均产生的稳态后验误差协方差 $P_{avg}^{\\star}$ 将大于或等于由最优逆协方差加权产生的协方差 $P^{\\star}$。除非所有传感器的精度完全相同，否则朴素均匀平均是次优的。",
            "answer": "$$\n\\boxed{ \\frac{-(1-a^2+Q\\sum_{i=1}^{m} R_i^{-1}) + \\sqrt{(1-a^2+Q\\sum_{i=1}^{m} R_i^{-1})^2 + 4 a^2 Q (\\sum_{i=1}^{m} R_i^{-1})}}{2 a^2 (\\sum_{i=1}^{m} R_i^{-1})} }\n$$"
        },
        {
            "introduction": "理想化的联邦学习模型通常假设所有客户端同步更新，但在真实的CPS网络中，通信和计算延迟会导致更新的到达时间不同步，即产生“陈旧性”（staleness）。本练习将帮助您分析这种异步性所引入的误差，并为其建立一个最坏情况下的上界。您还将探索如何设计一个指数加权方案来主动补偿陈旧更新的影响，从而提高异步联邦学习系统的鲁棒性和性能。",
            "id": "4222082",
            "problem": "考虑一个去中心化的信息物理系统 (CPS) 网络，其中一个全局数字孪生 (DT) 模型通过异步联邦学习 (FL) 进行训练。在全局迭代 $t$ 时，服务器理想情况下会应用同步更新 $-\\eta \\nabla f(x_t)$，其中 $f$ 是全局目标，$x_t$ 是当前的全局模型状态，$\\eta0$ 是步长。在实践中，由于通信和计算延迟，客户端更新会带有陈旧度（延迟）到达。设随机延迟 $K \\in \\{0,1,2,\\dots\\}$ 服从参数为 $p \\in (0,1]$ 的几何分布，即 $P(K=k)=\\pi_k$，其中 $\\pi_k = p(1-p)^k$。\n\n假设具有以下基本属性：\n- 全局目标 $f$ 具有 $L$-利普希茨连续梯度，即对所有 $x,y$ 和某个常数 $L0$，有 $\\|\\nabla f(x)-\\nabla f(y)\\| \\leq L \\|x-y\\|$。\n- 每个客户端的随机梯度在范数上由 $G0$ 一致有界，即对所有相关迭代，有 $\\|\\nabla f(x)\\| \\leq G$。\n- 每个全局更新步骤的幅度最多为 $\\eta G$，即 $\\|x_{t+1}-x_t\\| \\leq \\eta G$。\n\n将带有归一化陈旧度权重 $\\alpha_k$ 的异步聚合更新定义为 $-\\eta \\sum_{k=0}^{\\infty} \\alpha_k \\nabla f(x_{t-k})$，其中权重满足 $\\alpha_k \\geq 0$ 和 $\\sum_{k=0}^{\\infty} \\alpha_k = 1$。在迭代 $t$ 时，聚合模型更新中由延迟引起的误差是偏差\n$$\n\\Delta \\triangleq \\left\\|-\\eta \\sum_{k=0}^{\\infty} \\alpha_k \\nabla f(x_{t-k}) + \\eta \\nabla f(x_t)\\right\\|.\n$$\n- 情况 A (无加权): $\\alpha_k = \\pi_k$。\n- 情况 B (陈旧度加权): $\\alpha_k = \\frac{\\pi_k w(k)}{\\sum_{j=0}^{\\infty} \\pi_j w(j)}$，其中方案为 $w(k) = a^k$，参数 $a \\in (0,1)$。\n\n仅从上述基本属性和定义出发，推导情况 A 和情况 B 中 $\\Delta$ 的最坏情况上界。然后，选择指数陈旧度加权方案 $w(k)=a^k$ 并确定 $a$ 的值，使得情况 B 中的最坏情况上界恰好是情况 A 中的一半。你的最终答案必须是 $a$ 的单一闭式表达式（无单位）。不要在最终答案中提供中间步骤或任何其他量。",
            "solution": "该问题要求推导两种不同异步更新方案下延迟引起的误差 $\\Delta$ 的最坏情况上界，然后找到一个方案的参数值，使该上界相对于另一个减半。\n\n延迟引起的误差定义为：\n$$\n\\Delta \\triangleq \\left\\|-\\eta \\sum_{k=0}^{\\infty} \\alpha_k \\nabla f(x_{t-k}) + \\eta \\nabla f(x_t)\\right\\|\n$$\n其中 $\\eta  0$ 是步长，$f$ 是全局目标，$x_t$ 是全局迭代 $t$ 时的模型状态，$\\alpha_k$ 是满足 $\\alpha_k \\geq 0$ 和 $\\sum_{k=0}^{\\infty} \\alpha_k = 1$ 的归一化陈旧度权重。\n\n我们首先简化 $\\Delta$ 的表达式。我们可以提取因子 $\\eta$ 并利用权重和为 $1$ 的性质：\n$$\n\\Delta = \\eta \\left\\| \\nabla f(x_t) - \\sum_{k=0}^{\\infty} \\alpha_k \\nabla f(x_{t-k}) \\right\\| = \\eta \\left\\| \\left(\\sum_{k=0}^{\\infty} \\alpha_k\\right) \\nabla f(x_t) - \\sum_{k=0}^{\\infty} \\alpha_k \\nabla f(x_{t-k}) \\right\\|\n$$\n$$\n\\Delta = \\eta \\left\\| \\sum_{k=0}^{\\infty} \\alpha_k (\\nabla f(x_t) - \\nabla f(x_{t-k})) \\right\\|\n$$\n应用范数的三角不等式，我们得到一个上界：\n$$\n\\Delta \\leq \\eta \\sum_{k=0}^{\\infty} \\alpha_k \\|\\nabla f(x_t) - \\nabla f(x_{t-k})\\|\n$$\n问题陈述全局目标 $f$ 具有 $L$-利普希茨连续梯度，即 $\\|\\nabla f(x) - \\nabla f(y)\\| \\leq L \\|x - y\\|$。应用此性质，我们得到：\n$$\n\\Delta \\leq \\eta \\sum_{k=0}^{\\infty} \\alpha_k (L \\|x_t - x_{t-k}\\|)\n$$\n接下来，我们需要为 $\\|x_t - x_{t-k}\\|$ 找到一个界。对于 $k0$，我们可以将该差值表示为伸缩和：\n$$\nx_t - x_{t-k} = \\sum_{j=1}^{k} (x_{t-j+1} - x_{t-j})\n$$\n再次应用三角不等式：\n$$\n\\|x_t - x_{t-k}\\| \\leq \\sum_{j=1}^{k} \\|x_{t-j+1} - x_{t-j}\\|\n$$\n问题给出了每个全局更新步骤幅度的最坏情况上界：对于任何迭代 $i$，有 $\\|x_{i+1} - x_i\\| \\leq \\eta G$。将此代入不等式：\n$$\n\\|x_t - x_{t-k}\\| \\leq \\sum_{j=1}^{k} \\eta G = k \\eta G\n$$\n对于 $k=0$，距离为 $\\|x_t - x_t\\|=0$，这与该界一致。将此最坏情况距离界代回我们关于 $\\Delta$ 的上界表达式中：\n$$\n\\Delta \\leq \\eta \\sum_{k=0}^{\\infty} \\alpha_k (L (k \\eta G)) = \\eta^2 L G \\sum_{k=0}^{\\infty} k \\alpha_k\n$$\n这就得到了 $\\Delta$ 的一个通用的最坏情况上界。具体的界取决于权重 $\\alpha_k$ 的选择。项 $\\sum_{k=0}^{\\infty} k \\alpha_k$ 代表了有效的平均陈旧度。\n\n情况 A (无加权)：权重由延迟的几何分布给出，$\\alpha_k = \\pi_k = p(1-p)^k$。\n有效的平均陈旧度是此几何分布的期望值。\n$$\n\\sum_{k=0}^{\\infty} k \\alpha_k = \\sum_{k=0}^{\\infty} k p(1-p)^k = E[K]\n$$\n对于成功概率为 $p$ 且支撑集为 $\\{0, 1, 2, \\dots\\}$ 的几何分布，其期望值为 $E[K] = \\frac{1-p}{p}$。\n因此，情况 A 的最坏情况上界，记为 $B_A$，是：\n$$\nB_A = \\eta^2 L G \\left(\\frac{1-p}{p}\\right)\n$$\n\n情况 B (陈旧度加权)：权重由 $\\alpha_k = \\frac{\\pi_k w(k)}{\\sum_{j=0}^{\\infty} \\pi_j w(j)}$ 给出，其中 $w(k) = a^k$ 且 $a \\in (0,1)$。\n首先，我们计算分母中的归一化常数：\n$$\n\\sum_{j=0}^{\\infty} \\pi_j w(j) = \\sum_{j=0}^{\\infty} p(1-p)^j a^j = p \\sum_{j=0}^{\\infty} (a(1-p))^j\n$$\n这是一个公比为 $r = a(1-p)$ 的几何级数。由于 $a \\in (0,1)$ 和 $p \\in (0,1]$，我们有 $0 \\leq 1-p  1$，所以 $0 \\leq r  1$。该级数收敛于 $\\frac{1}{1-r}$。\n$$\n\\sum_{j=0}^{\\infty} \\pi_j w(j) = p \\left(\\frac{1}{1 - a(1-p)}\\right)\n$$\n现在我们可以写出 $\\alpha_k$ 的表达式：\n$$\n\\alpha_k = \\frac{p(1-p)^k a^k}{p / (1 - a(1-p))} = (1 - a(1-p))(a(1-p))^k\n$$\n这个 $\\alpha_k$ 的表达式是一个新的几何分布的概率质量函数，其成功概率为 $p' = 1 - a(1-p)$，支撑集为 $\\{0, 1, 2, \\dots\\}$。\n情况 B 的有效平均陈旧度是这个新分布的期望值：\n$$\n\\sum_{k=0}^{\\infty} k \\alpha_k = \\frac{1-p'}{p'} = \\frac{1 - (1 - a(1-p))}{1 - a(1-p)} = \\frac{a(1-p)}{1 - a(1-p)}\n$$\n因此，情况 B 的最坏情况上界，记为 $B_B$，是：\n$$\nB_B = \\eta^2 L G \\left(\\frac{a(1-p)}{1 - a(1-p)}\\right)\n$$\n\n最后，我们需要找到 $a$ 的值，使得 $B_B = \\frac{1}{2} B_A$。\n我们建立方程。对于 $p \\in (0,1)$，两个上界都非零。\n$$\n\\eta^2 L G \\left(\\frac{a(1-p)}{1 - a(1-p)}\\right) = \\frac{1}{2} \\left( \\eta^2 L G \\left(\\frac{1-p}{p}\\right) \\right)\n$$\n项 $\\eta^2 L G$ 和 $(1-p)$ (因为 $p1$) 是非零的，可以从两边消去。如果 $p=1$，两个上界都为 $0$，等式对任何 $a$ 都成立，但问题在 $p1$ 时最有意义。\n$$\n\\frac{a}{1 - a(1-p)} = \\frac{1}{2p}\n$$\n现在我们求解 $a$：\n$$\n2ap = 1 - a(1-p)\n$$\n$$\n2ap = 1 - a + ap\n$$\n$$\n2ap + a - ap = 1\n$$\n$$\nap + a = 1\n$$\n$$\na(p+1) = 1\n$$\n$$\na = \\frac{1}{1+p}\n$$\n这就是所要求的 $a$ 的闭式表达式。由于 $p \\in (0,1]$，则 $1+p \\in (1,2]$，这意味着 $a \\in [\\frac{1}{2}, 1)$，与给定的约束 $a \\in (0,1)$ 一致。",
            "answer": "$$\n\\boxed{\\frac{1}{1+p}}\n$$"
        }
    ]
}