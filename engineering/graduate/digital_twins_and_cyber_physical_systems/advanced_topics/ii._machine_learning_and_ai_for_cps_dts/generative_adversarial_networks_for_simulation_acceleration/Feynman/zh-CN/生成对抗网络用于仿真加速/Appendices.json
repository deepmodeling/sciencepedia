{
    "hands_on_practices": [
        {
            "introduction": "为数字孪生构建一个生成对抗网络（GAN）不仅仅是理论问题，更是一项工程挑战，需要确保模型能满足现实世界的硬件限制。本练习将让你扮演系统架构师的角色，进行一项关键的部署前分析：计算一个三维卷积神经网络（CNN）生成器的计算和内存占用，以确保它能在实时系统的严格时间和内存预算内运行。通过这项实践，你将掌握将抽象的网络架构与具体的硬件约束（如GPU内存和计算吞吐量）联系起来的核心技能。",
            "id": "4224761",
            "problem": "一个流体信息物理系统 (CPS) 的数字孪生 (DT) 需要通过生成对抗网络 (GAN) 进行实时体场合成，以加速高保真度模拟。其生成器是一个三维卷积神经网络 (CNN)，它将一个潜张量 $z \\in \\mathbb{R}^{C_0 \\times D_0 \\times H_0 \\times W_0}$ 映射到一个输出 $y \\in \\mathbb{R}^{D \\times H \\times W}$。该网络是严格前馈的，并使用三维转置卷积将 $z$ 逐步上采样到目标分辨率。图形处理单元 (GPU) 必须在有限的显存和计算资源下满足实时推理的要求。\n\n建模的基本依据：\n- 一个具有 $C_{\\mathrm{out}}$ 个输出通道、$C_{\\mathrm{in}}$ 个输入通道以及核大小为 $k_D \\times k_H \\times k_W$ 的三维卷积或转置卷积，拥有 $C_{\\mathrm{out}} \\cdot C_{\\mathrm{in}} \\cdot k_D \\cdot k_H \\cdot k_W$ 个权重。如果启用偏置，则有 $C_{\\mathrm{out}}$ 个偏置。\n- 批归一化 (BN) 每个输出通道有两个可训练参数（缩放和移位），带有BN的层不使用偏置。\n- 一次卷积前向传播的浮点运算次数 (FLOPs) 为 $2 \\cdot C_{\\mathrm{out}} \\cdot D_{\\mathrm{out}} \\cdot H_{\\mathrm{out}} \\cdot W_{\\mathrm{out}} \\cdot k_D \\cdot k_H \\cdot k_W \\cdot C_{\\mathrm{in}}$（乘加操作计为 $2$ FLOPs）。\n- 推理过程中的显存占用是参数显存与峰值激活显存之和。在保留当前和紧邻前一个特征图的顺序执行模式下，峰值激活显存占用等于各层中（前一个特征图元素数量与当前特征图元素数量之和）的最大值，再乘以每个元素的字节数。假设使用半精度（$16$位浮点数），因此每个元素占用 $2$ 字节。\n\n层规格：\n- 潜输入: $C_0 = 64$, $D_0 = 4$, $H_0 = 4$, $W_0 = 4$。\n- 第 $1$ 层：转置卷积，$C_1 = 256$，核 $4 \\times 4 \\times 4$，各轴步长为 $2$，填充方式使得 $D_1 = 8$, $H_1 = 8$, $W_1 = 8$。使用批归一化 (Batch Normalization) 和修正线性单元 (ReLU)。禁用偏置。\n- 第 $2$ 层：转置卷积，$C_2 = 128$，核 $4 \\times 4 \\times 4$，步长为 $2$，输出 $D_2 = 16$, $H_2 = 16$, $W_2 = 16$。使用批归一化 (Batch Normalization) 和修正线性单元 (ReLU)。禁用偏置。\n- 第 $3$ 层：转置卷积，$C_3 = 64$，核 $4 \\times 4 \\times 4$，步长为 $2$，输出 $D_3 = 32$, $H_3 = 32$, $W_3 = 32$。使用批归一化 (Batch Normalization) 和修正线性单元 (ReLU)。禁用偏置。\n- 第 $4$ 层：转置卷积，$C_4 = 16$，核 $4 \\times 4 \\times 4$，步长为 $2$，输出 $D_4 = 64$, $H_4 = 64$, $W_4 = 64$。使用批归一化 (Batch Normalization) 和修正线性单元 (ReLU)。禁用偏置。\n- 第 $5$ 层：转置卷积，$C_5 = 1$，核 $4 \\times 4 \\times 4$，步长为 $1$，填充方式使得 $D_5 = 64$, $H_5 = 64$, $W_5 = 64$。使用双曲正切激活函数。无批归一化。启用偏置。\n\n资源限制：\n- 半精度推理（每个元素 $16$ 位，$2$ 字节）。\n- GPU 显存：总共 $M_{\\mathrm{tot}} = 6$ GiB，其中 $M_{\\mathrm{res}} = 2$ GiB 为非网络任务保留；网络可用显存为 $\\tilde{M} = M_{\\mathrm{tot}} - M_{\\mathrm{res}}$，以 GiB 表示。\n- GPU 计算吞吐量：在半精度下持续 $F = 10$ 万亿次浮点运算每秒 (TFLOP/s)；每次推理的实时 DT 更新预算为 $t = 33$ 毫秒。\n- 假设峰值激活显存随批量大小 $B$ 线性扩展，而参数显存不随 $B$ 扩展。\n\n任务：\n1. 计算生成器的总可训练参数数量 $P$，包括卷积权重、启用的卷积偏置以及批归一化的缩放和移位参数。\n2. 在保留两个连续特征图的顺序执行假设下，计算每个样本的峰值激活元素数量，然后计算批量大小 $B = 1$ 时其占用的显存（以字节和 GiB 为单位）。\n3. 计算参数显存（以字节和 GiB 为单位）。\n4. 推导受显存限制的批量大小 $B_{\\mathrm{mem}}$，即满足 $M_{\\mathrm{params}} + B \\cdot M_{\\mathrm{act,peak}} \\leq \\tilde{M}$ 的最大整数 $B$，其中 $M_{\\mathrm{params}}$ 和 $M_{\\mathrm{act,peak}}$ 以相同的单位（GiB）表示。\n5. 计算整个前向传播过程中每个样本的 FLOPs，然后推导受计算限制的批量大小 $B_{\\mathrm{comp}}$，即满足 $B \\cdot \\frac{\\text{FLOPs}_{\\mathrm{per\\ sample}}}{F} \\leq t$ 的最大整数 $B$，其中 $F$ 的单位是 FLOP/s，$t$ 的单位是秒。\n6. 返回可行批量大小 $B_{\\max} = \\min\\{B_{\\mathrm{mem}}, B_{\\mathrm{comp}}\\}$，结果为一个整数。最终答案不带单位。如果报告任何中间数值，显存以 GiB 表示，并且仅在需要近似时，四舍五入到四位有效数字。",
            "solution": "我们从给定的参数数量、批归一化参数、卷积FLOPs和显存建模的定义开始。该网络由五个转置卷积层组成，具有指定的通道演进和空间尺寸。\n\n步骤 $1$：可训练参数数量 $P$。\n对于一个转置卷积，可训练权重数量等于 $C_{\\mathrm{out}} \\cdot C_{\\mathrm{in}} \\cdot k_D \\cdot k_H \\cdot k_W$。带有批归一化 (BN) 的层禁用偏置，而不带BN的最后一层启用偏置。批归一化贡献了 $2 \\cdot C_{\\mathrm{out}}$ 个可训练参数（缩放和移位）。\n\n设所有层的 $k_D = k_H = k_W = 4$，因此 $k_D \\cdot k_H \\cdot k_W = 4 \\cdot 4 \\cdot 4 = 64$。\n\n- 第 $1$ 层：$C_{\\mathrm{in}} = C_0 = 64$, $C_{\\mathrm{out}} = C_1 = 256$。权重：$256 \\cdot 64 \\cdot 64 = 1{,}048{,}576$。BN 参数：$2 \\cdot 256 = 512$。偏置：禁用。\n- 第 $2$ 层：$C_{\\mathrm{in}} = C_1 = 256$, $C_{\\mathrm{out}} = C_2 = 128$。权重：$128 \\cdot 256 \\cdot 64 = 2{,}097{,}152$。BN 参数：$2 \\cdot 128 = 256$。偏置：禁用。\n- 第 $3$ 层：$C_{\\mathrm{in}} = C_2 = 128$, $C_{\\mathrm{out}} = C_3 = 64$。权重：$64 \\cdot 128 \\cdot 64 = 524{,}288$。BN 参数：$2 \\cdot 64 = 128$。偏置：禁用。\n- 第 $4$ 层：$C_{\\mathrm{in}} = C_3 = 64$, $C_{\\mathrm{out}} = C_4 = 16$。权重：$16 \\cdot 64 \\cdot 64 = 65{,}536$。BN 参数：$2 \\cdot 16 = 32$。偏置：禁用。\n- 第 $5$ 层：$C_{\\mathrm{in}} = C_4 = 16$, $C_{\\mathrm{out}} = C_5 = 1$。权重：$1 \\cdot 16 \\cdot 64 = 1{,}024$。BN：无。偏置：$1$。\n\n权重总和：$1{,}048{,}576 + 2{,}097{,}152 + 524{,}288 + 65{,}536 + 1{,}024 = 3{,}736{,}576$。\nBN 参数总和：$512 + 256 + 128 + 32 = 928$。\n最后一层的偏置：$1$。\n因此，总可训练参数为：\n$$\nP = 3{,}736{,}576 + 928 + 1 = 3{,}737{,}505.\n$$\n\n步骤 $2$：每个样本的峰值激活元素数量和显存占用。\n在保留当前和紧邻前一个特征图的顺序执行模式下，峰值激活元素数量计算为各层中 $S_{\\mathrm{prev}} + S_{\\mathrm{curr}}$ 的最大值，其中 $S_{\\mathrm{prev}}$ 是前一个特征图的元素数量，$S_{\\mathrm{curr}}$ 是当前特征图的元素数量。\n\n计算元素数量：\n\n- 第 $1$ 层的输入：$S_{\\mathrm{prev,1}} = C_0 \\cdot D_0 \\cdot H_0 \\cdot W_0 = 64 \\cdot 4 \\cdot 4 \\cdot 4 = 64 \\cdot 64 = 4{,}096$。第 $1$ 层的输出：$S_{\\mathrm{curr,1}} = C_1 \\cdot D_1 \\cdot H_1 \\cdot W_1 = 256 \\cdot 8 \\cdot 8 \\cdot 8 = 256 \\cdot 512 = 131{,}072$。总和：$S_1 = 4{,}096 + 131{,}072 = 135{,}168$。\n\n- 第 $2$ 层：$S_{\\mathrm{prev,2}} = C_1 \\cdot D_1 \\cdot H_1 \\cdot W_1 = 256 \\cdot 8 \\cdot 8 \\cdot 8 = 131{,}072$。$S_{\\mathrm{curr,2}} = C_2 \\cdot D_2 \\cdot H_2 \\cdot W_2 = 128 \\cdot 16 \\cdot 16 \\cdot 16 = 128 \\cdot 4{,}096 = 524{,}288$。总和：$S_2 = 131{,}072 + 524{,}288 = 655{,}360$。\n\n- 第 $3$ 层：$S_{\\mathrm{prev,3}} = C_2 \\cdot D_2 \\cdot H_2 \\cdot W_2 = 128 \\cdot 4{,}096 = 524{,}288$。$S_{\\mathrm{curr,3}} = C_3 \\cdot D_3 \\cdot H_3 \\cdot W_3 = 64 \\cdot 32 \\cdot 32 \\cdot 32 = 64 \\cdot 32{,}768 = 2{,}097{,}152$。总和：$S_3 = 524{,}288 + 2{,}097{,}152 = 2{,}621{,}440$。\n\n- 第 $4$ 层：$S_{\\mathrm{prev,4}} = C_3 \\cdot D_3 \\cdot H_3 \\cdot W_3 = 64 \\cdot 32{,}768 = 2{,}097{,}152$。$S_{\\mathrm{curr,4}} = C_4 \\cdot D_4 \\cdot H_4 \\cdot W_4 = 16 \\cdot 64 \\cdot 64 \\cdot 64 = 16 \\cdot 262{,}144 = 4{,}194{,}304$。总和：$S_4 = 2{,}097{,}152 + 4{,}194{,}304 = 6{,}291{,}456$。\n\n- 第 $5$ 层：$S_{\\mathrm{prev,5}} = C_4 \\cdot D_4 \\cdot H_4 \\cdot W_4 = 16 \\cdot 262{,}144 = 4{,}194{,}304$。$S_{\\mathrm{curr,5}} = C_5 \\cdot D_5 \\cdot H_5 \\cdot W_5 = 1 \\cdot 64 \\cdot 64 \\cdot 64 = 262{,}144$。总和：$S_5 = 4{,}194{,}304 + 262{,}144 = 4{,}456{,}448$。\n\n峰值总和出现在第 $4$ 层，为 $S_{\\mathrm{peak}} = \\max\\{S_1, S_2, S_3, S_4, S_5\\} = 6{,}291{,}456$ 个元素。\n\n使用半精度（每个元素 $2$ 字节），每个样本的峰值激活显存为\n$$\nM_{\\mathrm{act,peak}}^{\\mathrm{bytes}} = S_{\\mathrm{peak}} \\cdot 2 = 6{,}291{,}456 \\cdot 2 = 12{,}582{,}912 \\text{ 字节}.\n$$\n以吉字节 (GiB) 表示，使用 $1 \\text{ GiB} = 2^{30} \\text{ 字节}$，\n$$\nM_{\\mathrm{act,peak}}^{\\mathrm{GiB}} = \\frac{12{,}582{,}912}{2^{30}} \\ \\text{GiB} \\approx \\frac{12{,}582{,}912}{1{,}073{,}741{,}824} \\ \\text{GiB} \\approx 0.01173 \\ \\text{GiB}.\n$$\n\n步骤 $3$：参数显存（以字节和 GiB 为单位）。\n总可训练参数 $P = 3{,}737{,}505$。使用半精度，每个参数占用 $2$ 字节，所以\n$$\nM_{\\mathrm{params}}^{\\mathrm{bytes}} = P \\cdot 2 = 3{,}737{,}505 \\cdot 2 = 7{,}475{,}010 \\text{ 字节}.\n$$\n以 GiB 为单位，\n$$\nM_{\\mathrm{params}}^{\\mathrm{GiB}} = \\frac{7{,}475{,}010}{2^{30}} \\ \\text{GiB} \\approx \\frac{7{,}475{,}010}{1{,}073{,}741{,}824} \\ \\text{GiB} \\approx 0.006963 \\ \\text{GiB}.\n$$\n\n步骤 $4$：受显存限制的批量大小 $B_{\\mathrm{mem}}$。\n网络可用显存为\n$$\n\\tilde{M} = M_{\\mathrm{tot}} - M_{\\mathrm{res}} = 6 - 2 = 4 \\ \\text{GiB}.\n$$\n批量大小为 $B$ 时的显存使用量等于 $M_{\\mathrm{params}}^{\\mathrm{GiB}} + B \\cdot M_{\\mathrm{act,peak}}^{\\mathrm{GiB}}$。满足该约束的最大整数 $B$ 是\n$$\nB_{\\mathrm{mem}} = \\left\\lfloor \\frac{\\tilde{M} - M_{\\mathrm{params}}^{\\mathrm{GiB}}}{M_{\\mathrm{act,peak}}^{\\mathrm{GiB}}} \\right\\rfloor = \\left\\lfloor \\frac{4 - 0.006963}{0.01173} \\right\\rfloor.\n$$\n计算分子：$4 - 0.006963 = 3.993037$。相除：$\\frac{3.993037}{0.01173} \\approx 340.4$。向下取整得到\n$$\nB_{\\mathrm{mem}} = 340.\n$$\n\n为了精确，等效地使用字节进行计算\n$$\nB_{\\mathrm{mem}} = \\left\\lfloor \\frac{4 \\cdot 2^{30} - 7{,}475{,}010}{12{,}582{,}912} \\right\\rfloor = \\left\\lfloor \\frac{4{,}294{,}967{,}296 - 7{,}475{,}010}{12{,}582{,}912} \\right\\rfloor = \\left\\lfloor \\frac{4{,}287{,}492{,}286}{12{,}582{,}912} \\right\\rfloor = 340,\n$$\n结果一致。\n\n步骤 $5$：受计算限制的批量大小 $B_{\\mathrm{comp}}$。\n每层每个样本的 FLOPs 由公式 $2 \\cdot C_{\\mathrm{out}} \\cdot D_{\\mathrm{out}} \\cdot H_{\\mathrm{out}} \\cdot W_{\\mathrm{out}} \\cdot k_D \\cdot k_H \\cdot k_W \\cdot C_{\\mathrm{in}}$ 给出。\n\n分层计算：\n\n- 第 $1$ 层：$C_{\\mathrm{in}} = 64$, $C_{\\mathrm{out}} = 256$, $D_1 H_1 W_1 = 8 \\cdot 8 \\cdot 8 = 512$, $k_D k_H k_W = 64$,\n$$\n\\text{FLOPs}_1 = 2 \\cdot 256 \\cdot 512 \\cdot 64 \\cdot 64 = 1{,}073{,}741{,}824.\n$$\n\n- 第 $2$ 层：$C_{\\mathrm{in}} = 256$, $C_{\\mathrm{out}} = 128$, $D_2 H_2 W_2 = 16 \\cdot 16 \\cdot 16 = 4{,}096$,\n$$\n\\text{FLOPs}_2 = 2 \\cdot 128 \\cdot 4{,}096 \\cdot 64 \\cdot 256 = 17{,}179{,}869{,}184.\n$$\n\n- 第 $3$ 层：$C_{\\mathrm{in}} = 128$, $C_{\\mathrm{out}} = 64$, $D_3 H_3 W_3 = 32 \\cdot 32 \\cdot 32 = 32{,}768$,\n$$\n\\text{FLOPs}_3 = 2 \\cdot 64 \\cdot 32{,}768 \\cdot 64 \\cdot 128 = 34{,}359{,}738{,}368.\n$$\n\n- 第 $4$ 层：$C_{\\mathrm{in}} = 64$, $C_{\\mathrm{out}} = 16$, $D_4 H_4 W_4 = 64 \\cdot 64 \\cdot 64 = 262{,}144$,\n$$\n\\text{FLOPs}_4 = 2 \\cdot 16 \\cdot 262{,}144 \\cdot 64 \\cdot 64 = 34{,}359{,}738{,}368.\n$$\n\n- 第 $5$ 层：$C_{\\mathrm{in}} = 16$, $C_{\\mathrm{out}} = 1$, $D_5 H_5 W_5 = 64 \\cdot 64 \\cdot 64 = 262{,}144$,\n$$\n\\text{FLOPs}_5 = 2 \\cdot 1 \\cdot 262{,}144 \\cdot 64 \\cdot 16 = 536{,}870{,}912.\n$$\n\n每个样本的前向传播总 FLOPs：\n$$\n\\text{FLOPs}_{\\mathrm{per\\ sample}} = 1{,}073{,}741{,}824 + 17{,}179{,}869{,}184 + 34{,}359{,}738{,}368 + 34{,}359{,}738{,}368 + 536{,}870{,}912 = 87{,}509{,}958{,}656.\n$$\n\n计算吞吐量和时间预算：\n持续的半精度吞吐量为 $F = 10 \\ \\text{TFLOP/s} = 10 \\times 10^{12} \\ \\text{FLOP/s}$。时间预算为 $t = 33 \\ \\text{ms} = 33 \\times 10^{-3} \\ \\text{s}$。对于批量大小 $B$，总计算时间为\n$$\nt_B = B \\cdot \\frac{\\text{FLOPs}_{\\mathrm{per\\ sample}}}{F}.\n$$\n满足 $t_B \\leq t$ 的最大整数 $B$ 是\n$$\nB_{\\mathrm{comp}} = \\left\\lfloor \\frac{t \\cdot F}{\\text{FLOPs}_{\\mathrm{per\\ sample}}} \\right\\rfloor = \\left\\lfloor \\frac{33 \\times 10^{-3} \\cdot 10 \\times 10^{12}}{87{,}509{,}958{,}656} \\right\\rfloor = \\left\\lfloor \\frac{330 \\times 10^{9}}{87{,}509{,}958{,}656} \\right\\rfloor.\n$$\n计算比率：$\\frac{330 \\times 10^{9}}{87{,}509{,}958{,}656} \\approx 3.7697$，所以\n$$\nB_{\\mathrm{comp}} = 3.\n$$\n\n步骤 $6$：可行的批量大小 $B_{\\max}$。\n我们取受显存限制和受计算限制的批量大小中的最小值：\n$$\nB_{\\max} = \\min\\{B_{\\mathrm{mem}}, B_{\\mathrm{comp}}\\} = \\min\\{340, 3\\} = 3.\n$$\n\n因此，在给定的用于实时 DT 推理的 GPU 资源约束下，可行的批量大小为 $B_{\\max} = 3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "一个生成模型在视觉上表现出色是不够的，其输出在关键性能指标上必须与真实数据在统计上无法区分。本练习将指导你完成一项基本的验证技术：使用假设检验来严格比较你的GAN生成的摘要统计量（如平均功率）与真实世界的数据。这项技能对于量化模型的可信度并确保数字孪生的预测在工程应用中是可靠的至关重要。",
            "id": "4224819",
            "problem": "在一个信息物理系统 (CPS) 中，一个电力电子模块的数字孪生 (DT) 使用生成对抗网络 (GAN) 通过提出近似真实系统输出分布的合成轨迹来加速仿真。令 $y$ 表示在持续时间为 $T$ 的控制周期内瞬时功率 $p(t)$ 的轨迹，并考虑由 $s(y) = \\frac{1}{T} \\int_{0}^{T} p(t) \\, dt$ 定义的标量摘要统计量 $s(y)$，即周期平均功率。假设从 GAN 生成的分布 $p_{g}$ 和真实数据分布 $p_{\\text{data}}$ 中收集 $s(y)$ 的独立样本。\n\n给定以下有限样本摘要：\n- GAN 样本：$n_{g} = 12$，样本均值 $\\bar{s}_{g} = 103.2 \\ \\mathrm{W}$，无偏样本方差 $S_{g}^{2} = 25 \\ \\mathrm{W}^{2}$。\n- 真实数据样本：$n_{\\text{data}} = 9$，样本均值 $\\bar{s}_{\\text{data}} = 96.7 \\ \\mathrm{W}$，无偏样本方差 $S_{\\text{data}}^{2} = 64 \\ \\mathrm{W}^{2}$。\n\n从适用于独立抽样和有限样本的基本统计原理出发，建立一个假设检验，以比较 $p_{g}$ 和 $p_{\\text{data}}$ 关于 $s(y)$ 的总体均值。明确陈述均值的原假设和备择假设，构建一个适用于未知且可能不等的方差的标准化检验统计量，根据所提供的摘要计算其数值，并通过给出对称双侧拒绝阈值，指明如何在显著性水平 $\\alpha = 0.05$ 的有限样本情况下控制第一类错误。\n\n将最终报告的阈值表示为一个无量纲数，并将您的最终答案四舍五入到四位有效数字。",
            "solution": "目标是检验 GAN 生成的摘要统计量的总体均值 $\\mu_{g}$ 是否等于真实数据摘要统计量的总体均值 $\\mu_{\\text{data}}$。这是一个关于均值相等的双样本假设检验。\n\n原假设 $H_{0}$ 假定总体均值之间没有差异。备择假设 $H_{A}$ 假定存在差异。由于这是一个双侧检验，假设如下：\n$$ H_{0}: \\mu_{g} = \\mu_{\\text{data}} \\quad \\text{or} \\quad \\mu_{g} - \\mu_{\\text{data}} = 0 $$\n$$ H_{A}: \\mu_{g} \\neq \\mu_{\\text{data}} \\quad \\text{or} \\quad \\mu_{g} - \\mu_{\\text{data}} \\neq 0 $$\n\n样本是独立抽取的。总体方差 $\\sigma_{g}^{2}$ 和 $\\sigma_{\\text{data}}^{2}$ 是未知的。问题明确要求使用一种适用于可能不等的方差的方法。因此，这就产生了 Behrens-Fisher 问题，其标准解法是 Welch's t-test。其基本假设是两个总体近似服从正态分布，这对于小样本量情况下使用 t 分布是一个合理的假设。\n\nWelch's t 统计量由下式给出：\n$$ t = \\frac{(\\bar{s}_{g} - \\bar{s}_{\\text{data}}) - (\\mu_{g} - \\mu_{\\text{data}})_0}{\\sqrt{\\frac{S_{g}^{2}}{n_{g}} + \\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}}} $$\n在原假设下，期望差值 $(\\mu_{g} - \\mu_{\\text{data}})_0$ 为 $0$。代入给定值：\n$\\bar{s}_{g} = 103.2$，$\\bar{s}_{\\text{data}} = 96.7$，$S_{g}^{2} = 25$，$n_{g} = 12$，$S_{\\text{data}}^{2} = 64$，$n_{\\text{data}} = 9$。\n\n分子是样本均值之差：\n$$ \\bar{s}_{g} - \\bar{s}_{\\text{data}} = 103.2 - 96.7 = 6.5 $$\n分母是均值差的标准误：\n$$ \\sqrt{\\frac{S_{g}^{2}}{n_{g}} + \\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}} = \\sqrt{\\frac{25}{12} + \\frac{64}{9}} = \\sqrt{\\frac{75}{36} + \\frac{256}{36}} = \\sqrt{\\frac{331}{36}} = \\frac{\\sqrt{331}}{6} \\approx 3.03223 $$\n检验统计量的值为：\n$$ t = \\frac{6.5}{\\frac{\\sqrt{331}}{6}} = \\frac{39}{\\sqrt{331}} \\approx 2.1430 $$\n\n该统计量近似服从自由度为 $\\nu$ 的 Student's t-分布，自由度使用 Welch-Satterthwaite 方程计算：\n$$ \\nu \\approx \\frac{\\left(\\frac{S_{g}^{2}}{n_{g}} + \\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}\\right)^2}{\\frac{\\left(\\frac{S_{g}^{2}}{n_{g}}\\right)^2}{n_{g} - 1} + \\frac{\\left(\\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}\\right)^2}{n_{\\text{data}} - 1}} $$\n我们来计算 $\\nu$ 分母中的各项：\n$$ \\frac{\\left(\\frac{S_{g}^{2}}{n_{g}}\\right)^2}{n_{g} - 1} = \\frac{\\left(\\frac{25}{12}\\right)^2}{11} = \\frac{625/144}{11} = \\frac{625}{1584} $$\n$$ \\frac{\\left(\\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}\\right)^2}{n_{\\text{data}} - 1} = \\frac{\\left(\\frac{64}{9}\\right)^2}{8} = \\frac{4096/81}{8} = \\frac{512}{81} $$\n$\\nu$ 的分母为：\n$$ \\frac{625}{1584} + \\frac{512}{81} \\approx 0.39457 + 6.32099 \\approx 6.71556 $$\n$\\nu$ 的分子为：\n$$ \\left(\\frac{S_{g}^{2}}{n_{g}} + \\frac{S_{\\text{data}}^{2}}{n_{\\text{data}}}\\right)^2 = \\left(\\frac{331}{36}\\right)^2 \\approx (9.19444)^2 \\approx 84.5378 $$\n因此，自由度为：\n$$ \\nu \\approx \\frac{84.5378}{6.71556} \\approx 12.588 $$\n\n为了在显著性水平 $\\alpha = 0.05$ 时对双侧检验控制第一类错误，我们必须从自由度为 $\\nu = 12.588$ 的 t 分布中找到临界值 $t_{\\alpha/2, \\nu}$。拒绝域由 $|t| > t_{0.025, 12.588}$ 定义。这个临界值是这样一个阈值，使得分布两个尾部的面积为 $0.05$。等价地，我们寻找值 $t_{crit}$，使得 $P(T > t_{crit}) = \\alpha/2 = 0.025$，其中 $T \\sim t(\\nu=12.588)$。\n\n标准 t 分布表提供整数自由度的值。对于 $\\nu=12$，$t_{0.025, 12} = 2.179$。对于 $\\nu=13$，$t_{0.025, 13} = 2.160$。由于我们计算出的 $\\nu \\approx 12.588$ 介于 12 和 13 之间，临界值将在这两个值之间。使用能够处理 t 分布反累积分布函数的非整数自由度的计算工具或统计计算器，我们得到：\n$$ t_{crit} = t_{0.025, 12.588} \\approx 2.1678 $$\n对称双侧拒绝阈值就是这个临界值。拒绝 $H_0$ 的条件是我们计算出的检验统计量的绝对值超过此阈值。此处， $|t| = 2.1430$，小于阈值 $2.1678$，因此我们在 $\\alpha = 0.05$ 的水平上不拒绝原假设。\n然而，问题仅仅要求给出拒绝阈值本身。\n\n将临界值四舍五入到四位有效数字得到 $2.168$。这就是无量纲的拒绝阈值。",
            "answer": "$$\n\\boxed{2.168}\n$$"
        },
        {
            "introduction": "使用GAN代理模型的最终目标是“加速”，但这在实践中究竟意味着什么？本练习通过对一个协同仿真回路建模来将此概念形式化，其中GAN为传统的物理求解器提供了一个智能的初始猜测。通过应用数值分析的原理，你将精确地量化GAN改进的初始猜测如何减少求解器的迭代次数，从而直接衡量其带来的计算加速效果。",
            "id": "4224832",
            "problem": "考虑一个热流体过程的信息物理数字孪生与一个控制器进行协同仿真，其中每个全局时间步都需要求解一个隐式非线性界面平衡。物理子求解器通过不动点迭代执行，该迭代由 Banach 空间上的一个非线性算子 $T$ 定义，其范数为 $|\\!|\\cdot|\\!|$，其中精确平衡点 $x^{\\star}$ 满足 $T(x^{\\star}) = x^{\\star}$。已知该求解器在以下基本前提下局部收敛：映射 $T$ 在包含 $x^{\\star}$ 的邻域 $\\mathcal{U}$ 上是一个压缩映射，其压缩常数 $c \\in (0,1)$ 满足对于所有 $x,y \\in \\mathcal{U}$ 都有 $|\\!|T(x) - T(y)|\\!| \\leq c \\, |\\!|x - y|\\!|$。停止准则为范数误差阈值 $|\\!|x_{k} - x^{\\star}|\\!| \\leq \\varepsilon$。\n\n为了在每个时间步加速收敛，使用了一个生成对抗网络 (GAN)——具体来说，是一个在历史求解器轨迹上离线训练的生成对抗网络 (GAN) 代理模型——来为物理求解器提供一个初始猜测 $\\tilde{x}_{0}$。根据经验，该代理模型将初始误差大小减小一个乘法因子 $0  \\gamma  1$，即 $|\\!|\\tilde{x}_{0} - x^{\\star}|\\!| = \\gamma \\, |\\!|x_{0} - x^{\\star}|\\!|$，其中 $x_{0}$ 是基准初始猜测（例如，从前一个时间步外插得到）。假设在使用 GAN 代理模型时，协同仿真循环部署了相同的物理求解器和算子 $T$，且压缩常数 $c$ 保持不变。\n\n从上述基本压缩性质和停止准则出发，推导迭代次数从基准值 $N$（不使用 GAN 代理模型）减少到 $N'$（使用 GAN 代理模型）的收敛条件，并用 $c$ 和 $\\gamma$ 表示。然后，在一个科学上符合实际的设定下，即压缩常数 $c = 0.52$，基准初始误差 $|\\!|x_{0} - x^{\\star}|\\!| = 1 \\times 10^{-2}$，误差容限 $\\varepsilon = 1 \\times 10^{-6}$，以及 GAN 改进因子 $\\gamma = 0.08$，计算由 GAN 代理模型初始化时求解器所需的整数迭代次数 $N'$。将最终数值答案表示为无单位的整数。",
            "solution": "我们首先回顾巴拿赫不动点定理（压缩映射原理）的核心结论。对于一个在完备度量空间上的压缩映射 $T$，其误差在每次迭代后以压缩常数 $c$ 的速率呈几何级数收敛。具体来说，从初始猜测 $x_0$ 开始的第 $k$ 次迭代的解 $x_k$ 与不动点 $x^*$ 之间的误差满足：\n$$\n\\|x_k - x^*\\| \\leq c^k \\|x_0 - x^*\\|\n$$\n\n我们的目标是找到满足停止准则 $\\|x_N - x^*\\| \\leq \\varepsilon$ 所需的最小迭代次数 $N$。将上述不等式代入停止准则，我们得到：\n$$\nc^N \\|x_0 - x^*\\| \\leq \\varepsilon\n$$\n为了解出 $N$，我们对不等式两边取对数：\n$$\nN \\log(c) + \\log(\\|x_0 - x^*\\|) \\leq \\log(\\varepsilon)\n$$\n由于 $0  c  1$，$\\log(c)$ 是负数。因此，在解不等式时，我们需要反转不等号的方向：\n$$\nN \\geq \\frac{\\log(\\varepsilon) - \\log(\\|x_0 - x^*\\|)}{\\log(c)} = \\frac{\\log(\\varepsilon / \\|x_0 - x^*\\|)}{\\log(c)}\n$$\n因为迭代次数必须是整数，所以所需的迭代次数是满足该条件的最小整数，即：\n$$\nN = \\left\\lceil \\frac{\\log(\\varepsilon / \\|x_0 - x^*\\|)}{\\log(c)} \\right\\rceil\n$$\n\n现在，我们应用这个公式来计算使用 GAN 代理模型时的迭代次数 $N'$。\n- **压缩常数**: $c = 0.52$\n- **基准初始误差**: $\\|x_0 - x^*\\| = 1 \\times 10^{-2}$\n- **误差容限**: $\\varepsilon = 1 \\times 10^{-6}$\n- **GAN 改进因子**: $\\gamma = 0.08$\n\n使用 GAN 代理模型后，新的初始猜测为 $\\tilde{x}_0$，其初始误差为：\n$$\n\\|\\tilde{x}_0 - x^*\\| = \\gamma \\|x_0 - x^*\\| = 0.08 \\times (1 \\times 10^{-2}) = 8 \\times 10^{-4}\n$$\n\n我们将这个新的初始误差代入迭代次数公式中来计算 $N'$：\n$$\nN' = \\left\\lceil \\frac{\\log(\\varepsilon / \\|\\tilde{x}_0 - x^*\\|)}{\\log(c)} \\right\\rceil = \\left\\lceil \\frac{\\log((1 \\times 10^{-6}) / (8 \\times 10^{-4}))}{\\log(0.52)} \\right\\rceil\n$$\n计算比值：\n$$\n\\frac{1 \\times 10^{-6}}{8 \\times 10^{-4}} = \\frac{1}{800} = 0.00125\n$$\n现在计算对数：\n$$\n\\log(0.00125) \\approx -6.68461\n$$\n$$\n\\log(0.52) \\approx -0.653926\n$$\n计算 $N'$：\n$$\nN' = \\left\\lceil \\frac{-6.68461}{-0.653926} \\right\\rceil = \\lceil 10.2223 \\rceil\n$$\n向上取整得到所需的最小整数迭代次数：\n$$\nN' = 11\n$$\n因此，当使用 GAN 代理模型提供的初始猜测时，物理求解器需要 11 次迭代才能达到所需的误差容限。",
            "answer": "$$\\boxed{11}$$"
        }
    ]
}