{
    "hands_on_practices": [
        {
            "introduction": "一个稳健的脑机接口系统依赖于高质量的神经记录，但这些记录常常被伪影所污染。本练习  提供了一个动手实践的机会，来建模和量化非侵入式脑机接口中最常见的问题之一：运动伪影。通过运用电路基本原理，你将推导出物理运动如何转化为信号污染，从而培养设计抗伪影脑机接口硬件和软件的关键技能。",
            "id": "3966676",
            "problem": "一个使用脑电图（EEG）的脑机接口（BCI）系统记录了两个活动通道，这两个通道参考同一个硬件参考电极。每个电极-皮肤界面由一个戴维南源建模，该源由局部界面（半电池）电位 $E_{k}(t)$ 与接触阻抗 $Z_{k}(t)$ 串联组成，其中 $k \\in \\{a,r\\}$，$a$ 表示活动通道，$r$ 表示参考电极。该仪表放大器具有极高的输入阻抗，但从每个输入端吸入大小为 $i_{b}$ 的恒定输入偏置电流。头部运动会在接触阻抗和参考半电池电位中引起微小的正弦调制。假设如下：\n\n- 放大器测量差分输入 $V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$，其中 $V_{k}(t)$ 是电极 $k$ 在放大器输入端的电极电位。\n- 放大器输入偏置电流的大小为 $i_{b}$，对于 $a$ 和 $r$ 两个电极，电流均从电极流入放大器输入端。\n- 基线阻抗为 $Z_{a,0}$ 和 $Z_{r,0}$，伴有由运动引起的微小变化 $\\delta Z_{a}(t)$ 和 $\\delta Z_{r}(t)$，使得 $Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$ 且 $|\\delta Z_{k}(t)| \\ll Z_{k,0}$。\n- 参考电极的界面电位有一个运动引起的分量 $\\delta E_{r}(t)$；与 $\\delta E_{r}(t)$ 相比，$E_{a}(t)$ 中任何由运动引起的变化都可以忽略不计。\n- 仪表放大器的输入阻抗足够高，以至于与偏置电流相比，所有其他电流都可以忽略不计，并且头皮被视为驱动串联元件 $E_{k}(t)$ 和 $Z_{k}(t)$ 的局部节点。\n\n从基尔霍夫电流定律（KCL）和欧姆定律出发，推导由头部运动引起的差分伪影分量，并用给定的量表示 $a$ 参考通道中该伪影的振幅。然后，使用下面的具体参数值，计算 $a$ 参考通道中污染的数值振幅：\n\n- $i_{b} = 220 \\,\\mathrm{pA}$，\n- $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$，其中 $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$，\n- $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$，其中 $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$，\n- $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$，其中 $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$，\n\n并忽略所有神经信号 $E_{a}(t)$ 和基线偏移。将角频率为 $\\omega$ 的正弦调制视为同相，并假设线性叠加成立。以微伏为单位表示最终的污染振幅，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是良定的和客观的。\n\n### 步骤 1：提取已知条件\n-   系统：使用脑电图（EEG）的脑机接口（BCI）。\n-   测量配置：一个活动通道（$a$）和一个参考电极（$r$）。\n-   电极模型：每个电极 $k \\in \\{a,r\\}$ 的戴维南源，由一个半电池电位 $E_{k}(t)$ 与一个接触阻抗 $Z_{k}(t)$ 串联而成。\n-   放大器测量：$V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$，其中 $V_{k}(t)$ 是放大器输入端的电位。\n-   放大器输入偏置电流：大小为 $i_{b}$ 的恒定电流从每个电极流入相应的放大器输入端。\n-   阻抗模型：$Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$，其中 $Z_{k,0}$ 是基线阻抗，$\\delta Z_{k}(t)$ 是由运动引起的微小变化，使得 $|\\delta Z_{k}(t)| \\ll Z_{k,0}$。\n-   电位模型：$E_{a}(t)$ 中由运动引起的变化可忽略不计。参考电位有一个运动引起的分量 $\\delta E_{r}(t)$。\n-   假设：\n    1.  仪表放大器的输入阻抗实际上是无穷大。\n    2.  对于每个电极的戴维南模型，头皮是一个局部节点。\n    3.  忽略所有神经信号（$E_{a}(t)$）和基线电位偏移。\n    4.  线性叠加原理适用。\n-   任务：\n    1.  推导由头部运动引起的差分伪影分量。\n    2.  使用提供的参数计算此污染的数值振幅。\n-   参数值：\n    -   $i_{b} = 220 \\,\\mathrm{pA}$\n    -   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$，其中 $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$\n    -   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$，其中 $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$\n    -   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$，其中 $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$\n-   最终要求：以微伏为单位表示污染振幅，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在生物电位测量和电气工程原理方面有充分的依据。电极-皮肤界面的戴维南模型、放大器偏置电流的概念，以及调制阻抗和电位的运动伪影，都是脑电图和脑机接口设计中的标准和现实概念。\n-   **良定性**：该问题提供了一个清晰的物理模型，定义了所有变量，并指定了足够的假设和参数，以得出一个唯一的数值解。\n-   **客观性**：该问题以精确、客观和技术的术语陈述。\n-   **结论**：该问题被认为是有效的，因为它是科学合理的、自洽的并且是良定的。\n\n### 步骤 3：判定和操作\n问题有效。推导详细解法。\n\n### 推导\n每个电极在仪表放大器输入端的电位 $V_{k}(t)$ 可以通过对电极-皮肤界面模型应用欧姆定律来确定。放大器从电极吸入偏置电流 $i_{b}$。根据问题描述，此电流从电极流入放大器。这意味着电流从生理源流出，经过串联阻抗 $Z_k(t)$，到达放大器输入端。因此，放大器输入端的电位 $V_k(t)$ 是源电位 $E_k(t)$ 减去阻抗 $Z_k(t)$ 上的电压降。\n\n对于活动电极（$k=a$）：\n$$V_{a}(t) = E_{a}(t) - i_{b} Z_{a}(t)$$\n对于参考电极（$k=r$）：\n$$V_{r}(t) = E_{r}(t) - i_{b} Z_{r}(t)$$\n\n仪表放大器测量差分电压 $V_{\\text{diff}}(t)$：\n$$V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$$\n代入 $V_{a}(t)$ 和 $V_{r}(t)$ 的表达式：\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - i_{b} Z_{a}(t) \\right) - \\left( E_{r}(t) - i_{b} Z_{r}(t) \\right)$$\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - E_{r}(t) \\right) - i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$$\n\n这个表达式包含两个主要部分：真实的差分生理信号 $\\left( E_{a}(t) - E_{r}(t) \\right)$ 和一个伪影项 $-i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$，后者是由于偏置电流流过不匹配的阻抗而产生的。\n\n我们被要求找出由头部运动引起的伪影分量，同时忽略神经信号和基线偏移。我们应用给定的假设：\n-   忽略活动电极的神经信号：$E_{a}(t) = 0$。\n-   参考电位仅包含运动引起的分量：$E_{r}(t) = \\delta E_{r}(t)$。\n-   阻抗由基线和运动引起的分量组成：$Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$。\n\n将这些代入 $V_{\\text{diff}}(t)$ 的表达式中：\n$$V_{\\text{diff}}(t) = (0 - \\delta E_{r}(t)) - i_{b} \\left( (Z_{a,0} + \\delta Z_{a}(t)) - (Z_{r,0} + \\delta Z_{r}(t)) \\right)$$\n$$V_{\\text{diff}}(t) = -\\delta E_{r}(t) - i_{b} \\left( Z_{a,0} - Z_{r,0} \\right) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\n\n项 $-i_{b}(Z_{a,0} - Z_{r,0})$ 是一个恒定的直流偏移伪影。问题要求的是*由头部运动引起的差分伪影分量*，这是指时变分量。我们将此运动伪影表示为 $V_{\\text{artifact}}(t)$：\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\n这可以重写为：\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) + i_{b} \\left( \\delta Z_{r}(t) - \\delta Z_{a}(t) \\right)$$\n\n现在，我们代入给定的运动引起的变化的正弦形式：\n-   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$\n-   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$\n-   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$\n\n$$V_{\\text{artifact}}(t) = -\\Delta E_{r} \\cos(\\omega t) + i_{b} \\left( \\Delta Z_{r} \\cos(\\omega t) - \\Delta Z_{a} \\cos(\\omega t) \\right)$$\n由于所有调制都是同相的，我们可以提出因子 $\\cos(\\omega t)$：\n$$V_{\\text{artifact}}(t) = \\left[ -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right] \\cos(\\omega t)$$\n\n这个正弦伪影的振幅，我们称之为 $A_{\\text{artifact}}$，是余弦项系数的绝对值：\n$$A_{\\text{artifact}} = \\left| -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right|$$\n\n现在，我们使用提供的参数计算数值。首先，我们将所有值转换为国际单位制（SI）基本单位（伏特、安培、欧姆）。\n-   $i_{b} = 220 \\,\\mathrm{pA} = 220 \\times 10^{-12} \\,\\mathrm{A}$\n-   $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega = 2.4 \\times 10^{3} \\,\\Omega$\n-   $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega = 3.7 \\times 10^{3} \\,\\Omega$\n-   $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V} = 7.6 \\times 10^{-6} \\,\\mathrm{V}$\n\n首先，计算与阻抗相关的电压项：\n$$\\Delta Z_{r} - \\Delta Z_{a} = (3.7 \\times 10^{3} - 2.4 \\times 10^{3}) \\,\\Omega = 1.3 \\times 10^{3} \\,\\Omega$$\n$$i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) = (220 \\times 10^{-12} \\,\\mathrm{A}) \\times (1.3 \\times 10^{3} \\,\\Omega) = 286 \\times 10^{-9} \\,\\mathrm{V} = 0.286 \\times 10^{-6} \\,\\mathrm{V}$$\n\n现在，将此代入振幅表达式：\n$$A_{\\text{artifact}} = \\left| -(7.6 \\times 10^{-6} \\,\\mathrm{V}) + (0.286 \\times 10^{-6} \\,\\mathrm{V}) \\right|$$\n$$A_{\\text{artifact}} = \\left| ( -7.6 + 0.286 ) \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = \\left| -7.314 \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = 7.314 \\times 10^{-6} \\,\\mathrm{V}$$\n\n问题要求答案以微伏（$\\mu\\mathrm{V}$）为单位。\n$$A_{\\text{artifact}} = 7.314 \\,\\mu\\mathrm{V}$$\n这个值已经用四位有效数字表示。",
            "answer": "$$\\boxed{7.314}$$"
        },
        {
            "introduction": "脑机接口的核心是将神经活动转化为控制信号的解码算法。本练习  深入探讨了经典群体向量解码器的数学分析。你将学习如何推导其因神经元群体非理想特性而产生的系统误差（即偏差），并进而使用加权最小二乘法开发一个更精确的解码器，从而深入理解算法校正和优化的原理。",
            "id": "3966623",
            "problem": "考虑一个脑机接口（BCI）解码任务，其目标是从一组具有余弦调谐特性的神经元群体中恢复二维的运动方向。令真实的运动方向由单位向量 $\\mathbf{u}(\\theta) = [\\cos\\theta, \\sin\\theta]^{\\top}$ 表示，对于某个角度 $\\theta \\in [0, 2\\pi)$，其中上标 $\\top$ 表示转置。每个神经元 $i \\in \\{1, \\dots, N\\}$ 都有一个偏好方向（PD） $\\phi_i$ 和一个相关的单位向量 $\\mathbf{p}_i = [\\cos\\phi_i, \\sin\\phi_i]^{\\top}$。神经元 $i$ 的调谐模型由一个随机脉冲计数 $r_i$ 给出，其在运动方向 $\\theta$ 下的条件期望为\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta),\n$$\n其中 $\\alpha_i > 0$ 是基线发放率，$\\beta_i \\ge 0$ 是调制增益。假设给定 $\\theta$ 时，$r_i$ 条件独立，并且噪声源于泊松脉冲过程，因此 $\\operatorname{Var}(r_i \\mid \\theta) = \\mathbb{E}[r_i \\mid \\theta]$。偏好方向角集合 $\\{\\phi_i\\}_{i=1}^{N}$ 在 $[0, 2\\pi)$ 上不是均匀分布的，并且基线 $\\{\\alpha_i\\}$ 和增益 $\\{\\beta_i\\}$ 可能是异质的。定义朴素群体向量解码器\n$$\n\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i.\n$$\n令相对于真实方向的偏差向量为\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta).\n$$\n首先，计算 $\\mathbf{b}(\\theta)$ 关于 $\\{\\alpha_i\\}$、$\\{\\beta_i\\}$ 和 $\\{\\mathbf{p}_i\\}$ 的闭式解析表达式。接下来，通过将 $\\mathbf{u}(\\theta)$ 估计为以下表达式的最小值，推导一个基于加权最小二乘（WLS）的校正：\n$$\n\\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2},\n$$\n其中 $w_i > 0$ 是用户指定的权重。提供 $\\mathbf{u}$ 的闭式 WLS 估计器，用 $\\{w_i\\}$、$\\{\\alpha_i\\}$、$\\{\\beta_i\\}$ 和 $\\{\\mathbf{p}_i\\}$ 表示。假设 $2 \\times 2$ 矩阵 $\\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是可逆的（例如，至少有两个具有正权重和增益的非共线偏好方向）。你的最终答案必须是一个单行矩阵，按顺序包含 $\\mathbf{b}(\\theta)$ 的解析表达式和 WLS 估计器 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$ 的解析表达式。不需要进行数值计算。",
            "solution": "该问题要求推导与神经解码相关的两个量：朴素群体向量解码器的偏差和运动方向的加权最小二乘（WLS）估计器。\n\n首先，我将推导偏差向量 $\\mathbf{b}(\\theta)$ 的表达式。偏差定义为估计器的期望值与被估计参数的真实值之间的差。\n估计器是朴素群体向量解码器，由 $\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i$ 给出。真实参数是运动方向向量 $\\mathbf{u}(\\theta)$。\n因此，偏差向量为 $\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta)$。\n\n我们首先计算 $\\hat{\\mathbf{v}}$ 的条件期望：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\mathbb{E}\\left[\\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i \\mid \\theta\\right]\n$$\n根据期望的线性性质，并注意到偏好方向向量 $\\mathbf{p}_i$ 是固定参数：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\mathbb{E}[r_i \\mid \\theta] \\, \\mathbf{p}_i\n$$\n问题陈述了神经元 $i$ 的脉冲计数 $r_i$ 的条件均值为：\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\n$$\n将此表达式代入我们期望的群体向量方程中：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\left(\\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\, \\mathbf{p}_i\n$$\n我们可以分配求和：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i + \\sum_{i=1}^{N} \\beta_i \\left(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\mathbf{p}_i\n$$\n$\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)$ 项是标量。我们可以将乘积 $(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)) \\mathbf{p}_i$ 重写为 $(\\mathbf{p}_i \\mathbf{p}_i^{\\top}) \\mathbf{u}(\\theta)$，其中 $\\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是一个 $2 \\times 2$ 矩阵（外积）。这使我们能够将 $\\mathbf{u}(\\theta)$ 因子提出来：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta)\n$$\n现在，我们将此结果代入偏差向量的定义中：\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta) - \\mathbf{u}(\\theta)\n$$\n令 $\\mathbf{I}$ 为 $2 \\times 2$ 单位矩阵。我们可以从最后两项中提出因子 $\\mathbf{u}(\\theta)$：\n$$\n\\mathbf{b}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta)\n$$\n这就是偏差向量的最终解析表达式。\n\n其次，我将推导 WLS 估计器 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$。该估计器是通过最小化以下关于向量 $\\mathbf{u}$ 的成本函数找到的：\n$$\nJ(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\n这是一个关于 $\\mathbf{u}$ 的二次函数，其最小值可以通过将其关于 $\\mathbf{u}$ 的梯度设置为零向量来找到。\n梯度为：\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\frac{\\partial}{\\partial \\mathbf{u}} \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\n使用链式法则 $\\nabla_{\\mathbf{x}} (f(\\mathbf{x}))^2 = 2f(\\mathbf{x}) \\nabla_{\\mathbf{x}}f(\\mathbf{x})$，并注意到 $\\nabla_{\\mathbf{u}}(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}) = -\\beta_i \\mathbf{p}_i$，我们得到：\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right) (-\\beta_i \\mathbf{p}_i)\n$$\n将梯度设置为零向量 $\\mathbf{0}$，以找到最优的 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) (-\\beta_i \\mathbf{p}_i) = \\mathbf{0}\n$$\n除以标量常数 $-2$：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\n我们分配求和内的各项：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i (r_i - \\alpha_i) - \\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(\\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\n重新整理以求解 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i^2 \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\n从左侧的求和中提出因子 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right) \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\n问题指明矩阵 $\\mathbf{Q} = \\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是可逆的。因此，我们可以通过在两边左乘 $\\mathbf{Q}^{-1}$ 来求解 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right)\n$$\n这就是运动方向向量的 WLS 估计器的闭式表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta)  \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了捕捉神经放电丰富的动力学特性，先进的脑机接口依赖于如点过程广义线性模型（GLM）等概率模型。在实现这类模型之前，掌握其理论基础至关重要。本练习  旨在检验你对构成尖峰序列GLM框架基础的数学定义和关系的理解，涵盖了从条件强度函数到用于模型拟合的对数似然等核心概念。",
            "id": "4188884",
            "problem": "一个实验室正在部署一个闭环脑机接口（BCI），该接口必须根据单个通道上记录的胞外尖峰序列实时更新解码器。设 $N(t)$ 表示到时间 $t$ 为止的尖峰计数过程，并设 $\\mathcal{H}_t$ 表示由 $\\{N(s): 0 \\le s \\le t\\}$ 以及到时间 $t$ 为止任何因果可用的协变量所生成的历史。该团队在广义线性模型（GLM）框架内采用点过程公式，对具有典则连接的泊松观测进行建模，以模拟短时间区间内的尖峰发放概率，并实现在线参数更新。\n\n从基本原理出发，条件强度函数旨在表征给定过去历史的瞬时尖峰发放倾向，而GLM旨在通过一个连接函数将观测值的均值与线性预测子关联起来，该连接函数确保强度的非负性并遵循闭环操作的因果性。\n\n在此情境下，选择所有正确的选项。\n\nA. 条件强度函数定义为\n$$\n\\lambda(t \\mid \\mathcal{H}_t) \\equiv \\lim_{\\Delta \\to 0^+} \\frac{\\Pr\\left(N(t+\\Delta)-N(t)=1 \\mid \\mathcal{H}_t\\right)}{\\Delta},\n$$\n假设 $\\Pr\\left(N(t+\\Delta)-N(t)\\ge 2 \\mid \\mathcal{H}_t\\right) = o(\\Delta)$。\n\nB. 在具有典则连接的泊松GLM中，线性预测子 $\\eta(t)$ 与条件强度之间的关系是恒等映射，即 $\\lambda(t \\mid \\mathcal{H}_t) = \\eta(t)$，因为泊松观测的典则连接是恒等连接。\n\nC. 针对尖峰序列的因果点过程GLM可以表示为一个带有依赖于协变量和尖峰历史的线性预测子，并使用指数连接来强制非负性，例如\n$$\n\\lambda(t \\mid \\mathcal{H}_t) \\;=\\; \\exp\\!\\left\\{\\beta_0 \\;+\\; \\mathbf{k}^\\top \\mathbf{x}(t) \\;+\\; \\int_{0^+}^{\\infty} h(\\tau)\\, dN(t-\\tau)\\right\\},\n$$\n其中 $\\mathbf{x}(t)$ 是关于 $\\mathcal{H}_t$ 可测的协变量，而尖峰历史项是与过去增量 $dN(t-\\tau)$ 的因果卷积。\n\nD. 在 bin 宽度为 $\\Delta>0$ 的离散时间近似中，一种用于在线更新的标准 GLM 处理方法将 $y_t = N(t+\\Delta)-N(t)$ 视为条件泊松分布，其均值为 $\\mathbb{E}[y_t \\mid \\mathcal{H}_t] = \\lambda(t \\mid \\mathcal{H}_t)$，且该均值不依赖于 $\\Delta$。\n\nE. 在短时间窗 $\\Delta$ 的离散时间近似下，用于递归更新的每个时间窗的对数似然贡献为\n$$\n\\ell_t \\;=\\; y_t \\log\\!\\big(\\lambda(t \\mid \\mathcal{H}_t)\\,\\Delta\\big) \\;-\\; \\lambda(t \\mid \\mathcal{H}_t)\\,\\Delta \\;-\\; \\log(y_t!),\n$$\n这与 $y_t$ 的泊松观测模型一致。\n\nF. 为确保闭环操作的稳定性并模拟不应期，应使用一个将强度上限设为1的连接函数，例如选择一个负指数连接，从而使得 $0 \\le \\lambda(t \\mid \\mathcal{H}_t) \\le 1$ 恒成立；这可以避免出现不符合物理实际的过大发放率。\n\n选择所有适用的选项。",
            "solution": "问题陈述描述了一种在实时闭环BCI设置中使用点过程广义线性模型（GLM）对神经尖峰序列进行建模的标准且有效的方法。给定条件陈述清晰且科学上合理。\n\n### 步骤 1：提取给定条件\n- **系统：** 实时闭环脑机接口（BCI）。\n- **数据来源：** 单个通道的胞外尖峰序列。\n- **计数过程：** $N(t)$ 表示到时间 $t$ 为止的尖峰数量。\n- **历史（信息流）：** $\\mathcal{H}_t$ 表示由 $\\{N(s): 0 \\le s \\le t\\}$ 以及到时间 $t$ 为止任何因果可用的协变量生成的历史。\n- **建模框架：** 采用点过程公式的广义线性模型（GLM）框架。\n- **假设分布：** 模型假设短时间区间内的尖峰发放概率服从泊松观测，以实现在线参数更新。\n- **连接函数：** 问题提到“典则连接”。\n- **条件强度函数, $\\lambda(t \\mid \\mathcal{H}_t)$：** 旨在表征给定过去历史的瞬时尖峰发放倾向。\n- **GLM 目的：** 通过一个连接函数将观测值的均值与线性预测子关联起来，确保强度的非负性并遵循因果性。\n\n### 步骤 2：使用提取的给定条件进行验证\n问题陈述是有科学依据、良定且客观的。使用点过程GLM对尖峰序列进行建模是现代计算神经科学的基石，并直接适用于BCI解码。对各组成部分（$N(t)$、$\\mathcal{H}_t$、$\\lambda(t \\mid \\mathcal{H}_t)$）和建模目标（实时更新、因果性、非负性）的描述是标准的，且与既有理论一致。问题不包含科学或逻辑上的矛盾，给出了足够的细节，并要求评估关于这个标准框架的陈述。\n\n### 步骤 3：结论与行动\n问题是有效的。解题过程将基于点过程和GLM的原理逐一分析每个选项。\n\n### 逐项分析\n\n**A. 条件强度函数定义为 $\\lambda(t \\mid \\mathcal{H}_t) \\equiv \\lim_{\\Delta \\to 0^+} \\frac{\\Pr\\left(N(t+\\Delta)-N(t)=1 \\mid \\mathcal{H}_t\\right)}{\\Delta}$，假设 $\\Pr\\left(N(t+\\Delta)-N(t)\\ge 2 \\mid \\mathcal{H}_t\\right) = o(\\Delta)$。**\n\n该陈述给出了有序点过程的条件强度函数 $\\lambda(t \\mid \\mathcal{H}_t)$ 的形式化定义。该函数表示在给定历史 $\\mathcal{H}_t$ 的条件下，在时间 $t$ 事件发生的瞬时速率。该定义建立在无穷小区间 $[t, t+\\Delta)$ 内观测到恰好一个事件的概率之上。条件 $\\Pr(N(t+\\Delta)-N(t)\\ge 2 \\mid \\mathcal{H}_t) = o(\\Delta)$ 指明该过程是“有序”或“正则”的，意味着在无穷小区间内发生两次或更多次尖峰的概率相较于发生一次尖峰的概率可以忽略不计。这是对神经尖峰序列建模的标准假设，因为单个神经元不可能同时产生多个尖峰。此定义是点过程理论的基本原理。\n\n**结论：正确。**\n\n**B. 在具有典则连接的泊松GLM中，线性预测子 $\\eta(t)$ 与条件强度之间的关系是恒等映射，即 $\\lambda(t \\mid \\mathcal{H}_t) = \\eta(t)$，因为泊松观测的典则连接是恒等连接。**\n\n该陈述是错误的。对于指数族分布的成员，典则连接函数是将均值参数映射到自然参数的函数。对于均值为 $\\mu$ 的泊松分布，其概率质量函数为 $P(y;\\mu) = \\frac{\\mu^y e^{-\\mu}}{y!} = \\exp(y\\log(\\mu) - \\mu - \\log(y!))$。自然参数是充分统计量 $y$ 的系数，即 $\\log(\\mu)$。因此，典则连接函数是对数函数 $g(\\mu) = \\log(\\mu)$。在点过程GLM的背景下，需要建模的均值是强度 $\\lambda(t \\mid \\mathcal{H}_t)$（或在离散时间情况下与其成正比的量）。关系式是 $g(\\lambda) = \\eta$，对于典则连接，这变成 $\\log(\\lambda(t \\mid \\mathcal{H}_t)) = \\eta(t)$。因此，逆连接函数是指数函数，$\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\eta(t))$。该陈述错误地声称典则连接是恒等连接。虽然可以使用恒等连接，但它不是典則连接，并且对于无约束的线性预测子 $\\eta(t)$，它无法强制 $\\lambda$ 的非负性。\n\n**结论：错误。**\n\n**C. 针对尖峰序列的因果点过程GLM可以表示为一个带有依赖于协变量和尖峰历史的线性预测子，并使用指数连接来强制非负性，例如 $\\lambda(t \\mid \\mathcal{H}_t) \\;=\\; \\exp\\!\\left\\{\\beta_0 \\;+\\; \\mathbf{k}^\\top \\mathbf{x}(t) \\;+\\; \\int_{0^+}^{\\infty} h(\\tau)\\, dN(t-\\tau)\\right\\}$，其中 $\\mathbf{x}(t)$ 是关于 $\\mathcal{H}_t$ 可测的协变量，而尖峰历史项是与过去增量 $dN(t-\\tau)$ 的因果卷积。**\n\n该陈述准确地描述了神经尖峰序列的点过程GLM的一种标准且强大的公式。\n- 使用指数函数作为逆连接函数，$\\lambda = \\exp(\\eta)$，对应于使用典则对数连接。这正确地确保了强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 始终为非负，因为任何实值线性预测子 $\\eta(t)$ 的指数都是正的。\n- 线性预测子 $\\eta(t)$（指数的参数）被正确地表述为各项之和：一个基线对数发放率 $\\beta_0$；一个用于外部协变量（如感觉刺激或运动变量）的项 $\\mathbf{k}^\\top \\mathbf{x}(t)$，这些协变量在时间 $t$ 之前是已知的；以及一个尖峰历史项。\n- 尖峰历史项 $\\int_{0^+}^{\\infty} h(\\tau)\\, dN(t-\\tau)$ 是一个斯蒂尔杰斯积分，表示应用于过去尖峰序列的线性滤波器。它对与过去尖峰对应的时刻 $\\tau$ 的滤波器函数 $h(\\tau)$ 的贡献求和。积分下限 $0^+$ 确保了严格的因果性，因为只有在时间 $t$ 之前发生的尖峰才被包括在内。这一项可以模拟不应期和簇发放等现象。整个结构是因果的，并且是一种标准实现。\n\n**结论：正确。**\n\n**D. 在 bin 宽度为 $\\Delta>0$ 的离散时间近似中，一种用于在线更新的标准 GLM 处理方法将 $y_t = N(t+\\Delta)-N(t)$ 视为条件泊松分布，其均值为 $\\mathbb{E}[y_t \\mid \\mathcal{H}_t] = \\lambda(t \\mid \\mathcal{H}_t)$，且该均值不依赖于 $\\Delta$。**\n\n该陈述由于维度不一致而错误。条件强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 的单位是速率（例如，尖峰数/秒）。变量 $y_t = N(t+\\Delta)-N(t)$ 表示在持续时间为 $\\Delta$ 的时间窗内的尖峰计数，这是一个无量纲量。该计数的期望值 $\\mathbb{E}[y_t \\mid \\mathcal{H}_t]$ 也必须是无量纲的。对于一个小的bin宽度 $\\Delta$，其中强度可以被假定为近似恒定，bin中的预期尖峰数是速率乘以bin的持续时间。因此，正确的关系是 $\\mathbb{E}[y_t \\mid \\mathcal{H}_t] \\approx \\lambda(t \\mid \\mathcal{H}_t) \\Delta$。尖峰计数的均值与bin宽度 $\\Delta$ 成正比。该陈述错误地将平均计数等同于强度，并错误地声称它不依赖于 $\\Delta$。\n\n**结论：错误。**\n\n**E. 在短时间窗 $\\Delta$ 的离散时间近似下，用于递归更新的每个时间窗的对数似然贡献为 $\\ell_t \\;=\\; y_t \\log\\!\\big(\\lambda(t \\mid \\mathcal{H}_t)\\,\\Delta\\big) \\;-\\; \\lambda(t \\mid \\mathcal{H}_t)\\,\\Delta \\;-\\; \\log(y_t!)$，这与 $y_t$ 的泊松观测模型一致。**\n\n该陈述正确地阐述了离散化点过程的对数似然。如选项D的分析所示，在具有小bin宽度 $\\Delta$ 的离散时间近似中，bin中的尖峰计数 $y_t$ 被建模为均值为 $\\mu_t \\approx \\lambda(t \\mid \\mathcal{H}_t) \\Delta$ 的泊松随机变量。均值为 $\\mu$ 的泊松随机变量 $y$ 的概率质量函数是 $P(y; \\mu) = \\frac{\\mu^y e^{-\\mu}}{y!}$。对数似然 $\\ell$ 是该概率的对数：$\\ell = y \\log(\\mu) - \\mu - \\log(y!)$。代入 $y=y_t$ 和均值的近似值 $\\mu = \\mu_t \\approx \\lambda(t \\mid \\mathcal{H}_t) \\Delta$，我们得到每个bin的对数似然贡献的表达式：\n$\\ell_t \\approx y_t \\log(\\lambda(t \\mid \\mathcal{H}_t)\\Delta) - \\lambda(t \\mid \\mathcal{H}_t)\\Delta - \\log(y_t!)$。这个表达式与选项中给出的完全一致。这是在诸如最大似然估计或用于在线参数更新的递归贝叶斯滤波等估计过程中，用于时间步 $t$ 的正确的目标函数项。\n\n**结论：正确。**\n\n**F. 为确保闭环操作的稳定性并模拟不应期，应使用一个将强度上限设为1的连接函数，例如选择一个负指数连接，从而使得 $0 \\le \\lambda(t \\mid \\mathcal{H}_t) \\le 1$ 恒成立；这可以避免出现不符合物理实际的过大发放率。**\n\n该陈述存在根本性缺陷。首先，强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 是一个速率，而不是概率，其单位是 $[时间]^{-1}$。没有任何物理原理将其值限制在小于或等于1，除非时间单位被特别选择为对应于最小峰间期，而这一点并未说明。神经元的放电速率可以远超1 Hz（例如，100 Hz或更高）。将强度限制在像1这样的任意值是不符合物理实际的。其次，不应期通常不是通过改变连接函数来建模的。如选项C所示，它可以通过线性预测子 $\\eta(t)$ 中的尖峰历史滤波器 $h(\\tau)$ 来正确和灵活地建模；对于小的 $\\tau$，$h(\\tau)$ 的负值会在一次尖峰后降低 $\\eta(t)$，从而降低 $\\lambda(t \\mid \\mathcal{H}_t)$。第三，“负指数连接”这个术语是非标准的且含糊不清的。第四，虽然稳定性在闭环系统中是一个需要关注的问题，但这种提出的机制既非标准也未必有效。稳定性是整个反馈回路动力学的一个属性，应通过恰当设计依赖于历史的项以及可能的协变量反馈来解决，而不是通过任意地将强度上限设为1来解决。\n\n**结论：错误。**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}