{
    "hands_on_practices": [
        {
            "introduction": "量子计量学的核心思想是利用纠缠等量子现象来提升测量精度。本练习将通过比较“类经典”探针（自旋相干态）和经过量子工程改造的探针（自旋压缩态），来深入探讨这一概念。此练习旨在引导您使用量子费雪信息（Quantum Fisher Information, QFI）这一核心工具，来量化由量子关联带来的性能增益。",
            "id": "4238205",
            "problem": "一个信息物理系统 (CPS) 的数字孪生集成了一个集体自旋量子传感器，该传感器由$N$个相同的自旋$1/2$粒子组成，用于追踪一个由与$z$轴对齐的弱时变磁场引起的动态旋转角$\\phi$。参数$\\phi$由集体自旋算符$J_z$生成的酉算符$U(\\phi)$编码，系统在小角度范围内进行探测，此时线性响应分析有效。\n\n假设初始探测态是沿$x$轴极化的自旋相干态。然后，考虑用一个纯高斯自旋压缩态替换此探测态，该压缩态在$x$方向上保持较大的平均自旋，其压缩分量沿$y$方向，并且饱和了$y$和$z$集体自旋分量之间的$\\mathrm{SU}(2)$最小不确定性关系。压缩由温兰德（Wineland）参数$\\xi^2$表征，对于此类态，其定义为\n$$\n\\xi^2 \\equiv \\frac{N \\left(\\Delta J_y\\right)^2}{\\left|\\langle J_x \\rangle\\right|^2}.\n$$\n\n从纯态在酉参数编码下的量子费希尔信息 (QFI) 的基本定义出发，并利用$\\mathrm{SU}(2)$对易关系，推导：\n1. 自旋相干态探针在围绕$z$轴的小角度旋转下的QFI $F_Q$。\n2. 自旋压缩态探针在相同编码下的QFI $F_Q$，用$\\xi^2$和$N$在最小不确定性条件下表示。\n3. 定义为自旋压缩态QFI与自旋相干态QFI之比的计量增益$G$。\n\n将您的最终答案表示为仅含$\\xi^2$的单个闭式解析表达式。最终答案无需数值四舍五入，也无需报告单位。",
            "solution": "该问题要求计算使用自旋压缩态替代自旋相干态来传感小角度旋转所获得的计量增益$G$。该增益定义为相应量子费希尔信息 (QFI) 的比值。\n\n对于一个纯探测态$|\\psi\\rangle$，在酉参数编码$U(\\phi) = \\exp(-i\\phi K)$下，QFI ($F_Q$) 的基本公式由生成元$K$在该态$|\\psi\\rangle$下的方差给出：\n$$F_Q = 4 (\\Delta K)^2_{|\\psi\\rangle} = 4 \\left( \\langle K^2 \\rangle - \\langle K \\rangle^2 \\right)$$\n在当前问题中，旋转角$\\phi$通过集体自旋算符$J_z$生成的酉算符$U(\\phi)$进行编码。因此，生成元是$K=J_z$。我们可以设定约化普朗克常数$\\hbar=1$，这是量子信息论中的常规做法，并注意到任何对$\\hbar$的依赖性在最终的比值$G$中都会被抵消。因此，对于任何纯探测态$|\\psi\\rangle$，其QFI为：\n$$F_Q = 4 (\\Delta J_z)^2_{|\\psi\\rangle}$$\n因此，问题简化为计算指定两种探测态下$J_z$算符的方差。该系统由$N$个自旋1/2粒子组成，总自旋量子数为$J=N/2$。集体自旋算符$J_x$、$J_y$和$J_z$遵循$\\mathrm{SU}(2)$对易关系，特别是$[J_y, J_z] = i J_x$。\n\n首先，我们求解自旋相干态 (SCS) 的QFI，我们将其表示为$|\\psi_{SCS}\\rangle$。问题指出这是一个沿$x$轴极化的SCS。对于这样的态，自旋分量的期望值为$\\langle J_x \\rangle = J = N/2$，$\\langle J_y \\rangle = 0$以及$\\langle J_z \\rangle = 0$。SCS是一个最小不确定性态，意味着它饱和了正交分量的海森堡不确定性原理。$J_y$和$J_z$的一般不确定性关系为：\n$$(\\Delta J_y)^2 (\\Delta J_z)^2 \\ge \\frac{1}{4}|\\langle[J_y, J_z]\\rangle|^2 = \\frac{1}{4}|\\langle i J_x \\rangle|^2 = \\frac{1}{4} \\langle J_x \\rangle^2$$\n对于SCS，量子噪声在垂直于平均自旋方向的平面内是各向同性分布的。对于一个沿$x$轴极化的SCS，这意味着$(\\Delta J_y)^2 = (\\Delta J_z)^2$。将其与不确定性关系的饱和条件相结合，我们得到：\n$$(\\Delta J_z)^2 \\cdot (\\Delta J_z)^2 = (\\Delta J_z)^4 = \\frac{1}{4} \\langle J_x \\rangle^2$$\n取平方根并代入$\\langle J_x \\rangle = J = N/2$的值：\n$$(\\Delta J_z)^2 = \\frac{1}{2} |\\langle J_x \\rangle| = \\frac{1}{2} J = \\frac{1}{2} \\left(\\frac{N}{2}\\right) = \\frac{N}{4}$$\n现在我们可以计算SCS探针的QFI：\n$$F_{Q, SCS} = 4 (\\Delta J_z)^2_{|\\psi_{SCS}\\rangle} = 4 \\left( \\frac{N}{4} \\right) = N$$\n这个值$N$对应于$N$个不相关粒子的标准量子极限 (SQL)。\n\n其次，我们分析自旋压缩态 (SSS)，记作$|\\psi_{SSS}\\rangle$。该态也具有沿$x$轴的较大平均自旋，对此我们可以使用近似$\\langle J_x \\rangle \\approx J = N/2$，这对于大$N$是高度准确的。问题指明该态饱和了$J_y$和$J_z$的$\\mathrm{SU}(2)$最小不确定性关系：\n$$(\\Delta J_y)^2 (\\Delta J_z)^2 = \\frac{1}{4} \\langle J_x \\rangle^2$$\n我们的目标是求出$(\\Delta J_z)^2$以计算$F_{Q, SSS}$。从最小不确定性关系，我们可以将反压缩方差$(\\Delta J_z)^2$表示为：\n$$(\\Delta J_z)^2 = \\frac{\\langle J_x \\rangle^2}{4 (\\Delta J_y)^2}$$\n问题给出了此状态的温兰德（Wineland）压缩参数$\\xi^2$的定义：\n$$\\xi^2 \\equiv \\frac{N (\\Delta J_y)^2}{|\\langle J_x \\rangle|^2}$$\n为了使一个态沿$y$分量被压缩，其方差必须小于SCS的方差，即$(\\Delta J_y)^2  N/4$，这对应于$\\xi^2  1$。我们可以重新整理$\\xi^2$的定义来表示压缩方差$(\\Delta J_y)^2$：\n$$(\\Delta J_y)^2 = \\frac{\\xi^2 |\\langle J_x \\rangle|^2}{N}$$\n现在，我们将此表达式代入$(\\Delta J_z)^2$的方程中：\n$$(\\Delta J_z)^2 = \\frac{\\langle J_x \\rangle^2}{4 \\left( \\frac{\\xi^2 |\\langle J_x \\rangle|^2}{N} \\right)} = \\frac{\\langle J_x \\rangle^2 N}{4 \\xi^2 |\\langle J_x \\rangle|^2} = \\frac{N}{4\\xi^2}$$\n因此，自旋压缩态的QFI为：\n$$F_{Q, SSS} = 4 (\\Delta J_z)^2_{|\\psi_{SSS}\\rangle} = 4 \\left( \\frac{N}{4\\xi^2} \\right) = \\frac{N}{\\xi^2}$$\n\n最后，我们计算计量增益$G$，它被定义为SSS的QFI与SCS的QFI之比：\n$$G = \\frac{F_{Q, SSS}}{F_{Q, SCS}}$$\n代入我们推导出的$F_{Q, SSS}$和$F_{Q, SCS}$的表达式：\n$$G = \\frac{N/\\xi^2}{N} = \\frac{1}{\\xi^2}$$\n这个增益$G$的表达式仅依赖于压缩参数$\\xi^2$，正如问题陈述所要求的那样。",
            "answer": "$$\\boxed{\\frac{1}{\\xi^{2}}}$$"
        },
        {
            "introduction": "在理解了量子优势的理论潜力之后，本练习将这些概念应用于一个具体的、功能强大的设备：原子干涉仪。您将对一个在许多信息物理系统中都至关重要的加速度计进行建模。这项任务包括推导其响应函数，同时考虑有限对比度等现实世界中的不完美之处，并最终计算其对加速度的灵敏度。",
            "id": "4238154",
            "problem": "一个光脉冲原子干涉加速度计被集成到一个信息物理系统 (CPS) 中，该系统的数字孪生使用传感器的输出来持续估计平台加速度。该干涉仪通过一个$\\pi/2$–$\\pi$–$\\pi/2$拉曼脉冲序列和反向传播的光束来实现。两条干涉仪输出路径重新组合成相干概率幅，其探测到的跃迁概率由Born定则确定。有限对比度源于退相干和损耗机制，这使得干涉条纹的可见度降低到单位1以下。\n\n从“探测到的跃迁概率与两个相对相位为 $\\phi$ 的等幅复振幅的相干和的模平方成正比”这一原理出发，推导当干涉仪具有有限对比度时，跃迁概率作为 $\\phi$ 的函数的函数形式。显式地引入一个对比度参数 $\\mathcal{C}$（$0 \\leq \\mathcal{C} \\leq 1$），并假设路径强度相等且为平衡探测，从而使得概率的直流 (DC) 偏置关于 $1/2$ 对称。干涉仪相位以弧度为单位。\n\n假设信息物理系统中的反馈维持半条纹操作，因此工作点满足 $\\phi = (2n+1)\\pi/2$，其中 $n$ 为某个整数。使用链式法则，用有限对比度和相位响应 $|\\partial \\phi / \\partial a|$ 表示跃迁概率相对于加速度的斜率的绝对值 $|\\partial P / \\partial a|$。\n\n对于该光脉冲原子干涉仪，设相位对加速度的依赖关系为 $\\phi(a) = k_{\\mathrm{eff}} a T^{2} + \\phi_{0}$，其中 $k_{\\mathrm{eff}}$ 是双光子拉曼跃迁的有效波矢，$T$ 是脉冲分离时间，$\\phi_{0}$ 是由反馈控制的恒定相位偏置。对于波长为 $\\lambda$ 的反向传播光束，有效波矢为 $k_{\\mathrm{eff}} = 4\\pi / \\lambda$。\n\n探测噪声主要由白色技术噪声和量子投影噪声主导，导致测量的概率具有 $\\sigma_{P}$ 的单次测量标准差。假设噪声不相关且处于半条纹操作，单次测量加速度灵敏度为 $\\sigma_{a} = \\sigma_{P} / |\\partial P / \\partial a|$。\n\n根据以下参数数值计算 $\\sigma_{a}$：\n- 波长 $\\lambda = 780\\ \\mathrm{nm}$，\n- 脉冲分离时间 $T = 50\\ \\mathrm{ms}$，\n- 对比度 $\\mathcal{C} = 0.30$，\n- 概率噪声标准差 $\\sigma_{P} = 2.0 \\times 10^{-3}$。\n\n将最终灵敏度以 $\\mathrm{m\\,s^{-2}}$ 为单位表示，并将答案四舍五入到三位有效数字。在整个计算过程中，相位均以弧度处理。",
            "solution": "求解过程包括三个主要部分：\n1.  推导跃迁概率 $P(\\phi)$ 作为干涉仪相位 $\\phi$ 和对比度 $\\mathcal{C}$ 的函数形式。\n2.  用系统参数表示概率对加速度的灵敏度 $|\\partial P / \\partial a|$。\n3.  使用给定的数值计算单次测量加速度灵敏度 $\\sigma_{a}$。\n\n首先，我们推导跃迁概率 $P(\\phi)$ 的函数形式。一个分束相等的理想双路径干涉仪将产生一个在0和1之间变化的概率。经过 $\\pi/2$–$\\pi$–$\\pi/2$ 序列后，原子跃迁到第二个内态的概率由 $P_{\\mathrm{ideal}}(\\phi) = \\sin^2(\\phi/2) = \\frac{1}{2}(1 - \\cos\\phi)$ 给出，其中 $\\phi$ 是两条干涉仪路径之间累积的相对相位。这种形式具有最大对比度，即 $\\mathcal{C}=1$。\n\n有限对比度源于退相干和其他实验不完美性。我们可以通过以下方式对此进行建模：假设原子系综中等于对比度 $\\mathcal{C}$ 的部分会完美干涉，而剩余的 $(1-\\mathcal{C})$ 部分不发生干涉，并贡献一个恒定的平均概率。对于一个二能级系统，这个不发生干涉的部分贡献了 $1/2$ 的跃迁概率。总概率 $P(\\phi)$ 是这两部分贡献的加权和：\n$$P(\\phi) = \\mathcal{C} \\cdot P_{\\mathrm{ideal}}(\\phi) + (1-\\mathcal{C}) \\cdot \\frac{1}{2}$$\n代入 $P_{\\mathrm{ideal}}(\\phi)$ 的表达式：\n$$P(\\phi) = \\mathcal{C} \\left[ \\frac{1}{2}(1 - \\cos\\phi) \\right] + \\frac{1-\\mathcal{C}}{2} = \\frac{\\mathcal{C}}{2} - \\frac{\\mathcal{C}}{2}\\cos\\phi + \\frac{1}{2} - \\frac{\\mathcal{C}}{2} = \\frac{1}{2} - \\frac{\\mathcal{C}}{2}\\cos\\phi$$\n这可以写成：\n$$P(\\phi) = \\frac{1}{2}(1 - \\mathcal{C}\\cos\\phi)$$\n让我们根据问题的约束条件来验证此形式。最小和最大概率为：\n$$P_{\\mathrm{min}} = P(\\phi=0) = \\frac{1}{2}(1 - \\mathcal{C})$$\n$$P_{\\mathrm{max}} = P(\\phi=\\pi) = \\frac{1}{2}(1 + \\mathcal{C})$$\n直流偏置，即平均概率，为 $\\frac{P_{\\mathrm{max}} + P_{\\mathrm{min}}}{2} = \\frac{1/2(1+\\mathcal{C}) + 1/2(1-\\mathcal{C})}{2} = \\frac{1}{2}$。这满足直流偏置关于 $1/2$ 对称的条件。对比度定义为 $\\frac{P_{\\mathrm{max}} - P_{\\mathrm{min}}}{P_{\\mathrm{max}} + P_{\\mathrm{min}}} = \\frac{1/2(1+\\mathcal{C}) - 1/2(1-\\mathcal{C})}{1/2(1+\\mathcal{C}) + 1/2(1-\\mathcal{C})} = \\frac{\\mathcal{C}}{1} = \\mathcal{C}$，这也是一致的。因此，推导出的函数形式是正确的。\n\n第二，我们求跃迁概率相对于加速度的斜率的绝对值 $|\\partial P / \\partial a|$。我们使用链式法则：\n$$\\frac{\\partial P}{\\partial a} = \\frac{\\partial P}{\\partial \\phi} \\frac{\\partial \\phi}{\\partial a}$$\n我们首先计算 $P$ 相对于 $\\phi$ 的导数：\n$$\\frac{\\partial P}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left[ \\frac{1}{2}(1 - \\mathcal{C}\\cos\\phi) \\right] = -\\frac{\\mathcal{C}}{2}(-\\sin\\phi) = \\frac{\\mathcal{C}}{2}\\sin\\phi$$\n系统在半条纹处操作，此时相位为 $\\phi = (2n+1)\\pi/2$，其中 $n$ 为某个整数。在此工作点，正弦函数的计算结果为：\n$$\\sin\\left((2n+1)\\frac{\\pi}{2}\\right) = \\sin\\left(n\\pi + \\frac{\\pi}{2}\\right) = (-1)^n$$\n因此，工作点处的斜率为 $\\frac{\\partial P}{\\partial \\phi} = \\frac{\\mathcal{C}}{2}(-1)^n$。此斜率的绝对值为：\n$$\\left|\\frac{\\partial P}{\\partial \\phi}\\right| = \\left|\\frac{\\mathcal{C}}{2}(-1)^n\\right| = \\frac{\\mathcal{C}}{2}$$\n现在，我们可以表示相对于加速度的斜率的绝对值：\n$$\\left|\\frac{\\partial P}{\\partial a}\\right| = \\left|\\frac{\\partial P}{\\partial \\phi}\\right| \\left|\\frac{\\partial \\phi}{\\partial a}\\right| = \\frac{\\mathcal{C}}{2} \\left|\\frac{\\partial \\phi}{\\partial a}\\right|$$\n\n第三，我们评估单次测量加速度灵敏度 $\\sigma_{a}$。问题提供了以下公式：\n$$\\sigma_{a} = \\frac{\\sigma_{P}}{\\left|\\frac{\\partial P}{\\partial a}\\right|}$$\n代入我们得到的 $|\\partial P / \\partial a|$ 的表达式：\n$$\\sigma_{a} = \\frac{\\sigma_{P}}{\\frac{\\mathcal{C}}{2} \\left|\\frac{\\partial \\phi}{\\partial a}\\right|} = \\frac{2\\sigma_{P}}{\\mathcal{C} \\left|\\frac{\\partial \\phi}{\\partial a}\\right|}$$\n相位对加速度的依赖关系给出为 $\\phi(a) = k_{\\mathrm{eff}} a T^{2} + \\phi_{0}$。对 $a$ 求导：\n$$\\frac{\\partial \\phi}{\\partial a} = k_{\\mathrm{eff}} T^{2}$$\n由于 $k_{\\mathrm{eff}}$ 和 $T$ 均为正量，因此 $|\\partial \\phi / \\partial a| = k_{\\mathrm{eff}} T^{2}$。灵敏度的表达式变为：\n$$\\sigma_{a} = \\frac{2\\sigma_{P}}{\\mathcal{C} k_{\\mathrm{eff}} T^{2}}$$\n给定 $k_{\\mathrm{eff}} = 4\\pi / \\lambda$。代入此式可得 $\\sigma_{a}$ 的最终符号表达式：\n$$\\sigma_{a} = \\frac{2\\sigma_{P}}{\\mathcal{C} \\left(\\frac{4\\pi}{\\lambda}\\right) T^{2}} = \\frac{2\\sigma_{P}\\lambda}{4\\pi\\mathcal{C}T^{2}} = \\frac{\\sigma_{P}\\lambda}{2\\pi\\mathcal{C}T^{2}}$$\n现在我们将给定的数值代入此表达式。这些值必须使用SI基本单位。\n- $\\sigma_{P} = 2.0 \\times 10^{-3}$\n- $\\lambda = 780\\ \\mathrm{nm} = 780 \\times 10^{-9}\\ \\mathrm{m}$\n- $\\mathcal{C} = 0.30$\n- $T = 50\\ \\mathrm{ms} = 50 \\times 10^{-3}\\ \\mathrm{s} = 0.05\\ \\mathrm{s}$\n\n计算过程如下：\n$$\\sigma_{a} = \\frac{(2.0 \\times 10^{-3})(780 \\times 10^{-9}\\ \\mathrm{m})}{2\\pi (0.30) (0.05\\ \\mathrm{s})^{2}}$$\n$$\\sigma_{a} = \\frac{1.56 \\times 10^{-9}\\ \\mathrm{m}}{2\\pi (0.30) (0.0025\\ \\mathrm{s}^{2})}$$\n$$\\sigma_{a} = \\frac{1.56 \\times 10^{-9}\\ \\mathrm{m}}{2\\pi (7.5 \\times 10^{-4}\\ \\mathrm{s}^{2})}$$\n$$\\sigma_{a} = \\frac{1.56 \\times 10^{-9}}{0.00471238...}\\ \\mathrm{m\\,s^{-2}}$$\n$$\\sigma_{a} \\approx 3.31042 \\times 10^{-7}\\ \\mathrm{m\\,s^{-2}}$$\n将结果四舍五入到三位有效数字，我们得到 $3.31 \\times 10^{-7}\\ \\mathrm{m\\,s^{-2}}$。",
            "answer": "$$\\boxed{3.31 \\times 10^{-7}}$$"
        },
        {
            "introduction": "传感器的工作在产生信号后并未结束；信号数据必须得到正确解译，这对于数字孪生尤其重要。本练习将探讨关键的数据处理步骤。您将研究当传感器噪声存在时间相关性时——这是一个常见且具有挑战性的场景——如何从数据中提取关于被测量的最大信息。",
            "id": "4238223",
            "problem": "一个信息物理系统（Cyber-Physical System, CPS）中的量子传感器任务是估计一个恒定的磁场振幅，该振幅用 $b$ 表示，单位为 $\\mathrm{T}$（特斯拉）。该系统使用一个数字孪生（Digital Twin, DT）来对重复测量中的传感器读数进行建模，以评估估计性能。读出模型为加性高斯观测模型 $y_k = b + \\epsilon_k$，其中 $k = 1,2,\\dots,N$，噪声向量 $\\boldsymbol{\\epsilon} = (\\epsilon_1,\\dots,\\epsilon_N)$ 是一个零均值高斯随机向量，其平稳协方差矩阵 $\\Sigma_N$ 捕捉了时间相关噪声。该协方差具体表示为 $[\\Sigma_N]_{ij} = \\sigma^2 \\rho^{|i-j|}$，其中 $\\sigma  0$ 是传感器噪声的标准差，单位为 $\\mathrm{T}$，而 $\\rho \\in (-1,1)$ 是滞后一阶相关系数。在一个具有指数衰减时间相关性的物理模型中，相关系数通过采样间隔 $ \\tau  0$（单位为 $\\mathrm{s}$）和相关时间 $ \\tau_c  0$（单位为 $\\mathrm{s}$）参数化，即 $\\rho = e^{-\\tau / \\tau_c}$。\n\n从参数化概率密度函数 $p(\\boldsymbol{y} \\mid \\theta)$ 和加性高斯观测模型的定义出发，推导在上述相关噪声模型下参数 $b$ 的费雪信息 $I_N(b)$，并计算 $I_N(b)$ 如何随样本数 $N$ 变化。然后，实现一个算法来为给定的 $(N, \\sigma, \\rho)$ 或 $(N, \\sigma, \\tau, \\tau_c)$ 计算 $I_N(b)$，过程中若未推导则不得使用任何封闭形式的快捷表达式。最终的数值必须以 $1/\\mathrm{T}^2$（反平方特斯拉）为单位，表示为浮点数。\n\n您的程序必须为以下旨在测试不同情况的参数集测试用例计算 $I_N(b)$：\n- 情况 1：$N = 1$，$\\sigma = 10^{-3}\\ \\mathrm{T}$，$\\rho = 0.0$。\n- 情况 2：$N = 100$，$\\sigma = 10^{-3}\\ \\mathrm{T}$，$\\rho = 0.0$。\n- 情况 3：$N = 100$，$\\sigma = 10^{-3}\\ \\mathrm{T}$，$\\tau = 0.1\\ \\mathrm{s}$，$\\tau_c = 0.5\\ \\mathrm{s}$（使用 $\\rho = e^{-\\tau/\\tau_c}$）。\n- 情况 4：$N = 100$，$\\sigma = 10^{-3}\\ \\mathrm{T}$，$\\tau = 0.1\\ \\mathrm{s}$，$\\tau_c = 10.0\\ \\mathrm{s}$（使用 $\\rho = e^{-\\tau/\\tau_c}$）。\n- 情况 5：$N = 100$，$\\sigma = 10^{-3}\\ \\mathrm{T}$，$\\rho = -0.5$。\n- 情况 6：$N = 2$，$\\sigma = 2 \\times 10^{-2}\\ \\mathrm{T}$，$\\rho = 0.5$。\n\n对于每种情况，计算一个等于 $I_N(b)$ 的浮点数，单位为 $1/\\mathrm{T}^2$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与上述情况相同（例如，$[x_1,x_2,x_3,x_4,x_5,x_6]$），其中每个 $x_i$ 是对应情况计算出的费雪信息。",
            "solution": "### 推导过程\n\n**1. 费雪信息的推导**\n\n观测模型可以写成向量形式 $\\boldsymbol{y} = b\\boldsymbol{1} + \\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{1}$ 是一个 $N \\times 1$ 的全1列向量。由于 $\\boldsymbol{\\epsilon}$ 是一个均值为零、协方差为 $\\Sigma_N$ 的高斯向量，观测向量 $\\boldsymbol{y}$ 服从均值向量为 $\\boldsymbol{\\mu} = E[\\boldsymbol{y}] = b\\boldsymbol{1}$、协方差矩阵为 $\\Sigma_N$ 的多元高斯分布。由 $b$ 参数化的 $\\boldsymbol{y}$ 的概率密度函数（PDF）为：\n$$\np(\\boldsymbol{y} \\mid b) = \\frac{1}{(2\\pi)^{N/2} \\det(\\Sigma_N)^{1/2}} \\exp\\left( -\\frac{1}{2} (\\boldsymbol{y} - b\\boldsymbol{1})^T \\Sigma_N^{-1} (\\boldsymbol{y} - b\\boldsymbol{1}) \\right)\n$$\n参数 $b$ 的费雪信息定义为对数似然函数关于 $b$ 的二阶导数的负期望值：\n$$\nI_N(b) = -E\\left[ \\frac{\\partial^2}{\\partial b^2} \\ln p(\\boldsymbol{y} \\mid b) \\right]\n$$\n对数似然函数 $\\mathcal{L}(b) = \\ln p(\\boldsymbol{y} \\mid b)$ 为：\n$$\n\\mathcal{L}(b) = -\\frac{N}{2} \\ln(2\\pi) - \\frac{1}{2} \\ln(\\det(\\Sigma_N)) - \\frac{1}{2} (\\boldsymbol{y} - b\\boldsymbol{1})^T \\Sigma_N^{-1} (\\boldsymbol{y} - b\\boldsymbol{1})\n$$\n为了求费雪信息，我们计算 $\\mathcal{L}(b)$ 关于 $b$ 的一阶和二阶偏导数。前两项相对于 $b$ 是常数。我们重点关注二次项。\n$$\n\\frac{\\partial \\mathcal{L}(b)}{\\partial b} = -\\frac{1}{2} \\frac{\\partial}{\\partial b} \\left[ (\\boldsymbol{y}^T - b\\boldsymbol{1}^T) \\Sigma_N^{-1} (\\boldsymbol{y} - b\\boldsymbol{1}) \\right]\n$$\n使用二次型求导恒等式 $\\frac{\\partial}{\\partial x} (\\boldsymbol{a} - A\\boldsymbol{x})^T_i B (\\boldsymbol{a} - A\\boldsymbol{x}) = -2A^T B (\\boldsymbol{a}-A\\boldsymbol{x})$，其中 $\\boldsymbol{x}=b$, $A=\\boldsymbol{1}$, $\\boldsymbol{a}=\\boldsymbol{y}$, $B = \\Sigma_N^{-1}$，我们得到：\n$$\n\\frac{\\partial \\mathcal{L}(b)}{\\partial b} = - \\frac{1}{2} \\left[ -2 \\boldsymbol{1}^T \\Sigma_N^{-1} (\\boldsymbol{y} - b\\boldsymbol{1}) \\right] = \\boldsymbol{1}^T \\Sigma_N^{-1} (\\boldsymbol{y} - b\\boldsymbol{1}) = \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{y} - b (\\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1})\n$$\n二阶偏导数则为：\n$$\n\\frac{\\partial^2 \\mathcal{L}(b)}{\\partial b^2} = \\frac{\\partial}{\\partial b} \\left[ \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{y} - b (\\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}) \\right] = - \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}\n$$\n二阶导数是一个不依赖于观测向量 $\\boldsymbol{y}$ 的标量。因此，其期望值就是它本身：\n$$\nE\\left[ \\frac{\\partial^2 \\mathcal{L}(b)}{\\partial b^2} \\right] = - \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}\n$$\n将此结果代入费雪信息的定义，得到最终表达式：\n$$\nI_N(b) = - \\left( - \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1} \\right) = \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}\n$$\n这个基本结果表明，高斯噪声中恒定均值的费雪信息是逆协方差矩阵所有元素之和。\n\n**2. 随样本量 $N$ 的尺度分析**\n\n费雪信息 $I_N(b)$ 量化了 $N$ 个样本提供的关于参数 $b$ 的信息量。其随 $N$ 的变化关系揭示了估计精度如何随数据增多而提高。\n\n- **不相关噪声（$\\rho = 0$）**：在这种简单情况下，协方差矩阵是对角矩阵：$\\Sigma_N = \\sigma^2 I_N$，其中 $I_N$ 是 $N \\times N$ 的单位矩阵。其逆矩阵为 $\\Sigma_N^{-1} = \\frac{1}{\\sigma^2} I_N$。费雪信息为：\n$$\nI_N(b) = \\boldsymbol{1}^T \\left( \\frac{1}{\\sigma^2} I_N \\right) \\boldsymbol{1} = \\frac{1}{\\sigma^2} (\\boldsymbol{1}^T \\boldsymbol{1}) = \\frac{N}{\\sigma^2}\n$$\n对于不相关噪声，信息随样本数 $N$ 线性增长。\n\n- **相关噪声（$\\rho \\neq 0$）**：表达式 $I_N(b) = \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1} = \\frac{1}{\\sigma^2} \\boldsymbol{1}^T C_N^{-1} \\boldsymbol{1}$，其中 $[C_N]_{ij} = \\rho^{|i-j|}$，更为复杂。可以证明，对于大的 $N$ 和任意固定的 $\\rho \\in (-1, 1)$，信息与 $N$ 呈线性尺度关系：\n$$\nI_N(b) \\approx N \\left( \\frac{1-\\rho}{\\sigma^2(1+\\rho)} \\right) \\quad \\text{for } N \\gg 1\n$$\n这表明 $I_N(b)$ 在 $N$ 上是渐近线性的，但信息增益率关键取决于相关性 $\\rho$。\n    - 对于正相关（$\\rho  0$），因子 $\\frac{1-\\rho}{1+\\rho}  1$。这意味着 $I_N(b)$ 比不相关情况增长得慢。当 $\\rho \\to 1$（强相关）时，每个新样本的信息增益变得微不足道，总信息量趋于饱和。\n    - 对于负相关（$\\rho  0$），因子 $\\frac{1-\\rho}{1+\\rho}  1$。这意味着 $I_N(b)$ 比不相关情况增长得快。连续噪声项之间的反相关性提供了一种噪声消除机制，从而增加了每个样本的信息量。\n\n**3. 算法实现**\n\n推导出的公式 $I_N(b) = \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}$ 为算法提供了一条直接路径。通过数值实现此公式，而非使用求和本身的最终封闭形式表达式，遵守了不使用未推导的快捷方式的指令。\n\n对于参数 $(N, \\sigma, \\rho)$，算法流程如下：\n1.  **构建协方差矩阵 $\\Sigma_N$**：\n    - 协方差矩阵由 $[\\Sigma_N]_{ij} = \\sigma^2 \\rho^{|i-j|}$ 给出。\n    - 该矩阵具有托普利茨结构（Toeplitz structure）（沿对角线为常数）。可以通过定义其第一行或第一列来高效构建。第一行为 $[\\sigma^2 \\rho^0, \\sigma^2 \\rho^1, \\dots, \\sigma^2 \\rho^{N-1}]$。\n\n2.  **计算逆协方差矩阵 $\\Sigma_N^{-1}$**：\n    - 使用标准的数值线性代数库计算 $\\Sigma_N$ 的逆矩阵。\n\n3.  **计算费雪信息**：\n    - 如前所示，$I_N(b) = \\boldsymbol{1}^T \\Sigma_N^{-1} \\boldsymbol{1}$。这在数学上等同于矩阵 $\\Sigma_N^{-1}$ 中所有元素的总和。\n    - 最后一步是求计算出的逆矩阵的所有项之和。\n\n$N=1$ 时出现一个特殊情况。协方差“矩阵”是一个标量 $\\Sigma_1 = [\\sigma^2]$。其逆为 $\\Sigma_1^{-1} = [1/\\sigma^2]$。费雪信息为 $I_1(b) = 1 \\cdot (1/\\sigma^2) \\cdot 1 = 1/\\sigma^2$。这种情况可以直接处理。\n对于提供了 $\\tau$ 和 $\\tau_c$ 的情况，首先计算 $\\rho = e^{-\\tau/\\tau_c}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import toeplitz\n\ndef solve():\n    \"\"\"\n    Computes the Fisher information for estimating a constant magnetic field\n    amplitude from N measurements corrupted by correlated Gaussian noise.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_params = [\n        # Case 1: N=1, uncorrelated\n        {'N': 1, 'sigma': 1e-3, 'rho': 0.0},\n        # Case 2: N=100, uncorrelated\n        {'N': 100, 'sigma': 1e-3, 'rho': 0.0},\n        # Case 3: N=100, moderate positive correlation\n        {'N': 100, 'sigma': 1e-3, 'tau': 0.1, 'tau_c': 0.5},\n        # Case 4: N=100, strong positive correlation\n        {'N': 100, 'sigma': 1e-3, 'tau': 0.1, 'tau_c': 10.0},\n        # Case 5: N=100, negative correlation\n        {'N': 100, 'sigma': 1e-3, 'rho': -0.5},\n        # Case 6: N=2, moderate positive correlation\n        {'N': 2, 'sigma': 2e-2, 'rho': 0.5},\n    ]\n\n    results = []\n    for params in test_params:\n        N = params['N']\n        sigma = params['sigma']\n\n        if 'rho' in params:\n            rho = params['rho']\n        else:\n            tau = params['tau']\n            tau_c = params['tau_c']\n            rho = np.exp(-tau / tau_c)\n\n        # Handle N=1 case separately for clarity and efficiency.\n        # For a single measurement, I_1(b) = 1/sigma^2.\n        if N == 1:\n            fisher_info = 1.0 / sigma**2\n            results.append(fisher_info)\n            continue\n\n        # The algorithm is based on the derived formula: I_N(b) = 1^T * Sigma_N_inv * 1\n        \n        # 1. Construct the covariance matrix Sigma_N.\n        # Sigma_N has a Toeplitz structure, specified by its first row.\n        # Sigma_N[i,j] = sigma^2 * rho**|i-j|.\n        c_first_row = [rho**i for i in range(N)]\n        # The correlation matrix C_N has C_N[i,j] = rho**|i-j|.\n        C_N = toeplitz(c_first_row)\n        # The covariance matrix is Sigma_N = sigma^2 * C_N.\n        Sigma_N = sigma**2 * C_N\n\n        # 2. Invert the covariance matrix.\n        Sigma_N_inv = np.linalg.inv(Sigma_N)\n\n        # 3. Compute Fisher information, which is the sum of all elements\n        # in the inverse covariance matrix.\n        fisher_info = np.sum(Sigma_N_inv)\n        \n        results.append(fisher_info)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}