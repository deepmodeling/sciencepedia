{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个练习将解决频率稳定性这一基本挑战。你将模拟电力系统在遭受重大扰动（即与主电网脱离后的孤岛运行）时的响应。此问题要求你将系统建模为一个混合系统，它结合了发电机的连续动态和离散事件，这是信息物理系统（CPS）中的一个核心概念。通过实现并求解控制微分方程，你将亲身体验惯性、负荷阻尼和一次控制之间动态的相互作用。",
            "id": "4211450",
            "problem": "考虑一个大规模智能电网的聚合区域，该区域被建模为一个混合信息物理系统，具有两种离散模式：标称运行（并网）和孤岛模式（线路跳闸事件后）。由于联络线的瞬时断开，系统在时间 $t = 1\\ \\text{s}$ 时从标称运行模式转换到孤岛模式。目标是使用基于基础电力系统动力学的、有原则的连续时间模型，计算在一次频率下垂控制下的事件后频率轨迹。\n\n从代表该区域的等效发电机的摇摆方程入手。在区域功率基准上使用标幺值归一化，并包含频率相关的负荷阻尼。令 $H$ 表示以秒为单位的惯性常数，$f_0$ 表示以赫兹为单位的标称频率，$\\Delta f(t)$ 表示以赫兹为单位的频率偏差。令 $\\Delta P_m(t)$ 表示与事件前平衡状态相比的机械功率偏差（标幺值），令 $\\Delta P_e(t)$ 表示由于扰动和负荷频率效应引起的电功率偏差（标幺值）。假设负荷频率敏感度由线性阻尼系数 $D$（单位为标幺值功率/标幺值频率偏差）建模。假设一次控制由具有下垂系数 $R$（单位为标幺值频率/标幺值功率）和时间常数 $T_g$（以秒为单位）的一阶调速器实现。假设聚合电功率扰动是在 $t = 1\\ \\text{s}$ 时施加的一个等于损失的输入功率 $P_{\\text{step}}$（标幺值）的阶跃增量，即 $\\Delta P_e(t)$ 在 $t = 1\\ \\text{s}$ 时包含一个大小为 $P_{\\text{step}}$ 的阶跃，代表孤岛化。\n\n您必须推导、实现并仿真以下条件所产生的连续动态过程：\n- 摇摆方程和功率平衡守恒，以及\n- 具有一阶执行器模型的调速器下垂定律。\n\n混合开关定义如下：\n- 对于 $0 \\le t  1\\ \\text{s}$（标称运行模式），$\\Delta P_e(t) = 0$，系统处于平衡状态，$\\Delta f(0) = 0$ 且 $\\Delta P_m(0) = 0$。\n- 对于 $t \\ge 1\\ \\text{s}$（孤岛模式），$\\Delta P_e(t) = P_{\\text{step}}$，即有效电功率需求增加，其量等于损失的输入功率。\n\n仅使用这些基本原理和定义，为状态量 $\\Delta f(t)$（单位：赫兹）和 $\\Delta P_m(t)$（单位：标幺值）建立在连续时间内的最小闭合常微分方程组，该方程组对所有 $t \\ge 0$ 均有效，并采用上述定义的混合激励 $\\Delta P_e(t)$。对下述测试套件中的每组参数，在有限时间域 $[0, T_{\\text{end}}]$ 上对所得系统进行数值积分。数值积分方法不作规定；您可以使用任何适用于刚性或非刚性系统的标准方法。$t = 1\\ \\text{s}$ 处的离散事件必须作为模式切换在激励项中被精确执行。\n\n对于每个测试用例，计算以下两个标量性能指标，以赫兹表示：\n1. 事件后的频率最低点，定义为 $\\min_{t \\in [1\\ \\text{s}, T_{\\text{end}}]} \\left(f_0 + \\Delta f(t)\\right)$，单位为赫兹，四舍五入到 $6$ 位小数。\n2. 时间 $t = 5\\ \\text{s}$ 时的绝对频率，即 $f_0 + \\Delta f(5\\ \\text{s})$，单位为赫兹，四舍五入到 $6$ 位小数。\n\n最终答案中出现的所有物理量必须以赫兹报告。此问题中不出现角度，因此不需要角度单位。不得使用百分比；所有值均为实数。\n\n测试套件参数：\n- 情况 A（理想情况，$50$ 赫兹系统，中等惯性和下垂）：$f_0 = 50\\ \\text{Hz}$，$H = 5$，$D = 1$，$R = 0.05$，$T_g = 0.5\\ \\text{s}$，$P_{\\text{step}} = 0.2$，$T_{\\text{end}} = 10\\ \\text{s}$。\n- 情况 B（不同标称频率，低惯性，强一次响应）：$f_0 = 60\\ \\text{Hz}$，$H = 2$，$D = 0.5$，$R = 0.04$，$T_g = 0.2\\ \\text{s}$，$P_{\\text{step}} = 0.1$，$T_{\\text{end}} = 8\\ \\text{s}$。\n- 情况 C（高惯性，弱下垂，较大扰动）：$f_0 = 50\\ \\text{Hz}$，$H = 10$，$D = 2$，$R = 0.1$，$T_g = 1.0\\ \\text{s}$，$P_{\\text{step}} = 0.3$，$T_{\\text{end}} = 12\\ \\text{s}$。\n- 情况 D（可忽略扰动的边缘情况，无显式负荷阻尼）：$f_0 = 50\\ \\text{Hz}$，$H = 3$，$D = 0$，$R = 0.05$，$T_g = 0.05\\ \\text{s}$，$P_{\\text{step}} = 0.001$，$T_{\\text{end}} = 5.5\\ \\text{s}$。\n\n您的程序必须：\n- 实现从基本原理推导出的模型，以计算每个测试用例在 $t = 1\\ \\text{s}$ 处有混合开关时的 $\\Delta f(t)$ 和 $\\Delta P_m(t)$。\n- 对每个测试用例，输出上述指定的两个以赫兹为单位的指标，四舍五入到 $6$ 位小数。\n- 将四个情况的所有结果汇总为单行输出，包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\text{nadir}_A,\\ f_5^{(A)},\\ \\text{nadir}_B,\\ f_5^{(B)},\\ \\text{nadir}_C,\\ f_5^{(C)},\\ \\text{nadir}_D,\\ f_5^{(D)}]$，其中每个条目都是一个浮点数。\n\n最终输出必须是指定格式的单行文本，不含任何额外文本。",
            "solution": "该问题要求为一个孤岛电力系统区域的一次频率响应建立连续时间模型并进行数值求解。该模型必须从第一性原理推导，具体来说是摇摆方程和一阶调速器模型。我们将构建系统动力学的状态空间表示。状态变量是频率偏差 $\\Delta f(t)$（单位：赫兹）和机械功率偏差 $\\Delta P_m(t)$（单位：标幺值 p.u.）。\n\n该系统由两个相互关联的物理原理定义：能量守恒（摇摆方程）和一次控制作用（调速器响应）。\n\n首先，我们建立摇摆方程，它控制着代表该区域的等效发电机转速的动态。线性化摇摆方程将转子速度的变化与功率不平衡联系起来，其表达式为：\n$$\n\\frac{2H}{f_0} \\frac{d(\\Delta f)}{dt} = \\Delta P_m(t) - \\Delta P_{load}(t)\n$$\n在这里，$H$ 是聚合惯性常数（单位：秒），$f_0$ 是系统标称频率（单位：Hz），$\\Delta f(t)$ 是频率偏差（单位：Hz），$\\Delta P_m(t)$ 是机械功率输入与其事件前平衡值的偏差（单位：p.u.）。$\\Delta P_{load}(t)$ 项代表总的电负荷偏差（单位：p.u.）。这个总负荷偏差由两部分组成：外部扰动 $\\Delta P_e(t)$ 和频率相关的负荷响应（负荷阻尼）。\n\n外部扰动 $\\Delta P_e(t)$ 被建模为由于 $t=1\\,\\text{s}$ 时的孤岛事件而产生的阶跃函数：\n$$\n\\Delta P_e(t) = \\begin{cases} 0  \\text{当 } t  1\\,\\text{s} \\\\ P_{\\text{step}}  \\text{当 } t \\ge 1\\,\\text{s} \\end{cases}\n$$\n其中 $P_{\\text{step}}$ 是损失的输入功率的大小，现在必须由本地发电来提供，实际上是作为本地需求的瞬时增加。\n\n负荷阻尼效应模拟了许多电力负荷在频率下降时功耗略有减少的内在趋势。这由阻尼系数 $D$ 来量化，其单位为 p.u. 功率 / p.u. 频率偏差。标幺值频率偏差为 $\\frac{\\Delta f(t)}{f_0}$。因此，由阻尼引起的负荷变化为 $D \\frac{\\Delta f(t)}{f_0}$。该项通过抵消频率变化来稳定系统。\n\n总电负荷偏差是扰动和阻尼效应之和：\n$$\n\\Delta P_{load}(t) = \\Delta P_e(t) + D \\frac{\\Delta f(t)}{f_0}\n$$\n将此代入摇摆方程得到：\n$$\n\\frac{2H}{f_0} \\frac{d(\\Delta f)}{dt} = \\Delta P_m(t) - \\left( \\Delta P_e(t) + D \\frac{\\Delta f(t)}{f_0} \\right)\n$$\n整理以分离出第一个状态变量 $\\Delta f(t)$ 的导数，我们得到第一个常微分方程（ODE）：\n$$\n\\frac{d(\\Delta f)}{dt} = -\\frac{D}{2H} \\Delta f(t) + \\frac{f_0}{2H} \\Delta P_m(t) - \\frac{f_0}{2H} \\Delta P_e(t)\n$$\n\n其次，我们对一次频率控制作用进行建模，该作用由等效发电机的调速器执行。调速器根据频率偏差 $\\Delta f(t)$ 调整机械功率输入 $\\Delta P_m(t)$。控制律基于下垂特性，即期望的稳态机械功率变化与频率偏差成比例。下垂系数 $R$ 定义为实现全 p.u. 功率响应所需的 p.u. 频率变化。因此，调速器的目标功率参考 $\\Delta P_{ref}(t)$ 为：\n$$\n\\Delta P_{ref}(t) = -\\frac{1}{R} \\left( \\frac{\\Delta f(t)}{f_0} \\right)\n$$\n负号确保频率下降（负的 $\\Delta f$）会产生增加机械功率的指令。\n\n问题指定了调速器的一阶执行器模型，其时间常数为 $T_g$。这意味着实际机械功率 $\\Delta P_m(t)$ 以一阶延迟跟随参考值 $\\Delta P_{ref}(t)$：\n$$\nT_g \\frac{d(\\Delta P_m)}{dt} + \\Delta P_m(t) = \\Delta P_{ref}(t)\n$$\n代入 $\\Delta P_{ref}(t)$ 的表达式：\n$$\nT_g \\frac{d(\\Delta P_m)}{dt} + \\Delta P_m(t) = -\\frac{1}{R f_0} \\Delta f(t)\n$$\n整理以分离出第二个状态变量 $\\Delta P_m(t)$ 的导数，我们得到第二个 ODE：\n$$\n\\frac{d(\\Delta P_m)}{dt} = -\\frac{1}{R T_g f_0} \\Delta f(t) - \\frac{1}{T_g} \\Delta P_m(t)\n$$\n\n我们现在有了一个完整的由两个耦合的线性一阶常微分方程组成的系统。令状态向量为 $x(t) = \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix}$。该系统可以写成状态空间形式 $\\dot{x}(t) = Ax(t) + Bu(t)$：\n$$\n\\frac{d}{dt} \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix} = \\begin{bmatrix} -\\frac{D}{2H}  \\frac{f_0}{2H} \\\\ -\\frac{1}{R T_g f_0}  -\\frac{1}{T_g} \\end{bmatrix} \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix} + \\begin{bmatrix} -\\frac{f_0}{2H} \\\\ 0 \\end{bmatrix} \\Delta P_e(t)\n$$\n事件前系统处于平衡状态，因此 $t=0$ 时的初始条件为：\n$$\n\\Delta f(0) = 0 \\quad \\text{和} \\quad \\Delta P_m(0) = 0\n$$\n对于测试套件中提供的每组参数，将从 $t=0$ 到 $t=T_{\\text{end}}$ 对该常微分方程组进行数值积分。标准的数值求解器，如龙格-库塔方法，是合适的。输入 $\\Delta P_e(t)$ 的分段常数特性在定义导数的函数中直接处理。\n\n从得到的 $\\Delta f(t)$ 的时域解中，我们可以计算所需的指标：\n1. 频率最低点通过计算 $\\min_{t \\in [1, T_{\\text{end}}]} (f_0 + \\Delta f(t))$ 来找到。这涉及在事件后区间的一个精细时间网格上评估解。\n2. $t=5\\,\\text{s}$ 时的频率直接计算为 $f_0 + \\Delta f(5)$。\n\n这样就完成了问题的公式化。实现将涉及将此数学模型转化为代码，并对给定的测试用例执行它。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the system of ODEs for primary frequency control\n    in a power system and computes specified performance metrics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path, 50 hertz system, moderate inertia and droop)\n        {'f0': 50.0, 'H': 5.0, 'D': 1.0, 'R': 0.05, 'Tg': 0.5, 'P_step': 0.2, 'T_end': 10.0},\n        # Case B (different nominal frequency, low inertia, strong primary response)\n        {'f0': 60.0, 'H': 2.0, 'D': 0.5, 'R': 0.04, 'Tg': 0.2, 'P_step': 0.1, 'T_end': 8.0},\n        # Case C (high inertia, weak droop, larger disturbance)\n        {'f0': 50.0, 'H': 10.0, 'D': 2.0, 'R': 0.1, 'Tg': 1.0, 'P_step': 0.3, 'T_end': 12.0},\n        # Case D (edge case with negligible disturbance, no explicit load damping)\n        {'f0': 50.0, 'H': 3.0, 'D': 0.0, 'R': 0.05, 'Tg': 0.05, 'P_step': 0.001, 'T_end': 5.5}\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        f0 = case['f0']\n        H = case['H']\n        D = case['D']\n        R = case['R']\n        Tg = case['Tg']\n        P_step = case['P_step']\n        T_end = case['T_end']\n\n        # Define the system of ordinary differential equations (ODEs).\n        # y[0] is delta_f (frequency deviation in Hz)\n        # y[1] is delta_Pm (mechanical power deviation in p.u.)\n        def system_dynamics(t, y):\n            delta_f, delta_Pm = y\n            \n            # Hybrid switch for the electrical disturbance at t=1s\n            delta_Pe = P_step if t = 1.0 else 0.0\n            \n            # Equation for d(delta_f)/dt from the swing equation\n            # d(df)/dt = -(D/(2H))*df + (f0/(2H))*dPm - (f0/(2H))*dPe\n            d_delta_f_dt = (f0 / (2.0 * H)) * (delta_Pm - delta_Pe) - (D / (2.0 * H)) * delta_f\n            \n            # Equation for d(delta_Pm)/dt from the first-order governor model\n            # d(dPm)/dt = -(1/(R*Tg*f0))*df - (1/Tg)*dPm\n            d_delta_Pm_dt = (-1.0 / (R * Tg * f0)) * delta_f - (1.0 / Tg) * delta_Pm\n            \n            return [d_delta_f_dt, d_delta_Pm_dt]\n\n        # Set initial conditions: system at equilibrium\n        y0 = [0.0, 0.0]\n        \n        # Set the time span for integration\n        t_span = [0.0, T_end]\n        \n        # Numerically solve the ODE system.\n        # dense_output=True allows for evaluation at any point in the interval.\n        sol = solve_ivp(system_dynamics, t_span, y0, method='RK45', dense_output=True, rtol=1e-8, atol=1e-8)\n        \n        # --- Calculate and store the performance metrics ---\n        \n        # 1. Frequency nadir (minimum frequency) post-event\n        # The nadir occurs after the disturbance at t=1.0s.\n        # We evaluate the solution on a fine grid to find the minimum.\n        t_eval_nadir = np.linspace(1.0, T_end, 2000)\n        delta_f_values = sol.sol(t_eval_nadir)[0]\n        nadir = f0 + np.min(delta_f_values)\n        \n        # 2. Absolute frequency at t=5s\n        # All T_end values are = 5.5s, so t=5s is a valid point.\n        delta_f_at_5s = sol.sol(5.0)[0]\n        f_at_5s = f0 + delta_f_at_5s\n\n        # Append the rounded results to the list\n        all_results.append(round(nadir, 6))\n        all_results.append(round(f_at_5s, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "精确的实时监测是任何智能电网控制系统的基石。本练习将探讨信息世界与物理世界之间的一个关键联系：相量测量单元（PMU）中的时间同步。你将推导时钟时间误差与由此产生的相角测量误差之间的直接关系。这个练习突出了为保证物理状态估计的完整性，信息基础设施所必须满足的严格要求。",
            "id": "4211444",
            "problem": "一家输电系统运营商部署了一个相量测量单元 (PMU) 网络，以监测一个 $50\\ \\text{Hz}$ 的大容量电力系统。电网的数字孪生使用这些 PMU 数据流来维持母线电压相量的实时估计。每个 PMU 使用通过全球定位系统 (GPS) 与协调世界时 (UTC) 同步的时钟为数据添加时间戳。由于残余同步误差和本地振荡器的不完美性，PMU 时钟可能与 UTC 存在一个绝对时间偏移。令 $\\delta$（单位为秒）表示在一个标准窗口内估计相量时，PMU 本地时钟与真实 UTC 之间的绝对时间偏移的幅值。\n\n假设母线电压可以建模为单相正弦波 $v(t)=V\\cos(\\omega t+\\phi)$，其角频率为 $\\omega=2\\pi f$，其中 $f=50\\ \\text{Hz}$，$V0$ 在该窗口内为常数，$\\phi$ 是一个未知但固定的相位。数字孪生要求，在 $f=50\\ \\text{Hz}$ 时，仅由时间偏移 $\\delta$ 引起的绝对相角误差必须严格保持在 $0.01\\ \\text{rad}$ 以下，以确保广域控制律保持稳定。\n\n从正弦相位和时移对正弦波影响的基本定义出发，推导 $\\delta$ 必须满足的条件，以保证在 $f=50\\ \\text{Hz}$ 时绝对相位误差严格小于 $0.01\\ \\text{rad}$。然后，计算与此要求一致的 $\\delta$ 的最大允许幅值（单位为秒）。将最终数值答案四舍五入到四位有效数字。以秒为单位表示最终答案。",
            "solution": "问题陈述已经过验证，被认为是科学有据、定义明确且客观的。它提供了一个清晰、可形式化的场景，植根于电气工程和信号处理的原理，特别是关于智能电网中信息物理系统的运行。所有必需的数据和约束都已提供。因此，我们可以进行形式化的求解。\n\n真实母线电压被建模为真实时间 $t$ 的正弦函数，由下式给出：\n$$v(t) = V\\cos(\\omega t + \\phi)$$\n其中 $V$ 是幅值，$\\phi$ 是真实相角，$\\omega$ 是角频率。角频率与系统频率 $f = 50\\ \\text{Hz}$ 的关系为 $\\omega = 2\\pi f$。\n\n相量测量单元 (PMU) 测量此电压，但其本地时钟存在时间偏移。令 PMU 时钟记录的时间为 $t'$。该时钟时间与真实时间 $t$ 的关系为 $t' = t + \\epsilon$，其中 $\\epsilon$ 是时间误差。问题将 $\\delta$ 定义为此时间偏移的幅值，因此 $\\delta = |\\epsilon|$。正的 $\\epsilon$ 表示 PMU 时钟快于真实时间，而负的 $\\epsilon$ 则表示其慢于真实时间。\n\nPMU 根据其自身时钟对电压信号进行采样。当 PMU 在其本地时间 $t'$ 记录一次测量时，被测量的物理事件实际发生在真实时间 $t = t' - \\epsilon$。因此，作为 PMU 时间基准 $t'$ 的函数的电压信号为：\n$$v_{\\text{PMU}}(t') = v(t' - \\epsilon) = V\\cos(\\omega(t' - \\epsilon) + \\phi)$$\n为了确定数字孪生（它使用 PMU 的时间戳数据）所感知的相位，我们展开余弦函数的参数：\n$$v_{\\text{PMU}}(t') = V\\cos(\\omega t' - \\omega\\epsilon + \\phi)$$\n通过将其与通用形式 $V\\cos(\\omega t' + \\phi_{\\text{measured}})$ 进行比较，我们可以确定 PMU 系统测量的相角为：\n$$\\phi_{\\text{measured}} = \\phi - \\omega\\epsilon$$\n相角误差 $\\Delta\\phi$ 是测量相位与真实相位之差：\n$$\\Delta\\phi = \\phi_{\\text{measured}} - \\phi = (\\phi - \\omega\\epsilon) - \\phi = -\\omega\\epsilon$$\n问题要求*绝对*相角误差受到限制。相位误差的幅值为：\n$$|\\Delta\\phi| = |-\\omega\\epsilon| = \\omega |\\epsilon|$$\n使用问题中对时间偏移幅值 $\\delta = |\\epsilon|$ 的定义，我们建立了绝对相位误差和时间偏移之间的直接关系：\n$$|\\Delta\\phi| = \\omega\\delta$$\n此方程表明，时间偏移 $\\delta$ 会引起一个幅值为 $\\omega\\delta$ 的相位误差。\n\n任务的第一部分是推导 $\\delta$ 需满足的条件。要求是绝对相位误差必须严格小于 $0.01\\ \\text{rad}$。这可以表示为不等式：\n$$|\\Delta\\phi|  0.01$$\n代入我们关于 $|\\Delta\\phi|$ 的表达式，我们得到关于 $\\delta$ 的条件：\n$$\\omega\\delta  0.01$$\n这是为保证广域控制律的稳定性所必须满足的形式化条件。\n\n任务的第二部分是计算 $\\delta$ 的最大允许幅值。从推导出的条件中，我们可以分离出 $\\delta$：\n$$\\delta  \\frac{0.01}{\\omega}$$\n$\\delta$ 的最大允许幅值，我们称之为 $\\delta_{\\text{max}}$，是 $\\delta$ 允许值集合的上确界，即该不等式的边界值。\n$$\\delta_{\\text{max}} = \\frac{0.01}{\\omega}$$\n给定系统频率 $f = 50\\ \\text{Hz}$。相应的角频率 $\\omega$ 为：\n$$\\omega = 2\\pi f = 2\\pi(50) = 100\\pi\\ \\text{rad}/\\text{s}$$\n将 $\\omega$ 的值代入 $\\delta_{\\text{max}}$ 的表达式中：\n$$\\delta_{\\text{max}} = \\frac{0.01}{100\\pi} = \\frac{10^{-2}}{10^2 \\pi} = \\frac{1}{\\pi \\times 10^4}\\ \\text{s}$$\n为了得到最终的数值答案，我们计算这个值并按要求四舍五入到四位有效数字：\n$$\\delta_{\\text{max}} = \\frac{1}{3.14159265... \\times 10^4} \\approx 0.31830988... \\times 10^{-4}\\ \\text{s}$$\n用标准科学记数法表示，这是：\n$$\\delta_{\\text{max}} \\approx 3.1830988... \\times 10^{-5}\\ \\text{s}$$\n四舍五入到四位有效数字得到：\n$$\\delta_{\\text{max}} \\approx 3.183 \\times 10^{-5}\\ \\text{s}$$\n因此，为满足指定的相位误差容限，PMU 时钟相对于 UTC 的时间偏移幅值必须小于约 $31.83$ 微秒。",
            "answer": "$$\\boxed{3.183 \\times 10^{-5}}$$"
        }
    ]
}