{
    "hands_on_practices": [
        {
            "introduction": "确保复杂系统的弹性需要管理跨多个潜在故障模式的总风险预算。一个简单的方法是使用布尔不等式（联合界），但这可能过于保守，导致不必要的严格设计。本练习  演示了一种更精确的方法，即使用容斥原理，允许您通过整合关于不同故障事件如何重叠（或相关）的信息，为各个子系统设定更严格、更切合实际的安全目标。",
            "id": "4238436",
            "problem": "一个信息物理系统 (CPS) 在弹性微电网中协调三个耦合的安全机制：电压保护、频率调节和热管理。微电网的数字孪生 (DT) 使用重要性采样 (IS) 运行罕见事件仿真，以监控和量化在 $10$ 分钟运行周期内发生安全违规的概率。设安全违规事件表示为 $A_{1}$ (电压违规)、$A_{2}$ (频率违规) 和 $A_{3}$ (热违规)。\n\n为了验证弹性，运营商施加了一个联合机会约束 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$，目标风险预算为 $\\varepsilon = 1.0 \\times 10^{-4}$。为简化策略设计，运营商为 $i \\in \\{1,2,3\\}$ 分配了相等的边际风险预算 $\\mathbb{P}(A_{i}) \\leq \\alpha$。\n\n数字孪生的罕见事件仿真输出了成对交集的高置信度双边置信区间 (CI)，以及三事件交集的单边界：\n- 对 $\\mathbb{P}(A_{i} \\cap A_{j})$ 的置信下界 $\\ell_{12} = 6.0 \\times 10^{-6}$、$\\ell_{13} = 4.0 \\times 10^{-6}$、$\\ell_{23} = 5.0 \\times 10^{-6}$，\n- 对 $\\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3})$ 的置信上界 $\\tau = 1.0 \\times 10^{-8}$。\n\n从概率公理出发，应用布尔不等式（并集界）来分解三个安全约束的联合机会约束，然后利用可用的交集界，使用容斥原理（Bonferroni 截断）设计一个更紧的保守近似。从第一性原理推导，在给定的数字孪生估计的界下，保证 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$ 的最大相等边际分配 $\\alpha$。\n\n使用提供的值数值计算此 $\\alpha$。将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "首先验证问题，确保其具有科学依据、适定、客观且完整。提取并检查所有给定条件。\n- 事件：$A_{1}$ (电压违规)、$A_{2}$ (频率违规)、$A_{3}$ (热违规)。\n- 联合机会约束：$\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$。\n- 目标风险预算：$\\varepsilon = 1.0 \\times 10^{-4}$。\n- 边际风险预算约束：$\\mathbb{P}(A_{i}) \\leq \\alpha$ for $i \\in \\{1,2,3\\}$。\n- 成对交集的置信下界：$\\mathbb{P}(A_1 \\cap A_2) \\geq \\ell_{12} = 6.0 \\times 10^{-6}$，$\\mathbb{P}(A_1 \\cap A_3) \\geq \\ell_{13} = 4.0 \\times 10^{-6}$，$\\mathbb{P}(A_2 \\cap A_3) \\geq \\ell_{23} = 5.0 \\times 10^{-6}$。\n- 三事件交集的置信上界：$\\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3}) \\leq \\tau = 1.0 \\times 10^{-8}$。\n\n该问题是概率论，特别是容斥原理，在工程弹性和风险分析领域的标准应用。术语精确，数据一致，目标明确。问题有效。我们可以继续求解。\n\n我们的目标是，在给定的边际和交集概率约束下，找到保证满足联合机会约束 $\\mathbbP(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$ 的边际风险预算 $\\alpha$ 的最大值。\n\n问题要求我们从第一性原理出发。三个事件 $A_1$、$A_2$ 和 $A_3$ 的并集概率由容斥原理给出：\n$$\n\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) = \\sum_{i=1}^{3} \\mathbb{P}(A_{i}) - \\sum_{1 \\leq i  j \\leq 3} \\mathbb{P}(A_{i} \\cap A_{j}) + \\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3})\n$$\n问题将布尔不等式（一个简单的并集界）与一个更紧的近似进行对比。布尔不等式表明 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\sum_{i=1}^{3} \\mathbb{P}(A_{i})$。使用边际风险预算 $\\mathbb{P}(A_i) \\leq \\alpha$，这得到 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq 3\\alpha$。这是一个保守的界，它忽略了关于事件交集的信息。\n\n为了推导所要求的更紧的保守近似，我们必须使用所有可用信息来建立 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3})$ 的最严格上界。我们按如下方式对容斥公式中的每一项进行界定：\n1.  对于边际概率之和：问题陈述 $\\mathbb{P}(A_{i}) \\leq \\alpha$ for $i \\in \\{1,2,3\\}$。因此，该和的上界为：\n    $$ \\sum_{i=1}^{3} \\mathbb{P}(A_{i}) = \\mathbb{P}(A_{1}) + \\mathbb{P}(A_{2}) + \\mathbb{P}(A_{3}) \\leq \\alpha + \\alpha + \\alpha = 3\\alpha $$\n2.  对于成对交集概率之和：公式中的这一项是负数，$- \\sum \\mathbb{P}(A_{i} \\cap A_{j})$。问题为这些概率提供了置信下界：$\\mathbb{P}(A_{i} \\cap A_{j}) \\geq \\ell_{ij}$。乘以 $-1$ 会反转不等式，从而为负项产生一个上界：$-\\mathbb{P}(A_{i} \\cap A_{j}) \\leq -\\ell_{ij}$。因此，该和的上界为：\n    $$ - \\sum_{1 \\leq i  j \\leq 3} \\mathbb{P}(A_{i} \\cap A_{j}) \\leq -(\\ell_{12} + \\ell_{13} + \\ell_{23}) $$\n3.  对于三事件交集概率：问题直接给出了一个置信上界：\n    $$ \\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3}) \\leq \\tau $$\n\n结合这些单独的上界，我们可以为并集概率构建一个总上界：\n$$\n\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq 3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau\n$$\n这就是代表了更紧的保守近似的 Bonferroni 型不等式。为保证联合机会约束 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$，我们必须确保我们推导出的上界本身小于或等于 $\\varepsilon$：\n$$\n3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau \\leq \\varepsilon\n$$\n我们被要求找到满足此条件的 $\\alpha$ 的最大可能值。当不等式变为等式时，即可实现这一点：\n$$\n3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau = \\varepsilon\n$$\n求解 $\\alpha$，我们得到：\n$$\n3\\alpha = \\varepsilon + \\ell_{12} + \\ell_{13} + \\ell_{23} - \\tau\n$$\n$$\n\\alpha = \\frac{1}{3} (\\varepsilon + \\ell_{12} + \\ell_{13} + \\ell_{23} - \\tau)\n$$\n现在，我们将提供的数值代入此表达式：\n$\\varepsilon = 1.0 \\times 10^{-4}$\n$\\ell_{12} = 6.0 \\times 10^{-6}$\n$\\ell_{13} = 4.0 \\times 10^{-6}$\n$\\ell_{23} = 5.0 \\times 10^{-6}$\n$\\tau = 1.0 \\times 10^{-8}$\n\n首先，对成对交集的下界求和：\n$$\n\\ell_{12} + \\ell_{13} + \\ell_{23} = (6.0 + 4.0 + 5.0) \\times 10^{-6} = 15.0 \\times 10^{-6}\n$$\n现在将所有值代入 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\frac{1}{3} (1.0 \\times 10^{-4} + 15.0 \\times 10^{-6} - 1.0 \\times 10^{-8})\n$$\n为了进行算术运算，我们将所有数字表示为以10为底的共同幂，例如 $10^{-8}$：\n$1.0 \\times 10^{-4} = 10000 \\times 10^{-8}$\n$15.0 \\times 10^{-6} = 1500 \\times 10^{-8}$\n$1.0 \\times 10^{-8} = 1 \\times 10^{-8}$\n$$\n\\alpha = \\frac{1}{3} (10000 \\times 10^{-8} + 1500 \\times 10^{-8} - 1 \\times 10^{-8})\n$$\n$$\n\\alpha = \\frac{1}{3} (10000 + 1500 - 1) \\times 10^{-8}\n$$\n$$\n\\alpha = \\frac{11499}{3} \\times 10^{-8}\n$$\n$$\n\\alpha = 3833 \\times 10^{-8}\n$$\n按照要求，将其表示为标准科学记数法并四舍五入到四位有效数字：\n$$\n\\alpha = 3.833 \\times 10^{-5}\n$$\n这是在数字孪生仿真提供的保守界限下，保证满足联合机会约束的最大边际风险预算 $\\alpha$。",
            "answer": "$$ \\boxed{3.833 \\times 10^{-5}} $$"
        },
        {
            "introduction": "一旦设定了系统级的风险目标，我们就需要具体的方法来分析底层的系统动态，以验证是否满足这些目标。本实践  深入探讨了基于模型的弹性分析，使用离散时间马尔可夫链 (DTMC) 对一个信息物理系统进行建模。您将学习如何将一个关键的故障场景——在成功恢复前达到不安全状态——转化为一个形式化的“到达-规避”概率问题，并通过构建和求解一个源于模型转移结构的线性方程组来精确计算其发生概率。",
            "id": "4238425",
            "problem": "一个微电网信息物理系统（CPS）的数字孪生被用于评估在级联保护动作和故障传播下的弹性。其离散事件演化被建模为离散时间马尔可夫链（DTMC）。状态为 $\\{s_0, s_1, s_2, s_3, a, b\\}$，其中 $a$ 表示不可恢复的非安全停机，$b$ 表示成功恢复到标称运行。系统从 $s_0$ 开始。令 $A=\\{a\\}$ 且 $B=\\{b\\}$。转移概率如下（任何未明确列出的转移概率为 $0$）：\n- 从 $s_0$：以概率 $\\frac{1}{100}$ 转移到 $s_1$，以概率 $\\frac{99}{100}$ 转移到 $s_3$。\n- 从 $s_3$：以概率 $\\frac{9}{10}$ 转移到 $b$，以概率 $\\frac{1}{10}$ 转移到 $s_1$。\n- 从 $s_1$：以概率 $\\frac{1}{10}$ 转移到 $s_2$，以概率 $\\frac{9}{10}$ 转移到 $s_3$。\n- 从 $s_2$：以概率 $\\frac{1}{20}$ 转移到 $a$，以概率 $\\frac{19}{20}$ 转移到 $s_3$。\n- 状态 $a$ 和 $b$ 是吸收态。\n\n用于弹性分析的罕见事件是“在到达 $B$ 之前先到达 $A$”，即系统在成功恢复之前进入非安全停机状态。使用马尔可夫过程的到达-规避概率的基本定义，并仅从马尔可夫性质和全概率定律出发，完成以下任务：\n1) 构建一个概率计算树逻辑（PCTL）中的概率时间逻辑规约，该规约表示从初始状态出发“在到达 $A$ 之前先到达 $B$”。\n2) 推导、建立并求解最小非负线性方程组，该方程组给出从状态 $s$ 开始在到达 $B$ 之前先到达 $A$ 的概率 $p(s)$，其中狄利克雷边界条件为 $p(a)=1$ 和 $p(b)=0$。然后计算初始状态的值 $p(s_0)$。\n\n将您关于 $p(s_0)$ 的最终数值答案表示为最简分数。不要使用百分号。无需四舍五入。",
            "solution": "该问题是有效的，因为它在科学上基于马尔可夫链理论，具有适定的、唯一可解的结构，并使用客观、形式化的语言陈述。它是自洽的，没有矛盾。\n\n该问题要求完成两项任务：构建一个概率计算树逻辑（PCTL）规约，以及求解一个关于到达-规避概率的线性方程组。\n\n### 第1部分：PCTL规约\n\n关注的事件是“在到达集合 $A$ 之前先到达集合 $B$”。在时间逻辑的语境中，这是一种“到达-规避”性质。给定集合 $A = \\{a\\}$ 和 $B = \\{b\\}$。该性质要求通过状态空间的任何有效路径最终必须到达状态 $a$，并且在到达 $a$ 之前沿此路径访问的所有状态都不能是状态 $b$。\n\n概率计算树逻辑（PCTL）是一种用于为像马尔可夫链这样的概率系统形式化地规约此类性质的逻辑。PCTL公式规约了从某个状态开始的路径的性质。特定的性质“在到达 $A$ 之前先到达 $B$”很自然地使用“直到”算子（用 $\\text{U}$ 表示）来表达。\n\n路径公式 $\\phi_1 \\text{ U } \\phi_2$ 断言，在未来的某个时间步，性质 $\\phi_2$ 成立，并且在之前的所有时间步中，性质 $\\phi_1$ 都成立。\n\n为了形式化我们的特定事件，我们定义原子命题。令命题 $a$ 为真，当且仅当系统处于状态 $a$；令命题 $b$ 为真，当且仅当系统处于状态 $b$。\n“规避 $B$”的条件意味着不处于状态 $b$，这由逻辑公式 $\\neg b$ 表示。\n“到达 $A$”的条件意味着到达状态 $a$，这由原子命题 $a$ 表示。\n\n因此，表示“在到达 $b$ 之前先到达 $a$”的路径公式由下式给出：\n$$ (\\neg b) \\text{ U } a $$\n该公式规定系统必须保持在非 $b$ 的状态，*直到*最终到达状态 $a$。从初始状态 $s_0$ 找出罕见事件的概率问题，对应于在状态 $s_0$ 处求 PCTL 查询 $P_{=?}[(\\neg b) \\text{ U } a]$ 的值。\n\n### 第2部分：方程组的推导与求解\n\n令 $p(s)$ 表示从状态 $s$ 开始“在到达 $A$ 之前先到达 $B$”事件的概率。我们需要计算 $p(s_0)$。该分析依赖于全概率定律和马尔可夫性质。\n\n边界条件定义在吸收集 $A=\\{a\\}$ 和 $B=\\{b\\}$ 上。\n1. 如果系统从状态 $a \\in A$ 开始，它已经到达了 $A$ 而没有经过 $B$。因此，概率为 $1$。所以，$p(a) = 1$。\n2. 如果系统从状态 $b \\in B$ 开始，它未能在到达 $B$ 之前到达 $A$。因此，概率为 $0$。所以，$p(b) = 0$。\n这些是指定的狄利克雷边界条件。\n\n对于任何非吸收（暂态）状态 $s \\notin A \\cup B$，我们可以通过对下一个时间步的状态 $s'$ 进行条件化来表示 $p(s)$。令 $T(s, s')$ 为从状态 $s$ 到 $s'$ 的转移概率。根据全概率定律：\n$$ p(s) = \\sum_{s'} P(\\text{reach } A \\text{ before } B \\mid \\text{next is } s') \\cdot T(s,s') $$\n由于马尔可夫性质，从下一状态 $s'$ 开始的事件概率就是 $p(s')$。这得出了核心的线性方程组：\n$$ p(s) = \\sum_{s'} T(s,s') \\cdot p(s') $$\n让我们记 $p_i = p(s_i)$，其中 $i \\in \\{0, 1, 2, 3\\}$。我们现在可以使用给定的转移概率为暂态 $s_0, s_1, s_2, s_3$ 写出方程。\n\n对于状态 $s_0$：\n$p_0 = T(s_0, s_1)p(s_1) + T(s_0, s_3)p(s_3) = \\frac{1}{100}p_1 + \\frac{99}{100}p_3$\n\n对于状态 $s_1$：\n$p_1 = T(s_1, s_2)p(s_2) + T(s_1, s_3)p(s_3) = \\frac{1}{10}p_2 + \\frac{9}{10}p_3$\n\n对于状态 $s_2$：\n$p_2 = T(s_2, a)p(a) + T(s_2, s_3)p(s_3) = \\frac{1}{20}(1) + \\frac{19}{20}p_3$\n\n对于状态 $s_3$：\n$p_3 = T(s_3, b)p(b) + T(s_3, s_1)p(s_1) = \\frac{9}{10}(0) + \\frac{1}{10}p_1$\n\n这构成了关于四个未知概率 $p_0, p_1, p_2, p_3$ 的四个线性方程组：\n1. $p_0 = \\frac{1}{100} p_1 + \\frac{99}{100} p_3$\n2. $p_1 = \\frac{1}{10} p_2 + \\frac{9}{10} p_3$\n3. $p_2 = \\frac{1}{20} + \\frac{19}{20} p_3$\n4. $p_3 = \\frac{1}{10} p_1$\n\n我们使用代入法求解该方程组。从方程(4)可得：\n$$ p_1 = 10 p_3 $$\n将 $p_1$ 的这个表达式代入方程(2)：\n$$ 10 p_3 = \\frac{1}{10} p_2 + \\frac{9}{10} p_3 $$\n乘以 $10$ 以消去分母：\n$$ 100 p_3 = p_2 + 9 p_3 $$\n$$ p_2 = 100 p_3 - 9 p_3 = 91 p_3 $$\n现在，将 $p_2$ 的这个表达式代入方程(3)：\n$$ 91 p_3 = \\frac{1}{20} + \\frac{19}{20} p_3 $$\n乘以 $20$：\n$$ 1820 p_3 = 1 + 19 p_3 $$\n$$ 1820 p_3 - 19 p_3 = 1 $$\n$$ 1801 p_3 = 1 $$\n$$ p_3 = \\frac{1}{1801} $$\n现在我们可以通过回代 $p_1$ 和 $p_3$ 的表达式来求出 $p_0$ 的值。从方程(1)：\n$$ p_0 = \\frac{1}{100} p_1 + \\frac{99}{100} p_3 $$\n代入 $p_1 = 10 p_3$：\n$$ p_0 = \\frac{1}{100} (10 p_3) + \\frac{99}{100} p_3 = \\frac{10 p_3 + 99 p_3}{100} = \\frac{109 p_3}{100} $$\n最后，代入 $p_3$ 的值：\n$$ p_0 = \\frac{109}{100} \\left(\\frac{1}{1801}\\right) = \\frac{109}{180100} $$\n数字 $109$ 是一个质数。为了检查该分数是否可以约简，我们必须检查 $180100$ 是否能被 $109$ 整除。由于 $180100 = 1801 \\times 100$，我们检查 $1801$ 是否能被 $109$ 整除。\n$$ \\frac{1801}{109} \\approx 16.522... $$\n$1801$ 不能被 $109$ 整除。因此，分数 $\\frac{109}{180100}$ 是其最简形式。\n\n所求的值是 $p(s_0) = \\frac{109}{180100}$。",
            "answer": "$$\\boxed{\\frac{109}{180100}}$$"
        },
        {
            "introduction": "通常，最具灾难性的故障是如此罕见，以至于它们并未出现在我们的历史数据或有限的仿真结果中。这带来了一个核心挑战：我们如何估计比任何已观测事件都更极端的事件的风险？本练习  介绍了一种源自极值理论 (EVT) 的强大统计工具，它展示了如何使用广义帕累托分布 (GPD) 对超过某个高阈值的事件数据进行建模，从而有信心地外推并量化前所未有的极端事件的风险水平。",
            "id": "4238483",
            "problem": "一个信息物理系统（CPS）的数字孪生在平稳工况下以固定的采样频率监测一个无量纲的韧性压力指标 $X$（标幺值，p.u.）。为支持稀有事件模拟和韧性分析，采用了一种超阈值峰值模型。设阈值为 $u$，并假设在 $X  u$ 条件下，超出量 $Y = X - u$ 服从广义帕累托分布（GPD, Generalized Pareto Distribution），其尺度参数为 $\\sigma  0$，形状参数为 $\\xi \\in \\mathbb{R}$。对于 $\\xi \\neq 0$，GPD的累积分布函数为\n$$\nH(y) \\;=\\; 1 - \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}, \\quad y \\ge 0,\n$$\n且对于 $x \\ge u$ 的相应尾部概率满足\n$$\nP(X  x) \\;=\\; P(X  u) \\, P(Y  x - u \\mid X  u).\n$$\n一次为期一年的稀有事件模拟产生了 $N$ 个样本，其中有 $k$ 个超出阈值 $u$ 的事件，得出经验超出概率 $p_u = P(X  u) \\approx k/N$。对超出量进行GPD的最大似然拟合，得到了参数估计值 $\\hat{\\sigma}$ 和 $\\hat{\\xi}$，以及在最大似然估计处 $(\\sigma, \\xi)$ 的观测费雪信息矩阵 $I(\\hat{\\sigma}, \\hat{\\xi})$。\n\n给定以下科学上合理的量，其中 $X$ 和 $u$ 均以标幺值表示：\n- 阈值 $u = 1.05$，\n- 样本量 $N = 5.0 \\times 10^{6}$，\n- 超出量数量 $k = 2{,}500$，因此 $p_u = k/N = 5.0 \\times 10^{-4}$，\n- GPD最大似然估计值 $\\hat{\\sigma} = 0.06$ 和 $\\hat{\\xi} = 0.20$，\n- 在 $(\\hat{\\sigma}, \\hat{\\xi})$ 处的观测费雪信息矩阵为\n$$\nI(\\hat{\\sigma}, \\hat{\\xi}) \\;=\\;\n\\begin{pmatrix}\n700{,}000  -3{,}000 \\\\\n-3{,}000  12{,}000\n\\end{pmatrix},\n$$\n以及一个目标极端尾部概率 $p = 1.0 \\times 10^{-6}$，\n\n基于以上基础，推导由 $P(X  q_p) = p$ 隐式定义的极端分位数 $q_p$ 的解析表达式，然后通过代入 $(u, p_u, p, \\hat{\\sigma}, \\hat{\\xi})$ 计算最大似然估计值 $\\hat{q}_p$。\n\n此外，解释如何使用关注的标量参数 $q_p$ 的剖面似然来评估 $q_p$ 的不确定性，包括为剖除讨厌参数所需的重新参数化以及在 $\\hat{q}_p$ 处剖面对数似然的曲率解释。使用给定的 $I(\\hat{\\sigma}, \\hat{\\xi})$，通过最大似然估计处剖面似然的曲率计算 $\\hat{q}_p$ 的渐近标准误差。\n\n你的最终数值报告应为单一值 $\\hat{q}_p$。将你的最终答案四舍五入到四位有效数字。以p.u.（标幺值）表示最终分位数。",
            "solution": "经评估，该问题陈述具有科学依据、良定、客观且完整。它基于极值理论和统计推断的既定原则。所有必要的数据均已提供，且无内部矛盾。因此，该问题被认为是有效的，并在此给出完整解答。\n\n解答分为两个主要部分。首先，我们推导极端分位数 $q_p$ 的解析表达式，并计算其最大似然估计值 $\\hat{q_p}$。其次，我们描述使用剖面似然进行不确定性评估的方法，并通过计算上等效的Delta方法计算 $\\hat{q}_p$ 的渐近标准误差。\n\n**第一部分：极端分位数 $\\hat{q}_p$ 的推导与计算**\n\n极端分位数 $q_p$ 由方程 $P(X  q_p) = p$ 隐式定义，其中 $p$ 是目标极端尾部概率。该问题为 $X$ 的分布尾部提供了一个模型。对于高于阈值 $u$ 的点 $x$，其尾部概率由下式给出：\n$$\nP(X  x) = P(X  u) \\, P(Y  x - u \\mid X  u)\n$$\n此处，$Y = X - u$ 代表超出阈值 $u$ 的量。概率 $P(X  u)$ 通过 $p_u = k/N$ 估计。条件概率 $P(Y  y \\mid X  u)$ 对应于广义帕累托分布（GPD）的生存函数，我们将其表示为 $\\bar{H}(y)$。对于 $\\xi \\neq 0$，GPD的累积分布函数（CDF）如下所示：\n$$\nH(y) = 1 - \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}\n$$\n相应的生存函数为：\n$$\n\\bar{H}(y) = 1 - H(y) = \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}\n$$\n将这些代入尾部概率公式，令 $x = q_p$ 和 $y = q_p - u$，我们得到：\n$$\nP(X  q_p) = p_u \\, \\bar{H}(q_p - u)\n$$\n$$\np = p_u \\left(1 + \\frac{\\xi (q_p - u)}{\\sigma}\\right)^{-1/\\xi}\n$$\n我们现在求解此方程以得到 $q_p$ 的解析表达式：\n$$\n\\frac{p}{p_u} = \\left(1 + \\frac{\\xi (q_p - u)}{\\sigma}\\right)^{-1/\\xi}\n$$\n将两边取 $-\\xi$ 次幂：\n$$\n\\left(\\frac{p}{p_u}\\right)^{-\\xi} = 1 + \\frac{\\xi (q_p - u)}{\\sigma}\n$$\n重新整理以分离出包含 $q_p$ 的项：\n$$\n\\left(\\frac{p}{p_u}\\right)^{-\\xi} - 1 = \\frac{\\xi (q_p - u)}{\\sigma}\n$$\n最后，解出 $q_p$：\n$$\nq_p = u + \\frac{\\sigma}{\\xi} \\left[ \\left(\\frac{p}{p_u}\\right)^{-\\xi} - 1 \\right]\n$$\n这就是所求的极端分位数 $q_p$ 的解析表达式。\n\n为计算最大似然估计值 $\\hat{q}_p$，我们将给定的值和参数估计值代入此表达式：\n$u = 1.05$，$p_u = 5.0 \\times 10^{-4}$，$p = 1.0 \\times 10^{-6}$，$\\hat{\\sigma} = 0.06$ 以及 $\\hat{\\xi} = 0.20$。\n\n概率之比为：\n$$\n\\frac{p}{p_u} = \\frac{1.0 \\times 10^{-6}}{5.0 \\times 10^{-4}} = \\frac{1}{500} = 0.002\n$$\n将这些值代入 $\\hat{q}_p$ 的表达式中：\n$$\n\\hat{q}_p = 1.05 + \\frac{0.06}{0.20} \\left[ \\left(0.002\\right)^{-0.20} - 1 \\right]\n$$\n$$\n\\hat{q}_p = 1.05 + 0.3 \\left[ \\left(500\\right)^{0.2} - 1 \\right]\n$$\n我们计算 $(500)^{0.2}$ 的值：\n$$\n(500)^{0.2} = (500)^{1/5} \\approx 3.4657359\n$$\n现在，将此值代回 $\\hat{q}_p$ 的表达式中：\n$$\n\\hat{q}_p = 1.05 + 0.3 (3.4657359 - 1) = 1.05 + 0.3(2.4657359)\n$$\n$$\n\\hat{q}_p = 1.05 + 0.73972077 = 1.78972077\n$$\n四舍五入到四位有效数字，我们得到 $\\hat{q}_p \\approx 1.790$。\n\n**第二部分：$\\hat{q}_p$ 的不确定性评估**\n\n估计值 $\\hat{q}_p$ 的不确定性来源于最大似然估计值 $\\hat{\\sigma}$ 和 $\\hat{\\xi}$ 的统计不确定性。评估这种不确定性的一种标准方法是使用剖面似然。\n\n分位数 $q_p$ 是模型参数 $(\\sigma, \\xi)$ 的函数。我们关注的参数是 $\\psi_1 = q_p(\\sigma, \\xi)$，而另一个参数可被视为讨厌参数。为使用剖面似然，我们将模型从 $(\\sigma, \\xi)$ 重新参数化为一组新参数 $(\\psi_1, \\psi_2)$，其中 $\\psi_1=q_p$ 且 $\\psi_2$ 是一个讨厌参数，为方便起见选择 $\\psi_2=\\xi$。我们可以用 $(q_p, \\xi)$ 来表示 $(\\sigma, \\xi)$：\n$$\n\\xi = \\psi_2\n$$\n$$\n\\sigma = \\frac{\\xi(q_p - u)}{\\left(p/p_u\\right)^{-\\xi} - 1} = \\frac{\\psi_2(q_p - u)}{\\left(p/p_u\\right)^{-\\psi_2} - 1}\n$$\n对数似然函数 $l(\\sigma, \\xi)$ 可以重新表示为 $l^*(q_p, \\xi)$。那么 $q_p$ 的剖面对数似然定义为：\n$$\nl_{\\text{prof}}(q_p) = \\max_{\\xi} l^*(q_p, \\xi)\n$$\n对于每个固定的 $q_p$ 值，我们找到使似然最大化的讨厌参数 $\\xi$ 的值。得到的函数 $l_{\\text{prof}}(q_p)$ 在最大似然估计（MLE） $\\hat{q}_p$ 处取得最大值。\n剖面对数似然在其峰值处的曲率提供了不确定性的估计。具体来说，$\\hat{q}_p$ 的渐近方差由在 $\\hat{q}_p$ 处求值的剖面对数似然的负二阶导数的倒数给出：\n$$\n\\text{Var}(\\hat{q}_p) \\approx \\left( - \\frac{d^2 l_{\\text{prof}}(q_p)}{dq_p^2} \\Big|_{q_p=\\hat{q}_p} \\right)^{-1}\n$$\n在计算上，使用Delta方法最方便计算此方差，该方法提供相同的渐近结果。参数矢量 $\\theta$ 的函数 $g(\\theta)$ 的方差近似为 $\\text{Var}(g(\\hat{\\theta})) \\approx \\nabla g(\\hat{\\theta})^T \\text{Cov}(\\hat{\\theta}) \\nabla g(\\hat{\\theta})$。此处，$g$ 是 $q_p$ 的函数，$\\theta = (\\sigma, \\xi)$，协方差矩阵 $\\text{Cov}(\\hat{\\theta})$ 是观测费雪信息矩阵的逆矩阵，即 $\\Sigma = I(\\hat{\\sigma}, \\hat{\\xi})^{-1}$。\n\n$\\hat{q}_p$ 的渐近标准误差为 $\\text{SE}(\\hat{q}_p) = \\sqrt{\\text{Var}(\\hat{q}_p)}$。\n\n我们现在计算这个标准误差。\n首先，我们求协方差矩阵 $\\Sigma = I^{-1}$：\n$$\nI = \\begin{pmatrix} 700{,}000  -3{,}000 \\\\ -3{,}000  12{,}000 \\end{pmatrix}\n$$\n行列式为 $\\det(I) = (700{,}000)(12{,}000) - (-3{,}000)^2 = 8.4 \\times 10^9 - 9 \\times 10^6 = 8.391 \\times 10^9$。\n逆矩阵为：\n$$\n\\Sigma = I^{-1} = \\frac{1}{8.391 \\times 10^9} \\begin{pmatrix} 12{,}000  3{,}000 \\\\ 3{,}000  700{,}000 \\end{pmatrix} \\approx \\begin{pmatrix} 1.4301 \\times 10^{-6}  0.3575 \\times 10^{-6} \\\\ 0.3575 \\times 10^{-6}  8.3423 \\times 10^{-5} \\end{pmatrix}\n$$\n其次，我们计算梯度向量 $\\nabla q_p = (\\frac{\\partial q_p}{\\partial \\sigma}, \\frac{\\partial q_p}{\\partial \\xi})^T$ 并在 $(\\hat{\\sigma}, \\hat{\\xi})$ 处求值。\n设 $A = p/p_u = 0.002$。偏导数为：\n$$\n\\frac{\\partial q_p}{\\partial \\sigma} = \\frac{1}{\\xi} \\left[ A^{-\\xi} - 1 \\right]\n$$\n$$\n\\frac{\\partial q_p}{\\partial \\xi} = \\frac{\\sigma}{\\xi^2} \\left[ 1 - A^{-\\xi} \\right] - \\frac{\\sigma}{\\xi} \\ln(A) A^{-\\xi}\n$$\n在 $(\\hat{\\sigma}, \\hat{\\xi}) = (0.06, 0.20)$ 处求值：\n$$\n\\frac{\\partial q_p}{\\partial \\sigma} \\Big|_{MLE} = \\frac{1}{0.20} \\left[ (0.002)^{-0.20} - 1 \\right] = 5(3.4657359 - 1) = 12.32868\n$$\n$$\n\\frac{\\partial q_p}{\\partial \\xi} \\Big|_{MLE} = \\frac{0.06}{0.20^2} \\left[ 1 - (0.002)^{-0.20} \\right] - \\frac{0.06}{0.20} \\ln(0.002) (0.002)^{-0.20}\n$$\n$$\n= 1.5(1 - 3.4657359) - 0.3(-6.214608)(3.4657359)\n$$\n$$\n= 1.5(-2.4657359) + 6.46083 = -3.69860 + 6.46083 = 2.76223\n$$\n梯度向量为 $\\nabla \\hat{q}_p \\approx (12.32868, 2.76223)^T$。\n\n第三，我们计算方差：\n$$\n\\text{Var}(\\hat{q}_p) \\approx \\begin{pmatrix} 12.32868  2.76223 \\end{pmatrix} \\begin{pmatrix} 1.4301 \\times 10^{-6}  0.3575 \\times 10^{-6} \\\\ 0.3575 \\times 10^{-6}  8.3423 \\times 10^{-5} \\end{pmatrix} \\begin{pmatrix} 12.32868 \\\\ 2.76223 \\end{pmatrix}\n$$\n$\\text{Var}(\\hat{q}_p) \\approx (12.32868)^2(1.4301 \\times 10^{-6}) + (2.76223)^2(8.3423 \\times 10^{-5}) + 2(12.32868)(2.76223)(0.3575 \\times 10^{-6})$\n$\\text{Var}(\\hat{q}_p) \\approx (151.996)(1.4301 \\times 10^{-6}) + (7.6299)(8.3423 \\times 10^{-5}) + (68.125)(0.3575 \\times 10^{-6})$\n$\\text{Var}(\\hat{q}_p) \\approx 2.1737 \\times 10^{-4} + 6.3659 \\times 10^{-4} + 0.2435 \\times 10^{-4}$\n$\\text{Var}(\\hat{q}_p) \\approx 8.7831 \\times 10^{-4}$\n\n最后，标准误差为：\n$$\n\\text{SE}(\\hat{q}_p) = \\sqrt{8.7831 \\times 10^{-4}} \\approx 0.02963\n$$\n该值量化了估计值 $\\hat{q}_p = 1.790 \\text{ p.u.}$ 的不确定性。例如，一个近似的 $95\\%$ 置信区间将是 $\\hat{q}_p \\pm 1.96 \\times \\text{SE}(\\hat{q}_p)$。",
            "answer": "$$\n\\boxed{1.790}\n$$"
        }
    ]
}