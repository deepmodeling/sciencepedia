{
    "hands_on_practices": [
        {
            "introduction": "在分析安全性对控制回路的动态影响之前，我们必须首先量化其在网络资源方面的成本。本练习提供了一个动手实践的机会，用于计算一个现代安全通信协议栈从物理层到应用层的累积开销。通过精确计算每一个字节，您将对安全控制通道的带宽需求建立一个具体的认识。",
            "id": "4210565",
            "problem": "一个带有数字孪生的信息物理系统通过一个基于以下协议栈构建的安全通道传输控制数据包：以太网 II、互联网协议第6版 (IPv6)、用户数据报协议 (UDP) 和使用伽罗瓦/计数器模式的高级加密标准 (AES-GCM) 的数据报传输层安全协议 (DTLS) $1.2$版。为了实现线路上的时序真实性，请包含以太网前导码和帧起始定界符 (SFD) 以及帧间隙。每个样本的应用层控制有效载荷为 $32$ 字节。协议栈元素及其在线路上的开销如下：\n- 以太网前导码和SFD：$8$ 字节\n- 帧间隙：$12$ 字节\n- 以太网 II 报头：$14$ 字节\n- 以太网帧校验序列 (FCS)：$4$ 字节\n- IPv6 报头：$40$ 字节\n- UDP 报头：$8$ 字节\n- DTLS 记录报头：$13$ 字节\n- AES-GCM 携带的显式 DTLS nonce：$8$ 字节\n- AES-GCM 认证标签：$16$ 字节\n- 应用层控制序列号：$4$ 字节\n\n假设每个控制样本都使用上述协议栈和字段精确生成一个数据包。设采样周期为 $T_s = 5 \\times 10^{-4}$ 秒，链路容量为 $10$ 兆比特每秒。使用关联数据包大小、采样频率和所需吞吐量的基本原理，计算：\n1. 单个数据包中由报头、序列号、nonce、标签和线路时间间隙贡献的累积开销（以字节为单位）。\n2. 在给定采样周期下，此控制流量所需的归一化链路利用率，定义为所需吞吐量与链路容量之比。\n\n然后，通过解释利用率来验证采样周期是否可行。将您的最终答案表示为归一化链路利用率（无单位小数）。将您的答案四舍五入到四位有效数字。请勿在最终答案框中包含单位。",
            "solution": "控制传输的基本量是每个样本发送的比特数和采样频率。所需吞吐量遵循速率作为单位时间比特数的定义。设有效载荷用 $P$ (以字节为单位) 表示，累积开销用 $H$ (以字节为单位) 表示。每个样本的总比特数为\n$$\nB = 8\\,(P + H).\n$$\n如果采样周期为 $T_s$，则采样频率为\n$$\nf_s = \\frac{1}{T_s},\n$$\n所需吞吐量为\n$$\nR_{\\text{req}} = B \\, f_s.\n$$\n给定链路容量 $R_{\\text{link}}$，归一化利用率为\n$$\nU = \\frac{R_{\\text{req}}}{R_{\\text{link}}}.\n$$\n\n我们首先计算累积开销 $H$，即所有指定开销部分的总和：\n- 以太网前导码和SFD：$8$ 字节\n- 帧间隙：$12$ 字节\n- 以太网 II 报头：$14$ 字节\n- 以太网 FCS：$4$ 字节\n- IPv6 报头：$40$ 字节\n- UDP 报头：$8$ 字节\n- DTLS 记录报头：$13$ 字节\n- 显式 DTLS nonce：$8$ 字节\n- AES-GCM 认证标签：$16$ 字节\n- 应用控制序列号：$4$ 字节\n\n将这些项相加可得\n$$\nH = 8 + 12 + 14 + 4 + 40 + 8 + 13 + 8 + 16 + 4 = 127 \\text{ 字节}。\n$$\n\n有效载荷 $P = 32$ 字节，则每个样本的总比特数为\n$$\nB = 8\\,(P + H) = 8\\,(32 + 127) = 8 \\times 159 = 1272 \\text{ 比特}。\n$$\n\n采样周期为 $T_s = 5 \\times 10^{-4}$ 秒，因此采样频率为\n$$\nf_s = \\frac{1}{T_s} = \\frac{1}{5 \\times 10^{-4}} = 2000 \\text{ Hz}。\n$$\n\n因此，所需的吞吐量为\n$$\nR_{\\text{req}} = B \\, f_s = 1272 \\times 2000 = 2{,}544{,}000 \\text{ 比特/秒}。\n$$\n\n链路容量为 $R_{\\text{link}} = 10 \\times 10^{6}$ 比特/秒，因此归一化利用率为\n$$\nU = \\frac{R_{\\text{req}}}{R_{\\text{link}}} = \\frac{2{,}544{,}000}{10{,}000{,}000} = 0.2544.\n$$\n\n可行性评估由 $U < 1$ 得出，此条件在此成立，因此在所述假设下，给定的采样周期是可行的。最终要求的量是四舍五入到四位有效数字的归一化链路利用率，该值已经是 $0.2544$。",
            "answer": "$$\\boxed{0.2544}$$"
        },
        {
            "introduction": "前一个练习中计算的开銷会直接转化为传输延迟，这是对任何闭环控制系统稳定性的一个关键威胁。本实践将引导您连接安全与控制这两个领域，通过分析一个带通信延迟的离散时间系统。您将运用稳定性理论的基本原理，来确定由安全措施引入的延迟使系统变得不稳定的精确临界点。",
            "id": "4210596",
            "problem": "一个数字孪生 (DT) 监控并指令一个实现离散时间线性时不变 (LTI) 标量对象的信息物理系统 (CPS)。该对象的动态由 $x_{k+1} = a x_k + b u_k$ 给出，其中 $x_k \\in \\mathbb{R}$ 是对象在离散时间 $k \\in \\mathbb{Z}_{\\ge 0}$ 的状态，$u_k \\in \\mathbb{R}$ 是控制输入。该 DT 使用一个控制感知的加密与传输管道，根据最新可用的状态计算并应用状态反馈，该管道在测量和执行之间引入了一个恒定的整数采样延迟 $\\ell \\in \\mathbb{Z}_{\\ge 0}$。控制律为 $u_k = K x_{k-\\ell}$。要求闭环系统是 Schur 稳定的，这意味着相应状态转移算子的谱半径必须严格小于 1。\n\n在此背景下，考虑一个具有参数 $a = 0.6$、$b = 1$ 和 $K = -0.8$ 的特定 CPS。假设由于加密与传输管道，延迟 $\\ell$ 是恒定的。从第一性原理出发，使用离散时间系统的 Schur 稳定性定义和基本代数工具来分析延迟 $\\ell$ 对闭环特征值的影响。确定使闭环谱半径严格小于 1 的最大整数延迟 $\\ell$。\n\n将您的最终答案表示为一个没有单位的整数。无需四舍五入。",
            "solution": "该问题要求找到最大的整数采样延迟 $\\ell \\in \\mathbb{Z}_{\\ge 0}$，使得一个给定的离散时间线性时不变 (LTI) 系统保持 Schur 稳定。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取给定条件\n- 对象动态：$x_{k+1} = a x_k + b u_k$，其中 $x_k \\in \\mathbb{R}$ 是状态，$u_k \\in \\mathbb{R}$ 是控制输入，$k \\in \\mathbb{Z}_{\\ge 0}$ 是离散时间索引。\n- 系统参数：$a = 0.6$，$b = 1$。\n- 控制律：$u_k = K x_{k-\\ell}$，增益 $K = -0.8$。\n- 延迟：$\\ell \\in \\mathbb{Z}_{\\ge 0}$ 是一个恒定的整数采样延迟。\n- 稳定性要求：闭环系统必须是 Schur 稳定的，这意味着其状态转移算子的谱半径必须严格小于 1。\n\n### 步骤 2：使用提取的条件进行验证\n- **科学依据：** 该问题基于线性控制理论的基本原理，特别是带有时滞的离散时间系统的稳定性分析。所使用的概念（LTI 系统、状态反馈、Schur 稳定性、特征方程）在工程和应用数学中是标准且成熟的。\n- **适定性：** 问题提供了所有必要的参数（$a$、$b$、$K$）和一个清晰、形式化的目标：找到保持 Schur 稳定性的最大整数延迟 $\\ell$。其结构保证了唯一且有意义的解。\n- **客观性：** 问题使用精确的数学语言和定义进行陈述，没有歧义或主观论断。\n\n该问题是自洽的、一致的且科学合理的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个完整且合理的解答。\n\n### 解答\n该信息物理系统的动态由离散时间 LTI 方程给出：\n$$x_{k+1} = a x_k + b u_k$$\n控制输入由一个带有恒定整数延迟 $\\ell$ 的状态反馈律确定：\n$$u_k = K x_{k-\\ell}$$\n将控制律代入对象动态，得到状态 $x_k$ 的闭环方程：\n$$x_{k+1} = a x_k + b K x_{k-\\ell}$$\n为使系统 Schur 稳定，闭环系统状态转移算子的所有特征值的模必须严格小于 1。特征值是系统特征方程的根。\n\n为了找到特征方程，我们可以利用 z 变换。设 $X(z)$ 是状态序列 $x_k$ 的 z 变换。对闭环方程应用 z 变换，我们得到：\n$$z X(z) = a X(z) + b K z^{-\\ell} X(z)$$\n假设存在非平凡解 ($X(z) \\neq 0$)，我们可以两边同除以 $X(z)$ 得到以 $z$ 表示的特征方程：\n$$z = a + b K z^{-\\ell}$$\n两边同乘以 $z^{\\ell}$ 得到特征方程的多项式形式：\n$$z^{\\ell+1} = a z^{\\ell} + b K$$\n$$z^{\\ell+1} - a z^{\\ell} - b K = 0$$\n闭环系统的特征值 $\\lambda$ 是该多项式的根。代入给定参数 $a = 0.6$、$b = 1$ 和 $K = -0.8$，特征方程变为：\n$$\\lambda^{\\ell+1} - 0.6 \\lambda^{\\ell} + 0.8 = 0$$\nSchur 稳定性要求该多项式的所有根 $\\lambda_i$ 都满足 $|\\lambda_i| < 1$。\n\n当至少有一个根位于稳定区域的边界上，即复平面上的单位圆上时，系统从稳定过渡到不稳定。我们通过设 $\\lambda = e^{i\\omega}$（其中频率 $\\omega \\in \\mathbb{R}$）来分析这种边界情况。将其代入特征方程：\n$$e^{i\\omega(\\ell+1)} - 0.6 e^{i\\omega\\ell} + 0.8 = 0$$\n我们可以将其重新排列为：\n$$e^{i\\omega(\\ell+1)} = 0.6 e^{i\\omega\\ell} - 0.8$$\n取两边的模的平方：\n$$|e^{i\\omega(\\ell+1)}|^2 = |0.6 e^{i\\omega\\ell} - 0.8|^2$$\n$e^{i\\phi}$ 的模恒为 1。对于右侧，我们展开复数：\n$$1^2 = |0.6(\\cos(\\omega\\ell) + i\\sin(\\omega\\ell)) - 0.8|^2$$\n$$1 = |(0.6\\cos(\\omega\\ell) - 0.8) + i(0.6\\sin(\\omega\\ell))|^2$$\n$$1 = (0.6\\cos(\\omega\\ell) - 0.8)^2 + (0.6\\sin(\\omega\\ell))^2$$\n$$1 = (0.36\\cos^2(\\omega\\ell) - 0.96\\cos(\\omega\\ell) + 0.64) + 0.36\\sin^2(\\omega\\ell)$$\n$$1 = 0.36(\\cos^2(\\omega\\ell) + \\sin^2(\\omega\\ell)) - 0.96\\cos(\\omega\\ell) + 0.64$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$1 = 0.36 - 0.96\\cos(\\omega\\ell) + 0.64$$\n$$1 = 1 - 0.96\\cos(\\omega\\ell)$$\n这可以简化为：\n$$0 = -0.96\\cos(\\omega\\ell)$$\n$$\\cos(\\omega\\ell) = 0$$\n这是一个根位于单位圆上的必要条件。为了找到对应的频率 $\\omega$，我们分析原始复数方程 $e^{i\\omega(\\ell+1)} - 0.6 e^{i\\omega\\ell} + 0.8 = 0$ 的实部和虚部。\n虚部是：\n$$\\sin(\\omega(\\ell+1)) - 0.6\\sin(\\omega\\ell) = 0$$\n使用和角公式 $\\sin(A+B) = \\sin(A)\\cos(B) + \\cos(A)\\sin(B)$：\n$$\\sin(\\omega\\ell)\\cos(\\omega) + \\cos(\\omega\\ell)\\sin(\\omega) - 0.6\\sin(\\omega\\ell) = 0$$\n代入我们的条件 $\\cos(\\omega\\ell) = 0$：\n$$\\sin(\\omega\\ell)\\cos(\\omega) + (0)\\sin(\\omega) - 0.6\\sin(\\omega\\ell) = 0$$\n$$\\sin(\\omega\\ell)(\\cos(\\omega) - 0.6) = 0$$\n由于 $\\cos(\\omega\\ell) = 0$，必然有 $\\sin(\\omega\\ell) = \\pm 1 \\neq 0$。因此，另一个因子必须为零：\n$$\\cos(\\omega) - 0.6 = 0 \\implies \\cos(\\omega) = 0.6$$\n穿越频率 $\\omega_c$ 是满足 $\\cos(\\omega_c) = 0.6$ 的任意频率。最小的正穿越频率是 $\\omega_c = \\arccos(0.6)$。\n\n条件 $\\cos(\\omega_c \\ell) = 0$ 意味着 $\\omega_c \\ell$ 必须是 $\\pi/2$ 的奇数倍：\n$$\\omega_c \\ell = (2n+1)\\frac{\\pi}{2} \\text{ for some integer } n \\ge 0$$\n第一个根穿越单位圆时的临界延迟 $\\ell_{crit}$ 对应于 $\\ell$ 的最小正值，这在 $n=0$ 时发生：\n$$\\omega_c \\ell_{crit} = \\frac{\\pi}{2}$$\n$$\\ell_{crit} = \\frac{\\pi/2}{\\omega_c} = \\frac{\\pi}{2 \\arccos(0.6)}$$\n为了找到使系统稳定的最大整数 $\\ell$，我们必须检查系统在较小的 $\\ell$ 值下是否稳定，然后找到小于 $\\ell_{crit}$ 的最大整数 $\\ell$。\n\n对于 $\\ell=0$，特征方程为 $\\lambda - 0.6\\lambda^0 + 0.8 = 0$，简化为 $\\lambda - 0.6 + 0.8 = 0$，得出 $\\lambda = -0.2$。由于 $|\\lambda|=0.2 < 1$，系统在 $\\ell=0$ 时是稳定的。这意味着系统对于所有延迟 $0 \\le \\ell < \\ell_{crit}$ 都是稳定的。\n\n现在，我们计算 $\\ell_{crit}$ 的数值。我们知道一些常见角度的余弦值：\n$\\cos(\\pi/3) = 0.5$ 和 $\\cos(\\pi/4) = \\frac{\\sqrt{2}}{2} \\approx 0.707$。\n因为 $0.5 < 0.6 < 0.707$，且反余弦函数在其定义域上是递减函数，所以我们有：\n$$\\arccos(0.5) > \\arccos(0.6) > \\arccos(0.707)$$\n$$\\frac{\\pi}{3} > \\arccos(0.6) > \\frac{\\pi}{4}$$\n现在我们可以确定 $\\ell_{crit}$ 的界限：\n$$\\frac{\\pi/2}{\\pi/3} < \\ell_{crit} < \\frac{\\pi/2}{\\pi/4}$$\n$$1.5 < \\ell_{crit} < 2$$\n临界延迟 $\\ell_{crit}$ 是一个介于 1.5 和 2 之间的值。对于任何满足 $\\ell < \\ell_{crit}$ 的整数延迟 $\\ell$，系统都是 Schur 稳定的。满足此条件的整数是 $\\ell=0$ 和 $\\ell=1$。\n其中最大的整数是 1。对于任何整数延迟 $\\ell \\ge 2$，至少会有一个特征值的模大于或等于 1，使得系统不再是严格 Schur 稳定的。\n\n因此，使闭环谱半径严格小于 1 的最大整数延迟 $\\ell$ 是 1。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "现实世界的工程设计常常涉及在困难的权衡中做出抉择，安全赛博物理系统也不例外。本问题提出了一个场景，其中最强的密码学保障与严格的实时截止时间发生冲突，导致系统不可行。您的任务是进行定量分析，以证明一个“控制感知”设计选择的合理性，展示在特定情况下，为了保证整个系统的稳定性和功能，适当放宽某个安全属性是如何成为一个必要且负责任的决策。",
            "id": "4210549",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 实现了一个采样周期为 $T_s$ 的离散时间控制器，并通过一个专用的安全信道传输控制指令。由于受控对象长时间处于稳态附近，指令很短且在连续采样中经常重复。该安全信道必须强制执行机密性和完整性。正在考虑两种设计方案：\n\n- 方案 R：采用伽罗瓦/计数器模式 (GCM) 的高级加密标准 (AES)，这是一种随机化认证加密。每个数据包包含一个长度为 $v$ 的初始化向量 (IV) 和一个长度为 $t$ 的消息认证码 (MAC) 标签。为保证安全性，AES-GCM 要求使用唯一的 nonce (IV)。\n\n- 方案 D：确定性认证加密 (DAE)，该方案移除了每个数据包的随机 IV，同时通过一个长度为 $t$ 的 MAC 标签来保持完整性。DAE 不是选择明文攻击下不可区分性 (IND-CPA) 安全的，因为在固定的密钥和关联数据下，相同的明文会加密成相同的密文，从而泄露相等模式。\n\n假设控制信道满足以下参数和约束：\n\n- 采样周期 $T_s = 3.3\\,\\mathrm{ms}$。\n- 链路带宽 $B = 192\\,\\mathrm{kbit/s}$。\n- 基础网络延迟（在预留服务下的传播延迟加排队延迟）$L_{\\text{base}} = 1.2\\,\\mathrm{ms}$。\n- 安全控制路径的最坏情况抖动上限 $J_{\\max} = 0.3\\,\\mathrm{ms}$。\n- 每个指令的加密（和解密）计算开销为 $E_{\\text{enc}} = 0.4\\,\\mathrm{ms}$（解密开销由执行器端承担，不影响 DT 的出站截止时间）。\n- 控制指令有效载荷大小 $m = 12\\,\\mathrm{bytes}$。\n- MAC 标签大小 $t = 16\\,\\mathrm{bytes}$。\n- 随机化加密的 IV 大小 $v = 12\\,\\mathrm{bytes}$（方案 R）；方案 D 不携带随机 IV。\n- 链路上的预留控制时隙对每次采样的占用率上限为 $\\rho_{\\max} = 0.5$，其中占用率定义为序列化时间除以 $T_s$。\n- 端到端时序要求：驱动指令必须在下一个采样时刻之前送达；即，最坏情况下的端到端延迟必须严格小于 $T_s$。\n\n将每个数据包的最坏情况端到端延迟 $L_{\\text{wc}}$ 建模为密码学处理时间、基础网络延迟、序列化延迟和抖动之和：\n$$\nL_{\\text{wc}} = E_{\\text{enc}} + L_{\\text{base}} + \\frac{S}{B} + J_{\\max},\n$$\n其中 $S$ 是加密数据包传输的总字节数。对于方案 R，$S_R = m + t + v$。对于方案 D，$S_D = m + t$。\n\n使用所提供的参数计算每种方案的最坏情况延迟和链路占用率。然后，判断在这个具有重复指令的 CPS 中，控制回路严格的时序和带宽约束是否能成为放宽语义安全性（选择明文攻击下的不可区分性，IND-CPA）并选择方案 D 而非方案 R 的正当理由。\n\n哪个选项最正确？\n\nA. 方案 D 是合理的。在给定参数下，方案 R 违反了最坏情况截止时间和占用率上限，而方案 D 两者都满足。因为指令会重复，所以放宽语义安全性（接受密文的相等性）是允许的，前提是辅以周期性重置密钥（例如，每 N 个采样重新派生 DAE 密钥）来限制时间上的可链接性，并同时通过 MAC 保证完整性。这种考虑控制的放宽策略保持了闭环时序的可行性。\n\nB. 方案 R 仍然是强制性的，因为语义安全性绝不能被放宽。即使在给定参数下方案 R 超过了最坏情况截止时间和占用率上限，随机化加密的 IND-CPA 安全性也比控制时序更重要，因此控制器应该接受错过截止时间。\n\nC. 方案 R 可以通过重用 IV 来削减 v 字节的开销来满足约束；在 AES-GCM 中，nonce 重用不会损害完整性，并且在具有短消息的控制设置中是安全的。\n\nD. 方案 D 在没有任何额外措施的情况下是可以接受的。在控制信道中使用长期静态密钥并省略重置密钥或流量整形是足够安全的，因为指令字母表是有限的，并且相等性泄露不会向对手揭示可操作的信息。",
            "solution": "在尝试求解之前，将首先验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤 1：提取给定信息\n\n问题陈述中提供了以下参数、定义和约束：\n-   **系统**：信息物理系统 (CPS) 的数字孪生 (DT) 中的离散时间控制器。\n-   **采样周期**：$T_s = 3.3\\,\\mathrm{ms}$。\n-   **链路带宽**：$B = 192\\,\\mathrm{kbit/s}$。\n-   **基础网络延迟**：$L_{\\text{base}} = 1.2\\,\\mathrm{ms}$。\n-   **最坏情况抖动上限**：$J_{\\max} = 0.3\\,\\mathrm{ms}$。\n-   **加密开销**：$E_{\\text{enc}} = 0.4\\,\\mathrm{ms}$。\n-   **控制指令有效载荷大小**：$m = 12\\,\\mathrm{bytes}$。\n-   **MAC 标签大小**：$t = 16\\,\\mathrm{bytes}$。\n-   **IV 大小（方案 R）**：$v = 12\\,\\mathrm{bytes}$。\n-   **占用率上限**：$\\rho_{\\max} = 0.5$。\n-   **占用率定义**：序列化时间除以 $T_s$。\n-   **时序要求**：最坏情况端到端延迟 $L_{\\text{wc}}$ 必须严格小于 $T_s$。\n-   **延迟模型**：$L_{\\text{wc}} = E_{\\text{enc}} + L_{\\text{base}} + \\frac{S}{B} + J_{\\max}$。\n-   **方案 R 的数据包大小**：$S_R = m + t + v$。\n-   **方案 D 的数据包大小**：$S_D = m + t$。\n-   **安全属性**：\n    -   方案 R (AES-GCM) 是一种随机化认证加密方案，旨在实现选择明文攻击下的不可区分性 (IND-CPA)，并要求使用唯一的 nonce (IV)。\n    -   方案 D (DAE) 是一种确定性认证加密方案，不具有 IND-CPA 安全性，会泄露明文的相等性。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据既定标准对问题陈述进行评估：\n1.  **科学或事实合理性**：问题在科学上是合理的。它提出了一个在实时性能（延迟、带宽）和密码学安全属性（机密性、完整性）之间的现实工程权衡。对 AES-GCM 和确定性认证加密 (DAE) 的描述是正确的；AES-GCM 的安全性依赖于 nonce 的唯一性，而 DAE 有意牺牲 IND-CPA 安全性以实现确定性，这有时会带来性能优势（例如，更小的数据包大小）。延迟模型是对网络延迟组件的标准且合理的简化。\n2.  **不可形式化或不相关**：问题完全可以用给定的方程和参数进行形式化，并且与所述的安全控制 CPS 领域直接相关。\n3.  **不完整或矛盾的设置**：问题是自洽的。它提供了执行所需分析的所有必要数值、公式和约束。没有矛盾之处。\n4.  **不切实际或不可行**：参数对于现代工业控制系统是合理的。3.3ms 的采样周期对应约 303Hz 的控制频率，这要求很高，但对于电机控制等应用是现实的。带宽和延迟值也在专用工业网络的预期范围内。\n5.  **不适定或结构不良**：问题是适定的。它要求进行定量比较，然后根据既定的工程和安全原则做出定性判断。可以进行独特、稳定且有意义的分析。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。该场景是一个明确定义的工程问题，需要进行定量计算，并根据平衡相互竞争的需求做出明智的决策。我现在将继续进行求解推导。\n\n### 推导与分析\n\n分析需要计算方案 R 和方案 D 的最坏情况延迟 ($L_{\\text{wc}}$) 和链路占用率 ($\\rho$)，并将它们与给定的约束条件进行比较：$L_{\\text{wc}} < T_s$ 和 $\\rho < \\rho_{\\max}$。\n\n首先，确定常数并执行必要的单位转换。\n-   $T_s = 3.3\\,\\mathrm{ms} = 3.3 \\times 10^{-3}\\,\\mathrm{s}$。\n-   $B = 192\\,\\mathrm{kbit/s} = 192 \\times 10^3\\,\\mathrm{bit/s}$。\n-   字节到比特的转换是 $1\\,\\mathrm{byte} = 8\\,\\mathrm{bits}$。\n\n**方案 R (随机化 AES-GCM) 的分析**\n\n1.  **数据包大小 ($S_R$)**:\n    总大小是有效载荷、MAC 标签和 IV 的总和。\n    $$S_R = m + t + v = 12\\,\\mathrm{bytes} + 16\\,\\mathrm{bytes} + 12\\,\\mathrm{bytes} = 40\\,\\mathrm{bytes}$$\n    换算成比特：\n    $$S_R = 40\\,\\mathrm{bytes} \\times 8\\,\\mathrm{bits/byte} = 320\\,\\mathrm{bits}$$\n\n2.  **序列化延迟 ($S_R/B$)**:\n    这是在链路上发送数据包所需的时间。\n    $$\\frac{S_R}{B} = \\frac{320\\,\\mathrm{bits}}{192 \\times 10^3\\,\\mathrm{bit/s}} = \\frac{320}{192000}\\,\\mathrm{s} = \\frac{1}{600}\\,\\mathrm{s}$$\n    转换为毫秒：\n    $$\\frac{1}{600}\\,\\mathrm{s} \\times 1000\\,\\mathrm{ms/s} = \\frac{5}{3}\\,\\mathrm{ms} \\approx 1.667\\,\\mathrm{ms}$$\n\n3.  **链路占用率 ($\\rho_R$)**:\n    这是序列化延迟与采样周期的比率。\n    $$\\rho_R = \\frac{S_R/B}{T_s} = \\frac{5/3\\,\\mathrm{ms}}{3.3\\,\\mathrm{ms}} \\approx \\frac{1.667}{3.3} \\approx 0.505$$\n    占用率上限为 $\\rho_{\\max} = 0.5$。由于 $\\rho_R \\approx 0.505 > 0.5$，**方案 R 违反了占用率约束**。\n\n4.  **最坏情况延迟 ($L_{\\text{wc, R}}$)**:\n    我们将延迟分量相加。\n    $$L_{\\text{wc, R}} = E_{\\text{enc}} + L_{\\text{base}} + \\frac{S_R}{B} + J_{\\max}$$\n    $$L_{\\text{wc, R}} = 0.4\\,\\mathrm{ms} + 1.2\\,\\mathrm{ms} + \\frac{5}{3}\\,\\mathrm{ms} + 0.3\\,\\mathrm{ms} = 1.9\\,\\mathrm{ms} + \\frac{5}{3}\\,\\mathrm{ms} \\approx 1.9 + 1.667 = 3.567\\,\\mathrm{ms}$$\n    时序截止时间为 $T_s = 3.3\\,\\mathrm{ms}$。由于 $L_{\\text{wc, R}} \\approx 3.567\\,\\mathrm{ms} > 3.3\\,\\mathrm{ms}$，**方案 R 违反了端到端时序约束**。\n\n**方案 D (确定性 DAE) 的分析**\n\n1.  **数据包大小 ($S_D$)**:\n    总大小是有效载荷和 MAC 标签的总和，没有 IV。\n    $$S_D = m + t = 12\\,\\mathrm{bytes} + 16\\,\\mathrm{bytes} = 28\\,\\mathrm{bytes}$$\n    换算成比特：\n    $$S_D = 28\\,\\mathrm{bytes} \\times 8\\,\\mathrm{bits/byte} = 224\\,\\mathrm{bits}$$\n\n2.  **序列化延迟 ($S_D/B$)**:\n    $$\\frac{S_D}{B} = \\frac{224\\,\\mathrm{bits}}{192 \\times 10^3\\,\\mathrm{bit/s}} = \\frac{224}{192000}\\,\\mathrm{s} = \\frac{7}{6000}\\,\\mathrm{s}$$\n    转换为毫秒：\n    $$\\frac{7}{6000}\\,\\mathrm{s} \\times 1000\\,\\mathrm{ms/s} = \\frac{7}{6}\\,\\mathrm{ms} \\approx 1.167\\,\\mathrm{ms}$$\n\n3.  **链路占用率 ($\\rho_D$)**:\n    $$\\rho_D = \\frac{S_D/B}{T_s} = \\frac{7/6\\,\\mathrm{ms}}{3.3\\,\\mathrm{ms}} \\approx \\frac{1.167}{3.3} \\approx 0.354$$\n    由于 $\\rho_D \\approx 0.354 < 0.5$，**方案 D 满足占用率约束**。\n\n4.  **最坏情况延迟 ($L_{\\text{wc, D}}$)**:\n    $$L_{\\text{wc, D}} = E_{\\text{enc}} + L_{\\text{base}} + \\frac{S_D}{B} + J_{\\max}$$\n    $$L_{\\text{wc, D}} = 0.4\\,\\mathrm{ms} + 1.2\\,\\mathrm{ms} + \\frac{7}{6}\\,\\mathrm{ms} + 0.3\\,\\mathrm{ms} = 1.9\\,\\mathrm{ms} + \\frac{7}{6}\\,\\mathrm{ms} \\approx 1.9 + 1.167 = 3.067\\,\\mathrm{ms}$$\n    由于 $L_{\\text{wc, D}} \\approx 3.067\\,\\mathrm{ms} < 3.3\\,\\mathrm{ms}$，**方案 D 满足端到端时序约束**。\n\n### 定量结果总结\n-   **方案 R**：同时违反了占用率约束 ($\\rho_R \\approx 0.505 > 0.5$) 和延迟截止时间 ($L_{\\text{wc, R}} \\approx 3.567\\,\\mathrm{ms} > 3.3\\,\\mathrm{ms}$)。在给定参数下是不可行的。\n-   **方案 D**：同时满足了占用率约束 ($\\rho_D \\approx 0.354 < 0.5$) 和延迟截止时间 ($L_{\\text{wc, D}} \\approx 3.067\\,\\mathrm{ms} < 3.3\\,\\mathrm{ms}$)。是可行的。\n\n定量分析表明，系统无法在使用方案 R 的情况下正常运行，因为它会错过截止时间，可能导致控制回路不稳定。因此，必须采用一个满足时序约束的解决方案。问题就变成了方案 D 中的安全性放宽是否合理。\n\n### 逐项分析\n\n**A. 方案 D 是合理的。在给定参数下，方案 R 违反了最坏情况截止时间和占用率上限，而方案 D 两者都满足。因为指令会重复，所以放宽语义安全性（接受密文的相等性）是允许的，前提是辅以周期性重置密钥（例如，每 N 个采样重新派生 DAE 密钥）来限制时间上的可链接性，并同时通过 MAC 保证完整性。这种考虑控制的放宽策略保持了闭环时序的可行性。**\n-   第一句话完全由上述计算支持。方案 R 失败，方案 D 成功。\n-   第二句话解决了安全权衡问题。它承认 DAE 的弱点（相等性泄露），但提出了一个标准且有效的缓解措施：周期性重置密钥。这限制了攻击者可以链接相同指令的持续时间，从而限制了信息泄露。这种方法代表了一种合理的工程权衡，优先考虑了基本的操作要求（控制稳定性的时序可行性），同时对安全性采取了经过衡量、风险可控的方法。这种理念通常被称为“安全-控制协同设计”。MAC 的存在保留了完整性，这在控制系统中通常比机密性更关键。\n-   **结论：正确。** 该选项准确反映了计算结果，并提出了一个有效、负责任的工程折衷方案。\n\n**B. 方案 R 仍然是强制性的，因为语义安全性绝不能被放宽。即使在给定参数下方案 R 超过了最坏情况截止时间和占用率上限，随机化加密的 IND-CPA 安全性也比控制时序更重要，因此控制器应该接受错过截止时间。**\n-   该选项断言，一个特定的安全属性 (IND-CPA) 是一个绝对要求，即使以系统故障为代价也必须满足。在实时控制系统中，持续错过截止时间会导致性能下降，并且至关重要的是，可能导致不稳定，从而引发物理损坏或安全隐患。安全的目的是保护系统的功能和安全；一种损害系统基本功能的安全方法是不合逻辑且危险的。这种绝对主义观点是糟糕的工程实践。\n-   **结论：错误。**\n\n**C. 方案 R 可以通过重用 IV 来削减 v 字节的开销来满足约束；在 AES-GCM 中，nonce 重用不会损害完整性，并且在具有短消息的控制设置中是安全的。**\n-   该选项建议了一个密码学上的灾难性行为。在 AES-GCM 中使用相同的密钥重用 nonce (IV) 会完全破坏其机密性和认证属性。具体来说，观察到用相同 nonce 加密的两个密文的攻击者可以恢复认证子密钥，从而使他们能够随意伪造消息。“nonce 重用不会损害完整性”的说法在事实上是错误的，而且是危险的。这是 GCM 最著名的漏洞之一。问题陈述本身也正确地指出，GCM 为保证安全性要求 *唯一* 的 nonce。\n-   **结论：错误。**\n\n**D. 方案 D 在没有任何额外措施的情况下是可以接受的。在控制信道中使用长期静态密钥并省略重置密钥或流量整形是足够安全的，因为指令字母表是有限的，并且相等性泄露不会向对手揭示可操作的信息。**\n-   该选项正确地指出方案 D 是可行的，但对安全风险过于自满。指令相等性的泄露，尤其是在使用长期静态密钥的情况下，可以通过流量分析为对手提供重要的“可操作信息”。攻击者可以了解系统的操作模式，检测状态之间的转换（例如，从空闲到活动），并在不解密任何消息的情况下推断系统对事件的响应。声称这种泄露不可操作是一个未经证实且有风险的假设。良好的安全实践要求，如果可能，应减轻已知的信息泄露。选项 A 提出的重置密钥的建议是该选项所忽视的一个审慎的缓解措施。\n-   **结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}