{
    "hands_on_practices": [
        {
            "introduction": "移动目标防御（MTD）策略通常采用随机切换系统模式的方式，以最大化对攻击者的不可预测性。然而，这种随机性也同样影响防御者自身预测系统状态的能力。本练习旨在量化这种不确定性，通过推导状态协方差的递推公式，您将掌握随机切换系统下不确定性传播的建模方法。这项技能是为采用 MTD 的系统设计异常检测器或状态估计器（如卡尔曼滤波器）的基础，因为它允许数字孪生（Digital Twin）设定合理的置信区间。",
            "id": "4232334",
            "problem": "一个信息物理系统（CPS）采用移动目标防御（MTD）策略，通过在一组有限的离散时间线性模型之间随机切换，以混淆对抗性的系统辨识。物理设备的状态 $x_k \\in \\mathbb{R}^n$ 演化如下：\n$$\nx_k = A_{\\sigma_k} x_{k-1} + w_k,\n$$\n其中 $\\sigma_k \\in \\{1,2,\\dots,m\\}$ 是一个独立同分布的模式索引，满足 $\\mathbb{P}(\\sigma_k = i) = p_i$ 且 $\\sum_{i=1}^m p_i = 1$，而 $A_i \\in \\mathbb{R}^{n \\times n}$ 是已知的确定性矩阵。外源过程噪声 $w_k \\in \\mathbb{R}^n$ 捕捉了未建模的动态和扰动。数字孪生（DT）使用期望状态二阶矩来调整异常检测阈值。\n\n假设初始状态 $x_0$ 是一个均值为零且二阶矩有限的随机向量。数字孪生寻求在时刻 $k$ 的期望状态协方差（二阶矩），其定义为 $P_k \\equiv \\mathbb{E}[x_k x_k^\\top]$，并用 $P_{k-1}$、切换矩阵 $\\{A_i\\}$、概率 $\\{p_i\\}$ 以及噪声二阶矩 $Q \\equiv \\mathbb{E}[w_k w_k^\\top]$ 来表示，其中 $Q$ 是有限的且随时间恒定。\n\n仅从全期望定律和含加性噪声的线性系统的基本性质出发，推导出一个关于 $P_k$ 的单一、闭式解析表达式，该表达式用 $P_{k-1}$、$\\{A_i\\}$、$\\{p_i\\}$ 和 $Q$ 表示，以便数字孪生可以在线计算。明确说明您的推导有效性所需的任何独立性假设。您的最终答案必须是 $P_k$ 关于 $P_{k-1}$、$\\{A_i\\}$、$\\{p_i\\}$ 和 $Q$ 的函数的单一闭式表达式。无需进行数值评估。",
            "solution": "该问题要求为一个切换线性系统推导期望状态协方差（二阶矩）$P_k \\equiv \\mathbb{E}[x_k x_k^\\top]$ 的单一、闭式解析表达式。推导必须基于第一性原理和给定的系统动力学 $x_k = A_{\\sigma_k} x_{k-1} + w_k$。\n\n为了进行严谨的推导，我们必须首先明确陈述此类问题的标准必要统计假设。\n1. 初始状态 $x_0$、过程噪声序列 $\\{w_k\\}_{k \\ge 1}$ 和切换信号序列 $\\{\\sigma_k\\}_{k \\ge 1}$ 是相互独立的。\n2. 过程噪声 $w_k$ 是一个零均值序列，即对所有 $k \\ge 1$，有 $\\mathbb{E}[w_k] = 0$。问题给出初始状态是零均值，$\\mathbb{E}[x_0]=0$。零均值噪声的特性通过归纳法确保状态向量 $x_k$ 对所有 $k \\ge 0$ 保持零均值。均值的递推关系为 $\\mathbb{E}[x_k] = \\mathbb{E}[A_{\\sigma_k} x_{k-1} + w_k] = \\mathbb{E}[A_{\\sigma_k} x_{k-1}] + \\mathbb{E}[w_k]$。由于 $\\sigma_k$ 与 $x_{k-1}$ 独立，因此 $\\mathbb{E}[x_k] = \\mathbb{E}[A_{\\sigma_k}] \\mathbb{E}[x_{k-1}] + 0 = (\\sum_{i=1}^m p_i A_i) \\mathbb{E}[x_{k-1}]$。因为 $\\mathbb{E}[x_0]=0$，所有后续的均值 $\\mathbb{E}[x_k]$ 都为零。这证实了二阶矩 $P_k = \\mathbb{E}[x_k x_k^\\top]$ 确实是状态协方差，$P_k = \\mathbb{E}[(x_k - \\mathbb{E}[x_k])(x_k - \\mathbb{E}[x_k])^\\top]$。\n3. 在时间步 $k$ 的噪声 $w_k$ 与状态 $x_{k-1}$ 和切换信号 $\\sigma_k$ 不相关。这直接源于假设1，因为 $x_{k-1}$ 是 $k$ 之前时间步随机变量的函数。\n4. 切换信号 $\\sigma_k$ 与过去的状态 $x_{k-1}$ 独立。问题陈述 $\\{\\sigma_k\\}$ 是一个独立同分布（i.i.d.）序列。这意味着 $\\sigma_k$ 与直到时间 $k-1$ 的整个系统历史（包括 $x_{k-1}$）都是独立的。\n\n我们通过将状态空间模型代入 $P_k$ 的定义来开始推导：\n$$\nP_k = \\mathbb{E}[x_k x_k^\\top] = \\mathbb{E}[(A_{\\sigma_k} x_{k-1} + w_k) (A_{\\sigma_k} x_{k-1} + w_k)^\\top]\n$$\n展开外积得到：\n$$\nP_k = \\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top + A_{\\sigma_k} x_{k-1} w_k^\\top + w_k x_{k-1}^\\top A_{\\sigma_k}^\\top + w_k w_k^\\top]\n$$\n利用期望算子的线性性质，我们可以分别计算和中的每一项：\n$$\nP_k = \\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top] + \\mathbb{E}[A_{\\sigma_k} x_{k-1} w_k^\\top] + \\mathbb{E}[w_k x_{k-1}^\\top A_{\\sigma_k}^\\top] + \\mathbb{E}[w_k w_k^\\top]\n$$\n让我们分析这四项中的每一项。\n\n第四项在问题陈述中已给出，即恒定的噪声二阶矩 $Q$：\n$$\n\\mathbb{E}[w_k w_k^\\top] = Q\n$$\n第二项和第三项是互相关项。对于第二项 $\\mathbb{E}[A_{\\sigma_k} x_{k-1} w_k^\\top]$，我们援引假设2和3。噪声 $w_k$ 是零均值，且与随机变量 $x_{k-1}$ 和 $\\sigma_k$ 不相关。因此，乘积的期望为零：\n$$\n\\mathbb{E}[A_{\\sigma_k} x_{k-1} w_k^\\top] = \\mathbb{E}[\\mathbb{E}[A_{\\sigma_k} x_{k-1} w_k^\\top | x_{k-1}, \\sigma_k]] = \\mathbb{E}[A_{\\sigma_k} x_{k-1} \\mathbb{E}[w_k^\\top | x_{k-1}, \\sigma_k]] = \\mathbb{E}[A_{\\sigma_k} x_{k-1} \\mathbb{E}[w_k^\\top]] = \\mathbb{E}[A_{\\sigma_k} x_{k-1}] \\cdot 0^\\top = 0\n$$\n第三项 $\\mathbb{E}[w_k x_{k-1}^\\top A_{\\sigma_k}^\\top]$ 是第二项的转置，因此也是一个零矩阵。\n\n第一项 $\\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top]$ 使用全期望定律，通过对随机变量 $\\sigma_k$ 取条件来评估。期望可以表示为对所有可能模式 $i \\in \\{1, 2, \\dots, m\\}$ 的求和：\n$$\n\\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top] = \\sum_{i=1}^m \\mathbb{P}(\\sigma_k=i) \\cdot \\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top | \\sigma_k=i]\n$$\n概率由 $\\mathbb{P}(\\sigma_k=i) = p_i$ 给出。当我们以 $\\sigma_k=i$ 为条件时，随机矩阵 $A_{\\sigma_k}$ 变为确定性矩阵 $A_i$：\n$$\n\\sum_{i=1}^m p_i \\cdot \\mathbb{E}[A_i x_{k-1} x_{k-1}^\\top A_i^\\top | \\sigma_k=i]\n$$\n根据假设4，状态 $x_{k-1}$ 与当前的切换信号 $\\sigma_k$ 独立。因此，以 $\\sigma_k=i$ 为条件不影响 $x_{k-1}$ 的分布，我们可以从期望中移除该条件：\n$$\n\\mathbb{E}[A_i x_{k-1} x_{k-1}^\\top A_i^\\top | \\sigma_k=i] = \\mathbb{E}[A_i x_{k-1} x_{k-1}^\\top A_i^\\top]\n$$\n由于 $A_i$ 是一个确定性矩阵，可以将其从期望中提出：\n$$\nA_i \\mathbb{E}[x_{k-1} x_{k-1}^\\top] A_i^\\top\n$$\n根据定义，$\\mathbb{E}[x_{k-1} x_{k-1}^\\top] = P_{k-1}$。将其代回，第一项评估为：\n$$\n\\mathbb{E}[A_{\\sigma_k} x_{k-1} x_{k-1}^\\top A_{\\sigma_k}^\\top] = \\sum_{i=1}^m p_i A_i P_{k-1} A_i^\\top\n$$\n最后，我们合并所有四项的结果，得到 $P_k$ 的递推表达式：\n$$\nP_k = \\left( \\sum_{i=1}^m p_i A_i P_{k-1} A_i^\\top \\right) + 0 + 0 + Q\n$$\n这就提供了所要求的关于 $P_k$ 的单一、闭式解析表达式，该表达式用 $P_{k-1}$、$\\{A_i\\}$、$\\{p_i\\}$ 和 $Q$ 表示。",
            "answer": "$$\n\\boxed{\nP_k = \\sum_{i=1}^{m} p_i A_i P_{k-1} A_i^\\top + Q\n}\n$$"
        },
        {
            "introduction": "尽管移动目标防御旨在迷惑攻击者，但一个首要的约束是防御者绝不能失去对物理过程的控制。切换系统动态可能会带来失去能控性的风险。本实践聚焦于分析时变系统的能控性，这一概念通过有限时域能控性格拉姆矩阵（controllability Gramian）来刻画。通过计算该矩阵并分析其性质，您将学会如何验证一个特定的 MTD 调度策略是否保留了在有限时间内将系统驱动到任意期望状态的能力，这是一项关键的安全与操作要求。",
            "id": "4232307",
            "problem": "考虑一个具有移动目标防御（MTD）的2维离散时间信息物理系统（CPS），该系统被建模为一个时变线性系统，其切换对 $\\{(A_{k}, B_{k})\\}$ 由数字孪生（DT）选择，以挫败对手的系统辨识。该系统根据 $x_{k+1} = A_{k} x_{k} + B_{k} u_{k}$ 演化，其中 $x_{k} \\in \\mathbb{R}^{2}$ 且 $u_{k} \\in \\mathbb{R}$。\n\n数字孪生（DT）在一个 $N=3$ 步的有限时域内实施一个防御调度，采用以下模式序列：\n$$\nA_{0} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad B_{0} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad\nA_{1} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}, \\quad B_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n$$\nA_{2} = \\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix}, \\quad B_{2} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n其中 $\\delta \\in \\mathbb{R}$ 是一个可调的 MTD 参数，表示一个被引入以改变有效动态同时保持物理可行性的小模型扰动。\n\n使用离散时间时变线性系统的有限时域能控性格拉姆矩阵的基本定义（使用适当的状态转移算子），推导给定调度下的显式有限时域能控性格拉姆矩阵 $W_{3}(\\delta)$，并计算 $\\det(W_{3}(\\delta))$，使其成为关于 $\\delta$ 的闭式解析表达式。然后，根据有限时域能控性格拉姆矩阵，陈述保证在 MTD 引起的参数变化下系统仍然可控的条件。仅报告 $\\det(W_{3}(\\delta))$ 作为您的最终答案。无需四舍五入，也不涉及单位。",
            "solution": "用户希望求出离散时间线性时变系统的有限时域能控性格拉姆矩阵的行列式。\n\n### 步骤 1：提取已知条件\n- 系统方程：$x_{k+1} = A_{k} x_{k} + B_{k} u_{k}$，其中 $x_{k} \\in \\mathbb{R}^{2}$ 且 $u_{k} \\in \\mathbb{R}$。\n- 有限时域：$N=3$ 步。\n- $k=0, 1, 2$ 时的模式序列：\n  - $A_{0} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $B_{0} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n  - $A_{1} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$, $B_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n  - $A_{2} = \\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix}$, $B_{2} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n- 参数：$\\delta \\in \\mathbb{R}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的、客观的。它基于线性系统和控制理论的标准原理，特别是离散时间线性时变 (LTV) 系统的能控性格拉姆矩阵概念。其在信息物理系统中的移动目标防御应用是一个有效且前沿的研究领域。该问题是自洽的，所有必要的矩阵、参数和时域都已指定。它要求一个具体的、可推导的数学表达式，因此存在唯一解。语言正式且无歧义。该问题并非无足轻重，因为它需要涉及状态转移矩阵和矩阵代数的多步计算。\n\n### 步骤 3：结论与行动\n问题有效。我将继续提供完整的解法。\n\n离散时间 LTV 系统在 $N$ 步时域内的有限时域能控性格拉姆矩阵定义为：\n$$\nW_{N} = \\sum_{k=0}^{N-1} \\Phi(N, k+1) B_{k} B_{k}^{T} \\Phi(N, k+1)^{T}\n$$\n其中状态转移矩阵 $\\Phi(i, j)$ 由 $\\Phi(i, j) = A_{i-1} A_{i-2} \\cdots A_{j}$ (当 $i > j$) 给出，且 $\\Phi(i, i) = I$ 为单位矩阵。\n\n给定 $N=3$ 的时域，格拉姆矩阵 $W_{3}(\\delta)$ 为：\n$$\nW_{3}(\\delta) = \\sum_{k=0}^{2} \\Phi(3, k+1) B_{k} B_{k}^{T} \\Phi(3, k+1)^{T}\n$$\n$$\nW_{3}(\\delta) = \\Phi(3, 1) B_{0} B_{0}^{T} \\Phi(3, 1)^{T} + \\Phi(3, 2) B_{1} B_{1}^{T} \\Phi(3, 2)^{T} + \\Phi(3, 3) B_{2} B_{2}^{T} \\Phi(3, 3)^{T}\n$$\n\n首先，我们计算所需的状态转移矩阵：\n\\begin{itemize}\n    \\item $\\Phi(3, 3) = I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$\n    \\item $\\Phi(3, 2) = A_{2} = \\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix}$\n    \\item $\\Phi(3, 1) = A_{2} A_{1} = \\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(0)(0)  (1)(1)+(0)(1) \\\\ (\\delta)(1)+(1)(0)  (\\delta)(1)+(1)(1) \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ \\delta  \\delta+1 \\end{pmatrix}$\n\\end{itemize}\n\n接下来，我们计算 $W_{3}(\\delta)$ 求和式中的各个项。\n\n对于 $k=0$：\n该项为 $\\Phi(3, 1) B_{0} B_{0}^{T} \\Phi(3, 1)^{T}$。\n我们有 $B_{0} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，所以 $B_{0} B_{0}^{T} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n乘积为：\n$$\n\\begin{pmatrix} 1  1 \\\\ \\delta  \\delta+1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ \\delta  \\delta+1 \\end{pmatrix}^{T} = \\begin{pmatrix} 1  0 \\\\ \\delta  0 \\end{pmatrix} \\begin{pmatrix} 1  \\delta \\\\ 1  \\delta+1 \\end{pmatrix} = \\begin{pmatrix} 1  \\delta \\\\ \\delta  \\delta^{2} \\end{pmatrix}\n$$\n\n对于 $k=1$：\n该项为 $\\Phi(3, 2) B_{1} B_{1}^{T} \\Phi(3, 2)^{T}$。\n我们有 $B_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，所以 $B_{1} B_{1}^{T} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。\n乘积为：\n$$\n\\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ \\delta  1 \\end{pmatrix}^{T} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\delta \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n\n对于 $k=2$：\n该项为 $\\Phi(3, 3) B_{2} B_{2}^{T} \\Phi(3, 3)^{T}$。\n我们有 $B_{2} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，所以 $B_{2} B_{2}^{T} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$。\n乘积为：\n$$\nI \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} I^{T} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n现在，我们将这三个矩阵相加，得到 $W_{3}(\\delta)$：\n$$\nW_{3}(\\delta) = \\begin{pmatrix} 1  \\delta \\\\ \\delta  \\delta^{2} \\end{pmatrix} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n$$\nW_{3}(\\delta) = \\begin{pmatrix} 1+0+1  \\delta+0+1 \\\\ \\delta+0+1  \\delta^{2}+1+1 \\end{pmatrix} = \\begin{pmatrix} 2  \\delta+1 \\\\ \\delta+1  \\delta^{2}+2 \\end{pmatrix}\n$$\n\n最后一步是计算 $W_{3}(\\delta)$ 的行列式：\n$$\n\\det(W_{3}(\\delta)) = \\det\\begin{pmatrix} 2  \\delta+1 \\\\ \\delta+1  \\delta^{2}+2 \\end{pmatrix}\n$$\n$$\n\\det(W_{3}(\\delta)) = (2)(\\delta^{2}+2) - (\\delta+1)(\\delta+1)\n$$\n$$\n\\det(W_{3}(\\delta)) = 2\\delta^{2} + 4 - (\\delta^{2} + 2\\delta + 1)\n$$\n$$\n\\det(W_{3}(\\delta)) = 2\\delta^{2} + 4 - \\delta^{2} - 2\\delta - 1\n$$\n$$\n\\det(W_{3}(\\delta)) = \\delta^{2} - 2\\delta + 3\n$$\n\n对于离散时间 LTV 系统，在时域 $[0, N)$ 内保证能控性的条件是有限时域能控性格拉姆矩阵 $W_{N}$ 是非奇异的，即可逆的。这等价于条件 $\\det(W_{N}) \\neq 0$。对于给定系统，条件是 $\\det(W_{3}(\\delta)) \\neq 0$。表达式 $\\delta^{2} - 2\\delta + 3$ 是一个关于 $\\delta$ 的二次式，其判别式为 $(-2)^2 - 4(1)(3) = 4 - 12 = -8  0$。由于首项系数为正且判别式为负，该二次式没有实根，并且对于所有实数 $\\delta$ 都严格为正。因此，对于所有 $\\delta \\in \\mathbb{R}$，$\\det(W_{3}(\\delta))  0$，这意味着对于 MTD 参数 $\\delta$ 的任何选择，系统都是可控的。问题要求的是 $\\det(W_{3}(\\delta))$ 的表达式。",
            "answer": "$$\\boxed{\\delta^{2} - 2\\delta + 3}$$"
        },
        {
            "introduction": "鲁棒防御的基石是态势感知能力。一个 MTD 策略的有效性，取决于防御者的数字孪生能否持续地从传感器测量中准确估计系统的真实状态。本问题深入探讨了时变系统的均匀能观测性（uniform observability）概念，它保证了无论从何时开始观测，系统状态都是可重构的。完成此练习将巩固您对如何运用能观测性矩阵的理解，以证明一个 MTD 调度策略在动态变化的同时，并不会“蒙蔽”防御者自身，从而确保数字孪生始终是可靠的“真理之源”。",
            "id": "4232341",
            "problem": "一个信息物理系统（CPS）采用移动目标防御（MTD）策略，通过周期性地切换其动态特性和传感方式来迷惑攻击者，同时在其数字孪生中保持状态感知。考虑离散时间线性时变系统\n$$\nx_{k+1} = A_k x_k,\\quad y_k = C_k x_k,\n$$\n其中 $x_k \\in \\mathbb{R}^n$，$y_k \\in \\mathbb{R}^p$，并且对偶序列 $\\{(A_k,C_k)\\}_{k \\in \\mathbb{Z}_{\\ge 0}}$ 对防御方是已知的，并在数字孪生中完全相同地复制。\n\n仅从状态转移复合规则以及有限时间域上的状态可重构性要求从初始状态到堆叠输出的映射具有单射性这一定义出发，完成以下任务：\n\n1) 为时变对偶序列 $\\{(A_k,C_k)\\}$ 定义一致可观测性。您的定义必须根据有限时间域可观测性格拉姆矩阵以及一个对所有起始索引都成立的一致正定性属性来给出。\n\n2) 从第一性原理出发，推导一个在有限时间域上施加于时变可观测性矩阵的充要秩条件，该条件确保在MTD下，数字孪生能够一致地（对所有时间）实现状态重构。您的推导必须明确构造状态转移映射和堆叠输出映射，并说明为何该秩条件等价于单射性。\n\n3) 防御方的MTD调度以周期为2交替切换模型，具体如下。对于偶数 $k$，系统使用\n$$\nA_k = A_1 = \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix},\\quad C_k = C_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix}.\n$$\n对于奇数 $k$，系统使用\n$$\nA_k = A_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix},\\quad C_k = C_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix}.\n$$\n假设测量无噪声且切换规律已知，计算最小整数时间域长度 $L^{\\star}$，使得对于每个起始索引 $k$，在 $L^{\\star}$ 步内，时变可观测性矩阵都具有满列秩，从而保证在该MTD调度下数字孪生能够实现状态重构。请给出 $L^{\\star}$ 的值作为最终答案。无需四舍五入，不涉及物理单位。",
            "solution": "首先对问题进行验证，以确保其科学性、适定性和客观性。问题陈述描述了一个在信息物理系统（CPS）的移动目标防御（MTD）背景下的离散时间线性时变（LTV）系统。任务涉及定义一致可观测性、推导状态可重构性的条件，以及为一个给定的切换调度计算特定的最小观测时间域。经查，问题的所有方面都植根于线性系统和控制理论的既定原则。问题是自洽的，提供了所有必要的数据和定义，并且没有矛盾、歧义或事实错误。这是一个适定的理论问题，存在唯一且有意义的解。因此，该问题被认定为有效。\n\n解答分为三部分，对应问题陈述中要求的三个任务。\n\n### 第1部分：一致可观测性的定义\n\n考虑由以下方程描述的离散时间线性时变（LTV）系统：\n$$\nx_{k+1} = A_k x_k\n$$\n$$\ny_k = C_k x_k\n$$\n其中 $k \\in \\mathbb{Z}_{\\ge 0}$ 是离散时间索引，$x_k \\in \\mathbb{R}^n$ 是状态向量，$y_k \\in \\mathbb{R}^p$ 是输出向量。矩阵 $A_k$ 和 $C_k$ 是时变的。\n\n时刻 $j$ 的状态可以通过状态转移矩阵 $\\Phi(j,k)$ 与较早时刻 $k$ ($jk$) 的状态相关联，其定义为：\n$$\n\\Phi(j, k) = A_{j-1} A_{j-2} \\cdots A_k, \\quad \\text{for } j  k\n$$\n并且 $\\Phi(k, k) = I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。\n因此，从时刻 $k_0$ 的初始状态 $x_{k_0}$ 演化到时刻 $j$ 的状态由 $x_j = \\Phi(j, k_0) x_{k_0}$ 给出。\n\n时刻 $j$ 的输出则可以用初始状态 $x_{k_0}$ 表示为：\n$$\ny_j = C_j x_j = C_j \\Phi(j, k_0) x_{k_0}\n$$\n为了重构初始状态 $x_{k_0}$，我们收集从时刻 $k_0$ 到 $k_0+L-1$ 的长度为 $L$ 的有限时间域内的输出。令 $Y(k_0, L)$ 为这些输出的堆叠向量：\n$$\nY(k_0, L) = \\begin{pmatrix} y_{k_0} \\\\ y_{k_0+1} \\\\ \\vdots \\\\ y_{k_0+L-1} \\end{pmatrix} = \\begin{pmatrix} C_{k_0} \\Phi(k_0, k_0) \\\\ C_{k_0+1} \\Phi(k_0+1, k_0) \\\\ \\vdots \\\\ C_{k_0+L-1} \\Phi(k_0+L-1, k_0) \\end{pmatrix} x_{k_0}\n$$\n该方程的形式为 $Y(k_0, L) = \\mathcal{O}(k_0, L) x_{k_0}$，其中 $\\mathcal{O}(k_0, L)$ 是在区间 $[k_0, k_0+L-1]$ 上的时变可观测性矩阵。\n\n对于起始时刻 $k_0$ 和时间域长度 $L$，有限时间域可观测性格拉姆矩阵是一个 $n \\times n$ 矩阵，定义为：\n$$\nW_o(k_0, L) = \\mathcal{O}(k_0, L)^T \\mathcal{O}(k_0, L) = \\sum_{j=k_0}^{k_0+L-1} \\Phi(j, k_0)^T C_j^T C_j \\Phi(j, k_0)\n$$\n如果从输出序列区分任意两个初始状态的能力一致有下界，而与起始时间无关，则称系统是一致可观测的。其正式定义如下：\n\n如果存在一个正整数 $L$ 和正常数 $\\alpha$ 和 $\\beta$，使得对于所有起始时刻 $k_0 \\ge 0$，可观测性格拉姆矩阵满足：\n$$\n\\alpha I \\le W_o(k_0, L) \\le \\beta I\n$$\n则LTV系统 $\\{(A_k, C_k)\\}$ 是**一致可观测的**。\n此定义的关键部分是存在一个一致下界 $\\alpha  0$，这确保了对于任何起始时刻 $k_0$，格拉姆矩阵 $W_o(k_0, L)$ 都是正定的，其最小特征值有界且不为零。这保证了 $x_{k_0}$ 可以从测量值中被鲁棒地重构。\n\n### 第2部分：状态可重构性秩条件的推导\n\n数字孪生的状态可重构性要求初始状态 $x_{k_0}$ 能够从某个有限时间域 $L$ 内的输出序列 $y_{k_0}, y_{k_0+1}, \\dots, y_{k_0+L-1}$ 中唯一确定。该分析从状态转移复合规则开始，导出第1部分中得到的堆叠输出方程：\n$$\nY(k_0, L) = \\mathcal{O}(k_0, L) x_{k_0}\n$$\n唯一状态重构问题等价于从初始状态 $x_{k_0} \\in \\mathbb{R}^n$ 到堆叠输出向量 $Y(k_0, L) \\in \\mathbb{R}^{pL}$ 的线性映射具有单射性。该映射由时变可观测性矩阵 $\\mathcal{O}(k_0, L)$ 表示。\n\n一个线性映射是单射的，当且仅当其零空间（或核）是平凡的，即只包含零向量。也就是说，方程 $\\mathcal{O}(k_0, L) x_{k_0} = 0$ 的唯一解是 $x_{k_0} = 0$。这个条件意味着没有非零初始状态可以在该时间域内产生零输出序列，因此任何两个不同的初始状态必须产生不同的输出序列。\n\n对于维度为 $(pL) \\times n$ 的矩阵 $\\mathcal{O}(k_0, L)$ 来说，其零空间为平凡的条件等价于其列是线性无关的。一个矩阵具有线性无关的列，当且仅当其秩等于其列数。\n\n因此，在有限时间域 $[k_0, k_0+L-1]$ 上状态可重构的一个充要条件是：\n$$\n\\text{rank}(\\mathcal{O}(k_0, L)) = n\n$$\n为了保证在MTD方案下，这种可重构性在时间上是一致的，必须存在一个有限整数时间域长度 $L$，使得该秩条件对**每一个**可能的起始索引 $k \\ge 0$ 都成立。\n\n该秩条件等价于可观测性格拉姆矩阵 $W_o(k, L) = \\mathcal{O}(k, L)^T \\mathcal{O}(k, L)$ 对所有 $k$ 都是可逆的（因此是正定的，因为它总是半正定的）。$W_o(k,L)$ 的秩与 $\\mathcal{O}(k,L)$ 的秩相同。由于 $W_o(k,L)$ 是一个 $n \\times n$ 矩阵，它可逆当且仅当其秩为 $n$。\n\n### 第3部分：最小时间域长度 $L^{\\star}$ 的计算\n\n特定的MTD调度涉及一个周期为 $2$ 的周期性切换。状态维度为 $n=3$，输出维度为 $p=1$。\n对于偶数 $k$：$A_k = A_1 = \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix}$，$C_k = C_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix}$。\n对于奇数 $k$：$A_k = A_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix}$，$C_k = C_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix}$。\n\n我们需要找到最小整数 $L^{\\star}$，使得对所有 $k \\ge 0$，$\\text{rank}(\\mathcal{O}(k, L^{\\star}))=3$。\n可观测性矩阵 $\\mathcal{O}(k, L)$ 是一个 $L \\times 3$ 的矩阵（因为 $p=1$）。要使其秩为 $3$，它必须至少有 $3$ 行，这意味着时间域长度 $L$ 必须至少为 $3$。因此，$L^{\\star} \\ge 3$。\n\n由于系统矩阵具有 $2$-周期性，条件 $\\text{rank}(\\mathcal{O}(k, L)) = 3$ 对所有 $k$ 成立，可以通过检查两种代表性情况来验证：在偶数时刻开始（$k=0$）和在奇数时刻开始（$k=1$）。\n\n让我们测试最小可能的时间域，$L=3$。\n\n**情况1：在偶数时刻开始（$k=0$）**\n我们有 $\\mathcal{O}(0, 3) = \\begin{pmatrix} C_0 \\\\ C_1 A_0 \\\\ C_2 A_1 A_0 \\end{pmatrix}$。根据时间索引的奇偶性（$k=0$偶，$k=1$奇，$k=2$偶），我们用相应的模型矩阵 $(A_1, C_1)$ 或 $(A_2, C_2)$ 替换，得到：\n$$\n\\mathcal{O}(0, 3) = \\begin{pmatrix} C_1 \\\\ C_2 A_1 \\\\ C_1 A_2 A_1 \\end{pmatrix}\n$$\n我们来计算各行：\n- 第1行：$C_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix}$。\n- 第2行：$C_2 A_1 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  1 \\end{pmatrix}$。\n- 乘积 $A_2 A_1 = \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 0  1  2 \\\\ 0  0  1 \\end{pmatrix}$。\n- 第3行：$C_1 (A_2 A_1) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 0  1  2 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\end{pmatrix}$。\n所以，可观测性矩阵是：\n$$\n\\mathcal{O}(0, 3) = \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 1  1  0 \\end{pmatrix}\n$$\n其行列式为 $\\det(\\mathcal{O}(0, 3)) = 1(0-1) - 0(0-1) + 0(0-1) = -1 \\ne 0$。\n由于行列式非零，所以 $\\text{rank}(\\mathcal{O}(0, 3)) = 3$。\n\n**情况2：在奇数时刻开始（$k=1$）**\n我们有 $\\mathcal{O}(1, 3) = \\begin{pmatrix} C_1 \\\\ C_2 A_1 \\\\ C_3 A_2 A_1 \\end{pmatrix}$。根据时间索引的奇偶性（$k=1$奇，$k=2$偶，$k=3$奇），我们用相应的模型矩阵 $(A_1, C_1)$ 或 $(A_2, C_2)$ 替换，得到：\n$$\n\\mathcal{O}(1, 3) = \\begin{pmatrix} C_2 \\\\ C_1 A_2 \\\\ C_2 A_1 A_2 \\end{pmatrix}\n$$\n我们来计算各行：\n- 第1行：$C_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix}$。\n- 第2行：$C_1 A_2 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\end{pmatrix}$。\n- 乘积 $A_1 A_2 = \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\\\ 0  0  1 \\end{pmatrix}$。\n- 第3行：$C_2 (A_1 A_2) = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  2 \\end{pmatrix}$。\n所以，可观测性矩阵是：\n$$\n\\mathcal{O}(1, 3) = \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  1  2 \\end{pmatrix}\n$$\n其行列式为 $\\det(\\mathcal{O}(1, 3)) = 0 - 1(1 \\cdot 2 - 0 \\cdot 0) + 0 = -2 \\ne 0$。\n由于行列式非零，所以 $\\text{rank}(\\mathcal{O}(1, 3)) = 3$。\n\n两种代表性情况都得到了对于 $L=3$ 的满秩可观测性矩阵。由于任何偶数起始时刻 $k=2m$ 的行为都与 $k=0$ 相同，任何奇数起始时刻 $k=2m+1$ 的行为都与 $k=1$ 相同，我们可以得出结论，对于所有 $k \\ge 0$，$\\text{rank}(\\mathcal{O}(k, 3))=3$。\n\n我们已经确定 $L^{\\star}$ 必须至少为 $3$。现在我们证明了 $L=3$ 是充分的。因此，保证一致状态可重构性的最小整数时间域长度是 $L^{\\star}=3$。",
            "answer": "$$\n\\boxed{3}\n$$"
        }
    ]
}