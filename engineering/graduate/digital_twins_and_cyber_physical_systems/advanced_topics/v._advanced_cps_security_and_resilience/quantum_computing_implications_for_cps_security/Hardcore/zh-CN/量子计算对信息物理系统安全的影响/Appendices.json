{
    "hands_on_practices": [
        {
            "introduction": "为网络物理系统（CPS）选择合适的后量子密码（PQC）算法是确保其长期安全的关键第一步。这个练习模拟了一个典型的工程决策场景，您需要为一个资源受限的嵌入式控制器，在多种PQC候选方案之间进行权衡 。通过构建一个覆盖内存占用、计算性能、网络负载和可靠性等多维度约束的决策矩阵，您将能够掌握在实际系统设计中进行多目标优化的核心技能。",
            "id": "4237752",
            "problem": "一个信息物理系统 (CPS) 使用数字孪生来协调对嵌入式控制器的安全远程校准和固件更新。在应用任何控制平面变更之前，控制器必须与数字孪生建立一个新的对称会话密钥，并执行相互实体认证。为了抵御量子对手的攻击，您必须为该控制器选择一个后量子密码学 (PQC) 密钥封装机制 (KEM) 和一个 PQC 签名方案。该控制器的闪存预算为 $256\\,\\mathrm{KB}$，随机存取存储器 (RAM) 预算为 $64\\,\\mathrm{KB}$。其微控制器是一个 $32$ 位核心，时钟频率为 $120\\,\\mathrm{MHz}$，没有硬件浮点单元。控制网络是速率为 $1\\,\\mathrm{Mb/s}$ 的可靠链路。\n\n假设一个最小化握手协议，其序列和消息大小由所选方案决定如下：\n1. 控制器 $\\rightarrow$ 孪生：大小为 $S_{\\mathrm{pk}}$ 的 KEM 公钥。\n2. 孪生 $\\rightarrow$ 控制器：大小为 $S_{\\mathrm{ct}}$ 的 KEM 密文（控制器解封装以派生共享密钥）。\n3. 孪生 $\\rightarrow$ 控制器：$32$ 字节的挑战随机数；控制器 $\\rightarrow$ 孪生：对该随机数的签名，大小为 $S_{\\mathrm{sig}}$，以及签名公钥，大小为 $S_{\\mathrm{spk}}$。\n4. 控制器 $\\rightarrow$ 孪生：$32$ 字节的挑战随机数；孪生 $\\rightarrow$ 控制器：对该随机数的签名，大小为 $S_{\\mathrm{sig}}$，以及签名公钥，大小为 $S_{\\mathrm{spk}}$。\n\n控制器必须将其长期私钥存储在闪存中，并使密码学库（代码）、持久密钥和任何常量表都符合 $256\\,\\mathrm{KB}$ 的闪存预算。在任何密码学操作期间，包括栈和缓冲区在内的峰值 RAM 使用量不得超过 $64\\,\\mathrm{KB}$。假设在消息处理期间，RAM 中分配了 $4\\,\\mathrm{KB}$ 的网络缓冲区。孪生可以在设备外配置更大的资源，因此这些限制仅适用于控制器。\n\n基于第一性原理和经过充分测试的事实，请在您的推理中使用以下基本定义：\n- 在频率为 $f$ 的处理器上执行总周期数为 $C$ 的指令序列所需的时间为 $t_{\\mathrm{CPU}} = C / f$。\n- 在比特率为 $R$ 的链路上传输 $B$ 字节所需的时间为 $t_{\\mathrm{NET}} = 8B / R$。\n- 端到端握手时间是所有步骤中计算延迟和通信延迟的总和，$t_{\\mathrm{E2E}} = \\sum t_{\\mathrm{CPU}} + \\sum t_{\\mathrm{NET}}$。\n- 如果失效事件是独立的，其概率为 $p_i$，则至少发生一次失效的概率为 $1 - \\prod_i (1 - p_i)$。\n\n您正在评估四对候选方案。对于每一对，都给出了在这类微控制器上具有代表性且科学上合理的度量指标：\n\n候选方案数据：\n- ML-KEM-512（模块格 KEM，NIST 1级）：$S_{\\mathrm{pk}} = 800\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 768\\,\\mathrm{B}$，代码占用 $32\\,\\mathrm{KB}$，密钥 $2.4\\,\\mathrm{KB}$，封装周期 $1.8\\times 10^6$，解封装周期 $2.0\\times 10^6$，峰值 RAM $12\\,\\mathrm{KB}$，使用标准变换实现时解密失败概率  $2^{-128}$。\n- Dilithium-2（基于格的签名，NIST 2级）：$S_{\\mathrm{spk}} = 1312\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 2420\\,\\mathrm{B}$，代码占用 $36\\,\\mathrm{KB}$，密钥 $2.5\\,\\mathrm{KB}$，签名周期 $1.5\\times 10^6$，验证周期 $0.9\\times 10^6$，峰值 RAM $24\\,\\mathrm{KB}$，正确实现下失效行为可忽略不计。\n- Falcon-512（使用快速傅里叶变换算法的基于格的签名）：$S_{\\mathrm{spk}} = 897\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 666\\,\\mathrm{B}$，代码占用 $60\\,\\mathrm{KB}$，密钥 $2.3\\,\\mathrm{KB}$，签名周期 $1.8\\times 10^7$，验证周期 $5.0\\times 10^6$，峰值 RAM $32\\,\\mathrm{KB}$，在无硬件浮点单元时有大量栈使用。\n- FrodoKEM-640（使用标准格的带错误学习 KEM）：$S_{\\mathrm{pk}} = 9616\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 9720\\,\\mathrm{B}$，代码占用 $60\\,\\mathrm{KB}$，密钥 $19\\,\\mathrm{KB}$，封装周期 $1.2\\times 10^7$，解封装周期 $1.1\\times 10^7$，峰值 RAM $\\approx 64\\,\\mathrm{KB}$（缓冲区和矩阵），正确实现下失效行为可忽略不计。\n- SPHINCS+-128s（基于哈希的签名，NIST 1级）：$S_{\\mathrm{spk}} = 32\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 7856\\,\\mathrm{B}$，代码占用 $80\\,\\mathrm{KB}$，密钥 $64\\,\\mathrm{B}$，签名周期 $6.0\\times 10^7$，验证周期 $3.0\\times 10^7$，峰值 RAM $20\\,\\mathrm{KB}$，正确实现下失效行为可忽略不计。\n- Classic McEliece mceliece348864（基于编码的 KEM，NIST 1级）：$S_{\\mathrm{pk}} = 261{,}120\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 128\\,\\mathrm{B}$，代码占用 $64\\,\\mathrm{KB}$，密钥 $649{,}000\\,\\mathrm{B}$，封装周期 $2.0\\times 10^6$，解封装周期 $2.5\\times 10^6$，峰值 RAM $16\\,\\mathrm{KB}$，正确实现下失效行为可忽略不计。\n\n假设握手协议如前所述，传输一个 KEM 公钥和一个 KEM 密文，以及两个签名和两个签名公钥（每方一个）。使用 $4\\,\\mathrm{KB}$ 的网络缓冲区和活动算法的峰值 RAM 来检查 RAM 约束。控制器必须容纳两个密码学库、其私钥和典型的支持代码；在本练习中，假设非密码学应用程序代码占用 $120\\,\\mathrm{KB}$ 的闪存，为密码学代码和密钥留下 $136\\,\\mathrm{KB}$。\n\n构建一个决策矩阵，根据以下标准评估每对候选方案：\n- 闪存使用量：密码学代码加上存储的私钥必须 $\\leq 136\\,\\mathrm{KB}$。\n- 峰值 RAM：算法峰值加上网络缓冲区必须 $\\leq 64\\,\\mathrm{KB}$。\n- 网络负载：总握手字节数 $B_{\\mathrm{total}}$。\n- 端到端时间：使用 $f = 120\\times 10^6\\,\\mathrm{Hz}$ 和 $R = 1\\times 10^6\\,\\mathrm{b/s}$ 计算的 CPU 和网络时间总和。\n- 失效行为：任何不可忽略的失效概率对于 CPS 控制都是不可接受的；否则可接受。\n\n基于此矩阵，哪个选项是嵌入式控制器的最合适选择？\n\nA. 选择 ML-KEM-512 和 Dilithium-2；它们符合闪存和 RAM 预算，在没有浮点单元的 $120\\,\\mathrm{MHz}$ 微控制器上产生适度的网络负载和较低的 CPU 周期，并且具有可忽略的解密/签名失败概率，使其对于 CPS 操作是可靠的。\n\nB. 选择 ML-KEM-512 和 Falcon-512；它们因较小的签名和公钥而最小化了网络负载；在没有硬件浮点单元的情况下增加的周期数是可以接受的，因为计算可以与通信重叠。\n\nC. 选择 FrodoKEM-640 和 SPHINCS+-128s；它们完全避免了解密失败，且基于哈希的签名易于实现，因此即使消息尺寸和周期数较高，它们在鲁棒性方面也更可取。\n\nD. 选择 Classic McEliece mceliece348864 和 Dilithium-2；该 KEM 具有非常小的密文和快速的解封装，Dilithium-2 提供强签名；大的公钥和私钥是可以接受的，因为它们在配置期间只写入闪存一次。",
            "solution": "该问题要求对一个信息物理系统 (CPS) 中的嵌入式控制器所使用的四对候选后量子密码学 (PQC) 方案进行评估。评估必须基于一组定义的约束：闪存、RAM、网络负载、端到端握手时间以及失效概率。\n\n首先，我将验证问题陈述。\n\n### 第1步：提取给定信息\n- **控制器约束：**\n    - 闪存：$256\\,\\mathrm{KB}$。\n    - RAM：$64\\,\\mathrm{KB}$。\n    - CPU：$32$ 位核心，频率 $f = 120\\,\\mathrm{MHz}$，无 FPU。\n- **资源分配：**\n    - 闪存中的非密码学应用程序代码：$120\\,\\mathrm{KB}$。\n    - 可用于密码学（代码+密钥）的闪存：$F_{budget} = 256\\,\\mathrm{KB} - 120\\,\\mathrm{KB} = 136\\,\\mathrm{KB}$。\n    - RAM 中的网络缓冲区：$RAM_{net} = 4\\,\\mathrm{KB}$。\n    - 控制器必须存储其长期的 KEM 和签名私钥。\n- **网络：**\n    - 可靠链路，速率 $R = 1\\,\\mathrm{Mb/s} = 1 \\times 10^6\\,\\mathrm{b/s}$。\n- **握手协议与载荷：**\n    1. 控制器 $\\rightarrow$ 孪生：KEM 公钥 ($S_{\\mathrm{pk}}$)。\n    2. 孪生 $\\rightarrow$ 控制器：KEM 密文 ($S_{\\mathrm{ct}}$)。\n    3. 孪生挑战控制器：孪生发送 $32\\,\\mathrm{B}$ 随机数；控制器用其签名 ($S_{\\mathrm{sig}}$) 和签名公钥 ($S_{\\mathrm{spk}}$) 回应。\n    4. 控制器挑战孪生：控制器发送 $32\\,\\mathrm{B}$ 随机数；孪生用其签名 ($S_{\\mathrm{sig}}$) 和签名公钥 ($S_{\\mathrm{spk}}$) 回应。\n- **总网络字节数 ($B_{total}$):** 所有消息大小的总和：\n    $B_{total} = S_{\\mathrm{pk}} + S_{\\mathrm{ct}} + 2 \\times S_{\\mathrm{sig}} + 2 \\times S_{\\mathrm{spk}} + 64\\,\\mathrm{B}$。\n- **总 CPU 周期数 ($C_{total}$):** 握手是顺序执行的。控制器执行 KEM 解封装、签名和验证。孪生执行 KEM 封装、签名和验证。影响延迟的总周期数是所有六个操作的周期总和。\n    $C_{total} = C_{\\mathrm{encaps}} + C_{\\mathrm{decaps}} + 2 \\times C_{\\mathrm{sign}} + 2 \\times C_{\\mathrm{verify}}$。\n- **时间计算公式：**\n    - $t_{\\mathrm{CPU}} = C_{total} / f$\n    - $t_{\\mathrm{NET}} = 8B_{total} / R$\n    - $t_{\\mathrm{E2E}} = t_{\\mathrm{CPU}} + t_{\\mathrm{NET}}$\n- **候选方案数据：** 问题陈述中提供了 ML-KEM-512、Dilithium-2、Falcon-512、FrodoKEM-640、SPHINCS+-128s 和 Classic McEliece 的数据。\n\n### 第2步：使用提取的给定信息进行验证\n该问题基于科学，使用了现实世界中的 PQC 候选方案和合理的性能数据。约束和评估指标是客观且明确定义的。握手协议虽然描述简洁，但在逻辑上与实现密钥建立和相互认证的目标一致。关于 Falcon-512 的 RAM 使用存在一个轻微的模糊之处（“峰值 RAM $32\\,\\mathrm{KB}$ 外加大量栈使用”），但这个定性警告足够清晰，可以解释为在没有硬件浮点单元的设备上很可能无法满足 RAM 约束。因此，该问题被认为是有效且结构良好的，适用于进行定量的工程权衡分析。\n\n### 第3步：结论与行动\n该问题有效。我现在将通过评估每一对候选方案来构建决策矩阵。\n\n---\n\n### 决策矩阵构建\n\n评估标准如下：\n1.  **闪存使用量 ($F_{used}$):** 必须 $\\le F_{budget} = 136\\,\\mathrm{KB}$。$F_{used} = \\text{Code}_{\\text{KEM}} + \\text{Code}_{\\text{Sig}} + \\text{SK}_{\\text{KEM}} + \\text{SK}_{\\text{Sig}}$。\n2.  **峰值 RAM ($RAM_{peak}$):** 必须 $\\le 64\\,\\mathrm{KB}$。$RAM_{peak} = \\max(\\text{RAM}_{\\text{KEM}}, \\text{RAM}_{\\text{Sig}}) + RAM_{net}$。\n3.  **网络负载 ($B_{total}$):** 作为性能指标计算。\n4.  **端到端时间 ($t_{\\mathrm{E2E}}$):** 作为性能指标计算。\n5.  **失效行为：** 必须可忽略不计。\n\n**候选方案对 A: ML-KEM-512 和 Dilithium-2**\n-   **闪存：** $F_{used} = 32\\,\\mathrm{KB} (\\text{代码}) + 36\\,\\mathrm{KB} (\\text{代码}) + 2.4\\,\\mathrm{KB} (\\text{私钥}) + 2.5\\,\\mathrm{KB} (\\text{私钥}) = 72.9\\,\\mathrm{KB}$。\n    $72.9\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$。**通过**。\n-   **RAM：** $RAM_{peak} = \\max(12\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 24\\,\\mathrm{KB} + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$。\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$。**通过**。\n-   **网络：** $B_{total} = 800 + 768 + 2(2420) + 2(1312) + 64 = 1568 + 4840 + 2624 + 64 = 9096\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.8 + 2.0 + 2(1.5) + 2(0.9)) \\times 10^6 = (3.8 + 3.0 + 1.8) \\times 10^6 = 8.6 \\times 10^6$ 周期。\n    $t_{\\mathrm{CPU}} = (8.6 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.0717\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 9096\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0728\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 0.0717 + 0.0728 = 0.1445\\,\\mathrm{s}$。\n-   **失效：** ML-KEM-512 的解密失败概率 (DFP)  $2^{-128}$ (可忽略)。Dilithium 的失效可忽略。**通过**。\n-   **结论：** **可行**。\n\n**候选方案对 B: ML-KEM-512 和 Falcon-512**\n-   **闪存：** $F_{used} = 32\\,\\mathrm{KB} + 60\\,\\mathrm{KB} + 2.4\\,\\mathrm{KB} + 2.3\\,\\mathrm{KB} = 96.7\\,\\mathrm{KB}$。\n    $96.7\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$。**通过**。\n-   **RAM：** 问题陈述 Falcon-512 在没有硬件浮点单元时，在其 $32\\,\\mathrm{KB}$ 基础 RAM 之上还有“大量栈使用”。这种增加很可能导致总 RAM 使用量超过 $64\\,\\mathrm{KB}$ 的预算，因为软件浮点模拟和递归 FFT 计算所需的栈可能相当大（数十 KB）。因此，这对方案不满足 RAM 约束。**不通过**。\n-   **网络：** $B_{total} = 800 + 768 + 2(666) + 2(897) + 64 = 1568 + 1332 + 1794 + 64 = 4758\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.8 + 2.0 + 2(18) + 2(5.0)) \\times 10^6 = (3.8 + 36 + 10) \\times 10^6 = 49.8 \\times 10^6$ 周期。\n    $t_{\\mathrm{CPU}} = (49.8 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.415\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 4758\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0381\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 0.415 + 0.0381 = 0.4531\\,\\mathrm{s}$。\n-   **失效：** 可忽略。**通过**。\n-   **结论：** **不可行**（不满足 RAM 约束）。\n\n**候选方案对 C: FrodoKEM-640 和 SPHINCS+-128s**\n-   **闪存：** $F_{used} = 60\\,\\mathrm{KB} + 80\\,\\mathrm{KB} + 19\\,\\mathrm{KB} + 64\\,\\mathrm{B} = 159.064\\,\\mathrm{KB}$。\n    $159.064\\,\\mathrm{KB} > 136\\,\\mathrm{KB}$。**不通过**。\n-   **RAM：** $RAM_{peak} = \\max(\\approx 64\\,\\mathrm{KB}, 20\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} \\approx 68\\,\\mathrm{KB}$。\n    $\\approx 68\\,\\mathrm{KB} > 64\\,\\mathrm{KB}$。**不通过**。\n-   **网络：** $B_{total} = 9616 + 9720 + 2(7856) + 2(32) + 64 = 19336 + 15712 + 64 + 64 = 35176\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.2 \\times 10^7 + 1.1 \\times 10^7 + 2(6.0 \\times 10^7) + 2(3.0 \\times 10^7)) = (2.3 + 12 + 6) \\times 10^7 = 20.3 \\times 10^7$ 周期。\n    $t_{\\mathrm{CPU}} = (2.03 \\times 10^8) / (1.2 \\times 10^8\\,\\mathrm{Hz}) \\approx 1.692\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 35176\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.281\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 1.692 + 0.281 = 1.973\\,\\mathrm{s}$。\n-   **失效：** 可忽略。**通过**。\n-   **结论：** **不可行**（不满足闪存和 RAM 约束）。\n\n**候选方案对 D: Classic McEliece mceliece348864 和 Dilithium-2**\n-   **闪存：** Classic McEliece 的私钥是 $SK = 649000\\,\\mathrm{B} = 649\\,\\mathrm{KB}$。仅此一项就超过了 $136\\,\\mathrm{KB}$ 的预算。**不通过**。\n-   **RAM：** $RAM_{peak} = \\max(16\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$。\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$。**通过**。\n-   **网络：** Classic McEliece 的公钥是 $S_{\\mathrm{pk}} = 261120\\,\\mathrm{B}$。\n    $B_{total} = 261120 + 128 + 2(2420) + 2(1312) + 64 = 261120 + 128 + 4840 + 2624 + 64 = 268776\\,\\mathrm{B}$。\n-   **时间：** 仅公钥的网络传输时间为 $t_{\\mathrm{NET, pk}} = (8 \\times 261120) / 10^6 \\approx 2.09\\,\\mathrm{s}$。这使得握手协议极其缓慢，主要由网络部分主导。\n-   **失效：** 可忽略。**通过**。\n-   **结论：** **不可行**（不满足闪存约束，且由于巨大的公钥导致性能不可接受）。\n\n### 逐项分析选项\n\n**A. 选择 ML-KEM-512 和 Dilithium-2；它们符合闪存和 RAM 预算，在没有浮点单元的 $120\\,\\mathrm{MHz}$ 微控制器上产生适度的网络负载和较低的 CPU 周期，并且具有可忽略的解密/签名失败概率，使其对于 CPS 操作是可靠的。**\n此陈述与分析完全一致。该组合是唯一一个满足所有指定硬件约束（闪存和RAM）的方案。其性能（$B_{total} = 9096\\,\\mathrm{B}$，$t_{\\mathrm{E2E}} \\approx 0.145\\,\\mathrm{s}$）对于嵌入式系统是合理的。失效属性也是可接受的。\n**结论：正确。**\n\n**B. 选择 ML-KEM-512 和 Falcon-512；它们因较小的签名和公钥而最小化了网络负载；在没有硬件浮点单元的情况下增加的周期数是可以接受的，因为计算可以与通信重叠。**\n此选项有两个不正确的断言。首先，它忽略了关于 Falcon-512 在无 FPU 核心上“大量栈使用”的关键警告，这使其在 RAM 约束方面无效。其次，它声称计算可以先验地与通信重叠，而对于指定的顺序握手协议来说，这是错误的。总延迟是顺序计算和通信延迟的总和。\n**结论：不正确。**\n\n**C. 选择 FrodoKEM-640 和 SPHINCS+-128s；它们完全避免了解密失败，且基于哈希的签名易于实现，因此即使消息尺寸和周期数较高，它们在鲁棒性方面也更可取。**\n此选项不正确。该组合在闪存和 RAM 约束上都大幅超标。声称完全避免失败相对于 ML-KEM 的密码学上可忽略的失败率而言，并不是一个显著优势。“较高”的消息尺寸和周期数导致了不可接受的高网络负载和近 $2$ 秒的握手时间。\n**结论：不正确。**\n\n**D. 选择 Classic McEliece mceliece348864 和 Dilithium-2；该 KEM 具有非常小的密文和快速的解封装，Dilithium-2 提供强签名；大的公钥和私钥是可以接受的，因为它们在配置期间只写入闪存一次。**\n此选项存在根本性缺陷。“大的公钥和私钥是可以接受的”这一说法是错误的。$649\\,\\mathrm{KB}$ 的私钥远大于可用的 $136\\,\\mathrm{KB}$ 闪存。超过 $261\\,\\mathrm{KB}$ 的公钥仅传输就需要超过 $2$ 秒，这使得握手对于大多数 CPS 应用来说过于缓慢，无法接受。\n**结论：不正确。**\n\n基于此全面分析，只有选项 A 提出了一个可行且合适的解决方案。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在初步选定算法后，下一步是精确量化其对系统性能的具体影响，以验证其在特定应用场景下的可行性。本练习聚焦于一种具体的后量子签名方案SPHINCS+，要求您从底层参数出发，计算其在嵌入式网关上的签名验证时间以及在无线网络中产生的信道利用率 。这种定量分析对于评估PQC方案是否满足CPS的实时性和带宽限制至关重要。",
            "id": "4237791",
            "problem": "一个工业信息物理系统（CPS）使用数字孪生进行监控，并通过空中下载（OTA）广播认证向所有现场设备发送控制建议。为保持对配备有大规模量子计算机的对手的安全性，该系统采用128位安全级别的无状态实用哈希基准绝佳密码签名（SPHINCS+），使用安全哈希算法256位（SHA-256）参数集，记为 $ \\text{SPHINCS}+\\text{-SHA256-128s} $。\n\n假设以下经过充分测试的事实和平台特性：\n- $ \\text{SPHINCS}+\\text{-SHA256-128s} $ 签名的字节长度为 $7{,}856$ 字节（此参数集的公认规范值）。\n- 嵌入式网关上的签名验证可归结为 $N$ 次 SHA-256 压缩函数的应用，其中 $N = 120{,}000$ 是此参数集在参考实现中的一致测量值。\n- 嵌入式网关有一个单核，主频为 $f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{周期/秒}$，SHA-256 压缩函数每次处理 $64$ 字节数据块的成本为 $c = 680$ 个周期（测量的恒定时间实现；对于带标准填充的 $32$ 字节输入，每次哈希调用一次）。\n- 该工厂的无线广播网络使用 IEEE 802.15.4 级物理层，原始比特率为 $R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$。媒体访问控制（MAC）层的效率因子为 $ \\eta = 0.80 $，该因子包含了帧定界和竞争，因此有效吞吐量为 $R_{\\text{eff}} = \\eta R_{\\text{raw}}$。\n- 每个经过认证的建议帧包含一个 $200$ 字节的应用有效载荷、一个 $25$ 字节的 MAC 头/尾，以及 $ \\text{SPHINCS}+\\text{-SHA256-128s} $ 签名。\n- 网关以 $r = 1 \\ \\text{s}^{-1}$ 的速率广播建议。\n\n从这些基本原理和公认事实出发，完成以下任务：\n1. 计算以字节为单位的签名大小。\n2. 根据 SHA-256 压缩函数的周期级模型，推导出以秒为单位的签名验证时间。\n3. 计算在指定广播速率下所需的信道利用率，以有效吞吐量的小数分数形式表示。\n\n将您的最终答案表示为一个单行矩阵，其中按顺序包含签名大小（字节）、验证时间（秒）和信道利用率（小数分数）。将验证时间和信道利用率四舍五入到四位有效数字。不要在矩阵内包含单位；单位只能在计算过程中使用。",
            "solution": "该问题陈述经评估是有效的，因为它在科学上基于后量子密码学、计算机体系结构和无线网络等既定概念。该问题定义良好、客观，并包含足以推导出唯一解的充分且一致的信息。所提供的数据，例如 $\\text{SPHINCS}+\\text{-SHA256-128s}$ 的签名大小、SHA-256 的性能以及 IEEE 802.15.4 的规范，都是事实正确且符合实际的。该问题需要基于这些给定值进行一系列计算。\n\n解决方案分为三个部分，对应于三个任务。\n\n**第1部分：签名大小**\n\n问题明确说明了指定参数集的签名大小。该值是作为“公认规范值”给出的。\n使用的签名方案是 $\\text{SPHINCS}+\\text{-SHA256-128s}$。\n签名字节长度，记为 $S_{\\text{sig}}$，给定为：\n$$S_{\\text{sig}} = 7{,}856 \\ \\text{字节}$$\n\n**第2部分：签名验证时间**\n\n签名验证时间 $T_{\\text{verify}}$ 取决于计算所需的CPU总周期数和CPU的时钟频率。\n总周期数 $C_{\\text{total}}$ 是 SHA-256 压缩函数应用次数 $N$ 与每次应用的周期成本 $c$ 的乘积。\n给定值为：\n- SHA-256 压缩函数应用次数：$N = 120{,}000$\n- 每次压缩函数的周期成本：$c = 680 \\ \\text{周期}$\n- CPU 时钟频率：$f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{周期/秒}$\n\n首先，我们计算总周期数：\n$$C_{\\text{total}} = N \\times c = 120{,}000 \\times 680 \\ \\text{周期} = 81{,}600{,}000 \\ \\text{周期}$$\n这可以用科学记数法写成 $8.16 \\times 10^{7} \\ \\text{周期}$。\n\n接下来，我们通过将总周期数除以时钟频率来计算验证时间：\n$$T_{\\text{verify}} = \\frac{C_{\\text{total}}}{f_{\\text{CPU}}} = \\frac{8.16 \\times 10^{7} \\ \\text{周期}}{1.0 \\times 10^{9} \\ \\text{周期/秒}} = 0.0816 \\ \\text{s}$$\n问题要求将此值四舍五入到四位有效数字。因此，我们将其表示为：\n$$T_{\\text{verify}} = 0.08160 \\ \\text{s}$$\n\n**第3部分：信道利用率**\n\n信道利用率 $U$ 是所需数据速率 $R_{\\text{req}}$ 与有效信道吞吐量 $R_{\\text{eff}}$ 的比值。\n\n首先，我们计算单个经认证的建议帧的总大小 $S_{\\text{frame}}$。该帧由应用有效载荷（$S_{\\text{payload}}$）、MAC 头/尾（$S_{\\text{mac}}$）和数字签名（$S_{\\text{sig}}$）组成。\n给定的大小为：\n- 应用有效载荷大小：$S_{\\text{payload}} = 200 \\ \\text{字节}$\n- MAC 头/尾大小：$S_{\\text{mac}} = 25 \\ \\text{字节}$\n- 签名大小：$S_{\\text{sig}} = 7{,}856 \\ \\text{字节}$\n\n以字节为单位的总帧大小是其各部分之和：\n$$S_{\\text{frame}} = S_{\\text{payload}} + S_{\\text{mac}} + S_{\\text{sig}} = 200 + 25 + 7{,}856 = 8{,}081 \\ \\text{字节}$$\n为了求得数据速率，我们必须将此大小转换为比特。由于 $1 \\ \\text{字节} = 8 \\ \\text{比特}$：\n$$S_{\\text{frame, bits}} = S_{\\text{frame}} \\times 8 = 8{,}081 \\times 8 = 64{,}648 \\ \\text{比特}$$\n\n所需数据速率 $R_{\\text{req}}$ 是以比特为单位的帧大小乘以广播速率 $r = 1 \\ \\text{s}^{-1}$：\n$$R_{\\text{req}} = S_{\\text{frame, bits}} \\times r = 64{,}648 \\ \\text{比特} \\times 1 \\ \\text{s}^{-1} = 64{,}648 \\ \\text{bit/s}$$\n\n接下来，我们计算有效信道吞吐量 $R_{\\text{eff}}$。它是原始比特率 $R_{\\text{raw}}$ 乘以 MAC 层效率 $\\eta$。\n给定值为：\n- 原始比特率：$R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$\n- MAC 效率：$\\eta = 0.80$\n\n$$R_{\\text{eff}} = \\eta \\times R_{\\text{raw}} = 0.80 \\times 250{,}000 \\ \\text{bit/s} = 200{,}000 \\ \\text{bit/s}$$\n\n最后，我们计算信道利用率，以小数分数形式表示：\n$$U = \\frac{R_{\\text{req}}}{R_{\\text{eff}}} = \\frac{64{,}648 \\ \\text{bit/s}}{200{,}000 \\ \\text{bit/s}} = 0.32324$$\n将其四舍五入到四位有效数字得到：\n$$U \\approx 0.3232$$\n\n所要求的三个值是签名大小（$7{,}856$ 字节）、验证时间（$0.08160$ 秒）和信道利用率（$0.3232$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7856 & 0.08160 & 0.3232\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "对于许多依赖电池供电的远程CPS节点而言，能量消耗是与计算性能同等重要的生命线。此练习将抽象的计算成本（时钟周期数）与物理世界中的实际后果（电池寿命）联系起来 。通过精确计算PQC操作的能量消耗并评估其对设备整体续航能力的影响，您将学会如何预测系统的维护周期和操作寿命，这是确保CPS长期自主运行的关键一步。",
            "id": "4237742",
            "problem": "一个遥感节点是信息物理系统（Cyber-Physical System, CPS）的一部分，其数字孪生（Digital Twin, DT）模型用于模拟能量消耗，以预测在向后量子密码学（Post-Quantum Cryptography, PQC）过渡期间的维护和电池更换间隔。这一过渡是由大规模量子计算机的预期能力所推动的。该节点使用一个嵌入式微控制器，其电源电压 $V$ 恒定。在执行加密程序时，它以时钟频率 $f$ 消耗恒定的活动电流 $I_{\\text{cpu}}$。在短暂的预定通信窗口之外，该节点以恒定电流 $I_{\\text{sleep}}$ 进入休眠状态。每次数据上传都需要使用 PQC 签名算法生成一个数字签名，并且该节点每天执行一次密钥封装机制（Key Encapsulation Mechanism, KEM）的解封装操作以刷新会话密钥。假设能量由功率的时间积分给出，$E=\\int V I\\, dt$，并且 $V$、$I_{\\text{cpu}}$ 和 $I_{\\text{sleep}}$ 在各自的时间间隔内是恒定的。\n\n系统参数：\n- 电源电压: $V=3.0\\,\\text{V}$。\n- 时钟频率: $f=48\\times 10^{6}\\,\\text{Hz}$。\n- CPU密集型加密期间的活动电流: $I_{\\text{cpu}}=15\\times 10^{-3}\\,\\text{A}$。\n- 休眠电流: $I_{\\text{sleep}}=20\\times 10^{-6}\\,\\text{A}$。\n- 每次上传的通信窗口（无线电和传感合并）: 持续时间 $t_{\\text{comm}}=2\\,\\text{s}$，活动电流 $I_{\\text{comm}}=30\\times 10^{-3}\\,\\text{A}$。\n- 上传间隔: 每 $10\\,\\text{min}$ 一次，连续 $24\\,\\text{h}$。\n- 每次上传的 PQC 签名生成周期数: $c_{\\text{sig}}=24\\times 10^{6}$ 周期。\n- 每天的 PQC KEM 解封装周期数: $c_{\\text{kem}}=12\\times 10^{6}$ 周期。\n- 电池容量: $Q_{\\text{batt}}=2.4\\,\\text{Ah}$，在电压 $V=3.0\\,\\text{V}$ 下可供微控制器使用（忽略稳压损耗和温度依赖性）。\n\n任务：\n1. 根据 $E=\\int V I\\, dt$ 和 $t=\\frac{\\text{cycles}}{f}$，推导出每次 PQC 签名生成所需的能量 $E_{\\text{sig}}$ 和每次 PQC KEM 解封装所需的能量 $E_{\\text{kem}}$，单位为 $\\text{J}$。\n2. 计算不使用 PQC 时的每日基准能耗 $E_{\\text{day,0}}$（即仅包括通信窗口和休眠），然后计算包含 PQC 时的每日能耗 $E_{\\text{day,1}}$（即每次上传增加一次签名，每天增加一次 KEM 解封装）。\n3. 使用 $E_{\\text{batt}}=V\\,Q_{\\text{batt}}\\times 3600$ 和 $T=\\frac{E_{\\text{batt}}}{E_{\\text{day}}}$，确定不使用 PQC 时的电池寿命 $T_{0}$（天）和使用 PQC 时的电池寿命 $T_{1}$（天）。\n\n将 $E_{\\text{sig}}$ 和 $E_{\\text{kem}}$ 以焦耳（Joule）为单位表示，$T_{0}$ 和 $T_{1}$ 以天为单位表示。将这四个量均四舍五入至四位有效数字。将最终答案以包含 $(E_{\\text{sig}},\\,E_{\\text{kem}},\\,T_{0},\\,T_{1})$ 的单行矩阵形式提供。",
            "solution": "问题陈述已经过分析，并被确定为有效。它具有科学依据，问题提出得当，客观，并包含了推导唯一、有意义解所需的所有信息。所提供的参数对于信息物理系统环境中的低功耗嵌入式系统是切合实际的。\n\n解题过程遵循问题中概述的三个任务。\n\n**任务1：每次 PQC 操作的能量（$E_{\\text{sig}}$ 和 $E_{\\text{kem}}$）**\n\n能量 $E$ 是功率 $P$ 对时间 $t$ 的积分，其中功率是电压 $V$ 和电流 $I$ 的乘积。由于在加密操作期间，$V$ 和活动 CPU 电流 $I_{\\text{cpu}}$ 是恒定的，所以能量由 $E = V I_{\\text{cpu}} t$ 给出。执行一个操作所需的时间由时钟周期数 $c$ 和时钟频率 $f$ 决定，即 $t = \\frac{c}{f}$。\n\n结合这些关系，一次加密操作的能量为：\n$$E = V I_{\\text{cpu}} \\left( \\frac{c}{f} \\right)$$\n问题给出了以下参数：\n- 电源电压: $V = 3.0\\,\\text{V}$\n- 时钟频率: $f = 48 \\times 10^{6}\\,\\text{Hz}$\n- 活动 CPU 电流: $I_{\\text{cpu}} = 15 \\times 10^{-3}\\,\\text{A}$\n- 签名生成周期数: $c_{\\text{sig}} = 24 \\times 10^{6}$ 周期\n- KEM 解封装周期数: $c_{\\text{kem}} = 12 \\times 10^{6}$ 周期\n\n首先，计算每次操作的时间。\n签名生成的时间为：\n$$t_{\\text{sig}} = \\frac{c_{\\text{sig}}}{f} = \\frac{24 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.5\\,\\text{s}$$\nKEM 解封装的时间为：\n$$t_{\\text{kem}} = \\frac{c_{\\text{kem}}}{f} = \\frac{12 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.25\\,\\text{s}$$\n\n现在，计算每次操作的能量。\n一次签名生成的能量为：\n$$E_{\\text{sig}} = V I_{\\text{cpu}} t_{\\text{sig}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.5\\,\\text{s}) = 0.0225\\,\\text{J}$$\n一次 KEM 解封装的能量为：\n$$E_{\\text{kem}} = V I_{\\text{cpu}} t_{\\text{kem}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.25\\,\\text{s}) = 0.01125\\,\\text{J}$$\n\n**任务2：每日能耗（$E_{\\text{day,0}}$ 和 $E_{\\text{day,1}}$）**\n\n首先，确定每天的上传次数。一天有 $24 \\times 60 = 1440$ 分钟。每 $10$ 分钟上传一次，则每天的上传次数为：\n$$N_{\\text{uploads}} = \\frac{1440\\,\\text{min}}{10\\,\\text{min}} = 144\\,\\text{uploads/day}$$\n一天的总时间为 $T_{\\text{day}} = 24\\,\\text{h} \\times 3600\\,\\text{s/h} = 86400\\,\\text{s}$。\n\n为计算每日能耗，我们将各状态（通信、休眠、PQC 操作）下消耗的能量相加。\n\n**基准每日能耗，$E_{\\text{day,0}}$（不使用 PQC）：**\n节点仅进行通信和休眠。\n每天用于通信的总时间：\n$$T_{\\text{comm,total}} = N_{\\text{uploads}} \\times t_{\\text{comm}} = 144 \\times 2\\,\\text{s} = 288\\,\\text{s}$$\n每天通信消耗的能量，使用 $I_{\\text{comm}} = 30\\times 10^{-3}\\,\\text{A}$：\n$$E_{\\text{comm,total}} = N_{\\text{uploads}} \\times V I_{\\text{comm}} t_{\\text{comm}} = 144 \\times (3.0\\,\\text{V}) (30 \\times 10^{-3}\\,\\text{A}) (2\\,\\text{s}) = 25.92\\,\\text{J}$$\n每天用于休眠的总时间：\n$$T_{\\text{sleep},0} = T_{\\text{day}} - T_{\\text{comm,total}} = 86400\\,\\text{s} - 288\\,\\text{s} = 86112\\,\\text{s}$$\n每天休眠消耗的能量，使用 $I_{\\text{sleep}} = 20\\times 10^{-6}\\,\\text{A}$：\n$$E_{\\text{sleep},0} = V I_{\\text{sleep}} T_{\\text{sleep},0} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86112\\,\\text{s}) = 5.16672\\,\\text{J}$$\n总的每日基准能耗为：\n$$E_{\\text{day},0} = E_{\\text{comm,total}} + E_{\\text{sleep},0} = 25.92\\,\\text{J} + 5.16672\\,\\text{J} = 31.08672\\,\\text{J}$$\n\n**每日能耗，$E_{\\text{day,1}}$（使用 PQC）：**\n这包括通信、休眠、$144$ 次签名生成和 $1$ 次 KEM 解封装。\n每天签名生成的总时间：$T_{\\text{sig,total}} = N_{\\text{uploads}} \\times t_{\\text{sig}} = 144 \\times 0.5\\,\\text{s} = 72\\,\\text{s}$。\n每天 KEM 解封装的总时间：$T_{\\text{kem,total}} = 1 \\times t_{\\text{kem}} = 0.25\\,\\text{s}$。\n用于 PQC 操作的总时间为 $T_{\\text{pqc}} = T_{\\text{sig,total}} + T_{\\text{kem,total}} = 72\\,\\text{s} + 0.25\\,\\text{s} = 72.25\\,\\text{s}$。\n每天 PQC 操作的总能量：\n$$E_{\\text{pqc,total}} = (N_{\\text{uploads}} \\times E_{\\text{sig}}) + (1 \\times E_{\\text{kem}}) = (144 \\times 0.0225\\,\\text{J}) + (1 \\times 0.01125\\,\\text{J})$$\n$$E_{\\text{pqc,total}} = 3.24\\,\\text{J} + 0.01125\\,\\text{J} = 3.25125\\,\\text{J}$$\n通信能耗保持不变：$E_{\\text{comm,total}} = 25.92\\,\\text{J}$。\n新的休眠时间为：\n$$T_{\\text{sleep},1} = T_{\\text{day}} - T_{\\text{comm,total}} - T_{\\text{pqc}} = 86400\\,\\text{s} - 288\\,\\text{s} - 72.25\\,\\text{s} = 86039.75\\,\\text{s}$$\n新的休眠能耗为：\n$$E_{\\text{sleep},1} = V I_{\\text{sleep}} T_{\\text{sleep},1} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86039.75\\,\\text{s}) = 5.162385\\,\\text{J}$$\n使用 PQC 时的每日总能耗是所有部分的总和：\n$$E_{\\text{day},1} = E_{\\text{comm,total}} + E_{\\text{pqc,total}} + E_{\\text{sleep},1} = 25.92\\,\\text{J} + 3.25125\\,\\text{J} + 5.162385\\,\\text{J} = 34.333635\\,\\text{J}$$\n\n\n**任务3：电池寿命（$T_{0}$ 和 $T_{1}$）**\n\n首先，计算电池中存储的总能量 $E_{\\text{batt}}$。容量给定为 $Q_{\\text{batt}} = 2.4\\,\\text{Ah}$。使用提供的公式：\n$$E_{\\text{batt}} = V Q_{\\text{batt}} \\times 3600\\,\\frac{\\text{s}}{\\text{h}} = (3.0\\,\\text{V}) (2.4\\,\\text{Ah}) (3600\\,\\text{s/h}) = 25920\\,\\text{J}$$\n以天为单位的电池寿命为 $T = \\frac{E_{\\text{batt}}}{E_{\\text{day}}}$。\n\n不使用 PQC 时的电池寿命 $T_{0}$：\n$$T_{0} = \\frac{E_{\\text{batt}}}{E_{\\text{day},0}} = \\frac{25920\\,\\text{J}}{31.08672\\,\\text{J/day}} \\approx 833.8153\\,\\text{days}$$\n使用 PQC 时的电池寿命 $T_{1}$：\n$$T_{1} = \\frac{E_{\\text{batt}}}{E_{\\text{day},1}} = \\frac{25920\\,\\text{J}}{34.333635\\,\\text{J/day}} \\approx 754.9433\\,\\text{days}$$\n\n**最终答案四舍五入**\n问题要求将四个最终量（$E_{\\text{sig}}$、$E_{\\text{kem}}$、$T_{0}$、$T_{1}$）四舍五入到四位有效数字。\n- $E_{\\text{sig}} = 0.0225\\,\\text{J}$ 变为 $0.02250\\,\\text{J}$。\n- $E_{\\text{kem}} = 0.01125\\,\\text{J}$ 保持为 $0.01125\\,\\text{J}$。\n- $T_{0} = 833.8153...$ 天变为 $833.8$ 天。\n- $T_{1} = 754.9433...$ 天变为 $754.9$ 天。\n\n最终值为 $E_{\\text{sig}} = 0.02250\\,\\text{J}$，$E_{\\text{kem}} = 0.01125\\,\\text{J}$，$T_{0} = 833.8$ 天，以及 $T_{1} = 754.9$ 天。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.02250 & 0.01125 & 833.8 & 754.9 \\end{pmatrix} } $$"
        }
    ]
}