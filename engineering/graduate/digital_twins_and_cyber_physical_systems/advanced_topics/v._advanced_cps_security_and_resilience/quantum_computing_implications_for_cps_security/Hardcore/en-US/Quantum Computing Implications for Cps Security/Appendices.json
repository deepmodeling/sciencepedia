{
    "hands_on_practices": [
        {
            "introduction": "One of the most critical constraints in many cyber-physical systems, especially remote sensing nodes, is power consumption. While upgrading to post-quantum cryptography (PQC) is essential for long-term security, these advanced algorithms can be more computationally intensive than their classical predecessors. This exercise  provides a hands-on method to quantify this trade-off, guiding you to calculate the precise energy cost of PQC operations and assess their impact on the operational battery life of a device.",
            "id": "4237742",
            "problem": "A remote sensing node is part of a Cyber-Physical System (CPS) whose Digital Twin (DT) models energy consumption to forecast maintenance and battery replacement intervals under the transition to Post-Quantum Cryptography (PQC) prompted by the anticipated capabilities of large-scale quantum computers. The node uses an embedded microcontroller with constant supply voltage $V$, and when executing cryptographic routines it draws a constant active current $I_{\\text{cpu}}$ at clock frequency $f$. Outside short scheduled communication windows, the node sleeps at constant current $I_{\\text{sleep}}$. Each data upload requires a digital signature generation using a PQC signature algorithm, and once per day the node performs one Key Encapsulation Mechanism (KEM) decapsulation to refresh session keys. Assume energy is given by the time integral of power, $E=\\int V I\\, dt$, and that $V$, $I_{\\text{cpu}}$, and $I_{\\text{sleep}}$ are constant over their respective intervals.\n\nSystem parameters:\n- Supply voltage: $V=3.0\\,\\text{V}$.\n- Clock frequency: $f=48\\times 10^{6}\\,\\text{Hz}$.\n- Active current during CPU-bound cryptography: $I_{\\text{cpu}}=15\\times 10^{-3}\\,\\text{A}$.\n- Sleep current: $I_{\\text{sleep}}=20\\times 10^{-6}\\,\\text{A}$.\n- Communication window per upload (radio and sensing combined): duration $t_{\\text{comm}}=2\\,\\text{s}$ at active current $I_{\\text{comm}}=30\\times 10^{-3}\\,\\text{A}$.\n- Upload interval: every $10\\,\\text{min}$, continuously over $24\\,\\text{h}$.\n- PQC signature generation cycle count per upload: $c_{\\text{sig}}=24\\times 10^{6}$ cycles.\n- PQC KEM decapsulation cycle count per day: $c_{\\text{kem}}=12\\times 10^{6}$ cycles.\n- Battery capacity: $Q_{\\text{batt}}=2.4\\,\\text{Ah}$, available to the microcontroller at $V=3.0\\,\\text{V}$ (neglect regulation losses and temperature dependence).\n\nTasks:\n1. Derive, from $E=\\int V I\\, dt$ and $t=\\frac{\\text{cycles}}{f}$, the energy per PQC signature generation $E_{\\text{sig}}$ and per PQC KEM decapsulation $E_{\\text{kem}}$, expressed in $\\text{J}$.\n2. Compute the daily baseline energy $E_{\\text{day,0}}$ without PQC (i.e., only communication windows and sleep), and then the daily energy $E_{\\text{day,1}}$ including PQC (i.e., add one signature per upload and one KEM decapsulation per day).\n3. Using $E_{\\text{batt}}=V\\,Q_{\\text{batt}}\\times 3600$ and $T=\\frac{E_{\\text{batt}}}{E_{\\text{day}}}$, determine the battery life in days without PQC, $T_{0}$, and with PQC, $T_{1}$.\n\nExpress $E_{\\text{sig}}$ and $E_{\\text{kem}}$ in Joules, and $T_{0}$ and $T_{1}$ in days. Round each of the four quantities to four significant figures. Provide the final answer as a single row matrix containing $(E_{\\text{sig}},\\,E_{\\text{kem}},\\,T_{0},\\,T_{1})$.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique, meaningful solution. The parameters provided are realistic for a low-power embedded system in a cyber-physical system context.\n\nThe solution proceeds by following the three tasks outlined in the problem.\n\n**Task 1: Energy per PQC operation ($E_{\\text{sig}}$ and $E_{\\text{kem}}$)**\n\nEnergy $E$ is the integral of power $P$ over time $t$, where power is the product of voltage $V$ and current $I$. Since $V$ and the active CPU current $I_{\\text{cpu}}$ are constant during cryptographic operations, the energy is given by $E = V I_{\\text{cpu}} t$. The time required to execute an operation is determined by the number of clock cycles $c$ and the clock frequency $f$, given by $t = \\frac{c}{f}$.\n\nCombining these relations, the energy for a cryptographic operation is:\n$$E = V I_{\\text{cpu}} \\left( \\frac{c}{f} \\right)$$\nThe problem gives the following parameters:\n- Supply voltage: $V = 3.0\\,\\text{V}$\n- Clock frequency: $f = 48 \\times 10^{6}\\,\\text{Hz}$\n- Active CPU current: $I_{\\text{cpu}} = 15 \\times 10^{-3}\\,\\text{A}$\n- Signature generation cycle count: $c_{\\text{sig}} = 24 \\times 10^{6}$ cycles\n- KEM decapsulation cycle count: $c_{\\text{kem}} = 12 \\times 10^{6}$ cycles\n\nFirst, calculate the time for each operation.\nThe time for signature generation is:\n$$t_{\\text{sig}} = \\frac{c_{\\text{sig}}}{f} = \\frac{24 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.5\\,\\text{s}$$\nThe time for KEM decapsulation is:\n$$t_{\\text{kem}} = \\frac{c_{\\text{kem}}}{f} = \\frac{12 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.25\\,\\text{s}$$\n\nNow, calculate the energy for each operation.\nThe energy for one signature generation is:\n$$E_{\\text{sig}} = V I_{\\text{cpu}} t_{\\text{sig}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.5\\,\\text{s}) = 0.0225\\,\\text{J}$$\nThe energy for one KEM decapsulation is:\n$$E_{\\text{kem}} = V I_{\\text{cpu}} t_{\\text{kem}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.25\\,\\text{s}) = 0.01125\\,\\text{J}$$\n\n**Task 2: Daily energy consumption ($E_{\\text{day,0}}$ and $E_{\\text{day,1}}$)**\n\nFirst, determine the number of uploads per day. A day has $24 \\times 60 = 1440$ minutes. With an upload every $10$ minutes, the number of uploads per day is:\n$$N_{\\text{uploads}} = \\frac{1440\\,\\text{min}}{10\\,\\text{min}} = 144\\,\\text{uploads/day}$$\nThe total time in a day is $T_{\\text{day}} = 24\\,\\text{h} \\times 3600\\,\\text{s/h} = 86400\\,\\text{s}$.\n\nTo calculate the daily energy, we sum the energy consumed in each state (communication, sleep, PQC operations).\n\n**Baseline daily energy, $E_{\\text{day,0}}$ (without PQC):**\nThe node only engages in communication and sleep.\nTotal time spent in communication per day:\n$$T_{\\text{comm,total}} = N_{\\text{uploads}} \\times t_{\\text{comm}} = 144 \\times 2\\,\\text{s} = 288\\,\\text{s}$$\nEnergy consumed during communication per day, using $I_{\\text{comm}} = 30\\times 10^{-3}\\,\\text{A}$:\n$$E_{\\text{comm,total}} = N_{\\text{uploads}} \\times V I_{\\text{comm}} t_{\\text{comm}} = 144 \\times (3.0\\,\\text{V}) (30 \\times 10^{-3}\\,\\text{A}) (2\\,\\text{s}) = 25.92\\,\\text{J}$$\nTotal time spent in sleep per day:\n$$T_{\\text{sleep},0} = T_{\\text{day}} - T_{\\text{comm,total}} = 86400\\,\\text{s} - 288\\,\\text{s} = 86112\\,\\text{s}$$\nEnergy consumed during sleep per day, using $I_{\\text{sleep}} = 20\\times 10^{-6}\\,\\text{A}$:\n$$E_{\\text{sleep},0} = V I_{\\text{sleep}} T_{\\text{sleep},0} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86112\\,\\text{s}) = 5.16672\\,\\text{J}$$\nThe total daily baseline energy is:\n$$E_{\\text{day},0} = E_{\\text{comm,total}} + E_{\\text{sleep},0} = 25.92\\,\\text{J} + 5.16672\\,\\text{J} = 31.08672\\,\\text{J}$$\n\n**Daily energy, $E_{\\text{day,1}}$ (with PQC):**\nThis includes communication, sleep, $144$ signature generations, and $1$ KEM decapsulation.\nTotal time for signature generations per day: $T_{\\text{sig,total}} = N_{\\text{uploads}} \\times t_{\\text{sig}} = 144 \\times 0.5\\,\\text{s} = 72\\,\\text{s}$.\nTotal time for KEM decapsulation per day: $T_{\\text{kem,total}} = 1 \\times t_{\\text{kem}} = 0.25\\,\\text{s}$.\nThe total time spent on PQC operations is $T_{\\text{pqc}} = T_{\\text{sig,total}} + T_{\\text{kem,total}} = 72\\,\\text{s} + 0.25\\,\\text{s} = 72.25\\,\\text{s}$.\nTotal energy for PQC operations per day:\n$$E_{\\text{pqc,total}} = (N_{\\text{uploads}} \\times E_{\\text{sig}}) + (1 \\times E_{\\text{kem}}) = (144 \\times 0.0225\\,\\text{J}) + (1 \\times 0.01125\\,\\text{J})$$\n$$E_{\\text{pqc,total}} = 3.24\\,\\text{J} + 0.01125\\,\\text{J} = 3.25125\\,\\text{J}$$\nThe communication energy remains the same: $E_{\\text{comm,total}} = 25.92\\,\\text{J}$.\nThe new sleep time is:\n$$T_{\\text{sleep},1} = T_{\\text{day}} - T_{\\text{comm,total}} - T_{\\text{pqc}} = 86400\\,\\text{s} - 288\\,\\text{s} - 72.25\\,\\text{s} = 86039.75\\,\\text{s}$$\nThe new sleep energy is:\n$$E_{\\text{sleep},1} = V I_{\\text{sleep}} T_{\\text{sleep},1} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86039.75\\,\\text{s}) = 5.162385\\,\\text{J}$$\nThe total daily energy with PQC is the sum of all components:\n$$E_{\\text{day},1} = E_{\\text{comm,total}} + E_{\\text{pqc,total}} + E_{\\text{sleep},1} = 25.92\\,\\text{J} + 3.25125\\,\\text{J} + 5.162385\\,\\text{J} = 34.333635\\,\\text{J}$$\n\n\n**Task 3: Battery Life ($T_{0}$ and $T_{1}$)**\n\nFirst, calculate the total energy stored in the battery, $E_{\\text{batt}}$. The capacity is given as $Q_{\\text{batt}} = 2.4\\,\\text{Ah}$. Using the provided formula:\n$$E_{\\text{batt}} = V Q_{\\text{batt}} \\times 3600\\,\\frac{\\text{s}}{\\text{h}} = (3.0\\,\\text{V}) (2.4\\,\\text{Ah}) (3600\\,\\text{s/h}) = 25920\\,\\text{J}$$\nThe battery life in days is $T = \\frac{E_{\\text{batt}}}{E_{\\text{day}}}$.\n\nBattery life without PQC, $T_{0}$:\n$$T_{0} = \\frac{E_{\\text{batt}}}{E_{\\text{day},0}} = \\frac{25920\\,\\text{J}}{31.08672\\,\\text{J/day}} \\approx 833.8153\\,\\text{days}$$\nBattery life with PQC, $T_{1}$:\n$$T_{1} = \\frac{E_{\\text{batt}}}{E_{\\text{day},1}} = \\frac{25920\\,\\text{J}}{34.333635\\,\\text{J/day}} \\approx 754.9433\\,\\text{days}$$\n\n**Final Answer Rounding**\nThe problem requires rounding the four final quantities ($E_{\\text{sig}}$, $E_{\\text{kem}}$, $T_{0}$, $T_{1}$) to four significant figures.\n- $E_{\\text{sig}} = 0.0225\\,\\text{J}$ becomes $0.02250\\,\\text{J}$.\n- $E_{\\text{kem}} = 0.01125\\,\\text{J}$ remains $0.01125\\,\\text{J}$.\n- $T_{0} = 833.8153...$ days becomes $833.8$ days.\n- $T_{1} = 754.9433...$ days becomes $754.9$ days.\n\nThe final values are $E_{\\text{sig}} = 0.02250\\,\\text{J}$, $E_{\\text{kem}} = 0.01125\\,\\text{J}$, $T_{0} = 833.8$ days, and $T_{1} = 754.9$ days.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.02250 & 0.01125 & 833.8 & 754.9 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Beyond energy, the performance of cryptographic operations directly impacts the real-time responsiveness and network feasibility of a CPS. Many PQC signature schemes, particularly those offering the highest security assurances, generate significantly larger signatures than classical algorithms. In this practice , you will analyze the system-level consequences by calculating the signature verification latency and the required network bandwidth for a quantum-resistant broadcast authentication protocol, crucial skills for designing performant and secure industrial control systems.",
            "id": "4237791",
            "problem": "An industrial Cyber-Physical System (CPS) uses a Digital Twin for supervisory control and over-the-air (OTA) broadcast authentication of control advisories to all field devices. To remain secure against adversaries equipped with large-scale quantum computers, the system employs the Stateless Practical Hash-based Incredibly Nice Cryptographic Signatures (SPHINCS+) using the Secure Hash Algorithm 256-bit (SHA-256) parameter set at the 128-bit security level, denoted $\\text{SPHINCS}+\\text{-SHA256-128s}$.\n\nAssume the following well-tested facts and platform characteristics:\n- The $\\text{SPHINCS}+\\text{-SHA256-128s}$ signature byte length is $7{,}856$ bytes (accepted specification value for this parameter set).\n- Signature verification on the embedded gateway reduces to $N$ applications of the SHA-256 compression function, where $N = 120{,}000$ is a consistent measurement for this parameter set in a reference implementation.\n- The embedded gateway has a single core clocked at $f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{cycles/s}$, and the SHA-256 compression function costs $c = 680$ cycles per $64$-byte block (measured constant-time implementation; one invocation per hash on $32$-byte inputs with standard padding).\n- The plantâ€™s wireless broadcast network uses an IEEE 802.15.4-class physical layer with a raw bit rate $R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$. The Media Access Control (MAC) layer has an efficiency factor $\\eta = 0.80$ capturing framing and contention, so the effective goodput is $R_{\\text{eff}} = \\eta R_{\\text{raw}}$.\n- Each authenticated advisory frame comprises a $200$-byte application payload, a $25$-byte MAC header/trailer, and the $\\text{SPHINCS}+\\text{-SHA256-128s}$ signature.\n- The gateway broadcasts advisories at a rate of $r = 1 \\ \\text{s}^{-1}$.\n\nStarting from these fundamentals and accepted facts, do the following:\n1. Compute the signature size in bytes.\n2. Derive the signature verification time in seconds from the cycle-level model of the SHA-256 compression function.\n3. Compute the required channel utilization, expressed as a decimal fraction of the effective goodput, for the stated broadcast rate.\n\nExpress your final answer as a single row matrix containing, in order, the signature size (bytes), the verification time (seconds), and the channel utilization (decimal fraction). Round the verification time and the channel utilization to four significant figures. Do not include units inside the matrix; units must be used in the working only.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in established concepts of post-quantum cryptography, computer architecture, and wireless networking. It is well-posed, objective, and contains sufficient, consistent information to derive a unique solution. The provided data, such as the signature size for $\\text{SPHINCS}+\\text{-SHA256-128s}$, SHA-256 performance, and IEEE 802.15.4 specifications, are factually correct and realistic. The problem requires a series of calculations based on these givens.\n\nThe solution is derived in three parts corresponding to the three tasks.\n\n**Part 1: Signature Size**\n\nThe problem explicitly states the signature size for the specified parameter set. This value is given as an \"accepted specification value\".\nThe signature scheme used is $\\text{SPHINCS}+\\text{-SHA256-128s}$.\nThe signature byte length, denoted as $S_{\\text{sig}}$, is given as:\n$$S_{\\text{sig}} = 7{,}856 \\ \\text{bytes}$$\n\n**Part 2: Signature Verification Time**\n\nThe signature verification time, $T_{\\text{verify}}$, depends on the total number of CPU cycles required for the computation and the CPU's clock frequency.\nThe total number of cycles, $C_{\\text{total}}$, is the product of the number of SHA-256 compression function applications, $N$, and the cycle cost per application, $c$.\nThe given values are:\n- Number of SHA-256 compression function applications: $N = 120{,}000$\n- Cycle cost per compression function: $c = 680 \\ \\text{cycles}$\n- CPU clock frequency: $f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{cycles/s}$\n\nFirst, we calculate the total number of cycles:\n$$C_{\\text{total}} = N \\times c = 120{,}000 \\times 680 \\ \\text{cycles} = 81{,}600{,}000 \\ \\text{cycles}$$\nThis can be written in scientific notation as $8.16 \\times 10^{7} \\ \\text{cycles}$.\n\nNext, we compute the verification time by dividing the total cycles by the clock frequency:\n$$T_{\\text{verify}} = \\frac{C_{\\text{total}}}{f_{\\text{CPU}}} = \\frac{8.16 \\times 10^{7} \\ \\text{cycles}}{1.0 \\times 10^{9} \\ \\text{cycles/s}} = 0.0816 \\ \\text{s}$$\nThe problem requires this value to be rounded to four significant figures. Thus, we express it as:\n$$T_{\\text{verify}} = 0.08160 \\ \\text{s}$$\n\n**Part 3: Channel Utilization**\n\nThe channel utilization, $U$, is the ratio of the required data rate, $R_{\\text{req}}$, to the effective channel goodput, $R_{\\text{eff}}$.\n\nFirst, we calculate the total size of a single authenticated advisory frame, $S_{\\text{frame}}$. The frame consists of the application payload ($S_{\\text{payload}}$), the MAC header/trailer ($S_{\\text{mac}}$), and the digital signature ($S_{\\text{sig}}$).\nThe given sizes are:\n- Application payload size: $S_{\\text{payload}} = 200 \\ \\text{bytes}$\n- MAC header/trailer size: $S_{\\text{mac}} = 25 \\ \\text{bytes}$\n- Signature size: $S_{\\text{sig}} = 7{,}856 \\ \\text{bytes}$\n\nThe total frame size in bytes is the sum of its components:\n$$S_{\\text{frame}} = S_{\\text{payload}} + S_{\\text{mac}} + S_{\\text{sig}} = 200 + 25 + 7{,}856 = 8{,}081 \\ \\text{bytes}$$\nTo find the data rate, we must convert this size to bits. Since $1 \\ \\text{byte} = 8 \\ \\text{bits}$:\n$$S_{\\text{frame, bits}} = S_{\\text{frame}} \\times 8 = 8{,}081 \\times 8 = 64{,}648 \\ \\text{bits}$$\n\nThe required data rate, $R_{\\text{req}}$, is the frame size in bits multiplied by the broadcast rate, $r = 1 \\ \\text{s}^{-1}$:\n$$R_{\\text{req}} = S_{\\text{frame, bits}} \\times r = 64{,}648 \\ \\text{bits} \\times 1 \\ \\text{s}^{-1} = 64{,}648 \\ \\text{bit/s}$$\n\nNext, we calculate the effective channel goodput, $R_{\\text{eff}}$. It is the raw bit rate, $R_{\\text{raw}}$, multiplied by the MAC layer efficiency, $\\eta$.\nThe given values are:\n- Raw bit rate: $R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$\n- MAC efficiency: $\\eta = 0.80$\n\n$$R_{\\text{eff}} = \\eta \\times R_{\\text{raw}} = 0.80 \\times 250{,}000 \\ \\text{bit/s} = 200{,}000 \\ \\text{bit/s}$$\n\nFinally, we compute the channel utilization as a decimal fraction:\n$$U = \\frac{R_{\\text{req}}}{R_{\\text{eff}}} = \\frac{64{,}648 \\ \\text{bit/s}}{200{,}000 \\ \\text{bit/s}} = 0.32324$$\nRounding this to four significant figures gives:\n$$U \\approx 0.3232$$\n\nThe three requested values are the signature size in bytes ($7{,}856$), the verification time in seconds ($0.08160$), and the channel utilization ($0.3232$).",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7856 & 0.08160 & 0.3232\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world engineering is an exercise in making justified trade-offs. The PQC landscape is not monolithic; it offers a diverse range of algorithms, each with a unique profile of strengths and weaknesses. This capstone practice  challenges you to step into the role of a system architect, using a decision matrix to evaluate multiple PQC candidates against strict constraints on memory, processing power, and network bandwidth, ultimately selecting the most suitable combination for a secure embedded controller.",
            "id": "4237752",
            "problem": "A cyber-physical system (CPS) uses a digital twin to orchestrate secure remote calibration and firmware updates to an embedded controller. The controller must establish a fresh symmetric session key with the twin and perform mutual entity authentication before applying any control-plane changes. To be resilient against quantum adversaries, you must select a Post-Quantum Cryptography (PQC) Key Encapsulation Mechanism (KEM) and a PQC signature scheme for the controller. The controller has a flash memory budget of $256\\,\\mathrm{KB}$ and a random-access memory (RAM) budget of $64\\,\\mathrm{KB}$. Its microcontroller is a $32$-bit core clocked at $120\\,\\mathrm{MHz}$ without hardware floating-point. The control network is a reliable link at $1\\,\\mathrm{Mb/s}$.\n\nAssume a minimal handshake with the following sequence and message sizes determined by the chosen schemes:\n1. Controller $\\rightarrow$ Twin: KEM public key of size $S_{\\mathrm{pk}}$.\n2. Twin $\\rightarrow$ Controller: KEM ciphertext of size $S_{\\mathrm{ct}}$ (controller decapsulates to derive the shared key).\n3. Twin $\\rightarrow$ Controller: challenge nonce of $32$ bytes; Controller $\\rightarrow$ Twin: signature over the nonce of size $S_{\\mathrm{sig}}$ and signature public key of size $S_{\\mathrm{spk}}$.\n4. Controller $\\rightarrow$ Twin: challenge nonce of $32$ bytes; Twin $\\rightarrow$ Controller: signature over the nonce of size $S_{\\mathrm{sig}}$ and signature public key of size $S_{\\mathrm{spk}}$.\n\nThe controller must store its long-term private keys in flash and fit the crypto libraries (code), persistent keys, and any constant tables within the $256\\,\\mathrm{KB}$ flash budget. Peak RAM during any cryptographic operation, including stack and buffers, must not exceed $64\\,\\mathrm{KB}$. Assume a $4\\,\\mathrm{KB}$ network buffer is allocated in RAM during message handling. The twin can provision larger resources off-device, so constraints apply only to the controller.\n\nFrom first principles and well-tested facts, use the following base definitions in your reasoning:\n- The time to execute a sequence of instructions with total cycle count $C$ on a processor with frequency $f$ is $t_{\\mathrm{CPU}} = C / f$.\n- The time to transmit $B$ bytes over a link with bit rate $R$ is $t_{\\mathrm{NET}} = 8B / R$.\n- The end-to-end handshake time is the sum of computation and communication delays across all steps, $t_{\\mathrm{E2E}} = \\sum t_{\\mathrm{CPU}} + \\sum t_{\\mathrm{NET}}$.\n- If failure events are independent with probabilities $p_i$, the probability of at least one failure is $1 - \\prod_i (1 - p_i)$.\n\nYou are evaluating four candidate pairs. For each, you are given representative, scientifically plausible metrics on this class of microcontroller:\n\nCandidate data:\n- ML-KEM-512 (Module-Lattice KEM, NIST Level 1): $S_{\\mathrm{pk}} = 800\\,\\mathrm{B}$, $S_{\\mathrm{ct}} = 768\\,\\mathrm{B}$, code footprint $32\\,\\mathrm{KB}$, secret key $2.4\\,\\mathrm{KB}$, encapsulation cycles $1.8\\times 10^6$, decapsulation cycles $2.0\\times 10^6$, peak RAM $12\\,\\mathrm{KB}$, decryption failure probability $< 2^{-128}$ when implemented with standard transforms.\n- Dilithium-2 (Lattice-based signature, NIST Level 2): $S_{\\mathrm{spk}} = 1312\\,\\mathrm{B}$, $S_{\\mathrm{sig}} = 2420\\,\\mathrm{B}$, code footprint $36\\,\\mathrm{KB}$, secret key $2.5\\,\\mathrm{KB}$, sign cycles $1.5\\times 10^6$, verify cycles $0.9\\times 10^6$, peak RAM $24\\,\\mathrm{KB}$, negligible failure behavior under correct implementation.\n- Falcon-512 (Lattice-based signature with Fast Fourier Transform arithmetic): $S_{\\mathrm{spk}} = 897\\,\\mathrm{B}$, $S_{\\mathrm{sig}} = 666\\,\\mathrm{B}$, code footprint $60\\,\\mathrm{KB}$, secret key $2.3\\,\\mathrm{KB}$, sign cycles $1.8\\times 10^7$, verify cycles $5.0\\times 10^6$, peak RAM $32\\,\\mathrm{KB}$ plus large stack usage when no hardware floating-point.\n- FrodoKEM-640 (Learning With Errors KEM with standard lattices): $S_{\\mathrm{pk}} = 9616\\,\\mathrm{B}$, $S_{\\mathrm{ct}} = 9720\\,\\mathrm{B}$, code footprint $60\\,\\mathrm{KB}$, secret key $19\\,\\mathrm{KB}$, encapsulation cycles $1.2\\times 10^7$, decapsulation cycles $1.1\\times 10^7$, peak RAM $\\approx 64\\,\\mathrm{KB}$ (buffers and matrices), negligible failure behavior under correct implementation.\n- SPHINCS+-128s (Hash-based signature, NIST Level 1): $S_{\\mathrm{spk}} = 32\\,\\mathrm{B}$, $S_{\\mathrm{sig}} = 7856\\,\\mathrm{B}$, code footprint $80\\,\\mathrm{KB}$, secret key $64\\,\\mathrm{B}$, sign cycles $6.0\\times 10^7$, verify cycles $3.0\\times 10^7$, peak RAM $20\\,\\mathrm{KB}$, negligible failure behavior under correct implementation.\n- Classic McEliece mceliece348864 (Code-based KEM, NIST Level 1): $S_{\\mathrm{pk}} = 261{,}120\\,\\mathrm{B}$, $S_{\\mathrm{ct}} = 128\\,\\mathrm{B}$, code footprint $64\\,\\mathrm{KB}$, secret key $649{,}000\\,\\mathrm{B}$, encapsulation cycles $2.0\\times 10^6$, decapsulation cycles $2.5\\times 10^6$, peak RAM $16\\,\\mathrm{KB}$, negligible failure behavior under correct implementation.\n\nAssume the handshake transmits one KEM public key and one KEM ciphertext, and two signatures and two signature public keys (one per side) as described. Use the $4\\,\\mathrm{KB}$ network buffer and the peak RAM of the active algorithm to check RAM constraints. The controller must fit both crypto libraries, its private keys, and typical support code; for this exercise, assume the non-crypto application code occupies $120\\,\\mathrm{KB}$ of flash, leaving $136\\,\\mathrm{KB}$ for crypto code and keys.\n\nConstruct a decision matrix that evaluates each candidate pair against:\n- Flash usage: crypto code plus stored private keys must be $\\leq 136\\,\\mathrm{KB}$.\n- Peak RAM: algorithm peak plus network buffer must be $\\leq 64\\,\\mathrm{KB}$.\n- Network load: total handshake bytes $B_{\\mathrm{total}}$.\n- End-to-end time: sum of CPU and network times using $f = 120\\times 10^6\\,\\mathrm{Hz}$ and $R = 1\\times 10^6\\,\\mathrm{b/s}$.\n- Failure behavior: any non-negligible probability of failure is unacceptable for CPS control; otherwise acceptable.\n\nBased on this matrix, which option is the most appropriate choice for the embedded controller?\n\nA. Choose ML-KEM-512 and Dilithium-2; they fit flash and RAM, yield moderate network load and low CPU cycles on a $120\\,\\mathrm{MHz}$ microcontroller without floating-point, and have negligible decryption/signature failure probabilities, making them reliable for CPS operations.\n\nB. Choose ML-KEM-512 and Falcon-512; they minimize network load due to small signatures and public keys; the increased cycle counts without hardware floating-point are acceptable because computation can be overlapped with communication.\n\nC. Choose FrodoKEM-640 and SPHINCS+-128s; they avoid decryption failures entirely and hash-based signatures are simple to implement, so even with higher message sizes and cycles they are preferable for robustness.\n\nD. Choose Classic McEliece mceliece348864 and Dilithium-2; the KEM has very small ciphertexts and fast decapsulation, and Dilithium-2 provides strong signatures; large public and secret keys are acceptable because they are written once to flash during provisioning.",
            "solution": "The problem requires an evaluation of four candidate pairs of Post-Quantum Cryptography (PQC) schemes for an embedded controller in a Cyber-Physical System (CPS). The evaluation must be based on a defined set of constraints: flash memory, RAM, network load, end-to-end handshake time, and failure probability.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Controller Constraints:**\n    -   Flash Memory: $256\\,\\mathrm{KB}$.\n    -   RAM: $64\\,\\mathrm{KB}$.\n    -   CPU: $32$-bit core at $f = 120\\,\\mathrm{MHz}$, no FPU.\n-   **Resource Allocation:**\n    -   Non-crypto application code in flash: $120\\,\\mathrm{KB}$.\n    -   Available flash for crypto (code + keys): $F_{budget} = 256\\,\\mathrm{KB} - 120\\,\\mathrm{KB} = 136\\,\\mathrm{KB}$.\n    -   Network buffer in RAM: $RAM_{net} = 4\\,\\mathrm{KB}$.\n    -   Controller must store its long-term KEM and signature private (secret) keys.\n-   **Network:**\n    -   Reliable link with rate $R = 1\\,\\mathrm{Mb/s} = 1 \\times 10^6\\,\\mathrm{b/s}$.\n-   **Handshake Protocol & Payloads:**\n    1.  Controller $\\rightarrow$ Twin: KEM public key ($S_{\\mathrm{pk}}$).\n    2.  Twin $\\rightarrow$ Controller: KEM ciphertext ($S_{\\mathrm{ct}}$).\n    3.  Twin challenges Controller: Twin sends $32\\,\\mathrm{B}$ nonce; Controller responds with its signature ($S_{\\mathrm{sig}}$) and signature public key ($S_{\\mathrm{spk}}$).\n    4.  Controller challenges Twin: Controller sends $32\\,\\mathrm{B}$ nonce; Twin responds with its signature ($S_{\\mathrm{sig}}$) and signature public key ($S_{\\mathrm{spk}}$).\n-   **Total Network Bytes ($B_{total}$):** The sum of all message sizes:\n    $B_{total} = S_{\\mathrm{pk}} + S_{\\mathrm{ct}} + 2 \\times S_{\\mathrm{sig}} + 2 \\times S_{\\mathrm{spk}} + 64\\,\\mathrm{B}$.\n-   **Total CPU Cycles ($C_{total}$):** The handshake is sequential. The controller performs KEM decapsulation, signing, and verification. The twin performs KEM encapsulation, signing, and verification. Total cycle count impacting delay is the sum of cycles for all six operations.\n    $C_{total} = C_{\\mathrm{encaps}} + C_{\\mathrm{decaps}} + 2 \\times C_{\\mathrm{sign}} + 2 \\times C_{\\mathrm{verify}}$.\n-   **Timing Formulas:**\n    -   $t_{\\mathrm{CPU}} = C_{total} / f$\n    -   $t_{\\mathrm{NET}} = 8B_{total} / R$\n    -   $t_{\\mathrm{E2E}} = t_{\\mathrm{CPU}} + t_{\\mathrm{NET}}$\n-   **Candidate Data:** Provided in the problem statement for ML-KEM-512, Dilithium-2, Falcon-512, FrodoKEM-640, SPHINCS+-128s, and Classic McEliece.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using real-world PQC candidates and plausible performance data. The constraints and evaluation metrics are objective and well-defined. The handshake protocol, while specified tersely, is logically consistent for achieving key establishment and mutual authentication. A minor ambiguity exists regarding the RAM usage of Falcon-512 (\"peak RAM $32\\,\\mathrm{KB}$ plus large stack usage\"), but the qualitative warning is sufficiently clear to be interpreted as a likely failure of the RAM constraint on a device without a hardware floating-point unit. The problem is therefore considered valid and well-posed for a quantitative engineering trade-off analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now construct the decision matrix by evaluating each candidate pair.\n\n---\n\n### Decision Matrix Construction\n\nThe evaluation criteria are:\n1.  **Flash Usage ($F_{used}$):** Must be $\\le F_{budget} = 136\\,\\mathrm{KB}$. $F_{used} = \\text{Code}_{\\text{KEM}} + \\text{Code}_{\\text{Sig}} + \\text{SK}_{\\text{KEM}} + \\text{SK}_{\\text{Sig}}$.\n2.  **Peak RAM ($RAM_{peak}$):** Must be $\\le 64\\,\\mathrm{KB}$. $RAM_{peak} = \\max(\\text{RAM}_{\\text{KEM}}, \\text{RAM}_{\\text{Sig}}) + RAM_{net}$.\n3.  **Network Load ($B_{total}$):** Calculated as a performance metric.\n4.  **End-to-End Time ($t_{\\mathrm{E2E}}$):** Calculated as a performance metric.\n5.  **Failure Behavior:** Must be negligible.\n\n**Candidate Pair A: ML-KEM-512 and Dilithium-2**\n-   **Flash:** $F_{used} = 32\\,\\mathrm{KB} (\\text{code}) + 36\\,\\mathrm{KB} (\\text{code}) + 2.4\\,\\mathrm{KB} (\\text{sk}) + 2.5\\,\\mathrm{KB} (\\text{sk}) = 72.9\\,\\mathrm{KB}$.\n    $72.9\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$. **Pass**.\n-   **RAM:** $RAM_{peak} = \\max(12\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 24\\,\\mathrm{KB} + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$.\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$. **Pass**.\n-   **Network:** $B_{total} = 800 + 768 + 2(2420) + 2(1312) + 64 = 1568 + 4840 + 2624 + 64 = 9096\\,\\mathrm{B}$.\n-   **Time:**\n    $C_{total} = (1.8 + 2.0 + 2(1.5) + 2(0.9)) \\times 10^6 = (3.8 + 3.0 + 1.8) \\times 10^6 = 8.6 \\times 10^6$ cycles.\n    $t_{\\mathrm{CPU}} = (8.6 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.0717\\,\\mathrm{s}$.\n    $t_{\\mathrm{NET}} = (8 \\times 9096\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0728\\,\\mathrm{s}$.\n    $t_{\\mathrm{E2E}} \\approx 0.0717 + 0.0728 = 0.1445\\,\\mathrm{s}$.\n-   **Failure:** DFP of ML-KEM-512 is $< 2^{-128}$ (negligible). Dilithium failure is negligible. **Pass**.\n-   **Verdict:** **Viable**.\n\n**Candidate Pair B: ML-KEM-512 and Falcon-512**\n-   **Flash:** $F_{used} = 32\\,\\mathrm{KB} + 60\\,\\mathrm{KB} + 2.4\\,\\mathrm{KB} + 2.3\\,\\mathrm{KB} = 96.7\\,\\mathrm{KB}$.\n    $96.7\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$. **Pass**.\n-   **RAM:** The problem states Falcon-512 has \"large stack usage when no hardware floating-point\" on top of its $32\\,\\mathrm{KB}$ base RAM. This addition will likely cause the total RAM usage to exceed the $64\\,\\mathrm{KB}$ budget, as the stack for software floating-point emulation and recursive FFT calculations can be substantial (tens of KB). Thus, this pair fails the RAM constraint. **Fail**.\n-   **Network:** $B_{total} = 800 + 768 + 2(666) + 2(897) + 64 = 1568 + 1332 + 1794 + 64 = 4758\\,\\mathrm{B}$.\n-   **Time:**\n    $C_{total} = (1.8 + 2.0 + 2(18) + 2(5.0)) \\times 10^6 = (3.8 + 36 + 10) \\times 10^6 = 49.8 \\times 10^6$ cycles.\n    $t_{\\mathrm{CPU}} = (49.8 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.415\\,\\mathrm{s}$.\n    $t_{\\mathrm{NET}} = (8 \\times 4758\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0381\\,\\mathrm{s}$.\n    $t_{\\mathrm{E2E}} \\approx 0.415 + 0.0381 = 0.4531\\,\\mathrm{s}$.\n-   **Failure:** Negligible. **Pass**.\n-   **Verdict:** **Not Viable** (fails RAM constraint).\n\n**Candidate Pair C: FrodoKEM-640 and SPHINCS+-128s**\n-   **Flash:** $F_{used} = 60\\,\\mathrm{KB} + 80\\,\\mathrm{KB} + 19\\,\\mathrm{KB} + 64\\,\\mathrm{B} = 159.064\\,\\mathrm{KB}$.\n    $159.064\\,\\mathrm{KB} > 136\\,\\mathrm{KB}$. **Fail**.\n-   **RAM:** $RAM_{peak} = \\max(\\approx 64\\,\\mathrm{KB}, 20\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} \\approx 68\\,\\mathrm{KB}$.\n    $\\approx 68\\,\\mathrm{KB} > 64\\,\\mathrm{KB}$. **Fail**.\n-   **Network:** $B_{total} = 9616 + 9720 + 2(7856) + 2(32) + 64 = 19336 + 15712 + 64 + 64 = 35176\\,\\mathrm{B}$.\n-   **Time:**\n    $C_{total} = (1.2 \\times 10^7 + 1.1 \\times 10^7 + 2(6.0 \\times 10^7) + 2(3.0 \\times 10^7)) = (2.3 + 12 + 6) \\times 10^7 = 20.3 \\times 10^7$ cycles.\n    $t_{\\mathrm{CPU}} = (2.03 \\times 10^8) / (1.2 \\times 10^8\\,\\mathrm{Hz}) \\approx 1.692\\,\\mathrm{s}$.\n    $t_{\\mathrm{NET}} = (8 \\times 35176\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.281\\,\\mathrm{s}$.\n    $t_{\\mathrm{E2E}} \\approx 1.692 + 0.281 = 1.973\\,\\mathrm{s}$.\n-   **Failure:** Negligible. **Pass**.\n-   **Verdict:** **Not Viable** (fails flash and RAM constraints).\n\n**Candidate Pair D: Classic McEliece mceliece348864 and Dilithium-2**\n-   **Flash:** The secret key for Classic McEliece is $SK = 649000\\,\\mathrm{B} = 649\\,\\mathrm{KB}$. This alone exceeds the $136\\,\\mathrm{KB}$ budget. **Fail**.\n-   **RAM:** $RAM_{peak} = \\max(16\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$.\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$. **Pass**.\n-   **Network:** The public key for Classic McEliece is $S_{\\mathrm{pk}} = 261120\\,\\mathrm{B}$.\n    $B_{total} = 261120 + 128 + 2(2420) + 2(1312) + 64 = 261120 + 128 + 4840 + 2624 + 64 = 268776\\,\\mathrm{B}$.\n-   **Time:** The network time for the public key alone is $t_{\\mathrm{NET, pk}} = (8 \\times 261120) / 10^6 \\approx 2.09\\,\\mathrm{s}$. This makes the handshake extremely slow, dominated by the network component.\n-   **Failure:** Negligible. **Pass**.\n-   **Verdict:** **Not Viable** (fails flash constraint, and performance is unacceptable due to huge public key).\n\n### Option-by-Option Analysis\n\n**A. Choose ML-KEM-512 and Dilithium-2; they fit flash and RAM, yield moderate network load and low CPU cycles on a $120\\,\\mathrm{MHz}$ microcontroller without floating-point, and have negligible decryption/signature failure probabilities, making them reliable for CPS operations.**\nThis statement is fully consistent with the analysis. This combination is the only one that meets all the specified hardware constraints (flash and RAM). The resulting performance ($B_{total} = 9096\\,\\mathrm{B}$, $t_{\\mathrm{E2E}} \\approx 0.145\\,\\mathrm{s}$) is reasonable for an embedded system. The failure properties are acceptable.\n**Verdict: Correct.**\n\n**B. Choose ML-KEM-512 and Falcon-512; they minimize network load due to small signatures and public keys; the increased cycle counts without hardware floating-point are acceptable because computation can be overlapped with communication.**\nThis option makes two incorrect assertions. First, it ignores the critical warning about \"large stack usage\" for Falcon-512 on a core without an FPU, which invalidates it on RAM constraints. Second, it claims computation can be a-priori overlapped with communication, which is false for the specified sequential handshake protocol. The total latency is the sum of sequential computation and communication delays.\n**Verdict: Incorrect.**\n\n**C. Choose FrodoKEM-640 and SPHINCS+-128s; they avoid decryption failures entirely and hash-based signatures are simple to implement, so even with higher message sizes and cycles they are preferable for robustness.**\nThis option is incorrect. The combination fails both flash and RAM constraints by a significant margin. The claim of avoiding failures entirely is not a significant advantage over ML-KEM's cryptographically negligible failure rate. The \"higher\" message sizes and cycles lead to unacceptably high network load and a handshake time of nearly $2$ seconds.\n**Verdict: Incorrect.**\n\n**D. Choose Classic McEliece mceliece348864 and Dilithium-2; the KEM has very small ciphertexts and fast decapsulation, and Dilithium-2 provides strong signatures; large public and secret keys are acceptable because they are written once to flash during provisioning.**\nThis option is fundamentally flawed. The statement that \"large public and secret keys are acceptable\" is false. The secret key of $649\\,\\mathrm{KB}$ is far larger than the available $136\\,\\mathrm{KB}$ of flash. The public key of over $261\\,\\mathrm{KB}$ would require over $2$ seconds just to transmit, making the handshake prohibitively slow for most CPS applications.\n**Verdict: Incorrect.**\n\nBased on this comprehensive analysis, only option A presents a viable and appropriate solution.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}