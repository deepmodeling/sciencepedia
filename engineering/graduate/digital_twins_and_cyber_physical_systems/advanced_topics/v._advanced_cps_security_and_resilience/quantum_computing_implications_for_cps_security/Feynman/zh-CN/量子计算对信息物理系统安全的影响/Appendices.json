{
    "hands_on_practices": [
        {
            "introduction": "后量子密码学 (PQC) 的部署不仅仅是算法的简单替换，更涉及对系统性能影响的全面评估。无状态哈希签名方案，如 SPHINCS+，因其基于成熟哈希函数的强大安全性而备受关注。然而，这种安全性也伴随着显著的性能开销。这项实践将指导您在一个典型的工业网络物理系统（CPS）场景中，对 SPHINCS+ 的性能进行量化分析。通过计算签名验证时间和网络带宽占用，您将具体地理解部署这种高安全性 PQC 算法所带来的性能权衡。",
            "id": "4237791",
            "problem": "一个工业信息物理系统 (CPS) 使用数字孪生进行监督控制，并通过空中下载 (OTA) 广播向所有现场设备认证控制建议。为保持对装备了大规模量子计算机的攻击者的安全性，该系统采用了在128位安全级别下的SPHINCS+（Stateless Practical Hash-based Incredibly Nice Cryptographic Signatures），其使用安全哈希算法256位 (SHA-256) 参数集，记为 $\\text{SPHINCS}+\\text{-SHA256-128s}$。\n\n假设以下经过充分测试的事实和平台特性：\n- $\\text{SPHINCS}+\\text{-SHA256-128s}$ 签名的字节长度为 $7{,}856$ 字节（此参数集的公认规范值）。\n- 嵌入式网关上的签名验证可归结为 $N$ 次SHA-256压缩函数的应用，其中 $N = 120{,}000$ 是此参数集在参考实现中的一个一致测量值。\n- 嵌入式网关有一个单核，时钟频率为 $f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{cycles/s}$，SHA-256压缩函数的成本为每个 $64$ 字节块 $c = 680$ 个周期（测量的常数时间实现；对于带标准填充的 $32$ 字节输入，每次哈希调用一次）。\n- 工厂的无线广播网络使用IEEE 802.15.4级别的物理层，原始比特率为 $R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$。媒体访问控制 (MAC) 层的效率因子为 $\\eta = 0.80$，该因子包含了帧开销和竞争，因此有效吞吐量为 $R_{\\text{eff}} = \\eta R_{\\text{raw}}$。\n- 每个经过认证的建议帧包含一个 $200$ 字节的应用负载、一个 $25$ 字节的MAC头部/尾部，以及 $\\text{SPHINCS}+\\text{-SHA256-128s}$ 签名。\n- 网关以 $r = 1 \\ \\text{s}^{-1}$ 的速率广播建议。\n\n从这些基本原理和公认事实出发，完成以下任务：\n1. 计算以字节为单位的签名大小。\n2. 根据SHA-256压缩函数的周期级模型，推导出以秒为单位的签名验证时间。\n3. 计算在给定的广播速率下，所需的信道利用率，表示为有效吞吐量的小数值。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含签名大小（字节）、验证时间（秒）和信道利用率（小数）。将验证时间和信道利用率四舍五入到四位有效数字。不要在矩阵内包含单位；单位只能在推导过程中使用。",
            "solution": "该问题陈述被评估为有效，因为它科学地基于后量子密码学、计算机体系结构和无线网络中的既有概念。该问题是适定的、客观的，并包含足以推导出唯一解的充分且一致的信息。所提供的数据，例如 $\\text{SPHINCS}+\\text{-SHA256-128s}$ 的签名大小、SHA-256 性能和 IEEE 802.15.4 规范，在事实上是正确且符合实际的。该问题需要基于这些给定条件进行一系列计算。\n\n解题过程分为三部分，对应三个任务。\n\n**第1部分：签名大小**\n\n问题明确说明了指定参数集的签名大小。该值是作为一个“公认的规范值”给出的。\n使用的签名方案是 $\\text{SPHINCS}+\\text{-SHA256-128s}$。\n签名的字节长度，记为 $S_{\\text{sig}}$，给定如下：\n$$S_{\\text{sig}} = 7{,}856 \\ \\text{bytes}$$\n\n**第2部分：签名验证时间**\n\n签名验证时间 $T_{\\text{verify}}$ 取决于计算所需的CPU总周期数和CPU的时钟频率。\n总周期数 $C_{\\text{total}}$ 是SHA-256压缩函数应用次数 $N$ 与每次应用的周期成本 $c$ 的乘积。\n给定的值为：\n- SHA-256压缩函数应用次数：$N = 120{,}000$\n- 每个压缩函数的周期成本：$c = 680 \\ \\text{cycles}$\n- CPU时钟频率：$f_{\\text{CPU}} = 1.0 \\times 10^{9} \\ \\text{cycles/s}$\n\n首先，我们计算总周期数：\n$$C_{\\text{total}} = N \\times c = 120{,}000 \\times 680 \\ \\text{cycles} = 81{,}600{,}000 \\ \\text{cycles}$$\n这可以用科学记数法写成 $8.16 \\times 10^{7} \\ \\text{cycles}$。\n\n接下来，我们通过将总周期数除以时钟频率来计算验证时间：\n$$T_{\\text{verify}} = \\frac{C_{\\text{total}}}{f_{\\text{CPU}}} = \\frac{8.16 \\times 10^{7} \\ \\text{cycles}}{1.0 \\times 10^{9} \\ \\text{cycles/s}} = 0.0816 \\ \\text{s}$$\n问题要求将此值四舍五入到四位有效数字。因此，我们将其表示为：\n$$T_{\\text{verify}} = 0.08160 \\ \\text{s}$$\n\n**第3部分：信道利用率**\n\n信道利用率 $U$ 是所需数据速率 $R_{\\text{req}}$ 与有效信道吞吐量 $R_{\\text{eff}}$ 的比率。\n\n首先，我们计算单个认证建议帧的总大小 $S_{\\text{frame}}$。该帧由应用负载 ($S_{\\text{payload}}$)、MAC头部/尾部 ($S_{\\text{mac}}$) 和数字签名 ($S_{\\text{sig}}$) 组成。\n给定的大小为：\n- 应用负载大小：$S_{\\text{payload}} = 200 \\ \\text{bytes}$\n- MAC头部/尾部大小：$S_{\\text{mac}} = 25 \\ \\text{bytes}$\n- 签名大小：$S_{\\text{sig}} = 7{,}856 \\ \\text{bytes}$\n\n以字节为单位的总帧大小是其各组成部分之和：\n$$S_{\\text{frame}} = S_{\\text{payload}} + S_{\\text{mac}} + S_{\\text{sig}} = 200 + 25 + 7{,}856 = 8{,}081 \\ \\text{bytes}$$\n为了求出数据速率，我们必须将此大小转换为比特。因为 $1 \\ \\text{byte} = 8 \\ \\text{bits}$：\n$$S_{\\text{frame, bits}} = S_{\\text{frame}} \\times 8 = 8{,}081 \\times 8 = 64{,}648 \\ \\text{bits}$$\n\n所需数据速率 $R_{\\text{req}}$ 是以比特为单位的帧大小乘以广播速率 $r = 1 \\ \\text{s}^{-1}$：\n$$R_{\\text{req}} = S_{\\text{frame, bits}} \\times r = 64{,}648 \\ \\text{bits} \\times 1 \\ \\text{s}^{-1} = 64{,}648 \\ \\text{bit/s}$$\n\n接下来，我们计算有效信道吞吐量 $R_{\\text{eff}}$。它是原始比特率 $R_{\\text{raw}}$ 乘以MAC层效率 $\\eta$。\n给定的值为：\n- 原始比特率：$R_{\\text{raw}} = 250{,}000 \\ \\text{bit/s}$\n- MAC效率：$\\eta = 0.80$\n\n$$R_{\\text{eff}} = \\eta \\times R_{\\text{raw}} = 0.80 \\times 250{,}000 \\ \\text{bit/s} = 200{,}000 \\ \\text{bit/s}$$\n\n最后，我们计算信道利用率（以小数表示）：\n$$U = \\frac{R_{\\text{req}}}{R_{\\text{eff}}} = \\frac{64{,}648 \\ \\text{bit/s}}{200{,}000 \\ \\text{bit/s}} = 0.32324$$\n将其四舍五入到四位有效数字，得到：\n$$U \\approx 0.3232$$\n\n所要求的三个值分别是签名大小（$7{,}856$字节）、验证时间（$0.08160$秒）和信道利用率（$0.3232$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7856  0.08160  0.3232\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "对于许多部署在偏远地区或由电池供电的网络物理系统而言，能源是比计算速度或带宽更为宝贵的资源。在这些资源受限的设备上，每一次加密操作的能耗都会直接影响系统的运行寿命和维护周期。这项练习将引导您对 PQC 操作在低功耗微控制器上的能耗进行建模。您将计算每次加密操作的能量成本，并评估其对设备电池寿命的总体影响，从而揭示加密算法选择与系统可持续性之间的关键联系。",
            "id": "4237742",
            "problem": "一个遥感节点是信息物理系统（Cyber-Physical System, CPS）的一部分，其数字孪生（Digital Twin, DT）对能量消耗进行建模，以预测在向量子计算机预期能力推动的后量子密码学（Post-Quantum Cryptography, PQC）过渡下的维护和电池更换周期。该节点使用嵌入式微控制器，其电源电压 $V$ 恒定，在执行加密程序时，它在时钟频率 $f$ 下消耗恒定的活动电流 $I_{\\text{cpu}}$。在短暂的预定通信窗口之外，该节点以恒定电流 $I_{\\text{sleep}}$ 进入睡眠模式。每次数据上传都需要使用PQC签名算法生成一个数字签名，并且该节点每天执行一次密钥封装机制（Key Encapsulation Mechanism, KEM）解封装来刷新会话密钥。假设能量由功率的时间积分给出，$E=\\int V I\\, dt$，并且 $V$、$I_{\\text{cpu}}$ 和 $I_{\\text{sleep}}$ 在各自的时间间隔内是恒定的。\n\n系统参数：\n- 电源电压：$V=3.0\\,\\text{V}$。\n- 时钟频率：$f=48\\times 10^{6}\\,\\text{Hz}$。\n- CPU密集型加密期间的活动电流：$I_{\\text{cpu}}=15\\times 10^{-3}\\,\\text{A}$。\n- 睡眠电流：$I_{\\text{sleep}}=20\\times 10^{-6}\\,\\text{A}$。\n- 每次上传的通信窗口（无线电和传感合计）：持续时间 $t_{\\text{comm}}=2\\,\\text{s}$，活动电流 $I_{\\text{comm}}=30\\times 10^{-3}\\,\\text{A}$。\n- 上传间隔：每 $10\\,\\text{min}$ 一次，连续 $24\\,\\text{h}$。\n- 每次上传的PQC签名生成周期数：$c_{\\text{sig}}=24\\times 10^{6}$ 个周期。\n- 每天的PQC KEM解封装周期数：$c_{\\text{kem}}=12\\times 10^{6}$ 个周期。\n- 电池容量：$Q_{\\text{batt}}=2.4\\,\\text{Ah}$，可供微控制器在 $V=3.0\\,\\text{V}$ 下使用（忽略调节损失和温度依赖性）。\n\n任务：\n1. 从 $E=\\int V I\\, dt$ 和 $t=\\frac{\\text{cycles}}{f}$ 推导出每次PQC签名生成的能量 $E_{\\text{sig}}$ 和每次PQC KEM解封装的能量 $E_{\\text{kem}}$，以 $\\text{J}$ 表示。\n2. 计算不含PQC的每日基准能量 $E_{\\text{day,0}}$（即仅包括通信窗口和睡眠），然后计算包含PQC的每日能量 $E_{\\text{day,1}}$（即每次上传增加一次签名，每天增加一次KEM解封装）。\n3. 使用 $E_{\\text{batt}}=V\\,Q_{\\text{batt}}\\times 3600$ 和 $T=\\frac{E_{\\text{batt}}}{E_{\\text{day}}}$，确定不含PQC时的电池寿命 $T_{0}$ 和含PQC时的电池寿命 $T_{1}$（以天为单位）。\n\n将 $E_{\\text{sig}}$ 和 $E_{\\text{kem}}$ 以焦耳表示，将 $T_{0}$ 和 $T_{1}$ 以天表示。将这四个量均四舍五入到四位有效数字。将最终答案以包含 $(E_{\\text{sig}},\\,E_{\\text{kem}},\\,T_{0},\\,T_{1})$ 的单行矩阵形式提供。",
            "solution": "问题陈述已经过分析，并被确定为有效。它具有科学依据，问题提出得当，客观，并包含推导唯一、有意义解所需的所有必要信息。所提供的参数对于信息物理系统环境下的低功耗嵌入式系统是现实的。\n\n解答过程遵循问题中列出的三个任务。\n\n**任务1：每次PQC操作的能量（$E_{\\text{sig}}$ 和 $E_{\\text{kem}}$）**\n\n能量 $E$ 是功率 $P$ 对时间 $t$ 的积分，其中功率是电压 $V$ 和电流 $I$ 的乘积。由于在加密操作期间，$V$ 和活动CPU电流 $I_{\\text{cpu}}$ 是恒定的，所以能量由 $E = V I_{\\text{cpu}} t$ 给出。执行一个操作所需的时间由时钟周期数 $c$ 和时钟频率 $f$ 决定，即 $t = \\frac{c}{f}$。\n\n结合这些关系，加密操作的能量为：\n$$E = V I_{\\text{cpu}} \\left( \\frac{c}{f} \\right)$$\n问题给出了以下参数：\n- 电源电压：$V = 3.0\\,\\text{V}$\n- 时钟频率：$f = 48 \\times 10^{6}\\,\\text{Hz}$\n- 活动CPU电流：$I_{\\text{cpu}} = 15 \\times 10^{-3}\\,\\text{A}$\n- 签名生成周期数：$c_{\\text{sig}} = 24 \\times 10^{6}$ 个周期\n- KEM解封装周期数：$c_{\\text{kem}} = 12 \\times 10^{6}$ 个周期\n\n首先，计算每个操作的时间。\n签名生成的时间为：\n$$t_{\\text{sig}} = \\frac{c_{\\text{sig}}}{f} = \\frac{24 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.5\\,\\text{s}$$\nKEM解封装的时间为：\n$$t_{\\text{kem}} = \\frac{c_{\\text{kem}}}{f} = \\frac{12 \\times 10^{6}\\,\\text{cycles}}{48 \\times 10^{6}\\,\\text{Hz}} = 0.25\\,\\text{s}$$\n\n现在，计算每个操作的能量。\n一次签名生成的能量为：\n$$E_{\\text{sig}} = V I_{\\text{cpu}} t_{\\text{sig}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.5\\,\\text{s}) = 0.0225\\,\\text{J}$$\n一次KEM解封装的能量为：\n$$E_{\\text{kem}} = V I_{\\text{cpu}} t_{\\text{kem}} = (3.0\\,\\text{V}) (15 \\times 10^{-3}\\,\\text{A}) (0.25\\,\\text{s}) = 0.01125\\,\\text{J}$$\n\n**任务2：每日能耗（$E_{\\text{day,0}}$ 和 $E_{\\text{day,1}}$）**\n\n首先，确定每天的上传次数。一天有 $24 \\times 60 = 1440$ 分钟。每 $10$ 分钟上传一次，则每天的上传次数为：\n$$N_{\\text{uploads}} = \\frac{1440\\,\\text{min}}{10\\,\\text{min}} = 144\\,\\text{uploads/day}$$\n一天的总时间是 $T_{\\text{day}} = 24\\,\\text{h} \\times 3600\\,\\text{s/h} = 86400\\,\\text{s}$。\n\n为了计算每日能量，我们将各种状态（通信、睡眠、PQC操作）下消耗的能量相加。\n\n**基准日能量，$E_{\\text{day,0}}$（不含PQC）：**\n节点仅进行通信和睡眠。\n每天用于通信的总时间：\n$$T_{\\text{comm,total}} = N_{\\text{uploads}} \\times t_{\\text{comm}} = 144 \\times 2\\,\\text{s} = 288\\,\\text{s}$$\n每天通信期间消耗的能量，使用 $I_{\\text{comm}} = 30\\times 10^{-3}\\,\\text{A}$：\n$$E_{\\text{comm,total}} = N_{\\text{uploads}} \\times V I_{\\text{comm}} t_{\\text{comm}} = 144 \\times (3.0\\,\\text{V}) (30 \\times 10^{-3}\\,\\text{A}) (2\\,\\text{s}) = 25.92\\,\\text{J}$$\n每天睡眠的总时间：\n$$T_{\\text{sleep},0} = T_{\\text{day}} - T_{\\text{comm,total}} = 86400\\,\\text{s} - 288\\,\\text{s} = 86112\\,\\text{s}$$\n每天睡眠期间消耗的能量，使用 $I_{\\text{sleep}} = 20\\times 10^{-6}\\,\\text{A}$：\n$$E_{\\text{sleep},0} = V I_{\\text{sleep}} T_{\\text{sleep},0} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86112\\,\\text{s}) = 5.16672\\,\\text{J}$$\n总的每日基准能量为：\n$$E_{\\text{day},0} = E_{\\text{comm,total}} + E_{\\text{sleep},0} = 25.92\\,\\text{J} + 5.16672\\,\\text{J} = 31.08672\\,\\text{J}$$\n\n**日能量，$E_{\\text{day,1}}$（含PQC）：**\n这包括通信、睡眠、$144$ 次签名生成和 $1$ 次KEM解封装。\n每天签名生成的总时间：$T_{\\text{sig,total}} = N_{\\text{uploads}} \\times t_{\\text{sig}} = 144 \\times 0.5\\,\\text{s} = 72\\,\\text{s}$。\n每天KEM解封装的总时间：$T_{\\text{kem,total}} = 1 \\times t_{\\text{kem}} = 0.25\\,\\text{s}$。\n用于PQC操作的总时间是 $T_{\\text{pqc}} = T_{\\text{sig,total}} + T_{\\text{kem,total}} = 72\\,\\text{s} + 0.25\\,\\text{s} = 72.25\\,\\text{s}$。\n每天PQC操作的总能量：\n$$E_{\\text{pqc,total}} = (N_{\\text{uploads}} \\times E_{\\text{sig}}) + (1 \\times E_{\\text{kem}}) = (144 \\times 0.0225\\,\\text{J}) + (1 \\times 0.01125\\,\\text{J})$$\n$$E_{\\text{pqc,total}} = 3.24\\,\\text{J} + 0.01125\\,\\text{J} = 3.25125\\,\\text{J}$$\n通信能量保持不变：$E_{\\text{comm,total}} = 25.92\\,\\text{J}$。\n新的睡眠时间为：\n$$T_{\\text{sleep},1} = T_{\\text{day}} - T_{\\text{comm,total}} - T_{\\text{pqc}} = 86400\\,\\text{s} - 288\\,\\text{s} - 72.25\\,\\text{s} = 86039.75\\,\\text{s}$$\n新的睡眠能量为：\n$$E_{\\text{sleep},1} = V I_{\\text{sleep}} T_{\\text{sleep},1} = (3.0\\,\\text{V}) (20 \\times 10^{-6}\\,\\text{A}) (86039.75\\,\\text{s}) = 5.162385\\,\\text{J}$$\n含PQC的总日能量是所有部分的和：\n$$E_{\\text{day},1} = E_{\\text{comm,total}} + E_{\\text{pqc,total}} + E_{\\text{sleep},1} = 25.92\\,\\text{J} + 3.25125\\,\\text{J} + 5.162385\\,\\text{J} = 34.333635\\,\\text{J}$$\n\n\n**任务3：电池寿命（$T_{0}$ 和 $T_{1}$）**\n\n首先，计算电池中存储的总能量 $E_{\\text{batt}}$。容量给定为 $Q_{\\text{batt}} = 2.4\\,\\text{Ah}$。使用提供的公式：\n$$E_{\\text{batt}} = V Q_{\\text{batt}} \\times 3600\\,\\frac{\\text{s}}{\\text{h}} = (3.0\\,\\text{V}) (2.4\\,\\text{Ah}) (3600\\,\\text{s/h}) = 25920\\,\\text{J}$$\n电池寿命（以天为单位）为 $T = \\frac{E_{\\text{batt}}}{E_{\\text{day}}}$。\n\n不含PQC的电池寿命，$T_{0}$：\n$$T_{0} = \\frac{E_{\\text{batt}}}{E_{\\text{day},0}} = \\frac{25920\\,\\text{J}}{31.08672\\,\\text{J/day}} \\approx 833.8153\\,\\text{days}$$\n含PQC的电池寿命，$T_{1}$：\n$$T_{1} = \\frac{E_{\\text{batt}}}{E_{\\text{day},1}} = \\frac{25920\\,\\text{J}}{34.333635\\,\\text{J/day}} \\approx 754.9433\\,\\text{days}$$\n\n**最终答案取整**\n问题要求将四个最终量（$E_{\\text{sig}}$、$E_{\\text{kem}}$、$T_{0}$、$T_{1}$）四舍五入到四位有效数字。\n- $E_{\\text{sig}} = 0.0225\\,\\text{J}$ 变为 $0.02250\\,\\text{J}$。\n- $E_{\\text{kem}} = 0.01125\\,\\text{J}$ 保持 $0.01125\\,\\text{J}$。\n- $T_{0} = 833.8153...$ 天变为 $833.8$ 天。\n- $T_{1} = 754.9433...$ 天变为 $754.9$ 天。\n\n最终值为 $E_{\\text{sig}} = 0.02250\\,\\text{J}$，$E_{\\text{kem}} = 0.01125\\,\\text{J}$，$T_{0} = 833.8$ 天，以及 $T_{1} = 754.9$ 天。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.02250  0.01125  833.8  754.9 \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论分析和单一指标评估是重要的第一步，但现实世界的工程决策需要在多个相互冲突的约束条件之间做出权衡。为特定的嵌入式控制器选择合适的 PQC 算法组合，要求系统设计师综合考虑代码空间、内存占用、计算延迟、网络负载和安全性。这项综合性实践模拟了一个真实的工程决策过程。您将构建一个决策矩阵，根据一系列严格的硬件和性能约束（如闪存、RAM、网络负载和延迟），评估多个 PQC 密钥封装机制 (KEM) 和签名方案，并最终选择最合适的组合。",
            "id": "4237752",
            "problem": "一个信息物理系统 (CPS) 使用数字孪生来协调对嵌入式控制器的安全远程校准和固件更新。在应用任何控制平面变更之前，控制器必须与孪生体建立一个新的对称会话密钥，并执行双向实体认证。为了抵御量子对手的攻击，您必须为该控制器选择一个后量子密码 (PQC) 密钥封装机制 (KEM) 和一个 PQC 签名方案。该控制器的闪存预算为 $256\\,\\mathrm{KB}$，随机存取存储器 (RAM) 预算为 $64\\,\\mathrm{KB}$。其微控制器是一个 $32$ 位核心，时钟频率为 $120\\,\\mathrm{MHz}$，不带硬件浮点单元。控制网络是速率为 $1\\,\\mathrm{Mb/s}$ 的可靠链路。\n\n假设一个最小化的握手协议，其序列和消息大小由所选方案决定，如下所示：\n1. 控制器 $\\rightarrow$ 孪生体：大小为 $S_{\\mathrm{pk}}$ 的 KEM 公钥。\n2. 孪生体 $\\rightarrow$ 控制器：大小为 $S_{\\mathrm{ct}}$ 的 KEM 密文（控制器解封装以派生共享密钥）。\n3. 孪生体 $\\rightarrow$ 控制器：$32$ 字节的挑战随机数；控制器 $\\rightarrow$ 孪生体：对该随机数的签名（大小为 $S_{\\mathrm{sig}}$）和签名公钥（大小为 $S_{\\mathrm{spk}}$）。\n4. 控制器 $\\rightarrow$ 孪生体：$32$ 字节的挑战随机数；孪生体 $\\rightarrow$ 控制器：对该随机数的签名（大小为 $S_{\\mathrm{sig}}$）和签名公钥（大小为 $S_{\\mathrm{spk}}$）。\n\n控制器必须将其长期私钥存储在闪存中，并将加密库（代码）、持久化密钥和任何常量表都置于 $256\\,\\mathrm{KB}$ 的闪存预算内。任何加密操作期间的峰值 RAM（包括栈和缓冲区）不得超过 $64\\,\\mathrm{KB}$。假设在消息处理期间，RAM 中分配了 $4\\,\\mathrm{KB}$ 的网络缓冲区。孪生体可以在设备外部署更大的资源，因此这些约束仅适用于控制器。\n\n根据第一性原理和经过充分检验的事实，在您的推理中使用以下基本定义：\n- 在频率为 $f$ 的处理器上执行总周期数为 $C$ 的指令序列所需的时间为 $t_{\\mathrm{CPU}} = C / f$。\n- 在比特率为 $R$ 的链路上​​传输 $B$ 字节所需的时间为 $t_{\\mathrm{NET}} = 8B / R$。\n- 端到端握手时间是所有步骤中计算和通信延迟的总和，$t_{\\mathrm{E2E}} = \\sum t_{\\mathrm{CPU}} + \\sum t_{\\mathrm{NET}}$。\n- 如果故障事件是独立的，其概率为 $p_i$，则至少发生一次故障的概率为 $1 - \\prod_i (1 - p_i)$。\n\n您正在评估四对候选方案。对于每一对，都给出了在这类微控制器上有代表性的、科学上合理的度量指标：\n\n候选方案数据：\n- ML-KEM-512 (基于模块格的 KEM，NIST 1级)：$S_{\\mathrm{pk}} = 800\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 768\\,\\mathrm{B}$，代码占用 $32\\,\\mathrm{KB}$，私钥 $2.4\\,\\mathrm{KB}$，封装周期数 $1.8\\times 10^6$，解封装周期数 $2.0\\times 10^6$，峰值 RAM $12\\,\\mathrm{KB}$，在使用标准变换实现时，解密失败概率 $2^{-128}$。\n- Dilithium-2 (基于格的签名，NIST 2级)：$S_{\\mathrm{spk}} = 1312\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 2420\\,\\mathrm{B}$，代码占用 $36\\,\\mathrm{KB}$，私钥 $2.5\\,\\mathrm{KB}$，签名周期数 $1.5\\times 10^6$，验证周期数 $0.9\\times 10^6$，峰值 RAM $24\\,\\mathrm{KB}$，在正确实现下，故障行为可忽略不计。\n- Falcon-512 (使用快速傅里叶变换算法的基于格的签名)：$S_{\\mathrm{spk}} = 897\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 666\\,\\mathrm{B}$，代码占用 $60\\,\\mathrm{KB}$，私钥 $2.3\\,\\mathrm{KB}$，签名周期数 $1.8\\times 10^7$，验证周期数 $5.0\\times 10^6$，峰值 RAM $32\\,\\mathrm{KB}$，在没有硬件浮点单元时有大量栈使用。\n- FrodoKEM-640 (使用标准格的带错误学习 KEM)：$S_{\\mathrm{pk}} = 9616\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 9720\\,\\mathrm{B}$，代码占用 $60\\,\\mathrm{KB}$，私钥 $19\\,\\mathrm{KB}$，封装周期数 $1.2\\times 10^7$，解封装周期数 $1.1\\times 10^7$，峰值 RAM $\\approx 64\\,\\mathrm{KB}$ (缓冲区和矩阵)，在正确实现下，故障行为可忽略不计。\n- SPHINCS+-128s (基于哈希的签名，NIST 1级)：$S_{\\mathrm{spk}} = 32\\,\\mathrm{B}$，$S_{\\mathrm{sig}} = 7856\\,\\mathrm{B}$，代码占用 $80\\,\\mathrm{KB}$，私钥 $64\\,\\mathrm{B}$，签名周期数 $6.0\\times 10^7$，验证周期数 $3.0\\times 10^7$，峰值 RAM $20\\,\\mathrm{KB}$，在正确实现下，故障行为可忽略不计。\n- Classic McEliece mceliece348864 (基于编码的 KEM，NIST 1级)：$S_{\\mathrm{pk}} = 261{,}120\\,\\mathrm{B}$，$S_{\\mathrm{ct}} = 128\\,\\mathrm{B}$，代码占用 $64\\,\\mathrm{KB}$，私钥 $649{,}000\\,\\mathrm{B}$，封装周期数 $2.0\\times 10^6$，解封装周期数 $2.5\\times 10^6$，峰值 RAM $16\\,\\mathrm{KB}$，在正确实现下，故障行为可忽略不计。\n\n假设握手过程如上所述，传输一个 KEM 公钥和一个 KEM 密文，以及两个签名和两个签名公钥（每方一个）。使用 $4\\,\\mathrm{KB}$ 的网络缓冲区和活动算法的峰值 RAM 来检查 RAM 约束。控制器必须将两个加密库、其私钥和典型的支持代码都放入闪存；对于本练习，假设非加密应用程序代码占用 $120\\,\\mathrm{KB}$ 的闪存，为加密代码和密钥留下 $136\\,\\mathrm{KB}$。\n\n构建一个决策矩阵，根据以下标准评估每个候选方案对：\n- 闪存使用：加密代码加上存储的私钥必须 $\\leq 136\\,\\mathrm{KB}$。\n- 峰值 RAM：算法峰值加上网络缓冲区必须 $\\leq 64\\,\\mathrm{KB}$。\n- 网络负载：总握手字节数 $B_{\\mathrm{total}}$。\n- 端到端时间：使用 $f = 120\\times 10^6\\,\\mathrm{Hz}$ 和 $R = 1\\times 10^6\\,\\mathrm{b/s}$ 计算的 CPU 和网络时间之和。\n- 故障行为：任何不可忽略的故障概率对于 CPS 控制都是不可接受的；否则可接受。\n\n基于此矩阵，哪个选项是该嵌入式控制器的最合适选择？\n\nA. 选择 ML-KEM-512 和 Dilithium-2；它们符合闪存和 RAM 的要求，在没有浮点单元的 $120\\,\\mathrm{MHz}$ 微控制器上产生中等的网络负载和较低的 CPU 周期数，并且解密/签名失败的概率可忽略不计，使其对于 CPS 操作是可靠的。\n\nB. 选择 ML-KEM-512 和 Falcon-512；由于签名和公钥较小，它们最小化了网络负载；在没有硬件浮点单元的情况下增加的周期数是可以接受的，因为计算可以与通信重叠。\n\nC. 选择 FrodoKEM-640 和 SPHINCS+-128s；它们完全避免了解密失败，并且基于哈希的签名易于实现，因此即使消息大小和周期数更高，为了鲁棒性也更可取。\n\nD. 选择 Classic McEliece mceliece348864 和 Dilithium-2；该 KEM 的密文非常小且解封装速度快，而 Dilithium-2 提供了强签名；大的公钥和私钥是可以接受的，因为它们在配置时只向闪存写入一次。",
            "solution": "该问题要求对四对候选的后量子密码 (PQC) 方案进行评估，这些方案用于信息物理系统 (CPS) 中的嵌入式控制器。评估必须基于一组定义的约束条件：闪存、RAM、网络负载、端到端握手时间以及故障概率。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取给定信息\n- **控制器约束：**\n    - 闪存：$256\\,\\mathrm{KB}$。\n    - RAM：$64\\,\\mathrm{KB}$。\n    - CPU：$32$ 位核心，频率 $f = 120\\,\\mathrm{MHz}$，无 FPU。\n- **资源分配：**\n    - 闪存中非加密应用程序代码：$120\\,\\mathrm{KB}$。\n    - 可用于加密的闪存（代码 + 密钥）：$F_{budget} = 256\\,\\mathrm{KB} - 120\\,\\mathrm{KB} = 136\\,\\mathrm{KB}$。\n    - RAM 中的网络缓冲区：$RAM_{net} = 4\\,\\mathrm{KB}$。\n    - 控制器必须存储其长期的 KEM 和签名私钥。\n- **网络：**\n    - 可靠链路，速率 $R = 1\\,\\mathrm{Mb/s} = 1 \\times 10^6\\,\\mathrm{b/s}$。\n- **握手协议与载荷：**\n    1. 控制器 $\\rightarrow$ 孪生体：KEM 公钥 ($S_{\\mathrm{pk}}$)。\n    2. 孪生体 $\\rightarrow$ 控制器：KEM 密文 ($S_{\\mathrm{ct}}$)。\n    3. 孪生体挑战控制器：孪生体发送 $32\\,\\mathrm{B}$ 随机数；控制器用其签名 ($S_{\\mathrm{sig}}$) 和签名公钥 ($S_{\\mathrm{spk}}$) 回应。\n    4. 控制器挑战孪生体：控制器发送 $32\\,\\mathrm{B}$ 随机数；孪生体用其签名 ($S_{\\mathrm{sig}}$) 和签名公钥 ($S_{\\mathrm{spk}}$) 回应。\n- **总网络字节数 ($B_{total}$):** 所有消息大小的总和：\n    $B_{total} = S_{\\mathrm{pk}} + S_{\\mathrm{ct}} + 2 \\times S_{\\mathrm{sig}} + 2 \\times S_{\\mathrm{spk}} + 64\\,\\mathrm{B}$。\n- **总 CPU 周期数 ($C_{total}$):** 握手是顺序执行的。控制器执行 KEM 解封装、签名和验证。孪生体执行 KEM 封装、签名和验证。影响延迟的总周期数是所有六个操作的周期数之和。\n    $C_{total} = C_{\\mathrm{encaps}} + C_{\\mathrm{decaps}} + 2 \\times C_{\\mathrm{sign}} + 2 \\times C_{\\mathrm{verify}}$。\n- **时间公式：**\n    - $t_{\\mathrm{CPU}} = C_{total} / f$\n    - $t_{\\mathrm{NET}} = 8B_{total} / R$\n    - $t_{\\mathrm{E2E}} = t_{\\mathrm{CPU}} + t_{\\mathrm{NET}}$\n- **候选方案数据：** 问题陈述中提供了 ML-KEM-512、Dilithium-2、Falcon-512、FrodoKEM-640、SPHINCS+-128s 和 Classic McEliece 的数据。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，使用了现实世界中的 PQC 候选方案和合理的性能数据。约束和评估指标是客观且明确的。握手协议虽然描述简洁，但在逻辑上与实现密钥建立和相互认证的目标一致。关于 Falcon-512 的 RAM 使用存在一个轻微的模糊之处（“峰值 RAM $32\\,\\mathrm{KB}$ 加上大的栈使用”），但这个定性警告已足够清晰，可以解释为在没有硬件浮点单元的设备上很可能无法满足 RAM 约束。因此，该问题被认为是有效且结构良好的，适用于进行定量工程权衡分析。\n\n### 步骤 3：结论与行动\n该问题是有效的。我现在将通过评估每个候选方案对来构建决策矩阵。\n\n---\n\n### 决策矩阵构建\n\n评估标准如下：\n1.  **闪存使用 ($F_{used}$):** 必须 $\\le F_{budget} = 136\\,\\mathrm{KB}$。$F_{used} = \\text{Code}_{\\text{KEM}} + \\text{Code}_{\\text{Sig}} + \\text{SK}_{\\text{KEM}} + \\text{SK}_{\\text{Sig}}$。\n2.  **峰值 RAM ($RAM_{peak}$):** 必须 $\\le 64\\,\\mathrm{KB}$。$RAM_{peak} = \\max(\\text{RAM}_{\\text{KEM}}, \\text{RAM}_{\\text{Sig}}) + RAM_{net}$。\n3.  **网络负载 ($B_{total}$):** 作为性能指标计算。\n4.  **端到端时间 ($t_{\\mathrm{E2E}}$):** 作为性能指标计算。\n5.  **故障行为：** 必须可忽略不计。\n\n**候选方案对 A：ML-KEM-512 和 Dilithium-2**\n-   **闪存：** $F_{used} = 32\\,\\mathrm{KB} (\\text{代码}) + 36\\,\\mathrm{KB} (\\text{代码}) + 2.4\\,\\mathrm{KB} (\\text{私钥}) + 2.5\\,\\mathrm{KB} (\\text{私钥}) = 72.9\\,\\mathrm{KB}$。\n    $72.9\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$。**通过**。\n-   **RAM：** $RAM_{peak} = \\max(12\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 24\\,\\mathrm{KB} + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$。\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$。**通过**。\n-   **网络：** $B_{total} = 800 + 768 + 2(2420) + 2(1312) + 64 = 1568 + 4840 + 2624 + 64 = 9096\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.8 + 2.0 + 2(1.5) + 2(0.9)) \\times 10^6 = (3.8 + 3.0 + 1.8) \\times 10^6 = 8.6 \\times 10^6$ 个周期。\n    $t_{\\mathrm{CPU}} = (8.6 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.0717\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 9096\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0728\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 0.0717 + 0.0728 = 0.1445\\,\\mathrm{s}$。\n-   **故障：** ML-KEM-512 的 DFP 小于 $2^{-128}$（可忽略不计）。Dilithium 的故障可忽略不计。**通过**。\n-   **结论：** **可行**。\n\n**候选方案对 B：ML-KEM-512 和 Falcon-512**\n-   **闪存：** $F_{used} = 32\\,\\mathrm{KB} + 60\\,\\mathrm{KB} + 2.4\\,\\mathrm{KB} + 2.3\\,\\mathrm{KB} = 96.7\\,\\mathrm{KB}$。\n    $96.7\\,\\mathrm{KB} \\le 136\\,\\mathrm{KB}$。**通过**。\n-   **RAM：** 问题陈述指出 Falcon-512 在没有硬件浮点单元的情况下，在其 $32\\,\\mathrm{KB}$ 的基础 RAM 之上还有“大的栈使用”。这一额外开销很可能导致总 RAM 使用量超过 $64\\,\\mathrm{KB}$ 的预算，因为软件浮点模拟和递归 FFT 计算的栈空间可能相当大（数十 KB）。因此，这对方案不满足 RAM 约束。**不通过**。\n-   **网络：** $B_{total} = 800 + 768 + 2(666) + 2(897) + 64 = 1568 + 1332 + 1794 + 64 = 4758\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.8 + 2.0 + 2(18) + 2(5.0)) \\times 10^6 = (3.8 + 36 + 10) \\times 10^6 = 49.8 \\times 10^6$ 个周期。\n    $t_{\\mathrm{CPU}} = (49.8 \\times 10^6) / (120 \\times 10^6\\,\\mathrm{Hz}) \\approx 0.415\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 4758\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.0381\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 0.415 + 0.0381 = 0.4531\\,\\mathrm{s}$。\n-   **故障：** 可忽略不计。**通过**。\n-   **结论：** **不可行**（不满足 RAM 约束）。\n\n**候选方案对 C：FrodoKEM-640 和 SPHINCS+-128s**\n-   **闪存：** $F_{used} = 60\\,\\mathrm{KB} + 80\\,\\mathrm{KB} + 19\\,\\mathrm{KB} + 64\\,\\mathrm{B} = 159.064\\,\\mathrm{KB}$。\n    $159.064\\,\\mathrm{KB} > 136\\,\\mathrm{KB}$。**不通过**。\n-   **RAM：** $RAM_{peak} = \\max(\\approx 64\\,\\mathrm{KB}, 20\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} \\approx 68\\,\\mathrm{KB}$。\n    $\\approx 68\\,\\mathrm{KB} > 64\\,\\mathrm{KB}$。**不通过**。\n-   **网络：** $B_{total} = 9616 + 9720 + 2(7856) + 2(32) + 64 = 19336 + 15712 + 64 + 64 = 35176\\,\\mathrm{B}$。\n-   **时间：**\n    $C_{total} = (1.2 \\times 10^7 + 1.1 \\times 10^7 + 2(6.0 \\times 10^7) + 2(3.0 \\times 10^7)) = (2.3 + 12 + 6) \\times 10^7 = 20.3 \\times 10^7$ 个周期。\n    $t_{\\mathrm{CPU}} = (2.03 \\times 10^8) / (1.2 \\times 10^8\\,\\mathrm{Hz}) \\approx 1.692\\,\\mathrm{s}$。\n    $t_{\\mathrm{NET}} = (8 \\times 35176\\,\\mathrm{B}) / (1 \\times 10^6\\,\\mathrm{b/s}) \\approx 0.281\\,\\mathrm{s}$。\n    $t_{\\mathrm{E2E}} \\approx 1.692 + 0.281 = 1.973\\,\\mathrm{s}$。\n-   **故障：** 可忽略不计。**通过**。\n-   **结论：** **不可行**（不满足闪存和 RAM 约束）。\n\n**候选方案对 D：Classic McEliece mceliece348864 和 Dilithium-2**\n-   **闪存：** Classic McEliece 的私钥为 $SK = 649000\\,\\mathrm{B} = 649\\,\\mathrm{KB}$。仅此一项就超过了 $136\\,\\mathrm{KB}$ 的预算。**不通过**。\n-   **RAM：** $RAM_{peak} = \\max(16\\,\\mathrm{KB}, 24\\,\\mathrm{KB}) + 4\\,\\mathrm{KB} = 28\\,\\mathrm{KB}$。\n    $28\\,\\mathrm{KB} \\le 64\\,\\mathrm{KB}$。**通过**。\n-   **网络：** Classic McEliece 的公钥为 $S_{\\mathrm{pk}} = 261120\\,\\mathrm{B}$。\n    $B_{total} = 261120 + 128 + 2(2420) + 2(1312) + 64 = 261120 + 128 + 4840 + 2624 + 64 = 268776\\,\\mathrm{B}$。\n-   **时间：** 仅公钥的网络传输时间为 $t_{\\mathrm{NET, pk}} = (8 \\times 261120) / 10^6 \\approx 2.09\\,\\mathrm{s}$。这使得握手过程极其缓慢，主要由网络部分主导。\n-   **故障：** 可忽略不计。**通过**。\n-   **结论：** **不可行**（不满足闪存约束，且由于巨大的公钥导致性能不可接受）。\n\n### 逐项分析选项\n\n**A. 选择 ML-KEM-512 和 Dilithium-2；它们符合闪存和 RAM 的要求，在没有浮点单元的 $120\\,\\mathrm{MHz}$ 微控制器上产生中等的网络负载和较低的 CPU 周期数，并且解密/签名失败的概率可忽略不计，使其对于 CPS 操作是可靠的。**\n该陈述与分析完全一致。这个组合是唯一一个满足所有指定硬件约束（闪存和 RAM）的。其性能（$B_{total} = 9096\\,\\mathrm{B}$，$t_{\\mathrm{E2E}} \\approx 0.145\\,\\mathrm{s}$）对于嵌入式系统是合理的。故障属性是可接受的。\n**结论：正确。**\n\n**B. 选择 ML-KEM-512 和 Falcon-512；由于签名和公钥较小，它们最小化了网络负载；在没有硬件浮点单元的情况下增加的周期数是可以接受的，因为计算可以与通信重叠。**\n这个选项有两个错误的论断。首先，它忽略了关于 Falcon-512 在无 FPU 核心上“大的栈使用”的关键警告，这使其因 RAM 约束而失效。其次，它声称计算可以先验地与通信重叠，这对于指定的顺序握手协议是错误的。总延迟是顺序计算和通信延迟的总和。\n**结论：不正确。**\n\n**C. 选择 FrodoKEM-640 和 SPHINCS+-128s；它们完全避免了解密失败，并且基于哈希的签名易于实现，因此即使消息大小和周期数更高，为了鲁棒性也更可取。**\n这个选项是不正确的。该组合在闪存和 RAM 约束上都大幅超标。“完全避免失败”的说法相较于 ML-KEM 的密码学上可忽略的失败率并没有显著优势。“更高”的消息大小和周期数导致了不可接受的高网络负载和接近 $2$ 秒的握手时间。\n**结论：不正确。**\n\n**D. 选择 Classic McEliece mceliece348864 和 Dilithium-2；该 KEM 的密文非常小且解封装速度快，而 Dilithium-2 提供了强签名；大的公钥和私钥是可以接受的，因为它们在配置时只向闪存写入一次。**\n这个选项有根本性缺陷。“大的公钥和私钥是可以接受的”这一说法是错误的。$649\\,\\mathrm{KB}$ 的私钥远大于可用的 $136\\,\\mathrm{KB}$ 闪存。超过 $261\\,\\mathrm{KB}$ 的公钥仅传输就需要超过 $2$ 秒钟，这使得握手对于大多数 CPS 应用来说慢得令人无法接受。\n**结论：不正确。**\n\n基于此全面分析，只有选项 A 提出了一个可行且合适的解决方案。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}