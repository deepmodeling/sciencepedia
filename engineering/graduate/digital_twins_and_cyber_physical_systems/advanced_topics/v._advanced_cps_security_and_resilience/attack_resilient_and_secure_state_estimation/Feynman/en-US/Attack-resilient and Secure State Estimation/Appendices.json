{
    "hands_on_practices": [
        {
            "introduction": "The first step toward designing a secure estimation system is to understand its fundamental vulnerabilities. This exercise explores the concept of observability, which determines whether a system's internal state can be fully reconstructed from its external outputs. By analyzing how observability is affected by the loss of a sensor , you will practice a critical skill in assessing the structural resilience of a cyber-physical system against sensor attacks or failures.",
            "id": "4206581",
            "problem": "A digital twin (DT) of a linear time-invariant cyber-physical system (CPS) is used for secure monitoring. The DT employs a state-space model with state update and output equations given by $x_{k+1} = A x_k$ and $y_k = C x_k$, where $x_k \\in \\mathbb{R}^n$ and $y_k \\in \\mathbb{R}^m$. The DT is tasked with attack-resilient state estimation under sensor failures or adversarial removals. Observability is assessed via the rank condition on the observability matrix constructed from the measurement matrix.\n\nConsider a three-state DT model with\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix},\n\\quad\nC = \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix},\n$$\nwhere the three rows of $C$ correspond to three distinct sensors. Suppose a coordinated attack removes the sensor subset $S = \\{3\\}$, meaning the third row of $C$ is unavailable to the estimator. Let $C_{-S}$ denote the measurement matrix obtained by removing the rows of $C$ indexed by $S$. The modified observability matrix is defined as\n$$\n\\mathcal{O}_{-S} = \\begin{pmatrix}\nC_{-S} \\\\\nC_{-S} A \\\\\nC_{-S} A^2\n\\end{pmatrix}.\n$$\n\nUsing only fundamental definitions of observability for linear time-invariant systems, compute the rank of $\\mathcal{O}_{-S}$ and determine whether the pair $(A, C_{-S})$ is observable. Express your final answer as the single integer equal to $\\mathrm{rank}(\\mathcal{O}_{-S})$. No rounding is required. Interpret the result in terms of resilience to the removal of sensor subset $S$ in your reasoning, but the final answer must be only the rank value.",
            "solution": "The problem asks for the rank of the observability matrix for a linear time-invariant (LTI) system after an attack removes one of its sensors. The system is defined by the state-space model $x_{k+1} = A x_k$ and $y_k = C x_k$, where the state vector is $x_k \\in \\mathbb{R}^n$ with $n=3$.\n\nThe given matrices are:\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix},\n\\quad\nC = \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n$$\n\nAn attack removes the sensor subset $S = \\{3\\}$, which corresponds to the third row of the measurement matrix $C$. The resulting measurement matrix, denoted $C_{-S}$, is obtained by removing the third row from $C$:\n$$\nC_{-S} = \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1\n\\end{pmatrix}\n$$\n\nThe problem requires us to determine the observability of the pair $(A, C_{-S})$. For an LTI system with state dimension $n$, observability is determined by the rank of the observability matrix. For a system with $n=3$, the observability matrix is constructed as:\n$$\n\\mathcal{O}_{-S} = \\begin{pmatrix}\nC_{-S} \\\\\nC_{-S} A \\\\\nC_{-S} A^2\n\\end{pmatrix}\n$$\nThe system is observable if and only if $\\mathrm{rank}(\\mathcal{O}_{-S}) = n = 3$.\n\nFirst, we compute the matrix products $C_{-S}A$ and $C_{-S}A^2$. The matrix $A$ is diagonal, which simplifies calculations of its powers:\n$$\nA^2 = A \\cdot A = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n= \\begin{pmatrix}\n0^2 & 0 & 0 \\\\\n0 & 1^2 & 0 \\\\\n0 & 0 & 2^2\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}\n$$\n\nNow we compute $C_{-S}A$:\n$$\nC_{-S}A = \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n= \\begin{pmatrix}\n(1\\cdot 0 + 0\\cdot 0 + 1\\cdot 0) & (1\\cdot 0 + 0\\cdot 1 + 1\\cdot 0) & (1\\cdot 0 + 0\\cdot 0 + 1\\cdot 2) \\\\\n(0\\cdot 0 + 1\\cdot 0 + 1\\cdot 0) & (0\\cdot 0 + 1\\cdot 1 + 1\\cdot 0) & (0\\cdot 0 + 1\\cdot 0 + 1\\cdot 2)\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0 & 2 \\\\\n0 & 1 & 2\n\\end{pmatrix}\n$$\n\nNext, we compute $C_{-S}A^2$:\n$$\nC_{-S}A^2 = \\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n(1\\cdot 0 + 0\\cdot 0 + 1\\cdot 0) & (1\\cdot 0 + 0\\cdot 1 + 1\\cdot 0) & (1\\cdot 0 + 0\\cdot 0 + 1\\cdot 4) \\\\\n(0\\cdot 0 + 1\\cdot 0 + 1\\cdot 0) & (0\\cdot 0 + 1\\cdot 1 + 1\\cdot 0) & (0\\cdot 0 + 1\\cdot 0 + 1\\cdot 4)\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0 & 4 \\\\\n0 & 1 & 4\n\\end{pmatrix}\n$$\n\nNow we assemble the observability matrix $\\mathcal{O}_{-S}$ by stacking these matrices:\n$$\n\\mathcal{O}_{-S} = \\begin{pmatrix}\nC_{-S} \\\\\nC_{-S} A \\\\\nC_{-S} A^2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 2 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 4 \\\\\n0 & 1 & 4\n\\end{pmatrix}\n$$\nThis is a $6 \\times 3$ matrix. To find its rank, we can use Gaussian elimination to find the number of linearly independent rows. Let $R_i$ denote the $i$-th row.\n$$\n\\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 2 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 4 \\\\\n0 & 1 & 4\n\\end{pmatrix}\n\\xrightarrow[R_6 \\to R_6 - R_2]{R_4 \\to R_4 - R_2}\n\\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 2 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 4 \\\\\n0 & 0 & 3\n\\end{pmatrix}\n$$\nTo simplify further, we can swap $R_3$ and $R_4$ to get a pivot of $1$ in the third row.\n$$\n\\xrightarrow{R_3 \\leftrightarrow R_4}\n\\begin{pmatrix}\n1 & 0 & 1 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 2 \\\\\n0 & 0 & 4 \\\\\n0 & 0 & 3\n\\end{pmatrix}\n$$\nNow, we use the new $R_3$ to eliminate the other non-zero entries in the third column.\n$$\n\\xrightarrow[R_6 \\to R_6 - 3R_3]{R_1 \\to R_1 - R_3, R_2 \\to R_2 - R_3, R_4 \\to R_4 - 2R_3, R_5 \\to R_5 - 4R_3}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThis is the reduced row echelon form of $\\mathcal{O}_{-S}$. The matrix has three non-zero rows, which means it has three pivot elements. The rank of a matrix is equal to the number of its pivot elements. Therefore, the rank of $\\mathcal{O}_{-S}$ is $3$.\n$$\n\\mathrm{rank}(\\mathcal{O}_{-S}) = 3\n$$\nThe state dimension is $n=3$. Since $\\mathrm{rank}(\\mathcal{O}_{-S}) = 3 = n$, the pair $(A, C_{-S})$ is observable.\n\nThis result implies that even after the attack removes sensor $3$, the system state can still be uniquely determined from the measurements of the remaining sensors ($1$ and $2$). The system is resilient to the removal of this specific sensor. The information provided by sensor $3$ was redundant for state estimation, given the system dynamics and the other two sensors.\n\nThe problem asks for the single integer value of the rank.",
            "answer": "$$ \\boxed{3} $$"
        },
        {
            "introduction": "To effectively defend a system, one must understand the attacker's strategy. This practice challenges you to step into the role of an adversary, designing a \"stealthy\" attack sequence that achieves a desired objective while evading detection. Solving this constrained optimization problem  provides deep insight into how attackers can exploit system dynamics and a filter’s memory to manipulate a digital twin with minimal energy.",
            "id": "4206615",
            "problem": "A Digital Twin (DT) of a single-input single-output Cyber-Physical System (CPS) is monitored by a steady-state Kalman Filter (KF)–based innovation detector. The physical process and measurement channel are modeled as the discrete-time linear system\n$$\nx_{k+1} = a\\,x_k,\\qquad y_k = c\\,x_k + a_k,\n$$\nwhere $x_k \\in \\mathbb{R}$ is the system state, $y_k \\in \\mathbb{R}$ is the measurement, and $a_k \\in \\mathbb{R}$ is an additive falsified measurement injected by an adversary at time $k$. The DT’s estimator uses the standard predict-update recursion\n$$\n\\hat{x}_{k\\mid k-1} = a\\,\\hat{x}_{k-1\\mid k-1},\\qquad r_k = y_k - c\\,\\hat{x}_{k\\mid k-1},\\qquad \\hat{x}_{k\\mid k} = \\hat{x}_{k\\mid k-1} + k\\,r_k,\n$$\nwhere $r_k \\in \\mathbb{R}$ is the innovation (residual) and $k \\in \\mathbb{R}$ is the constant Kalman gain. The detector declares an alarm if $|r_k| > \\gamma$, and a sequence $\\{a_k\\}$ is called stealthy if $|r_k| \\leq \\gamma$ for all enforced times.\n\nAssume: no process or measurement noise, exact initial synchronization $e_{0\\mid 0} \\triangleq x_0 - \\hat{x}_{0\\mid 0} = 0$, and a two-step attack horizon $k=1,2$. The adversary seeks to minimally perturb the measurements to bias the DT’s final estimate by a prescribed amount $\\delta$ at $k=2$ while remaining stealthy, i.e., to solve\n$$\n\\min_{a_1,a_2}\\; a_1^2 + a_2^2\n$$\nsubject to the residual constraints $|r_1| \\leq \\gamma$ and $|r_2| \\leq \\gamma$, and the terminal estimation error constraint $e_{2\\mid 2} = \\delta$, where $e_{k\\mid k} \\triangleq x_k - \\hat{x}_{k\\mid k}$.\n\nGiven parameters\n$$\na = 1,\\quad c = 1,\\quad k = \\tfrac{1}{2},\\quad \\gamma = 0.25,\\quad \\delta = 0.20,\n$$\nperform the following:\n\n1. Starting from the estimator recursion and the definition of $r_k$ and $e_{k\\mid k}$, derive explicit expressions for $r_1$, $r_2$, and $e_{2\\mid 2}$ in terms of $a_1$ and $a_2$ under the stated assumptions.\n2. Formulate the constrained optimization problem using these expressions and solve for the minimal-energy stealthy attack sequence $(a_1,a_2)$.\n3. Compute the minimal attack energy $\\sum_{k=1}^{2} a_k^2$ and interpret the solution in terms of the filter’s sensitivity to multi-step measurement injections and the detector’s threshold.\n\nExpress the final minimal attack energy as a real number rounded to four significant figures. No physical units need to be reported for this quantity.",
            "solution": "The solution proceeds in three parts as requested by the problem statement.\n\nPart 1: Derivation of expressions for residuals and estimation error.\n\nWe are given a discrete-time linear system and a steady-state Kalman filter–based estimator. The system dynamics are $x_{k+1} = a\\,x_k$ and the measurement is $y_k = c\\,x_k + a_k$, where $a_k$ is the malicious data injection. The estimator's recursions are $\\hat{x}_{k\\mid k-1} = a\\,\\hat{x}_{k-1\\mid k-1}$, $r_k = y_k - c\\,\\hat{x}_{k\\mid k-1}$, and $\\hat{x}_{k\\mid k} = \\hat{x}_{k\\mid k-1} + k\\,r_k$. The estimation error is defined as $e_{k\\mid k} \\triangleq x_k - \\hat{x}_{k\\mid k}$ and the prediction error as $e_{k\\mid k-1} \\triangleq x_k - \\hat{x}_{k\\mid k-1}$. The initial condition is perfect synchronization, $e_{0\\mid 0} = x_0 - \\hat{x}_{0\\mid 0} = 0$. We assume no process or measurement noise.\n\nLet us derive the dynamics of the estimation error.\nThe prediction error propagates as:\n$$e_{k\\mid k-1} = x_k - \\hat{x}_{k\\mid k-1} = a\\,x_{k-1} - a\\,\\hat{x}_{k-1\\mid k-1} = a(x_{k-1} - \\hat{x}_{k-1\\mid k-1}) = a\\,e_{k-1\\mid k-1}$$\nThe estimation error evolves according to:\n$$e_{k\\mid k} = x_k - \\hat{x}_{k\\mid k} = x_k - (\\hat{x}_{k\\mid k-1} + k\\,r_k) = e_{k\\mid k-1} - k\\,r_k$$\nThe residual $r_k$ can be expressed in terms of the prediction error and the attack signal:\n$$r_k = y_k - c\\,\\hat{x}_{k\\mid k-1} = (c\\,x_k + a_k) - c\\,\\hat{x}_{k\\mid k-1} = c(x_k - \\hat{x}_{k\\mid k-1}) + a_k = c\\,e_{k\\mid k-1} + a_k$$\nSubstituting the expression for $r_k$ into the equation for $e_{k\\mid k}$:\n$$e_{k\\mid k} = e_{k\\mid k-1} - k(c\\,e_{k\\mid k-1} + a_k) = (1 - ck)e_{k\\mid k-1} - k\\,a_k$$\nCombining with the propagation of the prediction error, we obtain a single recurrence for the estimation error:\n$$e_{k\\mid k} = a(1 - ck)e_{k-1\\mid k-1} - k\\,a_k$$\nWe now use this framework to find the required expressions for the two-step attack horizon, $k=1,2$.\n\nFor $k=1$:\nThe prediction error is $e_{1\\mid 0} = a\\,e_{0\\mid 0} = a \\cdot 0 = 0$.\nThe residual $r_1$ is:\n$$r_1 = c\\,e_{1\\mid 0} + a_1 = c \\cdot 0 + a_1 = a_1$$\nThe estimation error $e_{1\\mid 1}$ is:\n$$e_{1\\mid 1} = (1 - ck)e_{1\\mid 0} - k\\,a_1 = (1-ck) \\cdot 0 - k\\,a_1 = -k\\,a_1$$\n\nFor $k=2$:\nThe prediction error is $e_{2\\mid 1} = a\\,e_{1\\mid 1} = a(-k\\,a_1) = -ak\\,a_1$.\nThe residual $r_2$ is:\n$$r_2 = c\\,e_{2\\mid 1} + a_2 = c(-ak\\,a_1) + a_2 = a_2 - ack\\,a_1$$\nThe estimation error $e_{2\\mid 2}$ is:\n$$e_{2\\mid 2} = (1 - ck)e_{2\\mid 1} - k\\,a_2 = (1 - ck)(-ak\\,a_1) - k\\,a_2 = -ak(1 - ck)a_1 - k\\,a_2$$\nThis can be written as $e_{2\\mid 2} = ak(ck - 1)a_1 - k\\,a_2$.\n\nSummary of derived expressions:\n1. $r_1 = a_1$\n2. $r_2 = a_2 - ack\\,a_1$\n3. $e_{2\\mid 2} = ak(ck - 1)a_1 - k\\,a_2$\n\nPart 2: Formulation and solution of the constrained optimization problem.\n\nWe substitute the given parameters $a = 1$, $c = 1$, $k = \\frac{1}{2}$, $\\gamma = 0.25$, and $\\delta = 0.20$ into the derived expressions.\nThe expressions for the residuals and the final error become:\n$r_1 = a_1$\n$r_2 = a_2 - (1)(1)(\\frac{1}{2})a_1 = a_2 - \\frac{1}{2}a_1$\n$e_{2\\mid 2} = (1)(\\frac{1}{2})((1)(\\frac{1}{2}) - 1)a_1 - \\frac{1}{2}a_2 = \\frac{1}{2}(-\\frac{1}{2})a_1 - \\frac{1}{2}a_2 = -\\frac{1}{4}a_1 - \\frac{1}{2}a_2$\n\nThe optimization problem is to find $(a_1, a_2)$ that solves:\n$$ \\min_{a_1,a_2} \\; J(a_1, a_2) = a_1^2 + a_2^2 $$\nsubject to the constraints:\n1. $|r_1| \\leq \\gamma \\implies |a_1| \\leq 0.25$\n2. $|r_2| \\leq \\gamma \\implies |a_2 - \\frac{1}{2}a_1| \\leq 0.25$\n3. $e_{2\\mid 2} = \\delta \\implies -\\frac{1}{4}a_1 - \\frac{1}{2}a_2 = 0.20$\n\nThe objective function $J(a_1, a_2)$ is the squared Euclidean distance of the attack vector $(a_1, a_2)$ from the origin. The problem is to find the point on the feasible set that is closest to the origin.\nFirst, we analyze the equality constraint, which defines a line in the $(a_1, a_2)$ plane:\n$$-\\frac{1}{4}a_1 - \\frac{1}{2}a_2 = 0.20 \\implies -a_1 - 2a_2 = 0.80 \\implies a_1 + 2a_2 = -0.80$$\nTo find the point on this line with the minimum norm (closest to the origin), we can project the origin onto the line. The vector from the origin to this point must be parallel to the line's normal vector, $\\mathbf{n} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$. Thus, the solution $(a_1, a_2)$ must be of the form $(\\lambda, 2\\lambda)$ for some scalar $\\lambda$. Substituting this into the line equation:\n$$ \\lambda + 2(2\\lambda) = -0.80 \\implies 5\\lambda = -0.80 \\implies \\lambda = -0.16 $$\nThis gives the unconstrained minimum point on the line:\n$$ (a_1^*, a_2^*) = (-0.16, -0.32) $$\nNow, we must verify if this point satisfies the stealthiness inequality constraints:\n1. $|a_1^*| = |-0.16| = 0.16$. Since $0.16 \\leq 0.25$, this constraint is satisfied.\n2. We check the residual $r_2$: $r_2^* = a_2^* - \\frac{1}{2}a_1^* = -0.32 - \\frac{1}{2}(-0.16) = -0.32 + 0.08 = -0.24$.\n   The constraint is $|r_2^*| = |-0.24| = 0.24$. Since $0.24 \\leq 0.25$, this constraint is also satisfied.\n\nSince the point on the line $e_{2\\mid 2}=\\delta$ closest to the origin also satisfies a priori the stealthiness constraints, it is the solution to the constrained optimization problem.\nThe optimal minimal-energy stealthy attack sequence is $(a_1, a_2) = (-0.16, -0.32)$.\n\nPart 3: Calculation of minimal attack energy and interpretation.\n\nThe minimal attack energy is the value of the objective function $J = a_1^2 + a_2^2$ at the optimal point:\n$$ E_{\\min} = (-0.16)^2 + (-0.32)^2 = 0.0256 + 0.1024 = 0.128 $$\nRounding to four significant figures, the minimal attack energy is $0.1280$.\n\nInterpretation: The solution reveals the attacker's optimal strategy for biasing the state estimate while evading detection. To achieve the target bias $\\delta = 0.20$ with minimum energy, the attacker must inject a sequence of small, coordinated measurement corruptions. The first injection $a_1 = -0.16$ is fully exposed in the residual $r_1$ but is small enough to remain below the detection threshold $\\gamma=0.25$. This initial attack corrupts the filter's state estimate $\\hat{x}_{1\\mid 1}$. The filter's own dynamics then propagate this error, creating a vulnerability at the next step. The second injection $a_2 = -0.32$ is chosen to partially cancel the propagated error in the residual $r_2 = -0.24$, keeping it just under the threshold, while compounding the error in the final state estimate $e_{2|2}$ to the desired value $\\delta$. This demonstrates that an attacker can exploit the filter's memory to distribute the impact of an attack over time, making it much harder to detect than a single, large-magnitude attack. The fact that the optimal residuals, $|r_1|=0.16$ and $|r_2|=0.24$, are close to the threshold $\\gamma=0.25$ indicates that the system is being stressed close to its detection capability to achieve the desired bias.",
            "answer": "$$\n\\boxed{0.1280}\n$$"
        },
        {
            "introduction": "This final practice shifts the perspective back to the defender, focusing on a practical technique to enhance estimator resilience. You will implement a covariance inflation strategy, a method that de-tunes a Kalman filter to make it less susceptible to measurement attacks. Through this coding exercise , you will quantitatively analyze the crucial trade-off between an estimator's sensitivity to measurements and its robustness against adversarial corruption.",
            "id": "4206552",
            "problem": "Consider a discrete-time Linear Time-Invariant (LTI) cyber-physical system with a Digital Twin (DT) estimator and measurement channel subject to bounded adversarial attacks. The plant evolves according to the equations\n$$\nx_{k+1} = A x_k + w_k, \\quad y_k = C x_k + v_k + a_k,\n$$\nwhere $x_k \\in \\mathbb{R}^n$ is the state at time $k$, $y_k \\in \\mathbb{R}^m$ is the measurement, $w_k \\in \\mathbb{R}^n$ is the process noise, $v_k \\in \\mathbb{R}^m$ is the measurement noise, and $a_k \\in \\mathbb{R}^m$ is a bounded adversarial attack injected into the measurement channel. Assume the Euclidean norm bounds $\\|a_k\\|_2 \\le \\alpha$, $\\|w_k\\|_2 \\le \\beta$, and $\\|v_k\\|_2 \\le \\nu$ for all $k$.\n\nThe Digital Twin uses a steady-state Kalman Filter (KF) built from the Discrete Algebraic Riccati Equation (DARE) with covariance inflation on the measurement covariance. Specifically, given a nominal process covariance $Q$ and nominal measurement covariance $R_0$, the inflated measurement covariance is $R = \\gamma R_0$ for an inflation factor $\\gamma \\ge 1$. The steady-state KF gain $K$ is computed from the DARE solution for the dual system, and the estimation error dynamics (posterior error after measurement update) can be written in terms of the linear operator $F = (I - K C) A$.\n\nYour task is to implement a program that, for a fixed system $(A, C)$ and nominal covariances $(Q, R_0)$, computes for each test case $(\\gamma, \\alpha, \\beta, \\nu)$ the following three quantities:\n1. A heuristic upper bound $B$ on the worst-case posterior estimation error norm $\\sup_k \\|e_k\\|_2$ under bounded attacks and noises, derived using the induced $2$-norm and the linear error recursion. Use the bound\n$$\nB = \\frac{\\|K\\|_2 \\,\\alpha + \\|I - K C\\|_2 \\,\\beta + \\|K\\|_2 \\,\\nu}{1 - \\|F\\|_2},\n$$\nprovided that $\\|F\\|_2 < 1$. If $\\|F\\|_2 \\ge 1$, set $B$ to a floating-point infinity.\n2. A sensitivity proxy $S = \\|K\\|_2$ that quantifies how strongly the estimator reacts to measurement perturbations, including adversarial attacks.\n3. A robustness margin $M = 1 - \\|F\\|_2$ that quantifies how far the closed-loop error dynamics is from the instability threshold in the induced $2$-norm sense.\n\nUse the following fixed system and nominal covariances:\n- State dimension $n = 2$ and measurement dimension $m = 2$.\n- System matrices\n$$\nA = \\begin{bmatrix} 0.85 & 0.10 \\\\ 0.00 & 0.90 \\end{bmatrix}, \\quad\nC = \\begin{bmatrix} 1.00 & 0.00 \\\\ 0.00 & 1.00 \\end{bmatrix}.\n$$\n- Nominal covariances $Q = 0.01 I_2$ and $R_0 = 0.05 I_2$, where $I_2$ is the $2 \\times 2$ identity matrix.\n\nCompute the steady-state error covariance $P$ by solving the Discrete Algebraic Riccati Equation (DARE) for the dual estimation problem with $(A^T, C^T, Q, R)$ and then compute the steady-state gain\n$$\nK = P C^T (C P C^T + R)^{-1}.\n$$\nFrom $K$, compute $F = (I - K C) A$, and then compute $B$, $S$, and $M$ as defined above.\n\nTest Suite:\nUse the following list of test cases, each specified by $(\\gamma, \\alpha, \\beta, \\nu)$:\n- Case $1$: $(1.00, 0.10, 0.05, 0.05)$.\n- Case $2$: $(3.00, 0.10, 0.05, 0.05)$.\n- Case $3$: $(10.00, 0.20, 0.05, 0.10)$.\n- Case $4$: $(1.10, 0.05, 0.01, 0.01)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results aggregated over all test cases as a list of lists of three floats per test case. The output must have the exact format\n$$\n[\\,[B_1,S_1,M_1],\\,[B_2,S_2,M_2],\\,[B_3,S_3,M_3],\\,[B_4,S_4,M_4]\\,],\n$$\nwhere each $B_i$, $S_i$, and $M_i$ is a floating-point number computed from the corresponding test case parameters. No units are required because the problem is purely mathematical and dimensionless.",
            "solution": "The problem statement has been critically validated and is determined to be valid. It is scientifically grounded in linear systems theory and robust estimation, well-posed with all necessary information provided, and objective in its formulation. The task is to compute several performance and robustness metrics for a steady-state Kalman filter subjected to bounded adversarial attacks, based on a set of specified system and noise parameters.\n\nThe system under consideration is a discrete-time Linear Time-Invariant (LTI) plant described by the state-space equations:\n$$\nx_{k+1} = A x_k + w_k\n$$\n$$\ny_k = C x_k + v_k + a_k\n$$\nHere, $x_k \\in \\mathbb{R}^n$ is the state vector, $y_k \\in \\mathbb{R}^m$ is the measurement vector, $w_k \\in \\mathbb{R}^n$ is the process noise, $v_k \\in \\mathbb{R}^m$ is the measurement noise, and $a_k \\in \\mathbb{R}^m$ is an adversarial attack vector. The plant is defined by the matrices $A \\in \\mathbb{R}^{n \\times n}$ and $C \\in \\mathbb{R}^{m \\times n}$. The noises and attack are bounded in the Euclidean norm sense: $\\|w_k\\|_2 \\le \\beta$, $\\|v_k\\|_2 \\le \\nu$, and $\\|a_k\\|_2 \\le \\alpha$.\n\nA Digital Twin acts as an estimator, employing a steady-state Kalman filter. The filter design is based on the nominal process noise covariance $Q$ and an inflated measurement noise covariance $R = \\gamma R_0$, where $\\gamma \\ge 1$ is an inflation factor.\n\nThe computational procedure is as follows:\n\nFirst, we compute the steady-state posterior error covariance matrix $P \\in \\mathbb{R}^{n \\times n}$. This is the unique, symmetric, positive semi-definite solution to the Discrete Algebraic Riccati Equation (DARE) for estimation:\n$$\nP = A P A^T - A P C^T (C P C^T + R)^{-1} C P A^T + Q\n$$\nThe problem specifies using a solver for the dual control problem, which is standard practice. The control DARE solver typically finds the solution $X$ to $X = \\mathcal{A}^T X \\mathcal{A} - (\\mathcal{A}^T X \\mathcal{B})(\\mathcal{R} + \\mathcal{B}^T X \\mathcal{B})^{-1}(\\mathcal{B}^T X \\mathcal{A}) + \\mathcal{Q}$. By setting $\\mathcal{A} = A^T$, $\\mathcal{B} = C^T$, $\\mathcal{Q} = Q$, and $\\mathcal{R} = R$, the solver returns $P$ for the estimation DARE.\n\nSecond, with the computed covariance $P$, the steady-state Kalman gain $K \\in \\mathbb{R}^{n \\times m}$ is calculated as:\n$$\nK = P C^T (C P C^T + R)^{-1}\n$$\n\nThird, we analyze the dynamics of the posterior estimation error, $e_k = x_k - \\hat{x}_{k|k}$. The error propagation from time step $k-1$ to $k$ is given by the recursive relation:\n$$\ne_k = (I - K C)A e_{k-1} + (I - K C) w_{k-1} - K v_k - K a_k\n$$\nLet $F = (I - K C)A$ be the closed-loop error dynamics matrix. Applying the triangle inequality and properties of induced matrix norms to the error recursion yields:\n$$\n\\|e_k\\|_2 \\le \\|F\\|_2 \\|e_{k-1}\\|_2 + \\|I - K C\\|_2 \\|w_{k-1}\\|_2 + \\|K\\|_2 \\|v_k\\|_2 + \\|K\\|_2 \\|a_k\\|_2\n$$\nSubstituting the given bounds for the norms of the disturbances:\n$$\n\\|e_k\\|_2 \\le \\|F\\|_2 \\|e_{k-1}\\|_2 + \\|I - K C\\|_2 \\beta + \\|K\\|_2 \\nu + \\|K\\|_2 \\alpha\n$$\nFor the estimation error to remain bounded, the error dynamics must be stable, which requires that $\\|F\\|_2 < 1$. Under this condition, the supremum of the error norm, $\\sup_k \\|e_k\\|_2$, can be upper-bounded by finding the fixed point of this inequality. Let $B = \\sup_k \\|e_k\\|_2$, then in the worst-case steady state, we have:\n$$\nB \\le \\|F\\|_2 B + \\|I - K C\\|_2 \\beta + \\|K\\|_2 (\\alpha + \\nu)\n$$\nSolving for $B$ gives the heuristic upper bound on the worst-case posterior estimation error:\n$$\nB = \\frac{\\|K\\|_2 \\,\\alpha + \\|I - K C\\|_2 \\,\\beta + \\|K\\|_2 \\,\\nu}{1 - \\|F\\|_2}\n$$\nIf $\\|F\\|_2 \\ge 1$, the system is not guaranteed to be stable in this norm-based sense, and the error is considered unbounded, so we set $B$ to infinity.\n\nThe problem requires the computation of three metrics for each test case $(\\gamma, \\alpha, \\beta, \\nu)$:\n1.  The error bound $B$, as derived above. The induced $2$-norm (spectral norm) is used for all matrices.\n2.  The sensitivity proxy $S = \\|K\\|_2$. This metric quantifies the gain from measurement perturbations to the state estimate update, indicating sensitivity to both noise and attacks.\n3.  The robustness margin $M = 1 - \\|F\\|_2$. This metric quantifies the stability margin of the error dynamics. A larger positive value of $M$ indicates greater stability.\n\nThe fixed system parameters are $n=2$, $m=2$, with matrices:\n$$\nA = \\begin{bmatrix} 0.85 & 0.10 \\\\ 0.00 & 0.90 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1.00 & 0.00 \\\\ 0.00 & 1.00 \\end{bmatrix} = I_2\n$$\nand nominal covariances:\n$$\nQ = 0.01 I_2, \\quad R_0 = 0.05 I_2\n$$\nThe calculation will be performed for each supplied test case, and the results will be aggregated into the specified output format.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_discrete_are\n\ndef solve():\n    \"\"\"\n    Computes attack resilience metrics for a Kalman filter under different\n    covariance inflation scenarios.\n    \"\"\"\n    # Fixed system and nominal covariance matrices\n    A = np.array([[0.85, 0.10], [0.00, 0.90]])\n    C = np.array([[1.00, 0.00], [0.00, 1.00]])\n    Q = 0.01 * np.identity(2)\n    R0 = 0.05 * np.identity(2)\n    I = np.identity(2)\n\n    # Test cases: (gamma, alpha, beta, nu)\n    test_cases = [\n        (1.00, 0.10, 0.05, 0.05),\n        (3.00, 0.10, 0.05, 0.05),\n        (10.00, 0.20, 0.05, 0.10),\n        (1.10, 0.05, 0.01, 0.01),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        gamma, alpha, beta, nu = case\n\n        # 1. Calculate inflated measurement covariance R\n        R = gamma * R0\n\n        # 2. Solve the Discrete Algebraic Riccati Equation (DARE) for P.\n        # We solve the DARE for the dual control problem (A.T, C.T, Q, R)\n        # to get the filtering error covariance P.\n        try:\n            P = solve_discrete_are(A.T, C.T, Q, R)\n        except np.linalg.LinAlgError:\n            # Handle cases where the DARE solver might fail, though unlikely here\n            results.append([np.inf, np.nan, np.nan])\n            continue\n\n        # 3. Compute steady-state Kalman gain K\n        K_denominator = C @ P @ C.T + R\n        K = P @ C.T @ np.linalg.inv(K_denominator)\n\n        # 4. Compute error dynamics matrix F\n        F = (I - K @ C) @ A\n\n        # 5. Compute relevant matrix 2-norms (spectral norms)\n        norm_K = np.linalg.norm(K, ord=2)\n        norm_IKC = np.linalg.norm(I - K @ C, ord=2)\n        norm_F = np.linalg.norm(F, ord=2)\n\n        # 6. Calculate the three required quantities: B, S, M\n        \n        # Sensitivity proxy S\n        S = norm_K\n        \n        # Robustness margin M\n        M = 1.0 - norm_F\n\n        # Heuristic error bound B\n        if norm_F < 1.0:\n            numerator = norm_K * alpha + norm_IKC * beta + norm_K * nu\n            denominator = 1.0 - norm_F\n            B = numerator / denominator\n        else:\n            B = np.inf\n\n        results.append([B, S, M])\n\n    # Format the final output string exactly as specified.\n    # e.g., [[val1,val2,val3],[val4,val5,val6]] with no extra spaces.\n    case_strings = [f\"[{b},{s},{m}]\" for b, s, m in results]\n    output_string = f\"[{','.join(case_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}