{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您实践一种基础的运行时保障（RA）方法——Simplex架构。该架构包含一个高性能但未经安全验证的先进控制器和一个简单但可证明安全的基线控制器。您将学习如何利用预测模型（例如数字孪生）来决定何时从先进控制器切换到安全控制器，以确保系统状态保持在预定义的安全区域内，从而掌握Simplex监控器的核心切换逻辑 。",
            "id": "4242281",
            "problem": "考虑一个信息物理系统 (CPS) 中的连续时间线性动力系统，其状态 $x \\in \\mathbb{R}^{2}$ 和控制输入 $u \\in \\mathbb{R}$ 遵循方程 $\\dot{x} = A x + B u$。安全集是多面体 $S = \\{ x \\in \\mathbb{R}^{2} : C x \\le d \\}$，其中 $C \\in \\mathbb{R}^{4 \\times 2}$ 和 $d \\in \\mathbb{R}^{4}$ 分别表示面法向量和界限。一个运行时保障 (RA) Simplex 监视器使用数字孪生模型进行预测性评估。为防范模型失配和执行延迟，监视器通过要求 $C (A x + B u) \\le d'$ 来收紧容许导数集，其中 $d' = d - m$，而 $m \\in \\mathbb{R}^{4}$ 是一个已知的正裕度向量。Simplex 架构在安全性可被认证时选择高级控制器 $u_{a}(x)$，否则切换到基准控制器 $u_{b}(x)$。基准控制器由最小范数纠正动作 $u_{b}$ 定义，该动作求解 $\\min \\| u \\|$ 且满足约束 $C (A x + B u) \\le d'$。\n\n从多面体安全集的前向不变性定义（要求沿每个面法向量的方向导数在边界上或边界附近不指向外部）出发，监视器使用在当前状态 $x$ 和高级控制 $u_{a}(x)$ 下评估的收紧约束 $C (A x + B u) \\le d'$ 执行单步前瞻检查。如果任何分量违反了收紧的界限，监视器将切换到基准控制器。\n\n设系统矩阵和安全集为\n$$\nA = \\begin{pmatrix}\n0  1 \\\\\n-2  -\\tfrac{1}{2}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1  0 \\\\\n-1  0 \\\\\n0  1 \\\\\n0  -1\n\\end{pmatrix}, \\quad\nd = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n因此 $S = \\{ x \\in \\mathbb{R}^{2} : |x_{1}| \\le 1, \\, |x_{2}| \\le 1 \\}$。假设已知裕度为\n$$\nm = \\begin{pmatrix}\n0.2 \\\\\n0.2 \\\\\n0.2 \\\\\n0.2\n\\end{pmatrix},\n$$\n使得 $d' = d - m = \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\end{pmatrix}$。高级控制器是\n$$\nu_{a}(x) = -3 x_{1} - x_{2},\n$$\n当前状态是\n$$\nx = \\begin{pmatrix}\n0.95 \\\\\n0.2\n\\end{pmatrix}.\n$$\n\n使用基于不变性的收紧 $C (A x + B u) \\le d'$ 和最小范数基准公式，确定 Simplex 监视器的切换决策 $s \\in \\{0,1\\}$，其中 $s = 1$ 表示切换到基准控制器，$s = 0$ 表示保持使用高级控制器。此外，计算满足 $C (A x + B u_{b}) \\le d'$ 的相应最小范数基准输入 $u_{b}$。\n\n将你的最终答案表示为一个按顺序包含 $s$ 和 $u_{b}$ 的行矩阵。无需四舍五入。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定、客观和完整。\n\n### 步骤1：提取已知条件\n- 系统动力学：$\\dot{x} = A x + B u$，其中 $x \\in \\mathbb{R}^{2}$ 且 $u \\in \\mathbb{R}$。\n- 系统矩阵：\n$$\nA = \\begin{pmatrix}\n0  1 \\\\\n-2  -\\frac{1}{2}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n$$\n- 安全集：$S = \\{ x \\in \\mathbb{R}^{2} : C x \\le d \\}$。\n- 安全集矩阵：\n$$\nC = \\begin{pmatrix}\n1  0 \\\\\n-1  0 \\\\\n0  1 \\\\\n0  -1\n\\end{pmatrix}, \\quad\nd = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}\n$$\n- 安全裕度：$m = \\begin{pmatrix} 0.2 \\\\ 0.2 \\\\ 0.2 \\\\ 0.2 \\end{pmatrix}$。\n- 收紧的安全界限：$d' = d - m$。\n- 收紧的不变性条件：$C (A x + B u) \\le d'$。\n- 高级控制器：$u_{a}(x) = -3 x_{1} - x_{2}$。\n- 基准控制器：$u_{b}$ 是求解 $\\min \\| u \\|$ 且满足约束 $C (A x + B u) \\le d'$ 的解。\n- 当前状态：$x = \\begin{pmatrix} 0.95 \\\\ 0.2 \\end{pmatrix}$。\n- 切换决策：$s \\in \\{0, 1\\}$，其中 $s=1$ 表示切换到基准控制器。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在控制理论和信息物理系统运行时保障领域具有科学依据，特别是使用了 Simplex 架构。多面体安全集、前向不变性和最小范数纠正控制等概念在该领域是标准的。该问题是适定的，提供了执行所需计算的所有必要矩阵、向量、状态值和控制器定义。语言精确客观，使用标准的数学形式体系。数据维度一致，没有明显的矛盾或不切实际的条件。该问题并非无关紧要，因为它需要执行一个标准但非显而易见的安全验证和控制综合程序。因此，该问题被认为是有效的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n任务包括两部分：\n1.  通过检查高级控制器 $u_{a}(x)$ 在当前状态 $x$ 下是否满足收紧的安全条件来确定切换决策 $s$。\n2.  如果需要切换，则计算满足该条件的最小范数基准控制器 $u_{b}$。\n\n首先，我们确定切换决策。Simplex 监视器检查来自高级控制器的控制输入 $u_{a}(x)$ 是否满足收紧的不变性条件 $C (A x + B u_{a}(x)) \\le d'$。如果此条件对所有分量都成立，则高级控制器被认证为安全，且 $s=0$。如果不等式的任何分量被违反，监视器必须切换到基准控制器，因此 $s=1$。\n\n我们已知当前状态 $x = \\begin{pmatrix} 0.95 \\\\ 0.2 \\end{pmatrix}$。\n为了精确起见，我们将状态和裕度表示为分数： $x = \\begin{pmatrix} \\frac{19}{20} \\\\ \\frac{1}{5} \\end{pmatrix}$ 和 $m = \\begin{pmatrix} \\frac{1}{5} \\\\ \\frac{1}{5} \\\\ \\frac{1}{5} \\\\ \\frac{1}{5} \\end{pmatrix}$。\n\n在状态 $x$ 下的高级控制输入 $u_{a}$ 是：\n$$\nu_{a}(x) = -3 x_1 - x_2 = -3 \\left(\\frac{19}{20}\\right) - \\frac{1}{5} = -\\frac{57}{20} - \\frac{4}{20} = -\\frac{61}{20}\n$$\n\n接下来，我们计算状态导数 $\\dot{x} = Ax + Bu_{a}(x)$：\n$$\nAx = \\begin{pmatrix} 0  1 \\\\ -2  -\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{19}{20} \\\\ \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -2(\\frac{19}{20}) - \\frac{1}{2}(\\frac{1}{5}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{19}{10} - \\frac{1}{10} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{20}{10} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -2 \\end{pmatrix}\n$$\n$$\nBu_{a}(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\left(-\\frac{61}{20}\\right) = \\begin{pmatrix} 0 \\\\ -\\frac{61}{20} \\end{pmatrix}\n$$\n$$\nAx + Bu_{a}(x) = \\begin{pmatrix} \\frac{1}{5} \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -\\frac{61}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{40}{20} - \\frac{61}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{101}{20} \\end{pmatrix}\n$$\n现在，我们通过左乘 $C$ 来评估安全条件：\n$$\nC(Ax + Bu_{a}(x)) = \\begin{pmatrix} 1  0 \\\\ -1  0 \\\\ 0  1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{101}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{1}{5} \\\\ -\\frac{101}{20} \\\\ \\frac{101}{20} \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ -0.2 \\\\ -5.05 \\\\ 5.05 \\end{pmatrix}\n$$\n收紧的界限向量是：\n$$\nd' = d - m = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0.2 \\\\ 0.2 \\\\ 0.2 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{4}{5} \\\\ \\frac{4}{5} \\\\ \\frac{4}{5} \\end{pmatrix}\n$$\n我们将 $C(Ax + Bu_{a}(x))$ 与 $d'$ 进行比较：\n1. $\\frac{1}{5} \\le \\frac{4}{5}$ (成立)\n2. $-\\frac{1}{5} \\le \\frac{4}{5}$ (成立)\n3. $-\\frac{101}{20} \\le \\frac{4}{5}$ (成立, 因为 $-\\frac{101}{20} = -5.05$ 且 $\\frac{4}{5} = 0.8$)\n4. $\\frac{101}{20} \\le \\frac{4}{5}$ (不成立, 因为 $\\frac{101}{20} = 5.05$ 且 $\\frac{4}{5} = 0.8$)\n\n由于第四个约束被违反，高级控制器对于下一步不被认为是安全的。监视器必须介入。因此，切换决策为 $s=1$。\n\n现在，我们计算基准控制输入 $u_{b}$。它被定义为以下优化问题的解：\n$$\n\\min_{u \\in \\mathbb{R}} \\|u\\| \\quad \\text{满足约束} \\quad C(Ax + Bu) \\le d'\n$$\n由于 $u$ 是一个标量，最小化 $\\|u\\|$ 等价于最小化 $|u|$，这又等价于最小化 $u^2$。问题在于找到满足约束且具有最小模的 $u$ 值。\n该约束可以展开为：\n$$\nCAx + CBu \\le d' \\implies CBu \\le d' - CAx\n$$\n我们计算常数向量 $CB$ 和 $d' - CAx$。\n$$\nCB = \\begin{pmatrix} 1  0 \\\\ -1  0 \\\\ 0  1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\n$$\nCAx = \\begin{pmatrix} 1  0 \\\\ -1  0 \\\\ 0  1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{1}{5} \\\\ -2 \\\\ 2 \\end{pmatrix}\n$$\n$$\nd' - CAx = \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{4}{5} \\\\ \\frac{4}{5} \\\\ \\frac{4}{5} \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{5} \\\\ -\\frac{1}{5} \\\\ -2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{5} \\\\ \\frac{5}{5} \\\\ \\frac{4}{5} + 2 \\\\ \\frac{4}{5} - 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{5} \\\\ 1 \\\\ \\frac{14}{5} \\\\ -\\frac{6}{5} \\end{pmatrix}\n$$\n约束 $CBu \\le d' - CAx$ 变为：\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -1 \\end{pmatrix} u \\le \\begin{pmatrix} \\frac{3}{5} \\\\ 1 \\\\ \\frac{14}{5} \\\\ -\\frac{6}{5} \\end{pmatrix}\n$$\n这得出了关于 $u$ 的一组不等式：\n1. $0 \\cdot u \\le \\frac{3}{5}$ (这是 $0 \\le \\frac{3}{5}$，它总是成立，并且对 $u$ 没有约束。)\n2. $0 \\cdot u \\le 1$ (总是成立，对 $u$ 没有约束。)\n3. $1 \\cdot u \\le \\frac{14}{5} \\implies u \\le \\frac{14}{5}$\n4. $-1 \\cdot u \\le -\\frac{6}{5} \\implies u \\ge \\frac{6}{5}$\n\n所以，$u$ 的可行集是闭区间 $\\left[\\frac{6}{5}, \\frac{14}{5}\\right]$。我们需要在这个区间内找到具有最小模的 $u$ 值。函数 $f(u) = |u|$ 在 $u=0$ 处取最小值。区间 $\\left[\\frac{6}{5}, \\frac{14}{5}\\right]$ (或 $[1.2, 2.8]$) 中离 $0$ 最近的点是左端点 $u = \\frac{6}{5}$。\n因此，最小范数基准控制输入是：\n$$\nu_{b} = \\frac{6}{5} = 1.2\n$$\n最终答案由切换决策 $s=1$ 和基准控制 $u_{b} = \\frac{6}{5}$ 组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  & \\frac{6}{5}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "与在不同控制器之间切换的Simplex方法不同，基于控制屏障函数（CBF）的安全滤波器提供了一种更现代且干扰更小的方法。这种方法通过对先进控制器的指令进行最小化的修改来确保安全。本练习将指导您从一个给定的CBF推导出安全约束，并构建一个二次规划（QP）问题，以计算出既能保证安全又最接近原始指令的控制输入 。",
            "id": "4242299",
            "problem": "考虑一个通过数字孪生实现的自主信息物理系统的运行时保障安全滤波器。该数字孪生提供了一个形式为 $\\dot{x} = f(x) + g(x)\\,u$ 的受控对象（plant）的标称状态空间模型，其中 $x \\in \\mathbb{R}^{2}$ 且 $u \\in \\mathbb{R}$。安全集由一个连续可微的控制屏障函数 (CBF) $h:\\mathbb{R}^{2}\\to\\mathbb{R}$ 指定，安全集为 $\\mathcal{C} = \\{x \\in \\mathbb{R}^{2} : h(x) \\ge 0\\}$。运行时保障监视器通过确保不等式 $L_{f}h(x) + L_{g}h(x)\\,u + \\alpha\\!\\left(h(x)\\right) \\ge 0$ 始终成立来强制实现 $\\mathcal{C}$ 的前向不变性，其中 $L_{f}h$ 和 $L_{g}h$ 表示李导数，$\\alpha(\\cdot)$ 是一个扩展$\\mathcal{K}$类函数。\n\n在每个时刻，给定来自高层自主堆栈的标称控制 $u_{n}(x)$，监视器通过求解二次规划 (QP) 来计算一个最小侵入性的安全控制：\n$$\nu^{\\star}(x) \\;=\\; \\arg\\min_{u \\in \\mathbb{R}} \\;\\|u - u_{n}(x)\\|^{2}\n$$\n该二次规划受 CBF 约束和执行器边界 $u \\in U$ 的限制，其中 $U$ 是一个闭区间。\n\n仅从上述定义以及李导数和扩展$\\mathcal{K}$类函数的标准性质出发，执行以下操作：\n\n$1.$ 对于具有以下特定形式的数字孪生模型：\n$$\nf(x) \\;=\\; \\begin{bmatrix} x_{2} \\\\ -\\lambda\\,x_{1} \\end{bmatrix}, \n\\quad\ng(x) \\;=\\; \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\n\\quad\nh(x) \\;=\\; x_{1} - p_{\\min},\n$$\n其中参数 $\\lambda > 0$ 和 $p_{\\min} \\in \\mathbb{R}$，且 $\\alpha(s) = \\gamma\\,s$（对于 $\\gamma > 0$），推导在一般状态 $x$ 下由 CBF 条件所隐含的关于 $u$ 的显式不等式约束。\n\n$2.$ 使用第 $1$ 部分的结果，将 QP 显式地写成一个带有线性不等式约束和箱形约束的标量优化问题，用 $x$、$\\gamma$ 和控制边界 $U = [u_{\\min}, u_{\\max}]$ 表示。\n\n$3.$ 求解此 QP 在状态\n$$\nx \\;=\\; \\begin{bmatrix} -0.05 \\\\ -0.02 \\end{bmatrix}\n$$\n下的一个数值实例，参数为 $p_{\\min} = 0$，$\\gamma = 4$，控制边界为 $U = [u_{\\min}, u_{\\max}] = [-0.10,\\, 0.25]$，标称控制为 $u_{n}(x) = 0.30$。将最优控制 $u^{\\star}(x)$ 的精确值以单个实数形式给出。不要四舍五入；以有理数或有限小数的形式给出精确值。",
            "solution": "首先将对问题的科学合理性、完整性和客观性进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- 系统动力学：$\\dot{x} = f(x) + g(x)\\,u$，其中 $x \\in \\mathbb{R}^{2}$ 且 $u \\in \\mathbb{R}$。\n- 安全集：$\\mathcal{C} = \\{x \\in \\mathbb{R}^{2} : h(x) \\ge 0\\}$，其中 $h:\\mathbb{R}^{2}\\to\\mathbb{R}$ 是一个连续可微的控制屏障函数 (CBF)。\n- 运行时保障条件：$L_{f}h(x) + L_{g}h(x)\\,u + \\alpha\\!\\left(h(x)\\right) \\ge 0$，其中 $L_{f}h$ 和 $L_{g}h$ 是李导数，$\\alpha(\\cdot)$ 是一个扩展$\\mathcal{K}$类函数。\n- 安全控制二次规划 (QP)：$u^{\\star}(x) \\;=\\; \\arg\\min_{u \\in \\mathbb{R}} \\;\\|u - u_{n}(x)\\|^{2}$，受 CBF 约束和执行器边界 $u \\in U$ 的限制。\n- 第 1 部分的特定模型：\n  - $f(x) \\;=\\; \\begin{bmatrix} x_{2} \\\\ -\\lambda\\,x_{1} \\end{bmatrix}$\n  - $g(x) \\;=\\; \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n  - $h(x) \\;=\\; x_{1} - p_{\\min}$\n  - 参数：$\\lambda > 0$, $p_{\\min} \\in \\mathbb{R}$\n  - $\\mathcal{K}$类函数：$\\alpha(s) = \\gamma\\,s$，其中 $\\gamma > 0$。\n- 第 2 部分的 QP 公式：\n  - 用 $x$、$\\gamma$ 和控制边界 $U = [u_{\\min}, u_{\\max}]$ 表示。\n- 第 3 部分的数值实例：\n  - 状态：$x \\;=\\; \\begin{bmatrix} -0.05 \\\\ -0.02 \\end{bmatrix}$\n  - 参数：$p_{\\min} = 0$, $\\gamma = 4$\n  - 控制边界：$U = [-0.10,\\, 0.25]$\n  - 标称控制：$u_{n}(x) = 0.30$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于控制屏障函数的完善理论，这是现代自主系统安全关键控制的基石。李导数、$\\mathcal{K}$类函数以及安全滤波器的 QP 公式的定义都是标准且正确的。该问题是已确立原则的直接应用。\n- **适定性**：该问题分为三个逻辑部分。第 1 部分是直接推导。第 2 部分要求构建一个 QP，这是一个标准的凸优化问题（在线性不等式定义的集合上最小化一个二次函数）。第 3 部分提供了此 QP 的一个具体数值实例。由于目标函数是严格凸的，且可行集是一个闭合的、非空的（如解中所证）凸集，因此存在唯一解。\n- **客观性**：该问题以精确的数学和工程术语陈述。所有组成部分都已定义，没有使用主观或模糊的语言。\n- **完整性与一致性**：为每个部分提供了所有必要的函数、参数和数值。已知条件中没有矛盾。\n- **其他缺陷**：该问题并非不切实际、不适定、微不足道或无法验证。它是在运行时保障和信息物理系统主题内的一个直接且相关的问题。\n\n**第 3 步：结论与行动**\n\n问题有效。将提供完整解答。\n\n### 解答\n\n**第 1 部分：CBF 不等式约束的推导**\n\nCBF 约束由以下不等式给出：\n$$\nL_{f}h(x) + L_{g}h(x)\\,u + \\alpha\\!\\left(h(x)\\right) \\ge 0\n$$\n为了使这个不等式显式化，我们必须计算 $h(x)$ 关于 $f(x)$ 和 $g(x)$ 的李导数。标量函数 $h$ 关于矢量场 $v$ 的李导数是 $L_{v}h(x) = \\nabla h(x) \\cdot v(x) = (\\nabla h(x))^{T} v(x)$。\n\n给定 CBF $h(x) = x_{1} - p_{\\min}$，其关于 $x = \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix}$ 的梯度是：\n$$\n\\nabla h(x) = \\begin{bmatrix} \\frac{\\partial h}{\\partial x_{1}} \\\\ \\frac{\\partial h}{\\partial x_{2}} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}\n$$\n现在，我们使用给定的 $f(x)$ 和 $g(x)$ 计算李导数：\n$$\nL_{f}h(x) = (\\nabla h(x))^{T} f(x) = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} x_{2} \\\\ -\\lambda\\,x_{1} \\end{bmatrix} = 1 \\cdot x_{2} + 0 \\cdot (-\\lambda\\,x_{1}) = x_{2}\n$$\n$$\nL_{g}h(x) = (\\nabla h(x))^{T} g(x) = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 1 \\cdot 1 + 0 \\cdot 0 = 1\n$$\n我们还已知 $\\alpha(s) = \\gamma s$，所以 $\\alpha(h(x)) = \\gamma h(x) = \\gamma(x_{1} - p_{\\min})$。\n\n将这些分量代回 CBF 不等式，得到：\n$$\nx_{2} + (1)u + \\gamma(x_{1} - p_{\\min}) \\ge 0\n$$\n这就是在状态 $x$ 下对控制输入 $u$ 的显式不等式约束。\n\n**第 2 部分：显式二次规划公式**\n\n运行时保障监视器求解以下 QP：\n$$\nu^{\\star}(x) \\;=\\; \\arg\\min_{u \\in \\mathbb{R}} \\;\\|u - u_{n}(x)\\|^{2}\n$$\n受 CBF 约束和执行器边界 $u \\in U = [u_{\\min}, u_{\\max}]$ 的限制。对于标量控制 $u$，最小化 $\\|u - u_{n}(x)\\|^{2}$ 等价于最小化 $(u - u_{n}(x))^{2}$。\n\n约束条件是：\n1. 在第 1 部分中推导出的 CBF 约束：$x_{2} + u + \\gamma(x_{1} - p_{\\min}) \\ge 0$。\n2. 执行器（箱形）约束：$u_{\\min} \\le u \\le u_{\\max}$。\n\n我们可以重写 CBF 约束以分离出 $u$：\n$$\nu \\ge -x_{2} - \\gamma(x_{1} - p_{\\min})\n$$\n因此，表示为带有线性不等式和箱形约束的标量优化问题的完整 QP 是：\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  (u - u_{n}(x))^{2} \\\\\n\\text{约束条件} \\quad  u \\ge -x_{2} - \\gamma x_{1} + \\gamma p_{\\min} \\\\\n\\quad  u_{\\min} \\le u \\le u_{\\max}\n\\end{aligned}\n$$\n该公式用状态 $x=\\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix}$、参数 $\\gamma$ 和 $p_{\\min}$、标称控制 $u_n(x)$ 以及控制边界 $u_{\\min}$、$u_{\\max}$ 表示。\n\n**第 3 部分：QP 的数值解**\n\n我们被给予以下数值：\n- 状态：$x = \\begin{bmatrix} -0.05 \\\\ -0.02 \\end{bmatrix}$，所以 $x_{1} = -0.05$ 且 $x_{2} = -0.02$。\n- 参数：$p_{\\min} = 0$ 和 $\\gamma = 4$。\n- 控制边界：$U = [-0.10,\\, 0.25]$，所以 $u_{\\min} = -0.10$ 且 $u_{\\max} = 0.25$。\n- 标称控制：$u_{n}(x) = 0.30$。\n\n首先，我们通过将这些值代入约束条件来确定 $u$ 的可行集。\n\nCBF 约束是：\n$$\nu \\ge -x_{2} - \\gamma x_{1} + \\gamma p_{\\min} \\\\\nu \\ge -(-0.02) - (4)(-0.05) + (4)(0) \\\\\nu \\ge 0.02 + 0.20 \\\\\nu \\ge 0.22\n$$\n执行器约束是：\n$$\n-0.10 \\le u \\le 0.25\n$$\n$u$ 的可行集是这些约束的交集：$u$ 必须同时满足 $u \\ge 0.22$ 和 $-0.10 \\le u \\le 0.25$。交集是闭区间 $[0.22, 0.25]$。\n\n优化问题是在区间 $[0.22, 0.25]$ 中找到使目标函数 $(u - 0.30)^{2}$ 最小化的 $u$ 值。这等同于在区间 $[0.22, 0.25]$ 中找到最接近标称控制值 $u_{n} = 0.30$ 的点。\n\n目标函数的无约束最小化点在 $u = 0.30$。该值位于可行区间 $[0.22, 0.25]$ 之外。目标函数是一个开口向上的抛物线，因此其值随着我们远离最小值点 $u=0.30$ 而增加。因此，区间上的最小值必须出现在最接近 $0.30$ 的边界点上。\n\n两个边界点是 $0.22$ 和 $0.25$。\n- 到左边界的距离是 $|0.22 - 0.30| = |-0.08| = 0.08$。\n- 到右边界的距离是 $|0.25 - 0.30| = |-0.05| = 0.05$。\n\n右边界 $u=0.25$ 更接近标称控制 $u_{n} = 0.30$。因此，QP 的解，即最小侵入性的安全控制，是：\n$$\nu^{\\star}(x) = 0.25\n$$\n这个值是一个有限小数，是一个精确的有理数。",
            "answer": "$$\n\\boxed{0.25}\n$$"
        },
        {
            "introduction": "理论上完美的算法如果无法在控制系统的实时约束下运行，则在实践中毫无价值。本练习将理论与现实世界的嵌入式计算限制联系起来，重点关注安全监控器的计算可行性。您将分析一个基于二次规划（QP）的安全屏蔽的计算复杂度，并确定在给定的处理器性能和时间预算下，该监控器能处理的最大问题维度，这是设计任何实时RA系统的关键一步 。",
            "id": "4242289",
            "problem": "一个基于投影的安全护盾被集成到信息物理自主系统的数字孪生的运行时保障架构中。该护盾在每个控制周期 $T$ 通过求解一个形式为 $\\min_{x \\in \\mathbb{R}^{n}} \\frac{1}{2} x^{\\top} H x + f^{\\top} x$ 且服从线性不等式约束的凸二次规划 (QP) 问题，来修改一个建议的控制输入 $u \\in \\mathbb{R}^{n}$，以确保状态和输入约束得到遵守。每个周期内可用于监视器的最坏情况执行时间 (WCET) 预算为 $T_{m}$。假设使用一个稠密原始-对偶内点法求解器，该求解器具有以下基于基础数值线性代数和控制理论的现实属性：\n- 每次内点法迭代需要构建和求解一个维度为 $n$ 的对称正定法方程组，该方程组通过对 Karush–Kuhn–Tucker (KKT) 条件进行舒尔补简化得到。\n- 每次迭代的主要计算工作是一个稠密的类 Cholesky 分解及相关的三角求解，其浮点运算 (FLOP) 次数上界为 $c n^{3}$，其中 $c  0$ 是一个由线性代数核心决定的常数。对于此平台和公式，取 $c = \\frac{10}{3}$。\n- 由于监视器的固定精度要求，达到可行性和最优性固定容差所需的迭代次数 $k$ 由一个小的常数限定；取 $k = 20$。\n- 处理器维持每秒 $S = 8 \\times 10^{9}$ 次浮点运算的吞吐量。\n- 控制循环周期为 $T = 10 \\ \\mathrm{ms}$，监视器的 WCET 预算为 $T_{m} = 2 \\ \\mathrm{ms}$。所有时间都必须以秒为单位处理和计算。\n\n从求解稠密线性系统的基本事实和内点法的结构出发，推导该护盾每个周期的计算复杂度（用 $n$ 和参数 $(c, k, S)$ 表示），然后确定最大整数维度 $n_{\\max}$，使得护盾的计算能在监视器的 WCET 预算 $T_{m}$ 内完成。将你的最终答案表示为精确整数 $n_{\\max}$，除了选择满足不等式约束的最大整数外，不需要进行舍入。在整个推理和计算过程中使用秒作为时间单位。",
            "solution": "首先将根据指定程序验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 该系统是一个带有基于投影的安全护盾的信息物理自主系统。\n- 该护盾修改一个控制输入 $u \\in \\mathbb{R}^{n}$。\n- 该护盾求解一个形式为 $\\min_{x \\in \\mathbb{R}^{n}} \\frac{1}{2} x^{\\top} H x + f^{\\top} x$ 且服从线性不等式约束的凸二次规划 (QP) 问题。\n- 求解器是一个稠密原始-对偶内点法求解器。\n- 每次迭代的主要计算工作是一个稠密的类 Cholesky 分解，其浮点运算 (FLOP) 次数上界为 $c n^{3}$。\n- 常数 $c$ 给定为 $c = \\frac{10}{3}$。\n- 迭代次数 $k$ 固定为 $k = 20$。\n- 处理器维持每秒 $S = 8 \\times 10^{9}$ FLOPs 的吞吐量。\n- 控制循环周期为 $T = 10 \\ \\mathrm{ms}$。\n- 监视器的最坏情况执行时间 (WCET) 预算为 $T_{m} = 2 \\ \\mathrm{ms}$。\n- 所有时间单位在计算中必须为秒。\n- 目标是找到最大整数维度 $n_{\\max}$，使得护盾的计算时间不超过 $T_{m}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题在控制理论和数值优化方面有充分依据。基于 QP 的安全护盾是自主系统运行时保障的标准技术。稠密内点法的计算模型以 $O(n^{3})$ 复杂度的矩阵分解为主，这是数值线性代数中的一个基本结果。给出的处理器速度和时序约束等参数对于当代高性能嵌入式控制应用是现实的。\n- **适定性：** 问题提供了明确的目标（求 $n_{\\max}$）和充分、一致的信息来建立一个可解的不等式。存在满足所推导不等式的最大整数，确保了解的唯一性和意义。\n- **客观性：** 问题陈述使用了精确的技术语言，没有主观或模棱两可的术语。\n- **完整性和一致性：** 所有必要的参数（$c, k, S, T_m$）都已提供。时间单位被指定为秒。约束是明确的。信息是自洽且无矛盾的。$T = 10 \\ \\mathrm{ms}$ 的存在与计算无关，但不会产生矛盾，因为 $T_m  T$ 是一个合乎逻辑的系统设计选择。\n\n### 步骤 3：结论和行动\n该问题被认为是**有效的**，因为它是科学合理的、适定的和客观的。将推导求解过程。\n\n### 解题推导\n问题要求找到最大控制维度 $n_{\\max}$，使得安全护盾的计算时间 $T_{\\text{exec}}$ 不超过分配的 WCET 预算 $T_m$。\n\n计算复杂度以浮点运算 (FLOPs) 的形式给出。\n内点法求解器单次迭代所需的 FLOPs 数量为 $c n^{3}$，其中 $n$ 是控制输入向量的维度。\n设 $F_{\\text{iter}}$ 为每次迭代的 FLOPs。\n$$F_{\\text{iter}}(n) = c n^{3}$$\n\n求解器执行固定的迭代次数 $k$。因此，求解 QP 所需的总 FLOPs 数量 $F_{\\text{total}}$ 为：\n$$F_{\\text{total}}(n) = k \\cdot F_{\\text{iter}}(n) = k c n^{3}$$\n\n处理器的已知吞吐量为每秒 $S$ FLOPs。执行时间 $T_{\\text{exec}}$ 是总 FLOPs 数量除以处理器的吞吐量：\n$$T_{\\text{exec}}(n) = \\frac{F_{\\text{total}}(n)}{S} = \\frac{k c n^{3}}{S}$$\n\n安全监视器必须在 WCET 预算 $T_m$ 内完成其计算。这对执行时间施加了以下约束：\n$$T_{\\text{exec}}(n) \\le T_m$$\n\n代入 $T_{\\text{exec}}(n)$ 的表达式，我们得到关于 $n$ 的不等式：\n$$\\frac{k c n^{3}}{S} \\le T_m$$\n\n为了找到最大可能维度 $n$，我们对该不等式求解 $n$：\n$$n^{3} \\le \\frac{T_m S}{k c}$$\n$$n \\le \\left( \\frac{T_m S}{k c} \\right)^{1/3}$$\n\n最大整数维度 $n_{\\max}$ 是满足此条件的最大整数。这可以通过对右侧表达式取底函数得到。\n$$n_{\\max} = \\left\\lfloor \\left( \\frac{T_m S}{k c} \\right)^{1/3} \\right\\rfloor$$\n\n现在，我们将给定的数值代入此表达式。首先，我们确保所有单位一致。时间预算 $T_m$ 以毫秒为单位给出，必须转换为秒。\n- $k = 20$\n- $c = \\frac{10}{3}$\n- $S = 8 \\times 10^{9} \\ \\mathrm{s}^{-1}$\n- $T_m = 2 \\ \\mathrm{ms} = 2 \\times 10^{-3} \\ \\mathrm{s}$\n\n我们来计算立方根内的值：\n$$\\frac{T_m S}{k c} = \\frac{(2 \\times 10^{-3}) \\times (8 \\times 10^{9})}{20 \\times \\frac{10}{3}}$$\n$$\\frac{T_m S}{k c} = \\frac{16 \\times 10^{6}}{\\frac{200}{3}} = \\frac{16 \\times 3 \\times 10^{6}}{200} = \\frac{48 \\times 10^{6}}{2 \\times 10^{2}} = 24 \\times 10^{4} = 240000$$\n\n现在，我们必须通过计算立方根来找到 $n_{\\max}$：\n$$n_{\\max} = \\left\\lfloor (240000)^{1/3} \\right\\rfloor$$\n\n为了找到该整数值，我们可以测试整数的立方：\n$60^{3} = 216000$\n$61^{3} = 226981$\n$62^{3} = 238328$\n$63^{3} = 250047$\n\n因为 $62^{3} = 238328 \\le 240000$ 且 $63^{3} = 250047  240000$，所以满足 $n^{3} \\le 240000$ 的最大整数 $n$ 是 $62$。\n\n因此，控制输入的最大整数维度是 $n_{\\max} = 62$。",
            "answer": "$$\\boxed{62}$$"
        }
    ]
}