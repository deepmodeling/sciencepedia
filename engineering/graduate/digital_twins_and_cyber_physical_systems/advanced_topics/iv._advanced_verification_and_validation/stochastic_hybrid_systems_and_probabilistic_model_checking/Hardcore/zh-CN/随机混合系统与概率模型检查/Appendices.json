{
    "hands_on_practices": [
        {
            "introduction": "本练习在连续随机逻辑 (CSL) 的抽象语言与连续时间马尔可夫链 (CTMC) 的具体行为之间架起了一座基础的桥梁。通过解决这个问题，你将看到一个形式化属性，特别是时间有界的“until”公式，如何可以直接从随机过程的第一性原理来理解和计算。这个实践表明，在这个简单但富有说明性的案例中，验证 $P_{\\ge p}[A \\ \\mathsf{U}^{\\le T} \\ B]$ 简化为计算系统首次跃迁的累积概率，而该跃迁由其指数分布的持有时间决定。",
            "id": "4248168",
            "problem": "一个信息物理系统的数字孪生被抽象为一个双模态随机混合模型，其模态切换由一个连续时间马尔可夫链 (CTMC) 捕获。该CTMC的状态空间为 $\\{0,1\\}$，其中 $0$ 表示标称工作模态，$1$ 表示维护模态。无穷小生成元矩阵为\n$$\nQ \\;=\\; \\begin{pmatrix}\n-\\lambda  \\lambda \\\\\n\\mu  -\\mu\n\\end{pmatrix},\n$$\n其中速率 $\\lambda  0$ 和 $\\mu  0$ 为固定值。设原子命题 $A$ 仅在状态 $0$ 下成立，原子命题 $B$ 仅在状态 $1$ 下成立。系统在时间 $0$ 时从状态 $0$ 开始。\n\n考虑连续随机逻辑 (CSL) 的时间有界until公式 $\\mathsf{P}_{\\geq p}\\big[A \\ \\mathsf{U}^{\\leq T}\\ B\\big]$，其固定时域 $T0$。该公式在CTMC上根据CSL的标准语义进行解释：沿着一条路径，如果存在一个时间 $t \\in [0,T]$，在该时间点状态满足 $B$，并且对于所有之前的时间 $\\tau \\in [0,t)$，状态都满足 $A$，则公式 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 成立。\n\n定义最小概率阈值 $p_{\\min}(T)$ 为所有使得状态 $0$ 满足 $\\mathsf{P}_{\\geq p}\\big[A \\ \\mathsf{U}^{\\leq T}\\ B\\big]$ 的 $p \\in [0,1]$ 的上确界。换句话说，$p_{\\min}(T)$ 是从状态 $0$ 开始，性质 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 被满足的精确概率，并且 $\\mathsf{P}_{\\geq p}\\big[A \\ \\mathsf{U}^{\\leq T}\\ B\\big]$ 在状态 $0$ 成立当且仅当 $p \\leq p_{\\min}(T)$。\n\n仅使用CTMC的第一性原理（指数驻留时间、Kolmogorov前向方程）和CSL时间有界until算子的形式语义，推导 $p_{\\min}(T)$ 关于 $\\lambda$、$\\mu$ 和 $T$ 的闭式解析表达式。以单个解析表达式的形式给出你的最终答案。不要对答案进行近似或四舍五入。",
            "solution": "本题要求推导 $p_{\\min}(T)$ 的闭式解析表达式。\n\n首先，我们必须验证问题陈述的有效性。\n该问题是在连续时间马尔可夫链 (CTMC) 和连续随机逻辑 (CSL) 的标准数学框架内提出的，这些是随机系统建模与验证的基石。\n给定条件如下：\n- 一个状态空间为 $\\{0, 1\\}$ 的CTMC。\n- 一个无穷小生成元矩阵 $Q = \\begin{pmatrix} -\\lambda  \\lambda \\\\ \\mu  -\\mu \\end{pmatrix}$，其中速率 $\\lambda  0$, $\\mu  0$。\n- 原子命题 $A$ 在状态 $0$ 为真，$B$ 在状态 $1$ 为真。\n- 初始条件：系统在时间 $t=0$ 时从状态 $0$ 开始。\n- 关注的CSL公式为 $\\mathsf{P}_{\\geq p}\\big[A \\ \\mathsf{U}^{\\leq T}\\ B\\big]$，固定时域 $T0$。\n待推导的量 $p_{\\min}(T)$ 被定义为从状态 $0$ 开始的路径满足性质 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 的精确概率。\n该问题具有科学依据、是良定的、客观的，并包含了推导唯一解所需的所有信息。不存在矛盾或歧义。该模型是双态系统的一个基本且广泛使用的表示。因此，该问题是有效的，我们可以继续进行求解。\n\n问题的核心是计算 $p_{\\min}(T)$，它表示在系统于时间 $t=0$ 从状态 $0$ 开始的条件下，路径性质 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 成立的概率。设CTMC在时间 $\\tau$ 的状态用 $X(\\tau)$ 表示。初始状态为 $X(0) = 0$。\n\n根据所提供的语义，对于一条路径，如果存在一个时间 $t \\in [0, T]$，使得在时间 $t$ 的状态满足 $B$，并且对于所有之前的时间 $\\tau \\in [0, t)$，状态都满足 $A$，则路径公式 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 成立。\n针对我们特定的CTMC：\n- 一个状态满足命题 $A$ 当且仅当该状态为 $0$。\n- 一个状态满足命题 $B$ 当且仅当该状态为 $1$。\n\n因此，对于一条从 $X(0)=0$ 开始的路径，公式 $A \\ \\mathsf{U}^{\\leq T}\\ B$ 成立，如果存在一个时间 $t \\in [0,T]$ 使得 $X(t)=1$，并且对于所有的 $\\tau \\in [0, t)$，我们有 $X(\\tau)=0$。这个条件描述了系统首次进入状态 $1$ 的事件发生在时间 $T$ 或之前。\n\n设 $\\tau_{0 \\to 1}$ 是表示从状态 $0$ 到状态 $1$ 的首次通过时间的随机变量。我们要计算的概率正是 $P(\\tau_{0 \\to 1} \\leq T)$。\n\n我们现在从CTMC的第一性原理来推导这个概率。CTMC在转换到另一状态之前在任何给定状态 $i$ 中所花费的时间称为驻留时间。这个驻留时间是一个指数分布的随机变量，其速率等于离开状态 $i$ 的总速率，由 $-Q_{ii}$ 给出。\n\n对于我们从状态 $0$ 开始的系统，在状态 $0$ 的驻留时间是一个指数随机变量，我们称之为 $S_0$，其速率为 $-Q_{00} = -(-\\lambda) = \\lambda$。\n在这个驻留时间 $S_0$ 之后，过程必须转换到另一个状态。从状态 $0$到状态 $1$ 的转移速率是 $Q_{01} = \\lambda$。由于状态 $1$ 是系统中唯一另一个状态，任何从状态 $0$ 的转移都必须是到状态 $1$。离开状态 $0$ 时转移到状态 $1$ 的概率是 $\\frac{Q_{01}}{-Q_{00}} = \\frac{\\lambda}{\\lambda} = 1$。\n\n因此，从状态 $0$ 到状态 $1$ 的首次通过时间 $\\tau_{0 \\to 1}$ 与在状态 $0$ 的首次驻留时间 $S_0$ 相同。我们有 $\\tau_{0 \\to 1} = S_0$，其中 $S_0 \\sim \\text{Exponential}(\\lambda)$。\n\n问题现在简化为计算概率 $P(S_0 \\leq T)$。对于速率为 $\\lambda$ 的指数随机变量，其累积分布函数 (CDF) 由 $F(t) = P(S_0 \\leq t) = 1 - \\exp(-\\lambda t)$ 给出，其中 $t \\geq 0$。\n\n在 $t=T$ 处评估此CDF，我们得到所求的概率：\n$$p_{\\min}(T) = P(S_0 \\leq T) = 1 - \\exp(-\\lambda T)$$\n\n值得注意的是，控制从状态 $1$ 返回到状态 $0$ 的转移速率 $\\mu$ 并未出现在最终的表达式中。这是CSL“until”算子 ($\\mathsf{U}$) 语义的直接结果。只要系统首次到达满足 $B$ 的状态（状态 $1$），并且在此之前一直处于满足 $A$ 的状态（状态 $0$），该性质即被满足。系统在首次到达状态 $1$ *之后* 的行为与该公式的真值无关。\n\n这个结果可以通过求解控制有界until性质的CSL模型检测问题的常微分方程组 (ODEs) 来严格证实。设 $p_i(t)$ 为从状态 $i$ 开始满足 $A \\ \\mathsf{U}^{\\leq t}\\ B$ 的概率。我们要求解 $p_0(T)$。\n- 对于起始状态 $i=1$（满足 $B$），性质在时间 $0$ 即被满足，因此对于所有 $t \\ge 0$，$p_1(t)=1$。\n- 对于起始状态 $i=0$（满足 $A$ 但不满足 $B$），其概率根据Kolmogorov后向方程演化：\n$$ \\frac{d p_0(t)}{dt} = \\sum_{j \\in \\{0,1\\}} Q_{0j} p_j(t) = Q_{00} p_0(t) + Q_{01} p_1(t) $$\n代入已知值 $Q_{00}=-\\lambda$，$Q_{01}=\\lambda$ 和 $p_1(t)=1$：\n$$ \\frac{d p_0(t)}{dt} = -\\lambda p_0(t) + \\lambda(1) $$\n这是一个一阶线性常微分方程：$\\frac{d p_0(t)}{dt} + \\lambda p_0(t) = \\lambda$。\n初始条件为 $p_0(0)=0$，因为从状态 $0$ 在时间 $0$ 内到达状态 $1$ 的概率为零。\n这个初值问题的解是 $p_0(t) = 1 - \\exp(-\\lambda t)$。\n在 $t=T$ 处求值得到 $p_0(T) = 1 - \\exp(-\\lambda T)$，这证实了我们从第一性原理推导出的结果。\n\n因此，$p_{\\min}(T)$ 的闭式解析表达式为 $1 - \\exp(-\\lambda T)$。",
            "answer": "$$\\boxed{1 - \\exp(-\\lambda T)}$$"
        },
        {
            "introduction": "形式化验证中的一项关键技能，是将非形式化的系统需求精确地转化为机器可检查的逻辑规约。本练习要求你为两个广泛应用的系统抽象（连续时间模型 CTMC 和离散时间模型 DTMC/MDP）形式化一个常见的安全需求。通过比较最终的 CSL 和 PCTL 公式，你将更深刻地理解在时间界限的解释以及如何处理来自控制策略或环境不确定性的非确定性方面，两者之间存在的微妙但至关重要的语义差异。",
            "id": "4248184",
            "problem": "一个电池包的信息物理热管理系统的数字孪生被建模为一个随机混成系统：连续温度根据与模式相关的微分方程演化，扰动模式之间的切换是服从指数分布的随机切换，而一个软件控制器每 $h$ 秒周期性地采样传感器读数，并根据一个策略驱动离散模式切换。考虑原子命题 $\\mathsf{unsafe}$，它表示温度违反安全阈值的状态集合。请您为两种验证抽象形式化非正式需求“在时间 $T$ 内进入不安全集合的概率小于 $p$”，并阐明其语义差异：\n\n- 通过连续时间马尔可夫链 (CTMC) 进行的连续时间抽象，使用连续随机逻辑 (CSL) 进行分析。\n- 通过离散时间马尔可夫链 (DTMC) 或步长为 $h$ 的马尔可夫决策过程 (MDP) 进行的时间采样的离散时间抽象，使用概率计算树逻辑 (PCTL) 进行分析。\n\n使用标准路径算子 $\\mathsf{F}$ (最终)、$\\mathsf{G}$ (全局) 和有界直到 $U^{\\leq \\cdot}$，以及概率算子 $P_{\\bowtie p}[\\cdot]$，其中比较符 $\\bowtie \\in \\{, \\leq, , \\geq\\}$。对于 MDP，$P^{\\max}$ 和 $P^{\\min}$ 对调度器进行量化。假设 $k = \\lceil T/h \\rceil$ 是持续时间至少为 $T$ 的最小整数控制步数。\n\n哪个选项给出了一对正确的公式（一个 CSL 公式和一个 PCTL 公式），它们在每种抽象中捕获了非正式需求，并正确解释了两种解释之间的关键语义差异？\n\nA. CSL: $P_{ p}\\big[\\,\\mathsf{F}^{\\leq T}\\,\\mathsf{unsafe}\\,\\big]$; PCTL: $P^{\\max}_{ p}\\big[\\,\\mathsf{F}^{\\leq k}\\,\\mathsf{unsafe}\\,\\big]$ 其中 $k=\\lceil T/h\\rceil$。解释：在 CTMC 上的 CSL 中，$\\mathsf{F}^{\\leq T}$ 覆盖所有逗留时间呈指数分布的实时路径；概率测度是针对连续时间的。在 DTMC 或 MDP 上的 PCTL 中，$\\mathsf{F}^{\\leq k}$ 计算的是离散步数而不是实时时间，因此界限是步数；对于 MDP，$P^{\\max}$ 考虑最坏情况的调度器，这与鲁棒的安全性解释相匹配。两种解释的不同之处在于，在 CTMC 语义中时间是连续的，而在 DTMC 或 MDP 语义中是离散步长的，并且非确定性要求在后者中使用极值概率。\n\nB. CSL: $P_{\\geq 1-p}\\big[\\,\\mathsf{G}^{\\leq T}\\,\\neg \\mathsf{unsafe}\\,\\big]$; PCTL: $P_{\\geq 1-p}\\big[\\,\\mathsf{G}^{\\leq k}\\,\\neg \\mathsf{unsafe}\\,\\big]$ 其中 $k=\\lceil T/h\\rceil$。解释：在时间界限内保持安全是进入不安全集合的补集，并且相同的比较运算符保持等价性；两种逻辑使用相同的有界时间全局安全性概念，非确定性不影响结果，因为安全性是全局的。\n\nC. CSL: $P_{ p}\\big[\\,\\mathsf{F}\\,\\mathsf{unsafe}\\,\\big]$; PCTL: $P^{\\min}_{ p}\\big[\\,\\mathsf{F}\\,\\mathsf{unsafe}\\,\\big]$。解释：不需要时间界限，因为最终性意味着“在某个时间”进入，并且在 PCTL 中使用 $P^{\\min}$ 确保了在非确定性下对风险的最保守估计。\n\nD. CSL: $P_{ p}\\big[\\,\\mathsf{true}\\ U^{\\leq T}\\ \\mathsf{unsafe}\\,\\big]$; PCTL: $P_{ p}\\big[\\,\\mathsf{true}\\ U^{\\leq T}\\ \\mathsf{unsafe}\\,\\big]$。解释：两种逻辑都接受具有实时界限 $T$ 的相同有界直到算子，因此应用相同的语法和语义；在 PCTL 中无需考虑调度器，因为在两种设置中时间都是实值的。\n\n选择唯一最佳选项。",
            "solution": "这是一个关于信息物理系统形式化验证的问题，具体涉及将一个非正式的安全需求转换为针对不同系统抽象的形式化逻辑规约。我将首先验证问题陈述，然后进行完整的求解。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **系统：** 一个电池包的信息物理热管理系统的数字孪生。\n*   **模型：** 一个随机混成系统。\n*   **连续动态：** 温度根据与模式相关的微分方程演化。\n*   **随机动态：** 扰动模式之间的随机切换遵循指数分布。\n*   **离散控制：** 一个软件控制器每 $h$ 秒采样一次传感器读数，并根据一个策略驱动离散模式切换。\n*   **原子命题：** $\\mathsf{unsafe}$ 表示温度违反安全阈值的状态集合。\n*   **非正式需求：** “在时间 $T$ 内进入不安全集合的概率小于 $p$”。\n*   **抽象 1 (连续时间)：** 一个连续时间马尔可夫链 (CTMC)，使用连续随机逻辑 (CSL) 进行分析。\n*   **抽象 2 (离散时间)：** 一个步长为 $h$ 的离散时间马尔可夫链 (DTMC) 或马尔可夫决策过程 (MDP)，使用概率计算树逻辑 (PCTL) 进行分析。\n*   **逻辑算子：** 路径算子 $\\mathsf{F}$ (最终)，$\\mathsf{G}$ (全局) 和有界直到 $U^{\\leq \\cdot}$。概率算子 $P_{\\bowtie p}[\\cdot]$，其中 $\\bowtie \\in \\{, \\leq, , \\geq\\}$。对于 MDP，路径量化器 $P^{\\max}$ 和 $P^{\\min}$ 被使用。\n*   **时间离散化：** $k = \\lceil T/h \\rceil$ 是与时间范围 $T$ 对应的控制步数。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据充分：** 该问题牢固地植根于已建立的信息物理和混成系统的形式化方法理论。CTMC、MDP、CSL 和 PCTL 是用于建模和验证的标准、定义明确的数学形式体系。将其应用于电池热管理系统是一个现实且关键的工程问题。描述是科学上合理的。\n2.  **问题定义明确：** 问题定义良好。它要求在两种不同的标准建模抽象（CTMC 和 DTMC/MDP）下，对一个清晰的非正式需求进行正确的形式化。目标是在相应的时序逻辑（CSL 和 PCTL）中确定正确的句法和语义表示。预计会存在一个基于这些逻辑语义的唯一正确答案。\n3.  **客观性：** 语言是技术性的、精确的和客观的。它使用了计算机科学和控制理论中的标准术语，没有歧义。\n4.  **完整且一致：** 问题提供了所有必要的信息。它定义了系统行为、抽象、目标属性、逻辑，以及连续时间 $T$ 和离散步数 $k$ 之间的关系。给定的条件内部是一致的。\n5.  **现实且可行：** 所描述的场景是将概率模型检测应用于安全关键系统的典型例子。提到的抽象是标准实践。\n6.  **定义不清或结构不良：** 问题结构清晰且合乎逻辑。它没有循环推理，术语在该领域的背景下定义良好。\n7.  **伪深刻、琐碎或同义反复：** 问题并非琐碎。它要求对连续时间和离散时间概率逻辑之间的语义差异有细致的理解，特别是在解释时间界限和处理 MDP 中的非确定性方面。\n8.  **超出科学可验证性范围：** 所提出的逻辑公式的正确性可以根据 CSL 和 PCTL 的形式化语义进行严格验证。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。这是形式化验证领域中一个定义明确的问题。我现在将进行求解推导和选项分析。\n\n### 求解推导\n\n非正式需求是“在时间 $T$ 内进入不安全集合的概率小于 $p$”。让我们为每个抽象形式化这个需求。\n\n**1. 针对 CTMC 抽象的 CSL 公式化**\n\nCTMC 模型在时间上是连续的。CSL 是用于规约 CTMC 属性的合适逻辑。\n- “进入不安全集合”事件对应于到达一个原子命题 $\\mathsf{unsafe}$ 为真的状态。\n- 表示“最终”或“到达”的时序算子是 $\\mathsf{F}$。\n- “在时间 $T$ 内”的约束要求一个时间有界算子。在 CSL 中，这表示为 $\\mathsf{F}^{\\leq T}$。因此，路径属性是 $\\mathsf{F}^{\\leq T}\\,\\mathsf{unsafe}$。这是 $\\mathsf{true}\\ U^{\\leq T}\\ \\mathsf{unsafe}$ 的标准语法糖，意味着一条路径停留在任何状态（$\\mathsf{true}$）直到它到达一个 $\\mathsf{unsafe}$ 状态，且经过的总时间最多为 $T$。\n- “概率...小于 $p$”的概率性需求由概率算子 $P_{ p}[\\cdot]$ 捕获。\n\n将它们组合在一起，正确的 CSL 公式是 $P_{ p}\\big[\\,\\mathsf{F}^{\\leq T}\\,\\mathsf{unsafe}\\,\\big]$。\n\n**2. 针对 DTMC/MDP 抽象的 PCTL 公式化**\n\n离散时间模型在离散的步长上演化。PCTL 是用于规约这些模型的逻辑。\n- “进入不安全集合”事件仍然由 $\\mathsf{unsafe}$ 捕获。\n- “最终”算子是 $\\mathsf{F}$。\n- “在时间 $T$ 内”现在必须用离散的步数来近似。控制器每 $h$ 秒采样一次，因此时间范围 $T$ 对应于 $k = \\lceil T/h \\rceil$ 个离散步长。因此，路径属性是 $\\mathsf{F}^{\\leq k}\\,\\mathsf{unsafe}$。\n- 由于存在由策略驱动的离散模式切换，该模型是一个 MDP，它引入了非确定性。控制器（或调度器）在每个状态选择一个动作。\n- 为了确保安全性，我们必须考虑最坏情况，即导致进入不安全状态概率最高的控制器策略。因此，我们必须使用最大概率路径量化器 $P^{\\max}$。\n- 结合概率界限，我们得到 $P^{\\max}_{ p}\\big[\\,\\mathsf{F}^{\\leq k}\\,\\mathsf{unsafe}\\,\\big]$。\n\n**3. 语义差异**\n\n- **时间语义：** CSL 公式在连续的实时时间内解释，捕获了在时间点 $T$ 之前的 *任何* 时刻发生的事件。PCTL 公式在离散的步长中解释，只能在采样点（$h, 2h, ..., kh$）检查状态。它无法捕获采样点之间发生的快速违规行为（所谓的“采样间行为”）。\n- **非确定性：** CTMC 模型是纯粹随机的；路径的概率测度是唯一的。MDP 模型包含非确定性（控制选择）和随机性。PCTL 公式必须使用路径量化器（如 $P^{\\max}$ 或 $P^{\\min}$）来解决非确定性，以对所有可能的调度器进行断言。对于安全性，我们关心最坏情况，因此使用 $P^{\\max}$。\n\n**4. 选项分析**\n\n- **A.** 提供了正确的 CSL 公式 $P_{ p}\\big[\\,\\mathsf{F}^{\\leq T}\\,\\mathsf{unsafe}\\,\\big]$ 和正确的 PCTL 公式 $P^{\\max}_{ p}\\big[\\,\\mathsf{F}^{\\leq k}\\,\\mathsf{unsafe}\\,\\big]$。其解释正确地强调了连续实时与离散步长之间的区别，以及在 MDP 中使用 $P^{\\max}$ 进行鲁棒安全性分析的必要性。**此选项看起来是正确的。**\n\n- **B.** 将问题错误地形式化为安全性（$\\mathsf{G}$) 而不是可达性 ($\\mathsf{F}$)。虽然 $P(\\text{reach unsafe})  p$ 等价于 $P(\\text{stay safe})  1-p$，但其解释“非确定性不影响结果”是错误的。对于 MDP，最小化保持安全的概率（即找到一个最差的调度器）与最大化到达不安全状态的概率是等价的，因此非确定性至关重要。\n\n- **C.** 使用了无界算子 $\\mathsf{F}$，这与“在时间 $T$ 内”的原始需求相矛盾。此外，它为 PCTL 公式使用了 $P^{\\min}$，这是不正确的；对于评估到达一个 *不安全* 区域的风险，我们关心的是最大概率（最坏情况），而不是最小概率。\n\n- **D.** CSL 公式是正确的（因为 $\\mathsf{F}^{\\leq T}\\,\\varphi$ 是 $\\mathsf{true}\\,U^{\\leq T}\\,\\varphi$ 的语法糖），但 PCTL 公式是错误的。PCTL 不支持实时界限（`U^{\\leq T}` 是无效语法）；它使用步数界限。此外，该解释错误地声称 PCTL 中无需考虑调度器。\n\n**结论**\n\n选项 A 是唯一一个为两种抽象提供了正确形式化，并准确解释了它们之间关键语义差异的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这最后一个实践提供了一个综合性练习，它融合了分析推导、计算实现和富有洞察力的结果解读。你的任务是对一个 CTMC 执行参数化模型检验，这需要你推导出一个 CSL 可达性属性的闭式解，并将其表示为系统速率参数的函数。这个问题不仅巩固了你求解 Kolmogorov 微分方程组的能力，还强调了编写数值稳定的代码以及理解系统参数如何定量影响可靠性和安全性的实际重要性。",
            "id": "4248146",
            "problem": "考虑一个三态连续时间马尔可夫链 (CTMC)，其状态集定义为 $\\{s_0, s_1, s_F\\}$，其中 $s_F$ 为吸收态。转移如下：从 $s_0$ 到 $s_1$ 的速率为 $a$（单位 $s^{-1}$），从 $s_0$ 到 $s_F$ 的速率为 $b$（单位 $s^{-1}$），以及从 $s_1$ 到 $s_F$ 的速率为 $c$（单位 $s^{-1}$）。无其他转移。初始状态为 $s_0$ 的概率为 $1$。设生成元矩阵为 $Q$，瞬态概率行向量为 $x(t)$，对于 $t \\ge 0$，该向量遵循 Kolmogorov 前向方程 $dx(t)/dt = x(t) Q$。吸收态 $s_F$ 代表失效。\n\n在连续随机逻辑 (CSL) 中，有界直到算子表示有界时间内的可达性。性质 $\\mathsf{P}=?\\,[\\,\\mathsf{true}\\,\\mathsf{U}^{\\le T}\\,s_F\\,]$ 询问的是过程在时间界限 $T$ 内到达 $s_F$ 的概率。对于此 CTMC，当 $s_F$ 为吸收态时，该概率等于在时刻 $T$ 处于 $s_F$ 的概率质量，记作 $x_F(T)$。\n\n仅从 CTMC 的核心定义和 Kolmogorov 前向方程出发，推导出一个关于 $x_F(T)$ 的显式闭式表达式，该表达式是参数 $a$、$b$、$c$ 和时间界限 $T$ 的函数。你的推导必须处理一般情况以及 $a + b = c$ 的退化情况。\n\n然后，实现一个程序，在给定特定参数集 $(a,b,c,T)$ 的情况下，计算 CSL 查询值 $\\mathsf{P}=?\\,[\\,\\mathsf{true}\\,\\mathsf{U}^{\\le T}\\,s_F\\,]$，该值等于 $x_F(T)$。速率 $a$、$b$ 和 $c$ 的单位为 $s^{-1}$，时间 $T$ 的单位为秒；计算出的概率是无单位的，并且必须以小数形式返回。使用推导出的表达式来确保在退化情况附近的数值稳定性。\n\n最后，通过第一性原理推理，解释 $x_F(T)$ 对参数 $a$、$b$ 和 $c$ 的函数依赖关系。定性和定量地解释每个参数的变化如何影响在时间 $T$ 内到达 $s_F$ 的概率。\n\n测试套件：\n为以下参数集提供输出，其中包括一般情况、边界情况和边缘情况：\n1. $(a,b,c,T) = (0.4, 0.3, 0.8, 2.5)$，其中 $a$ 的单位为 $s^{-1}$，$b$ 的单位为 $s^{-1}$，$c$ 的单位为 $s^{-1}$，$T$ 的单位为秒。\n2. $(a,b,c,T) = (0.3, 0.2, 0.5, 3.0)$，其中 $a + b = c$（退化情况）。\n3. $(a,b,c,T) = (0.2, 0.0, 0.4, 1.75)$，其中没有从 $s_0$ 直接失效的路径。\n4. $(a,b,c,T) = (0.4, 0.3, 0.5, 0.0)$，时间界限为零。\n5. $(a,b,c,T) = (0.1, 0.2, 0.05, 100.0)$，长时间界限。\n\n要求的最终输出格式：\n你的程序应产生单行输出，其中包含五个测试用例的结果，结果为一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4,result_5]$），其中每个 $result_i$ 是计算出的小数概率。程序不得读取任何输入，且必须仅打印这一行。",
            "solution": "用户希望我解决一个关于连续时间马尔可夫链 (CTMC) 的问题。\n\n### 第1步：问题验证\n\n该问题是随机过程领域内一个定义明确的数学练习，具体涉及连续时间马尔可夫链 (CTMC) 及其使用连续随机逻辑 (CSL) 的分析。\n\n*   **提取已知条件**：\n    *   系统：一个三状态 CTMC，状态为 $\\{s_0, s_1, s_F\\}$，其中 $s_F$ 是吸收态。\n    *   初始条件：过程在时间 $t=0$ 时从状态 $s_0$ 开始，即 $P(X(0)=s_0)=1$。\n    *   转移和速率：\n        *   $s_0 \\to s_1$，速率为 $a$ ($s^{-1}$)。\n        *   $s_0 \\to s_F$，速率为 $b$ ($s^{-1}$)。\n        *   $s_1 \\to s_F$，速率为 $c$ ($s^{-1}$)。\n    *   目标1：推导在时间 $T$ 前到达失效状态 $s_F$ 的概率 $x_F(T)$ 的闭式表达式，该表达式是 $a, b, c, T$ 的函数。推导必须处理一般情况 ($a+b \\neq c$) 和退化情况 ($a+b = c$)。\n    *   目标2：实现一个程序，为一组给定的测试参数计算 $x_F(T)$。\n    *   目标3：解释 $x_F(T)$ 对参数 $a, b, c$ 的函数依赖关系。\n\n*   **验证**：\n    *   该问题在科学上植根于 CTMC 理论，是系统定量验证和性能分析中的一个标准课题。\n    *   问题陈述清晰，提供了获得唯一解所需的所有信息。\n    *   语言客观、精确。\n    *   设定完整、一致，并在数学上是合理的。\n\n*   **结论**：问题有效。\n\n### 第2步：推导闭式表达式\n\n我们首先使用 Kolmogorov 前向方程对系统进行建模。设 $x_0(t)$、$x_1(t)$ 和 $x_F(t)$ 分别是系统在时间 $t$ 处于状态 $s_0$、$s_1$ 和 $s_F$ 的概率。状态向量为 $x(t) = [x_0(t), x_1(t), x_F(t)]$。\n\n该 CTMC 的生成元矩阵 $Q$（状态排序为 $(s_0, s_1, s_F)$）是根据给定的转移速率构建的。对角线元素是每个状态所有出向转移速率之和的负值。\n$$\nQ = \\begin{pmatrix} -(a+b)  a  b \\\\ 0  -c  c \\\\ 0  0  0 \\end{pmatrix}\n$$\nKolmogorov 前向方程由矩阵-向量微分方程 $d x(t)/dt = x(t) Q$ 给出。这展开为一个线性常微分方程组 (ODEs)：\n1.  $\\frac{dx_0(t)}{dt} = -(a+b) x_0(t)$\n2.  $\\frac{dx_1(t)}{dt} = a x_0(t) - c x_1(t)$\n3.  $\\frac{dx_F(t)}{dt} = b x_0(t) + c x_1(t)$\n\n初始条件由起始状态 $s_0$ 给出：$x_0(0)=1$，$x_1(0)=0$，以及 $x_F(0)=0$。\n\n我们逐步求解这个 ODE 方程组。\n\n**求解 $x_0(t)$：**\n第一个方程是一个简单的可分离一阶 ODE。\n$$\n\\frac{dx_0}{x_0} = -(a+b) dt\n$$\n对两边积分并应用初始条件 $x_0(0)=1$ 得到：\n$$\nx_0(t) = e^{-(a+b)t}\n$$\n\n**求解 $x_1(t)$：**\n将 $x_0(t)$ 的解代入第二个 ODE：\n$$\n\\frac{dx_1(t)}{dt} + c x_1(t) = a e^{-(a+b)t}\n$$\n这是一个一阶线性 ODE。我们使用积分因子 $I(t) = e^{\\int c dt} = e^{ct}$ 来求解。\n$$\n\\frac{d}{dt}(x_1(t)e^{ct}) = a e^{ct} e^{-(a+b)t} = a e^{(c - (a+b))t}\n$$\n对时间从 $0$ 到 $t$ 积分：\n$$\nx_1(t)e^{ct} - x_1(0)e^0 = \\int_0^t a e^{(c - (a+b))\\tau} d\\tau\n$$\n由于 $x_1(0)=0$，我们有 $x_1(t)e^{ct} = a \\int_0^t e^{(c - (a+b))\\tau} d\\tau$。我们必须对这个积分考虑两种情况。\n\n*   **一般情况：$a+b \\neq c$**\n    指数非零。令 $\\delta = c-(a+b)$。\n    $$\n    x_1(t)e^{ct} = a \\left[ \\frac{1}{\\delta} e^{\\delta \\tau} \\right]_0^t = \\frac{a}{\\delta}(e^{\\delta t} - 1)\n    $$\n    两边乘以 $e^{-ct}$：\n    $$\n    x_1(t) = \\frac{a}{c-(a+b)} (e^{(c-(a+b))t} - 1)e^{-ct} = \\frac{a}{c-(a+b)} (e^{-(a+b)t} - e^{-ct})\n    $$\n\n*   **退化情况：$a+b = c$**\n    指数为零 ($e^0 = 1$)。\n    $$\n    x_1(t)e^{ct} = a \\int_0^t 1 d\\tau = at\n    $$\n    两边乘以 $e^{-ct}$：\n    $$\n    x_1(t) = at e^{-ct}\n    $$\n    由于 $a+b=c$，我们也可以写成 $x_1(t) = at e^{-(a+b)t}$。\n\n**求解 $x_F(T)$：**\n总概率必须守恒：对所有 $t \\ge 0$，$x_0(t) + x_1(t) + x_F(t) = 1$。因此，在时间 $T$ 处于失效状态的概率为：\n$$\nx_F(T) = 1 - x_0(T) - x_1(T)\n$$\n我们现在为每种情况代入 $x_0(T)$ 和 $x_1(T)$ 的表达式。\n\n*   **一般情况：$a+b \\neq c$**\n    $$\n    x_F(T) = 1 - e^{-(a+b)T} - \\frac{a}{c-(a+b)} (e^{-(a+b)T} - e^{-cT})\n    $$\n    重新整理各项，将指数项分组：\n    $$\n    x_F(T) = 1 - \\left(1 + \\frac{a}{c-(a+b)}\\right)e^{-(a+b)T} + \\frac{a}{c-(a+b)}e^{-cT}\n    $$\n    化简第一个指数项的系数：\n    $$\n    1 + \\frac{a}{c-(a+b)} = \\frac{c - a - b + a}{c-(a+b)} = \\frac{c-b}{c-(a+b)}\n    $$\n    这给出了一般情况下的最终闭式表达式：\n    $$\n    x_F(T) = 1 - \\frac{c-b}{c-(a+b)} e^{-(a+b)T} + \\frac{a}{c-(a+b)} e^{-cT}\n    $$\n\n*   **退化情况：$a+b = c$**\n    $$\n    x_F(T) = 1 - x_0(T) - x_1(T) = 1 - e^{-cT} - aT e^{-cT}\n    $$\n    这给出了退化情况下的表达式：\n    $$\n    x_F(T) = 1 - (1+aT)e^{-cT}\n    $$\n\n**数值稳定性：**\n$x_F(T)$ 的一般公式在分母中包含项 $\\delta = c-(a+b)$，当 $\\delta \\to 0$ 时会导致数值不稳定。我们可以使用洛必达法则或泰勒级数展开来验证，当 $\\delta \\to 0$ 时，一般情况公式的极限就是退化情况的公式。\n设 $c = a+b+\\delta$。一般公式可以写为：\n$$\nx_F(T) = 1 + \\frac{a e^{-(a+b+\\delta)T} - (a+\\delta) e^{-(a+b)T}}{\\delta}\n$$\n我们考察当 $\\delta \\to 0$ 时分数的极限。使用指数函数的一阶泰勒展开 $e^{-\\delta T} \\approx 1 - \\delta T$：\n$$\n\\lim_{\\delta \\to 0} \\frac{a e^{-(a+b)T} e^{-\\delta T} - (a+\\delta) e^{-(a+b)T}}{\\delta} = \\lim_{\\delta \\to 0} e^{-(a+b)T} \\frac{a(1-\\delta T) - (a+\\delta)}{\\delta}\n$$\n$$\n= e^{-(a+b)T} \\lim_{\\delta \\to 0} \\frac{a - a\\delta T - a - \\delta}{\\delta} = e^{-(a+b)T} \\lim_{\\delta \\to 0} \\frac{-\\delta(aT+1)}{\\delta} = -(aT+1)e^{-(a+b)T}\n$$\n将此代回，我们得到 $x_F(T) = 1 - (aT+1)e^{-(a+b)T}$。在此极限下，因为 $a+b=c$，这正是退化情况的公式。在实现时，当 $|\\delta|$ 小于一个很小的阈值（例如 $10^{-9}$）时，我们使用退化情况的公式，否则使用一般公式。\n\n### 第3步：参数依赖性解释\n\n量 $x_F(T)$ 表示进入失效状态 $s_F$ 的时间的累积分布函数 (CDF)。参数 $a, b, c$ 是速率，其倒数表示相应指数事件的平均时间。\n\n*   **对 $b$ 的依赖性（速率 $s_0 \\to s_F$）：** 增加 $b$ 会提高从初始状态直接到失效路径 ($s_0 \\to s_F$) 的速率。这无疑会使失效更有可能更早发生。因此，对于任何 $T0$，$x_F(T)$ 是 $b$ 的严格增函数。对于 $T0$，偏导数 $\\partial x_F(T) / \\partial b$ 总是正的。\n\n*   **对 $c$ 的依赖性（速率 $s_1 \\to s_F$）：** 增加 $c$ 会提高从中间状态 $s_1$ 失效的速率。这加速了两步失效路径 ($s_0 \\to s_1 \\to s_F$) 的第二步。如果有任何到达 $s_1$ 的机会（即如果 $a0$），那么加快从 $s_1$ 到 $s_F$ 的离开速率将使整个失效过程更快。因此，对于任何 $T0$ 和 $a0$，$x_F(T)$ 是 $c$ 的严格增函数。对于 $T0, a0$，偏导数 $\\partial x_F(T) / \\partial c$ 是正的。\n\n*   **对 $a$ 的依赖性（速率 $s_0 \\to s_1$）：** $a$ 的影响更为复杂。增加 $a$ 有两个相互竞争的影响：\n    1.  它增加了离开状态 $s_0$ 的总速率（即 $a+b$），从而缩短了在初始状态停留的时间。\n    2.  它将概率质量从直接失效路径 ($s_0 \\to s_F$) 转移到两步路径 ($s_0 \\to s_1 \\to s_F$)。\n    净效应取决于这条替代路径的“速度”，该速度由速率 $c$ 控制。如果 $c$ 非常大，第二步 $s_1 \\to s_F$ 会非常快，因此更多地开放这条路径（增加 $a$）可能会加速整体失效。如果 $c$ 非常小，状态 $s_1$ 就像一个临时陷阱，将概率质量转移到其中可能会延迟最终的失效，相比于直接路径（如果 $b0$）。因此，$x_F(T)$ 对 $a$ 的依赖性是非单调的，并且取决于 $b$ 和 $c$ 的相对值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the CTMC problem for the given test suite.\n    \n    The function calculates the probability of reaching the absorbing failure state s_F\n    by time T for a three-state Continuous-Time Markov Chain. It uses a derived\n    closed-form solution that is numerically stabilized for the degenerate case\n    where a + b = c.\n    \"\"\"\n\n    test_cases = [\n        # (a, b, c, T)\n        (0.4, 0.3, 0.8, 2.5),    # General case\n        (0.3, 0.2, 0.5, 3.0),    # Degenerate case (a + b = c)\n        (0.2, 0.0, 0.4, 1.75),   # No direct failure from s0 (b=0)\n        (0.4, 0.3, 0.5, 0.0),    # Zero time bound\n        (0.1, 0.2, 0.05, 100.0)  # Long time bound, T -> infinity\n    ]\n\n    results = []\n    \n    # Threshold for treating the general case as degenerate for numerical stability.\n    epsilon = 1e-9\n\n    for a, b, c, T in test_cases:\n        # T=0 is a trivial boundary case, failure probability is 0.\n        if T == 0.0:\n            results.append(0.0)\n            continue\n            \n        rate_sum = a + b\n        delta = c - rate_sum\n\n        prob = 0.0\n        if abs(delta)  epsilon:\n            # Degenerate case: a + b = c, or numerically very close.\n            # Formula: x_F(T) = 1 - (1 + a*T) * exp(-c*T)\n            # This handles the case where c=0 (and thus a=b=0), resulting in prob=0.\n            prob = 1.0 - (1.0 + a * T) * np.exp(-c * T)\n        else:\n            # General case: a + b != c\n            # Formula: x_F(T) = 1 - (c-b)/(c-(a+b))*exp(-(a+b)T) + a/(c-(a+b))*exp(-c*T)\n            # This handles cases where a=0 or b=0 correctly.\n            term1 = ((c - b) / delta) * np.exp(-rate_sum * T)\n            term2 = (a / delta) * np.exp(-c * T)\n            prob = 1.0 - term1 + term2\n        \n        results.append(prob)\n\n    # Format the final output string as specified.\n    # e.g., [result_1,result_2,result_3,result_4,result_5]\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}