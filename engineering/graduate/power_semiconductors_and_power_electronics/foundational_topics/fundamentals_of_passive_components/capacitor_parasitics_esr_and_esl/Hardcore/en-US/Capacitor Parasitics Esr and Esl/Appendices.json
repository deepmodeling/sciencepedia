{
    "hands_on_practices": [
        {
            "introduction": "To master the impact of capacitor parasitics, we first must understand their inherent dynamics. This exercise models a real capacitor as a self-contained series $LRC$ circuit to analyze its natural response. By examining the energy balance during a resonant charge-discharge cycle, you will derive fundamental metrics like the Quality factor ($Q$) and energy decay time, connecting the abstract parasitic values of $R_{\\mathrm{ESR}}$ and $L_{\\mathrm{ESL}}$ to the tangible concepts of oscillation and damping .",
            "id": "3826078",
            "problem": "A direct-current bus capacitor module in a power semiconductor converter is modeled with its parasitics as a series network composed of capacitance $C$, Equivalent Series Inductance (ESL) $L_{\\mathrm{ESL}}$, and Equivalent Series Resistance (ESR) $R_{\\mathrm{ESR}}$. The capacitor is initially charged to voltage $V_{0}$ and then is abruptly short-circuited by an ideal switch so that the subsequent dynamics are governed solely by the series $L\\!-\\!R\\!-\\!C$ loop. Assume the damping is weak enough that the oscillation is near the undamped natural frequency and the envelope varies slowly compared to a cycle.\n\nStarting only from the fundamental definitions of energy and power in passive elements and basic circuit laws, analyze the energy balance over one near-resonant charge-discharge cycle to obtain an expression for the quality factor $Q$ in terms of $L_{\\mathrm{ESL}}$, $C$, and $R_{\\mathrm{ESR}}$. Then, using the continuous-time energy balance, derive the characteristic time for the stored electromagnetic energy in the $L\\!-\\!C$ pair to decay by a factor of $\\exp(-1)$.\n\nUse the following parameter values representative of a high-current film capacitor:\n- $L_{\\mathrm{ESL}} = 20\\,\\mathrm{nH}$,\n- $R_{\\mathrm{ESR}} = 5\\,\\mathrm{m}\\Omega$,\n- $C = 10\\,\\mu\\mathrm{F}$.\n\nCompute numerically:\n- the quality factor $Q$ (dimensionless), and\n- the energy $\\exp(-1)$ decay time in microseconds.\n\nRound your final numerical results to four significant figures. Express the decay time in microseconds ($\\mu\\mathrm{s}$). Provide the final answer as the ordered pair $\\left(Q,\\ \\text{decay time in }\\mu\\mathrm{s\\!}\\right)$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Model:** A series network of capacitance $C$, Equivalent Series Inductance (ESL) $L_{\\mathrm{ESL}}$, and Equivalent Series Resistance (ESR) $R_{\\mathrm{ESR}}$.\n- **Initial Condition:** The capacitor is initially charged to voltage $V_{0}$.\n- **Event:** The circuit is abruptly short-circuited by an ideal switch.\n- **System Dynamics:** Governed by the series $L\\!-\\!R\\!-\\!C$ loop.\n- **Assumption:** The damping is weak enough that the oscillation is near the undamped natural frequency and the envelope varies slowly compared to a cycle.\n- **Task 1:** Derive an expression for the quality factor $Q$ in terms of $L_{\\mathrm{ESL}}$, $C$, and $R_{\\mathrm{ESR}}$ using energy balance over one cycle.\n- **Task 2:** Derive the characteristic time for the stored energy to decay by a factor of $\\exp(-1)$ using continuous-time energy balance.\n- **Parameter Values:**\n  - $L_{\\mathrm{ESL}} = 20\\,\\mathrm{nH}$\n  - $R_{\\mathrm{ESR}} = 5\\,\\mathrm{m}\\Omega$\n  - $C = 10\\,\\mu\\mathrm{F}$\n- **Numerical Calculation:** Compute $Q$ and the energy decay time, rounded to four significant figures. The decay time should be in microseconds.\n- **Final Answer Format:** Ordered pair $(Q, \\text{decay time in }\\mu\\mathrm{s})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is **valid**.\n- **Scientifically Grounded:** The RLC series circuit is a fundamental model in electrical engineering. Representing a real capacitor with parasitic resistance (ESR) and inductance (ESL) is a standard and crucial practice in power electronics. The analysis is based on Kirchhoff's laws and the fundamental definitions of energy and power in circuit elements.\n- **Well-Posed:** The problem provides a complete model, initial conditions, and a clear set of tasks. The assumption of weak damping, while an approximation, is explicitly stated and serves to guide the derivation towards a standard, well-defined analytical form for $Q$ and the decay time.\n- **Objective:** The language is formal and precise. The parameters are quantitative.\n- **No other flaws are detected.** The component values are realistic for the specified application. The problem is a standard, yet non-trivial, exercise in circuit theory and energy analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe dynamics of the series $L\\!-\\!R\\!-\\!C$ circuit after the switch closes are described by Kirchhoff's Voltage Law (KVL):\n$$L_{\\mathrm{ESL}}\\frac{di(t)}{dt} + R_{\\mathrm{ESR}}i(t) + v_C(t) = 0$$\nwhere $i(t)$ is the current in the loop and $v_C(t)$ is the voltage across the capacitor. The current is also related to the capacitor voltage by $i(t) = -C\\frac{dv_C(t)}{dt}$. The negative sign arises because the current, as defined by flowing out of the positive terminal of the capacitor, discharges it. Substituting this into the KVL equation yields the second-order linear homogeneous differential equation for $v_C(t)$:\n$$L_{\\mathrm{ESL}}C\\frac{d^2v_C(t)}{dt^2} + R_{\\mathrm{ESR}}C\\frac{dv_C(t)}{dt} + v_C(t) = 0$$\nDividing by $L_{\\mathrm{ESL}}C$, we get the standard form:\n$$\\frac{d^2v_C(t)}{dt^2} + \\frac{R_{\\mathrm{ESR}}}{L_{\\mathrm{ESL}}}\\frac{dv_C(t)}{dt} + \\frac{1}{L_{\\mathrm{ESL}}C}v_C(t) = 0$$\nThis is the equation of a damped harmonic oscillator, $\\frac{d^2v_C}{dt^2} + 2\\alpha\\frac{dv_C}{dt} + \\omega_0^2 v_C = 0$, with damping factor $\\alpha = \\frac{R_{\\mathrm{ESR}}}{2L_{\\mathrm{ESL}}}$ and undamped natural frequency $\\omega_0 = \\frac{1}{\\sqrt{L_{\\mathrm{ESL}}C}}$.\n\nThe problem assumes weak damping, which corresponds to an underdamped system ($\\alpha < \\omega_0$). The solution for the capacitor voltage is an exponentially decaying sinusoid.\n\n**1. Derivation of the Quality Factor $Q$**\n\nThe quality factor $Q$ is defined in terms of energy as $2\\pi$ times the ratio of the maximum energy stored in the circuit to the energy dissipated in one cycle.\n$$Q = 2\\pi \\frac{W_{\\text{stored}}}{W_{\\text{dissipated per cycle}}}$$\nThe total energy stored in the reactive components (inductor and capacitor) at time $t$ is:\n$$W_{\\text{stored}}(t) = W_L(t) + W_C(t) = \\frac{1}{2}L_{\\mathrm{ESL}}i(t)^2 + \\frac{1}{2}Cv_C(t)^2$$\nUnder the weak damping assumption ($\\alpha \\ll \\omega_0$), the damped frequency $\\omega_d = \\sqrt{\\omega_0^2 - \\alpha^2}$ is approximately $\\omega_0$. The voltage and current are approximately:\n$$v_C(t) \\approx V_0 \\exp(-\\alpha t) \\cos(\\omega_0 t)$$\n$$i(t) = -C\\frac{dv_C}{dt} \\approx V_0 C \\omega_0 \\exp(-\\alpha t) \\sin(\\omega_0 t)$$\nSubstituting these into the energy expression:\n$$W_{\\text{stored}}(t) \\approx \\frac{1}{2}L_{\\mathrm{ESL}}(V_0 C \\omega_0 \\exp(-\\alpha t) \\sin(\\omega_0 t))^2 + \\frac{1}{2}C(V_0 \\exp(-\\alpha t) \\cos(\\omega_0 t))^2$$\nUsing $\\omega_0^2 = 1/(L_{\\mathrm{ESL}}C)$, the term $L_{\\mathrm{ESL}}(C\\omega_0)^2$ simplifies to $L_{\\mathrm{ESL}}C^2 / (L_{\\mathrm{ESL}}C) = C$.\n$$W_{\\text{stored}}(t) \\approx \\frac{1}{2}C V_0^2 \\exp(-2\\alpha t) \\sin^2(\\omega_0 t) + \\frac{1}{2}C V_0^2 \\exp(-2\\alpha t) \\cos^2(\\omega_0 t)$$\n$$W_{\\text{stored}}(t) \\approx \\frac{1}{2}C V_0^2 \\exp(-2\\alpha t) (\\sin^2(\\omega_0 t) + \\cos^2(\\omega_0 t)) = W_0 \\exp(-2\\alpha t)$$\nwhere $W_0 = \\frac{1}{2}C V_0^2$ is the initial stored energy. This is the energy envelope, which varies slowly.\n\nThe energy dissipated in one cycle of period $T = 2\\pi/\\omega_0$ is the change in stored energy over that period:\n$$W_{\\text{dissipated per cycle}} = W_{\\text{stored}}(t) - W_{\\text{stored}}(t+T) = W_0 \\exp(-2\\alpha t) - W_0 \\exp(-2\\alpha(t+T))$$\n$$W_{\\text{dissipated per cycle}} = W_{\\text{stored}}(t) \\left( 1 - \\exp(-2\\alpha T) \\right)$$\nFor weak damping, the envelope varies slowly, meaning $2\\alpha T \\ll 1$. We use the Taylor approximation $\\exp(-x) \\approx 1-x$ for small $x$.\n$$W_{\\text{dissipated per cycle}} \\approx W_{\\text{stored}}(t) (1 - (1-2\\alpha T)) = 2\\alpha T W_{\\text{stored}}(t)$$\nNow we substitute this into the definition of $Q$:\n$$Q = 2\\pi \\frac{W_{\\text{stored}}(t)}{W_{\\text{dissipated per cycle}}} \\approx \\frac{2\\pi}{2\\alpha T} = \\frac{2\\pi}{2\\alpha (2\\pi/\\omega_0)} = \\frac{\\omega_0}{2\\alpha}$$\nSubstituting the expressions for $\\omega_0$ and $\\alpha$:\n$$Q = \\frac{1/\\sqrt{L_{\\mathrm{ESL}}C}}{R_{\\mathrm{ESR}}/L_{\\mathrm{ESL}}} = \\frac{L_{\\mathrm{ESL}}}{R_{\\mathrm{ESR}}\\sqrt{L_{\\mathrm{ESL}}C}}$$\n$$Q = \\frac{1}{R_{\\mathrm{ESR}}}\\sqrt{\\frac{L_{\\mathrm{ESL}}}{C}}$$\n\n**2. Derivation of the Energy Decay Time $\\tau_E$**\n\nWe use the continuous-time energy balance, which states that the rate of change of stored energy is equal to the power dissipated by the resistor:\n$$\\frac{dW_{\\text{stored}}}{dt} = -P_{\\text{dissipated}} = -R_{\\mathrm{ESR}}i(t)^2$$\nTo find the decay time of the energy envelope, we average this equation over one cycle, invoking the assumption that the energy envelope changes slowly. Let $W(t)$ be the energy envelope $W_0 \\exp(-2\\alpha t)$.\n$$\\frac{dW(t)}{dt} = \\langle -R_{\\mathrm{ESR}}i(t)^2 \\rangle_T$$\nThe time average of the squared current over one cycle is:\n$$\\langle i(t)^2 \\rangle_T \\approx \\langle (V_0 C \\omega_0 \\exp(-\\alpha t))^2 \\sin^2(\\omega_0 t) \\rangle_T$$\nSince the envelope is slow, we treat $\\exp(-\\alpha t)$ as constant over the cycle:\n$$\\langle i(t)^2 \\rangle_T \\approx (V_0 C \\omega_0 \\exp(-\\alpha t))^2 \\langle \\sin^2(\\omega_0 t) \\rangle_T = \\frac{1}{2} (V_0 C \\omega_0 \\exp(-\\alpha t))^2$$\nThe total stored energy can be expressed as the peak energy, e.g., $W(t) = \\frac{1}{2}C (V_0 \\exp(-\\alpha t))^2$. The peak current is $I_{peak}(t) = V_0 C \\omega_0 \\exp(-\\alpha t)$.\nThus, $\\langle i(t)^2 \\rangle_T \\approx \\frac{1}{2} I_{peak}(t)^2$.\nThe energy balance becomes:\n$$\\frac{dW(t)}{dt} \\approx -R_{\\mathrm{ESR}} \\left( \\frac{1}{2} I_{peak}(t)^2 \\right)$$\nThe energy envelope can also be written in terms of peak current: $W(t) = \\frac{1}{2}L_{\\mathrm{ESL}}I_{peak}(t)^2$.\n$$\\frac{d}{dt}\\left(\\frac{1}{2}L_{\\mathrm{ESL}}I_{peak}(t)^2\\right) \\approx -\\frac{1}{2}R_{\\mathrm{ESR}}I_{peak}(t)^2$$\nLet $Y(t) = I_{peak}(t)^2$. The equation simplifies to a first-order ODE for $Y(t)$:\n$$L_{\\mathrm{ESL}}\\frac{dY}{dt} = -R_{\\mathrm{ESR}}Y \\implies \\frac{dY}{dt} = -\\frac{R_{\\mathrm{ESR}}}{L_{\\mathrm{ESL}}} Y$$\nThe solution is of the form $Y(t) = Y_0 \\exp(-t/\\tau_E)$, where the time constant $\\tau_E$ is the characteristic time for the energy to decay. By comparison, we find:\n$$\\tau_E = \\frac{L_{\\mathrm{ESL}}}{R_{\\mathrm{ESR}}}$$\nThis is the characteristic time for the stored electromagnetic energy to decay to $1/\\exp(1)$ of its initial value.\n\n### Numerical Computations\n\nGiven values:\n$L_{\\mathrm{ESL}} = 20 \\times 10^{-9}\\,\\mathrm{H}$\n$R_{\\mathrm{ESR}} = 5 \\times 10^{-3}\\,\\Omega$\n$C = 10 \\times 10^{-6}\\,\\mathrm{F}$\n\n**Quality Factor $Q$:**\n$$Q = \\frac{1}{R_{\\mathrm{ESR}}}\\sqrt{\\frac{L_{\\mathrm{ESL}}}{C}} = \\frac{1}{5 \\times 10^{-3}} \\sqrt{\\frac{20 \\times 10^{-9}}{10 \\times 10^{-6}}} = \\frac{1}{5 \\times 10^{-3}} \\sqrt{2 \\times 10^{-3}}$$\n$$Q \\approx 200 \\times 0.04472136 = 8.94427...$$\nRounding to four significant figures, $Q = 8.944$.\n\n**Energy Decay Time $\\tau_E$:**\n$$\\tau_E = \\frac{L_{\\mathrm{ESL}}}{R_{\\mathrm{ESR}}} = \\frac{20 \\times 10^{-9}\\,\\mathrm{H}}{5 \\times 10^{-3}\\,\\Omega} = 4 \\times 10^{-6}\\,\\mathrm{s}$$\nThe problem requests the time in microseconds ($\\mu\\mathrm{s}$).\n$$\\tau_E = 4\\,\\mu\\mathrm{s}$$\nRounding to four significant figures, the decay time is $4.000\\,\\mu\\mathrm{s}$.\n\nThe final answer is the ordered pair $(Q, \\tau_E)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.944 & 4.000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having explored the intrinsic behavior of a single capacitor, we now apply this knowledge to a practical power electronics circuit. This problem challenges you to analyze how parasitics affect the time-domain performance of a synchronous buck converter, a ubiquitous component in modern electronics. You will deconstruct the total output voltage ripple into its constituent parts, calculating the individual contributions from the ideal capacitance ($C$), the Equivalent Series Resistance (ESR), and the Equivalent Series Inductance (ESL) to determine the design budget for these critical parameters .",
            "id": "3826070",
            "problem": "A synchronous buck converter converts a direct-current input of $V_{\\mathrm{in}}=48\\,\\mathrm{V}$ to an output of $V_{o}=12\\,\\mathrm{V}$ at a pulse-width modulation switching frequency of $f_{s}=500\\,\\mathrm{kHz}$, operating in continuous conduction mode with ideal switches. The steady-state inductor current has a triangular ripple of peak-to-peak amplitude $\\Delta I_{L}=6\\,\\mathrm{A}$. The output network is modeled as a single ideal capacitor of total capacitance $C=1000\\,\\mu\\mathrm{F}$ in series with an equivalent series resistance (ESR) to be determined and a known equivalent series inductance (ESL) $L_{s}=0.6\\,\\mathrm{nH}$, representing the combined capacitor and layout inductance. The load current is $I_{o}=20\\,\\mathrm{A}$.\n\nStarting from the fundamental relations $v_{L}=L\\,\\frac{\\mathrm{d}i_{L}}{\\mathrm{d}t}$, $i_{C}=C\\,\\frac{\\mathrm{d}v_{C}}{\\mathrm{d}t}$, $v_{\\mathrm{ESR}}=\\mathrm{ESR}\\cdot i_{C}$, and $v_{\\mathrm{ESL}}=L_{s}\\,\\frac{\\mathrm{d}i_{C}}{\\mathrm{d}t}$, and assuming a piecewise-linear triangular inductor current and instantaneous switching transitions, derive expressions for the peak-to-peak output ripple contributions due to the capacitor’s finite capacitance, its ESR, and its ESL. Use the duty ratio implied by the conversion ratio and treat the capacitor current as the zero-average triangular ripple current that equals the inductor ripple current around the load current.\n\nFor worst-case compliance, assume the peak-to-peak output voltage ripple is the arithmetic sum of the three peak-to-peak contributions (capacitance, ESR, ESL). The specification requires the total peak-to-peak output ripple at the switching frequency to satisfy $V_{\\mathrm{pp,tot}}\\leq 20\\,\\mathrm{mV}$ under the stated conditions.\n\nCompute the maximum allowable equivalent series resistance of the output capacitor network that meets the ripple specification. Express your final answer in milliohms and round to three significant figures.",
            "solution": "The problem requires the calculation of the maximum allowable equivalent series resistance (ESR) for the output capacitor network of a synchronous buck converter, given a maximum total peak-to-peak output voltage ripple specification. The problem is deemed valid as it is scientifically grounded, well-posed, and all necessary parameters are provided or can be derived from the given information. The solution will proceed by first determining the operating parameters of the converter, then deriving the contribution of each parasitic element (capacitance, ESR, ESL) to the total output voltage ripple, and finally solving for the maximum ESR value that meets the specification.\n\nFirst, we determine the fundamental operating parameters of the buck converter.\nThe switching period $T_s$ is the inverse of the switching frequency $f_s$:\n$$T_s = \\frac{1}{f_s} = \\frac{1}{500 \\times 10^3\\,\\mathrm{Hz}} = 2 \\times 10^{-6}\\,\\mathrm{s} = 2\\,\\mu\\mathrm{s}$$\nFor an ideal buck converter operating in continuous conduction mode (CCM), the duty ratio $D$ is the ratio of the output voltage $V_o$ to the input voltage $V_{\\mathrm{in}}$:\n$$D = \\frac{V_o}{V_{\\mathrm{in}}} = \\frac{12\\,\\mathrm{V}}{48\\,\\mathrm{V}} = 0.25$$\nThe duration for which the high-side switch is on, $T_{on}$, and the low-side switch is on, $T_{off}$, are given by:\n$$T_{on} = D \\cdot T_s = 0.25 \\cdot (2 \\times 10^{-6}\\,\\mathrm{s}) = 0.5 \\times 10^{-6}\\,\\mathrm{s} = 0.5\\,\\mu\\mathrm{s}$$\n$$T_{off} = (1-D) \\cdot T_s = (1 - 0.25) \\cdot (2 \\times 10^{-6}\\,\\mathrm{s}) = 1.5 \\times 10^{-6}\\,\\mathrm{s} = 1.5\\,\\mu\\mathrm{s}$$\n\nThe total output voltage ripple $V_{\\mathrm{pp,tot}}$ is specified as the arithmetic sum of the peak-to-peak contributions from the capacitance ($V_{\\mathrm{pp,C}}$), the ESR ($V_{\\mathrm{pp,ESR}}$), and the ESL ($V_{\\mathrm{pp,ESL}}$):\n$$V_{\\mathrm{pp,tot}} = V_{\\mathrm{pp,C}} + V_{\\mathrm{pp,ESR}} + V_{\\mathrm{pp,ESL}}$$\nThe problem states that the capacitor current, $i_C(t)$, can be modeled as the zero-average AC component of the inductor current. This AC component is a triangular waveform with a peak-to-peak amplitude equal to the inductor current ripple, $\\Delta I_L = 6\\,\\mathrm{A}$.\n\nWe now derive the expression for each ripple component.\n\n1.  **Contribution from ESR ($V_{\\mathrm{pp,ESR}}$):**\n    The voltage across the ESR is given by $v_{\\mathrm{ESR}}(t) = \\mathrm{ESR} \\cdot i_C(t)$. Since $v_{\\mathrm{ESR}}$ is directly proportional to $i_C(t)$, its waveform is also triangular and in phase with the capacitor current. The peak-to-peak voltage ripple due to ESR is therefore directly proportional to the peak-to-peak capacitor current, which is $\\Delta I_L$.\n    $$V_{\\mathrm{pp,ESR}} = \\mathrm{ESR} \\cdot \\Delta I_L$$\n\n2.  **Contribution from Capacitance ($V_{\\mathrm{pp,C}}$):**\n    The voltage ripple across the ideal capacitance $C$ is caused by the integration of the capacitor current $i_C(t)$. The peak-to-peak voltage ripple is the change in voltage caused by the net charge accumulated during half of the current ripple period. For a zero-average triangular current waveform with peak-to-peak amplitude $\\Delta I_L$ over a period $T_s$, the charge accumulated (area under the current curve for half a cycle, which is a triangle) is:\n    $$\\Delta Q_C = \\frac{1}{2} \\cdot \\left(\\frac{T_s}{2}\\right) \\cdot \\left(\\frac{\\Delta I_L}{2}\\right) = \\frac{\\Delta I_L T_s}{8}$$\n    The corresponding peak-to-peak voltage ripple is this charge divided by the capacitance $C$:\n    $$V_{\\mathrm{pp,C}} = \\frac{\\Delta Q_C}{C} = \\frac{\\Delta I_L T_s}{8C}$$\n    Substituting the given values:\n    $$V_{\\mathrm{pp,C}} = \\frac{(6\\,\\mathrm{A}) \\cdot (2 \\times 10^{-6}\\,\\mathrm{s})}{8 \\cdot (1000 \\times 10^{-6}\\,\\mathrm{F})} = \\frac{12 \\times 10^{-6}}{8000 \\times 10^{-6}}\\,\\mathrm{V} = 1.5 \\times 10^{-3}\\,\\mathrm{V} = 1.5\\,\\mathrm{mV}$$\n\n3.  **Contribution from ESL ($V_{\\mathrm{pp,ESL}}$):**\n    The voltage across the ESL is given by $v_{\\mathrm{ESL}}(t) = L_s \\cdot \\mathrm{d}i_C/\\mathrm{d}t$. Since $i_C(t)$ is a piecewise-linear triangular wave, its derivative $\\mathrm{d}i_C/\\mathrm{d}t$ is a piecewise-constant (square) wave.\n    During the $T_{on}$ interval, the current changes by $\\Delta I_L$, so the rate of change is:\n    $$\\frac{\\mathrm{d}i_C}{\\mathrm{d}t}\\bigg|_{T_{on}} = \\frac{\\Delta I_L}{T_{on}}$$\n    During the $T_{off}$ interval, the current changes by $-\\Delta I_L$, so the rate of change is:\n    $$\\frac{\\mathrm{d}i_C}{\\mathrm{d}t}\\bigg|_{T_{off}} = -\\frac{\\Delta I_L}{T_{off}}$$\n    The corresponding voltages across the ESL are:\n    $$v_{\\mathrm{ESL,on}} = L_s \\frac{\\Delta I_L}{T_{on}} \\quad \\text{and} \\quad v_{\\mathrm{ESL,off}} = -L_s \\frac{\\Delta I_L}{T_{off}}$$\n    The peak-to-peak voltage ripple due to ESL is the difference between these two voltage levels:\n    $$V_{\\mathrm{pp,ESL}} = v_{\\mathrm{ESL,on}} - v_{\\mathrm{ESL,off}} = L_s \\frac{\\Delta I_L}{T_{on}} - \\left(-L_s \\frac{\\Delta I_L}{T_{off}}\\right) = L_s \\Delta I_L \\left(\\frac{1}{T_{on}} + \\frac{1}{T_{off}}\\right)$$\n    Substituting the expressions for $T_{on}$ and $T_{off}$:\n    $$V_{\\mathrm{pp,ESL}} = L_s \\Delta I_L \\left(\\frac{1}{D T_s} + \\frac{1}{(1-D) T_s}\\right) = \\frac{L_s \\Delta I_L}{T_s} \\left(\\frac{1-D+D}{D(1-D)}\\right) = \\frac{L_s \\Delta I_L}{T_s D(1-D)}$$\n    Substituting the given values:\n    $$V_{\\mathrm{pp,ESL}} = \\frac{(0.6 \\times 10^{-9}\\,\\mathrm{H}) \\cdot (6\\,\\mathrm{A})}{(2 \\times 10^{-6}\\,\\mathrm{s}) \\cdot 0.25 \\cdot (1-0.25)} = \\frac{3.6 \\times 10^{-9}}{2 \\times 10^{-6} \\cdot 0.1875}\\,\\mathrm{V} = \\frac{3.6 \\times 10^{-9}}{0.375 \\times 10^{-6}}\\,\\mathrm{V} = 9.6 \\times 10^{-3}\\,\\mathrm{V} = 9.6\\,\\mathrm{mV}$$\n\nNow we use the total ripple specification, $V_{\\mathrm{pp,tot}} \\leq 20\\,\\mathrm{mV}$, to find the maximum allowable ESR. We set the total ripple to its maximum allowed value of $20\\,\\mathrm{mV}$.\n$$V_{\\mathrm{pp,tot}} = V_{\\mathrm{pp,C}} + V_{\\mathrm{pp,ESR}} + V_{\\mathrm{pp,ESL}}$$\n$$20\\,\\mathrm{mV} = 1.5\\,\\mathrm{mV} + V_{\\mathrm{pp,ESR}} + 9.6\\,\\mathrm{mV}$$\n$$20\\,\\mathrm{mV} = 11.1\\,\\mathrm{mV} + V_{\\mathrm{pp,ESR}}$$\nSolving for the maximum ripple contribution from ESR:\n$$V_{\\mathrm{pp,ESR}} = 20\\,\\mathrm{mV} - 11.1\\,\\mathrm{mV} = 8.9\\,\\mathrm{mV} = 8.9 \\times 10^{-3}\\,\\mathrm{V}$$\nFinally, we find the maximum allowable ESR, denoted $\\mathrm{ESR}_{\\mathrm{max}}$, from the relationship $V_{\\mathrm{pp,ESR}} = \\mathrm{ESR}_{\\mathrm{max}} \\cdot \\Delta I_L$:\n$$\\mathrm{ESR}_{\\mathrm{max}} = \\frac{V_{\\mathrm{pp,ESR}}}{\\Delta I_L} = \\frac{8.9 \\times 10^{-3}\\,\\mathrm{V}}{6\\,\\mathrm{A}} \\approx 1.48333... \\times 10^{-3}\\,\\Omega$$\nThe problem requests the answer in milliohms ($m\\Omega$), which is $10^{-3}\\,\\Omega$.\n$$\\mathrm{ESR}_{\\mathrm{max}} \\approx 1.48333...\\,\\mathrm{m}\\Omega$$\nRounding to three significant figures, we get:\n$$\\mathrm{ESR}_{\\mathrm{max}} = 1.48\\,\\mathrm{m}\\Omega$$",
            "answer": "$$\\boxed{1.48}$$"
        },
        {
            "introduction": "We now shift our focus from the time domain to the frequency domain, and from a single component to a network. In high-frequency power distribution, it is common practice to parallel multiple capacitors of different types to achieve low impedance over a wide bandwidth. However, this practice can create \"anti-resonances\"—high-impedance peaks that can severely compromise power integrity. This computational exercise guides you to build a simulation from first principles to model a parallel capacitor bank, identify these dangerous impedance peaks, and understand how component selection influences the system's frequency response .",
            "id": "3826021",
            "problem": "You are tasked with deriving, implementing, and validating a frequency-dependent impedance model for a parallel bank of capacitors including realistic parasitics, specifically Equivalent Series Resistance (ESR) and Equivalent Series Inductance (ESL), and a shared series interconnect path. You must use first principles of alternating current network analysis to construct the total impedance and numerically identify anti-resonances as impedance magnitude peaks. Anti-resonance peaks arise in parallel networks when the net admittance is small due to the interaction of inductances and capacitances, causing large impedance magnitudes. Your program must simulate the impedance magnitude over a specified frequency range and report the frequencies of these peaks.\n\nStart from the following fundamental definitions and composition rules, without introducing shortcut formulas beyond these:\n- For a resistor of resistance $R$, the impedance is $Z_R = R$.\n- For an inductor of inductance $L$, the impedance is $Z_L = j \\, \\omega \\, L$, where $j$ is the imaginary unit and $\\omega = 2 \\pi f$ is the angular frequency for frequency $f$.\n- For a capacitor of capacitance $C$, the impedance is $Z_C = \\dfrac{1}{j \\, \\omega \\, C}$.\n- In a series connection of elements with impedances $Z_1$ and $Z_2$, the total impedance is $Z_{\\text{series}} = Z_1 + Z_2$.\n- In a parallel connection of elements with impedances $Z_1$ and $Z_2$, the total admittance is $Y_{\\text{parallel}} = \\dfrac{1}{Z_1} + \\dfrac{1}{Z_2}$, and the total impedance is $Z_{\\text{parallel}} = \\dfrac{1}{Y_{\\text{parallel}}}$.\n\nConstruct the capacitor bank as $N$ parallel branches, each branch being a series connection of an Equivalent Series Resistance (ESR) and an Equivalent Series Inductance (ESL) with the ideal capacitor, i.e., each branch $i$ has $Z_i(f) = R_i + j \\, \\omega \\, L_i + \\dfrac{1}{j \\, \\omega \\, C_i}$, and the parallel combination of all branches yields a net admittance $Y_{\\text{bank}}(f) = \\sum_{i=1}^{N} \\dfrac{1}{Z_i(f)}$. This bank is then connected in series with a shared interconnect path characterized by a series resistance $R_s$ and a series inductance $L_s$, giving a total impedance $Z_{\\text{tot}}(f) = R_s + j \\, \\omega \\, L_s + \\dfrac{1}{Y_{\\text{bank}}(f)}$.\n\nLet an anti-resonance peak be defined as a local maximum of the scalar function $|Z_{\\text{tot}}(f)|$ with respect to $f$, where the discrete numerical derivative changes sign from positive to negative and the discrete second derivative is negative. To ensure physically meaningful peaks rather than numerical noise, impose a relative prominence criterion: if a peak has height $H$ and its local baseline (the higher of the nearest lower minima on either side) has level $B$, the relative prominence ratio $\\rho = \\dfrac{H}{B}$ must satisfy $\\rho \\ge \\alpha$, with $\\alpha = 3$.\n\nFrequency sweep and sampling:\n- Use $N_f = 5000$ logarithmically spaced points over $f \\in [f_{\\min}, f_{\\max}]$ as specified per test case. Ensure that $\\omega = 2 \\pi f$ is computed at each frequency.\n- Compute $Z_{\\text{tot}}(f)$ and $|Z_{\\text{tot}}(f)|$ at all $N_f$ points.\n\nOutput specification:\n- For each test case, return the list of anti-resonance peak frequencies as integers in $\\mathrm{Hz}$, rounded to the nearest integer.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case’s list enclosed in square brackets and no whitespace. For example, an output for two test cases might look like $[[100000,250000],[\\ ]]$, where the second case has no peaks. The unit for each frequency is $\\mathrm{Hz}$.\n\nTest suite:\nImplement the following four test cases. For each, the capacitor bank consists of branches with parameters $(C_i, R_i, L_i)$ given in farads, ohms, and henries respectively, and the shared series path $(R_s, L_s)$ in ohms and henries.\n\n- Test case $1$ (general multi-capacitor bank with moderate parasitics, expected multiple anti-resonances):\n  - Shared series path: $R_s = 2 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_s = 5 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $1$: $C_1 = 47 \\times 10^{-6} \\,\\mathrm{F}$, $R_1 = 15 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_1 = 6 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $2$: $C_2 = 1 \\times 10^{-6} \\,\\mathrm{F}$, $R_2 = 10 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_2 = 2 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $3$: $C_3 = 100 \\times 10^{-9} \\,\\mathrm{F}$, $R_3 = 20 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_3 = 1 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Frequency range: $f_{\\min} = 10^{3} \\,\\mathrm{Hz}$, $f_{\\max} = 10^{8} \\,\\mathrm{Hz}$, $N_f = 5000$.\n\n- Test case $2$ (high ESR damping the network, expected few or no anti-resonances):\n  - Shared series path: $R_s = 5 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_s = 5 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $1$: $C_1 = 22 \\times 10^{-6} \\,\\mathrm{F}$, $R_1 = 200 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_1 = 8 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $2$: $C_2 = 1 \\times 10^{-6} \\,\\mathrm{F}$, $R_2 = 150 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_2 = 4 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $3$: $C_3 = 100 \\times 10^{-9} \\,\\mathrm{F}$, $R_3 = 150 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_3 = 2 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Frequency range: $f_{\\min} = 10^{3} \\,\\mathrm{Hz}$, $f_{\\max} = 10^{8} \\,\\mathrm{Hz}$, $N_f = 5000$.\n\n- Test case $3$ (low ESR and larger shared inductance, expected sharp, high-$Q$ anti-resonances):\n  - Shared series path: $R_s = 0.5 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_s = 20 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $1$: $C_1 = 100 \\times 10^{-6} \\,\\mathrm{F}$, $R_1 = 3 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_1 = 10 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $2$: $C_2 = 1 \\times 10^{-6} \\,\\mathrm{F}$, $R_2 = 3 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_2 = 2 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $3$: $C_3 = 10 \\times 10^{-9} \\,\\mathrm{F}$, $R_3 = 3 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_3 = 0.5 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Frequency range: $f_{\\min} = 10^{3} \\,\\mathrm{Hz}$, $f_{\\max} = 10^{8} \\,\\mathrm{Hz}$, $N_f = 5000$.\n\n- Test case $4$ (minimal network with two capacitors, expected single dominant anti-resonance):\n  - Shared series path: $R_s = 1 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_s = 10 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $1$: $C_1 = 10 \\times 10^{-6} \\,\\mathrm{F}$, $R_1 = 10 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_1 = 6 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Branch $2$: $C_2 = 100 \\times 10^{-9} \\,\\mathrm{F}$, $R_2 = 30 \\times 10^{-3} \\,\\mathrm{\\Omega}$, $L_2 = 1.5 \\times 10^{-9} \\,\\mathrm{H}$.\n  - Frequency range: $f_{\\min} = 10^{3} \\,\\mathrm{Hz}$, $f_{\\max} = 10^{8} \\,\\mathrm{Hz}$, $N_f = 5000$.\n\nYour program must implement these four test cases internally, perform the required computations, and print a single line containing a list of four lists of integers, each inner list being the rounded anti-resonance peak frequencies in $\\mathrm{Hz}$ for the corresponding test case, in the exact format described above, with no whitespace.",
            "solution": "The problem requires the derivation and numerical implementation of a model for the total impedance of a parallel capacitor bank, including parasitic elements, to identify anti-resonance frequencies. The process is based on first principles of alternating current (AC) circuit analysis.\n\nFirst, we establish the mathematical model for the total impedance, $Z_{\\text{tot}}(f)$, as a function of frequency $f$. The angular frequency is defined as $\\omega = 2 \\pi f$.\nThe analysis proceeds in four steps:\n1.  Define the impedance of a single capacitor branch.\n2.  Combine the admittances of all parallel branches to find the bank's total admittance.\n3.  Calculate the impedance of the bank from its admittance.\n4.  Add the impedance of the shared series path to find the total network impedance.\n\nStep 1: Impedance of a Single Branch\n\nEach branch $i$ in the parallel bank consists of a capacitor $C_i$ in series with its parasitic Equivalent Series Resistance (ESR) $R_i$ and Equivalent Series Inductance (ESL) $L_i$. The impedances of these individual components are given by:\n-   Resistor: $Z_{R_i} = R_i$\n-   Inductor: $Z_{L_i} = j \\omega L_i$\n-   Capacitor: $Z_{C_i} = \\dfrac{1}{j \\omega C_i} = -j \\dfrac{1}{\\omega C_i}$\n\nwhere $j$ is the imaginary unit. Since these three components are in series, the total impedance of branch $i$, denoted $Z_i(\\omega)$, is the sum of their individual impedances:\n$$Z_i(\\omega) = R_i + j \\omega L_i + \\frac{1}{j \\omega C_i} = R_i + j\\left(\\omega L_i - \\frac{1}{\\omega C_i}\\right)$$\n\nStep 2: Admittance of the Capacitor Bank\n\nThe capacitor bank is formed by connecting $N$ such branches in parallel. For elements in parallel, it is convenient to work with admittance, $Y$, which is the reciprocal of impedance ($Y = 1/Z$). The total admittance of a parallel combination is the sum of the individual admittances.\nThe admittance of branch $i$ is:\n$$Y_i(\\omega) = \\frac{1}{Z_i(\\omega)} = \\frac{1}{R_i + j\\left(\\omega L_i - \\frac{1}{\\omega C_i}\\right)}$$\nThe total admittance of the bank, $Y_{\\text{bank}}(\\omega)$, is the sum over all $N$ branches:\n$$Y_{\\text{bank}}(\\omega) = \\sum_{i=1}^{N} Y_i(\\omega) = \\sum_{i=1}^{N} \\frac{1}{R_i + j\\left(\\omega L_i - \\frac{1}{\\omega C_i}\\right)}$$\n\nStep 3: Impedance of the Capacitor Bank\n\nThe total impedance of the capacitor bank, $Z_{\\text{bank}}(\\omega)$, is the reciprocal of its total admittance:\n$$Z_{\\text{bank}}(\\omega) = \\frac{1}{Y_{\\text{bank}}(\\omega)} = \\left( \\sum_{i=1}^{N} \\frac{1}{R_i + j\\left(\\omega L_i - \\frac{1}{\\omega C_i}\\right)} \\right)^{-1}$$\n\nStep 4: Total Network Impedance\n\nThe entire capacitor bank is connected in series with a shared interconnect path, which has its own resistance $R_s$ and inductance $L_s$. The impedance of this shared path, $Z_s(\\omega)$, is:\n$$Z_s(\\omega) = R_s + j \\omega L_s$$\nThe total impedance of the network, $Z_{\\text{tot}}(\\omega)$, is the series combination of the shared path and the capacitor bank:\n$$Z_{\\text{tot}}(\\omega) = Z_s(\\omega) + Z_{\\text{bank}}(\\omega)$$\nSubstituting the expressions derived above, we obtain the final formula for the total impedance as a function of angular frequency:\n$$Z_{\\text{tot}}(\\omega) = (R_s + j \\omega L_s) + \\left( \\sum_{i=1}^{N} \\frac{1}{R_i + j \\left( \\omega L_i - \\frac{1}{\\omega C_i} \\right)} \\right)^{-1}$$\nThe magnitude of this complex impedance, $|Z_{\\text{tot}}(\\omega)|$, is the scalar quantity whose local maxima we seek to identify as anti-resonances.\n\nNumerical Implementation and Peak Identification\n\nThe problem requires a numerical search for anti-resonance peaks over a specified frequency range $[f_{\\min}, f_{\\max}]$. This is accomplished through the following algorithmic procedure:\n\n1.  **Frequency Discretization**: A frequency vector $f$ is generated with $N_f = 5000$ points spaced logarithmically between $f_{\\min}$ and $f_{\\max}$. The corresponding angular frequency vector $\\omega = 2 \\pi f$ is then computed. A logarithmic scale is appropriate for wide frequency sweeps.\n\n2.  **Impedance Calculation**: Using the derived formula for $Z_{\\text{tot}}(\\omega)$, the complex impedance is calculated for each frequency point. This is efficiently implemented using vectorized operations on arrays of complex numbers. The magnitude $|Z_{\\text{tot}}(\\omega)|$ is then computed, yielding a discrete signal representing the impedance magnitude spectrum.\n\n3.  **Peak Candidate Identification**: An anti-resonance peak is defined as a local maximum in the impedance magnitude spectrum. Candidates for peaks are identified at indices $i$ where the impedance magnitude is strictly greater than its immediate neighbors: $|Z_{\\text{tot}}(f_i)| > |Z_{\\text{tot}}(f_{i-1})|$ and $|Z_{\\text{tot}}(f_i)| > |Z_{\\text{tot}}(f_{i+1})|$. This condition is equivalent to the discrete first derivative changing sign from positive to negative and ensures the discrete second derivative is negative, as specified.\n\n4.  **Prominence Filtering**: To distinguish significant anti-resonances from minor fluctuations, a relative prominence criterion is applied. For each candidate peak with height $H = |Z_{\\text{tot}}(f_{\\text{peak}})|$, a local baseline $B$ must be determined. $B$ is defined as the higher of the two nearest local minima on either side of the peak.\n    -   First, all local minima in the spectrum are identified.\n    -   For a given peak, the nearest minimum to its left and the nearest minimum to its right are located. If no minima exist on one side, the boundary value of the spectrum on that side is used instead.\n    -   The baseline $B$ is the maximum of the impedance magnitudes at these two minima.\n    -   A peak is confirmed as a valid anti-resonance if its relative prominence ratio $\\rho = H/B$ is greater than or equal to a threshold $\\alpha = 3$.\n\n5.  **Output Generation**: The frequencies of all confirmed anti-resonance peaks are collected. These frequency values are rounded to the nearest integer and formatted into the specified list structure for the final output. This process is repeated for each of the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"shared_path\": (2e-3, 5e-9),\n            \"branches\": [\n                (47e-6, 15e-3, 6e-9),\n                (1e-6, 10e-3, 2e-9),\n                (100e-9, 20e-3, 1e-9),\n            ],\n            \"freq_range\": (1e3, 1e8),\n            \"Nf\": 5000,\n            \"alpha\": 3.0,\n        },\n        # Test case 2\n        {\n            \"shared_path\": (5e-3, 5e-9),\n            \"branches\": [\n                (22e-6, 200e-3, 8e-9),\n                (1e-6, 150e-3, 4e-9),\n                (100e-9, 150e-3, 2e-9),\n            ],\n            \"freq_range\": (1e3, 1e8),\n            \"Nf\": 5000,\n            \"alpha\": 3.0,\n        },\n        # Test case 3\n        {\n            \"shared_path\": (0.5e-3, 20e-9),\n            \"branches\": [\n                (100e-6, 3e-3, 10e-9),\n                (1e-6, 3e-3, 2e-9),\n                (10e-9, 3e-3, 0.5e-9),\n            ],\n            \"freq_range\": (1e3, 1e8),\n            \"Nf\": 5000,\n            \"alpha\": 3.0,\n        },\n        # Test case 4\n        {\n            \"shared_path\": (1e-3, 10e-9),\n            \"branches\": [\n                (10e-6, 10e-3, 6e-9),\n                (100e-9, 30e-3, 1.5e-9),\n            ],\n            \"freq_range\": (1e3, 1e8),\n            \"Nf\": 5000,\n            \"alpha\": 3.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        peak_freqs = find_antiresonances(\n            case[\"shared_path\"],\n            case[\"branches\"],\n            case[\"freq_range\"],\n            case[\"Nf\"],\n            case[\"alpha\"],\n        )\n        results.append(peak_freqs)\n\n    # Format the final output string exactly as specified.\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, r))}]' for r in results])}]\"\n    print(output_str)\n\ndef find_antiresonances(shared_path, branches, freq_range, Nf, alpha):\n    \"\"\"\n    Calculates the impedance spectrum and finds anti-resonance peak frequencies.\n    \n    Args:\n        shared_path (tuple): (Rs, Ls) of the shared path.\n        branches (list of tuples): List of (C, R, L) for each capacitor branch.\n        freq_range (tuple): (f_min, f_max) for the frequency sweep.\n        Nf (int): Number of frequency points.\n        alpha (float): Relative prominence threshold.\n\n    Returns:\n        list: A list of integers representing the rounded anti-resonance frequencies in Hz.\n    \"\"\"\n    Rs, Ls = shared_path\n    f_min, f_max = freq_range\n\n    # 1. Frequency sweep\n    f = np.logspace(np.log10(f_min), np.log10(f_max), Nf)\n    omega = 2 * np.pi * f\n    j = 1j\n\n    # 2. Impedance calculation (vectorized)\n    Y_bank = np.zeros_like(omega, dtype=complex)\n    for C_i, R_i, L_i in branches:\n        # Avoid division by zero at omega=0 if f_min=0, though not the case here.\n        Z_branch = R_i + j * (omega * L_i - 1.0 / (omega * C_i))\n        Y_bank += 1.0 / Z_branch\n\n    Z_bank = 1.0 / Y_bank\n    Z_s = Rs + j * omega * Ls\n    Z_tot = Z_s + Z_bank\n    Z_mag = np.abs(Z_tot)\n\n    # 3. Find local maxima and minima indices\n    # Using array slicing for efficient comparison with neighbors\n    is_peak = (Z_mag[1:-1] > Z_mag[:-2])  (Z_mag[1:-1] > Z_mag[2:])\n    peak_indices = np.where(is_peak)[0] + 1\n\n    is_minima = (Z_mag[1:-1]  Z_mag[:-2])  (Z_mag[1:-1]  Z_mag[2:])\n    minima_indices = np.where(is_minima)[0] + 1\n    \n    # 4. Prominence check\n    valid_peak_freqs = []\n    for peak_idx in peak_indices:\n        H = Z_mag[peak_idx]\n\n        # Find nearest left minimum\n        left_minima_indices = minima_indices[minima_indices  peak_idx]\n        if left_minima_indices.size > 0:\n            min_left_val = Z_mag[left_minima_indices[-1]]\n        else:\n            min_left_val = Z_mag[0]\n\n        # Find nearest right minimum\n        right_minima_indices = minima_indices[minima_indices > peak_idx]\n        if right_minima_indices.size > 0:\n            min_right_val = Z_mag[right_minima_indices[0]]\n        else:\n            min_right_val = Z_mag[-1]\n\n        B = max(min_left_val, min_right_val)\n        \n        # Avoid division by zero and apply prominence criterion\n        if B > 1e-12: # Check against a small number\n            rho = H / B\n            if rho >= alpha:\n                valid_peak_freqs.append(int(round(f[peak_idx])))\n    \n    return valid_peak_freqs\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}