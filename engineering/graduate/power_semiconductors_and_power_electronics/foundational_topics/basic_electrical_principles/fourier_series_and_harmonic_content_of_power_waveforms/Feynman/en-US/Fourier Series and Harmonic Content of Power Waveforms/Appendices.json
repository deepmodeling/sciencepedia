{
    "hands_on_practices": [
        {
            "introduction": "Different periodic waveforms, even with the same peak voltage, can have vastly different impacts on a power system due to their harmonic content. Key metrics like the root-mean-square (RMS) value and crest factor help quantify these differences. This first exercise  builds foundational intuition by relating a waveform's time-domain \"peakiness\" to its frequency-domain energy distribution, using Parseval's theorem to analyze three fundamental shapes: the square, sine, and triangular waves.",
            "id": "3840738",
            "problem": "A single-phase high-frequency inverter is designed to drive different idealized periodic voltage waveforms at its output stage, each with the same period $T$ and the same peak magnitude $V_{\\mathrm{peak}}$. Consider three zero-average waveforms defined over one period as follows: (i) a bipolar rectangular (square) waveform taking only the two values $\\pm V_{\\mathrm{peak}}$, (ii) a sinusoidal waveform $v(t)=V_{\\mathrm{peak}}\\sin(\\omega_{0} t)$ with $\\omega_{0}=2\\pi/T$, and (iii) a symmetric triangular waveform with linear ramps between $\\pm V_{\\mathrm{peak}}$. Starting from the definition of the Fourier series for a real, periodic signal and the definition of the root-mean-square (RMS) value over one period, derive the RMS value for each waveform by invoking only orthogonality of trigonometric functions and energy conservation in Fourier series. Then compute the crest factor $\\mathrm{CF}=V_{\\mathrm{peak}}/V_{\\mathrm{rms}}$ for each waveform. Finally, briefly interpret why the crest factors differ in light of the distribution of energy among the Fourier components (fundamental and harmonics) for each waveform. Report your three crest factors, in the order (rectangular, sinusoidal, triangular), as a single row matrix. Express your final result in exact, closed form with no rounding.",
            "solution": "The problem requires the calculation of the crest factor for three distinct periodic voltage waveforms (rectangular, sinusoidal, triangular) of period $T$ and peak magnitude $V_{\\mathrm{peak}}$. The derivation must be based on the Fourier series representation and Parseval's theorem, which relates the signal's energy to the energy of its Fourier components.\n\nA real, periodic signal $v(t)$ with period $T$ and fundamental angular frequency $\\omega_0 = 2\\pi/T$ can be represented by its Fourier series:\n$$v(t) = A_0 + \\sum_{n=1}^{\\infty} \\left( A_n \\cos(n\\omega_0 t) + B_n \\sin(n\\omega_0 t) \\right)$$\nThe problem states that all waveforms have a zero average, so the DC component $A_0 = \\frac{1}{T} \\int_0^T v(t) dt = 0$.\n\nThe root-mean-square (RMS) value is defined in the time domain as $V_{\\mathrm{rms}} = \\sqrt{\\frac{1}{T} \\int_0^T v(t)^2 dt}$. The quantity $V_{\\mathrm{rms}}^2$ represents the mean-square value of the signal. According to Parseval's theorem (often interpreted as energy conservation in the frequency domain), the mean-square value is equal to the sum of the mean-square values of its Fourier components:\n$$V_{\\mathrm{rms}}^2 = \\frac{1}{T} \\int_0^T v(t)^2 dt = A_0^2 + \\frac{1}{2} \\sum_{n=1}^{\\infty} (A_n^2 + B_n^2)$$\nSince $A_0 = 0$ for the given waveforms, the formula simplifies to:\n$$V_{\\mathrm{rms}}^2 = \\frac{1}{2} \\sum_{n=1}^{\\infty} (A_n^2 + B_n^2)$$\nWe will use this relation to find the RMS value for each waveform after determining its Fourier coefficients. The crest factor ($\\mathrm{CF}$) is then computed using the definition $\\mathrm{CF} = V_{\\mathrm{peak}}/V_{\\mathrm{rms}}$.\n\n** (i) Bipolar Rectangular (Square) Waveform**\n\nWe define a symmetric square wave as an odd function centered at the origin to simplify the calculation of Fourier coefficients. This choice does not affect the RMS value.\n$$ v(t) = \\begin{cases} V_{\\mathrm{peak}} & 0 < t < T/2 \\\\ -V_{\\mathrm{peak}} & -T/2 < t < 0 \\end{cases} $$\nAs an odd function, all cosine coefficients $A_n$ are zero. The sine coefficients $B_n$ are given by:\n$$ B_n = \\frac{2}{T} \\int_{-T/2}^{T/2} v(t) \\sin(n\\omega_0 t) \\, dt = \\frac{4}{T} \\int_{0}^{T/2} V_{\\mathrm{peak}} \\sin(n\\omega_0 t) \\, dt $$\n$$ B_n = \\frac{4V_{\\mathrm{peak}}}{T} \\left[ -\\frac{\\cos(n\\omega_0 t)}{n\\omega_0} \\right]_0^{T/2} = \\frac{4V_{\\mathrm{peak}}}{T n (2\\pi/T)} [-\\cos(n\\pi) + \\cos(0)] = \\frac{2V_{\\mathrm{peak}}}{n\\pi} (1 - (-1)^n) $$\nThis means $B_n = 0$ for even $n$, and $B_n = \\frac{4V_{\\mathrm{peak}}}{n\\pi}$ for odd $n$.\n\nNow, we apply Parseval's theorem to find $V_{\\mathrm{rms}}^2$:\n$$ V_{\\mathrm{rms}}^2 = \\frac{1}{2} \\sum_{n=1,3,5,...}^{\\infty} B_n^2 = \\frac{1}{2} \\sum_{n=1,3,5,...}^{\\infty} \\left( \\frac{4V_{\\mathrm{peak}}}{n\\pi} \\right)^2 = \\frac{16V_{\\mathrm{peak}}^2}{2\\pi^2} \\sum_{k=1}^{\\infty} \\frac{1}{(2k-1)^2} $$\nThe sum of the series is a known result: $\\sum_{k=1}^{\\infty} \\frac{1}{(2k-1)^2} = \\frac{\\pi^2}{8}$.\n$$ V_{\\mathrm{rms}}^2 = \\frac{8V_{\\mathrm{peak}}^2}{\\pi^2} \\left( \\frac{\\pi^2}{8} \\right) = V_{\\mathrm{peak}}^2 $$\nThus, $V_{\\mathrm{rms}} = V_{\\mathrm{peak}}$. The crest factor is:\n$$ \\mathrm{CF}_{\\mathrm{rect}} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{rms}}} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{peak}}} = 1 $$\n\n** (ii) Sinusoidal Waveform**\n\nThe waveform is given as $v(t) = V_{\\mathrm{peak}}\\sin(\\omega_0 t)$. This expression is already in the form of a Fourier series with a single component. By inspection, the coefficients are:\n$A_n = 0$ for all $n$.\n$B_1 = V_{\\mathrm{peak}}$.\n$B_n = 0$ for $n \\ne 1$.\n\nUsing Parseval's theorem:\n$$ V_{\\mathrm{rms}}^2 = \\frac{1}{2} (A_1^2 + B_1^2) = \\frac{1}{2} (0^2 + V_{\\mathrm{peak}}^2) = \\frac{V_{\\mathrm{peak}}^2}{2} $$\nThus, $V_{\\mathrm{rms}} = \\frac{V_{\\mathrm{peak}}}{\\sqrt{2}}$. The crest factor is:\n$$ \\mathrm{CF}_{\\sin} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{rms}}} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{peak}}/\\sqrt{2}} = \\sqrt{2} $$\n\n** (iii) Symmetric Triangular Waveform**\n\nWe define a symmetric triangular wave as an even function starting at $v(0)=V_{\\mathrm{peak}}$ and reaching $v(T/2)=-V_{\\mathrm{peak}}$:\n$$ v(t) = V_{\\mathrm{peak}} \\left( 1 - \\frac{4|t|}{T} \\right), \\quad \\text{for } t \\in [-T/2, T/2] $$\nAs an even function, all sine coefficients $B_n$ are zero. The DC component $A_0=0$ is given. The cosine coefficients $A_n$ are:\n$$ A_n = \\frac{2}{T} \\int_{-T/2}^{T/2} v(t) \\cos(n\\omega_0 t) \\, dt = \\frac{4}{T} \\int_{0}^{T/2} V_{\\mathrm{peak}} \\left( 1 - \\frac{4t}{T} \\right) \\cos(n\\omega_0 t) \\, dt $$\nThe integral can be solved using integration by parts. The result is:\n$$ A_n = \\frac{4V_{\\mathrm{peak}}}{n^2\\pi^2} (1 - (-1)^n) $$\nThis means $A_n = 0$ for even $n$, and $A_n = \\frac{8V_{\\mathrm{peak}}}{n^2\\pi^2}$ for odd $n$.\n\nApplying Parseval's theorem:\n$$ V_{\\mathrm{rms}}^2 = \\frac{1}{2} \\sum_{n=1,3,5,...}^{\\infty} A_n^2 = \\frac{1}{2} \\sum_{n=1,3,5,...}^{\\infty} \\left( \\frac{8V_{\\mathrm{peak}}}{n^2\\pi^2} \\right)^2 = \\frac{64V_{\\mathrm{peak}}^2}{2\\pi^4} \\sum_{k=1}^{\\infty} \\frac{1}{(2k-1)^4} $$\nThe sum of this series is known: $\\sum_{k=1}^{\\infty} \\frac{1}{(2k-1)^4} = \\frac{\\pi^4}{96}$.\n$$ V_{\\mathrm{rms}}^2 = \\frac{32V_{\\mathrm{peak}}^2}{\\pi^4} \\left( \\frac{\\pi^4}{96} \\right) = \\frac{32}{96} V_{\\mathrm{peak}}^2 = \\frac{1}{3} V_{\\mathrm{peak}}^2 $$\nThus, $V_{\\mathrm{rms}} = \\frac{V_{\\mathrm{peak}}}{\\sqrt{3}}$. The crest factor is:\n$$ \\mathrm{CF}_{\\mathrm{tri}} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{rms}}} = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{peak}}/\\sqrt{3}} = \\sqrt{3} $$\n\n**Interpretation of Crest Factors**\n\nThe crest factor, $\\mathrm{CF} = V_{\\mathrm{peak}}/V_{\\mathrm{rms}}$, measures the \"peakiness\" of a waveform. The differing values—$\\mathrm{CF}_{\\mathrm{rect}}=1$, $\\mathrm{CF}_{\\sin}=\\sqrt{2}$, $\\mathrm{CF}_{\\mathrm{tri}}=\\sqrt{3}$—can be understood from how the signal's energy is distributed across its Fourier components, which in turn dictates the waveform's shape.\n- The **rectangular wave** has a crest factor of $1$ because its instantaneous magnitude is always equal to its peak magnitude, $|v(t)|=V_{\\mathrm{peak}}$. This maximizes the RMS value for a given $V_{\\mathrm{peak}}$. Its energy is spread across many harmonics whose amplitudes decay slowly (proportional to $1/n$), a characteristic of waveforms with sharp discontinuities.\n- The **sinusoidal wave** has all its energy concentrated in a single frequency component (the fundamental). It reaches its peak value only instantaneously. Its RMS value is lower than its peak, resulting in $\\mathrm{CF}=\\sqrt{2}$. This serves as a reference case with no harmonic content.\n- The **triangular wave** has an even higher crest factor of $\\sqrt{3}$. Its harmonic amplitudes decay rapidly (proportional to $1/n^2$), meaning most of its energy is in the fundamental and low-order harmonics. In the time domain, the waveform is more \"peaked\" or \"pointed\" than a sinusoid, spending proportionally more time at values far from its peak. This leads to a lower RMS value for the same peak voltage and, consequently, a higher crest factor.\nIn summary, a higher crest factor corresponds to a more \"peaky\" waveform, whose energy is concentrated in a narrower distribution of lower-frequency harmonics (for non-sinusoidal waves) but whose time-domain shape results in a lower effective (RMS) value relative to its peak.\n\nThe final answer is the row matrix of the three calculated crest factors.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\sqrt{2} & \\sqrt{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from idealized shapes to a common waveform in power electronics, we next analyze the triangular ripple current found in the inductor of a switching converter. This practice  involves deriving the harmonic spectrum of this continuous, piecewise-linear waveform from first principles. It is a valuable exercise that not only demonstrates a powerful analytical technique but also reveals a fundamental principle of Fourier analysis: the smoothness of a waveform dictates how quickly its harmonics decay, in this case, proportional to $1/n^2$.",
            "id": "3840662",
            "problem": "An ideal step-down direct current (DC) to DC buck converter operates in continuous conduction mode (CCM) at switching period $T_{s}$ with duty ratio $D \\in (0,1)$. The inductor current $i_{L}(t)$ is periodic with period $T_{s}$ and consists of a constant DC component $I_{0}$ superposed with a zero-mean triangular ripple $i_{r}(t)$ of peak-to-peak amplitude $\\Delta I$, so that $i_{L}(t) = I_{0} + i_{r}(t)$. Over each switching period, the ripple is defined by the piecewise-linear waveform\n$$\ni_{r}(t) =\n\\begin{cases}\n-\\dfrac{\\Delta I}{2} + \\dfrac{\\Delta I}{D T_{s}}\\, t, & 0 \\le t  D T_{s} \\\\\n+\\dfrac{\\Delta I}{2} - \\dfrac{\\Delta I}{(1-D) T_{s}}\\, (t - D T_{s}),  D T_{s} \\le t  T_{s}\n\\end{cases}\n$$\nwhich ensures continuity and zero average over one period. Let the fundamental angular frequency be $\\omega_{0} = 2\\pi/T_{s}$, and let the imaginary unit be $\\mathrm{j}$ with $\\mathrm{j}^{2} = -1$.\n\nStarting from first principles, including the definition of the complex Fourier series coefficients for a periodic function,\n$$\nc_{n} = \\frac{1}{T_{s}} \\int_{0}^{T_{s}} i_{r}(t)\\, \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t,\\quad n \\in \\mathbb{Z},\n$$\nderive a closed-form expression for the magnitude of the $n$th harmonic of the ripple current, $|I_{n}|$, for positive integer $n$, in terms of $D$, $\\Delta I$, and $n$. Your final answer must be a single explicit analytic expression for $|I_{n}|$ that makes the harmonic decay rate with $n$ evident. Do not provide intermediate steps in the final answer. No numerical evaluation is required. Express angles implicitly in radians. The final answer must be a single expression.",
            "solution": "The problem requires the derivation of a closed-form expression for the magnitude of the $n$th harmonic of the inductor current ripple, $|I_{n}|$, in a DC-DC buck converter. The ripple current, $i_r(t)$, is a periodic function with period $T_s$. Its complex Fourier series coefficients, denoted $c_n$ for $n \\in \\mathbb{Z}$, are given by the formula:\n$$\nc_{n} = \\frac{1}{T_{s}} \\int_{0}^{T_{s}} i_{r}(t)\\, \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t\n$$\nwhere $\\omega_{0} = 2\\pi/T_{s}$ is the fundamental angular frequency and $\\mathrm{j}$ is the imaginary unit. We seek an expression for $|I_n| = |c_n|$ for positive integers $n$.\n\nThe direct calculation of this integral involves integrating a piecewise-linear function, which can be tedious. A more elegant approach, rooted in first principles, is to relate the Fourier coefficients of $i_r(t)$ to those of its derivative, $i_r'(t)$. Let $c_n(f)$ denote the $n$th Fourier coefficient of a function $f(t)$. For $n \\ne 0$, we can use integration by parts on the definition of $c_{n}(i_r)$:\n$$\nc_{n}(i_r) = \\frac{1}{T_{s}} \\int_{0}^{T_{s}} i_{r}(t)\\, \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t\n$$\nLet $u = i_r(t)$ and $dv = \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t$. Then $du = i_r'(t)\\, \\mathrm{d}t$ and $v = \\frac{\\exp(-\\mathrm{j} n \\omega_{0} t)}{-\\mathrm{j} n \\omega_{0}}$.\n$$\nc_{n}(i_r) = \\frac{1}{T_{s}} \\left( \\left[ i_{r}(t) \\frac{\\exp(-\\mathrm{j} n \\omega_{0} t)}{-\\mathrm{j} n \\omega_{0}} \\right]_{0}^{T_{s}} - \\int_{0}^{T_{s}} \\frac{\\exp(-\\mathrm{j} n \\omega_{0} t)}{-\\mathrm{j} n \\omega_{0}} i_r'(t)\\, \\mathrm{d}t \\right)\n$$\nThe boundary term is evaluated as:\n$$\n\\frac{1}{-\\mathrm{j} n \\omega_{0}} \\left( i_{r}(T_{s})\\exp(-\\mathrm{j} n \\omega_{0} T_{s}) - i_{r}(0)\\exp(0) \\right)\n$$\nThe ripple waveform $i_r(t)$ is periodic with period $T_s$, so $i_r(T_s) = i_r(0)$. Also, $\\exp(-\\mathrm{j} n \\omega_{0} T_{s}) = \\exp(-\\mathrm{j} n (2\\pi/T_s) T_s) = \\exp(-\\mathrm{j} 2\\pi n) = 1$ for any integer $n$. The problem states that $i_r(t)$ is continuous. Therefore, the boundary term is zero.\n$$\n\\left[ i_{r}(t) \\frac{\\exp(-\\mathrm{j} n \\omega_{0} t)}{-\\mathrm{j} n \\omega_{0}} \\right]_{0}^{T_{s}} = \\frac{1}{-\\mathrm{j} n \\omega_{0}} (i_r(T_s) \\cdot 1 - i_r(0) \\cdot 1) = 0\n$$\nThis simplifies the expression for $c_n(i_r)$:\n$$\nc_{n}(i_r) = \\frac{1}{T_{s}} \\int_{0}^{T_{s}} \\frac{1}{\\mathrm{j} n \\omega_{0}} i_r'(t) \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t = \\frac{1}{\\mathrm{j} n \\omega_{0}} \\left( \\frac{1}{T_{s}} \\int_{0}^{T_{s}} i_r'(t) \\exp(-\\mathrm{j} n \\omega_{0} t)\\, \\mathrm{d}t \\right)\n$$\nThe term in the parenthesis is the definition of the $n$th Fourier coefficient of the derivative, $c_n(i_r')$. Thus, for $n \\ne 0$:\n$$\nc_{n}(i_r) = \\frac{c_{n}(i_r')}{\\mathrm{j} n \\omega_{0}}\n$$\nWe now proceed by finding the derivative $i_r'(t)$ from the given piecewise definition of $i_r(t)$:\n$$\ni_{r}'(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} i_r(t) =\n\\begin{cases}\n\\dfrac{\\Delta I}{D T_{s}},  0  t  D T_{s} \\\\\n-\\dfrac{\\Delta I}{(1-D) T_{s}},  D T_{s}  t  T_{s}\n\\end{cases}\n$$\nThis is a piecewise-constant function. Its Fourier coefficients $c_n(i_r')$ are calculated as:\n$$\nc_{n}(i_r') = \\frac{1}{T_{s}} \\left( \\int_{0}^{D T_{s}} \\frac{\\Delta I}{D T_{s}} \\exp(-\\mathrm{j} n \\omega_{0} t)\\,\\mathrm{d}t + \\int_{D T_{s}}^{T_{s}} \\frac{-\\Delta I}{(1-D) T_{s}} \\exp(-\\mathrm{j} n \\omega_{0} t)\\,\\mathrm{d}t \\right)\n$$\nEvaluating the integrals:\n$$\n\\int \\exp(-\\mathrm{j} n \\omega_{0} t)\\,\\mathrm{d}t = \\frac{\\exp(-\\mathrm{j} n \\omega_{0} t)}{-\\mathrm{j} n \\omega_{0}}\n$$\nFor the first interval:\n$$\n\\int_{0}^{D T_{s}} \\exp(-\\mathrm{j} n \\omega_{0} t)\\,\\mathrm{d}t = \\frac{\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1}{-\\mathrm{j} n \\omega_{0}}\n$$\nFor the second interval:\n$$\n\\int_{D T_{s}}^{T_{s}} \\exp(-\\mathrm{j} n \\omega_{0} t)\\,\\mathrm{d}t = \\frac{\\exp(-\\mathrm{j} n \\omega_{0} T_{s}) - \\exp(-\\mathrm{j} n \\omega_{0} D T_{s})}{-\\mathrm{j} n \\omega_{0}} = \\frac{1 - \\exp(-\\mathrm{j} n \\omega_{0} D T_{s})}{-\\mathrm{j} n \\omega_{0}}\n$$\nSubstituting these into the expression for $c_n(i_r')$:\n$$\nc_{n}(i_r') = \\frac{1}{T_{s}} \\frac{1}{-\\mathrm{j} n \\omega_{0}} \\left( \\frac{\\Delta I}{D T_{s}} (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1) - \\frac{\\Delta I}{(1-D) T_{s}} (1 - \\exp(-\\mathrm{j} n \\omega_{0} D T_{s})) \\right)\n$$\nFactoring out common terms:\n$$\nc_{n}(i_r') = \\frac{\\Delta I}{T_s^2(-\\mathrm{j} n \\omega_{0})} (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1) \\left( \\frac{1}{D} + \\frac{1}{1-D} \\right)\n$$\nSimplifying the term in the last parenthesis: $\\frac{1}{D} + \\frac{1}{1-D} = \\frac{(1-D)+D}{D(1-D)} = \\frac{1}{D(1-D)}$.\n$$\nc_{n}(i_r') = \\frac{\\Delta I}{-\\mathrm{j} n \\omega_{0} T_s^2 D(1-D)} (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1)\n$$\nNow we find $c_n(i_r)$:\n$$\nc_{n}(i_r) = \\frac{c_{n}(i_r')}{\\mathrm{j} n \\omega_{0}} = \\frac{1}{\\mathrm{j} n \\omega_{0}} \\left( \\frac{\\Delta I (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1)}{-\\mathrm{j} n \\omega_{0} T_s^2 D(1-D)} \\right)\n$$\n$$\nc_{n}(i_r) = \\frac{\\Delta I (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1)}{-(\\mathrm{j} n \\omega_{0})^2 T_s^2 D(1-D)} = \\frac{\\Delta I (\\exp(-\\mathrm{j} n \\omega_{0} D T_{s}) - 1)}{n^2 \\omega_{0}^2 T_s^2 D(1-D)}\n$$\nSubstitute $\\omega_0 = 2\\pi/T_s$:\n$$\nc_{n}(i_r) = \\frac{\\Delta I (\\exp(-\\mathrm{j} n (2\\pi/T_s) D T_{s}) - 1)}{n^2 (2\\pi/T_s)^2 T_s^2 D(1-D)} = \\frac{\\Delta I (\\exp(-\\mathrm{j} 2\\pi n D) - 1)}{4 \\pi^2 n^2 D(1-D)}\n$$\nWe are asked for the magnitude, $|I_n| = |c_n(i_r)|$:\n$$\n|I_n| = \\left| \\frac{\\Delta I}{4 \\pi^2 n^2 D(1-D)} \\right| \\cdot |\\exp(-\\mathrm{j} 2\\pi n D) - 1|\n$$\nSince $\\Delta I  0$, $D \\in (0,1)$, and $n \\ge 1$, the first term is positive. We evaluate the magnitude of the complex term:\n$$\n|\\exp(-\\mathrm{j}\\theta) - 1|^2 = |\\cos\\theta - \\mathrm{j}\\sin\\theta - 1|^2 = (\\cos\\theta - 1)^2 + (-\\sin\\theta)^2 = \\cos^2\\theta - 2\\cos\\theta + 1 + \\sin^2\\theta = 2 - 2\\cos\\theta\n$$\nUsing the half-angle identity $1-\\cos\\theta = 2\\sin^2(\\theta/2)$, we get:\n$$\n|\\exp(-\\mathrm{j}\\theta) - 1|^2 = 2(2\\sin^2(\\theta/2)) = 4\\sin^2(\\theta/2)\n$$\nTaking the square root, $|\\exp(-\\mathrm{j}\\theta) - 1| = 2|\\sin(\\theta/2)|$. With $\\theta = 2\\pi n D$, this becomes:\n$$\n|\\exp(-\\mathrm{j} 2\\pi n D) - 1| = 2|\\sin(\\pi n D)|\n$$\nSubstituting this result back into the expression for $|I_n|$:\n$$\n|I_n| = \\frac{\\Delta I}{4 \\pi^2 n^2 D(1-D)} \\cdot 2|\\sin(\\pi n D)|\n$$\nThis simplifies to the final closed-form expression:\n$$\n|I_n| = \\frac{\\Delta I |\\sin(\\pi n D)|}{2 \\pi^2 n^2 D(1-D)}\n$$\nThis expression clearly shows that the magnitude of the harmonics decays with the square of the harmonic number, $n$, i.e., $|I_n| \\propto 1/n^2$, which is characteristic of continuous, piecewise-linear (triangular) waveforms.",
            "answer": "$$\n\\boxed{\\frac{\\Delta I |\\sin(\\pi n D)|}{2 \\pi^{2} n^{2} D(1-D)}}\n$$"
        },
        {
            "introduction": "Our final practice expands the scope from single-phase waveforms to three-phase systems, which are the cornerstone of industrial power conversion. We will dissect the line-to-line voltage of a classic two-level, six-step inverter, a fundamental topology in motor drives. This analysis  is critical as it uncovers the powerful concept of harmonic cancellation, showing how the inherent symmetry of a three-phase system naturally eliminates entire families of harmonics—the so-called triplen harmonics—greatly improving power quality and simplifying filter design.",
            "id": "3840668",
            "problem": "A two-level, three-phase voltage-source inverter is supplied by a direct current bus of magnitude $V_{\\mathrm{dc}}$. In six-step operation with $120^{\\circ}$ conduction per phase leg, the three phase-leg switching functions are idealized as $S_{a}(t) = \\operatorname{sgn}(\\sin(\\omega t))$, $S_{b}(t) = \\operatorname{sgn}(\\sin(\\omega t - 2\\pi/3))$, and $S_{c}(t) = \\operatorname{sgn}(\\sin(\\omega t - 4\\pi/3))$, where $\\omega$ is the fundamental angular frequency. The line-to-line voltage between phases $a$ and $b$ is $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}\\big(S_{a}(t) - S_{b}(t)\\big)$. The waveform $v_{ab}(t)$ is periodic with electrical period $T = \\frac{2\\pi}{\\omega}$, and it possesses the half-wave symmetry $v_{ab}(t + \\frac{\\pi}{\\omega}) = -v_{ab}(t)$.\n\nStarting from the standard Fourier series definitions for a real, periodic function,\n$$\nv_{ab}(t) = \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty}\\left(a_{n}\\cos(n\\omega t) + b_{n}\\sin(n\\omega t)\\right),\\quad\na_{n} = \\frac{\\omega}{\\pi}\\int_{0}^{\\frac{2\\pi}{\\omega}} v_{ab}(t)\\cos(n\\omega t)\\,\\mathrm{d}t,\\quad\nb_{n} = \\frac{\\omega}{\\pi}\\int_{0}^{\\frac{2\\pi}{\\omega}} v_{ab}(t)\\sin(n\\omega t)\\,\\mathrm{d}t,\n$$\nderive the complete Fourier series of $v_{ab}(t)$ as a closed-form analytic expression in terms of $V_{\\mathrm{dc}}$, and determine the family of harmonic orders for which the sine coefficients are nonzero. Express angles in radians. The final answer must be provided as:\n\n- A single analytic expression for $v_{ab}(t)$ as a Fourier series.\n- The set of harmonic orders stated as a single analytic set expression, characterizing all nonzero harmonic orders.\n\nNo numerical evaluation or rounding is required. The final answer must be an analytic expression. Angles must be in radians.",
            "solution": "The problem requires the derivation of the Fourier series for the line-to-line voltage $v_{ab}(t)$ of a three-phase six-step inverter and the identification of harmonic orders with nonzero sine coefficients.\n\nThe line-to-line voltage is given by $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}\\big(S_{a}(t) - S_{b}(t)\\big)$, where $S_{a}(t) = \\operatorname{sgn}(\\sin(\\omega t))$ and $S_{b}(t) = \\operatorname{sgn}(\\sin(\\omega t - 2\\pi/3))$. The signum function, $\\operatorname{sgn}(x)$, is $+1$ for $x0$ and $-1$ for $x0$. Let us define the waveform of $v_{ab}(t)$ over one period, $T=2\\pi/\\omega$. Let $\\theta = \\omega t$.\n\nFirst, we analyze the switching functions over the interval $\\theta \\in [0, 2\\pi]$:\n- $S_a(t) = \\operatorname{sgn}(\\sin(\\theta))$ is $+1$ for $\\theta \\in (0, \\pi)$ and $-1$ for $\\theta \\in (\\pi, 2\\pi)$.\n- $S_b(t) = \\operatorname{sgn}(\\sin(\\theta - 2\\pi/3))$ is $+1$ for $\\theta - 2\\pi/3 \\in (0, \\pi)$, which means $\\theta \\in (2\\pi/3, 5\\pi/3)$. It is $-1$ for $\\theta - 2\\pi/3 \\in (\\pi, 2\\pi)$, which means $\\theta \\in (5\\pi/3, 8\\pi/3) \\equiv (5\\pi/3, 2\\pi) \\cup (0, 2\\pi/3)$.\n\nNow, we construct the waveform for $v_{ab}(t)$ based on $S_a(t) - S_b(t)$:\n- For $\\theta \\in (0, 2\\pi/3)$: $S_a = +1$, $S_b = -1$.\n  $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}(1 - (-1)) = V_{\\mathrm{dc}}$.\n- For $\\theta \\in (2\\pi/3, \\pi)$: $S_a = +1$, $S_b = +1$.\n  $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}(1 - 1) = 0$.\n- For $\\theta \\in (\\pi, 5\\pi/3)$: $S_a = -1$, $S_b = +1$.\n  $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}(-1 - 1) = -V_{\\mathrm{dc}}$.\n- For $\\theta \\in (5\\pi/3, 2\\pi)$: $S_a = -1$, $S_b = -1$.\n  $v_{ab}(t) = \\frac{V_{\\mathrm{dc}}}{2}(-1 - (-1)) = 0$.\n\nThe waveform $v_{ab}(t)$ possesses half-wave symmetry, $v_{ab}(t + T/2) = -v_{ab}(t)$, as stated in the problem. This property implies that the DC component $a_0$ is zero and that all even harmonic coefficients ($a_n, b_n$ for even $n$) are zero. The coefficients for odd harmonics $n$ can be calculated by integrating over half a period:\n$$a_n = \\frac{2}{T}\\int_{0}^{T}v_{ab}(t)\\cos(n\\omega t)\\,\\mathrm{d}t = \\frac{4}{T}\\int_{0}^{T/2}v_{ab}(t)\\cos(n\\omega t)\\,\\mathrm{d}t = \\frac{2\\omega}{\\pi}\\int_{0}^{\\pi/\\omega}v_{ab}(t)\\cos(n\\omega t)\\,\\mathrm{d}t$$\n$$b_n = \\frac{2}{T}\\int_{0}^{T}v_{ab}(t)\\sin(n\\omega t)\\,\\mathrm{d}t = \\frac{4}{T}\\int_{0}^{T/2}v_ab(t)\\sin(n\\omega t)\\,\\mathrm{d}t = \\frac{2\\omega}{\\pi}\\int_{0}^{\\pi/\\omega}v_{ab}(t)\\sin(n\\omega t)\\,\\mathrm{d}t$$\nThese expressions are valid for odd $n$ only.\n\nLet's perform the integration with the substitution $\\theta = \\omega t$, so $\\mathrm{d}t = \\mathrm{d}\\theta/\\omega$. The integration interval becomes $[0, \\pi]$.\nFor odd $n$:\n$$a_n = \\frac{2}{\\pi}\\int_{0}^{\\pi}v_{ab}(\\theta/\\omega)\\cos(n\\theta)\\,\\mathrm{d}\\theta$$\n$$b_n = \\frac{2}{\\pi}\\int_{0}^{\\pi}v_{ab}(\\theta/\\omega)\\sin(n\\theta)\\,\\mathrm{d}\\theta$$\nOver the interval $\\theta \\in [0, \\pi]$, the voltage is $V_{\\mathrm{dc}}$ for $\\theta \\in [0, 2\\pi/3]$ and $0$ for $\\theta \\in [2\\pi/3, \\pi]$.\n\nCalculation of $a_n$ for odd $n$:\n$$a_n = \\frac{2}{\\pi} \\left[ \\int_{0}^{2\\pi/3} V_{\\mathrm{dc}}\\cos(n\\theta)\\,\\mathrm{d}\\theta + \\int_{2\\pi/3}^{\\pi} 0 \\cdot \\cos(n\\theta)\\,\\mathrm{d}\\theta \\right] = \\frac{2V_{\\mathrm{dc}}}{\\pi} \\left[ \\frac{\\sin(n\\theta)}{n} \\right]_{0}^{2\\pi/3}$$\n$$a_n = \\frac{2V_{\\mathrm{dc}}}{n\\pi} \\left( \\sin\\left(\\frac{2n\\pi}{3}\\right) - \\sin(0) \\right) = \\frac{2V_{\\mathrm{dc}}}{n\\pi}\\sin\\left(\\frac{2n\\pi}{3}\\right)$$\n\nCalculation of $b_n$ for odd $n$:\n$$b_n = \\frac{2}{\\pi} \\left[ \\int_{0}^{2\\pi/3} V_{\\mathrm{dc}}\\sin(n\\theta)\\,\\mathrm{d}\\theta \\right] = \\frac{2V_{\\mathrm{dc}}}{\\pi} \\left[ -\\frac{\\cos(n\\theta)}{n} \\right]_{0}^{2\\pi/3}$$\n$$b_n = \\frac{2V_{\\mathrm{dc}}}{n\\pi} \\left( -\\cos\\left(\\frac{2n\\pi}{3}\\right) - (-\\cos(0)) \\right) = \\frac{2V_{\\mathrm{dc}}}{n\\pi}\\left(1 - \\cos\\left(\\frac{2n\\pi}{3}\\right)\\right)$$\n\nSo, the Fourier series for $v_{ab}(t)$ is:\n$$v_{ab}(t) = \\sum_{n=1, \\text{odd}}^{\\infty} \\left( a_n\\cos(n\\omega t) + b_n\\sin(n\\omega t) \\right)$$\n$$v_{ab}(t) = \\sum_{n=1, \\text{odd}}^{\\infty} \\frac{2V_{\\mathrm{dc}}}{n\\pi} \\left[ \\sin\\left(\\frac{2n\\pi}{3}\\right)\\cos(n\\omega t) + \\left(1 - \\cos\\left(\\frac{2n\\pi}{3}\\right)\\right)\\sin(n\\omega t) \\right]$$\nWe can simplify the term in the square brackets using trigonometric identities. Let $A = n\\omega t$ and $B = 2n\\pi/3$. The term is $\\sin(B)\\cos(A) + (1-\\cos(B))\\sin(A)$.\nUsing $1-\\cos(B) = 2\\sin^2(B/2)$ and $\\sin(B) = 2\\sin(B/2)\\cos(B/2)$, the term becomes:\n$$2\\sin(B/2)\\cos(B/2)\\cos(A) + 2\\sin^2(B/2)\\sin(A) = 2\\sin(B/2) \\left[ \\cos(B/2)\\cos(A) + \\sin(B/2)\\sin(A) \\right]$$\n$$= 2\\sin(B/2)\\cos(A-B/2)$$\nSubstituting back $A=n\\omega t$ and $B=2n\\pi/3$, so $B/2 = n\\pi/3$:\n$$2\\sin\\left(\\frac{n\\pi}{3}\\right)\\cos\\left(n\\omega t - \\frac{n\\pi}{3}\\right)$$\nSubstituting this back into the series expression for $v_{ab}(t)$:\n$$v_{ab}(t) = \\sum_{n=1, \\text{odd}}^{\\infty} \\frac{2V_{\\mathrm{dc}}}{n\\pi} \\left[ 2\\sin\\left(\\frac{n\\pi}{3}\\right)\\cos\\left(n\\omega t - \\frac{n\\pi}{3}\\right) \\right]$$\n$$v_{ab}(t) = \\frac{4V_{\\mathrm{dc}}}{\\pi} \\sum_{n=1, \\text{odd}}^{\\infty} \\frac{1}{n}\\sin\\left(\\frac{n\\pi}{3}\\right)\\cos\\left(n\\omega t - \\frac{n\\pi}{3}\\right)$$\nThis is the complete Fourier series as a single closed-form analytic expression. The sum is over odd $n$ because of the half-wave symmetry. The term $\\sin(n\\pi/3)$ is zero for any $n$ that is a multiple of $3$, correctly eliminating the triplen harmonics.\n\nNext, we must determine the family of harmonic orders $n$ for which the sine coefficients $b_n$ are nonzero. The expression for $b_n$ for odd $n$ is:\n$$b_n = \\frac{2V_{\\mathrm{dc}}}{n\\pi}\\left(1 - \\cos\\left(\\frac{2n\\pi}{3}\\right)\\right)$$\nFor $b_n$ to be nonzero, two conditions must be met:\n1. $n$ must be odd (due to half-wave symmetry).\n2. $1 - \\cos(2n\\pi/3) \\neq 0$, which implies $\\cos(2n\\pi/3) \\neq 1$.\nThe cosine function equals $1$ when its argument is an integer multiple of $2\\pi$.\n$$\\frac{2n\\pi}{3} = 2k\\pi \\quad \\text{for some integer } k$$\n$$\\frac{n}{3} = k \\implies n = 3k$$\nThis means that $b_n$ is zero if $n$ is a multiple of $3$.\nTherefore, for $b_n$ to be nonzero, the harmonic order $n$ must be an odd integer that is not a multiple of $3$.\n\nAn integer is odd if it is not divisible by $2$. An integer is not a multiple of $3$ if it is not divisible by $3$. The set of positive integers $n$ that are not divisible by $2$ and not divisible by $3$ are the positive integers that are coprime to $6$. This can be expressed as the set $\\{n \\in \\mathbb{Z}^+ \\mid \\gcd(n, 6) = 1\\}$. This set corresponds to harmonic orders $n=1, 5, 7, 11, 13, 17, \\dots$, which can also be written in the form $6k \\pm 1$ for positive integers $k$, plus the case $n=1$ ($k=0$ for $6k+1$). The set notation is the most compact and formal description.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4V_{\\mathrm{dc}}}{\\pi} \\sum_{n=1, \\text{odd}}^{\\infty} \\frac{1}{n}\\sin\\left(\\frac{n\\pi}{3}\\right)\\cos\\left(n\\omega t - \\frac{n\\pi}{3}\\right)  \\{n \\in \\mathbb{Z}^+ \\mid \\gcd(n, 6) = 1\\}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}