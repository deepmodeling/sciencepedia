{
    "hands_on_practices": [
        {
            "introduction": "本练习将探讨如何从一个给定的电容器电流波形出发，精确计算其产生的电压纹波和有效值电流。这个基础练习旨在强化对电容器基本定律 $i_C = C \\frac{dv_C}{dt}$ 的运用，这是所有电力电子设计中电容选型和纹波分析的基石。通过这个练习，你将掌握从时域电流波形推导关键性能指标的核心技能 。",
            "id": "3825580",
            "problem": "一个工作在连续导通模式下的同步降压转换器驱动一个电容为 $C$ 的输出电容器。在一个开关周期 $T$ 内，由功率级和电感动态产生的电容器电流 $i_{C}(t)$ 可以很好地近似为一个关于零点对称的三角波形，其峰值为 $\\hat{I}$，且每个周期内的平均值为零（电容器电荷平衡）。明确地，假设\n$$\ni_{C}(t)=\\begin{cases}\n-\\hat{I}+\\dfrac{4\\hat{I}}{T}t,  0 \\le t \\le \\dfrac{T}{2} \\\\\n\\hat{I}-\\dfrac{4\\hat{I}}{T}\\left(t-\\dfrac{T}{2}\\right),  \\dfrac{T}{2}  t \\le T\n\\end{cases}\n$$\n请计算电容器的峰峰值电压纹波 $\\Delta v_{C,pp}$ 和电容器电流的有效值 $I_{C,rms}$。",
            "solution": "### 步骤 1：计算峰峰值电压纹波 ($\\Delta v_{C,pp}$)\n\n电容器两端的电压 $v_C(t)$ 与流过它的电流 $i_C(t)$ 的关系为 $i_C(t) = C \\frac{dv_C(t)}{dt}$。因此，电压的变化量可以通过对电流进行积分得到：\n$$ \\Delta v_C = v_C(t_2) - v_C(t_1) = \\frac{1}{C} \\int_{t_1}^{t_2} i_C(t) dt $$\n峰峰值电压纹波 $\\Delta v_{C,pp}$ 是一个周期内电压的最大值与最小值之差。对于给定的三角电流波形，电压将在电流为正的区间内上升，在电流为负的区间内下降。电压的极值点出现在电流过零的时刻。\n从电流方程可知，$i_C(t)$ 在 $t=T/4$ 和 $t=3T/4$ 时过零。电容器从 $t=T/4$ 到 $t=3T/4$ 充电，其间累积的电荷量 $\\Delta Q$ 导致了从电压谷值到峰值的变化。\n$\\Delta Q$ 等于该时间段内电流波形与时间轴围成的面积。这是一个底为 $(3T/4 - T/4) = T/2$、高为 $\\hat{I}$ 的三角形。\n$$ \\Delta Q = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times \\frac{T}{2} \\times \\hat{I} = \\frac{\\hat{I}T}{4} $$\n因此，峰峰值电压纹波为：\n$$ \\Delta v_{C,pp} = \\frac{\\Delta Q}{C} = \\frac{\\hat{I}T}{4C} $$\n\n### 步骤 2：计算电流有效值 ($I_{C,rms}$)\n\n电流的有效值 (RMS) 定义为：\n$$ I_{C,rms} = \\sqrt{\\frac{1}{T} \\int_0^T i_C(t)^2 dt} $$\n由于电流波形在两个半周期内是对称的，我们可以只计算前半个周期（从 0 到 $T/2$）的积分，然后乘以2来得到整个周期的积分值。\n$$ \\int_0^T i_C(t)^2 dt = 2 \\int_0^{T/2} i_C(t)^2 dt = 2 \\int_0^{T/2} \\left(-\\hat{I}+\\frac{4\\hat{I}}{T}t\\right)^2 dt $$\n$$ = 2 \\hat{I}^2 \\int_0^{T/2} \\left(-1+\\frac{4}{T}t\\right)^2 dt $$\n为了方便积分，我们进行换元。令 $u = -1+\\frac{4}{T}t$，则 $du = \\frac{4}{T}dt$，即 $dt = \\frac{T}{4}du$。\n当 $t=0$ 时，$u=-1$。当 $t=T/2$ 时，$u=1$。\n$$ \\int_0^{T/2} \\left(-1+\\frac{4}{T}t\\right)^2 dt = \\int_{-1}^{1} u^2 \\left(\\frac{T}{4}du\\right) = \\frac{T}{4} \\left[ \\frac{u^3}{3} \\right]_{-1}^{1} = \\frac{T}{4} \\left( \\frac{1^3}{3} - \\frac{(-1)^3}{3} \\right) = \\frac{T}{4} \\left(\\frac{1}{3} - (-\\frac{1}{3})\\right) = \\frac{T}{4} \\cdot \\frac{2}{3} = \\frac{T}{6} $$\n将此结果代回原式：\n$$ \\int_0^T i_C(t)^2 dt = 2 \\hat{I}^2 \\left( \\frac{T}{6} \\right) = \\frac{\\hat{I}^2 T}{3} $$\n最后，计算有效值：\n$$ I_{C,rms} = \\sqrt{\\frac{1}{T} \\left( \\frac{\\hat{I}^2 T}{3} \\right)} = \\sqrt{\\frac{\\hat{I}^2}{3}} = \\frac{\\hat{I}}{\\sqrt{3}} $$\n\n### 最终答案\n峰峰值电压纹波为 $\\dfrac{\\hat{I}T}{4C}$，电流有效值为 $\\dfrac{\\hat{I}}{\\sqrt{3}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\dfrac{\\hat{I}T}{4C}  \\dfrac{\\hat{I}}{\\sqrt{3}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实际应用中，电容器并非理想元件，其等效串联电阻 ($R_{\\mathrm{ESR}}$) 对电路性能有显著影响。本练习将指导你分析一个包含 ESR 的直流环节电容器，并学会如何将总电压纹波分解为由电容充放电引起的“容性纹波”和由 ESR 上的电流变化引起的“阻性纹波”。这种区分对于精确设计滤波器、评估元器件损耗以及在实际硬件中诊断纹波问题至关重要 。",
            "id": "3825556",
            "problem": "一个三相两电平电压源逆变器 (VSI) 从一个具有有限等效串联电阻 (ESR) 的直流环节电容器中吸取脉动的直流 (DC) 环节电流。在每个开关周期内，直流环节电流可以很好地近似为分段恒定：在持续时间为 $D T_{s}$ 的有功矢量区间内，电流等于 $I_{1}$；在持续时间为 $(1-D) T_{s}$ 的零矢量区间内，电流等于 $I_{2}$。直流环节电容器的电容为 $C$，ESR 为 $R_{\\mathrm{ESR}}$。直流源提供周期平均电流；因此，电容器仅提供直流环节电流的交流分量。假设周期性稳态，并忽略任何寄生电感。\n\n给定参数 $C = 2.2\\,\\mathrm{mF}$，$R_{\\mathrm{ESR}} = 25\\,\\mathrm{m}\\Omega$，$f_{s} = 20\\,\\mathrm{kHz}$ (因此 $T_{s} = 1/f_{s}$)，$D = 0.30$，$I_{1} = 18\\,\\mathrm{A}$ 和 $I_{2} = 4\\,\\mathrm{A}$，利用电容器在一个开关周期内的电荷平衡，分别确定由电容器有限的 ESR 及其电抗性储能引起的直流环节电压峰峰值纹波，然后将总峰峰值纹波作为一个单独的值提供。具体来说：\n\n- 根据电容器电流和电压之间的关系，从第一性原理推导电容器在一个周期内的电抗性电压纹波。\n- 在给定电流波形下，推导由有限 ESR 引起的 ESR 上的电阻压降，并将其与电抗性纹波分开。\n- 结合这些贡献以获得总的直流环节电压峰峰值纹波。\n\n将最终数值答案四舍五入到四位有效数字。以 $\\mathrm{V}$ 为单位表示最终电压纹波。",
            "solution": "直流环节上的总电压 $v_{dc}(t)$ 是理想电容上的电压 $v_C(t)$ 和等效串联电阻 (ESR) 上的电压 $v_{ESR}(t)$ 之和。\n$$v_{dc}(t) = v_C(t) + v_{ESR}(t)$$\n根据欧姆定律，ESR 上的电压与流过电容器的电流 $i_c(t)$ 成正比：$v_{ESR}(t) = i_c(t) R_{\\mathrm{ESR}}$。\n\n首先，我们确定电容器电流 $i_c(t)$。问题陈述指出，直流源提供周期平均电流，这意味着电容器提供或吸收直流环节电流 $i_{link}(t)$ 的交流分量。\n直流环节电流在一个开关周期 $T_s$ 内是一个分段常数函数：\n$$\ni_{link}(t) = \\begin{cases} I_{1}  \\text{在 } 0  t \\le D T_s \\text{ 期间} \\\\ I_{2}  \\text{在 } D T_s  t \\le T_s \\text{ 期间} \\end{cases}\n$$\n由直流源提供的平均直流环节电流 $I_{avg}$ 是：\n$$I_{avg} = \\frac{1}{T_s} \\int_0^{T_s} i_{link}(t) \\, dt = \\frac{1}{T_s} \\left( I_1 (D T_s) + I_2 (T_s - D T_s) \\right) = D I_1 + (1-D) I_2$$\n电容器电流 $i_c(t)$ 是瞬时环节电流与平均电流之差，$i_c(t) = i_{link}(t) - I_{avg}$。\n$$\ni_c(t) = \\begin{cases} I_{c1} = I_1 - I_{avg}  \\text{在 } 0  t \\le D T_s \\text{ 期间} \\\\ I_{c2} = I_2 - I_{avg}  \\text{在 } D T_s  t \\le T_s \\text{ 期间} \\end{cases}\n$$\n在稳态下，一个周期内供给电容器的净电荷为零，这意味着平均电容器电流必须为零。\n$$ \\langle i_c \\rangle = D I_{c1} + (1-D) I_{c2} = D(I_1 - I_{avg}) + (1-D)(I_2 - I_{avg}) = (D I_1 + (1-D)I_2) - I_{avg} = I_{avg} - I_{avg} = 0 $$\n这证实了电荷平衡在我们对 $i_c(t)$ 的定义中是固有的。\n\n使用给定的数值：\n$D=0.30$, $I_1 = 18\\,\\mathrm{A}$, $I_2 = 4\\,\\mathrm{A}$。\n$$I_{avg} = (0.30)(18\\,\\mathrm{A}) + (1-0.30)(4\\,\\mathrm{A}) = 5.4\\,\\mathrm{A} + 2.8\\,\\mathrm{A} = 8.2\\,\\mathrm{A}$$\n两个区间内的电容器电流为：\n$$I_{c1} = 18\\,\\mathrm{A} - 8.2\\,\\mathrm{A} = 9.8\\,\\mathrm{A}$$\n$$I_{c2} = 4\\,\\mathrm{A} - 8.2\\,\\mathrm{A} = -4.2\\,\\mathrm{A}$$\n在第一个区间 ($0  t \\le D T_s$)，电容器以 $9.8\\,\\mathrm{A}$ 的电流放电（正电流流出）。在第二个区间 ($D T_s  t \\le T_s$)，它以 $4.2\\,\\mathrm{A}$ 的电流充电（负电流流入）。\n\n问题要求分离电抗性纹波和电阻性纹波分量。\n\n**1. 电抗性电压纹波 ($\\Delta v_{C,pp}$)**\n理想电容器上的电压变化由 $\\Delta v_C = \\frac{1}{C} \\int i_c(t) dt$ 给出。峰峰值电抗性纹波是放电（或充电）期间的总电压变化。在第一个区间 ($0  t \\le D T_s$)，电容器电压下降。此下降的幅度即为峰峰值电抗性纹波。\n$$ \\Delta v_{C,pp} = |v_C(D T_s) - v_C(0)| = \\left| \\frac{1}{C} \\int_0^{D T_s} I_{c1} dt \\right| = \\frac{I_{c1} D T_s}{C} $$\n开关周期为 $T_s = 1/f_s = 1/(20 \\times 10^3\\,\\mathrm{Hz}) = 50 \\times 10^{-6}\\,\\mathrm{s}$。\n电容为 $C = 2.2\\,\\mathrm{mF} = 2.2 \\times 10^{-3}\\,\\mathrm{F}$。\n$$ \\Delta v_{C,pp} = \\frac{(9.8\\,\\mathrm{A})(0.30)(50 \\times 10^{-6}\\,\\mathrm{s})}{2.2 \\times 10^{-3}\\,\\mathrm{F}} = \\frac{1.47 \\times 10^{-4}}{2.2 \\times 10^{-3}}\\,\\mathrm{V} \\approx 0.066818\\,\\mathrm{V} $$\n\n**2. 电阻性电压纹波 ($\\Delta v_{ESR,pp}$)**\nESR 上的电压 $v_{ESR}(t) = i_c(t) R_{\\mathrm{ESR}}$ 也是分段恒定的。\n$$\nv_{ESR}(t) = \\begin{cases} I_{c1} R_{\\mathrm{ESR}}  \\text{在 } 0  t \\le D T_s \\text{ 期间} \\\\ I_{c2} R_{\\mathrm{ESR}}  \\text{在 } D T_s  t \\le T_s \\text{ 期间} \\end{cases}\n$$\nESR 对电压纹波的峰峰值贡献是 $v_{ESR}(t)$ 的最大值和最小值之差。\n$$ \\Delta v_{ESR,pp} = (I_{c1} R_{\\mathrm{ESR}}) - (I_{c2} R_{\\mathrm{ESR}}) = (I_{c1} - I_{c2}) R_{\\mathrm{ESR}} $$\nESR 为 $R_{\\mathrm{ESR}} = 25\\,\\mathrm{m}\\Omega = 25 \\times 10^{-3}\\,\\Omega$。\n$$ \\Delta v_{ESR,pp} = (9.8\\,\\mathrm{A} - (-4.2\\,\\mathrm{A}))(25 \\times 10^{-3}\\,\\Omega) = (14.0\\,\\mathrm{A})(25 \\times 10^{-3}\\,\\Omega) = 0.350\\,\\mathrm{V} $$\n\n**3. 总直流环节电压峰峰值纹波 ($\\Delta v_{dc,pp}$)**\n总峰峰值纹波是一个周期内总电压 $v_{dc}(t)$ 的最大值和最小值之差。\n电容器电压 $v_C(t)$ 是连续的。它在 $t=0$ 时达到最大值，在 $t=D T_s$ 时达到最小值。ESR 电压 $v_{ESR}(t)$ 在 $t=D T_s$ 处有一个阶跃变化。\n总电压波形 $v_{dc}(t)$ 从 $t=0^+$ 到 $t=D T_s^-$ 线性减小，然后在 $t=D T_s$ 处瞬时下降，然后线性增加直到 $t=T_s^-$。\n最大电压出现在 $t=0^+$ 时：\n$$ v_{dc,max} = v_C(0) + v_{ESR}(0^+) = v_C(0) + I_{c1} R_{\\mathrm{ESR}} $$\n最小电压出现在 $t=D T_s^+$ 时：\n$$ v_{dc,min} = v_C(D T_s) + v_{ESR}(D T_s^+) = v_C(D T_s) + I_{c2} R_{\\mathrm{ESR}} $$\n因此，总峰峰值纹波为：\n$$ \\Delta v_{dc,pp} = v_{dc,max} - v_{dc,min} = (v_C(0) + I_{c1} R_{\\mathrm{ESR}}) - (v_C(D T_s) + I_{c2} R_{\\mathrm{ESR}}) $$\n$$ \\Delta v_{dc,pp} = (v_C(0) - v_C(D T_s)) + (I_{c1} - I_{c2}) R_{\\mathrm{ESR}} $$\n这表明总峰峰值纹波是电抗性纹波和电阻性纹波分量之和。\n$$ \\Delta v_{dc,pp} = \\Delta v_{C,pp} + \\Delta v_{ESR,pp} $$\n代入计算出的值：\n$$ \\Delta v_{dc,pp} = 0.066818\\dots\\,\\mathrm{V} + 0.350\\,\\mathrm{V} = 0.416818\\dots\\,\\mathrm{V} $$\n根据问题陈述的要求，四舍五入到四位有效数字，我们得到：\n$$ \\Delta v_{dc,pp} \\approx 0.4168\\,\\mathrm{V} $$",
            "answer": "$$\n\\boxed{0.4168}\n$$"
        },
        {
            "introduction": "电容器电荷平衡原理不仅可用于分析，更可用于主动控制。这个高级练习将引导你从第一性原理出发，为一个开关电容电路推导一个“死拍”(deadbeat)控制律。该控制律能够根据周期开始时测得的初始状态，精确计算出能在单个开关周期内实现完美电荷平衡（即周期末电压恢复到初始值）所需的占空比 $D$，从而将电路分析的知识转化为先进的数字控制策略 。",
            "id": "3825553",
            "problem": "电力电子变换器中的开关电容支路在每个采样周期内在两种导通状态之间交替，以实现脉冲宽度调制 (PWM)。该网络由一个幅值为 $V_s$ 的理想直流电源、一个串联电阻、一个理想开关和一个电容为 $C$ 的接地电容器组成。在持续时间为 $D T_s$ 的“导通”子区间内，理想开关闭合，将电源通过串联电阻连接到电容器节点。在持续时间为 $(1-D) T_s$ 的“关断”子区间内，理想开关断开，将电容器节点通过同一串联电阻接地。设电容器电压为 $v_C(t)$，电容器电流为 $i_C(t)$，并规定流入电容器的电流 $i_C$ 为正。在每个周期的开始时刻，即 $t=0$ 时，测得电容器的电压为 $v_C(0)$，电流为 $i_C(0)$。\n\n仅使用基本关系和经过充分验证的器件模型，电容器遵循 $i_C(t) = C \\,\\frac{d v_C(t)}{d t}$。在每个子区间内，电阻器根据状态在支路电压和电流之间建立线性关系：在“导通”状态下，电阻器电流由电源与电容器之间的电压差决定；在“关断”状态下，电阻器电流由电容器与地之间的电压决定。您必须从第一性原理出发，推导出一个精确的占空比更新律。该定律利用周期开始时测得的 $i_C(0)$ 和 $v_C(0)$，选择占空比 $D \\in [0,1]$，以使电容器在整个周期内实现精确的电荷平衡，即在周期结束时 $v_C(T_s) = v_C(0)$。如果对于给定的参数，精确的电荷平衡在物理上不可行，您仍必须根据相同的定律计算一个在 $[0,1]范围内的有界占空比，并根据需要进行饱和处理。\n\n实现一个程序，对于给定的参数集测试套件，根据您推导的无差拍更新律计算占空比 $D$。所有物理单位必须一致使用：$V_s$ 的单位是伏特，$C$ 的单位是法拉，$T_s$ 的单位是秒，$v_C(0)$ 的单位是伏特，$i_C(0)$ 的单位是安培。占空比 $D$ 是无量纲的，必须以小数形式输出，并四舍五入到六位小数。\n\n测试套件：\n1. 案例A（理想情况）：$V_s = 400$ 伏特，$C = 100 \\times 10^{-6}$ 法拉，$T_s = 100 \\times 10^{-6}$ 秒，$v_C(0) = 350$ 伏特，$i_C(0) = 25$ 安培。\n2. 案例B（边界情况，接近电源电压）：$V_s = 400$ 伏特，$C = 100 \\times 10^{-6}$ 法拉，$T_s = 100 \\times 10^{-6}$ 秒，$v_C(0) = 399$ 伏特，$i_C(0) = 0.5$ 安培。\n3. 案例C（边界情况，接近地电压）：$V_s = 400$ 伏特，$C = 100 \\times 10^{-6}$ 法拉，$T_s = 100 \\times 10^{-6}$ 秒，$v_C(0) = 1$ 伏特，$i_C(0) = 199.5$ 安培。\n4. 案例D（边缘情况：测得的电容器电压高于电源电压）：$V_s = 400$ 伏特，$C = 100 \\times 10^{-6}$ 法拉，$T_s = 100 \\times 10^{-6}$ 秒，$v_C(0) = 450$ 伏特，$i_C(0) = -25$ 安培。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个条目是对应测试案例计算出的占空比 $D$，并四舍五入到六位小数（例如，“[0.123456,0.654321,0.500000,1.000000]”）。",
            "solution": "经评估，问题陈述是有效的。虽然串联电阻 $R$ 没有作为全局参数明确给出，但它由周期开始时（$t=0$）电路的初始状态隐含定义。问题陈述指出，在 $t=0$ 时，测量电压 $v_C(0)$ 和电流 $i_C(0)$。此测量发生在系统进入“导通”子区间时。这使得 $R$ 的值可以被确定，从而使问题自洽且可解。\n\n无差拍占空比更新律的推导从第一性原理出发，过程如下。\n\n**1. 系统建模与参数辨识**\n\n该电路由一个电压源 $V_s$、一个电阻 $R$、一个开关和一个电容 $C$ 组成。\n在从 $t=0$ 到 $t=D T_s$ 的“导通”子区间内，电源连接到 $RC$ 网络。对回路应用基尔霍夫电压定律 (KVL) 可得：\n$$V_s = v_R(t) + v_C(t)$$\n电阻电压 $v_R(t)$ 由欧姆定律给出，$v_R(t) = i_R(t) R$。在这个串联电路中，电阻电流 $i_R(t)$ 等于电容电流 $i_C(t)$。\n$$V_s = i_C(t) R + v_C(t)$$\n这个方程在“导通”区间内的所有时刻 $t$ 都必须成立，包括在初始时刻 $t=0^+$。问题提供了周期开始时测得的值 $v_C(0)$ 和 $i_C(0)$。假设这些值代表了 $t=0^+$ 时的状态，我们可以确定串联电阻 $R$：\n$$R = \\frac{V_s - v_C(0)}{i_C(0)}$$\n此步骤在 $i_C(0) \\neq 0$ 时有效。如果 $i_C(0) = 0$，为了模型的一致性，必须有 $V_s - v_C(0) = 0$，即 $v_C(0) = V_s$。所有提供的测试案例都满足 $i_C(0) \\neq 0$。\n电路的时间常数 $\\tau$ 为：\n$$\\tau = R C$$\n\n**2. 电容器电压的状态空间描述**\n\n我们在每个子区间内求解关于 $v_C(t)$ 的一阶线性常微分方程。\n\n**子区间 1：“导通”状态 ($0 \\le t  D T_s$)**\n控制方程为：\n$$R C \\frac{d v_C(t)}{d t} + v_C(t) = V_s$$\n在初始条件为 $v_C(0)$ 的情况下，电容器电压的解为：\n$$v_C(t) = V_s + (v_C(0) - V_s) e^{-t/\\tau}$$\n在此子区间结束时，即 $t = D T_s$ 时，电容器电压为：\n$$v_C(D T_s) = V_s + (v_C(0) - V_s) e^{-D T_s/\\tau}$$\n\n**子区间 2：“关断”状态 ($D T_s \\le t \\le T_s$)**\n控制方程为（电源电压为 0）：\n$$R C \\frac{d v_C(t)}{d t} + v_C(t) = 0$$\n在此子区间的初始条件为 $v_C(D T_s)$ 的情况下，电容器电压的解为：\n$$v_C(t) = v_C(D T_s) e^{-(t-D T_s)/\\tau}$$\n在整个周期结束时，即 $t = T_s$ 时，电容器电压为：\n$$v_C(T_s) = v_C(D T_s) e^{-(1-D) T_s/\\tau}$$\n\n**3. 无差拍控制律的推导**\n\n目标是实现精确的电荷平衡，这意味着最终电容器电压必须等于初始电压：$v_C(T_s) = v_C(0)$。我们将步骤 2 中得到的表达式代入此条件。\n\n首先，将 $v_C(D T_s)$ 的表达式代入 $v_C(T_s)$ 的方程中：\n$$v_C(T_s) = \\left[ V_s + (v_C(0) - V_s) e^{-D T_s/\\tau} \\right] e^{-(1-D) T_s/\\tau}$$\n现在，令 $v_C(T_s) = v_C(0)$：\n$$v_C(0) = \\left[ V_s + (v_C(0) - V_s) e^{-D T_s/\\tau} \\right] e^{-(1-D) T_s/\\tau}$$\n为了求解 $D$，我们进行代数运算。首先，在方程两边同乘以 $e^{(1-D) T_s/\\tau}$：\n$$v_C(0) e^{(1-D) T_s/\\tau} = V_s + (v_C(0) - V_s) e^{-D T_s/\\tau}$$\n利用指数性质 $e^{a+b} = e^a e^b$：\n$$v_C(0) e^{T_s/\\tau} e^{-D T_s/\\tau} = V_s + v_C(0) e^{-D T_s/\\tau} - V_s e^{-D T_s/\\tau}$$\n将含有 $e^{-D T_s/\\tau}$ 的项组合在一起：\n$$e^{-D T_s/\\tau} \\left[ v_C(0) e^{T_s/\\tau} - v_C(0) + V_s \\right] = V_s$$\n分离指数项：\n$$e^{-D T_s/\\tau} = \\frac{V_s}{V_s + v_C(0) (e^{T_s/\\tau} - 1)}$$\n对两边取自然对数：\n$$- \\frac{D T_s}{\\tau} = \\ln \\left( \\frac{V_s}{V_s + v_C(0) (e^{T_s/\\tau} - 1)} \\right)$$\n利用对数性质 $\\ln(1/x) = -\\ln(x)$：\n$$\\frac{D T_s}{\\tau} = \\ln \\left( \\frac{V_s + v_C(0) (e^{T_s/\\tau} - 1)}{V_s} \\right)$$\n$$\\frac{D T_s}{\\tau} = \\ln \\left( 1 + \\frac{v_C(0)}{V_s} (e^{T_s/\\tau} - 1) \\right)$$\n最后，解出占空比 $D$：\n$$D = \\frac{\\tau}{T_s} \\ln \\left( 1 + \\frac{v_C(0)}{V_s} (e^{T_s/\\tau} - 1) \\right)$$\n这就是精确的占空比无差拍更新律。\n\n**4. 有界占空比**\n\n推导出的 $D$ 的表达式可能会产生一个在物理上有意义的范围 $[0, 1]$ 之外的值。问题要求，如果无法实现精确的电荷平衡，占空比应饱和到此范围内。因此，最终计算出的占空比 $D_{final}$ 为：\n$$D_{final} = \\max(0, \\min(1, D))$$\n这确保了输出始终是一个有效的占空比。例如，如果初始条件需要的导通时间超出了周期内可用的时间（$D > 1$），我们能做的最好的就是让开关在整个周期内保持导通（$D=1$）。类似地，如果定律得出一个负的占空比，我们将其饱和到 $D=0$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the deadbeat duty ratio for a switched-capacitor circuit\n    for a given set of test cases.\n    \"\"\"\n    \n    # Test Suite: (Vs, C, Ts, v_C(0), i_C(0))\n    test_cases = [\n        # Case A: happy path\n        (400.0, 100e-6, 100e-6, 350.0, 25.0),\n        # Case B: boundary near source voltage\n        (400.0, 100e-6, 100e-6, 399.0, 0.5),\n        # Case C: boundary near ground\n        (400.0, 100e-6, 100e-6, 1.0, 199.5),\n        # Case D: edge case, v_C(0) > Vs\n        (400.0, 100e-6, 100e-6, 450.0, -25.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Vs, C, Ts, v_C0, i_C0 = case\n\n        # The problem formulation implies that the initial state (v_C0, i_C0) is\n        # consistent with the circuit model, where R = (Vs - v_C0) / i_C0.\n        # We must handle the case i_C0 = 0 separately to avoid division by zero.\n        if abs(i_C0)  1e-9:\n            # If i_C0 is zero, then for the model to hold, Vs must equal v_C0.\n            # In this state, the driving voltage is zero during the ON phase, so\n            # the capacitor voltage doesn't change. To maintain v_C(Ts)=v_C(0),\n            # the capacitor must not discharge, requiring zero OFF time.\n            if abs(Vs - v_C0)  1e-9:\n                D_unbounded = 1.0\n            else:\n                # This state is inconsistent with the physical model provided.\n                # However, all test cases have non-zero i_C0.\n                # We can assign a default or raise an error. For robustness,\n                # let's assume saturation will handle it. We can compute the limit.\n                # If i_C0 -> 0 and Vs != v_C0, then |R| -> infinity and tau -> infinity.\n                # The argument to log becomes 1, so D=0.\n                D_unbounded = 0.0\n        else:\n            # Step 1: Identify the series resistance R from initial conditions.\n            R = (Vs - v_C0) / i_C0\n\n            # Step 2: Calculate the circuit time constant tau.\n            tau = R * C\n\n            # Step 3: Check for tau = 0 which is unphysical for passive R, C > 0.\n            # This can happen if R is negative (e.g., v_C0 > Vs and i_C0 > 0).\n            # The test cases are designed to yield R > 0.\n            if tau = 0:\n                # If tau is non-positive, the exponential model breaks down or implies instability.\n                # A reasonable saturation based on the sign of v_C0 relative to V_s/2 could be to set\n                # D to 0 or 1, but based on problem spec we apply the law and saturate.\n                # If we proceed, np.exp might result in NaN or inf.\n                # Let's handle saturation based on intuition. If v_C0 > Vs, we want to discharge, hence small D.\n                D_unbounded = 0.0 if v_C0 > Vs else 1.0\n            else:\n                # Step 4: Derive the duty ratio D from the charge balance equation.\n                # D = (tau/Ts) * ln(1 + (v_C0/Vs) * (exp(Ts/tau) - 1))\n                \n                # To avoid potential numerical issues with large exponents, we can\n                # analyze the terms, but given the test case values, standard float\n                # precision is sufficient.\n                exp_term = np.exp(Ts / tau)\n                \n                log_arg = 1 + (v_C0 / Vs) * (exp_term - 1)\n\n                # The argument of the logarithm must be positive for a real solution.\n                # This condition holds for all test cases.\n                if log_arg = 0:\n                    # Physically, this means charge balance is impossible. To get back to v_C0,\n                    # the voltage would need to cross zero or diverge.\n                    # As per problem, \"saturating as needed\", so we find the unbounded D\n                    # and clip. An unreachable target implies D=0 or D=1.\n                    # If log_arg is negative, it implies v_C0 is negative and large.\n                    # The control action should be maximum ON time to bring voltage up.\n                    D_unbounded = 1.0\n                else:\n                    D_unbounded = (tau / Ts) * np.log(log_arg)\n\n        # Step 5: Saturate the duty ratio to the physical range [0, 1].\n        D_final = np.clip(D_unbounded, 0.0, 1.0)\n        \n        results.append(f\"{D_final:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}