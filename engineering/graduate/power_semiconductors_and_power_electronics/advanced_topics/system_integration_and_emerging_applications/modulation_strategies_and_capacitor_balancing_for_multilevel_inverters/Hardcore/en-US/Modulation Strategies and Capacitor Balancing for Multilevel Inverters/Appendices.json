{
    "hands_on_practices": [
        {
            "introduction": "A key performance metric for any inverter is its ability to fully utilize the available DC bus voltage. This practice delves into the fundamental limits of the linear modulation range for two cornerstone strategies: sinusoidal pulse-width modulation (SPWM) and space vector modulation (SVM). By deriving the maximum modulation index, $m_a$, for each method from first principles , you will quantify the well-known 15% increase in voltage output achievable with SVM and gain a deeper appreciation for how zero-sequence injection expands the operational envelope of the inverter.",
            "id": "3859557",
            "problem": "A three-phase, three-level Neutral-Point-Clamped (NPC) inverter with a split direct-current bus voltage $V_{\\mathrm{dc}}$ is modulated to produce balanced sinusoidal phase voltages using Space Vector Modulation (SVM). The inverter implements capacitor (neutral-point) balancing by appropriately distributing dwell times among medium vectors, but does not permit excursions of any leg output beyond $\\pm V_{\\mathrm{dc}}/2$. Define the amplitude modulation index $m_a$ as $m_a = V_m/(V_{\\mathrm{dc}}/2)$, where $V_m$ is the peak amplitude of the commanded fundamental phase voltage reference. Assume ideal devices, negligible dead time, and that the neutral-point potential remains centered on average due to the modulation strategy.\n\nStarting from the definitions of three-phase sinusoidal references, the constraint that the reference space vector must lie within the convex hull of available switching vectors, and the fact that in optimal SVM a zero-sequence voltage can be injected to maximize the linear range, derive the maximum value of $m_a$ before overmodulation for three-level SVM. Then, derive the corresponding linear-limit value of $m_a$ for carrier-based Sinusoidal Pulse Width Modulation (SPWM) without zero-sequence injection. Carefully justify the bounds using first principles for the extrema of the three sinusoidal phase references and the effect of zero-sequence injection on the instantaneous maximum and minimum of the modulating signals. Express your final answers as exact symbolic expressions without rounding and without units. Provide the final answer as a row matrix containing the two values in the order: three-level SVM maximum $m_a$ before overmodulation, SPWM linear-limit $m_a$.",
            "solution": "We begin by defining the three balanced sinusoidal phase references for a three-phase system as\n$$\nv_a^{*}(t) = V_m \\sin(\\omega t), \\quad v_b^{*}(t) = V_m \\sin\\left(\\omega t - \\frac{2\\pi}{3}\\right), \\quad v_c^{*}(t) = V_m \\sin\\left(\\omega t + \\frac{2\\pi}{3}\\right),\n$$\nwhere $V_m$ is the peak of the desired fundamental phase voltage and $\\omega$ is the angular frequency. The amplitude modulation index is defined as\n$$\nm_a = \\frac{V_m}{V_{\\mathrm{dc}}/2}.\n$$\nIn all cases, the instantaneous commanded leg voltage must satisfy the available discrete leg states, which are bounded by $\\pm V_{\\mathrm{dc}}/2$ for a three-level Neutral-Point-Clamped (NPC) inverter.\n\nWe analyze the extrema structure of the three references. For any fixed time $t$, define\n$$\nv_{\\max}(t) = \\max\\{v_a^{*}(t), v_b^{*}(t), v_c^{*}(t)\\}, \\quad v_{\\min}(t) = \\min\\{v_a^{*}(t), v_b^{*}(t), v_c^{*}(t)\\}.\n$$\nA fundamental observation for balanced sinusoidal phase references is the maximum instantaneous spread\n$$\n\\Delta(t) := v_{\\max}(t) - v_{\\min}(t).\n$$\nWe claim that the maximum of $\\Delta(t)$ over time is\n$$\n\\max_{t} \\Delta(t) = \\sqrt{3}\\, V_m.\n$$\nTo show this, consider the pair of phases separated by $120^{\\circ}$ that realize the maximum minus minimum at the instant of greatest spread. Without loss of generality, evaluate\n$$\n\\sin\\left(\\theta + \\frac{2\\pi}{3}\\right) - \\sin\\left(\\theta - \\frac{2\\pi}{3}\\right) = 2 \\cos(\\theta) \\sin\\left(\\frac{2\\pi}{3}\\right) = 2 \\cos(\\theta) \\cdot \\frac{\\sqrt{3}}{2} = \\sqrt{3} \\cos(\\theta),\n$$\nwhich attains its maximum magnitude of $\\sqrt{3}$ when $\\cos(\\theta) = 1$. Multiplying by $V_m$ yields $\\max_{t} \\Delta(t) = \\sqrt{3}\\, V_m$. Explicitly, at $\\theta = 0$, the three phase values are $0$, $+\\frac{\\sqrt{3}}{2} V_m$, and $-\\frac{\\sqrt{3}}{2} V_m$, giving a spread $\\Delta = \\sqrt{3}\\, V_m$.\n\nWe now compute the linear limits for two modulation strategies.\n\n1. Space Vector Modulation (SVM) for a three-level NPC inverter with optimal zero-sequence injection. Space Vector Modulation chooses a common-mode (zero-sequence) injection $v_0(t)$ to keep the reference space vector within the convex hull of the accessible switching vectors. An optimal choice that maximizes the linear range and equalizes the margins to the leg bounds is\n$$\nv_0(t) = -\\frac{v_{\\max}(t) + v_{\\min}(t)}{2}.\n$$\nDefine the modified phase commands $v_i'(t) = v_i^{*}(t) + v_0(t)$ for $i \\in \\{a,b,c\\}$. The modified maximum and minimum become\n$$\nv_{\\max}'(t) = v_{\\max}(t) - \\frac{v_{\\max}(t) + v_{\\min}(t)}{2} = \\frac{v_{\\max}(t) - v_{\\min}(t)}{2} = \\frac{\\Delta(t)}{2},\n$$\n$$\nv_{\\min}'(t) = v_{\\min}(t) - \\frac{v_{\\max}(t) + v_{\\min}(t)}{2} = -\\frac{v_{\\max}(t) - v_{\\min}(t)}{2} = -\\frac{\\Delta(t)}{2}.\n$$\nThus, at any time, all three modified commands lie within the interval $\\left[-\\frac{\\Delta(t)}{2}, \\frac{\\Delta(t)}{2}\\right]$. The linear region constraint is that no leg command exceeds the available bounds $\\pm V_{\\mathrm{dc}}/2$, which requires\n$$\n\\frac{\\Delta(t)}{2} \\leq \\frac{V_{\\mathrm{dc}}}{2} \\quad \\text{for all } t \\quad \\Longrightarrow \\quad \\Delta(t) \\leq V_{\\mathrm{dc}} \\quad \\text{for all } t.\n$$\nUsing the maximum spread $\\max_{t} \\Delta(t) = \\sqrt{3}\\, V_m$, the worst-case constraint yields\n$$\n\\sqrt{3}\\, V_m \\leq V_{\\mathrm{dc}} \\quad \\Longrightarrow \\quad V_m \\leq \\frac{V_{\\mathrm{dc}}}{\\sqrt{3}}.\n$$\nTherefore, the maximum modulation index before overmodulation under three-level SVM is\n$$\nm_{a,\\max}^{\\mathrm{SVM}} = \\frac{V_m}{V_{\\mathrm{dc}}/2} \\bigg|_{\\max} = \\frac{V_{\\mathrm{dc}/\\sqrt{3}}}{V_{\\mathrm{dc}}/2} = \\frac{2}{\\sqrt{3}}.\n$$\nNote that the presence of the intermediate $0$ level in the three-level leg allows neutral-point (capacitor) balancing via appropriate dwell distribution among medium vectors, but it does not increase the allowable extremal leg voltage beyond $\\pm V_{\\mathrm{dc}}/2$, hence the amplitude limit derived above is unchanged by the number of levels for the linear range boundary.\n\n2. Sinusoidal Pulse Width Modulation (SPWM) without zero-sequence injection. In carrier-based SPWM without any common-mode injection, the phase command is the sinusoid itself, so the extremal leg command magnitude is simply $|v_i^{*}(t)| \\leq V_m$. The linearity constraint requires\n$$\nV_m \\leq \\frac{V_{\\mathrm{dc}}}{2}.\n$$\nConsequently, the linear-limit modulation index is\n$$\nm_{a,\\max}^{\\mathrm{SPWM}} = \\frac{V_m}{V_{\\mathrm{dc}}/2} \\bigg|_{\\max} = 1.\n$$\n\nCollecting the results, the maximum modulation index before overmodulation for three-level Space Vector Modulation is $\\frac{2}{\\sqrt{3}}$, and the Sinusoidal Pulse Width Modulation linear limit is $1$. These are exact symbolic values.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{\\sqrt{3}}  1\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the modulation index is a critical control parameter, the ultimate goal is to produce a specific AC voltage at the load terminals. This exercise bridges the gap between modulation theory and practical output by asking you to derive the maximum line-to-line fundamental voltage amplitude of an $N$-level inverter . This analysis will challenge you to apply principles of three-phase systems and clarify the often-misunderstood roles of zero-sequence injection and the number of inverter levels ($N$) in determining the fundamental output.",
            "id": "3859564",
            "problem": "A three-phase, symmetric $N$-level Neutral-Point-Clamped (NPC) inverter is supplied by a split direct current (DC) bus with per-phase total voltage $V_{dc}$, so that the maximum instantaneous pole voltage of any phase with respect to the neutral midpoint is bounded by $\\pm V_{dc}/2$. The inverter is modulated in the linear regime using carrier-based sinusoidal pulse-width modulation (SPWM) with nearest-level selection and an added zero-sequence signal to maintain capacitor charge balance. The zero-sequence component is identical across all three phases and is chosen such that the average neutral-point current over every switching period is zero, ensuring capacitor voltage balance. The load is a balanced, linear, three-phase wye-connected load, so the phase currents are proportional to the corresponding phase voltages and are balanced.\n\nDefine the modulation index $m_a$ as the ratio of the peak amplitude of the sinusoidal reference for each phase (excluding any zero-sequence component) to $V_{dc}/2$. Assume ideal switching devices and sufficiently high carrier frequency such that the low-frequency (fundamental) component of the phase voltage equals the average of the modulated waveform over each switching period.\n\nUsing only these premises and first principles of three-phase sinusoidal relationships and average-value modeling of pulse-width modulation, derive an exact, closed-form expression for the maximum achievable line-to-line fundamental peak amplitude in the linear modulation range, expressed as a function of $N$, $V_{dc}$, and $m_a$. Your result must explicitly account for the presence of the zero-sequence injection used for capacitor balancing and must state whether and how the number of levels $N$ affects the fundamental line-to-line amplitude in the linear regime.\n\nExpress your final answer as a single analytic expression. If you were to evaluate it numerically, express the amplitude in volts (V). No rounding is required, and angles, if they appear during intermediate steps, must be treated in radians.",
            "solution": "The problem asks for the maximum achievable line-to-line fundamental peak amplitude in a three-phase $N$-level NPC inverter operating in the linear modulation range. The solution will be derived from first principles of three-phase systems and pulse-width modulation (PWM).\n\nFirst, we define the fundamental component of the three-phase sinusoidal reference voltages with respect to the load's neutral point, denoted as $v_{an}(t)$, $v_{bn}(t)$, and $v_{cn}(t)$. These are balanced sinusoids, phase-shifted by $\\frac{2\\pi}{3}$ radians or $120^\\circ$. Let the angular frequency be $\\omega$. The problem states that the low-frequency component of the phase voltage equals the average of the modulated waveform, which is this reference signal itself.\n\nThe peak amplitude of this sinusoidal phase reference, let's call it $V_{ph,peak}$, is given by the definition of the modulation index, $m_a$:\n$$m_a = \\frac{V_{ph,peak}}{V_{dc}/2}$$\nTherefore, the peak phase voltage amplitude is:\n$$V_{ph,peak} = m_a \\frac{V_{dc}}{2}$$\nThe instantaneous fundamental phase voltages (with respect to the load neutral 'n') can be written as:\n$$v_{an}(t) = V_{ph,peak} \\cos(\\omega t) = \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos(\\omega t)$$\n$$v_{bn}(t) = V_{ph,peak} \\cos\\left(\\omega t - \\frac{2\\pi}{3}\\right) = \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos\\left(\\omega t - \\frac{2\\pi}{3}\\right)$$\n$$v_{cn}(t) = V_{ph,peak} \\cos\\left(\\omega t - \\frac{4\\pi}{3}\\right) = \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos\\left(\\omega t + \\frac{2\\pi}{3}\\right)$$\n\nThe problem asks for the line-to-line voltage amplitude. The instantaneous line-to-line voltage, for example between phase 'a' and phase 'b', is the difference between the respective phase voltages:\n$$v_{ab}(t) = v_{an}(t) - v_{bn}(t)$$\nSubstituting the expressions for the phase voltages:\n$$v_{ab}(t) = \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos(\\omega t) - \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos\\left(\\omega t - \\frac{2\\pi}{3}\\right)$$\n$$v_{ab}(t) = m_a \\frac{V_{dc}}{2} \\left[ \\cos(\\omega t) - \\cos\\left(\\omega t - \\frac{2\\pi}{3}\\right) \\right]$$\nTo simplify this, we use the trigonometric identity $\\cos(A) - \\cos(B) = -2 \\sin\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$.\nHere, $A = \\omega t$ and $B = \\omega t - \\frac{2\\pi}{3}$.\n$$\\frac{A+B}{2} = \\frac{\\omega t + \\omega t - 2\\pi/3}{2} = \\omega t - \\frac{\\pi}{3}$$\n$$\\frac{A-B}{2} = \\frac{\\omega t - (\\omega t - 2\\pi/3)}{2} = \\frac{2\\pi/3}{2} = \\frac{\\pi}{3}$$\nSubstituting these back into the expression for $v_{ab}(t)$:\n$$v_{ab}(t) = m_a \\frac{V_{dc}}{2} \\left[ -2 \\sin\\left(\\omega t - \\frac{\\pi}{3}\\right) \\sin\\left(\\frac{\\pi}{3}\\right) \\right]$$\nSince $\\sin(\\frac{\\pi}{3}) = \\frac{\\sqrt{3}}{2}$, we have:\n$$v_{ab}(t) = m_a \\frac{V_{dc}}{2} \\left[ -2 \\sin\\left(\\omega t - \\frac{\\pi}{3}\\right) \\left(\\frac{\\sqrt{3}}{2}\\right) \\right]$$\n$$v_{ab}(t) = -\\sqrt{3} \\left(m_a \\frac{V_{dc}}{2}\\right) \\sin\\left(\\omega t - \\frac{\\pi}{3}\\right)$$\nTo find the peak amplitude, we can express this result in the form of a cosine wave. Using the identity $-\\sin(x) = \\cos(x + \\frac{\\pi}{2})$:\n$$v_{ab}(t) = \\sqrt{3} \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos\\left(\\omega t - \\frac{\\pi}{3} + \\frac{\\pi}{2}\\right)$$\n$$v_{ab}(t) = \\sqrt{3} \\left(m_a \\frac{V_{dc}}{2}\\right) \\cos\\left(\\omega t + \\frac{\\pi}{6}\\right)$$\nThis expression represents a sinusoidal line-to-line voltage. The maximum achievable amplitude (i.e., the peak value) of this waveform, $V_{LL,peak}$, is the coefficient of the cosine function:\n$$V_{LL,peak} = \\sqrt{3} \\left(m_a \\frac{V_{dc}}{2}\\right) = \\frac{\\sqrt{3}}{2} m_a V_{dc}$$\n\nNow, we must address the roles of the zero-sequence injection and the number of levels, $N$.\n\n1.  **Effect of Zero-Sequence Injection:** The problem states that a zero-sequence signal, $v_z(t)$, is added to the phase references for capacitor balancing. The resulting signals are the pole voltage references with respect to the DC bus midpoint 'N':\n    $$v_{aN}(t) = v_{an}(t) + v_z(t)$$\n    $$v_{bN}(t) = v_{bn}(t) + v_z(t)$$\n    $$v_{cN}(t) = v_{cn}(t) + v_z(t)$$\n    The physical line-to-line voltage is the difference between the pole voltages. For example:\n    $$v_{ab}(t) = v_{aN}(t) - v_{bN}(t) = (v_{an}(t) + v_z(t)) - (v_{bn}(t) + v_z(t)) = v_{an}(t) - v_{bn}(t)$$\n    The zero-sequence component, being a common-mode signal identical for all three phases, cancels out completely in the calculation of line-to-line voltages. Therefore, the presence of this signal, regardless of its specific form or purpose (capacitor balancing), has no effect on the fundamental line-to-line voltage amplitudes.\n\n2.  **Effect of the Number of Levels, $N$:** The problem assumes operation in the linear modulation range and that the fundamental output voltage component equals the reference waveform. In this regime, the peak fundamental voltage is determined by the amplitude of the reference signal, $V_{ph,peak}$, which is constrained by the DC bus voltage $V_{dc}$. The number of levels, $N$, determines the granularity of the discrete voltage steps the inverter can produce to approximate the continuous reference waveform. A higher $N$ results in a staircase output voltage that is a better approximation of the sinusoidal reference, thus reducing the total harmonic distortion (THD). However, as long as the inverter is operating in the linear range (i.e., the reference waveform is not being clipped), the amplitude of the *fundamental* component is dictated by the reference signal itself, not by the number of steps used to construct it. Therefore, for any $N \\ge 2$, the number of levels $N$ does not affect the achievable fundamental line-to-line peak amplitude. The result is independent of $N$.\n\nIn summary, the maximum achievable line-to-line fundamental peak amplitude is derived directly from the phase voltage amplitude, which is defined by $m_a$ and $V_{dc}$. It is independent of both the zero-sequence injection and the number of inverter levels $N$.\n\nThe final expression is:\n$$V_{LL,peak} = \\frac{\\sqrt{3}}{2} m_a V_{dc}$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2} m_a V_{dc}}$$"
        },
        {
            "introduction": "Beyond synthesizing the output voltage, modulation strategies for multilevel inverters must manage the state of internal energy storage elements. Focusing on the flying-capacitor topology, this problem provides hands-on practice in analyzing one of the most critical operational challenges: capacitor voltage balancing . By calculating the peak-to-peak energy fluctuation in a flying capacitor over a single switching period, you will directly link the modulation duty cycles to the physical stress on components, a crucial step in capacitor sizing and control design.",
            "id": "3859566",
            "problem": "A single-leg three-level flying-capacitor inverter synthesizes three output voltage levels across the phase: $-V_{\\mathrm{dc}}/2$, $0$, and $+V_{\\mathrm{dc}}/2$, where $V_{\\mathrm{dc}}$ is the direct-current (DC) link voltage. The leg employs a flying capacitor with capacitance $C_{\\mathrm{f}}$ whose nominal voltage is $V_{\\mathrm{dc}}/2$. Over one switching period $T_{\\mathrm{s}}$ of pulse width modulation (PWM), assume the phase load current is approximately constant and equal to $I0$ (positive current flows from the inverter to the load). The modulation strategy allocates a fraction $\\gamma$ of the period to the zero-level state. Within this zero-level occupancy of duration $\\tau_{0}=\\gamma T_{\\mathrm{s}}$, a capacitor-balancing control splits the zero-level into two subintervals: during the first subinterval of duration $D\\,\\tau_{0}$ the switching configuration yields a capacitor current $+I$ (charging), and during the second subinterval of duration $(1-D)\\,\\tau_{0}$ it yields a capacitor current $-I$ (discharging). Outside the zero-level intervals, the capacitor is bypassed and its current is zero. Assume ideal switches, negligible parasitics, and that the flying capacitor voltage at the beginning of the period is $V_{\\mathrm{c}}(0)=V_{\\mathrm{dc}}/2$.\n\nStarting from the constitutive relation of a capacitor and standard energy definitions, derive the peak-to-peak variation of energy stored in the flying capacitor over the switching period, and then compute its numerical value for the following parameters:\n- $C_{\\mathrm{f}}=100\\,\\mu\\mathrm{F}$,\n- $V_{\\mathrm{dc}}=600\\,\\mathrm{V}$,\n- $T_{\\mathrm{s}}=50\\,\\mu\\mathrm{s}$,\n- $\\gamma=0.4$,\n- $I=20\\,\\mathrm{A}$,\n- $D=0.3$.\n\nRound your final numerical result to four significant figures. Express the final energy in millijoules (mJ), and provide only the numerical value.",
            "solution": "The problem requires the derivation and calculation of the peak-to-peak variation of energy stored in the flying capacitor of a three-level inverter over one switching period.\n\nFirst, we establish the fundamental principles. The energy $E_{\\mathrm{c}}$ stored in a capacitor with capacitance $C_{\\mathrm{f}}$ and voltage $V_{\\mathrm{c}}$ is given by:\n$$E_{\\mathrm{c}}(t) = \\frac{1}{2} C_{\\mathrm{f}} V_{\\mathrm{c}}(t)^2$$\nThe peak-to-peak variation of energy, $\\Delta E_{\\mathrm{c,pp}}$, is the difference between the maximum and minimum energy stored in the capacitor over one switching period $T_{\\mathrm{s}}$:\n$$\\Delta E_{\\mathrm{c,pp}} = E_{\\mathrm{c,max}} - E_{\\mathrm{c,min}}$$\nSince $E_{\\mathrm{c}}$ is a monotonic function of $|V_{\\mathrm{c}}|$ and the capacitor voltage remains positive, the maximum and minimum energy values correspond to the maximum and minimum voltage values, $V_{\\mathrm{c,max}}$ and $V_{\\mathrm{c,min}}$, respectively.\n$$E_{\\mathrm{c,max}} = \\frac{1}{2} C_{\\mathrm{f}} V_{\\mathrm{c,max}}^2$$\n$$E_{\\mathrm{c,min}} = \\frac{1}{2} C_{\\mathrm{f}} V_{\\mathrm{c,min}}^2$$\nTherefore, the peak-to-peak energy variation can be expressed as:\n$$\\Delta E_{\\mathrm{c,pp}} = \\frac{1}{2} C_{\\mathrm{f}} (V_{\\mathrm{c,max}}^2 - V_{\\mathrm{c,min}}^2) = \\frac{1}{2} C_{\\mathrm{f}} (V_{\\mathrm{c,max}} - V_{\\mathrm{c,min}})(V_{\\mathrm{c,max}} + V_{\\mathrm{c,min}})$$\n\nTo find $V_{\\mathrm{c,max}}$ and $V_{\\mathrm{c,min}}$, we must analyze the capacitor voltage evolution $V_{\\mathrm{c}}(t)$ over one switching period $T_{\\mathrm{s}}$. The voltage change across a capacitor is determined by integrating the capacitor current $i_{\\mathrm{c}}(t)$ over time, based on its constitutive relation:\n$$V_{\\mathrm{c}}(t) = V_{\\mathrm{c}}(t_0) + \\frac{1}{C_{\\mathrm{f}}} \\int_{t_0}^{t} i_{\\mathrm{c}}(\\tau) d\\tau$$\n\nAccording to the problem statement, the capacitor current $i_{\\mathrm{c}}(t)$ is zero outside the zero-level state interval, which has a duration of $\\tau_0 = \\gamma T_{\\mathrm{s}}$. Let us analyze the voltage evolution during this interval. The initial capacitor voltage at the start of the switching period is given as $V_{\\mathrm{c}}(0) = V_{\\mathrm{dc}}/2$. Since the capacitor current is zero until the zero-level state begins, the voltage at the start of this interval is also $V_{\\mathrm{dc}}/2$.\n\nThe zero-level interval $\\tau_0$ is divided into two subintervals:\n1.  A charging subinterval of duration $D \\tau_0$, during which the capacitor current is $i_{\\mathrm{c}}(t) = +I$.\n2.  A discharging subinterval of duration $(1-D) \\tau_0$, during which the capacitor current is $i_{\\mathrm{c}}(t) = -I$.\n\nSince the constant load current $I$ is positive, the voltage first increases linearly and then decreases linearly. The voltage trajectory during the interval $\\tau_0$ is as follows:\nLet the voltage at the start of the zero-level interval be $V_{\\mathrm{c,start}} = V_{\\mathrm{dc}}/2$.\nAt the end of the first subinterval (duration $D \\tau_0$), the voltage reaches its peak value for the period:\n$$V_{\\mathrm{c,max}} = V_{\\mathrm{c,start}} + \\frac{1}{C_{\\mathrm{f}}} \\int_{0}^{D\\tau_0} I \\, dt = \\frac{V_{\\mathrm{dc}}}{2} + \\frac{I D \\tau_0}{C_{\\mathrm{f}}}$$\nAt the end of the second subinterval (duration $(1-D) \\tau_0$), the voltage reaches its final value for the active interval:\n$$V_{\\mathrm{c,end}} = V_{\\mathrm{c,max}} + \\frac{1}{C_{\\mathrm{f}}} \\int_{D\\tau_0}^{\\tau_0} (-I) \\, dt = V_{\\mathrm{c,max}} - \\frac{I (1-D) \\tau_0}{C_{\\mathrm{f}}}$$\nSubstituting the expression for $V_{\\mathrm{c,max}}$:\n$$V_{\\mathrm{c,end}} = \\left(\\frac{V_{\\mathrm{dc}}}{2} + \\frac{I D \\tau_0}{C_{\\mathrm{f}}}\\right) - \\frac{I (1-D) \\tau_0}{C_{\\mathrm{f}}} = \\frac{V_{\\mathrm{dc}}}{2} + \\frac{I \\tau_0}{C_{\\mathrm{f}}} (D - (1-D)) = \\frac{V_{\\mathrm{dc}}}{2} + \\frac{I \\tau_0 (2D-1)}{C_{\\mathrm{f}}}$$\nThe voltage remains constant at $V_{\\mathrm{c,end}}$ for the rest of the switching period.\n\nGiven $D=0.3$, we have $2D-1 = -0.4$, which is negative. This implies that $V_{\\mathrm{c,end}}  V_{\\mathrm{c,start}}$. The three key voltage points during the period are $V_{\\mathrm{c,start}}$, $V_{\\mathrm{c,max}}$, and $V_{\\mathrm{c,end}}$. The maximum voltage is $V_{\\mathrm{c,max}}$ and the minimum voltage is $V_{\\mathrm{c,min}} = V_{\\mathrm{c,end}}$.\n\nWe can now find the terms for the energy variation formula. Substituting $\\tau_0 = \\gamma T_{\\mathrm{s}}$:\n$$V_{\\mathrm{c,max}} = \\frac{V_{\\mathrm{dc}}}{2} + \\frac{I D \\gamma T_{\\mathrm{s}}}{C_{\\mathrm{f}}}$$\n$$V_{\\mathrm{c,min}} = \\frac{V_{\\mathrm{dc}}}{2} + \\frac{I \\gamma T_{\\mathrm{s}} (2D-1)}{C_{\\mathrm{f}}}$$\nThe voltage difference is:\n$$V_{\\mathrm{c,max}} - V_{\\mathrm{c,min}} = \\left(\\frac{V_{\\mathrm{dc}}}{2} + \\frac{I D \\gamma T_{\\mathrm{s}}}{C_{\\mathrm{f}}}\\right) - \\left(\\frac{V_{\\mathrm{dc}}}{2} + \\frac{I \\gamma T_{\\mathrm{s}} (2D-1)}{C_{\\mathrm{f}}}\\right) = \\frac{I \\gamma T_{\\mathrm{s}}}{C_{\\mathrm{f}}} (D - (2D-1)) = \\frac{I \\gamma T_{\\mathrm{s}} (1-D)}{C_{\\mathrm{f}}}$$\nThe voltage sum is:\n$$V_{\\mathrm{c,max}} + V_{\\mathrm{c,min}} = \\left(\\frac{V_{\\mathrm{dc}}}{2} + \\frac{I D \\gamma T_{\\mathrm{s}}}{C_{\\mathrm{f}}}\\right) + \\left(\\frac{V_{\\mathrm{dc}}}{2} + \\frac{I \\gamma T_{\\mathrm{s}} (2D-1)}{C_{\\mathrm{f}}}\\right) = V_{\\mathrm{dc}} + \\frac{I \\gamma T_{\\mathrm{s}}}{C_{\\mathrm{f}}} (D + 2D-1) = V_{\\mathrm{dc}} + \\frac{I \\gamma T_{\\mathrm{s}} (3D-1)}{C_{\\mathrm{f}}}$$\nSubstituting these into the expression for $\\Delta E_{\\mathrm{c,pp}}$:\n$$\\Delta E_{\\mathrm{c,pp}} = \\frac{1}{2} C_{\\mathrm{f}} \\left( \\frac{I \\gamma T_{\\mathrm{s}} (1-D)}{C_{\\mathrm{f}}} \\right) \\left( V_{\\mathrm{dc}} + \\frac{I \\gamma T_{\\mathrm{s}} (3D-1)}{C_{\\mathrm{f}}} \\right)$$\n$$\\Delta E_{\\mathrm{c,pp}} = \\frac{1}{2} I \\gamma T_{\\mathrm{s}} (1-D) \\left( V_{\\mathrm{dc}} + \\frac{I \\gamma T_{\\mathrm{s}} (3D-1)}{C_{\\mathrm{f}}} \\right)$$\nThis is the symbolic expression for the peak-to-peak energy variation.\n\nNow, we substitute the given numerical values:\n$C_{\\mathrm{f}} = 100\\,\\mu\\mathrm{F} = 100 \\times 10^{-6}\\,\\mathrm{F}$\n$V_{\\mathrm{dc}} = 600\\,\\mathrm{V}$\n$T_{\\mathrm{s}} = 50\\,\\mu\\mathrm{s} = 50 \\times 10^{-6}\\,\\mathrm{s}$\n$\\gamma = 0.4$\n$I = 20\\,\\mathrm{A}$\n$D = 0.3$\n\nFirst, calculate the intermediate terms:\n$$I \\gamma T_{\\mathrm{s}} = (20\\,\\mathrm{A})(0.4)(50 \\times 10^{-6}\\,\\mathrm{s}) = 400 \\times 10^{-6}\\,\\mathrm{C} = 4 \\times 10^{-4}\\,\\mathrm{C}$$\n$$1-D = 1-0.3 = 0.7$$\n$$3D-1 = 3(0.3)-1 = 0.9-1 = -0.1$$\nNow, calculate the term in the parenthesis:\n$$V_{\\mathrm{dc}} + \\frac{I \\gamma T_{\\mathrm{s}} (3D-1)}{C_{\\mathrm{f}}} = 600\\,\\mathrm{V} + \\frac{(4 \\times 10^{-4}\\,\\mathrm{C})(-0.1)}{100 \\times 10^{-6}\\,\\mathrm{F}} = 600\\,\\mathrm{V} - \\frac{0.4 \\times 10^{-4}\\,\\mathrm{C}}{1 \\times 10^{-4}\\,\\mathrm{F}} = 600\\,\\mathrm{V} - 0.4\\,\\mathrm{V} = 599.6\\,\\mathrm{V}$$\nFinally, calculate $\\Delta E_{\\mathrm{c,pp}}$:\n$$\\Delta E_{\\mathrm{c,pp}} = \\frac{1}{2} (4 \\times 10^{-4}\\,\\mathrm{C}) (0.7) (599.6\\,\\mathrm{V})$$\n$$\\Delta E_{\\mathrm{c,pp}} = (2 \\times 10^{-4}\\,\\mathrm{C}) (0.7) (599.6\\,\\mathrm{V}) = (1.4 \\times 10^{-4}\\,\\mathrm{C}) (599.6\\,\\mathrm{V})$$\n$$\\Delta E_{\\mathrm{c,pp}} = 0.083944\\,\\mathrm{J}$$\nThe problem requires the answer in millijoules (mJ):\n$$\\Delta E_{\\mathrm{c,pp}} = 0.083944\\,\\mathrm{J} \\times 1000\\,\\frac{\\mathrm{mJ}}{\\mathrm{J}} = 83.944\\,\\mathrm{mJ}$$\nRounding to four significant figures, we get $83.94\\,\\mathrm{mJ}$.",
            "answer": "$$\\boxed{83.94}$$"
        }
    ]
}