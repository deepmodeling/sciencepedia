## 引言
随着开关电源在现代电子设备中的普及，由其[非线性](@entry_id:637147)输入级（如[整流](@entry_id:197363)桥和滤波电容）引起的电网[谐波](@entry_id:181533)污染问题日益严重。这些设备从电网吸取脉冲式的非正弦电流，导致[功率因数](@entry_id:270707)低下，降低了电能利用效率，并对电网的稳定性构成威胁。为了满足日益严格的电能质量标准（如IEC 61000-3-2），功率因数校正（PFC）技术应运而生，其核心目标是强制电子负载从电网吸取正弦波电流，并使其与电网电压同相，从而表现为一个纯粹的电阻性负载。

在众多PFC实现方案中，基于升压（Boost）拓扑并工作在[连续导通模式](@entry_id:269432)（CCM）的PFC变换器因其结构简单、效率高、能提供高于输入峰值电压的稳定直流输出而备受青睐。然而，要实现高性能的功率因数校正，关键在于采用先进的控制策略。本文聚焦于其中一种主流且性能卓越的技术——[平均电流控制](@entry_id:1121287)（Average Current Control, ACC）。理解ACC的深层机制、掌握其设计方法并应对实际工程中的挑战，是设计高效、可靠PFC电源的关键。

本文将通过三个章节，系统性地引导读者深入掌握CCM升压PFC的设计与控制。在**第一章“原理与机制”**中，我们将从[功率因数](@entry_id:270707)、[谐波失真](@entry_id:264840)等基本概念出发，揭示单相PFC固有的能量缓冲需求，并详细剖析[平均电流控制](@entry_id:1121287)的级联结构、信号生成方式以及关键的环路动态设计。随后，在**第二章“应用与跨学科连接”**中，我们将理论与实践相结合，探讨核心功率元件（电感、半导体）的优化设计、控制环路的实现挑战、系统级集成考量（如[保持时间](@entry_id:266567)和EMI滤波）以及先进的控制策略。最后，**第三章“动手实践”**将通过具体计算问题，帮助读者巩固关键的设计技能。

让我们首先从深入理解PFC变换器的基本工作原理与核心控制机制开始。

## 原理与机制

本章深入探讨在[连续导通模式](@entry_id:269432)（CCM）下运行的升压式功率因数校正（PFC）变换器的核心工作原理与控制机制，重点关注[平均电流控制](@entry_id:1121287)（Average Current Control, ACC）方法的实现。我们将从基本概念入手，逐步构建一个完整的系统视图，涵盖从[功率因数](@entry_id:270707)定义到详细的控制环路设计和实际运行中的非理想效应。

### 功率因数、谐波失真与位移角

功率因数校正的首要目标是使[非线性](@entry_id:637147)负载（如前端为[整流](@entry_id:197363)桥和电容的电源）对于交流电网来说，表现得如同一个纯电阻。一个理想的电阻性负载，其消耗的电流波形为正弦波，且与电网电压同相。为了量化偏离这一理想状态的程度，我们引入两个关键指标：**[功率因数](@entry_id:270707)（Power Factor, PF）**和**[总谐波失真](@entry_id:272023)（Total Harmonic Distortion, THD）**。

**功率因数**被定义为传输给负载的**[平均功率](@entry_id:271791)**（或称有功功率）$P$ 与从电源获取的**[视在功率](@entry_id:1121069)** $S$ 之比：
$$
\text{PF} = \frac{P}{S}
$$
视在功率$S$是总均方根（RMS）电压 $V_{\text{rms}}$ 与总[均方根](@entry_id:263605)电流 $I_{\text{rms}}$ 的乘积，即 $S = V_{\text{rms}} I_{\text{rms}}$。[平均功率](@entry_id:271791)$P$则代表在一个线路周期内瞬时功率的平均值。

当电网电压 $v_{\text{ac}}(t)$ 是一个纯正弦波时，例如 $v_{\text{ac}}(t) = V_{\text{m}}\sin(\omega t)$，只有与电压同频率的电流分量（即基波分量）才能产生平均功率。假设输入电流 $i_{\text{in}}(t)$ 由于[非线性](@entry_id:637147)开关操作而包含多个频率的[谐波](@entry_id:181533)，其傅里叶级数可表示为各次谐[波的叠加](@entry_id:166456)。其总[均方根值](@entry_id:276804) $I_{\text{rms}}$ 可由各[次谐波](@entry_id:171489)的[均方根值](@entry_id:276804) $I_n$ 通过帕萨瓦尔定理（Parseval's theorem）计算得出：
$$
I_{\text{rms}} = \sqrt{\sum_{n=1}^{\infty} I_n^2} = \sqrt{I_1^2 + I_2^2 + I_3^2 + \dots}
$$
其中 $I_1$ 是基波电流的[均方根值](@entry_id:276804)，而 $I_2, I_3, \dots$ 是各次谐波电流的均方根值。

[平均功率](@entry_id:271791) $P$ 仅由电压和电流的基波分量决定：
$$
P = V_1 I_1 \cos(\phi)
$$
其中 $V_1$ 是基波电压的[均方根值](@entry_id:276804)（在此即为 $V_{\text{rms}}$），$\phi$ 是基波电压与基波电流之间的相位差，称为**位移角（displacement angle）**。$\cos(\phi)$ 被称为**[位移功率因数](@entry_id:1123858)（Displacement Power Factor, DPF）**，它衡量了电流相对于电压的相位偏移。

**电流[总谐波失真](@entry_id:272023)** $\text{THD}_i$ 被严格定义为所有[谐波](@entry_id:181533)分量的[均方根值](@entry_id:276804)与基波分量的[均方根值](@entry_id:276804)之比：
$$
\text{THD}_i = \frac{\sqrt{\sum_{n=2}^{\infty} I_n^2}}{I_1}
$$
这个定义揭示了电流波形与理想正弦波的偏离程度。通过该定义，我们可以将总均方根电流 $I_{\text{rms}}$ 表示为基波电流 $I_1$ 和 $\text{THD}_i$ 的函数：
$$
I_{\text{rms}} = I_1 \sqrt{1 + \text{THD}_i^2}
$$
将 $P$ 和 $S$ 的表达式代入[功率因数](@entry_id:270707)的定义，我们便得到了连接这三个关键概念的重要关系 ：
$$
\text{PF} = \frac{P}{S} = \frac{V_1 I_1 \cos(\phi)}{V_1 I_{\text{rms}}} = \frac{I_1 \cos(\phi)}{I_1 \sqrt{1 + \text{THD}_i^2}} = \frac{\cos(\phi)}{\sqrt{1 + \text{THD}_i^2}}
$$
这个公式明确指出，要实现接近于1的[功率因数](@entry_id:270707)，必须同时满足两个条件：
1.  **位移角** $\phi$ 必须接近于零，即 $\cos(\phi) \approx 1$。这意味着基波电流必须与电网电压同相。
2.  **[总谐波失真](@entry_id:272023)** $\text{THD}_i$ 必须尽可能小。这意味着输入电流波形必须接近完美的正弦波。

PFC变换器的[控制系统设计](@entry_id:273663)的核心，正是为了同时满足这两个条件。

### 单相PFC的能量缓冲机制

在实现[单位功率因数](@entry_id:1133604)的目标时，单相系统面临一个固有的物理挑战。当输入电压 $v_{\text{ac}}(t) = V_p \sin(\omega t)$ 且输入电流 $i_{\text{ac}}(t) = I_p \sin(\omega t)$ 时，从电网吸收的瞬时功率为：
$$
p_{\text{in}}(t) = v_{\text{ac}}(t) i_{\text{ac}}(t) = V_p I_p \sin^2(\omega t) = \frac{V_p I_p}{2}(1 - \cos(2\omega t))
$$
假设变换器是无损的，平均输入功率 $P_o = \frac{V_p I_p}{2}$ 等于负载消耗的恒定功率。因此，瞬时输入功率可以写成：
$$
p_{\text{in}}(t) = P_o (1 - \cos(2\omega t))
$$
这个表达式揭示了一个关键问题：输入功率以两倍于线路频率（例如，对于50 Hz的电网，频率为100 Hz）的频率脉动，其值在 $0$ 和 $2P_o$ 之间波动。然而，典型的直流负载需要一个恒定的功率 $P_o$。这种瞬时功率的不匹配 $\Delta p(t) = p_{\text{in}}(t) - P_o = -P_o \cos(2\omega t)$ 必须由变换器内部的储能元件来缓冲。

在升压式PFC变换器中，控制系统强制电感电流跟随正弦参考，因此电感主要扮演高频（开关频率）能量传递的角色，其在工频尺度上的平均储能并不能完全补偿上述的低频功率脉动。因此，能量缓冲的重任落在了**输出电容器** $C_o$ 上。该电容器吸收输入功率高于平均值时的多[余能](@entry_id:192009)量，并在输入功率低于平均值时释放能量以供给负载。

这种能量交换导致输出直流母线电压 $V_o$ 上叠加一个显著的低频纹波，其频率为两倍线路频率。我们可以估算这个纹波的大小。流入电容的功率为 $p_c(t) \approx -P_o \cos(2\omega t)$。由于母线电压纹波 $\Delta v_{o,\text{pp}}$ 相对于直流电压 $V_o$ 较小，流入电容的电流可近似为 $i_c(t) \approx p_c(t)/V_o$。通过对电流积分，可以得到电压纹波的峰峰值 $\Delta v_{o,\text{pp}}$ 与所需电容 $C_o$ 的关系 ：
$$
C_o = \frac{P_o}{2\omega V_o \Delta v_{o,\text{pp}}}
$$
例如，对于一个 $1\,\mathrm{kW}$ 的电源，输入频率为 $50\,\mathrm{Hz}$ ($\omega = 100\pi\,\mathrm{rad/s}$)，输出电压为 $400\,\mathrm{V}$，若要求电压纹波峰峰值不超过 $8\,\mathrm{V}$（即峰值纹波 $\Delta v_{o,\text{p}} = 4\,\text{V}$），则需要的输出电容约为 $2.0\,\mathrm{mF}$。这表明，单相PFC变换器需要一个体积庞大的**大容量电解电容（bulk capacitor）**来进行低频能量缓冲，这是其设计的固有特性。

### [平均电流控制](@entry_id:1121287)（ACC）的结构

为了精确地将输入电流整形为与输入电压同相的正弦波，**[平均电流控制](@entry_id:1121287)（Average Current Control, ACC）**是一种广泛应用的先进技术。其基本思想是构建一个快速的内部电流控制环路，强制开关周期平均的电感电流 $\langle i_L(t) \rangle$ 精确跟踪一个与整流后输入电压 $v_{\text{rec}}(t) = |v_{\text{ac}}(t)|$ 成正比的电流参考 $i^*(t)$。

整个控制系统是一个**级联结构**：
*   **内环（电流环）**：一个高带宽的控制环路，负责电流整形。它的响应速度远快于线路频率，确保在每个线路周期的不同点上，电感电流都能快速跟随其正弦变化的参考值。
*   **外环（电压环）**：一个低带宽的控制环路，负责调节直流输出母线电压 $V_o$ 的平均值。它通过感知输出电压与设定值 $V_{\text{ref}}$ 之间的误差，缓慢地调整电流参考的**幅度**，从而控制从电网吸收的平均功率。

#### 内环：电流参考的生成与跟踪

**1. 乘法器与参考生成**

电流参考 $i^*(t)$ 的生成是ACC的核心。它由一个**乘法器模块**实现，该模块将两个输入信号相乘：一个是代表输入电压波形的**形状参考** $v_{\text{rec}}(t)$，另一个是来自外环的、缓慢变化的**幅度指令**，我们称之为 $k(t)$。因此，$i^*(t) = k(t) v_{\text{rec}}(t)$。

为了维持稳定的输出功率，即使输入线路电压的有效值发生变化，也需要对幅度指令进行适当的归一化。外环的输出可以被理解为一个期望的平均输入功率指令 $p_*(t)$。我们知道，平均输入功率为 $P = \langle p_{\text{in}}(t) \rangle = \langle v_{\text{rec}}(t) i_{\text{in}}(t) \rangle$。如果 $i_{\text{in}}(t) = k(t) v_{\text{rec}}(t)$，则 $P = k(t) \langle v_{\text{rec}}^2(t) \rangle$。为了使 $P$ 等于 $p_*(t)$，幅度指令 $k(t)$ 必须是：
$$
k(t) = \frac{p_*(t)}{\langle v_{\text{rec}}^2(t) \rangle}
$$
其中 $\langle v_{\text{rec}}^2(t) \rangle$ 是整流输入电压的均方值，它与输入电压的均方根（RMS）值的平方成正比。在实际控制器中，这个值可以通过对 $v_{\text{rec}}^2(t)$ 进行低通滤波来估计，我们记为 $\widehat{v_{\text{rec}}^{2}}(t)$。因此，完整的电流参考信号由以下公式生成 ：
$$
i^*(t) = \frac{p_*(t)}{\widehat{v_{\text{rec}}^{2}}(t)} v_{\text{rec}}(t)
$$
这种结构包含了一个**输入电压前馈**，使得控制器能够自动调整电流大小以响应输入电压的变化，从而在不同的输入电压下保持恒定的输入功率，这对于通用输入范围（例如 $90\,\mathrm{V}$ 至 $265\,\mathrm{V}$）的应用至关重要。

**2. 从误差到[占空比](@entry_id:199172)的转换**

电流环通过比较实际感测到的平均电感电流 $\langle i_{L,sensed}(t) \rangle$ 与参考电流 $i^*(t)$ 来产生一个[误差信号](@entry_id:271594)。这个[误差信号](@entry_id:271594)被一个**电流[误差放大](@entry_id:749086)器**（一个补偿器，通常是[PI控制器](@entry_id:268031)）处理，生成一个控制电压 $v_c(t)$。

此控制电压 $v_c(t)$ 随后被送入一个**[脉宽调制](@entry_id:262754)器（PWM）**。[PWM调制器](@entry_id:1130326)将 $v_c(t)$ 与一个固定频率、固定幅度的锯齿波或三角波斜坡信号 $v_{\text{ramp}}(t)$ 进行比较，从而生成驱动功率开关的门极信号，其**[占空比](@entry_id:199172)** $D(t)$ 与 $v_c(t)$ 成正比。

控制逻辑必须确保一个稳定的负反馈。对于升压变换器，在开关导通期间，电感电流上升；在开关关断期间，电感电流下降。为了提高平均电感电流，必须增加[占空比](@entry_id:199172) $D(t)$。因此，控制器的设计必须遵循以下逻辑：当感测电流低于参考电流时，误差为正，电流[误差放大](@entry_id:749086)器输出的 $v_c(t)$ 增加，导致[PWM调制器](@entry_id:1130326)产生一个更大的[占空比](@entry_id:199172)，从而使电流上升 。

**3. 动态范围的挑战**

为了实现低THD，电流环必须在整个线路周期内精确跟踪参考。这意味着从线路电压峰值处的大电流，到接近零交叉点的微小电流，都必须被精确控制。这对控制器的模拟和数字部分提出了巨大的**动态范围**要求。例如，一个在$90\,\mathrm{V}$线路电压下工作于$1000\,\mathrm{W}$的PFC，其[峰值电流](@entry_id:264029)可达约$15.7\,\mathrm{A}$。为了保持低于$3\%$的THD，可能需要精确控制低至峰值$1\%$（约$0.157\,\mathrm{A}$）的电流。这要求电流检测电路、乘法器和[误差放大](@entry_id:749086)器具有至少 $40\,\mathrm{dB}$ 的线性动态范围 。任何在零交叉点附近的[非线性](@entry_id:637147)、噪声或失调都可能导致所谓的“交叉失真”，显著增加低[次谐波](@entry_id:171489)并恶化THD。

**4. 输入电压前馈的线性化作用**

升压变换器的动态响应（即[占空比](@entry_id:199172)变化对电感电流变化的影响）与输入电压 $v_{\text{rec}}(t)$ 和输出电压 $V_o$ 相关。在一个线路周期内，$v_{\text{rec}}(t)$ 不断变化，这意味着[电流环路](@entry_id:271292)的“被控对象”的增益也在变化。这种[非线性](@entry_id:637147)给[补偿器设计](@entry_id:261528)带来了挑战。

为了解决这个问题，可以引入一种更直接的**输入电压前馈**技术。理想升压变换器的[占空比](@entry_id:199172)由[电压转换比](@entry_id:1133878)决定：$D(t) = 1 - \frac{v_{\text{rec}}(t)}{V_o}$。我们可以将控制器输出的[占空比](@entry_id:199172)分解为两部分：一个前馈项 $d_{\text{ff}}(t)$ 和一个反馈校正项 $d_c(t)$。如果选择前馈项恰好等于理想[占空比](@entry_id:199172) ：
$$
d_{\text{ff}}(t) = 1 - \frac{v_{\text{rec}}(t)}{V_o}
$$
那么，经过推导可以发现，从反馈校正项 $d_c(t)$ 到电感电流 $i_L(t)$ 的动态关系将不再依赖于变化的输入电压 $v_{\text{rec}}(t)$。它变成了一个具有固定增益（由 $V_o$ 和 $L$ 决定）的简单[积分器](@entry_id:261578)。这极大地简化了[电流环路](@entry_id:271292)补偿器的设计，并使其在整个线路周期内都能保持一致的、优化的动态性能。

#### 外环：直流母线电压的调节

外环（电压环）的职责是维持输出电压 $V_o$ 的平均值稳定。它通过比较感测到的输出电压与参考电压 $V_{\text{ref}}$，并利用一个补偿器（通常是[PI控制器](@entry_id:268031)）来生成前述的功率指令 $p_*(t)$。

电压环路的设计中，最关键的参数是其**带宽**。如前所述，输出电压上必然存在两倍线路频率的纹波。如果电压环的带宽过高（例如，接近或高于 $2f_{\text{line}}$），控制器将会试图“修正”这个纹波。它会错误地将这个纹波解读为负载变化，从而在 $p_*(t)$ 中产生一个 $2f_{\text{line}}$ 的分量。这个分量通过乘法器会调制电流参考 $i^*(t)$，最终在输入电流中引入三次谐波（$2\omega$ 与 $\omega$ 混合产生 $\omega$ 和 $3\omega$ 分量），严重破坏[功率因数](@entry_id:270707)。

因此，电压环的带宽**必须**被设计得远低于两倍线路频率。一个常见的设计准则是将电压环的带宽设置在 $10\,\mathrm{Hz}$ 到 $20\,\mathrm{Hz}$ 之间，这远低于 $100\,\mathrm{Hz}$ 或 $120\,\mathrm{Hz}$ 的纹波频率。这样，电压环路就能够有效地“忽略”这个固有的纹波，只对负载或线路电压的慢速平均变化做出响应，从而确保输入电流的低谐波失真 。这种快慢环路的分离是级联控制成功的关键。

### 关键元件设计与工作模式

#### 电感设计与连续导通模式（CCM）

为了使[平均电流控制](@entry_id:1121287)有效工作并获得较低的[传导损耗](@entry_id:1122865)，通常希望升压PFC在整个线路周期内都工作在**[连续导通模式](@entry_id:269432)（Continuous Conduction Mode, CCM）**。CCM意味着电感电流 $i_L(t)$ 在任何开关周期内都始终保持大于零。

电感电流的谷值等于其开关周期平均值减去峰峰值纹波的一半。因此，维持CCM的条件是：
$$
\langle i_L(t) \rangle > \frac{\Delta i_L(t)}{2}
$$
其中，$\langle i_L(t) \rangle = i_{\text{in}}(t)$ 是由控制目标设定的平均电流，而 $\Delta i_L(t)$ 是开关频率下的电流纹波。电流纹波在开关导通期间产生，其大小为 $\Delta i_L(t) = \frac{v_{\text{in}}(t)}{L} D(t) T_s$。

最难维持CCM的时刻，是平均电流相对于纹波电流最小的时候。通过分析可以发现，这个“最坏情况”发生在输入电压接近零交叉点时。此时，平均电流 $i_{\text{in}}(t)$ 趋近于零，而[占空比](@entry_id:199172) $D(t)$ 趋近于1，导致电流纹波相对较大。为了确保在整个线路周期内（除了电压恰好为零的瞬间）都维持CCM，必须选择足够大的电感 $L$。通过在 $v_{\text{in}}(t) \to 0$ 的极限条件下求解上述不等式，可以得到保证CCM的最小电感值 ：
$$
L > \frac{V_{\text{m}}^2}{4 P f_s}
$$
其中 $V_{\text{m}}$ 是输入电压峰值，$P$ 是额定功率，$f_s$ 是开关频率。这个公式是PFC电感设计的关键出发点。

#### 局部[不连续导通模式](@entry_id:1123811)（DCM）及其影响

尽管设计上以CCM为目标，但在轻载或低输入电压条件下，PFC变换器仍可能在靠近线路电压零交叉点的地方局部进入**[不连续导通模式](@entry_id:1123811)（Discontinuous Conduction Mode, DCM）**。这种情况发生在平均电流小到不足以维持电感电流始终为正时，即当 $P_{\text{out}} \le \frac{V_{\text{m}}^2 T_s}{4L}$ 时 。

当变换器局部进入DCM时，电感电流会在每个开关周期的部分时间内降至零。这会导致变换器的动态特性发生剧烈变化，从[占空比](@entry_id:199172)到平均电流的传递函数不再是CCM下的线性关系，而呈现出强烈的[非线性](@entry_id:637147)。为CC[M模式](@entry_id:915690)设计的[电流环路](@entry_id:271292)控制器在这种情况下将无法精确跟踪正弦参考。结果是，实际的输入电流波形在零交叉点附近会变得“扁平”或出现“[死区](@entry_id:183758)”，这引入了显著的低[次谐波](@entry_id:171489)（特别是三次和五[次谐波](@entry_id:171489)），从而增加了[总谐波失真](@entry_id:272023)THD，降低了功率因数。这是实际PFC设计中需要特别关注和设法缓解的一个重要非理想效应。

### 高级控制与稳定性考量

#### 内[环带](@entry_id:163678)宽的选择

电流环的带宽 $f_{c,i}$ 是一个关键的设计参数，它的选择涉及多方面的权衡 ：
1.  **跟踪性能**：为了精确跟踪正弦参考（例如$50/60\,\mathrm{Hz}$），带宽需要远高于线路频率。通常要求 $f_{c,i}$ 至少是线路频率的几十倍，以将[稳态](@entry_id:139253)[跟踪误差](@entry_id:273267)和[相位延迟](@entry_id:186355)降至可接受的水平。
2.  **稳定性**：带宽不能过高。PWM过程和[信号采样](@entry_id:261929)会引入等效的延时，产生[相位滞后](@entry_id:172443)，限制了可实现的最高带宽。通常，为保证足够的相位裕度，带宽应限制在开关频率的$1/10$到$1/5$之间。例如，对于$100\,\mathrm{kHz}$的开关频率，一个$10\,\mathrm{kHz}$的电流[环带](@entry_id:163678)宽是常见的选择。
3.  **[噪声抑制](@entry_id:276557)**：环路必须能抑制开关频率及其[谐波](@entry_id:181533)的噪声。[闭环系统](@entry_id:270770)的响应在高频段应具有衰减特性，因此带宽不应太接近开关频率。
4.  **环路分离**：为了保证级联控制的稳定性，内环（电流环）的带宽必须远高于外环（电压环）的带宽，通常要求至少有5到10倍的差距。

综合这些因素，电流[环带](@entry_id:163678)宽的选择是一个在快速响应和稳定鲁棒性之间的精心折衷。

#### 关于[次谐波振荡](@entry_id:1132606)的讨论

在[电流模式控制](@entry_id:1123295)中，**次谐波振荡**（或称周期倍增不稳定性）是一个著名的问题。它在**[峰值电流模式控制](@entry_id:1129480)（PCM）**中尤为突出，当[占空比](@entry_id:199172)超过0.5时，若无**[斜坡补偿](@entry_id:1131757)**，系统会变得不稳定。

然而，[平均电流控制](@entry_id:1121287)（ACC）的机制与PCM有本质区别。ACC不依赖于对瞬时电感电流峰值的比较来[终止开关](@entry_id:198172)周期。相反，它调节的是经过低通滤波后的平均电流。其稳定性不直接取决于[占空比](@entry_id:199172)是否超过0.5，而是由作为标准[采样数据系统](@entry_id:1131192)的[环路增益](@entry_id:268715)和相位特性决定。

只要电流环的带宽被设计得远低于开关频率的一半（$f_s/2$），[环路增益](@entry_id:268715)在可能引起奈奎斯特不稳定的关键频率点（$f_s/2$）就已经被充分衰减。因此，在正确设计的ACC系统中，类似于PCM中的次谐波振荡问题通常不会发生，也**不需要**传统的斜坡补偿 。这是ACC相对于PCM的一个显著优势，特别是在[占空比](@entry_id:199172)范围很宽的PFC应用中。