{
    "hands_on_practices": [
        {
            "introduction": "The primary purpose of dq-frame control is the independent regulation of active and reactive power. This exercise solidifies the foundational link between the dq-frame currents, which are the variables directly regulated by the controller, and the power delivered to the grid. By working through a hypothetical scenario involving grid voltage fluctuations, you will gain a deeper intuition for how the controller achieves its objectives and how external disturbances common in weak grids can affect power regulation, demonstrating the direct proportionality between grid voltage and power output for a given current setpoint. ",
            "id": "3836167",
            "problem": "A three-phase grid-connected voltage source converter employs synchronous reference frame current control with a Phase-Locked Loop (PLL) aligned to the positive-sequence grid voltage so that the synchronous $d$-axis tracks the grid voltage phasor and the synchronous $q$-axis is in quadrature. The grid is weak, and its voltage amplitude varies by $\\pm 10$\\% around a nominal line-to-line root-mean-square (RMS) value. Assume a balanced, sinusoidal, positive-sequence grid with negligible zero-sequence and harmonics, and that the converter’s current controller commands constant direct-quadrature currents $(i_d, i_q)$ in steady state.\n\nStarting from the instantaneous three-phase active power definition $p = v_a i_a + v_b i_b + v_c i_c$, the corresponding reactive power definition based on the orthogonal decomposition of the space vectors, and the properties of the Park/Clarke transformations, derive the mapping from synchronous-frame voltages and currents to average active power $P$ and reactive power $Q$. Explicitly state the sign convention you adopt for $Q$ in the synchronous frame. Then, specialize to the case where the PLL maintains $v_q \\approx 0$, and express $P$ and $Q$ in terms of $v_d$, $i_d$, and $i_q$.\n\nFor numerical concreteness, take the nominal grid line-to-line RMS voltage to be $V_{\\text{LL,rms}} = 400~\\text{V}$. Compute the corresponding nominal synchronous $d$-axis voltage amplitude $v_{d,0}$ in volts, assuming $v_d$ equals the line-to-neutral peak of the positive-sequence grid voltage under perfect PLL alignment. Model the weak-grid amplitude variation as $v_d = v_{d,0} (1 + \\varepsilon)$ with $\\varepsilon \\in [-0.1, 0.1]$ and $v_q \\approx 0$.\n\nWith $(i_d, i_q)$ held fixed by the current controller, derive the expressions for $P(\\varepsilon)$ and $Q(\\varepsilon)$ and obtain the fractional deviations $\\Delta P / P_0$ and $\\Delta Q / Q_0$ relative to their nominal values at $\\varepsilon = 0$. Finally, report the maximum fractional deviations in both active and reactive power, expressed as decimals, in a single row matrix. No percentage signs are permitted. No units are permitted inside the final boxed answer. If any intermediate numerical evaluation is needed, carry it out exactly; rounding is not required for the final boxed answer.",
            "solution": "The problem requires the derivation of active and reactive power expressions in the synchronous reference frame ($dq$-frame), followed by an analysis of their sensitivity to grid voltage variations under constant current control. The problem is validated to be scientifically grounded, well-posed, and objective.\n\n### Part 1: Derivation of Active and Reactive Power in the Synchronous Frame\n\nWe begin with the definition of instantaneous three-phase active power, $p(t)$, for a three-phase, three-wire system:\n$$p(t) = v_a(t) i_a(t) + v_b(t) i_b(t) + v_c(t) i_c(t)$$\nThe problem asks to use the properties of Clarke and Park transformations. We will use the amplitude-invariant form of the Clarke transformation, which maps the phase quantities $(v_a, v_b, v_c)$ to the stationary $\\alpha\\beta$ frame $(v_\\alpha, v_\\beta)$. For a balanced system (zero-sequence component is zero), this transformation preserves the amplitude of the fundamental component. The transformation for voltages is:\n$$ \\begin{pmatrix} v_\\alpha \\\\ v_\\beta \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 1 & -\\frac{1}{2} & -\\frac{1}{2} \\\\ 0 & \\frac{\\sqrt{3}}{2} & -\\frac{\\sqrt{3}}{2} \\end{pmatrix} \\begin{pmatrix} v_a \\\\ v_b \\\\ v_c \\end{pmatrix} $$\nAn identical transformation applies to the currents $(i_a, i_b, i_c)$. For a balanced system, it can be shown that the instantaneous power is given by:\n$$ p(t) = \\frac{3}{2} (v_\\alpha i_\\alpha + v_\\beta i_\\beta) $$\nThis expression represents the total instantaneous power in terms of the stationary frame components. For balanced sinusoidal steady-state conditions, this value is constant and equal to the average active power, $P$.\n\nThe problem also requires defining reactive power $Q$. We define the complex power $S$ in the stationary frame using space vectors $\\vec{v}_{\\alpha\\beta} = v_\\alpha + j v_\\beta$ and $\\vec{i}_{\\alpha\\beta} = i_\\alpha + j i_\\beta$. The complex power is:\n$$ S = P + jQ = \\frac{3}{2} \\vec{v}_{\\alpha\\beta} \\vec{i}_{\\alpha\\beta}^* $$\nwhere $^*$ denotes the complex conjugate. Expanding this gives:\n$$ S = \\frac{3}{2} (v_\\alpha + jv_\\beta)(i_\\alpha - ji_\\beta) = \\frac{3}{2} [ (v_\\alpha i_\\alpha + v_\\beta i_\\beta) + j(v_\\beta i_\\alpha - v_\\alpha i_\\beta) ] $$\nBy equating the real and imaginary parts, we identify the average active power $P$ and reactive power $Q$:\n$$ P = \\frac{3}{2} (v_\\alpha i_\\alpha + v_\\beta i_\\beta) $$\n$$ Q = \\frac{3}{2} (v_\\beta i_\\alpha - v_\\alpha i_\\beta) $$\n\nNext, we apply the Park transformation, which rotates the stationary frame $(\\alpha, \\beta)$ by an angle $\\theta(t)$ to obtain the synchronous frame $(d, q)$. The angle $\\theta(t)$ is provided by the Phase-Locked Loop (PLL) and for a grid frequency $\\omega_g$, $\\theta(t) = \\omega_g t + \\theta_0$. The relationship between the space vectors is:\n$$ \\vec{v}_{dq} = v_d + jv_q = \\vec{v}_{\\alpha\\beta} e^{-j\\theta(t)} $$\n$$ \\vec{i}_{dq} = i_d + ji_q = \\vec{i}_{\\alpha\\beta} e^{-j\\theta(t)} $$\nThe complex power expression is invariant under this rotation:\n$$ S = \\frac{3}{2} \\vec{v}_{\\alpha\\beta} \\vec{i}_{\\alpha\\beta}^* = \\frac{3}{2} (\\vec{v}_{dq}e^{j\\theta}) (\\vec{i}_{dq}e^{j\\theta})^* = \\frac{3}{2} (\\vec{v}_{dq}e^{j\\theta}) (\\vec{i}_{dq}^*e^{-j\\theta}) = \\frac{3}{2} \\vec{v}_{dq} \\vec{i}_{dq}^* $$\nExpanding this in terms of $dq$ components:\n$$ S = \\frac{3}{2} (v_d + jv_q)(i_d - ji_q) = \\frac{3}{2} [ (v_d i_d + v_q i_q) + j(v_q i_d - v_d i_q) ] $$\nThus, the mapping from synchronous-frame voltages and currents to average active and reactive power is:\n$$ P = \\frac{3}{2} (v_d i_d + v_q i_q) $$\n$$ Q = \\frac{3}{2} (v_q i_d - v_d i_q) $$\n\nThe problem asks to state the sign convention for $Q$. In this formulation $S = P+jQ$, with the PLL aligning $v_d$ to the voltage vector (so $v_q = 0$), a lagging current (inductive, $i_q  0$) results in $Q = -\\frac{3}{2}v_d i_q > 0$. Therefore, a positive $Q$ corresponds to the injection of inductive reactive power from the converter to the grid.\n\n### Part 2: Specialization for $v_q \\approx 0$\n\nThe problem specifies that the PLL maintains perfect alignment of the $d$-axis with the grid voltage phasor. Under balanced, sinusoidal conditions, the grid voltage space vector rotates at a constant magnitude and frequency. A perfect PLL tracks this rotation such that the entire voltage vector is projected onto the $d$-axis. This implies that the quadrature component of the voltage is zero. We therefore set $v_q = 0$. Note the problem states $v_q \\approx 0$, but for an ideal steady-state analysis, we take it to be exactly zero.\nSubstituting $v_q = 0$ into the power expressions yields:\n$$ P = \\frac{3}{2} v_d i_d $$\n$$ Q = -\\frac{3}{2} v_d i_q $$\n\n### Part 3: Numerical Evaluation and Fractional Deviations\n\nFirst, we compute the nominal synchronous $d$-axis voltage amplitude, $v_{d,0}$. The nominal line-to-line RMS voltage is given as $V_{\\text{LL,rms}} = 400~\\text{V}$. For a balanced wye-connected system, the line-to-neutral RMS voltage $V_{\\text{LN,rms}}$ is:\n$$ V_{\\text{LN,rms}} = \\frac{V_{\\text{LL,rms}}}{\\sqrt{3}} = \\frac{400}{\\sqrt{3}}~\\text{V} $$\nThe problem states that $v_d$ equals the line-to-neutral peak voltage. The peak voltage $V_{\\text{LN,peak}}$ is $\\sqrt{2}$ times the RMS value:\n$$ v_{d,0} = V_{\\text{LN,peak}} = \\sqrt{2} \\cdot V_{\\text{LN,rms}} = \\sqrt{2} \\cdot \\frac{400}{\\sqrt{3}} = 400 \\sqrt{\\frac{2}{3}}~\\text{V} $$\n\nNext, we model the weak-grid voltage variation as $v_d = v_{d,0} (1 + \\varepsilon)$ where $\\varepsilon \\in [-0.1, 0.1]$. The currents $(i_d, i_q)$ are held constant by the controller. We can now express the active power $P(\\varepsilon)$ and reactive power $Q(\\varepsilon)$ as functions of $\\varepsilon$.\n$$ P(\\varepsilon) = \\frac{3}{2} v_d i_d = \\frac{3}{2} [v_{d,0}(1+\\varepsilon)] i_d = \\left(\\frac{3}{2} v_{d,0} i_d\\right) (1+\\varepsilon) $$\n$$ Q(\\varepsilon) = -\\frac{3}{2} v_d i_q = -\\frac{3}{2} [v_{d,0}(1+\\varepsilon)] i_q = \\left(-\\frac{3}{2} v_{d,0} i_q\\right) (1+\\varepsilon) $$\nThe nominal powers, $P_0$ and $Q_0$, correspond to $\\varepsilon = 0$:\n$$ P_0 = P(0) = \\frac{3}{2} v_{d,0} i_d $$\n$$ Q_0 = Q(0) = -\\frac{3}{2} v_{d,0} i_q $$\nTherefore, $P(\\varepsilon) = P_0 (1+\\varepsilon)$ and $Q(\\varepsilon) = Q_0 (1+\\varepsilon)$.\n\nWe are asked to find the fractional deviations $\\Delta P / P_0$ and $\\Delta Q / Q_0$. We assume that the converter is operating at a point where $i_d \\neq 0$ and $i_q \\neq 0$, such that $P_0 \\neq 0$ and $Q_0 \\neq 0$.\nThe deviation in active power is $\\Delta P = P(\\varepsilon) - P_0 = P_0(1+\\varepsilon) - P_0 = P_0 \\varepsilon$. The fractional deviation is:\n$$ \\frac{\\Delta P}{P_0} = \\frac{P_0 \\varepsilon}{P_0} = \\varepsilon $$\nSimilarly, the deviation in reactive power is $\\Delta Q = Q(\\varepsilon) - Q_0 = Q_0(1+\\varepsilon) - Q_0 = Q_0 \\varepsilon$. The fractional deviation is:\n$$ \\frac{\\Delta Q}{Q_0} = \\frac{Q_0 \\varepsilon}{Q_0} = \\varepsilon $$\nThe fractional deviations in both active and reactive power are equal to $\\varepsilon$.\n\nFinally, we must report the maximum fractional deviations. The range for $\\varepsilon$ is $[-0.1, 0.1]$. The term \"maximum fractional deviation\" is interpreted as the maximum absolute value of this fractional change.\nThe maximum absolute value of $\\varepsilon$ is $|\\pm 0.1| = 0.1$.\nTherefore, the maximum fractional deviation for active power is:\n$$ \\max\\left|\\frac{\\Delta P}{P_0}\\right| = \\max|\\varepsilon| = 0.1 $$\nAnd the maximum fractional deviation for reactive power is:\n$$ \\max\\left|\\frac{\\Delta Q}{Q_0}\\right| = \\max|\\varepsilon| = 0.1 $$\nThe problem asks for these two values as decimals in a single row matrix.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1  0.1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Effective control design requires an accurate mathematical model of the system in the domain where it is implemented. This practice guides you through the essential process of translating a continuous-time plant and controller into the discrete-time domain, accounting for the zero-order hold effect of the modulator and computational latency. Deriving the system's discrete-time characteristic equation provides the fundamental tool needed to rigorously analyze the stability and dynamic performance of the digital current controller. ",
            "id": "3836163",
            "problem": "A three-phase Voltage-Source Converter (VSC) regulates active and reactive power by controlling the direct-axis and quadrature-axis currents in the synchronous reference frame, denoted by $i_{d}$ and $i_{q}$. The inner current control loops are implemented in the synchronous $dq$ frame with perfect decoupling and feedforward compensation so that each axis dynamics can be treated independently. Focusing on the direct-axis loop, the plant seen by the controller is an $RL$ filter derived from Kirchhoff's Voltage Law. Under perfect decoupling and neglecting converter nonidealities, the continuous-time plant from command voltage $v_{d}$ to current $i_{d}$ is governed by $L \\frac{d i_{d}}{dt} + R i_{d} = v_{d}$.\n\nThe pulse-width modulation acts as a Zero-Order Hold (ZOH), and the digital controller experiences a one-sample computational delay. The loop employs a Proportional-Integral (PI) controller implemented digitally, where the integral action is realized using the backward rectangular rule (backward Euler) with sampling period $T_{s}$. The reference current $i_{d}^{\\star}$ is tracked with unity feedback. Use exact ZOH discretization for the plant and model the one-sample computational delay as $z^{-1}$ in the forward path. The integral action is discretized as $I[k] = I[k-1] + T_{s} e[k]$, where $e[k] = i_{d}^{\\star}[k] - i_{d}[k]$, and the controller output is $u[k] = K_{p} e[k] + K_{i} I[k]$.\n\nStarting from the continuous-time $RL$ dynamics and the stated discretization assumptions, derive the discrete-time closed-loop characteristic equation for the inner $d$-axis current loop. Express your final result as a single analytic expression for the characteristic polynomial $P(z)$ in terms of $z$, $K_{p}$, $K_{i}$, $R$, $L$, and $T_{s}$, without numerical evaluation. Define any intermediate discretization constants you introduce. The final answer must be a single closed-form analytic expression and must not include an equality sign.",
            "solution": "The user wants to find the closed-loop characteristic equation for a digital current control loop.\n\n### Step 1: Extract Givens\n-   Continuous-time plant dynamics for the d-axis current: $L \\frac{d i_{d}}{dt} + R i_{d} = v_{d}$, where $v_{d}$ is the command voltage and $i_{d}$ is the current.\n-   Proportional-Integral (PI) controller with gains $K_{p}$ and $K_{i}$.\n-   Controller output: $u[k] = K_{p} e[k] + K_{i} I[k]$.\n-   Error signal: $e[k] = i_{d}^{\\star}[k] - i_{d}[k]$.\n-   Integral state update (backward Euler): $I[k] = I[k-1] + T_{s} e[k]$, with sampling period $T_{s}$.\n-   Feedback: Unity feedback.\n-   Discretization:\n    -   Plant ($RL$ filter) is preceded by a Zero-Order Hold (ZOH). The combination is to be discretized using the exact ZOH method.\n    -   One-sample computational delay, modeled as $z^{-1}$, is present in the forward path.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard digital control system for a power converter, a common topic in power electronics and control engineering. The models provided (RL circuit, PI controller, ZOH, computational delay) are canonical. The specified discretization methods are standard. The provided information is complete and consistent, allowing for a unique derivation of the characteristic polynomial. The problem is free of any scientific flaws, ambiguities, or unrealistic assumptions that would invalidate it.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Derivation of the Characteristic Equation\n\nThe goal is to find the closed-loop characteristic polynomial $P(z)$. The closed-loop system is configured with unity feedback. The characteristic equation is given by $1 + G_{ol}(z) = 0$, where $G_{ol}(z)$ is the open-loop transfer function. The characteristic polynomial $P(z)$ is the numerator of $1 + G_{ol}(z)$.\n\nThe open-loop path consists of the digital PI controller $C(z)$, the one-sample computational delay $D(z)$, and the discretized plant with ZOH, $G_{p,zoh}(z)$.\n$$G_{ol}(z) = C(z) D(z) G_{p,zoh}(z)$$\n\nWe will derive the transfer function for each component.\n\n**1. Plant Discretization ($G_{p,zoh}(z)$)**\n\nThe continuous-time plant transfer function from voltage $v_d$ to current $i_d$ is obtained by taking the Laplace transform of the governing differential equation:\n$$L s I_d(s) + R I_d(s) = V_d(s)$$\n$$G_p(s) = \\frac{I_d(s)}{V_d(s)} = \\frac{1}{Ls + R}$$\nTo find the discrete-time transfer function $G_{p,zoh}(z)$ equivalent to a ZOH followed by $G_p(s)$, we use the formula:\n$$G_{p,zoh}(z) = (1 - z^{-1}) \\mathcal{Z}\\left\\{ \\mathcal{L}^{-1}\\left[ \\frac{G_p(s)}{s} \\right] \\right\\}$$\nFirst, we find the partial fraction expansion of $\\frac{G_p(s)}{s}$:\n$$\\frac{G_p(s)}{s} = \\frac{1}{s(Ls+R)} = \\frac{1/R}{s} - \\frac{L/R}{Ls+R} = \\frac{1}{R} \\left( \\frac{1}{s} - \\frac{1}{s + R/L} \\right)$$\nThe inverse Laplace transform gives the step response of the plant:\n$$g_{step}(t) = \\mathcal{L}^{-1}\\left\\{ \\frac{G_p(s)}{s} \\right\\} = \\frac{1}{R} \\left( 1 - \\exp\\left(-\\frac{R}{L}t\\right) \\right)$$\nSampling at intervals of $T_s$ (i.e., $t = kT_s$), we have:\n$$g_{step}[k] = \\frac{1}{R} \\left( 1 - \\exp\\left(-\\frac{R}{L}kT_s\\right) \\right) = \\frac{1}{R} \\left( 1 - \\left(\\exp\\left(-\\frac{R}{L}T_s\\right)\\right)^k \\right)$$\nTaking the Z-transform of the sampled step response:\n$$\\mathcal{Z}\\{g_{step}[k]\\} = \\frac{1}{R} \\left( \\frac{z}{z-1} - \\frac{z}{z - \\exp(-\\frac{R}{L}T_s)} \\right)$$\nFinally, we multiply by $(1-z^{-1}) = \\frac{z-1}{z}$:\n$$G_{p,zoh}(z) = \\frac{z-1}{z} \\frac{1}{R} \\left( \\frac{z}{z-1} - \\frac{z}{z - \\exp(-\\frac{R}{L}T_s)} \\right)$$\n$$G_{p,zoh}(z) = \\frac{1}{R} \\left( 1 - \\frac{z-1}{z - \\exp(-\\frac{R}{L}T_s)} \\right) = \\frac{1}{R} \\left( \\frac{z - \\exp(-\\frac{R}{L}T_s) - (z-1)}{z - \\exp(-\\frac{R}{L}T_s)} \\right)$$\n$$G_{p,zoh}(z) = \\frac{1 - \\exp(-\\frac{R}{L}T_s)}{R} \\frac{1}{z - \\exp(-\\frac{R}{L}T_s)}$$\nTo simplify, let us define two constants:\n$$a = \\exp\\left(-\\frac{R}{L}T_s\\right)$$\n$$b = \\frac{1 - a}{R} = \\frac{1 - \\exp(-\\frac{R}{L}T_s)}{R}$$\nSo, the discretized plant transfer function is:\n$$G_{p,zoh}(z) = \\frac{b}{z-a}$$\n\n**2. PI Controller Transfer Function ($C(z)$)**\n\nThe controller is defined by the discrete-time equations:\n$$u[k] = K_{p} e[k] + K_{i} I[k]$$\n$$I[k] = I[k-1] + T_{s} e[k]$$\nTaking the Z-transform of the second equation:\n$$I(z) = z^{-1}I(z) + T_s E(z) \\implies I(z) (1-z^{-1}) = T_s E(z) \\implies I(z) = \\frac{T_s}{1-z^{-1}}E(z) = \\frac{T_s z}{z-1}E(z)$$\nNow, taking the Z-transform of the first equation and substituting for $I(z)$:\n$$U(z) = K_p E(z) + K_i I(z) = K_p E(z) + K_i \\frac{T_s z}{z-1} E(z)$$\nThe controller transfer function $C(z) = U(z)/E(z)$ is:\n$$C(z) = K_p + K_i \\frac{T_s z}{z-1} = \\frac{K_p(z-1) + K_i T_s z}{z-1} = \\frac{(K_p + K_i T_s)z - K_p}{z-1}$$\n\n**3. Delay Transfer Function ($D(z)$)**\n\nThe one-sample computational delay is modeled as:\n$$D(z) = z^{-1}$$\n\n**4. Open-Loop and Characteristic Equation**\n\nNow, we assemble the open-loop transfer function $G_{ol}(z)$:\n$$G_{ol}(z) = C(z) D(z) G_{p,zoh}(z) = \\left( \\frac{(K_p + K_i T_s)z - K_p}{z-1} \\right) (z^{-1}) \\left( \\frac{b}{z-a} \\right)$$\n$$G_{ol}(z) = \\frac{b ((K_p + K_i T_s)z - K_p)}{z(z-1)(z-a)}$$\nThe characteristic equation is $1 + G_{ol}(z) = 0$:\n$$1 + \\frac{b ((K_p + K_i T_s)z - K_p)}{z(z-1)(z-a)} = 0$$\nTo find the characteristic polynomial $P(z)$, we clear the denominator:\n$$P(z) = z(z-1)(z-a) + b ((K_p + K_i T_s)z - K_p) = 0$$\nExpanding the polynomial:\n$$P(z) = z(z^2 - az - z + a) + b(K_p + K_i T_s)z - b K_p$$\n$$P(z) = z^3 - (a+1)z^2 + az + b(K_p + K_i T_s)z - b K_p$$\nGrouping terms by powers of $z$:\n$$P(z) = z^3 - (a+1)z^2 + (a + b(K_p + K_i T_s))z - b K_p$$\nFinally, substituting the definitions of $a$ and $b$ back into the expression yields the characteristic polynomial in terms of the original system parameters:\n$$P(z) = z^3 - \\left(\\exp\\left(-\\frac{R}{L}T_s\\right)+1\\right)z^2 + \\left(\\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{1-\\exp(-\\frac{R}{L}T_s)}{R}(K_p + K_i T_s)\\right)z - \\frac{1-\\exp(-\\frac{R}{L}T_s)}{R}K_p$$\nThis is the required analytic expression for the closed-loop characteristic polynomial.",
            "answer": "$$\n\\boxed{\nz^3 - \\left(\\exp\\left(-\\frac{R}{L}T_s\\right) + 1\\right)z^2 + \\left(\\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{1 - \\exp\\left(-\\frac{R}{L}T_s\\right)}{R} (K_p + K_i T_s)\\right)z - \\frac{1 - \\exp\\left(-\\frac{R}{L}T_s\\right)}{R} K_p\n}\n$$"
        },
        {
            "introduction": "In any digital control system, delays are inevitable due to sampling, computation, and modulation processes. This exercise moves from modeling to performance analysis by focusing on quantifying the impact of these delays on control loop stability. By analyzing the phase lag introduced by a pure time delay model, you will learn to determine the maximum achievable control bandwidth for a given stability margin, a critical parameter that dictates the controller's dynamic responsiveness. ",
            "id": "3836137",
            "problem": "A three-phase grid-connected voltage-source converter is regulated by a synchronous reference frame (direct-quadrature, dq) current controller implemented digitally with a proportional-integral (PI) structure and feedforward decoupling. The pulse-width modulation (PWM) is regular-sampled and symmetric about the carrier, and the controller output is latched and applied at the next PWM update. The sampling period is $T_s = 100\\,\\mu\\text{s}$. The combined effect of the zero-order hold (ZOH), one-sample computational latency, and half-carrier PWM update yields a net pure time delay of $T_d = T_s + \\frac{T_s}{2} = 1.5\\,T_s$ between the measured current and the applied voltage command in the plant.\n\nAssume that the dq-frame decoupling is exact and that the current-loop is tuned so that, at the intended crossover, the open-loop plant behaves effectively as an integrator (phase near $-90^\\circ$) and the controller contributes negligible phase lag at crossover. Under these hypotheses, the only additional phase lag limiting the phase margin is the pure time delay.\n\nUsing fundamental frequency-response properties of time delay, do the following:\n1. Compute the phase lag introduced by the delay at $f = 1\\,\\text{kHz}$.\n2. Enforce a target phase margin of $50^\\circ$ by ensuring that the delay-induced lag at crossover does not exceed the residual $40^\\circ$ phase budget beyond the integrator plant’s $90^\\circ$. Determine the reduction in achievable closed-loop bandwidth when the PWM half-carrier delay is included (i.e., $T_d = 1.5\\,T_s$) compared to when it is neglected (i.e., $T_d = T_s$). Report this reduction as a decimal ratio.\n\nRound all numerical results to four significant figures. Express the phase lag in degrees, and express the reduction factor as a decimal. The final answer must be a single calculation result; provide both requested values together as a $1 \\times 2$ row matrix.",
            "solution": "The converter’s dq-frame current control loop is implemented digitally, and the measurement-to-actuation pipeline can be well approximated by a pure time delay. A pure time delay of duration $T_d$ is represented in the Laplace domain by the factor\n$$\nG_d(s) = \\exp(-s T_d).\n$$\nIts frequency response at angular frequency $\\omega$ is\n$$\nG_d(\\mathrm{j}\\omega) = \\exp(-\\mathrm{j}\\omega T_d),\n$$\nwhich has magnitude $|G_d(\\mathrm{j}\\omega)| = 1$ and phase\n$$\n\\angle G_d(\\mathrm{j}\\omega) = -\\omega T_d \\quad \\text{(radians)}.\n$$\nConverting to degrees, the delay contributes\n$$\n\\phi_d(\\omega) = -\\omega T_d \\cdot \\frac{180}{\\pi} = -360 f T_d \\quad \\text{(degrees)},\n$$\nwhere $f = \\frac{\\omega}{2\\pi}$ is the frequency in hertz.\n\nPart 1: Phase lag at $f = 1\\,\\text{kHz}$.\n\nThe total delay is given as $T_d = 1.5\\,T_s$, with $T_s = 100\\,\\mu\\text{s}$. Therefore,\n$$\nT_d = 1.5 \\times 100\\times 10^{-6} = 150\\times 10^{-6} = 1.5\\times 10^{-4}.\n$$\nAt $f = 1\\,\\text{kHz}$,\n$$\n\\phi_d = -360 \\times (1000) \\times \\left(1.5\\times 10^{-4}\\right) = -54 \\quad \\text{degrees}.\n$$\nThe signed result is negative, indicating lag; the magnitude of the lag is $54^\\circ$. Rounded to four significant figures, this is $54.00^\\circ$.\n\nPart 2: Reduction in achievable bandwidth for a target phase margin of $50^\\circ$.\n\nBy hypothesis, at the intended crossover the open-loop plant behaves approximately as an integrator, contributing $-90^\\circ$ phase. The controller is tuned to contribute negligible phase lag at crossover. The phase margin (PM) at crossover is therefore\n$$\n\\text{PM} = 180^\\circ - \\left(90^\\circ + |\\phi_d|\\right) = 90^\\circ - |\\phi_d|.\n$$\nImposing the target $\\text{PM} = 50^\\circ$ yields\n$$\n50^\\circ \\leq 90^\\circ - |\\phi_d| \\quad \\Rightarrow \\quad |\\phi_d| \\leq 40^\\circ.\n$$\nUsing $|\\phi_d| = 360 f_c T_d$ in degrees, the maximum allowable crossover frequency $f_{c,\\max}$ must satisfy\n$$\n360 f_{c,\\max} T_d \\leq 40^\\circ \\quad \\Rightarrow \\quad f_{c,\\max} \\leq \\frac{40}{360 T_d} = \\frac{1}{9 T_d}.\n$$\nWe now compute $f_{c,\\max}$ for two cases:\n- Including the PWM half-carrier delay: $T_d = 1.5\\,T_s$,\n$$\nf_{c,\\max}^{(1.5T_s)} = \\frac{1}{9 \\cdot 1.5 T_s} = \\frac{1}{13.5\\,T_s}.\n$$\n- Neglecting the PWM half-carrier delay: $T_d = T_s$,\n$$\nf_{c,\\max}^{(T_s)} = \\frac{1}{9\\,T_s}.\n$$\nThe reduction factor in achievable bandwidth due to including the half-carrier delay, relative to neglecting it, is\n$$\n\\rho = \\frac{f_{c,\\max}^{(1.5T_s)}}{f_{c,\\max}^{(T_s)}} = \\frac{\\frac{1}{13.5\\,T_s}}{\\frac{1}{9\\,T_s}} = \\frac{9}{13.5} = \\frac{2}{3}.\n$$\nNumerically, with $T_s = 100\\times 10^{-6}$, one can verify the individual maxima:\n$$\nf_{c,\\max}^{(1.5T_s)} = \\frac{1}{13.5 \\cdot 100\\times 10^{-6}} \\approx 740.7407 \\ \\text{Hz}, \\quad\nf_{c,\\max}^{(T_s)} = \\frac{1}{9 \\cdot 100\\times 10^{-6}} \\approx 1111.1111 \\ \\text{Hz},\n$$\nand thus\n$$\n\\rho = \\frac{740.7407}{1111.1111} \\approx 0.6667 \\quad \\text{(four significant figures)}.\n$$\n\nTherefore, the requested outputs are:\n- The phase lag magnitude at $1\\,\\text{kHz}$: $54.00^\\circ$.\n- The bandwidth reduction factor (decimal ratio) when including the PWM half-carrier delay compared to neglecting it: $0.6667$.",
            "answer": "$$\\boxed{\\begin{pmatrix}54.00  0.6667\\end{pmatrix}}$$"
        }
    ]
}