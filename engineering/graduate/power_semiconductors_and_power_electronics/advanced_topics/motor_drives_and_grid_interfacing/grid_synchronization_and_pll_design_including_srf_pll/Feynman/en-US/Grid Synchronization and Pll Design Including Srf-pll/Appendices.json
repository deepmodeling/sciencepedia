{
    "hands_on_practices": [
        {
            "introduction": "At the heart of any SRF-PLL is the loop filter, typically a PI controller, which dictates the system's stability and dynamic response. This first exercise provides hands-on practice in the fundamental design process: calculating the proportional ($K_p$) and integral ($K_i$) gains based on desired performance specifications like loop bandwidth and phase margin. Mastering this calculation  is the crucial first step in building a robust and effective grid synchronization system.",
            "id": "3843644",
            "problem": "A three-phase grid-tied voltage-source converter requires angular phase synchronization using a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL). The SRF-PLL uses a proportional-integral (PI) loop filter, whose output is the estimated grid angular frequency, and a Numerical Controlled Oscillator (NCO) that integrates this frequency to produce the estimated phase. In the synchronous reference frame, under small phase error, the quadrature-axis voltage is linearly proportional to the phase error. Assume the phase detector gain is equal to the magnitude of the positive-sequence grid voltage, so that $K_{\\text{PD}} = V$, and the NCO gain is $K_{\\text{NCO}} = 1$.\n\nDesign the PI gains for an SRF-PLL intended for a $50\\,\\text{Hz}$ grid with a fundamental positive-sequence peak magnitude $V = 325\\,\\text{V}$. The desired loop bandwidth is $f_b = 30\\,\\text{Hz}$, defined as the unity-gain crossover frequency of the open-loop transfer function $L(j\\omega)$, and the desired phase margin is $\\text{PM} = 50^\\circ$.\n\nStarting from first principles of small-signal linearization and standard feedback loop definitions, compute the proportional gain $K_p$ (express in $\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$) and integral gain $K_i$ (express in $\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$) that meet these specifications. Treat $\\text{PM}$ in degrees but perform all trigonometric operations using radians. Round your final numeric values to four significant figures. The loop bandwidth must be implemented at angular frequency $\\omega_{gc} = 2\\pi f_b$.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, objective, and complete.\n\n### Step 1: Extract Givens\n- System: Three-phase grid-tied voltage-source converter with SRF-PLL.\n- Loop filter: Proportional-Integral (PI) controller.\n- Phase detector gain: $K_{\\text{PD}} = V$.\n- NCO gain: $K_{\\text{NCO}} = 1$.\n- Nominal grid frequency: $f_g = 50\\,\\text{Hz}$.\n- Positive-sequence peak voltage: $V = 325\\,\\text{V}$.\n- Desired loop bandwidth: $f_b = 30\\,\\text{Hz}$.\n- Bandwidth definition: Unity-gain crossover frequency of the open-loop transfer function.\n- Crossover angular frequency: $\\omega_{gc} = 2\\pi f_b$.\n- Desired phase margin: $\\text{PM} = 50^\\circ$.\n- Required outputs: Proportional gain $K_p$ and integral gain $K_i$.\n- Required units: $K_p$ in $\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$, $K_i$ in $\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\n- Rounding: Final numeric values to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard control system design task for a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL), a fundamental technique in power electronics for grid synchronization. The small-signal model and linearization are standard engineering practices. The problem is scientifically sound.\n- **Well-Posed**: The problem provides two design specifications (bandwidth and phase margin) and asks for two unknown parameters ($K_p$ and $K_i$). This forms a solvable system of equations, making the problem well-posed.\n- **Objective**: The problem is stated using precise, technical language with no subjective or ambiguous terms.\n- **Completeness and Consistency**: All necessary data for the design are provided, and there are no contradictions within the given information. The voltage value $V = 325\\,\\text{V}$ is a realistic peak voltage for a $230\\,\\text{V}_{\\text{rms}}$ system ($230\\sqrt{2} \\approx 325.27$). The design targets are reasonable.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and self-contained. The solution process may proceed.\n\n### Solution Derivation\n\nThe small-signal model of the SRF-PLL is a feedback control system. Let $\\theta_e(s)$ be the Laplace transform of the phase error between the grid voltage phase $\\theta_g(s)$ and the PLL's estimated phase $\\hat{\\theta}(s)$, so that $\\theta_e(s) = \\theta_g(s) - \\hat{\\theta}(s)$.\n\nThe open-loop transfer function (OLTF) of the PLL, denoted $L(s)$, is the product of the transfer functions of the components in the forward path: the phase detector (PD), the PI controller, and the numerically controlled oscillator (NCO).\n$L(s) = \\frac{\\hat{\\theta}(s)}{\\theta_e(s)}$.\n\n1.  **Phase Detector (PD)**: Under the small-signal assumption, the quadrature-axis voltage $v_q$ is proportional to the phase error $\\theta_e$. The gain is given as $K_{\\text{PD}} = V$.\n    $G_{\\text{PD}}(s) = K_{\\text{PD}} = V$.\n\n2.  **PI Controller**: The PI controller is the loop filter, with proportional gain $K_p$ and integral gain $K_i$. Its transfer function is:\n    $C(s) = K_p + \\frac{K_i}{s} = \\frac{K_p s + K_i}{s}$.\n\n3.  **Numerically Controlled Oscillator (NCO)**: The NCO acts as an integrator that converts the estimated angular frequency $\\hat{\\omega}$ to the estimated phase $\\hat{\\theta}$. Its gain is given as $K_{\\text{NCO}} = 1$.\n    $G_{\\text{NCO}}(s) = \\frac{K_{\\text{NCO}}}{s} = \\frac{1}{s}$.\n\nCombining these components, the open-loop transfer function $L(s)$ is:\n$L(s) = G_{\\text{PD}}(s) \\cdot C(s) \\cdot G_{\\text{NCO}}(s) = V \\left(\\frac{K_p s + K_i}{s}\\right) \\frac{1}{s} = \\frac{V(K_p s + K_i)}{s^2}$.\n\nThe design specifications are given at the gain crossover angular frequency, $\\omega_{gc}$, where the magnitude of the OLTF is unity.\n$\\omega_{gc} = 2\\pi f_b = 2\\pi(30\\,\\text{Hz}) = 60\\pi\\,\\text{rad}\\,\\text{s}^{-1}$.\n\nThe two design criteria are:\n1.  **Unity-Gain Condition**: The magnitude of the OLTF at $\\omega_{gc}$ must be $1$.\n    $|L(j\\omega_{gc})| = 1$.\n    $L(j\\omega) = \\frac{V(j\\omega K_p + K_i)}{(j\\omega)^2} = \\frac{V(K_i + j\\omega K_p)}{-\\omega^2}$.\n    $|L(j\\omega_{gc})| = \\left| \\frac{V(K_i + j\\omega_{gc} K_p)}{-\\omega_{gc}^2} \\right| = \\frac{V \\sqrt{K_i^2 + (\\omega_{gc} K_p)^2}}{\\omega_{gc}^2}$.\n    Setting this to $1$ gives our first equation:\n    $\\frac{V \\sqrt{K_i^2 + (\\omega_{gc} K_p)^2}}{\\omega_{gc}^2} = 1 \\implies V \\sqrt K_i^2 + (\\omega_{gc} K_p)^2 = \\omega_{gc}^2$.\n\n2.  **Phase Margin Condition**: The phase margin (PM) is defined as $\\text{PM} = 180^\\circ + \\angle L(j\\omega_{gc})$, or in radians, $\\text{PM} = \\pi + \\angle L(j\\omega_{gc})$.\n    The phase of $L(j\\omega)$ is:\n    $\\angle L(j\\omega) = \\angle(V(K_i + j\\omega K_p)) - \\angle(-\\omega^2) = \\arctan\\left(\\frac{\\omega K_p}{K_i}\\right) - \\pi$.\n    At $\\omega_{gc}$, the phase margin is:\n    $\\text{PM} = \\pi + \\left(\\arctan\\left(\\frac{\\omega_{gc} K_p}{K_i}\\right) - \\pi\\right) = \\arctan\\left(\\frac{\\omega_{gc} K_p}{K_i}\\right)$.\n    Using the given phase margin $\\text{PM} = 50^\\circ$, we get our second equation:\n    $\\tan(\\text{PM}) = \\tan(50^\\circ) = \\frac{\\omega_{gc} K_p}{K_i}$.\n\nNow we solve the system of two equations for $K_p$ and $K_i$.\nFrom the phase margin equation, we express $K_p$ in terms of $K_i$:\n$K_p = \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}$.\n\nSubstitute this expression for $K_p$ into the unity-gain magnitude equation:\n$\\omega_{gc}^2 = V \\sqrt{K_i^2 + \\left(\\omega_{gc} \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}\\right)^2} = V \\sqrt{K_i^2 + K_i^2 \\tan^2(50^\\circ)}$.\n$\\omega_{gc}^2 = V K_i \\sqrt{1 + \\tan^2(50^\\circ)}$.\nUsing the trigonometric identity $1 + \\tan^2(\\theta) = \\sec^2(\\theta)$:\n$\\omega_{gc}^2 = V K_i \\sqrt{\\sec^2(50^\\circ)} = V K_i |\\sec(50^\\circ)|$.\nSince $50^\\circ$ is in the first quadrant, $\\sec(50^\\circ)$ is positive.\n$\\omega_{gc}^2 = V K_i \\sec(50^\\circ) = V K_i \\frac{1}{\\cos(50^\\circ)}$.\n\nSolving for $K_i$:\n$K_i = \\frac{\\omega_{gc}^2 \\cos(50^\\circ)}{V}$.\n\nNow we solve for $K_p$ by substituting the expression for $K_i$ back into the phase margin relation:\n$\\frac{\\omega_{gc} K_p}{K_i} = \\tan(50^\\circ) \\implies K_p = \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}$.\n$K_p = \\frac{1}{\\omega_{gc}} \\left( \\frac{\\omega_{gc}^2 \\cos(50^\\circ)}{V} \\right) \\tan(50^\\circ) = \\frac{\\omega_{gc}}{V} \\cos(50^\\circ) \\frac{\\sin(50^\\circ)}{\\cos(50^\\circ)}$.\n$K_p = \\frac{\\omega_{gc} \\sin(50^\\circ)}{V}$.\n\nNow, we substitute the numerical values:\n$V = 325\\,\\text{V}$.\n$\\omega_{gc} = 60\\pi\\,\\text{rad}\\,\\text{s}^{-1}$.\n$\\text{PM} = 50^\\circ$.\n\n$K_p = \\frac{(60\\pi)\\,\\sin(50^\\circ)}{325} \\approx \\frac{188.4956 \\times 0.766044}{325} \\approx \\frac{144.4021}{325} \\approx 0.444314\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$.\nRounding to four significant figures, $K_p = 0.4443\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$.\n\n$K_i = \\frac{(60\\pi)^2\\,\\cos(50^\\circ)}{325} \\approx \\frac{35530.5758 \\times 0.642788}{325} \\approx \\frac{22836.315}{325} \\approx 70.2656\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\nRounding to four significant figures, $K_i = 70.27\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\n\nThe calculated gains are $K_p=0.4443\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$ and $K_i=70.27\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4443 & 70.27\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While PLLs are often designed in the continuous-time domain, they are almost always implemented on digital processors. This practice  delves into the critical process of discretization, specifically using the bilinear transform to convert an analog PI controller into a digital filter. You will explore how frequency prewarping ensures that the digital filter's performance accurately matches the original analog design at a key frequency, a vital technique for preserving control stability.",
            "id": "3843610",
            "problem": "A Synchronous Reference Frame Phase-Locked Loop (SRF-PLL) used for three-phase grid synchronization employs a proportionalâ€“integral (PI) loop filter acting on the synchronous reference frame quadrature-axis error. Let the continuous-time loop filter have transfer function $G_{\\text{PI}}(s) = K_{p} + \\frac{K_{i}}{s}$, where $K_{p}$ and $K_{i}$ are positive real gains. The loop filter is to be implemented digitally with sampling period $T_{s}$ seconds, and the desired continuous-time closed-loop bandwidth is $\\omega_{b}$ radians per second.\n\nStarting from the fundamental definitions of the integrator as the time integral of the input and using the trapezoidal numerical integration rule to approximate the integral over each sampling interval, derive the bilinear (Tustin) discretization of the PI loop filter. Then, starting from the exact mapping relationship between continuous-time sinusoidal frequency and discrete-time sinusoidal frequency induced by the bilinear transform, show how frequency prewarping is applied so that the discrete-time PI loop filter exactly matches the continuous-time PI loop filter at the target bandwidth $\\omega_{b}$.\n\nExpress the final discretized loop filter in the $z$-domain in the form\n$$\nG_{\\text{PI}}(z) = \\frac{b_{0} + b_{1} z^{-1}}{1 - z^{-1}},\n$$\nand report $b_{0}$ and $b_{1}$ as closed-form symbolic expressions in terms of $K_{p}$, $K_{i}$, $\\omega_{b}$, and $T_{s}$. No numerical evaluation is required. If you choose to define any intermediate constant, eliminate it in the final expressions so that $b_{0}$ and $b_{1}$ depend only on $K_{p}$, $K_{i}$, $\\omega_{b}$, and $T_{s}$. The final answer must be provided without units and does not require rounding.",
            "solution": "The objective is to derive the discrete-time representation of a continuous-time proportional-integral (PI) controller, $G_{\\text{PI}}(s) = K_{p} + \\frac{K_{i}}{s}$, using the bilinear (Tustin) transform with frequency prewarping. The final result should be expressed in the form $G_{\\text{PI}}(z) = \\frac{b_{0} + b_{1} z^{-1}}{1 - z^{-1}}$, with coefficients $b_{0}$ and $b_{1}$ given in terms of $K_{p}$, $K_{i}$, the sampling period $T_{s}$, and the prewarping frequency $\\omega_{b}$.\n\nFirst, we derive the bilinear transformation rule from its underlying principle, the trapezoidal rule for numerical integration. The integral part of the PI controller corresponds to an integrator with transfer function $G_{I}(s) = \\frac{1}{s}$. In the time domain, if $u(t)$ is the input and $y(t)$ is the output of the integrator, their relationship is $y(t) = \\int_0^t u(\\tau) d\\tau$.\n\nThis integral relationship can be expressed recursively over a sampling interval. Let $t_{k-1} = (k-1)T_{s}$ and $t_k = k T_{s}$ be two consecutive sampling instants. The output at time $t_k$ is:\n$$\ny(t_k) = y(t_{k-1}) + \\int_{t_{k-1}}^{t_k} u(\\tau) d\\tau\n$$\nThe integral over the interval $[t_{k-1}, t_k]$ is approximated using the trapezoidal rule:\n$$\n\\int_{t_{k-1}}^{t_k} u(\\tau) d\\tau \\approx \\frac{t_k - t_{k-1}}{2} [u(t_k) + u(t_{k-1})] = \\frac{T_{s}}{2} [u(k T_{s}) + u((k-1)T_{s})]\n$$\nLet $y[k] = y(k T_{s})$ and $u[k] = u(k T_{s})$ denote the sampled signals. The difference equation for the integrator is:\n$$\ny[k] = y[k-1] + \\frac{T_{s}}{2} (u[k] + u[k-1])\n$$\nTaking the Z-transform of this equation, we get:\n$$\nY(z) = z^{-1}Y(z) + \\frac{T_{s}}{2} (U(z) + z^{-1}U(z))\n$$\nWe can now solve for the discrete-time transfer function of the integrator, $G_{I}(z) = \\frac{Y(z)}{U(z)}$:\n$$\n(1 - z^{-1})Y(z) = \\frac{T_{s}}{2}(1 + z^{-1})U(z)\n$$\n$$\nG_{I}(z) = \\frac{T_{s}}{2} \\frac{1 + z^{-1}}{1 - z^{-1}}\n$$\nBy equating the continuous-time integrator $G_{I}(s) = \\frac{1}{s}$ with its discrete-time approximation $G_{I}(z)$, we find the standard bilinear transformation for the operator $s$:\n$$\ns \\approx \\frac{2}{T_{s}} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\nThis transformation introduces a nonlinear mapping, or \"warping,\" between the continuous-time frequency $\\omega$ and the discrete-time frequency $\\Omega$. This can be seen by substituting $s = j\\omega$ and $z = \\exp(j\\Omega T_{s})$:\n$$\nj\\omega = \\frac{2}{T_{s}} \\frac{1 - \\exp(-j\\Omega T_{s})}{1 + \\exp(-j\\Omega T_{s})} = \\frac{2}{T_{s}} \\frac{\\exp(j\\Omega T_{s}/2) - \\exp(-j\\Omega T_{s}/2)}{\\exp(j\\Omega T_{s}/2) + \\exp(-j\\Omega T_{s}/2)} = \\frac{2}{T_{s}} \\frac{2j\\sin(\\Omega T_{s}/2)}{2\\cos(\\Omega T_{s}/2)}\n$$\n$$\n\\omega = \\frac{2}{T_{s}} \\tan\\left(\\frac{\\Omega T_{s}}{2}\\right)\n$$\nTo ensure that the frequency response of the digital filter matches the analog filter's response at a specific critical frequency $\\omega_{b}$, we employ frequency prewarping. This involves modifying the substitution for $s$. We seek a substitution of the form $s \\rightarrow K \\frac{1-z^{-1}}{1+z^{-1}}$ where the constant $K$ is chosen to make the frequency mapping exact at $\\omega_{b}$. We enforce this by setting $s = j\\omega_{b}$ and $z = \\exp(j\\omega_{b} T_{s})$:\n$$\nj\\omega_{b} = K \\frac{1 - \\exp(-j\\omega_{b} T_{s})}{1 + \\exp(-j\\omega_{b} T_{s})} = K \\left( j \\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right) \\right)\n$$\nSolving for $K$ gives the prewarping constant:\n$$\nK = \\frac{\\omega_{b}}{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}\n$$\nThe prewarped bilinear transformation is therefore:\n$$\ns \\rightarrow \\frac{\\omega_{b}}{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\nNow, we apply this transformation to the continuous-time PI controller $G_{\\text{PI}}(s) = K_{p} + \\frac{K_{i}}{s}$:\n$$\nG_{\\text{PI}}(z) = K_{p} + K_{i} \\left( \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} \\frac{1 + z^{-1}}{1 - z^{-1}} \\right)\n$$\nTo obtain the desired transfer function form, we combine the terms over a common denominator $(1 - z^{-1})$:\n$$\nG_{\\text{PI}}(z) = \\frac{K_{p}(1 - z^{-1}) + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}}(1 + z^{-1})}{1 - z^{-1}}\n$$\nExpanding the numerator:\n$$\n\\text{Numerator} = K_{p} - K_{p} z^{-1} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} z^{-1}\n$$\nGrouping the terms by powers of $z^{-1}$:\n$$\n\\text{Numerator} = \\left( K_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} \\right) + \\left(-K_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} \\right) z^{-1}\n$$\nBy comparing this to the target form $G_{\\text{PI}}(z) = \\frac{b_{0} + b_{1} z^{-1}}{1 - z^{-1}}$, we can directly identify the coefficients $b_{0}$ and $b_{1}$:\n$$\nb_{0} = K_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}}\n$$\n$$\nb_{1} = -K_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}}\n$$\nThese expressions provide the coefficients for the prewarped digital PI filter as functions of the continuous-time gains and system parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nK_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}} & -K_{p} + K_{i} \\frac{\\tan\\left(\\frac{\\omega_{b} T_{s}}{2}\\right)}{\\omega_{b}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A PLL's true test is its ability to remain locked and quickly re-synchronize during grid disturbances. This exercise  simulates this challenge by analyzing the PLL's transient response to a sudden step in grid frequency. By working through this problem, you will learn how to determine the minimum required PLL bandwidth to satisfy strict performance criteria for settling time and peak phase error, ensuring your design is robust enough for real-world conditions.",
            "id": "3843653",
            "problem": "A three-phase grid-tied converter employs a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL) for grid synchronization. Assume a balanced grid, negligible harmonics, and that the SRF-PLL operates in the small-signal regime so that the phase detector can be linearized about the locked condition. The SRF-PLL uses a proportional-integral loop filter driving the voltage-controlled oscillator, so that the closed-loop small-signal phase error dynamics are those of a second-order, type-II system characterized by natural frequency $\\omega_{n}$ and damping ratio $\\zeta$. The designer defines the Phase-Locked Loop (PLL) closed-loop bandwidth as $f_{b} \\equiv \\omega_{n}/(2\\pi)$.\n\nWhen the grid frequency undergoes a step of magnitude $|\\Delta f| = 2~\\mathrm{Hz}$, the instantaneous phase error $\\varphi(t)$ should satisfy the following performance requirements:\n- The peak phase excursion at any time must satisfy $|\\varphi(t)| \\leq 10^{\\circ}$.\n- The loop must be considered to have tracked the new frequency within $t_{s} = 50~\\mathrm{ms}$ according to the $2\\%$ settling-time criterion for a second-order system, applied to the decaying homogeneous response envelope of the phase error.\n\nStarting from the linear time-invariant model of the SRF-PLL error dynamics and standard second-order system definitions, determine the minimum closed-loop bandwidth $f_{b}$ that satisfies both requirements. You may choose $\\zeta$ to minimize the required bandwidth, but you must justify your choice from the dynamics. Angles must be handled in radians in all intermediate derivations; the grid frequency step is $\\Delta \\omega = 2\\pi \\Delta f$. Express the final bandwidth in $\\mathrm{Hz}$ and round your answer to three significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It represents a standard control system design problem in the context of power electronics. All provided data and constraints are consistent and realistic.\n\nThe system under consideration is a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL). For small-signal analysis around a locked state, the closed-loop dynamics of the phase error, $\\varphi(t) = \\theta_g(t) - \\hat{\\theta}(t)$, where $\\theta_g$ is the grid phase and $\\hat{\\theta}$ is the PLL's estimated phase, can be modeled by a second-order, type-II system. The error transfer function is given by:\n$$\n\\frac{\\Phi(s)}{\\Theta_g(s)} = \\frac{s^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\nwhere $\\Phi(s)$ and $\\Theta_g(s)$ are the Laplace transforms of the phase error and grid phase, respectively. $\\omega_n$ is the natural frequency and $\\zeta$ is the damping ratio.\n\nThe input disturbance is a step in grid frequency of magnitude $|\\Delta f| = 2~\\mathrm{Hz}$. The change in angular frequency is $\\Delta \\omega = 2\\pi |\\Delta f| = 2\\pi(2) = 4\\pi~\\mathrm{rad/s}$. A step in frequency corresponds to a ramp in phase. The component of the grid phase causing the error is $\\theta_g(t) = (\\Delta \\omega) t$ for $t \\ge 0$. The Laplace transform of this input is $\\Theta_g(s) = \\frac{\\Delta \\omega}{s^2}$.\n\nThe phase error in the Laplace domain is therefore:\n$$\n\\Phi(s) = \\frac{s^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2} \\cdot \\frac{\\Delta \\omega}{s^2} = \\frac{\\Delta \\omega}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\nThis is the response of a standard second-order system to an impulse of magnitude $\\Delta \\omega$. For an underdamped system ($0 < \\zeta < 1$), the time-domain phase error is:\n$$\n\\varphi(t) = \\frac{\\Delta \\omega}{\\omega_d} e^{-\\zeta \\omega_n t} \\sin(\\omega_d t)\n$$\nwhere $\\omega_d = \\omega_n\\sqrt{1-\\zeta^2}$ is the damped natural frequency. The steady-state error is zero, as expected for a type-II system responding to a ramp input.\n\nWe must satisfy two performance requirements, which we formulate as constraints on $\\omega_n$ and $\\zeta$.\n\n**Constraint 1: Peak Phase Excursion**\nThe peak phase error, $|\\varphi(t)|$, must not exceed $\\varphi_{max} = 10^{\\circ} = 10 \\frac{\\pi}{180} = \\frac{\\pi}{18}$ radians. The first peak of $\\varphi(t)$ occurs at time $t_p = \\frac{\\arccos(\\zeta)}{\\omega_d}$. Substituting this time back into the expression for $\\varphi(t)$ yields the peak value:\n$$\n\\varphi_{peak} = \\frac{\\Delta \\omega}{\\omega_n} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right)\n$$\nThe constraint $\\varphi_{peak} \\leq \\varphi_{max}$ leads to a lower bound on $\\omega_n$:\n$$\n\\omega_n \\geq \\frac{\\Delta \\omega}{\\varphi_{max}} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right)\n$$\n\n**Constraint 2: Settling Time**\nThe settling time $t_s$ must be less than or equal to $t_{s,max} = 50~\\mathrm{ms} = 0.05~\\mathrm{s}$. The problem defines this using the $2\\%$ criterion applied to the decaying homogeneous response envelope. The envelope of $\\varphi(t)$ is controlled by the term $e^{-\\zeta\\omega_n t}$. The time for this envelope to decay to $2\\%$ of its initial value is found by solving $e^{-\\zeta\\omega_n t_s} = 0.02$.\n$$\n-\\zeta\\omega_n t_s = \\ln(0.02) = -\\ln(50) \\implies t_s = \\frac{\\ln(50)}{\\zeta \\omega_n}\n$$\nThe constraint $t_s \\leq t_{s,max}$ leads to a second lower bound on $\\omega_n$:\n$$\n\\omega_n \\geq \\frac{\\ln(50)}{\\zeta t_{s,max}}\n$$\n\n**Optimization**\nTo find the minimum required bandwidth $f_b = \\omega_n / (2\\pi)$, we must find the minimum $\\omega_n$ that satisfies both constraints for some choice of $\\zeta$. The required $\\omega_n$ is:\n$$\n\\omega_{n,req} = \\max\\left( \\frac{\\Delta \\omega}{\\varphi_{max}} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right), \\frac{\\ln(50)}{\\zeta t_{s,max}} \\right)\n$$\nWe want to find $\\min_{0 < \\zeta \\leq 1} \\{ \\omega_{n,req} \\}$. The settling time bound is proportional to $1/\\zeta$ and clearly decreases as $\\zeta$ increases. The peak excursion bound is also a monotonically decreasing function of $\\zeta$ for $\\zeta \\in (0,1]$. Since both lower bounds on $\\omega_n$ decrease as $\\zeta$ increases, the minimum required $\\omega_n$ will be achieved at the largest permissible value of $\\zeta$. The optimal choice that minimizes both bounds is the critically damped case, $\\zeta = 1$. This provides the fastest non-oscillatory response, which is beneficial for both settling time and peak excursion.\n\nFor the critically damped case ($\\zeta=1$), the phase error response becomes:\n$$\n\\varphi(t) = \\mathcal{L}^{-1}\\left\\{\\frac{\\Delta \\omega}{(s+\\omega_n)^2}\\right\\} = \\Delta \\omega \\cdot t \\cdot e^{-\\omega_n t}\n$$\nThe constraints are re-evaluated for $\\zeta=1$:\n1.  **Peak Excursion**: The peak of $\\varphi(t)$ occurs at $t_p = 1/\\omega_n$. The peak value is $\\varphi_{peak} = \\Delta \\omega (1/\\omega_n) e^{-1} = \\frac{\\Delta\\omega}{e\\omega_n}$.\n    The constraint is $\\frac{\\Delta\\omega}{e\\omega_n} \\leq \\varphi_{max}$, which gives $\\omega_n \\geq \\frac{\\Delta\\omega}{e\\varphi_{max}}$.\n2.  **Settling Time**: Using the same definition derived from the exponential envelope, we take the limit as $\\zeta \\to 1$, which gives $t_s = \\frac{\\ln(50)}{\\omega_n}$.\n    The constraint is $\\frac{\\ln(50)}{\\omega_n} \\leq t_{s,max}$, which gives $\\omega_n \\geq \\frac{\\ln(50)}{t_{s,max}}$.\n\nNow, we substitute the given numerical values:\n$\\Delta \\omega = 4\\pi~\\mathrm{rad/s}$\n$\\varphi_{max} = \\pi/18~\\mathrm{rad}$\n$t_{s,max} = 0.05~\\mathrm{s}$\n\nCalculating the two lower bounds on $\\omega_n$:\nFrom the peak excursion constraint:\n$$\n\\omega_{n,1} = \\frac{4\\pi}{e(\\pi/18)} = \\frac{72}{e} \\approx 26.487~\\mathrm{rad/s}\n$$\nFrom the settling time constraint:\n$$\n\\omega_{n,2} = \\frac{\\ln(50)}{0.05} \\approx \\frac{3.91202}{0.05} \\approx 78.240~\\mathrm{rad/s}\n$$\nThe required natural frequency must be greater than or equal to the maximum of these two values:\n$$\n\\omega_{n,min} = \\max(\\omega_{n,1}, \\omega_{n,2}) = \\max(26.487, 78.240) = 78.240~\\mathrm{rad/s}\n$$\nThe settling time requirement is the limiting factor. The minimum closed-loop bandwidth $f_b$ is defined as $\\omega_n/(2\\pi)$.\n$$\nf_{b,min} = \\frac{\\omega_{n,min}}{2\\pi} = \\frac{78.240}{2\\pi} \\approx 12.454~\\mathrm{Hz}\n$$\nRounding the final answer to three significant figures gives $12.5~\\mathrm{Hz}$.",
            "answer": "$$\n\\boxed{12.5}\n$$"
        }
    ]
}