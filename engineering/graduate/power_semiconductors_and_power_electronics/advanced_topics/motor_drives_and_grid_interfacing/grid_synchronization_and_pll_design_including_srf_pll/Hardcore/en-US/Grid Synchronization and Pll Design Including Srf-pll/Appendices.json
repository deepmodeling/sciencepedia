{
    "hands_on_practices": [
        {
            "introduction": "The heart of a Phase-Locked Loop (PLL) is its loop filter, which dictates the system's stability and dynamic response. This first practice focuses on the fundamental design task of calculating the PI controller gains. By starting from key performance specifications—bandwidth and phase margin—you will derive the proportional ($K_p$) and integral ($K_i$) gains, translating high-level system requirements into concrete controller parameters .",
            "id": "3843644",
            "problem": "A three-phase grid-tied voltage-source converter requires angular phase synchronization using a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL). The SRF-PLL uses a proportional-integral (PI) loop filter, whose output is the estimated grid angular frequency, and a Numerical Controlled Oscillator (NCO) that integrates this frequency to produce the estimated phase. In the synchronous reference frame, under small phase error, the quadrature-axis voltage is linearly proportional to the phase error. Assume the phase detector gain is equal to the magnitude of the positive-sequence grid voltage, so that $K_{\\text{PD}} = V$, and the NCO gain is $K_{\\text{NCO}} = 1$.\n\nDesign the PI gains for an SRF-PLL intended for a $50\\,\\text{Hz}$ grid with a fundamental positive-sequence peak magnitude $V = 325\\,\\text{V}$. The desired loop bandwidth is $f_b = 30\\,\\text{Hz}$, defined as the unity-gain crossover frequency of the open-loop transfer function $L(j\\omega)$, and the desired phase margin is $\\text{PM} = 50^\\circ$.\n\nStarting from first principles of small-signal linearization and standard feedback loop definitions, compute the proportional gain $K_p$ (express in $\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$) and integral gain $K_i$ (express in $\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$) that meet these specifications. Treat $\\text{PM}$ in degrees but perform all trigonometric operations using radians. Round your final numeric values to four significant figures. The loop bandwidth must be implemented at angular frequency $\\omega_{gc} = 2\\pi f_b$.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, objective, and complete.\n\n### Step 1: Extract Givens\n- System: Three-phase grid-tied voltage-source converter with SRF-PLL.\n- Loop filter: Proportional-Integral (PI) controller.\n- Phase detector gain: $K_{\\text{PD}} = V$.\n- NCO gain: $K_{\\text{NCO}} = 1$.\n- Nominal grid frequency: $f_g = 50\\,\\text{Hz}$.\n- Positive-sequence peak voltage: $V = 325\\,\\text{V}$.\n- Desired loop bandwidth: $f_b = 30\\,\\text{Hz}$.\n- Bandwidth definition: Unity-gain crossover frequency of the open-loop transfer function.\n- Crossover angular frequency: $\\omega_{gc} = 2\\pi f_b$.\n- Desired phase margin: $\\text{PM} = 50^\\circ$.\n- Required outputs: Proportional gain $K_p$ and integral gain $K_i$.\n- Required units: $K_p$ in $\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$, $K_i$ in $\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\n- Rounding: Final numeric values to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard control system design task for a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL), a fundamental technique in power electronics for grid synchronization. The small-signal model and linearization are standard engineering practices. The problem is scientifically sound.\n- **Well-Posed**: The problem provides two design specifications (bandwidth and phase margin) and asks for two unknown parameters ($K_p$ and $K_i$). This forms a solvable system of equations, making the problem well-posed.\n- **Objective**: The problem is stated using precise, technical language with no subjective or ambiguous terms.\n- **Completeness and Consistency**: All necessary data for the design are provided, and there are no contradictions within the given information. The voltage value $V = 325\\,\\text{V}$ is a realistic peak voltage for a $230\\,\\text{V}_{\\text{rms}}$ system ($230\\sqrt{2} \\approx 325.27$). The design targets are reasonable.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and self-contained. The solution process may proceed.\n\n### Solution Derivation\n\nThe small-signal model of the SRF-PLL is a feedback control system. Let $\\theta_e(s)$ be the Laplace transform of the phase error between the grid voltage phase $\\theta_g(s)$ and the PLL's estimated phase $\\hat{\\theta}(s)$, so that $\\theta_e(s) = \\theta_g(s) - \\hat{\\theta}(s)$.\n\nThe open-loop transfer function (OLTF) of the PLL, denoted $L(s)$, is the product of the transfer functions of the components in the forward path: the phase detector (PD), the PI controller, and the numerically controlled oscillator (NCO).\n$L(s) = \\frac{\\hat{\\theta}(s)}{\\theta_e(s)}$.\n\n1.  **Phase Detector (PD)**: Under the small-signal assumption, the quadrature-axis voltage $v_q$ is proportional to the phase error $\\theta_e$. The gain is given as $K_{\\text{PD}} = V$.\n    $G_{\\text{PD}}(s) = K_{\\text{PD}} = V$.\n\n2.  **PI Controller**: The PI controller is the loop filter, with proportional gain $K_p$ and integral gain $K_i$. Its transfer function is:\n    $$C(s) = K_p + \\frac{K_i}{s} = \\frac{K_p s + K_i}{s}$$\n\n3.  **Numerically Controlled Oscillator (NCO)**: The NCO acts as an integrator that converts the estimated angular frequency $\\hat{\\omega}$ to the estimated phase $\\hat{\\theta}$. Its gain is given as $K_{\\text{NCO}} = 1$.\n    $G_{\\text{NCO}}(s) = \\frac{K_{\\text{NCO}}}{s} = \\frac{1}{s}$.\n\nCombining these components, the open-loop transfer function $L(s)$ is:\n$L(s) = G_{\\text{PD}}(s) \\cdot C(s) \\cdot G_{\\text{NCO}}(s) = V \\left(\\frac{K_p s + K_i}{s}\\right) \\frac{1}{s} = \\frac{V(K_p s + K_i)}{s^2}$.\n\nThe design specifications are given at the gain crossover angular frequency, $\\omega_{gc}$, where the magnitude of the OLTF is unity.\n$\\omega_{gc} = 2\\pi f_b = 2\\pi(30\\,\\text{Hz}) = 60\\pi\\,\\text{rad}\\,\\text{s}^{-1}$.\n\nThe two design criteria are:\n1.  **Unity-Gain Condition**: The magnitude of the OLTF at $\\omega_{gc}$ must be $1$.\n    $|L(j\\omega_{gc})| = 1$.\n    $L(j\\omega) = \\frac{V(j\\omega K_p + K_i)}{(j\\omega)^2} = \\frac{V(K_i + j\\omega K_p)}{-\\omega^2}$.\n    $|L(j\\omega_{gc})| = \\left| \\frac{V(K_i + j\\omega_{gc} K_p)}{-\\omega_{gc}^2} \\right| = \\frac{V \\sqrt{K_i^2 + (\\omega_{gc} K_p)^2}}{\\omega_{gc}^2}$.\n    Setting this to $1$ gives our first equation:\n    $\\frac{V \\sqrt{K_i^2 + (\\omega_{gc} K_p)^2}}{\\omega_{gc}^2} = 1 \\implies V \\sqrt K_i^2 + (\\omega_{gc} K_p)^2 = \\omega_{gc}^2$.\n\n2.  **Phase Margin Condition**: The phase margin (PM) is defined as $\\text{PM} = 180^\\circ + \\angle L(j\\omega_c)$, or in radians, $\\text{PM} = \\pi + \\angle L(j\\omega_{gc})$.\n    The phase of $L(j\\omega)$ is:\n    $$\\angle L(j\\omega) = \\angle(V(K_i + j\\omega K_p)) - \\angle(-\\omega^2) = \\arctan\\left(\\frac{\\omega K_p}{K_i}\\right) - \\pi$$\n    At $\\omega_{gc}$, the phase margin is:\n    $\\text{PM} = \\pi + \\left(\\arctan\\left(\\frac{\\omega_{gc} K_p}{K_i}\\right) - \\pi\\right) = \\arctan\\left(\\frac{\\omega_{gc} K_p}{K_i}\\right)$.\n    Using the given phase margin $\\text{PM} = 50^\\circ$, we get our second equation:\n    $\\tan(\\text{PM}) = \\tan(50^\\circ) = \\frac{\\omega_{gc} K_p}{K_i}$.\n\nNow we solve the system of two equations for $K_p$ and $K_i$.\nFrom the phase margin equation, we express $K_p$ in terms of $K_i$:\n$K_p = \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}$.\n\nSubstitute this expression for $K_p$ into the unity-gain magnitude equation:\n$\\omega_{gc}^2 = V \\sqrt{K_i^2 + \\left(\\omega_{gc} \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}\\right)^2} = V \\sqrt{K_i^2 + K_i^2 \\tan^2(50^\\circ)}$.\n$\\omega_{gc}^2 = V K_i \\sqrt{1 + \\tan^2(50^\\circ)}$.\nUsing the trigonometric identity $1 + \\tan^2(\\theta) = \\sec^2(\\theta)$:\n$\\omega_{gc}^2 = V K_i \\sqrt{\\sec^2(50^\\circ)} = V K_i |\\sec(50^\\circ)|$.\nSince $50^\\circ$ is in the first quadrant, $\\sec(50^\\circ)$ is positive.\n$\\omega_{gc}^2 = V K_i \\sec(50^\\circ) = V K_i \\frac{1}{\\cos(50^\\circ)}$.\n\nSolving for $K_i$:\n$K_i = \\frac{\\omega_{gc}^2 \\cos(50^\\circ)}{V}$.\n\nNow we solve for $K_p$ by substituting the expression for $K_i$ back into the phase margin relation:\n$\\frac{\\omega_{gc} K_p}{K_i} = \\tan(50^\\circ) \\implies K_p = \\frac{K_i \\tan(50^\\circ)}{\\omega_{gc}}$.\n$K_p = \\frac{1}{\\omega_{gc}} \\left( \\frac{\\omega_{gc}^2 \\cos(50^\\circ)}{V} \\right) \\tan(50^\\circ) = \\frac{\\omega_{gc}}{V} \\cos(50^\\circ) \\frac{\\sin(50^\\circ)}{\\cos(50^\\circ)}$.\n$K_p = \\frac{\\omega_{gc} \\sin(50^\\circ)}{V}$.\n\nNow, we substitute the numerical values:\n$V = 325\\,\\text{V}$.\n$\\omega_{gc} = 60\\pi\\,\\text{rad}\\,\\text{s}^{-1}$.\n$\\text{PM} = 50^\\circ$.\n\n$K_p = \\frac{(60\\pi)\\,\\sin(50^\\circ)}{325} \\approx \\frac{188.4956 \\times 0.766044}{325} \\approx \\frac{144.4021}{325} \\approx 0.444314\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$.\nRounding to four significant figures, $K_p = 0.4443\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$.\n\n$K_i = \\frac{(60\\pi)^2\\,\\cos(50^\\circ)}{325} \\approx \\frac{35530.5758 \\times 0.642788}{325} \\approx \\frac{22836.315}{325} \\approx 70.2656\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\nRounding to four significant figures, $K_i = 70.27\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.\n\nThe calculated gains are $K_p=0.4443\\,\\text{rad}\\,\\text{s}^{-1}\\,\\text{V}^{-1}$ and $K_i=70.27\\,\\text{rad}\\,\\text{s}^{-2}\\,\\text{V}^{-1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4443  70.27\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond stable steady-state operation, a PLL must maintain synchronization during abrupt grid events, such as a sudden frequency change. This exercise challenges you to analyze the PLL's transient performance from a time-domain perspective. You will determine the minimum loop bandwidth required to ensure the phase error remains within acceptable limits and settles quickly, a critical capability for robust grid-following converters .",
            "id": "3843653",
            "problem": "A three-phase grid-tied converter employs a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL) for grid synchronization. Assume a balanced grid, negligible harmonics, and that the SRF-PLL operates in the small-signal regime so that the phase detector can be linearized about the locked condition. The SRF-PLL uses a proportional-integral loop filter driving the voltage-controlled oscillator, so that the closed-loop small-signal phase error dynamics are those of a second-order, type-II system characterized by natural frequency $\\omega_{n}$ and damping ratio $\\zeta$. The designer defines the Phase-Locked Loop (PLL) closed-loop bandwidth as $f_{b} \\equiv \\omega_{n}/(2\\pi)$.\n\nWhen the grid frequency undergoes a step of magnitude $|\\Delta f| = 2~\\mathrm{Hz}$, the instantaneous phase error $\\varphi(t)$ should satisfy the following performance requirements:\n- The peak phase excursion at any time must satisfy $|\\varphi(t)| \\leq 10^{\\circ}$.\n- The loop must be considered to have tracked the new frequency within $t_{s} = 50~\\mathrm{ms}$ according to the $2\\%$ settling-time criterion for a second-order system, applied to the decaying homogeneous response envelope of the phase error.\n\nStarting from the linear time-invariant model of the SRF-PLL error dynamics and standard second-order system definitions, determine the minimum closed-loop bandwidth $f_{b}$ that satisfies both requirements. You may choose $\\zeta$ to minimize the required bandwidth, but you must justify your choice from the dynamics. Angles must be handled in radians in all intermediate derivations; the grid frequency step is $\\Delta \\omega = 2\\pi \\Delta f$. Express the final bandwidth in $\\mathrm{Hz}$ and round your answer to three significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It represents a standard control system design problem in the context of power electronics. All provided data and constraints are consistent and realistic.\n\nThe system under consideration is a Synchronous Reference Frame Phase-Locked Loop (SRF-PLL). For small-signal analysis around a locked state, the closed-loop dynamics of the phase error, $\\varphi(t) = \\theta_g(t) - \\hat{\\theta}(t)$, where $\\theta_g$ is the grid phase and $\\hat{\\theta}$ is the PLL's estimated phase, can be modeled by a second-order, type-II system. The error transfer function is given by:\n$$\n\\frac{\\Phi(s)}{\\Theta_g(s)} = \\frac{s^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\nwhere $\\Phi(s)$ and $\\Theta_g(s)$ are the Laplace transforms of the phase error and grid phase, respectively. $\\omega_n$ is the natural frequency and $\\zeta$ is the damping ratio.\n\nThe input disturbance is a step in grid frequency of magnitude $|\\Delta f| = 2~\\mathrm{Hz}$. The change in angular frequency is $\\Delta \\omega = 2\\pi |\\Delta f| = 2\\pi(2) = 4\\pi~\\mathrm{rad/s}$. A step in frequency corresponds to a ramp in phase. The component of the grid phase causing the error is $\\theta_g(t) = (\\Delta \\omega) t$ for $t \\ge 0$. The Laplace transform of this input is $\\Theta_g(s) = \\frac{\\Delta \\omega}{s^2}$.\n\nThe phase error in the Laplace domain is therefore:\n$$\n\\Phi(s) = \\frac{s^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2} \\cdot \\frac{\\Delta \\omega}{s^2} = \\frac{\\Delta \\omega}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\nThis is the response of a standard second-order system to an impulse of magnitude $\\Delta \\omega$. For an underdamped system ($0  \\zeta  1$), the time-domain phase error is:\n$$\n\\varphi(t) = \\frac{\\Delta \\omega}{\\omega_d} e^{-\\zeta \\omega_n t} \\sin(\\omega_d t)\n$$\nwhere $\\omega_d = \\omega_n\\sqrt{1-\\zeta^2}$ is the damped natural frequency. The steady-state error is zero, as expected for a type-II system responding to a ramp input.\n\nWe must satisfy two performance requirements, which we formulate as constraints on $\\omega_n$ and $\\zeta$.\n\n**Constraint 1: Peak Phase Excursion**\nThe peak phase error, $|\\varphi(t)|$, must not exceed $\\varphi_{max} = 10^{\\circ} = 10 \\frac{\\pi}{180} = \\frac{\\pi}{18}$ radians. The first peak of $\\varphi(t)$ occurs when its derivative is zero. This happens at time $t_p = \\frac{\\arccos(\\zeta)}{\\omega_d}$. Substituting this time back into the expression for $\\varphi(t)$ yields the peak value:\n$$\n\\varphi_{peak} = \\frac{\\Delta \\omega}{\\omega_n} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right)\n$$\nThe constraint $\\varphi_{peak} \\leq \\varphi_{max}$ leads to a lower bound on $\\omega_n$:\n$$\n\\omega_n \\geq \\frac{\\Delta \\omega}{\\varphi_{max}} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right)\n$$\n\n**Constraint 2: Settling Time**\nThe settling time $t_s$ must be less than or equal to $t_{s,max} = 50~\\mathrm{ms} = 0.05~\\mathrm{s}$. The problem defines this using the $2\\%$ criterion applied to the decaying homogeneous response envelope. The envelope of $\\varphi(t)$ is controlled by the term $e^{-\\zeta\\omega_n t}$. The time for this envelope to decay to $2\\%$ of its initial value is found by solving $e^{-\\zeta\\omega_n t_s} = 0.02$.\n$$\n-\\zeta\\omega_n t_s = \\ln(0.02) = -\\ln(50) \\implies t_s = \\frac{\\ln(50)}{\\zeta \\omega_n}\n$$\nThe constraint $t_s \\leq t_{s,max}$ leads to a second lower bound on $\\omega_n$:\n$$\n\\omega_n \\geq \\frac{\\ln(50)}{\\zeta t_{s,max}}\n$$\n\n**Optimization**\nTo find the minimum required bandwidth $f_b = \\omega_n / (2\\pi)$, we must find the minimum $\\omega_n$ that satisfies both constraints for some choice of $\\zeta$. The required $\\omega_n$ is:\n$$\n\\omega_{n,req} = \\max\\left( \\frac{\\Delta \\omega}{\\varphi_{max}} \\exp\\left(-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}\\right), \\frac{\\ln(50)}{\\zeta t_{s,max}} \\right)\n$$\nWe want to find $\\min_{0  \\zeta \\leq 1} \\{ \\omega_{n,req} \\}$. Let's analyze the dependency of the two bounds on $\\zeta$. The term $\\frac{1}{\\zeta}$ in the second bound is a decreasing function of $\\zeta$. For the first bound, the argument of the exponent, $-\\frac{\\zeta \\arccos(\\zeta)}{\\sqrt{1-\\zeta^2}}$, is an increasing function for $\\zeta \\in (0,1)$, meaning the exponential term is also increasing. However, its value is always less than $1$, and the entire bound function can be shown to be monotonically decreasing with $\\zeta$. Since both lower bounds on $\\omega_n$ decrease as $\\zeta$ increases, the minimum required $\\omega_n$ will be achieved at the largest permissible value of $\\zeta$. The optimal choice that minimizes both bounds is the critically damped case, $\\zeta = 1$. This provides the fastest non-oscillatory response, which is beneficial for both settling time and peak excursion.\n\nFor the critically damped case ($\\zeta=1$), the phase error response becomes:\n$$\n\\varphi(t) = \\mathcal{L}^{-1}\\left\\{\\frac{\\Delta \\omega}{(s+\\omega_n)^2}\\right\\} = \\Delta \\omega \\cdot t \\cdot e^{-\\omega_n t}\n$$\nThe constraints are re-evaluated for $\\zeta=1$:\n1.  **Peak Excursion**: The peak of $\\varphi(t)$ occurs at $t_p = 1/\\omega_n$. The peak value is $\\varphi_{peak} = \\Delta \\omega (1/\\omega_n) e^{-1} = \\frac{\\Delta\\omega}{e\\omega_n}$.\n    The constraint is $\\frac{\\Delta\\omega}{e\\omega_n} \\leq \\varphi_{max}$, which gives $\\omega_n \\geq \\frac{\\Delta\\omega}{e\\varphi_{max}}$.\n2.  **Settling Time**: Using the same definition derived from the exponential envelope, we take the limit as $\\zeta \\to 1$, which gives $t_s = \\frac{\\ln(50)}{\\omega_n}$.\n    The constraint is $\\frac{\\ln(50)}{\\omega_n} \\leq t_{s,max}$, which gives $\\omega_n \\geq \\frac{\\ln(50)}{t_{s,max}}$.\n\nNow, we substitute the given numerical values:\n$\\Delta \\omega = 4\\pi~\\mathrm{rad/s}$\n$\\varphi_{max} = \\pi/18~\\mathrm{rad}$\n$t_{s,max} = 0.05~\\mathrm{s}$\n\nCalculating the two lower bounds on $\\omega_n$:\nFrom the peak excursion constraint:\n$$\n\\omega_{n,1} = \\frac{4\\pi}{e(\\pi/18)} = \\frac{72}{e} \\approx 26.487~\\mathrm{rad/s}\n$$\nFrom the settling time constraint:\n$$\n\\omega_{n,2} = \\frac{\\ln(50)}{0.05} \\approx \\frac{3.91202}{0.05} \\approx 78.240~\\mathrm{rad/s}\n$$\nThe required natural frequency must be greater than or equal to the maximum of these two values:\n$$\n\\omega_{n,min} = \\max(\\omega_{n,1}, \\omega_{n,2}) = \\max(26.487, 78.240) = 78.240~\\mathrm{rad/s}\n$$\nThe settling time requirement is the limiting factor. The minimum closed-loop bandwidth $f_b$ is defined as $\\omega_n/(2\\pi)$.\n$$\nf_{b,min} = \\frac{\\omega_{n,min}}{2\\pi} = \\frac{78.240}{2\\pi} \\approx 12.454~\\mathrm{Hz}\n$$\nRounding the final answer to three significant figures gives $12.5~\\mathrm{Hz}$.",
            "answer": "$$\n\\boxed{12.5}\n$$"
        },
        {
            "introduction": "The transition from a theoretical continuous-time design to a practical digital implementation introduces non-ideal effects that can compromise performance. This final practice explores the impact of sampling and computational delays inherent in digital control systems. You will quantify the phase lag introduced by these delays and determine the maximum sampling period that can be used while still guaranteeing the required stability margin .",
            "id": "3843645",
            "problem": "A three-phase Synchronous Reference Frame Phase-Locked Loop (SRF-PLL) is designed in continuous time to synchronize with a $50$ Hz grid. In its linearized small-signal form about the locked condition, the phase detector gain is approximated as a constant, the loop filter is proportional-integral, and the voltage-controlled oscillator (or numerically controlled oscillator) contributes an integrator. The continuous-time open-loop design has been verified (by an independent Bode analysis in simulation) to achieve a crossover frequency of $\\omega_{c} = 2\\pi \\cdot 20$ rad/s and a phase margin of $60^\\circ$ when implemented without sampling or holding.\n\nIn the digital implementation, the control command to the oscillator is updated once per sampling period. The actuation is held by a Zero-Order Hold (ZOH) of duration equal to the sampling period $T$, and the computation and update scheduling introduce exactly one sampling-period delay (i.e., the control computed at sample $k$ is applied at sample $k+1$, assuming synchronous sampling and actuation).\n\nStarting only from the following foundational elements:\n- The definition of phase margin as the difference between $180^\\circ$ and the loop phase at the gain crossover frequency.\n- The exact frequency response of a Zero-Order Hold of period $T$.\n- The frequency response of a pure time delay of duration $\\tau$.\n\nDerive how the ZOH and the discrete update delay alter the loop phase at $\\omega_{c}$, quantify the additional phase lag from these mechanisms at $\\omega_{c}$, and compute the maximum allowable sampling period $T_{\\max}$ such that the resulting phase margin remains strictly greater than $45^\\circ$.\n\nExpress your final $T_{\\max}$ in milliseconds, and round your answer to four significant figures. Use degrees for angle specifications in the problem, and perform any internal calculations in radians.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- System: Three-phase Synchronous Reference Frame Phase-Locked Loop (SRF-PLL)\n- Grid frequency: $50$ Hz\n- Continuous-time open-loop gain crossover frequency: $\\omega_{c} = 2\\pi \\cdot 20$ rad/s\n- Continuous-time open-loop phase margin: $60^\\circ$\n- Digital implementation artifacts:\n    1. Zero-Order Hold (ZOH) with period $T$.\n    2. One sampling-period computational delay, duration $T$.\n- Required final phase margin: Strictly greater than $45^\\circ$.\n- Foundational elements for derivation:\n    1. Definition of phase margin.\n    2. Exact frequency response of a ZOH.\n    3. Frequency response of a pure time delay.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on standard principles of digital control theory applied to power electronics, a core topic in electrical engineering. The SRF-PLL, ZOH, and computational delays are standard models. All aspects are scientifically sound.\n- **Well-Posed**: The problem provides sufficient initial conditions (continuous-time performance) and a clear constraint (final phase margin) to determine a unique maximum value for the sampling period $T$.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation\nLet the open-loop transfer function of the original continuous-time system be $G_{OL,c}(s)$. The gain crossover frequency, $\\omega_c$, is defined by the condition $|G_{OL,c}(j\\omega_c)| = 1$. The phase margin, $PM$, is defined as $PM = 180^\\circ + \\angle G_{OL,c}(j\\omega_c)$.\n\nGiven the initial phase margin $PM_c = 60^\\circ$, we can find the phase of the continuous-time system at the crossover frequency:\n$$60^\\circ = 180^\\circ + \\angle G_{OL,c}(j\\omega_c)$$\n$$\\angle G_{OL,c}(j\\omega_c) = 60^\\circ - 180^\\circ = -120^\\circ$$\nIn radians, this phase is $\\angle G_{OL,c}(j\\omega_c) = -120^\\circ \\cdot \\frac{\\pi}{180^\\circ} = -\\frac{2\\pi}{3}$ radians.\n\nThe digital implementation introduces two effects into the loop: a Zero-Order Hold (ZOH) and a one-sample computational delay. We will analyze the phase lag introduced by each component.\n\n1.  **Zero-Order Hold (ZOH)**: The transfer function of a ZOH with hold time $T$ is $G_{\\text{ZOH}}(s) = \\frac{1 - \\exp(-sT)}{s}$. Its frequency response is obtained by setting $s = j\\omega$:\n    $$G_{\\text{ZOH}}(j\\omega) = \\frac{1 - \\exp(-j\\omega T)}{j\\omega}$$\n    To find the phase, we rewrite the numerator:\n    $$1 - \\exp(-j\\omega T) = 1 - (\\cos(-\\omega T) + j\\sin(-\\omega T)) = 1 - \\cos(\\omega T) + j\\sin(\\omega T)$$\n    The phase of the numerator is $\\arctan\\left(\\frac{\\sin(\\omega T)}{1 - \\cos(\\omega T)}\\right)$. Using the half-angle identity $\\tan(\\theta/2) = \\frac{\\sin(\\theta)}{1 - \\cos(\\theta)}$, this becomes $\\arctan(\\cot(\\omega T/2)) = \\frac{\\pi}{2} - \\frac{\\omega T}{2}$. The phase of the denominator, $j\\omega$, is $\\frac{\\pi}{2}$.\n    The total phase of the ZOH is the phase of the numerator minus the phase of the denominator:\n    $$\\angle G_{\\text{ZOH}}(j\\omega) = \\left(\\frac{\\pi}{2} - \\frac{\\omega T}{2}\\right) - \\frac{\\pi}{2} = -\\frac{\\omega T}{2} \\text{ radians}$$\n    Thus, the ZOH introduces a phase lag of $\\frac{\\omega T}{2}$.\n\n2.  **Computational Delay**: The problem states a pure time delay of one sampling period, $T$. The transfer function for this delay is $G_{d}(s) = \\exp(-sT)$. Its frequency response is:\n    $$G_{d}(j\\omega) = \\exp(-j\\omega T)$$\n    The phase contribution of this delay is:\n    $$\\angle G_{d}(j\\omega) = -\\omega T \\text{ radians}$$\n\nThe total additional phase lag, $\\Delta\\phi_{\\text{dig}}(\\omega)$, from the digital implementation is the sum of the phase lags from the ZOH and the computational delay:\n$$\\Delta\\phi_{\\text{dig}}(\\omega) = \\angle G_{\\text{ZOH}}(j\\omega) + \\angle G_{d}(j\\omega) = -\\frac{\\omega T}{2} - \\omega T = -\\frac{3}{2}\\omega T$$\n\nThe problem asks to evaluate the impact of these delays on the phase margin. The introduction of these delay elements will slightly reduce the open-loop gain, causing the true crossover frequency to decrease. However, a standard and effective approximation, supported by the problem's phrasing \"alter the loop phase at $\\omega_c$\", is to evaluate the phase degradation at the original crossover frequency $\\omega_c$.\n\nThe new phase of the loop at $\\omega_c$ is:\n$$\\angle G_{OL,d}(j\\omega_c) = \\angle G_{OL,c}(j\\omega_c) + \\Delta\\phi_{\\text{dig}}(\\omega_c) = -\\frac{2\\pi}{3} - \\frac{3}{2}\\omega_c T$$\nThe new phase margin, $PM_d$, is:\n$$PM_d = \\pi + \\angle G_{OL,d}(j\\omega_c) = \\pi - \\frac{2\\pi}{3} - \\frac{3}{2}\\omega_c T = \\frac{\\pi}{3} - \\frac{3}{2}\\omega_c T$$\nThis shows that the initial phase margin of $\\frac{\\pi}{3}$ radians ($60^\\circ$) is reduced by an amount $\\frac{3}{2}\\omega_c T$.\n\nWe are given the constraint that the resulting phase margin must be strictly greater than $45^\\circ$, which is $\\frac{\\pi}{4}$ radians.\n$$PM_d > \\frac{\\pi}{4}$$\n$$\\frac{\\pi}{3} - \\frac{3}{2}\\omega_c T  \\frac{\\pi}{4}$$\nTo find the maximum sampling period $T_{\\max}$, we solve the inequality for $T$:\n$$\\frac{\\pi}{3} - \\frac{\\pi}{4}  \\frac{3}{2}\\omega_c T$$\n$$\\frac{4\\pi - 3\\pi}{12}  \\frac{3}{2}\\omega_c T$$\n$$\\frac{\\pi}{12}  \\frac{3}{2}\\omega_c T$$\n$$T  \\frac{2\\pi}{12 \\cdot 3 \\omega_c} = \\frac{\\pi}{18 \\omega_c}$$\nSo, the maximum allowable sampling period is $T_{\\max} = \\frac{\\pi}{18 \\omega_c}$.\n\nNow, we substitute the given value for $\\omega_c = 2\\pi \\cdot 20$ rad/s:\n$$T_{\\max} = \\frac{\\pi}{18 (2\\pi \\cdot 20)} = \\frac{1}{18 \\cdot 2 \\cdot 20} = \\frac{1}{720} \\text{ s}$$\nThe problem asks for the answer in milliseconds, rounded to four significant figures.\n$$T_{\\max} = \\frac{1}{720} \\text{ s} \\times \\frac{1000 \\text{ ms}}{1 \\text{ s}} = \\frac{1000}{720} \\text{ ms} = \\frac{100}{72} \\text{ ms} = \\frac{25}{18} \\text{ ms}$$\n$$T_{\\max} \\approx 1.3888... \\text{ ms}$$\nRounding to four significant figures, we get:\n$$T_{\\max} \\approx 1.389 \\text{ ms}$$\nThe additional phase lag from the ZOH and delay at this maximum sampling period is $|\\Delta\\phi_{\\text{dig}}(\\omega_c)| = \\frac{3}{2} \\omega_c T_{\\max} = \\frac{3}{2} (2\\pi \\cdot 20) \\frac{1}{720} = \\frac{60\\pi}{720} = \\frac{\\pi}{12}$ radians, or $15^\\circ$, which correctly reduces the phase margin from $60^\\circ$ to $45^\\circ$. The \"strictly greater than\" condition implies we must choose $T  T_{\\max}$. The question asks for the maximum allowable sampling period, which is the boundary of this condition.\n\nIn summary, the total phase lag introduced by the ZOH and one-sample delay is $-\\frac{3}{2}\\omega T$. The difference between the initial phase margin ($60^\\circ$) and the minimum desired phase margin ($45^\\circ$) is $15^\\circ$, or $\\frac{\\pi}{12}$ radians. This is the maximum phase lag that can be tolerated at the crossover frequency. Setting $\\frac{3}{2}\\omega_c T_{\\max} = \\frac{\\pi}{12}$ yields the solution.",
            "answer": "$$\\boxed{1.389}$$"
        }
    ]
}