{
    "hands_on_practices": [
        {
            "introduction": "The foundation of Selective Harmonic Elimination (SHE) lies in the precise mathematical relationship between an inverter's switching angles and the harmonic spectrum of its output voltage. This first exercise guides you through the fundamental derivation of this relationship for a generalized multilevel cascaded H-bridge inverter. By mastering this derivation, you will establish the core equations used to formulate and solve SHE problems for a wide range of converter topologies.",
            "id": "3876981",
            "problem": "Consider a single-phase cascaded H-bridge inverter comprising $s$ H-bridge cells connected in series. The $i$-th H-bridge has an independent direct-current source of magnitude $V_{i}  0$. Assume ideal switching devices and negligible parasitics. The output voltage waveform $v(\\theta)$ over an electrical angle $\\theta$ is designed to exhibit half-wave symmetry, i.e., $v(\\theta + \\pi) = -v(\\theta)$, and quarter-wave symmetry, i.e., $v(\\pi - \\theta) = v(\\theta)$ for $\\theta \\in [0, \\pi]$, with a stepped structure in the first quadrant constructed as follows.\n\nIn the first quadrant $\\theta \\in [0, \\frac{\\pi}{2}]$, each cell transitions from $0$ to $+V_{i}$ at a unique switching angle $\\alpha_{i} \\in (0, \\frac{\\pi}{2})$, with strict ordering $0  \\alpha_{1}  \\alpha_{2}  \\cdots  \\alpha_{s}  \\frac{\\pi}{2}$. Consequently, the waveform is piecewise constant on subintervals, taking the values $0$ on $[0, \\alpha_{1})$, $V_{1}$ on $[\\alpha_{1}, \\alpha_{2})$, $V_{1}+V_{2}$ on $[\\alpha_{2}, \\alpha_{3})$, and so on, up to $\\sum_{i=1}^{s} V_{i}$ on $[\\alpha_{s}, \\frac{\\pi}{2}]$. The remainder of the period is completed by symmetry under the stated half-wave and quarter-wave conditions, resulting in an odd function with only sine harmonics.\n\nStarting from the fundamental definition of the Fourier series for a real, $2\\pi$-periodic signal and exploiting the stated symmetries, derive the expressions for the Fourier coefficients $a_{n}$ and $b_{n}$ of $v(\\theta)$ in terms of the level voltages $\\{V_{i}\\}_{i=1}^{s}$ and the switching angles $\\{\\alpha_{i}\\}_{i=1}^{s}$. Then, express the amplitude $V_{1}$ of the fundamental component (the coefficient of $\\sin(\\theta)$) as a closed-form analytic expression in terms of $\\{V_{i}\\}$ and $\\{\\alpha_{i}\\}$.\n\nAll angles $\\alpha_{i}$ must be treated in radians. Express your final formula symbolically; do not perform any numerical evaluation.",
            "solution": "The problem requires the derivation of the Fourier series coefficients for a specified multilevel voltage waveform and, subsequently, the amplitude of the fundamental component.\n\nFirst, let us address the notation. The problem uses the symbol $V_{i}$ to denote the DC voltage of the $i$-th H-bridge cell. It then requests the amplitude of the fundamental component, which it also names $V_{1}$. This creates a potential ambiguity between the amplitude of the fundamental harmonic and the DC voltage of the first cell ($V_{1}$). Based on the phrasing \"express the amplitude $V_{1}$ ... in terms of $\\{V_{i}\\}$\", it is clear that the fundamental amplitude is the quantity to be derived, while the set of cell voltages $\\{V_{i}\\}_{i=1}^{s}$ are given parameters. We shall proceed under this interpretation, deriving the expression for the fundamental amplitude, which the problem designates as $V_{1}$.\n\nThe Fourier series representation of a $2\\pi$-periodic function $v(\\theta)$ is given by:\n$$v(\\theta) = a_{0} + \\sum_{n=1}^{\\infty} \\left( a_{n} \\cos(n\\theta) + b_{n} \\sin(n\\theta) \\right)$$\nwhere the coefficients are defined by the Euler formulas:\n$$a_{0} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} v(\\theta) \\, d\\theta$$\n$$a_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\cos(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n$$b_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\sin(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n\nThe problem states that the waveform $v(\\theta)$ possesses specific symmetries, which can be used to simplify the calculation of these coefficients.\n1.  **Half-wave symmetry**: $v(\\theta + \\pi) = -v(\\theta)$. This property implies that the waveform contains no even harmonics. Consequently, $a_{n} = 0$ and $b_{n} = 0$ for all even values of $n$. Furthermore, the DC component $a_{0}$ is also zero. For odd $n$, the integrals simplify.\n2.  **Quarter-wave symmetry**: The problem defines this as $v(\\pi - \\theta) = v(\\theta)$ for $\\theta \\in [0, \\pi]$, which means the waveform is symmetric about $\\theta = \\frac{\\pi}{2}$ over the first half-period. This, combined with half-wave symmetry, implies the waveform is odd, i.e., $v(-\\theta) = -v(\\theta)$. For an odd function, the product $v(\\theta)\\cos(n\\theta)$ is odd, and its integral over a symmetric interval like $[-\\pi, \\pi]$ is zero. Therefore, all cosine coefficients are zero:\n$$a_{n} = 0 \\quad \\text{for all } n \\ge 0$$\nFor the sine coefficients $b_{n}$, the integrand $v(\\theta)\\sin(n\\theta)$ is an even function, which simplifies its integral. The combination of half-wave and quarter-wave symmetry allows the integral over a full period to be expressed as four times the integral over the first quarter-period:\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} v(\\theta) \\sin(n\\theta) \\, d\\theta$$\nThis expression is valid only for odd values of $n$, as $b_n = 0$ for even $n$.\n\nNext, we must evaluate this integral using the specified structure of $v(\\theta)$ in the first quadrant, $\\theta \\in [0, \\frac{\\pi}{2}]$. The voltage waveform is a stepped function, which can be expressed as a sum of step-up transitions at each switching angle $\\alpha_{i}$. A convenient way to represent this is using the Heaviside step function, $H(\\theta)$, where $H(\\theta) = 1$ for $\\theta \\ge 0$ and $H(\\theta) = 0$ for $\\theta  0$. The voltage level increases by $V_{i}$ at the angle $\\alpha_{i}$. Thus, for $\\theta \\in [0, \\frac{\\pi}{2}]$, the waveform can be written as:\n$$v(\\theta) = \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i})$$\nSubstituting this into the expression for $b_{n}$:\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} \\left( \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i}) \\right) \\sin(n\\theta) \\, d\\theta$$\nSince the sum is finite, we can interchange the summation and integration:\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{0}^{\\pi/2} H(\\theta - \\alpha_{i}) \\sin(n\\theta) \\, d\\theta$$\nThe Heaviside function $H(\\theta - \\alpha_{i})$ is zero for $\\theta  \\alpha_{i}$ and one for $\\theta \\ge \\alpha_{i}$. This changes the lower limit of each integral from $0$ to $\\alpha_{i}$:\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta$$\nWe now perform the integration:\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\left[ -\\frac{1}{n} \\cos(n\\theta) \\right]_{\\alpha_{i}}^{\\pi/2} = -\\frac{1}{n} \\cos\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{n} \\cos(n\\alpha_{i})$$\nAs established, this expression for $b_n$ is non-zero only for odd integers $n$. For any odd integer $n$, $\\cos(\\frac{n\\pi}{2}) = 0$. Therefore, the integral simplifies to:\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\frac{1}{n} \\cos(n\\alpha_{i})$$\nSubstituting this result back into the expression for $b_{n}$:\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\left( \\frac{1}{n} \\cos(n\\alpha_{i}) \\right)$$\nThis can be rewritten as:\n$$b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$$\n\nTo summarize the Fourier coefficients:\n- $a_{n} = 0$ for all $n \\ge 0$.\n- $b_{n} = 0$ for all even $n$.\n- $b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$ for all odd $n$.\n\nThe final step is to find the amplitude of the fundamental component. The fundamental component is the term in the Fourier series corresponding to $n=1$. Its amplitude is given by the coefficient $b_{1}$. According to the problem's notation, this amplitude is denoted by $V_{1}$. Setting $n=1$ in our derived expression for $b_{n}$:\n$$V_{1} \\equiv b_{1} = \\frac{4}{1 \\cdot \\pi} \\sum_{i=1}^{s} V_{i} \\cos(1 \\cdot \\alpha_{i})$$\n$$V_{1} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})$$\nThis is the closed-form analytic expression for the amplitude of the fundamental harmonic in terms of the DC voltage levels $\\{V_i\\}$ and the switching angles $\\{\\alpha_i\\}$.",
            "answer": "$$\\boxed{\\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})}$$"
        },
        {
            "introduction": "While solving the nonlinear SHE equations yields a set of switching angles for a specific operating point, a practical controller must adapt to varying commands. This practice delves into the local behavior of SHE solutions by asking you to compute the sensitivity of the switching angles with respect to the modulation index. Using the implicit function theorem, you will quantify how the angles must change to track a varying fundamental voltage command while maintaining harmonic elimination, providing critical insight into the control and stability of the system .",
            "id": "3877000",
            "problem": "A single-phase, full-bridge, two-level inverter is operated with quarter-wave and half-wave symmetry using two switching angles per quarter cycle, denoted by $0  \\alpha_{1}  \\alpha_{2}  \\frac{\\pi}{2}$, to realize Selective Harmonic Elimination (SHE). The resulting output voltage $v(\\theta)$ is a piecewise-constant waveform taking values $\\pm V_{\\text{dc}}$ with transitions at the angles $\\alpha_{1}$ and $\\alpha_{2}$. For such a waveform, the normalized amplitude of the $n$th odd harmonic (relative to $V_{\\text{dc}}$) is given by the well-tested Fourier series result\n$$\n\\frac{A_{n}}{V_{\\text{dc}}} = \\frac{4}{n\\pi}\\left[\\sum_{k=1}^{2}(-1)^{k+1}\\cos(n\\alpha_{k})\\right], \\quad n \\in \\{1,3,5,\\dots\\}.\n$$\nDefine the modulation index $m$ as the normalized fundamental amplitude,\n$$\nm = \\frac{A_{1}}{V_{\\text{dc}}} = \\frac{4}{\\pi}\\left[\\cos(\\alpha_{1}) - \\cos(\\alpha_{2})\\right].\n$$\nTo eliminate the fifth harmonic, impose\n$$\n\\cos(5\\alpha_{1}) - \\cos(5\\alpha_{2}) = 0.\n$$\nLet the vector of constraints be\n$$\n\\boldsymbol{F}(\\boldsymbol{\\alpha},m) = \\begin{pmatrix}\n\\frac{4}{\\pi}\\left[\\cos(\\alpha_{1}) - \\cos(\\alpha_{2})\\right] - m \\\\\n\\cos(5\\alpha_{1}) - \\cos(5\\alpha_{2})\n\\end{pmatrix} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\alpha} = \\begin{pmatrix}\\alpha_{1} \\\\ \\alpha_{2}\\end{pmatrix}$. Consider the specific SHE operating point with angles $\\alpha_{1} = \\frac{\\pi}{10}$ and $\\alpha_{2} = \\frac{3\\pi}{10}$, and the corresponding modulation index $m$ that satisfies $\\boldsymbol{F}(\\boldsymbol{\\alpha},m) = \\boldsymbol{0}$.\n\nUsing implicit differentiation of $\\boldsymbol{F}(\\boldsymbol{\\alpha},m) = \\boldsymbol{0}$ with respect to $m$, compute the sensitivity vector $\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m}$ evaluated at $\\alpha_{1} = \\frac{\\pi}{10}$ and $\\alpha_{2} = \\frac{3\\pi}{10}$. Express the final answer as a single row vector $\\begin{pmatrix}\\frac{\\partial \\alpha_{1}}{\\partial m}  \\frac{\\partial \\alpha_{2}}{\\partial m}\\end{pmatrix}$ in radians per unit of $m$. Express your final derivatives exactly (no rounding).",
            "solution": "The problem requires the computation of the sensitivity vector $\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m}$, which represents how the switching angles $\\alpha_1$ and $\\alpha_2$ change with respect to the modulation index $m$. We are given the system of equations $\\boldsymbol{F}(\\boldsymbol{\\alpha}, m) = \\boldsymbol{0}$, where the angles $\\boldsymbol{\\alpha}$ are implicitly defined as a function of $m$. We can find the desired sensitivity by applying implicit differentiation.\n\nThe total differential of the vector function $\\boldsymbol{F}(\\boldsymbol{\\alpha}(m), m)$ with respect to $m$ must be zero:\n$$\n\\frac{d\\boldsymbol{F}}{dm} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{\\alpha}} \\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m} + \\frac{\\partial \\boldsymbol{F}}{\\partial m} = \\boldsymbol{0}.\n$$\nHere, $\\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{\\alpha}}$ is the Jacobian matrix of $\\boldsymbol{F}$ with respect to $\\boldsymbol{\\alpha}$, $\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m}$ is the sensitivity vector we want to find, and $\\frac{\\partial \\boldsymbol{F}}{\\partial m}$ is the partial derivative of $\\boldsymbol{F}$ with respect to $m$.\n\nRearranging the equation to solve for the sensitivity vector, we get:\n$$\n\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m} = - \\left(\\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{\\alpha}}\\right)^{-1} \\frac{\\partial \\boldsymbol{F}}{\\partial m}.\n$$\n\nLet the two component equations of $\\boldsymbol{F} = \\boldsymbol{0}$ be:\n$F_1(\\alpha_1, \\alpha_2, m) = \\frac{4}{\\pi}(\\cos(\\alpha_1) - \\cos(\\alpha_2)) - m = 0$\n$F_2(\\alpha_1, \\alpha_2, m) = \\cos(5\\alpha_1) - \\cos(5\\alpha_2) = 0$\n\nFirst, we compute the Jacobian matrix $\\boldsymbol{J}_{\\boldsymbol{\\alpha}} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{\\alpha}}$:\n$$\n\\boldsymbol{J}_{\\boldsymbol{\\alpha}} =\n\\begin{pmatrix}\n\\frac{\\partial F_1}{\\partial \\alpha_1}  \\frac{\\partial F_1}{\\partial \\alpha_2} \\\\\n\\frac{\\partial F_2}{\\partial \\alpha_1}  \\frac{\\partial F_2}{\\partial \\alpha_2}\n\\end{pmatrix}\n$$\nThe partial derivatives are:\n$\\frac{\\partial F_1}{\\partial \\alpha_1} = \\frac{\\partial}{\\partial \\alpha_1} \\left[ \\frac{4}{\\pi}(\\cos(\\alpha_1) - \\cos(\\alpha_2)) - m \\right] = -\\frac{4}{\\pi}\\sin(\\alpha_1)$\n$\\frac{\\partial F_1}{\\partial \\alpha_2} = \\frac{\\partial}{\\partial \\alpha_2} \\left[ \\frac{4}{\\pi}(\\cos(\\alpha_1) - \\cos(\\alpha_2)) - m \\right] = \\frac{4}{\\pi}\\sin(\\alpha_2)$\n$\\frac{\\partial F_2}{\\partial \\alpha_1} = \\frac{\\partial}{\\partial \\alpha_1} \\left[ \\cos(5\\alpha_1) - \\cos(5\\alpha_2) \\right] = -5\\sin(5\\alpha_1)$\n$\\frac{\\partial F_2}{\\partial \\alpha_2} = \\frac{\\partial}{\\partial \\alpha_2} \\left[ \\cos(5\\alpha_1) - \\cos(5\\alpha_2) \\right] = 5\\sin(5\\alpha_2)$\n\nSo the Jacobian matrix is:\n$$\n\\boldsymbol{J}_{\\boldsymbol{\\alpha}} =\n\\begin{pmatrix}\n-\\frac{4}{\\pi}\\sin(\\alpha_1)  \\frac{4}{\\pi}\\sin(\\alpha_2) \\\\\n-5\\sin(5\\alpha_1)  5\\sin(5\\alpha_2)\n\\end{pmatrix}\n$$\n\nNext, we compute the vector $\\frac{\\partial \\boldsymbol{F}}{\\partial m}$:\n$$\n\\frac{\\partial \\boldsymbol{F}}{\\partial m} =\n\\begin{pmatrix}\n\\frac{\\partial F_1}{\\partial m} \\\\\n\\frac{\\partial F_2}{\\partial m}\n\\end{pmatrix} =\n\\begin{pmatrix}\n-1 \\\\\n0\n\\end{pmatrix}\n$$\n\nThe system to be solved is $\\boldsymbol{J}_{\\boldsymbol{\\alpha}} \\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m} = - \\frac{\\partial \\boldsymbol{F}}{\\partial m}$:\n$$\n\\begin{pmatrix}\n-\\frac{4}{\\pi}\\sin(\\alpha_1)  \\frac{4}{\\pi}\\sin(\\alpha_2) \\\\\n-5\\sin(5\\alpha_1)  5\\sin(5\\alpha_2)\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{\\partial \\alpha_1}{\\partial m} \\\\\n\\frac{\\partial \\alpha_2}{\\partial m}\n\\end{pmatrix}\n=\n- \\begin{pmatrix}\n-1 \\\\\n0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}\n$$\n\nNow, we evaluate the Jacobian at the given operating point $\\alpha_1 = \\frac{\\pi}{10}$ and $\\alpha_2 = \\frac{3\\pi}{10}$. We need the following trigonometric values:\n$\\sin(\\alpha_1) = \\sin(\\frac{\\pi}{10}) = \\frac{\\sqrt{5}-1}{4}$\n$\\sin(\\alpha_2) = \\sin(\\frac{3\\pi}{10}) = \\sin(54^\\circ) = \\cos(36^\\circ) = \\frac{\\sqrt{5}+1}{4}$\n$\\sin(5\\alpha_1) = \\sin(5 \\cdot \\frac{\\pi}{10}) = \\sin(\\frac{\\pi}{2}) = 1$\n$\\sin(5\\alpha_2) = \\sin(5 \\cdot \\frac{3\\pi}{10}) = \\sin(\\frac{3\\pi}{2}) = -1$\n\nSubstituting these values into the Jacobian matrix:\n$$\n\\boldsymbol{J}_{\\boldsymbol{\\alpha}} =\n\\begin{pmatrix}\n-\\frac{4}{\\pi}\\left(\\frac{\\sqrt{5}-1}{4}\\right)  \\frac{4}{\\pi}\\left(\\frac{\\sqrt{5}+1}{4}\\right) \\\\\n-5(1)  5(-1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{\\sqrt{5}-1}{\\pi}  \\frac{\\sqrt{5}+1}{\\pi} \\\\\n-5  -5\n\\end{pmatrix}\n$$\n\nThe linear system becomes:\n$$\n\\begin{pmatrix}\n-\\frac{\\sqrt{5}-1}{\\pi}  \\frac{\\sqrt{5}+1}{\\pi} \\\\\n-5  -5\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{\\partial \\alpha_1}{\\partial m} \\\\\n\\frac{\\partial \\alpha_2}{\\partial m}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}\n$$\nThis represents two linear equations:\n1.  $(-\\frac{\\sqrt{5}-1}{\\pi}) \\frac{\\partial \\alpha_1}{\\partial m} + (\\frac{\\sqrt{5}+1}{\\pi}) \\frac{\\partial \\alpha_2}{\\partial m} = 1$\n2.  $-5 \\frac{\\partial \\alpha_1}{\\partial m} - 5 \\frac{\\partial \\alpha_2}{\\partial m} = 0$\n\nFrom equation (2), we find a simple relationship between the two sensitivities:\n$-5(\\frac{\\partial \\alpha_1}{\\partial m} + \\frac{\\partial \\alpha_2}{\\partial m}) = 0 \\implies \\frac{\\partial \\alpha_1}{\\partial m} = -\\frac{\\partial \\alpha_2}{\\partial m}$.\n\nSubstitute this relationship into equation (1):\n$$\n\\left(-\\frac{\\sqrt{5}-1}{\\pi}\\right) \\left(-\\frac{\\partial \\alpha_2}{\\partial m}\\right) + \\left(\\frac{\\sqrt{5}+1}{\\pi}\\right) \\frac{\\partial \\alpha_2}{\\partial m} = 1\n$$\n$$\n\\frac{\\partial \\alpha_2}{\\partial m} \\left( \\frac{\\sqrt{5}-1}{\\pi} + \\frac{\\sqrt{5}+1}{\\pi} \\right) = 1\n$$\n$$\n\\frac{\\partial \\alpha_2}{\\partial m} \\left( \\frac{\\sqrt{5}-1+\\sqrt{5}+1}{\\pi} \\right) = 1\n$$\n$$\n\\frac{\\partial \\alpha_2}{\\partial m} \\left( \\frac{2\\sqrt{5}}{\\pi} \\right) = 1\n$$\nSolving for $\\frac{\\partial \\alpha_2}{\\partial m}$:\n$$\n\\frac{\\partial \\alpha_2}{\\partial m} = \\frac{\\pi}{2\\sqrt{5}} = \\frac{\\pi\\sqrt{5}}{10}\n$$\nNow, we find $\\frac{\\partial \\alpha_1}{\\partial m}$:\n$$\n\\frac{\\partial \\alpha_1}{\\partial m} = -\\frac{\\partial \\alpha_2}{\\partial m} = -\\frac{\\pi}{2\\sqrt{5}} = -\\frac{\\pi\\sqrt{5}}{10}\n$$\nThe sensitivity vector is $\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial m} = \\begin{pmatrix} -\\frac{\\pi\\sqrt{5}}{10} \\\\ \\frac{\\pi\\sqrt{5}}{10} \\end{pmatrix}$. The problem asks for the result as a single row vector.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\pi\\sqrt{5}}{10}  \\frac{\\pi\\sqrt{5}}{10}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from ideal theory to digital implementation, this final practice addresses the non-ideal effects of finite timer resolution in a digital controller. The quantization of switching instants introduces timing errors that degrade the performance of SHE. This exercise challenges you to model these quantization errors as a random process—a concept central to Random PWM—and to derive the expected harmonic distortion, quantifying the noise floor introduced by the digital implementation .",
            "id": "3876969",
            "problem": "A single-phase two-level full-bridge inverter produces a quarter-wave and half-wave symmetric output voltage waveform by switching between the levels $+V_{\\mathrm{dc}}$ and $-V_{\\mathrm{dc}}$. Within the first quadrant of the electrical angle $\\theta \\in [0,\\pi/2]$, there are $N$ monotonically increasing switching angles $0\\alpha_{1}\\alpha_{2}\\cdots\\alpha_{N}\\pi/2$, with quarter-wave symmetry generating the remainder of the waveform over $[0,2\\pi)$. The fundamental electrical period is $T$, with fundamental angular frequency $\\omega_{0}=2\\pi/T$. The switching instants ideally occur at the scheduled times $t_{k}^{\\star}=\\alpha_{k}/\\omega_{0}$, for $k=1,\\dots,N$, in each quarter-wave.\n\nThe inverter is implemented with a digital timer of finite resolution $\\Delta t0$. Each scheduled switching time is quantized to the nearest timer tick as $t_{k}=\\mathrm{round}(t_{k}^{\\star}/\\Delta t)\\,\\Delta t$. Define the resulting quantization timing error $\\varepsilon_{k}=t_{k}-t_{k}^{\\star}$ and the corresponding angle error $\\delta\\alpha_{k}=\\omega_{0}\\varepsilon_{k}$. Assume a dithering scheme consistent with Random Pulse Width Modulation (random PWM), such that the quantization errors $\\{\\varepsilon_{k}\\}_{k=1}^{N}$ are independent and identically distributed with a uniform distribution on $[-\\Delta t/2,\\Delta t/2]$.\n\nLet $\\mathcal{H}=\\{h_{1},\\dots,h_{K}\\}$ be a finite set of targeted odd harmonic orders that are eliminated by Selective Harmonic Elimination (SHE) in the ideal (unquantized) case. Let $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$ denote the set comprising the fundamental ($m=1$) and the targeted harmonics. The line-to-neutral voltage harmonic amplitudes $V_{m}$ for odd $m$ are defined by the standard Fourier series integral expressions for a piecewise-constant waveform over one period.\n\nStarting only from the Fourier series definition, derive to first order in the small angle errors $\\{\\delta\\alpha_{k}\\}$ a linearized expression for the amplitude error $\\Delta V_{m}$ induced by timing quantization, for each $m\\in\\mathcal{S}$. Then, using the stated probabilistic model of quantization error, compute the expected sum of squares of these amplitude errors over $\\mathcal{S}$,\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right],\n$$\nas a closed-form expression in terms of $V_{\\mathrm{dc}}$, $\\Delta t$, $T$, $N$, the angle set $\\{\\alpha_{k}\\}_{k=1}^{N}$, and the harmonic set $\\mathcal{S}$.\n\nState your final result as a single analytic expression. Use radians for all angles. Do not simplify numerically. Express the final energy-like quantity in units of squared volts, but do not write units in the final answer box.",
            "solution": "The problem requires the derivation of the expected sum of squares of harmonic voltage amplitude errors due to timing quantization in a single-phase inverter using Selective Harmonic Elimination (SHE). The derivation will proceed in three stages: first, establishing the relationship between the switching angles and the harmonic amplitudes; second, linearizing this relationship to find the first-order error in harmonic amplitudes due to small errors in switching angles; and third, calculating the expected value of the sum of squared amplitude errors using the provided statistical model for the timing errors.\n\nThe inverter produces a quarter-wave symmetric output voltage waveform $v(t)$. Let $\\theta = \\omega_0 t$ be the electrical angle, where $\\omega_0 = 2\\pi/T$ is the fundamental angular frequency. Due to quarter-wave symmetry, the waveform over one full period is determined by its shape in the first quadrant, $\\theta \\in [0, \\pi/2]$. Within this quadrant, there are $N$ switching angles $0  \\alpha_1  \\alpha_2  \\dots  \\alpha_N  \\pi/2$. The voltage $v(\\theta)$ switches between $+V_{\\mathrm{dc}}$ and $-V_{\\mathrm{dc}}$. For $\\theta \\in [0, \\pi/2]$, the voltage is given by:\n$$\nv(\\theta) = \n\\begin{cases} \n+V_{\\mathrm{dc}}  \\text{for } 0 \\le \\theta  \\alpha_1 \\\\\n-V_{\\mathrm{dc}}  \\text{for } \\alpha_1 \\le \\theta  \\alpha_2 \\\\\n+V_{\\mathrm{dc}}  \\text{for } \\alpha_2 \\le \\theta  \\alpha_3 \\\\\n\\vdots \\\\\n(-1)^k V_{\\mathrm{dc}}  \\text{for } \\alpha_k \\le \\theta  \\alpha_{k+1} \\\\\n\\vdots \\\\\n(-1)^N V_{\\mathrm{dc}}  \\text{for } \\alpha_N \\le \\theta  \\pi/2\n\\end{cases}\n$$\nwhere for notational convenience, we can define $\\alpha_0 = 0$.\n\nFor a waveform with quarter-wave symmetry, the Fourier series consists only of odd harmonic sine terms. The amplitude $V_m$ of the $m$-th odd harmonic is given by:\n$$\nV_m = \\frac{4}{\\pi} \\int_0^{\\pi/2} v(\\theta) \\sin(m\\theta) \\,d\\theta\n$$\nSubstituting the expression for $v(\\theta)$:\n$$\nV_m = \\frac{4}{\\pi} \\left[ \\int_0^{\\alpha_1} V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta + \\sum_{k=1}^{N-1} \\int_{\\alpha_k}^{\\alpha_{k+1}} (-1)^k V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta + \\int_{\\alpha_N}^{\\pi/2} (-1)^N V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta \\right]\n$$\nPerforming the integration, and using $\\int \\sin(m\\theta) d\\theta = -\\frac{1}{m}\\cos(m\\theta)$:\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ [-\\cos(m\\theta)]_0^{\\alpha_1} + \\sum_{k=1}^{N-1} (-1)^k [-\\cos(m\\theta)]_{\\alpha_k}^{\\alpha_{k+1}} + (-1)^N [-\\cos(m\\theta)]_{\\alpha_N}^{\\pi/2} \\right]\n$$\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ (1 - \\cos(m\\alpha_1)) + \\sum_{k=1}^{N-1} (-1)^k (\\cos(m\\alpha_k) - \\cos(m\\alpha_{k+1})) + (-1)^N (\\cos(m\\alpha_N) - \\cos(m\\pi/2)) \\right]\n$$\nSince $m$ is an odd integer, $\\cos(m\\pi/2) = 0$. Expanding the summation and collecting terms, we find:\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ 1 - 2\\cos(m\\alpha_1) + 2\\cos(m\\alpha_2) - \\dots + 2(-1)^N \\cos(m\\alpha_N) \\right]\n$$\nThis can be written compactly as:\n$$\nV_m(\\alpha_1, \\dots, \\alpha_N) = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{k=1}^N (-1)^k \\cos(m\\alpha_k) \\right)\n$$\nThis equation defines the harmonic amplitudes as functions of the switching angles.\n\nNext, we find the first-order change in $V_m$ due to small perturbations $\\delta\\alpha_k$ in the switching angles $\\alpha_k$. The total error $\\Delta V_m$ is approximated by the first-order Taylor expansion:\n$$\n\\Delta V_m \\approx \\sum_{k=1}^N \\frac{\\partial V_m}{\\partial \\alpha_k} \\delta\\alpha_k\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{\\partial}{\\partial \\alpha_k} \\left[ \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{j=1}^N (-1)^j \\cos(m\\alpha_j) \\right) \\right]\n$$\nThe derivative acts only on the $j=k$ term in the sum:\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 2(-1)^k [-m\\sin(m\\alpha_k)] \\right) = \\frac{8V_{\\mathrm{dc}}}{\\pi} (-1)^{k+1} \\sin(m\\alpha_k)\n$$\nThus, the linearized expression for the amplitude error is:\n$$\n\\Delta V_m = \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k\n$$\nThe angle errors $\\delta\\alpha_k$ are related to the timing quantization errors $\\varepsilon_k$ by $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$.\n\nNow, we compute the expected sum of squares of these amplitude errors, $\\mathbb{E}\\left[\\sum_{m\\in\\mathcal{S}}(\\Delta V_m)^2\\right]$. Let's first compute the expected value of $(\\Delta V_m)^2$.\n$$\n(\\Delta V_m)^2 = \\left( \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k \\right)^2\n$$\n$$\n(\\Delta V_m)^2 = \\left(\\frac{8V_{\\mathrm{dc}}}{\\pi}\\right)^2 \\left( \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k \\right) \\left( \\sum_{j=1}^N (-1)^{j+1} \\sin(m\\alpha_j) \\delta\\alpha_j \\right)\n$$\n$$\n(\\Delta V_m)^2 = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\delta\\alpha_k \\delta\\alpha_j\n$$\nTaking the expectation, and using linearity of expectation:\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j]\n$$\nThe timing errors $\\varepsilon_k$ are independent and identically distributed (i.i.d.) random variables from a uniform distribution $U[-\\Delta t/2, \\Delta t/2]$. Thus, the angle errors $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$ are also i.i.d. random variables, with a uniform distribution on $[-\\omega_0\\Delta t/2, \\omega_0\\Delta t/2]$.\nThe mean of this distribution is $\\mathbb{E}[\\delta\\alpha_k] = 0$.\nThe variance is $\\mathrm{Var}(\\delta\\alpha_k) = \\mathbb{E}[(\\delta\\alpha_k)^2] - (\\mathbb{E}[\\delta\\alpha_k])^2 = \\mathbb{E}[(\\delta\\alpha_k)^2]$. For a uniform distribution $U[-a, a]$, the variance is $a^2/3$. Here, $a = \\omega_0\\Delta t/2$, so:\n$$\n\\mathbb{E}[(\\delta\\alpha_k)^2] = \\frac{(\\omega_0\\Delta t/2)^2}{3} = \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\nSince the errors are independent, $\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\mathbb{E}[\\delta\\alpha_k]\\mathbb{E}[\\delta\\alpha_j]=0$ for $k \\ne j$. Therefore:\n$$\n\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\delta_{kj} \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\nwhere $\\delta_{kj}$ is the Kronecker delta. Substituting this into the expression for $\\mathbb{E}[(\\Delta V_m)^2]$ collapses the double summation to a single sum (for $j=k$):\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N (-1)^{2k} \\sin^2(m\\alpha_k) \\left(\\frac{\\omega_0^2 (\\Delta t)^2}{12}\\right)\n$$\nSince $(-1)^{2k}=1$, this simplifies to:\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\frac{64V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{12\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\nFinally, we compute the required quantity by summing over all harmonics $m$ in the set $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$.\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\sum_{m\\in\\mathcal{S}} \\mathbb{E}[(\\Delta V_m)^2] = \\sum_{m\\in\\mathcal{S}} \\left( \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) \\right)\n$$\nThe constant factor can be pulled out of the summation over $m$:\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{m\\in\\mathcal{S}} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\nWe can swap the order of the finite summations:\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\nThe problem asks for the result in terms of $T$ instead of $\\omega_0$. Substituting $\\omega_0 = 2\\pi/T$:\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 (4\\pi^2/T^2) (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{64V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3T^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\nThis is the final closed-form expression. It depends on the specified parameters $V_{\\mathrm{dc}}$, $\\Delta t$, $T$, $N$, $\\{\\alpha_k\\}_{k=1}^N$, and $\\mathcal{S}$.",
            "answer": "$$\n\\boxed{\\frac{64 V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3 T^2} \\sum_{k=1}^{N} \\sum_{m \\in \\mathcal{S}} \\sin^2(m\\alpha_k)}\n$$"
        }
    ]
}