{
    "hands_on_practices": [
        {
            "introduction": "选择性谐波消除（SHE）技术的核心在于精确选择开关角度以控制输出电压的谐波含量。本练习将引导你运用傅里叶级数这一基本数学工具，从第一性原理出发，推导通用多电平逆变器波形的谐波幅值。通过此实践，你将深刻理解开关波形与其频谱之间的直接关系，这是设计任何SHE策略的基石。",
            "id": "3876981",
            "problem": "考虑一个由 $s$ 个 H 桥单元串联组成的单相级联 H 桥逆变器。第 $i$ 个 H 桥具有一个独立的直流电源，其电压大小为 $V_{i} > 0$。假设开关器件是理想的，且寄生参数可忽略不计。输出电压波形 $v(\\theta)$（其中 $\\theta$ 为电角度）被设计为具有半波对称性，即 $v(\\theta + \\pi) = -v(\\theta)$，以及四分之一波对称性，即对于 $\\theta \\in [0, \\pi]$ 有 $v(\\pi - \\theta) = v(\\theta)$，其在第一象限的阶梯结构构造如下。\n\n在第一象限 $\\theta \\in [0, \\frac{\\pi}{2}]$ 中，每个单元在一个唯一的开关角 $\\alpha_{i} \\in (0, \\frac{\\pi}{2})$ 处从 $0$ 切换到 $+V_{i}$，并满足严格排序 $0  \\alpha_{1}  \\alpha_{2}  \\cdots  \\alpha_{s}  \\frac{\\pi}{2}$。因此，该波形在子区间上是分段恒定的，在 $[0, \\alpha_{1})$ 上取值为 $0$，在 $[\\alpha_{1}, \\alpha_{2})$ 上取值为 $V_{1}$，在 $[\\alpha_{2}, \\alpha_{3})$ 上取值为 $V_{1}+V_{2}$，依此类推，直到在 $[\\alpha_{s}, \\frac{\\pi}{2}]$ 上取值为 $\\sum_{i=1}^{s} V_{i}$。周期的剩余部分根据所述的半波和四分之一波对称条件补全，从而得到一个仅包含正弦谐波的奇函数。\n\n从周期为 $2\\pi$ 的实信号的傅里叶级数基本定义出发，并利用所述的对称性，推导 $v(\\theta)$ 的傅里叶系数 $a_{n}$ 和 $b_{n}$ 关于电平电压 $\\{V_{i}\\}_{i=1}^{s}$ 和开关角 $\\{\\alpha_{i}\\}_{i=1}^{s}$ 的表达式。然后，将基波分量（$\\sin(\\theta)$ 的系数）的幅值 $V_{1}$ 表示为关于 $\\{V_{i}\\}$ 和 $\\{\\alpha_{i}\\}$ 的闭式解析表达式。\n\n所有角度 $\\alpha_{i}$ 都必须以弧度处理。以符号形式表示您的最终公式；不要进行任何数值计算。",
            "solution": "该问题要求推导指定的多电平电压波形的傅里叶级数系数，并随后推导基波分量的幅值。\n\n首先，我们来澄清一下符号。问题中使用符号 $V_{i}$ 表示第 $i$ 个 H 桥单元的直流电压。然后它要求基波分量的幅值，并也将其命名为 $V_{1}$。这在基波谐波的幅值和第一个单元的直流电压（$V_{1}$）之间造成了潜在的歧义。根据“将幅值 $V_{1}$ ... 表示为关于 $\\{V_{i}\\}$ 的表达式”这一措辞，很明显要推导的量是基波幅值，而单元电压集合 $\\{V_{i}\\}_{i=1}^{s}$ 是给定参数。我们将基于此理解进行推导，得出问题中指定为 $V_{1}$ 的基波幅值的表达式。\n\n周期为 $2\\pi$ 的函数 $v(\\theta)$ 的傅里叶级数表示为：\n$$v(\\theta) = a_{0} + \\sum_{n=1}^{\\infty} \\left( a_{n} \\cos(n\\theta) + b_{n} \\sin(n\\theta) \\right)$$\n其中系数由欧拉公式定义：\n$$a_{0} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} v(\\theta) \\, d\\theta$$\n$$a_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\cos(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n$$b_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\sin(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n\n问题指出波形 $v(\\theta)$ 具有特定的对称性，可以用来简化这些系数的计算。\n1.  **半波对称性**：$v(\\theta + \\pi) = -v(\\theta)$。该性质意味着波形不含偶次谐波。因此，对于所有偶数 $n$，$a_{n} = 0$ 且 $b_{n} = 0$。此外，直流分量 $a_{0}$ 也为零。对于奇数 $n$，积分可以简化。\n2.  **四分之一波对称性**：问题将其定义为对于 $\\theta \\in [0, \\pi]$ 有 $v(\\pi - \\theta) = v(\\theta)$，这意味着波形在前半个周期内关于 $\\theta = \\frac{\\pi}{2}$ 对称。这一点与半波对称性相结合，意味着波形是奇函数，即 $v(-\\theta) = -v(\\theta)$。对于一个奇函数，乘积 $v(\\theta)\\cos(n\\theta)$ 是奇函数，其在像 $[-\\pi, \\pi]$ 这样的对称区间上的积分为零。因此，所有余弦系数均为零：\n$$a_{n} = 0 \\quad \\text{for all } n \\ge 0$$\n对于正弦系数 $b_{n}$，被积函数 $v(\\theta)\\sin(n\\theta)$ 是一个偶函数，这简化了其积分。半波和四分之一波对称性的组合使得整个周期上的积分可以表示为第一个四分之一周期上积分的四倍：\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} v(\\theta) \\sin(n\\theta) \\, d\\theta$$\n此表达式仅对奇数 $n$ 有效，因为对于偶数 $n$，$b_n = 0$。\n\n接下来，我们必须利用 $v(\\theta)$ 在第一象限 $\\theta \\in [0, \\frac{\\pi}{2}]$ 的指定结构来计算这个积分。电压波形是一个阶梯函数，可以表示为在每个开关角 $\\alpha_{i}$ 处的一系列上升跃变之和。一个方便的表示方法是使用亥维赛阶跃函数 $H(\\theta)$，其中当 $\\theta \\ge 0$ 时 $H(\\theta) = 1$，当 $\\theta  0$ 时 $H(\\theta) = 0$。电压电平在角度 $\\alpha_{i}$ 处增加 $V_{i}$。因此，对于 $\\theta \\in [0, \\frac{\\pi}{2}]$，波形可以写为：\n$$v(\\theta) = \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i})$$\n将此代入 $b_{n}$ 的表达式中：\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} \\left( \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i}) \\right) \\sin(n\\theta) \\, d\\theta$$\n由于和是有限的，我们可以交换求和与积分的顺序：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{0}^{\\pi/2} H(\\theta - \\alpha_{i}) \\sin(n\\theta) \\, d\\theta$$\n亥维赛函数 $H(\\theta - \\alpha_{i})$ 在 $\\theta  \\alpha_{i}$ 时为零，在 $\\theta \\ge \\alpha_{i}$ 时为一。这使得每个积分的下限从 $0$ 变为 $\\alpha_{i}$：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta$$\n现在我们进行积分：\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\left[ -\\frac{1}{n} \\cos(n\\theta) \\right]_{\\alpha_{i}}^{\\pi/2} = -\\frac{1}{n} \\cos\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{n} \\cos(n\\alpha_{i})$$\n如前所述，这个 $b_n$ 的表达式仅在 $n$ 为奇数时非零。对于任何奇数 $n$，$\\cos(\\frac{n\\pi}{2}) = 0$。因此，积分简化为：\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\frac{1}{n} \\cos(n\\alpha_{i})$$\n将此结果代回 $b_{n}$ 的表达式中：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\left( \\frac{1}{n} \\cos(n\\alpha_{i}) \\right)$$\n这可以重写为：\n$$b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$$\n\n总结傅里叶系数：\n- 对于所有 $n \\ge 0$，$a_{n} = 0$。\n- 对于所有偶数 $n$，$b_{n} = 0$。\n- 对于所有奇数 $n$，$b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$。\n\n最后一步是求基波分量的幅值。基波分量是傅里叶级数中对应于 $n=1$ 的项。其幅值由系数 $b_{1}$ 给出。根据问题的符号表示，该幅值记为 $V_{1}$。在我们的 $b_{n}$ 推导表达式中令 $n=1$：\n$$V_{1} \\equiv b_{1} = \\frac{4}{1 \\cdot \\pi} \\sum_{i=1}^{s} V_{i} \\cos(1 \\cdot \\alpha_{i})$$\n$$V_{1} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})$$\n这就是基波谐波幅值关于直流电压电平 $\\{V_i\\}$ 和开关角 $\\{\\alpha_i\\}$ 的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})}$$"
        },
        {
            "introduction": "在理想的SHE理论与实际的数字控制系统之间存在着差距，其中一个关键因素是数字计时器有限的分辨率。本练习将数字控制器引入的定时量化误差建模为一个随机变量，从而将SHE与随机脉宽调制（RPWM）的概念联系起来。通过这个练习，你将学会如何分析开关时刻的微小随机扰动对谐波性能的影响，从而掌握一阶误差分析和统计方法的应用，并深入了解RPWM所特有的频谱扩展效应。",
            "id": "3876969",
            "problem": "一个单相两电平全桥逆变器通过在电平 $+V_{\\mathrm{dc}}$ 和 $-V_{\\mathrm{dc}}$ 之间切换，产生一个四分之一波和半波对称的输出电压波形。在电角度 $\\theta \\in [0,\\pi/2]$ 的第一象限内，存在 $N$ 个单调递增的开关角 $0  \\alpha_{1}  \\alpha_{2}  \\cdots  \\alpha_{N}  \\pi/2$，通过四分之一波对称性生成 $[0,2\\pi)$ 范围内的剩余波形。基波电周期为 $T$，基波角频率为 $\\omega_{0}=2\\pi/T$。在理想情况下，每个四分之一波内的开关时刻发生在预定时间 $t_{k}^{\\star}=\\alpha_{k}/\\omega_{0}$，其中 $k=1,\\dots,N$。\n\n该逆变器使用一个分辨率有限（$\\Delta t>0$）的数字计时器实现。每个预定的开关时间被量化到最近的计时器滴答点，即 $t_{k}=\\mathrm{round}(t_{k}^{\\star}/\\Delta t)\\,\\Delta t$。定义由此产生的量化时间误差为 $\\varepsilon_{k}=t_{k}-t_{k}^{\\star}$，相应的角度误差为 $\\delta\\alpha_{k}=\\omega_{0}\\varepsilon_{k}$。假设采用一种与随机脉冲宽度调制（随机PWM）一致的抖动方案，使得量化误差 $\\{\\varepsilon_{k}\\}_{k=1}^{N}$ 独立同分布，服从区间 $[-\\Delta t/2,\\Delta t/2]$ 上的均匀分布。\n\n设 $\\mathcal{H}=\\{h_{1},\\dots,h_{K}\\}$ 是一个有限的目标奇次谐波次数集合，在理想（未量化）情况下，这些谐波通过特定谐波消除（SHE）技术被消除。设 $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$ 表示包含基波（$m=1$）和目标谐波的集合。对于奇数 $m$，线-中性点电压谐波幅值 $V_{m}$ 由一个周期内分段常数波形的标准傅里叶级数积分表达式定义。\n\n仅从傅里叶级数定义出发，针对每个 $m\\in\\mathcal{S}$，推导一个关于小角度误差 $\\{\\delta\\alpha_{k}\\}$ 的一阶线性化表达式，用于表示由时间量化引起的幅值误差 $\\Delta V_{m}$。然后，使用所述的量化误差概率模型，计算这些幅值误差在集合 $\\mathcal{S}$ 上的平方和的期望值\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right],\n$$\n并将其表示为关于 $V_{\\mathrm{dc}}$、$\\Delta t$、$T$、$N$、角度集合 $\\{\\alpha_{k}\\}_{k=1}^{N}$ 和谐波集合 $\\mathcal{S}$ 的闭式表达式。\n\n将您的最终结果表述为单个解析表达式。所有角度均使用弧度。不要进行数值简化。将最终的类能量物理量以平方伏特为单位表示，但不要在最终答案框中写入单位。",
            "solution": "本问题要求推导在使用特定谐波消除（SHE）技术的单相逆变器中，由时间量化引起的谐波电压幅值误差的平方和的期望值。推导过程将分三步进行：首先，建立开关角与谐波幅值之间的关系；其次，对此关系进行线性化，以找到由开关角微小误差引起的一阶谐波幅值误差；第三，使用给定的时间误差统计模型，计算幅值误差平方和的期望值。\n\n逆变器产生一个四分之一波对称的输出电压波形 $v(t)$。设 $\\theta = \\omega_0 t$ 为电角度，其中 $\\omega_0 = 2\\pi/T$ 是基波角频率。由于四分之一波对称性，整个周期的波形由其在第一象限 $\\theta \\in [0, \\pi/2]$ 内的形状决定。在该象限内，存在 $N$ 个开关角 $0  \\alpha_1  \\alpha_2  \\dots  \\alpha_N  \\pi/2$。电压 $v(\\theta)$ 在 $+V_{\\mathrm{dc}}$ 和 $-V_{\\mathrm{dc}}$ 之间切换。对于 $\\theta \\in [0, \\pi/2]$，电压由下式给出：\n$$\nv(\\theta) = \n\\begin{cases} \n+V_{\\mathrm{dc}}  \\text{for } 0 \\le \\theta  \\alpha_1 \\\\\n-V_{\\mathrm{dc}}  \\text{for } \\alpha_1 \\le \\theta  \\alpha_2 \\\\\n+V_{\\mathrm{dc}}  \\text{for } \\alpha_2 \\le \\theta  \\alpha_3 \\\\\n\\vdots \\\\\n(-1)^k V_{\\mathrm{dc}}  \\text{for } \\alpha_k \\le \\theta  \\alpha_{k+1} \\\\\n\\vdots \\\\\n(-1)^N V_{\\mathrm{dc}}  \\text{for } \\alpha_N \\le \\theta \\le \\pi/2\n\\end{cases}\n$$\n为方便表示，我们可以定义 $\\alpha_0 = 0$ 和 $\\alpha_{N+1} = \\pi/2$。\n\n对于具有四分之一波对称性的波形，其傅里叶级数仅包含奇次谐波正弦项。第 $m$ 次奇次谐波的幅值 $V_m$ 由下式给出：\n$$\nV_m = \\frac{4}{\\pi} \\int_0^{\\pi/2} v(\\theta) \\sin(m\\theta) \\,d\\theta\n$$\n代入 $v(\\theta)$ 的表达式：\n$$\nV_m = \\frac{4}{\\pi} \\left[ \\int_0^{\\alpha_1} V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta + \\sum_{k=1}^{N-1} \\int_{\\alpha_k}^{\\alpha_{k+1}} (-1)^k V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta + \\int_{\\alpha_N}^{\\pi/2} (-1)^N V_{\\mathrm{dc}}\\sin(m\\theta) d\\theta \\right]\n$$\n进行积分，并使用 $\\int \\sin(m\\theta) d\\theta = -\\frac{1}{m}\\cos(m\\theta)$：\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ [-\\cos(m\\theta)]_0^{\\alpha_1} + \\sum_{k=1}^{N-1} (-1)^k [-\\cos(m\\theta)]_{\\alpha_k}^{\\alpha_{k+1}} + (-1)^N [-\\cos(m\\theta)]_{\\alpha_N}^{\\pi/2} \\right]\n$$\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ (1 - \\cos(m\\alpha_1)) + \\sum_{k=1}^{N-1} (-1)^k (\\cos(m\\alpha_k) - \\cos(m\\alpha_{k+1})) + (-1)^N (\\cos(m\\alpha_N) - \\cos(m\\pi/2)) \\right]\n$$\n由于 $m$ 是奇数，$\\cos(m\\pi/2) = 0$。展开求和并合并同类项，我们得到：\n$$\nV_m = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left[ 1 - 2\\cos(m\\alpha_1) + 2\\cos(m\\alpha_2) - \\dots + 2(-1)^N \\cos(m\\alpha_N) \\right]\n$$\n这可以紧凑地写为：\n$$\nV_m(\\alpha_1, \\dots, \\alpha_N) = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{k=1}^N (-1)^k \\cos(m\\alpha_k) \\right)\n$$\n此方程将谐波幅值定义为开关角的函数。\n\n接下来，我们求解由开关角 $\\alpha_k$ 的微小扰动 $\\delta\\alpha_k$ 引起的 $V_m$ 的一阶变化。总误差 $\\Delta V_m$ 可由一阶泰勒展开近似：\n$$\n\\Delta V_m \\approx \\sum_{k=1}^N \\frac{\\partial V_m}{\\partial \\alpha_k} \\delta\\alpha_k\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{\\partial}{\\partial \\alpha_k} \\left[ \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{j=1}^N (-1)^j \\cos(m\\alpha_j) \\right) \\right]\n$$\n导数仅作用于求和中的 $j=k$ 项：\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 2(-1)^k [-m\\sin(m\\alpha_k)] \\right) = \\frac{8V_{\\mathrm{dc}}}{\\pi} (-1)^{k+1} \\sin(m\\alpha_k)\n$$\n因此，幅值误差的线性化表达式为：\n$$\n\\Delta V_m = \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k\n$$\n角度误差 $\\delta\\alpha_k$ 与时间量化误差 $\\varepsilon_k$ 的关系为 $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$。\n\n现在，我们计算这些幅值误差的平方和的期望值 $\\mathbb{E}\\left[\\sum_{m\\in\\mathcal{S}}(\\Delta V_m)^2\\right]$。我们先计算 $(\\Delta V_m)^2$ 的期望值。\n$$\n(\\Delta V_m)^2 = \\left( \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k \\right)^2\n$$\n$$\n(\\Delta V_m)^2 = \\left(\\frac{8V_{\\mathrm{dc}}}{\\pi}\\right)^2 \\left( \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k \\right) \\left( \\sum_{j=1}^N (-1)^{j+1} \\sin(m\\alpha_j) \\delta\\alpha_j \\right)\n$$\n$$\n(\\Delta V_m)^2 = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\delta\\alpha_k \\delta\\alpha_j\n$$\n取期望，并利用期望的线性性质：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j]\n$$\n时间误差 $\\varepsilon_k$ 是服从均匀分布 $U[-\\Delta t/2, \\Delta t/2]$ 的独立同分布 (i.i.d.) 随机变量。因此，角度误差 $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$ 也是独立同分布的随机变量，服从区间 $[-\\omega_0\\Delta t/2, \\omega_0\\Delta t/2]$ 上的均匀分布。\n该分布的均值为 $\\mathbb{E}[\\delta\\alpha_k] = 0$。方差为 $\\mathrm{Var}(\\delta\\alpha_k) = \\mathbb{E}[(\\delta\\alpha_k)^2] - (\\mathbb{E}[\\delta\\alpha_k])^2 = \\mathbb{E}[(\\delta\\alpha_k)^2]$。对于均匀分布 $U[-a, a]$，方差为 $a^2/3$。此处，$a = \\omega_0\\Delta t/2$，所以：\n$$\n\\mathbb{E}[(\\delta\\alpha_k)^2] = \\frac{(\\omega_0\\Delta t/2)^2}{3} = \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\n由于误差是独立的，对于 $k \\ne j$，有 $\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\mathbb{E}[\\delta\\alpha_k]\\mathbb{E}[\\delta\\alpha_j]=0$。因此：\n$$\n\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\delta_{kj} \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\n其中 $\\delta_{kj}$ 是克罗内克δ函数。将此代入 $\\mathbb{E}[(\\Delta V_m)^2]$ 的表达式中，双重求和简化为单重求和（当 $j=k$ 时）：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N (-1)^{2k} \\sin^2(m\\alpha_k) \\left(\\frac{\\omega_0^2 (\\Delta t)^2}{12}\\right)\n$$\n由于 $(-1)^{2k}=1$，上式简化为：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\frac{64V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{12\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\n最后，我们通过对集合 $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$ 中的所有谐波 $m$ 求和来计算所求的量。\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\sum_{m\\in\\mathcal{S}} \\mathbb{E}[(\\Delta V_m)^2] = \\sum_{m\\in\\mathcal{S}} \\left( \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) \\right)\n$$\n常数因子可以从关于 $m$ 的求和中提出：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{m\\in\\mathcal{S}} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\n我们可以交换有限求和的顺序：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n问题要求结果用 $T$ 而不是 $\\omega_0$ 来表示。代入 $\\omega_0 = 2\\pi/T$：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 (4\\pi^2/T^2) (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{64V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3T^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n这是最终的闭式表达式。它取决于指定的参数 $V_{\\mathrm{dc}}$、$\\Delta t$、$T$、$N$、$\\{\\alpha_k\\}_{k=1}^N$ 和 $\\mathcal{S}$。",
            "answer": "$$\n\\boxed{\\frac{64 V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3 T^2} \\sum_{k=1}^{N} \\sum_{m \\in \\mathcal{S}} \\sin^2(m\\alpha_k)}\n$$"
        },
        {
            "introduction": "在分析了随机误差的影响之后，一个自然而然的问题是：我们能否主动补偿这些误差，而不仅仅是评估其后果？这个高级练习将指导你设计一个闭环反馈控制器，该控制器逐周期地调整开关角度，以在存在随机抖动的情况下精确维持期望的基波电压幅值。通过推导反馈增益的稳定性条件，你将探索一种提高随机调制方案性能和鲁棒性的精密方法，展示如何主动管理而非被动容忍非理想效应，从而将电力电子、RPWM与控制理论融会贯通。",
            "id": "3877004",
            "problem": "考虑一个单相两电平全桥逆变器，其直流母线电压为 $V_{\\mathrm{dc}}$，在基波角频率 $\\omega_{0}$ 下产生一个具有半波对称性的双极性输出电压 $v(t) \\in \\{+V_{\\mathrm{dc}}, -V_{\\mathrm{dc}}\\}$。在每个正半周期内，定义电角度 $\\theta = \\omega_{0} t \\in [0, \\pi]$，并让波形在第 $n$ 个周期内的内部边沿角 $\\{\\theta_{j,n}\\}_{j=1}^{K-1}$ 处切换符号，固定端点为 $\\theta_{0} = 0$ 和 $\\theta_{K} = \\pi$。符号序列是交替的，在 $[0,\\theta_{1,n})$ 上以 $+V_{\\mathrm{dc}}$ 开始，因此对于区间 $[\\theta_{k-1,n}, \\theta_{k,n})$，$s_{k} = (-1)^{k-1}$，其中 $k=1,\\dots,K$。这些角度由一个约束随机脉宽调制（RPWM）规则生成，\n$$\n\\theta_{j,n} = \\theta_{j}^{0} + r_{j,n} + c_{n}, \\quad j=1,\\dots,K-1,\n$$\n其中 $\\{\\theta_{j}^{0}\\}_{j=1}^{K-1}$ 是满足 $0  \\theta_{1}^{0}  \\cdots  \\theta_{K-1}^{0}  \\pi$ 的标称角度，随机抖动 $\\{r_{j,n}\\}$ 是独立的、零均值的，并且足够小以保持单调顺序和角度约束 $0  \\theta_{j,n}  \\pi$，$c_{n}$ 是一个同样应用于所有内部边沿的标量周期级校正。约束 $|r_{j,n}| + |c_{n}|$ 严格小于最小标称间距 $\\min_{j}(\\theta_{j+1}^{0}-\\theta_{j}^{0})$，以确保没有边沿交叉。\n\n将基波正弦系数通过半周期上的同步检测定义为\n$$\nb_{1,n} = \\frac{2}{\\pi} \\int_{0}^{\\pi} v(\\theta,n) \\sin(\\theta)\\, \\mathrm{d}\\theta,\n$$\n以及逐周期误差\n$$\ne_{n} = V_{1}^{\\star} - b_{1,n},\n$$\n其中 $V_{1}^{\\star}$ 是期望的基波幅值目标。假设标称角度 $\\{\\theta_{j}^{0}\\}$ 的选择使得在没有抖动和校正的情况下，目标被精确满足，即 $b_{1}(\\{\\theta_{j}^{0}\\}) = V_{1}^{\\star}$。为了在存在 RPWM 抖动的情况下保持精确的基波幅值，考虑一个逐周期反馈校正律\n$$\nc_{n} = k\\, e_{n-1},\n$$\n其中增益 $k \\in \\mathbb{R}$。\n\n从傅里叶定义出发，通过围绕标称角度进行一阶线性化，为随机边沿扰动 $\\{r_{j,n}\\}$ 和标量校正 $c_{n}$ 对 $b_{1,n}$ 的小信号效应建模，并推导离散时间误差更新 $e_{n}$ 作为 $e_{n-1}$ 和 $\\{r_{j,n}\\}$ 的函数。使用此模型，确定保证在关于抖动的所述假设下误差动态均方稳定性的反馈增益 $k$ 的最大幅值的精确解析表达式。用 $V_{\\mathrm{dc}}$、标称角度 $\\{\\theta_{j}^{0}\\}$ 和符号 $\\{s_{j}\\}$ 符号化地表示您的最终答案，并假设角度以弧度为单位。不需要进行数值舍入。",
            "solution": "逆变器在一个正半周期内的输出是一个分段常数波形 $v(\\theta,n) = V_{\\mathrm{dc}}\\, s(\\theta,n)$，其中 $s(\\theta,n) \\in \\{+1,-1\\}$ 在内部角度 $\\{\\theta_{j,n}\\}_{j=1}^{K-1}$ 处切换符号，固定端点为 $\\theta_{0} = 0$ 和 $\\theta_{K} = \\pi$。符号序列从正开始交替，因此对于区间 $[\\theta_{k-1,n}, \\theta_{k,n})$，$s_{k} = (-1)^{k-1}$，其中 $k=1,\\dots,K$。\n\n半周期上的基波正弦系数由傅里叶积分定义\n$$\nb_{1,n} = \\frac{2}{\\pi} \\int_{0}^{\\pi} v(\\theta,n) \\sin(\\theta)\\, \\mathrm{d}\\theta = \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\int_{0}^{\\pi} s(\\theta,n)\\, \\sin(\\theta)\\, \\mathrm{d}\\theta.\n$$\n由于 $s(\\theta,n)$ 是分段常数，该积分在各区间上分解为：\n$$\nb_{1,n} = \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^{K} s_{k} \\int_{\\theta_{k-1,n}}^{\\theta_{k,n}} \\sin(\\theta)\\, \\mathrm{d}\\theta = \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^{K} s_{k} \\left[ -\\cos(\\theta) \\right]_{\\theta_{k-1,n}}^{\\theta_{k,n}}.\n$$\n计算边界值可得\n$$\nb_{1,n} = \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^{K} s_{k} \\left( \\cos(\\theta_{k-1,n}) - \\cos(\\theta_{k,n}) \\right).\n$$\n为了获得 $b_{1,n}$ 对单个内部边沿 $\\theta_{j,n}$ 扰动的小信号灵敏度，我们将 $b_{1,n}$ 对 $\\theta_{j,n}$ 求导，注意到 $\\theta_{j,n}$ 出现在两个相邻的区间项中：对于 $k=j$ 作为上限，对于 $k=j+1$ 作为下限。其偏导数为\n\\begin{align*}\n\\frac{\\partial b_{1,n}}{\\partial \\theta_{j,n}} = \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\left[ s_{j} \\frac{\\partial}{\\partial \\theta_{j,n}} \\left( \\cos(\\theta_{j-1,n}) - \\cos(\\theta_{j,n}) \\right) + s_{j+1} \\frac{\\partial}{\\partial \\theta_{j,n}} \\left( \\cos(\\theta_{j,n}) - \\cos(\\theta_{j+1,n}) \\right) \\right] \\\\\n= \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\left[ s_{j} \\left( 0 - \\left( -\\sin(\\theta_{j,n}) \\right) \\right) + s_{j+1} \\left( -\\sin(\\theta_{j,n}) - 0 \\right) \\right] \\\\\n= \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\left[ s_{j} \\sin(\\theta_{j,n}) - s_{j+1} \\sin(\\theta_{j,n}) \\right] \\\\\n= \\frac{2 V_{\\mathrm{dc}}}{\\pi} \\left( s_{j} - s_{j+1} \\right) \\sin(\\theta_{j,n}).\n\\end{align*}\n对于交替符号序列 $s_{j+1} = - s_{j}$，我们有 $s_{j} - s_{j+1} = 2 s_{j}$，因此灵敏度简化为\n$$\n\\frac{\\partial b_{1,n}}{\\partial \\theta_{j,n}} = \\frac{4 V_{\\mathrm{dc}}}{\\pi} s_{j} \\sin(\\theta_{j,n}).\n$$\n将 $b_{1,n}$ 在标称角度 $\\{\\theta_{j}^{0}\\}$ 附近进行线性化，并将第 $n$ 个周期内的内部边沿写作 $\\theta_{j,n} = \\theta_{j}^{0} + r_{j,n} + c_{n}$，我们得到一阶近似\n\\begin{align*}\nb_{1,n} \\approx b_{1}(\\{\\theta_{j}^{0}\\}) + \\sum_{j=1}^{K-1} \\left. \\frac{\\partial b_{1,n}}{\\partial \\theta_{j,n}} \\right|_{\\theta_{j,n} = \\theta_{j}^{0}} \\left( r_{j,n} + c_{n} \\right) \\\\\n= b_{1}(\\{\\theta_{j}^{0}\\}) + \\sum_{j=1}^{K-1} w_{j} \\, r_{j,n} + \\left( \\sum_{j=1}^{K-1} w_{j} \\right) c_{n},\n\\end{align*}\n其中我们定义了权重\n$$\nw_{j} \\triangleq \\left. \\frac{\\partial b_{1,n}}{\\partial \\theta_{j,n}} \\right|_{\\theta_{j,n} = \\theta_{j}^{0}} = \\frac{4 V_{\\mathrm{dc}}}{\\pi} s_{j} \\sin(\\theta_{j}^{0}),\n$$\n及它们的和\n$$\nS \\triangleq \\sum_{j=1}^{K-1} w_{j} = \\frac{4 V_{\\mathrm{dc}}}{\\pi} \\sum_{j=1}^{K-1} s_{j} \\sin(\\theta_{j}^{0}).\n$$\n根据设计，标称角度满足 $b_{1}(\\{\\theta_{j}^{0}\\}) = V_{1}^{\\star}$，所以周期误差为\n\\begin{align*}\ne_{n} = V_{1}^{\\star} - b_{1,n} \\\\\n\\approx V_{1}^{\\star} - \\left( V_{1}^{\\star} + \\sum_{j=1}^{K-1} w_{j} \\, r_{j,n} + S c_{n} \\right) \\\\\n= - \\sum_{j=1}^{K-1} w_{j} \\, r_{j,n} - S c_{n}.\n\\end{align*}\n使用反馈律 $c_{n} = k\\, e_{n-1}$，误差动态变为\n$$\ne_{n} = - S k\\, e_{n-1} - \\sum_{j=1}^{K-1} w_{j} \\, r_{j,n}.\n$$\n这是一个由加性零均值噪声驱动的一阶自回归过程，齐次增益为 $a = - S k$。在所述假设（独立的、零均值的抖动以及保持约束的有界幅值）下，$e_{n}$ 的均值和二阶矩收敛当且仅当 $|a|  1$。具体来说，均值服从 $\\mathbb{E}[e_{n}] = a\\, \\mathbb{E}[e_{n-1}]$，当 $|a|1$ 时是渐近稳定的，并且方差满足标准的自回归方差递推，在 $|a|1$ 时有有限的稳态解。因此，对于幅值满足\n$$\n|S k|  1\n$$\n的增益 $k$，均方稳定性得到保证。\n允许的增益幅值的上确界（在稳定边界上的最大幅值）因此是\n$$\n|k|_{\\max} = \\frac{1}{|S|} = \\frac{1}{\\left| \\frac{4 V_{\\mathrm{dc}}}{\\pi} \\sum_{j=1}^{K-1} s_{j} \\sin(\\theta_{j}^{0}) \\right|} = \\frac{\\pi}{4 V_{\\mathrm{dc}} \\left| \\sum_{j=1}^{K-1} s_{j} \\sin(\\theta_{j}^{0}) \\right| }.\n$$\n此表达式在线性化条件下是精确的，并捕捉了对直流母线电压 $V_{\\mathrm{dc}}$、以弧度为单位的标称开关边沿角 $\\{\\theta_{j}^{0}\\}$ 以及交替符号序列 $\\{s_{j}\\}$ 的依赖关系。",
            "answer": "$$\\boxed{\\frac{\\pi}{4 V_{\\mathrm{dc}} \\left| \\sum_{j=1}^{K-1} s_{j} \\sin(\\theta_{j}^{0}) \\right| }}$$"
        }
    ]
}