## 引言
随着可再生能源渗透率的不断攀升，以[电力](@entry_id:264587)电子逆变器为接口的新能源发电正逐渐重塑[电力](@entry_id:264587)系统的形态。如何确保这些设备与电网的稳定、高效互动，已成为现代[电力](@entry_id:264587)系统的核心挑战。为此，并网跟驰型（Grid-Following, GFL）与并网构网型（Grid-Forming, GFM）控制策略应运而生，它们定义了逆变器在电网中扮演的根本角色。

传统上依赖GFL控制的电网在面临高比例[电力](@entry_id:264587)电子设备接入时，系统惯量降低，稳定性减弱。GFM控制作为一种新兴范式，旨在赋予逆变器主动支撑电网的能力，但这两种技术各自的原理、优势、局限以及如何协同工作，构成了当前研究与工程实践中的一个关键知识领域。

本文旨在系统性地梳理和解析这两种关键控制技术。在“原理与机制”一章中，我们将深入剖析GFL和GFM控制的内部工作原理，从[锁相环](@entry_id:271717)到[虚拟同步机](@entry_id:1133830)，揭示其控制架构的异同。随后的“应用与跨学科关联”一章，将通过微电网运行、弱电网稳定性和无缝切换等实际场景，展示这些理论在解决复杂工程问题中的应用，并探讨其与控制理论、系统工程等领域的深刻联系。最后，“实践练习”部分将提供具体的计算和分析问题，帮助读者将理论知识转化为解决实际问题的能力。

## 原理与机制

本章深入探讨了两种主流的逆变器控制策略——并网跟驰型（Grid-Following, GFL）和并网构网型（Grid-Forming, GFM）控制的核心原理与实现机制。我们将从基本定义出发，逐步解析各自的控制架构、关键技术（如锁相环、[下垂控制](@entry_id:1123995)和[虚拟同步机](@entry_id:1133830)）以及它们在实际应用中的动态行为和稳定性考量。

### 基本范式分野：跟驰型与构网型控制

[电力](@entry_id:264587)电子逆变器在电网中的角色由其控制策略决定，这基本上可以分为两大类：作为受控[电流源](@entry_id:275668)的并网跟驰型（GFL）和作为受控电压源的并网构网型（GFM）。

**并网跟驰型（GFL）控制**，顾名思义，其核心任务是“跟随”一个已经存在且稳定的电网。它将电网视为一个近乎理想的电压源，其自身的控制目标是向该电网注入精确控制的有功和无功功率。在这种模式下，逆变器在行为上类似于一个**受控[电流源](@entry_id:275668)**，它不负责建立或维持电网的电压或频率，而是严格同步于外部电网的相位。实现这种同步的关键部件是**锁相环（Phase-Locked Loop, PLL）**。

**并网构网型（GFM）控制** 则扮演着更为主动的角色。它旨在“构建”或“形成”电网，能够自主地建立并维持一个稳定的电压幅值和频率。因此，它在行为上更像一个**受控电压源**，类似于传统的同步[发电机](@entry_id:268282)。这种控制策略不依赖于外部电网的相位参考，而是通过内部振荡器或更复杂的模型（如[虚拟同步机](@entry_id:1133830)）来产生自己的频率和[电压基准](@entry_id:269978)。

这两种策略之间的根本区别决定了它们的适用场景。一个关键的差异在于对孤岛运行的支持。如果上游主电网发生故障，纯粹的GFL逆变器将因其PLL失去相位参考而无法继续运行。相比之下，GFM逆变器由于其自主产生电压和频率的能力，可以无缝地维持[孤岛微电网](@entry_id:1126755)的稳定运行，为关键负载供电 。

### 并网跟驰型控制机制

GFL控制的精确性和稳定性依赖于一个精心设计的控制架构，其核心是[同步参考坐标系](@entry_id:1132784)（Synchronous Reference Frame, SRF）和锁相环。

#### [同步参考坐标系](@entry_id:1132784)与锁相环（PLL）

为了有效控制交流系统中的有功和无功功率，现代控制理论广泛采用基于[Park变换](@entry_id:1129357)的[同步参考坐标系](@entry_id:1132784)。该坐标系以电网的角频率$\omega$同步旋转，将三相时变的交流量（如电压$v_{abc}$和电流$i_{abc}$）变换为两个近似恒定的直流量（$d$轴和$q$轴分量）。这种变换极大地简化了控制器的设计。

GFL逆变器的“大脑”和“耳朵”是**[锁相环](@entry_id:271717)（PLL）**。PLL的功能是实时、准确地估计电网电压的相位角$\theta$，从而确保逆变器的$d-q$坐标系与电网电压矢量精确对齐。一种常见的策略是将$d$轴与电网电压矢量对齐。在这种情况下，电网电压在$d-q$坐标系下的分量近似为$v_d \approx V$（电网电压幅值）和$v_q \approx 0$。$q$轴分量$v_q$因此成为一个理想的误差信号，用于驱动一个PI（比例-积分）控制器。该控制器的[输出调节](@entry_id:166395)一个[压控振荡器](@entry_id:265947)（VCO），最终生成与电网电压[相位锁定](@entry_id:275213)的估计角度$\hat{\theta}$ 。

从控制理论的角度看，PLL本身是一个闭环反馈系统。其动态特性可以通过[小信号模型](@entry_id:270703)来分析。在$v_q$作为相位误差输入的线性化模型中，从[相位误差](@entry_id:162993)输入$\Theta_e(s)$到估计角度输出$\hat{\Theta}(s)$的[开环传递函数](@entry_id:276280)可以表示为：
$$ \frac{\hat{\Theta}(s)}{\Theta_e(s)} = \frac{V(sK_{p} + K_{i})}{s^2} $$
其中，$V$是电网电压幅值，$K_p$和$K_i$分别是PLL[环路滤波器](@entry_id:275178)的比例和[积分增益](@entry_id:274567) 。这个二阶积分特性表明PLL在[稳态](@entry_id:139253)下能够无差地跟踪相位，但也揭示了其动态响应和稳定性对参数整定的敏感性。

#### 级联功率与电流控制

典型的GFL控制采用级联结构，由外环的功率控制器和内环的电流控制器组成。

**外环功率控制**：外环的目标是使逆变器输出的有功功率$P$和无功功率$Q$跟踪其参考值$P^*$和$Q^*$。在$d$轴与电网电压对齐的[同步参考坐标系](@entry_id:1132784)中，有功和无功功率的瞬时表达式（采用功率不变形式的[Park变换](@entry_id:1129357)）为：
$$ P = \frac{3}{2}(v_d i_d + v_q i_q) $$
$$ Q = \frac{3}{2}(v_q i_d - v_d i_q) $$
由于PLL的作用使得$v_q \approx 0$且$v_d \approx V$，上述表达式简化为：
$$ P \approx \frac{3}{2} v_d i_d $$
$$ Q \approx -\frac{3}{2} v_d i_q $$
这一结果揭示了**[解耦](@entry_id:160890)功率控制**的原理：有功功率$P$主要由直轴电流$i_d$控制，而无功功率$Q$主要由交轴电流$i_q$控制。因此，外环功率控制器（通常是[PI控制器](@entry_id:268031)）根据功率误差$(P^* - P)$和$(Q^* - Q)$，通过反转上述关系来生成内环所需的电流参考值$i_d^*$和$i_q^*$ ：
$$ i_d^* = \frac{2}{3} \frac{P^*}{v_d} $$
$$ i_q^* = -\frac{2}{3} \frac{Q^*}{v_d} $$

**内环电流控制**：内环是快速响应的电流调节环。它的任务是迫使逆变器实际输出的电流$i_d$和$i_q$精确跟踪由外环给出的参考值$i_d^*$和$i_q^*$。[内环控制](@entry_id:272115)器（同样通常是[PI控制器](@entry_id:268031)）的输出是逆变器所需的$d-q$轴电压$v_d^{\text{inv}}$和$v_q^{\text{inv}}$，这些电压指令最终通过[脉冲宽度调制](@entry_id:262667)（PWM）技术合成到逆变器的交流输出端。

#### GFL控制的局限性：弱电网问题

GFL控制的有效性高度依赖于一个“坚强”的电网，即电网的等效阻抗很低。电网的强度通常用**短路比（Short-Circuit Ratio, SCR）**来量化，定义为并网点（PCC）的三相短路[视在功率](@entry_id:1121069)$S_{sc}$与逆变器额定视在功率$S_{conv}$之比：
$$ \text{SCR} = \frac{S_{sc}}{S_{conv}} = \frac{V_{ll}^2 / |Z_{th}|}{S_{conv}} $$
其中，$V_{ll}$是PCC处的线电压，$Z_{th}$是电网的[戴维南等效](@entry_id:263814)阻抗。低SCR值（通常小于3）意味着“弱电网”。

在弱电网中，$Z_{th}$较大，PCC处的电压$V_{pcc}$不再是稳定的参考，而是会显著地受到逆变器自身注入电流$I_{conv}$的影响（$V_{pcc} = V_{th} - Z_{th} I_{conv}$）。这种情况下，PLL的输入（$V_{pcc}$）与电流环的输出（$I_{conv}$）之间形成了一个有害的耦合。这种耦合会恶化控制系统的稳定性，尤其是在PLL和[电流环路](@entry_id:271292)带宽设计得较高时，可能导致低频振荡。为了在弱电网中保持稳定，通常需要采取降低控制器带宽的策略，特别是降低PLL的带宽，使其远低于电流环的带宽，以实现[动态解耦](@entry_id:139567) 。

### 并网构网型控制机制

与GFL不同，GFM控制不依赖外部同步信号，而是主动建立电压，其控制原理根植于同步[发电机](@entry_id:268282)的物理特性。

#### 功率-相角关系：物理基础

在任何交流[电力](@entry_id:264587)系统中，两点之间通过[电抗](@entry_id:275161)性线路传输的有功功率主要由这两点之间的电压**相角差**决定。考虑一个GFM逆变器，其内部生成的[电动势](@entry_id:203175)有效值（RMS）为$E$，相角为$\delta$，通过一个等效串联[电抗](@entry_id:275161)$X$连接到电压为$V$，相角为$0$的电网母线上。从基本的[相量](@entry_id:270266)和[复功率](@entry_id:1122734)定义出发，可以推导出从逆变器流向电网的单相有功功率$P$为：
$$ P = \frac{EV}{X}\sin\delta $$
这个经典的**功率-相角关系**是GFM控制的核心物理基础 。它表明，通过控制逆变器内部电压的相角$\delta$，就可以直接控制其有功功率的输出。由于频率$\omega$是相角的[微分](@entry_id:158422)（$\omega = d\delta/dt$），因此，控制频率就等同于控制有功功率。

#### [下垂控制](@entry_id:1123995)实现功率均分

当多个GFM逆变器并联运行时，为了实现自主、无通信的负载功率均分，最经典的方法是**下垂控制（Droop Control）**。

**有功-频率（P-f）下垂**：该控制律模仿了传统同步[发电机](@entry_id:268282)“越出力，转速越慢”的特性，规定逆变器的输出频率$\omega$随其输出有功功率$P$的增加而线性下降：
$$ \omega = \omega_0 - m_p (P - P_0) $$
其中，$\omega_0$是在功率[设定点](@entry_id:154422)$P_0$时的额定频率，$m_p > 0$是下垂系数。这个负斜率对于系统稳定至关重要。当多个逆变器连接到同一个母线时，它们在[稳态](@entry_id:139253)下必须以相同的频率运行。这个共同的频率点由总负载和所有逆变器的下垂曲线共同决定，从而实现了按各自下垂系数比例的自动有功[功率分配](@entry_id:275562)  。

**无功-电压（Q-V）下垂**：类似地，对于以电感为主的线路，无功功率主要由电压幅值差决定。因此，可以通过实施无功-[电压下垂](@entry_id:263648)来实现无功功率的均分。该控制律规定逆变器输出电压的幅值$V$随其输出的无功功率$Q$的增加而下降：
$$ V = V_0 - n_q (Q - Q_0) $$
其中，$V_0$是额定电压，$n_q > 0$是无功下垂系数。所有并联单元共享同一个母线电压，这迫使它们根据各自的Q-V下垂曲线来分配总的无功负载 。

### 高级构网型控制：[虚拟同步机](@entry_id:1133830)（VSM）

简单的[下垂控制](@entry_id:1123995)主要模拟了同步[发电机](@entry_id:268282)的[稳态](@entry_id:139253)特性。**[虚拟同步机](@entry_id:1133830)（Virtual Synchronous Machine, VSM）**控制则更进一步，不仅模拟[稳态](@entry_id:139253)下垂，还通过在控制算法中嵌入同步[发电机](@entry_id:268282)的**[摇摆方程](@entry_id:1132722)（Swing Equation）**，来模拟其动态[惯性响应](@entry_id:1126482)。

#### 模拟惯性与阻尼

同步[发电机](@entry_id:268282)的[摇摆方程](@entry_id:1132722)描述了其转子机械功率$P_m$和电磁功率$P_e$之间的不平衡如何导致其[角频率](@entry_id:261565)$\omega$的改变：
$$ M \frac{d\omega}{dt} + D(\omega - \omega_0) = P_m - P_e $$
其中，$M$是惯性常数（与转子动能相关），$D$是[阻尼系数](@entry_id:163719)。VSM控制在软件中实现了这个[微分](@entry_id:158422)方程。通过实时测量逆变器的输出电功率$P_e$，并将其与功率给定值$P_m$（等效于机械功率）进行比较，VSM算法计算出频率的变化率$\dot{\omega}$，并积分得到频率$\omega$和相角$\theta$。

- **[虚拟惯性](@entry_id:1132798)（$M$）**：使逆变器能够像一个具有巨大旋转质量的同步[发电机](@entry_id:268282)一样，通过释放或吸收能量来抵抗电网频率的快速变化（即提供[惯性响应](@entry_id:1126482)）。
- **阻尼（$D$）**：在[稳态](@entry_id:139253)时（$\dot{\omega}=0$），[摇摆方程](@entry_id:1132722)简化为$\omega = \omega_0 - \frac{1}{D}(P_e - P_m)$。这与P-f[下垂控制](@entry_id:1123995)的表达式形式完全相同，表明[阻尼系数](@entry_id:163719)$D$的倒数就是[稳态](@entry_id:139253)下的下垂系数$m_p$ 。

#### 惯性能量的来源：直流侧储能

[虚拟惯性](@entry_id:1132798)并非凭空产生。逆变器在提供惯性支撑（即短时改变其输出功率）时所需的能量，必须来自其直流侧的储能单元，通常是**直流母线电容器（DC-link capacitor）**。

直流母线电容器的储能$E_c$与其电压$V_{dc}$的关系是$E_c = \frac{1}{2} C V_{dc}^2$。根据能量守恒，[电容器储能](@entry_id:261864)的变化率等于流入功率（来自直流源的$P_{rec}$）与流出功率（输送到交流侧的$P_{ac}$）之差：
$$ \frac{dE_c}{dt} = C V_{dc} \frac{dV_{dc}}{dt} = P_{rec} - P_{ac} $$
这个方程揭示了交直流两侧的动态耦合 。当电网需要惯性支撑（例如，频率下降，逆变器需要增加$P_{ac}$）时，能量将从电容器中提取，导致$V_{dc}$下降。VSM控制器正是通过监测频率变化，调节$P_{ac}$，并利用直流侧电压的允许波动范围来交换能量，从而模拟物理惯性 。例如，一个电容为$0.15\,\mathrm{F}$的直流母线，其电压从$1300\,\mathrm{V}$下降到$1000\,\mathrm{V}$，可以释放$51.75\,\mathrm{kJ}$的能量用于惯性支撑。

### 实际实现与稳定性考量

无论是GFL还是GFM控制，其性能和稳定性都受到硬件（如输出滤波器）和控制参数设计的深刻影响。

#### 输出[滤波器设计](@entry_id:266363)：L vs. LCL

逆变器输出的PWM电压波形包含高频开关谐波，必须通过输出滤波器进行滤除才能向电网注入高质量的正弦电流。常用的滤波器有L型和LCL型。

- **L滤波器**结构简单，由一个串联电感组成。它在高频下提供$-20\,\mathrm{dB}/\text{decade}$的衰减。其控制简单，允许较高的电流环带宽。
- **LCL滤波器**由逆变器侧电感、并联电容和电网侧电感组成。它在高频下能提供$-60\,\mathrm{dB}/\text{decade}$的衰减，因此对开关[谐波](@entry_id:181533)的抑制效果远优于同等总电感的L滤波器。然而，LCL滤波器会引入一个[谐振峰](@entry_id:271281)，这使得电流[控制器设计](@entry_id:274982)变得复杂，并通常限制了可实现的控制带宽，以避免系统在[谐振频率](@entry_id:265742)附近失稳 。

设计者必须在[谐波抑制](@entry_id:1125930)性能和控制复杂性/动态响应之间做出权衡。

#### GFM逆变器的稳定性增强：[虚拟阻抗](@entry_id:1133823)

虽然GFM逆变器在弱电网中比GFL逆变器更为鲁棒，但它们也可能与电网阻抗和其他动态元件（如滤波器电容）相互作用而产生振荡。为了增强稳定性，可以引入**[虚拟阻抗](@entry_id:1133823)**的概念。

[虚拟阻抗](@entry_id:1133823)是一种纯粹在控制软件中实现的技术，通过反馈测量到的输出电流来修改逆变器的电压参考指令，从而使其对外呈现出期望的输出阻抗特性$Z_{\text{conv}}(s)$。通过增加**虚拟电阻（$R_v$）**，可以为系统引入有效的阻尼，从而抑制振荡，提高系统的**[阻尼比](@entry_id:262264)$\zeta$**。通过增加**虚拟电感（$L_v$）**，可以调整系统阻抗比的相频特性，从而提高系统的**相位裕度$\Phi_m$**。

然而，这种稳定性增强是有代价的。增加虚拟电阻虽然能改善阻尼，但也会在逆变器输出电流时产生额外的[稳态](@entry_id:139253)[电压降](@entry_id:263648)（$\Delta V = I R_v$），这会恶化负载下的[电压调节](@entry_id:272092)性能。这体现了在[控制系统设计](@entry_id:273663)中，鲁棒性与性能之间典型的权衡关系 。