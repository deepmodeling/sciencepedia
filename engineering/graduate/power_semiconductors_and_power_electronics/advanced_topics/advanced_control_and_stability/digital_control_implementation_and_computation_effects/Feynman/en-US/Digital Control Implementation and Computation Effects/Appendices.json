{
    "hands_on_practices": [
        {
            "introduction": "Bridging the gap between continuous-time theory and digital implementation begins with discretization. This exercise guides you through the process of converting the continuous-time model of a buck converter into its discrete-time equivalent using the Tustin (or bilinear) transform. By working through this fundamental task (), you will directly confront the non-linear mapping of frequencies known as \"frequency warping\" and quantify its impact, a critical first step in designing high-performance digital controllers.",
            "id": "3833389",
            "problem": "A continuous-conduction-mode buck converter is regulated by a digital voltage loop. The converter parameters are: input voltage $V_{g} = 12\\,\\mathrm{V}$, inductor $L = 100\\,\\mu\\mathrm{H}$, output capacitor $C = 47\\,\\mu\\mathrm{F}$, and resistive load $R = 5\\,\\Omega$. Assume an ideal output capacitor with negligible equivalent series resistance and a high switching frequency such that the standard state-space averaged model is valid for small-signal analysis. The pulse-width modulation (PWM) is synchronized with the sampling of the digital controller at sampling period $T_{s} = 20\\,\\mu\\mathrm{s}$.\n\nStarting from the averaged inductor-capacitor dynamics and small-signal linearization about the steady state, the continuous-time small-signal control-to-output plant $G_{vd}(s)$ for the voltage loop is to be obtained from first principles. Then, using Tustin’s bilinear transform discretization (without prewarping), derive the discrete-time transfer function $G_{vd}(z)$ as a rational function of $z^{-1}$ with real coefficients. Finally, discuss, using first-principles frequency mapping, how bilinear frequency warping affects the loop near a desired continuous-time crossover angular frequency $\\omega_{c} = 10{,}000\\,\\mathrm{rad/s}$ for the given sampling period, and quantify the relative deviation between the desired analog $\\omega_{c}$ and its discrete-time image (express this deviation as a decimal).\n\nExpress your final answer as the single simplified expression for $G_{vd}(z)$ in terms of $z^{-1}$. No rounding is required for the coefficients of $G_{vd}(z)$. Use radians per second for all angular frequencies in your discussion, and do not include any units in your final expression.",
            "solution": "The user wants me to solve a problem in the field of digital control for power electronic systems.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n- **System**: Continuous-conduction-mode (CCM) buck converter.\n- **Regulation**: Digital voltage loop.\n- **Converter Parameters**:\n    - Input voltage: $V_g = 12\\,\\mathrm{V}$\n    - Inductor: $L = 100\\,\\mu\\mathrm{H} = 1 \\times 10^{-4}\\,\\mathrm{H}$\n    - Output capacitor: $C = 47\\,\\mu\\mathrm{F} = 4.7 \\times 10^{-5}\\,\\mathrm{F}$\n    - Resistive load: $R = 5\\,\\Omega$\n- **Assumptions**:\n    - Ideal output capacitor (negligible ESR).\n    - High switching frequency, validating the state-space averaged model for small-signal analysis.\n- **Digital Control Parameters**:\n    - Sampling period: $T_s = 20\\,\\mu\\mathrm{s} = 2 \\times 10^{-5}\\,\\mathrm{s}$\n    - PWM is synchronized with sampling.\n- **Tasks**:\n    1. Derive the continuous-time small-signal control-to-output plant transfer function $G_{vd}(s)$ from first principles.\n    2. Derive the discrete-time transfer function $G_{vd}(z)$ using Tustin’s bilinear transform.\n    3. Discuss frequency warping near $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$ and quantify the relative deviation.\n- **Output Format**:\n    - $G_{vd}(z)$ as a rational function of $z^{-1}$ with real coefficients, no rounding.\n    - Final answer is only the expression for $G_{vd}(z)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria:\n\n- **Scientifically Grounded**: The problem is based on the standard and well-established theory of state-space averaging for DC-DC converters and digital control theory (Tustin's transform, frequency warping). These are fundamental concepts in power electronics and control systems engineering. The model is a standard representation of a buck converter. The parameters are physically realistic. The problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary parameters ($V_g$, $L$, $C$, $R$, $T_s$) to uniquely determine the continuous-time and discrete-time transfer functions. The tasks are clearly defined and lead to a unique solution. The analysis of frequency warping is a standard procedure with a definite outcome.\n- **Objective**: The language is precise and technical. It uses standard terminology from the fields of power electronics and control theory, leaving no room for subjective interpretation.\n- **Completeness**: While the steady-state duty cycle $D$ or output voltage $V_{out}$ are not given, the derivation of the control-to-output transfer function $G_{vd}(s)$ for an ideal buck converter does not depend on these parameters, as the perturbation term is proportional to the constant input voltage $V_g$. Thus, the problem is self-contained.\n- **No other flaws** (unrealistic, ill-posed, trivial, etc.) are present.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. The solution process will proceed.\n\n### **Solution Derivation**\n\nThe solution proceeds in three parts as requested: derivation of the continuous-time plant model, its discretization, and an analysis of frequency warping.\n\n**Part 1: Continuous-Time Small-Signal Model $G_{vd}(s)$**\n\nThe state-space averaged model for a buck converter operating in CCM is given by the dynamics of the inductor current $i_L(t)$ and the capacitor voltage $v_C(t)$. The state vector is $\\mathbf{x}(t) = [i_L(t) \\quad v_C(t)]^T$. The control input is the duty cycle $d(t)$.\n\nThe averaged state equations are:\n$$\nL \\frac{di_L}{dt} = d \\cdot V_g - v_C\n$$\n$$\nC \\frac{dv_C}{dt} = i_L - \\frac{v_C}{R}\n$$\n\nWe linearize these equations around a steady-state operating point, which is defined by setting the time derivatives to zero. Let the steady-state (DC) values be $I_L$, $V_C$, and $D$. The time-varying quantities are expressed as the sum of a DC component and a small AC perturbation (denoted by a hat `^`):\n$i_L(t) = I_L + \\hat{i}_L(t)$\n$v_C(t) = V_C + \\hat{v}_C(t)$\n$d(t) = D + \\hat{d}(t)$\n\nSubstituting these into the state equations and separating DC and AC terms yields the small-signal (AC) model. The DC terms satisfy the steady-state equations:\n$0 = D \\cdot V_g - V_C$\n$0 = I_L - V_C/R$\n\nThe AC model is obtained by retaining only the first-order perturbation terms:\n$$\nL \\frac{d\\hat{i}_L}{dt} = D \\cdot V_g + \\hat{d} \\cdot V_g - (V_C + \\hat{v}_C) \\implies L \\frac{d\\hat{i}_L}{dt} = (D \\cdot V_g - V_C) + \\hat{d} \\cdot V_g - \\hat{v}_C\n$$\nSince $D \\cdot V_g - V_C = 0$ at steady state, this simplifies to:\n$$\nL \\frac{d\\hat{i}_L}{dt} = \\hat{d} \\cdot V_g - \\hat{v}_C\n$$\nFor the second equation:\n$$\nC \\frac{d\\hat{v}_C}{dt} = (I_L + \\hat{i}_L) - \\frac{V_C + \\hat{v}_C}{R} \\implies C \\frac{d\\hat{v}_C}{dt} = (I_L - \\frac{V_C}{R}) + \\hat{i}_L - \\frac{\\hat{v}_C}{R}\n$$\nSince $I_L - V_C/R = 0$ at steady state, this simplifies to:\n$$\nC \\frac{d\\hat{v}_C}{dt} = \\hat{i}_L - \\frac{\\hat{v}_C}{R}\n$$\nTaking the Laplace transform of the AC equations (with zero initial conditions), we get:\n$$\nsL\\hat{i}_L(s) = \\hat{d}(s)V_g - \\hat{v}_C(s) \\quad \\implies \\quad \\hat{i}_L(s) = \\frac{\\hat{d}(s)V_g - \\hat{v}_C(s)}{sL}\n$$\n$$\nsC\\hat{v}_C(s) = \\hat{i}_L(s) - \\frac{\\hat{v}_C(s)}{R}\n$$\nThe control-to-output transfer function is $G_{vd}(s) = \\frac{\\hat{v}_C(s)}{\\hat{d}(s)}$. We substitute the expression for $\\hat{i}_L(s)$ into the second equation:\n$$\nsC\\hat{v}_C(s) = \\frac{\\hat{d}(s)V_g - \\hat{v}_C(s)}{sL} - \\frac{\\hat{v}_C(s)}{R}\n$$\nNow, we group terms with $\\hat{v}_C(s)$ and $\\hat{d}(s)$:\n$$\n\\hat{v}_C(s) \\left( sC + \\frac{1}{sL} + \\frac{1}{R} \\right) = \\hat{d}(s) \\frac{V_g}{sL}\n$$\nMultiplying both sides by $sL$:\n$$\n\\hat{v}_C(s) \\left( s^2LC + 1 + \\frac{sL}{R} \\right) = \\hat{d}(s) V_g\n$$\nThe transfer function is therefore:\n$$\nG_{vd}(s) = \\frac{\\hat{v}_C(s)}{\\hat{d}(s)} = \\frac{V_g}{s^2LC + s\\frac{L}{R} + 1}\n$$\nNow, we substitute the given numerical values:\n$V_g = 12\\,\\mathrm{V}$\n$L = 1 \\times 10^{-4}\\,\\mathrm{H}$\n$C = 4.7 \\times 10^{-5}\\,\\mathrm{F}$\n$R = 5\\,\\Omega$\n\nThe coefficients of the denominator are:\n$LC = (1 \\times 10^{-4}\\,\\mathrm{H}) \\times (4.7 \\times 10^{-5}\\,\\mathrm{F}) = 4.7 \\times 10^{-9}\\,\\mathrm{s^2}$\n$\\frac{L}{R} = \\frac{1 \\times 10^{-4}\\,\\mathrm{H}}{5\\,\\Omega} = 2 \\times 10^{-5}\\,\\mathrm{s}$\n\nSo, the continuous-time transfer function is:\n$$\nG_{vd}(s) = \\frac{12}{4.7 \\times 10^{-9} s^2 + 2 \\times 10^{-5} s + 1}\n$$\n\n**Part 2: Discrete-Time Transfer Function $G_{vd}(z)$**\n\nWe use Tustin's bilinear transform to discretize $G_{vd}(s)$. The transformation is given by:\n$$\ns = \\frac{2}{T_s} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\nGiven $T_s = 2 \\times 10^{-5}\\,\\mathrm{s}$, we have $\\frac{2}{T_s} = \\frac{2}{2 \\times 10^{-5}} = 10^5\\,\\mathrm{s^{-1}}$.\nSo, $s = 10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}$.\n\nLet's substitute this into the expression for $G_{vd}(s)$. For clarity, let $G_{vd}(s) = \\frac{V_g}{A s^2 + B s + 1}$, where $A = LC = 4.7 \\times 10^{-9}$ and $B = L/R = 2 \\times 10^{-5}$.\n$$\nG_{vd}(z) = \\frac{12}{A \\left(10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}\\right)^2 + B \\left(10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}\\right) + 1}\n$$\nTo simplify, we multiply the numerator and denominator by $(1 + z^{-1})^2$:\n$$\nG_{vd}(z) = \\frac{12 (1 + z^{-1})^2}{A (10^5)^2 (1 - z^{-1})^2 + B (10^5) (1 - z^{-1})(1 + z^{-1}) + (1 + z^{-1})^2}\n$$\nLet's evaluate the coefficients in the denominator:\n$A (10^5)^2 = (4.7 \\times 10^{-9}) \\times (10^{10}) = 47$\n$B (10^5) = (2 \\times 10^{-5}) \\times (10^5) = 2$\n\nThe denominator becomes:\n$D(z) = 47(1 - 2z^{-1} + z^{-2}) + 2(1 - z^{-2}) + 1(1 + 2z^{-1} + z^{-2})$\nWe collect terms by powers of $z^{-1}$:\nCoefficient of $z^0$: $47 \\times 1 + 2 \\times 1 + 1 \\times 1 = 47 + 2 + 1 = 50$\nCoefficient of $z^{-1}$: $47 \\times (-2) + 2 \\times 0 + 1 \\times 2 = -94 + 2 = -92$\nCoefficient of $z^{-2}$: $47 \\times 1 + 2 \\times (-1) + 1 \\times 1 = 47 - 2 + 1 = 46$\nSo, the denominator polynomial is $D(z) = 50 - 92z^{-1} + 46z^{-2}$.\n\nThe numerator is:\n$N(z) = 12 (1 + z^{-1})^2 = 12(1 + 2z^{-1} + z^{-2}) = 12 + 24z^{-1} + 12z^{-2}$.\n\nThe discrete-time transfer function is:\n$$\nG_{vd}(z) = \\frac{12 + 24z^{-1} + 12z^{-2}}{50 - 92z^{-1} + 46z^{-2}}\n$$\nTo express this in the standard form with a leading denominator coefficient of $1$, we divide the numerator and denominator by $50$:\n$$\nG_{vd}(z) = \\frac{\\frac{12}{50} + \\frac{24}{50}z^{-1} + \\frac{12}{50}z^{-2}}{1 - \\frac{92}{50}z^{-1} + \\frac{46}{50}z^{-2}}\n$$\nSimplifying the fractions:\n$$\nG_{vd}(z) = \\frac{\\frac{6}{25} + \\frac{12}{25}z^{-1} + \\frac{6}{25}z^{-2}}{1 - \\frac{46}{25}z^{-1} + \\frac{23}{25}z^{-2}}\n$$\nThis is the required expression for $G_{vd}(z)$.\n\n**Part 3: Frequency Warping Analysis**\n\nThe bilinear transform maps the imaginary axis $s=j\\omega_c$ of the continuous-time domain to the unit circle $z=e^{j\\omega_d T_s}$ of the discrete-time domain, where $\\omega_c$ is the continuous-time angular frequency and $\\omega_d$ is the discrete-time angular frequency. The mapping relationship is given by:\n$$\n\\omega_c = \\frac{2}{T_s} \\tan\\left(\\frac{\\omega_d T_s}{2}\\right)\n$$\nThis relationship is non-linear, causing a \"warping\" of the frequency axis. For low frequencies where $\\omega_d T_s / 2 \\ll 1$, we can use the approximation $\\tan(x) \\approx x$, which gives $\\omega_c \\approx \\omega_d$. However, as the frequency increases, $\\tan(\\omega_d T_s / 2)$ grows faster than its argument, showing that $\\omega_c  \\omega_d$. This means the continuous-time frequency spectrum is compressed into the discrete-time frequency range from $0$ to the Nyquist frequency, $\\omega_s/2 = \\pi/T_s$.\n\nThe problem asks to analyze this effect near a desired continuous-time crossover frequency of $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$. We need to find the corresponding discrete-time frequency, $\\omega_d$, which is the \"discrete-time image\" of $\\omega_c$. We invert the mapping equation:\n$$\n\\omega_d = \\frac{2}{T_s} \\arctan\\left(\\frac{\\omega_c T_s}{2}\\right)\n$$\nWe are given $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$ and $T_s = 2 \\times 10^{-5}\\,\\mathrm{s}$.\nThe argument of the arctangent function is:\n$$\n\\frac{\\omega_c T_s}{2} = \\frac{(10{,}000\\,\\mathrm{rad/s}) \\times (2 \\times 10^{-5}\\,\\mathrm{s})}{2} = \\frac{0.2}{2} = 0.1\n$$\nNow, we calculate $\\omega_d$:\n$$\n\\omega_d = \\frac{2}{2 \\times 10^{-5}} \\arctan(0.1) = 10^5 \\arctan(0.1)\\,\\mathrm{rad/s}\n$$\nUsing a calculator, $\\arctan(0.1) \\approx 0.09966865$.\n$$\n\\omega_d \\approx 10^5 \\times 0.09966865 = 9966.865\\,\\mathrm{rad/s}\n$$\nThe warping effect is evident: the desired analog frequency of $10{,}000\\,\\mathrm{rad/s}$ is mapped to a lower digital frequency of approximately $9966.87\\,\\mathrm{rad/s}$.\n\nThe relative deviation between the desired analog frequency $\\omega_c$ and its discrete-time image $\\omega_d$ is:\n$$\n\\text{Relative Deviation} = \\frac{\\omega_c - \\omega_d}{\\omega_c} = 1 - \\frac{\\omega_d}{\\omega_c}\n$$\n$$\n\\text{Relative Deviation} = 1 - \\frac{10^5 \\arctan(0.1)}{10^4} = 1 - 10 \\arctan(0.1)\n$$\n$$\n\\text{Relative Deviation} \\approx 1 - 10 \\times 0.09966865 = 1 - 0.9966865 = 0.0033135\n$$\nThe relative deviation is approximately $0.0033$, or $0.33\\%$. This means that a controller designed in the continuous-time domain to have a crossover at $10{,}000\\,\\mathrm{rad/s}$, when discretized using the Tustin transform without prewarping, will have an actual crossover in the discrete system corresponding to this lower analog frequency. To achieve the desired $10{,}000\\,\\mathrm{rad/s}$ crossover, prewarping would be necessary, where the analog design target frequency is adjusted upward to compensate for the warping effect.",
            "answer": "$$\n\\boxed{\\frac{\\frac{6}{25} + \\frac{12}{25}z^{-1} + \\frac{6}{25}z^{-2}}{1 - \\frac{46}{25}z^{-1} + \\frac{23}{25}z^{-2}}}\n$$"
        },
        {
            "introduction": "Beyond the effects of sampling, the finite precision of digital hardware introduces another layer of complexity: quantization. This practice () explores how the non-linear nature of quantization can give rise to unexpected behaviors not predicted by linear theory, such as zero-input limit cycles. By deriving the conditions for these small, persistent oscillations from first principles, you will gain a deeper appreciation for the subtle yet significant challenges of implementing stable and high-precision digital control systems.",
            "id": "3833392",
            "problem": "A first-order Infinite Impulse Response (IIR) digital filter with quantized feedback is implemented as $y[n] = Q(a\\,y[n-1])$ under zero input, where $Q(\\cdot)$ is a uniform mid-tread quantizer that rounds to the nearest representable level with step size $\\Delta  0$. The quantizer has infinite range and satisfies $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$ and the odd symmetry $Q(-x) = -Q(x)$. The coefficient $a \\in \\mathbb{R}$ is the feedback gain. Starting from these definitions and properties, derive, from first principles, the conditions under which the nonlinear quantization yields a nontrivial period-$2$ zero-input limit cycle of the form $y[n] \\in \\{+A,-A\\}$, and express the cycle amplitude $A$ explicitly in terms of $\\Delta$, $a$, and an integer parameter that characterizes the quantization levels. Your derivation should identify any necessary sign conditions on $a$ and the admissible set of integers for which such a cycle can exist.\n\nThen apply these conditions to a digital current estimator for a resistor–inductor (RL) load. The physical plant is described by $\\frac{di(t)}{dt} = \\frac{1}{L}\\big(v(t) - R\\,i(t)\\big)$, where $i(t)$ is the current, $R$ is the resistance, $L$ is the inductance, and $v(t)$ is the applied voltage. A forward-Euler predictor that uses quantized feedback of the current estimate implements\n$$\\hat{i}[n] = \\hat{i}[n-1] + \\frac{T_s}{L}\\big(u[n-1] - R\\,Q(\\hat{i}[n-1])\\big),$$\nwith sampling period $T_s$ and zero-input $u[n] \\equiv 0$. Under zero input and quantized feedback, this reduces to a one-dimensional nonlinear recursion of the form $\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$, where $\\beta \\triangleq \\frac{R\\,T_s}{L}$. From first principles, derive the amplitude $A$ of any symmetric period-$2$ zero-input limit cycle $\\hat{i}[n] \\in \\{+A,-A\\}$ for this estimator in terms of $\\Delta$, $\\beta$, and an integer parameter. State the admissibility condition on that integer.\n\nFinally, for the RL estimator, take $L = 1\\ \\mathrm{mH}$, $R = 0.5\\ \\Omega$, $T_s = 3\\ \\mathrm{ms}$, and a quantizer step size $\\Delta = 0.125\\ \\mathrm{A}$. Compute the maximum-amplitude zero-input limit cycle that can arise from the quantized-feedback recursion above and report the amplitude in amperes. Round your final numerical amplitude to four significant figures and express it in $\\mathrm{A}$.",
            "solution": "The problem presents a three-part analysis of zero-input limit cycles arising from quantization in digital filters. We must first validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Part 1 (General IIR Filter):**\n  - System equation: $y[n] = Q(a\\,y[n-1])$ with zero input.\n  - Quantizer $Q(\\cdot)$: Uniform mid-tread with step size $\\Delta  0$, defined by $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$, and having odd symmetry $Q(-x) = -Q(x)$.\n  - Limit cycle form: Nontrivial period-$2$, $y[n] \\in \\{+A, -A\\}$ with $A \\neq 0$.\n- **Part 2 (RL Estimator):**\n  - System equation: $\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$, where $\\beta \\triangleq \\frac{R\\,T_s}{L}$.\n  - Limit cycle form: Symmetric period-$2$, $\\hat{i}[n] \\in \\{+A, -A\\}$.\n- **Part 3 (Numerical Calculation):**\n  - Parameters: $L = 1 \\times 10^{-3}\\ \\mathrm{H}$, $R = 0.5\\ \\Omega$, $T_s = 3 \\times 10^{-3}\\ \\mathrm{s}$, $\\Delta = 0.125\\ \\mathrm{A}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, investigating a well-documented phenomenon in digital signal processing and control theory known as quantization-induced limit cycles. The models for the digital filter, the RL estimator, and the quantizer are standard and mathematically well-defined. The problem is self-contained, providing all necessary definitions and parameters. The language is objective and precise. The tasks are clearly stated and lead to a unique, verifiable solution. The problem does not violate any of the invalidity criteria. For instance, it is not scientifically unsound, incomplete, or ill-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n### Derivation and Solution\n\nThe quantizer $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$ maps a real number $x$ to the nearest integer multiple of $\\Delta$. The odd symmetry property $Q(-x)=-Q(x)$ implies a symmetric rounding rule for values exactly halfway between quantization levels (e.g., round half away from zero). With such a rule, the input region that maps to the output level $k\\Delta$ (for integer $k$) is the semi-open interval $[(k - 0.5)\\Delta, (k + 0.5)\\Delta)$.\n\n**Part 1: Analysis of the general IIR filter $y[n] = Q(a\\,y[n-1])$}\n\nWe are looking for conditions that support a nontrivial period-$2$ limit cycle of the form $\\{..., +A, -A, +A, -A, ...\\}$, where $A  0$.\nFor this sequence to be a solution of the system equation $y[n] = Q(a\\,y[n-1])$, two conditions must be met:\n1. If $y[n-1] = -A$, then $y[n]$ must be $+A$. This gives: $A = Q(a(-A)) = Q(-aA)$.\n2. If $y[n-1] = +A$, then $y[n]$ must be $-A$. This gives: $-A = Q(aA)$.\n\nUsing the odd symmetry property of the quantizer, $Q(-x) = -Q(x)$, the first condition $A = Q(-aA)$ becomes $A = -Q(aA)$, which is equivalent to the second condition. Thus, we only need to satisfy $-A = Q(aA)$.\n\nThe output of the quantizer is always an integer multiple of the step size $\\Delta$. Since $A$ is an output of the system (and thus of the quantizer), it must be of the form $A = m\\Delta$ for some integer $m$. As we are interested in a nontrivial limit cycle ($A0$), $m$ must be a positive integer, $m \\in \\mathbb{Z}^+$.\n\nSubstituting $A=m\\Delta$ into the condition $-A = Q(aA)$ yields:\n$$ -m\\Delta = Q(a(m\\Delta)) $$\nFor the quantizer output to be $-m\\Delta$, its input, $a(m\\Delta)$, must fall into the corresponding quantization interval. Based on the quantizer definition, for an output of $k\\Delta$, the input must be in $[(k-0.5)\\Delta, (k+0.5)\\Delta)$. For $k=-m$, this is:\n$$ (-m - 0.5)\\Delta \\le a(m\\Delta)  (-m + 0.5)\\Delta $$\nSince $m  0$ and $\\Delta  0$, we can divide the inequality by $m\\Delta$ without changing the signs:\n$$ \\frac{-m - 0.5}{m} \\le a  \\frac{-m + 0.5}{m} $$\n$$ -1 - \\frac{1}{2m} \\le a  -1 + \\frac{1}{2m} $$\nThis inequality defines the range of the feedback gain $a$ that can sustain a period-$2$ limit cycle of amplitude $A=m\\Delta$. A necessary condition for such a cycle to exist is that the gain $a$ must be negative, as the interval for $a$ lies entirely below $0$ for any $m \\ge 1$. The admissible integers are all positive integers $m \\ge 1$.\n\n**Part 2: Analysis of the RL current estimator**\n\nThe zero-input recursion for the current estimator is given by $\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$. We seek a symmetric period-$2$ limit cycle $\\hat{i}[n] \\in \\{+A, -A\\}$, with $A0$.\n1. If $\\hat{i}[n-1] = A$, then $\\hat{i}[n]$ must be $-A$. Substituting into the equation:\n   $$ -A = A - \\beta\\,Q(A) \\Rightarrow 2A = \\beta\\,Q(A) $$\n2. If $\\hat{i}[n-1] = -A$, then $\\hat{i}[n]$ must be $A$. Substituting into the equation:\n   $$ A = -A - \\beta\\,Q(-A) $$\n   Using the quantizer's odd symmetry, $Q(-A) = -Q(A)$, this becomes:\n   $$ A = -A + \\beta\\,Q(A) \\Rightarrow 2A = \\beta\\,Q(A) $$\nBoth transitions yield the same condition. From $2A = \\beta\\,Q(A)$, we can express the quantization output as $Q(A) = \\frac{2A}{\\beta}$. Since the quantizer output must be an integer multiple of $\\Delta$, let $Q(A) = k\\Delta$ for some integer $k$. Given $\\beta = \\frac{R\\,T_s}{L}  0$ and $A  0$, we must have $Q(A)  0$. For a mid-tread quantizer, this implies $A  \\Delta/2$ and $k$ must be a positive integer, $k \\in \\mathbb{Z}^+$.\n\nSubstituting $Q(A) = k\\Delta$ back into the condition $2A = \\beta\\,Q(A)$, we solve for the amplitude $A$:\n$$ 2A = \\beta(k\\Delta) \\Rightarrow A = \\frac{\\beta k \\Delta}{2} $$\nFor this solution to be self-consistent, the amplitude $A$ must, when fed into the quantizer, produce the output $k\\Delta$. That is, $Q(A)$ must equal $k\\Delta$. This requires $A$ to lie in the quantization interval corresponding to the output $k\\Delta$:\n$$ (k - 0.5)\\Delta \\le A  (k + 0.5)\\Delta $$\nSubstituting our expression for $A$:\n$$ (k - 0.5)\\Delta \\le \\frac{\\beta k \\Delta}{2}  (k + 0.5)\\Delta $$\nSince $\\Delta  0$, we can divide by it:\n$$ k - 0.5 \\le \\frac{\\beta k}{2}  k + 0.5 $$\nMultiplying by $2$ gives:\n$$ 2k - 1 \\le \\beta k  2k + 1 $$\nThis pair of inequalities provides the admissibility condition on the integer parameter $k$ for a given $\\beta$. We can separate them:\n1. $2k - 1 \\le \\beta k \\Rightarrow 2k - \\beta k \\le 1 \\Rightarrow k(2 - \\beta) \\le 1$.\n2. $\\beta k  2k + 1 \\Rightarrow \\beta k - 2k  1 \\Rightarrow k(\\beta - 2)  1$.\n\nSo, for a given system parameter $\\beta$, a period-$2$ limit cycle can exist for each positive integer $k$ that satisfies both $k(2 - \\beta) \\le 1$ and $k(\\beta - 2)  1$. The amplitude of such a cycle is $A = \\frac{\\beta k \\Delta}{2}$.\n\n**Part 3: Numerical Calculation for the RL estimator**\n\nWe are given the parameters $L = 1 \\times 10^{-3}\\ \\mathrm{H}$, $R = 0.5\\ \\Omega$, $T_s = 3 \\times 10^{-3}\\ \\mathrm{s}$, and $\\Delta = 0.125\\ \\mathrm{A}$.\nFirst, we compute the parameter $\\beta$:\n$$ \\beta = \\frac{R\\,T_s}{L} = \\frac{(0.5)(3 \\times 10^{-3})}{1 \\times 10^{-3}} = 1.5 $$\nNext, we find the set of admissible positive integers $k$ using the derived conditions with $\\beta = 1.5$:\n1. $k(2 - 1.5) \\le 1 \\Rightarrow 0.5k \\le 1 \\Rightarrow k \\le 2$.\n2. $k(1.5 - 2)  1 \\Rightarrow -0.5k  1$. This inequality is satisfied for all positive integers $k$.\n\nCombining these, the admissible integers are $k \\in \\{1, 2\\}$.\nThe limit cycle amplitude is given by $A_k = \\frac{\\beta k \\Delta}{2}$. To find the maximum-amplitude limit cycle, we must use the largest admissible value of $k$, which is $k_{max} = 2$.\nThe maximum amplitude $A_{max}$ is:\n$$ A_{max} = \\frac{\\beta k_{max} \\Delta}{2} = \\frac{(1.5)(2)(0.125)}{2} $$\n$$ A_{max} = (1.5)(0.125) = \\frac{3}{2} \\times \\frac{1}{8} = \\frac{3}{16} $$\nConverting to a decimal value:\n$$ A_{max} = 0.1875\\ \\mathrm{A} $$\nThe problem asks for the result to be rounded to four significant figures. The value $0.1875$ already has four significant figures.",
            "answer": "$$\\boxed{0.1875}$$"
        },
        {
            "introduction": "The theoretical power of an advanced control algorithm is only useful if it can be executed within the strict time constraints of a real-time system. This final exercise () tackles the crucial trade-off between algorithmic complexity and computational feasibility, using finite-control-set model predictive control (MPC) as a practical example. You will analyze the computational load of the algorithm and determine the operational limits imposed by a digital signal processor's performance, highlighting the necessity of intelligent pruning strategies to make advanced control a reality.",
            "id": "3833325",
            "problem": "A three-phase two-level voltage source inverter is controlled using finite-control-set Model Predictive Control (MPC), implemented on a Digital Signal Processor (DSP). The inverter has three legs, each leg with two switches, leading to $2^{3}$ distinct switching states. The controller evaluates candidate switching sequences of length $L$ at each control interval to minimize a quadratic tracking cost.\n\nAssume the plant is a three-phase resistive-inductive load represented in the stationary $\\alpha$-$\\beta$ frame with state vector $i_{\\alpha\\beta} = \\begin{pmatrix} i_{\\alpha} \\\\ i_{\\beta} \\end{pmatrix}$. Using forward Euler discretization with precomputed constants, the prediction update for each dimension is\n$$\ni_{k+1} = c_{1}\\, i_{k} + c_{2}\\, v_{k},\n$$\nwhere $c_{1} = 1 - (R/L) T_{s}$, $c_{2} = T_{s}/L$, $R$ is resistance, $L$ is inductance, $T_{s}$ is the sampling period, and $v_{k}$ is the inverter voltage component in the corresponding $\\alpha$ or $\\beta$ axis obtained from the switching state via a precomputed lookup. The quadratic tracking cost over the horizon is defined as\n$$\nJ = \\sum_{m=1}^{L} w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right),\n$$\nwith constant references $i_{\\alpha}^{\\star}$ and $i_{\\beta}^{\\star}$ and weight $w$. Assume that for a single prediction step and a single candidate sequence element, you count each floating-point multiplication, addition, or subtraction as one floating-point operation (FLOP), and comparisons or table lookups do not count.\n\n1. Starting from the given discrete-time model and cost definition, derive the number of floating-point operations required per prediction step, per candidate sequence, for the two-dimensional $\\alpha$-$\\beta$ system. Then, derive the total number of floating-point operations required to evaluate all candidate switching sequences of length $L$ when considering all inverter switching states.\n\n2. The DSP has a peak throughput of $400$ mega floating-point operations per second (FLOPS), but due to pipeline stalls and memory fetches, only $60\\%$ of the peak is effectively usable for the computation of predictions and cost. The control interval is $T_{s} = 50\\,\\mu\\text{s}$, and non-computational overhead consumes $15\\,\\mu\\text{s}$ of this interval, leaving a computation budget of $35\\,\\mu\\text{s}$. Using these parameters, compute the maximum allowed number of floating-point operations per control interval and determine the maximum branching factor $b_{\\max}$ (the maximum number of candidate switching states per step) such that evaluating all sequences of length $L=3$ meets the real-time deadline. Express $b_{\\max}$ as an integer.\n\n3. Briefly propose two physically and computationally sound pruning strategies that reduce the effective branching factor below the full set of inverter states while preserving control performance, and explain qualitatively how each strategy impacts the branching factor and computational complexity. Your final numeric answer must be the value of $b_{\\max}$ from part 2, expressed as an integer with no units.",
            "solution": "The problem will be addressed by first validating its premises and structure, followed by a sequential derivation for each of the three parts.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- System: Three-phase two-level voltage source inverter.\n- Number of switching states: $2^{3} = 8$.\n- Control method: Finite-control-set Model Predictive Control (FCS-MPC).\n- Candidate sequence length: $L$.\n- System state vector: $i_{\\alpha\\beta} = \\begin{pmatrix} i_{\\alpha} \\\\ i_{\\beta} \\end{pmatrix}$.\n- Discrete-time model (forward Euler): $i_{k+1} = c_{1}\\, i_{k} + c_{2}\\, v_{k}$ for each dimension ($\\alpha$, $\\beta$).\n- Model constants: $c_{1} = 1 - (R/L) T_{s}$, $c_{2} = T_{s}/L$.\n- Cost function: $J = \\sum_{m=1}^{L} w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right)$.\n- References: $i_{\\alpha}^{\\star}$ and $i_{\\beta}^{\\star}$ are constant.\n- FLOP counting: a floating-point multiplication, addition, or subtraction is one FLOP. Comparisons and table lookups are zero FLOPs.\n- DSP peak throughput: $400$ megaFLOPS.\n- DSP effective throughput factor: $60\\%$.\n- Control interval (sampling period): $T_{s} = 50\\,\\mu\\text{s}$.\n- Non-computational overhead time: $15\\,\\mu\\text{s}$.\n- Horizon length for part 2: $L=3$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly grounded in the principles of power electronics and digital control. The system (VSI), load model (RL), control strategy (FCS-MPC), and performance metric (quadratic cost function) are standard and widely used in the field. The discrete-time model is a valid first-order approximation. (Criterion: Met)\n- **Well-Posed:** All necessary data for each part of the problem are provided. The questions are specific and lead to unique, derivable answers. (Criterion: Met)\n- **Objective:** The problem is stated using precise, formal language common to engineering and mathematics, free of subjective or ambiguous terminology. (Criterion: Met)\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. The solution process will now proceed.\n\n**Part 1: Computational Complexity Derivation**\n\nFirst, we determine the number of floating-point operations (FLOPs) required for one prediction step and the associated cost calculation for a single candidate sequence.\n\n**FLOPs for one prediction update:**\nThe state prediction model is applied to both the $\\alpha$ and $\\beta$ components of the current.\nFor the $\\alpha$ component: $i_{\\alpha, k+1} = c_{1}\\, i_{\\alpha, k} + c_{2}\\, v_{\\alpha, k}$.\n- One multiplication for $c_{1} \\times i_{\\alpha, k}$.\n- One multiplication for $c_{2} \\times v_{\\alpha, k}$.\n- One addition to sum the two products.\nThis amounts to $3$ FLOPs for the $\\alpha$ component. The same calculation is performed for the $\\beta$ component, requiring another $3$ FLOPs.\nThe total number of FLOPs for a single prediction update of the two-dimensional state vector $i_{\\alpha\\beta}$ is $F_{pred} = 3 + 3 = 6$ FLOPs.\n\n**FLOPs for one cost term calculation:**\nThe cost term for a single prediction step $k+m$ is $j_{m} = w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right)$.\n- One subtraction for the error $e_{\\alpha} = i_{\\alpha,k+m} - i_{\\alpha}^{\\star}$.\n- One subtraction for the error $e_{\\beta} = i_{\\beta,k+m} - i_{\\beta}^{\\star}$.\n- One multiplication for the square $e_{\\alpha}^{2}$.\n- One multiplication for the square $e_{\\beta}^{2}$.\n- One addition for the sum of squares $e_{\\alpha}^{2} + e_{\\beta}^{2}$.\n- One multiplication by the weight $w$.\nThe total number of FLOPs to calculate one term of the cost function is $F_{cost\\_term} = 1 + 1 + 1 + 1 + 1 + 1 = 6$ FLOPs.\n\nThe number of FLOPs required **per prediction step** in the horizon, for a given candidate sequence, is the sum of the FLOPs for the state prediction and the cost term calculation for that step.\n$F_{step} = F_{pred} + F_{cost\\_term} = 6 + 6 = 12$ FLOPs.\n\nNext, we derive the total number of FLOPs to evaluate all possible candidate sequences.\nA sequence of length $L$ requires $L$ prediction updates and $L$ cost term calculations. The total cost $J$ is the sum of these $L$ terms, which requires $L$ additions if using an accumulator initialized to zero ($J_{acc} = J_{acc} + j_m$), or $L-1$ additions if summing the terms at the end. We assume an accumulator, which is typical.\nFLOPs per sequence of length $L$: $F_{seq} = L \\times F_{step} + L \\times (\\text{1 for accumulation}) = L \\times 12 + L = 13L$.\n\nThe inverter has $N_{states} = 2^{3} = 8$ distinct switching states. For a prediction horizon of length $L$, there are $N_{seq} = (N_{states})^{L} = 8^{L}$ possible sequences to evaluate.\nThe total number of floating-point operations is the product of the number of sequences and the FLOPs per sequence.\n$F_{total} = N_{seq} \\times F_{seq} = 8^{L} \\times 13L$.\n\n**Summary for Part 1:**\n- Number of FLOPs per prediction step, per candidate sequence: $12$.\n- Total number of FLOPs to evaluate all candidate sequences: $8^{L} \\times 13L$.\n\n**Part 2: Maximum Branching Factor Calculation**\n\nFirst, we calculate the computational budget available in one control interval.\n- Peak DSP throughput: $P_{peak} = 400 \\times 10^{6}$ FLOPS.\n- Effective throughput: $P_{eff} = 0.60 \\times P_{peak} = 0.60 \\times 400 \\times 10^{6} = 240 \\times 10^{6}$ FLOPS.\n- Total control interval: $T_{s} = 50 \\times 10^{-6}\\,s$.\n- Overhead time: $T_{overhead} = 15 \\times 10^{-6}\\,s$.\n- Available computation time: $T_{compute} = T_{s} - T_{overhead} = (50 - 15) \\times 10^{-6} = 35 \\times 10^{-6}\\,s$.\n\nThe maximum number of FLOPs that can be executed within this time is:\n$F_{max} = P_{eff} \\times T_{compute} = (240 \\times 10^{6}) \\times (35 \\times 10^{-6}) = 240 \\times 35 = 8400$ FLOPs.\n\nNow, we generalize the total FLOP count from Part 1 to an arbitrary branching factor $b$. The branching factor is the number of candidate states considered at each step of the horizon. The total number of sequences to evaluate becomes $b^L$.\nThe total FLOP count as a function of $b$ and $L$ is:\n$F_{total}(b, L) = b^{L} \\times 13L$.\n\nWe need to find the maximum integer $b_{max}$ such that the computation can be completed within the available time budget, for a horizon of $L=3$.\n$F_{total}(b_{max}, 3) \\le F_{max}$\n$b_{max}^{3} \\times 13 \\times 3 \\le 8400$\n$b_{max}^{3} \\times 39 \\le 8400$\n$b_{max}^{3} \\le \\frac{8400}{39} \\approx 215.385$\n\nTo find the maximum integer $b_{max}$, we take the cube root of this value.\n$b_{max} \\le (215.385)^{1/3}$.\nWe know that $5^3 = 125$ and $6^3 = 216$. Since $215.385  216$, $b_{max}$ must be less than $6$.\nThe maximum allowed integer branching factor is therefore $b_{max} = 5$.\n\n**Part 3: Pruning Strategies**\n\nTo reduce the computational burden from evaluating all $8$ possible states at each step, pruning strategies are employed to reduce the effective branching factor $b$. Two physically and computationally sound strategies are:\n\n1.  **Sector-Based Pruning:** This strategy leverages physical insight into the system's behavior. The $\\alpha$-$\\beta$ plane is divided into six $60$-degree sectors, each corresponding to the region between two adjacent non-zero voltage vectors. At each control step, an ideal or required voltage vector $v_{req}$ is calculated, often using a deadbeat control law (e.g., $v_{req} = (i^{\\star} - c_1 i_k) / c_2$). The algorithm then identifies the sector in which $v_{req}$ lies and prunes the set of candidate states to only those most likely to drive the current towards the reference. Typically, this includes the two active voltage vectors that bound the sector and one or both of the zero vectors.\n    - **Impact:** This strategy drastically reduces the branching factor from $b=8$ to a small, fixed number, often $b=3$ (two active vectors and one zero vector). This yields a computational complexity of $O(3^L)$ instead of $O(8^L)$, representing a massive reduction in computational load while maintaining high performance by focusing the search on the most effective control actions.\n\n2.  **Cost-Based Heuristic Pruning:** This strategy uses a simplified cost evaluation to pre-filter the candidate states. At each step $m$ in the prediction horizon for a given sequence, instead of immediately committing to a full-horizon search, a one-step-ahead prediction is performed for all $8$ possible next states. The cost contribution for that single step, $j_m$, is calculated for each of the $8$ outcomes. The states are then ranked based on this short-term cost. Only the top $b$ states (those with the lowest one-step cost) are retained for continuing the prediction to the next step, $m+1$.\n    - **Impact:** This method allows the branching factor $b$ to be a tunable parameter, offering a direct trade-off between computational load and the extensiveness of the search. For example, setting $b=5$ meets the deadline calculated in Part 2. The complexity becomes $O(b^L)$, but with an added overhead at each node of the search tree to evaluate $8$ possibilities before pruning to $b$. It is a flexible but more heuristic approach compared to sector-based pruning, as it assumes that a locally optimal choice is a good indicator of a globally optimal sequence.",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}