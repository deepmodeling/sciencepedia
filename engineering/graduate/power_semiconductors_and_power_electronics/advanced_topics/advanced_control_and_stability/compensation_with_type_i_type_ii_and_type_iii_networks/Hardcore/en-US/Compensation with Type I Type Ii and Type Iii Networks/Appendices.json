{
    "hands_on_practices": [
        {
            "introduction": "An accurate small-signal model is the cornerstone of effective feedback controller design. This practice focuses on a critical, yet often overlooked, component of the power stage model: the Pulse-Width Modulation (PWM) modulator. By deriving the relationship between the control voltage and the resulting duty cycle, you will determine the modulator's gain, $G_m$, from fundamental principles . This hands-on derivation clarifies how a physical process—comparing a control signal to a ramp—translates into a simple but crucial gain block in the overall loop transfer function.",
            "id": "3827867",
            "problem": "A voltage-mode controlled buck converter is to be compensated with a Type II network. In such designs, the high-frequency loop gain contribution of the Pulse Width Modulation (PWM) modulator must be quantified from first principles rather than assumed. Consider a peak PWM modulator implemented by comparing a control voltage $v_{c}(t)$ to a periodic linear ramp $v_{r}(t)$ of switching period $T_{\\mathrm{s}}$ and peak amplitude $V_{\\mathrm{ramp}}$. The ramp is zero at $t=0$ and increases linearly to $V_{\\mathrm{ramp}}$ at $t=T_{\\mathrm{s}}$. The modulator turns the switch on at $t=0$ and turns it off the first time $v_{r}(t)$ equals $v_{c}(t)$ within the period, thereby producing a duty ratio $D$ equal to the fraction of the period for which the switch is on.\n\nStarting from the definitions above and the linear time law for the ramp, derive the small-signal modulator gain $G_{m}$ defined as the sensitivity of the duty ratio to the control voltage, $G_{m}=\\frac{\\mathrm{d}D}{\\mathrm{d}v_{c}}$, for this peak PWM. Then evaluate $G_{m}$ for a ramp peak amplitude $V_{\\mathrm{ramp}}=1.5$ V.\n\nExpress your final answer in $\\mathrm{V}^{-1}$ and round your result to four significant figures.",
            "solution": "The problem requires the derivation and evaluation of the small-signal modulator gain, $G_m$, for a peak PWM modulator. The gain is defined as the sensitivity of the duty ratio, $D$, to the control voltage, $v_c$, which is formally expressed as $G_m = \\frac{\\mathrm{d}D}{\\mathrm{d}v_c}$.\n\nFirst, we must establish the mathematical model for the system based on the provided description. The ramp voltage, $v_r(t)$, increases linearly from a value of $0$ at time $t=0$ to its peak amplitude, $V_{\\text{ramp}}$, at the end of the switching period, $T_s$. The function describing this behavior within a single cycle ($0 \\le t  T_s$) is:\n$$v_r(t) = \\left(\\frac{V_{\\text{ramp}}}{T_s}\\right) t$$\nThe term $\\frac{V_{\\text{ramp}}}{T_s}$ represents the constant slope of the ramp.\n\nThe PWM modulator operates by comparing this ramp voltage $v_r(t)$ with the control voltage $v_c(t)$. The power switch is turned on at the beginning of the cycle, $t=0$. The switch is turned off at the time instant, $t_{\\text{off}}$, when the ramp voltage equals the control voltage. For the purpose of deriving the DC and small-signal characteristics, we consider the control voltage $v_c(t)$ to be constant with a value $v_c$ over a single switching period. The turn-off condition is therefore:\n$$v_r(t_{\\text{off}}) = v_c$$\n\nThe duty ratio, $D$, is the fraction of the switching period during which the switch is in the on-state. Since the on-time starts at $t=0$ and ends at $t=t_{\\text{off}}$, the duty ratio is given by:\n$$D = \\frac{t_{\\text{off}}}{T_s}$$\nThis equation allows us to express the turn-off time in terms of the duty ratio: $t_{\\text{off}} = D T_s$.\n\nWe can now combine these relationships to find the direct link between the control voltage $v_c$ and the duty ratio $D$. By substituting $t_{\\text{off}} = D T_s$ into the turn-off condition $v_r(t_{\\text{off}}) = v_c$, we get:\n$$v_r(D T_s) = v_c$$\nNext, we substitute the expression for the ramp voltage $v_r(t)$:\n$$\\left(\\frac{V_{\\text{ramp}}}{T_s}\\right) (D T_s) = v_c$$\nThe switching period $T_s$ cancels out, leading to a simple, linear relationship between the duty ratio and the control voltage, which represents the large-signal characteristic of the modulator:\n$$V_{\\text{ramp}} D = v_c$$\n\nThe small-signal modulator gain $G_m$ is the derivative of the output ($D$) with respect to the input ($v_c$). We obtain this by differentiating the large-signal equation with respect to $v_c$:\n$$G_m = \\frac{\\mathrm{d}D}{\\mathrm{d}v_c}$$\nApplying differentiation to the large-signal equation:\n$$\\frac{\\mathrm{d}}{\\mathrm{d}v_c} (V_{\\text{ramp}} D) = \\frac{\\mathrm{d}}{\\mathrm{d}v_c} (v_c)$$\nSince $V_{\\text{ramp}}$ is a constant parameter of the modulator, we can write:\n$$V_{\\text{ramp}} \\frac{\\mathrm{d}D}{\\mathrm{d}v_c} = 1$$\nSolving for the gain $G_m = \\frac{\\mathrm{d}D}{\\mathrm{d}v_c}$ yields the symbolic expression:\n$$G_m = \\frac{1}{V_{\\text{ramp}}}$$\n\nThe problem requires the numerical evaluation of this gain for a given peak ramp amplitude $V_{\\text{ramp}} = 1.5$ V. Substituting this value into the derived formula:\n$$G_m = \\frac{1}{1.5 \\ \\text{V}}$$\nCalculating the numerical value:\n$$G_m = \\frac{2}{3} \\ \\mathrm{V}^{-1} \\approx 0.66666... \\ \\mathrm{V}^{-1}$$\nAccording to the problem's instruction, the result must be rounded to four significant figures.\n$$G_m \\approx 0.6667 \\ \\mathrm{V}^{-1}$$\nThis result quantifies the gain of the PWM modulator block, a critical parameter for designing the feedback compensation network of the converter.",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "Once the plant is characterized, the compensator can be designed to shape the open-loop response and achieve the desired closed-loop performance. This exercise tackles a fundamental design objective: setting the converter's bandwidth by selecting the gain of a Type I compensator . You will use the defining property of the unity-gain crossover frequency, where the loop gain magnitude is one, to calculate the required integrator gain $K$, directly linking a compensator parameter to a key performance metric.",
            "id": "3827835",
            "problem": "A continuous-conduction-mode, current-mode controlled direct-current-to-direct-current buck converter is operated with its inner current loop tightly closed. The resulting linearized outer-loop plant from the compensator output to the regulated output can be represented by a complex frequency response whose magnitude at a specified angular frequency is measured experimentally using small-signal injection. Denote the product of the error-amplifier transconductance to plant interface and the control-to-output small-signal gain as $G_{m}G_{vd}(s)$, so that the one-loop open-loop transfer function is $L(s)=C(s)\\,G_{m}G_{vd}(s)$, where $C(s)$ is the compensator.\n\nYou are to design a Type I compensator, modeled as an ideal integrator, $C(s)=K/s$, to achieve a unity-gain bandwidth (crossover) at angular frequency $\\omega_{c}$. Assume that at the desired crossover frequency $\\omega_{c}=2\\pi\\cdot 5\\ \\text{kHz}$, the experimentally measured magnitude of the plant is $|G_{m}G_{vd}(j\\omega_{c})|=2.0\\times 10^{-2}$ (dimensionless).\n\nStarting only from the definitions of loop transfer function, magnitude crossover, and the given compensator form, derive the expression for the required $K$ and compute its value. Express $K$ in radians per second and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The objective is to find the value of the integrator gain $K$ for a Type I compensator, $C(s) = K/s$, such that the closed-loop system has a unity-gain crossover angular frequency $\\omega_c$.\n\nThe open-loop transfer function of the system is given by $L(s) = C(s) \\, G_{m}G_{vd}(s)$. Substituting the expression for the Type I compensator, we have:\n$$L(s) = \\frac{K}{s} G_{m}G_{vd}(s)$$\nThe unity-gain crossover frequency, $\\omega_c$, is defined as the angular frequency at which the magnitude of the open-loop transfer function is equal to unity ($1$). In the frequency domain, this is expressed by setting $s = j\\omega_c$:\n$$|L(j\\omega_c)| = 1$$\nWe evaluate the magnitude of $L(s)$ at $s = j\\omega_c$:\n$$|L(j\\omega_c)| = \\left| \\frac{K}{j\\omega_c} G_{m}G_{vd}(j\\omega_c) \\right|$$\nUsing the property that the magnitude of a product of complex numbers is the product of their magnitudes, and that $|j\\omega_c| = \\omega_c$ for a positive frequency:\n$$|L(j\\omega_c)| = \\frac{K}{\\omega_c} |G_{m}G_{vd}(j\\omega_c)|$$\nNow, we apply the unity-gain crossover condition, $|L(j\\omega_c)| = 1$:\n$$\\frac{K}{\\omega_c} |G_{m}G_{vd}(j\\omega_c)| = 1$$\nWe can now solve for the required gain $K$:\n$$K = \\frac{\\omega_c}{|G_{m}G_{vd}(j\\omega_c)|}$$\nThis is the symbolic expression for $K$.\n\nNext, we substitute the numerical values provided in the problem statement.\nThe desired crossover angular frequency is:\n$$\\omega_c = 2\\pi \\cdot 5 \\text{ kHz} = 2\\pi \\cdot (5 \\times 10^3) \\text{ rad/s} = 10000\\pi \\text{ rad/s}$$\nThe magnitude of the plant at this frequency is given as:\n$$|G_{m}G_{vd}(j\\omega_c)| = 2.0 \\times 10^{-2}$$\nSubstituting these values into the expression for $K$:\n$$K = \\frac{10000\\pi}{2.0 \\times 10^{-2}}$$\n$$K = \\frac{\\pi \\times 10^4}{2 \\times 10^{-2}} = \\frac{\\pi}{2} \\times 10^{6} = 0.5\\pi \\times 10^6 \\text{ rad/s}$$\nNow we compute the numerical value and round it to four significant figures as requested:\n$$K \\approx 0.5 \\times (3.14159265...) \\times 10^6$$\n$$K \\approx 1.5707963... \\times 10^6$$\nRounding to four significant figures gives:\n$$K \\approx 1.571 \\times 10^6$$\nThe units of $K$ are radians per second, as required. This can be verified by dimensional analysis of the compensator transfer function $C(s)=K/s$. Since $C(s)$ must be dimensionless for a dimensionless loop gain $L(s)$ (given a dimensionless plant gain), and $s$ has units of rad/s, $K$ must also have units of rad/s.",
            "answer": "$$\\boxed{1.571 \\times 10^{6}}$$"
        },
        {
            "introduction": "The transition from an ideal controller on paper to a robust physical circuit reveals important non-linear behaviors. This practice addresses integrator windup, a critical issue that arises when the control signal saturates the actuator, causing the integrator state to grow uncontrollably. You will analyze a common anti-windup clamp circuit and derive its recovery dynamics, learning how to size its components to ensure the controller recovers gracefully from saturation without excessive overshoot or delay .",
            "id": "3827818",
            "problem": "A step-down direct current-to-direct current converter is regulated by a voltage-mode control loop whose compensator is a Type I network (pure integrator). The compensator is implemented as an ideal operational amplifier integrator with a feedback capacitor of value $C_{i}$ and no intentional direct current leak. The control output $u(t)$ from the compensator is passed through a command saturation nonlinearity representing the Pulse-Width Modulation (PWM) modulator and gate driver limits; the applied actuator signal is $u_{a}(t) = \\mathrm{sat}(u(t))$, where the saturation clamps $u_{a}(t)$ to lie in $[0, U_{\\max}]$.\n\nAt startup, the output voltage is initially near zero and the error $e(t)$ presented to the integrator is approximately constant and positive: $e(t) \\approx E_{0}$ over an initial interval $[0, T_{0}]$. The integrator has gain $K_{i}$ such that its state evolves as $\\dot{v}_{c}(t) = K_{i}\\,e(t)$ in the absence of any clamp, with $v_{c}(0)=0$ and $u(t) = v_{c}(t)$. Assume $E_{0}  0$ and that $U_{\\max}$ is sufficiently small that saturation occurs very early in startup.\n\nTo mitigate integrator windup, you propose an anti-windup clamp implemented as a single ideal diode in series with a resistor $R_{aw}$ from the compensator output node to the saturated actuator node. The diode is forward-biased whenever $v_{c}(t)  u_{a}(t)$, so the clamp injects a current proportional to $v_{c}(t) - u_{a}(t)$ into the integrator capacitor. Assume the diode is ideal and ignore any op-amp input bias currents.\n\nUsing only the capacitor constitutive law $i_{C} = C\\,\\mathrm{d}v/\\mathrm{d}t$ and the definitions above, perform the following:\n\n- Starting from $i_{C} = C_{i}\\,\\mathrm{d}v_{c}/\\mathrm{d}t$ and Kirchhoff’s laws, derive the differential equation governing $v_{c}(t)$ when the clamp is conducting and $e(t)$ has collapsed to $0$ after the actuator saturates, with $u_{a}(t)$ held constant at its saturation value.\n\n- From that differential equation, derive the recovery dynamics time constant $\\tau_{aw}$ of $v_{c}(t)$ toward $u_{a}$ under clamp conduction, expressed in terms of $R_{aw}$ and $C_{i}$.\n\nYou are given the following numerically plausible parameters for a high-current converter startup scenario:\n- $C_{i} = 137\\,\\mathrm{nF}$,\n- Desired anti-windup recovery time constant $\\tau_{aw} = 2.75\\,\\mathrm{ms}$.\n\nCompute the required resistor $R_{aw}$ that achieves the specified $\\tau_{aw}$ for the clamp. Express the final resistor value in ohms and round your answer to four significant figures.",
            "solution": "The solution involves deriving the governing differential equation for the integrator voltage under anti-windup conditions, finding the associated time constant, and then calculating the required component values.\n\n**Part 1: Derivation of the differential equation for $v_{c}(t)$**\n\nWe apply Kirchhoff's Current Law (KCL) at the output node of the operational amplifier, where the voltage is $v_{c}(t)$. This node is connected to the integrating capacitor $C_i$ and the anti-windup clamp circuit. The total current charging the capacitor, $i_{C}$, is the algebraic sum of the currents entering this node.\n\nThe current charging the capacitor is given by the constitutive law:\n$$i_{C}(t) = C_{i} \\frac{dv_{c}(t)}{dt}$$\n\nThe integrator circuit provides a current proportional to the error signal $e(t)$. From the unclamped state equation $\\dot{v}_{c}(t) = K_{i}\\,e(t)$, and knowing that $i_{C}(t) = C_{i}\\dot{v}_{c}(t)$ in that case, we identify the current sourced by the error-processing part of the circuit as:\n$$i_{in}(t) = C_{i} K_{i} e(t)$$\n\nThe anti-windup clamp consists of a resistor $R_{aw}$ in series with an ideal diode, connected between the node $v_{c}(t)$ and the actuator node $u_{a}(t)$. When the clamp is conducting, which happens for $v_{c}(t) > u_{a}(t)$, the ideal diode acts as a short circuit. A current $i_{aw}(t)$ is drawn away from the capacitor node, flowing through the resistor $R_{aw}$. This current is given by Ohm's law:\n$$i_{aw}(t) = \\frac{v_{c}(t) - u_{a}(t)}{R_{aw}}$$\n\nApplying KCL at the capacitor node, the net current charging the capacitor is $i_{C} = i_{in} - i_{aw}$:\n$$C_{i} \\frac{dv_{c}(t)}{dt} = C_{i} K_{i} e(t) - \\frac{v_{c}(t) - u_{a}(t)}{R_{aw}}$$\n\nThe problem requires us to derive the differential equation under specific conditions: the clamp is conducting, the error $e(t)$ has collapsed to $0$, and the actuator signal $u_{a}(t)$ is held constant at its saturation value. Since the initial error $E_0$ was positive, the integrator voltage $v_c(t)$ would have increased, causing saturation at the upper limit. Thus, $u_{a}(t)$ is constant at $U_{\\max}$.\n\nSubstituting $e(t) = 0$ and $u_{a}(t) = U_{\\max}$ into the KCL equation, we get:\n$$C_{i} \\frac{dv_{c}(t)}{dt} = C_{i} K_{i} (0) - \\frac{v_{c}(t) - U_{\\max}}{R_{aw}}$$\nThis simplifies to the differential equation governing $v_{c}(t)$ during anti-windup recovery:\n$$C_{i} \\frac{dv_{c}(t)}{dt} = - \\frac{v_{c}(t) - U_{\\max}}{R_{aw}}$$\n\n**Part 2: Derivation of the recovery time constant $\\tau_{aw}$**\n\nTo find the time constant, we rearrange the derived differential equation into the standard form of a first-order linear system, which is $\\tau \\frac{dy(t)}{dt} + y(t) = K_{dc} \\cdot f(t)$, where $\\tau$ is the time constant.\n\nStarting with our equation:\n$$C_{i} \\frac{dv_{c}(t)}{dt} = - \\frac{1}{R_{aw}} (v_{c}(t) - U_{\\max})$$\nMultiply both sides by $R_{aw}$:\n$$R_{aw} C_{i} \\frac{dv_{c}(t)}{dt} = -v_{c}(t) + U_{\\max}$$\nMove the term involving $v_{c}(t)$ to the left-hand side:\n$$R_{aw} C_{i} \\frac{dv_{c}(t)}{dt} + v_{c}(t) = U_{\\max}$$\nThis equation is now in the standard form $\\tau \\frac{dy}{dt} + y = f$, with $y(t) = v_{c}(t)$, the constant input $f = U_{\\max}$, and the time constant $\\tau$ being the coefficient of the derivative term.\n\nBy direct inspection, the anti-windup recovery time constant $\\tau_{aw}$ is:\n$$\\tau_{aw} = R_{aw} C_{i}$$\nThis result is physically intuitive, representing the RC time constant of the discharge path formed by the anti-windup resistor and the integrator capacitor. The integrator state $v_c(t)$ exponentially recovers towards the saturation level $U_{max}$ with this time constant.\n\n**Part 3: Computation of the resistor value $R_{aw}$**\n\nWe are tasked with finding the value of $R_{aw}$ that achieves a specified time constant $\\tau_{aw}$. We rearrange the formula derived above:\n$$R_{aw} = \\frac{\\tau_{aw}}{C_{i}}$$\n\nThe given values are:\n- $\\tau_{aw} = 2.75\\,\\mathrm{ms} = 2.75 \\times 10^{-3}\\,\\mathrm{s}$\n- $C_{i} = 137\\,\\mathrm{nF} = 137 \\times 10^{-9}\\,\\mathrm{F}$\n\nSubstituting these values into the equation:\n$$R_{aw} = \\frac{2.75 \\times 10^{-3}\\,\\mathrm{s}}{137 \\times 10^{-9}\\,\\mathrm{F}}$$\n$$R_{aw} = \\frac{2.75}{137} \\times 10^{6}\\,\\Omega$$\n$$R_{aw} \\approx 0.0200729927 \\times 10^{6}\\,\\Omega$$\n$$R_{aw} \\approx 20072.9927\\,\\Omega$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$R_{aw} \\approx 2.007 \\times 10^{4}\\,\\Omega$$\nThe final answer is the numerical value of the resistance in ohms.",
            "answer": "$$\\boxed{2.007 \\times 10^{4}}$$"
        }
    ]
}