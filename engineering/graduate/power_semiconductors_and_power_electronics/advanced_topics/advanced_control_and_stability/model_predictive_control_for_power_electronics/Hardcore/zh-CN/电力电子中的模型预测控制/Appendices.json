{
    "hands_on_practices": [
        {
            "introduction": "模型预测控制的核心在于其“预测”能力。在为电力电子系统设计MPC控制器时，首要任务是建立一个精确的数学模型，以根据当前的系统状态和可行的控制输入，预测未来的系统行为。本练习将引导你从基本的电路定律出发，为连接到$L$-$R$负载的两电平逆变器推导出精确的单步电流预测方程，这是构建任何MPC策略的基石。",
            "id": "3858809",
            "problem": "一个三相两电平电压源逆变器驱动一个平衡的星形连接线性 $L$–$R$ 负载，其每相电感为 $L$，电阻为 $R$。直流母线电压为 $V_{\\mathrm{dc}}$。假设逆变器桥臂在每个长度为 $T_{\\mathrm{s}}$ 的采样间隔开始时进行开关动作，并在此间隔内保持该开关状态不变（零阶保持）。设开关位置为 $S_a,S_b,S_c \\in \\{0,1\\}$，其中 $S_x=1$ 表示将 $x$ 相连接到直流正母线，而 $S_x=0$ 表示连接到直流负母线。忽略死区时间、半导体压降以及任何反电动势源。负载中性点悬空，负载平衡，且各相之间无互感。\n\n令 $v_{\\alpha\\beta}$ 和 $i_{\\alpha\\beta}$ 分别表示相电压和相电流的静止坐标系 (Clarke) 空间矢量。在开关状态保持恒定的任一采样间隔内，施加的静止坐标系电压为\n$$\nv_{\\alpha\\beta} = \\frac{2}{3}\\,V_{\\mathrm{dc}}\\left(S_a + S_b\\,\\exp\\!\\left(\\mathrm{j}\\,\\frac{2\\pi}{3}\\right) + S_c\\,\\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi}{3}\\right)\\right),\n$$\n其中 $\\mathrm{j}$ 是虚数单位。负载遵循由 Kirchhoff 电压定律给出的每相关系（通过线性变换映射到静止坐标系）：$v_{\\alpha\\beta}(t) = L\\,\\frac{d i_{\\alpha\\beta}(t)}{dt} + R\\,i_{\\alpha\\beta}(t)$。\n\n在有限控制集模型预测控制 (FCS-MPC) 的背景下，需要求解零阶保持条件下静止坐标系电流矢量的精确单步预测值。从基本电路定律出发，在所述假设之外不引入任何近似，推导出精确的离散时间单步预测值 $i_{\\alpha\\beta}[k+1]$，其是 $i_{\\alpha\\beta}[k]$、$R$、$L$、$T_{\\mathrm{s}}$、$V_{\\mathrm{dc}}$ 以及开关位置 $S_a,S_b,S_c$ 的函数。将最终答案表示为一个对所有八种空间矢量开关状态都有效的单一闭式解析表达式。无需进行数值计算，也无需进行取整。",
            "solution": "该问题要求推导驱动 $L$-$R$ 负载的三相电压源逆变器的静止坐标系电流矢量 $i_{\\alpha\\beta}[k+1]$ 的精确单步预测。推导必须从所提供的基本原理出发。\n\n系统动态由 Kirchhoff 电压定律给出，在静止 $\\alpha\\beta$ 坐标系中表现为以下一阶线性常微分方程 (ODE)：\n$$L\\,\\frac{d i_{\\alpha\\beta}(t)}{dt} + R\\,i_{\\alpha\\beta}(t) = v_{\\alpha\\beta}(t)$$\n问题陈述，在任何持续时间为 $T_{\\mathrm{s}}$ 的采样间隔内，开关状态 $(S_a, S_b, S_c)$ 是恒定的。这意味着施加的电压矢量 $v_{\\alpha\\beta}$ 在此间隔内也是恒定的。我们将该间隔表示为 $t \\in [kT_{\\mathrm{s}}, (k+1)T_{\\mathrm{s}}]$，其中 $k$ 是采样时刻的整数索引。此间隔开始时的电流为 $i_{\\alpha\\beta}(kT_{\\mathrm{s}})$，我们将其记为 $i_{\\alpha\\beta}[k]$。目标是求出间隔结束时的电流 $i_{\\alpha\\beta}((k+1)T_{\\mathrm{s}})$，我们将其记为 $i_{\\alpha\\beta}[k+1]$。\n\n在第 $k$ 个间隔期间，该常微分方程变为：\n$$L\\,\\frac{d i_{\\alpha\\beta}(t)}{dt} + R\\,i_{\\alpha\\beta}(t) = v_{\\alpha\\beta}[k]$$\n其中 $v_{\\alpha\\beta}[k]$ 是由该间隔内施加的开关状态 $(S_a, S_b, S_c)$ 决定的恒定电压矢量。\n\n为求解此常微分方程，我们可以将其整理为标准形式：\n$$\\frac{d i_{\\alpha\\beta}(t)}{dt} + \\frac{R}{L}\\,i_{\\alpha\\beta}(t) = \\frac{1}{L}\\,v_{\\alpha\\beta}[k]$$\n这是一个非齐次一阶线性常系数常微分方程。我们可以使用积分因子法来求解。让我们为该间隔定义一个局部时间变量 $\\tau = t - kT_{\\mathrm{s}}$，其范围从 $\\tau=0$ 到 $\\tau=T_{\\mathrm{s}}$。初始条件为 $i_{\\alpha\\beta}(\\tau=0) = i_{\\alpha\\beta}[k]$。用 $\\tau$ 表示的常微分方程为：\n$$\\frac{d i_{\\alpha\\beta}(\\tau)}{d\\tau} + \\frac{R}{L}\\,i_{\\alpha\\beta}(\\tau) = \\frac{1}{L}\\,v_{\\alpha\\beta}[k]$$\n积分因子 $\\mu(\\tau)$ 由下式给出：\n$$\\mu(\\tau) = \\exp\\left(\\int \\frac{R}{L} \\,d\\tau\\right) = \\exp\\left(\\frac{R}{L}\\tau\\right)$$\n将常微分方程两边乘以该积分因子得到：\n$$\\exp\\left(\\frac{R}{L}\\tau\\right) \\frac{d i_{\\alpha\\beta}(\\tau)}{d\\tau} + \\frac{R}{L}\\exp\\left(\\frac{R}{L}\\tau\\right) i_{\\alpha\\beta}(\\tau) = \\frac{1}{L} v_{\\alpha\\beta}[k] \\exp\\left(\\frac{R}{L}\\tau\\right)$$\n方程左侧是一个全微分：\n$$\\frac{d}{d\\tau}\\left(i_{\\alpha\\beta}(\\tau)\\,\\exp\\left(\\frac{R}{L}\\tau\\right)\\right) = \\frac{1}{L} v_{\\alpha\\beta}[k] \\exp\\left(\\frac{R}{L}\\tau\\right)$$\n现在，我们将两边从 $\\tau=0$ 到 $\\tau=T_{\\mathrm{s}}$ 对 $\\tau$ 进行积分：\n$$\\int_{0}^{T_{\\mathrm{s}}} \\frac{d}{d\\tau}\\left(i_{\\alpha\\beta}(\\tau)\\,\\exp\\left(\\frac{R}{L}\\tau\\right)\\right) d\\tau = \\int_{0}^{T_{\\mathrm{s}}} \\frac{1}{L} v_{\\alpha\\beta}[k] \\exp\\left(\\frac{R}{L}\\tau\\right) d\\tau$$\n使用微积分基本定理计算左侧：\n$$\\left[ i_{\\alpha\\beta}(\\tau)\\,\\exp\\left(\\frac{R}{L}\\tau\\right) \\right]_{0}^{T_{\\mathrm{s}}} = i_{\\alpha\\beta}(T_{\\mathrm{s}})\\,\\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - i_{\\alpha\\beta}(0)\\,\\exp(0)$$\n代入 $i_{\\alpha\\beta}(T_{\\mathrm{s}}) = i_{\\alpha\\beta}[k+1]$ 和 $i_{\\alpha\\beta}(0) = i_{\\alpha\\beta}[k]$：\n$$i_{\\alpha\\beta}[k+1]\\,\\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - i_{\\alpha\\beta}[k]$$\n计算右侧积分，注意到 $v_{\\alpha\\beta}[k]$ 和 $L$ 是常数：\n$$\\frac{v_{\\alpha\\beta}[k]}{L} \\int_{0}^{T_{\\mathrm{s}}} \\exp\\left(\\frac{R}{L}\\tau\\right) d\\tau = \\frac{v_{\\alpha\\beta}[k]}{L} \\left[ \\frac{L}{R} \\exp\\left(\\frac{R}{L}\\tau\\right) \\right]_{0}^{T_{\\mathrm{s}}} = \\frac{v_{\\alpha\\beta}[k]}{R} \\left( \\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - \\exp(0) \\right) = \\frac{v_{\\alpha\\beta}[k]}{R} \\left( \\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - 1 \\right)$$\n令两个结果相等：\n$$i_{\\alpha\\beta}[k+1]\\,\\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - i_{\\alpha\\beta}[k] = \\frac{v_{\\alpha\\beta}[k]}{R} \\left( \\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - 1 \\right)$$\n为了求得 $i_{\\alpha\\beta}[k+1]$ 的显式表达式，我们首先将 $i_{\\alpha\\beta}[k]$ 加到等式两边，然后整个方程乘以 $\\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)$：\n$$i_{\\alpha\\beta}[k+1] = i_{\\alpha\\beta}[k]\\,\\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right) + \\frac{v_{\\alpha\\beta}[k]}{R} \\left( \\exp\\left(\\frac{R T_{\\mathrm{s}}}{L}\\right) - 1 \\right) \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)$$\n$$i_{\\alpha\\beta}[k+1] = \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\,i_{\\alpha\\beta}[k] + \\frac{v_{\\alpha\\beta}[k]}{R} \\left( 1 - \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right) \\right)$$\n这就是精确的离散时间模型。最后一步是代入给定的电压矢量 $v_{\\alpha\\beta}[k]$ 的表达式：\n$$v_{\\alpha\\beta}[k] = \\frac{2}{3}\\,V_{\\mathrm{dc}}\\left(S_a + S_b\\,\\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{3}\\right) + S_c\\,\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{3}\\right)\\right)$$\n将此式代入我们推导出的 $i_{\\alpha\\beta}[k+1]$ 方程，得到最终表达式：\n$$i_{\\alpha\\beta}[k+1] = \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\,i_{\\alpha\\beta}[k] + \\frac{1}{R}\\left(1 - \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\right) \\left[ \\frac{2}{3}\\,V_{\\mathrm{dc}}\\left(S_a + S_b\\,\\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{3}\\right) + S_c\\,\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{3}\\right)\\right) \\right]$$\n合并常数项，得到闭式解：\n$$i_{\\alpha\\beta}[k+1] = \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\,i_{\\alpha\\beta}[k] + \\frac{2 V_{\\mathrm{dc}}}{3R}\\left(1 - \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\right) \\left(S_a + S_b\\,\\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{3}\\right) + S_c\\,\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{3}\\right)\\right)$$\n该表达式根据电流矢量的当前值、系统参数和施加的开关状态，给出了其精确的单步预测。",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right) i_{\\alpha\\beta}[k] + \\frac{2 V_{\\mathrm{dc}}}{3R} \\left(1 - \\exp\\left(-\\frac{R T_{\\mathrm{s}}}{L}\\right)\\right) \\left(S_a + S_b \\exp\\left(\\mathrm{j}\\frac{2\\pi}{3}\\right) + S_c \\exp\\left(-\\mathrm{j}\\frac{2\\pi}{3}\\right)\\right)}\n$$"
        },
        {
            "introduction": "拥有了预测模型后，控制器需要在每个采样周期从有限的开关状态集合中选择最优的一个。这个选择过程是通过最小化一个预定义的成本函数来完成的，该函数量化了控制目标。本练习模拟了有限控制集模型预测控制（FCS-MPC）的核心决策过程，你需要评估包含电流跟踪误差和开关损耗惩罚的成本函数，以确定最佳的开关状态。",
            "id": "3858825",
            "problem": "一个三相两电平电压源逆变器为一个在静止正交坐标系中建模的平衡阻感负载供电。设经Clarke变换后的电流为在采样时刻 $k$ 测得的静止正交矢量 $\\mathbf{i}_k = (i_{\\alpha,k}, i_{\\beta,k})$，参考电流为 $\\mathbf{i}_{\\mathrm{ref}} = (i_{\\alpha,\\mathrm{ref}}, i_{\\beta,\\mathrm{ref}})$。负载由基尔霍夫电压定律和电感定律建模为 $\\mathbf{v} - R\\,\\mathbf{i} = L\\,\\frac{d\\mathbf{i}}{dt}$，其中 $\\mathbf{v}$ 是静止正交坐标系中的逆变器输出电压，$R$ 是相电阻，$L$ 是相电感。\n\n在有限控制集模型预测控制 (FCS-MPC) 中，对于每个候选开关状态，通过前向欧拉离散化计算预测值 $\\mathbf{i}_{k+1}(\\mathbf{v}) = \\mathbf{i}_k + \\frac{T_s}{L}\\left(\\mathbf{v} - R\\,\\mathbf{i}_k\\right)$，采样周期为 $T_s$。两电平逆变器有八个开关状态，索引为 $s \\in \\{0,1,2,3,4,5,6,7\\}$，其比特三元组 $(s_a,s_b,s_c) \\in \\{0,1\\}^3$ 排序如下：$s=0:(0,0,0)$, $s=1:(1,0,0)$, $s=2:(1,1,0)$, $s=3:(0,1,0)$, $s=4:(0,1,1)$, $s=5:(0,0,1)$, $s=6:(1,0,1)$, $s=7:(1,1,1)$。由逆变器产生的静止正交电压矢量定义为\n- 对于有效状态 $s \\in \\{1,2,3,4,5,6\\}$：$\\mathbf{v}_s = \\left(\\frac{2}{3}V_{\\mathrm{dc}}\\cos\\theta_s,\\,\\frac{2}{3}V_{\\mathrm{dc}}\\sin\\theta_s\\right)$，其中 $\\theta_s = (s-1)\\frac{\\pi}{3}$ (角度以弧度为单位)，\n- 对于零状态 $s \\in \\{0,7\\}$：$\\mathbf{v}_s = (0,0)$，\n其中 $V_{\\mathrm{dc}}$ 是直流 (DC) 母线电压。\n\nFCS-MPC 的级成本为\n$$\ng(s) \\;=\\; \\left\\|\\mathbf{i}_{k+1}(\\mathbf{v}_s) - \\mathbf{i}_{\\mathrm{ref}}\\right\\|_2^2 \\;+\\; \\lambda_{\\mathrm{sw}}\\,N_{\\mathrm{sw}}(s_{\\mathrm{prev}}, s),\n$$\n其中 $N_{\\mathrm{sw}}(s_{\\mathrm{prev}}, s)$ 是前一个开关状态 $s_{\\mathrm{prev}}$ 与候选状态 $s$ 之间的汉明距离（即桥臂跃迁次数），$\\lambda_{\\mathrm{sw}}$ 是一个开关惩罚权重，其单位与误差平方项的单位一致。\n\n给定以下数值数据：\n- $V_{\\mathrm{dc}} = 600\\,\\mathrm{V}$，\n- $L = 2.0\\times 10^{-3}\\,\\mathrm{H}$，\n- $R = 0.20\\,\\Omega$，\n- $T_s = 5.0\\times 10^{-5}\\,\\mathrm{s}$，\n- $\\mathbf{i}_k = (20.0\\,\\mathrm{A},\\,0.0\\,\\mathrm{A})$，\n- $\\mathbf{i}_{\\mathrm{ref}} = (25.0\\,\\mathrm{A},\\,5.0\\,\\mathrm{A})$，\n- $s_{\\mathrm{prev}} = 2$，\n- $\\lambda_{\\mathrm{sw}} = 10.0\\,\\mathrm{A}^2$ 每桥臂跃迁，\n\n计算使 $g(s)$ 最小化的索引 $s^\\star \\in \\{0,1,2,3,4,5,6,7\\}$。将您的最终答案表示为单个整数索引 $s^\\star$。无需四舍五入。角度以弧度为单位。",
            "solution": "该问题要求找到最优开关状态索引 $s^\\star$，该索引使得应用于三相两电平电压源逆变器的有限控制集模型预测控制 (FCS-MPC) 算法的给定成本函数 $g(s)$ 最小化。最优状态是指在所有八个可能的开关状态 $s \\in \\{0, 1, 2, 3, 4, 5, 6, 7\\}$ 中，成本函数 $g(s)$ 具有最小值的状态。\n\n成本函数由下式给出：\n$$\ng(s) = \\left\\|\\mathbf{i}_{k+1}(\\mathbf{v}_s) - \\mathbf{i}_{\\mathrm{ref}}\\right\\|_2^2 + \\lambda_{\\mathrm{sw}} N_{\\mathrm{sw}}(s_{\\mathrm{prev}}, s)\n$$\n其中 $\\mathbf{i}_{k+1}(\\mathbf{v}_s)$ 是下一个采样时刻的预测电流矢量，$\\mathbf{i}_{\\mathrm{ref}}$ 是参考电流矢量，$\\lambda_{\\mathrm{sw}}$ 是开关惩罚权重，而 $N_{\\mathrm{sw}}(s_{\\mathrm{prev}}, s)$ 是从上一个状态 $s_{\\mathrm{prev}}$ 到候选状态 $s$ 的桥臂跃迁次数。\n\n电流的预测基于负载模型的前向欧拉离散化：\n$$\n\\mathbf{i}_{k+1}(\\mathbf{v}_s) = \\mathbf{i}_k + \\frac{T_s}{L}\\left(\\mathbf{v}_s - R\\,\\mathbf{i}_k\\right)\n$$\n这可以重新整理成更便于计算的形式：\n$$\n\\mathbf{i}_{k+1}(\\mathbf{v}_s) = \\left(1 - \\frac{R T_s}{L}\\right)\\mathbf{i}_k + \\frac{T_s}{L}\\mathbf{v}_s\n$$\n首先，我们代入给定的数值并计算常数系数。\n-   $R = 0.20\\,\\Omega$\n-   $L = 2.0 \\times 10^{-3}\\,\\mathrm{H}$\n-   $T_s = 5.0 \\times 10^{-5}\\,\\mathrm{s}$\n-   $\\mathbf{i}_k = (20.0, 0.0)$\n\n系数为：\n$$\n\\frac{T_s}{L} = \\frac{5.0 \\times 10^{-5}}{2.0 \\times 10^{-3}} = 0.025\\,\\mathrm{s/H}\n$$\n$$\n1 - \\frac{R T_s}{L} = 1 - (0.20) \\cdot (0.025) = 1 - 0.005 = 0.995\n$$\n将这些值和 $\\mathbf{i}_k$ 代入预测方程：\n$$\n\\mathbf{i}_{k+1}(\\mathbf{v}_s) = 0.995 \\cdot (20.0, 0.0) + 0.025 \\cdot \\mathbf{v}_s = (19.9, 0.0) + 0.025 \\cdot \\mathbf{v}_s\n$$\n成本函数的第一项是误差矢量 $\\mathbf{e}_s = \\mathbf{i}_{k+1}(\\mathbf{v}_s) - \\mathbf{i}_{\\mathrm{ref}}$ 的平方范数。\n给定 $\\mathbf{i}_{\\mathrm{ref}} = (25.0, 5.0)$，误差矢量为：\n$$\n\\mathbf{e}_s = (19.9, 0.0) + 0.025 \\cdot \\mathbf{v}_s - (25.0, 5.0) = (-5.1, -5.0) + 0.025 \\cdot \\mathbf{v}_s\n$$\n接下来，我们计算每个开关状态 $s$ 的逆变器输出电压矢量 $\\mathbf{v}_s$。给定 $V_{\\mathrm{dc}} = 600\\,\\mathrm{V}$：\n有效电压矢量的幅值为 $\\frac{2}{3}V_{\\mathrm{dc}} = \\frac{2}{3}(600) = 400\\,\\mathrm{V}$。\n-   对于零状态 $s \\in \\{0, 7\\}$：$\\mathbf{v}_0 = \\mathbf{v}_7 = (0, 0)\\,\\mathrm{V}$。\n-   对于有效状态 $s \\in \\{1, 2, 3, 4, 5, 6\\}$，$\\mathbf{v}_s = (400\\cos\\theta_s, 400\\sin\\theta_s)$，其中 $\\theta_s = (s-1)\\frac{\\pi}{3}$。\n    -   $s=1$: $\\theta_1 = 0 \\implies \\mathbf{v}_1 = (400, 0)\\,\\mathrm{V}$。\n    -   $s=2$: $\\theta_2 = \\frac{\\pi}{3} \\implies \\mathbf{v}_2 = (400\\cos(\\frac{\\pi}{3}), 400\\sin(\\frac{\\pi}{3})) = (200, 200\\sqrt{3})\\,\\mathrm{V}$。\n    -   $s=3$: $\\theta_3 = \\frac{2\\pi}{3} \\implies \\mathbf{v}_3 = (400\\cos(\\frac{2\\pi}{3}), 400\\sin(\\frac{2\\pi}{3})) = (-200, 200\\sqrt{3})\\,\\mathrm{V}$。\n    -   $s=4$: $\\theta_4 = \\pi \\implies \\mathbf{v}_4 = (-400, 0)\\,\\mathrm{V}$。\n    -   $s=5$: $\\theta_5 = \\frac{4\\pi}{3} \\implies \\mathbf{v}_5 = (400\\cos(\\frac{4\\pi}{3}), 400\\sin(\\frac{4\\pi}{3})) = (-200, -200\\sqrt{3})\\,\\mathrm{V}$。\n    -   $s=6$: $\\theta_6 = \\frac{5\\pi}{3} \\implies \\mathbf{v}_6 = (400\\cos(\\frac{5\\pi}{3}), 400\\sin(\\frac{5\\pi}{3})) = (200, -200\\sqrt{3})\\,\\mathrm{V}$。\n\n成本函数的第二项是开关惩罚 $\\lambda_{\\mathrm{sw}} N_{\\mathrm{sw}}(s_{\\mathrm{prev}}, s)$。给定 $s_{\\mathrm{prev}} = 2$ 和 $\\lambda_{\\mathrm{sw}} = 10.0\\,\\mathrm{A}^2$，我们计算每个状态 $s$ 的汉明距离 $N_{\\mathrm{sw}}(2, s)$。$s_{\\mathrm{prev}}=2$ 的比特表示是 $(1,1,0)$。\n-   $s=0$: $(0,0,0) \\implies N_{\\mathrm{sw}}(2,0)=2$。成本：$10.0 \\cdot 2 = 20.0$。\n-   $s=1$: $(1,0,0) \\implies N_{\\mathrm{sw}}(2,1)=1$。成本：$10.0 \\cdot 1 = 10.0$。\n-   $s=2$: $(1,1,0) \\implies N_{\\mathrm{sw}}(2,2)=0$。成本：$10.0 \\cdot 0 = 0.0$。\n-   $s=3$: $(0,1,0) \\implies N_{\\mathrm{sw}}(2,3)=1$。成本：$10.0 \\cdot 1 = 10.0$。\n-   $s=4$: $(0,1,1) \\implies N_{\\mathrm{sw}}(2,4)=2$。成本：$10.0 \\cdot 2 = 20.0$。\n-   $s=5$: $(0,0,1) \\implies N_{\\mathrm{sw}}(2,5)=3$。成本：$10.0 \\cdot 3 = 30.0$。\n-   $s=6$: $(1,0,1) \\implies N_{\\mathrm{sw}}(2,6)=2$。成本：$10.0 \\cdot 2 = 20.0$。\n-   $s=7$: $(1,1,1) \\implies N_{\\mathrm{sw}}(2,7)=1$。成本：$10.0 \\cdot 1 = 10.0$。\n\n现在我们评估每个状态的总成本 $g(s)$。所有值的单位都是 $\\mathrm{A}^2$。\n\n-   **状态 $s=0$**: $\\mathbf{v}_0 = (0,0)$。\n    $\\mathbf{e}_0 = (-5.1, -5.0)$。\n    $g(0) = \\|(-5.1, -5.0)\\|_2^2 + 20.0 = (-5.1)^2 + (-5.0)^2 + 20.0 = 26.01 + 25.0 + 20.0 = 71.01$。\n\n-   **状态 $s=1$**: $0.025 \\cdot \\mathbf{v}_1 = 0.025 \\cdot (400,0) = (10.0, 0.0)$。\n    $\\mathbf{e}_1 = (-5.1, -5.0) + (10.0, 0.0) = (4.9, -5.0)$。\n    $g(1) = \\|(4.9, -5.0)\\|_2^2 + 10.0 = (4.9)^2 + (-5.0)^2 + 10.0 = 24.01 + 25.0 + 10.0 = 59.01$。\n\n-   **状态 $s=2$**: $0.025 \\cdot \\mathbf{v}_2 = 0.025 \\cdot (200, 200\\sqrt{3}) = (5.0, 5.0\\sqrt{3})$。\n    $\\mathbf{e}_2 = (-5.1, -5.0) + (5.0, 5.0\\sqrt{3}) = (-0.1, -5.0 + 5.0\\sqrt{3})$。\n    $g(2) = \\|(-0.1, -5.0+5.0\\sqrt{3})\\|_2^2 + 0.0 = (-0.1)^2 + (-5.0+5.0\\sqrt{3})^2 = 0.01 + (25.0 - 50.0\\sqrt{3} + 75.0) = 100.01 - 50.0\\sqrt{3} \\approx 100.01 - 86.60 = 13.41$。\n\n-   **状态 $s=3$**: $0.025 \\cdot \\mathbf{v}_3 = 0.025 \\cdot (-200, 200\\sqrt{3}) = (-5.0, 5.0\\sqrt{3})$。\n    $\\mathbf{e}_3 = (-5.1, -5.0) + (-5.0, 5.0\\sqrt{3}) = (-10.1, -5.0 + 5.0\\sqrt{3})$。\n    $g(3) = \\|(-10.1, -5.0+5.0\\sqrt{3})\\|_2^2 + 10.0 = (-10.1)^2 + (-5.0+5.0\\sqrt{3})^2 + 10.0 = 102.01 + (100.0 - 50.0\\sqrt{3}) + 10.0 = 212.01 - 50.0\\sqrt{3} \\approx 212.01 - 86.60 = 125.41$。\n\n-   **状态 $s=4$**: $0.025 \\cdot \\mathbf{v}_4 = 0.025 \\cdot (-400,0) = (-10.0, 0.0)$。\n    $\\mathbf{e}_4 = (-5.1, -5.0) + (-10.0, 0.0) = (-15.1, -5.0)$。\n    $g(4) = \\|(-15.1, -5.0)\\|_2^2 + 20.0 = (-15.1)^2 + (-5.0)^2 + 20.0 = 228.01 + 25.0 + 20.0 = 273.01$。\n\n-   **状态 $s=5$**: $0.025 \\cdot \\mathbf{v}_5 = 0.025 \\cdot (-200, -200\\sqrt{3}) = (-5.0, -5.0\\sqrt{3})$。\n    $\\mathbf{e}_5 = (-5.1, -5.0) + (-5.0, -5.0\\sqrt{3}) = (-10.1, -5.0 - 5.0\\sqrt{3})$。\n    $g(5) = \\|(-10.1, -5.0-5.0\\sqrt{3})\\|_2^2 + 30.0 = (-10.1)^2 + (-5.0-5.0\\sqrt{3})^2 + 30.0 = 102.01 + (25.0 + 50.0\\sqrt{3} + 75.0) + 30.0 = 232.01 + 50.0\\sqrt{3} \\approx 232.01 + 86.60 = 318.61$。\n\n-   **状态 $s=6$**: $0.025 \\cdot \\mathbf{v}_6 = 0.025 \\cdot (200, -200\\sqrt{3}) = (5.0, -5.0\\sqrt{3})$。\n    $\\mathbf{e}_6 = (-5.1, -5.0) + (5.0, -5.0\\sqrt{3}) = (-0.1, -5.0 - 5.0\\sqrt{3})$。\n    $g(6) = \\|(-0.1, -5.0-5.0\\sqrt{3})\\|_2^2 + 20.0 = (-0.1)^2 + (-5.0-5.0\\sqrt{3})^2 + 20.0 = 0.01 + (25.0 + 50.0\\sqrt{3} + 75.0) + 20.0 = 120.01 + 50.0\\sqrt{3} \\approx 120.01 + 86.60 = 206.61$。\n\n-   **状态 $s=7$**: $\\mathbf{v}_7 = (0,0)$。\n    $\\mathbf{e}_7 = (-5.1, -5.0)$。\n    $g(7) = \\|(-5.1, -5.0)\\|_2^2 + 10.0 = (-5.1)^2 + (-5.0)^2 + 10.0 = 26.01 + 25.0 + 10.0 = 61.01$。\n\n成本总结：\n-   $g(0) \\approx 71.01$\n-   $g(1) \\approx 59.01$\n-   $g(2) \\approx 13.41$\n-   $g(3) \\approx 125.41$\n-   $g(4) \\approx 273.01$\n-   $g(5) \\approx 318.61$\n-   $g(6) \\approx 206.61$\n-   $g(7) \\approx 61.01$\n\n通过比较所有可能状态的 $g(s)$ 值，最小成本是 $g(2) \\approx 13.41$。因此，最优开关状态索引是 $s^\\star = 2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "从理论走向实践，我们必须面对数字控制系统中的固有挑战，其中最常见的就是计算延迟。由于从测量到执行存在时间差，控制器必须基于一个略微“过时”的信息进行决策，这可能导致性能下降。本练习展示了如何利用MPC的预测能力来有效补偿这种一步计算延迟，通过“向前多看一步”来确保控制决策的准确性和及时性。",
            "id": "3858844",
            "problem": "考虑一个两电平电压源逆变器（VSI）的单相桥臂，驱动一个串联的电阻-电感负载。设电感电流为状态，用 $i(t)$ 表示；施加的逆变器极电压为控制输入，用 $u(t) \\in \\{-V_{\\mathrm{dc}}, V_{\\mathrm{dc}}\\}$ 表示，其中 $V_{\\mathrm{dc}}$ 是直流母线电压。负载参数为电阻 $R > 0$ 和电感 $L > 0$。连续时间对象动态特性由以下经过充分验证的电磁关系式给出\n$$\nL\\,\\frac{d i(t)}{dt} \\;=\\; -R\\,i(t) + u(t).\n$$\n在零阶保持器（ZOH）假设下，采样与开关同步进行：在每个持续时间为 $T_{s} > 0$ 的采样区间内，控制输入保持恒定。由于模型预测控制（MPC）实现中存在单步计算延迟，在采样点 $k$ 计算出的控制决策并不会在区间 $[k T_{s}, (k+1)T_{s})$ 上施加；而是在区间 $[k T_{s}, (k+1)T_{s})$ 上施加先前计算的控制 $u_{k-1}$，新计算的 $u_{k}$ 则在区间 $[(k+1)T_{s}, (k+2)T_{s})$ 上施加。\n\n请严格从上述连续时间对象方程和 ZOH 采样假设出发，不使用任何快捷公式，推导一种延迟补偿方法，该方法利用预测状态来评估候选控制 $u_{k}$ 在存在单步计算延迟情况下的效果。具体来说，请根据采样电流 $i_{k}$、先前施加的控制 $u_{k-1}$、候选控制 $u_{k}$ 以及物理参数 $R$、$L$ 和 $T_{s}$，求出两步超前预测电流 $i_{k+2|k}$ 的闭式解析表达式。假设开关是理想的，且不存在测量或建模噪声。此外，请定性解释与忽略计算延迟的简单单步超前预测相比，使用这种补偿后的两步超前预测如何影响预测精度。\n\n将最终答案表示为 $i_{k+2|k}$ 的一个单一闭式解析表达式，不进行任何数值代入。",
            "solution": "本任务是为一个由电压源控制且存在单步计算延迟的串联 RL 电路，推导其两步超前预测电流 $i_{k+2|k}$ 的闭式表达式。推导必须从基本的连续时间微分方程开始。\n\n电感电流 $i(t)$ 的连续时间动态特性由以下一阶线性常微分方程（ODE）给出：\n$$L\\frac{d i(t)}{dt} = -R i(t) + u(t)$$\n该方程可以改写为标准形式：\n$$\\frac{d i(t)}{dt} + \\frac{R}{L}i(t) = \\frac{1}{L}u(t)$$\n题目指出，在每个持续时间为 $T_s$ 的采样区间内，控制输入 $u(t)$ 是恒定的（零阶保持器假设）。对于从 $t_0$ 开始、初始条件为 $i(t_0)$ 且在区间 $[t_0, t_f]$ 上施加恒定输入 $u$ 的情况，该常微分方程的通解为：\n$$i(t_f) = i(t_0) \\exp\\left(-\\frac{R}{L}(t_f - t_0)\\right) + \\frac{u}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}(t_f - t_0)\\right)\\right)$$\n此公式给出了状态的精确离散化演变过程。我们将依次在两个采样区间上应用此解，以考虑计算延迟。\n\n步骤 1：从时间 $t=kT_s$ 到 $t=(k+1)T_s$ 的预测。\n在采样时刻 $k$，测量的电流为 $i_k = i(kT_s)$。由于存在单步计算延迟，在区间 $[kT_s, (k+1)T_s)$ 内施加的控制输入不是新计算的 $u_k$，而是先前计算的 $u_{k-1}$。\n我们应用通解，参数如下：\n- 初始时间：$t_0 = kT_s$\n- 最终时间：$t_f = (k+1)T_s$\n- 区间持续时间：$t_f - t_0 = T_s$\n- 初始条件：$i(t_0) = i_k$\n- 恒定控制输入：$u = u_{k-1}$\n\n设 $i_{k+1}$ 表示时间 $t=(k+1)T_s$ 时的电流。将这些值代入通解，得到第一个区间结束时的状态：\n$$i_{k+1} = i_k \\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{u_{k-1}}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)$$\n这个值 $i_{k+1}$ 是电流的单步超前预测值 $i_{k+1|k}$，它将作为下一步预测的初始条件。\n\n步骤 2：从时间 $t=(k+1)T_s$ 到 $t=(k+2)T_s$ 的预测。\n在时刻 $k$ 新计算的控制作用 $u_k$ 将在区间 $[(k+1)T_s, (k+2)T_s)$ 内施加。为了找出该控制作用的效果，我们将状态再向前预测一步。\n我们再次应用通解，参数更新如下：\n- 初始时间：$t_0 = (k+1)T_s$\n- 最终时间：$t_f = (k+2)T_s$\n- 区间持续时间：$t_f - t_0 = T_s$\n- 初始条件：$i(t_0) = i_{k+1}$（来自步骤 1）\n- 恒定控制输入：$u = u_k$\n\n在时间 $t=(k+2)T_s$ 时的预测电流，即所求量 $i_{k+2|k}$，为：\n$$i_{k+2|k} = i_{k+1} \\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{u_k}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)$$\n为了得到用时刻 $k$ 的已知量（$i_k$，$u_{k-1}$）和候选控制 $u_k$ 表示的最终表达式，我们将步骤 1 中 $i_{k+1}$ 的表达式代入上述方程：\n$$i_{k+2|k} = \\left[ i_k \\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{u_{k-1}}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right) \\right] \\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{u_k}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)$$\n我们将项 $\\exp\\left(-\\frac{R}{L}T_s\\right)$ 展开：\n$$i_{k+2|k} = i_k \\exp\\left(-2\\frac{R}{L}T_s\\right) + \\frac{u_{k-1}}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)\\exp\\left(-\\frac{R}{L}T_s\\right) + \\frac{u_k}{R}\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)$$\n通过提取公因式 $\\left(1 - \\exp\\left(-\\frac{R}{L}T_s\\right)\\right)/R$，可以简化表达式：\n$$i_{k+2|k} = i_k \\exp\\left(-2\\frac{R}{L}T_s\\right) + \\frac{1 - \\exp\\left(-\\frac{R}{L}T_s\\right)}{R} \\left( u_{k-1}\\exp\\left(-\\frac{R}{L}T_s\\right) + u_k \\right)$$\n这就是正确补偿了单步计算延迟的两步超前预测电流的闭式解析表达式。\n\n关于对预测精度的定性影响，一种“简单”的预测会忽略该延迟，并错误地假设候选控制 $u_k$ 在区间 $[kT_s, (k+1)T_s)$ 内施加。MPC 控制器会因此基于一个不准确的系统响应模型做出决策，提前一步评估了 $u_k$ 的效果。预测行为与实际系统行为之间的这种不匹配会导致次优的控制作用，可能表现为较差的参考跟踪性能、振荡和稳定性降低。\n\n通过使用推导出的补偿后的两步超前预测 $i_{k+2|k}$，控制器能够正确地考虑延迟。它能认识到其决策 $u_k$ 直到区间 $[(k+1)T_s, (k+2)T_s)$ 才会影响系统状态。通过向前预测两步，MPC 的成本函数能够评估控制作用 $u_k$ 真实的未来影响。这使得优化过程与延迟系统的物理现实相符。因此，预测精度得到了极大提高，因为预测模型现在是系统动态（包括延迟）的精确表示。这会带来显著改善的控制性能和稳定性，因为控制器可以做出时机恰当的决策来有效地引导系统状态。",
            "answer": "$$\\boxed{i_k \\exp\\left(-2\\frac{R}{L}T_s\\right) + \\frac{1 - \\exp\\left(-\\frac{R}{L}T_s\\right)}{R} \\left( u_{k-1}\\exp\\left(-\\frac{R}{L}T_s\\right) + u_k \\right)}$$"
        }
    ]
}