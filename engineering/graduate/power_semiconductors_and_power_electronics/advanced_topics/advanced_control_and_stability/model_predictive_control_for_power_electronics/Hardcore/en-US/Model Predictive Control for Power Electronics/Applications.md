## Applications and Interdisciplinary Connections

The preceding chapters have established the fundamental principles and mechanisms of Model Predictive Control. While the core theory is elegant and self-contained, the true power and utility of MPC are most vividly demonstrated through its application to complex, real-world problems. This chapter explores the versatility of MPC by examining its implementation across a diverse range of power electronic systems and its connections to other scientific and engineering disciplines. We will demonstrate how the core tenets of MPC—the use of a system model for prediction, the optimization of a cost function over a [receding horizon](@entry_id:181425), and the explicit handling of constraints—provide a unified and powerful framework for solving challenges that are often intractable for classical control methods.

### Control of DC-DC Converters

The application of MPC to DC-DC converters provides a clear illustration of its fundamental capabilities. The primary control objective for these converters is typically the regulation of the output voltage to a desired reference value, $v_{\mathrm{ref}}$, while simultaneously ensuring that system variables, such as inductor current, remain within safe operational limits.

A key strength of MPC is its ability to create a single, unified control law that respects multiple, often competing, objectives and constraints. Consider the challenge of designing a controller that is universally applicable to different converter topologies, such as buck, boost, and buck-boost converters. While the underlying dynamics of these converters differ, a properly formulated MPC cost function can address them all. This is achieved by defining the cost function in terms of the final output voltage, $v_o$, which may be a direct state variable (e.g., the capacitor voltage $v_C$ in a buck converter) or a function of a state variable (e.g., $-v_C$ in an inverting [buck-boost converter](@entry_id:270314)). Furthermore, to ensure robustness and maintain feasibility of the optimization problem during large transients, operational constraints like inductor current limits ($i_{\min} \le i_L \le i_{\max}$) can be implemented as soft constraints. This involves introducing [slack variables](@entry_id:268374) into the constraints and penalizing them heavily in the cost function, ensuring the limits are respected whenever possible but allowing for momentary, small violations to prevent controller failure. 

Moving from averaged-value MPC to the control of the discrete switching action itself, Finite Control Set MPC (FCS-MPC) evaluates the outcome of each possible switching state at every sampling instant. For a buck converter with a binary control input $u_k \in \{0, 1\}$, the controller predicts the next-step state $x_{k+1}$ for both $u_k=0$ and $u_k=1$. The success of this strategy hinges on two critical components: the accuracy of the prediction model and the method of constraint handling. Using an exact discrete-time model derived from a Zero-Order Hold (ZOH) assumption provides superior accuracy over simpler forward Euler approximations. To *guarantee* that constraints such as inductor current limits are met, hard constraints must be used. This involves defining a feasible set of control actions—those that result in a predicted state within the allowed bounds—and optimizing the cost function only over this set. A robust FCS-MPC formulation must also explicitly handle the case of infeasibility, where no available control action satisfies the constraints, defining a safe fallback action. 

### Advanced Control of Electric Motor Drives

The control of electric motor drives is a domain where MPC excels, offering superior dynamic performance by directly handling the multivariable, nonlinear, and constrained nature of electromechanical systems. For a Permanent Magnet Synchronous Machine (PMSM), FCS-MPC can be formulated in several ways, with the two most prominent being Predictive Current Control (PCC) and Predictive Torque Control (PTC).

Predictive Current Control (PCC) aligns with traditional [field-oriented control](@entry_id:1124931) by defining its primary objective as tracking reference currents in the synchronously rotating $d-q$ reference frame, $(i_d^{\star}, i_q^{\star})$. The cost function is typically a weighted sum of the squared errors of the predicted $d$-axis and $q$-axis currents. In contrast, Predictive Torque Control (PTC) bypasses the intermediate current loops and defines its objectives in terms of the mechanical output. The PTC cost function directly penalizes the error between the predicted electromagnetic torque, $\tau_e$, and its reference, $\tau_e^{\star}$. Because torque in a surface-mounted PMSM is proportional to $i_q$ ($\tau_e \propto \psi_f i_q$), this provides fast and direct torque response. To ensure stable operation, the PTC cost function must also include a term to regulate the stator flux magnitude, $|\psi_s|$. In both PCC and PTC, critical safety limits, such as a maximum stator current magnitude, must be enforced as hard constraints, while the [finite set](@entry_id:152247) of inverter voltage vectors inherently respects the voltage limits. 

The design of the cost function is a critical aspect of MPC implementation. For PTC, a well-designed cost function must balance the competing objectives of torque tracking, flux regulation, and minimizing switching frequency. To combine these physically distinct quantities into a single scalar cost, normalization is essential. A robust approach is to formulate a dimensionless cost function where each term represents a normalized, squared error. For instance, the torque [tracking error](@entry_id:273267) $(T_e - T_{\mathrm{ref}})$ is normalized by the reference torque $T_{\mathrm{ref}}$ (or a base value), and the flux magnitude error $(|\psi_s| - \psi_{\mathrm{ref}})$ is normalized by the reference flux $\psi_{\mathrm{ref}}$. The switching penalty, which counts the number of phase leg commutations, is inherently dimensionless. This normalization ensures that the user-defined weights ($\lambda_T, \lambda_{\psi}, \lambda_{\mathrm{sw}}$) are also dimensionless and represent the true relative importance of each control objective, independent of the operating point or physical units. 

### Grid-Connected Converters: Integration and Stability

As power electronics become increasingly central to the interface between renewable energy sources and the utility grid, MPC offers powerful tools to ensure stable and compliant operation. This is particularly evident in the control of grid-connected inverters with high-order output filters and in the implementation of advanced grid-support functions.

#### LCL Filter Control and Active Damping

Grid-tied inverters often employ LCL filters to achieve high levels of harmonic attenuation. However, these third-order filters introduce a resonant frequency that is typically lightly damped, posing a significant stability challenge. MPC provides an elegant framework for implementing [active damping](@entry_id:167814) to suppress these resonances without requiring additional physical components or sensors. The key is to include terms in the MPC cost function that penalize the resonant behavior. To do this, a proper [state-space model](@entry_id:273798) of the LCL filter is first required, with states typically chosen as the inverter-side current ($i_1$), the capacitor voltage ($v_c$), and the grid-side current ($i_2$). The inverter voltage serves as the control input, and the grid voltage acts as a measurable disturbance. 

The physical quantity most indicative of resonance in an LCL filter is the capacitor current, $i_c = i_1 - i_2$. By adding a penalty on the predicted capacitor current, such as $w_c i_c^2$, to the MPC cost function, the controller is incentivized to select switching actions that inherently minimize this current, effectively damping the resonance. Since both $i_1$ and $i_2$ are typically measured for control and protection, the capacitor current can be calculated or predicted without extra sensors. More advanced, energy-based methods can also be employed. These methods define the total energy stored in the filter's reactive components and add a constraint that forces this energy to dissipate, particularly when resonant currents are high. Implementing such a scheme requires knowledge of all state variables, including the unmeasured capacitor voltage $v_c$, which can be obtained using a [state observer](@entry_id:268642) (e.g., a Kalman filter) driven by the available measurements. These [active damping](@entry_id:167814) techniques are far superior to naive approaches like simply [detuning](@entry_id:148084) the controller or making it overly aggressive, which can exacerbate instability. 

#### Handling Grid Codes and Faults

Modern grid codes mandate that inverters provide support to the grid, especially during faults like a Low-Voltage Ride-Through (LVRT) event. During such an event, an inverter must prioritize the injection of reactive current to support the grid voltage, while respecting strict hardware limits on converter voltage and total current. These requirements often conflict. MPC is exceptionally well-suited to manage such scenarios. The prioritization of reactive current ($i_q$) over active current ($i_d$) can be directly encoded in the cost function by assigning a much larger weight to the reactive current [tracking error](@entry_id:273267) ($w_q \gg w_d$). Simultaneously, the absolute physical limit on the inverter's modulation voltage must be implemented as a hard constraint ($\lVert v_{\mathrm{conv}} \rVert_2 \le V_{\max}$). To prevent the optimization from becoming infeasible when it's impossible to meet all targets, the grid-code limit on total current can be implemented as a soft constraint ($\lVert i \rVert_2 \le I_{\max} + \epsilon$). By heavily penalizing the [slack variable](@entry_id:270695) $\epsilon$, the controller ensures the current limit is respected whenever possible but prioritizes maintaining control and satisfying the hard voltage constraint over strictly adhering to the current limit in extreme conditions. 

Beyond grid support, MPC can integrate [fault detection](@entry_id:270968) and protection. A short-circuit fault, for example, will cause the physical system's behavior to deviate significantly from the controller's nominal prediction model. This deviation can be quantified by a [residual vector](@entry_id:165091), $r_k = y_k - \hat{i}_{k|k-1}$, where $y_k$ is the measured current and $\hat{i}_{k|k-1}$ is the one-step-ahead prediction. Under normal operation, the residual is dominated by [sensor noise](@entry_id:1131486). The squared norm of the residual, normalized by the noise variance, follows a chi-square ($\chi^2$) distribution. This statistical property allows for the design of a detector with a specific false-alarm probability by setting a threshold based on the [quantiles](@entry_id:178417) of the $\chi^2$ distribution. Upon detection of a fault, the MPC controller can switch its objective. Instead of tracking a power reference, it can transition to a safe shutdown trajectory, where the goal is to drive the fault current to zero as quickly as possible while respecting device constraints, such as the maximum current slew rate ($di/dt$). This demonstrates the remarkable flexibility of MPC to adapt its behavior across different operational modes, from normal operation to fault management. 

### Multilevel Converter Control

For medium- and high-voltage applications, multilevel converters are indispensable. Their application, however, introduces unique control challenges that are not present in conventional two-level converters. Extending FCS-MPC to a three-level Neutral-Point-Clamped (NPC) inverter, for instance, immediately increases the computational complexity, as the number of possible switching states grows from $2^3 = 8$ to $3^3 = 27$. More importantly, it introduces a new control objective: balancing the voltages of the split DC-link capacitors. An imbalance in these capacitor voltages, known as neutral-point voltage drift, can lead to distorted output waveforms and device failure. This drift is caused by the neutral-point current, which flows when a phase leg is connected to the DC-link midpoint. The MPC controller must therefore predict and actively manage this voltage drift, which requires adding the capacitor voltages to the state vector and the cost function. Some of the increased number of switching states are redundant, producing the same output voltage vector. These redundant states, however, often have different effects on the neutral-point current, providing the controller with extra degrees of freedom to simultaneously track the primary reference and balance the capacitor voltages. 

To effectively balance the neutral-point voltage, the MPC cost function must be formulated based on a predictive model of the capacitor voltage dynamics. The objective is to drive the predicted voltage deviation at the next time step, $v_{n,k+1}$, to zero. Therefore, a correctly formulated cost function includes a term that penalizes the square of the predicted deviation, e.g., $\lambda (v_{n,k+1})^2$. This term explicitly depends on the choice of switching state $\mathbf{u}_k$ through its effect on the predicted neutral-point current. Formulations that only penalize the current deviation $v_{n,k}$ are not predictive and have no influence on the control decision. Similarly, simply minimizing the neutral-point current magnitude, $|i_{np,k+1}|$, is suboptimal, as a non-zero current is often required to correct an existing imbalance. An incorrectly formulated cost function, such as one based on a faulty Lyapunov function, can even lead to a destabilizing action, where the controller's choice actively worsens the voltage imbalance. 

### Bridging Disciplines: From Power Electronics to Physics and System Design

The true sophistication of MPC is revealed in its ability to bridge the gap between high-level control objectives and the low-level physical constraints of components and systems. This interdisciplinary nature allows for a holistic design that respects the fundamental limits of device physics, system-level concerns like electromagnetic compatibility, and even the complex dynamics of systems far beyond conventional power electronics.

#### Constraints from Device Physics and System-Level Concerns

A power converter's performance is ultimately limited by the physical capabilities of its semiconductor devices (e.g., MOSFETs, IGBTs). The Safe Operating Area (SOA) specified in a device datasheet is a multidimensional representation of these limits. MPC can directly incorporate these constraints into its optimization problem. A polygonal approximation of the current-voltage SOA can be translated into a set of linear inequalities on the predicted device currents and voltages, which in turn become [linear constraints](@entry_id:636966) on the controller's state and input variables. More complex, non-convex boundaries, such as the constant power limit ($i_S v_S \le P_{\max}$), cannot be included directly in a convex optimization. However, they can be handled by replacing the non-convex region with a conservative convex outer approximation, for instance, a set of linear inequalities formed from [tangent lines](@entry_id:168168) to the boundary. This allows the MPC to respect the device's thermal limits in a computationally tractable manner. 

Furthermore, MPC can enforce constraints related to system-level performance and reliability. Fast-changing currents and voltages are primary sources of electromagnetic interference (EMI) and can cause damaging stresses on components. A limit on the current slew rate, $|di/dt| \le D_{\max}$, is often imposed to prevent destructive overvoltages across parasitic stray inductances ($v_{stray} = L_{stray} di/dt$). Similarly, a limit on the voltage slew rate, $|dv/dt| \le S_{\max}$, is used to bound the [common-mode current](@entry_id:1122687) flowing through parasitic capacitances ($i_{cm} \approx C_{par} dv/dt$), which is a major contributor to conducted EMI. Within the MPC framework, these derivative constraints are approximated in [discrete time](@entry_id:637509) as bounds on successive differences (e.g., $|i_{k+1} - i_k| \le D_{\max} T_s$) and are readily transformed into linear inequalities on the control inputs, seamlessly integrating device protection and EMI considerations into the control design. 

#### An Excursion into Fusion Science: Plasma Profile Control

The principles of MPC are so general that they find application in remarkably disparate fields, such as the control of nuclear fusion plasmas in tokamaks. In this domain, the "power electronic converter" is the entire tokamak, and the "currents and voltages" are complex plasma profiles, such as electron temperature $T_e(r,t)$ and density $n_e(r,t)$, distributed over space and time. The control objective is to regulate these profiles to achieve high fusion performance while avoiding catastrophic instabilities.

The operational limits of a tokamak are dictated by magnetohydrodynamic (MHD) [stability theory](@entry_id:149957). For instance, the plasma pressure is limited by a critical beta value ($\beta \le \beta_{\max}$), the density is constrained by the empirical Greenwald limit ($n_e \le n_{\mathrm{GW}}$), and the profile of the safety factor $q(r,t)$ must be controlled to avoid instabilities—most notably, the core safety factor must be kept above one ($q(0) > 1$) to prevent sawtooth crashes. These physics-based operational limits are directly analogous to the voltage and current constraints in a power converter. In an MPC framework for [plasma control](@entry_id:753487), they are translated into state [inequality constraints](@entry_id:176084) that the controller must respect over its prediction horizon. 

The dynamics of a plasma are highly nonlinear and coupled. For example, applying Electron Cyclotron Heating (ECH) directly modifies the temperature profile $T_e$. This change in temperature alters the plasma's electrical resistivity, which follows a $\eta(T_e) \propto T_e^{-3/2}$ scaling. The change in the resistivity profile, in turn, affects the diffusion rate of the [plasma current](@entry_id:182365), and thereby dynamically alters the evolution of the [safety factor profile](@entry_id:1131171), $q$. A linearized model used for MPC captures this physical cross-coupling through non-zero off-diagonal terms in its system matrix. By using this coupled model for prediction, the MPC can perform "co-optimization": it can anticipate and exploit the fact that a heating actuator can be used to indirectly manipulate a magnetic profile. This ability to predict and leverage complex, multivariable interactions is the hallmark of MPC and demonstrates its profound capability as a unifying framework for advanced control across disciplines. 