{
    "hands_on_practices": [
        {
            "introduction": "Predicting a power device's operating temperature under a continuous load is the first and most fundamental step in thermal design. Rather than relying on generic datasheet values for junction-to-ambient thermal resistance, which are specific to non-representative test conditions, a robust analysis requires constructing a model of the actual thermal path. This practice  demonstrates how to use the electro-thermal analogy to calculate the steady-state junction temperature by summing the series thermal resistances of the package, thermal interface, and heatsink, a core concept also highlighted in .",
            "id": "3852766",
            "problem": "A silicon power metal-oxide-semiconductor field-effect transistor (MOSFET) dissipates a constant steady-state power of $P=20\\,\\mathrm{W}$ while mounted to a finned aluminum heat sink through a thermal interface material. The ambient air temperature is $T_{a}=35\\,{}^{\\circ}\\mathrm{C}$. The thermal path from the semiconductor junction to ambient consists of three series sections: junction-to-case, case-to-sink, and sink-to-ambient. The manufacturer specifies the junction-to-case thermal resistance $R_{\\mathrm{th,JC}}=0.8\\,\\mathrm{K/W}$. The interface layer yields a case-to-sink thermal resistance $R_{\\mathrm{th,CS}}=0.3\\,\\mathrm{K/W}$. The installed heat sink in the given airflow produces a sink-to-ambient thermal resistance $R_{\\mathrm{th,SA}}=1.2\\,\\mathrm{K/W}$. Assume one-dimensional steady-state heat conduction along the thermal path with linear, temperature-independent properties and that all dissipated power flows from the junction to ambient through these series elements.\n\nStarting from energy conservation in steady state and the definition of thermal resistance as the ratio of temperature difference to heat flow for each section, derive the junction temperature $T_{j}$ and compute its numerical value. Express the final junction temperature in degrees Celsius and round your answer to four significant figures.",
            "solution": "The problem requires the derivation and calculation of the junction temperature, $T_{j}$, of a power MOSFET under steady-state operation. The analysis begins with the principle of energy conservation and the definition of thermal resistance.\n\nIn steady state, the heat generated by the MOSFET, which is its dissipated power $P$, must be equal to the heat flow rate from the junction to the ambient air. The problem states that all power flows through a specified thermal path, so the heat flow rate is constant and equal to $P$ through all sections of the path.\n\nThe thermal resistance, $R_{\\mathrm{th}}$, for a given thermal path is defined as the ratio of the temperature difference, $\\Delta T$, across the path to the steady heat flow rate, $P$, through it:\n$$R_{\\mathrm{th}} = \\frac{\\Delta T}{P}$$\nThis can be rearranged to express the temperature drop across a component as a function of the power dissipated and its thermal resistance:\n$$\\Delta T = P \\cdot R_{\\mathrm{th}}$$\nThis relationship is analogous to Ohm's law ($V = I \\cdot R$) in electrical circuits, where temperature ($T$) corresponds to voltage ($V$), heat flow rate ($P$) corresponds to current ($I$), and thermal resistance ($R_{\\mathrm{th}}$) corresponds to electrical resistance ($R$).\n\nThe thermal path from the MOSFET junction to the ambient air is described as three sections in series:\n$1$. Junction-to-Case, with thermal resistance $R_{\\mathrm{th,JC}}$.\n$2$. Case-to-Sink, with thermal resistance $R_{\\mathrm{th,CS}}$.\n$3$. Sink-to-Ambient, with thermal resistance $R_{\\mathrm{th,SA}}$.\n\nSince these thermal resistances are in series, the total thermal resistance from junction to ambient, $R_{\\mathrm{th,JA}}$, is the sum of the individual resistances:\n$$R_{\\mathrm{th,JA}} = R_{\\mathrm{th,JC}} + R_{\\mathrm{th,CS}} + R_{\\mathrm{th,SA}}$$\n\nThe total temperature difference between the junction ($T_{j}$) and the ambient ($T_{a}$) is the product of the total power dissipated and the total thermal resistance:\n$$\\Delta T_{\\mathrm{JA}} = T_{j} - T_{a} = P \\cdot R_{\\mathrm{th,JA}}$$\n\nTo derive the expression for the junction temperature, $T_{j}$, we substitute the expression for the total thermal resistance into the equation for the total temperature difference and solve for $T_{j}$:\n$$T_{j} - T_{a} = P \\cdot (R_{\\mathrm{th,JC}} + R_{\\mathrm{th,CS}} + R_{\\mathrm{th,SA}})$$\n$$T_{j} = T_{a} + P \\cdot (R_{\\mathrm{th,JC}} + R_{\\mathrm{th,CS}} + R_{\\mathrm{th,SA}})$$\nThis is the derived expression for the junction temperature.\n\nNow, we substitute the numerical values provided in the problem statement:\n- Power dissipated: $P = 20\\,\\mathrm{W}$\n- Ambient temperature: $T_{a} = 35\\,{}^{\\circ}\\mathrm{C}$\n- Junction-to-case thermal resistance: $R_{\\mathrm{th,JC}} = 0.8\\,\\mathrm{K/W}$\n- Case-to-sink thermal resistance: $R_{\\mathrm{th,CS}} = 0.3\\,\\mathrm{K/W}$\n- Sink-to-ambient thermal resistance: $R_{\\mathrm{th,SA}} = 1.2\\,\\mathrm{K/W}$\n\nFirst, we calculate the total thermal resistance $R_{\\mathrm{th,JA}}$:\n$$R_{\\mathrm{th,JA}} = 0.8\\,\\mathrm{K/W} + 0.3\\,\\mathrm{K/W} + 1.2\\,\\mathrm{K/W} = 2.3\\,\\mathrm{K/W}$$\nIt is noted that a temperature difference in Kelvin ($\\mathrm{K}$) is numerically equivalent to a temperature difference in degrees Celsius (${}^{\\circ}\\mathrm{C}$). Therefore, the unit $\\mathrm{K/W}$ is equivalent to ${}^{\\circ}\\mathrm{C/W}$.\n\nNext, we calculate the total temperature rise from ambient to the junction, $\\Delta T_{\\mathrm{JA}}$:\n$$\\Delta T_{\\mathrm{JA}} = P \\cdot R_{\\mathrm{th,JA}} = 20\\,\\mathrm{W} \\times 2.3\\,\\mathrm{K/W} = 46.0\\,\\mathrm{K} = 46.0\\,{}^{\\circ}\\mathrm{C}$$\n\nFinally, we calculate the junction temperature $T_{j}$ by adding this temperature rise to the ambient temperature:\n$$T_{j} = T_{a} + \\Delta T_{\\mathrm{JA}} = 35\\,{}^{\\circ}\\mathrm{C} + 46.0\\,{}^{\\circ}\\mathrm{C} = 81.0\\,{}^{\\circ}\\mathrm{C}$$\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value is $81.0$. To express this with four significant figures, we write it as $81.00$.",
            "answer": "$$\\boxed{81.00}$$"
        },
        {
            "introduction": "While steady-state analysis determines the final operating temperature, it doesn't describe how the device gets there. For applications involving power pulses, startup transients, or fault conditions, understanding the dynamic thermal response is crucial. This exercise  introduces the concept of transient thermal impedance, $Z_{\\mathrm{th}}(t)$, which characterizes the temperature rise over time. By applying a standard Foster network model, you will calculate the complete time-evolution of the junction temperature in response to a sudden application of power.",
            "id": "3852799",
            "problem": "A silicon power transistor is thermally modeled by a Foster network whose junction-to-ambient thermal impedance is specified as a causal time-domain function\n$$\nZ_{\\mathrm{th}}(t)=\\sum_{i=1}^{3} R_i\\bigl(1-\\exp(-t/\\tau_i)\\bigr),\n$$\nwith parameter triplets $(R_i,\\tau_i)$ given by $(0.2,\\,0.1\\,\\mathrm{s})\\,\\mathrm{K/W}$, $(0.5,\\,1\\,\\mathrm{s})\\,\\mathrm{K/W}$, and $(0.8,\\,10\\,\\mathrm{s})\\,\\mathrm{K/W}$. At time $t=0$, the device is at an ambient temperature $T_a=25\\,^{\\circ}\\mathrm{C}$ and a constant power dissipation $P=10\\,\\mathrm{W}$ is applied for $t \\ge 0$. Assume the thermal system is linear and time-invariant, the small-signal lumped thermal network accurately represents the junction-to-ambient path, and heat storage and flow obey the standard linear conduction analogy to electrical resistance-capacitance networks.\n\nStarting from the definition of the thermal impulse response and its relationship to the thermal step response in a linear time-invariant system, derive the junction temperature $T_j(t)$ for $t \\ge 0$ as an explicit analytic function of time. Express $T_j(t)$ in degrees Celsius as a function of $t$ in seconds. No rounding is required; provide a closed-form expression.",
            "solution": "The junction temperature $T_j(t)$ is the sum of the ambient temperature $T_a$ and the time-dependent temperature rise $\\Delta T_j(t)$. For a linear time-invariant (LTI) thermal system, the temperature rise resulting from a constant power step input $P$ is given by the product of the power and the system's thermal step response, which is the transient thermal impedance $Z_{\\mathrm{th}}(t)$.\n\nTherefore, the junction temperature evolves according to:\n$$\nT_j(t) = T_a + \\Delta T_j(t) = T_a + P \\cdot Z_{\\mathrm{th}}(t)\n$$\n\nThe problem provides the expression for the Foster network's thermal impedance:\n$$\nZ_{\\mathrm{th}}(t)=\\sum_{i=1}^{3} R_i\\bigl(1-\\exp(-t/\\tau_i)\\bigr)\n$$\n\nWe are given the following parameters:\n- Ambient temperature: $T_a = 25\\,^{\\circ}\\mathrm{C}$\n- Power dissipation: $P = 10\\,\\mathrm{W}$\n- Foster network parameters: $(R_1, \\tau_1) = (0.2\\,\\mathrm{K/W}, 0.1\\,\\mathrm{s})$, $(R_2, \\tau_2) = (0.5\\,\\mathrm{K/W}, 1\\,\\mathrm{s})$, and $(R_3, \\tau_3) = (0.8\\,\\mathrm{K/W}, 10\\,\\mathrm{s})$.\n\nSubstituting these values into the equation for $T_j(t)$:\n$$\nT_j(t) = 25 + 10 \\cdot \\left[ 0.2\\bigl(1-\\exp(-t/0.1)\\bigr) + 0.5\\bigl(1-\\exp(-t/1)\\bigr) + 0.8\\bigl(1-\\exp(-t/10)\\bigr) \\right]\n$$\n\nDistributing the power $P=10\\,\\mathrm{W}$ across the terms:\n$$\nT_j(t) = 25 + 2\\bigl(1-\\exp(-10t)\\bigr) + 5\\bigl(1-\\exp(-t)\\bigr) + 8\\bigl(1-\\exp(-0.1t)\\bigr)\n$$\n\nFinally, collecting the constant and exponential terms gives the closed-form expression for the junction temperature:\n$$\nT_j(t) = (25 + 2 + 5 + 8) - 2\\exp(-10t) - 5\\exp(-t) - 8\\exp(-0.1t)\n$$\n$$\nT_j(t) = 40 - 2\\exp(-10t) - 5\\exp(-t) - 8\\exp(-0.1t)\n$$\nThis expression gives the junction temperature in degrees Celsius as a function of time $t$ in seconds for $t \\ge 0$. As a check, at $t=0$, $T_j(0)=25\\,^{\\circ}\\mathrm{C}$, and as $t \\to \\infty$, $T_j(\\infty)=40\\,^{\\circ}\\mathrm{C}$, which matches the initial and steady-state conditions.",
            "answer": "$$\n\\boxed{40 - 2\\exp(-10t) - 5\\exp(-t) - 8\\exp(-0.1t)}\n$$"
        },
        {
            "introduction": "The most critical thermal challenge in power electronics is the risk of thermal runaway, a positive feedback loop where rising temperature increases power loss, which in turn drives the temperature even higher. This advanced practice  moves beyond simple models to a numerical simulation that captures this dangerous feedback mechanism. By iteratively calculating the temperature rise from a burst of high-frequency pulses with temperature-dependent switching losses, you will gain hands-on experience in modeling the very dynamics that can lead to device failure, as conceptually described in .",
            "id": "3852761",
            "problem": "A semiconductor power switch, such as an Insulated Gate Bipolar Transistor (IGBT), is subjected to a burst of $N=100$ identical switching pulses at frequency $f=10\\,\\mathrm{kHz}$ in still air at ambient temperature $T_a=40\\,^\\circ\\mathrm{C}$. The junction temperature $T_j$ evolves as switching energy is dissipated and heat is conducted to ambient. The switching energy per pulse is the sum of the turn-on energy $E_{\\mathrm{on}}(T)$ and turn-off energy $E_{\\mathrm{off}}(T)$, each dependent on instantaneous junction temperature $T$. The thermal path is modeled by a single-pole equivalent Resistive-Capacitive (RC) network with thermal resistance $R_{\\mathrm{th}}$ and thermal capacitance $C_{\\mathrm{th}}$, representing an effective dominant time constant over the burst timescale. The initial condition is $T_j(0)=T_a$.\n\nStarting from conservation of energy and the linear heat flow law embodied by the RC network, derive a discrete-time update method that accounts for:\n- instantaneous energy deposition at each pulse,\n- subsequent thermal relaxation toward ambient between pulses,\n- temperature dependence of $E_{\\mathrm{on}}(T)$ and $E_{\\mathrm{off}}(T)$,\nand implement it to compute the evolution of $T_j$ across the $N$ pulses. Evaluate the peak junction temperature attained during the burst.\n\nAssume all switching losses occur as an instantaneous energy impulse at the beginning of each period and that there are no other losses. Express the final peak junction temperature in degrees Celsius, rounded to three decimal places.\n\nUse the following test suite, where the temperature dependence of the switching energies is given by linear curves around a reference temperature $T_{\\mathrm{ref}}$, specifically $E_{\\mathrm{on}}(T)=E_{\\mathrm{on},0}\\left[1 + a_{\\mathrm{on}}\\left(T - T_{\\mathrm{ref}}\\right)\\right]$ and $E_{\\mathrm{off}}(T)=E_{\\mathrm{off},0}\\left[1 + a_{\\mathrm{off}}\\left(T - T_{\\mathrm{ref}}\\right)\\right]$, with $T$ and $T_{\\mathrm{ref}}$ in degrees Celsius. All energies are in joules.\n\n- Case 1 (module-scale dominant pole): $T_a=40\\,^\\circ\\mathrm{C}$, $N=100$, $f=10\\,\\mathrm{kHz}$, $R_{\\mathrm{th}}=0.3\\,\\mathrm{K/W}$, $C_{\\mathrm{th}}=10\\,\\mathrm{J/K}$, $T_{\\mathrm{ref}}=25\\,^\\circ\\mathrm{C}$, $E_{\\mathrm{on},0}=40\\times 10^{-3}\\,\\mathrm{J}$, $E_{\\mathrm{off},0}=30\\times 10^{-3}\\,\\mathrm{J}$, $a_{\\mathrm{on}}=4.0\\times 10^{-3}\\,\\mathrm{K}^{-1}$, $a_{\\mathrm{off}}=3.0\\times 10^{-3}\\,\\mathrm{K}^{-1}$.\n- Case 2 (small capacitance, higher losses): $T_a=40\\,^\\circ\\mathrm{C}$, $N=100$, $f=10\\,\\mathrm{kHz}$, $R_{\\mathrm{th}}=1.0\\,\\mathrm{K/W}$, $C_{\\mathrm{th}}=1.0\\,\\mathrm{J/K}$, $T_{\\mathrm{ref}}=25\\,^\\circ\\mathrm{C}$, $E_{\\mathrm{on},0}=120\\times 10^{-3}\\,\\mathrm{J}$, $E_{\\mathrm{off},0}=80\\times 10^{-3}\\,\\mathrm{J}$, $a_{\\mathrm{on}}=1.0\\times 10^{-2}\\,\\mathrm{K}^{-1}$, $a_{\\mathrm{off}}=8.0\\times 10^{-3}\\,\\mathrm{K}^{-1}$.\n- Case 3 (die-scale short time constant): $T_a=40\\,^\\circ\\mathrm{C}$, $N=100$, $f=10\\,\\mathrm{kHz}$, $R_{\\mathrm{th}}=0.1\\,\\mathrm{K/W}$, $C_{\\mathrm{th}}=0.02\\,\\mathrm{J/K}$, $T_{\\mathrm{ref}}=25\\,^\\circ\\mathrm{C}$, $E_{\\mathrm{on},0}=20\\times 10^{-3}\\,\\mathrm{J}$, $E_{\\mathrm{off},0}=10\\times 10^{-3}\\,\\mathrm{J}$, $a_{\\mathrm{on}}=2.0\\times 10^{-3}\\,\\mathrm{K}^{-1}$, $a_{\\mathrm{off}}=1.0\\times 10^{-3}\\,\\mathrm{K}^{-1}$.\n- Case 4 (strong temperature dependence): $T_a=40\\,^\\circ\\mathrm{C}$, $N=100$, $f=10\\,\\mathrm{kHz}$, $R_{\\mathrm{th}}=0.6\\,\\mathrm{K/W}$, $C_{\\mathrm{th}}=1.5\\,\\mathrm{J/K}$, $T_{\\mathrm{ref}}=25\\,^\\circ\\mathrm{C}$, $E_{\\mathrm{on},0}=60\\times 10^{-3}\\,\\mathrm{J}$, $E_{\\mathrm{off},0}=40\\times 10^{-3}\\,\\mathrm{J}$, $a_{\\mathrm{on}}=2.0\\times 10^{-2}\\,\\mathrm{K}^{-1}$, $a_{\\mathrm{off}}=1.5\\times 10^{-2}\\,\\mathrm{K}^{-1}$.\n\nYour program should produce a single line of output containing the peak junction temperatures for the four cases as a comma-separated list enclosed in square brackets, with each value rounded to three decimal places in degrees Celsius (e.g., $[41.237,68.945,70.752,55.103]$).",
            "solution": "The evolution of the junction temperature is governed by energy conservation and linear heat flow to ambient. The Resistive-Capacitive (RC) thermal network models the dominant thermal dynamics during the burst. Let $T(t)$ denote the junction temperature and $T_a$ the ambient temperature. With thermal capacitance $C_{\\mathrm{th}}$ and thermal resistance $R_{\\mathrm{th}}$, the energy balance is\n$$\nC_{\\mathrm{th}} \\frac{dT}{dt} = P(t) - \\frac{T(t)-T_a}{R_{\\mathrm{th}}},\n$$\nwhere $P(t)$ is the input heating power. During switching at discrete times $t_n = n/f$, the losses per pulse are modeled as instantaneous energy deposition, represented by an impulse of energy $E_{\\mathrm{sw}}(T)$, with\n$$\nE_{\\mathrm{sw}}(T) = E_{\\mathrm{on}}(T) + E_{\\mathrm{off}}(T).\n$$\nBetween impulses, $P(t)=0$ and heat flows to ambient. The temperature-dependent switching energies are specified as linear functions about a reference temperature $T_{\\mathrm{ref}}$,\n$$\nE_{\\mathrm{on}}(T) = E_{\\mathrm{on},0}\\left[1 + a_{\\mathrm{on}}(T - T_{\\mathrm{ref}})\\right], \\quad E_{\\mathrm{off}}(T) = E_{\\mathrm{off},0}\\left[1 + a_{\\mathrm{off}}(T - T_{\\mathrm{ref}})\\right],\n$$\nwith $E_{\\mathrm{on},0}$ and $E_{\\mathrm{off},0}$ in $\\mathrm{J}$, and $a_{\\mathrm{on}}$, $a_{\\mathrm{off}}$ in $\\mathrm{K}^{-1}$.\n\nAt the $n$-th pulse, denote the temperature immediately before the pulse by $T_n^-$. The instantaneous energy deposition increases the temperature by\n$$\n\\Delta T_n = \\frac{E_{\\mathrm{sw}}(T_n^-)}{C_{\\mathrm{th}}},\n$$\nyielding the immediate post-pulse peak temperature\n$$\nT_n^+ = T_n^- + \\Delta T_n.\n$$\nBetween pulses over the interval $\\Delta t = 1/f$, the system is linear with $P(t)=0$, so the homogeneous solution yields exponential relaxation toward ambient with time constant\n$$\n\\tau = R_{\\mathrm{th}} C_{\\mathrm{th}}.\n$$\nThus the temperature just before the next pulse is\n$$\nT_{n+1}^- = T_a + \\left(T_n^+ - T_a\\right) e^{-\\Delta t/\\tau}.\n$$\nThe initial condition is $T_0^- = T_a$. The peak temperature over the entire burst is the maximum of $\\{T_n^+\\}_{n=0}^{N-1}$.\n\nThis discrete-time algorithm directly implements the physical principles:\n- the instantaneous increase is obtained by equating deposited energy to an increase in stored thermal energy, i.e., $E = C_{\\mathrm{th}} \\Delta T$;\n- the inter-pulse decay follows from the linear heat flow through $R_{\\mathrm{th}}$ into ambient, with the governing differential equation solution $T(t) = T_a + (T(0) - T_a)\\exp(-t/\\tau)$ for $P(t)=0$.\n\nThermal runaway risk emerges from positive feedback: $E_{\\mathrm{sw}}(T)$ increasing with $T$ increases $\\Delta T_n$, which then increases subsequent $E_{\\mathrm{sw}}$. A local stability assessment of the map $T_{n+1}^- = F(T_n^-)$ around a fixed point $T^\\star$ considers the derivative\n$$\n\\frac{dT_{n+1}^-}{dT_n^-} = e^{-\\Delta t/\\tau}\\left(1 + \\frac{dE_{\\mathrm{sw}}}{dT}\\frac{1}{C_{\\mathrm{th}}}\\right),\n$$\nevaluated at $T^\\star$. If this derivative exceeds $1$, the sequence grows and may indicate instability over longer bursts. Over a short burst (here $N=100$ at $f=10\\,\\mathrm{kHz}$), the finite number of pulses bounds the peak temperature, but strong temperature dependence can significantly elevate $T_j$.\n\nAlgorithmic steps for each test case:\n1. Initialize $T \\leftarrow T_a$, $\\Delta t \\leftarrow 1/f$, $\\tau \\leftarrow R_{\\mathrm{th}} C_{\\mathrm{th}}$, $T_{\\mathrm{peak,max}} \\leftarrow T_a$.\n2. For $n$ from $0$ to $N-1$:\n   a. Compute $E_{\\mathrm{on}}(T)$ and $E_{\\mathrm{off}}(T)$ using the provided linear functions.\n   b. Compute $E_{\\mathrm{sw}}(T) = E_{\\mathrm{on}}(T) + E_{\\mathrm{off}}(T)$.\n   c. Compute $T^+ = T + E_{\\mathrm{sw}}(T)/C_{\\mathrm{th}}$ and update $T_{\\mathrm{peak,max}} \\leftarrow \\max(T_{\\mathrm{peak,max}}, T^+)$.\n   d. Compute $T \\leftarrow T_a + (T^+ - T_a)\\exp(-\\Delta t/\\tau)$.\n3. Return $T_{\\mathrm{peak,max}}$ rounded to three decimal places in $^\\circ\\mathrm{C}$.\n\nThe four test cases probe:\n- a \"happy path\" with moderate energies and a large thermal time constant (Case 1),\n- higher losses with small thermal capacitance increasing peak temperature (Case 2),\n- a short thermal time constant showing significant inter-pulse cooling (Case 3),\n- strong temperature dependence amplifying the feedback but remaining bounded within the burst (Case 4).\n\nThe final program computes the peak junction temperatures for all four cases and prints them as a single comma-separated list in square brackets, with values rounded to three decimals in degrees Celsius.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef peak_tj_for_case(case):\n    # Unpack case parameters\n    Ta = case[\"Ta\"]  # ambient temperature in degC\n    N = case[\"N\"]    # number of pulses\n    f = case[\"f\"]    # Hz\n    Rth = case[\"Rth\"]  # K/W\n    Cth = case[\"Cth\"]  # J/K\n    Tref = case[\"Tref\"]  # degC\n\n    Eon0 = case[\"Eon0\"]  # J\n    Eoff0 = case[\"Eoff0\"]  # J\n    aon = case[\"aon\"]    # 1/K\n    aoff = case[\"aoff\"]  # 1/K\n\n    dt = 1.0 / f\n    tau = Rth * Cth\n    decay = np.exp(-dt / tau)\n\n    T = Ta  # pre-pulse temperature\n    peak_max = T\n\n    for _ in range(N):\n        # Temperature-dependent switching energies\n        Eon = Eon0 * (1.0 + aon * (T - Tref))\n        Eoff = Eoff0 * (1.0 + aoff * (T - Tref))\n        Esw = Eon + Eoff\n        # Instantaneous temperature rise at pulse\n        T_peak = T + Esw / Cth\n        if T_peak > peak_max:\n            peak_max = T_peak\n        # Relaxation toward ambient until next pulse\n        T = Ta + (T_peak - Ta) * decay\n\n    return peak_max\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"Ta\": 40.0,\n            \"N\": 100,\n            \"f\": 10_000.0,\n            \"Rth\": 0.3,\n            \"Cth\": 10.0,\n            \"Tref\": 25.0,\n            \"Eon0\": 40e-3,\n            \"Eoff0\": 30e-3,\n            \"aon\": 4.0e-3,\n            \"aoff\": 3.0e-3,\n        },\n        {\n            \"Ta\": 40.0,\n            \"N\": 100,\n            \"f\": 10_000.0,\n            \"Rth\": 1.0,\n            \"Cth\": 1.0,\n            \"Tref\": 25.0,\n            \"Eon0\": 120e-3,\n            \"Eoff0\": 80e-3,\n            \"aon\": 1.0e-2,\n            \"aoff\": 8.0e-3,\n        },\n        {\n            \"Ta\": 40.0,\n            \"N\": 100,\n            \"f\": 10_000.0,\n            \"Rth\": 0.1,\n            \"Cth\": 0.02,\n            \"Tref\": 25.0,\n            \"Eon0\": 20e-3,\n            \"Eoff0\": 10e-3,\n            \"aon\": 2.0e-3,\n            \"aoff\": 1.0e-3,\n        },\n        {\n            \"Ta\": 40.0,\n            \"N\": 100,\n            \"f\": 10_000.0,\n            \"Rth\": 0.6,\n            \"Cth\": 1.5,\n            \"Tref\": 25.0,\n            \"Eon0\": 60e-3,\n            \"Eoff0\": 40e-3,\n            \"aon\": 2.0e-2,\n            \"aoff\": 1.5e-2,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        peak = peak_tj_for_case(case)\n        results.append(f\"{peak:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}