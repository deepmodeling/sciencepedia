{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是所有热分析的基础。我们将从基本原理——傅里叶定律和牛顿冷却定律——出发，为双面冷却功率器件构建一个等效热阻网络 。这项实践旨在培养将物理结构抽象为简化、可分析的电路模型的核心技能，这是评估散热方案有效性的基石。",
            "id": "3885315",
            "problem": "一个双面冷却的宽禁带 (WBG) 功率半导体半桥模块由两个相同的开关组成，这两个开关安装在两个直接键合铜 (DBC) 基板之间，并通过热界面材料 (TIM) 与顶部和底部冷板连接。考虑其中一个开关耗散稳定的热量速率 $Q$，该热量通过两个并联路径（顶部和底部）以一维方式传导至温度为 $T_{\\mathrm{a}}$ 的同一环境中，且两个外表面均具有对流边界条件。\n\n假设顶部路径由位于开关结和顶部 TIM 之间的一系列固定的串联固体层组成，其总传导热阻为 $R_{s,t}$；其后是厚度为 $d_{t}$、导热系数为 $k_{t}$、面积为 $A$ 的顶部 TIM；最后是面积同样为 $A$、传热系数为 $h_{t}$ 的对流边界。类似地，底部路径包含一系列固定的串联固体层，其总传导热阻为 $R_{s,b}$；一个厚度为 $d_{b}$、导热系数为 $k_{b}$、面积为 $A$ 的底部 TIM；以及一个面积为 $A$、传热系数为 $h_{b}$ 的对流边界。结温为 $T_{\\mathrm{j}}$，环境温度为 $T_{\\mathrm{a}}$。\n\n请仅从稳态一维形式的傅里叶热传导定律和牛顿冷却定律出发，构建等效热网络，并推导当顶部和底部路径并联到同一环境时，单个开关的有效结到环境热阻 $R_{\\theta,\\mathrm{eff}}(d_{t},d_{b})$ 的闭式解析表达式。以 $\\mathrm{K/W}$ 为单位表示最终的有效热阻。您的答案应为一个以 $R_{s,t}$、$R_{s,b}$、$d_{t}$、$d_{b}$、$k_{t}$、$k_{b}$、$h_{t}$、$h_{b}$ 和 $A$ 表示的单个闭式解析表达式。请勿代入任何数值。解答过程中不允许使用任何中间或简化公式。最终答案必须是单个闭式解析表达式。",
            "solution": "问题陈述已经过分析，被认为是有效的。它具有科学依据，提法得当，客观，并包含从基本原理推导所要求表达式所需的所有必要信息。\n\n目标是为从顶部和底部双面冷却的单个功率半导体开关，推导其有效结到环境热阻 $R_{\\theta,\\mathrm{eff}}$ 的表达式。该系统被建模为从温度为 $T_{\\mathrm{j}}$ 的器件结到温度为 $T_{\\mathrm{a}}$ 的共同环境的两条并联热路径。开关耗散的总热量为 $Q$。\n\n热阻 $R_{\\theta}$ 的概念类似于电阻，对于稳态热流 $Q$，其定义为热路径上的温差 $\\Delta T$ 与通过该路径的热流之比：\n$$R_{\\theta} = \\frac{\\Delta T}{Q}$$\n热阻的单位是开尔文每瓦特，$\\mathrm{K/W}$。\n\n我们将首先根据所提供的基本定律，推导传导和对流热阻的表达式。\n\n**1. 传导热阻**\n对于通过固体材料的稳态一维热传导，傅里叶定律指出热通量 $q'' = Q/A$ 与温度梯度成正比：\n$$q'' = -k \\frac{dT}{dx}$$\n其中 $Q$ 是热流速率，$A$ 是垂直于热流的横截面积，$k$ 是材料的导热系数，而 $\\frac{dT}{dx}$ 是温度梯度。对于一个厚度为 $d$、横截面积恒为 $A$、导热系数为 $k$ 的平面层，我们可以将此方程沿该层厚度（从 $x=0$ 到 $x=d$）进行积分，其对应的温度分别为 $T_{1}$ 和 $T_{2}$：\n$$Q \\int_0^d dx = -kA \\int_{T_1}^{T_2} dT$$\n$$Q d = -kA (T_{2} - T_{1}) = kA (T_{1} - T_{2})$$\n该层上的温差为 $\\Delta T = T_{1} - T_{2}$。因此，\n$$Q = \\frac{kA}{d} \\Delta T$$\n因此，传导热阻 $R_{\\theta,\\mathrm{cond}}$ 为：\n$$R_{\\theta,\\mathrm{cond}} = \\frac{\\Delta T}{Q} = \\frac{d}{kA}$$\n\n**2. 对流热阻**\n对于从固体表面到周围流体的热传递，牛顿冷却定律指出：\n$$Q = hA (T_{\\mathrm{s}} - T_{\\mathrm{a}})$$\n其中 $h$ 是对流传热系数，$A$ 是表面积，$T_{\\mathrm{s}}$ 是表面温度，$T_{\\mathrm{a}}$ 是环境流体温度。驱动热流的温差为 $\\Delta T = T_{\\mathrm{s}} - T_{\\mathrm{a}}$。\n因此，对流热阻 $R_{\\theta,\\mathrm{conv}}$ 为：\n$$R_{\\theta,\\mathrm{conv}} = \\frac{\\Delta T}{Q} = \\frac{1}{hA}$$\n\n**3. 等效热网络构建**\n该系统由两条从结到环境的并联热流路径组成。每条路径的总热阻是该路径内串联电阻的总和。\n\n**顶部路径热阻 ($R_{\\theta,t}$):**\n顶部路径由三个串联的热阻组成：\n1.  固定固体层的电阻，给定为 $R_{s,t}$。\n2.  顶部热界面材料 (TIM) 的传导电阻，$R_{\\theta,\\mathrm{TIM},t}$。使用推导出的传导电阻公式，对于厚度为 $d_{t}$、导热系数为 $k_{t}$、面积为 $A$ 的情况：\n    $$R_{\\theta,\\mathrm{TIM},t} = \\frac{d_{t}}{k_{t} A}$$\n3.  从顶部冷板到环境的对流电阻，$R_{\\theta,\\mathrm{conv},t}$。使用推导出的对流电阻公式，对于传热系数为 $h_{t}$、面积为 $A$ 的情况：\n    $$R_{\\theta,\\mathrm{conv},t} = \\frac{1}{h_{t} A}$$\n\n顶部路径的总热阻 $R_{\\theta,t}$ 是这些串联分量的总和：\n$$R_{\\theta,t} = R_{s,t} + R_{\\theta,\\mathrm{TIM},t} + R_{\\theta,\\mathrm{conv},t} = R_{s,t} + \\frac{d_{t}}{k_{t} A} + \\frac{1}{h_{t} A}$$\n\n**底部路径热阻 ($R_{\\theta,b}$):**\n类似地，底部路径由三个串联的热阻组成：\n1.  固定固体层的电阻，给定为 $R_{s,b}$。\n2.  底部 TIM 的传导电阻，$R_{\\theta,\\mathrm{TIM},b}$，对于厚度为 $d_{b}$、导热系数为 $k_{b}$、面积为 $A$ 的情况：\n    $$R_{\\theta,\\mathrm{TIM},b} = \\frac{d_{b}}{k_{b} A}$$\n3.  从底部冷板到环境的对流电阻，$R_{\\theta,\\mathrm{conv},b}$，对于传热系数为 $h_{b}$、面积为 $A$ 的情况：\n    $$R_{\\theta,\\mathrm{conv},b} = \\frac{1}{h_{b} A}$$\n\n底部路径的总热阻 $R_{\\theta,b}$ 是这些串联分量的总和：\n$$R_{\\theta,b} = R_{s,b} + R_{\\theta,\\mathrm{TIM},b} + R_{\\theta,\\mathrm{conv},b} = R_{s,b} + \\frac{d_{b}}{k_{b} A} + \\frac{1}{h_{b} A}$$\n\n**4. 有效结到环境热阻 ($R_{\\theta,\\mathrm{eff}}$)**\n构建的热网络显示，温度为 $T_{\\mathrm{j}}$ 的结节点通过两个总电阻分别为 $R_{\\theta,t}$ 和 $R_{\\theta,b}$ 的并联支路连接到温度为 $T_{\\mathrm{a}}$ 的环境节点。从结流出的总热量 $Q$ 分成 $Q_t$ 和 $Q_b$ 两部分，使得 $Q = Q_t + Q_b$。\n有效结到环境热阻 $R_{\\theta,\\mathrm{eff}}$ 是这两个并联电阻的等效电阻。两个并联电阻的等效电阻公式为：\n$$\\frac{1}{R_{\\theta,\\mathrm{eff}}} = \\frac{1}{R_{\\theta,t}} + \\frac{1}{R_{\\theta,b}}$$\n解出 $R_{\\theta,\\mathrm{eff}}$ 可得：\n$$R_{\\theta,\\mathrm{eff}} = \\frac{R_{\\theta,t} R_{\\theta,b}}{R_{\\theta,t} + R_{\\theta,b}}$$\n代入上面推导出的 $R_{\\theta,t}$ 和 $R_{\\theta,b}$ 的表达式，我们得到了作为给定参数函数的有效结到环境热阻的最终闭式解析表达式：\n$$R_{\\theta,\\mathrm{eff}}(d_{t},d_{b}) = \\frac{\\left( R_{s,t} + \\frac{d_{t}}{k_{t} A} + \\frac{1}{h_{t} A} \\right) \\left( R_{s,b} + \\frac{d_{b}}{k_{b} A} + \\frac{1}{h_{b} A} \\right)}{\\left( R_{s,t} + \\frac{d_{t}}{k_{t} A} + \\frac{1}{h_{t} A} \\right) + \\left( R_{s,b} + \\frac{d_{b}}{k_{b} A} + \\frac{1}{h_{b} A} \\right)}$$\n这个表达式可以重新整理以组合各项，但它已是按要求给出的一个完整且正确的单个闭式表达式。\n$$R_{\\theta,\\mathrm{eff}}(d_{t},d_{b}) = \\frac{\\left( R_{s,t} + \\frac{1}{A} \\left( \\frac{d_{t}}{k_{t}} + \\frac{1}{h_{t}} \\right) \\right) \\left( R_{s,b} + \\frac{1}{A} \\left( \\frac{d_{b}}{k_{b}} + \\frac{1}{h_{b}} \\right) \\right)}{R_{s,t} + R_{s,b} + \\frac{1}{A} \\left( \\frac{d_{t}}{k_{t}} + \\frac{d_{b}}{k_{b}} + \\frac{1}{h_{t}} + \\frac{1}{h_{b}} \\right)}$$\n这就是最终答案。",
            "answer": "$$\n\\boxed{\\frac{\\left( R_{s,t} + \\frac{d_{t}}{k_{t} A} + \\frac{1}{h_{t} A} \\right) \\left( R_{s,b} + \\frac{d_{b}}{k_{b} A} + \\frac{1}{h_{b} A} \\right)}{R_{s,t} + R_{s,b} + \\frac{d_{t}}{k_{t} A} + \\frac{d_{b}}{k_{b} A} + \\frac{1}{h_{t} A} + \\frac{1}{h_{b} A}}}\n$$"
        },
        {
            "introduction": "现实世界中的功率模块通常在共享基板上集成多个芯片，这导致了芯片间的热相互作用。本练习将我们的分析从单个器件扩展到多芯片系统，引入热阻矩阵的概念 。通过计算同时考虑自热和交叉耦合效应的稳态温度，您将深入理解不均匀的功率耗散如何在模块内产生热梯度和局部热点。",
            "id": "3885348",
            "problem": "一个三芯片碳化硅 (SiC) 宽带隙 (WBG) 功率模块使用双面冷却：每个芯片在顶部与一个液冷盖板热连接，在底部与一个液冷基板热连接。进入顶部和底部冷板的冷却液温度相同。三个芯片，标记为 $A$、$B$ 和 $C$，安装在一个共同的直接敷铜 (DBC) 基板上。在共享基板中的横向热扩散引入了芯片间温升的交叉耦合。系统在稳态下运行。\n\n从 Fourier 热传导定律和热阻的定义出发，推导出一个线性的多芯片热网络表示，该表示能够捕捉双面冷却和交叉耦合效应。清晰地论证双面冷却如何导致每个芯片到冷却液的自热阻呈并联组合，以及线性和叠加原理如何导出一个将功耗向量映射到结温向量的热阻矩阵。然后，使用所提供的数据，计算在不相等功耗情况下三个芯片的稳态结温。\n\n使用以下科学上合理的数据：\n- 冷却液温度 (两侧)：$T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$。\n- 顶部芯片到冷却液的热阻：$R_{\\text{top},A} = 0.12\\ \\mathrm{K/W}$，$R_{\\text{top},B} = 0.10\\ \\mathrm{K/W}$，$R_{\\text{top},C} = 0.11\\ \\mathrm{K/W}$。\n- 底部芯片到冷却液的热阻：$R_{\\text{bot},A} = 0.18\\ \\mathrm{K/W}$，$R_{\\text{bot},B} = 0.20\\ \\mathrm{K/W}$，$R_{\\text{bot},C} = 0.19\\ \\mathrm{K/W}$。\n- 由于共享基板和封装堆叠中的横向扩散引起的对称交叉耦合热阻：$R_{AB} = R_{BA} = 0.015\\ \\mathrm{K/W}$，$R_{AC} = R_{CA} = 0.012\\ \\mathrm{K/W}$，$R_{BC} = R_{CB} = 0.017\\ \\mathrm{K/W}$。\n- 功耗：$P_A = 180\\ \\mathrm{W}$，$P_B = 120\\ \\mathrm{W}$，$P_C = 90\\ \\mathrm{W}$。\n\n将芯片 $A$、$B$ 和 $C$ 的最终结温以摄氏度为单位，表示为单行矩阵 $\\begin{pmatrix}T_A  T_B  T_C\\end{pmatrix}$。将您的答案四舍五入至四位有效数字。",
            "solution": "首先验证问题陈述，以确保其具有科学依据、问题适定且客观。\n\n**步骤 1：提取已知条件**\n- 系统：三芯片 (A, B, C) 碳化硅 (SiC) 宽带隙 (WBG) 功率模块，采用双面冷却。\n- 冷却液温度：$T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$。\n- 顶部芯片到冷却液的热阻：$R_{\\text{top},A} = 0.12\\ \\mathrm{K/W}$，$R_{\\text{top},B} = 0.10\\ \\mathrm{K/W}$，$R_{\\text{top},C} = 0.11\\ \\mathrm{K/W}$。\n- 底部芯片到冷却液的热阻：$R_{\\text{bot},A} = 0.18\\ \\mathrm{K/W}$，$R_{\\text{bot},B} = 0.20\\ \\mathrm{K/W}$，$R_{\\text{bot},C} = 0.19\\ \\mathrm{K/W}$。\n- 对称交叉耦合热阻：$R_{AB} = R_{BA} = 0.015\\ \\mathrm{K/W}$，$R_{AC} = R_{CA} = 0.012\\ \\mathrm{K/W}$，$R_{BC} = R_{CB} = 0.017\\ \\mathrm{K/W}$。\n- 功耗：$P_A = 180\\ \\mathrm{W}$，$P_B = 120\\ \\mathrm{W}$，$P_C = 90\\ \\mathrm{W}$。\n- 工作条件：稳态。\n- 目标：推导线性热模型并计算稳态结温 $T_A$, $T_B$, $T_C$。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题基于 Fourier 热传导定律及其在热网络中的应用，这些是热工程领域基本且成熟的原理。功率模块中的双面冷却、热阻和交叉耦合等概念是电力电子封装领域的标准内容。所提供的值在物理上是合理的。\n- **问题适定：** 该问题提供了建立线性方程组所需的所有必要数据（热阻、功耗、环境温度）。方程的数量与未知数（三个结温）的数量相匹配，从而可以得到唯一解。\n- **客观性：** 该问题使用工程领域常见的精确技术语言进行描述，没有主观或模糊的术语。\n\n问题没有说明中列出的缺陷。它科学上合理、可形式化、完整、现实且问题适定。\n\n**步骤 3：结论与行动**\n问题有效。将提供详细的解决方案。\n\n**热模型的推导与求解**\n\n分析始于稳态传热的基本原理。Fourier 一维热传导定律指出，热流率 $q$ 与温度梯度 $\\frac{dT}{dx}$ 以及垂直于热流方向的面积 $A$ 成正比：$q = -kA \\frac{dT}{dx}$，其中 $k$ 是热导率。对于有限厚度 $L$，这可以积分得到 $q = \\frac{\\Delta T}{L/(kA)}$。我们定义热阻为 $R_{th} = \\frac{L}{kA}$，这将关系简化为类似于欧姆定律 ($V=IR$) 的形式：\n$$ \\Delta T = P \\cdot R_{th} $$\n在这里，温差 $\\Delta T$ 类似于电压降，功耗 $P$ (热流率) 类似于电流，而 $R_{th}$ 是热阻。这种类比使我们能够将复杂的热系统建模为热阻网络。\n\n**双面冷却与自热阻：**\n对于每个芯片，耗散的功率通过两个主要路径传导出去：一条向上通过顶部热堆栈传到顶部冷却液，另一条向下通过基板和底板传到底部冷却液。由于两条冷却路径都终止于相同的参考温度 $T_{\\mathrm{amb}}$，这两条路径在热学上是并联的。芯片的自热热阻，即将其自身功耗与其温升联系起来的电阻，是这两条并联路径的等效电阻。对于芯片 $j$ (其中 $j \\in \\{A, B, C\\}$)，有效自热阻 $R_{jj}$ 由下式给出：\n$$ R_{jj} = \\left( \\frac{1}{R_{\\text{top},j}} + \\frac{1}{R_{\\text{bot},j}} \\right)^{-1} = \\frac{R_{\\text{top},j} R_{\\text{bot},j}}{R_{\\text{top},j} + R_{\\text{bot},j}} $$\n\n**线性、叠加与交叉耦合：**\n对于与温度无关的材料属性，热传导方程是线性的。这使得我们可以使用叠加原理。任何给定芯片结处的总温升是其自身功耗（自热）和其他芯片功耗（交叉加热）引起的温升的线性总和。交叉加热是由于共享基板中的横向热扩散而发生的。\n\n芯片 $i$ 相对于环境的温升 $\\Delta T_i = T_i - T_{\\mathrm{amb}}$ 可以表示为：\n$$ \\Delta T_i = R_{iA} P_A + R_{iB} P_B + R_{iC} P_C = \\sum_{j \\in \\{A, B, C\\}} R_{ij} P_j $$\n这里，$R_{ii}$ 是上面计算的有效自热阻，$R_{ij}$ (对于 $i \\neq j$) 是给定的交叉耦合热阻，它量化了芯片 $j$ 耗散单位功率时在芯片 $i$ 处引起的温升。\n\n这个包含所有三个芯片的线性方程组最紧凑的表示形式是矩阵形式：\n$$ \\begin{pmatrix} \\Delta T_A \\\\ \\Delta T_B \\\\ \\Delta T_C \\end{pmatrix} = \\begin{pmatrix} R_{AA}  R_{AB}  R_{AC} \\\\ R_{BA}  R_{BB}  R_{BC} \\\\ R_{CA}  R_{CB}  R_{CC} \\end{pmatrix} \\begin{pmatrix} P_A \\\\ P_B \\\\ P_C \\end{pmatrix} $$\n这表示为 $\\Delta \\mathbf{T} = \\mathbf{R}_{\\mathrm{th}} \\mathbf{P}$。\n\n**数值计算**\n\n首先，我们计算热阻矩阵 $\\mathbf{R}_{\\mathrm{th}}$ 的对角线元素：\n$$ R_{AA} = \\left( \\frac{1}{0.12} + \\frac{1}{0.18} \\right)^{-1} = \\frac{0.12 \\times 0.18}{0.12 + 0.18} = \\frac{0.0216}{0.30} = 0.072\\ \\mathrm{K/W} $$\n$$ R_{BB} = \\left( \\frac{1}{0.10} + \\frac{1}{0.20} \\right)^{-1} = \\frac{0.10 \\times 0.20}{0.10 + 0.20} = \\frac{0.02}{0.30} = \\frac{1}{15} \\approx 0.06667\\ \\mathrm{K/W} $$\n$$ R_{CC} = \\left( \\frac{1}{0.11} + \\frac{1}{0.19} \\right)^{-1} = \\frac{0.11 \\times 0.19}{0.11 + 0.19} = \\frac{0.0209}{0.30} \\approx 0.06967\\ \\mathrm{K/W} $$\n\n使用这些自热阻和给定的交叉耦合热阻，组装完整的热阻矩阵 $\\mathbf{R}_{\\mathrm{th}}$：\n$$ \\mathbf{R}_{\\mathrm{th}} = \\begin{pmatrix} 0.072  0.015  0.012 \\\\ 0.015  1/15  0.017 \\\\ 0.012  0.017  0.0209/0.30 \\end{pmatrix}\\ \\mathrm{K/W} $$\n\n功耗向量 $\\mathbf{P}$ 为：\n$$ \\mathbf{P} = \\begin{pmatrix} 180 \\\\ 120 \\\\ 90 \\end{pmatrix}\\ \\mathrm{W} $$\n\n现在，我们计算温升向量 $\\Delta \\mathbf{T} = \\mathbf{R}_{\\mathrm{th}} \\mathbf{P}$：\n$$ \\Delta T_A = (0.072 \\times 180) + (0.015 \\times 120) + (0.012 \\times 90) = 12.96 + 1.80 + 1.08 = 15.84\\ \\mathrm{K} $$\n$$ \\Delta T_B = (0.015 \\times 180) + \\left(\\frac{1}{15} \\times 120\\right) + (0.017 \\times 90) = 2.70 + 8.00 + 1.53 = 12.23\\ \\mathrm{K} $$\n$$ \\Delta T_C = (0.012 \\times 180) + (0.017 \\times 120) + \\left(\\frac{0.0209}{0.30} \\times 90\\right) = 2.16 + 2.04 + (0.0209 \\times 300) = 2.16 + 2.04 + 6.27 = 10.47\\ \\mathrm{K} $$\n\n温升为 $\\Delta T_A = 15.84\\,^\\circ\\mathrm{C}$，$\\Delta T_B = 12.23\\,^\\circ\\mathrm{C}$ 和 $\\Delta T_C = 10.47\\,^\\circ\\mathrm{C}$。以开尔文 (K) 为单位的温度变化等于以摄氏度 ($^\\circ\\mathrm{C}$) 为单位的温度变化。\n\n最后，通过加上环境温度 $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$ 来找到绝对结温：\n$$ T_A = T_{\\mathrm{amb}} + \\Delta T_A = 25 + 15.84 = 40.84\\,^\\circ\\mathrm{C} $$\n$$ T_B = T_{\\mathrm{amb}} + \\Delta T_B = 25 + 12.23 = 37.23\\,^\\circ\\mathrm{C} $$\n$$ T_C = T_{\\mathrm{amb}} + \\Delta T_C = 25 + 10.47 = 35.47\\,^\\circ\\mathrm{C} $$\n\n所要求的答案是这些温度的行矩阵，四舍五入到四位有效数字。\n$T_A = 40.84$\n$T_B = 37.23$\n$T_C = 35.47$\n这些值已经达到了要求的精度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.84  37.23  35.47\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "电气性能与热管理之间的关系是双向的。这个高级练习将深入探讨关键的非线性耦合问题：器件的导通电阻 $R_{\\text{DS(on)}}$ 依赖于温度，而温度由功率耗散驱动，功率耗散本身又取决于电阻 。通过建立一个数值模型来求解这个电热耦合系统，您将直接探究并联器件中电流不平衡的风险，这是影响模块可靠性的一个关键因素，也是热失控的前兆。",
            "id": "3885335",
            "problem": "一名程序员需要对一个采用双面散热的宽禁带 (WBG) 功率模块中的并联金属氧化物半导体场效应晶体管 (MOSFET) 的温漂均流特性进行建模。其目标是识别由随温度变化的漏源导通电阻与一个包含双面散热和器件间热耦合效应的热网络之间的耦合所引起的不平衡风险。\n\n从以下基本原理出发：\n- 对每个MOSFET沟道导通应用欧姆定律：漏源电压由 $V = I_i R_i(T_i)$ 给出，其中 $I_i$ 是流过器件 $i$ 的电流，$R_i(T_i)$ 是器件 $i$ 的随温度变化的漏源导通电阻，$T_i$ 是器件 $i$ 的结温。\n- 稳态下热阻的定义：对于一个线性热网络，器件 $i$ 相对于环境的结温温升满足 $T_i - T_{\\text{amb}} = \\sum_{j=1}^N R_{ij} P_j$，其中 $R_{ij}$ 是一个热阻矩阵（单位为 $\\text{K}/\\text{W}$）的元素，该矩阵包含了双面散热条件下的自热阻和交叉耦合热阻，$P_j$ 是在器件 $j$ 中耗散的功率，$N$ 是并联器件的数量。\n- 器件 $j$ 在纯阻性导通状态下的功率耗散为 $P_j = I_j^2 R_j(T_j)$。\n- 并联连接意味着所有器件上具有共同的漏源电压 $V$ 和总电流约束 $\\sum_{i=1}^N I_i = I_{\\text{tot}}$。\n\n假设器件 $i$ 的漏源导通电阻的温度依赖性采用以下符合物理现实且广泛使用的参数化模型：\n$R_i(T_i) = R_{0,i}\\left(1 + \\alpha_i (T_i - T_{\\text{ref}})\\right)$，\n其中 $R_{0,i}$ 是在参考温度 $T_{\\text{ref}}$ 下的漏源导通电阻，$\\alpha_i$ 是温度系数（单位为 $\\text{K}^{-1}$）。\n\n您的任务是：\n- 针对未知结温 $\\{T_i\\}_{i=1}^N$ 和公共漏源电压 $V$ 建立耦合非线性方程组，并对其进行数值求解，以同时满足电学和热学约束。\n- 根据解计算出电流 $\\{I_i\\}_{i=1}^N$，并使用指标 $\\gamma = \\max_i \\left|I_i - I_{\\text{avg}}\\right| / I_{\\text{avg}}$（其中 $I_{\\text{avg}} = I_{\\text{tot}}/N$）来评估均流不平衡度。\n- 如果 $\\gamma$ 超过指定阈值 $\\gamma_{\\text{crit}}$（以小数表示）或最高结温超过允许的上限 $T_{\\text{j,max}}^{\\text{allow}}$，则识别为存在不平衡风险。\n\n使用的物理单位是：\n- 电流单位：$\\text{A}$，\n- 电压单位：$\\text{V}$，\n- 温度单位：$\\text{K}$，\n- 热阻单位：$\\text{K}/\\text{W}$，\n- 漏源导通电阻单位：$\\Omega$，\n- 不平衡度指标 $\\gamma$ 是无量纲的，必须以小数表示。\n\n实现一个程序，为以下测试套件求解该系统。对于每个案例，热阻矩阵 $R$ 的对角线元素代表双面散热的自热阻，非对角线元素代表器件间的耦合。\n\n测试套件：\n- 案例1（理想情况，对称的器件和散热）：\n  - $N = 2$，\n  - $I_{\\text{tot}} = 200.0$ $\\text{A}$，\n  - $T_{\\text{amb}} = 300.0$ $\\text{K}$，\n  - $T_{\\text{ref}} = 300.0$ $\\text{K}$，\n  - $R_{0} = [0.0020, 0.0020]$ $\\Omega$，\n  - $\\alpha = [0.0040, 0.0040]$ $\\text{K}^{-1}$，\n  - 热阻矩阵 R（单位 K/W）：$$ \\begin{bmatrix}0.15  0.02\\\\ 0.02  0.15\\end{bmatrix} $$\n  - $\\gamma_{\\text{crit}} = 0.10$，\n  - $T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n- 案例2（$R_{0}$ 不匹配及非对称双面散热）：\n  - $N = 2$，\n  - $I_{\\text{tot}} = 300.0$ $\\text{A}$，\n  - $T_{\\text{amb}} = 300.0$ $\\text{K}$，\n  - $T_{\\text{ref}} = 300.0$ $\\text{K}$，\n  - $R_{0} = [0.0022, 0.0018]$ $\\Omega$，\n  - $\\alpha = [0.0040, 0.0040]$ $\\text{K}^{-1}$，\n  - 热阻矩阵 R（单位 K/W）：$$ \\begin{bmatrix}0.18  0.03\\\\ 0.03  0.12\\end{bmatrix} $$\n  - $\\gamma_{\\text{crit}} = 0.10$，\n  - $T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n- 案例3（更强的耦合、一个器件散热较弱以及环境温度升高）：\n  - $N = 3$，\n  - $I_{\\text{tot}} = 360.0$ $\\text{A}$，\n  - $T_{\\text{amb}} = 333.0$ $\\text{K}$，\n  - $T_{\\text{ref}} = 300.0$ $\\text{K}$，\n  - $R_{0} = [0.0020, 0.0020, 0.0020]$ $\\Omega$，\n  - $\\alpha = [0.0040, 0.0040, 0.0040]$ $\\text{K}^{-1}$，\n  - 热阻矩阵 R（单位 K/W）：$$ \\begin{bmatrix}0.15  0.03  0.03\\\\ 0.03  0.15  0.03\\\\ 0.03  0.03  0.25\\end{bmatrix} $$\n  - $\\gamma_{\\text{crit}} = 0.10$,\n  - $T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n\n您的程序必须：\n- 对每个测试案例，数值求解耦合方程组，\n- 计算不平衡度指标 $\\gamma$（无量纲，小数），\n- 根据 $ \\text{risk} = (\\gamma  \\gamma_{\\text{crit}}) \\lor \\left(\\max_i T_i  T_{\\text{j,max}}^{\\text{allow}}\\right)$ 为每个案例确定布尔风险标志，\n- 生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。输出顺序必须为：$[\\gamma_1,\\text{risk}_1,\\gamma_2,\\text{risk}_2,\\gamma_3,\\text{risk}_3]$，其中 $\\gamma_k$ 是案例 $k$ 的浮点数，$\\text{risk}_k$ 是案例 $k$ 的布尔值。\n\n所有数值量均需使用指定单位作答，任何分数或百分比都应表示为不带百分号的小数。不允许外部输入；程序必须能直接运行，并按指定的确切格式打印最终结果。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 步骤1：提取已知条件\n问题提供了以下物理定律、定义和模型参数：\n\n- **欧姆定律**：对于每个器件 $i$，$V = I_i R_i(T_i)$，其中 $V$ 是公共电压。\n- **基尔霍夫电流定律**：$\\sum_{i=1}^N I_i = I_{\\text{tot}}$。\n- **稳态热网络**：$T_i - T_{\\text{amb}} = \\sum_{j=1}^N R_{ij} P_j$，其中 $R_{ij}$ 是热阻矩阵 $\\mathbf{R}$ 的元素。\n- **功率耗散**：$P_j = I_j^2 R_j(T_j)$。\n- **随温度变化的电阻**：$R_i(T_i) = R_{0,i}\\left(1 + \\alpha_i (T_i - T_{\\text{ref}})\\right)$。\n- **电流不平衡度指标**：$\\gamma = \\max_i \\left|I_i - I_{\\text{avg}}\\right| / I_{\\text{avg}}$，其中 $I_{\\text{avg}} = I_{\\text{tot}}/N$。\n- **风险条件**：如果 $\\gamma  \\gamma_{\\text{crit}}$ 或 $\\max_i T_i  T_{\\text{j,max}}^{\\text{allow}}$，则标记不平衡风险。\n\n测试案例：\n- **案例 1**：$N = 2$，$I_{\\text{tot}} = 200.0$ $\\text{A}$，$T_{\\text{amb}} = 300.0$ $\\text{K}$，$T_{\\text{ref}} = 300.0$ $\\text{K}$，$R_{0} = [0.0020, 0.0020]$ $\\Omega$，$\\alpha = [0.0040, 0.0040]$ $\\text{K}^{-1}$，$\\mathbf{R} = \\begin{bmatrix}0.15  0.02\\\\ 0.02  0.15\\end{bmatrix}$ $\\text{K}/\\text{W}$，$\\gamma_{\\text{crit}} = 0.10$，$T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n- **案例 2**：$N = 2$，$I_{\\text{tot}} = 300.0$ $\\text{A}$，$T_{\\text{amb}} = 300.0$ $\\text{K}$，$T_{\\text{ref}} = 300.0$ $\\text{K}$，$R_{0} = [0.0022, 0.0018]$ $\\Omega$，$\\alpha = [0.0040, 0.0040]$ $\\text{K}^{-1}$，$\\mathbf{R} = \\begin{bmatrix}0.18  0.03\\\\ 0.03  0.12\\end{bmatrix}$ $\\text{K}/\\text{W}$，$\\gamma_{\\text{crit}} = 0.10$，$T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n- **案例 3**：$N = 3$，$I_{\\text{tot}} = 360.0$ $\\text{A}$，$T_{\\text{amb}} = 333.0$ $\\text{K}$，$T_{\\text{ref}} = 300.0$ $\\text{K}$，$R_{0} = [0.0020, 0.0020, 0.0020]$ $\\Omega$，$\\alpha = [0.0040, 0.0040, 0.0040]$ $\\text{K}^{-1}$，$\\mathbf{R} = \\begin{bmatrix}0.15  0.03  0.03\\\\ 0.03  0.15  0.03\\\\ 0.03  0.03  0.25\\end{bmatrix}$ $\\text{K}/\\text{W}$，$\\gamma_{\\text{crit}} = 0.10$，$T_{\\text{j,max}}^{\\text{allow}} = 448.0$ $\\text{K}$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定准则对问题进行评估。\n\n- **有科学依据**：该问题建立在电路（欧姆定律、KCL）和传热学（热阻）的基本原理之上。随温度变化的电阻模型是半导体器件的标准一阶近似。整个前提是电力电子学中一个成熟的电热协同设计问题。\n- **适定的**：该问题需要求解一个耦合非线性方程组。它为每个测试案例提供了一整套参数和边界条件，使得该系统是可解的。未知数（$T_i$，$V$）定义清晰，约束条件足以确定一个唯一的物理可行解。正电阻温度系数（$\\alpha  0$）为电流提供了一个稳定的负反馈回路，这通常能确保存在一个稳定的唯一解。\n- **客观的**：问题以精确的数学和工程术语陈述。成功标准（$\\gamma$，$T_{\\text{j,max}}$）是定量且明确的。\n- **其他缺陷**：该问题没有所列出的缺陷。它不是自相矛盾、不完整或基于伪科学的。给定的数值对于宽禁带功率模块是符合实际的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学性、适定性、客观性，并为求解提供了所有必要的信息。将着手开发一个解决方案。\n\n### 基于原理的求解设计\n\n问题的核心是为一个包含 $N$ 个并联MOSFET的系统找到一个自洽的稳态工作点，其中电学行为依赖于温度，而温度又依赖于电学行为。这需要求解一个耦合非线性方程组。\n\n#### 1. 控制方程的建立\n我们从提供的基本关系式开始。对于一个由 $N$ 个器件组成的系统，有 $N+1$ 个主要未知数：$N$ 个结温 $\\{T_1, T_2, \\ldots, T_N\\}$ 和公共漏源电压 $V$。我们必须建立 $N+1$ 个独立方程。\n\n根据欧姆定律和并联连接，流过器件 $i$ 的电流为：\n$$I_i = \\frac{V}{R_i(T_i)}$$\n其中 $R_i(T_i)$ 是随温度变化的导通电阻：\n$$R_i(T_i) = R_{0,i}\\left(1 + \\alpha_i (T_i - T_{\\text{ref}})\\right)$$\n\n器件 $j$ 耗散的功率 $P_j$ 由下式给出：\n$$P_j = I_j^2 R_j(T_j) = \\left(\\frac{V}{R_j(T_j)}\\right)^2 R_j(T_j) = \\frac{V^2}{R_j(T_j)}$$\n\n结温由热网络确定：\n$$T_i = T_{\\text{amb}} + \\sum_{j=1}^N R_{ij} P_j \\quad \\text{for } i=1, \\ldots, N$$\n代入功率的表达式，我们得到 $N$ 个热学方程：\n$$T_i = T_{\\text{amb}} + \\sum_{j=1}^N R_{ij} \\frac{V^2}{R_j(T_j)} \\quad (1)$$\n\n另一个方程来自总电流约束（基尔霍夫电流定律）：\n$$\\sum_{i=1}^N I_i = I_{\\text{tot}} \\implies \\sum_{i=1}^N \\frac{V}{R_i(T_i)} = I_{\\text{tot}}$$\n这使我们能够将电压 $V$ 表示为结温 $\\mathbf{T} = \\{T_1, \\ldots, T_N\\}$ 的函数：\n$$V(\\mathbf{T}) = \\frac{I_{\\text{tot}}}{\\sum_{k=1}^N \\frac{1}{R_k(T_k)}} \\quad (2)$$\n\n#### 2. 简化为关于温度的方程组\n通过将方程 $(2)$ 代入方程 $(1)$，我们可以消去电压 $V$，从而得到一个仅包含 $N$ 个未知温度 $\\{T_i\\}$ 的 $N$ 元非线性封闭方程组：\n$$T_i = T_{\\text{amb}} + \\left( \\sum_{j=1}^N \\frac{R_{ij}}{R_j(T_j)} \\right) \\left( \\frac{I_{\\text{tot}}}{\\sum_{k=1}^N \\frac{1}{R_k(T_k)}} \\right)^2 \\quad \\text{for } i=1, \\ldots, N$$\n\n为了对此进行数值求解，我们定义一个残差函数向量 $\\mathbf{F}(\\mathbf{T}) = [F_1(\\mathbf{T}), \\ldots, F_N(\\mathbf{T})]^T$，在解处，其每个分量 $F_i$ 都必须等于零：\n$$F_i(\\mathbf{T}) = T_i - T_{\\text{amb}} - \\left( \\sum_{j=1}^N \\frac{R_{ij}}{R_{0,j}(1 + \\alpha_j (T_j - T_{\\text{ref}}))} \\right) \\left( \\frac{I_{\\text{tot}}}{\\sum_{k=1}^N \\frac{1}{R_{0,k}(1 + \\alpha_k (T_k - T_{\\text{ref}}))}} \\right)^2 = 0$$\n\n#### 3. 数值求解策略\n这个方程组 $\\mathbf{F}(\\mathbf{T}) = \\mathbf{0}$ 在一般情况下无法解析求解。我们将采用一种数值求根算法，具体是在 `scipy.optimize.root` 中实现的 Levenberg-Marquardt 算法或类似方法。这种迭代算法需要一个温度向量 $\\mathbf{T}$ 的初始猜测值。一个符合物理意义的初始猜测是假设所有器件都处于环境温度，即 $\\mathbf{T}_{guess} = [T_{\\text{amb}}, \\ldots, T_{\\text{amb}}]$。然后，该算法将迭代更新温度，直到残差 $\\mathbf{F}(\\mathbf{T})$ 足够接近于零。\n\n#### 4. 后处理与风险评估\n一旦找到收敛的温度向量 $\\mathbf{T}_{\\text{sol}} = \\{T_1, \\ldots, T_N\\}$，所有其他关心的物理量都可以直接计算得出：\n1.  **导通电阻**：计算每个器件的最终电阻 $R_i(\\text{T}_{\\text{sol}, i})$。\n2.  **电压**：使用方程 $(2)$ 计算公共电压 $V(\\mathbf{T}_{\\text{sol}})$。\n3.  **电流**：确定流过每个器件的电流 $I_i = V/R_i$。\n4.  **不平衡度指标**：计算 $\\gamma = \\max_i |I_i - I_{\\text{avg}}| / I_{\\text{avg}}$，其中 $I_{\\text{avg}} = I_{\\text{tot}}/N$。\n5.  **最高温度**：找到 $T_{\\text{j,max}} = \\max_i T_i$。\n6.  **风险标志**：评估布尔条件 $\\text{risk} = (\\gamma  \\gamma_{\\text{crit}}) \\lor (T_{\\text{j,max}}  T_{\\text{j,max}}^{\\text{allow}})$。\n\n将此过程系统地应用于每个测试案例，以得出最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Main function to solve the electro-thermal problem for all test cases.\n    \"\"\"\n    # Test cases as defined in the problem statement.\n    test_cases = [\n        {\n            \"N\": 2, \"I_tot\": 200.0, \"T_amb\": 300.0, \"T_ref\": 300.0,\n            \"R0\": np.array([0.0020, 0.0020]),\n            \"alpha\": np.array([0.0040, 0.0040]),\n            \"R_th\": np.array([[0.15, 0.02], [0.02, 0.15]]),\n            \"gamma_crit\": 0.10, \"T_j_max_allow\": 448.0\n        },\n        {\n            \"N\": 2, \"I_tot\": 300.0, \"T_amb\": 300.0, \"T_ref\": 300.0,\n            \"R0\": np.array([0.0022, 0.0018]),\n            \"alpha\": np.array([0.0040, 0.0040]),\n            \"R_th\": np.array([[0.18, 0.03], [0.03, 0.12]]),\n            \"gamma_crit\": 0.10, \"T_j_max_allow\": 448.0\n        },\n        {\n            \"N\": 3, \"I_tot\": 360.0, \"T_amb\": 333.0, \"T_ref\": 300.0,\n            \"R0\": np.array([0.0020, 0.0020, 0.0020]),\n            \"alpha\": np.array([0.0040, 0.0040, 0.0040]),\n            \"R_th\": np.array([[0.15, 0.03, 0.03], [0.03, 0.15, 0.03], [0.03, 0.03, 0.25]]),\n            \"gamma_crit\": 0.10, \"T_j_max_allow\": 448.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, risk_flag = _solve_single_case(case)\n        results.extend([gamma, str(risk_flag).lower()])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _solve_single_case(params):\n    \"\"\"\n    Solves the coupled non-linear equations for a single test case.\n    \"\"\"\n    # Extract parameters for clarity\n    N = params[\"N\"]\n    I_tot = params[\"I_tot\"]\n    T_amb = params[\"T_amb\"]\n    T_ref = params[\"T_ref\"]\n    R0 = params[\"R0\"]\n    alpha = params[\"alpha\"]\n    R_th = params[\"R_th\"]\n    gamma_crit = params[\"gamma_crit\"]\n    T_j_max_allow = params[\"T_j_max_allow\"]\n\n    def residual_equations(T):\n        \"\"\"\n        Defines the system of N non-linear equations F(T) = 0.\n        The vector T contains the current guess for the junction temperatures [T1, T2, ...].\n        \"\"\"\n        # Calculate temperature-dependent on-resistances\n        R_on = R0 * (1 + alpha * (T - T_ref))\n\n        # Check for non-physical resistance values\n        if np.any(R_on = 0):\n            return np.full(N, 1e9) # Return a large residual if R_on is non-positive\n\n        # Calculate common drain-to-source voltage V\n        sum_conductance = np.sum(1.0 / R_on)\n        if sum_conductance == 0:\n             return np.full(N, 1e9)\n        V_ds = I_tot / sum_conductance\n\n        # Calculate power dissipation in each device\n        P = (V_ds**2) / R_on\n\n        # Calculate the resulting junction temperatures based on the thermal model\n        T_calculated = T_amb + R_th @ P\n\n        # The residual is the difference between the guessed temperatures and the calculated ones\n        return T - T_calculated\n\n    # Initial guess for the temperatures (all at ambient)\n    T_initial_guess = np.full(N, T_amb)\n\n    # Solve the system of equations\n    solution = root(residual_equations, T_initial_guess, method='hybr')\n\n    if not solution.success:\n        raise RuntimeError(\"Numerical solver failed to converge.\")\n\n    T_final = solution.x\n\n    # --- Post-processing after finding temperatures ---\n\n    # Calculate final on-resistances\n    R_on_final = R0 * (1 + alpha * (T_final - T_ref))\n    \n    # Calculate final voltage\n    V_ds_final = I_tot / np.sum(1.0 / R_on_final)\n\n    # Calculate final currents\n    I_final = V_ds_final / R_on_final\n    \n    # Verify total current (sanity check)\n    # assert np.isclose(np.sum(I_final), I_tot)\n\n    # Calculate average current\n    I_avg = I_tot / N\n\n    # Calculate imbalance metric gamma\n    gamma = np.max(np.abs(I_final - I_avg)) / I_avg\n\n    # Find maximum junction temperature\n    T_j_max = np.max(T_final)\n\n    # Determine risk flag\n    risk = (gamma > gamma_crit) or (T_j_max > T_j_max_allow)\n\n    return gamma, risk\n\nsolve()\n```"
        }
    ]
}