{
    "hands_on_practices": [
        {
            "introduction": "Understanding the transient temperature response of a power semiconductor is critical for ensuring its reliability. By modeling the thermal path as a linear time-invariant (LTI) system, we can leverage powerful analytical tools. This first practice exercise  challenges you to apply the principle of superposition to derive the temperature rise from a single power pulse, starting from the fundamental definition of a Foster thermal network. Mastering this derivation provides a solid foundation for analyzing more complex power dissipation profiles.",
            "id": "3840357",
            "problem": "A junction-to-ambient thermal path of a power semiconductor device is modeled as a linear time-invariant (LTI) system. Let the applied power be the time-dependent input $P(t)$ and the resulting junction temperature rise be the output $\\Theta(t)$ (in Kelvin). The LTI property implies superposition and time-shift invariance, so that the input-output relationship is a convolution of the input with the system’s impulse response. The thermal step response $Z_{\\mathrm{th,step}}(t)$ is the junction temperature rise produced by a unit power step input, and its time derivative is the impulse response $h(t) = \\frac{d}{dt} Z_{\\mathrm{th,step}}(t)$. In practice, the Foster thermal network representation models $Z_{\\mathrm{th,step}}(t)$ as a finite sum of decaying exponentials with positive coefficients and time constants, parameterized by $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$, where $R_{i} > 0$ and $\\tau_{i} > 0$ for all $i$. Consider a single rectangular power pulse of amplitude $P_{0} > 0$ and width $t_{p} > 0$, starting at $t=0$, namely\n$$\nP(t) = P_{0} \\,\\big(u(t) - u(t - t_{p})\\big),\n$$\nwhere $u(t)$ is the Heaviside unit step function, defined by $u(t)=0$ for $t<0$ and $u(t)=1$ for $t\\ge 0$. Starting from the convolution definition and the LTI principles above (without assuming any shortcut formulas), derive a closed-form analytic expression for the junction temperature rise $\\Theta(t)$ for all $t \\ge 0$ in terms of $P_{0}$, $t_{p}$, and the Foster parameters $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$. Express your final answer in Kelvin as a single analytic expression valid for all $t \\ge 0$. No numerical rounding is required.",
            "solution": "The thermal path is modeled as a linear time-invariant (LTI) system. Let $h(t)$ denote the impulse response of the thermal system. By definition, if the input power is $P(t)$, the junction temperature rise $\\Theta(t)$ is given by the convolution\n$$\n\\Theta(t) = \\int_{-\\infty}^{\\infty} P(\\tau)\\, h(t - \\tau)\\, d\\tau.\n$$\nBecause the system is causal, $h(t) = 0$ for $t<0$, and because the applied power pulse is zero for $\\tau<0$ and for $\\tau>t_{p}$, we can rewrite the convolution as\n$$\n\\Theta(t) = \\int_{0}^{t_{p}} P_{0}\\, h(t - \\tau)\\, d\\tau,\n$$\nwith the understanding that $h(t - \\tau)$ contributes only when $t - \\tau \\ge 0$, which is automatically satisfied for $\\tau \\le t$; if $t < t_{p}$, the effective upper limit becomes $t$, and if $t \\ge t_{p}$, it remains $t_{p}$. To make this explicit,\n$$\n\\Theta(t) = P_{0} \\int_{0}^{\\min(t, t_{p})} h(t - \\tau)\\, d\\tau.\n$$\n\nThe impulse response $h(t)$ is the time derivative of the step response $Z_{\\mathrm{th,step}}(t)$:\n$$\nh(t) = \\frac{d}{dt} Z_{\\mathrm{th,step}}(t),\n$$\nwith $h(t)=0$ for $t<0$ due to causality and $Z_{\\mathrm{th,step}}(t)=0$ for $t<0$. The Foster representation models the step thermal impedance as a finite sum of decaying exponentials with positive coefficients and time constants. Explicitly, one writes\n$$\nZ_{\\mathrm{th,step}}(t) = \\sum_{i=1}^{N} R_{i} \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{i}}\\right)\\right) u(t),\n$$\nwhere $R_{i} > 0$ and $\\tau_{i} > 0$. Differentiating with respect to time gives the impulse response\n$$\nh(t) = \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) u(t).\n$$\n\nWe now evaluate the convolution with the rectangular pulse. For $t \\ge 0$,\n\\begin{align*}\n\\Theta(t) &= P_{0} \\int_{0}^{\\min(t, t_{p})} \\left[\\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\left(-\\frac{t - \\tau}{\\tau_{i}}\\right)\\right] d\\tau \\\\\n&= P_{0} \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) \\int_{0}^{\\min(t, t_{p})} \\exp\\left(\\frac{\\tau}{\\tau_{i}}\\right) d\\tau \\\\\n&= P_{0} \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) \\left[ \\tau_{i} \\left( \\exp\\left(\\frac{\\min(t, t_{p})}{\\tau_{i}}\\right) - 1 \\right) \\right] \\\\\n&= P_{0} \\sum_{i=1}^{N} R_{i} \\left( \\exp\\left(-\\frac{t - \\min(t, t_{p})}{\\tau_{i}}\\right) - \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) \\right).\n\\end{align*}\nThis compact form is valid for all $t \\ge 0$. It is often useful to express the result in terms of the Heaviside unit step function, exploiting the identity of a rectangular pulse as the difference of two steps:\n$$\nP(t) = P_{0} \\big(u(t) - u(t - t_{p})\\big).\n$$\nConvolution with the impulse response can be rewritten using the step response, because for any causal LTI system,\n$$\n\\int_{0}^{t} u(\\tau)\\, h(t - \\tau)\\, d\\tau = Z_{\\mathrm{th,step}}(t).\n$$\nTherefore,\n\\begin{align*}\n\\Theta(t) &= P_{0} \\left[ Z_{\\mathrm{th,step}}(t) - u(t - t_{p})\\, Z_{\\mathrm{th,step}}(t - t_{p}) \\right] \\\\\n&= P_{0} \\sum_{i=1}^{N} R_{i} \\left[ \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{i}}\\right)\\right) - u(t - t_{p}) \\left(1 - \\exp\\left(-\\frac{t - t_{p}}{\\tau_{i}}\\right)\\right) \\right].\n\\end{align*}\nThis is an equivalent closed-form expression valid for all $t \\ge 0$. To verify consistency:\n- For $t < t_{p}$, $u(t - t_{p}) = 0$, and $\\Theta(t) = P_{0} \\sum_{i=1}^{N} R_{i} \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{i}}\\right)\\right)$, which is the temperature rise under a constant power step of amplitude $P_{0}$ up to time $t$.\n- For $t \\ge t_{p}$, the second term subtracts the delayed step response, yielding $\\Theta(t) = P_{0} \\sum_{i=1}^{N} R_{i} \\left( \\exp\\left(-\\frac{t - t_{p}}{\\tau_{i}}\\right) - \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) \\right)$, which decays to zero as $t \\to \\infty$.\n\nBoth forms are closed-form and correspond to Kelvin units for temperature rise by construction. The final requested expression, in terms of $P_{0}$, $t_{p}$, and $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$, is given below.",
            "answer": "$$\\boxed{P_{0} \\sum_{i=1}^{N} R_{i} \\left[ 1 - \\exp\\left( - \\frac{t}{\\tau_{i}} \\right) - u(t - t_{p}) \\left( 1 - \\exp\\left( - \\frac{t - t_{p}}{\\tau_{i}} \\right) \\right) \\right]}$$"
        },
        {
            "introduction": "While the Foster network provides a convenient mathematical form for fitting transient thermal data, the Cauer network has a direct correspondence to the physical structure of heat flow from junction to ambient. This exercise  guides you through the essential process of converting a Foster model into its equivalent Cauer ladder form. By using continued fraction expansion, you will not only perform the transformation but also prove the positivity of the resulting elements, a critical step that guarantees the physical realizability of the thermal model.",
            "id": "4269069",
            "problem": "You are given a Foster thermal impedance representation of a linear time-invariant compact thermal model for an integrated circuit block, where the electrical analogy equates thermal resistance to electrical resistance and thermal capacitance to electrical capacitance. The thermal impedance in the Laplace domain is\n$$\nZ_{th}(s) \\;=\\; \\sum_{i=1}^{N} \\frac{r_i}{1 + s \\tau_i},\n$$\nwhere $s$ is the Laplace variable, $r_i$ are positive thermal resistances in $\\mathrm{K/W}$, and $\\tau_i$ are positive time constants in $\\mathrm{s}$ with $\\tau_i = r_i c_i$ for thermal capacitances $c_i$ in $\\mathrm{J/K}$. This representation is commonly extracted from transient thermal measurements or Finite Element Analysis (FEA) and used with circuit simulators such as the Simulation Program with Integrated Circuit Emphasis (SPICE) in Electronic Design Automation (EDA) flows.\n\nStarting from the thermal-electrical analogy, the linearity of the thermal system, and the passivity of purely resistive-capacitive networks, derive the Cauer ladder (Cauer-II form) of $Z_{th}(s)$ using continued fraction expansion. Specifically:\n- Begin from first principles to justify that $Z_{th}(s)$ is a strictly proper positive-real Stieltjes function for $\\Re\\{s\\} > 0$.\n- Perform the leading steps of the continued fraction expansion by considering the reciprocal $Y(s) = 1/Z_{th}(s)$ and extracting the first shunt thermal capacitance $C_0$ and the next series thermal resistance $R_1$ in terms of the Foster parameters $\\{r_i,\\tau_i\\}$.\n- Using a moment-based argument tied to the series expansion of $Z_{th}(s)$ at high frequency, prove that the extracted Cauer elements are positive.\n\nFor concreteness, consider the three-term Foster model with\n$$\nr_1 = 0.8 \\;\\mathrm{K/W}, \\quad \\tau_1 = 0.04 \\;\\mathrm{s}, \\quad\nr_2 = 0.5 \\;\\mathrm{K/W}, \\quad \\tau_2 = 0.01 \\;\\mathrm{s}, \\quad\nr_3 = 0.2 \\;\\mathrm{K/W}, \\quad \\tau_3 = 0.002 \\;\\mathrm{s}.\n$$\nCompute the first shunt thermal capacitance $C_0$ of the Cauer-II ladder realized from $Z_{th}(s)$ and express your final numerical answer in $\\mathrm{J/K}$. Express the final value exactly; no rounding is required. In your derivation, you must not invoke any shortcut formulas or synthesis rules, but rather obtain $C_0$ from the continued fraction expansion and the asymptotic behavior of $Y(s)$ at high frequency, and you must justify element positivity using a fundamental inequality of moments.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in network synthesis theory applied to the valid physical analogy between electrical and thermal systems for integrated circuit modeling. The provided data is complete and consistent.\n\nThe thermal impedance $Z_{th}(s)$ is given by a Foster-II representation of a passive RC network, which is a series connection of parallel RC branches. The impedance of the $i$-th branch, consisting of a resistor $r_i$ in parallel with a capacitor $c_i$, is $\\frac{r_i \\cdot (1/sc_i)}{r_i + 1/sc_i} = \\frac{r_i}{1+sr_ic_i}$. Defining the time constant $\\tau_i = r_i c_i$, the total impedance for $N$ such branches in series is:\n$$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{1 + s \\tau_i}$$\n\nFirst, we justify the properties of $Z_{th}(s)$.\n1.  **Positive-Real Function**: A function $Z(s)$ is positive-real if $\\Re\\{s\\} > 0$ implies $\\Re\\{Z(s)\\} \\ge 0$. Let $s = \\sigma + j\\omega$ with $\\sigma = \\Re\\{s\\} > 0$.\n    $$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{1 + (\\sigma + j\\omega)\\tau_i} = \\sum_{i=1}^{N} \\frac{r_i}{(1 + \\sigma\\tau_i) + j\\omega\\tau_i}$$\n    Taking the real part:\n    $$\\Re\\{Z_{th}(s)\\} = \\sum_{i=1}^{N} \\Re\\left\\{\\frac{r_i ((1 + \\sigma\\tau_i) - j\\omega\\tau_i)}{(1 + \\sigma\\tau_i)^2 + (\\omega\\tau_i)^2}\\right\\} = \\sum_{i=1}^{N} \\frac{r_i(1 + \\sigma\\tau_i)}{(1 + \\sigma\\tau_i)^2 + (\\omega\\tau_i)^2}$$\n    Given that $r_i > 0$, $\\tau_i > 0$, and we assume $\\sigma > 0$, every term in the summation is strictly positive. Therefore, $\\Re\\{Z_{th}(s)\\} > 0$ for $\\Re\\{s\\} > 0$, and the function is positive-real.\n\n2.  **Stieltjes Function**: A Stieltjes function is analytic everywhere except for a cut on the negative real axis, is real for positive real arguments, and has a positive imaginary part in the upper half-plane. The poles of $Z_{th}(s)$ are at $s = -1/\\tau_i$, which are all on the negative real axis. Since the coefficients $r_i$ are real, $Z_{th}(s)$ is real for real $s$. The function is a sum of individual terms, each of which is a Stieltjes function, so $Z_{th}(s)$ itself is a Stieltjes function.\n\n3.  **Strictly Proper Function**: A rational function is strictly proper if the degree of the numerator is less than the degree of the denominator. As $|s| \\to \\infty$, each term behaves as $\\frac{r_i}{s\\tau_i}$, so $Z_{th}(s) \\to 0$. This confirms the function is strictly proper.\n\nNext, we derive the Cauer-II ladder representation using continued fraction expansion about $s = \\infty$. This expansion synthesizes a ladder network with shunt capacitors and series resistors.\nThe thermal admittance is $Y(s) = 1/Z_{th}(s)$. Since $Z_{th}(s) \\to 0$ as $s \\to \\infty$, $Y(s)$ must tend to infinity. For an RC network, the admittance can at most grow linearly with $s$. The first Cauer element, a shunt capacitance $C_0$, is extracted by taking the limit:\n$$C_0 = \\lim_{s\\to\\infty} \\frac{Y(s)}{s} = \\lim_{s\\to\\infty} \\frac{1}{s Z_{th}(s)}$$\nTo evaluate this, we perform a series expansion of $Z_{th}(s)$ for large $s$:\n$$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{s\\tau_i(1 + 1/(s\\tau_i))} = \\sum_{i=1}^{N} \\frac{r_i}{s\\tau_i} \\left( 1 - \\frac{1}{s\\tau_i} + \\frac{1}{(s\\tau_i)^2} - \\dots \\right)$$\n$$Z_{th}(s) = \\frac{1}{s}\\left(\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}\\right) - \\frac{1}{s^2}\\left(\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}\\right) + O(s^{-3})$$\nLet's define the high-frequency moments $h_k$:\n$h_1 = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}$\n$h_2 = -\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}$\nSo, $Z_{th}(s) = \\frac{h_1}{s} + \\frac{h_2}{s^2} + O(s^{-3})$.\nNow we compute $C_0$:\n$$C_0 = \\lim_{s\\to\\infty} \\frac{1}{s\\left(\\frac{h_1}{s} + \\frac{h_2}{s^2} + \\dots\\right)} = \\lim_{s\\to\\infty} \\frac{1}{h_1 + \\frac{h_2}{s} + \\dots} = \\frac{1}{h_1}$$\n$$C_0 = \\frac{1}{\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}}$$\nThe remaining admittance after extracting $C_0$ is $Y_1(s) = Y(s) - sC_0$. The next element is a series resistance $R_1$, which is the high-frequency limit of the impedance $Z_1(s) = 1/Y_1(s)$.\n$$R_1 = \\lim_{s\\to\\infty} Z_1(s) = \\lim_{s\\to\\infty} \\frac{1}{Y(s) - sC_0}$$\nTo find this limit, we expand $Y(s)$ for large $s$:\n$$Y(s) = \\frac{1}{\\frac{h_1}{s} + \\frac{h_2}{s^2} + O(s^{-3})} = \\frac{s}{h_1} \\left(1 + \\frac{h_2}{h_1 s} + O(s^{-2})\\right)^{-1}$$\nUsing the binomial approximation $(1+x)^{-1} \\approx 1-x$:\n$$Y(s) \\approx \\frac{s}{h_1}\\left(1 - \\frac{h_2}{h_1 s}\\right) = \\frac{s}{h_1} - \\frac{h_2}{h_1^2}$$\nThe remainder admittance is $Y_1(s) \\approx \\left(\\frac{s}{h_1} - \\frac{h_2}{h_1^2}\\right) - s C_0 = \\left(\\frac{s}{h_1} - \\frac{h_2}{h_1^2}\\right) - \\frac{s}{h_1} = -\\frac{h_2}{h_1^2}$.\nThus, the next series resistance is:\n$$R_1 = \\frac{1}{\\lim_{s\\to\\infty} Y_1(s)} = \\frac{1}{-h_2/h_1^2} = -\\frac{h_1^2}{h_2} = \\frac{\\left(\\sum_i r_i/\\tau_i\\right)^2}{\\sum_i r_i/\\tau_i^2}$$\nWe prove the positivity of these elements using the moment-based argument. The moments $h_k$ are related to the impulse response $z(t) = \\mathcal{L}^{-1}\\{Z_{th}(s)\\}$.\n$$z(t) = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i} \\exp(-t/\\tau_i)$$\nThe coefficients of the $1/s$ expansion are the derivatives of $z(t)$ at $t=0$: $h_1 = z(0)$, $h_2 = z'(0)$, etc.\n$$h_1 = z(0) = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}$$\nSince $r_i > 0$ and $\\tau_i > 0$, each term is positive, so $h_1 > 0$. Consequently, $C_0 = 1/h_1 > 0$.\n$$h_2 = z'(0) = \\left[-\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2} \\exp(-t/\\tau_i)\\right]_{t=0} = -\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}$$\nSince $r_i > 0$ and $\\tau_i > 0$, the sum is positive, and $h_2 < 0$.\nTherefore, $R_1 = -h_1^2/h_2$ must be positive, as $h_1^2 > 0$ and $h_2 < 0$.\nThe positivity of all subsequent Cauer elements is guaranteed by determinantal inequalities on the moments (Hankel determinants), which for this type of function can be established from the Cauchy-Schwarz inequality. For example, the positivity of the next capacitor $C_2$ relies on the moment inequality $h_1h_3 > h_2^2$, which is a direct consequence of the Cauchy-Schwarz inequality.\n\nFinally, we compute the numerical value of $C_0$ for the given three-term Foster model with $N=3$:\n$r_1 = 0.8 \\;\\mathrm{K/W}, \\quad \\tau_1 = 0.04 \\;\\mathrm{s}$\n$r_2 = 0.5 \\;\\mathrm{K/W}, \\quad \\tau_2 = 0.01 \\;\\mathrm{s}$\n$r_3 = 0.2 \\;\\mathrm{K/W}, \\quad \\tau_3 = 0.002 \\;\\mathrm{s}$\n\nWe calculate the terms in the sum for $h_1$:\n$$\\frac{r_1}{\\tau_1} = \\frac{0.8}{0.04} = 20 \\;\\mathrm{W/K}$$\n$$\\frac{r_2}{\\tau_2} = \\frac{0.5}{0.01} = 50 \\;\\mathrm{W/K}$$\n$$\\frac{r_3}{\\tau_3} = \\frac{0.2}{0.002} = 100 \\;\\mathrm{W/K}$$\nThe moment $h_1$ is the sum of these values:\n$$h_1 = \\sum_{i=1}^{3} \\frac{r_i}{\\tau_i} = 20 + 50 + 100 = 170 \\;\\mathrm{W/K}$$\nThe first shunt thermal capacitance $C_0$ of the Cauer-II ladder is the reciprocal of $h_1$:\n$$C_0 = \\frac{1}{h_1} = \\frac{1}{170} \\;\\mathrm{J/K}$$\nThis value is exact as requested.",
            "answer": "$$\\boxed{\\frac{1}{170}}$$"
        },
        {
            "introduction": "The ultimate goal of thermal modeling is often to predict and manage system-level behavior, where electrical and thermal domains are inextricably linked. This capstone exercise  delves into the critical issue of current sharing among parallel-connected MOSFETs, a classic electro-thermal feedback problem. You will develop a computational algorithm to find the steady-state operating point, accounting for how temperature-dependent on-resistance and mutual thermal coupling between devices create current imbalance. This practice bridges the gap from abstract network models to tangible design challenges in power electronics.",
            "id": "3840370",
            "problem": "A set of $N$ metal–oxide–semiconductor field-effect transistors (MOSFETs) are connected in electrical parallel and mounted on a common heatsinking structure that creates self and mutual thermal couplings. Each MOSFET conducts under a shared drain-to-source voltage such that currents divide according to the instantaneous on-resistances. The on-resistance of the $i$-th MOSFET is modeled as a linear function of its junction temperature, $R_{\\mathrm{ds},i}(T_i) = R_{0,i} \\big( 1 + \\alpha_i (T_i - T_{\\mathrm{ref}}) \\big)$, where $R_{0,i}$ is the on-resistance at the reference temperature $T_{\\mathrm{ref}}$, and $\\alpha_i$ is the temperature coefficient. The junction temperatures are determined by the thermal network driven by the dissipated powers. The thermal network is represented using the widely adopted Foster and Cauer thermal modeling approaches.\n\nFundamental base:\n- Heat diffusion in solids can be approximated by an equivalent electrical network: temperature is mapped to voltage, heat flow to current, thermal resistance to electrical resistance, and thermal capacitance to electrical capacitance. In steady state (time-invariant operation), thermal capacitances behave as open circuits, and only thermal resistances contribute to temperature rises.\n- The Foster representation expresses the thermal impedance as a sum of parallel resistor–capacitor branches. In steady state, each capacitor effectively becomes an open circuit, and the thermal impedance reduces to the sum of the resistive parts, yielding the direct-current (DC) thermal resistance from junction to ambient.\n- The Cauer representation realizes the same thermal impedance as a ladder network of series resistors and shunt capacitors; in steady state, the capacitors again open, leaving a series chain of resistors whose sum equals the DC thermal resistance. Both Foster and Cauer representations produce the same steady-state thermal resistance.\n- For multiple heat sources with thermal coupling, a thermal resistance matrix $Z \\in \\mathbb{R}^{N \\times N}$ relates the vector of junction temperature rises $\\Delta T$ to the vector of dissipated powers $P$: $\\Delta T = Z P$. The diagonal entries $Z_{ii}$ represent self thermal resistances of each device to ambient, and the off-diagonal entries $Z_{ij}$ represent mutual thermal resistances through the common structure. In steady state, $Z$ is symmetric and positive definite under physically realizable conditions.\n\nObjective:\nStarting from the electrical parallel connection and the steady-state thermal network, derive the fixed-point equations that determine the steady-state current division among the $N$ MOSFETs due to thermal feedback. Using these equations, implement an algorithm that computes the steady-state currents and quantifies the imbalance. Define the imbalance metric as the ratio of the maximum MOSFET current to the minimum MOSFET current, namely $I_{\\max}/I_{\\min}$.\n\nAssumptions and definitions:\n- All MOSFETs share the same drain-to-source voltage and conduct in the ohmic region; their currents divide according to conductances $G_i(T_i) = 1 / R_{\\mathrm{ds},i}(T_i)$ under a fixed total current $I_{\\mathrm{tot}}$.\n- Power dissipated by the $i$-th MOSFET in steady state is $P_i = I_i^2 R_{\\mathrm{ds},i}(T_i)$.\n- Junction temperatures satisfy $T_i = T_{\\mathrm{amb}} + \\sum_{j=1}^N Z_{ij} P_j$, where $T_{\\mathrm{amb}}$ is the ambient temperature.\n- The Foster parameters for self thermal impedances of each device are provided as lists of resistor values (each in kelvin per watt) corresponding to the resistive elements of the Foster branches; the steady-state self thermal resistance is the sum of these values. Mutual thermal resistances are provided directly as steady-state values (in kelvin per watt).\n- Express all temperatures in degrees Celsius, all electrical resistances in ohms, all thermal resistances in kelvin per watt, all currents in amperes, and all powers in watts. The imbalance ratio $I_{\\max}/I_{\\min}$ is unitless.\n\nYour program must construct the steady-state thermal resistance matrix $Z$ from the provided Foster self-resistor lists and the mutual coupling values, then solve for the steady-state currents using a principled iterative method derived from the fundamental base. For numerical stability, you may employ relaxation in the fixed-point iteration, but you must detect convergence by a norm-based criterion on temperature updates.\n\nTest suite:\nCompute the imbalance ratio $I_{\\max}/I_{\\min}$ for the following five parameter sets. Each set specifies $N$, ambient temperature $T_{\\mathrm{amb}}$, reference temperature $T_{\\mathrm{ref}}$, total current $I_{\\mathrm{tot}}$, per-device electrical parameters $\\{R_{0,i}, \\alpha_i\\}$, Foster self-thermal resistor lists, and symmetric mutual thermal resistances $Z_{ij}$ for $i \\neq j$.\n\n- Case A (baseline symmetry with moderate coupling):\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$, $T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$, $\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$; $R_{0,2} = 5\\times 10^{-3}\\,\\Omega$, $\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster self resistors: device $1$: $\\{0.5, 0.7\\}\\,\\mathrm{K/W}$; device $2$: $\\{0.5, 0.7\\}\\,\\mathrm{K/W}$\n    - Mutual thermal resistances: $Z_{12} = Z_{21} = 0.2\\,\\mathrm{K/W}$\n- Case B (electrical mismatch with stronger coupling):\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$, $T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$, $\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$; $R_{0,2} = 6\\times 10^{-3}\\,\\Omega$, $\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster self resistors: device $1$: $\\{0.4, 0.6\\}\\,\\mathrm{K/W}$; device $2$: $\\{0.5, 0.5\\}\\,\\mathrm{K/W}$\n    - Mutual thermal resistances: $Z_{12} = Z_{21} = 0.4\\,\\mathrm{K/W}$\n- Case C (three devices with asymmetric mutual couplings and electrical mismatch):\n    - $N = 3$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$, $T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 180\\,\\mathrm{A}$\n    - $R_{0,1} = 4.5\\times 10^{-3}\\,\\Omega$, $\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$; $R_{0,2} = 5.0\\times 10^{-3}\\,\\Omega$, $\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$; $R_{0,3} = 5.5\\times 10^{-3}\\,\\Omega$, $\\alpha_3 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster self resistors: device $1$: $\\{0.6, 0.9\\}\\,\\mathrm{K/W}$; device $2$: $\\{0.6, 0.9\\}\\,\\mathrm{K/W}$; device $3$: $\\{0.6, 0.9\\}\\,\\mathrm{K/W}$\n    - Mutual thermal resistances: $Z_{12} = Z_{21} = 0.6\\,\\mathrm{K/W}$; $Z_{13} = Z_{31} = 0.1\\,\\mathrm{K/W}$; $Z_{23} = Z_{32} = 0.1\\,\\mathrm{K/W}$\n- Case D (no mutual coupling, identical devices):\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$, $T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$, $\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$; $R_{0,2} = 5\\times 10^{-3}\\,\\Omega$, $\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster self resistors: device $1$: $\\{0.6, 0.6\\}\\,\\mathrm{K/W}$; device $2$: $\\{0.6, 0.6\\}\\,\\mathrm{K/W}$\n    - Mutual thermal resistances: $Z_{12} = Z_{21} = 0.0\\,\\mathrm{K/W}$\n- Case E (single device sanity check):\n    - $N = 1$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$, $T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 80\\,\\mathrm{A}$\n    - $R_{0,1} = 5.0\\times 10^{-3}\\,\\Omega$, $\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster self resistors: device $1$: $\\{1.0, 0.5\\}\\,\\mathrm{K/W}$\n    - No mutual couplings\n\nProgram specification:\n- Construct $Z$ by setting $Z_{ii}$ equal to the sum of the Foster self resistors of device $i$, and $Z_{ij}$ equal to the provided mutual thermal resistance values for $i \\neq j$.\n- Solve for steady-state currents $I_i$ using a principled iterative algorithm consistent with the fundamental base and the definitions. Convergence shall be declared when the infinity norm of the temperature update is less than $10^{-9}\\,\\mathrm{K}$, or after a maximum of $10^4$ iterations. You may apply relaxation with a factor in $(0,1]$.\n- For each case, output the imbalance ratio $I_{\\max}/I_{\\min}$ as a decimal float with exactly six digits after the decimal point.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\big[$result1,result2,result3,result4,result5$\\big]$). The five entries must correspond to cases A through E, respectively, each printed with exactly six digits after the decimal point.",
            "solution": "The problem is assessed to be valid. The analysis and solution are presented below.\n\n### I. Problem Validation\n\n**Step 1: Extract Givens**\n- **Number of MOSFETs**: $N$\n- **On-resistance model**: $R_{\\mathrm{ds},i}(T_i) = R_{0,i} \\big( 1 + \\alpha_i (T_i - T_{\\mathrm{ref}}) \\big)$ for the $i$-th MOSFET.\n- **Electrical connection**: $N$ MOSFETs in parallel with a total current $I_{\\mathrm{tot}}$.\n- **Current division**: Currents $I_i$ divide according to conductances $G_i(T_i) = 1 / R_{\\mathrm{ds},i}(T_i)$.\n- **Power dissipation**: $P_i = I_i^2 R_{\\mathrm{ds},i}(T_i)$.\n- **Junction temperature model**: $T_i = T_{\\mathrm{amb}} + \\sum_{j=1}^N Z_{ij} P_j$, where $\\Delta T_i = T_i - T_{\\mathrm{amb}} = \\sum_{j=1}^N Z_{ij} P_j$.\n- **Thermal resistance matrix $Z$**: A symmetric, positive definite matrix in $\\mathbb{R}^{N \\times N}$.\n- **Construction of $Z$**:\n    - Diagonal elements $Z_{ii}$ are the sum of the resistive values from the Foster self-thermal impedance model for device $i$.\n    - Off-diagonal elements $Z_{ij}$ ($i \\neq j$) are provided directly as steady-state mutual thermal resistances.\n- **Objective**: Compute the steady-state current imbalance ratio $I_{\\max}/I_{\\min}$.\n- **Numerical parameters**:\n    - Convergence criterion: infinity norm of temperature vector update $< 10^{-9}\\,\\mathrm{K}$.\n    - Maximum iterations: $10^4$.\n    - Relaxation factor: $\\omega \\in (0, 1]$.\n- **Units**: Temperatures in degrees Celsius ($^\\circ\\mathrm{C}$), resistances in ohms ($\\Omega$), thermal resistances in kelvin per watt (K/W), currents in amperes (A), powers in watts (W).\n- **Test Cases**: Five distinct parameter sets (A, B, C, D, E) are provided with specific values for all required parameters.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on fundamental principles of electrical circuits (Ohm's law, current division) and heat transfer in power electronic systems. The linear model for on-resistance and the thermal resistance matrix ($Z$-parameter) approach are standard and widely accepted engineering approximations for analyzing electro-thermal behavior in power semiconductors. The equivalence of Foster and Cauer models in steady state is a correct statement. The problem is scientifically sound.\n- **Well-Posed**: The problem is mathematically well-defined. It describes a system of coupled non-linear equations for which a steady-state solution is sought. The positive temperature coefficients ($\\alpha_i > 0$) typically ensure a stable negative feedback mechanism, leading to a unique and stable fixed point. All necessary data and boundary conditions for the five test cases are provided, and the objective is clearly specified.\n- **Objective**: The problem is stated using precise, formal, and unbiased language, free of subjective claims.\n- **Completeness and Consistency**: The problem statement is self-contained. For each case, it provides all necessary numerical values and model parameters. The use of degrees Celsius for temperature and Kelvin per Watt for thermal resistance is consistent, as a temperature difference has the same numerical value in both scales ($\\Delta T\\,[\\mathrm{K}] = \\Delta T\\,[^\\circ\\mathrm{C}]$). The parameters provided are physically plausible.\n- **No other flaws**: The problem is not metaphorical, is directly relevant to the stated topic, contains no contradictions, poses a feasible task, is not ill-posed or trivial, and is scientifically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### II. Derivation of the Electro-Thermal Fixed-Point Equations\n\nThe steady-state behavior of the parallel-connected MOSFETs is governed by a set of coupled electro-thermal equations. The goal is to find the equilibrium point where the junction temperatures, on-resistances, currents, and dissipated powers are all self-consistent. A fixed-point iterative scheme is a natural method for solving such a system. We elect to iterate on the vector of junction temperatures, $T = [T_1, T_2, \\ldots, T_N]^T$.\n\nLet $T^{(k)}$ be the vector of junction temperatures at iteration $k$. The computational procedure to find the temperature vector at the next iteration, $T^{(k+1)}$, is as follows:\n\n1.  **Calculate On-Resistances**: From the temperature vector $T^{(k)}$, the on-resistance of each MOSFET, $R_{\\mathrm{ds},i}^{(k)}$, is updated using the given linear model:\n    $$R_{\\mathrm{ds},i}^{(k)} = R_{0,i} \\left( 1 + \\alpha_i (T_i^{(k)} - T_{\\mathrm{ref}}) \\right)$$\n\n2.  **Calculate Shared Voltage**: The MOSFETs are connected in parallel, so they share a common drain-to-source voltage, $V_{\\mathrm{ds}}$. The total current $I_{\\mathrm{tot}}$ is the sum of individual currents, $I_{\\mathrm{tot}} = \\sum_{j=1}^N I_j$. The total conductance of the parallel arrangement is $G_{\\mathrm{tot}}^{(k)} = \\sum_{j=1}^N G_j^{(k)} = \\sum_{j=1}^N \\frac{1}{R_{\\mathrm{ds},j}^{(k)}}$. The shared voltage is thus:\n    $$V_{\\mathrm{ds}}^{(k)} = \\frac{I_{\\mathrm{tot}}}{G_{\\mathrm{tot}}^{(k)}} = \\frac{I_{\\mathrm{tot}}}{\\sum_{j=1}^N \\frac{1}{R_{\\mathrm{ds},j}^{(k)}}}$$\n\n3.  **Calculate Power Dissipation**: The power dissipated by each MOSFET, $P_i^{(k)}$, can be calculated from the shared voltage and its individual resistance:\n    $$P_i^{(k)} = \\frac{(V_{\\mathrm{ds}}^{(k)})^2}{R_{\\mathrm{ds},i}^{(k)}}$$\n    The vector of dissipated powers is $P^{(k)} = [P_1^{(k)}, P_2^{(k)}, \\ldots, P_N^{(k)}]^T$.\n\n4.  **Update Junction Temperatures**: The new junction temperatures are calculated using the thermal network equation. Let $T^{(k+1, \\text{raw})}$ be the unrelaxed temperature update:\n    $$T^{(k+1, \\text{raw})} = T_{\\mathrm{amb}} \\mathbf{1} + Z P^{(k)}$$\n    where $\\mathbf{1}$ is a vector of ones of size $N$, and $Z$ is the steady-state thermal resistance matrix.\n\n5.  **Apply Relaxation**: To improve the stability and convergence of the iteration, a relaxation step is introduced. The updated temperature vector $T^{(k+1)}$ is a weighted average of the previous temperature $T^{(k)}$ and the new raw calculation $T^{(k+1, \\text{raw})}$:\n    $$T^{(k+1)} = (1 - \\omega) T^{(k)} + \\omega T^{(k+1, \\text{raw})}$$\n    where $\\omega \\in (0, 1]$ is the relaxation factor.\n\nThe iteration starts with an initial guess, typically $T^{(0)} = T_{\\mathrm{amb}} \\mathbf{1}$, and continues until the change in the temperature vector is negligibly small, i.e., when $\\|T^{(k+1)} - T^{(k)}\\|_{\\infty} < \\epsilon$ for a small tolerance $\\epsilon$.\n\n### III. Algorithmic Implementation\n\nThe solution is implemented as a Python program that follows the derived fixed-point iteration.\n\n**1. Construction of the Thermal Resistance Matrix $Z$**\nThe matrix $Z \\in \\mathbb{R}^{N \\times N}$ is constructed first.\n- For the diagonal elements, $Z_{ii}$, the provided list of Foster self-resistors for device $i$ is summed. This sum represents the total DC thermal resistance from the junction of device $i$ to the ambient.\n  $$Z_{ii} = \\sum_{r \\in \\text{FosterResistors}_i} r$$\n- For the off-diagonal elements, $Z_{ij}$ where $i \\neq j$, the provided mutual thermal resistance values are used. Since the matrix is symmetric, $Z_{ij} = Z_{ji}$.\n\n**2. Iterative Solution for Steady-State Temperatures**\nThe algorithm proceeds as follows:\n- Initialize the temperature vector: $T \\leftarrow T_{\\mathrm{amb}} \\mathbf{1}$.\n- Set iteration parameters: maximum iterations $k_{\\max} = 10^4$, convergence tolerance $\\epsilon = 10^{-9}\\,\\mathrm{K}$, relaxation factor $\\omega$. A value of $\\omega = 0.25$ is chosen for robust convergence.\n- Loop for $k$ from $0$ to $k_{\\max}-1$:\n    a. Calculate $R_{\\mathrm{ds},i}$ for all $i = 1, \\ldots, N$ based on the current $T$.\n    b. Calculate $V_{\\mathrm{ds}}$ from $I_{\\mathrm{tot}}$ and the sum of conductances $1/R_{\\mathrm{ds},i}$.\n    c. Calculate powers $P_i = V_{\\mathrm{ds}}^2 / R_{\\mathrm{ds},i}$.\n    d. Compute the raw temperature update $T_{\\text{new\\_raw}} = T_{\\mathrm{amb}} \\mathbf{1} + Z P$.\n    e. Apply relaxation: $T_{\\text{new}} = (1-\\omega)T + \\omega T_{\\text{new\\_raw}}$.\n    f. Check for convergence: if $\\max_i |T_{\\text{new},i} - T_i| < \\epsilon$, exit the loop.\n    g. Update temperatures for the next iteration: $T \\leftarrow T_{\\text{new}}$.\n\n**3. Calculation of Final Quantities**\n- Once the iteration converges to the steady-state temperature vector $T_{\\mathrm{ss}}$, the final, self-consistent values for resistances, voltage, and currents are computed.\n- The steady-state resistances are $R_{\\mathrm{ds},i}(T_{\\mathrm{ss},i})$.\n- The steady-state voltage is $V_{\\mathrm.ds, ss} = I_{\\mathrm{tot}} / \\sum_j (1/R_{\\mathrm{ds},j}(T_{\\mathrm{ss},j}))$.\n- The steady-state currents are $I_i = V_{\\mathrm{ds,ss}} / R_{\\mathrm{ds},i}(T_{\\mathrm{ss},i})$.\n- Finally, the current imbalance ratio is computed as:\n  $$\\text{Imbalance} = \\frac{\\max(I_1, I_2, \\ldots, I_N)}{\\min(I_1, I_2, \\ldots, I_N)}$$\nThis procedure is applied to each of the five test cases provided. For the special case of $N=1$, the current is simply $I_1 = I_{\\mathrm{tot}}$, and the imbalance ratio is trivially $1$. For symmetric cases (A and D), the imbalance is also expected to be $1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the current imbalance in parallel MOSFETs\n    for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: baseline symmetry with moderate coupling\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 5e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.5, 0.7], [0.5, 0.7]],\n            \"mutual_resistances_dict\": {(1, 2): 0.2}\n        },\n        # Case B: electrical mismatch with stronger coupling\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 6e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.4, 0.6], [0.5, 0.5]],\n            \"mutual_resistances_dict\": {(1, 2): 0.4}\n        },\n        # Case C: three devices with asymmetric mutual couplings and electrical mismatch\n        {\n            \"N\": 3, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 180.0,\n            \"R0_list\": [4.5e-3, 5.0e-3, 5.5e-3],\n            \"alpha_list\": [4e-3, 4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.6, 0.9], [0.6, 0.9], [0.6, 0.9]],\n            \"mutual_resistances_dict\": {(1, 2): 0.6, (1, 3): 0.1, (2, 3): 0.1}\n        },\n        # Case D: no mutual coupling, identical devices\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 5e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.6, 0.6], [0.6, 0.6]],\n            \"mutual_resistances_dict\": {(1, 2): 0.0}\n        },\n        # Case E: single device sanity check\n        {\n            \"N\": 1, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 80.0,\n            \"R0_list\": [5.0e-3], \"alpha_list\": [4e-3],\n            \"foster_resistors_list\": [[1.0, 0.5]],\n            \"mutual_resistances_dict\": {}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(**case)\n        results.append(result)\n\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef _solve_case(N, Tamb, Tref, Itot, R0_list, alpha_list, foster_resistors_list, mutual_resistances_dict):\n    \"\"\"\n    Solves a single electro-thermal case using a fixed-point iteration method.\n    \"\"\"\n    if N == 0:\n        return 1.0\n    if N == 1:\n        return 1.0\n\n    # 1. Build the steady-state thermal resistance matrix Z\n    Z = np.zeros((N, N))\n    for i in range(N):\n        Z[i, i] = sum(foster_resistors_list[i])\n    for (i, j), val in mutual_resistances_dict.items():\n        # Convert 1-based device indices to 0-based array indices\n        Z[i - 1, j - 1] = val\n        Z[j - 1, i - 1] = val\n\n    # 2. Convert electrical parameter lists to numpy arrays for vectorized operations\n    R0 = np.array(R0_list)\n    alpha = np.array(alpha_list)\n\n    # 3. Fixed-point iteration to find steady-state temperatures\n    max_iter = 10000\n    tol = 1e-9\n    omega = 0.25  # Relaxation factor for stability\n\n    # Initial guess for temperatures\n    T = np.full(N, Tamb)\n\n    for _ in range(max_iter):\n        # Calculate on-resistances based on current temperatures\n        Rds = R0 * (1.0 + alpha * (T - Tref))\n\n        # Calculate total conductance and shared drain-source voltage\n        G_tot = np.sum(1.0 / Rds)\n        Vds = Itot / G_tot\n\n        # Calculate power dissipation in each device\n        P = Vds**2 / Rds\n        \n        # Calculate new temperatures using the thermal network equation\n        T_new_raw = Tamb + Z @ P\n        \n        # Apply relaxation\n        T_new = (1.0 - omega) * T + omega * T_new_raw\n\n        # Check for convergence using infinity norm\n        if np.linalg.norm(T_new - T, ord=np.inf)  tol:\n            T = T_new\n            break\n        \n        T = T_new\n    \n    # 4. Calculate final currents and the imbalance ratio\n    # Recompute state variables with the converged temperature\n    Rds_final = R0 * (1.0 + alpha * (T - Tref))\n    G_tot_final = np.sum(1.0 / Rds_final)\n    Vds_final = Itot / G_tot_final\n    I_final = Vds_final / Rds_final\n\n    imbalance = np.max(I_final) / np.min(I_final)\n    \n    return imbalance\n\nsolve()\n```"
        }
    ]
}