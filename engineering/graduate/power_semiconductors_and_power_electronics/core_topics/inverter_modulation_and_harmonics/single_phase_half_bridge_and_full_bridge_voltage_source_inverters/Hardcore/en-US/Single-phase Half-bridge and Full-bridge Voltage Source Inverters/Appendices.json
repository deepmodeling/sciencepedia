{
    "hands_on_practices": [
        {
            "introduction": "Mastering inverter analysis begins with understanding how to model its output for steady-state conditions. This first exercise  challenges you to apply the principle of time-scale separation, where the high-frequency switched voltage is averaged to find its fundamental sinusoidal component. By treating the inverter as an ideal AC source at the fundamental frequency, you will derive the steady-state current and explore the crucial role of inductance in ensuring current continuity, a cornerstone concept in power electronics.",
            "id": "3878713",
            "problem": "Consider an ideal single-phase half-bridge voltage source inverter with a split direct-current bus of total voltage $V_{\\mathrm{dc}}$ and equal capacitors forming the neutral point. The leg output node connects to a series load composed of resistance $R$, inductance $L$, and capacitance $C$. The devices are ideal metal-oxide-semiconductor field-effect transistors (MOSFETs) with antiparallel diodes and negligible dead-time. The inverter is modulated with carrier-based sinusoidal pulse-width modulation (SPWM) using a triangular carrier of angular frequency $\\omega_{\\mathrm{s}}$ and a sinusoidal reference $v_{\\mathrm{ref}}(t)$ of angular frequency $\\omega_{1}$, where $\\omega_{\\mathrm{s}} \\gg \\omega_{1}$. The sinusoidal reference has a dimensionless modulation index $m$ satisfying $0 < m < 1$ and fundamental frequency $\\omega_{1}$. \n\nAssume a time-scale separation in which the load dynamics at the fundamental $\\omega_{1}$ are slow compared to the switching dynamics at $\\omega_{\\mathrm{s}}$, so that over one carrier period the load sees the average of the two-level leg voltage. Starting strictly from Kirchhoff’s Voltage Law (KVL), the constitutive relations $v_{R}(t) = R\\,i(t)$, $v_{L}(t) = L\\,\\mathrm{d}i/\\mathrm{d}t$, $i(t) = C\\,\\mathrm{d}v_{C}/\\mathrm{d}t$ for the series load, and the definition of carrier-based SPWM as a duty-ratio modulation of the two-level leg voltage in response to $v_{\\mathrm{ref}}(t)$, derive the steady-state fundamental load current waveform $i(t)$ in closed form. Express $i(t)$ in amperes and angles in radians. \n\nAdditionally, determine—using first principles and without assuming any non-physical shortcuts—whether the load current can exhibit discontinuities during intervals in which the leg’s averaged output over a carrier period is zero (zero-voltage average states), and identify the physical conditions required for such discontinuities to arise or be precluded.\n\nYour final answer must be a single closed-form analytic expression for the steady-state current waveform $i(t)$. No rounding is required; provide the exact expression. Angles must be in radians.",
            "solution": "The problem statement is critically evaluated and found to be valid. It is scientifically grounded, well-posed, and objective. It presents a standard, albeit comprehensive, problem in power electronics that is solvable using first principles of circuit theory and the theory of pulse-width modulation. All necessary parameters are provided in symbolic form, and the assumptions, such as ideal components and time-scale separation, are explicitly stated and appropriate for a theoretical derivation.\n\nThe derivation proceeds in two parts as requested: first, the derivation of the steady-state load current, and second, the analysis of potential current discontinuities.\n\n**Part 1: Derivation of the Steady-State Fundamental Load Current $i(t)$**\n\nThe single-phase half-bridge inverter topology consists of two series switches connected across a DC voltage source. The DC source is described as a split bus of total voltage $V_{\\mathrm{dc}}$, with a center-tap neutral point. This means the upper rail is at a potential of $+\\frac{V_{\\mathrm{dc}}}{2}$ and the lower rail is at $-\\frac{V_{\\mathrm{dc}}}{2}$ with respect to the neutral point. The load is connected between the inverter leg's midpoint, node $a$, and the DC bus neutral point, node $o$.\n\nThe instantaneous voltage at the leg output, $v_{ao}(t)$, can only take one of two values: $+\\frac{V_{\\mathrm{dc}}}{2}$ or $-\\frac{V_{\\mathrm{dc}}}{2}$, depending on which switch is conducting. The inverter is controlled by sinusoidal pulse-width modulation (SPWM). The reference signal is a sinusoid, $v_{\\mathrm{ref}}(t)$, with amplitude proportional to the modulation index $m$. The problem states the reference is $v_{\\mathrm{ref}}(t)$ of angular frequency $\\omega_1$ and dimensionless modulation index $m$. We can represent the normalized reference signal as $m \\sin(\\omega_1 t)$.\n\nThe core principle of SPWM is that the local average of the switched output voltage, $\\langle v_{ao}(t) \\rangle$, over one switching period $T_s = 2\\pi/\\omega_s$, is directly proportional to the value of the reference signal at that instant. Given the symmetrical DC bus, the relationship is:\n$$\n\\langle v_{ao}(t) \\rangle = \\left(\\frac{V_{\\mathrm{dc}}}{2}\\right) m \\sin(\\omega_1 t)\n$$\nThe problem specifies that due to the time-scale separation ($\\omega_s \\gg \\omega_1$), the RLC load responds primarily to this average voltage. Therefore, we can model the system for the purpose of finding the fundamental steady-state current by considering a sinusoidal voltage source of value $v_{load}(t) = \\langle v_{ao}(t) \\rangle$ applied to the series RLC load.\nThe peak amplitude of this fundamental voltage is $V_1 = \\frac{V_{\\mathrm{dc}} m}{2}$. So, the effective voltage source driving the load is:\n$$\nv_{load}(t) = V_1 \\sin(\\omega_1 t) = \\frac{V_{\\mathrm{dc}} m}{2} \\sin(\\omega_1 t)\n$$\nAccording to Kirchhoff's Voltage Law (KVL), the sum of voltage drops across the load components must equal this source voltage:\n$$\nv_R(t) + v_L(t) + v_C(t) = v_{load}(t)\n$$\nSubstituting the constitutive relations for the resistor, inductor, and capacitor:\n$$\nR\\,i(t) + L\\,\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t} + v_C(t) = \\frac{V_{\\mathrm{dc}} m}{2} \\sin(\\omega_1 t)\n$$\nTo find the steady-state current $i(t)$, we employ the phasor method. The forcing function $v_{load}(t)$ is a sinusoid of angular frequency $\\omega_1$. The total impedance of the series RLC circuit at this frequency, $\\mathbf{Z}(\\omega_1)$, is the sum of the individual impedances:\n$$\n\\mathbf{Z}(\\omega_1) = Z_R + Z_L + Z_C = R + j\\omega_1 L + \\frac{1}{j\\omega_1 C}\n$$\nThis can be written in rectangular form as:\n$$\n\\mathbf{Z}(\\omega_1) = R + j\\left(\\omega_1 L - \\frac{1}{\\omega_1 C}\\right)\n$$\nThe impedance can be expressed in polar form as $\\mathbf{Z}(\\omega_1) = |\\mathbf{Z}|\\exp(j\\phi_Z)$, where the magnitude $|\\mathbf{Z}|$ and phase angle $\\phi_Z$ are:\n$$\n|\\mathbf{Z}| = \\sqrt{R^2 + \\left(\\omega_1 L - \\frac{1}{\\omega_1 C}\\right)^2}\n$$\n$$\n\\phi_Z = \\arctan\\left(\\frac{\\omega_1 L - \\frac{1}{\\omega_1 C}}{R}\\right)\n$$\nThe voltage source $v_{load}(t) = V_1 \\sin(\\omega_1 t)$ can be represented by the phasor $\\mathbf{V}_{load}$. Using a sine reference, we can represent the voltage as the imaginary part of a complex exponential: $v_{load}(t) = \\mathrm{Im}\\{V_1 \\exp(j\\omega_1 t)\\}$.\nThe steady-state current phasor $\\mathbf{I}$ is given by Ohm's law in the frequency domain:\n$$\n\\mathbf{I} = \\frac{\\mathbf{V}_{load}}{\\mathbf{Z}(\\omega_1)}\n$$\nThe complex time-domain current is then:\n$$\n\\mathbf{i}(t) = \\frac{V_1 \\exp(j\\omega_1 t)}{|\\mathbf{Z}| \\exp(j\\phi_Z)} = \\frac{V_1}{|\\mathbf{Z}|} \\exp(j(\\omega_1 t - \\phi_Z))\n$$\nThe real-valued, time-domain current $i(t)$ is the imaginary part of this complex function:\n$$\ni(t) = \\mathrm{Im}\\{\\mathbf{i}(t)\\} = \\frac{V_1}{|\\mathbf{Z}|} \\sin(\\omega_1 t - \\phi_Z)\n$$\nSubstituting the expressions for $V_1$, $|\\mathbf{Z}|$, and $\\phi_Z$, we obtain the final closed-form expression for the steady-state fundamental load current:\n$$\ni(t) = \\frac{\\frac{V_{\\mathrm{dc}} m}{2}}{\\sqrt{R^2 + \\left(\\omega_1 L - \\frac{1}{\\omega_1 C}\\right)^2}} \\sin\\left(\\omega_1 t - \\arctan\\left(\\frac{\\omega_1 L - \\frac{1}{\\omega_1 C}}{R}\\right)\\right)\n$$\n\n**Part 2: Analysis of Current Discontinuities**\n\nThe question asks whether the load current $i(t)$ can exhibit discontinuities. We must analyze the full, non-averaged circuit dynamics to answer this rigorously from first principles. The instantaneous KVL for the circuit is:\n$$\nv_{ao}(t) = R\\,i(t) + L\\,\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t} + v_C(t)\n$$\nwhere $v_{ao}(t)$ is the switched voltage, taking values from the set $\\{+\\frac{V_{\\mathrm{dc}}}{2}, -\\frac{V_{\\mathrm{dc}}}{2}\\}$. A discontinuity in the current $i(t)$ implies that its derivative, $\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t}$, would be infinite (a Dirac delta function) at the point of discontinuity.\n\nLet's rearrange the KVL equation to solve for the term containing the derivative:\n$$\nL\\,\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t} = v_{ao}(t) - R\\,i(t) - v_C(t)\n$$\nTo assess the possibility of an infinite $\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t}$, we must examine the terms on the right-hand side:\n1.  **$v_{ao}(t)$**: This is the inverter output voltage. It is always finite, bounded by $\\pm\\frac{V_{\\mathrm{dc}}}{2}$.\n2.  **$R\\,i(t)$**: If $i(t)$ were to have a finite jump discontinuity, its value would remain finite on both sides of the jump. Thus, $R\\,i(t)$ is finite.\n3.  **$v_C(t)$**: The voltage across the capacitor is given by the integral of the current: $v_C(t) = v_C(t_0) + \\frac{1}{C} \\int_{t_0}^t i(\\tau)\\,\\mathrm{d}\\tau$. The integral of a function with a finite jump discontinuity is continuous. Therefore, the capacitor voltage $v_C(t)$ cannot change instantaneously and must be continuous. A discontinuity in $v_C(t)$ would require an impulsive current $i(t)$, which is not possible as there are no infinite voltage sources in the circuit.\n\nSince $v_{ao}(t)$, $R\\,i(t)$, and $v_C(t)$ are all finite at any instant in time, their sum on the right-hand side of the rearranged KVL equation must also be finite.\n$$\nL\\,\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t} = \\text{finite value}\n$$\nThis leads to the crucial condition. If the inductance $L$ is strictly greater than zero ($L > 0$), then in order for the equation to hold, the derivative $\\frac{\\mathrm{d}i(t)}{\\mathrm{d}t}$ must also be finite. A function with a finite derivative everywhere must be continuous.\n\nTherefore, the physical condition that precludes current discontinuities is the presence of a non-zero inductance, $L > 0$, in the current path. The inductor's physical nature is to oppose instantaneous changes in current, storing or releasing energy to maintain current continuity. The reference to \"zero-voltage average states\" (i.e., the zero-crossings of the fundamental component) is irrelevant to the instantaneous physical continuity of the current, which is governed by the presence of energy storage elements like the inductor. If $L$ were zero, current discontinuities would occur at each switching instant, as the step changes in $v_{ao}(t)$ would need to be matched by step changes in $R\\,i(t)$ to satisfy KVL, since $v_C(t)$ remains continuous.",
            "answer": "$$\n\\boxed{\\frac{\\frac{V_{\\mathrm{dc}} m}{2}}{\\sqrt{R^2 + \\left(\\omega_1 L - \\frac{1}{\\omega_1 C}\\right)^2}} \\sin\\left(\\omega_1 t - \\arctan\\left(\\frac{\\omega_1 L - \\frac{1}{\\omega_1 C}}{R}\\right)\\right)}\n$$"
        },
        {
            "introduction": "While linear modulation is ideal, practical inverters are often pushed into overmodulation to maximize output voltage, a process that inevitably introduces distortion. This practice problem  focuses on quantifying this trade-off by analyzing the clipped waveform that results when the modulation index $m$ is greater than one ($m \\gt 1$). You will use Fourier series analysis to derive a closed-form expression for the Total Harmonic Distortion (THD), gaining critical insight into how inverter operating limits affect output power quality.",
            "id": "3878571",
            "problem": "A single-phase full-bridge voltage source inverter is driven by bipolar sinusoidal pulse-width modulation with a high carrier ratio so that the low-frequency output voltage can be modeled by the average over each carrier period. The direct-current link voltage is a constant $V_{\\mathrm{dc}}$. The commanded low-frequency reference is $m \\sin(\\omega t)$, where $m > 1$ so that the duty cycle command saturates at its bounds $\\pm 1$ around the peaks of the sinusoidal cycle. Ideal switches are assumed (no dead-time, no voltage drops), and switching-ripple components at the carrier and its sidebands are to be neglected; only the baseband (low-frequency) content induced by the saturation nonlinearity is to be considered. All angles are in radians.\n\nUnder these assumptions, the averaged output voltage over the carrier period is\n$$\nv(t) = V_{\\mathrm{dc}} \\,\\mathrm{clip}\\big(m \\sin(\\omega t), -1, +1\\big).\n$$\nLet $\\theta = \\omega t$, and define the clipping angle $\\alpha \\in (0, \\pi/2]$ implicitly by $\\sin(\\alpha) = 1/m$.\n\nStarting from Fourier series definitions and energy conservation for periodic waveforms, and using only fundamental properties of trigonometric integrals, derive an exact, closed-form expression for the total harmonic distortion of the baseband output voltage, defined as\n$$\n\\mathrm{THD} \\triangleq \\sqrt{\\frac{V_{\\mathrm{rms}}^{2} - V_{1,\\mathrm{rms}}^{2}}{V_{1,\\mathrm{rms}}^{2}}},\n$$\nwhere $V_{\\mathrm{rms}}$ is the root-mean-square of the baseband voltage $v(t)$ over one fundamental period and $V_{1,\\mathrm{rms}}$ is the root-mean-square value of its fundamental component. Express your final answer as a single closed-form analytic expression in terms of the modulation index $m$ only, using standard elementary functions. Express the final THD as a dimensionless decimal (do not use a percentage sign). No numerical substitution is required.",
            "solution": "The user wants to derive a closed-form expression for the Total Harmonic Distortion (THD) of the baseband output voltage of a single-phase inverter operating in overmodulation.\n\n### Step 1: Extract Givens\n- Inverter: Single-phase full-bridge voltage source inverter.\n- DC Link Voltage: Constant $V_{\\mathrm{dc}}$.\n- Modulation: Bipolar sinusoidal PWM with commanded reference $m \\sin(\\omega t)$.\n- Modulation Index: $m > 1$.\n- Averaged output voltage: $v(t) = V_{\\mathrm{dc}} \\,\\mathrm{clip}\\big(m \\sin(\\omega t), -1, +1\\big)$.\n- Switch model: Ideal switches, switching ripple is neglected.\n- Angular variable: $\\theta = \\omega t$.\n- Clipping angle: $\\alpha \\in (0, \\pi/2]$ is defined by $\\sin(\\alpha) = 1/m$.\n- THD Definition: $\\mathrm{THD} \\triangleq \\sqrt{\\frac{V_{\\mathrm{rms}}^{2} - V_{1,\\mathrm{rms}}^{2}}{V_{1,\\mathrm{rms}}^{2}}}$, where $V_{\\mathrm{rms}}$ is the RMS value of $v(t)$ and $V_{1,\\mathrm{rms}}$ is the RMS value of its fundamental component.\n- Required Output: A closed-form expression for THD in terms of $m$ only.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of power electronics and Fourier analysis. The model for the averaged output voltage of a PWM inverter in overmodulation is standard. The problem is well-posed, providing all necessary information ($v(t)$, $m>1$, THD definition) to derive a unique solution. The language is objective and uses standard technical terms. It does not violate any of the invalidity criteria. The problem is therefore deemed **valid**.\n\n### Step 3: Derivation\nThe Total Harmonic Distortion (THD) is defined as:\n$$\n\\mathrm{THD} = \\sqrt{\\frac{V_{\\mathrm{rms}}^{2} - V_{1,\\mathrm{rms}}^{2}}{V_{1,\\mathrm{rms}}^{2}}} = \\sqrt{\\frac{V_{\\mathrm{rms}}^{2}}{V_{1,\\mathrm{rms}}^{2}} - 1}\n$$\nwhere $V_{\\mathrm{rms}}^2$ is the mean square value of the total baseband voltage $v(t)$, and $V_{1,\\mathrm{rms}}^2$ is the mean square value of its fundamental component. We must calculate these two quantities.\n\nLet $\\theta = \\omega t$. The output voltage waveform $v(\\theta)$ is given by:\n$$\nv(\\theta) = V_{\\mathrm{dc}} \\, \\mathrm{clip}\\big(m \\sin(\\theta), -1, +1\\big)\n$$\nThe clipping occurs when $|m \\sin(\\theta)| > 1$, which is equivalent to $|\\sin(\\theta)| > 1/m$. Using the definition $\\sin(\\alpha) = 1/m$ for $\\alpha \\in (0, \\pi/2]$, the waveform over one half-period ($0 \\le \\theta \\le \\pi$) is:\n$$\nv(\\theta) =\n\\begin{cases}\nV_{\\mathrm{dc}} m \\sin(\\theta) & \\text{for } 0 \\le \\theta \\le \\alpha \\\\\nV_{\\mathrm{dc}} & \\text{for } \\alpha < \\theta < \\pi - \\alpha \\\\\nV_{\\mathrm{dc}} m \\sin(\\theta) & \\text{for } \\pi - \\alpha \\le \\theta \\le \\pi\n\\end{cases}\n$$\nThe waveform $v(\\theta)$ is an odd function, $v(-\\theta) = -v(\\theta)$, and possesses quarter-wave symmetry, which means the Fourier series contains only odd sine terms.\n\n**1. Calculation of $V_{\\mathrm{rms}}^2$**\n\nThe mean square value is found by integrating over one period:\n$$\nV_{\\mathrm{rms}}^2 = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} v^2(\\theta) \\, d\\theta\n$$\nDue to symmetry, we can integrate over a quarter-period and multiply by $4$:\n$$\nV_{\\mathrm{rms}}^2 = \\frac{4}{2\\pi} \\int_{0}^{\\pi/2} v^2(\\theta) \\, d\\theta = \\frac{2}{\\pi} \\int_{0}^{\\pi/2} v^2(\\theta) \\, d\\theta\n$$\nWe split the integral at the clipping angle $\\alpha$:\n$$\nV_{\\mathrm{rms}}^2 = \\frac{2}{\\pi} \\left[ \\int_{0}^{\\alpha} (V_{\\mathrm{dc}} m \\sin(\\theta))^2 \\, d\\theta + \\int_{\\alpha}^{\\pi/2} (V_{\\mathrm{dc}})^2 \\, d\\theta \\right]\n$$\n$$\nV_{\\mathrm{rms}}^2 = \\frac{2V_{\\mathrm{dc}}^2}{\\pi} \\left[ m^2 \\int_{0}^{\\alpha} \\sin^2(\\theta) \\, d\\theta + \\int_{\\alpha}^{\\pi/2} 1 \\, d\\theta \\right]\n$$\nUsing the identity $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$, the first integral is:\n$$\n\\int_{0}^{\\alpha} \\sin^2(\\theta) \\, d\\theta = \\left[ \\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4} \\right]_{0}^{\\alpha} = \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\n$$\nThe second integral is:\n$$\n\\int_{\\alpha}^{\\pi/2} 1 \\, d\\theta = [\\theta]_{\\alpha}^{\\pi/2} = \\frac{\\pi}{2} - \\alpha\n$$\nSubstituting these back into the expression for $V_{\\mathrm{rms}}^2$:\n$$\nV_{\\mathrm{rms}}^2 = \\frac{2V_{\\mathrm{dc}}^2}{\\pi} \\left[ m^2 \\left(\\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\\right) + \\frac{\\pi}{2} - \\alpha \\right]\n$$\n$$\nV_{\\mathrm{rms}}^2 = \\frac{V_{\\mathrm{dc}}^2}{\\pi} \\left[ m^2\\alpha - \\frac{m^2}{2}\\sin(2\\alpha) + \\pi - 2\\alpha \\right]\n$$\nUsing $\\sin(2\\alpha) = 2\\sin(\\alpha)\\cos(\\alpha)$ and $m\\sin(\\alpha)=1$:\n$$\n\\frac{m^2}{2}\\sin(2\\alpha) = \\frac{m^2}{2}(2\\sin(\\alpha)\\cos(\\alpha)) = m(m\\sin(\\alpha))\\cos(\\alpha) = m(1)\\cos(\\alpha) = m\\cos(\\alpha)\n$$\nSo, the mean square voltage is:\n$$\nV_{\\mathrm{rms}}^2 = \\frac{V_{\\mathrm{dc}}^2}{\\pi} \\left[ (m^2 - 2)\\alpha - m\\cos(\\alpha) + \\pi \\right]\n$$\n\n**2. Calculation of $V_{1,\\mathrm{rms}}^2$**\n\nThe fundamental component of the voltage is $v_1(\\theta) = b_1 \\sin(\\theta)$, where $b_1$ is the Fourier coefficient.\n$$\nb_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta)\\sin(\\theta) \\, d\\theta\n$$\nUsing quarter-wave symmetry, we have:\n$$\nb_1 = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} v(\\theta)\\sin(\\theta) \\, d\\theta\n$$\nSplitting the integral at $\\alpha$:\n$$\nb_1 = \\frac{4}{\\pi} \\left[ \\int_{0}^{\\alpha} (V_{\\mathrm{dc}} m \\sin(\\theta))\\sin(\\theta) \\, d\\theta + \\int_{\\alpha}^{\\pi/2} V_{\\mathrm{dc}}\\sin(\\theta) \\, d\\theta \\right]\n$$\n$$\nb_1 = \\frac{4V_{\\mathrm{dc}}}{\\pi} \\left[ m \\int_{0}^{\\alpha} \\sin^2(\\theta) \\, d\\theta + \\int_{\\alpha}^{\\pi/2} \\sin(\\theta) \\, d\\theta \\right]\n$$\nWe already calculated the first integral. The second integral is:\n$$\n\\int_{\\alpha}^{\\pi/2} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\alpha}^{\\pi/2} = 0 - (-\\cos(\\alpha)) = \\cos(\\alpha)\n$$\nSubstituting the integrals into the expression for $b_1$:\n$$\nb_1 = \\frac{4V_{\\mathrm{dc}}}{\\pi} \\left[ m \\left(\\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\\right) + \\cos(\\alpha) \\right]\n$$\n$$\nb_1 = \\frac{2V_{\\mathrm{dc}}}{\\pi} \\left[ m\\alpha - \\frac{m}{2}\\sin(2\\alpha) + 2\\cos(\\alpha) \\right]\n$$\nUsing $\\frac{m}{2}\\sin(2\\alpha) = (m\\sin\\alpha)\\cos\\alpha = \\cos\\alpha$:\n$$\nb_1 = \\frac{2V_{\\mathrm{dc}}}{\\pi} \\left[ m\\alpha - \\cos(\\alpha) + 2\\cos(\\alpha) \\right] = \\frac{2V_{\\mathrm{dc}}}{\\pi} (m\\alpha + \\cos(\\alpha))\n$$\nThe RMS value of the fundamental component is $V_{1,\\mathrm{rms}} = b_1/\\sqrt{2}$. Therefore, its mean square value is:\n$$\nV_{1,\\mathrm{rms}}^2 = \\frac{b_1^2}{2} = \\frac{1}{2} \\left( \\frac{2V_{\\mathrm{dc}}}{\\pi} (m\\alpha + \\cos(\\alpha)) \\right)^2 = \\frac{2V_{\\mathrm{dc}}^2}{\\pi^2} (m\\alpha + \\cos(\\alpha))^2\n$$\n\n**3. Calculation of THD**\n\nNow, we compute the ratio $V_{\\mathrm{rms}}^2 / V_{1,\\mathrm{rms}}^2$:\n$$\n\\frac{V_{\\mathrm{rms}}^2}{V_{1,\\mathrm{rms}}^2} = \\frac{\\frac{V_{\\mathrm{dc}}^2}{\\pi} \\left[ (m^2 - 2)\\alpha - m\\cos(\\alpha) + \\pi \\right]}{\\frac{2V_{\\mathrm{dc}}^2}{\\pi^2} (m\\alpha + \\cos(\\alpha))^2}\n$$\nThe $V_{\\mathrm{dc}}^2$ terms cancel out:\n$$\n\\frac{V_{\\mathrm{rms}}^2}{V_{1,\\mathrm{rms}}^2} = \\frac{\\pi \\left[ (m^2 - 2)\\alpha - m\\cos(\\alpha) + \\pi \\right]}{2(m\\alpha + \\cos(\\alpha))^2}\n$$\nThe THD is then:\n$$\n\\mathrm{THD} = \\sqrt{\\frac{\\pi \\left[ (m^2 - 2)\\alpha - m\\cos(\\alpha) + \\pi \\right]}{2(m\\alpha + \\cos(\\alpha))^2} - 1}\n$$\nFinally, we must express the result solely in terms of $m$. We use the relations:\n- $\\alpha = \\arcsin(1/m)$\n- $\\cos(\\alpha) = \\sqrt{1 - \\sin^2(\\alpha)} = \\sqrt{1 - (1/m)^2} = \\frac{\\sqrt{m^2-1}}{m}$ (since $\\alpha \\in (0, \\pi/2]$, $\\cos(\\alpha) \\ge 0$)\n\nSubstituting these gives the final expression. The term $m\\cos(\\alpha) = m \\frac{\\sqrt{m^2-1}}{m} = \\sqrt{m^2-1}$.\n$$\n\\mathrm{THD} = \\sqrt{\\frac{\\pi \\left[ (m^2 - 2)\\arcsin\\left(\\frac{1}{m}\\right) - \\sqrt{m^2-1} + \\pi \\right]}{2\\left(m\\arcsin\\left(\\frac{1}{m}\\right) + \\frac{\\sqrt{m^2-1}}{m}\\right)^2} - 1}\n$$\nThis expression is the complete, closed-form solution for the THD in terms of the modulation index $m$.",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\pi \\left[ (m^2 - 2)\\arcsin\\left(\\frac{1}{m}\\right) - \\sqrt{m^2-1} + \\pi \\right]}{2\\left(m\\arcsin\\left(\\frac{1}{m}\\right) + \\frac{\\sqrt{m^2-1}}{m}\\right)^2} - 1}}\n$$"
        },
        {
            "introduction": "Theoretical analysis must ultimately translate into a safe and reliable hardware design, which hinges on precise timing. This final exercise  moves from analysis to synthesis, guiding you through a worst-case timing calculation to determine the necessary dead-time that prevents catastrophic shoot-through faults. By considering real-world component non-idealities and digital control constraints, you will determine the maximum achievable switching frequency, revealing the fundamental trade-offs between safety, performance, and component selection in a practical design scenario.",
            "id": "3878631",
            "problem": "A single-phase full-bridge Voltage Source Inverter (VSI) is gated by a center-aligned digital Pulse Width Modulation (PWM) generator producing complementary gate signals for each leg with inserted non-overlap (dead-time). The modulation is bipolar Sinusoidal PWM (SPWM) with modulation index limited to $m_{\\max} = 0.8$. Device and driver dynamics are characterized by worst-case bounds. The gate driver propagation delays are $t_{\\mathrm{pd,H}} \\in [70,90]\\ \\text{ns}$ for the high-side and $t_{\\mathrm{pd,L}} \\in [55,65]\\ \\text{ns}$ for the low-side. The high-side Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) has turn-off delay $t_{\\mathrm{doff,H}} = 70\\ \\text{ns}$ and fall time $t_{\\mathrm{f,H}} = 50\\ \\text{ns}$. The low-side MOSFET has turn-on delay $t_{\\mathrm{don,L}} = 60\\ \\text{ns}$ and rise time $t_{\\mathrm{r,L}} = 40\\ \\text{ns}$. The antiparallel diode reverse-recovery worst-case time is $t_{\\mathrm{rr}} = 120\\ \\text{ns}$. A bounded additional timing uncertainty (aggregate jitter and mismatch) of $\\Delta t_{\\mathrm{j}} = 20\\ \\text{ns}$ and a conservative safety margin of $t_{\\mathrm{s}} = 20\\ \\text{ns}$ must be included. The maximum allowed commanded dead-time is $t_{\\mathrm{dead,max}} = 300\\ \\text{ns}$. To ensure meaningful conduction and avoid ineffective pulses, the minimum commanded ON-time for any device is constrained to $t_{\\mathrm{on,min}} = 300\\ \\text{ns}$. The digital PWM generator runs at clock frequency $f_{\\mathrm{clk}} = 100\\ \\text{MHz}$, giving a time quantum $\\Delta t = 10\\ \\text{ns}$; all scheduled timing quantities must be integer multiples of $\\Delta t$.\n\nAssume cross-conduction is prohibited by requiring that at the device channel level the ON intervals of complementary switches do not overlap, and that the turn-on of the incoming device occurs only after the outgoing device’s channel has ceased conduction and its diode has completed reverse recovery. Starting from these physical timing definitions, derive the minimum commanded dead-time $t_{\\mathrm{dead}}$ that guarantees non-overlap under the stated worst-case bounds and quantization, while respecting $t_{\\mathrm{dead}} \\leq t_{\\mathrm{dead,max}}$. Then, using the fundamental relationship between leg duty ratio in bipolar SPWM and the instantaneous reference, derive a lower bound on the switching period $T_{s}$ that guarantees every device ON interval across all instants for $|m| \\leq m_{\\max}$ is at least $t_{\\mathrm{on,min}}$ when dead-time is inserted. From this, compute the maximum achievable switching frequency $f_{s,max} = 1/T_{s,min}$.\n\nExpress the final frequency in $\\text{kHz}$ and round your answer to three significant figures. The final answer must be a single real number.",
            "solution": "The problem statement is assessed to be valid. It is a well-posed, scientifically-grounded problem in the field of power electronics. All necessary data and constraints are provided, and they are internally consistent and physically realistic. The problem requires a rigorous worst-case timing analysis to determine operating limits, which is a standard and meaningful engineering task.\n\nThe solution is divided into two main parts: first, the calculation of the minimum required commanded dead-time, $t_{\\mathrm{dead}}$; and second, the calculation of the maximum switching frequency, $f_{s,max}$, based on the minimum pulse-width constraint.\n\n**Part 1: Minimum Commanded Dead-Time ($t_{\\mathrm{dead}}$)**\n\nThe goal is to prevent cross-conduction (shoot-through) in a leg of the inverter. This occurs if the incoming device turns on before the outgoing device is completely off. The problem specifies a transition from the high-side (H) MOSFET turning off to the low-side (L) MOSFET turning on. To guarantee safe operation under all specified variations, we must perform a worst-case analysis.\n\nLet $t_{\\mathrm{cmd,off,H}}$ be the time when the controller commands the H-side device off, and $t_{\\mathrm{cmd,on,L}}$ be the time it commands the L-side device on. The commanded dead-time is $t_{\\mathrm{dead}} = t_{\\mathrm{cmd,on,L}} - t_{\\mathrm{cmd,off,H}}$.\n\nThe shoot-through protection must account for several factors:\n$1$. The total time required for the outgoing device (H-side) to turn off, under the slowest conditions.\n$2$. The total time required for the incoming device (L-side) to turn on, under the fastest conditions.\n$3$. The reverse-recovery time of the outgoing device's antiparallel diode, $t_{\\mathrm{rr}}$.\n$4$. Additional jitter and safety margins, $\\Delta t_{\\mathrm{j}}$ and $t_{\\mathrm{s}}$.\n\nThe latest instant at which the H-side MOSFET channel ceases conduction, relative to its turn-off command, is the sum of the maximum high-side gate driver propagation delay and the device's turn-off time (delay + fall time).\n$$t_{\\mathrm{off,H,latest}} = t_{\\mathrm{pd,H,max}} + t_{\\mathrm{doff,H}} + t_{\\mathrm{f,H}}$$\n\nThe earliest instant at which the L-side MOSFET channel begins to conduct, relative to its turn-on command, is the sum of the minimum low-side gate driver propagation delay and the device's turn-on delay.\n$$t_{\\mathrm{on,L,earliest}} = t_{\\mathrm{pd,L,min}} + t_{\\mathrm{don,L}}$$\n\nTo prevent channel-to-channel conduction, the commanded dead-time must be large enough to ensure that the earliest L-side turn-on occurs after the latest H-side turn-off. The problem statement further requires this interval to be sufficient to accommodate diode reverse recovery, jitter, and a safety margin. The required minimum dead-time is therefore the time difference between the slowest turn-off and fastest turn-on, plus these additional times.\n\n$$t_{\\mathrm{dead}} \\ge (t_{\\mathrm{off,H,latest}} - t_{\\mathrm{on,L,earliest}}) + t_{\\mathrm{rr}} + \\Delta t_{\\mathrm{j}} + t_{\\mathrm{s}}$$\n$$t_{\\mathrm{dead}} \\ge (t_{\\mathrm{pd,H,max}} + t_{\\mathrm{doff,H}} + t_{\\mathrm{f,H}}) - (t_{\\mathrm{pd,L,min}} + t_{\\mathrm{don,L}}) + t_{\\mathrm{rr}} + \\Delta t_{\\mathrm{j}} + t_{\\mathrm{s}}$$\n\nWe substitute the given worst-case values:\n- $t_{\\mathrm{pd,H,max}} = 90\\ \\text{ns}$\n- $t_{\\mathrm{doff,H}} = 70\\ \\text{ns}$\n- $t_{\\mathrm{f,H}} = 50\\ \\text{ns}$\n- $t_{\\mathrm{pd,L,min}} = 55\\ \\text{ns}$\n- $t_{\\mathrm{don,L}} = 60\\ \\text{ns}$\n- $t_{\\mathrm{rr}} = 120\\ \\text{ns}$\n- $\\Delta t_{\\mathrm{j}} = 20\\ \\text{ns}$\n- $t_{\\mathrm{s}} = 20\\ \\text{ns}$\n\n$$t_{\\mathrm{dead,min\\_calc}} = (90 + 70 + 50)\\ \\text{ns} - (55 + 60)\\ \\text{ns} + 120\\ \\text{ns} + 20\\ \\text{ns} + 20\\ \\text{ns}$$\n$$t_{\\mathrm{dead,min\\_calc}} = 210\\ \\text{ns} - 115\\ \\text{ns} + 160\\ \\text{ns}$$\n$$t_{\\mathrm{dead,min\\_calc}} = 95\\ \\text{ns} + 160\\ \\text{ns} = 255\\ \\text{ns}$$\n\nThe PWM generator has a time quantum of $\\Delta t = 10\\ \\text{ns}$. All scheduled quantities must be integer multiples of $\\Delta t$. Therefore, we must choose the smallest multiple of $10\\ \\text{ns}$ that is greater than or equal to $t_{\\mathrm{dead,min\\_calc}}$.\n$$t_{\\mathrm{dead}} = \\left\\lceil \\frac{255\\ \\text{ns}}{10\\ \\text{ns}} \\right\\rceil \\times 10\\ \\text{ns} = \\lceil 25.5 \\rceil \\times 10\\ \\text{ns} = 26 \\times 10\\ \\text{ns} = 260\\ \\text{ns}$$\n\nThis value must be checked against the maximum allowed dead-time: $t_{\\mathrm{dead}} = 260\\ \\text{ns} \\le t_{\\mathrm{dead,max}} = 300\\ \\text{ns}$. The condition is satisfied.\nThe commanded dead-time to be used is $t_{\\mathrm{dead}} = 260\\ \\text{ns}$.\n\n**Part 2: Maximum Switching Frequency ($f_{s,max}$)**\n\nThe maximum switching frequency is limited by the minimum required ON-time for any device. For bipolar sinusoidal PWM, the instantaneous duty ratio, $d(t)$, of a leg is given by:\n$$d(t) = \\frac{1}{2}(1 + v_{\\mathrm{ref}}(t))$$\nwhere $v_{\\mathrm{ref}}(t) = m \\sin(\\omega t)$ is the normalized reference voltage.\nThe modulation index is limited to $|m| \\le m_{\\max} = 0.8$. The duty ratio $d(t)$ thus varies over the range $[d_{\\min}, d_{\\max}]$.\n\nThe minimum duty ratio occurs when $v_{\\mathrm{ref}}(t) = -m_{\\max}$:\n$$d_{\\min} = \\frac{1}{2}(1 - m_{\\max}) = \\frac{1}{2}(1 - 0.8) = \\frac{1}{2}(0.2) = 0.1$$\nThe maximum duty ratio occurs when $v_{\\mathrm{ref}}(t) = +m_{\\max}$:\n$$d_{\\max} = \\frac{1}{2}(1 + m_{\\max}) = \\frac{1}{2}(1 + 0.8) = \\frac{1}{2}(1.8) = 0.9$$\n\nThe commanded ON-time for the high-side switch is $d T_{s}$ and for the low-side switch is $(1-d)T_{s}$, where $T_{s}$ is the switching period. Due to dead-time insertion, the actual gate-on-time for each device is reduced. In bipolar PWM, a dead-time interval $t_{\\mathrm{dead}}$ is inserted at each transition, so the effective ON-time for a switch is reduced by $t_{\\mathrm{dead}}$ in each switching period.\n$$t_{\\mathrm{ON,H,eff}} = d T_{s} - t_{\\mathrm{dead}}$$\n$$t_{\\mathrm{ON,L,eff}} = (1-d) T_{s} - t_{\\mathrm{dead}}$$\n\nThe problem states that the minimum commanded ON-time for any device must be at least $t_{\\mathrm{on,min}} = 300\\ \\text{ns}$. We must satisfy this constraint for all operating conditions. The worst-case (shortest) ON-times occur at theduty-cycle extrema.\nFor the high-side switch: $t_{\\mathrm{ON,H,eff,min}} = d_{\\min} T_{s} - t_{\\mathrm{dead}}$.\nFor the low-side switch: $t_{\\mathrm{ON,L,eff,min}} = (1 - d_{\\max}) T_{s} - t_{\\mathrm{dead}}$.\nSince $d_{\\min} = 1 - d_{\\max} = 0.1$, both conditions are identical. We must satisfy:\n$$d_{\\min} T_{s} - t_{\\mathrm{dead}} \\ge t_{\\mathrm{on,min}}$$\n\nWe can now solve for the minimum switching period, $T_{s,min}$, that satisfies this inequality.\n$$d_{\\min} T_{s,min} = t_{\\mathrm{on,min}} + t_{\\mathrm{dead}}$$\n$$T_{s,min} = \\frac{t_{\\mathrm{on,min}} + t_{\\mathrm{dead}}}{d_{\\min}}$$\n\nUsing the previously calculated $t_{\\mathrm{dead}} = 260\\ \\text{ns}$ and the given values:\n$$T_{s,min} = \\frac{300\\ \\text{ns} + 260\\ \\text{ns}}{0.1} = \\frac{560\\ \\text{ns}}{0.1} = 5600\\ \\text{ns} = 5.6 \\times 10^{-6}\\ \\text{s}$$\n\nThe maximum achievable switching frequency, $f_{s,max}$, is the reciprocal of the minimum switching period.\n$$f_{s,max} = \\frac{1}{T_{s,min}} = \\frac{1}{5.6 \\times 10^{-6}\\ \\text{s}} \\approx 178571.4\\ \\text{Hz}$$\n\nThe final answer is required in units of kHz, rounded to three significant figures.\n$$f_{s,max} \\approx 178.5714\\ \\text{kHz} \\approx 179\\ \\text{kHz}$$",
            "answer": "$$\\boxed{179}$$"
        }
    ]
}