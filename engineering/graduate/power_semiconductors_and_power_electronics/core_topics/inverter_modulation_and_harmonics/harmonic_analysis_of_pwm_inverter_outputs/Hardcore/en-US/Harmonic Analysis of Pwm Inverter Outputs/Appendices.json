{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze and mitigate unwanted harmonics, we must first understand how a PWM inverter synthesizes the desired fundamental voltage component. This foundational exercise guides you through a first-principles derivation of the fundamental output voltage for a three-level Neutral-Point-Clamped (NPC) inverter . Mastering this relationship between the modulation index and the output amplitude is the cornerstone of controlling and analyzing any PWM-based power converter.",
            "id": "3845596",
            "problem": "A three-phase, three-level Neutral-Point-Clamped (NPC) inverter employs level-shifted sinusoidal Pulse Width Modulation (SPWM) in the phase-disposition (PD) arrangement. The direct current (DC) bus voltage is denoted by $V_{dc}$. The sinusoidal reference (modulating) signal for each phase is $m_{a} \\sin(\\omega_{m} t)$, with modulation index $m_{a} = 0.9$ and fundamental frequency $f_{m} = \\omega_{m} / (2\\pi)$, and it is compared against two in-phase, level-shifted triangular carriers of frequency $f_{c} = 10\\,\\text{kHz}$ per phase leg to realize a three-level output that takes values in $\\{-V_{dc}/2,\\,0,\\, +V_{dc}/2\\}$.\n\nStarting from first principles of carrier-based SPWM and the definition of the average value of the switching waveform over each carrier period as the control action that enforces the desired fundamental, derive the amplitude of the dominant harmonic component in the single-phase line-to-neutral output voltage of the inverter. You may assume ideal devices, negligible dead-time, and that $f_{c} \\gg f_{m}$ such that the switching ripple averages out over a fundamental period. Clearly state any symmetry arguments that justify which component is dominant in the spectrum for the given operating point. Express the final amplitude as a closed-form analytic expression in terms of $V_{dc}$ only. No numerical rounding is required. The amplitude should be reported as the peak (not root-mean-square) of the line-to-neutral fundamental component, in Volts. Angles, if any, must be in radians.",
            "solution": "The core principle of sinusoidal pulse width modulation (SPWM) is that the average value of the switched output voltage over a single carrier period, $\\langle v_{out}(t) \\rangle$, tracks the low-frequency reference signal, $v_{ref}(t)$. This principle is valid under the given assumption that the carrier frequency $f_c$ is much greater than the modulating frequency $f_m$ ($f_c \\gg f_m$).\n\nIn a three-level Neutral-Point-Clamped (NPC) inverter with level-shifted, phase-disposition (PD) SPWM, the output voltage for a single phase (line-to-neutral, denoted $v_{ao}$) is generated by comparing a sinusoidal reference signal with two triangular carrier signals. We will normalize the modulation scheme. Let the two carriers be $v_{c1}(t)$, a triangular wave on the interval $[0, 1]$, and $v_{c2}(t)$, a triangular wave on the interval $[-1, 0]$. Both carriers are in phase, with frequency $f_c$. The normalized sinusoidal reference signal for phase 'a' is $v_{a,ref}(t) = m_a \\sin(\\omega_m t)$, where $m_a$ is the modulation index. For linear modulation, $0 \\le m_a \\le 1$.\n\nThe switching logic determines the output voltage level based on the comparison:\n1.  If $v_{a,ref}(t) > v_{c1}(t)$, the output $v_{ao}(t)$ is $+V_{dc}/2$.\n2.  If $v_{c2}(t) < v_{a,ref}(t) < v_{c1}(t)$, the output $v_{ao}(t)$ is $0$.\n3.  If $v_{a,ref}(t) < v_{c2}(t)$, the output $v_{ao}(t)$ is $-V_{dc}/2$.\n\nWe derive the relationship between the instantaneous reference value and the average pole voltage over one carrier period, $T_c = 1/f_c$. Since $f_c \\gg f_m$, we can treat $v_{a,ref}(t)$ as a constant, denoted $v_{a,ref}$, within a single period $T_c$.\n\nCase 1: $0 < v_{a,ref} \\le 1$.\nIn this range, $v_{a,ref}$ is always greater than the upper bound of $v_{c2}(t)$, so the comparison with $v_{c2}(t)$ is irrelevant. The output voltage switches between $+V_{dc}/2$ and $0$. The duty cycle for the $+V_{dc}/2$ state, $d_{+}$, is the fraction of the period where $v_{a,ref} > v_{c1}(t)$. For a triangular carrier on $[0,1]$, this fraction is simply equal to the reference value.\n$$d_{+} = v_{a,ref}$$\nThe duty cycle for the $0$ state is $d_{0} = 1 - d_{+}$. The duty cycle for the $-V_{dc}/2$ state, $d_{-}$, is $0$.\nThe average voltage over $T_c$ is:\n$$\\langle v_{ao} \\rangle = d_{+} \\left( \\frac{V_{dc}}{2} \\right) + d_{0}(0) + d_{-} \\left( -\\frac{V_{dc}}{2} \\right) = v_{a,ref} \\left( \\frac{V_{dc}}{2} \\right)$$\n\nCase 2: $-1 \\le v_{a,ref} < 0$.\nIn this range, $v_{a,ref}$ is always less than the lower bound of $v_{c1}(t)$, so the comparison with $v_{c1}(t)$ is irrelevant. The output voltage switches between $0$ and $-V_{dc}/2$. The duty cycle for the $-V_{dc}/2$ state, $d_{-}$, is the fraction of the period where $v_{a,ref} < v_{c2}(t)$. For a triangular carrier on $[-1,0]$, this fraction is equal to the magnitude of the reference value.\n$$d_{-} = |v_{a,ref}| = -v_{a,ref}$$\nThe duty cycle for the $0$ state is $d_{0} = 1 - d_{-}$. The duty cycle for the $+V_{dc}/2$ state, $d_{+}$, is $0$.\nThe average voltage over $T_c$ is:\n$$\\langle v_{ao} \\rangle = d_{+} \\left( \\frac{V_{dc}}{2} \\right) + d_{0}(0) + d_{-} \\left( -\\frac{V_{dc}}{2} \\right) = (-v_{a,ref}) \\left( -\\frac{V_{dc}}{2} \\right) = v_{a,ref} \\left( \\frac{V_{dc}}{2} \\right)$$\n\nFor the entire linear modulation range ($-1 \\le v_{a,ref} \\le 1$), the relationship is linear:\n$$\\langle v_{ao}(t) \\rangle = v_{a,ref}(t) \\cdot \\frac{V_{dc}}{2}$$\nThis average voltage represents the low-frequency component of the output waveform, which is the desired fundamental component. Substituting the expression for the reference signal, $v_{a,ref}(t) = m_a \\sin(\\omega_m t)$:\n$$v_{ao,1}(t) = \\langle v_{ao}(t) \\rangle = \\left( m_a \\sin(\\omega_m t) \\right) \\cdot \\frac{V_{dc}}{2} = m_a \\frac{V_{dc}}{2} \\sin(\\omega_m t)$$\n\nThe problem asks for the \"dominant harmonic component.\" In the context of PWM inverters, the primary goal is to synthesize a strong fundamental component while pushing unwanted harmonics to high frequencies. The amplitude of the fundamental is proportional to the modulation index $m_a$. For a high modulation index such as $m_a = 0.9$, the amplitude of the fundamental is significantly larger than any other harmonic component. The unwanted harmonics are clustered around multiples of the carrier frequency ($f_c, 2f_c, \\dots$), which are far removed from the fundamental frequency $f_m$. Therefore, the fundamental component is, by design and by magnitude, the dominant component in the output voltage spectrum.\n\nThe amplitude (peak value) of the fundamental component of the line-to-neutral voltage, $V_{ao,1,peak}$, is the coefficient of the sine term:\n$$V_{ao,1,peak} = m_a \\frac{V_{dc}}{2}$$\nThe problem requires the final expression in terms of $V_{dc}$ only, using the given value of the modulation index, $m_a=0.9$.\n$$V_{ao,1,peak} = 0.9 \\cdot \\frac{V_{dc}}{2} = 0.45 V_{dc}$$\nThis is the closed-form analytic expression for the peak amplitude of the dominant harmonic (the fundamental) in the line-to-neutral output voltage.",
            "answer": "$$\n\\boxed{0.45 V_{dc}}\n$$"
        },
        {
            "introduction": "Interleaving multiple inverter modules is a powerful technique used to cancel switching-frequency harmonics at the source, thereby reducing the burden on output filters. However, ideal cancellation relies on perfect timing, which is unachievable in practice. This problem explores the real-world impact of small phase errors between modules, requiring you to quantify the residual harmonic amplitude that results from imperfect cancellation . This analysis highlights the critical importance of precision in gate drive and control circuits for modern power converters.",
            "id": "3845601",
            "problem": "Consider two identical interleaved modules of a three-phase Voltage Source Inverter (VSI) using sinusoidal Pulse Width Modulation (PWM), each producing at the point of common coupling a dominant switching ripple component at angular frequency $\\omega_{h}$ with per-module amplitude $A_{h}$. Interleaving is implemented so that, in the ideal case, the ripple components from the two modules at $\\omega_{h}$ are exactly $180^{\\circ}$ out of phase and cancel. Due to a slight phase mismatch between the modules, the actual phase difference at $\\omega_{h}$ is $\\pi + \\delta$, where $\\delta$ is small and represents the phase error caused by practical timing skew in the gate drivers and sampling of the PWM carriers. The switching ripple component of each module can be represented by the real part of a complex exponential of the form $A_{h} \\exp\\!\\big(j(\\omega_{h} t + \\phi)\\big)$.\n\nUsing only the fundamental representation of periodic waveforms via Fourier series and the superposition principle in the frequency domain (phasor addition of sinusoidal components at the same angular frequency), derive the resultant amplitude at $\\omega_{h}$ when the two module ripple components are summed with a phase difference of $\\pi + \\delta$. Then, for a phase error of $\\delta = 2^{\\circ}$, compute the residual amplitude at $\\omega_{h}$ normalized by the single-module amplitude $A_{h}$, i.e., compute the dimensionless ratio $\\frac{A_{\\text{res}}}{A_{h}}$. When evaluating trigonometric functions, use radians. Round your final numerical answer to four significant figures and express it as a dimensionless number with no units.",
            "solution": "The problem requires finding the resultant amplitude of two sinusoidal signals of the same frequency and amplitude, but with a specific phase difference. We can represent the two ripple voltage components, $v_1(t)$ and $v_2(t)$, using complex exponentials (phasors) as suggested.\n\nLet the first module's ripple component be the reference signal. Its complex representation is given by:\n$$v_1(t) = \\text{Re}\\{A_{h}\\exp(j(\\omega_h t))\\}$$\nFor this signal, the phase is $0$. The corresponding phasor in the frequency domain is $\\mathbf{V}_1 = A_h \\angle 0 = A_h$.\n\nThe second module's ripple component has the same amplitude $A_h$ and frequency $\\omega_h$, but is phase-shifted by $\\pi + \\delta$ relative to the first. Its complex representation is:\n$$v_2(t) = \\text{Re}\\{A_{h}\\exp(j(\\omega_h t + \\pi + \\delta))\\}$$\nThe corresponding phasor is $\\mathbf{V}_2 = A_h \\angle (\\pi + \\delta) = A_h \\exp(j(\\pi + \\delta))$.\n\nAccording to the superposition principle, the resultant voltage ripple, $v_{\\text{res}}(t) = v_1(t) + v_2(t)$, has a phasor representation $\\mathbf{V}_{\\text{res}}$ that is the vector sum of the individual phasors:\n$$\\mathbf{V}_{\\text{res}} = \\mathbf{V}_1 + \\mathbf{V}_2 = A_h + A_h \\exp(j(\\pi + \\delta))$$\n\nTo find the resultant amplitude, we first express $\\exp(j(\\pi + \\delta))$ in rectangular form using Euler's formula, $\\exp(j\\theta) = \\cos(\\theta) + j\\sin(\\theta)$.\n$$\\exp(j(\\pi + \\delta)) = \\cos(\\pi + \\delta) + j\\sin(\\pi + \\delta)$$\nUsing trigonometric identities for angle sums, $\\cos(\\pi + \\delta) = -\\cos(\\delta)$ and $\\sin(\\pi + \\delta) = -\\sin(\\delta)$.\nSo, $\\exp(j(\\pi + \\delta)) = -\\cos(\\delta) - j\\sin(\\delta)$.\n\nSubstituting this back into the expression for $\\mathbf{V}_{\\text{res}}$:\n$$\\mathbf{V}_{\\text{res}} = A_h + A_h(-\\cos(\\delta) - j\\sin(\\delta))$$\n$$\\mathbf{V}_{\\text{res}} = A_h(1 - \\cos(\\delta)) - jA_h\\sin(\\delta)$$\n\nThe resultant amplitude, $A_{\\text{res}}$, is the magnitude of the complex phasor $\\mathbf{V}_{\\text{res}}$:\n$$A_{\\text{res}} = |\\mathbf{V}_{\\text{res}}| = \\sqrt{(\\text{Re}\\{\\mathbf{V}_{\\text{res}}\\})^2 + (\\text{Im}\\{\\mathbf{V}_{\\text{res}}\\})^2}$$\n$$A_{\\text{res}} = \\sqrt{[A_h(1 - \\cos(\\delta))]^2 + [-A_h\\sin(\\delta)]^2}$$\n$$A_{\\text{res}} = A_h \\sqrt{(1 - \\cos(\\delta))^2 + \\sin^2(\\delta)}$$\nExpanding the squared term:\n$$A_{\\text{res}} = A_h \\sqrt{1 - 2\\cos(\\delta) + \\cos^2(\\delta) + \\sin^2(\\delta)}$$\nUsing the fundamental trigonometric identity $\\cos^2(\\delta) + \\sin^2(\\delta) = 1$:\n$$A_{\\text{res}} = A_h \\sqrt{1 - 2\\cos(\\delta) + 1} = A_h \\sqrt{2 - 2\\cos(\\delta)} = A_h \\sqrt{2(1 - \\cos(\\delta))}$$\nTo simplify this further, we use the half-angle identity $1 - \\cos(\\delta) = 2\\sin^2(\\frac{\\delta}{2})$:\n$$A_{\\text{res}} = A_h \\sqrt{2 \\left( 2\\sin^2\\left(\\frac{\\delta}{2}\\right) \\right)} = A_h \\sqrt{4\\sin^2\\left(\\frac{\\delta}{2}\\right)}$$\nSince $\\delta$ is a small physical error, it is real and non-negative, so $\\sin(\\frac{\\delta}{2})$ is also real and non-negative. We can take the principal square root:\n$$A_{\\text{res}} = 2A_h\\sin\\left(\\frac{\\delta}{2}\\right)$$\nThis is the general expression for the resultant amplitude due to the phase error $\\delta$.\n\nNext, we compute the normalized residual amplitude $\\frac{A_{\\text{res}}}{A_h}$ for a phase error of $\\delta = 2^{\\circ}$.\nFrom the derived expression, the normalized amplitude is:\n$$\\frac{A_{\\text{res}}}{A_h} = 2\\sin\\left(\\frac{\\delta}{2}\\right)$$\nThe problem specifies that trigonometric functions be evaluated using radians. We must convert the phase error $\\delta$ from degrees to radians.\n$$\\delta_{\\text{rad}} = 2^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{\\pi}{90} \\text{ radians}$$\nThe argument of the sine function is $\\frac{\\delta}{2}$, so we have:\n$$\\frac{\\delta_{\\text{rad}}}{2} = \\frac{1}{2} \\times \\frac{\\pi}{90} = \\frac{\\pi}{180} \\text{ radians}$$\nSubstituting this value into the expression for the normalized amplitude:\n$$\\frac{A_{\\text{res}}}{A_h} = 2\\sin\\left(\\frac{\\pi}{180}\\right)$$\nNow we compute the numerical value:\n$$\\sin\\left(\\frac{\\pi}{180}\\right) \\approx 0.0174524064$$\n$$\\frac{A_{\\text{res}}}{A_h} \\approx 2 \\times 0.0174524064 \\approx 0.0349048128$$\nThe problem requires rounding the final answer to four significant figures. The first significant figure is $3$. The next three are $4$, $9$, and $0$. The fifth significant figure is $4$, which is less than $5$, so we do not round up. The trailing zero is significant and must be included.\n$$\\frac{A_{\\text{res}}}{A_h} \\approx 0.03490$$",
            "answer": "$$\\boxed{0.03490}$$"
        },
        {
            "introduction": "Effective harmonic mitigation often relies on passive LC filters to attenuate high-frequency ripple from the inverter's output. While filter design equations assume ideal component values, real-world inductors and capacitors have manufacturing tolerances that can significantly alter filter performance. This practical exercise challenges you to perform a worst-case analysis, determining the maximum possible Total Harmonic Distortion (THD) at the output of a filter when its components vary within a specified tolerance range . Such analysis is crucial for robust system design, ensuring that performance specifications are met under all operational conditions.",
            "id": "3845635",
            "problem": "A single-phase Pulse-Width Modulation (PWM) inverter uses sinusoidal modulation to synthesize a $50\\,\\mathrm{Hz}$ fundamental from a direct current (DC) bus. Its unfiltered output is well-approximated by an ideal voltage source with a fundamental component and carrier sidebands. The inverter feeds a passive second-order low-pass filter formed by a series inductor and a shunt capacitor connected in parallel with a resistive load. Let the series inductor be $L$, the shunt capacitor be $C$, and the load be $R$. The load is resistive with $R = 20\\,\\Omega$. The nominal component values are $L_{0} = 4\\,\\mathrm{mH}$ and $C_{0} = 2\\,\\mu\\mathrm{F}$. Due to component tolerances, each of $L$ and $C$ may independently vary by $\\pm 10\\%$ from its nominal value, i.e., $L \\in [0.9 L_{0}, 1.1 L_{0}]$ and $C \\in [0.9 C_{0}, 1.1 C_{0}]$.\n\nThe inverterâ€™s open-circuit voltage spectrum is characterized by the following root mean square (RMS) magnitudes:\n- Fundamental at $f_{1} = 50\\,\\mathrm{Hz}$: $V_{1,\\mathrm{in}} = 230\\,\\mathrm{V}$.\n- Two sidebands at $f_{s} \\pm f_{1}$ where the switching frequency is $f_{s} = 10\\,\\mathrm{kHz}$: each has $V_{s1,\\mathrm{in}} = 20\\,\\mathrm{V}$.\n- Two sidebands at $2 f_{s} \\pm f_{1}$: each has $V_{s2,\\mathrm{in}} = 8\\,\\mathrm{V}$.\n\nAssume all other spectral components are negligible. Using the frequency-domain definition of complex impedance for inductors and capacitors and the voltage-divider principle for linear time-invariant networks, proceed from first principles to derive the frequency response magnitude from the inverter source to the load node across the parallel branch $\\left(R \\parallel \\frac{1}{j \\omega C}\\right)$ as a function of angular frequency $\\omega$, $L$, $C$, and $R$. Then, using the definition of Total Harmonic Distortion (THD) based on output RMS component magnitudes,\n$$\n\\mathrm{THD}_{\\mathrm{out}}(L,C) \\equiv \\frac{\\sqrt{\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2}}}{V_{1,\\mathrm{out}}},\n$$\nwhere $V_{n,\\mathrm{out}}$ are the post-filter RMS magnitudes, determine the worst-case THD at the filter output over the independent tolerance ranges $L \\in [0.9 L_{0}, 1.1 L_{0}]$ and $C \\in [0.9 C_{0}, 1.1 C_{0}]$ for the specified spectral lines at $f_{1}$, $f_{s} \\pm f_{1}$, and $2 f_{s} \\pm f_{1}$. You may treat the attenuation at $f_{s} \\pm f_{1}$ as equal for the $+$ and $-$ sidebands if justified.\n\nCompute the single worst-case numerical value of $\\mathrm{THD}_{\\mathrm{out}}$ as a dimensionless decimal, and round your final answer to four significant figures. Do not use a percentage sign.",
            "solution": "**1. Derivation of the Filter Transfer Function**\n\nThe filter is a second-order low-pass LC filter with a resistive load $R$. The series element is the inductor $L$, and the shunt element is the parallel combination of the capacitor $C$ and the load resistor $R$. The output voltage $V_{\\mathrm{out}}$ is taken across this parallel combination.\n\nThe impedance of the series inductor is $Z_L(j\\omega) = j\\omega L$.\nThe impedance of the parallel capacitor-resistor branch is:\n$$Z_p(j\\omega) = \\frac{R \\cdot \\frac{1}{j\\omega C}}{R + \\frac{1}{j\\omega C}} = \\frac{R}{1 + j\\omega RC}$$\nUsing the voltage divider rule, the transfer function $H(j\\omega) = V_{\\mathrm{out}}(j\\omega) / V_{\\mathrm{in}}(j\\omega)$ is:\n$$H(j\\omega) = \\frac{Z_p(j\\omega)}{Z_L(j\\omega) + Z_p(j\\omega)} = \\frac{\\frac{R}{1 + j\\omega RC}}{j\\omega L + \\frac{R}{1 + j\\omega RC}}$$\nMultiplying the numerator and denominator by $(1 + j\\omega RC)$ gives:\n$$H(j\\omega) = \\frac{R}{j\\omega L (1 + j\\omega RC) + R} = \\frac{R}{j\\omega L - \\omega^2 LCR + R}$$\nRearranging the denominator into real and imaginary parts:\n$$H(j\\omega) = \\frac{R}{(R - \\omega^2 LCR) + j(\\omega L)}$$\nThe magnitude of the frequency response is therefore:\n$$|H(j\\omega)| = \\frac{|R|}{\\sqrt{(R - \\omega^2 LCR)^2 + (\\omega L)^2}}$$\nSince $R$ is a positive resistance, $|R|=R$.\n$$|H(j\\omega)| = \\frac{R}{\\sqrt{(R - \\omega^2 LCR)^2 + (\\omega L)^2}}$$\n\n**2. Calculation of Output Voltage Components and THD**\n\nThe output RMS voltage for any spectral component with input RMS voltage $V_{n,\\mathrm{in}}$ at angular frequency $\\omega_n$ is given by $V_{n,\\mathrm{out}} = |H(j\\omega_n)| \\cdot V_{n,\\mathrm{in}}$.\n\nThe Total Harmonic Distortion (THD) at the output is defined as:\n$$\\mathrm{THD}_{\\mathrm{out}} = \\frac{\\sqrt{\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2}}}{V_{1,\\mathrm{out}}}$$\nThe harmonic components are the sidebands around $f_s$ and $2f_s$. The problem states there are two sidebands at $f_s \\pm f_1$ and two at $2f_s \\pm f_1$.\nThe frequencies involved are:\n- $f_1 = 50\\,\\mathrm{Hz} \\implies \\omega_1 = 2\\pi(50) = 100\\pi\\,\\mathrm{rad/s}$\n- $f_s = 10\\,\\mathrm{kHz} \\implies \\omega_s = 2\\pi(10000) = 20000\\pi\\,\\mathrm{rad/s}$\n- $2f_s = 20\\,\\mathrm{kHz} \\implies \\omega_{2s} = 2\\pi(20000) = 40000\\pi\\,\\mathrm{rad/s}$\n\nThe sideband pairs are at $f_s \\pm f_1$ and $2f_s \\pm f_1$. Since $f_1 \\ll f_s$, the frequencies within each pair are very close ($9950\\,\\mathrm{Hz}$ and $10050\\,\\mathrm{Hz}$; $19950\\,\\mathrm{Hz}$ and $20050\\,\\mathrm{Hz}$). The function $|H(j\\omega)|$ is smooth and slowly varying at these high frequencies, so the attenuation for frequencies $f_s+f_1$ and $f_s-f_1$ can be considered equal and approximated by the attenuation at $f_s$. The same applies to the sidebands around $2f_s$.\nThus, the sum of squared harmonic output voltages is:\n$$\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2} = 2 \\cdot (|H(j\\omega_s)| V_{s1,\\mathrm{in}})^2 + 2 \\cdot (|H(j\\omega_{2s})| V_{s2,\\mathrm{in}})^2$$\nThe THD expression becomes:\n$$\\mathrm{THD}_{\\mathrm{out}}(L,C) = \\frac{\\sqrt{2 V_{s1,\\mathrm{in}}^2 |H(j\\omega_s; L,C)|^2 + 2 V_{s2,\\mathrm{in}}^2 |H(j\\omega_{2s}; L,C)|^2}}{|H(j\\omega_1; L,C)| V_{1,\\mathrm{in}}}$$\n\n**3. Worst-Case THD Analysis**\n\nTo find the worst-case (maximum) THD, we need to maximize the THD expression with respect to $L$ and $C$ over their tolerance ranges.\nAt the fundamental frequency $\\omega_1$, which is much lower than the filter's resonant frequency $\\omega_0 = 1/\\sqrt{LC}$ (approx. $11180\\,\\mathrm{rad/s}$ or $1780\\,\\mathrm{Hz}$), the filter gain $|H(j\\omega_1)|$ is very close to $1$. Its variation with $L$ and $C$ will be minimal and can be neglected in determining the dominant condition for maximizing THD.\nThe THD is dominated by the numerator, which contains the high-frequency gains $|H(j\\omega_s)|$ and $|H(j\\omega_{2s})|$. To maximize THD, we must maximize these gains.\nFor high frequencies $\\omega \\gg \\omega_0$, the $\\omega^4$ term in the denominator of $|H(j\\omega)|^2$ is dominant:\n$$|H(j\\omega)|^2 = \\frac{R^2}{(R - \\omega^2 LCR)^2 + (\\omega L)^2} \\approx \\frac{R^2}{(-\\omega^2 LCR)^2} = \\frac{R^2}{\\omega^4 L^2 C^2 R^2} = \\frac{1}{\\omega^4 L^2 C^2}$$\n$$|H(j\\omega)| \\approx \\frac{1}{\\omega^2 LC}$$\nTo maximize $|H(j\\omega)|$ at the harmonic frequencies, we must minimize the product $LC$. Since $L$ and $C$ can vary independently, the minimum value of the product $LC$ occurs when both $L$ and $C$ are at their minimum allowed values.\nThe nominal values are $L_0 = 4\\,\\mathrm{mH}$ and $C_0 = 2\\,\\mu\\mathrm{F}$, with a $\\pm 10\\%$ tolerance.\nThe worst-case values are:\n$L_{wc} = 0.9 \\cdot L_0 = 0.9 \\cdot 4 \\times 10^{-3}\\,\\mathrm{H} = 3.6 \\times 10^{-3}\\,\\mathrm{H}$\n$C_{wc} = 0.9 \\cdot C_0 = 0.9 \\cdot 2 \\times 10^{-6}\\,\\mathrm{F} = 1.8 \\times 10^{-6}\\,\\mathrm{F}$\n\n**4. Numerical Calculation**\nWe now compute the THD using $L=L_{wc}$, $C=C_{wc}$, and $R=20\\,\\Omega$. The input RMS voltages are $V_{1,\\mathrm{in}}=230\\,\\mathrm{V}$, $V_{s1,\\mathrm{in}}=20\\,\\mathrm{V}$, and $V_{s2,\\mathrm{in}}=8\\,\\mathrm{V}$.\n\n- **Gain at $\\omega_1 = 100\\pi\\,\\mathrm{rad/s}$**:\n  $\\omega_1 L_{wc} = 100\\pi \\cdot (3.6 \\times 10^{-3}) = 0.36\\pi \\approx 1.13097\\,\\Omega$\n  $\\omega_1^2 L_{wc}C_{wc}R = (100\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 0.012791$\n  $|H(j\\omega_1)|^2 = \\frac{20^2}{(20 - 0.012791)^2 + (1.13097)^2} = \\frac{400}{19.987209^2 + 1.27909} = \\frac{400}{399.4885 + 1.27909} \\approx 0.998085$\n  $|H(j\\omega_1)| \\approx \\sqrt{0.998085} \\approx 0.999042$\n  $V_{1,\\mathrm{out}} = 0.999042 \\cdot 230\\,\\mathrm{V} \\approx 229.7797\\,\\mathrm{V}$\n\n- **Gain at $\\omega_s = 20000\\pi\\,\\mathrm{rad/s}$**:\n  $\\omega_s L_{wc} = 20000\\pi \\cdot (3.6 \\times 10^{-3}) = 72\\pi \\approx 226.195\\,\\Omega$\n  $\\omega_s^2 L_{wc}C_{wc}R = (20000\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 511.64$\n  $|H(j\\omega_s)|^2 = \\frac{20^2}{(20 - 511.64)^2 + (226.195)^2} = \\frac{400}{(-491.64)^2 + 51163.2} = \\frac{400}{241709.6 + 51163.2} \\approx 0.0013658$\n  $V_{s1,\\mathrm{out}}^2 = |H(j\\omega_s)|^2 \\cdot V_{s1,\\mathrm{in}}^2 = 0.0013658 \\cdot (20\\,\\mathrm{V})^2 = 0.54632\\,\\mathrm{V}^2$\n\n- **Gain at $\\omega_{2s} = 40000\\pi\\,\\mathrm{rad/s}$**:\n  $\\omega_{2s} L_{wc} = 40000\\pi \\cdot (3.6 \\times 10^{-3}) = 144\\pi \\approx 452.39\\,\\Omega$\n  $\\omega_{2s}^2 L_{wc}C_{wc}R = (40000\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 2046.56$\n  $|H(j\\omega_{2s})|^2 = \\frac{20^2}{(20 - 2046.56)^2 + (452.39)^2} = \\frac{400}{(-2026.56)^2 + 204655.9} = \\frac{400}{4106935.6 + 204655.9} \\approx 9.2774 \\times 10^{-5}$\n  $V_{s2,\\mathrm{out}}^2 = |H(j\\omega_{2s})|^2 \\cdot V_{s2,\\mathrm{in}}^2 = (9.2774 \\times 10^{-5}) \\cdot (8\\,\\mathrm{V})^2 = 0.0059375\\,\\mathrm{V}^2$\n\n- **Worst-case THD**:\n  The total sum of squared harmonic output voltages is:\n  $\\sum V_{h,\\mathrm{out}}^2 = 2 \\cdot V_{s1,\\mathrm{out}}^2 + 2 \\cdot V_{s2,\\mathrm{out}}^2 = 2 \\cdot (0.54632) + 2 \\cdot (0.0059375) = 1.09264 + 0.011875 = 1.104515\\,\\mathrm{V}^2$\n  $\\mathrm{THD}_{\\mathrm{out,wc}} = \\frac{\\sqrt{1.104515}\\,\\mathrm{V}}{229.7797\\,\\mathrm{V}} = \\frac{1.050959}{229.7797} \\approx 0.00457376$\n\nRounding the final result to four significant figures gives $0.004574$.",
            "answer": "$$\\boxed{0.004574}$$"
        }
    ]
}