{
    "hands_on_practices": [
        {
            "introduction": "虽然线性调制是理想状态，但实际应用中为了最大化电压输出，常常会使逆变器进入过调制区。本练习将探讨其后果：产生低次谐波，从而扭曲输出波形。通过计算削顶正弦波的总谐波失真（THD），你将获得傅里叶分析的实践经验，并理解在更高基波电压和增加的谐波失真之间的权衡。",
            "id": "3845627",
            "problem": "一个单相全桥逆变器，其直流（DC）链路电压为 $V_{\\mathrm{dc}}$，采用正弦脉冲宽度调制（SPWM）方式工作。在此方式下，一个幅度由调制指数 $m_{a}$ 表征的正弦参考波与一个高频三角载波进行比较。假设开关频率足够高，以至于在对基波频率及其整数次谐波进行谐波分析时，可以理想化地认为围绕载波及其倍频的开关边带被理想的输出低通滤波器所滤除。在线性区 $m_{a} \\leq 1$ 时，低频输出是纯正弦波。在过调制区 $m_{a} > 1$ 时，比较器饱和，输出的低频分量变为每个半周期都有平顶区域的削波正弦波。\n\n设一个电周期内的归一化低频输出由 $f(\\theta)$ 表示，其中 $\\theta \\in [0,2\\pi)$，定义如下\n- 当 $\\theta \\in [0,\\frac{\\pi}{2}-\\alpha] \\cup [\\frac{\\pi}{2}+\\alpha,\\pi]$ 时，$f(\\theta) = \\sin(\\theta)$，\n- 当 $\\theta \\in [\\frac{\\pi}{2}-\\alpha,\\frac{\\pi}{2}+\\alpha]$ 时，$f(\\theta) = 1$，\n- 并通过奇半波对称性，即 $f(\\theta+\\pi) = -f(\\theta)$，扩展到 $[0,2\\pi)$。\n\n此处，$\\alpha \\in [0,\\frac{\\pi}{2}]$ 是削波半角，它从线性极限 $m_{a}=1$ 时的 $\\alpha=0$ 增加到全方波极限时的 $\\alpha=\\frac{\\pi}{2}$。对于一个名义上的过调制指令幅度 $\\hat{m} \\geq 1$，可以通过 $\\cos(\\alpha) = 1/\\hat{m}$ 将 $\\alpha$ 与 $\\hat{m}$ 联系起来，但你不需要这个关系来回答问题。\n\n电压的总谐波失真（THD）是相对于基波分量的均方根（RMS）值定义的，如下所示\n$$\n\\mathrm{THD} \\triangleq \\frac{\\sqrt{\\sum_{n=2}^{\\infty}V_{n,\\mathrm{rms}}^{2}}}{V_{1,\\mathrm{rms}}} \\, ,\n$$\n其中 $V_{n,\\mathrm{rms}}$ 是电压波形第 $n$ 次谐波的均方根值。将 $f(\\theta)$ 视为归一化电压，因此从 $f(\\theta)$ 计算出的THD是无量纲的。\n\n从傅里叶级数定义和基波均方根定义出发，推导 $f(\\theta)$ 的THD作为削波角 $\\alpha$ 的函数的闭式表达式。然后计算在全方波极限 $\\alpha=\\frac{\\pi}{2}$ 时的THD。你的最终答案必须是四舍五入到四位有效数字的单个数值。THD用小数表示，不带百分号。角度以弧度为单位。",
            "solution": "问题要求推导削波正弦波形的总谐波失真（THD）作为削波半角 $\\alpha$ 的函数的闭式表达式，然后在方波极限 $\\alpha = \\frac{\\pi}{2}$ 处对该表达式求值。\n\n归一化电压波形 $f(\\theta)$ 在 $\\theta \\in [0, \\pi)$ 上的定义为：\n$$\nf(\\theta) = \n\\begin{cases} \n\\sin(\\theta)  & \\text{for } \\theta \\in [0, \\frac{\\pi}{2}-\\alpha] \\cup [\\frac{\\pi}{2}+\\alpha, \\pi] \\\\\n1  & \\text{for } \\theta \\in [\\frac{\\pi}{2}-\\alpha, \\frac{\\pi}{2}+\\alpha]\n\\end{cases}\n$$\n并通过奇半波对称性 $f(\\theta+\\pi) = -f(\\theta)$ 扩展到 $[0, 2\\pi)$。\n\nTHD的定义为 $\\mathrm{THD} \\triangleq \\frac{\\sqrt{\\sum_{n=2}^{\\infty}V_{n,\\mathrm{rms}}^{2}}}{V_{1,\\mathrm{rms}}}$。一个等效且更直接的计算公式将THD与波形的总均方根值 $V_{\\mathrm{rms,total}}$ 和其基波分量的均方根值 $V_{1,\\mathrm{rms}}$ 联系起来。总均方根值的平方是所有谐波分量均方根值平方的总和：$V_{\\mathrm{rms,total}}^2 = \\sum_{n=1}^{\\infty}V_{n,\\mathrm{rms}}^2 = V_{1,\\mathrm{rms}}^2 + \\sum_{n=2}^{\\infty}V_{n,\\mathrm{rms}}^2$。\n由此，我们可以将THD表示为：\n$$\n\\mathrm{THD} = \\sqrt{\\frac{V_{\\mathrm{rms,total}}^2 - V_{1,\\mathrm{rms}}^2}{V_{1,\\mathrm{rms}}^2}} = \\sqrt{\\frac{V_{\\mathrm{rms,total}}^2}{V_{1,\\mathrm{rms}}^2} - 1} \\, .\n$$\n我们的策略是计算 $V_{\\mathrm{rms,total}}^2$ 和 $V_{1,\\mathrm{rms}}^2$ 作为 $\\alpha$ 的函数。\n\n首先，我们计算总均方根值的平方，$V_{\\mathrm{rms,total}}^2$。其定义为：\n$$\nV_{\\mathrm{rms,total}}^2 = \\frac{1}{2\\pi} \\int_0^{2\\pi} f^2(\\theta) \\, d\\theta\n$$\n奇半波对称性 $f(\\theta+\\pi) = -f(\\theta)$ 意味着 $f^2(\\theta+\\pi) = (-f(\\theta))^2 = f^2(\\theta)$，这表示 $f^2(\\theta)$ 的周期为 $\\pi$。因此，在 $[0, 2\\pi]$ 上的积分是在 $[0, \\pi]$ 上积分的两倍：\n$$\nV_{\\mathrm{rms,total}}^2 = \\frac{1}{2\\pi} \\cdot 2 \\int_0^{\\pi} f^2(\\theta) \\, d\\theta = \\frac{1}{\\pi} \\int_0^{\\pi} f^2(\\theta) \\, d\\theta\n$$\n此外，波形 $f(\\theta)$ 在区间 $[0, \\pi]$ 上关于 $\\theta = \\frac{\\pi}{2}$ 对称。因此，$f^2(\\theta)$ 也关于 $\\theta = \\frac{\\pi}{2}$ 对称，我们可以写出：\n$$\nV_{\\mathrm{rms,total}}^2 = \\frac{2}{\\pi} \\int_0^{\\pi/2} f^2(\\theta) \\, d\\theta\n$$\n我们使用 $f(\\theta)$ 的分段定义来计算这个积分：\n$$\n\\int_0^{\\pi/2} f^2(\\theta) \\, d\\theta = \\int_0^{\\frac{\\pi}{2}-\\alpha} \\sin^2(\\theta) \\, d\\theta + \\int_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} 1^2 \\, d\\theta\n$$\n第一个积分是 $\\int \\sin^2(\\theta) \\, d\\theta = \\int \\frac{1-\\cos(2\\theta)}{2} \\, d\\theta = \\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4}$。\n$$\n\\int_0^{\\frac{\\pi}{2}-\\alpha} \\sin^2(\\theta) \\, d\\theta = \\left[\\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4}\\right]_0^{\\frac{\\pi}{2}-\\alpha} = \\frac{1}{2}\\left(\\frac{\\pi}{2}-\\alpha\\right) - \\frac{1}{4}\\sin\\left(2\\left(\\frac{\\pi}{2}-\\alpha\\right)\\right) = \\frac{\\pi}{4} - \\frac{\\alpha}{2} - \\frac{\\sin(\\pi - 2\\alpha)}{4} = \\frac{\\pi}{4} - \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\n$$\n第二个积分是：\n$$\n\\int_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} 1 \\, d\\theta = [\\theta]_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} = \\frac{\\pi}{2} - \\left(\\frac{\\pi}{2}-\\alpha\\right) = \\alpha\n$$\n将这些结果相加：\n$$\n\\int_0^{\\pi/2} f^2(\\theta) \\, d\\theta = \\left(\\frac{\\pi}{4} - \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\\right) + \\alpha = \\frac{\\pi}{4} + \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\n$$\n将此代回 $V_{\\mathrm{rms,total}}^2$ 的表达式中：\n$$\nV_{\\mathrm{rms,total}}^2(\\alpha) = \\frac{2}{\\pi} \\left(\\frac{\\pi}{4} + \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\\right) = \\frac{1}{2} + \\frac{\\alpha}{\\pi} - \\frac{\\sin(2\\alpha)}{2\\pi}\n$$\n\n接下来，我们计算基波分量的均方根值 $V_{1,\\mathrm{rms}}$。这由傅里叶级数系数 $a_1$ 和 $b_1$ 决定。奇半波对称性确保所有偶次谐波都为零。该波形也是一个奇函数，$f(-\\theta) = -f(\\theta)$，这意味着所有余弦系数 $a_n$ 都为零。因此，$a_1=0$。基波分量是纯正弦波，$b_1\\sin(\\theta)$。\n基波的峰值幅度是 $V_{1, \\mathrm{peak}} = b_1$，其均方根值是 $V_{1,\\mathrm{rms}} = b_1/\\sqrt{2}$。所以，$V_{1,\\mathrm{rms}}^2 = b_1^2/2$。我们需要计算 $b_1$：\n$$\nb_1 = \\frac{1}{\\pi} \\int_0^{2\\pi} f(\\theta)\\sin(\\theta) \\, d\\theta = \\frac{2}{\\pi} \\int_0^{\\pi} f(\\theta)\\sin(\\theta) \\, d\\theta\n$$\n被积函数 $f(\\theta)\\sin(\\theta)$ 在 $[0, \\pi]$ 中关于 $\\theta = \\pi/2$ 对称，所以我们可以进一步简化：\n$$\nb_1 = \\frac{4}{\\pi} \\int_0^{\\pi/2} f(\\theta)\\sin(\\theta) \\, d\\theta = \\frac{4}{\\pi} \\left( \\int_0^{\\frac{\\pi}{2}-\\alpha} \\sin^2(\\theta) \\, d\\theta + \\int_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} \\sin(\\theta) \\, d\\theta \\right)\n$$\n第一个积分和之前一样。第二个积分是：\n$$\n\\int_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\frac{\\pi}{2}-\\alpha}^{\\pi/2} = -\\cos\\left(\\frac{\\pi}{2}\\right) - \\left(-\\cos\\left(\\frac{\\pi}{2}-\\alpha\\right)\\right) = \\sin(\\alpha)\n$$\n将积分结果代入 $b_1$ 的表达式中：\n$$\nb_1(\\alpha) = \\frac{4}{\\pi} \\left( \\frac{\\pi}{4} - \\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4} + \\sin(\\alpha) \\right) = 1 - \\frac{2\\alpha}{\\pi} - \\frac{\\sin(2\\alpha)}{\\pi} + \\frac{4\\sin(\\alpha)}{\\pi}\n$$\n那么，$V_{1,\\mathrm{rms}}^2$ 是：\n$$\nV_{1,\\mathrm{rms}}^2(\\alpha) = \\frac{b_1^2}{2} = \\frac{1}{2}\\left(1 - \\frac{2\\alpha}{\\pi} - \\frac{\\sin(2\\alpha)}{\\pi} + \\frac{4\\sin(\\alpha)}{\\pi}\\right)^2\n$$\nTHD 作为 $\\alpha$ 的函数的闭式表达式是：\n$$\n\\mathrm{THD}(\\alpha) = \\sqrt{\\frac{\\frac{1}{2} + \\frac{\\alpha}{\\pi} - \\frac{\\sin(2\\alpha)}{2\\pi}}{\\frac{1}{2}\\left(1 - \\frac{2\\alpha}{\\pi} - \\frac{\\sin(2\\alpha)}{\\pi} + \\frac{4\\sin(\\alpha)}{\\pi}\\right)^2} - 1}\n$$\n\n最后，我们计算在全方波极限 $\\alpha = \\frac{\\pi}{2}$ 时的THD。\n当 $\\alpha = \\frac{\\pi}{2}$ 时，波形 $f(\\theta)$ 成为幅度为 1 的方波。\n让我们在这个极限下计算 $V_{\\mathrm{rms,total}}^2$ 和 $V_{1,\\mathrm{rms}}^2$。\n$$\nV_{\\mathrm{rms,total}}^2\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2} + \\frac{\\pi/2}{\\pi} - \\frac{\\sin(\\pi)}{2\\pi} = \\frac{1}{2} + \\frac{1}{2} - 0 = 1\n$$\n这是正确的，因为幅度为 1 的方波的均方根值为 1。\n对于基波分量：\n$$\nb_1\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{2(\\pi/2)}{\\pi} - \\frac{\\sin(\\pi)}{\\pi} + \\frac{4\\sin(\\pi/2)}{\\pi} = 1 - 1 - 0 + \\frac{4(1)}{\\pi} = \\frac{4}{\\pi}\n$$\n这是单位幅度方波的正确基波幅度。基波的均方根值为：\n$$\nV_{1,\\mathrm{rms}}\\left(\\frac{\\pi}{2}\\right) = \\frac{b_1}{\\sqrt{2}} = \\frac{4/\\pi}{\\sqrt{2}} = \\frac{4}{\\pi\\sqrt{2}}\n$$\n所以，均方根值的平方是：\n$$\nV_{1,\\mathrm{rms}}^2\\left(\\frac{\\pi}{2}\\right) = \\left(\\frac{4}{\\pi\\sqrt{2}}\\right)^2 = \\frac{16}{2\\pi^2} = \\frac{8}{\\pi^2}\n$$\n现在我们可以计算方波的THD：\n$$\n\\mathrm{THD}\\left(\\frac{\\pi}{2}\\right) = \\sqrt{\\frac{V_{\\mathrm{rms,total}}^2\\left(\\frac{\\pi}{2}\\right)}{V_{1,\\mathrm{rms}}^2\\left(\\frac{\\pi}{2}\\right)} - 1} = \\sqrt{\\frac{1}{8/\\pi^2} - 1} = \\sqrt{\\frac{\\pi^2}{8} - 1}\n$$\n我们现在计算数值：\n$$\n\\mathrm{THD}\\left(\\frac{\\pi}{2}\\right) = \\sqrt{\\frac{\\pi^2}{8} - 1} \\approx \\sqrt{\\frac{(3.14159)^2}{8} - 1} \\approx \\sqrt{\\frac{9.8696}{8} - 1} \\approx \\sqrt{1.2337 - 1} = \\sqrt{0.2337} \\approx 0.483425\n$$\n四舍五入到四位有效数字，结果是 $0.4834$。",
            "answer": "$$\n\\boxed{0.4834}\n$$"
        },
        {
            "introduction": "逆变器的原始输出从来不是完美的正弦波，必须经过滤波。本练习模拟了一个完整的实际场景，你将分析一个为净化PWM波形而设计的LC滤波器。关键的是，它引入了元器件容差这一真实世界的挑战，要求你确定最坏情况下的性能，这是设计稳健可靠的电力电子系统的关键技能。",
            "id": "3845635",
            "problem": "一个单相脉冲宽度调制（PWM）逆变器使用正弦调制，从直流（DC）母线合成一个 $50\\,\\mathrm{Hz}$ 的基波。其未滤波输出可以很好地近似为一个理想电压源，包含一个基波分量和多个载波边带。该逆变器为一个无源二阶低通滤波器供电，该滤波器由一个串联电感和一个与电阻性负载并联的并联电容组成。设串联电感为 $L$，并联电容为 $C$，负载为 $R$。负载为电阻性，其值为 $R = 20\\,\\Omega$。元件的标称值为 $L_{0} = 4\\,\\mathrm{mH}$ 和 $C_{0} = 2\\,\\mu\\mathrm{F}$。由于元件容差，$L$ 和 $C$ 的值都可能在其标称值的基础上独立变化 $\\pm 10\\%$，即 $L \\in [0.9 L_{0}, 1.1 L_{0}]$ 且 $C \\in [0.9 C_{0}, 1.1 C_{0}]$。\n\n该逆变器的开路电压频谱具有以下均方根（RMS）幅值特征：\n- 基波，频率为 $f_{1} = 50\\,\\mathrm{Hz}$：$V_{1,\\mathrm{in}} = 230\\,\\mathrm{V}$。\n- 两个边带，频率为 $f_{s} \\pm f_{1}$，其中开关频率 $f_{s} = 10\\,\\mathrm{kHz}$：每个边带的幅值为 $V_{s1,\\mathrm{in}} = 20\\,\\mathrm{V}$。\n- 两个边带，频率为 $2 f_{s} \\pm f_{1}$：每个边带的幅值为 $V_{s2,\\mathrm{in}} = 8\\,\\mathrm{V}$。\n\n假设所有其他频谱分量都可以忽略不计。使用电感和电容的频域复阻抗定义以及线性时不变网络的分压原理，从基本原理出发，推导从逆变器源到跨接在并联支路 $\\left(R \\parallel \\frac{1}{j \\omega C}\\right)$ 上的负载节点的频率响应幅值，作为角频率 $\\omega$、$L$、$C$ 和 $R$ 的函数。然后，使用基于输出均方根分量幅值的总谐波失真（THD）的定义，\n$$\n\\mathrm{THD}_{\\mathrm{out}}(L,C) \\equiv \\frac{\\sqrt{\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2}}}{V_{1,\\mathrm{out}}},\n$$\n其中 $V_{n,\\mathrm{out}}$ 是滤波后的均方根幅值，确定在指定的谱线 $f_{1}$、$f_{s} \\pm f_{1}$ 和 $2 f_{s} \\pm f_{1}$ 处，当 $L$ 和 $C$ 在其独立容差范围 $L \\in [0.9 L_{0}, 1.1 L_{0}]$ 和 $C \\in [0.9 C_{0}, 1.1 C_{0}]$ 内变化时，滤波器输出端的最坏情况下的THD。如果有理由，您可以将 $f_{s} \\pm f_{1}$ 处的衰减对于 $+$ 和 $-$ 边带视为相等。\n\n计算 $\\mathrm{THD}_{\\mathrm{out}}$ 的单一最坏情况数值，结果为无量纲小数，并将最终答案四舍五入到四位有效数字。请勿使用百分号。",
            "solution": "**1. 滤波器传递函数的推导**\n\n该滤波器是一个带有电阻性负载 $R$ 的二阶低通LC滤波器。串联元件是电感 $L$，并联元件是电容 $C$ 和负载电阻 $R$ 的并联组合。输出电压 $V_{\\mathrm{out}}$ 在这个并联组合两端测量。\n\n串联电感的阻抗为 $Z_L(j\\omega) = j\\omega L$。\n并联电容-电阻支路的阻抗为：\n$$Z_p(j\\omega) = \\frac{R \\cdot \\frac{1}{j\\omega C}}{R + \\frac{1}{j\\omega C}} = \\frac{R}{1 + j\\omega RC}$$\n使用分压法则，传递函数 $H(j\\omega) = V_{\\mathrm{out}}(j\\omega) / V_{\\mathrm{in}}(j\\omega)$ 为：\n$$H(j\\omega) = \\frac{Z_p(j\\omega)}{Z_L(j\\omega) + Z_p(j\\omega)} = \\frac{\\frac{R}{1 + j\\omega RC}}{j\\omega L + \\frac{R}{1 + j\\omega RC}}$$\n分子和分母同乘以 $(1 + j\\omega RC)$ 得到：\n$$H(j\\omega) = \\frac{R}{j\\omega L (1 + j\\omega RC) + R} = \\frac{R}{j\\omega L - \\omega^2 LCR + R}$$\n将分母重新整理为实部和虚部：\n$$H(j\\omega) = \\frac{R}{(R - \\omega^2 LCR) + j(\\omega L)}$$\n因此，频率响应的幅值为：\n$$|H(j\\omega)| = \\frac{R}{\\sqrt{(R - \\omega^2 LCR)^2 + (\\omega L)^2}}$$\n\n**2. 输出电压分量和THD的计算**\n\n对于角频率为 $\\omega_n$、输入均方根电压为 $V_{n,\\mathrm{in}}$ 的任何频谱分量，其输出均方根电压由 $V_{n,\\mathrm{out}} = |H(j\\omega_n)| \\cdot V_{n,\\mathrm{in}}$ 给出。\n\n输出端的总谐波失真（THD）定义为：\n$$\\mathrm{THD}_{\\mathrm{out}} = \\frac{\\sqrt{\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2}}}{V_{1,\\mathrm{out}}}$$\n谐波分量是围绕 $f_s$ 和 $2f_s$ 的边带。问题陈述了在 $f_s \\pm f_1$ 处有两个边带，在 $2f_s \\pm f_1$ 处有两个边带。\n涉及的频率有：\n- $f_1 = 50\\,\\mathrm{Hz} \\implies \\omega_1 = 2\\pi(50) = 100\\pi\\,\\mathrm{rad/s}$\n- $f_s = 10\\,\\mathrm{kHz} \\implies \\omega_s = 2\\pi(10000) = 20000\\pi\\,\\mathrm{rad/s}$\n- $2f_s = 20\\,\\mathrm{kHz} \\implies \\omega_{2s} = 2\\pi(20000) = 40000\\pi\\,\\mathrm{rad/s}$\n\n边带对位于 $f_s \\pm f_1$ 和 $2f_s \\pm f_1$。由于 $f_1 \\ll f_s$，每对边带内的频率非常接近（$9950\\,\\mathrm{Hz}$ 和 $10050\\,\\mathrm{Hz}$；$19950\\,\\mathrm{Hz}$ 和 $20050\\,\\mathrm{Hz}$）。函数 $|H(j\\omega)|$ 在这些高频处是平滑且缓慢变化的，因此可以认为频率 $f_s+f_1$ 和 $f_s-f_1$ 的衰减相等，并用 $f_s$ 处的衰减来近似。同样的情况也适用于围绕 $2f_s$ 的边带。\n因此，谐波输出电压的平方和为：\n$$\\sum_{n \\ge 2} V_{n,\\mathrm{out}}^{2} = 2 \\cdot (|H(j\\omega_s)| V_{s1,\\mathrm{in}})^2 + 2 \\cdot (|H(j\\omega_{2s})| V_{s2,\\mathrm{in}})^2$$\nTHD表达式变为：\n$$\\mathrm{THD}_{\\mathrm{out}}(L,C) = \\frac{\\sqrt{2 V_{s1,\\mathrm{in}}^2 |H(j\\omega_s; L,C)|^2 + 2 V_{s2,\\mathrm{in}}^2 |H(j\\omega_{2s}; L,C)|^2}}{|H(j\\omega_1; L,C)| V_{1,\\mathrm{in}}}$$\n\n**3. 最坏情况THD分析**\n\n为找到最坏情况（最大）的THD，我们需要在 $L$ 和 $C$ 的容差范围内最大化THD表达式。\n在基波频率 $\\omega_1$ 处，该频率远低于滤波器的谐振频率 $\\omega_0 = 1/\\sqrt{LC}$（约 $11180\\,\\mathrm{rad/s}$ 或 $1780\\,\\mathrm{Hz}$），滤波器增益 $|H(j\\omega_1)|$ 非常接近1。其随 $L$ 和 $C$ 的变化将是最小的，在确定最大化THD的主导条件时可以忽略。\nTHD主要由分子决定，分子包含高频增益 $|H(j\\omega_s)|$ 和 $|H(j\\omega_{2s})|$。为了最大化THD，我们必须最大化这些增益。\n对于高频 $\\omega \\gg \\omega_0$，$|H(j\\omega)|^2$ 分母中的 $\\omega^4$ 项占主导地位：\n$$|H(j\\omega)|^2 = \\frac{R^2}{(R - \\omega^2 LCR)^2 + (\\omega L)^2} \\approx \\frac{R^2}{(-\\omega^2 LCR)^2} = \\frac{R^2}{\\omega^4 L^2 C^2 R^2} = \\frac{1}{\\omega^4 L^2 C^2}$$\n$$|H(j\\omega)| \\approx \\frac{1}{\\omega^2 LC}$$\n为了在谐波频率处最大化 $|H(j\\omega)|$，我们必须最小化乘积 $LC$。由于 $L$ 和 $C$ 可以独立变化，乘积 $LC$ 的最小值出现在 $L$ 和 $C$ 都取其允许的最小值时。\n标称值为 $L_0 = 4\\,\\mathrm{mH}$ 和 $C_0 = 2\\,\\mu\\mathrm{F}$，容差为 $\\pm 10\\%$。\n最坏情况下的值为：\n$L_{\\mathrm{wc}} = 0.9 \\cdot L_0 = 0.9 \\cdot 4 \\times 10^{-3}\\,\\mathrm{H} = 3.6 \\times 10^{-3}\\,\\mathrm{H}$\n$C_{\\mathrm{wc}} = 0.9 \\cdot C_0 = 0.9 \\cdot 2 \\times 10^{-6}\\,\\mathrm{F} = 1.8 \\times 10^{-6}\\,\\mathrm{F}$\n\n**4. 数值计算**\n我们现在使用 $L=L_{\\mathrm{wc}}$，$C=C_{\\mathrm{wc}}$ 和 $R=20\\,\\Omega$ 来计算THD。输入均方根电压为 $V_{1,\\mathrm{in}}=230\\,\\mathrm{V}$，$V_{s1,\\mathrm{in}}=20\\,\\mathrm{V}$ 和 $V_{s2,\\mathrm{in}}=8\\,\\mathrm{V}$。\n\n- **在 $\\omega_1 = 100\\pi\\,\\mathrm{rad/s}$ 时的增益**：\n  $\\omega_1 L_{\\mathrm{wc}} = 100\\pi \\cdot (3.6 \\times 10^{-3}) = 0.36\\pi \\approx 1.13097\\,\\Omega$\n  $\\omega_1^2 L_{\\mathrm{wc}}C_{\\mathrm{wc}}R = (100\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 0.012791$\n  $$|H(j\\omega_1)|^2 = \\frac{20^2}{(20 - 0.012791)^2 + (1.13097)^2} = \\frac{400}{19.987209^2 + 1.27909} = \\frac{400}{399.4885 + 1.27909} \\approx 0.998085$$\n  $|H(j\\omega_1)| \\approx \\sqrt{0.998085} \\approx 0.999042$\n  $V_{1,\\mathrm{out}} = 0.999042 \\cdot 230\\,\\mathrm{V} \\approx 229.7797\\,\\mathrm{V}$\n\n- **在 $\\omega_s = 20000\\pi\\,\\mathrm{rad/s}$ 时的增益**：\n  $\\omega_s L_{\\mathrm{wc}} = 20000\\pi \\cdot (3.6 \\times 10^{-3}) = 72\\pi \\approx 226.195\\,\\Omega$\n  $\\omega_s^2 L_{\\mathrm{wc}}C_{\\mathrm{wc}}R = (20000\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 511.64$\n  $$|H(j\\omega_s)|^2 = \\frac{20^2}{(20 - 511.64)^2 + (226.195)^2} = \\frac{400}{(-491.64)^2 + 51163.2} = \\frac{400}{241709.6 + 51163.2} \\approx 0.0013658$$\n  $V_{s1,\\mathrm{out}}^2 = |H(j\\omega_s)|^2 \\cdot V_{s1,\\mathrm{in}}^2 = 0.0013658 \\cdot (20\\,\\mathrm{V})^2 = 0.54632\\,\\mathrm{V}^2$\n\n- **在 $\\omega_{2s} = 40000\\pi\\,\\mathrm{rad/s}$ 时的增益**：\n  $\\omega_{2s} L_{\\mathrm{wc}} = 40000\\pi \\cdot (3.6 \\times 10^{-3}) = 144\\pi \\approx 452.39\\,\\Omega$\n  $\\omega_{2s}^2 L_{\\mathrm{wc}}C_{\\mathrm{wc}}R = (40000\\pi)^2 \\cdot (3.6 \\times 10^{-3}) \\cdot (1.8 \\times 10^{-6}) \\cdot 20 \\approx 2046.56$\n  $$|H(j\\omega_{2s})|^2 = \\frac{20^2}{(20 - 2046.56)^2 + (452.39)^2} = \\frac{400}{(-2026.56)^2 + 204655.9} = \\frac{400}{4106935.6 + 204655.9} \\approx 9.2774 \\times 10^{-5}$$\n  $V_{s2,\\mathrm{out}}^2 = |H(j\\omega_{2s})|^2 \\cdot V_{s2,\\mathrm{in}}^2 = (9.2774 \\times 10^{-5}) \\cdot (8\\,\\mathrm{V})^2 = 0.0059375\\,\\mathrm{V}^2$\n\n- **最坏情况下的THD**：\n  谐波输出电压的总平方和为：\n  $\\sum V_{h,\\mathrm{out}}^2 = 2 \\cdot V_{s1,\\mathrm{out}}^2 + 2 \\cdot V_{s2,\\mathrm{out}}^2 = 2 \\cdot (0.54632) + 2 \\cdot (0.0059375) = 1.09264 + 0.011875 = 1.104515\\,\\mathrm{V}^2$\n  $$\\mathrm{THD}_{\\mathrm{out,wc}} = \\frac{\\sqrt{1.104515}\\,\\mathrm{V}}{229.7797\\,\\mathrm{V}} = \\frac{1.050959}{229.7797} \\approx 0.00457376$$\n\n将最终结果四舍五入到四位有效数字得到 $0.004574$。",
            "answer": "$$\\boxed{0.004574}$$"
        }
    ]
}