{
    "hands_on_practices": [
        {
            "introduction": "Understanding the origins of core loss is the first step towards managing it. This foundational exercise guides you from first principles—Maxwell's equations and Ohm's law—to derive the classic expression for eddy current loss in a thin lamination. By building the formula from the ground up, you will gain a deep, physical intuition for how material properties ($B_p$, $f$, $d$, $\\sigma$) and operating conditions dictate these losses .",
            "id": "3848093",
            "problem": "An infinitely wide ferromagnetic lamination of thickness $d$ occupies the region $-d/2 \\le x \\le d/2$, with the $x$-axis normal to the lamination plane. A spatially uniform magnetic flux density $B_{z}(t)$ is imposed externally along the $z$-direction and varies sinusoidally in time as $B_{z}(t) = B_{p} \\sin(2\\pi f t)$, where $B_{p}$ is the peak flux density and $f$ is the frequency. The lamination is assumed to be electrically homogeneous and isotropic with electrical conductivity $\\sigma$ (equivalently, resistivity $\\rho = 1/\\sigma$), and to have constant magnetic permeability independent of $B_{z}$. The low-frequency thin-lamination limit applies, i.e., the skin depth is much larger than $d$, so that $B_{z}$ is uniform across $x$ and the magnetic field profile is not distorted by eddy currents. Hysteresis is neglected so that only eddy current loss is considered.\n\nStarting only from the following foundational relations:\n- Maxwell–Faraday law in differential form, $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$,\n- Ohm’s law for a homogeneous conductor, $\\mathbf{J} = \\sigma \\mathbf{E}$,\n- Instantaneous volumetric Joule heating density, $p(t) = \\mathbf{J}\\cdot \\mathbf{E}$,\n\nderive an analytical expression for the time-average eddy current power loss per unit volume, $P_{e}/V$, as a function of $B_p$, $f$, $d$, and $\\sigma$ under the assumptions above. Then use your result to quantify how $P_{e}/V$ changes when $\\sigma$ varies with temperature, and compute the fractional increase in $P_{e}/V$ (expressed as a decimal number without a percent sign) when the resistivity decreases by $0.20$ of its original value, i.e., when $\\rho_{\\text{new}} = 0.80\\,\\rho_{\\text{old}}$, with $B_p$, $f$, and $d$ held fixed.\n\nProvide:\n- The closed-form dependence of $P_{e}/V$ on $B_p$, $f$, $d$, and $\\sigma$,\n- The single decimal number giving the fractional increase in $P_{e}/V$ for the specified change in $\\rho$.\n\nNo numerical substitution for $B_p$, $f$, $d$, or $\\sigma$ is required. If you approximate any intermediate step, justify why the approximation is valid under the stated assumptions. Express the fractional increase as a single decimal number; no units are required. No rounding instruction is needed because an exact decimal is expected.",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of electromagnetism, self-contained, well-posed, and objective. The provided assumptions, such as the thin-lamination limit and the neglect of hysteresis, are standard for this type of classical analysis and render the problem analytically solvable. We proceed with the derivation.\n\nThe objective is to derive an expression for the time-average eddy current power loss per unit volume, denoted as $P_e/V$. The derivation will begin from the specified foundational physical laws.\n\nThe starting point is the Maxwell–Faraday law in differential form:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\nThe magnetic flux density $\\mathbf{B}$ is given as spatially uniform and varying sinusoidally in time along the $z$-direction: $\\mathbf{B}(t) = B_p \\sin(2\\pi f t) \\hat{k}$. Its time derivative is:\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\partial}{\\partial t} (B_p \\sin(2\\pi f t) \\hat{k}) = 2\\pi f B_p \\cos(2\\pi f t) \\hat{k} $$\nSubstituting this into the Maxwell-Faraday equation gives:\n$$ \\nabla \\times \\mathbf{E} = -2\\pi f B_p \\cos(2\\pi f t) \\hat{k} $$\nThe problem geometry involves an infinitely wide lamination, implying translational symmetry in the $y$ and $z$ directions. Consequently, the electric field $\\mathbf{E}$ cannot depend on the $y$ or $z$ coordinates, so $\\mathbf{E} = \\mathbf{E}(x,t)$. The curl of such a field is:\n$$ \\nabla \\times \\mathbf{E}(x,t) = \\begin{vmatrix} \\hat{i} & \\hat{j} & \\hat{k} \\\\ \\frac{\\partial}{\\partial x} & 0 & 0 \\\\ E_x & E_y & E_z \\end{vmatrix} = -\\frac{\\partial E_z}{\\partial x} \\hat{j} + \\frac{\\partial E_y}{\\partial x} \\hat{k} $$\nBy comparing the components of the two expressions for $\\nabla \\times \\mathbf{E}$, we deduce:\n1.  The $\\hat{j}$ component: $-\\frac{\\partial E_z}{\\partial x} = 0$, implying $E_z$ is independent of $x$. As there is no driving force for a field along the $z$-axis, we take $E_z = 0$.\n2.  The $\\hat{i}$ component: There is no source for an $E_x$ component. Current loops (eddy currents) opposing the change in $z$-directed magnetic flux must lie in the $x-y$ plane. Thus we can set $E_x=0$.\n3.  The $\\hat{k}$ component: $\\frac{\\partial E_y}{\\partial x} = -2\\pi f B_p \\cos(2\\pi f t)$.\n\nThe electric field is therefore purely in the $y$-direction, $\\mathbf{E} = E_y(x,t)\\hat{j}$. We find $E_y(x,t)$ by integrating with respect to $x$:\n$$ E_y(x,t) = \\int \\left( -2\\pi f B_p \\cos(2\\pi f t) \\right) dx = -x (2\\pi f B_p \\cos(2\\pi f t)) + C(t) $$\nThe integration constant $C(t)$ is determined from symmetry considerations. The physical setup is symmetric with respect to the plane $x=0$. The induced currents must be equal and opposite for $x>0$ and $x<0$, which means the current density must be zero at $x=0$. From Ohm's law, $\\mathbf{J} = \\sigma \\mathbf{E}$, this implies $\\mathbf{E}(x=0, t) = 0$. Applying this condition:\n$$ E_y(0,t) = -0 \\cdot (2\\pi f B_p \\cos(2\\pi f t)) + C(t) = 0 \\implies C(t) = 0 $$\nThus, the electric field inside the lamination is:\n$$ \\mathbf{E}(x,t) = -2\\pi f B_p x \\cos(2\\pi f t) \\hat{j} $$\nThe induced eddy current density $\\mathbf{J}$ is given by Ohm's law, $\\mathbf{J} = \\sigma \\mathbf{E}$:\n$$ \\mathbf{J}(x,t) = -\\sigma (2\\pi f B_p x \\cos(2\\pi f t)) \\hat{j} $$\nThe instantaneous volumetric power density due to Joule heating is $p(x,t) = \\mathbf{J} \\cdot \\mathbf{E} = \\sigma |\\mathbf{E}|^2$:\n$$ p(x,t) = \\sigma (-2\\pi f B_p x \\cos(2\\pi f t))^2 = \\sigma (2\\pi f B_p)^2 x^2 \\cos^2(2\\pi f t) $$\nTo find the time-average power loss per unit volume, we must average $p(x,t)$ over one time period $T=1/f$ and over the lamination thickness $d$.\nFirst, we average in time. The time average of the $\\cos^2$ term over one cycle is:\n$$ \\langle \\cos^2(2\\pi f t) \\rangle_t = \\frac{1}{T} \\int_0^T \\cos^2(2\\pi f t) dt = \\frac{1}{2} $$\nThe time-averaged power density at a specific position $x$ is:\n$$ \\langle p(x) \\rangle_t = \\sigma (2\\pi f B_p)^2 x^2 \\cdot \\frac{1}{2} = 2 \\pi^2 f^2 B_p^2 \\sigma x^2 $$\nNext, we average this expression over the thickness of the lamination, which extends from $x=-d/2$ to $x=d/2$. This involves finding the average value of $x^2$ over this interval:\n$$ \\langle x^2 \\rangle_x = \\frac{1}{d} \\int_{-d/2}^{d/2} x^2 dx = \\frac{1}{d} \\left[\\frac{x^3}{3}\\right]_{-d/2}^{d/2} = \\frac{1}{3d} \\left[ \\left(\\frac{d}{2}\\right)^3 - \\left(-\\frac{d}{2}\\right)^3 \\right] = \\frac{1}{3d} \\left( \\frac{d^3}{8} + \\frac{d^3}{8} \\right) = \\frac{d^2}{12} $$\nThe time-average power loss per unit volume, $P_e/V$, is the product of the constant terms and these averages:\n$$ \\frac{P_e}{V} = \\langle \\langle p(x,t) \\rangle_t \\rangle_x = (2 \\pi^2 f^2 B_p^2 \\sigma) \\langle x^2 \\rangle_x = 2 \\pi^2 f^2 B_p^2 \\sigma \\left(\\frac{d^2}{12}\\right) $$\nSimplifying this expression yields the first required result:\n$$ \\frac{P_e}{V} = \\frac{\\pi^2 f^2 B_p^2 d^2 \\sigma}{6} $$\nFor the second part of the problem, we analyze how $P_e/V$ changes with resistivity $\\rho$. Since conductivity $\\sigma = 1/\\rho$, we can write:\n$$ \\frac{P_e}{V} = \\frac{\\pi^2 f^2 B_p^2 d^2}{6\\rho} $$\nThis shows that for fixed $B_p$, $f$, and $d$, the power loss per unit volume is inversely proportional to the resistivity: $P_e/V \\propto \\rho^{-1}$.\nWe are given that the new resistivity is $\\rho_{\\text{new}} = 0.80\\,\\rho_{\\text{old}}$. The ratio of the new power loss to the old power loss is:\n$$ \\frac{(P_e/V)_{\\text{new}}}{(P_e/V)_{\\text{old}}} = \\frac{\\rho_{\\text{old}}}{\\rho_{\\text{new}}} = \\frac{\\rho_{\\text{old}}}{0.80\\,\\rho_{\\text{old}}} = \\frac{1}{0.80} = 1.25 $$\nThe fractional increase in $P_e/V$ is defined as $\\frac{(P_e/V)_{\\text{new}} - (P_e/V)_{\\text{old}}}{(P_e/V)_{\\text{old}}}$. This is calculated as:\n$$ \\frac{(P_e/V)_{\\text{new}}}{(P_e/V)_{\\text{old}}} - 1 = 1.25 - 1 = 0.25 $$\nThus, the fractional increase in the eddy current power loss per unit volume is $0.25$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\pi^{2} f^{2} B_{p}^{2} d^{2} \\sigma}{6} & 0.25 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While analytical formulas are insightful, real-world core loss characterization relies on measurement. This practice bridges the gap between theory and experiment by tasking you with numerically calculating the total energy loss from sampled B-H loop data . Mastering this technique, which involves computing the integral $\\oint H \\, \\mathrm{d}B$, is essential for processing experimental data and validating core loss models.",
            "id": "3848106",
            "problem": "You are given a single-period loop of magnetic flux density $B$ and magnetic field strength $H$ for a magnetically lossy core material driven by an Alternating Current (AC) excitation at frequency $f=10\\,\\mathrm{kHz}$ with peak flux density $B_p=0.3\\,\\mathrm{T}$. The measurement consists of sampled pairs $\\{(B_i,H_i)\\}_{i=0}^{N-1}$ acquired at uniform time steps over one full period. Your task is to design and implement a numerical procedure that computes the energy dissipated per cycle per unit volume and the corresponding hysteresis loss power density, expressed in $\\mathrm{W}/\\mathrm{m}^3$, by integrating along the measured loop in the $B$–$H$ plane.\n\nBase your derivation on first principles of electromagnetic field energy accounting, specifically energy conservation in electromagnetic fields (Poynting’s theorem) and the definition of incremental magnetic work density. The final algorithm must rely only on these fundamentals, and must not assume any shortcut formulas specific to hysteresis or eddy currents.\n\nDefine a robust numerical procedure that:\n- Accepts uniformly sampled $B$ and $H$ over one full period (closing the loop by connecting the last sample to the first).\n- Accumulates the oriented contribution of each segment of the loop in the $B$–$H$ plane to obtain the energy per cycle per unit volume.\n- Converts the per-cycle energy to power density in $\\mathrm{W}/\\mathrm{m}^3$ using the given frequency.\n- Ensures the computed power density is non-negative.\n\nExpress each final answer in $\\mathrm{W}/\\mathrm{m}^3$ as a float rounded to three decimal places.\n\nTest Suite:\nFor reproducibility and scientific realism, consider the following four synthetic but physically plausible single-period measurement sets, each defined by a parametric generation of $B(t)$ and $H(t)$ sampled uniformly over one period $T=1/f$. In all cases, let $t\\in[0,T)$, $N=20000$ samples, $\\omega=2\\pi f$, and $f=10\\,\\mathrm{kHz}$.\n\n1. Happy path (moderate hysteresis): $B(t)=B_p\\sin(\\omega t)$ with $B_p=0.3\\,\\mathrm{T}$, and $H(t)=\\frac{B(t)}{\\mu_\\mathrm{eff}}+H_c\\tanh\\!\\left(\\frac{\\mathrm{d}B/\\mathrm{d}t}{v_0}\\right)$ using $\\mu_\\mathrm{eff}=2.0\\times 10^{-3}\\,\\mathrm{T}/(\\mathrm{A}/\\mathrm{m})$, $H_c=50\\,\\mathrm{A}/\\mathrm{m}$, $v_0=1000\\,\\mathrm{T}/\\mathrm{s}$.\n\n2. Narrow loop (low coercivity): Same $B(t)$ and parameters as case 1 except $H_c=5\\,\\mathrm{A}/\\mathrm{m}$.\n\n3. Low amplitude (edge case): $B_p=0.01\\,\\mathrm{T}$ with $\\mu_\\mathrm{eff}=2.0\\times 10^{-3}\\,\\mathrm{T}/(\\mathrm{A}/\\mathrm{m})$, $H_c=50\\,\\mathrm{A}/\\mathrm{m}$, $v_0=1000\\,\\mathrm{T}/\\mathrm{s}$.\n\n4. Degenerate loop (boundary case): $B_p=0\\,\\mathrm{T}$ with $\\mu_\\mathrm{eff}=2.0\\times 10^{-3}\\,\\mathrm{T}/(\\mathrm{A}/\\mathrm{m})$, $H_c=50\\,\\mathrm{A}/\\mathrm{m}$, $v_0=1000\\,\\mathrm{T}/\\mathrm{s}$.\n\nFor each case, your program must:\n- Generate $B(t)$ and $H(t)$ using the above definitions.\n- Compute the per-cycle energy per unit volume via a line integral along the loop in the $B$–$H$ plane using a numerically stable discretization that closes the loop.\n- Compute the hysteresis loss power density in $\\mathrm{W}/\\mathrm{m}^3$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the hysteresis loss power density for the corresponding test case, in $\\mathrm{W}/\\mathrm{m}^3$, rounded to three decimal places.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of electromagnetism, self-contained with all necessary parameters and equations, and well-posed, leading to a unique, stable, and meaningful solution for each test case. The task is to compute the hysteresis loss power density in a magnetic material by numerically evaluating the area of its B-H loop.\n\nThe solution proceeds by first establishing the theoretical basis from first principles, then developing a robust numerical algorithm, and finally applying this algorithm to the specified test cases.\n\n### 1. Theoretical Foundation: Energy Dissipation in Magnetic Materials\n\nThe work done by an external a magnetic field $\\mathbf{H}$ on a magnetic material with flux density $\\mathbf{B}$ is described by the energy input per unit volume. The incremental magnetic work density (work per unit volume) $\\mathrm{d}W_m$ required to change the magnetic flux density by $\\mathrm{d}\\mathbf{B}$ is given by:\n$$\n\\mathrm{d}W_m = \\mathbf{H} \\cdot \\mathrm{d}\\mathbf{B}\n$$\nThis expression is a direct consequence of Poynting's theorem for energy conservation in electromagnetic fields. When a magnetic material is subjected to a time-varying magnetic field over a complete cycle of period $T$, the net energy supplied to the material per unit volume, $W_\\text{cycle}$, is the integral of the instantaneous power density, $\\mathbf{H} \\cdot \\frac{\\partial\\mathbf{B}}{\\partial t}$, over one period:\n$$\nW_\\text{cycle} = \\int_{0}^{T} \\left( \\mathbf{H}(t) \\cdot \\frac{\\mathrm{d}\\mathbf{B}(t)}{\\mathrm{d}t} \\right) \\mathrm{d}t\n$$\nAssuming the fields $\\mathbf{H}$ and $\\mathbf{B}$ are collinear, as is typical for a toroidal core geometry, we can use scalar quantities $H$ and $B$. The integral can be transformed by a change of variable from time $t$ to flux density $B$:\n$$\nW_\\text{cycle} = \\oint H \\, \\mathrm{d}B\n$$\nThis is a closed line integral evaluated along the trajectory of the state $(B(t), H(t))$ in the B-H plane over one full cycle. This trajectory forms the hysteresis loop.\n\nThe total energy supplied, $W_\\text{cycle}$, is partitioned into two components: the change in stored magnetic energy and the energy dissipated as heat. Since the material returns to its initial magnetic state after one cycle, the net change in stored energy is zero. Therefore, the integral represents the total energy dissipated per unit volume per cycle, $W_\\text{diss}$:\n$$\nW_\\text{diss} = \\oint H \\, \\mathrm{d}B\n$$\nGeometrically, this integral is the area enclosed by the B-H loop. For any passive material, energy must be dissipated, not generated, so this area must be non-negative.\n\n### 2. Power Loss Density\n\nThe average power dissipated per unit volume, known as the power loss density $P_\\text{loss}$, is the energy dissipated per cycle $W_\\text{diss}$ divided by the period of the cycle, $T$. Given the frequency $f = 1/T$, the power loss density is:\n$$\nP_\\text{loss} = \\frac{W_\\text{diss}}{T} = W_\\text{diss} \\cdot f\n$$\nThe units are Joules per cubic meter per second ($\\mathrm{J}/(\\mathrm{m}^3 \\cdot \\mathrm{s})$), which is equivalent to Watts per cubic meter ($\\mathrm{W}/\\mathrm{m}^3$).\n\n### 3. Numerical Integration Procedure\n\nThe problem provides the B-H loop as a series of discrete samples $\\{(B_i, H_i)\\}_{i=0}^{N-1}$ taken at uniform time intervals. The closed line integral $\\oint H \\, \\mathrm{d}B$ can be computed numerically by summing the areas of trapezoids formed by each segment of the discretized loop. The area element contributed by the segment from point $i$ to $i+1$ is approximated as:\n$$\n\\Delta W_i \\approx \\left(\\frac{H_i + H_{i+1}}{2}\\right) (B_{i+1} - B_i)\n$$\nTo compute the total area for the closed loop, we sum these contributions over all segments, from $i=0$ to $N-1$. The loop is closed by connecting the last point $(B_{N-1}, H_{N-1})$ back to the first point $(B_0, H_0)$. This is handled by taking the indices modulo $N$, i.e., at step $i=N-1$, the next point is $(B_N, H_N) = (B_0, H_0)$. The total dissipated energy per cycle is then:\n$$\nW_\\text{diss} \\approx \\sum_{i=0}^{N-1} \\left(\\frac{H_i + H_{i+1 \\pmod N}}{2}\\right) (B_{i+1 \\pmod N} - B_i)\n$$\nTo ensure the physicality of the result (dissipated power cannot be negative), we take the absolute value of the computed area. This accounts for cases where the loop might be traversed in a direction that yields a negative mathematical area (e.g., clockwise).\n$$\nW_\\text{diss} = \\left| \\sum_{i=0}^{N-1} \\left(\\frac{H_i + H_{i+1 \\pmod N}}{2}\\right) (B_{i+1 \\pmod N} - B_i) \\right|\n$$\n\n### 4. Application to Test Cases\n\nFor each test case, we first generate the discrete time series for $B(t)$ and $H(t)$.\nThe parameters are: frequency $f=10\\,\\mathrm{kHz}$, number of samples $N=20000$.\nThe period is $T=1/f = 10^{-4}\\,\\mathrm{s}$, and the angular frequency is $\\omega=2\\pi f = 2\\pi \\times 10^4\\,\\mathrm{rad/s}$.\nThe time samples are $t_i = i \\cdot \\Delta t$ for $i \\in \\{0, 1, ..., N-1\\}$, where $\\Delta t = T/N$.\n\nThe signals are generated as follows:\n-   Flux density: $B(t) = B_p \\sin(\\omega t)$\n-   Time derivative of flux density: $\\frac{\\mathrm{d}B}{\\mathrm{d}t} = B_p \\omega \\cos(\\omega t)$\n-   Magnetic field strength: $H(t) = \\frac{B(t)}{\\mu_\\mathrm{eff}}} + H_c\\tanh\\left(\\frac{\\mathrm{d}B/\\mathrm{d}t}{v_0}\\right)$\n\nThe discrete data arrays $B_i$ and $H_i$ are generated by evaluating these functions at each time step $t_i$. These arrays are then used in the numerical integration formula to find $W_\\text{diss}$, which is subsequently multiplied by $f$ to obtain $P_\\text{loss}$.\n\nThe algorithm proceeds as follows for each test case:\n1.  Set the specific parameters for the case: $B_p$, $\\mu_\\mathrm{eff}$, $H_c$, $v_0$.\n2.  Generate an array of $N$ time points $t_i$ from $0$ to $T(1-1/N)$.\n3.  Generate the array $B_i = B(t_i) = B_p \\sin(\\omega t_i)$.\n4.  Generate the array $(\\mathrm{d}B/\\mathrm{d}t)_i = B_p \\omega \\cos(\\omega t_i)$.\n5.  Generate the array $H_i = H(t_i)$ using the formula provided.\n6.  Compute the per-cycle energy density $W_\\text{diss}$ using the trapezoidal summation over the $(B_i, H_i)$ points, ensuring the result is non-negative.\n7.  Compute the power loss density $P_\\text{loss} = W_\\text{diss} \\cdot f$.\n8.  Round the final value of $P_\\text{loss}$ to three decimal places.\n\nThis procedure is systematically applied to all four specified test cases. The degenerate case, where $B_p=0$, serves as a crucial sanity check, as it must yield zero loss.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes hysteresis loss power density for four test cases based on a\n    phenomenological model of a magnetic B-H loop.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    test_cases = [\n        {\n            \"name\": \"1. Happy path (moderate hysteresis)\",\n            \"B_p\": 0.3, # T\n            \"mu_eff\": 2.0e-3, # T/(A/m)\n            \"H_c\": 50.0, # A/m\n            \"v_0\": 1000.0, # T/s\n        },\n        {\n            \"name\": \"2. Narrow loop (low coercivity)\",\n            \"B_p\": 0.3, # T\n            \"mu_eff\": 2.0e-3, # T/(A/m)\n            \"H_c\": 5.0, # A/m\n            \"v_0\": 1000.0, # T/s\n        },\n        {\n            \"name\": \"3. Low amplitude (edge case)\",\n            \"B_p\": 0.01, # T\n            \"mu_eff\": 2.0e-3, # T/(A/m)\n            \"H_c\": 50.0, # A/m\n            \"v_0\": 1000.0, # T/s\n        },\n        {\n            \"name\": \"4. Degenerate loop (boundary case)\",\n            \"B_p\": 0.0, # T\n            \"mu_eff\": 2.0e-3, # T/(A/m)\n            \"H_c\": 50.0, # A/m\n            \"v_0\": 1000.0, # T/s\n        },\n    ]\n\n    # Global parameters\n    f = 10000.0  # Hz\n    N = 20000    # Number of samples\n\n    def calculate_loss_power_density(params, f, N):\n        \"\"\"\n        Generates B(t) and H(t) data and computes the loss power density.\n        \n        Args:\n            params (dict): Dictionary containing B_p, mu_eff, H_c, v_0.\n            f (float): Frequency in Hz.\n            N (int): Number of samples per period.\n            \n        Returns:\n            float: Hysteresis loss power density in W/m^3.\n        \"\"\"\n        # Extract parameters for the current case\n        B_p = params[\"B_p\"]\n        mu_eff = params[\"mu_eff\"]\n        H_c = params[\"H_c\"]\n        v_0 = params[\"v_0\"]\n\n        # Time and frequency domain setup\n        T = 1.0 / f\n        omega = 2.0 * np.pi * f\n        t = np.linspace(0, T, N, endpoint=False)\n\n        # Generate B(t) and its time derivative dB/dt\n        B = B_p * np.sin(omega * t)\n        dB_dt = B_p * omega * np.cos(omega * t)\n\n        # Generate H(t) based on the provided phenomenological model\n        H = (B / mu_eff) + H_c * np.tanh(dB_dt / v_0)\n        \n        # Handle the degenerate case where B is constant (e.g., B_p = 0)\n        # In this case, dB is zero everywhere, so the integral is zero.\n        if np.all(B == B[0]):\n            return 0.0\n\n        # Numerically compute the line integral W_diss = integral(H dB)\n        # This calculates the area of the B-H loop.\n        # We use a robust method based on the surveyor's formula / trapezoidal rule.\n        # Create shifted arrays to compute differences for closing the loop.\n        # B_next at index i is B at index i+1 (with wrap-around)\n        B_next = np.roll(B, -1)\n        H_next = np.roll(H, -1)\n        \n        # Area contribution from each segment using trapezoidal rule: (y1+y2)/2 * (x2-x1)\n        # Here x is B and y is H.\n        dB = B_next - B\n        H_avg = 0.5 * (H + H_next)\n        \n        W_diss_per_cycle = np.sum(H_avg * dB)\n\n        # Dissipated energy must be non-negative. Taking the absolute value\n        # accounts for the direction of integration (clockwise vs. counter-clockwise).\n        W_diss_per_cycle = abs(W_diss_per_cycle)\n\n        # Convert energy per cycle per volume (J/m^3) to power density (W/m^3)\n        power_loss_density = W_diss_per_cycle * f\n\n        return power_loss_density\n\n    results = []\n    for case in test_cases:\n        power_loss = calculate_loss_power_density(case, f, N)\n        # Round the result to three decimal places as specified.\n        results.append(round(power_loss, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The area of a measured B-H loop represents the total energy dissipated per cycle, but is this due to hysteresis, eddy currents, or both? This critical thinking exercise challenges you to determine the conditions under which the B-H loop area accurately reflects intrinsic hysteresis versus the total core loss . By applying the concept of magnetic skin depth, $\\delta$, you will learn to correctly interpret magnetic measurements in different materials and at various frequencies.",
            "id": "3848096",
            "problem": "A laboratory in power electronics seeks to quantify the intrinsic hysteresis energy per unit volume of magnetic cores used in high-frequency transformers by measuring the closed-loop integral $\\oint H\\,\\mathrm{d}B$ over one steady-state cycle. The measurement setup uses a toroidal core driven by a magnetizing winding with $N$ turns and a sense winding with $N_s$ turns. The magnetizing current $i(t)$ yields an estimate of the applied magnetizing field $H_{\\mathrm{app}}(t)\\approx N i(t)/\\ell_{\\mathrm{m}}$, where $\\ell_{\\mathrm{m}}$ is the mean magnetic path length, and the sense winding voltage $v_s(t)$ is integrated to estimate the average flux density $B_{\\mathrm{avg}}(t)\\approx \\frac{1}{A_c N_s}\\int v_s(t)\\,\\mathrm{d}t$, where $A_c$ is the core cross-sectional area. The laboratory plans to use the loop area $\\oint H_{\\mathrm{app}}\\,\\mathrm{d}B_{\\mathrm{avg}}$ divided by core volume to represent hysteresis energy per unit volume.\n\nYou are asked to critically assess the assumptions required for $\\oint H\\,\\mathrm{d}B$ to equal intrinsic hysteresis energy per unit volume, starting from fundamental electromagnetic principles, and to determine when eddy currents distort the measurement of $H$ and $B$ to the point that $\\oint H\\,\\mathrm{d}B$ includes non-hysteretic losses. In particular, consider the following two cores and operating conditions typical in power electronics:\n\nCase 1 (ferrite): a toroidal ferrite core with conductivity $\\sigma = 1\\,\\mathrm{S/m}$, relative permeability $\\mu_r = 2000$, thickness (radial dimension) $t = 2\\,\\mathrm{mm}$, driven at $f=100\\,\\mathrm{kHz}$.\n\nCase 2 (silicon steel): a solid toroidal silicon steel core with conductivity $\\sigma = 2\\times 10^{6}\\,\\mathrm{S/m}$, relative permeability $\\mu_r = 4000$, thickness $t = 2\\,\\mathrm{mm}$, driven at $f=100\\,\\mathrm{kHz}$.\n\nUse the magnetic skin depth $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ with $\\omega = 2\\pi f$ and $\\mu = \\mu_0 \\mu_r$, where $\\mu_0$ is the permeability of free space, and reason from Maxwell’s equations and the Poynting theorem to establish the conditions under which eddy currents can be neglected and the measurement $\\oint H\\,\\mathrm{d}B$ faithfully represents hysteresis energy per unit volume. Also comment on the role of demagnetizing fields and spatial nonuniformity.\n\nSelect all statements that are correct:\n\nA. The identification of $\\oint H\\,\\mathrm{d}B$ with intrinsic hysteresis energy per unit volume is valid only under quasi-static excitation when conduction currents are negligible, displacement currents are negligible, and the internal fields $H(\\mathbf{r},t)$ and $B(\\mathbf{r},t)$ are spatially uniform (or appropriately volume-averaged), with demagnetizing effects either minimized (e.g., toroidal geometry) or explicitly corrected; otherwise, $\\oint H\\,\\mathrm{d}B$ includes non-hysteretic contributions.\n\nB. For any conducting magnetic core at any finite frequency, the area of the measured loop $\\oint H\\,\\mathrm{d}B$ necessarily overestimates intrinsic hysteresis loss, independent of thickness or skin depth, because the path is magnetically closed.\n\nC. Eddy currents significantly distort the measured $H$ and $B$ when the magnetic skin depth $\\delta$ is smaller than a characteristic transverse dimension (e.g., thickness $t$), equivalently when $\\omega \\mu \\sigma t^{2}\\gg 1$ or $\\delta \\ll t$, causing phase lag and spatial nonuniformity such that the apparent loop area $\\oint H\\,\\mathrm{d}B$ includes dynamic eddy-current loss in addition to hysteresis.\n\nD. In Case 1 (ferrite, $f=100\\,\\mathrm{kHz}$, $\\sigma = 1\\,\\mathrm{S/m}$, $\\mu_r = 2000$, $t=2\\,\\mathrm{mm}$), the skin depth satisfies $\\delta \\gg t$, so eddy currents are negligible and the measured $\\oint H\\,\\mathrm{d}B$ per unit volume closely approximates intrinsic hysteresis energy per unit volume.\n\nE. In Case 2 (silicon steel, $f=100\\,\\mathrm{kHz}$, $\\sigma = 2\\times 10^{6}\\,\\mathrm{S/m}$, $\\mu_r = 4000$, $t=2\\,\\mathrm{mm}$), the measurement of $H$ from $N i/\\ell_{\\mathrm{m}}$ and $B$ from $\\frac{1}{A_c N_s}\\int v_s\\,\\mathrm{d}t$ is unaffected by eddy currents because the toroidal geometry eliminates demagnetizing fields.\n\nF. At frequencies below approximately $1\\,\\mathrm{MHz}$, displacement currents dominate the distortion of $H$ and $B$ in magnetic cores, so eddy currents can be neglected in interpreting $\\oint H\\,\\mathrm{d}B$.",
            "solution": "The problem statement is a valid request for a theoretical analysis of a measurement technique in magnetism. It is scientifically grounded in classical electromagnetism, well-posed, and uses objective, technical language with realistic parameters. The problem is free of the invalidating flaws listed in the instructions. We may therefore proceed with the solution.\n\n### Fundamental Principles: Energy Dissipation in Magnetic Materials\n\nThe energy dissipation in a magnetic material subjected to a time-varying magnetic field can be understood by starting with Poynting's theorem. The power delivered by the electromagnetic field to a volume $V$ of material is given by the sum of Ohmic losses and the rate of change of stored field energy. For a full cycle of a periodic field, the net change in stored energy is zero. The total energy dissipated in the material over one cycle, $W_{\\text{cycle}}$, is therefore the time integral of the input power over one period, $T$.\n\nThe electrical power delivered by the magnetizing winding is $P(t) = v(t)i(t)$. The voltage on this primary winding with $N$ turns is given by Faraday's law of induction, $v(t) = N \\frac{d\\Phi}{dt}$, where $\\Phi$ is the total magnetic flux through the core. The flux is the integral of the magnetic flux density $B$ over the core's cross-sectional area, $\\Phi(t) = \\int_{A_c} B(\\mathbf{r}, t) \\, dA = A_c B_{\\mathrm{avg}}(t)$. The magnetizing current $i(t)$ creates the applied magnetic field $H_{\\text{app}}(t)$ according to Ampere's law, which for a toroid of mean magnetic path length $\\ell_{\\mathrm{m}}$ is approximately $H_{\\text{app}}(t) = N i(t) / \\ell_{\\mathrm{m}}$.\n\nCombining these relations, the input power is:\n$$ P(t) = \\left(N A_c \\frac{d B_{\\mathrm{avg}}}{dt}\\right) \\left(\\frac{H_{\\mathrm{app}} \\ell_{\\mathrm{m}}}{N}\\right) = (A_c \\ell_{\\mathrm{m}}) H_{\\mathrm{app}}(t) \\frac{d B_{\\mathrm{avg}}(t)}{dt} $$\nRecognizing that the core volume is $V_{\\text{core}} = A_c \\ell_{\\mathrm{m}}$, the power is $P(t) = V_{\\text{core}} H_{\\mathrm{app}}(t) \\frac{d B_{\\mathrm{avg}}(t)}{dt}$.\n\nThe total energy dissipated per cycle is the integral of this power over one period $T$:\n$$ W_{\\text{cycle}} = \\int_0^T P(t) \\, dt = V_{\\text{core}} \\int_0^T H_{\\mathrm{app}}(t) \\frac{d B_{\\mathrm{avg}}(t)}{dt} dt = V_{\\text{core}} \\oint H_{\\mathrm{app}} \\, \\mathrm{d}B_{\\mathrm{avg}} $$\nThus, the measured quantity, the area of the loop traced by the applied field $H_{\\mathrm{app}}$ and the average flux density $B_{\\mathrm{avg}}$, represents the **total energy loss per unit volume per cycle**.\n\nThis total loss arises from two primary mechanisms inside the material:\n1.  **Hysteresis Loss ($w_h$)**: Energy dissipated due to the irreversible motion of magnetic domain walls. In the absence of other effects, this is given by the area of the intrinsic hysteresis loop, $\\oint H \\, \\mathrm{d}B$.\n2.  **Eddy Current Loss ($w_e$)**: Ohmic loss ($\\int \\sigma E^2 \\, dt$) from currents induced by the time-varying magnetic flux, as per Faraday's law ($\\nabla \\times \\mathbf{E} = -\\partial\\mathbf{B}/\\partial t$).\n\nTherefore, the measured loop area represents the sum of these losses:\n$$ \\frac{W_{\\text{cycle}}}{V_{\\text{core}}} = \\oint H_{\\mathrm{app}} \\, \\mathrm{d}B_{\\mathrm{avg}} = w_h + w_e $$\nThe measurement $\\oint H_{\\mathrm{app}} \\, \\mathrm{d}B_{\\mathrm{avg}}$ can be identified with the intrinsic hysteresis loss per unit volume, $\\oint H \\, \\mathrm{d}B$, if and only if the eddy current loss $w_e$ is negligible.\n\n### The Role of Eddy Currents and Skin Depth\n\nEddy currents are significant when the material is conductive ($\\sigma > 0$) and the frequency is non-zero ($f > 0$). These currents create their own magnetic field that opposes the applied field, a phenomenon known as magnetic shielding. This causes the internal magnetic fields, $H(\\mathbf{r}, t)$ and $B(\\mathbf{r}, t)$, to become spatially non-uniform, typically decaying from the surface towards the center of the core.\n\nThe characteristic length scale for this decay is the magnetic skin depth, $\\delta$, defined as:\n$$ \\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}} $$\nwhere $\\omega = 2\\pi f$ is the angular frequency, $\\mu = \\mu_0 \\mu_r$ is the magnetic permeability, and $\\sigma$ is the electrical conductivity.\n\nThe significance of eddy currents is determined by comparing the skin depth $\\delta$ to a characteristic transverse dimension of the core, such as its thickness $t$:\n-   If $\\delta \\gg t$: The fields penetrate the core almost uniformly. The induced eddy currents are weak, their shielding effect is negligible, and $H(\\mathbf{r}, t) \\approx H_{\\mathrm{app}}(t)$. In this regime, $w_e \\approx 0$, and the measured loop area closely approximates the intrinsic hysteresis loss: $\\oint H_{\\mathrm{app}} \\, \\mathrm{d}B_{\\mathrm{avg}} \\approx w_h$.\n-   If $\\delta \\ll t$: The fields are confined to a thin layer near the surface. The internal fields are highly non-uniform, and the phase relationship between $H$ and $B$ varies with position. The measured loop is significantly broadened by the eddy current dissipation, and $\\oint H_{\\mathrm{app}} \\, \\mathrm{d}B_{\\mathrm{avg}} = w_h + w_e$, with $w_e$ being a substantial or even dominant term. The condition $\\delta \\ll t$ is equivalent to $\\omega \\mu \\sigma t^2 \\gg 2$.\n\n### Analysis of Case 1 and Case 2\nWe use $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$, $f=100\\,\\mathrm{kHz}$ (so $\\omega = 2\\pi \\times 10^5\\,\\mathrm{rad/s}$), and $t=2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$.\n\n**Case 1 (Ferrite):**\n- Given: $\\sigma = 1\\,\\mathrm{S/m}$, $\\mu_r = 2000$.\n- $\\mu = 2000 \\times 4\\pi \\times 10^{-7} \\approx 2.513 \\times 10^{-3}\\,\\mathrm{H/m}$.\n- Skin depth:\n$$ \\delta_1 = \\sqrt{\\frac{2}{(2\\pi \\times 10^5\\,\\mathrm{s}^{-1})(2.513 \\times 10^{-3}\\,\\mathrm{H/m})(1\\,\\mathrm{S/m})}} \\approx \\sqrt{1.267 \\times 10^{-3}\\,\\mathrm{m}^2} \\approx 0.0356\\,\\mathrm{m} = 35.6\\,\\mathrm{mm} $$\n- Comparison: $\\delta_1 = 35.6\\,\\mathrm{mm}$ is much larger than the thickness $t = 2\\,\\mathrm{mm}$. We are in the $\\delta \\gg t$ regime. Eddy currents are negligible.\n\n**Case 2 (Silicon Steel):**\n- Given: $\\sigma = 2 \\times 10^6\\,\\mathrm{S/m}$, $\\mu_r = 4000$.\n- $\\mu = 4000 \\times 4\\pi \\times 10^{-7} \\approx 5.027 \\times 10^{-3}\\,\\mathrm{H/m}$.\n- Skin depth:\n$$ \\delta_2 = \\sqrt{\\frac{2}{(2\\pi \\times 10^5\\,\\mathrm{s}^{-1})(5.027 \\times 10^{-3}\\,\\mathrm{H/m})(2 \\times 10^6\\,\\mathrm{S/m})}} \\approx \\sqrt{3.166 \\times 10^{-10}\\,\\mathrm{m}^2} \\approx 1.78 \\times 10^{-5}\\,\\mathrm{m} = 0.0178\\,\\mathrm{mm} $$\n- Comparison: $\\delta_2 = 0.0178\\,\\mathrm{mm}$ is much smaller than the thickness $t = 2\\,\\mathrm{mm}$. We are in the $\\delta \\ll t$ regime. Eddy current effects are dominant.\n\n### Evaluation of Options\n\n**A. The identification of $\\oint H\\,\\mathrm{d}B$ with intrinsic hysteresis energy per unit volume is valid only under quasi-static excitation when conduction currents are negligible, displacement currents are negligible, and the internal fields $H(\\mathbf{r},t)$ and $B(\\mathbf{r},t)$ are spatially uniform (or appropriately volume-averaged), with demagnetizing effects either minimized (e.g., toroidal geometry) or explicitly corrected; otherwise, $\\oint H\\,\\mathrm{d}B$ includes non-hysteretic contributions.**\nThis statement is a comprehensive and accurate summary of the conditions required for the measurement to represent intrinsic hysteresis. \"Quasi-static\" implies neglecting wave propagation and often displacement currents. Negligible conduction currents (eddy currents) is the central condition for isolating hysteresis loss. Spatial uniformity is required for the measured averages to be meaningful representations of the bulk material behavior. Minimizing demagnetizing fields (e.g., with a toroid) ensures the applied field $H_{\\mathrm{app}}$ is well-defined. If these conditions are not met, the measured loop represents total loss, including non-hysteretic eddy current loss.\n**Verdict: Correct.**\n\n**B. For any conducting magnetic core at any finite frequency, the area of the measured loop $\\oint H\\,\\mathrm{d}B$ necessarily overestimates intrinsic hysteresis loss, independent of thickness or skin depth, because the path is magnetically closed.**\nWhile it is true that any non-zero conductivity and frequency will produce some eddy currents, leading to an overestimation, the claim that this is \"independent of thickness or skin depth\" is false. The magnitude of this overestimation is critically dependent on the ratio of thickness to skin depth, as shown by our analysis. For $\\delta \\gg t$, the overestimation is negligible; for $\\delta \\ll t$, it is substantial. The magnetically closed path is a feature that *improves* the measurement's validity by defining $H$ cleanly, it does not cause the overestimation.\n**Verdict: Incorrect.**\n\n**C. Eddy currents significantly distort the measured $H$ and $B$ when the magnetic skin depth $\\delta$ is smaller than a characteristic transverse dimension (e.g., thickness $t$), equivalently when $\\omega \\mu \\sigma t^{2}\\gg 1$ or $\\delta \\ll t$, causing phase lag and spatial nonuniformity such that the apparent loop area $\\oint H\\,\\mathrm{d}B$ includes dynamic eddy-current loss in addition to hysteresis.**\nThis statement correctly identifies the condition for significant eddy current effects ($\\delta \\ll t$) and its mathematical equivalent ($\\omega \\mu \\sigma t^2 \\gg 1$, as $\\delta^2 = 2/\\omega\\mu\\sigma$). It also correctly describes the consequences: spatial non-uniformity of fields and the fact that the resulting loop area represents the sum of hysteresis and eddy current losses.\n**Verdict: Correct.**\n\n**D. In Case 1 (ferrite, $f=100\\,\\mathrm{kHz}$, $\\sigma = 1\\,\\mathrm{S/m}$, $\\mu_r = 2000$, $t=2\\,\\mathrm{mm}$), the skin depth satisfies $\\delta \\gg t$, so eddy currents are negligible and the measured $\\oint H\\,\\mathrm{d}B$ per unit volume closely approximates intrinsic hysteresis energy per unit volume.**\nOur calculation for Case 1 yielded $\\delta_1 \\approx 35.6\\,\\mathrm{mm}$, which is indeed much larger than $t = 2\\,\\mathrm{mm}$. This validates the condition $\\delta \\gg t$. Consequently, eddy current losses are minimal, and the measured loop area will be a good approximation of the intrinsic hysteresis loss.\n**Verdict: Correct.**\n\n**E. In Case 2 (silicon steel, $f=100\\,\\mathrm{kHz}$, $\\sigma = 2\\times 10^{6}\\,\\mathrm{S/m}$, $\\mu_r = 4000$, $t=2\\,\\mathrm{mm}$), the measurement of $H$ from $N i/\\ell_{\\mathrm{m}}$ and $B$ from $\\frac{1}{A_c N_s}\\int v_s\\,\\mathrm{d}t$ is unaffected by eddy currents because the toroidal geometry eliminates demagnetizing fields.**\nOur calculation for Case 2 yielded $\\delta_2 \\approx 0.0178\\,\\mathrm{mm}$, which is much smaller than $t = 2\\,\\mathrm{mm}$. This indicates that eddy current effects are extremely strong and will dominate the measurement. The statement that the measurement is \"unaffected by eddy currents\" is false. The reasoning provided is a non-sequitur; while a toroidal geometry does eliminate demagnetizing fields, it has no effect on the generation of eddy currents within the conductive material.\n**Verdict: Incorrect.**\n\n**F. At frequencies below approximately $1\\,\\mathrm{MHz}$, displacement currents dominate the distortion of $H$ and $B$ in magnetic cores, so eddy currents can be neglected in interpreting $\\oint H\\,\\mathrm{d}B$.**\nThis statement fundamentally misunderstands the relative magnitudes of conduction current ($\\mathbf{J}_C = \\sigma\\mathbf{E}$) and displacement current ($\\mathbf{J}_D = \\epsilon \\partial\\mathbf{E}/\\partial t$) in these materials. The ratio of their magnitudes is $|\\mathbf{J}_D|/|\\mathbf{J}_C| = \\omega\\epsilon/\\sigma$. For typical ferrites and especially for metallic cores like silicon steel, the conductivity $\\sigma$ is large enough that this ratio is much less than $1$ well into the MHz range and beyond. Conduction currents (eddy currents) are the dominant current-based loss mechanism, not displacement currents.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}