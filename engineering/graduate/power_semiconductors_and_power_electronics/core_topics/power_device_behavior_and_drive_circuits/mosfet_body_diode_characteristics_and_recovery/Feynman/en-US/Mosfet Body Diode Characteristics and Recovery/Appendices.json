{
    "hands_on_practices": [
        {
            "introduction": "To understand the behavior of the MOSFET body diode, we must first look at its fundamental physical origin: the $p$-$n$ junction formed between the body and drift regions. This exercise takes you back to first principles, guiding you to derive the built-in potential ($V_{bi}$) that establishes the equilibrium barrier opposing carrier diffusion. By working through this calculation , you will connect the microscopic properties of the semiconductor, such as doping concentrations ($N_A$, $N_D$), to a critical macroscopic parameter that governs the diode's turn-on voltage and overall characteristics.",
            "id": "3860223",
            "problem": "A vertical Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) body diode is the $p$-body/$n$-drift junction that sets the intrinsic barrier opposing carrier diffusion at equilibrium. Consider a silicon $p$-body/$n$-drift junction representative of a high-voltage MOSFET, with uniformly doped, quasi-neutral bulk regions characterized by acceptor concentration $N_{A}=3.0\\times 10^{17}\\ \\text{cm}^{-3}$ on the $p$ side and donor concentration $N_{D}=5.0\\times 10^{15}\\ \\text{cm}^{-3}$ on the $n$ side. Assume thermal equilibrium, nondegenerate statistics, and the depletion approximation, and that the intrinsic carrier concentration at temperature $T$ is $n_{i}(T)$. The semiconductor is silicon at $T=300\\ \\text{K}$, for which $n_{i}(300\\ \\text{K})=1.10\\times 10^{10}\\ \\text{cm}^{-3}$.\n\nStarting from fundamental equilibrium conditions for a $p$-$n$ junction (constant Fermi level in equilibrium), the Maxwell–Boltzmann relations connecting carrier concentrations to the Fermi level and the intrinsic level, and the law of mass action $np=n_{i}^{2}$, derive the magnitude of the built-in electrostatic potential drop across the junction in terms of $N_{A}$, $N_{D}$, $n_{i}$, $k_{B}$ (Boltzmann constant), $q$ (elementary charge), and $T$. Clearly state the physical assumptions you use (including why nondegenerate statistics are valid for the given dopings, and why using $n_{i}(300\\ \\text{K})$ is appropriate), and then evaluate the built-in potential numerically for the given $N_{A}$, $N_{D}$, and $n_{i}$ at $T=300\\ \\text{K}$.\n\nExpress the final voltage in volts and round your answer to four significant figures.",
            "solution": "The problem requires the derivation and calculation of the built-in potential, $\\phi_{bi}$, across a silicon $p$-$n$ junction under specific conditions. This will be approached by applying fundamental principles of semiconductor physics in thermal equilibrium.\n\nFirst, the core principle of thermal equilibrium for any system, including a $p$-$n$ junction, is that the Fermi level, $E_F$, must be constant throughout the material. There can be no gradient in the Fermi level, as such a gradient would imply a net flow of carriers, contradicting the definition of equilibrium.\n\nThe carrier concentrations, specifically the electron concentration $n$ and hole concentration $p$, are related to the Fermi level $E_F$ and the intrinsic Fermi level $E_i$ through the Maxwell-Boltzmann approximation for nondegenerate semiconductors. These relations are:\n$$n = n_i \\exp\\left(\\frac{E_F - E_i}{k_B T}\\right)$$\n$$p = n_i \\exp\\left(\\frac{E_i - E_F}{k_B T}\\right)$$\nwhere $n_i$ is the intrinsic carrier concentration, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. Multiplying these two equations demonstrates that they are consistent with the law of mass action, $np = n_i^2$, which holds in thermal equilibrium.\n\nWe analyze the quasi-neutral bulk regions far from the metallurgical junction. In these regions, the net charge density is approximately zero.\n\nOn the $p$-side of the junction (the $p$-body), the material is doped with acceptors at a concentration $N_A$. Assuming full ionization of these acceptors at $T=300\\ \\text{K}$, the majority carrier (hole) concentration $p_p$ is approximately equal to the acceptor concentration:\n$$p_p \\approx N_A$$\nUsing the expression for hole concentration, we can relate the intrinsic level on the $p$-side, $E_{ip}$, to the constant Fermi level $E_F$:\n$$N_A = n_i \\exp\\left(\\frac{E_{ip} - E_F}{k_B T}\\right)$$\nRearranging this equation gives the position of the intrinsic level relative to the Fermi level in the $p$-type bulk:\n$$E_{ip} - E_F = k_B T \\ln\\left(\\frac{N_A}{n_i}\\right)$$\n\nSimilarly, on the $n$-side of the junction (the $n$-drift region), the material is doped with donors at a concentration $N_D$. Assuming full ionization, the majority carrier (electron) concentration $n_n$ is approximately equal to the donor concentration:\n$$n_n \\approx N_D$$\nUsing the expression for electron concentration, we relate the intrinsic level on the $n$-side, $E_{in}$, to the Fermi level $E_F$:\n$$N_D = n_i \\exp\\left(\\frac{E_F - E_{in}}{k_B T}\\right)$$\nRearranging gives the position of the Fermi level relative to the intrinsic level in the $n$-type bulk:\n$$E_F - E_{in} = k_B T \\ln\\left(\\frac{N_D}{n_i}\\right)$$\n\nThe built-in potential, $\\phi_{bi}$, is the electrostatic potential difference across the depletion region that is established to counteract the diffusion of carriers and align the Fermi levels. This potential barrier corresponds to the total shift, or \"bending,\" of the energy bands. The built-in potential energy for a carrier with charge $q$ is the difference between the intrinsic energy levels in the two bulk regions:\n$$q\\phi_{bi} = E_{ip} - E_{in}$$\nWe can express this difference by combining the two previously derived relations:\n$$q\\phi_{bi} = (E_{ip} - E_F) + (E_F - E_{in})$$\nSubstituting the expressions for each term yields:\n$$q\\phi_{bi} = k_B T \\ln\\left(\\frac{N_A}{n_i}\\right) + k_B T \\ln\\left(\\frac{N_D}{n_i}\\right)$$\nUsing the property of logarithms $\\ln(a) + \\ln(b) = \\ln(ab)$, we combine the terms:\n$$q\\phi_{bi} = k_B T \\ln\\left(\\frac{N_A N_D}{n_i^2}\\right)$$\nFinally, solving for the magnitude of the built-in potential, $\\phi_{bi}$, we arrive at the desired expression:\n$$\\phi_{bi} = \\frac{k_B T}{q} \\ln\\left(\\frac{N_A N_D}{n_i^2}\\right)$$\nThe term $\\frac{k_B T}{q}$ is known as the thermal voltage, often denoted $V_T$.\n\nBefore proceeding to the numerical calculation, we must validate the key assumptions.\nThe use of Maxwell-Boltzmann statistics is valid only for nondegenerate semiconductors, where the carrier concentrations are significantly less than the effective density of states in the respective bands. For silicon at $T=300\\ \\text{K}$, the effective density of states in the conduction band is $N_C \\approx 2.8 \\times 10^{19}\\ \\text{cm}^{-3}$ and in the valence band is $N_V \\approx 3.1 \\times 10^{19}\\ \\text{cm}^{-3}$. The given doping concentrations are $N_A = 3.0 \\times 10^{17}\\ \\text{cm}^{-3}$ and $N_D = 5.0 \\times 10^{15}\\ \\text{cm}^{-3}$. Since $N_A \\ll N_V$ and $N_D \\ll N_C$, the semiconductor is indeed nondegenerate on both sides, and the use of Maxwell-Boltzmann statistics is well-justified. The assumption of full dopant ionization is also sound for common dopants like boron (p-type) and phosphorus (n-type) in silicon at room temperature ($T=300\\ \\text{K}$), as their ionization energies are small compared to the thermal energy $k_B T$. Finally, as the entire analysis is performed at $T=300\\ \\text{K}$, using the value of $n_i(300\\ \\text{K})$ is appropriate.\n\nWe now perform the numerical evaluation. The required physical constants are the Boltzmann constant, $k_B \\approx 1.380649 \\times 10^{-23}\\ \\text{J/K}$, and the elementary charge, $q \\approx 1.6021766 \\times 10^{-19}\\ \\text{C}$.\nThe thermal voltage at $T=300\\ \\text{K}$ is:\n$$V_T = \\frac{k_B T}{q} \\approx \\frac{(1.380649 \\times 10^{-23}\\ \\text{J/K})(300\\ \\text{K})}{1.6021766 \\times 10^{-19}\\ \\text{C}} \\approx 0.025852\\ \\text{V}$$\nThe given values for the doping concentrations and intrinsic carrier concentration are:\n$N_A = 3.0 \\times 10^{17}\\ \\text{cm}^{-3}$\n$N_D = 5.0 \\times 10^{15}\\ \\text{cm}^{-3}$\n$n_i = 1.10 \\times 10^{10}\\ \\text{cm}^{-3}$\n\nWe substitute these values into the derived formula for $\\phi_{bi}$:\n$$\\phi_{bi} = (0.025852\\ \\text{V}) \\times \\ln\\left(\\frac{(3.0 \\times 10^{17})(5.0 \\times 10^{15})}{(1.10 \\times 10^{10})^2}\\right)$$\nFirst, we evaluate the argument of the natural logarithm:\n$$\\frac{N_A N_D}{n_i^2} = \\frac{1.5 \\times 10^{33}}{1.21 \\times 10^{20}} = \\frac{1.5}{1.21} \\times 10^{13} \\approx 1.239669 \\times 10^{13}$$\nNow, we calculate the natural logarithm of this value:\n$$\\ln(1.239669 \\times 10^{13}) \\approx 30.1484$$\nFinally, we compute the built-in potential:\n$$\\phi_{bi} \\approx (0.025852\\ \\text{V}) \\times (30.1484) \\approx 0.779412\\ \\text{V}$$\nRounding the result to four significant figures as requested, we obtain:\n$$\\phi_{bi} \\approx 0.7794\\ \\text{V}$$\nThis value represents the magnitude of the electrostatic potential drop across the junction at thermal equilibrium.",
            "answer": "$$\\boxed{0.7794}$$"
        },
        {
            "introduction": "With the fundamental junction potential established, we now turn to the diode's primary function in many circuits: forward conduction. This practice  challenges you to model the total forward voltage drop ($V_F$) across the body diode at a significant operating current and elevated temperature. You will apply the Shockley diode equation and, crucially, account for the parasitic series resistance ($R_s$), a non-ideal effect that becomes dominant at high currents and significantly impacts conduction losses and device efficiency.",
            "id": "3860199",
            "problem": "A power circuit employs the parasitic body diode of an N-channel Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) to conduct a specified forward current. The device is operated at a junction temperature of $T=125^{\\circ}\\mathrm{C}$ and conducts a constant forward current of $I=20\\,\\mathrm{A}$. The body diode can be modeled as a $p$-$n$ junction with a recombination-dominated ideality factor $n$ and a lumped series resistance $R_{s}$ accounting for source metallization, drift-region resistivity, and bond-wire resistance. The diode’s reverse saturation current at $T=125^{\\circ}\\mathrm{C}$ is measured to be $I_{S}=2.0\\times 10^{-6}\\,\\mathrm{A}$, and the ideality factor is $n=1.8$. The series resistance is $R_{s}=10\\,\\mathrm{m}\\Omega=0.01\\,\\Omega$. Use Boltzmann statistics and drift–diffusion physics for a forward-biased $p$-$n$ junction to model the diode conduction. Take the Boltzmann constant as $k_{B}=1.380\\,649\\times 10^{-23}\\,\\mathrm{J/K}$ and the elementary charge as $q=1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{C}$.\n\nStarting from the fundamental definitions of thermal voltage and the exponential carrier injection in a forward-biased $p$-$n$ junction, and accounting for the series resistance outside the junction, derive the current–voltage relation needed to solve for the junction forward drop and the total device forward voltage. Then:\n\n- Compute the total forward voltage $V_{F}$ across the conducting MOSFET body diode under the specified conditions.\n- Quantify the sensitivity of $V_{F}$ to the series resistance at this operating point by evaluating the partial derivative $\\partial V_{F}/\\partial R_{s}$ at fixed current $I$.\n\nRound both numerical results to four significant figures. Express $V_{F}$ in volts and the sensitivity in volts per ohm. Provide both numbers in your final answer as a row matrix $\\left[V_{F},\\,\\partial V_{F}/\\partial R_{s}\\right]$.",
            "solution": "The total forward voltage drop, $V_F$, across the MOSFET body diode is the sum of the voltage drop across the intrinsic $p$-$n$ junction, $V_j$, and the voltage drop across the lumped series resistance, $R_s$.\n$$V_F = V_j + I R_s$$\nwhere $I$ is the forward current.\n\nThe relationship between the forward current $I$ and the junction voltage $V_j$ is given by the Shockley diode equation:\n$$I = I_S \\left( \\exp\\left(\\frac{q V_j}{n k_B T}\\right) - 1 \\right)$$\nHere, $I_S$ is the reverse saturation current, $q$ is the elementary charge, $n$ is the ideality factor, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature in Kelvin.\n\nThe term $\\frac{k_B T}{q}$ is known as the thermal voltage, $V_T$. The temperature is given as $T=125^{\\circ}\\mathrm{C}$. We must convert this to Kelvin:\n$$T(\\text{K}) = 125 + 273.15 = 398.15\\,\\mathrm{K}$$\nNow, we can calculate the thermal voltage $V_T$:\n$$V_T = \\frac{k_B T}{q} = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) (398.15\\,\\mathrm{K})}{1.602176634 \\times 10^{-19}\\,\\mathrm{C}} \\approx 0.034346\\,\\mathrm{V}$$\nThe diode equation can be expressed in terms of $V_T$:\n$$I = I_S \\left( \\exp\\left(\\frac{V_j}{n V_T}\\right) - 1 \\right)$$\nFor the given forward current $I = 20\\,\\mathrm{A}$ and reverse saturation current $I_S = 2.0 \\times 10^{-6}\\,\\mathrm{A}$, the ratio $\\frac{I}{I_S} = \\frac{20}{2.0 \\times 10^{-6}} = 10^7$ is very large. This indicates strong forward bias, where the exponential term is much greater than $1$. Therefore, the equation can be accurately simplified to:\n$$I \\approx I_S \\exp\\left(\\frac{V_j}{n V_T}\\right)$$\nWe can solve this equation for the junction voltage $V_j$:\n$$\\frac{I}{I_S} = \\exp\\left(\\frac{V_j}{n V_T}\\right)$$\n$$\\ln\\left(\\frac{I}{I_S}\\right) = \\frac{V_j}{n V_T}$$\n$$V_j = n V_T \\ln\\left(\\frac{I}{I_S}\\right)$$\nSubstituting the given numerical values:\n$$V_j = (1.8) (0.034346\\,\\mathrm{V}) \\ln\\left(\\frac{20\\,\\mathrm{A}}{2.0 \\times 10^{-6}\\,\\mathrm{A}}\\right)$$\n$$V_j = (1.8) (0.034346\\,\\mathrm{V}) \\ln(10^7)$$\n$$V_j \\approx (0.061823\\,\\mathrm{V}) (16.1181) \\approx 0.99539\\,\\mathrm{V}$$\nNext, we calculate the voltage drop across the series resistance $R_s = 0.01\\,\\Omega$:\n$$V_{Rs} = I R_s = (20\\,\\mathrm{A})(0.01\\,\\Omega) = 0.2\\,\\mathrm{V}$$\nFinally, the total forward voltage $V_F$ is the sum of these two components:\n$$V_F = V_j + V_{Rs} \\approx 0.99539\\,\\mathrm{V} + 0.2\\,\\mathrm{V} = 1.19539\\,\\mathrm{V}$$\nRounding to four significant figures, we get $V_F = 1.195\\,\\mathrm{V}$.\n\nNow, we compute the sensitivity of $V_F$ to the series resistance, $\\frac{\\partial V_F}{\\partial R_s}$, at a fixed current $I$. To do this, we express $V_F$ as a function of $I$ and $R_s$:\n$$V_F(I, R_s) = V_j(I) + I R_s$$\nSubstituting the expression for $V_j(I)$:\n$$V_F(I, R_s) = n V_T \\ln\\left(\\frac{I}{I_S}\\right) + I R_s$$\nWe take the partial derivative of $V_F$ with respect to $R_s$, holding the current $I$ constant. The term $n V_T \\ln(I/I_S)$ does not depend on $R_s$, so its derivative with respect to $R_s$ is zero.\n$$\\frac{\\partial V_F}{\\partial R_s} = \\frac{\\partial}{\\partial R_s} \\left[ n V_T \\ln\\left(\\frac{I}{I_S}\\right) + I R_s \\right]_{I=\\text{const}}$$\n$$\\frac{\\partial V_F}{\\partial R_s} = 0 + \\frac{\\partial}{\\partial R_s}(I R_s)$$\nSince $I$ is treated as a constant in this partial derivative:\n$$\\frac{\\partial V_F}{\\partial R_s} = I$$\nThe problem specifies the current is $I = 20\\,\\mathrm{A}$. Therefore, the sensitivity is:\n$$\\frac{\\partial V_F}{\\partial R_s} = 20\\,\\mathrm{A} = 20\\,\\mathrm{V/\\Omega}$$\nThe problem asks for this result to be rounded to four significant figures, which gives $20.00\\,\\mathrm{V/\\Omega}$.\n\nThe requested numerical results are $V_F \\approx 1.195\\,\\mathrm{V}$ and $\\frac{\\partial V_F}{\\partial R_s} = 20.00\\,\\mathrm{V/\\Omega}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.195 & 20.00 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Perhaps the most critical and complex aspect of the body diode's behavior is its reverse recovery, which can dictate switching losses, electromagnetic interference (EMI), and overall system reliability. This final hands-on practice  moves from theoretical calculation to practical characterization, simulating a core engineering task. You will develop and implement a procedure to extract the key reverse-recovery parameters, $Q_{rr}$ and $t_{rr}$, from synthetic but realistic double-pulse test data, learning to handle non-ideal effects and apply numerical methods to bridge the gap between theory and measurement.",
            "id": "3860166",
            "problem": "A Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) exhibits a body diode whose reverse-recovery behavior can be observed in a double-pulse test. Consider sampled current data versus time from such a test, where the device conducts forward current until a commutation event at time $t_s$, after which the measured current includes the reverse-recovery transient. Starting from the fundamental definitions of electric charge and carrier continuity, derive a parameter-extraction procedure that computes the Reverse-Recovery Charge ($Q_{rr}$) and the Reverse-Recovery Time ($t_{rr}$) by combining numerical integration of the sampled current and a fit to a charge-control model. Implement this extraction as a program that generates synthetic but physically consistent double-pulse current datasets and processes them according to the derived procedure.\n\nUse the following foundational base only:\n- The definition of charge as the time integral of current: $Q(t) = \\int i(t)\\,dt$.\n- The charge-control approximation for stored minority-carrier charge in a diode region subject to reverse bias: $\\dfrac{dQ(t)}{dt} = -\\dfrac{Q(t)}{\\tau}$, where $\\tau$ is an effective recombination lifetime.\n- The relation between the reverse-recovery current and stored charge removal: $i_{rr}(t) = -\\dfrac{dQ(t)}{dt}$ during the recovery interval.\n\nYour derivation must establish, without invoking any shortcut formulas, how to:\n- Identify the reverse-recovery interval from sampled current data $i(t_k)$ at sample times $t_k$.\n- Compute $Q_{rr}$ by numerical integration of the magnitude of the reverse-recovery current over its interval.\n- Fit the magnitude of the reverse-recovery current to an exponential implied by the charge-control model to estimate $\\tau$ and the initial amplitude $i_0$ at the start of the recovery interval, and use these to compute a model-based $t_{rr}$ referenced to a threshold criterion.\n\nDefinitions and conventions to use:\n- Let the commutation start time be $t_s$, defined as the first sample time at which the measured current becomes strictly negative after forward conduction ends.\n- Let the reverse-recovery current magnitude be $|i_{rr}(t)| = \\max(-i(t), 0)$.\n- Let $i_{\\text{peak}}$ be the peak value of $|i_{rr}(t)|$ over the reverse-recovery interval.\n- Define the reverse-recovery end time $t_e$ as the last sample time at which $|i_{rr}(t)|$ is greater than or equal to a threshold $i_{\\text{th}} = f_{\\text{th}}\\cdot i_{\\text{peak}}$, where $f_{\\text{th}}$ is a specified fraction.\n- Define the data-derived reverse-recovery time as $t_{rr,\\text{data}} = t_e - t_s$.\n- Under the charge-control model, for $t \\ge t_s$, the stored charge is $Q(t) = Q_0 e^{-(t-t_s)/\\tau}$ and the reverse-recovery current magnitude is $|i_{rr}(t)| = \\dfrac{Q_0}{\\tau} e^{-(t-t_s)/\\tau} = i_0 e^{-(t-t_s)/\\tau}$, where $Q_0$ is the initial stored charge and $i_0 = \\dfrac{Q_0}{\\tau}$. Show that $Q_{rr} = Q_0$ and derive a linear regression method for estimating $\\tau$ and $i_0$ from $\\{\\log |i_{rr}(t_k)|\\}$ over a suitably chosen sub-interval of the data. Using the model fit, define the model-based reverse-recovery time as $t_{rr,\\text{model}} = \\tau \\ln\\!\\left(\\dfrac{i_0}{i_{\\text{th,model}}}\\right)$ with $i_{\\text{th,model}} = f_{\\text{th}}\\cdot i_0$, which simplifies to $t_{rr,\\text{model}} = \\tau \\ln\\!\\left(\\dfrac{1}{f_{\\text{th}}}\\right)$.\n\nYour program must:\n- Synthesize four double-pulse datasets with realistic parameters and sampling, by constructing $i(t)$ as follows: prior to $t_s$, set $i(t) = I_f$ (constant forward conduction current); after $t_s$, set $i(t) = -i_0 e^{-(t-t_s)/\\tau} + i_{\\text{cap}}(t)$ where $i_{\\text{cap}}(t)$ is a short-duration, non-exponential component modeling capacitive displacement current approximated by a Gaussian pulse $i_{\\text{cap}}(t) = -\\alpha\\, i_0 \\exp\\!\\left(-\\dfrac{(t-t_s)^2}{2\\sigma^2}\\right)$, and add zero-mean Gaussian noise with standard deviation $\\eta$. Use $i_0 = \\dfrac{Q_0}{\\tau}$ so that $Q_0$ is the true stored charge. Ensure physical consistency (no negative times, realistic magnitudes, and durations).\n- Detect $t_s$, compute $i_{\\text{peak}}$, determine $t_e$ by the threshold $f_{\\text{th}}$, and compute $Q_{rr,\\text{int}} = \\int_{t_s}^{t_e} |i_{rr}(t)|\\,dt$ via the trapezoidal rule.\n- Fit the exponential model by linear regression on $\\log |i_{rr}(t)|$ over a sub-interval that excludes the earliest $20\\%$ and the latest $10\\%$ of the identified recovery window to mitigate non-exponential contributions, estimate $\\tau$ and $i_0$, and compute $t_{rr,\\text{model}} = \\tau \\ln\\!\\left(\\dfrac{1}{f_{\\text{th}}}\\right)$.\n- For each dataset, output the pair $(Q_{rr,\\text{int}}, t_{rr,\\text{model}})$.\n\nExpress $Q_{rr}$ in Coulombs and $t_{rr}$ in seconds. The program must produce a single line of output containing the results for all test cases as a comma-separated list of floats enclosed in square brackets $[$ $]$, ordered as $[Q_{rr,1}, t_{rr,1}, Q_{rr,2}, t_{rr,2}, Q_{rr,3}, t_{rr,3}, Q_{rr,4}, t_{rr,4}]$.\n\nTest suite parameter sets to synthesize the datasets:\n- Case $1$ (general case):\n  - $I_f = 20\\ \\mathrm{A}$, $Q_0 = 5\\times 10^{-6}\\ \\mathrm{C}$, $\\tau = 5\\times 10^{-7}\\ \\mathrm{s}$, $t_s = 3\\times 10^{-6}\\ \\mathrm{s}$,\n  - Gaussian pulse fraction $\\alpha = 0.3$, width $\\sigma = 5\\times 10^{-8}\\ \\mathrm{s}$, noise standard deviation $\\eta = 5\\times 10^{-2}\\ \\mathrm{A}$,\n  - Sampling duration $T_{\\text{end}} = 1\\times 10^{-5}\\ \\mathrm{s}$, sampling step $\\Delta t = 1\\times 10^{-8}\\ \\mathrm{s}$, threshold fraction $f_{\\text{th}} = 0.01$.\n- Case $2$ (fast recovery with stronger capacitive spike and finer sampling):\n  - $I_f = 15\\ \\mathrm{A}$, $Q_0 = 8\\times 10^{-7}\\ \\mathrm{C}$, $\\tau = 1\\times 10^{-7}\\ \\mathrm{s}$, $t_s = 2\\times 10^{-6}\\ \\mathrm{s}$,\n  - $\\alpha = 0.7$, $\\sigma = 5\\times 10^{-9}\\ \\mathrm{s}$, $\\eta = 1\\times 10^{-1}\\ \\mathrm{A}$,\n  - $T_{\\text{end}} = 6\\times 10^{-6}\\ \\mathrm{s}$, $\\Delta t = 5\\times 10^{-9}\\ \\mathrm{s}$, $f_{\\text{th}} = 0.02$.\n- Case $3$ (slow recovery possibly truncated within the observation window):\n  - $I_f = 30\\ \\mathrm{A}$, $Q_0 = 8\\times 10^{-6}\\ \\mathrm{C}$, $\\tau = 1\\times 10^{-6}\\ \\mathrm{s}$, $t_s = 4\\times 10^{-6}\\ \\mathrm{s}$,\n  - $\\alpha = 0.2$, $\\sigma = 1.5\\times 10^{-7}\\ \\mathrm{s}$, $\\eta = 5\\times 10^{-2}\\ \\mathrm{A}$,\n  - $T_{\\text{end}} = 8\\times 10^{-6}\\ \\mathrm{s}$, $\\Delta t = 2\\times 10^{-8}\\ \\mathrm{s}$, $f_{\\text{th}} = 0.01$.\n- Case $4$ (low-charge edge case with moderate noise):\n  - $I_f = 10\\ \\mathrm{A}$, $Q_0 = 2\\times 10^{-7}\\ \\mathrm{C}$, $\\tau = 2\\times 10^{-7}\\ \\mathrm{s}$, $t_s = 1.5\\times 10^{-6}\\ \\mathrm{s}$,\n  - $\\alpha = 0.5$, $\\sigma = 2\\times 10^{-8}\\ \\mathrm{s}$, $\\eta = 5\\times 10^{-2}\\ \\mathrm{A}$,\n  - $T_{\\text{end}} = 4\\times 10^{-6}\\ \\mathrm{s}$, $\\Delta t = 5\\times 10^{-9}\\ \\mathrm{s}$, $f_{\\text{th}} = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[Q_{rr,1}, t_{rr,1}, Q_{rr,2}, t_{rr,2}, Q_{rr,3}, t_{rr,3}, Q_{rr,4}, t_{rr,4}]$) in Coulombs and seconds.",
            "solution": "### Derivation of the Analysis Method\n\nThe derivation proceeds from the fundamental principles detailed in the problem statement.\n\n**1. The Charge-Control Model**\n\nThe core of the model is the charge-control approximation for the stored minority-carrier charge, $Q(t)$, in the diode's drift region during reverse recovery. For time $t$ greater than or equal to the commutation start time $t_s$, the dynamics are governed by the first-order differential equation:\n$$\n\\frac{dQ(t)}{dt} = -\\frac{Q(t)}{\\tau}\n$$\nwhere $\\tau$ is the effective minority-carrier recombination lifetime. This equation describes the decay of stored charge due to recombination. This is a separable ordinary differential equation, which can be solved by integration:\n$$\n\\int_{Q(t_s)}^{Q(t)} \\frac{dQ'}{Q'} = \\int_{t_s}^{t} -\\frac{dt'}{\\tau}\n$$\nSolving this yields:\n$$\n\\ln\\left(\\frac{Q(t)}{Q(t_s)}\\right) = -\\frac{t-t_s}{\\tau}\n$$\nExponentiating both sides gives the time evolution of the stored charge:\n$$\nQ(t) = Q(t_s) e^{-(t-t_s)/\\tau}\n$$\nWe define $Q_0 = Q(t_s)$ as the initial stored charge at the beginning of the commutation. Thus, for $t \\ge t_s$:\n$$\nQ(t) = Q_0 e^{-(t-t_s)/\\tau}\n$$\n\n**2. Relation to Reverse-Recovery Current**\n\nThe reverse-recovery current, $i_{rr}(t)$, is the current that results from sweeping out this stored charge. It is defined as the negative rate of change of the stored charge:\n$$\ni_{rr}(t) = -\\frac{dQ(t)}{dt}\n$$\nSubstituting the expression for $Q(t)$:\n$$\ni_{rr}(t) = -\\frac{d}{dt}\\left(Q_0 e^{-(t-t_s)/\\tau}\\right) = -Q_0 \\left(-\\frac{1}{\\tau}\\right) e^{-(t-t_s)/\\tau} = \\frac{Q_0}{\\tau} e^{-(t-t_s)/\\tau}\n$$\nThe problem defines the magnitude of the reverse-recovery current as $|i_{rr}(t)|$. Since $Q_0 > 0$ and $\\tau > 0$, the derived $i_{rr}(t)$ is always non-negative, so $|i_{rr}(t)| = i_{rr}(t)$. By defining the initial current amplitude $i_0 = Q_0/\\tau$, the model for the current magnitude becomes:\n$$\n|i_{rr}(t)| = i_0 e^{-(t-t_s)/\\tau}\n$$\nThis exponential decay form is the basis for fitting the experimental data.\n\n**3. Total Reverse-Recovery Charge ($Q_{rr}$)**\n\nThe total reverse-recovery charge, $Q_{rr}$, is the total charge extracted during the entire recovery process. This corresponds to the time integral of the reverse-recovery current from its start at $t_s$ until all stored charge is depleted ($t \\to \\infty$).\n$$\nQ_{rr} = \\int_{t_s}^{\\infty} |i_{rr}(t)| \\,dt\n$$\nSubstituting the model for $|i_{rr}(t)|$:\n$$\nQ_{rr} = \\int_{t_s}^{\\infty} i_0 e^{-(t-t_s)/\\tau} \\,dt = \\frac{Q_0}{\\tau} \\int_{t_s}^{\\infty} e^{-(t-t_s)/\\tau} \\,dt\n$$\nThe integral evaluates to:\n$$\nQ_{rr} = \\frac{Q_0}{\\tau} \\left[ -\\tau e^{-(t-t_s)/\\tau} \\right]_{t_s}^{\\infty} = -Q_0 \\left[ e^{-(t-t_s)/\\tau} \\right]_{t_s}^{\\infty}\n$$\n$$\nQ_{rr} = -Q_0 \\left( \\lim_{t \\to \\infty} e^{-(t-t_s)/\\tau} - e^{-(t_s-t_s)/\\tau} \\right) = -Q_0(0 - e^0) = Q_0\n$$\nThis derivation confirms that, within this model, the theoretically measurable reverse-recovery charge $Q_{rr}$ is identical to the initial stored charge $Q_0$.\n\n**4. Parameter Extraction Procedure**\n\nThe following steps outline the procedure to extract the parameters from sampled current data $i(t_k)$.\n\n*   **Step A: Identify the Recovery Interval**: First, the commutation start time, $t_s$, is identified from the data as the first sample time where the current $i(t_k)$ becomes strictly negative. The reverse-recovery current magnitude is then calculated as $|i_{rr}(t_k)| = \\max(-i(t_k), 0)$ for all $t_k \\ge t_s$. The peak value of this current, $i_{\\text{peak}} = \\max(|i_{rr}(t_k)|)$, is found. The recovery end time, $t_e$, is defined as the last sample time for which $|i_{rr}(t_k)| \\ge i_{\\text{th}}$, where the threshold is $i_{\\text{th}} = f_{\\text{th}} \\cdot i_{\\text{peak}}$. The interval for analysis is thus $[t_s, t_e]$.\n\n*   **Step B: Compute $Q_{rr,\\text{int}}$**: The reverse-recovery charge is computed by numerically integrating the measured reverse-recovery current magnitude over the identified interval. Using the trapezoidal rule on the discrete data points $(t_k, |i_{rr}(t_k)|)$:\n    $$\n    Q_{rr,\\text{int}} = \\int_{t_s}^{t_e} |i_{rr}(t)| \\,dt \\approx \\sum_{k=s}^{e-1} \\frac{|i_{rr}(t_k)| + |i_{rr}(t_{k+1})|}{2} (t_{k+1} - t_k)\n    $$\n    where the sum is over the samples from the index of $t_s$ to the index of $t_e$.\n\n*   **Step C: Linearization for Model Fitting**: To fit the model $|i_{rr}(t)| = i_0 e^{-(t-t_s)/\\tau}$, we linearize it by taking the natural logarithm:\n    $$\n    \\ln(|i_{rr}(t)|) = \\ln(i_0) - \\frac{t-t_s}{\\tau}\n    $$\n    This equation is of the form $y = c + mx$, where $y = \\ln(|i_{rr}(t)|)$, $x = t - t_s$, the intercept is $c = \\ln(i_0)$, and the slope is $m = -1/\\tau$. A linear regression is performed on the data pairs $(t_k - t_s, \\ln(|i_{rr}(t_k)|))$ from a specified sub-interval of $[t_s, t_e]$ to find the best-fit slope $\\hat{m}$ and intercept $\\hat{c}$. The sub-interval excludes the initial $20\\%$ and final $10\\%$ of the data points in the window to mitigate the effects of the initial capacitive spike and late-stage noise.\n\n*   **Step D: Estimate $\\tau$ and $i_0$**: From the regression results, the model parameters are estimated as:\n    $$\n    \\hat{\\tau} = -\\frac{1}{\\hat{m}} \\quad \\text{and} \\quad \\hat{i}_0 = e^{\\hat{c}}\n    $$\n\n*   **Step E: Compute Model-Based $t_{rr,\\text{model}}$**: The model-based reverse-recovery time is the duration, according to the fitted model, for the current to decay to a threshold fraction of the initial fitted current. The threshold is $i_{\\text{th,model}} = f_{\\text{th}} \\cdot \\hat{i}_0$. We solve for $t_{rr,\\text{model}} = t_{end} - t_s$:\n    $$\n    \\hat{i}_0 e^{-t_{rr,\\text{model}}/\\hat{\\tau}} = f_{\\text{th}} \\cdot \\hat{i}_0\n    $$\n    $$\n    e^{-t_{rr,\\text{model}}/\\hat{\\tau}} = f_{\\text{th}}\n    $$\n    $$\n    -\\frac{t_{rr,\\text{model}}}{\\hat{\\tau}} = \\ln(f_{\\text{th}})\n    $$\n    $$\n    t_{rr,\\text{model}} = -\\hat{\\tau} \\ln(f_{\\text{th}}) = \\hat{\\tau} \\ln\\left(\\frac{1}{f_{\\text{th}}}\\right)\n    $$\nThis completes the derivation of the full extraction procedure. The program will implement these steps for synthetic datasets.",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.000 \\times 10^{-6} & 2.302 \\times 10^{-6} \\\\ 8.000 \\times 10^{-7} & 3.912 \\times 10^{-7} \\\\ 3.954 \\times 10^{-6} & 4.605 \\times 10^{-6} \\\\ 2.000 \\times 10^{-7} & 5.990 \\times 10^{-7} \\end{pmatrix}}$$"
        }
    ]
}