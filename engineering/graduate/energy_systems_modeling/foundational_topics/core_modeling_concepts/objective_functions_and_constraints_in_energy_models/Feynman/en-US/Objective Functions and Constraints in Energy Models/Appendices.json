{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the bedrock of energy system optimization: the economic dispatch problem. You will formulate and solve a simple linear program to meet demand at minimum cost, a daily task for every system operator. The key insight you will develop is the derivation of the shadow price on the energy balance constraint, $\\lambda$, which represents the system's marginal cost of energy and is a fundamental concept in electricity market pricing .",
            "id": "4109358",
            "problem": "Consider a single-hour economic dispatch problem for an isolated power system with two thermal generators. Let the decision variables be the real-time power outputs $g_1$ and $g_2$ (in $\\mathrm{MW}$) of Generator $1$ and Generator $2$, respectively. The system operator seeks to minimize the total variable operating cost over the hour subject to a fixed demand balance and generator operating limits. Assume linear marginal costs given by the constant coefficients $c_1$ and $c_2$, respectively, and a perfectly inelastic demand $d$.\n\nFormulate the optimization problem by minimizing the linear cost function $f(g_1,g_2)$ subject to the physical constraints described below. The given data are $c_1=20$ $\\mathrm{\\$/MWh}$, $c_2=40$ $\\mathrm{\\$/MWh}$, $d=100$ $\\mathrm{MW}$, and the capacity bounds $0 \\le g_i \\le 120$ for $i \\in \\{1,2\\}$.\n\nStarting from fundamental principles of constrained optimization for convex programs, derive the necessary optimality conditions that characterize the minimizer of the cost function subject to the constraints, and use these conditions to compute the optimal dispatch $(g_1^{\\star}, g_2^{\\star})$. Let $\\lambda$ denote the Lagrange multiplier associated with the system-wide power balance constraint $g_1 + g_2 = d$; this multiplier is interpretable as the marginal value of serving an incremental $\\mathrm{MW}$ of demand in this single-node system.\n\nUsing the optimality conditions, determine the numerical value of the shadow price $\\lambda^{\\star}$ and provide it as the final answer. Express the final answer in $\\mathrm{\\$/MWh}$. No rounding is required beyond exact arithmetic.",
            "solution": "The user has provided a well-posed problem statement. All required data are present, the premises are scientifically sound, and the objective is clearly defined. The problem is a standard economic dispatch formulation, which is a classic application of constrained optimization in energy systems engineering. Therefore, a solution can be derived.\n\nThe problem is to determine the optimal power output of two generators, $g_1$ and $g_2$, to meet a fixed demand $d$ at minimum cost. The operating cost is linear with respect to the power output.\n\nFirst, we formulate the optimization problem. The objective function $f(g_1, g_2)$ to be minimized is the total hourly operating cost, which is the sum of the costs for each generator. Given constant marginal costs $c_1$ and $c_2$, the cost function is:\n$$ f(g_1, g_2) = c_1 g_1 + c_2 g_2 $$\nThis objective is subject to several constraints:\n1.  **Power Balance Constraint**: The total generation must exactly meet the demand $d$. This is an equality constraint:\n    $$ g_1 + g_2 = d $$\n2.  **Generator Capacity Constraints**: Each generator $i$ has a minimum output of $0$ $\\mathrm{MW}$ and a maximum output of $120$ $\\mathrm{MW}$. These are inequality constraints:\n    $$ 0 \\le g_1 \\le 120 $$\n    $$ 0 \\le g_2 \\le 120 $$\n\nThe full optimization problem is:\n$$ \\min_{g_1, g_2} \\quad c_1 g_1 + c_2 g_2 $$\nSubject to:\n$$ g_1 + g_2 - d = 0 $$\n$$ -g_1 \\le 0 $$\n$$ g_1 - 120 \\le 0 $$\n$$ -g_2 \\le 0 $$\n$$ g_2 - 120 \\le 0 $$\n\nThis is a linear programming problem, which is a special class of convex optimization problems. For such problems, the Karush-Kuhn-Tucker (KKT) conditions are both necessary and sufficient for optimality. We form the Lagrangian function $\\mathcal{L}$ by incorporating the constraints, weighted by their respective Lagrange multipliers. Let $\\lambda$ be the multiplier for the equality constraint, and let $\\mu_{1,min}, \\mu_{1,max}, \\mu_{2,min}, \\mu_{2,max}$ be the non-negative multipliers for the four inequality constraints.\n\n$$ \\mathcal{L}(g_1, g_2, \\lambda, \\vec{\\mu}) = c_1 g_1 + c_2 g_2 - \\lambda(g_1 + g_2 - d) + \\mu_{1,min}(-g_1) + \\mu_{1,max}(g_1 - 120) + \\mu_{2,min}(-g_2) + \\mu_{2,max}(g_2 - 120) $$\n\nThe KKT conditions for an optimal solution $(g_1^{\\star}, g_2^{\\star})$ are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the decision variables must be zero at the optimal point.\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 - \\lambda - \\mu_{1,min} + \\mu_{1,max} = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 - \\lambda - \\mu_{2,min} + \\mu_{2,max} = 0 $$\n\n2.  **Primal Feasibility**: The optimal solution must satisfy all original constraints.\n    $$ g_1^{\\star} + g_2^{\\star} = d $$\n    $$ 0 \\le g_1^{\\star} \\le 120 $$\n    $$ 0 \\le g_2^{\\star} \\le 120 $$\n\n3.  **Dual Feasibility**: The multipliers for the inequality constraints must be non-negative.\n    $$ \\mu_{1,min}, \\mu_{1,max}, \\mu_{2,min}, \\mu_{2,max} \\ge 0 $$\n\n4.  **Complementary Slackness**: The product of each inequality multiplier and its corresponding slack must be zero.\n    $$ \\mu_{1,min} g_1^{\\star} = 0 $$\n    $$ \\mu_{1,max} (g_1^{\\star} - 120) = 0 $$\n    $$ \\mu_{2,min} g_2^{\\star} = 0 $$\n    $$ \\mu_{2,max} (g_2^{\\star} - 120) = 0 $$\n\nFrom the stationarity and complementary slackness conditions, we can derive the economic dispatch logic for each generator $i \\in \\{1, 2\\}$:\nThe rearranged stationarity condition is $c_i - \\lambda = \\mu_{i,min} - \\mu_{i,max}$.\n- If generator $i$ operates strictly between its limits ($0 < g_i^{\\star} < 120$), complementary slackness implies $\\mu_{i,min}=0$ and $\\mu_{i,max}=0$. Thus, $c_i - \\lambda = 0$, or $\\lambda = c_i$. Such a generator is called a marginal unit, as its cost sets the system marginal price $\\lambda$.\n- If generator $i$ is at its lower limit ($g_i^{\\star} = 0$), then $\\mu_{i,max}=0$. The stationarity condition becomes $c_i - \\lambda = \\mu_{i,min}$. Since $\\mu_{i,min} \\ge 0$, this implies $\\lambda \\le c_i$.\n- If generator $i$ is at its upper limit ($g_i^{\\star} = 120$), then $\\mu_{i,min}=0$. The stationarity condition becomes $c_i - \\lambda = -\\mu_{i,max}$. Since $\\mu_{i,max} \\ge 0$, this implies $\\lambda \\ge c_i$.\n\nThe data provided are: $c_1 = 20$ $\\mathrm{\\$/MWh}$, $c_2 = 40$ $\\mathrm{\\$/MWh}$, $d = 100$ $\\mathrm{MW}$, and capacity bounds are $[0, 120]$ $\\mathrm{MW}$ for both generators.\n\nSince $c_1 < c_2$, Generator 1 is the cheaper unit. The principle of economic dispatch is to maximize the use of the cheapest available generator to meet demand. The demand is $d=100$ $\\mathrm{MW}$. The capacity of Generator 1 is $120$ $\\mathrm{MW}$. Since the capacity of the cheaper generator is sufficient to meet the entire demand ($120 > 100$), the optimal dispatch will use only Generator 1.\n\nThe proposed optimal dispatch is:\n$$ g_1^{\\star} = 100 \\ \\mathrm{MW} $$\n$$ g_2^{\\star} = 0 \\ \\mathrm{MW} $$\n\nWe now verify this solution using the KKT conditions and determine the value of $\\lambda^{\\star}$.\n- **Primal Feasibility**: $g_1^{\\star} + g_2^{\\star} = 100 + 0 = 100 = d$. The outputs $100$ and $0$ are within the $[0, 120]$ bounds. The solution is feasible.\n\n- **Optimality Conditions for $g_1^{\\star}$**:\nSince $0 < g_1^{\\star} = 100 < 120$, Generator 1 is a marginal unit. For this to be optimal, its marginal cost must equal the system marginal price $\\lambda^{\\star}$.\n$$ \\lambda^{\\star} = c_1 = 20 \\ \\mathrm{\\$/MWh} $$\nThis also implies from complementary slackness that $\\mu_{1,min} = 0$ and $\\mu_{1,max} = 0$.\n\n- **Optimality Conditions for $g_2^{\\star}$**:\nSince $g_2^{\\star} = 0$, Generator 2 is at its lower limit. The optimality condition for this case is $\\lambda^{\\star} \\le c_2$.\nWe have $\\lambda^{\\star} = 20$ and $c_2 = 40$. The condition $20 \\le 40$ is satisfied. This confirms that it is not economic to dispatch the more expensive generator. From the stationarity condition for $g_2$, since $g_2^{\\star}=0$, we have $\\mu_{2,max}=0$ and $c_2 - \\lambda^{\\star} = \\mu_{2,min}$. This gives $\\mu_{2,min} = 40 - 20 = 20$. Since $\\mu_{2,min} \\ge 0$, the dual feasibility condition is satisfied.\n\nAll KKT conditions are satisfied for the dispatch $(g_1^{\\star}, g_2^{\\star}) = (100, 0)$ with the shadow price $\\lambda^{\\star} = 20$. The shadow price $\\lambda^{\\star}$, also known as the system marginal price or locational marginal price in a single-node system, represents the cost to supply one additional megawatt-hour of energy. In this case, that incremental energy would be supplied by Generator 1, so the marginal cost is $c_1$.\n\nThe value of the shadow price $\\lambda^{\\star}$ is $20$ $\\mathrm{\\$/MWh}$.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "Building on the foundational dispatch model, this practice introduces a common policy instrument: a system-wide emissions cap. You will explore how adding an environmental constraint, such as $\\epsilon_1 g_1 + \\epsilon_2 g_2 \\leq \\overline{E}$, can fundamentally alter the cost-optimal dispatch by forcing a trade-off between cheaper, higher-emitting resources and more expensive, cleaner ones. This problem  demonstrates the critical role of optimization in analyzing the economic impacts of environmental regulations.",
            "id": "4109320",
            "problem": "Consider a single-hour dispatch problem for an energy system with two generation technologies, indexed by $i \\in \\{1,2\\}$. Let $g_i$ denote the energy produced by technology $i$ in megawatt-hour (MWh) over the hour. The system must meet a fixed demand of $d = 100$ megawatt (MW) that is constant over the hour, so the total energy required is $100$ MWh. The technologies have constant marginal costs $c_1 = 30$ $\\mathrm{\\$/MWh}$ and $c_2 = 50$ $\\mathrm{\\$/MWh}$, respectively. The emission factors are $\\epsilon_1 = 0.9$ $\\mathrm{tCO_2/MWh}$ and $\\epsilon_2 = 0.4$ $\\mathrm{tCO_2/MWh}$. The system is subject to an aggregate emissions cap $\\overline{E} = 45$ $\\mathrm{tCO_2}$ over the hour. Assume there are no capacity limits other than nonnegativity, so $g_1 \\geq 0$ and $g_2 \\geq 0$.\n\nFormulate and solve the cost-minimizing dispatch problem with an energy balance constraint and an emissions cap, starting from the fundamental definitions of linear cost, energy balance, and additive emissions. Derive the optimal dispatch $(g_1^{\\star}, g_2^{\\star})$ and justify that it is globally optimal for this linear system. Express each dispatch in megawatt-hour (MWh). Provide the final answer as the ordered pair $\\left(g_1^{\\star}, g_2^{\\star}\\right)$.",
            "solution": "The problem is validated as follows:\n*   **Step 1: Extract Givens**\n    *   Number of generation technologies: $2$, indexed by $i \\in \\{1,2\\}$.\n    *   Generation variables: $g_1 \\geq 0$, $g_2 \\geq 0$ in megawatt-hour (MWh).\n    *   Fixed demand: $d = 100$ megawatt (MW), constant over one hour, resulting in a total energy demand of $100$ MWh.\n    *   Marginal costs: $c_1 = 30$ $\\mathrm{\\$/MWh}$, $c_2 = 50$ $\\mathrm{\\$/MWh}$.\n    *   Emission factors: $\\epsilon_1 = 0.9$ $\\mathrm{tCO_2/MWh}$, $\\epsilon_2 = 0.4$ $\\mathrm{tCO_2/MWh}$.\n    *   Aggregate emissions cap: $\\overline{E} = 45$ $\\mathrm{tCO_2}$.\n\n*   **Step 2: Validate Using Extracted Givens**\n    *   **Scientifically Grounded:** The problem is a standard economic dispatch model subject to an environmental constraint. This is a fundamental and well-established problem in energy systems modeling, formulated as a linear program. The principles are sound.\n    *   **Well-Posed:** The problem has a linear objective function and a set of linear constraints. The constraints define a non-empty, compact, and convex feasible region. Thus, a unique, stable, and meaningful solution exists.\n    *   **Objective:** The problem is stated using precise, quantitative, and unbiased language.\n    *   The problem is self-contained, consistent, and does not violate any other validation criteria.\n\n*   **Step 3: Verdict and Action**\n    *   The problem is deemed **valid**. A full solution will be provided.\n\nThe objective is to find the generation dispatch $(g_1, g_2)$ that minimizes the total operating cost while satisfying all system constraints.\n\nFirst, we formulate the optimization problem.\n\n**Objective Function:**\nThe total cost $C$ is the sum of the costs of producing energy from each technology. Given constant marginal costs $c_1$ and $c_2$, the cost function is linear:\n$$\nC(g_1, g_2) = c_1 g_1 + c_2 g_2\n$$\nSubstituting the given values, we seek to minimize:\n$$\nC(g_1, g_2) = 30 g_1 + 50 g_2\n$$\n\n**Constraints:**\n1.  **Energy Balance Constraint:** The total energy generated must exactly meet the total energy demand. The demand over the one-hour period is $100$ MW $\\times$ $1$ h $= 100$ MWh.\n    $$\n    g_1 + g_2 = 100\n    $$\n2.  **Emissions Cap Constraint:** The total emissions produced by the two technologies must not exceed the aggregate cap $\\overline{E}$. The total emissions $E$ are a linear combination of the generation from each technology, based on their emission factors $\\epsilon_1$ and $\\epsilon_2$.\n    $$\n    \\epsilon_1 g_1 + \\epsilon_2 g_2 \\leq \\overline{E}\n    $$\n    Substituting the given values:\n    $$\n    0.9 g_1 + 0.4 g_2 \\leq 45\n    $$\n3.  **Non-negativity Constraints:** The energy produced cannot be negative.\n    $$\n    g_1 \\geq 0, \\quad g_2 \\geq 0\n    $$\n\nThe complete optimization problem is a linear program (LP):\n$$\n\\begin{aligned}\n& \\underset{g_1, g_2}{\\text{minimize}}\n& & 30 g_1 + 50 g_2 \\\\\n& \\text{subject to}\n& & g_1 + g_2 = 100 \\\\\n& & & 0.9 g_1 + 0.4 g_2 \\leq 45 \\\\\n& & & g_1 \\geq 0, \\ g_2 \\geq 0\n\\end{aligned}\n$$\n\nTo solve this two-variable LP, we can use substitution. From the energy balance constraint, we express $g_2$ in terms of $g_1$:\n$$\ng_2 = 100 - g_1\n$$\nNow, substitute this expression into the objective function and the remaining constraints to formulate a single-variable problem in $g_1$.\n\nThe objective function becomes a function of $g_1$ only:\n$$\nC(g_1) = 30 g_1 + 50 (100 - g_1) = 30 g_1 + 5000 - 50 g_1 = 5000 - 20 g_1\n$$\nMinimizing $C(g_1)$ is equivalent to maximizing $20 g_1$, which is equivalent to maximizing $g_1$.\n\nThe constraints on $g_1$ are derived as follows:\n1.  From $g_1 \\geq 0$.\n2.  From $g_2 \\geq 0$:\n    $$\n    100 - g_1 \\geq 0 \\implies g_1 \\leq 100\n    $$\n3.  From the emissions constraint:\n    $$\n    0.9 g_1 + 0.4 (100 - g_1) \\leq 45 \\\\\n    0.9 g_1 + 40 - 0.4 g_1 \\leq 45 \\\\\n    0.5 g_1 \\leq 5 \\\\\n    g_1 \\leq 10\n    $$\nCombining all constraints on $g_1$, we have $g_1 \\geq 0$ and $g_1 \\leq 10$. The feasible range for $g_1$ is the interval $[0, 10]$.\n\nWe need to find the value of $g_1$ in the interval $[0, 10]$ that minimizes the cost function $C(g_1) = 5000 - 20 g_1$. Since $C(g_1)$ is a monotonically decreasing function of $g_1$, its minimum value on the interval $[0, 10]$ will be attained at the largest possible value of $g_1$.\nTherefore, the optimal value for $g_1$ is:\n$$\ng_1^{\\star} = 10\n$$\nNow, we find the corresponding optimal value for $g_2$ using the energy balance equation:\n$$\ng_2^{\\star} = 100 - g_1^{\\star} = 100 - 10 = 90\n$$\nThe optimal dispatch is $(g_1^{\\star}, g_2^{\\star}) = (10, 90)$.\n\nThis solution is globally optimal. The problem is a linear program, meaning it involves the optimization of a linear objective function subject to linear equality and inequality constraints. The set of all feasible solutions (the feasible region) for an LP is a convex set. For such a problem, a fundamental theorem of linear programming states that if an optimal solution exists, it must occur at one of the vertices (extreme points) of the feasible region.\n\nThe feasible region here is a line segment in the $(g_1, g_2)$ plane. Its endpoints (vertices) are found by the intersection of the line $g_1 + g_2 = 100$ with the boundaries of the non-negativity and emission constraints.\nThe feasible range for $g_1$ is $[0, 10]$.\n*   At $g_1=0$, we have $g_2 = 100$. This gives the vertex $(0, 100)$.\n*   At $g_1=10$, we have $g_2 = 90$. This gives the vertex $(10, 90)$.\n\nEvaluating the cost function at these two vertices:\n*   Cost at $(0, 100)$: $C(0, 100) = 30(0) + 50(100) = 5000$.\n*   Cost at $(10, 90)$: $C(10, 90) = 30(10) + 50(90) = 300 + 4500 = 4800$.\n\nThe minimum cost is $4800$, which occurs at $(10, 90)$. Since we have evaluated the objective function at all vertices of the feasible region, this point is the global minimum. The optimal dispatch is thus $g_1^{\\star} = 10$ MWh and $g_2^{\\star} = 90$ MWh.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10 & 90\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world generators cannot change their output instantaneously. This exercise introduces dynamic operational constraints by modeling generator ramp-rate limits, such as $p_t - p_{t-1} \\leq R^{\\uparrow}\\Delta t$, which couple decisions across time. Faced with an infeasible desired trajectory, you will solve a quadratic program to find the optimal feasible path that minimizes deviation, a technique central to tracking signals in ancillary service markets and ensuring system stability .",
            "id": "4109331",
            "problem": "Consider a single thermal generating unit participating in a short-horizon dispatch over three consecutive $1$-hour periods indexed by $t \\in \\{1,2,3\\}$. Let $p_t$ denote the electrical power output in period $t$ in $\\mathrm{MW}$, and let $d_t$ denote the desired (unconstrained) output trajectory. The unit has a physical ramp-up limit $R^{\\uparrow} = 20\\,\\mathrm{MW/hour}$ and a ramp-down limit $R^{\\downarrow} = 30\\,\\mathrm{MW/hour}$. The period length is $\\Delta t = 1\\,\\mathrm{hour}$. The initial output before period $1$ is $p_0 = 0\\,\\mathrm{MW}$. There are no upper capacity limits beyond ramping, and outputs must be nonnegative. The desired outputs are given by the vector $\\mathbf{d} = [0,50,10]\\,\\mathrm{MW}$ for periods $t=1,2,3$, respectively.\n\nThe canonical ramp-rate constraints for consecutive discrete-time periods (derived from the physical limits on the time-derivative of output) are\n$$\np_t - p_{t-1} \\leq R^{\\uparrow}\\,\\Delta t \\quad \\text{and} \\quad p_{t-1} - p_t \\leq R^{\\downarrow}\\,\\Delta t \\quad \\text{for each } t \\in \\{1,2,3\\}.\n$$\nNonnegativity implies $p_t \\geq 0$ for each $t \\in \\{1,2,3\\}$.\n\nTo assess feasibility and compute necessary adjustments, define the convex optimization problem that minimizes a squared-deviation penalty from the desired outputs:\n$$\n\\min_{p_1,p_2,p_3} \\; \\sum_{t=1}^{3} (p_t - d_t)^2\n$$\nsubject to the ramp constraints above, $p_0 = 0$, and $p_t \\geq 0$ for each $t$.\n\nStarting from these definitions and constraints only, determine whether the desired trajectory $\\mathbf{d}$ is feasible. If it is infeasible, compute the unique optimal adjusted trajectory $\\mathbf{p}^{\\star}$ that minimizes the stated objective over the feasible set. Report the minimal objective value $\\sum_{t=1}^{3} (p_t^{\\star} - d_t)^2$ as a single real number. Express the final penalty value in $\\mathrm{MW}^2$. Do not round the result unless rounding is mathematically required by your derivation.",
            "solution": "The user has provided a well-defined convex optimization problem. The task is to first validate the feasibility of a desired trajectory and then, if it is infeasible, find the optimal trajectory that minimizes a quadratic penalty function subject to a set of linear constraints.\n\nFirst, we must perform a validation of the problem statement.\n\n**Step 1: Extract Givens**\n- Time periods: $t \\in \\{1,2,3\\}$\n- Power output in period $t$: $p_t$ in $\\mathrm{MW}$\n- Desired output trajectory: $\\mathbf{d} = [0,50,10]\\,\\mathrm{MW}$, so $d_1 = 0$, $d_2 = 50$, $d_3 = 10$.\n- Ramp-up limit: $R^{\\uparrow} = 20\\,\\mathrm{MW/hour}$\n- Ramp-down limit: $R^{\\downarrow} = 30\\,\\mathrm{MW/hour}$\n- Period length: $\\Delta t = 1\\,\\mathrm{hour}$\n- Initial output: $p_0 = 0\\,\\mathrm{MW}$\n- Ramp-rate constraints: $p_t - p_{t-1} \\leq R^{\\uparrow}\\,\\Delta t$ and $p_{t-1} - p_t \\leq R^{\\downarrow}\\,\\Delta t$ for $t \\in \\{1,2,3\\}$.\n- Nonnegativity constraint: $p_t \\geq 0$ for $t \\in \\{1,2,3\\}$.\n- Objective function: $\\min_{p_1,p_2,p_3} \\; \\sum_{t=1}^{3} (p_t - d_t)^2$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, representing a standard economic dispatch problem in energy systems. It is well-posed, featuring a strictly convex quadratic objective function and a set of linear constraints that define a convex, non-empty feasible set, which guarantees a unique minimum. The problem statement is objective, complete, and mathematically consistent. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n**Problem Solution**\n\nThe objective is to minimize the function $f(p_1, p_2, p_3) = (p_1 - d_1)^2 + (p_2 - d_2)^2 + (p_3 - d_3)^2$ subject to the given constraints.\nSubstituting the given values, we have:\nObjective: $\\min_{p_1, p_2, p_3} f(p_1, p_2, p_3) = (p_1 - 0)^2 + (p_2 - 50)^2 + (p_3 - 10)^2$\n\nThe constraints can be written explicitly using $p_0 = 0$, $R^{\\uparrow}\\Delta t = 20$, and $R^{\\downarrow}\\Delta t = 30$.\nFor $t=1$:\n$p_1 - p_0 \\leq 20 \\implies p_1 \\leq 20$\n$p_0 - p_1 \\leq 30 \\implies -p_1 \\leq 30$, which is superseded by $p_1 \\geq 0$.\nSo, $0 \\leq p_1 \\leq 20$.\n\nFor $t=2$:\n$p_2 - p_1 \\leq 20$\n$p_1 - p_2 \\leq 30$\n$p_2 \\geq 0$\n\nFor $t=3$:\n$p_3 - p_2 \\leq 20$\n$p_2 - p_3 \\leq 30$\n$p_3 \\geq 0$\n\n**Feasibility Check of the Desired Trajectory**\nWe check if the desired trajectory $\\mathbf{d} = [0, 50, 10]$ satisfies all constraints.\nLet $p_1 = d_1 = 0$, $p_2 = d_2 = 50$, $p_3 = d_3 = 10$.\n- Constraint $p_1 \\leq 20$: $0 \\leq 20$. (Satisfied)\n- Constraint $p_2 - p_1 \\leq 20$: $50 - 0 = 50 \\leq 20$. (Violated)\n- Constraint $p_2 - p_3 \\leq 30$: $50 - 10 = 40 \\leq 30$. (Violated)\nSince at least one constraint is violated, the desired trajectory $\\mathbf{d}$ is infeasible.\n\n**Finding the Optimal Trajectory**\nWe must find the vector $\\mathbf{p}^{\\star} = [p_1^{\\star}, p_2^{\\star}, p_3^{\\star}]$ in the feasible set that is closest to $\\mathbf{d}$ in the Euclidean distance sense. This is a quadratic programming problem. We use the Karush-Kuhn-Tucker (KKT) conditions to find the solution.\n\nThe Lagrangian $L$ for this problem is:\n$$L(\\mathbf{p}, \\boldsymbol{\\lambda}) = \\sum_{t=1}^{3} (p_t - d_t)^2 + \\sum_{i=1}^{8} \\lambda_i g_i(\\mathbf{p})$$\nwhere $g_i(\\mathbf{p}) \\leq 0$ represent the eight inequality constraints:\n$g_1: p_1 - 20 \\leq 0$\n$g_2: -p_1 \\leq 0$\n$g_3: p_2 - p_1 - 20 \\leq 0$\n$g_4: p_1 - p_2 - 30 \\leq 0$\n$g_5: p_3 - p_2 - 20 \\leq 0$\n$g_6: p_2 - p_3 - 30 \\leq 0$\n$g_7: -p_2 \\leq 0$\n$g_8: -p_3 \\leq 0$\n\nThe stationarity conditions ($\\nabla_{\\mathbf{p}} L = 0$) are:\n1. $\\frac{\\partial L}{\\partial p_1} = 2(p_1 - d_1) + \\lambda_1 - \\lambda_2 - \\lambda_3 + \\lambda_4 = 2p_1 + \\lambda_1 - \\lambda_2 - \\lambda_3 + \\lambda_4 = 0$\n2. $\\frac{\\partial L}{\\partial p_2} = 2(p_2 - d_2) + \\lambda_3 - \\lambda_4 - \\lambda_5 + \\lambda_6 - \\lambda_7 = 2(p_2-50) + \\lambda_3 - \\lambda_4 - \\lambda_5 + \\lambda_6 - \\lambda_7 = 0$\n3. $\\frac{\\partial L}{\\partial p_3} = 2(p_3 - d_3) + \\lambda_5 - \\lambda_6 - \\lambda_8 = 2(p_3-10) + \\lambda_5 - \\lambda_6 - \\lambda_8 = 0$\n\nThe desired trajectory violates the ramp-up from $t=1$ to $t=2$ most severely ($d_2-d_1 = 50$, limit is $20$). It is highly probable that this constraint will be active at the optimum, i.e., $g_3 = 0$. Let us hypothesize that this is the only active constraint, meaning all other constraints are strictly satisfied ($g_i < 0$ for $i \\neq 3$) and their corresponding multipliers are zero ($\\lambda_i = 0$ for $i \\neq 3$).\n\nUnder this hypothesis:\n- Active constraint: $p_2 - p_1 - 20 = 0 \\implies p_2 = p_1 + 20$.\n- Multipliers: $\\lambda_1 = \\lambda_2 = \\lambda_4 = \\lambda_5 = \\lambda_6 = \\lambda_7 = \\lambda_8 = 0$.\n\nThe stationarity conditions simplify to:\n1. $2p_1 - \\lambda_3 = 0$\n2. $2(p_2 - 50) + \\lambda_3 = 0$\n3. $2(p_3 - 10) = 0$\n\nFrom condition (3), we find $p_3 = 10$.\nFrom condition (1), $\\lambda_3 = 2p_1$.\nSubstitute this into condition (2): $2(p_2 - 50) + 2p_1 = 0 \\implies p_2 - 50 + p_1 = 0 \\implies p_1 + p_2 = 50$.\nNow we have a system of two linear equations for $p_1$ and $p_2$:\n- $p_2 = p_1 + 20$\n- $p_1 + p_2 = 50$\n\nSubstitute the first into the second:\n$p_1 + (p_1 + 20) = 50$\n$2p_1 = 30$\n$p_1^{\\star} = 15$\n\nThen, $p_2^{\\star} = p_1^{\\star} + 20 = 15 + 20 = 35$.\nSo, our candidate optimal trajectory is $\\mathbf{p}^{\\star} = [15, 35, 10]$.\n\nWe must verify this solution.\nFirst, check if all constraints are satisfied for $\\mathbf{p}^{\\star} = [15, 35, 10]$:\n- $0 \\leq p_1^{\\star} \\leq 20 \\implies 0 \\leq 15 \\leq 20$. (Satisfied, inactive)\n- $p_2^{\\star} - p_1^{\\star} \\leq 20 \\implies 35 - 15 = 20 \\leq 20$. (Satisfied, active as assumed)\n- $p_1^{\\star} - p_2^{\\star} \\leq 30 \\implies 15 - 35 = -20 \\leq 30$. (Satisfied, inactive)\n- $p_3^{\\star} - p_2^{\\star} \\leq 20 \\implies 10 - 35 = -25 \\leq 20$. (Satisfied, inactive)\n- $p_2^{\\star} - p_3^{\\star} \\leq 30 \\implies 35 - 10 = 25 \\leq 30$. (Satisfied, inactive)\n- $p_2^{\\star} \\geq 0 \\implies 35 \\geq 0$. (Satisfied, inactive)\n- $p_3^{\\star} \\geq 0 \\implies 10 \\geq 0$. (Satisfied, inactive)\nThe trajectory is feasible.\n\nSecond, check the KKT conditions. We need $\\lambda_3 \\geq 0$.\n$\\lambda_3 = 2p_1^{\\star} = 2(15) = 30$.\nSince $\\lambda_3 = 30 > 0$ and all other multipliers are $0$, the KKT conditions (primal feasibility, dual feasibility, and complementary slackness) are all satisfied. Thus, $\\mathbf{p}^{\\star} = [15, 35, 10]$ is the unique optimal solution.\n\n**Calculate the Minimal Objective Value**\nThe final step is to calculate the value of the objective function for the optimal trajectory $\\mathbf{p}^{\\star} = [15, 35, 10]$ and the desired trajectory $\\mathbf{d} = [0, 50, 10]$.\n\nMinimal penalty = $\\sum_{t=1}^{3} (p_t^{\\star} - d_t)^2$\n$= (p_1^{\\star} - d_1)^2 + (p_2^{\\star} - d_2)^2 + (p_3^{\\star} - d_3)^2$\n$= (15 - 0)^2 + (35 - 50)^2 + (10 - 10)^2$\n$= (15)^2 + (-15)^2 + (0)^2$\n$= 225 + 225 + 0$\n$= 450$\n\nThe minimal objective value is $450\\,\\mathrm{MW}^2$.",
            "answer": "$$\\boxed{450}$$"
        }
    ]
}