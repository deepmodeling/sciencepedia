{
    "hands_on_practices": [
        {
            "introduction": "这个练习将引导你解决一个典型的经济调度问题。你的任务是学习如何在满足系统需求和发电机组运行限制（包括最小出力）的前提下，以最低成本分配不同机组的发电量。这是理解电力市场运行和优化资源配置的基础。",
            "id": "4109339",
            "problem": "考虑一个双机组发电系统的单时段经济调度问题。每个发电机组 $i \\in \\{1,2\\}$ 产生功率 $g_i$（单位为兆瓦，MW），并受最小运行水平 $\\underline{G}_i$ 和最大运行水平 $\\overline{G}_i$ 的限制。系统必须精确满足一个固定的需求 $d$（单位为MW）。可变运行成本与输出呈线性关系，机组1的边际成本为$10$，机组2的边际成本为$30$。假设没有启动成本、没有最小运行时间限制、没有爬坡限制，并且输出可完美分割。\n\n使用的基本原理：经济调度的定义，即在满足功率平衡和机组运行限制的条件下，最小化总可变发电成本；线性规划的凸性；以及凸优化的最优性条件，特别是 Karush–Kuhn–Tucker (KKT) 条件。\n\n使用参数 $\\overline{G}_1 = 50$ MW, $\\overline{G}_2 = 100$ MW, $\\underline{G}_1 = 20$ MW, $\\underline{G}_2 = 0$ MW, 以及 $d = 80$ MW，将调度问题表述为在满足需求平衡和运行边界条件下最小化总可变成本。然后，从第一性原理出发，推导最优调度 $\\left(g_1^{\\star}, g_2^{\\star}\\right)$。以兆瓦（MW）为单位表示最终的调度值。提供精确值，无需四舍五入。",
            "solution": "问题陈述被评估为有效。这是一个在能源系统建模领域中提法得当、自成体系且有科学依据的问题，具体来说是经济调度的线性规划表述。所有必要的数据都已提供，没有内部矛盾或歧义。\n\n问题是找到两个发电机组的最优发电水平 $(g_1^{\\star}, g_2^{\\star})$，以在满足给定需求和运行限制的同时，最小化总运行成本。\n\n决策变量是两个机组的功率输出 $g_1$ 和 $g_2$，单位为兆瓦（MW）。\n\n目标是最小化总可变成本 $C$。成本函数是线性的，边际成本为 $c_1 = 10$ 和 $c_2 = 30$。因此总成本为：\n$$\nC(g_1, g_2) = c_1 g_1 + c_2 g_2 = 10g_1 + 30g_2\n$$\n\n该优化受以下几个约束条件的限制：\n1.  **功率平衡约束**：总发电量必须精确满足系统需求 $d = 80$ MW。\n    $$\n    g_1 + g_2 = 80\n    $$\n2.  **机组1的发电限制**：机组1的输出必须在其最小和最大运行水平 $\\underline{G}_1 = 20$ MW 和 $\\overline{G}_1 = 50$ MW 之间。\n    $$\n    20 \\le g_1 \\le 50\n    $$\n3.  **机组2的发电限制**：机组2的输出必须在其最小和最大运行水平 $\\underline{G}_2 = 0$ MW 和 $\\overline{G}_2 = 100$ MW 之间。\n    $$\n    0 \\le g_2 \\le 100\n    $$\n\n该问题可以正式表述为以下线性规划：\n$$\n\\begin{aligned}\n \\underset{g_1, g_2}{\\text{minimize}}\n  10g_1 + 30g_2 \\\\\n \\text{subject to}\n  g_1 + g_2 = 80 \\\\\n   20 \\le g_1 \\le 50 \\\\\n   0 \\le g_2 \\le 100\n\\end{aligned}\n$$\n\n这个问题可以利用“优先顺序调度法”（merit-order dispatch）的概念从第一性原理出发来解决。该原则规定，为最小化成本，应在调度次便宜的发电机之前，尽可能充分地使用边际成本最低的发电机。\n\n边际成本为 $c_1 = 10$ 和 $c_2 = 30$。由于 $c_1  c_2$，机组1是较便宜的（或“优先”）机组，而机组2是较昂贵的机组。\n\n解决策略如下：\n1.  调度最便宜的机组，即机组1，在遵守其运行限制的前提下，尽可能多地满足需求。\n2.  调度较昂贵的机组，即机组2，在遵守其自身运行限制的前提下，满足剩余的需求。\n\n让我们将此策略应用于需求 $d = 80$ MW。\n首先，我们尝试仅使用机组1来满足需求。机组1的最大容量为 $\\overline{G}_1 = 50$ MW。由于需求 $d=80$ MW 大于 $\\overline{G}_1$，我们必须以机组1的最大输出进行调度。\n$$\ng_1^{\\star} = \\overline{G}_1 = 50 \\text{ MW}\n$$\n对于机组1，此调度是可行的，因为它在其 $[20, 50]$ 的边界内。\n\n需要由机组2满足的剩余需求是：\n$$\nd_{\\text{rem}} = d - g_1^{\\star} = 80 - 50 = 30 \\text{ MW}\n$$\n因此，机组2的调度必须为：\n$$\ng_2^{\\star} = 30 \\text{ MW}\n$$\n我们必须验证此调度对机组2是否可行。机组2的运行限制为 $[0, 100]$ MW。由于 $0 \\le 30 \\le 100$，调度 $g_2^{\\star} = 30$ MW 是可行的。\n\n最后，我们检查功率平衡是否满足：\n$$\ng_1^{\\star} + g_2^{\\star} = 50 + 30 = 80 \\text{ MW}\n$$\n这与系统需求 $d$ 相匹配。\n\n因此，最优调度为 $(g_1^{\\star}, g_2^{\\star}) = (50, 30)$。在此调度下，较便宜的机组达到最大出力，而较昂贵的机组则覆盖剩余的负荷。任何其他可行的调度方案都将涉及减少较便宜机组的输出（$g_1  50$）并增加较昂贵机组的输出（$g_2 > 30$）以维持功率平衡，但这将严格增加总成本。例如，调度方案 $(g_1, g_2) = (49, 31)$ 是可行的，但成本更高：$10(49) + 30(31) > 10(50) + 30(30)$。\n\n这一结论得到了该凸优化问题的 Karush–Kuhn–Tucker (KKT) 条件的证实。拉格朗日函数为：\n$L = 10g_1 + 30g_2 + \\lambda(g_1 + g_2 - 80) + \\mu_{1,min}(20 - g_1) + \\mu_{1,max}(g_1 - 50) + \\mu_{2,min}(-g_2) + \\mu_{2,max}(g_2 - 100)$.\n平稳性条件为 $\\frac{\\partial L}{\\partial g_1} = 10 + \\lambda - \\mu_{1,min} + \\mu_{1,max} = 0$ 和 $\\frac{\\partial L}{\\partial g_2} = 30 + \\lambda - \\mu_{2,min} + \\mu_{2,max} = 0$。\n对于解 $(g_1, g_2)=(50, 30)$，活动约束是 $g_1 - 50 = 0$，而所有其他不等式约束都是非活动的。根据互补松弛性，$\\mu_{1,min} = \\mu_{2,min} = \\mu_{2,max} = 0$。平稳性条件变为：\n$10 + \\lambda + \\mu_{1,max} = 0$\n$30 + \\lambda = 0 \\implies \\lambda = -30$\n将 $\\lambda = -30$ 代入第一个方程得到 $10 - 30 + \\mu_{1,max} = 0 \\implies \\mu_{1,max} = 20$。\n由于所有不等式约束的拉格朗日乘子（$\\mu$）都是非负的（$\\mu_{1,max}=20 \\ge 0$），因此满足最小值的 KKT 条件。系统的边际电能成本由 $-\\lambda = 30$ 给出，这是边际机组（机组2）的成本。\n\n因此，最优调度为 $g_1^{\\star} = 50$ MW 和 $g_2^{\\star} = 30$ MW。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n50  30\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现代能源系统需要在经济效率和环境目标之间取得平衡。这个练习在经济调度的基础上增加了一个总排放量上限，迫使模型在低成本高排放和高成本清洁能源之间进行权衡。通过这个实践，你将理解政策性约束如何重塑最优调度决策。",
            "id": "4109320",
            "problem": "考虑一个能源系统的单小时调度问题，该系统有两种发电技术，由 $i \\in \\{1,2\\}$ 索引。令 $g_i$ 表示技术 $i$ 在一小时内产生的能量，单位为兆瓦时 (MWh)。该系统必须满足一小时内恒定的 $d = 100$ 兆瓦 (MW) 的固定需求，因此所需的总能量为 $100$ MWh。这些技术具有恒定的边际成本，分别为 $c_1 = 30$ 美元/兆瓦时 ($\\$/\\text{MWh}$) 和 $c_2 = 50$ 美元/兆瓦时 ($\\$/\\text{MWh}$)。排放因子分别为 $\\epsilon_1 = 0.9$ 吨二氧化碳/兆瓦时 ($\\text{t CO}_2/\\text{MWh}$) 和 $\\epsilon_2 = 0.4$ 吨二氧化碳/兆瓦时 ($\\text{t CO}_2/\\text{MWh}$)。该系统在一小时内受到总排放上限 $\\overline{E} = 45$ 吨二氧化碳 ($\\text{t CO}_2$) 的限制。假设除了非负性约束外没有容量限制，因此 $g_1 \\geq 0$ 且 $g_2 \\geq 0$。\n\n从线性成本、能量平衡和可加性排放的基本定义出发，建立并求解带有能量平衡约束和排放上限的成本最小化调度问题。推导最优调度 $(g_1^{\\star}, g_2^{\\star})$ 并证明其对于此线性系统是全局最优的。将每个调度量以兆瓦时 (MWh) 表示。以有序对 $\\left(g_1^{\\star}, g_2^{\\star}\\right)$ 的形式给出最终答案。",
            "solution": "该问题按如下方式进行验证：\n*   **步骤 1：提取已知条件**\n    *   发电技术数量：$2$ 种，由 $i \\in \\{1,2\\}$ 索引。\n    *   发电变量：$g_1 \\geq 0$，$g_2 \\geq 0$，单位为兆瓦时 (MWh)。\n    *   固定需求：$d = 100$ 兆瓦 (MW)，在一小时内恒定，因此总能量需求为 $100$ MWh。\n    *   边际成本：$c_1 = 30$ 美元/MWh，$c_2 = 50$ 美元/MWh。\n    *   排放因子：$\\epsilon_1 = 0.9$ 吨 CO$_2$/MWh，$\\epsilon_2 = 0.4$ 吨 CO$_2$/MWh。\n    *   总排放上限：$\\overline{E} = 45$ 吨 CO$_2$。\n\n*   **步骤 2：使用提取的已知条件进行验证**\n    *   **科学依据：** 该问题是一个受环境约束的标准经济调度模型。这是能源系统建模中一个基本且成熟的问题，被构建为一个线性规划。其原理是合理的。\n    *   **适定性：** 该问题具有一个线性目标函数和一组线性约束。这些约束定义了一个非空、紧凑且凸的可行域。因此，存在一个唯一、稳定且有意义的解。\n    *   **客观性：** 该问题使用精确、定量和无偏见的语言进行陈述。\n    *   该问题是自洽的、一致的，并且不违反任何其他验证标准。\n\n*   **步骤 3：结论与行动**\n    *   该问题被判定为 **有效**。将提供完整解答。\n\n目标是找到能最小化总运营成本同时满足所有系统约束的发电调度 $(g_1, g_2)$。\n\n首先，我们构建优化问题。\n\n**目标函数：**\n总成本 $C$ 是每种技术生产能量的成本之和。给定恒定的边际成本 $c_1$ 和 $c_2$，成本函数是线性的：\n$$\nC(g_1, g_2) = c_1 g_1 + c_2 g_2\n$$\n代入给定值，我们寻求最小化：\n$$\nC(g_1, g_2) = 30 g_1 + 50 g_2\n$$\n\n**约束条件：**\n1.  **能量平衡约束：** 总发电量必须恰好满足总能量需求。一小时内的需求为 $100$ MW $\\times$ $1$ h $= 100$ MWh。\n    $$\n    g_1 + g_2 = 100\n    $$\n2.  **排放上限约束：** 两种技术产生的总排放量不得超过总上限 $\\overline{E}$。总排放量 $E$ 是基于各自排放因子 $\\epsilon_1$ 和 $\\epsilon_2$ 的每种技术发电量的线性组合。\n    $$\n    \\epsilon_1 g_1 + \\epsilon_2 g_2 \\leq \\overline{E}\n    $$\n    代入给定值：\n    $$\n    0.9 g_1 + 0.4 g_2 \\leq 45\n    $$\n3.  **非负性约束：** 生产的能量不能为负。\n    $$\n    g_1 \\geq 0, \\quad g_2 \\geq 0\n    $$\n\n完整的优化问题是一个线性规划 (LP) 问题：\n$$\n\\begin{aligned}\n \\underset{g_1, g_2}{\\text{minimize}}\n  30 g_1 + 50 g_2 \\\\\n \\text{subject to}\n  g_1 + g_2 = 100 \\\\\n   0.9 g_1 + 0.4 g_2 \\leq 45 \\\\\n   g_1 \\geq 0, \\ g_2 \\geq 0\n\\end{aligned}\n$$\n\n为了求解这个双变量线性规划问题，我们可以使用代入法。根据能量平衡约束，我们将 $g_2$ 表示为 $g_1$ 的函数：\n$$\ng_2 = 100 - g_1\n$$\n现在，将此表达式代入目标函数和其余约束中，以构建一个关于 $g_1$ 的单变量问题。\n\n目标函数变为仅关于 $g_1$ 的函数：\n$$\nC(g_1) = 30 g_1 + 50 (100 - g_1) = 30 g_1 + 5000 - 50 g_1 = 5000 - 20 g_1\n$$\n最小化 $C(g_1)$ 等价于最大化 $20 g_1$，这又等价于最大化 $g_1$。\n\n对 $g_1$ 的约束推导如下：\n1.  来自 $g_1 \\geq 0$。\n2.  来自 $g_2 \\geq 0$：\n    $$\n    100 - g_1 \\geq 0 \\implies g_1 \\leq 100\n    $$\n3.  来自排放约束：\n    $$\n    0.9 g_1 + 0.4 (100 - g_1) \\leq 45 \\\\\n    0.9 g_1 + 40 - 0.4 g_1 \\leq 45 \\\\\n    0.5 g_1 \\leq 5 \\\\\n    g_1 \\leq 10\n    $$\n结合所有对 $g_1$ 的约束，我们得到 $g_1 \\geq 0$ 且 $g_1 \\leq 10$。$g_1$ 的可行范围是区间 $[0, 10]$。\n\n我们需要在区间 $[0, 10]$ 内找到使成本函数 $C(g_1) = 5000 - 20 g_1$ 最小化的 $g_1$ 值。由于 $C(g_1)$ 是 $g_1$ 的单调递减函数，其在区间 $[0, 10]$ 上的最小值将在 $g_1$ 取可能的最大值时达到。\n因此，$g_1$ 的最优值是：\n$$\ng_1^{\\star} = 10\n$$\n现在，我们使用能量平衡方程找到对应的 $g_2$ 的最优值：\n$$\ng_2^{\\star} = 100 - g_1^{\\star} = 100 - 10 = 90\n$$\n最优调度为 $(g_1^{\\star}, g_2^{\\star}) = (10, 90)$。\n\n该解是全局最优解。此问题是一个线性规划问题，意味着它涉及在一个线性等式和不等式约束下对一个线性目标函数进行优化。线性规划的所有可行解的集合（可行域）是一个凸集。对于此类问题，线性规划的一个基本定理指出，如果存在最优解，它必定出现在可行域的一个顶点（极点）上。\n\n此处的的可行域是 $(g_1, g_2)$ 平面中的一条线段。其端点（顶点）由直线 $g_1 + g_2 = 100$ 与非负性约束和排放约束的边界相交得到。\n$g_1$ 的可行范围是 $[0, 10]$。\n*   当 $g_1=0$ 时，我们有 $g_2 = 100$。这给出了顶点 $(0, 100)$。\n*   当 $g_1=10$ 时，我们有 $g_2 = 90$。这给出了顶点 $(10, 90)$。\n\n在这两个顶点上评估成本函数：\n*   在 $(0, 100)$ 处的成本：$C(0, 100) = 30(0) + 50(100) = 5000$。\n*   在 $(10, 90)$ 处的成本：$C(10, 90) = 30(10) + 50(90) = 300 + 4500 = 4800$。\n\n最小成本为 $4800$，出现在 $(10, 90)$。由于我们已经评估了可行域所有顶点的目标函数值，因此该点是全局最小值。因此，最优调度为 $g_1^{\\star} = 10$ MWh 和 $g_2^{\\star} = 90$ MWh。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10  90\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现实世界中的发电机组在改变其输出功率时会受到物理限制。这个练习引入了爬坡率约束，将静态问题转化为一个动态优化问题。你将学习如何在一个多时段的框架内，找到一个既满足需求又符合爬坡限制的最优发电计划，这是确保电网稳定运行的关键。",
            "id": "4109331",
            "problem": "考虑一个火力发电机组参与一个短期调度，该调度涵盖三个连续的 $1$ 小时时段，索引为 $t \\in \\{1,2,3\\}$。令 $p_t$ 表示时段 $t$ 的发电功率，单位为 $\\mathrm{MW}$，令 $d_t$ 表示期望的（无约束的）出力轨迹。该机组的物理爬坡速率限制为 $R^{\\uparrow} = 20\\,\\mathrm{MW/hour}$，滑坡速率限制为 $R^{\\downarrow} = 30\\,\\mathrm{MW/hour}$。时段长度为 $\\Delta t = 1\\,\\mathrm{hour}$。时段 $1$ 之前的初始出力为 $p_0 = 0\\,\\mathrm{MW}$。除了爬坡限制外，没有容量上限，且出力必须为非负值。时段 $t=1,2,3$ 的期望出力由向量 $\\mathbf{d} = [0,50,10]\\,\\mathrm{MW}$ 给出。\n\n连续离散时段的典型变负荷速率约束（源于对出力时间导数的物理限制）为\n$$\np_t - p_{t-1} \\leq R^{\\uparrow}\\,\\Delta t \\quad \\text{与} \\quad p_{t-1} - p_t \\leq R^{\\downarrow}\\,\\Delta t \\quad \\text{对每个 } t \\in \\{1,2,3\\}.\n$$\n非负性要求对每个 $t \\in \\{1,2,3\\}$，都有 $p_t \\geq 0$。\n\n为评估可行性并计算必要的调整，定义以下凸优化问题，该问题旨在最小化与期望出力之间的平方偏差惩罚：\n$$\n\\min_{p_1,p_2,p_3} \\; \\sum_{t=1}^{3} (p_t - d_t)^2\n$$\n约束条件为上述变负荷速率约束、$p_0 = 0$ 以及对每个 $t$ 都有 $p_t \\geq 0$。\n\n仅从这些定义和约束出发，判断期望轨迹 $\\mathbf{d}$ 是否可行。如果不可行，计算在可行集上最小化所述目标函数的唯一最优调整轨迹 $\\mathbf{p}^{\\star}$。将最小目标值 $\\sum_{t=1}^{3} (p_t^{\\star} - d_t)^2$ 作为单个实数报告。最终惩罚值以 $\\mathrm{MW}^2$ 为单位表示。除非您的推导在数学上需要四舍五入，否则不要对结果进行四舍五入。",
            "solution": "用户提供了一个定义明确的凸优化问题。任务是首先验证期望轨迹的可行性，如果不可行，则找到在满足一系列线性约束的条件下最小化二次惩罚函数的最优轨迹。\n\n首先，我们必须对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 时间周期：$t \\in \\{1,2,3\\}$\n- 时段 $t$ 的发电功率：$p_t$，单位 $\\mathrm{MW}$\n- 期望出力轨迹：$\\mathbf{d} = [0,50,10]\\,\\mathrm{MW}$，所以 $d_1 = 0$，$d_2 = 50$，$d_3 = 10$。\n- 爬坡速率限制：$R^{\\uparrow} = 20\\,\\mathrm{MW/hour}$\n- 滑坡速率限制：$R^{\\downarrow} = 30\\,\\mathrm{MW/hour}$\n- 时段长度：$\\Delta t = 1\\,\\mathrm{hour}$\n- 初始出力：$p_0 = 0\\,\\mathrm{MW}$\n- 变负荷速率约束：$p_t - p_{t-1} \\leq R^{\\uparrow}\\,\\Delta t$ 且 $p_{t-1} - p_t \\leq R^{\\downarrow}\\,\\Delta t$，对于 $t \\in \\{1,2,3\\}$。\n- 非负性约束：$p_t \\geq 0$，对于 $t \\in \\{1,2,3\\}$。\n- 目标函数：$\\min_{p_1,p_2,p_3} \\; \\sum_{t=1}^{3} (p_t - d_t)^2$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了能源系统中的一个标准经济调度问题。它是一个良构问题，具有严格凸的二次目标函数和一系列定义了一个凸的、非空可行集的线性约束，这保证了唯一最小值的存在。问题陈述客观、完整且数学上一致。未发现任何缺陷。\n\n**第3步：结论与行动**\n问题有效。将提供解答。\n\n**问题解答**\n\n目标是在给定约束条件下，最小化函数 $f(p_1, p_2, p_3) = (p_1 - d_1)^2 + (p_2 - d_2)^2 + (p_3 - d_3)^2$。\n代入给定值，我们得到：\n目标函数：$\\min_{p_1, p_2, p_3} f(p_1, p_2, p_3) = (p_1 - 0)^2 + (p_2 - 50)^2 + (p_3 - 10)^2$\n\n使用 $p_0 = 0$、$R^{\\uparrow}\\Delta t = 20$ 和 $R^{\\downarrow}\\Delta t = 30$ 可以明确写出约束条件。\n对于 $t=1$：\n$p_1 - p_0 \\leq 20 \\implies p_1 \\leq 20$\n$p_0 - p_1 \\leq 30 \\implies -p_1 \\leq 30$，该约束被 $p_1 \\geq 0$ 所取代。\n所以，$0 \\leq p_1 \\leq 20$。\n\n对于 $t=2$：\n$p_2 - p_1 \\leq 20$\n$p_1 - p_2 \\leq 30$\n$p_2 \\geq 0$\n\n对于 $t=3$：\n$p_3 - p_2 \\leq 20$\n$p_2 - p_3 \\leq 30$\n$p_3 \\geq 0$\n\n**期望轨迹的可行性检查**\n我们检查期望轨迹 $\\mathbf{d} = [0, 50, 10]$ 是否满足所有约束。\n令 $p_1 = d_1 = 0$，$p_2 = d_2 = 50$，$p_3 = d_3 = 10$。\n- 约束 $p_1 \\leq 20$：$0 \\leq 20$。（满足）\n- 约束 $p_2 - p_1 \\leq 20$：$50 - 0 = 50 \\leq 20$。（违反）\n- 约束 $p_2 - p_3 \\leq 30$：$50 - 10 = 40 \\leq 30$。（违反）\n由于至少有一个约束被违反，期望轨迹 $\\mathbf{d}$ 是不可行的。\n\n**寻找最优轨迹**\n我们必须在可行集中找到一个向量 $\\mathbf{p}^{\\star} = [p_1^{\\star}, p_2^{\\star}, p_3^{\\star}]$，它在欧几里得距离意义上最接近 $\\mathbf{d}$。这是一个二次规划问题。我们使用 Karush-Kuhn-Tucker (KKT) 条件来找到解。\n\n该问题的拉格朗日函数 $L$ 为：\n$$L(\\mathbf{p}, \\boldsymbol{\\lambda}) = \\sum_{t=1}^{3} (p_t - d_t)^2 + \\sum_{i=1}^{8} \\lambda_i g_i(\\mathbf{p})$$\n其中 $g_i(\\mathbf{p}) \\leq 0$ 代表八个不等式约束：\n$g_1: p_1 - 20 \\leq 0$\n$g_2: -p_1 \\leq 0$\n$g_3: p_2 - p_1 - 20 \\leq 0$\n$g_4: p_1 - p_2 - 30 \\leq 0$\n$g_5: p_3 - p_2 - 20 \\leq 0$\n$g_6: p_2 - p_3 - 30 \\leq 0$\n$g_7: -p_2 \\leq 0$\n$g_8: -p_3 \\leq 0$\n\n平稳性条件（$\\nabla_{\\mathbf{p}} L = 0$）为：\n1. $\\frac{\\partial L}{\\partial p_1} = 2(p_1 - d_1) + \\lambda_1 - \\lambda_2 - \\lambda_3 + \\lambda_4 = 2p_1 + \\lambda_1 - \\lambda_2 - \\lambda_3 + \\lambda_4 = 0$\n2. $\\frac{\\partial L}{\\partial p_2} = 2(p_2 - d_2) + \\lambda_3 - \\lambda_4 - \\lambda_5 + \\lambda_6 - \\lambda_7 = 2(p_2-50) + \\lambda_3 - \\lambda_4 - \\lambda_5 + \\lambda_6 - \\lambda_7 = 0$\n3. $\\frac{\\partial L}{\\partial p_3} = 2(p_3 - d_3) + \\lambda_5 - \\lambda_6 - \\lambda_8 = 2(p_3-10) + \\lambda_5 - \\lambda_6 - \\lambda_8 = 0$\n\n期望轨迹从 $t=1$ 到 $t=2$ 的爬坡速率被最严重地违反了（$d_2-d_1 = 50$，限制为 $20$）。极有可能这个约束在最优点处是激活的，即 $g_3 = 0$。我们假设这是唯一激活的约束，意味着所有其他约束都被严格满足（对于 $i \\neq 3$ 有 $g_i  0$），且它们对应的乘子为零（对于 $i \\neq 3$ 有 $\\lambda_i = 0$）。\n\n在此假设下：\n- 激活约束：$p_2 - p_1 - 20 = 0 \\implies p_2 = p_1 + 20$。\n- 乘子：$\\lambda_1 = \\lambda_2 = \\lambda_4 = \\lambda_5 = \\lambda_6 = \\lambda_7 = \\lambda_8 = 0$。\n\n平稳性条件简化为：\n1. $2p_1 - \\lambda_3 = 0$\n2. $2(p_2 - 50) + \\lambda_3 = 0$\n3. $2(p_3 - 10) = 0$\n\n从条件(3)，我们得到 $p_3 = 10$。\n从条件(1)，$\\lambda_3 = 2p_1$。\n将此代入条件(2)：$2(p_2 - 50) + 2p_1 = 0 \\implies p_2 - 50 + p_1 = 0 \\implies p_1 + p_2 = 50$。\n现在我们有一个关于 $p_1$ 和 $p_2$ 的二元一次方程组：\n- $p_2 = p_1 + 20$\n- $p_1 + p_2 = 50$\n\n将第一个方程代入第二个方程：\n$p_1 + (p_1 + 20) = 50$\n$2p_1 = 30$\n$p_1^{\\star} = 15$\n\n那么，$p_2^{\\star} = p_1^{\\star} + 20 = 15 + 20 = 35$。\n所以，我们的候选最优轨迹是 $\\mathbf{p}^{\\star} = [15, 35, 10]$。\n\n我们必须验证这个解。\n首先，检查 $\\mathbf{p}^{\\star} = [15, 35, 10]$ 是否满足所有约束：\n- $0 \\leq p_1^{\\star} \\leq 20 \\implies 0 \\leq 15 \\leq 20$。（满足，未激活）\n- $p_2^{\\star} - p_1^{\\star} \\leq 20 \\implies 35 - 15 = 20 \\leq 20$。（满足，按假设激活）\n- $p_1^{\\star} - p_2^{\\star} \\leq 30 \\implies 15 - 35 = -20 \\leq 30$。（满足，未激活）\n- $p_3^{\\star} - p_2^{\\star} \\leq 20 \\implies 10 - 35 = -25 \\leq 20$。（满足，未激活）\n- $p_2^{\\star} - p_3^{\\star} \\leq 30 \\implies 35 - 10 = 25 \\leq 30$。（满足，未激活）\n- $p_2^{\\star} \\geq 0 \\implies 35 \\geq 0$。（满足，未激活）\n- $p_3^{\\star} \\geq 0 \\implies 10 \\geq 0$。（满足，未激活）\n该轨迹是可行的。\n\n其次，检查 KKT 条件。我们需要 $\\lambda_3 \\geq 0$。\n$\\lambda_3 = 2p_1^{\\star} = 2(15) = 30$。\n由于 $\\lambda_3 = 30 > 0$ 且所有其他乘子均为 $0$，KKT 条件（原始可行性、对偶可行性以及互补松弛性）均得到满足。因此，$\\mathbf{p}^{\\star} = [15, 35, 10]$ 是唯一最优解。\n\n**计算最小目标值**\n最后一步是计算最优轨迹 $\\mathbf{p}^{\\star} = [15, 35, 10]$ 和期望轨迹 $\\mathbf{d} = [0, 50, 10]$ 下的目标函数值。\n\n最小惩罚值 = $\\sum_{t=1}^{3} (p_t^{\\star} - d_t)^2$\n$= (p_1^{\\star} - d_1)^2 + (p_2^{\\star} - d_2)^2 + (p_3^{\\star} - d_3)^2$\n$= (15 - 0)^2 + (35 - 50)^2 + (10 - 10)^2$\n$= (15)^2 + (-15)^2 + (0)^2$\n$= 225 + 225 + 0$\n$= 450$\n\n最小目标值为 $450\\,\\mathrm{MW}^2$。",
            "answer": "$$\\boxed{450}$$"
        }
    ]
}