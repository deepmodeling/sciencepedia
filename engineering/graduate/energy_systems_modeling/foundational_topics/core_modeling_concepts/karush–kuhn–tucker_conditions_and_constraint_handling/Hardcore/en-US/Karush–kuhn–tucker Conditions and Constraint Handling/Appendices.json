{
    "hands_on_practices": [
        {
            "introduction": "This first practice exercise grounds the Karush-Kuhn-Tucker (KKT) conditions in their most fundamental application: the economic dispatch of power generators. By solving a simplified problem with only an equality constraint for power balance, you will derive the classic principle of equal marginal costs. This exercise is crucial for understanding how the Lagrange multiplier $\\lambda$ emerges as the system's marginal price, a cornerstone concept in energy markets .",
            "id": "4100167",
            "problem": "Consider a single-period, single-bus economic dispatch problem in energy systems modeling. There are $3$ thermal generators indexed by $i \\in \\{1,2,3\\}$, each producing power $p_i \\ge 0$ (in $\\mathrm{MW}$). The total demand at the bus is $D$ (in $\\mathrm{MW}$), and the network is lossless. Each generator has a strictly convex quadratic production cost\n$$\nC_i(p_i) \\;=\\; a_i\\,p_i^2 \\;+\\; b_i\\,p_i \\;+\\; c_i,\n$$\nwith coefficients\n$$\na_1 \\;=\\; \\frac{1}{50}, \\quad b_1 \\;=\\; 10, \\quad c_1 \\;=\\; 0, \\qquad\na_2 \\;=\\; \\frac{1}{40}, \\quad b_2 \\;=\\; 8, \\quad c_2 \\;=\\; 50, \\qquad\na_3 \\;=\\; \\frac{1}{30}, \\quad b_3 \\;=\\; 12, \\quad c_3 \\;=\\; 100,\n$$\nand the power balance equality constraint\n$$\n\\sum_{i=1}^{3} p_i \\;=\\; D, \\qquad \\text{with } D \\;=\\; 210.\n$$\nYou are to derive, from first principles, the optimality conditions using the Karush–Kuhn–Tucker (KKT) conditions, construct the Lagrangian, and solve for the optimal dispatch $(p_1,p_2,p_3)$ and the associated Lagrange multiplier $\\lambda$ for the power balance constraint (the system shadow price, in $\\$/\\mathrm{MWh}$). Assume no upper bounds on $p_i$ and ignore nonnegativity of $p_i$ if it is not binding at optimum.\n\nStarting from the formal definition of the constrained optimization problem and the equality-constrained KKT framework, derive the first-order optimality conditions and solve the resulting system to obtain closed-form expressions for $p_i$ and $\\lambda$ in terms of $\\{a_i,b_i\\}$ and $D$. Then evaluate these expressions numerically for the given data.\n\nExpress the final dispatch in $\\mathrm{MW}$ and the shadow price in $\\$/\\mathrm{MWh}$. Round each reported quantity to four significant figures. Provide your final numerical answer as a single row vector $\\big(p_1,\\,p_2,\\,p_3,\\,\\lambda\\big)$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n-   Number of generators: $3$, indexed by $i \\in \\{1, 2, 3\\}$.\n-   Power output of generator $i$: $p_i \\ge 0$ (in $\\mathrm{MW}$).\n-   Cost function for generator $i$: $C_i(p_i) = a_i p_i^2 + b_i p_i + c_i$.\n-   Cost coefficients:\n    -   $a_1 = \\frac{1}{50}$, $b_1 = 10$, $c_1 = 0$.\n    -   $a_2 = \\frac{1}{40}$, $b_2 = 8$, $c_2 = 50$.\n    -   $a_3 = \\frac{1}{30}$, $b_3 = 12$, $c_3 = 100$.\n-   Total demand: $D = 210$ (in $\\mathrm{MW}$).\n-   Power balance equality constraint: $\\sum_{i=1}^{3} p_i = D$.\n-   Instruction: Ignore non-negativity constraints $p_i \\ge 0$ if they are not binding at the optimum.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a classic economic dispatch formulation, a fundamental concept in power systems engineering. The quadratic cost functions are a standard and valid approximation of generator cost curves. All aspects are consistent with established scientific and engineering principles.\n-   **Well-Posed:** The objective function, being a sum of strictly convex functions (since $a_i  0$ for all $i$), is strictly convex. The constraints are linear. This structure defines a convex optimization problem, which guarantees that a unique global minimum exists. The problem is therefore well-posed.\n-   **Objective:** The problem is stated with precise mathematical definitions and objective language.\n-   **Completeness and Consistency:** All necessary data (cost coefficients, demand level) and constraints are provided. The instructions are unambiguous. The problem is self-contained and free of contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to minimize the total generation cost, subject to meeting the demand. This can be formulated as a constrained optimization problem.\n\nThe total cost function is the sum of the individual generator costs:\n$$\nf(p_1, p_2, p_3) = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i)\n$$\nThe problem is to minimize this function subject to the power balance equality constraint:\n$$\nh(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - D = 0\n$$\nThe problem states to ignore the non-negativity constraints $p_i \\ge 0$ as a first step. We will solve the problem with only the equality constraint and verify the non-negativity of the solution afterward.\n\nWe use the method of Lagrange multipliers to solve this equality-constrained optimization problem. The Lagrangian function, $\\mathcal{L}$, is constructed as:\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = f(p_1, p_2, p_3) - \\lambda \\, h(p_1, p_2, p_3)\n$$\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i) - \\lambda \\left( \\sum_{i=1}^{3} p_i - D \\right)\n$$\nThe variable $\\lambda$ is the Lagrange multiplier associated with the power balance constraint. It represents the system's marginal cost of energy, or shadow price, in units of $\\$ / \\mathrm{MWh}$.\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality require that the gradient of the Lagrangian with respect to all variables ($p_1, p_2, p_3, \\lambda$) be zero. For an equality-constrained problem (ignoring the inequality constraints for now), these are the first-order necessary conditions.\n\nThe stationarity conditions are obtained by setting the partial derivatives of $\\mathcal{L}$ with respect to each $p_i$ to zero:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ (a_i p_i^2 + b_i p_i + c_i) - \\lambda p_i \\right] = 2 a_i p_i + b_i - \\lambda = 0\n$$\nThis must hold for each generator $i \\in \\{1, 2, 3\\}$. This condition, $2 a_i p_i + b_i = \\lambda$, states that for optimal dispatch, the marginal cost of production, $\\frac{dC_i}{dp_i} = 2 a_i p_i + b_i$, must be equal for all dispatched generators. This common value is the system marginal price, $\\lambda$.\n\nFrom this condition, we can express the optimal power output $p_i$ for each generator as a function of $\\lambda$:\n$$\np_i = \\frac{\\lambda - b_i}{2 a_i}\n$$\nThe primal feasibility condition is simply the original equality constraint, which can also be found by setting the partial derivative of $\\mathcal{L}$ with respect to $\\lambda$ to zero:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left( \\sum_{i=1}^{3} p_i - D \\right) = 0 \\quad \\implies \\quad \\sum_{i=1}^{3} p_i = D\n$$\nTo find the value of $\\lambda$, we substitute the expression for $p_i$ into the power balance equation:\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda - b_i}{2 a_i} = D\n$$\nWe can now solve this equation for $\\lambda$.\n$$\n\\sum_{i=1}^{3} \\left( \\frac{\\lambda}{2 a_i} - \\frac{b_i}{2 a_i} \\right) = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) - \\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) = D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}\n$$\nThis gives the closed-form expression for the system shadow price $\\lambda$:\n$$\n\\lambda = \\frac{D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}}{\\sum_{i=1}^{3} \\frac{1}{2 a_i}}\n$$\nNow, we substitute the given numerical values to find the solution.\nThe coefficients are: $a_1 = \\frac{1}{50}$, $b_1 = 10$; $a_2 = \\frac{1}{40}$, $b_2 = 8$; $a_3 = \\frac{1}{30}$, $b_3 = 12$; and $D = 210$.\n\nFirst, calculate the terms in the sums:\n$$\n\\frac{1}{2a_1} = \\frac{1}{2(\\frac{1}{50})} = 25, \\quad \\frac{1}{2a_2} = \\frac{1}{2(\\frac{1}{40})} = 20, \\quad \\frac{1}{2a_3} = \\frac{1}{2(\\frac{1}{30})} = 15\n$$\n$$\n\\sum_{i=1}^{3} \\frac{1}{2 a_i} = 25 + 20 + 15 = 60\n$$\nNext, calculate the terms for the second sum:\n$$\n\\frac{b_1}{2a_1} = 10 \\times 25 = 250, \\quad \\frac{b_2}{2a_2} = 8 \\times 20 = 160, \\quad \\frac{b_3}{2a_3} = 12 \\times 15 = 180\n$$\n$$\n\\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = 250 + 160 + 180 = 590\n$$\nNow, we can compute $\\lambda$:\n$$\n\\lambda = \\frac{210 + 590}{60} = \\frac{800}{60} = \\frac{40}{3} \\approx 13.3333...\n$$\nWith the value of $\\lambda$, we find the optimal power dispatch for each generator:\n$$\np_1 = \\frac{\\lambda - b_1}{2 a_1} = \\left(\\frac{40}{3} - 10\\right) \\times 25 = \\left(\\frac{40 - 30}{3}\\right) \\times 25 = \\frac{10}{3} \\times 25 = \\frac{250}{3} \\approx 83.3333...\n$$\n$$\np_2 = \\frac{\\lambda - b_2}{2 a_2} = \\left(\\frac{40}{3} - 8\\right) \\times 20 = \\left(\\frac{40 - 24}{3}\\right) \\times 20 = \\frac{16}{3} \\times 20 = \\frac{320}{3} \\approx 106.6666...\n$$\n$$\np_3 = \\frac{\\lambda - b_3}{2 a_3} = \\left(\\frac{40}{3} - 12\\right) \\times 15 = \\left(\\frac{40 - 36}{3}\\right) \\times 15 = \\frac{4}{3} \\times 15 = 20\n$$\nWe check the validity of this solution. First, the power balance constraint:\n$$\n\\sum_{i=1}^{3} p_i = \\frac{250}{3} + \\frac{320}{3} + 20 = \\frac{570}{3} + 20 = 190 + 20 = 210 = D\n$$\nThe constraint is satisfied.\nNext, we check the non-negativity. The calculated values are $p_1 \\approx 83.33  0$, $p_2 \\approx 106.67  0$, and $p_3 = 20  0$. Since all $p_i$ are positive, the non-negativity constraints $p_i \\ge 0$ are not binding. This means that the full KKT conditions, which would include complementary slackness multipliers for these constraints, are satisfied with those multipliers being zero. Thus, the solution is the correct and optimal dispatch.\n\nFinally, we round the numerical results to four significant figures as requested:\n-   $p_1 = \\frac{250}{3} \\approx 83.33 \\ \\mathrm{MW}$\n-   $p_2 = \\frac{320}{3} \\approx 106.7 \\ \\mathrm{MW}$\n-   $p_3 = 20.00 \\ \\mathrm{MW}$\n-   $\\lambda = \\frac{40}{3} \\approx 13.33 \\ \\$/\\mathrm{MWh}$\n\nThe final answer is the row vector $(p_1, p_2, p_3, \\lambda)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 83.33  106.7  20.00  13.33 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the foundational case, this exercise introduces the complexity of physical operating limits through inequality constraints. By analyzing two distinct scenarios—one with ample capacity and one with a tightened limit—you will directly observe the principle of complementary slackness in action. This hands-on comparison is designed to provide a clear, intuitive understanding of how and why a binding constraint activates its corresponding Lagrange multiplier, revealing its economic meaning as a congestion price .",
            "id": "4100093",
            "problem": "Consider a single-period economic dispatch problem for a two-generator system commonly used in energy systems modeling. Let generator outputs be $p_{1}$ and $p_{2}$ (in megawatts, MW), and let the total electrical demand be $D$ (in MW). Each generator $i \\in \\{1,2\\}$ has a convex quadratic operating cost given by $C_{i}(p_{i}) = \\frac{1}{2} a_{i} p_{i}^{2}$, where $a_{i}$ has units of dollars per megawatt squared ($\\$/\\mathrm{MW}^{2}$). The system must satisfy the power balance and capacity limits, and outputs must be nonnegative. Formulate and solve this dispatch problem by applying the Karush–Kuhn–Tucker (KKT) conditions, and use the solution to illustrate how tightening a capacity limit changes complementary slackness status and modifies the optimal multipliers and dispatch.\n\nUse the following two scenarios with a one-hour operating interval (so MW and megawatt-hours, MWh, are numerically equal):\n\nScenario A (baseline): $a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$, $a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$, $D = 80\\,\\mathrm{MW}$, $P_{1}^{\\max} = 100\\,\\mathrm{MW}$, $P_{2}^{\\max} = 100\\,\\mathrm{MW}$.\n\nScenario B (tightened capacity for generator $1$): $a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$, $a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$, $D = 80\\,\\mathrm{MW}$, $P_{1}^{\\max} = 50\\,\\mathrm{MW}$, $P_{2}^{\\max} = 100\\,\\mathrm{MW}$.\n\nTasks:\n- Derive the KKT conditions from first principles of convex optimization and Lagrangian duality for the problem of minimizing total cost $C(p_{1},p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}$ subject to power balance $p_{1} + p_{2} = D$, capacity constraints $p_{i} \\leq P_{i}^{\\max}$, and nonnegativity constraints $p_{i} \\geq 0$.\n- Solve the KKT system to find the optimal dispatches $p_{1}^{\\star}$ and $p_{2}^{\\star}$, the optimal Lagrange multiplier for the power balance constraint $\\lambda^{\\star}$ (in $\\$/\\mathrm{MW}$), and the optimal Lagrange multiplier for generator $1$’s capacity constraint $\\mu_{1}^{\\star}$ (in $\\$/\\mathrm{MW}$), for both Scenario A and Scenario B.\n- In your reasoning, identify the complementary slackness status of generator $1$’s capacity constraint in each scenario and explain the switch when moving from Scenario A to Scenario B.\n\nExpress dispatch quantities in megawatts (MW) and dual variables in dollars per megawatt ($\\$/\\mathrm{MW}$). For the final boxed answer, report only the numerical values without units, ordered as a single row matrix:\n$\\big[p_{1}^{\\star}\\text{(A)},\\;p_{2}^{\\star}\\text{(A)},\\;\\lambda^{\\star}\\text{(A)},\\;\\mu_{1}^{\\star}\\text{(A)},\\;p_{1}^{\\star}\\text{(B)},\\;p_{2}^{\\star}\\text{(B)},\\;\\lambda^{\\star}\\text{(B)},\\;\\mu_{1}^{\\star}\\text{(B)}\\big]$.\n\nNo rounding is required; provide exact values.",
            "solution": "The problem presents a classic economic dispatch scenario for a two-generator system, which can be formulated as a convex optimization problem. The goal is to minimize the total generation cost subject to meeting a specified demand and respecting the operational limits of the generators.\n\nFirst, we formalize the optimization problem. Let the decision variables be the power outputs of the two generators, $p_{1}$ and $p_{2}$. The objective is to minimize the total cost function, $C(p_{1}, p_{2})$, which is the sum of the individual generator costs:\n$$\n\\text{Minimize } C(p_{1}, p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}\n$$\nThis minimization is subject to several constraints:\n1.  Power balance (equality constraint): The total generation must equal the total demand, $D$.\n    $$p_{1} + p_{2} = D$$\n2.  Generator capacity limits (inequality constraints): Each generator's output cannot exceed its maximum capacity, $P_{i}^{\\max}$.\n    $$p_{1} \\leq P_{1}^{\\max}$$\n    $$p_{2} \\leq P_{2}^{\\max}$$\n3.  Non-negativity (inequality constraints): Power generation cannot be negative.\n    $$p_{1} \\geq 0$$\n    $$p_{2} \\geq 0$$\n\nTo solve this using the Karush–Kuhn–Tucker (KKT) conditions, we first construct the Lagrangian function. We associate a Lagrange multiplier with each constraint. Let $\\lambda$ be the multiplier for the power balance equality constraint. Let $\\mu_{1}$ and $\\mu_{2}$ be the multipliers for the upper capacity limits, and let $\\gamma_{1}$ and $\\gamma_{2}$ be the multipliers for the non-negativity constraints.\n\nTo formulate the Lagrangian, we rewrite the constraints in the standard form $h(x)=0$ and $g(x) \\leq 0$:\n$$h_1(p_1,p_2) = D - p_{1} - p_{2} = 0$$\n$$g_1(p_1) = p_{1} - P_{1}^{\\max} \\leq 0$$\n$$g_2(p_2) = p_{2} - P_{2}^{\\max} \\leq 0$$\n$$g_3(p_1) = -p_{1} \\leq 0$$\n$$g_4(p_2) = -p_{2} \\leq 0$$\n\nThe Lagrangian $\\mathcal{L}$ is given by:\n$$\n\\mathcal{L}(p_{1}, p_{2}, \\lambda, \\mu_{1}, \\mu_{2}, \\gamma_{1}, \\gamma_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2} + \\lambda(D - p_{1} - p_{2}) + \\mu_{1}(p_{1} - P_{1}^{\\max}) + \\mu_{2}(p_{2} - P_{2}^{\\max}) - \\gamma_{1}p_{1} - \\gamma_{2}p_{2}\n$$\nThe KKT conditions for an optimal solution $(p_{1}^{\\star}, p_{2}^{\\star})$ and optimal multipliers $(\\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\gamma_{1}^{\\star}, \\gamma_{2}^{\\star})$ are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $(p_{1}, p_{2})$ must be zero.\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{1}} = a_{1} p_{1} - \\lambda + \\mu_{1} - \\gamma_{1} = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{2}} = a_{2} p_{2} - \\lambda + \\mu_{2} - \\gamma_{2} = 0$$\n    These equations state that at the optimum, the marginal cost of generation for each unit, adjusted for any binding constraints, must equal the system marginal price, $\\lambda$.\n\n2.  **Primal Feasibility**: The original constraints must be satisfied.\n    $$p_{1}^{\\star} + p_{2}^{\\star} = D$$\n    $$p_{1}^{\\star} \\leq P_{1}^{\\max}, \\quad p_{2}^{\\star} \\leq P_{2}^{\\max}$$\n    $$p_{1}^{\\star} \\geq 0, \\quad p_{2}^{\\star} \\geq 0$$\n\n3.  **Dual Feasibility**: The multipliers for all inequality constraints must be non-negative.\n    $$\\mu_{1}^{\\star} \\geq 0, \\quad \\mu_{2}^{\\star} \\geq 0$$\n    $$\\gamma_{1}^{\\star} \\geq 0, \\quad \\gamma_{2}^{\\star} \\geq 0$$\n\n4.  **Complementary Slackness**: The product of an inequality constraint's multiplier and its slack must be zero.\n    $$\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$$\n    $$\\mu_{2}^{\\star}(p_{2}^{\\star} - P_{2}^{\\max}) = 0$$\n    $$\\gamma_{1}^{\\star}(-p_{1}^{\\star}) = 0 \\implies \\gamma_{1}^{\\star} p_{1}^{\\star} = 0$$\n    $$\\gamma_{2}^{\\star}(-p_{2}^{\\star}) = 0 \\implies \\gamma_{2}^{\\star} p_{2}^{\\star} = 0$$\n\nNow we solve this system for the two specified scenarios.\n\n**Scenario A: Baseline**\nThe parameters are $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 100$, and $P_{2}^{\\max} = 100$.\nLet's first assume that the solution is in the interior of the feasible region, meaning none of the inequality constraints are active. This implies $0  p_{i}^{\\star}  P_{i}^{\\max}$. By complementary slackness, this assumption means $\\mu_{1}^{\\star} = \\mu_{2}^{\\star} = \\gamma_{1}^{\\star} = \\gamma_{2}^{\\star} = 0$.\n\nThe stationarity conditions simplify to:\n$$a_{1} p_{1} - \\lambda = 0 \\implies p_{1} = \\frac{\\lambda}{a_{1}}$$\n$$a_{2} p_{2} - \\lambda = 0 \\implies p_{2} = \\frac{\\lambda}{a_{2}}$$\nSubstituting these into the power balance constraint:\n$$\\frac{\\lambda}{a_{1}} + \\frac{\\lambda}{a_{2}} = D \\implies \\lambda \\left(\\frac{1}{a_{1}} + \\frac{1}{a_{2}}\\right) = D$$\nSolving for $\\lambda$:\n$$\\lambda^{\\star} = \\frac{D}{\\frac{1}{a_{1}} + \\frac{1}{a_{2}}} = \\frac{D a_{1} a_{2}}{a_{1} + a_{2}}$$\nUsing the values for Scenario A:\n$$\\lambda^{\\star}(\\text{A}) = \\frac{80 \\cdot 1 \\cdot 3}{1 + 3} = \\frac{240}{4} = 60$$\nThe units of $\\lambda$ are $\\$/\\mathrm{MW}$. Now we find the optimal dispatch:\n$$p_{1}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{1}} = \\frac{60}{1} = 60$$\n$$p_{2}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{2}} = \\frac{60}{3} = 20$$\nWe must verify our initial assumption that no inequality constraints are binding.\n-   $p_{1}^{\\star}(\\text{A}) = 60$. Is $0  60  100$? Yes.\n-   $p_{2}^{\\star}(\\text{A}) = 20$. Is $0  20  100$? Yes.\nThe assumption was correct. The inequality constraints are slack. Therefore, their corresponding multipliers are zero: $\\mu_{1}^{\\star}(\\text{A}) = 0$, $\\mu_{2}^{\\star}(\\text{A}) = 0$, $\\gamma_{1}^{\\star}(\\text{A}) = 0$, $\\gamma_{2}^{\\star}(\\text{A}) = 0$. The KKT conditions are all satisfied.\nThe required values are $p_{1}^{\\star}(\\text{A}) = 60$, $p_{2}^{\\star}(\\text{A}) = 20$, $\\lambda^{\\star}(\\text{A}) = 60$, and $\\mu_{1}^{\\star}(\\text{A}) = 0$.\n\n**Scenario B: Tightened capacity for generator 1**\nThe parameters are $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 50$, and $P_{2}^{\\max} = 100$.\nThe unconstrained solution from Scenario A ($p_1=60$) violates the new capacity limit $p_{1} \\leq 50$. This indicates that the constraint $p_{1} \\leq P_{1}^{\\max}$ will be active (binding) at the optimum.\nLet's assume $p_{1}^{\\star} = P_{1}^{\\max} = 50$.\nFrom the power balance constraint:\n$$p_{1}^{\\star} + p_{2}^{\\star} = 80 \\implies 50 + p_{2}^{\\star} = 80 \\implies p_{2}^{\\star} = 30$$\nNow we check the feasibility of this dispatch:\n-   $p_{1}^{\\star}(\\text{B}) = 50$. This satisfies $0 \\leq 50 \\leq 50$. The constraint $p_{1} \\leq P_{1}^{\\max}$ is active. The constraint $p_{1} \\geq 0$ is not. So we expect $\\mu_{1}^{\\star} \\geq 0$ and $\\gamma_{1}^{\\star} = 0$.\n-   $p_{2}^{\\star}(\\text{B}) = 30$. This satisfies $0 \\leq 30 \\leq 100$. The constraints on $p_{2}$ are not active. So we expect $\\mu_{2}^{\\star} = 0$ and $\\gamma_{2}^{\\star} = 0$.\n\nWith $\\mu_{2}^{\\star}=0$, $\\gamma_{1}^{\\star}=0$, and $\\gamma_{2}^{\\star}=0$, the stationarity conditions become:\n$$a_{1} p_{1} - \\lambda + \\mu_{1} = 0$$\n$$a_{2} p_{2} - \\lambda = 0$$\nUsing the values for Scenario B and our dispatch solution:\nFrom the second equation:\n$$3 \\cdot 30 - \\lambda^{\\star} = 0 \\implies \\lambda^{\\star}(\\text{B}) = 90$$\nFrom the first equation:\n$$1 \\cdot 50 - 90 + \\mu_{1}^{\\star} = 0 \\implies -40 + \\mu_{1}^{\\star} = 0 \\implies \\mu_{1}^{\\star}(\\text{B}) = 40$$\nWe must check dual feasibility: $\\mu_{1}^{\\star}(\\text{B}) = 40 \\geq 0$. This is satisfied.\nAll KKT conditions are met. The optimal solution is $p_{1}^{\\star}(\\text{B}) = 50$, $p_{2}^{\\star}(\\text{B}) = 30$, $\\lambda^{\\star}(\\text{B}) = 90$, and $\\mu_{1}^{\\star}(\\text{B}) = 40$.\n\n**Analysis of Complementary Slackness Status Change**\nThe transition from Scenario A to Scenario B provides a clear illustration of the role of complementary slackness and Lagrange multipliers.\n\n-   **In Scenario A**, the capacity limit on generator 1, $P_{1}^{\\max}=100$, is not a limiting factor. The optimal dispatch is $p_{1}^{\\star}=60$, which is well below the limit. The constraint $p_{1} - P_1^{\\max} \\leq 0$ is **inactive** because there is a non-zero slack: $60 - 100 = -40 \\neq 0$. The complementary slackness condition $\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$ dictates that the corresponding multiplier must be zero: $\\mu_{1}^{\\star}(\\text{A}) = 0$. The economic interpretation is that there would be zero cost savings from a marginal increase in the capacity of generator 1, as the system is not using all of its current capacity. The system marginal cost of energy, $\\lambda^{\\star}=60\\,\\$/\\mathrm{MW}$, is set by the equal marginal costs of both generators: $a_{1} p_{1}^{\\star} = 1 \\cdot 60 = 60$ and $a_{2} p_{2}^{\\star} = 3 \\cdot 20 = 60$.\n\n-   **In Scenario B**, the capacity limit on generator 1 is tightened to $P_{1}^{\\max}=50$. The economically ideal dispatch of $p_{1}=60$ is no longer feasible. The optimization is forced to cap the output of the cheaper generator 1 at its limit, so $p_{1}^{\\star}=50$. The constraint $p_{1} - P_1^{\\max} \\leq 0$ is now **active** because the slack is zero: $50 - 50 = 0$. The complementary slackness condition $\\mu_{1}^{\\star}(0) = 0$ is satisfied for any non-negative $\\mu_{1}^{\\star}$. We found $\\mu_{1}^{\\star}(\\text{B}) = 40$.\n\n-   **The Switch**: The tightening of the constraint forced it to become active, causing its associated Lagrange multiplier (shadow price) to switch from zero to a positive value. The system marginal price $\\lambda^{\\star}$ is now dictated entirely by the more expensive generator 2, which is the marginal unit: $\\lambda^{\\star}(\\text{B}) = a_{2} p_{2}^{\\star} = 3 \\cdot 30 = 90\\,\\$/\\mathrm{MW}$. The marginal cost of generator 1 is only $a_{1} p_{1}^{\\star} = 1 \\cdot 50 = 50\\,\\$/\\mathrm{MW}$. The multiplier $\\mu_{1}^{\\star} = 40\\,\\$/\\mathrm{MW}$ represents the difference between the system marginal price and generator 1's marginal cost ($\\lambda^{\\star} = a_{1} p_{1}^{\\star} + \\mu_{1}^{\\star} \\implies 90 = 50 + 40$). This value quantifies the marginal economic benefit of relaxing the constraint; if $P_{1}^{\\max}$ were increased by $1\\,\\mathrm{MW}$, the total system cost would decrease by approximately $40\\,\\$$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  20  60  0  50  30  90  40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice moves from solving the primal optimization problem to exploring its theoretical counterpart: the dual problem. You will construct the Lagrangian dual function from first principles, a key step in understanding advanced optimization techniques and market-clearing theory. This exercise reinforces the economic interpretation of the dual variables not just as shadow prices, but as the decision variables in a parallel optimization problem that reveals the maximum economic value extractable from the system's constraints .",
            "id": "4100151",
            "problem": "Consider a stylized day-ahead dispatch problem for an aggregator managing $N$ electrically coupled assets that can inject or withdraw net power in a single time period. Let the decision variable for asset $i$ be $x_{i} \\in \\mathbb{R}$, where $x_{i}  0$ denotes net injection and $x_{i}  0$ denotes net withdrawal. The system must meet an exogenous net demand $D  0$ exactly. Each asset incurs a convex, separable cost modeled as $c_{i}(x_{i}) = \\frac{1}{2} a_{i} x_{i}^{2}$ with $a_{i}  0$, which captures quadratic marginal penalties for deviating from a nominal operating point. The net power balance requirement is represented using two inequality constraints that collectively enforce equality:\n$$\\sum_{i=1}^{N} x_{i} - D \\leq 0 \\quad \\text{and} \\quad D - \\sum_{i=1}^{N} x_{i} \\leq 0.$$\nFormulate the Lagrangian and construct the dual function $q(\\lambda,\\mu)$ corresponding to the nonnegative Lagrange multipliers $\\lambda \\geq 0$ and $\\mu \\geq 0$ associated with these two inequalities. Derive the dual optimization problem $\\max_{\\lambda,\\mu \\geq 0} q(\\lambda,\\mu)$ from first principles of convex duality, starting from core definitions of the Lagrangian, dual function, and the Karush–Kuhn–Tucker (KKT) conditions. Explain the physical interpretation of the dual variables in the context of energy systems modeling, including the role of their difference as a marginal system price. Provide the analytical expression for the dual function $q(\\lambda,\\mu)$ as your final answer. No numerical evaluation is required and no rounding is needed. Do not include units in your final answer.",
            "solution": "The user has provided a valid problem statement. The problem is a standard convex optimization problem in the context of energy system economic dispatch, and it is well-posed, scientifically grounded, and contains all necessary information. We may proceed with the solution.\n\nThe primal optimization problem is to minimize the total cost of dispatch for $N$ assets, subject to a power balance constraint. The total cost is the sum of the individual asset costs, $f(x) = \\sum_{i=1}^{N} c_{i}(x_{i}) = \\sum_{i=1}^{N} \\frac{1}{2} a_{i} x_{i}^{2}$. The power balance constraint, $\\sum_{i=1}^{N} x_{i} = D$, is expressed using two inequality constraints:\n$g_1(x) = \\sum_{i=1}^{N} x_{i} - D \\leq 0$\n$g_2(x) = D - \\sum_{i=1}^{N} x_{i} \\leq 0$\n\nThe primal problem can be formally stated as:\n$$ \\min_{x \\in \\mathbb{R}^N} \\frac{1}{2} \\sum_{i=1}^{N} a_{i} x_{i}^{2} $$\n$$ \\text{subject to} \\quad \\sum_{i=1}^{N} x_{i} - D \\leq 0 $$\n$$ \\quad D - \\sum_{i=1}^{N} x_{i} \\leq 0 $$\n\nTo find the dual function, we first formulate the Lagrangian, $\\mathcal{L}(x, \\lambda, \\mu)$, by incorporating the constraints into the objective function, weighted by their respective non-negative Lagrange multipliers, $\\lambda \\geq 0$ and $\\mu \\geq 0$.\n$$ \\mathcal{L}(x, \\lambda, \\mu) = f(x) + \\lambda g_1(x) + \\mu g_2(x) $$\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} \\sum_{i=1}^{N} a_{i} x_{i}^{2} + \\lambda \\left( \\sum_{i=1}^{N} x_{i} - D \\right) + \\mu \\left( D - \\sum_{i=1}^{N} x_{i} \\right) $$\nWe can rearrange the terms to group them by the decision variables $x_i$:\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + \\lambda x_{i} - \\mu x_{i} \\right) - \\lambda D + \\mu D $$\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) + (\\mu - \\lambda) D $$\n\nThe dual function, $q(\\lambda, \\mu)$, is defined as the infimum of the Lagrangian with respect to the primal variables $x = (x_1, \\dots, x_N)$:\n$$ q(\\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^N} \\mathcal{L}(x, \\lambda, \\mu) $$\nSince the Lagrangian is separable with respect to the variables $x_i$, we can find the infimum by minimizing each term in the summation independently:\n$$ q(\\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\inf_{x_i \\in \\mathbb{R}} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) \\right) + (\\mu - \\lambda) D $$\nEach term in the sum is a convex quadratic function of $x_i$ (since $a_i  0$). The minimum is found by setting the partial derivative with respect to $x_i$ to zero. This corresponds to the stationarity condition of the Karush–Kuhn–Tucker (KKT) conditions.\n$$ \\frac{\\partial}{\\partial x_i} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) = a_{i} x_{i} + (\\lambda - \\mu) = 0 $$\nSolving for the value of $x_i$ that minimizes the Lagrangian for fixed $\\lambda$ and $\\mu$, denoted $x_i^*(\\lambda, \\mu)$:\n$$ x_i^*(\\lambda, \\mu) = -\\frac{\\lambda - \\mu}{a_i} = \\frac{\\mu - \\lambda}{a_i} $$\nSubstituting this expression for $x_i^*$ back into the term being minimized:\n$$ \\inf_{x_i} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) = \\frac{1}{2} a_{i} \\left( \\frac{\\mu - \\lambda}{a_i} \\right)^2 + (\\lambda - \\mu) \\left( \\frac{\\mu - \\lambda}{a_i} \\right) $$\n$$ = \\frac{a_i (\\mu - \\lambda)^2}{2 a_i^2} - \\frac{(\\mu - \\lambda)^2}{a_i} = \\frac{(\\mu - \\lambda)^2}{2 a_i} - \\frac{2(\\mu - \\lambda)^2}{2 a_i} = -\\frac{(\\mu - \\lambda)^2}{2 a_i} $$\nNow, we sum this result over all $i$ and add the constant term to get the dual function:\n$$ q(\\lambda, \\mu) = \\sum_{i=1}^{N} \\left( -\\frac{(\\mu - \\lambda)^2}{2 a_i} \\right) + (\\mu - \\lambda) D $$\n$$ q(\\lambda, \\mu) = -\\frac{1}{2} (\\mu - \\lambda)^2 \\sum_{i=1}^{N} \\frac{1}{a_i} + (\\mu - \\lambda) D $$\nThis is the analytical expression for the dual function.\n\nThe dual optimization problem consists of maximizing this dual function subject to the non-negativity constraints on the dual variables:\n$$ \\max_{\\lambda, \\mu} \\quad q(\\lambda, \\mu) $$\n$$ \\text{subject to} \\quad \\lambda \\geq 0, \\quad \\mu \\geq 0 $$\n\nIn the context of energy systems, the dual variables (Lagrange multipliers) have a clear physical and economic interpretation. They represent the shadow price of the associated constraints, i.e., the marginal change in the optimal objective value (total cost) for a unit relaxation of the constraint.\n- The multiplier $\\lambda$ is associated with the constraint $\\sum x_i \\leq D$. It represents the marginal cost of preventing oversupply, or the penalty for producing more than the demand $D$.\n- The multiplier $\\mu$ is associated with the constraint $\\sum x_i \\geq D$. It represents the marginal cost of preventing undersupply, or the penalty for not meeting the demand $D$.\n- The quantity $\\nu = \\mu - \\lambda$ is of central importance. From the stationarity condition, $a_i x_i = \\mu - \\lambda$, we see that at the optimal solution, the marginal cost of each asset, $\\frac{d c_i}{d x_i} = a_i x_i$, must be equal to this common value $\\nu$. This value, $\\nu$, is the **system marginal price (SMP)**. It is the equilibrium market-clearing price of energy—the cost to supply one additional marginal unit of power to the system while maintaining power balance. The use of two opposing inequality constraints to enforce equality allows for the decomposition of this system price into two components reflecting the costs of undersupply and oversupply. In a typical solution to this problem where $D0$, we find that $\\lambda^*=0$ and $\\mu^*0$, which means that the SMP is entirely driven by the cost of meeting demand, and there is no price signal associated with over-generation.",
            "answer": "$$\n\\boxed{-\\frac{1}{2} (\\mu - \\lambda)^2 \\sum_{i=1}^{N} \\frac{1}{a_i} + (\\mu - \\lambda) D}\n$$"
        }
    ]
}