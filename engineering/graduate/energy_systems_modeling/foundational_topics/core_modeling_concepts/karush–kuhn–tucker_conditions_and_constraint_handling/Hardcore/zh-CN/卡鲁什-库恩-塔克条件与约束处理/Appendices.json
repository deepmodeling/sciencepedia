{
    "hands_on_practices": [
        {
            "introduction": "本练习是掌握经济调度问题的理想起点。通过构建一个仅包含功率平衡等式约束的简化电力系统模型，您将能够专注于应用 Karush-Kuhn-Tucker (KKT) 条件推导出其核心经济原则：最优状态下所有发电机的边际成本相等。完成此练习有助于您理解系统边际价格（或影子价格）$\\lambda$ 是如何从优化问题中自然产生的，并为处理更复杂的情形打下坚实基础。",
            "id": "4100167",
            "problem": "考虑能源系统建模中的一个单周期、单母线经济调度问题。有3台火力发电机组，索引为 $i \\in \\{1,2,3\\}$，每台机组的产出功率为 $p_i \\ge 0$ (单位为 $\\mathrm{MW}$)。母线上的总需求为 $D$ (单位为 $\\mathrm{MW}$)，且网络无损耗。每台发电机组的生产成本为严格凸的二次函数\n$$\nC_i(p_i) \\;=\\; a_i\\,p_i^2 \\;+\\; b_i\\,p_i \\;+\\; c_i,\n$$\n其系数为\n$$\na_1 \\;=\\; \\frac{1}{50}, \\quad b_1 \\;=\\; 10, \\quad c_1 \\;=\\; 0, \\qquad\na_2 \\;=\\; \\frac{1}{40}, \\quad b_2 \\;=\\; 8, \\quad c_2 \\;=\\; 50, \\qquad\na_3 \\;=\\; \\frac{1}{30}, \\quad b_3 \\;=\\; 12, \\quad c_3 \\;=\\; 100,\n$$\n以及功率平衡等式约束\n$$\n\\sum_{i=1}^{3} p_i \\;=\\; D, \\qquad \\text{with } D \\;=\\; 210.\n$$\n你需要从第一性原理出发，使用 Karush-Kuhn-Tucker (KKT) 条件推导最优性条件，构建拉格朗日函数，并求解最优调度 $(p_1,p_2,p_3)$ 以及与功率平衡约束相关的拉格朗日乘子 $\\lambda$ (系统的影子价格，单位为 $\\$/\\mathrm{MWh}$)。假设 $p_i$ 没有上限，并且如果 $p_i$ 的非负性在最优点不具约束力，则忽略该条件。\n\n从约束优化问题的形式化定义和等式约束的KKT框架开始，推导一阶最优性条件，并求解所得方程组，以获得用 $\\{a_i,b_i\\}$ 和 $D$ 表示的 $p_i$ 和 $\\lambda$ 的闭式表达式。然后，利用给定数据对这些表达式进行数值计算。\n\n最终的调度结果以 $\\mathrm{MW}$ 表示，影子价格以 $\\$/\\mathrm{MWh}$ 表示。将报告的每个数值四舍五入到四位有效数字。以单行向量 $\\big(p_1,\\,p_2,\\,p_3,\\,\\lambda\\big)$ 的形式给出你的最终数值答案。",
            "solution": "首先对问题进行验证，以确保其科学基础扎实、内容自洽且提法恰当。\n\n### 步骤 1：提取已知条件\n-   发电机组数量：$3$ 台，索引为 $i \\in \\{1, 2, 3\\}$。\n-   发电机组 $i$ 的功率输出：$p_i \\ge 0$ (单位 $\\mathrm{MW}$)。\n-   发电机组 $i$ 的成本函数：$C_i(p_i) = a_i p_i^2 + b_i p_i + c_i$。\n-   成本系数：\n    -   $a_1 = \\frac{1}{50}$，$b_1 = 10$，$c_1 = 0$。\n    -   $a_2 = \\frac{1}{40}$，$b_2 = 8$，$c_2 = 50$。\n    -   $a_3 = \\frac{1}{30}$，$b_3 = 12$，$c_3 = 100$。\n-   总需求：$D = 210$ (单位 $\\mathrm{MW}$)。\n-   功率平衡等式约束：$\\sum_{i=1}^{3} p_i = D$。\n-   说明：如果非负约束 $p_i \\ge 0$ 在最优点不具约束力，则忽略它们。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础：** 该问题是经典的经济调度模型，是电力系统工程中的一个基本概念。二次成本函数是发电机成本曲线的标准且有效的近似。所有方面都符合既定的科学和工程原理。\n-   **提法恰当性：** 目标函数是严格凸函数的和（因为对所有 $i$ 都有 $a_i  0$），因此是严格凸的。约束是线性的。这种结构定义了一个凸优化问题，保证了唯一全局最小值的存在。因此，该问题是提法恰当的。\n-   **客观性：** 问题陈述使用了精确的数学定义和客观的语言。\n-   **完整性和一致性：** 提供了所有必要的数据（成本系数、需求水平）和约束。指令明确。问题是自洽的，没有矛盾。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解题推导\n目标是在满足需求的前提下，最小化总发电成本。这可以被构建为一个约束优化问题。\n\n总成本函数是各发电机组成本之和：\n$$\nf(p_1, p_2, p_3) = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i)\n$$\n问题是在功率平衡等式约束下最小化此函数：\n$$\nh(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - D = 0\n$$\n问题要求第一步忽略非负约束 $p_i \\ge 0$。我们将仅用等式约束求解问题，然后验证解的非负性。\n\n我们使用拉格朗日乘子法来求解这个等式约束优化问题。拉格朗日函数 $\\mathcal{L}$ 构建如下：\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = f(p_1, p_2, p_3) - \\lambda \\, h(p_1, p_2, p_3)\n$$\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i) - \\lambda \\left( \\sum_{i=1}^{3} p_i - D \\right)\n$$\n变量 $\\lambda$ 是与功率平衡约束相关的拉格朗日乘子。它代表了系统的边际能源成本，即影子价格，单位为 $\\$ / \\mathrm{MWh}$。\n\n最优性的 Karush-Kuhn-Tucker (KKT) 条件要求拉格朗日函数对所有变量（$p_1, p_2, p_3, \\lambda$）的梯度为零。对于一个等式约束问题（暂时忽略不等式约束），这些是一阶必要条件。\n\n通过将 $\\mathcal{L}$ 对每个 $p_i$ 的偏导数设为零，可以得到平稳性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ (a_i p_i^2 + b_i p_i + c_i) - \\lambda p_i \\right] = 2 a_i p_i + b_i - \\lambda = 0\n$$\n这个条件对于每个发电机组 $i \\in \\{1, 2, 3\\}$ 都必须成立。条件 $2 a_i p_i + b_i = \\lambda$ 表明，在最优调度下，所有已调度的发电机组的边际生产成本 $\\frac{dC_i}{dp_i} = 2 a_i p_i + b_i$ 必须相等。这个共同的值就是系统边际价格 $\\lambda$。\n\n根据这个条件，我们可以将每台发电机组的最优功率输出 $p_i$ 表示为 $\\lambda$ 的函数：\n$$\np_i = \\frac{\\lambda - b_i}{2 a_i}\n$$\n原始可行性条件就是原始的等式约束，也可以通过将 $\\mathcal{L}$ 对 $\\lambda$ 的偏导数设为零得到：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left( \\sum_{i=1}^{3} p_i - D \\right) = 0 \\quad \\implies \\quad \\sum_{i=1}^{3} p_i = D\n$$\n为了求出 $\\lambda$ 的值，我们将 $p_i$ 的表达式代入功率平衡方程：\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda - b_i}{2 a_i} = D\n$$\n现在我们可以求解这个关于 $\\lambda$ 的方程。\n$$\n\\sum_{i=1}^{3} \\left( \\frac{\\lambda}{2 a_i} - \\frac{b_i}{2 a_i} \\right) = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) - \\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) = D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}\n$$\n这就给出了系统影子价格 $\\lambda$ 的闭式表达式：\n$$\n\\lambda = \\frac{D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}}{\\sum_{i=1}^{3} \\frac{1}{2 a_i}}\n$$\n现在，我们代入给定的数值来求解。\n系数为：$a_1 = \\frac{1}{50}$，$b_1 = 10$；$a_2 = \\frac{1}{40}$，$b_2 = 8$；$a_3 = \\frac{1}{30}$，$b_3 = 12$；以及 $D = 210$。\n\n首先，计算求和中的各项：\n$$\n\\frac{1}{2a_1} = \\frac{1}{2(\\frac{1}{50})} = 25, \\quad \\frac{1}{2a_2} = \\frac{1}{2(\\frac{1}{40})} = 20, \\quad \\frac{1}{2a_3} = \\frac{1}{2(\\frac{1}{30})} = 15\n$$\n$$\n\\sum_{i=1}^{3} \\frac{1}{2 a_i} = 25 + 20 + 15 = 60\n$$\n接下来，计算第二个求和的各项：\n$$\n\\frac{b_1}{2a_1} = 10 \\times 25 = 250, \\quad \\frac{b_2}{2a_2} = 8 \\times 20 = 160, \\quad \\frac{b_3}{2a_3} = 12 \\times 15 = 180\n$$\n$$\n\\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = 250 + 160 + 180 = 590\n$$\n现在，我们可以计算 $\\lambda$：\n$$\n\\lambda = \\frac{210 + 590}{60} = \\frac{800}{60} = \\frac{40}{3} \\approx 13.3333...\n$$\n利用 $\\lambda$ 的值，我们求出每台发电机组的最优功率调度：\n$$\np_1 = \\frac{\\lambda - b_1}{2 a_1} = \\left(\\frac{40}{3} - 10\\right) \\times 25 = \\left(\\frac{40 - 30}{3}\\right) \\times 25 = \\frac{10}{3} \\times 25 = \\frac{250}{3} \\approx 83.3333...\n$$\n$$\np_2 = \\frac{\\lambda - b_2}{2 a_2} = \\left(\\frac{40}{3} - 8\\right) \\times 20 = \\left(\\frac{40 - 24}{3}\\right) \\times 20 = \\frac{16}{3} \\times 20 = \\frac{320}{3} \\approx 106.6666...\n$$\n$$\np_3 = \\frac{\\lambda - b_3}{2 a_3} = \\left(\\frac{40}{3} - 12\\right) \\times 15 = \\left(\\frac{40 - 36}{3}\\right) \\times 15 = \\frac{4}{3} \\times 15 = 20\n$$\n我们检查这个解的有效性。首先，是功率平衡约束：\n$$\n\\sum_{i=1}^{3} p_i = \\frac{250}{3} + \\frac{320}{3} + 20 = \\frac{570}{3} + 20 = 190 + 20 = 210 = D\n$$\n约束得到满足。\n接下来，我们检查非负性。计算出的值为 $p_1 \\approx 83.33  0$，$p_2 \\approx 106.67  0$ 和 $p_3 = 20  0$。由于所有的 $p_i$ 都是正数，非负约束 $p_i \\ge 0$ 不具约束力。这意味着完整的KKT条件（其中会包含这些约束的互补松弛乘子）在这些乘子为零的情况下是满足的。因此，该解是正确的最优调度。\n\n最后，我们按照要求将数值结果四舍五入到四位有效数字：\n-   $p_1 = \\frac{250}{3} \\approx 83.33 \\ \\mathrm{MW}$\n-   $p_2 = \\frac{320}{3} \\approx 106.7 \\ \\mathrm{MW}$\n-   $p_3 = 20.00 \\ \\mathrm{MW}$\n-   $\\lambda = \\frac{40}{3} \\approx 13.33 \\ \\$/\\mathrm{MWh}$\n\n最终答案是行向量 $(p_1, p_2, p_3, \\lambda)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 83.33  106.7  20.00  13.33 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基础的等式约束问题后，下一个挑战是引入现实世界中的不等式约束，例如发电机容量限制。本练习通过对比两种情景——一种是容量充裕，另一种是容量受限——来巧妙地展示当约束从“松弛”变为“有效”时系统的变化。通过求解此问题，您将深入理解互补松弛条件在决定哪个约束有效中的关键作用，并揭示与容量限制相关的拉格朗日乘子 $\\mu$ 的明确经济含义。",
            "id": "4100093",
            "problem": "考虑一个能源系统建模中常用的双发电机系统的单周期经济调度问题。设发电机出力为 $p_{1}$ 和 $p_{2}$（单位：兆瓦，MW），总电力需求为 $D$（单位：MW）。每台发电机 $i \\in \\{1,2\\}$ 的运行成本为凸二次函数 $C_{i}(p_{i}) = \\frac{1}{2} a_{i} p_{i}^{2}$，其中 $a_{i}$ 的单位是美元/兆瓦平方（$\\$/\\mathrm{MW}^{2}$）。系统必须满足功率平衡和容量限制，且出力必须为非负。通过应用 Karush-Kuhn-Tucker (KKT) 条件来建立并求解此调度问题，并利用求解结果说明收紧容量限制如何改变互补松弛性状态以及最优乘子和调度结果。\n\n使用以下两种情景，运行区间为一小时（因此兆瓦 MW 和兆瓦时 MWh 在数值上相等）：\n\n情景 A（基准）：$a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$，$a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$，$D = 80\\,\\mathrm{MW}$，$P_{1}^{\\max} = 100\\,\\mathrm{MW}$，$P_{2}^{\\max} = 100\\,\\mathrm{MW}$。\n\n情景 B（收紧发电机 $1$ 的容量）：$a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$，$a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$，$D = 80\\,\\mathrm{MW}$，$P_{1}^{\\max} = 50\\,\\mathrm{MW}$，$P_{2}^{\\max} = 100\\,\\mathrm{MW}$。\n\n任务：\n- 从凸优化和拉格朗日对偶的基本原理出发，为最小化总成本 $C(p_{1},p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}$ 的问题推导 KKT 条件，该问题受功率平衡 $p_{1} + p_{2} = D$、容量约束 $p_{i} \\leq P_{i}^{\\max}$ 和非负性约束 $p_{i} \\geq 0$ 的限制。\n- 求解 KKT 系统，找出情景 A 和情景 B 下的最优调度 $p_{1}^{\\star}$ 和 $p_{2}^{\\star}$、功率平衡约束的最优拉格朗日乘子 $\\lambda^{\\star}$（单位：$\\$/\\mathrm{MW}$）以及发电机 $1$ 容量约束的最优拉格朗日乘子 $\\mu_{1}^{\\star}$（单位：$\\$/\\mathrm{MW}$）。\n- 在您的推理中，请指明在每种情景下发电机 $1$ 容量约束的互补松弛性状态，并解释从情景 A 转换到情景 B 时的变化。\n\n调度量以兆瓦（MW）表示，对偶变量以美元/兆瓦（$\\$/\\mathrm{MW}$）表示。对于最终的方框答案，仅报告数值，不带单位，并按单行矩阵的顺序列出：\n$\\big[p_{1}^{\\star}\\text{(A)},\\;p_{2}^{\\star}\\text{(A)},\\;\\lambda^{\\star}\\text{(A)},\\;\\mu_{1}^{\\star}\\text{(A)},\\;p_{1}^{\\star}\\text{(B)},\\;p_{2}^{\\star}\\text{(B)},\\;\\lambda^{\\star}\\text{(B)},\\;\\mu_{1}^{\\star}\\text{(B)}\\big]$。\n\n无需四舍五入；请提供精确值。",
            "solution": "该问题提出了一个经典的双发电机系统经济调度情景，可以构建为一个凸优化问题。目标是在满足指定需求和遵守发电机运行限制的条件下，最小化总发电成本。\n\n首先，我们将该优化问题形式化。设决策变量为两台发电机的功率输出 $p_{1}$ 和 $p_{2}$。目标是最小化总成本函数 $C(p_{1}, p_{2})$，即各发电机成本之和：\n$$\n\\text{Minimize } C(p_{1}, p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}\n$$\n该最小化问题受以下几个约束条件的限制：\n1.  功率平衡（等式约束）：总发电量必须等于总需求 $D$。\n    $$p_{1} + p_{2} = D$$\n2.  发电机容量限制（不等式约束）：每台发电机的出力不能超过其最大容量 $P_{i}^{\\max}$。\n    $$p_{1} \\leq P_{1}^{\\max}$$\n    $$p_{2} \\leq P_{2}^{\\max}$$\n3.  非负性（不等式约束）：发电功率不能为负。\n    $$p_{1} \\geq 0$$\n    $$p_{2} \\geq 0$$\n\n为使用 Karush-Kuhn-Tucker (KKT) 条件求解此问题，我们首先构建拉格朗日函数。我们为每个约束关联一个拉格朗日乘子。设 $\\lambda$ 为功率平衡等式约束的乘子。设 $\\mu_{1}$ 和 $\\mu_{2}$ 为容量上限的乘子，$\\gamma_{1}$ 和 $\\gamma_{2}$ 为非负性约束的乘子。\n\n为构建拉格朗日函数，我们将约束重写为标准形式 $h(x)=0$ 和 $g(x) \\leq 0$：\n$$h_1(p_1,p_2) = D - p_{1} - p_{2} = 0$$\n$$g_1(p_1) = p_{1} - P_{1}^{\\max} \\leq 0$$\n$$g_2(p_2) = p_{2} - P_{2}^{\\max} \\leq 0$$\n$$g_3(p_1) = -p_{1} \\leq 0$$\n$$g_4(p_2) = -p_{2} \\leq 0$$\n\n拉格朗日函数 $\\mathcal{L}$ 由下式给出：\n$$\n\\mathcal{L}(p_{1}, p_{2}, \\lambda, \\mu_{1}, \\mu_{2}, \\gamma_{1}, \\gamma_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2} + \\lambda(D - p_{1} - p_{2}) + \\mu_{1}(p_{1} - P_{1}^{\\max}) + \\mu_{2}(p_{2} - P_{2}^{\\max}) - \\gamma_{1}p_{1} - \\gamma_{2}p_{2}\n$$\n对于最优解 $(p_{1}^{\\star}, p_{2}^{\\star})$ 和最优乘子 $(\\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\gamma_{1}^{\\star}, \\gamma_{2}^{\\star})$，KKT 条件如下：\n\n1.  **稳定性（Stationarity）**：拉格朗日函数相对于原始变量 $(p_{1}, p_{2})$ 的梯度必须为零。\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{1}} = a_{1} p_{1} - \\lambda + \\mu_{1} - \\gamma_{1} = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{2}} = a_{2} p_{2} - \\lambda + \\mu_{2} - \\gamma_{2} = 0$$\n    这些方程表明，在最优点，每个机组的发电边际成本（经任何有效约束调整后）必须等于系统边际价格 $\\lambda$。\n\n2.  **原始可行性（Primal Feasibility）**：必须满足所有原始约束。\n    $$p_{1}^{\\star} + p_{2}^{\\star} = D$$\n    $$p_{1}^{\\star} \\leq P_{1}^{\\max}, \\quad p_{2}^{\\star} \\leq P_{2}^{\\max}$$\n    $$p_{1}^{\\star} \\geq 0, \\quad p_{2}^{\\star} \\geq 0$$\n\n3.  **对偶可行性（Dual Feasibility）**：所有不等式约束的乘子必须为非负。\n    $$\\mu_{1}^{\\star} \\geq 0, \\quad \\mu_{2}^{\\star} \\geq 0$$\n    $$\\gamma_{1}^{\\star} \\geq 0, \\quad \\gamma_{2}^{\\star} \\geq 0$$\n\n4.  **互补松弛性（Complementary Slackness）**：不等式约束的乘子与其松弛量的乘积必须为零。\n    $$\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$$\n    $$\\mu_{2}^{\\star}(p_{2}^{\\star} - P_{2}^{\\max}) = 0$$\n    $$\\gamma_{1}^{\\star}(-p_{1}^{\\star}) = 0 \\implies \\gamma_{1}^{\\star} p_{1}^{\\star} = 0$$\n    $$\\gamma_{2}^{\\star}(-p_{2}^{\\star}) = 0 \\implies \\gamma_{2}^{\\star} p_{2}^{\\star} = 0$$\n\n现在我们针对两种指定的情景求解该系统。\n\n**情景 A：基准**\n参数为 $a_{1} = 1$，$a_{2} = 3$，$D = 80$，$P_{1}^{\\max} = 100$，$P_{2}^{\\max} = 100$。\n我们首先假设解位于可行域的内部，即所有不等式约束均未激活。这意味着 $0  p_{i}^{\\star}  P_{i}^{\\max}$。根据互补松弛性，此假设意味着 $\\mu_{1}^{\\star} = \\mu_{2}^{\\star} = \\gamma_{1}^{\\star} = \\gamma_{2}^{\\star} = 0$。\n\n稳定性条件简化为：\n$$a_{1} p_{1} - \\lambda = 0 \\implies p_{1} = \\frac{\\lambda}{a_{1}}$$\n$$a_{2} p_{2} - \\lambda = 0 \\implies p_{2} = \\frac{\\lambda}{a_{2}}$$\n将这些代入功率平衡约束中：\n$$\\frac{\\lambda}{a_{1}} + \\frac{\\lambda}{a_{2}} = D \\implies \\lambda \\left(\\frac{1}{a_{1}} + \\frac{1}{a_{2}}\\right) = D$$\n求解 $\\lambda$：\n$$\\lambda^{\\star} = \\frac{D}{\\frac{1}{a_{1}} + \\frac{1}{a_{2}}} = \\frac{D a_{1} a_{2}}{a_{1} + a_{2}}$$\n使用情景 A 的数值：\n$$\\lambda^{\\star}(\\text{A}) = \\frac{80 \\cdot 1 \\cdot 3}{1 + 3} = \\frac{240}{4} = 60$$\n$\\lambda$ 的单位是 $\\$/\\mathrm{MW}$。现在我们求最优调度：\n$$p_{1}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{1}} = \\frac{60}{1} = 60$$\n$$p_{2}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{2}} = \\frac{60}{3} = 20$$\n我们必须验证我们的初始假设，即没有不等式约束是有效的。\n-   $p_{1}^{\\star}(\\text{A}) = 60$。$0  60  100$ 成立吗？是。\n-   $p_{2}^{\\star}(\\text{A}) = 20$。$0  20  100$ 成立吗？是。\n该假设是正确的。不等式约束是松弛的。因此，它们对应的乘子为零：$\\mu_{1}^{\\star}(\\text{A}) = 0$，$\\mu_{2}^{\\star}(\\text{A}) = 0$，$\\gamma_{1}^{\\star}(\\text{A}) = 0$，$\\gamma_{2}^{\\star}(\\text{A}) = 0$。所有 KKT 条件均得到满足。\n所需的值为 $p_{1}^{\\star}(\\text{A}) = 60$，$p_{2}^{\\star}(\\text{A}) = 20$，$\\lambda^{\\star}(\\text{A}) = 60$ 和 $\\mu_{1}^{\\star}(\\text{A}) = 0$。\n\n**情景 B：收紧发电机 1 的容量**\n参数为 $a_{1} = 1$，$a_{2} = 3$，$D = 80$，$P_{1}^{\\max} = 50$，$P_{2}^{\\max} = 100$。\n情景 A 中的无约束解 ($p_1=60$) 违反了新的容量限制 $p_{1} \\leq 50$。这表明约束 $p_{1} \\leq P_{1}^{\\max}$ 在最优点将是激活的（有效的）。\n我们假设 $p_{1}^{\\star} = P_{1}^{\\max} = 50$。\n根据功率平衡约束：\n$$p_{1}^{\\star} + p_{2}^{\\star} = 80 \\implies 50 + p_{2}^{\\star} = 80 \\implies p_{2}^{\\star} = 30$$\n现在我们检查该调度的可行性：\n-   $p_{1}^{\\star}(\\text{B}) = 50$。满足 $0 \\leq 50 \\leq 50$。约束 $p_{1} \\leq P_{1}^{\\max}$ 是激活的。约束 $p_{1} \\geq 0$ 则不是。因此我们预期 $\\mu_{1}^{\\star} \\geq 0$ 且 $\\gamma_{1}^{\\star} = 0$。\n-   $p_{2}^{\\star}(\\text{B}) = 30$。满足 $0 \\leq 30 \\leq 100$。$p_{2}$ 的约束未激活。因此我们预期 $\\mu_{2}^{\\star} = 0$ 且 $\\gamma_{2}^{\\star} = 0$。\n\n当 $\\mu_{2}^{\\star}=0$，$\\gamma_{1}^{\\star}=0$ 且 $\\gamma_{2}^{\\star}=0$ 时，稳定性条件变为：\n$$a_{1} p_{1} - \\lambda + \\mu_{1} = 0$$\n$$a_{2} p_{2} - \\lambda = 0$$\n使用情景 B 的数值和我们的调度解：\n从第二个方程：\n$$3 \\cdot 30 - \\lambda^{\\star} = 0 \\implies \\lambda^{\\star}(\\text{B}) = 90$$\n从第一个方程：\n$$1 \\cdot 50 - 90 + \\mu_{1}^{\\star} = 0 \\implies -40 + \\mu_{1}^{\\star} = 0 \\implies \\mu_{1}^{\\star}(\\text{B}) = 40$$\n我们必须检查对偶可行性：$\\mu_{1}^{\\star}(\\text{B}) = 40 \\geq 0$。此条件得到满足。\n所有 KKT 条件均已满足。最优解为 $p_{1}^{\\star}(\\text{B}) = 50$，$p_{2}^{\\star}(\\text{B}) = 30$，$\\lambda^{\\star}(\\text{B}) = 90$ 和 $\\mu_{1}^{\\star}(\\text{B}) = 40$。\n\n**互补松弛性状态变化分析**\n从情景 A 到情景 B 的转换为我们清晰地展示了互补松弛性和拉格朗日乘子的作用。\n\n-   **在情景 A 中**，发电机 1 的容量限制 $P_{1}^{\\max}=100$ 不是一个限制因素。最优调度为 $p_{1}^{\\star}=60$，远低于该限制。约束 $p_{1} - P_1^{\\max} \\leq 0$ 是**非激活的**，因为存在非零的松弛量：$60 - 100 = -40 \\neq 0$。互补松弛性条件 $\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$ 决定了其对应的乘子必须为零：$\\mu_{1}^{\\star}(\\text{A}) = 0$。其经济学解释是，由于系统并未使用其全部现有容量，边际上增加发电机 1 的容量不会带来任何成本节约。系统的边际能源成本 $\\lambda^{\\star}=60\\,\\$/\\mathrm{MW}$ 由两台发电机相等的边际成本决定：$a_{1} p_{1}^{\\star} = 1 \\cdot 60 = 60$ 和 $a_{2} p_{2}^{\\star} = 3 \\cdot 20 = 60$。\n\n-   **在情景 B 中**，发电机 1 的容量限制被收紧至 $P_{1}^{\\max}=50$。经济上理想的调度 $p_{1}=60$ 不再可行。优化过程被迫将较便宜的发电机 1 的出力限制在其上限，因此 $p_{1}^{\\star}=50$。约束 $p_{1} - P_1^{\\max} \\leq 0$ 现在是**激活的**，因为松弛量为零：$50 - 50 = 0$。对于任何非负的 $\\mu_{1}^{\\star}$，互补松弛性条件 $\\mu_{1}^{\\star}(0) = 0$ 都成立。我们求得 $\\mu_{1}^{\\star}(\\text{B}) = 40$。\n\n-   **状态转换**：约束的收紧迫使其变为激活状态，导致其关联的拉格朗日乘子（影子价格）从零变为一个正值。系统边际价格 $\\lambda^{\\star}$ 现在完全由更昂贵的发电机 2 决定，后者是边际机组：$\\lambda^{\\star}(\\text{B}) = a_{2} p_{2}^{\\star} = 3 \\cdot 30 = 90\\,\\$/\\mathrm{MW}$。发电机 1 的边际成本仅为 $a_{1} p_{1}^{\\star} = 1 \\cdot 50 = 50\\,\\$/\\mathrm{MW}$。乘子 $\\mu_{1}^{\\star} = 40\\,\\$/\\mathrm{MW}$ 代表了系统边际价格与发电机 1 边际成本之间的差值（$\\lambda^{\\star} = a_{1} p_{1}^{\\star} + \\mu_{1}^{\\star} \\implies 90 = 50 + 40$）。该值量化了放松该约束的边际经济效益；如果 $P_{1}^{\\max}$ 增加 $1\\,\\mathrm{MW}$，系统总成本将大约减少 $40\\,\\$$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  20  60  0  50  30  90  40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在应用 KKT 条件解决具体的调度问题之后，本练习将引导您探索其背后更深的数学结构——对偶理论。您将从第一性原理出发，为一个通用的凸二次调度模型构建拉格朗日对偶函数，并推导出相应的对偶问题。这项实践旨在加深您对拉格朗日乘子本质的理解，揭示它们不仅是约束的影子价格，也是对偶问题中的决策变量，从而巩固您在能源系统建模中应用凸优化的理论基础。",
            "id": "4100151",
            "problem": "考虑一个聚合商管理 $N$ 个电气耦合资产的简化日前调度问题，这些资产可以在单个时间周期内注入或吸收净功率。设资产 $i$ 的决策变量为 $x_{i} \\in \\mathbb{R}$，其中 $x_{i} > 0$ 表示净注入，$x_{i}  0$ 表示净吸收。系统必须精确满足外部净需求 $D > 0$。每个资产产生的凸可分离成本建模为 $c_{i}(x_{i}) = \\frac{1}{2} a_{i} x_{i}^{2}$，其中 $a_{i} > 0$，这捕捉了偏离标称工作点的二次边际惩罚。净功率平衡要求通过两个不等式约束表示，这两个约束共同强制实现等式：\n$$\\sum_{i=1}^{N} x_{i} - D \\leq 0 \\quad \\text{和} \\quad D - \\sum_{i=1}^{N} x_{i} \\leq 0.$$\n针对与这两个不等式相关联的非负拉格朗日乘子 $\\lambda \\geq 0$ 和 $\\mu \\geq 0$，构造拉格朗日函数并构建对偶函数 $q(\\lambda,\\mu)$。从拉格朗日函数、对偶函数和 Karush-Kuhn-Tucker (KKT) 条件的核心定义开始，根据凸对偶性的基本原理推导对偶优化问题 $\\max_{\\lambda,\\mu \\geq 0} q(\\lambda,\\mu)$。在能源系统建模的背景下，解释对偶变量的物理释义，包括它们的差值作为系统边际价格的角色。提供对偶函数 $q(\\lambda,\\mu)$ 的解析表达式作为最终答案。不需要进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "用户提供了一个有效的问题陈述。该问题是能源系统经济调度背景下的一个标准凸优化问题，它是适定的，有科学依据，并包含了所有必要的信息。我们可以开始求解。\n\n原优化问题是最小化 $N$ 个资产的总调度成本，并满足功率平衡约束。总成本是各个资产成本之和，$f(x) = \\sum_{i=1}^{N} c_{i}(x_{i}) = \\sum_{i=1}^{N} \\frac{1}{2} a_{i} x_{i}^{2}$。功率平衡约束 $\\sum_{i=1}^{N} x_{i} = D$ 通过两个不等式约束表示：\n$g_1(x) = \\sum_{i=1}^{N} x_{i} - D \\leq 0$\n$g_2(x) = D - \\sum_{i=1}^{N} x_{i} \\leq 0$\n\n原问题可以形式化地表述为：\n$$ \\min_{x \\in \\mathbb{R}^N} \\frac{1}{2} \\sum_{i=1}^{N} a_{i} x_{i}^{2} $$\n$$ \\text{约束条件} \\quad \\sum_{i=1}^{N} x_{i} - D \\leq 0 $$\n$$ \\quad D - \\sum_{i=1}^{N} x_{i} \\leq 0 $$\n\n为了求得对偶函数，我们首先通过将约束条件以其各自的非负拉格朗日乘子 $\\lambda \\geq 0$ 和 $\\mu \\geq 0$ 加权后引入目标函数，从而构造拉格朗日函数 $\\mathcal{L}(x, \\lambda, \\mu)$。\n$$ \\mathcal{L}(x, \\lambda, \\mu) = f(x) + \\lambda g_1(x) + \\mu g_2(x) $$\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} \\sum_{i=1}^{N} a_{i} x_{i}^{2} + \\lambda \\left( \\sum_{i=1}^{N} x_{i} - D \\right) + \\mu \\left( D - \\sum_{i=1}^{N} x_{i} \\right) $$\n我们可以重排各项，按决策变量 $x_i$ 进行分组：\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + \\lambda x_{i} - \\mu x_{i} \\right) - \\lambda D + \\mu D $$\n$$ \\mathcal{L}(x, \\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) + (\\mu - \\lambda) D $$\n\n对偶函数 $q(\\lambda, \\mu)$ 定义为拉格朗日函数关于原变量 $x = (x_1, \\dots, x_N)$ 的下确界：\n$$ q(\\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^N} \\mathcal{L}(x, \\lambda, \\mu) $$\n由于拉格朗日函数关于变量 $x_i$ 是可分离的，我们可以通过独立地最小化求和中的每一项来找到下确界：\n$$ q(\\lambda, \\mu) = \\sum_{i=1}^{N} \\left( \\inf_{x_i \\in \\mathbb{R}} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) \\right) + (\\mu - \\lambda) D $$\n求和中的每一项都是关于 $x_i$ 的凸二次函数（因为 $a_i  0$）。通过将其关于 $x_i$ 的偏导数设为零来找到最小值。这对应于 Karush-Kuhn-Tucker (KKT) 条件的平稳性条件。\n$$ \\frac{\\partial}{\\partial x_i} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) = a_{i} x_{i} + (\\lambda - \\mu) = 0 $$\n求解在 $\\lambda$ 和 $\\mu$ 固定时使拉格朗日函数最小化的 $x_i$ 的值，记为 $x_i^*(\\lambda, \\mu)$：\n$$ x_i^*(\\lambda, \\mu) = -\\frac{\\lambda - \\mu}{a_i} = \\frac{\\mu - \\lambda}{a_i} $$\n将 $x_i^*$ 的这个表达式代回到被最小化的项中：\n$$ \\inf_{x_i} \\left( \\frac{1}{2} a_{i} x_{i}^{2} + (\\lambda - \\mu) x_{i} \\right) = \\frac{1}{2} a_{i} \\left( \\frac{\\mu - \\lambda}{a_i} \\right)^2 + (\\lambda - \\mu) \\left( \\frac{\\mu - \\lambda}{a_i} \\right) $$\n$$ = \\frac{a_i (\\mu - \\lambda)^2}{2 a_i^2} - \\frac{(\\mu - \\lambda)^2}{a_i} = \\frac{(\\mu - \\lambda)^2}{2 a_i} - \\frac{2(\\mu - \\lambda)^2}{2 a_i} = -\\frac{(\\mu - \\lambda)^2}{2 a_i} $$\n现在，我们将此结果对所有 $i$ 求和，并加上常数项，得到对偶函数：\n$$ q(\\lambda, \\mu) = \\sum_{i=1}^{N} \\left( -\\frac{(\\mu - \\lambda)^2}{2 a_i} \\right) + (\\mu - \\lambda) D $$\n$$ q(\\lambda, \\mu) = -\\frac{1}{2} (\\mu - \\lambda)^2 \\sum_{i=1}^{N} \\frac{1}{a_i} + (\\mu - \\lambda) D $$\n这就是对偶函数的解析表达式。\n\n对偶优化问题在于最大化该对偶函数，同时满足对偶变量的非负性约束：\n$$ \\max_{\\lambda, \\mu} \\quad q(\\lambda, \\mu) $$\n$$ \\text{约束条件} \\quad \\lambda \\geq 0, \\quad \\mu \\geq 0 $$\n\n在能源系统的背景下，对偶变量（拉格朗日乘子）具有清晰的物理和经济释义。它们代表了相关约束的影子价格，即约束每松弛一个单位，最优目标值（总成本）的边际变化。\n- 乘子 $\\lambda$ 与约束 $\\sum x_i \\leq D$ 相关联。它代表了防止供过于求的边际成本，或生产超过需求 $D$ 的惩罚。\n- 乘子 $\\mu$ 与约束 $\\sum x_i \\geq D$ 相关联。它代表了防止供不应求的边际成本，或未能满足需求 $D$ 的惩罚。\n- 量 $\\nu = \\mu - \\lambda$ 至关重要。从平稳性条件 $a_i x_i = \\mu - \\lambda$ 中，我们看到在最优解处，每个资产的边际成本 $\\frac{d c_i}{d x_i} = a_i x_i$ 必须等于这个共同值 $\\nu$。这个值 $\\nu$ 就是**系统边际价格 (system marginal price, SMP)**。它是能源的均衡市场出清价格——即在维持功率平衡的同时，向系统供应一个额外边际单位功率的成本。使用两个相反的不等式约束来强制实现等式，允许将这个系统价格分解为反映供不应求和供过于求成本的两个部分。在该问题的典型解中，当 $D0$ 时，我们会发现 $\\lambda^*=0$ 且 $\\mu^*0$，这意味着SMP完全由满足需求的成本驱动，而没有与发电过剩相关的价格信号。",
            "answer": "$$\n\\boxed{-\\frac{1}{2} (\\mu - \\lambda)^2 \\sum_{i=1}^{N} \\frac{1}{a_i} + (\\mu - \\lambda) D}\n$$"
        }
    ]
}