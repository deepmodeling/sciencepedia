{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the foundation of economic dispatch. By solving a problem with only a power balance equality constraint, you will use the method of Lagrange multipliers to derive the classic principle of equal marginal costs, a cornerstone of electricity market theory. This exercise provides a clear, uncluttered view of how the system's marginal price, or shadow price ($\\lambda$), emerges from the optimization framework .",
            "id": "4100167",
            "problem": "Consider a single-period, single-bus economic dispatch problem in energy systems modeling. There are $3$ thermal generators indexed by $i \\in \\{1,2,3\\}$, each producing power $p_i \\ge 0$ (in $\\mathrm{MW}$). The total demand at the bus is $D$ (in $\\mathrm{MW}$), and the network is lossless. Each generator has a strictly convex quadratic production cost\n$$\nC_i(p_i) \\;=\\; a_i\\,p_i^2 \\;+\\; b_i\\,p_i \\;+\\; c_i,\n$$\nwith coefficients\n$$\na_1 \\;=\\; \\frac{1}{50}, \\quad b_1 \\;=\\; 10, \\quad c_1 \\;=\\; 0, \\qquad\na_2 \\;=\\; \\frac{1}{40}, \\quad b_2 \\;=\\; 8, \\quad c_2 \\;=\\; 50, \\qquad\na_3 \\;=\\; \\frac{1}{30}, \\quad b_3 \\;=\\; 12, \\quad c_3 \\;=\\; 100,\n$$\nand the power balance equality constraint\n$$\n\\sum_{i=1}^{3} p_i \\;=\\; D, \\qquad \\text{with } D \\;=\\; 210.\n$$\nYou are to derive, from first principles, the optimality conditions using the Karush–Kuhn–Tucker (KKT) conditions, construct the Lagrangian, and solve for the optimal dispatch $(p_1,p_2,p_3)$ and the associated Lagrange multiplier $\\lambda$ for the power balance constraint (the system shadow price, in $\\$/\\mathrm{MWh}$). Assume no upper bounds on $p_i$ and ignore nonnegativity of $p_i$ if it is not binding at optimum.\n\nStarting from the formal definition of the constrained optimization problem and the equality-constrained KKT framework, derive the first-order optimality conditions and solve the resulting system to obtain closed-form expressions for $p_i$ and $\\lambda$ in terms of $\\{a_i,b_i\\}$ and $D$. Then evaluate these expressions numerically for the given data.\n\nExpress the final dispatch in $\\mathrm{MW}$ and the shadow price in $\\$/\\mathrm{MWh}$. Round each reported quantity to four significant figures. Provide your final numerical answer as a single row vector $\\big(p_1,\\,p_2,\\,p_3,\\,\\lambda\\big)$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n-   Number of generators: $3$, indexed by $i \\in \\{1, 2, 3\\}$.\n-   Power output of generator $i$: $p_i \\ge 0$ (in $\\mathrm{MW}$).\n-   Cost function for generator $i$: $C_i(p_i) = a_i p_i^2 + b_i p_i + c_i$.\n-   Cost coefficients:\n    -   $a_1 = \\frac{1}{50}$, $b_1 = 10$, $c_1 = 0$.\n    -   $a_2 = \\frac{1}{40}$, $b_2 = 8$, $c_2 = 50$.\n    -   $a_3 = \\frac{1}{30}$, $b_3 = 12$, $c_3 = 100$.\n-   Total demand: $D = 210$ (in $\\mathrm{MW}$).\n-   Power balance equality constraint: $\\sum_{i=1}^{3} p_i = D$.\n-   Instruction: Ignore non-negativity constraints $p_i \\ge 0$ if they are not binding at the optimum.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a classic economic dispatch formulation, a fundamental concept in power systems engineering. The quadratic cost functions are a standard and valid approximation of generator cost curves. All aspects are consistent with established scientific and engineering principles.\n-   **Well-Posed:** The objective function, being a sum of strictly convex functions (since $a_i  0$ for all $i$), is strictly convex. The constraints are linear. This structure defines a convex optimization problem, which guarantees that a unique global minimum exists. The problem is therefore well-posed.\n-   **Objective:** The problem is stated with precise mathematical definitions and objective language.\n-   **Completeness and Consistency:** All necessary data (cost coefficients, demand level) and constraints are provided. The instructions are unambiguous. The problem is self-contained and free of contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to minimize the total generation cost, subject to meeting the demand. This can be formulated as a constrained optimization problem.\n\nThe total cost function is the sum of the individual generator costs:\n$$\nf(p_1, p_2, p_3) = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i)\n$$\nThe problem is to minimize this function subject to the power balance equality constraint:\n$$\nh(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - D = 0\n$$\nThe problem states to ignore the non-negativity constraints $p_i \\ge 0$ as a first step. We will solve the problem with only the equality constraint and verify the non-negativity of the solution afterward.\n\nWe use the method of Lagrange multipliers to solve this equality-constrained optimization problem. The Lagrangian function, $\\mathcal{L}$, is constructed as:\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = f(p_1, p_2, p_3) - \\lambda \\, h(p_1, p_2, p_3)\n$$\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i) - \\lambda \\left( \\sum_{i=1}^{3} p_i - D \\right)\n$$\nThe variable $\\lambda$ is the Lagrange multiplier associated with the power balance constraint. It represents the system's marginal cost of energy, or shadow price, in units of $\\$ / \\mathrm{MWh}$.\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality require that the gradient of the Lagrangian with respect to all variables ($p_1, p_2, p_3, \\lambda$) be zero. For an equality-constrained problem (ignoring the inequality constraints for now), these are the first-order necessary conditions.\n\nThe stationarity conditions are obtained by setting the partial derivatives of $\\mathcal{L}$ with respect to each $p_i$ to zero:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ (a_i p_i^2 + b_i p_i + c_i) - \\lambda p_i \\right] = 2 a_i p_i + b_i - \\lambda = 0\n$$\nThis must hold for each generator $i \\in \\{1, 2, 3\\}$. This condition, $2 a_i p_i + b_i = \\lambda$, states that for optimal dispatch, the marginal cost of production, $\\frac{dC_i}{dp_i} = 2 a_i p_i + b_i$, must be equal for all dispatched generators. This common value is the system marginal price, $\\lambda$.\n\nFrom this condition, we can express the optimal power output $p_i$ for each generator as a function of $\\lambda$:\n$$\np_i = \\frac{\\lambda - b_i}{2 a_i}\n$$\nThe primal feasibility condition is simply the original equality constraint, which can also be found by setting the partial derivative of $\\mathcal{L}$ with respect to $\\lambda$ to zero:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left( \\sum_{i=1}^{3} p_i - D \\right) = 0 \\quad \\implies \\quad \\sum_{i=1}^{3} p_i = D\n$$\nTo find the value of $\\lambda$, we substitute the expression for $p_i$ into the power balance equation:\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda - b_i}{2 a_i} = D\n$$\nWe can now solve this equation for $\\lambda$.\n$$\n\\sum_{i=1}^{3} \\left( \\frac{\\lambda}{2 a_i} - \\frac{b_i}{2 a_i} \\right) = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) - \\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) = D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}\n$$\nThis gives the closed-form expression for the system shadow price $\\lambda$:\n$$\n\\lambda = \\frac{D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}}{\\sum_{i=1}^{3} \\frac{1}{2 a_i}}\n$$\nNow, we substitute the given numerical values to find the solution.\nThe coefficients are: $a_1 = \\frac{1}{50}$, $b_1 = 10$; $a_2 = \\frac{1}{40}$, $b_2 = 8$; $a_3 = \\frac{1}{30}$, $b_3 = 12$; and $D = 210$.\n\nFirst, calculate the terms in the sums:\n$$\n\\frac{1}{2a_1} = \\frac{1}{2(\\frac{1}{50})} = 25, \\quad \\frac{1}{2a_2} = \\frac{1}{2(\\frac{1}{40})} = 20, \\quad \\frac{1}{2a_3} = \\frac{1}{2(\\frac{1}{30})} = 15\n$$\n$$\n\\sum_{i=1}^{3} \\frac{1}{2 a_i} = 25 + 20 + 15 = 60\n$$\nNext, calculate the terms for the second sum:\n$$\n\\frac{b_1}{2a_1} = 10 \\times 25 = 250, \\quad \\frac{b_2}{2a_2} = 8 \\times 20 = 160, \\quad \\frac{b_3}{2a_3} = 12 \\times 15 = 180\n$$\n$$\n\\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = 250 + 160 + 180 = 590\n$$\nNow, we can compute $\\lambda$:\n$$\n\\lambda = \\frac{210 + 590}{60} = \\frac{800}{60} = \\frac{40}{3} \\approx 13.3333...\n$$\nWith the value of $\\lambda$, we find the optimal power dispatch for each generator:\n$$\np_1 = \\frac{\\lambda - b_1}{2 a_1} = \\left(\\frac{40}{3} - 10\\right) \\times 25 = \\left(\\frac{40 - 30}{3}\\right) \\times 25 = \\frac{10}{3} \\times 25 = \\frac{250}{3} \\approx 83.3333...\n$$\n$$\np_2 = \\frac{\\lambda - b_2}{2 a_2} = \\left(\\frac{40}{3} - 8\\right) \\times 20 = \\left(\\frac{40 - 24}{3}\\right) \\times 20 = \\frac{16}{3} \\times 20 = \\frac{320}{3} \\approx 106.6666...\n$$\n$$\np_3 = \\frac{\\lambda - b_3}{2 a_3} = \\left(\\frac{40}{3} - 12\\right) \\times 15 = \\left(\\frac{40 - 36}{3}\\right) \\times 15 = \\frac{4}{3} \\times 15 = 20\n$$\nWe check the validity of this solution. First, the power balance constraint:\n$$\n\\sum_{i=1}^{3} p_i = \\frac{250}{3} + \\frac{320}{3} + 20 = \\frac{570}{3} + 20 = 190 + 20 = 210 = D\n$$\nThe constraint is satisfied.\nNext, we check the non-negativity. The calculated values are $p_1 \\approx 83.33  0$, $p_2 \\approx 106.67  0$, and $p_3 = 20  0$. Since all $p_i$ are positive, the non-negativity constraints $p_i \\ge 0$ are not binding. This means that the full KKT conditions, which would include complementary slackness multipliers for these constraints, are satisfied with those multipliers being zero. Thus, the solution is the correct and optimal dispatch.\n\nFinally, we round the numerical results to four significant figures as requested:\n-   $p_1 = \\frac{250}{3} \\approx 83.33 \\ \\mathrm{MW}$\n-   $p_2 = \\frac{320}{3} \\approx 106.7 \\ \\mathrm{MW}$\n-   $p_3 = 20.00 \\ \\mathrm{MW}$\n-   $\\lambda = \\frac{40}{3} \\approx 13.33 \\ \\$/\\mathrm{MWh}$\n\nThe final answer is the row vector $(p_1, p_2, p_3, \\lambda)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 83.33  106.7  20.00  13.33 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world generators have physical limits, which we model as inequality constraints. This exercise builds upon the basic dispatch problem by incorporating upper capacity bounds, requiring the use of the full Karush-Kuhn–Tucker (KKT) conditions. You will practice applying stationarity, primal and dual feasibility, and complementary slackness to determine the optimal dispatch when some generators may be operating at their maximum output .",
            "id": "4100124",
            "problem": "A single-bus electricity system must meet a fixed demand with three thermal generators. Each generator has a strictly convex quadratic variable cost that models fuel consumption. Let the decision variables be the real powers $p_{1}$, $p_{2}$, and $p_{3}$ produced by generators $1$, $2$, and $3$, respectively. The costs are\n$$\nC_{i}(p_{i}) \\;=\\; \\frac{1}{2}\\,c_{i}\\,p_{i}^{2} \\;+\\; d_{i}\\,p_{i}, \\quad i \\in \\{1,2,3\\},\n$$\nwith coefficients $c_{1} = 0.3$, $c_{2} = 0.2$, $c_{3} = 0.1$ and $d_{1} = 12$, $d_{2} = 10$, $d_{3} = 8$. The system demand is $D = 90\\,\\mathrm{MW}$. Generators have upper capacity constraints $p_{1} \\leq 40\\,\\mathrm{MW}$, $p_{2} \\leq 60\\,\\mathrm{MW}$, and $p_{3} \\leq 50\\,\\mathrm{MW}$. Assume nonnegativity $p_{i} \\geq 0$ holds implicitly and is not active at the optimum.\n\nFormulate and solve the quadratic economic dispatch problem\n$$\n\\min_{p_{1},p_{2},p_{3}} \\;\\; C_{1}(p_{1}) + C_{2}(p_{2}) + C_{3}(p_{3})\n$$\nsubject to the energy balance equality constraint\n$$\np_{1} + p_{2} + p_{3} \\;=\\; D\n$$\nand the upper bound inequality constraints\n$$\np_{i} \\;-\\; \\overline{p}_{i} \\;\\leq\\; 0, \\quad \\overline{p}_{1} = 40, \\; \\overline{p}_{2} = 60, \\; \\overline{p}_{3} = 50.\n$$\n\nUsing the Karush–Kuhn–Tucker (KKT) conditions, explicitly derive the optimal dispatch $p_{1}^{\\star}$, $p_{2}^{\\star}$, $p_{3}^{\\star}$, the Lagrange multiplier $\\lambda^{\\star}$ associated with the energy balance, and the Lagrange multipliers $\\mu_{1}^{\\star}$, $\\mu_{2}^{\\star}$, $\\mu_{3}^{\\star}$ associated with the upper bound constraints. Report $p_{i}^{\\star}$ in $\\mathrm{MW}$ and the multipliers in monetary units per $\\mathrm{MW}$. No rounding is required; give exact values. Finally, write the numerical values as the ordered tuple $(p_{1}^{\\star}, p_{2}^{\\star}, p_{3}^{\\star}, \\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\mu_{3}^{\\star})$.",
            "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n- **Objective Function**: Minimize $C(p_1, p_2, p_3) = \\sum_{i=1}^{3} C_{i}(p_{i})$, where $C_{i}(p_{i}) = \\frac{1}{2}c_{i}p_{i}^{2} + d_{i}p_{i}$.\n- **Cost Coefficients**:\n  - $c_1 = 0.3$, $c_2 = 0.2$, $c_3 = 0.1$.\n  - $d_1 = 12$, $d_2 = 10$, $d_3 = 8$.\n- **Decision Variables**: $p_1, p_2, p_3$.\n- **Equality Constraint**: $p_1 + p_2 + p_3 = D$, with $D=90$.\n- **Inequality Constraints**: $p_i \\leq \\overline{p}_i$ for $i \\in \\{1,2,3\\}$, where:\n  - $\\overline{p}_1 = 40$.\n  - $\\overline{p}_2 = 60$.\n  - $\\overline{p}_3 = 50$.\n- **Implicit Assumption**: $p_i \\geq 0$ constraints are not active at the optimum.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a classic economic dispatch formulation used in power systems engineering. The quadratic cost functions and constraints are standard and physically meaningful models.\n- **Well-Posed**: The objective function $C(p_1, p_2, p_3)$ is a sum of strictly convex functions, and is therefore strictly convex. The constraints are all linear (affine), defining a convex feasible set. The minimization of a strictly convex function over a non-empty convex set has a unique solution. The sum of generator capacities ($40+60+50=150$) exceeds the demand ($90$), so the feasible set is non-empty. The problem is well-posed.\n- **Objective**: The problem is defined with precise mathematical notation and contains no subjective or ambiguous language.\n- **Completeness and Consistency**: All necessary data are provided, and no contradictions exist.\n\n### Step 3: Verdict and Action\nThe problem is valid. A rigorous solution based on the Karush–Kuhn–Tucker (KKT) conditions will be derived.\n\nThe optimization problem is formulated as follows:\n$$\n\\min_{p_1, p_2, p_3} \\sum_{i=1}^{3} \\left(\\frac{1}{2}c_{i}p_{i}^{2} + d_{i}p_{i}\\right)\n$$\nsubject to:\n\\begin{align*}\n p_1 + p_2 + p_3 - D = 0 \\\\\n p_i - \\overline{p}_i \\leq 0, \\quad \\text{for } i \\in \\{1,2,3\\}\n\\end{align*}\n\nTo solve this, we form the Lagrangian function, $\\mathcal{L}$, with Lagrange multiplier $\\lambda$ for the equality constraint and multipliers $\\mu_1, \\mu_2, \\mu_3$ for the inequality constraints.\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda, \\mu_1, \\mu_2, \\mu_3) = \\sum_{i=1}^{3} \\left(\\frac{1}{2}c_{i}p_{i}^{2} + d_{i}p_{i}\\right) + \\lambda(p_1 + p_2 + p_3 - D) + \\sum_{i=1}^{3} \\mu_i(p_i - \\overline{p}_i)\n$$\n\nThe Karush–Kuhn–Tucker (KKT) conditions for an optimal solution $(p_1^\\star, p_2^\\star, p_3^\\star, \\lambda^\\star, \\mu_1^\\star, \\mu_2^\\star, \\mu_3^\\star)$ are:\n\n1.  **Stationarity**: $\\frac{\\partial \\mathcal{L}}{\\partial p_i} = 0$ for $i=1,2,3$.\n    $$\n    c_i p_i^\\star + d_i + \\lambda^\\star + \\mu_i^\\star = 0\n    $$\n2.  **Primal Feasibility**:\n    $$\n    p_1^\\star + p_2^\\star + p_3^\\star - D = 0\n    $$\n    $$\n    p_i^\\star - \\overline{p}_i \\leq 0\n    $$\n3.  **Dual Feasibility**:\n    $$\n    \\mu_i^\\star \\geq 0\n    $$\n4.  **Complementary Slackness**:\n    $$\n    \\mu_i^\\star (p_i^\\star - \\overline{p}_i) = 0\n    $$\n\nFrom the stationarity condition, we have $p_i^\\star = \\frac{-\\lambda^\\star - d_i - \\mu_i^\\star}{c_i}$. The complementary slackness condition implies that for each generator $i$, either its capacity constraint is inactive ($p_i^\\star  \\overline{p}_i$ and $\\mu_i^\\star=0$) or it is active ($p_i^\\star = \\overline{p}_i$ and $\\mu_i^\\star \\geq 0$).\n\nWe proceed by analyzing cases.\n\n**Case 1: Assume no capacity constraints are active.**\nIn this case, $\\mu_1^\\star = \\mu_2^\\star = \\mu_3^\\star = 0$. The stationarity conditions simplify to $c_i p_i + d_i + \\lambda = 0$, which implies that the marginal cost, $MC_i(p_i) = c_i p_i + d_i$, is equal for all generators: $MC_i = -\\lambda$.\nFrom this, we express each $p_i$ in terms of $\\lambda$:\n$$\np_i = \\frac{-\\lambda - d_i}{c_i}\n$$\nSubstituting these into the energy balance equation, $p_1 + p_2 + p_3 = D$:\n$$\n\\frac{-\\lambda - d_1}{c_1} + \\frac{-\\lambda - d_2}{c_2} + \\frac{-\\lambda - d_3}{c_3} = D\n$$\nSolving for $\\lambda$:\n$$\n-\\lambda \\left(\\frac{1}{c_1} + \\frac{1}{c_2} + \\frac{1}{c_3}\\right) = D + \\frac{d_1}{c_1} + \\frac{d_2}{c_2} + \\frac{d_3}{c_3}\n$$\nPlugging in the given values:\n- $D = 90$\n- $\\frac{1}{c_1} = \\frac{1}{0.3} = \\frac{10}{3}$; $\\frac{d_1}{c_1} = \\frac{12}{0.3} = 40$\n- $\\frac{1}{c_2} = \\frac{1}{0.2} = 5$; $\\frac{d_2}{c_2} = \\frac{10}{0.2} = 50$\n- $\\frac{1}{c_3} = \\frac{1}{0.1} = 10$; $\\frac{d_3}{c_3} = \\frac{8}{0.1} = 80$\n\nSo,\n$$\n-\\lambda \\left(\\frac{10}{3} + 5 + 10\\right) = 90 + 40 + 50 + 80\n$$\n$$\n-\\lambda \\left(\\frac{55}{3}\\right) = 260\n$$\n$$\n-\\lambda = \\frac{260 \\times 3}{55} = \\frac{52 \\times 3}{11} = \\frac{156}{11}\n$$\nNow, we calculate the power outputs:\n$p_1 = \\frac{-\\lambda - d_1}{c_1} = \\frac{156/11 - 12}{0.3} = \\frac{(156 - 132)/11}{0.3} = \\frac{24/11}{0.3} = \\frac{80}{11} \\approx 7.27$. Since $80/11  40$, this is valid.\n$p_2 = \\frac{-\\lambda - d_2}{c_2} = \\frac{156/11 - 10}{0.2} = \\frac{(156 - 110)/11}{0.2} = \\frac{46/11}{0.2} = \\frac{230}{11} \\approx 20.91$. Since $230/11  60$, this is valid.\n$p_3 = \\frac{-\\lambda - d_3}{c_3} = \\frac{156/11 - 8}{0.1} = \\frac{(156 - 88)/11}{0.1} = \\frac{68/11}{0.1} = \\frac{680}{11} \\approx 61.82$. This violates the constraint $p_3 \\leq 50$.\nTherefore, the initial assumption is incorrect.\n\n**Case 2: Assume generator 3 is at its capacity limit.**\nWe set $p_3^\\star = \\overline{p}_3 = 50$. By complementary slackness, $\\mu_3^\\star \\geq 0$. We assume generators $1$ and $2$ are not at their limits, so $\\mu_1^\\star = 0$ and $\\mu_2^\\star = 0$.\nThe problem reduces to dispatching generators $1$ and $2$ to meet the remaining demand, $D' = D - p_3^\\star = 90 - 50 = 40$.\nThe equal marginal cost principle applies to generators $1$ and $2$:\n$$\nc_1 p_1 + d_1 = c_2 p_2 + d_2 = -\\lambda\n$$\nThe new system of equations for $p_1, p_2, \\lambda$ is:\n$$\np_1 = \\frac{-\\lambda - d_1}{c_1}, \\quad p_2 = \\frac{-\\lambda - d_2}{c_2}, \\quad p_1 + p_2 = 40\n$$\nSubstituting expressions for $p_1$ and $p_2$ into their sum:\n$$\n\\frac{-\\lambda - d_1}{c_1} + \\frac{-\\lambda - d_2}{c_2} = 40\n$$\n$$\n-\\lambda \\left(\\frac{1}{c_1} + \\frac{1}{c_2}\\right) = 40 + \\frac{d_1}{c_1} + \\frac{d_2}{c_2}\n$$\nPlugging in values:\n$$\n-\\lambda \\left(\\frac{10}{3} + 5\\right) = 40 + 40 + 50\n$$\n$$\n-\\lambda \\left(\\frac{25}{3}\\right) = 130\n$$\n$$\n-\\lambda = \\frac{130 \\times 3}{25} = \\frac{26 \\times 3}{5} = \\frac{78}{5} = 15.6\n$$\nThus, $\\lambda^\\star = -15.6 = -\\frac{78}{5}$.\nNow we calculate $p_1^\\star$ and $p_2^\\star$:\n$p_1^\\star = \\frac{-\\lambda^\\star - d_1}{c_1} = \\frac{15.6 - 12}{0.3} = \\frac{3.6}{0.3} = 12$. This satisfies $p_1^\\star  40$.\n$p_2^\\star = \\frac{-\\lambda^\\star - d_2}{c_2} = \\frac{15.6 - 10}{0.2} = \\frac{5.6}{0.2} = 28$. This satisfies $p_2^\\star  60$.\nThe optimal dispatch is $p_1^\\star = 12$, $p_2^\\star = 28$, $p_3^\\star = 50$.\nLet's check the total generation: $12 + 28 + 50 = 90$, which meets the demand $D=90$.\n\nFinally, we find $\\mu_3^\\star$ from the stationarity condition for generator $3$:\n$$\nc_3 p_3^\\star + d_3 + \\lambda^\\star + \\mu_3^\\star = 0\n$$\n$$\n\\mu_3^\\star = - (c_3 p_3^\\star + d_3 + \\lambda^\\star)\n$$\nSubstituting the known values:\n$$\n\\mu_3^\\star = - (0.1 \\times 50 + 8 + (-15.6)) = - (5 + 8 - 15.6) = - (13 - 15.6) = 2.6\n$$\nSo, $\\mu_3^\\star = 2.6 = \\frac{13}{5}$. This value satisfies the dual feasibility condition $\\mu_3^\\star \\ge 0$.\nThe other multipliers are $\\mu_1^\\star = 0$ and $\\mu_2^\\star = 0$. All KKT conditions are met. As the problem is convex, this unique solution is the global optimum.\n\nThe solution is:\n- $p_1^\\star = 12$\n- $p_2^\\star = 28$\n- $p_3^\\star = 50$\n- $\\lambda^\\star = -15.6 = -\\frac{78}{5}$\n- $\\mu_1^\\star = 0$\n- $\\mu_2^\\star = 0$\n- $\\mu_3^\\star = 2.6 = \\frac{13}{5}$\n\nThe ordered tuple $(p_{1}^{\\star}, p_{2}^{\\star}, p_{3}^{\\star}, \\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\mu_{3}^{\\star})$ is $(12, 28, 50, -15.6, 0, 0, 2.6)$, or in exact fractional form $(12, 28, 50, -\\frac{78}{5}, 0, 0, \\frac{13}{5})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12  28  50  -\\frac{78}{5}  0  0  \\frac{13}{5}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The Lagrange multipliers in a KKT framework are not just mathematical artifacts; they have profound economic meaning. This practice uses a comparative analysis of two scenarios to make the concept of shadow prices tangible. By observing how the optimal solution and its multipliers change when a capacity constraint becomes binding, you will gain a deeper intuition for complementary slackness and how multipliers quantify the economic value of relaxing a constraint .",
            "id": "4100093",
            "problem": "Consider a single-period economic dispatch problem for a two-generator system commonly used in energy systems modeling. Let generator outputs be $p_{1}$ and $p_{2}$ (in megawatts, MW), and let the total electrical demand be $D$ (in MW). Each generator $i \\in \\{1,2\\}$ has a convex quadratic operating cost given by $C_{i}(p_{i}) = \\frac{1}{2} a_{i} p_{i}^{2}$, where $a_{i}$ has units of dollars per megawatt squared ($\\$/\\mathrm{MW}^{2}$). The system must satisfy the power balance and capacity limits, and outputs must be nonnegative. Formulate and solve this dispatch problem by applying the Karush–Kuhn–Tucker (KKT) conditions, and use the solution to illustrate how tightening a capacity limit changes complementary slackness status and modifies the optimal multipliers and dispatch.\n\nUse the following two scenarios with a one-hour operating interval (so MW and megawatt-hours, MWh, are numerically equal):\n\nScenario A (baseline): $a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$, $a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$, $D = 80\\,\\mathrm{MW}$, $P_{1}^{\\max} = 100\\,\\mathrm{MW}$, $P_{2}^{\\max} = 100\\,\\mathrm{MW}$.\n\nScenario B (tightened capacity for generator $1$): $a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$, $a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$, $D = 80\\,\\mathrm{MW}$, $P_{1}^{\\max} = 50\\,\\mathrm{MW}$, $P_{2}^{\\max} = 100\\,\\mathrm{MW}$.\n\nTasks:\n- Derive the KKT conditions from first principles of convex optimization and Lagrangian duality for the problem of minimizing total cost $C(p_{1},p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}$ subject to power balance $p_{1} + p_{2} = D$, capacity constraints $p_{i} \\leq P_{i}^{\\max}$, and nonnegativity constraints $p_{i} \\geq 0$.\n- Solve the KKT system to find the optimal dispatches $p_{1}^{\\star}$ and $p_{2}^{\\star}$, the optimal Lagrange multiplier for the power balance constraint $\\lambda^{\\star}$ (in $\\$/\\mathrm{MW}$), and the optimal Lagrange multiplier for generator $1$’s capacity constraint $\\mu_{1}^{\\star}$ (in $\\$/\\mathrm{MW}$), for both Scenario A and Scenario B.\n- In your reasoning, identify the complementary slackness status of generator $1$’s capacity constraint in each scenario and explain the switch when moving from Scenario A to Scenario B.\n\nExpress dispatch quantities in megawatts (MW) and dual variables in dollars per megawatt ($\\$/\\mathrm{MW}$). For the final boxed answer, report only the numerical values without units, ordered as a single row matrix:\n$\\big[p_{1}^{\\star}\\text{(A)},\\;p_{2}^{\\star}\\text{(A)},\\;\\lambda^{\\star}\\text{(A)},\\;\\mu_{1}^{\\star}\\text{(A)},\\;p_{1}^{\\star}\\text{(B)},\\;p_{2}^{\\star}\\text{(B)},\\;\\lambda^{\\star}\\text{(B)},\\;\\mu_{1}^{\\star}\\text{(B)}\\big]$.\n\nNo rounding is required; provide exact values.",
            "solution": "The problem presents a classic economic dispatch scenario for a two-generator system, which can be formulated as a convex optimization problem. The goal is to minimize the total generation cost subject to meeting a specified demand and respecting the operational limits of the generators.\n\nFirst, we formalize the optimization problem. Let the decision variables be the power outputs of the two generators, $p_{1}$ and $p_{2}$. The objective is to minimize the total cost function, $C(p_{1}, p_{2})$, which is the sum of the individual generator costs:\n$$\n\\text{Minimize } C(p_{1}, p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}\n$$\nThis minimization is subject to several constraints:\n1.  Power balance (equality constraint): The total generation must equal the total demand, $D$.\n    $$p_{1} + p_{2} = D$$\n2.  Generator capacity limits (inequality constraints): Each generator's output cannot exceed its maximum capacity, $P_{i}^{\\max}$.\n    $$p_{1} \\leq P_{1}^{\\max}$$\n    $$p_{2} \\leq P_{2}^{\\max}$$\n3.  Non-negativity (inequality constraints): Power generation cannot be negative.\n    $$p_{1} \\geq 0$$\n    $$p_{2} \\geq 0$$\n\nTo solve this using the Karush–Kuhn–Tucker (KKT) conditions, we first construct the Lagrangian function. We associate a Lagrange multiplier with each constraint. Let $\\lambda$ be the multiplier for the power balance equality constraint. Let $\\mu_{1}$ and $\\mu_{2}$ be the multipliers for the upper capacity limits, and let $\\gamma_{1}$ and $\\gamma_{2}$ be the multipliers for the non-negativity constraints.\n\nTo formulate the Lagrangian, we rewrite the constraints in the standard form $h(x)=0$ and $g(x) \\leq 0$:\n$$h_1(p_1,p_2) = D - p_{1} - p_{2} = 0$$\n$$g_1(p_1) = p_{1} - P_{1}^{\\max} \\leq 0$$\n$$g_2(p_2) = p_{2} - P_{2}^{\\max} \\leq 0$$\n$$g_3(p_1) = -p_{1} \\leq 0$$\n$$g_4(p_2) = -p_{2} \\leq 0$$\n\nThe Lagrangian $\\mathcal{L}$ is given by:\n$$\n\\mathcal{L}(p_{1}, p_{2}, \\lambda, \\mu_{1}, \\mu_{2}, \\gamma_{1}, \\gamma_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2} + \\lambda(D - p_{1} - p_{2}) + \\mu_{1}(p_{1} - P_{1}^{\\max}) + \\mu_{2}(p_{2} - P_{2}^{\\max}) - \\gamma_{1}p_{1} - \\gamma_{2}p_{2}\n$$\nThe KKT conditions for an optimal solution $(p_{1}^{\\star}, p_{2}^{\\star})$ and optimal multipliers $(\\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\gamma_{1}^{\\star}, \\gamma_{2}^{\\star})$ are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $(p_{1}, p_{2})$ must be zero.\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{1}} = a_{1} p_{1} - \\lambda + \\mu_{1} - \\gamma_{1} = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{2}} = a_{2} p_{2} - \\lambda + \\mu_{2} - \\gamma_{2} = 0$$\n    These equations state that at the optimum, the marginal cost of generation for each unit, adjusted for any binding constraints, must equal the system marginal price, $\\lambda$.\n\n2.  **Primal Feasibility**: The original constraints must be satisfied.\n    $$p_{1}^{\\star} + p_{2}^{\\star} = D$$\n    $$p_{1}^{\\star} \\leq P_{1}^{\\max}, \\quad p_{2}^{\\star} \\leq P_{2}^{\\max}$$\n    $$p_{1}^{\\star} \\geq 0, \\quad p_{2}^{\\star} \\geq 0$$\n\n3.  **Dual Feasibility**: The multipliers for all inequality constraints must be non-negative.\n    $$\\mu_{1}^{\\star} \\geq 0, \\quad \\mu_{2}^{\\star} \\geq 0$$\n    $$\\gamma_{1}^{\\star} \\geq 0, \\quad \\gamma_{2}^{\\star} \\geq 0$$\n\n4.  **Complementary Slackness**: The product of an inequality constraint's multiplier and its slack must be zero.\n    $$\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$$\n    $$\\mu_{2}^{\\star}(p_{2}^{\\star} - P_{2}^{\\max}) = 0$$\n    $$\\gamma_{1}^{\\star}(-p_{1}^{\\star}) = 0 \\implies \\gamma_{1}^{\\star} p_{1}^{\\star} = 0$$\n    $$\\gamma_{2}^{\\star}(-p_{2}^{\\star}) = 0 \\implies \\gamma_{2}^{\\star} p_{2}^{\\star} = 0$$\n\nNow we solve this system for the two specified scenarios.\n\n**Scenario A: Baseline**\nThe parameters are $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 100$, and $P_{2}^{\\max} = 100$.\nLet's first assume that the solution is in the interior of the feasible region, meaning none of the inequality constraints are active. This implies $0  p_{i}^{\\star}  P_{i}^{\\max}$. By complementary slackness, this assumption means $\\mu_{1}^{\\star} = \\mu_{2}^{\\star} = \\gamma_{1}^{\\star} = \\gamma_{2}^{\\star} = 0$.\n\nThe stationarity conditions simplify to:\n$$a_{1} p_{1} - \\lambda = 0 \\implies p_{1} = \\frac{\\lambda}{a_{1}}$$\n$$a_{2} p_{2} - \\lambda = 0 \\implies p_{2} = \\frac{\\lambda}{a_{2}}$$\nSubstituting these into the power balance constraint:\n$$\\frac{\\lambda}{a_{1}} + \\frac{\\lambda}{a_{2}} = D \\implies \\lambda \\left(\\frac{1}{a_{1}} + \\frac{1}{a_{2}}\\right) = D$$\nSolving for $\\lambda$:\n$$\\lambda^{\\star} = \\frac{D}{\\frac{1}{a_{1}} + \\frac{1}{a_{2}}} = \\frac{D a_{1} a_{2}}{a_{1} + a_{2}}$$\nUsing the values for Scenario A:\n$$\\lambda^{\\star}(\\text{A}) = \\frac{80 \\cdot 1 \\cdot 3}{1 + 3} = \\frac{240}{4} = 60$$\nThe units of $\\lambda$ are $\\$/\\mathrm{MW}$. Now we find the optimal dispatch:\n$$p_{1}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{1}} = \\frac{60}{1} = 60$$\n$$p_{2}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{2}} = \\frac{60}{3} = 20$$\nWe must verify our initial assumption that no inequality constraints are binding.\n-   $p_{1}^{\\star}(\\text{A}) = 60$. Is $0  60  100$? Yes.\n-   $p_{2}^{\\star}(\\text{A}) = 20$. Is $0  20  100$? Yes.\nThe assumption was correct. The inequality constraints are slack. Therefore, their corresponding multipliers are zero: $\\mu_{1}^{\\star}(\\text{A}) = 0$, $\\mu_{2}^{\\star}(\\text{A}) = 0$, $\\gamma_{1}^{\\star}(\\text{A}) = 0$, $\\gamma_{2}^{\\star}(\\text{A}) = 0$. The KKT conditions are all satisfied.\nThe required values are $p_{1}^{\\star}(\\text{A}) = 60$, $p_{2}^{\\star}(\\text{A}) = 20$, $\\lambda^{\\star}(\\text{A}) = 60$, and $\\mu_{1}^{\\star}(\\text{A}) = 0$.\n\n**Scenario B: Tightened capacity for generator 1**\nThe parameters are $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 50$, and $P_{2}^{\\max} = 100$.\nThe unconstrained solution from Scenario A ($p_1=60$) violates the new capacity limit $p_{1} \\leq 50$. This indicates that the constraint $p_{1} \\leq P_{1}^{\\max}$ will be active (binding) at the optimum.\nLet's assume $p_{1}^{\\star} = P_{1}^{\\max} = 50$.\nFrom the power balance constraint:\n$$p_{1}^{\\star} + p_{2}^{\\star} = 80 \\implies 50 + p_{2}^{\\star} = 80 \\implies p_{2}^{\\star} = 30$$\nNow we check the feasibility of this dispatch:\n-   $p_{1}^{\\star}(\\text{B}) = 50$. This satisfies $0 \\leq 50 \\leq 50$. The constraint $p_{1} \\leq P_{1}^{\\max}$ is active. The constraint $p_{1} \\geq 0$ is not. So we expect $\\mu_{1}^{\\star} \\geq 0$ and $\\gamma_{1}^{\\star} = 0$.\n-   $p_{2}^{\\star}(\\text{B}) = 30$. This satisfies $0 \\leq 30 \\leq 100$. The constraints on $p_{2}$ are not active. So we expect $\\mu_{2}^{\\star} = 0$ and $\\gamma_{2}^{\\star} = 0$.\n\nWith $\\mu_{2}^{\\star}=0$, $\\gamma_{1}^{\\star}=0$, and $\\gamma_{2}^{\\star}=0$, the stationarity conditions become:\n$$a_{1} p_{1} - \\lambda + \\mu_{1} = 0$$\n$$a_{2} p_{2} - \\lambda = 0$$\nUsing the values for Scenario B and our dispatch solution:\nFrom the second equation:\n$$3 \\cdot 30 - \\lambda^{\\star} = 0 \\implies \\lambda^{\\star}(\\text{B}) = 90$$\nFrom the first equation:\n$$1 \\cdot 50 - 90 + \\mu_{1}^{\\star} = 0 \\implies -40 + \\mu_{1}^{\\star} = 0 \\implies \\mu_{1}^{\\star}(\\text{B}) = 40$$\nWe must check dual feasibility: $\\mu_{1}^{\\star}(\\text{B}) = 40 \\geq 0$. This is satisfied.\nAll KKT conditions are met. The optimal solution is $p_{1}^{\\star}(\\text{B}) = 50$, $p_{2}^{\\star}(\\text{B}) = 30$, $\\lambda^{\\star}(\\text{B}) = 90$, and $\\mu_{1}^{\\star}(\\text{B}) = 40$.\n\n**Analysis of Complementary Slackness Status Change**\nThe transition from Scenario A to Scenario B provides a clear illustration of the role of complementary slackness and Lagrange multipliers.\n\n-   **In Scenario A**, the capacity limit on generator 1, $P_{1}^{\\max}=100$, is not a limiting factor. The optimal dispatch is $p_{1}^{\\star}=60$, which is well below the limit. The constraint $p_{1} - P_1^{\\max} \\leq 0$ is **inactive** because there is a non-zero slack: $60 - 100 = -40 \\neq 0$. The complementary slackness condition $\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$ dictates that the corresponding multiplier must be zero: $\\mu_{1}^{\\star}(\\text{A}) = 0$. The economic interpretation is that there would be zero cost savings from a marginal increase in the capacity of generator 1, as the system is not using all of its current capacity. The system marginal cost of energy, $\\lambda^{\\star}=60\\,\\$/\\mathrm{MW}$, is set by the equal marginal costs of both generators: $a_{1} p_{1}^{\\star} = 1 \\cdot 60 = 60$ and $a_{2} p_{2}^{\\star} = 3 \\cdot 20 = 60$.\n\n-   **In Scenario B**, the capacity limit on generator 1 is tightened to $P_{1}^{\\max}=50$. The economically ideal dispatch of $p_{1}=60$ is no longer feasible. The optimization is forced to cap the output of the cheaper generator 1 at its limit, so $p_{1}^{\\star}=50$. The constraint $p_{1} - P_1^{\\max} \\leq 0$ is now **active** because the slack is zero: $50 - 50 = 0$. The complementary slackness condition $\\mu_{1}^{\\star}(0) = 0$ is satisfied for any non-negative $\\mu_{1}^{\\star}$. We found $\\mu_{1}^{\\star}(\\text{B}) = 40$.\n\n-   **The Switch**: The tightening of the constraint forced it to become active, causing its associated Lagrange multiplier (shadow price) to switch from zero to a positive value. The system marginal price $\\lambda^{\\star}$ is now dictated entirely by the more expensive generator 2, which is the marginal unit: $\\lambda^{\\star}(\\text{B}) = a_{2} p_{2}^{\\star} = 3 \\cdot 30 = 90\\,\\$/\\mathrm{MW}$. The marginal cost of generator 1 is only $a_{1} p_{1}^{\\star} = 1 \\cdot 50 = 50\\,\\$/\\mathrm{MW}$. The multiplier $\\mu_{1}^{\\star} = 40\\,\\$/\\mathrm{MW}$ represents the difference between the system marginal price and generator 1's marginal cost ($\\lambda^{\\star} \\approx a_{1} p_{1}^{\\star} + \\mu_{1}^{\\star} \\implies 90 = 50 + 40$). This value quantifies the marginal economic benefit of relaxing the constraint; if $P_{1}^{\\max}$ were increased by $1\\,\\mathrm{MW}$, the total system cost would decrease by approximately $40\\,\\$$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  20  60  0  50  30  90  40\n\\end{pmatrix}\n}\n$$"
        }
    ]
}