{
    "hands_on_practices": [
        {
            "introduction": "我们从基础的经济调度问题开始我们的动手实践。本练习  要求您优化一个仅包含功率平衡等式约束的简单电力系统。通过这个练习，您将能从第一性原理出发，推导出著名的“边际成本相等”准则，并计算出系统的影子价格 $\\lambda$。",
            "id": "4100167",
            "problem": "考虑能源系统建模中的一个单周期、单母线经济调度问题。现有 3 台火力发电机组，索引为 $i \\in \\{1,2,3\\}$，每台机组的发电功率为 $p_i \\ge 0$（单位为 $\\mathrm{MW}$）。母线上的总需求为 $D$（单位为 $\\mathrm{MW}$），且网络无损耗。每台发电机组具有严格凸的二次生产成本\n$$\nC_i(p_i) \\;=\\; a_i\\,p_i^2 \\;+\\; b_i\\,p_i \\;+\\; c_i,\n$$\n其系数为\n$$\na_1 \\;=\\; \\frac{1}{50}, \\quad b_1 \\;=\\; 10, \\quad c_1 \\;=\\; 0, \\qquad\na_2 \\;=\\; \\frac{1}{40}, \\quad b_2 \\;=\\; 8, \\quad c_2 \\;=\\; 50, \\qquad\na_3 \\;=\\; \\frac{1}{30}, \\quad b_3 \\;=\\; 12, \\quad c_3 \\;=\\; 100,\n$$\n以及功率平衡等式约束\n$$\n\\sum_{i=1}^{3} p_i \\;=\\; D, \\qquad \\text{with } D \\;=\\; 210.\n$$\n要求您从第一性原理出发，使用 Karush–Kuhn–Tucker (KKT) 条件推导最优性条件，构建拉格朗日函数，并求解最优调度 $(p_1,p_2,p_3)$ 以及与功率平衡约束相关的拉格朗日乘子 $\\lambda$（即系统影子价格，单位为 $\\$/\\mathrm{MWh}$）。假设 $p_i$ 没有上限，并且如果 $p_i$ 的非负性在最优解处不为约束，则忽略该条件。\n\n从约束优化问题的形式化定义和等式约束的 KKT 框架开始，推导一阶最优性条件，并求解所得方程组，以获得用 $\\{a_i,b_i\\}$ 和 $D$ 表示的 $p_i$ 和 $\\lambda$ 的闭式表达式。然后，使用给定数据对这些表达式进行数值计算。\n\n最终调度结果以 $\\mathrm{MW}$ 表示，影子价格以 $\\$/\\mathrm{MWh}$ 表示。将报告的每个数值四舍五入至四位有效数字。以单行向量 $\\big(p_1,\\,p_2,\\,p_3,\\,\\lambda\\big)$ 的形式提供您的最终数值答案。",
            "solution": "首先对问题进行验证，以确保其科学性、自洽性和适定性。\n\n### 步骤 1：提取已知条件\n- 发电机组数量：$3$，索引为 $i \\in \\{1, 2, 3\\}$。\n- 发电机组 $i$ 的功率输出：$p_i \\ge 0$（单位 $\\mathrm{MW}$）。\n- 发电机组 $i$ 的成本函数：$C_i(p_i) = a_i p_i^2 + b_i p_i + c_i$。\n- 成本系数：\n    - $a_1 = \\frac{1}{50}$，$b_1 = 10$，$c_1 = 0$。\n    - $a_2 = \\frac{1}{40}$，$b_2 = 8$，$c_2 = 50$。\n    - $a_3 = \\frac{1}{30}$，$b_3 = 12$，$c_3 = 100$。\n- 总需求：$D = 210$（单位 $\\mathrm{MW}$）。\n- 功率平衡等式约束：$\\sum_{i=1}^{3} p_i = D$。\n- 说明：如果最优解处的非负约束 $p_i \\ge 0$ 不起作用，则忽略它们。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题是经典的经济调度模型，是电力系统工程中的一个基本概念。二次成本函数是发电机成本曲线的标准有效近似。所有方面都符合既定的科学和工程原理。\n- **适定性：** 目标函数是严格凸函数之和（因为对所有 $i$ 都有 $a_i  0$），因此是严格凸的。约束是线性的。这种结构定义了一个凸优化问题，保证了唯一全局最小值的存在。因此，该问题是适定的。\n- **客观性：** 问题以精确的数学定义和客观的语言陈述。\n- **完整性和一致性：** 提供了所有必要的数据（成本系数、需求水平）和约束。说明清晰明确。问题是自洽的，没有矛盾。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n目标是在满足需求的前提下，最小化总发电成本。这可以表述为一个约束优化问题。\n\n总成本函数是各发电机组成本之和：\n$$\nf(p_1, p_2, p_3) = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i)\n$$\n问题是在功率平衡等式约束条件下最小化此函数：\n$$\nh(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - D = 0\n$$\n问题要求第一步忽略非负性约束 $p_i \\ge 0$。我们将仅使用等式约束来解决问题，然后验证解的非负性。\n\n我们使用拉格朗日乘子法来解决这个等式约束的优化问题。拉格朗日函数 $\\mathcal{L}$ 构建如下：\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = f(p_1, p_2, p_3) - \\lambda \\, h(p_1, p_2, p_3)\n$$\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i + c_i) - \\lambda \\left( \\sum_{i=1}^{3} p_i - D \\right)\n$$\n变量 $\\lambda$ 是与功率平衡约束相关的拉格朗日乘子。它代表系统的边际能源成本，或称影子价格，单位为 $\\$ / \\mathrm{MWh}$。\n\nKarush-Kuhn-Tucker (KKT) 最优性条件要求拉格朗日函数对所有变量（$p_1, p_2, p_3, \\lambda$）的梯度为零。对于一个等式约束问题（暂时忽略不等式约束），这些是一阶必要条件。\n\n通过将 $\\mathcal{L}$ 对每个 $p_i$ 的偏导数设为零，可以得到平稳性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left[ (a_i p_i^2 + b_i p_i + c_i) - \\lambda p_i \\right] = 2 a_i p_i + b_i - \\lambda = 0\n$$\n此条件对每个发电机组 $i \\in \\{1, 2, 3\\}$ 都必须成立。条件 $2 a_i p_i + b_i = \\lambda$ 表明，对于最优调度，所有已调度的发电机组的边际生产成本 $\\frac{dC_i}{dp_i} = 2 a_i p_i + b_i$ 必须相等。这个共同的值就是系统边际价格 $\\lambda$。\n\n根据这个条件，我们可以将每个发电机组的最优功率输出 $p_i$ 表示为 $\\lambda$ 的函数：\n$$\np_i = \\frac{\\lambda - b_i}{2 a_i}\n$$\n原始可行性条件就是原始的等式约束，也可以通过将 $\\mathcal{L}$ 对 $\\lambda$ 的偏导数设为零得到：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left( \\sum_{i=1}^{3} p_i - D \\right) = 0 \\quad \\implies \\quad \\sum_{i=1}^{3} p_i = D\n$$\n为了求出 $\\lambda$ 的值，我们将 $p_i$ 的表达式代入功率平衡方程：\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda - b_i}{2 a_i} = D\n$$\n现在我们可以求解这个关于 $\\lambda$ 的方程。\n$$\n\\sum_{i=1}^{3} \\left( \\frac{\\lambda}{2 a_i} - \\frac{b_i}{2 a_i} \\right) = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) - \\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = D\n$$\n$$\n\\lambda \\left( \\sum_{i=1}^{3} \\frac{1}{2 a_i} \\right) = D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}\n$$\n这给出了系统影子价格 $\\lambda$ 的闭式表达式：\n$$\n\\lambda = \\frac{D + \\sum_{i=1}^{3} \\frac{b_i}{2 a_i}}{\\sum_{i=1}^{3} \\frac{1}{2 a_i}}\n$$\n现在，我们代入给定的数值来求解。\n系数为：$a_1 = \\frac{1}{50}$，$b_1 = 10$；$a_2 = \\frac{1}{40}$，$b_2 = 8$；$a_3 = \\frac{1}{30}$，$b_3 = 12$；以及 $D = 210$。\n\n首先，计算求和中的各项：\n$$\n\\frac{1}{2a_1} = \\frac{1}{2(\\frac{1}{50})} = 25, \\quad \\frac{1}{2a_2} = \\frac{1}{2(\\frac{1}{40})} = 20, \\quad \\frac{1}{2a_3} = \\frac{1}{2(\\frac{1}{30})} = 15\n$$\n$$\n\\sum_{i=1}^{3} \\frac{1}{2 a_i} = 25 + 20 + 15 = 60\n$$\n接下来，计算第二个求和的各项：\n$$\n\\frac{b_1}{2a_1} = 10 \\times 25 = 250, \\quad \\frac{b_2}{2a_2} = 8 \\times 20 = 160, \\quad \\frac{b_3}{2a_3} = 12 \\times 15 = 180\n$$\n$$\n\\sum_{i=1}^{3} \\frac{b_i}{2 a_i} = 250 + 160 + 180 = 590\n$$\n现在，我们可以计算 $\\lambda$：\n$$\n\\lambda = \\frac{210 + 590}{60} = \\frac{800}{60} = \\frac{40}{3} \\approx 13.3333...\n$$\n利用 $\\lambda$ 的值，我们求出每个发电机组的最优功率调度：\n$$\np_1 = \\frac{\\lambda - b_1}{2 a_1} = \\left(\\frac{40}{3} - 10\\right) \\times 25 = \\left(\\frac{40 - 30}{3}\\right) \\times 25 = \\frac{10}{3} \\times 25 = \\frac{250}{3} \\approx 83.3333...\n$$\n$$\np_2 = \\frac{\\lambda - b_2}{2 a_2} = \\left(\\frac{40}{3} - 8\\right) \\times 20 = \\left(\\frac{40 - 24}{3}\\right) \\times 20 = \\frac{16}{3} \\times 20 = \\frac{320}{3} \\approx 106.6666...\n$$\n$$\np_3 = \\frac{\\lambda - b_3}{2 a_3} = \\left(\\frac{40}{3} - 12\\right) \\times 15 = \\left(\\frac{40 - 36}{3}\\right) \\times 15 = \\frac{4}{3} \\times 15 = 20\n$$\n我们检查这个解的有效性。首先，功率平衡约束：\n$$\n\\sum_{i=1}^{3} p_i = \\frac{250}{3} + \\frac{320}{3} + 20 = \\frac{570}{3} + 20 = 190 + 20 = 210 = D\n$$\n约束得到满足。\n接下来，我们检查非负性。计算出的值为 $p_1 \\approx 83.33  0$，$p_2 \\approx 106.67  0$，$p_3 = 20  0$。由于所有的 $p_i$ 都是正数，非负性约束 $p_i \\ge 0$ 不起作用。这意味着完整的 KKT 条件（其中包含对这些约束的互补松弛乘子）在这些乘子为零的情况下得到满足。因此，该解是正确的最优调度。\n\n最后，我们按照要求将数值结果四舍五入到四位有效数字：\n-   $p_1 = \\frac{250}{3} \\approx 83.33 \\ \\mathrm{MW}$\n-   $p_2 = \\frac{320}{3} \\approx 106.7 \\ \\mathrm{MW}$\n-   $p_3 = 20.00 \\ \\mathrm{MW}$\n-   $\\lambda = \\frac{40}{3} \\approx 13.33 \\ \\$/\\mathrm{MWh}$\n\n最终答案为行向量 $(p_1, p_2, p_3, \\lambda)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 83.33  106.7  20.00  13.33 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的发电机存在运行极限，我们将其建模为不等式约束。本实践  将我们的分析扩展到一个包含发电机容量限制的系统，这需要我们应用完整的 Karush-Kuhn-Tucker (KKT) 条件。您将学到互补松弛性如何像一个逻辑开关一样，决定哪些发电机会达到其最大出力，以及这些系统瓶颈所对应的经济价值。",
            "id": "4100126",
            "problem": "一个电力系统运营商寻求在满足固定需求的同时，最小化一个由三台火电机组构成的投资组合的瞬时发电成本。经济调度被建模为一个凸二次规划问题。设决策变量为发电机出力 $g_{1}$、$g_{2}$ 和 $g_{3}$，单位为兆瓦（MW）。边际发电成本函数是关于 $g_{i}$ 的线性函数，其总成本函数形式为 $f(g) = \\sum_{i=1}^{3} \\left( \\frac{1}{2} a_{i} g_{i}^{2} + b_{i} g_{i} \\right)$，其中 $a_{i}  0$ 和 $b_{i} \\geq 0$ 是参数。需求必须被精确满足，并且每台发电机都有非负性和容量上限约束。该优化问题为\n$$\n\\min_{g_{1}, g_{2}, g_{3}} \\;\\; \\sum_{i=1}^{3} \\left( \\frac{1}{2} a_{i} g_{i}^{2} + b_{i} g_{i} \\right)\n$$\n约束条件为\n$$\ng_{1} + g_{2} + g_{3} = D,\n$$\n$$\n0 \\leq g_{i} \\leq \\bar{g}_{i}, \\quad i \\in \\{1,2,3\\}.\n$$\n假设 $D = 180$，$\\bar{g}_{1} = 60$，$\\bar{g}_{2} = 80$，$\\bar{g}_{3} = 120$，$a_{1} = 1$，$a_{2} = 2$，$a_{3} = 3$，$b_{1} = 10$，$b_{2} = 5$ 以及 $b_{3} = 0$。设 $\\lambda$ 表示需求等式约束的拉格朗日乘子，$\\mu_{i}$ 表示上限约束 $g_{i} \\leq \\bar{g}_{i}$ 的拉格朗日乘子。设 $\\nu_{i}$ 表示非负约束 $g_{i} \\geq 0$ 的拉格朗日乘子。\n\n利用卡罗需-库恩-塔克（KKT）条件，包括互补松弛性，确定最优发电机出力，并指明哪些上限约束是起作用的。然后计算相应的上限乘子 $\\mu_{i}$ 和需求乘子 $\\lambda$。解释互补松弛性如何确定哪些发电机达到其上限，以及这如何影响乘子 $\\mu_{i}$ 的值。\n\n按顺序 $(g_{1}, g_{2}, g_{3}, \\mu_{1}, \\mu_{2}, \\mu_{3}, \\lambda)$ 报告您的最终数值，结果为精确整数。发电机出力以 MW 表示，乘子以美元/兆瓦表示。无需四舍五入。",
            "solution": "该优化问题是最小化总发电成本，这是一个严格凸的二次函数，并受线性约束。\n目标函数是：\n$$\nf(g_{1}, g_{2}, g_{3}) = \\sum_{i=1}^{3} \\left( \\frac{1}{2} a_{i} g_{i}^{2} + b_{i} g_{i} \\right)\n$$\n约束条件是：\n$$\ng_{1} + g_{2} + g_{3} = D \\quad (\\text{乘子 } \\lambda)\n$$\n$$\ng_{i} \\leq \\bar{g}_{i} \\iff g_{i} - \\bar{g}_{i} \\leq 0 \\quad (\\text{乘子 } \\mu_{i} \\geq 0)\n$$\n$$\ng_{i} \\geq 0 \\iff -g_{i} \\leq 0 \\quad (\\text{乘子 } \\nu_{i} \\geq 0)\n$$\n此问题的拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} \\left( \\frac{1}{2} a_{i} g_{i}^{2} + b_{i} g_{i} \\right) + \\lambda(g_{1} + g_{2} + g_{3} - D) + \\sum_{i=1}^{3} \\mu_{i}(g_{i} - \\bar{g}_{i}) - \\sum_{i=1}^{3} \\nu_{i} g_{i}\n$$\n最优性的卡罗需-库恩-塔克（KKT）条件如下：\n1.  **平稳性**：对 $i \\in \\{1, 2, 3\\}$，有 $\\frac{\\partial \\mathcal{L}}{\\partial g_{i}} = 0$。\n    $$\n    a_{i} g_{i} + b_{i} + \\lambda + \\mu_{i} - \\nu_{i} = 0\n    $$\n2.  **原始可行性**：必须满足所有约束条件。\n    $$\n    g_{1} + g_{2} + g_{3} = D\n    $$\n    $$\n    0 \\leq g_{i} \\leq \\bar{g}_{i}\n    $$\n3.  **对偶可行性**：不等式乘子必须为非负。\n    $$\n    \\mu_{i} \\geq 0, \\quad \\nu_{i} \\geq 0\n    $$\n4.  **互补松弛性**：\n    $$\n    \\mu_{i}(g_{i} - \\bar{g}_{i}) = 0\n    $$\n    $$\n    \\nu_{i} g_{i} = 0\n    $$\n\n我们采用基于情况的分析。鉴于需求很高，任何发电机的出力都不太可能为 $0$，因此我们可以合理地假设对所有 $i$ 都有 $\\nu_i=0$。\n\n**情况1：假设没有容量约束是起作用的。**\n这意味着 $0  g_{i}  \\bar{g}_{i}$，并且根据互补松弛性，对于所有 $i \\in \\{1, 2, 3\\}$，$\\mu_{i} = 0$ 且 $\\nu_{i} = 0$。平稳性条件简化为等边际成本原则：$a_{i} g_{i} + b_{i} = -\\lambda$。\n我们可以用 $\\lambda$ 表示每个 $g_i$：\n$$g_{1} = \\frac{-\\lambda-b_{1}}{a_{1}} = \\frac{-\\lambda-10}{1} = -\\lambda-10$$\n$$g_{2} = \\frac{-\\lambda-b_{2}}{a_{2}} = \\frac{-\\lambda-5}{2}$$\n$$g_{3} = \\frac{-\\lambda-b_{3}}{a_{3}} = \\frac{-\\lambda-0}{3} = -\\frac{\\lambda}{3}$$\n将这些代入需求约束 $g_{1}+g_{2}+g_{3}=D=180$：\n$$\n(-\\lambda-10) + \\left(\\frac{-\\lambda-5}{2}\\right) + \\left(-\\frac{\\lambda}{3}\\right) = 180\n$$\n为了求解 $\\lambda$，我们两边乘以 $6$：\n$$\n6(-\\lambda-10) + 3(-\\lambda-5) + 2(-\\lambda) = 1080\n$$\n$$\n-6\\lambda - 60 - 3\\lambda - 15 - 2\\lambda = 1080\n$$\n$$\n-11\\lambda - 75 = 1080 \\implies -11\\lambda = 1155 \\implies \\lambda = -105\n$$\n我们求出发电水平：\n$$g_{1} = -(-105) - 10 = 95$$\n$$g_{2} = \\frac{-(-105)-5}{2} = \\frac{100}{2} = 50$$\n$$g_{3} = \\frac{-(-105)}{3} = 35$$\n我们对照容量约束检查这些值：\n$g_{1} = 95 > \\bar{g}_{1} = 60$。这违反了发电机1的上限约束。\n$g_{2} = 50$，在 $[0, 80]$ 范围内。\n$g_{3} = 35$，在 $[0, 120]$ 范围内。\n最初的假设不正确，因为发电机1必须以不同的水平进行调度。这种违规表明 $g_1$ 将达到其上限。\n\n**情况2：假设 $g_1$ 达到其上限，而 $g_2, g_3$ 没有。**\n这意味着 $g_{1} = \\bar{g}_{1} = 60$。根据互补松弛性，$\\mu_{1} \\geq 0$。对于发电机2和3，我们假设 $0  g_i  \\bar{g}_i$，因此 $\\mu_2=0$，$\\mu_3=0$，$\\nu_2=0$，$\\nu_3=0$。由于 $g_1 > 0$，我们有 $\\nu_1=0$。\n平稳性条件为：\n对于 $g_1$：$a_{1}g_{1} + b_{1} + \\lambda + \\mu_{1} = 0 \\implies 1(60) + 10 + \\lambda + \\mu_{1} = 0 \\implies 70 + \\lambda + \\mu_{1} = 0$。\n对于 $g_2$：$a_{2}g_{2} + b_{2} + \\lambda = 0 \\implies 2g_{2} + 5 + \\lambda = 0 \\implies g_{2} = \\frac{-\\lambda-5}{2}$。\n对于 $g_3$：$a_{3}g_{3} + b_{3} + \\lambda = 0 \\implies 3g_{3} + 0 + \\lambda = 0 \\implies g_{3} = \\frac{-\\lambda}{3}$。\n需求约束为 $g_{1} + g_{2} + g_{3} = 180$。当 $g_1 = 60$ 时，我们有 $g_{2} + g_{3} = 180 - 60 = 120$。\n代入 $g_2$ 和 $g_3$ 的表达式：\n$$\n\\frac{-\\lambda-5}{2} + \\frac{-\\lambda}{3} = 120\n$$\n两边乘以 $6$：\n$$\n3(-\\lambda-5) + 2(-\\lambda) = 720\n$$\n$$\n-3\\lambda - 15 - 2\\lambda = 720 \\implies -5\\lambda = 735 \\implies \\lambda = -147\n$$\n现在我们可以确定发电水平：\n$g_{1} = 60$ (根据假设)。\n$g_{2} = \\frac{-(-147)-5}{2} = \\frac{142}{2} = 71$。\n$g_{3} = \\frac{-(-147)}{3} = 49$。\n我们验证此解的可行性：\n$g_{1} = 60 = \\bar{g}_{1}$。发电机1的上限约束是起作用的。\n$0 \\leq g_{2}=71 \\leq \\bar{g}_{2}=80$。这是可行的且不起作用。\n$0 \\leq g_{3}=49 \\leq \\bar{g}_{3}=120$。这是可行的且不起作用。\n总发电量为 $60 + 71 + 49 = 180 = D$。需求约束得到满足。\n所有KKT原始可行性条件均得到满足。\n\n现在我们检查对偶可行性和剩余的互补松弛性条件。\n乘子 $\\mu_2$ 和 $\\mu_3$ 必须为 $0$，因为 $g_2$ 和 $g_3$ 没有达到其上限。这与我们的假设一致。\n由于所有 $g_i > 0$，乘子 $\\nu_i$ 均为 $0$。\n我们必须找到 $\\mu_1$ 并检查是否 $\\mu_1 \\geq 0$。根据 $g_1$ 的平稳性条件：\n$$\n70 + \\lambda + \\mu_{1} = 0 \\implies \\mu_{1} = -70 - \\lambda = -70 - (-147) = 77\n$$\n由于 $\\mu_{1} = 77 > 0$，对偶可行性条件得到满足。\n所有KKT条件都得到满足，因此这是唯一的最优解。\n\n最优发电机出力为 $g_{1}=60$ MW，$g_{2}=71$ MW 和 $g_{3}=49$ MW。\n唯一一个起作用的上限约束是发电机1的。\n拉格朗日乘子为 $\\lambda = -147$，$\\mu_{1} = 77$，$\\mu_{2} = 0$ 和 $\\mu_{3} = 0$。\n\n互补松弛性条件 $\\mu_i (g_i - \\bar{g}_i) = 0$ 至关重要。它在一个约束条件处于活跃（起作用）状态和其对应的乘子为非零之间建立了直接联系。\n- 如果一个上限约束不起作用 ($g_i  \\bar{g}_i$)，其乘子必须为零 ($\\mu_i = 0$)。发电机2和3就是这种情况，其中 $g_2  80$ 且 $g_3  120$，导致 $\\mu_2=0$ 和 $\\mu_3=0$。零乘子表示边际上增加容量 $\\bar{g}_i$ 不会降低总成本。\n- 如果一个乘子为正 ($\\mu_i > 0$)，其对应的约束必须是起作用的 ($g_i = \\bar{g}_i$)。发电机1就是这种情况。$\\mu_1=77$ 的值量化了放宽该约束的边际价值；将 $\\bar{g}_1$ 增加1 MW将使总系统成本降低$77。正乘子是系统需要将该发电机调度至其极限的直接结果，因为其边际成本 ($MC_1(60) = 1(60)+10 = 70$) 低于系统的无约束边际成本，该成本由其他发电机决定 ($-\\lambda = 147$)。\n\n最终值为：\n$g_{1} = 60$\n$g_{2} = 71$\n$g_{3} = 49$\n$\\mu_{1} = 77$\n$\\mu_{2} = 0$\n$\\mu_{3} = 0$\n$\\lambda = -147$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 60  71  49  77  0  0  -147 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了真正掌握拉格朗日乘子的经济含义，观察它们在系统条件变化时的动态表现是极具启发性的。此问题  提供了两种情景来直接展示互补松弛性的力量：一种是容量限制宽松，另一种是容量限制收紧。通过比较两种情景的结果，您将直观地理解乘子如何从零变为一个正值，从而精确地量化了一个有效约束所带来的经济成本。",
            "id": "4100093",
            "problem": "考虑一个在能源系统建模中常用的双发电机组系统的单周期经济调度问题。设发电机输出功率为 $p_{1}$ 和 $p_{2}$（单位：兆瓦，MW），总电力需求为 $D$（单位：MW）。每台发电机 $i \\in \\{1,2\\}$ 都有一个凸二次运行成本，由 $C_{i}(p_{i}) = \\frac{1}{2} a_{i} p_{i}^{2}$ 给出，其中 $a_{i}$ 的单位是美元/兆瓦平方（$\\$/\\mathrm{MW}^{2}$）。系统必须满足功率平衡和容量限制，且输出功率必须为非负。通过应用卡罗需-库恩-塔克（KKT）条件来构建和求解此调度问题，并利用求解结果说明收紧容量限制如何改变互补松弛状态以及如何修正最优乘子和调度方案。\n\n使用以下两种情景，运行时间间隔为一小时（因此兆瓦 MW 和兆瓦时 MWh 在数值上相等）：\n\n情景 A（基准）：$a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$，$a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$，$D = 80\\,\\mathrm{MW}$，$P_{1}^{\\max} = 100\\,\\mathrm{MW}$，$P_{2}^{\\max} = 100\\,\\mathrm{MW}$。\n\n情景 B（收紧发电机 $1$ 的容量）：$a_{1} = 1\\,\\$/\\mathrm{MW}^{2}$，$a_{2} = 3\\,\\$/\\mathrm{MW}^{2}$，$D = 80\\,\\mathrm{MW}$，$P_{1}^{\\max} = 50\\,\\mathrm{MW}$，$P_{2}^{\\max} = 100\\,\\mathrm{MW}$。\n\n任务：\n- 从凸优化和拉格朗日对偶性的基本原理出发，为最小化总成本 $C(p_{1},p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}$ 的问题推导 KKT 条件，该问题受功率平衡 $p_{1} + p_{2} = D$、容量约束 $p_{i} \\leq P_{i}^{\\max}$ 和非负约束 $p_{i} \\geq 0$ 的限制。\n- 求解 KKT 系统，找出情景 A 和情景 B 下的最优调度 $p_{1}^{\\star}$ 和 $p_{2}^{\\star}$、功率平衡约束的最优拉格朗日乘子 $\\lambda^{\\star}$（单位：$\\$/\\mathrm{MW}$）以及发电机 1 容量约束的最优拉格朗日乘子 $\\mu_{1}^{\\star}$（单位：$\\$/\\mathrm{MW}$）。\n- 在您的推理中，请指明每种情景下发电机 1 容量约束的互补松弛状态，并解释从情景 A 转换到情景 B 时发生的变化。\n\n调度量以兆瓦（MW）表示，对偶变量以美元/兆瓦（$\\$/\\mathrm{MW}$）表示。对于最终的方框答案，仅报告数值，不带单位，并按单行矩阵的顺序列出：\n$\\big[p_{1}^{\\star}\\text{(A)},\\;p_{2}^{\\star}\\text{(A)},\\;\\lambda^{\\star}\\text{(A)},\\;\\mu_{1}^{\\star}\\text{(A)},\\;p_{1}^{\\star}\\text{(B)},\\;p_{2}^{\\star}\\text{(B)},\\;\\lambda^{\\star}\\text{(B)},\\;\\mu_{1}^{\\star}\\text{(B)}\\big]$。\n\n无需四舍五入；请提供精确值。",
            "solution": "该问题提出了一个经典的双发电机组系统的经济调度情景，可以构建为一个凸优化问题。目标是在满足指定需求并遵守发电机运行限制的前提下，最小化总发电成本。\n\n首先，我们将该优化问题形式化。设决策变量为两台发电机的输出功率 $p_{1}$ 和 $p_{2}$。目标是最小化总成本函数 $C(p_{1}, p_{2})$，即各发电机成本之和：\n$$\n\\text{Minimize } C(p_{1}, p_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2}\n$$\n此最小化问题受以下几个约束条件的限制：\n1.  功率平衡（等式约束）：总发电量必须等于总需求 $D$。\n    $$p_{1} + p_{2} = D$$\n2.  发电机容量限制（不等式约束）：每台发电机的输出功率不能超过其最大容量 $P_{i}^{\\max}$。\n    $$p_{1} \\leq P_{1}^{\\max}$$\n    $$p_{2} \\leq P_{2}^{\\max}$$\n3.  非负性（不等式约束）：发电功率不能为负。\n    $$p_{1} \\geq 0$$\n    $$p_{2} \\geq 0$$\n\n为了使用 Karush–Kuhn–Tucker (KKT) 条件求解该问题，我们首先构造拉格朗日函数。我们为每个约束关联一个拉格朗日乘子。设 $\\lambda$ 为功率平衡等式约束的乘子。设 $\\mu_{1}$ 和 $\\mu_{2}$ 为容量上限的乘子，$\\gamma_{1}$ 和 $\\gamma_{2}$ 为非负约束的乘子。\n\n为了构建拉格朗日函数，我们将约束重写为标准形式 $h(x)=0$ 和 $g(x) \\leq 0$：\n$$h_1(p_1,p_2) = D - p_{1} - p_{2} = 0$$\n$$g_1(p_1) = p_{1} - P_{1}^{\\max} \\leq 0$$\n$$g_2(p_2) = p_{2} - P_{2}^{\\max} \\leq 0$$\n$$g_3(p_1) = -p_{1} \\leq 0$$\n$$g_4(p_2) = -p_{2} \\leq 0$$\n\n拉格朗日函数 $\\mathcal{L}$ 由下式给出：\n$$\n\\mathcal{L}(p_{1}, p_{2}, \\lambda, \\mu_{1}, \\mu_{2}, \\gamma_{1}, \\gamma_{2}) = \\frac{1}{2} a_{1} p_{1}^{2} + \\frac{1}{2} a_{2} p_{2}^{2} + \\lambda(D - p_{1} - p_{2}) + \\mu_{1}(p_{1} - P_{1}^{\\max}) + \\mu_{2}(p_{2} - P_{2}^{\\max}) - \\gamma_{1}p_{1} - \\gamma_{2}p_{2}\n$$\n最优解 $(p_{1}^{\\star}, p_{2}^{\\star})$ 和最优乘子 $(\\lambda^{\\star}, \\mu_{1}^{\\star}, \\mu_{2}^{\\star}, \\gamma_{1}^{\\star}, \\gamma_{2}^{\\star})$ 的 KKT 条件如下：\n\n1.  **稳定性**：拉格朗日函数对原始变量 $(p_{1}, p_{2})$ 的梯度必须为零。\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{1}} = a_{1} p_{1} - \\lambda + \\mu_{1} - \\gamma_{1} = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial p_{2}} = a_{2} p_{2} - \\lambda + \\mu_{2} - \\gamma_{2} = 0$$\n    这些方程表明，在最优点，每台机组的发电边际成本（经任何有效约束调整后）必须等于系统边际价格 $\\lambda$。\n\n2.  **原始可行性**：必须满足原始约束条件。\n    $$p_{1}^{\\star} + p_{2}^{\\star} = D$$\n    $$p_{1}^{\\star} \\leq P_{1}^{\\max}, \\quad p_{2}^{\\star} \\leq P_{2}^{\\max}$$\n    $$p_{1}^{\\star} \\geq 0, \\quad p_{2}^{\\star} \\geq 0$$\n\n3.  **对偶可行性**：所有不等式约束的乘子必须为非负。\n    $$\\mu_{1}^{\\star} \\geq 0, \\quad \\mu_{2}^{\\star} \\geq 0$$\n    $$\\gamma_{1}^{\\star} \\geq 0, \\quad \\gamma_{2}^{\\star} \\geq 0$$\n\n4.  **互补松弛性**：不等式约束的乘子与其松弛量的乘积必须为零。\n    $$\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$$\n    $$\\mu_{2}^{\\star}(p_{2}^{\\star} - P_{2}^{\\max}) = 0$$\n    $$\\gamma_{1}^{\\star}(-p_{1}^{\\star}) = 0 \\implies \\gamma_{1}^{\\star} p_{1}^{\\star} = 0$$\n    $$\\gamma_{2}^{\\star}(-p_{2}^{\\star}) = 0 \\implies \\gamma_{2}^{\\star} p_{2}^{\\star} = 0$$\n\n现在我们针对两种指定的情景求解该系统。\n\n**情景 A：基准**\n参数为 $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 100$, 以及 $P_{2}^{\\max} = 100$。\n我们首先假设解位于可行域的内部，即所有不等式约束都不起作用。这意味着 $0  p_{i}^{\\star}  P_{i}^{\\max}$。根据互补松弛性，此假设意味着 $\\mu_{1}^{\\star} = \\mu_{2}^{\\star} = \\gamma_{1}^{\\star} = \\gamma_{2}^{\\star} = 0$。\n\n稳定性条件简化为：\n$$a_{1} p_{1} - \\lambda = 0 \\implies p_{1} = \\frac{\\lambda}{a_{1}}$$\n$$a_{2} p_{2} - \\lambda = 0 \\implies p_{2} = \\frac{\\lambda}{a_{2}}$$\n将这些代入功率平衡约束中：\n$$\\frac{\\lambda}{a_{1}} + \\frac{\\lambda}{a_{2}} = D \\implies \\lambda \\left(\\frac{1}{a_{1}} + \\frac{1}{a_{2}}\\right) = D$$\n求解 $\\lambda$：\n$$\\lambda^{\\star} = \\frac{D}{\\frac{1}{a_{1}} + \\frac{1}{a_{2}}} = \\frac{D a_{1} a_{2}}{a_{1} + a_{2}}$$\n使用情景 A 的数值：\n$$\\lambda^{\\star}(\\text{A}) = \\frac{80 \\cdot 1 \\cdot 3}{1 + 3} = \\frac{240}{4} = 60$$\n$\\lambda$ 的单位是 $\\$/\\mathrm{MW}$。现在我们求最优调度：\n$$p_{1}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{1}} = \\frac{60}{1} = 60$$\n$$p_{2}^{\\star}(\\text{A}) = \\frac{\\lambda^{\\star}(\\text{A})}{a_{2}} = \\frac{60}{3} = 20$$\n我们必须验证我们的初始假设，即没有任何不等式约束是紧的。\n-   $p_{1}^{\\star}(\\text{A}) = 60$。$0  60  100$ 吗？是的。\n-   $p_{2}^{\\star}(\\text{A}) = 20$。$0  20  100$ 吗？是的。\n假设是正确的。不等式约束是松弛的。因此，它们对应的乘子为零：$\\mu_{1}^{\\star}(\\text{A}) = 0$，$\\mu_{2}^{\\star}(\\text{A}) = 0$，$\\gamma_{1}^{\\star}(\\text{A}) = 0$，$\\gamma_{2}^{\\star}(\\text{A}) = 0$。所有 KKT 条件均得到满足。\n所需值为 $p_{1}^{\\star}(\\text{A}) = 60$, $p_{2}^{\\star}(\\text{A}) = 20$, $\\lambda^{\\star}(\\text{A}) = 60$, 以及 $\\mu_{1}^{\\star}(\\text{A}) = 0$。\n\n**情景 B：收紧发电机 1 的容量**\n参数为 $a_{1} = 1$, $a_{2} = 3$, $D = 80$, $P_{1}^{\\max} = 50$, 以及 $P_{2}^{\\max} = 100$。\n情景 A 中的无约束解（$p_1=60$）违反了新的容量限制 $p_{1} \\leq 50$。这表明在最优点，约束 $p_{1} \\leq P_{1}^{\\max}$ 将是有效的（紧的）。\n我们假设 $p_{1}^{\\star} = P_{1}^{\\max} = 50$。\n根据功率平衡约束：\n$$p_{1}^{\\star} + p_{2}^{\\star} = 80 \\implies 50 + p_{2}^{\\star} = 80 \\implies p_{2}^{\\star} = 30$$\n现在我们检查此调度的可行性：\n-   $p_{1}^{\\star}(\\text{B}) = 50$。这满足 $0 \\leq 50 \\leq 50$。约束 $p_{1} \\leq P_{1}^{\\max}$ 是有效的。约束 $p_{1} \\geq 0$ 是无效的。因此我们预期 $\\mu_{1}^{\\star} \\geq 0$ 且 $\\gamma_{1}^{\\star} = 0$。\n-   $p_{2}^{\\star}(\\text{B}) = 30$。这满足 $0 \\leq 30 \\leq 100$。对 $p_{2}$ 的约束是无效的。因此我们预期 $\\mu_{2}^{\\star} = 0$ 且 $\\gamma_{2}^{\\star} = 0$。\n\n在 $\\mu_{2}^{\\star}=0$, $\\gamma_{1}^{\\star}=0$ 和 $\\gamma_{2}^{\\star}=0$ 的情况下，稳定性条件变为：\n$$a_{1} p_{1} - \\lambda + \\mu_{1} = 0$$\n$$a_{2} p_{2} - \\lambda = 0$$\n使用情景 B 的数值和我们的调度解：\n根据第二个方程：\n$$3 \\cdot 30 - \\lambda^{\\star} = 0 \\implies \\lambda^{\\star}(\\text{B}) = 90$$\n根据第一个方程：\n$$1 \\cdot 50 - 90 + \\mu_{1}^{\\star} = 0 \\implies -40 + \\mu_{1}^{\\star} = 0 \\implies \\mu_{1}^{\\star}(\\text{B}) = 40$$\n我们必须检查对偶可行性：$\\mu_{1}^{\\star}(\\text{B}) = 40 \\geq 0$。此条件满足。\n所有 KKT 条件均已满足。最优解为 $p_{1}^{\\star}(\\text{B}) = 50$, $p_{2}^{\\star}(\\text{B}) = 30$, $\\lambda^{\\star}(\\text{B}) = 90$, 以及 $\\mu_{1}^{\\star}(\\text{B}) = 40$。\n\n**互补松弛状态变化分析**\n从情景 A 到情景 B 的转换清晰地说明了互补松弛性和拉格朗日乘子的作用。\n\n-   **在情景 A 中**，发电机 1 的容量限制 $P_{1}^{\\max}=100$ 不是一个限制因素。最优调度为 $p_{1}^{\\star}=60$，远低于该限制。约束 $p_{1} - P_1^{\\max} \\leq 0$ 是**无效的**，因为存在非零的松弛量：$60 - 100 = -40 \\neq 0$。互补松弛条件 $\\mu_{1}^{\\star}(p_{1}^{\\star} - P_{1}^{\\max}) = 0$ 要求相应的乘子必须为零：$\\mu_{1}^{\\star}(\\text{A}) = 0$。其经济学解释是，边际上增加发电机 1 的容量不会带来任何成本节约，因为系统并未使用其全部现有容量。系统能源的边际成本 $\\lambda^{\\star}=60\\,\\$/\\mathrm{MW}$ 由两台发电机相等的边际成本决定：$a_{1} p_{1}^{\\star} = 1 \\cdot 60 = 60$ 和 $a_{2} p_{2}^{\\star} = 3 \\cdot 20 = 60$。\n\n-   **在情景 B 中**，发电机 1 的容量限制被收紧至 $P_{1}^{\\max}=50$。经济上理想的调度方案 $p_{1}=60$ 不再可行。优化过程被迫将较便宜的发电机 1 的输出限制在其上限，因此 $p_{1}^{\\star}=50$。约束 $p_{1} - P_1^{\\max} \\leq 0$ 现在是**有效的**，因为松弛量为零：$50 - 50 = 0$。互补松弛条件 $\\mu_{1}^{\\star}(0) = 0$ 对任何非负的 $\\mu_{1}^{\\star}$ 都成立。我们求得 $\\mu_{1}^{\\star}(\\text{B}) = 40$。\n\n-   **变化**：约束的收紧使其变为有效约束，导致其关联的拉格朗日乘子（影子价格）从零变为一个正值。系统边际价格 $\\lambda^{\\star}$ 现在完全由更昂贵的发电机 2 决定，后者是边际机组：$\\lambda^{\\star}(\\text{B}) = a_{2} p_{2}^{\\star} = 3 \\cdot 30 = 90\\,\\$/\\mathrm{MW}$。发电机 1 的边际成本仅为 $a_{1} p_{1}^{\\star} = 1 \\cdot 50 = 50\\,\\$/\\mathrm{MW}$。乘子 $\\mu_{1}^{\\star} = 40\\,\\$/\\mathrm{MW}$ 代表了系统边际价格与发电机 1 边际成本之间的差额（$\\lambda^{\\star} = a_{1} p_{1}^{\\star} + \\mu_{1}^{\\star} \\implies 90 = 50 + 40$）。该值量化了放宽该约束的边际经济效益；如果 $P_{1}^{\\max}$ 增加 $1\\,\\mathrm{MW}$，系统总成本将大约减少 $40\\,\\$$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  20  60  0  50  30  90  40\n\\end{pmatrix}\n}\n$$"
        }
    ]
}