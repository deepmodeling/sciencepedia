{
    "hands_on_practices": [
        {
            "introduction": "能源系统中的许多物理关系本质上是非线性的。为了使计算易于处理，我们常常用线性模型来近似它们。本练习旨在探讨模型简单性与准确性之间的基本权衡。通过推导最佳线性近似并量化其误差，你将具体理解线性化这一在大型能源系统建模中无处不在的技术所带来的后果 。",
            "id": "4101405",
            "problem": "一个区域能源系统使用离心泵在回路中循环热水。在工作范围内，整个回路的总压升是静压头和二次摩擦压头之和，可以建模为 $\\Delta p(Q) = \\Delta p_{0} + k Q^{2}$，其中 $Q$ 是体积流量。水力功率为 $P_{h}(Q) = \\Delta p(Q)\\,Q$，耗电功率为 $y(Q) = P_{h}(Q)/\\eta$，其中 $\\eta$ 是泵的恒定效率。\n\n假设以下物理上合理的参数：$\\Delta p_{0} = 30\\,\\text{kPa}$，$k = 200\\,\\text{kPa}\\cdot \\text{s}^{2}\\text{m}^{-6}$，以及 $\\eta = 0.7$（无量纲）。考虑工作范围 $Q \\in [0,\\,0.4]\\,\\text{m}^{3}\\text{s}^{-1}$。为方便起见，定义 $x \\equiv Q$，并通过一致的单位转换将 $y$ 以千瓦（kW）表示。\n\n在能源系统建模中，一个常见的线性建模假设是在指定的工作范围内，用 $y \\approx a x$ 来近似非线性关系 $y = \\phi(x)$。在 $x \\in [0,\\,0.4]$ 上使用均匀权重，确定使真实模型与其线性近似之间的均方差最小化的标量 $a$，然后通过计算均方根误差（RMSE）来量化此线性假设引入的误差，其定义为\n$$\n\\text{RMSE} \\equiv \\sqrt{\\frac{1}{L}\\int_{0}^{L}\\left(\\phi(x) - a x\\right)^{2}\\,dx},\n$$\n其中 $L = 0.4$。\n\n请以千瓦（kW）为单位，提供一个单一的精确闭式解析表达式作为RMSE。不要四舍五入；不要提供数值小数。最终方框内的答案必须只包含精确表达式，不带单位。问题的最终答案必须是单个实值数或单个闭式解析表达式。",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- 压升模型：$\\Delta p(Q) = \\Delta p_{0} + k Q^{2}$，其中 $Q$ 是体积流量。\n- 水力功率：$P_{h}(Q) = \\Delta p(Q)\\,Q$。\n- 耗电功率：$y(Q) = P_{h}(Q)/\\eta$。\n- 静压头：$\\Delta p_{0} = 30\\,\\text{kPa}$。\n- 摩擦压头系数：$k = 200\\,\\text{kPa}\\cdot \\text{s}^{2}\\text{m}^{-6}$。\n- 泵效率：$\\eta = 0.7$（无量纲）。\n- 流量工作范围：$Q \\in [0,\\,0.4]\\,\\text{m}^{3}\\text{s}^{-1}$。\n- 变量定义：$x \\equiv Q$。\n- $y$ 的输出单位：千瓦（kW）。\n- 线性近似模型：$y \\approx a x$。\n- 优化准则：在 $x \\in [0, L]$（其中 $L = 0.4$）的范围内，最小化真实模型 $\\phi(x)$ 与其线性近似 $a x$ 之间的均方差。\n- 误差度量定义：$\\text{RMSE} \\equiv \\sqrt{\\frac{1}{L}\\int_{0}^{L}\\left(\\phi(x) - a x\\right)^{2}\\,dx}$。\n- 任务：以千瓦为单位，将RMSE计算为单个精确的闭式解析表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于流体动力学和能源系统的基本原理。泵的特性曲线模型 $\\Delta p(Q) = \\Delta p_{0} + k Q^{2}$ 是描述泵在具有静扬程和摩擦损失（与流量的平方成正比）的系统中运行的标准表示。水力功率和耗电功率的定义是正确的。\n- **适定性**：该问题是适定的。它要求找到一个参数 $a$ 来最小化一个明确定义的目标函数（均方误差），这是一个具有唯一解的标准最小二乘问题。然后，它要求使用这个最优参数来计算一个明确定义的误差度量（RMSE）。\n- **客观性**：问题以精确、客观和定量的术语陈述，没有任何主观或基于意见的语言。\n- **完整性**：所有必要的参数（$\\Delta p_{0}$, $k$, $\\eta$）和工作域（$L=0.4$）都已提供。\n- **一致性与现实性**：单位是一致的。对于以 $\\text{kPa}$ 为单位的 $\\Delta p$ 和以 $\\text{m}^{3}\\text{s}^{-1}$ 为单位的 $Q$，水力功率 $\\Delta p \\cdot Q$ 的单位是 $(\\text{kPa}) \\cdot (\\text{m}^{3}\\text{s}^{-1}) = (10^3 \\text{N}/\\text{m}^{2}) \\cdot (\\text{m}^{3}/\\text{s}) = 10^3 \\text{N}\\cdot\\text{m}/\\text{s} = 10^3 \\text{W} = 1 \\text{kW}$。因此，问题中规定将 $y$ 以千瓦表示，与参数的物理单位是一致的。参数值被陈述为物理上是合理的，这对于此类建模问题是可以接受的。\n\n### 步骤3：结论与行动\n该问题是有效的。将推导解答。\n\n### 解答推导\n首先，我们构造耗电功率的非线性函数 $\\phi(x)$。\n水力功率由下式给出：\n$$\nP_{h}(Q) = \\Delta p(Q) Q = (\\Delta p_{0} + kQ^{2})Q = \\Delta p_{0}Q + kQ^{3}\n$$\n如在验证阶段所确定的，当 $\\Delta p_{0}$ 的单位是 $\\text{kPa}$，$k$ 的单位是 $\\text{kPa}\\cdot \\text{s}^{2}\\text{m}^{-6}$，而 $Q$ 的单位是 $\\text{m}^{3}\\text{s}^{-1}$ 时，功率 $P_h(Q)$ 的单位是千瓦（$\\text{kW}$）。\n那么，耗电功率 $y(Q)$ 为：\n$$\ny(Q) = \\frac{P_{h}(Q)}{\\eta} = \\frac{1}{\\eta} \\left( \\Delta p_{0}Q + kQ^{3} \\right)\n$$\n使用代换 $x \\equiv Q$，我们定义待近似的函数 $\\phi(x)$：\n$$\n\\phi(x) = \\frac{1}{\\eta} \\left( \\Delta p_{0}x + kx^{3} \\right)\n$$\n问题是找到标量 $a$，使均方误差最小化，这等同于最小化在区间 $[0, L]$ 上的积分平方误差 $E(a)$：\n$$\nE(a) = \\int_{0}^{L} \\left( \\phi(x) - ax \\right)^{2} dx\n$$\n为了找到最小值，我们将 $E(a)$ 对 $a$ 求导，并令结果为零：\n$$\n\\frac{dE}{da} = \\frac{d}{da} \\int_{0}^{L} \\left( \\phi(x)^{2} - 2ax\\phi(x) + a^{2}x^{2} \\right) dx = \\int_{0}^{L} \\left( -2x\\phi(x) + 2ax^2 \\right) dx = 0\n$$\n求解 $a$：\n$$\na \\int_{0}^{L} x^{2} dx = \\int_{0}^{L} x\\phi(x) dx \\implies a = \\frac{\\int_{0}^{L} x\\phi(x) dx}{\\int_{0}^{L} x^{2} dx}\n$$\n我们计算积分。分母是：\n$$\n\\int_{0}^{L} x^{2} dx = \\left[ \\frac{x^{3}}{3} \\right]_{0}^{L} = \\frac{L^{3}}{3}\n$$\n分子是：\n$$\n\\int_{0}^{L} x\\phi(x) dx = \\int_{0}^{L} x \\left( \\frac{1}{\\eta} (\\Delta p_{0} x + k x^{3}) \\right) dx = \\frac{1}{\\eta} \\int_{0}^{L} (\\Delta p_{0} x^{2} + k x^{4}) dx\n$$\n$$\n= \\frac{1}{\\eta} \\left[ \\Delta p_{0} \\frac{x^{3}}{3} + k \\frac{x^{5}}{5} \\right]_{0}^{L} = \\frac{1}{\\eta} \\left( \\frac{\\Delta p_{0} L^{3}}{3} + \\frac{k L^{5}}{5} \\right)\n$$\n将这些代入 $a$ 的表达式中：\n$$\na = \\frac{\\frac{1}{\\eta} \\left( \\frac{\\Delta p_{0} L^{3}}{3} + \\frac{k L^{5}}{5} \\right)}{\\frac{L^{3}}{3}} = \\frac{1}{\\eta} \\left( \\Delta p_{0} + \\frac{3kL^{2}}{5} \\right)\n$$\n接下来，我们计算RMSE。平方误差积分 $E(a)$ 可以展开为：\n$$\nE(a) = \\int_{0}^{L} \\phi(x)^{2} dx - 2a \\int_{0}^{L} x\\phi(x) dx + a^{2} \\int_{0}^{L} x^{2} dx\n$$\n根据最优 $a$ 的定义，我们知道 $a \\int_{0}^{L} x^{2} dx = \\int_{0}^{L} x\\phi(x) dx$。将其代入中间项得到：\n$$\nE(a) = \\int_{0}^{L} \\phi(x)^{2} dx - 2a \\left( a\\int_{0}^{L} x^{2} dx \\right) + a^{2} \\int_{0}^{L} x^{2} dx = \\int_{0}^{L} \\phi(x)^{2} dx - a^{2} \\int_{0}^{L} x^{2} dx\n$$\n我们必须计算此表达式中的两个积分。首先是 $\\int_{0}^{L} \\phi(x)^{2} dx$：\n$$\n\\phi(x)^{2} = \\frac{1}{\\eta^{2}} (\\Delta p_{0} x + kx^{3})^{2} = \\frac{1}{\\eta^{2}} (\\Delta p_{0}^{2} x^{2} + 2k\\Delta p_{0} x^{4} + k^{2}x^{6})\n$$\n$$\n\\int_{0}^{L} \\phi(x)^{2} dx = \\frac{1}{\\eta^{2}} \\int_{0}^{L} (\\Delta p_{0}^{2} x^{2} + 2k\\Delta p_{0} x^{4} + k^{2}x^{6}) dx = \\frac{1}{\\eta^{2}} \\left[ \\frac{\\Delta p_{0}^{2}x^{3}}{3} + \\frac{2k\\Delta p_{0}x^{5}}{5} + \\frac{k^{2}x^{7}}{7} \\right]_{0}^{L}\n$$\n$$\n= \\frac{1}{\\eta^{2}} \\left( \\frac{\\Delta p_{0}^{2}L^{3}}{3} + \\frac{2k\\Delta p_{0}L^{5}}{5} + \\frac{k^{2}L^{7}}{7} \\right)\n$$\n接下来，我们计算项 $a^{2} \\int_{0}^{L} x^{2} dx$：\n$$\na^{2} = \\frac{1}{\\eta^{2}} \\left( \\Delta p_{0} + \\frac{3kL^{2}}{5} \\right)^{2} = \\frac{1}{\\eta^{2}} \\left( \\Delta p_{0}^{2} + \\frac{6k\\Delta p_{0}L^{2}}{5} + \\frac{9k^{2}L^{4}}{25} \\right)\n$$\n$$\na^{2} \\int_{0}^{L} x^{2} dx = a^{2} \\frac{L^{3}}{3} = \\frac{L^{3}}{3\\eta^{2}} \\left( \\Delta p_{0}^{2} + \\frac{6k\\Delta p_{0}L^{2}}{5} + \\frac{9k^{2}L^{4}}{25} \\right)\n$$\n$$\n= \\frac{1}{\\eta^{2}} \\left( \\frac{\\Delta p_{0}^{2}L^{3}}{3} + \\frac{2k\\Delta p_{0}L^{5}}{5} + \\frac{3k^{2}L^{7}}{25} \\right)\n$$\n现在，我们从 $\\int_{0}^{L} \\phi(x)^{2} dx$ 中减去这一项来求得 $E(a)$：\n$$\nE(a) = \\frac{1}{\\eta^{2}} \\left[ \\left( \\frac{\\Delta p_{0}^{2}L^{3}}{3} + \\frac{2k\\Delta p_{0}L^{5}}{5} + \\frac{k^{2}L^{7}}{7} \\right) - \\left( \\frac{\\Delta p_{0}^{2}L^{3}}{3} + \\frac{2k\\Delta p_{0}L^{5}}{5} + \\frac{3k^{2}L^{7}}{25} \\right) \\right]\n$$\n每个括号中的前两项相互抵消，剩下：\n$$\nE(a) = \\frac{1}{\\eta^{2}} \\left( \\frac{k^{2}L^{7}}{7} - \\frac{3k^{2}L^{7}}{25} \\right) = \\frac{k^{2}L^{7}}{\\eta^{2}} \\left( \\frac{25-21}{175} \\right) = \\frac{4 k^{2}L^{7}}{175\\eta^{2}}\n$$\nRMSE 定义为 $\\sqrt{E(a)/L}$：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{L} \\left( \\frac{4 k^{2}L^{7}}{175\\eta^{2}} \\right)} = \\sqrt{\\frac{4 k^{2}L^{6}}{175\\eta^{2}}} = \\frac{2 k L^{3}}{\\eta \\sqrt{175}}\n$$\n因为 $175 = 25 \\times 7$，我们有 $\\sqrt{175} = 5\\sqrt{7}$。RMSE的符号表达式为：\n$$\n\\text{RMSE} = \\frac{2 k L^{3}}{5 \\eta \\sqrt{7}}\n$$\n现在，我们代入给定的数值：$k=200$，$L=0.4 = \\frac{2}{5}$，以及 $\\eta=0.7 = \\frac{7}{10}$。\n$$\nL^{3} = \\left(\\frac{2}{5}\\right)^{3} = \\frac{8}{125}\n$$\n$$\n\\text{RMSE} = \\frac{2 \\cdot (200) \\cdot (\\frac{8}{125})}{5 \\cdot (\\frac{7}{10}) \\cdot \\sqrt{7}} = \\frac{400 \\cdot \\frac{8}{125}}{\\frac{35}{10} \\sqrt{7}} = \\frac{\\frac{3200}{125}}{\\frac{7}{2}\\sqrt{7}}\n$$\n我们简化分数 $\\frac{3200}{125} = \\frac{128 \\times 25}{5 \\times 25} = \\frac{128}{5}$。\n$$\n\\text{RMSE} = \\frac{\\frac{128}{5}}{\\frac{7\\sqrt{7}}{2}} = \\frac{128}{5} \\cdot \\frac{2}{7\\sqrt{7}} = \\frac{256}{35\\sqrt{7}}\n$$\n为了以标准的闭式形式提供答案，我们将分母有理化：\n$$\n\\text{RMSE} = \\frac{256}{35\\sqrt{7}} \\cdot \\frac{\\sqrt{7}}{\\sqrt{7}} = \\frac{256\\sqrt{7}}{35 \\cdot 7} = \\frac{256\\sqrt{7}}{245}\n$$\n最终答案就是这个精确表达式，其单位是 $\\text{kW}$。",
            "answer": "$$\n\\boxed{\\frac{256\\sqrt{7}}{245}}\n$$"
        },
        {
            "introduction": "在理解了线性化概念的基础上，我们现在转向电力系统工程中最重要的近似之一：直流潮流模型。本练习要求你从精确的、非线性的交流潮流方程推导出线性的直流潮流方程。这项动手编程练习将让你亲眼看到，在不同的运行条件下，这种强大的简化何时有效，何时失效，这对于理解许多市场出清和电网分析工具的可靠性至关重要 。",
            "id": "4101439",
            "problem": "考虑一个交流电力系统中的单条输电线路，该线路被建模为连接母线 $i$ 和母线 $j$ 的集中串联元件。以相量形式的欧姆定律和复功率定义为基本依据。假设系统处于稳态正弦工况，并将线路建模为纯电抗性线路，其串联电抗为 $x  0$（即，电阻和并联元件可忽略不计）。设复数母线电压为 $V_i = |V_i| e^{\\mathbf{j} \\theta_i}$ 和 $V_j = |V_j| e^{\\mathbf{j} \\theta_j}$，其中 $\\mathbf{j} = \\sqrt{-1}$，电压幅值 $|V|$ 以标幺值 (p.u.) 表示，相角以弧度表示。您必须：\n\n- 仅从相量欧姆定律 $I_{ij} = Y_{ij}(V_i - V_j)$ 和复功率定义 $S_{ij} = V_i I_{ij}^*$ 出发，推导对于串联电抗为 $x$ 的纯电抗性线路，从母线 $i$ 到母线 $j$ 的精确有功功率潮流 $P_{ij}$。\n- 在该精确表达式的基础上，应用适用于输电系统研究的标准直流 (DC) 潮流线性化假设，即：(i) 电压幅值接近于 1，(ii) 电压相角差很小，以及 (iii) 线路电阻与电抗相比可忽略不计。推导出由此产生的有功功率潮流的线性估计值。\n- 使用精确（非线性）和线性化（直流）两种表达式，计算对于以下每个测试用例，两种有功功率潮流预测值之间的绝对误差。\n\n所有量均以 100 兆伏安为基准的标幺值 (p.u.) 表示，所有相角均以弧度表示。对于每个测试用例，参数为 $(x,\\;|V_i|,\\;\\theta_i,\\;|V_j|,\\;\\theta_j)$：\n- 测试用例 1：$(x = 0.2,\\; |V_i| = 0.95,\\; \\theta_i = 0.10,\\; |V_j| = 1.05,\\; \\theta_j = 0.02)$。\n- 测试用例 2：$(x = 0.3,\\; |V_i| = 0.90,\\; \\theta_i = 0.00,\\; |V_j| = 1.10,\\; \\theta_j = 0.00)$。\n- 测试用例 3：$(x = 0.1,\\; |V_i| = 0.88,\\; \\theta_i = 0.04,\\; |V_j| = 1.08,\\; \\theta_j = 0.00)$。\n- 测试用例 4：$(x = 0.4,\\; |V_i| = 0.92,\\; \\theta_i = 0.25,\\; |V_j| = 1.08,\\; \\theta_j = -0.05)$。\n- 测试用例 5：$(x = 0.25,\\; |V_i| = 1.10,\\; \\theta_i = -0.06,\\; |V_j| = 0.90,\\; \\theta_j = 0.06)$。\n\n对每个测试用例：\n- 使用推导出的非线性表达式计算精确的有功功率潮流 $P_{ij}^{\\mathrm{AC}}$。\n- 使用推导出的线性表达式计算直流近似的有功功率潮流 $P_{ij}^{\\mathrm{DC}}$。\n- 计算以标幺值 (p.u.) 表示的绝对误差 $\\Delta = | P_{ij}^{\\mathrm{AC}} - P_{ij}^{\\mathrm{DC}} |$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含所有五个测试用例的结果。结果应为逗号分隔的列表，并用方括号括起来，每个 $\\Delta$ 值四舍五入到六位小数（例如，$[0.123456,0.000001,0.987650,0.100000,0.000000]$）。",
            "solution": "问题陈述已经过验证，被认为是合理的。这是一个在电力系统分析领域中定义明确且具有科学依据的问题，要求推导并比较无损输电线路的精确交流潮流方程及其线性化的直流近似。所有必要的数据和基本方程均已提供，目标明确且可形式化。\n\n求解过程分三步：首先，推导有功功率潮流 ($P_{ij}^{\\mathrm{AC}}$) 的精确非线性表达式；其次，通过应用标准的简化假设，推导有功功率潮流 ($P_{ij}^{\\mathrm{DC}}$) 的线性化近似表达式；第三，针对所提供的测试用例，计算这两种模型之间的绝对误差。\n\n**1. 精确有功功率潮流 ($P_{ij}^{\\mathrm{AC}}$) 的推导**\n\n分析始于交流电路中复功率和电流的基本定义。从母线 $i$ 流向母线 $j$ 的复功率（记为 $S_{ij}$）定义为：\n$$S_{ij} = P_{ij} + \\mathbf{j}Q_{ij} = V_i I_{ij}^*$$\n其中 $P_{ij}$ 是有功功率，$Q_{ij}$ 是无功功率，$V_i$ 是母线 $i$ 处的复数电压，$I_{ij}^*$ 是从母线 $i$ 流向母线 $j$ 的电流 $I_{ij}$ 的复共轭。虚数单位是 $\\mathbf{j} = \\sqrt{-1}$。\n\n电流 $I_{ij}$ 由相量形式的欧姆定律给出：\n$$I_{ij} = Y_{ij}(V_i - V_j)$$\n其中 $Y_{ij}$ 是连接母线的线路的串联导纳。问题指定了一条串联电抗为 $x$ 的纯电抗性线路。因此，串联阻抗为 $Z_{ij} = \\mathbf{j}x$。导纳是阻抗的倒数：\n$$Y_{ij} = \\frac{1}{Z_{ij}} = \\frac{1}{\\mathbf{j}x} = -\\frac{\\mathbf{j}}{x}$$\n\n将此导纳代入电流方程，得到：\n$$I_{ij} = -\\frac{\\mathbf{j}}{x}(V_i - V_j)$$\n\n接下来，我们求电流的复共轭 $I_{ij}^*$：\n$$I_{ij}^* = \\left(-\\frac{\\mathbf{j}}{x}(V_i - V_j)\\right)^* = \\left(-\\frac{\\mathbf{j}}{x}\\right)^* (V_i - V_j)^* = \\frac{\\mathbf{j}}{x}(V_i^* - V_j^*)$$\n\n现在，我们将 $I_{ij}^*$ 代入复功率方程：\n$$S_{ij} = V_i \\left(\\frac{\\mathbf{j}}{x}(V_i^* - V_j^*)\\right) = \\frac{\\mathbf{j}}{x}(V_i V_i^* - V_i V_j^*)$$\n\n一个复数与其共轭的乘积是其幅值的平方，所以 $V_i V_i^* = |V_i|^2$。复数电压以极坐标形式给出，即 $V_i = |V_i| e^{\\mathbf{j}\\theta_i}$ 和 $V_j = |V_j| e^{\\mathbf{j}\\theta_j}$。$V_i V_j^*$ 项可以表示为：\n$$V_i V_j^* = \\left(|V_i| e^{\\mathbf{j}\\theta_i}\\right) \\left(|V_j| e^{-\\mathbf{j}\\theta_j}\\right) = |V_i||V_j| e^{\\mathbf{j}(\\theta_i - \\theta_j)}$$\n\n使用欧拉公式 $e^{\\mathbf{j}\\phi} = \\cos(\\phi) + \\mathbf{j}\\sin(\\phi)$，我们展开此项：\n$$V_i V_j^* = |V_i||V_j| \\left(\\cos(\\theta_i - \\theta_j) + \\mathbf{j}\\sin(\\theta_i - \\theta_j)\\right)$$\n\n将这些表达式代回 $S_{ij}$ 的方程：\n$$S_{ij} = \\frac{\\mathbf{j}}{x} \\left( |V_i|^2 - |V_i||V_j| \\left(\\cos(\\theta_i - \\theta_j) + \\mathbf{j}\\sin(\\theta_i - \\theta_j)\\right) \\right)$$\n$$S_{ij} = \\frac{\\mathbf{j}}{x}|V_i|^2 - \\frac{\\mathbf{j}}{x}|V_i||V_j|\\cos(\\theta_i - \\theta_j) - \\frac{\\mathbf{j}^2}{x}|V_i||V_j|\\sin(\\theta_i - \\theta_j)$$\n\n由于 $\\mathbf{j}^2 = -1$，方程简化为：\n$$S_{ij} = \\frac{|V_i||V_j|}{x}\\sin(\\theta_i - \\theta_j) + \\mathbf{j}\\left(\\frac{|V_i|^2}{x} - \\frac{|V_i||V_j|}{x}\\cos(\\theta_i - \\theta_j)\\right)$$\n\n有功功率潮流 $P_{ij}^{\\mathrm{AC}}$ 是 $S_{ij}$ 的实部。\n$$P_{ij}^{\\mathrm{AC}} = \\mathrm{Re}\\{S_{ij}\\} = \\frac{|V_i||V_j|}{x}\\sin(\\theta_i - \\theta_j)$$\n这就是无损输电线路上有功功率潮流的精确非线性表达式。\n\n**2. 线性化直流潮流 ($P_{ij}^{\\mathrm{DC}}$) 的推导**\n\n直流潮流模型是基于高压输电系统在正常运行条件下的一组标准假设对交流潮流方程进行的线性化。这些假设是：\n(i) 电压幅值的标幺值约等于 1：$|V_i| \\approx 1$ 且 $|V_j| \\approx 1$。\n(ii) 相连母线之间的电压相角差很小：$(\\theta_i - \\theta_j)$ 很小，这使得可以进行近似 $\\sin(\\theta_i - \\theta_j) \\approx (\\theta_i - \\theta_j)$ 和 $\\cos(\\theta_i - \\theta_j) \\approx 1$。为使此近似有效，相角必须以弧度为单位。\n(iii) 线路电阻与电抗相比可忽略不计 ($r \\ll x$)，这一点已通过将线路阻抗设为 $Z_{ij} = \\mathbf{j}x$ 而纳入我们的模型中。\n\n将假设 (i) 和 (ii) 应用于精确有功功率潮流方程：\n$$P_{ij}^{\\mathrm{AC}} = \\frac{|V_i||V_j|}{x}\\sin(\\theta_i - \\theta_j)$$\n$$P_{ij}^{\\mathrm{DC}} \\approx \\frac{(1)(1)}{x}(\\theta_i - \\theta_j)$$\n这就得出了线性化的直流潮流方程：\n$$P_{ij}^{\\mathrm{DC}} = \\frac{\\theta_i - \\theta_j}{x}$$\n该表达式对于状态变量 $\\theta_i$ 和 $\\theta_j$ 是线性的。\n\n**3. 绝对误差的计算**\n\n对于每个测试用例，我们将计算精确交流潮流与近似直流潮流之间的绝对误差 $\\Delta$：\n$$\\Delta = \\left| P_{ij}^{\\mathrm{AC}} - P_{ij}^{\\mathrm{DC}} \\right| = \\left| \\frac{|V_i||V_j|}{x}\\sin(\\theta_i - \\theta_j) - \\frac{\\theta_i - \\theta_j}{x} \\right|$$\n将对问题陈述中提供的每组参数进行计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute discrepancy between the exact AC and the linearized DC\n    real power flow models for a lossless transmission line.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is in the format: (x, |V_i|, theta_i, |V_j|, theta_j)\n    # where x is reactance in p.u., |V| are voltage magnitudes in p.u.,\n    # and theta are voltage angles in radians.\n    test_cases = [\n        (0.2, 0.95, 0.10, 1.05, 0.02),\n        (0.3, 0.90, 0.00, 1.10, 0.00),\n        (0.1, 0.88, 0.04, 1.08, 0.00),\n        (0.4, 0.92, 0.25, 1.08, -0.05),\n        (0.25, 1.10, -0.06, 0.90, 0.06),\n    ]\n\n    results = []\n    for case in test_cases:\n        x, vi_mag, theta_i, vj_mag, theta_j = case\n        \n        # Calculate the angle difference\n        theta_diff = theta_i - theta_j\n        \n        # 1. Compute the exact real power flow (P_ac)\n        # P_ac = (|V_i| * |V_j| / x) * sin(theta_i - theta_j)\n        p_ac = (vi_mag * vj_mag / x) * np.sin(theta_diff)\n        \n        # 2. Compute the DC-approximated real power flow (P_dc)\n        # P_dc = (theta_i - theta_j) / x\n        p_dc = theta_diff / x\n        \n        # 3. Compute the absolute discrepancy\n        discrepancy = abs(p_ac - p_dc)\n        \n        results.append(discrepancy)\n\n    # Format the results to six decimal places as strings\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "虽然线性化是一个强大的工具，但并非所有非线性关系都能被简化。事实上，某些非线性特性会带来巨大的计算挑战。本练习将探讨非凸性问题，这是发电机成本函数中因阀点效应等物理现象而普遍存在的特性。与只有一个全局最优解的凸问题不同，非凸问题可能存在多个局部最优解。通过这个练习，你将证明标准的基于梯度的优化算法如何陷入这些局部最优解，而无法找到真正成本最低的全局最优方案，这凸显了在能源系统建模中识别非凸性并选择合适的全局优化技术是何等重要 。",
            "id": "4101426",
            "problem": "考虑一个来自能源系统建模的双发电机经济调度问题，其中发电量必须平衡需求，并且由于阀点效应，运行成本是非凸的。设发电机 $i \\in \\{1,2\\}$ 产生功率 $p_i$，其边界为 $p_i \\in [\\underline{p}_i,\\overline{p}_i]$，总需求 $D$ 必须由供给满足，使得 $p_1 + p_2 = D$。由于在凸二次热耗率曲线上叠加了正弦波纹，每个发电机的成本函数都是一个非凸的光滑函数。目标是在可行的功率输出范围内最小化总运行成本。\n\n基本原理：\n- 经济调度强制执行功率平衡 $p_1 + p_2 = D$ 和箱式约束 $p_i \\in [\\underline{p}_i,\\overline{p}_i]$。\n- 各发电机的成本是可加的，火力发电机中的物理阀门会在成本曲线上引入类似波纹的非凸性，这通过正弦项来建模。正弦函数以弧度为单位进行计算。\n\n定义以下具体实例：\n- 需求：$D = 180$。\n- 边界：$\\underline{p}_1 = 10$，$\\overline{p}_1 = 120$，$\\underline{p}_2 = 20$，$\\overline{p}_2 = 200$。\n- 成本：\n$$C_1(p_1) = a_1 p_1^2 + b_1 p_1 + c_1 + d_1 \\sin(\\omega_1 p_1),$$\n$$C_2(p_2) = a_2 p_2^2 + b_2 p_2 + c_2 + d_2 \\sin(\\omega_2 p_2 + \\phi),$$\n参数为 $a_1 = 2 \\times 10^{-3}$，$b_1 = 4$，$c_1 = 100$，$d_1 = 15$，$\\omega_1 = 0.25$，以及 $a_2 = 1.5 \\times 10^{-3}$，$b_2 = 3.5$，$c_2 = 80$，$d_2 = 12$，$\\omega_2 = 0.33$，$\\phi = 0.5$。正弦函数中的所有角度都必须按弧度处理。全局优化目标是在满足 $p_1 + p_2 = D$ 和箱式约束的条件下，最小化 $C_1(p_1) + C_2(p_2)$。\n\n为实现一种在非凸问题上可能失败的基于梯度的方法，通过添加一个系数为 $\\mu$ 的二次惩罚项来松弛等式约束，从而形成无约束的惩罚目标函数\n$$F(p_1,p_2) = C_1(p_1) + C_2(p_2) + \\mu \\, (p_1 + p_2 - D)^2,$$\n其中 $\\mu = 200$。对 $F$ 应用带有回溯线搜索的投影梯度下降法，并投影到箱式约束 $[\\underline{p}_1,\\overline{p}_1] \\times [\\underline{p}_2,\\overline{p}_2]$ 上，该方法可能会根据不同的初始化收敛到不同的局部最小值。\n\n任务：\n1. 通过 $p_2 = D - p_1$ 将约束问题降至一维，并在 $p_1$ 的可行区间上进行足够精细的搜索，从而计算出该约束问题的全局最小值的一个数值上可靠的近似值（只考虑那些使得 $p_2$ 在其边界内的 $p_1$ 值）。返回 $C_1(p_1) + C_2(D - p_1)$ 的最小值以及相应的 $(p_1^\\star,p_2^\\star)$。\n2. 对 $F(p_1,p_2)$ 实现一个带有回溯线搜索的投影梯度下降法，每一步仅使用局部梯度信息并投影到箱式约束 $[\\underline{p}_1,\\overline{p}_1] \\times [\\underline{p}_2,\\overline{p}_2]$ 上。算法终止后，通过将 $p_1$ 设置为由 $p_2 = D - p_1$ 所隐含的 $p_1$ 可行区间内的最近值，然后设置 $p_2 = D - p_1$ 以精确执行功率平衡，从而将最终迭代点映射到可行流形上。在此映射点上评估真实的约束成本 $C_1(p_1) + C_2(p_2)$。\n3. 对于每个指定的初始化，通过将映射点的真实约束成本与步骤1中得到的全局最优成本在容差 $\\epsilon = 10^{-4}$ 内进行比较，来判断梯度法是否达到了全局最小值（如果绝对差小于或等于 $\\epsilon$，则声明成功）。所有正弦函数的参数必须使用弧度。\n\n角度单位说明：正弦函数中的所有角度都必须是弧度。\n\n最终的数值输出中不需要任何物理单位。\n\n投影梯度下降的测试套件初始化：\n- 初始化 1：$(p_1^{(0)},p_2^{(0)}) = (10, 170)$。\n- 初始化 2：$(p_1^{(0)},p_2^{(0)}) = (120, 60)$。\n- 初始化 3：$(p_1^{(0)},p_2^{(0)}) = (80, 100)$。\n- 初始化 4：$(p_1^{(0)},p_2^{(0)}) = (30, 150)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按测试套件初始化顺序排列的结果，每个条目都是一个布尔值，指示梯度法是否在容差 $\\epsilon$ 内达到了全局最小值。例如，在适当情况下，输出必须看起来像 $[\\text{True},\\text{False},\\text{False},\\text{True}]$。",
            "solution": "用户提供了一个问题陈述，在尝试解决方案之前需要对其进行验证。\n\n### 步骤1：提取已知条件\n- **问题类型**：具有非凸成本的双发电机经济调度。\n- **目标**：最小化总成本 $C_1(p_1) + C_2(p_2)$。\n- **功率平衡约束**：$p_1 + p_2 = D$。\n- **发电机箱式约束**：$p_i \\in [\\underline{p}_i, \\overline{p}_i]$，对于 $i \\in \\{1, 2\\}$。\n- **需求**：$D = 180$。\n- **发电机1边界**：$\\underline{p}_1 = 10$, $\\overline{p}_1 = 120$。\n- **发电机2边界**：$\\underline{p}_2 = 20$, $\\overline{p}_2 = 200$。\n- **发电机1成本函数**：$C_1(p_1) = a_1 p_1^2 + b_1 p_1 + c_1 + d_1 \\sin(\\omega_1 p_1)$，参数为 $a_1 = 2 \\times 10^{-3}$，$b_1 = 4$，$c_1 = 100$，$d_1 = 15$，$\\omega_1 = 0.25$。\n- **发电机2成本函数**：$C_2(p_2) = a_2 p_2^2 + b_2 p_2 + c_2 + d_2 \\sin(\\omega_2 p_2 + \\phi)$，参数为 $a_2 = 1.5 \\times 10^{-3}$，$b_2 = 3.5$，$c_2 = 80$，$d_2 = 12$，$\\omega_2 = 0.33$，$\\phi = 0.5$。\n- **角度单位**：所有正弦函数的参数都以弧度为单位。\n- **惩罚目标函数**：$F(p_1,p_2) = C_1(p_1) + C_2(p_2) + \\mu \\, (p_1 + p_2 - D)^2$。\n- **惩罚系数**：$\\mu = 200$。\n- **算法**：对 $F(p_1,p_2)$ 使用带回溯线搜索的投影梯度下降法。\n- **比较容差**：$\\epsilon = 10^{-4}$。\n- **梯度下降的初始化**：$(p_1^{(0)},p_2^{(0)}) \\in \\{(10, 170), (120, 60), (80, 100), (30, 150)\\}$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是能源系统中经济调度的典型例子，这是电力工程的一个基本课题。使用二次成本函数叠加正弦波来模拟阀点效应是火力发电机成本曲线的标准、科学上公认的简化模型。该问题具有科学合理性。\n2.  **适定性**：目标函数和所有约束在数学上都是明确定义的。解的存在性得到保证，因为可行域是一个非空紧集（$\\mathbb{R}^2$ 中的一个线段），且成本函数是连续的。总发电容量为 $[\\underline{p}_1+\\underline{p}_2, \\overline{p}_1+\\overline{p}_2] = [10+20, 120+200] = [30, 320]$。需求 $D=180$ 在此范围内，因此可行解存在。任务的详细程度足以支持唯一的计算过程。该问题是适定的。\n3.  **客观性**：问题陈述使用精确、客观和数学化的语言编写。没有主观因素。\n4.  **不完整或矛盾的设置**：成本函数、约束和算法的所有参数都已提供。给定数据中没有矛盾之处。问题是完整且一致的。\n5.  **不切实际或不可行**：对于一个简化的学术电力系统模型，参数值在物理上合理的范围内。没有要求任何物理上不可能的情况。\n6.  **不适定或结构不良**：问题清晰地分为三个不同的任务。非凸性意味着像梯度下降这样的局部优化方法不能保证找到全局最优解，而这正是该问题旨在演示的一点。这是一个特点，而不是缺陷。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供一个解决方案。\n\n---\n\n该问题是一个非凸优化问题，旨在为两个发电机找到成本最低的调度方案。我们将首先通过将问题简化为一维并进行细粒度搜索，来找到全局最小值的高保真度近似。然后，对于几个初始点，我们将在目标函数的惩罚版本上运行投影梯度下降算法，以找到局部最小值。最后，我们将比较基于梯度的方法找到的成本与全局最小值，以确定在每种情况下其成功与否。\n\n**第1部分：全局最小值近似**\n\n目标是在满足 $p_1 + p_2 = D$ 和各发电机限制的条件下，最小化总成本 $C_{total}(p_1, p_2) = C_1(p_1) + C_2(p_2)$。我们可以将功率平衡约束代入目标函数，将问题简化为单个变量 $p_1$。\n令 $p_2 = D - p_1 = 180 - p_1$。总成本仅成为 $p_1$ 的函数：\n$$C(p_1) = C_1(p_1) + C_2(180 - p_1)$$\n$p_1$ 的可行范围必须同时满足其自身边界和对 $p_2$ 的隐含边界：\n1.  $p_1 \\in [\\underline{p}_1, \\overline{p}_1] \\implies p_1 \\in [10, 120]$。\n2.  $p_2 \\in [\\underline{p}_2, \\overline{p}_2] \\implies 20 \\le 180 - p_1 \\le 200$。\n第二个条件给出 $180 - 200 \\le p_1 \\le 180 - 20$，简化为 $-20 \\le p_1 \\le 160$。\n对这些约束求交集，我们发现 $p_1$ 的可行域为 $[\\max(10, -20), \\min(120, 160)] = [10, 120]$。\n\n为了找到全局最小值，我们对区间 $p_1 \\in [10, 120]$ 进行细粒度搜索。通过将此区间离散化为大量点并在每个点上评估 $C(p_1)$，我们可以找到全局最小成本的一个可靠的数值近似，我们将其表示为 $C^\\star$。\n\n**第2部分：投影梯度下降**\n\n此任务使用惩罚方法来处理等式约束 $p_1 + p_2 = D$。无约束（但仍有箱式约束）的目标函数是：\n$$F(p_1, p_2) = C_1(p_1) + C_2(p_2) + \\mu (p_1 + p_2 - D)^2$$\n其中 $\\mu=200$。我们应用投影梯度下降法。在每次迭代 $k$ 中，更新为：\n$\\mathbf{p}^{(k+1)} = \\Pi_{[\\underline{\\mathbf{p}}, \\overline{\\mathbf{p}}]}(\\mathbf{p}^{(k)} - \\alpha_k \\nabla F(\\mathbf{p}^{(k)}))$，其中 $\\mathbf{p} = (p_1, p_2)$ 且 $\\Pi$ 是到箱式约束 $[\\underline{p}_1, \\overline{p}_1] \\times [\\underline{p}_2, \\overline{p}_2]$ 上的投影算子。\n\n$F$ 的梯度为 $\\nabla F(\\mathbf{p}) = [\\frac{\\partial F}{\\partial p_1}, \\frac{\\partial F}{\\partial p_2}]^T$，其分量为：\n$$\\frac{\\partial F}{\\partial p_1} = \\frac{dC_1}{dp_1} + 2\\mu(p_1 + p_2 - D) = (2a_1 p_1 + b_1 + d_1 \\omega_1 \\cos(\\omega_1 p_1)) + 2\\mu(p_1 + p_2 - D)$$\n$$\\frac{\\partial F}{\\partial p_2} = \\frac{dC_2}{dp_2} + 2\\mu(p_1 + p_2 - D) = (2a_2 p_2 + b_2 + d_2 \\omega_2 \\cos(\\omega_2 p_2 + \\phi)) + 2\\mu(p_1 + p_2 - D)$$\n步长 $\\alpha_k$ 由回溯线搜索确定，这确保了每一步目标函数 $F$ 都有充分下降。\n\n算法收敛到一个点 $\\mathbf{p}_{final}$ 后，该点被映射回原问题的可行集。这是通过首先将 $p_{1, final}$ 投影到其可行区间 $[10, 120]$ 得到 $p_{1, mapped}$，然后设置 $p_{2, mapped} = D - p_{1, mapped}$ 以强制执行功率平衡约束来完成的。然后计算真实成本 $C_{local} = C_1(p_{1, mapped}) + C_2(p_{2, mapped})$。\n\n**第3部分：比较**\n\n对于四个初始化中的每一个，我们运行投影梯度下降算法以找到一个解及其对应的成本 $C_{local}$。然后我们将此成本与第1部分中找到的全局最小值 $C^\\star$ 进行比较。如果 $|C_{local} - C^\\star| \\le \\epsilon$，其中 $\\epsilon = 10^{-4}$，则声明梯度法成功。最终输出将是一个布尔值列表，指示每次初始化的成功情况。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-generator economic dispatch problem.\n\n    The solution involves three main steps:\n    1. Find a reliable approximation of the global minimum cost by reformulating the\n       problem in one dimension and performing a fine-grained grid search.\n    2. For each specified initial point, run a projected gradient descent algorithm\n       on a penalized version of the objective function to find a local minimum.\n    3. Compare the cost found by the gradient method with the global minimum\n       to determine if the global optimum was reached within a given tolerance.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    D = 180.0\n    p1_min, p1_max = 10.0, 120.0\n    p2_min, p2_max = 20.0, 200.0\n\n    a1, b1, c1, d1, omega1 = 2e-3, 4.0, 100.0, 15.0, 0.25\n    a2, b2, c2, d2, omega2, phi = 1.5e-3, 3.5, 80.0, 12.0, 0.33, 0.5\n\n    mu = 200.0\n    epsilon = 1e-4\n\n    # --- Helper Functions ---\n\n    def c1_func(p1):\n        \"\"\"Cost of generator 1.\"\"\"\n        return a1 * p1**2 + b1 * p1 + c1 + d1 * np.sin(omega1 * p1)\n\n    def c2_func(p2):\n        \"\"\"Cost of generator 2.\"\"\"\n        return a2 * p2**2 + b2 * p2 + c2 + d2 * np.sin(omega2 * p2 + phi)\n\n    def grad_c1(p1):\n        \"\"\"Gradient of C1.\"\"\"\n        return 2 * a1 * p1 + b1 + d1 * omega1 * np.cos(omega1 * p1)\n\n    def grad_c2(p2):\n        \"\"\"Gradient of C2.\"\"\"\n        return 2 * a2 * p2 + b2 + d2 * omega2 * np.cos(omega2 * p2 + phi)\n\n    def F_penalized(p):\n        \"\"\"Penalized objective function F(p1, p2).\"\"\"\n        p1, p2 = p\n        cost = c1_func(p1) + c2_func(p2)\n        penalty = mu * (p1 + p2 - D)**2\n        return cost + penalty\n\n    def grad_F(p):\n        \"\"\"Gradient of the penalized objective F.\"\"\"\n        p1, p2 = p\n        penalty_grad_term = 2 * mu * (p1 + p2 - D)\n        grad_p1 = grad_c1(p1) + penalty_grad_term\n        grad_p2 = grad_c2(p2) + penalty_grad_term\n        return np.array([grad_p1, grad_p2])\n\n    def project(p):\n        \"\"\"Project p onto the box constraints.\"\"\"\n        p1, p2 = p\n        p1_proj = np.clip(p1, p1_min, p1_max)\n        p2_proj = np.clip(p2, p2_min, p2_max)\n        return np.array([p1_proj, p2_proj])\n\n    # --- Task 1: Find Global Minimum ---\n    p1_feasible_min = max(p1_min, D - p2_max)\n    p1_feasible_max = min(p1_max, D - p2_min)\n    \n    # Fine-grained search over the feasible 1D interval for p1\n    num_points = 200000\n    p1_grid = np.linspace(p1_feasible_min, p1_feasible_max, num_points)\n    p2_grid = D - p1_grid\n    \n    total_cost_grid = c1_func(p1_grid) + c2_func(p2_grid)\n    global_min_cost = np.min(total_cost_grid)\n\n    # --- Task 2  3: Projected Gradient Descent and Comparison ---\n    initializations = [\n        np.array([10.0, 170.0]),\n        np.array([120.0, 60.0]),\n        np.array([80.0, 100.0]),\n        np.array([30.0, 150.0]),\n    ]\n    \n    results = []\n\n    for p_init in initializations:\n        p_curr = np.copy(p_init)\n\n        # PGD algorithm parameters\n        max_iter = 2000\n        tolerance = 1e-8\n        c_bt = 0.5  # Armijo condition constant\n        tau_bt = 0.8 # Backtracking step size reduction factor\n\n        for _ in range(max_iter):\n            grad = grad_F(p_curr)\n            dk = -grad\n            \n            # Backtracking line search\n            alpha = 1.0\n            f_curr = F_penalized(p_curr)\n            grad_dot_d = np.dot(grad, dk)\n            \n            while F_penalized(p_curr + alpha * dk) > f_curr + c_bt * alpha * grad_dot_d:\n                alpha *= tau_bt\n            \n            p_next_unproj = p_curr + alpha * dk\n            p_next = project(p_next_unproj)\n            \n            if np.linalg.norm(p_next - p_curr)  tolerance:\n                p_curr = p_next\n                break\n            \n            p_curr = p_next\n\n        # Map the final PGD iterate to the feasible manifold of the original problem\n        p_final_pgd = p_curr\n        p1_mapped = np.clip(p_final_pgd[0], p1_feasible_min, p1_feasible_max)\n        p2_mapped = D - p1_mapped\n        \n        # Calculate the true constrained cost at the mapped point\n        cost_pgd = c1_func(p1_mapped) + c2_func(p2_mapped)\n        \n        # Compare with the global minimum\n        is_global = abs(cost_pgd - global_min_cost) = epsilon\n        results.append(is_global)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}