{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本章节提供了一系列动手实践，旨在加深您对线性和混合整数规划在能源系统建模中应用的理解。第一个练习将引导您分析一个经典的双节点电力系统，这是理解输电阻塞如何导致区域电价差异的基础。通过解决这个问题，您将亲手使用对偶理论推导出节点边际电价（LMP），并理解其作为系统约束影子价格的经济学含义 。",
            "id": "4101761",
            "problem": "考虑一个在单个时间区间内运行的单线路、双节点电力系统。节点A有一个火力发电机，其边际成本恒为每兆瓦时 $20$ 美元，容量为 $\\bar{g}_A = 200$ 兆瓦。节点B有一个火力发电机，其边际成本恒为每兆瓦时 $50$ 美元，容量为 $\\bar{g}_B = 100$ 兆瓦。节点A的需求为 $d_A = 120$ 兆瓦，节点B的需求为 $d_B = 60$ 兆瓦。电力可以通过一条单输电线路在节点A和节点B之间流动，该线路在任一方向上的容量均为 $\\bar{f} = 30$ 兆瓦。\n\n将该系统调度问题构建为一个线性规划模型，其目标是最小化总发电成本，并满足节点功率平衡、发电机容量限制和输电容量限制等约束条件。使用线性规划对偶和互补松弛性的严格推导，确定节点B处节点平衡约束的影子价格，该价格等于最小总成本相对于 $d_B$ 无穷小增量的灵敏度（导数）。\n\n以美元/兆瓦时 ($/\\mathrm{MWh}$) 为单位报告最终值。最终答案必须是方框中的一个不带单位的实数。",
            "solution": "该问题经评估有效。这是一个在能源系统建模领域中提法得当、有科学依据且客观的问题，具体涉及经济调度和线性规划对偶。所有必要的数据和约束条件都已提供，并且它们内部是一致的。\n\n该问题要求解节点B处节点平衡约束的影子价格。这等同于在一个成本最小化的线性规划（LP）问题中，求解与此约束相关的对偶变量的值。\n\n首先，我们构建原始线性规划模型。设决策变量为：\n- $g_A$：节点A的发电功率，单位为兆瓦（MW）。\n- $g_B$：节点B的发电功率，单位为兆瓦（MW）。\n- $f_{AB}$：从节点A到节点B的潮流功率，单位为兆瓦（MW）。正值表示从A到B的流动，负值表示从B到A的流动。\n\n目标是最小化总发电成本 $Z$，它是发电水平的线性函数：\n$$\n\\text{Minimize } Z = 20 g_A + 50 g_B\n$$\n\n该最小化问题受以下几个约束条件的限制：\n\n1.  **节点功率平衡**：在每个节点，发电功率加流入功率必须等于电力需求加流出功率。\n    -   节点A：$g_A = d_A + f_{AB}$。给定 $d_A = 120$，则有 $g_A - f_{AB} = 120$。\n    -   节点B：$g_B + f_{AB} = d_B$。给定 $d_B = 60$，则有 $g_B + f_{AB} = 60$。\n\n2.  **发电机容量限制**：每个发电机的输出不能超过其容量，并且必须为非负值。\n    -   $0 \\le g_A \\le \\bar{g}_A$，其中 $\\bar{g}_A = 200$。因此，$0 \\le g_A \\le 200$。\n    -   $0 \\le g_B \\le \\bar{g}_B$，其中 $\\bar{g}_B = 100$。因此，$0 \\le g_B \\le 100$。\n\n3.  **输电容量限制**：A和B之间线路上的潮流功率在任一方向上都不能超过其容量。\n    -   $-\\bar{f} \\le f_{AB} \\le \\bar{f}$，其中 $\\bar{f} = 30$。因此，$-30 \\le f_{AB} \\le 30$。\n\n为了找到这个原始问题的最优解，我们注意到节点A的发电成本（$20\\ \\$/\\mathrm{MWh}$）比节点B的（$50\\ \\$/\\mathrm{MWh}$）便宜。因此，系统会尝试最大限度地使用发电机A来满足 $d_A + d_B = 120 + 60 = 180$ 兆瓦的总需求。如果输电没有限制，最优解将是 $g_A = 180$ 兆瓦和 $g_B = 0$ 兆瓦。这将需要一个潮流 $f_{AB}$ 来满足节点平衡：\n- 节点A：$180 = 120 + f_{AB} \\implies f_{AB} = 60$ 兆瓦。\n- 节点B：$0 + f_{AB} = 60 \\implies f_{AB} = 60$ 兆瓦。\n然而，这个 $60$ 兆瓦的潮流违反了 $30$ 兆瓦的输电容量限制。输电线路发生了阻塞。因此，从A到B的潮流将处于其最大容量，即 $f_{AB} = 30$ 兆瓦。\n\n在潮流因阻塞而固定为 $f_{AB} = 30$ 兆瓦的情况下，我们可以确定最优的发电水平：\n- 根据节点A的平衡：$g_A = 120 + f_{AB} = 120 + 30 = 150$ 兆瓦。这是可行的，因为 $0 \\le 150 \\le 200$。\n- 根据节点B的平衡：$g_B = 60 - f_{AB} = 60 - 30 = 30$ 兆瓦。这是可行的，因为 $0 \\le 30 \\le 100$。\n\n所以，原始问题的最优解是 $g_A^* = 150$，$g_B^* = 30$ 和 $f_{AB}^* = 30$。\n\n为了找到影子价格，我们必须使用线性规划对偶。让我们将节点平衡约束定义为一种标准形式，以便将对偶变量解释为价格。设对偶变量 $\\lambda_A$ 与节点A的平衡约束相关联，$\\lambda_B$ 与节点B的平衡约束相关联。\n$$\n120 + f_{AB} - g_A = 0 \\quad (\\lambda_A)\n$$\n$$\n60 - f_{AB} - g_B = 0 \\quad (\\lambda_B)\n$$\n通过这种构建方式，对偶变量 $\\lambda_B$ 代表了最优成本对节点B需求变化的灵敏度，即 $\\frac{\\partial Z^*}{\\partial d_B}$，这正是问题所要求的。\n\n其他约束是不等式：\n$$\ng_A - 200 \\le 0 \\quad (\\mu_{A,up} \\ge 0)\n$$\n$$\n-g_A \\le 0 \\quad (\\mu_{A,low} \\ge 0)\n$$\n$$\ng_B - 100 \\le 0 \\quad (\\mu_{B,up} \\ge 0)\n$$\n$$\n-g_B \\le 0 \\quad (\\mu_{B,low} \\ge 0)\n$$\n$$\nf_{AB} - 30 \\le 0 \\quad (\\gamma_{up} \\ge 0)\n$$\n$$\n-f_{AB} - 30 \\le 0 \\quad (\\gamma_{low} \\ge 0)\n$$\n该问题的拉格朗日函数是：\n$L = (20g_A + 50g_B) + \\lambda_A(120 + f_{AB} - g_A) + \\lambda_B(60 - f_{AB} - g_B) + \\mu_{A,up}(g_A - 200) + \\mu_{A,low}(-g_A) + \\mu_{B,up}(g_B - 100) + \\mu_{B,low}(-g_B) + \\gamma_{up}(f_{AB} - 30) + \\gamma_{low}(-f_{AB} - 30)$.\n\n最优性的卡罗需-库恩-塔克（KKT）条件要求拉格朗日函数对原始变量的偏导数为零：\n$$\n\\frac{\\partial L}{\\partial g_A} = 20 - \\lambda_A + \\mu_{A,up} - \\mu_{A,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial g_B} = 50 - \\lambda_B + \\mu_{B,up} - \\mu_{B,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial f_{AB}} = \\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0\n$$\n互补松弛条件指出，如果一个不等式约束不是紧的（即松弛量非零），其对应的对偶变量必须为零。我们在最优原始解 $(g_A^* = 150, g_B^* = 30, f_{AB}^* = 30)$ 处评估这些条件：\n- $0 < g_A^* < 200 \\implies$ $g_A$ 的两个容量约束都不是紧的。因此，$\\mu_{A,up} = 0$ 和 $\\mu_{A,low} = 0$。\n- $0 < g_B^* < 100 \\implies$ $g_B$ 的两个容量约束都不是紧的。因此，$\\mu_{B,up} = 0$ 和 $\\mu_{B,low} = 0$。\n- $f_{AB}^* = 30 \\implies$ 上输电限制 $f_{AB} \\le 30$ 是紧的。因此，$\\gamma_{up} \\ge 0$。\n- $f_{AB}^* = 30 > -30 \\implies$ 下输电限制 $f_{AB} \\ge -30$ (或 $-f_{AB} \\le 30$) 不是紧的。因此，$\\gamma_{low} = 0$。\n\n将这些值代入KKT条件：\n1.  从 $\\frac{\\partial L}{\\partial g_A}$ 方程：$20 - \\lambda_A + 0 - 0 = 0 \\implies \\lambda_A = 20$。\n2.  从 $\\frac{\\partial L}{\\partial g_B}$ 方程：$50 - \\lambda_B + 0 - 0 = 0 \\implies \\lambda_B = 50$。\n\n与节点B处节点平衡约束相关的对偶变量的值是 $\\lambda_B = 50$。这个值代表了在节点B供应额外一兆瓦时电力的边际成本。由于来自较便宜电源（A）的输电线路发生阻塞，节点B的任何额外需求都必须由本地更昂贵的发电机（B）来满足，其边际成本为 $50\\ \\$/\\mathrm{MWh}$。\n\n作为一致性检查，我们可以使用第三个KKT条件：\n$\\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0 \\implies 20 - 50 + \\gamma_{up} - 0 = 0 \\implies \\gamma_{up} = 30$。\n值 $\\gamma_{up} = 30$ 是非负的，与KKT条件一致。这个对偶变量代表了输电线路上的阻塞租金，它等于两个节点之间位置边际电价的差值。\n\n节点B处节点平衡约束的影子价格是 $\\lambda_B$。",
            "answer": "$$\\boxed{50}$$"
        },
        {
            "introduction": "在掌握了静态的节点定价基础之后，我们将引入时间维度，这在实际的电力系统运行中至关重要。第二个练习探讨一个多时段的经济调度问题，其中包含了发电机的爬坡约束，这是一种常见的跨时段运行限制。通过这个案例，您将学习到能源的“稀缺价值”不仅来源于发电容量的不足，也可能源于系统在特定时刻的灵活性短缺，例如当爬坡和容量上限同时被触发时。您需要运用对偶性和互补松弛性条件，来精确量化这些运行约束共同作用下产生的稀缺价值 。",
            "id": "4101753",
            "problem": "考虑一个单节点电力系统，该系统在一个常规发电机的支持下运行 $T=3$ 个离散时段。该系统必须满足电量平衡、发电机容量和跨时段爬坡限制。设发电机的初始出力为 $x_0=20$ $\\mathrm{MW}$。在时段 $t \\in \\{1,2,3\\}$，净需求分别为 $d_1=30$ $\\mathrm{MW}$，$d_2=80$ $\\mathrm{MW}$ 和 $d_3=60$ $\\mathrm{MW}$。发电机的额定容量为 $P^{\\max}=70$ $\\mathrm{MW}$，向上爬坡限制为每时段 $R^{\\uparrow}=40$ $\\mathrm{MW}$，向下爬坡限制为每时段 $R^{\\downarrow}=30$ $\\mathrm{MW}$。对于所有时段 $t$，发电机的可变生产成本恒为 $c_t=30$ $\\mathrm{\\$/MWh}$。为确保可行性，允许进行非自愿切负荷 $s_t \\ge 0$（单位为每时段 $\\mathrm{MWh}$），其产生的惩罚等于失负荷价值 (VoLL)，其中 $v=1000$ $\\mathrm{\\$/MWh}$。\n\n将此集中式调度问题构建为一个线性规划 (LP) 问题，其目标是最小化总可变生产成本与非自愿切负荷成本之和，并满足以下约束条件：\n- 每个时段的电量平衡，\n- 发电机容量上下限，\n- 连续时段之间的向上和向下爬坡约束，\n- 非负性约束。\n\n然后，从线性规划对偶和互补松弛性的核心定义出发，推导对偶条件，并用其计算在时段 $t=2$ 由发电机容量上界紧约束和向上爬坡紧约束共同产生的唯一总稀缺价值。具体来说，计算量 $\\alpha_2 + \\rho_2^{\\uparrow}$，其中 $\\alpha_2$ 是时段 $2$ 容量上界约束的影子价格，$\\rho_2^{\\uparrow}$ 是时段 $2$ 向上爬坡约束的影子价格，两者均在原始最优解处取值。\n\n以 $\\mathrm{\\$/MWh}$ 为单位表示您的最终答案。无需四舍五入。您的最终答案必须是一个实数。",
            "solution": "用户要求我使用线性规划 (LP) 和对偶理论来求解并分析一个单节点电力系统的调度问题。\n\n### 步骤 1：提取已知条件\n-   时间周期：$T=3$ 个离散时段。\n-   决策变量：发电机出力 $x_t$ [MW] 和非自愿切负荷 $s_t$ [MWh/时段]，其中 $t \\in \\{1,2,3\\}$。\n-   初始条件：初始发电机出力 $x_0 = 20$ MW。\n-   需求：$d_1 = 30$ MW，$d_2 = 80$ MW，$d_3 = 60$ MW。\n-   发电机参数：\n    -   最大容量：$P^{\\max} = 70$ MW。\n    -   向上爬坡限制：每时段 $R^{\\uparrow} = 40$ MW。\n    -   向下爬坡限制：每时段 $R^{\\downarrow} = 30$ MW。\n    -   可变生产成本：对于所有 $t$，$c_t = 30\\ \\$/\\mathrm{MWh}$。\n-   切负荷参数：\n    -   失负荷价值 (VoLL)：$v = 1000\\ \\$/\\mathrm{MWh}$。\n-   非负性：$s_t \\ge 0$。发电机出力 $x_t$ 也隐含为非负。\n-   目标：计算时段 $t=2$ 的总稀缺价值 $\\alpha_2 + \\rho_2^{\\uparrow}$。\n\n该问题隐含地假设每个时段的时间步长为 $\\Delta t=1$ 小时，因为可变成本以 $\\$/MWh$ 给出，切负荷以每时段 MWh 给出。因此，对于每个时段，以 MW 为单位的功率数值上等于以 MWh 为单位的电量。所有约束都将以电量 (MWh) 来处理。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是一个标准的、简化的经济调度模型，是能源系统分析的基石。它坚实地建立在线性规划原理及其在电力系统中的应用之上。该问题在科学上是合理的。\n-   **适定性**：该问题是一个具有凸可行集和线性目标函数的线性规划问题。保证存在最优解。所提供的数据似乎会导出一个唯一的最优解。\n-   **客观性**：该问题使用精确、客观的数学和经济术语（如成本、容量、爬坡限制）进行陈述。\n-   **完整性与一致性**：该问题提供了构建和求解 LP 所需的所有数据和约束。所提供的数据中没有矛盾。\n-   **结论**：该问题是有效的。\n\n### 步骤 3：判定与行动\n该问题是有效的。我将继续进行求解。\n\n### 原始问题构建\n目标是最小化总系统成本，即发电成本和切负荷成本之和。\n设决策变量为每个时段 $t \\in \\{1, 2, 3\\}$ 的发电机出力 $x_t$ 和切负荷 $s_t$。\n\n线性规划问题为：\n$$\n\\min_{x_t, s_t} \\sum_{t=1}^{3} (c_t x_t + v s_t)\n$$\n约束条件：\n\\begin{align*}\nx_t + s_t = d_t   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(电量平衡)} \\\\\nx_t \\le P^{\\max}   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(容量上界)} \\\\\nx_t \\ge 0   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(容量下界)} \\\\\nx_t - x_{t-1} \\le R^{\\uparrow}   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(向上爬坡)} \\\\\nx_{t-1} - x_t \\le R^{\\downarrow}   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(向下爬坡)} \\\\\ns_t \\ge 0   &\\quad \\forall t \\in \\{1,2,3\\}   \\text{(非负切负荷)}\n\\end{align*}\n其中 $x_0 = 20$ 是一个给定的参数。\n\n### 原始问题求解\n我们可以通过观察法求解这个小问题，在满足约束条件的前提下，在每一步中最小化昂贵的切负荷 ($s_t$) 的使用。\n\n*   **时段 $t=1$**：\n    *   需求为 $d_1 = 30$。\n    *   从 $x_0=20$ 开始爬坡：$20 - R^{\\downarrow} \\le x_1 \\le 20 + R^{\\uparrow} \\implies 20 - 30 \\le x_1 \\le 20 + 40 \\implies -10 \\le x_1 \\le 60$。\n    *   容量限制：$0 \\le x_1 \\le P^{\\max} = 70$。\n    *   因此，$x_1$ 的可行范围是 $[0, 60]$。为了以最小成本满足需求 $d_1=30$，我们设定 $x_1^* = 30$，这是可行的。这使得切负荷为零，$s_1^* = 0$。\n\n*   **时段 $t=2$**：\n    *   需求为 $d_2 = 80$。\n    *   从 $x_1^*=30$ 开始爬坡：$30 - R^{\\downarrow} \\le x_2 \\le 30 + R^{\\uparrow} \\implies 30 - 30 \\le x_2 \\le 30 + 40 \\implies 0 \\le x_2 \\le 70$。\n    *   容量限制：$0 \\le x_2 \\le P^{\\max} = 70$。\n    *   因此，$x_2$ 的可行范围是 $[0, 70]$。需求为 $d_2=80$。为了最小化成本，我们必须最大化发电量 $x_2$。可能的最大值为 $x_2^* = 70$。\n    *   这个出力不足以满足全部需求。电量平衡方程 $x_2^* + s_2^* = d_2$ 给出 $70 + s_2^* = 80$，所以我们必须进行非自愿切负荷 $s_2^* = 10$。\n\n*   **时段 $t=3$**：\n    *   需求为 $d_3 = 60$。\n    *   从 $x_2^*=70$ 开始爬坡：$70 - R^{\\downarrow} \\le x_3 \\le 70 + R^{\\uparrow} \\implies 70 - 30 \\le x_3 \\le 70 + 40 \\implies 40 \\le x_3 \\le 110$。\n    *   容量限制：$0 \\le x_3 \\le P^{\\max} = 70$。\n    *   因此，$x_3$ 的可行范围是 $[40, 70]$。为了以最小成本满足需求 $d_3=60$，我们设定 $x_3^* = 60$，这是可行的。这导致切负荷为零，$s_3^* = 0$。\n\n原始最优解为：\n$x_1^* = 30$, $s_1^* = 0$\n$x_2^* = 70$, $s_2^* = 10$\n$x_3^* = 60$, $s_3^* = 0$\n\n### 对偶问题和 KKT 条件\n为了找到影子价格，我们构建对偶问题。让我们为原始问题的每个约束分配对偶变量：\n\\begin{align*}\nx_t + s_t = d_t  &\\quad : \\lambda_t \\quad (\\text{自由变量}) \\\\\nx_t \\le P^{\\max}  &\\quad : \\alpha_t \\ge 0 \\\\\n-x_t \\le 0  &\\quad : \\beta_t \\ge 0 \\\\\nx_t - x_{t-1} \\le R^{\\uparrow}  &\\quad : \\rho_t^{\\uparrow} \\ge 0 \\\\\nx_{t-1} - x_t \\le R^{\\downarrow}  &\\quad : \\rho_t^{\\downarrow} \\ge 0 \\\\\n-s_t \\le 0  &\\quad : \\sigma_t \\ge 0\n\\end{align*}\n\n最优性的卡罗需-库恩-塔克 (KKT) 条件包括驻点条件和互补松弛性。从拉格朗日函数导出的驻点条件是：\n\\begin{itemize}\n    \\item 对于 $s_t$：该项中没有 $c_t$，而是 $v$。所以 $v - \\lambda_t - \\sigma_t = 0 \\implies \\lambda_t + \\sigma_t = v$，对于 $t \\in \\{1,2,3\\}$。\n    \\item 对于 $x_t$：通用形式为 $c_t - \\lambda_t + \\alpha_t - \\beta_t + (\\rho_t^{\\uparrow} - \\rho_t^{\\downarrow}) - (\\rho_{t+1}^{\\uparrow} - \\rho_{t+1}^{\\downarrow}) = 0$，其中我们定义 $\\rho_4^{\\uparrow} = \\rho_4^{\\downarrow} = 0$。\n\\end{itemize}\n互补松弛性要求，对于任何不等式约束，要么该约束是紧约束（以等式成立），要么其对应的对偶变量为零。\n\n### 计算稀缺价值 $\\alpha_2 + \\rho_2^{\\uparrow}$\n我们需要计算 $\\alpha_2 + \\rho_2^{\\uparrow}$。我们关注时段 $t=2$ 的 KKT 条件。\n\n1.  **关于 $s_2$ 的驻点条件**：条件是 $\\lambda_2 + \\sigma_2 = v$。\n    在最优解处，$s_2^* = 10 > 0$。根据约束 $-s_2 \\le 0$ 的互补松弛性，其对应的对偶变量 $\\sigma_2$ 必须为零。\n    因此，$\\lambda_2 + 0 = v \\implies \\lambda_2 = v = 1000$。时段 2 的电量影子价格 $\\lambda_2$ 等于失负荷价值，这是预料之中的，因为正在发生切负荷。\n\n2.  **关于 $x_2$ 的驻点条件**：对于 $t=2$ 的条件是：\n    $$c_2 - \\lambda_2 + \\alpha_2 - \\beta_2 + (\\rho_2^{\\uparrow} - \\rho_2^{\\downarrow}) - (\\rho_3^{\\uparrow} - \\rho_3^{\\downarrow}) = 0$$\n    我们可以通过使用互补松弛性确定其他对偶变量，来求解我们感兴趣的量 $\\alpha_2 + \\rho_2^{\\uparrow}$。\n\n3.  **应用时段 2 的互补松弛性**：\n    *   $x_2^* = 70 > 0$。约束 $-x_2 \\le 0$ 不是紧约束，所以 $\\beta_2 = 0$。\n    *   $x_2^* = 70 = P^{\\max}$。容量上界 $x_2 \\le P^{\\max}$ 是**紧约束**。因此，$\\alpha_2 \\ge 0$。\n    *   $x_2^* - x_1^* = 70 - 30 = 40 = R^{\\uparrow}$。向上爬坡约束 $x_2 - x_1 \\le R^{\\uparrow}$ 是**紧约束**。因此，$\\rho_2^{\\uparrow} \\ge 0$。\n    *   $x_1^* - x_2^* = 30 - 70 = -40$。由于 $-40 < R^{\\downarrow} = 30$，向下爬坡约束不是紧约束。因此，$\\rho_2^{\\downarrow} = 0$。\n\n4.  **应用时段 3 的互补松弛性（以找到与未来相关的项）**：\n    *   $x_3^* - x_2^* = 60 - 70 = -10$。由于 $-10 < R^{\\uparrow} = 40$，向上爬坡约束 $x_3 - x_2 \\le R^{\\uparrow}$ 不是紧约束。因此，$\\rho_3^{\\uparrow} = 0$。\n    *   $x_2^* - x_3^* = 70 - 60 = 10$。由于 $10 < R^{\\downarrow} = 30$，向下爬坡约束 $x_2 - x_3 \\le R^{\\downarrow}$ 不是紧约束。因此，$\\rho_3^{\\downarrow} = 0$。\n\n5.  **最终计算**：将已知的对偶变量值代入 $x_2$ 的驻点条件方程：\n    $$c_2 - \\lambda_2 + \\alpha_2 - 0 + (\\rho_2^{\\uparrow} - 0) - (0 - 0) = 0$$\n    这简化为：\n    $$c_2 - \\lambda_2 + \\alpha_2 + \\rho_2^{\\uparrow} = 0$$\n    整理以求解目标表达式：\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = \\lambda_2 - c_2$$\n    我们已知 $\\lambda_2 = 1000$ $\\mathrm{\\$/MWh}$ 并且给定 $c_2 = 30$ $\\mathrm{\\$/MWh}$。\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = 1000 - 30 = 970$$\n总稀缺价值 $\\alpha_2 + \\rho_2^{\\uparrow}$ 为 $970$ $\\mathrm{\\$/MWh}$。该值表示在时段 2 由于同时达到发电机的物理容量极限及其跨时段向上爬坡极限而导致的总边际成本增加。它是电量的边际成本 $\\lambda_2$ 超过发电机边际生产成本 $c_2$ 的数额。",
            "answer": "$$\\boxed{970}$$"
        },
        {
            "introduction": "现实世界中的能源系统模型通常规模庞大，直接求解非常困难，因此需要高级的分解算法。本节的最后一个高级练习将带您领略 Dantzig-Wolfe 分解法在大型机组组合问题中的应用。该方法的核心思想是将原问题分解为主问题和定价子问题，并利用主问题的对偶变量（即价格信号）来“生成”新的、能降低总成本的决策方案（即列）。通过为单个发电机组构建并求解定价子问题，您将体验到价格在引导大规模优化算法走向最优解过程中的核心作用 。",
            "id": "4071641",
            "problem": "考虑一个在Dantzig–Wolfe分解下的能源系统调度模型，其中受限主问题(RMP)在多个列之间进行选择，每个列代表单个火电机组在有限时间范围内的可行逐时调度方案。RMP的目标是通过列的凸组合在精确满足需求的同时，最小化总系统成本。该分解建立在线性规划对偶和可行集凸化等经过充分检验的理论基础之上。设时间范围为 $T = 4$ 小时，由 $t \\in \\{1,2,3,4\\}$ 索引。在RMP中，耦合约束强制执行逐时供需平衡，并具有相关的对偶乘子。\n\n您的任务是为一个火电机组推导其定价问题（即列生成子问题），该机组的可行集由二进制启停决策和受逻辑与爬坡约束的连续功率输出定义。对混合整数线性规划(MILP)机组模型使用以下经过充分检验的建模假设：\n- 机组在每个小时 $t$ 具有启停状态 $u_t \\in \\{0,1\\}$ 和启动指示变量 $y_t \\in \\{0,1\\}$。\n- 机组在每个小时 $t$ 的功率输出为 $p_t \\ge 0$。\n- 逻辑和能力约束成立：$p_t \\le P^{\\max} u_t$，$p_t \\ge P^{\\min} u_t$，以及 $y_t \\ge u_t - u_{t-1}$，给定 $u_0 = 0$ 和 $p_0 = 0$。\n- 对称的逐时爬坡限制成立：$p_t - p_{t-1} \\le R$ 和 $p_{t-1} - p_t \\le R$，对所有 $t \\in \\{1,2,3,4\\}$ 成立。\n\nRMP是一个带有等式耦合约束的最小化问题，其小时 $t=1,2,3,4$ 的对偶乘子由 $\\pi_1, \\pi_2, \\pi_3, \\pi_4$ 给出，单位均为 $\\text{USD}/\\text{MWh}$。设一个列中机组的成本为每次启动成本和可变能源成本之和：每次启动的启动成本为 $c_s$（单位 $\\text{USD}$），应用于 $p_t$ 的可变成本为 $c_v$（单位 $\\text{USD}/\\text{MWh}$）。\n\n从线性规划中折算成本的基本定义和标准的Dantzig–Wolfe分解设置出发，推导出该单个机组的定价问题，该问题计算要添加到RMP中的最小折算成本列。然后，使用以下数值数据：\n- $P^{\\min} = 50$ $\\text{MW}$, $P^{\\max} = 200$ $\\text{MW}$,\n- $R = 80$ $\\text{MW}/\\text{h}$,\n- $c_s = 500$ $\\text{USD}$, $c_v = 30$ $\\text{USD}/\\text{MWh}$,\n- $\\pi_1 = 45$ $\\text{USD}/\\text{MWh}$, $\\pi_2 = 60$ $\\text{USD}/\\text{MWh}$, $\\pi_3 = 40$ $\\text{USD}/\\text{MWh}$, $\\pi_4 = 50$ $\\text{USD}/\\text{MWh}$,\n\n计算该机组定价问题的最优值（即最小折算成本）。请以美元(USD)表示您的最终答案。无需四舍五入；报告精确值。",
            "solution": "我们从受限主问题(RMP)的Dantzig–Wolfe分解的基本设置开始。令每个列 $j$ 代表机组在时间范围 $t \\in \\{1,2,3,4\\}$ 内的一个可行调度方案，其相关成本为 $c_j$，逐时发电贡献向量为 $(a_{1j}, a_{2j}, a_{3j}, a_{4j})$。RMP是一个线性规划问题，其目标是最小化 $\\sum_{j} c_j x_j$，并受限于耦合约束\n$$\n\\sum_{j} a_{tj} x_j = D_t \\quad \\text{对所有 } t \\in \\{1,2,3,4\\},\n$$\n以及 $x_j \\ge 0$，其中 $D_t$ 是逐时需求，$x_j$ 是列权重。根据线性规划对偶性，等式约束产生对偶变量 $\\pi_t$（符号自由），每个小时 $t$ 对应一个。\n\n列 $j$ 的折算成本由经过充分检验的规则定义\n$$\nr_j = c_j - \\sum_{t=1}^{4} \\pi_t a_{tj}.\n$$\n在针对最小化RMP的列生成中，我们寻找具有负折算成本的列来改进目标函数。对于一个特定的机组，定价问题是在机组的可行集 $\\mathcal{S}$ 上最小化折算成本：\n$$\n\\min_{s \\in \\mathcal{S}} \\left( c(s) - \\sum_{t=1}^{4} \\pi_t a_t(s) \\right),\n$$\n其中 $s$ 编码了机组的启停和出力轨迹，$c(s)$ 是机组在时间范围内的成本，$a_t(s)$ 是调度方案 $s$ 在小时 $t$ 供应的电量。\n\n现在我们使用MILP机组模型来实例化 $c(s)$ 和 $a_t(s)$。令 $u_t \\in \\{0,1\\}$ 表示启停状态，$y_t \\in \\{0,1\\}$ 表示启动指示变量，$p_t \\ge 0$ 表示功率输出。可行集 $\\mathcal{S}$ 由以下条件刻画：\n- 能力约束：$p_t \\le P^{\\max} u_t$ 和 $p_t \\ge P^{\\min} u_t$ 对所有 $t$ 成立。\n- 启动逻辑：$y_t \\ge u_t - u_{t-1}$，其中 $u_0 = 0$ 和 $p_0 = 0$。\n- 爬坡约束：$p_t - p_{t-1} \\le R$ 和 $p_{t-1} - p_t \\le R$ 对所有 $t$ 成立。\n\n成本函数为\n$$\nc(s) = c_s \\sum_{t=1}^{4} y_t + c_v \\sum_{t=1}^{4} p_t,\n$$\n而电量贡献就是 $a_t(s) = p_t$。\n\n因此，定价问题是以下混合整数线性规划(MILP)问题：\n$$\n\\min_{u_t, y_t, p_t} \\left[ c_s \\sum_{t=1}^{4} y_t + \\sum_{t=1}^{4} \\left( c_v - \\pi_t \\right) p_t \\right]\n$$\n受限于\n\\begin{align*}\n p_t \\le P^{\\max} u_t &\\quad \\text{对 } t=1,2,3,4, \\\\\n p_t \\ge P^{\\min} u_t &\\quad \\text{对 } t=1,2,3,4, \\\\\n y_t \\ge u_t - u_{t-1} &\\quad \\text{对 } t=1,2,3,4, \\\\\n p_t - p_{t-1} \\le R &\\quad \\text{对 } t=1,2,3,4, \\\\\n p_{t-1} - p_t \\le R &\\quad \\text{对 } t=1,2,3,4, \\\\\n u_t \\in \\{0,1\\}, \\; y_t \\in \\{0,1\\}, \\; p_t \\ge 0, \\\\\n u_0 = 0, \\; p_0 = 0.\n\\end{align*}\n\n使用给定的数值参数：\n- $P^{\\min} = 50$, $P^{\\max} = 200$, $R = 80$,\n- $c_s = 500$, $c_v = 30$,\n- $\\pi_1 = 45$, $\\pi_2 = 60$, $\\pi_3 = 40$, $\\pi_4 = 50$,\n\n$p_t$ 的目标函数系数变为\n\\begin{align*}\n c_v - \\pi_1 &= 30 - 45 = -15, \\\\\n c_v - \\pi_2 &= 30 - 60 = -30, \\\\\n c_v - \\pi_3 &= 30 - 40 = -10, \\\\\n c_v - \\pi_4 &= 30 - 50 = -20.\n\\end{align*}\n因此，定价问题的目标函数是\n$$\n\\min \\left[ 500 \\sum_{t=1}^{4} y_t + (-15) p_1 + (-30) p_2 + (-10) p_3 + (-20) p_4 \\right].\n$$\n\n因为所有的 $c_v - \\pi_t$ 都是负数，增加 $p_t$ 会降低目标函数值（对最小化问题有利），但这受到能力和爬坡约束的限制，并且在从关机到开机转换时会产生启动成本。最优策略是只进行一次启动，并在满足 $P^{\\max}$ 和 $R$ 约束的条件下尽可能多地发电，同时尽可能早地开始，以利用所有的负系数。\n\n从 $u_0 = 0$ 和 $p_0 = 0$ 开始，如果我们从 $t=1$ 时刻启动（$u_1=1$, $y_1=1$），爬坡和能力约束得出：\n- 在 $t=1$ 时：$p_1 \\in [50, \\min(200, 0 + 80)] = [50, 80]$，因此选择 $p_1 = 80$。\n- 在 $t=2$ 时：$p_2 \\in [50, \\min(200, 80 + 80)] = [50, 160]$，因此选择 $p_2 = 160$。\n- 在 $t=3$ 时：$p_3 \\in [50, \\min(200, 160 + 80)] = [50, 200]$，因此选择 $p_3 = 200$。\n- 在 $t=4$ 时：$p_4 \\in [50, \\min(200, 200 + 80)] = [50, 200]$，因此选择 $p_4 = 200$。\n\n在此期间保持机组运行可以避免额外的启动，所以 $\\sum_{t=1}^{4} y_t = 1$。该调度方案下的目标函数值为\n\\begin{align*}\n 500 \\cdot 1 + (-15) \\cdot 80 + (-30) \\cdot 160 + (-10) \\cdot 200 + (-20) \\cdot 200 \\\\\n= 500 - 1200 - 4800 - 2000 - 4000 \\\\\n= 500 - 12000 \\\\\n= -11500.\n\\end{align*}\n\n我们简要检查其他方案以确保最优性：\n- 保持关机状态的目标函数值为 $0$，高于 $-11500$（对最小化问题更差）。\n- 延迟启动（例如，在 $t=2$ 时）会减少可利用的负系数，并受到爬坡约束，从而得到一个不太理想的目标值（例如，$-7500$）。\n- 多次启动会增加 $\\sum y_t$ 并产生额外的启动成本；考虑到负的 $c_v - \\pi_t$ 系数，采用单次连续运行并以最大可行功率输出的方案更优。\n\n因此，该定价问题的最优折算成本为 $-11500$ $\\text{USD}$。",
            "answer": "$$\\boxed{-11500}$$"
        }
    ]
}