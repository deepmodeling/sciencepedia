{
    "hands_on_practices": [
        {
            "introduction": "理解对偶变量的经济意义始于经典的经济调度问题。本练习将指导你基于机组的成本排序（merit order）推导出最优发电方案，并展示能源平衡约束上的对偶变量如何自然地体现为满足需求的边际机组成本，即系统边际价格（system marginal price）。通过这个基础计算，你将掌握对偶变量作为价格信号的核心概念 。",
            "id": "4098522",
            "problem": "考虑一个静态单周期经济调度问题，该问题针对一个纯能量市场中的三台火力发电机组，其可变运营成本为线性，并受全系统电量平衡约束。规划目标是在满足无弹性需求的同时，最小化总可变发电成本。该数学规划问题为\n对 $g_1, g_2, g_3$ 最小化目标函数 $c_1 g_1 + c_2 g_2 + c_3 g_3$\n约束条件为 $g_1 + g_2 + g_3 \\ge D$，对每个 $i \\in \\{1,2,3\\}$ 有 $0 \\le g_i \\le \\bar g_i$，\n其中 $g_i$ 表示发电机组 $i$ 的出力，$c_i$ 是其可变成本（单位：美元/兆瓦时），$\\bar g_i$ 是其容量（单位：兆瓦），$D$ 是系统总需求（单位：兆瓦）。令 $\\lambda \\ge 0$ 为电量平衡约束 $g_1 + g_2 + g_3 \\ge D$ 的对偶变量（拉格朗日乘子）。\n\n从拉格朗日函数和 Karush–Kuhn–Tucker 条件的定义出发，推导刻画最优解的平稳性条件和互补松弛条件。当数据为 $c = (10, 20, 50)$ 美元/兆瓦时，$\\bar g = (50, 30, 10)$ 兆瓦，以及 $D = 60$ 兆瓦时，使用这些条件计算最优对偶变量 $\\lambda$ 的数值。然后，将计算出的 $\\lambda$ 解释为此调度问题中电量的边际价值。\n\n以美元/兆瓦时为单位表示 $\\lambda$ 的数值。无需四舍五入。",
            "solution": "所述问题是一个经济调度的线性规划问题。我们首先将该问题及其对偶问题形式化。原问题是在满足发电容量和系统需求约束的条件下，最小化由目标函数 $C = c_1 g_1 + c_2 g_2 + c_3 g_3$ 给出的总发电成本。我们将问题写成应用 Karush-Kuhn-Tucker (KKT) 条件的标准形式。决策变量是发电水平 $g_1, g_2, g_3$。\n\n该优化问题为：\n$$ \\text{minimize} \\quad \\sum_{i=1}^{3} c_i g_i $$\n约束条件为：\n$$ D - \\sum_{i=1}^{3} g_i \\le 0 $$\n$$ -g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ g_i - \\bar g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n我们将非负对偶变量（拉格朗日乘子）与每个约束关联起来：\n- $\\lambda \\ge 0$ 对应电量平衡约束 $D - \\sum_{i=1}^{3} g_i \\le 0$。\n- $\\mu_i \\ge 0$ 对应下界约束 $-g_i \\le 0$。\n- $\\nu_i \\ge 0$ 对应上界（容量）约束 $g_i - \\bar g_i \\le 0$。\n\n此问题的拉格朗日函数 $\\mathcal{L}$ 定义为目标函数加上对偶变量与其对应约束函数乘积之和：\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} c_i g_i + \\lambda \\left( D - \\sum_{i=1}^{3} g_i \\right) + \\sum_{i=1}^{3} \\mu_i (-g_i) + \\sum_{i=1}^{3} \\nu_i (g_i - \\bar g_i) $$\n按原变量 $g_i$ 重新整理：\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} (c_i - \\lambda - \\mu_i + \\nu_i) g_i + \\lambda D - \\sum_{i=1}^{3} \\nu_i \\bar g_i $$\n\n最优解 $(g^*, \\lambda^*, \\mu^*, \\nu^*)$ 的KKT条件为：\n$1$. **平稳性**：拉格朗日函数对原变量 $g_i$ 的梯度必须为零。对每个 $i \\in \\{1, 2, 3\\}$：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_i} = c_i - \\lambda^* - \\mu_i^* + \\nu_i^* = 0 $$\n\n$2$. **互补松弛性**：每个对偶变量与其对应不等式约束的松弛量的乘积必须为零。\n$$ \\lambda^* \\left( D - \\sum_{i=1}^{3} g_i^* \\right) = 0 $$\n$$ \\mu_i^* (-g_i^*) = 0 \\quad \\implies \\quad \\mu_i^* g_i^* = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ \\nu_i^* (g_i^* - \\bar g_i) = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$3$. **原问题可行性**：解 $g^*$ 必须满足原始约束。\n$$ \\sum_{i=1}^{3} g_i^* \\ge D $$\n$$ 0 \\le g_i^* \\le \\bar g_i \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$4$. **对偶可行性**：不等式约束的对偶变量必须为非负。\n$$ \\lambda^* \\ge 0, \\quad \\mu_i^* \\ge 0, \\quad \\nu_i^* \\ge 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n从平稳性条件和互补松弛条件，我们可以推导出每个发电机组 $i$ 的经济调度逻辑：\n- 如果一个发电机组的出力严格在其上下界之间（$0  g_i^*  \\bar g_i$），那么根据互补松弛性，$g_i^* > 0$ 意味着 $\\mu_i^* = 0$，$g_i^*  \\bar g_i$ 意味着 $\\nu_i^* = 0$。平稳性条件简化为 $c_i - \\lambda^* = 0$，因此 $c_i = \\lambda^*$。这个发电机组是设定价格的“边际”机组。\n- 如果一个发电机组处于其最大容量（$g_i^* = \\bar g_i$），那么 $g_i^* > 0$ 意味着 $\\mu_i^* = 0$。平稳性条件为 $c_i - \\lambda^* + \\nu_i^* = 0$，即 $\\lambda^* = c_i + \\nu_i^*$。由于 $\\nu_i^* \\ge 0$，这意味着 $\\lambda^* \\ge c_i$。这个发电机组是“边际内”的。\n- 如果一个发电机组未出力（$g_i^* = 0$），那么 $g_i^*  \\bar g_i$（假设 $\\bar g_i > 0$）意味着 $\\nu_i^* = 0$。平稳性条件为 $c_i - \\lambda^* - \\mu_i^* = 0$，即 $\\lambda^* = c_i - \\mu_i^*$。由于 $\\mu_i^* \\ge 0$，这意味着 $\\lambda^* \\le c_i$。这个发电机组是“边际外”的。\n\n现在我们将此逻辑应用于所提供的数据：\n- 成本：$c = (10, 20, 50)$ 美元/兆瓦时。\n- 容量：$\\bar g = (50, 30, 10)$ 兆瓦。\n- 需求：$D = 60$ 兆瓦。\n\n最优调度遵循经济排序（merit order），优先使用成本最低的发电机组。\n$1$. 最便宜的机组是机组1，其成本为 $c_1 = 10$ $/MWh，容量为 $\\bar g_1 = 50$ MW。由于需求 $D=60$ MW 大于其容量，我们以其最大容量进行调度。\n$g_1^* = \\bar g_1 = 50$ MW。\n剩余需求为 $D_{rem} = D - g_1^* = 60 - 50 = 10$ MW。\n\n$2$. 其次便宜的机组是机组2，其成本为 $c_2 = 20$ $/MWh，容量为 $\\bar g_2 = 30$ MW。剩余需求为 $10$ MW，小于其容量。因此，我们调度机组2来满足剩余需求。\n$g_2^* = 10$ MW。\n剩余需求现在为 $D_{rem} - g_2^* = 10 - 10 = 0$ MW。\n\n$3$. 最贵的机组是机组3，其成本为 $c_3 = 50$ $/MWh。由于需求已经满足，它不参与调度。\n$g_3^* = 0$ MW。\n\n最优调度为 $g^* = (g_1^*, g_2^*, g_3^*) = (50, 10, 0)$。\n我们来检查约束条件：$g_1^* + g_2^* + g_3^* = 50 + 10 + 0 = 60 = D$。电量平衡约束是紧约束。\n\n根据我们推导出的KKT逻辑，对偶变量 $\\lambda$ 由边际机组决定，即最后一个参与调度且未在其运行极限的机组。在这种情况下，发电机组2的出力为 $g_2^*=10$ MW，在其上下界 $0  10  30$ 之内。因此，发电机组2是边际机组，其成本必须等于 $\\lambda$。\n$$ \\lambda^* = c_2 = 20 $$\n$\\lambda$ 的单位与成本相同，为美元/兆瓦时。\n\n我们来检查一致性：\n- 对于发电机组1：$g_1^* = \\bar g_1$。条件是 $c_1 \\le \\lambda^*$。我们有 $10 \\le 20$，成立。\n- 对于发电机组2：$0  g_2^*  \\bar g_2$。条件是 $c_2 = \\lambda^*$。我们有 $20 = 20$，成立。\n- 对于发电机组3：$g_3^* = 0$。条件是 $c_3 \\ge \\lambda^*$。我们有 $50 \\ge 20$，成立。\n当 $\\lambda^* = 20$ 时，所有KKT条件都得到满足。\n\n与约束相关的对偶变量 $\\lambda$ 的经济解释是放宽该约束的边际价值。在此背景下，$\\lambda$ 代表最小总成本对总需求 $D$ 微小变化的敏感度。即 $\\lambda^* = \\frac{dC^*(D)}{dD}$。\n$\\lambda^*=20$ 美元/兆瓦时的值意味着，为了满足额外一兆瓦的需求（即，将 $D$ 从 $60$ MW 增加到 $61$ MW），系统需要增加边际发电机组（即机组2）的出力。这部分额外电量的成本将是 $c_2 = 20$ 美元/兆瓦时。因此，该小时内系统总成本将增加 $20$ 美元。这个值也被称为系统边际价格 (SMP) 或电量的市场出清价格。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "在之前线性模型的基础上，本练习引入了更符合实际的二次成本函数，此时边际成本不再是常数。本练习要求你扮演系统分析师的角色，运用严格的Karush-Kuhn-Tucker (KKT) 条件来验证一个给定的候选解是否最优，并找出其中的不一致之处。这将加深你对如何形式化地确立最优性的理解 。",
            "id": "4098527",
            "problem": "考虑一个单节点经济调度问题，其中有两个火力发电机组为一个固定的能源需求供电。决策变量是发电机出力 $g_1$ 和 $g_2$，单位为兆瓦时。总成本是凸二次发电成本之和，其中 $C_1(g_1) = \\frac{1}{2} a_1 g_1^2 + b_1 g_1$ 且 $C_2(g_2) = \\frac{1}{2} a_2 g_2^2 + b_2 g_2$。该调度受能量平衡等式约束 $g_1 + g_2 = D$ 和各自的容量限制 $0 \\leq g_i \\leq \\overline{g}_i$ (对于 $i \\in \\{1,2\\}$) 的约束。参数为 $a_1 = 0.1$, $b_1 = 20$, $a_2 = 0.05$, $b_2 = 15$, $D = 120$ 兆瓦时，$\\overline{g}_1 = 80$ 兆瓦时，以及 $\\overline{g}_2 = 100$ 兆瓦时。考虑候选原始解 $g_1^{\\circ} = 20$ 和 $g_2^{\\circ} = 100$。边界约束的相关候选对偶变量为 $\\mu_1^{+,\\circ} = 0$, $\\mu_1^{-,\\circ} = 0$, $\\mu_2^{+,\\circ} = 2$, 和 $\\mu_2^{-,\\circ} = 0$，其中 $\\mu_i^{+}$ 对应于上限约束 $g_i \\leq \\overline{g}_i$，$\\mu_i^{-}$ 对应于下限约束 $g_i \\geq 0$。对于能量平衡等式约束，候选对偶变量为 $\\lambda^{\\circ} = 21.5$。\n\n使用 Karush-Kuhn-Tucker (KKT) 系统，确定给定的候选原始-对偶对 $(g_1^{\\circ}, g_2^{\\circ}; \\mu_1^{+,\\circ}, \\mu_1^{-,\\circ}, \\mu_2^{+,\\circ}, \\mu_2^{-,\\circ}; \\lambda^{\\circ})$ 是否最优。明确地验证每个KKT条件：原始可行性、对偶可行性、平稳性和互补松弛性。如果有任何条件不满足，推导出在给定的候选原始解和边界乘子下，能够恢复平稳性并达到最优性的能量平衡对偶变量 $\\lambda$ 的唯一值，并将该值作为节点边际电价 (LMP) 进行物理解释。\n\n将最终数值答案四舍五入到四位有效数字。以美元/兆瓦时为单位表示最终值。",
            "solution": "用户提供了一个单节点经济调度问题和一个候选的原始-对偶解。任务是使用 Karush-Kuhn-Tucker (KKT) 条件验证此候选解，如果它不是最优的，则找到与能量平衡约束相关的对偶变量的正确值。\n\n首先，对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   **决策变量**：发电机出力 $g_1, g_2$，单位为兆瓦时 (MWh)。\n-   **成本函数**：\n    -   $C_1(g_1) = \\frac{1}{2} a_1 g_1^2 + b_1 g_1$\n    -   $C_2(g_2) = \\frac{1}{2} a_2 g_2^2 + b_2 g_2$\n-   **参数**：\n    -   $a_1 = 0.1$, $b_1 = 20$\n    -   $a_2 = 0.05$, $b_2 = 15$\n-   **约束**：\n    -   能量平衡：$g_1 + g_2 = D$，其中 $D = 120$ MWh。\n    -   容量限制：$0 \\leq g_i \\leq \\overline{g}_i$，对于 $i \\in \\{1,2\\}$，其中 $\\overline{g}_1 = 80$ MWh 且 $\\overline{g}_2 = 100$ MWh。\n-   **候选原始解**：$g_1^{\\circ} = 20$, $g_2^{\\circ} = 100$。\n-   **候选对偶解**：\n    -   $\\lambda^{\\circ} = 21.5$ 用于能量平衡约束。\n    -   $\\mu_1^{+,\\circ} = 0$ 用于 $g_1 \\leq \\overline{g}_1$。\n    -   $\\mu_1^{-,\\circ} = 0$ 用于 $g_1 \\geq 0$。\n    -   $\\mu_2^{+,\\circ} = 2$ 用于 $g_2 \\leq \\overline{g}_2$。\n    -   $\\mu_2^{-,\\circ} = 0$ 用于 $g_2 \\geq 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学上成立**：该问题是一个标准的经济调度模型，是电力系统工程和运筹学中的一个基本概念。使用凸二次成本函数是一种被广泛接受的做法。\n-   **适定性**：目标函数是两个凸二次函数的和，其本身也是凸的（$a_1 > 0, a_2 > 0$）。约束是线性的，定义了一个凸且紧凑的可行集。因此，该优化问题是一个凸规划问题，这保证了存在唯一的全局最小值。问题陈述清晰，有明确的数学求解过程。\n-   **客观性**：问题使用精确的数学和工程术语陈述。所有参数都是定量的，没有主观或模糊的陈述。\n\n### 步骤 3：结论与行动\n该问题在科学上成立、适定且客观。它被认为是**有效的**。我们继续求解。\n\n该优化问题可以形式化地表述为：\n$$\n\\text{minimize} \\quad C(g_1, g_2) = \\left(\\frac{1}{2} a_1 g_1^2 + b_1 g_1\\right) + \\left(\\frac{1}{2} a_2 g_2^2 + b_2 g_2\\right)\n$$\n受限于：\n$$\ng_1 + g_2 - D = 0 \\quad (\\text{对偶变量 } \\lambda) \\\\\ng_1 - \\overline{g}_1 \\leq 0 \\quad (\\text{对偶变量 } \\mu_1^+) \\\\\n-g_1 \\leq 0 \\quad (\\text{对偶变量 } \\mu_1^-) \\\\\ng_2 - \\overline{g}_2 \\leq 0 \\quad (\\text{对偶变量 } \\mu_2^+) \\\\\n-g_2 \\leq 0 \\quad (\\text{对偶变量 } \\mu_2^-)\n$$\n该问题的拉格朗日函数 $\\mathcal{L}$，按照电力系统中的标准惯例，将对偶变量 $\\lambda$（节点边际电价）定义为成本，其形式为：\n$$\n\\mathcal{L} = C(g_1, g_2) - \\lambda(g_1 + g_2 - D) + \\mu_1^+(g_1 - \\overline{g}_1) - \\mu_1^- g_1 + \\mu_2^+(g_2 - \\overline{g}_2) - \\mu_2^- g_2\n$$\n最优性的 Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **原始可行性**：所有约束必须得到满足。\n    -   $g_1 + g_2 = D$\n    -   $0 \\leq g_1 \\leq \\overline{g}_1$\n    -   $0 \\leq g_2 \\leq \\overline{g}_2$\n2.  **对偶可行性**：不等式约束的乘子必须为非负。\n    -   $\\mu_1^+, \\mu_1^-, \\mu_2^+, \\mu_2^- \\geq 0$\n3.  **互补松弛性**：对于每个不等式约束，要么该约束是紧的（激活的），要么其对偶变量为零。\n    -   $\\mu_1^+(g_1 - \\overline{g}_1) = 0$\n    -   $\\mu_1^-(-g_1) = 0$\n    -   $\\mu_2^+(g_2 - \\overline{g}_2) = 0$\n    -   $\\mu_2^-(-g_2) = 0$\n4.  **平稳性**：拉格朗日函数相对于原始变量的梯度必须为零。\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial g_1} = a_1 g_1 + b_1 - \\lambda + \\mu_1^+ - \\mu_1^- = 0$\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial g_2} = a_2 g_2 + b_2 - \\lambda + \\mu_2^+ - \\mu_2^- = 0$\n\n现在，我们通过验证这四个条件来检查给定的候选原始-对偶对是否最优。\n-   **给定值**：$g_1^{\\circ} = 20$, $g_2^{\\circ} = 100$, $\\lambda^{\\circ} = 21.5$, $\\mu_1^{+,\\circ} = 0$, $\\mu_1^{-,\\circ} = 0$, $\\mu_2^{+,\\circ} = 2$, $\\mu_2^{-,\\circ} = 0$。\n-   **参数**：$D = 120$, $\\overline{g}_1 = 80$, $\\overline{g}_2 = 100$。\n\n**1. 原始可行性检查：**\n-   $g_1^{\\circ} + g_2^{\\circ} = 20 + 100 = 120 = D$。能量平衡得到满足。\n-   $0 \\leq g_1^{\\circ} \\leq \\overline{g}_1 \\implies 0 \\leq 20 \\leq 80$。这是成立的。\n-   $0 \\leq g_2^{\\circ} \\leq \\overline{g}_2 \\implies 0 \\leq 100 \\leq 100$。这是成立的。\n候选解是**原始可行的**。\n\n**2. 对偶可行性检查：**\n-   $\\mu_1^{+,\\circ}=0 \\geq 0$, $\\mu_1^{-,\\circ}=0 \\geq 0$, $\\mu_2^{+,\\circ}=2 \\geq 0$, $\\mu_2^{-,\\circ}=0 \\geq 0$。所有不等式乘子都是非负的。\n候选解是**对偶可行的**。\n\n**3. 互补松弛性检查：**\n-   $\\mu_1^{+,\\circ}(g_1^{\\circ} - \\overline{g}_1) = 0 \\times (20 - 80) = 0$。条件成立。\n-   $\\mu_1^{-,\\circ}(-g_1^{\\circ}) = 0 \\times (-20) = 0$。条件成立。\n-   $\\mu_2^{+,\\circ}(g_2^{\\circ} - \\overline{g}_2) = 2 \\times (100 - 100) = 0$。条件成立。\n-   $\\mu_2^{-,\\circ}(-g_2^{\\circ}) = 0 \\times (-100) = 0$。条件成立。\n候选解**满足互补松弛性**。\n\n**4. 平稳性检查：**\n-   对于 $g_1$：\n    $$ a_1 g_1^{\\circ} + b_1 - \\lambda^{\\circ} + \\mu_1^{+,\\circ} - \\mu_1^{-,\\circ} = (0.1)(20) + 20 - 21.5 + 0 - 0 = 2 + 20 - 21.5 = 0.5 $$\n    由于 $0.5 \\neq 0$，对于 $g_1$ 的平稳性条件**不满足**。\n-   对于 $g_2$：\n    $$ a_2 g_2^{\\circ} + b_2 - \\lambda^{\\circ} + \\mu_2^{+,\\circ} - \\mu_2^{-,\\circ} = (0.05)(100) + 15 - 21.5 + 2 - 0 = 5 + 15 - 21.5 + 2 = 0.5 $$\n    由于 $0.5 \\neq 0$，对于 $g_2$ 的平稳性条件也**不满足**。\n\n因为平稳性条件不满足，所以该候选原始-对偶对**不是最优的**。\n\n问题的第二部分要求在给定的候选原始解和边界乘子下，找出能恢复平稳性并达到最优性的 $\\lambda$ 的唯一值。之前的检查表明，原始解（$g_1=20, g_2=100$）和相应的约束绑定状态（以及因此 $\\mu$ 乘子的零/非零状态）与一个最优解是一致的。所提供的非零对偶变量的值也是正确的，我们现在将证明这一点。唯一不正确的值是 $\\lambda^\\circ$。\n\n我们可以通过强制满足平稳性条件，并使用给定的（且正确的）原始变量和边界乘子，来找到 $\\lambda$ 的正确值。\n由 $g_1$ 的平稳性条件：\n$$ a_1 g_1^{\\circ} + b_1 - \\lambda + \\mu_1^{+,\\circ} - \\mu_1^{-,\\circ} = 0 $$\n$$ (0.1)(20) + 20 - \\lambda + 0 - 0 = 0 $$\n$$ 2 + 20 - \\lambda = 0 \\implies \\lambda = 22 $$\n由 $g_2$ 的平稳性条件：\n$$ a_2 g_2^{\\circ} + b_2 - \\lambda + \\mu_2^{+,\\circ} - \\mu_2^{-,\\circ} = 0 $$\n$$ (0.05)(100) + 15 - \\lambda + 2 - 0 = 0 $$\n$$ 5 + 15 + 2 - \\lambda = 0 \\implies \\lambda = 22 $$\n两个方程都一致地得出 $\\lambda = 22$。使用这个新值 $\\lambda^* = 22$，所有四个KKT条件都得到满足。由于该问题是凸问题，满足KKT条件是最优性的充分条件。因此，恢复最优性的 $\\lambda$ 的唯一值是 $22$。单位是美元/兆瓦时。\n\n**物理解释：**\n能量平衡约束的对偶变量 $\\lambda$ 是节点边际电价 (LMP)，也称为系统边际价格。它表示系统为满足额外一兆瓦时需求所付出的边际成本。\n在此系统中，发电机组2正在其最大容量（$\\overline{g}_2 = 100$ MWh）下运行。因此，为了满足需求的增量增长，系统必须依赖于发电机组1，该机组有备用容量（$g_1=20  \\overline{g}_1=80$）。因此，发电机组1是“边际机组”。系统边际价格必须等于该边际机组的边际成本。\n发电机组1的边际成本由其导数给出：\n$$ \\frac{dC_1}{dg_1} = a_1 g_1 + b_1 $$\n在最优运行点 $g_1^* = 20$ MWh，边际成本为：\n$$ \\frac{dC_1}{dg_1}\\bigg|_{g_1=20} = (0.1)(20) + 20 = 2 + 20 = 22 \\text{ \\$/MWh} $$\n这证实了LMP确实是 $\\lambda = 22$ 美元/兆瓦时。对于一个未受约束的发电机（$0  g_1  \\overline{g}_1$），平稳性条件简化为 $\\lambda = \\frac{dC_1}{dg_1}$。\n\n四舍五入到四位有效数字，该值为 $22.00$。",
            "answer": "$$\n\\boxed{22.00}\n$$"
        },
        {
            "introduction": "能源价格并非总是正数。本练习探讨一个关键的真实世界情景：不可灵活调度的“必须运行”发电机组导致了能源过剩，而处理这些过剩能源是有成本的。通过解决这个问题，你将揭示负电价（negative Locational Marginal Prices, LMPs）背后的形成机制，并理解能源价格有时也可以反映为处理过剩产品的成本 。",
            "id": "4098509",
            "problem": "考虑一个稳态下的单母线经济调度问题，该问题是节点定价计算的一个典型示例。该母线具有 $D = 90$ 兆瓦的固定非弹性需求。有两台发电机和一个弃电选项：\n- 一台必须运行的发电机 $M$，其出力 $g_{M}$ 受限于一个有约束力的下界 $g_{M} \\geq \\underline{g}_{M}$，其中 $\\underline{g}_{M} = 110$ 兆瓦。其边际生产成本为 $c_{M} = 0$ 货币单位/兆瓦时 (CU/MWh)。\n- 一台灵活发电机 $F$，其出力 $g_{F} \\geq 0$，边际生产成本为 $c_{F} = 40$ CU/MWh。容量上限足够大，因此无约束力。\n- 一个非物理的耗散选项，建模为决策变量 $w \\geq 0$，表示在供应超过需求时，以 $c_{w} = 9.7$ CU/MWh 的边际惩罚成本进行弃电或强制削减。\n\n将原始优化问题表述为在满足能量平衡和边界约束的条件下，最小化总运行成本，其中单母线能量平衡写作\n$$\nD - g_{M} - g_{F} + w = 0,\n$$\n并令 $\\lambda$ 表示与此等式相关的拉格朗日乘子。该母线的节点边际电价 (LMP) 定义为该母线上能量的影子价值，在此符号约定下等于最优乘子 $\\lambda$。利用凸优化（Karush–Kuhn–Tucker 最优性条件）的基本原理，论证对偶变量的符号限制，并严格证明负的 LMP 如何由一个有约束力的下界和具有正边际惩罚的 $w$ 的存在而产生。\n\n根据给定数据计算该母线上 LMP 的数值。将您的答案四舍五入到 $4$ 位有效数字。以 CU/MWh 表示最终价格。",
            "solution": "该问题要求计算单母线的节点边际电价 (LMP)，其定义为与能量平衡约束相关的最优拉格朗日乘子 $\\lambda$。我们将首先验证问题，然后将其表述为凸优化问题，最后使用 Karush-Kuhn-Tucker (KKT) 条件求解。\n\n该问题是有效的。它描述了一个标准的经济调度场景，这是能源系统工程中一个适定的线性规划问题。所提供的数据（$D=90$ MW, $\\underline{g}_M = 110$ MW, $c_M=0$ CU/MWh, $c_F=40$ CU/MWh, $c_w=9.7$ CU/MWh）是自洽且现实的，用于说明由于不灵活发电而导致负电价的经济现象。该问题具有科学依据，是客观的，并包含足够的信息以获得唯一解。\n\n原始优化问题是最小化总系统运行成本，即生产成本和惩罚成本之和。要最小化的目标函数是：\n$$\nC(g_M, g_F, w) = c_M g_M + c_F g_F + c_w w\n$$\n决策变量是发电机出力 $g_M$ 和 $g_F$，以及弃电量 $w$。该优化受以下几个约束条件的限制：\n\n1.  能量平衡：$D - g_M - g_F + w = 0$\n2.  发电机 $M$ 下界：$g_M \\geq \\underline{g}_M$\n3.  发电机 $F$ 下界：$g_F \\geq 0$\n4.  弃电下界：$w \\geq 0$\n\n为了应用 KKT 条件，我们将不等式约束写成标准形式 $h(x) \\leq 0$：\n1. 能量平衡：$D - g_M - g_F + w = 0 \\quad (\\lambda)$\n2. 发电机 $M$ 边界：$\\underline{g}_M - g_M \\leq 0 \\quad (\\mu_M)$\n3. 发电机 $F$ 边界：$-g_F \\leq 0 \\quad (\\mu_F)$\n4. 弃电边界：$-w \\leq 0 \\quad (\\mu_w)$\n\n这里，$\\lambda$ 是等式约束的拉格朗日乘子，$\\mu_M, \\mu_F, \\mu_w$ 是不等式约束的 KKT 乘子。\n\n该问题的拉格朗日函数 $\\mathcal{L}$ 是：\n$$\n\\mathcal{L}(g_M, g_F, w, \\lambda, \\mu_M, \\mu_F, \\mu_w) = (c_M g_M + c_F g_F + c_w w) + \\lambda(D - g_M - g_F + w) + \\mu_M(\\underline{g}_M - g_M) + \\mu_F(-g_F) + \\mu_w(-w)\n$$\n\n一阶 KKT 最优性条件是：\n\n(a) **平稳性**（$\\mathcal{L}$ 关于原始变量的梯度在最优点为零）：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_M} = c_M - \\lambda - \\mu_M = 0 \\implies c_M - \\lambda = \\mu_M\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_F} = c_F - \\lambda - \\mu_F = 0 \\implies c_F - \\lambda = \\mu_F\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial w} = c_w + \\lambda - \\mu_w = 0 \\implies c_w + \\lambda = \\mu_w\n$$\n\n(b) **原始可行性**：最优解 $(g_M^*, g_F^*, w^*)$ 必须满足原始约束。\n\n(c) **对偶可行性**：不等式约束的 KKT 乘子必须为非负：$\\mu_M \\geq 0$, $\\mu_F \\geq 0$, $\\mu_w \\geq 0$。\n\n(d) **互补松弛性**：对于每个不等式约束，乘子与约束函数在最优点处的乘积必须为零：\n$$\n\\mu_M(\\underline{g}_M - g_M^*) = 0\n$$\n$$\n\\mu_F(-g_F^*) = 0 \\implies \\mu_F g_F^* = 0\n$$\n$$\n\\mu_w(-w^*) = 0 \\implies \\mu_w w^* = 0\n$$\n\n我们现在使用所提供的数据求解该系统：$D=90$, $\\underline{g}_M=110$, $c_M=0$, $c_F=40$, $c_w=9.7$。\n\n问题指出发电机 $M$ 的下界是有约束力的。这意味着 $g_M^* = \\underline{g}_M = 110$。\n当 $g_M^* = 110$ 时，能量平衡要求 $90 - 110 - g_F^* + w^* = 0$，简化为 $w^* = g_F^* + 20$。\n\n为最小化成本，系统应尽可能避免调度昂贵的灵活发电机 $F$（成本 $c_F = 40$）。必须运行的发电机 $M$ 已经产生了 $110 - 90 = 20$ 兆瓦的盈余。这个盈余必须被发电机 $F$ 消耗（这是不合逻辑的）或通过 $w$ 弃掉。没有经济理由以 $40$ CU/MWh 的成本从发电机 $F$ 产生额外的电力，然后再以 $9.7$ CU/MWh 的成本将其弃掉。因此，灵活发电机的最优出力必须为零：$g_F^* = 0$。\n\n我们来严格证明 $g_F^*=0$。假设 $g_F^*>0$ 以导出矛盾。根据互补松弛性（$\\mu_F g_F^* = 0$），我们必须有 $\\mu_F=0$。那么 $g_F$ 的平稳性条件意味着 $c_F - \\lambda = 0$，所以 $\\lambda = c_F = 40$。$w$ 的平稳性条件是 $c_w + \\lambda = \\mu_w$，这给出 $\\mu_w = 9.7 + 40 = 49.7$。由于 $\\mu_w>0$，互补松弛性（$\\mu_w w^*=0$）要求 $w^*=0$。将 $g_F^*>0$ 和 $w^*=0$ 代入能量平衡关系 $w^* = g_F^* + 20$ 得出 $0 = g_F^* + 20$，即 $g_F^* = -20$。这与原始可行性约束 $g_F \\geq 0$ 相矛盾。因此，假设 $g_F^*>0$ 是错误的，必然有 $g_F^*=0$。\n\n当 $g_F^*=0$ 时，能量平衡关系 $w^* = g_F^* + 20$ 得到 $w^* = 20$。\n最优原始变量为：$g_M^*=110$，$g_F^*=0$，$w^*=20$。该解是原始可行的，因为 $g_M^* \\ge 110$，$g_F^* \\ge 0$ 且 $w^* \\ge 0$。\n\n现在我们确定 LMP, $\\lambda$。由于 $w^* = 20 > 0$，约束 $-w \\leq 0$ 不是紧的。互补松弛性（$\\mu_w w^* = 0$）意味着其乘子必须为零：$\\mu_w = 0$。\n使用 $w$ 的平稳性条件：\n$$\nc_w + \\lambda = \\mu_w\n$$\n$$\n9.7 + \\lambda = 0\n$$\n$$\n\\lambda = -9.7\n$$\n因此，该母线的 LMP 为 $-9.7$ CU/MWh。\n\n负电价的出现是因为必须运行的发电机具有约束力的运行下限，迫使能量过剩供应（$110$ 兆瓦的供应对 $90$ 兆瓦的需求）。为保持平衡，这 $20$ 兆瓦的盈余必须以 $c_w = 9.7$ CU/MWh 的成本弃掉。需求的增量增加将减少需要弃掉的能量，从而为系统节省资金。因此，额外一兆瓦时需求的价值是该弃电成本的负值，导致 $\\lambda = -c_w$。\n\n为完整起见，我们可以验证其余的 KKT 条件。\n对于 $g_F$，当 $\\lambda = -9.7$ 时：\n$\\mu_F = c_F - \\lambda = 40 - (-9.7) = 49.7$。由于 $\\mu_F>0$ 且 $g_F^*=0$，对偶可行性和互补松弛性成立。\n\n对于 $g_M$，当 $\\lambda = -9.7$ 时：\n$\\mu_M = c_M - \\lambda = 0 - (-9.7) = 9.7$。由于 $\\mu_M>0$ 且 $g_M^* = \\underline{g}_M$，对偶可行性和互补松弛性成立。\n\n所有 KKT 条件都得到满足，证实了解的最优性。问题要求将答案四舍五入到 $4$ 位有效数字。",
            "answer": "$$\\boxed{-9.700}$$"
        }
    ]
}