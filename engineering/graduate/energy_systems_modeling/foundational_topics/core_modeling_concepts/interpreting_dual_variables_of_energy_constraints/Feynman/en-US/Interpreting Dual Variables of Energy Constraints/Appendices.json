{
    "hands_on_practices": [
        {
            "introduction": "We begin with the foundational concept of economic dispatch in a system with linear generation costs. This exercise guides you through using the Karush-Kuhn-Tucker (KKT) conditions to find the optimal dispatch and, most importantly, the dual variable on the system's energy balance constraint. Mastering this practice is the first step to understanding how the market clearing price, or Locational Marginal Price (LMP), is determined by the cost of the most expensive generator currently in operation to meet demand .",
            "id": "4098522",
            "problem": "Consider a static, single-period economic dispatch problem for three thermal generators in an energy-only market with linear variable operating costs, subject to a system-wide energy-balance requirement. The planning objective is to minimize total variable generation cost while meeting an inelastic demand. The mathematical program is\nminimize over $g_1, g_2, g_3$ the objective $c_1 g_1 + c_2 g_2 + c_3 g_3$\nsubject to the constraints $g_1 + g_2 + g_3 \\ge D$, $0 \\le g_i \\le \\bar g_i$ for each $i \\in \\{1,2,3\\}$,\nwhere $g_i$ denotes the dispatch of generator $i$, $c_i$ is its variable cost in dollars per megawatt-hour, $\\bar g_i$ is its capacity in megawatts, and $D$ is the total system demand in megawatts. Let $\\lambda \\ge 0$ be the dual variable (Lagrange multiplier) for the energy-balance constraint $g_1 + g_2 + g_3 \\ge D$.\n\nStarting from the definition of the Lagrangian and the Karush–Kuhn–Tucker conditions, derive the stationarity and complementary slackness conditions that characterize an optimal solution. Use these conditions to compute the numerical value of the optimal dual variable $\\lambda$ when the data are $c = (10, 20, 50)$ dollars per megawatt-hour, $\\bar g = (50, 30, 10)$ megawatts, and $D = 60$ megawatts. Then, interpret the computed $\\lambda$ as a marginal value of energy in this dispatch problem.\n\nExpress the numerical value of $\\lambda$ in dollars per megawatt-hour. No rounding is required.",
            "solution": "The problem stated is a linear program for economic dispatch. Let us first formalize the problem and its dual. The primal problem is to minimize the total generation cost, given by the objective function $C = c_1 g_1 + c_2 g_2 + c_3 g_3$, subject to constraints on generation capacity and system demand. Let us write the problem in a standard form for applying the Karush-Kuhn-Tucker (KKT) conditions. The decision variables are the generation levels $g_1, g_2, g_3$.\n\nThe optimization problem is:\n$$ \\text{minimize} \\quad \\sum_{i=1}^{3} c_i g_i $$\nsubject to:\n$$ D - \\sum_{i=1}^{3} g_i \\le 0 $$\n$$ -g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ g_i - \\bar g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\nWe associate non-negative dual variables (Lagrange multipliers) with each constraint:\n- $\\lambda \\ge 0$ for the energy balance constraint $D - \\sum_{i=1}^{3} g_i \\le 0$.\n- $\\mu_i \\ge 0$ for the lower-bound constraint $-g_i \\le 0$.\n- $\\nu_i \\ge 0$ for the upper-bound (capacity) constraint $g_i - \\bar g_i \\le 0$.\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is defined as the objective function plus the sum of the products of the dual variables and their corresponding constraint functions:\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} c_i g_i + \\lambda \\left( D - \\sum_{i=1}^{3} g_i \\right) + \\sum_{i=1}^{3} \\mu_i (-g_i) + \\sum_{i=1}^{3} \\nu_i (g_i - \\bar g_i) $$\nRearranging by the primal variables $g_i$:\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} (c_i - \\lambda - \\mu_i + \\nu_i) g_i + \\lambda D - \\sum_{i=1}^{3} \\nu_i \\bar g_i $$\n\nThe KKT conditions for an optimal solution $(g^*, \\lambda^*, \\mu^*, \\nu^*)$ are:\n$1$. **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $g_i$ must be zero. For each $i \\in \\{1, 2, 3\\}$:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_i} = c_i - \\lambda^* - \\mu_i^* + \\nu_i^* = 0 $$\n\n$2$. **Complementary Slackness**: The product of each dual variable and its corresponding inequality constraint's slack must be zero.\n$$ \\lambda^* \\left( D - \\sum_{i=1}^{3} g_i^* \\right) = 0 $$\n$$ \\mu_i^* (-g_i^*) = 0 \\quad \\implies \\quad \\mu_i^* g_i^* = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ \\nu_i^* (g_i^* - \\bar g_i) = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$3$. **Primal Feasibility**: The solution $g^*$ must satisfy the original constraints.\n$$ \\sum_{i=1}^{3} g_i^* \\ge D $$\n$$ 0 \\le g_i^* \\le \\bar g_i \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$4$. **Dual Feasibility**: The dual variables for inequality constraints must be non-negative.\n$$ \\lambda^* \\ge 0, \\quad \\mu_i^* \\ge 0, \\quad \\nu_i^* \\ge 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\nFrom the stationarity and complementary slackness conditions, we can derive the economic dispatch logic for each generator $i$:\n- If a generator is dispatched strictly between its bounds ($0 < g_i^* < \\bar g_i$), then from complementary slackness, $g_i^* > 0$ implies $\\mu_i^* = 0$ and $g_i^* < \\bar g_i$ implies $\\nu_i^* = 0$. The stationarity condition simplifies to $c_i - \\lambda^* = 0$, so $c_i = \\lambda^*$. This generator is the \"marginal\" unit setting the price.\n- If a generator is at its maximum capacity ($g_i^* = \\bar g_i$), then $g_i^* > 0$ implies $\\mu_i^* = 0$. The stationarity condition is $c_i - \\lambda^* + \\nu_i^* = 0$, or $\\lambda^* = c_i + \\nu_i^*$. Since $\\nu_i^* \\ge 0$, this implies $\\lambda^* \\ge c_i$. This generator is \"inframarginal\".\n- If a generator is not dispatched ($g_i^* = 0$), then $g_i^* < \\bar g_i$ (assuming $\\bar g_i > 0$) implies $\\nu_i^* = 0$. The stationarity condition is $c_i - \\lambda^* - \\mu_i^* = 0$, or $\\lambda^* = c_i - \\mu_i^*$. Since $\\mu_i^* \\ge 0$, this implies $\\lambda^* \\le c_i$. This generator is \"extramarginal\".\n\nNow we apply this logic to the provided data:\n- Costs: $c = (10, 20, 50)$ dollars per megawatt-hour.\n- Capacities: $\\bar g = (50, 30, 10)$ megawatts.\n- Demand: $D = 60$ megawatts.\n\nThe optimal dispatch follows a merit order, using the cheapest generators first.\n$1$. The cheapest generator is unit $1$ with cost $c_1 = 10$ \\$/MWh and capacity $\\bar g_1 = 50$ MW. Since the demand $D=60$ MW is greater than its capacity, we dispatch it at its maximum.\n$g_1^* = \\bar g_1 = 50$ MW.\nThe remaining demand is $D_{rem} = D - g_1^* = 60 - 50 = 10$ MW.\n\n$2$. The next cheapest generator is unit $2$ with cost $c_2 = 20$ \\$/MWh and capacity $\\bar g_2 = 30$ MW. The remaining demand is $10$ MW, which is less than its capacity. Thus, we dispatch unit $2$ to meet the remaining demand.\n$g_2^* = 10$ MW.\nThe remaining demand is now $D_{rem} - g_2^* = 10 - 10 = 0$ MW.\n\n$3$. The most expensive generator is unit $3$ with cost $c_3 = 50$ \\$/MWh. Since the demand has been met, it is not dispatched.\n$g_3^* = 0$ MW.\n\nThe optimal dispatch is $g^* = (g_1^*, g_2^*, g_3^*) = (50, 10, 0)$.\nLet's check the constraints: $g_1^* + g_2^* + g_3^* = 50 + 10 + 0 = 60 = D$. The energy balance constraint is active.\n\nAccording to our derived KKT logic, the dual variable $\\lambda$ is set by the marginal unit, which is the last unit dispatched that is not operating at a limit. In this case, generator $2$ is dispatched at $g_2^*=10$ MW, which is within its bounds $0 < 10 < 30$. Therefore, generator $2$ is the marginal unit, and its cost must be equal to $\\lambda$.\n$$ \\lambda^* = c_2 = 20 $$\nThe units for $\\lambda$ are the same as for cost, dollars per megawatt-hour.\n\nLet's check for consistency:\n- For generator $1$: $g_1^* = \\bar g_1$. The condition is $c_1 \\le \\lambda^*$. We have $10 \\le 20$, which is true.\n- For generator $2$: $0 < g_2^* < \\bar g_2$. The condition is $c_2 = \\lambda^*$. We have $20 = 20$, which is true.\n- For generator $3$: $g_3^* = 0$. The condition is $c_3 \\ge \\lambda^*$. We have $50 \\ge 20$, which is true.\nThe KKT conditions are all satisfied with $\\lambda^* = 20$.\n\nThe economic interpretation of the dual variable $\\lambda$ associated with a constraint is the marginal value of relaxing that constraint. In this context, $\\lambda$ represents the sensitivity of the minimum total cost to a small change in the total demand $D$. That is, $\\lambda^* = \\frac{dC^*(D)}{dD}$.\nA value of $\\lambda^*=20$ dollars per megawatt-hour signifies that to meet one additional megawatt of demand (i.e., increasing $D$ from $60$ to $61$ MW), the system would need to increase the output of the marginal generator, unit $2$. The cost of this additional energy would be $c_2 = 20$ dollars per megawatt-hour. Thus, the total system cost would increase by $20$ dollars for that hour. This value is also known as the system marginal price (SMP) or market clearing price for energy.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "Building on the previous exercise, we now explore the economic meaning of dual variables on constraints other than the energy balance. This problem focuses on the duals associated with generator capacity limits, which act as physical bottlenecks in the system. By calculating these values, you will learn to interpret them as scarcity prices, quantifying the economic value of relieving a binding capacity constraint and providing a clear signal for potential system expansion .",
            "id": "4098486",
            "problem": "Consider a single-period economic dispatch problem over a duration of $1$ hour with two thermal generators. Let $g_1$ and $g_2$ denote the energy produced in the period by each unit, measured in $\\text{MWh}$. The total demand is $D$ $\\text{MWh}$, and each unit has an energy upper bound $\\bar g_i$ $\\text{MWh}$ arising from its power capacity multiplied by the period length. The marginal operating costs are constant and given by $c_1$ and $c_2$ in $\\$/\\text{MWh}$. The system operator minimizes total operating cost subject to meeting demand and respecting unit bounds. Use the following data: $c_1 = 20$ $\\$/\\text{MWh}$, $c_2 = 30$ $\\$/\\text{MWh}$, $\\bar g_1 = 40$ $\\text{MWh}$, $\\bar g_2 = 40$ $\\text{MWh}$, and $D = 70$ $\\text{MWh}$.\n\nStarting from the fundamentals of convex optimization and the Karush–Kuhn–Tucker (KKT) conditions, write the primal problem and derive the stationarity and complementary slackness conditions for the Lagrangian with dual variables $\\lambda$ for the demand-balance equality, $\\alpha_1$ and $\\alpha_2$ for the nonnegativity constraints $g_i \\ge 0$, and $\\mu_1$ and $\\mu_2$ for the capacity constraints $g_i \\le \\bar g_i$. Then, using these conditions, compute the numerical values of the dual variables $\\mu_1$ and $\\mu_2$ associated with the capacity constraints $g_1 \\le \\bar g_1$ and $g_2 \\le \\bar g_2$, respectively, and determine which capacity is scarce. Report the numerical values of $\\mu_1$ and $\\mu_2$ in $\\$/\\text{MWh}$.\n\nProvide exact values; no rounding is required. For the final answer, present the pair $\\mu_1$ and $\\mu_2$ as a single row matrix.",
            "solution": "The problem is to minimize the total operating cost of two generators subject to meeting a specified demand and respecting the operational limits of the generators.\n\nFirst, we formulate the primal optimization problem. The decision variables are the energy generation levels $g_1$ and $g_2$ in MWh. The objective function is the total cost, which we seek to minimize.\n$$\n\\min_{g_1, g_2} \\quad c_1 g_1 + c_2 g_2\n$$\nThe constraints are as follows:\n\\begin{enumerate}\n    \\item Demand-balance constraint (equality): The total generation must equal the total demand $D$.\n    $$g_1 + g_2 = D \\quad [\\lambda]$$\n    \\item Capacity constraints (inequality): Each generator's output cannot exceed its maximum capacity $\\bar g_i$.\n    $$g_1 \\le \\bar g_1 \\quad [\\mu_1]$$\n    $$g_2 \\le \\bar g_2 \\quad [\\mu_2]$$\n    \\item Non-negativity constraints (inequality): Generation cannot be negative.\n    $$g_1 \\ge 0 \\quad [\\alpha_1]$$\n    $$g_2 \\ge 0 \\quad [\\alpha_2]$$\n\\end{enumerate}\nHere, the symbols in brackets denote the Lagrange multipliers (dual variables) associated with each constraint. To apply the Karush–Kuhn–Tucker (KKT) conditions, we write the constraints in a standard form, $h(x) = 0$ and $g(x) \\le 0$:\n$$g_1 + g_2 - D = 0$$\n$$g_1 - \\bar g_1 \\le 0$$\n$$g_2 - \\bar g_2 \\le 0$$\n$$-g_1 \\le 0$$\n$$-g_2 \\le 0$$\n\nTo maintain consistency with standard power systems literature, we define the Lagrangian with the dual of the equality constraint, $\\lambda$, subtracted:\n$$\n\\mathcal{L}(g_1, g_2, \\lambda, \\mu_1, \\mu_2, \\alpha_1, \\alpha_2) = c_1 g_1 + c_2 g_2 - \\lambda(g_1 + g_2 - D) + \\mu_1(g_1 - \\bar g_1) + \\mu_2(g_2 - \\bar g_2) - \\alpha_1 g_1 - \\alpha_2 g_2\n$$\nThe KKT conditions for optimality are:\n\\begin{enumerate}\n    \\item **Stationarity**: The gradient of the Lagrangian with respect to the primal variables must be zero.\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 - \\lambda + \\mu_1 - \\alpha_1 = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 - \\lambda + \\mu_2 - \\alpha_2 = 0$$\n    \\item **Primal Feasibility**: The primal variables must satisfy all original constraints.\n    $$g_1 + g_2 = D$$\n    $$0 \\le g_1 \\le \\bar g_1, \\quad 0 \\le g_2 \\le \\bar g_2$$\n    \\item **Dual Feasibility**: The dual variables for inequality constraints must be non-negative.\n    $$\\mu_1 \\ge 0, \\quad \\mu_2 \\ge 0$$\n    $$\\alpha_1 \\ge 0, \\quad \\alpha_2 \\ge 0$$\n    The dual variable $\\lambda$ for the equality constraint is unrestricted in sign.\n    \\item **Complementary Slackness**: The product of an inequality-constraint dual variable and its corresponding slack must be zero.\n    $$\\mu_1(g_1 - \\bar g_1) = 0$$\n    $$\\mu_2(g_2 - \\bar g_2) = 0$$\n    $$\\alpha_1 g_1 = 0$$\n    $$\\alpha_2 g_2 = 0$$\n\\end{enumerate}\nWe now solve this system of equations using the given data: $c_1 = 20$, $c_2 = 30$, $\\bar g_1 = 40$, $\\bar g_2 = 40$, and $D = 70$.\n\nA rational operator prioritizes the generator with the lower marginal cost. Since $c_1  c_2$, generator $1$ is dispatched first. Its maximum output is $\\bar g_1 = 40$ MWh. We dispatch it at its maximum capacity.\nSo, we set $g_1 = 40$ MWh.\n\nFrom the demand-balance constraint, we determine the required output from generator $2$:\n$$g_2 = D - g_1 = 70 - 40 = 30 \\text{ MWh}$$\n\nThis proposed solution, $g_1^*=40$ and $g_2^*=30$, is primally feasible as it satisfies all generation bounds and meets the demand. We now use the KKT conditions to find the dual variables and verify optimality.\n\nFrom complementary slackness:\n\\begin{itemize}\n    \\item Since $g_2^*  \\bar g_2$ ($30  40$), the slack is non-zero, thus its dual variable must be zero: $\\mu_2 = 0$.\n    \\item Since $g_1^* > 0$ ($40 > 0$), the slack is non-zero, thus its dual variable must be zero: $\\alpha_1 = 0$.\n    \\item Since $g_2^* > 0$ ($30 > 0$), the slack is non-zero, thus its dual variable must be zero: $\\alpha_2 = 0$.\n    \\item Since $g_1^* = \\bar g_1$ ($40 = 40$), the slack is zero, so $\\mu_1$ can be non-negative: $\\mu_1 \\ge 0$.\n\\end{itemize}\nSo far, we have $\\alpha_1=0$, $\\alpha_2=0$, and $\\mu_2=0$. We can now use the stationarity conditions to find $\\lambda$ and $\\mu_1$.\n\nGenerator 2 is the marginal unit (it is operating between its bounds), so its marginal cost sets the system price $\\lambda$. From the stationarity condition for $g_2$:\n$$c_2 - \\lambda + \\mu_2 - \\alpha_2 = 0$$\nSubstituting the known values ($c_2 = 30$, $\\mu_2 = 0$, $\\alpha_2 = 0$):\n$$30 - \\lambda + 0 - 0 = 0 \\implies \\lambda = 30$$\nThe system marginal price is $\\lambda = 30 \\text{ \\$/MWh}$.\n\nNow, we use the stationarity condition for $g_1$:\n$$c_1 - \\lambda + \\mu_1 - \\alpha_1 = 0$$\nSubstituting the known values ($c_1 = 20$, $\\lambda = 30$, $\\alpha_1 = 0$):\n$$20 - 30 + \\mu_1 - 0 = 0$$\n$$-10 + \\mu_1 = 0 \\implies \\mu_1 = 10$$\nThis value satisfies the dual feasibility condition $\\mu_1 \\ge 0$. All KKT conditions are met.\n\nThe numerical values of the dual variables associated with the capacity constraints are therefore $\\mu_1 = 10 \\text{ \\$/MWh}$ and $\\mu_2 = 0 \\text{ \\$/MWh}$.\n\nThe non-zero value of $\\mu_1$ signifies that the capacity of generator $1$ is a scarce resource. It is a binding constraint on the optimization. The value $\\mu_1 = 10 \\text{ \\$/MWh}$ represents the shadow price of this capacity; if the capacity $\\bar g_1$ were increased by 1 MWh, the total system cost would decrease by \\$10. This is because 1 MWh of generation could be shifted from generator 2 (costing \\$30/MWh) to generator 1 (costing \\$20/MWh), for a net saving of $c_2 - c_1 = 30 - 20 = \\$10$.\n\nThe value $\\mu_2=0 \\text{ \\$/MWh}$ indicates that the capacity of generator 2 is not scarce. It is a non-binding constraint, and increasing its capacity would not change the optimal dispatch or reduce the total cost.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice increases realism by introducing non-linear, quadratic cost functions, where a generator's marginal cost is no longer constant. Your task is to apply the full set of KKT conditions not to solve, but to rigorously verify a proposed optimal solution, a common task in model validation. The exercise highlights a key principle: the system marginal price, $\\lambda$, must equal the marginal production cost of any generator that has spare capacity, directly connecting the dual variable to the varying marginal cost function of the flexible unit .",
            "id": "4098527",
            "problem": "Consider a single-node economic dispatch with two thermal generators serving a fixed energy demand. The decision variables are the generator outputs $g_1$ and $g_2$, measured in megawatt-hours. The total cost is the sum of convex quadratic generation costs, with $C_1(g_1) = \\frac{1}{2} a_1 g_1^2 + b_1 g_1$ and $C_2(g_2) = \\frac{1}{2} a_2 g_2^2 + b_2 g_2$. The dispatch is subject to an energy balance equality constraint $g_1 + g_2 = D$ and individual capacity bounds $0 \\leq g_i \\leq \\overline{g}_i$ for $i \\in \\{1,2\\}$. The parameters are $a_1 = 0.1$, $b_1 = 20$, $a_2 = 0.05$, $b_2 = 15$, $D = 120$ megawatt-hours, $\\overline{g}_1 = 80$ megawatt-hours, and $\\overline{g}_2 = 100$ megawatt-hours. Consider the candidate primal solution $g_1^{\\circ} = 20$ and $g_2^{\\circ} = 100$. Associated candidate dual variables for the bound constraints are $\\mu_1^{+,\\circ} = 0$, $\\mu_1^{-,\\circ} = 0$, $\\mu_2^{+,\\circ} = 2$, and $\\mu_2^{-,\\circ} = 0$, where $\\mu_i^{+}$ corresponds to the upper bound constraint $g_i \\leq \\overline{g}_i$ and $\\mu_i^{-}$ corresponds to the lower bound constraint $g_i \\geq 0$. For the energy balance equality constraint, the candidate dual variable is $\\lambda^{\\circ} = 21.5$.\n\nUsing the Karush-Kuhn-Tucker (KKT) system, determine whether the given candidate primal-dual pair $(g_1^{\\circ}, g_2^{\\circ}; \\mu_1^{+,\\circ}, \\mu_1^{-,\\circ}, \\mu_2^{+,\\circ}, \\mu_2^{-,\\circ}; \\lambda^{\\circ})$ is optimal. Explicitly justify each of the KKT conditions: primal feasibility, dual feasibility, stationarity, and complementary slackness. If any condition fails, deduce the unique value of the energy-balance dual variable $\\lambda$ that restores stationarity and yields optimality under the given primal candidate and bound multipliers, and interpret this value physically as the Locational Marginal Price (LMP).\n\nRound your final numerical answer to four significant figures. Express the final value in dollars per megawatt-hour.",
            "solution": "The problem is to validate a candidate primal-dual solution for a single-node economic dispatch problem with quadratic costs using the Karush-Kuhn-Tucker (KKT) conditions.\n\nThe optimization problem can be formally stated as:\n$$\n\\text{minimize} \\quad C(g_1, g_2) = \\left(\\frac{1}{2} a_1 g_1^2 + b_1 g_1\\right) + \\left(\\frac{1}{2} a_2 g_2^2 + b_2 g_2\\right)\n$$\nsubject to:\n$$\ng_1 + g_2 - D = 0 \\quad (\\text{dual variable } \\lambda) \\\\\ng_1 - \\overline{g}_1 \\leq 0 \\quad (\\text{dual variable } \\mu_1^+) \\\\\n-g_1 \\leq 0 \\quad (\\text{dual variable } \\mu_1^-) \\\\\ng_2 - \\overline{g}_2 \\leq 0 \\quad (\\text{dual variable } \\mu_2^+) \\\\\n-g_2 \\leq 0 \\quad (\\text{dual variable } \\mu_2^-)\n$$\nThe Lagrangian function $\\mathcal{L}$ for this problem, using a standard power systems convention, is:\n$$\n\\mathcal{L} = C(g_1, g_2) - \\lambda(g_1 + g_2 - D) + \\mu_1^+(g_1 - \\overline{g}_1) - \\mu_1^- g_1 + \\mu_2^+(g_2 - \\overline{g}_2) - \\mu_2^- g_2\n$$\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality are:\n1.  **Primal Feasibility**: All constraints must be satisfied.\n2.  **Dual Feasibility**: Multipliers for inequality constraints must be non-negative ($\\mu_i^+, \\mu_i^- \\geq 0$).\n3.  **Complementary Slackness**: For each inequality constraint, either the constraint is active or its dual variable is zero.\n4.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables must be zero.\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial g_1} = a_1 g_1 + b_1 - \\lambda + \\mu_1^+ - \\mu_1^- = 0$\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial g_2} = a_2 g_2 + b_2 - \\lambda + \\mu_2^+ - \\mu_2^- = 0$\n\nNow, we check if the given candidate primal-dual pair is optimal by verifying these four conditions.\n-   **Given values**: $g_1^{\\circ} = 20$, $g_2^{\\circ} = 100$, $\\lambda^{\\circ} = 21.5$, $\\mu_1^{+,\\circ} = 0$, $\\mu_1^{-,\\circ} = 0$, $\\mu_2^{+,\\circ} = 2$, $\\mu_2^{-,\\circ} = 0$.\n-   **Parameters**: $D = 120$, $\\overline{g}_1 = 80$, $\\overline{g}_2 = 100$, $a_1 = 0.1, b_1 = 20$, $a_2 = 0.05, b_2 = 15$.\n\n**1. Primal Feasibility Check:**\n-   $g_1^{\\circ} + g_2^{\\circ} = 20 + 100 = 120 = D$. The energy balance is satisfied.\n-   $0 \\leq g_1^{\\circ} \\leq \\overline{g}_1 \\implies 0 \\leq 20 \\leq 80$. This is true.\n-   $0 \\leq g_2^{\\circ} \\leq \\overline{g}_2 \\implies 0 \\leq 100 \\leq 100$. This is true.\nThe candidate solution **is primal feasible**.\n\n**2. Dual Feasibility Check:**\n-   $\\mu_1^{+,\\circ}=0 \\geq 0$, $\\mu_1^{-,\\circ}=0 \\geq 0$, $\\mu_2^{+,\\circ}=2 \\geq 0$, $\\mu_2^{-,\\circ}=0 \\geq 0$. All inequality multipliers are non-negative.\nThe candidate solution **is dual feasible**.\n\n**3. Complementary Slackness Check:**\n-   $\\mu_1^{+,\\circ}(g_1^{\\circ} - \\overline{g}_1) = 0 \\times (20 - 80) = 0$. Condition holds.\n-   $\\mu_1^{-,\\circ}(-g_1^{\\circ}) = 0 \\times (-20) = 0$. Condition holds.\n-   $\\mu_2^{+,\\circ}(g_2^{\\circ} - \\overline{g}_2) = 2 \\times (100 - 100) = 0$. Condition holds.\n-   $\\mu_2^{-,\\circ}(-g_2^{\\circ}) = 0 \\times (-100) = 0$. Condition holds.\nThe candidate solution **satisfies complementary slackness**.\n\n**4. Stationarity Check:**\n-   For $g_1$:\n    $$ a_1 g_1^{\\circ} + b_1 - \\lambda^{\\circ} + \\mu_1^{+,\\circ} - \\mu_1^{-,\\circ} = (0.1)(20) + 20 - 21.5 + 0 - 0 = 2 + 20 - 21.5 = 0.5 $$\n    Since $0.5 \\neq 0$, the stationarity condition for $g_1$ is **not satisfied**.\n-   For $g_2$:\n    $$ a_2 g_2^{\\circ} + b_2 - \\lambda^{\\circ} + \\mu_2^{+,\\circ} - \\mu_2^{-,\\circ} = (0.05)(100) + 15 - 21.5 + 2 - 0 = 5 + 15 - 21.5 + 2 = 0.5 $$\n    Since $0.5 \\neq 0$, the stationarity condition for $g_2$ is also **not satisfied**.\n\nBecause the stationarity condition fails, the candidate primal-dual pair is **not optimal**.\n\nThe second part of the problem asks for the unique value of $\\lambda$ that restores stationarity and yields optimality. The previous checks suggest that the primal solution ($g_1=20, g_2=100$) and the corresponding binding status of constraints are likely correct for the optimal solution. We can find the correct value of $\\lambda$ by enforcing the stationarity conditions.\n\nFrom the stationarity condition for $g_1$, which is not at a bound ($\\mu_1^+ = \\mu_1^- = 0$):\n$$ a_1 g_1^{\\circ} + b_1 - \\lambda = 0 $$\n$$ (0.1)(20) + 20 - \\lambda = 0 $$\n$$ 2 + 20 - \\lambda = 0 \\implies \\lambda = 22 $$\nWe can check this with the stationarity condition for $g_2$, which is at its upper bound, using the candidate dual $\\mu_2^{+,\\circ} = 2$:\n$$ a_2 g_2^{\\circ} + b_2 - \\lambda + \\mu_2^{+,\\circ} = 0 $$\n$$ (0.05)(100) + 15 - \\lambda + 2 = 0 $$\n$$ 5 + 15 + 2 - \\lambda = 0 \\implies \\lambda = 22 $$\nBoth equations consistently yield $\\lambda = 22$. With this new value $\\lambda^* = 22$, all four KKT conditions are met. Since the problem is convex, satisfying the KKT conditions is sufficient for optimality. Therefore, the unique value of $\\lambda$ that restores optimality is $22$. The units are dollars per megawatt-hour.\n\n**Physical Interpretation:**\nThe dual variable $\\lambda$ of the energy balance constraint is the Locational Marginal Price (LMP), also known as the system marginal price. It represents the marginal cost to the system of meeting one additional megawatt-hour of demand.\nIn this system, generator 2 is operating at its maximum capacity ($\\overline{g}_2 = 100$ MWh). Therefore, to meet an incremental increase in demand, the system must rely on generator 1, which has spare capacity ($g_1=20  \\overline{g}_1=80$). Thus, generator 1 is the \"marginal unit\". The system marginal price must be equal to the marginal cost of this marginal unit.\nThe marginal cost of generator 1 is given by its derivative:\n$$ \\frac{dC_1}{dg_1} = a_1 g_1 + b_1 $$\nAt the optimal operating point $g_1^* = 20$ MWh, the marginal cost is:\n$$ \\frac{dC_1}{dg_1}\\bigg|_{g_1=20} = (0.1)(20) + 20 = 2 + 20 = 22 \\text{ \\$/MWh} $$\nThis confirms that the LMP is indeed $\\lambda = 22$ $/MWh. The stationarity condition for an unconstrained generator ($0  g_1  \\overline{g}_1$) is simply $\\lambda = \\frac{dC_1}{dg_1}$.\n\nRounding to four significant figures, the value is $22.00$.",
            "answer": "$$\n\\boxed{22.00}\n$$"
        }
    ]
}