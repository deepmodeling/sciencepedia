{
    "hands_on_practices": [
        {
            "introduction": "这个练习介绍了能源系统中最常见的对偶变量解释：系统边际电价 (System Marginal Price, SMP) 或节点边际电价 (Locational Marginal Price, LMP)。通过解决一个简单的经济调度问题，你将看到 Karush-Kuhn-Tucker (KKT) 条件如何自然地导出一个结论：能源平衡约束的最优对偶变量由当前运行的最昂贵发电机（即“边际”发电机）的成本决定。这个练习是理解能源价格形成机制的基础。",
            "id": "4098522",
            "problem": "考虑一个纯能量市场中三个火力发电机组的静态单周期经济调度问题，其可变运营成本是线性的，并受全系统电量平衡要求的约束。规划目标是在满足非弹性需求的同时，最小化总可变发电成本。该数学规划问题是在约束条件 $g_1 + g_2 + g_3 \\ge D$ 和对每个 $i \\in \\{1,2,3\\}$ 有 $0 \\le g_i \\le \\bar g_i$ 的情况下，对 $g_1, g_2, g_3$ 最小化目标函数 $c_1 g_1 + c_2 g_2 + c_3 g_3$，其中 $g_i$ 表示发电机组 $i$ 的调度出力，$c_i$ 是其可变成本（单位：美元/兆瓦时），$\\bar g_i$ 是其容量（单位：兆瓦），$D$ 是系统总需求（单位：兆瓦）。设 $\\lambda \\ge 0$ 为电量平衡约束 $g_1 + g_2 + g_3 \\ge D$ 的对偶变量（拉格朗日乘子）。\n\n从拉格朗日函数的定义和 Karush–Kuhn–Tucker 条件出发，推导出表征最优解的平稳性条件和互补松弛性条件。当数据为成本 $c = (10, 20, 50)$ 美元/兆瓦时，容量 $\\bar g = (50, 30, 10)$ 兆瓦，以及需求 $D = 60$ 兆瓦时，使用这些条件计算最优对偶变量 $\\lambda$ 的数值。然后，将计算出的 $\\lambda$ 解释为此调度问题中能源的边际价值。\n\n以美元/兆瓦时为单位表示 $\\lambda$ 的数值。无需四舍五入。",
            "solution": "所述问题是一个用于经济调度的线性规划问题。让我们首先将该问题及其对偶问题形式化。原始问题是在发电容量和系统需求的约束下，最小化由目标函数 $C = c_1 g_1 + c_2 g_2 + c_3 g_3$ 给出的总发电成本。让我们将问题写成应用 Karush-Kuhn-Tucker (KKT) 条件的标准形式。决策变量是发电水平 $g_1, g_2, g_3$。\n\n优化问题是：\n$$ \\text{最小化} \\quad \\sum_{i=1}^{3} c_i g_i $$\n约束条件为：\n$$ D - \\sum_{i=1}^{3} g_i \\le 0 $$\n$$ -g_i \\le 0 \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n$$ g_i - \\bar g_i \\le 0 \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n\n我们为每个约束关联一个非负的对偶变量（拉格朗日乘子）：\n- $\\lambda \\ge 0$ 对应电量平衡约束 $D - \\sum_{i=1}^{3} g_i \\le 0$。\n- $\\mu_i \\ge 0$ 对应下限约束 $-g_i \\le 0$。\n- $\\nu_i \\ge 0$ 对应上限（容量）约束 $g_i - \\bar g_i \\le 0$。\n\n此问题的拉格朗日函数 $\\mathcal{L}$ 定义为目标函数加上对偶变量与其对应约束函数乘积之和：\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} c_i g_i + \\lambda \\left( D - \\sum_{i=1}^{3} g_i \\right) + \\sum_{i=1}^{3} \\mu_i (-g_i) + \\sum_{i=1}^{3} \\nu_i (g_i - \\bar g_i) $$\n按原始变量 $g_i$ 重新整理：\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} (c_i - \\lambda - \\mu_i + \\nu_i) g_i + \\lambda D - \\sum_{i=1}^{3} \\nu_i \\bar g_i $$\n\n最优解 $(g^*, \\lambda^*, \\mu^*, \\nu^*)$ 的 KKT 条件如下：\n$1$. **平稳性 (Stationarity)**：拉格朗日函数相对于原始变量 $g_i$ 的梯度必须为零。对每个 $i \\in \\{1, 2, 3\\}$：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_i} = c_i - \\lambda^* - \\mu_i^* + \\nu_i^* = 0 $$\n\n$2$. **互补松弛性 (Complementary Slackness)**：每个对偶变量与其对应的不等式约束的松弛量之积必须为零。\n$$ \\lambda^* \\left( D - \\sum_{i=1}^{3} g_i^* \\right) = 0 $$\n$$ \\mu_i^* (-g_i^*) = 0 \\quad \\implies \\quad \\mu_i^* g_i^* = 0 \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n$$ \\nu_i^* (g_i^* - \\bar g_i) = 0 \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n\n$3$. **原始可行性 (Primal Feasibility)**：解 $g^*$ 必须满足原始约束。\n$$ \\sum_{i=1}^{3} g_i^* \\ge D $$\n$$ 0 \\le g_i^* \\le \\bar g_i \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n\n$4$. **对偶可行性 (Dual Feasibility)**：不等式约束的对偶变量必须为非负。\n$$ \\lambda^* \\ge 0, \\quad \\mu_i^* \\ge 0, \\quad \\nu_i^* \\ge 0 \\quad \\text{对于 } i \\in \\{1, 2, 3\\} $$\n\n根据平稳性条件和互补松弛性条件，我们可以推导出每个发电机组 $i$ 的经济调度逻辑：\n- 如果一个发电机组的调度出力严格介于其上下限之间（$0  g_i^*  \\bar g_i$），那么根据互补松弛性，$g_i^* > 0$ 意味着 $\\mu_i^* = 0$，而 $g_i^*  \\bar g_i$ 意味着 $\\nu_i^* = 0$。平稳性条件简化为 $c_i - \\lambda^* = 0$，因此 $c_i = \\lambda^*$。该发电机组是设定价格的“边际”机组。\n- 如果一个发电机组以其最大容量运行（$g_i^* = \\bar g_i$），那么 $g_i^* > 0$ 意味着 $\\mu_i^* = 0$。平稳性条件为 $c_i - \\lambda^* + \\nu_i^* = 0$，或 $\\lambda^* = c_i + \\nu_i^*$。由于 $\\nu_i^* \\ge 0$，这意味着 $\\lambda^* \\ge c_i$。该发电机组是“边际内”机组。\n- 如果一个发电机组未被调度（$g_i^* = 0$），那么 $g_i^*  \\bar g_i$（假设 $\\bar g_i > 0$）意味着 $\\nu_i^* = 0$。平稳性条件为 $c_i - \\lambda^* - \\mu_i^* = 0$，或 $\\lambda^* = c_i - \\mu_i^*$。由于 $\\mu_i^* \\ge 0$，这意味着 $\\lambda^* \\le c_i$。该发电机组是“边际外”机组。\n\n现在我们将此逻辑应用于所提供的数据：\n- 成本：$c = (10, 20, 50)$ 美元/兆瓦时。\n- 容量：$\\bar g = (50, 30, 10)$ 兆瓦。\n- 需求：$D = 60$ 兆瓦。\n\n最优调度遵循经济次序（merit order），即优先使用成本最低的发电机组。\n$1$. 成本最低的发电机组是机组 1，其成本 $c_1 = 10$ 美元/兆瓦时，容量 $\\bar g_1 = 50$ 兆瓦。由于需求 $D=60$ 兆瓦大于其容量，我们以其最大容量进行调度。\n$g_1^* = \\bar g_1 = 50$ 兆瓦。\n剩余需求为 $D_{rem} = D - g_1^* = 60 - 50 = 10$ 兆瓦。\n\n$2$. 成本次低的发电机组是机组 2，其成本 $c_2 = 20$ 美元/兆瓦时，容量 $\\bar g_2 = 30$ 兆瓦。剩余需求为 $10$ 兆瓦，小于其容量。因此，我们调度机组 2 来满足剩余需求。\n$g_2^* = 10$ 兆瓦。\n现在的剩余需求为 $D_{rem} - g_2^* = 10 - 10 = 0$ 兆瓦。\n\n$3$. 成本最高的发电机组是机组 3，其成本 $c_3 = 50$ 美元/兆瓦时。由于需求已得到满足，该机组不被调度。\n$g_3^* = 0$ 兆瓦。\n\n最优调度为 $g^* = (g_1^*, g_2^*, g_3^*) = (50, 10, 0)$。\n让我们检查约束条件：$g_1^* + g_2^* + g_3^* = 50 + 10 + 0 = 60 = D$。电量平衡约束是紧的（active）。\n\n根据我们推导出的 KKT 逻辑，对偶变量 $\\lambda$ 由边际机组决定，边际机组是最后一个被调度且未在其极限容量下运行的机组。在本例中，发电机组 2 的调度出力为 $g_2^*=10$ 兆瓦，这在其上下限 $0  10  30$ 之内。因此，发电机组 2 是边际机组，其成本必须等于 $\\lambda$。\n$$ \\lambda^* = c_2 = 20 $$\n$\\lambda$ 的单位与成本单位相同，即美元/兆瓦时。\n\n让我们检查一致性：\n- 对于发电机组 1：$g_1^* = \\bar g_1$。条件是 $c_1 \\le \\lambda^*$。我们有 $10 \\le 20$，成立。\n- 对于发电机组 2：$0  g_2^*  \\bar g_2$。条件是 $c_2 = \\lambda^*$。我们有 $20 = 20$，成立。\n- 对于发电机组 3：$g_3^* = 0$。条件是 $c_3 \\ge \\lambda^*$。我们有 $50 \\ge 20$，成立。\n当 $\\lambda^* = 20$ 时，所有 KKT 条件都得到满足。\n\n与约束关联的对偶变量 $\\lambda$ 的经济学解释是放宽该约束的边际价值。在此背景下，$\\lambda$ 表示最小总成本对总需求 $D$ 微小变化的敏感度。即，$\\lambda^* = \\frac{dC^*(D)}{dD}$。\n$\\lambda^*=20$ 美元/兆瓦时的值表示，为满足额外一兆瓦的需求（即将 $D$ 从 $60$ 兆瓦增加到 $61$ 兆瓦），系统需要增加边际发电机组（即机组 2）的出力。这一额外电量的成本将是 $c_2 = 20$ 美元/兆瓦时。因此，该小时的总系统成本将增加 $20$ 美元。这个值也被称为系统边际价格（SMP）或能源的市场出清价格。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "除了能源本身的价格，优化模型还能告诉我们基础设施的价值。这个问题将焦点从能源平衡约束转移到发电机容量约束上。你将计算这些容量限制的对偶变量，并将其解释为“稀缺租金”(scarcity rents)，从而揭示系统愿意为一台受限发电机的额外单位容量支付多少费用。",
            "id": "4098486",
            "problem": "考虑一个持续时间为 $1$ 小时的单周期经济调度问题，其中包含两台火力发电机。设 $g_1$ 和 $g_2$ 分别表示每台机组在此期间产生的能量，单位为 $\\text{MWh}$。总需求为 $D$ $\\text{MWh}$，每台机组的能量上限为 $\\bar g_i$ $\\text{MWh}$，该上限由其功率容量乘以周期长度得出。边际运行成本是恒定的，由 $c_1$ 和 $c_2$ 给出，单位为 $\\$/\\text{MWh}$。系统运营商的目标是在满足需求并遵守机组限制的条件下，最小化总运行成本。使用以下数据：$c_1 = 20$ $\\$/\\text{MWh}$，$c_2 = 30$ $\\$/\\text{MWh}$，$\\bar g_1 = 40$ $\\text{MWh}$，$\\bar g_2 = 40$ $\\text{MWh}$，以及 $D = 70$ $\\text{MWh}$。\n\n从凸优化的基本原理和 Karush–Kuhn–Tucker (KKT) 条件出发，写出原始问题，并为拉格朗日函数推导其平稳性条件和互补松弛条件。其中，对偶变量 $\\lambda$ 对应需求平衡等式，$\\alpha_1$ 和 $\\alpha_2$ 对应非负性约束 $g_i \\ge 0$，$\\mu_1$ 和 $\\mu_2$ 对应容量约束 $g_i \\le \\bar g_i$。然后，利用这些条件，计算与容量约束 $g_1 \\le \\bar g_1$ 和 $g_2 \\le \\bar g_2$ 相关联的对偶变量 $\\mu_1$ 和 $\\mu_2$ 的数值，并判断哪个容量是稀缺的。报告 $\\mu_1$ 和 $\\mu_2$ 的数值，单位为 $\\$/\\text{MWh}$。\n\n提供精确值，无需四舍五入。对于最终答案，将 $\\mu_1$ 和 $\\mu_2$ 对以单行矩阵的形式呈现。",
            "solution": "用户提供了一个有效的问题陈述。该问题是一个标准的经济调度公式，它是一个凸优化问题（具体来说，是一个线性规划），因此是适定且有科学依据的。所有必要的数据都已提供，且没有内部矛盾。\n\n该问题是在满足指定需求并遵守发电机运行限制的条件下，最小化两台发电机的总运行成本。\n\n首先，我们构建原始优化问题。决策变量是发电量 $g_1$ 和 $g_2$，单位为 $\\text{MWh}$。目标函数是总成本，我们寻求将其最小化。\n$$\n\\min_{g_1, g_2} \\quad c_1 g_1 + c_2 g_2\n$$\n约束条件如下：\n\\begin{enumerate}\n    \\item 需求平衡约束（等式）：总发电量必须等于总需求 $D$。\n    $$g_1 + g_2 = D \\quad [\\lambda]$$\n    \\item 容量约束（不等式）：每台发电机的出力不能超过其最大容量 $\\bar g_i$。\n    $$g_1 \\le \\bar g_1 \\quad [\\mu_1]$$\n    $$g_2 \\le \\bar g_2 \\quad [\\mu_2]$$\n    \\item 非负性约束（不等式）：发电量不能为负。\n    $$g_1 \\ge 0 \\quad [\\alpha_1]$$\n    $$g_2 \\ge 0 \\quad [\\alpha_2]$$\n\\end{enumerate}\n在此，括号中的符号表示与每个约束相关联的拉格朗日乘子（对偶变量）。\n\n为了应用 Karush–Kuhn–Tucker (KKT) 条件，我们首先将约束写成标准形式，$h(x) = 0$ 和 $g(x) \\le 0$：\n$$g_1 + g_2 - D = 0$$\n$$g_1 - \\bar g_1 \\le 0$$\n$$g_2 - \\bar g_2 \\le 0$$\n$$-g_1 \\le 0$$\n$$-g_2 \\le 0$$\n\n这个问题的拉格朗日函数 $\\mathcal{L}$ 是通过将每个约束乘以其各自的对偶变量后，加到目标函数上构建的：\n$$\n\\mathcal{L}(g_1, g_2, \\lambda, \\mu_1, \\mu_2, \\alpha_1, \\alpha_2) = c_1 g_1 + c_2 g_2 + \\lambda(g_1 + g_2 - D) + \\mu_1(g_1 - \\bar g_1) + \\mu_2(g_2 - \\bar g_2) + \\alpha_1(-g_1) + \\alpha_2(-g_2)\n$$\n最优性的 KKT 条件是：\n\\begin{enumerate}\n    \\item **平稳性**：拉格朗日函数关于原始变量的梯度必须为零。\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 + \\lambda + \\mu_1 - \\alpha_1 = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 + \\lambda + \\mu_2 - \\alpha_2 = 0$$\n    \\item **原始可行性**：原始变量必须满足所有原始约束。\n    $$g_1 + g_2 = D$$\n    $$g_1 \\le \\bar g_1, \\quad g_2 \\le \\bar g_2$$\n    $$g_1 \\ge 0, \\quad g_2 \\ge 0$$\n    \\item **对偶可行性**：不等式约束的对偶变量必须为非负。\n    $$\\mu_1 \\ge 0, \\quad \\mu_2 \\ge 0$$\n    $$\\alpha_1 \\ge 0, \\quad \\alpha_2 \\ge 0$$\n    等式约束的对偶变量 $\\lambda$ 的符号无限制。\n    \\item **互补松弛性**：不等式约束的对偶变量与其对应松弛量的乘积必须为零。\n    $$\\mu_1(g_1 - \\bar g_1) = 0$$\n    $$\\mu_2(g_2 - \\bar g_2) = 0$$\n    $$\\alpha_1(-g_1) = 0 \\implies \\alpha_1 g_1 = 0$$\n    $$\\alpha_2(-g_2) = 0 \\implies \\alpha_2 g_2 = 0$$\n\\end{enumerate}\n现在我们使用给定数据来解这个方程组：$c_1 = 20$，$c_2 = 30$，$\\bar g_1 = 40$，$\\bar g_2 = 40$，以及 $D = 70$。\n\n一个理性的运营商会优先选择边际成本较低的发电机。由于 $c_1  c_2$，发电机 $1$ 首先被调度。其最大出力为 $\\bar g_1 = 40$ $\\text{MWh}$。我们假设以其最大容量进行调度。\n所以，我们设置 $g_1 = 40$ $\\text{MWh}$。\n\n根据需求平衡约束，我们确定发电机 $2$ 所需的出力：\n$$g_2 = D - g_1 = 70 - 40 = 30 \\text{ MWh}$$\n\n我们现在检查这个解是否是原始可行的。\n\\begin{itemize}\n    \\item $g_1 = 40 \\le \\bar g_1 = 40$。此条件满足，且该约束是激活的（紧约束）。\n    \\item $g_2 = 30 \\le \\bar g_2 = 40$。此条件满足，且该约束是非激活的（非紧约束）。\n    \\item $g_1 = 40 \\ge 0$。此条件满足，且该约束是非激活的。\n    \\item $g_2 = 30 \\ge 0$。此条件满足，且该约束是非激活的。\n\\end{itemize}\n提出的解 $g_1^*=40$ 和 $g_2^*=30$ 是原始可行的。我们现在使用 KKT 条件来找到对偶变量并验证最优性。\n\n根据互补松弛性：\n\\begin{itemize}\n    \\item 由于 $g_2^*  \\bar g_2$ ($30  40$)，松弛量非零，因此其对偶变量必须为零：$\\mu_2 = 0$。\n    \\item 由于 $g_1^* > 0$ ($40 > 0$)，松弛量非零，因此其对偶变量必须为零：$\\alpha_1 = 0$。\n    \\item 由于 $g_2^* > 0$ ($30 > 0$)，松弛量非零，因此其对偶变量必须为零：$\\alpha_2 = 0$。\n    \\item 由于 $g_1^* = \\bar g_1$ ($40 = 40$)，松弛量为零，所以 $\\mu_1$ 可以为非负：$\\mu_1 \\ge 0$。\n\\end{itemize}\n到目前为止，我们有 $\\alpha_1=0$，$\\alpha_2=0$ 和 $\\mu_2=0$。我们现在可以使用平稳性条件来求解 $\\lambda$ 和 $\\mu_1$。\n\n关于 $g_2$ 的平稳性条件是：\n$$c_2 + \\lambda + \\mu_2 - \\alpha_2 = 0$$\n代入已知值（$c_2 = 30$，$\\mu_2 = 0$，$\\alpha_2 = 0$）：\n$$30 + \\lambda + 0 - 0 = 0 \\implies \\lambda = -30$$\n对偶变量 $\\lambda$ 的单位是 $\\$/\\text{MWh}$。系统边际价格是 $-\\lambda = 30 \\ \\$/\\text{MWh}$，这等于边际发电机 $c_2$ 的成本。\n\n现在，我们使用关于 $g_1$ 的平稳性条件：\n$$c_1 + \\lambda + \\mu_1 - \\alpha_1 = 0$$\n代入已知值（$c_1 = 20$，$\\lambda = -30$，$\\alpha_1 = 0$）：\n$$20 + (-30) + \\mu_1 - 0 = 0$$\n$$-10 + \\mu_1 = 0 \\implies \\mu_1 = 10$$\n这个值满足对偶可行性条件 $\\mu_1 \\ge 0$。所有 KKT 条件都已满足。\n\n因此，与容量约束相关的对偶变量的数值为 $\\mu_1 = 10 \\ \\$/\\text{MWh}$ 和 $\\mu_2 = 0 \\ \\$/\\text{MWh}$。\n\n$\\mu_1$ 的非零值表明发电机 $1$ 的容量是一种稀缺资源。它是对优化的一个紧约束。$\\mu_1=10 \\ \\$/\\text{MWh}$ 这个值代表了该容量的影子价格；如果容量 $\\bar g_1$ 增加 $1 \\ \\text{MWh}$，系统总成本将减少 $10$ 美元。这是因为 $1 \\ \\text{MWh}$ 的发电量可以从发电机 $2$（成本为 $30\\$/\\text{MWh}$）转移到发电机 $1$（成本为 $20\\$/\\text{MWh}$），从而净节省 $c_2 - c_1 = 30 - 20 = 10$ 美元。\n\n$\\mu_2=0 \\ \\$/\\text{MWh}$ 这个值表明发电机 $2$ 的容量并不稀缺。它是一个非紧约束，增加其容量不会改变最优调度或降低总成本。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "对偶变量能够揭示一些反直觉的经济信号。本练习提出了一个场景，其中不灵活的“必须运行”的发电机导致了能源的过剩供应。你将使用 KKT 条件来证明这种情况如何迫使系统为能源处理支付费用，从而产生负的节点边际电价 (LMP)，并展示对偶变量如何正确捕捉到需求增加带来的边际成本节约。",
            "id": "4098509",
            "problem": "考虑一个稳态下的单节点经济调度问题，该问题是节点电价计算的一个典型示例。该节点具有固定的无弹性需求 $D = 90$ 兆瓦。有两台发电机和一个弃电选项：\n- 一台必须运行的发电机 $M$，其出力 $g_{M}$ 受有约束力的下限 $g_{M} \\geq \\underline{g}_{M}$ 限制，其中 $\\underline{g}_{M} = 110$ 兆瓦。其边际生产成本为 $c_{M} = 0$ 货币单位/兆瓦时 (CU/MWh)。\n- 一台灵活发电机 $F$，其出力 $g_{F} \\geq 0$，边际生产成本为 $c_{F} = 40$ CU/MWh。容量上限足够大，因而不构成约束。\n- 一个非物理耗散选项，建模为决策变量 $w \\geq 0$，代表当供应超过需求时，以边际惩罚成本 $c_{w} = 9.7$ CU/MWh 进行的能量倾销或强制弃电。\n\n建立原始优化问题，目标是最小化总运行成本，约束条件为能量平衡和边界条件。其中，单节点能量平衡方程写作：\n$$\nD - g_{M} - g_{F} + w = 0,\n$$\n并令 $\\lambda$ 表示与此等式相关的拉格朗日乘子。该节点的节点边际电价 (LMP) 定义为该节点能量的影子价值，在此符号约定下等于最优乘子 $\\lambda$。利用凸优化（Karush–Kuhn–Tucker 最优性条件）的基本原理，论证对偶变量的符号限制，并严格证明负的 LMP 是如何由有约束力的下限和具有正边际惩罚的 $w$ 的存在而产生的。\n\n根据给定数据计算该节点的 LMP 数值。将您的答案四舍五入到 4 位有效数字。以 CU/MWh 为单位表示最终价格。",
            "solution": "问题要求计算单个节点的节点边际电价 (LMP)，其定义为与能量平衡约束相关的最优拉格朗日乘子 $\\lambda$。我们将首先验证问题，然后将其表述为凸优化问题，最后使用 Karush-Kuhn-Tucker (KKT) 条件求解。\n\n该问题是有效的。它描述了一个标准的经济调度场景，这是能源系统工程中一个适定的线性规划问题。所提供的数据（$D=90$ MW, $\\underline{g}_M = 110$ MW, $c_M=0$ CU/MWh, $c_F=40$ CU/MWh, $c_w=9.7$ CU/MWh）是自洽且现实的，可用于说明由于不灵活的发电而导致的负电价经济现象。该问题具有科学依据，是客观的，并包含足够的信息以获得唯一解。\n\n原始优化问题是最小化系统总运行成本，即生产成本和惩罚成本之和。\n要最小化的目标函数是：\n$$\nC(g_M, g_F, w) = c_M g_M + c_F g_F + c_w w\n$$\n决策变量是发电机出力 $g_M$ 和 $g_F$，以及弃电量 $w$。该优化受以下几个约束条件限制：\n\n1.  能量平衡：$D - g_M - g_F + w = 0$\n2.  发电机 $M$ 下限：$g_M \\geq \\underline{g}_M$\n3.  发电机 $F$ 下限：$g_F \\geq 0$\n4.  弃电量下限：$w \\geq 0$\n\n为了应用 KKT 条件，我们将不等式约束写成标准形式 $h(x) \\leq 0$：\n1. 能量平衡：$D - g_M - g_F + w = 0 \\quad (\\lambda)$\n2. 发电机 $M$ 边界：$\\underline{g}_M - g_M \\leq 0 \\quad (\\mu_M)$\n3. 发电机 $F$ 边界：$-g_F \\leq 0 \\quad (\\mu_F)$\n4. 弃电量边界：$-w \\leq 0 \\quad (\\mu_w)$\n\n这里，$\\lambda$ 是等式约束的拉格朗日乘子，$\\mu_M, \\mu_F, \\mu_w$ 是不等式约束的 KKT 乘子。\n\n此问题的拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(g_M, g_F, w, \\lambda, \\mu_M, \\mu_F, \\mu_w) = (c_M g_M + c_F g_F + c_w w) + \\lambda(D - g_M - g_F + w) + \\mu_M(\\underline{g}_M - g_M) + \\mu_F(-g_F) + \\mu_w(-w)\n$$\n\n一阶 KKT 最优性条件如下：\n\n(a) **平稳性**（在最优解处，$\\mathcal{L}$ 对原始变量的梯度为零）：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_M} = c_M - \\lambda - \\mu_M = 0 \\implies c_M - \\lambda = \\mu_M\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_F} = c_F - \\lambda - \\mu_F = 0 \\implies c_F - \\lambda = \\mu_F\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial w} = c_w + \\lambda - \\mu_w = 0 \\implies c_w + \\lambda = \\mu_w\n$$\n\n(b) **原始可行性**：最优解 $(g_M^*, g_F^*, w^*)$ 必须满足原始约束。\n\n(c) **对偶可行性**：不等式约束的 KKT 乘子必须为非负：$\\mu_M \\geq 0$, $\\mu_F \\geq 0$, $\\mu_w \\geq 0$。\n\n(d) **互补松弛性**：对于每个不等式约束，乘子与约束函数在最优解处的乘积必须为零：\n$$\n\\mu_M(\\underline{g}_M - g_M^*) = 0\n$$\n$$\n\\mu_F(-g_F^*) = 0 \\implies \\mu_F g_F^* = 0\n$$\n$$\n\\mu_w(-w^*) = 0 \\implies \\mu_w w^* = 0\n$$\n\n现在我们使用提供的数据来求解该系统：$D=90$, $\\underline{g}_M=110$, $c_M=0$, $c_F=40$, $c_w=9.7$。\n\n问题陈述发电机 $M$ 的下限是有约束力的。这意味着 $g_M^* = \\underline{g}_M = 110$。\n当 $g_M^* = 110$ 时，能量平衡方程要求 $90 - 110 - g_F^* + w^* = 0$，简化为 $w^* = g_F^* + 20$。\n\n为了最小化成本，系统应尽可能避免调度昂贵的灵活发电机 $F$（成本 $c_F = 40$）。必须运行的发电机 $M$ 已经产生了 $110 - 90 = 20$ MW 的盈余。这个盈余必须被发电机 $F$ 消耗（这是荒谬的）或通过 $w$ 弃掉。没有经济上的理由让发电机 $F$ 以 $40$ CU/MWh 的成本产生额外的电力，然后再以 $9.7$ CU/MWh 的额外成本将其弃掉。因此，灵活发电机的最优出力必须为零：$g_F^* = 0$。\n\n让我们严格地确认 $g_F^*=0$。使用反证法，假设 $g_F^*>0$。根据互补松弛性 ($\\mu_F g_F^* = 0$)，我们必有 $\\mu_F=0$。那么 $g_F$ 的平稳性条件意味着 $c_F - \\lambda = 0$，所以 $\\lambda = c_F = 40$。$w$ 的平稳性条件是 $c_w + \\lambda = \\mu_w$，这得到 $\\mu_w = 9.7 + 40 = 49.7$。由于 $\\mu_w>0$，互补松弛性 ($\\mu_w w^*=0$) 要求 $w^*=0$。将 $g_F^*>0$ 和 $w^*=0$ 代入能量平衡关系 $w^* = g_F^* + 20$ 中，得到 $0 = g_F^* + 20$，即 $g_F^* = -20$。这与原始可行性约束 $g_F \\geq 0$ 相矛盾。因此，假设 $g_F^*>0$ 是错误的，必然有 $g_F^*=0$。\n\n当 $g_F^*=0$ 时，能量平衡关系 $w^* = g_F^* + 20$ 得到 $w^* = 20$。\n最优原始变量为：$g_M^*=110$, $g_F^*=0$, $w^*=20$。这个解是原始可行的，因为 $g_M^* \\ge 110$, $g_F^* \\ge 0$, 且 $w^* \\ge 0$。\n\n现在我们确定 LMP，即 $\\lambda$。由于 $w^* = 20 > 0$，约束 $-w \\leq 0$ 不起作用（非紧约束）。互补松弛性 ($\\mu_w w^* = 0$) 意味着其乘子必须为零：$\\mu_w = 0$。\n使用 $w$ 的平稳性条件：\n$$\nc_w + \\lambda = \\mu_w\n$$\n$$\n9.7 + \\lambda = 0\n$$\n$$\n\\lambda = -9.7\n$$\n因此，该节点的 LMP 为 $-9.7$ CU/MWh。\n\n负电价的产生是由于必须运行的发电机有约束力的最小运行下限导致了能量的过剩供应（110 兆瓦的供应对 90 兆瓦的需求）。为了维持平衡，这 20 兆瓦的盈余必须以 $c_w = 9.7$ CU/MWh 的成本弃掉。需求的增量增加将减少需要弃掉的能量，从而为系统节省资金。因此，额外一兆瓦时需求的价值是这个弃电成本的负值，从而导致 $\\lambda = -c_w$。\n\n为了完整起见，我们可以验证其余的 KKT 条件。\n对于 $g_F$，当 $\\lambda = -9.7$ 时：\n$\\mu_F = c_F - \\lambda = 40 - (-9.7) = 49.7$。由于 $\\mu_F>0$ 且 $g_F^*=0$，对偶可行性和互补松弛性成立。\n\n对于 $g_M$，当 $\\lambda = -9.7$ 时：\n$\\mu_M = c_M - \\lambda = 0 - (-9.7) = 9.7$。由于 $\\mu_M>0$ 且 $g_M^* = \\underline{g}_M$，对偶可行性和互补松弛性成立。\n\n所有 KKT 条件均得到满足，证实了解的最优性。问题要求将答案四舍五入到 4 位有效数字。",
            "answer": "$$\\boxed{-9.700}$$"
        }
    ]
}