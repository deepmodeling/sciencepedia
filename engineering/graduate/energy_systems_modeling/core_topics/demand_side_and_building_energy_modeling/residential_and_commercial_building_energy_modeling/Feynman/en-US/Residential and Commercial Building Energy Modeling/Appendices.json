{
    "hands_on_practices": [
        {
            "introduction": "Understanding the flow of heat through a building's envelope is a cornerstone of energy modeling. We often simplify complex building components like walls into electrical circuit analogs, known as lumped-parameter models. This first practice  invites you to analyze a classic two-resistance, one-capacitance ($2\\mathrm{R}1\\mathrm{C}$) model of a wall to determine its steady-state behavior, reinforcing the foundational principles of thermal resistance and heat flux calculation.",
            "id": "4118238",
            "problem": "A single wall of a conditioned commercial space is modeled as a two-resistance one-capacitance ($2\\mathrm{R}1\\mathrm{C}$) lumped network. The outside air temperature is constant at $T_{o}=0~^{\\circ}\\mathrm{C}$, and the zone air temperature is regulated at a constant setpoint $T_{z}=21~^{\\circ}\\mathrm{C}$ by the heating, ventilation, and air-conditioning system. The wall is represented by an internal lumped thermal mass node at temperature $T_{w}$ connected to the outside air by a thermal resistance $R_{1}=0.5~\\mathrm{K/W}$ and to the zone air by a thermal resistance $R_{2}=0.8~\\mathrm{K/W}$. The lumped thermal capacitance at the node is $C=40~\\mathrm{kJ/K}$. Assume one-dimensional heat transfer and that the resistances are effective, linear, and time-invariant over the operating range.\n\nStarting from conservation of energy (first law of thermodynamics) applied to the lumped wall node, and the definition of conductive heat flow through a thermal resistance as a temperature difference divided by thermal resistance, determine the steady-state heat flux $q$ through the wall, defined as positive when flowing from the zone air to the outside air, and the steady-state wall node temperature $T_{w}$. Express $q$ in $\\mathrm{W}$ and $T_{w}$ in $^{\\circ}\\mathrm{C}$. Round each to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The model described is a standard lumped-parameter thermal network, and the question pertains to its steady-state behavior, a fundamental concept in heat transfer and building energy analysis.\n\nThe analysis begins with the first law of thermodynamics applied to the lumped wall node, which has a temperature $T_w$ and a thermal capacitance $C$. The rate of change of internal energy of the node is equal to the net rate of heat transfer into the node. The heat transfer into the node is from the zone air at temperature $T_z$ through thermal resistance $R_2$. The heat transfer out of the node is to the outside air at temperature $T_o$ through thermal resistance $R_1$.\n\nThe energy balance equation for the node is:\n$$ C \\frac{dT_w}{dt} = \\dot{Q}_{in} - \\dot{Q}_{out} $$\n\nThe heat flow rates are defined by the temperature differences and thermal resistances:\nThe heat flow from the zone to the wall node is $\\dot{Q}_{z \\to w} = \\frac{T_z - T_w}{R_2}$.\nThe heat flow from the wall node to the outside is $\\dot{Q}_{w \\to o} = \\frac{T_w - T_o}{R_1}$.\n\nSubstituting these expressions into the energy balance equation yields:\n$$ C \\frac{dT_w}{dt} = \\frac{T_z - T_w}{R_2} - \\frac{T_w - T_o}{R_1} $$\n\nThe problem asks for the steady-state conditions. In steady state, the temperature of the wall node does not change with time, which means $\\frac{dT_w}{dt} = 0$. The capacitance $C$ of the wall, which is given as $C=40~\\mathrm{kJ/K}$, is therefore not relevant for the steady-state calculation. Setting the time derivative to zero simplifies the energy balance to:\n$$ 0 = \\frac{T_z - T_w}{R_2} - \\frac{T_w - T_o}{R_1} $$\n\nThis equation signifies that in steady state, the heat flow into the node equals the heat flow out of the node:\n$$ \\frac{T_z - T_w}{R_2} = \\frac{T_w - T_o}{R_1} $$\n\nWe can now solve for the unknown steady-state wall temperature, $T_w$. Rearranging the equation:\n$$ R_1 (T_z - T_w) = R_2 (T_w - T_o) $$\n$$ R_1 T_z - R_1 T_w = R_2 T_w - R_2 T_o $$\n$$ R_1 T_z + R_2 T_o = (R_1 + R_2) T_w $$\n$$ T_w = \\frac{R_1 T_z + R_2 T_o}{R_1 + R_2} $$\n\nNow, we substitute the given numerical values: $T_z = 21~^{\\circ}\\mathrm{C}$, $T_o = 0~^{\\circ}\\mathrm{C}$, $R_1 = 0.5~\\mathrm{K/W}$, and $R_2 = 0.8~\\mathrm{K/W}$. Since the temperature calculation involves a weighted average where the resistance units cancel, we may use degrees Celsius directly.\n$$ T_w = \\frac{(0.5~\\mathrm{K/W})(21~^{\\circ}\\mathrm{C}) + (0.8~\\mathrm{K/W})(0~^{\\circ}\\mathrm{C})}{0.5~\\mathrm{K/W} + 0.8~\\mathrm{K/W}} $$\n$$ T_w = \\frac{10.5}{1.3}~^{\\circ}\\mathrm{C} \\approx 8.076923...~^{\\circ}\\mathrm{C} $$\nRounding to four significant figures, the wall node temperature is $T_w = 8.077~^{\\circ}\\mathrm{C}$.\n\nNext, we determine the steady-state heat flux $q$. The problem defines $q$ as positive when flowing from the zone air to the outside air. In steady state, the heat flux is constant through the entire thermal network. It can be calculated as the total temperature difference divided by the total thermal resistance. The resistances $R_1$ and $R_2$ are in series, so the total resistance $R_{total}$ is their sum:\n$$ R_{total} = R_1 + R_2 $$\nThe steady-state heat flux $q$ is then:\n$$ q = \\frac{T_z - T_o}{R_{total}} = \\frac{T_z - T_o}{R_1 + R_2} $$\n\nSubstituting the numerical values:\n$$ q = \\frac{21~^{\\circ}\\mathrm{C} - 0~^{\\circ}\\mathrm{C}}{0.5~\\mathrm{K/W} + 0.8~\\mathrm{K/W}} $$\nA temperature difference in degrees Celsius is equal to a temperature difference in Kelvin.\n$$ q = \\frac{21~\\mathrm{K}}{1.3~\\mathrm{K/W}} = \\frac{21}{1.3}~\\mathrm{W} \\approx 16.153846...~\\mathrm{W} $$\nRounding to four significant figures, the heat flux is $q = 16.15~\\mathrm{W}$.\n\nAs a verification, one can calculate the heat flux using the calculated wall temperature $T_w$:\n$$ q = \\frac{T_w - T_o}{R_1} = \\frac{8.077~^{\\circ}\\mathrm{C} - 0~^{\\circ}\\mathrm{C}}{0.5~\\mathrm{K/W}} \\approx \\frac{8.077~\\mathrm{K}}{0.5~\\mathrm{K/W}} \\approx 16.154~\\mathrm{W} $$\n$$ q = \\frac{T_z - T_w}{R_2} = \\frac{21~^{\\circ}\\mathrm{C} - 8.077~^{\\circ}\\mathrm{C}}{0.8~\\mathrm{K/W}} \\approx \\frac{12.923~\\mathrm{K}}{0.8~\\mathrm{K/W}} \\approx 16.154~\\mathrm{W} $$\nThe minor difference is due to rounding $T_w$ before the verification calculation. Using the unrounded value for $T_w$ yields an exact match, confirming the consistency of the results. The final answers are the rounded values as requested.",
            "answer": "$$\\boxed{\\begin{pmatrix} 16.15 & 8.077 \\end{pmatrix}}$$"
        },
        {
            "introduction": "After modeling individual components, we can scale up our analysis to an entire building zone, treating it as a single, well-mixed volume of air. This practice  challenges you to formulate and solve the complete energy balance for an office space, accounting for conduction, ventilation, and internal heat gains. By calculating both the steady-state temperature and the system's time constant $\\tau$, you will gain crucial insights into the dynamic thermal response of buildings.",
            "id": "4118294",
            "problem": "A single well-mixed zone model is used for a mechanically cooled open-plan office. The floor area is $200$ m$^2$, and the thermal conductance to the outdoors is $U A = 150$ W/K. The zone is supplied by Heating, Ventilation, and Air-Conditioning (HVAC) system air with mass flow rate $\\dot{m}_{sa} = 0.6$ kg/s at a constant supply air temperature $T_{sa} = 16^\\circ$C. The outdoor air temperature is $T_{o} = 30^\\circ$C. Internal heat gains are constant at $Q_{int} = 3$ kW, and solar gains are initially constant at $Q_{sol} = 2$ kW. The effective thermal capacitance of the zone air and lightweight contents is $C_{z} = 300$ kJ/K. Assume the constant-pressure specific heat of air is $c_{p} = 1005$ J/(kg K). Neglect infiltration and moisture effects. Consider the standard first-principles energy balance for a well-mixed zone air node.\n\n- First, derive from fundamentals and compute the steady-state zone air temperature $T_{z,ss}$ corresponding to the given constant inputs.\n- Next, suppose that at time $t=0$ the solar gains $Q_{sol}$ undergo a step change to a new constant value. Using the same first-principles model, determine the time constant $\\tau$ governing the first-order transient response of the zone air temperature to this step.\n\nRound your answers to four significant figures. Express $T_{z,ss}$ in degrees Celsius and $\\tau$ in minutes. The final answer must be reported as two values in a single row.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of thermodynamics and heat transfer, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We can proceed with the solution.\n\nThe first step is to establish the governing first-principles energy balance for the single well-mixed zone. The rate of change of internal energy of the zone's thermal mass is equal to the sum of all heat gains minus the sum of all heat losses. The thermal energy of the zone is given by $C_z T_z$. Its rate of change is $C_z \\frac{dT_z}{dt}$.\n\nThe heat gains and losses for the zone are:\n1.  Constant internal heat gains, $Q_{int}$.\n2.  Solar heat gains, $Q_{sol}$.\n3.  Heat transfer through the building envelope (thermal conductance $UA$) to the outdoors at temperature $T_o$. This is a gain if $T_o > T_z$ and a loss if $T_z > T_o$. The rate of heat flow is $UA (T_o - T_z)$.\n4.  Net heat transfer from the HVAC system, which supplies air at a mass flow rate $\\dot{m}_{sa}$ and temperature $T_{sa}$. As the zone is well-mixed, the air leaving the zone is at the zone temperature $T_z$. The net rate of energy advected into the zone is $\\dot{m}_{sa} c_p (T_{sa} - T_z)$.\n\nCombining these terms gives the governing ordinary differential equation (ODE) for the zone air temperature $T_z$:\n$$\nC_z \\frac{dT_z}{dt} = Q_{int} + Q_{sol} + UA (T_o - T_z) + \\dot{m}_{sa} c_p (T_{sa} - T_z)\n$$\nThis equation forms the basis for both parts of the problem.\n\nFirst, we will find the steady-state zone air temperature, $T_{z,ss}$. At steady state, the temperature of the zone is constant, which means the time derivative is zero: $\\frac{dT_z}{dt} = 0$. Setting the left-hand side of the ODE to zero, we get:\n$$\n0 = Q_{int} + Q_{sol} + UA (T_o - T_{z,ss}) + \\dot{m}_{sa} c_p (T_{sa} - T_{z,ss})\n$$\nWe can now solve for $T_{z,ss}$ by rearranging the terms. First, expand the terms containing $T_{z,ss}$:\n$$\n0 = Q_{int} + Q_{sol} + UA T_o - UA T_{z,ss} + \\dot{m}_{sa} c_p T_{sa} - \\dot{m}_{sa} c_p T_{z,ss}\n$$\nCollect all terms involving $T_{z,ss}$ on one side:\n$$\nUA T_{z,ss} + \\dot{m}_{sa} c_p T_{z,ss} = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\nFactor out $T_{z,ss}$:\n$$\nT_{z,ss} (UA + \\dot{m}_{sa} c_p) = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\nFinally, the expression for the steady-state temperature is:\n$$\nT_{z,ss} = \\frac{Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}}{UA + \\dot{m}_{sa} c_p}\n$$\nNow, we substitute the given numerical values. All temperatures can be expressed in degrees Celsius as the equation structure is a weighted average, making the choice of Celsius or Kelvin scale equivalent for the result. We must ensure all other units are consistent (SI units: W, J, s, kg, K).\n\nGiven values:\n$Q_{int} = 3 \\text{ kW} = 3000 \\text{ W}$\n$Q_{sol} = 2 \\text{ kW} = 2000 \\text{ W}$\n$UA = 150 \\text{ W/K}$\n$T_o = 30^\\circ\\text{C}$\n$\\dot{m}_{sa} = 0.6 \\text{ kg/s}$\n$c_p = 1005 \\text{ J/(kg K)}$\n$T_{sa} = 16^\\circ\\text{C}$\n\nFirst, calculate the advective heat transfer coefficient:\n$\\dot{m}_{sa} c_p = 0.6 \\text{ kg/s} \\times 1005 \\text{ J/(kg K)} = 603 \\text{ W/K}$\n\nNow, substitute all values into the expression for $T_{z,ss}$:\n$$\nT_{z,ss} = \\frac{3000 + 2000 + (150 \\times 30) + (603 \\times 16)}{150 + 603}\n$$\n$$\nT_{z,ss} = \\frac{5000 + 4500 + 9648}{753} = \\frac{19148}{753} \\approx 25.42895... \\text{ }^\\circ\\text{C}\n$$\nRounding to four significant figures, the steady-state temperature is $T_{z,ss} = 25.43^\\circ\\text{C}$.\n\nNext, we determine the time constant $\\tau$ of the system. The time constant characterizes the rate of response of a first-order system to a change in its inputs. To find it, we rearrange the original ODE into the standard form of a first-order linear system: $\\tau \\frac{dy}{dt} + y = K \\cdot f(t)$.\n\nStarting with the full ODE:\n$$\nC_z \\frac{dT_z}{dt} = Q_{int} + Q_{sol} + UA T_o - UA T_z + \\dot{m}_{sa} c_p T_{sa} - \\dot{m}_{sa} c_p T_z\n$$\nGroup all terms containing the state variable $T_z$ on the left-hand side:\n$$\nC_z \\frac{dT_z}{dt} + UA T_z + \\dot{m}_{sa} c_p T_z = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\nFactor out $T_z$:\n$$\nC_z \\frac{dT_z}{dt} + (UA + \\dot{m}_{sa} c_p) T_z = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\nTo match the standard form $\\tau \\frac{dT_z}{dt} + T_z = ...$, we divide the entire equation by the coefficient of $T_z$, which is $(UA + \\dot{m}_{sa} c_p)$:\n$$\n\\frac{C_z}{UA + \\dot{m}_{sa} c_p} \\frac{dT_z}{dt} + T_z = \\frac{Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}}{UA + \\dot{m}_{sa} c_p}\n$$\nBy comparing this equation to the standard form, we can identify the time constant $\\tau$ as the coefficient of the derivative term:\n$$\n\\tau = \\frac{C_z}{UA + \\dot{m}_{sa} c_p}\n$$\nNote that the time constant depends only on the system's intrinsic properties (capacitance $C_z$ and heat loss coefficients $UA$ and $\\dot{m}_{sa} c_p$) and is independent of the external forcing functions like gains and temperatures.\n\nWe substitute the given numerical values, ensuring consistent units:\n$C_z = 300 \\text{ kJ/K} = 300 \\times 10^3 \\text{ J/K} = 300000 \\text{ J/K}$\n$UA + \\dot{m}_{sa} c_p = 150 \\text{ W/K} + 603 \\text{ W/K} = 753 \\text{ W/K} = 753 \\text{ J/(s K)}$\n\nNow, we calculate $\\tau$:\n$$\n\\tau = \\frac{300000 \\text{ J/K}}{753 \\text{ J/(s K)}} \\approx 398.40637... \\text{ s}\n$$\nThe problem requires the time constant in minutes. We convert seconds to minutes by dividing by $60$:\n$$\n\\tau_{\\text{min}} = \\frac{398.40637...}{60} \\approx 6.640106... \\text{ min}\n$$\nRounding to four significant figures, the time constant is $\\tau = 6.640$ minutes.\n\nThe two required values are $T_{z,ss} = 25.43^\\circ\\text{C}$ and $\\tau = 6.640 \\text{ min}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 25.43 & 6.640 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While theoretical models like the RC network provide a powerful framework, their parameters are often unknown for a real building and must be estimated from performance data. This hands-on coding practice  guides you through this 'inverse problem' of system identification. You will write a program to fit a first-order model to a measured temperature response, estimate the key parameters, and map them back to the physical thermal resistance ($R$) and capacitance ($C$) of the zone.",
            "id": "4118274",
            "problem": "Consider a single-zone building idealized by a first-order Resistive-Capacitive (RC) model. The zone thermal energy balance is governed by the conservation of energy, which asserts that the rate of change of the internal energy equals the net heat flow into the zone. Let $T(t)$ denote the zone air temperature, $T_{\\mathrm{out}}$ the constant outdoor temperature, $P(t)$ the applied heating input power, $R$ the effective thermal resistance between the zone and outdoors, and $C$ the effective thermal capacitance of the zone air and interior elements. Assume well-mixed air, negligible internal gains other than the applied step input, and a single heat loss path characterized by $R$. The governing ordinary differential equation is\n$$\nC \\frac{dT(t)}{dt} = -\\frac{T(t) - T_{\\mathrm{out}}}{R} + P(t).\n$$\nUnder a step input $P(t) = P_{\\mathrm{step}}$ for $t \\ge 0$ and initial condition $T(0) = T_0$, the response is the canonical first-order exponential approach to a new steady state. The steady-state gain $K$ is defined as the asymptotic ratio of temperature rise to input power, and the time constant $\\tau$ is defined as the time for the response to reach the fraction $1 - e^{-1}$ of its final change under a step input. From first principles, relate the parameters of the physical model $R$ and $C$ to the step response descriptors $K$ and $\\tau$, and use this relationship to estimate $R$ and $C$ from measured step responses by fitting $K$ and $\\tau$.\n\nYour task is to write a complete, runnable program that, for each provided test case, fits a first-order RC step response to measured temperature time series data by estimating the step response parameters $K$ and $\\tau$ via nonlinear least squares, then maps them to $R$ and $C$ using the physically consistent RC interpretation. The fitting should account for a possible nonzero initial temperature offset relative to $T_{\\mathrm{out}}$.\n\nYou must use the following model for fitting the measured temperature $T_{\\mathrm{meas}}(t)$:\n$$\nT_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau} + K \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right),\n$$\nwhere $\\Delta T_0 = T_0 - T_{\\mathrm{out}}$ is an unknown initial offset to be estimated jointly with $K$ and $\\tau$. After estimating $K$ and $\\tau$, compute $R$ and $C$ consistent with the RC model. Express $R$ in $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$ and $C$ in $\\mathrm{kWh}\\cdot\\mathrm{K}^{-1}$, and round each to four decimal places.\n\nTest suite. For each case below, the measured data are generated from the model and a deterministic measurement disturbance $\\epsilon(t)$ added to emulate realistic measurements. All times are in hours, temperatures in degrees Celsius, and powers in kilowatts. For each case, the measured series is given by\n$$\nT_{\\mathrm{meas}}(t) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau_{\\mathrm{true}}} + K_{\\mathrm{true}} \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau_{\\mathrm{true}}}\\right) + \\epsilon(t),\n$$\nwith known $(\\tau_{\\mathrm{true}}, K_{\\mathrm{true}}, P_{\\mathrm{step}}, T_{\\mathrm{out}}, \\Delta T_0)$ and specified sample times $t$ and disturbance $\\epsilon(t)$:\n\n- Case A (happy path, moderate dynamics):\n  - $\\tau_{\\mathrm{true}} = 3$ h, $K_{\\mathrm{true}} = 1$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 2$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 10$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$.\n  - Sample times $t = \\{0, 0.5, 1, 1.5, 2, 3, 6\\}$ h.\n  - Disturbance $\\epsilon(t) = 0.05 \\sin\\left(\\pi t / \\tau_{\\mathrm{true}}\\right)$ $\\mathrm{K}$.\n\n- Case B (boundary, fast dynamics):\n  - $\\tau_{\\mathrm{true}} = 0.25$ h, $K_{\\mathrm{true}} = 0.8$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 1.5$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 15$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$.\n  - Sample times $t = \\{0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0\\}$ h.\n  - Disturbance $\\epsilon(t) = 0.02 \\cos\\left(3 t\\right)$ $\\mathrm{K}$.\n\n- Case C (edge, very slow dynamics with coarse sampling):\n  - $\\tau_{\\mathrm{true}} = 12$ h, $K_{\\mathrm{true}} = 1.2$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 3$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 5$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$.\n  - Sample times $t = \\{0, 2, 4, 8, 12, 24\\}$ h.\n  - Disturbance $\\epsilon(t) = 0.01 \\, t / 24$ $\\mathrm{K}$.\n\n- Case D (edge, nonzero initial offset):\n  - $\\tau_{\\mathrm{true}} = 3$ h, $K_{\\mathrm{true}} = 1$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 1.5$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 10$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 2$ $\\mathrm{K}$.\n  - Sample times $t = \\{0, 0.5, 1, 2, 3, 4, 6\\}$ h.\n  - Disturbance $\\epsilon(t) = -0.03 \\sin\\left(2 \\pi t / 6\\right)$ $\\mathrm{K}$.\n\nRequired outputs. For each case, estimate $K$ and $\\tau$ by fitting $T_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0)$ to $T_{\\mathrm{meas}}(t)$, then compute $R$ and $C$ using the physically consistent RC interpretation, and return the pair $[R, C]$ rounded to four decimals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the list entries are the two-element lists for each case, in the order A, B, C, D. For example, the output format must be like \"[[resA],[resB],[resC],[resD]]\" where each \"resX\" is of the form \"[R,C]\".",
            "solution": "The fundamental base is the conservation of energy applied to a lumped single-zone building model. Let $T(t)$ be the zone air temperature, $T_{\\mathrm{out}}$ the constant outdoor temperature, $P(t)$ the heating input power, $R$ the effective thermal resistance to ambient, and $C$ the effective thermal capacitance capturing the heat storage of air and building interior surfaces. Under standard assumptions (well-mixed zone air, single dominant heat loss path represented by $R$, no other dynamic heat sources), the energy balance is\n$$\nC \\frac{dT(t)}{dt} = \\dot{Q}_{\\mathrm{in}}(t) + \\dot{Q}_{\\mathrm{loss}}(t),\n$$\nwith $\\dot{Q}_{\\mathrm{in}}(t) = P(t)$ and $\\dot{Q}_{\\mathrm{loss}}(t) = -\\frac{T(t) - T_{\\mathrm{out}}}{R}$. This yields the first-order linear ordinary differential equation\n$$\nC \\frac{dT(t)}{dt} + \\frac{1}{R} \\left(T(t) - T_{\\mathrm{out}}\\right) = P(t).\n$$\nDefine the temperature deviation $\\Delta T(t) = T(t) - T_{\\mathrm{out}}$. Then\n$$\nC \\frac{d \\Delta T(t)}{dt} + \\frac{1}{R} \\Delta T(t) = P(t).\n$$\nFor a step input $P(t) = P_{\\mathrm{step}}$ for $t \\ge 0$ and initial deviation $\\Delta T(0) = \\Delta T_0$, the solution of this linear time-invariant system follows from standard methods for first-order linear differential equations (integrating factor or homogeneous and particular solution). The homogeneous solution is\n$$\n\\Delta T_{\\mathrm{hom}}(t) = \\Delta T_0 \\, e^{-t/\\tau},\n$$\nwhere the time constant is\n$$\n\\tau = R C.\n$$\nA particular solution for constant input is the constant steady-state deviation $\\Delta T_{\\mathrm{ss}}$ satisfying\n$$\n\\frac{1}{R} \\Delta T_{\\mathrm{ss}} = P_{\\mathrm{step}} \\quad \\Rightarrow \\quad \\Delta T_{\\mathrm{ss}} = R \\, P_{\\mathrm{step}}.\n$$\nTherefore the complete step response is\n$$\n\\Delta T(t) = \\Delta T_0 \\, e^{-t/\\tau} + R \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right).\n$$\nBy definition, the steady-state gain $K$ is the asymptotic ratio of the temperature rise to input power for a unit step, i.e.,\n$$\nK = \\lim_{t \\to \\infty} \\frac{\\Delta T(t)}{P_{\\mathrm{step}}} = R.\n$$\nThus the physically consistent mapping between the step response descriptors and the RC parameters is\n$$\nK = R, \\qquad \\tau = R C \\quad \\Rightarrow \\quad C = \\frac{\\tau}{R} = \\frac{\\tau}{K}.\n$$\nThese relationships do not rely on any \"shortcut\" but emerge directly from solving the governing equation.\n\nAlgorithmic design for fitting. Given measured temperatures $\\{T_{\\mathrm{meas}}(t_i)\\}$ at times $\\{t_i\\}$ for a known step $P_{\\mathrm{step}}$ and known $T_{\\mathrm{out}}$, we fit the parametric model\n$$\nT_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau} + K \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right)\n$$\nto the data using nonlinear least squares, estimating the parameters $(K, \\tau, \\Delta T_0)$. This choice captures both the initial offset and the exponential transition to the new steady state. To ensure physical realism, we constrain $K > 0$ and $\\tau > 0$ while allowing $\\Delta T_0$ to be any real value. Practical initial guesses are\n$$\nK_0 \\approx \\frac{T_{\\mathrm{meas}}(t_{\\max}) - T_{\\mathrm{out}}}{P_{\\mathrm{step}}}, \\quad \\tau_0 \\approx \\alpha \\, t_{\\max}, \\quad \\Delta T_{0,0} \\approx T_{\\mathrm{meas}}(0) - T_{\\mathrm{out}},\n$$\nwith a moderate fraction $\\alpha$ such as $\\alpha = 0.3$ and $t_{\\max} = \\max_i t_i$. We then solve the minimization\n$$\n\\min_{K > 0, \\,\\tau > 0, \\,\\Delta T_0 \\in \\mathbb{R}} \\sum_i \\left[T_{\\mathrm{meas}}(t_i) - T_{\\mathrm{model}}(t_i; K, \\tau, \\Delta T_0)\\right]^2,\n$$\nusing a trust-region reflective algorithm suitable for bound-constrained nonlinear least squares. Once $(K, \\tau)$ are estimated, we compute\n$$\nR = K, \\qquad C = \\frac{\\tau}{K}.\n$$\n\nTest suite synthesis. The measured data in each case are generated deterministically by the same physical model plus a specified disturbance term $\\epsilon(t)$:\n$$\nT_{\\mathrm{meas}}(t) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau_{\\mathrm{true}}} + K_{\\mathrm{true}} \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau_{\\mathrm{true}}}\\right) + \\epsilon(t).\n$$\n- Case A uses $\\tau_{\\mathrm{true}} = 3$, $K_{\\mathrm{true}} = 1$, $P_{\\mathrm{step}} = 2$, $T_{\\mathrm{out}} = 10$, $\\Delta T_0 = 0$, sample times $\\{0, 0.5, 1, 1.5, 2, 3, 6\\}$, and $\\epsilon(t) = 0.05 \\sin\\left(\\pi t / 3\\right)$.\n- Case B uses $\\tau_{\\mathrm{true}} = 0.25$, $K_{\\mathrm{true}} = 0.8$, $P_{\\mathrm{step}} = 1.5$, $T_{\\mathrm{out}} = 15$, $\\Delta T_0 = 0$, sample times $\\{0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0\\}$, and $\\epsilon(t) = 0.02 \\cos(3 t)$.\n- Case C uses $\\tau_{\\mathrm{true}} = 12$, $K_{\\mathrm{true}} = 1.2$, $P_{\\mathrm{step}} = 3$, $T_{\\mathrm{out}} = 5$, $\\Delta T_0 = 0$, sample times $\\{0, 2, 4, 8, 12, 24\\}$, and $\\epsilon(t) = 0.01 \\, t / 24$.\n- Case D uses $\\tau_{\\mathrm{true}} = 3$, $K_{\\mathrm{true}} = 1$, $P_{\\mathrm{step}} = 1.5$, $T_{\\mathrm{out}} = 10$, $\\Delta T_0 = 2$, sample times $\\{0, 0.5, 1, 2, 3, 4, 6\\}$, and $\\epsilon(t) = -0.03 \\sin\\left(2 \\pi t / 6\\right)$.\n\nExpected outcomes. Because the disturbance amplitudes are small and the model is correctly specified, the fitted $(K, \\tau)$ should be close to the true values, and thus the computed $(R, C)$ should be near $(1, 3)$ for Case A, near $(0.8, 0.3125)$ for Case B, near $(1.2, 10)$ for Case C, and near $(1, 3)$ for Case D, all in the respective units. The final program will implement this fitting for each case and print a single line with the list of $[R, C]$ pairs, rounded to four decimals, in the exact required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef model_temperature(t, K, tau, dT0, P_step, T_out):\n    \"\"\"\n    First-order RC step response model for zone temperature.\n    T(t) = T_out + dT0 * exp(-t/tau) + K * P_step * (1 - exp(-t/tau))\n    \"\"\"\n    return T_out + dT0 * np.exp(-t / tau) + K * P_step * (1.0 - np.exp(-t / tau))\n\ndef generate_measured_data(t, K_true, tau_true, dT0, P_step, T_out, noise_fn):\n    \"\"\"\n    Generate deterministic 'measured' temperature time series.\n    \"\"\"\n    clean = T_out + dT0 * np.exp(-t / tau_true) + K_true * P_step * (1.0 - np.exp(-t / tau_true))\n    noise = noise_fn(t)\n    return clean + noise\n\ndef fit_K_tau_dT0(t, T_meas, P_step, T_out):\n    \"\"\"\n    Fit the model T_model(t; K, tau, dT0) to measured data via nonlinear least squares.\n    Constrain K > 0 and tau > 0; dT0 is unconstrained.\n    \"\"\"\n    t = np.asarray(t, dtype=float)\n    T_meas = np.asarray(T_meas, dtype=float)\n    t_max = float(np.max(t)) if np.max(t) > 0 else 1.0\n\n    # Initial guesses\n    K0 = max(1e-6, (T_meas[-1] - T_out) / P_step)  # approximate steady gain\n    tau0 = max(1e-6, 0.3 * t_max)                  # moderate fraction of span\n    dT0_0 = T_meas[0] - T_out                      # initial offset\n\n    # Bounds: K > 0, tau > 0, dT0 free\n    lower_bounds = [1e-6, 1e-6, -np.inf]\n    upper_bounds = [np.inf, np.inf, np.inf]\n\n    # Define wrapper for curve_fit with fixed P_step and T_out\n    def f(t, K, tau, dT0):\n        return model_temperature(t, K, tau, dT0, P_step, T_out)\n\n    try:\n        popt, _ = curve_fit(\n            f, t, T_meas, p0=[K0, tau0, dT0_0],\n            bounds=(lower_bounds, upper_bounds),\n            method='trf', max_nfev=10000\n        )\n        K_est, tau_est, dT0_est = popt\n    except Exception:\n        # Fallback: use initial guesses if fitting fails\n        K_est, tau_est, dT0_est = K0, tau0, dT0_0\n\n    return float(K_est), float(tau_est), float(dT0_est)\n\ndef solve():\n    # Define deterministic noise functions for each case.\n    def noise_A(t):\n        tau_true = 3.0\n        return 0.05 * np.sin(np.pi * t / tau_true)\n\n    def noise_B(t):\n        return 0.02 * np.cos(3.0 * t)\n\n    def noise_C(t):\n        return 0.01 * (t / 24.0)\n\n    def noise_D(t):\n        return -0.03 * np.sin(2.0 * np.pi * t / 6.0)\n\n    # Test cases: list of dicts with parameters and time grid.\n    test_cases = [\n        # Case A\n        {\n            \"t\": np.array([0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 6.0], dtype=float),\n            \"K_true\": 1.0,\n            \"tau_true\": 3.0,\n            \"dT0\": 0.0,\n            \"P_step\": 2.0,\n            \"T_out\": 10.0,\n            \"noise_fn\": noise_A\n        },\n        # Case B\n        {\n            \"t\": np.array([0.0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0], dtype=float),\n            \"K_true\": 0.8,\n            \"tau_true\": 0.25,\n            \"dT0\": 0.0,\n            \"P_step\": 1.5,\n            \"T_out\": 15.0,\n            \"noise_fn\": noise_B\n        },\n        # Case C\n        {\n            \"t\": np.array([0.0, 2.0, 4.0, 8.0, 12.0, 24.0], dtype=float),\n            \"K_true\": 1.2,\n            \"tau_true\": 12.0,\n            \"dT0\": 0.0,\n            \"P_step\": 3.0,\n            \"T_out\": 5.0,\n            \"noise_fn\": noise_C\n        },\n        # Case D\n        {\n            \"t\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0, 6.0], dtype=float),\n            \"K_true\": 1.0,\n            \"tau_true\": 3.0,\n            \"dT0\": 2.0,\n            \"P_step\": 1.5,\n            \"T_out\": 10.0,\n            \"noise_fn\": noise_D\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        t = case[\"t\"]\n        K_true = case[\"K_true\"]\n        tau_true = case[\"tau_true\"]\n        dT0 = case[\"dT0\"]\n        P_step = case[\"P_step\"]\n        T_out = case[\"T_out\"]\n        noise_fn = case[\"noise_fn\"]\n\n        # Generate measured data\n        T_meas = generate_measured_data(t, K_true, tau_true, dT0, P_step, T_out, noise_fn)\n\n        # Fit parameters\n        K_est, tau_est, dT0_est = fit_K_tau_dT0(t, T_meas, P_step, T_out)\n\n        # Map to RC parameters\n        R_est = K_est                            # K = R\n        C_est = tau_est / R_est if R_est != 0 else np.nan  # tau = R*C\n\n        # Round to four decimals\n        R_out = round(R_est, 4)\n        C_out = round(C_est, 4)\n\n        results.append([R_out, C_out])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}