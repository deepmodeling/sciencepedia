{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the foundation of economic dispatch using the simplest case: linear generator costs. By solving this problem, you will apply the intuitive \"merit-order\" principle, where the cheapest generators are dispatched first. This practice is designed to connect this straightforward economic logic to the formal Karush–Kuhn–Tucker (KKT) conditions that underpin all constrained optimization in power systems .",
            "id": "4086783",
            "problem": "Consider a single-bus economic dispatch problem for $3$ thermal generators supplying a fixed inelastic demand of $D=100$ $\\text{MW}$ over a short interval in which ramping is negligible. Assume no transmission constraints, no losses, and no reserve requirements. Generator $i \\in \\{1,2,3\\}$ produces power $P_i$ and has a linear variable operating cost $C_i(P_i)=c_i P_i$ with cost coefficients $c=(20,25,30)$ $/MWh. The operating limits are $P^{\\min}=(0,0,0)$ $\\text{MW}$ and $P^{\\max}=(50,60,40)$ $\\text{MW}$. \n\nStarting from first principles of constrained optimization and convex analysis, formulate the primal optimization problem that minimizes total variable cost subject to the power balance and box constraints. Construct the Lagrangian, derive the Karush–Kuhn–Tucker (KKT) conditions, and use these conditions to determine which generators are at their bounds at optimality and which (if any) operate strictly within their bounds. Then compute the unique optimal dispatch $(P_1^{\\star},P_2^{\\star},P_3^{\\star})$ that minimizes total cost while meeting demand and respecting limits.\n\nExpress the final dispatch as the ordered triple $(P_1^{\\star},P_2^{\\star},P_3^{\\star})$ in $\\text{MW}$. Because the data are exact, report exact values (no rounding).",
            "solution": "The goal is to find the power output $P_i$ for each generator $i \\in \\{1, 2, 3\\}$ that minimizes the total generation cost while satisfying the system demand and individual generator operating limits.\n\nFirst, we formulate the primal optimization problem. The objective is to minimize the total cost, which is the sum of the individual generator costs:\n$$ \\min_{P_1, P_2, P_3} \\quad C_{total} = \\sum_{i=1}^{3} C_i(P_i) = 20 P_1 + 25 P_2 + 30 P_3 $$\nThis minimization is subject to two types of constraints:\n1.  Power balance constraint: The sum of power generated must equal the total demand.\n    $$ \\sum_{i=1}^{3} P_i = P_1 + P_2 + P_3 = 100 $$\n2.  Generator operating limits (box constraints): Each generator's output must be within its minimum and maximum bounds.\n    $$ P_i^{\\min} \\le P_i \\le P_i^{\\max}, \\quad \\forall i \\in \\{1, 2, 3\\} $$\n    Specifically:\n    $$ 0 \\le P_1 \\le 50 $$\n    $$ 0 \\le P_2 \\le 60 $$\n    $$ 0 \\le P_3 \\le 40 $$\n\nThis is a convex optimization problem (a Linear Program), so the Karush–Kuhn–Tucker (KKT) conditions are necessary and sufficient for optimality. To derive these conditions, we construct the Lagrangian function $\\mathcal{L}$. We associate a Lagrange multiplier $\\lambda$ with the equality constraint and non-negative multipliers $\\underline{\\mu}_i$ and $\\overline{\\mu}_i$ with the lower and upper bound inequality constraints, respectively. The inequality constraints are written as $P_i^{\\min} - P_i \\le 0$ and $P_i - P_i^{\\max} \\le 0$.\n\nThe Lagrangian is:\n$$ \\mathcal{L}(P_i, \\lambda, \\underline{\\mu}_i, \\overline{\\mu}_i) = \\sum_{i=1}^{3} c_i P_i - \\lambda \\left(\\sum_{i=1}^{3} P_i - D\\right) + \\sum_{i=1}^{3} \\underline{\\mu}_i (P_i^{\\min} - P_i) + \\sum_{i=1}^{3} \\overline{\\mu}_i (P_i - P_i^{\\max}) $$\n\nThe KKT conditions for an optimal solution $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star})$ are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to each decision variable $P_i$ must be zero.\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial P_i} = c_i - \\lambda - \\underline{\\mu}_i + \\overline{\\mu}_i = 0 \\quad \\forall i \\in \\{1, 2, 3\\} $$\n    This can be rewritten as $c_i - \\lambda = \\underline{\\mu}_i - \\overline{\\mu}_i$.\n\n2.  **Primal Feasibility**: The optimal solution must satisfy all original constraints.\n    $$ \\sum_{i=1}^{3} P_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le P_i^{\\star} \\le P_i^{\\max} $$\n\n3.  **Dual Feasibility**: The multipliers for the inequality constraints must be non-negative.\n    $$ \\underline{\\mu}_i \\ge 0 $$\n    $$ \\overline{\\mu}_i \\ge 0 $$\n\n4.  **Complementary Slackness**: The product of an inequality constraint multiplier and the constraint itself must be zero. This means a multiplier can only be positive if the corresponding constraint is active (i.e., holds with equality).\n    $$ \\underline{\\mu}_i (P_i^{\\min} - P_i^{\\star}) = 0 $$\n    $$ \\overline{\\mu}_i (P_i^{\\star} - P_i^{\\max}) = 0 $$\n\nFrom the KKT conditions, we can analyze the state of each generator at optimality:\n- If a generator operates strictly within its bounds ($P_i^{\\min} < P_i^{\\star} < P_i^{\\max}$), then by complementary slackness, both $\\underline{\\mu}_i = 0$ and $\\overline{\\mu}_i = 0$. The stationarity condition then simplifies to $c_i - \\lambda = 0$, or $\\lambda = c_i$. Such a generator is called a \"marginal unit,\" and its marginal cost sets the system marginal price, $\\lambda$.\n- If a generator is at its lower bound ($P_i^{\\star} = P_i^{\\min}$), then $\\overline{\\mu}_i$ must be $0$. The stationarity condition becomes $c_i - \\lambda = \\underline{\\mu}_i$. Since $\\underline{\\mu}_i \\ge 0$, this implies $c_i \\ge \\lambda$. A generator is at its minimum output if its marginal cost is greater than or equal to the system marginal price.\n- If a generator is at its upper bound ($P_i^{\\star} = P_i^{\\max}$), then $\\underline{\\mu}_i$ must be $0$. The stationarity condition becomes $c_i - \\lambda = - \\overline{\\mu}_i$. Since $\\overline{\\mu}_i \\ge 0$, this implies $c_i \\le \\lambda$. A generator is at its maximum output if its marginal cost is less than or equal to the system marginal price.\n\nThis analysis leads to the \"merit order\" dispatch strategy: load generators in increasing order of their marginal cost until the demand is met.\nThe cost coefficients are $c_1 = 20$, $c_2 = 25$, and $c_3 = 30$ $/MWh. The merit order is Generator 1, then Generator 2, then Generator 3. The demand is $D=100$ MW.\n\n1.  Load the cheapest generator, Generator 1 ($c_1=20$), up to its maximum capacity.\n    $P_1 = P_1^{\\max} = 50$ MW.\n    The remaining demand is $D_{rem} = 100 - 50 = 50$ MW.\n\n2.  Load the next cheapest generator, Generator 2 ($c_2=25$), to meet the remaining demand.\n    The remaining demand is $50$ MW, which is less than Generator 2's maximum capacity of $P_2^{\\max}=60$ MW.\n    $P_2 = 50$ MW.\n    The remaining demand is now $50 - 50 = 0$ MW.\n\n3.  The demand is fully met. The most expensive generator, Generator 3 ($c_3=30$), is not needed.\n    $P_3 = 0$ MW. This is consistent with its minimum limit, $P_3^{\\min}=0$.\n\nOur candidate optimal solution is $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star}) = (50, 50, 0)$. We must now verify this solution against the KKT conditions.\n\n- **Primal Feasibility Check**:\n  - Power balance: $50 + 50 + 0 = 100$ MW. This matches the demand $D=100$. (Satisfied)\n  - Generator limits:\n    - $P_1^{\\star} = 50$, which is $P_1^{\\max}$. ($0 \\le 50 \\le 50$) (Satisfied)\n    - $P_2^{\\star} = 50$, which is strictly between $P_2^{\\min}=0$ and $P_2^{\\max}=60$. ($0 < 50 < 60$) (Satisfied)\n    - $P_3^{\\star} = 0$, which is $P_3^{\\min}$. ($0 \\le 0 \\le 40$) (Satisfied)\n\n- **KKT Analysis based on the Dispatch**:\n  - Generator 2 is the marginal unit ($0 < P_2^{\\star} < 60$), so its cost sets the system marginal price: $\\lambda = c_2 = 25$ $/MWh. For Generator 2, complementary slackness requires $\\underline{\\mu}_2 = 0$ and $\\overline{\\mu}_2 = 0$. The stationarity condition $c_2 - \\lambda - \\underline{\\mu}_2 + \\overline{\\mu}_2 = 25 - 25 - 0 + 0 = 0$ is satisfied.\n\n  - Generator 1 is at its upper bound ($P_1^{\\star} = P_1^{\\max} = 50$). Our KKT analysis requires $c_1 \\le \\lambda$. Here, $20 \\le 25$, which is true. Complementary slackness requires $\\underline{\\mu}_1 = 0$. The stationarity condition is $c_1 - \\lambda - \\underline{\\mu}_1 + \\overline{\\mu}_1 = 0$, which gives $20 - 25 - 0 + \\overline{\\mu}_1 = 0$, so $\\overline{\\mu}_1 = 5$. Since $\\overline{\\mu}_1 = 5 \\ge 0$, dual feasibility is satisfied.\n\n  - Generator 3 is at its lower bound ($P_3^{\\star} = P_3^{\\min} = 0$). Our KKT analysis requires $c_3 \\ge \\lambda$. Here, $30 \\ge 25$, which is true. Complementary slackness requires $\\overline{\\mu}_3 = 0$. The stationarity condition is $c_3 - \\lambda - \\underline{\\mu}_3 + \\overline{\\mu}_3 = 0$, which gives $30 - 25 - \\underline{\\mu}_3 + 0 = 0$, so $\\underline{\\mu}_3 = 5$. Since $\\underline{\\mu}_3 = 5 \\ge 0$, dual feasibility is satisfied.\n\nAll KKT conditions are satisfied for the dispatch $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star}) = (50, 50, 0)$ with the multipliers $\\lambda = 25$, $\\underline{\\mu} = (0, 0, 5)$, and $\\overline{\\mu} = (5, 0, 0)$. Since the problem is convex, this solution is the unique global optimum.\n\nThe optimal dispatch is:\n- Generator 1: $P_1^{\\star} = 50$ MW (at its maximum limit)\n- Generator 2: $P_2^{\\star} = 50$ MW (operating within its limits, the marginal unit)\n- Generator 3: $P_3^{\\star} = 0$ MW (at its minimum limit)\n\nThe final answer is the ordered triple $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n50 & 50 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building upon the linear model, this practice introduces more realistic, strictly convex quadratic cost functions. Here, the simple merit-order approach is replaced by the fundamental principle of equal incremental costs for all dispatchable units. This exercise challenges you to handle a common real-world scenario where a generator reaches its maximum output limit, demonstrating how to formally identify and verify such binding constraints using the KKT conditions and the concept of complementary slackness .",
            "id": "4086798",
            "problem": "A thermal generation system has three dispatchable units with strictly convex quadratic production costs. For unit $i \\in \\{1,2,3\\}$, the cost is $C_i(P_i) = \\alpha_i P_i^2 + \\beta_i P_i + \\gamma_i$ in dollars per hour, where $P_i$ is the power output in megawatts. The system demand is $D = 120$, and each unit has a power bound $0 \\leq P_i \\leq \\overline{P}_i$. The data are:\n- Unit $1$: $\\alpha_1 = 0.05$, $\\beta_1 = 14$, $\\gamma_1 = 100$, $\\overline{P}_1 = 50$.\n- Unit $2$: $\\alpha_2 = 0.10$, $\\beta_2 = 10$, $\\gamma_2 = 120$, $\\overline{P}_2 = 35$.\n- Unit $3$: $\\alpha_3 = 0.08$, $\\beta_3 = 12$, $\\gamma_3 = 60$, $\\overline{P}_3 = 70$.\n\nUsing first principles of convex optimization and Lagrangian duality, formulate the economic dispatch as a convex program. Derive the Karush–Kuhn–Tucker (KKT) optimality conditions from this formulation, and compute the unique primal-dual optimal pair $\\{P_1^\\star, P_2^\\star, P_3^\\star, \\lambda^\\star\\}$, where $\\lambda^\\star$ is the optimal Lagrange multiplier associated with the power balance constraint. Identify which inequality constraint is active at optimality and verify complementary slackness by explicitly computing the associated Lagrange multiplier for the active bound.\n\nReport the final numerical values as exact reduced fractions where appropriate. Express the value of the Lagrange multiplier in United States dollars per megawatt-hour ($/MWh), and each dispatch in megawatts (MW). Provide your final answer as a single row matrix in the order $\\left(\\lambda^\\star, P_1^\\star, P_2^\\star, P_3^\\star\\right)$. Do not include units in the final answer box. No rounding is required.",
            "solution": "The economic dispatch seeks to minimize the total production cost subject to meeting demand and respecting unit capacity limits. The problem is grounded in the following principles:\n- The total cost is separable and strictly convex in each $P_i$ because $\\alpha_i > 0$ for all $i$.\n- The feasible set defined by linear equality and inequality constraints is convex.\n- Strong duality holds for strictly convex programs with affine constraints and a strictly feasible point (Slater’s condition), ensuring that the Karush–Kuhn–Tucker (KKT) conditions are necessary and sufficient for optimality.\n\nFormulation:\nMinimize $\\sum_{i=1}^{3} C_i(P_i)$ subject to the constraints\n- $\\sum_{i=1}^{3} P_i = D$,\n- $0 \\leq P_i \\leq \\overline{P}_i$ for $i \\in \\{1,2,3\\}$.\n\nWith the given data, the problem is:\nMinimize\n$$\nC_1(P_1) + C_2(P_2) + C_3(P_3) = 0.05 P_1^2 + 14 P_1 + 100 + 0.10 P_2^2 + 10 P_2 + 120 + 0.08 P_3^2 + 12 P_3 + 60\n$$\nsubject to\n$$\nP_1 + P_2 + P_3 = 120, \\quad 0 \\leq P_1 \\leq 50, \\quad 0 \\leq P_2 \\leq 35, \\quad 0 \\leq P_3 \\leq 70.\n$$\n\nLagrangian and KKT conditions:\nIntroduce the Lagrange multiplier $\\lambda$ for the equality constraint, and nonnegative multipliers $\\mu_i^{-}$ and $\\mu_i^{+}$ for the lower and upper bounds, respectively. The Lagrangian is\n$$\n\\mathcal{L}(P_1,P_2,P_3,\\lambda,\\mu^{-},\\mu^{+}) = \\sum_{i=1}^{3} C_i(P_i) + \\lambda \\left(D - \\sum_{i=1}^{3} P_i \\right) + \\sum_{i=1}^{3} \\mu_i^{-} (0 - P_i) + \\sum_{i=1}^{3} \\mu_i^{+} (P_i - \\overline{P}_i).\n$$\nThe Karush–Kuhn–Tucker (KKT) conditions are:\n1. Primal feasibility: $P_1 + P_2 + P_3 = 120$, and $0 \\leq P_i \\leq \\overline{P}_i$.\n2. Dual feasibility: $\\mu_i^{-} \\geq 0$, $\\mu_i^{+} \\geq 0$.\n3. Stationarity:\n$$\n\\frac{\\partial C_i}{\\partial P_i}(P_i) - \\lambda - \\mu_i^{-} + \\mu_i^{+} = 0, \\quad i \\in \\{1,2,3\\}.\n$$\nGiven $C_i(P_i) = \\alpha_i P_i^2 + \\beta_i P_i + \\gamma_i$, the marginal costs are\n$$\n\\frac{\\partial C_1}{\\partial P_1} = 2 \\cdot 0.05 P_1 + 14 = 0.10 P_1 + 14, \\quad \\frac{\\partial C_2}{\\partial P_2} = 2 \\cdot 0.10 P_2 + 10 = 0.20 P_2 + 10, \\quad \\frac{\\partial C_3}{\\partial P_3} = 2 \\cdot 0.08 P_3 + 12 = 0.16 P_3 + 12.\n$$\n4. Complementary slackness:\n$$\n\\mu_i^{-} P_i = 0, \\quad \\mu_i^{+} (P_i - \\overline{P}_i) = 0, \\quad i \\in \\{1,2,3\\}.\n$$\n\nDetermine the active set:\nFirst, ignore inequality bounds and equalize marginal costs:\nSuppose $\\mu_i^{-}=\\mu_i^{+}=0$ for all $i$. Then stationarity gives $0.10 P_1 + 14 = \\lambda$, $0.20 P_2 + 10 = \\lambda$, $0.16 P_3 + 12 = \\lambda$, i.e.,\n$$\nP_1 = 10 \\lambda - 140, \\quad P_2 = 5 \\lambda - 50, \\quad P_3 = 6.25 \\lambda - 75.\n$$\nSum to the demand:\n$$\n(10 + 5 + 6.25) \\lambda - (140 + 50 + 75) = 120 \\;\\Rightarrow\\; 21.25 \\lambda - 265 = 120 \\;\\Rightarrow\\; \\lambda = \\frac{385}{21.25} = \\frac{308}{17}.\n$$\nThe corresponding $P_2$ is\n$$\nP_2 = 5 \\cdot \\frac{308}{17} - 50 = \\frac{1540}{17} - 50 = \\frac{690}{17} \\approx 40.588,\n$$\nwhich violates the bound $P_2 \\leq 35$. Therefore, at the optimum, the upper bound on unit $2$ is active: $P_2^\\star = \\overline{P}_2 = 35$ with $\\mu_2^{+} > 0$.\n\nSolve with the active constraint $P_2 = 35$:\nFor $i \\in \\{1,3\\}$, if their bounds are not active, then $\\mu_i^{-}=\\mu_i^{+}=0$ and stationarity yields\n$$\n0.10 P_1 + 14 = \\lambda, \\quad 0.16 P_3 + 12 = \\lambda.\n$$\nThus\n$$\nP_1 = 10 \\lambda - 140, \\quad P_3 = 6.25 \\lambda - 75.\n$$\nEnforce power balance with $P_2 = 35$:\n$$\nP_1 + P_3 + 35 = 120 \\;\\Rightarrow\\; (10 \\lambda - 140) + (6.25 \\lambda - 75) + 35 = 120.\n$$\nThis simplifies to\n$$\n16.25 \\lambda - 180 = 120 \\;\\Rightarrow\\; 16.25 \\lambda = 300 \\;\\Rightarrow\\; \\lambda^\\star = \\frac{300}{16.25} = \\frac{1200}{65} = \\frac{240}{13}.\n$$\nThen\n$$\nP_1^\\star = 10 \\lambda^\\star - 140 = 10 \\cdot \\frac{240}{13} - 140 = \\frac{2400}{13} - \\frac{1820}{13} = \\frac{580}{13},\n$$\n$$\nP_3^\\star = 6.25 \\lambda^\\star - 75 = \\frac{25}{4} \\cdot \\frac{240}{13} - 75 = \\frac{1500}{13} - \\frac{975}{13} = \\frac{525}{13}.\n$$\nCheck bounds: $P_1^\\star = \\frac{580}{13} \\approx 44.615 \\in (0,50)$, $P_3^\\star = \\frac{525}{13} \\approx 40.385 \\in (0,70)$; hence their bounds are inactive, consistent with $\\mu_1^{-}=\\mu_1^{+}=\\mu_3^{-}=\\mu_3^{+}=0$.\n\nComplementary slackness verification for the active bound:\nFor unit $2$ at $P_2^\\star = \\overline{P}_2 = 35$, the stationarity condition is\n$$\n(0.20 P_2^\\star + 10) - \\lambda^\\star - \\mu_2^{-} + \\mu_2^{+} = 0.\n$$\nSince the lower bound is not active at $P_2^\\star=35>0$, we have $\\mu_2^{-}=0$. Therefore,\n$$\n\\mu_2^{+} = \\lambda^\\star - (0.20 P_2^\\star + 10) = \\frac{240}{13} - (0.20 \\cdot 35 + 10) = \\frac{240}{13} - 17 = \\frac{19}{13} \\geq 0.\n$$\nComplementary slackness holds: $\\mu_2^{+} (P_2^\\star - \\overline{P}_2) = \\frac{19}{13} \\cdot 0 = 0$; for units $1$ and $3$, $\\mu_i^{\\pm}=0$ and $P_i^\\star$ are strictly within bounds, so $\\mu_i^{-} P_i^\\star = 0$ and $\\mu_i^{+} (P_i^\\star - \\overline{P}_i) = 0$ are satisfied.\n\nMarginal cost equalization for nonbinding units:\nCheck that $0.10 P_1^\\star + 14 = \\frac{0.10 \\cdot 580}{13} + 14 = \\frac{58}{13} + \\frac{182}{13} = \\frac{240}{13} = \\lambda^\\star$, and $0.16 P_3^\\star + 12 = \\frac{0.16 \\cdot 525}{13} + 12 = \\frac{84}{13} + \\frac{156}{13} = \\frac{240}{13} = \\lambda^\\star$, as required by stationarity when bounds are inactive.\n\nUniqueness:\nBecause the objective is strictly convex and the feasible set is nonempty and convex, the KKT solution is unique.\n\nThus, the unique optimal primal-dual pair is\n$$\n\\lambda^\\star = \\frac{240}{13}, \\quad P_1^\\star = \\frac{580}{13}, \\quad P_2^\\star = 35, \\quad P_3^\\star = \\frac{525}{13},\n$$\nwith the unit $2$ upper bound active and associated multiplier $\\mu_2^{+} = \\frac{19}{13}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{240}{13} & \\frac{580}{13} & 35 & \\frac{525}{13}\\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice moves beyond the single-bus abstraction to a more comprehensive network model using the Direct Current Optimal Power Flow (DC-OPF) formulation. You will see how transmission line limits can create congestion, preventing the system from simply dispatching the cheapest generators. This exercise introduces the critical concept of Locational Marginal Prices (LMPs), which arise as the economic signal of congestion and are essential for understanding modern electricity markets .",
            "id": "4086771",
            "problem": "You must write a complete, runnable program that solves a Direct Current Optimal Power Flow (DC OPF) for a three-bus network with linear generator costs, generator capacity limits, nodal power balance constraints, and a single transmission line flow limit. The problem is posed in purely mathematical terms and must be solved using first-principles modeling of DC power flow. The physical power quantities must be in megawatts (MW), angles in radians, and prices in dollars per megawatt-hour ($/MWh).\n\nFundamental base and definitions:\n- Under the DC power flow approximation, the active power flow on line $(i,j)$ is given by $P_{ij} = b_{ij} \\left( \\theta_i - \\theta_j \\right)$, where $\\theta_i$ and $\\theta_j$ are bus voltage angles in radians, and $b_{ij}$ is the line susceptance scaled to the system base.\n- The nodal power balance at bus $i$ is given by $p_i = \\sum_{j} b_{ij} \\left( \\theta_i - \\theta_j \\right)$, where $p_i$ is the net injection at bus $i$, equal to generation minus demand, i.e., $p_i = P_i - D_i$.\n- Kirchhoff's Current Law at each bus ensures the sum of incident line flows equals the net injection.\n- Economic dispatch seeks to minimize total generation cost subject to the physical constraints above.\n\nNetwork specification:\n- Three buses labeled $1$, $2$, and $3$.\n- Lines: $(1,2)$, $(1,3)$, $(2,3)$.\n- Reactances in per unit on a $100$ megavolt-ampere (MVA) base: $x_{12} = 0.25$, $x_{13} = 0.25$, $x_{23} = 0.50$. With voltage magnitude near $1$ per unit and using the base power, the effective susceptances in MW/rad are $b_{12} = \\frac{1}{x_{12}} \\cdot 100 = 400$, $b_{13} = \\frac{1}{x_{13}} \\cdot 100 = 400$, $b_{23} = \\frac{1}{x_{23}} \\cdot 100 = 200$.\n- The bus susceptance matrix $B_{\\text{bus}}$ in MW/rad is:\n$$\nB_{\\text{bus}} =\n\\begin{bmatrix}\n800 & -400 & -400 \\\\\n-400 & 600 & -200 \\\\\n-400 & -200 & 600\n\\end{bmatrix}.\n$$\n- The reference (slack) bus is bus $1$, with angle fixed at $\\theta_1 = 0$ radians.\n\nGenerators:\n- One generator per bus with linear cost functions $C_i(P_i) = c_i P_i$ where $c = [10, 12, 30]$ in $/MWh for buses $1$, $2$, and $3$, respectively.\n- Generator capacity limits: $P^{\\max} = [100, 100, 50]$ MW and $P^{\\min} = [0, 0, 0]$ MW.\n\nConstraints:\n- Nodal power balances (for $i = 1,2,3$): $P_i - D_i = \\sum_j b_{ij} \\left( \\theta_i - \\theta_j \\right)$.\n- Slack bus angle: $\\theta_1 = 0$ radians.\n- Line $(1,2)$ has a thermal flow limit $\\left| P_{12} \\right| \\leq F_{12}^{\\max}$ with $F_{12}^{\\max} = 40$ MW. Other lines have no active flow limits.\n- Generator bounds: $0 \\leq P_i \\leq P_i^{\\max}$.\n\nObjective:\n- Minimize the total cost $C_{\\text{total}} = \\sum_{i=1}^{3} c_i P_i$.\n\nOutputs required for each test case:\n- Optimal generation vector $[P_1, P_2, P_3]$ in MW.\n- Line flows $[P_{12}, P_{13}, P_{23}]$ in MW, computed as $P_{12} = b_{12}(\\theta_1 - \\theta_2)$, $P_{13} = b_{13}(\\theta_1 - \\theta_3)$, $P_{23} = b_{23}(\\theta_2 - \\theta_3)$.\n- Locational Marginal Prices (LMPs) $[\\lambda_1, \\lambda_2, \\lambda_3]$ in $/MWh, where $\\lambda_i$ corresponds to the shadow price of the nodal power balance at bus $i$.\n\nAll angles must be in radians. All powers must be in MW. All prices must be in $/MWh. No other units are permitted in the output.\n\nFormulation to implement:\n- Decision variables are $[P_1, P_2, P_3, \\theta_2, \\theta_3]$ with $\\theta_1 = 0$ fixed.\n- Equality constraints derived from nodal balances (substitute $\\theta_1 = 0$):\n$$\n\\begin{aligned}\nP_1 - D_1 + b_{12} \\theta_2 + b_{13} \\theta_3 &= 0, \\\\\nP_2 - D_2 - (b_{12} + b_{23}) \\theta_2 + b_{23} \\theta_3 &= 0, \\\\\nP_3 - D_3 + b_{23} \\theta_2 - (b_{13} + b_{23}) \\theta_3 &= 0.\n\\end{aligned}\n$$\n- Inequality constraints for the single line limit on $(1,2)$:\n$$\n-b_{12} \\theta_2 \\le F_{12}^{\\max}, \\quad b_{12} \\theta_2 \\le F_{12}^{\\max}.\n$$\n- Generator bounds: $0 \\le P_1 \\le 100$, $0 \\le P_2 \\le 100$, $0 \\le P_3 \\le 50$. The angle variables $\\theta_2, \\theta_3$ are unconstrained except as implied by equality and line constraints.\n\nTest suite:\n- Case $1$: demands $D = [50, 50, 50]$ MW.\n- Case $2$: demands $D = [30, 120, 30]$ MW.\n- Case $3$: demands $D = [90, 110, 50]$ MW.\n\nYour program should solve the DC OPF for each test case, extract the optimal $[P_1, P_2, P_3]$, compute $[P_{12}, P_{13}, P_{23}]$, and obtain the nodal shadow prices $[\\lambda_1, \\lambda_2, \\lambda_3]$. The final output must be a single line containing the results as a comma-separated list of three inner lists, with no spaces, in the exact format:\n\"[[P1_case1,P2_case1,P3_case1,P12_case1,P13_case1,P23_case1,lambda1_case1,lambda2_case1,lambda3_case1],[P1_case2,P2_case2,P3_case2,P12_case2,P13_case2,P23_case2,lambda1_case2,lambda2_case2,lambda3_case2],[P1_case3,P3_case3,P3_case3,P12_case3,P13_case3,P23_case3,lambda1_case3,lambda2_case3,lambda3_case3]]\"\nFor avoidance of ambiguity, your program should produce exactly a single line of output containing a top-level list of three comma-separated inner lists, each inner list containing nine numbers, with no spaces anywhere in the printed string. All values must be represented as standard decimal numbers.",
            "solution": "This problem requires solving a DC Optimal Power Flow (DC-OPF), which is a Linear Program (LP). We first formulate the problem in the standard LP form and then implement it in Python using `scipy.optimize.linprog`.\n\n### LP Formulation\n\nThe LP is formulated as:\n$$\n\\begin{align*}\n\\min_{x} \\quad & c^T x \\\\\n\\text{subject to} \\quad & A_{eq} x = b_{eq} \\\\\n& lb \\leq x \\leq ub\n\\end{align*}\n$$\n\n**1. Decision Variables ($x$)**\nThe vector of decision variables $x$ includes the generator active power outputs and the non-reference bus voltage angles:\n$$x = [P_1, P_2, P_3, \\theta_2, \\theta_3]^T$$\n\n**2. Objective Function ($c^T x$)**\nThe objective is to minimize the total generation cost, $C_{\\text{total}} = 10 P_1 + 12 P_2 + 30 P_3$. The bus angles do not have a cost. Therefore, the cost vector $c$ is:\n$$c = [10, 12, 30, 0, 0]^T$$\n\n**3. Equality Constraints ($A_{eq} x = b_{eq}$)**\nThe nodal power balance equations form the equality constraints. With $\\theta_1=0$, the equations are rearranged to fit the standard form $A_{eq} x = b_{eq}$:\n$$P_1 - D_1 + b_{12}\\theta_2 + b_{13}\\theta_3 = 0 \\implies 1 \\cdot P_1 + 0 \\cdot P_2 + 0 \\cdot P_3 + 400 \\cdot \\theta_2 + 400 \\cdot \\theta_3 = D_1$$\n$$P_2 - D_2 - (b_{12}+b_{23})\\theta_2 + b_{23}\\theta_3 = 0 \\implies 0 \\cdot P_1 + 1 \\cdot P_2 + 0 \\cdot P_3 - 600 \\cdot \\theta_2 + 200 \\cdot \\theta_3 = D_2$$\n$$P_3 - D_3 + b_{23}\\theta_2 - (b_{13}+b_{23})\\theta_3 = 0 \\implies 0 \\cdot P_1 + 0 \\cdot P_2 + 1 \\cdot P_3 + 200 \\cdot \\theta_2 - 600 \\cdot \\theta_3 = D_3$$\nThis gives the equality constraint matrix $A_{eq}$ and vector $b_{eq}$ (which depends on demand $D$):\n$$\nA_{eq} = \\begin{bmatrix}\n1 & 0 & 0 & 400 & 400 \\\\\n0 & 1 & 0 & -600 & 200 \\\\\n0 & 0 & 1 & 200 & -600\n\\end{bmatrix}, \\quad\nb_{eq} = \\begin{bmatrix} D_1 \\\\ D_2 \\\\ D_3 \\end{bmatrix}\n$$\n\n**4. Variable Bounds ($lb \\leq x \\leq ub$)**\nThe bounds on the variables are derived from the generator capacity limits and the transmission line flow limit.\n- Generator limits: $0 \\leq P_1 \\leq 100$, $0 \\leq P_2 \\leq 100$, $0 \\leq P_3 \\leq 50$.\n- Transmission line limit: The flow on line $(1,2)$ is $P_{12} = b_{12}(\\theta_1 - \\theta_2) = -400\\theta_2$. The constraint is $|P_{12}| \\leq 40$, which means $|-400\\theta_2| \\leq 40$, or $|\\theta_2| \\leq 40/400 = 0.1$. So, $-0.1 \\leq \\theta_2 \\leq 0.1$.\n- The angle $\\theta_3$ is unbounded.\nThese constraints can be expressed as lower and upper bounds on the decision variables:\n$$\nlb = [0, 0, 0, -0.1, -\\infty]^T, \\quad ub = [100, 100, 50, 0.1, +\\infty]^T\n$$\nThe problem is solved for each test case by substituting the corresponding demand vector $D$ into $b_{eq}$. The following Python code implements this solution.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of DC Optimal Power Flow (DC-OPF) problems for a 3-bus network.\n\n    The problem is formulated as a Linear Program (LP) and solved using scipy.optimize.linprog.\n    The decision variables are x = [P1, P2, P3, theta2, theta3].\n    \"\"\"\n    \n    # ----------------------------------------------------------------------\n    # Define constants and problem parameters based on the problem statement\n    # ----------------------------------------------------------------------\n    \n    # Generator cost coefficients ($/MWh)\n    c_gen = np.array([10.0, 12.0, 30.0])\n    \n    # Generator min/max power output (MW)\n    P_min = np.array([0.0, 0.0, 0.0])\n    P_max = np.array([100.0, 100.0, 50.0])\n    \n    # Line susceptances (MW/rad)\n    b12 = 400.0\n    b13 = 400.0\n    b23 = 200.0\n    \n    # Line flow limit for line (1,2) (MW)\n    F12_max = 40.0\n    \n    # Test cases: Demand vectors D = [D1, D2, D3] (MW)\n    test_cases = [\n        np.array([50.0, 50.0, 50.0]),\n        np.array([30.0, 120.0, 30.0]),\n        np.array([90.0, 110.0, 50.0]),\n    ]\n\n    # ----------------------------------------------------------------------\n    # Construct the LP matrices and vectors\n    # ----------------------------------------------------------------------\n    \n    # Objective function vector c for x = [P1, P2, P3, theta2, theta3]\n    c = np.array([c_gen[0], c_gen[1], c_gen[2], 0.0, 0.0])\n    \n    # Equality constraints: A_eq * x = b_eq (Nodal power balance equations)\n    A_eq = np.array([\n        [1, 0, 0, b12, b13],\n        [0, 1, 0, -(b12 + b23), b23],\n        [0, 0, 1, b23, -(b13 + b23)]\n    ])\n    \n    # Bounds for variables: lb = x = ub\n    p_bounds = list(zip(P_min, P_max))\n    theta2_limit = F12_max / b12\n    theta_bounds = [(-theta2_limit, theta2_limit), (None, None)]\n    bounds = p_bounds + theta_bounds\n\n    results = []\n    \n    # ----------------------------------------------------------------------\n    # Solve the LP for each test case\n    # ----------------------------------------------------------------------\n    for D in test_cases:\n        b_eq = D\n        res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        \n        P1_opt, P2_opt, P3_opt, theta2_opt, theta3_opt = res.x\n        P_opt = [P1_opt, P2_opt, P3_opt]\n        \n        P12_flow = b12 * (0 - theta2_opt)\n        P13_flow = b13 * (0 - theta3_opt)\n        P23_flow = b23 * (theta2_opt - theta3_opt)\n        flows = [P12_flow, P13_flow, P23_flow]\n        \n        LMPs = res.eqlin.marginals\n        \n        # Round results to a reasonable precision for consistent output\n        case_result = [round(v, 5) for v in (P_opt + flows + list(LMPs))]\n        results.append(case_result)\n\n    # ----------------------------------------------------------------------\n    # Format and print the final output exactly as specified\n    # ----------------------------------------------------------------------\n    case_strings = [','.join(map(str, case)) for case in results]\n    output_string = f\"[[{case_strings[0]}],[{case_strings[1]}],[{case_strings[2]}]]\"\n    print(output_string)\n\nsolve()\n```",
            "answer": "[[100.0,50.0,0.0,12.5,37.5,12.5,12.0,12.0,12.0],[70.0,100.0,10.0,40.0,20.0,-10.0,10.0,14.0,30.0],[100.0,100.0,50.0,7.5,2.5,-2.5,52.5,50.0,70.0]]"
        }
    ]
}