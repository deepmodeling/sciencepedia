## 引言
[经济调度](@entry_id:143387)（Economic Dispatch, ED）是[电力系统运行](@entry_id:1130078)与规划中的一个基础且至关重要的问题。其核心任务是在确保[电力](@entry_id:264587)供需平衡和满足所有运行约束的前提下，以最低的经济成本来分配各个发电单元的功率输出。一个高效的调度方案不仅能为社会节约巨额的燃料成本，更是保障[电网安全](@entry_id:1130043)稳定、促进能源[资源优化](@entry_id:172440)配置的基石。然而，经典的经济调度模型往往是高度理想化的，与充满复杂物理约束、动态特性和不确定性的现代[电力](@entry_id:264587)系统现实存在着显著的差距。

本文旨在系统性地弥合这一理论与实践之间的鸿沟。我们将带领读者从[经济调度](@entry_id:143387)的第一性原理出发，逐步构建一个全面而深入的知识体系。通过学习本文，您将不仅理解基础模型的数学之美，更能掌握如何将其扩展和应用于解决现实世界中的复杂调度挑战。

- 在“**原理与机制**”一章中，我们将深入剖析经典[经济调度问题](@entry_id:195771)的[凸优化](@entry_id:137441)框架，阐明其核心的KKT[最优性条件](@entry_id:634091)和“等增量成本准则”，并揭示其与[市场均衡](@entry_id:138207)的深刻联系。我们还将探讨输电损耗和[发电机](@entry_id:268282)非凸特性如何使问题变得更加复杂。
- 接着，在“**应用与跨学科连接**”一章中，我们将展示经济调度思想如何演进为功能更强大的工具，如考虑了网络物理学的最优潮流（OPF）、包含动态约束的储能与水火协调调度、以及确保系统可靠性的安全约束经济调度（SCED）。此外，我们还将探讨其在环境政策评估和新兴技术整合中的应用。
- 最后，在“**动手实践**”部分，我们提供了精心设计的编程练习，让您有机会亲手实现从基础经济调度到考虑网络约束的最优潮流等模型，将理论知识转化为解决实际问题的能力。

通过这一结构化的学习路径，本文将为您构建一个从理论基础到高级应用的完整[经济调度](@entry_id:143387)知识框架。

## 原理与机制

本章旨在深入探讨[经济调度](@entry_id:143387)（Economic Dispatch, ED）问题的核心数学原理与基本机制。我们将从最基础的模型出发，逐步引入更复杂的现实因素，从而系统性地构建对[经济调度](@entry_id:143387)的全面理解。我们将首先建立理想化的[凸优化](@entry_id:137441)模型，阐释其[最优性条件](@entry_id:634091)和经济学内涵，然后探讨输电损耗、机组运行的非凸特性等实际问题如何改变该模型及其求解。

### 经典[经济调度问题](@entry_id:195771)：[凸优化](@entry_id:137441)框架

经济调度的核心任务是在满足系统负荷需求和所有运行约束的前提下，以最低的成本分配各[发电机](@entry_id:268282)的有功功率输出。为构建其数学模型，我们首先考虑一个理想化的“铜板”系统，即忽略输电网络拓扑和损耗，将所有[发电机](@entry_id:268282)和负荷都连接在一个单一母线上。

#### 基本数学公式

在任何时刻，[电力](@entry_id:264587)系统都必须维持功率平衡，这是能量守恒定律在[稳态](@entry_id:139253)[电力](@entry_id:264587)系统中的体现。对于一个单母线系统，这意味着所有[发电机](@entry_id:268282)的总功率输出必须精确地等于该母线上的总负荷需求。假设系统中有 $N$ 台[发电机](@entry_id:268282)，其有功功率输出分别为 $P_1, P_2, \dots, P_N$，系统总负荷为一个给定的非弹性需求 $D$，那么功率平衡约束可以写作：

$$
\sum_{i=1}^{N} P_i = D
$$

该方程是[经济调度问题](@entry_id:195771)的基石。从更基本的[电路理论](@entry_id:189041)出发，该平衡方程是[基尔霍夫电流定律](@entry_id:270632)（Kirchhoff's Current Law, KCL）的直接推论。在单母线交流模型中，所有注入母线的电流相量之和为零。通过[复功率](@entry_id:1122734)的定义 $S = V I^{\ast}$，可以证明所有注入母线的[复功率](@entry_id:1122734)之和也必须为零。取其实部，便得到了有功功率的[平衡方程](@entry_id:172166) 。

除了满足功率平衡，每台[发电机](@entry_id:268282) $i$ 的运行还受到其物理能力的限制，其出力必须维持在最小技术出力 $P_i^{\min}$ 和最大出力 $P_i^{\max}$ 之间。因此，我们有[发电机](@entry_id:268282)容量约束：

$$
P_i^{\min} \le P_i \le P_i^{\max}, \quad \forall i \in \{1, \dots, N\}
$$

[经济调度](@entry_id:143387)的目标是最小化系统总的发电成本。假设每台[发电机](@entry_id:268282) $i$ 的成本是其出力 $P_i$ 的函数，记为 $C_i(P_i)$，那么总成本就是所有[发电机](@entry_id:268282)成本之和。综合以上要素，我们可以构建经典的[经济调度问题](@entry_id:195771)的 primal problem（原始问题）：

$$
\begin{align*}
\text{minimize} \quad  \sum_{i=1}^N C_i(P_i) \\
\text{subject to} \quad  \sum_{i=1}^N P_i = D \\
 P_i^{\min} \le P_i \le P_i^{\max}, \quad i=1, \dots, N
\end{align*}
$$

这里，决策变量是各[发电机](@entry_id:268282)的出力向量 $P = (P_1, \dots, P_N)$。

#### 发电成本函数

成本函数 $C_i(P_i)$ 的形式对问题的性质至关重要。在工程实践中，最常用的两种模型是二次函数和[分段线性函数](@entry_id:273766)。

- **二次成本函数**：通常，[发电机](@entry_id:268282)的燃料成本或[热耗率曲线](@entry_id:1125981)可以通过一个凸二次函数很好地近似：
  $$
  C_i(P_i) = a_i P_i^2 + b_i P_i + c_i
  $$
  其中，$a_i, b_i, c_i$ 是该[发电机](@entry_id:268282)的成本系数。为了保证成本函数的凸性（即边际成本递增），我们要求 $a_i > 0$ 。$c_i$ 通常代表与机组运行相关的固定成本，但在调度决策中不起作用，因为它不随 $P_i$ 变化。

- **[分段线性](@entry_id:201467)成本函数**：在[电力市场](@entry_id:1124241)中，发电商通常以“报价块”（offer blocks）的形式向市场提交其供应能力和价格。例如，[发电机](@entry_id:268282) $i$ 可能提供 $K_i$ 个报价块，每个块 $(k)$ 包含一定的容量 $\Delta_{ik}$ 和一个对应的价格 $\alpha_{ik}$。这等效于一个[分段线性](@entry_id:201467)的成本函数。为将其纳入优化模型，我们可以将每个[发电机](@entry_id:268282)的出力 $P_i$ 分解为各报价块的贡献之和 $P_i = \sum_{k=1}^{K_i} x_{ik}$，其中 $x_{ik}$ 是在第 $k$ 个报价块上的出力，满足 $0 \le x_{ik} \le \Delta_{ik}$。总成本则表示为：
  $$
  \min \sum_{i=1}^{N} \sum_{k=1}^{K_i} \alpha_{ik} x_{ik}
  $$
  如果报价块的价格是按顺序非递减的，即 $\alpha_{i1} \le \alpha_{i2} \le \dots \le \alpha_{iK_i}$，那么这个成本函数就是凸的。这种模型将[经济调度问题](@entry_id:195771)转化为一个[线性规划](@entry_id:138188)（Linear Programming, LP）问题 。

#### [最优性条件](@entry_id:634091)与求解

对于一个具有凸成本函数（如上述两种）的[经济调度问题](@entry_id:195771)，它是一个**[凸优化](@entry_id:137441)问题**。这是因为[目标函数](@entry_id:267263)是凸的，并且由线性等式和不等式构成的可行域也是一个[凸集](@entry_id:155617) 。这一优良特性保证了问题的局部最优解就是[全局最优解](@entry_id:175747)。

为了找到这个最优解，我们利用[拉格朗日乘子法](@entry_id:176596)。对于二次成本函数的情况，我们可以定义**增量成本**（Incremental Cost, IC），也称为边际成本（Marginal Cost, MC），即成本函数对出力的导数：

$$
\lambda_i(P_i) := \frac{dC_i(P_i)}{dP_i} = 2a_i P_i + b_i
$$

在不考虑[发电机](@entry_id:268282)容量约束的理想情况下，[最优调度](@entry_id:1129178)的充要条件是所有运行的[发电机](@entry_id:268282)具有相同的增量成本。这个共同的增量成本值，我们记为 $\lambda$，它正是功率平衡约束所对应的[拉格朗日乘子](@entry_id:142696)。

**等增量成本准则 (Equal Incremental Cost Principle):**
在最优解中，对于所有未达到其出力上、下限的[发电机](@entry_id:268282)（即 $P_i^{\min}  P_i  P_i^{\max}$），它们的增量成本必须相等：
$$
\lambda_1(P_1^*) = \lambda_2(P_2^*) = \dots = \lambda_N(P_N^*) = \lambda^*
$$

这个准则具有直观的经济学解释：如果两台[发电机](@entry_id:268282)的边际成本不同，例如 $\lambda_i  \lambda_j$，那么我们可以将[发电机](@entry_id:268282) $j$ 的出力减少一个微小的量 $\Delta P$，同时将[发电机](@entry_id:268282) $i$ 的出力增加相同的量 $\Delta P$。这样，总出力不变（满足功率平衡），但总成本会下降，说明当前调度方案并非最优。只有当所有可调机组的边际成本都相等时，才无法通过这种微调来降低成本，此时系统达到经济最优 。

考虑[发电机](@entry_id:268282)容量约束后，完整的 [Karush-Kuhn-Tucker (KKT) 条件](@entry_id:176491)给出了更普适的描述：
- 如果 $P_i^{\min}  P_i^*  P_i^{\max}$，则 $\lambda_i(P_i^*) = \lambda^*$。
- 如果 $P_i^* = P_i^{\max}$（达到上限），则 $\lambda_i(P_i^*) \le \lambda^*$。
- 如果 $P_i^* = P_i^{\min}$（达到下限），则 $\lambda_i(P_i^*) \ge \lambda^*$。

这意味着，成本较低的[发电机](@entry_id:268282)（在给定出力下边际成本较低）应优先调度，直到其边际成本上升到与其他机组相同，或者达到其出力上限。反之，成本较高的[发电机](@entry_id:268282)则承担较少的负荷。

#### 问题的[适定性](@entry_id:148590)与解的保证

将[经济调度问题](@entry_id:195771)置于严格的数学框架下，我们可以确信其解的性质 。
- **解的存在性**：根据魏尔斯特拉斯[极值定理](@entry_id:142794)（Extreme Value Theorem），一个定义在非空[紧集](@entry_id:147575)（在[欧氏空间](@entry_id:138052)中即[有界闭集](@entry_id:145098)）上的[连续函数](@entry_id:137361)必能取得其最小值。经济调度的可行域由[线性约束](@entry_id:636966)定义，是闭合的；同时，由于[发电机](@entry_id:268282)容量限制，它也是有界的。因此，只要[可行域](@entry_id:136622)非空（即 $\sum P_i^{\min} \le D \le \sum P_i^{\max}$），且成本函数是连续的，最优解就保证存在 。
- **KKT 条件的充分性**：由于[经济调度问题](@entry_id:195771)是凸的，只要满足一个约束想定（constraint qualification），例如[斯莱特条件](@entry_id:176608)（Slater's condition），强对偶性就成立。[斯莱特条件](@entry_id:176608)在本问题中很容易满足，因为它只需要存在一个严格满足[不等式约束](@entry_id:176084)的可行点。强对偶性保证了 KKT 条件不仅是局部最优的必要条件，也是全局最优的**充分条件**。这意味着，任何满足 KKT 条件的调度方案都一定是[全局最优解](@entry_id:175747) 。
- **[解的唯一性](@entry_id:143619)**：如果所有[发电机](@entry_id:268282)的成本函数 $C_i(P_i)$ 都是**严格凸**的（例如，二次成本函数中 $a_i  0$），那么总成本函数 $\sum C_i(P_i)$ 也是严格凸的。一个严格[凸函数](@entry_id:143075)在[凸集](@entry_id:155617)上的最小值（如果存在）是唯一的。因此，在这种情况下，最优的出力分配方案 $(P_1^*, \dots, P_N^*)$ 是唯一的 。

### 经济学解释与市场等价性

[经济调度](@entry_id:143387)模型中的[对偶变量](@entry_id:143282)（即拉格朗日乘子）具有深刻的经济学含义，它们是连接集中式优化与分散式市场决策的桥梁。

#### [拉格朗日乘子](@entry_id:142696)的经济学内涵

我们可以为[经济调度问题](@entry_id:195771)构建一个完整的[拉格朗日函数](@entry_id:174593)，为每个约束引入一个乘子 ：
$$
\mathcal{L}(P, \lambda, \mu^-, \mu^+) = \sum_{i=1}^n C_i(P_i) + \lambda \left(D - \sum_{i=1}^n P_i \right) + \sum_{i=1}^n \mu_i^+ (P_i - P_i^{\max}) + \sum_{i=1}^n \mu_i^- (P_i^{\min} - P_i)
$$
其中，$\lambda$ 对应功率平衡约束，$\mu_i^+ \ge 0$ 和 $\mu_i^- \ge 0$ 分别对应[发电机](@entry_id:268282) $i$ 的出力上、下限约束。在最优解处，这些乘子代表了对应约束的**影子价格**（shadow price）：

- **系统边际电价 (System Marginal Price, SMP)**：乘子 $\lambda^*$ 是系统为满足额外一单位负荷需求所需要付出的最小成本增量，即 $\lambda^* = \frac{dV(D)}{dD}$，其中 $V(D)$ 是最优总成本。因此，$\lambda^*$ 代表了该时刻的**边际电价**。这与我们之前得到的“等增量成本”是一致的。

- **容量稀缺租金 (Scarcity Rent)**：乘子 $\mu_i^{+*}$ 代表了当[发电机](@entry_id:268282) $i$ 的出力上限被放宽一单位时，系统总成本能够节约的金额。当[发电机](@entry_id:268282) $i$ 运行在出力上限时（$P_i^*=P_i^{\max}$），$\mu_i^{+*}$ 可能为正，这部分价值被称为容量的“稀缺租金”，因为它反映了该[发电机](@entry_id:268282)容量不足对系统造成的额外成本。类似地，$\mu_i^{-*}$ 代表了收紧最小出力约束所带来的成本增加。

#### 市场等价性

等增量成本准则不仅是集中调度的优化条件，也是完全竞争[电力市场](@entry_id:1124241)的[均衡条件](@entry_id:136628)。可以证明，一个由系统运营商（System Operator）设定统一[市场出清价格](@entry_id:144985)（market-clearing price）为 $\lambda^*$ 的单母线电力市场，其结果与集中式经济调度的最优解是等价的 。

在这个市场中，每个作为价格接受者（price-taker）的[发电机](@entry_id:268282) $i$ 会独立地选择其出力 $P_i$ 以最大化自身利润 $\pi_i = \lambda^* P_i - C_i(P_i)$。利润最大化的[一阶条件](@entry_id:140702)是 $\frac{d\pi_i}{dP_i} = \lambda^* - \frac{dC_i}{dP_i} = 0$，即 $\lambda_i(P_i) = \lambda^*$。这正是集中调度中的等增量成本准则。因此，通过设定正确的市场价格 $\lambda^*$，系统运营商可以引导自利的发电商做出与社会成本最小化目标一致的决策。对于[分段线性](@entry_id:201467)报价模型，这一等价性同样成立，$\lambda^*$ 对应于满足需求的最后一个（或边际）报价块的价格 。

### 扩展与非理想特性

经典的[凸优化](@entry_id:137441)经济调度模型是一个强大的理论工具，但在实际应用中，我们必须考虑一些更复杂的因素，如输电损耗和[发电机](@entry_id:268282)的非凸运行特性。

#### 输电损耗

在真实的[电力](@entry_id:264587)网络中，电流流经输电线路时会因电阻而产生功率损耗（焦耳热）。此时，功率平衡方程需要修正为：

$$
\sum_{i=1}^{N} P_i = D + P_L
$$

其中 $P_L$ 是总的输电损耗。$P_L$ 本身是所有[发电机](@entry_id:268282)出力和负荷的复杂[非线性](@entry_id:637147)函数。在经典的[经济调度](@entry_id:143387)中，一个常用的方法是使用**B-系数法**（或称 Kron 损耗公式）来近似 $P_L$ 。该方法基于在一个参考运行点附近的线性化假设，将总损耗表示为[发电机](@entry_id:268282)出力的二次函数：

$$
P_L = \sum_{i=1}^N \sum_{j=1}^N P_i B_{ij} P_j + \sum_{i=1}^N B_{0i} P_i + B_{00}
$$

其中，$B_{ij}$, $B_{0i}$, 和 $B_{00}$ 是根据[网络拓扑](@entry_id:141407)和参数计算出的常数“损耗系数”。这个二次型的损耗公式可以被整合到经济调度的[目标函数](@entry_id:267263)或约束中。引入损耗后，[最优性条件](@entry_id:634091)变为修正后的等增量成本准则，其中每台[发电机](@entry_id:268282)的增量成本需要乘以一个与其对系统总损耗的边际贡献相关的**惩罚因子**（penalty factor）。

#### 运行特性的非凸性

尽管我们通常假设成本函数是凸的，但[发电机](@entry_id:268282)的实际运行特性可能引入非[凸性](@entry_id:138568)，这使得问题变得复杂得多。在深入探讨这些非[凸性](@entry_id:138568)之前，有必要区分[经济调度](@entry_id:143387)（ED）和**[机组组合](@entry_id:1133606)**（Unit Commitment, UC）。UC问题决定哪些[发电机](@entry_id:268282)在哪些时段应该开启或关闭，它本质上是一个大规模的混合整数优化问题，涉及启停成本、最小持续运行/停机时间、[爬坡率限制](@entry_id:1130536)等[跨期约束](@entry_id:1126649)。而ED则是在给定开机组合下，对机组出力进行的短期（例如5分钟到1小时）优化。因此，ED通常被视为UC问题的一个子问题 。

即使在ED的框架内，也存在重要的非凸性来源：

- **阀点效应 (Valve-Point Effects)**：对于大型蒸汽轮机，当蒸汽阀门逐个打开时，其[热耗率曲线](@entry_id:1125981)（成本曲线的基础）会叠加一系列波纹。这通常被模型化为在凸的二次成本函数上增加一个绝对值化的正弦项，例如：
  $$
  C_i(P_i) = (a_i P_i^2 + b_i P_i + c_i) + \left| e_i \sin(f_i(P_i^{\min} - P_i)) \right|
  $$
  这个附加项使得成本函数既**非凸**（可能出现多个局部最小值）又**非光滑**（在某些点不可微）。

- **禁止运行区 (Prohibited Operating Zones, POZs)**：由于物理原因（如设备振动），[发电机](@entry_id:268282)可能被禁止在某些出力区间内稳定运行。这使得[发电机](@entry_id:268282)的可行出力域变成多个不相交区间的并集，从而导致整个优化问题的[可行域](@entry_id:136622)成为非[凸集](@entry_id:155617) 。

这些非凸性从根本上改变了问题的性质。一个[非凸优化](@entry_id:634396)问题可能拥有多个局部最优解，而[KKT条件](@entry_id:185881)仅能保证找到局部平稳点，但不能保证其为全局最优解。例如，在一个包含阀点效应的两台机组系统中，我们可能会发现多个满足等增量成本准则的调度点，它们都是局部最优解。要找到真正的全局最优解，必须对所有这些局部最优解以及边界解的成本进行比较 。

对于这些非凸问题，求解方法也更为复杂。例如，对于由POZs引起的非凸可行域，可以通过引入[二进制变量](@entry_id:162761)来选择[发电机](@entry_id:268282)运行在哪一个可行区间，从而将问题构建为一个**混合整数二次规划**（Mixed-Integer Quadratic Program, MIQP）问题 。对于阀点效应等导致的非凸[目标函数](@entry_id:267263)，则需要使用[全局优化](@entry_id:634460)算法或专门的[启发式算法](@entry_id:176797)。此外，对于非凸问题，[拉格朗日对偶](@entry_id:638042)理论中的强对偶性通常不再成立，可能存在**[对偶间隙](@entry_id:173383)**（duality gap），这意味着基于对偶的分解方法只能提供原问题最优成本的一个下界 。