{
    "hands_on_practices": [
        {
            "introduction": "节点导纳矩阵（Y-bus）是电力系统分析的基石。本练习将引导您从第一性原理出发，将基尔霍夫电流定律应用于输电线路采用标准π型等效电路表示的网络，从而构建该矩阵。掌握这一过程对于为任何进一步分析建立精确的网络模型至关重要。",
            "id": "4107717",
            "problem": "考虑一个处于稳态的3母线交流(AC)输电网络，其中每条线路均由一个$\\pi$型等效电路表示。直接从基尔霍夫电流定律(KCL)出发，通过在每个母线处强制节点电流平衡来构建节点导纳矩阵(Y-bus)。母线$m$和$n$之间的每条输电线路都含有一个位于串联支路的串联导纳$y_{mn}$和一个总并联电纳$B^{\\mathrm{sh}}_{mn}$，该电纳被平均分配，使得一个值为$\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}$的并联导纳在线路的每个终端母线处接地。此外，每个母线$m$可能还有一个直接连接到它的接地并联导纳$y^{\\mathrm{bus}}_{m}$。所有导纳均以公共基准下的标幺值(pu)给出。\n\n网络数据如下：\n- 线路$\\{1,2\\}$：串联导纳 $y_{12} = 0.10 - \\mathrm{j}\\,0.50$，总并联电纳 $B^{\\mathrm{sh}}_{12} = 0.20$。\n- 线路$\\{2,3\\}$：串联导纳 $y_{23} = 0.08 - \\mathrm{j}\\,0.40$，总并联电纳 $B^{\\mathrm{sh}}_{23} = 0.16$。\n- 线路$\\{1,3\\}$：串联导纳 $y_{13} = 0.06 - \\mathrm{j}\\,0.30$，总并联电纳 $B^{\\mathrm{sh}}_{13} = 0.12$。\n- 母线并联导纳：$y^{\\mathrm{bus}}_{1} = \\mathrm{j}\\,0.02$, $y^{\\mathrm{bus}}_{2} = \\mathrm{j}\\,0.01$, $y^{\\mathrm{bus}}_{3} = \\mathrm{j}\\,0.00$。\n\n在这些假设下，通过KCL和$\\pi$型等效模型推导非对角线和对角线元素，构建完整的Y-bus矩阵。然后，为了提供一个单一的标量值，请报告母线1和2之间的非对角线导纳的幅值$\\left|Y_{12}\\right|$。\n\n将最终报告的幅值四舍五入到四位有效数字，并以标幺值(pu)表示。",
            "solution": "基本出发点是基尔霍夫电流定律(KCL)，该定律指出离开任一节点的电流代数和为零。在交流稳态下，使用正弦相量，母线$m$处的KCL可以表示为母线电压和导纳的线性关系\n$$\nI_{m} = \\sum_{n \\in \\mathcal{N}} Y_{mn} V_{n},\n$$\n其中，$I_{m}$是母线$m$处的净注入电流，$V_{n}$是母线$n$处的电压，$Y_{mn}$是节点导纳矩阵(Y-bus)的元素。我们的任务是根据网络元件构建$Y_{mn}$。\n\n对于用$\\pi$型等效电路建模的母线$m$和$n$之间的线路，其串联支路导纳为$y_{mn}$，两端的并联支路导纳为$\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}$。从母线$m$到母线$n$的串联支路上的电流为$y_{mn}\\,(V_{m} - V_{n})$。该线路贡献的从母线$m$到地的并联电流为$\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}\\,V_{m}$。如果母线$m$处存在额外的接地并联导纳$y^{\\mathrm{bus}}_{m}$，其电流为$y^{\\mathrm{bus}}_{m}\\,V_{m}$。\n\n在母线$m$处应用KCL，将所有通过串联支路和并联支路离开节点的电流相加，并使其等于净注入电流，可得\n$$\nI_{m} = \\sum_{n \\in \\mathcal{N}_{m}} y_{mn}\\,(V_{m} - V_{n}) \\;+\\; \\sum_{n \\in \\mathcal{N}_{m}} \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}\\,V_{m} \\;+\\; y^{\\mathrm{bus}}_{m} V_{m},\n$$\n其中$\\mathcal{N}_{m}$是连接到母线$m$的母线集合。按母线电压重新组合各项，得到Y-bus的结构：\n- 对于$m \\neq n$的非对角线元素：\n$$\nY_{mn} = -\\,y_{mn}.\n$$\n- 对角线元素：\n$$\nY_{mm} = \\sum_{n \\in \\mathcal{N}_{m}} y_{mn} \\;+\\; \\sum_{n \\in \\mathcal{N}_{m}} \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2} \\;+\\; y^{\\mathrm{bus}}_{m}.\n$$\n\n现在我们使用所提供的数据计算每个元素。首先，计算每条线路两端的半值并联导纳：\n- 对于线路$\\{1,2\\}$：两端各有 $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} = \\mathrm{j}\\,\\frac{0.20}{2} = \\mathrm{j}\\,0.10$。\n- 对于线路$\\{2,3\\}$：两端各有 $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} = \\mathrm{j}\\,\\frac{0.16}{2} = \\mathrm{j}\\,0.08$。\n- 对于线路$\\{1,3\\}$：两端各有 $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} = \\mathrm{j}\\,\\frac{0.12}{2} = \\mathrm{j}\\,0.06$。\n\n对于非对角线元素，使用$Y_{mn} = -y_{mn}$：\n- $Y_{12} = -\\,y_{12} = -\\,(0.10 - \\mathrm{j}\\,0.50) = -\\,0.10 + \\mathrm{j}\\,0.50$。\n- $Y_{23} = -\\,y_{23} = -\\,(0.08 - \\mathrm{j}\\,0.40) = -\\,0.08 + \\mathrm{j}\\,0.40$。\n- $Y_{13} = -\\,y_{13} = -\\,(0.06 - \\mathrm{j}\\,0.30) = -\\,0.06 + \\mathrm{j}\\,0.30$。\n\n对于对角线元素，将连接到该母线的所有串联导纳、所有来自相连线路的本地半值并联导纳以及接地母线并联导纳相加：\n- 母线1与母线2和3相连，因此\n$$\nY_{11} = y_{12} + y_{13} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} + y^{\\mathrm{bus}}_{1}.\n$$\n代入数值：\n$Y_{11} = (0.10 - \\mathrm{j}\\,0.50) + (0.06 - \\mathrm{j}\\,0.30) + \\mathrm{j}\\,0.10 + \\mathrm{j}\\,0.06 + \\mathrm{j}\\,0.02 = 0.16 - \\mathrm{j}\\,0.62$。\n\n- 母线2与母线1和3相连，因此\n$$\nY_{22} = y_{12} + y_{23} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} + y^{\\mathrm{bus}}_{2}.\n$$\n代入数值：\n$Y_{22} = (0.10 - \\mathrm{j}\\,0.50) + (0.08 - \\mathrm{j}\\,0.40) + \\mathrm{j}\\,0.10 + \\mathrm{j}\\,0.08 + \\mathrm{j}\\,0.01 = 0.18 - \\mathrm{j}\\,0.71$。\n\n- 母线3与母线1和2相连，因此\n$$\nY_{33} = y_{13} + y_{23} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} + y^{\\mathrm{bus}}_{3}.\n$$\n代入数值：\n$Y_{33} = (0.06 - \\mathrm{j}\\,0.30) + (0.08 - \\mathrm{j}\\,0.40) + \\mathrm{j}\\,0.06 + \\mathrm{j}\\,0.08 + \\mathrm{j}\\,0.00 = 0.14 - \\mathrm{j}\\,0.56$。\n\n因此，构建的Y-bus元素为：\n$Y_{11} = 0.16 - \\mathrm{j}\\,0.62,\\quad Y_{22} = 0.18 - \\mathrm{j}\\,0.71,\\quad Y_{33} = 0.14 - \\mathrm{j}\\,0.56$\n$Y_{12} = -\\,0.10 + \\mathrm{j}\\,0.50,\\quad Y_{13} = -\\,0.06 + \\mathrm{j}\\,0.30,\\quad Y_{23} = -\\,0.08 + \\mathrm{j}\\,0.40$\n并具有对称性$Y_{mn} = Y_{nm}$。\n\n最后，计算所要求的标量幅值$\\left|Y_{12}\\right|$。对于复数$a + \\mathrm{j}\\,b$，其幅值为$\\sqrt{a^{2} + b^{2}}$。此处，$Y_{12} = -\\,0.10 + \\mathrm{j}\\,0.50$，所以\n$$\n\\left|Y_{12}\\right| = \\sqrt{(-\\,0.10)^{2} + (0.50)^{2}} = \\sqrt{0.01 + 0.25} = \\sqrt{0.26}.\n$$\n计算平方根：\n$$\n\\sqrt{0.26} \\approx 0.509901951.\n$$\n四舍五入到四位有效数字，幅值为$0.5099$标幺值(pu)。",
            "answer": "$$\\boxed{0.5099}$$"
        },
        {
            "introduction": "源于基尔霍夫电流定律的功率平衡方程本质上是非线性的。本练习将深入探讨牛顿-拉夫逊法，这是求解这些交流潮流方程的工业标准算法。您将通过实现单次迭代，重点掌握推导和构建雅可比矩阵这一关键任务，从而深入了解系统的灵敏度。",
            "id": "4107692",
            "problem": "给定一个三母线交流电力网络，该网络使用基于基尔霍夫电流定律(KCL)的节点方程进行建模，以电压直角坐标和标幺值表示。母线1是平衡节点，具有固定的复电压$V_1 = 1 + \\mathrm{j}\\,0$(标幺值)。母线2和3是恒定功率(PQ)节点，具有指定的复功率净注入$S_k = P_k + \\mathrm{j}\\,Q_k$(发电功率减去负荷功率)。未知状态向量是PQ节点电压的实部和虚部，$x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$，其中$V_k = V_{kr} + \\mathrm{j}\\,V_{ki}$。\n\n基本原理：\n- 基尔霍夫电流定律(KCL)：在每个节点，离开节点的电流代数和等于净电流注入，使用节点导纳矩阵紧凑表示为$\\sum_{j} Y_{kj} V_j = I_k$，其中$Y$是复值节点导纳矩阵，$V$是复母线电压向量，$I_k$是节点$k$处的复电流注入。\n- 节点复功率与电流之间的关系：$S_k = V_k I_k^\\ast$，因此对于给定的指定复功率注入$S_k$，相应的电流注入为$I_k = \\dfrac{S_k^\\ast}{V_k^\\ast}$。\n\nPQ节点$k \\in \\{2,3\\}$处的非线性节点电流不匹配定义为\n$$\ng_k(V) = \\sum_{j=1}^{3} Y_{kj} V_j - \\frac{S_k^\\ast}{V_k^\\ast},\n$$\n实值残差向量为\n$$\nF(x) = \\big[\\operatorname{Re}(g_2),\\ \\operatorname{Im}(g_2),\\ \\operatorname{Re}(g_3),\\ \\operatorname{Im}(g_3)\\big]^\\top.\n$$\n单次牛顿-拉夫逊迭代通过组合基于KCL导数构建的雅可比矩阵$J(x) = \\frac{\\partial F}{\\partial x}$并求解\n$$\nJ(x)\\,\\Delta x = -F(x),\n$$\n来计算状态更新量$\\Delta x = [\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]^\\top$。\n\n网络数据（所有测试共享）：该网络具有串联支路，其阻抗（标幺值）为$z_{12} = 0.02 + \\mathrm{j}\\,0.06$、$z_{13} = 0.08 + \\mathrm{j}\\,0.24$、$z_{23} = 0.06 + \\mathrm{j}\\,0.18$，并且没有并联元件。线路导纳为$y_{12} = 1/z_{12}$、$y_{13} = 1/z_{13}$、$y_{23} = 1/z_{23}$。节点导纳矩阵$Y$通过经过充分测试的规则构建：对于每个导纳为$y_{mn}$的支路$(m,n)$，将$y_{mn}$加到$Y_{mm}$和$Y_{nn}$上，并将$-y_{mn}$加到$Y_{mn}$和$Y_{nm}$上。所有量均为标幺值（无量纲）。\n\n你的程序必须：\n- 根据给定的支路阻抗构建节点导纳矩阵$Y$。\n- 对于每个测试用例，使用上述定义组合$F(x)$和雅可比矩阵$J(x)$，将$V_1$视为已知常数，并且仅对$V_{2r}, V_{2i}, V_{3r}, V_{3i}$求导。\n- 求解线性系统$J(x)\\,\\Delta x = -F(x)$，以获得单次迭代的牛顿-拉夫逊状态更新向量。\n- 将更新向量的分量报告为四舍五入到$8$位小数的浮点数。\n\n测试套件：\n- 用例1（一般负荷）：$S_2 = -0.9 - \\mathrm{j}\\,0.3$，$S_3 = -0.5 - \\mathrm{j}\\,0.2$，初始猜测值$V_2^{(0)} = 1.0 + \\mathrm{j}\\,0.0$，$V_3^{(0)} = 1.0 + \\mathrm{j}\\,0.0$。\n- 用例2（混合负荷/发电和非平凡初始猜测值）：$S_2 = -1.2 - \\mathrm{j}\\,0.5$，$S_3 = 0.3 - \\mathrm{j}\\,0.1$，初始猜测值$V_2^{(0)} = 0.95 - \\mathrm{j}\\,0.05$，$V_3^{(0)} = 0.97 + \\mathrm{j}\\,0.02$。\n- 用例3（轻载边缘情况）：$S_2 = 0.0 + \\mathrm{j}\\,0.0$，$S_3 = -0.1 - \\mathrm{j}\\,0.05$，初始猜测值$V_2^{(0)} = 1.02 + \\mathrm{j}\\,0.01$，$V_3^{(0)} = 0.98 - \\mathrm{j}\\,0.02$。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是四个浮点分量$[\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]$的逗号分隔列表。例如，输出必须如下所示\n$$\n\\big[[\\Delta V_{2r}^{(1)},\\Delta V_{2i}^{(1)},\\Delta V_{3r}^{(1)},\\Delta V_{3i}^{(1)}],[\\Delta V_{2r}^{(2)},\\Delta V_{2i}^{(2)},\\Delta V_{3r}^{(2)},\\Delta V_{3i}^{(2)}],[\\Delta V_{2r}^{(3)},\\Delta V_{2i}^{(3)},\\Delta V_{3r}^{(3)},\\Delta V_{3i}^{(3)}]\\big],\n$$\n方括号内任何地方都没有空格，并且每个浮点数都四舍五入到$8$位小数。",
            "solution": "该问题是有效的，因为它立题清晰，科学上基于电路理论和数值方法的原理，并为其解决提供了一套完整且一致的数据。任务是计算潮流问题单次牛顿-拉夫逊迭代的状态更新向量。\n\n解决方案分三步进行：\n1. 构建节点导纳矩阵$Y$。\n2. 构建残差向量$F(x)$和雅可比矩阵$J(x)$。\n3. 对每个测试用例，组合并求解线性系统$J(x)\\,\\Delta x = -F(x)$。\n\n**1. 节点导纳矩阵($Y$)构建**\n\n该网络由三个母线通过三条输电线路连接而成。平衡节点是母线1，PQ(负荷)节点是母线2和3。未知数的状态向量是$x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$，其中$V_k = V_{kr} + \\mathrm{j}V_{ki}$。平衡节点电压固定为$V_1 = 1.0 + \\mathrm{j}\\,0.0$。\n\n线路阻抗（标幺值）给定如下：\n- $z_{12} = 0.02 + \\mathrm{j}\\,0.06$\n- $z_{13} = 0.08 + \\mathrm{j}\\,0.24$\n- $z_{23} = 0.06 + \\mathrm{j}\\,0.18$\n\n相应的线路导纳是阻抗的倒数：\n- $y_{12} = 1/z_{12} = 1/(0.02 + \\mathrm{j}\\,0.06) = 5.0 - \\mathrm{j}\\,15.0$\n- $y_{13} = 1/z_{13} = 1/(0.08 + \\mathrm{j}\\,0.24) = 1.25 - \\mathrm{j}\\,3.75$\n- $y_{23} = 1/z_{23} = 1/(0.06 + \\mathrm{j}\\,0.18) \\approx 1.6667 - \\mathrm{j}\\,5.0$\n\n$3 \\times 3$的节点导纳矩阵$Y$构建如下：\n- 对角元素$Y_{kk}$是连接到母线$k$的所有导纳之和。\n- 非对角元素$Y_{kj}$是连接母线$k$和母线$j$的导纳的相反数。\n$$\nY =\n\\begin{bmatrix}\ny_{12} + y_{13}  & -y_{12} & -y_{13} \\\\\n-y_{12} & y_{12} + y_{23} & -y_{23} \\\\\n-y_{13} & -y_{23} & y_{13} + y_{23}\n\\end{bmatrix}\n$$\n\n代入数值：\n$Y_{11} = (5.0 - \\mathrm{j}\\,15.0) + (1.25 - \\mathrm{j}\\,3.75) = 6.25 - \\mathrm{j}\\,18.75$\n$Y_{22} = (5.0 - \\mathrm{j}\\,15.0) + (1.6667 - \\mathrm{j}\\,5.0) = 6.6667 - \\mathrm{j}\\,20.0$\n$Y_{33} = (1.25 - \\mathrm{j}\\,3.75) + (1.6667 - \\mathrm{j}\\,5.0) = 2.9167 - \\mathrm{j}\\,8.75$\n$Y_{12} = Y_{21} = -(5.0 - \\mathrm{j}\\,15.0) = -5.0 + \\mathrm{j}\\,15.0$\n$Y_{13} = Y_{31} = -(1.25 - \\mathrm{j}\\,3.75) = -1.25 + \\mathrm{j}\\,3.75$\n$Y_{23} = Y_{32} = -(1.6667 - \\mathrm{j}\\,5.0) = -1.6667 + \\mathrm{j}\\,5.0$\n我们将$Y_{kj}$的实部和虚部分别表示为$G_{kj}$和$B_{kj}$，因此$Y_{kj} = G_{kj} + \\mathrm{j}B_{kj}$。\n\n**2. 残差和雅可比矩阵的构建**\n\nPQ节点$k \\in \\{2,3\\}$处的节点电流不匹配方程为：\n$$\ng_k(V) = \\sum_{j=1}^{3} Y_{kj} V_j - \\frac{S_k^\\ast}{V_k^\\ast} = 0\n$$\n其中$V_1$已知，$V_2$和$V_3$是变量。残差向量$F(x)$由这两个复数方程的实部和虚部构成：\n$$\nF(x) = \\begin{bmatrix} \\operatorname{Re}(g_2) \\\\ \\operatorname{Im}(g_2) \\\\ \\operatorname{Re}(g_3) \\\\ \\operatorname{Im}(g_3) \\end{bmatrix}\n$$\n牛顿-拉夫逊更新步通过求解线性系统$J(x) \\Delta x = -F(x)$得到。雅可比矩阵$J(x)$是一个$4 \\times 4$的实值矩阵，定义为$J(x) = \\frac{\\partial F}{\\partial x}$，其中$x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$。雅可比矩阵可以划分为$2 \\times 2$的块：\n$$\nJ = \\begin{bmatrix} J_{22} & J_{23} \\\\ J_{32} & J_{33} \\end{bmatrix}, \\quad \\text{其中} \\quad J_{km} = \\begin{bmatrix} \\frac{\\partial \\operatorname{Re}(g_k)}{\\partial V_{mr}} & \\frac{\\partial \\operatorname{Re}(g_k)}{\\partial V_{mi}} \\\\ \\frac{\\partial \\operatorname{Im}(g_k)}{\\partial V_{mr}} & \\frac{\\partial \\operatorname{Im}(g_k)}{\\partial V_{mi}} \\end{bmatrix}\n$$\n\n导数推导如下。\n对于非对角块($k \\neq m$，例如$k=2, m=3$)：\n函数$g_k$仅通过线性项$Y_{km}V_m$受到$V_m$的影响。\n$$\n\\frac{\\partial g_k}{\\partial V_{mr}} = Y_{km}, \\quad \\frac{\\partial g_k}{\\partial V_{mi}} = \\mathrm{j}Y_{km}\n$$\n取实部和虚部得到块结构：\n$$\nJ_{km} = \\begin{bmatrix} G_{km} & -B_{km} \\\\ B_{km} & G_{km} \\end{bmatrix}\n$$\n\n对于对角块($k = m$，例如$k=2, m=2$)：\n依赖关系包括非线性功率项。\n$$\n\\frac{\\partial g_k}{\\partial V_{kr}} = Y_{kk} - \\frac{\\partial}{\\partial V_{kr}}\\left(\\frac{S_k^\\ast}{V_k^\\ast}\\right) = Y_{kk} + \\frac{S_k^\\ast}{(V_k^\\ast)^2} \\\\\n\\frac{\\partial g_k}{\\partial V_{ki}} = \\mathrm{j}Y_{kk} - \\frac{\\partial}{\\partial V_{ki}}\\left(\\frac{S_k^\\ast}{V_k^\\ast}\\right) = \\mathrm{j}Y_{kk} - \\mathrm{j}\\frac{S_k^\\ast}{(V_k^\\ast)^2}\n$$\n我们定义一个临时复变量$D_k = A_k + \\mathrm{j}C_k = \\frac{S_k^\\ast}{(V_k^\\ast)^2}$。那么偏导数为：\n$$\n\\frac{\\partial g_k}{\\partial V_{kr}} = (G_{kk} + \\mathrm{j}B_{kk}) + (A_k + \\mathrm{j}C_k) = (G_{kk}+A_k) + \\mathrm{j}(B_{kk}+C_k) \\\\\n\\frac{\\partial g_k}{\\partial V_{ki}} = \\mathrm{j}(G_{kk} + \\mathrm{j}B_{kk}) - \\mathrm{j}(A_k + \\mathrm{j}C_k) = (-B_{kk}+C_k) + \\mathrm{j}(G_{kk}-A_k)\n$$\n取这些表达式的实部和虚部，得到对角块：\n$$\nJ_{kk} = \\begin{bmatrix} G_{kk} + A_k & -B_{kk} + C_k \\\\ B_{kk} + C_k & G_{kk} - A_k \\end{bmatrix}\n$$\n\n**3. 测试用例的计算**\n\n对于每个测试用例，我们给定了状态向量的初始猜测值$x^{(0)} = [V_{2r}^{(0)}, V_{2i}^{(0)}, V_{3r}^{(0)}, V_{3i}^{(0)}]^\\top$以及指定的功率$S_2$和$S_3$。\n\n算法如下：\n1. 使用给定的常数值构建节点导纳矩阵$Y$。\n2. 对于每个测试用例：\n    a. 解包初始电压$V_2^{(0)}$、$V_3^{(0)}$和指定功率$S_2$、$S_3$。平衡节点电压始终为$V_1 = 1.0 + \\mathrm{j}\\,0.0$。\n    b. 计算残差向量$F(x^{(0)})$：\n        - 计算$g_2 = Y_{21}V_1 + Y_{22}V_2^{(0)} + Y_{23}V_3^{(0)} - S_2^\\ast / (V_2^{(0)})^\\ast$。\n        - 计算$g_3 = Y_{31}V_1 + Y_{32}V_2^{(0)} + Y_{33}V_3^{(0)} - S_3^\\ast / (V_3^{(0)})^\\ast$。\n        - 组合$F = [\\operatorname{Re}(g_2), \\operatorname{Im}(g_2), \\operatorname{Re}(g_3), \\operatorname{Im}(g_3)]^\\top$。\n    c. 计算雅可比矩阵$J(x^{(0)})$：\n        - 计算$D_2 = S_2^\\ast / ((V_2^{(0)})^\\ast)^2$和$D_3 = S_3^\\ast / ((V_3^{(0)})^\\ast)^2$。\n        - 使用上面推导的公式，在初始猜测值处评估，组合四个块$J_{22}, J_{23}, J_{32}, J_{33}$。\n    d. 求解$4 \\times 4$线性系统$J \\Delta x = -F$得到更新向量$\\Delta x = [\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]^\\top$。\n3. 最终结果是为每个测试用例计算出的$\\Delta x$向量的集合，按指定格式进行格式化。\n\n这个过程在提供的Python代码中实现，利用`numpy`进行复数算术和线性代数运算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Newton-Raphson update vector for a three-bus power system.\n    \"\"\"\n    # Network data (per unit)\n    z12 = 0.02 + 0.06j\n    z13 = 0.08 + 0.24j\n    z23 = 0.06 + 0.18j\n    v1_ref = 1.0 + 0.0j\n\n    # Line admittances\n    y12 = 1.0 / z12\n    y13 = 1.0 / z13\n    y23 = 1.0 / z23\n\n    # Construct Bus Admittance Matrix Y (using 0-based indexing)\n    # Bus 1 -> 0, Bus 2 -> 1, Bus 3 -> 2\n    Y = np.zeros((3, 3), dtype=np.complex128)\n    Y[0, 0] = y12 + y13\n    Y[1, 1] = y12 + y23\n    Y[2, 2] = y13 + y23\n    Y[0, 1] = Y[1, 0] = -y12\n    Y[0, 2] = Y[2, 0] = -y13\n    Y[1, 2] = Y[2, 1] = -y23\n    \n    G = Y.real\n    B = Y.imag\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {'S2': -0.9 - 0.3j, 'S3': -0.5 - 0.2j, 'V2_init': 1.0 + 0.0j, 'V3_init': 1.0 + 0.0j},\n        # Case 2\n        {'S2': -1.2 - 0.5j, 'S3': 0.3 - 0.1j, 'V2_init': 0.95 - 0.05j, 'V3_init': 0.97 + 0.02j},\n        # Case 3\n        {'S2': 0.0 + 0.0j, 'S3': -0.1 - 0.05j, 'V2_init': 1.02 + 0.01j, 'V3_init': 0.98 - 0.02j},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        S2 = case['S2']\n        S3 = case['S3']\n        V2 = case['V2_init']\n        V3 = case['V3_init']\n        V1 = v1_ref\n\n        # Calculate Residual Vector F(x)\n        g2 = Y[1, 0] * V1 + Y[1, 1] * V2 + Y[1, 2] * V3 - np.conj(S2) / np.conj(V2)\n        g3 = Y[2, 0] * V1 + Y[2, 1] * V2 + Y[2, 2] * V3 - np.conj(S3) / np.conj(V3)\n        F = np.array([g2.real, g2.imag, g3.real, g3.imag])\n\n        # Calculate Jacobian Matrix J(x)\n        J = np.zeros((4, 4), dtype=np.float64)\n\n        # Off-diagonal blocks\n        # J23 (top-right)\n        J[0, 2] = G[1, 2]; J[0, 3] = -B[1, 2]\n        J[1, 2] = B[1, 2]; J[1, 3] = G[1, 2]\n        # J32 (bottom-left)\n        J[2, 0] = G[2, 1]; J[2, 1] = -B[2, 1]\n        J[3, 0] = B[2, 1]; J[3, 1] = G[2, 1]\n\n        # Diagonal blocks\n        # J22 (top-left)\n        D2 = np.conj(S2) / (np.conj(V2)**2)\n        A2, C2 = D2.real, D2.imag\n        J[0, 0] = G[1, 1] + A2; J[0, 1] = -B[1, 1] + C2\n        J[1, 0] = B[1, 1] + C2; J[1, 1] = G[1, 1] - A2\n        \n        # J33 (bottom-right)\n        D3 = np.conj(S3) / (np.conj(V3)**2)\n        A3, C3 = D3.real, D3.imag\n        J[2, 2] = G[2, 2] + A3; J[2, 3] = -B[2, 2] + C3\n        J[3, 2] = B[2, 2] + C3; J[3, 3] = G[2, 2] - A3\n        \n        # Solve for the update vector delta_x\n        delta_x = np.linalg.solve(J, -F)\n        \n        # Format the result for the current case\n        case_result_str = f\"[{','.join([f'{val:.8f}' for val in delta_x])}]\"\n        results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(results)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "尽管完整的交流潮流模型非常精确，但其计算成本在某些应用中可能过高，因此催生了如直流潮流模型等线性近似方法的使用。本练习提供了一次至关重要的动手比较，要求您量化直流模型在不同条件下的误差。对于任何建模者来说，这种分析对于理解计算速度与物理精度之间的权衡至关重要。",
            "id": "4107781",
            "problem": "考虑一个由3个母线（索引为$i \\in \\{1,2,3\\}$）组成的连接网络，线路连接着母线对$(1,2)$、$(2,3)$和$(1,3)$。目标是在非零电阻电抗比的条件下，量化直流(DC)潮流近似法与基于基尔霍夫电流定律(KCL)计算的完整交流(AC)节点有功功率平衡相比所引入的误差。严格从第一性原理出发：复数电流的基尔霍夫电流定律以及复数电压和导纳的欧姆定律。\n\n基本原理：\n- 基尔霍夫电流定律(KCL)：节点上电流的代数和为零。在节点导纳形式下，节点电流满足$I = Y_{\\text{bus}} V$，其中$I$是复数电流注入向量，$V$是复数电压向量，$Y_{\\text{bus}}$是由线路导纳构成的节点导纳矩阵。\n- 复功率定义：在每个母线$i$，复功率注入为$S_i = V_i \\overline{I_i}$，有功功率注入为$P_i = \\Re(S_i)$。\n- 每条支路上的欧姆定律：沿线路$(i,j)$从母线$i$到母线$j$的电流为$I_{ij} = (V_i - V_j) y_{ij}$，其中串联导纳为$y_{ij} = \\dfrac{1}{R_{ij} + \\mathrm{j} X_{ij}}$。\n- 直流潮流近似假设：母线电压幅值约为$1$标幺值，相角差很小，因此$\\sin(\\theta_i - \\theta_j) \\approx \\theta_i - \\theta_j$，线路电阻被忽略，因此只有电抗影响有功潮流。在这些假设下，母线$i$的直流节点有功功率注入近似为$P^{\\text{DC}}_i = \\sum_{j \\in \\mathcal{N}(i)} \\dfrac{\\theta_i - \\theta_j}{X_{ij}}$，从$i$到$j$的支路有功潮流为$P^{\\text{DC}}_{ij} = \\dfrac{\\theta_i - \\theta_j}{X_{ij}}$，两者都以标幺值表示，通过乘以系统基准功率$S_{\\text{base}}$可转换为兆瓦(MW)。\n\n任务：\n- 对于每个给定的测试用例，使用串联导纳$y_{ij} = \\dfrac{1}{R_{ij} + \\mathrm{j} X_{ij}}$为3母线系统构建节点导纳矩阵$Y_{\\text{bus}}$，不含并联元件。使用复数母线电压$V_i = |V_i| e^{j \\theta_i}$，其中电压幅值为$|V_i|$，相角为$\\theta_i$（相角以弧度为单位）。\n- 使用KCL和$I = Y_{\\text{bus}} V$计算完整的交流节点有功功率注入$P^{\\text{AC}}_i = \\Re\\left(V_i \\overline{I_i}\\right)$（以标幺值表示），并通过乘以$S_{\\text{base}}$（单位为MW）将其转换为兆瓦。\n- 计算交流支路有功潮流$P^{\\text{AC}}_{ij} = \\Re\\left(V_i \\overline{I_{ij}}\\right)$（以标幺值表示），其中$I_{ij} = (V_i - V_j) y_{ij}$，对于母线对$(1,2)$、$(1,3)$和$(2,3)$，方向为从索引较低的母线到索引较高的母线，并将其转换为兆瓦。\n- 仅使用电抗$X_{ij}$和相角$\\theta_i$计算直流近似的节点有功功率注入$P^{\\text{DC}}_i$和支路潮流$P^{\\text{DC}}_{ij}$（以标幺值表示），然后将两者都转换为兆瓦。\n- 通过为每个测试用例计算两个指标来量化直流近似的误差：\n  $$\n  E_{\\text{nodes}} = \\max_{i \\in \\{1,2,3\\}} \\left| P^{\\text{AC}}_i - P^{\\text{DC}}_i \\right| \\quad \\text{(单位: MW)},\n  $$\n  $$\n  E_{\\text{branches}} = \\max_{(i,j) \\in \\{(1,2),(1,3),(2,3)\\}} \\left| P^{\\text{AC}}_{ij} - P^{\\text{DC}}_{ij} \\right| \\quad \\text{(单位: MW)}.\n  $$\n- 使用以下测试套件。对于每个案例，相角以弧度为单位，线路参数是在给定基准下的标幺值，所有输出必须以兆瓦(MW)为单位。\n\n测试套件：\n- 案例1（零电阻边界情况）：\n  - $S_{\\text{base}} = 100$ MW。\n  - 线路：$(1,2): (R,X) = (0.0, 0.20)$; $(2,3): (R,X) = (0.0, 0.25)$; $(1,3): (R,X) = (0.0, 0.22)$。\n  - 电压幅值：$|V| = [1.00, 1.00, 1.00]$。\n  - 相角：$\\theta = [0.00, 0.05, -0.03]$。\n- 案例2（中等电阻，$R/X \\approx 0.2$）：\n  - $S_{\\text{base}} = 100$ MW。\n  - 线路：$(1,2): (R,X) = (0.04, 0.20)$; $(2,3): (R,X) = (0.05, 0.25)$; $(1,3): (R,X) = (0.044, 0.22)$。\n  - 电压幅值：$|V| = [1.00, 1.00, 1.00]$。\n  - 相角：$\\theta = [0.00, 0.10, -0.06]$。\n- 案例3（异构$R/X$，含一条高电阻线路）：\n  - $S_{\\text{base}} = 100$ MW。\n  - 线路：$(1,2): (R,X) = (0.10, 0.20)$; $(2,3): (R,X) = (0.01, 0.25)$; $(1,3): (R,X) = (0.02, 0.22)$。\n  - 电压幅值：$|V| = [1.00, 1.00, 1.00]$。\n  - 相角：$\\theta = [0.00, 0.20, -0.15]$。\n- 案例4（电压幅值偏离，中等电阻）：\n  - $S_{\\text{base}} = 100$ MW。\n  - 线路：$(1,2): (R,X) = (0.02, 0.20)$; $(2,3): (R,X) = (0.02, 0.25)$; $(1,3): (R,X) = (0.02, 0.22)$。\n  - 电压幅值：$|V| = [1.00, 0.97, 1.04]$。\n  - 相角：$\\theta = [0.00, 0.12, -0.07]$。\n\n要求：\n- 相角必须以弧度为单位进行解释。\n- 直接根据线路串联导纳构建$Y_{\\text{bus}}$，不含并联元件。\n- 所有输出必须以兆瓦(MW)表示。\n- 最终输出格式：您的程序应生成单行输出，其中包含每个测试用例的双元素列表$[E_{\\text{nodes}}, E_{\\text{branches}}]$（单位为MW），聚合为一个由方括号括起来的逗号分隔列表。例如，4个案例的输出应类似于$[[e_{1n},e_{1b}],[e_{2n},e_{2b}],[e_{3n},e_{3b}],[e_{4n},e_{4b}]]$，其中每个$e_{\\cdot}$是一个浮点数。",
            "solution": "该问题是有效的，因为它科学地基于电路理论原理，结构良好并提供了所有必要数据，且其表述是客观的。它代表了电力系统分析中一个标准的、可验证的练习。\n\n目标是量化直流(DC)潮流近似法相对于完整交流(AC)潮流模型的误差。这将通过使用两种方法计算一个3母线系统的节点和支路潮流，然后计算一系列测试用例的最大绝对差来完成。所有计算都以标幺值(pu)进行，并转换为兆瓦(MW)以用于最终的误差指标。\n\n### 步骤1：交流潮流计算（精确模型）\n\n交流潮流模型源于第一性原理：基尔霍夫电流定律(KCL)以及复数电压、电流和功率的定义。\n\n每个母线$i$的复数电压以极坐标形式给出，为$V_i = |V_i| e^{\\mathrm{j} \\theta_i}$，其中$|V_i|$是电压幅值，$\\theta_i$是以弧度为单位的相角。\n\n输电线路通过其串联阻抗$Z_{ij} = R_{ij} + \\mathrm{j} X_{ij}$进行建模。相应的串联导纳是其倒数，$y_{ij} = \\frac{1}{Z_{ij}} = \\frac{1}{R_{ij} + \\mathrm{j} X_{ij}}$。可以将其有理化以分离电导($g_{ij}$)和电纳($b_{ij}$）：\n$$\ny_{ij} = \\frac{1}{R_{ij} + \\mathrm{j} X_{ij}} \\times \\frac{R_{ij} - \\mathrm{j} X_{ij}}{R_{ij} - \\mathrm{j} X_{ij}} = \\frac{R_{ij}}{R_{ij}^2 + X_{ij}^2} + \\mathrm{j} \\frac{-X_{ij}}{R_{ij}^2 + X_{ij}^2} = g_{ij} + \\mathrm{j} b_{ij}\n$$\n网络由节点导纳矩阵$Y_{\\text{bus}}$描述，该矩阵通过$I = Y_{\\text{bus}} V$将节点复数电流注入向量$I$与节点复数电压向量$V$联系起来。对于没有并联元件的网络，$Y_{\\text{bus}}$的元素构造如下：\n- 对角元素：$Y_{ii} = \\sum_{j \\neq i} y_{ij}$\n- 非对角元素：$Y_{ij} = -y_{ij}$对于$i \\neq j$\n\n对于给定的3母线系统，其$3 \\times 3$节点导纳矩阵为：\n$$\nY_{\\text{bus}} = \\begin{pmatrix}\ny_{12} + y_{13}  & -y_{12} & -y_{13} \\\\\n-y_{12} & y_{12} + y_{23} & -y_{23} \\\\\n-y_{13} & -y_{23} & y_{13} + y_{23}\n\\end{pmatrix}\n$$\n母线处的复数电流注入向量$I = [I_1, I_2, I_3]^T$通过矩阵-向量乘积$I = Y_{\\text{bus}} V$求得。\n\n母线$i$处的复功率注入$S_i$由$S_i = P_i + \\mathrm{j} Q_i = V_i \\overline{I_i}$给出，其中$\\overline{I_i}$是电流注入$I_i$的复共轭。交流有功功率注入$P^{\\text{AC}}_i$是该复功率的实部：\n$$\nP^{\\text{AC}}_i = \\Re(S_i) = \\Re(V_i \\overline{I_i})\n$$\n从母线$i$到母线$j$的支路上的交流有功潮流$P^{\\text{AC}}_{ij}$是离开母线$i$的复功率的实部。从母线$i$流向母线$j$的电流为$I_{ij} = (V_i - V_j)y_{ij}$。相应的潮流为：\n$$\nP^{\\text{AC}}_{ij} = \\Re(V_i \\overline{I_{ij}}) = \\Re(V_i \\overline{((V_i - V_j)y_{ij})})\n$$\n这些功率值是以标幺值表示的。要转换为兆瓦，需将其乘以系统基准功率$S_{\\text{base}}$。\n\n### 步骤2：直流潮流计算（近似法）\n\n直流潮流模型基于三个主要假设简化了交流方程：\n1. 电压幅值为单位值（对于所有$i$，$|V_i| \\approx 1$标幺值）。\n2. 与电抗相比，线路电阻可以忽略不计（$R_{ij} \\ll X_{ij}$，因此假定为$0$）。\n3. 线路两端的电压相角差很小（$\\theta_i - \\theta_j \\approx 0$），因此可以近似为$\\sin(\\theta_i - \\theta_j) \\approx \\theta_i - \\theta_j$和$\\cos(\\theta_i - \\theta_j) \\approx 1$。\n\n在这些假设下，母线$i$的有功功率注入被近似为电压相角的线性函数：\n$$\nP^{\\text{DC}}_i = \\sum_{j \\in \\mathcal{N}(i)} \\frac{\\theta_i - \\theta_j}{X_{ij}}\n$$\n其中$\\mathcal{N}(i)$是与母线$i$相邻的母线集合。\n类似地，从母线$i$到母线$j$的支路上的有功潮流近似为：\n$$\nP^{\\text{DC}}_{ij} = \\frac{\\theta_i - \\theta_j}{X_{ij}}\n$$\n与交流模型一样，这些标幺值通过乘以$S_{\\text{base}}$来获得以兆瓦(MW)为单位的功率。\n\n### 步骤3：误差量化\n\n在所有功率值都转换为兆瓦后，使用两个指标来量化直流近似引入的误差：\n1.  **节点注入误差**：在所有母线上，交流和直流节点功率注入之间的最大绝对差。\n    $$\n    E_{\\text{nodes}} = \\max_{i \\in \\{1,2,3\\}} |P^{\\text{AC}}_i - P^{\\text{DC}}_i|\n    $$\n2.  **支路潮流误差**：在指定的支路$(1,2)$、$(1,3)$和$(2,3)$上，交流和直流支路潮流之间的最大绝对差。\n    $$\n    E_{\\text{branches}} = \\max_{(i,j) \\in \\{(1,2),(1,3),(2,3)\\}} |P^{\\text{AC}}_{ij} - P^{\\text{DC}}_{ij}|\n    $$\n\n### 算法步骤\n\n对于问题陈述中提供的每个测试用例，执行以下计算步骤：\n1.  定义系统参数：$S_{\\text{base}}$，线路$(1,2)$、$(2,3)$和$(1,3)$的线路阻抗$Z_{ij} = R_{ij} + \\mathrm{j} X_{ij}$，以及复数母线电压$V_i = |V_i| e^{\\mathrm{j} \\theta_i}$。\n2.  计算串联导纳$y_{ij} = 1/Z_{ij}$。\n3.  构建$3 \\times 3$的复数矩阵$Y_{\\text{bus}}$。\n4.  **交流计算**：\n    a. 计算节点电流注入向量：$I = Y_{\\text{bus}}V$。\n    b. 计算节点有功功率注入向量：$P^{\\text{AC}}_i = \\Re(V_i \\overline{I_i}) \\times S_{\\text{base}}$。\n    c. 对于支路$(1,2)$、$(1,3)$和$(2,3)$，计算支路电流$I_{ij} = (V_i - V_j)y_{ij}$。\n    d. 计算支路有功潮流：$P^{\\text{AC}}_{ij} = \\Re(V_i \\overline{I_{ij}}) \\times S_{\\text{base}}$。\n5.  **直流计算**：\n    a. 使用相角$\\theta_i$和电抗$X_{ij}$计算节点有功功率注入：$P^{\\text{DC}}_i = \\left(\\sum_{j \\in \\mathcal{N}(i)} \\frac{\\theta_i - \\theta_j}{X_{ij}}\\right) \\times S_{\\text{base}}$。\n    b. 计算支路有功潮流：$P^{\\text{DC}}_{ij} = \\left(\\frac{\\theta_i - \\theta_j}{X_{ij}}\\right) \\times S_{\\text{base}}$。\n6.  **误差计算**：\n    a. 通过找到$P^{\\text{AC}}_i$和$P^{\\text{DC}}_i$向量之间的最大绝对差来计算节点误差$E_{\\text{nodes}}$。\n    b. 通过找到$P^{\\text{AC}}_{ij}$和$P^{\\text{DC}}_{ij}$值之间的最大绝对差来计算支路误差$E_{\\text{branches}}$。\n7.  存储结果对$[E_{\\text{nodes}}, E_{\\text{branches}}]$。处理完所有案例后，将结果聚合成指定的列表格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the error of the DC power flow approximation compared to the full AC power flow model\n    for a 3-bus system across several test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (boundary with zero resistance)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.0, \"X\": 0.20},\n                (2, 3): {\"R\": 0.0, \"X\": 0.25},\n                (1, 3): {\"R\": 0.0, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.05, -0.03]),\n        },\n        # Case 2 (moderate resistance with R/X ~ 0.2)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.04, \"X\": 0.20},\n                (2, 3): {\"R\": 0.05, \"X\": 0.25},\n                (1, 3): {\"R\": 0.044, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.10, -0.06]),\n        },\n        # Case 3 (heterogeneous R/X with one high resistance line)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.10, \"X\": 0.20},\n                (2, 3): {\"R\": 0.01, \"X\": 0.25},\n                (1, 3): {\"R\": 0.02, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.20, -0.15]),\n        },\n        # Case 4 (voltage magnitude deviations with moderate resistance)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.02, \"X\": 0.20},\n                (2, 3): {\"R\": 0.02, \"X\": 0.25},\n                (1, 3): {\"R\": 0.02, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 0.97, 1.04]),\n            \"V_ang_rad\": np.array([0.00, 0.12, -0.07]),\n        },\n    ]\n\n    results = []\n    \n    # Define bus indices for array access (0-indexed)\n    bus_map = {1: 0, 2: 1, 3: 2}\n    \n    for case in test_cases:\n        S_base = case[\"S_base\"]\n        lines = case[\"lines\"]\n        V_mag = case[\"V_mag\"]\n        V_ang_rad = case[\"V_ang_rad\"]\n        \n        # --- AC Model ---\n        \n        # 1. Complex voltages\n        V = V_mag * np.exp(1j * V_ang_rad)\n\n        # 2. Line admittances\n        y = {}\n        for (i, j), params in lines.items():\n            Z = params[\"R\"] + 1j * params[\"X\"]\n            y[(i, j)] = 1.0 / Z\n        \n        y12 = y[(1, 2)]\n        y23 = y[(2, 3)]\n        y13 = y[(1, 3)]\n\n        # 3. Y_bus matrix\n        Y_bus = np.zeros((3, 3), dtype=complex)\n        Y_bus[0, 0] = y12 + y13\n        Y_bus[0, 1] = -y12\n        Y_bus[0, 2] = -y13\n        Y_bus[1, 0] = -y12\n        Y_bus[1, 1] = y12 + y23\n        Y_bus[1, 2] = -y23\n        Y_bus[2, 0] = -y13\n        Y_bus[2, 1] = -y23\n        Y_bus[2, 2] = y13 + y23\n\n        # 4. AC Nodal Power Injections\n        I_inj = Y_bus @ V\n        S_inj = V * np.conj(I_inj)\n        P_ac_nodes = S_inj.real * S_base\n\n        # 5. AC Branch Power Flows (oriented from lower to higher index bus)\n        i1, i2, i3 = bus_map[1], bus_map[2], bus_map[3]\n        I_12 = (V[i1] - V[i2]) * y12\n        I_13 = (V[i1] - V[i3]) * y13\n        I_23 = (V[i2] - V[i3]) * y23\n        \n        P_ac_12 = (V[i1] * np.conj(I_12)).real * S_base\n        P_ac_13 = (V[i1] * np.conj(I_13)).real * S_base\n        P_ac_23 = (V[i2] * np.conj(I_23)).real * S_base\n        P_ac_branches = np.array([P_ac_12, P_ac_13, P_ac_23])\n\n        # --- DC Model ---\n        \n        th1, th2, th3 = V_ang_rad[i1], V_ang_rad[i2], V_ang_rad[i3]\n        X12 = lines[(1, 2)][\"X\"]\n        X23 = lines[(2, 3)][\"X\"]\n        X13 = lines[(1, 3)][\"X\"]\n\n        # 1. DC Nodal Power Injections\n        P_dc_node1 = ((th1 - th2) / X12 + (th1 - th3) / X13) * S_base\n        P_dc_node2 = ((th2 - th1) / X12 + (th2 - th3) / X23) * S_base\n        P_dc_node3 = ((th3 - th1) / X13 + (th3 - th2) / X23) * S_base\n        P_dc_nodes = np.array([P_dc_node1, P_dc_node2, P_dc_node3])\n        \n        # 2. DC Branch Power Flows\n        P_dc_12 = ((th1 - th2) / X12) * S_base\n        P_dc_13 = ((th1 - th3) / X13) * S_base\n        P_dc_23 = ((th2 - th3) / X23) * S_base\n        P_dc_branches = np.array([P_dc_12, P_dc_13, P_dc_23])\n\n        # --- Error Calculation ---\n        \n        E_nodes = np.max(np.abs(P_ac_nodes - P_dc_nodes))\n        E_branches = np.max(np.abs(P_ac_branches - P_dc_branches))\n        \n        results.append([E_nodes, E_branches])\n\n    # Final print statement in the exact required format.\n    # The format [[...],[...]] requires str() of a list of lists.\n    # Joining with map(str,...) ensures correct formatting for each inner list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}