{
    "hands_on_practices": [
        {
            "introduction": "This first practice is a foundational exercise designed to build fluency with the core mechanics of the DC power flow approximation. By constructing the bus susceptance matrix ($B$) from network parameters and solving the linear system $P = B\\theta$, you will solidify your understanding of how topology and power injections determine voltage angles in this linearized model. This procedural skill is essential before moving on to a more critical analysis of the model's limitations. ",
            "id": "4070063",
            "problem": "A four-bus transmission network is operated under the Direct Current (DC) power flow approximation within the per-unit (pu) system. Buses are labeled $1$ through $4$, with the following series reactances on the three lines in a radial chain: line $\\{1,2\\}$ has $X_{12}=0.2$ pu, line $\\{2,3\\}$ has $X_{23}=0.1$ pu, and line $\\{3,4\\}$ has $X_{34}=0.15$ pu. Assume there are no shunt elements, line resistances are negligible, bus voltage magnitudes are close to $1$ pu, angle differences are small, and the network is balanced and steady-state. Active power injections (positive for net generation, negative for net load) at the buses are specified as the vector $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]$ pu. Bus $1$ is the angle reference (slack) with voltage angle fixed at $0$ radians.\n\nStarting from alternating current power flow fundamentals and the nodal active power balance, and applying the DC approximation assumptions, derive the bus susceptance matrix $B$ for this network. Then, enforce the slack angle condition and solve for the bus voltage angles $\\theta=[\\theta_{1},\\theta_{2},\\theta_{3},\\theta_{4}]$ that satisfy the nodal active power balance under the DC approximation.\n\nExpress the final answer as the row vector of bus voltage angles $\\theta$ in radians, and round each nonzero entry to four significant figures. State angles in radians only.",
            "solution": "The problem requires the determination of bus voltage angles in a four-bus power system under the Direct Current (DC) power flow approximation. The solution proceeds in three stages: first, deriving the governing equations from AC power flow principles; second, constructing the bus susceptance matrix ($B$) for the given network; and third, solving the resulting system of linear equations for the unknown voltage angles.\n\n### Step 1: Derivation of the DC Power Flow Model\n\nThe active power flow $P_{ik}$ from bus $i$ to bus $k$ in an AC transmission line is given by:\n$$ P_{ik} = \\frac{|V_i| |V_k|}{X_{ik}} \\sin(\\theta_i - \\theta_k) $$\nwhere $|V_i|$ and $|V_k|$ are the voltage magnitudes at bus $i$ and bus $k$, respectively, $\\theta_i$ and $\\theta_k$ are the bus voltage angles, and $X_{ik}$ is the series reactance of the line connecting them. Line resistance is assumed to be negligible.\n\nThe DC power flow approximation relies on the following assumptions:\n1.  All bus voltage magnitudes are approximately $1.0$ per unit (pu), i.e., $|V_i| \\approx 1.0$ for all $i$.\n2.  The voltage angle difference between any two connected buses is small, which allows for the approximation $\\sin(\\theta_i - \\theta_k) \\approx (\\theta_i - \\theta_k)$, where the angles are in radians.\n\nApplying these assumptions to the AC power flow equation simplifies it to the DC power flow equation:\n$$ P_{ik} \\approx \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\nThe net active power injection $P_i$ at a bus $i$ is the sum of the power flows leaving the bus on all lines connected to it.\n$$ P_i = \\sum_{k \\in \\mathcal{N}_i} P_{ik} = \\sum_{k \\in \\mathcal{N}_i} \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\nwhere $\\mathcal{N}_i$ is the set of buses directly connected to bus $i$.\n\nThis system of nodal power balance equations can be expressed in matrix form as $P = B\\theta$, where $P$ is the vector of bus power injections, $\\theta$ is the vector of bus voltage angles, and $B$ is the bus susceptance matrix. The elements of the bus susceptance matrix $B$ are defined as:\n- Off-diagonal elements ($i \\neq k$): $B_{ik} = -b_{ik}$, where $b_{ik} = 1/X_{ik}$ if a line exists between $i$ and $k$, and $B_{ik}=0$ otherwise.\n- Diagonal elements ($i = k$): $B_{ii} = \\sum_{k \\neq i} b_{ik}$, the sum of the susceptances of all lines connected to bus $i$.\n\n### Step 2: Construction of the Bus Susceptance Matrix $B$\n\nThe given network has three lines with the following reactances: $X_{12}=0.2$ pu, $X_{23}=0.1$ pu, and $X_{34}=0.15$ pu. The corresponding line susceptances are:\n- $b_{12} = \\frac{1}{X_{12}} = \\frac{1}{0.2} = 5$ pu.\n- $b_{23} = \\frac{1}{X_{23}} = \\frac{1}{0.1} = 10$ pu.\n- $b_{34} = \\frac{1}{X_{34}} = \\frac{1}{0.15} = \\frac{1}{15/100} = \\frac{100}{15} = \\frac{20}{3}$ pu.\n\nUsing these values, we construct the $4 \\times 4$ bus susceptance matrix $B$:\n- $B_{11} = b_{12} = 5$\n- $B_{22} = b_{12} + b_{23} = 5 + 10 = 15$\n- $B_{33} = b_{23} + b_{34} = 10 + \\frac{20}{3} = \\frac{30+20}{3} = \\frac{50}{3}$\n- $B_{44} = b_{34} = \\frac{20}{3}$\n- $B_{12} = B_{21} = -b_{12} = -5$\n- $B_{23} = B_{32} = -b_{23} = -10$\n- $B_{34} = B_{43} = -b_{34} = -\\frac{20}{3}$\nAll other off-diagonal elements are $0$ as there are no other direct connections.\n\nThe full bus susceptance matrix is:\n$$ B = \\begin{pmatrix} 5 & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} $$\n\n### Step 3: Solving for Bus Voltage Angles\n\nThe system of equations is $P = B\\theta$. With the given power injections $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]^T$ and bus angles $\\theta=[\\theta_1,\\,\\theta_2,\\,\\theta_3,\\,\\theta_4]^T$:\n$$ \\begin{pmatrix} P_1 \\\\ P_2 \\\\ P_3 \\\\ P_4 \\end{pmatrix} = \\begin{pmatrix} 5 & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\nBus $1$ is the slack bus, which provides the angle reference. Therefore, its angle is fixed: $\\theta_1 = 0$ radians. This condition removes the linear dependence in the system. The equation for the slack bus (first row) is removed from the set to be solved, as $P_1$ is the dependent variable that balances the system. The known variables are $P_2=0.2$, $P_3=-0.3$, and $P_4=-0.3$. We can set up a reduced system of equations for the unknown angles $\\theta_2$, $\\theta_3$, and $\\theta_4$.\nWe use rows $2$, $3$, and $4$ of the matrix equation. Setting $\\theta_1 = 0$:\n$$ \\begin{pmatrix} 0.2 \\\\ -0.3 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 15 & -10 & 0 \\\\ -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\nThis constitutes a system of three linear equations:\n1. $15\\theta_2 - 10\\theta_3 = 0.2$\n2. $-10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}\\theta_4 = -0.3$\n3. $-\\frac{20}{3}\\theta_3 + \\frac{20}{3}\\theta_4 = -0.3$\n\nWe solve this system by substitution, starting from the last equation.\nFrom equation (3):\n$$ \\frac{20}{3}(\\theta_4 - \\theta_3) = -0.3 $$\n$$ \\theta_4 - \\theta_3 = -0.3 \\times \\frac{3}{20} = -\\frac{0.9}{20} = -0.045 $$\n$$ \\theta_4 = \\theta_3 - 0.045 $$\nSubstitute this expression for $\\theta_4$ into equation (2):\n$$ -10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}(\\theta_3 - 0.045) = -0.3 $$\n$$ -10\\theta_2 + \\frac{50-20}{3}\\theta_3 + \\frac{20 \\times 0.045}{3} = -0.3 $$\n$$ -10\\theta_2 + \\frac{30}{3}\\theta_3 + \\frac{0.9}{3} = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 + 0.3 = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 = -0.6 $$\nDividing by $10$, we get:\n$$ -\\theta_2 + \\theta_3 = -0.06 \\implies \\theta_3 = \\theta_2 - 0.06 $$\nFinally, substitute this expression for $\\theta_3$ into equation (1):\n$$ 15\\theta_2 - 10(\\theta_2 - 0.06) = 0.2 $$\n$$ 15\\theta_2 - 10\\theta_2 + 0.6 = 0.2 $$\n$$ 5\\theta_2 = 0.2 - 0.6 = -0.4 $$\n$$ \\theta_2 = -\\frac{0.4}{5} = -0.08 $$\nNow, we back-substitute to find the remaining angles:\n$$ \\theta_3 = \\theta_2 - 0.06 = -0.08 - 0.06 = -0.14 $$\n$$ \\theta_4 = \\theta_3 - 0.045 = -0.14 - 0.045 = -0.185 $$\nThe vector of bus voltage angles in radians is $\\theta = [\\theta_1, \\theta_2, \\theta_3, \\theta_4] = [0, -0.08, -0.14, -0.185]$.\n\nThe problem requires rounding each nonzero entry to four significant figures.\n- $\\theta_2 = -0.08$ is rounded to $-0.08000$\n- $\\theta_3 = -0.14$ is rounded to $-0.1400$\n- $\\theta_4 = -0.185$ is rounded to $-0.1850$\n\nThe final vector of bus voltage angles is $\\theta = [0, -0.08000, -0.1400, -0.1850]$ radians.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & -0.08000 & -0.1400 & -0.1850 \\end{pmatrix}}$$"
        },
        {
            "introduction": "After mastering the mechanics, we now critically examine the assumptions that underpin the DC approximation. This exercise guides you to derive the exact AC power flow expression, including the effects of line resistance, and directly contrast it with the simplified DC formula. Calculating the analytical error function provides a clear, quantitative understanding of the discrepancies introduced by neglecting resistance ($R$) and linearizing trigonometric functions. ",
            "id": "4070075",
            "problem": "Consider a two-bus Alternating Current (AC) power system with buses $i$ and $j$ connected by a single series branch of impedance $Z = R + jX$ in per-unit (pu). Assume there are no shunt elements and no transformer off-nominal tap ratios. The complex bus voltages are $V_{i} = |V_{i}| \\exp(j \\theta_{i})$ and $V_{j} = |V_{j}| \\exp(j \\theta_{j})$, with equal magnitudes $|V_{i}| = |V_{j}| = 1$ pu and angle difference $\\delta \\equiv \\theta_{i} - \\theta_{j}$ (use radians). Let $R = 0.1$ pu and $X = 0.1$ pu.\n\nStarting solely from the phasor form of Ohm’s law and the definition of complex power, derive an exact closed-form expression for the real power flowing from bus $i$ to bus $j$, denoted $P_{i \\to j}^{\\mathrm{AC}}(\\delta)$, as a function of $\\delta$, $R$, and $X$. Then, contrast this with the Direct-Current (DC) power flow approximation $P_{i \\to j}^{\\mathrm{DC}}(\\delta) \\approx (\\theta_{i} - \\theta_{j})/X$ that is commonly used under small angle differences, negligible resistance, and flat voltage magnitude assumptions.\n\nDefine the signed error function\n$$E(\\delta) \\equiv P_{i \\to j}^{\\mathrm{AC}}(\\delta) - P_{i \\to j}^{\\mathrm{DC}}(\\delta).$$\nProvide $E(\\delta)$ explicitly for the given numerical parameters $R = 0.1$ pu, $X = 0.1$ pu. Your final answer must be a single closed-form analytic expression in terms of $\\delta$ only. Express the final result in per-unit (pu) and use radians for $\\delta$. No rounding is required.",
            "solution": "We begin from fundamental circuit and power definitions. The series branch connecting buses $i$ and $j$ has impedance $Z = R + jX$ and admittance\n$$y \\equiv \\frac{1}{Z} = \\frac{1}{R + jX} = \\frac{R - jX}{R^{2} + X^{2}}.$$\nIt is convenient to write $y$ in terms of its real and imaginary parts. Define the conductance $g$ and a positive constant $\\beta$ via\n$$g \\equiv \\frac{R}{R^{2} + X^{2}}, \\qquad \\beta \\equiv \\frac{X}{R^{2} + X^{2}},$$\nso that\n$$y = g - j \\beta, \\qquad y^{*} = g + j \\beta.$$\n\nLet the bus voltages be $V_{i} = \\exp(j \\theta_{i})$ and $V_{j} = \\exp(j \\theta_{j})$ because $|V_{i}| = |V_{j}| = 1$ pu. The series branch current from $i$ to $j$ is determined by Ohm’s law in phasor form:\n$$I_{ij} = y (V_{i} - V_{j}).$$\nThe complex power flowing from $i$ to $j$ is\n$$S_{i \\to j} = V_{i} I_{ij}^{*} = V_{i} \\left[y^{*} \\left(V_{i}^{*} - V_{j}^{*} \\right) \\right] = y^{*} \\left(V_{i} V_{i}^{*} - V_{i} V_{j}^{*} \\right).$$\nWith $|V_{i}| = 1$, we have $V_{i} V_{i}^{*} = 1$, and with $\\delta \\equiv \\theta_{i} - \\theta_{j}$ we have $V_{i} V_{j}^{*} = \\exp(j \\delta)$. Thus,\n$$S_{i \\to j} = y^{*} \\left(1 - \\exp(j \\delta) \\right).$$\nThe real power flow is the real part of $S_{i \\to j}$:\n$$P_{i \\to j}^{\\mathrm{AC}}(\\delta) = \\Re \\left\\{ y^{*} \\left(1 - \\exp(j \\delta) \\right) \\right\\}.$$\nUsing $\\exp(j \\delta) = \\cos \\delta + j \\sin \\delta$ and $y^{*} = g + j \\beta$, we obtain\n\\begin{align*}\nP_{i \\to j}^{\\mathrm{AC}}(\\delta)\n&= \\Re \\left\\{ (g + j \\beta) \\left(1 - \\cos \\delta - j \\sin \\delta \\right) \\right\\} \\\\\n&= \\Re \\left\\{ g(1 - \\cos \\delta) - j g \\sin \\delta + j \\beta (1 - \\cos \\delta) + \\beta \\sin \\delta \\right\\} \\\\\n&= g (1 - \\cos \\delta) + \\beta \\sin \\delta.\n\\end{align*}\nThis is the exact AC real power flow for a single series branch with equal voltage magnitudes and no shunt, expressed in terms of $R$, $X$, and $\\delta$ via $g$ and $\\beta$.\n\nNext, the Direct-Current (DC) power flow approximation under small angles, negligible resistance, and unity voltage magnitudes is\n$$P_{i \\to j}^{\\mathrm{DC}}(\\delta) \\approx \\frac{\\delta}{X}.$$\nWe now form the signed error function\n$$E(\\delta) \\equiv P_{i \\to j}^{\\mathrm{AC}}(\\delta) - P_{i \\to j}^{\\mathrm{DC}}(\\delta) = g (1 - \\cos \\delta) + \\beta \\sin \\delta - \\frac{\\delta}{X}.$$\n\nFor the given parameters $R = 0.1$ pu and $X = 0.1$ pu, we have\n$$R^{2} + X^{2} = (0.1)^{2} + (0.1)^{2} = 0.01 + 0.01 = 0.02,$$\nhence\n$$g = \\frac{0.1}{0.02} = 5, \\qquad \\beta = \\frac{0.1}{0.02} = 5, \\qquad \\frac{1}{X} = \\frac{1}{0.1} = 10.$$\nSubstituting these values into the error expression yields\n\\begin{align*}\nE(\\delta)\n&= 5 (1 - \\cos \\delta) + 5 \\sin \\delta - 10 \\delta \\\\\n&= 5 \\left(1 - \\cos \\delta + \\sin \\delta \\right) - 10 \\delta.\n\\end{align*}\n\nThis analytic expression quantifies both magnitude and sign discrepancies. Under the DC assumptions ($R \\to 0$, small $|\\delta|$), the exact AC flow reduces to $P_{i \\to j}^{\\mathrm{AC}}(\\delta) \\approx \\beta \\sin \\delta \\approx \\frac{\\delta}{X}$, recovering the DC formula. However, with $R$ comparable to $X$ as here, the term $g (1 - \\cos \\delta)$ introduces an even-in-$\\delta$ component absent in DC, causing substantial magnitude errors for moderate $|\\delta|$ and potential sign discrepancies for sufficiently large negative $\\delta$ (for instance, with $R = X$, $P_{i \\to j}^{\\mathrm{AC}}(\\delta)$ vanishes at $\\delta = 0$ and $\\delta = -\\pi/2$, while $P_{i \\to j}^{\\mathrm{DC}}(\\delta)$ only vanishes at $\\delta = 0$). The provided $E(\\delta)$ captures these deviations precisely for the specified parameters.",
            "answer": "$$\\boxed{5\\left(1-\\cos\\delta+\\sin\\delta\\right)-10\\,\\delta}$$"
        },
        {
            "introduction": "This final practice moves from analytical error to a crucial practical limitation of the DC approximation in system operations. You will use a computational approach to investigate scenarios where a transmission line is deemed safe by a DC-based screening tool but is actually overloaded according to AC physics. This exercise highlights the risk of ignoring reactive power ($Q$) and actual voltage magnitudes ($V$) when assessing thermal limits, demonstrating a key reason why results from DC Optimal Power Flow (OPF) require careful AC validation. ",
            "id": "4070069",
            "problem": "You are asked to formalize and evaluate, in purely mathematical and programmatic terms, a discrepancy between Direct Current optimal power flow (DC OPF) and Alternating Current optimal power flow (AC OPF) thermal screening. The objective is to decide, for a set of given line-end conditions, whether a line that is admissible under DC screening nonetheless violates its ampacity when evaluated under AC physics due to reactive current that is unrepresented in DC OPF.\n\nContext and fundamental base: Work in a per-unit system. Use the complex power identity from sinusoidal steady-state circuit theory that relates the complex power at a bus, the bus voltage phasor, and the current phasor, namely $S = P + jQ$ equals $V I^{\\ast}$. In a DC OPF screen, thermal constraints are often represented solely via real power magnitude limits derived from ampacity under a nominal voltage reference, whereas AC physics constrains the magnitude of current that depends on both real and reactive power and on actual voltage magnitude.\n\nAssumptions to encode: \n- DC admissibility at a monitored line end is declared when the absolute real power flow at that end, $\\lvert P \\rvert$, does not exceed the product of the line ampacity $I_{\\max}$ and a fixed reference voltage magnitude $V_{\\text{ref}}$ that DC OPF assumes, i.e., the DC screen uses $V = V_{\\text{ref}}$ and omits $Q$ by construction.\n- AC violation at the same line end is declared when the physical current magnitude implied by the complex power at that end, given the actual bus voltage magnitude, exceeds the ampacity $I_{\\max}$. Your computation of the current magnitude at the monitored end must be derived from the fundamental relationship between complex power, voltage, and current.\n\nYour task: For each test case, compute a boolean indicator that is true if and only if the line end is admissible under the DC screen but violates the AC ampacity, and false otherwise. Formally, return true if and only if both of the following hold simultaneously: ($1$) the DC screen declares admissible; ($2$) the AC current magnitude strictly exceeds the ampacity. You may treat strict exceedance with a negligible numerical tolerance in floating-point arithmetic if needed.\n\nUnits and inputs: All quantities are in per-unit (dimensionless). Angles are not required. Each test case is a tuple $(P, Q, V, I_{\\max}, V_{\\text{ref}})$ where:\n- $P$ is the real power flow at the monitored line end,\n- $Q$ is the reactive power flow at the monitored line end,\n- $V$ is the actual voltage magnitude at the monitored line end,\n- $I_{\\max}$ is the ampacity bound,\n- $V_{\\text{ref}}$ is the DC OPF voltage reference magnitude.\n\nTest suite to implement and evaluate:\n- Case $1$: $(0.80, 0.10, 1.00, 1.00, 1.00)$.\n- Case $2$: $(0.95, 0.30, 0.95, 1.00, 1.00)$.\n- Case $3$: $(0.98, 0.00, 1.05, 1.00, 1.00)$.\n- Case $4$ (boundary): $(1.00, 0.00, 1.00, 1.00, 1.00)$.\n- Case $5$ (low voltage, reactive-heavy): $(0.70, 0.80, 0.90, 1.00, 1.00)$.\n\nAlgorithmic requirements:\n- Use only the stated fundamental relationship between complex power, voltage, and current to compute the AC current magnitude from $(P, Q, V)$ at the monitored end.\n- Implement the DC screen using the stated rule relating $\\lvert P \\rvert$, $I_{\\max}$, and $V_{\\text{ref}}$.\n- For each case, output the boolean indicator defined above.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (e.g., $[ \\text{True}, \\text{False}, \\dots ]$). The order must correspond to Cases $1$ through $5$.",
            "solution": "The problem requires a formal analysis of the discrepancy between a simplified Direct Current (DC) screening model and a more accurate Alternating Current (AC) physical model for determining thermal violations on a transmission line. We are to construct a boolean indicator that identifies cases where the DC screen deems a line admissible, yet the AC model shows it to be in violation of its ampacity limit. All quantities are provided in a per-unit (p.u.) system.\n\nFirst, we formalize the condition for an AC thermal violation. The fundamental relationship in sinusoidal steady-state between complex power $S$, voltage phasor $V_{\\text{phasor}}$, and current phasor $I_{\\text{phasor}}$ at a bus is given by:\n$$S = V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}$$\nwhere $I_{\\text{phasor}}^{\\ast}$ is the complex conjugate of the current phasor. Complex power $S$ is composed of real power $P$ and reactive power $Q$, such that $S = P + jQ$.\n\nTo determine the current magnitude $|I_{\\text{phasor}}|$, we take the magnitude of both sides of the equation:\n$$|S| = |V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}|$$\nThe magnitude of the complex power is $|S| = \\sqrt{P^2 + Q^2}$. The magnitude of the voltage phasor, $|V_{\\text{phasor}}|$, is the given voltage magnitude, which we denote as $V$. We denote the AC current magnitude as $I_{AC} = |I_{\\text{phasor}}|$. Rearranging the equation yields the expression for the AC current magnitude:\n$$I_{AC} = \\frac{|S|}{V} = \\frac{\\sqrt{P^2 + Q^2}}{V}$$\nAn AC violation occurs when this physically accurate current magnitude strictly exceeds the line's ampacity, $I_{\\max}$. The condition is therefore:\n$$ (2) \\quad \\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max} $$\n\nNext, we formalize the DC screening model. This model is a simplification used in DC Optimal Power Flow (DC OPF) studies. It makes two key assumptions for thermal screening:\n1. Reactive power flow is negligible ($Q \\approx 0$).\n2. The voltage magnitude is constant and equal to a nominal reference value, typically $V_{\\text{ref}} = 1.0$ p.u.\n\nUnder these assumptions, the apparent power $|S| = \\sqrt{P^2+Q^2}$ is approximated by $|P|$. The DC model does not compute current directly but instead places a limit on the real power flow. As stated in the problem, a line end is declared admissible under the DC screen if the absolute value of real power flow, $|P|$, does not exceed the product of the ampacity $I_{\\max}$ and the reference voltage $V_{\\text{ref}}$. This condition is:\n$$ (1) \\quad |P| \\le I_{\\max} \\cdot V_{\\text{ref}} $$\n\nThe task is to find when a discrepancy occurs, specifically when the line is admissible by the DC screen but is in violation according to the AC physics. This corresponds to a logical conjunction of condition (1) being true and condition (2) being true. The boolean indicator must be `True` if and only if:\n$$ (|P| \\le I_{\\max} \\cdot V_{\\text{ref}}) \\land \\left(\\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max}\\right) $$\nOtherwise, the indicator is `False`.\n\nWe now apply these two conditions to each test case.\n\n**Case 1:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.80, 0.10, 1.00, 1.00, 1.00)$\n- DC Screen: Is $|0.80| \\le 1.00 \\cdot 1.00$? Yes, $0.80 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.80^2 + 0.10^2}}{1.00} = \\sqrt{0.64 + 0.01} = \\sqrt{0.65} \\approx 0.8062$. Is $0.8062 > 1.00$? No. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**.\n\n**Case 2:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.95, 0.30, 0.95, 1.00, 1.00)$\n- DC Screen: Is $|0.95| \\le 1.00 \\cdot 1.00$? Yes, $0.95 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.95^2 + 0.30^2}}{0.95} = \\frac{\\sqrt{0.9025 + 0.09}}{0.95} = \\frac{\\sqrt{0.9925}}{0.95} \\approx \\frac{0.99624}{0.95} \\approx 1.0487$. Is $1.0487 > 1.00$? Yes. Condition (2) is `True`.\n- Result: `True` $\\land$ `True` $\\implies$ **`True`**. This discrepancy arises because the reactive power and the depressed voltage ($V=0.95$) both contribute to a higher actual current than the DC screen anticipates.\n\n**Case 3:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.98, 0.00, 1.05, 1.00, 1.00)$\n- DC Screen: Is $|0.98| \\le 1.00 \\cdot 1.00$? Yes, $0.98 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.98^2 + 0.00^2}}{1.05} = \\frac{0.98}{1.05} \\approx 0.9333$. Is $0.9333 > 1.00$? No. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**. Here, the higher voltage ($V=1.05$) reduces the current required to transmit the same power, moving it further from the limit.\n\n**Case 4 (boundary):** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (1.00, 0.00, 1.00, 1.00, 1.00)$\n- DC Screen: Is $|1.00| \\le 1.00 \\cdot 1.00$? Yes, $1.00 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{1.00^2 + 0.00^2}}{1.00} = \\frac{1.00}{1.00} = 1.00$. Is $1.00 > 1.00$? No, the inequality is strict. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**. This case represents perfect alignment between the DC model's assumptions ($Q=0, V=V_{\\text{ref}}=1.0$) and reality.\n\n**Case 5 (low voltage, reactive-heavy):** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.70, 0.80, 0.90, 1.00, 1.00)$\n- DC Screen: Is $|0.70| \\le 1.00 \\cdot 1.00$? Yes, $0.70 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.70^2 + 0.80^2}}{0.90} = \\frac{\\sqrt{0.49 + 0.64}}{0.90} = \\frac{\\sqrt{1.13}}{0.90} \\approx \\frac{1.0630}{0.90} \\approx 1.1811$. Is $1.1811 > 1.00$? Yes. Condition (2) is `True`.\n- Result: `True` $\\land$ `True` $\\implies$ **`True`**. This is a pronounced example of discrepancy, driven by both significant reactive power and low voltage, which combine to create a high current for a seemingly modest real power flow.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the discrepancy between DC and AC thermal screening for a set of test cases.\n\n    For each case, it determines if a transmission line end is admissible under\n    a simplified DC power flow screen but violates its ampacity limit when evaluated\n    using a more accurate AC power flow model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (P, Q, V, I_max, V_ref)\n    # P: real power flow (p.u.)\n    # Q: reactive power flow (p.u.)\n    # V: actual voltage magnitude (p.u.)\n    # I_max: ampacity limit (p.u.)\n    # V_ref: reference voltage for DC screen (p.u.)\n    test_cases = [\n        (0.80, 0.10, 1.00, 1.00, 1.00),  # Case 1\n        (0.95, 0.30, 0.95, 1.00, 1.00),  # Case 2\n        (0.98, 0.00, 1.05, 1.00, 1.00),  # Case 3\n        (1.00, 0.00, 1.00, 1.00, 1.00),  # Case 4 (boundary)\n        (0.70, 0.80, 0.90, 1.00, 1.00),  # Case 5 (low voltage, reactive-heavy)\n    ]\n\n    results = []\n    for case in test_cases:\n        P, Q, V, I_max, V_ref = case\n\n        # Condition 1: Check for DC admissibility.\n        # The line is admissible if the absolute real power does not exceed\n        # the product of ampacity and the reference voltage.\n        is_dc_admissible = np.abs(P) <= I_max * V_ref\n\n        # Condition 2: Check for AC violation.\n        # First, calculate the AC current magnitude from complex power principles.\n        # S = V * I_conj => |S| = |V| * |I| => |I| = |S| / |V|\n        # |S| = sqrt(P^2 + Q^2)\n        # The problem provides the voltage magnitude V directly.\n        apparent_power_mag = np.sqrt(P**2 + Q**2)\n        ac_current_mag = apparent_power_mag / V\n        \n        # The AC violation occurs if the current magnitude strictly exceeds the ampacity limit.\n        is_ac_violated = ac_current_mag > I_max\n\n        # The discrepancy boolean is True if and only if the line is admissible\n        # under the DC screen AND is violated under the AC model.\n        discrepancy_found = is_dc_admissible and is_ac_violated\n        results.append(str(discrepancy_found))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}