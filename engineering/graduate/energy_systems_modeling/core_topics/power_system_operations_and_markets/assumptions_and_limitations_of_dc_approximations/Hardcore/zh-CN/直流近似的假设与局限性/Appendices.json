{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们首先要巩固直流潮流近似法的基本计算方法。这个练习将指导你为一个简单的网络构建节点导纳矩阵（$B$ 矩阵），并求解核心线性方程 $P = B\\theta$ 以获得节点电压相角。掌握这一过程  至关重要，因为它构成了直流潮流近似法在电力系统分析中几乎所有应用的基础。",
            "id": "4070063",
            "problem": "一个四母线输电网络在标幺 (pu) 系统内，采用直流 (DC) 潮流近似法运行。母线编号为 $1$ 到 $4$，三条线路呈放射状链式连接，其串联电抗如下：线路 $\\{1,2\\}$ 的电抗为 $X_{12}=0.2$ pu，线路 $\\{2,3\\}$ 的电抗为 $X_{23}=0.1$ pu，线路 $\\{3,4\\}$ 的电抗为 $X_{34}=0.15$ pu。假设没有并联元件，线路电阻可忽略不计，母线电压幅值接近 $1$ pu，相角差很小，且网络处于平衡稳态。母线的有功功率注入（净发电为正，净负荷为负）由向量 $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]$ pu 指定。母线 $1$ 是相角参考点（平衡节点），其电压相角固定为 $0$ 弧度。\n\n从交流潮流的基本原理和节点有功功率平衡出发，应用直流近似假设，推导该网络的母线电纳矩阵 $B$。然后，施加平衡节点相角条件，求解满足直流近似下节点有功功率平衡的母线电压相角 $\\theta=[\\theta_{1},\\theta_{2},\\theta_{3},\\theta_{4}]$。\n\n将最终答案表示为母线电压相角 $\\theta$ 的行向量，单位为弧度，并将每个非零项四舍五入至四位有效数字。相角仅以弧度表示。",
            "solution": "该问题要求在直流 (DC) 潮流近似下，确定一个四母线电力系统的母线电压相角。求解过程分三个阶段：首先，从交流潮流原理推导控制方程；其次，为给定网络构建母线电纳矩阵 ($B$)；最后，求解得到的线性方程组以获得未知的电压相角。\n\n### 第一步：直流潮流模型的推导\n\n在交流输电线路中，从母线 $i$ 到母线 $k$ 的有功潮流 $P_{ik}$ 由下式给出：\n$$ P_{ik} = \\frac{|V_i| |V_k|}{X_{ik}} \\sin(\\theta_i - \\theta_k) $$\n其中 $|V_i|$ 和 $|V_k|$ 分别是母线 $i$ 和母线 $k$ 的电压幅值，$\\theta_i$ 和 $\\theta_k$ 是母线电压相角，$X_{ik}$ 是连接它们的线路的串联电抗。假设线路电阻可以忽略。\n\n直流潮流近似依赖于以下假设：\n1.  所有母线电压幅值约等于 $1.0$ 标幺 (pu)，即对所有 $i$ 都有 $|V_i| \\approx 1.0$。\n2.  任意两个相连母线之间的电压相角差很小，这允许使用近似 $\\sin(\\theta_i - \\theta_k) \\approx (\\theta_i - \\theta_k)$，其中相角单位为弧度。\n\n将这些假设应用于交流潮流方程，可将其简化为直流潮流方程：\n$$ P_{ik} \\approx \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\n母线 $i$ 的净有功功率注入 $P_i$ 是离开该母线的所有相连线路上潮流的总和。\n$$ P_i = \\sum_{k \\in \\mathcal{N}_i} P_{ik} = \\sum_{k \\in \\mathcal{N}_i} \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\n其中 $\\mathcal{N}_i$ 是与母线 $i$ 直接相连的母线集合。\n\n这个节点功率平衡方程组可以用矩阵形式表示为 $P = B\\theta$，其中 $P$ 是母线功率注入向量，$\\theta$ 是母线电压相角向量，$B$ 是母线电纳矩阵。母线电纳矩阵 $B$ 的元素定义如下：\n- 非对角元素 ($i \\neq k$): $B_{ik} = -b_{ik}$，其中如果 $i$ 和 $k$ 之间存在线路，则 $b_{ik} = 1/X_{ik}$，否则 $B_{ik}=0$。\n- 对角元素 ($i = k$): $B_{ii} = \\sum_{k \\neq i} b_{ik}$，即连接到母线 $i$ 的所有线路的电纳之和。\n\n### 第二步：构建母线电纳矩阵 $B$\n\n给定网络有三条线路，其电抗如下：$X_{12}=0.2$ pu, $X_{23}=0.1$ pu, and $X_{34}=0.15$ pu。相应的线路电纳为：\n- $b_{12} = \\frac{1}{X_{12}} = \\frac{1}{0.2} = 5$ pu。\n- $b_{23} = \\frac{1}{X_{23}} = \\frac{1}{0.1} = 10$ pu。\n- $b_{34} = \\frac{1}{X_{34}} = \\frac{1}{0.15} = \\frac{1}{15/100} = \\frac{100}{15} = \\frac{20}{3}$ pu。\n\n使用这些值，我们构建 $4 \\times 4$ 的母线电纳矩阵 $B$：\n- $B_{11} = b_{12} = 5$\n- $B_{22} = b_{12} + b_{23} = 5 + 10 = 15$\n- $B_{33} = b_{23} + b_{34} = 10 + \\frac{20}{3} = \\frac{30+20}{3} = \\frac{50}{3}$\n- $B_{44} = b_{34} = \\frac{20}{3}$\n- $B_{12} = B_{21} = -b_{12} = -5$\n- $B_{23} = B_{32} = -b_{23} = -10$\n- $B_{34} = B_{43} = -b_{34} = -\\frac{20}{3}$\n所有其他非对角元素均为 $0$，因为没有其他直接连接。\n\n完整的母线电纳矩阵是：\n$$ B = \\begin{pmatrix} 5  & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} $$\n\n### 第三步：求解母线电压相角\n\n方程组为 $P = B\\theta$。给定功率注入 $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]^T$ 和母线相角 $\\theta=[\\theta_1,\\,\\theta_2,\\,\\theta_3,\\,\\theta_4]^T$：\n$$ \\begin{pmatrix} P_1 \\\\ P_2 \\\\ P_3 \\\\ P_4 \\end{pmatrix} = \\begin{pmatrix} 5  & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\n母线 $1$ 是平衡节点，提供相角参考。因此，其相角是固定的：$\\theta_1 = 0$ 弧度。这个条件消除了系统中的线性相关性。平衡节点的方程（第一行）从待解方程组中移除，因为 $P_1$ 是平衡系统的因变量。已知变量为 $P_2=0.2$, $P_3=-0.3$, 和 $P_4=-0.3$。我们可以为未知相角 $\\theta_2$, $\\theta_3$, 和 $\\theta_4$ 建立一个降维的方程组。\n我们使用矩阵方程的第 $2$、$3$ 和 $4$ 行。设 $\\theta_1 = 0$：\n$$ \\begin{pmatrix} 0.2 \\\\ -0.3 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 15  & -10 & 0 \\\\ -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\n这构成了一个包含三个线性方程的方程组：\n1. $15\\theta_2 - 10\\theta_3 = 0.2$\n2. $-10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}\\theta_4 = -0.3$\n3. $-\\frac{20}{3}\\theta_3 + \\frac{20}{3}\\theta_4 = -0.3$\n\n我们从最后一个方程开始，通过代入法求解这个方程组。\n由方程 (3) 得：\n$$ \\frac{20}{3}(\\theta_4 - \\theta_3) = -0.3 $$\n$$ \\theta_4 - \\theta_3 = -0.3 \\times \\frac{3}{20} = -\\frac{0.9}{20} = -0.045 $$\n$$ \\theta_4 = \\theta_3 - 0.045 $$\n将 $\\theta_4$ 的这个表达式代入方程 (2)：\n$$ -10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}(\\theta_3 - 0.045) = -0.3 $$\n$$ -10\\theta_2 + \\frac{50-20}{3}\\theta_3 + \\frac{20 \\times 0.045}{3} = -0.3 $$\n$$ -10\\theta_2 + \\frac{30}{3}\\theta_3 + \\frac{0.9}{3} = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 + 0.3 = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 = -0.6 $$\n两边除以 $10$ 得：\n$$ -\\theta_2 + \\theta_3 = -0.06 \\implies \\theta_3 = \\theta_2 - 0.06 $$\n最后，将 $\\theta_3$ 的这个表达式代入方程 (1)：\n$$ 15\\theta_2 - 10(\\theta_2 - 0.06) = 0.2 $$\n$$ 15\\theta_2 - 10\\theta_2 + 0.6 = 0.2 $$\n$$ 5\\theta_2 = 0.2 - 0.6 = -0.4 $$\n$$ \\theta_2 = -\\frac{0.4}{5} = -0.08 $$\n现在，我们回代以求出剩余的相角：\n$$ \\theta_3 = \\theta_2 - 0.06 = -0.08 - 0.06 = -0.14 $$\n$$ \\theta_4 = \\theta_3 - 0.045 = -0.14 - 0.045 = -0.185 $$\n母线电压相角向量（单位为弧度）为 $\\theta = [\\theta_1, \\theta_2, \\theta_3, \\theta_4] = [0, -0.08, -0.14, -0.185]$。\n\n题目要求将每个非零项四舍五入至四位有效数字。\n- $\\theta_2 = -0.08 \\rightarrow -0.08000$\n- $\\theta_3 = -0.14 \\rightarrow -0.1400$\n- $\\theta_4 = -0.185 \\rightarrow -0.1850$\n\n最终的母线电压相角向量为 $\\theta = [0, -0.08000, -0.1400, -0.1850]$ 弧度。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  & -0.08000 & -0.1400 & -0.1850 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在练习了基本应用之后，我们现在转向对其背后假设的严格审视。本练习要求你推导精确的交流潮流表达式，并将其与直流近似值进行直接比较，从而揭示不可忽略的线路电阻（$R$）所带来的影响。通过推导解析误差函数 ，你将从数学上精确地理解直流模型在何种情况下以及为何会偏离物理现实。",
            "id": "4070075",
            "problem": "考虑一个双母线交流（AC）电力系统，其中母线 $i$ 和 $j$ 通过一条串联支路连接，该支路的阻抗为 $Z = R + jX$，单位为标幺值（pu）。假设没有并联元件，也没有变压器非额定抽头比。复数母线电压为 $V_{i} = |V_{i}| \\exp(j \\theta_{i})$ 和 $V_{j} = |V_{j}| \\exp(j \\theta_{j})$，其幅值相等，即 $|V_{i}| = |V_{j}| = 1$ pu，相角差为 $\\delta \\equiv \\theta_{i} - \\theta_{j}$（使用弧度）。设 $R = 0.1$ pu 且 $X = 0.1$ pu。\n\n仅从相量形式的欧姆定律和复功率的定义出发，推导从母线 $i$ 流向母线 $j$ 的有功功率的精确闭式表达式，记为 $P_{i \\to j}^{\\mathrm{AC}}(\\delta)$，该表达式是关于 $\\delta$、$R$ 和 $X$ 的函数。然后，将其与在小相角差、可忽略电阻和平坦电压幅值假设下常用的直流（DC）潮流近似公式 $P_{i \\to j}^{\\mathrm{DC}}(\\delta) \\approx (\\theta_{i} - \\theta_{j})/X$ 进行对比。\n\n定义有符号误差函数\n$$E(\\delta) \\equiv P_{i \\to j}^{\\mathrm{AC}}(\\delta) - P_{i \\to j}^{\\mathrm{DC}}(\\delta)。$$\n针对给定的数值参数 $R = 0.1$ pu 和 $X = 0.1$ pu，明确给出 $E(\\delta)$ 的表达式。您的最终答案必须是一个仅含 $\\delta$ 的单一闭式解析表达式。最终结果以标幺值（pu）表示，并对 $\\delta$ 使用弧度。无需进行四舍五入。",
            "solution": "我们从基本电路和功率定义开始。连接母线 $i$ 和 $j$ 的串联支路的阻抗为 $Z = R + jX$，其导纳为\n$$y \\equiv \\frac{1}{Z} = \\frac{1}{R + jX} = \\frac{R - jX}{R^{2} + X^{2}}。$$\n为方便起见，将 $y$ 写成实部和虚部的形式。通过以下方式定义电导 $g$ 和一个正常数 $\\beta$\n$$g \\equiv \\frac{R}{R^{2} + X^{2}}, \\qquad \\beta \\equiv \\frac{X}{R^{2} + X^{2}},$$\n因此\n$$y = g - j \\beta, \\qquad y^{*} = g + j \\beta。$$\n\n设母线电压为 $V_{i} = \\exp(j \\theta_{i})$ 和 $V_{j} = \\exp(j \\theta_{j})$，因为 $|V_{i}| = |V_{j}| = 1$ pu。从 $i$ 到 $j$ 的串联支路电流由相量形式的欧姆定律确定：\n$$I_{ij} = y (V_{i} - V_{j})。$$\n从 $i$ 流向 $j$ 的复功率为\n$$S_{i \\to j} = V_{i} I_{ij}^{*} = V_{i} \\left[y^{*} \\left(V_{i}^{*} - V_{j}^{*} \\right) \\right] = y^{*} \\left(V_{i} V_{i}^{*} - V_{i} V_{j}^{*} \\right)。$$\n当 $|V_{i}| = 1$ 时，我们有 $V_{i} V_{i}^{*} = 1$；当 $\\delta \\equiv \\theta_{i} - \\theta_{j}$ 时，我们有 $V_{i} V_{j}^{*} = \\exp(j \\delta)$。因此，\n$$S_{i \\to j} = y^{*} \\left(1 - \\exp(j \\delta) \\right)。$$\n有功潮流是 $S_{i \\to j}$ 的实部：\n$$P_{i \\to j}^{\\mathrm{AC}}(\\delta) = \\Re \\left\\{ y^{*} \\left(1 - \\exp(j \\delta) \\right) \\right\\}。$$\n使用 $\\exp(j \\delta) = \\cos \\delta + j \\sin \\delta$ 和 $y^{*} = g + j \\beta$，我们得到\n\\begin{align*}\nP_{i \\to j}^{\\mathrm{AC}}(\\delta)\n&= \\Re \\left\\{ (g + j \\beta) \\left(1 - \\cos \\delta - j \\sin \\delta \\right) \\right\\} \\\\\n&= \\Re \\left\\{ g(1 - \\cos \\delta) - j g \\sin \\delta + j \\beta (1 - \\cos \\delta) + \\beta \\sin \\delta \\right\\} \\\\\n&= g (1 - \\cos \\delta) + \\beta \\sin \\delta.\n\\end{align*}\n这就是在电压幅值相等且无并联元件的情况下，单条串联支路的精确交流有功潮流，它通过 $g$ 和 $\\beta$ 以 $R$、$X$ 和 $\\delta$ 表示。\n\n接下来，在小相角、可忽略电阻和单位电压幅值的条件下，直流（DC）潮流近似为\n$$P_{i \\to j}^{\\mathrm{DC}}(\\delta) \\approx \\frac{\\delta}{X}。$$\n我们现在构建有符号误差函数\n$$E(\\delta) \\equiv P_{i \\to j}^{\\mathrm{AC}}(\\delta) - P_{i \\to j}^{\\mathrm{DC}}(\\delta) = g (1 - \\cos \\delta) + \\beta \\sin \\delta - \\frac{\\delta}{X}。$$\n\n对于给定的参数 $R = 0.1$ pu 和 $X = 0.1$ pu，我们有\n$$R^{2} + X^{2} = (0.1)^{2} + (0.1)^{2} = 0.01 + 0.01 = 0.02,$$\n因此\n$$g = \\frac{0.1}{0.02} = 5, \\qquad \\beta = \\frac{0.1}{0.02} = 5, \\qquad \\frac{1}{X} = \\frac{1}{0.1} = 10。$$\n将这些值代入误差表达式，得到\n\\begin{align*}\nE(\\delta)\n&= 5 (1 - \\cos \\delta) + 5 \\sin \\delta - 10 \\delta \\\\\n&= 5 \\left(1 - \\cos \\delta + \\sin \\delta \\right) - 10 \\delta.\n\\end{align*}\n\n这个解析表达式量化了幅值和符号上的差异。在直流假设下（$R \\to 0$，小 $|\\delta|$），精确的交流潮流简化为 $P_{i \\to j}^{\\mathrm{AC}}(\\delta) \\approx \\beta \\sin \\delta \\approx \\frac{\\delta}{X}$，从而恢复了直流公式。然而，当如此处一样 $R$ 与 $X$ 相当时，项 $g (1 - \\cos \\delta)$ 引入了一个在直流模型中不存在的关于 $\\delta$ 的偶函数分量，这对于中等大小的 $|\\delta|$ 会导致显著的幅值误差，并对于足够大的负 $\\delta$ 可能导致符号差异（例如，当 $R = X$ 时，$P_{i \\to j}^{\\mathrm{AC}}(\\delta)$ 在 $\\delta = 0$ 和 $\\delta = -\\pi/2$ 处为零，而 $P_{i \\to j}^{\\mathrm{DC}}(\\delta)$ 仅在 $\\delta = 0$ 处为零）。所给出的 $E(\\delta)$ 精确地捕捉了在指定参数下产生的这些偏差。",
            "answer": "$$\\boxed{5\\left(1-\\cos\\delta+\\sin\\delta\\right)-10\\,\\delta}$$"
        },
        {
            "introduction": "我们最后的练习将展示直流潮流近似法局限性的一个关键现实后果。在运行规划中，直流模型常用于快速筛选热极限，但这可能导致危险的误判。此问题  要求你形式化并识别这样一种情景：一条线路在基于有功功率的直流校核下看似安全，但由于直流模型忽略了无功功率（$Q$）和电压偏移（$V$），实际上其电流超过了热容限（ampacity）。",
            "id": "4070069",
            "problem": "要求您以纯数学和编程术语，对直流最优潮流（DC OPF）和交流最优潮流（AC OPF）的热校核之间的差异进行形式化和评估。目标是针对一组给定的线路末端条件，判断一条在直流校核下被视为允许的线路，是否会因直流最优潮流中未计入的无功电流，而在交流物理模型下评估时，违反其载流量限制。\n\n背景和基本原理：在标幺制下进行计算。使用正弦稳态电路理论中的复功率恒等式，该恒等式关联了母线上的复功率、母线电压相量和电流相量，即 $S = P + \\mathbf{j}Q = V I^{\\ast}$。在直流最优潮流校核中，热约束通常仅通过有功功率幅值限制来表示，该限制是根据标称参考电压下的载流量推导出来的；而交流物理模型则约束了电流的幅值，该电流幅值取决于有功功率、无功功率以及实际电压幅值。\n\n需要编码的假设：\n- 当被监测线路末端的有功功率绝对值 $\\lvert P \\rvert$ 不超过线路载流量 $I_{\\max}$ 与直流最优潮流所假设的固定参考电压幅值 $V_{\\text{ref}}$ 的乘积时，宣告该线路末端在直流模型下是允许的。即，直流校核在构造上使用 $V = V_{\\text{ref}}$ 并忽略 $Q$。\n- 当给定实际母线电压幅值时，由该线路末端复功率所隐含的物理电流幅值超过载流量 $I_{\\max}$ 时，宣告同一线路末端在交流模型下违规。您计算被监测末端电流幅值时，必须从复功率、电压和电流之间的基本关系推导得出。\n\n您的任务：针对每个测试用例，计算一个布尔指标。当且仅当线路末端在直流校核下是允许的，但违反了交流载流量限制时，该指标为真，否则为假。形式上，当且仅当以下两条同时成立时返回真：($1$) 直流校核宣告允许；($2$) 交流电流幅值严格超过载流量。如果需要，您可以在浮点数运算中使用可忽略的数值容差来处理严格超过的情况。\n\n单位和输入：所有量均为标幺值（无量纲）。角度不是必需的。每个测试用例是一个元组 $(P, Q, V, I_{\\max}, V_{\\text{ref}})$，其中：\n- $P$ 是被监测线路末端的有功功率潮流，\n- $Q$ 是被监测线路末端的无功功率潮流，\n- $V$ 是被监测线路末端的实际电压幅值，\n- $I_{\\max}$ 是载流量上限，\n- $V_{\\text{ref}}$ 是直流最优潮流的参考电压幅值。\n\n需要实现和评估的测试套件：\n- 用例 $1$：$(0.80, 0.10, 1.00, 1.00, 1.00)$。\n- 用例 $2$：$(0.95, 0.30, 0.95, 1.00, 1.00)$。\n- 用例 $3$：$(0.98, 0.00, 1.05, 1.00, 1.00)$。\n- 用例 $4$ (边界)：$(1.00, 0.00, 1.00, 1.00, 1.00)$。\n- 用例 $5$ (低电压、重无功)：$(0.70, 0.80, 0.90, 1.00, 1.00)$。\n\n算法要求：\n- 仅使用所述的复功率、电压和电流之间的基本关系，根据被监测末端的 $(P, Q, V)$ 计算交流电流幅值。\n- 使用所述的关联 $\\lvert P \\rvert$、$I_{\\max}$ 和 $V_{\\text{ref}}$ 的规则来实现直流校核。\n- 对每个用例，输出上文定义的布尔指标。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的布尔值列表（例如，$[ \\text{True}, \\text{False}, \\dots ]$）。顺序必须与用例 $1$ 到 $5$ 相对应。",
            "solution": "该问题要求对用于确定输电线路热违规的简化直流（DC）校核模型与更精确的交流（AC）物理模型之间的差异进行形式化分析。我们需要构建一个布尔指标，以识别出直流校核认为线路允许，而交流模型显示其违反载流量限制的情况。所有量均以标幺（p.u.）制提供。\n\n首先，我们形式化交流热违规的条件。在正弦稳态下，母线上的复功率 $S$、电压相量 $V_{\\text{phasor}}$ 和电流相量 $I_{\\text{phasor}}$ 之间的基本关系由下式给出：\n$$S = V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}$$\n其中 $I_{\\text{phasor}}^{\\ast}$ 是电流相量的复共轭。复功率 $S$ 由有功功率 $P$ 和无功功率 $Q$ 组成，即 $S = P + \\mathbf{j}Q$。\n\n为了确定电流幅值 $|I_{\\text{phasor}}|$，我们对等式两边取幅值：\n$$|S| = |V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}|$$\n复功率的幅值为 $|S| = \\sqrt{P^2 + Q^2}$。电压相量的幅值 $|V_{\\text{phasor}}|$ 是给定的电压幅值，我们记为 $V$。我们将交流电流幅值记为 $I_{AC} = |I_{\\text{phasor}}|$。整理该方程可得交流电流幅值的表达式：\n$$I_{AC} = \\frac{|S|}{V} = \\frac{\\sqrt{P^2 + Q^2}}{V}$$\n当这个物理上精确的电流幅值严格超过线路的载流量 $I_{\\max}$ 时，发生交流违规。因此，条件是：\n$$ (2) \\quad \\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max} $$\n\n接下来，我们形式化直流校核模型。该模型是直流最优潮流（DC OPF）研究中使用的一种简化方法。它对热校核做了两个关键假设：\n1. 无功功率潮流可忽略不计 ($Q \\approx 0$)。\n2. 电压幅值是恒定的，等于一个标称参考值，通常为 $V_{\\text{ref}} = 1.0$ p.u.。\n\n在这些假设下，视在功率 $|S| = \\sqrt{P^2+Q^2}$ 被近似为 $|P|$。直流模型不直接计算电流，而是对有功功率潮流设置一个限制。如问题所述，如果被监测线路末端的有功功率绝对值 $|P|$ 不超过载流量 $I_{\\max}$ 与参考电压 $V_{\\text{ref}}$ 的乘积，则宣告该线路末端在直流校核下是允许的。该条件是：\n$$ (1) \\quad |P| \\le I_{\\max} \\cdot V_{\\text{ref}} $$\n\n任务是找出何时出现差异，具体来说，就是当线路在直流校核下是允许的，但根据交流物理模型却处于违规状态。这对应于条件 (1) 为真且条件 (2) 为真的逻辑与。当且仅当以下条件成立时，布尔指标必须为 `True`：\n$$ (|P| \\le I_{\\max} \\cdot V_{\\text{ref}}) \\land \\left(\\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max}\\right) $$\n否则，指标为 `False`。\n\n现在我们将这两个条件应用于每个测试用例。\n\n**用例 1：** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.80, 0.10, 1.00, 1.00, 1.00)$\n- 直流校核：是否 $|0.80| \\le 1.00 \\cdot 1.00$？是，$0.80 \\le 1.00$。条件 (1) 为 `True`。\n- 交流违规：$I_{AC} = \\frac{\\sqrt{0.80^2 + 0.10^2}}{1.00} = \\sqrt{0.64 + 0.01} = \\sqrt{0.65} \\approx 0.8062$。是否 $0.8062 > 1.00$？否。条件 (2) 为 `False`。\n- 结果：`True` $\\land$ `False` $\\implies$ **`False`**。\n\n**用例 2：** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.95, 0.30, 0.95, 1.00, 1.00)$\n- 直流校核：是否 $|0.95| \\le 1.00 \\cdot 1.00$？是，$0.95 \\le 1.00$。条件 (1) 为 `True`。\n- 交流违规：$I_{AC} = \\frac{\\sqrt{0.95^2 + 0.30^2}}{0.95} = \\frac{\\sqrt{0.9025 + 0.09}}{0.95} = \\frac{\\sqrt{0.9925}}{0.95} \\approx \\frac{0.99624}{0.95} \\approx 1.0487$。是否 $1.0487 > 1.00$？是。条件 (2) 为 `True`。\n- 结果：`True` $\\land$ `True` $\\implies$ **`True`**。出现这种差异是因为无功功率和降低的电压 ($V=0.95$) 共同导致实际电流高于直流校核所预期的值。\n\n**用例 3：** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.98, 0.00, 1.05, 1.00, 1.00)$\n- 直流校核：是否 $|0.98| \\le 1.00 \\cdot 1.00$？是，$0.98 \\le 1.00$。条件 (1) 为 `True`。\n- 交流违规：$I_{AC} = \\frac{\\sqrt{0.98^2 + 0.00^2}}{1.05} = \\frac{0.98}{1.05} \\approx 0.9333$。是否 $0.9333 > 1.00$？否。条件 (2) 为 `False`。\n- 结果：`True` $\\land$ `False` $\\implies$ **`False`**。在这里，较高的电压 ($V=1.05$) 降低了传输相同功率所需的电流，使其离限值更远。\n\n**用例 4 (边界)：** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (1.00, 0.00, 1.00, 1.00, 1.00)$\n- 直流校核：是否 $|1.00| \\le 1.00 \\cdot 1.00$？是，$1.00 \\le 1.00$。条件 (1) 为 `True`。\n- 交流违规：$I_{AC} = \\frac{\\sqrt{1.00^2 + 0.00^2}}{1.00} = \\frac{1.00}{1.00} = 1.00$。是否 $1.00 > 1.00$？否，不等式是严格的。条件 (2) 为 `False`。\n- 结果：`True` $\\land$ `False` $\\implies$ **`False`**。这个用例代表了直流模型的假设（$Q=0, V=V_{\\text{ref}}=1.0$）与实际情况完全一致。\n\n**用例 5 (低电压、重无功)：** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.70, 0.80, 0.90, 1.00, 1.00)$\n- 直流校核：是否 $|0.70| \\le 1.00 \\cdot 1.00$？是，$0.70 \\le 1.00$。条件 (1) 为 `True`。\n- 交流违规：$I_{AC} = \\frac{\\sqrt{0.70^2 + 0.80^2}}{0.90} = \\frac{\\sqrt{0.49 + 0.64}}{0.90} = \\frac{\\sqrt{1.13}}{0.90} \\approx \\frac{1.0630}{0.90} \\approx 1.1811$。是否 $1.1811 > 1.00$？是。条件 (2) 为 `True`。\n- 结果：`True` $\\land$ `True` $\\implies$ **`True`**。这是一个显著的差异示例，由显著的无功功率和低电压共同驱动，这两者结合在一起，对于一个看起来不大的有功功率潮流，却产生了很高的电流。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the discrepancy between DC and AC thermal screening for a set of test cases.\n\n    For each case, it determines if a transmission line end is admissible under\n    a simplified DC power flow screen but violates its ampacity limit when evaluated\n    using a more accurate AC power flow model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (P, Q, V, I_max, V_ref)\n    # P: real power flow (p.u.)\n    # Q: reactive power flow (p.u.)\n    # V: actual voltage magnitude (p.u.)\n    # I_max: ampacity limit (p.u.)\n    # V_ref: reference voltage for DC screen (p.u.)\n    test_cases = [\n        (0.80, 0.10, 1.00, 1.00, 1.00),  # Case 1\n        (0.95, 0.30, 0.95, 1.00, 1.00),  # Case 2\n        (0.98, 0.00, 1.05, 1.00, 1.00),  # Case 3\n        (1.00, 0.00, 1.00, 1.00, 1.00),  # Case 4 (boundary)\n        (0.70, 0.80, 0.90, 1.00, 1.00),  # Case 5 (low voltage, reactive-heavy)\n    ]\n\n    results = []\n    for case in test_cases:\n        P, Q, V, I_max, V_ref = case\n\n        # Condition 1: Check for DC admissibility.\n        # The line is admissible if the absolute real power does not exceed\n        # the product of ampacity and the reference voltage.\n        is_dc_admissible = np.abs(P) <= I_max * V_ref\n\n        # Condition 2: Check for AC violation.\n        # First, calculate the AC current magnitude from complex power principles.\n        # S = V * I_conj => |S| = |V| * |I| => |I| = |S| / |V|\n        # |S| = sqrt(P^2 + Q^2)\n        # The problem provides the voltage magnitude V directly.\n        apparent_power_mag = np.sqrt(P**2 + Q**2)\n        ac_current_mag = apparent_power_mag / V\n        \n        # The AC violation occurs if the current magnitude strictly exceeds the ampacity limit.\n        is_ac_violated = ac_current_mag > I_max\n\n        # The discrepancy boolean is True if and only if the line is admissible\n        # under the DC screen AND is violated under the AC model.\n        discrepancy_found = is_dc_admissible and is_ac_violated\n        results.append(str(discrepancy_found))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}