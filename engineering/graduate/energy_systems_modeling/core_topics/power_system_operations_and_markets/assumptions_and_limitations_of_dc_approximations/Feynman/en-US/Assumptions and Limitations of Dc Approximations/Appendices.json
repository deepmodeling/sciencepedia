{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides foundational practice in applying the DC power flow approximation. You will construct the bus susceptance matrix, $B$, a cornerstone of linearized network modeling, and solve for the bus voltage angles in a simple radial network. Mastering this process  is essential as it forms the computational core of many large-scale energy system optimization and analysis tools.",
            "id": "4070063",
            "problem": "A four-bus transmission network is operated under the Direct Current (DC) power flow approximation within the per-unit (pu) system. Buses are labeled $1$ through $4$, with the following series reactances on the three lines in a radial chain: line $\\{1,2\\}$ has $X_{12}=0.2$ pu, line $\\{2,3\\}$ has $X_{23}=0.1$ pu, and line $\\{3,4\\}$ has $X_{34}=0.15$ pu. Assume there are no shunt elements, line resistances are negligible, bus voltage magnitudes are close to $1$ pu, angle differences are small, and the network is balanced and steady-state. Active power injections (positive for net generation, negative for net load) at the buses are specified as the vector $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]$ pu. Bus $1$ is the angle reference (slack) with voltage angle fixed at $0$ radians.\n\nStarting from alternating current power flow fundamentals and the nodal active power balance, and applying the DC approximation assumptions, derive the bus susceptance matrix $B$ for this network. Then, enforce the slack angle condition and solve for the bus voltage angles $\\theta=[\\theta_{1},\\theta_{2},\\theta_{3},\\theta_{4}]$ that satisfy the nodal active power balance under the DC approximation.\n\nExpress the final answer as the row vector of bus voltage angles $\\theta$ in radians, and round each nonzero entry to four significant figures. State angles in radians only.",
            "solution": "The problem requires the determination of bus voltage angles in a four-bus power system under the Direct Current (DC) power flow approximation. The solution proceeds in three stages: first, deriving the governing equations from AC power flow principles; second, constructing the bus susceptance matrix ($B$) for the given network; and third, solving the resulting system of linear equations for the unknown voltage angles.\n\n### Step 1: Derivation of the DC Power Flow Model\n\nThe active power flow $P_{ik}$ from bus $i$ to bus $k$ in an AC transmission line is given by:\n$$ P_{ik} = \\frac{|V_i| |V_k|}{X_{ik}} \\sin(\\theta_i - \\theta_k) $$\nwhere $|V_i|$ and $|V_k|$ are the voltage magnitudes at bus $i$ and bus $k$, respectively, $\\theta_i$ and $\\theta_k$ are the bus voltage angles, and $X_{ik}$ is the series reactance of the line connecting them. Line resistance is assumed to be negligible.\n\nThe DC power flow approximation relies on the following assumptions:\n1.  All bus voltage magnitudes are approximately $1.0$ per unit (pu), i.e., $|V_i| \\approx 1.0$ for all $i$.\n2.  The voltage angle difference between any two connected buses is small, which allows for the approximation $\\sin(\\theta_i - \\theta_k) \\approx (\\theta_i - \\theta_k)$, where the angles are in radians.\n\nApplying these assumptions to the AC power flow equation simplifies it to the DC power flow equation:\n$$ P_{ik} \\approx \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\nThe net active power injection $P_i$ at a bus $i$ is the sum of the power flows leaving the bus on all lines connected to it.\n$$ P_i = \\sum_{k \\in \\mathcal{N}_i} P_{ik} = \\sum_{k \\in \\mathcal{N}_i} \\frac{1}{X_{ik}} (\\theta_i - \\theta_k) $$\nwhere $\\mathcal{N}_i$ is the set of buses directly connected to bus $i$.\n\nThis system of nodal power balance equations can be expressed in matrix form as $P = B\\theta$, where $P$ is the vector of bus power injections, $\\theta$ is the vector of bus voltage angles, and $B$ is the bus susceptance matrix. The elements of the bus susceptance matrix $B$ are defined as:\n- Off-diagonal elements ($i \\neq k$): $B_{ik} = -b_{ik}$, where $b_{ik} = 1/X_{ik}$ if a line exists between $i$ and $k$, and $B_{ik}=0$ otherwise.\n- Diagonal elements ($i = k$): $B_{ii} = \\sum_{k \\neq i} b_{ik}$, the sum of the susceptances of all lines connected to bus $i$.\n\n### Step 2: Construction of the Bus Susceptance Matrix $B$\n\nThe given network has three lines with the following reactances: $X_{12}=0.2$ pu, $X_{23}=0.1$ pu, and $X_{34}=0.15$ pu. The corresponding line susceptances are:\n- $b_{12} = \\frac{1}{X_{12}} = \\frac{1}{0.2} = 5$ pu.\n- $b_{23} = \\frac{1}{X_{23}} = \\frac{1}{0.1} = 10$ pu.\n- $b_{34} = \\frac{1}{X_{34}} = \\frac{1}{0.15} = \\frac{1}{15/100} = \\frac{100}{15} = \\frac{20}{3}$ pu.\n\nUsing these values, we construct the $4 \\times 4$ bus susceptance matrix $B$:\n- $B_{11} = b_{12} = 5$\n- $B_{22} = b_{12} + b_{23} = 5 + 10 = 15$\n- $B_{33} = b_{23} + b_{34} = 10 + \\frac{20}{3} = \\frac{30+20}{3} = \\frac{50}{3}$\n- $B_{44} = b_{34} = \\frac{20}{3}$\n- $B_{12} = B_{21} = -b_{12} = -5$\n- $B_{23} = B_{32} = -b_{23} = -10$\n- $B_{34} = B_{43} = -b_{34} = -\\frac{20}{3}$\nAll other off-diagonal elements are $0$ as there are no other direct connections.\n\nThe full bus susceptance matrix is:\n$$ B = \\begin{pmatrix} 5 & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} $$\n\n### Step 3: Solving for Bus Voltage Angles\n\nThe system of equations is $P = B\\theta$. With the given power injections $P=[0.4,\\,0.2,\\,-0.3,\\,-0.3]^T$ and bus angles $\\theta=[\\theta_1,\\,\\theta_2,\\,\\theta_3,\\,\\theta_4]^T$:\n$$ \\begin{pmatrix} P_1 \\\\ P_2 \\\\ P_3 \\\\ P_4 \\end{pmatrix} = \\begin{pmatrix} 5 & -5 & 0 & 0 \\\\ -5 & 15 & -10 & 0 \\\\ 0 & -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\nBus $1$ is the slack bus, which provides the angle reference. Therefore, its angle is fixed: $\\theta_1 = 0$ radians. This condition removes the linear dependence in the system. The equation for the slack bus (first row) is removed from the set to be solved, as $P_1$ is the dependent variable that balances the system. The known variables are $P_2=0.2$, $P_3=-0.3$, and $P_4=-0.3$. We can set up a reduced system of equations for the unknown angles $\\theta_2$, $\\theta_3$, and $\\theta_4$.\nWe use rows $2$, $3$, and $4$ of the matrix equation. Setting $\\theta_1 = 0$:\n$$ \\begin{pmatrix} 0.2 \\\\ -0.3 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 15 & -10 & 0 \\\\ -10 & \\frac{50}{3} & -\\frac{20}{3} \\\\ 0 & -\\frac{20}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\\\ \\theta_4 \\end{pmatrix} $$\nThis constitutes a system of three linear equations:\n1. $15\\theta_2 - 10\\theta_3 = 0.2$\n2. $-10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}\\theta_4 = -0.3$\n3. $-\\frac{20}{3}\\theta_3 + \\frac{20}{3}\\theta_4 = -0.3$\n\nWe solve this system by substitution, starting from the last equation.\nFrom equation (3):\n$$ \\frac{20}{3}(\\theta_4 - \\theta_3) = -0.3 $$\n$$ \\theta_4 - \\theta_3 = -0.3 \\times \\frac{3}{20} = -\\frac{0.9}{20} = -0.045 $$\n$$ \\theta_4 = \\theta_3 - 0.045 $$\nSubstitute this expression for $\\theta_4$ into equation (2):\n$$ -10\\theta_2 + \\frac{50}{3}\\theta_3 - \\frac{20}{3}(\\theta_3 - 0.045) = -0.3 $$\n$$ -10\\theta_2 + \\frac{50-20}{3}\\theta_3 + \\frac{20 \\times 0.045}{3} = -0.3 $$\n$$ -10\\theta_2 + \\frac{30}{3}\\theta_3 + \\frac{0.9}{3} = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 + 0.3 = -0.3 $$\n$$ -10\\theta_2 + 10\\theta_3 = -0.6 $$\nDividing by $10$, we get:\n$$ -\\theta_2 + \\theta_3 = -0.06 \\implies \\theta_3 = \\theta_2 - 0.06 $$\nFinally, substitute this expression for $\\theta_3$ into equation (1):\n$$ 15\\theta_2 - 10(\\theta_2 - 0.06) = 0.2 $$\n$$ 15\\theta_2 - 10\\theta_2 + 0.6 = 0.2 $$\n$$ 5\\theta_2 = 0.2 - 0.6 = -0.4 $$\n$$ \\theta_2 = -\\frac{0.4}{5} = -0.08 $$\nNow, we back-substitute to find the remaining angles:\n$$ \\theta_3 = \\theta_2 - 0.06 = -0.08 - 0.06 = -0.14 $$\n$$ \\theta_4 = \\theta_3 - 0.045 = -0.14 - 0.045 = -0.185 $$\nThe vector of bus voltage angles in radians is $\\theta = [\\theta_1, \\theta_2, \\theta_3, \\theta_4] = [0, -0.08, -0.14, -0.185]$.\n\nThe problem requires rounding each nonzero entry to four significant figures.\n- $\\theta_2 = -0.08 \\rightarrow -0.08000$\n- $\\theta_3 = -0.14 \\rightarrow -0.1400$\n- $\\theta_4 = -0.185 \\rightarrow -0.1850$\n\nThe final vector of bus voltage angles is $\\theta = [0, -0.08000, -0.1400, -0.1850]$ radians.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & -0.08000 & -0.1400 & -0.1850 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the basics, this problem explores a meshed network, which is more typical of real-world transmission systems. The task involves not only solving for the bus angles but also critically evaluating one of the core assumptions of the DC model. By calculating the maximum angle difference, you will directly assess the validity of the small-angle approximation, $\\sin(\\Delta\\theta) \\approx \\Delta\\theta$, for the given operating condition .",
            "id": "4070099",
            "problem": "A three-bus transmission network forms a closed triangle with series reactances in per unit (pu) given by $X_{12}=0.2$, $X_{23}=0.25$, and $X_{13}=0.3$. Net real-power injections (positive for generation, negative for load) at the buses are specified in per unit as the vector $P=\\left[0.5,\\,-0.3,\\,-0.2\\right]$, which is balanced in the sense that $\\sum_{i=1}^{3} P_{i}=0$. Assume operation is in steady state with balanced three-phase conditions, and adopt the Direct Current (DC) power flow approximation grounded in the following assumptions: (i) bus voltage magnitudes are close to unity per unit and treated as constants, (ii) line resistances are negligible compared to reactances so lines are lossless, (iii) shunt elements are neglected, and (iv) voltage angle differences are small enough that the sine of an angle difference can be approximated by the angle difference in radians while the cosine is taken as unity.\n\nStarting from the alternating-current real-power flow expression between buses $i$ and $j$ and the above assumptions, derive the linear DC power flow equations relating the bus voltage phase angles to the net real-power injections. Choose bus $1$ as the reference with angle $\\theta_{1}=0$, construct the resulting reduced linear system for the unknown angles at buses $2$ and $3$, and solve for the DC bus voltage angles $\\theta_{2}$ and $\\theta_{3}$ in radians. Then, compute all pairwise absolute angle differences $\\left|\\theta_{i}-\\theta_{j}\\right|$ for $\\{i,j\\}\\in\\{\\{1,2\\},\\{2,3\\},\\{1,3\\}\\}$ and identify the maximum of these differences.\n\nReport, as your final numeric answer, the maximum absolute pairwise voltage angle difference in radians. Express the final answer as an exact simplified fraction. Angles must be in radians. Do not include units in the final answer.",
            "solution": "The problem requires the derivation and solution of the DC power flow equations for a given three-bus network to find the maximum pairwise absolute voltage angle difference.\n\nFirst, we establish the DC power flow model from the general AC power flow principles and the stated assumptions. The real power flow $P_{ij}$ from bus $i$ to bus $j$ is given by:\n$$P_{ij} = \\frac{|V_i||V_j|}{X_{ij}} \\sin(\\theta_i - \\theta_j)$$\nwhere $|V_i|$ and $\\theta_i$ are the voltage magnitude and angle at bus $i$, and $X_{ij}$ is the series reactance of the line connecting them.\n\nThe problem specifies the following DC power flow assumptions:\n(i) Bus voltage magnitudes are unity in per unit: $|V_i| \\approx 1$ p.u. for all buses $i$.\n(ii) Line resistances are negligible. This is already incorporated in the provided power flow equation.\n(iii) Shunt elements are neglected.\n(iv) Voltage angle differences are small, justifying the approximations $\\sin(\\theta_i - \\theta_j) \\approx \\theta_i - \\theta_j$ (with angles in radians) and $\\cos(\\theta_i - \\theta_j) \\approx 1$.\n\nApplying assumptions (i) and (iv) to the AC power flow equation yields the DC power flow equation for the line flow from bus $i$ to bus $j$:\n$$P_{ij} \\approx \\frac{(1)(1)}{X_{ij}} (\\theta_i - \\theta_j) = \\frac{1}{X_{ij}}(\\theta_i - \\theta_j)$$\nThe net real-power injection $P_i$ at bus $i$ is the sum of all power flows leaving the bus:\n$$P_i = \\sum_{j \\neq i} P_{ij} = \\sum_{j \\neq i} \\frac{1}{X_{ij}}(\\theta_i - \\theta_j)$$\nThis set of equations for all buses can be expressed in matrix form as $P = B_{bus}\\theta$, where $P$ is the vector of net power injections, $\\theta$ is the vector of bus voltage angles, and $B_{bus}$ is the bus susceptance matrix. The elements of $B_{bus}$ are defined as:\n$$B_{ii} = \\sum_{j \\neq i} \\frac{1}{X_{ij}} \\quad \\text{(diagonal elements)}$$\n$$B_{ij} = -\\frac{1}{X_{ij}} \\quad \\text{(off-diagonal elements for connected buses } i, j)$$\n\nThe given network parameters are:\n$X_{12} = 0.2$ p.u.\n$X_{23} = 0.25$ p.u.\n$X_{13} = 0.3$ p.u.\nThe net power injections are $P_1=0.5$ p.u., $P_2=-0.3$ p.u., and $P_3=-0.2$ p.u.\n\nFirst, we calculate the line susceptances, which are the reciprocals of the reactances:\n$\\frac{1}{X_{12}} = \\frac{1}{0.2} = 5$ p.u.\n$\\frac{1}{X_{23}} = \\frac{1}{0.25} = 4$ p.u.\n$\\frac{1}{X_{13}} = \\frac{1}{0.3} = \\frac{10}{3}$ p.u.\n\nUsing these values, we construct the $3 \\times 3$ bus susceptance matrix $B_{bus}$:\nThe off-diagonal elements are:\n$B_{12} = B_{21} = -\\frac{1}{X_{12}} = -5$\n$B_{13} = B_{31} = -\\frac{1}{X_{13}} = -\\frac{10}{3}$\n$B_{23} = B_{32} = -\\frac{1}{X_{23}} = -4$\n\nThe diagonal elements are:\n$B_{11} = \\frac{1}{X_{12}} + \\frac{1}{X_{13}} = 5 + \\frac{10}{3} = \\frac{15+10}{3} = \\frac{25}{3}$\n$B_{22} = \\frac{1}{X_{12}} + \\frac{1}{X_{23}} = 5 + 4 = 9$\n$B_{33} = \\frac{1}{X_{13}} + \\frac{1}{X_{23}} = \\frac{10}{3} + 4 = \\frac{10+12}{3} = \\frac{22}{3}$\n\nThe full system of linear equations $P = B_{bus}\\theta$ is:\n$$\n\\begin{pmatrix} P_1 \\\\ P_2 \\\\ P_3 \\end{pmatrix} = \\begin{pmatrix} \\frac{25}{3} & -5 & -\\frac{10}{3} \\\\ -5 & 9 & -4 \\\\ -\\frac{10}{3} & -4 & \\frac{22}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n$$\nThe problem designates bus $1$ as the reference (or slack) bus, with its angle fixed at $\\theta_1 = 0$. This removes one unknown and one equation (the one for $P_1$) from the system. We solve for the remaining unknown angles $\\theta_2$ and $\\theta_3$ using the power balance equations for buses $2$ and $3$:\n$$P_2 = B_{21}\\theta_1 + B_{22}\\theta_2 + B_{23}\\theta_3$$\n$$P_3 = B_{31}\\theta_1 + B_{32}\\theta_2 + B_{33}\\theta_3$$\nSubstituting $\\theta_1 = 0$, we get the reduced linear system:\n$$\n\\begin{pmatrix} P_2 \\\\ P_3 \\end{pmatrix} = \\begin{pmatrix} B_{22} & B_{23} \\\\ B_{32} & B_{33} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n$$\nPlugging in the numerical values for power injections and the matrix elements:\n$P_2 = -0.3 = -\\frac{3}{10}$ and $P_3 = -0.2 = -\\frac{2}{10} = -\\frac{1}{5}$.\n$$\n\\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 9 & -4 \\\\ -4 & \\frac{22}{3} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n$$\nTo solve for $\\theta_2$ and $\\theta_3$, we can invert the reduced $2 \\times 2$ susceptance matrix. Let this matrix be $B'_{bus}$.\n$$B'_{bus} = \\begin{pmatrix} 9 & -4 \\\\ -4 & \\frac{22}{3} \\end{pmatrix}$$\nThe determinant is $\\det(B'_{bus}) = (9)\\left(\\frac{22}{3}\\right) - (-4)(-4) = 66 - 16 = 50$.\nThe inverse matrix is:\n$$(B'_{bus})^{-1} = \\frac{1}{50} \\begin{pmatrix} \\frac{22}{3} & 4 \\\\ 4 & 9 \\end{pmatrix}$$\nNow, we solve for the angles:\n$$\n\\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = (B'_{bus})^{-1} \\begin{pmatrix} P_2 \\\\ P_3 \\end{pmatrix} = \\frac{1}{50} \\begin{pmatrix} \\frac{22}{3} & 4 \\\\ 4 & 9 \\end{pmatrix} \\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{1}{5} \\end{pmatrix}\n$$\nCalculating each component:\n$$\\theta_2 = \\frac{1}{50} \\left[ \\left(\\frac{22}{3}\\right)\\left(-\\frac{3}{10}\\right) + (4)\\left(-\\frac{1}{5}\\right) \\right] = \\frac{1}{50} \\left[ -\\frac{22}{10} - \\frac{4}{5} \\right] = \\frac{1}{50} \\left[ -\\frac{22}{10} - \\frac{8}{10} \\right] = \\frac{1}{50} \\left[ -\\frac{30}{10} \\right] = \\frac{-3}{50}$$\n$$\\theta_3 = \\frac{1}{50} \\left[ (4)\\left(-\\frac{3}{10}\\right) + (9)\\left(-\\frac{1}{5}\\right) \\right] = \\frac{1}{50} \\left[ -\\frac{12}{10} - \\frac{9}{5} \\right] = \\frac{1}{50} \\left[ -\\frac{12}{10} - \\frac{18}{10} \\right] = \\frac{1}{50} \\left[ -\\frac{30}{10} \\right] = \\frac{-3}{50}$$\nSo, the bus voltage angles are $\\theta_1 = 0$ rad, $\\theta_2 = -\\frac{3}{50}$ rad, and $\\theta_3 = -\\frac{3}{50}$ rad.\n\nThe final step is to compute all pairwise absolute angle differences and find the maximum.\n$$|\\theta_1 - \\theta_2| = \\left|0 - \\left(-\\frac{3}{50}\\right)\\right| = \\frac{3}{50}$$\n$$|\\theta_2 - \\theta_3| = \\left|-\\frac{3}{50} - \\left(-\\frac{3}{50}\\right)\\right| = |0| = 0$$\n$$|\\theta_1 - \\theta_3| = \\left|0 - \\left(-\\frac{3}{50}\\right)\\right| = \\frac{3}{50}$$\nThe set of absolute differences is $\\{\\frac{3}{50}, 0, \\frac{3}{50}\\}$. The maximum value in this set is $\\frac{3}{50}$.",
            "answer": "$$\\boxed{\\frac{3}{50}}$$"
        },
        {
            "introduction": "The DC approximation's greatest strength—its simplicity—is also the source of its most significant limitations. This practice shifts focus from calculation to a critical analysis of the model's blind spots, specifically its neglect of reactive power ($Q$) and voltage magnitude deviations. You will formalize a test  to see how a line's thermal limit, which depends on the total current from both real and reactive power ($I = |S|/|V|$), can be violated even when a DC power flow screen suggests it is safe.",
            "id": "4070069",
            "problem": "You are asked to formalize and evaluate, in purely mathematical and programmatic terms, a discrepancy between Direct Current optimal power flow (DC OPF) and Alternating Current optimal power flow (AC OPF) thermal screening. The objective is to decide, for a set of given line-end conditions, whether a line that is admissible under DC screening nonetheless violates its ampacity when evaluated under AC physics due to reactive current that is unrepresented in DC OPF.\n\nContext and fundamental base: Work in a per-unit system. Use the complex power identity from sinusoidal steady-state circuit theory that relates the complex power at a bus, the bus voltage phasor, and the current phasor, namely $S = P + \\mathbf{j}Q = V I^{\\ast}$. In a DC OPF screen, thermal constraints are often represented solely via real power magnitude limits derived from ampacity under a nominal voltage reference, whereas AC physics constrains the magnitude of current that depends on both real and reactive power and on actual voltage magnitude.\n\nAssumptions to encode: \n- DC admissibility at a monitored line end is declared when the absolute real power flow at that end, $|P|$, does not exceed the product of the line ampacity $I_{\\max}$ and a fixed reference voltage magnitude $V_{\\text{ref}}$ that DC OPF assumes, i.e., the DC screen uses $V = V_{\\text{ref}}$ and omits $Q$ by construction.\n- AC violation at the same line end is declared when the physical current magnitude implied by the complex power at that end, given the actual bus voltage magnitude, exceeds the ampacity $I_{\\max}$. Your computation of the current magnitude at the monitored end must be derived from the fundamental relationship between complex power, voltage, and current.\n\nYour task: For each test case, compute a boolean indicator that is true if and only if the line end is admissible under the DC screen but violates the AC ampacity, and false otherwise. Formally, return true if and only if both of the following hold simultaneously: ($1$) the DC screen declares admissible; ($2$) the AC current magnitude strictly exceeds the ampacity. You may treat strict exceedance with a negligible numerical tolerance in floating-point arithmetic if needed.\n\nUnits and inputs: All quantities are in per-unit (dimensionless). Angles are not required. Each test case is a tuple $(P, Q, V, I_{\\max}, V_{\\text{ref}})$ where:\n- $P$ is the real power flow at the monitored line end,\n- $Q$ is the reactive power flow at the monitored line end,\n- $V$ is the actual voltage magnitude at the monitored line end,\n- $I_{\\max}$ is the ampacity bound,\n- $V_{\\text{ref}}$ is the DC OPF voltage reference magnitude.\n\nTest suite to implement and evaluate:\n- Case $1$: $(0.80, 0.10, 1.00, 1.00, 1.00)$.\n- Case $2$: $(0.95, 0.30, 0.95, 1.00, 1.00)$.\n- Case $3$: $(0.98, 0.00, 1.05, 1.00, 1.00)$.\n- Case $4$ (boundary): $(1.00, 0.00, 1.00, 1.00, 1.00)$.\n- Case $5$ (low voltage, reactive-heavy): $(0.70, 0.80, 0.90, 1.00, 1.00)$.\n\nAlgorithmic requirements:\n- Use only the stated fundamental relationship between complex power, voltage, and current to compute the AC current magnitude from $(P, Q, V)$ at the monitored end.\n- Implement the DC screen using the stated rule relating $|P|$, $I_{\\max}$, and $V_{\\text{ref}}$.\n- For each case, output the boolean indicator defined above.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (e.g., $[ \\text{True}, \\text{False}, \\dots ]$). The order must correspond to Cases $1$ through $5$.",
            "solution": "The problem requires a formal analysis of the discrepancy between a simplified Direct Current (DC) screening model and a more accurate Alternating Current (AC) physical model for determining thermal violations on a transmission line. We are to construct a boolean indicator that identifies cases where the DC screen deems a line admissible, yet the AC model shows it to be in violation of its ampacity limit. All quantities are provided in a per-unit (p.u.) system.\n\nFirst, we formalize the condition for an AC thermal violation. The fundamental relationship in sinusoidal steady-state between complex power $S$, voltage phasor $V_{\\text{phasor}}$, and current phasor $I_{\\text{phasor}}$ at a bus is given by:\n$$S = V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}$$\nwhere $I_{\\text{phasor}}^{\\ast}$ is the complex conjugate of the current phasor. Complex power $S$ is composed of real power $P$ and reactive power $Q$, such that $S = P + \\mathbf{j}Q$.\n\nTo determine the current magnitude $|I_{\\text{phasor}}|$, we take the magnitude of both sides of the equation:\n$$|S| = |V_{\\text{phasor}} I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}^{\\ast}| = |V_{\\text{phasor}}| |I_{\\text{phasor}}|$$\nThe magnitude of the complex power is $|S| = \\sqrt{P^2 + Q^2}$. The magnitude of the voltage phasor, $|V_{\\text{phasor}}|$, is the given voltage magnitude, which we denote as $V$. We denote the AC current magnitude as $I_{AC} = |I_{\\text{phasor}}|$. Rearranging the equation yields the expression for the AC current magnitude:\n$$I_{AC} = \\frac{|S|}{V} = \\frac{\\sqrt{P^2 + Q^2}}{V}$$\nAn AC violation occurs when this physically accurate current magnitude strictly exceeds the line's ampacity, $I_{\\max}$. The condition is therefore:\n$$ (2) \\quad \\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max} $$\n\nNext, we formalize the DC screening model. This model is a simplification used in DC Optimal Power Flow (DC OPF) studies. It makes two key assumptions for thermal screening:\n1. Reactive power flow is negligible ($Q \\approx 0$).\n2. The voltage magnitude is constant and equal to a nominal reference value, typically $V_{\\text{ref}} = 1.0$ p.u.\n\nUnder these assumptions, the apparent power $|S| = \\sqrt{P^2+Q^2}$ is approximated by $|P|$. The DC model does not compute current directly but instead places a limit on the real power flow. As stated in the problem, a line end is declared admissible under the DC screen if the absolute value of real power flow, $|P|$, does not exceed the product of the ampacity $I_{\\max}$ and the reference voltage $V_{\\text{ref}}$. This condition is:\n$$ (1) \\quad |P| \\le I_{\\max} \\cdot V_{\\text{ref}} $$\n\nThe task is to find when a discrepancy occurs, specifically when the line is admissible by the DC screen but is in violation according to the AC physics. This corresponds to a logical conjunction of condition (1) being true and condition (2) being true. The boolean indicator must be `True` if and only if:\n$$ (|P| \\le I_{\\max} \\cdot V_{\\text{ref}}) \\land \\left(\\frac{\\sqrt{P^2 + Q^2}}{V} > I_{\\max}\\right) $$\nOtherwise, the indicator is `False`.\n\nWe now apply these two conditions to each test case.\n\n**Case 1:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.80, 0.10, 1.00, 1.00, 1.00)$\n- DC Screen: Is $|0.80| \\le 1.00 \\cdot 1.00$? Yes, $0.80 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.80^2 + 0.10^2}}{1.00} = \\sqrt{0.64 + 0.01} = \\sqrt{0.65} \\approx 0.8062$. Is $0.8062 > 1.00$? No. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**.\n\n**Case 2:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.95, 0.30, 0.95, 1.00, 1.00)$\n- DC Screen: Is $|0.95| \\le 1.00 \\cdot 1.00$? Yes, $0.95 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.95^2 + 0.30^2}}{0.95} = \\frac{\\sqrt{0.9025 + 0.09}}{0.95} = \\frac{\\sqrt{0.9925}}{0.95} \\approx \\frac{0.99624}{0.95} \\approx 1.0487$. Is $1.0487 > 1.00$? Yes. Condition (2) is `True`.\n- Result: `True` $\\land$ `True` $\\implies$ **`True`**. This discrepancy arises because the reactive power and the depressed voltage ($V=0.95$) both contribute to a higher actual current than the DC screen anticipates.\n\n**Case 3:** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.98, 0.00, 1.05, 1.00, 1.00)$\n- DC Screen: Is $|0.98| \\le 1.00 \\cdot 1.00$? Yes, $0.98 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.98^2 + 0.00^2}}{1.05} = \\frac{0.98}{1.05} \\approx 0.9333$. Is $0.9333 > 1.00$? No. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**. Here, the higher voltage ($V=1.05$) reduces the current required to transmit the same power, moving it further from the limit.\n\n**Case 4 (boundary):** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (1.00, 0.00, 1.00, 1.00, 1.00)$\n- DC Screen: Is $|1.00| \\le 1.00 \\cdot 1.00$? Yes, $1.00 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{1.00^2 + 0.00^2}}{1.00} = \\frac{1.00}{1.00} = 1.00$. Is $1.00 > 1.00$? No, the inequality is strict. Condition (2) is `False`.\n- Result: `True` $\\land$ `False` $\\implies$ **`False`**. This case represents perfect alignment between the DC model's assumptions ($Q=0, V=V_{\\text{ref}}=1.0$) and reality.\n\n**Case 5 (low voltage, reactive-heavy):** $(P, Q, V, I_{\\max}, V_{\\text{ref}}) = (0.70, 0.80, 0.90, 1.00, 1.00)$\n- DC Screen: Is $|0.70| \\le 1.00 \\cdot 1.00$? Yes, $0.70 \\le 1.00$. Condition (1) is `True`.\n- AC Violation: $I_{AC} = \\frac{\\sqrt{0.70^2 + 0.80^2}}{0.90} = \\frac{\\sqrt{0.49 + 0.64}}{0.90} = \\frac{\\sqrt{1.13}}{0.90} \\approx \\frac{1.0630}{0.90} \\approx 1.1811$. Is $1.1811 > 1.00$? Yes. Condition (2) is `True`.\n- Result: `True` $\\land$ `True` $\\implies$ **`True`**. This is a pronounced example of discrepancy, driven by both significant reactive power and low voltage, which combine to create a high current for a seemingly modest real power flow.",
            "answer": "[False, True, False, False, True]"
        }
    ]
}