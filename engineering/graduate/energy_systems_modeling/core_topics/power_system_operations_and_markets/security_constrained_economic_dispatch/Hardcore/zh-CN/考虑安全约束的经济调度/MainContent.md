## 引言
安全约束[经济调度](@entry_id:143387)（Security-Constrained Economic Dispatch, SCED）是现代[电力](@entry_id:264587)系统可靠、经济运行的核心。在每一刻，系统运营商都面临着一个根本性的挑战：如何在满足全社会用电需求的同时，将总发电成本降至最低，并确保庞大而复杂的电网能够抵御突发的设备故障？简单地追求最低成本而不考虑输电网络的物理限制，极易导致线路过载甚至大面积停电事故。SCED正是为了解决这一关键问题而设计的精密优化工具。

本文旨在系统性地剖析SCED的理论、应用与实践。通过学习，您将不仅理解其数学模型，更能洞察其在真实世界电力市场和未来能源系统中的核心作用。文章将分为三个章节，层层递进：

*   在**原理与机制**一章中，我们将深入SCED的计算基础——直流潮流模型，揭示如何将复杂的电网物理线性化，并学习如何利用功率转移分布因子（PTDF）和线路故障分布因子（LODF）等关键工具来高效地构建[网络安全](@entry_id:262820)约束。
*   在**应用与跨学科连接**一章中，我们将视野拓宽至SCED在[电力市场设计](@entry_id:1124242)、先进电网技术集成、可靠性保障以及气候风险评估等领域的广泛应用，展现其作为连接工程、经济与[运筹学](@entry_id:145535)的桥梁作用。
*   最后的**动手实践**部分将提供具体的计算练习，让您有机会将理论知识应用于解决简化的调度问题，从而巩固和深化您的理解。

现在，让我们从构建SCED模型的第一块基石——其基本原理与核心机制开始。

## 原理与机制

本章深入探讨安全约束[经济调度](@entry_id:143387)（SCED）的核心建模原理与计算机制。SCED 是现代[电力系统运行](@entry_id:1130078)的基石，它旨在以最低的成本调度[发电机](@entry_id:268282)组，同时确保[电力](@entry_id:264587)系统在正常运行状态（“基础案例”）和遭遇突发扰动（“N-1”或“N-k”准则下的“事故”）后都能保持安全稳定。为了在计算上应对管理一个庞大互联电网的复杂性，SCED 广泛依赖于对底层物理原理的线性化近似。我们将从这些近似模型出发，系统地构建起 SCED 的完整框架，并阐释其经济内涵。

### 直流潮流模型：SCED 的计算基础

完整的交流（AC）[潮流方程](@entry_id:1130035)描述了电网中功率、电压和电流之间的精确关系，但它们本质上是[非线性](@entry_id:637147)的、非凸的，这使得在大型网络中求解最优潮流问题（Optimal Power Flow, OPF）在计算上极为困难。为了实现实时市场出清和调度，业界普遍采用一种线性化的近似模型，即**直流潮流（DC power flow）**模型。

直流潮流模型的推导建立在几个关键假设之上 ：
1.  **平坦的电压幅值**：假设所有母线的电压幅值恒定为 $1.0$ 标幺值。
2.  **微小的相角差**：假设任意一条输电线路两端的母线电压相角差非常小。这使得 $\sin(\theta_i - \theta_j) \approx \theta_i - \theta_j$ 且 $\cos(\theta_i - \theta_j) \approx 1$。
3.  **忽略线路电阻**：假设输电线路的电阻 $r$ 远小于其电抗 $x$ ($r \ll x$)，因此可以忽略线路的有功功率损耗。

在这些假设下，流经连接母线 $i$ 和母线 $j$ 的线路上的有功功率 $f_{ij}$ 从一个非线性方程简化为一个线性方程：
$$ f_{ij} \approx \frac{1}{x_{ij}}(\theta_i - \theta_j) = b_{ij}(\theta_i - \theta_j) $$
其中，$x_{ij}$ 是线路的电抗，$b_{ij} = 1/x_{ij}$ 是线路的电纳，$\theta_i$ 和 $\theta_j$ 分别是母线 $i$ 和 $j$ 的电压相角。

根据基尔霍夫电流定律（KCL），每个母线的净注入功率必须等于从该母线流出的所有功率之和。我们将母线 $i$ 的净注入功率定义为 $p_i = P_i - D_i$，其中 $P_i$ 是该母线的总发电量，$D_i$ 是总负荷。因此，我们得到了一组线性方程，构成了[直流潮流](@entry_id:1123429)模型的核心 ：
$$ p_i = \sum_{j \in \mathcal{N}_i} f_{ij} = \sum_{j \in \mathcal{N}_i} b_{ij}(\theta_i - \theta_j) $$
其中 $\mathcal{N}_i$ 是与母线 $i$ 直接相连的母线集合。

将这组方程写成矩阵形式，我们得到 $p = B\theta$，其中 $p$ 是净注入功率向量，$\theta$ 是电压相角向量，$B$ 是**母线电纳矩阵**。对于一个连通的电网，$B$ 矩阵是奇异的，其[零空间](@entry_id:171336)由全一向量 $\mathbf{1}$ 张成（即 $B\mathbf{1} = \mathbf{0}$）。这反映了一个物理事实：潮流只取决于相角**差**，而非相角的绝对值。将所有相角同时增加一个常数不会改变任何线路上的潮流。为了求解这组方程，我们必须选择一个**参考母线**（或称**平衡母线**），将其相角固定为零（例如 $\theta_{\text{ref}} = 0$），从而消除奇异性。

此外，对所有母线的节点平衡方程求和可以发现，$\sum_i p_i = \sum_i \sum_{j \in \mathcal{N}_i} b_{ij}(\theta_i - \theta_j) = 0$。这是因为每条线路的贡献 $(\theta_i - \theta_j)$ 和 $(\theta_j - \theta_i)$ 会在求和中精确抵消。因此，对于一个无损的直流模型，一个有解的注入功率向量必须满足**系统功率平衡**条件：$\sum_i p_i = 0$，即总发电量必须精确等于总负荷 。需要强调的是，选择哪个母线作为相角参考，并不会改变网络中的实际潮流分布或最优的调度结果，它仅仅是一个为[求解线性方程组](@entry_id:169069)而服务的数学工具  。

### 网络约束的表达方式：从潮流到调度

传统的**[经济调度](@entry_id:143387)（Economic Dispatch, ED）**是在一个理想化的“铜板”模型上进行的，它只考虑[发电机](@entry_id:268282)组的容量限制和系统总的功率平衡，完全忽略了输电网络的物理限制。这显然无法保证调度方案在真实电网中的可行性。

计及网络物理限制的调度被称为**网络约束经济调度**，或更具体地说，是**[直流最优潮流](@entry_id:1123428)（DC Optimal Power Flow, DCOPF）**。DCOPF 的目标是在满足[发电机](@entry_id:268282)限制、节点功率平衡和线路热极限的前提下，最小化总发电成本。网络约束主要通过两种等效的方式引入到优化模型中。

#### 1. 基于相角的约束

第一种方法是直接将母线相角 $\theta$ 作为决策变量引入优化模型。线路热极限，即线路上的功率流不能超过其最大容量 $F_\ell^{\max}$，被表达为：
$$ -F_\ell^{\max} \le b_\ell (\theta_i - \theta_j) \le F_\ell^{\max} $$
同时，节点功率平衡方程 $p = B\theta$ 作为[等式约束](@entry_id:175290)。这种方法直观地模拟了网络物理，但增加了优化问题的变量维度。

#### 2. 基于灵敏度因子的约束

第二种方法利用[线性系统](@entry_id:147850)的特性，预先计算出**功率转移分布因子（Power Transfer Distribution Factors, PTDF）**。PTDF 矩阵，记为 $H$，构建了一个从节点净注入功率到线路潮流的直接[线性映射](@entry_id:185132)：$f = H p^{\text{net}}$，其中 $f$ 是线路潮流向量，$p^{\text{net}}$ 是节点净注入功率向量 。

利用 PTDF，线路热极限可以被直接表达为关于发电决策变量 $p_g$（[发电机](@entry_id:268282)出力）的线性不等式：
$$ -f^{\max} \le H (A_g p_g - d) \le f^{\max} $$
其中 $A_g$ 是将[发电机](@entry_id:268282)出力映射到对应母线的[关联矩阵](@entry_id:263683)，$d$ 是负荷向量。这种方法避免了在优化问题中显式包含相角变量，使得约束的表达更为紧凑。然而，至关重要的一点是，PTDF 矩阵的推导是基于净注入功率总和为零的假设。因此，在使用 PTDF 制定约束时，必须显式地加入系统功率平衡约束 $\mathbf{1}^\top (A_g p_g - d) = 0$，否则 PTDF 映射将失去其物理意义 。

### 深入理解灵敏度因子

SCED 的高效计算严重依赖于 PTDF 和另一种相关的灵敏度因子，即线路故障分布因子（LODF）。

#### 功率转移分布因子（PTDF）

从定义上讲，$PTDF_{\ell, i}$ 量化了在母线 $i$ 注入单位功率、并在参考母线 $s$ 提取相同功率时，线路 $\ell$ 上产生的潮流变化 。这个定义揭示了 PTDF 的一个重要特性：它的数值依赖于参考母线的选择。如果将参考母线从 $s$ 变为 $r$，PTDF 矩阵的每一列都会发生一个固定的偏移。然而，尽管 PTDF 本身的数值会变，但对于任何满足功率平衡的注入方案 $p$（即 $\mathbf{1}^\top p=0$），计算出的物理潮流 $f = H p$ 是**唯一且与参考母线选择无关**的。这保证了基于 PTDF 的优化结果的物理一致性 。

#### 线路故障分布因子（LODF）

确保 **N-1 安全**是 SCED 的核心任务。N-1 准则要求[电力](@entry_id:264587)系统在经受任意单一元件（如一条线路或一台[发电机](@entry_id:268282)）故障后，仍然能够保持在安全运行限制内。对成千上万个潜在的线路故障进行逐一的全网络潮流计算是不现实的。**线路故障分布因子（Line Outage Distribution Factors, LODF）**提供了一个高效的解决方案。

$LODF_{\ell, k}$ 的定义是：当线路 $k$ 发生故障（跳闸）时，线路 $k$ 上原来的潮流 $f_k^0$ 会重新分布到电网的其他路径上，其中分配到线路 $\ell$ 上的那部分潮流占 $f_k^0$ 的比例就是 $LODF_{\ell, k}$。因此，线路 $\ell$ 在故障后的新潮流 $f_\ell'$ 可以通过一个简单的线性更新公式得到：
$$ f_\ell' = f_\ell^0 + LODF_{\ell, k} \cdot f_k^0 $$
其中 $f_\ell^0$ 和 $f_k^0$ 分别是故障前线路 $\ell$ 和线路 $k$ 的潮流。

LODF 并非独立于 PTDF，两者之间存在着深刻的数学联系。可以证明，如果故障线路 $k$ 连接母线 $s$ 和 $t$，则 LODF 可以完全由 PTDF 计算得出 ：
$$ LODF_{\ell, k} = \frac{PTDF_{\ell}^{s,t}}{1 - PTDF_k^{s,t}} $$
其中，$PTDF_{\ell}^{s,t}$ 表示在母线 $s$ 和 $t$ 之间进行单位功率交易时，线路 $\ell$ 上的潮流变化。这个公式的机制是，线路 $k$ 的跳闸可以等效地看作在母线 $s$ 和 $t$ 之间注入一个补偿性的潮流，该潮流恰好能使线路 $k$ 上的总潮流降为零。分母中的 $1 - PTDF_k^{s,t}$ 是一项修正因子，它考虑了注入的补偿潮流本身也会在线路 $k$ 上（如果它仍然存在的话）引起反馈效应。

LODF 的引入，使得数以千计的事故后潮流约束都能够转化为关于基础案例决策变量的线性不等式，这是现代 SCED 得以高效求解的关键技术之一。但必须认识到，这些线性灵敏度因子都源于[直流潮流近似](@entry_id:1123430)，因此它们继承了该模型的所有局限性。当实际系统中的电压偏离标幺值较多，或线路损耗不可忽略时，基于 LODF 的[直流潮流](@entry_id:1123429)预测与真实的[交流潮流](@entry_id:1120762)结果之间会存在误差。例如，在一个假设场景中，如果电压幅值偏离 $1.0$ 约 $2-3\%$，即使相角差保持不变，由电阻和电压效应引起的[交流潮流](@entry_id:1120762)与直流预测之间的相对误差也可能达到 $1\%$ 到 $5\%$ 的水平 。在实际操作中，系统运行人员需要了解这些潜在误差，并设置适当的安全裕度。

### SCED 问题的完整表述

掌握了上述构建模块后，我们现在可以对 SCED 问题进行完整和精确的表述。根据对 N-1 安全准则的执行方式不同，SCED 主要分为**预防性（preventive）**和**纠正性（corrective）**两种模式  。

#### 1. 预防性 SCED

预防性 SCED 的理念最为保守和稳健。它要求系统运营商确定的**一个**基础案例调度方案 $g$（[发电机](@entry_id:268282)出力向量），必须能在**不依赖任何后续调整**的情况下，自身就足以应对任何预想的 N-1 事故。

数学上，预防性 SCED 的优化问题只包含一组决策变量 $g$。它需要满足基础案例的约束（功率平衡、[发电机](@entry_id:268282)限制、基础案例线路热极限），并且，对于**每一个**预想的事故 $c \in \mathcal{C}$，事故后的潮流（可利用 LODF 计算）也必须满足相应的紧急热极限：

$$ |f_\ell^0 + LODF_{\ell, c} \cdot f_c^0| \le F_\ell^{\text{em}, c} \quad \forall \ell \in \mathcal{L}, \forall c \in \mathcal{C} $$

这里的 $f_\ell^0$ 和 $f_c^0$ 都是关于决策变量 $g$ 的线性函数。因此，预防性 SCED 是一个大型的线性或二次规划问题，其约束集合包括了所有预想事故下的安全约束 。

#### 2. 纠正性 SCED

纠正性 SCED 的理念更为灵活和经济。它承认在事故发生后的短时间内（通常是几分钟到十几分钟），系统可以通过自动或手动的**[发电机](@entry_id:268282)再调度**来缓解潮流过载。因此，它寻找的基础案例调度方案 $g$ 不要求自身在事故后完全安全，而是要求它在事故后是**可被纠正至[安全状态](@entry_id:754485)的**。

为此，纠正性 SCED 在数学模型中为每个事故 $c$ 引入了一组新的**纠正性决策变量** $g^c$，代表事故后的[发电机](@entry_id:268282)出力。该模型的目标是找到一个基础案例调度 $g$ 和一系列应急预案 $g^c$，使得：
1.  基础案例调度 $g$ 满足所有正常运行约束。
2.  对于每个事故 $c$，存在一个可行的再调度方案 $g^c$。可行性包括：
    *   $g^c$ 满足[发电机](@entry_id:268282)自身的容量限制。
    *   从 $g$ 到 $g^c$ 的调整量在[发电机](@entry_id:268282)的快速响应能力（[爬坡率限制](@entry_id:1130536)）之内，即 $|g^c - g| \le r^{\uparrow / \downarrow}$。
    *   $g^c$ 能够满足事故后的系统功率平衡。
    *   在 $g^c$ 下，所有线路的事故后潮流均在紧急限值内。

纠正性 SCED 的问题规模远大于预防性 SCED，因为它为每个事故都引入了一套新的变量和约束。但它通常能找到成本更低的基础案例调度方案，因为它利用了事故后可用的纠正能力，避免了为应对低概率事件而在正常运行时采取过于保守和昂贵的调度策略 。

综上所述，一个全面的 SCED 模型  包括了：
*   **目标函数**：最小化总发电成本 $\min \sum_i C_i(P_i)$。
*   **[发电机](@entry_id:268282)约束**：出力上下限 $P_i^{\min} \le P_i \le P_i^{\max}$，以及可能的爬坡速率限制和备用容量要求。
*   **[系统平衡](@entry_id:1132826)约束**：$\sum_i P_i = \sum_j D_j$。
*   **基础案例网络约束**：所有线路潮流必须在正常限值内。
*   **N-1 安全约束**：所有预想事故下的事故后潮流必须在紧急限值内，这可以通过预防性或纠正性方式来强制执行。

### SCED 的经济内涵：区域边际电价（LMP）

SCED 不仅是一个物理调度工具，它也是现代[电力市场](@entry_id:1124241)的核心定价机制。SCED 优化问题的**[拉格朗日对偶](@entry_id:638042)变量**具有深刻的经济含义。其中，与**节点功率平衡约束**相关联的[对偶变量](@entry_id:143282) $\lambda_i$ 被定义为该节点的**区域边际电价（Locational Marginal Price, LMP）**。

$\lambda_i$ 的经济学解释是：在系统的最优状态下，为母线 $i$ 增加一单位负荷（或减少一单位发电）所带来的系统总成本的增量。在一个没有网络拥塞的理想化“铜板”系统中，所有节点的 LMP 都是相同的，等于系统中边际[发电机](@entry_id:268282)组的燃料成本。

然而，在存在网络拥塞的真实系统中，LMP 会因地点而异。可以严格证明，在基于 PTDF 的 SCED 模型中，母线 $i$ 的 LMP 可以被分解为三个部分 ：

$$ \lambda_i = \lambda_{\text{energy}} + \lambda_{\text{congestion}, i} + \lambda_{\text{security}, i} $$

1.  **能源分量 ($\lambda_{\text{energy}}$)**：这是系统级的边际能源成本，对应于系统功率平衡约束的[对偶变量](@entry_id:143282)，对所有节点都相同。
2.  **拥塞分量 ($\lambda_{\text{congestion}, i}$)**：此分量源于**基础案例**中某些线路达到了其热极限。其数学表达式为 $\sum_{\ell \in \mathcal{L}} (\mu_{\ell}^{+} - \mu_{\ell}^{-}) \cdot \mathrm{PTDF}_{\ell,i}$，其中 $\mu_\ell^\pm$ 是线路 $\ell$ 热极限约束的[对偶变量](@entry_id:143282)。当线路 $\ell$ 发生拥塞时（$\mu_\ell^+ > 0$ 或 $\mu_\ell^- > 0$），该项变为非零，反映了在母线 $i$ 注入功率对缓解（或加剧）该线路拥塞的边际价值。
3.  **安全分量 ($\lambda_{\text{security}, i}$)**：此分量是 SCED 特有的，源于为满足 **N-1 安全约束**而导致的拥塞。当某个**事故后**的线路潮流达到其紧急限值时，对应的对偶变量 $\mu_{\ell, c}^\pm$ 会变为非零。安全分量的数学表达式为 $\sum_{c, \ell} (\mu_{\ell, c}^{+} - \mu_{\ell, c}^{-}) \cdot \mathrm{PTDF}^{(c)}_{\ell,i}$。它反映了在母线 $i$ 注入功率对缓解（或加剧）**潜在**的事故后拥塞的边际价值。

因此，LMP 分解清晰地揭示了[电力](@entry_id:264587)价格的空间差异是如何由网络的物理限制（包括正常和事故情况下的限制）所驱动的。这种基于成本的、物理知情的价格信号，为发电商和消费者提供了高效投资和运营决策的关键经济指引。