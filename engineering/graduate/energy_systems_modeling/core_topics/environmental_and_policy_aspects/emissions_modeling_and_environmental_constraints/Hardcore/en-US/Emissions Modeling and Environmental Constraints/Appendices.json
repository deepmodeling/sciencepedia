{
    "hands_on_practices": [
        {
            "introduction": "To understand the economic impact of an emissions constraint, we can model how it alters the behavior of a cost-minimizing system. This exercise presents a foundational model of economic dispatch for a simple two-generator system, a classic problem in energy systems analysis. By solving for the optimal generation schedule with and without an emissions cap, you can directly calculate the marginal cost of the constraint—its shadow price—and identify which generating unit is displaced to achieve compliance. ",
            "id": "4088528",
            "problem": "A regional system operator seeks to minimize total generation cost over two periods subject to demand, capacity, and a binding cumulative emissions cap. There are two thermal generating units indexed by $i \\in \\{1,2\\}$ and two periods indexed by $t \\in \\{1,2\\}$. Let $x_{i,t}$ denote the energy delivered by unit $i$ in period $t$ in megawatt-hours. The operator’s objective is to minimize total variable generation cost subject to meeting period demands, respecting per-period capacity limits, and not exceeding a cumulative cap on carbon dioxide (CO2) emissions.\n\nFundamental modeling assumptions:\n- Variable cost per unit energy for unit $i$ is $c_i$ in dollars per megawatt-hour.\n- Emission intensity for unit $i$ is $e_i$ in tonnes of carbon dioxide per megawatt-hour.\n- Per-period capacity for unit $i$ is $K_i$ in megawatt-hours.\n- Period demands are $D_1$ and $D_2$ in megawatt-hours.\n- The cumulative emissions cap across both periods is $E^{\\max}$ in tonnes of carbon dioxide.\n- There are no startup costs, ramping limits, or transmission constraints; losses are negligible; the system is perfectly competitive.\n\nData:\n- Costs: $c_1 = 20$, $c_2 = 35$.\n- Emission intensities: $e_1 = 0.9$, $e_2 = 0.1$.\n- Per-period capacities: $K_1 = 60$, $K_2 = 60$.\n- Demands: $D_1 = 80$, $D_2 = 60$.\n- Emissions cap: $E^{\\max} = 90$.\n\nFormulate the operator’s problem using the standard linear programming cost-minimization with decision variables $x_{i,t}$, demand balance constraints $\\sum_{i} x_{i,t} = D_t$, capacity constraints $0 \\le x_{i,t} \\le K_i$, and the cumulative emissions constraint $\\sum_{t} \\sum_{i} e_i x_{i,t} \\le E^{\\max}$. Define the shadow price of the cap, $\\lambda^{\\star}$, as the Lagrange multiplier associated with the cumulative emissions constraint at the optimum. Starting from this formulation and first principles of constrained optimization, compute $\\lambda^{\\star}$ and determine which unit is displaced relative to the unconstrained least-cost dispatch when the cap binds. For the displaced unit, report the index $1$ if unit $1$ is displaced or $2$ if unit $2$ is displaced. \n\nProvide your final numerical answer as a row matrix with two entries $\\begin{pmatrix} \\lambda^{\\star} & i_{\\text{displaced}} \\end{pmatrix}$. Round $\\lambda^{\\star}$ to four significant figures. Express the shadow price in dollars per tonne of carbon dioxide. The second entry must be either $1$ or $2$ and has no units.",
            "solution": "The user wants me to solve an economic dispatch problem for an energy system.\n\nHere's my plan:\n1.  **Validate the Problem:**\n    *   Extract all given data and constraints.\n    *   Check for scientific soundness, well-posedness, and objectivity. This looks like a standard linear programming problem in energy systems modeling, a well-established field. The assumptions are clearly stated. The data seems consistent. The problem asks for specific outputs derived from the model. It appears valid.\n\n2.  **Formulate the Linear Program:**\n    *   **Objective Function:** Minimize total cost. `C = c1*x11 + c2*x21 + c1*x12 + c2*x22`.\n    *   **Decision Variables:** `x11, x21, x12, x22`.\n    *   **Constraints:**\n        *   Demand Period 1: `x11 + x21 = D1`\n        *   Demand Period 2: `x12 + x22 = D2`\n        *   Capacity Unit 1, Period 1: `0 <= x11 <= K1`\n        *   Capacity Unit 1, Period 2: `0 <= x12 <= K1`\n        *   Capacity Unit 2, Period 1: `0 <= x21 <= K2`\n        *   Capacity Unit 2, Period 2: `0 <= x22 <= K2`\n        *   Cumulative Emissions: `e1*x11 + e2*x21 + e1*x12 + e2*x22 <= Emax`\n\n3.  **Solve the Unconstrained (Emissions) Dispatch:**\n    *   First, I need to see what the dispatch would be if there were *no* emissions cap. This is the \"least-cost dispatch\".\n    *   In each period, the system will use the cheapest generator first. Unit 1 has `c1 = 20` and Unit 2 has `c2 = 35`. So, Unit 1 is the cheaper one.\n    *   **Period 1 (Demand D1 = 80):**\n        *   Dispatch Unit 1 up to its capacity: `x11 = K1 = 60`.\n        *   Remaining demand is `80 - 60 = 20`.\n        *   Dispatch Unit 2 to meet the rest: `x21 = 20`. This is within its capacity `K2 = 60`.\n        *   So, `x11 = 60`, `x21 = 20`.\n    *   **Period 2 (Demand D2 = 60):**\n        *   Dispatch Unit 1 up to demand: `x12 = D2 = 60`. This is within its capacity `K1 = 60`.\n        *   No need for Unit 2: `x22 = 0`.\n        *   So, `x12 = 60`, `x22 = 0`.\n    *   **Total Emissions of Least-Cost Dispatch:**\n        *   `E_unconstrained = e1*x11 + e2*x21 + e1*x12 + e2*x22`\n        *   `E_unconstrained = 0.9 * 60 + 0.1 * 20 + 0.9 * 60 + 0.1 * 0`\n        *   `E_unconstrained = 54 + 2 + 54 + 0 = 110` tonnes.\n    *   **Check against the cap:** The cap is `Emax = 90`. Since `110 > 90`, the emissions constraint is binding.\n\n4.  **Solve the Constrained Dispatch:**\n    *   The problem now is to minimize cost subject to all constraints, including the binding emissions cap.\n    *   The core idea of re-dispatching to meet an emissions cap is to substitute generation from a high-emission unit with generation from a low-emission unit. This will increase the total cost. The shadow price of the cap, `λ`, represents this marginal cost increase.\n    *   Unit 1 (cheaper) has high emissions (`e1 = 0.9`).\n    *   Unit 2 (more expensive) has low emissions (`e2 = 0.1`).\n    *   To reduce emissions, we must reduce generation from Unit 1 and increase generation from Unit 2.\n    *   Let's analyze the cost of this substitution. To reduce emissions by some amount `ΔE`, we need to swap generation. Let's say we shift `Δx` MWh of generation from Unit 1 to Unit 2.\n    *   The change in cost is `ΔC = c2 * Δx - c1 * Δx = (c2 - c1) * Δx = (35 - 20) * Δx = 15 * Δx`.\n    *   The change in emissions is `ΔE = e2 * Δx - e1 * Δx = (e2 - e1) * Δx = (0.1 - 0.9) * Δx = -0.8 * Δx`.\n    *   The shadow price `λ` is the marginal cost of abatement, which is `dC/d|E|`.\n    *   `dC/d|E| ≈ ΔC / |ΔE| = (15 * Δx) / (0.8 * Δx) = 15 / 0.8 = 18.75`.\n    *   Wait, let's be more formal. The shadow price `λ` is the increase in cost for a 1-unit *tightening* of the constraint. If the constraint is `E <= Emax`, tightening it means decreasing `Emax`. The problem defines $\\lambda^\\star$ as the Lagrange multiplier of the constraint. For a minimization problem, the Lagrangian can be written as $L = f(x) + \\lambda (g(x) - b)$. The KKT condition for a binding constraint $g(x) \\le b$ is $\\lambda \\ge 0$. The value of $\\lambda$ is then $\\frac{\\partial f^\\star}{\\partial b}$, where $f^\\star$ is the optimal objective value. Relaxing the constraint (increasing $b=E^{\\max}$) would decrease the minimum cost, so $\\frac{\\partial f^\\star}{\\partial b}$ would be negative. The standard economic definition of a shadow price is positive, representing the marginal value of relaxing the constraint. Here, $\\lambda^{\\star}$ is defined as the Lagrange multiplier, whose sign depends on the formulation of the Lagrangian. However, the units ($/tonne) imply it is an economic price. Let's calculate its magnitude, which is the marginal cost of abatement. This value is always positive.\n    *   `λ = (c2 - c1) / (e1 - e2) = (35 - 20) / (0.9 - 0.1) = 15 / 0.8 = 18.75`.\n    *   The units are `($/MWh) / (tonne/MWh) = $/tonne`. This is correct.\n    *   So, `λ = 18.75`.\n\n5.  **Determine the Displaced Unit and the Optimal Constrained Dispatch**\n    *   The least-cost dispatch resulted in emissions of `110` tonnes. We need to reduce this to `90` tonnes, a reduction of `20` tonnes.\n    *   The substitution involves reducing generation from Unit 1 (`x1`) and increasing generation from Unit 2 (`x2`).\n    *   Let `Δx` be the total amount of energy shifted from Unit 1 to Unit 2 across both periods.\n    *   The reduction in emissions is `ΔE_total = 20`.\n    *   `ΔE_total = (e1 - e2) * Δx`.\n    *   `20 = (0.9 - 0.1) * Δx = 0.8 * Δx`.\n    *   `Δx = 20 / 0.8 = 25` MWh.\n    *   We need to shift a total of `25` MWh from Unit 1 to Unit 2.\n    *   Where do we make this shift? We should do it in the period where it's \"easiest\" or still maintains least cost principles *after* pricing carbon.\n    *   Let's define the carbon-adjusted cost: `c_i' = c_i + λ * e_i`.\n    *   `c_1' = 20 + 18.75 * 0.9 = 20 + 16.875 = 36.875`.\n    *   `c_2' = 35 + 18.75 * 0.1 = 35 + 1.875 = 36.875`.\n    *   The carbon-adjusted costs are identical! This is a sanity check that the value of `λ` is correct. At this carbon price, the dispatcher is indifferent between the two units. Any further increase in the carbon price would make Unit 2 cheaper in a carbon-adjusted sense.\n    *   So, we need to reduce Unit 1's generation by `25` MWh and increase Unit 2's generation by `25` MWh.\n    *   Let's look at the unconstrained dispatch again:\n        *   Period 1: `x11 = 60`, `x21 = 20`.\n        *   Period 2: `x12 = 60`, `x22 = 0`.\n    *   We can't increase `x21` because `x21+x11=D1`. A swap must happen within a period.\n    *   Let's check the constraints.\n        *   Unit 1 has generation `x11=60, x12=60`.\n        *   Unit 2 has generation `x21=20, x22=0`.\n    *   To shift generation from Unit 1 to Unit 2, we must do it while respecting `xi,t <= Ki` and `x1t + x2t = Dt`.\n    *   **Period 1:** `x11=60, x21=20`. Demand `D1=80`. Unit 2 has spare capacity (`60 - 20 = 40`). We can reduce `x11` and increase `x21` by the same amount.\n    *   **Period 2:** `x12=60, x22=0`. Demand `D2=60`. Unit 2 has spare capacity (`60 - 0 = 60`). We can reduce `x12` and increase `x22` by the same amount.\n    *   Since the costs `c1` and `c2` are constant across periods, it doesn't matter which period we make the swap in. The total cost impact will be the same.\n    *   We need to reduce `x1_total = x11 + x12` by `25` MWh. And increase `x2_total = x21 + x22` by `25` MWh.\n    *   Let's make the changes. We have a total of `120` MWh from Unit 1. We have `25` MWh to cut.\n    *   Let's cut `Δx12` from period 2 and `Δx11` from period 1, where `Δx11 + Δx12 = 25`.\n    *   The corresponding increases are `Δx22 = Δx12` and `Δx21 = Δx11`.\n    *   Original dispatch:\n        `x11_unc = 60`, `x21_unc = 20`\n        `x12_unc = 60`, `x22_unc = 0`\n    *   New dispatch:\n        `x11_con = 60 - Δx11`, `x21_con = 20 + Δx11`\n        `x12_con = 60 - Δx12`, `x22_con = 0 + Δx12`\n    *   We need to respect capacity constraints:\n        `x11_con <= 60` (true)\n        `x21_con <= 60` -> `20 + Δx11 <= 60` -> `Δx11 <= 40`\n        `x12_con <= 60` (true)\n        `x22_con <= 60` -> `Δx12 <= 60`\n    *   Since `Δx11 + Δx12 = 25`, any combination satisfying this will work as long as `Δx11 >= 0` and `Δx12 >= 0`. The problem is degenerate. There are infinite optimal solutions for the `x_it` variables. For example:\n        *   Option A: Shift all `25` MWh in Period 2. `Δx12 = 25`, `Δx11 = 0`.\n            *   `x11 = 60`, `x21 = 20`.\n            *   `x12 = 35`, `x22 = 25`.\n        *   Option B: Shift all `25` MWh in Period 1. `Δx11 = 25`, `Δx12 = 0`.\n            *   `x11 = 35`, `x21 = 45`.\n            *   `x12 = 60`, `x22 = 0`.\n        *   Option C: Shift some in each. e.g., `Δx11 = 10`, `Δx12 = 15`.\n            *   `x11 = 50`, `x21 = 30`.\n            *   `x12 = 45`, `x22 = 15`.\n\n    *   All these options give the same total cost and total emissions.\n    *   Let's verify total emissions for Option A:\n        `E = 0.9*x11 + 0.1*x21 + 0.9*x12 + 0.1*x22`\n        `E = 0.9*60 + 0.1*20 + 0.9*35 + 0.1*25`\n        `E = 54 + 2 + 31.5 + 2.5 = 90`. Correct.\n    *   Let's verify total cost for Option A:\n        `C = 20*60 + 35*20 + 20*35 + 35*25`\n        `C = 1200 + 700 + 700 + 875 = 3475`.\n    *   What was the unconstrained cost?\n        `C_unc = 20*60 + 35*20 + 20*60 + 35*0 = 1200 + 700 + 1200 + 0 = 3100`.\n    *   Cost increase is `3475 - 3100 = 375`.\n    *   Let's check this with our shadow price. The change in emissions cap was `110 - 90 = 20`. The cost increase should be `λ * ΔE = 18.75 * 20 = 375`. This matches. So my calculation of `λ` is very likely correct.\n\n6.  **Answer the second part of the question: which unit is displaced?**\n    *   The problem asks \"determine which unit is displaced relative to the unconstrained least-cost dispatch when the cap binds.\"\n    *   In the unconstrained dispatch, we use the cheapest unit (Unit 1) as much as possible. `x1_total_unc = 60 + 60 = 120`. `x2_total_unc = 20 + 0 = 20`.\n    *   In the constrained dispatch, we have to reduce the output of the high-emission unit (Unit 1) and increase the output of the low-emission unit (Unit 2).\n    *   Total generation for Unit 1 is reduced: `x1_total_con = x11_con + x12_con = (60 - Δx11) + (60 - Δx12) = 120 - (Δx11 + Δx12) = 120 - 25 = 95`.\n    *   Total generation for Unit 2 is increased: `x2_total_con = x21_con + x22_con = (20 + Δx11) + (0 + Δx12) = 20 + (Δx11 + Δx12) = 20 + 25 = 45`.\n    *   So, Unit 1's generation is reduced (displaced) from its least-cost level to meet the emissions constraint. Unit 2's generation is increased.\n    *   Therefore, the displaced unit is Unit 1. The index is `1`.\n\n7.  **Final Review of the steps and logic.**\n    *   **Problem Formulation:** The LP formulation is standard and correct.\n    *   **Unconstrained Solution:** Correctly identified the merit order (Unit 1 then Unit 2) and calculated the dispatch and resulting emissions (`110 tonnes`).\n    *   **Constraint Check:** Correctly identified that the emissions constraint (`E <= 90`) is binding.\n    *   **Shadow Price (`λ`) Calculation:**\n        *   The shadow price is the marginal cost of abatement. It's the cost increase to achieve a one-tonne reduction in emissions.\n        *   Abatement is achieved by substituting generation from the cheap/dirty unit (1) to the expensive/clean unit (2).\n        *   The cost of substituting 1 MWh is `ΔC = c2 - c1 = 15`.\n        *   The emission reduction from substituting 1 MWh is `ΔE = e1 - e2 = 0.8`.\n        *   The cost per tonne of abatement is `λ = ΔC / ΔE = 15 / 0.8 = 18.75 $/tonne`. This logic seems solid. The re-calculation of adjusted costs `c_i'` being equal is a strong confirmation.\n    *   **Displaced Unit Identification:**\n        *   To explain that the unconstrained dispatch maximizes the use of the cheapest unit (Unit 1).\n        *   To explain that imposing the emissions cap forces a reduction in generation from the high-emission unit (Unit 1) and an increase from the low-emission unit (Unit 2).\n        *   To conclude that Unit 1 is the displaced unit, so `i_displaced = 1`.\n    *   **Final Answer construction**:\n        *   Assemble the results into the required matrix format `(λ*, i_displaced)`.\n        *   Apply the rounding rule: `18.75` has 4 significant figures. Non-zero digits are always significant. The count of significant figures for `18.75` is 4. No rounding is necessary.\n    *   Everything is fine.\n\nThe problem is a standard, well-posed linear programming problem in energy systems modeling. All data and definitions are clear and consistent. The problem is scientifically grounded and objective. It is valid.\n\nThe operator's problem is to minimize the total generation cost, $Z$, over two periods, $t \\in \\{1,2\\}$, from two generating units, $i \\in \\{1,2\\}$. The decision variables are $x_{i,t}$, the generation from unit $i$ in period $t$.\n\nThe objective function is:\n$$ \\min_{x_{i,t}} Z = \\sum_{t=1}^{2} \\sum_{i=1}^{2} c_i x_{i,t} = c_1 x_{1,1} + c_2 x_{2,1} + c_1 x_{1,2} + c_2 x_{2,2} $$\n\nThis is subject to the following constraints:\n1.  Demand balance in period $1$: $x_{1,1} + x_{2,1} = D_1$\n2.  Demand balance in period $2$: $x_{1,2} + x_{2,2} = D_2$\n3.  Capacity limits for unit $1$: $0 \\le x_{1,1} \\le K_1$ and $0 \\le x_{1,2} \\le K_1$\n4.  Capacity limits for unit $2$: $0 \\le x_{2,1} \\le K_2$ and $0 \\le x_{2,2} \\le K_2$\n5.  Cumulative emissions cap: $\\sum_{t=1}^{2} \\sum_{i=1}^{2} e_i x_{i,t} \\le E^{\\max}$\n\nFirst, we determine the unconstrained least-cost dispatch by ignoring the emissions constraint. In each period, generation is dispatched in merit order of variable cost, from cheapest to most expensive. Here, $c_1 = 20\\ \\$/\\text{MWh}$ and $c_2 = 35\\ \\$/\\text{MWh}$, so unit $1$ is always dispatched before unit $2$.\n\nFor period $1$, demand $D_1 = 80$ MWh:\nUnit $1$ is dispatched up to its capacity $K_1 = 60$ MWh. So, $x_{1,1}^{\\text{unc}} = 60$.\nThe remaining demand is $D_1 - K_1 = 80 - 60 = 20$ MWh.\nUnit $2$ is dispatched to meet the remaining demand. $x_{2,1}^{\\text{unc}} = 20$. This is within its capacity $K_2 = 60$.\n\nFor period $2$, demand $D_2 = 60$ MWh:\nUnit $1$ is dispatched to meet the entire demand, as $D_2 \\le K_1$. So, $x_{1,2}^{\\text{unc}} = 60$.\nUnit $2$ is not needed. So, $x_{2,2}^{\\text{unc}} = 0$.\n\nThe total emissions from this unconstrained dispatch are:\n$$ E^{\\text{unc}} = e_1 x_{1,1}^{\\text{unc}} + e_2 x_{2,1}^{\\text{unc}} + e_1 x_{1,2}^{\\text{unc}} + e_2 x_{2,2}^{\\text{unc}} $$\n$$ E^{\\text{unc}} = (0.9)(60) + (0.1)(20) + (0.9)(60) + (0.1)(0) = 54 + 2 + 54 = 110 \\text{ tonnes} $$\nThe emissions cap is $E^{\\max} = 90$ tonnes. Since $E^{\\text{unc}} > E^{\\max}$, the emissions constraint is binding.\n\nTo meet the cap, the system must reduce emissions. This is achieved by re-dispatching generation from the higher-emission unit to the lower-emission unit. Unit $1$ has $e_1=0.9$ and unit $2$ has $e_2=0.1$. Therefore, generation from unit $1$ must be reduced and replaced by generation from unit $2$. This substitution increases the total cost.\n\nThe shadow price of the emissions cap, $\\lambda^{\\star}$, is the marginal cost of emission abatement. It is the increase in total cost for a one-tonne reduction in emissions. When we substitute $\\Delta x$ MWh of generation from unit $1$ to unit $2$, the change in cost is $\\Delta C = (c_2 - c_1) \\Delta x$, and the change in emissions is $\\Delta E = (e_2 - e_1) \\Delta x$.\nThe marginal cost of abatement is the ratio of the marginal cost increase to the marginal emission reduction:\n$$ \\lambda^{\\star} = \\frac{\\Delta C}{-\\Delta E} = \\frac{(c_2 - c_1)\\Delta x}{-(e_2 - e_1)\\Delta x} = \\frac{c_2 - c_1}{e_1 - e_2} $$\nSubstituting the given values:\n$$ \\lambda^{\\star} = \\frac{35 - 20}{0.9 - 0.1} = \\frac{15}{0.8} = 18.75 $$\nThe units are $(\\$/\\text{MWh}) / (\\text{tonnes}/\\text{MWh}) = \\$/\\text{tonne}$. The shadow price is $\\lambda^{\\star} = 18.75$ dollars per tonne of CO2. The problem requires rounding to four significant figures. The number $18.75$ has four significant figures ($1, 8, 7, 5$), so no rounding is necessary.\n\nThe second part of the question asks which unit is displaced. The unconstrained least-cost dispatch maximizes the use of the cheapest generator, unit $1$. When the binding emissions cap is imposed, generation must be shifted away from the high-emission unit ($1$) to the low-emission unit ($2$) to reduce total emissions. This means the generation from unit $1$, $x_{1,1} + x_{1,2}$, decreases relative to its least-cost dispatch level, while the generation from unit $2$, $x_{2,1} + x_{2,2}$, increases. Therefore, unit $1$ is the \"displaced\" unit. The index for the displaced unit is $i_{\\text{displaced}}=1$.\n\nTo verify, the required emission reduction is $110 - 90 = 20$ tonnes. The amount of generation to shift from unit $1$ to unit $2$, $\\Delta x_{\\text{shift}}$, is:\n$$ \\Delta x_{\\text{shift}} = \\frac{\\text{Total emission reduction}}{e_1 - e_2} = \\frac{20}{0.8} = 25 \\text{ MWh} $$\nThe total generation from unit $1$ in the constrained case is $x_{1}^{\\text{con}} = (x_{1,1}^{\\text{unc}} + x_{1,2}^{\\text{unc}}) - 25 = 120 - 25 = 95$ MWh. The total generation from unit $2$ is $x_{2}^{\\text{con}} = (x_{2,1}^{\\text{unc}} + x_{2,2}^{\\text{unc}}) + 25 = 20 + 25 = 45$ MWh.\nClearly, unit 1's output is reduced (displaced) from the unconstrained optimum.\n\nThe final answer is composed of the shadow price $\\lambda^{\\star}$ and the index of the displaced unit $i_{\\text{displaced}}$.\n$\\lambda^{\\star} = 18.75$\n$i_{\\text{displaced}} = 1$",
            "answer": "$$ \\boxed{\\begin{pmatrix} 18.75 & 1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "The environmental value of a technology often depends on its role within the broader energy system, rather than its intrinsic properties. This practice explores this concept by analyzing an energy storage battery performing arbitrage between off-peak and peak periods, which are served by different marginal generators. Calculating the net operational carbon dioxide impact requires careful accounting of efficiencies and the emissions intensities of both the charging source and the displaced peak generator, a crucial skill for evaluating new technologies in evolving power grids. ",
            "id": "4088600",
            "problem": "Consider an electrochemical battery connected to the alternating current grid. During off-peak hours, the marginal generator is a subcritical coal unit, and during peak hours, the marginal generator is a natural gas simple-cycle turbine. The battery is charged off-peak and discharged during peak hours. Assume the following data and conventions, all on a higher heating value basis: the electric efficiency of the coal unit is $\\eta_{c} = 0.38$, the electric efficiency of the gas turbine is $\\eta_{g} = 0.40$, the carbon dioxide emission factor of coal is $EF_{c} = 94.6$ kg CO$_2$/GJ of fuel, the carbon dioxide emission factor of natural gas is $EF_{g} = 56.1$ kg CO$_2$/GJ of fuel, and the battery alternating current to alternating current round-trip efficiency is $\\eta_{rt} = 0.90$. Neglect non-carbon dioxide greenhouse gases, start-up transients, upstream emissions, and any transmission and distribution losses beyond what is implicit in the generator efficiencies. Use the energy conversion identity $1$ MWh $= 3.6$ GJ.\n\nStarting from first principles of energy conservation and the definition of emission intensity as fuel carbon dioxide emission factor times heat rate, compute the net operational carbon dioxide impact per $1$ MWh of peak electricity delivered by the battery. Define the net operational carbon dioxide impact as the coal carbon dioxide emitted to supply the charging energy minus the carbon dioxide that would have been emitted by the displaced gas turbine generation during discharge. Express your final result in kg CO$_2$/MWh and round your answer to three significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of energy conversion and thermodynamics, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe objective is to compute the net operational carbon dioxide impact per $1$ MWh of peak electricity delivered by the battery. This impact is defined as the CO$_2$ emitted to supply the charging energy minus the CO$_2$ that would have been emitted by the displaced peak generator.\n\nLet $E_{\\text{out}}$ be the electrical energy delivered by the battery during peak hours. We are asked to compute the net CO$_2$ impact for $E_{\\text{out}} = 1$ MWh.\n\nFirst, we establish the necessary quantities and their relationships based on first principles. The energy conversion identity is given as $1$ MWh $= 3.6$ GJ. Let's denote this conversion factor as $C = 3.6$ GJ/MWh. Thus, the energy delivered by the battery in units of gigajoules is:\n$$E_{\\text{out,GJ}} = E_{\\text{out}} \\times C = (1 \\text{ MWh}) \\times (3.6 \\frac{\\text{GJ}}{\\text{MWh}}) = 3.6 \\text{ GJ}$$\n\nThe process involves two main components: the emissions from charging the battery and the emissions avoided by discharging it.\n\n1.  **CO$_2$ Emissions from Charging:**\n    The battery is charged during off-peak hours using electricity from a coal unit. To deliver $E_{\\text{out}}$ of electrical energy, the battery must have been charged with a greater amount of energy, $E_{\\text{in}}$, due to losses. The relationship is governed by the AC-to-AC round-trip efficiency, $\\eta_{rt} = 0.90$.\n    $$E_{\\text{in}} = \\frac{E_{\\text{out,GJ}}}{\\eta_{rt}}$$\n    Substituting the values:\n    $$E_{\\text{in}} = \\frac{3.6 \\text{ GJ}}{0.90} = 4.0 \\text{ GJ}$$\n    This electrical energy, $E_{\\text{in}}$, is generated by the marginal coal unit, which has an electric efficiency of $\\eta_{c} = 0.38$. The fuel energy from coal, $F_{c}$, required to produce $E_{\\text{in}}$ is:\n    $$F_{c} = \\frac{E_{\\text{in}}}{\\eta_{c}} = \\frac{4.0 \\text{ GJ}}{0.38}$$\n    The CO$_2$ emissions from charging, $M_{c}$, are found by multiplying the fuel energy consumed, $F_{c}$, by the carbon dioxide emission factor of coal, $EF_{c} = 94.6$ kg CO$_2$/GJ.\n    $$M_{c} = F_{c} \\times EF_{c} = \\left(\\frac{4.0}{0.38}\\right) \\text{ GJ} \\times 94.6 \\frac{\\text{kg CO}_2}{\\text{GJ}}$$\n    $$M_{c} = \\frac{4.0 \\times 94.6}{0.38} \\text{ kg CO}_2 \\approx 995.789 \\text{ kg CO}_2$$\n\n2.  **Avoided CO$_2$ Emissions from Discharging:**\n    During peak hours, the battery discharges $E_{\\text{out,GJ}} = 3.6$ GJ of electricity, displacing generation from a natural gas simple-cycle turbine. We calculate the CO$_2$ emissions that would have occurred had the gas turbine produced this energy.\n    The electric efficiency of the gas turbine is $\\eta_{g} = 0.40$. The fuel energy from natural gas, $F_{g}$, that would have been required to produce $E_{\\text{out,GJ}}$ is:\n    $$F_{g} = \\frac{E_{\\text{out,GJ}}}{\\eta_{g}} = \\frac{3.6 \\text{ GJ}}{0.40} = 9.0 \\text{ GJ}$$\n    The avoided CO$_2$ emissions, $M_{g}$, are found by multiplying this fuel energy, $F_{g}$, by the carbon dioxide emission factor of natural gas, $EF_{g} = 56.1$ kg CO$_2$/GJ.\n    $$M_{g} = F_{g} \\times EF_{g} = 9.0 \\text{ GJ} \\times 56.1 \\frac{\\text{kg CO}_2}{\\text{GJ}}$$\n    $$M_{g} = 504.9 \\text{ kg CO}_2$$\n\n3.  **Net Operational CO$_2$ Impact:**\n    The net impact, $\\Delta M_{\\text{CO}_2}$, is the difference between the emissions from charging and the emissions avoided.\n    $$\\Delta M_{\\text{CO}_2} = M_{c} - M_{g}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 995.789 \\text{ kg CO}_2 - 504.9 \\text{ kg CO}_2 \\approx 490.889 \\text{ kg CO}_2$$\n    This is the net impact for delivering $1$ MWh of electricity. The required unit is kg CO$_2$/MWh. Our result is already in this form.\n\n    Combining all steps into a single analytical expression for the net impact per MWh:\n    $$\\Delta M_{\\text{CO}_2} = C \\left( \\frac{EF_c}{\\eta_{rt} \\eta_c} - \\frac{EF_g}{\\eta_g} \\right)$$\n    $$\\Delta M_{\\text{CO}_2} = 3.6 \\left( \\frac{94.6}{0.90 \\times 0.38} - \\frac{56.1}{0.40} \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} = 3.6 \\left( \\frac{94.6}{0.342} - 140.25 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 3.6 \\left( 276.608 - 140.25 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 3.6 \\left( 136.358 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}} \\approx 490.889 \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n\nFinally, we round the result to three significant figures as requested by the problem statement.\n$$\\Delta M_{\\text{CO}_2} \\approx 491 \\frac{\\text{kg CO}_2}{\\text{MWh}}$$",
            "answer": "$$\\boxed{491}$$"
        },
        {
            "introduction": "Effective climate policy often requires managing a cumulative emissions budget over a multi-year horizon, which introduces a dynamic element to planning. This advanced exercise transitions from static analysis to intertemporal optimization, a task well-suited for computational modeling. By formulating and solving a multi-period dispatch problem, you will not only determine the least-cost generation pathway but also extract the time-varying shadow price of carbon, revealing how its economic value evolves to efficiently stay within the budget over time. ",
            "id": "4088532",
            "problem": "Consider an intertemporal dispatch planning problem for an electricity system with two generation technologies over $T$ discrete time periods $t \\in \\{0,1,\\dots,T-1\\}$. Technology $F$ (fossil) has constant variable generation cost $c_F$ in dollars per megawatt-hour ($\\$/\\text{MWh}$) and constant emissions intensity $e_F$ in tonnes of carbon dioxide per megawatt-hour ($\\text{tCO}_2/\\text{MWh}$). Technology $R$ (renewable) has constant variable generation cost $c_R$ in dollars per megawatt-hour ($\\$/\\text{MWh}$) and zero emissions intensity. The renewable technology has a per-period capacity limit $C^R_t$ in megawatt-hours ($\\text{MWh}$). The fossil technology is assumed to have no binding capacity limits beyond nonnegativity. Electricity demand in period $t$ is $D_t$ in megawatt-hours ($\\text{MWh}$). Let $g_{F,t}$ and $g_{R,t}$ denote the generation by fossil and renewable technologies in period $t$ in megawatt-hours ($\\text{MWh}$), respectively.\n\nA social planner minimizes the present-value of total generation cost using a time discount factor $\\delta \\in (0,1]$ per period, subject to meeting demand in every period, respecting renewable capacity limits, nonnegativity of generation, and a hard cumulative carbon budget $B$ in tonnes of carbon dioxide ($\\text{tCO}_2$) over the entire horizon. Formally, the planner solves the following linear program:\nMinimize the present-value cost\n$$\n\\min_{\\{g_{F,t}, g_{R,t}\\}_{t=0}^{T-1}} \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right)\n$$\nsubject to the constraints\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\}.\n$$\n\nFrom first principles of convex optimization and Lagrangian duality, the Lagrange multiplier associated with the cumulative carbon budget constraint quantifies the shadow value of relaxing the budget by a marginal amount. Given that the objective uses time-discounted costs $\\delta^t$, the implied period-specific carbon shadow price in dollars per tonne of carbon dioxide ($\\$/\\text{tCO}_2$), measured in period-$t$ currency units, is the budget multiplier normalized by the discount factor. The objective of this problem is to compute the optimal plan and analyze the time profile of the implied carbon shadow price $\\{\\pi_t\\}_{t=0}^{T-1}$, where each $\\pi_t$ is defined as the period-$t$ carbon price consistent with the optimal solution.\n\nYour program must:\n- Formulate and solve the linear program for the given parameters using a reliable linear programming solver.\n- Extract the dual variable (Lagrange multiplier) $\\,\\mu\\,$ associated with the cumulative carbon budget constraint.\n- Compute the implied period-specific carbon shadow price path $\\pi_t = \\mu / \\delta^t$ for each $t \\in \\{0,1,\\dots,T-1\\}$, in dollars per tonne of carbon dioxide ($\\$/\\text{tCO}_2$).\n- Round each $\\pi_t$ to $3$ decimal places.\n\nUse the following fixed parameter values across all test cases:\n- Number of periods: $T = 4$.\n- Demands: $D_0 = 100\\,\\text{MWh}$, $D_1 = 110\\,\\text{MWh}$, $D_2 = 120\\,\\text{MWh}$, $D_3 = 130\\,\\text{MWh}$.\n- Renewable capacity limits: $C^R_0 = 50\\,\\text{MWh}$, $C^R_1 = 60\\,\\text{MWh}$, $C^R_2 = 70\\,\\text{MWh}$, $C^R_3 = 80\\,\\text{MWh}$.\n- Costs: $c_F = 30\\,\\$/\\text{MWh}$, $c_R = 60\\,\\$/\\text{MWh}$.\n- Emissions intensity: $e_F = 0.9\\,\\text{tCO}_2/\\text{MWh}$.\n\nConstruct a test suite by varying the discount factor $\\delta$ and the carbon budget $B$ to probe different regimes:\n- Test case $1$ (binding at the minimum feasible emissions with discounting): $\\delta = 0.95$, $B = e_F \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right)$. This is the minimum feasible $B$ that still allows all demand to be met using as much renewable generation as possible.\n- Test case $2$ (intermediate budget without discounting): $\\delta = 1.0$, $B = e_F \\left( \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right) + 0.5 \\sum_{t=0}^{T-1} C^R_t \\right)$. This budget is strictly between the minimum feasible and the unconstrained emissions level, and with no discounting the implied shadow price is expected to be constant over time if the budget binds.\n- Test case $3$ (loose carbon budget): $\\delta = 0.90$, $B = e_F \\sum_{t=0}^{T-1} D_t + 100$. This budget is sufficiently large that the carbon constraint is slack and the implied shadow price should be zero in all periods.\n\nPhysical units:\n- Report the carbon price path $\\{\\pi_t\\}$ in dollars per tonne of carbon dioxide ($\\$/\\text{tCO}_2$), rounded to $3$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a bracketed comma-separated list of $4$ floating-point numbers corresponding to $\\left[ \\pi_0, \\pi_1, \\pi_2, \\pi_3 \\right]$ for each test case in order. For example, the output should look like $\\left[ [\\pi_0^{(1)},\\pi_1^{(1)},\\pi_2^{(1)},\\pi_3^{(1)}],[\\pi_0^{(2)},\\pi_1^{(2)},\\pi_2^{(2)},\\pi_3^{(2)}],[\\pi_0^{(3)},\\pi_1^{(3)},\\pi_2^{(3)},\\pi_3^{(3)}] \\right]$.",
            "solution": "We begin from the definition of the social planner’s problem as a linear program over $T$ periods with decision variables $\\{ g_{F,t}, g_{R,t} \\}_{t=0}^{T-1}$ in megawatt-hours. The planner minimizes the present-value of cost, expressed as\n$$\n\\min \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right),\n$$\nsubject to the constraints\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\forall t,\n$$\n$$\ng_{R,t} \\le C^R_t \\quad \\forall t,\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\le B,\n$$\n$$\ng_{F,t} \\ge 0, \\quad g_{R,t} \\ge 0 \\quad \\forall t.\n$$\nThese constraints are linear, and the objective is linear in the decision variables, hence the problem is a linear program. Let $\\lambda_t$ be the Lagrange multipliers associated with the demand constraints $g_{F,t} + g_{R,t} = D_t$, let $\\eta_t \\ge 0$ be the multipliers for the renewable capacity constraints $g_{R,t} \\le C^R_t$, let $\\mu \\le 0$ be the multiplier for the cumulative carbon budget constraint $\\sum_t e_F g_{F,t} \\le B$ under the standard inequality convention for minimization where “less-than-or-equal” constraints have nonpositive multipliers, and let $\\phi_{F,t} \\ge 0$ and $\\phi_{R,t} \\ge 0$ be nonnegativity multipliers for $g_{F,t}$ and $g_{R,t}$ respectively.\n\nThe Lagrangian is\n$$\n\\mathcal{L} = \\sum_{t=0}^{T-1} \\delta^t (c_F g_{F,t} + c_R g_{R,t})\n+ \\sum_{t=0}^{T-1} \\lambda_t \\left( D_t - g_{F,t} - g_{R,t} \\right)\n+ \\sum_{t=0}^{T-1} \\eta_t \\left( g_{R,t} - C^R_t \\right)\n+ \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right)\n- \\sum_{t=0}^{T-1} \\phi_{F,t} g_{F,t}\n- \\sum_{t=0}^{T-1} \\phi_{R,t} g_{R,t}.\n$$\nStationarity with respect to $g_{F,t}$ and $g_{R,t}$ yields, for each $t$,\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{F,t}} = \\delta^t c_F - \\lambda_t + \\mu e_F - \\phi_{F,t} = 0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{R,t}} = \\delta^t c_R - \\lambda_t + \\eta_t - \\phi_{R,t} = 0.\n$$\nComplementary slackness conditions include, for each $t$,\n$$\n\\eta_t \\ge 0,\\quad g_{R,t} \\le C^R_t,\\quad \\eta_t \\left( g_{R,t} - C^R_t \\right) = 0,\n$$\n$$\n\\mu \\le 0,\\quad \\sum_{t=0}^{T-1} e_F g_{F,t} \\le B,\\quad \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right) = 0,\n$$\n$$\n\\phi_{F,t} \\ge 0,\\quad g_{F,t} \\ge 0,\\quad \\phi_{F,t} g_{F,t} = 0,\n$$\n$$\n\\phi_{R,t} \\ge 0,\\quad g_{R,t} \\ge 0,\\quad \\phi_{R,t} g_{R,t} = 0.\n$$\nThe multiplier $\\mu$ measures the marginal change in the present-value optimal objective from a unit relaxation of the carbon budget $B$. Because the budget constraint appears as $\\sum_t e_F g_{F,t} \\le B$ without discounting, the associated Lagrange multiplier $\\mu$ is in present-value dollars per tonne of carbon dioxide ($\\$/\\text{tCO}_2$) but enters stationarity conditions additively alongside the discounted marginal costs $\\delta^t c_F$. To interpret the implied shadow price of carbon in period-$t$ currency units, note that the marginal tradeoff in period $t$ equates a change of one unit of $g_{F,t}$ (which increases emissions by $e_F$) to a change in the discounted cost $\\delta^t c_F$. Normalizing by the discount factor, the period-specific carbon price consistent with the optimality conditions is\n$$\n\\pi_t = -\\frac{\\mu}{\\delta^t},\n$$\nwhere the minus sign converts the standard inequality multiplier convention ($\\mu \\le 0$) into a positive shadow price in dollars per tonne of carbon dioxide. If the carbon budget constraint is slack, then $\\mu = 0$ and $\\pi_t = 0$ for all $t$.\n\nAlgorithmic procedure:\n1. Encode the linear program with variables ordered as $\\left( g_{F,0}, \\dots, g_{F,T-1}, g_{R,0}, \\dots, g_{R,T-1} \\right)$. The objective coefficient vector places $\\delta^t c_F$ for fossil variables and $\\delta^t c_R$ for renewable variables in the appropriate positions.\n2. Implement the equality constraints $g_{F,t} + g_{R,t} = D_t$ for each $t$. Implement the inequality constraints $g_{R,t} \\le C^R_t$ for each $t$, and the single cumulative carbon budget constraint $\\sum_t e_F g_{F,t} \\le B$.\n3. Solve the linear program using a robust method that returns dual information for both equality and inequality constraints. For each test case, ensure feasibility by choosing $B$ consistent with the renewable capacity limits and demands.\n4. Extract the Lagrange multiplier (dual) for the carbon budget inequality. Under the standard “less-than-or-equal” formulation in minimization, the solver returns a nonpositive multiplier for a binding constraint and zero for a slack constraint. Denote this multiplier by $\\mu$.\n5. Compute the implied period-specific carbon shadow price path as $\\pi_t = -\\mu / \\delta^t$ in dollars per tonne of carbon dioxide, and round each $\\pi_t$ to $3$ decimal places.\n6. Aggregate the results for the test suite into the specified single-line output format.\n\nInterpretation in the designed tests:\n- In test case $1$, the budget equals the minimum feasible emissions, forcing maximal use of renewables. With $\\delta \\in (0,1)$, the present-value weighting makes future costs carry less weight, so the implied carbon price path $\\pi_t$ rises over time according to the $1/\\delta^t$ normalization.\n- In test case $2$, with $\\delta = 1$, the implied carbon price is constant across time when the budget binds, because present-value and period costs coincide without discounting.\n- In test case $3$, the budget is loose and the constraint is slack, implying $\\mu = 0$ and thus $\\pi_t = 0$ for all $t$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F):\n    \"\"\"\n    Solve the LP for given parameters and return the implied period-specific carbon price path.\n    Prices are in $/tCO2 for periods t=0..T-1.\n    \"\"\"\n    T = len(D)\n    # Variable ordering: [gF_0, ..., gF_{T-1}, gR_0, ..., gR_{T-1}]\n    n_vars = 2 * T\n\n    # Objective coefficients: discounted costs\n    c = np.zeros(n_vars, dtype=float)\n    for t in range(T):\n        c[t] = (delta ** t) * c_F\n        c[T + t] = (delta ** t) * c_R\n\n    # Equality constraints: gF_t + gR_t = D_t\n    A_eq = np.zeros((T, n_vars), dtype=float)\n    b_eq = np.array(D, dtype=float)\n    for t in range(T):\n        A_eq[t, t] = 1.0          # gF_t\n        A_eq[t, T + t] = 1.0      # gR_t\n\n    # Inequality constraints:\n    # 1) Renewable capacity: gR_t <= cap_R[t]\n    # 2) Carbon budget: sum_t e_F * gF_t <= B\n    A_ub = np.zeros((T + 1, n_vars), dtype=float)\n    b_ub = np.zeros(T + 1, dtype=float)\n\n    # Renewable capacity constraints\n    for t in range(T):\n        A_ub[t, T + t] = 1.0\n        b_ub[t] = cap_R[t]\n\n    # Carbon budget constraint (last inequality)\n    for t in range(T):\n        A_ub[T, t] = e_F\n    b_ub[T] = B\n\n    # Bounds: gF_t >= 0, gR_t >= 0 (no explicit upper bounds on fossil)\n    bounds = [(0, None)] * n_vars\n\n    # Solve LP using HiGHS\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq,\n                  bounds=bounds, method='highs')\n\n    if not res.success:\n        # In case of numerical issues or infeasibility, return NaNs\n        return [float('nan')] * T\n\n    # Extract the dual (Lagrange multiplier) for the carbon budget inequality.\n    # SciPy (HiGHS) returns inequality multipliers in res.ineqlin.marginals for A_ub @ x <= b_ub,\n    # with the convention that binding constraints in a minimization have nonpositive multipliers.\n    try:\n        duals_ub = res.ineqlin.marginals\n        mu = duals_ub[-1]  # Carbon budget is the last inequality\n    except Exception:\n        # Fallback: if the structure isn't present (shouldn't happen), set mu=0\n        mu = 0.0\n\n    # Implied carbon price path in period-t currency: pi_t = -mu / delta^t\n    # Ensure that tiny numerical noise does not produce negative zeros, clamp near-zero to zero.\n    prices = []\n    for t in range(T):\n        denom = (delta ** t)\n        # Avoid division by zero if delta=0 (not allowed by problem specification), but safeguard.\n        if denom == 0.0:\n            pi_t = float('inf')\n        else:\n            pi_t = -mu / denom\n        # Clean small numerical artifacts\n        if abs(pi_t) < 1e-9:\n            pi_t = 0.0\n        # Round to 3 decimals\n        pi_t = float(f\"{pi_t:.3f}\")\n        prices.append(pi_t)\n\n    return prices\n\ndef solve():\n    # Fixed parameters across all tests\n    T = 4\n    D = [100.0, 110.0, 120.0, 130.0]          # MWh\n    cap_R = [50.0, 60.0, 70.0, 80.0]          # MWh\n    c_F = 30.0                                # $/MWh\n    c_R = 60.0                                # $/MWh\n    e_F = 0.9                                 # tCO2/MWh\n\n    # Helper quantities for budgets\n    sum_D = sum(D)\n    sum_cap_R = sum(cap_R)\n    min_emissions_budget = e_F * sum((D[t] - cap_R[t]) for t in range(T))  # minimum feasible B\n\n    # Test suite:\n    # 1) Binding at minimum feasible emissions with discounting\n    delta1 = 0.95\n    B1 = min_emissions_budget\n\n    # 2) Intermediate budget without discounting (between min and max emissions)\n    delta2 = 1.0\n    B2 = e_F * (sum((D[t] - cap_R[t]) for t in range(T)) + 0.5 * sum_cap_R)\n\n    # 3) Loose carbon budget (constraint slack)\n    delta3 = 0.90\n    B3 = e_F * sum_D + 100.0\n\n    test_cases = [\n        (delta1, B1),\n        (delta2, B2),\n        (delta3, B3),\n    ]\n\n    results = []\n    for (delta, B) in test_cases:\n        prices = compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F)\n        results.append(prices)\n\n    # Format as specified: a single line, list of lists with 4 floats each\n    # Convert inner lists to string with bracketed comma-separated floats\n    inner_strs = []\n    for lst in results:\n        inner_strs.append(f\"[{','.join(map(lambda x: f'{x:.3f}', lst))}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}