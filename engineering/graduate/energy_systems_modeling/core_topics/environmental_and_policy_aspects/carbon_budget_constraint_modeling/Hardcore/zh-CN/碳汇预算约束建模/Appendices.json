{
    "hands_on_practices": [
        {
            "introduction": "在构建任何碳约束模型之前，首要步骤是准确量化系统中各个技术单元的排放特性。本练习旨在从基本工程原理出发，推导单个发电机组的边际排放强度()。通过这个实践，您将掌握如何综合考虑燃料碳含量、发电效率和碳捕获率这些关键参数，从而为更复杂的系统分析奠定坚实的基础。",
            "id": "4075572",
            "problem": "考虑一个在时间段 $t$ 内运行、索引为 $i$ 的火力发电机。设 $c_i$ 表示燃料碳含量，其定义为每单位燃料能量输入所形成的二氧化碳质量，以低位热值（LHV）为基准，单位为 $\\mathrm{kg\\,CO_2/GJ_{fuel}}$。设 $\\eta_{i,t}$ 表示净发电效率，定义为输送的电能输出与燃料能量输入之比；设 $\\kappa_{i,t}$ 表示在时间段 $t$ 内，由燃烧后碳捕获系统捕获并永久储存的二氧化碳比例。假设过程边界仅包括燃烧产生的直接烟囱排放，不包括上游燃料循环排放；假设 $\\eta_{i,t}$ 是已计入碳捕获相关能量惩罚的净效率；并假设 $\\kappa_{i,t}$ 代表燃烧形成的二氧化碳中未排放到大气中的部分所占的比例。\n\n请严格根据以上定义和碳质量平衡，推导发电机边际排放强度 $\\phi_{i,t}$ 的表达式，该强度定义为每单位输送电力所排放的二氧化碳。请仔细论证推导过程中的量纲一致性以及使用的任何建模假设。然后，对于一个联合循环天然气发电机，使用参数 $c_i=56.1\\,\\mathrm{kg\\,CO_2/GJ}$、$\\eta_{i,t}=0.54$ 和 $\\kappa_{i,t}=0.85$ 进行数值计算，求出 $\\phi_{i,t}$ 的值。将最终数值答案以 $\\mathrm{kg\\,CO_2/MWh}$（电力）为单位表示，并四舍五入至四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当且客观。它提供了来自能源系统工程领域的明确定义和实际参数，用以推导一个标准的性能指标。\n\n边际排放强度 $\\phi_{i,t}$ 的推导始于将给定物理量之间的关系公式化。设 $E_{fuel, i, t}$ 表示在时间段 $t$ 内发电机 $i$ 的燃料能量输入， $E_{elec, i, t}$ 表示净输送电能输出。设 $M_{\\mathrm{CO_2}, form, i, t}$、$M_{\\mathrm{CO_2}, capt, i, t}$ 和 $M_{\\mathrm{CO_2}, emit, i, t}$ 分别表示燃烧过程中形成、被捕获以及排放到大气中的二氧化碳质量。\n\n根据问题的定义：\n1.  净发电效率 $\\eta_{i,t}$ 是电能输出与燃料输入之比：\n    $$ \\eta_{i,t} = \\frac{E_{elec, i, t}}{E_{fuel, i, t}} $$\n2.  燃料碳含量 $c_i$ 将形成的 $\\mathrm{CO_2}$ 质量与燃料能量输入关联起来：\n    $$ c_i = \\frac{M_{\\mathrm{CO_2}, form, i, t}}{E_{fuel, i, t}} $$\n3.  碳捕获率 $\\kappa_{i,t}$ 是捕获的 $\\mathrm{CO_2}$ 与形成的 $\\mathrm{CO_2}$ 之比：\n    $$ \\kappa_{i,t} = \\frac{M_{\\mathrm{CO_2}, capt, i, t}}{M_{\\mathrm{CO_2}, form, i, t}} $$\n\n推导基于发电机的碳质量平衡。排放的 $\\mathrm{CO_2}$ 质量等于燃烧过程中形成的总质量减去被捕获和储存的质量。\n$$ M_{\\mathrm{CO_2}, emit, i, t} = M_{\\mathrm{CO_2}, form, i, t} - M_{\\mathrm{CO_2}, capt, i, t} $$\n将方程(3)中 $\\kappa_{i,t}$ 的定义代入质量平衡方程，得到：\n$$ M_{\\mathrm{CO_2}, emit, i, t} = M_{\\mathrm{CO_2}, form, i, t} - \\kappa_{i,t} M_{\\mathrm{CO_2}, form, i, t} = (1 - \\kappa_{i,t}) M_{\\mathrm{CO_2}, form, i, t} $$\n接下来，使用方程(2)中 $c_i$ 的定义来表示形成的 $\\mathrm{CO_2}$ 质量：\n$$ M_{\\mathrm{CO_2}, emit, i, t} = (1 - \\kappa_{i,t}) (c_i E_{fuel, i, t}) $$\n\n边际排放强度 $\\phi_{i,t}$ 定义为每单位输送电力所排放的 $\\mathrm{CO_2}$：\n$$ \\phi_{i,t} = \\frac{M_{\\mathrm{CO_2}, emit, i, t}}{E_{elec, i, t}} $$\n代入推导出的 $M_{\\mathrm{CO_2}, emit, i, t}$ 表达式：\n$$ \\phi_{i,t} = \\frac{(1 - \\kappa_{i,t}) c_i E_{fuel, i, t}}{E_{elec, i, t}} $$\n根据方程(1)中效率的定义，燃料能量输入与电能输出之比是效率的倒数，即 $E_{fuel, i, t} / E_{elec, i, t} = 1/\\eta_{i,t}$。将此关系代入 $\\phi_{i,t}$ 的表达式，得到最终的解析公式：\n$$ \\phi_{i,t} = \\frac{c_i (1 - \\kappa_{i,t})}{\\eta_{i,t}} $$\n\n该推导基于给定的定义和质量守恒原理。关键的建模假设是，如前所述，分析仅考虑直接烟囱排放。$\\eta_{i,t}$ 是扣除捕获能量惩罚后的净值的定义至关重要，因为它将所有能源消耗正确地分配给最终的电力产品，从而提供了对电厂性能的真实度量。\n\n为了保证量纲一致性，$c_i$ 的单位为 $\\mathrm{kg\\,CO_2/GJ_{fuel}}$。$\\eta_{i,t}$ 和 $\\kappa_{i,t}$ 均为无量纲量。因此，推导出的 $\\phi_{i,t}$ 表达式的单位为 $\\mathrm{kg\\,CO_2/GJ}$。由于 $\\eta_{i,t}$ 关联了燃料能量和电能，$\\phi_{i,t}$ 分母中的能量单位是吉焦耳电力（$\\mathrm{GJ}_{elec}$）。问题要求结果以 $\\mathrm{kg\\,CO_2/MWh}$ 为单位，因此需要进行单位换算。\n兆瓦时（$\\mathrm{MWh}$）和吉焦耳（$\\mathrm{GJ}$）之间的转换因子是：\n$$ 1 \\, \\mathrm{MWh} = 1 \\times 10^6 \\, \\mathrm{W} \\cdot \\mathrm{h} = (1 \\times 10^6 \\, \\mathrm{J/s}) \\times (3600 \\, \\mathrm{s}) = 3.6 \\times 10^9 \\, \\mathrm{J} $$\n因为 $1 \\, \\mathrm{GJ} = 10^9 \\, \\mathrm{J}$，所以 $1 \\, \\mathrm{MWh} = 3.6 \\, \\mathrm{GJ}$。因此，转换因子为 $3.6 \\, \\mathrm{GJ/MWh}$。\n用于计算的最终公式是：\n$$ \\phi_{i,t} \\, [\\mathrm{kg/MWh}] = \\left( \\frac{c_i (1 - \\kappa_{i,t})}{\\eta_{i,t}} \\right) [\\mathrm{kg/GJ}] \\times 3.6 \\, [\\mathrm{GJ/MWh}] $$\n\n现在，使用为联合循环天然气发电机提供的参数进行数值计算：$c_i=56.1\\,\\mathrm{kg\\,CO_2/GJ}$，$\\eta_{i,t}=0.54$ 和 $\\kappa_{i,t}=0.85$。\n将这些值代入公式：\n$$ \\phi_{i,t} = \\frac{56.1 \\cdot (1 - 0.85)}{0.54} \\times 3.6 $$\n$$ \\phi_{i,t} = \\frac{56.1 \\cdot 0.15}{0.54} \\times 3.6 $$\n$$ \\phi_{i,t} = \\frac{8.415}{0.54} \\times 3.6 $$\n$$ \\phi_{i,t} = 15.58\\overline{3} \\times 3.6 $$\n$$ \\phi_{i,t} = 56.1 $$\n计算得出精确值为 $56.1$。问题要求答案四舍五入到四位有效数字。因此，结果是 $56.10 \\, \\mathrm{kg\\,CO_2/MWh}$。",
            "answer": "$$\n\\boxed{56.10}\n$$"
        },
        {
            "introduction": "在掌握了单个组件的排放计算后，我们进一步探讨简单的系统级互动。本练习通过一个简化的双周期模型，揭示了储能技术在碳减排中的复杂作用()。您将分析能量套利（在低排放强度时段放电，在高排放强度时段充电）的净碳效应，并理解往返效率如何成为决定储能是减少还是增加系统总排放的关键因素。",
            "id": "4075569",
            "problem": "考虑一个双周期电力系统模型，其中高排放周期记为 $H$，低排放周期记为 $L$。设系统在时间 $t$ 的边际排放强度为 $\\gamma_{t}$，单位为吨二氧化碳/兆瓦时 (tCO$_2$/MWh)。单个储能设备执行一个完整的充放电循环，将能量从周期 $H$ 转移到周期 $L$（即，在周期 $H$ 充电，在周期 $L$ 放电）。该储能设备的往返效率 $\\eta_{\\text{rt}} \\in (0,1)$ 为恒定值，定义为一个循环中放电电能与充电电能之比。\n\n使用以下基本原则：\n- 针对全经济范围碳预算的碳核算意味着，满足负荷的碳成本是边际排放强度与满足净负荷所需发电量之积随时间累加的总和，即，在时间 $t$ 由任何使发电量增加 $\\Delta G_{t}$ 的干预措施所引起的总碳排放变化为 $\\sum_{t}\\gamma_{t}\\Delta G_{t}$。\n- 储能的能量守恒意味着，如果在一个循环中充电能量为 $C$，放电能量为 $D$，则 $D = \\eta_{\\text{rt}}\\,C$。\n\n设 $D$ 表示储能设备在周期 $L$ 期间输送的电能，单位为兆瓦时 (MWh)。假设给定以下参数：\n- $\\gamma_{H} = 0.60$ tCO$_2$/MWh,\n- $\\gamma_{L} = 0.20$ tCO$_2$/MWh,\n- $\\eta_{\\text{rt}} = 0.90$,\n- $D = 40$ MWh.\n\n任务：\n1. 仅从上述基本原则出发，推导该单次储能循环导致的总排放净变化量 $E^{\\text{net}}$ 的闭式表达式，该表达式应为 $\\gamma_{H}$、$\\gamma_{L}$、$\\eta_{\\text{rt}}$ 和 $D$ 的函数。您的表达式必须包含周期 $H$ 充电的贡献以及因周期 $L$ 放电而替代的发电量。\n2. 使用您推导的表达式，计算给定参数下 $E^{\\text{net}}$ 的数值。\n\n以吨二氧化碳 (tCO$_2$) 为单位表示最终结果，并将您的答案四舍五入到四位有效数字。仅报告最终数值作为您的答案。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题陈述中明确提供的数据、变量和定义如下：\n- 两个时间周期：高排放 ($H$) 和低排放 ($L$)。\n- 时间 $t$ 的边际排放强度：$\\gamma_{t}$，单位为 tCO$_2$/MWh。\n- 单个储能设备执行一个循环：在周期 $H$ 充电，在周期 $L$ 放电。\n- 储能设备的往返效率：$\\eta_{\\text{rt}} \\in (0,1)$。\n- 碳核算的基本原则：对于导致发电量变化 $\\Delta G_{t}$ 的干预，总碳排放量的变化为 $\\sum_{t}\\gamma_{t}\\Delta G_{t}$。\n- 储能能量守恒的基本原则：$D = \\eta_{\\text{rt}}\\,C$，其中 $C$ 是充电能量，$D$ 是放电能量。\n- $D$ 是储能设备在周期 $L$ 期间输送的电能。\n- 给定的数值：\n    - $\\gamma_{H} = 0.60$ tCO$_2$/MWh\n    - $\\gamma_{L} = 0.20$ tCO$_2$/MWh\n    - $\\eta_{\\text{rt}} = 0.90$\n    - $D = 40$ MWh\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题使用了能源系统分析中的标准简化模型。边际排放强度、往返效率和能量套利等概念是公认且科学合理的。所提供的数值对于现代电网是物理上现实的。\n- **适定性：** 问题提供了所有必要的数据和定义，以推导唯一的解析表达式并计算确定的数值结果。任务陈述清晰。\n- **客观性：** 问题以精确、量化的术语表述。没有主观或基于意见的陈述。\n- **完整性与一致性：** 问题设定是自洽的。提供的两个基本原则相互一致，并且足以解决问题。没有缺失或矛盾的条件。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**，因为其具有科学依据、适定性、客观性且内部一致。现在开始求解过程。\n\n### 解题推导\n首要任务是推导储能循环导致的总排放净变化量 $E^{\\text{net}}$ 的表达式。\n\n根据碳核算的基本原则，排放净变化是每个周期排放变化的总和。储能循环影响周期 $H$ 和周期 $L$ 的发电量。因此，净排放的表达式为：\n$$E^{\\text{net}} = \\gamma_{H}\\Delta G_{H} + \\gamma_{L}\\Delta G_{L}$$\n其中 $\\Delta G_{H}$ 和 $\\Delta G_{L}$ 分别是周期 $H$ 和周期 $L$ 所需的电网发电量变化。\n\n**1. 充电周期 ($H$) 分析**\n在周期 $H$ 期间，储能设备充电，从电网吸收能量 $C$。这个额外的能源消耗必须由电网发电厂增加发电量来满足。因此，此期间的发电量变化是等于充电能量的增加量：\n$$\\Delta G_{H} = +C$$\n\n**2. 放电周期 ($L$) 分析**\n在周期 $L$ 期间，储能设备放电，向电网供应能量 $D$。供应的能量满足了部分系统负荷，从而替代或减少了电网发电厂所需的发电量。因此，此期间的发电量变化是等于放电能量的减少量：\n$$\\Delta G_{L} = -D$$\n\n**3. 组合净排放表达式**\n将 $\\Delta G_{H}$ 和 $\\Delta G_{L}$ 的表达式代入净排放方程，得到：\n$$E^{\\text{net}} = \\gamma_{H}C - \\gamma_{L}D$$\n该表达式同时依赖于 $C$ 和 $D$。问题要求最终表达式是 $D$、$\\gamma_{H}$、$\\gamma_{L}$ 和 $\\eta_{\\text{rt}}$ 的函数。我们使用储能的能量守恒基本原则 $D = \\eta_{\\text{rt}}C$ 来消去 $C$。重新整理此关系式得到：\n$$C = \\frac{D}{\\eta_{\\text{rt}}}$$\n将 $C$ 的这个表达式代入 $E^{\\text{net}}$ 的方程中：\n$$E^{\\text{net}} = \\gamma_{H}\\left(\\frac{D}{\\eta_{\\text{rt}}}\\right) - \\gamma_{L}D$$\n\n**4. 最终闭式表达式 (任务 1)**\n将项 $D$ 提取出来，得到所需的总排放净变化量的闭式表达式：\n$$E^{\\text{net}} = D\\left(\\frac{\\gamma_{H}}{\\eta_{\\text{rt}}} - \\gamma_{L}\\right)$$\n\n### 数值计算 (任务 2)\n使用推导出的表达式，我们现在可以用给定的参数计算 $E^{\\text{net}}$ 的数值：\n- $D = 40$ MWh\n- $\\gamma_{H} = 0.60$ tCO$_2$/MWh\n- $\\gamma_{L} = 0.20$ tCO$_2$/MWh\n- $\\eta_{\\text{rt}} = 0.90$\n\n将这些值代入方程中：\n$$E^{\\text{net}} = 40 \\left(\\frac{0.60}{0.90} - 0.20\\right)$$\n首先，计算括号内的项：\n$$\\frac{0.60}{0.90} = \\frac{6}{9} = \\frac{2}{3}$$\n$$E^{\\text{net}} = 40 \\left(\\frac{2}{3} - 0.20\\right)$$\n为了相减，我们可以使用公分母。注意 $0.20 = \\frac{1}{5}$。\n$$E^{\\text{net}} = 40 \\left(\\frac{2}{3} - \\frac{1}{5}\\right) = 40 \\left(\\frac{10 - 3}{15}\\right) = 40 \\left(\\frac{7}{15}\\right)$$\n现在，进行最后的乘法运算：\n$$E^{\\text{net}} = \\frac{40 \\times 7}{15} = \\frac{(8 \\times 5) \\times 7}{3 \\times 5} = \\frac{8 \\times 7}{3} = \\frac{56}{3}$$\n数值约为 $18.666...$ tCO$_2$。\n\n问题要求将答案四舍五入到四位有效数字。\n$$E^{\\text{net}} \\approx 18.67 \\text{ tCO}_2$$\n正值表示此次储能循环导致了碳排放的净增加。这是因为在低排放周期避免的排放量不足以抵消高排放周期产生的排放量，并且往返效率 $\\eta_{\\text{rt}}  1$ 所代表的能量损失加剧了这一情况。",
            "answer": "$$\\boxed{18.67}$$"
        },
        {
            "introduction": "本章的最终实践将引导您构建并求解一个完整的（尽管是简化的）能源系统优化模型，这是将理论付诸实践的关键一步。通过这个练习()，您将使用线性规划来确定满足需求和碳预算约束下的最优发电调度方案。更重要的是，您将学会如何揭示碳预算这一硬性约束的内生经济价值——即碳的影子价格，并分析其在不同情景下的动态演变路径。",
            "id": "4088532",
            "problem": "考虑一个电力系统的跨期调度计划问题，该系统包含两种发电技术，时间跨度为 $T$ 个离散时间周期 $t \\in \\{0,1,\\dots,T-1\\}$。技术 $F$（化石燃料）具有恒定的可变发电成本 $c_F$（单位：美元/兆瓦时，$\\$/\\text{MWh}$）和恒定的排放强度 $e_F$（单位：吨二氧化碳/兆瓦时，$\\text{tCO}_2/\\text{MWh}$）。技术 $R$（可再生能源）具有恒定的可变发电成本 $c_R$（单位：美元/兆瓦时，$\\$/\\text{MWh}$）和零排放强度。可再生能源技术在每个周期有容量上限 $C^R_t$（单位：兆瓦时，$\\text{MWh}$）。假设化石燃料技术除了非负性之外，没有约束性的容量上限。周期 $t$ 的电力需求为 $D_t$（单位：兆瓦时，$\\text{MWh}$）。令 $g_{F,t}$ 和 $g_{R,t}$ 分别表示在周期 $t$ 化石燃料和可再生能源技术的发电量（单位：兆瓦时，$\\text{MWh}$）。\n\n一个社会规划者在满足每个周期的需求、遵守可再生能源容量上限、发电量非负性以及整个规划期内累积碳排放总量不超过硬性上限 $B$（单位：吨二氧化碳，$\\text{tCO}_2$）的前提下，使用每个周期的贴现因子 $\\delta \\in (0,1]$ 来最小化总发电成本的现值。形式上，该规划者求解以下线性规划问题：\n最小化现值成本\n$$\n\\min_{\\{g_{F,t}, g_{R,t}\\}_{t=0}^{T-1}} \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right)\n$$\n受以下约束\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\}.\n$$\n\n根据凸优化和拉格朗日对偶性的基本原理，与累积碳预算约束相关的拉格朗日乘子量化了边际上放宽预算的影子价值。鉴于目标函数使用时间贴现成本 $\\delta^t$，以第 $t$ 期的货币单位衡量的隐含的特定时期碳影子价格，是预算乘子通过贴现因子归一化后的结果。本问题的目标是计算最优计划，并分析隐含的碳影子价格的时间序列 $\\{\\pi_t\\}_{t=0}^{T-1}$，其中每个 $\\pi_t$ 定义为与最优解一致的第 $t$ 期碳价格。\n\n你的程序必须：\n- 使用可靠的线性规划求解器构建并求解给定参数的线性规划问题。\n- 提取与累积碳预算约束相关的对偶变量（拉格朗日乘子）$\\,\\mu\\,$。\n- 计算隐含的特定时期碳影子价格路径 $\\pi_t = \\mu / \\delta^t$，单位为美元/吨二氧化碳（$\\$/\\text{tCO}_2$），适用于每个 $t \\in \\{0,1,\\dots,T-1\\}$。\n- 将每个 $\\pi_t$ 四舍五入到 3 位小数。\n\n在所有测试用例中使用以下固定参数值：\n- 周期数：$T = 4$。\n- 需求：$D_0 = 100\\,\\text{MWh}$，$D_1 = 110\\,\\text{MWh}$，$D_2 = 120\\,\\text{MWh}$，$D_3 = 130\\,\\text{MWh}$。\n- 可再生能源容量上限：$C^R_0 = 50\\,\\text{MWh}$，$C^R_1 = 60\\,\\text{MWh}$，$C^R_2 = 70\\,\\text{MWh}$，$C^R_3 = 80\\,\\text{MWh}$。\n- 成本：$c_F = 30\\,\\$/\\text{MWh}$，$c_R = 60\\,\\$/\\text{MWh}$。\n- 排放强度：$e_F = 0.9\\,\\text{tCO}_2/\\text{MWh}$。\n\n通过改变贴现因子 $\\delta$ 和碳预算 $B$ 来构建一个测试套件，以探究不同的情景：\n- 测试用例 1 (在有贴现的情况下，约束在最低可行排放水平上具有约束力)：$\\delta = 0.95$，$B = e_F \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right)$。这是在尽可能多地使用可再生能源发电以满足所有需求的情况下，可行的最小 $B$ 值。\n- 测试用例 2 (在没有贴現的情況下，采用中间预算)：$\\delta = 1.0$，$B = e_F \\left( \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right) + 0.5 \\sum_{t=0}^{T-1} C^R_t \\right)$。该预算严格介于最低可行排放水平和无约束排放水平之间，并且在没有贴现的情况下，如果预算具有约束力，则隐含的影子价格预计将随时间保持不变。\n- 测试用例 3 (宽松的碳预算)：$\\delta = 0.90$，$B = e_F \\sum_{t=0}^{T-1} D_t + 100$。该预算足够大，使得碳约束是松弛的，因此隐含的影子价格在所有时期都應为零。\n\n物理单位：\n- 报告碳价格路径 $\\{\\pi_t\\}$，单位为美元/吨二氧化碳（$\\$/\\text{tCO}_2$），四舍五入到 3 位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身都是一个包含 4 个浮点数的方括号逗号分隔列表，按顺序对应每个测试用例的 $\\left[ \\pi_0, \\pi_1, \\pi_2, \\pi_3 \\right]$。例如，输出应类似于 $\\left[ [\\pi_0^{(1)},\\pi_1^{(1)},\\pi_2^{(1)},\\pi_3^{(1)}],[\\pi_0^{(2)},\\pi_1^{(2)},\\pi_2^{(2)},\\pi_3^{(2)}],[\\pi_0^{(3)},\\pi_1^{(3)},\\pi_2^{(3)},\\pi_3^{(3)}] \\right]$。",
            "solution": "我们从社会规划者问题的定义开始，这是一个在 $T$ 个周期内的线性规划问题，决策变量为 $\\{ g_{F,t}, g_{R,t} \\}_{t=0}^{T-1}$（单位为兆瓦时）。规划者最小化成本的现值，表达式为\n$$\n\\min \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right),\n$$\n受以下约束\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\forall t,\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\forall t,\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\forall t.\n$$\n这些约束是线性的，目标函数对于决策变量也是线性的，因此该问题是一个线性规划问题。设 $\\lambda_t$ 是与需求约束 $g_{F,t} + g_{R,t} = D_t$ 相关的拉格朗日乘子，$\\eta_t \\geq 0$ 是可再生能源容量约束 $g_{R,t} \\leq C^R_t$ 的乘子，$\\mu \\leq 0$ 是累积碳预算约束 $\\sum_t e_F g_{F,t} \\leq B$ 的乘子（根据最小化问题中“小于等于”约束具有非正乘子的标准不等式约定），$\\phi_{F,t} \\geq 0$ 和 $\\phi_{R,t} \\geq 0$ 分别是 $g_{F,t}$ 和 $g_{R,t}$ 的非负性乘子。\n\n拉格朗日函数为\n$$\n\\mathcal{L} = \\sum_{t=0}^{T-1} \\delta^t (c_F g_{F,t} + c_R g_{R,t})\n+ \\sum_{t=0}^{T-1} \\lambda_t \\left( D_t - g_{F,t} - g_{R,t} \\right)\n+ \\sum_{t=0}^{T-1} \\eta_t \\left( g_{R,t} - C^R_t \\right)\n+ \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right)\n- \\sum_{t=0}^{T-1} \\phi_{F,t} g_{F,t}\n- \\sum_{t=0}^{T-1} \\phi_{R,t} g_{R,t}.\n$$\n关于 $g_{F,t}$ 和 $g_{R,t}$ 的平稳性条件为，对于每个 $t$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{F,t}} = \\delta^t c_F - \\lambda_t + \\mu e_F - \\phi_{F,t} = 0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{R,t}} = \\delta^t c_R - \\lambda_t + \\eta_t - \\phi_{R,t} = 0.\n$$\n互补松弛条件包括，对于每个 $t$：\n$$\n\\eta_t \\geq 0,\\quad g_{R,t} \\leq C^R_t,\\quad \\eta_t \\left( g_{R,t} - C^R_t \\right) = 0,\n$$\n$$\n\\mu \\leq 0,\\quad \\sum_{t=0}^{T-1} e_F g_{F,t} \\leq B,\\quad \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right) = 0,\n$$\n$$\n\\phi_{F,t} \\geq 0,\\quad g_{F,t} \\geq 0,\\quad \\phi_{F,t} g_{F,t} = 0,\n$$\n$$\n\\phi_{R,t} \\geq 0,\\quad g_{R,t} \\geq 0,\\quad \\phi_{R,t} g_{R,t} = 0.\n$$\n乘子 $\\mu$ 衡量了碳预算 $B$ 每放松一个单位时，最优目标现值的边际变化。由于预算约束以未经贴现的形式 $\\sum_t e_F g_{F,t} \\leq B$ 出现，相关的拉格朗日乘子 $\\mu$ 的单位是现值美元/吨二氧化碳（$\\$/\\text{tCO}_2$），但它与贴现后的边际成本 $\\delta^t c_F$ 一起以加法形式进入平稳性条件。为了解释以第 $t$ 期货币单位表示的隐含碳影子价格，请注意，第 $t$ 期的边际权衡将 $g_{F,t}$ 的一个单位变化（使排放增加 $e_F$）等同于贴现成本 $\\delta^t c_F$ 的变化。通过贴现因子进行归一化，与最优性条件一致的特定时期碳价格是\n$$\n\\pi_t = -\\frac{\\mu}{\\delta^t},\n$$\n其中负号将标准的不等式乘子约定（$\\mu \\leq 0$）转换为了一个正的影子价格，单位是美元/吨二氧化碳。如果碳预算约束是松弛的，那么 $\\mu = 0$，且对于所有 $t$，$\\pi_t = 0$。\n\n算法步骤：\n1. 对线性规划进行编码，变量排序为 $\\left( g_{F,0}, \\dots, g_{F,T-1}, g_{R,0}, \\dots, g_{R,T-1} \\right)$。目标系数向量在化石燃料变量的相应位置放置 $\\delta^t c_F$，在可再生能源变量的相应位置放置 $\\delta^t c_R$。\n2. 实现每个 $t$ 的等式约束 $g_{F,t} + g_{R,t} = D_t$。实现每个 $t$ 的不等式约束 $g_{R,t} \\leq C^R_t$，以及单一的累积碳预算约束 $\\sum_t e_F g_{F,t} \\leq B$。\n3. 使用一个能返回等式和不等式约束对偶信息的稳健方法来求解线性规划。对于每个测试用例，通过选择与可再生能源容量限制和需求一致的 $B$ 来确保可行性。\n4. 提取碳预算不等式的拉格朗日乘子（对偶变量）。在最小化问题的标准“小于等于”表述下，求解器对于有约束力的约束返回一个非正乘子，对于松弛约束返回零。将此乘子表示为 $\\mu$。\n5. 计算隐含的特定时期碳影子价格路径 $\\pi_t = -\\mu / \\delta^t$，单位为美元/吨二氧化碳，并将每个 $\\pi_t$ 四舍五入到 3 位小数。\n6. 将测试套件的结果汇总为指定的单行输出格式。\n\n在设计的测试中的解释：\n- 在测试用例 1 中，预算等于最低可行排放量，这强制了可再生能源的最大化使用。当 $\\delta \\in (0,1)$ 时，现值权重使得未来成本的权重降低，因此隐含的碳价格路径 $\\pi_t$ 会根据 $1/\\delta^t$ 的归一化而随时间上升。\n- 在测试用例 2 中，当 $\\delta = 1$ 时，如果预算具有约束力，隐含的碳价格在各个时间段内是恒定的，因为在没有贴现的情况下，现值成本和当期成本是一致的。\n- 在测试用例 3 中，预算是宽松的，约束是松弛的，这意味着 $\\mu = 0$，因此对于所有 $t$，$\\pi_t = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F):\n    \"\"\"\n    Solve the LP for given parameters and return the implied period-specific carbon price path.\n    Prices are in $/tCO2 for periods t=0..T-1.\n    \"\"\"\n    T = len(D)\n    # Variable ordering: [gF_0, ..., gF_{T-1}, gR_0, ..., gR_{T-1}]\n    n_vars = 2 * T\n\n    # Objective coefficients: discounted costs\n    c = np.zeros(n_vars, dtype=float)\n    for t in range(T):\n        c[t] = (delta ** t) * c_F\n        c[T + t] = (delta ** t) * c_R\n\n    # Equality constraints: gF_t + gR_t = D_t\n    A_eq = np.zeros((T, n_vars), dtype=float)\n    b_eq = np.array(D, dtype=float)\n    for t in range(T):\n        A_eq[t, t] = 1.0          # gF_t\n        A_eq[t, T + t] = 1.0      # gR_t\n\n    # Inequality constraints:\n    # 1) Renewable capacity: gR_t = cap_R[t]\n    # 2) Carbon budget: sum_t e_F * gF_t = B\n    A_ub = np.zeros((T + 1, n_vars), dtype=float)\n    b_ub = np.zeros(T + 1, dtype=float)\n\n    # Renewable capacity constraints\n    for t in range(T):\n        A_ub[t, T + t] = 1.0\n        b_ub[t] = cap_R[t]\n\n    # Carbon budget constraint (last inequality)\n    for t in range(T):\n        A_ub[T, t] = e_F\n    b_ub[T] = B\n\n    # Bounds: gF_t >= 0, gR_t >= 0 (no explicit upper bounds on fossil)\n    bounds = [(0, None)] * n_vars\n\n    # Solve LP using HiGHS\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq,\n                  bounds=bounds, method='highs')\n\n    if not res.success:\n        # In case of numerical issues or infeasibility, return NaNs\n        return [float('nan')] * T\n\n    # Extract the dual (Lagrange multiplier) for the carbon budget inequality.\n    # SciPy (HiGHS) returns inequality multipliers in res.ineqlin.marginals for A_ub @ x = b_ub,\n    # with the convention that binding constraints in a minimization have nonpositive multipliers.\n    try:\n        duals_ub = res.ineqlin.marginals\n        mu = duals_ub[-1]  # Carbon budget is the last inequality\n    except Exception:\n        # Fallback: if the structure isn't present (shouldn't happen), set mu=0\n        mu = 0.0\n\n    # Implied carbon price path in period-t currency: pi_t = -mu / delta^t\n    # Ensure that tiny numerical noise does not produce negative zeros, clamp near-zero to zero.\n    prices = []\n    for t in range(T):\n        denom = (delta ** t)\n        # Avoid division by zero if delta=0 (not allowed by problem specification), but safeguard.\n        if denom == 0.0:\n            pi_t = float('inf')\n        else:\n            pi_t = -mu / denom\n        # Clean small numerical artifacts\n        if abs(pi_t)  1e-9:\n            pi_t = 0.0\n        # Round to 3 decimals\n        pi_t = float(f\"{pi_t:.3f}\")\n        prices.append(pi_t)\n\n    return prices\n\ndef solve():\n    # Fixed parameters across all tests\n    T = 4\n    D = [100.0, 110.0, 120.0, 130.0]          # MWh\n    cap_R = [50.0, 60.0, 70.0, 80.0]          # MWh\n    c_F = 30.0                                # $/MWh\n    c_R = 60.0                                # $/MWh\n    e_F = 0.9                                 # tCO2/MWh\n\n    # Helper quantities for budgets\n    sum_D = sum(D)\n    sum_cap_R = sum(cap_R)\n    min_emissions_budget = e_F * sum((D[t] - cap_R[t]) for t in range(T))  # minimum feasible B\n\n    # Test suite:\n    # 1) Binding at minimum feasible emissions with discounting\n    delta1 = 0.95\n    B1 = min_emissions_budget\n\n    # 2) Intermediate budget without discounting (between min and max emissions)\n    delta2 = 1.0\n    B2 = e_F * (sum((D[t] - cap_R[t]) for t in range(T)) + 0.5 * sum_cap_R)\n\n    # 3) Loose carbon budget (constraint slack)\n    delta3 = 0.90\n    B3 = e_F * sum_D + 100.0\n\n    test_cases = [\n        (delta1, B1),\n        (delta2, B2),\n        (delta3, B3),\n    ]\n\n    results = []\n    for (delta, B) in test_cases:\n        prices = compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F)\n        results.append(prices)\n\n    # Format as specified: a single line, list of lists with 4 floats each\n    # Convert inner lists to string with bracketed comma-separated floats\n    inner_strs = []\n    for lst in results:\n        inner_strs.append(f\"[{','.join(map(lambda x: f'{x:.3f}', lst))}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}