{
    "hands_on_practices": [
        {
            "introduction": "This first exercise lays the groundwork by connecting fundamental engineering parameters to regulatory metrics. By deriving the relationship between a fuel's carbon content ($CC$), a power plant's heat rate ($HR$), and its resulting emissions intensity ($EI$), you will solidify your understanding of the physical basis for emissions calculations . This simple but powerful formula is a cornerstone of energy systems analysis.",
            "id": "4088143",
            "problem": "A jurisdiction evaluates compliance with an emissions intensity standard for electricity by comparing direct stack emissions per unit of net electricity generated against a limit stated in $\\mathrm{kgCO_2e/MWh}$, where Carbon Dioxide Equivalent (CO2e) aggregates all greenhouse gases using their equivalence to carbon dioxide. Consider a steady-state thermal power plant that uses a single homogeneous fuel. Let $CC$ denote the fuel carbon content on a direct stack basis in $\\mathrm{kgCO_2e/MMBtu}$, where Million British thermal units (MMBtu) is the thermal energy unit, and let $HR$ denote the plant’s net heat rate in $\\mathrm{MMBtu/MWh}$, where Megawatt-hour (MWh) is the net electricity sent out. Assume complete oxidation of carbon in the fuel to carbon dioxide at the stack, no on-site carbon capture, and consistent higher or lower heating value bases between $CC$ and $HR$.\n\nStarting only from the fundamental definitions of heat rate as thermal input per unit electric output and of carbon content as direct stack emissions per unit thermal input, and using conservation of mass and energy, derive a symbolic expression for the plant’s direct stack emissions intensity of electricity, $EI$, in $\\mathrm{kgCO_2e/MWh}$, as a function of $CC$ and $HR$.\n\nExpress your final result as a single closed-form analytic expression for $EI$ in terms of $CC$ and $HR$, with the understanding that the numerical value would be reported in $\\mathrm{kgCO_2e/MWh}$. Do not perform any numerical substitution and do not include units in the final boxed expression.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System:** A steady-state thermal power plant using a single homogeneous fuel.\n- **Variable $EI$:** The plant's direct stack emissions intensity of electricity, with units of $\\mathrm{kgCO_2e/MWh}$.\n- **Variable $CC$:** The fuel carbon content on a direct stack basis, with units of $\\mathrm{kgCO_2e/MMBtu}$. `MMBtu` represents Million British thermal units.\n- **Variable $HR$:** The plant’s net heat rate, with units of $\\mathrm{MMBtu/MWh}$. `MWh` represents Megawatt-hour of net electricity sent out.\n- **Fundamental Definition 1:** Heat rate ($HR$) is defined as thermal input per unit electric output.\n- **Fundamental Definition 2:** Carbon content ($CC$) is defined as direct stack emissions per unit thermal input.\n- **Assumption 1:** Complete oxidation of carbon in the fuel to carbon dioxide at the stack.\n- **Assumption 2:** No on-site carbon capture.\n- **Assumption 3:** Consistent higher or lower heating value bases are used for both $CC$ and $HR$.\n- **Objective:** Derive a symbolic expression for $EI$ as a function of $CC$ and $HR$, starting from fundamental definitions and using principles of mass and energy conservation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of thermodynamics and energy systems engineering. The variables $EI$, $CC$, and $HR$ are standard, well-defined metrics in power plant analysis. The principles of conservation of mass and energy are correctly invoked.\n- **Well-Posed:** The problem is well-posed. It provides sufficient information and clear definitions to establish a unique mathematical relationship between the specified variables. The objective is to derive one quantity from two others, which is a standard formulation.\n- **Objective:** The language is technical, precise, and free of any subjective or ambiguous terms.\n\nThe problem does not exhibit any of the flaws listed:\n1.  **Scientific or Factual Unsoundness:** The physical and chemical premises are sound for a standard thermodynamic model.\n2.  **Non-Formalizable or Irrelevant:** The problem is directly formalizable into a mathematical derivation and is central to the topic of emissions accounting in energy systems.\n3.  **Incomplete or Contradictory Setup:** The problem is self-contained. The assumptions (e.g., no carbon capture) are explicit and serve to create a solvable system with the given information.\n4.  **Unrealistic or Infeasible:** While simplified, the assumptions (e.g., complete oxidation) are standard for first-order engineering models and do not represent physical impossibilities. The units are consistent.\n5.  **Ill-Posed or Poorly Structured:** The problem is clearly structured and leads to a unique, meaningful solution.\n6.  **Pseudo-Profound, Trivial, or Tautological:** The derivation, while straightforward for a professional in the field, requires a correct application of definitions and dimensional reasoning, representing a valid test of fundamental understanding.\n7.  **Outside Scientific Verifiability:** The resulting expression is verifiable through dimensional analysis and application to empirical data.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nThe derivation proceeds from the fundamental definitions provided. Let $M_{emissions}$ represent the mass of direct stack emissions (in $\\mathrm{kgCO_2e}$), $E_{thermal}$ represent the thermal energy input from the fuel (in $\\mathrm{MMBtu}$), and $E_{elec}$ represent the net electrical energy output (in $\\mathrm{MWh}$).\n\nAccording to the problem statement, the emissions intensity, $EI$, is defined as the direct stack emissions per unit of net electricity generated.\n$$\nEI = \\frac{M_{emissions}}{E_{elec}}\n$$\nThe units for $EI$ are $\\mathrm{kgCO_2e/MWh}$.\n\nThe fuel carbon content, $CC$, is defined as the direct stack emissions per unit of thermal energy input.\n$$\nCC = \\frac{M_{emissions}}{E_{thermal}}\n$$\nThe units for $CC$ are $\\mathrm{kgCO_2e/MMBtu}$.\n\nThe plant's net heat rate, $HR$, is defined as the thermal energy input required per unit of net electrical energy output.\n$$\nHR = \\frac{E_{thermal}}{E_{elec}}\n$$\nThe units for $HR$ are $\\mathrm{MMBtu/MWh}$.\n\nThe problem requires an expression for $EI$ as a function of $CC$ and $HR$. We can achieve this through algebraic substitution based on the provided definitions. The conservation of mass (for carbon) is implicit in the definition of $CC$, as it links the mass of emissions to the fuel consumed (via its energy content). The conservation of energy is encapsulated in the definition of $HR$, which represents the efficiency of converting thermal energy to electrical energy.\n\nWe start with the definition of $EI$.\n$$\nEI = \\frac{M_{emissions}}{E_{elec}}\n$$\nFrom the definition of $CC$, we can express the emissions mass, $M_{emissions}$, as:\n$$\nM_{emissions} = CC \\cdot E_{thermal}\n$$\nSubstituting this expression for $M_{emissions}$ into the equation for $EI$ gives:\n$$\nEI = \\frac{CC \\cdot E_{thermal}}{E_{elec}}\n$$\nThis can be rewritten as:\n$$\nEI = CC \\cdot \\left( \\frac{E_{thermal}}{E_{elec}} \\right)\n$$\nWe recognize the term in the parentheses, $\\frac{E_{thermal}}{E_{elec}}$, as the definition of the net heat rate, $HR$.\n$$\n\\frac{E_{thermal}}{E_{elec}} = HR\n$$\nSubstituting $HR$ into the expression for $EI$ yields the final relationship:\n$$\nEI = CC \\cdot HR\n$$\nTo confirm the validity of this derivation, a dimensional analysis is performed.\n$$\n\\text{units of } EI = (\\text{units of } CC) \\times (\\text{units of } HR)\n$$\n$$\n\\frac{\\mathrm{kgCO_2e}}{\\mathrm{MWh}} = \\left( \\frac{\\mathrm{kgCO_2e}}{\\mathrm{MMBtu}} \\right) \\cdot \\left( \\frac{\\mathrm{MMBtu}}{\\mathrm{MWh}} \\right)\n$$\nThe `MMBtu` units cancel, leaving:\n$$\n\\frac{\\mathrm{kgCO_2e}}{\\mathrm{MWh}} = \\frac{\\mathrm{kgCO_2e}}{\\mathrm{MWh}}\n$$\nThe dimensional consistency confirms that the derived expression $EI = CC \\cdot HR$ is correct.",
            "answer": "$$\n\\boxed{CC \\cdot HR}\n$$"
        },
        {
            "introduction": "Real-world power plant operations are dynamic, involving start-ups, shutdowns, and periods of running without generating power (no-load operation). This practice moves beyond static efficiency to explore how these dynamic events contribute to total emissions, a detail often omitted in simplified models. Through a practical coding exercise, you will quantify the bias introduced by ignoring these factors and see how different accounting methods can dramatically alter compliance outcomes .",
            "id": "4088133",
            "problem": "Consider an electricity generation system composed of a finite set of generators indexed by $g \\in \\{1,\\dots,G\\}$ and a discrete time horizon indexed by $t \\in \\{1,\\dots,T\\}$, with uniform period duration $\\Delta t$ measured in hours. For each generator $g$ and period $t$, let $p_{g,t}$ denote the electrical power output in megawatt (MW), and let $u_{g,t} \\in \\{0,1\\}$ denote the on/off status indicator, where $u_{g,t} = 1$ indicates the generator is on and $u_{g,t} = 0$ indicates it is off. The start-up indicator $v_{g,t}$ is defined as $v_{g,t} = \\max\\{0, u_{g,t} - u_{g,t-1}\\}$ with the convention $u_{g,0} = 0$. For each generator $g$, the load-dependent emissions rate $r_g$ is specified in kilograms per megawatt-hour (kg/MWh), the no-load emissions rate $n_g$ is specified in kilograms per hour (kg/h) when the generator is on, and the start-up emissions $s_g$ is specified in kilograms (kg) per start event.\n\nThe total electrical energy generated by generator $g$ in period $t$ is $e_{g,t} = p_{g,t} \\Delta t$ measured in megawatt-hour (MWh). The load-dependent emissions contributed by generator $g$ in period $t$ are proportional to $e_{g,t}$ with proportionality constant $r_g$. The no-load emissions contributed by generator $g$ in period $t$ equal $n_g u_{g,t} \\Delta t$. The start-up emissions contributed by generator $g$ in period $t$ equal $s_g v_{g,t}$. Let $E^{\\text{gen}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} e_{g,t}$ denote the total electrical energy generated (in MWh) over the horizon. Define the full-accounting total emissions\n$$\nE^{\\text{full}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} \\left( r_g e_{g,t} + n_g u_{g,t} \\Delta t + s_g v_{g,t} \\right)\n$$\nand the partial-accounting total emissions (omitting start-up and no-load contributions)\n$$\nE^{\\text{partial}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} r_g e_{g,t}.\n$$\nDefine the average emissions intensity under full accounting as $I^{\\text{full}} = E^{\\text{full}} / E^{\\text{gen}}$ and under partial accounting as $I^{\\text{partial}} = E^{\\text{partial}} / E^{\\text{gen}}$, both expressed in kilograms per megawatt-hour (kg/MWh). If $E^{\\text{gen}} = 0$, treat $I^{\\text{full}} = +\\infty$ and $I^{\\text{partial}} = +\\infty$ for compliance evaluation.\n\nGiven an absolute emissions cap $C$ measured in kilograms (kg) and an intensity limit $L$ measured in kilograms per megawatt-hour (kg/MWh), the compliance conditions are as follows: full-accounting cap compliance requires $E^{\\text{full}} \\le C$, partial-accounting cap compliance requires $E^{\\text{partial}} \\le C$, full-accounting intensity compliance requires $I^{\\text{full}} \\le L$, and partial-accounting intensity compliance requires $I^{\\text{partial}} \\le L$. Let the bias in total emissions when omitting start-up and no-load components be $B_E = E^{\\text{partial}} - E^{\\text{full}}$ expressed in kilograms (kg), and the bias in intensity be $B_I = I^{\\text{partial}} - I^{\\text{full}}$ expressed in kilograms per megawatt-hour (kg/MWh).\n\nYour task is to implement a program that, for each given test case, computes:\n- $B_E$ in kilograms (kg),\n- $B_I$ in kilograms per megawatt-hour (kg/MWh),\n- the full-accounting cap compliance boolean (true if $E^{\\text{full}} \\le C$, false otherwise),\n- the partial-accounting cap compliance boolean (true if $E^{\\text{partial}} \\le C$, false otherwise),\n- the full-accounting intensity compliance boolean (true if $I^{\\text{full}} \\le L$, false otherwise),\n- the partial-accounting intensity compliance boolean (true if $I^{\\text{partial}} \\le L$, false otherwise).\n\nExpress all intensities in kilograms per megawatt-hour (kg/MWh). There are no angles involved. No percentage signs are permitted anywhere in the output; use decimal numbers.\n\nUse the following test suite of parameter values. In all cases, the period duration is $\\Delta t = 1$ hour.\n\nTest Case $1$ (happy path with differing compliance under full versus partial accounting):\n- Number of generators $G = 2$, number of periods $T = 4$.\n- Generator $1$: $r_1 = 800$ kg/MWh, $n_1 = 60$ kg/h, $s_1 = 500$ kg.\n- Generator $2$: $r_2 = 400$ kg/MWh, $n_2 = 30$ kg/h, $s_2 = 300$ kg.\n- Status arrays $u_{1,t}$ over $t = 1 \\dots 4$: $\\{1, 1, 0, 1\\}$; $u_{2,t}$: $\\{0, 1, 1, 1\\}$.\n- Output arrays $p_{1,t}$ in MW over $t = 1 \\dots 4$: $\\{50, 60, 0, 30\\}$; $p_{2,t}$: $\\{0, 40, 70, 50\\}$.\n- Emissions cap $C = 176500$ kg.\n- Intensity limit $L = 590$ kg/MWh.\n\nTest Case $2$ (boundary conditions where full-accounting values equal the limits):\n- Number of generators $G = 1$, number of periods $T = 3$.\n- Generator $1$: $r_1 = 500$ kg/MWh, $n_1 = 50$ kg/h, $s_1 = 200$ kg.\n- Status array $u_{1,t}$ over $t = 1 \\dots 3$: $\\{1, 1, 0\\}$.\n- Output array $p_{1,t}$ in MW over $t = 1 \\dots 3$: $\\{20, 20, 0\\}$.\n- Emissions cap $C = 20300$ kg.\n- Intensity limit $L = 507.5$ kg/MWh.\n\nTest Case $3$ (edge case with frequent cycling and substantial start-up emissions):\n- Number of generators $G = 1$, number of periods $T = 6$.\n- Generator $1$: $r_1 = 300$ kg/MWh, $n_1 = 100$ kg/h, $s_1 = 1000$ kg.\n- Status array $u_{1,t}$ over $t = 1 \\dots 6$: $\\{1, 0, 1, 0, 1, 0\\}$.\n- Output array $p_{1,t}$ in MW over $t = 1 \\dots 6$: $\\{30, 0, 35, 0, 40, 0\\}$.\n- Emissions cap $C = 33000$ kg.\n- Intensity limit $L = 320$ kg/MWh.\n\nTest Case $4$ (always-on operation with low load; both full and partial comply to demonstrate no change in compliance):\n- Number of generators $G = 1$, number of periods $T = 5$.\n- Generator $1$: $r_1 = 100$ kg/MWh, $n_1 = 80$ kg/h, $s_1 = 50$ kg.\n- Status array $u_{1,t}$ over $t = 1 \\dots 5$: $\\{1, 1, 1, 1, 1\\}$.\n- Output array $p_{1,t}$ in MW over $t = 1 \\dots 5$: $\\{10, 10, 10, 10, 10\\}$.\n- Emissions cap $C = 6000$ kg.\n- Intensity limit $L = 120$ kg/MWh.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is a list ordered as $[B_E, B_I, \\text{cap\\_compliance\\_full}, \\text{cap\\_compliance\\_partial}, \\text{intensity\\_compliance\\_full}, \\text{intensity\\_compliance\\_partial}]$. For example, the overall output format must be $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with four inner lists corresponding to the four test cases, and with all intensities expressed in kilograms per megawatt-hour (kg/MWh) and all emissions expressed in kilograms (kg).",
            "solution": "The problem requires the calculation of emissions-related metrics for an electricity generation system under two different accounting schemes: full and partial. The system consists of a set of $G$ generators operating over $T$ discrete time periods. The solution necessitates a methodical application of the provided mathematical definitions for emissions, energy, and compliance.\n\nFirst, we restate the fundamental quantities and definitions provided in the problem statement. The period duration is $\\Delta t$. For each generator $g \\in \\{1, \\dots, G\\}$ and time period $t \\in \\{1, \\dots, T\\}$:\n- $p_{g,t}$ is the power output in megawatts (MW).\n- $u_{g,t} \\in \\{0, 1\\}$ is the binary on/off status.\n- $v_{g,t} = \\max\\{0, u_{g,t} - u_{g,t-1}\\}$ is the start-up event indicator, with the initial condition $u_{g,0} = 0$.\n\nThe parameters for each generator $g$ are:\n- $r_g$: load-dependent emissions rate (kg/MWh).\n- $n_g$: no-load emissions rate (kg/h).\n- $s_g$: start-up emissions (kg/start).\n\nFrom these, we derive the following quantities. The electrical energy generated by generator $g$ in period $t$ is:\n$$e_{g,t} = p_{g,t} \\Delta t$$\nThe total electrical energy generated over the entire time horizon is the sum over all generators and time periods:\n$$E^{\\text{gen}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} e_{g,t}$$\n\nThe problem defines two methods for calculating total emissions. The partial-accounting method only considers load-dependent emissions:\n$$E^{\\text{partial}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} r_g e_{g,t}$$\nThe full-accounting method includes load-dependent, no-load, and start-up emissions:\n$$E^{\\text{full}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} \\left( r_g e_{g,t} + n_g u_{g,t} \\Delta t + s_g v_{g,t} \\right)$$\nThis can be decomposed as $E^{\\text{full}} = E^{\\text{partial}} + E^{\\text{no-load}} + E^{\\text{start-up}}$, where:\n$$E^{\\text{no-load}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} n_g u_{g,t} \\Delta t$$\n$$E^{\\text{start-up}} = \\sum_{g=1}^{G} \\sum_{t=1}^{T} s_g v_{g,t}$$\nThe corresponding average emissions intensities are defined as:\n$$I^{\\text{partial}} = \\frac{E^{\\text{partial}}}{E^{\\text{gen}}}$$\n$$I^{\\text{full}} = \\frac{E^{\\text{full}}}{E^{\\text{gen}}}$$\nIf $E^{\\text{gen}} = 0$, the intensities are considered to be infinite.\n\nThe required outputs are the biases in emissions and intensity, and four compliance booleans.\nThe bias in total emissions is:\n$$B_E = E^{\\text{partial}} - E^{\\text{full}} = - (E^{\\text{no-load}} + E^{\\text{start-up}})$$\nThe bias in intensity is:\n$$B_I = I^{\\text{partial}} - I^{\\text{full}} = \\frac{E^{\\text{partial}}}{E^{\\text{gen}}} - \\frac{E^{\\text{full}}}{E^{\\text{gen}}} = \\frac{B_E}{E^{\\text{gen}}}$$\nThe compliance conditions are checked against an emissions cap $C$ and an intensity limit $L$:\n1.  Full-accounting cap compliance: $E^{\\text{full}} \\le C$\n2.  Partial-accounting cap compliance: $E^{\\text{partial}} \\le C$\n3.  Full-accounting intensity compliance: $I^{\\text{full}} \\le L$\n4.  Partial-accounting intensity compliance: $I^{\\text{partial}} \\le L$\n\nThe algorithmic procedure for each test case is as follows:\n1.  Given the input arrays for $u_{g,t}$ and $p_{g,t}$, and parameters $r_g, n_g, s_g$ for each generator $g$, and the global parameters $\\Delta t, C, L$.\n2.  For each generator $g$, calculate the start-up indicator vector $v_{g,t}$ for $t=1,\\dots,T$ using the definition $v_{g,t} = \\max\\{0, u_{g,t} - u_{g,t-1}\\}$ and $u_{g,0}=0$.\n3.  Calculate the energy matrix $e_{g,t} = p_{g,t} \\Delta t$.\n4.  Compute the total generated energy $E^{\\text{gen}}$ by summing all elements of the $e_{g,t}$ matrix.\n5.  If $E^{\\text{gen}} = 0$, handle the infinite intensity case. Otherwise, proceed.\n6.  Compute the total partial emissions $E^{\\text{partial}}$ by performing a weighted sum of the energy matrix $e_{g,t}$ with weights $r_g$.\n7.  Compute the total no-load emissions $E^{\\text{no-load}}$ by performing a weighted sum of the status matrix $u_{g,t}$ with weights $n_g$ and multiplying by $\\Delta t$.\n8.  Compute the total start-up emissions $E^{\\text{start-up}}$ by performing a weighted sum of the start-up matrix $v_{g,t}$ with weights $s_g$.\n9.  Calculate the total full emissions $E^{\\text{full}} = E^{\\text{partial}} + E^{\\text{no-load}} + E^{\\text{start-up}}$.\n10. Calculate the emissions bias $B_E = E^{\\text{partial}} - E^{\\text{full}}$.\n11. Calculate the partial intensity $I^{\\text{partial}} = E^{\\text{partial}} / E^{\\text{gen}}$ and full intensity $I^{\\text{full}} = E^{\\text{full}} / E^{\\text{gen}}$.\n12. Calculate the intensity bias $B_I = I^{\\text{partial}} - I^{\\text{full}}$.\n13. Evaluate the four boolean compliance conditions by comparing the calculated emissions and intensities with the provided cap $C$ and limit $L$.\n14. Assemble the six results ($B_E$, $B_I$, and the four booleans) into a list for the current test case.\n\nThis procedure is implemented for each test case provided, utilizing numerical libraries for efficient array operations. The final output is a list containing the result lists for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the emissions calculation and compliance checking problem for a given set of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            # Test Case 1\n            \"G\": 2, \"T\": 4, \"delta_t\": 1.0,\n            \"r\": np.array([800.0, 400.0]),\n            \"n\": np.array([60.0, 30.0]),\n            \"s\": np.array([500.0, 300.0]),\n            \"u\": np.array([[1, 1, 0, 1],\n                           [0, 1, 1, 1]]),\n            \"p\": np.array([[50.0, 60.0, 0.0, 30.0],\n                           [0.0, 40.0, 70.0, 50.0]]),\n            \"C\": 176500.0, \"L\": 590.0\n        },\n        {\n            # Test Case 2\n            \"G\": 1, \"T\": 3, \"delta_t\": 1.0,\n            \"r\": np.array([500.0]),\n            \"n\": np.array([50.0]),\n            \"s\": np.array([200.0]),\n            \"u\": np.array([[1, 1, 0]]),\n            \"p\": np.array([[20.0, 20.0, 0.0]]),\n            \"C\": 20300.0, \"L\": 507.5\n        },\n        {\n            # Test Case 3\n            \"G\": 1, \"T\": 6, \"delta_t\": 1.0,\n            \"r\": np.array([300.0]),\n            \"n\": np.array([100.0]),\n            \"s\": np.array([1000.0]),\n            \"u\": np.array([[1, 0, 1, 0, 1, 0]]),\n            \"p\": np.array([[30.0, 0.0, 35.0, 0.0, 40.0, 0.0]]),\n            \"C\": 33000.0, \"L\": 320.0\n        },\n        {\n            # Test Case 4\n            \"G\": 1, \"T\": 5, \"delta_t\": 1.0,\n            \"r\": np.array([100.0]),\n            \"n\": np.array([80.0]),\n            \"s\": np.array([50.0]),\n            \"u\": np.array([[1, 1, 1, 1, 1]]),\n            \"p\": np.array([[10.0, 10.0, 10.0, 10.0, 10.0]]),\n            \"C\": 6000.0, \"L\": 120.0\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Extract data from the case dictionary\n        G, T, delta_t = case[\"G\"], case[\"T\"], case[\"delta_t\"]\n        r, n, s = case[\"r\"], case[\"n\"], case[\"s\"]\n        u, p = case[\"u\"], case[\"p\"]\n        C, L = case[\"C\"], case[\"L\"]\n\n        # Ensure parameters are column vectors for broadcasting\n        r_col = r.reshape(-1, 1)\n        n_col = n.reshape(-1, 1)\n        s_col = s.reshape(-1, 1)\n\n        # 1. Calculate startup indicator v\n        # Prepend a column of zeros for u_g,0\n        u_padded = np.hstack((np.zeros((G, 1)), u))\n        v = np.maximum(0, np.diff(u_padded, axis=1))\n\n        # 2. Calculate energy e_g,t\n        e = p * delta_t\n\n        # 3. Calculate total generated energy E_gen\n        E_gen = np.sum(e)\n\n        # 4. Calculate partial emissions E_partial\n        E_partial = np.sum(r_col * e)\n\n        # 5. Calculate full emissions E_full\n        E_no_load = np.sum(n_col * u * delta_t)\n        E_startup = np.sum(s_col * v)\n        E_full = E_partial + E_no_load + E_startup\n\n        # 6. Calculate biases\n        B_E = E_partial - E_full\n        \n        # 7. Calculate intensities and intensity bias\n        if E_gen == 0:\n            I_full = float('inf')\n            I_partial = float('inf')\n            B_I = float('nan') # Or handle as per specific rules, here B_I would be `inf - inf`\n        else:\n            I_full = E_full / E_gen\n            I_partial = E_partial / E_gen\n            B_I = I_partial - I_full\n\n        # 8. Perform compliance checks\n        cap_compliance_full = E_full <= C\n        cap_compliance_partial = E_partial <= C\n        intensity_compliance_full = I_full <= L\n        intensity_compliance_partial = I_partial <= L\n\n        # 9. Store results for this case\n        case_results = [\n            B_E,\n            B_I,\n            cap_compliance_full,\n            cap_compliance_partial,\n            intensity_compliance_full,\n            intensity_compliance_partial\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string to match the required format without spaces\n    def format_inner_list(lst):\n        # Converts a list like [-1570.0, -5.23, False] to \"[-1570.0,-5.23,False]\"\n        return \"[\" + \",\".join(map(str, lst)) + \"]\"\n\n    output_str = \"[\" + \",\".join([format_inner_list(res) for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Emissions regulations create new economic realities for firms, forcing them to balance abatement costs with permit prices. This advanced practice challenges you to model a competitive cap-and-trade market where multiple firms make optimal abatement decisions under both an economy-wide emissions cap and firm-specific intensity limits. You will use Karush-Kuhn-Tucker (KKT) conditions to construct a mixed complementarity problem (MCP) that defines the market equilibrium, providing deep insight into how multiple, interacting policies shape firm behavior and market outcomes .",
            "id": "4088149",
            "problem": "Consider a cap-and-trade program for carbon dioxide emissions with three price-taking firms indexed by $i \\in \\{1,2,3\\}$. Each firm has exogenous output $y_i$ and baseline emissions intensity $\\alpha_i$, so baseline emissions without abatement are $E_i^{0} = \\alpha_i y_i$. Each firm chooses abatement $a_i$ to minimize total compliance cost, which consists of a convex abatement cost $c_i(a_i)$ and the expenditure on permits priced at $\\pi$ for residual emissions $E_i^{0} - a_i$. An emissions intensity limit imposes $E_i^{0} - a_i \\le \\bar{\\alpha}_i y_i$, where $\\bar{\\alpha}_i$ is the emissions intensity limit. The firm-level decision variables are subject to feasibility $0 \\le E_i^{0} - a_i$ and the intensity limit. The economy-wide cap on total emissions is $C$, which leads to the market-clearing condition on permits that the sum of residual emissions cannot exceed $C$.\n\nStarting from the firm’s cost-minimization problem and its Karush-Kuhn-Tucker (KKT) optimality conditions, and from the market-clearing condition for permits with a nonnegative price, construct a Mixed Complementarity Problem (MCP) with explicit complementarity relationships that jointly characterize a competitive equilibrium under the cap-and-trade program with intensity limits. Then, for the following scientifically plausible parameterization, compute the equilibrium permit price $\\pi$:\n\n- Outputs: $y_1 = 10$, $y_2 = 8$, $y_3 = 6$.\n- Baseline emissions intensities: $\\alpha_1 = 1$, $\\alpha_2 = 1$, $\\alpha_3 = 1$.\n- Intensity limits: $\\bar{\\alpha}_1 = 0.6$, $\\bar{\\alpha}_2 = 0.9$, $\\bar{\\alpha}_3 = 1.0$.\n- Baseline emissions: $E_i^{0} = \\alpha_i y_i$ (implied by the above).\n- Abatement cost functions: $c_i(a_i) = \\frac{1}{2} k_i a_i^{2}$ with $k_1 = 2$, $k_2 = 1$, $k_3 = 0.5$.\n- Aggregate cap: $C = 12$.\n\nExpress your final answer for the equilibrium permit price in dollars per tonne of carbon dioxide. Round your answer to four significant figures.",
            "solution": "The problem is examined and found to be valid as it is scientifically grounded in economic theory, well-posed with convex cost functions and linear constraints, objective, and contains a complete and consistent set of data and conditions for finding a unique equilibrium.\n\nThe solution is developed in two parts. First, we derive the general Mixed Complementarity Problem (MCP) structure for the competitive equilibrium. Second, we apply the specific parameterization to compute the equilibrium permit price $\\pi$.\n\n### Part 1: Formulation of the Mixed Complementarity Problem (MCP)\n\nEach price-taking firm $i \\in \\{1,2,3\\}$ seeks to minimize its total compliance cost, which is the sum of its abatement costs and the cost of purchasing permits for its residual emissions. The firm's decision variable is the level of abatement, $a_i$.\n\nThe firm's optimization problem is:\n$$ \\min_{a_i} \\quad C_i(a_i) = c_i(a_i) + \\pi (E_i^0 - a_i) $$\nsubject to the constraints:\n1.  Non-negative emissions: $E_i^0 - a_i \\ge 0 \\implies a_i \\le E_i^0$.\n2.  Intensity limit: $E_i^0 - a_i \\le \\bar{\\alpha}_i y_i \\implies a_i \\ge E_i^0 - \\bar{\\alpha}_i y_i$.\n3.  Non-negative abatement: $a_i \\ge 0$.\n\nLet us define the effective lower bound on abatement for firm $i$ as $a_i^{\\min} = \\max(0, E_i^0 - \\bar{\\alpha}_i y_i)$ and the upper bound as $a_i^{\\max} = E_i^0$. The problem for firm $i$ simplifies to:\n$$ \\min_{a_i} \\quad c_i(a_i) - \\pi a_i $$\n(dropping the constant term $\\pi E_i^0$)\nsubject to:\n$$ a_i^{\\min} \\le a_i \\le a_i^{\\max} $$\n\nTo derive the Karush-Kuhn-Tucker (KKT) conditions, we formulate the Lagrangian for firm $i$'s problem, introducing Lagrange multipliers $\\mu_i \\ge 0$ for the lower-bound constraint ($a_i - a_i^{\\min} \\ge 0$) and $\\nu_i \\ge 0$ for the upper-bound constraint ($a_i^{\\max} - a_i \\ge 0$):\n$$ \\mathcal{L}_i(a_i, \\mu_i, \\nu_i) = c_i(a_i) - \\pi a_i - \\mu_i(a_i - a_i^{\\min}) - \\nu_i(a_i^{\\max} - a_i) $$\n\nThe KKT conditions for firm $i$ are:\n1.  **Stationarity:**\n    $$ \\frac{\\partial \\mathcal{L}_i}{\\partial a_i} = c'_i(a_i) - \\pi - \\mu_i + \\nu_i = 0 $$\n2.  **Primal Feasibility:**\n    $$ a_i - a_i^{\\min} \\ge 0 $$\n    $$ a_i^{\\max} - a_i \\ge 0 $$\n3.  **Dual Feasibility:**\n    $$ \\mu_i \\ge 0 $$\n    $$ \\nu_i \\ge 0 $$\n4.  **Complementary Slackness:**\n    $$ \\mu_i (a_i - a_i^{\\min}) = 0 $$\n    $$ \\nu_i (a_i^{\\max} - a_i) = 0 $$\n\nThese conditions define the optimal behavior of each firm for a given permit price $\\pi$.\n\nThe second component of the equilibrium is the market-clearing condition for the emissions permits. The total quantity of permits demanded by the firms (their total residual emissions) must be less than or equal to the total supply of permits, $C$. The price of permits, $\\pi$, must be non-negative. If the total emissions are strictly less than the cap, the price of permits must be zero. This is a complementarity condition.\n$$ C - \\sum_{i=1}^3 (E_i^0 - a_i) \\ge 0, \\quad \\pi \\ge 0, \\quad \\pi \\left( C - \\sum_{i=1}^3 (E_i^0 - a_i) \\right) = 0 $$\nwhere $(E_i^0 - a_i)$ is the residual emissions of firm $i$.\n\nThe complete market equilibrium is characterized by the set of all firms' KKT conditions and the market-clearing condition holding simultaneously. This system constitutes a Mixed Complementarity Problem (MCP). The variables are $(a_1, a_2, a_3, \\mu_1, \\mu_2, \\mu_3, \\nu_1, \\nu_2, \\nu_3, \\pi)$. The MCP is defined by the following relationships:\n- For each firm $i \\in \\{1,2,3\\}$:\n  1. $c'_i(a_i) - \\pi - \\mu_i + \\nu_i = 0$\n  2. $0 \\le \\mu_i \\quad \\perp \\quad a_i - a_i^{\\min} \\ge 0$\n  3. $0 \\le \\nu_i \\quad \\perp \\quad a_i^{\\max} - a_i \\ge 0$\n- For the market:\n  4. $0 \\le \\pi \\quad \\perp \\quad C - \\sum_{i=1}^3 (E_i^0 - a_i) \\ge 0$\n\nHere, the symbol $\\perp$ denotes complementarity (i.e., $A \\perp B$ means $A \\ge 0, B \\ge 0, AB = 0$).\n\n### Part 2: Calculation of the Equilibrium Permit Price\n\nWe now substitute the given parameters into the model.\n- **Outputs:** $y_1 = 10$, $y_2 = 8$, $y_3 = 6$.\n- **Baseline Intensities:** $\\alpha_1 = 1$, $\\alpha_2 = 1$, $\\alpha_3 = 1$.\n- **Baseline Emissions:** $E_1^0 = 10$, $E_2^0 = 8$, $E_3^0 = 6$. Total baseline emissions $\\sum E_i^0 = 24$.\n- **Intensity Limits:** $\\bar{\\alpha}_1 = 0.6$, $\\bar{\\alpha}_2 = 0.9$, $\\bar{\\alpha}_3 = 1.0$.\n- **Abatement Cost Parameters:** $k_1 = 2$, $k_2 = 1$, $k_3 = 0.5$.\n- **Abatement Cost Functions:** $c_1(a_1) = a_1^2$, $c_2(a_2) = \\frac{1}{2} a_2^2$, $c_3(a_3) = \\frac{1}{4} a_3^2$.\n- **Marginal Abatement Cost Functions:** $c'_1(a_1) = 2a_1$, $c'_2(a_2) = a_2$, $c'_3(a_3) = \\frac{1}{2}a_3$.\n- **Aggregate Cap:** $C = 12$.\n\nThe total required abatement is $\\sum a_i = (\\sum E_i^0) - C = 24 - 12 = 12$. Since total abatement must be positive, the cap is binding, and therefore the equilibrium permit price $\\pi$ will be positive. The market clearing condition simplifies to $\\sum a_i = 12$.\n\nNext, we determine the feasible abatement range $[a_i^{\\min}, a_i^{\\max}]$ for each firm.\n- **Firm 1:** $a_1^{\\min} = E_1^0 - \\bar{\\alpha}_1 y_1 = 10 - (0.6)(10) = 4$. $a_1^{\\max} = 10$. Range: $[4, 10]$.\n- **Firm 2:** $a_2^{\\min} = E_2^0 - \\bar{\\alpha}_2 y_2 = 8 - (0.9)(8) = 0.8$. $a_2^{\\max} = 8$. Range: $[0.8, 8]$.\n- **Firm 3:** $a_3^{\\min} = E_3^0 - \\bar{\\alpha}_3 y_3 = 6 - (1.0)(6) = 0$. $a_3^{\\max} = 6$. Range: $[0, 6]$.\n\nFrom the KKT conditions, if a firm's abatement $a_i$ is in the interior of its feasible range ($a_i^{\\min} < a_i < a_i^{\\max}$), its multipliers $\\mu_i$ and $\\nu_i$ are zero, and its marginal abatement cost equals the permit price: $c'_i(a_i) = \\pi$.\nThis allows us to express each firm's abatement level $a_i$ as a function of $\\pi$:\n$a_i(\\pi) = \\begin{cases} a_i^{\\min} & \\text{if } c'_i(a_i^{\\min}) > \\pi \\\\ (c'_i)^{-1}(\\pi) & \\text{if } c'_i(a_i^{\\min}) \\le \\pi \\le c'_i(a_i^{\\max}) \\\\ a_i^{\\max} & \\text{if } c'_i(a_i^{\\max}) < \\pi \\end{cases}$\n\nLet's find the marginal costs at the boundaries for each firm:\n- **Firm 1:** $c'_1(a_1^{\\min}) = c'_1(4) = 2(4) = 8$. $c'_1(a_1^{\\max}) = c'_1(10) = 2(10) = 20$.\n  $a_1(\\pi) = \\begin{cases} 4 & \\text{if } \\pi < 8 \\\\ \\pi/2 & \\text{if } 8 \\le \\pi \\le 20 \\\\ 10 & \\text{if } \\pi > 20 \\end{cases}$\n- **Firm 2:** $c'_2(a_2^{\\min}) = c'_2(0.8) = 0.8$. $c'_2(a_2^{\\max}) = c'_2(8) = 8$.\n  $a_2(\\pi) = \\begin{cases} 0.8 & \\text{if } \\pi < 0.8 \\\\ \\pi & \\text{if } 0.8 \\le \\pi \\le 8 \\\\ 8 & \\text{if } \\pi > 8 \\end{cases}$\n- **Firm 3:** $c'_3(a_3^{\\min}) = c'_3(0) = \\frac{1}{2}(0) = 0$. $c'_3(a_3^{\\max}) = c'_3(6) = \\frac{1}{2}(6) = 3$.\n  $a_3(\\pi) = \\begin{cases} 2\\pi & \\text{if } 0 \\le \\pi \\le 3 \\\\ 6 & \\text{if } \\pi > 3 \\end{cases}$\n\nThe equilibrium price $\\pi$ is found by solving $\\sum_{i=1}^3 a_i(\\pi) = 12$. Let $A(\\pi) = a_1(\\pi) + a_2(\\pi) + a_3(\\pi)$. We test intervals for $\\pi$ defined by the breakpoints $\\{0, 0.8, 3, 8, 20\\}$.\n\n1.  **Interval $0 \\le \\pi < 0.8$**:\n    $A(\\pi) = 4 + 0.8 + 2\\pi = 4.8 + 2\\pi$.\n    The range of $A(\\pi)$ is $[4.8, 6.4)$. Since $12$ is not in this range, the solution is not here.\n\n2.  **Interval $0.8 \\le \\pi < 3$**:\n    $A(\\pi) = 4 + \\pi + 2\\pi = 4 + 3\\pi$.\n    The range of $A(\\pi)$ is $[A(0.8), A(3)) = [4 + 3(0.8), 4 + 3(3)) = [6.4, 13)$.\n    The target abatement of $12$ lies within this range. We set $A(\\pi) = 12$:\n    $$ 4 + 3\\pi = 12 $$\n    $$ 3\\pi = 8 $$\n    $$ \\pi = \\frac{8}{3} $$\n    The value $\\pi = 8/3 \\approx 2.667$ is indeed in the interval $[0.8, 3)$, so this is the equilibrium price.\n\nLet's compute the abatement levels at this price to confirm:\n- $a_1(\\pi=8/3)$: Since $8/3 < 8$, $a_1 = 4$.\n- $a_2(\\pi=8/3)$: Since $0.8 \\le 8/3 \\le 8$, $a_2 = \\pi = 8/3$.\n- $a_3(\\pi=8/3)$: Since $0 \\le 8/3 \\le 3$, $a_3 = 2\\pi = 2(8/3) = 16/3$.\n\nTotal abatement: $\\sum a_i = 4 + \\frac{8}{3} + \\frac{16}{3} = 4 + \\frac{24}{3} = 4 + 8 = 12$. This matches the required total abatement.\n\nThe equilibrium permit price is $\\pi = 8/3$. The problem asks for this value to be rounded to four significant figures.\n$\\pi = 8/3 = 2.6666...$\nRounding to four significant figures gives $2.667$.",
            "answer": "$$\\boxed{2.667}$$"
        }
    ]
}