{
    "hands_on_practices": [
        {
            "introduction": "Mastering energy systems modeling begins with a firm grasp of the fundamental principles of energy conservation. This first exercise  challenges you to derive the State-of-Charge (SoC) balance equation from first principles for a battery energy storage system. By applying this derived recurrence relation to a given power schedule, you will perform a forward simulation of the battery's state, reinforcing your understanding of how parameters like charging efficiency $\\eta_c$, discharging efficiency $\\eta_d$, and self-discharge $\\sigma$ govern the system's dynamic behavior.",
            "id": "4125178",
            "problem": "A single battery energy storage system has a State of Charge (SoC), denoted by $s_t \\in [0,1]$, defined as the stored energy normalized by the nameplate energy capacity. Consider a discrete-time model with time index $t \\in \\{0,1,\\dots,T\\}$ and uniform time step $\\Delta t$. The battery is charged by input power $p^c_t \\ge 0$ and discharged by output power $p^d_t \\ge 0$. Charging and discharging incur conversion losses represented by constant charging efficiency $\\eta_c \\in (0,1]$ and discharging efficiency $\\eta_d \\in (0,1]$, respectively. Between time steps, stored energy is reduced by a self-discharge (leakage) fraction $\\sigma \\in [0,1)$ per time step. Assume no other losses or gains.\n\nStarting from first principles of energy conservation and the definition of State of Charge (SoC), derive the appropriate discrete-time SoC balance and use it to compute the terminal SoC $s_T$ for the following parameters and input sequences:\n- Energy capacity $E = 100\\,\\text{kWh}$.\n- Time step $\\Delta t = 1\\,\\text{h}$.\n- Charging efficiency $\\eta_c = 0.96$.\n- Discharging efficiency $\\eta_d = 0.92$.\n- Self-discharge per step $\\sigma = 0.002$.\n- Initial SoC $s_0 = 0.50$.\n- Horizon length $T = 6$.\n- Power sequences for $t=1,\\dots,6$ (in $\\text{kW}$):\n  - $t=1$: $p^c_1 = 10$, $p^d_1 = 0$.\n  - $t=2$: $p^c_2 = 20$, $p^d_2 = 0$.\n  - $t=3$: $p^c_3 = 0$, $p^d_3 = 15$.\n  - $t=4$: $p^c_4 = 0$, $p^d_4 = 10$.\n  - $t=5$: $p^c_5 = 5$, $p^d_5 = 0$.\n  - $t=6$: $p^c_6 = 0$, $p^d_6 = 0$.\n\nIn your derivation, begin from conservation of energy at the device boundary and the definition of SoC as normalized stored energy. Then, verify feasibility by checking that the computed trajectory satisfies $0 \\le s_t \\le 1$ for all $t \\in \\{1,\\dots,T\\}$. Finally, report the terminal SoC $s_T$ as a dimensionless fraction. Round your answer to six significant figures and express it as a pure number without units.",
            "solution": "The problem will first be validated against the criteria of being scientifically grounded, well-posed, objective, and complete.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **System Definition**: A single battery energy storage system.\n-   **State Variable**: State of Charge (SoC), $s_t \\in [0,1]$, defined as stored energy normalized by nameplate energy capacity.\n-   **Time Model**: Discrete-time with index $t \\in \\{0,1,\\dots,T\\}$ and uniform time step $\\Delta t$.\n-   **Input/Output**: Charging power $p^c_t \\ge 0$, discharging power $p^d_t \\ge 0$.\n-   **Losses**: Constant charging efficiency $\\eta_c \\in (0,1]$, constant discharging efficiency $\\eta_d \\in (0,1]$, and self-discharge fraction per time step $\\sigma \\in [0,1)$.\n-   **Initial State**: Initial SoC $s_0$.\n-   **Parameters**:\n    -   Energy capacity $E = 100\\,\\text{kWh}$.\n    -   Time step $\\Delta t = 1\\,\\text{h}$.\n    -   Charging efficiency $\\eta_c = 0.96$.\n    -   Discharging efficiency $\\eta_d = 0.92$.\n    -   Self-discharge per step $\\sigma = 0.002$.\n    -   Initial SoC $s_0 = 0.50$.\n    -   Horizon length $T = 6$.\n-   **Input Sequences**:\n    -   $t=1$: $p^c_1 = 10\\,\\text{kW}$, $p^d_1 = 0\\,\\text{kW}$.\n    -   $t=2$: $p^c_2 = 20\\,\\text{kW}$, $p^d_2 = 0\\,\\text{kW}$.\n    -   $t=3$: $p^c_3 = 0\\,\\text{kW}$, $p^d_3 = 15\\,\\text{kW}$.\n    -   $t=4$: $p^c_4 = 0\\,\\text{kW}$, $p^d_4 = 10\\,\\text{kW}$.\n    -   $t=5$: $p^c_5 = 5\\,\\text{kW}$, $p^d_5 = 0\\,\\text{kW}$.\n    -   $t=6$: $p^c_6 = 0\\,\\text{kW}$, $p^d_6 = 0\\,\\text{kW}$.\n-   **Task**: Derive the discrete-time SoC balance equation from first principles, compute the terminal SoC $s_T$, verify feasibility ($0 \\le s_t \\le 1$), and provide $s_T$ rounded to six significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem describes a standard energy balance model for a battery, incorporating fundamental concepts like charging/discharging efficiency and self-discharge. These concepts are well-established in electrical engineering and energy systems modeling. The model is based on the principle of conservation of energy.\n-   **Well-Posed**: The problem provides all necessary parameters ($E, \\Delta t, \\eta_c, \\eta_d, \\sigma$), a well-defined initial condition ($s_0$), and a complete set of input sequences ($p^c_t, p^d_t$) for the entire time horizon. This allows for the computation of a unique solution for the state trajectory $s_t$ and the terminal state $s_T$.\n-   **Objective**: The problem is formulated using precise, unambiguous technical terminology. The quantities are defined, and the task is specific and quantitative. There is no subjective or opinion-based content.\n-   **Completeness**: The problem is self-contained and provides all data required for its solution. The units are consistent (power in $\\text{kW}$, time in $\\text{h}$, capacity in $\\text{kWh}$).\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically sound, well-posed, objective, and complete. We may proceed with the solution.\n\n### Derivation of the SoC Balance Equation\n\nLet $S_t$ be the absolute amount of energy stored in the battery at the end of time step $t$, measured in $\\text{kWh}$. The State of Charge (SoC), $s_t$, is defined as the stored energy normalized by the nameplate energy capacity $E$:\n$$s_t = \\frac{S_t}{E}$$\nWe derive the evolution of $S_t$ from time step $t-1$ to $t$ based on the principle of energy conservation.\n\nThe state at the end of time step $t-1$ is $S_{t-1}$. The problem states that a self-discharge fraction $\\sigma$ is lost \"between time steps\". This implies that the energy at the beginning of the operational phase of step $t$ is the energy from the previous step, decayed by self-discharge.\nEnergy after self-discharge: $S_{t-1} (1-\\sigma)$.\n\nDuring the time step $t$, which has a duration of $\\Delta t$, the battery is charged and/or discharged.\n1.  **Charging**: An input power $p^c_t$ is applied. The energy delivered to the battery over $\\Delta t$ is $p^c_t \\Delta t$. Due to conversion losses, only a fraction $\\eta_c$ of this energy is successfully stored. The energy added to storage is $\\eta_c p^c_t \\Delta t$.\n2.  **Discharging**: An output power $p^d_t$ is delivered by the battery. The energy delivered to the load is $p^d_t \\Delta t$. Due to conversion losses, a larger amount of energy must be drained from the storage. This amount is $\\frac{1}{\\eta_d} p^d_t \\Delta t$.\n\nCombining these effects, the total stored energy $S_t$ at the end of time step $t$ is the energy after self-discharge plus the net energy change from charging and discharging:\n$$S_t = S_{t-1}(1-\\sigma) + \\eta_c p^c_t \\Delta t - \\frac{1}{\\eta_d} p^d_t \\Delta t$$\nTo obtain the SoC balance equation, we divide the entire equation by the energy capacity $E$:\n$$\\frac{S_t}{E} = \\frac{S_{t-1}}{E}(1-\\sigma) + \\frac{\\eta_c \\Delta t}{E} p^c_t - \\frac{\\Delta t}{\\eta_d E} p^d_t$$\nSubstituting the definition of SoC, we arrive at the discrete-time SoC balance equation:\n$$s_t = s_{t-1}(1-\\sigma) + \\frac{\\eta_c \\Delta t}{E} p^c_t - \\frac{\\Delta t}{\\eta_d E} p^d_t$$\n\n### Calculation of Terminal SoC\n\nWe now substitute the given numerical values into the derived equation.\n-   $1-\\sigma = 1 - 0.002 = 0.998$.\n-   The charging coefficient is $\\frac{\\eta_c \\Delta t}{E} = \\frac{0.96 \\times 1\\,\\text{h}}{100\\,\\text{kWh}} = 0.0096\\,\\text{kW}^{-1}$.\n-   The discharging coefficient is $\\frac{\\Delta t}{\\eta_d E} = \\frac{1\\,\\text{h}}{0.92 \\times 100\\,\\text{kWh}} = \\frac{1}{92}\\,\\text{kW}^{-1}$.\n\nThe recurrence relation for this specific problem is:\n$$s_t = 0.998 s_{t-1} + 0.0096 p^c_t - \\frac{1}{92} p^d_t$$\nWe start with $s_0 = 0.50$ and iteratively compute $s_t$ for $t=1, \\dots, 6$.\n\n**Step $t=1$**: $p^c_1 = 10$, $p^d_1 = 0$.\n$$s_1 = 0.998 \\times s_0 + 0.0096 \\times 10 - \\frac{1}{92} \\times 0$$\n$$s_1 = 0.998 \\times 0.5 + 0.096 = 0.499 + 0.096 = 0.595$$\nFeasibility check: $0 \\le 0.595 \\le 1$. The state is valid.\n\n**Step $t=2$**: $p^c_2 = 20$, $p^d_2 = 0$.\n$$s_2 = 0.998 \\times s_1 + 0.0096 \\times 20 - \\frac{1}{92} \\times 0$$\n$$s_2 = 0.998 \\times 0.595 + 0.192 = 0.59381 + 0.192 = 0.78581$$\nFeasibility check: $0 \\le 0.78581 \\le 1$. The state is valid.\n\n**Step $t=3$**: $p^c_3 = 0$, $p^d_3 = 15$.\n$$s_3 = 0.998 \\times s_2 + 0.0096 \\times 0 - \\frac{1}{92} \\times 15$$\n$$s_3 = 0.998 \\times 0.78581 - \\frac{15}{92} \\approx 0.78423838 - 0.16304348 \\approx 0.62119490$$\nFeasibility check: $0 \\le 0.62119490 \\le 1$. The state is valid.\n\n**Step $t=4$**: $p^c_4 = 0$, $p^d_4 = 10$.\n$$s_4 = 0.998 \\times s_3 - \\frac{1}{92} \\times 10$$\n$$s_4 \\approx 0.998 \\times 0.62119490 - \\frac{10}{92} \\approx 0.61995251 - 0.10869565 \\approx 0.51125686$$\nFeasibility check: $0 \\le 0.51125686 \\le 1$. The state is valid.\n\n**Step $t=5$**: $p^c_5 = 5$, $p^d_5 = 0$.\n$$s_5 = 0.998 \\times s_4 + 0.0096 \\times 5$$\n$$s_5 \\approx 0.998 \\times 0.51125686 + 0.048 \\approx 0.51023435 + 0.048 = 0.55823435$$\nFeasibility check: $0 \\le 0.55823435 \\le 1$. The state is valid.\n\n**Step $t=6$**: $p^c_6 = 0$, $p^d_6 = 0$.\nThis is the final step, giving the terminal SoC $s_T = s_6$.\n$$s_6 = 0.998 \\times s_5 + 0.0096 \\times 0 - \\frac{1}{92} \\times 0$$\n$$s_6 = 0.998 \\times s_5 \\approx 0.998 \\times 0.55823435 \\approx 0.55711788$$\nFeasibility check: $0 \\le 0.55711788 \\le 1$. The terminal state is valid.\n\nThe unrounded value for the terminal SoC $s_6$ is approximately $0.55711787735...$. Rounding to six significant figures, we get $0.557118$.",
            "answer": "$$\\boxed{0.557118}$$"
        },
        {
            "introduction": "Building on the dynamic simulation, this practice  shifts the perspective from merely observing the system's evolution to actively constraining its operation. Instead of calculating the final state from given power inputs, you will use the SoC balance equation to determine the maximum allowable charging power $p^c_t$ that respects the physical storage limits of the device. This exercise is crucial for developing the skill of formulating operational constraints, a cornerstone of designing optimization and control algorithms for energy systems.",
            "id": "4125166",
            "problem": "An electric energy storage system with normalized state of charge (SoC) $s_t \\in [0,1]$ stores energy $E_t$ related by $s_t = E_t / E_{\\max}$, where $E_{\\max}$ is the usable energy capacity. Over a scheduling interval of length $\\Delta t$, the stored energy changes due to three physically grounded processes: (i) charging at constant power $p^c_t \\ge 0$ with one-way charging efficiency $\\eta_c \\in (0,1]$, (ii) discharging at constant power $p^d_t \\ge 0$ with one-way discharging efficiency $\\eta_d \\in (0,1]$, and (iii) self-discharge modeled as an exponential decay of stored energy with rate $\\lambda \\ge 0$, giving a retention factor $\\phi = \\exp(-\\lambda \\Delta t)$ over the interval. Additionally, there is a constant auxiliary load $P_{\\mathrm{aux}} \\ge 0$ (in $\\mathrm{MW}$) that draws energy from the storage during the interval. Assume all powers are constant over the interval and that no saturation occurs within the interval. Starting from conservation of energy and the definition of state of charge, determine the maximum allowable charging power $p^c_t$ that ensures the upper bound $s_t \\le 1$ is satisfied at the end of the interval.\n\nUse the following parameter values: the usable energy capacity is $E_{\\max} = 180\\,\\mathrm{MWh}$, the previous normalized SoC is $s_{t-1} = 0.85$, the interval length is $\\Delta t = 0.5\\,\\mathrm{h}$, the self-discharge rate is $\\lambda = 0.01\\,\\mathrm{h}^{-1}$, the charging efficiency is $\\eta_c = 0.94$, the discharging efficiency is $\\eta_d = 0.92$, the auxiliary load is $P_{\\mathrm{aux}} = 0.6\\,\\mathrm{MW}$, and the scheduled discharging power is $p^d_t = 10\\,\\mathrm{MW}$. Round your answer to four significant figures. Express the final charging power in $\\mathrm{MW}$.",
            "solution": "The problem will first be validated against the criteria of being scientifically grounded, well-posed, objective, and complete.\n\n### PROBLEM VALIDATION\n\n**Step 1: Extract Givens**\n\n-   **State Variable:** Normalized state of charge $s_t \\in [0,1]$.\n-   **Definition:** $s_t = E_t / E_{\\max}$, where $E_t$ is stored energy and $E_{\\max}$ is usable energy capacity.\n-   **Interval Length:** $\\Delta t$.\n-   **Processes:**\n    -   Charging: constant power $p^c_t \\ge 0$, efficiency $\\eta_c \\in (0,1]$.\n    -   Discharging: constant power $p^d_t \\ge 0$, efficiency $\\eta_d \\in (0,1]$.\n    -   Self-discharge: rate $\\lambda \\ge 0$, retention factor $\\phi = \\exp(-\\lambda \\Delta t)$.\n    -   Auxiliary load: constant power $P_{\\mathrm{aux}} \\ge 0$.\n-   **Objective:** Determine the maximum allowable charging power $p^c_t$ such that $s_t \\le 1$ at the end of the interval.\n-   **Assumptions:** Powers are constant over the interval; no saturation occurs within the interval.\n-   **Parameter Values:**\n    -   $E_{\\max} = 180\\,\\mathrm{MWh}$\n    -   $s_{t-1} = 0.85$\n    -   $\\Delta t = 0.5\\,\\mathrm{h}$\n    -   $\\lambda = 0.01\\,\\mathrm{h}^{-1}$\n    -   $\\eta_c = 0.94$\n    -   $\\eta_d = 0.92$\n    -   $P_{\\mathrm{aux}} = 0.6\\,\\mathrm{MW}$\n    -   $p^d_t = 10\\,\\mathrm{MW}$\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientific Grounding:** The problem is scientifically grounded. It presents a standard energy balance model for an energy storage system, incorporating well-established concepts like charging/discharging efficiencies, self-discharge, and auxiliary loads. The model is based on the fundamental principle of conservation of energy.\n-   **Well-Posedness:** The problem is well-posed. It asks for a single unknown variable, $p^c_t$, based on a clear constraint ($s_t \\le 1$), and provides all necessary parameters. A unique solution exists.\n-   **Objectivity:** The problem is stated in objective, quantitative terms, free from ambiguity or subjective claims.\n-   **Consistency and Completeness:** The setup is self-contained and free of contradictions. All required data are provided. The units are consistent (MWh, MW, h).\n-   **Realism:** The parameters are physically plausible for a grid-scale battery energy storage system. The assumption of constant power over a $0.5\\,\\mathrm{h}$ interval is a common and acceptable simplification in energy systems modeling.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### SOLUTION\n\nThe problem requires finding the maximum charging power, $p^c_t$, for an energy storage system over a time interval $\\Delta t$, such that the final state of charge, $s_t$, does not exceed its upper limit of $1$. The solution is derived from the principle of conservation of energy.\n\nThe energy stored in the system at the end of the interval, $E_t$, is determined by the energy at the beginning of the interval, $E_{t-1}$, and the net energy change over the interval. The processes affecting the stored energy are self-discharge, charging from the grid, discharging to the grid, and an internal auxiliary load.\n\nThe energy balance equation can be formulated by considering these processes sequentially. First, the energy at the start of the interval is $E_{t-1}$. This energy decays due to self-discharge over the interval $\\Delta t$. The self-discharge is modeled as an exponential decay with rate $\\lambda$, resulting in a retention factor of $\\phi = \\exp(-\\lambda \\Delta t)$. The energy remaining after self-discharge is $E_{t-1} \\phi$.\n\nDuring the interval, there is a net energy exchange from power-related activities.\n$1$. The energy added by charging at power $p^c_t$ with efficiency $\\eta_c$ is $p^c_t \\eta_c \\Delta t$.\n$2$. To deliver a discharging power of $p^d_t$ to the grid with efficiency $\\eta_d$, the energy drawn from the storage is $\\frac{p^d_t}{\\eta_d} \\Delta t$.\n$3$. The energy consumed by the constant auxiliary load $P_{\\mathrm{aux}}$ is $P_{\\mathrm{aux}} \\Delta t$.\n\nCombining these terms, the energy at the end of the interval, $E_t$, is given by the balance equation:\n$$E_t = E_{t-1} \\phi + p^c_t \\eta_c \\Delta t - \\frac{p^d_t}{\\eta_d} \\Delta t - P_{\\mathrm{aux}} \\Delta t$$\n\nThe normalized state of charge (SoC) is defined as $s_t = E_t / E_{\\max}$. By dividing the entire energy balance equation by the maximum usable energy capacity $E_{\\max}$, we obtain the SoC balance equation:\n$$\\frac{E_t}{E_{\\max}} = \\frac{E_{t-1}}{E_{\\max}} \\phi + \\frac{\\Delta t}{E_{\\max}} \\left( p^c_t \\eta_c - \\frac{p^d_t}{\\eta_d} - P_{\\mathrm{aux}} \\right)$$\n$$s_t = s_{t-1} \\phi + \\frac{\\Delta t}{E_{\\max}} \\left( p^c_t \\eta_c - \\frac{p^d_t}{\\eta_d} - P_{\\mathrm{aux}} \\right)$$\n\nTo find the maximum allowable charging power $p^c_t$, we impose the boundary condition that the final SoC reaches its maximum value, $s_t = 1$.\n$$1 = s_{t-1} \\phi + \\frac{\\Delta t}{E_{\\max}} \\left( p^c_t \\eta_c - \\frac{p^d_t}{\\eta_d} - P_{\\mathrm{aux}} \\right)$$\n\nWe now solve this equation for $p^c_t$:\n$$1 - s_{t-1} \\phi = \\frac{\\Delta t}{E_{\\max}} \\left( p^c_t \\eta_c - \\frac{p^d_t}{\\eta_d} - P_{\\mathrm{aux}} \\right)$$\n$$\\frac{E_{\\max}}{\\Delta t} (1 - s_{t-1} \\phi) = p^c_t \\eta_c - \\frac{p^d_t}{\\eta_d} - P_{\\mathrm{aux}}$$\n$$p^c_t \\eta_c = \\frac{E_{\\max}}{\\Delta t} (1 - s_{t-1} \\phi) + \\frac{p^d_t}{\\eta_d} + P_{\\mathrm{aux}}$$\n$$p^c_t = \\frac{1}{\\eta_c} \\left[ \\frac{E_{\\max}}{\\Delta t} (1 - s_{t-1} \\phi) + \\frac{p^d_t}{\\eta_d} + P_{\\mathrm{aux}} \\right]$$\n\nNow we substitute the given numerical values: $E_{\\max} = 180\\,\\mathrm{MWh}$, $s_{t-1} = 0.85$, $\\Delta t = 0.5\\,\\mathrm{h}$, $\\lambda = 0.01\\,\\mathrm{h}^{-1}$, $\\eta_c = 0.94$, $\\eta_d = 0.92$, $P_{\\mathrm{aux}} = 0.6\\,\\mathrm{MW}$, and $p^d_t = 10\\,\\mathrm{MW}$.\n\nFirst, calculate the retention factor $\\phi$:\n$$\\phi = \\exp(-\\lambda \\Delta t) = \\exp(-0.01 \\times 0.5) = \\exp(-0.005)$$\n\nNow substitute all values into the expression for $p^c_t$:\n$$p^c_t = \\frac{1}{0.94} \\left[ \\frac{180}{0.5} (1 - 0.85 \\exp(-0.005)) + \\frac{10}{0.92} + 0.6 \\right]$$\nLet's compute the terms inside the brackets:\n$$ \\frac{180\\,\\mathrm{MWh}}{0.5\\,\\mathrm{h}} = 360\\,\\mathrm{MW} $$\n$$ \\frac{10\\,\\mathrm{MW}}{0.92} \\approx 10.869565\\,\\mathrm{MW} $$\n$$ \\exp(-0.005) \\approx 0.9950125 $$\nThe first term in the brackets is:\n$$ 360 \\times (1 - 0.85 \\times 0.9950125) = 360 \\times (1 - 0.8457606) = 360 \\times 0.1542394 \\approx 55.52618\\,\\mathrm{MW} $$\nSumming the terms inside the brackets:\n$$ 55.52618\\,\\mathrm{MW} + 10.869565\\,\\mathrm{MW} + 0.6\\,\\mathrm{MW} \\approx 66.99575\\,\\mathrm{MW} $$\nFinally, we calculate $p^c_t$:\n$$ p^c_t = \\frac{1}{0.94} \\times 66.99575\\,\\mathrm{MW} \\approx 71.27207\\,\\mathrm{MW} $$\nRounding the result to four significant figures, we get $71.27\\,\\mathrm{MW}$.",
            "answer": "$$\n\\boxed{71.27}\n$$"
        },
        {
            "introduction": "The final practice  moves beyond the physical balance equation itself to address a critical challenge in optimization modeling: enforcing logical operating modes. Since a battery cannot simultaneously charge and discharge, this condition must be explicitly included in any optimization model, often using binary variables and \"big-$M$\" constraints like $p^{\\mathrm{ch}}_t \\le M u_t$. This exercise requires a critical analysis of such formulations, focusing on how the choice of the big-$M$ constant affects the model's strength and can lead to weak linear programming relaxations, an essential concept for building efficient and robust mixed-integer programs.",
            "id": "4125152",
            "problem": "Consider a single idealized electrochemical energy storage device modeled over discrete time periods indexed by $t \\in \\{1,\\dots,T\\}$ with time-step duration $\\Delta t  0$. Let $e_t$ denote the state of charge (SoC) at the end of period $t$, $p^{\\mathrm{ch}}_t \\ge 0$ the charging power, and $p^{\\mathrm{dis}}_t \\ge 0$ the discharging power during period $t$. The SoC dynamics follow conservation of energy with one-way efficiencies $\\eta^{\\mathrm{ch}} \\in (0,1]$ and $\\eta^{\\mathrm{dis}} \\in (0,1]$:\n$$\ne_{t+1} \\;=\\; e_t \\;+\\; \\eta^{\\mathrm{ch}}\\, p^{\\mathrm{ch}}_t\\, \\Delta t \\;-\\; \\frac{1}{\\eta^{\\mathrm{dis}}}\\, p^{\\mathrm{dis}}_t\\, \\Delta t \\quad \\text{for all } t \\in \\{1,\\dots,T-1\\}.\n$$\nThe SoC is bounded by physical limits $0 \\le \\underline E \\le e_t \\le \\bar E$ for all $t$. To preclude simultaneous charging and discharging, a mode variable $u_t \\in \\{0,1\\}$ is introduced, and so-called big-$M$ linking inequalities are used in a mixed-integer linear programming (MILP) formulation:\n$$\np^{\\mathrm{ch}}_t \\;\\le\\; M^{\\mathrm{ch}}\\, u_t, \\qquad p^{\\mathrm{dis}}_t \\;\\le\\; M^{\\mathrm{dis}}\\, (1 - u_t) \\quad \\text{for all } t,\n$$\nwith $M^{\\mathrm{ch}}  0$ and $M^{\\mathrm{dis}}  0$ chosen by the modeler. Suppose there are no explicit device power nameplate bounds besides what is implied by the SoC window $[\\underline E,\\bar E]$ and the dynamics. The model participates in an electricity market with strictly positive prices, but the storage is otherwise costless.\n\nAnalyze the role of the magnitude of $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ in avoiding weak formulations that allow simultaneity through slack in the big-$M$ linking inequalities and the linear programming (LP) relaxation (i.e., the continuous relaxation where $u_t \\in [0,1]$). Which of the following statements are correct?\n\nA. Choosing $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ excessively large weakens the LP relaxation so that fractional $u_t$ can satisfy the linking inequalities with $p^{\\mathrm{ch}}_t  0$ and $p^{\\mathrm{dis}}_t  0$ simultaneously, enabling spurious arbitrage and an artificially small objective, even though the intended integer model forbids simultaneity.\n\nB. In the absence of explicit power nameplate limits, the tightest universally valid big-$M$ values derived from the SoC bounds and time-step are $M^{\\mathrm{ch}} = (\\bar E - \\underline E)/\\Delta t$ and $M^{\\mathrm{dis}} = (\\bar E - \\underline E)/\\Delta t$, independent of $\\eta^{\\mathrm{ch}}$ and $\\eta^{\\mathrm{dis}}$.\n\nC. Adding explicit power nameplate constraints $p^{\\mathrm{ch}}_t \\le \\bar P^{\\mathrm{ch}}$ and $p^{\\mathrm{dis}}_t \\le \\bar P^{\\mathrm{dis}}$ for all $t$, and then setting $M^{\\mathrm{ch}} = \\bar P^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}} = \\bar P^{\\mathrm{dis}}$, produces a strictly stronger formulation than using extremely large $M^{\\mathrm{ch}}, M^{\\mathrm{dis}}$ without those bounds.\n\nD. The choice of $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ does not affect the integrality gap, because $u_t \\in \\{0,1\\}$ already enforces exact no-simultaneity in the MILP; therefore the LP relaxation optimal value is always equal to the MILP optimal value.\n\nE. A more robust linear formulation that avoids big-$M$ is to enforce $p^{\\mathrm{ch}}_t \\cdot p^{\\mathrm{dis}}_t = 0$ directly, because this complementarity condition is linear and eliminates simultaneity without weakening the LP relaxation.\n\nSelect all that apply.",
            "solution": "The problem asks us to analyze a standard mixed-integer linear programming (MILP) formulation for an energy storage device, specifically focusing on the role of the big-$M$ constants used to enforce mutual exclusivity between charging and discharging. The core of the analysis lies in understanding the linear programming (LP) relaxation of the model and how its quality is affected by the choice of these constants.\n\nThe state-of-charge (SoC) dynamics are given by:\n$$e_{t+1} = e_t + \\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t \\Delta t - \\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t \\Delta t$$\nwhere $e_t$ is the energy stored, $p^{\\mathrm{ch}}_t \\ge 0$ is the charging power, $p^{\\mathrm{dis}}_t \\ge 0$ is the discharging power, $\\Delta t$ is the time step duration, and $\\eta^{\\mathrm{ch}}, \\eta^{\\mathrm{dis}} \\in (0,1]$ are the one-way efficiencies.\n\nTo prevent simultaneous charging and discharging, a binary variable $u_t \\in \\{0,1\\}$ is introduced along with the big-$M$ constraints:\n$$p^{\\mathrm{ch}}_t \\le M^{\\mathrm{ch}} u_t$$\n$$p^{\\mathrm{dis}}_t \\le M^{\\mathrm{dis}} (1 - u_t)$$\nIf $u_t=1$, the second constraint forces $p^{\\mathrm{dis}}_t \\le 0$, and since $p^{\\mathrm{dis}}_t \\ge 0$, it must be that $p^{\\mathrm{dis}}_t=0$. The device can only charge.\nIf $u_t=0$, the first constraint forces $p^{\\mathrm{ch}}_t \\le 0$, which implies $p^{\\mathrm{ch}}_t=0$. The device can only discharge.\nThis correctly models the intended logic in the MILP.\n\nThe central issue arises in the LP relaxation, where the binary constraint is relaxed to a continuous one: $u_t \\in [0,1]$. A branch-and-bound solver for the MILP relies on solving this LP relaxation at each node of the search tree to obtain bounds on the optimal objective value. A \"weak\" relaxation provides a bound that is far from the true integer optimal value, which typically leads to a much larger search tree and longer computation times. A formulation is \"strong\" if its LP relaxation provides a tight bound.\n\nThe choice of the constants $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ is critical. For the formulation to be valid, they must be upper bounds on the respective power variables, i.e., $M^{\\mathrm{ch}} \\ge \\max(p^{\\mathrm{ch}}_t)$ and $M^{\\mathrm{dis}} \\ge \\max(p^{\\mathrm{dis}}_t)$. However, choosing values that are much larger than necessary weakens the LP relaxation.\n\nLet's evaluate each statement.\n\n**A. Choosing $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ excessively large weakens the LP relaxation so that fractional $u_t$ can satisfy the linking inequalities with $p^{\\mathrm{ch}}_t  0$ and $p^{\\mathrm{dis}}_t  0$ simultaneously, enabling spurious arbitrage and an artificially small objective, even though the intended integer model forbids simultaneity.**\n\nIn the LP relaxation, if the solver chooses a fractional value for the binary variable, say $u_t^* \\in (0,1)$, the constraints become $p^{\\mathrm{ch}}_t \\le M^{\\mathrm{ch}} u_t^*$ and $p^{\\mathrm{dis}}_t \\le M^{\\mathrm{dis}} (1-u_t^*)$. Both right-hand sides are positive, allowing for simultaneous non-zero charging and discharging, which is physically impossible. If $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ are \"excessively large\", then even for a small fractional $u_t^*$, the allowed power values can be very large. This expands the feasible region of the LP relaxation significantly beyond the convex hull of the true integer feasible solutions. An optimization algorithm aiming to minimize cost (or maximize profit) will exploit this larger region. This can lead to an \"artificially small objective\" (for minimization) because the LP solver finds a solution in this non-physical space that appears cheaper than any physically achievable solution. This phenomenon is often termed \"spurious arbitrage\" in modeling literature, as the model finds a way to profit from a structural flaw. Thus, using excessively large big-$M$ values indeeds weakens the formulation.\n\n**Verdict: Correct.**\n\n**B. In the absence of explicit power nameplate limits, the tightest universally valid big-$M$ values derived from the SoC bounds and time-step are $M^{\\mathrm{ch}} = (\\bar E - \\underline E)/\\Delta t$ and $M^{\\mathrm{dis}} = (\\bar E - \\underline E)/\\Delta t$, independent of $\\eta^{\\mathrm{ch}}$ and $\\eta^{\\mathrm{dis}}$.**\n\nTo find the tightest possible (i.e., smallest) valid values for $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$, we must find the maximum possible power that the device can sustain for one time step, based on its energy capacity $[\\underline E, \\bar E]$.\n\nFor charging ($p^{\\mathrm{dis}}_t=0$): The maximum power is achieved when the SoC can increase by the largest possible amount, which is from $e_t = \\underline E$ to $e_{t+1} = \\bar E$.\nFrom the SoC dynamics: $e_{t+1} - e_t = \\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t \\Delta t$.\nThe maximum change is $\\bar E - \\underline E$. So, $\\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t \\Delta t \\le \\bar E - \\underline E$.\nThis implies an upper bound on charging power: $p^{\\mathrm{ch}}_t \\le \\frac{\\bar E - \\underline E}{\\eta^{\\mathrm{ch}} \\Delta t}$.\nThe tightest valid big-$M$ for charging is therefore $M^{\\mathrm{ch}}_{\\text{tight}} = \\frac{\\bar E - \\underline E}{\\eta^{\\mathrm{ch}} \\Delta t}$.\n\nFor discharging ($p^{\\mathrm{ch}}_t=0$): The maximum power is achieved when the SoC can decrease by the largest possible amount, from $e_t = \\bar E$ to $e_{t+1} = \\underline E$.\nFrom the SoC dynamics: $e_t - e_{t+1} = \\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t \\Delta t$.\nThe maximum change is again $\\bar E - \\underline E$. So, $\\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t \\Delta t \\le \\bar E - \\underline E$.\nThis implies an upper bound on discharging power: $p^{\\mathrm{dis}}_t \\le \\frac{(\\bar E - \\underline E)\\eta^{\\mathrm{dis}}}{\\Delta t}$.\nThe tightest valid big-$M$ for discharging is $M^{\\mathrm{dis}}_{\\text{tight}} = \\frac{(\\bar E - \\underline E)\\eta^{\\mathrm{dis}}}{\\Delta t}$.\n\nThe statement suggests values that do not include the efficiency terms $\\eta^{\\mathrm{ch}}$ and $\\eta^{\\mathrm{dis}}$. Since $\\eta^{\\mathrm{ch}} \\in (0,1]$, the suggested $M^{\\mathrm{ch}} = (\\bar E - \\underline E)/\\Delta t$ is smaller than or equal to the correctly derived tight bound. If $\\eta^{\\mathrm{ch}}  1$, this proposed $M^{\\mathrm{ch}}$ would be too small and could render physically possible charging rates infeasible in the model. The suggested $M^{\\mathrm{dis}}$ is valid but not the tightest if $\\eta^{\\mathrm{dis}}  1$. Because the proposed $M^{\\mathrm{ch}}$ is not even a universally valid bound, the statement is incorrect.\n\n**Verdict: Incorrect.**\n\n**C. Adding explicit power nameplate constraints $p^{\\mathrm{ch}}_t \\le \\bar P^{\\mathrm{ch}}$ and $p^{\\mathrm{dis}}_t \\le \\bar P^{\\mathrm{dis}}$ for all $t$, and then setting $M^{\\mathrm{ch}} = \\bar P^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}} = \\bar P^{\\mathrm{dis}}$, produces a strictly stronger formulation than using extremely large $M^{\\mathrm{ch}}, M^{\\mathrm{dis}}$ without those bounds.**\n\nA stronger formulation is one with a tighter LP relaxation. By definition, a nameplate capacity is an upper bound on power, so setting $M^{\\mathrm{ch}} = \\bar P^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}} = \\bar P^{\\mathrm{dis}}$ is valid (assuming these are tighter than the bounds derived in B). Using an \"extremely large\" $M$ means $M \\gg \\bar P$.\nThe LP relaxation with $M^{\\mathrm{ch}} = \\bar P^{\\mathrm{ch}}$ has the constraint $p^{\\mathrm{ch}}_t \\le \\bar P^{\\mathrm{ch}} u_t$.\nThe LP relaxation with $M^{\\mathrm{ch}} = M^{\\mathrm{ch}}_{\\text{large}}$ has the constraint $p^{\\mathrm{ch}}_t \\le M^{\\mathrm{ch}}_{\\text{large}} u_t$.\nSince $\\bar P^{\\mathrm{ch}}  M^{\\mathrm{ch}}_{\\text{large}}$, the feasible region for the formulation with $M=\\bar P$ is a subset of the feasible region for the formulation with $M=M_{\\text{large}}$. A smaller feasible region for the LP relaxation leads to a bound that is closer to (or the same as) the integer optimum. This tightens the relaxation and strengthens the formulation. The improvement is \"strict\" because the optimal solution of the weak LP relaxation will almost certainly exploit the slack provided by the large $M$ values, thus violating the constraints of the tighter formulation.\n\n**Verdict: Correct.**\n\n**D. The choice of $M^{\\mathrm{ch}}$ and $M^{\\mathrm{dis}}$ does not affect the integrality gap, because $u_t \\in \\{0,1\\}$ already enforces exact no-simultaneity in the MILP; therefore the LP relaxation optimal value is always equal to the MILP optimal value.**\n\nThis statement makes two incorrect claims.\nFirst, the choice of $M$ values directly affects the LP relaxation, and therefore the integrality gap, which is defined as the difference between the MILP optimal value ($Z_{MILP}$) and the LP relaxation optimal value ($Z_{LP}$). While $M$ does not change $Z_{MILP}$ (as long as it's a valid bound), it does change $Z_{LP}$. As established in A and C, larger $M$ values lead to a weaker (more optimistic) $Z_{LP}$ and thus a larger integrality gap.\nSecond, the claim that $Z_{LP}$ is always equal to $Z_{MILP}$ is false. This property, known as integrality, holds only for specially structured problems. For a general MILP with big-$M$ constraints like this one, the vertices of the LP relaxation's feasible set are not all integer-valued. The LP relaxation optimum will typically occur at a point where some $u_t$ variables are fractional, yielding an objective value that is better than what is achievable with integer variables. Thus, there is usually a non-zero integrality gap.\n\n**Verdict: Incorrect.**\n\n**E. A more robust linear formulation that avoids big-$M$ is to enforce $p^{\\mathrm{ch}}_t \\cdot p^{\\mathrm{dis}}_t = 0$ directly, because this complementarity condition is linear and eliminates simultaneity without weakening the LP relaxation.**\n\nThe condition $p^{\\mathrm{ch}}_t \\cdot p^{\\mathrm{dis}}_t = 0$, combined with $p^{\\mathrm{ch}}_t \\ge 0$ and $p^{\\mathrm{dis}}_t \\ge 0$, correctly states that at least one of the power variables must be zero. However, this is not a *linear* constraint. The product of two variables ($p^{\\mathrm{ch}}_t$ and $p^{\\mathrm{dis}}_t$) results in a quadratic term. Including such a constraint in an otherwise linear model would make it a Mixed-Integer Non-Linear Program (MINLP), which is generally much more difficult to solve than an MILP. The entire purpose of big-M formulations and other techniques like Special Ordered Sets (SOS) is to represent such non-linear logical conditions using only linear constraints and integer variables. The fundamental premise of the statement—that the constraint is linear—is false.\n\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}