{
    "hands_on_practices": [
        {
            "introduction": "Accurate modeling of variable renewable energy begins with a firm grasp of the resource itself. This practice grounds your understanding in fundamental atmospheric physics, guiding you to derive the logarithmic wind profile from first principles. You will then apply this knowledge to a core task in wind resource assessment: extrapolating measured wind speeds to a turbine's hub height and accounting for the accelerating effect of local terrain, a crucial step in predicting a wind farm's potential power output .",
            "id": "4134886",
            "problem": "A wind turbine site is characterized by an upstream, horizontally homogeneous surface with roughness length $z_{0}$ and neutral atmospheric stability. A calibrated cup anemometer on a meteorological mast reports a $10$-minute mean horizontal wind speed $U_{\\mathrm{ref}}$ at a reference height $z_{\\mathrm{ref}}$ above ground. The turbine hub height is $z_{h}$. Close to the site, the flow encounters a gentle, two-dimensional ridge whose crest is aligned parallel to the turbine row, so that the mean flow is perpendicular to the ridge. The ridge has geometric height $H$ above the surrounding plain and an upwind slope length scale $L$ (defined as the horizontal distance over which the elevation rises from the plain to the crest), with $H/L \\ll 1$. Assume that the roughness length is the same on the plain and on the ridge and that displacement height is negligible.\n\nStarting from the following foundational bases for neutrally stratified, stationary, horizontally homogeneous turbulent boundary layer flow over a rough surface:\n- the vertical turbulent momentum flux (shear stress) is height-invariant and can be expressed as $\\tau = \\rho\\,u_{*}^{2}$, where $\\rho$ is air density and $u_{*}$ is the friction velocity,\n- a first-order closure with an eddy viscosity (momentum diffusivity) $K_{m}$ and flux–gradient relation $\\tau = \\rho\\,K_{m}\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}$,\n- a mixing-length argument that yields $K_{m} = \\kappa\\,u_{*}\\,z$ under neutral stability,\n\nderive the mean wind speed profile $U(z)$ over flat terrain and use it to compute the hub-height wind speed over flat terrain, $U_{\\mathrm{flat}}(z_{h})$, from the measured $U_{\\mathrm{ref}}$ at $z_{\\mathrm{ref}}$, given $z_{0}$. Then, to account for terrain-induced acceleration at the ridge crest, adopt a simple linear orographic speed-up model valid for gentle two-dimensional ridges under neutral conditions, in which the fractional speed-up at the crest is proportional to the upwind slope,\n$$S = c\\,\\frac{H}{L},$$\nwith a proportionality constant $c = 2.0$. Estimate the hub-height wind speed at the ridge crest as $U_{\\mathrm{crest}}(z_{h}) = U_{\\mathrm{flat}}(z_{h})\\,(1+S)$.\n\nUse the following numerical values:\n- $\\kappa = 0.40$,\n- $U_{\\mathrm{ref}} = 7.50~\\mathrm{m}\\,\\mathrm{s}^{-1}$ at $z_{\\mathrm{ref}} = 10~\\mathrm{m}$,\n- $z_{0} = 0.050~\\mathrm{m}$,\n- $z_{h} = 120~\\mathrm{m}$,\n- $H = 40.0~\\mathrm{m}$,\n- $L = 400.0~\\mathrm{m}$.\n\nCompute $U_{\\mathrm{crest}}(z_{h})$ and express your final answer in $\\mathrm{m}\\,\\mathrm{s}^{-1}$. Round your answer to four significant figures.",
            "solution": "The problem statement is parsed and validated.\n\n### Step 1: Extract Givens\n- Upstream surface roughness length: $z_{0}$\n- Atmospheric stability: neutral\n- Reference mean horizontal wind speed: $U_{\\mathrm{ref}}$ at reference height $z_{\\mathrm{ref}}$\n- Turbine hub height: $z_{h}$\n- Ridge geometric height: $H$\n- Ridge upwind slope length scale: $L$\n- Condition: $H/L \\ll 1$\n- Assumption: Roughness length is uniform.\n- Assumption: Displacement height is negligible.\n- Foundational basis 1: Vertical turbulent momentum flux (shear stress) is $\\tau = \\rho\\,u_{*}^{2}$, where $\\rho$ is air density and $u_{*}$ is the friction velocity. $\\tau$ is height-invariant.\n- Foundational basis 2: Flux–gradient relation is $\\tau = \\rho\\,K_{m}\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}$, with $K_{m}$ as the eddy viscosity.\n- Foundational basis 3: Mixing-length model for eddy viscosity is $K_{m} = \\kappa\\,u_{*}\\,z$.\n- Orographic speed-up model: The fractional speed-up at the crest is $S = c\\,\\frac{H}{L}$.\n- Hub-height wind speed at the crest: $U_{\\mathrm{crest}}(z_{h}) = U_{\\mathrm{flat}}(z_{h})\\,(1+S)$.\n- Numerical values:\n    - von Kármán constant, $\\kappa = 0.40$\n    - $U_{\\mathrm{ref}} = 7.50~\\mathrm{m}\\,\\mathrm{s}^{-1}$\n    - $z_{\\mathrm{ref}} = 10~\\mathrm{m}$\n    - $z_{0} = 0.050~\\mathrm{m}$\n    - $z_{h} = 120~\\mathrm{m}$\n    - $H = 40.0~\\mathrm{m}$\n    - $L = 400.0~\\mathrm{m}$\n    - Proportionality constant, $c = 2.0$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on standard, well-established principles of atmospheric boundary layer physics (logarithmic wind profile) and a common, simplified model for flow over gentle terrain (linear theory). The problem is self-contained, providing all necessary physical assumptions and numerical data. The condition $H/L = 40.0/400.0 = 0.1 \\ll 1$ is satisfied, justifying the use of the linear speed-up model. The values provided are physically realistic for a wind resource assessment context. The problem is not ill-posed, contradictory, or trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\nThe first task is to derive the mean wind speed profile $U(z)$ over flat terrain from the foundational principles provided for a neutrally stratified, stationary, horizontally homogeneous turbulent boundary layer.\n\nWe are given two expressions for the shear stress $\\tau$:\n$$\n\\tau = \\rho\\,u_{*}^{2}\n$$\nand\n$$\n\\tau = \\rho\\,K_{m}\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}\n$$\nEquating these expressions and dividing by the air density $\\rho$ gives:\n$$\nu_{*}^{2} = K_{m}\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}\n$$\nNext, we substitute the given mixing-length model for the eddy viscosity, $K_{m} = \\kappa\\,u_{*}\\,z$:\n$$\nu_{*}^{2} = (\\kappa\\,u_{*}\\,z)\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}\n$$\nAssuming a non-zero friction velocity ($u_{*}  0$), we can divide by $u_{*}$:\n$$\nu_{*} = \\kappa\\,z\\,\\frac{\\mathrm{d}U}{\\mathrm{d}z}\n$$\nThis is a separable first-order ordinary differential equation for the wind speed $U$ as a function of height $z$. We rearrange it for integration:\n$$\n\\mathrm{d}U = \\frac{u_{*}}{\\kappa}\\,\\frac{\\mathrm{d}z}{z}\n$$\nTo find the profile $U(z)$, we integrate this equation. The boundary condition for flow over a rough surface is that the wind speed extrapolates to zero at the roughness length, i.e., $U(z_{0}) = 0$. We integrate from the roughness height $z_{0}$ to an arbitrary height $z$:\n$$\n\\int_{0}^{U(z)} \\mathrm{d}U' = \\int_{z_{0}}^{z} \\frac{u_{*}}{\\kappa}\\,\\frac{\\mathrm{d}z'}{z'}\n$$\nSince $u_{*}$ and $\\kappa$ are constant with height in this model, we have:\n$$\nU(z) = \\frac{u_{*}}{\\kappa} \\int_{z_{0}}^{z} \\frac{1}{z'}\\,\\mathrm{d}z' = \\frac{u_{*}}{\\kappa} [\\ln(z')]_{z_0}^{z}\n$$\n$$\nU(z) = \\frac{u_{*}}{\\kappa} (\\ln(z) - \\ln(z_{0}))\n$$\nUsing the properties of logarithms, we arrive at the logarithmic wind profile:\n$$\nU(z) = \\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z}{z_{0}}\\right)\n$$\nThis profile describes the wind speed over flat terrain, which we denote as $U_{\\mathrm{flat}}(z)$.\n\nThe next step is to use the measured wind speed $U_{\\mathrm{ref}}$ at height $z_{\\mathrm{ref}}$ to determine the wind speed at the hub height $z_{h}$ over this flat terrain, $U_{\\mathrm{flat}}(z_h)$. We have two instances of the logarithmic profile:\nAt the reference height: $U_{\\mathrm{ref}} = U_{\\mathrm{flat}}(z_{\\mathrm{ref}}) = \\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z_{\\mathrm{ref}}}{z_{0}}\\right)$\nAt the hub height: $U_{\\mathrm{flat}}(z_{h}) = \\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z_{h}}{z_{0}}\\right)$\n\nTo find $U_{\\mathrm{flat}}(z_{h})$ without explicitly calculating the intermediate parameter $u_{*}$, we can take the ratio of these two equations:\n$$\n\\frac{U_{\\mathrm{flat}}(z_{h})}{U_{\\mathrm{ref}}} = \\frac{\\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z_h}{z_0}\\right)}{\\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z_{\\mathrm{ref}}}{z_0}\\right)} = \\frac{\\ln\\left(z_h / z_0\\right)}{\\ln\\left(z_{\\mathrm{ref}} / z_0\\right)}\n$$\nFrom this, we can solve for $U_{\\mathrm{flat}}(z_{h})$:\n$$\nU_{\\mathrm{flat}}(z_{h}) = U_{\\mathrm{ref}} \\frac{\\ln\\left(z_{h} / z_0\\right)}{\\ln\\left(z_{\\mathrm{ref}} / z_0\\right)}\n$$\nNow we substitute the given numerical values: $U_{\\mathrm{ref}} = 7.50~\\mathrm{m}\\,\\mathrm{s}^{-1}$, $z_{\\mathrm{ref}} = 10~\\mathrm{m}$, $z_{h} = 120~\\mathrm{m}$, and $z_{0} = 0.050~\\mathrm{m}$.\n$$\n\\frac{z_{h}}{z_{0}} = \\frac{120}{0.050} = 2400\n$$\n$$\n\\frac{z_{\\mathrm{ref}}}{z_{0}} = \\frac{10}{0.050} = 200\n$$\nSubstituting these into the equation for $U_{\\mathrm{flat}}(z_h)$:\n$$\nU_{\\mathrm{flat}}(z_{h}) = 7.50 \\times \\frac{\\ln(2400)}{\\ln(200)} \\approx 7.50 \\times \\frac{7.78322}{5.29832} \\approx 7.50 \\times 1.46898 \\approx 11.01735~\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nNext, we calculate the fractional speed-up, $S$, due to the ridge. The model is given as $S = c\\,\\frac{H}{L}$. We substitute the values $c = 2.0$, $H = 40.0~\\mathrm{m}$, and $L = 400.0~\\mathrm{m}$:\n$$\nS = 2.0 \\times \\frac{40.0}{400.0} = 2.0 \\times 0.1 = 0.2\n$$\nThe problem states that the hub-height wind speed at the ridge crest, $U_{\\mathrm{crest}}(z_{h})$, is given by the formula $U_{\\mathrm{crest}}(z_{h}) = U_{\\mathrm{flat}}(z_{h})\\,(1+S)$.\nWe use the value of $U_{\\mathrm{flat}}(z_{h})$ and $S$ we have just calculated:\n$$\nU_{\\mathrm{crest}}(z_{h}) = 11.01735 \\times (1 + 0.2) = 11.01735 \\times 1.2\n$$\n$$\nU_{\\mathrm{crest}}(z_{h}) \\approx 13.22082~\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nU_{\\mathrm{crest}}(z_{h}) \\approx 13.22~\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{13.22}\n$$"
        },
        {
            "introduction": "Moving from the resource to the system, this exercise explores the collective impact of variable generation on the power grid. You will construct a model to generate synthetic but representative time series for electricity demand and VRE production, allowing you to analyze the resulting \"net load\" that dispatchable generators must serve. By quantifying key metrics like peak net load and ramp rates under various VRE penetration levels, you will gain direct insight into the flexibility challenges that arise as grids transition toward higher shares of renewables .",
            "id": "4134860",
            "problem": "Consider a single-zone power system with an hourly time index $t \\in \\{0,1,\\dots,T-1\\}$ where $T = 168$ hours (one week). Define the net load as $L_{\\text{net}}(t) = L(t) - G_{\\text{VRE}}(t)$, where $L(t)$ is the total load and $G_{\\text{VRE}}(t)$ is the generation from variable renewable energy (VRE). Assume the following modeling framework, which must be implemented exactly as stated.\n\nFundamental base and definitions:\n- Energy balance definition: for each hour $t$, the net load $L_{\\text{net}}(t)$ equals the total load $L(t)$ minus the VRE generation $G_{\\text{VRE}}(t)$.\n- VRE generation model: $G_{\\text{VRE}}(t) = C \\cdot \\text{CF}(t)$, where $C$ is the installed VRE capacity (in megawatts) and $\\text{CF}(t)$ is the VRE capacity factor (dimensionless), with $0 \\le \\text{CF}(t) \\le 1$.\n- Penetration definition: The energy penetration level $p$ is defined as the ratio of average VRE generation to average load over the horizon, i.e., $p = \\dfrac{\\frac{1}{T}\\sum_{t=0}^{T-1} G_{\\text{VRE}}(t)}{\\frac{1}{T}\\sum_{t=0}^{T-1} L(t)}$. Under the model $G_{\\text{VRE}}(t) = C \\cdot \\text{CF}(t)$, this implies $C = p \\cdot \\dfrac{\\frac{1}{T}\\sum_{t=0}^{T-1} L(t)}{\\frac{1}{T}\\sum_{t=0}^{T-1} \\text{CF}(t)}$.\n- Ramp definition: For an hourly time step $\\Delta t = 1$ hour, the net-load ramp is $R(t) = L_{\\text{net}}(t) - L_{\\text{net}}(t-1)$ for $t \\in \\{1,2,\\dots,T-1\\}$.\n\nTrigonometric conventions: All trigonometric arguments are in radians.\n\nSynthetic load and capacity factor:\n- Let the load $L(t)$ in megawatts be given by\n$$\nL(t) = L_0 + A_d \\sin\\!\\left(2\\pi \\frac{t}{24} - \\phi_d\\right) + A_w \\sin\\!\\left(2\\pi \\frac{t}{168} - \\phi_w\\right) + A_f \\sin\\!\\left(2\\pi \\frac{t}{8}\\right),\n$$\nwith $L_0 = 1000$, $A_d = 150$, $A_w = 100$, $\\phi_d = \\frac{\\pi}{3}$, $\\phi_w = \\frac{\\pi}{4}$, and $A_f = 50$.\n- Let the capacity factor $\\text{CF}(t)$ be a convex combination of a solar-like and wind-like component:\n    - Define the hour-of-day $h(t) = t \\bmod 24$. The solar component is\n    $$\n    \\text{CF}_{\\text{solar}}(t) = \\left[\\max\\!\\left(0, \\sin\\!\\left(\\pi \\frac{h(t)}{24}\\right)\\right)\\right]^{\\alpha},\n    $$\n    with $\\alpha = 1.5$.\n    - The wind component is\n    $$\n    \\text{CF}_{\\text{wind}}(t) = \\operatorname{clip}\\!\\left(0.4 + 0.2 \\sin\\!\\left(2\\pi \\cdot 0.7 \\cdot \\frac{t}{24} + \\frac{\\pi}{6}\\right) + 0.1 \\sin\\!\\left(2\\pi \\frac{t}{168} + \\frac{\\pi}{5}\\right),\\, 0,\\, 1\\right),\n    $$\n    where $\\operatorname{clip}(x,a,b)$ returns $a$ if $xa$, $b$ if $xb$, and $x$ otherwise.\n    - Combine them as\n    $$\n    \\text{CF}(t) = \\operatorname{clip}\\!\\left(0.6 \\cdot \\text{CF}_{\\text{solar}}(t) + 0.4 \\cdot \\text{CF}_{\\text{wind}}(t),\\, 0,\\, 1\\right).\n    $$\n\nStatistical properties to compute for each penetration level $p$:\n- Compute $C$ from the penetration definition, then $G_{\\text{VRE}}(t) = C \\cdot \\text{CF}(t)$ and $L_{\\text{net}}(t)$.\n- Compute the following quantities:\n    1. The maximum net load $\\max_t L_{\\text{net}}(t)$ in megawatts.\n    2. The minimum net load $\\min_t L_{\\text{net}}(t)$ in megawatts.\n    3. The time index $t_{\\max}$ at which $\\max_t L_{\\text{net}}(t)$ first occurs (an integer in $\\{0,1,\\dots,167\\}$).\n    4. The time index $t_{\\min}$ at which $\\min_t L_{\\text{net}}(t)$ first occurs (an integer in $\\{0,1,\\dots,167\\}$).\n    5. The maximum up-ramp $\\max_{t \\in \\{1,\\dots,167\\}} R(t)$ in megawatts per hour.\n    6. The maximum down-ramp $\\min_{t \\in \\{1,\\dots,167\\}} R(t)$ in megawatts per hour.\n    7. The standard deviation of the ramp series $R(t)$ treated as a population, i.e.,\n    $$\n    \\sigma_R = \\sqrt{\\frac{1}{T-1} \\sum_{t=1}^{T-1} \\left(R(t) - \\bar{R}\\right)^2}, \\quad \\bar{R} = \\frac{1}{T-1}\\sum_{t=1}^{T-1} R(t).\n    $$\n    8. The empirical $q$-quantile of the absolute ramp $|R(t)|$ at $q = 0.99$, defined by the following interpolation rule: Let $n = T-1$ and let $v_0 \\le v_1 \\le \\dots \\le v_{n-1}$ be the sorted values of $\\{|R(t)|\\,:\\, t=1,\\dots,T-1\\}$. Define $h = (n-1)q$, $j = \\lfloor h \\rfloor$, and $\\gamma = h - j$. Then the quantile is\n    $$\n    Q_q = \n    \\begin{cases}\n    v_j,  \\text{if } j = n-1,\\\\\n    (1-\\gamma)\\, v_j + \\gamma\\, v_{j+1},  \\text{otherwise.}\n    \\end{cases}\n    $$\n\nUnits and numerical requirements:\n- Express all net-load levels in megawatts (MW).\n- Express all ramp values in megawatts per hour (MW/h).\n- The time indices $t_{\\max}$ and $t_{\\min}$ are unitless integers (hours since $t=0$).\n- Round all reported real-valued outputs to three decimal places.\n- Angles in trigonometric functions are in radians.\n\nTest suite (penetration levels $p$ as decimals):\n- Case $1$: $p = 0.0$.\n- Case $2$: $p = 0.2$.\n- Case $3$: $p = 0.9$.\n- Case $4$: $p = 1.2$.\n\nProgram output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list with the eight values in the exact order specified above: $[\\max L_{\\text{net}}, \\min L_{\\text{net}}, t_{\\max}, t_{\\min}, \\max R, \\min R, \\sigma_R, Q_{0.99}]$. Aggregate the four per-case lists into an outer list so the final output is a single line of the form\n$[[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot]]$,\nwith all real numbers rounded to three decimals. No other text should be printed.",
            "solution": "The problem presented is a valid computational exercise in energy systems modeling. It is scientifically grounded, well-posed, and all definitions and parameters are provided for a unique, verifiable solution. The task is to analyze the statistical properties of a power system's net load under various penetration levels of variable renewable energy (VRE).\n\nThe solution proceeds by first constructing synthetic time series for electricity load and VRE capacity factor, then calculating the required VRE capacity to meet a specified energy penetration level, and finally computing a suite of metrics that characterize the resulting net load profile.\n\nThe fundamental quantities are defined over a discrete time horizon of $T=168$ hours (one week), with a time index $t \\in \\{0, 1, \\dots, T-1\\}$.\n\n**Step 1: Generation of Load and VRE Capacity Factor Profiles**\n\nFirst, we generate the time series for the system load, $L(t)$, and the VRE capacity factor, $\\text{CF}(t)$. These are synthetic profiles designed to capture the essential characteristics of real-world data.\n\nThe load $L(t)$ is modeled as a superposition of sinusoidal functions:\n$$\nL(t) = L_0 + A_d \\sin\\!\\left(2\\pi \\frac{t}{24} - \\phi_d\\right) + A_w \\sin\\!\\left(2\\pi \\frac{t}{168} - \\phi_w\\right) + A_f \\sin\\!\\left(2\\pi \\frac{t}{8}\\right)\n$$\nwhere $L_0 = 1000$ MW is the base load. The sinusoidal terms represent:\n- A diurnal (daily) cycle with period $24$ hours and amplitude $A_d = 150$ MW. The phase shift is $\\phi_d = \\pi/3$.\n- A weekly cycle with period $168$ hours and amplitude $A_w = 100$ MW. The phase shift is $\\phi_w = \\pi/4$.\n- A higher-frequency fluctuation with period $8$ hours and amplitude $A_f = 50$ MW, representing faster load variations.\n\nThe VRE capacity factor, $\\text{CF}(t)$, is a weighted average of solar and wind components, reflecting a mixed renewable portfolio. The hour of the day is $h(t) = t \\bmod 24$.\n\nThe solar component, $\\text{CF}_{\\text{solar}}(t)$, is modeled to be active during daylight hours, peaking at midday:\n$$\n\\text{CF}_{\\text{solar}}(t) = \\left[\\max\\!\\left(0, \\sin\\!\\left(\\pi \\frac{h(t)}{24}\\right)\\right)\\right]^{\\alpha}\n$$\nwith exponent $\\alpha = 1.5$. The sine function with argument $\\pi h(t)/24$ creates a half-wave over a $24$-hour period, mimicking the daily solar irradiance pattern. The $\\max(0, \\dots)$ ensures non-negativity, though it is redundant for $h(t) \\in [0, 23]$.\n\nThe wind component, $\\text{CF}_{\\text{wind}}(t)$, is a sum of sinusoids with different frequencies, capturing the multi-scale temporal variability of wind resources:\n$$\n\\text{CF}_{\\text{wind}}(t) = \\operatorname{clip}\\!\\left(0.4 + 0.2 \\sin\\!\\left(2\\pi \\cdot 0.7 \\cdot \\frac{t}{24} + \\frac{\\pi}{6}\\right) + 0.1 \\sin\\!\\left(2\\pi \\frac{t}{168} + \\frac{\\pi}{5}\\right),\\, 0,\\, 1\\right)\n$$\nThe $\\operatorname{clip}(x, a, b)$ function ensures the capacity factor remains within its physical bounds of $[0, 1]$.\n\nThe final capacity factor is a convex combination, clipped to $[0, 1]$:\n$$\n\\text{CF}(t) = \\operatorname{clip}\\!\\left(0.6 \\cdot \\text{CF}_{\\text{solar}}(t) + 0.4 \\cdot \\text{CF}_{\\text{wind}}(t),\\, 0,\\, 1\\right)\n$$\n\n**Step 2: Calculation of VRE Capacity and Net Load**\n\nFor a given energy penetration level $p$, we determine the necessary installed VRE capacity $C$. The penetration $p$ is the ratio of average VRE generation to average load:\n$$\np = \\frac{\\bar{G}_{\\text{VRE}}}{\\bar{L}} = \\frac{\\frac{1}{T}\\sum_{t=0}^{T-1} C \\cdot \\text{CF}(t)}{\\frac{1}{T}\\sum_{t=0}^{T-1} L(t)} = C \\frac{\\overline{\\text{CF}}}{\\bar{L}}\n$$\nSolving for $C$ gives:\n$$\nC = p \\cdot \\frac{\\bar{L}}{\\overline{\\text{CF}}} = p \\cdot \\frac{\\sum_{t=0}^{T-1} L(t)}{\\sum_{t=0}^{T-1} \\text{CF}(t)}\n$$\nThis establishes a direct relationship between the desired energy contribution from VRE and the required installed capacity, mediated by the average productivity of the resource ($\\overline{\\text{CF}}$) relative to the average demand ($\\bar{L}$).\n\nOnce $C$ is known for a given $p$, the VRE generation time series is $G_{\\text{VRE}}(t) = C \\cdot \\text{CF}(t)$. The net load, which is the load that must be met by dispatchable power plants, is then:\n$$\nL_{\\text{net}}(t) = L(t) - G_{\\text{VRE}}(t)\n$$\n\n**Step 3: Calculation of Ramps and Statistical Metrics**\n\nThe variability of the net load is a critical concern for power system operators. We quantify this using several metrics. First, we compute the net-load ramp series, which represents the change in net load from one hour to the next:\n$$\nR(t) = L_{\\text{net}}(t) - L_{\\text{net}}(t-1) \\quad \\text{for } t \\in \\{1, 2, \\dots, T-1\\}\n$$\nThe ramp series has $T-1 = 167$ data points.\n\nUsing the $L_{\\text{net}}(t)$ and $R(t)$ time series, we compute the eight specified statistical properties for each test case value of $p$:\n1.  **Maximum Net Load**: $\\max_t L_{\\text{net}}(t)$. This determines the peak capacity required from dispatchable generators.\n2.  **Minimum Net Load**: $\\min_t L_{\\text{net}}(t)$. A very low or negative minimum net load indicates periods of VRE over-generation.\n3.  **Time of Maximum Net Load**: $t_{\\max} = \\arg\\max_t L_{\\text{net}}(t)$, taking the first index in case of ties.\n4.  **Time of Minimum Net Load**: $t_{\\min} = \\arg\\min_t L_{\\text{net}}(t)$, taking the first index in case of ties.\n5.  **Maximum Up-Ramp**: $\\max_t R(t)$. This is the fastest required increase in dispatchable generation, a key measure of system flexibility needs.\n6.  **Maximum Down-Ramp**: $\\min_t R(t)$. This is the fastest required decrease in dispatchable generation.\n7.  **Ramp Standard Deviation**: $\\sigma_R$. This is computed as the population standard deviation of the ramp series $\\{R(t)\\}_{t=1}^{T-1}$. The provided formula is $\\sigma_R = \\sqrt{\\frac{1}{T-1} \\sum_{t=1}^{T-1} (R(t) - \\bar{R})^2}$, which corresponds to the standard deviation of the population of $T-1$ ramp values.\n8.  **99th Percentile of Absolute Ramp**: $Q_{0.99}$ of $\\{|R(t)|\\}$. Extreme ramps are often more important than average variability. This quantile is calculated using the specified linear interpolation method, which corresponds to the `linear` method in the NumPy library.\n\nThese calculations are repeated for each specified penetration level $p \\in \\{0.0, 0.2, 0.9, 1.2\\}$, and the results are aggregated and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the energy systems modeling problem by calculating net load statistics\n    for different VRE penetration levels.\n    \"\"\"\n    \n    # Define constants and parameters from the problem statement\n    T = 168\n    L0 = 1000.0\n    Ad = 150.0\n    Aw = 100.0\n    Af = 50.0\n    phi_d = np.pi / 3.0\n    phi_w = np.pi / 4.0\n    alpha = 1.5\n    \n    # Time vector\n    t = np.arange(T, dtype=float)\n    \n    # --- Step 1: Generate Load and VRE Capacity Factor Profiles ---\n    \n    # Load profile L(t)\n    L_t = (L0 +\n           Ad * np.sin(2 * np.pi * t / 24.0 - phi_d) +\n           Aw * np.sin(2 * np.pi * t / 168.0 - phi_w) +\n           Af * np.sin(2 * np.pi * t / 8.0))\n    \n    # Hour of day h(t)\n    h_t = t % 24\n    \n    # Solar capacity factor CF_solar(t)\n    # The max(0, sin) is redundant as sin(pi*h/24) is non-negative for h in [0, 23]\n    CF_solar_t = np.sin(np.pi * h_t / 24.0)**alpha\n    \n    # Wind capacity factor CF_wind(t)\n    CF_wind_t = np.clip(\n        0.4 + 0.2 * np.sin(2 * np.pi * 0.7 * t / 24.0 + np.pi / 6.0) +\n        0.1 * np.sin(2 * np.pi * t / 168.0 + np.pi / 5.0),\n        0.0, 1.0\n    )\n    \n    # Combined capacity factor CF(t)\n    CF_t = np.clip(0.6 * CF_solar_t + 0.4 * CF_wind_t, 0.0, 1.0)\n    \n    # Pre-calculate averages needed for C\n    avg_L = np.mean(L_t)\n    avg_CF = np.mean(CF_t)\n\n    def calculate_metrics(p):\n        \"\"\"\n        Calculates the 8 specified metrics for a given penetration level p.\n        \"\"\"\n        # --- Step 2: Calculate VRE Capacity and Net Load ---\n        \n        # Calculate installed VRE capacity C\n        if avg_CF == 0:\n            C = 0.0\n        else:\n            C = p * avg_L / avg_CF\n            \n        # VRE generation G_VRE(t)\n        G_vre_t = C * CF_t\n        \n        # Net load L_net(t)\n        L_net_t = L_t - G_vre_t\n        \n        # --- Step 3: Calculation of Ramps and Statistical Metrics ---\n\n        # Ramp series R(t)\n        R_t = L_net_t[1:] - L_net_t[:-1]\n        \n        # 1. Max net load\n        max_L_net = np.max(L_net_t)\n        \n        # 2. Min net load\n        min_L_net = np.min(L_net_t)\n        \n        # 3. Time of max net load (first occurrence)\n        t_max = np.argmax(L_net_t)\n        \n        # 4. Time of min net load (first occurrence)\n        t_min = np.argmin(L_net_t)\n\n        # 5. Max up-ramp\n        max_R = np.max(R_t)\n        \n        # 6. Max down-ramp\n        min_R = np.min(R_t)\n        \n        # 7. Standard deviation of the ramp series\n        # The formula given is the population std dev of the ramp series,\n        # which has T-1 elements. numpy.std(ddof=0) divides by N, correct.\n        sigma_R = np.std(R_t, ddof=0)\n        \n        # 8. 99% quantile of absolute ramp\n        abs_R_t = np.abs(R_t)\n        # The specified interpolation rule matches numpy's 'linear' method.\n        Q_0_99 = np.quantile(abs_R_t, 0.99, method='linear')\n        \n        return [max_L_net, min_L_net, t_max, t_min, max_R, min_R, sigma_R, Q_0_99]\n\n    # Test suite of penetration levels\n    test_cases = [0.0, 0.2, 0.9, 1.2]\n    \n    all_results = []\n    for p_val in test_cases:\n        results = calculate_metrics(p_val)\n        all_results.append(results)\n\n    # Format the output string as specified\n    formatted_results = []\n    for case_result in all_results:\n        # Round floats to 3 decimal places, keep integers as is\n        formatted_list = [\n            f\"{val:.3f}\" if isinstance(val, (float, np.floating)) else str(val)\n            for val in case_result\n        ]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    # Final print statement\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After analyzing the challenges of VRE integration, this final practice focuses on engineering a solution. You will formulate and solve a mixed-integer linear optimization problem to determine the optimal dispatch strategy for a hybrid power plant, which combines solar, wind, and energy storage. The goal is to meet a firm power delivery commitment, demonstrating how energy storage can be actively managed to mitigate variability and transform intermittent resources into a reliable, dispatchable asset .",
            "id": "4134839",
            "problem": "Consider a hybrid plant composed of photovoltaic generation and wind generation with an electrochemical energy storage system. Let the time horizon be discretized into $T$ hourly intervals, with $\\Delta t = 1$ hour. The photovoltaic available power profile is given by an array of length $T$, each element expressed in $\\mathrm{MW}$. The wind available power profile is given by an array of length $T$, each element expressed in $\\mathrm{MW}$. The firm power obligation is an array of length $T$, each element expressed in $\\mathrm{MW}$. The energy storage has a maximum energy capacity expressed in $\\mathrm{MWh}$, a maximum charge power expressed in $\\mathrm{MW}$, a maximum discharge power expressed in $\\mathrm{MW}$, a charge efficiency (dimensionless), and a discharge efficiency (dimensionless). The state of charge initial condition is expressed in $\\mathrm{MWh}$ and the state of charge is required to return to the same value at the end of the horizon.\n\nStarting only from fundamental conservation principles and core operational definitions suitable for energy systems modeling, derive a mixed-integer linear optimization model to schedule the photovoltaic generation, wind generation, and storage charging and discharging such that the firm power obligation is met whenever physically feasible under the given variability. The derivation must begin from:\n\n- Conservation of energy for the storage across discrete time steps.\n- Power balance at each time step linking net power to the grid and the firm obligation.\n- Physical limits for power and energy capacities for all components.\n- Binary commitment decisions that enforce non-simultaneous charging and discharging of the storage.\n\nYour derivation must produce a formulation that is amenable to Mixed-Integer Linear Programming, where charging and discharging decisions are binary and all other decision variables are continuous. The objective should be to minimize the total unmet firm power across the horizon while respecting all physical constraints. The unmet firm power at each time step must be a nonnegative slack variable (dimensionless number in $\\mathrm{MW}$) whose sum is minimized. For numerical robustness, the feasibility evaluation should accept solutions with a negligible total unmet firm power, defined by a tolerance threshold much smaller than typical $\\mathrm{MW}$ values.\n\nYou must implement a program that solves the derived mixed-integer linear optimization for a set of test cases below using a general-purpose solver and returns feasibility for each case. A case is deemed feasible if and only if the optimal total unmet firm power is equal to $0$ within a small numerical tolerance.\n\nPhysical units required:\n- All power quantities, including photovoltaic available power, wind available power, charge power, discharge power, firm obligation, and unmet firm power, must be in $\\mathrm{MW}$.\n- All energy quantities, including storage energy capacity and state of charge, must be in $\\mathrm{MWh}$.\n- All angle quantities do not appear in this problem.\n- Any ratio must be reported as a decimal.\n\nTest suite to implement:\n- Case $1$ (general happy path): $T = 6$. Photovoltaic available power [3.0, 2.0, 1.0, 0.5, 1.5, 2.0] in $\\mathrm{MW}$. Wind available power [1.0, 1.5, 2.0, 1.2, 0.8, 1.5] in $\\mathrm{MW}$. Firm obligation [2.0, 2.0, 2.0, 2.0, 2.0, 2.0] in $\\mathrm{MW}$. Storage parameters: maximum energy 1.0 $\\mathrm{MWh}$, initial state of charge 0.5 $\\mathrm{MWh}$, maximum charge power 1.5 $\\mathrm{MW}$, maximum discharge power 1.5 $\\mathrm{MW}$, charge efficiency 0.95, discharge efficiency 0.95.\n- Case $2$ (global energy deficit): $T = 4$. Photovoltaic available power [0.2, 0.2, 0.2, 0.2] in $\\mathrm{MW}$. Wind available power [0.1, 0.1, 0.1, 0.1] in $\\mathrm{MW}$. Firm obligation [0.5, 0.5, 0.5, 0.5] in $\\mathrm{MW}$. Storage parameters: maximum energy 10.0 $\\mathrm{MWh}$, initial state of charge 0.0 $\\mathrm{MWh}$, maximum charge power 5.0 $\\mathrm{MW}$, maximum discharge power 5.0 $\\mathrm{MW}$, charge efficiency 0.95, discharge efficiency 0.95.\n- Case $3$ (single trough with variability and exact energy sizing): $T = 5$. Photovoltaic available power [2.5, 2.2, 0.2, 2.1, 2.3] in $\\mathrm{MW}$. Wind available power [0.3, 0.5, 0.3, 0.2, 0.3] in $\\mathrm{MW}$. Firm obligation [2.0, 2.0, 1.4, 2.0, 2.0] in $\\mathrm{MW}$. Storage parameters: maximum energy 1.6 $\\mathrm{MWh}$, initial state of charge 0.0 $\\mathrm{MWh}$, maximum charge power 1.5 $\\mathrm{MW}$, maximum discharge power 1.5 $\\mathrm{MW}$, charge efficiency 0.95, discharge efficiency 0.95.\n- Case $4$ (power-limited infeasibility at trough): $T = 3$. Photovoltaic available power [3.0, 1.0, 3.0] in $\\mathrm{MW}$. Wind available power [0.0, 0.0, 0.0] in $\\mathrm{MW}$. Firm obligation [2.5, 2.5, 2.5] in $\\mathrm{MW}$. Storage parameters: maximum energy 10.0 $\\mathrm{MWh}$, initial state of charge 0.0 $\\mathrm{MWh}$, maximum charge power 3.0 $\\mathrm{MW}$, maximum discharge power 1.0 $\\mathrm{MW}$, charge efficiency 0.95, discharge efficiency 0.95.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{False}]$), where each entry is a boolean that is $\\mathrm{True}$ if the case is feasible in the sense defined above and $\\mathrm{False}$ otherwise. The boolean values must be printed exactly as Python boolean literals without additional text.",
            "solution": "We begin with core definitions and fundamental laws underpinning energy systems modeling. Over discrete hourly intervals, we use conservation of energy and operational bounds to derive a Mixed-Integer Linear Programming problem that decides how to schedule photovoltaic generation, wind generation, and storage to meet a firm power obligation.\n\nDefine the following decision variables for each time $t \\in \\{0,1,\\dots,T-1\\}$:\n- $p^{\\mathrm{pv}}_t \\ge 0$ is the photovoltaic power dispatched to the grid, in $\\mathrm{MW}$.\n- $p^{\\mathrm{w}}_t \\ge 0$ is the wind power dispatched to the grid, in $\\mathrm{MW}$.\n- $p^{\\mathrm{ch}}_t \\ge 0$ is the storage charge power, in $\\mathrm{MW}$.\n- $p^{\\mathrm{dis}}_t \\ge 0$ is the storage discharge power, in $\\mathrm{MW}$.\n- $u^{\\mathrm{ch}}_t \\in \\{0,1\\}$ is the binary charge decision indicating whether charging is active.\n- $u^{\\mathrm{dis}}_t \\in \\{0,1\\}$ is the binary discharge decision indicating whether discharging is active.\n- $r_t \\ge 0$ is the unmet firm power (slack), in $\\mathrm{MW}$.\nDefine the state of charge for the storage $s_t$ in $\\mathrm{MWh}$ for $t \\in \\{0,1,\\dots,T\\}$, with initial condition $s_0$ given and terminal condition $s_T = s_0$.\n\nThe physical and operational parameters are:\n- Photovoltaic available power profile $a^{\\mathrm{pv}}_t$ in $\\mathrm{MW}$.\n- Wind available power profile $a^{\\mathrm{w}}_t$ in $\\mathrm{MW}$.\n- Firm obligation $P^{\\mathrm{firm}}_t$ in $\\mathrm{MW}$.\n- Maximum storage energy $E^{\\mathrm{max}}$ in $\\mathrm{MWh}$.\n- Maximum charge power $P^{\\mathrm{ch,max}}$ in $\\mathrm{MW}$.\n- Maximum discharge power $P^{\\mathrm{dis,max}}$ in $\\mathrm{MW}$.\n- Charge efficiency $\\eta^{\\mathrm{ch}} \\in (0,1]$ (dimensionless).\n- Discharge efficiency $\\eta^{\\mathrm{dis}} \\in (0,1]$ (dimensionless).\nWe take $\\Delta t = 1$ hour, so energy and power are directly comparable at each time step.\n\nFrom conservation of energy for the storage over one step, the change in stored energy equals the net input to storage minus losses. Charging at power $p^{\\mathrm{ch}}_t$ for $\\Delta t = 1$ hour increases stored energy by $\\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t$, while discharging at power $p^{\\mathrm{dis}}_t$ reduces stored energy by $\\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t$. Hence, for each $t \\in \\{0,\\dots,T-1\\}$,\n$$\ns_{t+1} = s_t + \\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t - \\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t.\n$$\nOperational bounds enforce $0 \\le s_t \\le E^{\\mathrm{max}}$ for all $t$.\n\nFor the net power balance to the grid, at each time $t$, the grid receives the sum of dispatched generation plus storage discharge, reduced by any power diverted to charge the storage. To ensure satisfaction of the firm obligation when possible, we introduce a nonnegative slack $r_t$ for unmet firm power. Thus the net power balance must satisfy\n$$\np^{\\mathrm{pv}}_t + p^{\\mathrm{w}}_t + p^{\\mathrm{dis}}_t - p^{\\mathrm{ch}}_t + r_t \\ge P^{\\mathrm{firm}}_t.\n$$\nThe physical limits on generation imply\n$$\n0 \\le p^{\\mathrm{pv}}_t \\le a^{\\mathrm{pv}}_t, \\quad 0 \\le p^{\\mathrm{w}}_t \\le a^{\\mathrm{w}}_t.\n$$\nThe power limits for storage are\n$$\n0 \\le p^{\\mathrm{ch}}_t \\le P^{\\mathrm{ch,max}}, \\quad 0 \\le p^{\\mathrm{dis}}_t \\le P^{\\mathrm{dis,max}}.\n$$\nTo enforce non-simultaneous charging and discharging in a linear manner, we use binary decisions and big-$M$ type linking constraints:\n$$\np^{\\mathrm{ch}}_t \\le P^{\\mathrm{ch,max}} u^{\\mathrm{ch}}_t, \\quad p^{\\mathrm{dis}}_t \\le P^{\\mathrm{dis,max}} u^{\\mathrm{dis}}_t, \\quad u^{\\mathrm{ch}}_t + u^{\\mathrm{dis}}_t \\le 1.\n$$\nThe terminal condition $s_T = s_0$ enforces cyclic operation over the horizon.\n\nThe objective is to minimize total unmet firm power:\n$$\n\\min \\sum_{t=0}^{T-1} r_t.\n$$\nAll constraints are linear, and only $u^{\\mathrm{ch}}_t$ and $u^{\\mathrm{dis}}_t$ are binary, so the problem is a Mixed-Integer Linear Programming problem.\n\nAlgorithmic design:\n- Construct a decision vector stacking $p^{\\mathrm{pv}}_t$, $p^{\\mathrm{w}}_t$, $p^{\\mathrm{ch}}_t$, $p^{\\mathrm{dis}}_t$, $s_t$ for $t=0,\\dots,T$, $u^{\\mathrm{ch}}_t$, $u^{\\mathrm{dis}}_t$, and $r_t$.\n- Set variable bounds using available generation limits, storage energy capacity, and storage power limits. Set binary bounds $0 \\le u^{\\mathrm{ch}}_t \\le 1$ and $0 \\le u^{\\mathrm{dis}}_t \\le 1$, and nonnegative bounds $r_t \\ge 0$ with a reasonable upper bound for numerical stability.\n- Build Linear Constraints:\n  - Storage dynamics equalities $s_{t+1} - s_t - \\eta^{\\mathrm{ch}} p^{\\mathrm{ch}}_t + \\frac{1}{\\eta^{\\mathrm{dis}}} p^{\\mathrm{dis}}_t = 0$ for all $t$.\n  - Initial and terminal state of charge equalities $s_0 = \\text{given}$ and $s_T = s_0$.\n  - Big-$M$ linking $p^{\\mathrm{ch}}_t - P^{\\mathrm{ch,max}} u^{\\mathrm{ch}}_t \\le 0$ and $p^{\\mathrm{dis}}_t - P^{\\mathrm{dis,max}} u^{\\mathrm{dis}}_t \\le 0$, and $u^{\\mathrm{ch}}_t + u^{\\mathrm{dis}}_t \\le 1$.\n  - Power balance inequalities $p^{\\mathrm{pv}}_t + p^{\\mathrm{w}}_t + p^{\\mathrm{dis}}_t - p^{\\mathrm{ch}}_t + r_t \\ge P^{\\mathrm{firm}}_t$.\n- Use a Mixed-Integer Linear Programming solver to minimize $\\sum_t r_t$. A solution is considered feasible for the firm obligation if the optimal $\\sum_t r_t$ is zero within a small tolerance (for example, less than $10^{-6}$ $\\mathrm{MW}$-hours, matching units over $\\Delta t = 1$ hour).\n\nFeasibility evaluation under variability:\n- Case $1$ has sufficient generation and storage to bridge a short trough; the model should find schedules that meet the firm obligation with $\\sum_t r_t$ near $0$.\n- Case $2$ has a global energy deficit; storage cannot create energy, so $\\sum_t r_t$ must be strictly positive.\n- Case $3$ requires charging in early periods to cover a single trough with realistic efficiencies; parameters are chosen so charging suffices and $\\sum_t r_t \\approx 0$.\n- Case $4$ has adequate energy but insufficient discharge power during a deep trough, so $\\sum_t r_t$ remains positive due to the discharge rate constraint.\n\nThe program outputs a single line with a list of booleans, each indicating whether the corresponding test case is feasible under the optimal Mixed-Integer Linear Programming scheduling derived from first principles.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import milp, LinearConstraint, Bounds\n\ndef solve_case(pv_avail, wind_avail, firm, E_max, s_init, P_ch_max, P_dis_max, eta_ch, eta_dis, tol=1e-6):\n    \"\"\"\n    Solve the MILP scheduling problem for a single case and return True if feasible (sum of slack ~ 0).\n    Parameters are arrays/lists for pv_avail, wind_avail, firm of length T.\n    \"\"\"\n    pv_avail = np.array(pv_avail, dtype=float)\n    wind_avail = np.array(wind_avail, dtype=float)\n    firm = np.array(firm, dtype=float)\n    T = len(pv_avail)\n\n    # Variable indexing\n    # Order: p_pv[0..T-1], p_w[0..T-1], p_ch[0..T-1], p_dis[0..T-1], s[0..T], u_ch[0..T-1], u_dis[0..T-1], r[0..T-1]\n    idx_pv_start = 0\n    idx_pv_end = idx_pv_start + T\n\n    idx_w_start = idx_pv_end\n    idx_w_end = idx_w_start + T\n\n    idx_ch_start = idx_w_end\n    idx_ch_end = idx_ch_start + T\n\n    idx_dis_start = idx_ch_end\n    idx_dis_end = idx_dis_start + T\n\n    idx_s_start = idx_dis_end\n    idx_s_end = idx_s_start + (T + 1)  # s_0 ... s_T\n\n    idx_uch_start = idx_s_end\n    idx_uch_end = idx_uch_start + T\n\n    idx_udis_start = idx_uch_end\n    idx_udis_end = idx_udis_start + T\n\n    idx_r_start = idx_udis_end\n    idx_r_end = idx_r_start + T\n\n    n_vars = idx_r_end\n\n    # Integrality: 0 for continuous, 1 for integer (binary handled via bounds [0,1])\n    integrality = np.zeros(n_vars, dtype=int)\n    integrality[idx_uch_start:idx_uch_end] = 1\n    integrality[idx_udis_start:idx_udis_end] = 1\n\n    # Variable bounds\n    lb = np.zeros(n_vars, dtype=float)\n    ub = np.full(n_vars, np.inf, dtype=float)\n\n    # p_pv bounds [0, pv_avail[t]]\n    lb[idx_pv_start:idx_pv_end] = 0.0\n    ub[idx_pv_start:idx_pv_end] = pv_avail\n\n    # p_w bounds [0, wind_avail[t]]\n    lb[idx_w_start:idx_w_end] = 0.0\n    ub[idx_w_start:idx_w_end] = wind_avail\n\n    # p_ch bounds [0, P_ch_max]\n    lb[idx_ch_start:idx_ch_end] = 0.0\n    ub[idx_ch_start:idx_ch_end] = P_ch_max\n\n    # p_dis bounds [0, P_dis_max]\n    lb[idx_dis_start:idx_dis_end] = 0.0\n    ub[idx_dis_start:idx_dis_end] = P_dis_max\n\n    # s bounds [0, E_max]\n    lb[idx_s_start:idx_s_end] = 0.0\n    ub[idx_s_start:idx_s_end] = E_max\n\n    # u_ch bounds [0,1]\n    lb[idx_uch_start:idx_uch_end] = 0.0\n    ub[idx_uch_start:idx_uch_end] = 1.0\n\n    # u_dis bounds [0,1]\n    lb[idx_udis_start:idx_udis_end] = 0.0\n    ub[idx_udis_start:idx_udis_end] = 1.0\n\n    # r bounds [0, R_max]; choose a reasonable big-M upper bound\n    R_max = max(1.0, float(np.max(firm)) * 2.0)\n    lb[idx_r_start:idx_r_end] = 0.0\n    ub[idx_r_start:idx_r_end] = R_max\n\n    bounds = Bounds(lb, ub)\n\n    constraints = []\n\n    # Storage dynamics: s[t+1] - s[t] - eta_ch * p_ch[t] + (1/eta_dis) * p_dis[t] = 0\n    for t in range(T):\n        row = np.zeros(n_vars, dtype=float)\n        row[idx_s_start + (t + 1)] = 1.0\n        row[idx_s_start + t] = -1.0\n        row[idx_ch_start + t] = -eta_ch\n        row[idx_dis_start + t] = 1.0 / eta_dis\n        constraints.append(LinearConstraint(row, 0.0, 0.0))\n\n    # Initial state of charge: s[0] = s_init\n    row = np.zeros(n_vars, dtype=float)\n    row[idx_s_start + 0] = 1.0\n    constraints.append(LinearConstraint(row, s_init, s_init))\n\n    # Terminal state of charge: s[T] = s_init\n    row = np.zeros(n_vars, dtype=float)\n    row[idx_s_start + T] = 1.0\n    constraints.append(LinearConstraint(row, s_init, s_init))\n\n    # Linking constraints: p_ch[t] - P_ch_max * u_ch[t] = 0, p_dis[t] - P_dis_max * u_dis[t] = 0\n    for t in range(T):\n        # Charge linking\n        row = np.zeros(n_vars, dtype=float)\n        row[idx_ch_start + t] = 1.0\n        row[idx_uch_start + t] = -P_ch_max\n        constraints.append(LinearConstraint(row, -np.inf, 0.0))\n\n        # Discharge linking\n        row = np.zeros(n_vars, dtype=float)\n        row[idx_dis_start + t] = 1.0\n        row[idx_udis_start + t] = -P_dis_max\n        constraints.append(LinearConstraint(row, -np.inf, 0.0))\n\n    # Non-simultaneity: u_ch[t] + u_dis[t] = 1\n    for t in range(T):\n        row = np.zeros(n_vars, dtype=float)\n        row[idx_uch_start + t] = 1.0\n        row[idx_udis_start + t] = 1.0\n        constraints.append(LinearConstraint(row, -np.inf, 1.0))\n\n    # Firm obligation: p_pv + p_w + p_dis - p_ch + r = firm\n    for t in range(T):\n        row = np.zeros(n_vars, dtype=float)\n        row[idx_pv_start + t] = 1.0\n        row[idx_w_start + t] = 1.0\n        row[idx_dis_start + t] = 1.0\n        row[idx_ch_start + t] = -1.0\n        row[idx_r_start + t] = 1.0\n        constraints.append(LinearConstraint(row, firm[t], np.inf))\n\n    # Objective: minimize sum of r_t\n    c = np.zeros(n_vars, dtype=float)\n    c[idx_r_start:idx_r_end] = 1.0\n\n    # Solve MILP\n    res = milp(c=c, constraints=constraints, integrality=integrality, bounds=bounds)\n\n    # Check feasibility: success and total unmet firm power ~ 0\n    feasible = bool(res.success)\n    if feasible:\n        x = res.x\n        total_unmet = float(np.sum(x[idx_r_start:idx_r_end]))\n        feasible = total_unmet = tol\n    return feasible\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path\n        {\n            \"pv\": [3.0, 2.0, 1.0, 0.5, 1.5, 2.0],\n            \"wind\": [1.0, 1.5, 2.0, 1.2, 0.8, 1.5],\n            \"firm\": [2.0, 2.0, 2.0, 2.0, 2.0, 2.0],\n            \"E_max\": 1.0,\n            \"s_init\": 0.5,\n            \"P_ch_max\": 1.5,\n            \"P_dis_max\": 1.5,\n            \"eta_ch\": 0.95,\n            \"eta_dis\": 0.95,\n        },\n        # Case 2: global energy deficit\n        {\n            \"pv\": [0.2, 0.2, 0.2, 0.2],\n            \"wind\": [0.1, 0.1, 0.1, 0.1],\n            \"firm\": [0.5, 0.5, 0.5, 0.5],\n            \"E_max\": 10.0,\n            \"s_init\": 0.0,\n            \"P_ch_max\": 5.0,\n            \"P_dis_max\": 5.0,\n            \"eta_ch\": 0.95,\n            \"eta_dis\": 0.95,\n        },\n        # Case 3: single trough with variability and exact energy sizing\n        {\n            \"pv\": [2.5, 2.2, 0.2, 2.1, 2.3],\n            \"wind\": [0.3, 0.5, 0.3, 0.2, 0.3],\n            \"firm\": [2.0, 2.0, 1.4, 2.0, 2.0],\n            \"E_max\": 1.6,\n            \"s_init\": 0.0,\n            \"P_ch_max\": 1.5,\n            \"P_dis_max\": 1.5,\n            \"eta_ch\": 0.95,\n            \"eta_dis\": 0.95,\n        },\n        # Case 4: power-limited infeasibility at trough\n        {\n            \"pv\": [3.0, 1.0, 3.0],\n            \"wind\": [0.0, 0.0, 0.0],\n            \"firm\": [2.5, 2.5, 2.5],\n            \"E_max\": 10.0,\n            \"s_init\": 0.0,\n            \"P_ch_max\": 3.0,\n            \"P_dis_max\": 1.0,\n            \"eta_ch\": 0.95,\n            \"eta_dis\": 0.95,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        feasible = solve_case(\n            pv_avail=case[\"pv\"],\n            wind_avail=case[\"wind\"],\n            firm=case[\"firm\"],\n            E_max=case[\"E_max\"],\n            s_init=case[\"s_init\"],\n            P_ch_max=case[\"P_ch_max\"],\n            P_dis_max=case[\"P_dis_max\"],\n            eta_ch=case[\"eta_ch\"],\n            eta_dis=case[\"eta_dis\"],\n        )\n        results.append(feasible)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}