{
    "hands_on_practices": [
        {
            "introduction": "Understanding the energy available to a hydropower turbine begins with a firm grasp of the steady mechanical energy balance. This first exercise grounds our study in fundamental fluid dynamics, challenging you to distinguish between the total available gravitational potential, or gross head, and the portion that remains after accounting for real-world hydraulic losses, the net head $H_{\\text{net}}$. Mastering this calculation is the essential first step before modeling the more complex dependencies of turbine efficiency. ",
            "id": "4094779",
            "problem": "A high-head hydropower facility draws water from a large reservoir and discharges into a tailrace channel. The free surface elevation of the reservoir is $250$ meters above a common datum, while the tailwater free surface elevation is $200$ meters above the datum. The conveyance system consists of a single penstock in which steady viscous friction losses amount to a head loss of $h_{f}=6$ meters and additional localized minor losses of $h_{m}=2$ meters. Assume single-phase, incompressible, steady flow of water. The reservoir and tailrace cross sections are sufficiently large that mean velocities at the free surfaces are negligible, and pressures at the free surfaces are both atmospheric. \n\nStarting from the steady mechanical energy balance for incompressible flow between the reservoir free surface and the tailwater free surface, with head extraction by a turbine and the total hydraulic losses accounted for, derive an expression for the net head available to the turbine, $H_{\\text{net}}$, in terms of the gross head and the hydraulic losses. Then evaluate $H_{\\text{net}}$ numerically for the given data. Additionally, compute the fraction of the gross head that is dissipated in the hydraulic losses of the conveyance system, expressed as a unitless decimal. \n\nExpress $H_{\\text{net}}$ in meters. Express the fraction as a decimal (not a percentage). Round both quantities to four significant figures.",
            "solution": "The appropriate starting point is the steady mechanical energy equation for an incompressible fluid flowing between two locations, incorporating turbine head removal and distributed plus minor losses. Consider the streamline from the reservoir free surface (location $1$) to the tailwater free surface (location $2$). The steady energy equation with head terms reads\n$$\nz_{1} + \\frac{p_{1}}{\\rho g} + \\frac{v_{1}^{2}}{2 g} \\;+\\; H_{\\text{pump}} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2} + \\frac{p_{2}}{\\rho g} + \\frac{v_{2}^{2}}{2 g},\n$$\nwhere $z$ is elevation head, $p$ is pressure, $\\rho$ is density, $g$ is gravitational acceleration, $v$ is mean velocity, $H_{\\text{pump}}$ is head added by a pump (zero here), $H_{\\text{turbine}}$ is head removed by the turbine, and $h_{L}$ is the total hydraulic loss (sum of frictional and minor losses) between locations $1$ and $2$. \n\nGiven the reservoir and tailwater free surfaces are both exposed to the atmosphere, we have $p_{1} = p_{2}$ equal to atmospheric pressure, so $\\frac{p_{1}}{\\rho g} = \\frac{p_{2}}{\\rho g}$. The cross sections at the free surfaces are large, so the velocities $v_{1}$ and $v_{2}$ are negligible, implying $\\frac{v_{1}^{2}}{2 g} \\approx 0$ and $\\frac{v_{2}^{2}}{2 g} \\approx 0$. There is no pump, so $H_{\\text{pump}} = 0$. Under these conditions the energy equation simplifies to\n$$\nz_{1} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2}.\n$$\nRearranging for the turbine head removal gives\n$$\nH_{\\text{turbine}} \\;=\\; z_{1} - z_{2} \\;-\\; h_{L}.\n$$\nThe term $z_{1} - z_{2}$ is the gross head, which we denote by $H_{\\text{gross}}$. Therefore,\n$$\nH_{\\text{turbine}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\nThe hydropower convention defines the net head available to the turbine, $H_{\\text{net}}$, as the head actually delivered across the turbine runner, which equals the turbine head removal derived above. Consequently,\n$$\nH_{\\text{net}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\n\nWe now evaluate $H_{\\text{gross}}$ and $h_{L}$ from the provided data. The gross head is the difference in free surface elevations,\n$$\nH_{\\text{gross}} \\;=\\; z_{1} - z_{2} \\;=\\; 250 - 200 \\;=\\; 50.\n$$\nThe total hydraulic loss is the sum of the friction loss and minor losses,\n$$\nh_{L} \\;=\\; h_{f} + h_{m} \\;=\\; 6 + 2 \\;=\\; 8.\n$$\nTherefore, the net head is\n$$\nH_{\\text{net}} \\;=\\; 50 - 8 \\;=\\; 42.\n$$\n\nThe fraction of the gross head dissipated in hydraulics is the ratio\n$$\n\\text{fraction lost} \\;=\\; \\frac{h_{L}}{H_{\\text{gross}}} \\;=\\; \\frac{8}{50} \\;=\\; 0.16.\n$$\n\nApplying the rounding instruction to four significant figures, we express $H_{\\text{net}}$ in meters and the fraction as a decimal:\n$$\nH_{\\text{net}} \\;=\\; 42.00 \\quad \\text{meters},\n$$\n$$\n\\text{fraction lost} \\;=\\; 0.1600.\n$$\nThese values satisfy the requested significant figures and unit specifications.",
            "answer": "$$\\boxed{\\begin{pmatrix} 42.00 & 0.1600 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Real-world hydropower systems are rarely static; reservoir levels, and especially tailwater elevations, fluctuate with discharge $Q$. This practice moves from a static snapshot to a dynamic system, exploring how these variations impact the available head over an operational period. You will derive the concept of an energy-weighted \"effective head,\" $H_{\\mathrm{eff}}$, a crucial technique in energy systems modeling for simplifying complex time-series data into a representative value for planning and analysis. ",
            "id": "4094777",
            "problem": "A run-of-river hydropower plant has an upstream pool large enough that the headwater elevation, denoted by $z_{\\mathrm{H}}$, may be treated as approximately constant over a day. The tailrace elevation $z_{\\mathrm{T}}$ is governed by a backwater rating curve and varies with discharge $Q$: as $Q$ moves between its daily low and high values, $z_{\\mathrm{T}}$ fluctuates by approximately $\\pm 1\\,\\mathrm{m}$ relative to a nominal reference. The gross head is $H_{\\mathrm{gross}}(t) = z_{\\mathrm{H}} - z_{\\mathrm{T}}(Q(t))$. Let hydraulic losses $h_{\\mathrm{L}}(Q)$ be an increasing function of $Q$, and define the net head as $H_{\\mathrm{net}}(t) = H_{\\mathrm{gross}}(t) - h_{\\mathrm{L}}(Q(t))$. Turbine-generator efficiency $\\eta(H_{\\mathrm{net}},Q)$ depends on $H_{\\mathrm{net}}$ and $Q$. Instantaneous electrical power is $P(t) = \\rho g\\, Q(t)\\, H_{\\mathrm{net}}(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$, where $\\rho$ is the water density and $g$ is gravitational acceleration. Over a day of duration $T$, operators wish to replace the time-varying head with a single “effective head” $H_{\\mathrm{eff}}$ for planning calculations, such that using $H_{\\mathrm{eff}}$ in a constant-head representation produces the same daily energy as the actual time-varying operation.\n\nWhich option best describes how the tailrace fluctuation affects $H_{\\mathrm{gross}}$ and how $H_{\\mathrm{eff}}$ should be operationally defined over a day?\n\nA. Because $z_{\\mathrm{H}}$ is approximately constant, $H_{\\mathrm{gross}}$ is constant, and $H_{\\mathrm{eff}}$ should be the simple arithmetic mean of the maximum and minimum observed heads over the day.\n\nB. As $Q$ increases, $z_{\\mathrm{T}}$ rises, so $H_{\\mathrm{gross}}$ decreases at high $Q$ and increases at low $Q$; to preserve daily energy, $H_{\\mathrm{eff}}$ should be the energy-weighted average head, $H_{\\mathrm{eff}} = \\dfrac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, H_{\\mathrm{net}}(t)\\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, \\mathrm{d}t}$.\n\nC. As $Q$ increases, $H_{\\mathrm{gross}}$ increases because the velocity head at the draft tube outlet adds to the static head; therefore $H_{\\mathrm{eff}}$ should be taken as the maximum instantaneous head observed during the day.\n\nD. $H_{\\mathrm{gross}}$ varies with $Q$, but an unbiased planning approximation is to define $H_{\\mathrm{eff}}$ as the simple time average, $H_{\\mathrm{eff}} = \\dfrac{1}{T}\\int_{0}^{T} H_{\\mathrm{net}}(t)\\, \\mathrm{d}t$, regardless of how $Q$ and $\\eta$ vary.\n\nE. $H_{\\mathrm{gross}}$ is unaffected by the tailrace level because the plant is run-of-river; $H_{\\mathrm{eff}}$ should equal the fixed design head stated by the manufacturer.",
            "solution": "The analysis consists of two parts: first, determining how $H_{\\mathrm{gross}}$ varies with discharge $Q$, and second, deriving the correct mathematical definition for the effective head $H_{\\mathrm{eff}}$.\n\n**Part 1: Variation of Gross Head**\n\nThe gross head is defined as $H_{\\mathrm{gross}}(t) = z_{\\mathrm{H}} - z_{\\mathrm{T}}(Q(t))$. The headwater elevation $z_{\\mathrm{H}}$ is given as constant. The tailrace elevation $z_{\\mathrm{T}}$ is governed by a backwater rating curve, which describes the relationship between river discharge ($Q$) and water surface elevation (stage). In open-channel flow, a higher discharge requires a larger flow area or higher velocity, both of which are achieved through an increase in water depth and, consequently, water surface elevation. Therefore, as discharge $Q$ increases, the tailwater elevation $z_{\\mathrm{T}}$ necessarily increases.\n\nGiven the relationship $H_{\\mathrm{gross}} = z_{\\mathrm{H}} - z_{\\mathrm{T}}$, and since $z_{\\mathrm{H}}$ is constant, an increase in $z_{\\mathrm{T}}$ will cause a decrease in $H_{\\mathrm{gross}}$. Thus, at times of high discharge ($Q$), $H_{\\mathrm{gross}}$ is at its minimum, and at times of low discharge, $z_{\\mathrm{T}}$ is lower, and $H_{\\mathrm{gross}}$ is at its maximum.\n\n**Part 2: Definition of Effective Head**\n\nThe objective is to find a constant effective head, $H_{\\mathrm{eff}}$, that preserves the total energy generated over a day of duration $T$.\n\nThe total energy, $E_{\\mathrm{total}}$, is the time integral of the instantaneous power, $P(t)$:\n$$E_{\\mathrm{total}} = \\int_{0}^{T} P(t) \\, \\mathrm{d}t$$\nSubstituting the given expression for $P(t)$:\n$$E_{\\mathrm{total}} = \\int_{0}^{T} \\rho g\\, Q(t)\\, H_{\\mathrm{net}}(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\, \\mathrm{d}t$$\nSince $\\rho$ and $g$ are constants, they can be moved outside the integral:\n$$E_{\\mathrm{total}} = \\rho g \\int_{0}^{T} H_{\\mathrm{net}}(t) \\left[ Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\right] \\, \\mathrm{d}t$$\nThe problem requires that a simplified model using a constant $H_{\\mathrm{eff}}$ yields this same total energy. The most logical formulation for such a model is one where the total energy is expressed as a product of constants ($\\rho$, $g$), the effective head ($H_{\\mathrm{eff}}$), and some representative integral quantity related to flow and efficiency.\n\nThis structure suggests that $H_{\\mathrm{eff}}$ should be a weighted average of the instantaneous net head, $H_{\\mathrm{net}}(t)$. In the integral for $E_{\\mathrm{total}}$, the instantaneous head $H_{\\mathrm{net}}(t)$ is weighted by the term $w(t) = Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$. This weighting factor represents the \"power generation potential\" per unit of head at time $t$. To find an average head that preserves the total integral (energy), we must use this same weighting function.\n\nThe general formula for a weighted average of a function $f(t)$ with a weight function $w(t)$ over an interval $[0, T]$ is:\n$$\\bar{f} = \\frac{\\int_{0}^{T} w(t) f(t) \\, \\mathrm{d}t}{\\int_{0}^{T} w(t) \\, \\mathrm{d}t}$$\nApplying this to our problem, with $f(t) = H_{\\mathrm{net}}(t)$ and $w(t) = Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$, we get the definition for the energy-preserving effective head:\n$$H_{\\mathrm{eff}} = \\frac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) H_{\\mathrm{net}}(t) \\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\, \\mathrm{d}t}$$\nThis expression is an energy-weighted (or more precisely, power-weighted) average of the net head, as the numerator is proportional to the total energy generated.\n\n### Option-by-Option Analysis\n\n**A. Because $z_{\\mathrm{H}}$ is approximately constant, $H_{\\mathrm{gross}}$ is constant, and $H_{\\mathrm{eff}}$ should be the simple arithmetic mean of the maximum and minimum observed heads over the day.**\nThis statement is incorrect. The premise that $H_{\\mathrm{gross}}$ is constant is false; it varies because $z_{\\mathrm{T}}$ varies with $Q$. Furthermore, a simple arithmetic mean of head does not properly weight the head's contribution to total energy, which also depends on the concurrent discharge $Q$ and efficiency $\\eta$.\n**Verdict: Incorrect.**\n\n**B. As $Q$ increases, $z_{\\mathrm{T}}$ rises, so $H_{\\mathrm{gross}}$ decreases at high $Q$ and increases at low $Q$; to preserve daily energy, $H_{\\mathrm{eff}}$ should be the energy-weighted average head, $H_{\\mathrm{eff}} = \\dfrac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, H_{\\mathrm{net}}(t)\\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, \\mathrm{d}t}$.**\nThis statement is entirely correct. The first part accurately describes the inverse relationship between gross head and discharge due to tailwater effects. The second part provides the correct formula for the effective head, derived from the principle of preserving total energy, which requires a weighted average where the weighting function accounts for the other terms in the power equation ($Q$ and $\\eta$).\n**Verdict: Correct.**\n\n**C. As $Q$ increases, $H_{\\mathrm{gross}}$ increases because the velocity head at the draft tube outlet adds to the static head; therefore $H_{\\mathrm{eff}}$ should be taken as the maximum instantaneous head observed during the day.**\nThis statement is incorrect. The assertion that $H_{\\mathrm{gross}}$ increases with $Q$ is contrary to the physics of tailwater rating curves. The rationale provided is also physically flawed; the velocity head at the outlet is a form of energy loss, not an addition to the gross static head. Taking the maximum head would lead to a significant overestimation of energy production.\n**Verdict: Incorrect.**\n\n**D. $H_{\\mathrm{gross}}$ varies with $Q$, but an unbiased planning approximation is to define $H_{\\mathrm{eff}}$ as the simple time average, $H_{\\mathrm{eff}} = \\dfrac{1}{T}\\int_{0}^{T} H_{\\mathrm{net}}(t)\\, \\mathrm{d}t$, regardless of how $Q$ and $\\eta$ vary.**\nThis statement is incorrect. While it correctly notes that $H_{\\mathrm{gross}}$ varies, it proposes a simple time-average for $H_{\\mathrm{eff}}$. This is an inadequate approximation because it fails to account for the correlation between head, discharge, and efficiency. Total energy is the integral of the product of these time-varying quantities, not the product of their averages. A simple time-average of head will not preserve total energy unless $Q$ and $\\eta$ are constant, which is not the case here.\n**Verdict: Incorrect.**\n\n**E. $H_{\\mathrm{gross}}$ is unaffected by the tailrace level because the plant is run-of-river; $H_{\\mathrm{eff}}$ should equal the fixed design head stated by the manufacturer.**\nThis statement is incorrect. The premise that $H_{\\mathrm{gross}}$ is unaffected by the tailrace level is false, directly contradicting the provided definition $H_{\\mathrm{gross}} = z_{\\mathrm{H}} - z_{\\mathrm{T}}$ and the nature of run-of-river plants. Using a fixed design head is inappropriate for operational planning over a specific period with known variations, as it is a nominal value for design, not an effective value for actual operation.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "The ultimate goal of modeling is often to inform economic decisions. This final practice synthesizes our understanding of net head and head-dependent efficiency $\\eta(H)$ into a computational framework to evaluate a plant's financial performance under varying conditions. By implementing a model that calculates revenue based on a time-varying price signal and different efficiency upgrade scenarios, you will gain hands-on experience in the type of quantitative analysis that underpins investment and operational strategies in the energy sector. ",
            "id": "4094790",
            "problem": "A hydropower plant converts gravitational potential energy of water into electrical energy. Let the instantaneous net head be denoted by $H$, the volumetric flow rate be denoted by $Q$, water density be denoted by $\\rho$, and gravitational acceleration be denoted by $g$. Electrical conversion efficiency depends on head via a head-dependent function $\\,\\eta(H)\\,$. A day-ahead price curve provides the value of electricity as a function of time. Starting from the physical base that the mechanical power available from a hydraulic flow is given by the product of mass flow rate, gravitational acceleration, and net head, derive a method to compute revenue over a discrete forecast horizon with known head values and prices, using $\\,\\eta(H)\\,$ to map mechanical power to electrical power. Implement this method to compare scenarios with different efficiency upgrade functions.\n\nUse the following scientifically consistent constants and conventions:\n- Density $\\,\\rho = \\,1000\\,\\mathrm{kg/m^3}\\,$.\n- Gravitational acceleration $\\,g = \\,9.81\\,\\mathrm{m/s^2}\\,$.\n- Rated discharge $\\,Q = \\,80\\,\\mathrm{m^3/s}\\,$ is constant over the horizon.\n- Timestep length $\\,\\Delta t = \\,1\\,\\mathrm{hour}\\,$.\n- Price unit is United States Dollar (USD) per Megawatt-hour (MWh), written as $\\,\\mathrm{USD}/\\mathrm{MWh}\\,$.\n- Report total revenue in United States Dollar (USD) as a float rounded to two decimal places.\n- If the net head is below a scenario-specific cut-in threshold, generation is zero for that timestep.\n\nDefine the following three head-to-efficiency scenarios. For all, enforce $\\,\\eta(H)\\in[\\,\\eta_{\\min},\\,\\eta_{\\max}\\,]\\,$ via clamping after evaluating the expression shown, and enforce zero generation for $\\,H < H_{\\mathrm{cut}}\\,$.\n1. Baseline: $\\,\\eta_{\\max} = \\,0.90\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,5.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,8.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n2. Upgrade Low-Head: $\\,\\eta_{\\max} = \\,0.90\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,3.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,6.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n3. Upgrade High-Head: $\\,\\eta_{\\max} = \\,0.93\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,5.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,8.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n\nUse a discrete forecast with $\\,\\Delta t = \\,1\\,\\mathrm{hour}\\,$. At each hour $\\,t\\,$, compute electrical energy $\\,E_t\\,$ and revenue $\\,R_t\\,$ from first principles. Convert units consistently so that the price multiplies energy measured in Megawatt-hour. Sum revenues over the horizon to get the total revenue for a scenario.\n\nTest suite. Evaluate total revenues for the three scenarios on each of the following three cases; all arrays are ordered over $\\,6\\,$ consecutive hours:\n- Case $\\,1\\,$ (moderate head variability, peaky prices):\n  - Head series $\\,\\{\\,15,\\,18,\\,20,\\,22,\\,19,\\,16\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,40,\\,45,\\,50,\\,55,\\,50,\\,45\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n- Case $\\,2\\,$ (near cut-in conditions, modest prices):\n  - Head series $\\,\\{\\,6,\\,7,\\,8,\\,7,\\,6,\\,5\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,30,\\,32,\\,35,\\,33,\\,31,\\,30\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n- Case $\\,3\\,$ (high heads, flat prices):\n  - Head series $\\,\\{\\,50,\\,55,\\,60,\\,65,\\,60,\\,55\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,35,\\,35,\\,35,\\,35,\\,35,\\,35\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n\nFinal output format. Your program should produce a single line of output containing $\\,9\\,$ float results (rounded to two decimals) as a comma-separated list enclosed in square brackets, ordered as:\n$$[\\,\\text{Case 1 Baseline},\\,\\text{Case 1 Upgrade Low-Head},\\,\\text{Case 1 Upgrade High-Head},\\,\\text{Case 2 Baseline},\\,\\text{Case 2 Upgrade Low-Head},\\,\\text{Case 2 Upgrade High-Head},\\,\\text{Case 3 Baseline},\\,\\text{Case 3 Upgrade Low-Head},\\,\\text{Case 3 Upgrade High-Head}\\,].$$",
            "solution": "The solution is derived from first principles of physics and engineering. The objective is to calculate the total revenue generated by a hydropower plant over a discrete time horizon, considering head-dependent efficiency and a time-varying electricity price.\n\n**1. Mechanical Power**\n\nThe fundamental principle of hydropower is the conversion of gravitational potential energy of water into mechanical energy, and subsequently into electrical energy. The available mechanical power, $P_{mech}$, from a hydraulic flow is given by the product of the mass flow rate, $\\dot{m}$, the gravitational acceleration, $g$, and the net head, $H$.\n\nThe mass flow rate, $\\dot{m}$, is the product of the water density, $\\rho$, and the volumetric flow rate, $Q$:\n$$ \\dot{m} = \\rho Q $$\nGiven $\\rho = 1000\\,\\mathrm{kg/m^3}$ and $Q = 80\\,\\mathrm{m^3/s}$, the mass flow rate is:\n$$ \\dot{m} = 1000\\,\\mathrm{kg/m^3} \\times 80\\,\\mathrm{m^3/s} = 80000\\,\\mathrm{kg/s} $$\n\nThe mechanical power is therefore:\n$$ P_{mech}(H) = \\dot{m} g H = \\rho Q g H $$\nThe units of this expression are $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{m^3/s}) \\cdot (\\mathrm{m/s^2}) \\cdot (\\mathrm{m}) = \\mathrm{kg \\cdot m^2/s^3}$, which corresponds to Watts ($\\mathrm{W}$), the standard unit of power. Using the provided constants:\n$$ P_{mech}(H) = (1000\\,\\mathrm{kg/m^3}) \\cdot (80\\,\\mathrm{m^3/s}) \\cdot (9.81\\,\\mathrm{m/s^2}) \\cdot H = 784800 \\cdot H\\,\\mathrm{W} $$\n\n**2. Electrical Power and Efficiency**\n\nThe conversion from mechanical power to electrical power, $P_{elec}$, is not perfectly efficient. This is quantified by the electrical conversion efficiency, $\\eta$, which is given as a function of the net head, $\\eta(H)$.\n$$ P_{elec}(H) = \\eta(H) \\cdot P_{mech}(H) = \\eta(H) \\rho Q g H $$\n\nThe problem defines three scenarios, each with a specific function for $\\eta(H)$. The general form is:\n$$ \\eta_{calc}(H) = \\eta_{\\max} - \\frac{k}{H + h_0} $$\nThis calculated value is then subjected to two constraints:\n1.  **Clamping**: The efficiency must lie within a specified range $[\\eta_{\\min}, \\eta_{\\max}]$. Therefore, the effective efficiency is $\\eta(H) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H)))$.\n2.  **Cut-in Head**: No power is generated if the head $H$ is below a scenario-specific cut-in threshold, $H_{cut}$. This is equivalent to setting $\\eta(H) = 0$ if $H < H_{cut}$.\n\nCombining these, the complete expression for the efficiency at a given head $H$ is:\n$$\n\\eta(H) =\n\\begin{cases}\n    0 & \\text{if } H < H_{cut} \\\\\n    \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{\\max} - \\frac{k}{H + h_0})) & \\text{if } H \\ge H_{cut}\n\\end{cases}\n$$\n\n**3. Energy and Revenue Calculation over a Discrete Horizon**\n\nThe problem provides a discrete forecast horizon with a constant timestep length $\\Delta t = 1\\,\\mathrm{hour}$. For each timestep $i$, we are given a net head $H_i$ and an electricity price $p_i$ (in $\\mathrm{USD/MWh}$).\n\nFirst, we calculate the electrical power $P_{elec, i}$ for each timestep $i$ using the head $H_i$ for that step.\n$$ P_{elec, i} = \\eta(H_i) \\rho Q g H_i \\quad [\\mathrm{W}] $$\n\nThe energy generated during timestep $i$, $E_i$, is the power multiplied by the duration of the timestep, $\\Delta t$. It is crucial to ensure consistent units. The price is given in $\\mathrm{USD/MWh}$, so we must express the energy $E_i$ in Megawatt-hours ($\\mathrm{MWh}$).\n\nWe convert power from Watts ($\\mathrm{W}$) to Megawatts ($\\mathrm{MW}$) by dividing by $10^6$:\n$$ P_{elec, i, \\mathrm{MW}} = \\frac{P_{elec, i, \\mathrm{W}}}{10^6} $$\n\nEnergy in $\\mathrm{MWh}$ is then calculated by multiplying the power in $\\mathrm{MW}$ by the time duration in hours:\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot \\Delta t_{\\mathrm{hours}} $$\nSince $\\Delta t = 1\\,\\mathrm{hour}$, the energy in $\\mathrm{MWh}$ is numerically equal to the power in $\\mathrm{MW}$:\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot 1\\,\\mathrm{h} = \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} $$\n\nThe revenue for timestep $i$, $R_i$, is the product of the energy generated (in $\\mathrm{MWh}$) and the price for that timestep (in $\\mathrm{USD/MWh}$):\n$$ R_i = E_{i, \\mathrm{MWh}} \\cdot p_i = \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\right) \\cdot p_i $$\n\n**4. Total Revenue**\n\nThe total revenue for a given scenario is the sum of the revenues from all timesteps in the forecast horizon. For a horizon of $N$ timesteps:\n$$ R_{total} = \\sum_{i=1}^{N} R_i = \\sum_{i=1}^{N} \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\cdot p_i \\right) $$\n\n**Algorithm Summary**\n\nThe implementation will proceed by iterating through each of the three test cases. For each case, it will iterate through the three scenarios (Baseline, Upgrade Low-Head, Upgrade High-Head).\n\nFor each (Case, Scenario) pair:\n1.  Initialize total revenue, $R_{total}$, to $0$.\n2.  Retrieve the scenario parameters $(\\eta_{\\max}, \\eta_{\\min}, k, h_0, H_{cut})$ and the case data (head series $\\{H_i\\}$ and price series $\\{p_i\\}$).\n3.  For each timestep $i$ in the $6$-hour horizon:\n    a. Check if $H_i \\ge H_{cut}$. If not, the revenue for this step is $0$.\n    b. If yes, compute $\\eta_{calc}(H_i) = \\eta_{\\max} - k/(H_i + h_0)$.\n    c. Clamp the value to get the effective efficiency $\\eta(H_i) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H_i)))$.\n    d. Compute the energy in MWh: $E_{i, \\mathrm{MWh}} = (\\eta(H_i) \\cdot 1000 \\cdot 80 \\cdot 9.81 \\cdot H_i) / 10^6$.\n    e. Compute the revenue for the timestep: $R_i = E_{i, \\mathrm{MWh}} \\cdot p_i$.\n    f. Add this to the total: $R_{total} = R_{total} + R_i$.\n4.  After iterating through all timesteps, round the final $R_{total}$ to two decimal places.\n5.  Store the result.\n\nThis procedure is systematically applied to generate the $9$ required output values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates total hydropower revenue for multiple scenarios and test cases.\n    \"\"\"\n    # Define physical constants and plant parameters\n    rho = 1000.0  # Water density in kg/m^3\n    g = 9.81      # Gravitational acceleration in m/s^2\n    Q = 80.0      # Volumetric flow rate in m^3/s\n    delta_t = 1.0 # Timestep length in hours\n\n    # Define the three head-to-efficiency scenarios\n    # Format: { 'name': (eta_max, eta_min, k, h_0, H_cut) }\n    scenarios = {\n        \"Baseline\":          (0.90, 0.70, 5.0, 10.0, 8.0),\n        \"Upgrade Low-Head\":  (0.90, 0.70, 3.0, 10.0, 6.0),\n        \"Upgrade High-Head\": (0.93, 0.70, 5.0, 10.0, 8.0)\n    }\n    # Enforce the specified output order\n    scenario_order = [\"Baseline\", \"Upgrade Low-Head\", \"Upgrade High-Head\"]\n\n    # Define the test cases with head and price series\n    # Format: [ (head_series, price_series) ]\n    test_cases = [\n        # Case 1 (moderate head variability, peaky prices)\n        (np.array([15.0, 18.0, 20.0, 22.0, 19.0, 16.0]), np.array([40.0, 45.0, 50.0, 55.0, 50.0, 45.0])),\n        # Case 2 (near cut-in conditions, modest prices)\n        (np.array([6.0, 7.0, 8.0, 7.0, 6.0, 5.0]), np.array([30.0, 32.0, 35.0, 33.0, 31.0, 30.0])),\n        # Case 3 (high heads, flat prices)\n        (np.array([50.0, 55.0, 60.0, 65.0, 60.0, 55.0]), np.array([35.0, 35.0, 35.0, 35.0, 35.0, 35.0]))\n    ]\n\n    results = []\n\n    # Iterate through each test case\n    for H_series, p_series in test_cases:\n        # Iterate through each scenario in the specified order\n        for scenario_name in scenario_order:\n            eta_max, eta_min, k, h_0, H_cut = scenarios[scenario_name]\n            \n            # Create a boolean mask to identify active hours where head >= cut_in_head\n            active_mask = H_series >= H_cut\n            \n            # Calculate the raw efficiency based on the formula, avoiding division by non-positive numbers\n            # Note: H_series + h_0 is always positive for the given inputs\n            eta_raw = eta_max - k / (H_series + h_0)\n            \n            # Clamp the efficiency to the [eta_min, eta_max] range\n            eta_clamped = np.clip(eta_raw, eta_min, eta_max)\n            \n            # Apply the cut-in condition: efficiency is zero for inactive hours\n            eta_final = eta_clamped * active_mask\n            \n            # Calculate electrical power in Watts for each timestep\n            # P_elec(W) = eta * rho * Q * g * H\n            P_elec_W = eta_final * rho * Q * g * H_series\n            \n            # Convert power from Watts to Megawatts\n            P_elec_MW = P_elec_W / 1e6\n            \n            # Calculate energy generated in MWh for each timestep\n            # E(MWh) = P(MW) * delta_t(h)\n            E_MWh = P_elec_MW * delta_t\n            \n            # Calculate revenue for each timestep\n            # R(USD) = E(MWh) * Price(USD/MWh)\n            R_series = E_MWh * p_series\n            \n            # Sum the revenues over the horizon to get total revenue\n            total_revenue = np.sum(R_series)\n            \n            # Append the rounded result to the list\n            results.append(round(total_revenue, 2))\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}