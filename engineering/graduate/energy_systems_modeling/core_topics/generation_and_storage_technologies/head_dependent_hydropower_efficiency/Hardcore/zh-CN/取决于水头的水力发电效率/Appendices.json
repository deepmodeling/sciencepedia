{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在为理解水力发电性能奠定基础。我们将从基本的能量平衡方程入手，区分代表总可用势能的总水头 ($H_{\\text{gross}}$) 和扣除水力损失后涡轮机实际可用的净水头 ($H_{\\text{net}}$) 。这项实践对于准确量化水电站的能量转换潜力至关重要。",
            "id": "4094779",
            "problem": "一座高水头水电站从一个大型水库中取水，并排入尾水渠。水库的自由水面高程为公共基准面以上 $250$ 米，而尾水自由水面高程为该基准面以上 $200$ 米。输水系统由单个压力管道组成，其中稳定的粘性摩擦损失造成了 $h_{f}=6$ 米的水头损失，以及额外的局部微小损失 $h_{m}=2$ 米。假设水流为单相、不可压缩的稳态流动。水库和尾水渠的横截面足够大，以至于自由水面的平均速度可以忽略不计，且自由水面的压力均为大气压。\n\n从水库自由水面与尾水自由水面之间的不可压缩流的稳态机械能平衡出发，考虑涡轮机提取的水头和总水力损失，推导可用于涡轮机的净水头 $H_{\\text{net}}$ 关于总水头和水力损失的表达式。然后根据给定数据数值计算 $H_{\\text{net}}$。此外，计算输水系统中水力损失所耗散的总水头的分数，并以无量纲小数表示。\n\n以米为单位表示 $H_{\\text{net}}$。将该分数表示为小数（而非百分比）。将两个量都四舍五入到四位有效数字。",
            "solution": "合适的出发点是不可压缩流体在两点之间流动的稳态机械能方程，其中包含了涡轮机提取的水头以及沿程损失和局部损失。考虑从水库自由水面（位置 $1$）到尾水自由水面（位置 $2$）的流线。用水头项表示的稳态能量方程为\n$$\nz_{1} + \\frac{p_{1}}{\\rho g} + \\frac{v_{1}^{2}}{2 g} \\;+\\; H_{\\text{pump}} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2} + \\frac{p_{2}}{\\rho g} + \\frac{v_{2}^{2}}{2 g},\n$$\n其中 $z$ 是高程水头，$p$ 是压力，$\\rho$ 是密度，$g$ 是重力加速度，$v$ 是平均速度，$H_{\\text{pump}}$ 是水泵增加的水头（此处为零），$H_{\\text{turbine}}$ 是涡轮机提取的水头，而 $h_{L}$ 是位置 $1$ 和 $2$ 之间的总水力损失（摩擦损失和局部损失之和）。\n\n鉴于水库和尾水的自由水面都暴露于大气中，我们有 $p_{1} = p_{2}$ 等于大气压，因此 $\\frac{p_{1}}{\\rho g} = \\frac{p_{2}}{\\rho g}$。自由水面处的横截面很大，因此速度 $v_{1}$ 和 $v_{2}$ 可忽略不计，这意味着 $\\frac{v_{1}^{2}}{2 g} \\approx 0$ 和 $\\frac{v_{2}^{2}}{2 g} \\approx 0$。没有水泵，所以 $H_{\\text{pump}} = 0$。在这些条件下，能量方程简化为\n$$\nz_{1} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2}.\n$$\n对涡轮机提取的水头进行整理，得到\n$$\nH_{\\text{turbine}} \\;=\\; z_{1} - z_{2} \\;-\\; h_{L}.\n$$\n项 $z_{1} - z_{2}$ 是总水头，我们将其记为 $H_{\\text{gross}}$。因此，\n$$\nH_{\\text{turbine}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\n水电行业的惯例将可用于涡轮机的净水头 $H_{\\text{net}}$ 定义为实际传递到涡轮转轮上的水头，这等于上面推导出的涡轮机提取的水头。因此，\n$$\nH_{\\text{net}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\n\n现在我们根据提供的数据计算 $H_{\\text{gross}}$ 和 $h_{L}$。总水头是自由水面高程之差，\n$$\nH_{\\text{gross}} \\;=\\; z_{1} - z_{2} \\;=\\; 250 - 200 \\;=\\; 50.\n$$\n总水力损失是摩擦损失和局部损失之和，\n$$\nh_{L} \\;=\\; h_{f} + h_{m} \\;=\\; 6 + 2 \\;=\\; 8.\n$$\n因此，净水头为\n$$\nH_{\\text{net}} \\;=\\; 50 - 8 \\;=\\; 42.\n$$\n\n水力损失占总水头的比例为\n$$\n\\text{损失比例} \\;=\\; \\frac{h_{L}}{H_{\\text{gross}}} \\;=\\; \\frac{8}{50} \\;=\\; 0.16.\n$$\n\n根据保留四位有效数字的四舍五入要求，我们以米为单位表示 $H_{\\text{net}}$，并将比例表示为小数：\n$$\nH_{\\text{net}} \\;=\\; 42.00 \\quad \\text{米},\n$$\n$$\n\\text{损失比例} \\;=\\; 0.1600.\n$$\n这些值满足所要求的有效数字和单位规定。",
            "answer": "$$\\boxed{\\begin{pmatrix} 42.00  0.1600 \\end{pmatrix}}$$"
        },
        {
            "introduction": "水力发电系统很少是静态的；尾水位等参数会随河流流量而变化。本问题将从静态快照转向动态的运行视角，探讨总水头的波动如何影响长期发电量计算 。通过推导“等效水头”的定义，您将学到一种在能源建模中简化复杂时变系统的关键技术。",
            "id": "4094777",
            "problem": "一座径流式水电站的上游库区足够大，其上游水位（用 $z_{\\mathrm{H}}$ 表示）在一天内可被视为近似恒定。尾水位 $z_{\\mathrm{T}}$ 受回水曲线控制，并随流量 $Q$ 变化：当 $Q$ 在其日最低值和最高值之间变化时，$z_{\\mathrm{T}}$ 相对于一个名义参考值在约 $\\pm 1\\,\\mathrm{m}$ 的范围内波动。毛水头为 $H_{\\mathrm{gross}}(t) = z_{\\mathrm{H}} - z_{\\mathrm{T}}(Q(t))$。设水力损失 $h_{\\mathrm{L}}(Q)$ 是 $Q$ 的一个增函数，并定义净水头为 $H_{\\mathrm{net}}(t) = H_{\\mathrm{gross}}(t) - h_{\\mathrm{L}}(Q(t))$。水轮发电机组效率 $\\eta(H_{\\mathrm{net}},Q)$ 取决于 $H_{\\mathrm{net}}$ 和 $Q$。瞬时功率为 $P(t) = \\rho g\\, Q(t)\\, H_{\\mathrm{net}}(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$，其中 $\\rho$ 是水的密度，$g$ 是重力加速度。在持续时间为 $T$ 的一天内，运行人员希望用一个单一的“有效水头”$H_{\\mathrm{eff}}$ 来替代随时间变化的水头，用于规划计算，使得在恒定水头的表示中使用 $H_{\\mathrm{eff}}$ 产生的日总能量与实际时变运行产生的日总能量相同。\n\n哪个选项最能描述尾水位的波动如何影响 $H_{\\mathrm{gross}}$，以及在一天内应如何从运行角度定义 $H_{\\mathrm{eff}}$？\n\nA. 因为 $z_{\\mathrm{H}}$ 近似恒定，所以 $H_{\\mathrm{gross}}$ 是恒定的，并且 $H_{\\mathrm{eff}}$ 应为一天中观测到的最大和最小水头的简单算术平均值。\n\nB. 随着 $Q$ 增加，$z_{\\mathrm{T}}$ 上升，因此 $H_{\\mathrm{gross}}$ 在高 $Q$ 时减小，在低 $Q$ 时增加；为了保持日总能量不变，$H_{\\mathrm{eff}}$ 应为能量加权平均水头，即 $H_{\\mathrm{eff}} = \\dfrac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, H_{\\mathrm{net}}(t)\\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, \\mathrm{d}t}$。\n\nC. 随着 $Q$ 增加，$H_{\\mathrm{gross}}$ 增加，因为尾水管出口处的速度水头增加了静水头；因此 $H_{\\mathrm{eff}}$ 应取为一天中观测到的最大瞬时水头。\n\nD. $H_{\\mathrm{gross}}$ 随 $Q$ 变化，但一个无偏的规划近似是定义 $H_{\\mathrm{eff}}$ 为简单时间平均值，$H_{\\mathrm{eff}} = \\dfrac{1}{T}\\int_{0}^{T} H_{\\mathrm{net}}(t)\\, \\mathrm{d}t$，而不管 $Q$ 和 $\\eta$ 如何变化。\n\nE. $H_{\\mathrm{gross}}$ 不受尾水位影响，因为该电站是径流式的；$H_{\\mathrm{eff}}$ 应等于制造商规定的固定设计水头。",
            "solution": "用户需要对问题陈述进行严格验证，然后提供详细的解决方案和选项评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   电站类型：径流式水电站。\n*   上游水位：$z_{\\mathrm{H}}$，视为近似恒定。\n*   尾水位：$z_{\\mathrm{T}}$，通过回水曲线随流量 $Q$ 变化。\n*   尾水位波动：围绕一个名义参考值波动 $\\pm 1\\,\\mathrm{m}$。\n*   毛水头：$H_{\\mathrm{gross}}(t) = z_{\\mathrm{H}} - z_{\\mathrm{T}}(Q(t))$。\n*   水力损失：$h_{\\mathrm{L}}(Q)$，$Q$ 的增函数。\n*   净水头：$H_{\\mathrm{net}}(t) = H_{\\mathrm{gross}}(t) - h_{\\mathrm{L}}(Q(t))$。\n*   水轮发电机组效率：$\\eta(H_{\\mathrm{net}},Q)$。\n*   瞬时功率：$P(t) = \\rho g\\, Q(t)\\, H_{\\mathrm{net}}(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$。\n*   常量：$\\rho$（水的密度），$g$（重力加速度）。\n*   时间段：持续时间为 $T$ 的一天。\n*   目标：定义一个有效水头 $H_{\\mathrm{eff}}$，用于恒定水头的表示，使其产生的日总能量与时变运行产生的总能量相同。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据充分**：该问题在水电工程和明渠水力学原理方面有充分的依据。毛水头、净水头、功率的定义，以及尾水位和流量之间的关系，都是标准且正确的。\n*   **问题定义明确**：该问题定义明确。它要求定义一个特定的量 $H_{\\mathrm{eff}}$，该量满足一个清晰的积分约束（日总能量守恒）。可以推导出唯一且有意义的解。\n*   **客观性**：语言技术性强、精确，没有主观或带偏见的陈述。\n*   **完整性和一致性**：问题陈述是自洽的，提供了推导答案所需的所有定义和关系。没有内部矛盾。\n*   **现实性**：所描述的情景是径流式水电站面临的一个现实运行挑战，其中尾水位不是恒定的，而是河流流量的函数。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。这是一个水电能源系统分析中的标准、定义明确的问题。我将继续进行解题推导。\n\n### 解题推导\n\n分析包括两部分：首先，确定 $H_{\\mathrm{gross}}$ 如何随流量 $Q$ 变化；其次，推导有效水头 $H_{\\mathrm{eff}}$ 的正确数学定义。\n\n**第一部分：毛水头的变化**\n\n毛水头定义为 $H_{\\mathrm{gross}}(t) = z_{\\mathrm{H}} - z_{\\mathrm{T}}(Q(t))$。已知上游水位 $z_{\\mathrm{H}}$ 是恒定的。尾水位 $z_{\\mathrm{T}}$ 受回水曲线控制，该曲线描述了河流流量（$Q$）与水面高程（水位）之间的关系。在明渠流中，更高的流量需要更大的过水面积或更高的流速，这两者都是通过增加水深，从而增加水面高程来实现的。因此，随着流量 $Q$ 的增加，尾水位 $z_{\\mathrm{T}}$ 必然增加。\n\n鉴于关系式 $H_{\\mathrm{gross}} = z_{\\mathrm{H}} - z_{\\mathrm{T}}$，并且 $z_{\\mathrm{H}}$ 是恒定的，所以 $z_{\\mathrm{T}}$ 的增加将导致 $H_{\\mathrm{gross}}$ 的减少。因此，在高流量（$Q$）时，$H_{\\mathrm{gross}}$ 处于其最小值；在低流量时，$z_{\\mathrm{T}}$ 较低，$H_{\\mathrm{gross}}$ 处于其最大值。\n\n**第二部分：有效水头的定义**\n\n目标是找到一个恒定的有效水头 $H_{\\mathrm{eff}}$，以保持在持续时间为 $T$ 的一天内产生的总能量不变。\n\n总能量 $E_{\\mathrm{total}}$ 是瞬时功率 $P(t)$ 的时间积分：\n$$E_{\\mathrm{total}} = \\int_{0}^{T} P(t) \\, \\mathrm{d}t$$\n代入给定的 $P(t)$ 表达式：\n$$E_{\\mathrm{total}} = \\int_{0}^{T} \\rho g\\, Q(t)\\, H_{\\mathrm{net}}(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\, \\mathrm{d}t$$\n由于 $\\rho$ 和 $g$ 是常数，它们可以移到积分号外：\n$$E_{\\mathrm{total}} = \\rho g \\int_{0}^{T} H_{\\mathrm{net}}(t) \\left[ Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\right] \\, \\mathrm{d}t$$\n问题要求使用恒定 $H_{\\mathrm{eff}}$ 的简化模型产生相同的总能量。这种模型最合乎逻辑的公式是，总能量表示为常数（$\\rho$、$g$）、有效水头（$H_{\\mathrm{eff}}$）以及某个与流量和效率相关的代表性积分量的乘积。\n\n这种结构表明 $H_{\\mathrm{eff}}$ 应该是瞬时净水头 $H_{\\mathrm{net}}(t)$ 的加权平均值。在 $E_{\\mathrm{total}}$ 的积分中，瞬时水头 $H_{\\mathrm{net}}(t)$ 被权重项 $w(t) = Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$ 加权。这个权重因子代表了在时间 $t$ 单位水头的“发电潜力”。为了找到一个能够保持总积分（能量）不变的平均水头，我们必须使用相同的权重函数。\n\n函数 $f(t)$ 在区间 $[0, T]$ 上使用权重函数 $w(t)$ 的加权平均值的通用公式为：\n$$\\bar{f} = \\frac{\\int_{0}^{T} w(t) f(t) \\, \\mathrm{d}t}{\\int_{0}^{T} w(t) \\, \\mathrm{d}t}$$\n将此应用于我们的问题，令 $f(t) = H_{\\mathrm{net}}(t)$ 和 $w(t) = Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)$，我们得到保持能量不变的有效水头的定义：\n$$H_{\\mathrm{eff}} = \\frac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) H_{\\mathrm{net}}(t) \\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right) \\, \\mathrm{d}t}$$\n这个表达式是净水头的能量加权（或更准确地说是功率加权）平均值，因为分子与产生的总能量成正比。\n\n### 逐项分析选项\n\n**A. 因为 $z_{\\mathrm{H}}$ 近似恒定，所以 $H_{\\mathrm{gross}}$ 是恒定的，并且 $H_{\\mathrm{eff}}$ 应为一天中观测到的最大和最小水头的简单算术平均值。**\n这个陈述是错误的。$H_{\\mathrm{gross}}$ 恒定的前提是错误的；它因为 $z_{\\mathrm{T}}$ 随 $Q$ 变化而变化。此外，水头的简单算术平均值没有正确地加权水头对总能量的贡献，而总能量还取决于同期的流量 $Q$ 和效率 $\\eta$。\n**结论：错误。**\n\n**B. 随着 $Q$ 增加，$z_{\\mathrm{T}}$ 上升，因此 $H_{\\mathrm{gross}}$ 在高 $Q$ 时减小，在低 $Q$ 时增加；为了保持日总能量不变，$H_{\\mathrm{eff}}$ 应为能量加权平均水头，即 $H_{\\mathrm{eff}} = \\dfrac{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, H_{\\mathrm{net}}(t)\\, \\mathrm{d}t}{\\int_{0}^{T} Q(t)\\, \\eta\\!\\left(H_{\\mathrm{net}}(t),Q(t)\\right)\\, \\mathrm{d}t}$。**\n这个陈述是完全正确的。第一部分准确描述了由于尾水效应，毛水头与流量之间的反比关系。第二部分提供了有效水头的正确公式，该公式源于保持总能量不变的原则，这需要一个加权平均，其中权重函数考虑了功率方程中的其他项（$Q$ 和 $\\eta$）。\n**结论：正确。**\n\n**C. 随着 $Q$ 增加，$H_{\\mathrm{gross}}$ 增加，因为尾水管出口处的速度水头增加了静水头；因此 $H_{\\mathrm{eff}}$ 应取为一天中观测到的最大瞬时水头。**\n这个陈述是错误的。声称 $H_{\\mathrm{gross}}$ 随 $Q$ 增加与尾水曲线的物理原理相悖。所提供的理由在物理上也是有缺陷的；出口处的速度水头是一种能量损失形式，而不是对毛静水头的增加。取最大水头将导致对发电量的严重高估。\n**结论：错误。**\n\n**D. $H_{\\mathrm{gross}}$ 随 $Q$ 变化，但一个无偏的规划近似是定义 $H_{\\mathrm{eff}}$ 为简单时间平均值，$H_{\\mathrm{eff}} = \\dfrac{1}{T}\\int_{0}^{T} H_{\\mathrm{net}}(t)\\, \\mathrm{d}t$，而不管 $Q$ 和 $\\eta$ 如何变化。**\n这个陈述是错误的。虽然它正确地指出了 $H_{\\mathrm{gross}}$ 是变化的，但它为 $H_{\\mathrm{eff}}$ 提出了一个简单的时间平均值。这是一个不充分的近似，因为它未能考虑水头、流量和效率之间的相关性。总能量是这些时变数量乘积的积分，而不是它们平均值的乘积。除非 $Q$ 和 $\\eta$ 是恒定的（而在这里并非如此），否则水头的简单时间平均值将无法保持总能量不变。\n**结论：错误。**\n\n**E. $H_{\\mathrm{gross}}$ 不受尾水位影响，因为该电站是径流式的；$H_{\\mathrm{eff}}$ 应等于制造商规定的固定设计水头。**\n这个陈述是错误的。$H_{\\mathrm{gross}}$ 不受尾水位影响的前提是错误的，直接与给定的定义 $H_{\\mathrm{gross}} = z_{\\mathrm{H}} - z_{\\mathrm{T}}$ 以及径流式电站的性质相矛盾。使用固定的设计水头不适用于在已知变化的特定时期内进行运行规划，因为它是一个用于设计的名义值，而不是实际运行的有效值。\n**结论：错误。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "最后的实践将物理原理与经济分析相结合，这是能源系统建模的一项核心技能。您将构建一个计算模型，模拟水电站在一段时间内的收益，其中考虑了波动的可用水头、分时电价以及与水头相关的效率曲线 。这个动手编程练习将演示如何评估效率升级带来的经济影响，并做出数据驱动的决策。",
            "id": "4094790",
            "problem": "水电站将水的重力势能转化为电能。设瞬时净水头为 $H$，体积流量为 $Q$，水密度为 $\\rho$，重力加速度为 $g$。电能转换效率通过一个与水头相关的函数 $\\,\\eta(H)\\,$ 依赖于水头。日前价格曲线提供了电能价值随时间变化的函数。从水力流的可用机械功率由质量流量、重力加速度和净水头三者乘积给出这一物理基础出发，推导一种方法，用于在已知水头值和价格的离散预测时域内计算收益，其中使用 $\\,\\eta(H)\\,$ 将机械功率映射到电功率。实施此方法以比较具有不同效率升级函数的情景。\n\n使用以下科学上一致的常数和约定：\n- 密度 $\\,\\rho = \\,1000\\,\\mathrm{kg/m^3}\\,$。\n- 重力加速度 $\\,g = \\,9.81\\,\\mathrm{m/s^2}\\,$。\n- 额定流量 $\\,Q = \\,80\\,\\mathrm{m^3/s}\\,$ 在整个时域内保持不变。\n- 时间步长 $\\,\\Delta t = \\,1\\,\\text{小时}\\,$.\n- 价格单位为美元(USD)每兆瓦时(MWh)，记作 $\\,\\mathrm{USD}/\\mathrm{MWh}\\,$.\n- 以美元(USD)报告总收益，结果为浮点数，四舍五入保留两位小数。\n- 如果净水头低于特定情景的切入阈值，则该时间步的发电量为零。\n\n定义以下三种水头到效率的情景。对所有情景，在评估所示表达式后，通过限制将 $\\,\\eta(H)\\,$ 强制在 $[\\,\\eta_{\\min},\\,\\eta_{\\max}\\,]\\,$ 范围内，并对 $H  H_{cut}$ 的情况设置 $\\eta(H)=0$。\n\n- **情景1: 基准情景**\n  - $\\eta(H) = 0.90 - \\frac{5.0}{H + 10.0}$\n  - $\\eta_{\\max} = 0.90$, $\\eta_{\\min} = 0.70$, 切入水头 $H_{cut} = 8.0\\,\\mathrm{m}$\n- **情景2: 低水头升级**\n  - $\\eta(H) = 0.90 - \\frac{3.0}{H + 10.0}$\n  - $\\eta_{\\max} = 0.90$, $\\eta_{\\min} = 0.70$, 切入水头 $H_{cut} = 6.0\\,\\mathrm{m}$\n- **情景3: 高水头升级**\n  - $\\eta(H) = 0.93 - \\frac{5.0}{H + 10.0}$\n  - $\\eta_{\\max} = 0.93$, $\\eta_{\\min} = 0.70$, 切入水头 $H_{cut} = 8.0\\,\\mathrm{m}$\n\n在三个不同的6小时测试案例上评估您的实施：\n- **案例1**: 净水头序列 $[15, 18, 20, 22, 19, 16]\\,\\mathrm{m}$，价格序列 $[40, 45, 50, 55, 50, 45]\\,\\mathrm{USD/MWh}$。\n- **案例2**: 净水头序列 $[6, 7, 8, 7, 6, 5]\\,\\mathrm{m}$，价格序列 $[30, 32, 35, 33, 31, 30]\\,\\mathrm{USD/MWh}$。\n- **案例3**: 净水头序列 $[50, 55, 60, 65, 60, 55]\\,\\mathrm{m}$，价格序列 $[35, 35, 35, 35, 35, 35]\\,\\mathrm{USD/MWh}$。\n\n您的解决方案应该输出一个包含9个浮点数的列表，代表每个案例下每个情景的总收益。列表的顺序应为 [Case1_Scen1, Case1_Scen2, Case1_Scen3, Case2_Scen1, Case2_Scen2, Case2_Scen3, Case3_Scen1, Case3_Scen2, Case3_Scen3]。",
            "solution": "该问题被评估为有效，因为它科学地基于能量转换原理，问题陈述清晰，提供了所有必要的数据和约束，并且其语言和表述是客观的。它代表了一个标准的、尽管是简化的能源系统建模任务。因此，我们可以着手解决。\n\n解决方案源自物理学和工程学的第一性原理。目标是计算水电站在一个离散时间时域内的总收益，其中考虑了与水头相关的效率和随时间变化的电价。\n\n**1. 机械功率**\n\n水电的基本原理是将水的重力势能转化为机械能，随后再转化为电能。来自水力流的可用机械功率 $P_{mech}$ 由质量流量 $\\dot{m}$、重力加速度 $g$ 和净水头 $H$ 的乘积给出。\n\n质量流量 $\\dot{m}$ 是水密度 $\\rho$ 和体积流量 $Q$ 的乘积：\n$$ \\dot{m} = \\rho Q $$\n给定 $\\rho = 1000\\,\\mathrm{kg/m^3}$ 和 $Q = 80\\,\\mathrm{m^3/s}$，质量流量为：\n$$ \\dot{m} = 1000\\,\\mathrm{kg/m^3} \\times 80\\,\\mathrm{m^3/s} = 80000\\,\\mathrm{kg/s} $$\n\n因此，机械功率为：\n$$ P_{mech}(H) = \\dot{m} g H = \\rho Q g H $$\n该表达式的单位是 $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{m^3/s}) \\cdot (\\mathrm{m/s^2}) \\cdot (\\mathrm{m}) = \\mathrm{kg \\cdot m^2/s^3}$，这对应于功率的标准单位瓦特($\\mathrm{W}$)。使用给定的常数：\n$$ P_{mech}(H) = (1000\\,\\mathrm{kg/m^3}) \\cdot (80\\,\\mathrm{m^3/s}) \\cdot (9.81\\,\\mathrm{m/s^2}) \\cdot H = 784800 \\cdot H\\,\\mathrm{W} $$\n\n**2. 电功率和效率**\n\n从机械功率到电功率 $P_{elec}$ 的转换并非完全高效。这通过电能转换效率 $\\eta$ 来量化，它被给出为净水头 $\\eta(H)$ 的函数。\n$$ P_{elec}(H) = \\eta(H) \\cdot P_{mech}(H) = \\eta(H) \\rho Q g H $$\n\n问题定义了三种情景，每种情景都有一个特定的 $\\eta(H)$ 函数。一般形式为：\n$$ \\eta_{calc}(H) = \\eta_{\\max} - \\frac{k}{H + h_0} $$\n然后，这个计算出的值受到两个约束：\n1.  **限制**：效率必须位于指定的范围 $[\\eta_{\\min}, \\eta_{\\max}]$ 内。因此，有效效率为 $\\eta(H) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H)))$。\n2.  **切入水头**：如果水头 $H$ 低于特定情景的切入阈值 $H_{cut}$，则不产生电力。这等同于在 $H  H_{cut}$ 时设置 $\\eta(H) = 0$。\n\n综合这些，给定水头 $H$ 下的完整效率表达式为：\n$$\n\\eta(H) =\n\\begin{cases}\n    0  \\text{如果 } H  H_{cut} \\\\\n    \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{\\max} - \\frac{k}{H + h_0}))  \\text{如果 } H \\ge H_{cut}\n\\end{cases}\n$$\n\n**3. 离散时域内的能量和收益计算**\n\n问题提供了一个离散的预测时域，具有恒定的时间步长 $\\Delta t = 1\\,\\text{小时}$。对于每个时间步 $i$，我们被给予一个净水头 $H_i$ 和一个电价 $p_i$ (单位为 $\\mathrm{USD/MWh}$)。\n\n首先，我们使用该时间步的水头 $H_i$ 来计算每个时间步 $i$ 的电功率 $P_{elec, i}$。\n$$ P_{elec, i} = \\eta(H_i) \\rho Q g H_i \\quad [\\mathrm{W}] $$\n\n在时间步 $i$ 内产生的能量 $E_i$ 是功率乘以时间步的持续时间 $\\Delta t$。确保单位一致至关重要。价格以 $\\mathrm{USD/MWh}$ 给出，因此我们必须以兆瓦时($\\mathrm{MWh}$)表示能量 $E_i$。\n\n我们通过除以 $10^6$ 将功率从瓦特($\\mathrm{W}$)转换为兆瓦($\\mathrm{MW}$):\n$$ P_{elec, i, \\mathrm{MW}} = \\frac{P_{elec, i, \\mathrm{W}}}{10^6} $$\n\n然后，通过将以 $\\mathrm{MW}$ 为单位的功率乘以以小时为单位的持续时间来计算以 $\\mathrm{MWh}$ 为单位的能量：\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot \\Delta t_{\\mathrm{hours}} $$\n由于 $\\Delta t = 1\\,\\text{小时}$，以 $\\mathrm{MWh}$ 为单位的能量在数值上等于以 $\\mathrm{MW}$ 为单位的功率：\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot 1\\,\\mathrm{h} = \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} $$\n\n时间步 $i$ 的收益 $R_i$ 是该时间步产生的能量(以 $\\mathrm{MWh}$ 计)和价格(以 $\\mathrm{USD/MWh}$ 计)的乘积：\n$$ R_i = E_{i, \\mathrm{MWh}} \\cdot p_i = \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\right) \\cdot p_i $$\n\n**4. 总收益**\n\n给定情景的总收益是预测时域内所有时间步收益的总和。对于一个 $N$ 个时间步的时域：\n$$ R_{total} = \\sum_{i=1}^{N} R_i = \\sum_{i=1}^{N} \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\cdot p_i \\right) $$\n\n**算法摘要**\n\n实现过程将通过遍历三个测试案例中的每一个来进行。对于每个案例，它将遍历三个情景（基准情景、低水头升级情景、高水头升级情景）。\n\n对于每个（案例，情景）对：\n1.  将总收益 $R_{total}$ 初始化为 $0$。\n2.  检索情景参数 $(\\eta_{\\max}, \\eta_{\\min}, k, h_0, H_{cut})$ 和案例数据（水头序列 $\\{H_i\\}$ 和价格序列 $\\{p_i\\}$）。\n3.  对于 $6$ 小时时域中的每个时间步 $i$：\n    a. 检查是否 $H_i \\ge H_{cut}$。如果不是，此步的收益为 $0$。\n    b. 如果是，则计算 $\\eta_{calc}(H_i) = \\eta_{\\max} - k/(H_i + h_0)$。\n    c. 限制该值以获得有效效率 $\\eta(H_i) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H_i)))$。\n    d. 计算以 MWh 为单位的能量：$E_{i, \\mathrm{MWh}} = (\\eta(H_i) \\cdot 1000 \\cdot 80 \\cdot 9.81 \\cdot H_i) / 10^6$。\n    e. 计算该时间步的收益：$R_i = E_{i, \\mathrm{MWh}} \\cdot p_i$。\n    f. 将此收益加到总额中：$R_{total} = R_{total} + R_i$。\n4.  遍历所有时间步后，将最终的 $R_{total}$ 四舍五入到两位小数。\n5.  存储结果。\n\n系统地应用此过程以生成所需的 $9$ 个输出值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates total hydropower revenue for multiple scenarios and test cases.\n    \"\"\"\n    # Define physical constants and plant parameters\n    rho = 1000.0  # Water density in kg/m^3\n    g = 9.81      # Gravitational acceleration in m/s^2\n    Q = 80.0      # Volumetric flow rate in m^3/s\n    delta_t = 1.0 # Timestep length in hours\n\n    # Define the three head-to-efficiency scenarios\n    # Format: { 'name': (eta_max, eta_min, k, h_0, H_cut) }\n    scenarios = {\n        \"Baseline\":          (0.90, 0.70, 5.0, 10.0, 8.0),\n        \"Upgrade Low-Head\":  (0.90, 0.70, 3.0, 10.0, 6.0),\n        \"Upgrade High-Head\": (0.93, 0.70, 5.0, 10.0, 8.0)\n    }\n    # Enforce the specified output order\n    scenario_order = [\"Baseline\", \"Upgrade Low-Head\", \"Upgrade High-Head\"]\n\n    # Define the test cases with head and price series\n    # Format: [ (head_series, price_series) ]\n    test_cases = [\n        # Case 1 (moderate head variability, peaky prices)\n        (np.array([15.0, 18.0, 20.0, 22.0, 19.0, 16.0]), np.array([40.0, 45.0, 50.0, 55.0, 50.0, 45.0])),\n        # Case 2 (near cut-in conditions, modest prices)\n        (np.array([6.0, 7.0, 8.0, 7.0, 6.0, 5.0]), np.array([30.0, 32.0, 35.0, 33.0, 31.0, 30.0])),\n        # Case 3 (high heads, flat prices)\n        (np.array([50.0, 55.0, 60.0, 65.0, 60.0, 55.0]), np.array([35.0, 35.0, 35.0, 35.0, 35.0, 35.0]))\n    ]\n\n    results = []\n\n    # Iterate through each test case\n    for H_series, p_series in test_cases:\n        # Iterate through each scenario in the specified order\n        for scenario_name in scenario_order:\n            eta_max, eta_min, k, h_0, H_cut = scenarios[scenario_name]\n            \n            # Create a boolean mask to identify active hours where head = cut_in_head\n            active_mask = H_series = H_cut\n            \n            # Calculate the raw efficiency based on the formula, avoiding division by non-positive numbers\n            # Note: H_series + h_0 is always positive for the given inputs\n            eta_raw = eta_max - k / (H_series + h_0)\n            \n            # Clamp the efficiency to the [eta_min, eta_max] range\n            eta_clamped = np.clip(eta_raw, eta_min, eta_max)\n            \n            # Apply the cut-in condition: efficiency is zero for inactive hours\n            eta_final = eta_clamped * active_mask\n            \n            # Calculate electrical power in Watts for each timestep\n            # P_elec(W) = eta * rho * Q * g * H\n            P_elec_W = eta_final * rho * Q * g * H_series\n            \n            # Convert power from Watts to Megawatts\n            P_elec_MW = P_elec_W / 1e6\n            \n            # Calculate energy generated in MWh for each timestep\n            # E(MWh) = P(MW) * delta_t(h)\n            E_MWh = P_elec_MW * delta_t\n            \n            # Calculate revenue for each timestep\n            # R(USD) = E(MWh) * Price(USD/MWh)\n            R_series = E_MWh * p_series\n            \n            # Sum the revenues over the horizon to get total revenue\n            total_revenue = np.sum(R_series)\n            \n            # Append the rounded result to the list\n            results.append(round(total_revenue, 2))\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}