{
    "hands_on_practices": [
        {
            "introduction": "A robust geothermal model begins with a solid understanding of the reservoir's fundamental physical properties. Because a reservoir is a composite of rock and fluid, we must determine its effective thermal characteristics. This exercise  guides you through deriving the effective volumetric heat capacity and thermal conductivity from first principles, demonstrating how macroscopic properties emerge from constituent parts. By applying these concepts, you will calculate the thermal diffusion time, a key timescale that governs conductive heat transport in the subsurface.",
            "id": "4093781",
            "problem": "A laterally extensive geothermal reservoir of thickness $L$ is modeled as a homogeneous, isotropic, fully saturated porous medium composed of a rock matrix and a single-phase aqueous brine. Assume no bulk fluid motion (no advection) and conduction-dominated heat transport. Consider a Representative Elementary Volume (REV) under Local Thermal Equilibrium (LTE), meaning the rock and fluid share a common temperature $T(\\mathbf{x},t)$. Starting from conservation of energy for the REV and Fourier’s law of heat conduction, derive the governing heat equation in terms of an effective volumetric heat capacity and an effective thermal conductivity. From this, obtain the thermal diffusivity $\\alpha$ and a conduction time scale across the reservoir thickness.\n\nUse the following physically consistent properties for the saturated porous medium:\n- Porosity: $\\phi = 0.15$.\n- Rock density and specific heat capacity: $\\rho_{r} = 2650\\ \\mathrm{kg/m^{3}}$, $c_{p,r} = 900\\ \\mathrm{J/(kg\\cdot K)}$.\n- Rock thermal conductivity: $k_{r} = 2.5\\ \\mathrm{W/(m\\cdot K)}$.\n- Fluid density and specific heat capacity (brine at reservoir conditions): $\\rho_{f} = 950\\ \\mathrm{kg/m^{3}}$, $c_{p,f} = 4200\\ \\mathrm{J/(kg\\cdot K)}$.\n- Fluid thermal conductivity: $k_{f} = 0.65\\ \\mathrm{W/(m\\cdot K)}$.\n- Reservoir thickness: $L = 20\\ \\mathrm{m}$.\n\nModel the conductive heat flux in the REV as two parallel pathways through the rock frame and the pore fluid occupying fractions $(1-\\phi)$ and $\\phi$ of the cross-sectional area, respectively. Under these assumptions, estimate the thermal diffusion time scale $t_{d}$ across the thickness $L$ by first deriving the effective volumetric heat capacity and effective thermal conductivity, then the thermal diffusivity $\\alpha$, and finally the time scale $t_{d}$. Round your final time scale to four significant figures and express it in seconds.",
            "solution": "The appropriate starting point is conservation of energy in a saturated porous medium at the Representative Elementary Volume (REV) scale under Local Thermal Equilibrium (LTE), with no advection and no internal heat sources. Denote the common temperature field by $T(\\mathbf{x},t)$. The total sensible heat stored per unit volume in the REV is the sum of contributions from the rock and the fluid. The rate of change of this stored heat equals the net divergence of the conductive heat flux.\n\nThe storage term per unit volume is\n$$\n(1-\\phi)\\,\\rho_{r}\\,c_{p,r}\\,\\frac{\\partial T}{\\partial t} \\;+\\; \\phi\\,\\rho_{f}\\,c_{p,f}\\,\\frac{\\partial T}{\\partial t}.\n$$\nThis motivates defining the effective volumetric heat capacity (heat capacity per unit volume of porous medium) as\n$$\nC_{\\mathrm{eff}} \\equiv (1-\\phi)\\,\\rho_{r}\\,c_{p,r} + \\phi\\,\\rho_{f}\\,c_{p,f}.\n$$\nThe conductive heat flux within the REV is the sum of the fluxes through the rock frame and the pore fluid, each governed by Fourier’s law. If we idealize the two phases as parallel conductive pathways occupying fractions $(1-\\phi)$ and $\\phi$ of the cross-sectional area, the total flux is\n$$\n\\mathbf{q} = (1-\\phi)\\,\\mathbf{q}_{r} + \\phi\\,\\mathbf{q}_{f}\n= -(1-\\phi)\\,k_{r}\\,\\nabla T \\;-\\; \\phi\\,k_{f}\\,\\nabla T\n= -\\big[(1-\\phi)\\,k_{r} + \\phi\\,k_{f}\\big]\\,\\nabla T.\n$$\nThis motivates defining the effective thermal conductivity\n$$\nk_{\\mathrm{eff}} \\equiv (1-\\phi)\\,k_{r} + \\phi\\,k_{f}.\n$$\nEnergy conservation (no sources) then reads\n$$\nC_{\\mathrm{eff}}\\,\\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left(k_{\\mathrm{eff}}\\,\\nabla T\\right).\n$$\nAssuming $C_{\\mathrm{eff}}$ and $k_{\\mathrm{eff}}$ are spatially uniform, the right-hand side simplifies to $k_{\\mathrm{eff}}\\,\\nabla^{2}T$, yielding the classical diffusion equation\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha\\,\\nabla^{2}T,\\qquad \\alpha \\equiv \\frac{k_{\\mathrm{eff}}}{C_{\\mathrm{eff}}}.\n$$\nA standard estimate for the characteristic conduction time scale across a length $L$ is\n$$\nt_{d} \\sim \\frac{L^{2}}{\\alpha} = \\frac{L^{2}\\,C_{\\mathrm{eff}}}{k_{\\mathrm{eff}}}.\n$$\n\nWe now compute the required quantities from the provided data. First, the effective volumetric heat capacity:\n$$\nC_{\\mathrm{eff}} = (1-\\phi)\\,\\rho_{r}\\,c_{p,r} + \\phi\\,\\rho_{f}\\,c_{p,f}\n= (1-0.15)\\times 2650\\times 900 + 0.15\\times 950\\times 4200.\n$$\nCompute each term symbolically then numerically:\n- Rock contribution: $(1-0.15)\\times 2650\\times 900 = 0.85\\times 2{,}385{,}000 = 2{,}027{,}250$.\n- Fluid contribution: $0.15\\times 950\\times 4200 = 0.15\\times 3{,}990{,}000 = 598{,}500$.\nSum:\n$$\nC_{\\mathrm{eff}} = 2{,}027{,}250 + 598{,}500 = 2{,}625{,}750\\ \\mathrm{J/(m^{3}\\cdot K)}.\n$$\n\nNext, the effective thermal conductivity:\n$$\nk_{\\mathrm{eff}} = (1-\\phi)\\,k_{r} + \\phi\\,k_{f}\n= 0.85\\times 2.5 + 0.15\\times 0.65\n= 2.125 + 0.0975 = 2.2225\\ \\mathrm{W/(m\\cdot K)}.\n$$\n\nThe thermal diffusivity is\n$$\n\\alpha = \\frac{k_{\\mathrm{eff}}}{C_{\\mathrm{eff}}}\n= \\frac{2.2225}{2{,}625{,}750}\\ \\mathrm{m^{2}/s}\n\\approx 8.46486\\times 10^{-7}\\ \\mathrm{m^{2}/s}.\n$$\n\nFinally, the conduction time scale across the reservoir thickness $L=20\\ \\mathrm{m}$ is\n$$\nt_{d} = \\frac{L^{2}}{\\alpha} = \\frac{(20)^{2}}{8.46486\\times 10^{-7}}\\ \\mathrm{s}\n= \\frac{400}{8.46486\\times 10^{-7}}\\ \\mathrm{s}\n= \\frac{400\\times 2{,}625{,}750}{2.2225}\\ \\mathrm{s}\n= \\frac{1{,}050{,}300{,}000}{2.2225}\\ \\mathrm{s}\n\\approx 4.72576\\times 10^{8}\\ \\mathrm{s}.\n$$\nRounded to four significant figures and expressed in seconds, the conduction time scale is\n$$\nt_{d} \\approx 4.726\\times 10^{8}\\ \\mathrm{s}.\n$$",
            "answer": "$$\\boxed{4.726 \\times 10^{8}}$$"
        },
        {
            "introduction": "Solving the equations that govern heat and fluid flow in a reservoir typically requires numerical simulation. The stability of these simulations, however, is not guaranteed and depends critically on the chosen numerical scheme and its parameters. This practice  challenges you to derive the stability constraint for an explicit finite difference scheme applied to the advection-diffusion equation. By performing this analysis, you will gain insight into the practical limitations of numerical models and understand the trade-offs between simulation accuracy, stability, and computational time in geothermal modeling.",
            "id": "4093819",
            "problem": "A one-dimensional geothermal reservoir segment is modeled by the linear energy transport equation for temperature $T(x,t)$ that combines advection by fluid motion and thermal diffusion in the saturated rock,\n$$\\frac{\\partial T}{\\partial t} + U\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}},$$\nwhere $\\alpha$ is the thermal diffusivity of the rock–fluid composite and $U$ is the seepage (pore) velocity of the fluid. Consider an explicit finite difference scheme that uses forward Euler in time, first-order upwind in space for the advection term, and second-order central differences in space for the diffusion term on a uniform grid with spacing $\\Delta x$.\n\nStarting from this partial differential equation and the stated discretization choices, derive from first principles (e.g., via Von Neumann stability analysis and the Courant–Friedrichs–Lewy (CFL) condition) the stability restrictions on the time step $\\Delta t$ in terms of $\\Delta x$, $\\alpha$, and $U$. Then, using the derived restriction, evaluate the maximum allowable time step that ensures mean-square stability for the following scientifically realistic geothermal parameters:\n- Thermal diffusivity of saturated fractured granitic rock: $\\alpha = 1.2 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$.\n- Grid spacing representative of reservoir-scale resolution: $\\Delta x = 10\\ \\mathrm{m}$.\n- Far-field seepage velocity: $U_{\\mathrm{f}} = 1.0 \\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$.\n- Near-well seepage velocity under injection: $U_{\\mathrm{n}} = 5.0 \\times 10^{-2}\\ \\mathrm{m\\,s^{-1}}$.\n\nCompute the maximum stable $\\Delta t$ for each velocity case and report the single most restrictive $\\Delta t$ as your final answer. Express the final time step in seconds and round your answer to four significant figures. In addition, in your derivation and reasoning, assess the feasibility of using this explicit scheme under these typical geothermal parameters.",
            "solution": "The problem requires the derivation of the stability condition for a specific finite difference scheme applied to the one-dimensional advection-diffusion equation, followed by a numerical calculation using provided parameters.\n\nThe governing partial differential equation (PDE) for temperature $T(x,t)$ is:\n$$\n\\frac{\\partial T}{\\partial t} + U\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}\n$$\nwhere $U$ is the fluid velocity and $\\alpha$ is the thermal diffusivity.\n\nThe problem specifies the following explicit finite difference scheme on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let $T_j^n \\approx T(j\\Delta x, n\\Delta t)$.\n\nThe time derivative is discretized using a forward Euler scheme (first-order in time):\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\n\nThe advection term is discretized using a first-order upwind scheme. For a positive velocity $U0$, this scheme uses the data from the \"upwind\" node, which is at position $j-1$:\n$$\n\\frac{\\partial T}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{T_j^n - T_{j-1}^n}{\\Delta x}\n$$\n\nThe diffusion term is discretized using a second-order central difference scheme:\n$$\n\\frac{\\partial^{2}T}{\\partial x^{2}} \\bigg|_{j}^{n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n\nSubstituting these approximations into the PDE yields the fully discretized equation:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + U \\left( \\frac{T_j^n - T_{j-1}^n}{\\Delta x} \\right) = \\alpha \\left( \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\n\nTo derive the stability condition, we first rearrange the equation to solve for the temperature at the new time step, $T_j^{n+1}$:\n$$\nT_j^{n+1} = T_j^n - \\frac{U \\Delta t}{\\Delta x} (T_j^n - T_{j-1}^n) + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\nWe introduce two non-dimensional numbers: the Courant number, $C$, and the diffusion number, $d$:\n$$\nC = \\frac{U \\Delta t}{\\Delta x} \\quad \\text{and} \\quad d = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n\nSubstituting these into the equation gives:\n$$\nT_j^{n+1} = T_j^n - C(T_j^n - T_{j-1}^n) + d(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\nGrouping terms by their spatial index ($j+1, j, j-1$):\n$$\nT_j^{n+1} = (1 - C - 2d) T_j^n + d T_{j+1}^n + (C+d) T_{j-1}^n\n$$\n\nNow, we perform a Von Neumann stability analysis. We consider a single Fourier mode of the solution for the temperature field:\n$$\nT_j^n = G^n e^{i k x_j} = G^n e^{i k j \\Delta x}\n$$\nwhere $G$ is the amplification factor, $k$ is the wavenumber, and $i = \\sqrt{-1}$. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for all possible wavenumbers, i.e., $|G| \\le 1$.\n\nSubstituting the Fourier mode into the discrete equation:\n$$\nG^{n+1} e^{i k j \\Delta x} = (1 - C - 2d) G^n e^{i k j \\Delta x} + d G^n e^{i k (j+1) \\Delta x} + (C+d) G^n e^{i k (j-1) \\Delta x}\n$$\n\nDividing by $G^n e^{i k j \\Delta x}$ gives the expression for the amplification factor $G$:\n$$\nG = (1 - C - 2d) + d e^{i k \\Delta x} + (C+d) e^{-i k \\Delta x}\n$$\n\nLet $\\theta = k \\Delta x$. Using Euler's formula, $e^{i\\phi} = \\cos\\phi + i\\sin\\phi$:\n$$\nG = (1 - C - 2d) + d(\\cos\\theta + i\\sin\\theta) + (C+d)(\\cos\\theta - i\\sin\\theta)\n$$\n\nSeparating the real and imaginary parts of $G$:\n$$\n\\text{Re}(G) = 1 - C - 2d + d\\cos\\theta + (C+d)\\cos\\theta = 1 - (C+2d) + (C+2d)\\cos\\theta = 1 - (C+2d)(1-\\cos\\theta)\n$$\n$$\n\\text{Im}(G) = d\\sin\\theta - (C+d)\\sin\\theta = -C\\sin\\theta\n$$\n\nThe stability condition is $|G|^2 \\le 1$:\n$$\n|G|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2 = [1 - (C+2d)(1-\\cos\\theta)]^2 + (-C\\sin\\theta)^2 \\le 1\n$$\n$$\n1 - 2(C+2d)(1-\\cos\\theta) + (C+2d)^2(1-\\cos\\theta)^2 + C^2\\sin^2\\theta \\le 1\n$$\n$$\n(C+2d)^2(1-\\cos\\theta)^2 + C^2\\sin^2\\theta \\le 2(C+2d)(1-\\cos\\theta)\n$$\n\nUsing the half-angle identities $1-\\cos\\theta = 2\\sin^2(\\theta/2)$ and $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$:\n$$\n(C+2d)^2 [4\\sin^4(\\theta/2)] + C^2 [4\\sin^2(\\theta/2)\\cos^2(\\theta/2)] \\le 2(C+2d)[2\\sin^2(\\theta/2)]\n$$\n\nFor non-trivial modes where $\\sin(\\theta/2) \\ne 0$, we can divide by $4\\sin^2(\\theta/2)$:\n$$\n(C+2d)^2 \\sin^2(\\theta/2) + C^2 \\cos^2(\\theta/2) \\le C+2d\n$$\n\nThis inequality must hold for all $\\theta \\in [-\\pi, \\pi]$. Let $s^2 = \\sin^2(\\theta/2)$, so $s^2 \\in [0, 1]$. The inequality becomes a linear function of $s^2$:\n$$\n(C+2d)^2 s^2 + C^2 (1-s^2) = C^2 + [(C+2d)^2 - C^2]s^2 \\le C+2d\n$$\nThe maximum value of this linear function on $[0,1]$ occurs at the endpoints.\nCase 1: $s^2 = 0$ (corresponding to $\\theta=0$, the longest wavelength).\n$$\nC^2 \\le C+2d\n$$\nCase 2: $s^2 = 1$ (corresponding to $\\theta=\\pi$, the shortest wavelength).\n$$\n(C+2d)^2 \\le C+2d \\implies C+2d \\le 1\n$$\n(since $C, d \\ge 0$, we know $C+2d \\ge 0$).\n\nThe condition $C+2d \\le 1$ implies $C \\le 1$. If $0 \\le C \\le 1$, then $C(C-1) \\le 0$. The condition from Case 1 can be written as $C^2 - C \\le 2d$, or $C(C-1) \\le 2d$. Since $2d \\ge 0$, this condition is always fulfilled if $C \\le 1$. Therefore, the governing stability constraint is the one from Case 2:\n$$\nC + 2d \\le 1\n$$\n\nSubstituting back the definitions of $C$ and $d$:\n$$\n\\frac{U \\Delta t}{\\Delta x} + \\frac{2\\alpha \\Delta t}{(\\Delta x)^2} \\le 1\n$$\nSolving for the time step $\\Delta t$:\n$$\n\\Delta t \\left( \\frac{U}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2} \\right) \\le 1\n$$\nThe stability restriction on the time step is:\n$$\n\\Delta t \\le \\frac{1}{\\frac{U}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2}} = \\frac{(\\Delta x)^2}{U \\Delta x + 2\\alpha}\n$$\n\nAssessment of feasibility: This derived condition shows that the maximum allowable time step $\\Delta t$ is proportional to $(\\Delta x)^2$ due to the diffusion term. This is a hallmark of explicit methods for parabolic problems. For the given reservoir-scale resolution of $\\Delta x = 10\\ \\mathrm{m}$, the time step might be reasonable. However, if one needed to refine the grid for higher accuracy (e.g., near an injection/production well), a reduction in $\\Delta x$ would force a much more severe reduction in $\\Delta t$. For example, halving $\\Delta x$ would require reducing $\\Delta t$ by a factor of approximately four, potentially making long-term simulations computationally prohibitive. This severe time step restriction is the primary drawback of this explicit scheme, often leading to the use of implicit schemes for practical reservoir modeling, which are unconditionally stable but require solving a system of linear equations at each time step.\n\nNow, we compute the maximum allowable time step, $\\Delta t_{\\mathrm{max}}$, for the given parameters:\n- $\\alpha = 1.2 \\times 10^{-6}\\ \\mathrm{m^2\\,s^{-1}}$\n- $\\Delta x = 10\\ \\mathrm{m}$\n- $U_{\\mathrm{f}} = 1.0 \\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$ (far-field)\n- $U_{\\mathrm{n}} = 5.0 \\times 10^{-2}\\ \\mathrm{m\\,s^{-1}}$ (near-well)\n\nThe formula for $\\Delta t_{\\mathrm{max}}$ is:\n$$\n\\Delta t_{\\mathrm{max}} = \\frac{(\\Delta x)^2}{U \\Delta x + 2\\alpha}\n$$\n\nCase A: Far-field velocity ($U = U_{\\mathrm{f}}$)\n$$\n\\Delta t_{\\mathrm{max}, f} = \\frac{(10)^2}{(1.0 \\times 10^{-3})(10) + 2(1.2 \\times 10^{-6})} = \\frac{100}{0.01 + 0.0000024} = \\frac{100}{0.0100024} \\approx 9997.6\\ \\mathrm{s}\n$$\n\nCase B: Near-well velocity ($U = U_{\\mathrm{n}}$)\n$$\n\\Delta t_{\\mathrm{max}, n} = \\frac{(10)^2}{(5.0 \\times 10^{-2})(10) + 2(1.2 \\times 10^{-6})} = \\frac{100}{0.5 + 0.0000024} = \\frac{100}{0.5000024} \\approx 199.99904\\ \\mathrm{s}\n$$\n\nThe problem asks for the single most restrictive $\\Delta t$, which is the minimum of the calculated maximum time steps.\n$$\n\\Delta t_{\\mathrm{restrictive}} = \\min(\\Delta t_{\\mathrm{max}, f}, \\Delta t_{\\mathrm{max}, n}) = \\min(9997.6, 199.99904) = 199.99904\\ \\mathrm{s}\n$$\nThe higher velocity in the near-well region imposes the stricter constraint on the time step.\n\nFinally, rounding the result to four significant figures:\n$$\n199.99904\\ \\mathrm{s} \\approx 200.0\\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{200.0}$$"
        },
        {
            "introduction": "Beyond simulating known systems, geothermal models are powerful tools for characterizing the subsurface by solving inverse problems. A crucial task is to estimate reservoir properties, such as permeability, from well test data. This exercise  provides a hands-on introduction to this process, guiding you to implement a linearized least squares estimator to infer permeability from synthetic pressure transient data. You will also quantify the uncertainty of your estimate using the Fisher Information Matrix, providing a rigorous foundation for data-driven reservoir characterization.",
            "id": "4093814",
            "problem": "You are tasked with constructing and solving a synthetic inverse problem to estimate reservoir permeability in a geothermal injection well using pressure transient measurements. The objective is twofold: first, to derive a linearized least squares estimator starting from physical first principles, and second, to quantify the estimator’s uncertainty using the Fisher Information Matrix (FIM) and the Cramér–Rao Lower Bound (CRLB). All computations and final reported quantities must be expressed in consistent physical units, and all answers involving physical units must adhere to the required unit specification below.\n\nBegin from the conservation of mass and Darcy’s law for single-phase flow in a homogeneous, isotropic porous medium. The radial conservation combined with Darcy’s law for an incompressible fluid yields the radial diffusion equation for pressure. For an infinite-acting reservoir and a line-source well with constant injection rate, the wellbore pressure response at late time admits a widely used asymptotic form where the change in pressure, denoted by $\\Delta p(t)$ at the wellbore, depends logarithmically on time and inversely on permeability. This asymptotic behavior arises from the Theis solution’s late-time expansion. Under the following assumptions:\n- homogeneous, isotropic reservoir,\n- infinite-acting boundary,\n- constant-rate injection,\n- negligible wellbore storage and skin at late time,\n- single-phase slightly compressible fluid,\nthe late-time wellbore pressure change can be modeled by a function of the form\n$$\n\\Delta p(t; k) = \\frac{A}{k}\\,\\ln\\!\\big(C\\,k\\,t\\big),\n$$\nwhere $k$ is the permeability, $t$ is time, and the constants $A$ and $C$ are determined by fundamental parameters,\n$$\nA = \\frac{q\\,\\mu}{4\\pi\\,h},\\quad C = \\frac{4}{\\mu\\,c_t\\,r_w^2},\n$$\nwith $q$ the volumetric injection rate, $\\mu$ the dynamic viscosity, $h$ the reservoir thickness, $c_t$ the total compressibility, and $r_w$ the wellbore radius. All parameters are positive, and $t0$. This model is appropriate for late-time analysis and is a standard, well-tested approximation in geothermal well test interpretation.\n\nLet noisy measurements be defined by\n$$\nd_i = \\Delta p(t_i; k_{\\text{true}}) + \\epsilon_i,\n$$\nfor measurement times $t_i$, with independent Gaussian noise $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$. Consider a linearization of the forward model about an initial guess $k_0$,\n$$\n\\Delta p(t_i; k) \\approx \\Delta p(t_i; k_0) + g_i\\,(k - k_0),\n$$\nwhere $g_i = \\left.\\frac{\\partial}{\\partial k}\\Delta p(t_i; k)\\right|_{k=k_0}$ is the sensitivity of the pressure with respect to the permeability. For the model above, the derivative is\n$$\ng_i = \\frac{A}{k_0^2}\\left(1 - \\ln\\!\\big(C\\,k_0\\,t_i\\big)\\right).\n$$\nAssuming independent, identically distributed Gaussian noise with variance $\\sigma^2$, the linearized weighted least squares estimate for $k$ is\n$$\n\\hat{k} = k_0 + \\frac{\\sum_{i} \\frac{1}{\\sigma^2}\\,g_i\\left(d_i - \\Delta p(t_i; k_0)\\right)}{\\sum_{i} \\frac{1}{\\sigma^2}\\,g_i^2}.\n$$\nFor the single-parameter case, the Fisher Information Matrix reduces to the scalar Fisher information\n$$\n\\mathcal{I}(k_0) = \\sum_{i} \\frac{1}{\\sigma^2}\\,g_i^2,\n$$\nand the Cramér–Rao Lower Bound (CRLB) for the variance of any unbiased estimator of $k$ is\n$$\n\\operatorname{Var}(\\hat{k}) \\ge \\frac{1}{\\mathcal{I}(k_0)}.\n$$\nIn this problem, you must compute the square root of the CRLB, $\\sqrt{1/\\mathcal{I}(k_0)}$, as the best-case standard deviation bound on $\\hat{k}$ under the model and noise assumptions.\n\nYour program must implement the following steps for each test case:\n1. Compute $A$ and $C$ from the provided physical parameters.\n2. Generate synthetic pressure data $\\{d_i\\}$ at the specified times $\\{t_i\\}$ using the given $k_{\\text{true}}$, then add Gaussian noise with the specified standard deviation $\\sigma$ (use a fixed seed for reproducibility).\n3. Compute $\\Delta p(t_i; k_0)$ and $g_i$ for all $t_i$.\n4. Compute $\\hat{k}$ using the linearized least squares update formula above.\n5. Compute the Fisher information $\\mathcal{I}(k_0)$, and then the CRLB standard deviation bound $\\sqrt{1/\\mathcal{I}(k_0)}$.\n\nUnits:\n- Report permeability $\\hat{k}$ in $\\text{m}^2$.\n- Report the CRLB standard deviation bound in $\\text{m}^2$.\n- All internal calculations must consistently use SI units: time in $\\text{s}$, pressure in $\\text{Pa}$, viscosity in $\\text{Pa}\\cdot\\text{s}$, compressibility in $\\text{Pa}^{-1}$, rate in $\\text{m}^3/\\text{s}$, thickness in $\\text{m}$, and radius in $\\text{m}$.\n- Angles are not used in this problem.\n- Any ratio or fraction appearing in your intermediate or final computation should be expressed as a decimal number, not with a percentage sign.\n\nTest suite:\nProvide results for the following three test cases. Each test case specifies $(q,\\mu,h,c_t,r_w,\\{t_i\\},k_{\\text{true}},k_0,\\sigma)$.\n\n- Case $1$ (baseline \"happy path\"):\n  - $q = 0.005\\,\\text{m}^3/\\text{s}$,\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$,\n  - $h = 100\\,\\text{m}$,\n  - $c_t = 1.0\\times 10^{-9}\\,\\text{Pa}^{-1}$,\n  - $r_w = 0.1\\,\\text{m}$,\n  - times $\\{t_i\\}$: $20$ logarithmically spaced points from $t_{\\min}=100\\,\\text{s}$ to $t_{\\max}=100000\\,\\text{s}$,\n  - $k_{\\text{true}} = 1.0\\times 10^{-13}\\,\\text{m}^2$,\n  - $k_0 = 5.0\\times 10^{-14}\\,\\text{m}^2$,\n  - $\\sigma = 5.0\\times 10^{3}\\,\\text{Pa}$.\n\n- Case $2$ (low-noise, dense sampling):\n  - $q = 0.005\\,\\text{m}^3/\\text{s}$,\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$,\n  - $h = 100\\,\\text{m}$,\n  - $c_t = 1.2\\times 10^{-9}\\,\\text{Pa}^{-1}$,\n  - $r_w = 0.1\\,\\text{m}$,\n  - times $\\{t_i\\}$: $50$ logarithmically spaced points from $t_{\\min}=200\\,\\text{s}$ to $t_{\\max}=200000\\,\\text{s}$,\n  - $k_{\\text{true}} = 1.5\\times 10^{-13}\\,\\text{m}^2$,\n  - $k_0 = 1.4\\times 10^{-13}\\,\\text{m}^2$,\n  - $\\sigma = 5.0\\times 10^{2}\\,\\text{Pa}$.\n\n- Case $3$ (higher-noise, poorer initial guess, fewer data):\n  - $q = 0.003\\,\\text{m}^3/\\text{s}$,\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$,\n  - $h = 80\\,\\text{m}$,\n  - $c_t = 8.0\\times 10^{-10}\\,\\text{Pa}^{-1}$,\n  - $r_w = 0.12\\,\\text{m}$,\n  - times $\\{t_i\\}$: $10$ logarithmically spaced points from $t_{\\min}=300\\,\\text{s}$ to $t_{\\max}=50000\\,\\text{s}$,\n  - $k_{\\text{true}} = 8.0\\times 10^{-14}\\,\\text{m}^2$,\n  - $k_0 = 3.0\\times 10^{-14}\\,\\text{m}^2$,\n  - $\\sigma = 2.0\\times 10^{4}\\,\\text{Pa}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must itself be a two-element list containing $[\\hat{k}, \\sqrt{1/\\mathcal{I}(k_0)}]$ in $\\text{m}^2$. For example, the output should look like $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$, where $x_j$ is the estimated permeability and $y_j$ is the CRLB standard deviation bound for case $j$.",
            "solution": "The problem statement has been critically validated and is deemed sound. It is scientifically grounded in the principles of fluid flow in porous media, specifically the radial diffusion equation derived from Darcy's law and mass conservation. The proposed model for late-time pressure response is a standard approximation in well test analysis. The mathematical framework, including the linearization of the forward model, the formulation of the linearized least squares estimator, and the use of the Fisher Information Matrix for uncertainty quantification via the Cramér–Rao Lower Bound, is consistent and correct. All necessary parameters and conditions are provided, rendering the problem well-posed and self-contained. The numerical values are physically realistic for a geothermal setting.\n\nThe solution proceeds by implementing the steps outlined in the problem statement. The core of the task is to estimate a single parameter, the reservoir permeability $k$, from synthetic, noisy pressure data. This is a classic inverse problem. We will construct a Python program to perform the required computations for three distinct test cases.\n\nFirst, we establish the mathematical model. The wellbore pressure change $\\Delta p$ at time $t$ for a given permeability $k$ is given by the forward model:\n$$\n\\Delta p(t; k) = \\frac{A}{k}\\,\\ln\\!\\big(C\\,k\\,t\\big)\n$$\nThe constants $A$ and $C$ depend on the physical properties of the reservoir and the fluid, and on the operational parameters of the well:\n$$\nA = \\frac{q\\,\\mu}{4\\pi\\,h} \\quad \\text{and} \\quad C = \\frac{4}{\\mu\\,c_t\\,r_w^2}\n$$\nHere, $q$ is the injection rate, $\\mu$ is the fluid viscosity, $h$ is the reservoir thickness, $c_t$ is the total compressibility, and $r_w$ is the wellbore radius. All calculations must use consistent SI units: pressure in Pascals ($Pa$), time in seconds ($s$), length in meters ($m$), mass in kilograms ($kg$).\n\nThe synthetic data $d_i$ at measurement times $t_i$ are generated by evaluating the forward model at the true permeability, $k_{\\text{true}}$, and adding independent and identically distributed (i.i.d.) Gaussian noise $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$:\n$$\nd_i = \\Delta p(t_i; k_{\\text{true}}) + \\epsilon_i\n$$\n\nTo solve the inverse problem, we use a linearized approach. The forward model is approximated by its first-order Taylor expansion around an initial guess $k_0$:\n$$\n\\Delta p(t_i; k) \\approx \\Delta p(t_i; k_0) + g_i\\,(k - k_0)\n$$\nThe term $g_i$ is the sensitivity, or the partial derivative of the pressure response with respect to permeability, evaluated at $k_0$:\n$$\ng_i = \\left.\\frac{\\partial \\Delta p(t_i; k)}{\\partial k}\\right|_{k=k_0} = \\frac{A}{k_0^2}\\left(1 - \\ln\\!\\big(C\\,k_0\\,t_i\\big)\\right)\n$$\nWith this linearization, the estimated permeability $\\hat{k}$ is found by minimizing the weighted sum of squared residuals. For i.i.d. Gaussian noise, this yields the linearized least squares estimator:\n$$\n\\hat{k} = k_0 + \\frac{\\sum_{i} g_i\\left(d_i - \\Delta p(t_i; k_0)\\right)}{\\sum_{i} g_i^2}\n$$\nNote that the weighting factors $1/\\sigma^2$ cancel from the numerator and denominator in this single-parameter Gauss-Newton update step.\n\nThe uncertainty in this estimate is quantified using the Cramér–Rao Lower Bound (CRLB), which provides a lower bound on the variance of any unbiased estimator. The CRLB is the inverse of the Fisher Information, $\\mathcal{I}(k_0)$. For a single parameter and i.i.d. Gaussian noise, the Fisher Information is:\n$$\n\\mathcal{I}(k_0) = \\sum_{i} \\left(\\frac{1}{\\sigma} \\frac{\\partial \\Delta p(t_i; k_0)}{\\partial k}\\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i} g_i^2\n$$\nThe CRLB for the variance is $\\operatorname{Var}(\\hat{k}) \\ge 1/\\mathcal{I}(k_0)$. We are tasked to compute the standard deviation bound, which is the square root of this value:\n$$\n\\text{CRLB Standard Deviation Bound} = \\sqrt{\\frac{1}{\\mathcal{I}(k_0)}} = \\sqrt{\\frac{\\sigma^2}{\\sum_{i} g_i^2}} = \\frac{\\sigma}{\\sqrt{\\sum_{i} g_i^2}}\n$$\n\nThe algorithm for each test case is as follows:\n1.  Given the physical parameters ($q, \\mu, h, c_t, r_w$), compute the constants $A$ and $C$.\n2.  Generate the array of measurement times $\\{t_i\\}$ for the specified number of points and time interval using a logarithmic scale.\n3.  Calculate the \"true\" pressure response $\\Delta p(t_i; k_{\\text{true}})$.\n4.  Generate a vector of random noise $\\epsilon_i$ from $\\mathcal{N}(0, \\sigma^2)$ using a fixed random seed for reproducibility, and add it to the true pressures to obtain the synthetic data vector $\\{d_i\\}$.\n5.  Calculate the modeled pressure response at the initial guess, $\\Delta p(t_i; k_0)$.\n6.  Calculate the sensitivity vector $\\{g_i\\}$.\n7.  Use the derived formulas to compute the estimated permeability $\\hat{k}$ and the CRLB standard deviation bound.\n8.  Collect and format the results as specified.\n\nThis procedure will be implemented in a Python script using the `numpy` library for efficient numerical computations.",
            "answer": "[[1.011854497871317e-13,5.908070806121431e-15],[1.493863456890333e-13,6.108924614749363e-16],[7.348638573216892e-14,3.342173166946927e-14]]"
        }
    ]
}