{
    "hands_on_practices": [
        {
            "introduction": "将非线性的发电机成本函数线性化是能源系统优化的关键一步。这个练习将几何上的线性插值思想，转化为凸组合的代数表达形式，这不仅加深了我们对分段线性近似本质的理解，也为在数学规划模型中表示这些函数奠定了基础。通过这个练习，你将推导并应用这一核心公式 。",
            "id": "4111598",
            "problem": "考虑单个火力发电机组，其生产成本是输出电功率的函数，该函数被建模为一个凸增函数 $C(p)$，其中 $p$ 表示功率，单位为兆瓦 (MW)。在规划模型中，一种常见的做法是通过选择一组有限的断点 $\\{p_i\\}$，并使用连接点 $\\{(p_i,C(p_i))\\}$ 的直线段来构造 $C(p)$ 的分段线性近似。\n\n假设可用断点为 $p_i \\in \\{50,75,100\\}$ MW，对应的精确成本（以货币单位计）为 $C(50)=5000$、$C(75)=7000$ 和 $C(100)=9500$。对于位于两个相邻断点之间的中间功率 $p$，分段线性近似规定在连接相邻断点值的直线段上评估成本。\n\n从实值函数凸性的定义出发，并利用区间 $[p_a,p_b]$ 中的任何 $p$ 都可以写成 $p_a$ 和 $p_b$ 的凸组合这一事实，推导出在 $[p_a,p_b]$ 上 $C(p)$ 的分段线性近似表达式，该表达式仅用凸组合权重以及 $C(p_a)$ 和 $C(p_b)$ 的值表示。然后应用您的推导，使用相邻断点 $p_a=75$ MW 和 $p_b=100$ MW 以及上述相应成本，计算 $p=80$ MW 时的近似成本 $c$。\n\n最终成本以货币单位表示。无需四舍五入。",
            "solution": "用户要求我解决一个关于生产成本函数的分段线性近似问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**第1步：提取已知信息**\n- 生产成本函数为 $C(p)$，它是一个凸增函数。\n- $p$ 是输出电功率，单位为兆瓦 (MW)。\n- $C(p)$ 的近似是一个分段线性函数，由一组连接点 $(p_i, C(p_i))$ 的断点 $\\{p_i\\}$ 构成。\n- 可用断点为 $p_i \\in \\{50, 75, 100\\}$ MW。\n- 相应的成本为 $C(50)=5000$，$C(75)=7000$ 和 $C(100)=9500$ 货币单位。\n- 对于中间功率 $p \\in [p_a, p_b]$，近似成本在点 $(p_a, C(p_a))$ 和 $(p_b, C(p_b))$ 之间的直线段上进行评估。\n- 第一个任务是推导在 $[p_a, p_b]$ 上用凸组合权重表示的分段线性近似表达式。\n- 第二个任务是使用相邻断点 $p_a=75$ MW 和 $p_b=100$ MW 计算 $p=80$ MW 时的近似成本 $c$。\n\n**第2步：使用提取的已知信息进行验证**\n- **科学依据：** 该问题的表述在能源系统工程和优化领域是标准的。凸成本函数及其分段线性近似是对火力发电机组调度进行建模的基本工具。\n- **适定性：** 问题定义明确。它提供了所有必要的信息，并要求进行特定的推导和计算。给定的数据是一致的；成本是功率的增函数（对于 $50, 75, 100$，有 $5000, 7000, 9500$）。这些离散点也表现出凸性，因为从 $p=50$ 到 $p=75$ 的线段斜率为 $\\frac{7000-5000}{75-50} = \\frac{2000}{25} = 80$，而从 $p=75$ 到 $p=100$ 的线段斜率为 $\\frac{9500-7000}{100-75} = \\frac{2500}{25} = 100$。由于 $80  100$，斜率是递增的，这与凸函数一致。\n- **客观性：** 问题使用精确的数学和技术语言陈述，没有主观性或歧义。\n\n该问题没有任何指令中列出的无效缺陷。它在科学上是合理的、完整的且适定的。\n\n**第3步：结论和行动**\n问题有效。我将继续进行解答。\n\n###\n解决方案包括两部分：通用公式的推导及其在特定案例中的应用。\n\n**第1部分：分段线性近似的推导**\n\n设 $\\tilde{C}(p)$ 是成本函数 $C(p)$ 在区间 $[p_a, p_b]$ 上的分段线性近似。根据定义，$\\tilde{C}(p)$ 是连接点 $(p_a, C(p_a))$ 和 $(p_b, C(p_b))$ 的直线段上的值。\n\n这条直线的方程可以用两点式表示。对于任何功率水平 $p \\in [p_a, p_b]$，近似成本 $\\tilde{C}(p)$ 在这条直线上，因此必须满足：\n$$\n\\frac{\\tilde{C}(p) - C(p_a)}{p - p_a} = \\frac{C(p_b) - C(p_a)}{p_b - p_a}\n$$\n求解 $\\tilde{C}(p)$，我们得到：\n$$\n\\tilde{C}(p) = C(p_a) + \\left( \\frac{C(p_b) - C(p_a)}{p_b - p_a} \\right) (p - p_a)\n$$\n问题要求此表达式用凸组合权重来表示。区间 $[p_a, p_b]$ 中的任何点 $p$ 都可以唯一地表示为端点 $p_a$ 和 $p_b$ 的凸组合：\n$$\np = (1-\\lambda) p_a + \\lambda p_b \\quad \\text{for some } \\lambda \\in [0, 1]\n$$\n我们可以通过重新整理方程来找到权重 $\\lambda$ 的表达式：\n$$\np - p_a = (1-\\lambda) p_a + \\lambda p_b - p_a = \\lambda p_b - \\lambda p_a = \\lambda (p_b - p_a)\n$$\n假设 $p_a \\neq p_b$，我们可以解出 $\\lambda$：\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a}\n$$\n项 $(1-\\lambda)$ 是另一个权重：\n$$\n1 - \\lambda = 1 - \\frac{p - p_a}{p_b - p_a} = \\frac{(p_b - p_a) - (p - p_a)}{p_b - p_a} = \\frac{p_b - p}{p_b - p_a}\n$$\n现在，我们将 $\\lambda$ 代入 $\\tilde{C}(p)$ 的表达式中：\n$$\n\\tilde{C}(p) = C(p_a) + (C(p_b) - C(p_a)) \\lambda\n$$\n展开各项可得：\n$$\n\\tilde{C}(p) = C(p_a) - \\lambda C(p_a) + \\lambda C(p_b)\n$$\n因式分解得到以凸组合权重 $(1-\\lambda)$ 和 $\\lambda$ 表示的最终表达式：\n$$\n\\tilde{C}(p) = (1-\\lambda) C(p_a) + \\lambda C(p_b)\n$$\n这就是所要求的推导。它表明，在 $p$ 处的线性近似值是成本 $C(p_a)$ 和 $C(p_b)$ 的凸组合，其组合方式与 $p$ 是功率水平 $p_a$ 和 $p_b$ 的凸组合的方式相同。由于原始函数 $C(p)$ 是凸函数，因此成立 $C(p) = C((1-\\lambda)p_a + \\lambda p_b) \\le (1-\\lambda)C(p_a)+\\lambda C(p_b) = \\tilde{C}(p)$，这意味着分段线性近似为断点之间的真实成本提供了一个上界。\n\n**第2部分：近似成本的计算**\n\n我们被要求计算功率输出为 $p = 80$ MW 时的近似成本 $c$。指定的相邻断点是 $p_a = 75$ MW 和 $p_b = 100$ MW。给出的相应成本是 $C(p_a) = C(75) = 7000$ 和 $C(p_b) = C(100) = 9500$。\n\n首先，我们计算凸组合权重 $\\lambda$ 的值：\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a} = \\frac{80 - 75}{100 - 75} = \\frac{5}{25} = \\frac{1}{5}\n$$\n因此，另一个权重是 $1-\\lambda = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n\n现在，我们使用推导出的公式来找到近似成本 $c = \\tilde{C}(80)$：\n$$\nc = (1-\\lambda) C(75) + \\lambda C(100)\n$$\n代入数值：\n$$\nc = \\left(\\frac{4}{5}\\right) (7000) + \\left(\\frac{1}{5}\\right) (9500)\n$$\n$$\nc = (0.8)(7000) + (0.2)(9500)\n$$\n$c = 5600 + 1900$\n$c = 7500$\n生产 $80$ MW 功率的近似成本是 $7500$ 货币单位。",
            "answer": "$$\n\\boxed{7500}\n$$"
        },
        {
            "introduction": "任何模型简化都伴随着精度的损失，分段线性近似也不例外。评估这种近似带来的误差是模型验证的关键环节，它能帮助我们判断模型是否足够精确以用于决策。本练习通过一个二次成本函数的具体案例，让你亲手计算近似成本与真实成本之间的差异，从而直观地理解近似误差的来源和大小 。",
            "id": "4111564",
            "problem": "考虑一个火力发电机组，其小时生产成本由一个关于有功功率输出 $p$（单位为 $\\text{MW}$）的凸二次函数建模，形式为 $C(p)=a+bp+cp^{2}$，其中 $a$ 是空载成本，单位为 $\\$ / \\text{h}$，$b$ 的单位为 $\\$ / (\\text{MWh})$，$c$ 的单位为 $\\$ / (\\text{MW}^{2}\\,\\text{h})$。在许多使用混合整数线性规划 (MILP) 的运行计划模型中，这个凸成本函数被近似为一个分段线性函数，该函数通过连接一组断点 $\\{p_{i}\\}$ 上的点 $\\{(p_{i},C(p_{i}))\\}$ 构建。\n\n设 $a=100$，$b=15$，$c=0.05$。考虑从 $0\\,\\text{MW}$ 到 $100\\,\\text{MW}$ 每隔 $25\\,\\text{MW}$ 设置一个断点，即 $p_{i}\\in\\{0,25,50,75,100\\}$。定义分段线性插值函数 $C_{\\mathrm{PL}}(p)$，对于 $p\\in[p_{i},p_{i+1}]$，该函数等于相邻点 $(p_{i},C(p_{i}))$ 和 $(p_{i+1},C(p_{i+1}))$ 之间的线段。仅使用 $C(p)$ 的凸性定义、线性插值以及凸函数图像的弦位于图像之上或与之重合的事实，完成以下任务：\n\n- 计算在 $p=37.5$ 和 $p=87.5$ 时的 $C_{\\mathrm{PL}}(p)$ 和 $C(p)$。\n- 由此计算绝对近似误差 $|C_{\\mathrm{PL}}(37.5)-C(37.5)|$ 和 $|C_{\\mathrm{PL}}(87.5)-C(87.5)|$。\n- 将这两个绝对误差中的最大值作为一个标量报告。\n\n以 $\\$ / \\text{h}$ 为单位表示你的最终答案，并将答案四舍五入到五位有效数字。",
            "solution": "该问题经验证具有科学依据、提法明确且客观。这是非线性函数分段线性近似的标准练习，是能源系统优化中的常用技术。所有必要的数据和定义均已提供，不存在矛盾或模糊之处。\n\n小时生产成本函数由下式给出：\n$$C(p) = a+bp+cp^{2}$$\n系数为 $a=100\\,\\$/\\text{h}$，$b=15\\,\\$/(\\text{MWh})$ 和 $c=0.05\\,\\$/(\\text{MW}^{2}\\,\\text{h})$。功率输出 $p$ 的单位为 $\\text{MW}$。\n代入系数，成本函数为：\n$$C(p) = 100 + 15p + 0.05p^{2}$$\n该函数的二阶导数为 $C''(p) = 2c = 2(0.05) = 0.1$，为正值。这证实了 $C(p)$ 是一个严格凸函数。对于凸函数，连接其图像上任意两点的弦都位于图像之上或与之重合。因此，分段线性近似 $C_{\\mathrm{PL}}(p)$ 将始终大于或等于真实成本 $C(p)$，即 $C_{\\mathrm{PL}}(p) \\ge C(p)$。因此，近似误差为 $C_{\\mathrm{PL}}(p) - C(p)$，绝对误差为 $|C_{\\mathrm{PL}}(p) - C(p)| = C_{\\mathrm{PL}}(p) - C(p)$。\n\n分段线性近似的断点为 $p_{i} \\in \\{0, 25, 50, 75, 100\\}$。我们首先计算这些断点处的真实成本。\n$$C(0) = 100 + 15(0) + 0.05(0)^{2} = 100$$\n$$C(25) = 100 + 15(25) + 0.05(25)^{2} = 100 + 375 + 0.05(625) = 475 + 31.25 = 506.25$$\n$$C(50) = 100 + 15(50) + 0.05(50)^{2} = 100 + 750 + 0.05(2500) = 850 + 125 = 975$$\n$$C(75) = 100 + 15(75) + 0.05(75)^{2} = 100 + 1125 + 0.05(5625) = 1225 + 281.25 = 1506.25$$\n$$C(100) = 100 + 15(100) + 0.05(100)^{2} = 100 + 1500 + 0.05(10000) = 1600 + 500 = 2100$$\n所有成本值的单位都是 $\\$ / \\text{h}$。\n\n任务是计算在 $p = 37.5$ 和 $p = 87.5$ 这两个点上的近似误差。\n\n首先，考虑 $p = 37.5\\,\\text{MW}$。\n该点位于区间 $[25, 50]$ 内。分段线性近似值 $C_{\\mathrm{PL}}(37.5)$ 是通过在点 $(25, C(25))$ 和 $(50, C(50))$ 之間进行线性插值得到的。这两个点是 $(25, 506.25)$ 和 $(50, 975)$。\n对于区间 $[p_i, p_{i+1}]$ 内的一点 $p$，线性插值的通用公式为：\n$$C_{\\mathrm{PL}}(p) = C(p_i) + \\frac{C(p_{i+1}) - C(p_i)}{p_{i+1} - p_i}(p - p_i)$$\n对于 $p=37.5$，$p_i=25$，$p_{i+1}=50$：\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + \\frac{975 - 506.25}{50 - 25}(37.5 - 25)$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + \\frac{468.75}{25}(12.5) = 506.25 + 18.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + 234.375 = 740.625$$\n现在，我们计算真实成本 $C(37.5)$：\n$$C(37.5) = 100 + 15(37.5) + 0.05(37.5)^{2} = 100 + 562.5 + 0.05(1406.25)$$\n$$C(37.5) = 662.5 + 70.3125 = 732.8125$$\n在 $p = 37.5$ 处的绝对近似误差为：\n$$|C_{\\mathrm{PL}}(37.5) - C(37.5)| = |740.625 - 732.8125| = 7.8125$$\n\n接下来，考虑 $p=87.5\\,\\text{MW}$。\n该点位于区间 $[75, 100]$ 内。分段线性近似值 $C_{\\mathrm{PL}}(87.5)$ 是通过在点 $(75, C(75))$ 和 $(100, C(100))$ 之间进行线性插值得到的。这两个点是 $(75, 1506.25)$ 和 $(100, 2100)$。\n对于 $p=87.5$，$p_i=75$，$p_{i+1}=100$：\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + \\frac{2100 - 1506.25}{100 - 75}(87.5 - 75)$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + \\frac{593.75}{25}(12.5) = 1506.25 + 23.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + 296.875 = 1803.125$$\n现在，我们计算真实成本 $C(87.5)$：\n$$C(87.5) = 100 + 15(87.5) + 0.05(87.5)^{2} = 100 + 1312.5 + 0.05(7656.25)$$\n$$C(87.5) = 1412.5 + 382.8125 = 1795.3125$$\n在 $p = 87.5$ 处的绝对近似误差为：\n$$|C_{\\mathrm{PL}}(87.5) - C(87.5)| = |1803.125 - 1795.3125| = 7.8125$$\n\n最后，我们求这两个绝对误差的最大值。\n$$\\text{Max Error} = \\max(|C_{\\mathrm{PL}}(37.5) - C(37.5)|, |C_{\\mathrm{PL}}(87.5) - C(87.5)|)$$\n$$\\text{Max Error} = \\max(7.8125, 7.8125) = 7.8125$$\n最大误差为 $7.8125\\,\\$/\\text{h}$。问题要求答案四舍五入到五位有效数字。数字 $7.8125$ 已经有五位有效数字（$7, 8, 1, 2, 5$），所以不需要四舍五入。\n对于二次函数，在任何给定宽度的区间内，最大误差出现在中点处，其值 $\\frac{c}{4}(\\Delta p)^2$ 仅取决于二次项系数 $c$ 和区间宽度 $\\Delta p$。由于两个评估点都是宽度同为 $\\Delta p = 25$ 的区间的中点，因此误差是相同的。\n$\\frac{0.05}{4}(25)^2 = 0.0125 \\times 625 = 7.8125$，这证实了详细计算的结果。",
            "answer": "$$\n\\boxed{7.8125}\n$$"
        },
        {
            "introduction": "学习分段线性成本模型的最终目的是将其应用于解决实际的能源系统优化问题。这个综合性练习将我们前面学习的成本近似方法置于一个更复杂的场景中——考虑了发电机爬坡限制的多周期经济调度问题。通过求解此问题，你将体验到如何平衡不同发电机的经济性与物理运行约束，这是电力市场运行和规划中的核心挑战 。",
            "id": "4111606",
            "problem": "电力系统运营商求解经济调度（ED）问题，以最小化总的火电生产成本，同时满足每个时段的外生需求，并遵循发电机组的运行约束。该 ED 问题在两个连续时段内进行建模，并包含跨时段的斜坡限制。每台发电机的生产成本由一个凸分段线性逼近（PLA）表示，其中总成本是具有递增边际成本的线性成本块的总和。\n\n考虑两台火力发电机组，索引为 $i \\in \\{1,2\\}$，在两个时段内运行，索引为 $t \\in \\{1,2\\}$。令 $p_{i,t}$ 表示发电机组 $i$ 在时段 $t$ 的出力（单位：兆瓦）。每台发电机组 $i$ 有两个 PLA 成本块 $k \\in \\{1,2\\}$，其成本块容量为 $s_{i,k}$（单位：兆瓦），恒定边际成本为 $c_{i,k}$（单位：美元/兆瓦时），且 $c_{i,1}  c_{i,2}$ 以表示凸性。令 $x_{i,t,k}$ 表示在时段 $t$ 分配给发电机组 $i$ 的成本块 $k$ 的出力，满足 $0 \\leq x_{i,t,k} \\leq s_{i,k}$ 且 $p_{i,t} = x_{i,t,1} + x_{i,t,2}$。两个时段内的系统总成本为\n$$\nC_{\\text{total}} = \\sum_{t=1}^{2} \\sum_{i=1}^{2} \\sum_{k=1}^{2} c_{i,k}\\, x_{i,t,k}.\n$$\n系统必须满足每个时段的需求、发电机组容量以及跨时段斜坡约束：\n- 每个时段 $t$ 的需求平衡：$\\sum_{i=1}^{2} p_{i,t} = D_t$。\n- 成本块边界：$0 \\leq x_{i,t,k} \\leq s_{i,k}$。\n- 聚合：$p_{i,t} = \\sum_{k=1}^{2} x_{i,t,k}$。\n- 斜坡约束：$|p_{i,2} - p_{i,1}| \\leq R_i$。\n\n数据如下：\n- 发电机组 1：$s_{1,1} = 50$, $s_{1,2} = 50$, $c_{1,1} = 10 \\text{ \\$/MWh}$, $c_{1,2} = 30 \\text{ \\$/MWh}$, $R_1 = 30$。\n- 发电机组 2：$s_{2,1} = 30$, $s_{2,2} = 70$, $c_{2,1} = 15 \\text{ \\$/MWh}$, $c_{2,2} = 25 \\text{ \\$/MWh}$, $R_2 = 50$。\n- 需求：$D_1 = 80$, $D_2 = 140$。\n\n假设两台发电机组均在线，没有最小出力水平限制，且所有成本块在两个时段内都可用。在给定的 PLA 和斜坡约束下，求解 ED 问题以确定最优调度 $(p_{1,1}, p_{2,1}, p_{1,2}, p_{2,2})$ 和系统总成本 $C_{\\text{total}}$。\n\n报告以兆瓦（MW）为单位的发电量和以美元（$）为单位的总成本。使用精确计算，不要四舍五入。将最终答案以有序元组 $(p_{1,1}, p_{2,1}, p_{1,2}, p_{2,2}, C_{\\text{total}})$ 的形式提供。",
            "solution": "用户提供了一个定义明确的经济调度问题。\n\n### 步骤 1：提取已知条件\n- **发电机组**：$i \\in \\{1,2\\}$\n- **时段**：$t \\in \\{1,2\\}$\n- **成本块**：$k \\in \\{1,2\\}$\n- **发电机组 1 数据**：\n  - 成本块容量：$s_{1,1} = 50$ MW, $s_{1,2} = 50$ MW\n  - 边际成本：$c_{1,1} = 10 \\text{ \\$/MWh}$, $c_{1,2} = 30 \\text{ \\$/MWh}$\n  - 斜坡限制：$R_1 = 30$ MW\n- **发电机组 2 数据**：\n  - 成本块容量：$s_{2,1} = 30$ MW, $s_{2,2} = 70$ MW\n  - 边际成本：$c_{2,1} = 15 \\text{ \\$/MWh}$, $c_{2,2} = 25 \\text{ \\$/MWh}$\n  - 斜坡限制：$R_2 = 50$ MW\n- **需求**：$D_1 = 80$ MW, $D_2 = 140$ MW\n- **变量**：$p_{i,t}$ (总发电量), $x_{i,t,k}$ (分块发电量)\n- **目标**：最小化 $C_{\\text{total}} = \\sum_{t=1}^{2} \\sum_{i=1}^{2} \\sum_{k=1}^{2} c_{i,k}\\, x_{i,t,k}$\n- **约束**：\n  - 需求平衡：$\\sum_{i=1}^{2} p_{i,t} = D_t$\n  - 成本块边界：$0 \\leq x_{i,t,k} \\leq s_{i,k}$\n  - 聚合：$p_{i,t} = \\sum_{k=1}^{2} x_{i,t,k}$\n  - 斜坡约束：$|p_{i,2} - p_{i,1}| \\leq R_i$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是一个多时段经济调度问题的标准线性规划模型，是电力系统工程中的一个基本课题。所有数据和常数都已提供，约束条件一致且定义明确。系统总容量为 $s_{1,1} + s_{1,2} + s_{2,1} + s_{2,2} = 50 + 50 + 30 + 70 = 200$ MW，足以满足 $D_1=80$ MW 和 $D_2=140$ MW 的需求。该问题具有科学依据，是适定的、客观的。由于存在跨时段斜坡约束，该问题并非微不足道。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 求解推导\n\n这是一个线性规划问题。最优解可以通过首先求解不考虑跨时段斜坡约束的问题，然后以最小的额外成本调整调度来满足这些约束来找到。\n\n首先，我们根据发电机组各成本块的边际成本建立调度优先级顺序（merit order）：\n1.  发电机组 1，成本块 1：$c_{1,1} = 10 \\text{ \\$/MWh}$，容量上限 $s_{1,1}=50$ MW。\n2.  发电机组 2，成本块 1：$c_{2,1} = 15 \\text{ \\$/MWh}$，容量上限 $s_{2,1}=30$ MW。\n3.  发电机组 2，成本块 2：$c_{2,2} = 25 \\text{ \\$/MWh}$，容量上限 $s_{2,2}=70$ MW。\n4.  发电机组 1，成本块 2：$c_{1,2} = 30 \\text{ \\$/MWh}$，容量上限 $s_{1,2}=50$ MW。\n\n**第 1 部分：无约束调度（忽略斜坡约束）**\n\n我们对每个时段独立地按优先级顺序调度发电机组以满足需求。\n\n**时段 1 ($t=1$, $D_1=80$ MW):**\n1.  完全调度发电机组 1 的成本块 1：$x_{1,1,1} = 50$ MW。剩余需求：$80 - 50 = 30$ MW。\n2.  调度发电机组 2 的成本块 1 以满足剩余需求：$x_{2,1,1} = 30$ MW。剩余需求：$30 - 30 = 0$ MW。\n时段 1 的调度为：\n- $p_{1,1} = x_{1,1,1} + x_{1,1,2} = 50 + 0 = 50$ MW。\n- $p_{2,1} = x_{2,1,1} + x_{2,1,2} = 30 + 0 = 30$ MW。\n检验：$p_{1,1} + p_{2,1} = 50 + 30 = 80$ MW，等于 $D_1$。\n\n**时段 2 ($t=2$, $D_2=140$ MW):**\n1.  完全调度发电机组 1 的成本块 1：$x_{1,2,1} = 50$ MW。剩余需求：$140 - 50 = 90$ MW。\n2.  完全调度发电机组 2 的成本块 1：$x_{2,2,1} = 30$ MW。剩余需求：$90 - 30 = 60$ MW。\n3.  调度发电机组 2 的成本块 2 以满足剩余需求：$x_{2,2,2} = 60$ MW。剩余需求：$60 - 60 = 0$ MW。\n时段 2 的调度为：\n- $p_{1,2} = x_{1,2,1} + x_{1,2,2} = 50 + 0 = 50$ MW。\n- $p_{2,2} = x_{2,2,1} + x_{2,2,2} = 30 + 60 = 90$ MW。\n检验：$p_{1,2} + p_{2,2} = 50 + 90 = 140$ MW，等于 $D_2$。\n\n**第 2 部分：检查斜坡约束**\n\n现在，我们检查这个无约束解是否满足斜坡约束 $|p_{i,2} - p_{i,1}| \\leq R_i$。\n- **发电机组 1**：$|p_{1,2} - p_{1,1}| = |50 - 50| = 0$ MW。限制为 $R_1=30$ MW。由于 $0 \\leq 30$，该约束得到满足。\n- **发电机组 2**：$|p_{2,2} - p_{2,1}| = |90 - 30| = 60$ MW。限制为 $R_2=50$ MW。由于 $60 > 50$，该约束被**违反**。\n\n**第 3 部分：重新调度以满足斜坡约束**\n\n发电机组 2 从 $30$ MW 到 $90$ MW 的斜坡爬升超过了其 $50$ MW 的限制。违背量为 $p_{2,2} - p_{2,1} - R_2 = 60 - 50 = 10$ MW。为了解决这个问题，我们必须调整调度，使差值 $p_{2,2} - p_{2,1}$ 减少至少 $10$ MW，同时产生尽可能小的额外成本。这可以通过以下方式实现：\n(a) 增加 $p_{2,1}$（并减少 $p_{1,1}$）。\n(b) 减少 $p_{2,2}$（并增加 $p_{1,2}$）。\n(c) 两者结合。\n\n我们来分析这些调整的边际成本。\n- **时段 1 的调整**：要将 $p_{2,1}$ 增加 1 MW，我们必须将 $p_{1,1}$ 减少 1 MW。这意味着将发电量从发电机组 1 转移到发电机组 2。在无约束解中，发电机组 1 正在使用其最便宜的成本块（$c_{1,1}=10$），而发电机组 2 已经用尽了其第一个成本块（$c_{2,1}=15$），需要使用其第二个成本块（$c_{2,2}=25$）。因此，这种转移是用成本为 25 的发电量替换成本为 10 的发电量。每转移 1 MW，成本增加为 $25 - 10 = 15 \\text{ \\$/MWh}$。\n- **时段 2 的调整**：要将 $p_{2,2}$ 减少 1 MW，我们必须将 $p_{1,2}$ 增加 1 MW。这意味着将发电量从发电机组 2 转移到发电机组 1。在无约束解中，边际机组是发电机组 2 的成本块 2（$c_{2,2}=25$）。下一个最便宜的可用机组是发电机组 1 的成本块 2（$c_{1,2}=30$）。这种转移是用成本为 30 的发电量替换成本为 25 的发电量。每转移 1 MW，成本增加为 $30 - 25 = 5 \\text{ \\$/MWh}$。\n\n为了以最小成本满足约束 $p_{2,2} - p_{2,1} \\le 50$，我们需要将差值 $p_{2,2} - p_{2,1}$ 从 $60$ 减少到 $50$，减少量为 $10$。我们应该选择最便宜的调整方案。时段 2 的调整成本为 $5 \\text{ \\$/MWh}$，而时段 1 的调整成本为 $15 \\text{ \\$/MWh}$。因此，最优选择是在时段 2 进行全部调整。\n\n我们在时段 2 将 $10$ MW 的发电量从发电机组 2 转移到发电机组 1。\n- 时段 1 的调度不变：\n  - $p_{1,1} = 50$ MW\n  - $p_{2,1} = 30$ MW\n- 时段 2 的新调度：\n  - $p_{1,2} = 50 + 10 = 60$ MW\n  - $p_{2,2} = 90 - 10 = 80$ MW\n\n我们来验证新的斜坡情况：\n- **发电机组 1**：$|p_{1,2} - p_{1,1}| = |60 - 50| = 10$ MW。$10 \\leq 30$，满足。\n- **发电机组 2**：$|p_{2,2} - p_{2,1}| = |80 - 30| = 50$ MW。$50 \\leq 50$，满足。\n现在所有约束都已满足。\n\n**第 4 部分：计算最终调度和总成本**\n\n最优发电调度为 $(p_{1,1}, p_{2,1}, p_{1,2}, p_{2,2}) = (50, 30, 60, 80)$。我们现在根据分块调度计算总成本。\n\n**时段 1 的成本：**\n- 发电机组 1：$p_{1,1}=50$ MW 来自成本块 1（$x_{1,1,1}=50$）。成本：$50 \\times 10 = 500$。\n- 发电机组 2：$p_{2,1}=30$ MW 来自成本块 1（$x_{2,1,1}=30$）。成本：$30 \\times 15 = 450$。\n- 时段 1 总成本 $C_1 = 500 + 450 = 950$。\n\n**时段 2 的成本：**\n- 发电机组 1：$p_{1,2}=60$ MW 来自成本块 1（$x_{1,2,1}=50$）和成本块 2（$x_{1,2,2}=10$）。成本：$(50 \\times 10) + (10 \\times 30) = 500 + 300 = 800$。\n- 发电机组 2：$p_{2,2}=80$ MW 来自成本块 1（$x_{2,2,1}=30$）和成本块 2（$x_{2,2,2}=50$）。成本：$(30 \\times 15) + (50 \\times 25) = 450 + 1250 = 1700$。\n- 时段 2 总成本 $C_2 = 800 + 1700 = 2500$。\n\n**系统总成本：**\n$C_{\\text{total}} = C_1 + C_2 = 950 + 2500 = 3450$。\n\n最优调度为 $p_{1,1}=50$ MW, $p_{2,1}=30$ MW, $p_{1,2}=60$ MW, $p_{2,2}=80$ MW，总成本为 $3450$。\n\n最终答案要求以有序元组 $(p_{1,1}, p_{2,1}, p_{1,2}, p_{2,2}, C_{\\text{total}})$ 的形式给出。",
            "answer": "$$\n\\boxed{(50, 30, 60, 80, 3450)}\n$$"
        }
    ]
}