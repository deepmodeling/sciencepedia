{
    "hands_on_practices": [
        {
            "introduction": "在能源系统建模中，发电机组的非线性成本函数通常需要线性化，以便应用混合整数线性规划（MILP）等优化工具。一种核心的建模技术是使用凸组合（convex combination）来表示分段线性函数上的任意一点。本练习  将引导你推导并应用凸组合来计算近似成本，这是构建复杂优化模型的一项基本技能。",
            "id": "4111598",
            "problem": "考虑一个单一的火力发电机组，其生产成本是输出电功率的函数，由一个凸增函数 $C(p)$ 建模，其中 $p$ 表示功率，单位为兆瓦 (MW)。在规划模型中，一种常见的做法是通过选择一组有限的断点 $\\{p_i\\}$ 并使用连接点 $\\{(p_i,C(p_i))\\}$ 的直线段来构建 $C(p)$ 的分段线性近似。\n\n假设可用的断点为 $p_i \\in \\{50,75,100\\}$ MW，对应的精确成本为 $C(50)=5000$，$C(75)=7000$ 和 $C(100)=9500$ 货币单位。对于位于两个相邻断点之间的中间功率 $p$，分段线性近似规定在连接相邻断点值的直线段上评估成本。\n\n从实值函数凸性的定义以及区间 $[p_a,p_b]$ 中的任意 $p$ 都可以写成 $p_a$ 和 $p_b$ 的凸组合这一事实出发，推导出在 $[p_a,p_b]$ 上 $C(p)$ 的分段线性近似表达式，该表达式仅用凸组合权重以及值 $C(p_a)$ 和 $C(p_b)$ 来表示。然后应用你的推导，使用相邻断点 $p_a=75$ MW 和 $p_b=100$ MW 以及上述相应成本，计算当 $p=80$ MW 时的近似成本 $c$。\n\n以货币单位表示最终成本。无需四舍五入。",
            "solution": "用户希望我解决一个关于生产成本函数分段线性近似的问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**步骤1：提取已知条件**\n- 生产成本函数是 $C(p)$，它是一个凸增函数。\n- $p$ 是输出电功率，单位为兆瓦 (MW)。\n- $C(p)$ 的近似是一个分段线性函数，由一组连接点 $(p_i, C(p_i))$ 的断点 $\\{p_i\\}$ 构建。\n- 可用断点为 $p_i \\in \\{50, 75, 100\\}$ MW。\n- 相应的成本为 $C(50)=5000$，$C(75)=7000$ 和 $C(100)=9500$ 货币单位。\n- 对于中间功率 $p \\in [p_a, p_b]$，近似成本在点 $(p_a, C(p_a))$ 和 $(p_b, C(p_b))$ 之间的直线段上进行评估。\n- 第一个任务是推导在 $[p_a, p_b]$ 上分段线性近似的表达式，用凸组合权重来表示。\n- 第二个任务是使用相邻断点 $p_a=75$ MW 和 $p_b=100$ MW，计算当 $p=80$ MW 时的近似成本 $c$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题表述在能源系统工程和优化领域是标准的。凸成本函数及其分段线性近似是建模火力发电机调度基础工具。\n- **适定性：** 该问题定义明确。它提供了所有必要的信息，并要求进行特定的推导和计算。给定的数据是一致的；成本是功率的增函数（对于 $50  75  100$，有 $5000  7000  9500$）。这些离散点也表现出凸性，因为从 $p=50$ 到 $p=75$ 的线段斜率为 $\\frac{7000-5000}{75-50} = \\frac{2000}{25} = 80$，而从 $p=75$ 到 $p=100$ 的线段斜率为 $\\frac{9500-7000}{100-75} = \\frac{2500}{25} = 100$。由于 $80  100$，斜率是递增的，这与凸函数一致。\n- **客观性：** 该问题使用精确的数学和技术语言陈述，没有主观性或歧义。\n\n该问题没有任何指令中列出的无效性缺陷。它是科学合理的、完整的和适定的。\n\n**步骤3：结论和行动**\n问题有效。我将继续进行解答。\n\n###\n解答包含两部分：通用公式的推导及其在特定案例中的应用。\n\n**第一部分：分段线性近似的推导**\n\n设 $\\tilde{C}(p)$ 是成本函数 $C(p)$ 在区间 $[p_a, p_b]$ 上的分段线性近似。根据定义，$\\tilde{C}(p)$ 是连接点 $(p_a, C(p_a))$ 和 $(p_b, C(p_b))$ 的直线段上的值。\n\n该直线的方程可以用两点式表示。对于任何功率水平 $p \\in [p_a, p_b]$，近似成本 $\\tilde{C}(p)$ 位于这条直线上，因此它必须满足：\n$$\n\\frac{\\tilde{C}(p) - C(p_a)}{p - p_a} = \\frac{C(p_b) - C(p_a)}{p_b - p_a}\n$$\n解出 $\\tilde{C}(p)$，我们得到：\n$$\n\\tilde{C}(p) = C(p_a) + \\left( \\frac{C(p_b) - C(p_a)}{p_b - p_a} \\right) (p - p_a)\n$$\n问题要求将此表达式用凸组合权重来表示。区间 $[p_a, p_b]$ 中的任何点 $p$ 都可以唯一地表示为端点 $p_a$ 和 $p_b$ 的凸组合：\n$$\np = (1-\\lambda) p_a + \\lambda p_b \\quad \\text{for some } \\lambda \\in [0, 1]\n$$\n我们可以通过重新整理方程来找到权重 $\\lambda$ 的表达式：\n$$\np - p_a = (1-\\lambda) p_a + \\lambda p_b - p_a = \\lambda p_b - \\lambda p_a = \\lambda (p_b - p_a)\n$$\n假设 $p_a \\neq p_b$，我们可以解出 $\\lambda$：\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a}\n$$\n项 $(1-\\lambda)$ 是另一个权重：\n$$\n1 - \\lambda = 1 - \\frac{p - p_a}{p_b - p_a} = \\frac{(p_b - p_a) - (p - p_a)}{p_b - p_a} = \\frac{p_b - p}{p_b - p_a}\n$$\n现在，我们将 $\\lambda$ 代入我们的 $\\tilde{C}(p)$ 表达式中：\n$$\n\\tilde{C}(p) = C(p_a) + (C(p_b) - C(p_a)) \\lambda\n$$\n分配项后得到：\n$$\n\\tilde{C}(p) = C(p_a) - \\lambda C(p_a) + \\lambda C(p_b)\n$$\n因式分解后得到以凸组合权重 $(1-\\lambda)$ 和 $\\lambda$ 表示的最终表达式：\n$$\n\\tilde{C}(p) = (1-\\lambda) C(p_a) + \\lambda C(p_b)\n$$\n这就是所要求的推导。它表明，在 $p$ 点的线性近似值是成本 $C(p_a)$ 和 $C(p_b)$ 的凸组合，其权重与 $p$ 是功率水平 $p_a$ 和 $p_b$ 的凸组合的权重相同。由于原始函数 $C(p)$ 是凸的，因此有 $C(p) = C((1-\\lambda)p_a + \\lambda p_b) \\le (1-\\lambda)C(p_a)+\\lambda C(p_b) = \\tilde{C}(p)$，这意味着分段线性近似提供了断点之间真实成本的一个上界。\n\n**第二部分：近似成本的计算**\n\n我们被要求计算功率输出为 $p = 80$ MW 时的近似成本 $c$。指定的相邻断点是 $p_a = 75$ MW 和 $p_b = 100$ MW。给出的相应成本为 $C(p_a) = C(75) = 7000$ 和 $C(p_b) = C(100) = 9500$。\n\n首先，我们计算凸组合权重 $\\lambda$ 的值：\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a} = \\frac{80 - 75}{100 - 75} = \\frac{5}{25} = \\frac{1}{5}\n$$\n因此另一个权重是 $1-\\lambda = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n\n现在，我们使用推导出的公式来找到近似成本 $c = \\tilde{C}(80)$：\n$$\nc = (1-\\lambda) C(75) + \\lambda C(100)\n$$\n代入数值：\n$$\nc = \\left(\\frac{4}{5}\\right) (7000) + \\left(\\frac{1}{5}\\right) (9500)\n$$\n$$\nc = (0.8)(7000) + (0.2)(9500)\n$$\n$$\nc = 5600 + 1900\n$$\n$$\nc = 7500\n$$\n生产 $80$ MW 功率的近似成本是 $7500$ 货币单位。",
            "answer": "$$\n\\boxed{7500}\n$$"
        },
        {
            "introduction": "任何近似方法都会引入误差，理解并量化这种误差对于评估模型的准确性至关重要。本练习  聚焦于一种常见情形：用分段线性函数来近似二次成本函数，后者是火电机组成本的经典表达形式。通过计算并比较特定出力点上的近似成本与真实成本，你将能亲手量化近似误差，从而更深入地理解模型线性化所带来的精度与简便性之间的权衡。",
            "id": "4111564",
            "problem": "考虑一个火力发电机组，其小时生产成本由有功功率输出 $p$（单位为 $\\text{MW}$）的凸二次函数 $C(p)=a+bp+cp^2$ 建模，其中 $a$ 是空载成本，单位为 $\\$ / \\text{h}$，$b$ 的单位为 $\\$ / (\\text{MWh})$，$c$ 的单位为 $\\$ /(\\text{MW}^2\\cdot\\text{h})$。在许多使用混合整数线性规划 (MILP) 的运行规划模型中，这个凸成本函数通过连接一组分段点 $\\{p_{i}\\}$ 处的点 $\\{(p_{i},C(p_{i}))\\}$ 来构造成一个分段线性函数进行近似。\n\n设 $a=100$，$b=15$，$c=0.05$。考虑从 $0\\,\\text{MW}$ 到 $100\\,\\text{MW}$ 每隔 $25\\,\\text{MW}$ 设置一个分段点，即 $p_{i}\\in\\{0,25,50,75,100\\}$。定义分段线性插值函数 $C_{\\mathrm{PL}}(p)$，对于 $p\\in[p_{i},p_{i+1}]$，其值等于连接相邻点 $(p_{i},C(p_{i}))$ 和 $(p_{i+1},C(p_{i+1}))$ 的线段。仅使用 $C(p)$ 的凸性定义、线性插值以及凸函数图像的弦位于图像之上或与之重合这一事实，完成以下任务：\n\n- 计算在 $p=37.5$ 和 $p=87.5$ 时 $C_{\\mathrm{PL}}(p)$ 和 $C(p)$ 的值。\n- 根据这些值，计算绝对近似误差 $|C_{\\mathrm{PL}}(37.5)-C(37.5)|$ 和 $|C_{\\mathrm{PL}}(87.5)-C(87.5)|$。\n- 将这两个绝对误差中的最大值作为一个标量报告。\n\n以 $\\$ / \\text{h}$ 为单位表示您的最终答案，并将答案四舍五入到五位有效数字。",
            "solution": "该问题经验证具有科学依据、提法得当且客观。这是对非线性函数进行分段线性近似的标准练习，是能源系统优化中的常用技术。所有必要的数据和定义都已提供，没有矛盾或歧义。\n\n小时生产成本函数由下式给出：\n$$C(p) = a+bp+cp^2$$\n系数为 $a=100\\,\\$/\\text{h}$，$b=15\\,\\$/(\\text{MWh})$，$c=0.05\\,\\$/(\\text{MW}^2\\cdot\\text{h})$。功率输出 $p$ 的单位为 $\\text{MW}$。\n代入系数后，成本函数为：\n$$C(p) = 100 + 15p + 0.05p^2$$\n该函数的二阶导数为 $C''(p) = 2c = 2(0.05) = 0.1$，为正值。这证实了 $C(p)$ 是一个严格凸函数。对于凸函数，连接其图像上任意两点的弦都位于图像之上或与之重合。因此，分段线性近似 $C_{\\mathrm{PL}}(p)$ 将始终大于或等于真实成本 $C(p)$，即 $C_{\\mathrm{PL}}(p) \\ge C(p)$。因此，近似误差为 $C_{\\mathrm{PL}}(p) - C(p)$，绝对误差为 $|C_{\\mathrm{PL}}(p) - C(p)| = C_{\\mathrm{PL}}(p) - C(p)$。\n\n分段线性近似的分段点为 $p_{i} \\in \\{0, 25, 50, 75, 100\\}$。我们首先计算在这些分段点处的真实成本。\n$$C(0) = 100 + 15(0) + 0.05(0)^{2} = 100$$\n$$C(25) = 100 + 15(25) + 0.05(25)^{2} = 100 + 375 + 0.05(625) = 475 + 31.25 = 506.25$$\n$$C(50) = 100 + 15(50) + 0.05(50)^{2} = 100 + 750 + 0.05(2500) = 850 + 125 = 975$$\n$$C(75) = 100 + 15(75) + 0.05(75)^{2} = 100 + 1125 + 0.05(5625) = 1225 + 281.25 = 1506.25$$\n$$C(100) = 100 + 15(100) + 0.05(100)^{2} = 100 + 1500 + 0.05(10000) = 1600 + 500 = 2100$$\n所有成本值的单位均为 $\\$ / \\text{h}$。\n\n任务是计算在 $p = 37.5$ 和 $p = 87.5$ 这两个点的近似误差。\n\n首先，考虑 $p = 37.5\\,\\text{MW}$。\n该点位于区间 $[25, 50]$ 内。分段线性近似值 $C_{\\mathrm{PL}}(37.5)$ 是通过在点 $(25, C(25))$ 和 $(50, C(50))$ 之间进行线性插值得到的。这两个点是 $(25, 506.25)$ 和 $(50, 975)$。\n对于区间 $[p_i, p_{i+1}]$ 内的一点 $p$，线性插值的通用公式为：\n$$C_{\\mathrm{PL}}(p) = C(p_i) + \\frac{C(p_{i+1}) - C(p_i)}{p_{i+1} - p_i}(p - p_i)$$\n对于 $p=37.5$，$p_i=25$，$p_{i+1}=50$：\n$$C_{\\mathrm{PL}}(37.5) = C(25) + \\frac{C(50) - C(25)}{50 - 25}(37.5 - 25)$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + \\frac{975 - 506.25}{25}(12.5) = 506.25 + \\frac{468.75}{25}(12.5) = 506.25 + 18.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + 234.375 = 740.625$$\n现在，我们计算真实成本 $C(37.5)$:\n$$C(37.5) = 100 + 15(37.5) + 0.05(37.5)^{2} = 100 + 562.5 + 0.05(1406.25)$$\n$$C(37.5) = 662.5 + 70.3125 = 732.8125$$\n在 $p = 37.5$ 处的绝对近似误差为：\n$$|C_{\\mathrm{PL}}(37.5) - C(37.5)| = |740.625 - 732.8125| = 7.8125$$\n\n接下来，考虑 $p=87.5\\,\\text{MW}$。\n该点位于区间 $[75, 100]$ 内。分段线性近似值 $C_{\\mathrm{PL}}(87.5)$ 是通过在点 $(75, C(75))$ 和 $(100, C(100))$ 之间进行线性插值得到的。这两个点是 $(75, 1506.25)$ 和 $(100, 2100)$。\n对于 $p=87.5$，$p_i=75$，$p_{i+1}=100$：\n$$C_{\\mathrm{PL}}(87.5) = C(75) + \\frac{C(100) - C(75)}{100 - 75}(87.5 - 75)$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + \\frac{2100 - 1506.25}{25}(12.5) = 1506.25 + \\frac{593.75}{25}(12.5) = 1506.25 + 23.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + 296.875 = 1803.125$$\n现在，我们计算真实成本 $C(87.5)$:\n$$C(87.5) = 100 + 15(87.5) + 0.05(87.5)^{2} = 100 + 1312.5 + 0.05(7656.25)$$\n$$C(87.5) = 1412.5 + 382.8125 = 1795.3125$$\n在 $p = 87.5$ 处的绝对近似误差为：\n$$|C_{\\mathrm{PL}}(87.5) - C(87.5)| = |1803.125 - 1795.3125| = 7.8125$$\n\n最后，我们求这两个绝对误差的最大值。\n$$\\text{Max Error} = \\max(|C_{\\mathrm{PL}}(37.5) - C(37.5)|, |C_{\\mathrm{PL}}(87.5) - C(87.5)|)$$\n$$\\text{Max Error} = \\max(7.8125, 7.8125) = 7.8125$$\n最大误差为 $7.8125\\,\\$/\\text{h}$。问题要求将答案四舍五入到五位有效数字。数字 $7.8125$ 已经有五位有效数字 ($7, 8, 1, 2, 5$)，因此无需进行四舍五入。\n对于二次函数，在任何给定宽度的区间内，最大误差出现在区间的中点，其值为 $\\frac{c}{4}(\\Delta p)^2$，仅取决于二次项系数 $c$ 和区间宽度 $\\Delta p$。由于两个评估点都是宽度同为 $\\Delta p = 25$ 的区间的中点，因此误差是相同的。$\\frac{0.05}{4}(25)^2 = 0.0125 \\times 625 = 7.8125$，这验证了详细的计算结果。",
            "answer": "$$\n\\boxed{7.8125}\n$$"
        },
        {
            "introduction": "除了凸组合，我们还可以从增量或“分块”的角度来构建成本函数，这种方法在经济调度中尤为直观。它将发电机的出力看作是按边际成本从低到高顺序填充的一系列“发电块”。本练习  将通过计算一个具体的例子，帮助你掌握这种增量成本计算方法，并加深对总成本与边际成本之间积分关系的理解。",
            "id": "4111589",
            "problem": "一个火力发电机组在短期内的可变生产成本通过一个凸分段线性近似进行建模。该机组的可行生产范围由最小功率 $P_{\\min}$ 和最大功率 $P_{\\max}$ 定义，分段点为 $p=[50,80,100]$ 兆瓦 (MW)，因此 $P_{\\min}=50$ MW 且 $P_{\\max}=100$ MW。该分段线性近似是根据一个基本定义构建的：功率为 $p$ 时的总可变成本 $c(p)$ 等于边际成本函数 $m(\\tilde{p})$ 从 $P_{\\min}$ 到 $p$ 的积分，其中 $m(\\tilde{p})$ 在每个连续分段点之间的区间内被近似为常数。具体来说，$[50,80]$ MW 和 $[80,100]$ MW 这两个区间的边际成本斜率分别为 $\\alpha=[20,30]$ 美元/兆瓦，并且增量公式“锚定”在 $P_{\\min}$，即 $c(P_{\\min})=0$。\n\n从这些基本定义（总成本是边际成本的积分，以及分段恒定的边际成本）出发，增量公式将任何高于 $P_{\\min}$ 的输出顺序地分配到连续的区间中，在进入下一个区间之前，绝不会超过当前区间的长度。使用此公式，计算当 $p=90$ MW 时的总可变生产成本 $c$。以美元表示最终成本，并提供精确值（无需四舍五入）。",
            "solution": "我们从电力系统中可变生产成本的基本定义开始：总成本 $c(p)$ 是边际成本 $m(\\tilde{p})$ 从选定的锚点到工作点的积分。在分段恒定边际成本近似下，我们将生产范围划分为多个具有恒定斜率的区间，这些斜率就是这些区间内的边际成本。当公式锚定在 $P_{\\min}$ 时，基准为 $c(P_{\\min})=0$，任何高于 $P_{\\min}$ 的生产都会产生费用，该费用根据额外输出所占区间的边际成本斜率计算。\n\n设分段点为 $p=[50,80,100]$ MW。因此，区间如下：\n- 区间 1：$[50,80]$ MW，长度为 $80-50=30$ MW，斜率为 $\\alpha_{1}=20$ 美元/兆瓦。\n- 区间 2：$[80,100]$ MW，长度为 $100-80=20$ MW，斜率为 $\\alpha_{2}=30$ 美元/兆瓦。\n\n增量公式规定，任何高于 $P_{\\min}=50$ MW 的功率首先被分配到区间 1，直到达到其容量上限，然后才分配到区间 2。对于目标产量 $p=90$ MW，高于 $P_{\\min}$ 的额外输出为\n$$\n\\Delta p = p - P_{\\min} = 90 - 50 = 40 \\text{ MW}.\n$$\n我们将这个 $\\Delta p$ 分配到各个区间：\n- 区间 1 最多能容纳 $30$ MW。因此，我们分配\n$$\nz_{1} = \\min\\{30,\\Delta p\\} = \\min\\{30,40\\} = 30 \\text{ MW}.\n$$\n- 剩余的增量进入区间 2：\n$$\nz_{2} = \\Delta p - z_{1} = 40 - 30 = 10 \\text{ MW}.\n$$\n\n因为每个区间内的边际成本是恒定的，所以总可变成本是各区间的（区间斜率）乘以（该区间内分配的增量）的总和。因此，\n$$\nc(90) = \\alpha_{1} z_{1} + \\alpha_{2} z_{2} = 20 \\times 30 + 30 \\times 10 = 600 + 300 = 900 \\text{ dollars}.\n$$\n这是将分段恒定的边际成本在分配的增量上积分的直接结果；它等同于将边际成本曲线下 $P_{\\min}$ 和 $p$ 之间的矩形面积求和。\n\n因此，在锚定于 $P_{\\min}=50$ MW 的增量公式下，当 $p=90$ MW 时的确切总可变生产成本为 $900$ 美元。",
            "answer": "$$\\boxed{900}$$"
        }
    ]
}