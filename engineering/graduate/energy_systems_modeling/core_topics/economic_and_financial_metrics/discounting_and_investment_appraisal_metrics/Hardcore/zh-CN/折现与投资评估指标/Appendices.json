{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在解决任何长期财务分析中至关重要的第一步：正确核算通货膨胀的影响。我们将从第一性原理出发，探讨名义利率、通货膨胀和真实贴现率之间的关系，并阐明为什么使用真实利率来贴现未来真实的现金流对于精确的项目评估至关重要。",
            "id": "4085265",
            "problem": "一家受监管的电力公司正在规划一项跨越数十年的资产，其在 $T$ 年内的固定实际运营和维护（OM）成本为 $C$。该公司报告的名义年折现率为 $i=0.08$，并预计在整个规划期内，每年的一般通货膨胀率为恒定的 $\\pi=0.03$。仅从名义增长乘以货币单位，而实际增长乘以相对于一般价格指数定义的购买力单位这一基本定义出发，推导出与 $i$ 和 $\\pi$ 内部一致的恒定实际折现率 $r$ 的表达式。然后，使用给定的 $i$ 和 $\\pi$ 值，计算 $r$ 的数值。最后，利用现值的基本原理和记账单位的内部一致性，解释用实际利率 $r$ 对固定实际OM成本流 $\\{C,C,\\dots,C\\}$ 进行折现，是否与用名义利率 $i$ 对相应的名义OM成本流 $\\{C(1+\\pi),C(1+\\pi)^{2},\\dots\\}$ 进行折现得出相同的现值，并阐明如果建模者无意中用 $i$ 而非 $r$ 对实际现金流进行折现，会产生何种方向的偏差。您不应计算现值的具体数值；仅需列出表达式。将您的最终数值答案报告为 $r$ 的值，以小数形式表示，并四舍五入到五位有效数字。",
            "solution": "该问题要求推导实际折现率，进行数值计算，解释现值等价性，并分析错误折现所导致的偏差。验证证实了该问题提法恰当、有科学依据且客观。\n\n**第1部分：实际折现率 $r$ 的推导**\n\n我们从名义价值和实际价值的基本定义开始。假设在时间 $t=0$ 时，有一笔本金 $A_0$。\n\n名义利率 $i$ 描述了货币单位的增长。经过一个时期（一年）后，名义金额 $A_{1,nom}$ 将是：\n$$A_{1,nom} = A_0(1+i)$$\n这个表达式代表了在 $t=1$ 时的货币单位数量。\n\n实际利率 $r$ 描述了购买力的增长。为了定义购买力，我们必须引入一个一般价格指数 $P$。设 $t=0$ 时的价格指数为 $P_0$。初始金额 $A_0$ 的实际价值，即购买力，是：\n$$PV_0 = \\frac{A_0}{P_0}$$\n通货膨胀率 $\\pi$ 描述了一般价格指数的增长率。一个时期后，价格指数将是：\n$$P_1 = P_0(1+\\pi)$$\n在时间 $t=1$ 时，新的名义金额 $A_{1,nom}$ 的购买力可以通过用新的价格指数 $P_1$ 对其进行平减来得到：\n$$PV_1 = \\frac{A_{1,nom}}{P_1} = \\frac{A_0(1+i)}{P_0(1+\\pi)}$$\n或者，我们可以通过将实际增长因子 $(1+r)$ 应用于初始实际价值 $PV_0$ 来得到 $PV_1$：\n$$PV_1 = PV_0(1+r) = \\frac{A_0}{P_0}(1+r)$$\n为了使这两个角度保持一致，关于 $PV_1$ 的两个表达式必须相等：\n$$\\frac{A_0}{P_0}(1+r) = \\frac{A_0(1+i)}{P_0(1+\\pi)}$$\n$A_0$ 和 $P_0$ 项非零且可以消去，从而得出被称为费雪方程式的基本关系：\n$$(1+r) = \\frac{1+i}{1+\\pi}$$\n求解实际折现率 $r$ 得到所需的表达式：\n$$r = \\frac{1+i}{1+\\pi} - 1$$\n\n**第2部分：$r$ 的数值计算**\n\n问题给出了名义年折现率 $i=0.08$ 和恒定的一般通货膨胀率 $\\pi=0.03$。将这些值代入推导出的 $r$ 表达式中：\n$$r = \\frac{1+0.08}{1+0.03} - 1$$\n$$r = \\frac{1.08}{1.03} - 1$$\n$$r \\approx 1.048543689 - 1$$\n$$r \\approx 0.048543689$$\n根据题目要求，四舍五入到五位有效数字，我们得到：\n$$r \\approx 0.048544$$\n\n**第3部分：现值等价性**\n\n问题询问用实际利率 $r$ 对固定实际OM成本流 $\\{C, C, \\dots, C\\}$ 进行折现，是否等同于用名义利率 $i$ 对相应的名义成本流进行折现。\n\n首先，我们定义第 $t$ 年的名义OM成本 $C_{nom,t}$。第 $t$ 年的固定实际成本 $C$ 意味着其价值是按第 $t$ 年的购买力计算的 $C$。要将其转换为第 $t$ 年的名义货币单位，我们必须从基准年（$t=0$）开始对其进行通货膨胀调整。第 $t$ 年的名义成本是：\n$$C_{nom,t} = C(1+\\pi)^t$$\n因此，名义现金流为 $\\{C(1+\\pi), C(1+\\pi)^2, \\dots, C(1+\\pi)^T\\}$。\n\n当以名义利率 $i$ 折现时，此名义流的现值（$PV$）为：\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} \\frac{C_{nom,t}}{(1+i)^t} = \\sum_{t=1}^{T} \\frac{C(1+\\pi)^t}{(1+i)^t}$$\n这可以重写为：\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} C \\left( \\frac{1+\\pi}{1+i} \\right)^t$$\n根据我们在第1部分的推导，我们知道 $(1+r) = \\frac{1+i}{1+\\pi}$。因此，$\\frac{1}{1+r} = \\frac{1+\\pi}{1+i}$。将此代入现值表达式中：\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} C \\left( \\frac{1}{1+r} \\right)^t = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\n现在，考虑实际现金流的现值。该现金流由 $T$ 年内的固定实际成本 $\\{C, C, \\dots, C\\}$ 组成。要计算其现值，这些实际现金流必须以实际折现率 $r$ 进行折现：\n$$PV_{real \\ stream} = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\n通过直接比较，我们看到 $PV_{nominal \\ stream} = PV_{real \\ stream}$。因此，这两种方法是完全等价的，并将产生完全相同的现值。这证明了对实际现金流使用实际利率和对名义现金流使用名义利率的内部一致性。\n\n**第4部分：错误折现导致的偏差方向**\n\n一个常见的建模错误是以名义折现率对实际现金流进行折现。我们需要确定由此产生的偏差方向。\n\n正确的现值是通过以实际利率 $r$ 折现实际现金流 $\\{C, C, \\dots, C\\}$ 得到的：\n$$PV_{correct} = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\n不正确的现值是通过以名义利率 $i$ 折现相同的实际现金流得到的：\n$$PV_{incorrect} = \\sum_{t=1}^{T} \\frac{C}{(1+i)^t}$$\n为了确定偏差，我们必须比较利率 $r$ 和 $i$。根据公式 $r = \\frac{1+i}{1+\\pi} - 1$，并且考虑到通货膨胀率 $\\pi=0.03$ 为正，分母 $(1+\\pi)$ 大于 1。因此：\n$$\\frac{1}{1+\\pi}  1$$\n$$(1+i)\\left(\\frac{1}{1+\\pi}\\right)  1+i$$\n$$\\frac{1+i}{1+\\pi} - 1  (1+i) - 1$$\n$$r  i$$\n在我们的具体案例中，$r \\approx 0.048544$ 且 $i=0.08$，这证实了 $r  i$。\n\n由于折现率 $i$ 大于正确的折现率 $r$，折现因子 $(1+i)$ 将大于 $(1+r)$。因此，对于任何时间 $t  0$：\n$$\\frac{1}{1+i}  \\frac{1}{1+r}$$\n$$\\left(\\frac{1}{1+i}\\right)^t  \\left(\\frac{1}{1+r}\\right)^t$$\n由于OM成本 $C$ 是正数，$PV_{incorrect}$ 的求和中的每一项都小于 $PV_{correct}$ 的求和中相应的项：\n$$\\frac{C}{(1+i)^t}  \\frac{C}{(1+r)^t}$$\n因此，总和也将更小：\n$$\\sum_{t=1}^{T} \\frac{C}{(1+i)^t}  \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\n$$PV_{incorrect}  PV_{correct}$$\n这种偏差在于，以较高的名义利率对实际现金流进行折现会低估成本的现值。这个错误会使项目看起来比实际情况更具财务吸引力（即成本更低），可能导致错误的投资决策。",
            "answer": "$$\\boxed{0.048544}$$"
        },
        {
            "introduction": "在能源项目中，遥远未来的现金流很常见，而离散复利与连续复利的选择会显著改变其现值。本练习旨在量化这两种贴现约定之间的差异，并探讨其在建模中的影响，从而强调在长周期分析中方法论选择保持透明和一致的重要性。",
            "id": "4085313",
            "problem": "一个能源系统规划师正在评估一个电网级电池更换项目在$t=25$年时产生的一笔确定的退役现金流。规划师需要在使用相同的名义年贴现率$r=0.07$的情况下，比较两种贴现约定下的现值：离散年度复利和连续复利。根据现值的基本定义（即在指定的复利约定下，能够增长到在规定时间恰好等于未来现金流的唯一金额），从第一性原理出发，推导在$t=25$时发生的一笔现金流$C$在每种约定下的现值表达式。然后，计算相对差异\n$$\\delta \\equiv \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}},$$\n其中$\\text{PV}_{\\text{disc}}$表示在利率$r$下离散年度复利的现值，$\\text{PV}_{\\text{cont}}$表示在利率$r$下连续复利的现值。将$\\delta$的最终答案表示为一个纯数（无单位），并四舍五入到四位有效数字。最后，解释在长周期能源系统建模中，当不同约定使用相同的名义利率$r$时，选择离散复利与连续复利对建模的影响。",
            "solution": "该问题已经过验证，被确定为应用于能源系统分析的金融数学领域中一个有效且适定的问题。它具有科学依据，内容自洽且客观。我们现在开始解答。\n\n问题要求完成三项不同的任务：\n1.  从第一性原理推导离散年度复利（$\\text{PV}_{\\text{disc}}$）和连续复利（$\\text{PV}_{\\text{cont}}$）下的现值表达式。\n2.  根据给定参数计算相对差异$\\delta \\equiv \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}}$。\n3.  解释这两种约定选择之间的建模影响。\n\n**1. 现值表达式的推导**\n\n现值（$\\text{PV}$）的基本定义是：如果在今天以给定的回报率投资一笔资本，它将在未来某个特定时间（$t$）增长到等于一个特定的未来现金流（$C$）。\n\n**a. 离散年度复利**\n\n在名义年利率为$r$的离散年度复利下，一笔初始金额$\\text{PV}$在一年后增长到未来值（$\\text{FV}$）为：\n$$ \\text{FV}_1 = \\text{PV} \\cdot (1+r) $$\n如果这笔金额被再投资第二年，它将增长到：\n$$ \\text{FV}_2 = \\text{FV}_1 \\cdot (1+r) = \\text{PV} \\cdot (1+r)^2 $$\n遵循此模式，经过$t$年后，未来值由下式给出：\n$$ \\text{FV}_t = \\text{PV} \\cdot (1+r)^t $$\n根据问题的定义，我们将此未来值设为等于现金流$C$，并将现值设为$\\text{PV}_{\\text{disc}}$。\n$$ C = \\text{PV}_{\\text{disc}} \\cdot (1+r)^t $$\n求解$\\text{PV}_{\\text{disc}}$，得到离散年度复利下的现值表达式：\n$$ \\text{PV}_{\\text{disc}} = \\frac{C}{(1+r)^t} = C(1+r)^{-t} $$\n\n**b. 连续复利**\n\n连续复利是在无限小的时间间隔内进行复利的数学极限。我们从每年复利$n$次的公式开始。每个复利周期的利率是$\\frac{r}{n}$，在$t$年内的总周期数是$n \\cdot t$。未来值为：\n$$ \\text{FV}_{t,n} = \\text{PV} \\left(1 + \\frac{r}{n}\\right)^{nt} $$\n连续复利对应于$n \\to \\infty$时的极限：\n$$ \\text{FV}_t = \\lim_{n \\to \\infty} \\text{PV} \\left(1 + \\frac{r}{n}\\right)^{nt} = \\text{PV} \\left[ \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^n \\right]^t $$\n我们使用指数函数的基本定义，$e^x = \\lim_{k \\to \\infty} \\left(1 + \\frac{x}{k}\\right)^k$。通过设$x=r$和$k=n$，方括号中的项变为$e^r$。\n因此，连续复利下的未来值为：\n$$ \\text{FV}_t = \\text{PV} \\cdot (e^r)^t = \\text{PV} \\cdot e^{rt} $$\n将此未来值设为等于现金流$C$，并将现值设为$\\text{PV}_{\\text{cont}}$：\n$$ C = \\text{PV}_{\\text{cont}} \\cdot e^{rt} $$\n求解$\\text{PV}_{\\text{cont}}$，得到连续复利下的现值表达式：\n$$ \\text{PV}_{\\text{cont}} = \\frac{C}{e^{rt}} = Ce^{-rt} $$\n\n**2. 相对差异$\\delta$的计算**\n\n相对差异$\\delta$定义为：\n$$ \\delta = \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}} $$\n代入推导出的$\\text{PV}_{\\text{disc}}$和$\\text{PV}_{\\text{cont}}$的表达式：\n$$ \\delta = \\frac{C(1+r)^{-t} - Ce^{-rt}}{C(1+r)^{-t}} $$\n现金流量$C$是一个公因子，可以消去，这是符合预期的，因为$\\delta$是一个相对度量：\n$$ \\delta = \\frac{(1+r)^{-t} - e^{-rt}}{(1+r)^{-t}} = 1 - \\frac{e^{-rt}}{(1+r)^{-t}} = 1 - \\left(\\frac{e^r}{1+r}\\right)^{-t} $$\n这可以简化为：\n$$ \\delta = 1 - \\left(\\frac{1+r}{e^r}\\right)^t $$\n现在，我们代入给定的数值：名义年贴现率$r=0.07$和时间跨度$t=25$年。\n$$ \\delta = 1 - \\left(\\frac{1+0.07}{\\exp(0.07)}\\right)^{25} = 1 - \\left(\\frac{1.07}{\\exp(0.07)}\\right)^{25} $$\n让我们计算这些值：\n$\\exp(0.07) \\approx 1.072508181$\n指数的底是$\\frac{1.07}{1.072508181} \\approx 0.997661410$\n将此数提高到25次方：\n$(0.997661410)^{25} \\approx 0.943152504$\n最后，计算$\\delta$：\n$$ \\delta = 1 - 0.943152504 = 0.056847496 $$\n根据题目要求四舍五入到四位有效数字，得到：\n$$ \\delta \\approx 0.05685 $$\n\n**3. 建模影响**\n\n计算表明，对于名义利率$r=0.07$，$\\delta \\approx 5.685\\%$。这意味着使用离散年度复利计算的现值比使用连续复利计算的现值大约高出$5.685\\%$。这个结果对于任何$r  0$都成立。从指数函数的泰勒级数展开式$e^r = 1 + r + \\frac{r^2}{2!} + \\frac{r^3}{3!} + \\dots$可以看出，对于$r  0$，$e^r  1+r$。因此，对于$t1$，$e^{rt}  (1+r)^t$，这意味着$e^{-rt}  (1+r)^{-t}$。所以，对于相同的正名义利率$r$，$\\text{PV}_{\\text{cont}}  \\text{PV}_{\\text{disc}}$总是成立的。\n\n对长周期能源系统的关键建模影响如下：\n\n*   **贴现力度**：对于相同的名义利率$r$，连续复利是一种更“激进”的贴现形式。与离散年度复利相比，它为任何未来现金流赋予了更低的现值。这种效应会随着时间跨度的延长而放大，因为两个贴现因子$(1+r)^{-t}$和$e^{-rt}$之间的差异随$t$的增大而增大。对于生命周期非常长的项目（例如，核电站、水电大坝或有关气候变化减缓的政策），复利约定的选择不是一个微小的技术细节，而是决定结果的重要驱动因素。\n\n*   **项目选择中的偏差**：约定的选择会系统性地使项目评估产生偏差。对于前期成本高但长期收益可观的投资（例如风力发电场），使用连续复利会更重地贴现未来收入，使项目看起来比在离散复利下财务可行性更低。相反，对于具有大额未来负债的项目，例如本问题中电池系统的退役成本，使用连续复利会通过更显著地减小未来成本的现值，使项目看起来更具吸引力。\n\n*   **一致性与透明度**：最关键的影响是方法选择上需要绝对的清晰度和一致性。分析师可能有意或无意地通过选择特定的复利约定来偏爱或不偏爱某个项目。因此，在任何稳健的能源系统分析或投资评估中，都必须指明贴现率及其复利约定（例如，“年利率7%，按年复利” vs. “年利率7%，连续复利”）。比较使用不同隐式约定而未进行适当利率转换的研究结果是无效的。虽然连续复利为理论建模和基于微积分的优化提供了数学上的便利，但离散复利通常更好地反映了工业和金融会计的实践。选择必须是明确的、有理由的，并得到一致的应用。",
            "answer": "$$\\boxed{0.05685}$$"
        },
        {
            "introduction": "在前述贴现原理的基础上，最后的这项练习将我们带入决策制定的领域。你将构建一个简单的动态模型，以确定投资新能源资产的最佳时机，从而在前期资本成本与未来运营节余之间取得平衡。这项练习为能源系统优化模型的核心逻辑提供了亲身实践的入门体验。",
            "id": "4085292",
            "problem": "考虑一个离散时间的三周期能源供应规划模型，周期由 $t \\in \\{0,1,2\\}$ 索引。有一个单一的潜在资产，如果在某个周期 $p \\in \\{0,1,2\\}$ 建造一次，该资产将在周期 $p$ 立即投入运营，并满足所有后续周期 $t \\ge p$ 的全部能源需求。如果在某个周期 $t$ 资产尚未建造，则该周期的需求通过在现货市场上购买能源来满足。您也可以选择永不建造该资产，记为 $p=-1$。\n\n基本量：\n- 每个周期 $t$ 的能源需求为 $D_t$ 兆瓦时 (MWh)。\n- 如果在周期 $p \\ge 0$ 建造，资产将在周期 $p$ 产生一次性资本支出 $C$ 美元。\n- 当资产在周期 $t$ 运营时，其运营成本等于运营和维护 (OM) 成本与单位能源燃料成本之和，分别记为每兆瓦时 $c_{\\text{om}}$ 美元和每兆瓦时 $c_{\\text{fuel}}$ 美元。为简洁起见，定义可变成本 $c_{\\text{var}} = c_{\\text{om}} + c_{\\text{fuel}}$ 美元/兆瓦时。\n- 如果在周期 $t$ 资产尚未建造，则以现货市场单价 $s_t$ 美元/兆瓦时满足需求。\n- 模型使用实际贴现率 $r$，必须表示为小数（例如，百分之五为 $0.05$）。现值是在周期 0 的唯一金额，若以实际贴现率 $r$ 复利计算至相关的未来周期，其值等于未来的现金流。\n\n任务：\n- 根据上述复利定义，并且不使用任何快捷公式，推导周期 0 的总贴现系统成本的表达式，该表达式是关于建造时机决策 $p \\in \\{-1,0,1,2\\}$、资本支出 $C$、实际贴现率 $r$、需求 $D_t$、现货价格 $s_t$ 和可变成本 $c_{\\text{var}}$ 的函数。\n- 实现一个程序，计算每个候选建造时机 $p$ 的总贴现系统成本（以周期 0 的美元计），并选择使该成本最小化的 $p$。如果多个 $p$ 产生相同的最小贴现成本（在数值舍入误差范围内），则通过选择最小的 $p$ 来打破平局。\n- 您的程序必须生成单行结果，包含为所提供测试套件得出的结果，每个结果报告为一个双元素列表 $[p^\\star, \\text{cost}^\\star]$，其中 $p^\\star$ 是最优建造时机，$\\text{cost}^\\star$ 是最小化的贴现系统成本（以周期 0.00 的美元计）。将贴现成本表示为周期 0 的美元，四舍五入到两位小数。最终输出必须是方括号括起来的逗号分隔列表，例如 $[[0,12345.67],[-1,890.12],[2,3456.78]]$。\n\n测试套件规范：\n- 测试用例 1（现货价格上涨和中等贴现率的理想情况）：\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh。\n  - $c_{\\text{om}} = 5$ 美元/兆瓦时, $c_{\\text{fuel}} = 25$ 美元/兆瓦时, 因此 $c_{\\text{var}} = 30$ 美元/兆瓦时。\n  - $s_0 = 80$ 美元/兆瓦时, $s_1 = 90$ 美元/兆瓦时, $s_2 = 110$ 美元/兆瓦时。\n  - $C = 8000$ 美元。\n  - $r = 0.05$。\n- 测试用例 2（贴现率正好抵消了提前建造的收益的边界中性情况）：\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh。\n  - $c_{\\text{om}} = 5$ 美元/兆瓦时, $c_{\\text{fuel}} = 25$ 美元/兆瓦时, 因此 $c_{\\text{var}} = 30$ 美元/兆瓦时。\n  - $s_0 = 80$ 美元/兆瓦时, $s_1 = 80$ 美元/兆瓦时, $s_2 = 80$ 美元/兆瓦时。\n  - $C = 25000$ 美元。\n  - $r = 0.25$。\n- 测试用例 3（零贴现率和相对于现货市场运营不经济的资产的边缘情况）：\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh。\n  - $c_{\\text{om}} = 20$ 美元/兆瓦时, $c_{\\text{fuel}} = 50$ 美元/兆瓦时, 因此 $c_{\\text{var}} = 70$ 美元/兆瓦时。\n  - $s_0 = 50$ 美元/兆瓦时, $s_1 = 50$ 美元/兆瓦时, $s_2 = 50$ 美元/兆瓦时。\n  - $C = 1000$ 美元。\n  - $r = 0.00$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果应为如上定义的双元素列表 $[p^\\star, \\text{cost}^\\star]$。例如，输出必须类似于 $[[p_1,\\text{cost}_1],[p_2,\\text{cost}_2],[p_3,\\text{cost}_3]]$，不含任何额外文本。",
            "solution": "该问题要求推导能源资产投资决策的总贴现系统成本，并实现一个程序来找到使该成本最小化的最优决策。解决方案必须按照规定从第一性原理推导。\n\n评估跨时间投资的核心原则是贴现现金流 (DCF) 分析。发生在不同时间点的现金流的经济价值可以通过将它们转换为在单一时间点（通常是当前，$t=0$）的等价值来进行比较。这个等价值被称为现值 ($PV$)。问题通过复利公式定义了发生在周期 $t$ 的未来现金流 $F_t$ 与其现值 $PV$ 之间的关系：$PV \\times (1+r)^t = F_t$，其中 $r$ 是每个周期的实际贴现率。根据这个定义，现金流 $F_t$ 的 $PV$ 是通过贴现推导出来的：\n\n$$ PV(F_t) = \\frac{F_t}{(1+r)^t} $$\n\n我们旨在最小化的总贴现系统成本，是在规划范围 $t \\in \\{0, 1, 2\\}$ 内发生的所有成本的现值之和。让我们将此总成本表示为建造决策 $p$ 的函数 $J(p)$。\n\n$$ J(p) = \\sum_{t=0}^{2} PV(\\text{在决策 } p \\text{ 下周期 } t \\text{ 的成本}) $$\n\n任何给定周期的成本取决于资产是否已建造。决策变量是建造周期 $p \\in \\{-1, 0, 1, 2\\}$。对于每个可能的 $p$ 值，我们可以确定现金流，并计算总贴现成本。\n\n让我们分析每种可能决策 $p$ 的成本：\n\n**情况 1：永不建造资产 ($p=-1$)**\n如果资产永不建造，每个周期 $t \\in \\{0, 1, 2\\}$ 的能源需求 $D_t$ 必须通过从现货市场以单价 $s_t$ 购买能源来满足。\n在周期 $t$ 发生的成本是 $F_t = s_t D_t$。\n总贴现成本 $J(-1)$ 是这些成本的现值之和：\n$$ J(-1) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{s_1 D_1}{(1+r)^1} + \\frac{s_2 D_2}{(1+r)^2} = s_0 D_0 + \\frac{s_1 D_1}{1+r} + \\frac{s_2 D_2}{(1+r)^2} $$\n\n**情况 2：在周期 $p=0$ 建造资产**\n资产在周期 $t=0$ 建造并投入运营。\n- 在周期 $t=0$：产生一次性资本支出 $C$。新资产满足需求 $D_0$，产生运营成本 $c_{\\text{var}} D_0$。周期 0 的总现金流出为 $F_0 = C + c_{\\text{var}} D_0$。\n- 在周期 $t=1$ 和 $t=2$：资产继续运营，满足需求 $D_1$ 和 $D_2$，成本分别为 $F_1 = c_{\\text{var}} D_1$ 和 $F_2 = c_{\\text{var}} D_2$。\n总贴现成本 $J(0)$ 是：\n$$ J(0) = \\frac{C + c_{\\text{var}} D_0}{(1+r)^0} + \\frac{c_{\\text{var}} D_1}{(1+r)^1} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} = C + c_{\\text{var}} D_0 + \\frac{c_{\\text{var}} D_1}{1+r} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**情况 3：在周期 $p=1$ 建造资产**\n- 在周期 $t=0$：资产尚未建造。需求 $D_0$ 由现货市场满足，成本为 $F_0 = s_0 D_0$。\n- 在周期 $t=1$：资产被建造，产生资本成本 $C$，并投入运营。周期 1 的总成本为 $F_1 = C + c_{\\text{var}} D_1$。\n- 在周期 $t=2$：资产运营，产生成本 $F_2 = c_{\\text{var}} D_2$。\n总贴现成本 $J(1)$ 是：\n$$ J(1) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{C + c_{\\text{var}} D_1}{(1+r)^1} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} = s_0 D_0 + \\frac{C + c_{\\text{var}} D_1}{1+r} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**情况 4：在周期 $p=2$ 建造资产**\n- 在周期 $t=0$ 和 $t=1$：资产尚未建造。需求 $D_0$ 和 $D_1$ 由现货市场满足，成本分别为 $F_0 = s_0 D_0$ 和 $F_1 = s_1 D_1$。\n- 在周期 $t=2$：资产被建造并运营，产生的总成本为 $F_2 = C + c_{\\text{var}} D_2$。\n总贴现成本 $J(2)$ 是：\n$$ J(2) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{s_1 D_1}{(1+r)^1} + \\frac{C + c_{\\text{var}} D_2}{(1+r)^2} = s_0 D_0 + \\frac{s_1 D_1}{1+r} + \\frac{C + c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**通用成本函数与优化**\n这些情况可以总结为一个单一的框架。对于任何建造决策 $p \\in \\{0, 1, 2\\}$，总贴现成本是贴现资本支出和贴现运营成本之和。一个周期 $t$ 的运营成本是，如果资产尚未建造 ($t  p$)，则为 $s_t D_t$；如果已投入运营 ($t \\ge p$)，则为 $c_{\\text{var}} D_t$。\n\n$J(p) = \\frac{C}{(1+r)^p} + \\sum_{t=0}^{p-1} \\frac{s_t D_t}{(1+r)^t} + \\sum_{t=p}^{2} \\frac{c_{\\text{var}} D_t}{(1+r)^t}$ for $p \\in \\{0, 1, 2\\}$。\n$p=-1$ 的情况作为 $J(-1) = \\sum_{t=0}^{2} \\frac{s_t D_t}{(1+r)^t}$ 单独处理。\n\n优化任务是找到使总贴现成本最小化的建造决策 $p^\\star$：\n$$ p^\\star = \\arg\\min_{p \\in \\{-1, 0, 1, 2\\}} J(p) $$\n如果出现多个 $p$ 值产生相同最小成本的平局情况，问题规定应选择最小的 $p$ 值。\n\n程序将实现这些推导出的公式。对于每个测试用例，它将计算所有四个候选 $p$ 值的 $J(p)$，找出最小成本，并根据平局打破规则选择相应的 $p^\\star$。最终的最小化成本随后四舍五入到两位小数进行报告。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the energy asset investment problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (happy path)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [80.0, 90.0, 110.0],\n            'c_om': 5.0,\n            'c_fuel': 25.0,\n            'capital_expenditure': 8000.0,\n            'discount_rate': 0.05\n        },\n        # Test case 2 (boundary neutrality)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [80.0, 80.0, 80.0],\n            'c_om': 5.0,\n            'c_fuel': 25.0,\n            'capital_expenditure': 25000.0,\n            'discount_rate': 0.25\n        },\n        # Test case 3 (edge case with uneconomic asset)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [50.0, 50.0, 50.0],\n            'c_om': 20.0,\n            'c_fuel': 50.0,\n            'capital_expenditure': 1000.0,\n            'discount_rate': 0.00\n        }\n    ]\n\n    final_results = []\n    for params in test_cases:\n        D = params['demands']\n        s = params['spot_prices']\n        c_var = params['c_om'] + params['c_fuel']\n        C = params['capital_expenditure']\n        r = params['discount_rate']\n\n        p_candidates = [-1, 0, 1, 2]\n        costs_by_p = {}\n\n        for p in p_candidates:\n            costs_by_p[p] = calculate_discounted_cost(p, D, s, c_var, C, r)\n\n        # Find the minimum cost from all candidate decisions.\n        if costs_by_p:\n            min_cost_val = min(costs_by_p.values())\n            \n            # Find all p that yield this minimum cost (with a tolerance for floating point comparisons)\n            tied_p = [p for p, cost in costs_by_p.items() if np.isclose(cost, min_cost_val)]\n            \n            # Apply tie-breaking rule: choose the smallest p.\n            p_star = min(tied_p)\n            \n            # The corresponding cost, rounded to two decimal places for the output.\n            cost_star = round(costs_by_p[p_star], 2)\n            \n            final_results.append([p_star, cost_star])\n\n    # Final print statement in the exact required format.\n    # Convert each [p, cost] list to its string representation and join with commas.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\ndef calculate_discounted_cost(p, D, s, c_var, C, r):\n    \"\"\"\n    Calculates the total discounted system cost for a given build decision p.\n\n    Args:\n        p (int): The build period decision, p in {-1, 0, 1, 2}.\n        D (list): List of energy demands [D_0, D_1, D_2].\n        s (list): List of spot market prices [s_0, s_1, s_2].\n        c_var (float): The variable cost of the asset per MWh.\n        C (float): The one-time capital expenditure.\n        r (float): The real discount rate.\n\n    Returns:\n        float: The total discounted cost at period 0.\n    \"\"\"\n    num_periods = 3\n    discount_term = 1.0 + r\n    \n    total_cost = 0.0\n\n    if p == -1:\n        # Asset is never built. All demand is met by the spot market.\n        for t in range(num_periods):\n            cost_t = s[t] * D[t]\n            total_cost += cost_t / (discount_term ** t)\n    else:\n        # Asset is built in period p >= 0.\n        # Add discounted capital expenditure.\n        total_cost += C / (discount_term ** p)\n        \n        # Add discounted operational costs for all periods.\n        for t in range(num_periods):\n            if t  p:\n                # Before build: use spot market.\n                cost_t = s[t] * D[t]\n            else:\n                # After build (t >= p): use own asset.\n                cost_t = c_var * D[t]\n            \n            total_cost += cost_t / (discount_term ** t)\n            \n    return total_cost\n\n\nsolve()\n```"
        }
    ]
}