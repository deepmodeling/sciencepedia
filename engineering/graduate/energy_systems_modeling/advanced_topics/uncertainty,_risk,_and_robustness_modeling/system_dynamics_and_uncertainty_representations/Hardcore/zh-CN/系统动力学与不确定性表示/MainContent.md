## 引言
能源系统正经历着前所未有的转型，其复杂性、规模和不确定性日益增加。为了可靠、高效地设计、运营和规划未来的能源基础设施，我们必须超越[静态分析](@entry_id:755368)，深入理解其动态行为，并严谨地处理风能、太阳能和负荷等带来的不确定性。然而，将复杂的物理过程转化为可分析的数学模型，并在不确定性的迷雾中做出最优决策，是一项巨大的挑战。这需要一个坚实的理论框架，能够统一描述系统的动态演化和固有的随机性。

本文旨在为应对这一挑战提供一个全面的指南，系统介绍能源系统建模中的[系统动力学](@entry_id:136288)原理与不确定性表征方法。文章将分为三个核心部分，引导读者逐步深入该领域：

第一章“原理与机制”将奠定理论基石，详细介绍如何使用[状态空间](@entry_id:160914)方法和[微分代数方程](@entry_id:748394)来构建动态模型，探讨系统稳定性的核心概念，并建立一个用于分类和表征不确定性的严谨框架。

第二章“应用与跨学科连接”将理论付诸实践，展示这些原理如何应用于高保真的热-水力网络和[电力](@entry_id:264587)电子系统建模，并探讨如何利用[随机规划](@entry_id:168183)和鲁棒优化等先进工具，在不确定性下制定最优决策。

第三章“动手实践”则通过一系列精心设计的计算练习，让读者亲手实现[不确定性传播](@entry_id:146574)分析、鲁棒与[随机优化](@entry_id:178938)对比以及最优实验设计，将理论知识转化为解决实际问题的能力。

通过学习本文，读者将能够掌握从建立动态模型到在不确定性下进行决策的全过程，为在能源系统及相关领域的深入研究和工程实践打下坚实的基础。

## 原理与机制

本章旨在阐述[能源系统建模](@entry_id:1124496)中的核心动态原理和不确定性表征机制。在前一章介绍背景之后，我们将深入探讨如何构建和分析能源系统的动态模型，理解其稳定性，并采用严谨的数学框架来表征和处理固有的不确定性。这些原理是进行可靠的系统设计、控制和运营规划的基石。

### 能源系统[动态建模](@entry_id:275410)

为了预测和控制能源系统的行为，我们必须首先将其物理过程转化为数学语言。[状态空间表示](@entry_id:147149)法为这一任务提供了强大的框架。

#### [状态空间表示](@entry_id:147149)法

一个动态系统的**状态 (state)** 是一个变量集合，其在任意时刻 $t$ 的值，连同该时刻及之后的所有输入，完全决定了系统未来的演化。从物理角度看，状态变量通常与系统中的储能元件或惯性元件相关联，因为这些元件的行为依赖于其历史积分。在能源系统中，典型的状态变量包括电池的储能量、同步[发电机](@entry_id:268282)的转子角度和速度、建筑物的内部温度或储热罐的热能，以及天然[气管](@entry_id:274814)道中的管存量 。我们将[状态变量](@entry_id:138790)组织成一个向量，记为 $x(t)$。

系统的演化还受到外部作用的影响，这些作用可分为两类：

1.  **输入 (input)** 或控制向量 $u(t)$，包含可由操作员或控制系统主动调节的量。例如，电池的充放电功率设定点、热电联产（CHP）机组的燃料供给率或阀门开度等 。

2.  **扰动 (disturbance)** 向量 $w(t)$，包含外部的、不可控的输入。这通常包括[电力](@entry_id:264587)和热负荷需求、可再生能源（如光伏）的发电量以及环境条件（如环境温度）。

最后，我们通过**输出 (output)** 向量 $y(t)$ 来监测系统的性能。输出是状态、输入和扰动的函数，代表我们能够测量或关心的物理量，例如电网公共耦合点的电压和功率、关键负荷的供热率等。

#### [常微分方程](@entry_id:147024) (ODE) 与[微分代数方程 (DAE)](@entry_id:1123676)

最简单的动态系统模型形式是**常微分方程 (Ordinary Differential Equation, ODE)**：
$$
\dot{x} = f(x, u, w, t)
$$
其中 $\dot{x}$ 表示[状态向量](@entry_id:154607) $x$ 对时间的导数。这种形式表明，状态的变化率在任何时刻都完全由当前的状态、输入和扰动确定。

然而，许[多能源系统](@entry_id:1128259)包含一些必须在所有时刻都满足的瞬时约束，这些约束并非源于储能动态。例如，在[电力](@entry_id:264587)网络中，基尔霍夫电流定律和电压定律在准[稳态](@entry_id:139253)时间尺度上必须瞬间成立；在流体网络中，节点处的[质量守恒](@entry_id:204015)和管道的[压降](@entry_id:199916)关系也通常被建模为代数方程。这些约束不能表示为状态的微分形式。

为了处理这类系统，我们需要使用**[微分代数方程](@entry_id:748394) (Differential-Algebraic Equation, DAE)**。一种常见的形式是半显式 index-1 DAE：
$$
\begin{align*}
\dot{x}  = f(x, z, u, w, t) \\
0  = g(x, z, u, w, t)
\end{align*}
$$
在这里，除了状态向量 $x$ 之外，我们还引入了**代数变量 (algebraic variables)** $z$。代数变量是那些其值由[代数方程](@entry_id:272665) $g=0$ 瞬时确定的量。在能源系统中，代数变量的典型例子包括[电力](@entry_id:264587)网络中各母线的电压幅值和相角、支路功率流，以及水力网络中各节点的压力和流量 。

“index-1”这一术语表示代数约束 $g$ 对于代数变量 $z$ 的[雅可比矩阵](@entry_id:178326) $\frac{\partial g}{\partial z}$ 是非奇异的。这意味着在局部，我们可以从 $g=0$ 中唯一地求解出 $z$ 作为 $x, u, w, t$ 的函数。因此，[代数方程](@entry_id:272665)将状态变量和代数变量耦合在一起，必须在仿真和控制的每一步都予以满足。只有当系统中不存在这类瞬时约束，或者这些约束可以被显式地求解并代入[微分](@entry_id:158422)方程中以消除代数变量时，我们才可以使用纯 ODE 模型。

### 稳定性与局部系统行为

在建立了系统模型之后，一个核心问题是分析其在平衡点附近的稳定性。这对于确保系统在受到扰动后能够恢复到正常运行状态至关重要。

#### 平衡点与线性化

一个动态系统的**平衡点 (equilibrium point)** $(x^\star, u^\star)$ 是一个状态-控制对，在该点上，如果输入保持为 $u^\star$，系统的状态将保持在 $x^\star$ 不变。数学上，它满足 $\dot{x} = f(x^\star, u^\star) = 0$。

由于能源系统的动态通常是[非线性](@entry_id:637147)的，直接分析其行为可能非常困难。一个强大的技术是**线性化 (linearization)**，即在平衡点附近用一个[线性系统](@entry_id:147850)来近似非线性系统。我们考虑状态和输入在平衡点附近的微小扰动，记为 $\delta x(t) = x(t) - x^\star$ 和 $\delta u(t) = u(t) - u^\star$。通过对函数 $f(x, u)$ 在 $(x^\star, u^\star)$ 处进行一阶[泰勒展开](@entry_id:145057)，我们得到线性化的**小信号模型 (small-signal model)**：
$$
\delta\dot{x} = A\,\delta x + B\,\delta u
$$
其中，$A$ 和 $B$ 是在平衡点处求值的[雅可比矩阵](@entry_id:178326)：
$$
A = \frac{\partial f}{\partial x}\bigg|_{(x^\star, u^\star)}, \quad B = \frac{\partial f}{\partial u}\bigg|_{(x^\star, u^\star)}
$$
这个线性模型描述了系统对偏离平衡点的微小扰动的响应。矩阵 $A$ 被称为**系统矩阵**或状态矩阵，其性质（特别是其特征值）决定了系统的[局部稳定性](@entry_id:751408)。

例如，考虑一个储能子系统，其储能 $E$ 和温度 $T$ 的动态由非线性方程描述 。通过设置 $\dot{E}=0$ 和 $\dot{T}=0$，我们可以求解出在给定控制输入 $u^\star$ 下的平衡状态 $(E^\star, T^\star)$。然后，通过计算在 $(E^\star, T^\star, u^\star)$ 处的偏导数，可以得到[系统矩阵](@entry_id:172230) $A$。由于 $A$ 是一个下[三角矩阵](@entry_id:636278)，其特征值就是其对角线元素。这些特征值决定了当系统受到微小扰动时，储能和温度将如何恢复到其平衡值。

#### 稳定性的基本概念

[系统矩阵](@entry_id:172230) $A$ 的特征值揭示了系统的稳定性。对于一个平衡点，有几种不同层次的稳定性定义，理解它们的区别对于能源系统的运行至关重要 。

1.  **[李雅普诺夫稳定性](@entry_id:147734) (Lyapunov Stability)**：如果对于任意给定的容差范围 $\varepsilon > 0$，总能找到一个初始扰动范围 $\delta > 0$，使得只要初始状态在平衡点的 $\delta$ 邻域内，系统的轨迹将永远保持在 $\varepsilon$ 邻域内，那么该平衡点是李雅普诺夫稳定的。这保证了小的扰动不会导致大的偏离，但并不保证系统会回到平衡点。在[电网频率调节](@entry_id:1125790)中，这意味着小的初始频率偏差将保持在可接受的范围内，但频率可能不会恢复到标称值，而是围绕它持续振荡。

2.  **[渐近稳定性](@entry_id:149743) (Asymptotic Stability)**：如果一个平衡点既是李雅普诺夫稳定的，又是**局部吸引的 (locally attractive)**（即，所有从其附近某个区域出发的轨迹最终都收敛到该平衡点），那么它是[渐近稳定](@entry_id:168077)的。这个概念比[李雅普诺夫稳定性](@entry_id:147734)更强，它保证了系统在受到扰动后不仅保持有界，而且最终会恢复到平衡状态。需要强调的是，[渐近稳定性](@entry_id:149743)必须包含[李雅普诺夫稳定性](@entry_id:147734)；仅仅收敛（吸引性）是不够的，因为轨迹在收敛前可能会出现不可接受的大幅瞬态偏离。

3.  **[指数稳定性](@entry_id:169260) (Exponential Stability)**：这是[渐近稳定性](@entry_id:149743)的一个更强的形式。如果存在正常数 $M$ 和 $\lambda$，使得对于平衡点附近的所有初始状态，轨迹满足 $\|x(t)-x^\star\| \le M e^{-\lambda t}\|x(0)-x^\star\|$，那么该平衡点是指数稳定的。这不仅保证了收敛，还提供了一个收敛速率的下限 $\lambda$。对于线性系统 $\dot{x} = Ax$，[指数稳定性](@entry_id:169260)等价于矩阵 $A$ 的所有特征值的实部都为负。这在操作上非常有用，因为它允许我们计算系统从扰动中恢复到给定容差范围内所需的最长时间，即**镇定时间 (settling time)**。例如，在简单的[频率调节](@entry_id:1125323)模型中，恢复时间可以通过特征值（由阻尼和下垂系数决定）和初始偏差来估算 。

对于[线性时不变系统](@entry_id:178866)，[指数稳定性](@entry_id:169260)等价于存在一个[对称正定矩阵](@entry_id:136714) $P$ 满足**[李雅普诺夫方程](@entry_id:156397) (Lyapunov equation)** $A^\top P + P A \prec 0$（即结果为负定矩阵）。这为通过[凸优化](@entry_id:137441)来分析和证明[系统稳定性](@entry_id:273248)提供了强大的工具。

### 动态系统的数值仿真

解析地求解复杂的[非线性](@entry_id:637147) ODE 或 DAE 通常是不可能的。因此，我们依赖[数值积分方法](@entry_id:141406)在离散的时间步长上近似解。

#### 离散化与稳定性保持

数字控制器和仿真软件在离散的时间点 $t_k = k h$（其中 $h$ 是采样周期或步长）上运行。它们需要一个离散时间模型 $x_{k+1} = F(x_k, u_k)$ 来近似连续时间动态 $\dot{x}=f(x,u)$。一个关键问题是：离散化过程是否保持原[连续时间系统](@entry_id:276553)的稳定性？

答案取决于[离散化方法](@entry_id:272547)和步长 $h$。对于一个稳定的[线性系统](@entry_id:147850) $\dot{x}=Ax$，**精确采样**（假设输入在采样间隔内为常数，即零阶保持）会得到离散模型 $x_{k+1} = e^{Ah} x_k$。这种方法完美地保持了稳定性：如果[连续系统](@entry_id:178397)是稳定的，那么对于**任意**步长 $h>0$，离散系统也是稳定的 。

然而，在实践中，我们通常使用[数值近似方法](@entry_id:169303)，如**显式欧拉法 (explicit Euler method)**：$x_{k+1} = x_k + h f(x_k, u_k)$。这类显式方法的稳定性是有条件的。对于稳定的标量方程 $\dot{y} = \lambda y$（其中 $\mathrm{Re}(\lambda)  0$），[显式欧拉法](@entry_id:1124769)只有在步长 $h$ 满足 $|1+h\lambda|  1$ 时才是稳定的。这意味着步长 $h$ 必须足够小，否则数值解会发散，即使原始物理系统是稳定的 。

#### 刚性问题的挑战

在许[多能源系统](@entry_id:1128259)模型中，不同动态过程的时间尺度差异巨大。例如，[电力](@entry_id:264587)电子变换器的动态可能在微秒级别，而[储热](@entry_id:1133030)罐的温度变化可能在小时级别。描述这类系统的 ODE 被称为**刚性 (stiff)**。

刚性系统的特征是，其线性化后的[系统矩阵](@entry_id:172230) $A$ 的特征值 $\lambda_i$ 的实部在数量级上差异悬殊。系统的快速模式（对应于大的负实部特征值）虽然很快衰减，但在数值上对显式积分方法构成了严峻的挑战。为了保持数值稳定，显式方法（如显式欧拉法）的步长 $h$ 必须由最快的模式决定，即 $h \lt 2/|\max_i \mathrm{Re}(\lambda_i)|$。这意味着，为了模拟一个以小时计的慢过程，我们可能被迫使用微秒级的步长，导致计算成本过高 。

为了解决这个问题，我们转向**[隐式积分](@entry_id:1126415)方法 (implicit methods)**，例如**[隐式欧拉法](@entry_id:1126413) (backward Euler method)**：$x_{k+1} = x_k + h f(x_{k+1}, u_k)$。对于标量测试方程 $\dot{y} = \lambda y$，[隐式欧拉法](@entry_id:1126413)的数值解是稳定的，只要 $\mathrm{Re}(\lambda)  0$，**无论步长 $h$ 多大**。这种性质被称为**A-稳定性 (A-stability)**。

A-稳定的[隐式方法](@entry_id:138537)允许我们选择由慢速、我们关心的动态的精度要求的步长，而不受快速瞬态所施加的稳定性限制。这使得它们成为模拟刚性能源系统动态的首选工具，尤其是在参数不确定性可能进一步加剧[特征值分布](@entry_id:194746)范围的情况下 。

### 不确定性的表征与分析

能源系统模型不可避免地受到各种不确定性的影响。严谨地对这些不确定性进行分类和建模是进行鲁棒分析和决策的基础。

#### 不确定性[分类学](@entry_id:172984)

我们可以从两个维度对不确定性进行分类。

第一个维度是其[本体论](@entry_id:909103)性质 ：

-   **[偶然不确定性](@entry_id:634772) (Aleatory Uncertainty)**：源于系统固有的、不可预测的随机性。即使我们拥有完美的知识，这种不确定性也无法消除。典型的例子是风速的[湍流](@entry_id:151300)波动或负荷的瞬时变化。[偶然不确定性](@entry_id:634772)通常通过**概率分布**来建模，例如，将净[负荷预测](@entry_id:1127381)误差建模为一个[随机过程](@entry_id:268487) $w(t)$。

-   **认知不确定性 (Epistemic Uncertainty)**：源于我们对系统知识的缺乏或不完整。原则上，这种不确定性可以通过收集更多数据或改进模型来减小。典型的例子是一个固定但未知的模型参数，如设备效率或[热传导](@entry_id:143509)系数。认知不确定性的建模方法更为多样。虽然可以使用贝叶斯框架下的[主观概率](@entry_id:271766)分布，但在信息稀少时，更保守的方法是使用**[有界集](@entry_id:157754) (bounded sets)**（例如，$\theta \in \Theta$）或**证据理论 (evidence theory)**（如Dempster-Shafer理论）来表示，这些方法不要求对未知参数做出单一的概率分布假设。

第二个维度是其在模型中的表现形式 ：

-   **参数不确定性 (Parameter Uncertainty)**：指模型结构（即控制方程的形式）是固定的，但其中的某些系数或参数的精确值未知。例如，在给定的[交流潮流](@entry_id:1120762)模型中，输电线路的[电抗](@entry_id:275161)值不确定。

-   **结构不确定性 (Structural Uncertainty)**：指模型本身的数学形式或结构存在不确定性或误差。这可能源于物理现象的简化（例如，用线性直流潮流模型近似[非线性](@entry_id:637147)[交流潮流](@entry_id:1120762)模型）、忽略某些动态（例如，忽略[发电机](@entry_id:268282)调速器动态）、或对系统拓扑的错误假设。将一个确定性模型 $\dot{x}=f(x,u)$ 增加一个随机扰动项变为[随机微分方程](@entry_id:146618) $\dot{x}=f(x,u)+\eta(t)$，也属于改变模型结构的行为。

#### [随机过程](@entry_id:268487)建模

许多时变的不确定性，如风速或太阳辐照度，最好用**[随机过程](@entry_id:268487) (stochastic process)** 来建模。理解[随机过程](@entry_id:268487)的性质对于正确使用历史数据至关重要 。

-   **平稳性 (Stationarity)**：一个[随机过程](@entry_id:268487)是严平稳的，如果其所有统计特性（如[联合分布](@entry_id:263960)）都不随时间推移而改变。[弱平稳性](@entry_id:171204)是一个较弱的条件，仅要求均值为常数，且[自协方差函数](@entry_id:262114) $\gamma(\tau) = \mathrm{Cov}(V_t, V_{t+\tau})$ 只依赖于时间差 $\tau$。现实中的风速数据通常表现出日变化和季节性，因此本身是非平稳的。然而，通过移除这些确定性的趋势（例如，减去逐小时的平均值），我们通常可以得到一个近似平稳的残差过程，从而可以应用基于[平稳性假设](@entry_id:272270)的分析工具。

-   **遍历性 (Ergodicity)**：如果一个[平稳过程](@entry_id:196130)的几乎所有样本路径的时间平均都收敛到其系综平均（即[期望值](@entry_id:150961)），则该过程是遍历的。这是一个至关重要的性质，因为它从理论上保证了我们可以用**单条足够长的时间序列**数据来估计整个[随机过程](@entry_id:268487)的统计特性（如平均风功率）。

-   **混合性 (Mixing)**：混合性描述了过程在时间上的依赖性衰减速度。一个强混合过程意味着相隔很远的时间点的事件近似独立。这个性质对于量化诸如风电爬坡之类的短期变异性至关重要，因为爬坡事件正是由强烈的短期自相关性驱动的。错误地假设时间序列的独立性将导致对爬坡风险的严重低估。

对于一个弱[平稳过程](@entry_id:196130)，其方差可以按频率进行分解。根据**[维纳-辛钦定理](@entry_id:188017) (Wiener-Khinchin theorem)**，[功率谱密度](@entry_id:141002) (Power Spectral Density, PSD) 是[自协方差函数](@entry_id:262114)的傅里叶变换。通过分析[功率谱](@entry_id:159996)，我们可以识别出数据中主导的周期性成分，例如对应于24小时周期的日变化峰值 。

#### 敏感度分析：连接输入与输出

在面对众多不确定参数时，**敏感度分析 (sensitivity analysis)** 帮助我们识别哪些输入不确定性对模型输出的影响最大，从而指导数据收集和模型简化的工作。

-   **局部敏感度分析 (Local Sensitivity Analysis)**：这种方法在输入参数的一个标称点（或[工作点](@entry_id:173374)）附近，通过计算输出对每个输入的**[偏导数](@entry_id:146280)**来衡量敏感度。它易于计算和解释，但其有效性局限于输入不确定性范围很小，且模型在该点附近近似线性的情况。对于[非线性模型](@entry_id:276864)，敏感度排序可能会随着标称点的改变而改变，因此其结论不具有全局性 。

-   **全局敏感度分析 (Global Sensitivity Analysis)**：这类方法在整个输入[参数空间](@entry_id:178581)上评估不确定性的影响。其中，基于方差的方法，如**索伯尔指数 (Sobol indices)**，尤为强大。对于相互独立的输入，一阶索伯尔指数 $S_i$ 量化了输入 $X_i$ 单独贡献的输出方差占总方差的比例。高阶指数则量化了输入之间的[交互作用](@entry_id:164533)对输出方差的贡献。例如，对于一个包含乘积项 $\eta C$ 的模型，会存在一个二阶交互指数 $S_{\eta,C}$，它捕捉了由 $\eta$ 和 $C$ 共同变化引起的输出方差部分，这是局部方法无法捕捉的 。索伯尔指数适用于[非线性模型](@entry_id:276864)和非高斯输入，为理解不确定性传播提供了全面的视角。但需要注意，当输入相关时，标准索伯尔指数的解释会变得复杂，需要使用更高级的方法（如[Shapley值](@entry_id:634984)）。

#### 混淆不确定性的危害：[风险评估](@entry_id:170894)案例研究

未能正确区分[偶然不确定性](@entry_id:634772)和认知不确定性会在实际决策中导致严重的后果。让我们通过一个[电力](@entry_id:264587)系统备用容量规划的例子来说明这一点 。

假设一个系统运营商需要确定备用容量 $R$，以满足可靠性目标，即净[负荷预测](@entry_id:1127381)误差 $X$ 超过 $R$ 的概率不大于 $\epsilon$。误差 $X$ 的分布是正态的 $X \mid \theta \sim \mathcal{N}(0, \sigma^2(\theta))$，但其标准差 $\sigma(\theta)$ 本身是一个存在认知不确定性的参数。历史数据表明，即将到来的时段可能属于两种气象状况之一：一种是低波动性 ($\sigma_1=50$ MW，概率为 $0.9$)，另一种是高波动性 ($\sigma_2=150$ MW，概率为 $0.1$)。

一个**错误的做法**是混淆这两种不确定性，例如，通过计算一个“平均”方差 $\mathbb{E}[\sigma^2(\theta)]$，然后基于这个平均方差的单一正态分布来确定备用 $R$。计算表明，这种方法所确定的备用容量在高波动性情景下是严重不足的。其条件超出概率远高于目标值 $\epsilon$，因为平均过程平滑掉了高风险情景的极端性。

一个**严谨的做法**是分离这两种不确定性。这通常采用一种鲁棒的框架：首先处理认知不确定性，即识别出所有可能的情景（或一个高可信度的情景集）；然后，为这个集合中的**每一种**情景（特别是最坏情况）确保[偶然不确定性](@entry_id:634772)得到控制。在本例中，这意味着备用容量 $R$ 必须足够大，以同时满足低波动性和高波动性两种情景下的可靠性目标，即 $R$ 必须基于最坏情况（$\sigma_2=150$ MW）来设置。

这个例子鲜明地展示了本章所介绍原理的实践意义：对系统动态、稳定性及不确定性的深刻理解和严谨处理，是做出可靠和高效的工程决策的根本前提。