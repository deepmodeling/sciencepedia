{
    "hands_on_practices": [
        {
            "introduction": "Robust pathway analysis begins with a clear definition of the future context, particularly the evolution of energy demand. This exercise demonstrates how to construct a quantitative demand scenario by linking energy use to fundamental macroeconomic and demographic drivers through the concept of energy demand elasticity. By working through the underlying differential equations, you will practice the skills needed to create consistent and plausible baselines which are foundational to any energy systems analysis .",
            "id": "4120840",
            "problem": "An energy systems analyst is defining scenarios for long-run final energy demand consistent with macroeconomic and demographic pathways. Let time $t$ be measured in years with $t=0$ corresponding to year $2020$. Gross Domestic Product (GDP) evolves according to a time-varying growth rate $g(t)$ via the differential equation $ \\frac{d\\,GDP(t)}{dt} = g(t)\\,GDP(t)$. Suppose the economy exhibits transitional convergence from an initially elevated growth rate to a long-run constant growth rate, captured by $g(t) = g_{0}\\exp(-\\alpha t) + g_{\\infty}$, where $g_{0} = 0.02$, $\\alpha = 0.05\\,\\text{yr}^{-1}$, and $g_{\\infty} = 0.01$. Population $P(t)$ follows an exponential trajectory with a constant growth rate $h = 0.007\\,\\text{yr}^{-1}$, i.e., $ \\frac{d\\,P(t)}{dt} = h\\,P(t)$. Let the baseline values at $t=0$ be $GDP(0) = GDP_{0}$, $P(0) = P_{0}$, and baseline final energy $E(0) = E_{0} = 400\\,\\text{EJ}$. Define income per capita as $y(t) = \\frac{GDP(t)}{P(t)}$. Assume the constant elasticity of final energy demand with respect to income per capita, defined by the fundamental relationship $ \\epsilon = \\frac{\\partial \\ln E(t)}{\\partial \\ln y(t)}$, holds over the scenario horizon. An econometric assessment using historical annual data from $1990$ to $2020$ controlling for confounders yields an estimate $\\epsilon = 0.60$ to be used for projection purposes.\n\nStarting only from the stated growth laws for $GDP(t)$ and $P(t)$ and the definition of elasticity above, derive the closed-form expression for $E(t)$ as a function of $t$, $E_{0}$, $g_{0}$, $\\alpha$, $g_{\\infty}$, $h$, and $\\epsilon$. Then evaluate the resulting expression at $t = 30$ (year $2050$) using the parameter values provided. Round your numerical answer to $4$ significant figures and express the final energy in $\\text{EJ}$.\n\nIn addition, briefly justify, in principled terms, how $\\epsilon$ can be estimated from historical data consistent with the definition provided, but note that only the numerical value of $E(30)$ is to be reported as your final answer.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and self-contained, permitting a direct solution. The problem requires the derivation of a closed-form expression for final energy demand, $E(t)$, and its evaluation at a specific time point.\n\nThe derivation proceeds in several steps, starting from the fundamental growth laws for Gross Domestic Product ($GDP$) and Population ($P$).\n\nFirst, we solve for $GDP(t)$. The governing differential equation is given as:\n$$ \\frac{d\\,GDP(t)}{dt} = g(t)\\,GDP(t) $$\nwhere the growth rate $g(t)$ is $g(t) = g_{0}\\exp(-\\alpha t) + g_{\\infty}$.\nThis is a first-order linear ordinary differential equation, which can be solved by separation of variables:\n$$ \\frac{d\\,GDP(t)}{GDP(t)} = g(t) dt $$\nIntegrating both sides from the initial time $t=0$ to a general time $t$:\n$$ \\int_{GDP(0)}^{GDP(t)} \\frac{dGDP'}{GDP'} = \\int_{0}^{t} g(\\tau) d\\tau $$\n$$ \\ln(GDP(t)) - \\ln(GDP(0)) = \\int_{0}^{t} (g_{0}\\exp(-\\alpha \\tau) + g_{\\infty}) d\\tau $$\nLetting $GDP(0) = GDP_{0}$, we evaluate the integral:\n$$ \\ln\\left(\\frac{GDP(t)}{GDP_{0}}\\right) = \\left[ -\\frac{g_{0}}{\\alpha}\\exp(-\\alpha \\tau) + g_{\\infty}\\tau \\right]_{0}^{t} $$\n$$ \\ln\\left(\\frac{GDP(t)}{GDP_{0}}\\right) = \\left(-\\frac{g_{0}}{\\alpha}\\exp(-\\alpha t) + g_{\\infty}t\\right) - \\left(-\\frac{g_{0}}{\\alpha}\\exp(0) + 0\\right) = \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + g_{\\infty}t $$\nExponentiating both sides yields the expression for $GDP(t)$:\n$$ GDP(t) = GDP_{0} \\exp\\left( \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + g_{\\infty}t \\right) $$\nSecond, we solve for the population, $P(t)$. The governing equation is:\n$$ \\frac{d\\,P(t)}{dt} = h\\,P(t) $$\nwhere $h$ is a constant growth rate. This is the standard model for exponential growth. With the initial condition $P(0) = P_{0}$, the solution is:\n$$ P(t) = P_{0} \\exp(ht) $$\nThird, we define the income per capita, $y(t)$, as the ratio of $GDP(t)$ to $P(t)$:\n$$ y(t) = \\frac{GDP(t)}{P(t)} = \\frac{GDP_{0}}{P_{0}} \\frac{\\exp\\left( \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + g_{\\infty}t \\right)}{\\exp(ht)} $$\nDefining the initial income per capita as $y(0) = y_{0} = \\frac{GDP_{0}}{P_{0}}$, we can write the relative income per capita growth as:\n$$ \\frac{y(t)}{y_{0}} = \\exp\\left( \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + (g_{\\infty} - h)t \\right) $$\nFourth, we use the definition of the elasticity of final energy demand, $\\epsilon$, to find $E(t)$. The definition is:\n$$ \\epsilon = \\frac{\\partial \\ln E(t)}{\\partial \\ln y(t)} $$\nAssuming $\\epsilon$ is constant, we can treat this as an ordinary differential equation and integrate:\n$$ d\\ln E = \\epsilon \\, d\\ln y $$\n$$ \\int_{\\ln E_{0}}^{\\ln E(t)} d(\\ln E') = \\epsilon \\int_{\\ln y_{0}}^{\\ln y(t)} d(\\ln y') $$\n$$ \\ln E(t) - \\ln E_{0} = \\epsilon (\\ln y(t) - \\ln y_{0}) $$\n$$ \\ln\\left(\\frac{E(t)}{E_{0}}\\right) = \\epsilon \\ln\\left(\\frac{y(t)}{y_{0}}\\right) = \\ln\\left( \\left(\\frac{y(t)}{y_{0}}\\right)^{\\epsilon} \\right) $$\nExponentiating both sides gives the relationship between energy and income:\n$$ E(t) = E_{0} \\left( \\frac{y(t)}{y_{0}} \\right)^{\\epsilon} $$\nSubstituting the expression for $\\frac{y(t)}{y_{0}}$, we arrive at the final closed-form expression for $E(t)$:\n$$ E(t) = E_{0} \\left[ \\exp\\left( \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + (g_{\\infty} - h)t \\right) \\right]^{\\epsilon} $$\n$$ E(t) = E_{0} \\exp\\left( \\epsilon \\left[ \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + (g_{\\infty} - h)t \\right] \\right) $$\nThis expression gives $E(t)$ as a function of the required parameters.\n\nThe problem also asks for a brief justification of how $\\epsilon$ can be estimated from historical data. The definition $\\epsilon = \\frac{\\partial \\ln E}{\\partial \\ln y}$ implies that for small changes, $\\Delta \\ln E \\approx \\epsilon \\Delta \\ln y$. Integrating this relationship under the assumption that $\\epsilon$ is a constant yields a log-log functional form: $\\ln E = C + \\epsilon \\ln y$, where $C$ is a constant of integration. To estimate $\\epsilon$ from a historical time series of energy demand ($E_t$) and income per capita ($y_t$), an analyst would typically specify a linear regression model based on this log-log relationship:\n$$ \\ln(E_{t}) = \\beta_{0} + \\epsilon \\ln(y_{t}) + \\sum_{k} \\gamma_{k} Z_{kt} + u_{t} $$\nIn this model, the coefficient $\\epsilon$ directly estimates the income elasticity. The term $\\sum_{k} \\gamma_{k} Z_{kt}$ represents a set of control variables (the \"confounders\" mentioned in the problem, such as energy prices, technological progress, or policy variables) that also influence energy demand. Including these controls is crucial for isolating the net effect of income on energy, thereby yielding a less biased and more reliable estimate for $\\epsilon$ using methods like Ordinary Least Squares (OLS).\n\nFinally, we evaluate $E(t)$ for $t=30$ years (year $2050$) using the provided parameter values:\n$E_{0} = 400\\,\\text{EJ}$\n$\\epsilon = 0.60$\n$g_{0} = 0.02$\n$\\alpha = 0.05\\,\\text{yr}^{-1}$\n$g_{\\infty} = 0.01$\n$h = 0.007\\,\\text{yr}^{-1}$\n$t = 30\\,\\text{yr}$\n\nWe calculate the terms in the exponent:\nThe term $\\frac{g_{0}}{\\alpha} = \\frac{0.02}{0.05} = 0.4$.\nThe term $\\alpha t = 0.05 \\times 30 = 1.5$.\nThe term $g_{\\infty} - h = 0.01 - 0.007 = 0.003$.\nThe term $(g_{\\infty} - h)t = 0.003 \\times 30 = 0.09$.\n\nThe full argument of the exponential function is:\n$$ \\epsilon \\left[ \\frac{g_{0}}{\\alpha}(1 - \\exp(-\\alpha t)) + (g_{\\infty} - h)t \\right] = 0.60 \\left[ 0.4(1 - \\exp(-1.5)) + 0.09 \\right] $$\n$$ = 0.60 \\left[ 0.4(1 - 0.223130...) + 0.09 \\right] $$\n$$ = 0.60 \\left[ 0.4(0.776870...) + 0.09 \\right] $$\n$$ = 0.60 \\left[ 0.310748... + 0.09 \\right] $$\n$$ = 0.60 [0.400748...] = 0.240449... $$\nNow we compute $E(30)$:\n$$ E(30) = 400 \\times \\exp(0.240449...) $$\n$$ E(30) = 400 \\times 1.271817... = 508.727... $$\nRounding the result to $4$ significant figures, we get $508.7\\,\\text{EJ}$.",
            "answer": "$$\\boxed{508.7}$$"
        },
        {
            "introduction": "After establishing a demand scenario, the next step in pathway analysis is to assemble a portfolio of interventions to meet policy goals, such as emissions reduction. This practice introduces the Marginal Abatement Cost Curve (MACC), a cornerstone tool for identifying the most cost-effective sequence of abatement measures . You will implement the algorithm to build a MACC, which involves not only sorting options by cost but also modeling the complex interactions and overlaps that occur between different technologies in a real-world system.",
            "id": "4120859",
            "problem": "A Marginal Abatement Cost Curve (MACC) organizes emissions reduction measures by their marginal abatement cost to reveal a pathway for cumulative abatement under a defined scenario. Consider a set of five measures indexed by $i \\in \\{1,2,3,4,5\\}$, each characterized by a base abatement potential $P_i$ measured in million tonnes of carbon dioxide per year (MtCO$_2$/year) and a constant marginal cost $c_i$ measured in dollars per tonne of carbon dioxide ($/\\mathrm{tCO_2}$). Interactions between measures are represented by an overlap matrix $O \\in [0,1]^{5 \\times 5}$, with elements $O_{i,j}$ specifying the fraction of the base potential of measure $i$ that becomes infeasible if measure $j$ is implemented before measure $i$. Diagonal elements satisfy $O_{i,i} = 0$. Assume overlaps act independently across different previously implemented measures.\n\nYour task is to construct the MACC by sorting measures in ascending order of $c_i$, breaking ties by the lower index $i$, then computing the adjusted incremental abatement for each measure in that order by applying the independence assumption to determine the remaining feasible fraction of $P_i$ after accounting for overlaps from the already selected set. Compute the cumulative abatement after each measure is added. For each test case, also compute the realized total abatement and the ratio of realized total abatement to the naive sum of base potentials. Express all abatement quantities in MtCO$_2$/year and the ratio as a dimensionless decimal (not a percentage). Round all floating-point outputs to three decimal places.\n\nUse the following test suite of parameter values, each test case defined by $(P, c, O)$:\n\n- Test Case A (no overlaps, distinct costs):\n    - $P = [10.0, 15.0, 5.0, 8.0, 12.0]$ MtCO$_2$/year.\n    - $c = [60.0, 25.0, 90.0, 35.0, 45.0]$ $/\\mathrm{tCO_2}$.\n    - $O$ is the $5 \\times 5$ zero matrix with $O_{i,j} = 0$ for all $i,j$.\n\n- Test Case B (partial overlaps, ascending costs prioritize interactions):\n    - $P = [12.0, 9.0, 14.0, 6.0, 10.0]$ MtCO$_2$/year.\n    - $c = [30.0, 40.0, 20.0, 70.0, 50.0]$ $/\\mathrm{tCO_2}$.\n    - Nonzero overlap entries:\n        - $O_{1,3} = 0.25$,\n        - $O_{2,1} = 0.10$,\n        - $O_{5,1} = 0.20$,\n        - $O_{5,2} = 0.50$,\n      with all other $O_{i,j} = 0$ and $O_{i,i} = 0$.\n    \n- Test Case C (strong overlaps, tie costs, negative cost):\n    - $P = [20.0, 18.0, 16.0, 14.0, 12.0]$ MtCO$_2$/year.\n    - $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$ $/\\mathrm{tCO_2}$, with a tie for measures $i=2$ and $i=3$ resolved by lower index first.\n    - Nonzero overlap entries:\n        - $O_{2,1} = 0.90$,\n        - $O_{3,1} = 0.60$,\n        - $O_{4,1} = 1.00$,\n        - $O_{5,2} = 0.50$,\n        - $O_{5,3} = 0.60$,\n        - $O_{3,2} = 0.20$,\n      with all other $O_{i,j} = 0$ and $O_{i,i} = 0$.\n\nFor each test case, perform the following steps:\n1. Sort measures in ascending order of $c_i$, breaking ties by ascending $i$.\n2. Traverse the sorted list. For each measure $i$, determine its adjusted incremental abatement by applying the independence assumption to the overlaps from measures already implemented, and multiply that remaining feasible fraction by $P_i$.\n3. Compute the cumulative abatement after each measure is added, the realized total abatement (sum of adjusted incremental abatements), the naive total abatement (sum of $P_i$ without interactions), and the ratio of realized to naive abatement.\n4. Round all floating-point outputs to three decimal places.\n\nFinal output format specification:\n- For each test case, produce a list containing:\n    - the sorted order as a list of integers,\n    - the adjusted incremental abatements as a list of floats in MtCO$_2$/year,\n    - the cumulative abatements as a list of floats in MtCO$_2$/year,\n    - the realized total abatement as a float in MtCO$_2$/year,\n    - the naive total abatement as a float in MtCO$_2$/year,\n    - the ratio of realized to naive abatement as a float (decimal).\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list enclosed in square brackets, for example $[result\\_A,result\\_B,result\\_C]$, where each $result$ is the nested list described above.",
            "solution": "The user's problem is subjected to validation prior to presenting a solution.\n\n### Step 1: Extract Givens\n- **Measures**: A set of five measures, indexed by $i \\in \\{1, 2, 3, 4, 5\\}$.\n- **Base Abatement Potential ($P_i$)**: A vector representing the potential of each measure in million tonnes of carbon dioxide per year (MtCO$_2$/year).\n- **Marginal Cost ($c_i$)**: A vector representing the cost of each measure in dollars per tonne of carbon dioxide ($/\\mathrm{tCO_2}$).\n- **Overlap Matrix ($O$)**: A $5 \\times 5$ matrix where $O_{i,j} \\in [0,1]$ is the fraction of the base potential of measure $i$ that becomes infeasible if measure $j$ is implemented before measure $i$.\n- **Overlap Matrix Properties**: Diagonal elements $O_{i,i} = 0$.\n- **Independence Assumption**: Overlaps from different previously implemented measures act independently.\n- **Sorting Rule**: Measures are sorted in ascending order of marginal cost $c_i$. Ties are broken by the lower measure index $i$.\n- **Calculation Tasks**: For a given sorted order, compute the adjusted incremental abatement, cumulative abatement, realized total abatement, naive total abatement (simple sum of $P_i$), and the ratio of realized to naive total abatement.\n- **Rounding Rule**: All final-output floating-point numbers must be rounded to three decimal places.\n- **Test Case A**:\n    - $P = [10.0, 15.0, 5.0, 8.0, 12.0]$\n    - $c = [60.0, 25.0, 90.0, 35.0, 45.0]$\n    - $O$ is the $5 \\times 5$ zero matrix.\n- **Test Case B**:\n    - $P = [12.0, 9.0, 14.0, 6.0, 10.0]$\n    - $c = [30.0, 40.0, 20.0, 70.0, 50.0]$\n    - Nonzero $O_{i,j}$: $O_{1,3} = 0.25$, $O_{2,1} = 0.10$, $O_{5,1} = 0.20$, $O_{5,2} = 0.50$.\n- **Test Case C**:\n    - $P = [20.0, 18.0, 16.0, 14.0, 12.0]$\n    - $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$\n    - Nonzero $O_{i,j}$: $O_{2,1} = 0.90$, $O_{3,1} = 0.60$, $O_{4,1} = 1.00$, $O_{5,2} = 0.50$, $O_{5,3} = 0.60$, $O_{3,2} = 0.20$.\n- **Output Format**: A single line containing a list of lists, where each inner list corresponds to a test case and contains: [sorted order (list of int), adjusted abatements (list of float), cumulative abatements (list of float), realized total (float), naive total (float), ratio (float)].\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded**: The problem describes the construction of a Marginal Abatement Cost Curve (MACC), a standard and well-established tool in energy systems modeling and environmental economics for planning decarbonization pathways. The use of an overlap matrix to model interactions between measures is a valid and common simplification. The concept of a negative cost is standard, representing measures that are profitable on their own (e.g., energy efficiency). The setup is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data ($P$, $c$, $O$) for three distinct test cases. The procedure for constructing the MACC is explicitly defined: a lexicographical sort on the pair $(c_i, i)$ provides a unique ordering of measures. The rule for calculating adjusted abatement, based on an \"independence assumption,\" is also clearly specified. This structure ensures a unique and meaningful solution can be computed for each test case.\n- **Objective**: The problem is stated in precise, objective, and quantitative terms. There is no subjective or ambiguous language.\n- **Other Flaws**: The problem does not violate any other invalidity criteria. It is not incomplete, contradictory, unrealistic, ill-posed, or trivial. It is a formalizable problem directly relevant to the specified domain.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided below.\n\n### Principle-Based Solution\n\nThe problem requires constructing a Marginal Abatement Cost Curve (MACC) by sequentially implementing abatement measures and accounting for their interactions. The core of the problem lies in the algorithm for selecting measures and adjusting their abatement potential based on those already implemented.\n\nLet the set of measures be $\\mathcal{M} = \\{1, 2, 3, 4, 5\\}$. Each measure $i \\in \\mathcal{M}$ is defined by its base abatement potential $P_i$ and its marginal cost $c_i$. The interaction between measures is captured by the overlap matrix $O$, where $O_{i,j}$ represents the fractional loss of potential for measure $i$ if measure $j$ is implemented first.\n\n**1. Sorting the Measures**\nThe first step is to establish the order of implementation. The problem dictates that measures are sorted in ascending order of their marginal cost $c_i$. Any ties in cost are resolved by choosing the measure with the lower index $i$. This defines a unique sequence of implementation. Let this sorted sequence of indices be denoted by $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)$.\n\n**2. Calculating Adjusted Abatement**\nThe abatement potential of a measure is reduced by the implementation of prior measures in the sequence. The \"independence assumption\" implies that the effects of these overlaps are multiplicative.\nLet $S_{k-1} = \\{\\pi_1, \\pi_2, \\dots, \\pi_{k-1}\\}$ be the set of indices of measures implemented in the first $k-1$ steps. When considering the $k$-th measure in the sequence, $i = \\pi_k$, its remaining feasible fraction, $f_i$, is calculated by considering the overlaps from all measures $j \\in S_{k-1}$. The fraction of potential for measure $i$ that remains after implementing measure $j$ is $(1 - O_{i,j})$. Due to independence, the total remaining fraction is the product:\n$$ f_i = \\prod_{j \\in S_{k-1}} (1 - O_{i,j}) $$\nThe adjusted incremental abatement for measure $i$, denoted $A_i^{\\text{adj}}$, is its base potential multiplied by this feasible fraction:\n$$ A_i^{\\text{adj}} = P_i \\times f_i = P_i \\times \\prod_{j \\in S_{k-1}} (1 - O_{i,j}) $$\n\n**3. Calculating Cumulative Abatement and Totals**\nAs each measure is added, the cumulative abatement is updated. The cumulative abatement after the $k$-th step, $C_k$, is the sum of the adjusted abatements of all measures implemented up to that point:\n$$ C_k = \\sum_{m=1}^{k} A_{\\pi_m}^{\\text{adj}} = C_{k-1} + A_{\\pi_k}^{\\text{adj}} \\quad (\\text{with } C_0 = 0) $$\nAfter all measures are processed, several total quantities are determined:\n- **Naive Total Abatement ($A_{\\text{total}}^{\\text{naive}}$)**: The theoretical maximum abatement if no overlaps existed. It is the simple sum of the base potentials:\n  $$ A_{\\text{total}}^{\\text{naive}} = \\sum_{i=1}^{5} P_i $$\n- **Realized Total Abatement ($A_{\\text{total}}^{\\text{realized}}$)**: The actual total abatement achieved after accounting for all overlaps. This is the sum of all adjusted incremental abatements, which is simply the final cumulative abatement, $C_5$:\n  $$ A_{\\text{total}}^{\\text{realized}} = C_5 = \\sum_{k=1}^{5} A_{\\pi_k}^{\\text{adj}} $$\n- **Ratio ($R$)**: The ratio of the realized total abatement to the naive total abatement, indicating the overall impact of measure interactions:\n  $$ R = \\frac{A_{\\text{total}}^{\\text{realized}}}{A_{\\text{total}}^{\\text{naive}}} $$\nAll floating-point results for the final output are rounded to three decimal places.\n\n**Execution for Test Cases:**\n\n**Test Case A:**\n- $P = [10.0, 15.0, 5.0, 8.0, 12.0]$\n- $c = [60.0, 25.0, 90.0, 35.0, 45.0]$\n- $O_{i,j} = 0$ for all $i,j$.\n- **Sorted Order**: The costs are $c_2=25.0, c_4=35.0, c_5=45.0, c_1=60.0, c_3=90.0$. The sorted index sequence is $\\pi = (2, 4, 5, 1, 3)$.\n- **Calculations**: Since all $O_{i,j}=0$, the feasible fraction $f_i$ is always $1$. Thus, $A_i^{\\text{adj}} = P_i$.\n  - Adjusted Abatements (in order of implementation): $[15.0, 8.0, 12.0, 10.0, 5.0]$.\n  - Cumulative Abatements: $[15.0, 23.0, 35.0, 45.0, 50.0]$.\n- **Totals**: $A_{\\text{total}}^{\\text{realized}} = 50.0$. $A_{\\text{total}}^{\\text{naive}} = 10+15+5+8+12 = 50.0$. $R = 50.0 / 50.0 = 1.0$.\n\n**Test Case B:**\n- $P = [12.0, 9.0, 14.0, 6.0, 10.0]$\n- $c = [30.0, 40.0, 20.0, 70.0, 50.0]$\n- Nonzero $O$: $O_{1,3} = 0.25$, $O_{2,1} = 0.10$, $O_{5,1} = 0.20$, $O_{5,2} = 0.50$.\n- **Sorted Order**: The costs are $c_3=20.0, c_1=30.0, c_2=40.0, c_5=50.0, c_4=70.0$. The sorted index sequence is $\\pi = (3, 1, 2, 5, 4)$.\n- **Calculations**:\n  - $k=1, i=3$: $S_0=\\emptyset$. $A_3^{\\text{adj}} = P_3 = 14.0$. $C_1=14.0$.\n  - $k=2, i=1$: $S_1=\\{3\\}$. $A_1^{\\text{adj}} = P_1(1-O_{1,3}) = 12.0(1-0.25) = 9.0$. $C_2=14.0+9.0=23.0$.\n  - $k=3, i=2$: $S_2=\\{3,1\\}$. $A_2^{\\text{adj}} = P_2(1-O_{2,3})(1-O_{2,1}) = 9.0(1-0)(1-0.10) = 8.1$. $C_3=23.0+8.1=31.1$.\n  - $k=4, i=5$: $S_3=\\{3,1,2\\}$. $A_5^{\\text{adj}} = P_5(1-O_{5,3})(1-O_{5,1})(1-O_{5,2}) = 10.0(1-0)(1-0.20)(1-0.50) = 4.0$. $C_4=31.1+4.0=35.1$.\n  - $k=5, i=4$: $S_4=\\{3,1,2,5\\}$. $A_4^{\\text{adj}} = P_4(1) = 6.0$. $C_5=35.1+6.0=41.1$.\n- **Totals**: $A_{\\text{total}}^{\\text{realized}} = 41.1$. $A_{\\text{total}}^{\\text{naive}} = 12+9+14+6+10 = 51.0$. $R = 41.1 / 51.0 \\approx 0.806$.\n\n**Test Case C:**\n- $P = [20.0, 18.0, 16.0, 14.0, 12.0]$\n- $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$\n- Nonzero $O$: $O_{2,1}=0.90, O_{3,1}=0.60, O_{4,1}=1.00, O_{5,2}=0.50, O_{5,3}=0.60, O_{3,2}=0.20$.\n- **Sorted Order**: Costs are $c_1=-15.0$. $c_2=c_3=25.0$. The tie is broken by index ($2<3$). So, the order is $c_1, c_2, c_3, c_4, c_5$. The sorted index sequence is $\\pi = (1, 2, 3, 4, 5)$.\n- **Calculations**:\n  - $k=1, i=1$: $S_0=\\emptyset$. $A_1^{\\text{adj}} = P_1 = 20.0$. $C_1=20.0$.\n  - $k=2, i=2$: $S_1=\\{1\\}$. $A_2^{\\text{adj}} = P_2(1-O_{2,1}) = 18.0(1-0.90) = 1.8$. $C_2=20.0+1.8=21.8$.\n  - $k=3, i=3$: $S_2=\\{1,2\\}$. $A_3^{\\text{adj}} = P_3(1-O_{3,1})(1-O_{3,2}) = 16.0(1-0.60)(1-0.20) = 5.12$. $C_3=21.8+5.12=26.92$.\n  - $k=4, i=4$: $S_3=\\{1,2,3\\}$. $A_4^{\\text{adj}} = P_4(1-O_{4,1})(1-O_{4,2})(1-O_{4,3}) = 14.0(1-1.00)(1-0)(1-0) = 0.0$. $C_4=26.92+0=26.92$.\n  - $k=5, i=5$: $S_4=\\{1,2,3,4\\}$. $A_5^{\\text{adj}} = P_5(1-O_{5,1})(1-O_{5,2})(1-O_{5,3})(1-O_{5,4}) = 12.0(1-0)(1-0.50)(1-0.60)(1-0) = 2.4$. $C_5=26.92+2.4=29.32$.\n- **Totals**: $A_{\\text{total}}^{\\text{realized}} = 29.32$. $A_{\\text{total}}^{\\text{naive}} = 20+18+16+14+12 = 80.0$. $R = 29.32 / 80.0 = 0.3665 \\approx 0.367$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Marginal Abatement Cost Curve pathway analysis for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A (no overlaps, distinct costs)\n        (\n            [10.0, 15.0, 5.0, 8.0, 12.0],\n            [60.0, 25.0, 90.0, 35.0, 45.0],\n            np.zeros((5, 5)).tolist()\n        ),\n        # Test Case B (partial overlaps, ascending costs prioritize interactions)\n        (\n            [12.0, 9.0, 14.0, 6.0, 10.0],\n            [30.0, 40.0, 20.0, 70.0, 50.0],\n            [\n                [0.0, 0.0, 0.25, 0.0, 0.0],\n                [0.10, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.20, 0.50, 0.0, 0.0, 0.0]\n            ]\n        ),\n        # Test Case C (strong overlaps, tie costs, negative cost)\n        (\n            [20.0, 18.0, 16.0, 14.0, 12.0],\n            [-15.0, 25.0, 25.0, 60.0, 100.0],\n            [\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.90, 0.0, 0.0, 0.0, 0.0],\n                [0.60, 0.20, 0.0, 0.0, 0.0],\n                [1.00, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.50, 0.60, 0.0, 0.0]\n            ]\n        )\n    ]\n\n    results = []\n    for P_list, c_list, O_list in test_cases:\n        P = np.array(P_list, dtype=float)\n        c = np.array(c_list, dtype=float)\n        O = np.array(O_list, dtype=float)\n        num_measures = len(P)\n\n        # 1. Sort measures in ascending order of cost, breaking ties by index.\n        # Problem uses 1-based indexing for measures.\n        measures_to_sort = [(c[i], i + 1) for i in range(num_measures)]\n        measures_to_sort.sort()\n        sorted_indices_1based = [m[1] for m in measures_to_sort]\n\n        # 2. Traverse the sorted list and compute abatements.\n        adj_abatement_unrounded = []\n        cum_abatement_unrounded = []\n        current_cumulative_unrounded = 0.0\n        implemented_indices_1based_set = set()\n\n        for measure_idx_1based in sorted_indices_1based:\n            py_idx = measure_idx_1based - 1\n\n            # Calculate the feasible fraction based on overlaps from already implemented measures.\n            feasible_fraction = 1.0\n            for implemented_idx_1based in implemented_indices_1based_set:\n                implemented_py_idx = implemented_idx_1based - 1\n                # O[i,j] is the fraction of i's potential lost due to j.\n                overlap = O[py_idx, implemented_py_idx]\n                feasible_fraction *= (1.0 - overlap)\n\n            # Calculate adjusted incremental abatement.\n            adj_abatement = P[py_idx] * feasible_fraction\n            adj_abatement_unrounded.append(adj_abatement)\n\n            # Update cumulative abatement.\n            current_cumulative_unrounded += adj_abatement\n            cum_abatement_unrounded.append(current_cumulative_unrounded)\n\n            # Add the current measure to the set of implemented measures.\n            implemented_indices_1based_set.add(measure_idx_1based)\n\n        # 3. Compute final totals and ratio.\n        realized_total_unrounded = current_cumulative_unrounded\n        naive_total_unrounded = np.sum(P)\n        ratio = (realized_total_unrounded / naive_total_unrounded) if naive_total_unrounded != 0 else 0.0\n\n        # 4. Round all floating-point outputs to three decimal places.\n        adj_abatements_rounded = [round(x, 3) for x in adj_abatement_unrounded]\n        cum_abatements_rounded = [round(x, 3) for x in cum_abatement_unrounded]\n        realized_total_rounded = round(realized_total_unrounded, 3)\n        naive_total_rounded = round(naive_total_unrounded, 3)\n        ratio_rounded = round(ratio, 3)\n\n        # Assemble the final list for this test case.\n        case_result = [\n            sorted_indices_1based,\n            adj_abatements_rounded,\n            cum_abatements_rounded,\n            realized_total_rounded,\n            naive_total_rounded,\n            ratio_rounded\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # Convert each case_result (which is a list) to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Energy transition pathways unfold over decades, involving large capital expenditures at different points in time. To compare the economic viability of different investment strategies, we must account for the time value of money using discounting . This exercise provides hands-on practice with calculating the Net Present Cost ($NPC$) for two distinct pathways, allowing you to determine the critical \"crossover\" discount rate that dictates which strategy is more economically favorable.",
            "id": "4120777",
            "problem": "A regional power system authority is defining two decarbonization pathways over a horizon of $10$ years. Pathway $\\mathrm{A}$ front-loads investment in firm low-carbon capacity with a smaller reinvestment near the end of the horizon. Pathway $\\mathrm{B}$ defers some investment and relies on mid-horizon retrofits followed by a larger upgrade at the end of the horizon. All costs are real (inflation-adjusted), deterministic, and expressed in the same currency. The authority adopts standard time-preference discounting with a constant real discount rate $r$ per year. The Net Present Cost (NPC) is defined by the standard discounting formula\n$$\nNPC \\;=\\; \\sum_{t} \\frac{C_{t}}{(1+r)^{t}},\n$$\nwhere $C_{t}$ is the undiscounted cost at year $t$.\n\nThe cost streams for the two pathways are:\n- Pathway $\\mathrm{A}$: an immediate capital expenditure of $C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$ at year $0$, and a reinvestment of $C^{\\mathrm{A}}_{10} = 1.5 \\times 10^{9}$ at year $10$.\n- Pathway $\\mathrm{B}$: a retrofit expenditure of $C^{\\mathrm{B}}_{5} = 3.0 \\times 10^{9}$ at year $5$, and an upgrade of $C^{\\mathrm{B}}_{10} = 2.5 \\times 10^{9}$ at year $10$.\n\nStarting from the definition of discounting and the Net Present Cost, derive expressions for $NPC_{\\mathrm{A}}(r)$ and $NPC_{\\mathrm{B}}(r)$ as functions of $r$, and then determine the threshold discount rate $r^{\\star}$ (expressed as a decimal per year) at which $NPC_{\\mathrm{A}}(r^{\\star}) = NPC_{\\mathrm{B}}(r^{\\star})$. Provide $r^{\\star}$ as a single closed-form analytic expression. Also, explain qualitatively, using the structure of the derived expressions, how varying $r$ changes which pathway is preferred. Do not use a percentage sign; express any rate as a decimal. No rounding is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It represents a standard application of discounted cash flow analysis in the context of energy systems planning. The data provided are consistent and sufficient for a unique solution.\n\nThe Net Present Cost ($NPC$) is given by the formula:\n$$\nNPC = \\sum_{t} \\frac{C_{t}}{(1+r)^{t}}\n$$\nwhere $C_{t}$ is the undiscounted cost at year $t$ and $r$ is the real discount rate.\n\nFirst, we derive the expressions for the Net Present Cost for each pathway, $NPC_{\\mathrm{A}}(r)$ and $NPC_{\\mathrm{B}}(r)$.\n\nFor Pathway $\\mathrm{A}$, costs are incurred at $t=0$ and $t=10$. The cost stream is $C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$ and $C^{\\mathrm{A}}_{10} = 1.5 \\times 10^{9}$.\nThe Net Present Cost for Pathway $\\mathrm{A}$ is:\n$$\nNPC_{\\mathrm{A}}(r) = \\frac{C^{\\mathrm{A}}_{0}}{(1+r)^{0}} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r)^{10}} = C^{\\mathrm{A}}_{0} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r)^{10}}\n$$\nSubstituting the given values:\n$$\nNPC_{\\mathrm{A}}(r) = 2.0 \\times 10^{9} + \\frac{1.5 \\times 10^{9}}{(1+r)^{10}}\n$$\n\nFor Pathway $\\mathrm{B}$, costs are incurred at $t=5$ and $t=10$. The cost stream is $C^{\\mathrm{B}}_{5} = 3.0 \\times 10^{9}$ and $C^{\\mathrm{B}}_{10} = 2.5 \\times 10^{9}$.\nThe Net Present Cost for Pathway $\\mathrm{B}$ is:\n$$\nNPC_{\\mathrm{B}}(r) = \\frac{C^{\\mathrm{B}}_{5}}{(1+r)^{5}} + \\frac{C^{\\mathrm{B}}_{10}}{(1+r)^{10}}\n$$\nSubstituting the given values:\n$$\nNPC_{\\mathrm{B}}(r) = \\frac{3.0 \\times 10^{9}}{(1+r)^{5}} + \\frac{2.5 \\times 10^{9}}{(1+r)^{10}}\n$$\n\nNext, we must find the threshold discount rate $r^{\\star}$ at which the Net Present Costs of the two pathways are equal, i.e., $NPC_{\\mathrm{A}}(r^{\\star}) = NPC_{\\mathrm{B}}(r^{\\star})$.\n$$\nC^{\\mathrm{A}}_{0} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r^{\\star})^{10}} = \\frac{C^{\\mathrm{B}}_{5}}{(1+r^{\\star})^{5}} + \\frac{C^{\\mathrm{B}}_{10}}{(1+r^{\\star})^{10}}\n$$\nWe can simplify by dividing all terms by the common factor of $10^{9}$:\n$$\n2.0 + \\frac{1.5}{(1+r^{\\star})^{10}} = \\frac{3.0}{(1+r^{\\star})^{5}} + \\frac{2.5}{(1+r^{\\star})^{10}}\n$$\nTo solve for $r^{\\star}$, let us introduce a substitution to transform the equation into a more familiar form. Let $x = \\frac{1}{(1+r^{\\star})^{5}}$. Consequently, $x^{2} = \\left(\\frac{1}{(1+r^{\\star})^{5}}\\right)^{2} = \\frac{1}{(1+r^{\\star})^{10}}$.\nSubstituting $x$ into the equation gives:\n$$\n2.0 + 1.5 x^{2} = 3.0 x + 2.5 x^{2}\n$$\nRearranging the terms yields a standard quadratic equation of the form $ax^2 + bx + c = 0$:\n$$\n(2.5 - 1.5)x^{2} + 3.0 x - 2.0 = 0\n$$\n$$\n1.0 x^{2} + 3.0 x - 2.0 = 0\n$$\nWe solve for $x$ using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$:\n$$\nx = \\frac{-3.0 \\pm \\sqrt{(3.0)^{2} - 4(1.0)(-2.0)}}{2(1.0)}\n$$\n$$\nx = \\frac{-3.0 \\pm \\sqrt{9.0 + 8.0}}{2}\n$$\n$$\nx = \\frac{-3.0 \\pm \\sqrt{17}}{2}\n$$\nSince $r$ is a real discount rate, we expect $r > -1$, and in most economic contexts, $r \\ge 0$. This implies $1+r^{\\star} > 0$. Therefore, $x = (1+r^{\\star})^{-5}$ must be a positive real number. The root $x = \\frac{-3.0 - \\sqrt{17}}{2}$ is negative and thus is not a physically meaningful solution. We must select the positive root:\n$$\nx = \\frac{-3.0 + \\sqrt{17}}{2}\n$$\nNow, we substitute back $x = \\frac{1}{(1+r^{\\star})^{5}}$ to solve for $r^{\\star}$:\n$$\n\\frac{1}{(1+r^{\\star})^{5}} = \\frac{\\sqrt{17} - 3}{2}\n$$\nInverting both sides gives:\n$$\n(1+r^{\\star})^{5} = \\frac{2}{\\sqrt{17} - 3}\n$$\nTaking the fifth root of both sides:\n$$\n1+r^{\\star} = \\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5}\n$$\nFinally, isolating $r^{\\star}$ yields the closed-form analytic expression:\n$$\nr^{\\star} = \\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5} - 1\n$$\n\nFor the qualitative explanation, we analyze the structure of the $NPC$ functions. The discount rate $r$ determines the present value of future costs. A higher $r$ diminishes the value of future costs more significantly.\nPathway $\\mathrm{A}$ has a substantial immediate cost ($C^{\\mathrm{A}}_{0}$), which is not discounted. Pathway $\\mathrm{B}$ defers all costs to the future ($t=5$ and $t=10$).\n- When the discount rate $r$ is low (approaching $0$), future costs are nearly as significant as present costs. In this case, the decision is dominated by the total undiscounted capital expenditure. Total cost for $\\mathrm{A}$ is $C^{\\mathrm{A}}_{0} + C^{\\mathrm{A}}_{10} = (2.0 + 1.5) \\times 10^{9} = 3.5 \\times 10^{9}$. Total cost for $\\mathrm{B}$ is $C^{\\mathrm{B}}_{5} + C^{\\mathrm{B}}_{10} = (3.0 + 2.5) \\times 10^{9} = 5.5 \\times 10^{9}$. Since Total Cost($\\mathrm{A}$) < Total Cost($\\mathrm{B}$), for low $r$, $NPC_{\\mathrm{A}} < NPC_{\\mathrm{B}}$, making Pathway $\\mathrm{A}$ the preferred option.\n- When the discount rate $r$ is high, future costs are heavily discounted and contribute much less to the $NPC$. The decision is dominated by the near-term costs. Pathway $\\mathrm{A}$ has a large upfront cost $C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$, whereas Pathway $\\mathrm{B}$ has zero cost at $t=0$. This large, undiscounted cost makes Pathway $\\mathrm{A}$ very expensive at high $r$. Therefore, for high $r$, $NPC_{\\mathrm{B}} < NPC_{\\mathrm{A}}$, making Pathway $\\mathrm{B}$ the preferred option.\n\nThe threshold $r^{\\star}$ is the specific rate where the financial advantage of Pathway $\\mathrm{B}$'s deferred spending is perfectly offset by its higher total expenditure. Thus, for any $r < r^{\\star}$, Pathway $\\mathrm{A}$ is preferred, while for any $r > r^{\\star}$, Pathway $\\mathrm{B}$ is preferred.",
            "answer": "$$\n\\boxed{\\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5} - 1}\n$$"
        }
    ]
}