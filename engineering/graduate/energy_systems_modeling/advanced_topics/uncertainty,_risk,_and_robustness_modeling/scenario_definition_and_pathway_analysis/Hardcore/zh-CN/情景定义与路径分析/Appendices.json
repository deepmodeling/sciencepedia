{
    "hands_on_practices": [
        {
            "introduction": "在能源系统规划中，不同路径的成本和收益在时间上的分布往往不同。为了在公平的基础上比较这些路径，“净现成本”（Net Present Cost, NPC）是一个关键工具，它通过“贴现率”（discount rate, $r$）将未来的成本折算到当前价值。本练习将通过一个具体案例，计算决定两条脱碳路径优劣顺序的临界贴現率，从而帮助您深入理解投资时机和时间价值偏好如何影响战略决策。",
            "id": "4120777",
            "problem": "一个区域电力系统管理局正在制定两条为期10年的脱碳路径。路径$\\mathrm{A}$将投资前置于可靠的低碳容量，并在时间范围末期进行一笔较小的再投资。路径$\\mathrm{B}$则推迟了部分投资，依赖于中期改造，并在时间范围末期进行一次更大规模的升级。所有成本都是真实的（经通胀调整）、确定性的，并以相同货币单位表示。该管理局采用标准的时间偏好贴现法，年实际贴现率$r$为恒定值。净现成本 (NPC) 由标准贴现公式定义\n$$\nNPC \\;=\\; \\sum_{t} \\frac{C_{t}}{(1+r)^{t}},\n$$\n其中 $C_{t}$ 是第 $t$ 年的未贴现成本。\n\n两条路径的成本流如下：\n- 路径$\\mathrm{A}$：在第$0$年有一笔$C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$的即时资本支出，在第$10$年有一笔$C^{\\mathrm{A}}_{10} = 1.5 \\times 10^{9}$的再投资。\n- 路径$\\mathrm{B}$：在第$5$年有一笔$C^{\\mathrm{B}}_{5} = 3.0 \\times 10^{9}$的改造支出，在第$10$年有一笔$C^{\\mathrm{B}}_{10} = 2.5 \\times 10^{9}$的升级支出。\n\n从贴现和净现成本的定义出发，推导出$NPC_{\\mathrm{A}}(r)$和$NPC_{\\mathrm{B}}(r)$作为$r$的函数表达式，然后确定阈值贴现率$r^{\\star}$（以年小数表示），在该贴现率下$NPC_{\\mathrm{A}}(r^{\\star}) = NPC_{\\mathrm{B}}(r^{\\star})$。请以单一的闭式解析表达式提供$r^{\\star}$。此外，利用推导出的表达式结构，定性解释改变$r$会如何影响对路径的偏好。不要使用百分号；任何利率均以小数表示。无需四舍五入。",
            "solution": "该问题经验证具有科学依据、适定、客观且完整。它代表了贴现现金流分析在能源系统规划背景下的标准应用。所提供的数据是一致的，并且足以得到唯一解。\n\n净现成本 ($NPC$) 由以下公式给出：\n$$\nNPC = \\sum_{t} \\frac{C_{t}}{(1+r)^{t}}\n$$\n其中$C_{t}$是第$t$年的未贴现成本，$r$是实际贴现率。\n\n首先，我们为每条路径推导净现成本的表达式，$NPC_{\\mathrm{A}}(r)$和$NPC_{\\mathrm{B}}(r)$。\n\n对于路径$\\mathrm{A}$，成本在$t=0$和$t=10$时产生。成本流为$C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$和$C^{\\mathrm{A}}_{10} = 1.5 \\times 10^{9}$。\n路径$\\mathrm{A}$的净现成本为：\n$$\nNPC_{\\mathrm{A}}(r) = \\frac{C^{\\mathrm{A}}_{0}}{(1+r)^{0}} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r)^{10}} = C^{\\mathrm{A}}_{0} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r)^{10}}\n$$\n代入给定值：\n$$\nNPC_{\\mathrm{A}}(r) = 2.0 \\times 10^{9} + \\frac{1.5 \\times 10^{9}}{(1+r)^{10}}\n$$\n\n对于路径$\\mathrm{B}$，成本在$t=5$和$t=10$时产生。成本流为$C^{\\mathrm{B}}_{5} = 3.0 \\times 10^{9}$和$C^{\\mathrm{B}}_{10} = 2.5 \\times 10^{9}$。\n路径$\\mathrm{B}$的净现成本为：\n$$\nNPC_{\\mathrm{B}}(r) = \\frac{C^{\\mathrm{B}}_{5}}{(1+r)^{5}} + \\frac{C^{\\mathrm{B}}_{10}}{(1+r)^{10}}\n$$\n代入给定值：\n$$\nNPC_{\\mathrm{B}}(r) = \\frac{3.0 \\times 10^{9}}{(1+r)^{5}} + \\frac{2.5 \\times 10^{9}}{(1+r)^{10}}\n$$\n\n接下来，我们必须找到阈值贴现率$r^{\\star}$，在该贴现率下两条路径的净现成本相等，即$NPC_{\\mathrm{A}}(r^{\\star}) = NPC_{\\mathrm{B}}(r^{\\star})$。\n$$\nC^{\\mathrm{A}}_{0} + \\frac{C^{\\mathrm{A}}_{10}}{(1+r^{\\star})^{10}} = \\frac{C^{\\mathrm{B}}_{5}}{(1+r^{\\star})^{5}} + \\frac{C^{\\mathrm{B}}_{10}}{(1+r^{\\star})^{10}}\n$$\n我们可以通过将所有项除以公因子$10^{9}$来简化：\n$$\n2.0 + \\frac{1.5}{(1+r^{\\star})^{10}} = \\frac{3.0}{(1+r^{\\star})^{5}} + \\frac{2.5}{(1+r^{\\star})^{10}}\n$$\n为了求解$r^{\\star}$，我们引入一个代换，将方程转换为更熟悉的形式。令$x = \\frac{1}{(1+r^{\\star})^{5}}$。因此，$x^{2} = \\left(\\frac{1}{(1+r^{\\star})^{5}}\\right)^{2} = \\frac{1}{(1+r^{\\star})^{10}}$。\n将$x$代入方程得：\n$$\n2.0 + 1.5 x^{2} = 3.0 x + 2.5 x^{2}\n$$\n重新整理各项，得到一个标准二次方程$ax^2 + bx + c = 0$：\n$$\n(2.5 - 1.5)x^{2} + 3.0 x - 2.0 = 0\n$$\n$$\n1.0 x^{2} + 3.0 x - 2.0 = 0\n$$\n我们使用二次求根公式$x = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$来解$x$：\n$$\nx = \\frac{-3.0 \\pm \\sqrt{(3.0)^{2} - 4(1.0)(-2.0)}}{2(1.0)}\n$$\n$$\nx = \\frac{-3.0 \\pm \\sqrt{9.0 + 8.0}}{2}\n$$\n$$\nx = \\frac{-3.0 \\pm \\sqrt{17}}{2}\n$$\n由于$r$是实际贴现率，我们预期$r > -1$，并且在大多数经济背景下，$r \\ge 0$。这意味着$1+r^{\\star} > 0$。因此，$x = (1+r^{\\star})^{-5}$必须是一个正实数。根$x = \\frac{-3.0 - \\sqrt{17}}{2}$是负数，因此不是一个有实际意义的解。我们必须选择正根：\n$$\nx = \\frac{-3.0 + \\sqrt{17}}{2}\n$$\n现在，我们将$x = \\frac{1}{(1+r^{\\star})^{5}}$反代换回去，以求解$r^{\\star}$：\n$$\n\\frac{1}{(1+r^{\\star})^{5}} = \\frac{\\sqrt{17} - 3}{2}\n$$\n两边取倒数得：\n$$\n(1+r^{\\star})^{5} = \\frac{2}{\\sqrt{17} - 3}\n$$\n两边开五次方根：\n$$\n1+r^{\\star} = \\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5}\n$$\n最后，分离出$r^{\\star}$得到闭式解析表达式：\n$$\nr^{\\star} = \\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5} - 1\n$$\n\n对于定性解释，我们分析$NPC$函数的结构。贴现率$r$决定了未来成本的现值。较高的$r$会更显著地降低未来成本的价值。\n路径$\\mathrm{A}$有一笔可观的即时成本($C^{\\mathrm{A}}_{0}$)，该成本不被贴现。路径$\\mathrm{B}$将所有成本都推迟到未来（$t=5$和$t=10$）。\n- 当贴现率$r$较低时（接近$0$），未来成本与当前成本几乎同样重要。在这种情况下，决策主要由未贴现的总资本支出决定。$\\mathrm{A}$的总成本为$C^{\\mathrm{A}}_{0} + C^{\\mathrm{A}}_{10} = (2.0 + 1.5) \\times 10^{9} = 3.5 \\times 10^{9}$。$\\mathrm{B}$的总成本为$C^{\\mathrm{B}}_{5} + C^{\\mathrm{B}}_{10} = (3.0 + 2.5) \\times 10^{9} = 5.5 \\times 10^{9}$。由于总成本($\\mathrm{A}$)  总成本($\\mathrm{B}$)，对于较低的$r$，$NPC_{\\mathrm{A}}  NPC_{\\mathrm{B}}$，使得路径$\\mathrm{A}$成为更优选项。\n- 当贴现率$r$较高时，未来成本被大幅贴现，对$NPC$的贡献要小得多。决策主要由近期成本主导。路径$\\mathrm{A}$有一笔巨大的前期成本$C^{\\mathrm{A}}_{0} = 2.0 \\times 10^{9}$，而路径$\\mathrm{B}$在$t=0$时没有成本。这笔巨大的、未贴现的成本使得路径$\\mathrm{A}$在高$r$值下非常昂贵。因此，对于较高的$r$，$NPC_{\\mathrm{B}}  NPC_{\\mathrm{A}}$，使得路径$\\mathrm{B}$成为更优选项。\n\n阈值$r^{\\star}$是一个特定的利率，在该利率下，路径$\\mathrm{B}$递延支出的财务优势恰好被其更高的总支出所抵消。因此，对于任何$r  r^{\\star}$，路径$\\mathrm{A}$更优；而对于任何$r > r^{\\star}$，路径$\\mathrm{B}$更优。",
            "answer": "$$\n\\boxed{\\left(\\frac{2}{\\sqrt{17} - 3}\\right)^{1/5} - 1}\n$$"
        },
        {
            "introduction": "“边际减排成本曲线”（Marginal Abatement Cost Curve, MACC）是按成本效益对减排措施进行排序的强大可视化工具，它清晰地揭示了实现特定减排目标的“最经济”路径。然而，各项措施的减排潜力并非简单叠加，它们之间可能存在技术或资源上的重叠。本计算练习将引导您构建一个考虑了措施间相互作用的MACC，从而更准确地评估真实世界中的总减排潜力和成本。",
            "id": "4120859",
            "problem": "边际减排成本曲线（Marginal Abatement Cost Curve, MACC）根据边际减排成本对减排措施进行排序，以揭示在特定情景下的累积减排路径。考虑一组由 $i \\in \\{1,2,3,4,5\\}$ 索引的五项措施，每项措施均具有以百万吨二氧化碳/年（MtCO$_2$/year）为单位的基础减排潜力 $P_i$ 和以美元/吨二氧化碳（$/\\mathrm{tCO_2}$）为单位的恒定边际成本 $c_i$。措施之间的相互作用由一个重叠矩阵 $O \\in [0,1]^{5 \\times 5}$ 表示，其中元素 $O_{i,j}$ 指明了如果措施 $j$ 在措施 $i$ 之前实施，措施 $i$ 的基础潜力中有多少比例将变得不可行。对角线元素满足 $O_{i,i} = 0$。假设不同已实施措施之间的重叠效应是相互独立的。\n\n您的任务是通过以下步骤构建MACC：首先按 $c_i$ 的升序对措施进行排序，若成本相同则按较小的索引 $i$ 排序；然后按此顺序计算每项措施的调整后增量减排量，应用独立性假设来确定在考虑已选定措施集的重叠效应后 $P_i$ 的剩余可行比例。计算每增加一项措施后的累积减排量。对于每个测试用例，还需计算已实现的总减排量以及已实现的总减排量与基础潜力朴素总和的比率。所有减排量均以 MtCO$_2$/year 表示，比率表示为无量纲的小数（而非百分比）。所有浮点输出均四舍五入到三位小数。\n\n使用以下参数值测试套件，每个测试用例由 $(P, c, O)$ 定义：\n\n- 测试用例 A（无重叠，成本不同）：\n    - $P = [10.0, 15.0, 5.0, 8.0, 12.0]$ MtCO$_2$/year。\n    - $c = [60.0, 25.0, 90.0, 35.0, 45.0]$ $/\\mathrm{tCO_2}$。\n    - $O$ 是一个 $5 \\times 5$ 的零矩阵，对于所有 $i,j$，$O_{i,j} = 0$。\n\n- 测试用例 B（部分重叠，成本升序导致优先相互作用）：\n    - $P = [12.0, 9.0, 14.0, 6.0, 10.0]$ MtCO$_2$/year。\n    - $c = [30.0, 40.0, 20.0, 70.0, 50.0]$ $/\\mathrm{tCO_2}$。\n    - 非零重叠项：\n        - $O_{1,3} = 0.25$,\n        - $O_{2,1} = 0.10$,\n        - $O_{5,1} = 0.20$,\n        - $O_{5,2} = 0.50$,\n      所有其他 $O_{i,j} = 0$ 且 $O_{i,i} = 0$。\n    \n- 测试用例 C（强重叠，成本并列，负成本）：\n    - $P = [20.0, 18.0, 16.0, 14.0, 12.0]$ MtCO$_2$/year。\n    - $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$ $/\\mathrm{tCO_2}$，措施 $i=2$ 和 $i=3$ 的成本并列，按索引较小者优先的规则解决。\n    - 非零重叠项：\n        - $O_{2,1} = 0.90$,\n        - $O_{3,1} = 0.60$,\n        - $O_{4,1} = 1.00$,\n        - $O_{5,2} = 0.50$,\n        - $O_{5,3} = 0.60$,\n        - $O_{3,2} = 0.20$,\n      所有其他 $O_{i,j} = 0$ 且 $O_{i,i} = 0$。\n\n对于每个测试用例，执行以下步骤：\n1. 按 $c_i$ 的升序对措施进行排序，若成本相同则按 $i$ 的升序排序。\n2. 遍历排序后的列表。对于每项措施 $i$，应用独立性假设，根据已实施措施的重叠效应确定其调整后的增量减排量，即用剩余可行比例乘以 $P_i$。\n3. 计算每增加一项措施后的累积减排量、已实现的总减排量（调整后增量减排量之和）、朴素总减排量（无相互作用下 $P_i$ 的总和）以及已实现减排量与朴素减排量的比率。\n4. 将所有浮点输出四舍五入到三位小数。\n\n最终输出格式规范：\n- 对于每个测试用例，生成一个列表，其中包含：\n    - 排序顺序（整数列表），\n    - 调整后的增量减排量（浮点数列表，单位 MtCO$_2$/year），\n    - 累积减排量（浮点数列表，单位 MtCO$_2$/year），\n    - 已实现的总减排量（浮点数，单位 MtCO$_2$/year），\n    - 朴素总减排量（浮点数，单位 MtCO$_2$/year），\n    - 已实现减排量与朴素减排量的比率（浮点数，小数形式）。\n- 您的程序应生成单行输出，其中包含所有三个测试用例的结果，格式为一个逗号分隔的列表，并用方括号括起来，例如 $[result\\_A,result\\_B,result\\_C]$，其中每个 $result$ 都是上述的嵌套列表。",
            "solution": "在提供解决方案之前，用户的题目已经过验证。\n\n### 第一步：提取已知信息\n- **措施**：一组由 $i \\in \\{1, 2, 3, 4, 5\\}$ 索引的五项措施。\n- **基础减排潜力 ($P_i$)**：一个向量，表示每项措施的潜力，单位为百万吨二氧化碳/年 (MtCO$_2$/year)。\n- **边际成本 ($c_i$)**：一个向量，表示每项措施的成本，单位为美元/吨二氧化碳 ($/\\mathrm{tCO_2}$)。\n- **重叠矩阵 ($O$)**：一个 $5 \\times 5$ 矩阵，其中 $O_{i,j} \\in [0,1]$ 是如果措施 $j$ 在措施 $i$ 之前实施，措施 $i$ 的基础潜力中变得不可行的比例。\n- **重叠矩阵属性**：对角线元素 $O_{i,i} = 0$。\n- **独立性假设**：来自不同已实施措施的重叠效应是相互独立的。\n- **排序规则**：措施按边际成本 $c_i$ 的升序排序。成本并列时按较小的措施索引 $i$ 解决。\n- **计算任务**：对于给定的排序顺序，计算调整后增量减排量、累积减排量、已实现的总减排量、朴素总减排量（$P_i$ 的简单总和）以及已实现与朴素总减排量的比率。\n- **四舍五入规则**：所有最终输出的浮点数必须四舍五入到三位小数。\n- **测试用例 A**：\n    - $P = [10.0, 15.0, 5.0, 8.0, 12.0]$\n    - $c = [60.0, 25.0, 90.0, 35.0, 45.0]$\n    - $O$ 是 $5 \\times 5$ 的零矩阵。\n- **测试用例 B**：\n    - $P = [12.0, 9.0, 14.0, 6.0, 10.0]$\n    - $c = [30.0, 40.0, 20.0, 70.0, 50.0]$\n    - 非零 $O_{i,j}$：$O_{1,3} = 0.25$, $O_{2,1} = 0.10$, $O_{5,1} = 0.20$, $O_{5,2} = 0.50$。\n- **测试用例 C**：\n    - $P = [20.0, 18.0, 16.0, 14.0, 12.0]$\n    - $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$\n    - 非零 $O_{i,j}$：$O_{2,1} = 0.90$, $O_{3,1} = 0.60$, $O_{4,1} = 1.00$, $O_{5,2} = 0.50$, $O_{5,3} = 0.60$, $O_{3,2} = 0.20$。\n- **输出格式**：单行包含一个列表的列表，其中每个内部列表对应一个测试用例，并包含：[排序顺序（整数列表），调整后减排量（浮点数列表），累积减排量（浮点数列表），已实现总量（浮点数），朴素总量（浮点数），比率（浮点数）]。\n\n### 第二步：使用提取的已知信息进行验证\n根据指定标准对该问题进行评估：\n- **科学依据**：该问题描述了边际减排成本曲线（MACC）的构建，这是能源系统建模和环境经济学中用于规划脱碳路径的标准且成熟的工具。使用重叠矩阵来模拟措施间的相互作用是一种有效且常见的简化方法。负成本的概念是标准的，代表本身就具有盈利性的措施（例如，能效措施）。整个设定具有科学合理性。\n- **适定性**：该问题是适定的。它为三个不同的测试用例提供了所有必要的数据（$P$、$c$、$O$）。构建MACC的程序被明确定义：对成本和索引对 $(c_i, i)$ 进行字典序排序，可以为措施提供唯一的排序。基于“独立性假设”计算调整后减排量的规则也已明确说明。这种结构确保了每个测试用例都能计算出唯一且有意义的解。\n- **客观性**：问题以精确、客观和定量的术语陈述。没有主观或模糊的语言。\n- **其他缺陷**：该问题没有违反任何其他无效标准。它不是不完整、矛盾、不切实际、不适定或琐碎的。它是一个可形式化的问题，与指定领域直接相关。\n\n### 第三步：结论与行动\n该问题是**有效的**。下面将提供一个解决方案。\n\n### 基于原则的解决方案\n\n该问题要求通过顺序实施减排措施并考虑其相互作用来构建边际减排成本曲线（MACC）。问题的核心在于选择措施并根据已实施的措施调整其减排潜力的算法。\n\n设措施集合为 $\\mathcal{M} = \\{1, 2, 3, 4, 5\\}$。每个措施 $i \\in \\mathcal{M}$ 由其基础减排潜力 $P_i$ 和边际成本 $c_i$ 定义。措施之间的相互作用由重叠矩阵 $O$ 捕获，其中 $O_{i,j}$ 表示如果措施 $j$ 先于措施 $i$ 实施，措施 $i$ 的潜力损失比例。\n\n**1. 对措施进行排序**\n第一步是确定实施顺序。问题规定，措施按其边际成本 $c_i$ 的升序进行排序。成本的任何并列情况都通过选择索引 $i$ 较小的措施来解决。这定义了一个唯一的实施序列。设这个排序后的索引序列表示为 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4, \\pi_5)$。\n\n**2. 计算调整后减排量**\n一项措施的减排潜力会因序列中先前措施的实施而减少。“独立性假设”意味着这些重叠效应是乘性的。\n设 $S_{k-1} = \\{\\pi_1, \\pi_2, \\dots, \\pi_{k-1}\\}$ 为前 $k-1$ 步中实施的措施的索引集合。当考虑序列中的第 $k$ 个措施 $i = \\pi_k$ 时，其剩余可行比例 $f_i$ 是通过考虑来自所有措施 $j \\in S_{k-1}$ 的重叠来计算的。在实施措施 $j$ 后，措施 $i$ 剩余的潜力比例为 $(1 - O_{i,j})$。由于独立性，总剩余比例是乘积：\n$$ f_i = \\prod_{j \\in S_{k-1}} (1 - O_{i,j}) $$\n措施 $i$ 的调整后增量减排量，表示为 $A_i^{\\text{adj}}$，是其基础潜力乘以该可行比例：\n$$ A_i^{\\text{adj}} = P_i \\times f_i = P_i \\times \\prod_{j \\in S_{k-1}} (1 - O_{i,j}) $$\n\n**3. 计算累积减排量和总量**\n每增加一项措施，累积减排量就会更新。第 $k$ 步后的累积减排量 $C_k$ 是截至该点所有已实施措施的调整后减排量之和：\n$$ C_k = \\sum_{m=1}^{k} A_{\\pi_m}^{\\text{adj}} = C_{k-1} + A_{\\pi_k}^{\\text{adj}} \\quad (\\text{其中 } C_0 = 0) $$\n在处理完所有措施后，确定几个总量：\n- **朴素总减排量 ($A_{\\text{total}}^{\\text{naive}}$)**：在没有重叠效应时的理论最大减排量。它是基础潜力的简单总和：\n  $$ A_{\\text{total}}^{\\text{naive}} = \\sum_{i=1}^{5} P_i $$\n- **已实现的总减排量 ($A_{\\text{total}}^{\\text{realized}}$)**：考虑所有重叠效应后实际实现的总减排量。这是所有调整后增量减排量的总和，即最终的累积减排量 $C_5$：\n  $$ A_{\\text{total}}^{\\text{realized}} = C_5 = \\sum_{k=1}^{5} A_{\\pi_k}^{\\text{adj}} $$\n- **比率 ($R$)**：已实现的总减排量与朴素总减排量的比率，表明措施相互作用的总体影响：\n  $$ R = \\frac{A_{\\text{total}}^{\\text{realized}}}{A_{\\text{total}}^{\\text{naive}}} $$\n最终输出的所有浮点结果都四舍五入到三位小数。\n\n**测试用例执行：**\n\n**测试用例 A：**\n- $P = [10.0, 15.0, 5.0, 8.0, 12.0]$\n- $c = [60.0, 25.0, 90.0, 35.0, 45.0]$\n- 对于所有 $i,j$，$O_{i,j} = 0$。\n- **排序顺序**：成本为 $c_2=25.0, c_4=35.0, c_5=45.0, c_1=60.0, c_3=90.0$。排序后的索引序列为 $\\pi = (2, 4, 5, 1, 3)$。\n- **计算**：由于所有 $O_{i,j}=0$，可行比例 $f_i$ 始终为 $1$。因此，$A_i^{\\text{adj}} = P_i$。\n  - 调整后减排量（按实施顺序）：$[15.0, 8.0, 12.0, 10.0, 5.0]$。\n  - 累积减排量：$[15.0, 23.0, 35.0, 45.0, 50.0]$。\n- **总量**：$A_{\\text{total}}^{\\text{realized}} = 50.0$。$A_{\\text{total}}^{\\text{naive}} = 10+15+5+8+12 = 50.0$。$R = 50.0 / 50.0 = 1.0$。\n\n**测试用例 B：**\n- $P = [12.0, 9.0, 14.0, 6.0, 10.0]$\n- $c = [30.0, 40.0, 20.0, 70.0, 50.0]$\n- 非零 $O$：$O_{1,3} = 0.25$, $O_{2,1} = 0.10$, $O_{5,1} = 0.20$, $O_{5,2} = 0.50$。\n- **排序顺序**：成本为 $c_3=20.0, c_1=30.0, c_2=40.0, c_5=50.0, c_4=70.0$。排序后的索引序列为 $\\pi = (3, 1, 2, 5, 4)$。\n- **计算**：\n  - $k=1, i=3$：$S_0=\\emptyset$。$A_3^{\\text{adj}} = P_3 = 14.0$。$C_1=14.0$。\n  - $k=2, i=1$：$S_1=\\{3\\}$。$A_1^{\\text{adj}} = P_1(1-O_{1,3}) = 12.0(1-0.25) = 9.0$。$C_2=14.0+9.0=23.0$。\n  - $k=3, i=2$：$S_2=\\{3,1\\}$。$A_2^{\\text{adj}} = P_2(1-O_{2,3})(1-O_{2,1}) = 9.0(1-0)(1-0.10) = 8.1$。$C_3=23.0+8.1=31.1$。\n  - $k=4, i=5$：$S_3=\\{3,1,2\\}$。$A_5^{\\text{adj}} = P_5(1-O_{5,3})(1-O_{5,1})(1-O_{5,2}) = 10.0(1-0)(1-0.20)(1-0.50) = 4.0$。$C_4=31.1+4.0=35.1$。\n  - $k=5, i=4$：$S_4=\\{3,1,2,5\\}$。$A_4^{\\text{adj}} = P_4(1) = 6.0$。$C_5=35.1+6.0=41.1$。\n- **总量**：$A_{\\text{total}}^{\\text{realized}} = 41.1$。$A_{\\text{total}}^{\\text{naive}} = 12+9+14+6+10 = 51.0$。$R = 41.1 / 51.0 \\approx 0.806$。\n\n**测试用例 C：**\n- $P = [20.0, 18.0, 16.0, 14.0, 12.0]$\n- $c = [-15.0, 25.0, 25.0, 60.0, 100.0]$\n- 非零 $O$：$O_{2,1}=0.90, O_{3,1}=0.60, O_{4,1}=1.00, O_{5,2}=0.50, O_{5,3}=0.60, O_{3,2}=0.20$。\n- **排序顺序**：成本为 $c_1=-15.0$。$c_2=c_3=25.0$。成本并列按索引解决（2在3之前）。因此，顺序为 $c_1, c_2, c_3, c_4, c_5$。排序后的索引序列为 $\\pi = (1, 2, 3, 4, 5)$。\n- **计算**：\n  - $k=1, i=1$：$S_0=\\emptyset$。$A_1^{\\text{adj}} = P_1 = 20.0$。$C_1=20.0$。\n  - $k=2, i=2$：$S_1=\\{1\\}$。$A_2^{\\text{adj}} = P_2(1-O_{2,1}) = 18.0(1-0.90) = 1.8$。$C_2=20.0+1.8=21.8$。\n  - $k=3, i=3$：$S_2=\\{1,2\\}$。$A_3^{\\text{adj}} = P_3(1-O_{3,1})(1-O_{3,2}) = 16.0(1-0.60)(1-0.20) = 5.12$。$C_3=21.8+5.12=26.92$。\n  - $k=4, i=4$：$S_3=\\{1,2,3\\}$。$A_4^{\\text{adj}} = P_4(1-O_{4,1})(1-O_{4,2})(1-O_{4,3}) = 14.0(1-1.00)(1-0)(1-0) = 0.0$。$C_4=26.92+0=26.92$。\n  - $k=5, i=5$：$S_4=\\{1,2,3,4\\}$。$A_5^{\\text{adj}} = P_5(1-O_{5,1})(1-O_{5,2})(1-O_{5,3})(1-O_{5,4}) = 12.0(1-0)(1-0.50)(1-0.60)(1-0) = 2.4$。$C_5=26.92+2.4=29.32$。\n- **总量**：$A_{\\text{total}}^{\\text{realized}} = 29.32$。$A_{\\text{total}}^{\\text{naive}} = 20+18+16+14+12 = 80.0$。$R = 29.32 / 80.0 = 0.3665 \\approx 0.367$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Marginal Abatement Cost Curve pathway analysis for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A (no overlaps, distinct costs)\n        (\n            [10.0, 15.0, 5.0, 8.0, 12.0],\n            [60.0, 25.0, 90.0, 35.0, 45.0],\n            np.zeros((5, 5)).tolist()\n        ),\n        # Test Case B (partial overlaps, ascending costs prioritize interactions)\n        (\n            [12.0, 9.0, 14.0, 6.0, 10.0],\n            [30.0, 40.0, 20.0, 70.0, 50.0],\n            [\n                [0.0, 0.0, 0.25, 0.0, 0.0],\n                [0.10, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.20, 0.50, 0.0, 0.0, 0.0]\n            ]\n        ),\n        # Test Case C (strong overlaps, tie costs, negative cost)\n        (\n            [20.0, 18.0, 16.0, 14.0, 12.0],\n            [-15.0, 25.0, 25.0, 60.0, 100.0],\n            [\n                [0.0, 0.0, 0.0, 0.0, 0.0],\n                [0.90, 0.0, 0.0, 0.0, 0.0],\n                [0.60, 0.20, 0.0, 0.0, 0.0],\n                [1.00, 0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.50, 0.60, 0.0, 0.0]\n            ]\n        )\n    ]\n\n    results = []\n    for P_list, c_list, O_list in test_cases:\n        P = np.array(P_list, dtype=float)\n        c = np.array(c_list, dtype=float)\n        O = np.array(O_list, dtype=float)\n        num_measures = len(P)\n\n        # 1. Sort measures in ascending order of cost, breaking ties by index.\n        # Problem uses 1-based indexing for measures.\n        measures_to_sort = [(c[i], i + 1) for i in range(num_measures)]\n        measures_to_sort.sort()\n        sorted_indices_1based = [m[1] for m in measures_to_sort]\n\n        # 2. Traverse the sorted list and compute abatements.\n        adj_abatement_unrounded = []\n        cum_abatement_unrounded = []\n        current_cumulative_unrounded = 0.0\n        implemented_indices_1based_set = set()\n\n        for measure_idx_1based in sorted_indices_1based:\n            py_idx = measure_idx_1based - 1\n\n            # Calculate the feasible fraction based on overlaps from already implemented measures.\n            feasible_fraction = 1.0\n            for implemented_idx_1based in implemented_indices_1based_set:\n                implemented_py_idx = implemented_idx_1based - 1\n                # O[i,j] is the fraction of i's potential lost due to j.\n                overlap = O[py_idx, implemented_py_idx]\n                feasible_fraction *= (1.0 - overlap)\n\n            # Calculate adjusted incremental abatement.\n            adj_abatement = P[py_idx] * feasible_fraction\n            adj_abatement_unrounded.append(adj_abatement)\n\n            # Update cumulative abatement.\n            current_cumulative_unrounded += adj_abatement\n            cum_abatement_unrounded.append(current_cumulative_unrounded)\n\n            # Add the current measure to the set of implemented measures.\n            implemented_indices_1based_set.add(measure_idx_1based)\n\n        # 3. Compute final totals and ratio.\n        realized_total_unrounded = current_cumulative_unrounded\n        naive_total_unrounded = np.sum(P)\n        ratio = (realized_total_unrounded / naive_total_unrounded) if naive_total_unrounded != 0 else 0.0\n\n        # 4. Round all floating-point outputs to three decimal places.\n        adj_abatements_rounded = [round(x, 3) for x in adj_abatement_unrounded]\n        cum_abatements_rounded = [round(x, 3) for x in cum_abatement_unrounded]\n        realized_total_rounded = round(realized_total_unrounded, 3)\n        naive_total_rounded = round(naive_total_unrounded, 3)\n        ratio_rounded = round(ratio, 3)\n\n        # Assemble the final list for this test case.\n        case_result = [\n            sorted_indices_1based,\n            adj_abatements_rounded,\n            cum_abatements_rounded,\n            realized_total_rounded,\n            naive_total_rounded,\n            ratio_rounded\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # Convert each case_result (which is a list) to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "评估能源转型路径时，我们通常需要同时考量多个维度，如累计排放（$E$）、系统总成本（$C$）和最终能源需求（$D$）。这些指标不仅单位各异，而且常常相互关联，使得直接比较变得困难。本练习将介绍一种高级统计方法——马氏距离（Mahalanobis distance），用于构建一个综合的、无量纲的得分，从而能够在考虑指标间相关性的前提下，对复杂的多维场景进行量化比较。",
            "id": "4120813",
            "problem": "一个能源系统建模小组正在评估 $2025$ 年至 $2050$ 年期间的两种脱碳路径，记为 $\\mathcal{A}$ 和 $\\mathcal{B}$。这些路径由一个包含三个关键指标的向量 $\\mathbf{x} = (E, C, D)$ 来表征，其中 $E$ 是以十亿吨为单位的二氧化碳累积排放量，$C$ 是以万亿美国美元为单位的总折现系统成本，$D$ 是以艾焦耳为单位的最终能源需求。每条路径的指标如下：\n- 路径 $\\mathcal{A}$：$E_{\\mathcal{A}} = 300$，$C_{\\mathcal{A}} = 52$，$D_{\\mathcal{A}} = 550$。\n- 路径 $\\mathcal{B}$：$E_{\\mathcal{B}} = 360$，$C_{\\mathcal{B}} = 48$，$D_{\\mathcal{B}} = 600$。\n\n一组可能的情景为这些指标提供了变异性和相关性信息，概括为标准差 $\\sigma_E = 50$、$\\sigma_C = 8$、$\\sigma_D = 100$ 和相关矩阵\n$$\n\\mathbf{R} \\;=\\;\n\\begin{pmatrix}\n1  0  0.5 \\\\\n0  1  0 \\\\\n0.5  0  1\n\\end{pmatrix}.\n$$\n\n从方差、协方差、相关性、$z$-分数标准化和主成分分析（PCA; Principal Component Analysis）的基本定义出发，定义一个在指标空间中衡量 $\\mathcal{A}$ 和 $\\mathcal{B}$ 之间分离度的复合、无单位、归一化的度量，该度量需要满足：\n- 当指标独立时，该度量简化为各指标标准化（$z$-分数）差异的欧几里得范数，并且\n- 使用情景集信息正确地考虑了指标间的相关性。\n\n从第一性原理推导这个复合度量，并使用上述数据计算其值。将最终的复合得分表示为一个无单位的数字，并将答案四舍五入到四位有效数字。",
            "solution": "题目要求在一个由 $(E, C, D)$ 定义的三维指标空间中，推导并计算一个复合、无单位、归一化的分离度度量，用于衡量两条路径 $\\mathcal{A}$ 和 $\\mathcal{B}$ 之间的差异。该度量必须满足与统计独立性和相关性相关的两个特定条件。\n\n设路径 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的指标向量分别记为 $\\mathbf{x}_{\\mathcal{A}}$ 和 $\\mathbf{x}_{\\mathcal{B}}$。\n$$\n\\mathbf{x}_{\\mathcal{A}} = \\begin{pmatrix} E_{\\mathcal{A}} \\\\ C_{\\mathcal{A}} \\\\ D_{\\mathcal{A}} \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 52 \\\\ 550 \\end{pmatrix}, \\quad\n\\mathbf{x}_{\\mathcal{B}} = \\begin{pmatrix} E_{\\mathcal{B}} \\\\ C_{\\mathcal{B}} \\\\ D_{\\mathcal{B}} \\end{pmatrix} = \\begin{pmatrix} 360 \\\\ 48 \\\\ 600 \\end{pmatrix}\n$$\n这两条路径之间的差异是向量 $\\Delta\\mathbf{x} = \\mathbf{x}_{\\mathcal{A}} - \\mathbf{x}_{\\mathcal{B}}$：\n$$\n\\Delta\\mathbf{x} = \\begin{pmatrix} E_{\\mathcal{A}} - E_{\\mathcal{B}} \\\\ C_{\\mathcal{A}} - C_{\\mathcal{B}} \\\\ D_{\\mathcal{A}} - D_{\\mathcal{B}} \\end{pmatrix} = \\begin{pmatrix} 300 - 360 \\\\ 52 - 48 \\\\ 550 - 600 \\end{pmatrix} = \\begin{pmatrix} -60 \\\\ 4 \\\\ -50 \\end{pmatrix}\n$$\n这个向量的分量具有不同的单位和尺度（十亿吨、万亿美元、艾焦耳）。为了进行无单位的、归一化的比较，我们必须对这些差异进行标准化。标准方法是计算 $z$-分数，它以标准差为单位来衡量差异。标准差向量为 $\\mathbf{\\sigma} = (\\sigma_E, \\sigma_C, \\sigma_D)^T = (50, 8, 100)^T$。\n\n标准化差异向量 $\\mathbf{z}$ 通过将 $\\Delta\\mathbf{x}$ 的每个分量除以其对应的标准差得到：\n$$\n\\mathbf{z} = \\begin{pmatrix} z_E \\\\ z_C \\\\ z_D \\end{pmatrix} = \\begin{pmatrix} (E_{\\mathcal{A}} - E_{\\mathcal{B}})/\\sigma_E \\\\ (C_{\\mathcal{A}} - C_{\\mathcal{B}})/\\sigma_C \\\\ (D_{\\mathcal{A}} - D_{\\mathcal{B}})/\\sigma_D \\end{pmatrix} = \\begin{pmatrix} -60/50 \\\\ 4/8 \\\\ -50/100 \\end{pmatrix} = \\begin{pmatrix} -1.2 \\\\ 0.5 \\\\ -0.5 \\end{pmatrix}\n$$\n$\\mathbf{z}$ 的分量是无单位的。题目给出的第一个条件指出，如果指标是独立的，分离度度量应为 $\\mathbf{z}$ 的欧几里得范数。不相关的指标意味着相关矩阵 $\\mathbf{R}$ 是单位矩阵 $\\mathbf{I}$。在这种情况下，分离度的平方 $d^2$ 将是：\n$$\nd^2 = \\|\\mathbf{z}\\|^2_2 = z_E^2 + z_C^2 + z_D^2 = \\mathbf{z}^T \\mathbf{z}\n$$\n然而，这些指标并非相互独立。给定的相关矩阵是：\n$$\n\\mathbf{R} = \\begin{pmatrix} 1  \\rho_{EC}  \\rho_{ED} \\\\ \\rho_{CE}  1  \\rho_{CD} \\\\ \\rho_{DE}  \\rho_{DC}  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0.5 \\\\ 0  1  0 \\\\ 0.5  0  1 \\end{pmatrix}\n$$\n非零的非对角元素 $\\rho_{ED} = 0.5$ 表明排放量和能源需求之间存在相关性。当变量相关时，简单的平方和是不合适的，因为它会重复计算共享的信息。必须在一个坐标轴正交且经过适当缩放的空间中测量分离度。\n\n这可以通过将变量转换到主成分的新基底上来实现，根据定义，主成分是不相关的。标准化向量 $\\mathbf{z}$ 的协方差矩阵就是相关矩阵 $\\mathbf{R}$。主成分分析 (PCA) 寻找该协方差矩阵的特征向量。设 $\\mathbf{R}$ 的特征分解为 $\\mathbf{R} = \\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^T$，其中 $\\mathbf{V}$ 是特征向量构成的正交矩阵，$\\mathbf{\\Lambda}$ 是对应特征值构成的对角矩阵。\n\n一个代表主成分的、由不相关变量构成的新向量 $\\mathbf{p}$，是通过将 $\\mathbf{z}$ 投影到特征向量上得到的：$\\mathbf{p} = \\mathbf{V}^T\\mathbf{z}$。这些新变量的协方差为 $\\text{Cov}(\\mathbf{p}) = \\mathbf{V}^T \\text{Cov}(\\mathbf{z}) \\mathbf{V} = \\mathbf{V}^T \\mathbf{R} \\mathbf{V} = \\mathbf{V}^T (\\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^T) \\mathbf{V} = \\mathbf{\\Lambda}$。这表明主成分是不相关的，其方差等于特征值 $\\lambda_i$。\n\n为了得到一组不仅不相关而且方差为1的变量，我们必须将每个主成分 $p_i$ 乘以 $1/\\sqrt{\\lambda_i}$ 进行缩放。设这个完全去相关和标准化的向量为 $\\mathbf{p}'$。那么 $\\mathbf{p}' = \\mathbf{\\Lambda}^{-1/2}\\mathbf{p} = \\mathbf{\\Lambda}^{-1/2}\\mathbf{V}^T\\mathbf{z}$。在这个变换后的空间中，合适的距离是标准欧几里得距离。于是，分离度的平方 $d^2$ 为：\n$$\nd^2 = (\\mathbf{p}')^T \\mathbf{p}' = (\\mathbf{\\Lambda}^{-1/2}\\mathbf{V}^T\\mathbf{z})^T (\\mathbf{\\Lambda}^{-1/2}\\mathbf{V}^T\\mathbf{z}) = \\mathbf{z}^T \\mathbf{V} \\mathbf{\\Lambda}^{-1/2} \\mathbf{\\Lambda}^{-1/2} \\mathbf{V}^T \\mathbf{z} = \\mathbf{z}^T \\mathbf{V} \\mathbf{\\Lambda}^{-1} \\mathbf{V}^T \\mathbf{z}\n$$\n认识到相关矩阵的逆为 $\\mathbf{R}^{-1} = (\\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^T)^{-1} = \\mathbf{V}\\mathbf{\\Lambda}^{-1}\\mathbf{V}^T$，分离度平方的表达式简化为：\n$$\nd^2 = \\mathbf{z}^T \\mathbf{R}^{-1} \\mathbf{z}\n$$\n这就是标准化差异向量的马氏距离 (Mahalanobis distance) 的平方。它就是所要求的复合分离度度量。它正确地推广了欧几里得距离以考虑相关性。如果 $\\mathbf{R}=\\mathbf{I}$，那么 $\\mathbf{R}^{-1}=\\mathbf{I}$，且 $d^2=\\mathbf{z}^T\\mathbf{I}\\mathbf{z}=\\mathbf{z}^T\\mathbf{z}$，满足第一个条件。它通过 $\\mathbf{R}^{-1}$ 明确地使用了相关性信息，满足第二个条件。\n\n现在，我们来计算其值。首先，我们必须求 $\\mathbf{R}$ 的逆矩阵。$\\mathbf{R}$ 的行列式是：\n$$\n\\det(\\mathbf{R}) = 1(1 \\cdot 1 - 0 \\cdot 0) - 0 + 0.5(0 \\cdot 0 - 1 \\cdot 0.5) = 1 - 0.25 = 0.75\n$$\n逆矩阵为 $\\mathbf{R}^{-1} = \\frac{1}{\\det(\\mathbf{R})} \\text{adj}(\\mathbf{R})$。伴随矩阵 adj($\\mathbf{R}$) 是代数余子式矩阵的转置。\n代数余子式矩阵 $\\mathbf{C}$ 是：\n$$\n\\mathbf{C} = \\begin{pmatrix}\n1  0  -0.5 \\\\\n0  0.75  0 \\\\\n-0.5  0  1\n\\end{pmatrix}\n$$\n由于 $\\mathbf{C}$ 是对称矩阵，所以 $\\text{adj}(\\mathbf{R}) = \\mathbf{C}^T = \\mathbf{C}$。\n$$\n\\mathbf{R}^{-1} = \\frac{1}{0.75} \\begin{pmatrix} 1  0  -0.5 \\\\ 0  0.75  0 \\\\ -0.5  0  1 \\end{pmatrix} = \\frac{4}{3} \\begin{pmatrix} 1  0  -0.5 \\\\ 0  0.75  0 \\\\ -0.5  0  1 \\end{pmatrix} = \\begin{pmatrix} 4/3  0  -2/3 \\\\ 0  1  0 \\\\ -2/3  0  4/3 \\end{pmatrix}\n$$\n现在，我们用 $\\mathbf{z} = (-1.2, 0.5, -0.5)^T$ 来计算分离度的平方 $d^2 = \\mathbf{z}^T \\mathbf{R}^{-1} \\mathbf{z}$：\n$$\nd^2 = \\begin{pmatrix} -1.2  0.5  -0.5 \\end{pmatrix} \\begin{pmatrix} 4/3  0  -2/3 \\\\ 0  1  0 \\\\ -2/3  0  4/3 \\end{pmatrix} \\begin{pmatrix} -1.2 \\\\ 0.5 \\\\ -0.5 \\end{pmatrix}\n$$\n展开这个二次型：\n$$\nd^2 = (R^{-1})_{11}z_E^2 + (R^{-1})_{22}z_C^2 + (R^{-1})_{33}z_D^2 + 2(R^{-1})_{13}z_E z_D\n$$\n$$\nd^2 = \\frac{4}{3}(-1.2)^2 + 1(0.5)^2 + \\frac{4}{3}(-0.5)^2 + 2\\left(-\\frac{2}{3}\\right)(-1.2)(-0.5)\n$$\n$$\nd^2 = \\frac{4}{3}(1.44) + 0.25 + \\frac{4}{3}(0.25) - \\frac{4}{3}(0.6)\n$$\n$$\nd^2 = 1.92 + 0.25 + \\frac{1}{3} - 0.8\n$$\n为了保持精度，我们使用分数：$-1.2 = -6/5$, $0.5 = 1/2$, $-0.5 = -1/2$。\n$$\nd^2 = \\frac{4}{3}\\left(-\\frac{6}{5}\\right)^2 + 1\\left(\\frac{1}{2}\\right)^2 + \\frac{4}{3}\\left(-\\frac{1}{2}\\right)^2 + 2\\left(-\\frac{2}{3}\\right)\\left(-\\frac{6}{5}\\right)\\left(-\\frac{1}{2}\\right)\n$$\n$$\nd^2 = \\frac{4}{3}\\left(\\frac{36}{25}\\right) + \\frac{1}{4} + \\frac{4}{3}\\left(\\frac{1}{4}\\right) - \\frac{4}{3}\\left(\\frac{3}{5}\\right)\n$$\n$$\nd^2 = \\frac{4 \\cdot 12}{25} + \\frac{1}{4} + \\frac{1}{3} - \\frac{4}{5}\n$$\n$$\nd^2 = \\frac{48}{25} + \\frac{1}{4} + \\frac{1}{3} - \\frac{4}{5}\n$$\n分母 $25$、$4$、$3$、$5$ 的最小公倍数是 $300$。\n$$\nd^2 = \\frac{48 \\cdot 12}{300} + \\frac{1 \\cdot 75}{300} + \\frac{1 \\cdot 100}{300} - \\frac{4 \\cdot 60}{300}\n$$\n$$\nd^2 = \\frac{576}{300} + \\frac{75}{300} + \\frac{100}{300} - \\frac{240}{300}\n$$\n$$\nd^2 = \\frac{576 + 75 + 100 - 240}{300} = \\frac{751 - 240}{300} = \\frac{511}{300}\n$$\n复合分离度为 $d = \\sqrt{d^2}$：\n$$\nd = \\sqrt{\\frac{511}{300}} \\approx \\sqrt{1.70333...} \\approx 1.305118\n$$\n四舍五入到四位有效数字，最终值为 $1.305$。",
            "answer": "$$\\boxed{1.305}$$"
        }
    ]
}