{
    "hands_on_practices": [
        {
            "introduction": "Uncertainty analysis begins with a crucial first step: creating mathematical representations of the uncertain inputs to a model. When empirical data is available, we can fit a parametric probability distribution using summary statistics like the mean and variance. This exercise  provides hands-on practice in applying the method of moments to the Beta distribution, a versatile tool for modeling variables constrained to a finite interval, such as the capacity factors of renewable energy technologies.",
            "id": "4098899",
            "problem": "A wind farmâ€™s hourly capacity factor, denoted by the random variable $X$, lies in the interval $[0,1]$ and is modeled as a Beta distribution with shape parameters $\\alpha>0$ and $\\beta>0$. In introductory uncertainty and sensitivity analysis for energy systems modeling, it is common to calibrate a distribution to basic empirical characteristics. Suppose a long historical record yields a sample mean $m$ and sample variance $v$ of the capacity factor, with $0<m<1$ and $0<v<m(1-m)$. Using the method of moments, derive closed-form expressions for the shape parameters $\\alpha$ and $\\beta$ as functions of $m$ and $v$.\n\nYour derivation must start from the definition of the Beta probability density function $f(x;\\alpha,\\beta)$ on $[0,1]$, the Beta function $B(\\alpha,\\beta)$, and the integral definitions of the first and second moments. Express your final answer as a single analytic expression for the pair $(\\alpha,\\beta)$ in terms of $m$ and $v$. No numerical rounding is required, and no units should be included in the final expression.",
            "solution": "The problem requires us to find the shape parameters $\\alpha$ and $\\beta$ of a Beta distribution by equating its theoretical moments to a given sample mean $m$ and sample variance $v$.\n\nThe standard expressions for the mean $\\mathbb{E}[X]$ and variance $\\mathbb{V}[X]$ of a Beta-distributed random variable $X$ with parameters $\\alpha$ and $\\beta$ are:\n$$ \\mathbb{E}[X] = \\frac{\\alpha}{\\alpha+\\beta} $$\n$$ \\mathbb{V}[X] = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} $$\nThe method of moments sets these theoretical expressions equal to the sample moments:\n$$ m = \\frac{\\alpha}{\\alpha+\\beta} \\quad (1) $$\n$$ v = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} \\quad (2) $$\nOur goal is to solve this system of two equations for the two unknowns, $\\alpha$ and $\\beta$.\n\nWe can simplify the variance expression. From equation (1), we have $1-m = 1 - \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\beta}{\\alpha+\\beta}$.\nMultiplying $m$ by $1-m$ gives:\n$$ m(1-m) = \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)\\left(\\frac{\\beta}{\\alpha+\\beta}\\right) = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2} $$\nSubstituting this into the variance equation (2):\n$$ v = m(1-m) \\frac{1}{\\alpha+\\beta+1} $$\nNow we can solve for the sum $\\alpha+\\beta$:\n$$ \\alpha+\\beta+1 = \\frac{m(1-m)}{v} $$\n$$ \\alpha+\\beta = \\frac{m(1-m)}{v} - 1 = \\frac{m(1-m) - v}{v} $$\nLet's call this intermediate result $\\nu = \\alpha+\\beta = \\frac{m(1-m) - v}{v}$.\nThe problem states that $0  v  m(1-m)$, which ensures that $\\nu$ is positive, as required for $\\alpha, \\beta > 0$.\n\nNow we can use equation (1) to solve for $\\alpha$ and $\\beta$ individually.\nFrom $m = \\frac{\\alpha}{\\alpha+\\beta}$, we get $\\alpha = m(\\alpha+\\beta) = m\\nu$.\nSubstituting the expression for $\\nu$:\n$$ \\alpha = m \\left( \\frac{m(1-m) - v}{v} \\right) $$\nSimilarly, from $1-m = \\frac{\\beta}{\\alpha+\\beta}$, we get $\\beta = (1-m)(\\alpha+\\beta) = (1-m)\\nu$.\nSubstituting the expression for $\\nu$:\n$$ \\beta = (1-m) \\left( \\frac{m(1-m) - v}{v} \\right) $$\nThese are the closed-form expressions for the shape parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nm \\left( \\frac{m(1-m)}{v} - 1 \\right)  (1-m) \\left( \\frac{m(1-m)}{v} - 1 \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once inputs are characterized as random variables, Monte Carlo simulation is a powerful method to see how their uncertainty propagates through a complex model. A critical practical question is determining how many simulation runs are sufficient to trust the results. This problem  demonstrates how the Central Limit Theorem provides a rigorous foundation for calculating the minimum sample size needed to estimate an output metric, like system cost, to a desired precision and with a specified level of statistical confidence.",
            "id": "4098879",
            "problem": "An energy systems planner is using Monte Carlo simulation to estimate the expected annualized system cost per megawatt-hour for a proposed generation portfolio under uncertain fuel prices and variable renewable output. Let the simulation output per run be a random variable $X$ with unknown mean $\\mu$ and finite variance $\\sigma^{2}$. Assume the outputs from independent runs are independent and identically distributed (i.i.d.) and that the Central Limit Theorem (CLT) applies to the sample mean. The planner requires that the estimator be accurate in the sense that the absolute error of the sample mean $\\left|\\overline{X}_{n}-\\mu\\right|$ is within a prescribed margin $\\epsilon$ with two-sided confidence level $1-\\alpha$.\n\nA pilot simulation of $m = 500$ runs yields a sample variance estimate of $\\hat{\\sigma}^{2} = 144$ in the same squared units as $X$. The planner sets the accuracy target to $\\epsilon = 2$ and the confidence level to $1-\\alpha = 0.9$. Use the asymptotic normal approximation implied by the CLT for the sampling distribution of the sample mean, treat $\\hat{\\sigma}^{2}$ as a conservative proxy for $\\sigma^{2}$, and determine the minimum Monte Carlo sample size $n$ such that the above accuracy requirement is met.\n\nProvide your final answer as the smallest integer $n$ that satisfies the requirement. Express the final answer as a pure number with no units. Do not round using significant figures; instead, return the minimal integer that meets the criterion.",
            "solution": "The problem asks for the minimum sample size $n$ for a Monte Carlo simulation to achieve a specific precision. The requirement is that the absolute error of the sample mean, $|\\overline{X}_n - \\mu|$, is less than or equal to a margin $\\epsilon$ with a confidence level of $1-\\alpha$. This can be written as:\n$$\nP(|\\overline{X}_n - \\mu| \\le \\epsilon) \\ge 1 - \\alpha\n$$\nAccording to the Central Limit Theorem (CLT), the sample mean $\\overline{X}_n$ of $n$ i.i.d. samples is approximately normally distributed with mean $\\mu$ and variance $\\sigma^2/n$. We can standardize this to a standard normal variable $Z \\sim N(0,1)$:\n$$\nZ = \\frac{\\overline{X}_n - \\mu}{\\sigma/\\sqrt{n}}\n$$\nRewriting the probability inequality in terms of $Z$:\n$$\nP\\left(\\left|\\frac{\\overline{X}_n - \\mu}{\\sigma/\\sqrt{n}}\\right| \\le \\frac{\\epsilon}{\\sigma/\\sqrt{n}}\\right) \\ge 1 - \\alpha \\implies P\\left(|Z| \\le \\frac{\\epsilon\\sqrt{n}}{\\sigma}\\right) \\ge 1 - \\alpha\n$$\nFor a standard normal distribution, the interval that contains $1-\\alpha$ of the probability is $[-z_{\\alpha/2}, z_{\\alpha/2}]$, where $z_{\\alpha/2}$ is the critical value leaving $\\alpha/2$ in the upper tail. Therefore, we must satisfy:\n$$\n\\frac{\\epsilon\\sqrt{n}}{\\sigma} \\ge z_{\\alpha/2}\n$$\nSolving for $n$, we get the required condition for the sample size:\n$$\nn \\ge \\left(\\frac{z_{\\alpha/2}\\sigma}{\\epsilon}\\right)^2\n$$\nNow, we substitute the given values:\n1.  **Confidence level**: $1-\\alpha = 0.9$, so $\\alpha = 0.1$, and $\\alpha/2 = 0.05$. The critical value $z_{0.05}$ is the value for which the cumulative probability is $0.95$. From standard normal tables, $z_{0.05} \\approx 1.645$.\n2.  **Margin of error**: $\\epsilon = 2$.\n3.  **Variance**: We use the pilot study estimate $\\hat{\\sigma}^2 = 144$, so the standard deviation is $\\hat{\\sigma} = \\sqrt{144} = 12$.\n\nPlugging these values into the formula for $n$:\n$$\nn \\ge \\left(\\frac{1.645 \\times 12}{2}\\right)^2\n$$\n$$\nn \\ge \\left(1.645 \\times 6\\right)^2\n$$\n$$\nn \\ge (9.87)^2\n$$\n$$\nn \\ge 97.4169\n$$\nSince the sample size $n$ must be an integer, we must take the smallest integer that satisfies this inequality, which is the ceiling of the calculated value.\n$$\nn = \\lceil 97.4169 \\rceil = 98\n$$\nThe minimum Monte Carlo sample size is 98.",
            "answer": "$$\n\\boxed{98}\n$$"
        },
        {
            "introduction": "After quantifying the uncertainty in a model's output, the next step is often to understand its sources, which is the goal of sensitivity analysis. Variance-based methods, such as the Sobol' decomposition, partition the total output variance into contributions from individual inputs and their interactions. By working through the analytical calculation of Sobol' indices for a simple, non-linear model , you will gain a concrete understanding of how these indices distinguish between the direct effects of a single factor and the complex, synergistic effects that arise from interactions between multiple factors.",
            "id": "4098875",
            "problem": "Consider a stylized energy systems model of normalized annual output defined by the mapping $f:[0,1]^{2}\\rightarrow \\mathbb{R}$ with $f(x_{1},x_{2})=x_{1}+x_{2}+x_{1}x_{2}$. Here, $x_{1}$ and $x_{2}$ denote two independent normalized design or resource factors (for instance, scaled deployment decisions for two technologies), each modeled as realizations from the Uniform distribution (U) on $[0,1]$, i.e., $x_{i}\\sim \\mathrm{U}(0,1)$, $i\\in\\{1,2\\}$, and $x_{1}\\perp x_{2}$. \n\nUsing variance-based global sensitivity analysis and the Analysis of Variance (ANOVA) decomposition, start from the core definitions: the total variance $\\mathrm{Var}(f)$, the first-order partial variances $\\mathrm{Var}\\big(\\mathbb{E}[f\\mid x_{i}]\\big)$, and the second-order interaction variance $\\mathrm{Var}(f)-\\sum_{i=1}^{2}\\mathrm{Var}\\big(\\mathbb{E}[f\\mid x_{i}]\\big)$, all under the independence and distributional assumptions stated. Derive the first-order Sobol indices $S_{1}$ and $S_{2}$ and the second-order Sobol interaction index $S_{12}$ for $f(x_{1},x_{2})$. Explicitly show that the interaction term contributes a nonzero second-order sensitivity.\n\nExpress your final answer as the ordered triplet $(S_{1},S_{2},S_{12})$ in exact fractional form. No rounding is required, and there are no physical units for these indices.",
            "solution": "The problem requires the calculation of the first-order and second-order Sobol' sensitivity indices for the function $f(x_{1},x_{2})=x_{1}+x_{2}+x_{1}x_{2}$, where the inputs $x_{1}$ and $x_{2}$ are independent random variables uniformly distributed on $[0,1]$.\n\nFirst, for a random variable $X \\sim \\mathrm{U}(0,1)$, we have the following moments:\n- Mean: $\\mathbb{E}[X] = \\int_{0}^{1} x \\,dx = \\frac{1}{2}$\n- Second raw moment: $\\mathbb{E}[X^2] = \\int_{0}^{1} x^2 \\,dx = \\frac{1}{3}$\n- Variance: $\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{12}$\n\n**1. Total Variance $\\mathrm{Var}(f)$**\nFirst, we calculate the total expectation of $f$:\n$$ \\mathbb{E}[f] = \\mathbb{E}[x_{1}+x_{2}+x_{1}x_{2}] = \\mathbb{E}[x_1] + \\mathbb{E}[x_2] + \\mathbb{E}[x_1]\\mathbb{E}[x_2] = \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2}\\cdot\\frac{1}{2} = \\frac{5}{4} $$\nNext, we calculate the expectation of $f^2$:\n$$ \\mathbb{E}[f^2] = \\mathbb{E}[(x_{1}+x_{2}+x_{1}x_{2})^2] = \\mathbb{E}[x_1^2 + x_2^2 + x_1^2x_2^2 + 2x_1x_2 + 2x_1^2x_2 + 2x_1x_2^2] $$\nUsing linearity and independence:\n$$ \\mathbb{E}[f^2] = \\mathbb{E}[x_1^2] + \\mathbb{E}[x_2^2] + \\mathbb{E}[x_1^2]\\mathbb{E}[x_2^2] + 2\\mathbb{E}[x_1]\\mathbb{E}[x_2] + 2\\mathbb{E}[x_1^2]\\mathbb{E}[x_2] + 2\\mathbb{E}[x_1]\\mathbb{E}[x_2^2] $$\n$$ \\mathbb{E}[f^2] = \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{3}\\cdot\\frac{1}{3} + 2\\cdot\\frac{1}{2}\\cdot\\frac{1}{2} + 2\\cdot\\frac{1}{3}\\cdot\\frac{1}{2} + 2\\cdot\\frac{1}{2}\\cdot\\frac{1}{3} = \\frac{2}{3} + \\frac{1}{9} + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{3} = \\frac{4}{3} + \\frac{1}{9} + \\frac{1}{2} = \\frac{24+2+9}{18} = \\frac{35}{18} $$\nThe total variance is:\n$$ \\mathrm{Var}(f) = \\mathbb{E}[f^2] - (\\mathbb{E}[f])^2 = \\frac{35}{18} - \\left(\\frac{5}{4}\\right)^2 = \\frac{35}{18} - \\frac{25}{16} = \\frac{280 - 225}{144} = \\frac{55}{144} $$\n\n**2. First-Order Partial Variances and Indices**\nThe conditional expectation of $f$ given $x_1$ is:\n$$ \\mathbb{E}[f \\mid x_1] = \\mathbb{E}[x_1 + x_2 + x_1 x_2 \\mid x_1] = x_1 + \\mathbb{E}[x_2] + x_1 \\mathbb{E}[x_2] = x_1 + \\frac{1}{2} + x_1\\left(\\frac{1}{2}\\right) = \\frac{3}{2}x_1 + \\frac{1}{2} $$\nThe first-order partial variance for $x_1$ is the variance of this expression:\n$$ V_1 = \\mathrm{Var}(\\mathbb{E}[f \\mid x_1]) = \\mathrm{Var}\\left(\\frac{3}{2}x_1 + \\frac{1}{2}\\right) = \\left(\\frac{3}{2}\\right)^2 \\mathrm{Var}(x_1) = \\frac{9}{4} \\times \\frac{1}{12} = \\frac{9}{48} = \\frac{3}{16} $$\nThe first-order Sobol' index for $x_1$ is:\n$$ S_1 = \\frac{V_1}{\\mathrm{Var}(f)} = \\frac{3/16}{55/144} = \\frac{3}{16} \\times \\frac{144}{55} = \\frac{3 \\times 9}{55} = \\frac{27}{55} $$\nDue to the symmetry of the function $f$ with respect to $x_1$ and $x_2$, we have $V_2 = V_1 = 3/16$ and $S_2 = S_1 = \\frac{27}{55}$.\n\n**3. Second-Order Interaction Variance and Index**\nThe second-order interaction variance is defined as $V_{12} = \\mathrm{Var}(f) - V_1 - V_2$.\n$$ V_{12} = \\frac{55}{144} - \\frac{3}{16} - \\frac{3}{16} = \\frac{55}{144} - \\frac{6}{16} = \\frac{55}{144} - \\frac{54}{144} = \\frac{1}{144} $$\nThis non-zero value ($1/144 \\neq 0$) explicitly demonstrates that there is a second-order interaction effect.\nThe second-order Sobol' interaction index is:\n$$ S_{12} = \\frac{V_{12}}{\\mathrm{Var}(f)} = \\frac{1/144}{55/144} = \\frac{1}{55} $$\nAs a check, the sum of indices is $S_1 + S_2 + S_{12} = \\frac{27}{55} + \\frac{27}{55} + \\frac{1}{55} = \\frac{55}{55} = 1$. The final answer is the triplet $(S_1, S_2, S_{12})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{27}{55}  \\frac{27}{55}  \\frac{1}{55}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}