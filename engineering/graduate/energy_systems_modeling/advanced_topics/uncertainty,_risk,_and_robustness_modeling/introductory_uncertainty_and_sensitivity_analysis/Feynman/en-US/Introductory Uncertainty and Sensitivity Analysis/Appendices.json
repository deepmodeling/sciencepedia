{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in any uncertainty analysis is to construct a credible probabilistic model for each uncertain input. This practice bridges the gap between empirical data and theoretical distributions. Here, you will use the method of moments to fit a Beta distribution, which is ideal for variables constrained to the $[0,1]$ interval, to the observed statistics of a wind farm's capacity factor. This exercise provides a foundational skill for parameterizing input uncertainties in energy systems models based on limited historical data. ",
            "id": "4098899",
            "problem": "A wind farm’s hourly capacity factor, denoted by the random variable $X$, lies in the interval $[0,1]$ and is modeled as a Beta distribution with shape parameters $\\alpha>0$ and $\\beta>0$. In introductory uncertainty and sensitivity analysis for energy systems modeling, it is common to calibrate a distribution to basic empirical characteristics. Suppose a long historical record yields a sample mean $m$ and sample variance $v$ of the capacity factor, with $0<m<1$ and $0<v<m(1-m)$. Using the method of moments, derive closed-form expressions for the shape parameters $\\alpha$ and $\\beta$ as functions of $m$ and $v$.\n\nYour derivation must start from the definition of the Beta probability density function $f(x;\\alpha,\\beta)$ on $[0,1]$, the Beta function $B(\\alpha,\\beta)$, and the integral definitions of the first and second moments. Express your final answer as a single analytic expression for the pair $(\\alpha,\\beta)$ in terms of $m$ and $v$. No numerical rounding is required, and no units should be included in the final expression.",
            "solution": "The problem requires us to find the shape parameters $\\alpha$ and $\\beta$ of a Beta distribution for a random variable $X$ on the interval $[0,1]$. We are given the sample mean $m$ and sample variance $v$ of $X$. The method of moments consists of equating the theoretical moments of the distribution (which are functions of the parameters to be estimated) with the sample moments calculated from data.\n\nThe probability density function (PDF) of a Beta-distributed random variable $X$ is given by:\n$$f(x; \\alpha, \\beta) = \\frac{x^{\\alpha-1}(1-x)^{\\beta-1}}{B(\\alpha, \\beta)}, \\quad \\text{for } x \\in [0,1]$$\nwhere $\\alpha > 0$ and $\\beta > 0$ are the shape parameters, and $B(\\alpha, \\beta)$ is the Beta function.\nThe standard results for the mean $E[X]$ and variance $Var(X)$ are:\n$$E[X] = \\frac{\\alpha}{\\alpha+\\beta}$$\n$$Var(X) = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}$$\nThe method of moments sets the theoretical mean equal to the sample mean $m$ and the theoretical variance equal to the sample variance $v$:\n$$m = \\frac{\\alpha}{\\alpha+\\beta} \\quad (1)$$\n$$v = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} \\quad (2)$$\nWe must now solve this system of two equations for the two unknowns, $\\alpha$ and $\\beta$.\n\nLet us manipulate the expression for $v$. Notice that the term $\\frac{\\alpha\\beta}{(\\alpha+\\beta)^2}$ can be expressed in terms of $m$. From equation $(1)$:\n$$1 - m = 1 - \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\beta}{\\alpha+\\beta}$$\nTherefore, the product $m(1-m)$ is:\n$$m(1-m) = \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)\\left(\\frac{\\beta}{\\alpha+\\beta}\\right) = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2}$$\nSubstituting this result into equation $(2)$:\n$$v = m(1-m) \\frac{1}{\\alpha+\\beta+1} \\quad (3)$$\nThis simplifies the system significantly. We can now solve equation $(3)$ for the sum $\\alpha+\\beta$:\n$$\\alpha+\\beta+1 = \\frac{m(1-m)}{v}$$\n$$\\alpha+\\beta = \\frac{m(1-m)}{v} - 1$$\nNow that we have an expression for the sum $\\alpha+\\beta$, we can use equation $(1)$ to solve for $\\alpha$:\n$$\\alpha = m(\\alpha+\\beta)$$\nSubstituting the expression for the sum:\n$$\\alpha = m \\left( \\frac{m(1-m)}{v} - 1 \\right)$$\nSimilarly, for $\\beta$:\n$$\\beta = (1-m)(\\alpha+\\beta)$$\nSubstituting the expression for the sum:\n$$\\beta = (1-m) \\left( \\frac{m(1-m)}{v} - 1 \\right)$$\nThe problem statement includes the constraint $0 < v < m(1-m)$, which implies $\\frac{m(1-m)}{v} > 1$. Therefore, the term $\\left(\\frac{m(1-m)}{v} - 1\\right)$ is strictly positive. Since we are also given $0 < m < 1$, both $m$ and $1-m$ are positive. Consequently, our derived expressions for $\\alpha$ and $\\beta$ are guaranteed to be positive, fulfilling the condition for the shape parameters of a Beta distribution.\n\nThe derived closed-form expressions for the pair $(\\alpha, \\beta)$ in terms of $m$ and $v$ are:\n$$\\alpha = m \\left( \\frac{m(1-m) - v}{v} \\right)$$\n$$\\beta = (1-m) \\left( \\frac{m(1-m) - v}{v} \\right)$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nm \\left( \\frac{m(1-m)}{v} - 1 \\right) & (1-m) \\left( \\frac{m(1-m)}{v} - 1 \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Monte Carlo simulation is a cornerstone of uncertainty propagation, but its practical application hinges on a critical question: how many simulation runs are sufficient? This exercise provides a formal answer by applying the Central Limit Theorem to determine the minimum sample size needed to estimate a model's output—such as the expected system cost—within a desired error margin $\\epsilon$ and confidence level $1-\\alpha$. Mastering this calculation is essential for designing computationally efficient and statistically robust simulation studies. ",
            "id": "4098879",
            "problem": "An energy systems planner is using Monte Carlo simulation to estimate the expected annualized system cost per megawatt-hour for a proposed generation portfolio under uncertain fuel prices and variable renewable output. Let the simulation output per run be a random variable $X$ with unknown mean $\\mu$ and finite variance $\\sigma^{2}$. Assume the outputs from independent runs are independent and identically distributed (i.i.d.) and that the Central Limit Theorem (CLT) applies to the sample mean. The planner requires that the estimator be accurate in the sense that the absolute error of the sample mean $\\left|\\overline{X}_{n}-\\mu\\right|$ is within a prescribed margin $\\epsilon$ with two-sided confidence level $1-\\alpha$.\n\nA pilot simulation of $m = 500$ runs yields a sample variance estimate of $\\hat{\\sigma}^{2} = 144$ in the same squared units as $X$. The planner sets the accuracy target to $\\epsilon = 2$ and the confidence level to $1-\\alpha = 0.9$. Use the asymptotic normal approximation implied by the CLT for the sampling distribution of the sample mean, treat $\\hat{\\sigma}^{2}$ as a conservative proxy for $\\sigma^{2}$, and determine the minimum Monte Carlo sample size $n$ such that the above accuracy requirement is met.\n\nProvide your final answer as the smallest integer $n$ that satisfies the requirement. Express the final answer as a pure number with no units. Do not round using significant figures; instead, return the minimal integer that meets the criterion.",
            "solution": "The problem asks for the minimum sample size $n$ required for a Monte Carlo simulation such that the sample mean $\\overline{X}_n$ is within a specified margin of error $\\epsilon$ of the true mean $\\mu$ with a given confidence level $1-\\alpha$.\n\nThe foundation for this problem is the Central Limit Theorem (CLT). According to the CLT, for a sufficiently large sample size $n$ of independent and identically distributed (i.i.d.) random variables, the sample mean $\\overline{X}_n$ is approximately normally distributed:\n$$\n\\overline{X}_n \\approx N\\left(\\mu, \\frac{\\sigma^2}{n}\\right)\n$$\nThe accuracy requirement is stated as a probability statement:\n$$\nP\\left(|\\overline{X}_n - \\mu| \\le \\epsilon\\right) \\ge 1 - \\alpha\n$$\nBy standardizing the sample mean, we can relate this to the standard normal distribution $Z \\sim N(0, 1)$:\n$$\nP\\left(\\left|\\frac{\\overline{X}_n - \\mu}{\\sigma/\\sqrt{n}}\\right| \\le \\frac{\\epsilon}{\\sigma/\\sqrt{n}}\\right) \\ge 1 - \\alpha\n$$\nThis implies that the margin must satisfy:\n$$\n\\frac{\\epsilon\\sqrt{n}}{\\sigma} \\ge z_{\\alpha/2}\n$$\nwhere $z_{\\alpha/2}$ is the critical value of the standard normal distribution that leaves a probability of $\\alpha/2$ in the upper tail. We can now solve for the minimum sample size $n$:\n$$\nn \\ge \\left(\\frac{z_{\\alpha/2}\\sigma}{\\epsilon}\\right)^2\n$$\nThe problem provides the necessary values:\n1.  The confidence level is $1-\\alpha = 0.9$. This implies $\\alpha = 0.1$, and thus $\\alpha/2 = 0.05$. We need the critical value $z_{0.05}$ for which the cumulative distribution function is $0.95$. From standard statistical tables, $z_{0.05} \\approx 1.64485$.\n2.  The margin of error is $\\epsilon = 2$.\n3.  The variance is estimated from a pilot study as $\\hat{\\sigma}^2 = 144$. We use this as a proxy for $\\sigma^2$, so the standard deviation is $\\sigma \\approx \\hat{\\sigma} = \\sqrt{144} = 12$.\n\nSubstituting these values into the inequality for $n$:\n$$\nn \\ge \\left(\\frac{1.64485 \\times 12}{2}\\right)^2\n$$\nFirst, calculate the term inside the parentheses:\n$$\n\\frac{1.64485 \\times 12}{2} = 1.64485 \\times 6 = 9.8691\n$$\nNow, square this value:\n$$\nn \\ge (9.8691)^2 \\approx 97.40\n$$\nSince the sample size $n$ must be an integer, we must choose the smallest integer that satisfies this inequality. This is found by taking the ceiling of the calculated value:\n$$\nn = \\lceil 97.40 \\rceil = 98\n$$\nTherefore, the minimum Monte Carlo sample size required is 98.",
            "answer": "$$\n\\boxed{98}\n$$"
        },
        {
            "introduction": "Once we understand the magnitude of uncertainty in a model's output, the next step is to identify its sources. This practice introduces the core concepts of variance-based global sensitivity analysis (GSA) by having you analytically compute Sobol' indices for a simple nonlinear model. By decomposing the total output variance, you will directly quantify the influence of individual inputs (first-order effects) and, critically, their interactions, revealing how GSA can uncover non-obvious relationships within a model. ",
            "id": "4098875",
            "problem": "Consider a stylized energy systems model of normalized annual output defined by the mapping $f:[0,1]^{2}\\rightarrow \\mathbb{R}$ with $f(x_{1},x_{2})=x_{1}+x_{2}+x_{1}x_{2}$. Here, $x_{1}$ and $x_{2}$ denote two independent normalized design or resource factors (for instance, scaled deployment decisions for two technologies), each modeled as realizations from the Uniform distribution (U) on $[0,1]$, i.e., $x_{i}\\sim \\mathrm{U}(0,1)$, $i\\in\\{1,2\\}$, and $x_{1}\\perp x_{2}$. \n\nUsing variance-based global sensitivity analysis and the Analysis of Variance (ANOVA) decomposition, start from the core definitions: the total variance $\\mathrm{Var}(f)$, the first-order partial variances $\\mathrm{Var}\\big(\\mathbb{E}[f\\mid x_{i}]\\big)$, and the second-order interaction variance $\\mathrm{Var}(f)-\\sum_{i=1}^{2}\\mathrm{Var}\\big(\\mathbb{E}[f\\mid x_{i}]\\big)$, all under the independence and distributional assumptions stated. Derive the first-order Sobol indices $S_{1}$ and $S_{2}$ and the second-order Sobol interaction index $S_{12}$ for $f(x_{1},x_{2})$. Explicitly show that the interaction term contributes a nonzero second-order sensitivity.\n\nExpress your final answer as the ordered triplet $(S_{1},S_{2},S_{12})$ in exact fractional form. No rounding is required, and there are no physical units for these indices.",
            "solution": "The problem requires the calculation of the first-order and second-order Sobol' sensitivity indices for the function $f(x_{1},x_{2})=x_{1}+x_{2}+x_{1}x_{2}$, where the inputs $x_{1}$ and $x_{2}$ are independent random variables uniformly distributed on the interval $[0,1]$.\n\nFirst, we establish the properties of a random variable $X \\sim \\mathrm{U}(0,1)$. The expectation is $\\mathbb{E}[X] = \\frac{1}{2}$ and the variance is $\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\frac{1}{3} - (\\frac{1}{2})^2 = \\frac{1}{12}$. These properties apply to both $x_1$ and $x_2$.\n\nTo find the total variance $D = \\mathrm{Var}(f)$, we first compute the total expectation of $f$:\n$$ \\mathbb{E}[f] = \\mathbb{E}[x_{1}+x_{2}+x_{1}x_{2}] = \\mathbb{E}[x_1] + \\mathbb{E}[x_2] + \\mathbb{E}[x_1]\\mathbb{E}[x_2] = \\frac{1}{2} + \\frac{1}{2} + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{5}{4} $$\nNext, we compute the expectation of $f^2$, using independence and the known moments $\\mathbb{E}[X] = 1/2$ and $\\mathbb{E}[X^2] = 1/3$:\n$$ \\mathbb{E}[f^2] = \\mathbb{E}[x_{1}^2] + \\mathbb{E}[x_{2}^2] + \\mathbb{E}[x_{1}^2 x_{2}^2] + 2\\mathbb{E}[x_{1}x_{2}] + 2\\mathbb{E}[x_{1}^2 x_{2}] + 2\\mathbb{E}[x_{1}x_{2}^2] = \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{9} + \\frac{2}{4} + \\frac{2}{6} + \\frac{2}{6} = \\frac{35}{18} $$\nNow we compute the total variance $D$:\n$$ D = \\mathrm{Var}(f) = \\mathbb{E}[f^2] - (\\mathbb{E}[f])^2 = \\frac{35}{18} - \\left(\\frac{5}{4}\\right)^2 = \\frac{35}{18} - \\frac{25}{16} = \\frac{280 - 225}{144} = \\frac{55}{144} $$\nNext, we calculate the first-order partial variance for $x_1$, which is $V_1 = \\mathrm{Var}(\\mathbb{E}[f \\mid x_1])$. We compute the conditional expectation by treating $x_1$ as constant and integrating over $x_2$:\n$$ \\mathbb{E}[f \\mid x_1] = x_1 + \\mathbb{E}[x_2] + x_1 \\mathbb{E}[x_2] = x_1 + \\frac{1}{2} + x_1\\left(\\frac{1}{2}\\right) = \\frac{3}{2}x_1 + \\frac{1}{2} $$\nThen we compute the variance of this expression with respect to $x_1$:\n$$ V_1 = \\mathrm{Var}\\left(\\frac{3}{2}x_1 + \\frac{1}{2}\\right) = \\left(\\frac{3}{2}\\right)^2 \\mathrm{Var}(x_1) = \\frac{9}{4} \\times \\frac{1}{12} = \\frac{3}{16} $$\nThe first-order Sobol' index for $x_1$ is $S_1 = \\frac{V_1}{D} = \\frac{3/16}{55/144} = \\frac{3}{16} \\times \\frac{144}{55} = \\frac{27}{55}$. Due to the symmetry of the function, we have $S_2 = 27/55$.\n\nFinally, we calculate the second-order interaction index $S_{12}$. The interaction variance is $V_{12} = D - V_1 - V_2$:\n$$ V_{12} = \\frac{55}{144} - \\frac{3}{16} - \\frac{3}{16} = \\frac{55 - 27 - 27}{144} = \\frac{1}{144} $$\nThis variance is non-zero, confirming a non-zero second-order sensitivity. The second-order Sobol' index is:\n$$ S_{12} = \\frac{V_{12}}{D} = \\frac{1/144}{55/144} = \\frac{1}{55} $$\nAs a check, the indices sum to one: $S_1 + S_2 + S_{12} = \\frac{27}{55} + \\frac{27}{55} + \\frac{1}{55} = 1$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{27}{55} & \\frac{27}{55} & \\frac{1}{55}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}