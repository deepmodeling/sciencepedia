{
    "hands_on_practices": [
        {
            "introduction": "Mastering robust optimization begins with a foundational skill: transforming an uncertain constraint into a deterministic, solvable equivalent. This practice guides you through this core process for a linear constraint where coefficients are subject to uncertainty contained within a simple 'box' model. By deriving the robust counterpart from first principles, you will develop a fundamental intuition for how to guard against worst-case outcomes and ensure system reliability .",
            "id": "4119827",
            "problem": "An aggregator plans capacity procurement for a set of $n$ technologies to meet a firm capacity requirement under uncertain availability. Let $x \\in \\mathbb{R}^{n}$ denote the procurement decision vector, where $x_{i}$ represents the procured nameplate capacity of technology $i$. Let $a \\in \\mathbb{R}^{n}$ denote uncertain availability multipliers, where $a_{i}$ is the realized fraction of procured capacity that is deliverable at the time of need. The firm capacity requirement is $b \\in \\mathbb{R}$, measured in Megawatt (MW). The reliability constraint requires the realized firm capacity to satisfy $a^{\\top} x \\ge b$.\n\nAssume a box uncertainty set around the nominal availability vector $\\bar a \\in \\mathbb{R}^{n}$ with componentwise radius $\\Delta \\in \\mathbb{R}_{+}^{n}$, defined as\n$$\n\\mathcal{U} \\;=\\; \\left\\{ a \\in \\mathbb{R}^{n} \\;:\\; |a_{i} - \\bar a_{i}| \\le \\Delta_{i},\\;\\; i=1,\\dots,n \\right\\}.\n$$\nUsing the fundamental definition of robust optimization, a robust constraint must hold for all realizations $a \\in \\mathcal{U}$, which is equivalently enforced by requiring the worst-case (minimum) value of $a^{\\top} x$ over $\\mathcal{U}$ to be at least $b$.\n\nDerive, from first principles and without invoking pre-memorized formulas, a closed-form analytic expression for the worst-case value\n$$\n\\min_{a \\in \\mathcal{U}} a^{\\top} x\n$$\nas a function of $\\bar a$, $\\Delta$, and $x$. Then, write the robust counterpart of $a^{\\top} x \\ge b$ in terms of $x$ only. Express your final answer as the closed-form analytic expression for $\\min_{a \\in \\mathcal{U}} a^{\\top} x$. No numerical approximation or rounding is required.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Decision vector: $x \\in \\mathbb{R}^{n}$, where $x_{i}$ is the procured nameplate capacity of technology $i$.\n- Uncertain parameter vector: $a \\in \\mathbb{R}^{n}$, where $a_{i}$ is the realized availability multiplier.\n- Firm capacity requirement: $b \\in \\mathbb{R}$.\n- Reliability constraint: $a^{\\top} x \\ge b$.\n- Nominal availability vector: $\\bar a \\in \\mathbb{R}^{n}$.\n- Uncertainty radius vector: $\\Delta \\in \\mathbb{R}_{+}^{n}$.\n- Uncertainty set definition: $\\mathcal{U} \\;=\\; \\left\\{ a \\in \\mathbb{R}^{n} \\;:\\; |a_{i} - \\bar a_{i}| \\le \\Delta_{i},\\;\\; i=1,\\dots,n \\right\\}$.\n- Task 1: Derive a closed-form analytic expression for $\\min_{a \\in \\mathcal{U}} a^{\\top} x$.\n- Task 2: Write the robust counterpart of $a^{\\top} x \\ge b$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem is a standard application of robust optimization, a well-established subfield of mathematical optimization. The formulation models capacity planning under uncertainty, a common and important problem in energy systems engineering. The concepts used are standard and the model, while simplified, is scientifically sound.\n- **Well-Posed**: The problem asks for the minimum of a linear function, $f(a) = a^{\\top}x$, over a non-empty, compact, and convex set $\\mathcal{U}$ (a hyperrectangle). By the Weierstrass Extreme Value Theorem, a continuous function (in this case, linear) on a compact set attains its minimum and maximum. The minimum value is unique. Therefore, the problem is well-posed.\n- **Objective**: The problem is stated using precise, unambiguous mathematical language and standard terminology from optimization and energy systems.\n- **Completeness and Consistency**: The problem provides all necessary information to derive the requested expression. The definitions of the vectors and the uncertainty set are clear and self-contained. There are no internal contradictions. While the physical interpretation of \"procured capacity\" suggests $x_i \\ge 0$, the problem is formulated more generally for $x \\in \\mathbb{R}^n$, which is mathematically coherent. The derivation will be performed for the general case.\n- **Other Flaws**: The problem does not violate any other criteria such as being unrealistic, ill-structured, trivial, or containing pseudoscience. It is a fundamental and instructive exercise in robust optimization.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the closed-form analytical expression for the worst-case value of the realized capacity, which is formulated as the following minimization problem:\n$$\n\\min_{a \\in \\mathcal{U}} a^{\\top} x\n$$\nThe objective function can be written as a sum over the individual components:\n$$\na^{\\top} x = \\sum_{i=1}^{n} a_{i} x_{i}\n$$\nThe uncertainty set $\\mathcal{U}$ defines independent constraints on each component $a_i$. Specifically, for each $i \\in \\{1, \\dots, n\\}$, the variable $a_i$ is constrained to lie within the closed interval $[\\bar{a}_{i} - \\Delta_{i}, \\bar{a}_{i} + \\Delta_{i}]$.\n\nSince the objective function is a sum of terms where each term $a_i x_i$ involves only one variable $a_i$, and the constraints for each $a_i$ are independent of the other variables $a_j$ for $j \\neq i$, the minimization problem is separable. This allows us to exchange the sum and the minimization operators:\n$$\n\\min_{a \\in \\mathcal{U}} \\left( \\sum_{i=1}^{n} a_{i} x_{i} \\right) = \\sum_{i=1}^{n} \\left( \\min_{\\bar{a}_{i} - \\Delta_{i} \\le a_{i} \\le \\bar{a}_{i} + \\Delta_{i}} a_{i} x_{i} \\right)\n$$\nWe now analyze the inner minimization problem for each component $i$:\n$$\n\\min_{\\bar{a}_{i} - \\Delta_{i} \\le a_{i} \\le \\bar{a}_{i} + \\Delta_{i}} a_{i} x_{i}\n$$\nThe function to be minimized, $f(a_i) = a_i x_i$, is a linear function of the variable $a_i$. The minimum of a linear function over a closed interval must occur at one of the interval's endpoints. The two endpoints for $a_i$ are $\\bar{a}_{i} - \\Delta_{i}$ and $\\bar{a}_{i} + \\Delta_{i}$. The choice of endpoint that minimizes $a_i x_i$ depends on the sign of the fixed coefficient $x_i$.\n\n1.  If $x_{i} > 0$: To minimize the product $a_i x_i$, we must choose the smallest possible value for $a_i$. This value is the lower bound of the interval, $a_{i}^{*} = \\bar{a}_{i} - \\Delta_{i}$. The minimum value of the term is $(\\bar{a}_{i} - \\Delta_{i}) x_{i}$.\n\n2.  If $x_{i} < 0$: To minimize the product $a_i x_i$, we must choose the largest possible value for $a_i$, as multiplying by a negative $x_i$ will reverse the inequality. This value is the upper bound of the interval, $a_{i}^{*} = \\bar{a}_{i} + \\Delta_{i}$. The minimum value of the term is $(\\bar{a}_{i} + \\Delta_{i}) x_{i}$.\n\n3.  If $x_{i} = 0$: The product $a_i x_i$ is always $0$, regardless of the value of $a_i$. The minimum value is $0$.\n\nThese three cases can be unified into a single expression. We can express the minimum value of the term $a_i x_i$ as follows:\n- For $x_i > 0$: $\\bar{a}_{i}x_{i} - \\Delta_{i}x_{i} = \\bar{a}_{i}x_{i} - \\Delta_{i}|x_{i}|$\n- For $x_i < 0$: $\\bar{a}_{i}x_{i} + \\Delta_{i}x_{i} = \\bar{a}_{i}x_{i} - \\Delta_{i}(-x_{i}) = \\bar{a}_{i}x_{i} - \\Delta_{i}|x_{i}|$\n- For $x_i = 0$: $0 = \\bar{a}_{i}(0) - \\Delta_{i}|0| = \\bar{a}_{i}x_{i} - \\Delta_{i}|x_{i}|$\n\nThus, for any $x_i \\in \\mathbb{R}$, the minimum value of $a_i x_i$ over its feasible interval is given by:\n$$\n\\min_{a_{i}} a_{i} x_{i} = \\bar{a}_{i}x_{i} - \\Delta_{i}|x_{i}|\n$$\nThe value of $a_i$ that achieves this minimum is $a_i^* = \\bar{a}_i - \\Delta_i \\cdot \\text{sgn}(x_i)$, where $\\text{sgn}(\\cdot)$ is the sign function.\n\nSumming these individual minimum values over all $i$ from $1$ to $n$ gives the overall minimum of $a^{\\top}x$:\n$$\n\\min_{a \\in \\mathcal{U}} a^{\\top} x = \\sum_{i=1}^{n} (\\bar{a}_{i}x_{i} - \\Delta_{i}|x_{i}|)\n$$\nThis expression can be separated into two parts:\n$$\n\\min_{a \\in \\mathcal{U}} a^{\\top} x = \\sum_{i=1}^{n} \\bar{a}_{i}x_{i} - \\sum_{i=1}^{n} \\Delta_{i}|x_{i}|\n$$\nThe first term is the dot product of the nominal availability vector $\\bar a$ and the decision vector $x$. The final expression is:\n$$\n\\min_{a \\in \\mathcal{U}} a^{\\top} x = \\bar{a}^{\\top}x - \\sum_{i=1}^{n} \\Delta_{i}|x_{i}|\n$$\nThis is the closed-form analytic expression requested.\n\nThe robust counterpart of the original constraint $a^{\\top} x \\ge b$ requires the constraint to hold for all possible realizations of $a$ in the uncertainty set $\\mathcal{U}$. This is equivalent to ensuring that the minimum possible value of the left-hand side is greater than or equal to the right-hand side:\n$$\n\\min_{a \\in \\mathcal{U}} (a^{\\top} x) \\ge b\n$$\nSubstituting the derived expression for the minimum, we obtain the robust counterpart, which is an inequality constraint on $x$ only:\n$$\n\\bar{a}^{\\top}x - \\sum_{i=1}^{n} \\Delta_{i}|x_{i}| \\ge b\n$$\nThis is a convex constraint, as $\\bar{a}^{\\top}x$ is linear and $\\sum_{i=1}^{n} \\Delta_{i}|x_{i}|$ is a convex function (a weighted L1-norm).\nThe final answer requested is the closed-form expression for the minimum value itself.",
            "answer": "$$\n\\boxed{\\bar{a}^{\\top}x - \\sum_{i=1}^{n} \\Delta_{i} |x_{i}|}\n$$"
        },
        {
            "introduction": "While robust optimization (RO) hedges against uncertainty within predefined sets, Distributionally Robust Optimization (DRO) offers a powerful alternative when we only have statistical information, like mean and variance. This exercise delves into the heart of DRO by asking you to identify the single most adversarial probability distribution from an entire family of possibilities. Completing this practice will reveal how DRO quantifies risk by finding the worst-case probabilistic scenario, leading to the celebrated Cantelli's inequality .",
            "id": "4119953",
            "problem": "Consider a single transmission line in an electric power network modeled under the Direct Current (DC) power flow approximation. Let the uncertain real-time line flow be represented by the random variable $F$, whose true probability distribution is unknown but is known to satisfy the following moment information obtained from forecasting and historical data: its mean is $\\mu_{F}$ and its variance is $\\sigma_{F}^{2}$. A planning decision imposes the chance constraint that the line flow must not exceed a thermal limit $\\bar{F}$ with high probability. Specifically, the decision must be feasible for any distribution of $F$ consistent with this moment information, in the sense of Distributionally Robust Optimization (DRO).\n\nFormally, define the ambiguity set as the family of all probability distributions on $\\mathbb{R}$ with mean $\\mu_{F}$ and variance $\\sigma_{F}^{2}$. The distributionally robust chance constraint requires that $\\mathbb{P}(F \\leq \\bar{F}) \\geq 1 - \\varepsilon$ for all distributions in this ambiguity set. Assume $\\bar{F} > \\mu_{F}$ so that the limit is above the mean line flow. Construct the worst-case distribution (within the ambiguity set) that maximizes the violation probability $\\mathbb{P}(F > \\bar{F})$, and interpret the way its probability mass is aligned relative to the violation boundary $F = \\bar{F}$ to maximize risk. Then, compute the corresponding worst-case violation probability as a closed-form expression in terms of $\\mu_{F}$, $\\sigma_{F}$, and $\\bar{F}$.\n\nExpress your final answer as a single closed-form analytic expression. No rounding is required, and no physical units should be included in the final expression.",
            "solution": "The problem is valid. It is scientifically grounded in the fields of probability theory and distributionally robust optimization, well-posed, and objective. All necessary information is provided.\n\nThe problem asks for the worst-case violation probability of a chance constraint on a power transmission line flow, $F$. The constraint is that the flow $F$ must not exceed a thermal limit $\\bar{F}$. The violation event is therefore $F > \\bar{F}$. We are given that the uncertain flow $F$ is a random variable whose distribution is unknown, but its mean $\\mathbb{E}[F] = \\mu_{F}$ and variance $\\mathbb{V}[F] = \\sigma_{F}^{2}$ are known. The problem is posed within a Distributionally Robust Optimization (DRO) framework, which means we must find the maximum possible violation probability over all conceivable distributions of $F$ that are consistent with the given moment information.\n\nLet $\\mathcal{P}$ be the ambiguity set, which is the family of all probability distributions on $\\mathbb{R}$ with a mean of $\\mu_{F}$ and a variance of $\\sigma_{F}^{2}$. The task is to solve the following optimization problem:\n$$ \\sup_{P \\in \\mathcal{P}} \\mathbb{P}(F > \\bar{F}) $$\nThis is a classic problem in the theory of moments. The extremal distributions for such problems, which maximize or minimize probabilities of events subject to moment constraints, are known to be discrete distributions with a finite number of support points.\n\nTo maximize the probability mass in the region $( \\bar{F}, \\infty)$, the worst-case distribution should avoid \"wasting\" probability mass by spreading it out. Intuitively, it should concentrate the mass at specific points. Let us hypothesize that the worst-case distribution is a discrete distribution with two support points, $x_1$ and $x_2$. Let the corresponding probabilities be $p_1$ and $p_2$. In order to have a non-zero violation probability, at least one point must be in the violation region. Let $x_2 > \\bar{F}$ and $x_1 \\le \\bar{F}$. The violation probability is $p_2 = \\mathbb{P}(F > \\bar{F})$.\n\nThe distribution must satisfy the three constraints given by the moment information and the law of total probability:\n1.  $p_1 + p_2 = 1$\n2.  $p_1 x_1 + p_2 x_2 = \\mu_F$\n3.  $p_1 (x_1 - \\mu_F)^2 + p_2 (x_2 - \\mu_F)^2 = \\sigma_F^2$\n\nFrom constraint (1), $p_1 = 1 - p_2$. Substituting this into constraint (2):\n$(1 - p_2) x_1 + p_2 x_2 = \\mu_F$\n$x_1 - p_2 x_1 + p_2 x_2 = \\mu_F$\n$x_1 = \\mu_F - p_2(x_2 - x_1)$\nThis expression is not directly useful. Let's express $x_1$ and $x_2$ in terms of their deviations from the mean. From constraint (2):\n$p_1(x_1 - \\mu_F) + p_2(x_2 - \\mu_F) = 0 \\implies (1-p_2)(x_1 - \\mu_F) = -p_2(x_2 - \\mu_F)$.\nSo, $x_1 - \\mu_F = -\\frac{p_2}{1-p_2}(x_2 - \\mu_F)$.\n\nNow, substitute this into the variance constraint (3):\n$(1-p_2) \\left( -\\frac{p_2}{1-p_2}(x_2 - \\mu_F) \\right)^2 + p_2 (x_2 - \\mu_F)^2 = \\sigma_F^2$\n$(1-p_2) \\frac{p_2^2}{(1-p_2)^2} (x_2 - \\mu_F)^2 + p_2 (x_2 - \\mu_F)^2 = \\sigma_F^2$\n$\\frac{p_2^2}{1-p_2} (x_2 - \\mu_F)^2 + p_2 (x_2 - \\mu_F)^2 = \\sigma_F^2$\n$(x_2 - \\mu_F)^2 \\left( \\frac{p_2^2}{1-p_2} + p_2 \\right) = \\sigma_F^2$\n$(x_2 - \\mu_F)^2 \\left( \\frac{p_2^2 + p_2(1-p_2)}{1-p_2} \\right) = \\sigma_F^2$\n$(x_2 - \\mu_F)^2 \\left( \\frac{p_2^2 + p_2 - p_2^2}{1-p_2} \\right) = \\sigma_F^2$\n$(x_2 - \\mu_F)^2 \\frac{p_2}{1-p_2} = \\sigma_F^2$\n\nWe can now solve for $p_2$, the violation probability we wish to maximize:\n$p_2(x_2 - \\mu_F)^2 = (1-p_2)\\sigma_F^2 = \\sigma_F^2 - p_2 \\sigma_F^2$\n$p_2 \\left( (x_2 - \\mu_F)^2 + \\sigma_F^2 \\right) = \\sigma_F^2$\n$$ p_2 = \\frac{\\sigma_F^2}{\\sigma_F^2 + (x_2 - \\mu_F)^2} $$\nTo maximize $p_2$, we must minimize the denominator. This means we must minimize the term $(x_2 - \\mu_F)^2$ subject to the constraint that $x_2$ represents the violating outcome, i.e., $x_2 > \\bar{F}$.\nWe are given that $\\bar{F} > \\mu_F$. The function $g(x_2) = (x_2 - \\mu_F)^2$ is an increasing function for $x_2 > \\mu_F$. Since our domain for $x_2$ is $(\\bar{F}, \\infty)$, which is a subset of $(\\mu_F, \\infty)$, we must choose $x_2$ to be as small as possible. The infimum of $x_2$ over the set $(\\bar{F}, \\infty)$ is $\\bar{F}$.\nThe supremum of the probability $p_2$ is therefore achieved as $x_2$ approaches $\\bar{F}$ from above:\n$$ \\sup_{x_2 > \\bar{F}} p_2 = \\lim_{x_2 \\to \\bar{F}^+} \\frac{\\sigma_F^2}{\\sigma_F^2 + (x_2 - \\mu_F)^2} = \\frac{\\sigma_F^2}{\\sigma_F^2 + (\\bar{F} - \\mu_F)^2} $$\nThis expression represents the worst-case violation probability. This result is a form of the one-sided Chebyshev inequality, also known as Cantelli's inequality.\n\nThe problem also asks to construct the worst-case distribution and interpret its structure. The supremum is not technically attained by a distribution for the strict inequality $\\mathbb{P}(F > \\bar{F})$. However, the same value is the maximum for the non-strict inequality $\\mathbb{P}(F \\ge \\bar{F})$, and this maximum is attained. In engineering and optimization practice, this distinction is often elided, and the distribution that attains the maximum for the non-strict inequality is referred to as the \"worst-case distribution\".\n\nThis worst-case distribution concentrates all probability mass at two points. One point is placed exactly at the violation boundary $x_2 = \\bar{F}$. The other point, $x_1$, is placed such that the mean and variance constraints are met.\nThe probability mass at $x_2 = \\bar{F}$ is the worst-case probability itself:\n$$ p_2 = \\mathbb{P}(F = \\bar{F}) = \\frac{\\sigma_F^2}{\\sigma_F^2 + (\\bar{F} - \\mu_F)^2} $$\nThe probability mass at $x_1$ is:\n$$ p_1 = 1 - p_2 = 1 - \\frac{\\sigma_F^2}{\\sigma_F^2 + (\\bar{F} - \\mu_F)^2} = \\frac{(\\bar{F} - \\mu_F)^2}{\\sigma_F^2 + (\\bar{F} - \\mu_F)^2} $$\nThe location of the point $x_1$ is found from the relation $x_1 - \\mu_F = -\\frac{p_2}{1-p_2}(x_2 - \\mu_F)$:\n$$ \\frac{p_2}{1-p_2} = \\frac{\\sigma_F^2 / (\\dots)}{(\\bar{F} - \\mu_F)^2 / (\\dots)} = \\frac{\\sigma_F^2}{(\\bar{F} - \\mu_F)^2} $$\nSo, with $x_2 = \\bar{F}$:\n$$ x_1 = \\mu_F - \\frac{\\sigma_F^2}{(\\bar{F} - \\mu_F)^2}(\\bar{F} - \\mu_F) = \\mu_F - \\frac{\\sigma_F^2}{\\bar{F} - \\mu_F} $$\nThe interpretation of this distribution is that nature, or uncertainty, acts as an adversary. To maximize the probability of violating the limit $\\bar{F}$, it creates a binary world. With probability $p_2$, the \"bad\" outcome occurs, where the line flow lands precisely on the most critical point, the boundary $\\bar{F}$. With probability $p_1$, the \"good\" outcome occurs, but to satisfy the moment constraints, this outcome $x_1$ must be located far to the left of the mean. This structure represents the most damaging possible realization of uncertainty given only mean and variance information, eschewing well-behaved distributions like the Gaussian in favor of extreme, polarized outcomes.\n\nThe final answer is the closed-form expression for the worst-case violation probability.",
            "answer": "$$\\boxed{\\frac{\\sigma_{F}^{2}}{\\sigma_{F}^{2} + (\\bar{F} - \\mu_{F})^{2}}}$$"
        },
        {
            "introduction": "Having explored the fundamentals of RO and DRO, we now apply these concepts to a practical energy systems challenge: ensuring the secure operation of a power grid. This problem requires you to formulate a robust economic dispatch model for a transmission network, considering uncertain electricity demand modeled by a sophisticated budget-of-uncertainty set. You will use linear programming duality to construct a tractable robust counterpart, a key technique for solving large-scale, real-world optimization problems in energy .",
            "id": "4119881",
            "problem": "Consider a three-bus transmission network modeled under the Direct-Current (DC) power flow approximation. Buses are indexed by $1, 2, 3$, with bus $1$ chosen as the slack bus so that $\\theta_{1} = 0$. Lines $(1,2)$ and $(2,3)$ have susceptances $b_{12} = 10$ and $b_{23} = 5$, respectively. The DC nodal equations follow from Kirchhoff’s current law and linearized Ohm’s law: $\\boldsymbol{B}\\boldsymbol{\\theta} = \\boldsymbol{y}$, where $\\boldsymbol{B}$ is the network Laplacian based on line susceptances, $\\boldsymbol{\\theta}$ are bus voltage phase angles, and $\\boldsymbol{y}$ are net injections at buses (generation minus demand). The line flows are $f_{12} = b_{12}(\\theta_{1} - \\theta_{2})$ and $f_{23} = b_{23}(\\theta_{2} - \\theta_{3})$. The line thermal limits are $|f_{12}| \\leq F_{12}$ and $|f_{23}| \\leq F_{23}$.\n\nThere are generators at buses $1$ and $2$ with outputs $g_{1}$ and $g_{2}$, respectively, and linear costs $c_{1} = 20$ and $c_{2} = 40$ (in dollars per megawatt-hour). The generator capacities satisfy $0 \\leq g_{1} \\leq 120$ and $0 \\leq g_{2} \\leq 120$. Nominal demands are $d_{2}^{0} = 90$ and $d_{3}^{0} = 30$. The nominal power balance must hold: $g_{1} + g_{2} = d_{2}^{0} + d_{3}^{0}$. There is no generator at bus $3$.\n\nDemands at buses $2$ and $3$ are uncertain and modeled by a Bertsimas–Sim budget-of-uncertainty set: $d_{i} = d_{i}^{0} + \\hat{d}_{i} s_{i}$, where $i \\in \\{2,3\\}$, $\\hat{d}_{2} = 12$, $\\hat{d}_{3} = 10$, $0 \\leq s_{i} \\leq 1$, and $s_{2} + s_{3} \\leq \\Gamma$ with $\\Gamma = 1.5$. The uncertainty reflects upward deviations of demand only; any net imbalance is absorbed at the slack bus by construction of the DC model.\n\nTask:\n1. Starting from the DC power flow relations and the definition of the Bertsimas–Sim budget-of-uncertainty set, derive a tractable linear program (LP) for robust generator dispatch that enforces the line constraints $|f_{12}| \\leq F_{12}$ and $|f_{23}| \\leq F_{23}$ for all demand realizations in the uncertainty set. You must eliminate the absolute values by splitting each into two linear inequalities and then robustify the inequality with respect to the budgeted uncertainty using linear programming duality to obtain an equivalent deterministic LP. Introduce any necessary auxiliary variables that arise in the robust counterpart derivation and clearly state the resulting constraints.\n\n2. Evaluate the derived LP for the following numerical parameters: $F_{12} = 80$ and $F_{23} = 40$. Compute the optimal robust dispatch cost and provide the final numerical value. Express the final cost in dollars per hour ($/h). No rounding is required; report the exact value.\n\nYour final answer must be a single real number representing the optimal robust dispatch cost.",
            "solution": "We begin from the DC power flow approximation, which is derived by linearizing the active power flow equations under small angle assumptions. The susceptance-weighted Laplacian $\\boldsymbol{B}$ is\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n10 & -10 & 0 \\\\\n-10 & 15 & -5 \\\\\n0 & -5 & 5\n\\end{pmatrix},\n$$\nand with slack bus angle $\\theta_{1} = 0$, the reduced system for buses $2$ and $3$ is\n$$\n\\begin{pmatrix}\n15 & -5 \\\\\n-5 & 5\n\\end{pmatrix}\n\\begin{pmatrix}\n\\theta_{2} \\\\\n\\theta_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_{2} \\\\\ny_{3}\n\\end{pmatrix},\n$$\nwhere $y_{i}$ denotes net injection at bus $i$. There is generation only at buses $1$ and $2$, so $y_{2} = g_{2} - d_{2}$ and $y_{3} = -d_{3}$.\n\nCompute the inverse of the $2 \\times 2$ matrix:\n$$\n\\begin{pmatrix}\n15 & -5 \\\\\n-5 & 5\n\\end{pmatrix}^{-1}\n= \\frac{1}{50}\n\\begin{pmatrix}\n5 & 5 \\\\\n5 & 15\n\\end{pmatrix}.\n$$\nHence\n$$\n\\theta_{2} = \\frac{1}{50}(5 y_{2} + 5 y_{3}) = \\frac{1}{10}(y_{2} + y_{3}), \\quad\n\\theta_{3} = \\frac{1}{50}(5 y_{2} + 15 y_{3}) = \\frac{1}{10} y_{2} + \\frac{3}{10} y_{3}.\n$$\nThe line flows are\n$$\nf_{12} = b_{12}(\\theta_{1} - \\theta_{2}) = -10 \\theta_{2} = - (y_{2} + y_{3}),\n$$\n$$\nf_{23} = b_{23}(\\theta_{2} - \\theta_{3}) = 5(\\theta_{2} - \\theta_{3}) = - y_{3}.\n$$\nSubstituting $y_{2} = g_{2} - d_{2}$ and $y_{3} = -d_{3}$ gives the affine forms\n$$\nf_{12} = d_{2} + d_{3} - g_{2}, \\quad f_{23} = d_{3}.\n$$\n\nWe must enforce $|f_{12}| \\leq F_{12}$ and $|f_{23}| \\leq F_{23}$ robustly for all demands $d_{2}, d_{3}$ in the Bertsimas–Sim budget set:\n$$\n\\mathcal{U} = \\left\\{ (d_{2}, d_{3}) : d_{i} = d_{i}^{0} + \\hat{d}_{i} s_{i}, \\; 0 \\leq s_{i} \\leq 1, \\; s_{2} + s_{3} \\leq \\Gamma \\right\\},\n$$\nwith $d_{2}^{0} = 90$, $d_{3}^{0} = 30$, $\\hat{d}_{2} = 12$, $\\hat{d}_{3} = 10$, and $\\Gamma = 1.5$.\n\nEach absolute value inequality splits into two linear inequalities:\n1. $f_{12} \\leq F_{12}$ and $-f_{12} \\leq F_{12}$,\n2. $f_{23} \\leq F_{23}$ and $-f_{23} \\leq F_{23}$.\n\nExpress each in terms of the uncertain demands:\n- For line $(1,2)$:\n$$\nd_{2}^{0} + \\hat{d}_{2} s_{2} + d_{3}^{0} + \\hat{d}_{3} s_{3} - g_{2} \\leq F_{12} \\quad \\text{for all } (s_{2}, s_{3}) \\in \\mathcal{S},\n$$\n$$\n- d_{2}^{0} - \\hat{d}_{2} s_{2} - d_{3}^{0} - \\hat{d}_{3} s_{3} + g_{2} \\leq F_{12} \\quad \\text{for all } (s_{2}, s_{3}) \\in \\mathcal{S},\n$$\nwhere $\\mathcal{S} = \\{ (s_{2}, s_{3}) : 0 \\leq s_{i} \\leq 1, \\; s_{2} + s_{3} \\leq \\Gamma \\}$.\n\n- For line $(2,3)$:\n$$\nd_{3}^{0} + \\hat{d}_{3} s_{3} \\leq F_{23} \\quad \\text{for all } (s_{2}, s_{3}) \\in \\mathcal{S},\n$$\n$$\n- d_{3}^{0} - \\hat{d}_{3} s_{3} \\leq F_{23} \\quad \\text{for all } (s_{2}, s_{3}) \\in \\mathcal{S}.\n$$\n\nRobustification proceeds by taking the worst case over $\\mathcal{S}$ for any inequality with positive coefficients multiplying $s_{i}$. The fundamental base for the robust counterpart is linear programming duality. Specifically, for\n$$\n\\sup_{(s_{2}, s_{3}) \\in \\mathcal{S}} \\left( w_{2} s_{2} + w_{3} s_{3} \\right),\n$$\nthe dual is\n$$\n\\inf_{z \\geq 0, \\; u_{2} \\geq 0, \\; u_{3} \\geq 0} \\left( \\Gamma z + u_{2} + u_{3} \\right) \\quad \\text{subject to} \\quad z + u_{2} \\geq w_{2}, \\; z + u_{3} \\geq w_{3}.\n$$\nApplying this to each inequality:\n\n- For $f_{12} \\leq F_{12}$, the uncertain term is $w_{2} s_{2} + w_{3} s_{3}$ with $w_{2} = \\hat{d}_{2}$, $w_{3} = \\hat{d}_{3}$. The robust counterpart introduces auxiliary variables $z_{12} \\geq 0$, $u_{12,2} \\geq 0$, $u_{12,3} \\geq 0$ and enforces\n$$\nd_{2}^{0} + d_{3}^{0} - g_{2} + \\Gamma z_{12} + u_{12,2} + u_{12,3} \\leq F_{12},\n$$\n$$\nz_{12} + u_{12,2} \\geq \\hat{d}_{2}, \\quad z_{12} + u_{12,3} \\geq \\hat{d}_{3}.\n$$\n\n- For $-f_{12} \\leq F_{12}$, the uncertain term is $- \\hat{d}_{2} s_{2} - \\hat{d}_{3} s_{3}$, whose supremum over $\\mathcal{S}$ is $0$ because coefficients are nonpositive and $s_{i} \\geq 0$. Thus the robust counterpart is simply\n$$\n- d_{2}^{0} - d_{3}^{0} + g_{2} \\leq F_{12}.\n$$\n\n- For $f_{23} \\leq F_{23}$, the uncertain term is $w_{3} s_{3}$ with $w_{3} = \\hat{d}_{3}$. The robust counterpart introduces $z_{23} \\geq 0$, $u_{23,3} \\geq 0$:\n$$\nd_{3}^{0} + \\Gamma z_{23} + u_{23,3} \\leq F_{23},\n$$\n$$\nz_{23} + u_{23,3} \\geq \\hat{d}_{3}.\n$$\n\n- For $-f_{23} \\leq F_{23}$, the uncertain term is $- \\hat{d}_{3} s_{3}$ with supremum $0$, giving\n$$\n- d_{3}^{0} \\leq F_{23}.\n$$\n\nCollecting, the tractable robust LP is\n$$\n\\min_{g_{1}, g_{2}, z_{12}, u_{12,2}, u_{12,3}, z_{23}, u_{23,3}} \\; 20 g_{1} + 40 g_{2}\n$$\nsubject to\n$$\ng_{1} + g_{2} = d_{2}^{0} + d_{3}^{0},\n$$\n$$\n0 \\leq g_{1} \\leq 120, \\quad 0 \\leq g_{2} \\leq 120,\n$$\n$$\nd_{2}^{0} + d_{3}^{0} - g_{2} + \\Gamma z_{12} + u_{12,2} + u_{12,3} \\leq F_{12}, \\quad z_{12} + u_{12,2} \\geq \\hat{d}_{2}, \\quad z_{12} + u_{12,3} \\geq \\hat{d}_{3}, \\quad z_{12} \\geq 0, \\; u_{12,2} \\geq 0, \\; u_{12,3} \\geq 0,\n$$\n$$\n- d_{2}^{0} - d_{3}^{0} + g_{2} \\leq F_{12},\n$$\n$$\nd_{3}^{0} + \\Gamma z_{23} + u_{23,3} \\leq F_{23}, \\quad z_{23} + u_{23,3} \\geq \\hat{d}_{3}, \\quad z_{23} \\geq 0, \\; u_{23,3} \\geq 0,\n$$\n$$\n- d_{3}^{0} \\leq F_{23}.\n$$\n\nWe now evaluate this LP for the provided data: $d_{2}^{0} = 90$, $d_{3}^{0} = 30$, $\\hat{d}_{2} = 12$, $\\hat{d}_{3} = 10$, $\\Gamma = 1.5$, $F_{12} = 80$, $F_{23} = 40$, $c_{1} = 20$, $c_{2} = 40$, and capacities $0 \\leq g_{1}, g_{2} \\leq 120$.\n\nFirst, observe that the constraint $- d_{2}^{0} - d_{3}^{0} + g_{2} \\leq F_{12}$ is\n$$\n-120 + g_{2} \\leq 80 \\quad \\Rightarrow \\quad g_{2} \\leq 200,\n$$\nwhich is nonbinding given $g_{2} \\leq 120$.\n\nFor the robust upper bound on $f_{12}$, the dual variables $(z_{12}, u_{12,2}, u_{12,3})$ minimize $\\Gamma z_{12} + u_{12,2} + u_{12,3}$ subject to $z_{12} + u_{12,2} \\geq 12$ and $z_{12} + u_{12,3} \\geq 10$, $z_{12}, u_{12,2}, u_{12,3} \\geq 0$. The optimal value of this subproblem equals the support function of $\\mathcal{S}$, which with two weights $12$ and $10$ and $\\Gamma = 1.5$ yields\n$$\n\\sup_{(s_{2}, s_{3}) \\in \\mathcal{S}} (12 s_{2} + 10 s_{3}) = 12 \\cdot 1 + 10 \\cdot 0.5 = 17.\n$$\nTherefore the robust $f_{12}$ upper-bound constraint becomes\n$$\nd_{2}^{0} + d_{3}^{0} - g_{2} + 17 \\leq F_{12} \\quad \\Rightarrow \\quad 120 - g_{2} + 17 \\leq 80 \\quad \\Rightarrow \\quad g_{2} \\geq 57.\n$$\n\nFor the robust upper bound on $f_{23}$, the uncertainty term involves only $s_{3}$, hence\n$$\n\\sup_{(s_{2}, s_{3}) \\in \\mathcal{S}} (10 s_{3}) = 10 \\cdot \\min\\{ \\Gamma, 1 \\} = 10 \\cdot 1 = 10.\n$$\nThus\n$$\nd_{3}^{0} + 10 \\leq F_{23} \\quad \\Rightarrow \\quad 30 + 10 \\leq 40,\n$$\nwhich is satisfied at equality and does not involve $g_{1}, g_{2}$. The lower bounds $- d_{3}^{0} \\leq F_{23}$ and $g_{2} \\leq 200$ are slack.\n\nThe remaining constraints are the nominal balance $g_{1} + g_{2} = 120$ and generator capacities. The objective is to minimize $20 g_{1} + 40 g_{2}$ with $g_{2} \\geq 57$ and $g_{1} = 120 - g_{2}$. Substituting $g_{1}$,\n$$\n\\min_{57 \\leq g_{2} \\leq 120} \\; 20(120 - g_{2}) + 40 g_{2} = 2400 + 20 g_{2}.\n$$\nThis is increasing in $g_{2}$, so the minimizer is at the smallest feasible $g_{2}$:\n$$\ng_{2}^{\\star} = 57, \\quad g_{1}^{\\star} = 120 - 57 = 63.\n$$\nThe optimal robust dispatch cost is\n$$\n20 \\cdot 63 + 40 \\cdot 57 = 1260 + 2280 = 3540.\n$$\nExpressed in dollars per hour, the final cost is $3540/h.",
            "answer": "$$\\boxed{3540}$$"
        }
    ]
}