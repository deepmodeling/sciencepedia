{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于最小启动和停机时间约束，这是火力发电机组的基本物理限制。为了精确建模这些约束，我们的优化框架必须具备一种“记忆”能力，以追踪机组的启停事件。通过这项实践 ，你将学习如何从第一性原理出发，将这种运行逻辑转化为精确的数学约束，评估一个给定的运行计划，并理解如何修正违规行为，从而深入掌握如何在模型中强制实现状态的持续性。",
            "id": "4104056",
            "problem": "考虑一个能源系统模型中的单台火电机组，其规划周期为 $T=5$ 个离散时段。该机组的物理最小连续运行时间为 $T^{up}=2$，最小连续停机时间为 $T^{down}=2$，这源于热惯性和运行安全约束。令二元启停变量 $u_t \\in \\{0,1\\}$ 表示机组在时段 $t$ 的启停状态，其中 $u_t=1$ 表示机组处于运行状态。设 $u_0=0$ 为规划周期开始前的初始状态，并假设在 $t=1$ 之前，机组已停机至少 $T^{down}$ 个时段，因此在 $t=1$ 时启动是物理上允许的。一个候选的启停序列由下式给出\n$$\nu_1=1,\\quad u_2=0,\\quad u_3=1,\\quad u_4=1,\\quad u_5=0,\n$$\n该序列可能由一个基准混合整数线性规划（MILP）模型生成，该模型仅强制启动和关停事件与启停状态的变化一致，但尚未施加显式的最小运行/停机时间约束。\n\n从最小运行/停机时间的物理定义以及启停状态与启动/关停事件之间的逻辑关系出发，执行以下任务：\n1. 构建适当的附加线性约束来强制执行 $T^{up}$ 和 $T^{down}$，确保在规划周期的开始和结束时具有科学真实性。仅使用给定的物理定义和标准逻辑关系；不要假设任何预先指定的公式。\n2. 使用这些约束，测试给定序列的可行性，并识别出在 $t=1,\\dots,5$ 范围内所有违反物理要求的地方。\n3. 确定要获得一个满足所构建约束并遵守所述初始条件的序列，需要对给定序列 $\\{u_t\\}_{t=1}^{5}$ 的元素进行的最少逐时段更改次数。最小性是根据与给定序列的汉明距离（即必须翻转状态的时段数量）来衡量的。将最终答案表示为一个不带单位的整数。\n\n最终答案无需四舍五入。",
            "solution": "该问题陈述经评估有效。它在科学上基于能源系统工程的原理，特别是机组组合建模。该问题提法恰当，提供了所有必要的数据和条件，并以客观、正式的语言表述。因此，我们可以着手求解。\n\n该问题分为三个任务。我们将按顺序解决它们。\n\n### 1. 最小运行/停机时间约束的构建\n\n火电机组在时间 $t$ 的状态由二元启停变量 $u_t \\in \\{0, 1\\}$ 给出，其中 $u_t=1$ 表示机组在线， $u_t=0$ 表示机组离线。规划周期为 $T=5$ 个时段，索引为 $t=1, \\dots, 5$。初始状态为 $u_0=0$。\n\n为了强制执行最小运行时间和停机时间约束，我们必须首先定义启动和关停事件。令 $v_t \\in \\{0, 1\\}$ 为启动变量，其中 $v_t=1$ 表示机组在时段 $t$ 开始时启动。令 $w_t \\in \\{0, 1\\}$ 为关停变量，其中 $w_t=1$ 表示机组在时段 $t$ 开始时关停。这些事件由启停状态从一个时段到下一个时段的变化决定。\n\n在 $t$ 时刻发生启动的充要条件是机组在 $t-1$ 时刻是关闭的，在 $t$ 时刻是开启的。\n在 $t$ 时刻发生关停的充要条件是机组在 $t-1$ 时刻是开启的，在 $t$ 时刻是关闭的。\n\n这个逻辑可以用以下关系式来表示：\n$$\nu_t - u_{t-1} = v_t - w_t, \\quad \\forall t \\in \\{1, \\dots, T\\}\n$$\n结合变量的二元性质以及机组不能同时启动和停止的事实（$v_t + w_t \\le 1$），这个单一方程定义了这些事件。对于混合整数线性规划（MILP）模型，我们会将其松弛为一组线性不等式：\n$$\nv_t \\ge u_t - u_{t-1} \\\\\nw_t \\ge u_{t-1} - u_t \\\\\nv_t, w_t \\in \\{0, 1\\}\n$$\n对于我们的分析，我们可以直接从给定的 $u_t$ 序列中确定 $v_t$ 和 $w_t$：$v_t = \\max(0, u_t - u_{t-1})$ 和 $w_t = \\max(0, u_{t-1} - u_t)$。\n\n**最小运行时间约束 ($T^{up}$):**\n物理要求是，如果一个机组在时间 $t$ 启动（即 $v_t=1$），它必须连续在线至少 $T^{up}$ 个时段。这意味着启停状态 $u$ 在时段 $t, t+1, \\dots, t+T^{up}-1$ 内必须为 $1$。这可以表述为一组线性约束。对于每个可能的启动时间 $t$，我们必须确保：\n$$\nu_{t+k} = 1 \\quad \\text{如果} \\quad v_t = 1, \\quad \\text{对于 } k=0, 1, \\dots, T^{up}-1\n$$\n一个强制执行此条件的线性不等式是：\n$$\nu_{t+k} \\ge v_t\n$$\n此不等式必须对所有 $t \\in \\{1, \\dots, T\\}$ 和所有 $k \\in \\{0, \\dots, T^{up}-1\\}$ 成立，前提是时间索引 $t+k$ 不超过规划周期 $T$。当 $T=5$ 和 $T^{up}=2$ 时，具体的约束是：\n对于 $t=1$：$u_1 \\ge v_1, u_2 \\ge v_1$\n对于 $t=2$：$u_2 \\ge v_2, u_3 \\ge v_2$\n对于 $t=3$：$u_3 \\ge v_3, u_4 \\ge v_3$\n对于 $t=4$：$u_4 \\ge v_4, u_5 \\ge v_4$\n对于 $t=5$：$u_5 \\ge v_5$ (因为 $5+1 > T=5$)\n\n**最小停机时间约束 ($T^{down}$):**\n类似地，如果一个机组在时间 $t$ 关停（即 $w_t=1$），它必须连续离线至少 $T^{down}$ 个时段。这意味着 $u$ 在时段 $t, t+1, \\dots, t+T^{down}-1$ 内必须为 $0$。这可以表述为：\n$$\nu_{t+k} = 0 \\quad \\text{如果} \\quad w_t = 1, \\quad \\text{对于 } k=0, 1, \\dots, T^{down}-1\n$$\n一个相应的线性不等式是：\n$$\nu_{t+k} \\le 1 - w_t\n$$\n此不等式必须对所有 $t \\in \\{1, \\dots, T\\}$ 和所有 $k \\in \\{0, \\dots, T^{down}-1\\}$ 成立，前提是 $t+k \\le T$。当 $T=5$ 和 $T^{down}=2$ 时，具体的约束是：\n对于 $t=1$：$u_1 \\le 1-w_1, u_2 \\le 1-w_1$\n对于 $t=2$：$u_2 \\le 1-w_2, u_3 \\le 1-w_2$\n对于 $t=3$：$u_3 \\le 1-w_3, u_4 \\le 1-w_3$\n对于 $t=4$：$u_4 \\le 1-w_4, u_5 \\le 1-w_4$\n对于 $t=5$：$u_5 \\le 1-w_5$ (因为 $5+1 > T=5$)\n\n机组在 $t=1$ 之前已停机至少 $T^{down}=2$ 个时段的初始条件确保了在 $t=1$ 时启动是允许的，并且不会违反任何历史停机时间约束。\n\n### 2. 给定序列的可行性测试\n\n候选序列为 $u_1=1, u_2=0, u_3=1, u_4=1, u_5=0$。初始条件为 $u_0=0$。首先，我们计算启动（$v_t$）和关停（$w_t$）序列：\n- $t=1$：$u_1=1, u_0=0 \\implies v_1=1, w_1=0$ (启动)\n- $t=2$：$u_2=0, u_1=1 \\implies v_2=0, w_2=1$ (关停)\n- $t=3$：$u_3=1, u_2=0 \\implies v_3=1, w_3=0$ (启动)\n- $t=4$：$u_4=1, u_3=1 \\implies v_4=0, w_4=0$ (无变化)\n- $t=5$：$u_5=0, u_4=1 \\implies v_5=0, w_5=1$ (关停)\n\n现在我们根据第一部分推导出的约束来测试这个序列。我们只需要检查发生启动或关停的时段的约束。\n\n**最小运行时间违规 ($T^{up}=2$):**\n- 在 $t=1$ 发生启动（$v_1=1$）。这触发了约束 $u_2 \\ge v_1$。代入数值：$0 \\ge 1$。这是错误的。**违规**：机组在 $t=1$ 启动，但在 $t=2$ 关停，导致运行时间仅为 $1$ 个时段，小于所要求的 $T^{up}=2$。\n- 在 $t=3$ 发生启动（$v_3=1$）。这触发了约束 $u_4 \\ge v_3$。代入数值：$1 \\ge 1$。这是正确的。此事件没有违规。\n\n**最小停机时间违规 ($T^{down}=2$):**\n- 在 $t=2$ 发生关停（$w_2=1$）。这触发了约束 $u_3 \\le 1-w_2$。代入数值：$u_3 \\le 1-1 \\implies 1 \\le 0$。这是错误的。**违规**：机组在 $t=2$ 关停，但在 $t=3$ 再次启动，导致停机时间仅为 $1$ 个时段，小于所要求的 $T^{down}=2$。\n- 在 $t=5$ 发生关停（$w_5=1$）。这触发了约束 $u_5 \\le 1-w_5$。代入数值：$0 \\le 1-1 \\implies 0 \\le 0$。这是正确的。完整的停机时段超出了规划周期，但在 $T=5$ 个时段内未观察到违规。\n\n给定序列在指定的规划周期内有两处违反物理约束：一处是 $t=1$ 启动后的最小运行时间违规，另一处是 $t=2$ 关停后的最小停机时间违规。\n\n### 3. 最小更改次数\n\n我们需要找到一个新的序列 $\\{u'_t\\}_{t=1}^5$ ，它满足所有约束，并最小化与原始序列的汉明距离 $d = \\sum_{t=1}^5 |u'_t - u_t|$。原始序列是 $u = (1, 0, 1, 1, 0)$。\n\n距离 $d=0$ 对应于原始序列，我们已知它是无效的。我们从 $d=1$ 开始，寻找一个具有最少更改次数的有效序列。这涉及到翻转序列中的单个条目。\n\n让我们检查这两个违规情况。\n- $t=1$ 的运行时间违规要求 $u_2=1$。\n- $t=2$ 的停机时间违规要求 $u_3=0$。\n如果我们只改变一个变量，这两个修正是互斥的。让我们通过一次翻转一个比特来探讨各种选项。\n\n**情况1：将 $u_1$ 从 $1$ 翻转为 $0$。**\n- 新序列：$u'=(0, 0, 1, 1, 0)$。距离 $d=1$。\n- 事件：\n  - $t=1,2$：机组关闭。\n  - $t=3$：启动 ($v'_3=1$)。要求 $u'_3=1, u'_4=1$（因为 $T^{up}=2$）。该序列满足此条件。这是有效的。\n  - $t=5$：关停 ($w'_5=1$)。要求 $u'_5=0$。该序列满足此条件。这是有效的。\n- 机组在 $t=1, 2$ 关闭，停机时间为 $2$ 个时段。这满足 $T^{down}=2$。\n- 机组在 $t=3, 4$ 运行，运行时间为 $2$ 个时段。这满足 $T^{up}=2$。\n- 序列 $u'=(0, 0, 1, 1, 0)$ 是有效的。\n\n**情况2：将 $u_2$ 从 $0$ 翻转为 $1$。**\n- 新序列：$u''=(1, 1, 1, 1, 0)$。距离 $d=1$。\n- 事件：\n  - $t=1$：启动 ($v''_1=1$)。要求 $u''_1=1, u''_2=1$。该序列满足此条件。这是有效的。\n  - $t=2,3,4$：机组运行。\n  - $t=5$：关停 ($w''_5=1$)。要求 $u''_5=0$。该序列满足此条件。这是有效的。\n- 机组在 $t=1, 2, 3, 4$ 运行，运行时间为 $4$ 个时段。这满足 $T^{up}=2$。\n- 序列 $u''=(1, 1, 1, 1, 0)$ 是有效的。\n\n由于我们通过只改变一个条目（距离为 $1$）就找到了至少一个有效序列，并且我们知道距离为 $0$ 是不可能的，因此所需的最少逐时段更改次数是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在确定了发电机有效的启停计划后，下一步是模拟其在运行期间功率输出变化的物理限制。本练习  专注于爬坡约束，这是电力系统中另一个关键的时间维度限制。通过计算最大可行的功率输出轨迹，你将练习应用连接连续时间段决策的动态约束，这是解决序列优化问题的核心技能。",
            "id": "4104113",
            "problem": "考虑一个能源系统中的单一热力发电机组，该系统建模为 $T=4$ 个离散时期，索引为 $t \\in \\{1,2,3,4\\}$。设 $P_t$ 表示在时期 $t$ 的发电功率，单位为兆瓦 (MW)。该发电机组受到物理运行限制和逻辑启停决策的约束，这些约束通常在用于机组组合问题的混合整数线性规划 (MILP) 中表示。适用以下经过充分检验的运行约束：\n\n- 带启停逻辑的容量限制：对于每个 $t$，有 $P_{\\min} \\, u_t \\leq P_t \\leq P_{\\max} \\, u_t$，其中 $u_t \\in \\{0,1\\}$ 是启停决策变量，$P_{\\min}$ 是机组开启时的最小稳定发电量，$P_{\\max}$ 是最大发电容量。\n- 跨时期爬坡限制：对于每个 $t \\geq 1$，有 $P_t - P_{t-1} \\leq R^{+}$ (向上爬坡限制) 和 $P_{t-1} - P_t \\leq R^{-}$ (向下爬坡限制)，其中 $R^{+}$ 和 $R^{-}$ 分别是每个时期 $P_t$ 允许的最大增加量和减少量。\n- 启动逻辑由 $y_t \\geq u_t - u_{t-1}$ 给出，其中 $y_t \\in \\{0,1\\}$ 是启动指示变量；当在时期 $t$ 发生启动时，假设发电机组从 $u_{t-1}=0$ 转换到 $u_t=1$。对于本问题，直接给定了在 $t=1$ 时启动，并且可以假设对于所有 $t \\in \\{1,2,3,4\\}$ 都有 $u_t=1$，以及对于 $t \\in \\{2,3,4\\}$ 有 $y_1=1$ 和 $y_t=0$。\n\n发电机组的参数和初始条件如下：\n- $P_{\\min} = 20$，\n- $P_{\\max} = 85$，\n- $R^{+} = 30$，\n- $R^{-} = 40$，\n- $P_0 = 0$，\n- 在 $t=1$ 时启动，如上所述。\n\n使用这些约束和初始条件，确定在最大化总能量产量（这等同于在上述约束条件下最大化 $\\sum_{t=1}^{4} P_t$）的目标下，这四个时期内的最大可行输出轨迹。\n\n将轨迹 $(P_1, P_2, P_3, P_4)$ 报告为行向量，其中每个条目以兆瓦 (MW) 为单位表示。无需四舍五入；请提供精确值。",
            "solution": "问题要求解单一热力发电机组在 $T=4$ 个时期内的最大可行输出轨迹 $(P_1, P_2, P_3, P_4)$。目标是最大化总能量产量，这等同于最大化功率输出之和 $\\sum_{t=1}^{4} P_t$。\n\n发电机组的运行受一组约束的控制。我们首先使用给定的参数将这些约束形式化。\n参数如下：\n- 开启时的最小功率输出，$P_{\\min} = 20$ MW。\n- 最大功率输出，$P_{\\max} = 85$ MW。\n- 向上爬坡限制，$R^{+} = 30$ MW/时期。\n- 向下爬坡限制，$R^{-} = 40$ MW/时期。\n- $t=0$ 时的初始功率输出，$P_0 = 0$ MW。\n\n问题指定发电机组在整个期间都处于开启状态，即对于所有 $t \\in \\{1, 2, 3, 4\\}$，二元决策变量 $u_t = 1$。这简化了一般性约束。\n\n1.  **容量限制**：约束为 $P_{\\min} u_t \\leq P_t \\leq P_{\\max} u_t$。当 $u_t=1$ 时，该约束变为：\n    $$20 \\leq P_t \\leq 85 \\quad \\text{for } t \\in \\{1, 2, 3, 4\\}$$\n\n2.  **爬坡限制**：对于 $t \\in \\{1, 2, 3, 4\\}$ 的跨时期约束是：\n    - 向上爬坡：$P_t - P_{t-1} \\leq R^{+}$，即 $P_t \\leq P_{t-1} + 30$。\n    - 向下爬坡：$P_{t-1} - P_t \\leq R^{-}$，即 $P_t \\geq P_{t-1} - 40$。\n\n结合这些约束，对于每个时期 $t$，功率输出 $P_t$ 必须满足：\n$$ \\max(20, P_{t-1} - 40) \\leq P_t \\leq \\min(85, P_{t-1} + 30) $$\n\n启动逻辑约束 ($y_t \\geq u_t - u_{t-1}$) 已给定满足条件，即 $y_1=1$ 且对于 $t \\geq 2$ 有 $y_t=0$，这与从 $P_0=0$ 推断出的 $u_0=0$ 以及对于 $t \\geq 1$ 的 $u_t=1$ 相一致。\n\n目标是最大化非负变量之和 $\\sum_{t=1}^{4} P_t$。对 $P_t$ 的约束仅取决于 $P_{t-1}$ 的值。具体来说，$P_t$ 的上界是 $P_{t-1}$ 的增函数（或常数）。为了最大化总和，我们可以采用贪心策略：在每个时间步 $t$，我们为 $P_t$ 选择满足所有约束的最大可能值。这个选择最大化了下一时期 $P_{t+1}$ 的潜在上界，从而确保我们正在构建逐元素最大的可行轨迹。对于任何可行轨迹 $(P'_1, P'_2, P'_3, P'_4)$，这种贪心方法构造的轨迹 $(P_1, P_2, P_3, P_4)$ 满足对于所有 $t$ 都有 $P'_t \\leq P_t$，因此保证了 $\\sum P'_t \\leq \\sum P_t$。\n\n我们按顺序计算每个时期 $P_t$ 的最大可行值。\n\n**时期 $t=1$:**\n功率输出 $P_1$ 受初始条件 $P_0 = 0$ 的约束。\n-   容量限制：$20 \\leq P_1 \\leq 85$。\n-   向上爬坡限制：$P_1 \\leq P_0 + 30 = 0 + 30 = 30$。\n-   向下爬坡限制：$P_1 \\geq P_0 - 40 = 0 - 40 = -40$。\n$P_1$ 的组合约束为 $\\max(20, -40) \\leq P_1 \\leq \\min(85, 30)$，化简为 $20 \\leq P_1 \\leq 30$。\n为了最大化轨迹，我们为 $P_1$ 选择最大可能值。\n$$P_1 = 30$$\n\n**时期 $t=2$:**\n功率输出 $P_2$ 受 $P_1 = 30$ 的约束。\n-   容量限制：$20 \\leq P_2 \\leq 85$。\n-   向上爬坡限制：$P_2 \\leq P_1 + 30 = 30 + 30 = 60$。\n-   向下爬坡限制：$P_2 \\geq P_1 - 40 = 30 - 40 = -10$。\n$P_2$ 的组合约束为 $\\max(20, -10) \\leq P_2 \\leq \\min(85, 60)$，化简为 $20 \\leq P_2 \\leq 60$。\n为了最大化轨迹，我们为 $P_2$ 选择最大可能值。\n$$P_2 = 60$$\n\n**时期 $t=3$:**\n功率输出 $P_3$ 受 $P_2 = 60$ 的约束。\n-   容量限制：$20 \\leq P_3 \\leq 85$。\n-   向上爬坡限制：$P_3 \\leq P_2 + 30 = 60 + 30 = 90$。\n-   向下爬坡限制：$P_3 \\geq P_2 - 40 = 60 - 40 = 20$。\n$P_3$ 的组合约束为 $\\max(20, 20) \\leq P_3 \\leq \\min(85, 90)$，化简为 $20 \\leq P_3 \\leq 85$。\n为了最大化轨迹，我们为 $P_3$ 选择最大可能值。\n$$P_3 = 85$$\n\n**时期 $t=4$:**\n功率输出 $P_4$ 受 $P_3 = 85$ 的约束。\n-   容量限制：$20 \\leq P_4 \\leq 85$。\n-   向上爬坡限制：$P_4 \\leq P_3 + 30 = 85 + 30 = 115$。\n-   向下爬坡限制：$P_4 \\geq P_3 - 40 = 85 - 40 = 45$。\n$P_4$ 的组合约束为 $\\max(20, 45) \\leq P_4 \\leq \\min(85, 115)$，化简为 $45 \\leq P_4 \\leq 85$。\n为了最大化轨迹，我们为 $P_4$ 选择最大可能值。\n$$P_4 = 85$$\n\n最大化总能量产量的结果轨迹是 $(P_1, P_2, P_3, P_4) = (30, 60, 85, 85)$。所有值的单位均为 MW。\n最终答案是表示为行向量的该轨迹。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30  60  85  85\n\\end{pmatrix}\n}\n$$"
        }
    ]
}