{
    "hands_on_practices": [
        {
            "introduction": "To begin our practical exploration, we first address the physical dynamics of conventional power plants. The operational flexibility of a thermal generator is not infinite; its power output cannot change instantaneously. This exercise focuses on modeling inter-temporal ramping constraints, denoted by $R^+$ and $R^-$, which define the maximum rate of change in generation. By calculating the maximum power trajectory for a generator just starting up, you will gain hands-on experience with how these fundamental time-linking constraints propagate and shape the feasible operating envelope of a unit .",
            "id": "4104113",
            "problem": "Consider a single thermal generator in an energy system modeled over $T=4$ discrete periods, indexed by $t \\in \\{1,2,3,4\\}$. Let $P_t$ denote the electrical power output in megawatts (MW) at period $t$. The generator is subject to physical operating limits and logical on/off decisions as typically represented in Mixed-Integer Linear Programming (MILP) for unit commitment. The following well-tested operating constraints apply:\n\n- Capacity limits with commitment logic: for each $t$, $P_{\\min} \\, u_t \\leq P_t \\leq P_{\\max} \\, u_t$, where $u_t \\in \\{0,1\\}$ is the on/off commitment decision, $P_{\\min}$ is the minimum stable generation when on, and $P_{\\max}$ is the maximum generation capacity.\n- Inter-temporal ramping limits: for each $t \\geq 1$, $P_t - P_{t-1} \\leq R^{+}$ (ramp-up limit) and $P_{t-1} - P_t \\leq R^{-}$ (ramp-down limit), where $R^{+}$ and $R^{-}$ are the maximum allowable increases and decreases in $P_t$ per period, respectively.\n- Startup logic is given by $y_t \\geq u_t - u_{t-1}$ with $y_t \\in \\{0,1\\}$ as the startup indicator; when a startup occurs at period $t$, it is assumed the generator transitions from $u_{t-1}=0$ to $u_t=1$. For this problem, you are given the startup at $t=1$ directly and may assume $u_t=1$ for all $t \\in \\{1,2,3,4\\}$ and $y_1=1$, $y_t=0$ for $t \\in \\{2,3,4\\}$.\n\nThe generator parameters and initial condition are:\n- $P_{\\min} = 20$,\n- $P_{\\max} = 85$,\n- $R^{+} = 30$,\n- $R^{-} = 40$,\n- $P_0 = 0$,\n- startup at $t=1$ as specified.\n\nUsing these constraints and initial condition, determine the maximum feasible output trajectory over the four periods under the objective of maximizing the total energy production, which is equivalent to maximizing $\\sum_{t=1}^{4} P_t$ subject to the constraints above.\n\nReport the trajectory $(P_1, P_2, P_3, P_4)$ as a row vector with each entry expressed in megawatts (MW). No rounding is necessary; provide exact values.",
            "solution": "The problem asks for the maximum feasible output trajectory $(P_1, P_2, P_3, P_4)$ for a single thermal generator over $T=4$ periods. The objective is to maximize the total energy production, which is equivalent to maximizing the sum of power outputs $\\sum_{t=1}^{4} P_t$.\n\nThe generator's operation is governed by a set of constraints. Let us first formalize these constraints using the provided parameters.\nThe parameters are:\n- Minimum power output when on, $P_{\\min} = 20$ MW.\n- Maximum power output, $P_{\\max} = 85$ MW.\n- Ramp-up limit, $R^{+} = 30$ MW/period.\n- Ramp-down limit, $R^{-} = 40$ MW/period.\n- Initial power output at $t=0$, $P_0 = 0$ MW.\n\nThe problem specifies that the generator is committed to be on for the entire duration, i.e., the binary commitment variable $u_t = 1$ for all $t \\in \\{1, 2, 3, 4\\}$. This simplifies the general constraints.\n\n1.  **Capacity Limits**: The constraint is $P_{\\min} u_t \\leq P_t \\leq P_{\\max} u_t$. With $u_t=1$, this becomes:\n    $$20 \\leq P_t \\leq 85 \\quad \\text{for } t \\in \\{1, 2, 3, 4\\}$$\n\n2.  **Ramping Limits**: The inter-temporal constraints for $t \\in \\{1, 2, 3, 4\\}$ are:\n    - Ramp-up: $P_t - P_{t-1} \\leq R^{+}$, which is $P_t \\leq P_{t-1} + 30$.\n    - Ramp-down: $P_{t-1} - P_t \\leq R^{-}$, which is $P_t \\geq P_{t-1} - 40$.\n\nCombining these constraints, for each period $t$, the power output $P_t$ must satisfy:\n$$ \\max(20, P_{t-1} - 40) \\leq P_t \\leq \\min(85, P_{t-1} + 30) $$\n\nThe startup logic constraints ($y_t \\geq u_t - u_{t-1}$) are given to be satisfied with $y_1=1$ and $y_t=0$ for $t \\geq 2$, consistent with $u_0=0$ (inferred from $P_0=0$) and $u_t=1$ for $t \\geq 1$.\n\nThe objective is to maximize a sum of non-negative variables, $\\sum_{t=1}^{4} P_t$. The constraints on $P_t$ depend only on the value of $P_{t-1}$. Specifically, the upper bound for $P_t$ is an increasing function of $P_{t-1}$ (or constant). To maximize the sum, we can employ a greedy strategy: at each time step $t$, we choose the largest possible value for $P_t$ that satisfies all constraints. This choice maximizes the potential upper bound for the subsequent period $P_{t+1}$, and thus ensures that we are constructing the element-wise largest possible feasible trajectory. For any feasible trajectory $(P'_1, P'_2, P'_3, P'_4)$, this greedy approach constructs a trajectory $(P_1, P_2, P_3, P_4)$ such that $P'_t \\leq P_t$ for all $t$, thus guaranteeing that $\\sum P'_t \\leq \\sum P_t$.\n\nWe proceed by calculating the maximum feasible value for $P_t$ for each period sequentially.\n\n**Period $t=1$:**\nThe power output $P_1$ is constrained by the initial condition $P_0 = 0$.\n-   Capacity limit: $20 \\leq P_1 \\leq 85$.\n-   Ramp-up limit: $P_1 \\leq P_0 + 30 = 0 + 30 = 30$.\n-   Ramp-down limit: $P_1 \\geq P_0 - 40 = 0 - 40 = -40$.\nThe combined constraints for $P_1$ are $\\max(20, -40) \\leq P_1 \\leq \\min(85, 30)$, which simplifies to $20 \\leq P_1 \\leq 30$.\nTo maximize the trajectory, we choose the maximum possible value for $P_1$.\n$$P_1 = 30$$\n\n**Period $t=2$:**\nThe power output $P_2$ is constrained by $P_1 = 30$.\n-   Capacity limit: $20 \\leq P_2 \\leq 85$.\n-   Ramp-up limit: $P_2 \\leq P_1 + 30 = 30 + 30 = 60$.\n-   Ramp-down limit: $P_2 \\geq P_1 - 40 = 30 - 40 = -10$.\nThe combined constraints for $P_2$ are $\\max(20, -10) \\leq P_2 \\leq \\min(85, 60)$, which simplifies to $20 \\leq P_2 \\leq 60$.\nTo maximize the trajectory, we choose the maximum possible value for $P_2$.\n$$P_2 = 60$$\n\n**Period $t=3$:**\nThe power output $P_3$ is constrained by $P_2 = 60$.\n-   Capacity limit: $20 \\leq P_3 \\leq 85$.\n-   Ramp-up limit: $P_3 \\leq P_2 + 30 = 60 + 30 = 90$.\n-   Ramp-down limit: $P_3 \\geq P_2 - 40 = 60 - 40 = 20$.\nThe combined constraints for $P_3$ are $\\max(20, 20) \\leq P_3 \\leq \\min(85, 90)$, which simplifies to $20 \\leq P_3 \\leq 85$.\nTo maximize the trajectory, we choose the maximum possible value for $P_3$.\n$$P_3 = 85$$\n\n**Period $t=4$:**\nThe power output $P_4$ is constrained by $P_3 = 85$.\n-   Capacity limit: $20 \\leq P_4 \\leq 85$.\n-   Ramp-up limit: $P_4 \\leq P_3 + 30 = 85 + 30 = 115$.\n-   Ramp-down limit: $P_4 \\geq P_3 - 40 = 85 - 40 = 45$.\nThe combined constraints for $P_4$ are $\\max(20, 45) \\leq P_4 \\leq \\min(85, 115)$, which simplifies to $45 \\leq P_4 \\leq 85$.\nTo maximize the trajectory, we choose the maximum possible value for $P_4$.\n$$P_4 = 85$$\n\nThe resulting trajectory that maximizes the total energy production is $(P_1, P_2, P_3, P_4) = (30, 60, 85, 85)$. All values are in MW.\nThe final answer is this trajectory represented as a row vector.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30 & 60 & 85 & 85\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from continuous dynamics to discrete logic, we now tackle constraints that govern the on/off status of a generator over time. For reasons of thermal stress and mechanical integrity, units require a minimum up-time ($T^{up}$) after starting and a minimum down-time ($T^{down}$) after shutting down. This practice challenges you to translate these operational rules into the language of mathematics, constructing the linear inequalities that enforce this logic using binary variables. By analyzing and correcting a given commitment schedule, you will develop a concrete understanding of how these critical logical constraints are implemented in unit commitment models .",
            "id": "4104056",
            "problem": "Consider a single thermal generating unit in an energy systems model over a planning horizon of $T=5$ discrete periods. The unit has a physical minimum up time $T^{up}=2$ and a minimum down time $T^{down}=2$, stemming from thermal inertia and operational safety constraints. Let the binary commitment variable $u_t \\in \\{0,1\\}$ denote the on/off status of the unit at period $t$, with $u_t=1$ meaning the unit is on. Let $u_0=0$ be the initial status before the horizon and suppose the unit has been off for at least $T^{down}$ periods prior to $t=1$, so a start-up at $t=1$ is physically permissible. A candidate commitment sequence is given by\n$$\nu_1=1,\\quad u_2=0,\\quad u_3=1,\\quad u_4=1,\\quad u_5=0,\n$$\nwhich may have been produced by a baseline Mixed-Integer Linear Programming (MILP) model that enforces only that start-up and shut-down events coincide with changes in commitment but does not yet impose explicit minimum up/down time constraints.\n\nStarting from the physical definitions of minimum up/down times and the logical relationship between commitment and start-up/shut-down events, perform the following tasks:\n1. Construct the appropriate additional linear constraints that enforce $T^{up}$ and $T^{down}$, ensuring scientific realism at the start and end of the horizon. Use only the given physical definitions and standard logical relationships; do not assume any pre-specified formula.\n2. Using those constraints, test the feasibility of the given sequence and identify all violations within the horizon where the physical requirement must be met inside $t=1,\\dots,5$.\n3. Determine the minimal number of period-by-period changes to the entries of the given sequence $\\{u_t\\}_{t=1}^{5}$ required to obtain a sequence that satisfies the constructed constraints while respecting the stated initial condition. The minimality is in terms of the Hamming distance to the given sequence (the count of periods whose status must be flipped). Express your final answer as a single integer with no units.\n\nNo rounding is necessary for the final answer.",
            "solution": "The solution is addressed in three sequential tasks as requested by the problem statement.\n\n### 1. Construction of Minimum Up/Down Time Constraints\n\nThe state of the thermal unit at time $t$ is given by the binary commitment variable $u_t \\in \\{0, 1\\}$, where $u_t=1$ if the unit is online and $u_t=0$ if it is offline. The planning horizon is $T=5$ periods, indexed $t=1, \\dots, 5$. The initial state is $u_0=0$.\n\nTo enforce minimum up-time and down-time constraints, we must first define the events of starting up and shutting down. Let $v_t \\in \\{0, 1\\}$ be the start-up variable, where $v_t=1$ indicates that the unit starts up at the beginning of period $t$. Let $w_t \\in \\{0, 1\\}$ be the shut-down variable, where $w_t=1$ indicates the unit shuts down at the beginning of period $t$. These events are determined by the change in commitment status from one period to the next.\n\nA start-up at $t$ occurs if and only if the unit was off at $t-1$ and is on at $t$.\nA shut-down at $t$ occurs if and only if the unit was on at $t-1$ and is off at $t$.\n\nThis logic is captured by the relationship:\n$$\nu_t - u_{t-1} = v_t - w_t, \\quad \\forall t \\in \\{1, \\dots, T\\}\n$$\nAlong with the binary nature of the variables and the fact that a unit cannot simultaneously start and stop ($v_t + w_t \\le 1$), this single equation defines the events. For a Mixed-Integer Linear Programming (MILP) model, we would relax this into a set of linear inequalities:\n$$\nv_t \\ge u_t - u_{t-1} \\\\\nw_t \\ge u_{t-1} - u_t \\\\\nv_t, w_t \\in \\{0, 1\\}\n$$\nFor our analysis, we can determine $v_t$ and $w_t$ directly from the given $u_t$ sequence: $v_t = \\max(0, u_t - u_{t-1})$ and $w_t = \\max(0, u_{t-1} - u_t)$.\n\n**Minimum Up-Time Constraint ($T^{up}$):**\nThe physical requirement is that if a unit starts up at time $t$ (i.e., $v_t=1$), it must remain online for at least $T^{up}$ consecutive periods. This means the commitment status $u$ must be $1$ for periods $t, t+1, \\dots, t+T^{up}-1$. This can be formulated as a set of linear constraints. For each potential start-up time $t$, we must ensure:\n$$\nu_{t+k} = 1 \\quad \\text{if} \\quad v_t = 1, \\quad \\text{for } k=0, 1, \\dots, T^{up}-1\n$$\nA linear inequality that enforces this is:\n$$\nu_{t+k} \\ge v_t\n$$\nThis must hold for all $t \\in \\{1, \\dots, T\\}$ and for all $k \\in \\{0, \\dots, T^{up}-1\\}$, provided the time index $t+k$ does not exceed the horizon $T$. With $T=5$ and $T^{up}=2$, the specific constraints are:\nFor $t=1$: $u_1 \\ge v_1, u_2 \\ge v_1$\nFor $t=2$: $u_2 \\ge v_2, u_3 \\ge v_2$\nFor $t=3$: $u_3 \\ge v_3, u_4 \\ge v_3$\nFor $t=4$: $u_4 \\ge v_4, u_5 \\ge v_4$\nFor $t=5$: $u_5 \\ge v_5$ (as $5+1 > T=5$)\n\n**Minimum Down-Time Constraint ($T^{down}$):**\nSimilarly, if a unit shuts down at time $t$ (i.e., $w_t=1$), it must remain offline for at least $T^{down}$ consecutive periods. This means $u$ must be $0$ for periods $t, t+1, \\dots, t+T^{down}-1$. This can be stated as:\n$$\nu_{t+k} = 0 \\quad \\text{if} \\quad w_t = 1, \\quad \\text{for } k=0, 1, \\dots, T^{down}-1\n$$\nA corresponding linear inequality is:\n$$\nu_{t+k} \\le 1 - w_t\n$$\nThis must hold for all $t \\in \\{1, \\dots, T\\}$ and for all $k \\in \\{0, \\dots, T^{down}-1\\}$, provided $t+k \\le T$. With $T=5$ and $T^{down}=2$, the specific constraints are:\nFor $t=1$: $u_1 \\le 1-w_1, u_2 \\le 1-w_1$\nFor $t=2$: $u_2 \\le 1-w_2, u_3 \\le 1-w_2$\nFor $t=3$: $u_3 \\le 1-w_3, u_4 \\le 1-w_3$\nFor $t=4$: $u_4 \\le 1-w_4, u_5 \\le 1-w_4$\nFor $t=5$: $u_5 \\le 1-w_5$ (as $5+1 > T=5$)\n\nThe initial condition that the unit has been off for at least $T^{down}=2$ periods prior to $t=1$ ensures that a start-up at $t=1$ is permissible and does not violate any historical down-time constraint.\n\n### 2. Feasibility Test of the Given Sequence\n\nThe candidate sequence is $u_1=1, u_2=0, u_3=1, u_4=1, u_5=0$. The initial condition is $u_0=0$. First, we compute the start-up ($v_t$) and shut-down ($w_t$) sequences:\n- $t=1$: $u_1=1, u_0=0 \\implies v_1=1, w_1=0$ (Start-up)\n- $t=2$: $u_2=0, u_1=1 \\implies v_2=0, w_2=1$ (Shut-down)\n- $t=3$: $u_3=1, u_2=0 \\implies v_3=1, w_3=0$ (Start-up)\n- $t=4$: $u_4=1, u_3=1 \\implies v_4=0, w_4=0$ (No change)\n- $t=5$: $u_5=0, u_4=1 \\implies v_5=0, w_5=1$ (Shut-down)\n\nNow we test this sequence against the constraints derived in Part 1. We only need to check the constraints for the periods where a start-up or shut-down occurs.\n\n**Minimum Up-Time Violations ($T^{up}=2$):**\n- A start-up occurs at $t=1$ ($v_1=1$). This triggers the constraint $u_2 \\ge v_1$. Substituting the values: $0 \\ge 1$. This is false. **Violation**: The unit starts at $t=1$ but is shut down at $t=2$, resulting in an up-time of only $1$ period, which is less than the required $T^{up}=2$.\n- A start-up occurs at $t=3$ ($v_3=1$). This triggers the constraint $u_4 \\ge v_3$. Substituting the values: $1 \\ge 1$. This is true. No violation for this event.\n\n**Minimum Down-Time Violations ($T^{down}=2$):**\n- A shut-down occurs at $t=2$ ($w_2=1$). This triggers the constraint $u_3 \\le 1-w_2$. Substituting the values: $u_3 \\le 1-1 \\implies 1 \\le 0$. This is false. **Violation**: The unit shuts down at $t=2$ but is started up again at $t=3$, resulting in a down-time of only $1$ period, which is less than the required $T^{down}=2$.\n- A shut-down occurs at $t=5$ ($w_5=1$). This triggers the constraint $u_5 \\le 1-w_5$. Substituting the values: $0 \\le 1-1 \\implies 0 \\le 0$. This is true. The full down-time period extends beyond the horizon, but no violation is observed within the $T=5$ periods.\n\nThe given sequence has two violations of the physical constraints within the specified horizon: a minimum up-time violation following the start-up at $t=1$, and a minimum down-time violation following the shut-down at $t=2$.\n\n### 3. Minimal Number of Changes\n\nWe need to find a new sequence $\\{u'_t\\}_{t=1}^5$ that satisfies all constraints and minimizes the Hamming distance to the original sequence, $d = \\sum_{t=1}^5 |u'_t - u_t|$. The original sequence is $u = (1, 0, 1, 1, 0)$.\n\nA distance of $d=0$ corresponds to the original sequence, which we know is invalid. We search for a valid sequence with a minimal number of changes, starting with $d=1$. This involves flipping a single entry in the sequence.\n\nLet's examine the two violations.\n- The up-time violation at $t=1$ requires $u_2=1$.\n- The down-time violation at $t=2$ requires $u_3=0$.\nThese two fixes are mutually exclusive if we only change one variable. Let's explore the options by flipping one bit at a time.\n\n**Case 1: Flip $u_1$ from $1$ to $0$.**\n- New sequence: $u'=(0, 0, 1, 1, 0)$. Distance $d=1$.\n- Events:\n  - $t=1,2$: Unit is off.\n  - $t=3$: Start-up ($v'_3=1$). Requires $u'_3=1, u'_4=1$ (since $T^{up}=2$). The sequence has this. This is valid.\n  - $t=5$: Shut-down ($w'_5=1$). Requires $u'_5=0$. The sequence has this. This is valid.\n- The unit is off for $t=1, 2$, which is a down-time of $2$ periods. This satisfies $T^{down}=2$.\n- The unit is on for $t=3, 4$, which is an up-time of $2$ periods. This satisfies $T^{up}=2$.\n- The sequence $u'=(0, 0, 1, 1, 0)$ is valid.\n\n**Case 2: Flip $u_2$ from $0$ to $1$.**\n- New sequence: $u''=(1, 1, 1, 1, 0)$. Distance $d=1$.\n- Events:\n  - $t=1$: Start-up ($v''_1=1$). Requires $u''_1=1, u''_2=1$. The sequence has this. This is valid.\n  - $t=2,3,4$: Unit is on.\n  - $t=5$: Shut-down ($w''_5=1$). Requires $u''_5=0$. The sequence has this. This is valid.\n- The unit is on for $t=1, 2, 3, 4$, an up-time of $4$ periods. This satisfies $T^{up}=2$.\n- The sequence $u''=(1, 1, 1, 1, 0)$ is valid.\n\nSince we have found at least one valid sequence by changing only one entry (a distance of $1$), and we know a distance of $0$ is not possible, the minimal number of period-by-period changes required is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "This final practice integrates physical principles and logical constraints into a comprehensive system optimization problem for an energy storage device. Here, you will model a battery's state of charge, accounting for energy losses through charging and discharging efficiencies ($\\eta_c$ and $\\eta_d$). The core MILP challenge is to enforce mutually exclusive operation—a battery cannot charge and discharge simultaneously—using binary decision variables. By determining the minimal required storage capacity ($E^{\\max}$) to meet a delivery target, you will see how MILP is a powerful tool for solving both operational scheduling and system design problems .",
            "id": "4104082",
            "problem": "A utility-scale electrochemical battery participates in a time-indexed energy delivery task over four discrete periods, each of duration $\\Delta t = 1$ hour. The battery dynamics obey energy conservation and process efficiencies as follows: if the battery charges with electrical power $p^{\\mathrm{ch}}_{t}$ at time $t$, the stored energy increases by $\\eta_{c} \\, p^{\\mathrm{ch}}_{t} \\, \\Delta t$, and if it discharges with electrical output power $p^{\\mathrm{dis}}_{t}$, the stored energy decreases by $\\frac{1}{\\eta_{d}} \\, p^{\\mathrm{dis}}_{t} \\, \\Delta t$. The charge and discharge efficiencies are $\\eta_{c} \\in (0,1)$ and $\\eta_{d} \\in (0,1)$, respectively, and there is no self-discharge. Let $E_{t}$ denote the stored energy at the end of period $t$, with initial energy $E_{0}$ given. The battery energy capacity bound is $0 \\leq E_{t} \\leq E^{\\max}$ for all periods, where $E^{\\max}$ is a design variable to be minimized subject to feasibility. The device must meet a net energy delivery target $Q$ to the grid over the horizon, i.e., $\\sum_{t=1}^{4} p^{\\mathrm{dis}}_{t} \\, \\Delta t = Q$.\n\nTo ensure mutually exclusive operating modes, introduce binary decision variables $y_{t} \\in \\{0,1\\}$ that enforce the logical constraints $p^{\\mathrm{ch}}_{t} \\leq y_{t} \\, \\overline{P}^{\\mathrm{ch}}_{t}$ and $p^{\\mathrm{dis}}_{t} \\leq (1-y_{t}) \\, \\overline{P}^{\\mathrm{dis}}_{t}$ for each period $t$, where $\\overline{P}^{\\mathrm{ch}}_{t}$ and $\\overline{P}^{\\mathrm{dis}}_{t}$ are the period-specific charge and discharge power upper bounds, respectively. This mixed-integer linear programming formulation uses the energy balance constraint $E_{t} = E_{t-1} + \\eta_{c} \\, p^{\\mathrm{ch}}_{t} \\, \\Delta t - \\frac{1}{\\eta_{d}} \\, p^{\\mathrm{dis}}_{t} \\, \\Delta t$ for $t \\in \\{1,2,3,4\\}$.\n\nParameters are specified as follows: $E_{0} = 12$ megawatt-hours, $\\eta_{c} = 0.95$, $\\eta_{d} = 0.90$, $\\Delta t = 1$ hour, $\\overline{P}^{\\mathrm{ch}} = (6, 6, 0, 0)$ megawatts, $\\overline{P}^{\\mathrm{dis}} = (0, 0, 10, 10)$ megawatts, and $Q = 18$ megawatt-hours. The lower energy bound is $0$ megawatt-hours at all times. Assume no other exogenous inflows or outflows.\n\nStarting from the fundamental energy conservation law with the above efficiency model and mixed-integer logical constraints, determine the minimal energy capacity $E^{\\max}$ that permits at least one feasible charge/discharge schedule meeting the net energy delivery target $Q$ and all bounds, and provide one such feasible schedule. Express the final answer as a single real number representing $E^{\\max}$ in megawatt-hours. No rounding is required; provide the exact value.",
            "solution": "The objective is to find the minimum energy capacity $E^{\\max}$ required for a feasible charge/discharge schedule. A feasible schedule must satisfy all given constraints. Since $E^{\\max}$ must be an upper bound for the stored energy at all times ($E_t \\le E^{\\max}$), minimizing $E^{\\max}$ is equivalent to finding a feasible schedule that minimizes the peak energy stored in the battery over the horizon: $\\min (\\max_{t} E_t)$.\n\nFirst, we analyze the constraints on power. The period-specific power bounds are given as $\\overline{P}^{\\mathrm{ch}} = (6, 6, 0, 0)$ MW and $\\overline{P}^{\\mathrm{dis}} = (0, 0, 10, 10)$ MW. These imply:\n- For periods $t=1, 2$: The battery can only charge or be idle ($p^{\\mathrm{dis}}_{1}=0, p^{\\mathrm{dis}}_{2}=0$).\n- For periods $t=3, 4$: The battery can only discharge or be idle ($p^{\\mathrm{ch}}_{3}=0, p^{\\mathrm{ch}}_{4}=0$).\n\nThe energy balance equation is $E_{t} = E_{t-1} + \\eta_{c} p^{\\mathrm{ch}}_{t} - \\frac{1}{\\eta_{d}} p^{\\mathrm{dis}}_{t}$ (since $\\Delta t=1$). Because charging only occurs in the first two periods and discharging in the last two, the energy level sequence is $E_0 \\le E_1 \\le E_2 \\ge E_3 \\ge E_4$. The maximum energy level stored in the battery during the horizon will therefore always be $E_2$. The problem simplifies to finding a feasible schedule that minimizes $E_2$.\n\nThe total energy delivered to the grid must be $Q = 18$ MWh. Since discharging is only possible in periods 3 and 4, this constraint becomes:\n$$ \\sum_{t=1}^{4} p^{\\mathrm{dis}}_{t} \\Delta t = (p^{\\mathrm{dis}}_{3} + p^{\\mathrm{dis}}_{4}) \\cdot 1 = 18 \\text{ MWh} $$\nThe total energy that must be withdrawn from the battery to provide this net delivery, accounting for discharge efficiency, is $\\frac{1}{\\eta_d} (p^{\\mathrm{dis}}_{3} + p^{\\mathrm{dis}}_{4}) = \\frac{18}{0.90} = 20$ MWh.\n\nNow we consider the overall energy balance for the entire horizon, from $t=0$ to $t=4$:\n$$ E_4 = E_0 + \\eta_{c} \\sum_{t=1}^{4} p^{\\mathrm{ch}}_{t} - \\frac{1}{\\eta_d} \\sum_{t=1}^{4} p^{\\mathrm{dis}}_{t} $$\nSubstituting the known values:\n$$ E_4 = 12 + 0.95 (p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2}) - 20 = 0.95 (p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2}) - 8 $$\nThe battery's stored energy cannot be negative, so we must have $E_4 \\ge 0$. This imposes a constraint on the total amount of charging required:\n$$ 0.95 (p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2}) - 8 \\ge 0 \\implies p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2} \\ge \\frac{8}{0.95} = \\frac{160}{19} \\text{ MW} $$\nTo minimize the peak energy $E_2 = E_0 + \\eta_c(p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2})$, we must charge the minimum amount necessary. Therefore, we set the total charge power to its minimum required value:\n$$ p^{\\mathrm{ch}}_{1} + p^{\\mathrm{ch}}_{2} = \\frac{160}{19} \\text{ MW} $$\nThe minimal peak energy is then:\n$$ E_{2, \\min} = 12 + 0.95 \\left(\\frac{160}{19}\\right) = 12 + \\frac{19}{20} \\cdot \\frac{160}{19} = 12 + \\frac{160}{20} = 12 + 8 = 20 \\text{ MWh} $$\nThe minimal required energy capacity is therefore $E^{\\max} = 20$ MWh, provided a feasible schedule exists.\n\nLet's construct one such schedule:\n1.  **Charging**: We need to charge a total of $\\frac{160}{19} \\approx 8.42$ MW over periods 1 and 2. The power limit is 6 MW per period. We can choose $p^{\\mathrm{ch}}_1 = 6$ MW and $p^{\\mathrm{ch}}_2 = \\frac{160}{19} - 6 = \\frac{46}{19}$ MW. Both values are non-negative and do not exceed the 6 MW limit.\n2.  **Discharging**: We need to discharge a total of 18 MW over periods 3 and 4. The power limit is 10 MW per period. We can choose $p^{\\mathrm{dis}}_3 = 10$ MW and $p^{\\mathrm{dis}}_4 = 8$ MW. Both values are non-negative and do not exceed the 10 MW limit.\n\nLet's verify the energy trajectory for this schedule:\n- $E_0 = 12$ MWh\n- $E_1 = E_0 + \\eta_c p^{\\mathrm{ch}}_1 = 12 + 0.95 \\cdot 6 = 12 + 5.7 = 17.7$ MWh\n- $E_2 = E_1 + \\eta_c p^{\\mathrm{ch}}_2 = 17.7 + 0.95 \\cdot \\frac{46}{19} = 17.7 + 2.3 = 20.0$ MWh\n- $E_3 = E_2 - \\frac{1}{\\eta_d} p^{\\mathrm{dis}}_3 = 20 - \\frac{1}{0.90} \\cdot 10 = 20 - \\frac{100}{9} = \\frac{80}{9}$ MWh ($\\approx 8.89$ MWh)\n- $E_4 = E_3 - \\frac{1}{\\eta_d} p^{\\mathrm{dis}}_4 = \\frac{80}{9} - \\frac{1}{0.90} \\cdot 8 = \\frac{80}{9} - \\frac{80}{9} = 0$ MWh\n\nThe energy levels are $E=(17.7, 20.0, 8.89, 0)$ MWh. All levels are within $[0, 20]$ MWh. The schedule is feasible, and the minimum capacity required is the peak energy level, which is 20 MWh.",
            "answer": "$$\\boxed{20}$$"
        }
    ]
}