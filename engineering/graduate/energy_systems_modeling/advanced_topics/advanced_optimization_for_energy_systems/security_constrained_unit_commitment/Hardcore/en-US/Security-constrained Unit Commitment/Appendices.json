{
    "hands_on_practices": [
        {
            "introduction": "The full Security-Constrained Unit Commitment (SCUC) problem involves complex decisions about which generators to turn on and off. However, at its core lies a more fundamental subproblem: once a commitment decision is made, how do we dispatch these online units to meet demand and security requirements at the minimum cost? This practice  isolates this Security-Constrained Economic Dispatch (SCED) task, challenging you to apply the principle of merit-order dispatch to satisfy both energy balance and a system-wide spinning reserve constraint. Mastering this is the first step toward understanding the complete SCUC optimization.",
            "id": "4123128",
            "problem": "Consider a Security-Constrained Unit Commitment (SCUC) instance with three thermal generating units over four hourly periods. Security is represented by a fixed spinning reserve requirement. The fundamental base is the standard SCUC objective and constraints: minimize total operating cost subject to energy balance, capacity limits, and reserve adequacy, with binary commitment and startup/shutdown indicators. Let $i \\in \\{1,2,3\\}$ index units and $t \\in \\{1,2,3,4\\}$ index time periods. Define the binary commitment variable $u_{i,t} \\in \\{0,1\\}$, startup indicator $v_{i,t} \\in \\{0,1\\}$, shutdown indicator $w_{i,t} \\in \\{0,1\\}$, and real dispatch $p_{i,t} \\ge 0$. The canonical SCUC kinematics hold: $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$ for all $i,t$, where the initial commitment $u_{i,0}$ is given. Each unit has a minimum and maximum output $P^{\\min}_{i}$ and $P^{\\max}_{i}$, a no-load cost $F_{i}$ in dollars per hour when $u_{i,t}=1$, a startup cost $S_{i}$ in dollars when $v_{i,t}=1$, and a linear marginal energy cost $c_{i}$ in dollars per megawatt-hour (MWh). The system demand in period $t$ is $D_{t}$ and the spinning reserve requirement is $R_{t}$, interpreted as available headroom, satisfying $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$.\n\nData:\n- Unit $1$: $P^{\\min}_{1} = 80$, $P^{\\max}_{1} = 200$, $F_{1} = 2000$, $S_{1} = 6000$, $c_{1} = 15$.\n- Unit $2$: $P^{\\min}_{2} = 50$, $P^{\\max}_{2} = 150$, $F_{2} = 1500$, $S_{2} = 4000$, $c_{2} = 20$.\n- Unit $3$: $P^{\\min}_{3} = 30$, $P^{\\max}_{3} = 100$, $F_{3} = 1000$, $S_{3} = 3000$, $c_{3} = 40$.\n- Initial commitment at $t=0$: $u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$.\n- Demands: $D_{1} = 280$, $D_{2} = 380$, $D_{3} = 240$, $D_{4} = 350$.\n- Spinning reserve requirement: $R_{t} = 50$ for all $t$.\n\nA commitment schedule and startup/shutdown indicators are given:\n- Commitments $u_{i,t}$:\n  - $t=1$: $u_{1,1} = 1$, $u_{2,1} = 1$, $u_{3,1} = 0$.\n  - $t=2$: $u_{1,2} = 1$, $u_{2,2} = 1$, $u_{3,2} = 1$.\n  - $t=3$: $u_{1,3} = 1$, $u_{2,3} = 0$, $u_{3,3} = 1$.\n  - $t=4$: $u_{1,4} = 1$, $u_{2,4} = 1$, $u_{3,4} = 1$.\n- Startups $v_{i,t}$ and shutdowns $w_{i,t}$:\n  - $t=1$: $v_{2,1} = 1$, all other $v_{i,1} = 0$, all $w_{i,1} = 0$.\n  - $t=2$: $v_{3,2} = 1$, all other $v_{i,2} = 0$, all $w_{i,2} = 0$.\n  - $t=3$: $w_{2,3} = 1$, all other $w_{i,3} = 0$, all $v_{i,3} = 0$.\n  - $t=4$: $v_{2,4} = 1$, all other $v_{i,4} = 0$, all $w_{i,4} = 0$.\n\nAn initial dispatch schedule $p_{i,t}$ is given (all quantities in megawatts, MW):\n- $t=1$: $p_{1,1} = 150$, $p_{2,1} = 130$, $p_{3,1} = 0$.\n- $t=2$: $p_{1,2} = 170$, $p_{2,2} = 150$, $p_{3,2} = 60$.\n- $t=3$: $p_{1,3} = 160$, $p_{2,3} = 0$, $p_{3,3} = 80$.\n- $t=4$: $p_{1,4} = 180$, $p_{2,4} = 130$, $p_{3,4} = 40$.\n\nTasks:\n1. Using the fundamental SCUC objective definition, compute the total operating cost of the given initial dispatch over the four periods, including the no-load and startup components but excluding any shutdown costs. The cost in period $t$ is $\\sum_{i} \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$, and the total is the sum over $t=1,2,3,4$.\n2. Identify, for each period, the cost-minimizing dispatch $p^{\\star}_{i,t}$ subject to $P^{\\min}_{i} \\le p_{i,t} \\le P^{\\max}_{i}$ when $u_{i,t} = 1$, $p_{i,t} = 0$ when $u_{i,t} = 0$, the energy balance $\\sum_{i} p_{i,t} = D_{t}$, and the spinning reserve headroom constraint $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$. No ramping or minimum up/down constraints apply. Use only the given commitment $u_{i,t}$ and indicators $v_{i,t}, w_{i,t}$; do not alter the commitment. Compute the minimum total operating cost over the four periods with this cost-minimizing dispatch, including no-load and startup components and excluding shutdown costs.\n\nProvide the final answer as the minimum total operating cost over all four periods. Round your answer to four significant figures. Express the final cost in dollars (USD).",
            "solution": "The user wants to solve a security-constrained economic dispatch problem for a fixed commitment schedule and calculate the total minimum operating cost. The problem is first validated for internal consistency and scientific soundness.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Unit Data**:\n  - Unit 1: $P^{\\min}_{1} = 80$ MW, $P^{\\max}_{1} = 200$ MW, $F_{1} = \\$2000$/h, $S_{1} = \\$6000$, $c_{1} = \\$15$/MWh.\n  - Unit 2: $P^{\\min}_{2} = 50$ MW, $P^{\\max}_{2} = 150$ MW, $F_{2} = \\$1500$/h, $S_{2} = \\$4000$, $c_{2} = \\$20$/MWh.\n  - Unit 3: $P^{\\min}_{3} = 30$ MW, $P^{\\max}_{3} = 100$ MW, $F_{3} = \\$1000$/h, $S_{3} = \\$3000$, $c_{3} = \\$40$/MWh.\n- **Initial State ($t=0$)**: $u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$.\n- **Demands ($D_t$)**: $D_{1} = 280$ MW, $D_{2} = 380$ MW, $D_{3} = 240$ MW, $D_{4} = 350$ MW.\n- **Reserve ($R_t$)**: $R_{t} = 50$ MW for $t \\in \\{1,2,3,4\\}$.\n- **Given Commitments ($u_{i,t}$)**:\n  - $t=1$: $\\{u_{1,1}, u_{2,1}, u_{3,1}\\} = \\{1, 1, 0\\}$\n  - $t=2$: $\\{u_{1,2}, u_{2,2}, u_{3,2}\\} = \\{1, 1, 1\\}$\n  - $t=3$: $\\{u_{1,3}, u_{2,3}, u_{3,3}\\} = \\{1, 0, 1\\}$\n  - $t=4$: $\\{u_{1,4}, u_{2,4}, u_{3,4}\\} = \\{1, 1, 1\\}$\n- **Given Indicators ($v_{i,t}, w_{i,t}$)**:\n  - $t=1$: $v_{2,1} = 1$. Others $0$.\n  - $t=2$: $v_{3,2} = 1$. Others $0$.\n  - $t=3$: $w_{2,3} = 1$. Others $0$.\n  - $t=4$: $v_{2,4} = 1$. Others $0$.\n- **Given Dispatch ($p_{i,t}$)**: (This is for context and validation, not for the final calculation).\n- **Cost Function**: Total cost for $t=1...4$ is $\\sum_{t=1}^4 \\sum_{i=1}^3 \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$.\n- **Kinematic Rule**: $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is validated for consistency.\n1.  **Kinematic Consistency**: The relationship $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$ is checked for all units and time periods. For instance, for unit $2$ at $t=1$, $u_{2,1} - u_{2,0} = 1 - 0 = 1$. This matches $v_{2,1} - w_{2,1} = 1 - 0 = 1$. At $t=3$ for unit $2$, $u_{2,3} - u_{2,2} = 0 - 1 = -1$, which matches $v_{2,3} - w_{2,3} = 0 - 1 = -1$. All other transitions are verified and found to be consistent.\n2.  **Scientific Grounding**: The problem is a standard Security-Constrained Economic Dispatch (SCED) problem, which is a fundamental and well-established topic in power systems engineering.\n3.  **Well-Posedness**: The problem is well-posed, with a clear objective function and a set of linear constraints. The givens are sufficient to find a unique, meaningful solution.\n4.  **Feasibility of Given Schedule**: The provided initial dispatch schedule is checked against all constraints (generation limits, demand balance, reserve requirements) and is found to be feasible, confirming the self-consistency of the data. For example, at $t=1$, demand $D_1=280$ MW is met by $p_{1,1}+p_{2,1}=150+130=280$ MW. The reserve is $(P^{\\max}_1-p_{1,1}) + (P^{\\max}_2-p_{2,1}) = (200-150)+(150-130)=70$ MW, which is greater than the required $R_1=50$ MW. All periods are similarly feasible.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, self-contained, and well-posed. A solution will be computed.\n\n### Solution\n\nThe objective is to compute the minimum total operating cost for the given commitment schedule over four hours. The total cost, $C_{\\text{total}}$, is the sum of costs from each hour $t$:\n$$C_{\\text{total}} = \\sum_{t=1}^{4} \\left( \\sum_{i=1}^{3} (F_{i} u_{i,t} + S_{i} v_{i,t}) + \\sum_{i=1}^{3} c_{i} p_{i,t} \\right)$$\nSince the commitment schedule ($u_{i,t}$) and startup decisions ($v_{i,t}$) are given, the no-load ($F_i$) and startup ($S_i$) costs are fixed. To minimize $C_{\\text{total}}$, we must minimize the variable energy cost component, $\\sum_{t=1}^4 \\sum_{i=1}^3 c_i p_{i,t}$. As there are no inter-temporal dispatch constraints (like ramping), we can minimize the energy cost for each hour independently. This is a classic Economic Dispatch Problem (EDP) for each hour.\n\nFor each hour $t$, we solve:\n$$ \\min_{p_{i,t}} \\sum_{i=1}^{3} c_i p_{i,t} $$\nSubject to:\n1.  Energy Balance: $\\sum_{i=1}^{3} p_{i,t} = D_t$\n2.  Generation Limits: $u_{i,t} P^{\\min}_i \\le p_{i,t} \\le u_{i,t} P^{\\max}_i$ for $i \\in \\{1,2,3\\}$\n3.  Spinning Reserve: $\\sum_{i=1}^{3} (u_{i,t} P^{\\max}_i - p_{i,t}) \\ge R_t$\n\nThe spinning reserve constraint can be rewritten using the energy balance constraint: $\\sum_{i=1}^{3} u_{i,t} P^{\\max}_i - D_t \\ge R_t$. This is a check on the total committed capacity, which must be performed before dispatch.\n\nThe marginal costs are $c_{1} = 15$, $c_{2} = 20$, and $c_{3} = 40$. The merit order for dispatch is Unit $1$, then Unit $2$, then Unit $3$.\n\n**Optimal Dispatch Calculation**\n\n**Period $t=1$**:\n- Committed units: $\\{1, 2\\}$. Demand $D_1=280$. Reserve $R_1=50$.\n- Capacity check: $P^{\\max}_1+P^{\\max}_2 = 200+150=350$ MW. Required: $D_1+R_1 = 280+50=330$ MW. $350 \\ge 330$, OK.\n- Dispatch: Load units to minimum: $p_{1,1}=80$, $p_{2,1}=50$. Total: $130$ MW. Remainder: $280-130=150$ MW.\n- Load cheapest (Unit 1) from $80$ to $200$: adds $120$ MW. Remainder: $150-120=30$ MW.\n- Load Unit 2 from $50$: adds $30$ MW.\n- Optimal dispatch: $p^{\\star}_{1,1}=200$, $p^{\\star}_{2,1}=80$.\n- Energy cost: $15 \\times 200 + 20 \\times 80 = 3000 + 1600 = \\$4600$.\n\n**Period $t=2$**:\n- Committed units: $\\{1, 2, 3\\}$. Demand $D_2=380$. Reserve $R_2=50$.\n- Capacity check: $P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=200+150+100=450$ MW. Required: $D_2+R_2 = 380+50=430$ MW. $450 \\ge 430$, OK.\n- Dispatch: Load to min: $p_{1,2}=80$, $p_{2,2}=50$, $p_{3,2}=30$. Total: $160$ MW. Remainder: $380-160=220$ MW.\n- Load Unit 1 from $80$ to $200$: adds $120$ MW. Remainder: $220-120=100$ MW.\n- Load Unit 2 from $50$ to $150$: adds $100$ MW. Remainder: $100-100=0$ MW.\n- Unit 3 remains at minimum.\n- Optimal dispatch: $p^{\\star}_{1,2}=200$, $p^{\\star}_{2,2}=150$, $p^{\\star}_{3,2}=30$.\n- Energy cost: $15 \\times 200 + 20 \\times 150 + 40 \\times 30 = 3000 + 3000 + 1200 = \\$7200$.\n\n**Period $t=3$**:\n- Committed units: $\\{1, 3\\}$. Demand $D_3=240$. Reserve $R_3=50$.\n- Capacity check: $P^{\\max}_1+P^{\\max}_3 = 200+100=300$ MW. Required: $D_3+R_3=240+50=290$ MW. $300 \\ge 290$, OK.\n- Dispatch: Load to min: $p_{1,3}=80$, $p_{3,3}=30$. Total: $110$ MW. Remainder: $240-110=130$ MW.\n- Load Unit 1 from $80$ to $200$: adds $120$ MW. Remainder: $130-120=10$ MW.\n- Load Unit 3 from $30$: adds $10$ MW.\n- Optimal dispatch: $p^{\\star}_{1,3}=200$, $p^{\\star}_{3,3}=40$.\n- Energy cost: $15 \\times 200 + 40 \\times 40 = 3000 + 1600 = \\$4600$.\n\n**Period $t=4$**:\n- Committed units: $\\{1, 2, 3\\}$. Demand $D_4=350$. Reserve $R_4=50$.\n- Capacity check: $P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=450$ MW. Required: $D_4+R_4=350+50=400$ MW. $450 \\ge 400$, OK.\n- Dispatch: Load to min: $p_{1,4}=80$, $p_{2,4}=50$, $p_{3,4}=30$. Total: $160$ MW. Remainder: $350-160=190$ MW.\n- Load Unit 1 from $80$ to $200$: adds $120$ MW. Remainder: $190-120=70$ MW.\n- Load Unit 2 from $50$: adds $70$ MW.\n- Optimal dispatch: $p^{\\star}_{1,4}=200$, $p^{\\star}_{2,4}=120$, $p^{\\star}_{3,4}=30$.\n- Energy cost: $15 \\times 200 + 20 \\times 120 + 40 \\times 30 = 3000 + 2400 + 1200 = \\$6600$.\n\n**Total Cost Calculation**\n\nTotal minimum energy cost = $\\$4600 + \\$7200 + \\$4600 + \\$6600 = \\$23000$.\n\nNow, we calculate the fixed costs (no-load and startup):\n- $t=1$: $F_1 u_{1,1} + F_2 u_{2,1} + S_2 v_{2,1} = 2000 + 1500 + 4000 = \\$7500$.\n- $t=2$: $F_1 u_{1,2} + F_2 u_{2,2} + F_3 u_{3,2} + S_3 v_{3,2} = 2000 + 1500 + 1000 + 3000 = \\$7500$.\n- $t=3$: $F_1 u_{1,3} + F_3 u_{3,3} = 2000 + 1000 = \\$3000$.\n- $t=4$: $F_1 u_{1,4} + F_2 u_{2,4} + F_3 u_{3,4} + S_2 v_{2,4} = 2000 + 1500 + 1000 + 4000 = \\$8500$.\n\nTotal fixed cost = $\\$7500 + \\$7500 + \\$3000 + \\$8500 = \\$26500$.\n\nMinimum Total Operating Cost = Total Fixed Cost + Total Minimum Energy Cost\n$$C^{\\star}_{\\text{total}} = \\$26500 + \\$23000 = \\$49500$$\n\nThe problem asks for the answer to be rounded to four significant figures. The exact answer is $49500$. Expressing this to four significant figures yields $4.950 \\times 10^4$.",
            "answer": "$$\\boxed{4.950 \\times 10^{4}}$$"
        },
        {
            "introduction": "In our previous exercise, we assumed the grid could handle any dispatch. In reality, transmission lines have finite capacity. This practice  introduces this crucial layer of complexity, demonstrating what happens when the most economic dispatch violates a physical line limit. By solving a dispatch problem on a simple congested network, you will derive Locational Marginal Prices (LMPs) from first principles and see how physical constraints manifest as economic signals, creating price separation and congestion rent.",
            "id": "4123071",
            "problem": "Consider a direct-current (DC) approximation of a three-bus transmission network used in Security-Constrained Unit Commitment (SCUC) and Security-Constrained Economic Dispatch (SCED). Buses are labeled $1$, $2$, and $3$, with bus $1$ designated as the slack (reference) bus, i.e., its phase angle is fixed at $0$. The network topology is radial: bus $1$ is connected to bus $2$, and bus $2$ is connected to bus $3$. The series reactances are identical and positive, and the DC model assumes linearized power flows, small angle differences, and lossless lines.\n\nThere is one monitored transmission constraint: the real-power flow on line $(2 \\rightarrow 3)$ must satisfy $F_{23} \\leq F_{23}^{\\max}$ in the positive direction from bus $2$ to bus $3$. The limit is $F_{23}^{\\max} = 60$ MW. The line $(1 \\rightarrow 2)$ has no binding constraint in this scenario.\n\nAt each bus $i \\in \\{1,2,3\\}$ there is a conventional generator with linear marginal cost $c_i$ and ample capacity (no generation limit binds). The marginal costs are ordered $c_1  c_2  c_3$ and given numerically by $c_1 = 10 \\$/\\text{MWh}$, $c_2 = 20 \\$/\\text{MWh}$, and $c_3 = 40 \\$/\\text{MWh}$. There is a single-period demand: $d_1 = 0$ MW, $d_2 = 0$ MW, and $d_3 = 100$ MW. Ramping and unit commitment binaries are not binding in this single-period case.\n\nUse the DC power flow fundamentals and the definition of the Power Transfer Distribution Factor (PTDF), defined for line $(2 \\rightarrow 3)$ as the sensitivity of $F_{23}$ to an incremental injection at bus $i$ balanced by an equal withdrawal at the slack bus $1$, to derive the Locational Marginal Price (LMP) at each bus. Let $\\mu_{23} \\geq 0$ denote the Lagrange multiplier (dual variable) associated with the upper bound $F_{23} \\leq F_{23}^{\\max}$. Assume the lower bound on $F_{23}$ is not binding.\n\nStarting from first principles, formulate the SCED problem under the DC model, derive the Karush–Kuhn–Tucker (KKT) conditions, identify the binding constraints, and use the PTDF and the line-constraint dual to compute the nodal LMPs $\\text{LMP}_1$, $\\text{LMP}_2$, and $\\text{LMP}_3$. Then interpret the nodal price differences as congestion-induced price separation and compute the total congestion rent collected on line $(2 \\rightarrow 3)$.\n\nRound each LMP to four significant figures and express them in $\\$/\\text{MWh}$. Round the congestion rent to four significant figures and express it in $\\$/\\text{h}$. Report your final numeric results in the order $\\left(\\text{LMP}_1, \\text{LMP}_2, \\text{LMP}_3, R\\right)$, where $R$ is the congestion rent on line $(2 \\rightarrow 3)$.",
            "solution": "The problem asks for the Locational Marginal Prices (LMPs) at three buses and the congestion rent on a transmission line in a Security-Constrained Economic Dispatch (SCED) framework. The analysis will proceed by first formulating the optimization problem, then deriving the power flow constraints using the provided DC approximation, solving the problem using Karush-Kuhn-Tucker (KKT) conditions, and finally computing the LMPs and congestion rent from the solution.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- **Network**: Three-bus DC network with buses labeled $1$, $2$, $3$.\n- **Slack Bus**: Bus $1$ is the reference bus with phase angle $\\theta_1 = 0$.\n- **Topology**: Radial connection: line $(1,2)$ and line $(2,3)$.\n- **Line Parameters**: Series reactances are identical and positive, let's denote the reactance by $x > 0$. The susceptance is $b = 1/x$.\n- **Constraint**: Power flow on line $(2 \\rightarrow 3)$ is limited by $F_{23} \\leq F_{23}^{\\max}$.\n- **Flow Limit**: $F_{23}^{\\max} = 60$ MW.\n- **Generator Costs**: Marginal costs are $c_1 = 10 \\$/\\text{MWh}$, $c_2 = 20 \\$/\\text{MWh}$, $c_3 = 40 \\$/\\text{MWh}$.\n- **Demands**: Single-period demands are $d_1 = 0$ MW, $d_2 = 0$ MW, $d_3 = 100$ MW.\n- **Dual Variable**: $\\mu_{23} \\geq 0$ is the Lagrange multiplier for the line constraint.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic and well-defined SCED problem.\n- **Scientifically Grounded**: The problem uses the DC power flow model, a standard and fundamental tool in power system analysis for operational planning. The concepts of LMPs, PTDFs, and KKT conditions are central to electricity market theory and practice.\n- **Well-Posed**: The problem is a linear program with a convex objective function and linear constraints. All necessary data are provided, and the setup ensures that a unique and meaningful solution exists. The assumption of identical reactances simplifies the calculation, but the exact value is not needed as it will cancel out in the PTDF calculation for this particular topology.\n- **Objective**: The language is precise and uses standard industry terminology.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now commence.\n\nThe SCED problem is to minimize the total cost of generation subject to system-wide power balance and network security constraints.\nThe objective function is the total generation cost:\n$$\n\\min_{p_1, p_2, p_3} C = c_1 p_1 + c_2 p_2 + c_3 p_3 = 10 p_1 + 20 p_2 + 40 p_3\n$$\nThe generation variables $p_i$ for $i \\in \\{1, 2, 3\\}$ are assumed to be non-negative, $p_i \\geq 0$.\n\nThe constraints are:\n1.  **Power Balance**: The total generation must equal the total demand.\n    $$\n    \\sum_{i=1}^{3} p_i = \\sum_{i=1}^{3} d_i \\implies p_1 + p_2 + p_3 = 0 + 0 + 100 = 100\n    $$\n2.  **Transmission Security**: The flow on line $(2,3)$ must not exceed its limit.\n    $$\n    F_{23} \\leq F_{23}^{\\max} = 60\n    $$\n\nTo express $F_{23}$ in terms of the generation variables, we use the DC power flow model. The flow on a line $(i,j)$ is $F_{ij} = \\frac{1}{x_{ij}}(\\theta_i - \\theta_j) = b_{ij}(\\theta_i - \\theta_j)$. In a radial network, the flow on the terminal line segment $(2,3)$ is determined solely by the net power injection at the terminal bus $3$. The power flowing from bus $2$ to bus $3$ must equal the demand at bus $3$ minus the generation at bus $3$.\n$$\nF_{23} = d_3 - p_3 = 100 - p_3\n$$\nThis can be formally derived using Power Transfer Distribution Factors (PTDFs). The PTDF, $\\text{PTDF}_{l,k}$, gives the change in flow on line $l$ for a $1$ MW injection at bus $k$ withdrawn at the slack bus. For a radial line $(2,3)$ with slack at bus $1$, the PTDFs for line $(2,3)$ are:\n- $\\text{PTDF}_{23,2} = 0$: An injection at bus $2$ balanced at bus $1$ flows only on line $(1,2)$ and does not affect line $(2,3)$.\n- $\\text{PTDF}_{23,3} = -1$: An injection at bus $3$ balanced at bus $1$ must be sourced from bus $1$. This power flows from $1 \\to 2 \\to 3$. To inject $1$ MW at bus $3$, one must \"push back\" on the flow coming from bus $2$, thus reducing the flow $F_{23}$ by $1$ MW.\nThe flow on line $(2,3)$ is given by:\n$$\nF_{23} = \\sum_{k \\neq \\text{slack}} \\text{PTDF}_{23,k} (p_k - d_k) = \\text{PTDF}_{23,2}(p_2 - d_2) + \\text{PTDF}_{23,3}(p_3 - d_3)\n$$\nSubstituting the known values:\n$$\nF_{23} = (0)(p_2 - 0) + (-1)(p_3 - 100) = 100 - p_3\n$$\nSo the line constraint becomes $100 - p_3 \\leq 60$, which simplifies to $p_3 \\geq 40$.\n\nFirst, let us examine the unconstrained economic dispatch. To minimize cost, we would use the cheapest generator, $G_1$, to meet the entire $100$ MW load. The dispatch would be $p_1 = 100$ MW, $p_2 = 0$ MW, $p_3 = 0$ MW. In this case, the flow on line $(2,3)$ would be $F_{23} = 100 - p_3 = 100 - 0 = 100$ MW. Since $100 \\text{ MW} > 60 \\text{ MW}$, this dispatch violates the transmission constraint. The system is congested.\n\nWe must solve the full SCED problem. The optimization problem is:\n$$\n\\min_{p_1, p_2, p_3} (10 p_1 + 20 p_2 + 40 p_3)\n$$\nsubject to:\n$$\np_1 + p_2 + p_3 = 100 \\quad (\\text{dual variable } \\lambda)\n$$\n$$\n40 - p_3 \\leq 0 \\quad (\\text{dual variable } \\mu_{23})\n$$\n$$\np_1 \\geq 0, \\quad p_2 \\geq 0, \\quad p_3 \\geq 0\n$$\nSince the unconstrained solution is infeasible, the line constraint must be binding at the optimum, i.e., $40 - p_3 = 0 \\implies p_3 = 40$ MW.\nThe system needs a total of $100$ MW. With $p_3 = 40$ MW, the remaining $100 - 40 = 60$ MW must be supplied by generators $G_1$ and $G_2$. Since $c_1  c_2$, the remaining demand should be met entirely by the cheaper generator, $G_1$.\nThus, the optimal dispatch is:\n$$\np_1 = 60 \\text{ MW}, \\quad p_2 = 0 \\text{ MW}, \\quad p_3 = 40 \\text{ MW}\n$$\nThis solution satisfies all constraints: $p_i \\ge 0$, total generation is $60+0+40=100$ MW, and the line flow is $F_{23} = 100 - p_3 = 100 - 40 = 60$ MW, which is at the limit.\n\nNow we find the Lagrange multipliers by forming the Lagrangian and using the KKT conditions.\nThe Lagrangian is:\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda, \\mu_{23}) = (10 p_1 + 20 p_2 + 40 p_3) - \\lambda(p_1 + p_2 + p_3 - 100) - \\mu_{23}(- (40 - p_3))\n$$\n$$\n\\mathcal{L} = (10 p_1 + 20 p_2 + 40 p_3) - \\lambda(p_1 + p_2 + p_3 - 100) + \\mu_{23}(p_3 - 40)\n$$\nWe have used the standard formulation where the multiplier for a constraint $g(x) \\le 0$ would have the form $-\\mu g(x)$, requiring $\\mu \\ge 0$. Here, $g(p_3) = 40 - p_3$. And we write the constraint as $p_3 \\ge 40$, so $40-p_3 \\le 0$. The KKT optimality conditions are:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_1} = 10 - \\lambda \\geq 0 \\quad (\\text{equality if } p_1 > 0)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_2} = 20 - \\lambda \\geq 0 \\quad (\\text{equality if } p_2 > 0)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_3} = 40 - \\lambda + \\mu_{23} \\geq 0 \\quad (\\text{equality if } p_3 > 0)\n$$\nSince $p_1 = 60 > 0$:\n$$\n10 - \\lambda = 0 \\implies \\lambda = 10\n$$\nSince $p_2 = 0$, we check the inequality:\n$$\n20 - \\lambda = 20 - 10 = 10 \\geq 0 \\quad (\\text{satisfied})\n$$\nSince $p_3 = 40 > 0$:\n$$\n40 - \\lambda + \\mu_{23} = 0 \\implies 40 - 10 + \\mu_{23} = 0 \\implies \\mu_{23} = -30\n$$\nThere is a sign convention issue in my Lagrangian setup. Let's use the standard form $\\mathcal{L} = f(x) + \\lambda h(x) + \\mu g(x)$ where constraints are $h(x)=0, g(x) \\le 0$ and $\\mu \\ge 0$.\nThe Lagrangian is:\n$$\n\\mathcal{L} = (10 p_1 + 20 p_2 + 40 p_3) + \\lambda(100 - p_1 - p_2 - p_3) + \\mu_{23}(40 - p_3)\n$$\nThe KKT conditions become:\n$\\frac{\\partial \\mathcal{L}}{\\partial p_1} = 10 - \\lambda = 0 \\implies \\lambda = 10$ (since $p_1=60>0$)\n$\\frac{\\partial \\mathcal{L}}{\\partial p_2} = 20 - \\lambda \\ge 0 \\implies 20-10=10 \\ge 0$ (since $p_2=0$)\n$\\frac{\\partial \\mathcal{L}}{\\partial p_3} = 40 - \\lambda - \\mu_{23} = 0 \\implies 40 - 10 - \\mu_{23} = 0 \\implies \\mu_{23} = 30$ (since $p_3=40>0$)\nWe must have $\\mu_{23} \\ge 0$, which is satisfied. This formulation is consistent. $\\lambda$ is the system marginal energy price, and $\\mu_{23}$ is the congestion price.\n\nThe Locational Marginal Price (LMP) at the reference bus (bus 1) is simply $\\lambda$.\n$$\n\\text{LMP}_1 = \\lambda = 10 \\text{ \\$/MWh}\n$$\nThe LMPs at other buses are computed by adjusting the reference bus LMP by the marginal cost of congestion caused by an injection at that bus. The formula is:\n$$\n\\text{LMP}_k = \\lambda - \\sum_{l} \\mu_l \\text{PTDF}_{l,k}\n$$\nIn our case, there is only one congested line, $(2,3)$. So for bus $k$:\n$$\n\\text{LMP}_k = \\lambda - \\mu_{23} \\text{PTDF}_{23,k}\n$$\nUsing $\\lambda=10$, $\\mu_{23}=30$, and the previously determined PTDFs:\n$$\n\\text{LMP}_1 = \\lambda - \\mu_{23} \\text{PTDF}_{23,1} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_2 = \\lambda - \\mu_{23} \\text{PTDF}_{23,2} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_3 = \\lambda - \\mu_{23} \\text{PTDF}_{23,3} = 10 - (30)(-1) = 10 + 30 = 40\n$$\nSo the LMPs are $\\text{LMP}_1 = 10.00 \\$/\\text{MWh}$, $\\text{LMP}_2 = 10.00 \\$/\\text{MWh}$, and $\\text{LMP}_3 = 40.00 \\$/\\text{MWh}$.\nThe price at bus $3$ is set by the local expensive generator $G_3$ because importing cheaper power is limited by congestion. The prices at buses $1$ and $2$ are set by the cheap generator $G_1$ as there is no congestion between them.\n\nThe congestion rent, $R$, collected on line $(2,3)$ is the product of the power flow and the LMP difference across the line.\n$$\nR_{23} = F_{23} \\times (\\text{LMP}_3 - \\text{LMP}_2)\n$$\nSubstituting the values:\n$$\nR_{23} = 60 \\text{ MW} \\times (40 \\text{ \\$/MWh} - 10 \\text{ \\$/MWh}) = 60 \\times 30 \\text{ \\$/h} = 1800 \\text{ \\$/h}\n$$\nThis can be verified by calculating the difference between total payments by loads and total payments to generators.\nTotal load payment = $\\sum_k \\text{LMP}_k d_k = \\text{LMP}_3 \\times d_3 = 40 \\times 100 = 4000 \\$/\\text{h}$.\nTotal generation cost = $\\sum_i c_i p_i = (10)(60) + (20)(0) + (40)(40) = 600 + 1600 = 2200 \\$/\\text{h}$.\nCongestion Rent = Load Payment - Generation Cost = $4000 - 2200 = 1800 \\$/\\text{h}$, which matches.\n\nThe final numeric results rounded to four significant figures are:\n- $\\text{LMP}_1 = 10.00 \\$/\\text{MWh}$\n- $\\text{LMP}_2 = 10.00 \\$/\\text{MWh}$\n- $\\text{LMP}_3 = 40.00 \\$/\\text{MWh}$\n- $R = 1800 \\$/\\text{h}$. Can be written as $1.800 \\times 10^3$.\n\nThe final answer is presented in the required matrix format.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10.00  10.00  40.00  1800\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "We have seen how to dispatch committed units economically and how network limits constrain that dispatch. But the most critical decisions in SCUC are the commitment decisions themselves, which have consequences that unfold over time. This exercise  serves as a powerful cautionary tale, using a numerical counterexample to demonstrate the perils of myopic, short-sighted scheduling. You will discover how physical constraints like startup lead times and ramp rates necessitate a forward-looking approach, providing a clear justification for the temporal complexity of full SCUC models.",
            "id": "4123140",
            "problem": "Consider a single-bus Security-Constrained Unit Commitment (SCUC) problem over discrete hourly time periods with a rolling-horizon implementation. The rolling horizon uses a look-ahead window of $H$ hours and, at each decision epoch $t$, it commits generators to ensure feasibility for the interval $\\{t+1,\\dots,t+H\\}$, subject to generator operating constraints. Assume perfect forecasts within the horizon and no intertemporal costs other than startup costs. The system must satisfy the deterministic power balance constraint in each hour, with no load shedding allowed by design; if the committed fleet cannot meet the demand due to physical constraints, the schedule is infeasible and the unmet demand is the shortfall.\n\nThe fundamental base is:\n- Power balance: For each time $t$, $\\sum_{g} P_{g,t} = D_{t}$, where $P_{g,t}$ is the real power output of generator $g$ and $D_{t}$ is the demand.\n- Operating limits: For each generator $g$ and time $t$, $P^{\\min}_{g} u_{g,t} \\le P_{g,t} \\le P^{\\max}_{g} u_{g,t}$, where $u_{g,t} \\in \\{0,1\\}$ is the commitment state.\n- Ramp-rate limits: For each generator $g$ and consecutive times $t-1$ and $t$, $P_{g,t} - P_{g,t-1} \\le RU_{g}$ and $P_{g,t-1} - P_{g,t} \\le RD_{g}$.\n- Startup lead time: If generator $g$ is started at time $t$ (binary start variable $y_{g,t} = 1$), then it becomes available to produce (i.e., $u_{g,\\tau} = 1$ can be set) no earlier than $\\tau = t + ST_{g}$. Before $\\tau$, $u_{g,\\tau'} = 0$ for all $\\tau'  t + ST_{g}$.\n\nThere are two thermal generators, indexed $g \\in \\{1,2\\}$, with parameters:\n- Generator $1$: $P^{\\min}_{1} = 100$ MW, $P^{\\max}_{1} = 300$ MW, $RU_{1} = 100$ MW/h, $RD_{1} = 100$ MW/h, startup lead time $ST_{1} = 0$ h, initially committed at $t=0$ with $P_{1,0} = 100$ MW.\n- Generator $2$: $P^{\\min}_{2} = 200$ MW, $P^{\\max}_{2} = 600$ MW, $RU_{2} = 200$ MW/h, $RD_{2} = 200$ MW/h, startup lead time $ST_{2} = 2$ h, initially offline at $t=0$.\n\nThe hourly demand forecast is:\n- $D_{1} = 200$ MW,\n- $D_{2} = 250$ MW,\n- $D_{3} = 600$ MW.\n\nStartup costs are positive and large for generator $2$, so a myopic schedule that only sees the immediate horizon avoids starting generator $2$ unless required for feasibility within that horizon.\n\nA rolling-horizon SCUC is executed with look-ahead $H = 1$ hour. At each hour $t \\in \\{0,1,2\\}$, the SCUC ensures feasibility for the next single hour only. Demonstrate via a numerical counterexample that the $H=1$ myopic schedule leads to infeasibility at $t=3$, because a delayed startup of generator $2$ cannot ramp in time to cover the steep load increase. Compute the magnitude of the unmet demand (shortfall) in megawatts at $t=3$ under this $H=1$ schedule. Express your final answer in MW. No rounding is required.",
            "solution": "The problem requires a demonstration of infeasibility arising from a myopic rolling-horizon scheduling policy in a Security-Constrained Unit Commitment (SCUC) context. We will trace the state of the system and the commitment decisions made at each discrete time step $t$, under a look-ahead horizon of $H=1$ hour. The myopic nature of the schedule is defined by the fact that at each decision epoch $t$, the system operator only considers feasibility for the immediate next hour, $t+1$, and avoids costly actions (like starting generator $2$) if not strictly necessary for that single hour.\n\nThe initial state at $t=0$ is given as:\n- Generator $1$: Committed, $u_{1,0} = 1$, with output $P_{1,0} = 100$ MW.\n- Generator $2$: Offline, $u_{2,0} = 0$, with output $P_{2,0} = 0$ MW.\n\nWe proceed by analyzing the decisions at each time step.\n\n**Decision at $t=0$ (for hour $t=1$)**\n\nAt decision epoch $t=0$, the scheduler plans for hour $t=1$. The look-ahead window contains only the demand $D_{1} = 200$ MW.\nWe must check if the currently committed generator, generator $1$, can meet this demand.\nThe maximum power output of generator $1$ at $t=1$, denoted $P_{1,1}^{\\text{max\\_avail}}$, is constrained by its maximum power limit $P_{1}^{\\max}$ and its ramp-up limit $RU_{1}$ from its state at $t=0$.\n$$P_{1,1}^{\\text{max\\_avail}} = \\min(P_{1}^{\\max}, P_{1,0} + RU_{1})$$\nSubstituting the given values:\n$$P_{1,1}^{\\text{max\\_avail}} = \\min(300 \\text{ MW}, 100 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 200) \\text{ MW} = 200 \\text{ MW}$$\nThe minimum power output is $P_{1}^{\\min} = 100$ MW. Since the demand $D_{1} = 200$ MW falls within the achievable range of generator $1$ (i.e., $100 \\text{ MW} \\le 200 \\text{ MW} \\le 200 \\text{ MW}$), generator $1$ can meet the demand alone.\nThe myopic scheduler, seeking to avoid the large startup cost of generator $2$, will not issue a startup command. The commitment decision is to keep generator $2$ offline.\nThe resulting state at $t=1$ is:\n- $u_{1,1}=1$, $P_{1,1} = D_1 = 200$ MW.\n- $u_{2,1}=0$, $P_{2,1} = 0$ MW.\n- No startup command is issued for generator $2$, so its startup variable $y_{2,0}=0$.\n\n**Decision at $t=1$ (for hour $t=2$)**\n\nAt decision epoch $t=1$, the scheduler plans for hour $t=2$. The look-ahead window contains only the demand $D_{2} = 250$ MW. The state at $t=1$ is known from the previous step.\nWe check the capacity of generator $1$ at $t=2$.\n$$P_{1,2}^{\\text{max\\_avail}} = \\min(P_{1}^{\\max}, P_{1,1} + RU_{1})$$\n$$P_{1,2}^{\\text{max\\_avail}} = \\min(300 \\text{ MW}, 200 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 300) \\text{ MW} = 300 \\text{ MW}$$\nThe demand $D_{2} = 250$ MW is within the operating range of generator $1$ ($100 \\text{ MW} \\le 250 \\text{ MW} \\le 300 \\text{ MW}$).\nAgain, the myopic scheduler finds that generator $1$ is sufficient and avoids starting generator $2$.\nThe resulting state at $t=2$ is:\n- $u_{1,2}=1$, $P_{1,2} = D_2 = 250$ MW.\n- $u_{2,2}=0$, $P_{2,2} = 0$ MW.\n- No startup command is issued for generator $2$, so $y_{2,1}=0$. This is the critical failure. To have generator $2$ available at $t=3$, a startup command would have been required at or before $t=1$, because its startup lead time is $ST_{2} = 2$ hours ($1+2=3$).\n\n**Analysis of Feasibility at $t=3$**\n\nAt decision epoch $t=2$, the scheduler plans for hour $t=3$. The demand is $D_{3} = 600$ MW. The state at $t=2$ is $P_{1,2}=250$ MW and $P_{2,2}=0$ MW, with generator $2$ being offline.\nThe maximum possible generation from generator $1$ at $t=3$ is:\n$$P_{1,3}^{\\text{max\\_possible}} = \\min(P_{1}^{\\max}, P_{1,2} + RU_{1})$$\n$$P_{1,3}^{\\text{max\\_possible}} = \\min(300 \\text{ MW}, 250 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 350) \\text{ MW} = 300 \\text{ MW}$$\nClearly, generator $1$ alone is insufficient to meet the $600$ MW demand. The scheduler at $t=2$ recognizes this and would issue a startup command for generator $2$, i.e., $y_{2,2}=1$.\nHowever, we must check when generator $2$ becomes available. According to the problem statement, a startup at time $t$ makes the generator available at time $\\tau \\ge t + ST_{g}$.\nFor generator $2$, with $ST_{2} = 2$ hours, a startup command at $t=2$ means it becomes available for production no earlier than $\\tau = 2 + 2 = 4$.\nTherefore, at $t=3$, generator $2$ is not available for dispatch, i.e., its commitment state must be $u_{2,3}=0$, and its power output is $P_{2,3}=0$ MW.\n\nThe total available generation capacity at $t=3$ is the sum of the maximum possible outputs from all generators.\n$$P_{\\text{total},3}^{\\text{max}} = P_{1,3}^{\\text{max\\_possible}} + P_{2,3}^{\\text{max\\_possible}} = 300 \\text{ MW} + 0 \\text{ MW} = 300 \\text{ MW}$$\nThe demand at this hour is $D_{3} = 600$ MW.\nThe system faces a shortfall, as the available generation is less than the demand. The magnitude of this unmet demand is:\n$$\\text{Shortfall} = D_{3} - P_{\\text{total},3}^{\\text{max}}$$\n$$\\text{Shortfall} = 600 \\text{ MW} - 300 \\text{ MW} = 300 \\text{ MW}$$\nThis demonstrates that the myopic $H=1$ scheduling policy, by failing to anticipate the large ramp in demand at $t=3$ and the long startup time of generator $2$, leads to a supply shortage of $300$ MW. A scheduler with a longer look-ahead horizon (e.g., $H=3$) would have foreseen the need for generator $2$ at $t=3$ and issued a startup command at $t=1$.",
            "answer": "$$\n\\boxed{300}\n$$"
        }
    ]
}