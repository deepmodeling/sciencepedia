{
    "hands_on_practices": [
        {
            "introduction": "Mastering Benders decomposition begins with a solid grasp of its iterative mechanics. This exercise walks you through the core loop of the algorithm for a simple capacity expansion problem. By manually calculating the first few iterations, you will see firsthand how the master problem uses optimality cuts, derived from the dual of the operational subproblem, to build an increasingly accurate approximation of the total system cost and converge to the true optimum .",
            "id": "4071612",
            "problem": "A single-period capacity expansion model for an islanded microgrid considers two technologies with capacity decision vector $x \\in \\mathbb{R}^2$, where $x_1$ is the installed capacity of Technology $1$ and $x_2$ is the installed capacity of Technology $2$. Investment costs are $c_1 = 3$ and $c_2 = 0.5$, and the period demand is $d = 5$. The dispatch (operational) variables are $y_1$, $y_2$, and $s$, where $y_1$ and $y_2$ are generation from Technologies $1$ and $2$, respectively, and $s$ is load shedding. Variable operating costs are $v_1 = 2$ and $v_2 = 6$, and the load shedding penalty is $p = 100$. All variables are constrained to be nonnegative.\n\nThe deterministic linear program that jointly decides investments and operations is:\nMinimize the total cost $c_1 x_1 + c_2 x_2 + v_1 y_1 + v_2 y_2 + p s$ subject to the operational feasibility constraints\n- $y_1 \\le x_1$,\n- $y_2 \\le x_2$,\n- $y_1 + y_2 + s \\ge d$,\n- $x_1 \\ge 0$, $x_2 \\ge 0$, $y_1 \\ge 0$, $y_2 \\ge 0$, $s \\ge 0$.\n\nUsing Benders Decomposition (BD) grounded in Linear Programming (LP) duality and the decomposition principle, decompose the problem into a master problem over $x_1$, $x_2$, and an auxiliary variable $\\theta$ that approximates the optimal operational cost, and a single operational subproblem over $(y_1,y_2,s)$ for any fixed $(x_1,x_2)$. Start the BD with the trivial initial cut $\\theta \\ge 0$. Then:\n\n1. Solve the first master problem to obtain $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)})$.\n2. For $(x_1^{(1)}, x_2^{(1)})$, solve the operational subproblem and, using strong duality of LPs, compute an optimal dual solution to derive the first Benders optimality cut. Add this cut to the master.\n3. Solve the second master problem to obtain $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)})$.\n4. For $(x_1^{(2)}, x_2^{(2)})$, solve the operational subproblem and compute an optimal dual solution to derive the second Benders optimality cut. Add this cut to the master.\n5. Solve the third master problem and verify that its solution $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta})$ satisfies $\\hat{\\theta}$ equal to the true operational cost at $(\\hat{x}_1, \\hat{x}_2)$, thereby showing convergence to the LP optimum.\n\nYou must explicitly compute the first two Benders cuts, the intermediate master solutions, and demonstrate convergence by matching the master’s lower bound and the primal feasible upper bound.\n\nWhat is the exact optimal total cost (investment plus operation) of the original LP? Report only the numerical value (no units, no rounding).",
            "solution": "### Problem Validation\n**Step 1: Extract Givens**\n- Decision variables: Investment capacities $x_1 \\in \\mathbb{R}, x_2 \\in \\mathbb{R}$. Operational variables: generation $y_1 \\in \\mathbb{R}, y_2 \\in \\mathbb{R}$, and load shedding $s \\in \\mathbb{R}$.\n- Cost coefficients: Investment costs $c_1 = 3, c_2 = 0.5$. Variable operating costs $v_1 = 2, v_2 = 6$. Load shedding penalty $p = 100$.\n- Demand: $d = 5$.\n- Full problem formulation (Primal LP):\n$$ \\min_{x,y,s} \\quad 3x_1 + 0.5x_2 + 2y_1 + 6y_2 + 100s $$\nSubject to:\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ x_1 \\ge 0, x_2 \\ge 0, y_1 \\ge 0, y_2 \\ge 0, s \\ge 0 $$\n- Decomposition requirements: Use Benders Decomposition (BD) starting with cut $\\theta \\ge 0$. Perform three master problem iterations.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard linear programming formulation for a capacity expansion problem, a well-established topic in operations research and energy systems modeling.\n- **Scientifically Grounded**: Yes. The problem is based on linear programming and the Benders decomposition principle, both of which are fundamental concepts in mathematical optimization.\n- **Well-Posed**: Yes. It is a linear program with a non-empty feasible region (e.g., $x_1=x_2=y_1=y_2=0, s=5$) and a cost function that is bounded below on the feasible set. Thus, an optimal solution exists.\n- **Objective**: Yes. The problem is stated using precise mathematical notation and objective language.\n- The setup is complete and internally consistent. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Benders Decomposition Procedure\n\nThe problem is structured for Benders decomposition. The investment variables $(x_1, x_2)$ are the first-stage (master) variables, and the operational variables $(y_1, y_2, s)$ are the second-stage (subproblem) variables.\n\nThe problem can be written as:\n$$ \\min_{x_1, x_2 \\ge 0} \\left( 3x_1 + 0.5x_2 + Q(x_1, x_2) \\right) $$\nwhere $Q(x_1, x_2)$ is the optimal value of the operational subproblem for a fixed $(x_1, x_2)$.\n\n**Operational Subproblem (SP):**\nFor a fixed capacity vector $x = (x_1, x_2)$, the subproblem is:\n$$ Q(x) = \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\nSubject to:\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n\n**Dual of the Operational Subproblem (DSP):**\nLet the dual variables associated with the three constraints be $\\pi_1 \\ge 0$, $\\pi_2 \\ge 0$, and $\\pi_3 \\ge 0$, respectively. The standard form for duality is $\\min c^T y$ s.t. $Ay \\ge b$. Here, we have $y_1 \\le x_1 \\implies -y_1 \\ge -x_1$ and $y_2 \\le x_2 \\implies -y_2 \\ge -x_2$.\nThe dual problem is:\n$$ \\max_{\\pi_1, \\pi_2, \\pi_3 \\ge 0} \\quad 5\\pi_1 - x_1\\pi_2 - x_2\\pi_3 $$\nSubject to:\n$$ \\pi_1 - \\pi_2 \\le 2 $$\n$$ \\pi_1 - \\pi_3 \\le 6 $$\n$$ \\pi_1 \\le 100 $$\nA Benders optimality cut is given by $\\theta \\ge 5\\pi_1^* - x_1\\pi_2^* - x_2\\pi_3^*$, where $(\\pi_1^*, \\pi_2^*, \\pi_3^*)$ is an optimal solution to the DSP for a given capacity vector from the master problem.\n\n**Iteration 1**\n1.  **Solve the first Master Problem (MP1):**\n    The initial master problem is:\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 0 $$\n    The minimum value is $0$, achieved at $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)}) = (0, 0, 0)$.\n    The current lower bound (LB) on the total cost is $0$.\n\n2.  **Solve SP1 for $x^{(1)}=(0, 0)$ and generate the first cut:**\n    With $x_1=0$ and $x_2=0$, the subproblem becomes:\n    $$ \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0$, $y_2 \\le 0$.\n    Non-negativity implies $y_1=0, y_2=0$. The demand constraint becomes $s \\ge 5$. To minimize cost, we set $s=5$.\n    The subproblem solution is $(y_1, y_2, s) = (0, 0, 5)$, with an operational cost of $Q(x^{(1)}) = 100 \\times 5 = 500$.\n    This provides an initial upper bound (UB) on the total cost: $c^T x^{(1)} + Q(x^{(1)}) = 0 + 500 = 500$.\n\n    To generate the cut, we solve the DSP with $x_1=0, x_2=0$:\n    $$ \\max \\quad 5\\pi_1 $$\n    s.t. $\\pi_1 - \\pi_2 \\le 2$, $\\pi_1 - \\pi_3 \\le 6$, $\\pi_1 \\le 100$, and $\\pi_1, \\pi_2, \\pi_3 \\ge 0$.\n    To maximize $5\\pi_1$, we make $\\pi_1$ as large as possible. From $\\pi_1 \\le 100$, we set $\\pi_1=100$. This is feasible if we can find valid $\\pi_2, \\pi_3$.\n    $100 - \\pi_2 \\le 2 \\implies \\pi_2 \\ge 98$. Choose $\\pi_2=98$.\n    $100 - \\pi_3 \\le 6 \\implies \\pi_3 \\ge 94$. Choose $\\pi_3=94$.\n    An optimal dual solution is $(\\pi_1^{(1)}, \\pi_2^{(1)}, \\pi_3^{(1)}) = (100, 98, 94)$. The DSP objective is $5(100) = 500$, matching the SP cost.\n    The first Benders optimality cut is $\\theta \\ge 5(100) - x_1(98) - x_2(94)$, which is $\\theta \\ge 500 - 98x_1 - 94x_2$.\n\n**Iteration 2**\n3.  **Solve the second Master Problem (MP2):**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 0 $$\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    The objective can be stated as $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2)$.\n    If $500 - 98x_1 - 94x_2 \\le 0$, we minimize $3x_1 + 0.5x_2$.\n    If $500 - 98x_1 - 94x_2 > 0$, we minimize $3x_1 + 0.5x_2 + 500 - 98x_1 - 94x_2 = -95x_1 - 93.5x_2 + 500$.\n    The overall objective is convex. The first term pushes the solution towards the origin, while the second pushes it away, indicating the minimum will be found on the boundary where $98x_1 + 94x_2 = 500$. We therefore analyze the cost $3x_1 + 0.5x_2$ on the line segment defined by $98x_1 + 94x_2 = 500$ for $x_1, x_2 \\ge 0$.\n    The cost to satisfy one unit of the constraint $98x_1 + 94x_2 = 500$ is $\\frac{3}{98} \\approx 0.0306$ using $x_1$ and $\\frac{0.5}{94} \\approx 0.0053$ using $x_2$. It is cheaper to use $x_2$.\n    The solution is at the corner point where $x_1=0$.\n    $94x_2 = 500 \\implies x_2 = \\frac{500}{94} = \\frac{250}{47}$.\n    The solution is $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)}) = (0, \\frac{250}{47}, 0)$.\n    The MP2 objective value is $3(0) + 0.5(\\frac{250}{47}) + 0 = \\frac{125}{47}$.\n    The new lower bound is $LB = \\frac{125}{47} \\approx 2.66$.\n\n4.  **Solve SP2 for $x^{(2)}=(0, \\frac{250}{47})$ and generate the second cut:**\n    The subproblem is:\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0 \\implies y_1=0$, and $y_2 \\le \\frac{250}{47}$.\n    The problem reduces to minimizing $6y_2 + 100s$ subject to $y_2+s \\ge 5$ and $y_2 \\le \\frac{250}{47} \\approx 5.32$.\n    Since the cost of generation $y_2$ ($6$/unit) is much less than load shedding $s$ ($100$/unit), we should use $y_2$ to meet the demand of $5$. As the capacity $\\frac{250}{47}$ exceeds the demand $5$, we can set $y_2=5$ and $s=0$.\n    The subproblem solution is $(y_1, y_2, s) = (0, 5, 0)$, with operational cost $Q(x^{(2)}) = 6 \\times 5 = 30$.\n    The new upper bound is $c^T x^{(2)} + Q(x^{(2)}) = \\frac{125}{47} + 30 = \\frac{125+1410}{47} = \\frac{1535}{47} \\approx 32.66$.\n\n    We solve the DSP with $x^{(2)}=(0, \\frac{250}{47})$. By complementary slackness on the SP solution:\n    - $y_2>0 \\implies$ dual constraint for $y_2$ is active: $\\pi_1-\\pi_3 = 6$.\n    - $y_2 < \\frac{250}{47}$ (capacity not binding) $\\implies \\pi_3=0$.\n    - Thus, $\\pi_1=6$.\n    - $y_1=0, s=0$ (non-basic) $\\implies$ their dual constraints may be slack.\n    The optimal dual values must satisfy all dual constraints. We have $\\pi_1=6, \\pi_3=0$. The remaining constraint is $\\pi_1-\\pi_2 \\le 2 \\implies 6-\\pi_2 \\le 2 \\implies \\pi_2 \\ge 4$. We can choose $\\pi_2=4$.\n    An optimal dual solution is $(\\pi_1^{(2)}, \\pi_2^{(2)}, \\pi_3^{(2)}) = (6, 4, 0)$.\n    The second Benders cut is $\\theta \\ge 5(6) - x_1(4) - x_2(0)$, which is $\\theta \\ge 30 - 4x_1$.\n\n**Iteration 3**\n5.  **Solve the third Master Problem (MP3) and verify convergence:**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    $$ \\theta \\ge 30 - 4x_1 $$\n    The objective is $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2, 30 - 4x_1)$.\n    The minimum will lie on the upper envelope of the cut functions. We analyze where the two cuts intersect:\n    $500 - 98x_1 - 94x_2 = 30 - 4x_1 \\implies 470 = 94x_1 + 94x_2 \\implies x_1 + x_2 = 5$.\n    On this line, the objective can be found by substituting one of the cut expressions for $\\theta$:\n    $z = 3x_1 + 0.5x_2 + (30 - 4x_1) = -x_1 + 0.5x_2 + 30$.\n    Now substitute $x_2=5-x_1$:\n    $z = -x_1 + 0.5(5-x_1) + 30 = -x_1 + 2.5 - 0.5x_1 + 30 = -1.5x_1 + 32.5$.\n    To minimize $z$, we must maximize $x_1$ along the segment $x_1+x_2=5$ where $x_1, x_2 \\ge 0$. This means $x_1 \\in [0, 5]$.\n    The maximum $x_1$ is $5$, which implies $x_2=0$.\n    The solution to MP3 is $(\\hat{x}_1, \\hat{x}_2) = (5, 0)$.\n    At this point, $\\hat{\\theta} = 30 - 4(5) = 10$. This is also consistent with the first cut: $500 - 98(5) - 94(0) = 500 - 490 = 10$.\n    The MP3 solution is $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta}) = (5, 0, 10)$.\n    The new lower bound is $LB = 3(5) + 0.5(0) + 10 = 25$.\n\n    **Convergence Check:** We solve the SP for $\\hat{x}=(5, 0)$.\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 5$, $y_2 \\le 0 \\implies y_2=0$.\n    The problem reduces to minimizing $2y_1 + 100s$ subject to $y_1+s \\ge 5$ and $y_1 \\le 5$.\n    The economic choice is to use $y_1$ at cost $2$ instead of $s$ at cost $100$. We set $y_1=5, s=0$.\n    The operational cost is $Q(\\hat{x}) = 2(5) = 10$.\n    We observe that $\\hat{\\theta} = 10$ from the master problem is equal to the subproblem cost $Q(\\hat{x}) = 10$. The Benders algorithm has converged.\n\n    The optimal total cost is the final lower bound from MP3 (which now equals the upper bound):\n    Total Cost = $c^T\\hat{x} + \\hat{\\theta} = 3(5) + 0.5(0) + 10 = 25$.\n    Alternatively, Total Cost = $c^T\\hat{x} + Q(\\hat{x}) = 15 + 10 = 25$.\n\nThe exact optimal total cost is $25$.",
            "answer": "$$ \\boxed{25} $$"
        },
        {
            "introduction": "A robust Benders decomposition framework must be able to handle cases where a master problem's proposed solution leads to an infeasible subproblem. This practice problem delves into this critical scenario, challenging you to distinguish between optimality cuts and feasibility cuts. You will use the principles of linear programming duality to identify an infeasible subproblem and derive a feasibility cut from an extreme ray of the dual, thereby learning how to guide the master problem back toward a workable solution space .",
            "id": "4071643",
            "problem": "Consider a two-stage linear energy planning model in which the first stage decides installed capacities and the second stage dispatches generation to meet demand. The first-stage (master) variables are installed capacities $x_{A}$ and $x_{B}$ (in megawatts, MW) for two technologies $A$ and $B$. The second-stage (operational) subproblem, for a given $(x_{A}, x_{B})$, chooses period-wise dispatch $y_{A,1}$, $y_{B,1}$, $y_{A,2}$, $y_{B,2}$ (in MW) to minimize operating costs subject to demand satisfaction and capacity availability constraints without load shedding.\n\nThe operational subproblem is\n$$\n\\begin{aligned}\n\\min_{y_{A,1},y_{B,1},y_{A,2},y_{B,2}} \\quad & c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} + c_{A,2}\\,y_{A,2} + c_{B,2}\\,y_{B,2} \\\\\n\\text{s.t.} \\quad & y_{A,1} + y_{B,1} \\ge d_{1}, \\\\\n& y_{A,2} + y_{B,2} \\ge d_{2}, \\\\\n& y_{A,1} \\le a_{A,1}\\,x_{A}, \\\\\n& y_{B,1} \\le a_{B,1}\\,x_{B}, \\\\\n& y_{A,2} \\le a_{A,2}\\,x_{A}, \\\\\n& y_{B,2} \\le a_{B,2}\\,x_{B}, \\\\\n& y_{A,1},y_{B,1},y_{A,2},y_{B,2} \\ge 0,\n\\end{aligned}\n$$\nwhere $d_{1}$ and $d_{2}$ are period demands and $a_{g,t}$ are availability factors (dimensionless) mapping installed capacity to available capacity in each period. Suppose $d_{1} = 95$, $d_{2} = 60$, $a_{A,1} = 0.40$, $a_{B,1} = 0.50$, $a_{A,2} = 0.90$, $a_{B,2} = 0.60$, and current master-stage iterate values are $\\hat{x}_{A} = 120$ and $\\hat{x}_{B} = 50$. The operating cost coefficients $c_{g,t}$ are arbitrary finite nonnegative numbers and need not be specified to analyze feasibility.\n\nIn the context of Benders decomposition (also called the L-shaped method), explain from first principles the distinction between feasibility cuts and optimality cuts in terms of linear programming duality and extreme rays versus extreme points. Then, for the specific data above, identify the source of infeasibility in the operational subproblem and derive a Benders feasibility cut associated with the infeasible period. Your derivation must start from a valid base in linear programming duality and the characterization of infeasibility via extreme rays, and it must produce a linear cut in the master variables that excludes the infeasible $(\\hat{x}_{A}, \\hat{x}_{B})$ and enforces subproblem feasibility for the problematic period.\n\nCompute the feasibility cut as a single linear expression $\\phi(x_{A}, x_{B})$ whose nonpositivity guarantees feasibility of the operational subproblem’s period $1$ for any $(x_{A}, x_{B})$. Express your final expression in megawatts (MW). No rounding is required.",
            "solution": "The problem requires a principled explanation of Benders feasibility and optimality cuts, followed by the derivation of a specific feasibility cut for a given two-stage energy planning model.\n\nFirst, the problem is validated.\n\n**Step 1: Extract Givens**\n- Master variables (installed capacities, MW): $x_{A}$, $x_{B}$\n- Second-stage variables (dispatch, MW): $y_{A,1}$, $y_{B,1}$, $y_{A,2}$, $y_{B,2}$\n- Operational subproblem objective function: $\\min_{y} \\sum_{g,t} c_{g,t} y_{g,t}$, where $c_{g,t} \\ge 0$ are finite costs.\n- Operational subproblem constraints:\n  - $y_{A,1} + y_{B,1} \\ge d_{1}$\n  - $y_{A,2} + y_{B,2} \\ge d_{2}$\n  - $y_{A,1} \\le a_{A,1}\\,x_{A}$\n  - $y_{B,1} \\le a_{B,1}\\,x_{B}$\n  - $y_{A,2} \\le a_{A,2}\\,x_{A}$\n  - $y_{B,2} \\le a_{B,2}\\,x_{B}$\n  - $y_{A,1}, y_{B,1}, y_{A,2}, y_{B,2} \\ge 0$\n- Data:\n  - Demand period $1$: $d_{1} = 95$ MW\n  - Demand period $2$: $d_{2} = 60$ MW\n  - Availability factors: $a_{A,1} = 0.40$, $a_{B,1} = 0.50$, $a_{A,2} = 0.90$, $a_{B,2} = 0.60$\n- Current master-stage iterate: $\\hat{x}_{A} = 120$ MW, $\\hat{x}_{B} = 50$ MW\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard application of Benders decomposition to a two-stage stochastic linear program, a canonical topic in operations research and energy systems modeling. It is scientifically grounded and objective. To check for consistency, we evaluate the feasibility of the operational subproblem at the given iterate $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$. The operational subproblem decouples by time period.\n\nFor period $1$, the constraints on generation are:\n- $y_{A,1} \\le a_{A,1}\\,\\hat{x}_{A} = 0.40 \\times 120 = 48$ MW\n- $y_{B,1} \\le a_{B,1}\\,\\hat{x}_{B} = 0.50 \\times 50 = 25$ MW\nThe maximum possible generation in period $1$ is $y_{A,1} + y_{B,1} \\le 48 + 25 = 73$ MW.\nThe demand is $d_{1} = 95$ MW.\nSince the maximum possible generation ($73$ MW) is less than the demand ($95$ MW), the demand constraint $y_{A,1} + y_{B,1} \\ge 95$ cannot be satisfied. Thus, the operational subproblem for period $1$ is infeasible.\n\nFor period $2$, the maximum generation is $a_{A,2}\\,\\hat{x}_{A} + a_{B,2}\\,\\hat{x}_{B} = 0.90 \\times 120 + 0.60 \\times 50 = 108 + 30 = 138$ MW. The demand is $d_{2} = 60$ MW. Since $138 > 60$, the subproblem for period $2$ is feasible.\n\nThe overall operational subproblem is infeasible due to the infeasibility in period $1$. The problem setup is consistent and well-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Part 1: Distinction between Optimality and Feasibility Cuts**\n\nBenders decomposition solves problems of the form:\n$$\n\\min_{x, \\theta} \\quad c^T x + \\theta \\\\\n\\text{s.t.} \\quad x \\in X \\\\\n\\theta \\ge Q(x)\n$$\nwhere $Q(x)$ is the optimal value of a second-stage linear program (the subproblem) parameterized by the first-stage decisions $x$:\n$$\nQ(x) = \\min_{y} \\quad q^T y \\\\\n\\text{s.t.} \\quad Ty + Wy \\ge h\n$$\nHere, for notational simplicity, we assume the dependence on $x$ is captured by matrix $T$ and right-hand side vector $h$, such that the constraints are $Wy \\ge h - Tx$. In our problem, $x = (x_A, x_B)^T$ and $y$ is the vector of dispatch variables. The algorithm iteratively approximates the function $Q(x)$ by adding linear constraints (cuts) to the master problem.\n\nAn **optimality cut** is generated when the subproblem is feasible and bounded for a given master-problem solution $\\hat{x}$. By linear programming duality, the dual of the subproblem is:\n$$\n\\max_{\\pi} \\quad (h - T\\hat{x})^T \\pi \\\\\n\\text{s.t.} \\quad W^T \\pi \\le q, \\quad \\pi \\ge 0\n$$\nLet $\\hat{\\pi}$ be an optimal solution to this dual problem. $\\hat{\\pi}$ is an extreme point of the dual feasible region. By strong duality, $Q(\\hat{x}) = (h - T\\hat{x})^T \\hat{\\pi}$. Since $Q(x)$ is a convex function, this provides a supporting hyperplane to its epigraph. The resulting constraint, known as an optimality cut, is added to the master problem:\n$$\n\\theta \\ge (h - Tx)^T \\hat{\\pi}\n$$\nThis cut enforces a lower bound on $\\theta$ for all $x$, ensuring that $\\theta$ will eventually converge to the true subproblem cost for the optimal $x$.\n\nA **feasibility cut** is generated when the subproblem is infeasible for a given master-problem solution $\\hat{x}$. An infeasible primal LP implies that its dual is either unbounded or infeasible. In the context of Benders decomposition, the dual subproblem is constructed to be always feasible (e.g., $\\pi=0$ is often a feasible solution), so it must be unbounded.\n\nThe unboundedness of the dual implies the existence of an extreme ray of the dual feasible region's recession cone. This recession cone is defined by $\\{ \\bar{\\pi} \\mid W^T \\bar{\\pi} \\le 0, \\bar{\\pi} \\ge 0 \\}$. An extreme ray, represented by a vector $\\bar{\\pi}$, is a direction of unboundedness if the dual objective increases along it, i.e., $(h - T\\hat{x})^T \\bar{\\pi} > 0$. This condition is a certificate of the primal's infeasibility, a result encapsulated by Farkas' Lemma.\n\nFor the primal subproblem to be feasible for any a given $x$, its dual must not be unbounded. This requires that for every extreme ray $\\bar{\\pi}$ of the dual cone, the objective change along that ray must be non-positive:\n$$\n(h - Tx)^T \\bar{\\pi} \\le 0\n$$\nThis inequality is a Benders feasibility cut. It is a constraint on the master variables $x$ themselves, not on $\\theta$, and it \"cuts off\" the infeasible master solution $\\hat{x}$ from the feasible set of the master problem.\n\n**Part 2: Derivation of the Feasibility Cut**\n\nThe overall subproblem is infeasible because the constraints for period $1$ cannot be met. We focus on this problematic period. The subproblem for period $1$ is:\n$$\n\\begin{aligned}\n\\min_{y_{A,1}, y_{B,1}} \\quad & c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} \\\\\n\\text{s.t.} \\quad & y_{A,1} + y_{B,1} \\ge d_{1} \\\\\n& y_{A,1} \\le a_{A,1}\\,x_{A} \\\\\n& y_{B,1} \\le a_{B,1}\\,x_{B} \\\\\n& y_{A,1}, y_{B,1} \\ge 0\n\\end{aligned}\n$$\nTo apply duality theory, we rewrite the constraints in standard form $Ay \\ge b$:\n$$\n\\begin{aligned}\ny_{A,1} + y_{B,1} \\ge d_{1} \\quad &(\\text{dual variable } \\pi_1 \\ge 0) \\\\\n-y_{A,1} \\ge -a_{A,1}\\,x_{A} \\quad &(\\text{dual variable } \\pi_2 \\ge 0) \\\\\n-y_{B,1} \\ge -a_{B,1}\\,x_{B} \\quad &(\\text{dual variable } \\pi_3 \\ge 0)\n\\end{aligned}\n$$\nThe dual problem is:\n$$\n\\begin{aligned}\n\\max_{\\pi_1, \\pi_2, \\pi_3} \\quad & d_1 \\pi_1 - a_{A,1}x_A \\pi_2 - a_{B,1}x_B \\pi_3 \\\\\n\\text{s.t.} \\quad & \\pi_1 - \\pi_2 \\le c_{A,1} \\\\\n& \\pi_1 - \\pi_3 \\le c_{B,1} \\\\\n& \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{aligned}\n$$\nThe primal is infeasible for $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$, so the dual must be unbounded. We need to find an extreme ray of the dual's recession cone. The cone is defined by the homogeneous dual constraints:\n$$\n\\begin{aligned}\n& \\bar{\\pi}_1 - \\bar{\\pi}_2 \\le 0 \\\\\n& \\bar{\\pi}_1 - \\bar{\\pi}_3 \\le 0 \\\\\n& \\bar{\\pi}_1, \\bar{\\pi}_2, \\bar{\\pi}_3 \\ge 0\n\\end{aligned}\n$$\nAn extreme ray is found by setting $n-1 = 3-1 = 2$ constraints to be binding. Let's set $\\bar{\\pi}_1 - \\bar{\\pi}_2 = 0$ and $\\bar{\\pi}_1 - \\bar{\\pi}_3 = 0$. This implies $\\bar{\\pi}_1 = \\bar{\\pi}_2 = \\bar{\\pi}_3$. We can choose a representative vector for this ray by setting $\\bar{\\pi}_1 = 1$, giving the ray direction $\\bar{\\pi} = (1, 1, 1)^T$.\n\nWe must verify that this ray leads to an unbounded objective for the iterate $(\\hat{x}_{A}, \\hat{x}_{B})$. The change in objective along this ray is:\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}\\hat{x}_A \\bar{\\pi}_2 - a_{B,1}\\hat{x}_B \\bar{\\pi}_3 = d_1(1) - a_{A,1}\\hat{x}_A(1) - a_{B,1}\\hat{x}_B(1)\n$$\nSubstituting the given values:\n$$\n95 - (0.40)(120) - (0.50)(50) = 95 - 48 - 25 = 22\n$$\nSince $22 > 0$, the objective increases along this ray, confirming the dual is unbounded and $\\bar{\\pi}=(1,1,1)^T$ is a valid ray of ascent.\n\nThe Benders feasibility cut is derived from the condition that for any feasible master solution $(x_{A}, x_{B})$, the dual objective must not be unbounded along this ray. This means the change in objective must be non-positive:\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}x_A \\bar{\\pi}_2 - a_{B,1}x_B \\bar{\\pi}_3 \\le 0\n$$\nSubstituting the ray components $\\bar{\\pi}=(1,1,1)^T$:\n$$\nd_1(1) - a_{A,1}x_A (1) - a_{B,1}x_B (1) \\le 0\n$$\nPlugging in the constant values:\n$$\n95 - 0.40 x_A - 0.50 x_B \\le 0\n$$\nThis cut correctly excludes the infeasible point $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$, as $95 - 0.40(120) - 0.50(50) = 22 \\not\\le 0$. The cut mandates that the total available capacity in period $1$ must be at least equal to the demand, i.e., $a_{A,1}x_A + a_{B,1}x_B \\ge d_1$.\n\nThe problem asks for the expression $\\phi(x_{A}, x_{B})$ such that the cut is $\\phi(x_{A}, x_{B}) \\le 0$. Therefore, the expression is:\n$$\n\\phi(x_{A}, x_{B}) = 95 - 0.40 x_A - 0.50 x_B\n$$\nThe units of this expression are MW, as $95$ is in MW, and the terms $0.40 x_A$ and $0.50 x_B$ are also in MW (dimensionless factor times MW).",
            "answer": "$$\\boxed{95 - 0.40 x_{A} - 0.50 x_{B}}$$"
        },
        {
            "introduction": "We now turn to Dantzig-Wolfe decomposition, a powerful technique often applied to problems with a block-angular structure, such as unit commitment. The heart of its solution method, column generation, relies on efficiently solving a \"pricing subproblem\" to find cost-improving schedules. This exercise demonstrates how to formulate and solve this subproblem for a single generating unit using Dynamic Programming, leveraging the temporal structure of the schedule to find the optimal operating plan with the most negative reduced cost .",
            "id": "4071658",
            "problem": "Consider a single thermal generator participating in a Dantzig-Wolfe decomposition (column generation) of a long-horizon unit commitment model in energy systems modeling. In column generation, the master problem selects convex combinations of feasible temporal schedules, and the pricing subproblem for each generator searches for a new schedule (a column) with negative reduced cost. Use the principle of optimality from Dynamic Programming (DP) to formulate the pricing subproblem as a stage-wise optimization over time.\n\nAssume the following scientifically realistic and self-consistent setting. Time is discretized into $4$ periods of equal duration of $1$ hour. The generator’s feasible output per period is discretized to the set $\\{0, 50, 100\\}$ megawatts, with symmetric ramp-rate limits of $50$ megawatts between consecutive periods. The generator is initially off with zero output, so $x_{0} = 0$. A start-up cost applies when output transitions from $0$ to a strictly positive level. A no-load cost applies when the unit is on (positive output). Variable generation costs are linear in output. Let the parameters be:\n- Per-period variable generation cost coefficients $c_{t}$ in $\\$/\\text{MWh}$: $c_{1} = 30$, $c_{2} = 25$, $c_{3} = 35$, $c_{4} = 40$.\n- Dual multipliers from the master problem for the energy balance constraint $\\pi_{t}$ in $\\$/\\text{MWh}$: $\\pi_{1} = 28$, $\\pi_{2} = 65$, $\\pi_{3} = 20$, $\\pi_{4} = 55$.\n- No-load cost $L$ in dollars per period: $L = $500.\n- Start-up cost $S$ in dollars per start-up: $S = $1500.\n- Ramp-rate limit $R$ in megawatts per period: $R = 50$.\n\nA column (schedule) is a sequence $(x_{1}, x_{2}, x_{3}, x_{4})$ that satisfies the discrete output set and ramp constraints $|x_{t} - x_{t-1}| \\leq R$ for all $t \\in \\{1, 2, 3, 4\\}$, with $x_{0} = 0$. The reduced cost of a schedule is its total operating cost (start-up, no-load, and variable costs) minus the dual-weighted energy value $\\sum_{t=1}^{4} \\pi_{t} x_{t}$.\n\nTask:\n- Derive a Dynamic Programming (DP) formulation for the pricing subproblem. Clearly define the state, decision, feasible transitions imposed by ramp limits, and the stage cost that incorporates start-up and no-load costs. Derive the Bellman recursion for the cost-to-go.\n- Using the provided data, compute the minimal reduced cost over all feasible schedules by solving the derived DP recursion. Express the final reduced cost in dollars. Give the exact value (no rounding).",
            "solution": "The user's request is to formulate and solve a pricing subproblem from a Dantzig-Wolfe decomposition of a unit commitment model using Dynamic Programming (DP).\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Time Horizon**: $4$ periods, each of $1$ hour duration. Let the set of time periods be $\\mathcal{T} = \\{1, 2, 3, 4\\}$.\n- **Generator Output Levels**: The output in period $t$, denoted $x_t$, must be in the set $\\{0, 50, 100\\}$ MW.\n- **Initial State**: The generator output before the first period is $x_{0} = 0$ MW.\n- **Ramp-Rate Limit**: The change in output between consecutive periods is limited by $R = 50$ MW. That is, $|x_t - x_{t-1}| \\leq R$ for $t \\in \\{1, 2, 3, 4\\}$.\n- **Variable Generation Cost Coefficients**: $c_1 = 30$, $c_2 = 25$, $c_3 = 35$, $c_4 = 40$ in $/MWh.\n- **Master Problem Dual Multipliers**: $\\pi_1 = 28$, $\\pi_2 = 65$, $\\pi_3 = 20$, $\\pi_4 = 55$ in $/MWh.\n- **No-load Cost**: $L = 500$ $ per period when the unit is on (i.e., $x_t > 0$).\n- **Start-up Cost**: $S = 1500$ $ per start-up event (i.e., when $x_{t-1} = 0$ and $x_t > 0$).\n- **Objective**: Find the minimum reduced cost of a feasible schedule $(x_1, x_2, x_3, x_4)$.\n- **Reduced Cost Definition**: The total operating cost (variable, no-load, and start-up costs) minus the dual-weighted energy value $\\sum_{t=1}^{4} \\pi_{t} x_{t}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it represents a standard unit commitment subproblem solved via dynamic programming. This is a common and fundamental problem in energy systems optimization and operations research. The problem is well-posed, with a finite state space, finite time horizon, and a clear objective function to minimize, ensuring a unique solution exists. The data is complete, consistent, and numerically specified. The language is precise and objective. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n### Dynamic Programming Formulation\n\nThe pricing subproblem seeks to find a feasible schedule that minimizes the reduced cost. This can be framed as a shortest path problem on a directed acyclic graph, which is efficiently solved using Dynamic Programming.\n\n- **Stages**: The stages are the discrete time periods, $t \\in \\{1, 2, 3, 4\\}$.\n- **State**: The state at the beginning of stage $t$ must capture all necessary information from the past to make future decisions. The ramp-rate constraint $|x_t - x_{t-1}| \\leq R$ depends on the previous output $x_{t-1}$, and the start-up cost depends on whether the unit was off in the previous period ($x_{t-1}=0$). Therefore, the state at the beginning of stage $t$ is the generator's output level in the previous period, $s_t = x_{t-1}$. The state space is the set of possible output levels, $\\mathcal{X} = \\{0, 50, 100\\}$.\n- **Decision**: The decision at stage $t$, given state $s_t = x_{t-1}$, is to choose the output level for the current period, $d_t = x_t$. The set of feasible decisions is constrained by the ramp-rate limit: $d_t \\in \\{x \\in \\mathcal{X} : |x - s_t| \\leq R\\}$.\n- **Stage Cost**: The cost incurred at stage $t$ is the period's reduced cost, which depends on the state $x_{t-1}$ and the decision $x_t$. The reduced cost for period $t$ is given by:\n$$ \\text{OperatingCost}_t - \\pi_t x_t = (c_t x_t + L \\cdot \\mathbf{1}(x_t>0) + S \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ and } x_t>0)) - \\pi_t x_t $$\nwhere $\\mathbf{1}(\\cdot)$ is the indicator function. Let's define the stage cost function $C_t(x_{t-1}, x_t)$ as:\n$$ C_t(x_{t-1}, x_t) = (c_t - \\pi_t)x_t + L \\cdot \\mathbf{1}(x_t>0) + S \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ and } x_t>0) $$\nThe duration of each period is $1$ hour, so the energy produced is numerically equal to the power output.\n\n- **Bellman Recursion (Cost-to-Go)**: Let $J_t(s)$ be the minimum cumulative reduced cost from period $1$ up to the end of period $t$, with the generator's output being $s$ in period $t$ (i.e., $x_t = s$). We use a forward recursion.\nThe initial condition is defined by the state at $t=0$. We are given $x_0 = 0$. We can define the cost to be in this state as $J_0(0) = 0$, and $J_0(s) = \\infty$ for any other state $s \\in \\{50, 100\\}$.\nThe Bellman recursion for $t=1, \\dots, 4$ and for each possible state $x_t \\in \\mathcal{X}$ is:\n$$ J_t(x_t) = \\min_{x_{t-1} \\in \\mathcal{X} \\text{ s.t. } |x_t - x_{t-1}| \\le R} \\{ J_{t-1}(x_{t-1}) + C_t(x_{t-1}, x_t) \\} $$\nThe final answer, the minimal reduced cost over the entire horizon, is the minimum of the cost-to-go values at the final stage:\n$$ \\min \\text{RC} = \\min_{x_4 \\in \\mathcal{X}} J_4(x_4) $$\n\n### Solving the DP Recursion\n\nFirst, we compute the net variable cost coefficients, $c'_t = c_t - \\pi_t$:\n- $c'_1 = c_1 - \\pi_1 = 30 - 28 = 2$ $/MWh\n- $c'_2 = c_2 - \\pi_2 = 25 - 65 = -40$ $/MWh\n- $c'_3 = c_3 - \\pi_3 = 35 - 20 = 15$ $/MWh\n- $c'_4 = c_4 - \\pi_4 = 40 - 55 = -15$ $/MWh\n\nThe stage cost is $C_t(x_{t-1}, x_t) = c'_t x_t + 500 \\cdot \\mathbf{1}(x_t>0) + 1500 \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ and } x_t>0)$.\n\n**Initial Stage ($t=0$)**:\n$J_0(0) = 0$\n$J_0(50) = \\infty$\n$J_0(100) = \\infty$\n\n**Stage 1 ($t=1$)**:\nThe only possible previous state is $x_0=0$.\n$J_1(0) = J_0(0) + C_1(0, 0) = 0 + (2 \\cdot 0 + 0 + 0) = 0$.\n$J_1(50) = J_0(0) + C_1(0, 50) = 0 + (2 \\cdot 50 + 500 + 1500) = 100 + 2000 = 2100$.\n$J_1(100)$ is not reachable from $x_0=0$ since $|100 - 0| > 50$, so $J_1(100) = \\infty$.\n\n**Stage 2 ($t=2$)**:\n$J_2(0) = \\min\\{J_1(0)+C_2(0,0), J_1(50)+C_2(50,0)\\} = \\min\\{0+0, 2100+0\\} = 0$.\n$J_2(50) = \\min\\{J_1(0)+C_2(0,50), J_1(50)+C_2(50,50)\\}$.\n$C_2(0,50) = -40 \\cdot 50 + 500 + 1500 = -2000 + 2000 = 0$.\n$C_2(50,50) = -40 \\cdot 50 + 500 = -1500$.\n$J_2(50) = \\min\\{0+0, 2100-1500\\} = \\min\\{0, 600\\} = 0$.\n$J_2(100) = \\min\\{J_1(50)+C_2(50,100), J_1(100)+C_2(100,100)\\}$.\n$C_2(50,100) = -40 \\cdot 100 + 500 = -3500$.\n$J_2(100) = \\min\\{2100-3500, \\infty\\} = -1400$.\n\nSo, at the end of stage 2: $J_2(0)=0, J_2(50)=0, J_2(100)=-1400$.\n\n**Stage 3 ($t=3$)**:\n$J_3(0) = \\min\\{J_2(0)+C_3(0,0), J_2(50)+C_3(50,0)\\} = \\min\\{0+0, 0+0\\} = 0$.\n$J_3(50) = \\min\\{J_2(0)+C_3(0,50), J_2(50)+C_3(50,50), J_2(100)+C_3(100,50)\\}$.\n$C_3(0,50) = 15 \\cdot 50 + 500 + 1500 = 750 + 2000 = 2750$.\n$C_3(50,50) = 15 \\cdot 50 + 500 = 1250$.\n$C_3(100,50) = 15 \\cdot 50 + 500 = 1250$.\n$J_3(50) = \\min\\{0+2750, 0+1250, -1400+1250\\} = \\min\\{2750, 1250, -150\\} = -150$.\n$J_3(100) = \\min\\{J_2(50)+C_3(50,100), J_2(100)+C_3(100,100)\\}$.\n$C_3(50,100) = 15 \\cdot 100 + 500 = 2000$.\n$C_3(100,100) = 15 \\cdot 100 + 500 = 2000$.\n$J_3(100) = \\min\\{0+2000, -1400+2000\\} = \\min{2000, 600} = 600$.\n\nSo, at the end of stage 3: $J_3(0)=0, J_3(50)=-150, J_3(100)=600$.\n\n**Stage 4 ($t=4$)**:\n$J_4(0) = \\min\\{J_3(0)+C_4(0,0), J_3(50)+C_4(50,0)\\} = \\min\\{0+0, -150+0\\} = -150$.\n$J_4(50) = \\min\\{J_3(0)+C_4(0,50), J_3(50)+C_4(50,50), J_3(100)+C_4(100,50)\\}$.\n$C_4(0,50) = -15 \\cdot 50 + 500 + 1500 = -750 + 2000 = 1250$.\n$C_4(50,50) = -15 \\cdot 50 + 500 = -250$.\n$C_4(100,50) = -15 \\cdot 50 + 500 = -250$.\n$J_4(50) = \\min\\{0+1250, -150-250, 600-250\\} = \\min\\{1250, -400, 350\\} = -400$.\n$J_4(100) = \\min\\{J_3(50)+C_4(50,100), J_3(100)+C_4(100,100)\\}$.\n$C_4(50,100) = -15 \\cdot 100 + 500 = -1000$.\n$C_4(100,100) = -15 \\cdot 100 + 500 = -1000$.\n$J_4(100) = \\min\\{-150-1000, 600-1000\\} = \\min\\{-1150, -400\\} = -1150$.\n\n**Final Result**:\nThe minimum reduced cost is the minimum of the costs at the final stage:\n$$ \\min \\text{RC} = \\min\\{J_4(0), J_4(50), J_4(100)\\} = \\min\\{-150, -400, -1150\\} = -1150 $$\nThe minimal reduced cost is $-1150$ dollars, which corresponds to the schedule $(x_1, x_2, x_3, x_4) = (50, 100, 50, 100)$.",
            "answer": "$$\\boxed{-1150}$$"
        }
    ]
}