{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习将带你具体地、一步步地演练 Benders 分解算法。通过求解一个小型容量扩张问题，你将亲手生成最优性割，并观察主问题的下界如何收敛到真实的全局最优成本，从而对该方法的运作机制建立起扎实的直观理解。",
            "id": "4071612",
            "problem": "一个孤岛微电网的单周期容量扩张模型考虑了两种技术，其容量决策向量为 $x \\in \\mathbb{R}^2$，其中 $x_1$ 是技术1的装机容量，$x_2$ 是技术2的装机容量。投资成本为 $c_1 = 3$ 和 $c_2 = 0.5$，周期需求为 $d = 5$。调度（运行）变量为 $y_1$、$y_2$ 和 $s$，其中 $y_1$ 和 $y_2$ 分别是技术1和技术2的发电量，$s$ 是切负荷量。可变运行成本为 $v_1 = 2$ 和 $v_2 = 6$，切负荷惩罚为 $p = 100$。所有变量都约束为非负。\n\n联合决定投资和运行的确定性线性规划为：\n最小化总成本 $c_1 x_1 + c_2 x_2 + v_1 y_1 + v_2 y_2 + p s$，并满足以下运行可行性约束\n- $y_1 \\le x_1$,\n- $y_2 \\le x_2$,\n- $y_1 + y_2 + s \\ge d$,\n- $x_1 \\ge 0$, $x_2 \\ge 0$, $y_1 \\ge 0$, $y_2 \\ge 0$, $s \\ge 0$.\n\n使用基于线性规划 (LP) 对偶和分解原理的 Benders 分解法 (BD)，将问题分解为一个关于 $x_1$、$x_2$ 和一个近似最优运行成本的辅助变量 $\\theta$ 的主问题，以及一个对于任意固定的 $(x_1,x_2)$ 的关于 $(y_1,y_2,s)$ 的单一运行子问题。以平凡的初始割平面 $\\theta \\ge 0$ 开始 BD。然后：\n\n1. 求解第一个主问题以获得 $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)})$。\n2. 对于 $(x_1^{(1)}, x_2^{(1)})$，求解运行子问题，并利用LP的强对偶性，计算一个最优对偶解以推导第一个 Benders 最优性割。将此割平面添加到主问题中。\n3. 求解第二个主问题以获得 $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)})$。\n4. 对于 $(x_1^{(2)}, x_2^{(2)})$，求解运行子问题并计算一个最优对偶解以推导第二个 Benders 最优性割。将此割平面添加到主问题中。\n5. 求解第三个主问题，并验证其解 $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta})$ 满足 $\\hat{\\theta}$ 等于在 $(\\hat{x}_1, \\hat{x}_2)$ 处的真实运行成本，从而证明收敛到 LP 最优解。\n\n您必须明确计算前两个 Benders 割、中间主问题的解，并通过匹配主问题的下界和原始可行上界来证明收敛。\n\n原始LP的精确最优总成本（投资加运行）是多少？仅报告数值（无单位，不四舍五入）。",
            "solution": "### 问题验证\n**步骤1：提取已知条件**\n- 决策变量：投资容量 $x_1 \\in \\mathbb{R}, x_2 \\in \\mathbb{R}$。运行变量：发电量 $y_1 \\in \\mathbb{R}, y_2 \\in \\mathbb{R}$，以及切负荷量 $s \\in \\mathbb{R}$。\n- 成本系数：投资成本 $c_1 = 3, c_2 = 0.5$。可变运行成本 $v_1 = 2, v_2 = 6$。切负荷惩罚 $p = 100$。\n- 需求：$d = 5$。\n- 完整问题表述（原始LP）：\n$$ \\min_{x,y,s} \\quad 3x_1 + 0.5x_2 + 2y_1 + 6y_2 + 100s $$\n满足约束：\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ x_1 \\ge 0, x_2 \\ge 0, y_1 \\ge 0, y_2 \\ge 0, s \\ge 0 $$\n- 分解要求：使用 Benders 分解法 (BD)，从割平面 $\\theta \\ge 0$ 开始。执行三次主问题迭代。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是容量扩张问题的标准线性规划表述，是运筹学和能源系统建模中的一个成熟课题。\n- **有科学依据**：是的。该问题基于线性规划和 Benders 分解原理，这两者都是数学优化的基本概念。\n- **适定性**：是的。这是一个线性规划问题，其可行域非空（例如，$x_1=x_2=y_1=y_2=0, s=5$），且成本函数在可行集上有下界。因此，存在最优解。\n- **目标明确**：是的。问题使用精确的数学符号和客观的语言陈述。\n- 问题设置完整且内部一致。未发现任何缺陷。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n### Benders 分解过程\n\n该问题为 Benders 分解而结构化。投资变量 $(x_1, x_2)$ 是第一阶段（主问题）变量，运行变量 $(y_1, y_2, s)$ 是第二阶段（子问题）变量。\n\n问题可以写成：\n$$ \\min_{x_1, x_2 \\ge 0} \\left( 3x_1 + 0.5x_2 + Q(x_1, x_2) \\right) $$\n其中 $Q(x_1, x_2)$ 是对于一个固定的 $(x_1, x_2)$，运行子问题的最优值。\n\n**运行子问题 (SP):**\n对于一个固定的容量向量 $x = (x_1, x_2)$，子问题是：\n$$ Q(x) = \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n满足约束：\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n\n**运行子问题的对偶问题 (DSP):**\n设与三个约束相关的对偶变量分别为 $\\pi_1 \\ge 0$、$\\pi_2 \\ge 0$ 和 $\\pi_3 \\ge 0$。对偶的标准形式是 $\\min c^T y$ s.t. $Ay \\ge b$。在这里，我们有 $y_1 \\le x_1 \\implies -y_1 \\ge -x_1$ 和 $y_2 \\le x_2 \\implies -y_2 \\ge -x_2$。\n对偶问题是：\n$$ \\max_{\\pi_1, \\pi_2, \\pi_3 \\ge 0} \\quad 5\\pi_1 - x_1\\pi_2 - x_2\\pi_3 $$\n满足约束：\n$$ \\pi_1 - \\pi_2 \\le 2 $$\n$$ \\pi_1 - \\pi_3 \\le 6 $$\n$$ \\pi_1 \\le 100 $$\nBenders 最优性割由 $\\theta \\ge 5\\pi_1^* - x_1\\pi_2^* - x_2\\pi_3^*$ 给出，其中 $(\\pi_1^*, \\pi_2^*, \\pi_3^*)$ 是对于主问题给出的特定容量向量，其对偶子问题的最优解。\n\n**迭代 1**\n1.  **求解第一个主问题 (MP1):**\n    初始主问题是：\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    满足约束：\n    $$ \\theta \\ge 0 $$\n    最小值为 $0$，在 $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)}) = (0, 0, 0)$ 处取得。\n    当前总成本的下界 (LB) 是 $0$。\n\n2.  **对 $x^{(1)}=(0, 0)$ 求解子问题 SP1 并生成第一个割平面:**\n    当 $x_1=0$ 和 $x_2=0$ 时，子问题变为：\n    $$ \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n    满足 $y_1+y_2+s \\ge 5$, $y_1 \\le 0$, $y_2 \\le 0$。\n    非负性意味着 $y_1=0, y_2=0$。需求约束变为 $s \\ge 5$。为了最小化成本，我们设置 $s=5$。\n    子问题的解是 $(y_1, y_2, s) = (0, 0, 5)$，运行成本为 $Q(x^{(1)}) = 100 \\times 5 = 500$。\n    这提供了总成本的一个初始上界 (UB)：$c^T x^{(1)} + Q(x^{(1)}) = 0 + 500 = 500$。\n\n    为了生成割平面，我们求解 $x_1=0, x_2=0$ 的对偶子问题 (DSP)：\n    $$ \\max \\quad 5\\pi_1 $$\n    满足 $\\pi_1 - \\pi_2 \\le 2$, $\\pi_1 - \\pi_3 \\le 6$, $\\pi_1 \\le 100$, 且 $\\pi_1, \\pi_2, \\pi_3 \\ge 0$。\n    为了最大化 $5\\pi_1$，我们使 $\\pi_1$ 尽可能大。从 $\\pi_1 \\le 100$，我们设置 $\\pi_1=100$。如果我们能找到有效的 $\\pi_2, \\pi_3$，这是可行的。\n    $100 - \\pi_2 \\le 2 \\implies \\pi_2 \\ge 98$。选择 $\\pi_2=98$。\n    $100 - \\pi_3 \\le 6 \\implies \\pi_3 \\ge 94$。选择 $\\pi_3=94$。\n    一个最优对偶解是 $(\\pi_1^{(1)}, \\pi_2^{(1)}, \\pi_3^{(1)}) = (100, 98, 94)$。DSP 的目标值为 $5(100) = 500$，与 SP 的成本相匹配。\n    第一个 Benders 最优性割是 $\\theta \\ge 5(100) - x_1(98) - x_2(94)$，即 $\\theta \\ge 500 - 98x_1 - 94x_2$。\n\n**迭代 2**\n3.  **求解第二个主问题 (MP2):**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    满足约束：\n    $$ \\theta \\ge 0 $$\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    目标可以表述为 $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2)$。\n    如果 $500 - 98x_1 - 94x_2 \\le 0$，我们最小化 $3x_1 + 0.5x_2$。\n    如果 $500 - 98x_1 - 94x_2 > 0$，我们最小化 $3x_1 + 0.5x_2 + 500 - 98x_1 - 94x_2 = -95x_1 - 93.5x_2 + 500$。\n    线性函数在某个区域上的最小值出现在其边界上。两种情况都将解推向直线 $98x_1 + 94x_2 = 500$。\n    因此，我们在由 $98x_1 + 94x_2 = 500$ 定义的线段上最小化 $3x_1 + 0.5x_2$（对于 $x_1, x_2 \\ge 0$）。\n    满足约束 $98x_1 + 94x_2 = 500$ 一个单位的成本，使用 $x_1$ 是 $\\frac{3}{98} \\approx 0.0306$，使用 $x_2$ 是 $\\frac{0.5}{94} \\approx 0.0053$。使用 $x_2$ 更便宜。\n    解位于 $x_1=0$ 的角点。\n    $94x_2 = 500 \\implies x_2 = \\frac{500}{94} = \\frac{250}{47}$。\n    解是 $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)}) = (0, \\frac{250}{47}, 0)$。\n    MP2 的目标值是 $3(0) + 0.5(\\frac{250}{47}) + 0 = \\frac{125}{47}$。\n    新的下界是 $LB = \\frac{125}{47} \\approx 2.66$。\n\n4.  **对 $x^{(2)}=(0, \\frac{250}{47})$ 求解子问题 SP2 并生成第二个割平面:**\n    子问题是：\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    满足 $y_1+y_2+s \\ge 5$, $y_1 \\le 0 \\implies y_1=0$, 且 $y_2 \\le \\frac{250}{47}$。\n    问题简化为在 $y_2+s \\ge 5$ 和 $y_2 \\le \\frac{250}{47} \\approx 5.32$ 约束下最小化 $6y_2 + 100s$。\n    由于发电 $y_2$ 的成本（6/单位）远低于切负荷 $s$ 的成本（100/单位），我们应该使用 $y_2$ 来满足 5 的需求。因为容量 $\\frac{250}{47}$ 超过了需求 $5$，我们可以设置 $y_2=5$ 和 $s=0$。\n    子问题的解是 $(y_1, y_2, s) = (0, 5, 0)$，运行成本为 $Q(x^{(2)}) = 6 \\times 5 = 30$。\n    新的上界是 $c^T x^{(2)} + Q(x^{(2)}) = \\frac{125}{47} + 30 = \\frac{125+1410}{47} = \\frac{1535}{47} \\approx 32.66$。\n\n    我们用 $x^{(2)}=(0, \\frac{250}{47})$ 求解 DSP。根据 SP 解的互补松弛性：\n    - $y_2>0 \\implies y_2$ 的对偶约束是紧的：$\\pi_1-\\pi_3 = 6$。\n    - $y_2  \\frac{250}{47}$ (容量不具约束力) $\\implies \\pi_3=0$。\n    - 因此，$\\pi_1=6$。\n    - $y_1=0, s=0$ (非基变量) $\\implies$ 它们的对偶约束可能是松弛的。\n    最优对偶值必须满足所有对偶约束。我们有 $\\pi_1=6, \\pi_3=0$。剩下的约束是 $\\pi_1-\\pi_2 \\le 2 \\implies 6-\\pi_2 \\le 2 \\implies \\pi_2 \\ge 4$。我们可以选择 $\\pi_2=4$。\n    一个最优对偶解是 $(\\pi_1^{(2)}, \\pi_2^{(2)}, \\pi_3^{(2)}) = (6, 4, 0)$。\n    第二个 Benders 割是 $\\theta \\ge 5(6) - x_1(4) - x_2(0)$，即 $\\theta \\ge 30 - 4x_1$。\n\n**迭代 3**\n5.  **求解第三个主问题 (MP3) 并验证收敛性:**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    满足约束：\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    $$ \\theta \\ge 30 - 4x_1 $$\n    目标是 $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2, 30 - 4x_1)$。\n    最小值将位于割平面函数的上包络线上。我们分析两个割平面的交点：\n    $500 - 98x_1 - 94x_2 = 30 - 4x_1 \\implies 470 = 94x_1 + 94x_2 \\implies x_1 + x_2 = 5$。\n    在这条线上，可以通过将其中一个割平面表达式代入 $\\theta$ 来找到目标函数值：\n    $z = 3x_1 + 0.5x_2 + (30 - 4x_1) = -x_1 + 0.5x_2 + 30$。\n    现在代入 $x_2=5-x_1$：\n    $z = -x_1 + 0.5(5-x_1) + 30 = -x_1 + 2.5 - 0.5x_1 + 30 = -1.5x_1 + 32.5$。\n    为了最小化 $z$，我们必须在 $x_1+x_2=5$ 的线段上最大化 $x_1$，其中 $x_1, x_2 \\ge 0$。这意味着 $x_1 \\in [0, 5]$。\n    $x_1$ 的最大值是 $5$，这意味着 $x_2=0$。\n    MP3 的解是 $(\\hat{x}_1, \\hat{x}_2) = (5, 0)$。\n    在这一点上，$\\hat{\\theta} = 30 - 4(5) = 10$。这也与第一个割平面一致：$500 - 98(5) - 94(0) = 500 - 490 = 10$。\n    MP3 的解是 $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta}) = (5, 0, 10)$。\n    新的下界是 $LB = 3(5) + 0.5(0) + 10 = 25$。\n\n    **收敛性检查：** 我们求解 $\\hat{x}=(5, 0)$ 的子问题 SP。\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    满足 $y_1+y_2+s \\ge 5$, $y_1 \\le 5$, $y_2 \\le 0 \\implies y_2=0$。\n    问题简化为在 $y_1+s \\ge 5$ 和 $y_1 \\le 5$ 约束下最小化 $2y_1 + 100s$。\n    经济的选择是使用成本为 2 的 $y_1$，而不是成本为 100 的 $s$。我们设置 $y_1=5, s=0$。\n    运行成本是 $Q(\\hat{x}) = 2(5) = 10$。\n    我们观察到主问题中的 $\\hat{\\theta} = 10$ 等于子问题成本 $Q(\\hat{x}) = 10$。Benders 算法已经收敛。\n\n    最优总成本是 MP3 的最终下界（现在它等于上界）：\n    总成本 = $c^T\\hat{x} + \\hat{\\theta} = 3(5) + 0.5(0) + 10 = 25$。\n    或者，总成本 = $c^T\\hat{x} + Q(\\hat{x}) = 15 + 10 = 25$。\n\n精确的最优总成本是 25。",
            "answer": "$$ \\boxed{25} $$"
        },
        {
            "introduction": "最优性割能够优化解的质量，但 Benders 分解还必须处理主问题决策导致子问题无解的情形。本练习将演示如何识别此类不可行性，并推导出一个 Benders 可行性割。这是一种至关重要的约束，它能引导主问题在可行的运营决策区域内进行搜索。",
            "id": "4071643",
            "problem": "考虑一个两阶段线性储能规划模型，其中第一阶段决定装机容量，第二阶段调度发电以满足需求。第一阶段（主问题）的变量是两种技术A和B的装机容量 $x_{A}$ 和 $x_{B}$（单位：兆瓦，MW）。第二阶段（运行）子问题，对于给定的 $(x_{A}, x_{B})$，选择分时段调度 $y_{A,1}$、$y_{B,1}$、$y_{A,2}$、$y_{B,2}$（单位：MW）以最小化运行成本，同时满足需求和容量可用性约束，且无弃负荷。\n\n运行子问题为\n$$\n\\begin{aligned}\n\\min_{y_{A,1},y_{B,1},y_{A,2},y_{B,2}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} + c_{A,2}\\,y_{A,2} + c_{B,2}\\,y_{B,2} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1}, \\\\\n y_{A,2} + y_{B,2} \\ge d_{2}, \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A}, \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B}, \\\\\n y_{A,2} \\le a_{A,2}\\,x_{A}, \\\\\n y_{B,2} \\le a_{B,2}\\,x_{B}, \\\\\n y_{A,1},y_{B,1},y_{A,2},y_{B,2} \\ge 0,\n\\end{aligned}\n$$\n其中 $d_{1}$ 和 $d_{2}$ 是时段需求，$a_{g,t}$ 是可用率（无量纲），将装机容量映射到每个时段的可用容量。假设 $d_{1} = 95$，$d_{2} = 60$，$a_{A,1} = 0.40$，$a_{B,1} = 0.50$，$a_{A,2} = 0.90$，$a_{B,2} = 0.60$，并且当前主阶段迭代值为 $\\hat{x}_{A} = 120$ 和 $\\hat{x}_{B} = 50$。运行成本系数 $c_{g,t}$ 是任意有限非负数，无需具体指定即可分析可行性。\n\n在 Benders 分解（也称 L-型方法）的背景下，从基本原理出发，解释可行性割和最优性割在线性规划对偶和极射线与极点方面的区别。然后，对于上述具体数据，识别运行子问题中不可行性的来源，并为不可行的时段推导一个 Benders 可行性割。您的推导必须从线性规划对偶的有效基础和通过极射线表征不可行性开始，并且必须生成一个关于主变量的线性割，该割能排除不可行的 $(\\hat{x}_{A}, \\hat{x}_{B})$ 并对有问题的时段强制实现子问题可行性。\n\n计算可行性割，形式为单个线性表达式 $\\phi(x_{A}, x_{B})$，其非正性保证了对于任何 $(x_{A}, x_{B})$，运行子问题时段1的可行性。以兆瓦（MW）为单位表示您的最终表达式。无需四舍五入。",
            "solution": "该问题要求对 Benders 可行性割和最优性割进行原则性解释，然后为一个给定的两阶段储能规划模型推导一个特定的可行性割。\n\n首先，对问题进行验证。\n\n**步骤1：提取已知条件**\n- 主变量（装机容量，MW）：$x_{A}$，$x_{B}$\n- 第二阶段变量（调度，MW）：$y_{A,1}$，$y_{B,1}$，$y_{A,2}$，$y_{B,2}$\n- 运行子问题目标函数：$\\min_{y} \\sum_{g,t} c_{g,t} y_{g,t}$，其中 $c_{g,t} \\ge 0$ 是有限成本。\n- 运行子问题约束：\n  - $y_{A,1} + y_{B,1} \\ge d_{1}$\n  - $y_{A,2} + y_{B,2} \\ge d_{2}$\n  - $y_{A,1} \\le a_{A,1}\\,x_{A}$\n  - $y_{B,1} \\le a_{B,1}\\,x_{B}$\n  - $y_{A,2} \\le a_{A,2}\\,x_{A}$\n  - $y_{B,2} \\le a_{B,2}\\,x_{B}$\n  - $y_{A,1}, y_{B,1}, y_{A,2}, y_{B,2} \\ge 0$\n- 数据：\n  - 时段1需求：$d_{1} = 95$ MW\n  - 时段2需求：$d_{2} = 60$ MW\n  - 可用率：$a_{A,1} = 0.40$，$a_{B,1} = 0.50$，$a_{A,2} = 0.90$，$a_{B,2} = 0.60$\n- 当前主阶段迭代值：$\\hat{x}_{A} = 120$ MW，$\\hat{x}_{B} = 50$ MW\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是 Benders 分解在两阶段随机线性规划中的一个标准应用，这是运筹学和能源系统建模中的一个经典课题。它是科学有据且客观的。为检查一致性，我们在给定的迭代点 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$ 处评估运行子问题的可行性。运行子问题按时间段解耦。\n\n对于时段1，发电约束为：\n- $y_{A,1} \\le a_{A,1}\\,\\hat{x}_{A} = 0.40 \\times 120 = 48$ MW\n- $y_{B,1} \\le a_{B,1}\\,\\hat{x}_{B} = 0.50 \\times 50 = 25$ MW\n时段1的最大可能发电量为 $y_{A,1} + y_{B,1} \\le 48 + 25 = 73$ MW。\n需求为 $d_{1} = 95$ MW。\n由于最大可能发电量（73 MW）小于需求量（95 MW），需求约束 $y_{A,1} + y_{B,1} \\ge 95$ 无法满足。因此，时段1的运行子问题是不可行的。\n\n对于时段2，最大发电量为 $a_{A,2}\\,\\hat{x}_{A} + a_{B,2}\\,\\hat{x}_{B} = 0.90 \\times 120 + 0.60 \\times 50 = 108 + 30 = 138$ MW。需求为 $d_{2} = 60$ MW。由于 $138  60$，时段2的子问题是可行的。\n\n由于时段1的不可行性，整个运行子问题是不可行的。问题设定是一致且适定的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**第1部分：最优性割与可行性割的区别**\n\nBenders 分解解决形如下式的问题：\n$$\n\\min_{x, \\theta} \\quad z^T x + \\theta \\\\\n\\text{s.t.} \\quad x \\in X \\\\\n\\theta \\ge Q(x)\n$$\n其中 $Q(x)$ 是由第一阶段决策 $x$ 参数化的第二阶段线性规划（子问题）的最优值：\n$$\nQ(x) = \\min_{y} \\quad q^T y \\\\\n\\text{s.t.} \\quad Ty + Wy \\ge h\n$$\n在这里，为简化符号，我们假设对 $x$ 的依赖性由矩阵 $T$ 和右侧向量 $h$ 捕捉，使得约束为 $Wy \\ge h - Tx$。在我们的问题中，$x = (x_A, x_B)^T$，$y$ 是调度变量的向量。该算法通过向主问题添加线性约束（割）来迭代地逼近函数 $Q(x)$。\n\n当子问题对于给定的主问题解 $\\hat{x}$ 是可行且有界时，生成一个**最优性割**。根据线性规划对偶性，子问题的对偶问题是：\n$$\n\\max_{\\pi} \\quad (h - T\\hat{x})^T \\pi \\\\\n\\text{s.t.} \\quad W^T \\pi \\le q, \\quad \\pi \\ge 0\n$$\n设 $\\hat{\\pi}$ 是此对偶问题的一个最优解。$\\hat{\\pi}$ 是对偶可行域的一个极点。根据强对偶性，$Q(\\hat{x}) = (h - T\\hat{x})^T \\hat{\\pi}$。由于 $Q(x)$ 是一个凸函数，这为其上镜图提供了一个支撑超平面。由此产生的约束，称为最优性割，被添加到主问题中：\n$$\n\\theta \\ge (h - Tx)^T \\hat{\\pi}\n$$\n这个割对 $\\theta$ 施加了一个下界，适用于所有 $x$，确保 $\\theta$ 最终会收敛到最优 $x$ 的真实子问题成本。\n\n当子问题对于给定的主问题解 $\\hat{x}$ 是不可行时，生成一个**可行性割**。一个不可行的原始线性规划问题意味着其对偶问题要么是无界的，要么是不可行的。在 Benders 分解的背景下，对偶子问题被构造为总是可行的（例如，$\\pi=0$ 通常是一个可行解），因此它必须是无界的。\n\n对偶问题的无界性意味着对偶可行域的衰退锥中存在一个极射线。这个衰退锥由 $\\{ \\bar{\\pi} \\mid W^T \\bar{\\pi} \\le 0, \\bar{\\pi} \\ge 0 \\}$ 定义。如果对偶目标函数沿着一个极射线（由向量 $\\bar{\\pi}$ 表示）增加，即 $(h - T\\hat{x})^T \\bar{\\pi}  0$，那么这个极射线就是一个无界方向。这个条件是原始问题不可行性的一个证明，这一结果由 Farkas 引理概括。\n\n为了使原始子问题对任何给定的 $x$ 都是可行的，其对偶问题必须不是无界的。这要求对于对偶锥的每一个极射线 $\\bar{\\pi}$，沿该射线的目标变化必须是非正的：\n$$\n(h - Tx)^T \\bar{\\pi} \\le 0\n$$\n这个不等式就是一个 Benders 可行性割。它是对主变量 $x$ 本身的约束，而不是对 $\\theta$ 的约束，它将不可行的主解 $\\hat{x}$ 从主问题的可行集中“切掉”。\n\n**第2部分：可行性割的推导**\n\n整个子问题不可行，因为时段1的约束无法满足。我们关注这个有问题的时段。时段1的子问题是：\n$$\n\\begin{aligned}\n\\min_{y_{A,1}, y_{B,1}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1} \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A} \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B} \\\\\n y_{A,1}, y_{B,1} \\ge 0\n\\end{aligned}\n$$\n为应用对偶理论，我们将约束重写为标准形式 $Ay \\ge b$：\n$$\n\\begin{aligned}\ny_{A,1} + y_{B,1} \\ge d_{1} \\quad (\\text{对偶变量 } \\pi_1 \\ge 0) \\\\\n-y_{A,1} \\ge -a_{A,1}\\,x_{A} \\quad (\\text{对偶变量 } \\pi_2 \\ge 0) \\\\\n-y_{B,1} \\ge -a_{B,1}\\,x_{B} \\quad (\\text{对偶变量 } \\pi_3 \\ge 0)\n\\end{aligned}\n$$\n对偶问题是：\n$$\n\\begin{aligned}\n\\max_{\\pi_1, \\pi_2, \\pi_3} \\quad  d_1 \\pi_1 - a_{A,1}x_A \\pi_2 - a_{B,1}x_B \\pi_3 \\\\\n\\text{s.t.} \\quad  \\pi_1 - \\pi_2 \\le c_{A,1} \\\\\n \\pi_1 - \\pi_3 \\le c_{B,1} \\\\\n \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{aligned}\n$$\n对于 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$，原始问题是不可行的，因此对偶问题必定是无界的。我们需要找到对偶衰退锥的一个极射线。该锥由齐次对偶约束定义：\n$$\n\\begin{aligned}\n \\bar{\\pi}_1 - \\bar{\\pi}_2 \\le 0 \\\\\n \\bar{\\pi}_1 - \\bar{\\pi}_3 \\le 0 \\\\\n \\bar{\\pi}_1, \\bar{\\pi}_2, \\bar{\\pi}_3 \\ge 0\n\\end{aligned}\n$$\n通过将 $n-1 = 3-1 = 2$ 个约束设为紧约束来找到一个极射线。我们设 $\\bar{\\pi}_1 - \\bar{\\pi}_2 = 0$ 和 $\\bar{\\pi}_1 - \\bar{\\pi}_3 = 0$。这意味着 $\\bar{\\pi}_1 = \\bar{\\pi}_2 = \\bar{\\pi}_3$。我们可以通过设 $\\bar{\\pi}_1 = 1$ 来选择此射线的一个代表向量，得到射线方向 $\\bar{\\pi} = (1, 1, 1)^T$。\n\n我们必须验证这条射线导致目标函数对于迭代点 $(\\hat{x}_{A}, \\hat{x}_{B})$ 是无界的。沿着这条射线的物镜变化是：\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}\\hat{x}_A \\bar{\\pi}_2 - a_{B,1}\\hat{x}_B \\bar{\\pi}_3 = d_1(1) - a_{A,1}\\hat{x}_A(1) - a_{B,1}\\hat{x}_B(1)\n$$\n代入给定值：\n$$\n95 - (0.40)(120) - (0.50)(50) = 95 - 48 - 25 = 22\n$$\n由于 $22  0$，目标函数沿此射线增加，证实了对偶问题是无界的，并且 $\\bar{\\pi}=(1,1,1)^T$ 是一个有效的上升射线。\n\nBenders 可行性割是从以下条件推导出来的：对于任何可行的主解 $(x_{A}, x_{B})$，对偶目标函数沿此射线不能是无界的。这意味着目标变化必须是非正的：\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}x_A \\bar{\\pi}_2 - a_{B,1}x_B \\bar{\\pi}_3 \\le 0\n$$\n代入射线分量 $\\bar{\\pi}=(1,1,1)^T$：\n$$\nd_1(1) - a_{A,1}x_A (1) - a_{B,1}x_B (1) \\le 0\n$$\n代入常数值：\n$$\n95 - 0.40 x_A - 0.50 x_B \\le 0\n$$\n这个割正确地排除了不可行点 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$，因为 $95 - 0.40(120) - 0.50(50) = 22 \\not\\le 0$。该割要求时段1的总可用容量必须至少等于需求，即 $a_{A,1}x_A + a_{B,1}x_B \\ge d_1$。\n\n问题要求找到表达式 $\\phi(x_{A}, x_{B})$，使得割为 $\\phi(x_{A}, x_{B}) \\le 0$。因此，表达式为：\n$$\n\\phi(x_{A}, x_{B}) = 95 - 0.40 x_A - 0.50 x_B\n$$\n这个表达式的单位是 MW，因为 $95$ 的单位是 MW，而项 $0.40 x_A$ 和 $0.50 x_B$ 的单位也是 MW（无量纲因子乘以 MW）。",
            "answer": "$$\\boxed{95 - 0.40 x_{A} - 0.50 x_{B}}$$"
        },
        {
            "introduction": "现在我们转向 Dantzig-Wolfe 分解法，其核心挑战在于生成有价值的“列”。本练习将展示如何使用动态规划来求解一个机组组合模型的定价子问题。这是一种强大的技术，用于寻找最有利可图的运行计划（即具有最负折算成本的列），以改进主问题的解。",
            "id": "4071658",
            "problem": "考虑在能源系统建模中，一个参与长周期机组组合模型的 Dantzig–Wolfe 分解（列生成）的单一火力发电机组。在列生成中，主问题选择可行调度方案的凸组合，而每个发电机组的定价子问题则搜索具有负检验数的新调度方案（一个列）。使用动态规划 (DP) 的最优性原理，将定价子问题表述为一个随时间的分阶段优化问题。\n\n假设以下科学上真实且自洽的设定。时间被离散化为4个等长的时段，每个时段1小时。发电机组每个时段的可行出力被离散化为集合 $\\{0, 50, 100\\}$ 兆瓦，连续时段之间的对称爬坡率限制为 $50$ 兆瓦。发电机组初始处于关停状态，出力为零，即 $x_{0} = 0$。当出力从0转换到严格为正的水平时，会产生启动成本。当机组开启（出力为正）时，会产生空载成本。可变发电成本与出力成线性关系。设参数如下：\n- 每时段可变发电成本系数 $c_{t}$，单位为美元/兆瓦时($/MWh): $c_{1} = 30$, $c_{2} = 25$, $c_{3} = 35$, $c_{4} = 40$。\n- 来自主问题电量平衡约束的对偶乘子 $\\pi_{t}$，单位为美元/兆瓦时($/MWh): $\\pi_{1} = 28$, $\\pi_{2} = 65$, $\\pi_{3} = 20$, $\\pi_{4} = 55$。\n- 空载成本 $L$，单位为美元/时段: $L = 500$。\n- 启动成本 $S$，单位为美元/次启动: $S = 1500$。\n- 爬坡率限制 $R$，单位为兆瓦/时段: $R = 50$。\n\n一个列（调度方案）是一个序列 $(x_{1}, x_{2}, x_{3}, x_{4})$，它满足离散出力集合和爬坡约束 $|x_{t} - x_{t-1}| \\leq R$（对于所有 $t \\in \\{1, 2, 3, 4\\}$），且 $x_{0} = 0$。一个调度方案的检验数是其总运行成本（启动成本、空载成本和可变成本之和）减去对偶加权的电量价值 $\\sum_{t=1}^{4} \\pi_{t} x_{t}$。\n\n任务：\n- 为定价子问题推导一个动态规划 (DP) 模型。清晰地定义状态、决策、由爬坡限制所施加的可行转移，以及包含启动和空载成本的阶段成本。推导待行成本的贝尔曼递推式。\n- 使用所提供的数据，通过求解推导出的 DP 递推式，计算所有可行调度方案的最小检验数。以美元为单位表示最终的检验数。给出精确值（不要四舍五入）。",
            "solution": "用户的要求是使用动态规划 (DP) 来建立并求解一个来自机组组合模型 Dantzig-Wolfe 分解的定价子问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **时间范围**：$4$ 个时段，每时段持续 $1$ 小时。设时段集合为 $\\mathcal{T} = \\{1, 2, 3, 4\\}$。\n- **发电机出力水平**：时段 $t$ 的出力，记为 $x_t$，必须在集合 $\\{0, 50, 100\\}$ MW 中。\n- **初始状态**：第一个时段之前的发电机出力为 $x_{0} = 0$ MW。\n- **爬坡率限制**：连续时段之间的出力变化受 $R = 50$ MW 的限制。即，对于 $t \\in \\{1, 2, 3, 4\\}$，有 $|x_t - x_{t-1}| \\leq R$。\n- **可变发电成本系数**：$c_1 = 30$, $c_2 = 25$, $c_3 = 35$, $c_4 = 40$，单位为 $/MWh。\n- **主问题对偶乘子**：$\\pi_1 = 28$, $\\pi_2 = 65$, $\\pi_3 = 20$, $\\pi_4 = 55$，单位为 $/MWh。\n- **空载成本**：$L = 500$ $ 每时段，当机组开启时（即 $x_t  0$）。\n- **启动成本**：$S = 1500$ $ 每次启动事件（即当 $x_{t-1} = 0$ 且 $x_t  0$ 时）。\n- **目标**：找到一个可行调度方案 $(x_1, x_2, x_3, x_4)$ 的最小检验数。\n- **检验数定义**：总运行成本（可变成本、空载成本和启动成本之和）减去对偶加权的电量价值 $\\sum_{t=1}^{4} \\pi_{t} x_{t}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它代表了一个通过动态规划求解的标准机组组合子问题。这是能源系统优化和运筹学中一个常见的基础问题。该问题是适定的，具有有限的状态空间、有限的时间范围和一个明确的最小化目标函数，确保了唯一解的存在。数据完整、一致且已在数值上指定。语言精确客观。未发现任何缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将提供解决方案。\n\n### 动态规划模型\n\n定价子问题旨在找到一个使检验数最小化的可行调度方案。这可以被构建为一个有向无环图上的最短路径问题，并使用动态规划高效求解。\n\n- **阶段**：阶段是离散的时间段，$t \\in \\{1, 2, 3, 4\\}$。\n- **状态**：阶段 $t$ 开始时的状态必须捕获所有来自过去、用以做出未来决策的必要信息。爬坡率约束 $|x_t - x_{t-1}| \\leq R$ 取决于前一个时段的出力 $x_{t-1}$，而启动成本取决于机组在前一个时段是否停机 ($x_{t-1}=0$)。因此，阶段 $t$ 开始时的状态是发电机在前一个时段的出力水平，$s_t = x_{t-1}$。状态空间是可能出力水平的集合，$\\mathcal{X} = \\{0, 50, 100\\}$。\n- **决策**：在阶段 $t$，给定状态 $s_t = x_{t-1}$，决策是选择当前时段的出力水平 $d_t = x_t$。可行决策的集合受爬坡率限制的约束：$d_t \\in \\{x \\in \\mathcal{X} : |x - s_t| \\leq R\\}$。\n- **阶段成本**：在阶段 $t$ 产生的成本是该时段的检验数，它取决于状态 $x_{t-1}$ 和决策 $x_t$。时段 $t$ 的检验数由下式给出：\n$$ \\text{OperatingCost}_t - \\pi_t x_t = (c_t x_t + L \\cdot \\mathbf{1}(x_t0) + S \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ and } x_t0)) - \\pi_t x_t $$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数。我们将阶段成本函数 $C_t(x_{t-1}, x_t)$ 定义为：\n$$ C_t(x_{t-1}, x_t) = (c_t - \\pi_t)x_t + L \\cdot \\mathbf{1}(x_t0) + S \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ and } x_t0) $$\n每个时段的持续时间为1小时，因此产生的电量在数值上等于功率输出。\n\n- **贝尔曼递推（待行成本）**：令 $J_t(s)$ 为从时段 1 到时段 $t$ 结束的最小累积检验数，其中发电机在时段 $t$ 的出力为 $s$（即 $x_t = s$）。我们使用前向递推。\n初始条件由 $t=0$ 时的状态定义。给定 $x_0 = 0$。我们可以定义处于此状态的成本为 $J_0(0) = 0$，对于任何其他状态 $s \\in \\{50, 100\\}$，$J_0(s) = \\infty$。\n对于 $t=1, \\dots, 4$ 以及每个可能的状态 $x_t \\in \\mathcal{X}$，贝尔曼递推式为：\n$$ J_t(x_t) = \\min_{x_{t-1} \\in \\mathcal{X} \\text{ s.t. } |x_t - x_{t-1}| \\le R} \\{ J_{t-1}(x_{t-1}) + C_t(x_{t-1}, x_t) \\} $$\n最终答案，即整个时间范围内的最小检验数，是最后阶段待行成本值的最小值：\n$$ \\min \\text{RC} = \\min_{x_4 \\in \\mathcal{X}} J_4(x_4) $$\n\n### 求解 DP 递推\n\n首先，我们计算净可变成本系数，$c'_t = c_t - \\pi_t$：\n- $c'_1 = c_1 - \\pi_1 = 30 - 28 = 2$ $/MWh\n- $c'_2 = c_2 - \\pi_2 = 25 - 65 = -40$ $/MWh\n- $c'_3 = c_3 - \\pi_3 = 35 - 20 = 15$ $/MWh\n- $c'_4 = c_4 - \\pi_4 = 40 - 55 = -15$ $/MWh\n\n阶段成本为 $C_t(x_{t-1}, x_t) = c'_t x_t + 500 \\cdot \\mathbf{1}(x_t0) + 1500 \\cdot \\mathbf{1}(x_{t-1}=0 \\text{ 且 } x_t0)$。\n\n**初始阶段 ($t=0$)**：\n$J_0(0) = 0$\n$J_0(50) = \\infty$\n$J_0(100) = \\infty$\n\n**阶段 1 ($t=1$)**：\n唯一可能的前一状态是 $x_0=0$。\n$J_1(0) = J_0(0) + C_1(0, 0) = 0 + (2 \\cdot 0 + 0 + 0) = 0$。\n$J_1(50) = J_0(0) + C_1(0, 50) = 0 + (2 \\cdot 50 + 500 + 1500) = 100 + 2000 = 2100$。\n$J_1(100)$ 从 $x_0=0$ 不可达，因为 $|100 - 0|  50$，所以 $J_1(100) = \\infty$。\n\n**阶段 2 ($t=2$)**：\n$J_2(0) = \\min\\{J_1(0)+C_2(0,0), J_1(50)+C_2(50,0)\\} = \\min\\{0+0, 2100+0\\} = 0$。\n$J_2(50) = \\min\\{J_1(0)+C_2(0,50), J_1(50)+C_2(50,50)\\}$。\n$C_2(0,50) = -40 \\cdot 50 + 500 + 1500 = -2000 + 2000 = 0$。\n$C_2(50,50) = -40 \\cdot 50 + 500 = -1500$。\n$J_2(50) = \\min\\{0+0, 2100-1500\\} = \\min\\{0, 600\\} = 0$。\n$J_2(100) = \\min\\{J_1(50)+C_2(50,100), J_1(100)+C_2(100,100)\\}$。\n$C_2(50,100) = -40 \\cdot 100 + 500 = -3500$。\n$J_2(100) = \\min\\{2100-3500, \\infty\\} = -1400$。\n\n因此，在阶段 2 结束时：$J_2(0)=0, J_2(50)=0, J_2(100)=-1400$。\n\n**阶段 3 ($t=3$)**：\n$J_3(0) = \\min\\{J_2(0)+C_3(0,0), J_2(50)+C_3(50,0)\\} = \\min\\{0+0, 0+0\\} = 0$。\n$J_3(50) = \\min\\{J_2(0)+C_3(0,50), J_2(50)+C_3(50,50), J_2(100)+C_3(100,50)\\}$。\n$C_3(0,50) = 15 \\cdot 50 + 500 + 1500 = 750 + 2000 = 2750$。\n$C_3(50,50) = 15 \\cdot 50 + 500 = 1250$。\n$C_3(100,50) = 15 \\cdot 50 + 500 = 1250$。\n$J_3(50) = \\min\\{0+2750, 0+1250, -1400+1250\\} = \\min\\{2750, 1250, -150\\} = -150$。\n$J_3(100) = \\min\\{J_2(50)+C_3(50,100), J_2(100)+C_3(100,100)\\}$。\n$C_3(50,100) = 15 \\cdot 100 + 500 = 2000$。\n$C_3(100,100) = 15 \\cdot 100 + 500 = 2000$。\n$J_3(100) = \\min\\{0+2000, -1400+2000\\} = \\min\\{2000, 600\\} = 600$。\n\n因此，在阶段 3 结束时：$J_3(0)=0, J_3(50)=-150, J_3(100)=600$。\n\n**阶段 4 ($t=4$)**：\n$J_4(0) = \\min\\{J_3(0)+C_4(0,0), J_3(50)+C_4(50,0)\\} = \\min\\{0+0, -150+0\\} = -150$。\n$J_4(50) = \\min\\{J_3(0)+C_4(0,50), J_3(50)+C_4(50,50), J_3(100)+C_4(100,50)\\}$。\n$C_4(0,50) = -15 \\cdot 50 + 500 + 1500 = -750 + 2000 = 1250$。\n$C_4(50,50) = -15 \\cdot 50 + 500 = -250$。\n$C_4(100,50) = -15 \\cdot 50 + 500 = -250$。\n$J_4(50) = \\min\\{0+1250, -150-250, 600-250\\} = \\min\\{1250, -400, 350\\} = -400$。\n$J_4(100) = \\min\\{J_3(50)+C_4(50,100), J_3(100)+C_4(100,100)\\}$。\n$C_4(50,100) = -15 \\cdot 100 + 500 = -1000$。\n$C_4(100,100) = -15 \\cdot 100 + 500 = -1000$。\n$J_4(100) = \\min\\{-150-1000, 600-1000\\} = \\min\\{-1150, -400\\} = -1150$。\n\n**最终结果**：\n最小检验数是最后阶段成本的最小值：\n$$ \\min \\text{RC} = \\min\\{J_4(0), J_4(50), J_4(100)\\} = \\min\\{-150, -400, -1150\\} = -1150 $$\n最小检验数为 $-1150$ 美元，对应的调度方案为 $(x_1, x_2, x_3, x_4) = (50, 100, 50, 100)$。",
            "answer": "$$\\boxed{-1150}$$"
        }
    ]
}