{
    "hands_on_practices": [
        {
            "introduction": "深入研究凸松弛技术的第一步是牢固掌握原始的非凸交流最优潮流 (AC-OPF) 问题。本练习将引导您从基本物理定律出发，使用直角坐标系构建完整的 AC-OPF 模型，从而清晰地揭示导致问题非凸性的二次项。随后，本练习将引入核心的“变量提升” (lifting) 与松弛思想，为您展示如何将棘手的非凸约束转化为更易于处理的凸约束，这是理解半定规划 (SDP) 和二阶锥规划 (SOCP) 松弛的基石。",
            "id": "4081226",
            "problem": "考虑一个三母线输电网络，其单位化模型中的节点导纳矩阵 $Y \\in \\mathbb{C}^{3 \\times 3}$ 由下式给出\n$$\nY \\;=\\; \\begin{pmatrix}\n7 - j\\,22  &-4 + j\\,16  &-3 + j\\,12 \\\\\n-4 + j\\,16  &6.5 - j\\,23  &-2.5 + j\\,10 \\\\\n-3 + j\\,12  &-2.5 + j\\,10  &5.5 - j\\,20\n\\end{pmatrix},\n$$\n其中 $j$ 表示 $\\sqrt{-1}$，$Y$ 的实部和虚部分别用 $G$ 和 $B$ 表示，即 $Y_{ik} = G_{ik} + j B_{ik}$。母线负荷指定为 $(P_{1}^{d}, Q_{1}^{d}) = (1.0, 0.5)$、$(P_{2}^{d}, Q_{2}^{d}) = (0.8, 0.3)$ 和 $(P_{3}^{d}, Q_{3}^{d}) = (1.2, 0.6)$。有两个发电机：一个在母线 $1$ 上，其有功功率二次成本系数为 $(a_{1}, b_{1}, c_{1}) = (10, 6, 0.2)$；另一个在母线 $2$ 上，其成本系数为 $(a_{2}, b_{2}, c_{2}) = (12, 5, 0.1)$。发电机容量限制为 $0 \\leq P_{1}^{g} \\leq 3$、$-1 \\leq Q_{1}^{g} \\leq 1$ 和 $0 \\leq P_{2}^{g} \\leq 2$、$-0.8 \\leq Q_{2}^{g} \\leq 0.8$。电压幅值满足 $0.95 \\leq |V_{i}| \\leq 1.05$ (对于 $i \\in \\{1,2,3\\}$)。支路串联导纳为 $y_{12} = 4 - j\\,16$、$y_{13} = 3 - j\\,12$ 和 $y_{23} = 2.5 - j\\,10$，相应的视在功率限制为 $S_{12,\\max} = 2.5$、$S_{13,\\max} = 2.0$ 和 $S_{23,\\max} = 2.0$。使用直角坐标表示电压 $V_{i} = v_{i,r} + j\\,v_{i,i}$，并通过 $v_{1,i} = 0$ 和 $v_{1,r} \\geq 0$ 来固定相角参考。\n\n仅从网络基本原理（基尔霍夫定律和欧姆定律）出发，构建完整的直角坐标形式的交流最优潮流（AC OPF）问题，并给出以下各项的显式代数表达式：\n- 每个母线的节点复功率平衡约束，\n- 电压幅值边界，\n- 发电机有功和无功功率边界，\n- 支路视在功率限制，\n- 相角参考。\n\n然后，引入由 $W_{ik} = V_{i} V_{k}^{*}$ 定义的提升电压乘积矩阵 $W \\in \\mathbb{C}^{3 \\times 3}$，其中 $^{*}$ 表示复共轭，并推导对应于母线 $1$ 和 $2$ 的 $2 \\times 2$ 主子式的二阶锥（SOC）松弛。最后，定义标量\n$$\n\\Xi \\;=\\; \\left(W_{11} + W_{22}\\right)^{2} \\;-\\; \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2},\n$$\n其中 $W_{12,r} = \\Re(W_{12})$ 且 $W_{12,i} = \\Im(W_{12})$，并将 $\\Xi$ 以最简展开形式报告为关于 $W$ 中各项的解析表达式。将您的最终答案表示为单个符号表达式。无需进行数值四舍五入。",
            "solution": "问题陈述已经过严格验证，并被认为是合理的。它在科学上基于电力系统工程的原理，特别是交流最优潮流（AC OPF）问题。所提供的数据是自洽、一致且定义明确的。任务是客观且可形式化的，能够为指定的计算得出一个唯一的、有意义的解决方案。因此，我将提供一个完整的解答。\n\n该问题需要一个三部分的解答：首先，在直角坐标系下构建 AC OPF 问题；其次，为特定子问题推导二阶锥（SOC）松弛；第三，计算标量 $\\Xi$。\n\n### 第一部分：AC OPF 问题建模\nAC OPF 问题旨在最小化总发电成本，同时满足一系列物理和运行约束。决策变量是复数母线电压的实部和虚部，$V_i = v_{i,r} + j v_{i,i}$（$i \\in \\{1,2,3\\}$），以及发电机的有功和无功功率输出 $(P_1^g, Q_1^g)$ 和 $(P_2^g, Q_2^g)$。\n\n**目标函数：**\n目标是最小化有功发电的总二次成本：\n$$ \\min_{P_1^g, P_2^g} C(P_1^g, P_2^g) = (a_1(P_1^g)^2 + b_1 P_1^g + c_1) + (a_2(P_2^g)^2 + b_2 P_2^g + c_2) $$\n\n**约束条件：**\n\n1.  **节点功率平衡约束：** 对于每个母线 $i \\in \\{1,2,3\\}$，净注入复功率 $S_i^{\\text{inj}} = P_i^{\\text{inj}} + j Q_i^{\\text{inj}}$ 必须与流入输电网络的功率相平衡。净注入功率是发电量减去负荷，$P_i^{\\text{inj}} = P_i^g - P_i^d$ 且 $Q_i^{\\text{inj}} = Q_i^g - Q_i^d$。注意，对于母线 $3$，有 $P_3^g = Q_3^g = 0$。从母线 $i$ 流入网络的功率为 $S_i = V_i I_i^* = V_i (\\sum_{k=1}^3 Y_{ik} V_k)^*$。将其用 $V_i = v_{i,r} + j v_{i,i}$ 和 $Y_{ik} = G_{ik} + j B_{ik}$ 展开为实部和虚部，得到：\n    $$ P_i^g - P_i^d = \\sum_{k=1}^3 \\left[ G_{ik}(v_{i,r}v_{k,r} + v_{i,i}v_{k,i}) + B_{ik}(v_{i,i}v_{k,r} - v_{i,r}v_{k,i}) \\right], \\quad \\forall i \\in \\{1,2,3\\} $$\n    $$ Q_i^g - Q_i^d = \\sum_{k=1}^3 \\left[ G_{ik}(v_{i,i}v_{k,r} - v_{i,r}v_{k,i}) - B_{ik}(v_{i,r}v_{k,r} + v_{i,i}v_{k,i}) \\right], \\quad \\forall i \\in \\{1,2,3\\} $$\n\n2.  **电压幅值边界：** 每个母线的电压幅值必须保持在指定范围内，$V_i^{\\min} \\leq |V_i| \\leq V_i^{\\max}$。在直角坐标系中，这是一对二次约束：\n    $$ (V_i^{\\min})^2 \\leq v_{i,r}^2 + v_{i,i}^2 \\leq (V_i^{\\max})^2, \\quad \\forall i \\in \\{1,2,3\\} $$\n    使用给定值，$(0.95)^2 \\leq v_{i,r}^2 + v_{i,i}^2 \\leq (1.05)^2$。\n\n3.  **发电机容量限制：** 每个发电机的有功和无功功率输出是有界的：\n    $$ 0 \\leq P_1^g \\leq 3, \\quad -1 \\leq Q_1^g \\leq 1 $$\n    $$ 0 \\leq P_2^g \\leq 2, \\quad -0.8 \\leq Q_2^g \\leq 0.8 $$\n\n4.  **支路视在功率限制：** 每条支路上的视在功率流 $S_{ik}$ 的大小不得超过其限制 $S_{ik, \\max}$。对于母线 $i$ 和 $k$ 之间串联导纳为 $y_{ik}$ 的支路，离开母线 $i$ 的复功率为 $S_{ik} = V_i I_{ik}^*$，其中 $I_{ik} = y_{ik}(V_i - V_k)$。因此，$S_{ik} = y_{ik}^*(|V_i|^2 - V_i V_k^*)$。约束条件为 $|S_{ik}|^2 \\leq (S_{ik, \\max})^2$，展开为：\n    $$ |y_{ik}|^2 \\left[ \\left( (v_{i,r}^2+v_{i,i}^2) - (v_{i,r}v_{k,r}+v_{i,i}v_{k,i}) \\right)^2 + \\left( v_{i,r}v_{k,i} - v_{i,i}v_{k,r} \\right)^2 \\right] \\leq (S_{ik,\\max})^2 $$\n    此不等式对支路 $(1,2)$、$(1,3)$ 和 $(2,3)$ 均成立。\n\n5.  **相角参考：** 为了消除电压相角的自由度，指定一个母线作为参考母线。对于母线 $1$，相角设置为零，这在直角坐标系中通过以下方式强制执行：\n    $$ v_{1,i} = 0, \\quad v_{1,r} \\geq 0 $$\n\n### 第二部分：SOC 松弛\n由于二次潮流方程和支路限制方程，AC OPF 问题是非凸的。找到一个好解的常用方法是使用凸松弛。我们引入提升电压乘积矩阵 $W$，其元素为 $W_{ik} = V_i V_k^*$。根据其构造，该矩阵是埃尔米特矩阵、半正定矩阵，并且秩为一（$W = vv^*$，其中 $v=[V_1, V_2, V_3]^T$）。非凸性体现在秩为一的约束中。\n\nAC OPF 的半定规划（SDP）松弛涉及放弃秩约束，仅要求 $W \\succeq 0$。$W \\succeq 0$ 的一个必要条件是其所有主子式都是半正定的。SOC 松弛是 SDP 的一种更弱（更松弛）但计算成本更低的替代方法，通常只要求 $W$ 的 $2 \\times 2$ 主子式是半正定的。\n\n考虑 $W$ 中对应于母线 $1$ 和 $2$ 的 $2 \\times 2$ 主子式：\n$$ W_{1,2} = \\begin{pmatrix} W_{11}  &W_{12} \\\\ W_{21}  &W_{22} \\end{pmatrix} $$\n要使该子矩阵是半正定的，其对角线元素必须非负（$W_{11} \\geq 0, W_{22} \\geq 0$，这是成立的，因为 $W_{ii}=|V_i|^2$），并且其行列式必须非负。\n$$ \\det(W_{1,2}) = W_{11}W_{22} - W_{12}W_{21} \\geq 0 $$\n由于 $W$ 是埃尔米特矩阵，$W_{21} = W_{12}^*$，因此条件为 $W_{11}W_{22} - |W_{12}|^2 \\geq 0$。设 $W_{12} = W_{12,r} + j W_{12,i}$，我们有：\n$$ W_{11}W_{22} \\geq W_{12,r}^2 + W_{12,i}^2 $$\n这个不等式可以表示为一个标准的二阶锥约束。通过代数变换：\n$$ 4W_{11}W_{22} \\geq 4W_{12,r}^2 + 4W_{12,i}^2 $$\n$$ (W_{11}+W_{22})^2 - (W_{11}-W_{22})^2 \\geq (2W_{12,r})^2 + (2W_{12,i})^2 $$\n$$ (W_{11}+W_{22})^2 \\geq (2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11}-W_{22})^2 $$\n因为 $W_{11}+W_{22} \\ge 0$，我们可以对两边取平方根：\n$$ \\sqrt{(2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11}-W_{22})^2} \\leq W_{11}+W_{22} $$\n这是一个形式为 $\\|\\mathbf{x}\\|_2 \\leq t$ 的标准 SOC 约束，写作：\n$$ \\left\\| \\begin{pmatrix} 2W_{12,r} \\\\ 2W_{12,i} \\\\ W_{11}-W_{22} \\end{pmatrix} \\right\\|_2 \\leq W_{11}+W_{22} $$\n这个约束是针对该 $2 \\times 2$ 子矩阵的 SOC 松弛。\n\n### 第三部分：$\\Xi$ 的计算\n最后的任务是计算标量 $\\Xi$，其定义为：\n$$ \\Xi \\;=\\; \\left(W_{11} + W_{22}\\right)^{2} \\;-\\; \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2} $$\n我们展开范数的平方项：\n$$ \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2} = (2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11} - W_{22})^2 $$\n$$ = 4W_{12,r}^2 + 4W_{12,i}^2 + (W_{11}^2 - 2W_{11}W_{22} + W_{22}^2) $$\n我们再展开 $\\Xi$ 定义中的第一项：\n$$ (W_{11} + W_{22})^2 = W_{11}^2 + 2W_{11}W_{22} + W_{22}^2 $$\n将两个展开式代入 $\\Xi$ 的定义中：\n$$ \\Xi = (W_{11}^2 + 2W_{11}W_{22} + W_{22}^2) - (4W_{12,r}^2 + 4W_{12,i}^2 + W_{11}^2 - 2W_{11}W_{22} + W_{22}^2) $$\n我们去掉括号并合并同类项：\n$$ \\Xi = W_{11}^2 + 2W_{11}W_{22} + W_{22}^2 - 4W_{12,r}^2 - 4W_{12,i}^2 - W_{11}^2 + 2W_{11}W_{22} - W_{22}^2 $$\n项 $W_{11}^2$ 和 $W_{22}^2$ 相消。$W_{11}W_{22}$ 项相加。\n$$ \\Xi = 4W_{11}W_{22} - 4W_{12,r}^2 - 4W_{12,i}^2 $$\n这是 $\\Xi$ 关于 $W$ 中指定项的最简展开解析表达式。值得注意的是，SOC 松弛的条件 $\\left\\| \\ldots \\right\\|_2 \\leq W_{11}+W_{22}$ 等价于 $\\Xi \\geq 0$。此外，$\\Xi$ 等于 $W$ 的 $2 \\times 2$ 主子式行列式的 $4$ 倍。",
            "answer": "$$\n\\boxed{4W_{11}W_{22} - 4W_{12,r}^{2} - 4W_{12,i}^{2}}\n$$"
        },
        {
            "introduction": "掌握了松弛理论之后，下一步便是将其付诸实践以求解问题。本练习提供了一个动手编程的机会，让您为辐射状网络中的 SOCP 支路潮流松弛模型实现一个专门的迭代算法。通过实现经典的“后推-前推”迭代法，您将能深入理解如何高效求解这类凸优化问题，并将理论知识与实际计算联系起来。",
            "id": "4081242",
            "problem": "要求您实现一个完整的、可运行的程序，该程序将二阶锥规划 (SOCP) 支路潮流松弛应用于一个 $3$ 节点辐射状馈线，并计算支路潮流变量的最优解。其背景是使用支路潮流（也称为 DistFlow）模型的辐射状配电网的交流 (AC) 最优潮流问题。该网络由节点 $1 \\rightarrow 2 \\rightarrow 3$ 组成，其中节点 $1$ 为平衡节点。需要计算的变量是：有功和无功潮流 $p_{12}, q_{12}, p_{23}, q_{23}$，电流幅值平方 $\\ell_{12}, \\ell_{23}$，以及节点 $2$ 和 $3$ 处的电压幅值平方 $v_{2}, v_{3}$。\n\n从以下基本物理定律和经过验证的公式出发：\n- Kirchhoff 电流定律 (KCL) 和 Kirchhoff 电压定律 (KVL)。\n- 电力系统中的相量形式 Ohm 定律。\n- 无并联元件的辐射状馈线的支路潮流 (DistFlow) 方程。\n- 源于复功率、电压幅值和电流幅值之间关系的 SOCP 支路潮流松弛。\n\n对于每条线路 $i \\rightarrow j$，模型规定如下：\n- 沿线路和下游节点的功率平衡：\n  - $p_{23} = p_{3} + r_{23} \\ell_{23}$，\n  - $q_{23} = q_{3} + x_{23} \\ell_{23}$，\n  - $p_{12} = p_{2} + p_{23} + r_{12} \\ell_{12}$，\n  - $q_{12} = q_{2} + q_{23} + x_{12} \\ell_{12}$。\n- 电压降方程：\n  - $v_{2} = v_{1} - 2 \\left(r_{12} p_{12} + x_{12} q_{12} \\right) + \\left(r_{12}^{2} + x_{12}^{2}\\right) \\ell_{12}$，\n  - $v_{3} = v_{2} - 2 \\left(r_{23} p_{23} + x_{23} q_{23} \\right) + \\left(r_{23}^{2} + x_{23}^{2}\\right) \\ell_{23}$。\n- SOCP 松弛（发送端公式）：\n  - $\\ell_{12} v_{1} \\ge p_{12}^{2} + q_{12}^{2}$，\n  - $\\ell_{23} v_{2} \\ge p_{23}^{2} + q_{23}^{2}$。\n\n所有量均以标幺值 (p.u.) 表示。电压幅值由其平方值 $v_{i}$ 表示，电流幅值平方为 $\\ell_{ij}$。平衡节点的电压幅值平方固定为 $v_{1}$。目标是最小化总有功功率损耗，建模为 $\\min \\sum_{(i,j)} r_{ij} \\ell_{ij}$，并满足上述约束和以下箱式约束：\n- 节点 $2$ 和 $3$ 处的电压边界：$v_{\\min}^{2} \\le v_{i} \\le v_{\\max}^{2}$，\n- 线路电流边界：$\\ell_{ij} \\le I_{\\max,ij}^{2}$。\n\n当线路电阻 $r_{ij} > 0$ 时，该凸规划的最优解在 SOCP 约束中达到等式，即在电流上限未被激活的情况下，$\\ell_{ij} v_{i} = p_{ij}^{2} + q_{ij}^{2}$。您的程序应利用此特性，通过将 SOCP 约束中的等式与线性功率平衡和电压降方程一同迭代执行，直至收敛，从而计算出最优解。\n\n此公式中不使用角度量；因此，不需要角度单位。所有输出必须以标幺值表示，并以浮点数形式呈现。\n\n实现一个算法，该算法：\n- 使用上述模型，并在最优性条件下强制执行 SOCP 等式 $\\ell_{ij} v_{i} = p_{ij}^{2} + q_{ij}^{2}$，除非会违反电流上限。\n- 对两条线路的 $(p_{ij}, q_{ij}, v_{i}, \\ell_{ij})$ 进行迭代更新，直到变化量小于一个小的容差。\n- 检查电流上限，并在必要时将 $\\ell_{ij}$ 限制在 $I_{\\max,ij}^{2}$。对于下面的测试套件，参数的选择使得电流边界不会起作用。\n\n计算细节：\n- 在迭代中使用 SOCP 等式更新 $\\ell_{12} = \\dfrac{p_{12}^{2} + q_{12}^{2}}{v_{1}}$ 和 $\\ell_{23} = \\dfrac{p_{23}^{2} + q_{23}^{2}}{v_{2}}$。\n- 使用一个严格介于 $0$ 和 $1$ 之间的松弛参数来稳定迭代。\n- 当 $\\ell_{12}$ 和 $\\ell_{23}$ 的最大变化量低于 $10^{-10}$ 或在 $10000$ 次迭代后停止，以先到者为准。\n- 如果计算出的 $v_{2}$ 或 $v_{3}$ 超出 $[v_{\\min}^{2}, v_{\\max}^{2}]$ 的范围，不要修改算法；测试套件被设计为可行的。报告计算出的值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果本身必须是按 $[p_{12},p_{23},q_{12},q_{23},\\ell_{12},\\ell_{23},v_{2},v_{3}]$ 顺序排列的列表。\n- 所有值必须以浮点数形式打印，并四舍五入到六位小数。\n- 例如：$[[a_{1},a_{2},\\dots,a_{8}],[b_{1},\\dots,b_{8}],[c_{1},\\dots,c_{8}]]$。\n\n您的任务是实现该算法，以返回上述测试套件在 SOCP 支路潮流松弛下的最优解。",
            "solution": "用户希望使用二阶锥规划 (SOCP) 松弛来解决一个 3 节点辐射状配电网的交流最优潮流 (AC OPF) 问题。该解并非通过通用的 SOCP 求解器找到，而是通过一个利用该问题结构的专用迭代算法来找到。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n- **网络拓扑：** 一个 3 节点辐射状馈线 $1 \\rightarrow 2 \\rightarrow 3$，其中节点 $1$ 为平衡节点。\n- **变量：** 有功潮流 ($p_{12}, p_{23}$)、无功潮流 ($q_{12}, q_{23}$)、电流幅值平方 ($\\ell_{12}, \\ell_{23}$) 和电压幅值平方 ($v_2, v_3$)。所有量均以标幺值 (p.u.) 表示。\n- **常量：**\n  - 平衡节点电压平方: $v_1$。\n  - 线路阻抗: $r_{12}, x_{12}, r_{23}, x_{23}$。\n  - 节点功率消耗（负载）: $p_2, q_2, p_3, q_3$。\n- **模型方程（支路潮流模型）：**\n  - 功率平衡：\n    - $p_{23} = p_{3} + r_{23} \\ell_{23}$\n    - $q_{23} = q_{3} + x_{23} \\ell_{23}$\n    - $p_{12} = p_{2} + p_{23} + r_{12} \\ell_{12}$\n    - $q_{12} = q_{2} + q_{23} + x_{12} \\ell_{12}$\n  - 电压降：\n    - $v_2 = v_1 - 2(r_{12} p_{12} + x_{12} q_{12}) + (r_{12}^2 + x_{12}^2) \\ell_{12}$\n    - $v_3 = v_2 - 2(r_{23} p_{23} + x_{23} q_{23}) + (r_{23}^2 + x_{23}^2) \\ell_{23}$\n- **SOCP 松弛约束：**\n  - $\\ell_{12} v_{1} \\ge p_{12}^{2} + q_{12}^{2}$\n  - $\\ell_{23} v_{2} \\ge p_{23}^{2} + q_{23}^{2}$\n- **目标函数：** 最小化总有功功率损耗，$\\min \\sum_{(i,j)} r_{ij} \\ell_{ij}$。\n- **箱式约束：**\n  - 电压: $v_{\\min}^{2} \\le v_i \\le v_{\\max}^{2}$ 对于 $i \\in \\{2, 3\\}$。\n  - 电流: $\\ell_{ij} \\le I_{\\max,ij}^{2}$。\n- **算法规范：**\n  - 利用最优性条件 $\\ell_{ij} v_i = p_{ij}^2 + q_{ij}^2$ 的迭代方法。\n  - 迭代更新 $(p_{ij}, q_{ij}, v_i, \\ell_{ij})$。\n  - 使用松弛参数 $\\alpha \\in (0,1)$。\n  - 收敛容差: $\\ell_{12}, \\ell_{23}$ 的最大变化小于 $10^{-10}$。\n  - 最大迭代次数: $10000$。\n  - 应检查电流限制，但对于给定的测试案例，预计不会被激活。\n  - 电压限制仅为背景信息；即使计算值超出范围，算法也应报告它们。\n- **测试套件：** 三个不同的案例 (A, B, C)，所有参数均有指定数值。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题基于电力配电系统中成熟的支路潮流 (DistFlow) 模型，该模型是基本电路定律（KCL、KVL、Ohm 定律）的直接应用。AC OPF 问题的 SOCP 松弛是电力系统优化中一个经过严格研究的标准技术。最小化功率损耗的目标具有物理意义和经济重要性。该问题是科学合理的。\n- **适定性：** 该问题描述了一个凸优化问题（一个 SOCP），其目标函数是严格凸的（因为 $r_{ij} > 0$）。此类问题具有唯一的最优解。模型和测试案例所需的所有参数都已提供。指定的迭代算法是一种定点迭代法，是求解由最优性条件产生的方程组的有效方法。该问题是适定的。\n- **客观性：** 问题陈述以精确、量化和技术性的语言编写。它没有歧义、主观性或个人观点。\n- **完整性和一致性：** 模型方程、约束、目标以及所有必需的数值数据都已完全指定。所提供的信息中没有矛盾之处。\n- **现实性：** 阻抗、负载和电压/电流限制的标幺值代表了典型的配电网络。\n\n**1.3. 结论和行动**\n\n问题有效。这是一个定义明确、有科学依据的计算电力系统工程练习。将提供一个解决方案。\n\n### 步骤 2：解决方案\n\n问题的核心是求解一个非线性方程组，该方程组代表了 SOCP 松弛最优潮流问题的 Karush-Kuhn-Tucker (KKT) 最优性条件。问题中指定的迭代算法是一种定点迭代法，具体是一种带有松弛参数的逐次代换法，旨在找到该系统的解。\n\n**基于原理的算法设计**\n\n该算法被构造为一系列更新，模仿了辐射状网络中信息的物理流动。它包括一个“后向扫描”，用于从网络末端向源头计算潮流；一个“前向扫描”，用于从源头向外计算电压；以及一个用于更新电流幅值平方的步骤，该步骤将前后向扫描耦合在一起。\n\n1.  **模型推导和结构：**\n    所提供的方程构成了辐射状馈线的完整模型。\n    - **功率平衡（后向传播）：** 对于任何节点 $j$，从其父节点 $i$ 流入的功率 $S_{ij} = p_{ij} + \\mathrm{i} q_{ij}$ 必须供应本地负载 $S_j^{\\text{load}} = p_j + \\mathrm{i} q_j$、流向其子节点的功率 ($S_{jk}$) 以及线路段 $ij$ 上的损耗。给出的方程是该原理针对简单线路拓扑的重新排列。例如，对于线路段 $1 \\rightarrow 2$：\n    $$p_{12} = p_2 + p_{23} + r_{12} \\ell_{12}$$\n    这里，$p_2$ 是节点 $2$ 的负载，$p_{23}$ 是流向节点 $3$ 的功率，$r_{12} \\ell_{12}$ 是线路 $1 \\rightarrow 2$ 上的有功功率损耗。这种结构非常适合从最后一个没有出线的节点（$3$）开始的后向扫描。\n\n    - **电压降（前向传播）：** 下游节点 $j$ 的电压是上游节点 $i$ 的电压减去沿线路的电压降。给定的方程是电压幅值平方的精确表达式：\n    $$v_j = v_i - 2(r_{ij} p_{ij} + x_{ij} q_{ij}) + (r_{ij}^2 + x_{ij}^2) \\ell_{ij}$$\n    这自然适合于从电压 $v_1$ 已知且固定的平衡节点（$1$）开始的前向扫描。\n\n    - **SOCP 等式（耦合关系）：** 非凸的潮流约束 $p_{ij}^2 + q_{ij}^2 = v_i \\ell_{ij}$ 被松弛为 $p_{ij}^2 + q_{ij}^2 \\le v_i \\ell_{ij}$。一个关键的洞见是，对于一个惩罚损耗的目标函数（即在 $r_{ij} > 0$ 的情况下最小化 $\\sum r_{ij}\\ell_{ij}$），优化过程会将 $\\ell_{ij}$ 推向其可能的最小值。满足该约束的 $\\ell_{ij}$ 的最小值是在等式成立时取到。因此，在最优点（假设没有其他约束被激活），我们有：\n    $$\\ell_{ij} = \\frac{p_{ij}^2 + q_{ij}^2}{v_i}$$\n    该方程被用作迭代更新电流平方变量 $\\ell_{ij}$ 的基础。\n\n2.  **迭代求解方案：**\n    我们可以通过对电流平方 $\\ell_{12}^{(k)}$ 和 $\\ell_{23}^{(k)}$（其中 $k$ 是迭代索引）设置一个初始猜测值，然后循环遍历这些方程来构建一个迭代算法。\n\n    - **初始化：** 设 $k=0$。设置初始猜测值 $\\ell_{12}^{(0)} = 0$ 和 $\\ell_{23}^{(0)} = 0$。这对应于“无潮流”的初始状态。\n\n    - **迭代 $k+1$：**\n        1.  **后向扫描（潮流）：** 使用上一次迭代的值 $\\ell_{12}^{(k)}$ 和 $\\ell_{23}^{(k)}$，计算当前迭代的潮流。我们从馈线的末端开始：\n            $$p_{23}^{(k+1)} = p_3 + r_{23} \\ell_{23}^{(k)}$$\n            $$q_{23}^{(k+1)} = q_3 + x_{23} \\ell_{23}^{(k)}$$\n            然后上移到下一个线路段：\n            $$p_{12}^{(k+1)} = p_2 + p_{23}^{(k+1)} + r_{12} \\ell_{12}^{(k)}$$\n            $$q_{12}^{(k+1)} = q_2 + q_{23}^{(k+1)} + x_{12} \\ell_{12}^{(k)}$$\n\n        2.  **前向扫描（电压）：** 使用新计算的潮流，计算当前迭代的电压。我们从已知的平衡节点电压 $v_1$ 开始：\n            $$v_2^{(k+1)} = v_1 - 2(r_{12} p_{12}^{(k+1)} + x_{12} q_{12}^{(k+1)}) + (r_{12}^2 + x_{12}^2) \\ell_{12}^{(k)}$$\n            $$v_3^{(k+1)} = v_2^{(k+1)} - 2(r_{23} p_{23}^{(k+1)} + x_{23} q_{23}^{(k+1)}) + (r_{23}^2 + x_{23}^2) \\ell_{23}^{(k)}$$\n\n        3.  **更新电流平方 ($\\ell$)：** 使用最优性条件以及最新的电压和潮流值，计算电流平方的新的试验值。\n            $$\\ell_{12}^{\\text{trial}} = \\frac{(p_{12}^{(k+1)})^2 + (q_{12}^{(k+1)})^2}{v_1}$$\n            $$\\ell_{23}^{\\text{trial}} = \\frac{(p_{23}^{(k+1)})^2 + (q_{23}^{(k+1)})^2}{v_2^{(k+1)}}$$\n            问题要求检查电流限制，所以我们将试验值限制在上限：\n            $$\\ell_{ij}^{\\text{new}} = \\min(\\ell_{ij}^{\\text{trial}}, I_{\\max,ij}^2)$$\n\n        4.  **松弛：** 为了提高收敛稳定性，通过取旧值和新试验值的加权平均来形成 $\\ell_{ij}$ 的新值，使用一个松弛参数 $\\alpha \\in (0, 1)$。\n            $$\\ell_{12}^{(k+1)} = (1-\\alpha)\\ell_{12}^{(k)} + \\alpha \\ell_{12}^{\\text{new}}$$\n            $$\\ell_{23}^{(k+1)} = (1-\\alpha)\\ell_{23}^{(k)} + \\alpha \\ell_{23}^{\\text{new}}$$\n\n    - **收敛性检查：** 重复该过程，直到迭代变量的变化可以忽略不计，即 $\\max(|\\ell_{12}^{(k+1)} - \\ell_{12}^{(k)}|, |\\ell_{23}^{(k+1)} - \\ell_{23}^{(k)}|) < 10^{-10}$，或达到最大迭代次数。\n\n    - **最终结果：** 一旦循环终止，收敛的 $\\ell_{12}$ 和 $\\ell_{23}$ 值将用于最后一次后向和前向扫描，以计算最终的一致变量集 $(p_{12}, p_{23}, q_{12}, q_{23}, \\ell_{12}, \\ell_{23}, v_{2}, v_{3})$。这确保所有报告的值都满足使用收敛电流的模型方程。\n\n该算法将针对所提供的三个测试案例中的每一个进行实现。",
            "answer": "```python\nimport numpy as np\n\ndef run_solver_for_case(params):\n    \"\"\"\n    Solves the SOCP-relaxed branch flow problem for a single case using an iterative method.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n\n    Returns:\n        list: A list of the 8 solution variables in the order\n              [p12, p23, q12, q23, l12, l23, v2, v3].\n    \"\"\"\n    # Algorithm constants\n    TOL = 1e-10\n    MAX_ITER = 10000\n    ALPHA = 0.5  # Relaxation parameter, strictly between 0 and 1\n\n    # Extract parameters from the dictionary for clarity\n    v1 = params['v1']\n    r12, x12 = params['r12'], params['x12']\n    r23, x23 = params['r23'], params['x23']\n    p2_load, q2_load = params['p2'], params['q2']\n    p3_load, q3_load = params['p3'], params['q3']\n    Imax12_sq = params['Imax12_sq']\n    Imax23_sq = params['Imax23_sq']\n\n    # Pre-calculate squared line impedances\n    z12_sq = r12**2 + x12**2\n    z23_sq = r23**2 + x23**2\n\n    # Initialize the iteration variables (squared current magnitudes)\n    l12 = 0.0\n    l23 = 0.0\n\n    for _ in range(MAX_ITER):\n        l12_old, l23_old = l12, l23\n\n        # --- Backward Sweep: Compute power flows from leaf to root ---\n        # Power flow on line 2->3\n        p23 = p3_load + r23 * l23\n        q23 = q3_load + x23 * l23\n        \n        # Power flow on line 1->2\n        p12 = p2_load + p23 + r12 * l12\n        q12 = q2_load + q23 + x12 * l12\n\n        # --- Forward Sweep: Compute voltages from root to leaf ---\n        # Voltage at bus 2\n        v2 = v1 - 2 * (r12 * p12 + x12 * q12) + z12_sq * l12\n        \n        # Voltage at bus 3\n        v3 = v2 - 2 * (r23 * p23 + x23 * q23) + z23_sq * l23\n\n        # --- Update Step: Compute new squared currents ---\n        # The iterative scheme can diverge if v2 becomes non-positive.\n        # The test cases are feasible, so we assume v2 > 0.\n        if v2 <= 0:\n            # In a robust solver, this would require error handling.\n            # Here we can break as this indicates divergence.\n            break\n            \n        # New trial values for l12 and l23 based on SOCP equality\n        l12_new_trial = (p12**2 + q12**2) / v1\n        l23_new_trial = (p23**2 + q23**2) / v2\n\n        # Enforce current limits (as per problem, these will not bind)\n        l12_new = min(l12_new_trial, Imax12_sq)\n        l23_new = min(l23_new_trial, Imax23_sq)\n\n        # Apply relaxation for stability\n        l12 = (1 - ALPHA) * l12_old + ALPHA * l12_new\n        l23 = (1 - ALPHA) * l23_old + ALPHA * l23_new\n\n        # --- Convergence Check ---\n        error = max(abs(l12 - l12_old), abs(l23 - l23_old))\n        if error < TOL:\n            break\n\n    # After convergence, perform one final calculation for fully consistent results\n    p23 = p3_load + r23 * l23\n    q23 = q3_load + x23 * l23\n    p12 = p2_load + p23 + r12 * l12\n    q12 = q2_load + q23 + x12 * l12\n    v2 = v1 - 2 * (r12 * p12 + x12 * q12) + z12_sq * l12\n    v3 = v2 - 2 * (r23 * p23 + x23 * q23) + z23_sq * l23\n\n    return [p12, p23, q12, q23, l12, l23, v2, v3]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the final results.\n    \"\"\"\n    test_cases = [\n        # Case A: moderate load\n        {\n            'v1': 1.0, 'r12': 0.005, 'x12': 0.010, 'r23': 0.006, 'x23': 0.012,\n            'p2': 0.50, 'q2': 0.15, 'p3': 0.35, 'q3': 0.10,\n            'Imax12_sq': 4.0, 'Imax23_sq': 4.0\n        },\n        # Case B: heavier load\n        {\n            'v1': 1.0, 'r12': 0.005, 'x12': 0.010, 'r23': 0.006, 'x23': 0.012,\n            'p2': 0.60, 'q2': 0.20, 'p3': 0.45, 'q3': 0.15,\n            'Imax12_sq': 4.0, 'Imax23_sq': 4.0\n        },\n        # Case C: edge with downstream bus lightly loaded\n        {\n            'v1': 1.0, 'r12': 0.005, 'x12': 0.010, 'r23': 0.006, 'x23': 0.012,\n            'p2': 0.40, 'q2': 0.00, 'p3': 0.00, 'q3': 0.00,\n            'Imax12_sq': 4.0, 'Imax23_sq': 4.0\n        }\n    ]\n    \n    results = []\n    for case_params in test_cases:\n        result = run_solver_for_case(case_params)\n        results.append(result)\n\n    # Format the final output string exactly as specified\n    case_strings = []\n    for res in results:\n        res_str = f'[{\",\".join(f\"{v:.6f}\" for v in res)}]'\n        case_strings.append(res_str)\n    \n    final_output = f'[{\",\".join(case_strings)}]'\n    print(final_output)\n\nsolve()\n\n```"
        },
        {
            "introduction": "对于大型互联电网，直接应用全局的半定规划约束 $W \\succeq 0$ 在计算上是不可行的。本练习将探讨一种关键的图论技术——弦图分解，该技术利用电网的稀疏性，将一个庞大的全局约束分解为一组规模更小且相互耦合的约束。通过这种方式，您可以理解如何让 SDP 松弛方法在求解现实世界的大规模电力系统问题时变得切实可行 。",
            "id": "4081224",
            "problem": "考虑基于电压乘积矩阵 $W = v v^{\\ast}$ 的交流最优潮流 (AC OPF) 问题的半定松弛，其中 $v \\in \\mathbb{C}^{6}$ 是复母线电压向量，$v^{\\ast}$ 表示复共轭转置。该松弛利用了由母线导纳矩阵 $Y \\in \\mathbb{C}^{6 \\times 6}$ 引起的稀疏性：如果 $Y_{ij} = 0$，则 $W_{ij}$ 不受网络耦合的限制；如果 $Y_{ij} \\neq 0$，则 $W_{ij}$ 会出现在约束条件中。$Y$ 的稀疏模式可以由一个无向图 $G = (V, E)$ 表示，该图构建在母线集合 $V = \\{1,2,3,4,5,6\\}$ 上，当且仅当 $Y_{ij} \\neq 0$ 时，图中存在一条边 $\\{i,j\\} \\in E$。\n\n假设这个 6 母线网络的 $Y$ 矩阵有以下与输电线路对应的非零非对角线元素：\n$$E = \\big\\{\\{1,2\\}, \\{1,3\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{6,3\\}\\big\\}.$$\n该图由 $\\{1,2,3\\}$ 上的一个团和 $\\{3,4,5,6\\}$ 上的一个 4-环组成。\n\n为了对全局正半定 (PSD) 约束 $W \\succeq 0$ 应用弦分解，必须构造图 $G$ 的一个弦化扩展（三角化），通过添加尽可能少的填充边来打破所有无弦环。对于 $G$ 的任意最小弦化扩展 $\\widehat{G} = (V, \\widehat{E})$，令 $\\mathcal{C}_{\\max}$ 表示 $\\widehat{G}$ 的极大团集合，这些极大团用于对 $W$ 的相应主子矩阵施加分解的 PSD 约束。\n\n任务：\n- 确定给定稀疏模式的一个具有最少填充边的弦化扩展，并列出其极大团 $\\mathcal{C}_{\\max}$。\n- 定义标量\n$$S \\;=\\; \\text{(最小弦化扩展中添加的填充边数量)} \\;+\\; \\sum_{C \\in \\mathcal{C}_{\\max}} |C|,$$\n其中 $|C|$ 是团 $C$ 的基数。\n精确计算 $S$。将 $S$ 的最终值表示为一个无单位的精确整数。无需四舍五入。",
            "solution": "该问题要求计算一个与给定图 $G=(V, E)$ 的最小弦化扩展相关的标量 $S$。该图表示一个 6 母线电力系统的母线导纳矩阵 $Y$ 的稀疏模式。\n\n首先，我们根据所提供的信息定义图 $G$。顶点（母线）集合为 $V = \\{1, 2, 3, 4, 5, 6\\}$。边（输电线路）集合由 $E = \\big\\{\\{1,2\\}, \\{1,3\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{6,3\\}\\big\\}$ 给出。如问题所述，该图由顶点 $\\{1,2,3\\}$ 上的一个团和顶点 $\\{3,4,5,6\\}$ 上的一个长度为 4 的环组成，它们在公共顶点 $3$ 处相连。\n\n如果一个图不包含长度为 4 或更长的导出环，则该图被定义为弦图。导出环是一个环，其中连接其顶点的边仅为该环自身的边。我们必须检查图 $G$ 是否存在此类无弦环。\n由顶点 $\\{1,2,3\\}$ 导出的子图是一个团 ($K_3$)，因此不包含无弦环。\n由顶点 $\\{3,4,5,6\\}$ 导出的子图包含边 $\\{3,4\\}$, $\\{4,5\\}$, $\\{5,6\\}$ 和 $\\{6,3\\}$。这些边构成一个环 $3-4-5-6-3$。在图 $G$ 中，没有其他边连接这四个顶点中的任意一对。例如，边 $\\{3,5\\}$ 和 $\\{4,6\\}$ 不在 $E$ 中。因此，环 $3-4-5-6-3$ 是一个长度为 4 的导出环。这是 $G$ 中唯一的长度 $\\geq 4$ 的导出环。\n\n为了获得 $G$ 的弦化扩展，我们必须添加边（称为填充边）来打破所有无弦环。任务要求一个最小弦化扩展，具体来说是“添加尽可能少的填充边”的扩展。这意味着我们在寻找一个最小弦化扩展（或最小三角化）。为了打破 4-环 $3-4-5-6-3$，我们必须至少添加一条弦。弦是连接环中两个不相邻顶点的边。可能的弦是 $\\{3,5\\}$ 和 $\\{4,6\\}$。\n\n只需添加其中一条弦就足以使整个图 $G$ 成为弦图。例如，如果我们添加边 $\\{3,5\\}$，4-环 $3-4-5-6-3$ 就被分解为两个 3-环，$3-4-5-3$ 和 $3-5-6-3$。由于原始图只有一个无弦环，添加这条边后就得到了一个弦图。因此，所需的最小填充边数量为 $1$。\n\n让我们通过添加填充边 $\\{3,5\\}$ 来构造一个最小弦化扩展 $\\widehat{G}=(V, \\widehat{E})$。新的边集为 $\\widehat{E} = E \\cup \\{\\{3,5\\}\\}$。填充边的数量为 $1$。\n\n接下来，我们必须找到弦图 $\\widehat{G}$ 的极大团集合 $\\mathcal{C}_{\\max}$。极大团是一个完全子图，且它不是任何更大的完全子图的子集。\n1. 顶点 $\\{1,2,3\\}$ 在 $G$ 中和 $\\widehat{G}$ 中都形成一个团。为了检查它是否是极大的，我们测试是否可以添加任何其他顶点。顶点 $4$、$5$ 和 $6$ 并没有与 $\\{1,2,3\\}$ 中的所有三个顶点都相连。例如，顶点 $4$ 没有与 $1$ 或 $2$ 相连。因此，$\\{1,2,3\\}$ 是一个极大团。\n2. 添加了填充边 $\\{3,5\\}$ 后，顶点 $\\{3,4,5\\}$ 现在形成一个团。这些边是 $\\{3,4\\} \\in E$，$\\{4,5\\} \\in E$ 和 $\\{3,5\\} \\in \\widehat{E} \\setminus E$。为了检查其极大性，我们测试其他顶点。顶点 $6$ 与 $3$ 和 $5$ 相连，但与 $4$ 不相连。没有其他顶点与这三个顶点都相连。因此，$\\{3,4,5\\}$ 是一个极大团。\n3. 类似地，顶点 $\\{3,5,6\\}$ 形成一个团。这些边是 $\\{3,6\\} \\in E$，$\\{5,6\\} \\in E$ 和 $\\{3,5\\} \\in \\widehat{E} \\setminus E$。为了检查其极大性，顶点 $4$ 与 $3$ 和 $5$ 相连，但与 $6$ 不相连。因此，$\\{3,5,6\\}$ 是另一个极大团。\n\n这三个团覆盖了图的所有顶点。我们已经系统地识别了所有的极大团。$\\widehat{G}$ 的极大团集合是 $\\mathcal{C}_{\\max} = \\big\\{\\{1,2,3\\}, \\{3,4,5\\}, \\{3,5,6\\}\\big\\}$。\n\n问题将标量 $S$ 定义为：\n$$S \\;=\\; (\\text{添加的填充边数量}) \\;+\\; \\sum_{C \\in \\mathcal{C}_{\\max}} |C|$$\n我们已经发现填充边的数量是 $1$。极大团的基数之和为：\n$$\\sum_{C \\in \\mathcal{C}_{\\max}} |C| = |\\{1,2,3\\}| + |\\{3,4,5\\}| + |\\{3,5,6\\}| = 3 + 3 + 3 = 9$$\n因此，$S$ 的值为：\n$$S = 1 + 9 = 10$$\n请注意，如果我们选择了另一个可能的填充边 $\\{4,6\\}$，得到的最小弦化扩展将会有极大团 $\\mathcal{C}_{\\max} = \\big\\{\\{1,2,3\\}, \\{3,4,6\\}, \\{4,5,6\\}\\big\\}$。基数之和仍为 $3+3+3=9$，并且在有 1 个填充边的情况下，$S$ 的值仍为 $10$，这证实了该问题的良定性。",
            "answer": "$$\n\\boxed{10}\n$$"
        }
    ]
}