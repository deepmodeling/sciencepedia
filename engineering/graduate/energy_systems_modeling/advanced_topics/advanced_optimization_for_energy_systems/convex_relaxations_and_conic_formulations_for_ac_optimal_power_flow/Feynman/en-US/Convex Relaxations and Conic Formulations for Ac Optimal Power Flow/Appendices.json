{
    "hands_on_practices": [
        {
            "introduction": "Before exploring convex relaxations, it is essential to first construct the original non-convex Alternating Current Optimal Power Flow (AC OPF) problem from fundamental principles. This foundational exercise  will guide you through expressing power flow equations, voltage limits, and branch constraints in rectangular coordinates, revealing the quadratic terms that make the problem computationally challenging. By building the model from the ground up, you will gain a clear understanding of why relaxations are necessary and how the problem can be reformulated using lifted variables.",
            "id": "4081226",
            "problem": "Consider a three-bus transmission network modeled in per-unit with the nodal bus admittance matrix $Y \\in \\mathbb{C}^{3 \\times 3}$ given by\n$$\nY \\;=\\; \\begin{pmatrix}\n7 - \\mathrm{j}22 & -4 + \\mathrm{j}16 & -3 + \\mathrm{j}12 \\\\\n-4 + \\mathrm{j}16 & 6.5 - \\mathrm{j}23 & -2.5 + \\mathrm{j}10 \\\\\n-3 + \\mathrm{j}12 & -2.5 + \\mathrm{j}10 & 5.5 - \\mathrm{j}20\n\\end{pmatrix},\n$$\nwhere $\\mathrm{j}$ denotes $\\sqrt{-1}$, and the real and imaginary parts of $Y$ are denoted by $G$ and $B$, respectively, with $Y_{ik} = G_{ik} + \\mathrm{j} B_{ik}$. Bus loads are specified as $(P_{1}^{d}, Q_{1}^{d}) = (1.0, 0.5)$, $(P_{2}^{d}, Q_{2}^{d}) = (0.8, 0.3)$, and $(P_{3}^{d}, Q_{3}^{d}) = (1.2, 0.6)$. There are two generators: one at bus $1$ with quadratic active power cost coefficients $(a_{1}, b_{1}, c_{1}) = (10, 6, 0.2)$ and one at bus $2$ with $(a_{2}, b_{2}, c_{2}) = (12, 5, 0.1)$. Generator capability limits are $0 \\leq P_{1}^{g} \\leq 3$, $-1 \\leq Q_{1}^{g} \\leq 1$, and $0 \\leq P_{2}^{g} \\leq 2$, $-0.8 \\leq Q_{2}^{g} \\leq 0.8$. Voltage magnitudes satisfy $0.95 \\leq |V_{i}| \\leq 1.05$ for $i \\in \\{1,2,3\\}$. Branch series admittances are $y_{12} = 4 - \\mathrm{j}16$, $y_{13} = 3 - \\mathrm{j}12$, and $y_{23} = 2.5 - \\mathrm{j}10$, with corresponding apparent power limits $S_{12,\\max} = 2.5$, $S_{13,\\max} = 2.0$, and $S_{23,\\max} = 2.0$. Use a rectangular voltage coordinate representation $V_{i} = v_{i,r} + \\mathrm{j} v_{i,i}$, and fix the angular reference by $v_{1,i} = 0$ and $v_{1,r} \\geq 0$.\n\nStarting only from network fundamentals (Kirchhoff’s laws and Ohm’s law), construct the complete Alternating Current Optimal Power Flow (AC OPF) in rectangular form with explicit algebraic expressions for:\n- the nodal complex power balance constraints at each bus,\n- the voltage-magnitude bounds,\n- the generator active and reactive power bounds,\n- the branch apparent power limits,\n- the angle reference.\n\nThen, introduce the lifted voltage product matrix $W \\in \\mathbb{C}^{3 \\times 3}$ defined by $W_{ik} = V_{i} V_{k}^{*}$, where $^{*}$ denotes complex conjugation, and derive a Second-Order Cone (SOC) relaxation of the $2 \\times 2$ principal minor corresponding to buses $1$ and $2$. Finally, define the scalar\n$$\n\\Xi \\;=\\; \\left(W_{11} + W_{22}\\right)^{2} \\;-\\; \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2},\n$$\nwhere $W_{12,r} = \\Re(W_{12})$ and $W_{12,i} = \\Im(W_{12})$, and report $\\Xi$ in simplest expanded form as an analytic expression in the entries of $W$. Express your final answer as a single symbolic expression. No numerical rounding is required.",
            "solution": "The problem statement has been critically validated and is deemed sound. It is scientifically grounded in the principles of power systems engineering, specifically the Alternating Current Optimal Power Flow (AC OPF) problem. The provided data is self-contained, consistent, and well-defined. The tasks are objective and formalizable, leading to a unique, meaningful solution for the specified calculations. Therefore, I will proceed with a complete solution.\n\nThe problem requires a three-part solution: first, the construction of the AC OPF problem in rectangular coordinates; second, the derivation of a Second-Order Cone (SOC) relaxation for a specific subproblem; and third, the calculation of a scalar quantity $\\Xi$.\n\n### Part 1: AC OPF Problem Formulation\nThe AC OPF problem seeks to minimize the total cost of generation subject to a set of physical and operational constraints. The decision variables are the real and imaginary parts of the complex bus voltages, $V_i = v_{i,r} + \\mathrm{j} v_{i,i}$ for $i \\in \\{1,2,3\\}$, and the real and reactive power outputs of the generators, $(P_1^g, Q_1^g)$ and $(P_2^g, Q_2^g)$.\n\n**Objective Function:**\nThe objective is to minimize the total quadratic cost of active power generation:\n$$ \\min_{P_1^g, P_2^g} C(P_1^g, P_2^g) = (a_1(P_1^g)^2 + b_1 P_1^g + c_1) + (a_2(P_2^g)^2 + b_2 P_2^g + c_2) $$\n\n**Constraints:**\n\n1.  **Nodal Power Balance Constraints:** For each bus $i \\in \\{1,2,3\\}$, the net injected complex power $S_i^{\\text{inj}} = P_i^{\\text{inj}} + \\mathrm{j} Q_i^{\\text{inj}}$ must balance the power flowing into the transmission network. The net injected power is the generation minus the load, $P_i^{\\text{inj}} = P_i^g - P_i^d$ and $Q_i^{\\text{inj}} = Q_i^g - Q_i^d$. Note that for bus $3$, $P_3^g = Q_3^g = 0$. The power flowing into the network from bus $i$ is $S_i = V_i I_i^* = V_i (\\sum_{k=1}^3 Y_{ik} V_k)^*$. Expanding this into real and imaginary parts with $V_i = v_{i,r} + \\mathrm{j} v_{i,i}$ and $Y_{ik} = G_{ik} + \\mathrm{j} B_{ik}$ yields:\n    $$ P_i^g - P_i^d = \\sum_{k=1}^3 \\left[ G_{ik}(v_{i,r}v_{k,r} + v_{i,i}v_{k,i}) + B_{ik}(v_{i,i}v_{k,r} - v_{i,r}v_{k,i}) \\right], \\quad \\forall i \\in \\{1,2,3\\} $$\n    $$ Q_i^g - Q_i^d = \\sum_{k=1}^3 \\left[ G_{ik}(v_{i,i}v_{k,r} - v_{i,r}v_{k,i}) - B_{ik}(v_{i,r}v_{k,r} + v_{i,i}v_{k,i}) \\right], \\quad \\forall i \\in \\{1,2,3\\} $$\n\n2.  **Voltage Magnitude Bounds:** The voltage magnitude at each bus must remain within specified limits, $V_i^{\\min} \\leq |V_i| \\leq V_i^{\\max}$. In rectangular coordinates, this is a pair of quadratic constraints:\n    $$ (V_i^{\\min})^2 \\leq v_{i,r}^2 + v_{i,i}^2 \\leq (V_i^{\\max})^2, \\quad \\forall i \\in \\{1,2,3\\} $$\n    Using the given values, $(0.95)^2 \\leq v_{i,r}^2 + v_{i,i}^2 \\leq (1.05)^2$.\n\n3.  **Generator Capability Limits:** The active and reactive power outputs of each generator are bounded:\n    $$ 0 \\leq P_1^g \\leq 3, \\quad -1 \\leq Q_1^g \\leq 1 $$\n    $$ 0 \\leq P_2^g \\leq 2, \\quad -0.8 \\leq Q_2^g \\leq 0.8 $$\n\n4.  **Branch Apparent Power Limits:** The magnitude of the apparent power flow $S_{ik}$ on each branch must not exceed its limit $S_{ik, \\max}$. For a branch between buses $i$ and $k$ with series admittance $y_{ik}$, the complex power leaving bus $i$ is $S_{ik} = V_i I_{ik}^*$, where $I_{ik} = y_{ik}(V_i - V_k)$. Thus, $S_{ik} = y_{ik}^*(|V_i|^2 - V_i V_k^*)$. The constraint is $|S_{ik}|^2 \\leq (S_{ik, \\max})^2$, which expands to:\n    $$ |y_{ik}|^2 \\left[ \\left( (v_{i,r}^2+v_{i,i}^2) - (v_{i,r}v_{k,r}+v_{i,i}v_{k,i}) \\right)^2 + \\left( v_{i,r}v_{k,i} - v_{i,i}v_{k,r} \\right)^2 \\right] \\leq (S_{ik,\\max})^2 $$\n    This inequality holds for the branches $(1,2)$, $(1,3)$, and $(2,3)$.\n\n5.  **Angle Reference:** To remove the degree of freedom in the voltage phase angles, one bus is designated as the reference. For bus $1$, the angle is set to zero, which in rectangular coordinates is enforced by:\n    $$ v_{1,i} = 0, \\quad v_{1,r} \\geq 0 $$\n\n### Part 2: SOC Relaxation\nThe AC OPF problem is non-convex due to the quadratic power flow and branch limit equations. A common approach to find a good solution is to use a convex relaxation. We introduce the lifted voltage product matrix $W$ with elements $W_{ik} = V_i V_k^*$. This matrix is, by construction, Hermitian, positive semidefinite, and has rank one ($W = \\mathbf{v}\\mathbf{v}^\\mathrm{H}$, where $\\mathbf{v}=[V_1, V_2, V_3]^\\mathrm{T}$). The non-convexity is encapsulated in the rank-one constraint.\n\nThe semidefinite programming (SDP) relaxation of AC OPF involves dropping the rank constraint, requiring only $W \\succeq 0$. A necessary condition for $W \\succeq 0$ is that all of its principal minors are positive semidefinite. An SOC relaxation is a weaker (more relaxed) but computationally cheaper alternative to SDP, which often involves enforcing the positive semidefiniteness of only the $2 \\times 2$ principal minors of $W$.\n\nConsider the $2 \\times 2$ principal minor of $W$ corresponding to buses $1$ and $2$:\n$$ W_{1,2} = \\begin{pmatrix} W_{11} & W_{12} \\\\ W_{21} & W_{22} \\end{pmatrix} $$\nFor this submatrix to be positive semidefinite, its diagonal entries must be non-negative ($W_{11} \\geq 0, W_{22} \\geq 0$, which is true since $W_{ii}=|V_i|^2$), and its determinant must be non-negative.\n$$ \\det(W_{1,2}) = W_{11}W_{22} - W_{12}W_{21} \\geq 0 $$\nSince $W$ is Hermitian, $W_{21} = W_{12}^*$, so the condition is $W_{11}W_{22} - |W_{12}|^2 \\geq 0$. With $W_{12} = W_{12,r} + \\mathrm{j} W_{12,i}$, we have:\n$$ W_{11}W_{22} \\geq W_{12,r}^2 + W_{12,i}^2 $$\nThis inequality can be represented as a standard second-order cone constraint. Through algebraic manipulation:\n$$ 4W_{11}W_{22} \\geq 4W_{12,r}^2 + 4W_{12,i}^2 $$\n$$ (W_{11}+W_{22})^2 - (W_{11}-W_{22})^2 \\geq (2W_{12,r})^2 + (2W_{12,i})^2 $$\n$$ (W_{11}+W_{22})^2 \\geq (2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11}-W_{22})^2 $$\nSince $W_{11}+W_{22} \\ge 0$, we can take the square root of both sides:\n$$ \\sqrt{(2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11}-W_{22})^2} \\leq W_{11}+W_{22} $$\nThis is a standard SOC constraint of the form $\\|\\mathbf{x}\\|_2 \\leq t$, written as:\n$$ \\left\\| \\begin{pmatrix} 2W_{12,r} \\\\ 2W_{12,i} \\\\ W_{11}-W_{22} \\end{pmatrix} \\right\\|_2 \\leq W_{11}+W_{22} $$\nThis constraint is the SOC relaxation for the $2 \\times 2$ submatrix.\n\n### Part 3: Calculation of $\\Xi$\nThe final task is to compute the scalar $\\Xi$ defined as:\n$$ \\Xi \\;=\\; \\left(W_{11} + W_{22}\\right)^{2} \\;-\\; \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2} $$\nWe expand the squared norm term:\n$$ \\left\\| \\begin{bmatrix} 2\\,W_{12,r} \\\\ 2\\,W_{12,i} \\\\ W_{11} - W_{22} \\end{bmatrix} \\right\\|_{2}^{2} = (2W_{12,r})^2 + (2W_{12,i})^2 + (W_{11} - W_{22})^2 $$\n$$ = 4W_{12,r}^2 + 4W_{12,i}^2 + (W_{11}^2 - 2W_{11}W_{22} + W_{22}^2) $$\nWe also expand the first term in the definition of $\\Xi$:\n$$ (W_{11} + W_{22})^2 = W_{11}^2 + 2W_{11}W_{22} + W_{22}^2 $$\nSubstituting both expansions into the definition of $\\Xi$:\n$$ \\Xi = (W_{11}^2 + 2W_{11}W_{22} + W_{22}^2) - (4W_{12,r}^2 + 4W_{12,i}^2 + W_{11}^2 - 2W_{11}W_{22} + W_{22}^2) $$\nWe remove the parentheses and collect like terms:\n$$ \\Xi = W_{11}^2 + 2W_{11}W_{22} + W_{22}^2 - 4W_{12,r}^2 - 4W_{12,i}^2 - W_{11}^2 + 2W_{11}W_{22} - W_{22}^2 $$\nThe terms $W_{11}^2$ and $W_{22}^2$ cancel. The $W_{11}W_{22}$ terms add up.\n$$ \\Xi = 4W_{11}W_{22} - 4W_{12,r}^2 - 4W_{12,i}^2 $$\nThis is the simplest expanded form of $\\Xi$ as an analytic expression in the specified entries of $W$. It is notable that the condition for the SOC relaxation, $\\left\\| \\ldots \\right\\|_2 \\leq W_{11}+W_{22}$, is equivalent to $\\Xi \\geq 0$. Furthermore, $\\Xi$ is equal to $4$ times the determinant of the $2 \\times 2$ principal minor of $W$.",
            "answer": "$$\n\\boxed{4W_{11}W_{22} - 4W_{12,r}^{2} - 4W_{12,i}^{2}}\n$$"
        },
        {
            "introduction": "The Semidefinite Programming (SDP) relaxation is a powerful technique that transforms the non-convex AC OPF problem into a convex one, guaranteeing a global optimum for the relaxed problem. In this practice problem , you will analyze a simple two-bus network where the SDP relaxation can be solved analytically. By working through the constraints, you will not only find an optimal solution to the relaxed problem but also investigate whether the relaxation is 'exact' by checking if the resulting solution matrix $W$ has a rank of one.",
            "id": "4081204",
            "problem": "Consider a two-bus Alternating Current Optimal Power Flow (AC-OPF) formulation under the Semidefinite Programming (SDP) relaxation in the per-unit system. The buses are connected by a single series branch with resistance $R = 0.05$ and reactance $X = 0.25$. There are no shunts. The series admittance is $$y = \\frac{R - \\mathrm{j} X}{R^{2} + X^{2}} = \\frac{10}{13} - \\mathrm{j}\\frac{50}{13},$$ so the bus admittance matrix is\n$$\nY = \\begin{pmatrix}\ny & -y \\\\\n-y & y\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n\\frac{10}{13} - \\mathrm{j}\\frac{50}{13} & -\\frac{10}{13} + \\mathrm{j}\\frac{50}{13} \\\\\n-\\frac{10}{13} + \\mathrm{j}\\frac{50}{13} & \\frac{10}{13} - \\mathrm{j}\\frac{50}{13}\n\\end{pmatrix}.\n$$\nLet $\\mathbf{v} \\in \\mathbb{C}^{2}$ be the complex bus-voltage vector and let $W = \\mathbf{v}\\mathbf{v}^{\\mathrm{H}} \\in \\mathbb{C}^{2 \\times 2}$ be the lifted Hermitian matrix used in the SDP relaxation. The diagonal entries of $W$ equal the squared voltage magnitudes, i.e., $W_{kk} = |V_{k}|^{2}$.\n\nThe operating specifications are:\n- Voltage-magnitude bounds at both buses: $0.95 \\leq |V_{k}| \\leq 1.05$.\n- No shunt elements and no loads at either bus: $P_{k}^{d} = 0$ and $Q_{k}^{d} = 0$ for $k \\in \\{1,2\\}$.\n- A generator is located at bus $1$ with bounds $0 \\leq P_{1}^{g} \\leq 2$ and $-1 \\leq Q_{1}^{g} \\leq 1$. There is no generator at bus $2$, so $P_{2}^{g} = 0$ and $Q_{2}^{g} = 0$.\n- Linear generation cost at bus $1$: $c_{1} P_{1}^{g}$ for some $c_{1} > 0$ (the numerical value is not needed for feasibility).\n\nThe SDP-relaxed constraints include:\n- $W \\succeq 0$ and $W$ Hermitian.\n- Voltage-magnitude bounds encoded as $0.95^{2} \\leq W_{kk} \\leq 1.05^{2}$ for $k \\in \\{1,2\\}$.\n- Nodal power balance using the lifted variables: for each $k \\in \\{1,2\\}$,\n$$\nP_{k}^{g} - P_{k}^{d} = \\Re\\!\\left(\\sum_{m=1}^{2} Y_{km}^{*} W_{km}\\right), \n\\quad\nQ_{k}^{g} - Q_{k}^{d} = \\Im\\!\\left(\\sum_{m=1}^{2} Y_{km}^{*} W_{km}\\right).\n$$\n\nStarting from the fundamental definitions $I = Y v$ and $S_{k} = V_{k} I_{k}^{*}$, construct an explicit matrix $W \\succeq 0$ that satisfies all the above constraints. Then determine whether this constructed $W$ is rank $1$. Report the rank of $W$ as your final answer (a single integer, unitless). No rounding is required; provide the exact integer.",
            "solution": "The user wants me to solve a problem related to the Semidefinite Programming (SDP) relaxation of an AC Optimal Power Flow (AC-OPF) problem.\n\n### Step 1: Extract Givens\n-   System: Two-bus network.\n-   Relaxation: Semidefinite Programming (SDP).\n-   Branch parameters: Series resistance $R = 0.05$ p.u., series reactance $X = 0.25$ p.u. No shunts.\n-   Series admittance: $y = \\frac{10}{13} - \\mathrm{j}\\,\\frac{50}{13}$ p.u.\n-   Bus admittance matrix: $Y = \\begin{pmatrix} y & -y \\\\ -y & y \\end{pmatrix}$.\n-   Lifted variable: $W = \\mathbf{v}\\mathbf{v}^{\\mathrm{H}} \\in \\mathbb{C}^{2 \\times 2}$, where $\\mathbf{v}$ is the bus voltage vector. $W$ is Hermitian and $W \\succeq 0$.\n-   Diagonal entries: $W_{kk} = |V_{k}|^{2}$.\n-   Voltage bounds: $0.95 \\leq |V_{k}| \\leq 1.05$ for $k \\in \\{1,2\\}$. This translates to $0.95^2 \\leq W_{kk} \\leq 1.05^2$.\n-   Loads: $P_{k}^{d} = 0$ and $Q_{k}^{d} = 0$ for $k \\in \\{1,2\\}$.\n-   Generation at bus 1: $0 \\leq P_{1}^{g} \\leq 2$ and $-1 \\leq Q_{1}^{g} \\leq 1$.\n-   Generation at bus 2: $P_{2}^{g} = 0$ and $Q_{2}^{g} = 0$.\n-   Cost function: Minimize $c_{1} P_{1}^{g}$ where $c_{1} > 0$.\n-   Power balance equations (relaxed): For $k \\in \\{1,2\\}$,\n    -   $P_{k}^{g} - P_{k}^{d} = \\Re\\left(\\sum_{m=1}^{2} Y_{km}^{*} W_{km}\\right) = P_k^{\\text{inj}}$\n    -   $Q_{k}^{g} - Q_{k}^{d} = \\Im\\left(\\sum_{m=1}^{2} Y_{km}^{*} W_{km}\\right) = Q_k^{\\text{inj}}$\n-   Task: Construct a feasible matrix $W \\succeq 0$ and determine its rank.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined, scientifically grounded in the established theory of convex relaxations for power systems optimization, and contains all necessary information. The values provided for resistance, reactance, and the resulting admittance are consistent. The formulation of the SDP-relaxed power flow equations is standard. The presence of a cost function, $c_1 P_1^g$, indicates that the problem is an optimization problem (AC-OPF), not just a feasibility problem. Therefore, constructing a \"solution\" implies finding an *optimal* feasible point, not an arbitrary one.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed to find the optimal solution to the stated SDP-relaxed OPF problem and determine the rank of the resulting matrix $W$.\n\n### Solution\nThe problem is to find a matrix $W$ that satisfies all the given constraints and minimizes the objective function. Let the matrix $W$ be denoted as\n$$\nW = \\begin{pmatrix} W_{11} & W_{12} \\\\ W_{21} & W_{22} \\end{pmatrix}\n$$\nwhere $W$ is Hermitian, i.e., $W_{11}, W_{22} \\in \\mathbb{R}$ and $W_{21} = W_{12}^{*}$.\n\nFirst, we analyze the power balance constraints at bus $2$. At bus $2$, there is no generation and no load, so $P_2^g = 0$, $P_2^d = 0$, $Q_2^g = 0$, and $Q_2^d = 0$. The complex power injection at bus $2$ is zero:\n$$\nS_2^{\\text{inj}} = P_2^{\\text{inj}} + \\mathrm{j} Q_2^{\\text{inj}} = (P_2^g - P_2^d) + \\mathrm{j}(Q_2^g - Q_2^d) = 0\n$$\nThe power balance equation relates this to the matrix $W$:\n$$\nS_2^{\\text{inj}} = \\sum_{m=1}^{2} Y_{2m}^{*} W_{2m} = Y_{21}^{*} W_{21} + Y_{22}^{*} W_{22} = 0\n$$\nFrom the bus admittance matrix, we have $Y_{21} = -y$ and $Y_{22} = y$. Taking their complex conjugates gives $Y_{21}^* = -y^*$ and $Y_{22}^* = y^*$. Substituting these into the equation:\n$$\n(-y^*) W_{21} + (y^*) W_{22} = 0\n$$\n$$\ny^* (W_{22} - W_{21}) = 0\n$$\nThe problem gives $y = \\frac{10}{13} - \\mathrm{j}\\,\\frac{50}{13}$, which is non-zero. Therefore, its conjugate $y^*$ is also non-zero. This implies that the other factor must be zero:\n$$\nW_{22} - W_{21} = 0 \\implies W_{21} = W_{22}\n$$\nSince $W$ is Hermitian, we have $W_{12} = W_{21}^*$. The diagonal element $W_{22}$ is defined as $|V_2|^2$, which is a real number. Thus, $W_{21}$ must be a real number, and $W_{12} = W_{21}$. Combining these findings, we have:\n$$\nW_{12} = W_{21} = W_{22}\n$$\nThe matrix $W$ must therefore have the form:\n$$\nW = \\begin{pmatrix} W_{11} & W_{22} \\\\ W_{22} & W_{22} \\end{pmatrix}\n$$\nFor $W$ to be positive semidefinite ($W \\succeq 0$), its determinant must be non-negative (along with non-negative diagonal entries, which are guaranteed by the voltage bounds).\n$$\n\\det(W) = W_{11}W_{22} - W_{22}^2 = W_{22}(W_{11} - W_{22}) \\ge 0\n$$\nThe voltage bounds are $0.95 \\le |V_k| \\le 1.05$, which implies $W_{kk} = |V_k|^2 \\ge 0.95^2 = 0.9025$. Since $W_{22} > 0$, we can divide the inequality by $W_{22}$ without changing its direction:\n$$\nW_{11} - W_{22} \\ge 0 \\implies W_{11} \\ge W_{22}\n$$\nNow, we consider the power injection at bus $1$.\n$$\nS_1^{\\text{inj}} = P_1^g + \\mathrm{j}Q_1^g = \\sum_{m=1}^{2} Y_{1m}^* W_{1m} = Y_{11}^* W_{11} + Y_{12}^* W_{12}\n$$\nWe have $Y_{11} = y$ and $Y_{12} = -y$, so $Y_{11}^* = y^*$ and $Y_{12}^* = -y^*$. We also know $W_{12} = W_{22}$.\n$$\nS_1^{\\text{inj}} = y^* W_{11} + (-y^*) W_{22} = y^*(W_{11} - W_{22})\n$$\nThe objective is to minimize the generation cost $c_1 P_1^g$ with $c_1 > 0$. This is equivalent to minimizing the active power generation $P_1^g = \\Re(S_1^{\\text{inj}})$.\n$$\nP_1^g = \\Re\\left(y^*(W_{11} - W_{22})\\right)\n$$\nSince $W_{11}$ and $W_{22}$ are real, $W_{11}-W_{22}$ is real. So,\n$$\nP_1^g = \\Re(y^*) (W_{11} - W_{22})\n$$\nWe have $y = \\frac{10}{13} - \\mathrm{j}\\,\\frac{50}{13}$, so $y^* = \\frac{10}{13} + \\mathrm{j}\\,\\frac{50}{13}$. Thus, $\\Re(y^*) = \\frac{10}{13}$.\n$$\nP_1^g = \\frac{10}{13}(W_{11} - W_{22})\n$$\nSince $\\frac{10}{13} > 0$ and we've established that a feasible solution must have $W_{11} \\ge W_{22}$, the minimum possible value of $P_1^g$ is achieved when $W_{11} - W_{22}$ is minimized. The minimum feasible value for $W_{11} - W_{22}$ is $0$. This occurs when $W_{11} = W_{22}$.\n\nLet's check if this is a valid solution. If $W_{11} = W_{22}$, then:\n-   $P_1^g = \\frac{10}{13}(0) = 0$. This satisfies the generation bound $0 \\le 0 \\le 2$.\n-   The reactive power generation is $Q_1^g = \\Im(S_1^{\\text{inj}}) = \\Im(y^*) (W_{11} - W_{22}) = \\frac{50}{13}(0) = 0$. This satisfies the bound $-1 \\le 0 \\le 1$.\n-   We need to select a value $w = W_{11} = W_{22}$ that satisfies the voltage bounds: $0.95^2 \\le w \\le 1.05^2$, which is $0.9025 \\le w \\le 1.1025$.\n-   We can construct an explicit optimal matrix by choosing any $w$ in this range. A simple choice is $w=1$.\n\nWith $w=1$, we have $W_{11}=1$ and $W_{22}=1$. The constructed optimal matrix $W$ is:\n$$\nW = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThis matrix satisfies all constraints:\n-   It is Hermitian.\n-   It is positive semidefinite: $W_{11} = 1 \\ge 0$, and $\\det(W) = 1 \\times 1 - 1 \\times 1 = 0 \\ge 0$.\n-   The voltage bounds are satisfied: $0.9025 \\le W_{11} = 1 \\le 1.1025$ and $0.9025 \\le W_{22} = 1 \\le 1.1025$.\n-   The power balance and generation limits are satisfied, as shown above.\n\nThe final step is to determine the rank of this constructed matrix $W$. The rank of a matrix is the number of linearly independent columns (or rows).\nThe columns of $W$ are $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. These two vectors are identical and therefore linearly dependent.\nSince the matrix is not the zero matrix, its rank is not $0$.\nTherefore, the rank of the matrix $W$ is $1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "While the SDP relaxation is theoretically elegant, applying it to large-scale networks with thousands of buses presents a significant computational hurdle. The key to making it tractable lies in exploiting the inherent sparsity of the power grid, where buses are only connected to a few neighbors. This exercise  delves into the graph-theoretic techniques used to decompose a single large positive semidefinite constraint into a set of smaller, coupled constraints, a process enabled by finding a chordal extension of the network graph.",
            "id": "4081224",
            "problem": "Consider the semidefinite relaxation of the Alternating Current Optimal Power Flow (AC OPF) built on the voltage product matrix $W = \\mathbf{v}\\mathbf{v}^{\\mathrm{H}}$, where $\\mathbf{v} \\in \\mathbb{C}^{6}$ is the complex bus voltage vector and $\\mathbf{v}^{\\mathrm{H}}$ denotes the complex conjugate transpose. The relaxation exploits sparsity induced by the bus admittance matrix $Y \\in \\mathbb{C}^{6 \\times 6}$: if $Y_{ij} = 0$, then $W_{ij}$ is unrestricted by network coupling, and if $Y_{ij} \\neq 0$, then $W_{ij}$ appears in the constraints. The sparsity pattern of $Y$ can be represented by an undirected graph $G = (V, E)$ on the set of buses $V = \\{1,2,3,4,5,6\\}$, with an edge $\\{i,j\\} \\in E$ if and only if $Y_{ij} \\neq 0$.\n\nSuppose the $6$-bus network has the following nonzero off-diagonal entries of $Y$, corresponding to transmission lines: \n$$E = \\big\\{\\{1,2\\}, \\{1,3\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{6,3\\}\\big\\}.$$\nThis graph consists of a clique on $\\{1,2,3\\}$ and a $4$-cycle on $\\{3,4,5,6\\}$.\n\nIn order to apply chordal decomposition of the global positive semidefinite (PSD) constraint $W \\succeq 0$, one must construct a chordal extension (triangulation) of $G$ that adds the fewest possible fill edges to break all chordless cycles. For any minimal chordal extension $\\widehat{G} = (V, \\widehat{E})$ of $G$, let $\\mathcal{C}_{\\max}$ denote the set of maximal cliques of $\\widehat{G}$ used to impose decomposed PSD constraints on the corresponding principal submatrices of $W$.\n\nTask:\n- Determine a chordal extension with minimal fill for the given sparsity pattern and list its maximal cliques $\\mathcal{C}_{\\max}$.\n- Define the scalar \n$$S \\;=\\; \\text{(number of fill edges added in the minimal chordal extension)} \\;+\\; \\sum_{C \\in \\mathcal{C}_{\\max}} |C|,$$\nwhere $|C|$ is the cardinality of the clique $C$.\nCompute $S$ exactly. Express the final value of $S$ as an exact integer with no units. No rounding is required.",
            "solution": "The problem asks for the computation of a scalar $S$ related to a minimal chordal extension of a given graph $G=(V, E)$. The graph represents the sparsity pattern of the bus admittance matrix $Y$ for a $6$-bus power system.\n\nFirst, we define the graph $G$ based on the provided information. The set of vertices (buses) is $V = \\{1, 2, 3, 4, 5, 6\\}$. The set of edges (transmission lines) is given by $E = \\big\\{\\{1,2\\}, \\{1,3\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{6,3\\}\\big\\}$. As noted in the problem, this graph is formed by a clique on the vertices $\\{1,2,3\\}$ and a cycle of length $4$ on the vertices $\\{3,4,5,6\\}$, connected at the common vertex $3$.\n\nA graph is defined as chordal if it contains no induced cycles of length $4$ or greater. An induced cycle is a cycle where the only edges connecting its vertices are the edges of the cycle itself. We must inspect the graph $G$ for such chordless cycles.\nThe subgraph induced by vertices $\\{1,2,3\\}$ is a clique ($K_3$), and thus contains no chordless cycles.\nThe subgraph induced by vertices $\\{3,4,5,6\\}$ consists of the edges $\\{3,4\\}$, $\\{4,5\\}$, $\\{5,6\\}$, and $\\{6,3\\}$. These form a cycle $3-4-5-6-3$. There are no other edges in $G$ connecting any pair of these four vertices. For instance, the edges $\\{3,5\\}$ and $\\{4,6\\}$ are not in $E$. Therefore, the cycle $3-4-5-6-3$ is an induced cycle of length $4$. This is the only induced cycle of length $\\geq 4$ in $G$.\n\nTo obtain a chordal extension of $G$, we must add edges (called fill edges) to break all chordless cycles. The task requires a minimal chordal extension, specifically one that \"adds the fewest possible fill edges\". This means we are looking for a minimum chordal extension (or minimum triangulation). To break the $4$-cycle $3-4-5-6-3$, we must add at least one chord. A chord is an edge connecting two non-adjacent vertices in the cycle. The possible chords are $\\{3,5\\}$ and $\\{4,6\\}$.\n\nAdding just one of these chords is sufficient to make the entire graph $G$ chordal. For example, if we add the edge $\\{3,5\\}$, the $4$-cycle $3-4-5-6-3$ is broken into two $3$-cycles, $3-4-5-3$ and $3-5-6-3$. Since the original graph had only one chordless cycle, adding this single edge results in a chordal graph. Therefore, the minimum number of fill edges required is $1$.\n\nLet us construct a minimal chordal extension $\\widehat{G}=(V, \\widehat{E})$ by adding the fill edge $\\{3,5\\}$. The new edge set is $\\widehat{E} = E \\cup \\{\\{3,5\\}\\}$. The number of fill edges is $1$.\n\nNext, we must find the set of maximal cliques, $\\mathcal{C}_{\\max}$, of the chordal graph $\\widehat{G}$. A maximal clique is a complete subgraph that is not a subset of any larger complete subgraph.\n1. The vertices $\\{1,2,3\\}$ form a clique in $G$ and also in $\\widehat{G}$. To check if it is maximal, we test if any other vertex can be added. Vertices $4$, $5$, and $6$ are not connected to all three vertices $\\{1,2,3\\}$. For example, vertex $4$ is not connected to $1$ or $2$. Thus, $\\{1,2,3\\}$ is a maximal clique.\n2. With the addition of the fill edge $\\{3,5\\}$, the vertices $\\{3,4,5\\}$ now form a clique. The edges are $\\{3,4\\} \\in E$, $\\{4,5\\} \\in E$, and $\\{3,5\\} \\in \\widehat{E} \\setminus E$. To check for maximality, we test other vertices. Vertex $6$ is connected to $3$ and $5$, but not to $4$. No other vertex is connected to all three. Thus, $\\{3,4,5\\}$ is a maximal clique.\n3. Similarly, the vertices $\\{3,5,6\\}$ form a clique. The edges are $\\{3,6\\} \\in E$, $\\{5,6\\} \\in E$, and $\\{3,5\\} \\in \\widehat{E} \\setminus E$. To check for maximality, vertex $4$ is connected to $3$ and $5$, but not to $6$. Therefore, $\\{3,5,6\\}$ is another maximal clique.\n\nThese three cliques cover all vertices of the graph. We have systematically identified all maximal cliques. The set of maximal cliques of $\\widehat{G}$ is $\\mathcal{C}_{\\max} = \\big\\{\\{1,2,3\\}, \\{3,4,5\\}, \\{3,5,6\\}\\big\\}$.\n\nThe problem defines the scalar $S$ as:\n$$S \\;=\\; (\\text{number of fill edges added}) \\;+\\; \\sum_{C \\in \\mathcal{C}_{\\max}} |C|$$\nWe have found that the number of fill edges is $1$. The sum of the cardinalities of the maximal cliques is:\n$$\\sum_{C \\in \\mathcal{C}_{\\max}} |C| = |\\{1,2,3\\}| + |\\{3,4,5\\}| + |\\{3,5,6\\}| = 3 + 3 + 3 = 9$$\nTherefore, the value of $S$ is:\n$$S = 1 + 9 = 10$$\nNote that if we had chosen the other possible fill edge, $\\{4,6\\}$, the resulting minimal chordal extension would have maximal cliques $\\mathcal{C}_{\\max} = \\big\\{\\{1,2,3\\}, \\{3,4,6\\}, \\{4,5,6\\}\\big\\}$. The sum of cardinalities would still be $3+3+3=9$, and with $1$ fill edge, $S$ would remain $10$, confirming the well-posedness of the problem.",
            "answer": "$$\n\\boxed{10}\n$$"
        }
    ]
}