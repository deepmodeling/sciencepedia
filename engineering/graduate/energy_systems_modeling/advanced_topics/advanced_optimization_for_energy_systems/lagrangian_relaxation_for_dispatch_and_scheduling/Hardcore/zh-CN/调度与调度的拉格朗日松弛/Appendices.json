{
    "hands_on_practices": [
        {
            "introduction": "在深入研究拉格朗日松弛之前，掌握经济调度的基本原理至关重要。第一个练习  直接使用卡罗需-库恩-塔克 (KKT) 条件来解决一个经典的凸优化问题。通过求解最优发电调度和系统价格 ($\\lambda$)，您将为理解在集中式优化中价格如何形成以及约束如何处理打下坚实的基础。",
            "id": "4100508",
            "problem": "考虑一个包含三台机组的火电厂的单母线经济调度问题。每台发电机 $i \\in \\{1,2,3\\}$ 的发电功率为 $p_i$（单位为兆瓦，MW），其小时成本由二次函数 $C_i(p_i) = a_i p_i^2 + b_i p_i$ 给出，其中 $a_i > 0$ 且 $b_i \\ge 0$。系统必须满足一个固定的需求 $D$（单位为兆瓦，MW），且无输电约束。每台发电机都受到物理上下限约束 $P_i^{\\min} \\le p_i \\le P_i^{\\max}$。假设启动成本和空载成本为零，并且成本函数仅包含增量燃料成本以及可变运行和维护成本。调度员的目标是在满足功率平衡和机组运行限制的条件下，最小化总小时发电成本。\n\n采用以下数据：\n- 发电机 1：$a_1 = 0.2$，$b_1 = 10$，$P_1^{\\min} = 20$，$P_1^{\\max} = 120$。\n- 发电机 2：$a_2 = 0.1$，$b_2 = 12$，$P_2^{\\min} = 10$，$P_2^{\\max} = 100$。\n- 发电机 3：$a_3 = 0.3$，$b_3 = 9$，$P_3^{\\min} = 0$，$P_3^{\\max} = 80$。\n- 需求：$D = 200$。\n\n从凸优化的定义和耦合平衡约束的拉格朗日松弛出发，构建以决策变量 $p_1$、$p_2$ 和 $p_3$ 表示的原始问题，以及包含等式和不等式约束乘子的相应拉格朗日函数。使用Karush-Kuhn-Tucker (KKT) 条件，包括平稳性、原始可行性、对偶可行性和互补松弛性，推导最优性的必要条件。计算最优调度 $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\}$ 及相关的价格 $\\lambda^{\\star}$（平衡约束的最优乘子），仔细确定在最优点哪些机组限制是有效的，并验证互补松弛性的一致性。无需四舍五入；请提供精确值。\n\n将您的最终答案以行矩阵的形式报告，顺序为 $\\left[p_1^{\\star}\\; p_2^{\\star}\\; p_3^{\\star}\\; \\lambda^{\\star}\\right]$。将 $p_i^{\\star}$ 以兆瓦 (MW) 表示，将 $\\lambda^{\\star}$ 以美元/兆瓦时 ($/\\mathrm{MWh}$) 表示。",
            "solution": "这是一个经典的经济调度问题，属于凸优化问题。我们首先验证问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **成本函数**：$C_i(p_i) = a_i p_i^2 + b_i p_i$ for $i \\in \\{1,2,3\\}$。\n- **发电机1数据**：$a_1 = 0.2$，$b_1 = 10$，$P_1^{\\min} = 20$ MW，$P_1^{\\max} = 120$ MW。\n- **发电机2数据**：$a_2 = 0.1$，$b_2 = 12$，$P_2^{\\min} = 10$ MW，$P_2^{\\max} = 100$ MW。\n- **发电机3数据**：$a_3 = 0.3$，$b_3 = 9$，$P_3^{\\min} = 0$ MW，$P_3^{\\max} = 80$ MW。\n- **总需求**：$D = 200$ MW。\n- **约束条件**：\n    - 功率平衡：$\\sum_{i=1}^3 p_i = D$。\n    - 发电机限制：$P_i^{\\min} \\le p_i \\le P_i^{\\max}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题模拟了火力发电机的经济调度，这是电力系统工程中一个基础且成熟的问题。二次成本函数是对燃料成本的标准、现实的近似。参数在物理上是合理的。使用拉格朗日松弛和KKT条件的优化方法是解决此类问题的标准而严谨的数学技术。该问题在科学上是合理的。\n- **适定性**：目标函数是具有正主导系数 ($a_i > 0$) 的二次函数之和，因此是严格凸的。由线性等式和不等式约束定义的可行域是一个凸集（一个多胞体）。在一个非空、闭合的凸集上最小化一个严格凸函数有唯一解。因此，该问题是适定的。\n- **目标**：问题使用了精确的数学术语和数值数据进行陈述，目标清晰明确，没有主观性语言。\n\n### 步骤 3：结论与行动\n问题是有效的。我们着手解决它。\n\n### 原始问题构建\n目标是在满足需求并遵守各发电机限制的前提下，最小化总发电成本 $C_{total}$。决策变量是功率输出 $p_1, p_2, p_3$。\n\n优化问题是：\n$$\n\\begin{aligned}\n \\underset{p_1, p_2, p_3}{\\text{minimize}}\n  C_{total} = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) \\\\\n \\text{subject to}\n  \\sum_{i=1}^{3} p_i = D \\quad (\\text{multiplier } \\lambda) \\\\\n   P_i^{\\min} \\le p_i \\le P_i^{\\max} \\quad \\forall i \\in \\{1,2,3\\}\n\\end{aligned}\n$$\n下限和上限不等式可以写成 $P_i^{\\min} - p_i \\le 0$（乘子为 $\\mu_i^{\\min}$）和 $p_i - P_i^{\\max} \\le 0$（乘子为 $\\mu_i^{\\max}$）。\n\n### 拉格朗日函数构建\n拉格朗日函数 $L$ 包含了所有约束条件：\n$$\nL(p, \\lambda, \\mu^{\\min}, \\mu^{\\max}) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) + \\lambda \\left( D - \\sum_{i=1}^{3} p_i \\right) + \\sum_{i=1}^{3} \\mu_i^{\\min} (P_i^{\\min} - p_i) + \\sum_{i=1}^{3} \\mu_i^{\\max} (p_i - P_i^{\\max})\n$$\n其中 $p = (p_1, p_2, p_3)$，$\\mu^{\\min} = (\\mu_1^{\\min}, \\mu_2^{\\min}, \\mu_3^{\\min})$，以及 $\\mu^{\\max} = (\\mu_1^{\\max}, \\mu_2^{\\max}, \\mu_3^{\\max})$。\n\n### Karush-Kuhn-Tucker (KKT) 条件\n对于一个点 $(p_1^{\\star}, p_2^{\\star}, p_3^{\\star})$ 是最优的，必须存在乘子 $\\lambda^{\\star}, \\mu_i^{\\min, \\star}, \\mu_i^{\\max, \\star}$ 使得以下KKT条件得到满足：\n1.  **平稳性**：$\\frac{\\partial L}{\\partial p_i} = 0$ for $i=1, 2, 3$。\n    $$ 2a_i p_i^{\\star} + b_i - \\lambda^{\\star} - \\mu_i^{\\min, \\star} + \\mu_i^{\\max, \\star} = 0 $$\n2.  **原始可行性**：\n    $$ \\sum_{i=1}^{3} p_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le p_i^{\\star} \\le P_i^{\\max} $$\n3.  **对偶可行性**：\n    $$ \\mu_i^{\\min, \\star} \\ge 0, \\quad \\mu_i^{\\max, \\star} \\ge 0 $$\n4.  **互补松弛性**：\n    $$ \\mu_i^{\\min, \\star} (P_i^{\\min} - p_i^{\\star}) = 0 $$\n    $$ \\mu_i^{\\max, \\star} (p_i^{\\star} - P_i^{\\max}) = 0 $$\n\n项 $2a_i p_i + b_i$ 是发电机 $i$ 的增量成本，记为 $IC_i(p_i)$。平稳性条件可以改写为 $IC_i(p_i^{\\star}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star} - \\mu_i^{\\max, \\star}$。结合互补松弛性进行分析，每个发电机有三种情况：\n- 如果 $P_i^{\\min}  p_i^{\\star}  P_i^{\\max}$，则 $\\mu_i^{\\min, \\star} = 0$ 且 $\\mu_i^{\\max, \\star} = 0$。条件变为 $IC_i(p_i^{\\star}) = \\lambda^{\\star}$。\n- 如果 $p_i^{\\star} = P_i^{\\min}$，则 $\\mu_i^{\\max, \\star} = 0$ 且 $\\mu_i^{\\min, \\star} \\ge 0$。条件意味着 $IC_i(P_i^{\\min}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star}$，因此 $IC_i(P_i^{\\min}) \\ge \\lambda^{\\star}$。\n- 如果 $p_i^{\\star} = P_i^{\\max}$，则 $\\mu_i^{\\min, \\star} = 0$ 且 $\\mu_i^{\\max, \\star} \\ge 0$。条件意味着 $IC_i(P_i^{\\max}) = \\lambda^{\\star} - \\mu_i^{\\max, \\star}$，因此 $IC_i(P_i^{\\max}) \\le \\lambda^{\\star}$。\n\n### 迭代求解\n我们使用迭代方法来找到有效约束的集合。\n\n**迭代 1：假设没有发电机限制是有效的。**\n在这种情况下，对所有 $i$ 都有 $IC_i(p_i) = \\lambda$。这得到 $p_i = (\\lambda - b_i) / (2a_i)$。\n功率平衡方程为 $\\sum_{i=1}^{3} p_i = D = 200$。\n$$\n\\frac{\\lambda - 10}{2(0.2)} + \\frac{\\lambda - 12}{2(0.1)} + \\frac{\\lambda - 9}{2(0.3)} = 200\n$$\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 12}{0.2} + \\frac{\\lambda - 9}{0.6} = 200\n$$\n为了求解 $\\lambda$，我们可以将其写为：\n$$\n(\\lambda - 10) \\left(\\frac{1}{0.4}\\right) + (\\lambda - 12) \\left(\\frac{1}{0.2}\\right) + (\\lambda - 9) \\left(\\frac{1}{0.6}\\right) = 200\n$$\n$$\n2.5(\\lambda - 10) + 5(\\lambda - 12) + \\frac{5}{3}(\\lambda - 9) = 200\n$$\n乘以 $6$ 以消除所有小数和分数：\n$$\n15(\\lambda - 10) + 30(\\lambda - 12) + 10(\\lambda - 9) = 1200\n$$\n$$\n15\\lambda - 150 + 30\\lambda - 360 + 10\\lambda - 90 = 1200\n$$\n$$\n55\\lambda - 600 = 1200 \\implies 55\\lambda = 1800 \\implies \\lambda = \\frac{1800}{55} = \\frac{360}{11}\n$$\n现在我们用 $\\lambda = 360/11 \\approx 32.727$ 计算调度值：\n$p_1 = \\frac{360/11 - 10}{0.4} = \\frac{(360-110)/11}{0.4} = \\frac{250/11}{0.4} = \\frac{625}{11} \\approx 56.82$ MW。\n这在发电机1的限制 $[20, 120]$ 范围内。\n$p_2 = \\frac{360/11 - 12}{0.2} = \\frac{(360-132)/11}{0.2} = \\frac{228/11}{0.2} = \\frac{1140}{11} \\approx 103.64$ MW。\n这个值超过了发电机2的上限 $P_2^{\\max} = 100$ MW。假设不成立。\n\n**迭代 2：将发电机2设置为其被违反的限制并重新调度。**\n我们将发电机2的调度固定在其最大限制：$p_2^{\\star} = P_2^{\\max} = 100$ MW。\n由发电机1和3满足的剩余需求为 $D' = D - p_2^{\\star} = 200 - 100 = 100$ MW。\n我们现在对发电机1和3应用等增量成本原则，以满足需求 $D' = 100$。\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 9}{0.6} = 100\n$$\n$$\n2.5(\\lambda - 10) + \\frac{5}{3}(\\lambda - 9) = 100\n$$\n乘以 $6$：\n$$\n15(\\lambda - 10) + 10(\\lambda - 9) = 600\n$$\n$$\n15\\lambda - 150 + 10\\lambda - 90 = 600\n$$\n$$\n25\\lambda - 240 = 600 \\implies 25\\lambda = 840 \\implies \\lambda = \\frac{840}{25} = \\frac{168}{5} = 33.6\n$$\n使用这个新的系统价格 $\\lambda^{\\star} = 33.6 \\, \\$/\\mathrm{MWh}$，我们计算发电机1和3的调度：\n$p_1^{\\star} = \\frac{33.6 - 10}{0.4} = \\frac{23.6}{0.4} = 59$ MW。\n这在限制 $[20, 120]$ 范围内。\n$p_3^{\\star} = \\frac{33.6 - 9}{0.6} = \\frac{24.6}{0.6} = 41$ MW。\n这在限制 $[0, 80]$ 范围内。\n\n### 解的验证\n提议的最优解是 $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\} = \\{59, 100, 41\\}$ 和 $\\lambda^{\\star} = 33.6$。\n1.  **原始可行性**：\n    - 功率平衡：$p_1^{\\star} + p_2^{\\star} + p_3^{\\star} = 59 + 100 + 41 = 200$ MW。这与需求 $D$ 相匹配。\n    - 发电机限制：\n        - $20 \\le p_1^{\\star} = 59 \\le 120$ (符合)\n        - $10 \\le p_2^{\\star} = 100 \\le 100$ (符合，在最大限制处)\n        - $0 \\le p_3^{\\star} = 41 \\le 80$ (符合)\n    所有原始可行性条件都得到满足。\n\n2.  **KKT 条件 (增量成本)**：\n    - **发电机 1**：未达到限制。我们必须验证 $IC_1(p_1^{\\star}) = \\lambda^{\\star}$。\n      $IC_1(59) = 2(0.2)(59) + 10 = 0.4(59) + 10 = 23.6 + 10 = 33.6$。这等于 $\\lambda^{\\star}$。\n    - **发电机 2**：在上限处。我们必须验证 $IC_2(p_2^{\\star}) \\le \\lambda^{\\star}$。\n      $IC_2(100) = 2(0.1)(100) + 12 = 20 + 12 = 32$。\n      条件是 $32 \\le 33.6$，这是成立的。（互补松弛性给出 $\\mu_2^{\\max, \\star} = \\lambda^{\\star} - IC_2(100) = 33.6 - 32 = 1.6 \\ge 0$）。\n    - **发电机 3**：未达到限制。我们必须验证 $IC_3(p_3^{\\star}) = \\lambda^{\\star}$。\n      $IC_3(41) = 2(0.3)(41) + 9 = 0.6(41) + 9 = 24.6 + 9 = 33.6$。这等于 $\\lambda^{\\star}$。\n\n所有KKT条件都得到满足，确认该解是唯一最优解。\n\n最终的最优调度是 $p_1^{\\star} = 59$ MW，$p_2^{\\star} = 100$ MW，$p_3^{\\star} = 41$ MW，最优系统价格为 $\\lambda^{\\star} = 33.6$ $/MWh。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n59  100  41  33.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现实世界的调度问题涉及离散的启停决策，从而引出了更复杂的机组组合 (UC) 问题。这个练习  展示了拉格朗日松弛的核心威力：将一个大型、耦合的混合整数问题分解为针对每个发电机组的、更小的独立子问题。您将推导对偶函数并计算其值，从而深入了解松弛方法如何为真实的最优成本提供一个下界。",
            "id": "4100467",
            "problem": "考虑一个包含两个机组、三个时段的机组组合（Unit Commitment, UC）问题，该问题属于能源系统建模领域。其目标是安排机组启停与调度发电，以满足各时段的需求，同时最小化生产成本和启动成本。每台火电机组在线时有最小和最大出力，从离线转换到在线状态时会产生固定的启动成本，并具有分段线性的可变发电成本。每个时段的长度为$1$小时。设机组集合为$i \\in \\{1,2\\}$，时段集合为$t \\in \\{1,2,3\\}$。定义二进制启停变量$u_{i,t} \\in \\{0,1\\}$、启动指示变量$y_{i,t} \\in \\{0,1\\}$和连续发电调度变量$p_{i,t} \\ge 0$。时段$t$的需求为$D_t$。平衡约束为$\\sum_{i} p_{i,t} = D_t$（对所有$t$）；最小和最大出力约束为$u_{i,t} P_i^{\\min} \\le p_{i,t} \\le u_{i,t} P_i^{\\max}$；启动指示变量满足$y_{i,t} \\ge u_{i,t} - u_{i,t-1}$，初始状态为$u_{i,0} = 0$。问题中不包含最小启停时间约束、停机成本和空载成本。机组$i$在时段$t$的可变发电成本由一个具有单个拐点$k_i$的凸分段线性函数给出：\n$$\nc_i(p) = \n\\begin{cases}\nm_{i,1} \\, p,  0 \\le p \\le k_i, \\\\\nm_{i,1} \\, k_i + m_{i,2} \\, (p - k_i),  p > k_i.\n\\end{cases}\n$$\n每次启动的启动成本为$S_i$。\n\n从原始UC公式和拉格朗日松弛的基本定义出发（仅松弛带乘子$\\lambda_t$的全系统平衡约束），推导拉格朗日函数并用$\\lambda_t$、$D_t$和各机组子问题表示对偶函数$g(\\lambda)$。明确写出在乘子$\\lambda_t$下，给定机组$i$的子问题目标函数，该函数应是$u_{i,t}$、$y_{i,t}$和$p_{i,t}$的函数，并保持机组子问题的所有约束不变。\n\n然后，使用以下科学上真实且自洽的数据，为指定的乘子评估对偶函数$g(\\lambda)$：\n- 需求：$D_1 = 260$, $D_2 = 120$, $D_3 = 240$。\n- 机组1：$P_1^{\\min} = 50$, $P_1^{\\max} = 200$, $k_1 = 120$, $m_{1,1} = 28$, $m_{1,2} = 40$, $S_1 = 1500$, $u_{1,0} = 0$。\n- 机组2：$P_2^{\\min} = 60$, $P_2^{\\max} = 150$, $k_2 = 90$, $m_{2,1} = 32$, $m_{2,2} = 48$, $S_2 = 1000$, $u_{2,0} = 0$。\n- 乘子：$\\lambda_1 = 45$, $\\lambda_2 = 30$, $\\lambda_3 = 55$。\n\n您的推导必须从UC原始问题和拉格朗日松弛的定义开始，并逻辑地推导出各机组的子问题。最后，根据给定的数据和乘子计算$g(\\lambda)$的数值。最终值以美元表示。无需四舍五入。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n- **集合：** 机组 $i \\in \\{1,2\\}$，时段 $t \\in \\{1,2,3\\}$。\n- **变量：**\n    - 二进制启停变量：$u_{i,t} \\in \\{0,1\\}$。\n    - 二进制启动变量：$y_{i,t} \\in \\{0,1\\}$。\n    - 连续发电调度变量：$p_{i,t} \\ge 0$。\n- **问题公式化：**\n    - 目标函数：最小化 $\\sum_{i,t} (S_i y_{i,t} + c_i(p_{i,t}))$。\n    - 平衡约束：$\\sum_{i} p_{i,t} = D_t$（对所有$t$）。\n    - 发电限制：$u_{i,t} P_i^{\\min} \\le p_{i,t} \\le u_{i,t} P_i^{\\max}$（对所有$i, t$）。\n    - 启动逻辑：$y_{i,t} \\ge u_{i,t} - u_{i,t-1}$（对所有$i, t$）。\n    - 初始条件：$u_{i,0} = 0$（对所有$i$）。\n    - 可变成本函数：\n    $$c_i(p) = \\begin{cases} m_{i,1} \\, p,  0 \\le p \\le k_i, \\\\ m_{i,1} \\, k_i + m_{i,2} \\, (p - k_i),  p > k_i. \\end{cases}$$\n- **数据：**\n    - 需求：$D_1 = 260$, $D_2 = 120$, $D_3 = 240$。\n    - 机组1：$P_1^{\\min} = 50$, $P_1^{\\max} = 200$, $k_1 = 120$, $m_{1,1} = 28$, $m_{1,2} = 40$, $S_1 = 1500$, $u_{1,0} = 0$。\n    - 机组2：$P_2^{\\min} = 60$, $P_2^{\\max} = 150$, $k_2 = 90$, $m_{2,1} = 32$, $m_{2,2} = 48$, $S_2 = 1000$, $u_{2,0} = 0$。\n    - 拉格朗日乘子：$\\lambda_1 = 45$, $\\lambda_2 = 30$, $\\lambda_3 = 55$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是应用拉格朗日松弛于经典机组组合（UC）问题的标准练习，这是能源系统建模中的一个核心课题。\n- **科学依据：** UC问题的表述，包括目标函数（最小化启动和生产成本）和约束条件（需求平衡、发电限制、启动逻辑），均基于电力系统运行和优化的既定原则。所提供的数据（成本、容量、需求）在内部是一致的，对于小规模模型而言是科学且真实的。分段线性成本函数是凸的（因为两个机组的边际成本都是递增的，即 $m_{i,1}  m_{i,2}$），这是此类问题的标准且必要的属性。\n- **良态性：** 问题陈述清晰，并提供了推导对偶函数并计算其在给定乘子下的值所需的所有信息。任务具体，并能得出一个唯一的数值答案。\n- **客观性：** 问题陈述不含主观性语言，依赖于形式化的数学和经济学定义。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 求解推导\n原始机组组合（UC）问题公式化如下：\n$$\n\\min_{u, y, p} \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left( S_i y_{i,t} + c_i(p_{i,t}) \\right)\n$$\n约束条件如下：\n$$\n\\begin{align*}\n\\sum_{i=1}^{2} p_{i,t} = D_t,  \\forall t \\in \\{1,2,3\\} \\quad (1) \\\\\nu_{i,t} P_i^{\\min} \\le p_{i,t} \\le u_{i,t} P_i^{\\max},  \\forall i \\in \\{1,2\\}, t \\in \\{1,2,3\\} \\quad (2) \\\\\ny_{i,t} \\ge u_{i,t} - u_{i,t-1},  \\forall i \\in \\{1,2\\}, t \\in \\{1,2,3\\} \\quad (3) \\\\\nu_{i,t}, y_{i,t} \\in \\{0, 1\\}, \\ p_{i,t} \\ge 0,  \\forall i \\in \\{1,2\\}, t \\in \\{1,2,3\\} \\quad (4)\n\\end{align*}\n$$\n初始条件为 $u_{i,0} = 0$。\n\n为了应用拉格朗日松弛，我们引入拉格朗日乘子 $\\lambda_t$ 来松弛全系统的需求平衡约束(1)。拉格朗日函数 $L(u, y, p, \\lambda)$ 通过将松弛的约束加入目标函数而构成：\n$$\nL(u, y, p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left( S_i y_{i,t} + c_i(p_{i,t}) \\right) + \\sum_{t=1}^{3} \\lambda_t \\left( D_t - \\sum_{i=1}^{2} p_{i,t} \\right)\n$$\n重新整理各项，按机组索引 $i$ 分组，可以得到可分离的子问题：\n$$\nL(u, y, p, \\lambda) = \\sum_{i=1}^{2} \\left[ \\sum_{t=1}^{3} \\left( S_i y_{i,t} + c_i(p_{i,t}) - \\lambda_t p_{i,t} \\right) \\right] + \\sum_{t=1}^{3} \\lambda_t D_t\n$$\n拉格朗日对偶函数 $g(\\lambda)$ 是拉格朗日函数在所有原始变量满足剩余（未松弛）约束条件下的最小值：\n$$\ng(\\lambda) = \\min_{u,y,p \\text{ s.t. (2,3,4)}} L(u, y, p, \\lambda)\n$$\n由于拉格朗日函数的可分离性，这个最小化问题可以分解为每个机组的独立子问题加上一个常数项：\n$$\ng(\\lambda) = \\sum_{i=1}^{2} \\left( \\min_{u_i, y_i, p_i} \\left[ \\sum_{t=1}^{3} \\left( S_i y_{i,t} + c_i(p_{i,t}) - \\lambda_t p_{i,t} \\right) \\right] \\right) + \\sum_{t=1}^{3} \\lambda_t D_t\n$$\n其中，对每个机组$i$的最小化问题都受其自身约束的限制：\n$$\n\\begin{align*}\nu_{i,t} P_i^{\\min} \\le p_{i,t} \\le u_{i,t} P_i^{\\max},  \\forall t \\in \\{1,2,3\\} \\\\\ny_{i,t} \\ge u_{i,t} - u_{i,t-1},  \\forall t \\in \\{1,2,3\\} \\\\\nu_{i,t}, y_{i,t} \\in \\{0, 1\\}, \\ p_{i,t} \\ge 0,  \\forall i \\in \\{1,2\\}, t \\in \\{1,2,3\\}\n\\end{align*}\n$$\n且 $u_{i,0}=0$。\n\n根据要求，给定机组 $i$ 的子问题包括最小化以下目标函数：\n$$\n\\sum_{t=1}^{3} \\left( S_i y_{i,t} + c_i(p_{i,t}) - \\lambda_t p_{i,t} \\right)\n$$\n并满足上面列出的该机组的约束集合。\n\n### 数值计算\n我们现在为给定的数据计算 $g(\\lambda)$。首先，我们计算常数项：\n$$\n\\sum_{t=1}^{3} \\lambda_t D_t = \\lambda_1 D_1 + \\lambda_2 D_2 + \\lambda_3 D_3 = (45)(260) + (30)(120) + (55)(240) = 11700 + 3600 + 13200 = 28500\n$$\n接下来，我们求解每个机组的子问题。由于没有最小启停时间约束，每个机组的子问题是在三个时段上的动态规划问题。对于每个时段$t$，如果一个机组被启用（$u_{i,t}=1$），我们必须首先求解一个经济调度子问题：\n$$\nC_{i,t}^{\\text{disp}} = \\min_{P_i^{\\min} \\le p_{i,t} \\le P_i^{\\max}} \\left( c_i(p_{i,t}) - \\lambda_t p_{i,t} \\right)\n$$\n最优调度出力$p_{i,t}^*$取决于乘子$\\lambda_t$与机组的边际成本$m_{i,1}$和$m_{i,2}$之间的关系。\n\n#### 机组1子问题\n数据：$P_1^{\\min}=50, P_1^{\\max}=200, k_1=120, m_{1,1}=28, m_{1,2}=40, S_1=1500, u_{1,0}=0$。乘子：$\\lambda_1=45, \\lambda_2=30, \\lambda_3=55$。\n- 时段1（$\\lambda_1=45$）：由于$\\lambda_1 > m_{1,2}$，机组以最大出力调度：$p_{1,1}^* = 200$。\n  $c_1(200) = 28(120) + 40(200-120) = 3360+3200=6560$。\n  $C_{1,1}^{\\text{disp}} = 6560 - 45(200) = 6560 - 9000 = -2440$。\n- 时段2（$\\lambda_2=30$）：由于$m_{1,1}  \\lambda_2  m_{1,2}$，机组在拐点处调度：$p_{1,2}^* = 120$。\n  $c_1(120) = 28(120) = 3360$。\n  $C_{1,2}^{\\text{disp}} = 3360 - 30(120) = 3360 - 3600 = -240$。\n- 时段3（$\\lambda_3=55$）：由于$\\lambda_3 > m_{1,2}$，机组以最大出力调度：$p_{1,3}^* = 200$。\n  $c_1(200) = 6560$。\n  $C_{1,3}^{\\text{disp}} = 6560 - 55(200) = 6560 - 11000 = -4440$。\n\n在时段$t$处于开启状态的成本是$S_1 y_{1,t} + C_{1,t}^{\\text{disp}}$。通过比较不同启停模式的总成本来找到最优调度方案。在任何时段开启的成本贡献都是负的（或者加上启动成本后也变为负的），这激励机组保持开启状态。最优调度是在时段1开启并保持开启。\n子问题总成本 = $(S_1 + C_{1,1}^{\\text{disp}}) + C_{1,2}^{\\text{disp}} + C_{1,3}^{\\text{disp}} = (1500 - 2440) + (-240) + (-4440) = -940 - 240 - 4440 = -5620$。\n\n#### 机组2子问题\n数据：$P_2^{\\min}=60, P_2^{\\max}=150, k_2=90, m_{2,1}=32, m_{2,2}=48, S_2=1000, u_{2,0}=0$。乘子：$\\lambda_1=45, \\lambda_2=30, \\lambda_3=55$。\n- 时段1（$\\lambda_1=45$）：由于$m_{2,1}  \\lambda_1  m_{2,2}$，机组在拐点处调度：$p_{2,1}^* = 90$。\n  $c_2(90) = 32(90) = 2880$。\n  $C_{2,1}^{\\text{disp}} = 2880 - 45(90) = 2880 - 4050 = -1170$。\n- 时段2（$\\lambda_2=30$）：由于$\\lambda_2  m_{2,1}$，机组以最小出力调度：$p_{2,2}^* = 60$。\n  $c_2(60) = 32(60) = 1920$。\n  $C_{2,2}^{\\text{disp}} = 1920 - 30(60) = 1920 - 1800 = 120$。\n- 时段3（$\\lambda_3=55$）：由于$\\lambda_3 > m_{2,2}$，机组以最大出力调度：$p_{2,3}^* = 150$。\n  $c_2(150) = 32(90) + 48(150-90) = 2880+2880=5760$。\n  $C_{2,3}^{\\text{disp}} = 5760 - 55(150) = 5760 - 8250 = -2490$。\n\n在时段1和3开启的利润足以保证启停。动态规划评估表明，最优调度是在时段1启动并一直保持到时段3。\n子问题总成本 = $(S_2 + C_{2,1}^{\\text{disp}}) + C_{2,2}^{\\text{disp}} + C_{2,3}^{\\text{disp}} = (1000 - 1170) + 120 + (-2490) = -170 + 120 - 2490 = -50 - 2490 = -2540$。\n\n#### 对偶函数的最终值\n我们将各部分相加来求$g(\\lambda)$的值：\n$$\ng(\\lambda) = \\left( \\sum_{t=1}^{3} \\lambda_t D_t \\right) + (\\text{机组1子问题成本}) + (\\text{机组2子问题成本})\n$$\n$$\ng(\\lambda) = 28500 + (-5620) + (-2540) = 28500 - 8160 = 20340\n$$\n对于给定的乘子，对偶函数的值为$20340$。",
            "answer": "$$\\boxed{20340}$$"
        },
        {
            "introduction": "评估对偶函数只是故事的一部分；解决对偶问题以找到最紧的下界才是最终目标。最后一个练习  将引导您完成一次完整的次梯度上升法迭代，这是求解拉格朗日对偶问题的标准算法。您将需要解决分解后的子问题，计算指明上升方向的次梯度，并更新乘子以显著改善对偶目标值。",
            "id": "4100502",
            "problem": "考虑一个三周期火电经济调度问题，包含两个发电机组（索引为 $i \\in \\{1,2\\}$）和三个时间段（索引为 $t \\in \\{1,2,3\\}$）。在每个时间段 $t$，系统需求为 $D_{t}$，且系统必须满足需求平衡等式约束。每个机组有一个二进制启停决策 $u_{i,t} \\in \\{0,1\\}$ 和一个输出功率 $P_{i,t} \\in \\mathbb{R}_{+}$，当机组开启时，其输出功率受到最小和最大限制的约束。机组 $i$ 的每个周期的成本模型是空载成本和凸二次可变发电成本之和。除了各周期的空载成本外，没有最小启停时间、爬坡限制或启停成本等跨期约束。\n\n原始问题是在满足需求平衡和各机组可行性约束的条件下，最小化总运行成本：\n最小化 $\\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right)$\n约束条件为，对每个 $t$：\n$\\sum_{i=1}^{2} P_{i,t} = D_{t}$，\n以及，对每个 $i,t$：\n$u_{i,t} \\in \\{0,1\\}$，\n$P_{i,t} \\in [P^{\\min}_{i} u_{i,t}, P^{\\max}_{i} u_{i,t}]$。\n\n数据：\n- 机组1：$a_{1} = 0.02$ $\\mathrm{USD}/\\mathrm{MW}^{2}$，$b_{1} = 12$ $\\mathrm{USD}/\\mathrm{MW}$，$c_{1} = 15$ $\\mathrm{USD}$，$P^{\\min}_{1} = 10$ $\\mathrm{MW}$，$P^{\\max}_{1} = 50$ $\\mathrm{MW}$。\n- 机组2：$a_{2} = 0.01$ $\\mathrm{USD}/\\mathrm{MW}^{2}$，$b_{2} = 20$ $\\mathrm{USD}/\\mathrm{MW}$，$c_{2} = 10$ $\\mathrm{USD}$，$P^{\\min}_{2} = 5$ $\\mathrm{MW}$，$P^{\\max}_{2} = 30$ $\\mathrm{MW}$。\n- 需求：$D_{1} = 40$ $\\mathrm{MW}$，$D_{2} = 45$ $\\mathrm{MW}$，$D_{3} = 35$ $\\mathrm{MW}$。\n\n对三个需求平衡等式约束应用拉格朗日松弛，引入乘子 $\\lambda_{t} \\in \\mathbb{R}$，构建可在机组和周期上分离的拉格朗日函数。设初始乘子为 $\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]$ $\\mathrm{USD}/\\mathrm{MW}$。使用次梯度上升步长 $\\alpha = 0.1$ $\\mathrm{USD}/\\mathrm{MW}^{2}$，执行以下操作：\n\n1. 通过精确求解松弛下的每个机组-周期子问题，并将各机组-周期最优值与 $\\sum_{t=1}^{3} \\lambda^{(0)}_{t} D_{t}$ 相加，计算对偶函数值 $g(\\lambda^{(0)})$。\n2. 计算对偶函数关于松弛约束的次梯度向量 $s(\\lambda^{(0)})$，其分量由每个周期的需求残差表示。\n3. 执行一次次梯度上升迭代，得到更新后的乘子 $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha \\, s(\\lambda^{(0)})$。\n4. 计算改进后的对偶下界 $g(\\lambda^{(1)})$。\n\n将最终改进的对偶下界 $g(\\lambda^{(1)})$ 报告为单个实数值。最终下界以美元（USD）表示。将您的答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个有效的问题陈述。该问题是一个标准的经济调度公式，适合使用拉格朗日松弛进行分析。它具有科学依据，是适定的、客观的，并包含进行求解所需的所有必要信息。\n\n原始问题是最小化总成本：\n$$ \\text{Minimize } Z = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) $$\n约束条件为：\n$$ \\sum_{i=1}^{2} P_{i,t} = D_{t} \\quad \\forall t \\in \\{1,2,3\\} $$\n$$ u_{i,t} \\in \\{0,1\\} \\quad \\forall i,t $$\n$$ P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t} \\quad \\forall i,t $$\n\n我们对需求平衡等式约束 $\\sum_{i=1}^{2} P_{i,t} - D_{t} = 0$ 应用拉格朗日松弛，引入乘子 $\\lambda_{t}$。拉格朗日函数 $L(P, u, \\lambda)$ 为：\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} \\left(D_{t} - \\sum_{i=1}^{2} P_{i,t}\\right) $$\n重新整理各项以利用可分离性：\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n对偶函数 $g(\\lambda)$ 是拉格朗日函数关于原始变量 $P$ 和 $u$ 的最小值：\n$$ g(\\lambda) = \\min_{P,u} L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left[ \\min_{u_{i,t}, P_{i,t}} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) \\right] + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n最小化受限于 $u_{i,t} \\in \\{0,1\\}$ 和 $P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t}$。\n\n对于每个机组 $i$ 和时间 $t$ 的子问题，通过考虑 $u_{i,t}$ 的两种情况来求解：\n1.  如果 $u_{i,t}=0$，则 $P_{i,t}=0$，成本为 $0$。\n2.  如果 $u_{i,t}=1$，我们必须通过在区间 $[P^{\\min}_{i}, P^{\\max}_{i}]$ 上最小化二次函数 $f(P_{i,t}) = a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}$ 来找到最优功率输出 $P_{i,t}^{\\text{opt}}$。无约束最小值点在 $P_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2a_{i}}$。有约束最优解为 $P_{i,t}^{\\text{opt}} = \\max(P^{\\min}_{i}, \\min(P_{i,t}^{*}, P^{\\max}_{i}))$。此情况下的成本为 $C_{i,t}^{\\text{on}} = c_{i} + a_{i} (P_{i,t}^{\\text{opt}})^{2} + (b_{i} - \\lambda_{t}) P_{i,t}^{\\text{opt}}$。\n子问题的解为 $\\min(0, C_{i,t}^{\\text{on}})$。\n\n给定的数据是：\n- 机组1：$a_{1} = 0.02$, $b_{1} = 12$, $c_{1} = 15$, $P^{\\min}_{1} = 10$, $P^{\\max}_{1} = 50$。\n- 机组2：$a_{2} = 0.01$, $b_{2} = 20$, $c_{2} = 10$, $P^{\\min}_{2} = 5$, $P^{\\max}_{2} = 30$。\n- 需求：$D_{1} = 40$, $D_{2} = 45$, $D_{3} = 35$。\n- 初始乘子：$\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]$。\n- 步长：$\\alpha = 0.1$。\n\n**1. 计算对偶函数值 $g(\\lambda^{(0)})$。**\n我们用 $\\lambda^{(0)} = [18, 22, 16]$ 求解每个机组和时间周期的子问题。\n\n- 对于 $(i,t)=(1,1)$，$\\lambda_1=18$：$P_{1,1}^{*} = \\frac{18-12}{2(0.02)} = 150$。由于 $150 > P^{\\max}_1=50$，所以 $P_{1,1}^{\\text{opt}}=50$。\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18)(50) = 15+50-300 = -235$。子问题值为 $-235$。\n- 对于 $(i,t)=(2,1)$，$\\lambda_1=18$：$P_{2,1}^{*} = \\frac{18-20}{2(0.01)} = -100$。由于 $-100  P^{\\min}_2=5$，所以 $P_{2,1}^{\\text{opt}}=5$。\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18)(5) = 10+0.25+10 = 20.25$。子问题值为 $\\min(0, 20.25) = 0$。\n- 对于 $(i,t)=(1,2)$，$\\lambda_2=22$：$P_{1,2}^{*} = \\frac{22-12}{2(0.02)} = 250$。由于 $250 > P^{\\max}_1=50$，所以 $P_{1,2}^{\\text{opt}}=50$。\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-22)(50) = 15+50-500 = -435$。子问题值为 $-435$。\n- 对于 $(i,t)=(2,2)$，$\\lambda_2=22$：$P_{2,2}^{*} = \\frac{22-20}{2(0.01)} = 100$。由于 $100 > P^{\\max}_2=30$，所以 $P_{2,2}^{\\text{opt}}=30$。\n$C_{2,2}^{\\text{on}} = 10 + 0.01(30)^2 + (20-22)(30) = 10+9-60 = -41$。子问题值为 $-41$。\n- 对于 $(i,t)=(1,3)$，$\\lambda_3=16$：$P_{1,3}^{*} = \\frac{16-12}{2(0.02)} = 100$。由于 $100 > P^{\\max}_1=50$，所以 $P_{1,3}^{\\text{opt}}=50$。\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-16)(50) = 15+50-200 = -135$。子问题值为 $-135$。\n- 对于 $(i,t)=(2,3)$，$\\lambda_3=16$：$P_{2,3}^{*} = \\frac{16-20}{2(0.01)} = -200$。由于 $-200  P^{\\min}_2=5$，所以 $P_{2,3}^{\\text{opt}}=5$。\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-16)(5) = 10+0.25+20 = 30.25$。子问题值为 $\\min(0, 30.25) = 0$。\n\n子问题最小值之和为 $-235+0-435-41-135+0 = -846$。\n$\\lambda_t D_t$ 项之和为 $18(40) + 22(45) + 16(35) = 720 + 990 + 560 = 2270$。\n$g(\\lambda^{(0)}) = -846 + 2270 = 1424$。\n\n**2. 计算次梯度向量 $s(\\lambda^{(0)})$。**\n次梯度分量为 $s_t = D_t - \\sum_i P_{i,t}^{\\text{opt}}$。\n- $s_1 = D_1 - (P_{1,1}^{\\text{opt}} + P_{2,1}^{\\text{opt}}) = 40 - (50 + 0) = -10$。\n- $s_2 = D_2 - (P_{1,2}^{\\text{opt}} + P_{2,2}^{\\text{opt}}) = 45 - (50 + 30) = -35$。\n- $s_3 = D_3 - (P_{1,3}^{\\text{opt}} + P_{2,3}^{\\text{opt}}) = 35 - (50 + 0) = -15$。\n次梯度向量为 $s(\\lambda^{(0)}) = [-10, -35, -15]$。\n\n**3. 执行一次次梯度上升迭代。**\n更新规则为 $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha s(\\lambda^{(0)})$。当 $\\alpha=0.1$ 时：\n- $\\lambda_1^{(1)} = 18 + 0.1(-10) = 17$。\n- $\\lambda_2^{(1)} = 22 + 0.1(-35) = 18.5$。\n- $\\lambda_3^{(1)} = 16 + 0.1(-15) = 14.5$。\n更新后的乘子为 $\\lambda^{(1)} = [17, 18.5, 14.5]$。\n\n**4. 计算改进后的对偶下界 $g(\\lambda^{(1)})$。**\n我们用新的乘子 $\\lambda^{(1)}$ 求解子问题。\n\n- 对于 $(i,t)=(1,1)$，$\\lambda_1=17$：$P_{1,1}^{*} = \\frac{17-12}{2(0.02)} = 125$。由于 $125 > P^{\\max}_1=50$，所以 $P_{1,1}^{\\text{opt}}=50$。\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-17)(50) = 15+50-250 = -185$。子问题值为 $-185$。\n- 对于 $(i,t)=(2,1)$，$\\lambda_1=17$：$P_{2,1}^{*} = \\frac{17-20}{2(0.01)} = -150$。由于 $-150  P^{\\min}_2=5$，所以 $P_{2,1}^{\\text{opt}}=5$。\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-17)(5) = 10+0.25+15 = 25.25$。子问题值为 $\\min(0, 25.25) = 0$。\n- 对于 $(i,t)=(1,2)$，$\\lambda_2=18.5$：$P_{1,2}^{*} = \\frac{18.5-12}{2(0.02)} = 162.5$。由于 $162.5 > P^{\\max}_1=50$，所以 $P_{1,2}^{\\text{opt}}=50$。\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18.5)(50) = 15+50-325 = -260$。子问题值为 $-260$。\n- 对于 $(i,t)=(2,2)$，$\\lambda_2=18.5$：$P_{2,2}^{*} = \\frac{18.5-20}{2(0.01)} = -75$。由于 $-75  P^{\\min}_2=5$，所以 $P_{2,2}^{\\text{opt}}=5$。\n$C_{2,2}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18.5)(5) = 10+0.25+7.5 = 17.75$。子问题值为 $\\min(0, 17.75) = 0$。\n- 对于 $(i,t)=(1,3)$，$\\lambda_3=14.5$：$P_{1,3}^{*} = \\frac{14.5-12}{2(0.02)} = 62.5$。由于 $62.5 > P^{\\max}_1=50$，所以 $P_{1,3}^{\\text{opt}}=50$。\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-14.5)(50) = 15+50-125 = -60$。子问题值为 $-60$。\n- 对于 $(i,t)=(2,3)$，$\\lambda_3=14.5$：$P_{2,3}^{*} = \\frac{14.5-20}{2(0.01)} = -275$。由于 $-275  P^{\\min}_2=5$，所以 $P_{2,3}^{\\text{opt}}=5$。\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-14.5)(5) = 10+0.25+27.5 = 37.75$。子问题值为 $\\min(0, 37.75) = 0$。\n\n对于 $\\lambda^{(1)}$，子问题最小值之和为 $-185+0-260+0-60+0 = -505$。\n$\\lambda_t D_t$ 项之和为 $17(40) + 18.5(45) + 14.5(35) = 680 + 832.5 + 507.5 = 2020$。\n$g(\\lambda^{(1)}) = -505 + 2020 = 1515$。\n\n改进后的对偶下界 $g(\\lambda^{(1)})$ 是 $1515$ $\\mathrm{USD}$。问题要求四舍五入到四位有效数字。数字 $1515$ 已经有四位有效数字。",
            "answer": "$$\n\\boxed{1515}\n$$"
        }
    ]
}