{
    "hands_on_practices": [
        {
            "introduction": "Mastering Lagrangian relaxation begins with understanding its role in the classic economic dispatch problem. This exercise tasks you with finding the cost-minimizing power output for a set of generators by applying the Karush-Kuhn-Tucker (KKT) conditions directly. By working through this foundational problem , you will gain a concrete understanding of how the Lagrange multiplier on the power balance constraint represents the system's marginal cost of energy, or market price.",
            "id": "4100508",
            "problem": "Consider a single-bus economic dispatch problem for a thermal generation fleet with three units. Each generator $i \\in \\{1,2,3\\}$ produces power $p_i$ measured in megawatts (MW) and incurs an hourly cost given by the quadratic function $C_i(p_i) = a_i p_i^2 + b_i p_i$, where $a_i  0$ and $b_i \\ge 0$. The system must meet a fixed demand $D$ measured in megawatts (MW), with no transmission constraints. Each generator is subject to physical box limits $P_i^{\\min} \\le p_i \\le P_i^{\\max}$. Assume that startup costs and no-load costs are zero and that the cost functions capture the incremental fuel and variable operations and maintenance costs only. The dispatcher is to minimize the total hourly generation cost subject to the power balance and unit operating limits.\n\nTake the following data:\n- Generator $1$: $a_1 = 0.2$, $b_1 = 10$, $P_1^{\\min} = 20$, $P_1^{\\max} = 120$.\n- Generator $2$: $a_2 = 0.1$, $b_2 = 12$, $P_2^{\\min} = 10$, $P_2^{\\max} = 100$.\n- Generator $3$: $a_3 = 0.3$, $b_3 = 9$, $P_3^{\\min} = 0$, $P_3^{\\max} = 80$.\n- Demand: $D = 200$.\n\nStarting from the definition of convex optimization and the Lagrangian relaxation of the coupling balance constraint, formulate the primal problem with decision variables $p_1$, $p_2$, and $p_3$, and the associated Lagrangian with multipliers for the equality and inequality constraints. Using the Karush-Kuhn-Tucker (KKT) conditions, including stationarity, primal feasibility, dual feasibility, and complementary slackness, derive the necessary conditions for optimality. Compute the optimal dispatch $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\}$ and the associated price $\\lambda^{\\star}$ (the optimal multiplier of the balance constraint), carefully determining which unit limits are active at optimum and verifying consistency of complementary slackness. No rounding is required; provide exact values.\n\nReport your final answer as a row matrix in the order $\\left[p_1^{\\star}\\; p_2^{\\star}\\; p_3^{\\star}\\; \\lambda^{\\star}\\right]$. Express $p_i^{\\star}$ in megawatts (MW) and $\\lambda^{\\star}$ in dollars per megawatt-hour ($/\\mathrm{MWh}$).",
            "solution": "The problem is a classic economic dispatch problem, which is a convex optimization problem. We first validate the problem statement.\n\n### Step 1: Extract Givens\n- **Cost Functions**: $C_i(p_i) = a_i p_i^2 + b_i p_i$ for $i \\in \\{1,2,3\\}$.\n- **Generator 1 Data**: $a_1 = 0.2$, $b_1 = 10$, $P_1^{\\min} = 20$ MW, $P_1^{\\max} = 120$ MW.\n- **Generator 2 Data**: $a_2 = 0.1$, $b_2 = 12$, $P_2^{\\min} = 10$ MW, $P_2^{\\max} = 100$ MW.\n- **Generator 3 Data**: $a_3 = 0.3$, $b_3 = 9$, $P_3^{\\min} = 0$ MW, $P_3^{\\max} = 80$ MW.\n- **Total Demand**: $D = 200$ MW.\n- **Constraints**:\n    - Power balance: $\\sum_{i=1}^3 p_i = D$.\n    - Generator limits: $P_i^{\\min} \\le p_i \\le P_i^{\\max}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem models the economic dispatch of thermal generators, a fundamental and well-established problem in power systems engineering. The quadratic cost functions are a standard, realistic approximation for fuel costs. The parameters are physically plausible. The optimization approach using Lagrangian relaxation and KKT conditions is a standard and rigorous mathematical technique for this class of problems. The problem is scientifically sound.\n- **Well-Posed**: The objective function, being a sum of quadratic functions with positive leading coefficients ($a_i  0$), is strictly convex. The feasible region, defined by linear equality and inequality constraints, is a convex set (a polytope). The minimization of a strictly convex function over a non-empty, closed, convex set has a unique solution. Therefore, the problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical terms and numerical data, with a clear and unambiguous objective. It is free of subjective language.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed to solve it.\n\n### Primal Problem Formulation\nThe goal is to minimize the total generation cost, $C_{total}$, subject to the demand being met and respecting individual generator limits. The decision variables are the power outputs $p_1, p_2, p_3$.\n\nThe optimization problem is:\n$$\n\\begin{aligned}\n \\underset{p_1, p_2, p_3}{\\text{minimize}}\n  C_{total} = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) \\\\\n \\text{subject to}\n  \\sum_{i=1}^{3} p_i = D \\quad (\\text{multiplier } \\lambda) \\\\\n   P_i^{\\min} \\le p_i \\le P_i^{\\max} \\quad \\forall i \\in \\{1,2,3\\}\n\\end{aligned}\n$$\nThe lower and upper bound inequalities can be written as $P_i^{\\min} - p_i \\le 0$ (multiplier $\\mu_i^{\\min}$) and $p_i - P_i^{\\max} \\le 0$ (multiplier $\\mu_i^{\\max}$).\n\n### Lagrangian Formulation\nThe Lagrangian function $L$ incorporates all constraints:\n$$\nL(p, \\lambda, \\mu^{\\min}, \\mu^{\\max}) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) + \\lambda \\left( D - \\sum_{i=1}^{3} p_i \\right) + \\sum_{i=1}^{3} \\mu_i^{\\min} (P_i^{\\min} - p_i) + \\sum_{i=1}^{3} \\mu_i^{\\max} (p_i - P_i^{\\max})\n$$\nwhere $p = (p_1, p_2, p_3)$, $\\mu^{\\min} = (\\mu_1^{\\min}, \\mu_2^{\\min}, \\mu_3^{\\min})$, and $\\mu^{\\max} = (\\mu_1^{\\max}, \\mu_2^{\\max}, \\mu_3^{\\max})$.\n\n### Karush-Kuhn-Tucker (KKT) Conditions\nFor a point $(p_1^{\\star}, p_2^{\\star}, p_3^{\\star})$ to be optimal, there must exist multipliers $\\lambda^{\\star}, \\mu_i^{\\min, \\star}, \\mu_i^{\\max, \\star}$ such that the following KKT conditions are met:\n1.  **Stationarity**: $\\frac{\\partial L}{\\partial p_i} = 0$ for $i=1, 2, 3$.\n    $$ 2a_i p_i^{\\star} + b_i - \\lambda^{\\star} - \\mu_i^{\\min, \\star} + \\mu_i^{\\max, \\star} = 0 $$\n2.  **Primal Feasibility**:\n    $$ \\sum_{i=1}^{3} p_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le p_i^{\\star} \\le P_i^{\\max} $$\n3.  **Dual Feasibility**:\n    $$ \\mu_i^{\\min, \\star} \\ge 0, \\quad \\mu_i^{\\max, \\star} \\ge 0 $$\n4.  **Complementary Slackness**:\n    $$ \\mu_i^{\\min, \\star} (P_i^{\\min} - p_i^{\\star}) = 0 $$\n    $$ \\mu_i^{\\max, \\star} (p_i^{\\star} - P_i^{\\max}) = 0 $$\n\nThe term $2a_i p_i + b_i$ is the incremental cost of generator $i$, denoted $IC_i(p_i)$. The stationarity condition can be rewritten as $IC_i(p_i^{\\star}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star} - \\mu_i^{\\max, \\star}$. Analyzing with complementary slackness gives three cases for each generator:\n- If $P_i^{\\min}  p_i^{\\star}  P_i^{\\max}$, then $\\mu_i^{\\min, \\star} = 0$ and $\\mu_i^{\\max, \\star} = 0$. The condition becomes $IC_i(p_i^{\\star}) = \\lambda^{\\star}$.\n- If $p_i^{\\star} = P_i^{\\min}$, then $\\mu_i^{\\max, \\star} = 0$ and $\\mu_i^{\\min, \\star} \\ge 0$. The condition implies $IC_i(P_i^{\\min}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star}$, so $IC_i(P_i^{\\min}) \\ge \\lambda^{\\star}$.\n- If $p_i^{\\star} = P_i^{\\max}$, then $\\mu_i^{\\min, \\star} = 0$ and $\\mu_i^{\\max, \\star} \\ge 0$. The condition implies $IC_i(P_i^{\\max}) = \\lambda^{\\star} - \\mu_i^{\\max, \\star}$, so $IC_i(P_i^{\\max}) \\le \\lambda^{\\star}$.\n\n### Iterative Solution\nWe use an iterative approach to find the set of active constraints.\n\n**Iteration 1: Assume no generator limits are active.**\nIn this case, $IC_i(p_i) = \\lambda$ for all $i$. This gives $p_i = (\\lambda - b_i) / (2a_i)$.\nThe power balance equation is $\\sum_{i=1}^{3} p_i = D = 200$.\n$$\n\\frac{\\lambda - 10}{2(0.2)} + \\frac{\\lambda - 12}{2(0.1)} + \\frac{\\lambda - 9}{2(0.3)} = 200\n$$\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 12}{0.2} + \\frac{\\lambda - 9}{0.6} = 200\n$$\nTo solve for $\\lambda$, we can write this as:\n$$\n(\\lambda - 10) \\left(\\frac{1}{0.4}\\right) + (\\lambda - 12) \\left(\\frac{1}{0.2}\\right) + (\\lambda - 9) \\left(\\frac{1}{0.6}\\right) = 200\n$$\n$$\n2.5(\\lambda - 10) + 5(\\lambda - 12) + \\frac{5}{3}(\\lambda - 9) = 200\n$$\nMultiplying by $6$ to clear all decimals and fractions:\n$$\n15(\\lambda - 10) + 30(\\lambda - 12) + 10(\\lambda - 9) = 1200\n$$\n$$\n15\\lambda - 150 + 30\\lambda - 360 + 10\\lambda - 90 = 1200\n$$\n$$\n55\\lambda - 600 = 1200 \\implies 55\\lambda = 1800 \\implies \\lambda = \\frac{1800}{55} = \\frac{360}{11}\n$$\nNow we compute the dispatch values with $\\lambda = 360/11 \\approx 32.727$:\n$p_1 = \\frac{360/11 - 10}{0.4} = \\frac{(360-110)/11}{0.4} = \\frac{250/11}{0.4} = \\frac{625}{11} \\approx 56.82$ MW.\nThis is within the limits $[20, 120]$ for generator $1$.\n$p_2 = \\frac{360/11 - 12}{0.2} = \\frac{(360-132)/11}{0.2} = \\frac{228/11}{0.2} = \\frac{1140}{11} \\approx 103.64$ MW.\nThis value exceeds the upper limit $P_2^{\\max} = 100$ MW for generator $2$. The assumption is false.\n\n**Iteration 2: Set generator 2 to its violated limit and re-dispatch.**\nWe fix the dispatch of generator $2$ at its maximum limit: $p_2^{\\star} = P_2^{\\max} = 100$ MW.\nThe remaining demand to be met by generators $1$ and $3$ is $D' = D - p_2^{\\star} = 200 - 100 = 100$ MW.\nWe now apply the equal incremental cost principle to generators $1$ and $3$ to meet the demand $D' = 100$.\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 9}{0.6} = 100\n$$\n$$\n2.5(\\lambda - 10) + \\frac{5}{3}(\\lambda - 9) = 100\n$$\nMultiplying by $6$:\n$$\n15(\\lambda - 10) + 10(\\lambda - 9) = 600\n$$\n$$\n15\\lambda - 150 + 10\\lambda - 90 = 600\n$$\n$$\n25\\lambda - 240 = 600 \\implies 25\\lambda = 840 \\implies \\lambda = \\frac{840}{25} = \\frac{168}{5} = 33.6\n$$\nWith this new system price, $\\lambda^{\\star} = 33.6 \\, \\$/\\mathrm{MWh}$, we compute the dispatch for generators $1$ and $3$:\n$p_1^{\\star} = \\frac{33.6 - 10}{0.4} = \\frac{23.6}{0.4} = 59$ MW.\nThis is within the limits $[20, 120]$.\n$p_3^{\\star} = \\frac{33.6 - 9}{0.6} = \\frac{24.6}{0.6} = 41$ MW.\nThis is within the limits $[0, 80]$.\n\n### Verification of the Solution\nThe proposed optimal solution is $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\} = \\{59, 100, 41\\}$ and $\\lambda^{\\star} = 33.6$.\n1.  **Primal Feasibility**:\n    - Power balance: $p_1^{\\star} + p_2^{\\star} + p_3^{\\star} = 59 + 100 + 41 = 200$ MW. This matches the demand $D$.\n    - Generator limits:\n        - $20 \\le p_1^{\\star} = 59 \\le 120$ (OK)\n        - $10 \\le p_2^{\\star} = 100 \\le 100$ (OK, at max limit)\n        - $0 \\le p_3^{\\star} = 41 \\le 80$ (OK)\n    All primal feasibility conditions are satisfied.\n\n2.  **KKT Conditions (Incremental Costs)**:\n    - **Generator 1**: Not at limits. We must verify $IC_1(p_1^{\\star}) = \\lambda^{\\star}$.\n      $IC_1(59) = 2(0.2)(59) + 10 = 0.4(59) + 10 = 23.6 + 10 = 33.6$. This equals $\\lambda^{\\star}$.\n    - **Generator 2**: At upper limit. We must verify $IC_2(p_2^{\\star}) \\le \\lambda^{\\star}$.\n      $IC_2(100) = 2(0.1)(100) + 12 = 20 + 12 = 32$.\n      The condition is $32 \\le 33.6$, which is true. (Complementary slackness gives $\\mu_2^{\\max, \\star} = \\lambda^{\\star} - IC_2(100) = 33.6 - 32 = 1.6 \\ge 0$).\n    - **Generator 3**: Not at limits. We must verify $IC_3(p_3^{\\star}) = \\lambda^{\\star}$.\n      $IC_3(41) = 2(0.3)(41) + 9 = 0.6(41) + 9 = 24.6 + 9 = 33.6$. This equals $\\lambda^{\\star}$.\n\nAll KKT conditions are satisfied, confirming that the solution is the unique optimum.\n\nThe final optimal dispatch is $p_1^{\\star} = 59$ MW, $p_2^{\\star} = 100$ MW, $p_3^{\\star} = 41$ MW, with an optimal system price of $\\lambda^{\\star} = 33.6$ $/MWh.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n59  100  41  33.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the concept of the Lagrange multiplier, this practice moves into the heart of the dual problem: its evaluation and optimization. Here, you will not solve for the final state but rather evaluate the Lagrangian dual function for a given set of multipliers and compute the associated subgradient . This exercise is crucial for understanding how iterative methods, like the subgradient method, work to find the optimal set of prices that solve the larger scheduling problem.",
            "id": "4100512",
            "problem": "Consider a multi-period economic dispatch problem over three time periods $t \\in \\{1,2,3\\}$ with two thermal generating units $i \\in \\{1,2\\}$. Each unit $i$ produces power $p_{i,t}$ in megawatts (MW) in period $t$, subject to $0 \\leq p_{i,t} \\leq P_{i}^{\\max}$, and incurs a convex differentiable operating cost $C_{i}(p_{i,t}) = a_{i} p_{i,t}^{2} + b_{i} p_{i,t}$. The system demand in each period is $D_{t}$, and the primal problem is to minimize total operating cost subject to per-period demand balance and capacity limits. A Lagrangian relaxation is formed by dualizing the per-period demand balance constraints with multipliers $\\lambda_{t}$.\n\nData:\n- Unit $1$: $a_{1} = 0.5$, $b_{1} = 10$, $P_{1}^{\\max} = 50$.\n- Unit $2$: $a_{2} = 0.2$, $b_{2} = 5$, $P_{2}^{\\max} = 30$.\n- Demands: $D_{1} = 25$, $D_{2} = 30$, $D_{3} = 35$ (MW).\n- Multipliers: $\\lambda_{1} = 12$, $\\lambda_{2} = 14$, $\\lambda_{3} = 16$.\n\nStarting from first principles of convex optimization and Lagrangian duality, compute the dual function value $L(\\lambda)$ obtained by solving the decomposed unit subproblems and aggregating across units and periods, and compute the associated subgradient components $s_{t}$ defined by the residuals of the dualized constraints at the minimizing primal decisions for the given multipliers. Provide your final answer as a single row matrix containing $L(\\lambda)$ followed by $s_{1}$, $s_{2}$, and $s_{3}$. No rounding is required. The power quantities are in megawatts (MW); the final matrix should contain only numerical values.",
            "solution": "The problem is valid. It describes a standard application of Lagrangian relaxation to an economic dispatch problem, which is a well-established convex optimization problem in power systems engineering. The problem is scientifically grounded, well-posed, objective, and self-contained, with all necessary data and definitions provided.\n\nThe primal economic dispatch problem is to minimize the total operating cost subject to demand balance and generator capacity limits.\nThe objective function is the sum of costs for all units over all periods:\n$$ \\min_{p_{i,t}} \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t}) $$\nThis is subject to the constraints:\n1. Demand balance for each period $t$: $\\sum_{i=1}^{2} p_{i,t} = D_{t}$ for $t \\in \\{1, 2, 3\\}$.\n2. Generation limits for each unit $i$ and period $t$: $0 \\leq p_{i,t} \\leq P_{i}^{\\max}$ for $i \\in \\{1, 2\\}$, $t \\in \\{1, 2, 3\\}$.\n\nTo form the Lagrangian relaxation, we dualize the demand balance constraints using the Lagrange multipliers $\\lambda_{t}$. The Lagrangian function $L(p, \\lambda)$ is:\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t} \\right) $$\nBy rearranging terms, we can see that the Lagrangian is separable by unit $i$ and time period $t$:\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t} - \\lambda_{t} p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nThe dual function $L(\\lambda)$ is found by minimizing the Lagrangian $L(p, \\lambda)$ with respect to the primal variables $p_{i,t}$, subject to the remaining non-dualized constraints ($0 \\leq p_{i,t} \\leq P_{i}^{\\max}$):\n$$ L(\\lambda) = \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} L(p, \\lambda) $$\nDue to separability, this minimization can be decomposed into independent subproblems for each unit $i$ and time period $t$:\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left( \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} \\{ a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t} \\} \\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nEach subproblem is a simple quadratic minimization. To find the unconstrained minimum of the term inside the brackets, we take the derivative with respect to $p_{i,t}$ and set it to zero:\n$$ \\frac{d}{dp_{i,t}} [a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t}] = 2 a_{i} p_{i,t} + b_{i} - \\lambda_{t} = 0 $$\nSolving for $p_{i,t}$ gives the optimal unconstrained dispatch for each subproblem, denoted as $p_{i,t}^{*}$:\n$$ p_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2 a_{i}} $$\nThe solution to the subproblem, $p_{i,t}^{\\text{opt}}$, must satisfy the capacity constraints, so we project $p_{i,t}^{*}$ onto the interval $[0, P_{i}^{\\max}]$:\n$$ p_{i,t}^{\\text{opt}} = \\max(0, \\min(P_{i}^{\\max}, p_{i,t}^{*})) $$\nWe now compute $p_{i,t}^{\\text{opt}}$ for the given data:\n- Unit $1$: $a_{1}=0.5$, $b_{1}=10$, $P_{1}^{\\max}=50$.\n- Unit $2$: $a_{2}=0.2$, $b_{2}=5$, $P_{2}^{\\max}=30$.\n- Multipliers: $\\lambda_{1}=12$, $\\lambda_{2}=14$, $\\lambda_{3}=16$.\n\nFor $t=1$ ($\\lambda_{1}=12$):\n- Unit $1$: $p_{1,1}^{*} = \\frac{12 - 10}{2 \\times 0.5} = \\frac{2}{1} = 2$. Since $0 \\le 2 \\le 50$, $p_{1,1}^{\\text{opt}} = 2$.\n- Unit $2$: $p_{2,1}^{*} = \\frac{12 - 5}{2 \\times 0.2} = \\frac{7}{0.4} = 17.5$. Since $0 \\le 17.5 \\le 30$, $p_{2,1}^{\\text{opt}} = 17.5$.\n\nFor $t=2$ ($\\lambda_{2}=14$):\n- Unit $1$: $p_{1,2}^{*} = \\frac{14 - 10}{2 \\times 0.5} = \\frac{4}{1} = 4$. Since $0 \\le 4 \\le 50$, $p_{1,2}^{\\text{opt}} = 4$.\n- Unit $2$: $p_{2,2}^{*} = \\frac{14 - 5}{2 \\times 0.2} = \\frac{9}{0.4} = 22.5$. Since $0 \\le 22.5 \\le 30$, $p_{2,2}^{\\text{opt}} = 22.5$.\n\nFor $t=3$ ($\\lambda_{3}=16$):\n- Unit $1$: $p_{1,3}^{*} = \\frac{16 - 10}{2 \\times 0.5} = \\frac{6}{1} = 6$. Since $0 \\le 6 \\le 50$, $p_{1,3}^{\\text{opt}} = 6$.\n- Unit $2$: $p_{2,3}^{*} = \\frac{16 - 5}{2 \\times 0.2} = \\frac{11}{0.4} = 27.5$. Since $0 \\le 27.5 \\le 30$, $p_{2,3}^{\\text{opt}} = 27.5$.\n\nNow we calculate the dual function value $L(\\lambda)$ by substituting these optimal values back into the Lagrangian expression:\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} (p_{i,t}^{\\text{opt}})^{2} + b_{i} p_{i,t}^{\\text{opt}}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} \\right) $$\nFirst, we compute the total operating cost term:\n$C(p^{\\text{opt}}) = (0.5 \\cdot 2^2 + 10 \\cdot 2) + (0.2 \\cdot 17.5^2 + 5 \\cdot 17.5) + (0.5 \\cdot 4^2 + 10 \\cdot 4) + (0.2 \\cdot 22.5^2 + 5 \\cdot 22.5) + (0.5 \\cdot 6^2 + 10 \\cdot 6) + (0.2 \\cdot 27.5^2 + 5 \\cdot 27.5)$\n$C(p^{\\text{opt}}) = (2 + 20) + (61.25 + 87.5) + (8 + 40) + (101.25 + 112.5) + (18 + 60) + (151.25 + 137.5)$\n$C(p^{\\text{opt}}) = 22 + 148.75 + 48 + 213.75 + 78 + 288.75 = 799.25$.\n\nNext, we compute the penalty term $\\sum \\lambda_t (D_t - \\sum p_{i,t}^{\\text{opt}})$ using demands $D_{1}=25, D_{2}=30, D_{3}=35$:\n- For $t=1$: $\\lambda_1 (D_1 - (p_{1,1}^{\\text{opt}} + p_{2,1}^{\\text{opt}})) = 12 (25 - (2 + 17.5)) = 12 (5.5) = 66$.\n- For $t=2$: $\\lambda_2 (D_2 - (p_{1,2}^{\\text{opt}} + p_{2,2}^{\\text{opt}})) = 14 (30 - (4 + 22.5)) = 14 (3.5) = 49$.\n- For $t=3$: $\\lambda_3 (D_3 - (p_{1,3}^{\\text{opt}} + p_{2,3}^{\\text{opt}})) = 16 (35 - (6 + 27.5)) = 16 (1.5) = 24$.\nThe total penalty term is $66 + 49 + 24 = 139$.\n\nThe dual function value is the sum of these two parts:\n$$ L(\\lambda) = 799.25 + 139 = 938.25 $$\n\nThe subgradient components, $s_t$, are the residuals of the dualized constraints, evaluated at the optimal primal solutions for the given multipliers:\n$$ s_{t} = D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} $$\n- For $t=1$: $s_1 = 25 - (2 + 17.5) = 25 - 19.5 = 5.5$.\n- For $t=2$: $s_2 = 30 - (4 + 22.5) = 30 - 26.5 = 3.5$.\n- For $t=3$: $s_3 = 35 - (6 + 27.5) = 35 - 33.5 = 1.5$.\n\nThe final answer is a row matrix containing $L(\\lambda)$, $s_1$, $s_2$, and $s_3$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 938.25  5.5  3.5  1.5 \\end{pmatrix} } $$"
        },
        {
            "introduction": "The final step is to connect the mathematical machinery of multipliers back to their powerful economic interpretations. This problem explores a non-intuitive yet practical scenario: the occurrence of negative electricity prices due to inflexible, must-run generation . By analyzing the KKT conditions in this context, you will develop a deeper appreciation for how dual variables act as shadow prices, revealing the marginal value or cost of each constraint in the system.",
            "id": "4100513",
            "problem": "Consider a single-bus social welfare formulation for day-ahead dispatch with one must-run generating unit and one flexible unit. The operator chooses generation $\\{p_1,p_2\\}$ and consumption $D$ to maximize consumer utility net of production costs, subject to power balance and unit constraints. The consumer has strictly concave utility $U(D)$, and generators have convex costs $C_1(p_1)$ and $C_2(p_2)$. The feasible set is defined by the equality constraint $D - p_1 - p_2 = 0$ and the box constraints $p_1 \\in [P_1^{\\min},P_1^{\\max}]$, $p_2 \\in [0,P_2^{\\max}]$. Assume the following data:\n- $U(D) = a D - \\frac{b}{2} D^2$ with $a = 40$ and $b = 1$,\n- $C_1(p_1) = c_1 p_1$ with $c_1 = 20$, $P_1^{\\min} = 50$, $P_1^{\\max} = 200$,\n- $C_2(p_2) = c_2 p_2$ with $c_2 = 60$, $P_2^{\\max} = 100$.\n\nUsing first principles of constrained optimization and duality, in particular the Karush–Kuhn–Tucker conditions and the interpretation of the multiplier on the power balance equality as the Locational Marginal Price (LMP), determine the optimal dispatch and explain how negative prices can arise from the interaction of the must-run minimum production constraint with low demand. Which of the following statements is correct?\n\nA. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = -10$. The negative price arises because the must-run minimum forces consumption beyond the satiation point where marginal utility is zero, so $\\lambda^\\star = U'(D^\\star) = 40 - 50 = -10$. The lower-bound multiplier on the must-run unit equals $\\alpha_1^\\star = C_1'(50) - \\lambda^\\star = 20 - (-10) = 30$, representing the marginal benefit (in objective reduction) of relaxing the minimum output.\n\nB. At the optimum, the LMP must equal the must-run unit’s marginal cost, so $\\lambda^\\star = 20$, and negative prices cannot occur in a convex welfare-maximizing problem because multipliers are nonnegative. The minimum output does not bind, so $\\alpha_1^\\star = 0$.\n\nC. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = 0$ because the must-run lower bound fully absorbs the imbalance through its multiplier, making consumers indifferent at the margin. The lower-bound multiplier satisfies $\\alpha_1^\\star = C_1'(50)$.\n\nD. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = -30$, computed as the difference between the flexible unit’s marginal cost and the must-run unit’s marginal cost. The lower-bound multiplier equals $\\alpha_1^\\star = 0$ because negative prices eliminate any binding constraint effects.",
            "solution": "The user has provided a constrained optimization problem in the context of electricity market dispatch and has requested a rigorous validation of the problem statement, followed by a full derivation of the solution and an evaluation of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem is to maximize the social welfare, formulated as consumer utility minus production costs:\n- Objective function: $\\max_{D, p_1, p_2} W = U(D) - C_1(p_1) - C_2(p_2)$\n- Consumer utility: $U(D) = a D - \\frac{b}{2} D^2$, with $a = 40$ and $b = 1$. So, $U(D) = 40D - \\frac{1}{2}D^2$.\n- Generator 1 (must-run): cost $C_1(p_1) = c_1 p_1$ with $c_1 = 20$. Constraints $p_1 \\in [P_1^{\\min}, P_1^{\\max}]$, with $P_1^{\\min} = 50$ and $P_1^{\\max} = 200$.\n- Generator 2 (flexible): cost $C_2(p_2) = c_2 p_2$ with $c_2 = 60$. Constraints $p_2 \\in [0, P_2^{\\max}]$, with $P_2^{\\max} = 100$.\n- Power balance constraint: $D - p_1 - p_2 = 0$.\n- The multiplier on the power balance equality constraint is defined as the Locational Marginal Price (LMP).\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is a standard, albeit simplified, representation of a single-node economic dispatch problem. The formulation of social welfare maximization, the use of quadratic utility and linear cost functions, and the concept of an LMP as the dual variable on the power balance constraint are all fundamental and well-established principles in power systems engineering and electricity market economics.\n- **Well-Posed:** The objective function $W$ is strictly concave. Specifically, $U(D)$ is strictly concave since its second derivative $U''(D) = -b = -1  0$, and the cost functions $C_1(p_1)$ and $C_2(p_2)$ are linear and thus convex. Maximizing a concave function (or minimizing a convex function) over a convex set is a convex optimization problem. The feasible region, defined by a linear equality constraint and box constraints, is a convex set. Therefore, a unique global optimum exists, and the problem is well-posed.\n- **Objective:** The problem is stated using precise mathematical definitions and objective numerical data. All terms are clearly defined.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, missing information, or ambiguity. The setup is internally consistent and grounded in established theory.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Solution Derivation\n\nThe optimization problem is:\n$$ \\max_{D, p_1, p_2} \\left( 40D - \\frac{1}{2}D^2 - 20p_1 - 60p_2 \\right) $$\nSubject to:\n1. $p_1 + p_2 - D = 0 \\quad (\\text{multiplier } \\lambda)$\n2. $p_1 - 50 \\ge 0 \\quad (\\text{multiplier } \\alpha_1^{\\min} \\ge 0)$\n3. $200 - p_1 \\ge 0 \\quad (\\text{multiplier } \\alpha_1^{\\max} \\ge 0)$\n4. $p_2 - 0 \\ge 0 \\quad (\\text{multiplier } \\alpha_2^{\\min} \\ge 0)$\n5. $100 - p_2 \\ge 0 \\quad (\\text{multiplier } \\alpha_2^{\\max} \\ge 0)$\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is:\n$$ \\mathcal{L} = (40D - \\frac{1}{2}D^2 - 20p_1 - 60p_2) + \\lambda(p_1 + p_2 - D) + \\alpha_1^{\\min}(p_1 - 50) + \\alpha_1^{\\max}(200 - p_1) + \\alpha_2^{\\min}(p_2) + \\alpha_2^{\\max}(100 - p_2) $$\n\nThe Karush–Kuhn–Tucker (KKT) conditions for an optimal solution $(D^\\star, p_1^\\star, p_2^\\star)$ are:\n\n**1. Stationarity:**\nThe partial derivatives of $\\mathcal{L}$ with respect to the primal variables must be zero at the optimum:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial D} = 40 - D^\\star - \\lambda^\\star = 0 \\implies \\lambda^\\star = 40 - D^\\star = U'(D^\\star) $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_1} = -20 + \\lambda^\\star + \\alpha_1^{\\min} - \\alpha_1^{\\max} = 0 \\implies \\lambda^\\star = 20 - \\alpha_1^{\\min} + \\alpha_1^{\\max} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_2} = -60 + \\lambda^\\star + \\alpha_2^{\\min} - \\alpha_2^{\\max} = 0 \\implies \\lambda^\\star = 60 - \\alpha_2^{\\min} + \\alpha_2^{\\max} $$\n\n**2. Primal Feasibility:**\nThe solution must satisfy all original constraints.\n\n**3. Dual Feasibility:**\nThe multipliers for the inequality constraints must be non-negative:\n$$ \\alpha_1^{\\min}, \\alpha_1^{\\max}, \\alpha_2^{\\min}, \\alpha_2^{\\max} \\ge 0 $$\n\n**4. Complementary Slackness:**\nFor each inequality constraint, either the constraint is binding (equality holds) or its multiplier is zero:\n$$ \\alpha_1^{\\min}(p_1^\\star - 50) = 0 $$\n$$ \\alpha_1^{\\max}(200 - p_1^\\star) = 0 $$\n$$ \\alpha_2^{\\min}(p_2^\\star) = 0 $$\n$$ \\alpha_2^{\\max}(100 - p_2^\\star) = 0 $$\n\n**Solving the KKT System:**\nThe problem is designed to highlight the effect of the must-run constraint $p_1 \\ge 50$. Unit 1 has a low marginal cost ($c_1=20$), while Unit 2 is expensive ($c_2=60$). The marginal utility of consumption is $U'(D) = 40 - D$. Unconstrained, the system would find a balance where price equals marginal cost. However, the must-run constraint may force production even when marginal utility is low or negative.\n\nLet us test the hypothesis that the optimal solution involves running the must-run unit at its minimum and keeping the expensive unit offline.\nCandidate solution: $p_1^\\star = 50$ and $p_2^\\star = 0$.\n\n- **Primal Feasibility:**\n    - From power balance: $D^\\star = p_1^\\star + p_2^\\star = 50 + 0 = 50$.\n    - $p_1^\\star = 50$ is in $[50, 200]$. Feasible.\n    - $p_2^\\star = 0$ is in $[0, 100]$. Feasible.\n    The primal feasibility conditions are met.\n\n- **Check Complementary Slackness and Find Multipliers:**\n    - $p_1^\\star = 50$: the lower bound is binding. $\\alpha_1^{\\min}$ can be non-zero.\n    - $p_1^\\star  200$: the upper bound is not binding. So, $\\alpha_1^{\\max} = 0$.\n    - $p_2^\\star = 0$: the lower bound is binding. $\\alpha_2^{\\min}$ can be non-zero.\n    - $p_2^\\star  100$: the upper bound is not binding. So, $\\alpha_2^{\\max} = 0$.\n\n- **Solve for Multipliers using Stationarity:**\n    - From the stationarity condition for $D$:\n      $\\lambda^\\star = 40 - D^\\star = 40 - 50 = -10$.\n      The LMP is negative. This occurs because the must-run constraint forces a level of consumption ($D^\\star = 50$) that is higher than the satiation point ($D_{sat}=40$, where $U'(D)=0$). At this point, the marginal utility is negative.\n\n    - From the stationarity condition for $p_1$, with $\\alpha_1^{\\max}=0$:\n      $\\lambda^\\star = 20 - \\alpha_1^{\\min} \\implies -10 = 20 - \\alpha_1^{\\min} \\implies \\alpha_1^{\\min} = 20 - (-10) = 30$.\n      Since $\\alpha_1^{\\min} = 30 \\ge 0$, this is a valid multiplier.\n\n    - From the stationarity condition for $p_2$, with $\\alpha_2^{\\max}=0$:\n      $\\lambda^\\star = 60 - \\alpha_2^{\\min} \\implies -10 = 60 - \\alpha_2^{\\min} \\implies \\alpha_2^{\\min} = 60 - (-10) = 70$.\n      Since $\\alpha_2^{\\min} = 70 \\ge 0$, this is a valid multiplier.\n\nAll KKT conditions are satisfied. Since the problem is convex, this solution is the unique global optimum.\nOptimal solution:\n- $p_1^\\star = 50$\n- $p_2^\\star = 0$\n- $D^\\star = 50$\n- LMP: $\\lambda^\\star = -10$\n- Multiplier on $p_1^{\\min}$: $\\alpha_1^{\\min} = 30$\n\nThe multiplier $\\alpha_1^{\\min}=30$ is the shadow price of the constraint $p_1 \\ge 50$. It represents the marginal increase in social welfare for each unit that the minimum generation requirement is relaxed (lowered). Its value is derived from the stationarity condition for $p_1$: $\\alpha_1^{\\min} = C_1'(p_1^\\star) - \\lambda^\\star = 20 - (-10) = 30$. This represents the marginal economic loss incurred by forcing the unit to produce at $50$ MW instead of its economically optimal level based on the system price.\n\n### Option-by-Option Analysis\n\n**A. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = -10$. The negative price arises because the must-run minimum forces consumption beyond the satiation point where marginal utility is zero, so $\\lambda^\\star = U'(D^\\star) = 40 - 50 = -10$. The lower-bound multiplier on the must-run unit equals $\\alpha_1^\\star = C_1'(50) - \\lambda^\\star = 20 - (-10) = 30$, representing the marginal benefit (in objective reduction) of relaxing the minimum output.**\n- The optimal values $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$ are all correct.\n- The LMP $\\lambda^\\star = -10$ is correct.\n- The explanation for the negative price (forcing consumption past the satiation point $D=40$) is correct.\n- The calculation $\\lambda^\\star = U'(D^\\star) = 40 - 50 = -10$ is correct.\n- The formula for the lower-bound multiplier, $\\alpha_1^\\star = C_1'(50) - \\lambda^\\star$, is correct based on the KKT condition.\n- The calculated value $\\alpha_1^\\star = 20 - (-10) = 30$ is correct.\n- The interpretation of this multiplier as the marginal benefit of relaxing the constraint is correct. The phrasing \"(in objective reduction)\" is slightly awkward but is best interpreted as referring to the cost (reduction in the objective) imposed by the constraint, which is numerically equal to the benefit of relaxing it.\n**Verdict: Correct.**\n\n**B. At the optimum, the LMP must equal the must-run unit’s marginal cost, so $\\lambda^\\star = 20$, and negative prices cannot occur in a convex welfare-maximizing problem because multipliers are nonnegative. The minimum output does not bind, so $\\alpha_1^\\star = 0$.**\n- \"LMP must equal the must-run unit’s marginal cost, so $\\lambda^\\star = 20$\": This is false. This would only be true if unit 1 was the marginal unit and not at a physical or economic limit.\n- \"negative prices cannot occur... because multipliers are nonnegative\": This is fundamentally false. The multipliers on inequality constraints ($\\alpha_i$) must be non-negative, but the multiplier on an equality constraint ($\\lambda$, the LMP) can be positive, negative, or zero.\n- \"The minimum output does not bind\": This is false, our solution shows it is binding.\n**Verdict: Incorrect.**\n\n**C. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = 0$ because the must-run lower bound fully absorbs the imbalance through its multiplier, making consumers indifferent at the margin. The lower-bound multiplier satisfies $\\alpha_1^\\star = C_1'(50)$.**\n- \"LMP equals $\\lambda^\\star = 0$\": This is false. The LMP is $\\lambda^\\star=-10$. If $\\lambda^\\star=0$, then $D^\\star=40$, which would violate power balance.\n- \"making consumers indifferent at the margin\": This phrase implies $U'(D)=0$, which corresponds to $\\lambda=0$. This premise is false.\n- \"the lower-bound multiplier satisfies $\\alpha_1^\\star = C_1'(50)$\": This is false. Our derivation showed $\\alpha_1^\\star = C_1'(50) - \\lambda^\\star = 20 - (-10) = 30$, not $C_1'(50)=20$.\n**Verdict: Incorrect.**\n\n**D. At the optimum, $p_1^\\star = 50$, $p_2^\\star = 0$, $D^\\star = 50$, and the LMP equals $\\lambda^\\star = -30$, computed as the difference between the flexible unit’s marginal cost and the must-run unit’s marginal cost. The lower-bound multiplier equals $\\alpha_1^\\star = 0$ because negative prices eliminate any binding constraint effects.**\n- \"LMP equals $\\lambda^\\star = -30$\": This is false. The LMP is $\\lambda^\\star=-10$. The proposed calculation method is arbitrary and incorrect.\n- \"The lower-bound multiplier equals $\\alpha_1^\\star = 0$\": This is false. The multiplier is $\\alpha_1^\\star=30$. The constraint is binding.\n- \"because negative prices eliminate any binding constraint effects\": This reasoning is nonsensical. The negative price is a direct consequence of the binding must-run constraint.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}