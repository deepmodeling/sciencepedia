{
    "hands_on_practices": [
        {
            "introduction": "差分进化（DE）是一种强大且高效的、基于群体的演化算法，在能源系统优化中得到了广泛应用。本练习将引导您完成一个经济调度问题的单代差分进化计算，重点是其核心的“DE/rand/1”变异策略和选择过程。通过这个实践，您将亲手体验到种群是如何通过变异、交叉和选择来逐步探索并逼近更优解的。",
            "id": "4103167",
            "problem": "考虑一个包含四台火力发电机的单周期经济调度问题，其中总负荷固定为需求 $D = 500$ 兆瓦 (MW)。发电机 $i$ 的运行成本由一个二次函数 $C_i(P_i) = a_i + b_i P_i + c_i P_i^2$ 建模，其中 $P_i$ 是输出功率（单位为 MW），$a_i$、$b_i$、$c_i$ 是非负系数。发电机具有可行运行边界 $P_i^{\\min} \\leq P_i \\leq P_i^{\\max}$。约束处理通过对违规行为进行二次惩罚来执行：惩罚后的目标函数为\n$$\nJ(\\mathbf{P}) = \\sum_{i=1}^{4} \\left(a_i + b_i P_i + c_i P_i^2\\right) + \\rho \\left(\\sum_{i=1}^{4} P_i - D\\right)^2 + \\phi \\sum_{i=1}^{4} \\left(\\max\\{0, P_i - P_i^{\\max}\\}^2 + \\max\\{0, P_i^{\\min} - P_i\\}^2\\right),\n$$\n其中惩罚系数为 $\\rho$ 和 $\\phi$。\n\n要求您使用 DE/rand/1/bin 策略和选择，精确执行一轮差分进化（DE）元启发式算法，然后报告获得的新的最优（最低）惩罚成本。使用以下数据：\n\n- 成本系数：\n  - 发电机 $1$：$a_1 = 500$，$b_1 = 5.3$，$c_1 = 0.002$。\n  - 发电机 $2$：$a_2 = 400$，$b_2 = 5.0$，$c_2 = 0.003$。\n  - 发电机 $3$：$a_3 = 200$，$b_3 = 4.5$，$c_3 = 0.004$。\n  - 发电机 $4$：$a_4 = 100$，$b_4 = 4.0$，$c_4 = 0.005$。\n- 运行边界：\n  - 发电机 $1$：$P_1^{\\min} = 50$，$P_1^{\\max} = 200$。\n  - 发电机 $2$：$P_2^{\\min} = 50$，$P_2^{\\max} = 180$。\n  - 发电机 $3$：$P_3^{\\min} = 30$，$P_3^{\\max} = 160$。\n  - 发电机 $4$：$P_4^{\\min} = 20$，$P_4^{\\max} = 150$。\n- 惩罚参数：$\\rho = 100$，$\\phi = 200$。\n- $N_p = 5$ 的初始种群，包含5个候选调度向量（每个都满足 $\\sum_i P_i = D$）：\n  - $\\mathbf{X}_1 = [120,\\ 150,\\ 110,\\ 120]$，\n  - $\\mathbf{X}_2 = [80,\\ 160,\\ 140,\\ 120]$，\n  - $\\mathbf{X}_3 = [150,\\ 140,\\ 100,\\ 110]$，\n  - $\\mathbf{X}_4 = [60,\\ 170,\\ 130,\\ 140]$，\n  - $\\mathbf{X}_5 = [180,\\ 100,\\ 90,\\ 130]$。\n- 差分进化（DE）参数和算子：\n  - 变异策略 DE/rand/1：对于每个目标索引 $i$，使用 $F = 0.6$ 和互不相同的索引 $r_1, r_2, r_3 \\in \\{1,2,3,4,5\\}\\setminus\\{i\\}$，形成变异个体 $\\mathbf{V}_i = \\mathbf{X}_{r_1} + F\\left(\\mathbf{X}_{r_2} - \\mathbf{X}_{r_3}\\right)$。\n  - 交叉：二项式交叉，交叉率 $CR = 1.0$，因此试验向量为 $\\mathbf{U}_i = \\mathbf{V}_i$。\n  - 选择：如果 $J(\\mathbf{U}_i) \\leq J(\\mathbf{X}_i)$，则替换 $\\mathbf{X}_i \\leftarrow \\mathbf{U}_i$；否则保留 $\\mathbf{X}_i$。\n- 使用以下预定的变异索引：\n  - 对于 $i=1$：$(r_1, r_2, r_3) = (2, 3, 4)$。\n  - 对于 $i=2$：$(r_1, r_2, r_3) = (5, 1, 3)$。\n  - 对于 $i=3$：$(r_1, r_2, r_3) = (4, 5, 2)$。\n  - 对于 $i=4$：$(r_1, r_2, r_3) = (1, 2, 5)$。\n  - 对于 $i=5$：$(r_1, r_2, r_3) = (3, 4, 1)$。\n\n完全按照上述规定执行单轮 DE 迭代。然后，在选择后的新种群中，确定最低的惩罚成本值。将您的最终答案四舍五入到四位有效数字。最终成本以 $\\$/\\mathrm{h}$ 表示。",
            "solution": "目标是为每个候选解计算惩罚成本\n$$\nJ(\\mathbf{P}) = \\sum_{i=1}^{4} \\left(a_i + b_i P_i + c_i P_i^2\\right) + \\rho \\left(\\sum_{i=1}^{4} P_i - D\\right)^2 + \\phi \\sum_{i=1}^{4} \\left(\\max\\{0, P_i - P_i^{\\max}\\}^2 + \\max\\{0, P_i^{\\min} - P_i\\}^2\\right)\n$$\n，应用一轮差分进化（DE），然后选择改进的候选解以形成下一代种群。此处的基础是经济调度二次成本的定义以及 DE 算子（变异、交叉和选择），其中约束通过二次惩罚来强制执行。\n\n首先，计算初始种群的基准成本 $J(\\mathbf{X}_i)$。由于每个 $\\mathbf{X}_i$ 都满足 $\\sum_{i=1}^{4} P_i = D$ 并且所有分量都在边界内，因此惩罚项为零。\n\n定义每个发电机的成本函数：\n- 发电机 $1$：$C_1(P_1) = 500 + 5.3 P_1 + 0.002 P_1^2$。\n- 发电机 $2$：$C_2(P_2) = 400 + 5.0 P_2 + 0.003 P_2^2$。\n- 发电机 $3$：$C_3(P_3) = 200 + 4.5 P_3 + 0.004 P_3^2$。\n- 发电机 $4$：$C_4(P_4) = 100 + 4.0 P_4 + 0.005 P_4^2$。\n\n计算 $J(\\mathbf{X}_i)$：\n\n$1)$ 对于 $\\mathbf{X}_1 = [120,\\ 150,\\ 110,\\ 120]$：\n- $C_1(120) = 500 + 5.3 \\cdot 120 + 0.002 \\cdot 120^2 = 500 + 636 + 28.8 = 1164.8$。\n- $C_2(150) = 400 + 5.0 \\cdot 150 + 0.003 \\cdot 150^2 = 400 + 750 + 67.5 = 1217.5$。\n- $C_3(110) = 200 + 4.5 \\cdot 110 + 0.004 \\cdot 110^2 = 200 + 495 + 48.4 = 743.4$。\n- $C_4(120) = 100 + 4.0 \\cdot 120 + 0.005 \\cdot 120^2 = 100 + 480 + 72 = 652$。\n因此 $J(\\mathbf{X}_1) = 1164.8 + 1217.5 + 743.4 + 652 = 3777.7$。\n\n$2)$ 对于 $\\mathbf{X}_2 = [80,\\ 160,\\ 140,\\ 120]$：\n- $C_1(80) = 500 + 5.3 \\cdot 80 + 0.002 \\cdot 80^2 = 500 + 424 + 12.8 = 936.8$。\n- $C_2(160) = 400 + 5.0 \\cdot 160 + 0.003 \\cdot 160^2 = 400 + 800 + 76.8 = 1276.8$。\n- $C_3(140) = 200 + 4.5 \\cdot 140 + 0.004 \\cdot 140^2 = 200 + 630 + 78.4 = 908.4$。\n- $C_4(120) = 652$。\n因此 $J(\\mathbf{X}_2) = 936.8 + 1276.8 + 908.4 + 652 = 3774.0$。\n\n$3)$ 对于 $\\mathbf{X}_3 = [150,\\ 140,\\ 100,\\ 110]$：\n- $C_1(150) = 500 + 5.3 \\cdot 150 + 0.002 \\cdot 150^2 = 500 + 795 + 45 = 1340$。\n- $C_2(140) = 400 + 5.0 \\cdot 140 + 0.003 \\cdot 140^2 = 400 + 700 + 58.8 = 1158.8$。\n- $C_3(100) = 690$。\n- $C_4(110) = 100 + 4.0 \\cdot 110 + 0.005 \\cdot 110^2 = 100 + 440 + 60.5 = 600.5$。\n因此 $J(\\mathbf{X}_3) = 1340 + 1158.8 + 690 + 600.5 = 3789.3$。\n\n$4)$ 对于 $\\mathbf{X}_4 = [60,\\ 170,\\ 130,\\ 140]$：\n- $C_1(60) = 500 + 5.3 \\cdot 60 + 0.002 \\cdot 60^2 = 500 + 318 + 7.2 = 825.2$。\n- $C_2(170) = 400 + 5.0 \\cdot 170 + 0.003 \\cdot 170^2 = 400 + 850 + 86.7 = 1336.7$。\n- $C_3(130) = 200 + 4.5 \\cdot 130 + 0.004 \\cdot 130^2 = 200 + 585 + 67.6 = 852.6$。\n- $C_4(140) = 100 + 4.0 \\cdot 140 + 0.005 \\cdot 140^2 = 100 + 560 + 98 = 758$。\n因此 $J(\\mathbf{X}_4) = 825.2 + 1336.7 + 852.6 + 758 = 3772.5$。\n\n$5)$ 对于 $\\mathbf{X}_5 = [180,\\ 100,\\ 90,\\ 130]$：\n- $C_1(180) = 500 + 5.3 \\cdot 180 + 0.002 \\cdot 180^2 = 500 + 954 + 64.8 = 1518.8$。\n- $C_2(100) = 400 + 5.0 \\cdot 100 + 0.003 \\cdot 100^2 = 400 + 500 + 30 = 930$。\n- $C_3(90) = 200 + 4.5 \\cdot 90 + 0.004 \\cdot 90^2 = 200 + 405 + 32.4 = 637.4$。\n- $C_4(130) = 100 + 4.0 \\cdot 130 + 0.005 \\cdot 130^2 = 100 + 520 + 84.5 = 704.5$。\n因此 $J(\\mathbf{X}_5) = 1518.8 + 930 + 637.4 + 704.5 = 3790.7$。\n\n初始最优解是 $\\mathbf{X}_4$，其成本为 $J(\\mathbf{X}_4) = 3772.5$。\n\n接下来，执行 DE 变异（$F = 0.6$），交叉（$CR = 1.0$，因此 $\\mathbf{U}_i = \\mathbf{V}_i$）和选择。因为所有初始 $\\mathbf{X}_i$ 都满足 $\\sum_{j=1}^{4} P_j = D$，并且变异使用种群成员的差分，所以每个变异个体也将满足 $\\sum_{j=1}^{4} V_{i,j} = D$：\n$$\n\\sum_{j=1}^{4} V_{i,j} = \\sum_{j=1}^{4} X_{r_1,j} + F \\left(\\sum_{j=1}^{4} X_{r_2,j} - \\sum_{j=1}^{4} X_{r_3,j}\\right) = D + F(D - D) = D,\n$$\n因此所有试验解的需求惩罚项均为零。只有边界违规会产生惩罚。\n\n计算变异个体 $\\mathbf{V}_i$：\n\n$1)$ $i=1$, $(r_1,r_2,r_3)=(2,3,4)$:\n$$\n\\mathbf{V}_1 = \\mathbf{X}_2 + 0.6(\\mathbf{X}_3 - \\mathbf{X}_4) = [80,160,140,120] + 0.6\\cdot[90,-30,-30,-30] = [134,142,122,102].\n$$\n\n$2)$ $i=2$, $(r_1,r_2,r_3)=(5,1,3)$:\n$$\n\\mathbf{V}_2 = \\mathbf{X}_5 + 0.6(\\mathbf{X}_1 - \\mathbf{X}_3) = [180,100,90,130] + 0.6\\cdot[-30,10,10,10] = [162,106,96,136].\n$$\n\n$3)$ $i=3$, $(r_1,r_2,r_3)=(4,5,2)$:\n$$\n\\mathbf{V}_3 = \\mathbf{X}_4 + 0.6(\\mathbf{X}_5 - \\mathbf{X}_2) = [60,170,130,140] + 0.6\\cdot[100,-60,-50,10] = [120,134,100,146].\n$$\n\n$4)$ $i=4$, $(r_1,r_2,r_3)=(1,2,5)$:\n$$\n\\mathbf{V}_4 = \\mathbf{X}_1 + 0.6(\\mathbf{X}_2 - \\mathbf{X}_5) = [120,150,110,120] + 0.6\\cdot[-100,60,50,-10] = [60,186,140,114].\n$$\n\n$5)$ $i=5$, $(r_1,r_2,r_3)=(3,4,1)$:\n$$\n\\mathbf{V}_5 = \\mathbf{X}_3 + 0.6(\\mathbf{X}_4 - \\mathbf{X}_1) = [150,140,100,110] + 0.6\\cdot[-60,20,20,20] = [114,152,112,122].\n$$\n\n评估边界违规情况：\n- $\\mathbf{V}_1$ 的分量 $[134,142,122,102]$ 均在边界内。\n- $\\mathbf{V}_2$ 的分量 $[162,106,96,136]$ 均在边界内。\n- $\\mathbf{V}_3$ 的分量 $[120,134,100,146]$ 均在边界内。\n- $\\mathbf{V}_4$ 的 $P_2 = 186 > P_2^{\\max} = 180$，违规量为 $6$ MW。惩罚贡献为 $\\phi \\cdot 6^2 = 200 \\cdot 36 = 7200$。\n- $\\mathbf{V}_5$ 的分量 $[114,152,112,122]$ 均在边界内。\n\n计算 $J(\\mathbf{V}_i)$（包括任何惩罚）：\n\n$1)$ $\\mathbf{V}_1 = [134,142,122,102]$：\n- $C_1(134) = 500 + 5.3 \\cdot 134 + 0.002 \\cdot 134^2 = 500 + 710.2 + 35.912 = 1246.112$。\n- $C_2(142) = 400 + 5.0 \\cdot 142 + 0.003 \\cdot 142^2 = 400 + 710 + 60.492 = 1170.492$。\n- $C_3(122) = 200 + 4.5 \\cdot 122 + 0.004 \\cdot 122^2 = 200 + 549 + 59.536 = 808.536$。\n- $C_4(102) = 100 + 4.0 \\cdot 102 + 0.005 \\cdot 102^2 = 100 + 408 + 52.02 = 560.02$。\n总计 $J(\\mathbf{V}_1) = 1246.112 + 1170.492 + 808.536 + 560.02 = 3785.16$。\n\n$2)$ $\\mathbf{V}_2 = [162,106,96,136]$：\n- $C_1(162) = 500 + 5.3 \\cdot 162 + 0.002 \\cdot 162^2 = 500 + 858.6 + 52.488 = 1411.088$。\n- $C_2(106) = 400 + 5.0 \\cdot 106 + 0.003 \\cdot 106^2 = 400 + 530 + 33.708 = 963.708$。\n- $C_3(96) = 200 + 4.5 \\cdot 96 + 0.004 \\cdot 96^2 = 200 + 432 + 36.864 = 668.864$。\n- $C_4(136) = 100 + 4.0 \\cdot 136 + 0.005 \\cdot 136^2 = 100 + 544 + 92.48 = 736.48$。\n总计 $J(\\mathbf{V}_2) = 1411.088 + 963.708 + 668.864 + 736.48 = 3780.14$。\n\n$3)$ $\\mathbf{V}_3 = [120,134,100,146]$：\n- $C_1(120) = 1164.8$。\n- $C_2(134) = 400 + 5.0 \\cdot 134 + 0.003 \\cdot 134^2 = 400 + 670 + 53.868 = 1123.868$。\n- $C_3(100) = 690$。\n- $C_4(146) = 100 + 4.0 \\cdot 146 + 0.005 \\cdot 146^2 = 100 + 584 + 106.58 = 790.58$。\n总计 $J(\\mathbf{V}_3) = 1164.8 + 1123.868 + 690 + 790.58 = 3769.248$。\n\n$4)$ $\\mathbf{V}_4 = [60,186,140,114]$：\n- $C_1(60) = 825.2$。\n- $C_2(186) = 400 + 5.0 \\cdot 186 + 0.003 \\cdot 186^2 = 400 + 930 + 103.788 = 1433.788$。\n- $C_3(140) = 908.4$。\n- $C_4(114) = 100 + 4.0 \\cdot 114 + 0.005 \\cdot 114^2 = 100 + 456 + 64.98 = 620.98$。\n基础成本总和 $= 825.2 + 1433.788 + 908.4 + 620.98 = 3788.368$。加上惩罚 $7200$，得到 $J(\\mathbf{V}_4) = 3788.368 + 7200 = 10988.368$。\n\n$5)$ $\\mathbf{V}_5 = [114,152,112,122]$：\n- $C_1(114) = 500 + 5.3 \\cdot 114 + 0.002 \\cdot 114^2 = 500 + 604.2 + 25.992 = 1130.192$。\n- $C_2(152) = 400 + 5.0 \\cdot 152 + 0.003 \\cdot 152^2 = 400 + 760 + 69.312 = 1229.312$。\n- $C_3(112) = 200 + 4.5 \\cdot 112 + 0.004 \\cdot 112^2 = 200 + 504 + 50.176 = 754.176$。\n- $C_4(122) = 100 + 4.0 \\cdot 122 + 0.005 \\cdot 122^2 = 100 + 488 + 74.42 = 662.42$。\n总计 $J(\\mathbf{V}_5) = 1130.192 + 1229.312 + 754.176 + 662.42 = 3776.10$。\n\n对每个目标 $i$ 应用选择：\n- $i=1$：$J(\\mathbf{V}_1) = 3785.16 > J(\\mathbf{X}_1) = 3777.7$，保留 $\\mathbf{X}_1$。\n- $i=2$：$J(\\mathbf{V}_2) = 3780.14 > J(\\mathbf{X}_2) = 3774.0$，保留 $\\mathbf{X}_2$。\n- $i=3$：$J(\\mathbf{V}_3) = 3769.248  J(\\mathbf{X}_3) = 3789.3$，替换 $\\mathbf{X}_3 \\leftarrow \\mathbf{V}_3$。\n- $i=4$：$J(\\mathbf{V}_4) = 10988.368 \\gg J(\\mathbf{X}_4) = 3772.5$，保留 $\\mathbf{X}_4$。\n- $i=5$：$J(\\mathbf{V}_5) = 3776.10  J(\\mathbf{X}_5) = 3790.7$，替换 $\\mathbf{X}_5 \\leftarrow \\mathbf{V}_5$。\n\n经过一轮迭代和选择后的新种群是：\n- $\\mathbf{X}_1' = \\mathbf{X}_1$，成本为 $J(\\mathbf{X}_1') = 3777.7$，\n- $\\mathbf{X}_2' = \\mathbf{X}_2$，成本为 $J(\\mathbf{X}_2') = 3774.0$，\n- $\\mathbf{X}_3' = \\mathbf{V}_3 = [120,134,100,146]$，成本为 $J(\\mathbf{X}_3') = 3769.248$，\n- $\\mathbf{X}_4' = \\mathbf{X}_4$，成本为 $J(\\mathbf{X}_4') = 3772.5$，\n- $\\mathbf{X}_5' = \\mathbf{V}_5 = [114,152,112,122]$，成本为 $J(\\mathbf{X}_5') = 3776.10$。\n\n新种群中的最优（最低）惩罚成本是 $J(\\mathbf{X}_3') = 3769.248$。四舍五入到四位有效数字得到 $3769$。单位是美元/小时（$\\$/\\mathrm{h}$），如题目规定。",
            "answer": "$$\\boxed{3769}$$"
        },
        {
            "introduction": "粒子群优化（PSO）是另一种受自然启发的群体智能算法，其搜索机制模仿了鸟群觅食的行为。与差分进化的演化机制不同，PSO通过粒子在解空间中的“飞行”来进行搜索，其轨迹受到个体经验（个体最优）和群体智慧（全局最优）的共同引导。本练习将聚焦于PSO算法的核心——速度与位置更新方程，让您亲手计算一个粒子在一次迭代中的完整运动过程。",
            "id": "4103138",
            "problem": "考虑一个简化的最优潮流 (Optimal Power Flow, OPF) 类的连续优化问题，该问题针对一个双发电机系统，其决策向量为 $\\mathbf{p} = (p_{1}, p_{2})$，表示有功功率输出。其带惩罚的目标函数结合了二次发电成本、功率平衡的二次惩罚项，以及在直流 (Direct Current, DC) 潮流近似下单条线路潮流的二次惩罚项： $$J(\\mathbf{p}) = \\sum_{i=1}^{2} \\left( a_{i} p_{i}^{2} + b_{i} p_{i} \\right) + \\lambda \\left( p_{1} + p_{2} - D \\right)^{2} + \\mu \\left( h_{1} p_{1} + h_{2} p_{2} - F_{\\max} \\right)^{2},$$ 其中 $a_{1} = 0.005$, $a_{2} = 0.008$, $b_{1} = 12$, $b_{2} = 15$, $D = 220$, $\\lambda = 0.2$, $\\mu = 0.05$, $\\mathbf{h} = (h_{1}, h_{2}) = (0.8, -0.5)$，且 $F_{\\max} = 70$。发电机输出的箱式约束为 $p_{1} \\in [50, 250]$ 和 $p_{2} \\in [20, 150]$，并且到这个箱体的欧几里得投影是按分量计算的，即通过将任何超出范围的分量“钳位”到最近的边界值。\n\n现要求您对两个粒子执行一次粒子群优化 (Particle Swarm Optimization, PSO) 迭代，该迭代由惯性、认知和社会分量定义。算法的超参数为：惯性权重 $w = 0.6$，认知系数 $c_{1} = 1.7$，社会系数 $c_{2} = 3.0$。粒子（标记为 A 和 B）的当前位置、速度和个体最优值如下：\n- 粒子 A: $\\mathbf{x}_{A}^{t} = (120, 80)$, $\\mathbf{v}_{A}^{t} = (5, -50)$, $\\mathbf{pbest}_{A} = (130, 70)$。\n- 粒子 B: $\\mathbf{x}_{B}^{t} = (160, 40)$, $\\mathbf{v}_{B}^{t} = (-4, 6)$, $\\mathbf{pbest}_{B} = (150, 50)$。\n共同的全局最优值为 $\\mathbf{gbest} = (210, 60)$。\n\n使用粒子群优化 (PSO) 的标准解释，其中每个粒子的速度通过其惯性、对其个体最优值的吸引力以及对全局最优值的吸引力进行更新，并使用独立的均匀随机乘数。对于本次迭代，粒子 A 的随机标量取 $r_{1,A} = 0.3$ 和 $r_{2,A} = 0.9$，粒子 B 的随机标量取 $r_{1,B} = 0.8$ 和 $r_{2,B} = 1.0$。在计算更新后的速度和位置之后，将新位置投影到上述定义的箱式约束上。\n\n请按顺序报告八个数字，包括粒子 A 的更新后速度分量和投影后的更新位置，然后是粒子 B 的相应值，即 $\\left(v_{A,1}^{t+1}, v_{A,2}^{t+1}, x_{A,1}^{t+1,\\mathrm{proj}}, x_{A,2}^{t+1,\\mathrm{proj}}, v_{B,1}^{t+1}, v_{B,2}^{t+1}, x_{B,1}^{t+1,\\mathrm{proj}}, x_{B,2}^{t+1,\\mathrm{proj}}\\right)$。将报告的每个数字四舍五入到四位有效数字。使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境将最终数值答案表示为单个行向量，不带单位。",
            "solution": "用户提供了一个适定问题，要求在二维搜索空间中对两个粒子执行单次粒子群优化 (PSO) 算法迭代。该问题经验证是合理的、完整的，并且没有科学或逻辑上的缺陷。目标函数 $J(\\mathbf{p})$ 是为提供背景信息而给出的，但对于解决所提出的问题并非必要，因为该问题仅关注算法的运动学更新步骤（速度和位置更新）。\n\n粒子 $i$ 在迭代 $t$ 时的标准 PSO 更新方程如下：\n速度更新：\n$$ \\mathbf{v}_{i}^{t+1} = w \\mathbf{v}_{i}^{t} + c_{1} r_{1,i} (\\mathbf{pbest}_{i} - \\mathbf{x}_{i}^{t}) + c_{2} r_{2,i} (\\mathbf{gbest} - \\mathbf{x}_{i}^{t}) $$\n位置更新：\n$$ \\mathbf{x}_{i}^{t+1} = \\mathbf{x}_{i}^{t} + \\mathbf{v}_{i}^{t+1} $$\n其中 $\\mathbf{v}$ 是速度向量，$\\mathbf{x}$ 是位置向量（等同于决策向量 $\\mathbf{p}$），$w$ 是惯性权重，$c_1$ 和 $c_2$ 是认知和社会系数，$r_{1,i}$ 和 $r_{2,i}$ 是随机数，$\\mathbf{pbest}_{i}$ 是粒子 $i$ 的个体最优位置，而 $\\mathbf{gbest}$ 是所有粒子找到的全局最优位置。\n\n问题指定了以下超参数：$w = 0.6$，$c_{1} = 1.7$ 和 $c_{2} = 3.0$。位置的箱式约束为 $p_1 \\in [50, 250]$ 和 $p_2 \\in [20, 150]$。\n\n现在我们将计算每个粒子的更新后速度和位置，然后将新位置投影到指定的箱式约束上。\n\n**粒子 A：更新计算**\n\n粒子 A 的初始状态和随机数如下：\n-   当前位置: $\\mathbf{x}_{A}^{t} = \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix}$\n-   当前速度: $\\mathbf{v}_{A}^{t} = \\begin{pmatrix} 5 \\\\ -50 \\end{pmatrix}$\n-   个体最优位置: $\\mathbf{pbest}_{A} = \\begin{pmatrix} 130 \\\\ 70 \\end{pmatrix}$\n-   全局最优位置: $\\mathbf{gbest} = \\begin{pmatrix} 210 \\\\ 60 \\end{pmatrix}$\n-   随机标量: $r_{1,A} = 0.3$, $r_{2,A} = 0.9$\n\n首先，我们更新速度 $\\mathbf{v}_{A}^{t+1}$：\n$$ \\mathbf{v}_{A}^{t+1} = (0.6) \\mathbf{v}_{A}^{t} + (1.7)(0.3)(\\mathbf{pbest}_{A} - \\mathbf{x}_{A}^{t}) + (3.0)(0.9)(\\mathbf{gbest} - \\mathbf{x}_{A}^{t}) $$\n$$ \\mathbf{v}_{A}^{t+1} = 0.6 \\begin{pmatrix} 5 \\\\ -50 \\end{pmatrix} + 0.51\\left( \\begin{pmatrix} 130 \\\\ 70 \\end{pmatrix} - \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix} \\right) + 2.7\\left( \\begin{pmatrix} 210 \\\\ 60 \\end{pmatrix} - \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix} \\right) $$\n$$ \\mathbf{v}_{A}^{t+1} = \\begin{pmatrix} 3 \\\\ -30 \\end{pmatrix} + 0.51 \\begin{pmatrix} 10 \\\\ -10 \\end{pmatrix} + 2.7 \\begin{pmatrix} 90 \\\\ -20 \\end{pmatrix} $$\n$$ \\mathbf{v}_{A}^{t+1} = \\begin{pmatrix} 3 \\\\ -30 \\end{pmatrix} + \\begin{pmatrix} 5.1 \\\\ -5.1 \\end{pmatrix} + \\begin{pmatrix} 243 \\\\ -54 \\end{pmatrix} $$\n$$ \\mathbf{v}_{A}^{t+1} = \\begin{pmatrix} 3 + 5.1 + 243 \\\\ -30 - 5.1 - 54 \\end{pmatrix} = \\begin{pmatrix} 251.1 \\\\ -89.1 \\end{pmatrix} $$\n接下来，我们更新位置 $\\mathbf{x}_{A}^{t+1}$：\n$$ \\mathbf{x}_{A}^{t+1} = \\mathbf{x}_{A}^{t} + \\mathbf{v}_{A}^{t+1} = \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix} + \\begin{pmatrix} 251.1 \\\\ -89.1 \\end{pmatrix} = \\begin{pmatrix} 371.1 \\\\ -9.1 \\end{pmatrix} $$\n最后，我们将新位置 $\\mathbf{x}_{A}^{t+1}$ 投影到箱式约束 $p_1 \\in [50, 250]$ 和 $p_2 \\in [20, 150]$ 上：\n$$ x_{A,1}^{t+1, \\mathrm{proj}} = \\max(50, \\min(371.1, 250)) = 250 $$\n$$ x_{A,2}^{t+1, \\mathrm{proj}} = \\max(20, \\min(-9.1, 150)) = 20 $$\n因此，投影后的位置是 $\\mathbf{x}_{A}^{t+1, \\mathrm{proj}} = \\begin{pmatrix} 250 \\\\ 20 \\end{pmatrix}$。\n\n**粒子 B：更新计算**\n\n粒子 B 的初始状态和随机数如下：\n-   当前位置: $\\mathbf{x}_{B}^{t} = \\begin{pmatrix} 160 \\\\ 40 \\end{pmatrix}$\n-   当前速度: $\\mathbf{v}_{B}^{t} = \\begin{pmatrix} -4 \\\\ 6 \\end{pmatrix}$\n-   个体最优位置: $\\mathbf{pbest}_{B} = \\begin{pmatrix} 150 \\\\ 50 \\end{pmatrix}$\n-   全局最优位置: $\\mathbf{gbest} = \\begin{pmatrix} 210 \\\\ 60 \\end{pmatrix}$\n-   随机标量: $r_{1,B} = 0.8$, $r_{2,B} = 1.0$\n\n首先，我们更新速度 $\\mathbf{v}_{B}^{t+1}$：\n$$ \\mathbf{v}_{B}^{t+1} = (0.6) \\mathbf{v}_{B}^{t} + (1.7)(0.8)(\\mathbf{pbest}_{B} - \\mathbf{x}_{B}^{t}) + (3.0)(1.0)(\\mathbf{gbest} - \\mathbf{x}_{B}^{t}) $$\n$$ \\mathbf{v}_{B}^{t+1} = 0.6 \\begin{pmatrix} -4 \\\\ 6 \\end{pmatrix} + 1.36\\left( \\begin{pmatrix} 150 \\\\ 50 \\end{pmatrix} - \\begin{pmatrix} 160 \\\\ 40 \\end{pmatrix} \\right) + 3.0\\left( \\begin{pmatrix} 210 \\\\ 60 \\end{pmatrix} - \\begin{pmatrix} 160 \\\\ 40 \\end{pmatrix} \\right) $$\n$$ \\mathbf{v}_{B}^{t+1} = \\begin{pmatrix} -2.4 \\\\ 3.6 \\end{pmatrix} + 1.36 \\begin{pmatrix} -10 \\\\ 10 \\end{pmatrix} + 3.0 \\begin{pmatrix} 50 \\\\ 20 \\end{pmatrix} $$\n$$ \\mathbf{v}_{B}^{t+1} = \\begin{pmatrix} -2.4 \\\\ 3.6 \\end{pmatrix} + \\begin{pmatrix} -13.6 \\\\ 13.6 \\end{pmatrix} + \\begin{pmatrix} 150 \\\\ 60 \\end{pmatrix} $$\n$$ \\mathbf{v}_{B}^{t+1} = \\begin{pmatrix} -2.4 - 13.6 + 150 \\\\ 3.6 + 13.6 + 60 \\end{pmatrix} = \\begin{pmatrix} 134 \\\\ 77.2 \\end{pmatrix} $$\n接下来，我们更新位置 $\\mathbf{x}_{B}^{t+1}$：\n$$ \\mathbf{x}_{B}^{t+1} = \\mathbf{x}_{B}^{t} + \\mathbf{v}_{B}^{t+1} = \\begin{pmatrix} 160 \\\\ 40 \\end{pmatrix} + \\begin{pmatrix} 134 \\\\ 77.2 \\end{pmatrix} = \\begin{pmatrix} 294 \\\\ 117.2 \\end{pmatrix} $$\n最后，我们将新位置 $\\mathbf{x}_{B}^{t+1}$ 投影到箱式约束上：\n$$ x_{B,1}^{t+1, \\mathrm{proj}} = \\max(50, \\min(294, 250)) = 250 $$\n$$ x_{B,2}^{t+1, \\mathrm{proj}} = \\max(20, \\min(117.2, 150)) = 117.2 $$\n因此，投影后的位置是 $\\mathbf{x}_{B}^{t+1, \\mathrm{proj}} = \\begin{pmatrix} 250 \\\\ 117.2 \\end{pmatrix}$。\n\n**最终结果汇总**\n\n要求的输出是八个数字的有序集合：\n$$ \\left(v_{A,1}^{t+1}, v_{A,2}^{t+1}, x_{A,1}^{t+1,\\mathrm{proj}}, x_{A,2}^{t+1,\\mathrm{proj}}, v_{B,1}^{t+1}, v_{B,2}^{t+1}, x_{B,1}^{t+1,\\mathrm{proj}}, x_{B,2}^{t+1,\\mathrm{proj}}\\right) $$\n计算出的值为：\n$$ (251.1, -89.1, 250, 20, 134, 77.2, 250, 117.2) $$\n按要求将每个数字四舍五入到四位有效数字：\n-   $v_{A,1}^{t+1} = 251.1$ (已经是 4 位有效数字)\n-   $v_{A,2}^{t+1} = -89.1 \\to -89.10$\n-   $x_{A,1}^{t+1,\\mathrm{proj}} = 250 \\to 250.0$\n-   $x_{A,2}^{t+1,\\mathrm{proj}} = 20 \\to 20.00$\n-   $v_{B,1}^{t+1} = 134 \\to 134.0$\n-   $v_{B,2}^{t+1} = 77.2 \\to 77.20$\n-   $x_{B,1}^{t+1,\\mathrm{proj}} = 250 \\to 250.0$\n-   $x_{B,2}^{t+1,\\mathrm{proj}} = 117.2$ (已经是 4 位有效数字)\n\n最终的数字向量为 $(251.1, -89.10, 250.0, 20.00, 134.0, 77.20, 250.0, 117.2)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 251.1  -89.10  250.0  20.00  134.0  77.20  250.0  117.2 \\end{pmatrix} } $$"
        },
        {
            "introduction": "与基于群体的差分进化和粒子群优化不同，模拟退火（SA）是一种基于单个解的轨迹搜索元启发式算法。其独特的优势在于能够以一定的概率接受劣质解，从而有效避免陷入局部最优，这一机制的灵感来源于固体材料的退火过程。本练习将让您专注于模拟退火算法的决策核心——Metropolis接受准则，通过计算来理解算法如何在优化过程中进行概率性的“跳跃”。",
            "id": "4103172",
            "problem": "考虑一个针对三个火力发电机组在四个离散时间段内的机组组合和经济调度简化模型。设净需求曲线为 $D_{t}$，$t \\in \\{1,2,3,4\\}$，$D_{t}$ 的值为 $[120,140,160,130]$ 兆瓦。每个发电机组 $i \\in \\{1,2,3\\}$ 在时间段 $t$ 的发电成本是一个凸二次函数 $C_{i}(P_{i,t}) = \\alpha_{i} P_{i,t}^{2} + \\beta_{i} P_{i,t} + \\gamma_{i}$，其系数分别为 $(\\alpha_{1},\\beta_{1},\\gamma_{1})=(2.0 \\times 10^{-3},18,120)$、$(\\alpha_{2},\\beta_{2},\\gamma_{2})=(1.6 \\times 10^{-3},22,100)$ 和 $(\\alpha_{3},\\beta_{3},\\gamma_{3})=(2.4 \\times 10^{-3},16,130)$。在每个时间段，负荷平衡由一个二次惩罚项 $\\lambda \\left(\\sum_{i=1}^{3} P_{i,t} - D_{t}\\right)^{2}$ 来表示，其中 $\\lambda=0.06$，多时段目标是所有时间段的发电成本与负荷平衡惩罚项之和。假设铭牌容量和爬坡速率约束已满足，在本问题中无需显式强制执行。\n\n您处于一个当前的可行调度解 $x^{(k)}$，并应用基于玻尔兹曼分布的Metropolis接受准则的模拟退火（SA）算法。生成了三个单步移动提议，并根据多时段目标函数进行评估，得到相对于 $x^{(k)}$ 的新提议状态的目标函数变化量 $\\Delta E$。温度固定为 $T=5$，其单位与目标函数的成本单位相同。对于这三个提议，目标函数的变化量和用于接受测试的独立均匀随机变量分别为\n$$\n\\Delta E_{1} = 3.2, \\quad \\Delta E_{2} = -1.0, \\quad \\Delta E_{3} = 7.5,\n$$\n和\n$$\nu_{1} = 0.20, \\quad u_{2} = 0.70, \\quad u_{3} = 0.80,\n$$\n。\n\n使用将玻尔兹曼分布与Metropolis接受准则联系起来的基本原理，确定对这三个提议的接受决策，决策编码为 $a_{j} \\in \\{0,1\\}$，$j \\in \\{1,2,3\\}$，其中 $a_{j}=1$ 表示接受，$a_{j}=0$ 表示拒绝。将您的最终答案表示为行矩阵 $\\begin{pmatrix} a_{1}  a_{2}  a_{3} \\end{pmatrix}$。无需四舍五入，矩阵中的条目是无量纲的指示符。",
            "solution": "该问题要求根据Metropolis接受准则，确定在一个模拟退火（SA）优化过程中对三个提议移动的接受决策。问题背景是一个能源系统的经济调度模型，但核心任务仅需要每个提议的目标函数变化量（$\\Delta E$）、系统温度（$T$）和一个随机数（$u$）。\n\nMetropolis接受准则源于统计力学原理，特别是玻尔兹曼分布，该分布指出，在热平衡状态下，系统处于能量为 $E$ 的状态的概率与玻尔兹曼因子 $\\exp(-E/T)$ 成正比，其中 $T$ 是温度（以能量单位表示，因为 $k_B$ 被吸收了）。在模拟退火算法中，目标函数 $E$ 类似于能量。该算法通过随机探索状态空间来寻找一个低能量（低成本）的状态。\n\n从一个目标值为 $E_{k}$ 的当前状态移动到一个目标值为 $E_{new}$ 的新提议状态，会产生一个变化量 $\\Delta E = E_{new} - E_{k}$。Metropolis准则决定是否接受这个移动。该规则的实现如下：\n\n1. 如果移动导致目标函数减小（$\\Delta E  0$），则总是接受该移动。这对应于移动到一个更优的解。\n2. 如果移动导致目标函数增加（$\\Delta E \\ge 0$），则以概率 $P_{acc} = \\exp(-\\frac{\\Delta E}{T})$ 接受该移动。这使得算法可以通过偶尔接受较差的解来跳出局部最小值。\n\n表达该规则的一个统一方法是，生成一个均匀随机数 $u \\in [0, 1)$，如果 $u  \\exp(-\\frac{\\Delta E}{T})$，则接受该移动。\n如果 $\\Delta E  0$，那么 $-\\frac{\\Delta E}{T} > 0$，这意味着 $\\exp(-\\frac{\\Delta E}{T}) > 1$。由于 $u$ 总是小于 $1$，该条件总是满足，因此接受移动。\n如果 $\\Delta E \\ge 0$，那么 $-\\frac{\\Delta E}{T} \\le 0$，这意味着 $\\exp(-\\frac{\\Delta E}{T}) \\in (0, 1]$。如果随机数 $u$ 小于这个概率值，则接受移动。\n\n问题提供了温度 $T=5$ 以及三个提议的数据。我们对每个提议应用接受准则。接受决策编码为 $a_j=1$，拒绝决策编码为 $a_j=0$。\n\n**提议 1：**\n- 目标函数变化量：$\\Delta E_{1} = 3.2$。\n- 随机数：$u_{1} = 0.20$。\n- 由于 $\\Delta E_{1} > 0$，这是一个非改进的移动。是否接受取决于概率检查。\n- 我们必须检查是否 $u_{1}  \\exp(-\\frac{\\Delta E_{1}}{T})$。\n- 条件是 $0.20  \\exp(-\\frac{3.2}{5}) = \\exp(-0.64)$。\n- 为了在不计算指数的情况下验证此不等式，我们可以对两边取自然对数。由于 $\\ln(x)$ 是一个对 $x>0$ 严格递增的函数，不等式关系得以保持：$\\ln(0.20)  -0.64$。\n- 小于 $1$ 的数的自然对数是负数。我们知道 $\\ln(1/e) = \\ln(\\exp(-1)) = -1$。由于 $0.20$ 小于 $1/e \\approx 0.3678$，其对数 $\\ln(0.20)$ 将小于 $-1$。\n- 具体来说，$\\ln(0.20) = \\ln(1/5) = -\\ln(5) \\approx -1.609$。\n- 条件是 $-1.609  -0.64$，这是成立的。\n- 因此，条件 $u_{1}  \\exp(-\\frac{\\Delta E_{1}}{T})$ 满足。该移动被接受。\n- $a_{1} = 1$。\n\n**提议 2：**\n- 目标函数变化量：$\\Delta E_{2} = -1.0$。\n- 随机数：$u_{2} = 0.70$。\n- 由于 $\\Delta E_{2}  0$，这是一个改进的移动。根据Metropolis准则，它必须总是被接受。\n- 让我们使用统一规则来验证这一点：检查是否 $u_{2}  \\exp(-\\frac{\\Delta E_{2}}{T})$。\n- 条件是 $0.70  \\exp(-\\frac{-1.0}{5}) = \\exp(0.2)$。\n- 由于指数函数的参数 $0.2$ 是正数，所以 $\\exp(0.2) > 1$。\n- 任何随机数 $u \\in [0, 1)$ 都会小于一个大于 $1$ 的值。\n- 条件 $0.70  \\exp(0.2)$ 成立。该移动被接受。\n- $a_{2} = 1$。\n\n**提议 3：**\n- 目标函数变化量：$\\Delta E_{3} = 7.5$。\n- 随机数：$u_{3} = 0.80$。\n- 由于 $\\Delta E_{3} > 0$，这是一个非改进的移动。\n- 我们必须检查是否 $u_{3}  \\exp(-\\frac{\\Delta E_{3}}{T})$。\n- 条件是 $0.80  \\exp(-\\frac{7.5}{5}) = \\exp(-1.5)$。\n- 同样，我们可以比较对数：$\\ln(0.80)  -1.5$？\n- 我们知道 $\\ln(0.80) \\approx -0.223$。\n- 条件变为 $-0.223  -1.5$，这是不成立的。\n- 因此，条件 $u_{3}  \\exp(-\\frac{\\Delta E_{3}}{T})$ 不满足。该移动被拒绝。\n- $a_{3} = 0$。\n\n综合三个提议的决策，我们得到接受向量 $(a_{1}, a_{2}, a_{3}) = (1, 1, 0)$。\n最终答案以行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}