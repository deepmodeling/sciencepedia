## 引言
区域供[热管](@entry_id:149315)网作为现代城市能源基础设施的关键组成部分，其高效、可靠和经济的运行对实现能源可持续性至关重要。要实现这一目标，核心在于建立能够精确描述其复杂热-水力动态行为的数学模型。然而，从基本的物理定律到能够指导实际运行的复杂系统模型，再到其在未来综合能源体系中的作用，这中间存在着一条需要系统性梳理的知识路径。本文旨在填补这一空白，为读者提供一个从理论基础到高级应用的全面建模框架。

在接下来的内容中，我们将分三步深入探索这一领域。首先，在“原理与机制”一章中，我们将奠定理论基石，系统阐述支配管网行为的物理守恒定律，并为管道、水泵等核心组件建立精确的数学模型，最终将它们整合成一个统一的微分代数方程（DAE）系统。随后，在“应用与跨学科交叉”一章中，我们将展示这些模型在[网络设计](@entry_id:267673)、运行优化、故障诊断以及与[电力](@entry_id:264587)系统进行部门耦合等前沿领域的强大应用价值。最后，“动手实践”部分将通过具体的计算练习，帮助您将理论知识转化为解决实际问题的能力。

## 原理与机制

本章旨在系统地阐述区域供[热管](@entry_id:149315)网建模所依据的基本物理原理、关键部件的数学模型及其在系统层面的整合方法。我们将从[流体动力](@entry_id:750449)学和传热学的基本守恒定律出发，逐步建立描述管网行为的方程组，并探讨支撑这些模型的关键假设。随后，我们将详细剖析构成管网的各个核心组件——包括管道、水泵、阀门和节点——的数学表达。最后，我们将这些独立的模型整合为一个统一的微分代数方程（DAE）系统，并讨论求解此类系统时所面临的挑战与常用策略。

### 基本物理原理与建模假设

对复杂的物理系统进行[数学建模](@entry_id:262517)，首要任务是确立其所遵循的基本物理定律，并引入一系列合理的简化假设。对于区域供热管网，其核心是流体（通常是水）在封闭回路中的质量、动量和能量输运。

#### [质量守恒](@entry_id:204015)

[质量守恒](@entry_id:204015)是所有流体[系统建模](@entry_id:197208)的基石。对于管网中的一段管道，我们可以通过分析一个微小的控制体来推导其一维[连续性方程](@entry_id:195013)。考虑一段长度为 $\mathrm{d}x$ 的管道，其[截面](@entry_id:154995)积为 $A(x)$，流体密度为 $\rho(x,t)$，[截面](@entry_id:154995)平均轴向速度为 $u(x,t)$。单位长度的质量源项 $s_m(x,t)$（单位：$\mathrm{kg \cdot m^{-1} \cdot s^{-1}}$）可用于表示管道沿线的泄漏或连续取水。对该微元段应用质量守恒定律——即控制体内质量的变化率等于净流入质量率加上内部[质量生成](@entry_id:161427)率——可得到通用的一维连续性方程 ：

$$ \frac{\partial(\rho A)}{\partial t} + \frac{\partial(\rho u A)}{\partial x} = s_m(x,t) $$

其中，$\rho u A$ 是质量流量。在区域供热管网建模中，通常引入几个关键假设来简化此方程。首先，假设管道是**刚性的**，即其[截面](@entry_id:154995)积 $A$ 不随时间变化（$\partial A / \partial t = 0$）。其次，假设管段自身没有泄漏或分布式取水点，即 $s_m = 0$。最后，也是最重要的假设是，流体被视为**不可压缩的**，即密度 $\rho$ 是一个常数。在这些假设下，连续性方程显著简化：

$$ \rho \frac{\partial(u A)}{\partial x} = 0 $$

由于体积流量定义为 $q(x,t) = u(x,t) A(x)$，且密度 $\rho$ 非零，我们得到一个极为重要的结论：

$$ \frac{\partial q}{\partial x} = 0 $$

此结果表明，在任何时刻 $t$，沿着一段无泄漏的管道，体积流量 $q$ 都是恒定的。这意味着流量的变化会瞬时地从管道一端传递到另一端。值得注意的是，这并不意味着流量是[稳态](@entry_id:139253)的；$q$ 本身仍然可以是时间的函数，$q(t)$，用以描述系统启动、关闭或需求变化等动态过程。该简化是构建大规模管网代数水力方程的基础 。

“不可压缩流体”的假设本身值得进一步审视。水的密度确实会随温度变化。在区域供[热网络](@entry_id:150016)中，供水和回水温差可达数十开尔文。例如，在一个典型的工况下，供水温度可能为 $100^{\circ}\mathrm{C}$，而回水温度为 $60^{\circ}\mathrm{C}$。我们可以利用等压体积[热膨胀系数](@entry_id:150685) $\alpha = -\frac{1}{\rho}(\frac{\partial \rho}{\partial T})_p$ 来量化这种密度变化。对于水，在此温度范围内 $\alpha \approx 3.0 \times 10^{-4} \, \mathrm{K^{-1}}$。通过计算可以发现，即使存在 $40 \, \mathrm{K}$ 的温差，使用参考温度下的恒定密度所导致的节点质量平衡计算的[相对误差](@entry_id:147538)也仅为约 $1.2\%$ 。这个微小的误差雄辩地证明，在大多数区域供[热管](@entry_id:149315)网的水力计算中，将水视为[不可压缩流体](@entry_id:181066)是一个非常精确且极具价值的简化。

#### 能量守恒

能量守恒定律，即热力学第一定律，支配着管网中的热量输运。与质量守恒类似，我们通过分析管道微元段的能量平衡来推导其一维温度场[演化方程](@entry_id:268137)。考虑一段长度为 $\mathrm{d}x$ 的管道，流体以[平均速度](@entry_id:267649) $v$（对于不可压缩流体，这对应于恒定的[体积流量](@entry_id:265771) $q$）流动。管道通过[总传热系数](@entry_id:151629) $U$ 与温度为 $T_g$ 的周围环境（如土壤）进行热交换。管道的内部[湿周](@entry_id:268581)长为 $P$，[截面](@entry_id:154995)积为 $A$。

对该微元段的能量平衡分析表明，其内部能量的时间变化（$\frac{\partial T}{\partial t}$）等于由流体整体运动带来的净能量流入（即**平流**，$v \frac{\partial T}{\partial x}$）与通过管壁散失到环境的热量之和。假设流体性质（密度 $\rho$、比热容 $c_p$）恒定，且忽略轴向[热传导](@entry_id:143509)，可以得到如下的一维平流-热损失方程 ：

$$ \frac{\partial T}{\partial t} + v \frac{\partial T}{\partial x} = -\frac{U P}{\rho c_p A} (T - T_g) $$

该方程是描述管道动态热行为的核心。方程左侧是温度的**[物质导数](@entry_id:262900)**，代表了跟随一个流体微团所观察到的温度变化率。右侧是热损失项，当流体温度 $T$ 高于环境温度 $T_g$ 时，该项为负，导致温度下降。其中，系数 $\frac{U P}{\rho c_p A}$ 的量纲为时间分之一（$\mathrm{s^{-1}}$），确保了方程量纲的统一性 。

在此推导中，我们忽略了流体内部沿轴向的[热传导](@entry_id:143509)。这一简化被称为**理想平推流（plug-flow）**假设。其合理性可以通过比较轴向平流输运与轴向[热传导](@entry_id:143509)输运的相对重要性来评估。这个比值由一个[无量纲数](@entry_id:260863)——**[Péclet数](@entry_id:141791)（$Pe$）**来量化，其定义为 ：

$$ Pe = \frac{\text{平流输运率}}{\text{扩散输运率}} = \frac{v D_h}{\alpha} $$

其中，$v$ 是特征流速，$D_h$ 是[水力直径](@entry_id:152291)（对于圆形管道，$D_h$ 等于其内径），$\alpha = k / (\rho c_p)$ 是流体的[热扩散](@entry_id:148740)系数。在典型的区域供[热管](@entry_id:149315)网工况下，例如，对于内径为 $0.3 \, \mathrm{m}$、流速为 $1.2 \, \mathrm{m/s}$ 的管道，其[Péclet数](@entry_id:141791)可高达 $2 \times 10^6$ 量级 。如此巨大的Péclet数意味着热量沿轴向的输运几乎完全由平流主导，而分子[热传导](@entry_id:143509)的贡献可以忽略不计。这为在管网[热力学](@entry_id:172368)模型中普遍采用理想[平推流假设](@entry_id:1129834)提供了坚实的物理基础。

### 水力组件模型

基于上述基本原理，我们现在可以为管网中的各个水力组件构建数学模型。这些模型共同决定了管网中的[流量分布](@entry_id:261008)和[压力损失](@entry_id:199916)。

#### [管道摩擦](@entry_id:275780)与[压降](@entry_id:199916)

当流体在管道中流动时，由于粘性效应和与管壁的相互作用，会产生[摩擦阻力](@entry_id:270342)，导致[压力下降](@entry_id:151380)。这种[压降](@entry_id:199916) $\Delta p$ 通常使用**达西-魏斯巴赫（Darcy-Weisbach）方程**进行计算：

$$ \Delta p = f \frac{L}{D} \frac{\rho u_m^2}{2} $$

其中，$L$ 和 $D$ 分别是管道的长度和内径，$u_m$ 是平均流速，$\rho$ 是流体密度，$f$ 是无量纲的**[达西-魏斯巴赫摩擦系数](@entry_id:150923)**。该系数 $f$ 的值取决于流动的状态，由**雷诺数（Reynolds number, $\mathrm{Re}$）** $\mathrm{Re} = \frac{\rho u_m D}{\mu}$（$\mu$ 为[流体动力](@entry_id:750449)粘度）决定。

在**层流**状态下（通常 $\mathrm{Re}  2300$），摩擦系数可以通过求解[稳态](@entry_id:139253)、不可压缩的[Navier-Stokes](@entry_id:276387)方程得到精确的解析解。对于圆形管道，这个解（即[Hagen-Poiseuille流](@entry_id:262438)）给出的[摩擦系数](@entry_id:150354)为 ：

$$ f = \frac{64}{\mathrm{Re}} $$

然而，在区域供热主管网中，由于流速较高、管径较大，流动通常处于**[湍流](@entry_id:151300)**状态。在[湍流](@entry_id:151300)中，[摩擦系数](@entry_id:150354)不仅依赖于雷诺数，还受到管壁**[相对粗糙度](@entry_id:264325)** $\varepsilon/D$（$\varepsilon$ 为管壁的[绝对粗糙度](@entry_id:260619)）的显著影响。描述[湍流摩擦](@entry_id:266536)系数的最广泛接受和使用的模型是经验性的**[Colebrook-White方程](@entry_id:271265)**：

$$ \frac{1}{\sqrt{f}} = -2.0 \log_{10} \left( \frac{\varepsilon/D}{3.7} + \frac{2.51}{\mathrm{Re}\sqrt{f}} \right) $$

此方程具有几个重要特征：首先，它是**隐式的**，因为 $f$ 出现在方程的两边，需要迭代求解。其次，它巧妙地混合了一个依赖于粗糙度的项和一个依赖于雷诺数的粘性项，从而能够准确地覆盖从“水力光滑”到“完全粗糙”的整个[湍流](@entry_id:151300)区域。在雷诺数非常高时，粘性项可以忽略，方程简化为仅依赖于[相对粗糙度](@entry_id:264325)的形式，这被称为“完全粗糙区”的[渐近行为](@entry_id:160836)。这是大多数商用管网仿真软件计算[压降](@entry_id:199916)的标准方法 。

#### 水泵

水泵是驱动管网中[水循环](@entry_id:144834)的“心脏”。它通过向流体做功来提升其[机械能](@entry_id:162989)，通常表现为提供一个[压头](@entry_id:141368)（head）。对于一台在恒定转速下运行的[离心泵](@entry_id:264566)，其提供的[压头](@entry_id:141368) $H$ 是流量 $q$ 的函数，这种关系被称为泵的[特性曲线](@entry_id:918058)。

从物理原理出发，泵的理想[压头](@entry_id:141368)可以通过**欧拉透平方程（Euler turbomachine equation）**推导，它与叶轮的几何形状和转速有关，通常可以近似为一个随流量线性下降的函数。然而，流体在泵[内部流动](@entry_id:155636)时会经历水力损失（如摩擦、分离等），这些损失通常与流量的平方成正比。因此，泵的实际输出[压头](@entry_id:141368) $H(q)$ 可以表示为理想[压头](@entry_id:141368)减去损失[压头](@entry_id:141368)，其结果通常可以很好地用一个二次多项式来近似 ：

$$ H(q) = H_0 - a q^2 $$

在这个常用的简化模型中，各项具有明确的物理意义：
*   **$H_0$**：这是当流量 $q=0$ 时的[压头](@entry_id:141368)，被称为**关断[压头](@entry_id:141368)（shutoff head）**。它代表了水泵在出口完全关闭时能产生的最大[压头](@entry_id:141368)，其值主要由叶轮的叶尖速度（即转速和直径）决定。
*   **$a$**：这是一个正系数，代表了泵内部的综合水力损失。随着流量 $q$ 的增加，损失项 $a q^2$ 迅速增大，导致输出[压头](@entry_id:141368)下降。该系数的单位为 $\mathrm{s^2/m^5}$（当[压头](@entry_id:141368)单位为米，流量单位为 $\mathrm{m^3/s}$ 时），并且在以“米水柱”为单位的[压头](@entry_id:141368)表示法中，它不依赖于流体密度 。

例如，通过实验测得某水泵在 $q=0$ 时[压头](@entry_id:141368)为 $32 \, \mathrm{m}$，在 $q=0.04 \, \mathrm{m^3/s}$ 时[压头](@entry_id:141368)为 $30 \, \mathrm{m}$，我们可以确定 $H_0 = 32 \, \mathrm{m}$ 和 $a = \frac{32 - 30}{0.04^2} = 1250 \, \mathrm{s^2/m^5}$。

#### 阀门与管件

阀门、弯头、三通等管件在管网中用于控制流量和连接管道，它们会造成局部的[压力损失](@entry_id:199916)，通常称为“小损失（minor losses）”。与管道的分布式[摩擦损失](@entry_id:272644)不同，这些损失集中发生在管件自身很小的空间范围内。

对一个阀门应用带有[局部损失](@entry_id:264259)项的[扩展伯努利方程](@entry_id:196849)（[机械能守恒](@entry_id:175656)），可以推导出流量 $q$ 与其两端[压降](@entry_id:199916) $\Delta p$ 之间的关系。假设阀门上游和下游的管道直径相同，且高程变化可忽略，则[压降](@entry_id:199916)完全由阀门内部的[能量耗散](@entry_id:147406)造成。这个能量损失（以[压头](@entry_id:141368)表示）通常被建模为与流体动能成正比，即 $h_L = K \frac{v^2}{2g}$，其中 $K$ 是无量纲的阀门[损失系数](@entry_id:276929)，取决于阀门的类型和开度。

通过一系列推导，我们可以得到一个非常实用的关系式 ：

$$ q = C_v \sqrt{\frac{\Delta p}{\rho}} $$

这里，我们定义了一个在[国际单位制](@entry_id:172547)（SI）下的**阀门[流量系数](@entry_id:276642) $C_v$**。它综合了管道[截面](@entry_id:154995)积 $A$ 和阀门[损失系数](@entry_id:276929) $K$ 的影响（$C_v = A \sqrt{2/K}$）。这个 $C_v$ 的单位是面积（$\mathrm{m^2}$），其物理意义可以理解为一个**有效流通面积**：即一个理想的、无摩擦的孔口，在相同的[压降](@entry_id:199916) $\Delta p$ 下能通过相同流量 $q$ 时所具有的[截面](@entry_id:154995)积。

该公式在区域供热[网络建模](@entry_id:262656)中非常有用，但其应用有一定限制。它假设流动是充分发展的[湍流](@entry_id:151300)，且为单相[不可压缩流](@entry_id:140301)。当阀门[内压](@entry_id:153696)力降低到水的饱和蒸汽压以下时，会发生**汽蚀（cavitation）**现象，水会沸腾形成蒸汽泡。此时，流动变为两相流，流量可能达到一个上限而不再随[压降](@entry_id:199916)增加，即发生“壅塞（choked flow）”，上述简单公式将失效 。

### 热力组件与系统模型

在建立了水力模型之后，我们转向[热力学](@entry_id:172368)方面，将能量守恒原理应用于网络节点和整个系统。

#### 节点混合与分离

管网是由管道通过节点连接而成的。在这些节点处，来自不同管道的水流会发生混合或分离。对一个有多个入口和一个出口的**混合节点**（例如，多条回水管[汇合](@entry_id:148680)处），我们可以建立[稳态](@entry_id:139253)质量和[能量平衡方程](@entry_id:191484)。

假设节点是绝热的，内部混合是瞬时且完美的（即出口流体性质均匀），并且流体的动能和势能变化可以忽略。根据质量守恒，所有入口的质量流量之和必须等于出口的[质量流](@entry_id:143424)量。根据能量守恒，所有入口流体携带的焓（enthalpy）的总速率必须等于出口流体携带的焓的速率。这可以写成 ：

$$ \sum_i \dot{m}_i = \dot{m}_o \quad \implies \quad \sum_i \rho_i q_i = \rho_o q_o $$
$$ \sum_i \dot{m}_i h_i = \dot{m}_o h_o \quad \implies \quad \sum_i \rho_i q_i h_i = \rho_o q_o h_o $$

其中，下标 $i$ 代表各个入口，下标 $o$ 代表出口，$\dot{m}$ 是质量流量， $q$ 是[体积流量](@entry_id:265771)，$\rho$ 是密度，$h$ 是比焓。这些方程是连接管网中不同管道[热力学状态](@entry_id:755916)的“胶水”。

对于**分离节点**（一个入口，多个出口），情况更简单。[质量守恒](@entry_id:204015)要求入口流量等于所有出口流量之和。能量守恒方面，由于没有混合过程，所有出口流体的温度（以及比焓）都与入口流体的温度相同。

#### 系统级建模：[微分代数方程](@entry_id:748394)（DAE）方法

将上述所有组件模型——管道（摩擦和热输运）、水泵、阀门和节点（质量和能量平衡）——组合在一起，就形成了一个完整的管网模型。从数学角度看，这种模型天然地构成一个**[微分代数方程](@entry_id:748394)（Differential-Algebraic Equation, DAE）**系统 。

[DAE系统](@entry_id:1123360)由两[类方程](@entry_id:144428)组成：
1.  **[代数方程](@entry_id:272665)（Algebraic Equations）**：这些方程不包含时间导数项，描述了系统在任何时刻都必须满足的约束。在区域供热管网模型中，水力方程通常是代数的。这是因为流体中的压力波[传播速度](@entry_id:189384)非常快（音速），使得水力系统能够几乎瞬时地响应变化。因此，我们假设水力部分处于“准[稳态](@entry_id:139253)”。这些方程包括：
    *   所有节点的质量守恒方程（例如，$\sum q_{in} = \sum q_{out}$）。
    *   所有独立回路的压力[平衡方程](@entry_id:172166)（例如，$\sum \Delta p_{pump} = \sum \Delta p_{friction}$）。

2.  **[微分](@entry_id:158422)方程（Differential Equations）**：这些方程包含时间导数项，描述了系统状态随时间的演化。在区域供[热管](@entry_id:149315)网中，热量输运的速度（即流体流速）远低于[压力波的传播](@entry_id:275978)速度，因此热力学过程具有显著的动态特性。描述管道温度演化的一维平流-[热损失](@entry_id:165814)方程就是典型的[微分](@entry_id:158422)方程。

因此，一个典型的[DAE模型](@entry_id:1123358)会将管网的**状态变量**（如各管道段的出口温度）的动态演化（[微分](@entry_id:158422)方程）与**代数变量**（如所有管道的流量和所有节点的压力）必须满足的瞬时约束（[代数方程](@entry_id:272665)）耦合在一起 。例如，在一个简单的单回路系统中，状态变量可以是供水管和回水管的出口温度 $[T_s(t), T_r(t)]^\top$，而代数变量可以是整个回路的统一流量和用户侧的出口温度 $[q(t), T_c^{\mathrm{out}}(t)]^\top$。通过求解这个[DAE系统](@entry_id:1123360)，我们便可以模拟管网从一个工作状态到另一个状态的完整动态过程，或求解其[稳态](@entry_id:139253)工作点（即所有时间导数项为零时的解）。

### 数值求解方法与考量

求解描述整个区域供-热管网的庞大而复杂的[DAE系统](@entry_id:1123360)是一项计算挑战。一种常见且直观的策略是**顺序[解耦](@entry_id:160890)法（sequential decoupling）**。

#### 顺序[解耦](@entry_id:160890)法

该方法利用了水力动态和热力动态在时间尺度上的巨大差异。其基本思想是，在每个计算时间步内，将紧密耦合的热-水力问题分解为两个相继求解的子问题：
1.  **求解水力子系统**：首先，假设所有流体的温度（以及依赖于温度的[流体性质](@entry_id:200256)，如密度和粘度）是已知的（通常使用上一时间步或迭代步的结果）。在此基础上，整个管网的水力方程组（节点质量平衡和回路压[力平衡](@entry_id:267186)）变成一个独立的[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组。求解这个方程组，可以得到管网中所有管道的流量 $q$ 和所有节点的压力 $p$。
2.  **求解热力子系统**：然后，将上一步计算得到的流量 $q$ 视为已知和固定的参数。在此基础上，求解描述管道和节点温度演化的微分方程组（或在[稳态](@entry_id:139253)计算中，是[代数方程](@entry_id:272665)组）。这样就可以更新整个管网的温度分布。

这两个步骤交替进行，反复迭代，直到流量和温度的变化都收敛到设定的容差范围内。

#### 收敛性问题

虽然顺序[解耦](@entry_id:160890)法概念简单，易于实现，但它并非总是能稳定地收敛。收敛性问题通常源于热力状态与水力状态之间的双向强耦合。例如，当一个用户的热负荷需求 $Q_d$ 是固定的，其所需的水流量 $q$ 将直接取决于供水温度 $T_{in}$ 和它自身设定的回水温度 $T_{ret}$，即 $q = Q_d / (\rho c_p (T_{in} - T_{ret}))$。

在这种情况下，供水温度 $T_{in}$ 本身又受到上游管道[热损失](@entry_id:165814)的影响，而热损失又依赖于流量 $q$。这种“鸡生蛋，蛋生鸡”的循环关系可能导致数值迭代发散。我们可以通过一个固点迭代的[稳定性分析](@entry_id:144077)来研究这个问题。考虑上述的用户流量更新规则作为迭代函数 $q^{k+1} = f(q^k)$。要使迭代收敛，其导数的绝对值在不动点 $q^\star$ 处必须小于1，即 $|f'(q^\star)|  1$。

通过详细推导可以证明，这个[收敛条件](@entry_id:166121)可以表示为 ：

$$ \frac{h_\ell L}{\rho c_p q^\star} \frac{T_{\text{in}}(q^\star) - T_g}{T_{\text{in}}(q^\star) - T_{\text{ret}}}  1 $$

其中 $h_\ell$ 是管道单位长度的[传热系数](@entry_id:155200)，$L$ 是管道长度。这个条件揭示了深刻的物理含义：
*   **强烈的热耦合会破坏收敛**：较大的管道热损失（大的 $h_\ell L$）、较低的流速（小的 $q^\star$），以及用户侧较小的温差（小的 $T_{in} - T_{ret}$），都会使得左侧的值增大，增加迭代发散的风险。
*   **物理直觉**：当热损失对供水温度的影响非常敏感（低流速时），而流量又对供水温度非常敏感（用户温差小时），这种强烈的双向反馈就会在顺序[解耦](@entry_id:160890)的迭代过程中被放大，导致[数值振荡](@entry_id:163720)或发散。

理解这些原理对于设计稳定高效的管网仿真工具至关重要。在强耦合情况下，可能需要采用更复杂的整体求解法（monolithic approach）或改进的[解耦](@entry_id:160890)策略来保证收敛。