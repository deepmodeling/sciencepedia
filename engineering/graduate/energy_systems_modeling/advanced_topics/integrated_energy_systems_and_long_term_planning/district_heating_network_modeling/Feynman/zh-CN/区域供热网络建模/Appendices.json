{
    "hands_on_practices": [
        {
            "introduction": "在区域供热网络中，循环泵是驱动热水流动的核心部件，其性能的精确建模对于网络设计、运行优化和节能控制至关重要。本实践旨在连接理论与实际，指导您从量纲分析等第一性原理出发，推导离心泵的相似定律（或称比例定律）。通过运用这些定律，您将学会如何预测泵的扬程-流量（$H-q$）特性曲线如何随转速变化，这是实现变速泵高效控制策略的一项基本技能。",
            "id": "4086272",
            "problem": "一台离心泵在区域供热管网的供水总管中循环输送水。在不同运行工况下，该泵的叶轮几何相似，叶轮直径 $D$ 固定。流体为水，其热物理性质近似恒定，运行状态为完全湍流，因此可以作为一阶近似忽略粘性效应。从涡轮机械和量纲分析的基本原理（特别是欧拉涡轮机械方程和白金汉Pi定理）出发，推导并陈述相似（亲和）定律，该定律将几何相似的泵在动态相似点运行时，体积流量 $Q$、泵扬程 $H$ 和轴功率 $P$ 与转速 $n$ 和叶轮直径 $D$ 联系起来。然后，应用这些定律预测同一叶轮在新转速下的扬程-流量特性。\n\n在初始转速 $n_{1} = 1480$ 转/分钟（记为 $\\mathrm{r/min}$），叶轮直径恒定为 $D = 0.30$ 米时，测得的水泵特性为\n$$\nH_{n_{1}}(q) = 32 - 8000\\,q^{2},\n$$\n其中 $H$ 是扬程，单位为米， $q$ 是体积流量，单位为 $\\mathrm{m^3/s}$。假设叶轮直径保持不变，且在不同转速下流动条件保持动态相似，使用您推导的亲和定律，得到在更高转速 $n_{2} = 1760$ $\\mathrm{r/min}$ 下的扬程-流量特性 $H_{n_{2}}(q)$ 的显式解析表达式。将最终的扬程-流量函数表示为扬程（单位：米）关于流量 $q$（单位：$\\mathrm{m^3/s}$）的函数。无需四舍五入；以精确形式给出表达式。",
            "solution": "该问题要求从基本原理推导泵的亲和定律，并随后应用这些定律来确定一台在不同转速下运行的离心泵的新扬程-流量特性曲线。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件：**\n- 泵类型：离心泵，叶轮几何相似。\n- 叶轮直径：$D$，恒定。\n- 流体：水，热物理性质恒定。\n- 流动状态：完全湍流，忽略粘性效应。\n- 推导基础：欧拉涡轮机械方程和白金汉Pi定理。\n- 需要关联的变量：体积流量 $Q$、泵扬程 $H$、轴功率 $P$、转速 $n$、叶轮直径 $D$。\n- 初始条件：在转速 $n_{1} = 1480 \\, \\mathrm{r/min}$ 时，扬程-流量特性为 $H_{n_{1}}(q) = 32 - 8000\\,q^{2}$，其中 $H$ 的单位是米， $q$ 的单位是 $\\mathrm{m^3/s}$。直径为 $D = 0.30 \\, \\mathrm{m}$。\n- 目标条件：确定在新的转速 $n_{2} = 1760 \\, \\mathrm{r/min}$ 下的扬程-流量特性 $H_{n_{2}}(q)$，假设叶轮直径保持不变且流动是动态相似的。\n\n**1.2. 验证：**\n- **科学依据**：该问题基于流体力学和涡轮机械的基本且公认的原理，特别是量纲分析（白金汉Pi定理）和泵的性能换算（亲和定律）。欧拉涡轮机械方程是该领域的基石。所有概念都是科学合理的。\n- **适定性**：该问题是适定的。它提供了一个明确的目标、所有必要的数据（$n_1$、$n_2$ 和泵曲线的初始函数形式），以及一个关键条件（动态相似性），从而能够得到唯一解。\n- **客观性**：该问题以精确、定量和客观的术语陈述，没有歧义或主观论断。\n\n**1.3. 结论：**\n该问题有效。它是能源系统和流体机械领域一个标准且表述良好的问题。\n\n### 步骤2：亲和定律的推导\n\n亲和定律描述了在动态相似条件下，泵的性能变量（$Q, H, P$）与运行参数（$n, D$）之间的关系。动态相似性意味着流动模式几何相似，因此控制流动的无量纲数组保持不变。我们将使用白金汉Pi定理进行量纲分析。\n\n相关的物理量是：\n- 体积流量 $Q$ [量纲: $L^{3}T^{-1}$]\n- 扬程 $H$ [量纲: $L$]。更基本的是处理单位质量流体所获得的能量 $gH$，其中 $g$ 是重力加速度。$gH$ 的量纲是 $(LT^{-2})(L) = L^{2}T^{-2}$。\n- 轴功率 $P$ [量纲: $ML^{2}T^{-3}$]\n- 转速 $n$ [量纲: $T^{-1}$]\n- 叶轮直径 $D$ [量纲: $L$]\n- 流体密度 $\\rho$ [量纲: $ML^{-3}$]\n\n问题陈述中要求忽略粘性效应，因此不包括流体粘度 $\\mu$。我们有 $6$ 个变量和 $3$ 个基本量纲（质量 $M$、长度 $L$、时间 $T$）。根据白金汉Pi定理，将有 $6 - 3 = 3$ 个独立的无量纲数组（Pi数）。\n\n我们选择 $\\rho$、$n$ 和 $D$ 作为重复变量，因为它们包含了所有基本量纲。\n\n**流量的Pi数（$\\Pi_Q$）：**\n我们寻求一个包含 $Q$ 的无量纲数组。\n$$ \\Pi_Q = Q^{1} \\rho^{a} n^{b} D^{c} $$\n用量纲表示：\n$$ [\\Pi_Q] = (L^{3}T^{-1})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\n对每个量纲的指数进行求解：\n- $M: a = 0$\n- $T: -1 - b = 0 \\implies b = -1$\n- $L: 3 - 3a + c = 0 \\implies 3 - 0 + c = 0 \\implies c = -3$\n因此，流量系数为 $\\Pi_Q = \\frac{Q}{n D^{3}}$。\n\n**扬程的Pi数（$\\Pi_H$）：**\n我们寻求一个包含 $gH$ 的无量纲数组。\n$$ \\Pi_H = (gH)^{1} \\rho^{a} n^{b} D^{c} $$\n用量纲表示：\n$$ [\\Pi_H] = (L^{2}T^{-2})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\n对指数进行求解：\n- $M: a = 0$\n- $T: -2 - b = 0 \\implies b = -2$\n- $L: 2 - 3a + c = 0 \\implies 2 - 0 + c = 0 \\implies c = -2$\n因此，扬程系数为 $\\Pi_H = \\frac{gH}{n^{2}D^{2}}$。由于 $g$ 是常数，我们可以定义一个实用的扬程系数为 $\\frac{H}{n^{2}D^{2}}$。\n\n**功率的Pi数（$\\Pi_P$）：**\n我们寻求一个包含 $P$ 的无量纲数组。\n$$ \\Pi_P = P^{1} \\rho^{a} n^{b} D^{c} $$\n用量纲表示：\n$$ [\\Pi_P] = (ML^{2}T^{-3})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\n对指数进行求解：\n- $M: 1 + a = 0 \\implies a = -1$\n- $T: -3 - b = 0 \\implies b = -3$\n- $L: 2 - 3a + c = 0 \\implies 2 - 3(-1) + c = 0 \\implies 5 + c = 0 \\implies c = -5$\n因此，功率系数为 $\\Pi_P = \\frac{P}{\\rho n^{3}D^{5}}$。\n\n对于两个动态相似的工况点（1）和（2），这些无量纲数组必须相等。\n$$ \\frac{Q_1}{n_1 D_1^3} = \\frac{Q_2}{n_2 D_2^3} $$\n$$ \\frac{H_1}{n_1^2 D_1^2} = \\frac{H_2}{n_2^2 D_2^2} $$\n$$ \\frac{P_1}{\\rho_1 n_1^3 D_1^5} = \\frac{P_2}{\\rho_2 n_2^3 D_2^5} $$\n这些等式得出了通用的亲和定律：\n1.  **流量：** $\\frac{Q_2}{Q_1} = \\left(\\frac{n_2}{n_1}\\right) \\left(\\frac{D_2}{D_1}\\right)^3$\n2.  **扬程：** $\\frac{H_2}{H_1} = \\left(\\frac{n_2}{n_1}\\right)^2 \\left(\\frac{D_2}{D_1}\\right)^2$\n3.  **功率：** $\\frac{P_2}{P_1} = \\left(\\frac{\\rho_2}{\\rho_1}\\right) \\left(\\frac{n_2}{n_1}\\right)^3 \\left(\\frac{D_2}{D_1}\\right)^5$\n\n这些结果可以从欧拉涡轮机械方程中得到验证，该方程指出理想扬程与叶轮尖端速度的平方成正比（$U \\propto nD$）。因此，$H \\propto (nD)^2$。流量是速度分量（$v \\propto nD$）和流动面积（$A \\propto D^2$）的乘积，所以 $Q \\propto nD^3$。功率与 $\\rho Q H$ 成正比，所以 $P \\propto \\rho (nD^3)(nD)^2 = \\rho n^3 D^5$。\n\n在本问题中，叶轮直径 $D$ 是固定的（$D_1=D_2$），流体是性质恒定的水（$\\rho_1 = \\rho_2$）。亲和定律简化为：\n1.  $\\frac{Q_2}{Q_1} = \\frac{n_2}{n_1}$\n2.  $\\frac{H_2}{H_1} = \\left(\\frac{n_2}{n_1}\\right)^2$\n3.  $\\frac{P_2}{P_1} = \\left(\\frac{n_2}{n_1}\\right)^3$\n\n### 步骤3：应用于泵特性曲线\n\n给定转速为 $n_1$ 时的初始泵特性：\n$$ H_1 = H_{n_1}(q_1) = 32 - 8000 q_1^{2} $$\n这里，$(q_1, H_1)$ 表示在转速 $n_1$ 下特性曲线上的任意一点。\n\n我们想要找到转速为 $n_2$ 时的新特性 $H_2 = H_{n_2}(q_2)$。对于第一条曲线上的任意一点 $(q_1, H_1)$，在第二条曲线上都有一个与之对应的动态相似点 $(q_2, H_2)$，它们通过亲和定律相关联。\n\n根据恒定直径下的亲和定律：\n$$ q_2 = q_1 \\left(\\frac{n_2}{n_1}\\right) \\implies q_1 = q_2 \\left(\\frac{n_1}{n_2}\\right) $$\n$$ H_2 = H_1 \\left(\\frac{n_2}{n_1}\\right)^2 $$\n\n我们可以通过代入法将 $H_2$ 表示为 $q_2$ 的函数。首先，将初始特性代入 $H_2$ 的方程中：\n$$ H_2 = \\left( 32 - 8000 q_1^{2} \\right) \\left(\\frac{n_2}{n_1}\\right)^2 $$\n接下来，代入用 $q_2$ 表示的 $q_1$ 的表达式：\n$$ H_2 = \\left( 32 - 8000 \\left[q_2 \\left(\\frac{n_1}{n_2}\\right)\\right]^{2} \\right) \\left(\\frac{n_2}{n_1}\\right)^2 $$\n将因子 $\\left(\\frac{n_2}{n_1}\\right)^2$ 分配到括号内：\n$$ H_2 = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q_2^{2} \\left(\\frac{n_1}{n_2}\\right)^2 \\left(\\frac{n_2}{n_1}\\right)^2 $$\n第二项中的转速比相互抵消：\n$$ H_2 = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q_2^{2} $$\n该表达式给出了新扬程 $H_2$ 作为新流量 $q_2$ 的函数。我们可以将其写成新的特性函数 $H_{n_2}(q)$：\n$$ H_{n_2}(q) = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q^{2} $$\n\n现在，我们代入给定的转速数值：\n$n_1 = 1480 \\, \\mathrm{r/min}$\n$n_2 = 1760 \\, \\mathrm{r/min}$\n\n转速之比为：\n$$ \\frac{n_2}{n_1} = \\frac{1760}{1480} = \\frac{176}{148} = \\frac{44 \\times 4}{37 \\times 4} = \\frac{44}{37} $$\n该比值的平方为：\n$$ \\left(\\frac{n_2}{n_1}\\right)^2 = \\left(\\frac{44}{37}\\right)^2 = \\frac{44^2}{37^2} = \\frac{1936}{1369} $$\n现在我们计算新的关断扬程（常数项）：\n$$ 32 \\times \\frac{1936}{1369} = \\frac{61952}{1369} $$\n将此值代回 $H_{n_2}(q)$ 的函数中：\n$$ H_{n_2}(q) = \\frac{61952}{1369} - 8000 q^{2} $$\n这就是在新的转速 $n_2 = 1760 \\, \\mathrm{r/min}$ 下的扬程-流量特性的显式解析表达式，其中扬程 $H$ 的单位是米，流量 $q$ 的单位是 $\\mathrm{m^3/s}$。",
            "answer": "$$ \\boxed{\\frac{61952}{1369} - 8000 q^{2}} $$"
        },
        {
            "introduction": "在建立了泵的性能模型之后，我们需关注网络中输送的能量本身，精确的能量核算是模型准确性的基石。本实践将探讨一个看似细微但至关重要的物理细节：水的比热容$c_p$随温度$T$变化的特性。通过对比考虑$c_p(T)$变化的精确积分计算与采用定值$c_p$的近似计算，您将学会如何量化建模假设带来的误差，并深入理解模型简化与物理真实性之间的权衡。",
            "id": "4086240",
            "problem": "区域供热网络（DHN）利用液态水，在高温的供应节点和低温的返回节点之间输送热能。考虑一个在稳态下运行的单管段，其动能和势能的变化可忽略不计，且压力变化足够小，以至于液态水可被视为不可压缩流体。设供水温度为 $T_{\\mathrm{s}} = 363.15\\,\\mathrm{K}$，回水温度为 $T_{\\mathrm{r}} = 323.15\\,\\mathrm{K}$，因此水在该管段内冷却了 $40\\,\\mathrm{K}$。在温度区间 $[323.15\\,\\mathrm{K},\\,363.15\\,\\mathrm{K}]$ 内，假设随温度变化的定压比热容为\n$$\nc_{p}(T) = 4182 + 0.85\\,(T - 323.15)\\quad\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1},\n$$\n其中 $T$ 的单位为 $\\mathrm{K}$。\n\n从稳流能量输运的第一性原理和液体比焓 $h(T)$ 的定义出发，推导出该管段单位质量所释放的精确比热量，即 $c_{p}(T)$ 从 $T_{\\mathrm{r}}$ 到 $T_{\\mathrm{s}}$ 的积分。然后，通过计算定义如下的有符号相对误差，评估假设比热容为恒定值（等于其在 $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$ 时的值）对建模的影响。\n$$\n\\varepsilon = \\frac{q_{\\text{const}} - q_{\\text{exact}}}{q_{\\text{exact}}},\n$$\n其中 $q_{\\text{exact}}$ 是单位质量释放的精确比热量，而 $q_{\\text{const}}$ 是在整个 $40\\,\\mathrm{K}$ 温差区间内，将 $c_{p}$ 保持为 $c_{p}(T_{\\mathrm{ref}})$ 恒定值时得到的值。\n\n将 $\\varepsilon$ 的最终答案表示为无单位的小数。将最终答案四舍五入至四位有效数字。",
            "solution": "本题要求计算在区域供热网络管段的背景下，用水的比热容恒定值近似代替随温度变化的比热容所带来的相对误差。\n\n首先，我们建立热力学框架。适用于稳流开放系统的热力学第一定律，也称为稳流能量方程（SFEE），指出进入控制体积的净能量传递为零。对于流经系统的单位质量，该方程表示为：\n$$\nq - w = \\Delta h + \\Delta e_k + \\Delta e_p\n$$\n其中 $q$ 是单位质量传入系统的热量，$w$ 是单位质量系统对外做的功，$\\Delta h$ 是比焓的变化量，$\\Delta e_k$ 是比动能的变化量，$\\Delta e_p$ 是出口和入口之间比势能的变化量。\n\n题目对该管段指定了以下假设：\n- 稳态运行。\n- 动能变化可忽略不计（$\\Delta e_k \\approx 0$）。\n- 势能变化可忽略不计（$\\Delta e_p \\approx 0$）。\n- 不做功（$w=0$），因为管道是被动元件。\n\n在这些假设下，稳流能量方程简化为 $q = \\Delta h$。从水传递到环境的热量，我们称之为释放的比热量 $q_{\\text{delivered}}$，是传入水的热量的负值。因此，\n$$\nq_{\\text{delivered}} = -q = -\\Delta h = -(h_{\\text{out}} - h_{\\text{in}}) = h_{\\text{in}} - h_{\\text{out}}\n$$\n水以供水温度 $T_{\\mathrm{s}}$ 进入，以回水温度 $T_{\\mathrm{r}}$ 流出。因此，$h_{\\text{in}} = h(T_{\\mathrm{s}})$ 且 $h_{\\text{out}} = h(T_{\\mathrm{r}})$。释放的比热量为：\n$$\nq_{\\text{delivered}} = h(T_{\\mathrm{s}}) - h(T_{\\mathrm{r}})\n$$\n对于不可压缩液体，比焓的微分变化量 $dh$ 由 $dh = c_p(T) dT$ 给出，其中 $c_p(T)$ 是定压比热容，$T$ 是绝对温度。从状态 A 到状态 B 的比焓总变化量是此表达式的积分：\n$$\nh(T_B) - h(T_A) = \\int_{T_A}^{T_B} c_p(T) dT\n$$\n结合这些原理，单位质量释放的精确比热量 $q_{\\text{exact}}$ 可通过对 $c_p(T)$ 从回水温度 $T_{\\mathrm{r}}$ 积分到供水温度 $T_{\\mathrm{s}}$ 来求得：\n$$\nq_{\\text{exact}} = h(T_{\\mathrm{s}}) - h(T_{\\mathrm{r}}) = \\int_{T_{\\mathrm{r}}}^{T_{\\mathrm{s}}} c_p(T) dT\n$$\n题目给出的随温度变化的比热容为：\n$$\nc_p(T) = 4182 + 0.85(T - 323.15) \\quad [\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}]\n$$\n其中 $T_{\\mathrm{s}} = 363.15\\,\\mathrm{K}$ 且 $T_{\\mathrm{r}} = 323.15\\,\\mathrm{K}$。我们现在可以计算 $q_{\\text{exact}}$ 的积分：\n$$\nq_{\\text{exact}} = \\int_{323.15}^{363.15} \\left[ 4182 + 0.85(T - 323.15) \\right] dT\n$$\n为了简化积分，我们进行换元。令 $U = T - 323.15$，则 $dU = dT$。积分上下限变为：\n- 当 $T = 323.15\\,\\mathrm{K}$ 时，$U = 0\\,\\mathrm{K}$。\n- 当 $T = 363.15\\,\\mathrm{K}$ 时，$U = 40\\,\\mathrm{K}$。\n\n积分变为：\n$$\nq_{\\text{exact}} = \\int_{0}^{40} (4182 + 0.85 U) dU\n$$\n$$\nq_{\\text{exact}} = \\left[ 4182 U + 0.85 \\frac{U^2}{2} \\right]_{0}^{40}\n$$\n$$\nq_{\\text{exact}} = \\left( 4182 \\times 40 + \\frac{0.85}{2} \\times 40^2 \\right) - 0\n$$\n$$\nq_{\\text{exact}} = 167280 + 0.425 \\times 1600 = 167280 + 680 = 167960\\,\\text{J}\\,\\text{kg}^{-1}\n$$\n接下来，我们通过假设比热容 $c_p$ 为一恒定值（在参考温度 $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$ 下计算）来计算近似的释放比热量 $q_{\\text{const}}$。\n首先，我们求出这个恒定的比热容值 $c_{p, \\text{const}}$：\n$$\nc_{p, \\text{const}} = c_p(333.15) = 4182 + 0.85(333.15 - 323.15)\n$$\n$$\nc_{p, \\text{const}} = 4182 + 0.85(10) = 4182 + 8.5 = 4190.5\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}\n$$\n当比热容为恒定时，释放的热量就是 $q = c_p \\Delta T$：\n$$\nq_{\\text{const}} = c_{p, \\text{const}} \\times (T_{\\mathrm{s}} - T_{\\mathrm{r}})\n$$\n$$\nq_{\\text{const}} = 4190.5 \\times (363.15 - 323.15) = 4190.5 \\times 40 = 167620\\,\\text{J}\\,\\text{kg}^{-1}\n$$\n最后，我们使用给定的定义计算有符号相对误差 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{q_{\\text{const}} - q_{\\text{exact}}}{q_{\\text{exact}}}\n$$\n$$\n\\varepsilon = \\frac{167620 - 167960}{167960} = \\frac{-340}{167960}\n$$\n计算其数值：\n$$\n\\varepsilon \\approx -0.00202429149...\n$$\n题目要求答案四舍五入至四位有效数字。\n$$\n\\varepsilon \\approx -0.002024\n$$\n这个负误差表明，与考虑了温度依赖性的精确计算相比，使用在 $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$ 下计算的恒定比热容会导致对总释放热量的低估。",
            "answer": "$$\n\\boxed{-0.002024}\n$$"
        },
        {
            "introduction": "掌握了核心部件和流体热力学性质的建模方法后，我们终于可以处理区域供热网络中最核心的动态过程：热能在管网中的输运和衰减。本实践将引导您从描述温度传播的偏微分方程出发，亲手构建一个动态仿真模型。通过实现一个基于有限体积法的数值方案，您将体验到将抽象的物理守恒定律转化为具体计算机代码的全过程，这是现代能源系统分析不可或缺的一项核心能力。",
            "id": "4086279",
            "problem": "考虑区域供热管网中的一个单一平直管段，其横截面积恒定，流体为均匀不可压缩流。假设为一维平推流，流体性质恒定，且向周围环境的热损失通过 Newton 冷却定律建模。令 $x \\in [0,L]$ 表示沿管道的位置，$t \\ge 0$ 表示时间，$T(x,t)$ 为开尔文温标下的主体流体温度，$u$ 为恒定的轴向速度（单位：米/秒），$\\rho$ 为流体密度（单位：千克/立方米），$c$ 为比热容（单位：焦耳/千克·开尔文），$A$ 为管道横截面积（单位：平方米），$P$ 为管道湿周（单位：米），$h$ 为对流换热系数（单位：瓦/平方米·开尔文），$T_g$ 为环境地温（单位：开尔文）。基本的出发点是长度为 $\\mathrm{d}x$ 的微分控制体的能量守恒，并结合用于壁面热损失的 Newton 冷却定律。\n\n基于这些基础，通过将能量平衡方程除以 $\\rho c A$，可以将控制方程写成归一化形式，得到\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -\\alpha \\left(T - T_g\\right),\n$$\n其中 $\\alpha = \\frac{h P}{\\rho c A}$ 的单位为秒的倒数。\n\n您的任务是：\n1. 从能量守恒和 Newton 冷却定律出发，推导在均匀网格上的一阶迎风有限体积空间离散格式。该网格包含 $N$ 个宽度为 $\\Delta x = L/N$ 的控制体，单元中心索引为 $i = 0,1,\\dots,N-1$，单元面索引为 $i+\\tfrac{1}{2}$。使用时间步长为 $\\Delta t$ 的显式向前 Euler 时间积分法。根据 $u$ 的符号，谨慎地使用迎风选择来构建对流面通量，并包含体积损失项。\n2. 写出将单元平均温度 $T_i^n \\approx T(x_i, t^n)$ 从时间层 $n$推进到 $n+1$ 的最终离散更新律。\n3. 为以下测试套件实现单步更新（从 $t^n$ 推进到 $t^{n+1}=t^n+\\Delta t$）。在每种情况下，在域入口（如果 $u>0$ 则在 $x=0$ 处，如果 $u<0$ 则在 $x=L$ 处）使用适当的入口 Dirichlet 边界条件，并根据迎风规则对边界面通量进行建模。所有温度必须以开尔文为单位。所有速度必须以米/秒为单位。所有长度必须以米为单位。所有时间必须以秒为单位。损失系数必须以秒的倒数为单位。报告的答案需四舍五入至六位小数。\n\n定义均匀网格，其单元中心为 $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$，其中 $i=0,\\dots,N-1$。对于每种情况，按规定初始化 $T_i^n$，应用一个时间步长，并返回指定探针索引（从零开始）处的更新后温度。\n\n测试套件：\n- 情况 A（正常情况，正速度，中等损失）：$L = 100\\,\\mathrm{m}$，$N = 10$，$\\Delta t = 1\\,\\mathrm{s}$，$u = 0.5\\,\\mathrm{m/s}$，$\\alpha = 0.01\\,\\mathrm{s^{-1}}$，$T_g = 285\\,\\mathrm{K}$，$x=0$ 处的入口温度：$T_{\\mathrm{in}} = 350\\,\\mathrm{K}$。初始条件：对于所有 $i$，$T_i^n = 330\\,\\mathrm{K}$。探针索引：$i=3$。\n- 情况 B（零对流边界条件，纯损失）：$L = 50\\,\\mathrm{m}$，$N = 5$，$\\Delta t = 10\\,\\mathrm{s}$，$u = 0.0\\,\\mathrm{m/s}$，$\\alpha = 0.05\\,\\mathrm{s^{-1}}$，$T_g = 280\\,\\mathrm{K}$。由于 u=0，入口温度无关紧要。初始条件：对于所有 $i$，$T_i^n = 320\\,\\mathrm{K}$。探针索引：$i=2$。\n- 情况 C（边缘情况，负速度，右边界入口）：$L = 80\\,\\mathrm{m}$，$N = 8$，$\\Delta t = 2\\,\\mathrm{s}$，$u = -0.3\\,\\mathrm{m/s}$，$\\alpha = 0.02\\,\\mathrm{s^{-1}}$，$T_g = 285\\,\\mathrm{K}$，$x=L$ 处的入口温度：$T_{\\mathrm{R}} = 340\\,\\mathrm{K}$。初始条件：对于所有 $i$，$T_i^n = 330\\,\\mathrm{K}$。探针索引：$i=7$。\n- 情况 D（纯对流，零损失，非均匀初始剖面）：$L = 100\\,\\mathrm{m}$，$N = 10$，$\\Delta t = 5\\,\\mathrm{s}$，$u = 1.0\\,\\mathrm{m/s}$，$\\alpha = 0.0\\,\\mathrm{s^{-1}}$，$T_g$ 可为任意值（当 $\\alpha=0$ 时未使用），$x=0$ 处的入口温度：$T_{\\mathrm{in}} = 300\\,\\mathrm{K}$。初始条件：$T_i^n = 300 + s x_i\\,\\mathrm{K}$，斜率为 $s = 0.2\\,\\mathrm{K/m}$。探针索引：$i=1$。\n- 情况 E (Courant–Friedrichs–Lewy (CFL) 边界情况，满足 $\\Delta t = \\Delta x/|u|$): $L = 80\\,\\mathrm{m}$，$N = 4$，$\\Delta t = 5\\,\\mathrm{s}$，$u = 4.0\\,\\mathrm{m/s}$，$\\alpha = 0.01\\,\\mathrm{s^{-1}}$，$T_g = 290\\,\\mathrm{K}$，$x=0$ 处的入口温度：$T_{\\mathrm{in}} = 310\\,\\mathrm{K}$。初始条件：对于所有 $i$，$T_i^n = 305\\,\\mathrm{K}$。探针索引：$i=2$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_A,r_B,r_C,r_D,r_E]$），列表中的每个 $r_\\cdot$ 是对应情况下指定探针索引处的更新后温度，四舍五入到六位小数。",
            "solution": "用户提供的问题已经过分析，并被认为是有效的。该问题具有科学依据，是适定的、客观的，并包含获得唯一解所需的所有必要信息。我们现在开始推导和求解。\n\n该问题要求推导并应用一种一阶迎风有限体积法，并结合显式向前 Euler 时间积分，来求解控制管道温度的一维对流-反应方程：\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -\\alpha \\left(T - T_g\\right) \\quad \\text{for } x \\in [0,L], t \\ge 0\n$$\n\n### 第 1 部分：有限体积离散化\n\n我们首先对一个有限控制体 (CV) 应用能量守恒原理。区域 $[0, L]$ 被划分为 $N$ 个均匀的控制体 $V_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$，其中 $i=0, \\dots, N-1$。每个控制体的宽度为 $\\Delta x = L/N$，中心位于 $x_i = (i+\\frac{1}{2})\\Delta x$。\n\n控制体 $V_i$ 内流体的能量平衡表明，热能的变化率等于净流入该控制体的对流能量率减去向周围环境的热损失率。\n\n1.  **能量变化率**：控制体中的热能为 $E_i = (\\rho A \\Delta x) c T_i$，其中 $T_i$ 是该控制体内的平均温度。其变化率为 $\\frac{\\mathrm{d}E_i}{\\mathrm{d}t} = \\rho c A \\Delta x \\frac{\\mathrm{d}T_i}{\\mathrm{d}t}$。\n\n2.  **净对流能量**：能量由流体流动携带。穿过一个面的能量对流率为 $\\dot{m} c T = (\\rho u A) c T$。进入控制体的净能量率是流入面 $i-\\frac{1}{2}$ 的通量减去流出面 $i+\\frac{1}{2}$ 的通量：\n    $$ \\dot{E}_{\\text{adv, net}} = (\\rho u A c T)_{i-\\frac{1}{2}} - (\\rho u A c T)_{i+\\frac{1}{2}} $$\n\n3.  **热损失**：热量通过对流损失到周围的地面，此过程遵循 Newton 冷却定律。与控制体对应的管段表面积（$P \\Delta x$）的热损失率为：\n    $$ \\dot{Q}_{\\text{loss}} = h (P \\Delta x) (T_i - T_g) $$\n\n能量平衡方程为：\n$$ \\rho c A \\Delta x \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = (\\rho u A c T)_{i-\\frac{1}{2}} - (\\rho u A c T)_{i+\\frac{1}{2}} - h P \\Delta x(T_i - T_g) $$\n\n将整个方程除以常数项 $\\rho c A \\Delta x$ 可得到单元平均温度 $T_i$ 的半离散方程：\n$$ \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = \\frac{u}{\\Delta x}(T_{i-\\frac{1}{2}} - T_{i+\\frac{1}{2}}) - \\frac{h P}{\\rho c A}(T_i - T_g) $$\n我们定义对流通量为 $F(T) = uT$，热损失系数为 $\\alpha = \\frac{hP}{\\rho c A}$。方程变为：\n$$ \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = -\\frac{1}{\\Delta x} \\left( F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\right) - \\alpha(T_i - T_g) $$\n其中 $F_{i\\pm\\frac{1}{2}}$ 是单元面上的通量。\n\n对于一阶迎风格式，单元面上的温度取自“迎风”侧（即水流来源方向）的单元中心值。\n\n-   如果 $u > 0$（水流从左向右）：\n    -   $T_{i+\\frac{1}{2}} = T_i$\n    -   $T_{i-\\frac{1}{2}} = T_{i-1}$\n-   如果 $u < 0$（水流从右向左）：\n    -   $T_{i+\\frac{1}{2}} = T_{i+1}$\n    -   $T_{i-\\frac{1}{2}} = T_i$\n-   如果 $u = 0$，两个通量都为零。\n\n### 第 2 部分：显式 Euler 时间积分和最终离散律\n\n我们使用显式向前 Euler 方法来离散化时间导数，$\\frac{\\mathrm{d}T_i}{\\mathrm{d}t} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$。右侧的所有项都在已知的时间层 $n$ 进行计算。\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = -\\frac{1}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) - \\alpha(T_i^n - T_g) $$\n对 $T_i^{n+1}$ 进行整理，得到通用的更新律：\n$$ T_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) - \\Delta t \\alpha(T_i^n - T_g) $$\n\n现在，我们根据 $u$ 的符号和边界条件写出具体形式。\n\n**情况 1：$u > 0$**（在 $x=0$ 处有入口，温度为 $T_{\\mathrm{in}}$）\n-   对于内部单元 $i \\in \\{1, \\dots, N-1\\}$：$F_{i+\\frac{1}{2}}^n = u T_i^n$ 且 $F_{i-\\frac{1}{2}}^n = u T_{i-1}^n$。\n    $$ T_i^{n+1} = T_i^n - \\frac{u \\Delta t}{\\Delta x} (T_i^n - T_{i-1}^n) - \\Delta t \\alpha (T_i^n - T_g) $$\n-   对于第一个单元 $i=0$：左侧面是域边界。$T_{-\\frac{1}{2}}$ 的迎风值是入口边界条件 $T_{\\mathrm{in}}$。因此，$F_{-\\frac{1}{2}}^n = u T_{\\mathrm{in}}$。右侧通量为 $F_{\\frac{1}{2}}^n = u T_0^n$。\n    $$ T_0^{n+1} = T_0^n - \\frac{u \\Delta t}{\\Delta x} (T_0^n - T_{\\mathrm{in}}) - \\Delta t \\alpha (T_0^n - T_g) $$\n\n**情况 2：$u < 0$**（在 $x=L$ 处有入口，温度为 $T_R$）\n-   对于内部单元 $i \\in \\{0, \\dots, N-2\\}$：$F_{i+\\frac{1}{2}}^n = u T_{i+1}^n$ 且 $F_{i-\\frac{1}{2}}^n = u T_i^n$。\n    $$ T_i^{n+1} = T_i^n - \\frac{u \\Delta t}{\\Delta x} (T_{i+1}^n - T_i^n) - \\Delta t \\alpha (T_i^n - T_g) $$\n-   对于最后一个单元 $i=N-1$：右侧面是域边界。$T_{N-\\frac{1}{2}}$ 的迎风值是入口边界条件 $T_R$。因此，$F_{N-\\frac{1}{2}}^n = u T_R$。左侧通量为 $F_{N-\\frac{3}{2}}^n = u T_{N-1}^n$。\n    $$ T_{N-1}^{n+1} = T_{N-1}^n - \\frac{u \\Delta t}{\\Delta x} (T_R - T_{N-1}^n) - \\Delta t \\alpha (T_{N-1}^n - T_g) $$\n\n**情况 3：$u = 0$**（纯热损失）\n-   对于所有单元 $i \\in \\{0, \\dots, N-1\\}$：对流通量为零。\n    $$ T_i^{n+1} = T_i^n - \\Delta t \\alpha (T_i^n - T_g) $$\n\n### 第 3 部分：应用于测试套件\n\n现在将这些离散方程应用于每个测试用例，进行单步时间推进。\n\n-   **情况 A：** $u=0.5 > 0$，探针 $i=3$。初始 $T_i^n$ 是均匀的。$\\Delta x = 100/10=10$。\n    $T_3^{n+1} = T_3^n - \\frac{0.5 \\cdot 1}{10}(T_3^n - T_2^n) - (1 \\cdot 0.01)(T_3^n - T_g) = 330 - 0.05(330-330) - 0.01(330-285) = 330 - 0.45 = 329.55$。\n\n-   **情况 B：** $u=0.0$，探针 $i=2$。\n    $T_2^{n+1} = T_2^n - (10 \\cdot 0.05)(T_2^n - T_g) = 320 - 0.5(320-280) = 320 - 20 = 300.0$。\n\n-   **情况 C：** $u=-0.3 < 0$，探针 $i=7$。$\\Delta x=80/8=10$。\n    $T_7^{n+1} = T_7^n - \\frac{-0.3 \\cdot 2}{10}(T_R - T_7^n) - (2 \\cdot 0.02)(T_7^n - T_g) = 330 + 0.06(340-330) - 0.04(330-285) = 330 + 0.6 - 1.8 = 328.8$。\n\n-   **情况 D：** $u=1.0 > 0$，$\\alpha=0.0$，探针 $i=1$。$\\Delta x = 10$。初始 $T_i^n = 300 + 0.2 x_i = 300 + 0.2(i+0.5)10 = 301 + 2i$。\n    $T_0^n = 301, T_1^n = 303$。\n    $T_1^{n+1} = T_1^n - \\frac{1.0 \\cdot 5}{10}(T_1^n - T_0^n) - 0 = 303 - 0.5(303-301) = 303 - 1 = 302.0$。\n\n-   **情况 E：** $u=4.0 > 0$，探针 $i=2$。初始 $T_i^n$ 是均匀的。Courant 数 $\\frac{|u|\\Delta t}{\\Delta x} = \\frac{4 \\cdot 5}{20}=1$。$\\Delta x=80/4=20$。\n    $T_2^{n+1} = T_2^n - \\frac{4.0 \\cdot 5}{20}(T_2^n - T_1^n) - (5 \\cdot 0.01)(T_2^n - T_g) = 305 - 1(305-305) - 0.05(305-290) = 305 - 0.75 = 304.25$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-reaction equation for temperature in a pipe using a\n    first-order upwind finite volume method with explicit Euler time integration.\n    \"\"\"\n    \n    # Structure of each test case:\n    # (L, N, dt, u, alpha, T_g, T_inflow, initial_T_spec, probe_index, s for case D)\n    test_cases = [\n        # Case A (happy path, positive velocity, moderate loss)\n        {'L': 100.0, 'N': 10, 'dt': 1.0, 'u': 0.5, 'alpha': 0.01, 'T_g': 285.0, 'T_inflow': 350.0, 'initial_T': 330.0, 'probe_idx': 3, 's': None},\n        # Case B (boundary condition with zero advection, pure loss)\n        {'L': 50.0, 'N': 5, 'dt': 10.0, 'u': 0.0, 'alpha': 0.05, 'T_g': 280.0, 'T_inflow': None, 'initial_T': 320.0, 'probe_idx': 2, 's': None},\n        # Case C (edge case, negative velocity, inflow at right boundary)\n        {'L': 80.0, 'N': 8, 'dt': 2.0, 'u': -0.3, 'alpha': 0.02, 'T_g': 285.0, 'T_inflow': 340.0, 'initial_T': 330.0, 'probe_idx': 7, 's': None},\n        # Case D (pure advection, zero loss, nonuniform initial profile)\n        {'L': 100.0, 'N': 10, 'dt': 5.0, 'u': 1.0, 'alpha': 0.0, 'T_g': 0.0, 'T_inflow': 300.0, 'initial_T': 300.0, 'probe_idx': 1, 's': 0.2},\n        # Case E (Courant–Friedrichs–Lewy (CFL) boundary case)\n        {'L': 80.0, 'N': 4, 'dt': 5.0, 'u': 4.0, 'alpha': 0.01, 'T_g': 290.0, 'T_inflow': 310.0, 'initial_T': 305.0, 'probe_idx': 2, 's': None},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L = case['L']\n        N = case['N']\n        dt = case['dt']\n        u = case['u']\n        alpha = case['alpha']\n        T_g = case['T_g']\n        T_inflow = case['T_inflow']\n        initial_T = case['initial_T']\n        probe_idx = case['probe_idx']\n        s = case['s']\n\n        # Calculate grid spacing\n        dx = L / N\n\n        # Initialize temperature array T^n\n        T_n = np.zeros(N)\n        if s is None:\n            # Uniform initial condition\n            T_n.fill(initial_T)\n        else:\n            # Non-uniform initial condition for Case D\n            x_centers = (np.arange(N) + 0.5) * dx\n            T_n = initial_T + s * x_centers\n            \n        # Array to store updated temperatures T^{n+1}\n        T_np1 = np.zeros(N)\n\n        # Loop through each control volume to calculate the new temperature\n        for i in range(N):\n            # Calculate advective fluxes at cell faces i-1/2 and i+1/2\n            # using the first-order upwind scheme\n            F_left, F_right = 0.0, 0.0\n            \n            if u > 0:\n                # Flow is from left to right\n                F_right = u * T_n[i]\n                if i == 0:\n                    F_left = u * T_inflow  # Dirichlet boundary at x=0\n                else:\n                    F_left = u * T_n[i-1]\n            elif u  0:\n                # Flow is from right to left\n                F_left = u * T_n[i]\n                if i == N - 1:\n                    F_right = u * T_inflow  # Dirichlet boundary at x=L\n                else:\n                    F_right = u * T_n[i+1]\n            # If u == 0, fluxes remain 0\n\n            # Spatial derivative of flux (advection term)\n            advection_divergence = (F_right - F_left) / dx\n            \n            # Heat loss (reaction term)\n            loss_term = alpha * (T_n[i] - T_g)\n            \n            # Apply forward Euler update\n            T_np1[i] = T_n[i] - dt * (advection_divergence + loss_term)\n\n        # Store the result at the probe index, formatted to 6 decimal places\n        result = T_np1[probe_idx]\n        results.append(f\"{result:.6f}\")\n\n    # Print the final list of results in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}