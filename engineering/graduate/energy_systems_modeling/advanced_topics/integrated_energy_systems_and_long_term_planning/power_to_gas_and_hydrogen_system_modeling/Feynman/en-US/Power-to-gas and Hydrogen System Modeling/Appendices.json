{
    "hands_on_practices": [
        {
            "introduction": "This practice delves into the core of a Power-to-Gas system by guiding you through the construction of a detailed electrochemical model for a PEM electrolyzer cell. By assembling the contributions from reversible potential, activation losses, ohmic resistance, and mass transport limitations, you will understand the key factors governing cell voltage and, consequently, electrolyzer efficiency. Mastering this component-level model  is a foundational skill for accurately simulating and designing hydrogen production systems.",
            "id": "4113184",
            "problem": "You are tasked with constructing and evaluating a physically consistent cell voltage model for a Proton Exchange Membrane (PEM) water electrolyzer. The model must combine reversible voltage, activation overpotential, ohmic overpotential with temperature-dependent membrane conductivity, and concentration overpotential. You must also quantify the local scaling of the cell voltage with respect to current density by computing the sensitivity of the voltage to the current density. All derived expressions must originate from first principles or well-tested foundational formulas.\n\nConsider the overall water electrolysis reaction written in the formation direction as $\\mathrm{H_2} + \\frac{1}{2}\\mathrm{O_2} \\rightarrow \\mathrm{H_2O}$. For modeling the electrolyzer (the reverse process), take the magnitude of the reversible voltage. Define the cell voltage $U$ as\n$$\nU(i,T) = U_{\\mathrm{rev}}(T,p_{\\mathrm{H}_2},p_{\\mathrm{O}_2}) + \\eta_{\\mathrm{act}}(i,T) + \\eta_{\\mathrm{ohm}}(i,T) + \\eta_{\\mathrm{conc}}(i,T),\n$$\nwhere $i$ is the current density in $\\mathrm{A/m^2}$ and $T$ is the temperature in $\\mathrm{K}$.\n\nUse the following fundamental base and modeling assumptions:\n\n- Gibbs free energy and reversible voltage:\n  - Let the standard enthalpy change of formation be $\\Delta H_f^0$ for liquid water and the standard entropy change of formation be $\\Delta S_f^0$. Approximate the temperature dependence of the reversible voltage magnitude for electrolysis by the decomposition Gibbs free energy,\n    $$\n    U_{\\mathrm{rev},0}(T) = \\frac{-\\Delta H_f^0 + T\\,\\Delta S_f^0}{nF},\n    $$\n    where $n$ is the number of electrons transferred per mole of hydrogen ($n=2$) and $F$ is the Faraday constant. Include the pressure correction via the Nernst equation using standard pressure $p_0$,\n    $$ \n    U_{\\mathrm{rev}}(T,p_{\\mathrm{H}_2},p_{\\mathrm{O}_2}) = U_{\\mathrm{rev},0}(T) + \\frac{RT}{2F}\\ln\\!\\left(\\frac{p_{\\mathrm{H}_2}}{p_0}\\left(\\frac{p_{\\mathrm{O}_2}}{p_0}\\right)^{1/2}\\right),\n    $$\n    with $R$ the universal gas constant and $p_{\\mathrm{H}_2}$, $p_{\\mathrm{O}_2}$ the product gas partial pressures.\n\n- Activation overpotential (Tafel approximation derived from the Butler-Volmer relation in the anodic branch):\n  $$\n  \\eta_{\\mathrm{act}}(i,T) = \\frac{RT}{\\alpha F}\\ln\\!\\left(\\frac{i}{i_0}\\right),\n  $$\n  where $i_0$ is an effective exchange current density and $\\alpha$ is a lumped apparent charge transfer coefficient. Assume operation in the regime $i > i_0$ so that the logarithm is well-defined and consistent with anodic branch operation.\n\n- Ohmic overpotential (Ohm’s law and Arrhenius temperature dependence for proton conductivity in the polymer electrolyte membrane):\n  $$\n  \\eta_{\\mathrm{ohm}}(i,T) = i\\,\\left(\\frac{t_{\\mathrm{mem}}}{\\sigma(T)} + R_s\\right),\n  $$\n  where $t_{\\mathrm{mem}}$ is the membrane thickness, $R_s$ is an area-specific residual resistance, and the membrane conductivity $\\sigma(T)$ follows an Arrhenius relation referenced at $T_{\\mathrm{ref}}$,\n  $$\n  \\sigma(T) = \\sigma_{\\mathrm{ref}}\\,\\exp\\!\\left(\\frac{E_a}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right),\n  $$\n  with $E_a$ the apparent activation energy for proton transport.\n\n- Concentration overpotential (mass-transport limitation in terms of a limiting current density $i_L$):\n  $$\n  \\eta_{\\mathrm{conc}}(i,T) = \\frac{RT}{nF}\\ln\\!\\left(\\frac{1}{1 - \\frac{i}{i_L}}\\right),\n  $$\n  valid for $0 < i < i_L$.\n\nQuantify the local scaling of $U$ with current density by computing the sensitivity $dU/di$ at the given operating point. Using the above models, derive\n$$\n\\frac{dU}{di} = \\frac{d\\eta_{\\mathrm{act}}}{di} + \\frac{d\\eta_{\\mathrm{ohm}}}{di} + \\frac{d\\eta_{\\mathrm{conc}}}{di},\n$$\nwith\n$$\n\\frac{d\\eta_{\\mathrm{act}}}{di} = \\frac{RT}{\\alpha F}\\frac{1}{i}, \\quad\n\\frac{d\\eta_{\\mathrm{ohm}}}{di} = \\frac{t_{\\mathrm{mem}}}{\\sigma(T)} + R_s, \\quad\n\\frac{d\\eta_{\\mathrm{conc}}}{di} = \\frac{RT}{nF}\\,\\frac{1}{i_L\\left(1 - \\frac{i}{i_L}\\right)}.\n$$\n\nConstants and units to be used:\n- Use $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$, $F = 96485.33212\\,\\mathrm{C/mol}$, $n = 2$, $p_0 = 10^5\\,\\mathrm{Pa}$.\n- Use $\\Delta H_f^0 = -285.83\\times 10^3\\,\\mathrm{J/mol}$ and $\\Delta S_f^0 = -163.2\\,\\mathrm{J/(mol\\cdot K)}$ for the formation of liquid water.\n- All temperatures must be in $\\mathrm{K}$, current densities in $\\mathrm{A/m^2}$, pressures in $\\mathrm{Pa}$, thicknesses in $\\mathrm{m}$, conductivities in $\\mathrm{S/m}$, resistances in $\\Omega\\cdot\\mathrm{m^2}$, activation energy in $\\mathrm{J/mol}$.\n- Express each final cell voltage $U$ in $\\mathrm{V}$ and each sensitivity $dU/di$ in $\\mathrm{V}\\cdot\\mathrm{m^2/A}$, both rounded to six decimal places.\n\nTest suite:\nProvide four test cases to evaluate different facets of the model. For each case, compute the pair $\\left[U,\\,\\frac{dU}{di}\\right]$.\n\n- Case $1$ (baseline, moderate current, pressurized products):\n  - $T = 333.15\\,\\mathrm{K}$, $i = 10^4\\,\\mathrm{A/m^2}$, $t_{\\mathrm{mem}} = 180\\times 10^{-6}\\,\\mathrm{m}$,\n  - $\\sigma_{\\mathrm{ref}} = 8\\,\\mathrm{S/m}$, $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$, $E_a = 1.2\\times 10^4\\,\\mathrm{J/mol}$,\n  - $R_s = 5\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m^2}$, $i_L = 2.0\\times 10^4\\,\\mathrm{A/m^2}$,\n  - $i_0 = 10^{-2}\\,\\mathrm{A/m^2}$, $\\alpha = 0.5$,\n  - $p_{\\mathrm{H}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$, $p_{\\mathrm{O}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n\n- Case $2$ (higher temperature reduces ohmic losses):\n  - $T = 353.15\\,\\mathrm{K}$, $i = 10^4\\,\\mathrm{A/m^2}$, $t_{\\mathrm{mem}} = 180\\times 10^{-6}\\,\\mathrm{m}$,\n  - $\\sigma_{\\mathrm{ref}} = 8\\,\\mathrm{S/m}$, $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$, $E_a = 1.2\\times 10^4\\,\\mathrm{J/mol}$,\n  - $R_s = 5\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m^2}$, $i_L = 2.0\\times 10^4\\,\\mathrm{A/m^2}$,\n  - $i_0 = 10^{-2}\\,\\mathrm{A/m^2}$, $\\alpha = 0.5$,\n  - $p_{\\mathrm{H}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$, $p_{\\mathrm{O}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n\n- Case $3$ (thinner membrane reduces area-specific resistance):\n  - $T = 333.15\\,\\mathrm{K}$, $i = 10^4\\,\\mathrm{A/m^2}$, $t_{\\mathrm{mem}} = 100\\times 10^{-6}\\,\\mathrm{m}$,\n  - $\\sigma_{\\mathrm{ref}} = 8\\,\\mathrm{S/m}$, $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$, $E_a = 1.2\\times 10^4\\,\\mathrm{J/mol}$,\n  - $R_s = 5\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m^2}$, $i_L = 2.0\\times 10^4\\,\\mathrm{A/m^2}$,\n  - $i_0 = 10^{-2}\\,\\mathrm{A/m^2}$, $\\alpha = 0.5$,\n  - $p_{\\mathrm{H}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$, $p_{\\mathrm{O}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n\n- Case $4$ (near mass-transport limitation):\n  - $T = 333.15\\,\\mathrm{K}$, $i_L = 2.0\\times 10^4\\,\\mathrm{A/m^2}$, $i = 0.95\\,i_L$,\n  - $t_{\\mathrm{mem}} = 180\\times 10^{-6}\\,\\mathrm{m}$,\n  - $\\sigma_{\\mathrm{ref}} = 8\\,\\mathrm{S/m}$, $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$, $E_a = 1.2\\times 10^4\\,\\mathrm{J/mol}$,\n  - $R_s = 5\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m^2}$,\n  - $i_0 = 10^{-2}\\,\\mathrm{A/m^2}$, $\\alpha = 0.5$,\n  - $p_{\\mathrm{H}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$, $p_{\\mathrm{O}_2} = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n\nProgram requirements:\n- Implement the above model and compute, for each test case, the pair $\\left[U,\\,\\frac{dU}{di}\\right]$.\n- Round both $U$ and $\\frac{dU}{di}$ to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $\\left[U,\\,dU/di|_1\\right]$. For example, an output with two cases would be formatted as $\\big[\\,[U_1,dU/di|_1],[U_2,dU/di|_2]\\,\\big]$.",
            "solution": "The problem has been analyzed and found to be valid. It is scientifically grounded in established principles of electrochemistry and transport phenomena, well-posed with all necessary information provided, and objective in its formulation. The parameters and models are standard for the analysis of PEM water electrolyzers.\n\nThe task is to compute the cell voltage $U$ and its sensitivity to current density, $\\frac{dU}{di}$, for a Proton Exchange Membrane (PEM) water electrolyzer under specified operating conditions. The model is composed of four distinct voltage contributions: the reversible cell voltage and three overpotential terms (activation, ohmic, and concentration).\n\nThe total cell voltage $U$ as a function of current density $i$ and temperature $T$ is given by the sum:\n$$\nU(i,T) = U_{\\mathrm{rev}}(T,p_{\\mathrm{H}_2},p_{\\mathrm{O}_2}) + \\eta_{\\mathrm{act}}(i,T) + \\eta_{\\mathrm{ohm}}(i,T) + \\eta_{\\mathrm{conc}}(i,T)\n$$\nEach component is modeled based on fundamental or well-established empirical relations.\n\n1.  **Reversible Cell Voltage ($U_{\\mathrm{rev}}$)**\n    The reversible voltage is the theoretical minimum voltage required for electrolysis, determined by the Gibbs free energy change of the water decomposition reaction ($\\mathrm{H_2O} \\rightarrow \\mathrm{H_2} + \\frac{1}{2}\\mathrm{O_2}$). It is calculated in two parts. First, the temperature-dependent standard potential $U_{\\mathrm{rev},0}(T)$ is determined. The problem defines this using the Gibbs free energy change for the decomposition reaction, approximated from standard enthalpy ($\\Delta H_f^0$) and entropy ($\\Delta S_f^0$) of formation for liquid water.\n    $$\n    U_{\\mathrm{rev},0}(T) = \\frac{-\\Delta G_f(T)}{nF} = \\frac{-(\\Delta H_f^0 - T\\Delta S_f^0)}{nF} = \\frac{-\\Delta H_f^0 + T\\Delta S_f^0}{nF}\n    $$\n    Here, $n=2$ is the number of electrons transferred, $F$ is the Faraday constant ($96485.33212\\,\\mathrm{C/mol}$), and the thermodynamic data for liquid water formation are $\\Delta H_f^0 = -285.83\\times 10^3\\,\\mathrm{J/mol}$ and $\\Delta S_f^0 = -163.2\\,\\mathrm{J/(mol\\cdot K)}$.\n\n    Second, a correction is added using the Nernst equation to account for product gas pressures ($p_{\\mathrm{H}_2}$, $p_{\\mathrm{O}_2}$) differing from the standard pressure $p_0 = 10^5\\,\\mathrm{Pa}$.\n    $$\n    U_{\\mathrm{rev}}(T,p_{\\mathrm{H}_2},p_{\\mathrm{O}_2}) = U_{\\mathrm{rev},0}(T) + \\frac{RT}{nF}\\ln\\!\\left(\\frac{p_{\\mathrm{H}_2}}{p_0}\\left(\\frac{p_{\\mathrm{O}_2}}{p_0}\\right)^{1/2}\\right)\n    $$\n    where $R$ is the universal gas constant ($8.314462618\\,\\mathrm{J/(mol\\cdot K)}$).\n\n2.  **Activation Overpotential ($\\eta_{\\mathrm{act}}$)**\n    This overpotential arises from the energy barrier that must be overcome to drive the electrochemical reactions at the electrode surfaces. For current densities $i$ significantly larger than the exchange current density $i_0$, the Butler-Volmer equation simplifies to the Tafel equation for the anodic branch:\n    $$\n    \\eta_{\\mathrm{act}}(i,T) = \\frac{RT}{\\alpha F}\\ln\\!\\left(\\frac{i}{i_0}\\right)\n    $$\n    where $\\alpha$ is the apparent charge transfer coefficient.\n\n3.  **Ohmic Overpotential ($\\eta_{\\mathrm{ohm}}$)**\n    This term represents the voltage drop due to ionic resistance in the electrolyte membrane and electronic resistance in other cell components. It follows Ohm's law for an area-specific resistance:\n    $$\n    \\eta_{\\mathrm{ohm}}(i,T) = i \\cdot R_{\\mathrm{ohm}}(T) = i\\,\\left(\\frac{t_{\\mathrm{mem}}}{\\sigma(T)} + R_s\\right)\n    $$\n    Here, $t_{\\mathrm{mem}}$ is the membrane thickness, $R_s$ is a residual resistance term, and $\\sigma(T)$ is the temperature-dependent proton conductivity of the membrane. $\\sigma(T)$ is modeled using an Arrhenius-type relation:\n    $$\n    \\sigma(T) = \\sigma_{\\mathrm{ref}}\\,\\exp\\!\\left(\\frac{E_a}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right)\n    $$\n    where $\\sigma_{\\mathrm{ref}}$ is the conductivity at a reference temperature $T_{\\mathrm{ref}}$, and $E_a$ is the activation energy for proton transport.\n\n4.  **Concentration Overpotential ($\\eta_{\\mathrm{conc}}$)**\n    This overpotential becomes significant at high current densities where the rate of reactant consumption at the electrode surface is limited by the mass transport of reactants. It is modeled in terms of a limiting current density, $i_L$:\n    $$\n    \\eta_{\\mathrm{conc}}(i,T) = \\frac{RT}{nF}\\ln\\!\\left(\\frac{1}{1 - \\frac{i}{i_L}}\\right)\n    $$\n    This expression is valid for $0 < i < i_L$. As $i$ approaches $i_L$, $\\eta_{\\mathrm{conc}}$ increases sharply.\n\n**Local Sensitivity Analysis**\nThe local scaling of the voltage with current density, or the sensitivity $\\frac{dU}{di}$, quantifies the local slope of the polarization curve ($U$ vs. $i$). It is an important parameter representing the local area-specific resistance of the cell. Since $U_{\\mathrm{rev}}$ does not depend on the current density $i$, its derivative is zero. The total sensitivity is the sum of the derivatives of the overpotential terms:\n$$\n\\frac{dU}{di} = \\frac{d\\eta_{\\mathrm{act}}}{di} + \\frac{d\\eta_{\\mathrm{ohm}}}{di} + \\frac{d\\eta_{\\mathrm{conc}}}{di}\n$$\nThe individual derivatives are provided as:\n$$\n\\frac{d\\eta_{\\mathrm{act}}}{di} = \\frac{RT}{\\alpha F}\\frac{1}{i}\n$$\n$$\n\\frac{d\\eta_{\\mathrm{ohm}}}{di} = R_{\\mathrm{ohm}}(T) = \\frac{t_{\\mathrm{mem}}}{\\sigma(T)} + R_s\n$$\n$$\n\\frac{d\\eta_{\\mathrm{conc}}}{di} = \\frac{RT}{nF}\\,\\frac{1}{i_L - i} = \\frac{RT}{nF}\\,\\frac{1}{i_L\\left(1 - \\frac{i}{i_L}\\right)}\n$$\n\n**Computational Procedure**\nFor each test case, the calculation proceeds as follows:\n1.  Given the operating temperature $T$ and membrane parameters ($E_a$, $\\sigma_{\\mathrm{ref}}$, $T_{\\mathrm{ref}}$), compute the membrane conductivity $\\sigma(T)$.\n2.  Calculate the total ohmic resistance $R_{\\mathrm{ohm}}$ using the computed $\\sigma(T)$, membrane thickness $t_{\\mathrm{mem}}$, and residual resistance $R_s$.\n3.  Calculate the four voltage components: $U_{\\mathrm{rev}}$, $\\eta_{\\mathrm{act}}$, $\\eta_{\\mathrm{ohm}}$, and $\\eta_{\\mathrm{conc}}$, using their respective formulas and the given parameters for the test case ($i, T, p_{\\mathrm{H}_2}, p_{\\mathrm{O}_2}$, etc.).\n4.  Sum the four components to obtain the total cell voltage $U$.\n5.  Calculate the three sensitivity components: $\\frac{d\\eta_{\\mathrm{act}}}{di}$, $\\frac{d\\eta_{\\mathrm{ohm}}}{di}$, and $\\frac{d\\eta_{\\mathrm{conc}}}{di}$.\n6.  Sum the three sensitivity components to obtain the total sensitivity $\\frac{dU}{di}$.\n7.  Round both final values, $U$ and $\\frac{dU}{di}$, to six decimal places, as required.\n\nThis procedure will be implemented for each of the four test cases specified in the problem statement.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PEM electrolyzer modeling problem for all test cases.\n    \"\"\"\n\n    # Physical and thermodynamic constants\n    R = 8.314462618  # J/(mol·K)\n    F = 96485.33212  # C/mol\n    N = 2              # Number of electrons\n    P0 = 1e5           # Pa, standard pressure\n    DELTA_H_f0 = -285.83e3  # J/mol, for liquid water\n    DELTA_S_f0 = -163.2   # J/(mol·K), for liquid water\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1 (baseline)\n        {\n            \"T\": 333.15, \"i\": 1e4, \"t_mem\": 180e-6, \"sigma_ref\": 8.0,\n            \"T_ref\": 298.15, \"E_a\": 1.2e4, \"R_s\": 5e-5, \"i_L\": 2.0e4,\n            \"i_0\": 1e-2, \"alpha\": 0.5, \"p_h2\": 3.0e6, \"p_o2\": 3.0e6\n        },\n        # Case 2 (higher temperature)\n        {\n            \"T\": 353.15, \"i\": 1e4, \"t_mem\": 180e-6, \"sigma_ref\": 8.0,\n            \"T_ref\": 298.15, \"E_a\": 1.2e4, \"R_s\": 5e-5, \"i_L\": 2.0e4,\n            \"i_0\": 1e-2, \"alpha\": 0.5, \"p_h2\": 3.0e6, \"p_o2\": 3.0e6\n        },\n        # Case 3 (thinner membrane)\n        {\n            \"T\": 333.15, \"i\": 1e4, \"t_mem\": 100e-6, \"sigma_ref\": 8.0,\n            \"T_ref\": 298.15, \"E_a\": 1.2e4, \"R_s\": 5e-5, \"i_L\": 2.0e4,\n            \"i_0\": 1e-2, \"alpha\": 0.5, \"p_h2\": 3.0e6, \"p_o2\": 3.0e6\n        },\n        # Case 4 (near mass-transport limitation)\n        {\n            \"T\": 333.15, \"i_L\": 2.0e4, \"i\": 0.95 * 2.0e4, \"t_mem\": 180e-6,\n            \"sigma_ref\": 8.0, \"T_ref\": 298.15, \"E_a\": 1.2e4, \"R_s\": 5e-5,\n            \"i_0\": 1e-2, \"alpha\": 0.5, \"p_h2\": 3.0e6, \"p_o2\": 3.0e6\n        }\n    ]\n\n    def calculate_voltage_and_sensitivity(params):\n        \"\"\"\n        Calculates the cell voltage U and its sensitivity dU/di for a given set of parameters.\n        \"\"\"\n        T = params[\"T\"]\n        i = params[\"i\"]\n        t_mem = params[\"t_mem\"]\n        sigma_ref = params[\"sigma_ref\"]\n        T_ref = params[\"T_ref\"]\n        E_a = params[\"E_a\"]\n        R_s = params[\"R_s\"]\n        i_L = params[\"i_L\"]\n        i_0 = params[\"i_0\"]\n        alpha = params[\"alpha\"]\n        p_h2 = params[\"p_h2\"]\n        p_o2 = params[\"p_o2\"]\n\n        # 1. Reversible Voltage (U_rev)\n        u_rev_0 = (-DELTA_H_f0 + T * DELTA_S_f0) / (N * F)\n        nernst_correction = (R * T) / (N * F) * np.log((p_h2 / P0) * (p_o2 / P0)**0.5)\n        u_rev = u_rev_0 + nernst_correction\n\n        # 2. Activation Overpotential (eta_act)\n        eta_act = (R * T) / (alpha * F) * np.log(i / i_0)\n\n        # 3. Ohmic Overpotential (eta_ohm)\n        # First, calculate temperature-dependent conductivity sigma(T)\n        sigma_T = sigma_ref * np.exp((E_a / R) * (1 / T_ref - 1 / T))\n        # Total area-specific ohmic resistance\n        r_ohm = t_mem / sigma_T + R_s\n        eta_ohm = i * r_ohm\n\n        # 4. Concentration Overpotential (eta_conc)\n        eta_conc = (R * T) / (N * F) * np.log(1 / (1 - i / i_L))\n\n        # Total Cell Voltage\n        U = u_rev + eta_act + eta_ohm + eta_conc\n\n        # Sensitivity analysis (dU/di)\n        # derivative of reversible potential is 0\n        d_eta_act_di = (R * T) / (alpha * F * i)\n        d_eta_ohm_di = r_ohm\n        d_eta_conc_di = (R * T) / (N * F) * (1 / (i_L - i))\n        dU_di = d_eta_act_di + d_eta_ohm_di + d_eta_conc_di\n        \n        return [round(U, 6), round(dU_di, 6)]\n\n    results = []\n    for case_params in test_cases:\n        result_pair = calculate_voltage_and_sensitivity(case_params)\n        results.append(str(result_pair))\n    \n    # Format the final output string exactly as required\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on component-level analysis, this exercise demonstrates the importance of system-wide thinking through the principle of heat integration. You will calculate the direct economic and energy benefits of recovering waste heat from an exothermic process to satisfy a thermal demand elsewhere in the plant. This practice  showcases how clever system design can significantly improve the overall efficiency and viability of an entire Power-to-Gas facility.",
            "id": "4113186",
            "problem": "A power-to-gas plant couples a Proton Exchange Membrane (PEM) water electrolyzer with a downstream carbon dioxide methanation reactor. The electrolyzer balance-of-plant requires a hot water loop at $60^\\circ\\mathrm{C}$ to heat and humidify feeds and offset distribution losses. The loop circulates liquid water at a mass flow rate $\\dot{m}_{\\mathrm{w}}=40\\ \\mathrm{kg/s}$, with specific heat capacity $c_{p,\\mathrm{w}}=4.18\\ \\mathrm{kJ/(kg\\cdot K)}$. The water enters the loop at $30^\\circ\\mathrm{C}$. In addition to the sensible heating of the water from $30^\\circ\\mathrm{C}$ to $60^\\circ\\mathrm{C}$, there are other fixed thermal losses in the balance-of-plant totaling $2.5\\ \\mathrm{MW}$.\n\nIn the baseline configuration, this thermal load is met entirely by a natural gas-fired boiler with thermal efficiency $\\eta_{\\mathrm{b}}=0.90$ (based on the Lower Heating Value). The Lower Heating Value (LHV) of the natural gas is $50\\ \\mathrm{MJ/kg}$.\n\nAn integration is proposed to recover $5.0\\ \\mathrm{MW}$ of heat from the exothermic methanation reactor effluent via a countercurrent heat exchanger. The hot methanation stream enters the exchanger at $150^\\circ\\mathrm{C}$ and has a sufficiently large heat capacity flow rate that cooling it by the required amount to provide $5.0\\ \\mathrm{MW}$ does not constrain the cold-side target. The heat exchanger network is designed to satisfy a minimum approach temperature of $\\Delta T_{\\min}=10\\ \\mathrm{K}$ everywhere. Assume single-phase operation, negligible heat losses to ambient, and that the recovered $5.0\\ \\mathrm{MW}$ is available at the temperature level necessary to heat the water loop without violating $\\Delta T_{\\min}$.\n\nUsing the First Law of Thermodynamics and energy balances, determine the reduction in the baseline utility consumption quantified as the natural gas mass flow rate saved, expressed in $\\mathrm{kg/s}$, by implementing the $5.0\\ \\mathrm{MW}$ heat recovery. Round your answer to four significant figures. Express the final value in $\\mathrm{kg/s}$.",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- Hot water loop target temperature: $T_{\\mathrm{w,out}} = 60^\\circ\\mathrm{C}$\n- Water mass flow rate in loop: $\\dot{m}_{\\mathrm{w}} = 40\\ \\mathrm{kg/s}$\n- Specific heat capacity of water: $c_{p,\\mathrm{w}} = 4.18\\ \\mathrm{kJ/(kg\\cdot K)}$\n- Water inlet temperature to loop heating: $T_{\\mathrm{w,in}} = 30^\\circ\\mathrm{C}$\n- Fixed thermal losses in balance-of-plant: $P_{\\mathrm{loss}} = 2.5\\ \\mathrm{MW}$\n- Baseline heat source: Natural gas-fired boiler\n- Boiler thermal efficiency: $\\eta_{\\mathrm{b}} = 0.90$\n- Lower Heating Value of natural gas: $LHV_{\\mathrm{ng}} = 50\\ \\mathrm{MJ/kg}$\n- Proposed heat recovery from methanation: $P_{\\mathrm{rec}} = 5.0\\ \\mathrm{MW}$\n- Minimum approach temperature for heat exchange: $\\Delta T_{\\min} = 10\\ \\mathrm{K}$\n- Assumption: The recovered $5.0\\ \\mathrm{MW}$ is available at a temperature level that satisfies the $\\Delta T_{\\min}$ constraint.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated based on the established criteria:\n- **Scientifically Grounded:** The problem is firmly rooted in the First Law of Thermodynamics and the principles of process heat integration, which are fundamental to energy systems engineering. All provided physical quantities, such as temperatures, flow rates, heat capacities, and efficiencies, are realistic for an industrial power-to-gas facility.\n- **Well-Posed:** The problem provides all necessary data to calculate the total heat demand and then determine the fuel savings resulting from the specified heat recovery. The question is unambiguous and leads to a unique, stable solution.\n- **Objective:** The problem is described using precise, technical language, free from any subjectivity or opinion.\n- **Consistency Check:** The total heat demand of the system must be calculated to ensure that the proposed heat recovery does not exceed it. The heat required for the water loop is $P_{\\mathrm{w,sensible}} = \\dot{m}_{\\mathrm{w}} c_{p,\\mathrm{w}} (T_{\\mathrm{w,out}} - T_{\\mathrm{w,in}}) = (40\\ \\mathrm{kg/s}) \\times (4.18\\ \\mathrm{kJ/(kg\\cdot K)}) \\times (60 - 30)\\ \\mathrm{K} = 5016\\ \\mathrm{kW} = 5.016\\ \\mathrm{MW}$. The total demand is $P_{\\mathrm{demand}} = P_{\\mathrm{w,sensible}} + P_{\\mathrm{loss}} = 5.016\\ \\mathrm{MW} + 2.5\\ \\mathrm{MW} = 7.516\\ \\mathrm{MW}$. Since the recovered heat $P_{\\mathrm{rec}} = 5.0\\ \\mathrm{MW}$ is less than the total demand $P_{\\mathrm{demand}} = 7.516\\ \\mathrm{MW}$, the scenario is physically consistent. The boiler is still required to provide the remaining $2.516\\ \\mathrm{MW}$, so the problem is not overconstrained. The problem's constraints are self-consistent and sufficient.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is scientifically sound, well-posed, objective, and internally consistent. A solution will be derived.\n\nThe objective is to find the reduction in the natural gas mass flow rate, $\\Delta \\dot{m}_{\\mathrm{ng}}$, resulting from the implementation of heat recovery.\n\nThe proposed heat integration provides $P_{\\mathrm{rec}} = 5.0\\ \\mathrm{MW}$ of thermal power. This recovered heat directly substitutes for heat that would otherwise be supplied by the natural gas-fired boiler. Therefore, the reduction in the thermal power output required from the boiler, $\\Delta P_{\\mathrm{b}}$, is equal to the recovered heat:\n$$\n\\Delta P_{\\mathrm{b}} = P_{\\mathrm{rec}} = 5.0\\ \\mathrm{MW}\n$$\nThe thermal efficiency of the boiler, $\\eta_{\\mathrm{b}}$, relates the useful heat output, $P_{\\mathrm{b}}$, to the rate of energy input from the fuel, $P_{\\mathrm{fuel}}$, according to the First Law:\n$$\n\\eta_{\\mathrm{b}} = \\frac{P_{\\mathrm{b}}}{P_{\\mathrm{fuel}}}\n$$\nThe rate of energy input from the fuel is given by the product of the fuel mass flow rate, $\\dot{m}_{\\mathrm{ng}}$, and its Lower Heating Value, $LHV_{\\mathrm{ng}}$:\n$$\nP_{\\mathrm{fuel}} = \\dot{m}_{\\mathrm{ng}} \\cdot LHV_{\\mathrm{ng}}\n$$\nCombining these two relations, the mass flow rate of natural gas required to produce a certain amount of heat is:\n$$\n\\dot{m}_{\\mathrm{ng}} = \\frac{P_{\\mathrm{b}}}{\\eta_{\\mathrm{b}} \\cdot LHV_{\\mathrm{ng}}}\n$$\nThe reduction in the natural gas mass flow rate, $\\Delta \\dot{m}_{\\mathrm{ng}}$, corresponds to the fuel that is no longer needed to produce the saved thermal power, $\\Delta P_{\\mathrm{b}}$. Therefore, we can write:\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} = \\frac{\\Delta P_{\\mathrm{b}}}{\\eta_{\\mathrm{b}} \\cdot LHV_{\\mathrm{ng}}}\n$$\nSubstituting $\\Delta P_{\\mathrm{b}} = P_{\\mathrm{rec}}$:\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} = \\frac{P_{\\mathrm{rec}}}{\\eta_{\\mathrm{b}} \\cdot LHV_{\\mathrm{ng}}}\n$$\nThe given values are:\n- $P_{\\mathrm{rec}} = 5.0\\ \\mathrm{MW} = 5.0 \\times 10^{6}\\ \\mathrm{J/s}$\n- $\\eta_{\\mathrm{b}} = 0.90$\n- $LHV_{\\mathrm{ng}} = 50\\ \\mathrm{MJ/kg} = 50 \\times 10^{6}\\ \\mathrm{J/kg}$\n\nSubstituting these values into the equation for $\\Delta \\dot{m}_{\\mathrm{ng}}$:\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} = \\frac{5.0 \\times 10^{6}\\ \\mathrm{J/s}}{0.90 \\times (50 \\times 10^{6}\\ \\mathrm{J/kg})}\n$$\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} = \\frac{5.0}{0.90 \\times 50}\\ \\mathrm{kg/s}\n$$\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} = \\frac{5.0}{45}\\ \\mathrm{kg/s}\n$$\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} \\approx 0.111111...\\ \\mathrm{kg/s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta \\dot{m}_{\\mathrm{ng}} \\approx 0.1111\\ \\mathrm{kg/s}\n$$\nThe additional information regarding the water loop temperatures, flow rate, and fixed losses, while necessary to confirm the overall system's energy balance and the validity of the problem, is not directly required for calculating the reduction in fuel consumption, which depends only on the magnitude of the displaced heat load, boiler efficiency, and fuel properties.",
            "answer": "$$\\boxed{0.1111}$$"
        },
        {
            "introduction": "Ultimately, the feasibility of an energy project is determined by its economics. This final practice introduces the essential techno-economic metric of Levelized Cost of Hydrogen (LCOH), which synthesizes technical performance and financial inputs into a single, comparable cost figure. By working through this calculation , you will learn how to connect engineering parameters like efficiency and capacity factor with financial variables such as capital costs and discount rates to evaluate the long-term economic viability of a hydrogen production plant.",
            "id": "4113260",
            "problem": "A grid-connected proton exchange membrane electrolyzer plant converts electrical energy to hydrogen via electrolysis. Assume the plant has a continuous rated electrical input of $20\\ \\mathrm{MW}$, a capacity factor of $50\\%$, an electricity purchase price of \\$30/\\mathrm{MWh}, an electrolysis conversion efficiency of $55\\%$ on a lower heating value (LHV) basis, an upfront capital expenditure of \\$800/\\mathrm{kW} of rated capacity, an economic lifetime of $N=20$ years, and a real discount rate of $r=8\\%$. Take fixed operation and maintenance to be $3\\%$ of upfront capital cost per year. Use the lower heating value of hydrogen $q_{\\mathrm{H_2}}=33.33\\ \\mathrm{kWh/kg}$ as a well-tested thermochemical fact.\n\nStarting from first principles of energy balance, capacity factor definition, and the time value of money (present value of equal annual payments), derive the annual hydrogen production and the equivalent annual cost of the plant. Then compute the Levelized Cost of Hydrogen (LCOH) defined as the constant unit cost that equates the present value of all costs to the present value of all hydrogen produced over the lifetime, and, because annual costs and outputs are constant, as the ratio of the equivalent annualized cost to the annual hydrogen production. Express the final LCOH in dollars per kilogram (\\$/kg) and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the Levelized Cost of Hydrogen (LCOH) for a grid-connected proton exchange membrane (PEM) electrolyzer plant. The validation process confirms that the problem statement is scientifically grounded, well-posed, and objective, containing all necessary information for a complete solution. We shall proceed by deriving the required quantities from first principles.\n\nThe LCOH, as defined for this problem with constant annual production and costs, is the ratio of the total equivalent annual cost of the plant to the total annual mass of hydrogen produced.\n$$\n\\mathrm{LCOH} = \\frac{C_{\\text{annual}}}{M_{\\mathrm{H_2}, \\text{annual}}}\n$$\nWhere $C_{\\text{annual}}$ is the equivalent annual cost in dollars per year and $M_{\\mathrm{H_2}, \\text{annual}}$ is the annual hydrogen production in kilograms per year.\n\nFirst, we calculate the annual hydrogen production, $M_{\\mathrm{H_2}, \\text{annual}}$.\n\nThe rated electrical input power of the plant is $P_{\\text{rated}} = 20\\ \\mathrm{MW}$, which is equivalent to $20,000\\ \\mathrm{kW}$. The plant operates with a capacity factor of $CF = 50\\% = 0.5$. The total number of hours in a year is $365 \\times 24 = 8,760\\ \\mathrm{h}$.\nThe annual electrical energy consumed by the plant, $E_{\\text{in, annual}}$, is given by:\n$$\nE_{\\text{in, annual}} = P_{\\text{rated}} \\times CF \\times (8,760\\ \\mathrm{h/yr})\n$$\nSubstituting the given values:\n$$\nE_{\\text{in, annual}} = (20\\ \\mathrm{MW}) \\times 0.5 \\times (8,760\\ \\mathrm{h/yr}) = 10\\ \\mathrm{MW} \\times (8,760\\ \\mathrm{h/yr}) = 87,600\\ \\mathrm{MWh/yr}\n$$\nConverting to kilowatt-hours (kWh) for consistency with other given values:\n$$\nE_{\\text{in, annual}} = 87,600\\ \\mathrm{MWh/yr} \\times \\frac{1,000\\ \\mathrm{kWh}}{1\\ \\mathrm{MWh}} = 87,600,000\\ \\mathrm{kWh/yr}\n$$\nThe electrolysis conversion efficiency, $\\eta_{\\text{ely}}$, is given as $55\\%$ ($0.55$) on a lower heating value (LHV) basis. The LHV of hydrogen is given as $q_{\\mathrm{H_2}} = 33.33\\ \\mathrm{kWh/kg}$. The annual mass of hydrogen produced, $M_{\\mathrm{H_2}, \\text{annual}}$, is the total energy content of the produced hydrogen divided by its specific energy content (LHV):\n$$\nM_{\\mathrm{H_2}, \\text{annual}} = \\frac{E_{\\text{in, annual}} \\times \\eta_{\\text{ely}}}{q_{\\mathrm{H_2}}}\n$$\nSubstituting the values:\n$$\nM_{\\mathrm{H_2}, \\text{annual}} = \\frac{(87,600,000\\ \\mathrm{kWh/yr}) \\times 0.55}{33.33\\ \\mathrm{kWh/kg}} = \\frac{48,180,000\\ \\mathrm{kWh/yr}}{33.33\\ \\mathrm{kWh/kg}} \\approx 1,445,445.4\\ \\mathrm{kg/yr}\n$$\nNext, we calculate the equivalent annual cost, $C_{\\text{annual}}$. This cost is the sum of three components: the annualized capital cost ($C_{\\text{CAPEX, annual}}$), the annual fixed operation and maintenance cost ($C_{\\text{O\\, annual}}$), and the annual electricity cost ($C_{\\text{Elec, annual}}$).\n$$\nC_{\\text{annual}} = C_{\\text{CAPEX, annual}} + C_{\\text{O\\, annual}} + C_{\\text{Elec, annual}}\n$$\n1.  **Capital Cost and its Annualization**:\n    The upfront capital expenditure is given as \\$800/\\mathrm{kW} of rated capacity. The total upfront capital expenditure ($C_{\\text{CAPEX}}$) is:\n    $$\n    C_{\\text{CAPEX}} = (800\\ \\$/\\mathrm{kW}) \\times (20,000\\ \\mathrm{kW}) = \\$16,000,000\n    $$\n    To find the equivalent annual cost of this upfront investment, we use the Capital Recovery Factor ($CRF$), which is a function of the real discount rate $r=8\\%=0.08$ and the economic lifetime $N=20$ years.\n    $$\n    CRF(r, N) = \\frac{r(1+r)^N}{(1+r)^N - 1}\n    $$\n    For the given values:\n    $$\n    CRF(0.08, 20) = \\frac{0.08(1+0.08)^{20}}{(1+0.08)^{20} - 1} = \\frac{0.08(1.08)^{20}}{(1.08)^{20} - 1} \\approx 0.1018522\n    $$\n    The annualized capital cost is:\n    $$\n    C_{\\text{CAPEX, annual}} = C_{\\text{CAPEX}} \\times CRF \\approx \\$16,000,000 \\times 0.1018522 \\approx \\$1,629,635.55\\ / \\mathrm{yr}\n    $$\n2.  **Annual Fixed Operation and Maintenance Cost**:\n    This is given as $3\\%$ of the upfront capital cost per year ($f_{\\text{O\\}} = 0.03$).\n    $$\n    C_{\\text{O\\, annual}} = C_{\\text{CAPEX}} \\times f_{\\text{O\\}} = \\$16,000,000 \\times 0.03 = \\$480,000\\ / \\mathrm{yr}\n    $$\n3.  **Annual Electricity Cost**:\n    The electricity purchase price is given as $p_{\\text{elec}} = \\$30/\\mathrm{MWh}$.\n    $$\n    C_{\\text{Elec, annual}} = E_{\\text{in, annual}} \\times p_{\\text{elec}} = (87,600\\ \\mathrm{MWh/yr}) \\times (30\\ \\$/\\mathrm{MWh}) = \\$2,628,000\\ / \\mathrm{yr}\n    $$\nNow, we sum these three components to find the total equivalent annual cost:\n$$\nC_{\\text{annual}} \\approx \\$1,629,635.55 + \\$480,000 + \\$2,628,000 = \\$4,737,635.55\\ / \\mathrm{yr}\n$$\nFinally, we compute the LCOH by dividing the total annual cost by the annual hydrogen production:\n$$\n\\mathrm{LCOH} = \\frac{C_{\\text{annual}}}{M_{\\mathrm{H_2}, \\text{annual}}} \\approx \\frac{\\$4,737,635.55\\ / \\mathrm{yr}}{1,445,445.4\\ \\mathrm{kg/yr}} \\approx 3.2776\\ \\$/\\mathrm{kg}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\mathrm{LCOH} \\approx 3.278\\ \\$/\\mathrm{kg}\n$$",
            "answer": "$$\n\\boxed{3.278}\n$$"
        }
    ]
}