{
    "hands_on_practices": [
        {
            "introduction": "Accurately determining the mass of hydrogen stored in a high-pressure tank is fundamental to designing and operating hydrogen fuel cell vehicles. At the typical operating pressures of $350$ or $700$ bar, hydrogen gas deviates significantly from ideal-gas behavior, necessitating the use of a real-gas equation of state. This practice  guides you through deriving a model for the fillable mass in a composite tank, incorporating both the real-gas effects via the compressibility factor $Z$ and the physical expansion of the tank itself under pressure.",
            "id": "4096338",
            "problem": "A hydrogen fuel cell vehicle uses a composite Type IV on-board storage tank whose internal free volume at zero gauge pressure is $V_{0}$ and whose volumetric compliance is approximately linear with pressure, so that the internal volume under pressure $P$ is $V(P) = V_{0}\\left(1 + \\kappa P\\right)$, where $\\kappa$ is a small positive constant with units of $\\mathrm{Pa}^{-1}$. The tank is filled according to a widely used industry fueling protocol such as the Society of Automotive Engineers (SAE) standard J2601 (Society of Automotive Engineers (SAE)), which targets a settled state after fueling such that the tank pressure equals the nominal working pressure (NWP) $P_{\\mathrm{nwp}}$ when the hydrogen temperature has equilibrated to the ambient temperature $T_{\\mathrm{amb}}$.\n\nAssume the following physically grounded modeling framework:\n- Hydrogen behaves as a real gas described by the compressibility factor $Z(P,T)$, defined by the real-gas equation of state $P V = Z(P,T)\\, n R T$, where $n$ is the number of moles, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- The hydrogen mass is $m = n M$, where $M$ is the molar mass of hydrogen. The tank composition does not change during fueling.\n- The fueling protocol stops the dispenser when the predicted settled pressure (after thermal equilibration) will equal $P_{\\mathrm{nwp}}$ at $T_{\\mathrm{amb}}$. Transient temperature excursions during fueling do not change the settled target; leakage and blowdown are negligible.\n\nInitially, the tank contains hydrogen at pressure $P_{0}$ and temperature $T_{0}$, occupying the internal volume $V(P_{0})$. After fueling and subsequent thermal equilibration, the settled final state is at pressure $P_{\\mathrm{nwp}}$ and temperature $T_{\\mathrm{amb}}$, occupying the internal volume $V(P_{\\mathrm{nwp}})$.\n\nStarting from the real-gas definition of the compressibility factor, the ideal-gas law, and the stated volumeâ€“pressure relation, derive a closed-form analytic expression for the maximum additional hydrogen mass $\\Delta m$ that can be added during the fueling event as a function of the initial pressure $P_{0}$ and temperature $T_{0}$, the ambient temperature $T_{\\mathrm{amb}}$, the nominal working pressure $P_{\\mathrm{nwp}}$, the zero-pressure tank volume $V_{0}$, the volumetric compliance coefficient $\\kappa$, the universal gas constant $R$, the molar mass $M$, and the compressibility factor evaluated at the initial and final settled states.\n\nUse SI units: express pressure in $\\mathrm{Pa}$, temperature in $\\mathrm{K}$, volume in $\\mathrm{m}^{3}$, the universal gas constant in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and the molar mass in $\\mathrm{kg\\,mol^{-1}}$. Express the final mass in kilograms. Your final answer must be a single closed-form expression; no numerical evaluation is required.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a closed-form solution. The problem is a standard exercise in applied thermodynamics and fluid mechanics, relevant to energy systems modeling.\n\nThe objective is to derive an expression for the additional hydrogen mass, $\\Delta m$, that can be added to the tank. This quantity is the difference between the final mass of hydrogen, $m_{\\mathrm{f}}$, and the initial mass, $m_{0}$.\n$$\n\\Delta m = m_{\\mathrm{f}} - m_{0}\n$$\nTo find expressions for $m_{\\mathrm{f}}$ and $m_{0}$, we begin with the real-gas equation of state provided, which relates pressure $P$, volume $V$, temperature $T$, and the number of moles $n$:\n$$\nP V = Z(P,T)\\, n R T\n$$\nHere, $Z(P,T)$ is the compressibility factor, a function of pressure and temperature, and $R$ is the universal gas constant. The mass of the gas, $m$, is related to the number of moles $n$ through the molar mass $M$:\n$$\nm = n M\n$$\nBy substituting $n = \\frac{m}{M}$ into the real-gas equation, we can solve for the mass $m$:\n$$\nP V = Z(P,T) \\left(\\frac{m}{M}\\right) R T\n$$\n$$\nm = \\frac{P V M}{Z(P,T) R T}\n$$\nThis general expression allows us to calculate the mass of gas in the tank for any given state $(P, T, V)$.\n\nNext, we apply this general expression to the initial and final states of the system.\n\nThe initial state is characterized by pressure $P_{0}$ and temperature $T_{0}$. According to the problem statement, the internal volume of the tank, $V$, is a function of the internal pressure, given by the linear compliance relation $V(P) = V_{0}\\left(1 + \\kappa P\\right)$. Therefore, the initial volume is:\n$$\nV(P_{0}) = V_{0}\\left(1 + \\kappa P_{0}\\right)\n$$\nThe compressibility factor at the initial state is $Z(P_0, T_0)$. Substituting these into the general mass equation gives the initial mass, $m_{0}$:\n$$\nm_{0} = \\frac{P_{0} V(P_{0}) M}{Z(P_{0}, T_{0}) R T_{0}} = \\frac{P_{0} \\left[V_{0}\\left(1 + \\kappa P_{0}\\right)\\right] M}{Z(P_{0}, T_{0}) R T_{0}}\n$$\n\nThe final settled state is characterized by the nominal working pressure $P_{\\mathrm{nwp}}$ and the ambient temperature $T_{\\mathrm{amb}}$. The volume of the tank at this final pressure is:\n$$\nV(P_{\\mathrm{nwp}}) = V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)\n$$\nThe compressibility factor at the final state is $Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}})$. Substituting these values into the general mass equation gives the final mass, $m_{\\mathrm{f}}$:\n$$\nm_{\\mathrm{f}} = \\frac{P_{\\mathrm{nwp}} V(P_{\\mathrm{nwp}}) M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}} = \\frac{P_{\\mathrm{nwp}} \\left[V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)\\right] M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}}\n$$\n\nFinally, we calculate the added mass $\\Delta m$ by subtracting the initial mass from the final mass:\n$$\n\\Delta m = m_{\\mathrm{f}} - m_{0}\n$$\n$$\n\\Delta m = \\frac{P_{\\mathrm{nwp}} V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right) M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}} - \\frac{P_{0} V_{0}\\left(1 + \\kappa P_{0}\\right) M}{Z(P_{0}, T_{0}) R T_{0}}\n$$\nTo present this in a more compact closed form, we can factor out the common terms $\\frac{V_{0}M}{R}$:\n$$\n\\Delta m = \\frac{V_{0} M}{R} \\left[ \\frac{P_{\\mathrm{nwp}}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) T_{\\mathrm{amb}}} - \\frac{P_{0}\\left(1 + \\kappa P_{0}\\right)}{Z(P_{0}, T_{0}) T_{0}} \\right]\n$$\nThis expression represents the maximum additional hydrogen mass that can be added to the tank, derived from the fundamental principles and definitions provided in the problem statement.",
            "answer": "$$\\boxed{\\frac{V_{0} M}{R} \\left[ \\frac{P_{\\mathrm{nwp}}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) T_{\\mathrm{amb}}} - \\frac{P_{0}\\left(1 + \\kappa P_{0}\\right)}{Z(P_{0}, T_{0}) T_{0}} \\right]}$$"
        },
        {
            "introduction": "While compressed gas is common, liquid hydrogen (LH2) offers superior volumetric energy density, making it attractive for certain applications. However, transporting LH2 via cryogenic pipelines introduces complex fluid dynamics challenges, particularly the formation of two-phase flow due to unavoidable heat leak. This exercise  explores how to model the frictional pressure drop in such a scenario using the homogeneous equilibrium model, providing insight into how even a small vapor fraction can drastically increase the required pumping power compared to single-phase liquid flow.",
            "id": "4096234",
            "problem": "A horizontal transfer line of length $L$ and inner diameter $D$ carries saturated liquid hydrogen (LH2) at temperature $20\\,\\mathrm{K}$. The pipe has an absolute roughness $\\varepsilon$, and the total mass flow rate is $\\dot{m}$. Under an accidental heat leak, a homogeneous two-phase flow forms with vapor quality $x$ (mass fraction of vapor), while the total mass flow rate remains $\\dot{m}$. Assume the homogeneous equilibrium model (equal phase velocities, no slip) and fully rough turbulent flow such that the wall friction factor depends only on relative roughness.\n\nStarting from a one-dimensional steady momentum balance for a control volume in a straight, horizontal pipe and widely accepted constitutive relations, derive the frictional pressure drop as a function of the mass flow rate and fluid density, and use this to compute the additional frictional pressure drop (two-phase minus single-phase liquid) along the line. Take the saturated liquid density as $\\rho_{\\ell}$ and the saturated vapor density as $\\rho_{v}$. The homogeneous mixture density $\\rho_{m}$ is determined by additivity of specific volumes.\n\nUse the following data:\n- $L = 50\\,\\mathrm{m}$,\n- $D = 0.05\\,\\mathrm{m}$,\n- $\\varepsilon = 2.0 \\times 10^{-5}\\,\\mathrm{m}$,\n- $\\dot{m} = 1.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$,\n- $x = 0.05$,\n- $\\rho_{\\ell} = 70.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n- $\\rho_{v} = 1.30\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n\nFor the fully rough turbulent regime, take the Darcy friction factor $f$ from the roughness limit of the Colebrook relation, $\\frac{1}{\\sqrt{f}} = -2 \\log_{10}\\left(\\frac{\\varepsilon}{3.7 D}\\right)$. Express the additional frictional pressure drop in $\\mathrm{kPa}$ and round your final answer to three significant figures.",
            "solution": "The frictional pressure drop in a horizontal pipe is derived from a steady-state momentum balance. For a differential control volume, the balance between pressure force and wall shear force gives the frictional pressure gradient:\n$$\n\\left(-\\frac{dp}{dz}\\right)_f = f \\frac{\\rho u^2}{2D}\n$$\nwhere $f$ is the Darcy friction factor, $\\rho$ is the fluid density, $u$ is the velocity, and $D$ is the pipe diameter. By expressing the velocity in terms of the mass flow rate, $\\dot{m} = \\rho u A = \\rho u (\\pi D^2/4)$, the total frictional pressure drop $\\Delta p_f$ over a length $L$ becomes:\n$$\n\\Delta p_f = \\frac{8 f \\dot{m}^2 L}{\\rho \\pi^2 D^5}\n$$\nThe problem requires finding the additional pressure drop, $\\Delta p_{add} = \\Delta p_{tp} - \\Delta p_{\\ell}$, where $\\Delta p_{tp}$ is the two-phase drop and $\\Delta p_{\\ell}$ is the single-phase liquid drop.\n\n**1. Calculate the Darcy Friction Factor ($f$)**\nThe flow is fully rough, so $f$ depends only on the relative roughness $\\varepsilon/D$:\n$$\n\\frac{\\varepsilon}{D} = \\frac{2.0 \\times 10^{-5}\\,\\mathrm{m}}{0.05\\,\\mathrm{m}} = 4.0 \\times 10^{-4}\n$$\nUsing the provided relation:\n$$\n\\frac{1}{\\sqrt{f}} = -2 \\log_{10}\\left(\\frac{\\varepsilon}{3.7 D}\\right) = -2 \\log_{10}\\left(\\frac{4.0 \\times 10^{-4}}{3.7}\\right) \\approx -2(-3.9661) = 7.9322\n$$\n$$\nf \\approx (7.9322)^{-2} \\approx 0.015894\n$$\nThis friction factor is constant for both flow scenarios.\n\n**2. Calculate Single-Phase Liquid Pressure Drop ($\\Delta p_{\\ell}$)**\nFor the single-phase liquid flow, the density is $\\rho = \\rho_{\\ell} = 70.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n$$\n\\Delta p_{\\ell} = \\frac{8 f \\dot{m}^2 L}{\\rho_{\\ell} \\pi^2 D^5} = \\frac{8(0.015894)(1.0)^2 (50)}{(70.0) \\pi^2 (0.05)^5} \\approx \\frac{6.3576}{2.1583 \\times 10^{-4}} \\approx 29456\\,\\mathrm{Pa}\n$$\n\n**3. Calculate Two-Phase Pressure Drop ($\\Delta p_{tp}$)**\nFor the two-phase flow, we use the homogeneous equilibrium model. The pressure drop is found by using an effective homogeneous mixture density $\\rho_m$. An elegant approach is to use the two-phase friction multiplier, $\\phi_{\\ell o}^2$:\n$$\n\\Delta p_{tp} = \\phi_{\\ell o}^2 \\Delta p_{\\ell o}\n$$\nwhere $\\Delta p_{\\ell o}$ is the pressure drop if the total mass flow rate $\\dot{m}$ were flowing as liquid, which is exactly our $\\Delta p_{\\ell}$. For the homogeneous model, the multiplier is the ratio of liquid density to mixture density:\n$$\n\\phi_{\\ell o}^2 = \\frac{\\rho_{\\ell}}{\\rho_m}\n$$\nThe mixture density $\\rho_m$ is found from the additivity of specific volumes ($v=1/\\rho$):\n$$\n\\frac{1}{\\rho_m} = \\frac{1-x}{\\rho_{\\ell}} + \\frac{x}{\\rho_v}\n$$\nSubstituting this into the multiplier expression:\n$$\n\\phi_{\\ell o}^2 = \\rho_{\\ell} \\left(\\frac{1-x}{\\rho_{\\ell}} + \\frac{x}{\\rho_v}\\right) = (1-x) + x\\frac{\\rho_{\\ell}}{\\rho_v} = 1 + x\\left(\\frac{\\rho_{\\ell}}{\\rho_v} - 1\\right)\n$$\n\n**4. Calculate Additional Pressure Drop ($\\Delta p_{add}$)**\nThe additional pressure drop is:\n$$\n\\Delta p_{add} = \\Delta p_{tp} - \\Delta p_{\\ell} = (\\phi_{\\ell o}^2 - 1) \\Delta p_{\\ell} = \\left[ x\\left(\\frac{\\rho_{\\ell}}{\\rho_v} - 1\\right) \\right] \\Delta p_{\\ell}\n$$\nNow, substitute the numerical values.\nThe density ratio is:\n$$\n\\frac{\\rho_{\\ell}}{\\rho_v} = \\frac{70.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}{1.30\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}} \\approx 53.846\n$$\nThe multiplier term $(\\phi_{\\ell o}^2 - 1)$ is:\n$$\nx\\left(\\frac{\\rho_{\\ell}}{\\rho_v} - 1\\right) = 0.05(53.846 - 1) = 0.05(52.846) \\approx 2.6423\n$$\nFinally, compute the additional pressure drop:\n$$\n\\Delta p_{add} = 2.6423 \\times \\Delta p_{\\ell} \\approx 2.6423 \\times 29456\\,\\mathrm{Pa} \\approx 77833\\,\\mathrm{Pa}\n$$\nThe problem requires the answer in kilopascals, rounded to three significant figures.\n$$\n\\Delta p_{add} = 77.833\\,\\mathrm{kPa} \\approx 77.8\\,\\mathrm{kPa}\n$$",
            "answer": "$$\n\\boxed{77.8}\n$$"
        },
        {
            "introduction": "Effective energy systems analysis requires scaling up from individual component models to integrated network-level assessments. This practice bridges that gap by modeling a simplified hydrogen transmission network consisting of pipelines and a compressor, tasked with meeting a variable daily demand. By combining linearized flow laws with a thermodynamic model of compressor power, you will develop an optimal control strategy to minimize the total energy consumption over a $24$-hour horizon, demonstrating a core task in energy infrastructure planning and operation .",
            "id": "4096343",
            "problem": "Consider a serial hydrogen transmission network over a twenty-four ($24$) hour horizon with nodes $\\{n_0,n_1,n_2,n_3\\}$ and edges $\\{e_1,e_2,e_3\\}$ oriented $n_0\\to n_1\\to n_2\\to n_3$. Edge $e_1$ is a pipeline from $n_0$ to $n_1$, edge $e_2$ is a compressor from $n_1$ to $n_2$, and edge $e_3$ is a pipeline from $n_2$ to $n_3$. The source node $n_0$ has fixed pressure $p_0$, the demand node $n_3$ must maintain a pressure not below $p_{\\min}$, and intermediate node pressures $p_1(t)$ and $p_2(t)$ are determined by flows and compressor set points. The hydrogen mass flow on edge $e$ at time $t$ is denoted $\\dot{m}_e(t)$, and the end-use demand at node $n_3$ is denoted $\\dot{m}_{\\mathrm{dem}}(t)$.\n\nFundamental laws and modeling assumptions:\n- Nodal continuity is enforced via the incidence matrix $A\\in\\mathbb{R}^{4\\times 3}$ so that $A\\,\\dot{m}(t)=d(t)$ for each hour $t$, where $\\dot{m}(t)=\\begin{bmatrix}\\dot{m}_{e_1}(t)&\\dot{m}_{e_2}(t)&\\dot{m}_{e_3}(t)\\end{bmatrix}^{\\top}$ and $d(t)=\\begin{bmatrix}-\\dot{m}_{\\mathrm{dem}}(t)&0&0&+\\dot{m}_{\\mathrm{dem}}(t)\\end{bmatrix}^{\\top}$. The oriented incidence matrix for the chain is\n$$\nA=\\begin{bmatrix}\n-1 & 0 & 0\\\\\n+1 & -1 & 0\\\\\n0 & +1 & -1\\\\\n0 & 0 & +1\n\\end{bmatrix}.\n$$\n- Linearized steady-state pipeline flow laws (a first-order approximation of the momentum balance under turbulent but quasi-steady conditions) give\n$$\n\\dot{m}_{e}(t)=K_e\\left(p_{\\mathrm{in},e}(t)-p_{\\mathrm{out},e}(t)\\right),\n$$\nfor edges $e\\in\\{e_1,e_3\\}$ with conductances $K_e$ in $\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$ and pressures in $\\mathrm{Pa}$.\n- The compressor on $e_2$ enforces\n$$\np_2(t)=r(t)\\,p_1(t),\\quad r(t)\\geq 1,\n$$\nwith mass conservation across the compressor $\\dot{m}_{e_2}(t)=\\dot{m}_{e_1}(t)=\\dot{m}_{e_3}(t)$.\n- Isentropic compression power for hydrogen with ideal-gas behavior is modeled as\n$$\nP(t)=\\frac{\\dot{m}(t)\\,c_p\\,T_{\\mathrm{in}}}{\\eta}\\left(r(t)^{\\frac{\\gamma-1}{\\gamma}}-1\\right),\n$$\nwhere $\\gamma$ is the ratio of specific heats, $c_p$ is the specific heat at constant pressure, $T_{\\mathrm{in}}$ is inlet temperature, and $\\eta$ is compressor isentropic efficiency.\n\nFrom the nodal continuity and edge orientation, the chain incidence implies $\\dot{m}_{e_1}(t)=\\dot{m}_{e_2}(t)=\\dot{m}_{e_3}(t)=\\dot{m}(t)=\\dot{m}_{\\mathrm{dem}}(t)$ for all $t$. The upstream pipeline relation gives\n$$\np_1(t)=p_0-\\frac{\\dot{m}(t)}{K_1}.\n$$\nThe downstream pipeline relation and pressure requirement at $n_3$ lead to\n$$\n\\dot{m}(t)=K_2\\big(p_2(t)-p_3(t)\\big)=K_2\\big(r(t)\\,p_1(t)-p_3(t)\\big),\\quad p_3(t)\\geq p_{\\min}.\n$$\nBecause the compressor power $P(t)$ is strictly increasing in $r(t)$ for $r(t)\\geq 1$, the energy-minimizing set point $r(t)$ that still meets the demand chooses the smallest $r(t)$ consistent with the downstream pipeline and pressure constraint. If the minimum pressure is binding, this yields the required ratio\n$$\nr_{\\mathrm{req}}(t)=\\frac{\\frac{\\dot{m}(t)}{K_2}+p_{\\min}}{p_1(t)}.\n$$\nTherefore, the optimal compressor set point at hour $t$ is\n$$\nr^{\\star}(t)=\\max\\left(1,\\,\\min\\left(r_{\\max},\\,r_{\\mathrm{req}}(t)\\right)\\right),\n$$\nprovided feasibility holds, which requires $p_1(t)>0$ and $r_{\\mathrm{req}}(t)\\leq r_{\\max}$. If $r_{\\mathrm{req}}(t)\\leq 1$, then $r^{\\star}(t)=1$ and the downstream pressure adjusts to $p_3(t)=r^{\\star}(t)p_1(t)-\\dot{m}(t)/K_2\\geq p_{\\min}$; if $r_{\\mathrm{req}}(t)>r_{\\max}$ or $p_1(t)\\leq 0$, the hour is infeasible under the given limits.\n\nTask: Implement a program that, for each hour $t\\in\\{1,\\dots,24\\}$ and each test case, computes $r^{\\star}(t)$, the compressor power $P(t)$, and the total compressor energy over $24$ hours in megawatt-hour ($\\mathrm{MWh}$). The total energy in $\\mathrm{MWh}$ for a case is\n$$\nE_{\\mathrm{MWh}}=\\sum_{t=1}^{24}\\frac{P(t)}{10^{6}}.\n$$\nIf any hour in a test case is infeasible, the program must return $-1.0$ for that case.\n\nPhysical constants and parameters (common to all test cases):\n- $\\gamma=1.41$,\n- $c_p=14300\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$,\n- $T_{\\mathrm{in}}=300\\,\\mathrm{K}$,\n- $\\eta=0.70$,\n- $p_0=7.0\\times 10^{6}\\,\\mathrm{Pa}$,\n- $p_{\\min}=2.0\\times 10^{6}\\,\\mathrm{Pa}$,\n- $K_1=5.0\\times 10^{-8}\\,\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$,\n- $K_2=4.0\\times 10^{-8}\\,\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$,\n- $r_{\\max}=2.5$.\n\nTest suite:\n- Test case $1$ (general case): hourly demands $\\dot{m}_{\\mathrm{dem}}(t)$ in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.08,\\,0.08,\\,0.09,\\,0.09,\\,0.10,\\,0.12,\\,0.15,\\,0.18,\\,0.20,\\,0.18,\\,0.15,\\,0.12,\\,0.10,\\,0.09,\\,0.08,\\,0.08,\\,0.09,\\,0.12,\\,0.15,\\,0.18,\\,0.20,\\,0.18,\\,0.12,\\,0.10\\,\\big].\n$$\n- Test case $2$ (boundary low flow): hourly demands in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02\\,\\big].\n$$\n- Test case $3$ (infeasible high flow): hourly demands in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25\\,\\big].\n$$\n\nRequired final output format: Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, for example $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$. Each entry must be a floating-point number representing total energy in $\\mathrm{MWh}$ for the corresponding test case, with the convention that infeasible cases are reported as $-1.0$.",
            "solution": "The objective is to compute the total energy consumed by a hydrogen compressor in a serial transmission network over a $24$-hour period for three distinct hourly demand scenarios. The calculation proceeds by analyzing the system's state at each hour, checking for operational feasibility, and then determining the energy-optimal compressor setting.\n\nThe methodology for each test case involves a sequential, hour-by-hour analysis. For each hour $t \\in \\{1, \\dots, 24\\}$, given the mass demand $\\dot{m}_{\\mathrm{dem}}(t)$:\n\n1.  **Mass Flow Uniformity**: The problem describes a serial network ($n_0 \\to n_1 \\to n_2 \\to n_3$) with no intermediate storage. The principle of mass conservation dictates that the mass flow rate must be constant along all edges. Therefore, the flow through each component is equal to the end-use demand:\n    $$\n    \\dot{m}(t) = \\dot{m}_{\\mathrm{dem}}(t).\n    $$\n\n2.  **Compressor Inlet Pressure**: The pressure at the compressor inlet, $p_1(t)$, is determined by the pressure drop across the upstream pipeline ($e_1$). Applying the provided linearized flow law, we solve for $p_1(t)$:\n    $$\n    \\dot{m}(t) = K_1 \\left( p_0 - p_1(t) \\right) \\implies p_1(t) = p_0 - \\frac{\\dot{m}(t)}{K_1}.\n    $$\n    A fundamental feasibility condition is that pressure must remain positive, $p_1(t) > 0$. If this is not met, the demand is physically impossible, and the scenario is infeasible.\n\n3.  **Required Compression Ratio**: To minimize energy, the compressor should operate at the lowest possible ratio $r(t)$ that satisfies all constraints. The critical constraint is maintaining the final pressure $p_3(t) \\geq p_{\\min}$. The energy-optimal strategy sets $p_3(t) = p_{\\min}$. Using the flow law for the downstream pipeline ($e_3$) and the compressor relation $p_2(t) = r(t)p_1(t)$, we derive the required ratio, $r_{\\mathrm{req}}(t)$:\n    $$\n    \\dot{m}(t) = K_2 \\left( p_2(t) - p_3(t) \\right) = K_2 \\left( r(t)p_1(t) - p_{\\min} \\right).\n    $$\n    Solving for $r(t)$ gives the required ratio for this binding condition:\n    $$\n    r_{\\mathrm{req}}(t) = \\frac{\\frac{\\dot{m}(t)}{K_2} + p_{\\min}}{p_1(t)}.\n    $$\n\n4.  **Operational Feasibility Check**: The compressor is limited by a maximum ratio, $r_{\\max}$. If $r_{\\mathrm{req}}(t) > r_{\\max}$, the system cannot meet the demand. This, along with $p_1(t) > 0$, forms the core feasibility check for each hour.\n\n5.  **Optimal Compressor Set Point**: The actual operating ratio, $r^{\\star}(t)$, must be at least $1$, must meet the system requirement (be at least $r_{\\mathrm{req}}(t)$ if needed), and cannot exceed $r_{\\max}$. The problem provides the logic for the optimal ratio:\n    $$\n    r^{\\star}(t) = \\max\\left(1, \\min\\left(r_{\\max}, r_{\\mathrm{req}}(t)\\right)\\right).\n    $$\n    For a feasible hour, this simplifies to $r^{\\star}(t) = \\max(1, r_{\\mathrm{req}}(t))$. If $r_{\\mathrm{req}}(t) \\leq 1$, no compression is needed, so $r^{\\star}(t)=1$.\n\n6.  **Hourly Power Consumption**: The power $P(t)$ in Watts for the compressor at set point $r^{\\star}(t)$ is calculated using the given formula:\n    $$\n    P(t) = \\frac{\\dot{m}(t) c_p T_{\\mathrm{in}}}{\\eta} \\left( (r^{\\star}(t))^{\\frac{\\gamma-1}{\\gamma}} - 1 \\right).\n    $$\n    If $r^{\\star}(t)=1$, the term in parentheses becomes zero, and thus $P(t)=0$.\n\n7.  **Total Energy Calculation**: The problem uses discrete one-hour time steps. The total energy in Watt-hours is the sum of the hourly power values: $E_{\\mathrm{Wh}} = \\sum_{t=1}^{24} P(t)$. To express this in Megawatt-hours (MWh), we divide by $10^6$:\n    $$\n    E_{\\mathrm{MWh}} = \\frac{\\sum_{t=1}^{24} P(t)}{10^6}.\n    $$\n    If any hour is found to be infeasible, the calculation for that test case terminates, and the total energy is reported as $-1.0$.\n\nThis step-by-step procedure is implemented in the provided code for each test case to arrive at the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the total compressor energy for hydrogen transmission\n    over a 24-hour horizon for multiple test cases.\n    \"\"\"\n    # Define physical constants and system parameters\n    gamma = 1.41  # Ratio of specific heats for H2\n    c_p = 14300.0  # Specific heat at constant pressure [J/(kg*K)]\n    T_in = 300.0  # Compressor inlet temperature [K]\n    eta = 0.70  # Compressor isentropic efficiency\n    p_0 = 7.0e6  # Source pressure [Pa]\n    p_min = 2.0e6  # Minimum delivery pressure [Pa]\n    K1 = 5.0e-8  # Conductance of pipeline e1 [kg/(s*Pa)]\n    K2 = 4.0e-8  # Conductance of pipeline e2 [kg/(s*Pa)]\n    r_max = 2.5  # Maximum compression ratio\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Test case 1 (general case)\n        np.array([\n            0.08, 0.08, 0.09, 0.09, 0.10, 0.12, 0.15, 0.18, 0.20, 0.18,\n            0.15, 0.12, 0.10, 0.09, 0.08, 0.08, 0.09, 0.12, 0.15, 0.18,\n            0.20, 0.18, 0.12, 0.10\n        ]),\n        # Test case 2 (boundary low flow)\n        np.array([0.02] * 24),\n        # Test case 3 (infeasible high flow)\n        np.array([0.25] * 24),\n    ]\n\n    results = []\n    \n    # Pre-calculate terms for power calculation\n    power_exponent = (gamma - 1) / gamma\n    power_coeff = (c_p * T_in) / eta\n\n    for m_dem_profile in test_cases:\n        total_power_Wh = 0.0\n        is_infeasible = False\n        \n        for t in range(24):\n            m_dot = m_dem_profile[t]  # Mass flow rate for the current hour [kg/s]\n\n            # Step 1: Calculate compressor inlet pressure\n            p1 = p_0 - (m_dot / K1)\n\n            # Step 2: Feasibility Check 1 (inlet pressure)\n            if p1 = 0:\n                is_infeasible = True\n                break\n\n            # Step 3: Calculate required compression ratio\n            r_req = ((m_dot / K2) + p_min) / p1\n\n            # Step 4: Feasibility Check 2 (maximum ratio)\n            if r_req > r_max:\n                is_infeasible = True\n                break\n\n            # Step 5: Determine optimal compressor set point\n            # Per problem: r_star = max(1, min(r_max, r_req))\n            # Since feasibility check r_req = r_max has passed, this simplifies.\n            r_star = max(1.0, r_req)\n            \n            # Step 6: Calculate hourly power consumption in Watts\n            # P(t) = (m_dot * c_p * T_in / eta) * (r_star^((gamma-1)/gamma) - 1)\n            if r_star > 1.0:\n                power_W = m_dot * power_coeff * (r_star**power_exponent - 1.0)\n            else:\n                power_W = 0.0\n            \n            # The sum of powers in Watts gives total energy in Watt-hours\n            # for 1-hour time intervals.\n            total_power_Wh += power_W\n\n        if is_infeasible:\n            results.append(-1.0)\n        else:\n            # Step 7: Convert total energy from Watt-hours to Megawatt-hours\n            total_energy_MWh = total_power_Wh / 1e6\n            results.append(total_energy_MWh)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}