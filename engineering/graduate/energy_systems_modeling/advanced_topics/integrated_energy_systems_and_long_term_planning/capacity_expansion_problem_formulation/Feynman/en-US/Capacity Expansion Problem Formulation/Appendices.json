{
    "hands_on_practices": [
        {
            "introduction": "Before we can optimize investment decisions, we must first accurately model the physical system itself. This exercise focuses on the fundamental stock-and-flow accounting of generation capacity, introducing crucial concepts like investment lead times and retirements that govern how a power system's physical assets evolve. Mastering this dynamic representation is the essential first step in building any credible long-term energy model .",
            "id": "4074258",
            "problem": "Consider a single-technology capacity expansion model for Combined Cycle Gas Turbine (CCGT). The total installed capacity is treated as a stock that evolves through commissioning of new builds after a construction lead time and through retirements from the stock. The lead time is two years, meaning an investment decision made in year $t$ becomes operational in year $t+L$ where $L=2$. The model tracks the annual investment decision variable $I_{t}$ (measured in megawatts) and the annual retirement variable $R_{t}$ (measured in megawatts). Assume the following are given and scientifically plausible:\n\n- The initial installed capacity stock at the end of year $2019$ is $K_{2019} = 600$ megawatts.\n- The lead time is $L=2$ years, so commissioning in year $t$ equals $I_{t-L}$.\n- Investment decisions by year: $I_{2017}=40$, $I_{2018}=30$, $I_{2019}=50$, $I_{2020}=100$, $I_{2021}=0$, $I_{2022}=200$, $I_{2023}=150$, $I_{2024}=50$, $I_{2025}=0$, $I_{2026}=100$ (all in megawatts).\n- Retirement decisions by year: $R_{2020}=40$, $R_{2021}=20$, $R_{2022}=0$, $R_{2023}=0$, $R_{2024}=80$, $R_{2025}=0$, $R_{2026}=30$, $R_{2027}=0$, $R_{2028}=70$ (all in megawatts).\n\nStarting from first principles of stock-flow consistency in capacity expansion models, derive the recursive stock evolution that aggregates vintages and accounts for lead times, and use it to compute the total installed CCGT capacity $K_{2028}$. Express the final numerical answer in megawatts. No rounding is required; report the exact integer value.",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in energy systems modeling that is self-contained and free of contradictions.\n\nThe first principle of stock-flow consistency states that the stock of a quantity at the end of a period is equal to the stock at the beginning of the period plus all inflows minus all outflows during the period. In this context, the stock is the total installed capacity of Combined Cycle Gas Turbine (CCGT) plants, denoted by $K_t$ (in megawatts) at the end of year $t$. The inflows are the newly commissioned capacities, and the outflows are the retired capacities.\n\nThe stock evolution can be expressed as:\n$$K_t = K_{t-1} + \\text{Commissioning}_t - \\text{Retirements}_t$$\nwhere $K_{t-1}$ is the installed capacity at the end of the previous year, $\\text{Commissioning}_t$ is the capacity that becomes operational in year $t$, and $\\text{Retirements}_t$ is the capacity that is decommissioned in year $t$.\n\nThe problem states that investment decisions, denoted by $I_t$, have a construction lead time of $L=2$ years. This means an investment decision $I_{t-L}$ made in year $t-L$ results in a new capacity, or commissioning, in year $t$. Therefore, we have:\n$$\\text{Commissioning}_t = I_{t-L} = I_{t-2}$$\nThe retirements in year $t$ are given by the variable $R_t$.\n\nSubstituting these into the stock-flow equation gives the recursive formula for the capacity stock evolution:\n$$K_t = K_{t-1} + I_{t-2} - R_t$$\nThis is the recursive stock evolution equation requested.\n\nTo compute the total installed capacity at the end of year $2028$, $K_{2028}$, starting from the given initial capacity at the end of year $2019$, $K_{2019}$, we can apply this recursive formula for each year from $t=2020$ to $t=2028$. A more direct method is to recognize that the total change in capacity is the sum of all net changes over the period. By unrolling the recursion, we get:\n$$K_{2028} = K_{2019} + \\sum_{t=2020}^{2028} (K_t - K_{t-1})$$\nSubstituting the expression for the annual change, $(K_t - K_{t-1}) = I_{t-2} - R_t$, we obtain:\n$$K_{2028} = K_{2019} + \\sum_{t=2020}^{2028} (I_{t-2} - R_t)$$\nThis can be separated into the sum of all commissions and the sum of all retirements over the period:\n$$K_{2028} = K_{2019} + \\left( \\sum_{t=2020}^{2028} I_{t-2} \\right) - \\left( \\sum_{t=2020}^{2028} R_t \\right)$$\n\nWe are given the initial capacity $K_{2019} = 600$ megawatts.\nFirst, we calculate the total commissioned capacity from the beginning of $2020$ to the end of $2028$. The summation index for the investment variable $I$ runs from $(2020-2)=2018$ to $(2028-2)=2026$.\n$$ \\sum_{t=2020}^{2028} I_{t-2} = I_{2018} + I_{2019} + I_{2020} + I_{2021} + I_{2022} + I_{2023} + I_{2024} + I_{2025} + I_{2026} $$\nUsing the provided data for investment decisions (in megawatts):\n$$ \\sum_{t=2020}^{2028} I_{t-2} = 30 + 50 + 100 + 0 + 200 + 150 + 50 + 0 + 100 = 680 $$\n\nNext, we calculate the total retired capacity from the beginning of $2020$ to the end of $2028$.\n$$ \\sum_{t=2020}^{2028} R_t = R_{2020} + R_{2021} + R_{2022} + R_{2023} + R_{2024} + R_{2025} + R_{2026} + R_{2027} + R_{2028} $$\nUsing the provided data for retirement decisions (in megawatts):\n$$ \\sum_{t=2020}^{2028} R_t = 40 + 20 + 0 + 0 + 80 + 0 + 30 + 0 + 70 = 240 $$\n\nFinally, we substitute the initial capacity and the calculated total commissions and retirements into the equation for $K_{2028}$:\n$$ K_{2028} = 600 + 680 - 240 $$\n$$ K_{2028} = 1280 - 240 $$\n$$ K_{2028} = 1040 $$\nThe total installed CCGT capacity at the end of year $2028$ is $1040$ megawatts.",
            "answer": "$$\\boxed{1040}$$"
        },
        {
            "introduction": "With a grasp of physical system dynamics, the next step is to evaluate the economic consequences of investment decisions over time. This practice introduces the concept of Net Present Cost (NPC), a cornerstone of engineering economics that enables the fair comparison of costs incurred at different points in time. You will apply discounting principles and learn to account for the salvage value of assets at the end of a planning horizon, a critical detail in finite-horizon optimization .",
            "id": "4074209",
            "problem": "A system planner is formulating a multi-year capacity expansion plan over a finite planning horizon of $T = 7$ years for a regional power system. The planner must evaluate the net present cost of an investment stream consisting only of capital expenditure cash flows for three assets, using end-of-year discrete discounting with a constant real annual discount rate $r = 0.07$. All cash flows are in real United States dollars (USD). The three assets, their payment schedules, commissioning timing, and economic lives are:\n- Asset $\\mathcal{A}$ (battery energy storage): capital expenditures of $\\$60$ million at year $t=0$ and $\\$60$ million at year $t=1$, with commissioning at the end of year $t=1$ and economic life of $L_{\\mathcal{A}} = 10$ years.\n- Asset $\\mathcal{B}$ (onshore wind farm): capital expenditures of $\\$90$ million at year $t=2$ and $\\$90$ million at year $t=3$, with commissioning at the end of year $t=3$ and economic life of $L_{\\mathcal{B}} = 25$ years.\n- Asset $\\mathcal{C}$ (transmission upgrade): a single capital expenditure of $\\$50$ million at year $t=5$, with commissioning at the end of year $t=5$ and economic life of $L_{\\mathcal{C}} = 40$ years.\n\nAt the end of the planning horizon (the end of year $t=7$), each asset retains a salvage value that must be treated as a cash inflow. Salvage value is defined as the undepreciated book value under straight-line depreciation, where straight-line depreciation assigns equal annual depreciation charges over the economic life, starting at commissioning. The undepreciated book value at the end of the horizon is determined by the remaining book life relative to the economic life. Ignore any operating expenditures, taxes, inflation, and decommissioning costs.\n\nStarting from first principles of time value of money and the straight-line depreciation concept, compute the net present cost of the investment stream, defined as the present value of all capital expenditures minus the present value of all salvage inflows at $t=7$, discounted to $t=0$ using $r = 0.07$. Express the final value in million United States dollars (USD), and round your answer to four significant figures.",
            "solution": "The problem statement is a well-posed problem in engineering economics, specifically applied to energy system capacity expansion. All necessary data, definitions, and boundary conditions are provided, and they are self-consistent and scientifically grounded. The problem is valid.\n\nThe objective is to compute the Net Present Cost (NPC) of a stream of investments. The NPC is defined as the present value of all cash outflows (capital expenditures) minus the present value of all cash inflows (salvage values). The discounting is performed to time $t=0$ using a discrete annual discount rate $r$. The formula for the present value (PV) of a future cash flow $F_t$ occurring at the end of year $t$ is:\n$$ PV(F_t) = \\frac{F_t}{(1+r)^t} $$\nThe total NPC is therefore:\n$$ NPC = PV(\\text{Capital Expenditures}) - PV(\\text{Salvage Inflows}) $$\n\nThe calculation is performed in three parts:\n1.  Compute the Present Value of Capital Expenditures (PVC).\n2.  Compute the Salvage Value (SV) of each asset at the end of the planning horizon, $T=7$, and then find the present value of these inflows (PVSV).\n3.  Compute the final NPC as $NPC = PVC - PVSV$.\n\nAll monetary values are in millions of United States dollars (USD). The given parameters are:\n- Planning horizon ends at $T=7$ years.\n- Discount rate $r = 0.07$.\n\n**Part 1: Present Value of Capital Expenditures (PVC)**\n\nThe capital expenditures are a series of cash outflows at specified years. Their total present value is the sum of the discounted values of each expenditure.\nLet $C_{\\mathcal{A},t}$, $C_{\\mathcal{B},t}$, and $C_{\\mathcal{C},t}$ be the capital expenditures for assets $\\mathcal{A}$, $\\mathcal{B}$, and $\\mathcal{C}$ at year $t$. The given expenditures are:\n- $C_{\\mathcal{A},0} = \\$60$ million at $t=0$.\n- $C_{\\mathcal{A},1} = \\$60$ million at $t=1$.\n- $C_{\\mathcal{B},2} = \\$90$ million at $t=2$.\n- $C_{\\mathcal{B},3} = \\$90$ million at $t=3$.\n- $C_{\\mathcal{C},5} = \\$50$ million at $t=5$.\n\nThe total PVC is calculated as:\n$$ PVC = \\frac{C_{\\mathcal{A},0}}{(1+r)^0} + \\frac{C_{\\mathcal{A},1}}{(1+r)^1} + \\frac{C_{\\mathcal{B},2}}{(1+r)^2} + \\frac{C_{\\mathcal{B},3}}{(1+r)^3} + \\frac{C_{\\mathcal{C},5}}{(1+r)^5} $$\nSubstituting the given values:\n$$ PVC = \\frac{60}{(1.07)^0} + \\frac{60}{(1.07)^1} + \\frac{90}{(1.07)^2} + \\frac{90}{(1.07)^3} + \\frac{50}{(1.07)^5} $$\n$$ PVC = 60 + 56.074766\\dots + 78.609486\\dots + 73.466809\\dots + 35.649530\\dots $$\n$$ PVC \\approx 303.800591 \\text{ million USD} $$\n\n**Part 2: Present Value of Salvage Inflows (PVSV)**\n\nThe salvage value for each asset is its undepreciated book value at the end of the planning horizon, $T=7$. Depreciation is straight-line and begins at commissioning.\nThe total capital cost for an asset $\\mathcal{I}$ is $C_{\\mathcal{I}}$. Its economic life is $L_{\\mathcal{I}}$ and it is commissioned at year $t_{c, \\mathcal{I}}$. The number of years the asset has been in service and depreciating by the end of year $T$ is $T - t_{c, \\mathcal{I}}$.\nThe salvage value, $SV_{\\mathcal{I},T}$, is the remaining book value, calculated as:\n$$ SV_{\\mathcal{I},T} = C_{\\mathcal{I}} \\times \\frac{\\text{Remaining Life}}{\\text{Economic Life}} = C_{\\mathcal{I}} \\times \\frac{L_{\\mathcal{I}} - (T - t_{c, \\mathcal{I}})}{L_{\\mathcal{I}}} $$\n\n- **Asset $\\mathcal{A}$:**\n  - Total Capital Cost: $C_{\\mathcal{A}} = 60 + 60 = 120$ million.\n  - Economic Life: $L_{\\mathcal{A}} = 10$ years.\n  - Commissioning: $t_{c, \\mathcal{A}} = 1$.\n  - Years in service by $T=7$: $7 - 1 = 6$ years.\n  - Salvage Value at $t=7$: $SV_{\\mathcal{A},7} = 120 \\times \\frac{10 - 6}{10} = 120 \\times \\frac{4}{10} = 48$ million.\n\n- **Asset $\\mathcal{B}$:**\n  - Total Capital Cost: $C_{\\mathcal{B}} = 90 + 90 = 180$ million.\n  - Economic Life: $L_{\\mathcal{B}} = 25$ years.\n  - Commissioning: $t_{c, \\mathcal{B}} = 3$.\n  - Years in service by $T=7$: $7 - 3 = 4$ years.\n  - Salvage Value at $t=7$: $SV_{\\mathcal{B},7} = 180 \\times \\frac{25 - 4}{25} = 180 \\times \\frac{21}{25} = 151.2$ million.\n\n- **Asset $\\mathcal{C}$:**\n  - Total Capital Cost: $C_{\\mathcal{C}} = 50$ million.\n  - Economic Life: $L_{\\mathcal{C}} = 40$ years.\n  - Commissioning: $t_{c, \\mathcal{C}} = 5$.\n  - Years in service by $T=7$: $7 - 5 = 2$ years.\n  - Salvage Value at $t=7$: $SV_{\\mathcal{C},7} = 50 \\times \\frac{40 - 2}{40} = 50 \\times \\frac{38}{40} = 47.5$ million.\n\nTotal salvage value at $t=7$ is the sum of the individual salvage values, which is treated as a single cash inflow at $t=7$.\n$$ SV_7 = SV_{\\mathcal{A},7} + SV_{\\mathcal{B},7} + SV_{\\mathcal{C},7} = 48 + 151.2 + 47.5 = 246.7 \\text{ million} $$\nThe present value of this salvage inflow (PVSV) is:\n$$ PVSV = \\frac{SV_7}{(1+r)^7} = \\frac{246.7}{(1.07)^7} $$\n$$ PVSV \\approx \\frac{246.7}{1.605781} \\approx 153.630560 \\text{ million USD} $$\n\n**Part 3: Final Net Present Cost (NPC)**\n\nThe NPC is the difference between the present value of costs and the present value of salvage inflows.\n$$ NPC = PVC - PVSV $$\n$$ NPC \\approx 303.800591 - 153.630560 = 150.170031 \\text{ million USD} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ NPC \\approx 150.2 \\text{ million USD} $$",
            "answer": "$$\\boxed{150.2}$$"
        },
        {
            "introduction": "This practice integrates the concepts of physical capacity and economic cost into a complete, though simplified, capacity expansion model. This hands-on coding exercise challenges you to formulate and solve a linear program to explore the fundamental trade-off between total system cost and carbon emissions. By generating a policy trade-off curve, you will gain practical experience in using these models for one of their most important applications: informing complex policy and investment decisions .",
            "id": "4074212",
            "problem": "You are to formulate and solve a capacity expansion problem for a simplified power system with two technologies. The objective is to compute a trade-off curve between total system cost and total emissions by varying either an emissions cap or a carbon price. The problem must be formulated from first principles and solved algorithmically as a linear program for each point on the curve. All physical units must be explicitly respected, and all outputs must be reported in the specified units, rounded to two decimals.\n\nFundamental base and modeling assumptions:\n- A single-region electricity system with annual energy demand of $E$ megawatt-hours per year (MWh/year).\n- Two generation technologies indexed by $i \\in \\{\\text{F}, \\text{R}\\}$ representing a fossil technology ($\\text{F}$) and a renewable technology ($\\text{R}$).\n- Decision variables: installed capacities $k_i$ in megawatts (MW) and annual generation $g_i$ in megawatt-hours (MWh).\n- Annual hours $H = 8760$ hours/year.\n- Capacity factor $0 \\leq \\text{CF}_i \\leq 1$ for each technology $i$, relating capacity to maximum annual generation via $g_i \\leq \\text{CF}_i \\cdot H \\cdot k_i$.\n- Annualized capacity cost $c_i^{\\text{cap}}$ in dollars per megawatt-year ($\\text{\\$/(MW}\\cdot\\text{year)}$) and variable operating cost $c_i^{\\text{var}}$ in dollars per megawatt-hour ($\\text{\\$/MWh}$).\n- Emissions intensity $e_i$ in metric tonnes of carbon dioxide per megawatt-hour ($\\text{tCO}_2/\\text{MWh}$).\n- Load balance: $\\sum_i g_i = E$.\n- Non-negativity: $k_i \\geq 0$, $g_i \\geq 0$.\n\nTwo problem variants must be solved repeatedly to trace trade-off curves:\n1. Emissions cap formulation: Minimize total annual system cost subject to an upper bound on total annual emissions,\n$$\n\\min_{k_i,g_i} \\sum_i \\left( c_i^{\\text{cap}} k_i + c_i^{\\text{var}} g_i \\right) \\quad \\text{subject to} \\quad \\sum_i g_i = E, \\; g_i \\leq \\text{CF}_i H k_i, \\; \\sum_i e_i g_i \\leq \\text{Cap}, \\; k_i,g_i \\geq 0,\n$$\nwhere $\\text{Cap}$ is the emissions cap in $\\text{tCO}_2/\\text{year}$.\n2. Carbon price formulation: Minimize total annual social cost including carbon pricing,\n$$\n\\min_{k_i,g_i} \\sum_i \\left( c_i^{\\text{cap}} k_i + c_i^{\\text{var}} g_i \\right) + \\tau \\sum_i e_i g_i \\quad \\text{subject to} \\quad \\sum_i g_i = E, \\; g_i \\leq \\text{CF}_i H k_i, \\; k_i,g_i \\geq 0,\n$$\nwhere $\\tau$ is the carbon price in dollars per tonne of carbon dioxide ($\\text{\\$/tCO}_2$).\n\nFor each problem instance, the unconstrained least-cost solution (no emissions cap and zero carbon price) must be computed first to determine the corresponding unconstrained emissions level, denoted $E_{\\text{unc}}$ in $\\text{tCO}_2/\\text{year}$. Then, for the emissions cap formulation, compute optimal solutions for a sweep of caps linearly spaced between $0$ and $E_{\\text{unc}}$, inclusive. For the carbon price formulation, compute optimal solutions for a specified set of carbon prices. For each solution, record the pair consisting of total emissions and total annual system cost.\n\nUnits and output requirements:\n- Emissions must be reported in metric tonnes of carbon dioxide per year ($\\text{tCO}_2/\\text{year}$).\n- Costs must be reported in dollars per year ($\\text{\\$/year}$).\n- Carbon prices must be in dollars per tonne of carbon dioxide ($\\text{\\$/tCO}_2$).\n- All numeric outputs must be rounded to two decimals.\n\nTest suite:\nCompute trade-off curves for the following three test cases. In each case, first compute $E_{\\text{unc}}$, then:\n- Emissions cap sweep: $6$ evenly spaced caps between $0$ and $E_{\\text{unc}}$ inclusive.\n- Carbon price sweep: prices $\\tau \\in \\{0, 25, 50, 100, 200, 400\\}$ in $\\text{\\$/tCO}_2$.\n\nCommon constant: $H=8760$ hours/year.\n\nTest case $1$ (happy path):\n- Demand $E = 5{,}000{,}000$ MWh/year.\n- Fossil technology ($\\text{F}$): $c_{\\text{F}}^{\\text{cap}} = 100{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{F}}^{\\text{var}} = 20$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{F}} = 0.9$, $e_{\\text{F}} = 0.6$ $\\text{tCO}_2/\\text{MWh}$.\n- Renewable technology ($\\text{R}$): $c_{\\text{R}}^{\\text{cap}} = 150{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{R}}^{\\text{var}} = 5$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{R}} = 0.4$, $e_{\\text{R}} = 0$ $\\text{tCO}_2/\\text{MWh}$.\n\nTest case $2$ (higher renewable capital intensity via lower capacity factor):\n- Demand $E = 2{,}000{,}000$ MWh/year.\n- Fossil technology ($\\text{F}$): $c_{\\text{F}}^{\\text{cap}} = 100{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{F}}^{\\text{var}} = 20$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{F}} = 0.9$, $e_{\\text{F}} = 0.6$ $\\text{tCO}_2/\\text{MWh}$.\n- Renewable technology ($\\text{R}$): $c_{\\text{R}}^{\\text{cap}} = 180{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{R}}^{\\text{var}} = 5$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{R}} = 0.25$, $e_{\\text{R}} = 0$ $\\text{tCO}_2/\\text{MWh}$.\n\nTest case $3$ (boundary case: zero demand):\n- Demand $E = 0$ MWh/year.\n- Fossil technology ($\\text{F}$): $c_{\\text{F}}^{\\text{cap}} = 100{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{F}}^{\\text{var}} = 20$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{F}} = 0.9$, $e_{\\text{F}} = 0.6$ $\\text{tCO}_2/\\text{MWh}$.\n- Renewable technology ($\\text{R}$): $c_{\\text{R}}^{\\text{cap}} = 150{,}000$ $\\text{\\$/(MW}\\cdot\\text{year)}$, $c_{\\text{R}}^{\\text{var}} = 5$ $\\text{\\$/MWh}$, $\\text{CF}_{\\text{R}} = 0.4$, $e_{\\text{R}} = 0$ $\\text{tCO}_2/\\text{MWh}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing, for each test case, two lists: the emissions-cap trade-off curve and the carbon-price trade-off curve. Each curve must be a list of pairs, with each pair given as $[\\text{emissions}, \\text{cost}]$ where emissions are in $\\text{tCO}_2/\\text{year}$ and cost is in $\\$/\\text{year}$, both rounded to two decimals.\n- The overall output must thus be a list with three elements (one per test case), where each element is a list of two elements: the first is the cap-sweep curve, and the second is the price-sweep curve. For example: $[[[[e_{11},c_{11}],[e_{12},c_{12}],\\dots],[[e'_{11},c'_{11}],[e'_{12},c'_{12}],\\dots]], \\dots ]$.",
            "solution": "The user problem has been validated and is determined to be a valid, well-posed scientific problem.\n\n### **1. Problem Formulation from First Principles**\n\nThe problem asks to find the minimum cost technology mix to meet an electricity demand $E$, subject to various constraints. The decision variables are the installed capacities $k_i$ [MW] and annual generation levels $g_i$ [MWh] for two technologies, fossil ($\\text{F}$) and renewable ($\\text{R}$).\n\nThe objective function to be minimized is the total annual system cost, which is the sum of annualized capital costs and variable operating costs:\n$$\n\\text{Cost} = \\sum_{i \\in \\{\\text{F,R}\\}} \\left( c_i^{\\text{cap}} k_i + c_i^{\\text{var}} g_i \\right)\n$$\nwhere $c_i^{\\text{cap}}$ is in [$\\text{\\$/(MW}\\cdot\\text{year)}$] and $c_i^{\\text{var}}$ is in [$\\text{\\$/MWh}$].\n\nThe constraints are:\n1.  **Load Balance**: The total generation must meet the annual demand $E$.\n    $$ \\sum_i g_i = g_{\\text{F}} + g_{\\text{R}} = E $$\n2.  **Capacity Constraint**: The annual generation from a technology is limited by its installed capacity $k_i$ and its capacity factor $\\text{CF}_i$. With $H=8760$ hours in a year, this is:\n    $$ g_i \\leq \\text{CF}_i \\cdot H \\cdot k_i \\quad \\text{for } i \\in \\{\\text{F,R}\\} $$\n3.  **Non-negativity**: All capacities and generation levels must be non-negative.\n    $$ k_i \\geq 0, \\quad g_i \\geq 0 $$\n\nSince capital costs $c_i^{\\text{cap}}$ are non-negative, a cost-minimizing solution will never build more capacity than is necessary. Thus, the capacity constraint can be treated as an equality for the required capacity: $k_i = g_i / (\\text{CF}_i \\cdot H)$. We can substitute this expression for $k_i$ into the objective function to eliminate the capacity variables:\n$$\n\\text{Cost} = \\sum_i \\left( c_i^{\\text{cap}} \\frac{g_i}{\\text{CF}_i \\cdot H} + c_i^{\\text{var}} g_i \\right) = \\sum_i g_i \\left( c_i^{\\text{var}} + \\frac{c_i^{\\text{cap}}}{\\text{CF}_i \\cdot H} \\right)\n$$\nThis allows us to define an *effective levelized cost of generation* for each technology, $C_i^{\\text{eff}}$, in units of [$\\text{\\$/MWh}$]:\n$$\nC_i^{\\text{eff}} \\equiv c_i^{\\text{var}} + \\frac{c_i^{\\text{cap}}}{\\text{CF}_i \\cdot H}\n$$\nThe optimization problem is now simplified to choosing the generation levels $g_F$ and $g_R$ to minimize the total effective cost, subject to the load balance and any additional policy constraints:\n$$\n\\min_{g_F, g_R} \\left( C_{\\text{F}}^{\\text{eff}} g_{\\text{F}} + C_{\\text{R}}^{\\text{eff}} g_{\\text{R}} \\right) \\quad \\text{s.t.} \\quad g_{\\text{F}} + g_{\\text{R}} = E, \\quad g_{\\text{F}}, g_{\\text{R}} \\geq 0\n$$\n\n### **2. Solving the Optimization Variants**\n\n#### **Unconstrained Least-Cost Solution**\nIn the absence of any emissions policies, the optimal strategy is to meet the entire demand $E$ using the technology with the lower effective cost $C_i^{\\text{eff}}$.\n- If $C_{\\text{F}}^{\\text{eff}} < C_{\\text{R}}^{\\text{eff}}$, the optimal solution is $g_{\\text{F}} = E$ and $g_{\\text{R}} = 0$.\n- If $C_{\\text{R}}^{\\text{eff}} \\leq C_{\\text{F}}^{\\text{eff}}$, the optimal solution is $g_{\\text{R}} = E$ and $g_{\\text{F}} = 0$. (In case of a tie, the cleaner technology is chosen.)\n\nThe total system cost is $C_{\\text{unc}} = C_{\\text{F}}^{\\text{eff}} g_{\\text{F}} + C_{\\text{R}}^{\\text{eff}} g_{\\text{R}}$ and the total unconstrained emissions are $E_{\\text{unc}} = e_{\\text{F}} g_{\\text{F}} + e_{\\text{R}} g_{\\text{R}}$.\n\n#### **Emissions Cap Formulation**\nAn additional constraint is added:\n$$ \\sum_i e_i g_i = e_{\\text{F}} g_{\\text{F}} + e_{\\text{R}} g_{\\text{R}} \\leq \\text{Cap} $$\nGiven that $e_{\\text{R}} = 0$ in all test cases, this simplifies to $e_{\\text{F}} g_{\\text{F}} \\leq \\text{Cap}$, which implies an upper limit on fossil generation: $g_{\\text{F}} \\leq \\text{Cap}/e_{\\text{F}}$.\nThe optimization problem for $g_F$ is:\n$$\n\\min_{g_F} \\left( (C_{\\text{F}}^{\\text{eff}} - C_{\\text{R}}^{\\text{eff}}) g_{\\text{F}} + C_{\\text{R}}^{\\text{eff}}E \\right) \\quad \\text{s.t.} \\quad 0 \\leq g_{\\text{F}} \\leq E \\quad \\text{and} \\quad g_{\\text{F}} \\leq \\frac{\\text{Cap}}{e_{\\text{F}}}\n$$\nThe solution depends on the relative costs:\n- If $C_{\\text{F}}^{\\text{eff}} < C_{\\text{R}}^{\\text{eff}}$, the term $(C_{\\text{F}}^{\\text{eff}} - C_{\\text{R}}^{\\text{eff}})$ is negative. To minimize the cost, we must maximize $g_{\\text{F}}$. The optimal value is thus $g_{\\text{F}} = \\min(E, \\text{Cap}/e_{\\text{F}})$.\n- If $C_{\\text{R}}^{\\text{eff}} \\leq C_{\\text{F}}^{\\text{eff}}$, the term is non-negative. To minimize cost, we must minimize $g_{\\text{F}}$. The optimal value is $g_{\\text{F}} = 0$. This solution is always feasible for any non-negative cap, as emissions would be $0$.\n\nOnce $g_{\\text{F}}$ is determined, $g_{\\text{R}} = E - g_{\\text{F}}$. The total cost and emissions are then calculated.\n\n#### **Carbon Price Formulation**\nThe objective function is modified to include a cost for emissions, where $\\tau$ is the carbon price [$\\text{\\$/tCO}_2$]:\n$$\n\\min \\sum_i \\left( c_i^{\\text{cap}} k_i + c_i^{\\text{var}} g_i \\right) + \\tau \\sum_i e_i g_i = \\min \\sum_i g_i \\left( C_i^{\\text{eff}} + \\tau e_i \\right)\n$$\nWe define a *carbon-adjusted effective cost* $\\tilde{C}_i^{\\text{eff}}(\\tau) = C_i^{\\text{eff}} + \\tau e_i$. The problem is then equivalent to the unconstrained case, but comparing $\\tilde{C}_{\\text{F}}^{\\text{eff}}(\\tau)$ and $\\tilde{C}_{\\text{R}}^{\\text{eff}}(\\tau)$.\n$$\n\\tilde{C}_{\\text{F}}^{\\text{eff}}(\\tau) = C_{\\text{F}}^{\\text{eff}} + \\tau e_{\\text{F}} \\quad \\text{and} \\quad \\tilde{C}_{\\text{R}}^{\\text{eff}}(\\tau) = C_{\\text{R}}^{\\text{eff}} + \\tau e_{\\text{R}} = C_{\\text{R}}^{\\text{eff}} \\quad (\\text{since } e_{\\text{R}}=0)\n$$\nThe cheaper technology is fossil fuel if $\\tilde{C}_{\\text{F}}^{\\text{eff}}(\\tau) < \\tilde{C}_{\\text{R}}^{\\text{eff}}(\\tau)$, which means $C_{\\text{F}}^{\\text{eff}} + \\tau e_{\\text{F}} < C_{\\text{R}}^{\\text{eff}}$. This inequality defines a breakeven or *switch price*, $\\tau_{\\text{switch}}$:\n$$\n\\tau_{\\text{switch}} = \\frac{C_{\\text{R}}^{\\text{eff}} - C_{\\text{F}}^{\\text{eff}}}{e_{\\text{F}}}\n$$\n- If the unconstrained fossil option is cheaper ($C_{\\text{F}}^{\\text{eff}} < C_{\\text{R}}^{\\text{eff}}$), then $\\tau_{\\text{switch}} > 0$. For any given price $\\tau$:\n    - If $\\tau < \\tau_{\\text{switch}}$, fossil remains cheaper overall, so $g_{\\text{F}} = E, g_{\\text{R}} = 0$.\n    - If $\\tau \\geq \\tau_{\\text{switch}}$, renewable becomes cost-competitive or cheaper, so $g_{\\text{F}} = 0, g_{\\text{R}} = E$.\n- If the unconstrained renewable option is cheaper or equal ($C_{\\text{R}}^{\\text{eff}} \\leq C_{\\text{F}}^{\\text{eff}}$), then $\\tau_{\\text{switch}} \\leq 0$. For any non-negative price $\\tau$, renewable remains the cheaper option, so $g_{\\text{F}} = 0, g_{\\text{R}} = E$.\n\nFor each point, we report the *system cost* $\\sum_i C_i^{\\text{eff}} g_i$ and the emissions $\\sum_i e_i g_i$. The carbon tax component $\\tau \\sum_i e_i g_i$ is part of the objective function for decision-making but not part of the final reported system cost.\n\n### **3. Algorithmic Implementation**\n\nFor each test case, the algorithm proceeds as follows:\n1.  Calculate $C_{\\text{F}}^{\\text{eff}}$ and $C_{\\text{R}}^{\\text{eff}}$.\n2.  Solve the unconstrained case to find the generation mix and the unconstrained emissions level $E_{\\text{unc}}$.\n3.  **Emissions Cap Sweep**:\n    - Generate an array of $6$ emission caps from $0$ to $E_{\\text{unc}}$.\n    - For each `Cap`, calculate the optimal $g_{\\text{F}}$ and $g_{\\text{R}}$ using the derived logic.\n    - Compute and store the resulting system cost and emissions.\n4.  **Carbon Price Sweep**:\n    - Calculate $\\tau_{\\text{switch}}$.\n    - For each provided carbon price `tau`, compare it to $\\tau_{\\text{switch}}$ to determine the optimal $g_{\\text{F}}$ and $g_{\\text{R}}$.\n    - Compute and store the resulting system cost and emissions.\n5.  All numerical results for cost and emissions are rounded to two decimal places for reporting.\n6. A special formatting function is used to convert the nested list structure into the required string format without whitespace.",
            "answer": "```python\nimport numpy as np\n\ndef format_list(l):\n    \"\"\"\n    Recursively formats a nested list into a string representation\n    without spaces, with floats formatted to two decimal places.\n    \"\"\"\n    if isinstance(l, (int, float)):\n        return f\"{l:.2f}\"\n    if isinstance(l, list):\n        return f\"[{','.join(format_list(item) for item in l)}]\"\n    return str(l)\n\ndef solve_case(params):\n    \"\"\"\n    Solves a single capacity expansion problem instance for both sweeps.\n    \"\"\"\n    E, c_F_cap, c_F_var, CF_F, e_F, c_R_cap, c_R_var, CF_R, e_R, caps_n, prices = params\n    H = 8760.0\n\n    # Handle the zero-demand boundary case\n    if E == 0:\n        zero_point = [0.00, 0.00]\n        cap_curve = [zero_point] * caps_n\n        price_curve = [zero_point] * len(prices)\n        return [cap_curve, price_curve]\n\n    # Calculate effective levelized costs ($/MWh)\n    # C_eff = c_var + c_cap / (CF * H)\n    C_F_eff = c_F_var + c_F_cap / (CF_F * H) if CF_F > 0 else float('inf')\n    C_R_eff = c_R_var + c_R_cap / (CF_R * H) if CF_R > 0 else float('inf')\n\n    # Unconstrained solution to find E_unc\n    if C_F_eff < C_R_eff:\n        g_F_unc, g_R_unc = E, 0.0\n    else: # Choose cleaner tech in a tie\n        g_F_unc, g_R_unc = 0.0, E\n    \n    E_unc = e_F * g_F_unc + e_R * g_R_unc\n\n    # --- Emissions Cap Sweep ---\n    caps = np.linspace(0, E_unc, caps_n)\n    cap_curve = []\n    for cap in caps:\n        g_F, g_R = 0.0, 0.0\n        # Given e_R = 0, the constraint e_F*g_F + e_R*g_R <= cap becomes g_F <= cap / e_F\n        g_F_max_by_cap = cap / e_F if e_F > 0 else float('inf')\n\n        if C_F_eff < C_R_eff:\n            # Fossil is cheaper, use as much as cap allows\n            g_F = min(E, g_F_max_by_cap)\n            g_R = E - g_F\n        else:\n            # Renewable is cheaper, use it exclusively\n            g_F = 0.0\n            g_R = E\n\n        cost = g_F * C_F_eff + g_R * C_R_eff\n        emissions = e_F * g_F + e_R * g_R\n        cap_curve.append([emissions, cost])\n\n    # --- Carbon Price Sweep ---\n    # tau_switch is the price at which carbon-adjusted costs are equal\n    # C_F_eff + tau * e_F = C_R_eff + tau * e_R\n    # tau = (C_R_eff - C_F_eff) / (e_F - e_R)\n    if e_F > e_R:\n        tau_switch = (C_R_eff - C_F_eff) / (e_F - e_R)\n    else:\n        # If fossil is not more emitting, it's always preferred if cheaper,\n        # or never if more expensive. No switch is possible with positive tau.\n        tau_switch = float('inf') if C_F_eff < C_R_eff else -1.0\n\n    price_curve = []\n    for tau in prices:\n        g_F, g_R = 0.0, 0.0\n        # Compare carbon-adjusted effective costs\n        if C_F_eff + tau * e_F < C_R_eff + tau * e_R:\n            g_F, g_R = E, 0.0\n        else: # Choose cleaner tech in a tie\n            g_F, g_R = 0.0, E\n\n        cost = g_F * C_F_eff + g_R * C_R_eff\n        emissions = e_F * g_F + e_R * g_R\n        price_curve.append([emissions, cost])\n        \n    return [cap_curve, price_curve]\n\n\ndef solve():\n    test_cases = [\n        # Test case 1\n        (5000000.0, 100000.0, 20.0, 0.9, 0.6, 150000.0, 5.0, 0.4, 0.0, 6, [0, 25, 50, 100, 200, 400]),\n        # Test case 2\n        (2000000.0, 100000.0, 20.0, 0.9, 0.6, 180000.0, 5.0, 0.25, 0.0, 6, [0, 25, 50, 100, 200, 400]),\n        # Test case 3\n        (0.0, 100000.0, 20.0, 0.9, 0.6, 150000.0, 5.0, 0.4, 0.0, 6, [0, 25, 50, 100, 200, 400]),\n    ]\n\n    all_results = []\n    for case_params in test_cases:\n        case_result = solve_case(case_params)\n        all_results.append(case_result)\n\n    # Format the final output string as requested\n    print(format_list(all_results))\n\nsolve()\n```"
        }
    ]
}