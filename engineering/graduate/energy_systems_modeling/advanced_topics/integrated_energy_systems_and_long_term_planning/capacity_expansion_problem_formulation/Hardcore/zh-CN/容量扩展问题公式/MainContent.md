## 引言
在向可持续、可靠且经济的未来能源系统转型的过程中，决策者面临着一个核心挑战：如何在数十年的时间尺度上做出最优的长期投资决策？这些决策——例如投资何种发电技术、建在何处、何时建设——将锁定未来数十年的系统结构和成本，其影响深远。为了应对这一高度复杂的规划问题，我们需要一个系统化、定量的分析框架。容量扩张模型（Capacity Expansion Models）正是为此而生，它通过严谨的数学优化方法，为能源系统的长期演化路径提供科学依据。

本文旨在全面阐述构建此类模型的理论、方法与实践。读者将踏上一段从基础到前沿的建模之旅：
*   在**原则与机制**一章，我们将从零开始，学习构建一个容量扩张优化问题的核心构件，包括决策变量、[目标函数](@entry_id:267263)和关键约束，并掌握处理时空维度和技术细节的建模技巧。
*   接下来，在**应用与跨学科连接**一章，我们将探索如何将基础模型扩展应用于真实世界，包括对储能、水电等具体技术的精细化建模，考虑电网约束下的系统规划，以及评估[碳定价](@entry_id:1122075)等关键政策的影响。
*   最后，在**动手实践**部分，您将有机会通过解决具体的建模问题，将理论知识转化为实践技能。

通过本文的学习，您将掌握能源系统容量[扩张问题](@entry_id:150521)建模的核心能力，为进行深入的能源战略与政策分析奠定坚实基础。

## 原则与机制

在构建容量扩张模型时，我们实质上是在创建一个数学框架，以模拟能源系统在长期规划范围内的演化。这个框架的核心是一个优化问题，旨在识别出一套最优的投资和运营决策，以在满足一系列物理、经济和政策约束的同时，实现特定的系统目标（通常是最小化总成本）。本章将深入探讨构建此类优化问题的基本原则和核心机制，从最基础的构件开始，逐步建立一个完整、严谨的 formulation。

### 优化模型的核心构成

任何优化模型，无论其复杂程度如何，都由三个基本部分组成：

1.  **决策变量 (Decision Variables)**：这些是模型可以调整的量，代表了系统中的决策。例如，新建多少太阳能发电容量，或在特定时段内火力[发电机](@entry_id:268282)组的发电量。

2.  **目标函数 (Objective Function)**：这是一个数学表达式，它量化了我们希望最大化或最小化的目标。在[能源系统规划](@entry_id:1124498)中，最常见的目标是最小化系统在整个规划期内的总成本的净现值 (Net Present Value, NPV)。

3.  **约束 (Constraints)**：这些是决策变量必须遵守的规则或限制。它们代表了物理定律（如能量守恒）、技术限制（如[发电机](@entry_id:268282)组的最大出力）、资源可用性以及政策要求（如碳排放上限）。

接下来的章节将详细阐述如何为容量[扩张问题](@entry_id:150521)定义这些组成部分。

### 界定模型范畴：索引集

在着手定义变量和方程之前，我们必须首先精确地界定模型的范畴和粒度。这通过定义**索引集 (Index Sets)** 来实现。索引集是构建模型所有元素的“地址”系统，确保了每个参数和变量都有一个清晰、无[歧义](@entry_id:276744)的身份。

典型的容量扩张模型至少包含以下几个核心索引集：

*   **技术集 ($k \in \mathcal{K}$ 或 $i \in \mathcal{I}$)**：代表了所有可供选择的能源技术，例如天然气[联合循环](@entry_id:185995)、陆上风电、光伏、电池储能等。
*   **时间集 ($t \in \mathcal{T}$ 或 $p \in \mathcal{P}$)**：代表了规划期内的时间步长。区分不同时间尺度非常重要：长期模型通常使用**投资期 (investment periods)**（如年份或五年期）来做投资决策，而在每个投资期内，又会使用更精细的**运营时间切片 (operational time slices)**（如小时或典型日）来模拟系统运行。
*   **空间节点集 ($n \in \mathcal{N}$)**：代表了系统中的地理位置或区域。对于包含电网传输的模型，节点是必不可少的，它允许我们模拟区域间的[电力](@entry_id:264587)流动和地区性的资源差异。

为了捕捉更复杂的动态，例如技术性能随时间的退化或改进，我们需要引入**役期 (vintage)** 的概念。

*   **役期集 ($v \in \mathcal{V}$)**：代表资产（如发电厂）的投产时间。通过为资产标记其“出生年份”，我们可以精确追踪其年龄、性能变化和退役时间。

例如，一个精细的模型需要区分一座2020年投产的高效燃气轮机和一座2040年投产的超高效燃气轮机。这正是通过役期索引实现的。为了将役期与其投产的投资期联系起来，我们通常会定义一个映射关系，例如 $\tau: \mathcal{V} \to \mathcal{T}$，其中 $\tau(v)$ 表示役期为 $v$ 的资产所对应的投产年份。这种精细的索引结构使我们能够明确地模拟三个关键维度：**投资时机**（资产何时可用），**空间[异质性](@entry_id:275678)**（特定节点的参数和约束），以及**役期相关的性能**（效率和可用性取决于投产年份）。例如，我们可以定义投资决策变量为 $y_{k,n,v}$，代表在节点 $n$ 投资于技术 $k$、役期为 $v$ 的新[增容](@entry_id:159647)量；运营决策变量为 $q_{k,n,v,t}$，代表在时间点 $t$ 由该特定役期的资产所产生的电量。这样，诸如效率 $e_{k,v}$ 或可用性 $u_{k,n,v,t}$ 等参数就可以精确地应用到对应的资产上，从而实现高度逼真的模拟 。

### 决策者的工具箱：决策变量

定义了索引集后，我们便可以清晰地定义模型的决策变量。这些变量是优化求解器要寻找的最优解。在容量扩张模型中，变量通常分为两大类：投资变量和运营变量。

*   **投资变量 (Investment Variables)**：这些变量代表长期的、与资本存量相关的决策。它们通常按技术、节点和投资期进行索引。
    *   **新[增容](@entry_id:159647)量 ($y_{k,n,p} \in \mathbb{R}_{+}$)**：一个连续变量，代表在投资期 $p$、节点 $n$ 投资建设技术 $k$ 的新[增容](@entry_id:159647)量大小（单位通常为兆瓦 MW）。这是最核心的投资决策。
    *   **建设[指示变量](@entry_id:266428) ($b_{k,n,p} \in \{0,1\}$)**：一个二元变量，如果决定在投资期 $p$、节点 $n$ 建设技术 $k$，则为1，否则为0。这种变量常用于模拟具有固定成本或最小建设规模的“块状”投资。

*   **运营变量 (Operational Variables)**：这些变量代表短期的、与系统实时运行相关的决策。它们需要更精细的时间索引，即运营时间切片。
    *   **调度/发电量 ($g_{k,n,p,h} \in \mathbb{R}_{+}$)**：一个连续变量，代表在投资期 $p$ 的时间切片 $h$ 内，节点 $n$ 的技术 $k$ 的平均发电功率（单位为 MW）或总发电量（单位为 MWh）。这是最核心的运营决策。

正确地将变量与索引集匹配至关重要。投资决策是在较长的时间尺度（投资期 $p$）上做出的，而运营决策则是在非常短的时间尺度（时间切片 $h$）上做出的。混淆这些时间尺度是一个常见的建模错误。例如，在每个小时都做出投资决策 ($y_{k,n,p,h}$) 是不符合物理和经济现实的。同样，如果发电量变量只索引到投资期 ($g_{k,n,p}$) 而忽略了时间切片，模型将无法捕捉日内负荷变化或可再生能源的波动性，从而无法进行有效的系统调度。一个结构正确的变量定义体系，如新[增容](@entry_id:159647)量 $y_{k,n,p}$、[发电调度](@entry_id:1130037) $g_{k,n,p,h}$ 和建设指示 $b_{k,n,p}$，能够清晰地区分投资（存量）和运营（流量）决策，为构建一个物理上和经济上都一致的模型奠定了基础 。

### 系统的目标：[目标函数](@entry_id:267263)

[目标函数](@entry_id:267263)为优化问题指明了方向。在容量扩张模型中，最普遍的目标是最小化系统在整个规划期内的**总成本净现值 (Net Present Value, NPV)**。NPV原则允许我们将发生在不同年份的成本通过**贴现 (discounting)** 的方式转换到同一个基准年份（通常是规划的起始年份）进行比较，其背后的经济学原理是“今天的一美元比明天的一美元更有价值”。

若年实际[贴现率](@entry_id:145874)为 $r$，那么发生在第 $p$ 年的成本 $C_p$ 折算到基准年 $p_0=0$ 的[净现值](@entry_id:140049)为 $C_p / (1+r)^p$。[贴现](@entry_id:139170)因子定义为 $d_p = 1 / (1+r)^p$。总系统成本的NPV就是所有年份[贴现](@entry_id:139170)成本的总和。

系统的总年度成本由多个部分构成，必须仔细区分并正确建模：

1.  **资本性支出 (Capital Expenditures, CAPEX)**：这是建设新发电设施的一次性投资成本。它与**新[增容](@entry_id:159647)量** $y_{k,p}$（单位 MW）成正比。其成本参数 $c_k^{\mathrm{inv}}$ 的单位是 \$/MW。年度投资成本项为 $\sum_{k \in \mathcal{K}} c_k^{\mathrm{inv}} y_{k,p}$。

2.  **固定运维成本 (Fixed Operation  Maintenance, FOM)**：这是维持发电设备正常待命状态所需的年度成本，与发电量无关，而与**总装机容量** $K_{k,p}$（单位 MW）成正比。其成本参数 $c_k^{\mathrm{fix}}$ 的单位是 \$/(MW·年)。年度固定成本项为 $\sum_{k \in \mathcal{K}} c_k^{\mathrm{fix}} K_{k,p}$。

3.  **可变运维成本 (Variable Operation  Maintenance, VOM)**：这部分成本与设备的**实际发电量** $g_{k,p}$（单位 MWh）成正比，包括了除燃料外的损耗、辅料等费用。其成本参数 $c_k^{\mathrm{var}}$ 的单位是 \$/MWh。

4.  **燃料成本 (Fuel Costs)**：对于化石燃料发电机组，这是最主要的可变成本，同样与**发电量** $g_{k,p}$ 成正比。其成本参数 $c^{\mathrm{fuel}}_{k,p}$ 的单位是 \$/MWh。

5.  **政策成本 (Policy Costs)**：例如[碳税](@entry_id:1122078)或碳排放交易体系下的碳价。这项成本取决于发电产生的碳排放量。如果 $\eta_k$ 是技术 $k$ 的排放因子（单位 tCO₂/MWh），$\pi_p$ 是第 $p$ 年的碳价（单位 \$/tCO₂），那么单位发电量的碳成本就是 $\pi_p \eta_k$。

将所有这些成本项汇总，一个典型的总系统成本最小化目标函数如下所示（其中 $g_{k,p}$ 代表在投资期 $p$ 内的总发电量） ：

$$
\min \sum_{p \in \mathcal{P}} d_p \left[ \sum_{k \in \mathcal{K}} \left( c_k^{\mathrm{inv}} y_{k,p} + c_k^{\mathrm{fix}} K_{k,p} \right) + \sum_{k \in \mathcal{K}} \left( c_k^{\mathrm{var}} + c^{\mathrm{fuel}}_{k,p} + \pi_p \eta_k \right) g_{k,p} \right]
$$

其中，所有与年度存量（容量）相关的成本和一次性投资都按年汇总，而所有与流量（发电量）相关的成本也汇总到年度层面，然后统一进行贴现。

#### 建模的最佳实践：单位一致性

构建目标函数时，一个至关重要的原则是**量纲一致性 (dimensional homogeneity)**。这意味着在加总的表达式中，每一个子项都必须具有相同的单位。在目标函数中，这个单位是货币（例如，美元）。忽略单位检查是导致模型错误的一个常见来源。

让我们对上述目标函数的一个典型年度成本项进行单位检查 ：

*   **投资成本**: $c^{\mathrm{inv}}_k \, y_{k,p} \rightarrow (\$/\mathrm{MW}) \times (\mathrm{MW}) = \$$
*   **固定运维成本**: $c^{\mathrm{fix}}_k \, K_{k,p} \rightarrow (\$/(\mathrm{MW}\cdot\text{年})) \times (\mathrm{MW}) = \$/\text{年}$ (注意：这里的成本参数是年度成本，与年度容量相乘得到年度总费用)
*   **可变成本 (VOM, 燃料, 碳税)**: $(\text{cost}/\mathrm{MWh}) \times (\mathrm{MWh}) = \$$

可以看到，所有成本项最终都以货币单位（或年度货币流量）表示，因此可以将它们相加并进行贴现。贴现因子 $d_p$ 是无量纲的，所以它不会改变成本的单位。坚持进行单位检查是保证模型物理和经济意义正确性的基本纪律。

### 游戏规则：系统约束

约束定义了模型的“可行域”，即所有决策变量必须满足的物理、技术和经济限制。

#### 能量平衡约束

这是所有电力系统模型中最核心的约束，它体现了**能量守恒定律**。在任何时间、任何地点，电力的生产必须精确地等于电力的消耗。在一个包含电网和储能的复杂模型中，一个节点的功率平衡方程可以写成：

**注入功率 = 提取功率**

$$
\text{发电} + \text{储能放电} + \text{线路输入} + \text{外部输入} = \text{负荷} + \text{储能充电} + \text{线路输出} + \text{本地损耗}
$$

用变量来表示，对于每个节点 $n$ 和每个时间切片 $h$，这个平衡方程可以写成 (其中 $g_{n,h}$ 代表节点 $n$ 的总发电量) ：

$$
g_{n,h} + dis_{n,h} + \sum_{m \in \mathcal{N}, m \neq n} (1-\ell_{m\to n}) f_{m\to n,h} + m_{n,h} = d_{n,h} + ch_{n,h} + \sum_{m \in \mathcal{N}, m \neq n} f_{n\to m,h} + l_{n,h}
$$

其中：
*   $g_{n,h}$ 是本地发电量。
*   $dis_{n,h}$ 和 $ch_{n,h}$ 分别是储能向电网放电和从电网充电的功率。
*   $f_{m\to n,h}$ 是从节点 $m$ 发往节点 $n$ 的输电功率，$\ell_{m\to n}$ 是线路损耗率，所以 $(1-\ell_{m\to n}) f_{m\to n,h}$ 是实际到达的功率。
*   $m_{n,h}$ 是净外部输入（正为输入，负为输出）。
*   $d_{n,h}$ 是本地电力需求（负荷）。
*   $f_{n\to m,h}$ 是从节点 $n$ 发往节点 $m$ 的功率。
*   $l_{n,h}$ 是本地的非输电损耗（如配网损耗）。

这个方程必须在模型的每个时间切片和每个节点上都成立，以确保系统的运行可行性。

#### 容量约束

发电厂的发电量不能超过其可用容量。这个看似简单的规则在建模时需要仔细处理。我们需要区分**铭牌容量 (nameplate capacity)** 和**有效容量 (effective capacity)**。

*   **铭牌容量 ($K_k$)**：指的是设备在理想条件下设计的最大输出功率。
*   **有效容量**：指的是在特定时间点，设备实际可用于发电的最大功率。它受到多种因素的影响：
    *   **系统性可用性 ($a_{k,h}$)**：对于可再生能源（如风能和太阳能），这代表了资源本身的可用性（如风速、光照强度），是一个介于0和1之间的系数。对于传统发电机组，它可以代表计划性维护。
    *   **随机性故障 (Forced Outage Rate, $f_k$)**：任何发电设备都有可能发生非计划性停机。强制停机率 $f_k$ 代表了设备因随机故障而不可用的概率。

当这两种不可用性来源是独立事件时，一个单位容量在时间 $h$ 实际可用的概率是 $a_{k,h} \times (1 - f_k)$。因此，总装机容量为 $K_k$ 的机组，在时间 $h$ 的预期最大发电功率（即有效容量）为 $a_{k,h} (1 - f_k) K_k$。这就导出了容量约束：

$$
g_{k,h} \le a_{k,h} (1 - f_k) K_k
$$

这个约束将运营决策（发电量 $g_{k,h}$）与投资决策（总容量 $K_k$）联系起来。例如，对于一个铭牌容量为700 MW的燃气电厂，其计划性可用性为1 ($a_{\text{g},h}=1$)，强迫停机率为8% ($f_{\text{g}}=0.08$)，那么其在任何时刻的最大期望出力为 $1 \times (1-0.08) \times 700 = 644$ MW。而对于一个铭牌容量为500 MW的风电场，在某个时段风力可用性为50% ($a_{\text{w},h}=0.5$)，强迫停机率为2% ($f_{\text{w}}=0.02$)，其最大期望出力则为 $0.5 \times (1-0.02) \times 500 = 245$ MW 。

#### 资本存量动态

容量扩张模型不仅决定“建多少”，还决定“何时建”以及“何时退”。这就需要精确追踪系统中**资本存量 (capital stock)** 的演化。一个优雅且强大的方法是使用**役期索引 (vintage indexing)**。

资本存量的基本动态可以用一个简单的存量-流量方程来描述：
下一期的存量 = 当前存量 + 新增流入 - 流出

对于按役期追踪的容量，我们可以为每个技术 $i$、每个役期 $v$（投产年份）和每个时间点 $t$ 定义其存续容量 $A_{i,t,v}$。其演化遵循以下规则 ：

1.  **初始化**：在投产年份 $v$，存续容量等于新建容量 $B_{i,v}$。在投产前，存续容量为零。
    $$ A_{i,v,v} = B_{i,v} $$
    $$ A_{i,t,v} = 0 \quad \forall t  v $$

2.  **存量演化**：在投产之后 ($t > v$)，每一期的存续容量等于上一期的存续容量减去当期退役的容量 $R_{i,t,v}$。
    $$ A_{i,t,v} = A_{i,t-1,v} - R_{i,t,v} $$
    其中，$R_{i,t,v}$ 是一个决策变量，允许模型进行经济上最优的**提前退役**决策。

3.  **技术寿命**：任何资产都有其物理寿命 $L_i$。在达到寿命终点时，必须强制退役。
    $$ A_{i,t,v} = 0 \quad \forall t \ge v + L_i $$

最后，在任何时间点 $t$，技术 $i$ 的总装机容量 $K_{i,t}$ 就是所有仍在服役的、不同役期的容量之和：
$$ K_{i,t} = \sum_{v \le t} A_{i,t,v} $$

这种精细的役期追踪方法能够捕捉到资本存量的完整生命周期，是从业者进行长期能源转型路径研究的标准方法。

### 高级建模方法与选择

除了上述核心构件，构建一个实用的容量扩张模型还涉及许多高级方法和建模范式的选择。

#### 管理[计算复杂性](@entry_id:204275)：代表性时间切片

一个跨度数十年的规划模型，如果以小时为单位进行全年8760小时的 chronological (时序) 模拟，其计算量将是天文数字。为了在保留关键运营特征的同时降低计算负担，模型通常使用**代表性时间切片 (representative time slices)** 的方法。

其核心思想是将全年8760小时通过聚类等方法，聚合成少数几个“代表性”时段（例如，夏季高峰日、冬季非高峰日、周末等），每个时段都有一个权重 $w_s$，代表该时段在一年中出现的总时长。

一个好的时间切片方法必须满足几个关键目标：
*   **保留总能量**：聚合后的年度总能量需求应与原始数据相同。这通常通过将每个切片的代表值（如平均负荷）乘以其权重 $w_s$ 再求和来实现。
*   **保留可再生能源特性**：应保留可再生能源发电的季节性和日内变化模式及其与负荷的相关性。
*   **保留系统峰值**：为了确保系统有足够的容量应对极端情况（容量充裕性），聚合方法必须保留原始数据中的**峰值负荷**。如果将峰值负荷时刻与其它时刻平均化，将会严重低估系统所需的总容量。

一个简单而有效的策略是，在聚类时特意将全年的峰值负荷小时单独拿出来，作为一个独立的、权重为1的小时切片。这样可以确保容量充裕性约束直接作用于真实的系统峰值需求，而其他非峰值时段则可以被聚类以减少计算量 。

#### 建模范式：社会规划者 vs. 竞争性市场

容量扩张模型可以从两种不同的理论视角构建：

1.  **社会规划者 (Social Planner)** 模型：这是一种**集中式优化**模型。它假设有一个全知的中央规划者，其目标是最小化整个社会的总成本，以满足所有需求。我们前面讨论的成本最小化模型就属于这一类。其数学形式为一个大规模的[线性规划](@entry_id:138188)（LP）或混合整数线性规划（MILP）问题。

2.  **竞争性市场 (Competitive Market)** 模型：这是一种**分散式均衡**模型。它不假设中央规划者的存在，而是模拟大量独立的、以**利润最大化**为目标的投资者（或发电公司）在市场中的行为。每个投资者根据市场价格 $p_t$ 决定自己的投资和发电策略。模型的解是一个**均衡 (equilibrium)**，在该均衡点上，所有投资者的决策都是最优的，并且電力市場在每个时间点都出清（即供给等于需求）。

在理想化的完美竞争市场假设下，经济学中的**福利经济学第一基本定理**告诉我们，竞争性均衡的結果与社会规划者所做的成本最小化决策是等价的。换句话说，追求个体利润的“看不见的手”最终会引导系统达到社会总成本最低的状态。因此，社会规划者模型常常被用作对完美竞争市场[长期均衡](@entry_id:139043)的有效近似 。理解这两种范式的区别与联系，对于正确解读模型结果并将其与现实世界的市场行为联系起来至关重要。