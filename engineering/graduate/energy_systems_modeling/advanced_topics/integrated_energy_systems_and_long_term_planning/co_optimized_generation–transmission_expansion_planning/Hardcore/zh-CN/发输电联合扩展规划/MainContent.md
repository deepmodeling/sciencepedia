## 引言
随着全球向低碳能源未来转型，[电力](@entry_id:264587)系统正经历着前所未有的变革。大规模可再生能源的并网、电气化需求的增长以及对[系统可靠性](@entry_id:274890)的更高要求，使得传统的独立规划发电和输电设施的方法显得力不从心。这种“孤岛式”规划忽略了发电与输电投资之间复杂的相互作用，往往导致次优的、成本高昂且缺乏韧性的系统设计。为了应对这一挑战，协同优化发电与[输电扩展规划](@entry_id:1133366)（Co-optimized Generation-Transmission Expansion Planning）应运而生，成为现代能源[系统分析](@entry_id:263805)的核心工具。

本文旨在系统性地介绍这一强大的规划方法。我们将深入探讨如何构建一个统一的优化框架，以同时决定在哪里建设发电厂、在哪里建设输电线路以及如何调度整个系统，从而以最低的社会总成本实现能源系统的长期发展目标。

为帮助读者全面掌握这一领域，文章分为三个核心部分：
*   在**“原理与机制”**中，我们将剖析协同优化模型的基础，包括其核心数学公式、经济学原理、可靠性约束以及处理复杂性的建模技术。
*   在**“应用与跨学科联系”**中，我们将展示这些模型如何应用于解决现实世界的挑战，如能源脱碳、整合需求侧资源以及管理未来的不确定性。
*   最后，在**“动手实践”**部分，我们提供了一系列精心设计的练习，旨在将理论知识转化为实际的建模与分析能力。

通过学习本文，您将能够理解并评估复杂的能源扩展规划模型，为参与未来能源系统的设计与决策奠定坚实的基础。

## 原理与机制

在“引言”章节中，我们概述了协同优化发电与[输电扩展规划](@entry_id:1133366)（Co-optimized Generation-Transmission Expansion Planning）作为现代[能源系统规划](@entry_id:1124498)核心挑战的重要性。本章将深入探讨支撑这些规划模型的基础原理和机制。我们将从构建核心优化问题的基本要素出发，逐步引入经济学原理、可靠性约束、动态规划维度以及处理[计算复杂性](@entry_id:204275)的先进方法。本章的目标是为读者提供一个坚实的概念框架，以便理解、构建和批判性地评估复杂的能源系统扩展模型。

### 核心规划问题：成本与约束的权衡

所有扩展规划模型的根本目标是在满足一系列物理、经济和政策约束的前提下，最小化系统的总成本。这个总成本通常由两部分组成：**资本支出（CAPEX）**和**运营支出（OPEX）**。资本支出是建设新[发电机](@entry_id:268282)组、储能设施或输电线路等基础设施的一次性投资成本，通常会年化或折现到模型的评估周期内。运营支出则是系统在实际运行中产生的可变成本，主要包括燃料成本、维护成本以及因未满足需求而产生的惩罚成本（如负荷削减成本）。

规划问题的核心在于决策两类变量：
1.  **投资决策变量**：这些通常是离散或连续的变量，代表在规划期内建设多少容量的新资产。例如，建设多少兆瓦（MW）的太阳能发电，或者是否建设一条新的输电线路。
2.  **运营决策变量**：这些变量描述了在给定投资组合下，系统如何在每个时间步（如每小时）进行调度。这包括每个[发电机](@entry_id:268282)组的发电量、储能的充放电量以及线路上的潮流。

#### 节点功率平衡：能量守恒的体现

任何网络模型的基石都是**节点功率平衡**，它是在物理学能量守恒定律在[电力](@entry_id:264587)系统中的直接应用。对于网络中的每一个节点（或称母线）$i$ 和每一个时间段 $t$，注入该节点的总功率必须等于流出该节点的总功率。一个完整的节点功率平衡方程  必须细致地考虑所有可能的功率源（注入）和功率汇（流出）：

**总注入 = 总流出**

$$
g_{i,t} + dis_{i,t} + \sum_{j \in \mathcal{N}, j \neq i} (1-\ell_{j\to i}) f_{j\to i,t} + m_{i,t} = d_{i,t} + ch_{i,t} + \sum_{k \in \mathcal{N}, k \neq i} f_{i\to k,t} + l_{i,t}
$$

其中：
- **注入项（左侧）**：
    - $g_{i,t}$：节点 $i$ 处的本地**发电量**。
    - $dis_{i,t}$：连接到节点 $i$ 的**储能**设施的放[电功率](@entry_id:273774)。
    - $\sum_{j} (1-\ell_{j\to i}) f_{j\to i,t}$：从其他节点 $j$ 流入节点 $i$ 的**输电功率**，其中 $f_{j\to i,t}$ 是从 $j$ 发出的功率，$\ell_{j\to i}$ 是线路损耗率，因此 $(1-\ell_{j\to i}) f_{j\to i,t}$ 是实际到达 $i$ 的功率。
    - $m_{i,t}$：从外部区域到节点 $i$ 的**净输入功率**（大于零表示进口）。

- **流出项（右侧）**：
    - $d_{i,t}$：节点 $i$ 处的**负荷需求**。
    - $ch_{i,t}$：连接到节点 $i$ 的储能设施的充[电功率](@entry_id:273774)。
    - $\sum_{k} f_{i\to k,t}$：从节点 $i$ 流出到其他节点 $k$ 的输[电功率](@entry_id:273774)。
    - $l_{i,t}$：本地**非输电损耗**，如配网损耗。

这个方程是确保模型解的物理可行性的基础。任何一个项的缺失都可能导致对系统运行的错误描述，从而产生有偏的投资决策。

#### 潮流建模：[直流潮流近似](@entry_id:1123430)

为了在大型网络中对潮流进行计算上可行的建模，规划模型广泛采用**直流潮流（DC Power Flow）**近似  。该模型基于以下几个关键假设：
- 所有节点的电压幅值恒定为 1.0 p.u.（标幺值）。
- 输电线路的电阻远小于电抗，因此可以忽略。
- 线路两端电压相角差 $\theta_i - \theta_j$ 很小，满足 $\sin(\theta_i - \theta_j) \approx \theta_i - \theta_j$。

在这些假设下，流经连接节点 $i$ 和 $j$ 的线路 $\ell$ 的有功功率 $p_{\ell}$ 可以被线性化为：

$$
p_{\ell} = b_{\ell} (\theta_i - \theta_j)
$$

其中 $b_{\ell}$ 是线路的电纳（电抗的倒数），$\theta_i$ 和 $\theta_j$ 分别是节点 $i$ 和 $j$ 的电压相角。这个线性关系使得整个潮流问题可以被嵌入到一个[线性规划](@entry_id:138188)或[混合整数线性规划](@entry_id:1127955)框架中，极大地简化了求解过程。同时，每条线路都受到其**热极限** $\overline{F}_{\ell}$ 的约束，即 $|p_{\ell}| \leq \overline{F}_{\ell}$。

### 扩张的经济学原理

输配电系统扩张的根本经济动机在于通过资本投资来降低系统的长期总运营成本。这种权衡是所有协同优化规划模型的核心。

#### 边际成本与边际收益的平衡

输电扩张的价值主要体现在缓解**网络拥堵**上。当低成本[发电机](@entry_id:268282)组的[电力](@entry_id:264587)因为输电能力不足而无法送达负荷中心时，系统被迫调度位于负荷中心附近但成本更高的[发电机](@entry_id:268282)组来满足需求。这两种发电成本之差，即为**拥堵成本**。

投资建设新的输电线路或升级现有线路可以提高输送能力，从而减少对高成本发电的依赖，降低总运营成本。一个经济上理性的决策者会持续投资于输电扩张，直到增加单位容量的**边际投资成本**等于或超过因此而带来的**边际运营成本节约**。

我们可以通过一个简单的[连续扩张](@entry_id:161021)模型来阐明这一点 。假设一个规划者考虑增加[输电容量](@entry_id:1133361) $K$，其单位投资成本为 $c$。通过求解一个考虑了[发电机](@entry_id:268282)组凸形成本和输电约束的优化问题，我们可以推导出最优的扩张容量 $K^{\star}$ 满足的条件。在最优解处，[输电容量](@entry_id:1133361)的边际价值（通过[拉格朗日乘子](@entry_id:142696)，或称影子价格，来衡量）等于其边际成本 $c$。这个影子价格精确地量化了放宽一度[输电容量约束](@entry_id:1133362)能为系统节省多少运营成本。例如，若计算得出某条线路的拥堵带来的边际成本为 5 美元/兆瓦时，而增加一兆瓦[输电容量](@entry_id:1133361)的年化成本折合为每小时 5 美元，那么这项投资就是经济合理的。

#### 对[平准化能源成本](@entry_id:1127174)（LCOE）的批判性审视

在进行技术选择时，一个广为流传的指标是**[平准化能源成本](@entry_id:1127174)（Levelized Cost of Energy, LCOE）**。LCOE旨在通过将技术的全生命周期成本（包括初始投资、运营和维护）除以其全生命周期发电量，来计算每兆瓦时（MWh）的平均成本。其定义如下 ：

$$
LCOE = \frac{\sum_{y} d_y (\text{CAPEX}_y + \text{OPEX}_y)}{\sum_{y} d_y E_y}
$$

其中 $d_y$ 是[贴现](@entry_id:139170)因子，$\text{CAPEX}_y$ 和 $\text{OPEX}_y$ 是第 $y$ 年的资本和运营支出，$E_y$ 是年发电量。

然而，仅仅依据 LCOE 来进行投资决策具有极大的误导性，因为它忽略了能源的**时间和空间价值**。一个综合的[系统优化](@entry_id:262181)模型（如规划模型）的 KKT ([Karush-Kuhn-Tucker](@entry_id:634966)) [最优性条件](@entry_id:634091)表明，一项投资的价值不取决于其发电的*平均*成本，而取决于其在*边际*上对系统做出的贡献。这种贡献由发电的时间和地点决定，并通过[系统平衡](@entry_id:1132826)约束的影子价格 $\lambda_{y,t}$ 来量化 。

影子价格 $\lambda_{y,t}$ 代表在时间 $t$、节点 $n$ 增加一单位[电力](@entry_id:264587)的边际价值或系统成本。在[电力](@entry_id:264587)需求高或廉价[电力](@entry_id:264587)供应不足（如无风无光）的时段，$\lambda_{y,t}$ 会非常高；反之，在[电力](@entry_id:264587)供应过剩时，它可能非常低甚至为零。一个理想的投资应该是在 $\lambda_{y,t}$ 高的时候能够提供[电力](@entry_id:264587)。例如，一个 LCOE 稍高的燃气轮机，如果它能在可再生能源出力低而系统需求高的傍晚峰值时段提供[电力](@entry_id:264587)，其对系统的真实价值可能远超一个 LCOE 极低但在中午时段发电（此时[电力](@entry_id:264587)可能已过剩）的太阳能电站。

LCOE 的根本缺陷在于它是一个孤立的、基于平均值的指标，而[系统优化](@entry_id:262181)本质上是基于边际价值和系统内各元素相互作用的。在存在网络拥堵、灵活性约束和可再生能源波动性的现代[电力](@entry_id:264587)系统中，忽略能源的时间和空间价值将导致错误的投资组合，通常会过度投资于能量充裕但[容量价值](@entry_id:1122050)低的资源，而投资不足于保障[系统可靠性](@entry_id:274890)的灵活资源。

### 从连续到离散决策：[混合整数规划](@entry_id:1127956)的角色

虽然[连续扩张](@entry_id:161021)模型（如 ）有助于理解经济学原理，但现实世界中的投资决策往往是“是或否”的**离散决策**。例如，我们不能建设 0.7 条输电线路，只能决定建或不建（1 或 0），或者建设整数个单位的容量。

为了模拟这种决策，我们需要引入**整数变量**，特别是**[二元变量](@entry_id:162761)**（binary variables），它们只能取 0 或 1。一个典型的例子是  中描述的简单两节点系统，规划者需要决定是否建设一个新[发电机](@entry_id:268282)组（由[二元变量](@entry_id:162761) $x \in \{0,1\}$ 决定）以及是否升级一条输电线路（由[二元变量](@entry_id:162761) $y \in \{0,1\}$ 决定）。

这类包含整数变量和连续变量的优化问题被称为**[混合整数规划](@entry_id:1127956)（Mixed-Integer Programming, MIP）**，通常是[混合整数线性规划](@entry_id:1127955)（MILP）。整数变量的引入从根本上改变了问题的数学性质和计算复杂度。
- **几何上**，连续的线性规划（LP）问题的[可行域](@entry_id:136622)是一个[凸多面体](@entry_id:170947)，可以通过高效的算法（如单纯形法或[内点法](@entry_id:169727)）在[多项式时间](@entry_id:263297)内找到最优解。
- **而[混合整数规划](@entry_id:1127956)**的[可行域](@entry_id:136622)是非凸的，由多个分离的子区域构成。例如，输电线决策 $y$ 使得潮流的上限要么是 $\overline{F}^{\text{base}}$（若 $y=0$），要么是 $\overline{F}^{\text{base}} + \Delta\overline{F}$（若 $y=1$）。这种“非此即彼”的逻辑结构破坏了可行域的[凸性](@entry_id:138568)。

求解 MIP 问题在计算上是 NP-hard 的，意味着在最坏情况下，求解时间会随着问题规模（特别是整数变量的数量）呈指数级增长。这需要依赖复杂的求解算法，如**[分支定界法](@entry_id:635251)（branch and bound）**和**[割平面法](@entry_id:635930)（cutting plane）**。尽管计算成本高昂，但 MIP 是准确刻画真实世界中离散投资决策的唯一途径，是典型的**自下而上（bottom-up）**工程优化范式。它从系统的基本物理组件和约束出发，以规范性（prescriptive）的方式寻找最优的[系统设计](@entry_id:755777)和运行策略。

### 保证可靠性：安全约束规划

一个经济上最优的[电力](@entry_id:264587)系统如果频繁停电，那将是毫无价值的。因此，规划模型必须包含**可靠性**或**安全性**约束。在[输电规划](@entry_id:1133374)中，最核心的可靠性标准是 **N-1 安全准则**。该准则要求系统在任意单个设备（如一条输电线路或一个[发电机](@entry_id:268282)组）发生故障（即“N-1 意外事件”）后，仍然能够稳定运行，且系统中任何剩余设备的运行参数（如线路潮流）都不会超出其安全限值。

将 N-1 准则纳入优化模型，就形成了**安全约束最优潮流（Security-Constrained Optimal Power Flow, SCOPF）**或安全约束单元组合（SCUC）的框架。在规划背景下，我们关注的是**预防性（preventive-only）SCOPF** 。这意味着系统的**事前**调度方案（即正常运行状态下的发电计划）必须足够稳健，以至于在任何假想的 N-1 故障发生后，即使**不进行任何事后调整**（即[发电机](@entry_id:268282)不改变其出力），潮流会自动重新分布，并且不会导致任何线路过载。

直接在模型中模拟每一次潜在故障并重新计算潮流是不现实的，因为这会产生海量的非[线性约束](@entry_id:636966)。幸运的是，借助[直流潮流](@entry_id:1123429)模型，我们可以使用**潮流分布因子（Distribution Factors）**来线性化地表示故障后的潮流。

- **功率转移分布因子（Power Transfer Distribution Factors, PTDF）**：衡量在节点 $a$ 注入 1 MW 功率、在节点 $b$ 取出 1 MW 功率时，对线路上潮流的影响。
- **线路断线分布因子（Line Outage Distribution Factors, LODF）**：衡量线路 $k$ 的断线对另一条线路 $l$ 上潮流的影响。LODF 可以由 PTDF 预先计算得出 。

关键的线性化关系是 ：
$$
f_{l,t}^{(s_k)} = f_{l,t} + \mathrm{LODF}_{l,k} \cdot f_{k,t}
$$
这里，$f_{l,t}$ 和 $f_{k,t}$ 分别是正常运行时线路 $l$ 和 $k$ 的潮流，$f_{l,t}^{(s_k)}$ 是线路 $k$ 发生故障后（记为意外事件 $s_k$），线路 $l$ 上的**事后潮流**。由于 $\mathrm{LODF}_{l,k}$ 是一个常数，这个方程将事后潮流表示为事前潮流的线性函数。

通过这个工具，我们可以为每个潜在的线路故障 $k$ 和每条幸存线路 $l$，在主优化模型中添加一对[线性约束](@entry_id:636966)：
$$
-\overline{F}_l \le f_{l,t} + \mathrm{LODF}_{l,k} \cdot f_{k,t} \le \overline{F}_l
$$
虽然这会大大增加模型的约束数量，但它们都是线性的，从而保持了模型的（混合整数）线性结构。引入这些安全约束通常会提高系统的运营成本，因为系统可能需要放弃最经济的调度方案，转而采用一种更保守但更安全的方案。这些约束的影子价格，则量化了保障 N-1 安全性的边际成本，为规划者提供了关于可靠性价值的宝贵信息。

### 扩展工具箱：储能与灵活性

随着可再生能源渗透率的提高，系统的**灵活性**需求日益增长。灵活性是指[电力](@entry_id:264587)系统应对供需[净负荷](@entry_id:1128559)（负荷减去可再生能源发电）波动和不确定性的能力。储能技术，特别是电池储能，是提供灵活性的关键工具，并日益成为与输电和发电协同优化的重要组成部分。

#### 储能的建模与作用

在规划模型中，储能的核心动态可以通过几个简单的方程来描述 ：
- **能量状态（State of Charge, SoC）演化**：
$$
e_t = e_{t-1} + \eta^{\text{ch}} p^{\text{ch}}_t \cdot \Delta t - \frac{1}{\eta^{\text{dis}}} p^{\text{dis}}_t \cdot \Delta t
$$
其中 $e_t$ 是在时间段 $t$ 末的储能水平（MWh），$p^{\text{ch}}_t$ 和 $p^{\text{dis}}_t$ 分别是充电和放电功率（MW），$\eta^{\text{ch}}$ 和 $\eta^{\text{dis}}$ 是充放电效率，$\Delta t$ 是时间步长。这体现了储能的**时间耦合**特性。
- **容量约束**：储能的功率和能量都受其投资容量的限制，$0 \le p^{\text{ch}}_t, p^{\text{dis}}_t \le P_{\text{cap}}$ 以及 $0 \le e_t \le E_{\text{cap}}$。
- **循环约束**：对于代表性周期模型，通常会要求周期开始和结束时的储能水平相同，即 $e_T = e_0$，以保证运行模式的可持续性。

储能的主要经济作用是**时间套利（temporal arbitrage）**：在[电力](@entry_id:264587)价格低廉时（如中午太阳能过剩时）充电，在价格高昂时（如傍晚用电高峰）放电。通过这种方式，储能可以将廉价能源从一个时间段“转移”到另一个时间段。

这揭示了储能与输电之间的深刻关系。输电执行的是**空间套利（spatial arbitrage）**，即将空间上某地的廉价[电力](@entry_id:264587)输送到另一地。而储能执行的是时间套利。两者都可以有效地促进低成本可再生能源的消纳，降低[弃风](@entry_id:1134089)弃光，并减少对昂贵调峰电厂的依赖。因此，在规划模型中，储能和输电常常表现为**替代品**或**互补品** ，协同优化它们对于找到最低成本的系统转型路径至关重要。

### 管理复杂性：时间和动态维度

一个完整的发电-[输电扩展规划](@entry_id:1133366)模型需要在广阔的地理范围和长达数十年的时间跨度内做出决策，其复杂性是巨大的。因此，必须采用有效的建模技术来管理这种复杂性，特别是在时间和动态维度上。

#### 时间分辨率与代表性周期

在一个典型的年份中，有 8760 个小时。对每个小时都进行精细的优化调度，在计算上往往是不可行的。一个常见的错误是使用简单的年度或月度平均数据，因为这会完全抹平系统运行的关键动态，如日内峰谷差、可再生能源的快速波动以及机组的[爬坡限制](@entry_id:1130533)。这会导致对灵活性资源（如储能和快速响应机组）以及[输电容量](@entry_id:1133361)的需求被严重低估 。

一种科学的降维方法是使用**代表性周期（representative periods）**  。这种方法不是简单地取平均，而是通过聚类等统计方法，从全年的数据中（如负荷和可再生能源出力的联合时间序列）挑选出若干个“典型日”或“典型周”。每个代表性周期都保持了其内部的**[时序性](@entry_id:924959)（chronology）**，例如，保留了小时级别的分辨率，从而可以准确地模拟爬坡、储能充放电等时序相关的约束。然后给每个代表性周期分配一个权重（例如，这个周期代表了全年中的多少天），最终的运营成本是所有代表性周期加权成本的总和。

这种方法在大幅降低计算量的同时，旨在保留原始数据中最重要的统计特性，特别是负荷和可再生能源出力之间的**[时空协方差](@entry_id:1132006)**。这对于做出无偏的投资决策至关重要。

#### [动态规划](@entry_id:141107)与投资提[前期](@entry_id:170157)

规划不仅是静态的，也是一个**动态过程**。今天的投资决策会影响未来多年的系统结构和运行。此外，大型基础设施项目（如核电站或主要输电走廊）的建设需要数年的**提[前期](@entry_id:170157)（lead time）**。

一个[动态规划](@entry_id:141107)模型必须明确地考虑这一点 。模型的时间轴被划分为多个阶段（如每年或每五年一个阶段）。在第 $t$ 期做出的投资决策 $x_t$，只有在第 $t+L$ 期之后才能投产并计入可用容量，其中 $L$ 是建设提前期。这可以通过跨时间周期的约束来建模，例如：

$$
g_{n,t} \le G^{0}_n + \sum_{\tau=1}^{t - L^{G}_n} x^{G}_{n,\tau}
$$

这个约束表明，在第 $t$ 期，节点 $n$ 的可用发电容量等于初始容量 $G^{0}_n$ 加上所有在 $t-L_n^G$ 或更早时期做出并已完工的投资 $x_{n,\tau}^G$ 的总和。

这种动态公式要求模型具有“远见”，能够在早期阶段就为满足未来的需求和应对预期的系统变化而进行投资。它捕捉了投资决策的[路径依赖性](@entry_id:186326)和不[可逆性](@entry_id:143146)，是进行长期战略规划的必要工具。

通过综合运用本章所介绍的原理和机制——从基本的功率平衡到复杂的安全约束和动态规划——研究人员和规划者可以构建出功能强大、洞察深刻的协同优化模型，以指导我们走向一个经济、可靠和可持续的未来能源系统。