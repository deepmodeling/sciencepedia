{
    "hands_on_practices": [
        {
            "introduction": "Before optimizing a supply chain network, we must first understand the physical limits of its components. This exercise grounds our model in fluid mechanics by tasking you with calculating the maximum flow rate of a crude oil pipeline based on its physical characteristics and the available pressure drop. By applying the Darcy-Weisbach and Colebrook-White equations, you will derive a fundamental capacity constraint that is essential for any realistic supply chain model. ",
            "id": "4091834",
            "problem": "A crude oil trunk pipeline is a capacity-limiting element in a regional fossil fuel supply chain. The pipeline conveys single-phase oil at steady state from a coastal terminal to an inland hub with negligible elevation change and negligible minor losses. The length is $L = 60{,}000\\,\\text{m}$, the internal diameter is $D = 0.60\\,\\text{m}$, and the internal absolute roughness of the commercial steel pipe is $\\epsilon = 2.0 \\times 10^{-4}\\,\\text{m}$. The oil density is $\\rho = 870\\,\\text{kg}\\,\\text{m}^{-3}$ and the dynamic viscosity at operating temperature is $\\mu = 1.5 \\times 10^{-2}\\,\\text{Pa}\\cdot\\text{s}$. The available pressure drop across the segment, as limited by pump stations and maximum allowable operating pressure constraints, is $\\Delta p = 8.0 \\times 10^{5}\\,\\text{Pa}$.\n\nStarting from the steady incompressible mechanical energy balance and a physically appropriate representation of frictional losses for turbulent flow in rough pipes, derive the governing relationship linking the volumetric flow rate $Q$ to the available pressure drop $\\Delta p$, the pipe and fluid properties $(L, D, \\epsilon, \\rho, \\mu)$, and the friction factor. Then compute the maximum volumetric flow rate $Q$ that can be sustained by this pipeline segment under the given hydraulic limitation.\n\nAssume flow remains single-phase, the oil is effectively incompressible under these conditions, and minor losses are negligible compared to distributed frictional losses. Round your final answer for the maximum volumetric flow rate to three significant figures, and express it in cubic meters per second.",
            "solution": "The problem is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Pipeline length: $L = 60{,}000\\,\\text{m}$\n- Internal diameter: $D = 0.60\\,\\text{m}$\n- Internal absolute roughness: $\\epsilon = 2.0 \\times 10^{-4}\\,\\text{m}$\n- Oil density: $\\rho = 870\\,\\text{kg}\\,\\text{m}^{-3}$\n- Dynamic viscosity: $\\mu = 1.5 \\times 10^{-2}\\,\\text{Pa}\\cdot\\text{s}$\n- Available pressure drop: $\\Delta p = 8.0 \\times 10^{5}\\,\\text{Pa}$\n- Assumptions: Steady-state, single-phase, incompressible flow, negligible elevation change, negligible minor losses.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard application of the principles of fluid mechanics (the Darcy-Weisbach and Colebrook-White equations) to a practical engineering scenario in energy systems. The provided data for the fluid (crude oil) and pipe (commercial steel) are physically realistic. The problem is well-posed; it provides all necessary information and constraints to determine a unique, stable solution for the flow rate. The language used is objective and precise. The problem is self-contained, consistent, and free of any scientific or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Solution Derivation**\nThe analysis begins with the steady-state mechanical energy balance for an incompressible fluid flowing between two points, designated $1$ (inlet) and $2$ (outlet). The equation, expressed in terms of head, is:\n$$ \\frac{p_1}{\\rho g} + \\frac{v_1^2}{2g} + z_1 = \\frac{p_2}{\\rho g} + \\frac{v_2^2}{2g} + z_2 + h_L $$\nHere, $p$ is the pressure, $v$ is the average fluid velocity, $z$ is the elevation, $\\rho$ is the fluid density, $g$ is the acceleration due to gravity, and $h_L$ is the total head loss.\n\nWe apply the conditions given in the problem:\n1.  The pipeline has a constant internal diameter $D$, so the cross-sectional area $A$ is constant. By continuity ($Q = A_1 v_1 = A_2 v_2$), the average velocities are equal: $v_1 = v_2$. The kinetic energy terms thus cancel.\n2.  The elevation change is negligible, so $z_1 = z_2$.\n3.  Minor losses are negligible, so the total head loss $h_L$ is equal to the major frictional head loss, $h_f$.\n\nThe energy balance simplifies to:\n$$ \\frac{p_1 - p_2}{\\rho g} = h_f $$\nThe pressure drop is given as $\\Delta p = p_1 - p_2 = 8.0 \\times 10^{5}\\,\\text{Pa}$. Thus:\n$$ \\frac{\\Delta p}{\\rho g} = h_f $$\nFrictional head loss is described by the Darcy-Weisbach equation:\n$$ h_f = f \\frac{L}{D} \\frac{v^2}{2g} $$\nwhere $f$ is the Darcy friction factor.\n\nSubstituting the Darcy-Weisbach expression into the simplified energy balance yields:\n$$ \\frac{\\Delta p}{\\rho g} = f \\frac{L}{D} \\frac{v^2}{2g} $$\nMultiplying by $\\rho g$ gives the governing relationship between pressure drop and velocity:\n$$ \\Delta p = f \\frac{L}{D} \\frac{\\rho v^2}{2} $$\nTo express this in terms of the volumetric flow rate $Q$, we use the relation $v = Q/A$, where the area is $A = \\frac{\\pi D^2}{4}$. Substituting for $v$:\n$$ \\Delta p = f \\frac{L}{D} \\frac{\\rho}{2} \\left( \\frac{Q}{\\frac{\\pi D^2}{4}} \\right)^2 = f \\frac{L}{D} \\frac{8 \\rho}{\\pi^2 D^4} Q^2 $$\nThis is the governing relationship linking $Q$ to $\\Delta p$ and the other parameters.\n\nTo compute $Q$, we must determine the friction factor $f$. For turbulent flow, which is expected in a large pipeline, $f$ is a function of the Reynolds number, $Re$, and the relative roughness, $\\epsilon/D$. The Colebrook-White equation provides this relationship:\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} \\left( \\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f}} \\right) $$\nThe Reynolds number is defined as:\n$$ Re = \\frac{\\rho v D}{\\mu} = \\frac{4 \\rho Q}{\\pi D \\mu} $$\nThe system is implicit because $Q$ depends on $f$, which in turn depends on $Re$, which depends on $Q$. To solve this system, we can rearrange the equations. From the Darcy-Weisbach equation in terms of pressure:\n$$ v = \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} $$\nSubstituting this into the Reynolds number definition:\n$$ Re = \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} $$\nA useful grouping of terms is $Re\\sqrt{f}$:\n$$ Re\\sqrt{f} = \\left( \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} \\right) \\sqrt{f} = \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{\\rho L}} $$\nThis quantity is independent of the unknowns $f$ and $v$ (or $Q$), and can be calculated directly from the given data.\n\nFirst, we compute the constant parameters:\nRelative roughness: $\\frac{\\epsilon}{D} = \\frac{2.0 \\times 10^{-4}\\,\\text{m}}{0.60\\,\\text{m}} = \\frac{1}{3000} \\approx 3.333 \\times 10^{-4}$.\n\nNext, we compute the value of $Re\\sqrt{f}$:\n$$ Re\\sqrt{f} = \\frac{(870\\,\\text{kg}\\,\\text{m}^{-3})(0.60\\,\\text{m})}{1.5 \\times 10^{-2}\\,\\text{Pa}\\cdot\\text{s}} \\sqrt{\\frac{2(0.60\\,\\text{m})(8.0 \\times 10^{5}\\,\\text{Pa})}{(870\\,\\text{kg}\\,\\text{m}^{-3})(60{,}000\\,\\text{m})}} $$\n$$ Re\\sqrt{f} = (34800) \\sqrt{\\frac{9.6 \\times 10^5}{5.22 \\times 10^7}} = (34800) \\sqrt{0.0183908...} = (34800)(0.135612...) \\approx 4719.3 $$\nNow, we substitute this value into the Colebrook-White equation to find $f$:\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} \\left( \\frac{3.333 \\times 10^{-4}}{3.7} + \\frac{2.51}{4719.3} \\right) $$\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} (9.009 \\times 10^{-5} + 5.3188 \\times 10^{-4}) $$\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} (6.2197 \\times 10^{-4}) \\approx -2.0 (-3.2062) \\approx 6.4124 $$\nFrom this, we can solve for $f$:\n$$ f = \\left( \\frac{1}{6.4124} \\right)^2 \\approx 0.02432 $$\nWith the friction factor determined, we can now calculate the average velocity $v$:\n$$ v = \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} = \\sqrt{\\frac{2(0.60\\,\\text{m})(8.0 \\times 10^{5}\\,\\text{Pa})}{(0.02432)(870\\,\\text{kg}\\,\\text{m}^{-3})(60{,}000\\,\\text{m})}} $$\n$$ v = \\sqrt{\\frac{9.6 \\times 10^5}{1.270 \\times 10^6}} \\approx \\sqrt{0.7557} \\approx 0.8693\\,\\text{m}\\,\\text{s}^{-1} $$\nAs a check, we calculate the Reynolds number to confirm the turbulent flow assumption:\n$$ Re = \\frac{\\rho v D}{\\mu} = \\frac{(870)(0.8693)(0.60)}{1.5 \\times 10^{-2}} \\approx 30250 $$\nSince $Re > 4000$, the flow is turbulent, and our use of the Colebrook-White equation is appropriate.\n\nFinally, we calculate the maximum volumetric flow rate $Q$:\n$$ Q = A v = \\left( \\frac{\\pi D^2}{4} \\right) v = \\left( \\frac{\\pi (0.60\\,\\text{m})^2}{4} \\right) (0.8693\\,\\text{m}\\,\\text{s}^{-1}) $$\n$$ Q = (0.28274\\,\\text{m}^2)(0.8693\\,\\text{m}\\,\\text{s}^{-1}) \\approx 0.2458\\,\\text{m}^3\\,\\text{s}^{-1} $$\nRounding to three significant figures as requested, we obtain $Q = 0.246\\,\\text{m}^3\\,\\text{s}^{-1}$.",
            "answer": "$$\n\\boxed{0.246}\n$$"
        },
        {
            "introduction": "Real-world equipment cannot change its operating level instantaneously due to thermal and mechanical stresses. This practice challenges you to formalize these dynamic limitations, known as ramp rates, into linear constraints suitable for a discrete-time optimization model. Properly formulating these constraints is critical for creating operationally feasible schedules and avoiding models that assume unrealistic flexibility. ",
            "id": "4091777",
            "problem": "A pipeline segment transports crude oil from an upstream gathering manifold to a refinery inlet. Denote the volumetric throughput by $f(t)$ with units of $\\mathrm{m^3/h}$, and consider a discrete-time planning horizon indexed by $t \\in \\{1,2,\\dots,T\\}$ with nonuniform time-step lengths $\\Delta t_t$ in hours. The upstream pumps and the pipe material impose thermal and mechanical limitations that bound the rate of change of throughput: rapidly increasing $f(t)$ can exceed shaft torque and net head limits, while rapidly decreasing $f(t)$ can induce undesirable pressure transients and thermal stress. Engineers capture these limitations by specifying two nonnegative parameters $r^{+}$ and $r^{-}$, each with units of $\\mathrm{m^3/h^2}$, representing the maximum allowed upward and downward rates of change of throughput per unit time, respectively. The value at the beginning of the horizon, $f_0$, is known.\n\nStarting from the definitions of rate of change and the idea that the allowed time-derivative of throughput is bounded above by $r^{+}$ and bounded below by $-r^{-}$ due to pump power, fluid inertia, and thermal stress constraints, and acknowledging that in a Mixed-Integer Linear Programming (MILP) formulation one must express constraints linearly in the discrete-time variables $f_t$, select the option that correctly encodes the physically consistent ramp-rate constraints over the discrete-time horizon, including the initial period $t=1$.\n\nA. $-r^{-}\\,\\Delta t_t \\le f_t - f_{t-1} \\le r^{+}\\,\\Delta t_t$ for all $t \\in \\{1,\\dots,T\\}$, with $f_0$ given.\n\nB. $\\lvert f_t - f_{t-1} \\rvert \\le r\\,\\Delta t_t$ for all $t$, where $r = \\max\\{r^{+}, r^{-}\\}$.\n\nC. $\\dfrac{f_t - f_{t-1}}{f_{t-1}} \\le r^{+}$ and $\\dfrac{f_{t-1} - f_t}{f_{t-1}} \\le r^{-}$ for all $t$ with $f_{t-1} > 0$.\n\nD. $-r^{-} \\le f_t - f_{t-1} \\le r^{+}$ for all $t$, independent of $\\Delta t_t$.\n\nE. $-r^{-}\\,\\Delta t_t \\le \\dfrac{f_t}{f_{t-1}} - 1 \\le r^{+}\\,\\Delta t_t$ for all $t$ with $f_{t-1} > 0$.",
            "solution": "The problem asks for the correct mathematical formulation of ramp-rate constraints for a discrete-time optimization model, such as a Mixed-Integer Linear Program (MILP).\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Decision Variable:** $f(t)$, volumetric throughput in $\\mathrm{m^3/h}$.\n-   **Time Discretization:** The planning horizon is divided into discrete periods indexed by $t \\in \\{1, 2, \\dots, T\\}$.\n-   **Time Step Duration:** The duration of each time period $t$ is $\\Delta t_t$ hours, and these durations are not necessarily uniform.\n-   **Initial Condition:** The throughput at the start of the horizon, $f_0$, is a known value.\n-   **Ramp-Up Constraint:** The maximum allowed upward rate of change of throughput is $r^{+}$, a non-negative parameter with units of $\\mathrm{m^3/h^2}$.\n-   **Ramp-Down Constraint:** The maximum allowed downward rate of change of throughput is $r^{-}$, a non-negative parameter with units of $\\mathrm{m^3/h^2}$.\n-   **Objective:** Formulate these constraints linearly in terms of the discrete variables $f_t$ for all $t \\in \\{1, \\dots, T\\}$.\n\n**1.2. Validate Using Extracted Givens**\nThe problem statement is scientifically and mathematically sound.\n-   **Scientifically Grounded:** The concept of ramp-rate limitations due to mechanical (pump torque) and thermo-fluid (pressure transients, thermal stress) effects is a standard consideration in process systems engineering and control. The units provided ($\\mathrm{m^3/h}$ for throughput, $\\mathrm{h}$ for time, and $\\mathrm{m^3/h^2}$ for rate of change of throughput) are consistent.\n-   **Well-Posed:** The problem is well-defined. It asks for the translation of a physical constraint described in continuous-time terms (rate of change) into a discrete-time algebraic inequality suitable for linear programming. This is a standard and solvable formalization task.\n-   **Objective:** The language is technical and unambiguous.\n\n**1.3. Verdict and Action**\nThe problem is valid. The derivation and evaluation of options will proceed.\n\n### Step 2: Derivation from First Principles\n\nThe core physical principle is that the time derivative of the throughput, $\\frac{df}{dt}$, is bounded.\nThe maximum upward rate of change (the maximum positive value of the derivative) is $r^{+}$.\n$$ \\frac{df}{dt} \\le r^{+} $$\nThe maximum downward rate of change is $r^{-}$. A downward change corresponds to a negative derivative. A rate of $r^{-}$ means the derivative can be as low as $-r^{-}$.\n$$ \\frac{df}{dt} \\ge -r^{-} $$\nCombining these two inequalities gives the continuous-time constraint on the rate of change of throughput:\n$$ -r^{-} \\le \\frac{df}{dt} \\le r^{+} $$\nTo translate this into a discrete-time formulation for an MILP, we must approximate the derivative. A common and simple approximation for the average rate of change between two consecutive time points, say at the end of period $t-1$ and the end of period $t$, is the finite difference. Let $f_{t-1}$ be the throughput value for the period ending at time $\\tau_{t-1}$ and $f_t$ be the value for the period ending at time $\\tau_t$. The duration of the interval where the new flow rate $f_t$ is active is $\\Delta t_t = \\tau_t - \\tau_{t-1}$. The average rate of change between these two states is approximated by:\n$$ \\text{Average Rate of Change} \\approx \\frac{f_t - f_{t-1}}{\\Delta t_t} $$\nSubstituting this approximation into the continuous-time inequality:\n$$ -r^{-} \\le \\frac{f_t - f_{t-1}}{\\Delta t_t} \\le r^{+} $$\nTo obtain a linear constraint on the variables $f_t$ and $f_{t-1}$, we can multiply all parts of the inequality by $\\Delta t_t$. Since $\\Delta t_t$ represents a time duration, it is a positive quantity, so the direction of the inequalities is preserved:\n$$ -r^{-} \\Delta t_t \\le (f_t - f_{t-1}) \\le r^{+} \\Delta t_t $$\nThis constraint must hold for all transitions during the planning horizon, which are indexed by $t \\in \\{1, 2, \\dots, T\\}$. For $t=1$, the constraint involves the transition from the known initial state $f_0$ to the first decision variable $f_1$:\n$$ -r^{-} \\Delta t_1 \\le f_1 - f_0 \\le r^{+} \\Delta t_1 $$\nLet's check the dimensional consistency of the derived formulation.\n-   The change in throughput, $f_t - f_{t-1}$, has units of $\\mathrm{m^3/h}$.\n-   The rate limits, $r^{+}$ and $r^{-}$, have units of $\\mathrm{m^3/h^2}$.\n-   The time step duration, $\\Delta t_t$, has units of $\\mathrm{h}$.\n-   The product $r^{\\pm} \\Delta t_t$ has units of $(\\mathrm{m^3/h^2}) \\times \\mathrm{h} = \\mathrm{m^3/h}$.\nThe units are consistent across the inequality. The formulation is linear in the variables $f_t$, as required for an MILP.\n\n### Step 3: Option-by-Option Analysis\n\n**A. $-r^{-}\\,\\Delta t_t \\le f_t - f_{t-1} \\le r^{+}\\,\\Delta t_t$ for all $t \\in \\{1,\\dots,T\\}$, with $f_0$ given.**\n-   **Analysis:** This option directly matches the formulation derived from first principles. It correctly captures the asymmetric nature of the ramp limits ($r^{+}$ and $r^{-}$ can be different), incorporates the non-uniform time step durations $\\Delta t_t$ in a physically meaningful way, is dimensionally consistent, and is linear in the decision variables. It correctly applies to the entire horizon, including the initial step from $f_0$.\n-   **Verdict:** Correct.\n\n**B. $\\lvert f_t - f_{t-1} \\rvert \\le r\\,\\Delta t_t$ for all $t$, where $r = \\max\\{r^{+}, r^{-}\\}$.**\n-   **Analysis:** This expression implies symmetric ramp limits: $-r\\,\\Delta t_t \\le f_t - f_{t-1} \\le r\\,\\Delta t_t$. The problem statement specifies potentially different limits for ramping up ($r^{+}$) and ramping down ($r^{-}$). This formulation imposes the same limit magnitude, $\\max\\{r^{+}, r^{-}\\}$, for both directions. If $r^{+} \\ne r^{-}$, this formulation is either overly restrictive (e.g., if $r^{+} > r^{-}$, the downward ramp is limited by $-r^{+}\\Delta t_t$ instead of the less restrictive $-r^{-}\\Delta t_t$) or incorrect. It fails to model the specified asymmetric constraints.\n-   **Verdict:** Incorrect.\n\n**C. $\\dfrac{f_t - f_{t-1}}{f_{t-1}} \\le r^{+}$ and $\\dfrac{f_{t-1} - f_t}{f_{t-1}} \\le r^{-}$ for all $t$ with $f_{t-1} > 0$.**\n-   **Analysis:** This option has two fundamental flaws. First, it is dimensionally inconsistent. The left-hand sides, e.g., $\\frac{f_t - f_{t-1}}{f_{t-1}}$, are dimensionless ratios (relative change). The right-hand sides, $r^{+}$ and $r^{-}$, have units of $\\mathrm{m^3/h^2}$. Comparing a dimensionless quantity to one with units is invalid. Second, this formulation would lead to nonlinear constraints of the form $f_t - f_{t-1} \\le r^{+} f_{t-1}$, which is not suitable for a linear programming model. It also fails to account for the time step duration $\\Delta t_t$.\n-   **Verdict:** Incorrect.\n\n**D. $-r^{-} \\le f_t - f_{t-1} \\le r^{+}$ for all $t$, independent of $\\Delta t_t$.**\n-   **Analysis:** This option is dimensionally inconsistent. The term $f_t - f_{t-1}$ has units of throughput ($\\mathrm{m^3/h}$), while the parameters $r^{+}$ and $r^{-}$ have units of rate of change of throughput ($\\mathrm{m^3/h^2}$). An inequality cannot equate or compare quantities with different physical dimensions. Furthermore, it incorrectly implies that the total allowed change in throughput is independent of the time duration over which the change occurs, which contradicts the physical meaning of a rate limit.\n-   **Verdict:** Incorrect.\n\n**E. $-r^{-}\\,\\Delta t_t \\le \\dfrac{f_t}{f_{t-1}} - 1 \\le r^{+}\\,\\Delta t_t$ for all $t$ with $f_{t-1} > 0$.**\n-   **Analysis:** This is another dimensionally inconsistent formulation. The central term, $\\frac{f_t}{f_{t-1}} - 1 = \\frac{f_t-f_{t-1}}{f_{t-1}}$, is a dimensionless ratio. The terms on the left and right, $-r^{-}\\Delta t_t$ and $r^{+}\\Delta t_t$, have units of throughput, $\\mathrm{m^3/h}$ (since $(\\mathrm{m^3/h^2}) \\times \\mathrm{h} = \\mathrm{m^3/h}$). Comparing a dimensionless quantity to a quantity with units of throughput is physically and mathematically invalid. This formulation also introduces nonlinearity due to the $f_{t-1}$ term in the denominator.\n-   **Verdict:** Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A central challenge in supply chain management is deciding when to run a processing unit, balancing the high costs of starting up against the potential costs of shortages or inefficient operation. This problem introduces the unit commitment model, a cornerstone of energy systems optimization, where you will use binary variables and big-$M$ constraints to capture these complex economic trade-offs. By implementing an algorithm to find the optimal on/off schedule, you will gain firsthand experience with the logic that underpins large-scale mixed-integer programming models. ",
            "id": "4091824",
            "problem": "You are tasked with constructing and analyzing a simplified mixed-integer optimization model of a fossil fuel supply chain unit that converts a fossil input flow into an output flow to meet an exogenous demand over a discrete time horizon. The goal is to capture the setup and start-up cost effects on the operating schedule using binary decision variables and big-$M$ constraints, and to compute the cost-minimizing on/off schedule. Your program must implement the model and return the optimal operating schedules for a set of test cases.\n\nFundamental base and definitions:\n- The unit operates over a finite set of discrete time periods indexed by $t \\in \\{1,\\dots,T\\}$.\n- Let $d_t$ denote the exogenous output demand (e.g., gasoline) in barrels per hour, to be satisfied within period $t$, expressed in barrels per hour (bbl/h).\n- Let $S_t$ denote the fossil feedstock availability (e.g., crude oil supply) in barrels per hour, expressed in bbl/h.\n- Let $e$ denote the conversion factor of feedstock to output, measured in barrels of output per barrel of feedstock, expressed in bbl/bbl. For simplicity, assume $e = 1$ unless otherwise stated.\n- Let $M$ be the structural maximum output capacity of the unit in barrels per hour, expressed in bbl/h.\n- Let $x_t$ be the continuous decision variable for output in period $t$, measured in bbl/h.\n- Let $y_t \\in \\{0,1\\}$ be the binary on/off decision variable, where $y_t = 1$ indicates the unit is online in period $t$, and $y_t = 0$ indicates it is offline.\n- Let $z_t \\in \\{0,1\\}$ be the binary start-up indicator variable, where $z_t = 1$ if the unit transitions from offline to online between periods $t-1$ and $t$ (with $y_0 = 0$ given), and $z_t = 0$ otherwise.\n- Let $c^{var}$ be the variable production cost per barrel, expressed in dollars per barrel ($).\n- Let $c^{setup}$ be the fixed setup cost incurred in each period the unit is online, expressed in dollars ($).\n- Let $c^{start}$ be the start-up cost incurred each time the unit transitions from offline to online, expressed in dollars ($).\n- Let $c^{short}$ be the shortage penalty cost per barrel of unmet demand, expressed in dollars per barrel ($).\n\nModel formulation requirements:\n- Capacity linking via big-$M$ method: enforce the logical implication that output must be zero when the unit is offline and is bounded when online using the following constraints for each $t$:\n  $$x_t \\leq M \\cdot y_t,$$\n  $$x_t \\leq \\frac{S_t}{e},$$\n  $$x_t \\geq 0.$$\n  The first inequality is the big-$M$ constraint that links the continuous output variable $x_t$ to the binary on/off variable $y_t$. The second inequality enforces supply-chain feasibility given $S_t$ and $e$.\n- Start-up definition: for $t=1,\\dots,T$, define $z_t$ using the standard linearization consistent with binary variables and initial condition $y_0 = 0$:\n  $$z_t \\geq y_t - y_{t-1}, \\quad z_t \\geq 0, \\quad z_t \\leq y_t, \\quad z_t \\leq 1 - y_{t-1}.$$\n  In binary feasible schedules, this ensures $z_t = 1$ if and only if $y_{t-1} = 0$ and $y_t = 1$, and $z_t = 0$ otherwise.\n- Demand satisfaction with shortage: unmet demand $\\max(0, d_t - x_t)$ incurs a cost at rate $c^{short}$ per barrel. There is no inventory or backlogging across periods.\n\nObjective:\n- Minimize the total cost over the horizon, comprising variable production, per-period setup, start-up, and shortage penalty:\n  $$\\min \\sum_{t=1}^T \\left(c^{var} \\cdot x_t + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t) \\right).$$\n\nAlgorithmic requirement:\n- Because Mixed-Integer Linear Programming (MILP) solvers are not used here, derive a principled algorithm based on the model structure to evaluate the cost of any candidate binary schedule $\\{y_t\\}_{t=1}^T$, and then perform an exhaustive search over all binary schedules for small $T$. For a fixed schedule, compute the optimal $x_t$ in closed form, grounded in the above objective and constraints.\n\nOutput requirement:\n- For each test case, return the cost-minimizing schedule $\\{y_t\\}_{t=1}^T$ and the corresponding minimal total cost in dollars. Express costs in dollars ($) and operating decisions as integers $0$ or $1$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list whose first entry is the total cost in dollars (as a float), followed by the operating schedule entries $y_1, \\dots, y_T$ (as integers). For example, the output format for two cases could be $$[[1000.0,1,0,1],[0.0,0,0]]$$ printed on a single line.\n\nTest suite:\nUse the following scientifically plausible parameter sets, with all rates in barrels per hour (bbl/h) and costs in dollars ($). Assume $y_0 = 0$ and $e = 1$ for all cases.\n\n- Case $1$ (baseline fossil supply-constrained operation):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ $/bbl$,\n  - $c^{setup} = 100$ $,\n  - $c^{start} = 500$ $,\n  - $c^{short} = 200$ $/bbl$.\n\n- Case $2$ (higher start-up cost, same supply and demand):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ $/bbl$,\n  - $c^{setup} = 100$ $,\n  - $c^{start} = 2000$ $,\n  - $c^{short} = 200$ $/bbl$.\n\n- Case $3$ (zero start-up cost, higher per-period setup cost):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ $/bbl$,\n  - $c^{setup} = 300$ $,\n  - $c^{start} = 0$ $,\n  - $c^{short} = 200$ $/bbl$.\n\n- Case $4$ (single-period peak demand):\n  - $T = 1$,\n  - $d = [150]$ bbl/h,\n  - $S = [300]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 30$ $/bbl$,\n  - $c^{setup} = 200$ $,\n  - $c^{start} = 500$ $,\n  - $c^{short} = 300$ $/bbl$.\n\n- Case $5$ (zero demand across all periods):\n  - $T = 3$,\n  - $d = [0, 0, 0]$ bbl/h,\n  - $S = [100, 100, 100]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 25$ $/bbl$,\n  - $c^{setup} = 100$ $,\n  - $c^{start} = 500$ $,\n  - $c^{short} = 200$ $/bbl$.\n\n- Case $6$ (variable production cost exceeds shortage penalty):\n  - $T = 2$,\n  - $d = [60, 60]$ bbl/h,\n  - $S = [100, 100]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 500$ $/bbl$,\n  - $c^{setup} = 100$ $,\n  - $c^{start} = 200$ $,\n  - $c^{short} = 100$ $/bbl$.\n\nYour program must compute the optimal schedule for each case and print a single line containing a comma-separated list of the case results, with each case result formatted as a list $[ \\text{total\\_cost}, y_1, \\dots, y_T ]$ exactly as described above.",
            "solution": "The user-provided problem has been analyzed according to the specified validation protocol.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Time Horizon**: Discrete periods indexed by $t \\in \\{1, \\dots, T\\}$.\n- **Exogenous Demand**: $d_t$ in barrels per hour (bbl/h).\n- **Feedstock Availability**: $S_t$ in barrels per hour (bbl/h).\n- **Conversion Factor**: $e$ in bbl/bbl, with $e=1$ for all cases.\n- **Maximum Capacity**: $M$ in barrels per hour (bbl/h).\n- **Decision Variables**:\n    - Continuous output: $x_t \\geq 0$ (bbl/h).\n    - Binary on/off status: $y_t \\in \\{0, 1\\}$.\n    - Binary start-up indicator: $z_t \\in \\{0, 1\\}$.\n- **Initial Condition**: $y_0 = 0$.\n- **Cost Parameters**:\n    - Variable cost: $c^{var}$ ($/bbl).\n    - Setup cost: $c^{setup}$ ($).\n    - Start-up cost: $c^{start}$ ($).\n    - Shortage penalty: $c^{short}$ ($/bbl).\n- **Constraints for each period $t$**:\n    1. $x_t \\leq M \\cdot y_t$\n    2. $x_t \\leq S_t / e$\n    3. $x_t \\geq 0$\n    4. $z_t \\geq y_t - y_{t-1}$\n    5. $z_t \\geq 0, z_t \\leq y_t, z_t \\leq 1 - y_{t-1}$\n- **Objective Function**: Minimize total cost over the horizon $T$.\n  $$ \\min \\sum_{t=1}^T \\left(c^{var} \\cdot x_t + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t) \\right) $$\n- **Algorithmic Requirement**: An exhaustive search over all binary schedules $\\{y_t\\}_{t=1}^T$, utilizing a closed-form solution for the optimal $x_t$ given a fixed schedule.\n- **Provided Test Cases**: Six distinct parameter sets are specified.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n\n- **Scientifically Grounded**: The problem is a canonical representation of a unit commitment problem from operations research and energy systems engineering. The model elements (costs, capacities, binary decisions) are standard and fundamentally sound. It is scientifically valid.\n- **Well-Posed**: The task is to find a minimum cost over a finite set of $2^T$ schedules. For each schedule, the subproblem of determining optimal production is a convex optimization problem with a unique solution. A minimum cost and an associated optimal schedule are guaranteed to exist. The problem is well-posed.\n- **Objective**: The problem is stated using precise, unambiguous mathematical and economic terminology. It is free of subjective or opinion-based content.\n- **Completeness and Consistency**: The problem statement is self-contained. All necessary parameters, constraints, and objectives are clearly defined for each test case. There are no contradictions.\n- **Realism**: The parameters are stated to be scientifically plausible. The model, though simplified, captures realistic trade-offs in production planning, such as balancing start-up costs against operating costs and shortage penalties. The data are dimensionally consistent.\n- **Structure**: The problem is well-structured. The non-linear term $\\max(0, d_t - x_t)$ is a standard feature in such models, representing a convex penalty function. The required algorithmic approach (exhaustive search) is appropriate for the small values of $T$ given in the test cases.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-defined exercise in optimization modeling and algorithmic implementation. A solution will be provided.\n\n### Solution Derivation\n\nThe problem requires finding an optimal operating schedule $\\{y_t\\}_{t=1}^T$ and the corresponding production levels $\\{x_t\\}_{t=1}^T$ that minimize total cost. The specified algorithm is an exhaustive search over all possible binary schedules $\\{y_t\\}_{t=1}^T$. This is computationally feasible because the time horizon $T$ is small in the provided test cases (maximum $T=4$, corresponding to $2^4=16$ schedules).\n\nThe core of the algorithm is to compute the total cost for any given binary schedule $\\{y_t\\}$. For a fixed schedule, the objective function allows for a period-by-period determination of the optimal production levels $\\{x_t\\}$. The total cost is the sum of costs from each period.\n\nFor a specific period $t$, given a fixed value of $y_t$ (and $y_{t-1}$ to determine start-up), the cost components $c^{setup}y_t$ and $c^{start}z_t$ are fixed. The decision on $x_t$ is made to minimize the remaining variable portion of the cost for that period:\n$$ J_t(x_t) = c^{var} \\cdot x_t + c^{short} \\cdot \\max(0, d_t - x_t) $$\nThis minimization is subject to the constraints on $x_t$: $x_t \\leq M \\cdot y_t$, $x_t \\leq S_t/e$, and $x_t \\geq 0$.\n\nWe analyze the determination of the optimal production $x_t^{opt}$ and the resulting period cost $C_t$:\n\n**1. Unit is Offline ($y_t = 0$)**\nThe constraint $x_t \\leq M \\cdot y_t$ becomes $x_t \\leq 0$. Combined with $x_t \\geq 0$, this forces the production to be $x_t^{opt} = 0$. The start-up variable $z_t$ must also be $0$ since $z_t \\leq y_t$. The cost for period $t$ is due entirely to the unmet demand:\n$$ C_t = c^{var} \\cdot 0 + c^{setup} \\cdot 0 + c^{start} \\cdot 0 + c^{short} \\cdot \\max(0, d_t - 0) = c^{short} \\cdot d_t $$\n\n**2. Unit is Online ($y_t = 1$)**\nThe constraints on $x_t$ become $0 \\leq x_t \\leq M$ and $x_t \\leq S_t/e$. Thus, $x_t$ must be within the range $[0, X_{max,t}]$, where the effective capacity is $X_{max,t} = \\min(M, S_t/e)$. We must find the $x_t$ in this range that minimizes $J_t(x_t)$.\n\nThe function $J_t(x_t)$ is convex and piecewise linear. Its derivative with respect to $x_t$ is:\n$$ \\frac{dJ_t}{dx_t} = \\begin{cases} c^{var} - c^{short} & \\text{if } x_t < d_t \\\\ c^{var} & \\text{if } x_t > d_t \\end{cases} $$\nThe optimal choice of $x_t$ depends on the sign of the slope $c^{var} - c^{short}$.\n\n- **Subcase 2a: $c^{var} < c^{short}$**\nThe slope is negative for $x_t < d_t$ and positive for $x_t > d_t$. The function $J_t(x_t)$ is minimized at $x_t = d_t$. To satisfy the capacity constraints, we should produce as close to the demand as possible. The optimal production is:\n$$ x_t^{opt} = \\min(d_t, X_{max,t}) = \\min(d_t, M, S_t/e) $$\nThis is the standard economic logic: if the cost of production is less than the penalty for not producing, then produce to meet demand up to physical limits.\n\n- **Subcase 2b: $c^{var} \\geq c^{short}$**\nThe slope is non-negative everywhere ($c^{var} - c^{short} \\ge 0$ and $c^{var} > 0$). $J_t(x_t)$ is a non-decreasing function of $x_t$. To minimize it, we must choose the smallest possible value for $x_t$, which is $x_t^{opt} = 0$. This implies that even if the unit is turned on, it is more cost-effective to produce nothing and pay the full shortage penalty than to incur the variable production cost. Comparing the total cost of being online ($y_t=1$) versus offline ($y_t=0$) shows that being online adds a strictly positive setup cost ($c^{setup} > 0$) for no benefit. Therefore, in this regime, the optimal decision would always be to keep the unit off, unless all costs and demands are zero. The general algorithm correctly finds this, so no special case is needed.\n\nThe cost for the period $t$ when $y_t=1$ is calculated based on the determined $x_t^{opt}$. The start-up variable $z_t$ is $1$ if the unit was previously off ($y_{t-1}=0$) and is now on ($y_t=1$), and $0$ otherwise. Given the initial condition $y_0 = 0$, this can be written as $z_t = y_t \\cdot (1 - y_{t-1})$ for $t \\geq 1$. The period cost is:\n$$ C_t = c^{var} \\cdot x_t^{opt} + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t^{opt}) $$\n\n**Algorithm Summary**\nFor each test case:\n1. Initialize `min_total_cost` to infinity and `best_schedule` to `None`.\n2. Iterate through each integer $i$ from $0$ to $2^T - 1$. Each integer's binary representation corresponds to a unique candidate schedule $\\{y_1, \\dots, y_T\\}$.\n3. For each schedule, calculate the total cost by summing the period costs $C_t$ from $t=1$ to $T$.\n    a. For each period $t$, determine $y_t$ from the schedule.\n    b. Based on $y_t$ (and $y_{t-1}$), calculate $x_t^{opt}$ and $z_t$ as derived above.\n    c. Compute the period cost $C_t$.\n4. If the calculated total cost for the current schedule is less than `min_total_cost`, update `min_total_cost` and `best_schedule`.\n5. After iterating through all $2^T$ schedules, the optimal schedule and its cost are found. Store this result.\n6. After processing all test cases, format the collected results into a single string as specified and print it.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the cost-minimizing on/off schedule for a fossil fuel unit\n    by performing an exhaustive search over all possible binary schedules.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (T, d, S, M, c_var, c_setup, c_start, c_short)\n    # e is assumed to be 1.0 for all cases.\n    test_cases = [\n        # Case 1\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 100, 500, 200),\n        # Case 2\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 100, 2000, 200),\n        # Case 3\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 300, 0, 200),\n        # Case 4\n        (1, [150], [300], 100, 30, 200, 500, 300),\n        # Case 5\n        (3, [0, 0, 0], [100, 100, 100], 100, 25, 100, 500, 200),\n        # Case 6\n        (2, [60, 60], [100, 100], 100, 500, 100, 200, 100),\n    ]\n\n    all_results = []\n    e = 1.0 # Conversion factor\n\n    for case in test_cases:\n        T, d, S, M, c_var, c_setup, c_start, c_short = case\n        \n        min_total_cost = np.inf\n        best_schedule = []\n\n        num_schedules = 2**T\n        for i in range(num_schedules):\n            # Generate a candidate schedule {y_1, ..., y_T}\n            # (i >> t) & 1 gives bits from right-to-left, which works for t=0..T-1\n            # corresponding to periods 1..T\n            y_schedule = [(i >> t) & 1 for t in range(T)]\n            \n            current_total_cost = 0.0\n            y_prev = 0  # y_0 is given as 0\n\n            for t_idx in range(T):\n                y_t = y_schedule[t_idx]\n                d_t = d[t_idx]\n                S_t = S[t_idx]\n                \n                period_cost = 0.0\n                \n                if y_t == 0:\n                    # Unit is offline. Production is 0. Cost is only from unmet demand.\n                    # z_t is 0 since z_t <= y_t. No setup or startup cost.\n                    period_cost = c_short * d_t\n                else: # y_t == 1\n                    # Unit is online.\n                    \n                    # Determine start-up: z_t = 1 if y_t=1 and y_{t-1}=0\n                    z_t = 1 if y_prev == 0 else 0\n                    \n                    # Determine optimal production x_t\n                    X_max_t = min(M, S_t / e)\n                    \n                    x_t = 0.0\n                    if c_var < c_short:\n                        # Produce to meet demand up to capacity if cheaper than shortage\n                        x_t = min(d_t, X_max_t)\n                    else:\n                        # Cheaper to not produce and incur shortage penalty\n                        x_t = 0.0\n\n                    shortage = max(0, d_t - x_t)\n                    \n                    period_cost = (c_var * x_t) + c_setup + (c_start * z_t) + (c_short * shortage)\n\n                current_total_cost += period_cost\n                y_prev = y_t\n\n            if current_total_cost < min_total_cost:\n                min_total_cost = current_total_cost\n                best_schedule = y_schedule\n\n        # Format the result for the current case\n        case_result = [float(min_total_cost)] + best_schedule\n        all_results.append(case_result)\n\n    # Print all results in the specified single-line format\n    # The format [[cost,y1,...],[cost,y1,...]] is Python's list-to-string without spaces.\n    print(str(all_results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}