{
    "hands_on_practices": [
        {
            "introduction": "在生物燃料供应链的建模中，评估系统的环境绩效至关重要。生物精炼厂通常会生产多种有价值的产品，例如燃料乙醇和剩余电力，这就引发了如何在这些联产品之间分配上游和过程中的环境负担（如温室气体排放）的问题。本练习将引导您应用生命周期评估（LCA）中两种核心的联产品处理方法——能量分配法和系统扩展法，以量化乙醇的温室气体强度 。通过这项实践，您将掌握如何实施这些关键的LCA方法论，并深入理解可持续性指标对建模选择的敏感性。",
            "id": "4072439",
            "problem": "一家纤维素生物精炼厂处理一公吨干燥的木质纤维素生物质，并生产两种能源产品：燃料乙醇和并网的剩余电力。您需要采用两种副产品处理方法——能量分配法和系统扩展法——来量化乙醇的温室气体 (GHG) 强度，然后计算这两种强度之间的差异。\n\n使用以下具有科学依据且内部一致的数据和假设：\n- 生命周期评估 (LCA) 的系统边界为乙醇产品的“从摇篮到大门”阶段，计算到工厂大门为止的所有非生物源排放。生物源的二氧化碳不计算在内；甲烷和一氧化二氮包含在给定的总排放量中。\n- 对于这一公吨批次，上游供应链总温室气体排放（包括收获、预处理和运输）为 $120$ 千克二氧化碳当量 (kg $\\text{CO}_{2}\\text{e}$)。\n- 对于这一公吨批次，生物精炼厂的总非生物源工艺排放为 $300$ kg $\\text{CO}_{2}\\text{e}$。\n- 乙醇产率为每吨 $300$ 升，乙醇的低位热值 (LHV) 等于每升 $21.1$ 兆焦耳 (MJ/L)。\n- 每吨净输出电量为 $0.60$ 兆瓦时 (MWh)。使用 $3600$ MJ/MWh 将电能转换为兆焦耳。\n- 被替代电力的电网平均温室气体排放因子为每兆瓦时 $450$ kg $\\text{CO}_{2}\\text{e}$。\n- 能量分配法：环境负荷按副产品的能量含量比例分摊。\n- 系统扩展法：将输出的电力建模为在能量等效的基础上替代平均电网电力；分配一个等于排放因子乘以输出电量的避免负荷抵免。剩余的净负荷完全分配给乙醇。\n\n仅从质量和能量守恒以及生命周期评估 (LCA) 中分配和替代的定义出发，推导每种方法下乙醇的温室气体强度表达式，并计算其数值。然后，计算定义为“能量分配法强度减去系统扩展法强度”的差值。将最终差值以每兆焦耳乙醇能量的克 $\\text{CO}_{2}\\text{e}$ (g $\\text{CO}_{2}\\text{e}$/MJ) 为单位表示，并将最终答案四舍五入到四位有效数字。",
            "solution": "该问题要求在生命周期评估 (LCA) 框架下，使用两种不同的副产品分配方法（能量分配法和系统扩展法）计算乙醇的温室气体 (GHG) 强度。最终目标是计算这两种强度之间的差异。系统边界为处理一公吨 ($1$ t) 干燥木质纤维素生物质的“从摇篮到大门”阶段。\n\n首先，我们根据所提供的数据，定义并量化系统总排放量和副产品的能量含量。\n\n上游和工艺的总排放量（记为 $E_{total}$）是供应链排放量（$E_{up}$）和生物精炼厂工艺排放量（$E_{proc}$）的总和。\n设 $E_{up} = 120 \\text{ kg } \\text{CO}_{2}\\text{e}$ 且 $E_{proc} = 300 \\text{ kg } \\text{CO}_{2}\\text{e}$。\n$$\nE_{total} = E_{up} + E_{proc} = 120 \\text{ kg } \\text{CO}_{2}\\text{e} + 300 \\text{ kg } \\text{CO}_{2}\\text{e} = 420 \\text{ kg } \\text{CO}_{2}\\text{e}\n$$\n\n接下来，我们计算两种副产品（燃料乙醇和剩余电力）的能量含量。\n\n乙醇的能量含量 $En_{eth}$ 是每吨生物质的乙醇产率 $Y_{eth} = 300 \\text{ L/t}$ 与乙醇的低位热值 (LHV) $LHV_{eth} = 21.1 \\text{ MJ/L}$ 的乘积。\n$$\nEn_{eth} = Y_{eth} \\times LHV_{eth} = 300 \\text{ L} \\times 21.1 \\frac{\\text{MJ}}{\\text{L}} = 6330 \\text{ MJ}\n$$\n\n输出电力的能量含量 $En_{elec}$ 是每吨净输出电量 $Q_{elec} = 0.60 \\text{ MWh/t}$ 与从兆瓦时到兆焦耳的转换因子 $C_{conv} = 3600 \\text{ MJ/MWh}$ 的乘积。\n$$\nEn_{elec} = Q_{elec} \\times C_{conv} = 0.60 \\text{ MWh} \\times 3600 \\frac{\\text{MJ}}{\\text{MWh}} = 2160 \\text{ MJ}\n$$\n\n现在我们可以为两种指定的方法分别计算乙醇的温室气体强度。\n\n**1. 能量分配法**\n\n在能量分配法下，总温室气体负荷 ($E_{total}$) 根据副产品各自的能量含量按比例在它们之间进行分配。系统的总能量输出为 $En_{total\\_alloc}$。\n$$\nEn_{total\\_alloc} = En_{eth} + En_{elec} = 6330 \\text{ MJ} + 2160 \\text{ MJ} = 8490 \\text{ MJ}\n$$\n分配给乙醇的总能量比例为 $f_{eth} = \\frac{En_{eth}}{En_{total\\_alloc}}$。分配给乙醇的排放量 $E_{eth\\_alloc}$ 则为 $E_{total} \\times f_{eth}$。\n能量分配法下乙醇的温室气体强度 $I_{alloc}$ 是分配的排放量除以乙醇能量：\n$$\nI_{alloc} = \\frac{E_{eth\\_alloc}}{En_{eth}} = \\frac{E_{total} \\times \\frac{En_{eth}}{En_{total\\_alloc}}}{En_{eth}} = \\frac{E_{total}}{En_{total\\_alloc}}\n$$\n代入数值：\n$$\nI_{alloc} = \\frac{420 \\text{ kg } \\text{CO}_{2}\\text{e}}{8490 \\text{ MJ}}\n$$\n\n**2. 系统扩展法**\n\n在系统扩展法（或替代法）下，副产品（电力）被假定为替代了市场上的等效产品（电网电力）。这种替代产生了一个避免的排放抵免 $E_{credit}$，该抵免从系统总排放量中减去。电网平均温室气体排放因子给出为 $I_{grid} = 450 \\text{ kg } \\text{CO}_{2}\\text{e}/\\text{MWh}$。\n该抵免计算如下：\n$$\nE_{credit} = Q_{elec} \\times I_{grid} = 0.60 \\text{ MWh} \\times 450 \\frac{\\text{kg } \\text{CO}_{2}\\text{e}}{\\text{MWh}} = 270 \\text{ kg } \\text{CO}_{2}\\text{e}\n$$\n系统的净排放量 $E_{net}$ 随后完全归于主要产品乙醇。\n$$\nE_{net} = E_{total} - E_{credit} = 420 \\text{ kg } \\text{CO}_{2}\\text{e} - 270 \\text{ kg } \\text{CO}_{2}\\text{e} = 150 \\text{ kg } \\text{CO}_{2}\\text{e}\n$$\n系统扩展法下乙醇的温室气体强度 $I_{exp}$ 是这些净排放量除以乙醇的能量含量。\n$$\nI_{exp} = \\frac{E_{net}}{En_{eth}} = \\frac{150 \\text{ kg } \\text{CO}_{2}\\text{e}}{6330 \\text{ MJ}}\n$$\n\n**3. 计算差值**\n\n问题要求计算差值 $D$，定义为能量分配法强度减去系统扩展法强度。\n$$\nD = I_{alloc} - I_{exp} = \\frac{420}{8490} \\frac{\\text{kg } \\text{CO}_{2}\\text{e}}{\\text{MJ}} - \\frac{150}{6330} \\frac{\\text{kg } \\text{CO}_{2}\\text{e}}{\\text{MJ}}\n$$\n为将结果表示为每兆焦耳克 $\\text{CO}_{2}\\text{e}$ (g $\\text{CO}_{2}\\text{e}$/MJ)，我们乘以 $1000 \\text{ g/kg}$。\n$$\nD \\left[\\frac{\\text{g } \\text{CO}_{2}\\text{e}}{\\text{MJ}}\\right] = \\left( \\frac{420}{8490} - \\frac{150}{6330} \\right) \\times 1000\n$$\n计算数值：\n$$\nD = \\left( 0.04946996... - 0.02370000... \\right) \\times 1000\n$$\n$$\nD = (0.02576996...) \\times 1000 = 25.76996... \\frac{\\text{g } \\text{CO}_{2}\\text{e}}{\\text{MJ}}\n$$\n为了更精确，我们可以使用分数形式。让我们化简这些分数：\n$\\frac{420}{8490} = \\frac{42}{849} = \\frac{14}{283}$\n$\\frac{150}{6330} = \\frac{15}{633} = \\frac{5}{211}$\n$$\nD = \\left( \\frac{14}{283} - \\frac{5}{211} \\right) \\times 1000 = \\left( \\frac{14 \\times 211 - 5 \\times 283}{283 \\times 211} \\right) \\times 1000\n$$\n$$\nD = \\left( \\frac{2954 - 1415}{59713} \\right) \\times 1000 = \\frac{1539}{59713} \\times 1000 \\approx 25.774008... \\frac{\\text{g } \\text{CO}_{2}\\text{e}}{\\text{MJ}}\n$$\n将最终答案四舍五入到四位有效数字，得到 $25.77$。",
            "answer": "$$\n\\boxed{25.77}\n$$"
        },
        {
            "introduction": "优化模型是设计和管理高效生物燃料供应链的核心工具，其目标通常是最小化总成本或最大化利润。当我们将供应链构建为线性规划（LP）问题时，模型的解不仅提供了最优的生产和运输计划，其对偶变量（或称影子价格）也蕴含了宝贵的经济信息。本练习将探讨如何计算并解读炼油厂产能约束的影子价格，该价格量化了增加一单位产能所能带来的边际经济效益 。这项实践使您能够利用优化模型的输出来指导关键的战略投资决策，例如是否值得投资扩建某个设施的产能。",
            "id": "4072481",
            "problem": "考虑一个简化的但科学上真实的生物质制生物燃料供应链的混合整数线性规划（MILP）表示。在该供应链中，来自农场的玉米秸秆被运往生物精炼厂，转化为乙醇，然后输送到一个终端以满足固定的需求。对于本问题，请关注于控制流量和容量的连续线性规划子结构，并在线性规划对偶性的通常意义上解释容量约束的对偶变量（即，影子价格是在最优活动集和整数性模式保持不变的情况下，最优目标值随右手边单位变化而发生的边际变化）。两个农场，记为 $F_1$ 和 $F_2$，可以将原料运往两个生物精炼厂，记为 $R_1$ 和 $R_2$。目标是最小化年化系统总成本，以满足终端固定的乙醇需求，需求量为 $D = 1.2亿\\text{升}$。生物精炼厂 $R_1$ 的容量为 $K_1 = 1亿\\text{升}$，而对于所考虑的需求规模，$R_2$ 的容量实际上不受限制。假设 $F_1$ 和 $F_2$ 的原料供应充足，因此单位成本不受稀缺性影响。\n\n数据如下。产率（升/公吨）在 $R_1$ 为 $y_1 = 320\\,\\text{L/t}$，在 $R_2$ 为 $y_2 = 300\\,\\text{L/t}$。农场交货原料成本（美元/公吨）为 $c_{F_1} = 35\\,\\$/\\text{t}$ 和 $c_{F_2} = 45\\,\\$/\\text{t}$。从农场到精炼厂的运输成本（美元/公吨）为 $t_{F_1,R_1} = 6\\,\\$/\\text{t}$，$t_{F_1,R_2} = 12\\,\\$/\\text{t}$，$t_{F_2,R_1} = 10\\,\\$/\\text{t}$ 和 $t_{F_2,R_2} = 5\\,\\$/\\text{t}$。精炼厂的单位转化（运营）成本（美元/升）在 $R_1$ 为 $k_1 = 0.12\\,\\$/\\text{L}$，在 $R_2$ 为 $k_2 = 0.15\\,\\$/\\text{L}$。假设每个精炼厂都将从能使其在满负荷运转时单位乙醇成本最低的农场采购原料，即，混合或凸组合不会改变边际上的平均单位成本。\n\n定义决策变量 $q_1$ 和 $q_2$ 分别为 $R_1$ 和 $R_2$ 的乙醇生产率（升）。必须满足需求，因此 $q_1 + q_2 \\ge D$；$R_1$ 的容量限制为 $q_1 \\le K_1$。由农场 $F_i$ 供应的精炼厂 $R_j$ 的每升成本由下式给出\n$$\nc_{i \\to j}^{(\\text{L})} \\;=\\; \\frac{c_{F_i} + t_{F_i,R_j}}{y_j} + k_j,\n$$\n对于每个精炼厂，您将使用所有农场中的最小值（最便宜的路线）。假设一项工程研究表明，$R_1$ 的边际容量扩张成本为年产能的 $\\gamma = 0.050\\,\\$/\\text{L}$。将此 $\\gamma$ 视为每增加一升容量的边际成本，并对于无穷小扩张决策，忽略固定费用非凸性。\n\n从基本的线性规划对偶性以及将影子价格解释为与右手边扰动相关的拉格朗日乘子出发，计算当前最优解下 $R_1$ 容量约束的影子价格（单位：$\\$/\\text{L}$），并将其与 $\\gamma$ 进行比较。哪个选项是正确的？\n\nA. $R_1$ 容量的影子价格为 $0.05854\\,\\$/\\text{L}$；因为 $0.05854 > \\gamma = 0.050$，在边际上对 $K_1$ 进行无穷小扩张在经济上是合理的。\n\nB. $R_1$ 容量的影子价格为 $-0.05854\\,\\$/\\text{L}$；因为它是负数，扩张 $K_1$ 会增加总成本，所以无穷小扩张是不合理的。\n\nC. 影子价格等于 $R_2$ 的全部单位成本 $0.30667\\,\\$/\\text{L}$；由于这超过了 $\\gamma = 0.050$，不应进行扩张。\n\nD. 容量约束的对偶变量在混合整数线性规划中没有意义，因此无法计算或解释 $K_1$ 的影子价格。",
            "solution": "用户要求对一个关于生物燃料供应链优化的问题陈述进行严格验证，然后完整推导解决方案并评估所提供的选项。\n\n### 问题验证\n\n第一步是严格验证问题陈述。\n\n#### 步骤1：提取已知条件\n\n逐字提取所有明确的数据和条件：\n- **模型类型**：简化的混合整数线性规划（MILP）表示，但侧重于连续线性规划（LP）子结构。\n- **目标**：最小化年化系统总成本。\n- **实体**：两个农场（$F_1$、$F_2$），两个生物精炼厂（$R_1$、$R_2$），一个终端。\n- **需求**：固定的乙醇需求 $D = 120,000,000$ 升。\n- **容量**：精炼厂 $R_1$ 的容量 $K_1 = 100,000,000$ 升。精炼厂 $R_2$ 实际上不受限制。\n- **原料**：$F_1$ 和 $F_2$ 的供应充足。\n- **产率**：$y_1 = 320$ 升/公吨（在 $R_1$），$y_2 = 300$ 升/公吨（在 $R_2$）。\n- **农场交货成本**：$c_{F_1} = 35$ 美元/公吨, $c_{F_2} = 45$ 美元/公吨。\n- **运输成本**：$t_{F_1,R_1} = 6$ 美元/公吨, $t_{F_1,R_2} = 12$ 美元/公吨, $t_{F_2,R_1} = 10$ 美元/公吨, $t_{F_2,R_2} = 5$ 美元/公吨。\n- **转化成本**：$k_1 = 0.12$ 美元/升（在 $R_1$），$k_2 = 0.15$ 美元/升（在 $R_2$）。\n- **采购规则**：每个精炼厂从能提供最低单位乙醇成本的农场采购。\n- **决策变量**：$q_1$（$R_1$ 的乙醇产量），$q_2$（$R_2$ 的乙醇产量）。\n- **约束条件**：$q_1 + q_2 \\ge D$，$q_1 \\le K_1$。\n- **成本公式**：由农场 $F_i$ 供应的精炼厂 $R_j$ 的每升成本为 $c_{i \\to j}^{(\\text{L})} = \\frac{c_{F_i} + t_{F_i,R_j}}{y_j} + k_j$。\n- **扩张成本**：$R_1$ 的边际容量扩张成本为 $\\gamma = 0.050$ 美元/升。\n- **问题**：计算 $R_1$ 容量约束的影子价格（单位：美元/升），并将其与 $\\gamma$ 进行比较。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n- **科学上成立**：该问题描述了一个经典的产能规划和资源分配情景，使用线性规划进行建模。这是运筹学和能源系统工程中的一个标准和基础课题。所有概念，包括单位成本计算、LP公式化以及对偶变量（影子价格）的解释，都基于成熟的科学和数学原理。所提供的数据在数值上对于生物燃料行业是合理的。\n- **良定**：该问题定义清晰，有明确的目标（成本最小化）、明确的决策变量以及一套完整的约束和参数。采购规则简化了模型，确保单位成本是恒定的，从而保持了目标函数的线性。这种结构保证了唯一且有意义的解的存在。\n- **客观**：问题以精确、定量和客观的技术语言陈述。它不含主观或模糊的术语。\n\n该问题没有表现出验证协议中列出的任何缺陷。它在科学上是合理的，是良定的，并且是客观的。提及MILP仅仅是提供背景信息，因为问题明确指示将重点放在LP子结构和标准的LP对偶性上，从而避免了MILP对偶的任何潜在复杂性或模糊性。\n\n#### 步骤3：结论与行动\n\n问题陈述是**有效的**。开始求解。\n\n### 解题推导\n\n该问题要求我们确定精炼厂 $R_1$ 容量约束的影子价格，并用它来评估一项扩张决策。\n\n**1. 计算每个精炼厂的单位生产成本**\n\n问题指出，每个精炼厂从能提供最低每升乙醇成本的农场采购。成本由 $c_{i \\to j}^{(\\text{L})} = \\frac{c_{F_i} + t_{F_i,R_j}}{y_j} + k_j$ 给出。\n\n*   **对于精炼厂 $R_1$ ($y_1=320\\,\\text{L/t}$, $k_1=0.12\\,\\$/\\text{L}$):**\n    *   从农场 $F_1$ 采购：\n        $$c_{1 \\to 1}^{(\\text{L})} = \\frac{c_{F_1} + t_{F_1,R_1}}{y_1} + k_1 = \\frac{35\\,\\$/\\text{t} + 6\\,\\$/\\text{t}}{320\\,\\text{L/t}} + 0.12\\,\\$/\\text{L} = \\frac{41}{320}\\,\\$/\\text{L} + 0.12\\,\\$/\\text{L} = 0.128125\\,\\$/\\text{L} + 0.12\\,\\$/\\text{L} = 0.248125\\,\\$/\\text{L}$$\n    *   从农场 $F_2$ 采购：\n        $$c_{2 \\to 1}^{(\\text{L})} = \\frac{c_{F_2} + t_{F_2,R_1}}{y_1} + k_1 = \\frac{45\\,\\$/\\text{t} + 10\\,\\$/\\text{t}}{320\\,\\text{L/t}} + 0.12\\,\\$/\\text{L} = \\frac{55}{320}\\,\\$/\\text{L} + 0.12\\,\\$/\\text{L} = 0.171875\\,\\$/\\text{L} + 0.12\\,\\$/\\text{L} = 0.291875\\,\\$/\\text{L}$$\n    比较两者，$0.248125  0.291875$。因此，$R_1$ 将完全从 $F_1$ 采购，其有效单位生产成本为 $C_1 = 0.248125\\,\\$/\\text{L}$。\n\n*   **对于精炼厂 $R_2$ ($y_2=300\\,\\text{L/t}$, $k_2=0.15\\,\\$/\\text{L}$):**\n    *   从农场 $F_1$ 采购：\n        $$c_{1 \\to 2}^{(\\text{L})} = \\frac{c_{F_1} + t_{F_1,R_2}}{y_2} + k_2 = \\frac{35\\,\\$/\\text{t} + 12\\,\\$/\\text{t}}{300\\,\\text{L/t}} + 0.15\\,\\$/\\text{L} = \\frac{47}{300}\\,\\$/\\text{L} + 0.15\\,\\$/\\text{L} \\approx 0.156667\\,\\$/\\text{L} + 0.15\\,\\$/\\text{L} = 0.306667\\,\\$/\\text{L}$$\n    *   从农场 $F_2$ 采购：\n        $$c_{2 \\to 2}^{(\\text{L})} = \\frac{c_{F_2} + t_{F_2,R_2}}{y_2} + k_2 = \\frac{45\\,\\$/\\text{t} + 5\\,\\$/\\text{t}}{300\\,\\text{L/t}} + 0.15\\,\\$/\\text{L} = \\frac{50}{300}\\,\\$/\\text{L} + 0.15\\,\\$/\\text{L} \\approx 0.166667\\,\\$/\\text{L} + 0.15\\,\\$/\\text{L} = 0.316667\\,\\$/\\text{L}$$\n    比较两者，$0.306667  0.316667$。因此，$R_2$ 也将完全从 $F_1$ 采购，其有效单位生产成本为 $C_2 = \\frac{47}{300} + 0.15 = \\frac{47+45}{300} = \\frac{92}{300} = \\frac{23}{75} \\approx 0.306667\\,\\$/\\text{L}$。\n\n**2. 建立并求解线性规划模型**\n\n目标是最小化总成本 $Z = C_1 q_1 + C_2 q_2$。\n$$ \\text{最小化} \\quad Z = 0.248125 q_1 + \\frac{23}{75} q_2 $$\n约束条件：\n$$\n\\begin{align*}\nq_1 + q_2 \\ge 120,000,000  \\text{(需求)} \\\\\nq_1 \\le 100,000,000  \\text{(容量 } R_1\\text{)} \\\\\nq_1, q_2 \\ge 0\n\\end{align*}\n$$\n我们已计算出单位成本 $C_1 = 0.248125\\,\\$/\\text{L}$ 和 $C_2 \\approx 0.306667\\,\\$/\\text{L}$。由于 $C_1  C_2$，经济上最优的策略是在较便宜的精炼厂 $R_1$ 生产尽可能多的产品。$R_1$ 的容量将其产量限制在 $q_1 = K_1 = 100,000,000\\,\\text{L}$。\n\n为了满足 $D = 120,000,000\\,\\text{L}$ 的总需求，剩余部分必须由 $R_2$ 生产：\n$$ q_2 = D - q_1 = 120,000,000 - 100,000,000 = 20,000,000\\,\\text{L} $$\n最优生产计划是 $q_1^* = 100,000,000\\,\\text{L}$ 和 $q_2^* = 20,000,000\\,\\text{L}$。在此解下，需求约束（$100+20=120$）和 $R_1$ 的容量约束都是激活的（紧的）。\n\n**3. 计算容量约束的影子价格**\n\n一个约束的影子价格是指该约束的右手边（RHS）放宽一个单位时，最优目标函数值的边际变化。该约束为 $q_1 \\le K_1$。我们关心的是增加 $K_1$ 的效果。\n\n让我们考虑一个无穷小的容量增量 $dK_1$。因为 $C_1  C_2$，所以利用 $R_1$ 的这个新容量仍然是最优的。$R_1$ 的新产量将是 $q_1 = K_1 + dK_1$。为了维持需求平衡 $q_1 + q_2 = D$，$R_2$ 的产量必须减少相同的量：$q_2 = (D - K_1) - dK_1$。\n产量的变化是 $dq_1 = dK_1$ 和 $dq_2 = -dK_1$。\n\n总成本的变化 $dZ$ 为：\n$$ dZ = C_1 dq_1 + C_2 dq_2 = C_1(dK_1) + C_2(-dK_1) = (C_1 - C_2)dK_1 $$\n影子价格定义为 $K_1$ 每增加一个单位所带来的边际*改善*（成本降低）。数学上，这表示为 $-\\frac{dZ}{dK_1}$。\n$$ \\text{影子价格} = -\\frac{dZ}{dK_1} = -(C_1 - C_2) = C_2 - C_1 $$\n这个结果是直观的：对于较便宜的精炼厂 $R_1$ 每增加一升的容量，我们就可以将一升的生产从较昂贵的精炼厂 $R_2$ 转移过来，从而节省它们之间的单位成本差额。\n\n现在，我们计算数值：\n$$ \\text{影子价格} = C_2 - C_1 = \\frac{23}{75}\\,\\$/\\text{L} - 0.248125\\,\\$/\\text{L} \\approx 0.306667\\,\\$/\\text{L} - 0.248125\\,\\$/\\text{L} = 0.05854166... \\,\\$/\\text{L} $$\n四舍五入到五位小数，影子价格是 $0.05854\\,\\$/\\text{L}$。\n\n**4. 经济解释**\n\n影子价格 $0.05854\\,\\$/\\text{L}$ 代表精炼厂 $R_1$ 每增加一升年生产容量所带来的边际经济效益或成本节约。增加此容量的边际成本给定为 $\\gamma = 0.050\\,\\$/\\text{L}$。\n\n为了确定扩张是否合理，我们将边际效益（影子价格）与边际成本（$\\gamma$）进行比较：\n$$ \\text{边际效益} = 0.05854\\,\\$/\\text{L} $$\n$$ \\text{边际成本} = 0.050\\,\\$/\\text{L} $$\n由于边际效益 > 边际成本（$0.05854 > 0.050$），使用新容量所带来的节约大于创建它所需的成本。因此，在边际上，对 $R_1$ 的容量进行小幅扩张在经济上是合理的。\n\n### 选项评估\n\n**A. $R_1$ 容量的影子价格为 $0.05854\\,\\$/\\text{L}$；因为 $0.05854 > \\gamma = 0.050$，在边际上对 $K_1$ 进行无穷小扩张在经济上是合理的。**\n该选项陈述的影子价格为 $0.05854\\,\\$/\\text{L}$，与我们计算的值 $C_2 - C_1$ 相符。它正确地将此值与边际扩张成本 $\\gamma = 0.050\\,\\$/\\text{L}$ 进行了比较，并得出了正确的经济结论，即扩张是合理的，因为收益超过了成本。\n**结论：正确。**\n\n**B. $R_1$ 容量的影子价格为 $-0.05854\\,\\$/\\text{L}$；因为它是负数，扩张 $K_1$ 会增加总成本，所以无穷小扩张是不合理的。**\n对于影子价格（边际价值或收益）的经济学定义来说，这个符号是错误的。虽然该约束的正式拉格朗日乘子确实是负的（等于 $C_1 - C_2$），但这里的解释是有缺陷的。负的乘子意味着增加右手边会*减少*目标函数（成本），这意味着扩张是有利的。该选项错误地得出了相反的结论。\n**结论：错误。**\n\n**C. 影子价格等于 $R_2$ 的全部单位成本 $0.30667\\,\\$/\\text{L}$；由于这超过了 $\\gamma = 0.050$，不应进行扩张。**\n影子价格是边际成本的*差额*（$C_2 - C_1$），而不是被替代生产的全部边际成本（$C_2$）。这个前提在事实上是错误的。此外，其推理是矛盾的：如果效益（$0.30667$）超过成本（$0.050$），那么扩张*应该*被执行，而不是相反。\n**结论：错误。**\n\n**D. 容量约束的对偶变量在混合整数线性规划中没有意义，因此无法计算或解释 $K_1$ 的影子价格。**\n这个说法是一种过度概括，并且在本问题的背景下是错误的。问题明确指示分析应针对“连续线性规划子结构”和“线性规划对偶性的通常意义”。对于由此产生的LP模型，影子价格是明确定义的、可计算的，并且对于经济解释具有高度意义。问题描述中提到MILP仅为提供背景，并未使所要求的LP对偶性应用失效。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的供应链总是在动态变化和充满不确定性的环境中运行，未来的需求、成本和供应情况往往无法完美预测。滚动视界（Rolling Horizon, RH）策略是一种实用且强大的方法，它通过在每个决策周期利用最新的预测信息重新优化未来一个有限窗口期内的计划，从而在长期规划和短期适应性之间取得平衡。本计算练习要求您通过编程实现滚动视界调度，并将其性能与一个理论上拥有完美未来信息的“全知”全视界（Full Horizon, FH）优化进行比较 。通过计算由短视决策导致的“最优性损失”（loss of optimality），您将能深刻理解在不确定性下进行动态决策的核心挑战与权衡。",
            "id": "4072480",
            "problem": "考虑一个单设施生物质-生物燃料供应链，其时间为离散周期，索引为 $t \\in \\{1,\\dots,T\\}$。该设施采购生物质，以恒定的转化效率将其转化为生物燃料，保有生物质库存，并可能因未满足的生物燃料需求而产生罚款。其基本原理是质量守恒和线性成本累积。所有决策都必须基于每个周期的更新预测。实现滚动水平（Rolling Horizon, RH）调度，并将其性能与一个全知全视的全水平（Full Horizon, FH）优化进行比较，后者在初始时刻就完全了解整个更新序列。\n\n起点是质量守恒和库存平衡：对于生物质库存 $s_t$（单位：吨生物质）、采购量 $x_t$（单位：吨生物质）和生物燃料产量 $y_t$（单位：吨生物燃料），以及转化效率 $\\eta \\in (0,1]$（单位：吨生物燃料/吨生物质），一个周期内的生物质平衡为\n$$\ns_t \\;=\\; s_{t-1} \\;+\\; x_t \\;-\\; \\frac{y_t}{\\eta}.\n$$\n非负性和产能约束如下：\n$$\nx_t \\;\\ge\\; 0,\\quad y_t \\;\\ge\\; 0,\\quad s_t \\;\\ge\\; 0,\\quad u_t \\;\\ge\\; 0,\n$$\n$$\nx_t \\;\\le\\; X^{\\max}_t,\\quad y_t \\;\\le\\; Y^{\\max}_t,\n$$\n其中 $u_t$ 是未满足的需求（单位：吨生物燃料），$X^{\\max}_t$ 是采购能力（单位：吨生物质），$Y^{\\max}_t$ 是生产能力（单位：吨生物燃料）。允许短缺的需求满足模型为\n$$\ny_t \\;+\\; u_t \\;\\ge\\; d_t,\n$$\n其中 $d_t$ 是生物燃料需求（单位：吨生物燃料）。\n\n周期成本是线性的：\n$$\n\\text{cost}_t \\;=\\; c_t x_t \\;+\\; g_t y_t \\;+\\; h_t s_t \\;+\\; p_t u_t,\n$$\n其中 $c_t$ 是采购成本（单位：美元/吨生物质），$g_t$ 是生产成本（单位：美元/吨生物燃料），$h_t$ 是库存持有成本（单位：美元/吨生物质/周期），$p_t$ 是短缺罚款（单位：美元/吨生物燃料）。整个时间范围内的总成本是各周期成本之和：\n$$\nJ \\;=\\; \\sum_{t=1}^{T} \\text{cost}_t.\n$$\n\n全知全视的全水平（FH）优化：在 $t=1$ 时，给定对序列 $\\{d_t\\}_{t=1}^T$、$\\{c_t\\}_{t=1}^T$、$\\{g_t\\}_{t=1}^T$、$\\{h_t\\}_{t=1}^T$、$\\{p_t\\}_{t=1}^T$、$\\{X^{\\max}_t\\}_{t=1}^T$、$\\{Y^{\\max}_t\\}_{t=1}^T$ 的完全了解，以及初始生物质库存 $s_0$（单位：吨生物质），最小化 $J$，并满足上述约束条件。\n\n滚动水平（RH）调度：在每个决策时期 $\\tau \\in \\{1,\\dots,T\\}$，针对一个包含 $W$ 个周期的时间窗口，即 $t \\in \\{\\tau,\\dots,\\min(\\tau+W-1,T)\\}$，使用在时间 $\\tau$ 可获得的对这些周期的更新预测来求解一个优化问题，并受限于先前已定决策所产生的结转库存 $s_{\\tau-1}$。只有第一个周期的决策 $(x_\\tau,y_\\tau,u_\\tau)$ 被执行；库存 $s_\\tau$ 通过质量平衡进行更新。然后前进到下一个时期 $\\tau \\leftarrow \\tau+1$，并使用新更新的预测重复此过程。\n\n最优性损失是相对于 FH 的目标差距比率来衡量的\n$$\nL \\;=\\; \\frac{J_{\\text{RH}} - J_{\\text{FH}}}{J_{\\text{FH}}},\n$$\n以小数表示（无单位）。此处，$J_{\\text{RH}}$ 是 RH 调度在 FH 模型预先知道的相同更新序列下所产生的实际总成本，而 $J_{\\text{FH}}$ 是全知全视的 FH 最优成本。\n\n您的任务是编写一个程序，该程序：\n- 将 FH 优化实现为在整个时间范围内的单个线性规划问题。\n- 将 RH 调度实现为一系列窗口化的线性规划问题，在每个时期仅执行第一个周期的决策，并在进入下一个时期前更新库存。\n- 为每个提供的测试案例计算 $L$。\n\n请使用以下测试套件。所有数组都按周期 $t=1,\\dots,T$ 排序。所有成本单位为美元（USD），需求单位为吨生物燃料，生物质变量单位为吨生物质，产量单位为吨生物燃料。转化效率由 $\\eta$ 给出（单位：吨生物燃料/吨生物质）。初始生物质库存为 $s_0$（单位：吨生物质）。采购能力为 $X^{\\max}_t$（单位：吨生物质）。生产能力为 $Y^{\\max}_t$（单位：吨生物燃料）。短缺罚款为 $p_t$（单位：美元/吨生物燃料）。$L$ 的最终答案必须以小数（无单位）表示。\n\n- 情况1（顺利路径，非平凡的时间范围和窗口）：$T=6$， $W=3$， $\\eta=0.5$， $s_0=20$， $d_t=\\{10,12,20,25,40,40\\}$， $c_t=\\{100,100,100,100,150,150\\}$， $g_t=\\{50,50,50,50,50,50\\}$， $h_t=\\{2,2,2,2,2,2\\}$， $p_t=\\{1000,1000,1000,1000,1000,1000\\}$， $X^{\\max}_t=\\{50,50,50,50,50,50\\}$， $Y^{\\max}_t=\\{50,50,50,50,50,50\\}$。\n- 情况2（边界条件，窗口等于时间范围）：$T=6$， $W=6$， $\\eta=0.5$， $s_0=20$， $d_t=\\{10,12,20,25,40,40\\}$， $c_t=\\{100,100,100,100,150,150\\}$， $g_t=\\{50,50,50,50,50,50\\}$， $h_t=\\{2,2,2,2,2,2\\}$， $p_t=\\{1000,1000,1000,1000,1000,1000\\}$， $X^{\\max}_t=\\{50,50,50,50,50,50\\}$， $Y^{\\max}_t=\\{50,50,50,50,50,50\\}$。\n- 情况3（边缘情况，纯粹的短视决策）：$T=6$， $W=1$， $\\eta=0.5$， $s_0=20$， $d_t=\\{10,12,20,25,40,40\\}$， $c_t=\\{100,100,100,100,150,150\\}$， $g_t=\\{50,50,50,50,50,50\\}$， $h_t=\\{2,2,2,2,2,2\\}$， $p_t=\\{1000,1000,1000,1000,1000,1000\\}$， $X^{\\max}_t=\\{50,50,50,50,50,50\\}$， $Y^{\\max}_t=\\{50,50,50,50,50,50\\}$。\n\n您的程序应生成单行输出，其中包含三个最优性损失值，格式为方括号内以逗号分隔的列表，例如 $[l_1,l_2,l_3]$，其中每个 $l_i$ 是案例 $i$ 的小数损失 $L$，四舍五入到四位小数。",
            "solution": "用户提供了一个能源系统建模领域中明确定义的问题，具体关注生物质到生物燃料转换的供应链优化。该问题要求对全知全视的全水平（FH）优化策略和更实用的滚动水平（RH）策略进行比较。两种策略都将建模为线性规划（LP）。\n\n问题的核心在于最小化有限时间范围 $T$ 内的总运营成本。成本函数和系统动态是线性的，使得线性规划成为一种合适的解决方法。我们将使用 `scipy.optimize` 库中的 `linprog` 函数来求解所需的线性规划问题。\n\n首先，我们必须将优化问题形式化为 `scipy.optimize.linprog` 所要求的标准线性规划格式：\n$$\n\\min_{\\mathbf{z}} \\mathbf{c}^T \\mathbf{z} \\quad \\text{subject to} \\quad A_{eq} \\mathbf{z} = \\mathbf{b}_{eq}, \\quad A_{ub} \\mathbf{z} \\le \\mathbf{b}_{ub}, \\quad \\mathbf{l} \\le \\mathbf{z} \\le \\mathbf{u}\n$$\n\n设一个优化实例中的周期数为 $N$。对于 FH 模型，$N=T$。对于在时期 $\\tau$ 的 RH 子问题，$N$ 将是前瞻窗口的长度，即 $N = \\min(W, T-\\tau+1)$。\n\n每个周期 $t \\in \\{1, \\dots, N\\}$ 的决策变量是采购量 $x_t$、产量 $y_t$、库存 $s_t$ 和未满足的需求 $u_t$。我们将它们组合成一个大小为 $4N$ 的决策向量 $\\mathbf{z}$：\n$$\n\\mathbf{z} = [x_1, y_1, s_1, u_1, \\dots, x_N, y_N, s_N, u_N]^T\n$$\n该向量的索引从 $0$ 到 $4N-1$。周期 $t$（其中 $t$ 是 1-索引的）的变量位于索引 $4(t-1)$ 到 $4(t-1)+3$ 处。\n\n目标是最小化总成本。成本向量 $\\mathbf{c}$ 是通过连接每个周期的成本系数构建的：\n$$\n\\mathbf{c} = [c_1, g_1, h_1, p_1, \\dots, c_N, g_N, h_N, p_N]^T\n$$\n\n约束条件按如下方式转换：\n1.  **等式约束 ($A_{eq} \\mathbf{z} = \\mathbf{b}_{eq}$):** 生物质库存平衡方程 $s_t = s_{t-1} + x_t - y_t/\\eta$ 必须对每个周期 $t=1, \\dots, N$ 成立。我们将其重排为标准形式 $-x_t + (1/\\eta)y_t + s_t - s_{t-1} = 0$。\n    对于第一个周期（$t=1$），$s_0$ 是一个已知的初始条件，因此方程为 $-x_1 + (1/\\eta)y_1 + s_1 = s_0$。\n    这给出了 $N$ 个等式约束。矩阵 $A_{eq}$ 的大小为 $N \\times 4N$。对于每一行 $t-1$（对应于周期 $t$）：\n    -   $x_t$ 的系数（列 $4(t-1)$）是 $-1$。\n    -   $y_t$ 的系数（列 $4(t-1)+1$）是 $1/\\eta$。\n    -   $s_t$ 的系数（列 $4(t-1)+2$）是 $1$。\n    -   如果 $t>1$，$s_{t-1}$ 的系数（列 $4(t-2)+2$）是 $-1$。\n    右侧向量 $\\mathbf{b}_{eq}$ 的第一个元素为 $s_0$，所有其他元素为零。\n\n2.  **不等式约束 ($A_{ub} \\mathbf{z} \\le \\mathbf{b}_{ub}$):** 需求满足约束 $y_t + u_t \\ge d_t$ 被重写为 $-y_t - u_t \\le -d_t$。\n    这给出了 $N$ 个不等式约束。矩阵 $A_{ub}$ 的大小为 $N \\times 4N$。对于每一行 $t-1$（对应于周期 $t$）：\n    -   $y_t$ 的系数（列 $4(t-1)+1$）是 $-1$。\n    -   $u_t$ 的系数（列 $4(t-1)+3$）是 $-1$。\n    右侧向量 $\\mathbf{b}_{ub}$ 包含值 $-d_t$。\n\n3.  **边界 ($\\mathbf{l} \\le \\mathbf{z} \\le \\mathbf{u}$):**\n    -   所有变量都是非负的：$x_t, y_t, s_t, u_t \\ge 0$。这为所有变量设置了下界 $0$。\n    -   采购能力：$x_t \\le X^{\\max}_t$。\n    -   生产能力：$y_t \\le Y^{\\max}_t$。\n    -   库存 $s_t$ 和未满足的需求 $u_t$ 没有上界。\n\n通过这种形式化，我们可以实现两个函数：一个用于 FH 解法，另一个用于 RH 仿真。\n\n**全水平（FH）方法：**\n对整个时间范围 $T$ 求解单个线性规划问题。我们设置 $N=T$，并使用完整的数据序列如上所述构建矩阵。`linprog` 函数返回最优总成本 $J_{\\text{FH}}$。\n\n**滚动水平（RH）方法：**\n这是一个迭代过程。我们从时期 $\\tau = 1$ 循环到 $T$。\n在每个时期 $\\tau$ 中：\n1.  为一个长度为 $N = \\min(W, T - \\tau + 1)$ 的窗口（覆盖周期 $\\{\\tau, \\dots, \\tau+N-1\\}$）构建一个线性规划问题。\n2.  此线性规划问题的初始库存是 $s_{\\tau-1}$，即从前一个时期决策结转的状态。对于 $\\tau=1$，这是给定的 $s_0$。\n3.  使用窗口的数据切片 $\\{d_t, c_t, \\dots\\}$ 来构建线性规划问题。\n4.  求解该线性规划问题。从得到的窗口最优计划中，仅认为第一个周期的决策 $(x_\\tau, y_\\tau, u_\\tau, s_\\tau)$ 被执行。\n5.  周期结束时的库存 $s_\\tau$ 成为下一个时期 $\\tau+1$ 的初始库存。\n6.  存储已执行的决策 $(x_\\tau, y_\\tau, s_\\tau, u_\\tau)$。\n在遍历所有 $T$ 个时期后，通过对已执行决策序列的周期成本求和 $\\sum_{t=1}^T (c_t x_t + g_t y_t + h_t s_t + p_t u_t)$ 来计算总实现成本 $J_{\\text{RH}}$。请注意，问题陈述通过假设每个窗口内都有完美的预测来简化了场景，这意味着用于规划的数据与用于成本评估的数据相同。\n\n最后，对于每个测试案例，我们计算 $J_{\\text{FH}}$ 和 $J_{\\text{RH}}$，并计算最优性损失 $L = (J_{\\text{RH}} - J_{\\text{FH}}) / J_{\\text{FH}}$。当 $W=T$ 时，第一个（也是唯一一个）RH 子问题与 FH 问题相同。根据最优性原理，理性的决策者会遵循最初计算的全水平计划，从而导致 $J_{\\text{RH}} = J_{\\text{FH}}$，因此 $L=0$。这可以作为一个有用的健全性检查。对于 $W  T$ 的情况，我们预期 $J_{\\text{RH}} \\ge J_{\\text{FH}}$，从而导致 $L \\ge 0$。\n\n该实现将包含一个通用的线性规划求解器函数，该函数为给定窗口构建并解决问题，然后由 FH 和 RH 过程调用。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_lp(N, s_initial, eta, d_window, c_window, g_window, h_window, p_window, Xmax_window, Ymax_window):\n    \"\"\"\n    Solves the linear program for a given optimization window.\n\n    The decision variable vector z is structured as [x_1, y_1, s_1, u_1, ..., x_N, y_N, s_N, u_N].\n    \"\"\"\n    num_vars = 4 * N\n\n    # Objective function: minimize sum(c*x + g*y + h*s + p*u)\n    c_obj = np.zeros(num_vars)\n    for t in range(N):\n        c_obj[4*t : 4*t+4] = [c_window[t], g_window[t], h_window[t], p_window[t]]\n\n    # Equality constraints: s_t - s_{t-1} - x_t + y_t/eta = 0\n    # A_eq * z = b_eq\n    A_eq = np.zeros((N, num_vars))\n    b_eq = np.zeros(N)\n    # Period t=1 (index 0)\n    A_eq[0, 0] = -1.0      # -x_1\n    A_eq[0, 1] = 1.0 / eta # +y_1/eta\n    A_eq[0, 2] = 1.0       # +s_1\n    b_eq[0] = s_initial\n    # Periods t > 1\n    for t in range(1, N):\n        A_eq[t, 4*t + 0] = -1.0      # -x_t\n        A_eq[t, 4*t + 1] = 1.0 / eta # +y_t/eta\n        A_eq[t, 4*t + 2] = 1.0       # +s_t\n        A_eq[t, 4*(t-1) + 2] = -1.0 # -s_{t-1}\n\n    # Inequality constraints: y_t + u_t >= d_t  => -y_t - u_t = -d_t\n    # A_ub * z = b_ub\n    A_ub = np.zeros((N, num_vars))\n    b_ub = np.zeros(N)\n    for t in range(N):\n        A_ub[t, 4*t + 1] = -1.0 # -y_t\n        A_ub[t, 4*t + 3] = -1.0 # -u_t\n        b_ub[t] = -d_window[t]\n\n    # Variable bounds: 0 = x_t = Xmax_t, 0 = y_t = Ymax_t, s_t >= 0, u_t >= 0\n    bounds = []\n    for t in range(N):\n        bounds.append((0, Xmax_window[t])) # x_t\n        bounds.append((0, Ymax_window[t])) # y_t\n        bounds.append((0, None))             # s_t\n        bounds.append((0, None))             # u_t\n\n    res = linprog(c=c_obj, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if not res.success:\n        raise RuntimeError(f\"Linear program solver failed: {res.message}\")\n    \n    return res\n\ndef get_fh_cost(T, s0, eta, d, c, g, h, p, X_max, Y_max):\n    \"\"\"Calculates the optimal cost for the Full Horizon clairvoyant model.\"\"\"\n    res = solve_lp(T, s0, eta, d, c, g, h, p, X_max, Y_max)\n    return res.fun\n\ndef get_rh_cost(T, W, s0, eta, d, c, g, h, p, X_max, Y_max):\n    \"\"\"Calculates the realized cost for the Rolling Horizon model.\"\"\"\n    current_s = s0\n    realized_x = np.zeros(T)\n    realized_y = np.zeros(T)\n    realized_s = np.zeros(T)\n    realized_u = np.zeros(T)\n\n    for tau_idx in range(T): # 0-indexed simulation time\n        window_len = min(W, T - tau_idx)\n        \n        # Slices of data for the current optimization window\n        start = tau_idx\n        end = tau_idx + window_len\n        d_win = d[start:end]\n        c_win = c[start:end]\n        g_win = g[start:end]\n        h_win = h[start:end]\n        p_win = p[start:end]\n        Xmax_win = X_max[start:end]\n        Ymax_win = Y_max[start:end]\n        \n        res = solve_lp(window_len, current_s, eta, d_win, c_win, g_win, h_win, p_win, Xmax_win, Ymax_win)\n        \n        # Implement first-period decisions\n        x_tau = res.x[0]\n        y_tau = res.x[1]\n        s_tau = res.x[2]\n        u_tau = res.x[3]\n        \n        # Store realized decisions\n        realized_x[tau_idx] = x_tau\n        realized_y[tau_idx] = y_tau\n        realized_s[tau_idx] = s_tau\n        realized_u[tau_idx] = u_tau\n        \n        # Update state for the next epoch\n        current_s = s_tau\n\n    # Calculate total realized cost based on the sequence of decisions\n    total_rh_cost = (np.dot(c, realized_x) +\n                     np.dot(g, realized_y) +\n                     np.dot(h, realized_s) +\n                     np.dot(p, realized_u))\n    return total_rh_cost\n\ndef solve():\n    test_cases = [\n        { # Case 1\n            \"T\": 6, \"W\": 3, \"eta\": 0.5, \"s0\": 20.0,\n            \"d\": np.array([10., 12., 20., 25., 40., 40.]),\n            \"c\": np.array([100., 100., 100., 100., 150., 150.]),\n            \"g\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"h\": np.array([2., 2., 2., 2., 2., 2.]),\n            \"p\": np.array([1000., 1000., 1000., 1000., 1000., 1000.]),\n            \"X_max\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"Y_max\": np.array([50., 50., 50., 50., 50., 50.])\n        },\n        { # Case 2\n            \"T\": 6, \"W\": 6, \"eta\": 0.5, \"s0\": 20.0,\n            \"d\": np.array([10., 12., 20., 25., 40., 40.]),\n            \"c\": np.array([100., 100., 100., 100., 150., 150.]),\n            \"g\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"h\": np.array([2., 2., 2., 2., 2., 2.]),\n            \"p\": np.array([1000., 1000., 1000., 1000., 1000., 1000.]),\n            \"X_max\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"Y_max\": np.array([50., 50., 50., 50., 50., 50.])\n        },\n        { # Case 3\n            \"T\": 6, \"W\": 1, \"eta\": 0.5, \"s0\": 20.0,\n            \"d\": np.array([10., 12., 20., 25., 40., 40.]),\n            \"c\": np.array([100., 100., 100., 100., 150., 150.]),\n            \"g\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"h\": np.array([2., 2., 2., 2., 2., 2.]),\n            \"p\": np.array([1000., 1000., 1000., 1000., 1000., 1000.]),\n            \"X_max\": np.array([50., 50., 50., 50., 50., 50.]),\n            \"Y_max\": np.array([50., 50., 50., 50., 50., 50.])\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        p = params\n        J_fh = get_fh_cost(p[\"T\"], p[\"s0\"], p[\"eta\"], p[\"d\"], p[\"c\"], p[\"g\"], p[\"h\"], p[\"p\"], p[\"X_max\"], p[\"Y_max\"])\n        J_rh = get_rh_cost(p[\"T\"], p[\"W\"], p[\"s0\"], p[\"eta\"], p[\"d\"], p[\"c\"], p[\"g\"], p[\"h\"], p[\"p\"], p[\"X_max\"], p[\"Y_max\"])\n        \n        if J_fh > 1e-6:\n            loss = (J_rh - J_fh) / J_fh\n        else:\n            # Handle case where FH cost is zero or near-zero\n            loss = 0.0 if np.isclose(J_rh, J_fh) else np.inf\n\n        results.append(loss)\n    \n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}