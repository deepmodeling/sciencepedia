{
    "hands_on_practices": [
        {
            "introduction": "等面积法则是分析单机无穷大（SMIB）系统暂态稳定性的经典直观工具。通过比较故障期间的加速能量和故障清除后的减速能量，我们可以确定系统保持同步的关键边界。本练习将通过一个具体的数值算例，指导你应用等面积法则计算临界切除角，这是理解暂态稳定极限的核心技能。",
            "id": "4131463",
            "problem": "考虑一个单机无穷大母线（SMIB）系统，该系统采用同步发电机的经典模型，连接到一个非常大的电网。其中，发电机的转子动态由摇摆方程控制。摇摆方程指出，转子角 $\\delta$ 的演变遵循 $M \\,\\frac{d^{2}\\delta}{dt^{2}} = P_{m} - P_{e}(\\delta)$，其中 $M$ 是惯性常数，$P_{m}$ 是恒定的机械输入功率，$P_{e}(\\delta)$ 是作为 $\\delta$ 函数输送到电网的电磁功率。在发电机附近发生三相短路故障时，假设故障期间的电功率为零，因此故障期间的加速功率为 $P_{a,\\mathrm{fault}} = P_{m}$。故障被清除，且没有发生永久性的网络拓扑变化，使得故障后的电功率-功角关系为 $P_{e,\\mathrm{post}}(\\delta) = 1.5 \\sin\\delta$（标幺值）。故障前的稳定运行点满足 $P_{e,\\mathrm{pre}}(\\delta_{0}) = P_{m}$，且其传输特性与故障后的传输特性 $P_{e,\\mathrm{post}}(\\delta)$ 相同。\n\n从摇摆方程和动能的定义 $T = \\frac{1}{2} M \\left(\\frac{d\\delta}{dt}\\right)^{2}$ 出发，利用第一次摇摆期间的能量守恒，通过对加速功率和减速功率进行积分，推导出等面积法则。然后，对于 $P_{m} = 0.9$（标幺值），$P_{e,\\mathrm{post}}(\\delta) = 1.5 \\sin\\delta$（标幺值），以及故障期间减速功率为零的情况，数值计算极限切除角 $\\delta_{\\mathrm{cr}}$。将故障后系统上的最大功角偏移解释为不稳定平衡点功角。将最终数值答案四舍五入到四位有效数字，并以弧度表示该角度。",
            "solution": "在经典模型下，转子动态遵循摇摆方程 $M \\,\\frac{d^{2}\\delta}{dt^{2}} = P_{m} - P_{e}(\\delta)$。定义动能为 $T = \\frac{1}{2} M \\left(\\frac{d\\delta}{dt}\\right)^{2}$。将 $T$ 对时间求导并使用摇摆方程可得\n$$\n\\frac{dT}{dt} = M \\frac{d\\delta}{dt} \\frac{d^{2}\\delta}{dt^{2}} = \\left(P_{m} - P_{e}(\\delta)\\right)\\frac{d\\delta}{dt}.\n$$\n假设没有阻尼和损耗，在一个 $\\delta$ 区间内动能的变化量等于功率-功角曲线上加速功率减去减速功率所对应的面积。故障期间，$P_{e,\\mathrm{fault}}(\\delta) = 0$，所以加速功率为 $P_{a,\\mathrm{fault}} = P_{m}$，从 $\\delta_{0}$ 到切除角 $\\delta_{c}$ 期间获得的动能为\n$$\nA_{\\mathrm{acc}} = \\int_{\\delta_{0}}^{\\delta_{c}} \\left(P_{m} - P_{e,\\mathrm{fault}}(\\delta)\\right) \\, d\\delta = \\int_{\\delta_{0}}^{\\delta_{c}} P_{m} \\, d\\delta = P_{m} (\\delta_{c} - \\delta_{0}).\n$$\n故障清除后瞬间，故障后的电功率为 $P_{e,\\mathrm{post}}(\\delta) = P_{\\max} \\sin \\delta$（其中 $P_{\\max} = 1.5$），减速功率变为 $P_{d,\\mathrm{post}}(\\delta) = P_{e,\\mathrm{post}}(\\delta) - P_{m}$。从 $\\delta_{c}$ 到第一次摇摆的最大功角 $\\delta_{m}$ 期间损失的动能为\n$$\nA_{\\mathrm{dec}} = \\int_{\\delta_{c}}^{\\delta_{m}} \\left(P_{e,\\mathrm{post}}(\\delta) - P_{m}\\right) \\, d\\delta = \\int_{\\delta_{c}}^{\\delta_{m}} P_{\\max} \\sin\\delta \\, d\\delta - \\int_{\\delta_{c}}^{\\delta_{m}} P_{m} \\, d\\delta.\n$$\n计算该积分可得\n$$\nA_{\\mathrm{dec}} = \\left[- P_{\\max} \\cos\\delta\\right]_{\\delta_{c}}^{\\delta_{m}} - P_{m}(\\delta_{m} - \\delta_{c}) = P_{\\max}(\\cos\\delta_{c} - \\cos\\delta_{m}) - P_{m}(\\delta_{m} - \\delta_{c}).\n$$\n第一次摇摆稳定边界的等面积法则通过 $A_{\\mathrm{acc}} = A_{\\mathrm{dec}}$ 实现，可得\n$$\nP_{m}(\\delta_{c} - \\delta_{0}) = P_{\\max}(\\cos\\delta_{c} - \\cos\\delta_{m}) - P_{m}(\\delta_{m} - \\delta_{c}).\n$$\n整理各项可得，\n$$\nP_{m}(\\delta_{m} - \\delta_{0}) = P_{\\max}(\\cos\\delta_{c} - \\cos\\delta_{m}),\n$$\n因而\n$$\nP_{\\max}\\cos\\delta_{c} = P_{m}(\\delta_{m} - \\delta_{0}) + P_{\\max}\\cos\\delta_{m}.\n$$\n为了唯一确定 $\\delta_{c}$，必须指定临界情况下的 $\\delta_{m}$。对于正弦形式的功率-功角曲线，极限切除条件下的最大功角偏移与故障后系统的不稳定平衡点重合，在该点上，电功率与机械功率相等，如果系统以零速度到达该点，它将既不加速也不减速。故障后的稳定功角 $\\delta_{1}$ 满足\n$$\nP_{e,\\mathrm{post}}(\\delta_{1}) = P_{m} \\quad \\Rightarrow \\quad P_{\\max}\\sin\\delta_{1} = P_{m} \\quad \\Rightarrow \\quad \\sin\\delta_{1} = \\frac{P_{m}}{P_{\\max}}.\n$$\n不稳定平衡点功角为\n$$\n\\delta_{u} = \\pi - \\delta_{1}, \\quad \\text{with} \\quad P_{e,\\mathrm{post}}(\\delta_{u}) = P_{m}.\n$$\n在假设的情景下，故障前的传输特性与故障后的相同，因此故障前的运行功角为\n$$\n\\delta_{0} = \\delta_{1} = \\arcsin\\!\\left(\\frac{P_{m}}{P_{\\max}}\\right).\n$$\n因此，我们在等面积方程中设 $\\delta_{m} = \\delta_{u} = \\pi - \\delta_{0}$：\n$$\nP_{\\max}\\cos\\delta_{c} = P_{m}(\\delta_{u} - \\delta_{0}) + P_{\\max}\\cos\\delta_{u}.\n$$\n解出 $\\delta_{c}$ 可得\n$$\n\\cos\\delta_{c} = \\frac{P_{m}(\\delta_{u} - \\delta_{0}) + P_{\\max}\\cos\\delta_{u}}{P_{\\max}},\n$$\n接着\n$$\n\\delta_{c} = \\arccos\\!\\left(\\frac{P_{m}(\\delta_{u} - \\delta_{0}) + P_{\\max}\\cos\\delta_{u}}{P_{\\max}}\\right).\n$$\n现在代入给定的数值。首先，计算故障前功角：\n$$\n\\delta_{0} = \\arcsin\\!\\left(\\frac{P_{m}}{P_{\\max}}\\right) = \\arcsin\\!\\left(\\frac{0.9}{1.5}\\right) = \\arcsin(0.6).\n$$\n因此，\n$$\n\\delta_{u} = \\pi - \\delta_{0} = \\pi - \\arcsin(0.6).\n$$\n另外，使用恒等式 $\\cos(\\pi - \\theta) = -\\cos\\theta$ 和 $\\cos\\delta_{0} = \\sqrt{1 - \\sin^{2}\\delta_{0}} = \\sqrt{1 - 0.6^{2}} = 0.8$，我们有\n$$\n\\cos\\delta_{u} = -\\cos\\delta_{0} = -0.8.\n$$\n因此，\n$$\n\\cos\\delta_{c} = \\frac{0.9\\left(\\delta_{u} - \\delta_{0}\\right) + 1.5(-0.8)}{1.5} = \\frac{0.9\\left(\\pi - 2\\,\\arcsin(0.6)\\right) - 1.2}{1.5}.\n$$\n数值上，$\\arcsin(0.6) \\approx 0.643501108793$，所以\n$$\n\\delta_{u} - \\delta_{0} = \\pi - 2\\,\\arcsin(0.6) \\approx 3.141592653589793 - 2 \\times 0.643501108793 \\approx 1.854590436003.\n$$\n于是\n$$\n\\cos\\delta_{c} \\approx \\frac{0.9 \\times 1.854590436003 - 1.2}{1.5} \\approx \\frac{1.669131392403 - 1.2}{1.5} \\approx \\frac{0.469131392403}{1.5} \\approx 0.312754261602.\n$$\n最后，\n$$\n\\delta_{c} = \\arccos(0.312754261602) \\approx 1.252672 \\text{ rad}.\n$$\n将结果四舍五入到四位有效数字并以弧度表示，得到 $\\delta_{\\mathrm{cr}} \\approx 1.253$。",
            "answer": "$$\\boxed{1.253}$$"
        },
        {
            "introduction": "暂态能量函数（TEF）法超越了等面积法则的图形化方法，为系统稳定性提供了一个更为通用的量化度量，即“能量裕度”。这个裕度衡量了系统在故障清除后距离失稳边界的“远近”，是现代在线动态安全评估中的关键概念。通过本练习，你将构建一个能量函数，计算系统在故障清除时刻的能量，并将其与临界能量进行比较，从而量化系统的稳定性。",
            "id": "4131459",
            "problem": "考虑一个单机无穷大母线 (SMIB) 系统，其在故障后网络下的发电机转子角 $ \\delta $ 和转速 $ \\omega = d\\delta/dt $ 由经典摇摆方程建模：\n$$ M \\frac{d^2 \\delta}{dt^2} = P_m - P_e(\\delta), $$\n其中 $ M = \\frac{2 H}{\\omega_s} $ 是角质量，$ H $ 是惯性常数，$ \\omega_s $ 是同步电角速度，$ P_m $ 是由经济调度设定的机械输入功率，$ P_e(\\delta) $ 是电磁气隙功率，在经典模型下，对于给定的网络拓扑，其表达式为 $ P_e(\\delta) = P_{\\max} \\sin \\delta $。\n\n在 $ t = 0 $ 时发生故障，该故障使电磁气隙功率降低至约等于零，即在故障期间 $ P_e^{\\text{fault}}(\\delta) \\approx 0 $。故障在时间 $ t = t_c $ 通过切除一条输电线路而被清除，故障后的传输极限为 $ P_{\\max,\\text{post}} $。故障前的传输极限为 $ P_{\\max,\\text{pre}} $，发电机初始处于故障前的稳态，满足 $ \\omega(0) = 0 $ 和 $ \\delta(0) = \\delta_0 $，且 $ P_m = P_{\\max,\\text{pre}} \\sin \\delta_0 $。\n\n使用以下数据，这些数据与典型的暂态稳定约束调度和计划场景一致：\n- 故障前传输极限 $ P_{\\max,\\text{pre}} = 1.2 $ 标幺值。\n- 故障后传输极限 $ P_{\\max,\\text{post}} = 0.9 $ 标幺值。\n- 机械输入功率 $ P_m = 0.8 $ 标幺值（此为调度设定点）。\n- 惯性常数 $ H = 5 $ 秒。\n- 系统频率 $ f = 60 $ 赫兹，因此 $ \\omega_s = 2 \\pi f $。\n- 故障期间，$ P_e^{\\text{fault}}(\\delta) \\approx 0 $。\n- 一个候选的清除时间 $ t_c = 0.04 $ 秒。\n\n你需要从摇摆方程和针对保守的故障后动态定义的类哈密顿故障后能量函数出发进行推理。通过平衡关系 $ P_m = P_{\\max,\\text{post}} \\sin \\delta $ 来定义故障后稳定平衡角 $ \\delta_s $ 和最近的不稳定平衡点 (UEP) 角 $ \\delta_u $，其中 $ \\delta_s $ 是局部最小值点，$ \\delta_u $ 是局部最大值点。构建相对于故障后稳定平衡点 $ \\delta_s $ 的故障后能量函数 $ V(\\delta,\\omega) $，使得 $ V(\\delta_s,0) = 0 $，并用它来计算：\n1. 在 UEP $ (\\delta_u,0) $ 处的临界能量 $ V_{cr} $。\n2. 在清除瞬间 $ (\\delta(t_c), \\omega(t_c)) $ 处的故障后能量 $ V_0 $，其中 $ \\delta(t) $ 和 $ \\omega(t) $ 遵循故障期间的摇摆动态。\n3. 能量裕度 $ \\Delta V = V_{cr} - V_0 $。\n最后，解释能量裕度 $ \\Delta V $ 如何与临界清除时间 (CCT) 相关联，CCT 定义为能使系统保持在故障后吸引域内的最大故障清除时间 $ t_c^{\\ast} $。\n\n选择一个选项，该选项在给定数据下最准确地报告了计算出的 $ \\Delta V $，并正确地描述了其与 CCT 的关系。\n\nA. $ \\Delta V \\approx 0.012 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是稳定的，CCT $ t_c^{\\ast} $ 是指故障后能量等于临界能量的时间（即 $ V_0(t_c^{\\ast}) = V_{cr} $），得出 $ t_c^{\\ast} \\approx 0.055 $ 秒；此外，$ \\Delta V $ 随着故障持续时间的延长而单调递减，并在达到 CCT 时消失。\n\nB. $ \\Delta V \\approx 0.042 $ 标幺值能量；清除时的动能完全决定了稳定性，因此可以忽略势能；因此 CCT 呈线性关系 $ t_c^{\\ast} \\approx \\Delta V P_m^{-1} $，在本例中得出 $ t_c^{\\ast} \\approx 0.052 $ 秒。\n\nC. $ \\Delta V \\approx -0.010 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是不稳定的；因为裕度为负，所以 CCT 必须小于 $ 0.04 $ 秒。\n\nD. $ \\Delta V \\approx 0.012 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是稳定的，但 CCT 由线性关系 $ \\Delta V = K t_c $ 给出（其中 $ K $ 为常数），因此 $ t_c^{\\ast} = \\Delta V / P_m \\approx 0.015 $ 秒，且与网络传输极限无关。",
            "solution": "用户提供了一个电力系统暂态稳定分析领域的问题。任务是验证问题陈述，求解能量裕度 $\\Delta V$，并评估所提供的选项。\n\n### 步骤1：提取给定条件\n\n问题陈述提供了以下数据和模型方程：\n- 系统模型：单机无穷大母线 (SMIB) 系统。\n- 摇摆方程（故障后）：$M \\frac{d^2 \\delta}{dt^2} = P_m - P_e(\\delta)$，其中电功率为 $P_e(\\delta) = P_{\\max,\\text{post}} \\sin \\delta$。\n- 角质量：$M = \\frac{2 H}{\\omega_s}$。\n- 惯性常数：$H = 5$ 秒。\n- 同步速度：$\\omega_s = 2 \\pi f$，其中系统频率 $f = 60$ 赫兹。\n- 机械输入功率（调度设定点）：$P_m = 0.8$ 标幺值 (p.u.)。\n- 故障前传输极限：$P_{\\max,\\text{pre}} = 1.2$ p.u.。\n- 故障后传输极限：$P_{\\max,\\text{post}} = 0.9$ p.u.。\n- 初始条件（$t=0$ 时的故障前稳态）：$\\omega(0) = 0$ 且 $P_m = P_{\\max,\\text{pre}} \\sin \\delta_0$。\n- 故障条件（对于 $0 \\le t \\le t_c$）：故障导致电功率降低至 $P_e^{\\text{fault}}(\\delta) \\approx 0$。\n- 候选清除时间：$t_c = 0.04$ 秒。\n\n### 步骤2：使用提取的给定条件进行验证\n\n根据既定标准对问题进行验证。\n- **科学依据**：该问题使用了经典的摇摆方程和暂态能量函数法，这些都是电力系统稳定性分析中基础且公认的原理。所有概念都具有科学合理性。\n- **适定性**：该问题是适定的。给定的数据和带有初始条件的微分方程可以计算出唯一的系统轨迹和相应的能量裕度。\n- **客观性**：该问题使用电气工程的标准术语，以精确、客观的语言陈述。它不包含主观论断。\n- **完整性和一致性**：该问题提供了进行分析所需的所有必要数据。在给定的设置中没有明显的矛盾。\n- **真实性**：功率、惯量和清除时间的标幺值与典型电力系统暂态稳定性研究中的值一致。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。这是一个暂态稳定分析中的标准、可解问题。我现在开始推导解答。\n\n### 解答推导\n\n解答需要多步计算：\n1.  确定关键系统参数和平衡点。\n2.  计算在清除时间 $t_c$ 的系统状态（角度 $\\delta_c$ 和速度 $\\omega_c$）。\n3.  定义故障后能量函数 $V(\\delta, \\omega)$。\n4.  计算在不稳定平衡点 (UEP) 的临界能量 $V_{cr}$。\n5.  计算在清除瞬间的能量 $V_0$。\n6.  计算能量裕度 $\\Delta V = V_{cr} - V_0$。\n\n**1. 系统参数和平衡点**\n\n- 同步速度：$\\omega_s = 2 \\pi f = 2 \\pi (60) = 120\\pi$ rad/s。\n- 角质量：$M = \\frac{2 H}{\\omega_s} = \\frac{2(5)}{120\\pi} = \\frac{10}{120\\pi} = \\frac{1}{12\\pi}$ p.u. s$^2$/rad。数值上，$M \\approx 0.026526$ p.u. s$^2$/rad。\n- 初始转子角 $\\delta_0$：根据故障前条件 $P_m = P_{\\max,\\text{pre}} \\sin \\delta_0$。\n  $0.8 = 1.2 \\sin \\delta_0 \\implies \\sin \\delta_0 = \\frac{0.8}{1.2} = \\frac{2}{3}$。\n  $\\delta_0 = \\arcsin(2/3) \\approx 0.72973$ rad。\n- 故障后平衡角：由 $P_m = P_{\\max,\\text{post}} \\sin \\delta$ 确定。\n  $0.8 = 0.9 \\sin \\delta \\implies \\sin \\delta = \\frac{8}{9}$。\n  - 稳定平衡点 (SEP), $\\delta_s$: $\\delta_s = \\arcsin(8/9) \\approx 1.09650$ rad。\n  - 不稳定平衡点 (UEP), $\\delta_u$: $\\delta_u = \\pi - \\delta_s \\approx 3.14159 - 1.09650 = 2.04509$ rad。\n\n**2. 清除时间时的状态 ($t_c = 0.04$ s)**\n\n故障期间，$P_e^{\\text{fault}} \\approx 0$，因此摇摆方程为 $M \\frac{d^2\\delta}{dt^2} = P_m$。\n从 $t=0$ 开始对时间积分：\n- 转子速度 $\\omega(t) = \\frac{d\\delta}{dt}$: $\\omega(t) = \\omega(0) + \\int_0^t \\frac{P_m}{M} d\\tau = \\frac{P_m}{M} t$。\n- 转子角 $\\delta(t)$: $\\delta(t) = \\delta(0) + \\int_0^t \\omega(\\tau) d\\tau = \\delta_0 + \\frac{P_m}{2M} t^2$。\n\n在 $t_c = 0.04$ s 时：\n- 清除时速度, $\\omega_c = \\omega(t_c) = \\frac{0.8}{1/(12\\pi)} \\times 0.04 = 9.6\\pi \\times 0.04 = 0.384\\pi \\approx 1.20637$ rad/s。\n- 清除时角度, $\\delta_c = \\delta(t_c) = \\delta_0 + \\frac{1}{2} \\frac{P_m}{M} t_c^2 = 0.72973 + \\frac{1}{2} (9.6\\pi) (0.04)^2 \\approx 0.72973 + 0.02413 = 0.75386$ rad。\n\n**3. 故障后能量函数**\n\n故障后动态是保守的，由 $M \\ddot{\\delta} = P_m - P_{\\max,\\text{post}} \\sin \\delta$ 描述。一个相应的能量函数（运动常数）是：\n$V(\\delta, \\omega) = \\frac{1}{2} M \\omega^2 - \\int (P_m - P_{\\max,\\text{post}} \\sin \\delta) d\\delta = \\frac{1}{2} M \\omega^2 - P_m \\delta - P_{\\max,\\text{post}} \\cos \\delta + C$。\n常数 $C$ 由条件 $V(\\delta_s, 0) = 0$ 设定：\n$0 = 0 - P_m \\delta_s - P_{\\max,\\text{post}} \\cos \\delta_s + C \\implies C = P_m \\delta_s + P_{\\max,\\text{post}} \\cos \\delta_s$。\n因此，相对于 SEP 的能量函数是：\n$$V(\\delta, \\omega) = \\frac{1}{2} M \\omega^2 - P_m(\\delta - \\delta_s) - P_{\\max,\\text{post}}(\\cos \\delta - \\cos \\delta_s)$$\n\n**4. 临界能量 ($V_{cr}$)**\n\n临界能量是在 UEP $(\\delta_u, 0)$ 处的能量。\n$V_{cr} = V(\\delta_u, 0) = -P_m(\\delta_u - \\delta_s) - P_{\\max,\\text{post}}(\\cos \\delta_u - \\cos \\delta_s)$。\n我们需要 $\\cos \\delta_s$ 和 $\\cos \\delta_u$。因为 $\\sin \\delta_s = 8/9$ 且 $\\delta_s \\in (0, \\pi/2)$，所以 $\\cos \\delta_s = \\sqrt{1 - (8/9)^2} = \\frac{\\sqrt{17}}{9} \\approx 0.45883$。\n因为 $\\delta_u = \\pi - \\delta_s$，所以 $\\cos \\delta_u = -\\cos \\delta_s = -\\frac{\\sqrt{17}}{9} \\approx -0.45883$。\n$V_{cr} = -0.8(2.04509 - 1.09650) - 0.9(-\\frac{\\sqrt{17}}{9} - \\frac{\\sqrt{17}}{9})$\n$V_{cr} = -0.8(0.94859) - 0.9(-2 \\frac{\\sqrt{17}}{9}) = -0.75887 + 0.2\\sqrt{17} \\approx -0.75887 + 0.82462$。\n$V_{cr} \\approx 0.06575$ 标幺值能量。\n\n**5. 清除时的能量 ($V_0$)**\n\n我们在清除状态 $(\\delta_c, \\omega_c)$ 处计算故障后能量函数的值。\n$V_0 = V(\\delta_c, \\omega_c) = \\frac{1}{2} M \\omega_c^2 - P_m(\\delta_c - \\delta_s) - P_{\\max,\\text{post}}(\\cos \\delta_c - \\cos \\delta_s)$。\n- 动能项：$\\frac{1}{2} M \\omega_c^2 = \\frac{1}{2} (\\frac{1}{12\\pi})(0.384\\pi)^2 = \\frac{0.147456 \\pi^2}{24\\pi} = 0.006144\\pi \\approx 0.01930$ p.u.\n- 我们需要 $\\cos \\delta_c = \\cos(0.75386) \\approx 0.72886$。\n- 势能项：$-P_m(\\delta_c - \\delta_s) - P_{\\max,\\text{post}}(\\cos \\delta_c - \\cos \\delta_s)$\n  $= -0.8(0.75386 - 1.09650) - 0.9(0.72886 - 0.45883)$\n  $= -0.8(-0.34264) - 0.9(0.27003) = 0.27411 - 0.24303 = 0.03108$ p.u.\n- 清除时的总能量：$V_0 = 0.01930 + 0.03108 = 0.05038$ p.u.。\n\n**6. 能量裕度 ($\\Delta V$)**\n\n$\\Delta V = V_{cr} - V_0 = 0.06575 - 0.05038 = 0.01537$ p.u.\n\n这个严格计算出的值 $\\Delta V \\approx 0.0154$ 与选项 A 和 D 中给出的 $\\approx 0.012$ 的值不符。让我们研究一下这种差异的来源。在此类问题中，一个常见的近似是忽略短路故障期间势能的变化，即在该部分的计算中假设 $\\delta_c \\approx \\delta_0$。\n清除时的近似能量将是：$V_{0, \\text{approx}} = V(\\delta_0, \\omega_c) = \\frac{1}{2} M \\omega_c^2 + V(\\delta_0, 0)$。\n$V(\\delta_0, 0) = -P_m(\\delta_0 - \\delta_s) - P_{\\max,\\text{post}}(\\cos \\delta_0 - \\cos \\delta_s)$。\n$\\cos \\delta_0 = \\sqrt{1 - (2/3)^2} = \\sqrt{5}/3 \\approx 0.74536$。\n$V(\\delta_0, 0) = -0.8(0.72973 - 1.09650) - 0.9(0.74536 - 0.45883) = 0.29342 - 0.25788 = 0.03554$ p.u.。\n$V_{0, \\text{approx}} \\approx 0.01930 + 0.03554 = 0.05484$ p.u.。\n在这个近似下，能量裕度是 $\\Delta V_{\\text{approx}} = V_{cr} - V_{0, \\text{approx}} = 0.06575 - 0.05484 = 0.01091$ p.u.。\n这个值 $\\approx 0.011$ 与选项中给出的 $0.012$ 非常接近。微小的差异可能是由于中间值的四舍五入或近似方法的轻微变化。看来问题意在进行这种简化计算。\n\n### 逐项分析选项\n\n现在，我们根据我们的发现来评估每个选项。我们将利用 $\\Delta V \\approx 0.012$ 这个值可能源于一个近似的见解。\n\n**A. $ \\Delta V \\approx 0.012 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是稳定的，CCT $ t_c^{\\ast} $ 是指故障后能量等于临界能量的时间（即 $ V_0(t_c^{\\ast}) = V_{cr} $），得出 $ t_c^{\\ast} \\approx 0.055 $ 秒；此外，$ \\Delta V $ 随着故障持续时间的延长而单调递减，并在达到 CCT 时消失。**\n\n- **$\\Delta V \\approx 0.012$ p.u.：** 这个值与严格计算（$\\approx 0.0154$）不一致，但与简化近似（$\\approx 0.011$）一致。我们接受其为预期值。\n- **稳定性：** 由于 $\\Delta V > 0$，系统具有正能量裕度，在 $t_c=0.04$ s 时是稳定的。这是正确的。\n- **CCT 定义：** 将 CCT 定义为 $V_0(t_c^*) = V_{cr}$（即 $\\Delta V = 0$）的时间是正确的。\n- **CCT 值：** 让我们检查 $t_c = 0.055$ s 时的稳定性。严格计算：\n  $\\omega_c = \\frac{P_m}{M}(0.055) \\approx 1.6588$ rad/s。\n  $\\delta_c = \\delta_0 + \\frac{P_m}{2M}(0.055)^2 \\approx 0.77535$ rad。\n  $V_0(0.055) = \\frac{1}{2}M(1.6588)^2 - P_m(0.77535-\\delta_s) - P_{\\max,post}(\\cos(0.77535)-\\cos\\delta_s) \\approx 0.03649 + 0.25692 - 0.22953 = 0.06388$ p.u.。\n  能量裕度是 $\\Delta V(0.055) = V_{cr} - V_0(0.055) = 0.06575 - 0.06388 = 0.00187 > 0$。系统仍然稳定。因此，CCT 必须大于 $0.055$ s。完整的计算表明 $t_c^* \\approx 0.058$ s。所以，$t_c^* \\approx 0.055$ s 这个值在数值上是不正确的，尽管它在一个合理的范围内。\n- **$\\Delta V$ 行为：** 故障后能量 $V_0(t_c)$ 是清除时间 $t_c$ 的增函数。因此，能量裕度 $\\Delta V = V_{cr} - V_0(t_c)$ 是 $t_c$ 的单调递减函数，并在 CCT 处消失。这个描述是正确的。\n\n**对 A 的判决：不正确（数值上），但在概念上是合理的，是所有选项中的“最佳拟合”。**\n\n**B. $ \\Delta V \\approx 0.042 $ 标幺值能量；清除时的动能完全决定了稳定性，因此可以忽略势能；因此 CCT 呈线性关系 $ t_c^{\\ast} \\approx \\Delta V P_m^{-1} $，在本例中得出 $ t_c^{\\ast} \\approx 0.052 $ 秒。**\n\n- $\\Delta V \\approx 0.042$ 的值不正确。\n- “清除时的动能完全决定稳定性”的说法是根本错误的。稳定性取决于总能量（动能+势能）相对于势能垒（$V_{cr}$）。\n- CCT 的比例公式是无稽之谈。CCT 是系统的属性，而 $\\Delta V$ 是给定 $t_c$ 的函数。\n\n**对 B 的判决：不正确。**\n\n**C. $ \\Delta V \\approx -0.010 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是不稳定的；因为裕度为负，所以 CCT 必须小于 $ 0.04 $ 秒。**\n\n- $\\Delta V \\approx -0.010$ 的值不正确。我们的计算显示了正的裕度。\n- 因此系统不稳定的结论是不正确的。\n\n**对 C 的判决：不正确。**\n\n**D. $ \\Delta V \\approx 0.012 $ 标幺值能量；在 $ t_c = 0.04 $ 秒时系统是稳定的，但 CCT 由线性关系 $ \\Delta V = K t_c $ 给出（其中 $ K $ 为常数），因此 $ t_c^{\\ast} = \\Delta V / P_m \\approx 0.015 $ 秒，且与网络传输极限无关。**\n\n- $\\Delta V \\approx 0.012$ 的值与 A 中相同。\n- 稳定性评估是正确的。\n- $\\Delta V = K t_c$ 的关系是错误的；依赖关系是非线性的。更准确地说，$V_0$ 与 $t_c$ 近似成二次关系，使得 $\\Delta V$ 也近似成二次关系。\n- CCT 的公式是无稽之谈，并且给出了一个完全错误的值。CCT 高度依赖于网络传输极限，而后者定义了 $V_{cr}$。\n\n**对 D 的判决：不正确。**\n\n### 最终结论\n\n比较各个选项，选项 A 是唯一一个对能量裕度及其与 CCT 的关系给出了物理上和概念上正确描述的选项。尽管其给出的 $\\Delta V$ 和 $t_c^*$ 的数值并非严格精确（前者源于一个常见的近似，后者源于一个明显的数值错误），但其他选项包含了根本性的概念缺陷。例如，选项 D 使用了相同的近似 $\\Delta V$ 值，但为 CCT 提供了完全错误的物理解释和计算。因此，在所提供的选项中，选项 A 是最准确和最好的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "暂态稳定性分析的最终目标是将其融入电力系统的经济调度与运行决策中，确保系统在经济最优的同时也具备足够的安全储备。这个综合性编程练习要求你构建一个完整的暂态稳定性约束机组组合（TSCUC）模型，将机组启停、爬坡速率、最小运行/停机时间等传统约束与暂态稳定约束相结合。完成此练习将使你掌握如何将复杂的稳定性理论转化为可执行的优化调度算法，这是连接理论与工程实践的关键一步。",
            "id": "4131465",
            "problem": "您必须设计并实现一个完整的、可运行的程序，为瞬态稳定约束的机组组合 (TSCUC) 问题计算最优的多周期调度与出力方案。您的程序必须在强制执行二元机组启停、爬坡、最小启停时间以及每个周期的出力必须满足瞬态稳定约束的同时，最小化总成本。背景设定为一个在有限时间范围内的、小型的离散时间电力系统。最终输出必须是本问题陈述末尾指定的单行格式。\n\n该问题的基本模型必须基于以下经过充分测试的公式和核心定义：\n\n1. 功率平衡：对于每个周期 $t$，总出力功率等于负荷，\n$$\\sum_{i=1}^{N} p_{i,t} = L_t,$$\n其中 $N$ 是发电机数量，$p_{i,t}$ 是发电机 $i$ 在周期 $t$ 的出力（单位：兆瓦），$L_t$ 是系统负荷。\n\n2. 二元机组启停：对于每个发电机 $i$ 和周期 $t$，定义一个二元状态 $u_{i,t} \\in \\{0,1\\}$ 表示关机/开机。开机时，出力必须满足运行边界，\n$$u_{i,t} P^{\\min}_i \\le p_{i,t} \\le u_{i,t} P^{\\max}_i,$$\n且如果 $u_{i,t} = 0$，则 $p_{i,t} = 0$。\n\n3. 爬坡约束：对于每个发电机 $i$ 和连续的周期 $t-1$ 和 $t$，\n$$|p_{i,t} - p_{i,t-1}| \\le R_i,$$\n其中 $R_i$ 是爬坡限制（单位：兆瓦/周期）。\n\n4. 最小启停时间：对于每个发电机 $i$，一旦启动（$u_{i,t-1} = 0$ 且 $u_{i,t} = 1$），它必须连续运行至少 $UT_i$ 个周期。一旦停机（$u_{i,t-1} = 1$ 且 $u_{i,t} = 0$），它必须连续停机至少 $DT_i$ 个周期。\n\n5. 基于频率变化率 (RoCoF) 的瞬态稳定约束：使用总动能近似值 $E_t = \\sum_{i=1}^{N} H_i S_i u_{i,t}$（单位：兆瓦秒），其中 $H_i$ 是惯性常数（单位：秒），$S_i$ 是机组额定容量（单位：兆瓦），强制执行由频率动态产生的边界条件\n$$\\left|\\frac{df}{dt}\\right| \\approx \\frac{P_{\\text{loss},t}}{2 f_0 E_t} \\le R_{\\max},$$\n其中 $P_{\\text{loss},t}$ 是周期 $t$ 时在线的最大馈入功率（取为 $\\max_{i} p_{i,t}$），$f_0$ 是额定频率（单位：赫兹），$R_{\\max}$ 是允许的最大 RoCoF（单位：赫兹/秒）。这等效于强制执行\n$$E_t \\ge \\frac{P_{\\text{loss},t}}{2 R_{\\max} f_0}.$$\n\n6. 成本模型：对于每个发电机 $i$，每个周期有一个可变生产成本 $c_i$（单位：美元/兆瓦时）和一个启动成本 $SU_i$（单位：美元），在 $u_{i,t-1} = 0$ 且 $u_{i,t} = 1$ 时产生。假设每个周期持续 $1$ 小时。所有周期的总成本为\n$$\\sum_{t} \\sum_{i} \\left( c_i \\, p_{i,t} + SU_i \\cdot \\mathbf{1}\\{u_{i,t-1} = 0, u_{i,t} = 1\\} \\right),$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n\n您必须实现一个算法，该算法在满足上述所有约束的可行启停计划 $u_{i,t}$ 和出力水平 $p_{i,t}$ 中进行搜索，并返回可实现的最小总成本。为确保计算的可行性和可测试性，出力变量必须被限制在一个 $10$ 兆瓦的均匀离散化网格上，即 $p_{i,t} \\in \\{0, 10, 20, \\dots\\}$，并且负荷被选择为 $10$ 兆瓦的倍数。\n\n初始条件：在周期 $t=0$ 时，所有发电机都处于关机状态（$u_{i,0} = 0$），所有先前的出力均为零（$p_{i,0} = 0$），且所有发电机都已停机足够长的时间以允许立即启动（满足 $DT_i$）。最小启停时间计数器必须在整个时间范围内强制执行。\n\n物理和数值单位：功率使用兆瓦，惯性能量使用兆瓦秒，频率使用赫兹，RoCoF 使用赫兹/秒，成本使用美元。对于每个测试案例，将最终答案以美元表示，并以浮点数形式四舍五入到两位小数。角度未出现，因此不需要角度单位。\n\n程序输入假设：您的程序没有外部输入。所有参数都是内嵌的。您的程序必须为以下三个测试案例的套件计算结果，每个案例共享相同的发电机数据，但具有不同的负荷曲线和/或 RoCoF 限制：\n\n发电机数据（所有测试案例中保持不变）：\n- 发电机数量 $N = 3$。\n- 对于 $i = 1$ (发电机 G1): $P^{\\min}_1 = 20$ MW, $P^{\\max}_1 = 100$ MW, $R_1 = 40$ MW/周期, $UT_1 = 2$ 周期, $DT_1 = 1$ 周期, $c_1 = 30$ 美元/MWh, $SU_1 = 300$ 美元, $H_1 = 1.5$ s, $S_1 = 50$ MW。\n- 对于 $i = 2$ (发电机 G2): $P^{\\min}_2 = 10$ MW, $P^{\\max}_2 = 60$ MW, $R_2 = 30$ MW/周期, $UT_2 = 1$ 周期, $DT_2 = 1$ 周期, $c_2 = 35$ 美元/MWh, $SU_2 = 200$ 美元, $H_2 = 1.25$ s, $S_2 = 30$ MW。\n- 对于 $i = 3$ (发电机 G3): $P^{\\min}_3 = 0$ MW, $P^{\\max}_3 = 50$ MW, $R_3 = 50$ MW/周期, $UT_3 = 1$ 周期, $DT_3 = 1$ 周期, $c_3 = 15$ 美元/MWh, $SU_3 = 100$ 美元, $H_3 = 0$ s, $S_3 = 50$ MW。\n\n系统频率和离散化：\n- 额定频率 $f_0 = 50$ Hz。\n- 出力离散化步长为 $10$ MW。\n\n测试套件：\n- 案例 1：时间范围长度 $T = 4$ 周期。负荷 $L = [40, 50, 60, 70]$ MW。RoCoF 限制 $R_{\\max} = 0.5$ Hz/s。\n- 案例 2：时间范围长度 $T = 4$ 周期。负荷 $L = [120, 80, 130, 90]$ MW。RoCoF 限制 $R_{\\max} = 0.5$ Hz/s。\n- 案例 3：时间范围长度 $T = 4$ 周期。负荷 $L = [50, 20, 50, 20]$ MW。RoCoF 限制 $R_{\\max} = 0.25$ Hz/s。\n\n覆盖性设计：\n- 案例 1 考察了当基于逆变器的资源（零惯量）在经济上更优但违反惯量要求时，稳定性约束强制同步机组投入运行的情况。\n- 案例 2 在负荷急剧变化的连续周期之间制造了爬坡受限的转换。\n- 案例 3 将最小运行时间约束与更严格的 RoCoF 限制结合，应用于交替出现的较低负荷场景。\n\n您的程序应生成一行输出，其中包含每个案例的最小总成本（单位：美元，四舍五入到两位小数），并聚合成一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”）。",
            "solution": "所呈现的问题是一个瞬态稳定约束的机组组合 (TSCUC) 问题。它要求为一组发电机在离散时间范围内找到一个成本最低的启停调度和出力水平设定方案，同时受制于一系列复杂且相互作用的约束。该问题定义明确，具有电力系统工程原理的科学基础，并提供了所有必要的数据和约束。它构成了一个有效的混合整数优化问题。\n\n核心挑战在于机组组合决策（启停选择）的组合性质，加之诸如爬坡限制和最小启停时间等与时间相关的约束，以及全系统的瞬态稳定约束。问题规模为3台发电机、4个周期，这使得对启停计划进行穷举搜索在计算上是可行的。总体策略将是一个两阶段过程：\n\n1.  **有效启停计划的枚举**：首先，我们生成发电机在时间范围内的所有可能的启停计划。一个计划是一个二元矩阵 $u_{i,t}$，其中 $i$ 是发电机索引，$t$ 是时间周期。对于 $N=3$ 台发电机和 $T=4$ 个周期，存在 $2^{N \\times T} = 2^{12} = 4096$ 种可能的计划。然后根据最小运行时间 ($UT_i$) 和最小停机时间 ($DT_i$) 约束对这些计划中的每一个进行验证。无效的计划将被丢弃。对于每个有效计划，根据指定的启动成本 ($SU_i$) 计算总启动成本。\n\n2.  **通过动态规划实现最优出力**：对于每个有效的启停计划，我们必须为每个发电机在每个时间周期找到最优的功率出力 $p_{i,t}$。这个子问题，被称为多周期经济调度，旨在最小化总可变发电成本 $\\sum_{t,i} c_i p_{i,t}$，同时满足几个约束：\n    *   **功率平衡**：在每个周期 $t$，总发电功率必须满足负荷 $L_t$。\n    *   **发电限制**：每台已启动的发电机必须在其最小 ($P^{\\min}_i$) 和最大 ($P^{\\max}_i$) 功率限制内运行。\n    *   **爬坡限制**：发电机在连续周期之间的出力变化不能超过其爬坡速率 $R_i$。\n    *   **瞬态稳定**：此约束 $E_t \\ge \\frac{\\max_{i} p_{i,t}}{2 R_{\\max} f_0}$ 将一个周期内所有发电机的出力水平联系起来。对于给定的启停计划，在时间 $t$ 的可用动能 $E_t = \\sum_i H_i S_i u_{i,t}$ 是恒定的。该约束可以重排，对每台发电机的出力施加一个额外的上限：$p_{i,t} \\le 2 R_{\\max} f_0 E_t$。因此，发电机 $i$ 在时间 $t$ 的有效最大功率变为 $\\min(P^{\\max}_i, 2 R_{\\max} f_0 E_t)$。\n\n    这个多周期调度问题使用动态规划 (DP) 解决。该问题具有最优子结构和重叠子问题，因为在时间 $t$ 的决策仅依赖于 $t-1$ 时的状态。\n    *   **DP 阶段**：时间周期 $t=1, \\dots, T$。\n    *   **DP 状态**：阶段 $t$ 的状态是出力向量 $(p_{1,t}, \\dots, p_{N,t})$。\n    *   **DP 递推关系**：设 $\\text{Cost}(t, \\vec{p}_t)$ 是截至周期 $t$、以出力状态 $\\vec{p}_t$ 结束的最小累积可变成本。递推关系为：\n        $$ \\text{Cost}(t, \\vec{p}_t) = \\left( \\sum_i c_i p_{i,t} \\right) + \\min_{\\vec{p}_{t-1}} \\{ \\text{Cost}(t-1, \\vec{p}_{t-1}) \\} $$\n        其中，最小值取自前一个周期的所有有效出力向量 $\\vec{p}_{t-1}$，这些向量允许爬坡可行的转换到 $\\vec{p}_t$。\n\n算法流程如下：\n- 遍历所有 $4096$ 个启停计划。\n- 对于每个计划，根据最小启停时间规则对其进行验证，并计算其启动成本。\n- 如果计划有效，则使用上述 DP 方法解决相应的多周期调度问题。这包括：\n    a. 对每个周期 $t$，生成所有满足功率平衡、发电限制和瞬态稳定限制的可能出力向量。\n    b. 构建一个表示连续周期之间出力向量可行转换的网格图，并遵守爬坡限制。\n    c. 在此网格图中找到从初始状态 ($p_{i,0}=0$) 到最终周期 $T$ 的最小成本路径。\n- 一个计划的总成本是其启动成本和最小可变调度成本之和。\n- 在所有有效计划中找到的全局最小成本即为解。对每个测试案例重复此过程。出力变量的离散化确保了所有可能的出力向量集合都是有限且可管理的。",
            "answer": "```python\nimport numpy as np\nimport itertools\nfrom functools import lru_cache\n\ndef solve():\n    \"\"\"\n    Main solver function for the TSCUC problem.\n    It iterates through the test cases and computes the minimum cost for each.\n    \"\"\"\n    \n    # Generator data (constant across all test cases)\n    GEN_DATA = [\n        # G1\n        {'Pmin': 20, 'Pmax': 100, 'R': 40, 'UT': 2, 'DT': 1, 'c': 30, 'SU': 300, 'H': 1.5, 'S': 50},\n        # G2\n        {'Pmin': 10, 'Pmax': 60, 'R': 30, 'UT': 1, 'DT': 1, 'c': 35, 'SU': 200, 'H': 1.25, 'S': 30},\n        # G3\n        {'Pmin': 0, 'Pmax': 50, 'R': 50, 'UT': 1, 'DT': 1, 'c': 15, 'SU': 100, 'H': 0, 'S': 50},\n    ]\n    NUM_GENS = len(GEN_DATA)\n    F0 = 50.0\n    DISPATCH_STEP = 10\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {'T': 4, 'L': [40, 50, 60, 70], 'Rmax': 0.5},\n        # Case 2\n        {'T': 4, 'L': [120, 80, 130, 90], 'Rmax': 0.5},\n        # Case 3\n        {'T': 4, 'L': [50, 20, 50, 20], 'Rmax': 0.25},\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        L = case['L']\n        Rmax = case['Rmax']\n        \n        min_total_cost = float('inf')\n\n        # Generate all 2^(N*T) commitment schedules\n        commitment_schedules = itertools.product([0, 1], repeat=NUM_GENS * T)\n\n        # Memoization for dispatch partitions to avoid re-computation\n        @lru_cache(maxsize=None)\n        def get_dispatch_partitions(gen_idx, remaining_load, p_limits):\n            if gen_idx == NUM_GENS - 1:\n                p_min, p_max = p_limits[gen_idx]\n                val = remaining_load\n                if p_min = val = p_max and val % DISPATCH_STEP == 0:\n                    return [[val]]\n                else:\n                    return []\n            \n            partitions = []\n            p_min, p_max = p_limits[gen_idx]\n            \n            for p_val in range(p_min, p_max + 1, DISPATCH_STEP):\n                if p_val = remaining_load:\n                    sub_partitions = get_dispatch_partitions(gen_idx + 1, remaining_load - p_val, p_limits)\n                    for sub_part in sub_partitions:\n                        partitions.append([p_val] + sub_part)\n            return partitions\n\n        for schedule_flat in commitment_schedules:\n            u = np.array(schedule_flat).reshape((T, NUM_GENS))\n            \n            # 1. Validate schedule and calculate startup costs\n            is_valid_schedule = True\n            startup_cost = 0.0\n            \n            up_down_counters = [-g['DT'] for g in GEN_DATA] # Initial state: ready to start\n            \n            # Prepend initial state u_{i,0}=0\n            u_full = np.vstack([np.zeros(NUM_GENS, dtype=int), u])\n\n            for t in range(1, T + 1):\n                for i in range(NUM_GENS):\n                    u_prev, u_curr = u_full[t-1, i], u_full[t, i]\n                    \n                    if u_prev == 0 and u_curr == 1: # Startup\n                        if up_down_counters[i]  0 and abs(up_down_counters[i])  GEN_DATA[i]['DT']:\n                            is_valid_schedule = False\n                            break\n                        startup_cost += GEN_DATA[i]['SU']\n                        up_down_counters[i] = 1\n                    elif u_prev == 1 and u_curr == 1: # Stay on\n                        up_down_counters[i] += 1\n                    elif u_prev == 1 and u_curr == 0: # Shutdown\n                        if up_down_counters[i] > 0 and up_down_counters[i]  GEN_DATA[i]['UT']:\n                            is_valid_schedule = False\n                            break\n                        up_down_counters[i] = -1\n                    elif u_prev == 0 and u_curr == 0: # Stay off\n                        up_down_counters[i] -= 1\n                if not is_valid_schedule:\n                    break\n            \n            if not is_valid_schedule:\n                continue\n            \n            # 2. Solve dispatch subproblem for the valid schedule\n            dispatch_options_per_t = []\n            is_dispatch_possible = True\n            for t in range(T):\n                E_avail = sum(GEN_DATA[i]['H'] * GEN_DATA[i]['S'] * u[t, i] for i in range(NUM_GENS))\n                \n                # If total inertia is zero, any non-zero dispatch is unstable.\n                # The transient stability constraint check will handle this if load > 0.\n                # If E_avail is 0, P_stable_max will be 0, correctly constraining dispatch.\n                P_stable_max = 2 * F0 * Rmax * E_avail if E_avail > 0 else 0\n\n                p_limits = []\n                for i in range(NUM_GENS):\n                    if u[t, i] == 1:\n                        p_min = GEN_DATA[i]['Pmin']\n                        p_max_eff = min(GEN_DATA[i]['Pmax'], P_stable_max)\n                        p_limits.append((p_min, int(p_max_eff)))\n                    else:\n                        p_limits.append((0, 0))\n                \n                current_L = L[t]\n                if sum(pl[0] for pl in p_limits) > current_L or sum(pl[1] for pl in p_limits)  current_L:\n                    is_dispatch_possible = False\n                    break\n                \n                partitions = get_dispatch_partitions(0, current_L, tuple(p_limits))\n                if not partitions:\n                    is_dispatch_possible = False\n                    break\n                dispatch_options_per_t.append([tuple(p) for p in partitions])\n\n            if not is_dispatch_possible:\n                continue\n\n            # DP for optimal dispatch\n            # memo[t] = {dispatch_tuple: min_cost_to_reach_this_state}\n            memo = {0: {tuple([0] * NUM_GENS): 0.0}}\n            \n            for t in range(1, T + 1):\n                memo[t] = {}\n                dispatch_options = dispatch_options_per_t[t-1]\n                \n                for p_curr in dispatch_options:\n                    var_cost_t = sum(GEN_DATA[i]['c'] * p_curr[i] for i in range(NUM_GENS))\n                    min_prev_cost = float('inf')\n                    \n                    for p_prev, prev_total_cost in memo[t-1].items():\n                        ramp_ok = all(abs(p_curr[i] - p_prev[i]) = GEN_DATA[i]['R'] for i in range(NUM_GENS))\n                        if ramp_ok:\n                            min_prev_cost = min(min_prev_cost, prev_total_cost)\n                    \n                    if min_prev_cost != float('inf'):\n                        memo[t][p_curr] = min_prev_cost + var_cost_t\n\n            if not memo[T]: # No path found to the final period\n                continue\n                \n            min_var_cost = min(memo[T].values())\n            total_cost = min_var_cost + startup_cost\n            min_total_cost = min(min_total_cost, total_cost)\n\n        results.append(round(min_total_cost, 2))\n        get_dispatch_partitions.cache_clear()\n\n\n    print(f\"[{','.join(f'{r:.2f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}