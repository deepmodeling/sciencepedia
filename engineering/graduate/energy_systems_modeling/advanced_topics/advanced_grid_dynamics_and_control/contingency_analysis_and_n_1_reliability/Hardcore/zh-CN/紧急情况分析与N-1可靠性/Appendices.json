{
    "hands_on_practices": [
        {
            "introduction": "掌握暂态分析的第一步是理解在发生故障后，电力如何在网络中重新分配。本练习提供了一个从基本原理出发，应用直流潮流模型的实践机会。通过构建网络的导纳矩阵并求解线性潮流方程，您将计算故障前后的线路潮流，以识别和量化热过载，这是确保电网可靠性的一项基本技能。",
            "id": "4080881",
            "problem": "考虑一个无损输电网络，该网络在小角度假设下采用线性直流（DC）潮流近似模型进行建模，基准视在功率为 $S_{\\text{base}} = 100$ MVA。该网络包含节点 $\\{1,2,3,4\\}$ 和输电线路，其串联电抗（以标幺值计）如下：\n- 线路 $1$–$2$：$x_{12} = 0.2$ p.u.\n- 线路 $1$–$3$：$x_{13} = 0.25$ p.u.\n- 线路 $2$–$3$：$x_{23} = 0.2$ p.u.\n- 线路 $2$–$4$：$x_{24} = 0.25$ p.u.\n- 线路 $3$–$4$：$x_{34} = 0.3$ p.u.\n\n所有线路具有相同的长期热极限 $\\overline{F}_{\\ell} = 150$ MW。各节点的有功功率注入（正值表示净发电，负值表示净负荷）以兆瓦（MW）为单位，如下所示：\n- $P_{1} = +200$ MW, $P_{2} = -80$ MW, $P_{3} = -60$ MW, $P_{4} = -60$ MW.\n\n选取节点 $1$ 作为参考（平衡）节点，其相角为 $\\theta_{1} = 0$ 弧度。仅使用直流模型的基本原理（节点有功功率平衡和由串联电抗构建的电纳矩阵）以及通过消去平衡节点的行和列进行网络简化，执行以下操作：\n- 计算事故前节点 $i \\in \\{2,3,4\\}$ 的直流节点电压相角 $\\theta_{i}$ 以及所有现有线路上的相应事故前线路潮流 $F_{ij}$（单位：MW）。\n- 通过从网络中移除线路 $1$–$3$ 来模拟其停运对应的 $N-1$ 事故，重新计算事故后节点电压相角 $\\theta_{i}$ 以及剩余线路上的事故后线路潮流 $F_{ij}$（单位：MW）。\n- 将线路 $\\ell$ 上的事故后过载量定义为 $\\max(0, |F_{\\ell}| - \\overline{F}_{\\ell})$。确定停运后剩余线路中的最大过载量。\n\n以兆瓦（MW）为单位，将最终答案表示为单一的最大过载量。将您的答案四舍五入至四位有效数字。相角应以弧度为单位。",
            "solution": "用户提供的问题经评估有效。该问题是自洽的，科学上基于电气工程原理（特别是直流潮流近似），并且在数学上是适定的。给定的数据是完整且一致的；例如，指定的有功功率注入之和为 $P_{1} + P_{2} + P_{3} + P_{4} = (+200) + (-80) + (-60) + (-60) = 0$ MW，这与无损网络模型一致。我们可以开始求解。\n\n直流潮流模型通过方程 $P = B\\theta$ 将节点有功功率注入 $P$ 与节点电压相角 $\\theta$ 联系起来，其中 $B$ 是节点电纳矩阵。$B$ 矩阵的元素由线路电抗 $x_{ij}$ 导出，对于 $i \\neq j$，$B_{ij} = -1/x_{ij}$；而 $B_{ii} = \\sum_{k \\neq i} 1/x_{ik}$。从节点 $i$ 到节点 $j$ 的线路上的有功潮流 $F_{ij}$ 由 $F_{ij} = \\frac{1}{x_{ij}}(\\theta_i - \\theta_j)$ 给出。所有计算都将在标幺值（p.u.）系统中进行。\n\n首先，我们基于 $S_{\\text{base}} = 100$ MVA 将所有物理量转换为标幺值。由于这是一个直流模型，我们使用 $P_{\\text{base}} = 100$ MW。\n功率注入的标幺值为：\n- $P_{1} = \\frac{200 \\text{ MW}}{100 \\text{ MW}} = 2.0$ p.u.\n- $P_{2} = \\frac{-80 \\text{ MW}}{100 \\text{ MW}} = -0.8$ p.u.\n- $P_{3} = \\frac{-60 \\text{ MW}}{100 \\text{ MW}} = -0.6$ p.u.\n- $P_{4} = \\frac{-60 \\text{ MW}}{100 \\text{ MW}} = -0.6$ p.u.\n线路热极限为 $\\overline{F}_{\\ell} = \\frac{150 \\text{ MW}}{100 \\text{ MW}} = 1.5$ p.u.。\n\n线路电纳 $b_{ij} = 1/x_{ij}$ 为：\n- $b_{12} = 1/0.2 = 5.0$ p.u.\n- $b_{13} = 1/0.25 = 4.0$ p.u.\n- $b_{23} = 1/0.2 = 5.0$ p.u.\n- $b_{24} = 1/0.25 = 4.0$ p.u.\n- $b_{34} = 1/0.3 = 10/3$ p.u.\n\n**第 1 部分：事故前分析**\n\n我们首先为基础案例网络构建电纳矩阵 $B^{(0)}$。\n$B^{(0)}_{11} = b_{12} + b_{13} = 5 + 4 = 9$\n$B^{(0)}_{22} = b_{12} + b_{23} + b_{24} = 5 + 5 + 4 = 14$\n$B^{(0)}_{33} = b_{13} + b_{23} + b_{34} = 4 + 5 + 10/3 = 37/3$\n$B^{(0)}_{44} = b_{24} + b_{34} = 4 + 10/3 = 22/3$\n非对角元素为 $B^{(0)}_{ij} = -b_{ij}$。\n$$ B^{(0)} = \\begin{pmatrix} 9  -5  -4  0 \\\\ -5  14  -5  -4 \\\\ -4  -5  37/3  -10/3 \\\\ 0  -4  -10/3  22/3 \\end{pmatrix} $$\n以节点 $1$ 为平衡节点（$\\theta_1 = 0$），我们通过移除第一行和第一列来使用降阶系统。\n$$ B_{\\text{red}}^{(0)} = \\begin{pmatrix} 14  -5  -4 \\\\ -5  37/3  -10/3 \\\\ -4  -10/3  22/3 \\end{pmatrix}, \\quad P_{\\text{red}} = \\begin{pmatrix} P_2 \\\\ P_3 \\\\ P_4 \\end{pmatrix} = \\begin{pmatrix} -0.8 \\\\ -0.6 \\\\ -0.6 \\end{pmatrix} $$\n求解 $B_{\\text{red}}^{(0)} \\theta^{(0)}_{\\text{red}} = P_{\\text{red}}$ 得到事故前的相角：\n$$ \\theta^{(0)}_{\\text{red}} = \\begin{pmatrix} \\theta_2^{(0)} \\\\ \\theta_3^{(0)} \\\\ \\theta_4^{(0)} \\end{pmatrix} = \\begin{pmatrix} -0.150279 \\\\ -0.160894 \\\\ -0.224581 \\end{pmatrix} \\text{rad} $$\n事故前线路潮流计算公式为 $F_{ij}^{(0)} = S_{\\text{base}} \\times b_{ij} (\\theta_i^{(0)} - \\theta_j^{(0)})$。例如，$F_{12}^{(0)} = 100 \\times 5 \\times (0 - (-0.150279)) \\approx 75.14$ MW。所有事故前潮流均在 $150$ MW 的限制内。\n\n**第 2 部分：N-1 事故分析（线路 1–3 停运）**\n\n线路 1–3 的停运通过从网络中移除其电纳 $b_{13} = 4.0$ p.u. 来建模。新的电纳矩阵 $B^{(1)}$ 通过调整 $B^{(0)}$ 的元素来构建：\n- $B^{(1)}_{11} = B^{(0)}_{11} - b_{13} = 9 - 4 = 5$\n- $B^{(1)}_{33} = B^{(0)}_{33} - b_{13} = 37/3 - 4 = 25/3$\n- $B^{(1)}_{13} = B^{(1)}_{31} = 0$\n新的降阶矩阵 $B_{\\text{red}}^{(1)}$ 为：\n$$ B_{\\text{red}}^{(1)} = \\begin{pmatrix} 14  -5  -4 \\\\ -5  25/3  -10/3 \\\\ -4  -10/3  22/3 \\end{pmatrix} $$\n功率注入向量 $P_{\\text{red}}$ 不变。我们求解新的线性系统 $B_{\\text{red}}^{(1)} \\theta^{(1)}_{\\text{red}} = P_{\\text{red}}$ 以得到事故后的相角 $\\theta^{(1)}_{\\text{red}}$。\n$$ \\begin{pmatrix} 14  -5  -4 \\\\ -5  25/3  -10/3 \\\\ -4  -10/3  22/3 \\end{pmatrix} \\begin{pmatrix} \\theta_2^{(1)} \\\\ \\theta_3^{(1)} \\\\ \\theta_4^{(1)} \\end{pmatrix} = \\begin{pmatrix} -0.8 \\\\ -0.6 \\\\ -0.6 \\end{pmatrix} $$\n为了求解该方程组，我们可以先将最后两行乘以 $3$ 以消去分母：\n1. $14 \\theta_2^{(1)} - 5 \\theta_3^{(1)} - 4 \\theta_4^{(1)} = -0.8$\n2. $-15 \\theta_2^{(1)} + 25 \\theta_3^{(1)} - 10 \\theta_4^{(1)} = -1.8$\n3. $-12 \\theta_2^{(1)} - 10 \\theta_3^{(1)} + 22 \\theta_4^{(1)} = -1.8$\n\n从方程（3）出发，两边除以 $2$ 得到 $-6 \\theta_2^{(1)} - 5 \\theta_3^{(1)} + 11 \\theta_4^{(1)} = -0.9$。\n从方程（2）出发，两边除以 $5$ 得到 $-3 \\theta_2^{(1)} + 5 \\theta_3^{(1)} - 2 \\theta_4^{(1)} = -0.36$。\n由此可得，$5 \\theta_3^{(1)} = 3 \\theta_2^{(1)} + 2 \\theta_4^{(1)} - 0.36$。\n将此代入修改后的方程 (3)：\n$-6 \\theta_2^{(1)} - (3 \\theta_2^{(1)} + 2 \\theta_4^{(1)} - 0.36) + 11 \\theta_4^{(1)} = -0.9$\n$-9 \\theta_2^{(1)} + 9 \\theta_4^{(1)} + 0.36 = -0.9 \\implies -9 \\theta_2^{(1)} + 9 \\theta_4^{(1)} = -1.26 \\implies -\\theta_2^{(1)} + \\theta_4^{(1)} = -0.14$。\n所以，$\\theta_4^{(1)} = \\theta_2^{(1)} - 0.14$。\n\n将 $5 \\theta_3^{(1)}$ 和 $\\theta_4^{(1)}$ 两者都代入方程 (1)：\n$14 \\theta_2^{(1)} - (3 \\theta_2^{(1)} + 2 \\theta_4^{(1)} - 0.36) - 4 \\theta_4^{(1)} = -0.8$\n$11 \\theta_2^{(1)} - 6 \\theta_4^{(1)} + 0.36 = -0.8$\n$11 \\theta_2^{(1)} - 6 (\\theta_2^{(1)} - 0.14) = -1.16$\n$11 \\theta_2^{(1)} - 6 \\theta_2^{(1)} + 0.84 = -1.16$\n$5 \\theta_2^{(1)} = -2.0 \\implies \\theta_2^{(1)} = -0.4$ rad.\n\n现在我们反向代入以求得其他相角：\n$\\theta_4^{(1)} = -0.4 - 0.14 = -0.54$ rad.\n$5 \\theta_3^{(1)} = 3(-0.4) + 2(-0.54) - 0.36 = -1.2 - 1.08 - 0.36 = -2.64 \\implies \\theta_3^{(1)} = -0.528$ rad.\n事故后的相角为 $\\theta_1^{(1)}=0$, $\\theta_2^{(1)}=-0.4$, $\\theta_3^{(1)}=-0.528$, 以及 $\\theta_4^{(1)}=-0.54$ 弧度。\n\n**第 3 部分：过载计算**\n\n我们使用公式 $F_{ij}^{(1)} = S_{\\text{base}} \\times b_{ij} (\\theta_i^{(1)} - \\theta_j^{(1)})$ 计算剩余线路上的事故后潮流 $F^{(1)}_{ij}$。热极限为 $\\overline{F}_{\\ell} = 150$ MW。\n- 线路 1–2：$F_{12}^{(1)} = 100 \\times 5.0 \\times (0 - (-0.4)) = 500 \\times 0.4 = 200$ MW。\n- 线路 2–3：$F_{23}^{(1)} = 100 \\times 5.0 \\times (-0.4 - (-0.528)) = 500 \\times 0.128 = 64$ MW。\n- 线路 2–4：$F_{24}^{(1)} = 100 \\times 4.0 \\times (-0.4 - (-0.54)) = 400 \\times 0.14 = 56$ MW。\n- 线路 3–4：$F_{34}^{(1)} = 100 \\times (10/3) \\times (-0.528 - (-0.54)) = (1000/3) \\times 0.012 = 4$ MW。\n\n线路 $\\ell$ 上的过载量为 $\\max(0, |F^{(1)}_{\\ell}| - \\overline{F}_{\\ell})$。\n- 线路 1–2 过载：$\\max(0, |200| - 150) = 50$ MW。\n- 线路 2–3 过载：$\\max(0, |64| - 150) = 0$ MW。\n- 线路 2–4 过载：$\\max(0, |56| - 150) = 0$ MW。\n- 线路 3–4 过载：$\\max(0, |4| - 150) = 0$ MW。\n\n所有剩余线路中的最大过载量为 $50$ MW。问题要求答案四舍五入到四位有效数字，因此我们将其表示为 $50.00$。",
            "answer": "$$ \\boxed{50.00} $$"
        },
        {
            "introduction": "虽然热过载是一个普遍关注的问题，但某些故障可能导致更严重的后果：将电力系统分裂成孤立的“岛屿”。本练习超越了简单的潮流计算，旨在解决在这些孤岛内维持稳定性的关键挑战。您将分析一个系统分裂事件，评估每个孤岛内的发电与负荷平衡，并在遵守实际运行限制的条件下，确定所需采取的纠正措施，如发电机重新调度或负荷削减。",
            "id": "4080862",
            "problem": "考虑一个采用直流(DC)潮流近似的无损五母线输电网络。母线编号为$1,2,3,4,5$。输电线路连接母线$(1,2)$、$(2,3)$、$(4,5)$，以及一条联络线$(3,4)$。忽略无功功率，并假设$(1,2)$、$(2,3)$和$(4,5)$上的所有内部分支热极限足够大，在所考虑的再调度下永远不会达到约束边界。联络线$(3,4)$初始在运行状态。\n\n故障前，有功发电和负荷情况如下：\n- 母线$1$：发电机$G_1$发出$170\\,\\mathrm{MW}$；发电机限制为$P_{1}^{\\min}=120\\,\\mathrm{MW}$和$P_{1}^{\\max}=200\\,\\mathrm{MW}$。\n- 母线$3$：发电机$G_3$发出$50\\,\\mathrm{MW}$；发电机限制为$P_{3}^{\\min}=30\\,\\mathrm{MW}$和$P_{3}^{\\max}=90\\,\\mathrm{MW}$。另有$40\\,\\mathrm{MW}$的负荷。\n- 母线$2$：负荷为$120\\,\\mathrm{MW}$。\n- 母线$4$：发电机$G_4$发出$80\\,\\mathrm{MW}$；发电机限制为$P_{4}^{\\min}=0\\,\\mathrm{MW}$和$P_{4}^{\\max}=130\\,\\mathrm{MW}$。另有$100\\,\\mathrm{MW}$的负荷。\n- 母线$5$：发电机$G_5$发出$20\\,\\mathrm{MW}$；发电机限制为$P_{5}^{\\min}=0\\,\\mathrm{MW}$和$P_{5}^{\\max}=70\\,\\mathrm{MW}$。另有$60\\,\\mathrm{MW}$的负荷。\n\n所有发电机都有向上爬坡率限制，这限制了它们在紧随故障后的再调度中允许的出力增量：$R_{1}^{\\uparrow}=20\\,\\mathrm{MW}$，$R_{3}^{\\uparrow}=20\\,\\mathrm{MW}$，$R_{4}^{\\uparrow}=30\\,\\mathrm{MW}$，$R_{5}^{\\uparrow}=25\\,\\mathrm{MW}$。假设向下再调度除了受规定的最小出力限制外，不受其他约束。故障前，从$\\{1,2,3\\}$侧通过联络线$(3,4)$向$\\{4,5\\}$侧的净有功功率输出为$60\\,\\mathrm{MW}$，这与给定的发电和负荷值一致。\n\n发生单一故障：联络线$(3,4)$跳闸退出服务，形成两个孤岛$\\mathcal{I}_\\mathrm{W}=\\{1,2,3\\}$和$\\mathcal{I}_\\mathrm{E}=\\{4,5\\}$。根据被称为“N-1可靠性”的安全准则，系统必须在每个孤岛内通过发电机再调度以及必要时的非自愿切负荷来重新平衡，以满足有功功率平衡，同时遵守发电机容量和爬坡率限制。\n\n仅使用功率平衡的基本原理（针对孤岛层级的有功功率的Kirchhoff电流定律）以及给定的发电机限制和爬坡约束，确定故障发生后为立即恢复可行性，两个孤岛所需的最小总非自愿切负荷量。最终答案以$\\mathrm{MW}$为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题经验证是自洽的，科学上基于电力系统分析的原理，并且在数学上是一致的。故障前的功率平衡已经核实，并且提供了故障后分析所需的所有数据。该问题提法明确，旨在根据这些数据寻求一个唯一的、可量化的答案。因此，我将进行正式求解。\n\n控制系统响应的基本原理是有功功率平衡，在故障后必须在每个孤立的子系统（孤岛）内得以维持。该故障是联络线$(3,4)$的断开，它将五母线系统分裂成两个电气上隔离的孤岛：$\\mathcal{I}_\\mathrm{W}=\\{1,2,3\\}$和$\\mathcal{I}_\\mathrm{E}=\\{4,5\\}$。对于每个孤岛，故障后的功率平衡方程必须成立：\n$$\n\\sum_{i \\in \\mathcal{I}} P_{G,i} - \\sum_{j \\in \\mathcal{I}} (P_{L,j} - S_j) = 0\n$$\n其中$P_{G,i}$是母线$i$的故障后发电量，$P_{L,j}$是母线$j$的故障前负荷，$S_j$是母线$j$的非自愿切负荷量。目标是通过在其运行限制内最大化利用可用的发电机再调度，来最小化总切负荷量 $S_{\\text{total}} = \\sum S_j$。我们分别分析每个孤岛。\n\n首先，我们分析孤岛$\\mathcal{I}_\\mathrm{W} = \\{1,2,3\\}$。\n该孤岛故障前的发电和负荷情况是：\n总发电量：$P_{G,\\mathrm{W},0} = P_{1,0} + P_{3,0} = 170\\,\\mathrm{MW} + 50\\,\\mathrm{MW} = 220\\,\\mathrm{MW}$。\n总负荷：$L_{\\mathrm{W}} = L_2 + L_3 = 120\\,\\mathrm{MW} + 40\\,\\mathrm{MW} = 160\\,\\mathrm{MW}$。\n孤岛$\\mathcal{I}_\\mathrm{W}$故障前的净功率平衡是盈余：\n$$\n\\Delta P_{\\mathrm{W},0} = P_{G,\\mathrm{W},0} - L_{\\mathrm{W}} = 220\\,\\mathrm{MW} - 160\\,\\mathrm{MW} = 60\\,\\mathrm{MW}\n$$\n这$60\\,\\mathrm{MW}$的盈余功率正通过联络线$(3,4)$输送到孤岛$\\mathcal{I}_\\mathrm{E}$。联络线断开后，该输送路径消失，孤岛内剩下$60\\,\\mathrm{MW}$的过剩发电量。为了恢复平衡，孤岛$\\mathcal{I}_\\mathrm{W}$内的发电机必须将其总出力降低$60\\,\\mathrm{MW}$。我们必须检查这在其最小发电限制内是否可能。\n所需的发电量变化为$\\Delta P_{\\mathrm{W,req}} = -60\\,\\mathrm{MW}$。\n每台发电机的可用向下再调度量由其最小功率输出$P^{\\min}$决定：\n对于发电机$G_1$：最小出力为$P_{1}^{\\min} = 120\\,\\mathrm{MW}$。最大可能减少量为$\\Delta P_{1,\\max\\downarrow} = P_{1}^{\\min} - P_{1,0} = 120\\,\\mathrm{MW} - 170\\,\\mathrm{MW} = -50\\,\\mathrm{MW}$。\n对于发电机$G_3$：最小出力为$P_{3}^{\\min} = 30\\,\\mathrm{MW}$。最大可能减少量为$\\Delta P_{3,\\max\\downarrow} = P_{3}^{\\min} - P_{3,0} = 30\\,\\mathrm{MW} - 50\\,\\mathrm{MW} = -20\\,\\mathrm{MW}$。\n孤岛$\\mathcal{I}_\\mathrm{W}$中可用的总向下再调度量为：\n$$\n\\Delta P_{\\mathrm{W,avail}\\downarrow} = \\Delta P_{1,\\max\\downarrow} + \\Delta P_{3,\\max\\downarrow} = (-50\\,\\mathrm{MW}) + (-20\\,\\mathrm{MW}) = -70\\,\\mathrm{MW}\n$$\n需要的减少量是$60\\,\\mathrm{MW}$。可用的总减少量是$70\\,\\mathrm{MW}$。由于可用的向下再调度量（$70\\,\\mathrm{MW}$）大于所需的减少量（$60\\,\\mathrm{MW}$），发电机可以成功地降低其出力以重新平衡孤岛。因此，在孤岛$\\mathcal{I}_\\mathrm{W}$中无需切负荷。\n孤岛$\\mathcal{I}_\\mathrm{W}$的切负荷量为$S_{\\mathrm{W}} = 0\\,\\mathrm{MW}$。\n\n接下来，我们分析孤岛$\\mathcal{I}_\\mathrm{E} = \\{4,5\\}$。\n该孤岛故障前的发电和负荷情况是：\n总发电量：$P_{G,\\mathrm{E},0} = P_{4,0} + P_{5,0} = 80\\,\\mathrm{MW} + 20\\,\\mathrm{MW} = 100\\,\\mathrm{MW}$。\n总负荷：$L_{\\mathrm{E}} = L_4 + L_5 = 100\\,\\mathrm{MW} + 60\\,\\mathrm{MW} = 160\\,\\mathrm{MW}$。\n孤岛$\\mathcal{I}_\\mathrm{E}$故障前的净功率平衡是缺额：\n$$\n\\Delta P_{\\mathrm{E},0} = P_{G,\\mathrm{E},0} - L_{\\mathrm{E}} = 100\\,\\mathrm{MW} - 160\\,\\mathrm{MW} = -60\\,\\mathrm{MW}\n$$\n这$60\\,\\mathrm{MW}$的缺额由通过联络线从孤岛$\\mathcal{I}_\\mathrm{W}$输入的功率来满足。联络线断开后，该孤岛出现$60\\,\\mathrm{MW}$的发电缺口。为了恢复平衡，孤岛$\\mathcal{I}_\\mathrm{E}$中的发电机必须尽可能地增加其出力。任何剩余的缺口必须通过切负荷来弥补。\n需要的额外发电量为$60\\,\\mathrm{MW}$。我们必须检查可用的最大向上再调度量，它受到最大容量限制（$P^{\\max}$）和瞬时爬坡率限制（$R^{\\uparrow}$）的双重约束。对于每台发电机，最大瞬时出力增量是两者中的较小值。\n对于发电机$G_4$：\n可用的裕度为$P_{4}^{\\max} - P_{4,0} = 130\\,\\mathrm{MW} - 80\\,\\mathrm{MW} = 50\\,\\mathrm{MW}$。\n爬坡率限制为$R_{4}^{\\uparrow} = 30\\,\\mathrm{MW}$。\n最大可能增量为$\\Delta P_{4,\\max\\uparrow} = \\min(50\\,\\mathrm{MW}, 30\\,\\mathrm{MW}) = 30\\,\\mathrm{MW}$。\n对于发电机$G_5$：\n可用的裕度为$P_{5}^{\\max} - P_{5,0} = 70\\,\\mathrm{MW} - 20\\,\\mathrm{MW} = 50\\,\\mathrm{MW}$。\n爬坡率限制为$R_{5}^{\\uparrow} = 25\\,\\mathrm{MW}$。\n最大可能增量为$\\Delta P_{5,\\max\\uparrow} = \\min(50\\,\\mathrm{MW}, 25\\,\\mathrm{MW}) = 25\\,\\mathrm{MW}$。\n孤岛$\\mathcal{I}_\\mathrm{E}$中可用的总向上再调度量为：\n$$\n\\Delta P_{\\mathrm{E,avail}\\uparrow} = \\Delta P_{4,\\max\\uparrow} + \\Delta P_{5,\\max\\uparrow} = 30\\,\\mathrm{MW} + 25\\,\\mathrm{MW} = 55\\,\\mathrm{MW}\n$$\n发电缺额为$60\\,\\mathrm{MW}$，但发电机在故障发生后只能将其总出力立即增加最多$55\\,\\mathrm{MW}$。剩余的缺口必须通过切负荷来平衡。\n孤岛$\\mathcal{I}_\\mathrm{E}$中所需的最小切负荷量为：\n$$\nS_{\\mathrm{E}} = (\\text{缺额}) - \\Delta P_{\\mathrm{E,avail}\\uparrow} = 60\\,\\mathrm{MW} - 55\\,\\mathrm{MW} = 5\\,\\mathrm{MW}\n$$\n\n最后，两个孤岛的总最小非自愿切负荷量是每个孤岛切负荷量的总和：\n$$\nS_{\\text{total}} = S_{\\mathrm{W}} + S_{\\mathrm{E}} = 0\\,\\mathrm{MW} + 5\\,\\mathrm{MW} = 5\\,\\mathrm{MW}\n$$\n问题要求答案四舍五入到四位有效数字。确切答案是$5\\,\\mathrm{MW}$，为满足此要求写作$5.000\\,\\mathrm{MW}$。",
            "answer": "$$\n\\boxed{5.000}\n$$"
        },
        {
            "introduction": "在拥有数千个组件的真实电力系统中，手动分析每一个可能的故障是不切实际的。本练习介绍了系统操作员用于快速进行故障筛选的计算方法。通过编写一个使用功率转移分布因子（PTDFs）和线路开断分布因子（LODFs）的程序，您将学习如何高效地估算故障后状况，量化不同故障的严重程度，并创建一个按关键性排序的事件列表，以供进一步的详细分析。",
            "id": "4080859",
            "problem": "给定一项直流潮流（DC-PF）筛选任务，该任务针对“n-1”可靠性准则下的单一元件预想事故，要求系统在承受任何单一故障时均不违反热稳定极限。此任务必须使用基于基尔霍夫电流定律（KCL）和线性化潮流近似的功率传输分布因子（PTDF）和线路开断分布因子（LODF）概念来解决。具体而言：\n\n- 基尔霍夫电流定律（KCL）强制节点功率平衡，在直流近似下，该定律与线性化支路潮流关系相结合，得出了从节点净注入功率到线路潮流的线性映射。\n- 功率传输分布因子（PTDF）将净注入功率的变化映射为线路潮流的增量变化。\n- 线路开断分布因子（LODF）将故障线路上故障前的潮流映射为所有其他线路上潮流的增量变化。\n\n任务。对于给定列表中的每个预想事故：\n1. 从给定的基准情况潮流向量出发，使用PTDF计算注入功率变化，使用LODF计算线路开断，从而计算事故后的线路潮流。\n2. 定义一个标量严重性评分，用于量化所有未断开线路上超出热稳定极限的总量。严重性的计算方法是：对每条线路，取事故后潮流的绝对值，减去热稳定极限，将负值截断为零，按极限值进行归一化，求平方，然后对所有未断开线路求和。该评分为无量纲值。\n3. 按严重性降序对预想事故进行排序。若严重性相同（平局），则按预想事故索引升序打破平局。\n4. 返回每个测试用例中前 $k$ 个预想事故的索引。\n\n使用科学上切合实际的假设。特别是：\n- 基准情况下的线路潮流和极限单位为兆瓦（MW）。在适用的情况下，中间和最终功率以兆瓦（MW）表示。\n- 角度不会显式出现，因为DC-PF模型在注入功率方面是线性的，我们直接使用PTDF和LODF数据。\n\n您的程序应接受硬编码在程序内部的内置测试套件，并为每个测试用例生成结果。不需要用户输入。\n\n事故后计算：\n- 对于由净注入功率变化向量 $p_{\\Delta}$（其维度等于母线数量，且满足 $\\sum p_{\\Delta} = 0$）表征的注入功率预想事故，计算线路潮流的增量变化，即PTDF与 $p_{\\Delta}$ 的矩阵-向量乘积，并将其加到基准情况的线路潮流向量上。\n- 对于线路索引为 $\\ell$ 的线路开断预想事故，计算每条未断开线路 $x$ 上的增量变化，其值为 $\\text{LODF}_{x,\\ell}$ 乘以线路 $\\ell$ 上的基准潮流，将已断开线路的事故后潮流设置为 $0$，且在严重性求和中不包括已断开线路。LODF矩阵的对角线元素可能为 $-1$，不应用于计算严重性。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个项目对应一个测试用例，其本身是前 $k$ 个预想事故的索引（整数）列表，按上述严重性降序和决胜局规则排序。例如，一个有效的输出将如下所示：$$[ [\\dots], [\\dots], [\\dots] ]。$$\n\n测试套件。使用以下四个测试用例来验证您的实现。对于所有情况，在与极限值比较时，请使用线路潮流的绝对值。\n\n- 测试用例 $1$（一般情况）：\n  - 基准情况线路潮流 (MW)：$$f_{0} = \\begin{bmatrix} 80 \\\\ 50 \\\\ 90 \\\\ 30 \\\\ 60 \\end{bmatrix}.$$\n  - 热稳定极限 (MW)：$$F_{\\max} = \\begin{bmatrix} 100 \\\\ 100 \\\\ 90 \\\\ 70 \\\\ 80 \\end{bmatrix}.$$\n  - PTDF 矩阵（线路 $\\times$ 母线）：$$\\text{PTDF} = \\begin{bmatrix}\n  0.3  -0.1  0.2  -0.4 \\\\\n  -0.2  0.3  -0.1  0.0 \\\\\n  0.1  0.2  -0.2  -0.1 \\\\\n  -0.1  0.0  0.3  -0.2 \\\\\n  0.0  -0.2  0.1  0.3\n  \\end{bmatrix}.$$\n  - LODF 矩阵（线路 $\\times$ 线路）：$$\\text{LODF} = \\begin{bmatrix}\n  -1.0  0.2  -0.1  0.0  0.3 \\\\\n  0.1  -1.0  0.25  -0.05  0.0 \\\\\n  -0.15  0.2  -1.0  0.1  -0.05 \\\\\n  0.0  -0.1  0.2  -1.0  0.15 \\\\\n  0.2  0.0  -0.1  0.3  -1.0\n  \\end{bmatrix}.$$\n  - 预想事故列表：\n    - 索引 $0$：线路 $\\ell = 2$ 发生线路开断。\n    - 索引 $1$：注入功率变化 $$p_{\\Delta} = \\begin{bmatrix} 20 \\\\ -10 \\\\ -5 \\\\ -5 \\end{bmatrix} \\text{ MW}.$$\n    - 索引 $2$：线路 $\\ell = 0$ 发生线路开断。\n  - 前 $k$ 个：$$k = 2.$$\n\n- 测试用例 $2$（边界与平局行为）：\n  - 基准情况线路潮流 (MW)：$$f_{0} = \\begin{bmatrix} 100 \\\\ 100 \\\\ 90 \\\\ 70 \\\\ 80 \\end{bmatrix}.$$\n  - 热稳定极限 (MW)：$$F_{\\max} = \\begin{bmatrix} 100 \\\\ 100 \\\\ 90 \\\\ 70 \\\\ 80 \\end{bmatrix}.$$\n  - PTDF 矩阵：使用与测试用例 $1$ 中相同的 $$\\text{PTDF}$$。\n  - LODF 矩阵：使用与测试用例 $1$ 中相同的 $$\\text{LODF}$$。\n  - 预想事故列表：\n    - 索引 $0$：线路 $\\ell = 4$ 发生线路开断。\n    - 索引 $1$：注入功率变化 $$p_{\\Delta} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} \\text{ MW}.$$\n    - 索引 $2$：线路 $\\ell = 2$ 发生线路开断。\n  - 前 $k$ 个：$$k = 1.$$\n\n- 测试用例 $3$（具有强潮流再分配的边缘情况）：\n  - 基准情况线路潮流 (MW)：$$f_{0} = \\begin{bmatrix} 95 \\\\ 85 \\\\ 90 \\\\ 60 \\\\ 70 \\end{bmatrix}.$$\n  - 热稳定极限 (MW)：$$F_{\\max} = \\begin{bmatrix} 100 \\\\ 90 \\\\ 95 \\\\ 65 \\\\ 75 \\end{bmatrix}.$$\n  - PTDF 矩阵：使用与测试用例 $1$ 中相同的 $$\\text{PTDF}$$。\n  - LODF 矩阵修改为包含从索引为 $1$ 的线路开断到线路 $0$ 的大潮流转移：$$\\text{LODF} = \\begin{bmatrix}\n  -1.0  0.9  -0.1  0.0  0.3 \\\\\n  0.1  -1.0  0.25  -0.05  0.0 \\\\\n  -0.15  0.2  -1.0  0.1  -0.05 \\\\\n  0.0  -0.1  0.2  -1.0  0.15 \\\\\n  0.2  0.0  -0.1  0.3  -1.0\n  \\end{bmatrix}.$$\n  - 预想事故列表：\n    - 索引 $0$：线路 $\\ell = 1$ 发生线路开断。\n    - 索引 $1$：注入功率变化 $$p_{\\Delta} = \\begin{bmatrix} 30 \\\\ -10 \\\\ -10 \\\\ -10 \\end{bmatrix} \\text{ MW}.$$\n  - 前 $k$ 个：$$k = 2.$$\n\n- 测试用例 $4$（预期无过载）：\n  - 基准情况线路潮流 (MW)：$$f_{0} = \\begin{bmatrix} 20 \\\\ 10 \\\\ 15 \\\\ 5 \\\\ 12 \\end{bmatrix}.$$\n  - 热稳定极限 (MW)：$$F_{\\max} = \\begin{bmatrix} 100 \\\\ 100 \\\\ 100 \\\\ 100 \\\\ 100 \\end{bmatrix}.$$\n  - PTDF 矩阵：使用与测试用例 $1$ 中相同的 $$\\text{PTDF}$$。\n  - LODF 矩阵具有可忽略的非对角线再分配：$$\\text{LODF} = \\begin{bmatrix}\n  -1.0  0.0  0.0  0.0  0.0 \\\\\n  0.0  -1.0  0.0  0.0  0.0 \\\\\n  0.0  0.0  -1.0  0.0  0.0 \\\\\n  0.0  0.0  0.0  -1.0  0.0 \\\\\n  0.0  0.0  0.0  0.0  -1.0\n  \\end{bmatrix}.$$\n  - 预想事故列表：\n    - 索引 $0$：线路 $\\ell = 0$ 发生线路开断。\n    - 索引 $1$：注入功率变化 $$p_{\\Delta} = \\begin{bmatrix} 10 \\\\ -10 \\\\ 0 \\\\ 0 \\end{bmatrix} \\text{ MW}.$$\n  - 前 $k$ 个：$$k = 2.$$\n\n程序要求：\n- 根据上述规则，为每个测试用例中的每个预想事故计算严重性评分。\n- 为每个测试用例生成前 $k$ 个预想事故的索引列表。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个项目是针对一个测试用例的索引列表，按严重性降序排列，并按索引升序打破平局。",
            "solution": "问题陈述经过严格审查，被确定为有效。它在科学上基于线性化电力系统分析的原理，问题定义清晰，包含完整且一致的数据和指令，并且表述客观。\n\n### 步骤 1：提取给定信息\n\n该问题为一系列涉及电力系统模型应急分析的测试用例提供了以下数据和定义：\n\n- **模型**：假设采用直流潮流（DC-PF）模型。\n- **基准量**：\n  - $f_0$：基准情况下的线路潮流向量，单位为兆瓦（MW）。\n  - $F_{\\max}$：每条线路的热极限向量，单位为兆瓦（MW）。\n- **分布因子矩阵**：\n  - $\\text{PTDF}$：功率转移分布因子矩阵，用于将节点注入功率的变化映射为线路潮流的变化。其维度为（线路数量 $\\times$ 母线数量）。\n  - $\\text{LODF}$：线路断电分布因子矩阵，用于将单条故障线路的断电前潮流映射为所有其他线路上潮流的变化。其维度为（线路数量 $\\times$ 线路数量）。\n- **事故**：一个事件列表，每个事件由一个索引标识。事故可以是以下两种类型之一：\n  1. 线路断电，由断电线路的索引 $\\ell$ 指定。\n  2. 注入功率变化，由一个节点净注入功率变化向量 $p_{\\Delta}$ 指定，该向量满足功率平衡约束 $\\sum p_{\\Delta} = 0$。\n- **排序参数**：一个值 $k$，指定要报告的排名最前的事故数量。\n\n- **事故后潮流计算**：\n  - 对于注入功率变化向量为 $p_{\\Delta}$ 的注入功率事故：\n    $$f_{\\text{post}} = f_0 + \\text{PTDF} \\cdot p_{\\Delta}$$\n  - 对于线路 $\\ell$ 的断电事故：\n    任何线路 $x$ 上的增量潮流变化由 $\\Delta f_x = \\text{LODF}_{x,\\ell} \\cdot f_{0,\\ell}$ 给出。因此，事故后潮流向量 $f_{\\text{post}}$ 计算为 $f_{\\text{post}} = f_0 + \\Delta f$，并特别修改断电线路本身的潮流为零，即 $f_{\\text{post}, \\ell} = 0$。\n\n- **严重性评分计算**：\n  给定事故的标量严重性评分 $S$ 定义为平方归一化过载的总和：\n  $$S = \\sum_{\\text{被监测线路 } x} \\left( \\frac{\\max(0, |f_{\\text{post},x}| - F_{\\max,x})}{F_{\\max,x}} \\right)^2$$\n  对于注入功率变化事故，求和遍及所有线路；对于线路断电事故，求和遍及所有未断开的线路。\n\n- **排序与平局处理**：\n  事故按其严重性评分 $S$ 的降序进行排序。严重性相同时，按事故索引的升序打破平局。\n\n- **测试套件**：提供了四个具体的测试用例，每个用例都有自己的一组 $f_0$、$F_{\\max}$、$\\text{PTDF}$、$\\text{LODF}$、事故列表和 $k$。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n该问题根据所需标准进行了评估：\n1.  **科学基础**：该方法基于直流潮流近似、PTDF 和 LODF，这些是电力系统运行和规划中用于事故筛选的标准和基本工具。在该既定框架内，其表述在物理和数学上都是合理的。节点注入功率变化之和为零的条件（$\\sum p_{\\Delta} = 0$）在物理上是正确的，并且所有测试用例都满足该条件。\n2.  **问题适定性**：问题是适定的。为每个测试用例提供了所有必要的数据（矩阵、向量、参数）。事故后潮流的计算和严重性评分的公式都明确无误地说明了。排序和平局处理规则是精确的，确保了每个测试用例都有唯一的解。\n3.  **客观性**：问题以精确、定量和无偏见的技术语言陈述。它不含主观断言。\n4.  **完整性与一致性**：所有矩阵和向量的维度都是相互一致的。例如，乘积 $\\text{PTDF} \\cdot p_{\\Delta}$ 正确地产生了一个线路潮流变化向量。没有缺失的定义或矛盾的约束。\n5.  **可行性**：提供的数值对于简化的电力系统模型是合理的。该问题没有设定任何物理上不可能的条件。\n\n### 步骤 3：结论与行动\n该问题是有效的。将制定一个合理的解决方案。\n\n### 求解方法\n求解过程是为每个测试用例实现指定的事故分析协议。对于给定的测试用例，我们遍历其定义的事故列表。对于每个事故，我们执行以下计算序列：\n1.  **识别事故类型**：确定事故是线路断电还是节点注入功率变化。\n2.  **计算事故后潮流 ($f_{\\text{post}}$)**：\n    - 如果事故是注入功率变化 $p_{\\Delta}$，则线路潮流的变化计算为 $\\Delta f = \\text{PTDF} \\cdot p_{\\Delta}$。然后事故后潮流向量为 $f_{\\text{post}} = f_0 + \\Delta f$。\n    - 如果事故是线路 $\\ell$ 的断电，则使用该线路的事故前潮流 $f_{0,\\ell}$ 来计算重新分布的潮流。线路 $x$ 上的潮流变化为 $\\Delta f_x = \\text{LODF}_{x,\\ell} \\cdot f_{0,\\ell}$。这对所有线路 $x$ 进行计算。事故后潮流向量为 $f_{\\text{post}} = f_0 + \\Delta f$。关键的是，然后将断电线路本身的潮流设置为零：$f_{\\text{post},\\ell} = 0$。如果 $\\text{LODF}_{\\ell,\\ell} = -1$（这是一个标准约定），则此步骤会自然完成。\n3.  **计算严重性评分 ($S$)**：\n    - 对于被监测集合中的每条线路 $x$（注入功率变化时为所有线路，线路断电时为未断开的线路），我们首先找到过载量，即绝对事故后潮流超过热极限的量：$\\text{overload}_x = \\max(0, |f_{\\text{post},x}| - F_{\\max,x})$。\n    - 然后将此过载量通过线路的热极限 $F_{\\max,x}$ 进行归一化。\n    - 将归一化后的值平方。\n    - 严重性评分 $S$ 是所有被监测线路上这些平方归一化值的总和。\n    $$S = \\sum_{x} \\left( \\frac{\\text{overload}_x}{F_{\\max,x}} \\right)^2$$\n4.  **存储和排序结果**：\n    - 将计算出的严重性评分 $S$ 及其对应的事故索引存储为一个序对 $(S, \\text{index})$。\n    - 处理完给定测试用例的所有事故后，对序对列表进行排序。主排序键是严重性评分，按降序排列。次排序键是事故索引，按升序排列，以解决平局。\n5.  **提取排名前 k 的事故**：\n    - 从排序后的列表中，提取前 $k$ 个条目的索引。这构成了该测试用例的结果。\n对问题陈述中提供的所有四个测试用例重复此过程。最终输出将每个测试用例的排名前 k 索引列表聚合到一个格式化的字符串中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the contingency analysis problem for a hardcoded test suite.\n    \"\"\"\n    \n    # Define test cases as specified in the problem statement.\n    test_cases = [\n        # Test Case 1 (general case)\n        {\n            \"f0\": np.array([80, 50, 90, 30, 60]),\n            \"Fmax\": np.array([100, 100, 90, 70, 80]),\n            \"PTDF\": np.array([\n                [0.3, -0.1, 0.2, -0.4],\n                [-0.2, 0.3, -0.1, 0.0],\n                [0.1, 0.2, -0.2, -0.1],\n                [-0.1, 0.0, 0.3, -0.2],\n                [0.0, -0.2, 0.1, 0.3]\n            ]),\n            \"LODF\": np.array([\n                [-1.0, 0.2, -0.1, 0.0, 0.3],\n                [0.1, -1.0, 0.25, -0.05, 0.0],\n                [-0.15, 0.2, -1.0, 0.1, -0.05],\n                [0.0, -0.1, 0.2, -1.0, 0.15],\n                [0.2, 0.0, -0.1, 0.3, -1.0]\n            ]),\n            \"contingencies\": [\n                {\"type\": \"line_outage\", \"line_index\": 2},\n                {\"type\": \"injection_change\", \"p_delta\": np.array([20, -10, -5, -5])},\n                {\"type\": \"line_outage\", \"line_index\": 0}\n            ],\n            \"k\": 2\n        },\n        # Test Case 2 (boundary and tie behavior)\n        {\n            \"f0\": np.array([100, 100, 90, 70, 80]),\n            \"Fmax\": np.array([100, 100, 90, 70, 80]),\n            \"PTDF\": np.array([\n                [0.3, -0.1, 0.2, -0.4],\n                [-0.2, 0.3, -0.1, 0.0],\n                [0.1, 0.2, -0.2, -0.1],\n                [-0.1, 0.0, 0.3, -0.2],\n                [0.0, -0.2, 0.1, 0.3]\n            ]),\n            \"LODF\": np.array([\n                [-1.0, 0.2, -0.1, 0.0, 0.3],\n                [0.1, -1.0, 0.25, -0.05, 0.0],\n                [-0.15, 0.2, -1.0, 0.1, -0.05],\n                [0.0, -0.1, 0.2, -1.0, 0.15],\n                [0.2, 0.0, -0.1, 0.3, -1.0]\n            ]),\n            \"contingencies\": [\n                {\"type\": \"line_outage\", \"line_index\": 4},\n                {\"type\": \"injection_change\", \"p_delta\": np.array([0, 0, 0, 0])},\n                {\"type\": \"line_outage\", \"line_index\": 2}\n            ],\n            \"k\": 1\n        },\n        # Test Case 3 (edge case with strong flow redistribution)\n        {\n            \"f0\": np.array([95, 85, 90, 60, 70]),\n            \"Fmax\": np.array([100, 90, 95, 65, 75]),\n            \"PTDF\": np.array([\n                [0.3, -0.1, 0.2, -0.4],\n                [-0.2, 0.3, -0.1, 0.0],\n                [0.1, 0.2, -0.2, -0.1],\n                [-0.1, 0.0, 0.3, -0.2],\n                [0.0, -0.2, 0.1, 0.3]\n            ]),\n            \"LODF\": np.array([ # Modified LODF\n                [-1.0, 0.9, -0.1, 0.0, 0.3],\n                [0.1, -1.0, 0.25, -0.05, 0.0],\n                [-0.15, 0.2, -1.0, 0.1, -0.05],\n                [0.0, -0.1, 0.2, -1.0, 0.15],\n                [0.2, 0.0, -0.1, 0.3, -1.0]\n            ]),\n            \"contingencies\": [\n                {\"type\": \"line_outage\", \"line_index\": 1},\n                {\"type\": \"injection_change\", \"p_delta\": np.array([30, -10, -10, -10])}\n            ],\n            \"k\": 2\n        },\n        # Test Case 4 (no overloads expected)\n        {\n            \"f0\": np.array([20, 10, 15, 5, 12]),\n            \"Fmax\": np.array([100, 100, 100, 100, 100]),\n            \"PTDF\": np.array([\n                [0.3, -0.1, 0.2, -0.4],\n                [-0.2, 0.3, -0.1, 0.0],\n                [0.1, 0.2, -0.2, -0.1],\n                [-0.1, 0.0, 0.3, -0.2],\n                [0.0, -0.2, 0.1, 0.3]\n            ]),\n            \"LODF\": np.array([ # Negligible off-diagonal LODF\n                [-1.0, 0.0, 0.0, 0.0, 0.0],\n                [0.0, -1.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, -1.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, -1.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, -1.0]\n            ]),\n            \"contingencies\": [\n                {\"type\": \"line_outage\", \"line_index\": 0},\n                {\"type\": \"injection_change\", \"p_delta\": np.array([10, -10, 0, 0])}\n            ],\n            \"k\": 2\n        }\n    ]\n\n    final_results = []\n    \n    for case_data in test_cases:\n        f0 = case_data[\"f0\"]\n        Fmax = case_data[\"Fmax\"]\n        PTDF = case_data[\"PTDF\"]\n        LODF = case_data[\"LODF\"]\n        contingencies = case_data[\"contingencies\"]\n        k = case_data[\"k\"]\n        \n        num_lines = len(f0)\n        contingency_scores = []\n        \n        for i, contingency in enumerate(contingencies):\n            f_post = np.zeros(num_lines)\n            monitored_mask = np.ones(num_lines, dtype=bool)\n\n            if contingency[\"type\"] == \"injection_change\":\n                p_delta = contingency[\"p_delta\"]\n                delta_f = PTDF @ p_delta\n                f_post = f0 + delta_f\n                # Monitored mask remains all True\n            \n            elif contingency[\"type\"] == \"line_outage\":\n                line_l = contingency[\"line_index\"]\n                f0_l = f0[line_l]\n                lodf_col = LODF[:, line_l]\n                delta_f = lodf_col * f0_l\n                f_post = f0 + delta_f\n                f_post[line_l] = 0.0\n                monitored_mask[line_l] = False\n\n            # Calculate severity score\n            # Use np.abs() for flow magnitude\n            overload = np.maximum(0, np.abs(f_post[monitored_mask]) - Fmax[monitored_mask])\n            \n            # To avoid division by zero if a limit is zero, although unlikely in a valid problem.\n            # Using a small epsilon or where clause is robust. Here, we assume Fmax > 0.\n            normalized_overload_sq = (overload / Fmax[monitored_mask]) ** 2\n            severity = np.sum(normalized_overload_sq)\n            \n            contingency_scores.append((severity, i))\n            \n        # Sort contingencies: descending by severity, then ascending by index for ties\n        contingency_scores.sort(key=lambda x: (-x[0], x[1]))\n        \n        # Get top-k contingency indices\n        top_k_indices = [index for severity, index in contingency_scores[:k]]\n        final_results.append(top_k_indices)\n\n    # Final print statement in the exact required format.\n    # str() on a list produces a string with spaces, e.g., '[1, 0]'.\n    # This matches the presentation style of the problem description.\n    # We will build the string manually to avoid spaces.\n    final_output_str = f\"[[{','.join(map(str, final_results[0]))}],[{','.join(map(str, final_results[1]))}],[{','.join(map(str, final_results[2]))}],[{','.join(map(str, final_results[3]))}]]\"\n    print(final_output_str.replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}