{
    "hands_on_practices": [
        {
            "introduction": "The foundation of Model Predictive Control is the 'Model' itselfâ€”a mathematical representation of the system we wish to control. This first practice grounds the abstract concepts of state-space modeling in a tangible application: the thermal dynamics of a building. By starting from the first principle of energy conservation, you will derive both continuous-time and discrete-time models, learning how to translate physical parameters like thermal capacitance and resistance into the matrices that form a controller's 'digital twin' .",
            "id": "4105298",
            "problem": "A single-zone building is to be controlled using Model Predictive Control (MPC). Assume the zone air is well-mixed and can be modeled as a lumped thermal capacitance. Starting from conservation of energy, derive a continuous-time single-state model in which the state is the zone temperature, the control input is the Heating, Ventilation, and Air Conditioning (HVAC) power delivered to the zone, and the disturbances include ambient temperature and solar gains (you may include internal gains symbolically if needed). Then, under a zero-order hold assumption on the input and disturbances, derive a discrete-time state-space model suitable for MPC. Explicitly identify how the state, input, and disturbance vectors map to the physical quantities.\n\nAssume the following physical parameters are constant:\n- Zone thermal capacitance: $C_{z}$ $\\left[\\mathrm{J/K}\\right]$.\n- Envelope thermal resistance to ambient (effective for conduction and infiltration): $R_{za}$ $\\left[\\mathrm{K/W}\\right]$.\n- Effective solar gain coefficient (absorbing area and transmittance): $g_{s}$ $\\left[\\mathrm{m^{2}}\\right]$.\n- HVAC input-efficiency mapping factor from commanded power to thermal heat rate delivered to the air: $\\eta$ (dimensionless).\n- Ambient temperature: $T_{a}(t)$ $\\left[\\mathrm{K}\\right]$.\n- Global horizontal irradiance: $I_{s}(t)$ $\\left[\\mathrm{W/m^{2}}\\right]$.\n- Internal heat gains (optional): $q_{\\mathrm{int}}(t)$ $\\left[\\mathrm{W}\\right]$.\n\nLet the state be $x(t) = T_{z}(t)$, the control input be $u(t)$, and the disturbance vector be $d(t)$ constructed from $T_{a}(t)$, $I_{s}(t)$, and (optionally) $q_{\\mathrm{int}}(t)$. Derive from first principles an affine continuous-time state equation of the form $\\dot{x}(t) = a_{c} x(t) + b_{c} u(t) + e_{c} d(t)$, identifying the coefficients $a_{c}$, $b_{c}$, and the components of $e_{c}$ in terms of $C_{z}$, $R_{za}$, $g_{s}$, and $\\eta$.\n\nNext, for a given uniform sampling interval $h$ $\\left[\\mathrm{s}\\right]$ and assuming zero-order hold on $u(t)$ and $d(t)$ over each sampling period, derive the corresponding discrete-time state-space model\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k} + E_{d} d_{k},\n$$\nclearly expressing $A_{d}$, $B_{d}$, and $E_{d}$ in terms of $a_{c}$, $b_{c}$, $e_{c}$, and $h$.\n\nFinally, evaluate the scalar state-transition coefficient $A_{d}$ numerically for the specific parameter values $C_{z} = 1.2 \\times 10^{6}$, $R_{za} = 0.04$, and $h = 900$. Round your answer to four significant figures. Express the final value as a dimensionless number.",
            "solution": "The problem requires the derivation of continuous-time and discrete-time state-space models for a single-zone building's thermal dynamics, followed by a numerical evaluation of a model coefficient. The derivation proceeds from the first principle of conservation of energy.\n\n### Part 1: Continuous-Time State-Space Model\n\nThe fundamental principle governing the thermal dynamics of the building zone is the conservation of energy. For a lumped capacitance model, this principle can be expressed as an energy balance equation, where the rate of change of internal energy stored in the zone's thermal mass is equal to the net sum of all heat flows into the zone.\n\nLet $T_z(t)$ be the temperature of the zone air, which is the state of our system. The internal energy of the zone's thermal mass is $C_z T_z(t)$, where $C_z$ is the thermal capacitance. The rate of change of this energy is $C_z \\frac{d T_z(t)}{dt}$.\n\nThe heat flows are as follows:\n1.  **HVAC Heat Input:** The control input $u(t)$ is the commanded power, and $\\eta$ is the efficiency factor. The thermal heat rate delivered to the zone is $q_{\\mathrm{HVAC}}(t) = \\eta u(t)$. This is a heat gain.\n2.  **Solar Heat Gain:** The solar heat gain through the building envelope is proportional to the global horizontal irradiance $I_s(t)$. The effective solar gain coefficient $g_s$ accounts for window area, orientation, and solar heat gain coefficient. The solar heat gain is $q_{\\mathrm{solar}}(t) = g_s I_s(t)$. This is a heat gain.\n3.  **Envelope Heat Transfer:** Heat is exchanged with the ambient environment at temperature $T_a(t)$ through the building envelope (walls, windows, roof, etc.) and by infiltration. This process is modeled using an effective thermal resistance $R_{za}$. The heat flow is $q_{\\mathrm{env}}(t) = \\frac{T_z(t) - T_a(t)}{R_{za}}$. A positive value indicates heat loss from the zone to the ambient.\n4.  **Internal Heat Gains:** Heat generated by occupants, lighting, and equipment is represented by $q_{\\mathrm{int}}(t)$. This is a heat gain.\n\nThe energy balance equation is therefore:\n$$\nC_z \\frac{d T_z(t)}{dt} = q_{\\mathrm{HVAC}}(t) + q_{\\mathrm{solar}}(t) + q_{\\mathrm{int}}(t) - q_{\\mathrm{env}}(t)\n$$\nSubstituting the expressions for the heat flows:\n$$\nC_z \\frac{d T_z(t)}{dt} = \\eta u(t) + g_s I_s(t) + q_{\\mathrm{int}}(t) - \\frac{T_z(t) - T_a(t)}{R_{za}}\n$$\nTo obtain the state equation in the standard form $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$, we first isolate the derivative term $\\frac{d T_z(t)}{dt}$ by dividing by $C_z$:\n$$\n\\frac{d T_z(t)}{dt} = \\frac{\\eta}{C_z} u(t) + \\frac{g_s}{C_z} I_s(t) + \\frac{1}{C_z} q_{\\mathrm{int}}(t) - \\frac{1}{R_{za} C_z} T_z(t) + \\frac{1}{R_{za} C_z} T_a(t)\n$$\nNow, we group the terms according to the state, input, and disturbances.\nLet the state be $x(t) = T_z(t)$.\nThe control input is $u(t)$.\nThe disturbances are the exogenous variables that affect the system but are not controlled. We group them into a disturbance vector $d(t)$:\n$$\nd(t) = \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\nRearranging the equation:\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\left( \\frac{1}{R_{za} C_z} \\right) T_a(t) + \\left( \\frac{g_s}{C_z} \\right) I_s(t) + \\left( \\frac{1}{C_z} \\right) q_{\\mathrm{int}}(t)\n$$\nThis can be written in matrix form:\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\begin{pmatrix} \\frac{1}{R_{za} C_z} & \\frac{g_s}{C_z} & \\frac{1}{C_z} \\end{pmatrix} \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\nBy comparing this to the target form $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$, we can identify the coefficients:\n- $a_c = -\\frac{1}{R_{za} C_z}$\n- $b_c = \\frac{\\eta}{C_z}$\n- $e_c = \\begin{pmatrix} \\frac{1}{R_{za} C_z} & \\frac{g_s}{C_z} & \\frac{1}{C_z} \\end{pmatrix}$\n\n### Part 2: Discrete-Time State-Space Model\n\nTo derive the discrete-time model, we must solve the continuous-time linear differential equation over one sampling interval, from time $t_k = k h$ to $t_{k+1} = (k+1)h$. The solution to the affine state equation is given by the variation of constants formula:\n$$\nx(t) = \\exp(a_c (t - t_k)) x(t_k) + \\int_{t_k}^{t} \\exp(a_c (t - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\nSetting $t = t_{k+1} = (k+1)h$ and using the notation $x_k = x(kh)$:\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\nThe problem states to assume a zero-order hold (ZOH) on the input $u(t)$ and disturbances $d(t)$. This means they are constant over each sampling interval:\n- $u(\\tau) = u_k$ for $\\tau \\in [kh, (k+1)h)$\n- $d(\\tau) = d_k$ for $\\tau \\in [kh, (k+1)h)$\n\nUnder the ZOH assumption, $u_k$ and $d_k$ can be moved outside the integral:\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) b_c u_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) e_c d_k\n$$\nLet's evaluate the integral. We use the substitution $s = (k+1)h - \\tau$, which implies $ds = -d\\tau$. The limits of integration become $\\tau = kh \\implies s = h$ and $\\tau = (k+1)h \\implies s = 0$.\n$$\n\\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau = \\int_{h}^{0} \\exp(a_c s) (-ds) = \\int_{0}^{h} \\exp(a_c s) ds\n$$\nSince $a_c$ is a non-zero scalar, the integral is:\n$$\n\\int_{0}^{h} \\exp(a_c s) ds = \\left[ \\frac{1}{a_c} \\exp(a_c s) \\right]_{0}^{h} = \\frac{1}{a_c} (\\exp(a_c h) - \\exp(0)) = \\frac{\\exp(a_c h) - 1}{a_c}\n$$\nSubstituting this result back into the equation for $x_{k+1}$:\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c u_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c d_k\n$$\nThis is the discrete-time state-space model $x_{k+1} = A_d x_k + B_d u_k + E_d d_k$, where:\n- State vector: $x_k = T_z(kh)$\n- Input vector: $u_k = u(kh)$\n- Disturbance vector: $d_k = \\begin{pmatrix} T_a(kh) \\\\ I_s(kh) \\\\ q_{\\mathrm{int}}(kh) \\end{pmatrix}$\n- State transition matrix: $A_d = \\exp(a_c h)$\n- Input matrix: $B_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c$\n- Disturbance matrix: $E_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c$\n\n### Part 3: Numerical Evaluation of $A_d$\n\nThe problem provides the following numerical values:\n- $C_z = 1.2 \\times 10^6 \\, \\mathrm{J/K}$\n- $R_{za} = 0.04 \\, \\mathrm{K/W}$\n- $h = 900 \\, \\mathrm{s}$\n\nFirst, we calculate the continuous-time coefficient $a_c$:\n$$\na_c = -\\frac{1}{R_{za} C_z} = -\\frac{1}{(0.04 \\, \\mathrm{K/W}) \\times (1.2 \\times 10^6 \\, \\mathrm{J/K})} = -\\frac{1}{48000 \\, \\mathrm{J/W}}\n$$\nSince $1 \\, \\mathrm{W} = 1 \\, \\mathrm{J/s}$, the unit becomes $\\mathrm{s}^{-1}$.\n$$\na_c = -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\approx -2.0833 \\times 10^{-5} \\, \\mathrm{s}^{-1}\n$$\nNext, we calculate the discrete-time state-transition coefficient $A_d = \\exp(a_c h)$:\nThe exponent is the dimensionless product $a_c h$:\n$$\na_c h = \\left( -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\right) \\times (900 \\, \\mathrm{s}) = -\\frac{900}{48000} = -\\frac{9}{480} = -\\frac{3}{160} = -0.01875\n$$\nNow, we compute the exponential:\n$$\nA_d = \\exp(-0.01875) \\approx 0.98142605\n$$\nRounding the result to four significant figures as required:\n$$\nA_d \\approx 0.9814\n$$\nThis value is dimensionless, as expected for a state-transition matrix element.",
            "answer": "$$\n\\boxed{0.9814}\n$$"
        },
        {
            "introduction": "Effective control is rarely about optimizing a single metric; it's about navigating trade-offs between competing objectives. This exercise delves into the heart of MPC's optimization problem: the cost function. You will explore how to balance the dual goals of maintaining thermal comfort and minimizing energy expenditure in a building by formulating a scalarized multi-objective function, providing a hands-on look at how tuning weights can trace the Pareto front of optimal solutions .",
            "id": "4105335",
            "problem": "Consider a single-zone building with discrete-time linear thermal dynamics used in Model Predictive Control (MPC). The predicted indoor temperature at the next time step is modeled by the affine system $x_{k+1} = a x_{k} + b u_{k}$, where $x_{k}$ is the current indoor temperature, $u_{k}$ is the heating power input, and $a$ and $b$ are known constants. For a one-step MPC (no constraints) with scalarized multi-objective stage cost, the building operator balances thermal comfort against energy cost using the weighted sum\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k}),\n$$\nwhere $0 \\leq \\alpha \\leq 1$ is the comfort weight, $r$ is the comfort setpoint, $\\|z\\|_{Q}^{2} = z^{\\top} Q z$ is a weighted Euclidean norm, and $c(u_{k})$ is the energy cost surrogate. Assume a scalar zone so that $x_{k}$, $x_{k+1}$, $r$, and $u_{k}$ are scalars, and let $Q = 1$. The energy cost surrogate is defined as the strictly convex function $c(u_{k}) = u_{k}^{2} + \\lambda u_{k}$ with constant price-slope $\\lambda$. This scalarization method is a classical way to trace Pareto trade-offs between thermal comfort deviation and energy cost; tuning $\\alpha$ moves the operating point along the Pareto front.\n\nGiven the parameter values $a = 0.9$, $b = 0.5$, $x_{k} = 20$, $r = 22$, and $\\lambda = 4$, and using the unconstrained one-step MPC that minimizes $\\ell(x_{k+1}, u_{k})$ over $u_{k} \\in \\mathbb{R}$, proceed as follows:\n- Using first principles of convex optimization for quadratic objectives and the given dynamics, derive the optimal control input $u^{\\star}(\\alpha)$ as a function of $\\alpha$.\n- Employ a Pareto trade-off criterion to tune $\\alpha$: determine the unique weight $\\alpha \\in (0, 1)$ for which the two weighted objective components are equal at the optimizer, that is,\n$$\n\\alpha \\|x_{k+1} - r\\|_{Q}^{2} \\;=\\; (1 - \\alpha) c(u_{k})\n\\quad \\text{evaluated at} \\quad u_{k} = u^{\\star}(\\alpha).\n$$\n\nProvide the exact analytical value of the resulting $\\alpha$. No rounding is required. The final answer must be a single real-valued number without units.",
            "solution": "The problem asks for a specific value of the weighting parameter $\\alpha$ in a one-step Model Predictive Control (MPC) framework for a single-zone building. The value of $\\alpha$ must be such that the two weighted components of the objective function are equal at the optimal control input.\n\nFirst, we establish the objective function to be minimized. The stage cost is given by:\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k})\n$$\nThe problem specifies that the variables $x_{k+1}$, $u_k$, and $r$ are scalars, and the weighting matrix $Q=1$. The cost function $c(u_k)$ is defined as $c(u_k) = u_{k}^{2} + \\lambda u_{k}$. The system dynamics are given by the linear model $x_{k+1} = a x_{k} + b u_{k}$.\nSubstituting these definitions, the objective function, which we denote as $J(u_k)$, becomes:\n$$\nJ(u_k) = \\alpha (x_{k+1} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\nSubstituting the system dynamics into $J(u_k)$:\n$$\nJ(u_k) = \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\nThis objective function is a quadratic function of the control input $u_k$. For $\\alpha \\in [0, 1]$, the coefficient of the $u_k^2$ term is $\\alpha b^2 + (1-\\alpha) = 1 - \\alpha(1-b^2)$. Given $b=0.5$, this is $1-0.75\\alpha$, which is strictly positive for $\\alpha \\in [0,1]$. Thus, $J(u_k)$ is a strictly convex function of $u_k$, and its unique minimum can be found by setting its first derivative with respect to $u_k$ equal to zero.\n\nThe derivative of $J(u_k)$ with respect to $u_k$ is:\n$$\n\\frac{dJ}{du_k} = \\frac{d}{du_k} \\left[ \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k}) \\right]\n$$\n$$\n\\frac{dJ}{du_k} = 2 \\alpha (a x_{k} + b u_{k} - r) \\cdot b + (1 - \\alpha)(2u_k + \\lambda)\n$$\nSetting the derivative to zero to find the optimal control input, denoted $u^{\\star}(\\alpha)$:\n$$\n2 \\alpha b (a x_{k} + b u^{\\star}(\\alpha) - r) + (1 - \\alpha)(2u^{\\star}(\\alpha) + \\lambda) = 0\n$$\nWe can solve for $u^{\\star}(\\alpha)$:\n$$\n2 \\alpha a b x_{k} + 2 \\alpha b^2 u^{\\star}(\\alpha) - 2 \\alpha b r + 2(1-\\alpha)u^{\\star}(\\alpha) + \\lambda(1-\\alpha) = 0\n$$\n$$\nu^{\\star}(\\alpha) (2 \\alpha b^2 + 2(1-\\alpha)) = 2 \\alpha b r - 2 \\alpha a b x_{k} - \\lambda(1-\\alpha)\n$$\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha b (r - a x_{k}) - \\lambda(1-\\alpha)}{2(\\alpha b^2 + 1 - \\alpha)}\n$$\nNow, we substitute the given parameter values: $a=0.9$, $b=0.5$, $x_{k}=20$, $r=22$, and $\\lambda=4$.\nThe term $r - a x_{k}$ becomes $22 - 0.9 \\times 20 = 22 - 18 = 4$.\nThe term $b^2$ is $0.5^2 = 0.25$.\nSubstituting these into the expression for $u^{\\star}(\\alpha)$:\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha (0.5) (4) - 4(1-\\alpha)}{2(\\alpha (0.25) + 1 - \\alpha)} = \\frac{4\\alpha - 4 + 4\\alpha}{2(1 - 0.75\\alpha)} = \\frac{8\\alpha - 4}{2 - 1.5\\alpha}\n$$\nThe second part of the problem requires finding the value of $\\alpha \\in (0, 1)$ for which the two weighted objective components are equal when evaluated at $u_k = u^{\\star}(\\alpha)$. This condition is:\n$$\n\\alpha (x_{k+1} - r)^{2} = (1 - \\alpha) c(u_k)\n$$\n$$\n\\alpha (a x_k + b u_k - r)^2 = (1 - \\alpha)(u_k^2 + \\lambda u_k)\n$$\nTo simplify solving for $\\alpha$, we can use the first-order optimality condition derived earlier:\n$$\n2 \\alpha b (a x_k + b u_k - r) = -(1 - \\alpha)(2u_k + \\lambda)\n$$\nwhere $u_k = u^{\\star}(\\alpha)$. Let's solve for the term $(a x_k + b u_k - r)$:\n$$\n(a x_k + b u_k - r) = -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b}\n$$\nSubstitute this into the left-hand side of the trade-off condition:\n$$\n\\alpha \\left( -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b} \\right)^2 = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\n$$\n\\alpha \\frac{(1-\\alpha)^2 (2u_k+\\lambda)^2}{4\\alpha^2 b^2} = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\nSince we are looking for $\\alpha \\in (0,1)$, we know $\\alpha \\neq 0$ and $1-\\alpha \\neq 0$. We can divide both sides by $(1-\\alpha)$:\n$$\n\\frac{(1-\\alpha)(2u_k+\\lambda)^2}{4\\alpha b^2} = u_k^2 + \\lambda u_k\n$$\nSubstituting the numerical values $b=0.5$ and $\\lambda=4$:\n$$\n\\frac{(1-\\alpha)(2u_k+4)^2}{4\\alpha (0.5)^2} = u_k^2 + 4u_k\n$$\n$$\n\\frac{(1-\\alpha) \\cdot 4(u_k+2)^2}{\\alpha} = u_k(u_k+4)\n$$\nNow, we substitute the expression for $u^{\\star}(\\alpha)$: $u_k = \\frac{8\\alpha-4}{2-1.5\\alpha}$. Let's compute the terms $(u_k+2)$ and $(u_k+4)$:\n$$\nu_k+2 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 2 = \\frac{8\\alpha-4 + 2(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+4-3\\alpha}{2-1.5\\alpha} = \\frac{5\\alpha}{2-1.5\\alpha}\n$$\n$$\nu_k+4 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 4 = \\frac{8\\alpha-4 + 4(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+8-6\\alpha}{2-1.5\\alpha} = \\frac{2\\alpha+4}{2-1.5\\alpha}\n$$\nSubstituting these back into the equation:\n$$\n\\frac{4(1-\\alpha)}{\\alpha} \\left( \\frac{5\\alpha}{2-1.5\\alpha} \\right)^2 = \\left( \\frac{8\\alpha-4}{2-1.5\\alpha} \\right) \\left( \\frac{2\\alpha+4}{2-1.5\\alpha} \\right)\n$$\n$$\n\\frac{4(1-\\alpha) \\cdot 25\\alpha^2}{\\alpha(2-1.5\\alpha)^2} = \\frac{(8\\alpha-4)(2\\alpha+4)}{(2-1.5\\alpha)^2}\n$$\nThe denominators are equal and non-zero for $\\alpha \\in (0,1)$, so we equate the numerators:\n$$\n100\\alpha(1-\\alpha) = (8\\alpha-4)(2\\alpha+4)\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 32\\alpha - 8\\alpha - 16\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 24\\alpha - 16\n$$\nRearranging the terms gives a quadratic equation in $\\alpha$:\n$$\n(100+16)\\alpha^2 + (24-100)\\alpha - 16 = 0\n$$\n$$\n116\\alpha^2 - 76\\alpha - 16 = 0\n$$\nDividing the entire equation by $4$ simplifies it to:\n$$\n29\\alpha^2 - 19\\alpha - 4 = 0\n$$\nWe solve for $\\alpha$ using the quadratic formula, $\\alpha = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, with $A=29$, $B=-19$, and $C=-4$:\n$$\n\\alpha = \\frac{-(-19) \\pm \\sqrt{(-19)^2 - 4(29)(-4)}}{2(29)} = \\frac{19 \\pm \\sqrt{361 + 464}}{58} = \\frac{19 \\pm \\sqrt{825}}{58}\n$$\nTo simplify the square root, we factor $825$: $825 = 25 \\times 33 = 5^2 \\times 33$. Thus, $\\sqrt{825} = 5\\sqrt{33}$.\nThe two possible solutions for $\\alpha$ are:\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58} \\quad \\text{and} \\quad \\alpha = \\frac{19 - 5\\sqrt{33}}{58}\n$$\nThe problem requires that $\\alpha \\in (0, 1)$. We must check which solution lies in this interval.\nFor the second root, we approximate $\\sqrt{33}$. Since $5^2=25$, we know $\\sqrt{33} > 5$. Therefore, $5\\sqrt{33} > 25$. This makes the numerator $19 - 5\\sqrt{33}$ negative, so this root is less than $0$.\nFor the first root, $19 + 5\\sqrt{33}$ is clearly positive. We must check if it is less than $58$.\n$$\n19 + 5\\sqrt{33}  58 \\implies 5\\sqrt{33}  39 \\implies (5\\sqrt{33})^2  39^2 \\implies 25 \\times 33  1521 \\implies 825  1521\n$$\nThis inequality is true, so the first root is indeed between $0$ and $1$.\nThe unique value of $\\alpha$ that satisfies the condition is:\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58}\n$$",
            "answer": "$$\\boxed{\\frac{19 + 5\\sqrt{33}}{58}}$$"
        },
        {
            "introduction": "Our predictive models are inevitably imperfect, and real-world energy systems are subject to unpredictable disturbances. This practice addresses a critical question: how can we guarantee safe operation and constraint satisfaction in the face of uncertainty? You will learn to implement a robust control strategy known as tube-based MPC, which involves 'tightening' constraints on a nominal system plan to create a protective buffer, ensuring that the actual system remains within its safe operating limits despite disturbances .",
            "id": "4105355",
            "problem": "Consider a grid-connected battery energy storage system operated with tube-based Model Predictive Control (MPC). The actual state $x_k \\in \\mathbb{R}^2$ evolves under additive disturbances as $x_{k+1} = A x_k + B u_k + w_k$, where $u_k \\in \\mathbb{R}$ is the control input and $w_k \\in \\mathbb{R}^2$ is an unknown disturbance bounded in a known compact, convex set $\\mathcal{W}$. The MPC uses a nominal state $z_k$ evolving without disturbance, a nominal input $v_k$, and a linear, pre-stabilizing feedback $K \\in \\mathbb{R}^{1 \\times 2}$ applied to the deviation $e_k = x_k - z_k$, so that $u_k = v_k + K e_k$ and the deviation dynamics satisfy $e_{k+1} = (A + B K)e_k + w_k$. Assume there exists a compact, convex, robust positively invariant (RPI) set $\\mathcal{S}$ for the deviation dynamics, that is, for all $e_k \\in \\mathcal{S}$ and $w_k \\in \\mathcal{W}$, one has $e_{k+1} \\in \\mathcal{S}$.\n\nThe system is subject to polytopic state and input constraints $x_k \\in \\mathcal{X}$ and $u_k \\in \\mathcal{U}$, where $\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : H_x x \\le h_x \\}$ and $\\mathcal{U} = \\{ u \\in \\mathbb{R} : H_u u \\le h_u \\}$. The Pontryagin (Minkowski) set difference of sets $\\mathcal{A}, \\mathcal{B}$ is defined as $\\mathcal{A} \\ominus \\mathcal{B} = \\{ z : z + \\mathcal{B} \\subseteq \\mathcal{A} \\}$. The Minkowski sum is defined as $\\mathcal{A} \\oplus \\mathcal{B} = \\{ a + b : a \\in \\mathcal{A}, b \\in \\mathcal{B} \\}$.\n\nTask 1 (Derivation): Starting only from the preceding definitions and the definition of robust positive invariance, derive tightened constraint sets for the nominal variables,\n$$\nz_k \\in \\mathcal{X} \\ominus \\mathcal{S}, \\quad v_k \\in \\mathcal{U} \\ominus K \\mathcal{S},\n$$\nthat guarantee that the actual state and input satisfy $x_k \\in \\mathcal{X}$ and $u_k \\in \\mathcal{U}$ for all $k$ and for all disturbances $w_k \\in \\mathcal{W}$. Express your derivation for general polytopic $\\mathcal{X}$ and $\\mathcal{U}$ in terms of the support function of $\\mathcal{S}$, and explain the feasibility guarantee in words.\n\nTask 2 (Evaluation on a specific energy system): Consider a battery model where the two states are the state-of-charge deviation and the converter power deviation. The hard constraints are the symmetric boxes\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : |x_1| \\le 0.20,\\ |x_2| \\le 40 \\}, \\quad \\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}.\n$$\nThe controller uses the feedback gain\n$$\nK = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix},\n$$\nand the deviation is bounded in the RPI set\n$$\n\\mathcal{S} = \\{ e \\in \\mathbb{R}^2 : |e_1| \\le 0.02,\\ |e_2| \\le 1.9 \\}.\n$$\nCompute the scalar value of the tightened upper input bound obtained from $\\mathcal{U} \\ominus K \\mathcal{S}$. Express the final bound in $\\mathrm{MW}$. Do not round your answer; provide the exact value as a decimal. The final answer must be a single real number.",
            "solution": "This problem involves two tasks: first, to derive the general form of tightened constraints for tube-based MPC, and second, to apply this theory to calculate a specific numerical bound for a battery system.\n\n### Part 1: Derivation of Tightened Constraints\n\nThe core principle of tube-based MPC is to ensure that the actual system trajectory, which is subject to disturbances, always satisfies the physical constraints. This is achieved by enforcing stricter, \"tightened\" constraints on the nominal (planned) trajectory.\n\n**State Constraint Tightening:**\nThe actual state $x_k$ must be in the constraint set $\\mathcal{X}$. We know $x_k = z_k + e_k$, where $z_k$ is the nominal state and $e_k$ is the deviation. The property of the robust positively invariant (RPI) set $\\mathcal{S}$ ensures that $e_k \\in \\mathcal{S}$ for all time $k$, assuming the initial deviation $e_0 \\in \\mathcal{S}$.\nTherefore, the constraint $x_k \\in \\mathcal{X}$ becomes $z_k + e_k \\in \\mathcal{X}$. This must hold for *every* possible deviation $e_k \\in \\mathcal{S}$. This is equivalent to saying that the set of all possible actual states, $\\{z_k\\} \\oplus \\mathcal{S}$, must be a subset of $\\mathcal{X}$. By the definition of the Pontryagin (Minkowski) set difference, this means the nominal state must satisfy:\n$$z_k \\in \\mathcal{X} \\ominus \\mathcal{S}$$\n\nFor a polytopic set $\\mathcal{X} = \\{ x : H_x x \\le h_x \\}$, let $h_{x,i}^T$ be the $i$-th row of $H_x$. The condition requires $h_{x,i}^T (z_k + e_k) \\le h_{x,i}$ for all $e_k \\in \\mathcal{S}$. To guarantee this, we must protect against the worst-case deviation:\n$$h_{x,i}^T z_k + \\max_{e \\in \\mathcal{S}}(h_{x,i}^T e) \\le h_{x,i}$$\nThe maximum term is the support function of $\\mathcal{S}$, denoted $\\sigma_{\\mathcal{S}}(h_{x,i})$. Thus, the tightened constraint for the $i$-th row is $h_{x,i}^T z_k \\le h_{x,i} - \\sigma_{\\mathcal{S}}(h_{x,i})$.\n\n**Input Constraint Tightening:**\nThe same logic applies to the input. The actual input $u_k = v_k + K e_k$ must be in the set $\\mathcal{U}$. This means $v_k + K e_k \\in \\mathcal{U}$ for all $e_k \\in \\mathcal{S}$.\nLet $K\\mathcal{S} = \\{Ke : e \\in \\mathcal{S}\\}$. The condition is $\\{v_k\\} \\oplus K\\mathcal{S} \\subseteq \\mathcal{U}$, which means the nominal input must satisfy:\n$$v_k \\in \\mathcal{U} \\ominus K\\mathcal{S}$$\nFor a polytopic set $\\mathcal{U} = \\{ u : H_u u \\le h_u \\}$, the $j$-th row constraint becomes $h_{u,j}^T v_k \\le h_{u,j} - \\max_{e \\in \\mathcal{S}}(h_{u,j}^T K e)$. The maximization is the support function of the set $K\\mathcal{S}$: $\\sigma_{K\\mathcal{S}}(h_{u,j}) = \\sigma_{\\mathcal{S}}(K^T h_{u,j})$. The tightened input constraint is $h_{u,j}^T v_k \\le h_{u,j} - \\sigma_{\\mathcal{S}}(K^T h_{u,j})$.\n\nBy confining the nominal plan $(z_k, v_k)$ to these smaller sets, we create a robust buffer, guaranteeing that the true state and input will respect their original constraints despite any disturbance sequence contained within the tube.\n\n### Part 2: Numerical Evaluation of the Tightened Bound\n\nWe need to compute the tightened upper bound for the nominal input $v_k$. The original input constraint is $\\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}$. This corresponds to two linear inequalities: $u \\le 30$ and $-u \\le 30$.\n\nWe focus on the upper bound, $u \\le 30$. This corresponds to the form $h_u u \\le \\bar{u}$ with $h_u=1$ and $\\bar{u}=30$. Using the formula from Part 1, the tightened constraint on the nominal input $v_k$ is:\n$$v_k \\le 30 - \\sigma_{\\mathcal{S}}(K^T h_u) = 30 - \\sigma_{\\mathcal{S}}(K^T)$$\nThe given data are:\n- $K = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix}$, so $K^T = \\begin{bmatrix} -0.5 \\\\ -0.1 \\end{bmatrix}$.\n- $\\mathcal{S} = \\{ e \\in \\mathbb{R}^2 : |e_1| \\le 0.02, |e_2| \\le 1.9 \\}$.\n\nThe support function is defined as:\n$$ \\sigma_{\\mathcal{S}}(K^T) = \\sup_{e \\in \\mathcal{S}} (K^T)^T e = \\sup_{e \\in \\mathcal{S}} (-0.5 e_1 - 0.1 e_2) $$\nThe supremum is over the box defined by $-0.02 \\le e_1 \\le 0.02$ and $-1.9 \\le e_2 \\le 1.9$. To maximize a linear function over a box, we evaluate it at the vertices. Since the coefficients $-0.5$ and $-0.1$ are both negative, the function is maximized when $e_1$ and $e_2$ are at their minimum values:\n- $e_1 = -0.02$\n- $e_2 = -1.9$\n\nSubstituting these values into the expression:\n$$ \\sigma_{\\mathcal{S}}(K^T) = (-0.5)(-0.02) + (-0.1)(-1.9) = 0.01 + 0.19 = 0.2 $$\nThis value is the required \"back-off\" or tightening margin. The tightened upper bound on the nominal input is:\n$$ v_k \\le 30 - 0.2 = 29.8 $$\nThus, the scalar value of the tightened upper input bound is 29.8.",
            "answer": "$$\\boxed{29.8}$$"
        }
    ]
}