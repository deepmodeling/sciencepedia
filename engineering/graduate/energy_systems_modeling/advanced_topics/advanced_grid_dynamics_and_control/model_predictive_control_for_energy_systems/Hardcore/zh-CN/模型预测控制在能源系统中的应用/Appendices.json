{
    "hands_on_practices": [
        {
            "introduction": "在应用任何先进的控制策略之前，我们必须首先用数学语言精确地描述我们想要控制的系统。本练习将指导您完成这一基础而关键的过程：从物理第一性原理出发，为楼宇热力系统建立一个状态空间模型。通过这个实践，您将学习如何将建筑物的热容和热阻等物理特性，以及环境温度和太阳辐射等外部干扰，转化为模型预测控制（MPC）能够理解和使用的标准形式，这是任何控制系统设计的起点。",
            "id": "4105298",
            "problem": "一个单区域建筑将使用模型预测控制（MPC）进行控制。假设区域空气混合均匀，可以建模为集总热容。从能量守恒定律出发，推导一个连续时间单状态模型，其中状态为区域温度，控制输入为输送至该区域的供暖、通风和空调（HVAC）功率，扰动包括环境温度和太阳得热（如果需要，可以符号化地包含内部得热）。然后，在输入和扰动上采用零阶保持的假设下，推导一个适用于MPC的离散时间状态空间模型。明确指出状态、输入和扰动向量如何映射到物理量。\n\n假设以下物理参数是恒定的：\n- 区域热容：$C_{z}$ $\\left[\\mathrm{J/K}\\right]$。\n- 围护结构对环境的热阻（对传导和渗透有效）：$R_{za}$ $\\left[\\mathrm{K/W}\\right]$。\n- 有效太阳得热系数（吸收面积和透射率）：$g_{s}$ $\\left[\\mathrm{m^{2}}\\right]$。\n- 从指令功率到输送给空气的热速率的HVAC输入-效率映射因子：$\\eta$（无量纲）。\n- 环境温度：$T_{a}(t)$ $\\left[\\mathrm{K}\\right]$。\n- 全球水平辐照度：$I_{s}(t)$ $\\left[\\mathrm{W/m^{2}}\\right]$。\n- 内部热增益（可选）：$q_{\\mathrm{int}}(t)$ $\\left[\\mathrm{W}\\right]$。\n\n令状态为 $x(t) = T_{z}(t)$，控制输入为 $u(t)$，扰动向量为由 $T_{a}(t)$、$I_{s}(t)$ 和（可选）$q_{\\mathrm{int}}(t)$ 构成的 $d(t)$。从第一性原理推导一个形式为 $\\dot{x}(t) = a_{c} x(t) + b_{c} u(t) + e_{c} d(t)$ 的仿射连续时间状态方程，用 $C_{z}$、$R_{za}$、$g_{s}$ 和 $\\eta$ 表示系数 $a_{c}$、$b_{c}$ 和 $e_{c}$ 的分量。\n\n接下来，对于给定的均匀采样间隔 $h$ $\\left[\\mathrm{s}\\right]$，并假设在每个采样周期内对 $u(t)$ 和 $d(t)$ 采用零阶保持，推导相应的离散时间状态空间模型\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k} + E_{d} d_{k},\n$$\n用 $a_{c}$、$b_{c}$、$e_{c}$ 和 $h$ 清楚地表示 $A_{d}$、$B_{d}$ 和 $E_{d}$。\n\n最后，对标量状态转移系数 $A_{d}$ 进行数值计算，使用具体参数值 $C_{z} = 1.2 \\times 10^{6}$，$R_{za} = 0.04$ 和 $h = 900$。将您的答案四舍五入到四位有效数字。将最终值表示为无量纲数。",
            "solution": "该问题要求推导一个单区域建筑热力学的连续时间和离散时间状态空间模型，然后对一个模型系数进行数值评估。推导过程从能量守恒的第一性原理开始。\n\n### 第1部分：连续时间状态空间模型\n\n控制建筑区域热力学的基本原理是能量守恒。对于集总热容模型，这一原理可以表示为一个能量平衡方程，其中区域热质量中储存的内能变化率等于流入该区域的所有热流的净和。\n\n令 $T_z(t)$ 为区域空气的温度，这是我们系统的状态。区域热质量的内能为 $C_z T_z(t)$，其中 $C_z$ 是热容。该能量的变化率为 $C_z \\frac{d T_z(t)}{dt}$。\n\n热流如下：\n1.  **HVAC热输入：** 控制输入 $u(t)$ 是指令功率，$\\eta$ 是效率因子。输送给区域的热速率为 $q_{\\mathrm{HVAC}}(t) = \\eta u(t)$。这是一个热增益。\n2.  **太阳得热：** 通过建筑围护结构的太阳得热与全球水平辐照度 $I_s(t)$ 成正比。有效太阳得热系数 $g_s$ 考虑了窗户面积、朝向和太阳得热系数。太阳得热为 $q_{\\mathrm{solar}}(t) = g_s I_s(t)$。这是一个热增益。\n3.  **围护结构传热：** 通过建筑围护结构（墙壁、窗户、屋顶等）和渗透，与温度为 $T_a(t)$ 的环境进行热交换。此过程使用有效热阻 $R_{za}$ 进行建模。热流为 $q_{\\mathrm{env}}(t) = \\frac{T_z(t) - T_a(t)}{R_{za}}$。正值表示从区域到环境的热损失。\n4.  **内部热增益：** 由居住者、照明和设备产生的热量由 $q_{\\mathrm{int}}(t)$ 表示。这是一个热增益。\n\n因此，能量平衡方程为：\n$$\nC_z \\frac{d T_z(t)}{dt} = q_{\\mathrm{HVAC}}(t) + q_{\\mathrm{solar}}(t) + q_{\\mathrm{int}}(t) - q_{\\mathrm{env}}(t)\n$$\n代入热流的表达式：\n$$\nC_z \\frac{d T_z(t)}{dt} = \\eta u(t) + g_s I_s(t) + q_{\\mathrm{int}}(t) - \\frac{T_z(t) - T_a(t)}{R_{za}}\n$$\n为了得到标准形式 $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$ 的状态方程，我们首先通过除以 $C_z$ 来分离导数项 $\\frac{d T_z(t)}{dt}$：\n$$\n\\frac{d T_z(t)}{dt} = \\frac{\\eta}{C_z} u(t) + \\frac{g_s}{C_z} I_s(t) + \\frac{1}{C_z} q_{\\mathrm{int}}(t) - \\frac{1}{R_{za} C_z} T_z(t) + \\frac{1}{R_{za} C_z} T_a(t)\n$$\n现在，我们根据状态、输入和扰动对各项进行分组。\n令状态为 $x(t) = T_z(t)$。\n控制输入为 $u(t)$。\n扰动是影响系统但不受控制的外生变量。我们将它们分组为一个扰动向量 $d(t)$：\n$$\nd(t) = \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\n重新整理方程：\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\left( \\frac{1}{R_{za} C_z} \\right) T_a(t) + \\left( \\frac{g_s}{C_z} \\right) I_s(t) + \\left( \\frac{1}{C_z} \\right) q_{\\mathrm{int}}(t)\n$$\n这可以写成矩阵形式：\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\begin{pmatrix} \\frac{1}{R_{za} C_z}  \\frac{g_s}{C_z}  \\frac{1}{C_z} \\end{pmatrix} \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\n通过将其与目标形式 $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$ 进行比较，我们可以确定这些系数：\n- $a_c = -\\frac{1}{R_{za} C_z}$\n- $b_c = \\frac{\\eta}{C_z}$\n- $e_c = \\begin{pmatrix} \\frac{1}{R_{za} C_z}  \\frac{g_s}{C_z}  \\frac{1}{C_z} \\end{pmatrix}$\n\n### 第2部分：离散时间状态空间模型\n\n为了推导离散时间模型，我们必须在一个采样间隔内，即从时间 $t_k = k h$ 到 $t_{k+1} = (k+1)h$，求解连续时间线性微分方程。仿射状态方程的解由常数变易法给出：\n$$\nx(t) = \\exp(a_c (t - t_k)) x(t_k) + \\int_{t_k}^{t} \\exp(a_c (t - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\n设 $t = t_{k+1} = (k+1)h$ 并使用符号 $x_k = x(kh)$：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\n问题陈述假设在输入 $u(t)$ 和扰动 $d(t)$ 上采用零阶保持（ZOH）。这意味着它们在每个采样间隔内是恒定的：\n- $u(\\tau) = u_k$ 对于 $\\tau \\in [kh, (k+1)h)$\n- $d(\\tau) = d_k$ 对于 $\\tau \\in [kh, (k+1)h)$\n\n在ZOH假设下，$u_k$ 和 $d_k$ 可以移到积分符号之外：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) b_c u_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) e_c d_k\n$$\n我们来计算这个积分。我们使用换元法 $s = (k+1)h - \\tau$，这意味着 $ds = -d\\tau$。积分的上下限变为 $\\tau = kh \\implies s = h$ 和 $\\tau = (k+1)h \\implies s = 0$。\n$$\n\\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau = \\int_{h}^{0} \\exp(a_c s) (-ds) = \\int_{0}^{h} \\exp(a_c s) ds\n$$\n由于 $a_c$ 是一个非零标量，积分为：\n$$\n\\int_{0}^{h} \\exp(a_c s) ds = \\left[ \\frac{1}{a_c} \\exp(a_c s) \\right]_{0}^{h} = \\frac{1}{a_c} (\\exp(a_c h) - \\exp(0)) = \\frac{\\exp(a_c h) - 1}{a_c}\n$$\n将此结果代回 $x_{k+1}$ 的方程中：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c u_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c d_k\n$$\n这就是离散时间状态空间模型 $x_{k+1} = A_d x_k + B_d u_k + E_d d_k$，其中：\n- 状态向量：$x_k = T_z(kh)$\n- 输入向量：$u_k = u(kh)$\n- 扰动向量：$d_k = \\begin{pmatrix} T_a(kh) \\\\ I_s(kh) \\\\ q_{\\mathrm{int}}(kh) \\end{pmatrix}$\n- 状态转移矩阵：$A_d = \\exp(a_c h)$\n- 输入矩阵：$B_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c$\n- 扰动矩阵：$E_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c$\n\n### 第3部分：$A_d$ 的数值计算\n\n问题提供了以下数值：\n- $C_z = 1.2 \\times 10^6 \\, \\mathrm{J/K}$\n- $R_{za} = 0.04 \\, \\mathrm{K/W}$\n- $h = 900 \\, \\mathrm{s}$\n\n首先，我们计算连续时间系数 $a_c$：\n$$\na_c = -\\frac{1}{R_{za} C_z} = -\\frac{1}{(0.04 \\, \\mathrm{K/W}) \\times (1.2 \\times 10^6 \\, \\mathrm{J/K})} = -\\frac{1}{48000 \\, \\mathrm{J/W}}\n$$\n因为 $1 \\, \\mathrm{W} = 1 \\, \\mathrm{J/s}$，单位变为 $\\mathrm{s}^{-1}$。\n$$\na_c = -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\approx -2.0833 \\times 10^{-5} \\, \\mathrm{s}^{-1}\n$$\n接下来，我们计算离散时间状态转移系数 $A_d = \\exp(a_c h)$：\n指数是无量纲的乘积 $a_c h$：\n$$\na_c h = \\left( -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\right) \\times (900 \\, \\mathrm{s}) = -\\frac{900}{48000} = -\\frac{9}{480} = -\\frac{3}{160} = -0.01875\n$$\n现在，我们计算指数函数：\n$$\nA_d = \\exp(-0.01875) \\approx 0.98142605\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nA_d \\approx 0.9814\n$$\n这个值是无量纲的，正如状态转移矩阵元素所预期的那样。",
            "answer": "$$\n\\boxed{0.9814}\n$$"
        },
        {
            "introduction": "拥有系统模型后，下一步是定义“良好控制”的目标。在能源系统中，这通常涉及在相互冲突的目标之间找到最佳平衡，例如在保证用户舒适度的同时最大限度地降低能耗。本练习探讨了模型预测控制设计的核心：如何通过构建一个加权成本函数来量化并权衡这些目标。您将通过一个具体的优化问题，亲身体验如何调整权重参数来探索不同操作策略间的帕累托（Pareto）权衡关系，这是设定控制器性能和调整其行为的关键实践。",
            "id": "4105335",
            "problem": "考虑一个在模型预测控制（MPC）中使用的、具有离散时间线性热动力学的单区域建筑。下一时间步的预测室内温度由仿射系统 $x_{k+1} = a x_{k} + b u_{k}$ 建模，其中 $x_{k}$ 是当前室内温度，$u_{k}$ 是加热功率输入，$a$ 和 $b$ 是已知常数。对于一个具有标量化多目标阶段成本的单步MPC（无约束），建筑运营商使用加权和来平衡热舒适度与能源成本\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k}),\n$$\n其中 $0 \\leq \\alpha \\leq 1$ 是舒适度权重，$r$ 是舒适度设定点，$\\|z\\|_{Q}^{2} = z^{\\top} Q z$ 是一个加权欧几里得范数，$c(u_{k})$ 是能源成本的替代函数。假设区域为标量，因此 $x_{k}$、$x_{k+1}$、$r$ 和 $u_{k}$ 都是标量，并设 $Q = 1$。能源成本替代函数定义为严格凸函数 $c(u_{k}) = u_{k}^{2} + \\lambda u_{k}$，其中价格斜率 $\\lambda$ 为常数。这种标量化方法是追踪热舒适度偏差和能源成本之间帕累托权衡的经典方法；调整 $\\alpha$ 会使工作点沿帕累托前沿移动。\n\n给定参数值 $a = 0.9$，$b = 0.5$，$x_{k} = 20$，$r = 22$ 以及 $\\lambda = 4$，并使用无约束单步MPC在 $u_{k} \\in \\mathbb{R}$ 上最小化 $\\ell(x_{k+1}, u_{k})$，请按以下步骤操作：\n- 根据二次目标的凸优化基本原理和给定的动力学模型，推导出作为 $\\alpha$ 函数的最优控制输入 $u^{\\star}(\\alpha)$。\n- 采用帕累托权衡准则来调整 $\\alpha$：确定唯一的权重 $\\alpha \\in (0, 1)$，使得在最优解处，两个加权目标分量相等，即：\n$$\n\\alpha \\|x_{k+1} - r\\|_{Q}^{2} \\;=\\; (1 - \\alpha) c(u_{k})\n\\quad \\text{在} \\quad u_{k} = u^{\\star}(\\alpha) \\text{处求值}。\n$$\n\n给出由此得到的 $\\alpha$ 的精确解析值。无需四舍五入。最终答案必须是一个不带单位的实数值。",
            "solution": "该问题要求在一个用于单区域建筑的单步模型预测控制（MPC）框架中，确定加权参数 $\\alpha$ 的一个特定值。该 $\\alpha$ 值必须使得在最优控制输入下，目标函数的两个加权分量相等。\n\n首先，我们建立要最小化的目标函数。阶段成本由下式给出：\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k})\n$$\n问题指明变量 $x_{k+1}$、$u_k$ 和 $r$ 是标量，且权重矩阵 $Q=1$。成本函数 $c(u_k)$ 定义为 $c(u_k) = u_{k}^{2} + \\lambda u_{k}$。系统动力学由线性模型 $x_{k+1} = a x_{k} + b u_{k}$ 给出。\n代入这些定义，我们记为 $J(u_k)$ 的目标函数变为：\n$$\nJ(u_k) = \\alpha (x_{k+1} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\n将系统动力学代入 $J(u_k)$：\n$$\nJ(u_k) = \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\n该目标函数是关于控制输入 $u_k$ 的二次函数。对于 $\\alpha \\in [0, 1]$，$u_k^2$ 项的系数是 $\\alpha b^2 + (1-\\alpha) = 1 - \\alpha(1-b^2)$。给定 $b=0.5$，该系数为 $1-0.75\\alpha$，对于 $\\alpha \\in [0,1]$ 而言，该值是严格为正的。因此，$J(u_k)$ 是关于 $u_k$ 的严格凸函数，其唯一的最小值可以通过将其关于 $u_k$ 的一阶导数设为零来找到。\n\n$J(u_k)$ 关于 $u_k$ 的导数是：\n$$\n\\frac{dJ}{du_k} = \\frac{d}{du_k} \\left[ \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k}) \\right]\n$$\n$$\n\\frac{dJ}{du_k} = 2 \\alpha (a x_{k} + b u_{k} - r) \\cdot b + (1 - \\alpha)(2u_k + \\lambda)\n$$\n将导数设为零以求得最优控制输入，记为 $u^{\\star}(\\alpha)$：\n$$\n2 \\alpha b (a x_{k} + b u^{\\star}(\\alpha) - r) + (1 - \\alpha)(2u^{\\star}(\\alpha) + \\lambda) = 0\n$$\n我们可以解出 $u^{\\star}(\\alpha)$：\n$$\n2 \\alpha a b x_{k} + 2 \\alpha b^2 u^{\\star}(\\alpha) - 2 \\alpha b r + 2(1-\\alpha)u^{\\star}(\\alpha) + \\lambda(1-\\alpha) = 0\n$$\n$$\nu^{\\star}(\\alpha) (2 \\alpha b^2 + 2(1-\\alpha)) = 2 \\alpha b r - 2 \\alpha a b x_{k} - \\lambda(1-\\alpha)\n$$\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha b (r - a x_{k}) - \\lambda(1-\\alpha)}{2(\\alpha b^2 + 1 - \\alpha)}\n$$\n现在，我们代入给定的参数值：$a=0.9$，$b=0.5$，$x_{k}=20$，$r=22$ 以及 $\\lambda=4$。\n$r - a x_{k}$ 项变为 $22 - 0.9 \\times 20 = 22 - 18 = 4$。\n$b^2$ 项为 $0.5^2 = 0.25$。\n将这些值代入 $u^{\\star}(\\alpha)$ 的表达式中：\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha (0.5) (4) - 4(1-\\alpha)}{2(\\alpha (0.25) + 1 - \\alpha)} = \\frac{4\\alpha - 4 + 4\\alpha}{2(1 - 0.75\\alpha)} = \\frac{8\\alpha - 4}{2 - 1.5\\alpha}\n$$\n问题的第二部分要求找到 $\\alpha \\in (0, 1)$ 的值，使得当 $u_k = u^{\\star}(\\alpha)$ 时，两个加权目标分量相等。该条件为：\n$$\n\\alpha (x_{k+1} - r)^{2} = (1 - \\alpha) c(u_k)\n$$\n$$\n\\alpha (a x_k + b u_k - r)^2 = (1 - \\alpha)(u_k^2 + \\lambda u_k)\n$$\n为了简化对 $\\alpha$ 的求解，我们可以使用前面推导的一阶最优性条件：\n$$\n2 \\alpha b (a x_k + b u_k - r) = -(1 - \\alpha)(2u_k + \\lambda)\n$$\n其中 $u_k = u^{\\star}(\\alpha)$。我们来解出 $(a x_k + b u_k - r)$ 这一项：\n$$\n(a x_k + b u_k - r) = -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b}\n$$\n将此式代入权衡条件的左侧：\n$$\n\\alpha \\left( -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b} \\right)^2 = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\n$$\n\\alpha \\frac{(1-\\alpha)^2 (2u_k+\\lambda)^2}{4\\alpha^2 b^2} = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\n因为我们在寻找 $\\alpha \\in (0,1)$，我们知道 $\\alpha \\neq 0$ 且 $1-\\alpha \\neq 0$。我们可以将等式两边同时除以 $(1-\\alpha)$：\n$$\n\\frac{(1-\\alpha)(2u_k+\\lambda)^2}{4\\alpha b^2} = u_k^2 + \\lambda u_k\n$$\n代入数值 $b=0.5$ 和 $\\lambda=4$：\n$$\n\\frac{(1-\\alpha)(2u_k+4)^2}{4\\alpha (0.5)^2} = u_k^2 + 4u_k\n$$\n$$\n\\frac{(1-\\alpha) \\cdot 4(u_k+2)^2}{\\alpha} = u_k(u_k+4)\n$$\n现在，我们代入 $u^{\\star}(\\alpha)$ 的表达式：$u_k = \\frac{8\\alpha-4}{2-1.5\\alpha}$。我们来计算 $(u_k+2)$ 和 $(u_k+4)$ 这两项：\n$$\nu_k+2 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 2 = \\frac{8\\alpha-4 + 2(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+4-3\\alpha}{2-1.5\\alpha} = \\frac{5\\alpha}{2-1.5\\alpha}\n$$\n$$\nu_k+4 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 4 = \\frac{8\\alpha-4 + 4(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+8-6\\alpha}{2-1.5\\alpha} = \\frac{2\\alpha+4}{2-1.5\\alpha}\n$$\n将这些结果代回方程中：\n$$\n\\frac{4(1-\\alpha)}{\\alpha} \\left( \\frac{5\\alpha}{2-1.5\\alpha} \\right)^2 = \\left( \\frac{8\\alpha-4}{2-1.5\\alpha} \\right) \\left( \\frac{2\\alpha+4}{2-1.5\\alpha} \\right)\n$$\n$$\n\\frac{4(1-\\alpha) \\cdot 25\\alpha^2}{\\alpha(2-1.5\\alpha)^2} = \\frac{(8\\alpha-4)(2\\alpha+4)}{(2-1.5\\alpha)^2}\n$$\n对于 $\\alpha \\in (0,1)$，分母相等且非零，因此我们可以令分子相等：\n$$\n100\\alpha(1-\\alpha) = (8\\alpha-4)(2\\alpha+4)\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 32\\alpha - 8\\alpha - 16\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 24\\alpha - 16\n$$\n整理各项得到一个关于 $\\alpha$ 的二次方程：\n$$\n(100+16)\\alpha^2 + (24-100)\\alpha - 16 = 0\n$$\n$$\n116\\alpha^2 - 76\\alpha - 16 = 0\n$$\n将整个方程除以 $4$ 得到简化形式：\n$$\n29\\alpha^2 - 19\\alpha - 4 = 0\n$$\n我们使用二次公式 $\\alpha = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $\\alpha$，其中 $A=29$，$B=-19$，$C=-4$：\n$$\n\\alpha = \\frac{-(-19) \\pm \\sqrt{(-19)^2 - 4(29)(-4)}}{2(29)} = \\frac{19 \\pm \\sqrt{361 + 464}}{58} = \\frac{19 \\pm \\sqrt{825}}{58}\n$$\n为了简化平方根，我们对 $825$ 进行因式分解：$825 = 25 \\times 33 = 5^2 \\times 33$。因此，$\\sqrt{825} = 5\\sqrt{33}$。\n$\\alpha$ 的两个可能解是：\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58} \\quad \\text{和} \\quad \\alpha = \\frac{19 - 5\\sqrt{33}}{58}\n$$\n问题要求 $\\alpha \\in (0, 1)$。我们必须检查哪个解位于这个区间内。\n对于第二个根，我们估算 $\\sqrt{33}$。因为 $5^2=25$ 且 $6^2=36$，所以 $5  \\sqrt{33}  6$。因此，$5\\sqrt{33} > 25$。这使得分子 $19 - 5\\sqrt{33}$ 为负，所以这个根小于 $0$。\n对于第一个根，$19 + 5\\sqrt{33}$ 显然是正数。我们必须检查它是否小于 $58$。\n$$\n19 + 5\\sqrt{33}  58 \\implies 5\\sqrt{33}  39 \\implies (5\\sqrt{33})^2  39^2 \\implies 25 \\times 33  1521 \\implies 825  1521\n$$\n这个不等式成立，所以第一个根确实在 $0$ 和 $1$ 之间。\n满足条件的唯一 $\\alpha$ 值是：\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58}\n$$",
            "answer": "$$\\boxed{\\frac{19 + 5\\sqrt{33}}{58}}$$"
        },
        {
            "introduction": "理论模型是理想的，但现实世界的能源系统总是受到模型不确定性和外部干扰的影响。为了确保控制系统在实际应用中的安全性和可靠性，我们必须采用鲁棒控制方法。本练习将向您介绍一种重要的鲁棒MPC技术——“管道式”模型预测控制。您将学习如何通过“收紧”标称模型的约束条件，为系统创建一个安全边界，从而保证即使在最坏的扰动情况下，实际系统的状态和输入也绝不会违反其物理限制。这是从理论走向实际部署的关键一步。",
            "id": "4105355",
            "problem": "考虑一个采用基于管的（tube-based）模型预测控制 (MPC) 运行的并网电池储能系统。实际状态 $x_k \\in \\mathbb{R}^2$ 在加性扰动下演化，其方程为 $x_{k+1} = A x_k + B u_k + w_k$，其中 $u_k \\in \\mathbb{R}$ 是控制输入，$w_k \\in \\mathbb{R}^2$ 是一个未知扰动，其界限为一个已知的紧凸集 $\\mathcal{W}$。该 MPC 使用一个无扰动演化的标称状态 $z_k$，一个标称输入 $v_k$，以及一个施加于偏差 $e_k = x_k - z_k$ 的线性预稳定反馈 $K \\in \\mathbb{R}^{1 \\times 2}$，因此有 $u_k = v_k + K e_k$，且偏差动态满足 $e_{k+1} = (A + B K)e_k + w_k$。假设存在一个用于偏差动态的紧凸鲁棒正不变 (RPI) 集 $\\mathcal{S}$，即对于所有 $e_k \\in \\mathcal{S}$ 和 $w_k \\in \\mathcal{W}$，都有 $e_{k+1} \\in \\mathcal{S}$。\n\n系统受到多胞体状态和输入约束 $x_k \\in \\mathcal{X}$ 和 $u_k \\in \\mathcal{U}$ 的限制，其中 $\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : H_x x \\le h_x \\}$ 和 $\\mathcal{U} = \\{ u \\in \\mathbb{R} : H_u u \\le h_u \\}$。集合 $\\mathcal{A}, \\mathcal{B}$ 的 Pontryagin (Minkowski) 集差定义为 $\\mathcal{A} \\ominus \\mathcal{B} = \\{ z : z + \\mathcal{B} \\subseteq \\mathcal{A} \\}$。Minkowski 和定义为 $\\mathcal{A} \\oplus \\mathcal{B} = \\{ a + b : a \\in \\mathcal{A}, b \\in \\mathcal{B} \\}$。\n\n任务1（推导）：仅从前面的定义和鲁棒正不变性的定义出发，推导标称变量的收紧约束集，\n$$\nz_k \\in \\mathcal{X} \\ominus \\mathcal{S}, \\quad v_k \\in \\mathcal{U} \\ominus K \\mathcal{S},\n$$\n以保证对于所有的 $k$ 和所有的扰动 $w_k \\in \\mathcal{W}$，实际状态和输入都满足 $x_k \\in \\mathcal{X}$ 和 $u_k \\in \\mathcal{U}$。用 $\\mathcal{S}$ 的支撑函数来表达您对一般多胞体 $\\mathcal{X}$ 和 $\\mathcal{U}$ 的推导，并用文字解释可行性保证。\n\n任务2（在特定能源系统上进行评估）：考虑一个电池模型，其中两个状态是荷电状态偏差和变流器功率偏差。硬约束为对称盒式集合\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : |x_1| \\le 0.20,\\ |x_2| \\le 40 \\}, \\quad \\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}.\n$$\n控制器使用反馈增益\n$$\nK = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix},\n$$\n并且偏差被限制在 RPI 集\n$$\n\\mathcal{S} = \\{ e \\in \\mathbb{R}^2 : |e_1| \\le 0.02,\\ |e_2| \\le 1.9 \\}.\n$$\n计算从 $\\mathcal{U} \\ominus K \\mathcal{S}$ 获得的收紧输入上界的标量值。以 $\\mathrm{MW}$ 为单位表示最终界限。不要四舍五入您的答案；请提供精确的小数值。最终答案必须是一个实数。",
            "solution": "### 任务1：收紧约束的推导\n\n该任务的目标是推导施加于标称状态 $z_k$ 和标称输入 $v_k$ 的约束，以确保在存在有界扰动的情况下，实际状态 $x_k$ 和实际输入 $u_k$ 始终满足其原始约束。我们假设在初始时刻 $k=0$ 时，偏差 $e_0 = x_0 - z_0$ 位于鲁棒正不变 (RPI) 集 $\\mathcal{S}$ 内。根据 RPI 集的定义，对于所有未来的时间步 $k>0$，偏差 $e_k$ 将始终保持在 $\\mathcal{S}$ 内，即 $e_k \\in \\mathcal{S}$。\n\n**状态约束收紧：**\n我们希望保证实际状态 $x_k$ 满足其约束 $x_k \\in \\mathcal{X}$。我们知道实际状态与标称状态之间的关系为 $x_k = z_k + e_k$。因此，约束变为：\n$$\nz_k + e_k \\in \\mathcal{X}\n$$\n此条件必须对所有可能的偏差 $e_k \\in \\mathcal{S}$ 都成立。换句话说，对于一个给定的标称状态 $z_k$，由 $z_k$ 平移的集合 $\\mathcal{S}$ 必须完全包含在约束集 $\\mathcal{X}$ 内部。这可以表示为：\n$$\nz_k + \\mathcal{S} \\subseteq \\mathcal{X}\n$$\n根据 Pontryagin 集差的定义，$\\mathcal{A} \\ominus \\mathcal{B} = \\{ z : z + \\mathcal{B} \\subseteq \\mathcal{A} \\}$，上述条件等价于要求标称状态 $z_k$ 必须属于收紧后的状态约束集：\n$$\nz_k \\in \\mathcal{X} \\ominus \\mathcal{S}\n$$\n\n**输入约束收紧：**\n同样，我们希望保证实际输入 $u_k$ 满足其约束 $u_k \\in \\mathcal{U}$。实际输入由控制律 $u_k = v_k + K e_k$ 给出。因此，约束变为：\n$$\nv_k + K e_k \\in \\mathcal{U}\n$$\n由于偏差 $e_k$ 位于集合 $\\mathcal{S}$ 内，项 $K e_k$ 位于线性映射后的集合 $K\\mathcal{S} = \\{Ke : e \\in \\mathcal{S}\\}$ 内。上述条件必须对所有可能的 $e_k \\in \\mathcal{S}$ 都成立。这意味着对于一个给定的标称输入 $v_k$，由 $v_k$ 平移的集合 $K\\mathcal{S}$ 必须完全包含在约束集 $\\mathcal{U}$ 内部：\n$$\nv_k + K\\mathcal{S} \\subseteq \\mathcal{U}\n$$\n再次应用 Pontryagin 集差的定义，我们得到标称输入 $v_k$ 必须满足的收紧约束：\n$$\nv_k \\in \\mathcal{U} \\ominus K\\mathcal{S}\n$$\n\n**可行性保证：**\n通过在每个时间步 $k$ 求解一个仅涉及标称变量 $z_k$ 和 $v_k$ 的优化问题，并施加上述收紧的约束，我们确保了鲁棒性。如果在这个收紧的约束集内存在一个可行的标称轨迹 $\\{z_{k+i|k}, v_{k+i|k}\\}_{i=0}^{N-1}$，那么对于任何符合 $w_k \\in \\mathcal{W}$ 的扰动序列，由控制律 $u_k = v_k + K e_k$ 产生的实际状态和输入轨迹都将满足原始的硬约束 $\\mathcal{X}$ 和 $\\mathcal{U}$。这一性质被称为**递归可行性**：如果在时刻 $k$ 存在一个可行解，那么在时刻 $k+1$ 也必然存在一个可行解。\n\n### 任务2：特定能源系统上的评估\n\n该任务要求计算收紧后的输入约束的上界。原始输入约束为 $\\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}$，即 $-30 \\le u \\le 30$。\n\n根据任务1的推导，收紧后的约束要求标称输入 $v_k$ 满足 $v_k \\in \\mathcal{U} \\ominus K\\mathcal{S}$。这意味着对于所有 $e \\in \\mathcal{S}$，都必须满足 $v_k + Ke \\in \\mathcal{U}$。\n代入原始约束，我们得到：\n$$\n-30 \\le v_k + Ke \\le 30, \\quad \\forall e \\in \\mathcal{S}\n$$\n这可以分解为两个不等式，它们都必须对所有 $e \\in \\mathcal{S}$ 成立：\n1.  $v_k \\le 30 - Ke$\n2.  $v_k \\ge -30 - Ke$\n\n为了使第一个不等式对所有 $e \\in \\mathcal{S}$ 成立， $v_k$ 必须小于或等于 $30 - Ke$ 的最小值，这等价于：\n$$\nv_k \\le 30 - \\max_{e \\in \\mathcal{S}} (Ke)\n$$\n为了使第二个不等式对所有 $e \\in \\mathcal{S}$ 成立，$v_k$ 必须大于或等于 $-30 - Ke$ 的最大值，这等价于：\n$$\nv_k \\ge -30 - \\min_{e \\in \\mathcal{S}} (Ke)\n$$\n因此，收紧后的输入上界为 $v_{\\max} = 30 - \\max_{e \\in \\mathcal{S}} (Ke)$。\n\n我们现在需要计算 $\\max_{e \\in \\mathcal{S}} (Ke)$。给定的参数为：\n- 反馈增益：$K = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix}$\n- RPI集：$\\mathcal{S} = \\{ e = (e_1, e_2) \\in \\mathbb{R}^2 : |e_1| \\le 0.02,\\ |e_2| \\le 1.9 \\}$\n\n我们要最大化的表达式是：\n$$\nKe = -0.5 e_1 - 0.1 e_2\n$$\n这是一个在盒形集合 $\\mathcal{S}$ 上的线性函数。为了最大化这个表达式，我们需要使每个带负系数的项尽可能为负。因此，我们应该选择 $e_1$ 和 $e_2$ 的负边界值：\n- $e_1 = -0.02$\n- $e_2 = -1.9$\n\n代入这些值，我们得到 $Ke$ 的最大值：\n$$\n\\max_{e \\in \\mathcal{S}} (Ke) = -0.5(-0.02) - 0.1(-1.9) = 0.01 + 0.19 = 0.2\n$$\n现在，我们可以计算收紧后的输入上界：\n$$\nv_{\\max} = 30 - \\max_{e \\in \\mathcal{S}} (Ke) = 30 - 0.2 = 29.8\n$$\n收紧后的输入上界为 29.8 MW。作为补充，我们也可以计算下界：\n$$\n\\min_{e \\in \\mathcal{S}} (Ke) = -0.5(0.02) - 0.1(1.9) = -0.01 - 0.19 = -0.2\n$$\n收紧后的下界为 $v_{\\min} = -30 - \\min_{e \\in \\mathcal{S}} (Ke) = -30 - (-0.2) = -29.8$。\n因此，收紧后的标称输入约束为 $|v_k| \\le 29.8$。\n\n问题要求的是收紧输入上界的标量值。\n最终答案是 29.8。",
            "answer": "$$\\boxed{29.8}$$"
        }
    ]
}