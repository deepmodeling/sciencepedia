{
    "hands_on_practices": [
        {
            "introduction": "电力系统规划者长期以来因其简便性而使用确定性指标，如规划备用容量率（$PRM$）。然而，这些指标可能会产生误导，因为它们没有考虑发电机故障的随机性。本练习将引导您进行一次基础性的实践推导，从数学上证明为何固定的 $PRM$ 无法保证一致的可靠性水平，以及概率性指标“年缺电期望时长”（$LOLE$）如何直接受发电机组故障率的影响 。通过解决这个问题，您将对为何概率性评估对现代电力充裕度至关重要建立起核心理解。",
            "id": "4119073",
            "problem": "考虑一个用于资源充裕度评估的典型电力系统。该系统每年为峰值负荷 $L$ 供电 $T$ 小时，发电机组由 $N$ 台相同的、统计独立的机组组成，每台机组的铭牌容量为 $C$，强迫停运率 (FOR) 为常数，记为 $\\mathrm{FOR} \\in (0,1)$。规划备用容量率 (PRM) 由确定性关系定义，即装机容量等于峰值负荷的 $(1+\\mathrm{PRM})$ 倍，即 $N C = (1+\\mathrm{PRM}) L$。设任意时刻在线的机组数量为一个随机变量 $X$，它服从成功概率为 $p = 1 - \\mathrm{FOR}$ 的二项分布。当可用容量小于负荷时，即 $X C  L$ 时，发生缺电事件。缺电期望时长 (LOLE) 是每年发生缺电的预期小时数，对于这个恒定负荷的典型系统，它等于 $T$ 乘以缺电事件的概率。设 $r = L/C$ 表示恰好满足峰值负荷所需的在线机组数量，并假设 $r$ 不是整数，因此缺电阈值为 $X  r$。\n\n仅使用基本的概率定义和适用于大规模机组的、经过充分检验的近似方法（例如，带适当连续性校正的二项分布正态近似），回答以下问题：\n\n1. 从 LOLE 在 $X \\sim \\mathrm{Binomial}(N,p)$ 条件下作为缺电事件的期望的定义出发，数学上解释为什么当 $\\mathrm{FOR}$ 改变时，一个固定的确定性 $\\mathrm{PRM}$ 会产生不同的充裕度结果（不同的 LOLE）。您的解释应通过 $p$ 推导出 LOLE 对 $\\mathrm{FOR}$ 的依赖关系，并阐明 $N$、$C$ 和 $L$ 的作用。\n\n2. 设目标充裕度标准为指定的 $\\mathrm{LOLE}^{\\star}$（单位：小时/年），并设 $q = \\mathrm{LOLE}^{\\star}/T$ 为恒定负荷典型化下的相应目标每小时缺电概率。在对 $X$ 使用正态近似的情况下，使用 $0.5$ 个单位的连续性校正，推导出一个为达到 $\\mathrm{LOLE}^{\\star}$ 所需的确定性 $\\mathrm{PRM}$ 的闭式解析表达式，该表达式是关于 $p$、$q$ 和 $r$ 的函数。您的最终表达式必须是关于 $p$、$q$ 和 $r$ 的单个闭式解析表达式（您可以使用标准正态累积分布函数的反函数），并且必须明确解出 $\\mathrm{PRM}$。\n\n将最终的 $\\mathrm{PRM}$ 表示为无量纲小数（例如，百分之十五表示为 $0.15$）。不需要进行数值计算；仅提供符号表达式。最终答案必须是单个解析表达式。",
            "solution": "所述问题具有科学依据，提法恰当且客观。它使用了一个电力系统可靠性分析中的标准（尽管简化了）模型。所有变量和条件都得到了充分定义，可以得出一个唯一的、有意义的解。因此，该问题被认为是**有效的**。\n\n### 第1部分：固定PRM下FOR对LOLE的影响\n\n缺电期望时长 (LOLE) 定义为每年发电量不足的预期小时数。对于恒定负荷 $L$ 持续 $T$ 小时的典型系统，其表达式为：\n$$\n\\mathrm{LOLE} = T \\times P(\\text{shortfall})\n$$\n当总可用容量小于负荷时，发生缺电事件。设 $X$ 为 $N$ 台发电机组中在线的机组数量。总可用容量为 $X C$，其中 $C$ 为单台机组的容量。缺电条件为 $X C  L$，可重写为 $X  L/C$。\n问题定义了 $r = L/C$，所以条件是 $X  r$。\n\n在线机组数量 $X$ 是一个随机变量，服从二项分布，因为 $N$ 台机组是统计独立的，其可用率（成功概率）为 $p = 1 - \\mathrm{FOR}$。因此，$X \\sim \\mathrm{Binomial}(N, p)$。缺电事件的概率是 $X$ 小于 $r$ 的累积概率。由于 $X$ 是整数，而 $r$ 被指定为非整数，该概率为：\n$$\nP(X  r) = P(X \\le \\lfloor r \\rfloor) = \\sum_{k=0}^{\\lfloor r \\rfloor} \\binom{N}{k} p^k (1-p)^{N-k}\n$$\n规划备用容量率 (PRM) 由总装机容量 $NC$ 和峰值负荷 $L$ 之间的关系定义：\n$$\nNC = (1+\\mathrm{PRM})L\n$$\n我们可以用 $r$ 和 PRM 来表示总机组数量 $N$。将 $L=rC$ 代入 PRM 的定义，我们得到：\n$$\nNC = (1+\\mathrm{PRM})rC \\implies N = (1+\\mathrm{PRM})r\n$$\n对于固定的 PRM 和固定的系统规模（即固定的 $r=L/C$），总发电机数量 $N$ 也是固定的。那么 LOLE 为：\n$$\n\\mathrm{LOLE} = T \\times \\sum_{k=0}^{\\lfloor r \\rfloor} \\binom{(1+\\mathrm{PRM})r}{k} (1-\\mathrm{FOR})^k (\\mathrm{FOR})^{(1+\\mathrm{PRM})r-k}\n$$\n该表达式表明，LOLE 通过可用率 $p = 1 - \\mathrm{FOR}$ 和不可用率 $1-p = \\mathrm{FOR}$，是强迫停运率 $\\mathrm{FOR}$ 的显式函数。\n\n为了理解这种依赖关系的性质，我们考虑二项分布 $X \\sim \\mathrm{Binomial}(N, p)$ 的特性。在线机组的期望数量为 $\\mu = E[X] = Np$。随着 $\\mathrm{FOR}$ 增加，$p$ 减小，因此，在线机组的期望数量 $\\mu$ 也减小。这意味着 $X$ 的整个概率质量函数向较小的值移动。然而，缺电阈值 $r$ 保持不变。在阈值不变的情况下，分布的质量向左移动必然会增加低于该阈值的累积概率。换句话说，随着 $\\mathrm{FOR}$ 的增加，概率 $P(X  r)$ 增加，导致更高的 LOLE。\n\n固定的 PRM 确保总装机容量比峰值负荷高出某个百分比，但它没有提供关于期望*可用*容量的信息，即 $E[XC] = E[X]C = (Np)C$。这个期望可用容量直接依赖于发电机的可靠性（FOR）。因此，像 PRM 这样的确定性指标本身不足以保证像 LOLE 这样的特定概率性可靠性水平；要达到相同的 LOLE，更高的 FOR 需要更高的 PRM。\n\n### 第2部分：针对目标LOLE的PRM推导\n\n目标是找到达到目标充裕度标准 $\\mathrm{LOLE}^{\\star}$ 所需的 PRM。这对应于每小时的目标缺电概率 $q = \\mathrm{LOLE}^{\\star}/T$。需要满足的条件是：\n$$\nP(X  r) = q\n$$\n我们被要求使用二项分布的正态近似。对于 $X \\sim \\mathrm{Binomial}(N, p)$，其近似为 $X \\approx \\mathcal{N}(\\mu, \\sigma^2)$，均值为 $\\mu = Np$，方差为 $\\sigma^2 = Np(1-p)$。\n\n为了近似离散变量 $X$ 的概率，我们应用连续性校正。事件 $X  r$ 等价于 $X \\le \\lfloor r \\rfloor$，因为 $X$ 是整数而 $r$ 不是。问题陈述提到使用 $0.5$ 个单位的连续性校正。这被解释为通过在点 $r - 0.5$ 处评估相应正态近似的累积分布函数来近似离散概率 $P(X  r)$。设 $Z$ 为标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，并设 $\\Phi(z)$ 为其累积分布函数 (CDF)。\n$$\nP(X  r) \\approx P\\left( Z \\le \\frac{(r - 0.5) - \\mu}{\\sigma} \\right) = \\Phi\\left(\\frac{(r - 0.5) - Np}{\\sqrt{Np(1-p)}}\\right)\n$$\n我们将此概率设为目标值 $q$：\n$$\n\\Phi\\left(\\frac{(r - 0.5) - Np}{\\sqrt{Np(1-p)}}\\right) = q\n$$\n对两边应用标准正态CDF的反函数 $\\Phi^{-1}$，得到：\n$$\n\\frac{(r - 0.5) - Np}{\\sqrt{Np(1-p)}} = \\Phi^{-1}(q)\n$$\n为了解出 $N$，我们重新整理方程。为方便起见，设 $z_q = \\Phi^{-1}(q)$。\n$$\n(r - 0.5) - Np = z_q \\sqrt{N} \\sqrt{p(1-p)}\n$$\n这可以写成一个关于 $\\sqrt{N}$ 的二次方程：\n$$\np(\\sqrt{N})^2 + \\left(z_q \\sqrt{p(1-p)}\\right)(\\sqrt{N}) - (r - 0.5) = 0\n$$\n我们使用二次公式 $\\sqrt{N} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解 $\\sqrt{N}$，其中 $a=p$，$b=z_q \\sqrt{p(1-p)}$，$c=-(r-0.5)$。由于 $\\sqrt{N}$ 必须是正实数，我们取正根：\n$$\n\\sqrt{N} = \\frac{-z_q \\sqrt{p(1-p)} + \\sqrt{\\left(z_q \\sqrt{p(1-p)}\\right)^2 - 4(p)(-(r - 0.5))}}{2p}\n$$\n$$\n\\sqrt{N} = \\frac{-z_q \\sqrt{p(1-p)} + \\sqrt{z_q^2 p(1-p) + 4p(r - 0.5)}}{2p}\n$$\n两边平方，得到所需的机组数量 $N$：\n$$\nN = \\left( \\frac{-z_q \\sqrt{p(1-p)} + \\sqrt{z_q^2 p(1-p) + 4p(r - 0.5)}}{2p} \\right)^2\n$$\n最后，我们使用 PRM 的定义，$\\mathrm{PRM} = \\frac{N}{r} - 1$，来求得所需的备用容量率。代入 $N$ 的表达式并将 $z_q$ 替换为 $\\Phi^{-1}(q)$：\n$$\n\\mathrm{PRM} = \\frac{1}{r} \\left( \\frac{-\\Phi^{-1}(q) \\sqrt{p(1-p)} + \\sqrt{(\\Phi^{-1}(q))^2 p(1-p) + 4p(r - 0.5)}}{2p} \\right)^2 - 1\n$$\n这就是 PRM 作为 $p$、$q$ 和 $r$ 的函数的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{1}{r} \\left( \\frac{-\\Phi^{-1}(q) \\sqrt{p(1-p)} + \\sqrt{(\\Phi^{-1}(q))^{2} p(1-p) + 4p(r - 0.5)}}{2p} \\right)^{2} - 1}$$"
        },
        {
            "introduction": "在认识到概率方法的重要性之后，下一步是精确地为发电资源的行为建模。一种常见的简化方法是将发电机视为完全开启或完全关闭（即“二元模型”）。本练习将挑战这一简化假设，引入更真实的、包含部分停运或降额运行的“多状态模型”。您将为两种建模方法构建容量停运概率表（COPT），以计算并比较系统的缺电概率（$LOLP$），从而揭示过于简化的模型会如何显著低估可靠性风险 。",
            "id": "4119023",
            "problem": "一位系统运营商正在评估不同火电机组停运建模假设下的资源充裕性和容量信用影响。该运营商使用容量停运概率表 (COPT) 和负荷损失概率 (LOLP) 指标。考虑一个在充裕性评估区间内具有确定性净负荷 $L$ 且机组可用性相互独立的单区域系统。\n\n以下核心定义和建模假设被作为基本基础：\n- LOLP 定义为净负荷超过可用容量的概率，即 $\\mathbb{P}(L > A)$，其中 $A$ 是总可用容量。\n- COPT 表示通过对各个独立资源的可用性分布进行卷积得到的总可用容量的概率分布。\n- 在所考虑的区间内，各机组的可用性状态在机组之间以及在整个充裕性评估区间内都是独立的，并且净负荷 $L$ 与发电机状态无关。\n\n系统由以下资源组成：\n- 一个容量为 $B = 700$ 兆瓦的完全可靠的固定容量块。\n- 火电机组 $1$，额定容量为 $C_{1} = 500$ 兆瓦，其多状态可用性变量 $X_{1}$ 的取值为 $500$ 兆瓦（满载）、$300$ 兆瓦（降额）或 $0$ 兆瓦（停运），对应的概率分别为 $0.92$、$0.06$ 和 $0.02$。\n- 火电机组 $2$，额定容量为 $C_{2} = 400$ 兆瓦，其多状态可用性变量 $X_{2}$ 的取值为 $400$ 兆瓦（满载）、$200$ 兆瓦（降额）或 $0$ 兆瓦（停运），对应的概率分别为 $0.90$、$0.07$ 和 $0.03$。\n\n设确定性净负荷为 $L = 1{,}500$ 兆瓦。定义多状态总可用容量为 $A = B + X_{1} + X_{2}$。\n\n在双状态停运建模下，每个火电机组由一个忽略部分降额运行状态的双状态可用性变量表示：一个机组要么以额定容量完全可用，要么完全停运。具体来说，定义 $Y_{1}$ 以概率 $1 - q_{1}$ 取值为 $500$ 兆瓦，以概率 $q_{1}$ 取值为 $0$ 兆瓦；定义 $Y_{2}$ 以概率 $1 - q_{2}$ 取值为 $400$ 兆瓦，以概率 $q_{2}$ 取值为 $0$ 兆瓦，其中 $q_{1}$ 和 $q_{2}$ 分别是机组 $1$ 和机组 $2$ 的完全停运概率。对此系统，取 $q_{1} = 0.02$ 和 $q_{2} = 0.03$，因此双状态模型的总可用容量为 $A^{\\text{bin}} = B + Y_{1} + Y_{2}$。\n\n使用这些定义：\n1. 构建 $A$ 的多状态 COPT，并推导出 $LOLP_{\\text{multi}} = \\mathbb{P}(A  L)$。\n2. 构建 $A^{\\text{bin}}$ 的双状态停运 COPT，并推导出 $LOLP_{\\text{bin}} = \\mathbb{P}(A^{\\text{bin}}  L)$。\n3. 计算无量纲比率 $R = \\dfrac{LOLP_{\\text{multi}}}{LOLP_{\\text{bin}}}$。\n\n将最终比率四舍五入至四位有效数字。由于该比率为无量纲，因此不需要单位。最终答案必须是单个实数。",
            "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 系统：单区域，确定性净负荷 $L$。\n- 资源：\n  - 固定容量块：$B = 700$ 兆瓦。\n  - 火电机组 $1$：额定容量 $C_{1} = 500$ MW。多状态可用性 $X_{1}$ 的状态为 $\\{500, 300, 0\\}$ MW，相应概率为 $\\{0.92, 0.06, 0.02\\}$。\n  - 火电机组 $2$：额定容量 $C_{2} = 400$ MW。多状态可用性 $X_{2}$ 的状态为 $\\{400, 200, 0\\}$ MW，相应概率为 $\\{0.90, 0.07, 0.03\\}$。\n- 净负荷：$L = 1{,}500$ 兆瓦。\n- 多状态模型：总可用容量为 $A = B + X_{1} + X_{2}$。负荷损失概率为 $LOLP_{\\text{multi}} = \\mathbb{P}(A  L)$。\n- 双状态模型：\n  - 机组 1 可用性 $Y_{1}$ 的状态为 $\\{500, 0\\}$ MW，概率为 $\\{1-q_{1}, q_{1}\\}$，其中 $q_{1} = 0.02$。\n  - 机组 2 可用性 $Y_{2}$ 的状态为 $\\{400, 0\\}$ MW，概率为 $\\{1-q_{2}, q_{2}\\}$，其中 $q_{2} = 0.03$。\n  - 总可用容量为 $A^{\\text{bin}} = B + Y_{1} + Y_{2}$。负荷损失概率为 $LOLP_{\\text{bin}} = \\mathbb{P}(A^{\\text{bin}}  L)$。\n- 假设：所有机组可用性（$X_{1}$、$X_{2}$、$Y_{1}$、$Y_{2}$）均独立。净负荷 $L$ 与发电机状态无关。\n- 任务：计算比率 $R = \\dfrac{LOLP_{\\text{multi}}}{LOLP_{\\text{bin}}}$，并四舍五入至四位有效数字。\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在电力系统可靠性和资源充裕性评估的原理方面有充分的依据。容量停运概率表 (COPT) 和负荷损失概率 (LOLP) 的使用是行业和学术界的标准实践。多状态和双状态停运模型的构建是该领域的一个基本概念。\n- **适定性**：该问题在数学上是适定的。所有变量、概率和系统参数都有明确定义。目标清晰，可以导出一个唯一的、可计算的解。独立性假设允许直接应用概率论（分布的卷积）。每个机组的状态概率之和为 $1$（$0.92+0.06+0.02=1.00$ 和 $0.90+0.07+0.03=1.00$）。\n- **客观性**：问题陈述使用了精确、客观和技术性的语言，没有歧义或主观陈述。\n\n步骤3：结论与行动\n问题是有效的。它在科学上是合理的、自洽的且适定的。可以继续求解过程。\n\n解题过程分为三部分：首先，计算 $LOLP_{\\text{multi}}$；其次，计算 $LOLP_{\\text{bin}}$；第三，计算它们的比率。\n\n第1部分：计算 $LOLP_{\\text{multi}}$\n多状态模型中的总可用容量为 $A = B + X_{1} + X_{2}$。由于 $B = 700$ MW 是一个常数，我们首先确定可变容量之和 $S = X_{1} + X_{2}$ 的概率分布。由于 $X_{1}$ 和 $X_{2}$ 是独立的，任何组合状态的概率是它们各自概率的乘积。对于机组对 $(X_{1}, X_{2})$，存在 $3 \\times 3 = 9$ 种可能的状态。\n\n$S = X_{1} + X_{2}$ 的可能结果及其概率如下：\n- $S = 500 + 400 = 900$ MW: $P(S=900) = P(X_{1}=500)P(X_{2}=400) = 0.92 \\times 0.90 = 0.8280$。\n- $S = 500 + 200 = 700$ MW: $P = P(X_{1}=500)P(X_{2}=200) = 0.92 \\times 0.07 = 0.0644$。\n- $S = 500 + 0 = 500$ MW: $P = P(X_{1}=500)P(X_{2}=0) = 0.92 \\times 0.03 = 0.0276$。\n- $S = 300 + 400 = 700$ MW: $P = P(X_{1}=300)P(X_{2}=400) = 0.06 \\times 0.90 = 0.0540$。\n- $S = 300 + 200 = 500$ MW: $P = P(X_{1}=300)P(X_{2}=200) = 0.06 \\times 0.07 = 0.0042$。\n- $S = 300 + 0 = 300$ MW: $P = P(X_{1}=300)P(X_{2}=0) = 0.06 \\times 0.03 = 0.0018$。\n- $S = 0 + 400 = 400$ MW: $P = P(X_{1}=0)P(X_{2}=400) = 0.02 \\times 0.90 = 0.0180$。\n- $S = 0 + 200 = 200$ MW: $P = P(X_{1}=0)P(X_{2}=200) = 0.02 \\times 0.07 = 0.0014$。\n- $S = 0 + 0 = 0$ MW: $P = P(X_{1}=0)P(X_{2}=0) = 0.02 \\times 0.03 = 0.0006$。\n\n接下来，我们将这些结果分组以形成 $S$ 的概率分布：\n- $P(S=900) = 0.8280$。\n- $P(S=700) = 0.0644 + 0.0540 = 0.1184$。\n- $P(S=500) = 0.0276 + 0.0042 = 0.0318$。\n- $P(S=400) = 0.0180$。\n- $P(S=300) = 0.0018$。\n- $P(S=200) = 0.0014$。\n- $P(S=0) = 0.0006$。\n\n总可用容量 $A=700+S$ 的分布即为多状态 COPT：\n- $P(A=1600) = P(S=900) = 0.8280$。\n- $P(A=1400) = P(S=700) = 0.1184$。\n- $P(A=1200) = P(S=500) = 0.0318$。\n- $P(A=1100) = P(S=400) = 0.0180$。\n- $P(A=1000) = P(S=300) = 0.0018$。\n- $P(A=800) = P(S=200) = 0.0014$。\n- $P(A=700) = P(S=0) = 0.0006$。\n\n负荷损失概率为 $LOLP_{\\text{multi}} = \\mathbb{P}(A  L)$，其中 $L=1500$ MW。这对应于所有 $A$ 小于 $1500$ MW 的状态。\n$LOLP_{\\text{multi}} = P(A=1400) + P(A=1200) + P(A=1100) + P(A=1000) + P(A=800) + P(A=700)$\n$LOLP_{\\text{multi}} = 0.1184 + 0.0318 + 0.0180 + 0.0018 + 0.0014 + 0.0006 = 0.1720$。\n\n第2部分：计算 $LOLP_{\\text{bin}}$\n双状态模型中的总可用容量为 $A^{\\text{bin}} = B + Y_{1} + Y_{2}$。\n双状态概率分布为：\n- 对于 $Y_{1}$：$P(Y_{1}=500) = 1 - q_{1} = 1 - 0.02 = 0.98$；$P(Y_{1}=0) = q_{1} = 0.02$。\n- 对于 $Y_{2}$：$P(Y_{2}=400) = 1 - q_{2} = 1 - 0.03 = 0.97$；$P(Y_{2}=0) = q_{2} = 0.03$。\n\n令 $S^{\\text{bin}} = Y_{1} + Y_{2}$。$S^{\\text{bin}}$ 的分布由 $2 \\times 2 = 4$ 个独立结果导出：\n- $S^{\\text{bin}} = 500 + 400 = 900$ MW: $P(S^{\\text{bin}}=900) = P(Y_{1}=500)P(Y_{2}=400) = 0.98 \\times 0.97 = 0.9506$。\n- $S^{\\text{bin}} = 500 + 0 = 500$ MW: $P(S^{\\text{bin}}=500) = P(Y_{1}=500)P(Y_{2}=0) = 0.98 \\times 0.03 = 0.0294$。\n- $S^{\\text{bin}} = 0 + 400 = 400$ MW: $P(S^{\\text{bin}}=400) = P(Y_{1}=0)P(Y_{2}=400) = 0.02 \\times 0.97 = 0.0194$。\n- $S^{\\text{bin}} = 0 + 0 = 0$ MW: $P(S^{\\text{bin}}=0) = P(Y_{1}=0)P(Y_{2}=0) = 0.02 \\times 0.03 = 0.0006$。\n\n总可用容量 $A^{\\text{bin}}=700+S^{\\text{bin}}$ 的分布即为双状态 COPT：\n- $P(A^{\\text{bin}}=1600) = P(S^{\\text{bin}}=900) = 0.9506$。\n- $P(A^{\\text{bin}}=1200) = P(S^{\\text{bin}}=500) = 0.0294$。\n- $P(A^{\\text{bin}}=1100) = P(S^{\\text{bin}}=400) = 0.0194$。\n- $P(A^{\\text{bin}}=700) = P(S^{\\text{bin}}=0) = 0.0006$。\n\n负荷损失概率为 $LOLP_{\\text{bin}} = \\mathbb{P}(A^{\\text{bin}}  L)$，其中 $L=1500$ MW。\n$LOLP_{\\text{bin}} = P(A^{\\text{bin}}=1200) + P(A^{\\text{bin}}=1100) + P(A^{\\text{bin}}=700)$\n$LOLP_{\\text{bin}} = 0.0294 + 0.0194 + 0.0006 = 0.0494$。\n\n第3部分：计算比率 $R$\n无量纲比率 $R$ 定义为 $R = \\dfrac{LOLP_{\\text{multi}}}{LOLP_{\\text{bin}}}$。\n代入计算出的值：\n$R = \\dfrac{0.1720}{0.0494} \\approx 3.4817813765...$\n\n四舍五入到四位有效数字，我们得到 $R = 3.482$。这个结果表明，与更详细的多状态模型相比，忽略降额状态并将其建模为完全可用（此处的双状态模型方法）会显著低估负荷损失概率。",
            "answer": "$$\\boxed{3.482}$$"
        },
        {
            "introduction": "概率性充裕度的原理对于评估储能等新兴技术的价值至关重要，因为这些技术同时受到功率和能量的限制。本练习将引入“有效承载能力”（$ELCC$）的概念，这是一个基于“期望缺电量”（$EUE$）准则来量化资源对可靠性贡献的关键指标。通过编写算法来求解不同储能时长的储能设备的 $ELCC$，您将深入了解储能资产的价值与其所在电力系统的缺电事件持续时间之间的内在联系 。这个练习将充裕度理论与整合能量受限资源的实际挑战直接联系起来。",
            "id": "4119026",
            "problem": "考虑一个程式化的资源充裕度设定，其中短缺事件由小时短缺剖面表示。可靠性目标基于未服务能源（EUE），储能设备的有效承载能力（ELCC）定义为：在系统中添加该设备后，系统能够承受的均匀负荷增量（以兆瓦为单位的恒定值），同时保持总EUE与未添加设备时的基准EUE相等。假设存在以下基础和约束：\n\n- 未服务能源（EUE）定义为需求短缺对时间的积分，等效于离散小时的总和：对于一个事件中的短缺剖面 $\\{d_t\\}$，其EUE为 $\\sum_t d_t$，其中 $d_t \\ge 0$，单位为兆瓦时。\n- 有效承载能力（ELCC）定义为恒定的负荷增量 $L$（单位为兆瓦），该增量可均匀地添加到所有事件小时中，使得添加资源和负荷后的EUE等于未添加资源的基准系统的EUE。\n- 储能设备约束：\n  - 放电功率限制 $P$（单位为兆瓦）。\n  - 可用能量容量 $E$（单位为兆瓦时）。\n  - 往返效率等于 $1$。\n  - 完全预见和事件独立性：设备在每次短缺事件开始时都处于满电状态，并能在事件之间无约束地充电；无事件间耦合。\n- 事件是不相交的，并且仅涵盖存在基准短缺的小时；在这些小时之外，有足够的裕度，增加负荷不会产生新的短缺。\n\n建模假设和目标：\n- 对于每个持续时间为 $h_e$ 小时、短缺剖面为 $\\{d_{e,t}\\}_{t=1}^{h_e}$ 的事件 $e$，在均匀负荷增量 $L$ 和最优EUE最小化调度下，设备在小时 $t$ 的放电量 $x_{e,t}$ 受限于 $0 \\leq x_{e,t} \\leq \\min\\{P, d_{e,t} + L\\}$，并且该事件的总放电量满足 $\\sum_{t=1}^{h_e} x_{e,t} \\leq E$。设备通过在这些约束下减少短缺来最小化EUE。\n- 在所有事件中，考虑设备和负荷增量 $L$ 时的EUE为 $\\sum_e \\left[\\sum_{t=1}^{h_e} (d_{e,t} + L) - \\sum_{t=1}^{h_e} x_{e,t}\\right]$。\n\n根据以上信息，以纯数学形式推导ELCC方程，并实现一个算法，用于在给定一组事件和设备参数 $(P,E)$ 的情况下，假设采用最优EUE最小化调度，计算 $L$。您的程序必须：\n- 使用推导出的最优调度特性，计算在负荷增量 $L$ 下，事件 $e$ 中输送的能量为 $\\min\\left\\{E, \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\}\\right\\}$，然后求解满足以下条件的ELCC $L$：\n$$\n\\sum_e \\min\\left\\{E, \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\}\\right\\} \\;=\\; L \\sum_e h_e \\, .\n$$\n- 计算在相同 $P$ 下两种设备的ELCC：一个短时储能设备（$E = 2P$）和一个长时储能设备（$E = 20P$）。\n- 以兆瓦为单位报告ELCC值，并将长时储能ELCC与短时储能ELCC的比率报告为不带百分号的小数。\n- 使用以下测试套件，所有短缺均以兆瓦表示，持续时间以小时表示。对于每种情况，都指定了 $P$，事件是小时短缺的列表：\n\n测试用例1（混合短时和长时事件）：\n- $P = 100$\n- 事件：\n  - 事件1：持续时间2小时，短缺量 {120, 140}。\n  - 事件2：持续时间12小时，短缺量 {85, 95, 105, 115, 110, 100, 90, 80, 70, 60, 55, 50}。\n  - 事件3：持续时间1小时，短缺量 {200}。\n  - 事件4：持续时间18小时，短缺量 {60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60}。\n\n测试用例2（仅短时事件）：\n- $P = 100$\n- 事件：\n  - 事件1：持续时间1小时，短缺量 {70}。\n  - 事件2：持续时间2小时，短缺量 {80, 90}。\n  - 事件3：持续时间2小时，短缺量 {50, 45}。\n\n测试用例3（仅长时事件）：\n- $P = 100$\n- 事件：\n  - 事件1：持续时间15小时，短缺量 {90, 95, 100, 105, 110, 115, 120, 125, 130, 125, 120, 115, 110, 105, 100}。\n  - 事件2：持续时间20小时，短缺量 {70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70}。\n\n所有计算出的ELCC均以兆瓦表示。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个包含三个数字的列表 $[L_{\\text{short}}, L_{\\text{long}}, L_{\\text{long}}/L_{\\text{short}}]$。例如，最终输出格式必须与以下完全一样：\n$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$\n其中 a_1, b_1 和 c_1 替换为数值。",
            "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于资源充裕度评估的原则，在数学上是适定的，并提供了一套完整且一致的数据和定义。\n\n目标是推导有效承载能力（ELCC）的控制方程，并实现一个数值算法来为指定的测试用例求解。ELCC（用 $L$ 表示）代表了在增加新资源（本例中为储能设备）后，电力系统能够承受的恒定负荷增量，同时保持相同的可靠性水平，此处的可靠性由期望未服务能源（EUE）衡量。\n\n首先，我们根据问题的定义建立数学基础。没有储能设备时的基准EUE是所有短缺事件中所有能量短缺的总和：\n$$ EUE_{base} = \\sum_e \\sum_{t=1}^{h_e} d_{e,t} $$\n其中 $d_{e,t}$ 是事件 $e$（持续时间为 $h_e$ 小时）在小时 $t$ 的能量短缺，单位为兆瓦时（MW-h）。\n\n当添加储能设备并对系统施加 $L$ 兆瓦（MW）的均匀负荷增量时，事件 $e$ 的每小时 $t$ 的短缺变为 $(d_{e,t} + L)$。储能设备调度能量 $x_{e,t}$ 以缓解这个新的、更大的短缺。新的EUE为：\n$$ EUE_{new} = \\sum_e \\sum_{t=1}^{h_e} (d_{e,t} + L - x_{e,t}) $$\nELCC的定义要求可靠性水平保持不变，即 $EUE_{new} = EUE_{base}$。令这两个表达式相等可得：\n$$ \\sum_e \\sum_{t=1}^{h_e} (d_{e,t} + L - x_{e,t}) = \\sum_e \\sum_{t=1}^{h_e} d_{e,t} $$\n通过从等式两边消去 $\\sum_e \\sum_t d_{e,t}$ 项并重新整理，我们得到一个基本关系：\n$$ \\sum_e \\sum_{t=1}^{h_e} L = \\sum_e \\sum_{t=1}^{h_e} x_{e,t} $$\n$$ L \\sum_e h_e = \\sum_e \\left(\\sum_{t=1}^{h_e} x_{e,t}\\right) $$\n此方程表明，由均匀负荷增量 $L$ 增加到系统的总能量，必须完全被储能设备在所有事件中释放的总能量所抵消。\n\n下一步是确定总放电能量 $\\sum_e (\\sum_t x_{e,t})$。问题为每个独立事件指定了在完全预见下的最优EUE最小化调度策略。对于一个给定的事件 $e$，设备会尽可能地减少小时短缺 $(d_{e,t} + L)$。任何小时 $t$ 的放电量 $x_{e,t}$ 都受到设备最大功率输出 $P$ 的限制。因此，为了最小化剩余短缺，设备将放电等于新的短缺量，直到其功率上限：\n$$ x_{e,t} = \\min\\{P, d_{e,t} + L\\} $$\n这种贪婪小时调度策略对于在一个事件内最小化EUE是最优的，因为除了该事件的总能量约束外，没有其他时间上的关联。\n\n设备在事件 $e$ 期间可能放出的总潜在能量是这些最优小时放电量的总和：\n$$ \\text{Potential Discharge}_e = \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\} $$\n然而，设备也受其总可用能量容量 $E$ 的约束。因此，在事件 $e$ 期间实际释放的总能量是潜在放电量和可用能量中的较小者：\n$$ \\sum_{t=1}^{h_e} x_{e,t} = \\min\\left\\{E, \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\}\\right\\} $$\n\n将这个总放电能量的表达式代入我们推导出的关系式中，得到ELCC $L$ 的最终方程：\n$$ L \\sum_e h_e = \\sum_e \\min\\left\\{E, \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\}\\right\\} $$\n这是一个关于单变量 $L$ 的非线性方程，必须通过数值方法求解。\n\n为了实现算法，我们将方程重新排列成一个求根问题。我们定义一个函数 $f(L)$：\n$$ f(L) = \\left( \\sum_e \\min\\left\\{E, \\sum_{t=1}^{h_e} \\min\\{P, d_{e,t} + L\\}\\right\\} \\right) - L \\sum_e h_e $$\n我们需要找到 $L \\ge 0$ 的值，使得 $f(L) = 0$。\n\n函数 $f(L)$ 可以被证明是连续且单调非增的。第一项代表总输送能量，是关于 $L$ 的分段线性、凹、非减函数的和，其随 $L$ 增长的速率上限为 $\\sum_e h_e$。第二项 $-L \\sum_e h_e$ 以 $-\\sum_e h_e$ 的斜率线性递减。因此，整个函数 $f(L)$ 是非增的。这一性质使其非常适合使用如二分法或Brent方法等稳健的数值求根算法。\n\n算法流程如下：\n$1$. 对于一个给定的测试用例（一组事件短缺剖面和功率容量 $P$），为短时（$E_{short} = 2P$）和长时（$E_{long} = 20P$）储能设备定义参数。\n$2$. 对每种设备配置（$P, E$），求解方程 $f(L)=0$。\n$3$. 使用数值求解器，例如 `scipy.optimize.brentq`。这需要找到一个搜索区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 异号。一个自然的下界是 $a=0$。在 $L=0$ 时，输送的能量为非负，因此 $f(0) \\ge 0$。可以找到一个上界 $b$ 使得 $f(b)  0$；通常 $b=P$ 或 $b=2P$ 这样的值就足够了，因为ELCC在物理上受设备功率额定的限制。如果 $f(b)$ 不是负数，可以迭代增加上界，直到它将根包含在内。\n$4$. 求解器找到的根即为ELCC值 $L$，单位是兆瓦。\n$5$. 对每个测试用例和两种储能时长重复此过程。然后计算长时ELCC与短时ELCC的比率。\n$6$. 最终结果 $[L_{\\text{short}}, L_{\\text{long}}, L_{\\text{long}}/L_{\\text{short}}]$ 被汇总用于所有测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef elcc_equation(L, P, E, events, total_h):\n    \"\"\"\n    Represents the function f(L) = 0 to be solved for the ELCC.\n    f(L) = (Total Delivered Energy) - (Total Added Load Energy)\n    \n    Args:\n        L (float): The ELCC value (variable to be solved for).\n        P (float): Power capacity of the storage device (MW).\n        E (float): Energy capacity of the storage device (MWh).\n        events (list of np.ndarray): A list where each element is a NumPy array\n                                     representing the deficit profile of an event (MW).\n        total_h (int): Pre-calculated total duration of all events in hours.\n        \n    Returns:\n        float: The value of the function f(L).\n    \"\"\"\n    total_delivered_energy = 0.0\n    for deficit_profile in events:\n        # The new deficit in each hour is the original deficit plus the added load L.\n        # The discharge in each hour is capped by the power capacity P.\n        hourly_discharge = np.minimum(P, deficit_profile + L)\n        \n        # The total potential energy that could be delivered in this event is the\n        # sum of the hourly discharges.\n        potential_event_delivery = np.sum(hourly_discharge)\n        \n        # The actual energy delivered is also capped by the storage's energy capacity E.\n        actual_event_delivery = min(E, potential_event_delivery)\n        \n        # Accumulate the energy delivered across all events.\n        total_delivered_energy += actual_event_delivery\n        \n    # The function's value is the difference between energy supplied by storage\n    # and energy required by the added load. We seek the root where this is zero.\n    return total_delivered_energy - L * total_h\n\ndef solve_for_case(case):\n    \"\"\"\n    Solves for the ELCC for a single test case with both short- and long-duration storage.\n\n    Args:\n        case (tuple): A tuple containing P (int) and a list of event deficit lists.\n    \n    Returns:\n        list: A list containing [L_short, L_long, ratio].\n    \"\"\"\n    P, event_list = case\n    \n    # Convert lists of deficits to NumPy arrays for efficient calculations.\n    events = [np.array(d, dtype=float) for d in event_list]\n    \n    # Pre-calculate the total duration of all events.\n    total_h = sum(len(d) for d in events)\n    \n    # Define energy capacities for short- and long-duration storage.\n    E_short = 2.0 * P\n    E_long = 20.0 * P\n    \n    # --- Solve for short-duration storage ELCC (L_short) ---\n    L_short = 0.0\n    # Check if f(0) is non-positive, which implies L=0 is the solution.\n    if elcc_equation(0, P, E_short, events, total_h) > 1e-9:\n        a, b = 0.0, float(P) * 2.0 # Set a search bracket [a, b]\n        # Ensure the bracket contains the root (f(a) and f(b) have opposite signs).\n        # Iteratively expand the upper bound if necessary.\n        while elcc_equation(b, P, E_short, events, total_h) > 0:\n            b *= 2.0\n        L_short = brentq(elcc_equation, a, b, args=(P, E_short, events, total_h))\n        \n    # --- Solve for long-duration storage ELCC (L_long) ---\n    L_long = 0.0\n    if elcc_equation(0, P, E_long, events, total_h) > 1e-9:\n        a, b = 0.0, float(P) * 2.0\n        while elcc_equation(b, P, E_long, events, total_h) > 0:\n            b *= 2.0\n        L_long = brentq(elcc_equation, a, b, args=(P, E_long, events, total_h))\n\n    # Calculate the ratio, handling potential division by zero.\n    ratio = L_long / L_short if L_short > 1e-9 else 0.0\n    \n    return [L_short, L_long, ratio]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    test_cases = [\n        (100, [\n            [120, 140],\n            [85, 95, 105, 115, 110, 100, 90, 80, 70, 60, 55, 50],\n            [200],\n            [60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60]\n        ]),\n        (100, [\n            [70],\n            [80, 90],\n            [50, 45]\n        ]),\n        (100, [\n            [90, 95, 100, 105, 110, 115, 120, 125, 130, 125, 120, 115, 110, 105, 100],\n            [70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70]\n        ])\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_for_case(case)\n        results.append(result)\n\n    # Format the results into the required string format \"[[r1_1, r1_2, ...], [r2_1, ...]]\"\n    result_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}