{
    "hands_on_practices": [
        {
            "introduction": "Procuring operating reserves is not an isolated decision; it is deeply intertwined with the primary task of dispatching energy to meet load. This exercise delves into the foundational concept of co-optimization, a cornerstone of modern electricity market design. You will formulate and solve a problem to simultaneously determine the most cost-effective energy dispatch and reserve allocation for a set of generators, learning how these two products compete for the same finite generator capacity. ",
            "id": "4117713",
            "problem": "An Independent System Operator (ISO) co-optimizes energy and upward operating reserves in a single-hour scheduling problem for two thermal generating units. Upward operating reserve is defined as headroom that can be converted to energy within the response timeline. The ISO uses linear cost models.\n\nFundamental definitions and assumptions:\n- Power balance requires that the sum of scheduled energy equals the load: the energy outputs $p_1$ and $p_2$ must satisfy $\\sum_{i=1}^{2} p_i = L$.\n- Upward reserve requirement requires that the sum of scheduled upward reserves equals or exceeds the requirement: the reserve allocations $r_1$ and $r_2$ must satisfy $\\sum_{i=1}^{2} r_i \\geq R^{\\uparrow}$.\n- Headroom constraint requires that scheduled energy plus scheduled upward reserve cannot exceed the nameplate capacity of each unit, so $p_i + r_i \\leq P_i^{\\max}$ for each unit $i$.\n- Nonnegativity requires $p_i \\geq 0$ and $r_i \\geq 0$.\n- The ISO minimizes total cost using constant marginal energy costs $c_i$ and constant reserve costs $c_i^{R}$.\n\nData:\n- Nameplate capacities $P^{\\max} = [500, 300]$ MW.\n- Marginal energy costs $c = [20, 30]$ $/MWh.\n- Marginal upward reserve costs $c^{R} = [5, 8]$ $/MW.\n- Load $L = 700$ MW.\n- Upward reserve requirement $R^{\\uparrow} = 100$ MW.\n\nTask:\nStarting only from the definitions of power balance, reserve requirement, headroom, nonnegativity, and linear cost minimization, formulate the co-optimization problem and solve it analytically. Determine the optimal energy dispatch $(p_1^{\\star}, p_2^{\\star})$ and upward reserve allocations $(r_1^{\\star}, r_2^{\\star})$ that minimize total cost while satisfying all constraints.\n\nExpress the final energy schedule and reserve allocation for the two units as a single row matrix $(p_1^{\\star}, p_2^{\\star}, r_1^{\\star}, r_2^{\\star})$ in MW. No rounding is required.",
            "solution": "The problem statement has been evaluated and is deemed valid. It constitutes a well-posed linear programming problem, grounded in the standard principles of power system optimization. All data and constraints are self-contained, consistent, and scientifically sound.\n\nThe task is to determine the optimal energy dispatch $(p_1^{\\star}, p_2^{\\star})$ and upward reserve allocations $(r_1^{\\star}, r_2^{\\star})$ for two generating units. The objective is to minimize the total cost of energy and reserve, subject to a set of operational constraints.\n\nFirst, we formulate the optimization problem based on the provided data and definitions.\nThe decision variables are the energy output $p_i$ and reserve allocation $r_i$ for each unit $i \\in \\{1, 2\\}$.\nThe objective function to be minimized is the total cost $C$:\n$$ C(p_1, p_2, r_1, r_2) = c_1 p_1 + c_2 p_2 + c_1^{R} r_1 + c_2^{R} r_2 $$\nSubstituting the given cost coefficients $c = [20, 30]$ and $c^{R} = [5, 8]$:\n$$ \\min_{p_1, p_2, r_1, r_2} \\left( 20 p_1 + 30 p_2 + 5 r_1 + 8 r_2 \\right) $$\n\nThe optimization is subject to the following constraints:\n1.  Power balance: $p_1 + p_2 = L = 700$\n2.  Upward reserve requirement: $r_1 + r_2 \\geq R^{\\uparrow} = 100$\n3.  Headroom constraint for unit 1: $p_1 + r_1 \\leq P_1^{\\max} = 500$\n4.  Headroom constraint for unit 2: $p_2 + r_2 \\leq P_2^{\\max} = 300$\n5.  Nonnegativity constraints: $p_1, p_2, r_1, r_2 \\geq 0$\n\nA key step in solving this problem is to analyze the interplay between the constraints. Let us sum the two headroom constraints (3) and (4):\n$$ (p_1 + r_1) + (p_2 + r_2) \\leq P_1^{\\max} + P_2^{\\max} $$\n$$ (p_1 + p_2) + (r_1 + r_2) \\leq 500 + 300 $$\n$$ (p_1 + p_2) + (r_1 + r_2) \\leq 800 $$\n\nFrom the power balance constraint (1), we know that $p_1 + p_2 = 700$. Substituting this into the summed inequality:\n$$ 700 + (r_1 + r_2) \\leq 800 $$\nThis simplifies to:\n$$ r_1 + r_2 \\leq 100 $$\n\nWe now have two constraints on the total reserve: $r_1 + r_2 \\geq 100$ from the reserve requirement and $r_1 + r_2 \\leq 100$ derived from the headroom constraints. The only way to satisfy both is for the equality to hold:\n$$ r_1 + r_2 = 100 $$\nThis implies that the upward reserve requirement constraint must be binding at the optimum.\n\nFurthermore, substituting $r_1 + r_2 = 100$ back into the summed headroom inequality gives:\n$$ 700 + 100 \\leq 800 \\implies 800 \\leq 800 $$\nThis shows that the summed headroom inequality is also binding. Since $p_1 + r_1 \\leq 500$ and $p_2 + r_2 \\leq 300$, their sum can only equal $800$ if both individual headroom constraints are binding. Therefore:\n$$ p_1 + r_1 = 500 $$\n$$ p_2 + r_2 = 300 $$\n\nThe original optimization problem is now reduced to solving a system of linear equations, where the solution must be selected to minimize the cost function. We have the following system:\n(a) $p_1 + p_2 = 700$\n(b) $r_1 + r_2 = 100$\n(c) $p_1 + r_1 = 500$\n(d) $p_2 + r_2 = 300$\n\nWe can express all four variables in terms of a single variable, for instance $p_1$.\nFrom (c), we get $r_1 = 500 - p_1$.\nFrom (a), we get $p_2 = 700 - p_1$.\nFrom (d), we get $r_2 = 300 - p_2 = 300 - (700 - p_1) = p_1 - 400$.\nA quick check shows these expressions are consistent with (b): $r_1 + r_2 = (500 - p_1) + (p_1 - 400) = 100$.\n\nNow, we substitute these expressions into the cost function to formulate it in terms of $p_1$ only:\n$$ C(p_1) = 20 p_1 + 30(700 - p_1) + 5(500 - p_1) + 8(p_1 - 400) $$\n$$ C(p_1) = 20 p_1 + 21000 - 30 p_1 + 2500 - 5 p_1 + 8 p_1 - 3200 $$\n$$ C(p_1) = (20 - 30 - 5 + 8) p_1 + (21000 + 2500 - 3200) $$\n$$ C(p_1) = -7 p_1 + 20300 $$\n\nTo minimize $C(p_1)$, which is a linear function with a negative slope, we must make $p_1$ as large as possible. The feasible range for $p_1$ is determined by the nonnegativity constraints on all variables:\n- $p_1 \\geq 0$\n- $p_2 = 700 - p_1 \\geq 0 \\implies p_1 \\leq 700$\n- $r_1 = 500 - p_1 \\geq 0 \\implies p_1 \\leq 500$\n- $r_2 = p_1 - 400 \\geq 0 \\implies p_1 \\geq 400$\n\nCombining these inequalities, the feasible range for $p_1$ is $p_1 \\in [400, 500]$.\nTo minimize $C(p_1) = -7 p_1 + 20300$, we must select the maximum value of $p_1$ in this interval. Thus, the optimal value is:\n$$ p_1^{\\star} = 500~\\text{MW} $$\n\nWe can now determine the optimal values for the other variables by back-substitution:\n- $p_2^{\\star} = 700 - p_1^{\\star} = 700 - 500 = 200~\\text{MW}$\n- $r_1^{\\star} = 500 - p_1^{\\star} = 500 - 500 = 0~\\text{MW}$\n- $r_2^{\\star} = p_1^{\\star} - 400 = 500 - 400 = 100~\\text{MW}$\n\nThe optimal solution is $(p_1^{\\star}, p_2^{\\star}, r_1^{\\star}, r_2^{\\star}) = (500, 200, 0, 100)$. All values are in MW and satisfy their respective nonnegativity constraints. The solution is unique and minimizes the total cost.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n500 & 200 & 0 & 100\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While traditional reserve modeling often centers on the available headroom of synchronous generators, the integration of energy-limited resources like batteries requires a more nuanced approach. This practice challenges you to move beyond simple power capacity and model the reserve capability of a battery from first principles. You will derive and apply constraints based on its state of charge ($E$), power limits ($P^{\\max}$), and efficiency ($\\eta$), revealing the critical interplay between energy and power that governs storage participation in reserve markets. ",
            "id": "4117722",
            "problem": "A battery energy storage system with total energy capacity $S=200$ MWh and one-way power limit $P^{\\max}=80$ MW participates in a single $10$-minute reserve interval. The round-trip efficiency is $\\eta=0.9$, and you may assume symmetric one-way efficiencies so that the discharge efficiency $\\eta_{\\mathrm{d}}$ and the charge efficiency $\\eta_{\\mathrm{c}}$ satisfy $\\eta_{\\mathrm{d}}=\\eta_{\\mathrm{c}}=\\sqrt{\\eta}$. The stored energy at the start of the interval is $E_0=50$ MWh, and the minimum allowable stored energy is $E_{\\min}=40$ MWh. The system operator schedules a constant energy-market discharge of $p_{\\mathrm{E}}=30$ MW over the entire $10$-minute interval. In addition, the battery may offer upward reserve $r$ (in MW), which, if fully activated for the entire interval, requires the battery to increase its discharge from the baseline by $r$ MW while still meeting the scheduled energy dispatch.\n\nUsing only the fundamental definitions that power is the rate of energy transfer and that round-trip efficiency is the product of one-way efficiencies, derive from first principles the constraints that ensure deliverability of the upward reserve under worst-case full activation. Then compute the maximum deliverable $10$-minute upward reserve $r^{\\star}$ in MW for this interval given the data above. Round your final numerical value to four significant figures. Express the final answer in MW.",
            "solution": "Let $E(t)$ be the energy stored in the battery at time $t$. Let $p_{\\mathrm{grid}}(t)$ be the power delivered to the grid; by convention, $p_{\\mathrm{grid}} > 0$ for discharge. Power is the rate of energy transfer, so $\\frac{dE}{dt}$ is related to power.\n\nThe efficiency model relates the power at the grid connection point, $p_{\\mathrm{grid}}$, to the rate of change of internal stored energy. During discharge, to deliver power $p_{\\mathrm{grid}}$ to the grid, a larger power, $p_{\\mathrm{internal}} = \\frac{p_{\\mathrm{grid}}}{\\eta_{\\mathrm{d}}}$, must be drawn from the battery's storage. This withdrawal decreases the stored energy. Thus, the governing differential equation for the stored energy during discharge is:\n$$\n\\frac{dE}{dt} = -p_{\\mathrm{internal}}(t) = -\\frac{p_{\\mathrm{grid}}(t)}{\\eta_{\\mathrm{d}}}\n$$\nThe problem specifies a baseline discharge of $p_{\\mathrm{E}}$ and an upward reserve capacity of $r$. The worst-case for deliverability is the full activation of this reserve for the entire duration of the interval, $\\Delta t$. In this scenario, the battery delivers a constant total power to the grid:\n$$\np_{\\mathrm{grid}}(t) = p_{\\mathrm{E}} + r\n$$\nSince $p_{\\mathrm{grid}}$ is constant, the rate of change of energy is also constant:\n$$\n\\frac{dE}{dt} = -\\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}}\n$$\nTo find the total change in energy, we integrate this rate over the interval duration $\\Delta t = 10 \\text{ min} = \\frac{10}{60} \\text{ h} = \\frac{1}{6} \\text{ h}$. Let $E_0$ be the energy at the start of the interval and $E_f$ be the energy at the end.\n$$\n\\int_{E_0}^{E_f} dE = \\int_{0}^{\\Delta t} \\left(-\\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}}\\right) dt\n$$\n$$\nE_f - E_0 = -\\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}} \\Delta t\n$$\nRearranging for the final energy, we get:\n$$\nE_f = E_0 - \\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}} \\Delta t\n$$\nFor the reserve offer $r$ to be deliverable, two fundamental constraints must be met.\n\n**1. Power Constraint:** The total power delivered to the grid must not exceed the battery's one-way power limit, $P^{\\max}$.\n$$\np_{\\mathrm{E}} + r \\le P^{\\max}\n$$\nThis gives the first upper bound on $r$:\n$$\nr \\le P^{\\max} - p_{\\mathrm{E}}\n$$\n\n**2. Energy Constraint:** The stored energy must remain above the minimum allowable level, $E_{\\min}$, at all times. Since the battery is continuously discharging, the minimum energy level will occur at the end of the interval, $t=\\Delta t$. Therefore, we must have $E_f \\ge E_{\\min}$.\n$$\nE_0 - \\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}} \\Delta t \\ge E_{\\min}\n$$\nWe solve this inequality for $r$:\n$$\nE_0 - E_{\\min} \\ge \\frac{p_{\\mathrm{E}} + r}{\\eta_{\\mathrm{d}}} \\Delta t\n$$\n$$\n\\frac{(E_0 - E_{\\min})\\eta_{\\mathrm{d}}}{\\Delta t} \\ge p_{\\mathrm{E}} + r\n$$\nThis yields the second upper bound on $r$:\n$$\nr \\le \\frac{(E_0 - E_{\\min})\\eta_{\\mathrm{d}}}{\\Delta t} - p_{\\mathrm{E}}\n$$\nThe maximum deliverable reserve, $r^{\\star}$, is the largest value of $r$ that satisfies both constraints. This value is the minimum of the two upper bounds.\n$$\nr^{\\star} = \\min\\left( P^{\\max} - p_{\\mathrm{E}}, \\frac{(E_0 - E_{\\min})\\eta_{\\mathrm{d}}}{\\Delta t} - p_{\\mathrm{E}} \\right)\n$$\nNow, we substitute the numerical values provided in the problem statement.\n-   $P^{\\max} = 80$ MW\n-   $p_{\\mathrm{E}} = 30$ MW\n-   $E_0 = 50$ MWh\n-   $E_{\\min} = 40$ MWh\n-   $\\Delta t = \\frac{1}{6}$ h\n-   $\\eta_{\\mathrm{d}} = \\sqrt{\\eta} = \\sqrt{0.9}$\n\nFirst, we calculate the power-limited bound:\n$$\nr_{\\mathrm{P-bound}} = P^{\\max} - p_{\\mathrm{E}} = 80 - 30 = 50 \\text{ MW}\n$$\nNext, we calculate the energy-limited bound:\n$$\nr_{\\mathrm{E-bound}} = \\frac{(E_0 - E_{\\min})\\eta_{\\mathrm{d}}}{\\Delta t} - p_{\\mathrm{E}} = \\frac{(50 - 40) \\text{ MWh} \\times \\sqrt{0.9}}{\\frac{1}{6} \\text{ h}} - 30 \\text{ MW}\n$$\n$$\nr_{\\mathrm{E-bound}} = \\frac{10 \\times \\sqrt{0.9}}{\\frac{1}{6}} \\text{ MW} - 30 \\text{ MW}\n$$\n$$\nr_{\\mathrm{E-bound}} = (60 \\sqrt{0.9} - 30) \\text{ MW}\n$$\nNow, we compute the numerical value:\n$$\n\\sqrt{0.9} \\approx 0.948683298\n$$\n$$\nr_{\\mathrm{E-bound}} \\approx (60 \\times 0.948683298 - 30) \\text{ MW}\n$$\n$$\nr_{\\mathrm{E-bound}} \\approx (56.92099788 - 30) \\text{ MW}\n$$\n$$\nr_{\\mathrm{E-bound}} \\approx 26.92099788 \\text{ MW}\n$$\nFinally, we find $r^{\\star}$ by taking the minimum of the two bounds:\n$$\nr^{\\star} = \\min(50, 26.92099788) \\text{ MW} = 26.92099788 \\text{ MW}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nr^{\\star} \\approx 26.92 \\text{ MW}\n$$\nThe maximum deliverable upward reserve is determined by the energy constraint.",
            "answer": "$$\n\\boxed{26.92}\n$$"
        },
        {
            "introduction": "A static megawatt ($MW$) reserve requirement is ultimately a proxy for a dynamic security objective: maintaining system frequency within safe limits following a disturbance. This hands-on coding exercise bridges the gap between static economic optimization and dynamic physical reality. You will implement a time-domain simulation of a power system's frequency response, grounded in the principles of rotational dynamics, to validate whether a given reserve procurement is truly adequate to arrest a frequency drop and ensure system stability. ",
            "id": "4117780",
            "problem": "You are asked to design and implement a numerical test procedure that validates the adequacy of reserves against frequency nadir thresholds using a reduced-order frequency model and a set of historical disturbance scenarios. The modeling must begin from foundational power balance and rotational dynamics principles and culminate in a time-domain simulation that determines whether the frequency nadir remains above a specified threshold for each test scenario.\n\nThe system under study is an aggregated power system characterized by its Center of Inertia (COI) frequency. The fundamental base for this modeling consists of the following well-tested facts and core definitions:\n\n- The instantaneous power imbalance equals the net rate of change of stored rotational kinetic energy plus frequency-sensitive demand response. If $P_{\\mathrm{m}}(t)$ denotes mechanical input power, $P_{\\mathrm{e}}(t)$ denotes electrical demand plus losses, and $P_{\\mathrm{damp}}(t)$ denotes effective frequency-sensitive damping power, then the aggregate balance is\n$$\nP_{\\mathrm{m}}(t) - P_{\\mathrm{e}}(t) - P_{\\mathrm{damp}}(t) = \\frac{dE_{\\mathrm{kin}}(t)}{dt}.\n$$\n- The rotational kinetic energy of the aggregate system is proportional to the square of its angular speed, which is proportional to frequency. Under standard linearization for small deviations about nominal frequency, there exists an aggregate inertia constant $M$ such that\n$$\n\\frac{dE_{\\mathrm{kin}}(t)}{dt} = M \\, \\frac{d\\,\\Delta f(t)}{dt},\n$$\nwhere $\\Delta f(t)$ is the frequency deviation from nominal $f_0$ (so that the actual frequency is $f(t) = f_0 + \\Delta f(t)$). The parameter $M$ has units $\\mathrm{MW\\cdot s/Hz}$.\n- Frequency-sensitive demand (natural load damping) produces an effective damping power $P_{\\mathrm{damp}}(t) = D \\, \\Delta f(t)$, where $D$ has units $\\mathrm{MW/Hz}$.\n\nA historical disturbance is represented as a sudden generation trip of magnitude $\\Delta P$ (in $\\mathrm{MW}$). The reserves scheduled to respond are characterized by:\n- Primary reserve headroom $P_{\\mathrm{res}}$ (in $\\mathrm{MW}$),\n- Activation delay $\\tau$ (in $\\mathrm{s}$),\n- Maximum ramp rate $\\alpha$ (in $\\mathrm{MW/s}$).\nThe reserve activation profile $u(t)$ is modeled as a delayed, capped ramp:\n$$\nu(t) = \\min\\!\\big(P_{\\mathrm{res}},\\, \\alpha \\, \\max(0,\\, t - \\tau)\\big).\n$$\n\nFrom the above, the reduced-order frequency dynamics for the deviation $\\Delta f(t)$ follow from power balance:\n$$\nM \\, \\frac{d\\,\\Delta f(t)}{dt} = - D \\, \\Delta f(t) - \\Delta P + u(t),\n$$\nwith initial condition $\\Delta f(0) = 0$ and nominal frequency $f_0$ (in $\\mathrm{Hz}$). The frequency nadir is the minimum of $f(t)$ over the simulation horizon $[0, T]$:\n$$\nf_{\\mathrm{nadir}} = \\min_{t \\in [0,T]} \\big(f_0 + \\Delta f(t)\\big).\n$$\n\nAdequacy criterion: reserves are adequate if and only if $f_{\\mathrm{nadir}} \\ge f_{\\mathrm{thr}}$, where $f_{\\mathrm{thr}}$ is the nadir threshold (in $\\mathrm{Hz}$).\n\nTask requirements:\n- Implement a time-domain numerical simulation of the above ordinary differential equation to compute $f_{\\mathrm{nadir}}$ for each test case. Use a uniform time step $\\Delta t$ (in $\\mathrm{s}$) and simulate over $T$ seconds. The numerical method must be explicitly described in your solution and must be consistent with the underlying model.\n- All quantities with physical units must be handled in their specified units: power in $\\mathrm{MW}$, frequency in $\\mathrm{Hz}$, and time in $\\mathrm{s}$. The final adequacy decision for each test case must be reported as a boolean.\n- Your program must produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, with booleans expressed in the programming languageâ€™s native boolean literals (e.g., `[True,False,True]`). No other text should be printed.\n\nTest suite:\nUse the following parameter sets, each given as a tuple $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t)$ with units $\\mathrm{MW\\cdot s/Hz}$, $\\mathrm{MW/Hz}$, $\\mathrm{MW}$, $\\mathrm{MW}$, $\\mathrm{MW/s}$, $\\mathrm{s}$, $\\mathrm{Hz}$, $\\mathrm{Hz}$, $\\mathrm{s}$, and $\\mathrm{s}$ respectively.\n\n- Case $1$: $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t) = (7200, 1000, 1000, 1200, 300, 1, 50, 49.2, 60, 0.01)$\n- Case $2$: $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t) = (7200, 600, 1400, 1400, 50, 2, 50, 49.0, 60, 0.01)$\n- Case $3$: $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t) = (5000, 800, 1000, 1000, 20, 2, 50, 49.4, 60, 0.01)$\n- Case $4$: $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t) = (10000, 2000, 1500, 1800, 600, 0.5, 50, 49.5, 60, 0.01)$\n- Case $5$: $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t) = (3000, 500, 900, 900, 100, 3, 50, 49.3, 60, 0.01)$\n\nYour program must compute, for each case, whether the reserves are adequate (boolean), and then print a single line with the list of booleans in the exact format `[case1,case2,case3,case4,case5]`.",
            "solution": "The problem requires the validation of power system reserve adequacy by simulating the frequency response following a large disturbance. This task is accomplished by solving a first-order linear ordinary differential equation (ODE) that models the aggregated frequency dynamics of a power system. The core of the analysis is a time-domain numerical simulation to determine the frequency nadir and compare it against a specified security threshold.\n\nThe governing equation for the frequency deviation, $\\Delta f(t)$, from the nominal frequency $f_0$, is derived from the principle of power balance for the entire system, aggregated at its Center of Inertia (COI). The equation is given as:\n$$\nM \\, \\frac{d\\,\\Delta f(t)}{dt} = - D \\, \\Delta f(t) - \\Delta P + u(t)\n$$\nwhere $M$ is the system inertia constant in $\\mathrm{MW\\cdot s/Hz}$, $D$ is the load damping constant in $\\mathrm{MW/Hz}$, $\\Delta P$ is the magnitude of the power generation loss in $\\mathrm{MW}$, and $u(t)$ is the activated primary reserve power in $\\mathrm{MW}$. The initial condition is that the system starts at nominal frequency, thus $\\Delta f(0) = 0$.\n\nThe reserve activation, $u(t)$, is modeled as a delayed ramp function, capped at the maximum available reserve headroom, $P_{\\mathrm{res}}$:\n$$\nu(t) = \\min\\!\\big(P_{\\mathrm{res}},\\, \\alpha \\, \\max(0,\\, t - \\tau)\\big)\n$$\nHere, $\\alpha$ is the ramp rate in $\\mathrm{MW/s}$ and $\\tau$ is the activation delay in $\\mathrm{s}$.\n\nTo solve this problem numerically, we first rearrange the ODE into the standard form $\\frac{dy}{dt} = F(y, t)$:\n$$\n\\frac{d\\,\\Delta f(t)}{dt} = \\frac{1}{M} \\left( - D \\, \\Delta f(t) - \\Delta P + u(t) \\right)\n$$\nWe will employ the Forward Euler method for its simplicity and sufficiency for this class of problem, given the small specified time step, $\\Delta t$. The Forward Euler method approximates the solution at the next time step, $t_{k+1} = t_k + \\Delta t$, using the state and its derivative at the current time step, $t_k$:\n$$\n\\Delta f(t_{k+1}) \\approx \\Delta f(t_k) + \\Delta t \\cdot \\left. \\frac{d\\,\\Delta f(t)}{dt} \\right|_{t=t_k}\n$$\nSubstituting the expression for the derivative, the iterative update rule becomes:\n$$\n\\Delta f_{k+1} = \\Delta f_k + \\frac{\\Delta t}{M} \\left( - D \\, \\Delta f_k - \\Delta P + u(t_k) \\right)\n$$\nwhere $\\Delta f_k$ is the numerical approximation of $\\Delta f(t_k)$.\n\nThe simulation procedure for each test case is as follows:\n$1$. Initialize the simulation parameters: Unpack the tuple $(M, D, \\Delta P, P_{\\mathrm{res}}, \\alpha, \\tau, f_0, f_{\\mathrm{thr}}, T, \\Delta t)$.\n$2$. Create a discrete time grid from $t=0$ to $t=T$ with a step size of $\\Delta t$. Let the number of points be $N = \\lfloor T/\\Delta t \\rfloor + 1$.\n$3$. Initialize an array, `delta_f`, of size $N$ to store the frequency deviation at each time step. Set the initial condition `delta_f[0]`$= 0$.\n$4$. Iterate from $k=0$ to $N-2$:\n    a. Calculate the current time $t_k = k \\cdot \\Delta t$.\n    b. Compute the reserve power at time $t_k$: $u_k = \\min(P_{\\mathrm{res}}, \\alpha \\cdot \\max(0, t_k - \\tau))$.\n    c. Calculate the frequency deviation at the next time step, $\\Delta f_{k+1}$, using the Forward Euler update rule:\n    $$\n    \\Delta f_{k+1} = \\Delta f_k + \\frac{\\Delta t}{M} ( - D \\cdot \\Delta f_k - \\Delta P + u_k )\n    $$\n    d. Store this value in `delta_f[k+1]`.\n$5$. After the loop completes, find the minimum value in the `delta_f` array: $\\Delta f_{\\min} = \\min_{k} \\Delta f_k$.\n$6$. Calculate the frequency nadir: $f_{\\mathrm{nadir}} = f_0 + \\Delta f_{\\min}$.\n$7$. Determine reserve adequacy by comparing the nadir to the threshold: the result is `True` if $f_{\\mathrm{nadir}} \\ge f_{\\mathrm{thr}}$ and `False` otherwise.\n\nThis procedure is systematically applied to each of the five provided test cases to generate the final list of boolean adequacy results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n\n    # Test suite:\n    # Each case is a tuple: (M, D, Delta_P, P_res, alpha, tau, f0, f_thr, T, dt)\n    # Units: MW.s/Hz, MW/Hz, MW, MW, MW/s, s, Hz, Hz, s, s\n    test_cases = [\n        (7200, 1000, 1000, 1200, 300, 1, 50, 49.2, 60, 0.01),\n        (7200, 600, 1400, 1400, 50, 2, 50, 49.0, 60, 0.01),\n        (5000, 800, 1000, 1000, 20, 2, 50, 49.4, 60, 0.01),\n        (10000, 2000, 1500, 1800, 600, 0.5, 50, 49.5, 60, 0.01),\n        (3000, 500, 900, 900, 100, 3, 50, 49.3, 60, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_adequate = simulate_frequency_response(case)\n        results.append(is_adequate)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef simulate_frequency_response(params):\n    \"\"\"\n    Simulates the power system frequency response for a single test case.\n\n    Args:\n        params (tuple): A tuple containing the model and simulation parameters:\n                        (M, D, Delta_P, P_res, alpha, tau, f0, f_thr, T, dt).\n\n    Returns:\n        bool: True if reserves are adequate (f_nadir >= f_thr), False otherwise.\n    \"\"\"\n    M, D, Delta_P, P_res, alpha, tau, f0, f_thr, T, dt = params\n\n    # 1. Create time grid\n    num_steps = int(T / dt)\n    time_grid = np.linspace(0, T, num_steps + 1)\n\n    # 2. Initialize frequency deviation array\n    delta_f = np.zeros(num_steps + 1)\n    # Initial condition: delta_f[0] = 0 is already set by np.zeros\n\n    # 3. Time-stepping simulation using Forward Euler method\n    for k in range(num_steps):\n        t_k = time_grid[k]\n        \n        # Calculate reserve activation u(t) at time t_k\n        # u(t) = min(P_res, alpha * max(0, t - tau))\n        reserve_power_u = min(P_res, alpha * max(0, t_k - tau))\n        \n        # Calculate the derivative of the frequency deviation\n        # d(delta_f)/dt = (1/M) * (-D * delta_f - Delta_P + u(t))\n        delta_f_dot = (1 / M) * (-D * delta_f[k] - Delta_P + reserve_power_u)\n        \n        # Update frequency deviation for the next time step\n        delta_f[k + 1] = delta_f[k] + dt * delta_f_dot\n\n    # 4. Find the frequency nadir\n    delta_f_min = np.min(delta_f)\n    f_nadir = f0 + delta_f_min\n\n    # 5. Check adequacy criterion\n    return f_nadir >= f_thr\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}