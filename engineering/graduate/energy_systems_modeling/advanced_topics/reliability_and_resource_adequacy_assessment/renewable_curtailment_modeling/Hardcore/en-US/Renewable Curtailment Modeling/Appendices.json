{
    "hands_on_practices": [
        {
            "introduction": "At its core, renewable curtailment is often an economic decision rather than a purely technical one. This practice delves into the fundamental economic logic using a simplified Unit Commitment (UC) model . By weighing the high fixed and operational costs of a conventional generator against the need to meet load, you will discover the system-level conditions that make curtailing \"free\" renewable energy the most economic choice.",
            "id": "4116370",
            "problem": "Consider a single-period Unit Commitment (UC) problem with one dispatchable thermal generator and a wind plant. The objective is to determine the thermal commitment decision, thermal dispatch, wind dispatch, wind curtailment, and any unserved energy that minimize the total system cost while respecting physical constraints. Use the following fundamental base: energy balance, non-negativity and capacity constraints, and a linear cost function combining commitment-related and dispatch-related terms.\n\nDefine the decision variables as follows, all expressed in megawatts (MW): thermal on/off indicator $y \\in \\{0,1\\}$, thermal power $p^{\\text{th}} \\ge 0$, wind power $p^{\\text{w}} \\ge 0$, wind curtailment $c^{\\text{w}} \\ge 0$, and unserved energy $s \\ge 0$. The parameters are: load $L$ (MW), thermal minimum stable output $P^{\\min}$ (MW), thermal maximum output $P^{\\max}$ (MW), available wind $P^{\\text{avail}}$ (MW), thermal marginal energy cost $c_{\\text{m}}$ (dollars per megawatt-hour), start-up cost $C_{\\text{su}}$ (dollars), no-load cost $C_{\\text{nl}}$ (dollars), wind curtailment penalty $\\pi_{\\text{curt}}$ (dollars per megawatt-hour), and Value of Lost Load (VOLL) $V$ (dollars per megawatt-hour). Assume initial thermal status is off, so committing incurs a start-up cost if $y=1$.\n\nThe physical and operational constraints are:\n- Power balance: $$p^{\\text{th}} + p^{\\text{w}} + s = L.$$\n- Thermal operability: $$y \\in \\{0,1\\}, \\quad p^{\\text{th}} \\le y \\, P^{\\max}, \\quad p^{\\text{th}} \\ge y \\, P^{\\min}.$$\n- Wind availability and curtailment definition: $$0 \\le p^{\\text{w}} \\le P^{\\text{avail}}, \\quad c^{\\text{w}} = P^{\\text{avail}} - p^{\\text{w}}, \\quad c^{\\text{w}} \\ge 0.$$\n- Non-negativity of unserved energy: $$s \\ge 0.$$\n\nThe total cost to minimize is:\n$$\\text{Cost} = C_{\\text{su}} \\, y + C_{\\text{nl}} \\, y + c_{\\text{m}} \\, p^{\\text{th}} + \\pi_{\\text{curt}} \\, c^{\\text{w}} + V \\, s.$$\n\nInterpretation:\n- Thermal generation has a binary commitment and must respect minimum and maximum output if committed.\n- Wind generation is free to dispatch up to its availability, with any unused available wind counted as curtailment and penalized by $\\pi_{\\text{curt}}$.\n- Unserved energy (shortage) is allowed but highly penalized by VOLL $V$.\n- All power quantities must be expressed in MW, and all cost quantities in dollars. For outputs, express all MW values and dollar values as decimal numbers rounded to two decimal places.\n\nImplement a program that, for each parameter set in the test suite below, computes the optimal tuple $[y, p^{\\text{th}}, p^{\\text{w}}, c^{\\text{w}}, s, \\text{Cost}]$ that minimizes the total cost subject to the constraints. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is itself a bracketed comma-separated list with no spaces. For example, the final output format must be of the form $$[ [y_1,p^{\\text{th}}_1,p^{\\text{w}}_1,c^{\\text{w}}_1,s_1,\\text{Cost}_1], [y_2,p^{\\text{th}}_2,p^{\\text{w}}_2,c^{\\text{w}}_2,s_2,\\text{Cost}_2], \\ldots ].$$\n\nTest suite (all powers in MW, all costs in dollars or dollars per megawatt-hour, and all numbers should be treated as exact constants in the calculations):\n- Case $1$: $L=100$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=80$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $2$: $L=60$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=80$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $3$: $L=40$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=20$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $4$: $L=300$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=120$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $5$: $L=370$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=120$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case encoded as $[y,p^{\\text{th}},p^{\\text{w}},c^{\\text{w}},s,\\text{Cost}]$, where $y$ is an integer ($0$ or $1$) and all other entries are decimal numbers rounded to two decimal places. There must be no spaces anywhere in the printed line.",
            "solution": "The user wants to solve a single-period unit commitment problem. I will begin by validating the problem statement.\n\n### Step 1: Extract Givens\nThe problem is to find the minimum of a cost function subject to a set of constraints.\n\n**Decision Variables (all in MW):**\n- Thermal on/off indicator: $y \\in \\{0,1\\}$\n- Thermal power output: $p^{\\text{th}} \\ge 0$\n- Wind power dispatched: $p^{\\text{w}} \\ge 0$\n- Wind curtailment: $c^{\\text{w}} \\ge 0$\n- Unserved energy (shortage): $s \\ge 0$\n\n**Parameters:**\n- Load: $L$ (MW)\n- Thermal minimum stable output: $P^{\\min}$ (MW)\n- Thermal maximum output: $P^{\\max}$ (MW)\n- Available wind power: $P^{\\text{avail}}$ (MW)\n- Thermal marginal energy cost: $c_{\\text{m}}$ ($\\$/MWh$)\n- Thermal start-up cost: $C_{\\text{su}}$ ($\\$$)\n- Thermal no-load cost: $C_{\\text{nl}}$ ($\\$$)\n- Wind curtailment penalty: $\\pi_{\\text{curt}}$ ($\\$/MWh$)\n- Value of Lost Load (VOLL): $V$ ($\\$/MWh$)\n\n**Initial Condition:**\n- The thermal generator is initially off.\n\n**Constraints:**\n1.  Power balance: $p^{\\text{th}} + p^{\\text{w}} + s = L$\n2.  Thermal operability: $y \\in \\{0,1\\}$, $p^{\\text{th}} \\le y \\, P^{\\max}$, $p^{\\text{th}} \\ge y \\, P^{\\min}$\n3.  Wind availability: $0 \\le p^{\\text{w}} \\le P^{\\text{avail}}$\n4.  Wind curtailment definition: $c^{\\text{w}} = P^{\\text{avail}} - p^{\\text{w}}$\n5.  Non-negativity: $c^{\\text{w}} \\ge 0$, $s \\ge 0$\n\n**Objective Function:**\n- Minimize Total Cost: $\\text{Cost} = C_{\\text{su}} \\, y + C_{\\text{nl}} \\, y + c_{\\text{m}} \\, p^{\\text{th}} + \\pi_{\\text{curt}} \\, c^{\\text{w}} + V \\, s$\n\n**Test Suite:**\n- Case $1$: $L=100$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=80$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $2$: $L=60$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=80$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $3$: $L=40$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=20$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $4$: $L=300$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=120$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n- Case $5$: $L=370$, $P^{\\min}=50$, $P^{\\max}=200$, $P^{\\text{avail}}=120$, $c_{\\text{m}}=30$, $C_{\\text{su}}=500$, $C_{\\text{nl}}=100$, $\\pi_{\\text{curt}}=5$, $V=2000$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a simplified but standard economic dispatch and unit commitment formulation, a cornerstone of energy systems modeling. It is formulated as a Mixed-Integer Linear Program (MILP).\n\n- **Scientifically Grounded**: The problem is based on fundamental principles of power system operation, including power balance, generator limits, and cost minimization. All components (thermal/wind generation, load, curtailment, shortage) are standard concepts.\n- **Well-Posed**: The problem is an optimization problem with a linear objective function and linear constraints over a convex domain for each fixed value of the integer variable $y$. Since there are only two possible values for $y$, a unique, stable, and meaningful solution is guaranteed to exist.\n- **Objective**: The problem is defined with precise mathematical and technical language, with all parameters and variables specified unambiguously.\n\nThe problem is self-contained, consistent, and scientifically sound. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\nThe problem can be solved by decomposing it based on the binary commitment decision for the thermal generator, $y \\in \\{0, 1\\}$. We will analyze the optimal dispatch and associated cost for each case and then select the case that yields the minimum total cost. The time period is a single hour, so MWh and MW are numerically equivalent, and all cost rates in $\\$/MWh$ can be treated as costs per MW.\n\n**Case A: Thermal Unit is OFF ($y=0$)**\nIf the thermal unit is off, its commitment state is $y = 0$. The operational constraints on $p^{\\text{th}}$ become $p^{\\text{th}} \\le 0 \\cdot P^{\\max}$ and $p^{\\text{th}} \\ge 0 \\cdot P^{\\min}$, which forces $p^{\\text{th}} = 0$. The cost function simplifies to:\n$$ \\text{Cost}_{y=0} = \\pi_{\\text{curt}} \\, c^{\\text{w}} + V \\, s $$\nThe power balance becomes $p^{\\text{w}} + s = L$. We can express $s$ as $s = L - p^{\\text{w}}$ and $c^{\\text{w}}$ as $c^{\\text{w}} = P^{\\text{avail}} - p^{\\text{w}}$. Substituting these into the cost function gives:\n$$ \\text{Cost}_{y=0} = \\pi_{\\text{curt}}(P^{\\text{avail}} - p^{\\text{w}}) + V(L - p^{\\text{w}}) = (\\pi_{\\text{curt}}P^{\\text{avail}} + VL) - (\\pi_{\\text{curt}} + V)p^{\\text{w}} $$\nTo minimize this cost, we must maximize $p^{\\text{w}}$, since its coefficient $-(\\pi_{\\text{curt}} + V)$ is negative. The constraints on $p^{\\text{w}}$ are $0 \\le p^{\\text{w}} \\le P^{\\text{avail}}$ and $s = L - p^{\\text{w}} \\ge 0 \\implies p^{\\text{w}} \\le L$. Combining these, the feasible range for $p^{\\text{w}}$ is $0 \\le p^{\\text{w}} \\le \\min(L, P^{\\text{avail}})$.\nThus, the optimal wind dispatch is $p^{\\text{w}}_{(0)} = \\min(L, P^{\\text{avail}})$.\nThe remaining variables are then:\n- $p^{\\text{th}}_{(0)} = 0$\n- $c^{\\text{w}}_{(0)} = P^{\\text{avail}} - p^{\\text{w}}_{(0)}$\n- $s_{(0)} = L - p^{\\text{w}}_{(0)}$\nThe total cost is $\\text{Cost}_{y=0} = \\pi_{\\text{curt}}c^{\\text{w}}_{(0)} + V s_{(0)}$.\n\n**Case B: Thermal Unit is ON ($y=1$)**\nIf the thermal unit is on ($y = 1$), it incurs fixed costs $C_{\\text{su}} + C_{\\text{nl}}$ and must operate within its limits, $P^{\\min} \\le p^{\\text{th}} \\le P^{\\max}$. The total cost is:\n$$ \\text{Cost}_{y=1} = (C_{\\text{su}} + C_{\\text{nl}}) + c_{\\text{m}} p^{\\text{th}} + \\pi_{\\text{curt}} c^{\\text{w}} + V s $$\nA critical constraint arises from the power balance equation $p^{\\text{th}} + p^{\\text{w}} + s = L$. Since $p^{\\text{w}} \\ge 0$ and $s \\ge 0$, we have $p^{\\text{th}} \\le L$. Combined with the minimum output constraint $p^{\\text{th}} \\ge P^{\\min}$, this implies that the $y=1$ case is only feasible if $L \\ge P^{\\min}$. If $L  P^{\\min}$, any dispatch with $p^{\\text{th}} \\ge P^{\\min}$ would violate the power balance equation (as $p^{\\text{th}}  L$ would require $p^{\\text{w}} + s  0$, which is impossible). Therefore, if $L  P^{\\min}$, the $y=1$ case is infeasible, and its cost can be considered infinite.\n\nAssuming $L \\ge P^{\\min}$, we proceed by determining the optimal dispatch. The economic merit order suggests using wind first, then thermal, and finally incurring unserved energy, due to the typical cost hierarchy $\\pi_{\\text{curt}}  c_{\\text{m}}  V$.\n\nThere are two primary sub-cases for $y=1$:\n1.  **Insufficient Capacity ($L  P^{\\max} + P^{\\text{avail}}$):** The total available generation is less than the load. To minimize the prohibitively expensive unserved energy $s$, all available generation must be dispatched.\n    - $p^{\\text{th}}_{(1)} = P^{\\max}$\n    - $p^{\\text{w}}_{(1)} = P^{\\text{avail}}$ (which implies $c^{\\text{w}}_{(1)} = 0$)\n    - $s_{(1)} = L - P^{\\max} - P^{\\text{avail}}$\n\n2.  **Sufficient Capacity ($P^{\\min} \\le L \\le P^{\\max} + P^{\\text{avail}}$):** The load can be met without unserved energy, so we can set $s_{(1)} = 0$. The power balance is $p^{\\text{th}} + p^{\\text{w}} = L$. The objective is to minimize $(C_{\\text{su}} + C_{\\text{nl}}) + c_{\\text{m}}p^{\\text{th}} + \\pi_{\\text{curt}}c^{\\text{w}}$. Substituting $p^{\\text{w}} = L - p^{\\text{th}}$ and $c^{\\text{w}} = P^{\\text{avail}} - p^{\\text{w}} = P^{\\text{avail}} - (L - p^{\\text{th}})$, the variable part of the cost becomes:\n    $$ c_{\\text{m}}p^{\\text{th}} + \\pi_{\\text{curt}}(P^{\\text{avail}} - L + p^{\\text{th}}) = (c_{\\text{m}} + \\pi_{\\text{curt}})p^{\\text{th}} + \\pi_{\\text{curt}}(P^{\\text{avail}} - L) $$\n    Since the coefficient $(c_{\\text{m}} + \\pi_{\\text{curt}})$ is positive, we must choose the minimum possible value for $p^{\\text{th}}$. The feasible range for $p^{\\text{th}}$ is determined by its own limits and the limits on wind power:\n    - $P^{\\min} \\le p^{\\text{th}} \\le P^{\\max}$\n    - $0 \\le p^{\\text{w}} \\le P^{\\text{avail}} \\implies 0 \\le L - p^{\\text{th}} \\le P^{\\text{avail}}$, which gives $L - P^{\\text{avail}} \\le p^{\\text{th}} \\le L$.\n    Combining these, the feasible range for $p^{\\text{th}}$ is $[\\max(P^{\\min}, L - P^{\\text{avail}}), \\min(P^{\\max}, L)]$.\n    To minimize cost, we select the lowest value from this range:\n    - $p^{\\text{th}}_{(1)} = \\max(P^{\\min}, L - P^{\\text{avail}})$\n    - The other variables follow: $p^{\\text{w}}_{(1)} = L - p^{\\text{th}}_{(1)}$, $c^{\\text{w}}_{(1)} = P^{\\text{avail}} - p^{\\text{w}}_{(1)}$, and $s_{(1)} = 0$.\n\n**Final Decision Algorithm**\nFor each parameter set:\n1.  Calculate the decision variables and total cost for the $y=0$ case, $\\text{Cost}_{y=0}$.\n2.  Calculate the decision variables and total cost for the $y=1$ case, $\\text{Cost}_{y=1}$. If $L  P^{\\min}$, set $\\text{Cost}_{y=1} = \\infty$.\n3.  Compare the costs. If $\\text{Cost}_{y=0} \\le \\text{Cost}_{y=1}$, the optimal solution is the one found in the $y=0$ case. Otherwise, it is the one from the $y=1$ case.\n4.  Format the resulting tuple $[y, p^{\\text{th}}, p^{\\text{w}}, c^{\\text{w}}, s, \\text{Cost}]$ for output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the single-period unit commitment problem for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: L=100, P_min=50, P_max=200, P_avail=80, ...\n        {\n            \"L\": 100.0, \"P_min\": 50.0, \"P_max\": 200.0, \"P_avail\": 80.0,\n            \"c_m\": 30.0, \"C_su\": 500.0, \"C_nl\": 100.0, \"pi_curt\": 5.0, \"V\": 2000.0\n        },\n        # Case 2: L=60, P_min=50, P_max=200, P_avail=80, ...\n        {\n            \"L\": 60.0, \"P_min\": 50.0, \"P_max\": 200.0, \"P_avail\": 80.0,\n            \"c_m\": 30.0, \"C_su\": 500.0, \"C_nl\": 100.0, \"pi_curt\": 5.0, \"V\": 2000.0\n        },\n        # Case 3: L=40, P_min=50, P_max=200, P_avail=20, ...\n        {\n            \"L\": 40.0, \"P_min\": 50.0, \"P_max\": 200.0, \"P_avail\": 20.0,\n            \"c_m\": 30.0, \"C_su\": 500.0, \"C_nl\": 100.0, \"pi_curt\": 5.0, \"V\": 2000.0\n        },\n        # Case 4: L=300, P_min=50, P_max=200, P_avail=120, ...\n        {\n            \"L\": 300.0, \"P_min\": 50.0, \"P_max\": 200.0, \"P_avail\": 120.0,\n            \"c_m\": 30.0, \"C_su\": 500.0, \"C_nl\": 100.0, \"pi_curt\": 5.0, \"V\": 2000.0\n        },\n        # Case 5: L=370, P_min=50, P_max=200, P_avail=120, ...\n        {\n            \"L\": 370.0, \"P_min\": 50.0, \"P_max\": 200.0, \"P_avail\": 120.0,\n            \"c_m\": 30.0, \"C_su\": 500.0, \"C_nl\": 100.0, \"pi_curt\": 5.0, \"V\": 2000.0\n        }\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        L, P_min, P_max, P_avail = params[\"L\"], params[\"P_min\"], params[\"P_max\"], params[\"P_avail\"]\n        c_m, C_su, C_nl, pi_curt, V = params[\"c_m\"], params[\"C_su\"], params[\"C_nl\"], params[\"pi_curt\"], params[\"V\"]\n\n        # Case y = 0 (Thermal OFF)\n        y0 = 0\n        p_th0 = 0.0\n        p_w0 = min(L, P_avail)\n        c_w0 = P_avail - p_w0\n        s0 = L - p_w0\n        cost0 = pi_curt * c_w0 + V * s0\n        res0 = [y0, p_th0, p_w0, c_w0, s0, cost0]\n\n        # Case y = 1 (Thermal ON)\n        cost1 = float('inf')\n        res1 = []\n\n        # The y=1 case is infeasible if load is less than the thermal minimum run level.\n        if L = P_min:\n            y1 = 1\n            fixed_cost1 = C_su + C_nl\n            \n            # Subcase: Insufficient capacity\n            if L  P_max + P_avail:\n                p_th1 = P_max\n                p_w1 = P_avail\n                c_w1 = 0.0\n                s1 = L - p_th1 - p_w1\n            # Subcase: Sufficient capacity\n            else:\n                s1 = 0.0\n                p_th1 = max(P_min, L - P_avail)\n                p_w1 = L - p_th1\n                c_w1 = P_avail - p_w1\n            \n            cost1 = fixed_cost1 + c_m * p_th1 + pi_curt * c_w1 + V * s1\n            res1 = [y1, p_th1, p_w1, c_w1, s1, cost1]\n\n        # Compare costs and select optimal solution\n        if cost0 = cost1:\n            optimal_res = res0\n        else:\n            optimal_res = res1\n            \n        # Format for output\n        y_opt = int(optimal_res[0])\n        p_th_opt = f\"{optimal_res[1]:.2f}\"\n        p_w_opt = f\"{optimal_res[2]:.2f}\"\n        c_w_opt = f\"{optimal_res[3]:.2f}\"\n        s_opt = f\"{optimal_res[4]:.2f}\"\n        cost_opt = f\"{optimal_res[5]:.2f}\"\n        \n        results.append(f\"[{y_opt},{p_th_opt},{p_w_opt},{c_w_opt},{s_opt},{cost_opt}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In a real power grid, where you curtail generation is as important as how much. This exercise elevates the analysis from a single-node system to a meshed network, introducing Power Transfer Distribution Factors (PTDFs) to quantify the locational effectiveness of curtailment for relieving congestion . You will implement and contrast a purely efficient, cost-minimizing strategy with a fairness-constrained approach, revealing a key trade-off at the heart of modern grid operations.",
            "id": "4116381",
            "problem": "Consider the linearized direct current (DC) power flow model for a meshed transmission network. Let there be a set of buses indexed by $i \\in \\{1,\\dots,N\\}$ and a single monitored transmission element (line) $\\ell$ with a thermal limit. The Power Transfer Distribution Factor (PTDF) for bus $i$ with respect to line $\\ell$, denoted $p_i$, gives the change in flow on line $\\ell$ (in megawatts, MW) resulting from a $1$ MW net injection at bus $i$ and a corresponding $1$ MW withdrawal at the slack bus under the DC approximation. Renewable curtailment at bus $i$ is modeled as a reduction in net injection by an amount $c_i$ (in MW), with $0 \\le c_i \\le r_i$, where $r_i$ is the pre-curtailment renewable output at bus $i$ (in MW). Assume that only buses with $p_i  0$ can relieve congestion on the monitored line by curtailment; curtailment at buses with $p_i \\le 0$ does not help and must be ignored for congestion relief on $\\ell$.\n\nThe base flow on the monitored line is $F_0$ (in MW), and the thermal limit is $F_{\\max}$ (in MW). The required congestion relief is $D = \\max\\{0, F_0 - F_{\\max}\\}$ (in MW). Under the DC model, the change in flow on line $\\ell$ due to curtailment vector $\\mathbf{c} = (c_1,\\dots,c_N)$ is $\\Delta F = \\sum_{i=1}^N p_i c_i$. A feasible curtailment plan must satisfy $\\sum_{i=1}^N p_i c_i \\ge D$ with $0 \\le c_i \\le r_i$, and $c_i = 0$ whenever $p_i \\le 0$.\n\nTask A: Efficiency. Starting from the DC power flow linearization and the definition of PTDF, and without assuming any specialized optimality formula, derive from first principles which buses should be curtailed to minimize the total curtailed energy $\\sum_{i=1}^N c_i$ subject to the constraint $\\sum_{i=1}^N p_i c_i \\ge D$ and the bounds $0 \\le c_i \\le r_i$, focusing only on buses with $p_i  0$. Use your derivation to show that curtailing at a bus with a low $p_i$ is inefficient, in the sense that more total curtailment (in MW) is required to achieve the same congestion relief $D$ compared to curtailing at a bus with a higher $p_i$.\n\nTask B: Fairness-constrained allocation. Impose a fairness constraint that all contributing renewable producers (those with $p_i  0$) face an equal proportional curtailment burden: there exists a scalar $\\phi \\in [0,1]$ such that $c_i = \\phi r_i$ for all $i$ with $p_i  0$, capped by $r_i$. Under this fairness constraint, derive the allocation that achieves the minimal proportional burden $\\phi$ while satisfying the congestion relief requirement. Express the resulting $\\phi$ as a decimal fraction and the total curtailment $\\sum_{i=1}^N c_i$ in megawatts.\n\nImplementation requirements: Write a complete program that, for each provided test case, computes the following four outputs:\n- The minimal total curtailment in MW from Task A, rounded to three decimals.\n- The total curtailment in MW when curtailments are applied greedily in ascending order of $p_i$ (that is, prioritizing the lowest positive $p_i$ first, then the next-lowest, and so on), rounded to three decimals. This ascending order plan is used to demonstrate inefficiency relative to the efficient plan.\n- The fairness burden $\\phi$ from Task B as a decimal fraction, rounded to six decimals.\n- The total curtailment in MW under the fairness-constrained allocation from Task B, rounded to three decimals.\n\nYour program should assume that all quantities are in megawatts (MW) and should express all curtailment outputs in MW. The fairness burden should be expressed as a decimal fraction, not a percentage. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result\\_1,result\\_2,\\dots]$). For multiple test cases, aggregate the per-test-case results as a list of lists.\n\nUse the following test suite, where each test case is a tuple $(\\mathbf{p}, \\mathbf{r}, F_0, F_{\\max})$:\n- Test case $1$: $\\mathbf{p} = [0.9, 0.6, 0.1, -0.2, 0.0]$, $\\mathbf{r} = [70, 50, 500, 20, 10]$ in MW, $F_0 = 140$ MW, $F_{\\max} = 110$ MW.\n- Test case $2$: $\\mathbf{p} = [0.7, 0.3, -0.2]$, $\\mathbf{r} = [20, 10, 5]$ in MW, $F_0 = 117$ MW, $F_{\\max} = 100$ MW.\n- Test case $3$: $\\mathbf{p} = [0.5, 0.2, 0.0, -0.1]$, $\\mathbf{r} = [10, 10, 100, 5]$ in MW, $F_0 = 95$ MW, $F_{\\max} = 100$ MW.\n\nNotes:\n- For each test case, compute $D = \\max\\{0, F_0 - F_{\\max}\\}$ in MW.\n- Assume feasibility holds for all test cases in the sense that the fairness-constrained allocation with $\\phi \\in [0,1]$ can meet the required relief $D$. If $D = 0$, all curtailments should be $0$ MW and $\\phi = 0$.\n- In all computations, ignore buses with $p_i \\le 0$ for the purpose of congestion relief.\n\nFinal output format: Your program should produce a single line of output representing a list with three elements (one per test case). Each element must itself be a list of four floats in the exact order described above, with the prescribed rounding applied. For example, the printed output should look like $[[a,b,c,d],[\\dots],[\\dots]]$ where $a,b,d$ are in MW and $c$ is a decimal fraction.",
            "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the established principles of linearized DC power flow analysis, a standard method in power systems engineering. The problem is well-posed, containing all necessary data and constraints to derive unique and meaningful solutions for the defined tasks. The language is objective and precise.\n\nThe central task is to determine optimal and fair strategies for renewable energy curtailment to alleviate transmission congestion. We are given a set of buses $i \\in \\{1,\\dots,N\\}$, their Power Transfer Distribution Factors (PTDFs) $p_i$ with respect to a congested line $\\ell$, and their available renewable generation $r_i$. The congestion is quantified as a required relief of $D = \\max\\{0, F_0 - F_{\\max}\\}$, where $F_0$ is the base flow and $F_{\\max}$ is the line's thermal limit.\n\nA curtailment action $c_i$ at bus $i$ reduces the net injection, and the total relief provided is $\\sum_{i=1}^N p_i c_i$. The constraints on curtailment are $0 \\le c_i \\le r_i$ for all $i$, and importantly, only buses with $p_i  0$ are effective for relieving this specific congestion, so we must have $c_i = 0$ for all $i$ where $p_i \\le 0$. Let $I_+$ be the set of indices for which $p_i  0$. The relief constraint is thus $\\sum_{i \\in I_+} p_i c_i \\ge D$.\n\nIf $D = 0$, no congestion exists, and no curtailment is necessary. In this trivial case, all calculated curtailment values will be $0$ and the fairness burden $\\phi$ will be $0$. The derivations below assume $D  0$.\n\n### Task A: Efficiency-Based Curtailment\n\nThe objective is to minimize the total curtailed energy, $C_{total} = \\sum_{i \\in I_+} c_i$, while satisfying the relief constraint. The problem is formulated as a linear program:\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  \\sum_{i \\in I_+} c_i \\\\\n\\text{subject to} \\quad  \\sum_{i \\in I_+} p_i c_i \\ge D \\\\\n 0 \\le c_i \\le r_i, \\quad \\forall i \\in I_+\n\\end{aligned}\n$$\nTo derive the solution from first principles, we analyze the efficiency of curtailment at each bus. The efficiency of a bus $i \\in I_+$ can be defined as the amount of congestion relief achieved per unit of energy curtailed. For a curtailment $c_i$, the relief is $p_i c_i$. The \"cost\" is $c_i$. The ratio of benefit (relief) to cost (curtailment) is $\\frac{p_i c_i}{c_i} = p_i$.\n\nTherefore, the PTDF value $p_i$ is a direct measure of the curtailment efficiency for bus $i$. To achieve the required relief $D$ with the minimum total curtailment $\\sum c_i$, we must prioritize curtailing from the most efficient buses—those with the highest $p_i$ values.\n\nThis leads to a greedy algorithm:\n1. Identify all buses $i \\in I_+$ (where $p_i  0$).\n2. Sort these buses in descending order of their $p_i$ values.\n3. Iterate through the sorted buses, curtailing generation from each one until the cumulative relief meets or exceeds $D$. For each bus $j$ in the sorted sequence, we determine the necessary curtailment $c_j$. Let $D_{rem}$ be the remaining relief required. The curtailment at bus $j$ is $c_j = \\min\\left(r_j, \\frac{D_{rem}}{p_j}\\right)$. We update $D_{rem} \\leftarrow D_{rem} - p_j c_j$ and proceed to the next bus if $D_{rem}  0$.\n\nThis greedy strategy is optimal because of the linear nature of the problem. Any deviation from this strategy, such as substituting a small amount of curtailment $\\delta c_k$ from a high-PTDF bus $k$ with curtailment from a low-PTDF bus $j$ ($p_j  p_k$), would be inefficient. To maintain the same relief $\\Delta F = p_k \\delta c_k$, the substituted curtailment at bus $j$ would have to be $\\delta c_j = \\frac{p_k}{p_j} \\delta c_k$. Since $p_k  p_j$, it follows that $\\delta c_j  \\delta c_k$, resulting in a larger total curtailment. This proves that an ascending-order curtailment plan is inherently less efficient than the descending-order plan, unless all available generation must be curtailed regardless of order.\n\nThe implementation will calculate the total curtailment for both the optimal (descending $p_i$) and the demonstrably inefficient (ascending $p_i$) strategies.\n\n### Task B: Fairness-Constrained Curtailment\n\nThis task imposes a fairness constraint: all contributing producers (those with $p_i  0$) must be curtailed by the same proportion $\\phi \\in [0,1]$ of their available generation. This means $c_i = \\phi r_i$ for all $i \\in I_+$, and $c_i=0$ otherwise.\n\nWe need to find the minimal $\\phi$ that satisfies the relief constraint. We substitute the fairness-constrained curtailment into the relief inequality:\n$$\n\\sum_{i \\in I_+} p_i c_i \\ge D\n$$\n$$\n\\sum_{i \\in I_+} p_i (\\phi r_i) \\ge D\n$$\nSince $\\phi$ is a scalar constant across all buses in $I_+$, we can factor it out:\n$$\n\\phi \\left( \\sum_{i \\in I_+} p_i r_i \\right) \\ge D\n$$\nTo find the minimum possible value of $\\phi$ that satisfies the condition, we solve for the equality:\n$$\n\\phi = \\frac{D}{\\sum_{i \\in I_+} p_i r_i}\n$$\nThe problem statement guarantees that a feasible solution with $\\phi \\in [0,1]$ exists, which implies that the maximum possible relief, $\\sum_{i \\in I_+} p_i r_i$, is greater than or equal to $D$. If the denominator is zero, it must be that $D=0$, thus $\\phi=0$.\n\nThe total curtailment under this fairness-constrained allocation is the sum of individual curtailments:\n$$\nC_{total, fair} = \\sum_{i \\in I_+} c_i = \\sum_{i \\in I_+} \\phi r_i = \\phi \\sum_{i \\in I_+} r_i\n$$\nCombining the two expressions, we get:\n$$\nC_{total, fair} = \\left( \\frac{D}{\\sum_{j \\in I_+} p_j r_j} \\right) \\left( \\sum_{i \\in I_+} r_i \\right)\n$$\nThis provides a direct formula for the total curtailment under the fairness scheme.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the renewable curtailment problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        (np.array([0.9, 0.6, 0.1, -0.2, 0.0]), np.array([70, 50, 500, 20, 10]), 140.0, 110.0),\n        (np.array([0.7, 0.3, -0.2]), np.array([20, 10, 5]), 117.0, 100.0),\n        (np.array([0.5, 0.2, 0.0, -0.1]), np.array([10, 10, 100, 5]), 95.0, 100.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p_vec, r_vec, f0, fmax = case\n        \n        # Calculate required congestion relief D\n        D = max(0.0, f0 - fmax)\n\n        if D == 0.0:\n            # No congestion, all curtailment values are zero.\n            all_results.append([0.0, 0.0, 0.0, 0.0])\n            continue\n\n        # Filter for buses that can help relieve congestion (p_i  0)\n        positive_p_mask = p_vec  0\n        p_pos = p_vec[positive_p_mask]\n        r_pos = r_vec[positive_p_mask]\n\n        if len(p_pos) == 0:\n            # This case assumes feasibility, but as a safeguard.\n            # If no generators can help, curtailment is impossible. For this problem,\n            # this implies D=0, which is handled above.\n            all_results.append([0.0, 0.0, 0.0, 0.0])\n            continue\n            \n        # --- Task A: Efficiency-based curtailment (Greedy, descending PTDF) ---\n        sorted_indices_desc = np.argsort(p_pos)[::-1]\n        p_sorted_desc = p_pos[sorted_indices_desc]\n        r_sorted_desc = r_pos[sorted_indices_desc]\n\n        total_curtailment_eff = 0.0\n        relief_needed = D\n        for p_i, r_i in zip(p_sorted_desc, r_sorted_desc):\n            max_relief_from_bus = p_i * r_i\n            if relief_needed  max_relief_from_bus:\n                total_curtailment_eff += r_i\n                relief_needed -= max_relief_from_bus\n            else:\n                curtailment_needed = relief_needed / p_i\n                total_curtailment_eff += curtailment_needed\n                relief_needed = 0.0\n                break\n        \n        # --- Inefficient curtailment (Greedy, ascending PTDF) ---\n        sorted_indices_asc = np.argsort(p_pos)\n        p_sorted_asc = p_pos[sorted_indices_asc]\n        r_sorted_asc = r_pos[sorted_indices_asc]\n\n        total_curtailment_ineff = 0.0\n        relief_needed_ineff = D\n        for p_i, r_i in zip(p_sorted_asc, r_sorted_asc):\n            max_relief_from_bus = p_i * r_i\n            if relief_needed_ineff  max_relief_from_bus:\n                total_curtailment_ineff += r_i\n                relief_needed_ineff -= max_relief_from_bus\n            else:\n                curtailment_needed = relief_needed_ineff / p_i\n                total_curtailment_ineff += curtailment_needed\n                relief_needed_ineff = 0.0\n                break\n\n        # --- Task B: Fairness-constrained allocation ---\n        max_possible_relief = np.sum(p_pos * r_pos)\n        \n        phi = 0.0\n        if max_possible_relief  0:\n            phi = D / max_possible_relief\n        \n        total_renewable_at_pos_buses = np.sum(r_pos)\n        total_curtailment_fair = phi * total_renewable_at_pos_buses\n        \n        # Store results for the current test case with specified rounding\n        case_results = [\n            round(total_curtailment_eff, 3),\n            round(total_curtailment_ineff, 3),\n            round(phi, 6),\n            round(total_curtailment_fair, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format final output string to match [[a,b,c,d],[e,f,g,h],...]\n    formatted_cases = []\n    for res_list in all_results:\n        # Format numbers to avoid trailing .0 for integers\n        formatted_list = [f\"{x:.3f}\" if i in [0,1,3] else f\"{x:.6f}\" for i, x in enumerate(res_list)]\n        inner_str = ','.join(formatted_list)\n        formatted_cases.append(f\"[{inner_str}]\")\n        \n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Effective system planning must account for the inherent uncertainty of renewable generation. This final practice moves beyond deterministic models to build a probabilistic framework for assessing curtailment risk . By applying fundamental probability theory to a scenario with forecast uncertainty and transmission limits, you will learn to derive the likelihood of curtailment, a crucial skill for evaluating system reliability and performance.",
            "id": "4116360",
            "problem": "Consider a single-node renewable generator connected to a transmission corridor with a hard export limit $\\bar{P}$ imposed by thermal ratings and stability criteria. The generator’s instantaneous available power $P^{\\text{avail}}$ at a given operating interval is uncertain and modeled as the sum of a deterministic point forecast $\\hat{P}$ and a forecast error $\\varepsilon$, so that $P^{\\text{avail}} = \\hat{P} + \\varepsilon$. The forecast error $\\varepsilon$ is modeled as a normally distributed random variable with mean $\\mu$ and variance $\\sigma^{2}$, that is $\\varepsilon \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, consistent with commonly observed wind and solar forecast error behavior under aggregation.\n\nThe system operator’s injection decision is $P^{\\text{inj}} = \\min\\!\\left(P^{\\text{avail}}, \\bar{P}\\right)$, reflecting the binding export constraint whenever $P^{\\text{avail}}  \\bar{P}$. Define instantaneous curtailment $C$ as the nonnegative difference between available and injected power, $C = \\max\\!\\left(P^{\\text{avail}} - \\bar{P}, 0\\right)$. For a specified nonnegative curtailment threshold $\\tau$ with $\\tau \\ge 0$, determine, from first principles, the probability that curtailment exceeds $\\tau$, that is the quantity $\\mathbb{P}\\!\\left(C  \\tau\\right)$, expressed in closed form as a function of $\\hat{P}$, $\\bar{P}$, $\\mu$, $\\sigma$, and $\\tau$.\n\nExpress the final probability as a single closed-form analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for the probability that renewable energy curtailment $C$ exceeds a specified threshold $\\tau$, denoted $\\mathbb{P}\\!\\left(C  \\tau\\right)$. Before proceeding to a solution, the problem statement must be rigorously validated.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe givens are extracted verbatim from the problem statement:\n-   A hard export limit: $\\bar{P}$\n-   Instantaneous available power: $P^{\\text{avail}} = \\hat{P} + \\varepsilon$\n-   Deterministic point forecast: $\\hat{P}$\n-   Forecast error: $\\varepsilon \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, where $\\mu$ is the mean and $\\sigma^2$ is the variance.\n-   System operator’s injection decision: $P^{\\text{inj}} = \\min\\!\\left(P^{\\text{avail}}, \\bar{P}\\right)$\n-   Instantaneous curtailment: $C = \\max\\!\\left(P^{\\text{avail}} - \\bar{P}, 0\\right)$\n-   A specified nonnegative curtailment threshold: $\\tau$, with $\\tau \\ge 0$\n-   The objective is to determine: $\\mathbb{P}\\!\\left(C  \\tau\\right)$\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of energy systems modeling. The representation of available power as a forecast plus a random error term ($P^{\\text{avail}} = \\hat{P} + \\varepsilon$) is a standard technique. Modeling the forecast error $\\varepsilon$ as a normally distributed random variable is a common and empirically supported assumption for aggregated renewable resources over certain time horizons. The definitions for injected power and curtailment are standard and reflect the physical and operational realities of a constrained transmission system.\n-   **Well-Posed**: The problem is well-posed. It provides a complete set of symbolic parameters ($\\hat{P}$, $\\bar{P}$, $\\mu$, $\\sigma$, $\\tau$) and clear, unambiguous definitions. The objective is to find a single, uniquely determinable probability, which can be expressed as an analytical function of the given parameters.\n-   **Objective**: The problem is stated in precise, objective, and formal mathematical language, free of any subjective or opinion-based content.\n-   **Flaw Checklist**: The problem does not exhibit any of the enumerated flaws. It is scientifically sound, formally stated, internally consistent, physically plausible within its modeling framework, and requires substantive reasoning to solve.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. A solution will be derived from first principles.\n\n### Solution Derivation\n\nThe objective is to find the probability $\\mathbb{P}\\!\\left(C  \\tau\\right)$. We begin with the definition of curtailment, $C$.\n\nThe curtailment $C$ is defined as:\n$$\nC = \\max\\!\\left(P^{\\text{avail}} - \\bar{P}, 0\\right)\n$$\nWe are interested in the event $C  \\tau$. The problem states that the threshold $\\tau$ is nonnegative, i.e., $\\tau \\ge 0$.\nThe inequality $C  \\tau$ can be written as:\n$$\n\\max\\!\\left(P^{\\text{avail}} - \\bar{P}, 0\\right)  \\tau\n$$\nSince $\\tau \\ge 0$, for the maximum of two numbers (one of which is $0$) to be greater than $\\tau$, the other number, $P^{\\text{avail}} - \\bar{P}$, must necessarily be greater than $\\tau$. If $P^{\\text{avail}} - \\bar{P}$ were less than or equal to $\\tau$, the maximum could not exceed $\\tau$. Therefore, the inequality simplifies to:\n$$\nP^{\\text{avail}} - \\bar{P}  \\tau\n$$\nNext, we substitute the definition of available power, $P^{\\text{avail}} = \\hat{P} + \\varepsilon$:\n$$\n\\left(\\hat{P} + \\varepsilon\\right) - \\bar{P}  \\tau\n$$\nTo determine the probability of this event, we isolate the random variable $\\varepsilon$:\n$$\n\\varepsilon  \\bar{P} + \\tau - \\hat{P}\n$$\nThe problem states that the forecast error $\\varepsilon$ follows a normal distribution with mean $\\mu$ and variance $\\sigma^2$, denoted as $\\varepsilon \\sim \\mathcal{N}(\\mu, \\sigma^{2})$. To calculate the probability, we standardize the random variable $\\varepsilon$. Let $Z$ be a standard normal random variable, $Z \\sim \\mathcal{N}(0, 1)$. The transformation from $\\varepsilon$ to $Z$ is given by:\n$$\nZ = \\frac{\\varepsilon - \\mu}{\\sigma}\n$$\nWe apply this transformation to our inequality. Subtracting $\\mu$ from both sides and then dividing by $\\sigma$ (which is implicitly positive, as a variance of $\\sigma^2$ implies a standard deviation $\\sigma \\ge 0$, and $\\sigma=0$ would imply a deterministic system, contrary to the problem's premise) yields:\n$$\n\\frac{\\varepsilon - \\mu}{\\sigma}  \\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}\n$$\nReplacing the left side with $Z$, we get:\n$$\nZ  \\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}\n$$\nThe probability $\\mathbb{P}(C  \\tau)$ is thus equivalent to $\\mathbb{P}\\left(Z  \\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}\\right)$.\n\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, defined as $\\Phi(z) = \\mathbb{P}(Z \\le z)$. The probability of $Z$ being greater than some value $z$ is given by the complementary CDF:\n$$\n\\mathbb{P}(Z  z) = 1 - \\mathbb{P}(Z \\le z) = 1 - \\Phi(z)\n$$\nApplying this to our expression, we set $z = \\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}$. The desired probability is:\n$$\n\\mathbb{P}(C  \\tau) = 1 - \\Phi\\left(\\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}\\right)\n$$\nThis is the closed-form analytical expression for the probability that curtailment exceeds the threshold $\\tau$, as a function of the given parameters. The function $\\Phi$ is a standard mathematical function, representing the integral of the standard normal probability density function from $-\\infty$ to its argument.",
            "answer": "$$\n\\boxed{1 - \\Phi\\left(\\frac{\\bar{P} + \\tau - \\hat{P} - \\mu}{\\sigma}\\right)}\n$$"
        }
    ]
}