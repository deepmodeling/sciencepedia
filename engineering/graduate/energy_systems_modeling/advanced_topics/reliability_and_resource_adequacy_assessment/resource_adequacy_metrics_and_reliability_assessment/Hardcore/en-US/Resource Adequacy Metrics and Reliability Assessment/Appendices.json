{
    "hands_on_practices": [
        {
            "introduction": "The bedrock of probabilistic reliability assessment is the characterization of generation availability. This first practice guides you through the fundamental process of constructing a Capacity Outage Probability Table (COPT) from first principles . By enumerating all possible outage states for a simple system, you will directly calculate the probability distribution of unavailable capacity, a core input for all advanced adequacy metrics.",
            "id": "4119478",
            "problem": "A single-area power system has three generating units. Each unit is modeled as a two-state device (available or on forced outage) with independent forced outages. For a snapshot reliability assessment, assume the steady-state interpretation that the probability a unit is on forced outage equals its forced outage rate, and the probability it is available equals one minus its forced outage rate. Ignore maintenance outages and partial deratings. The units are:\n- Unit A: capacity $120~\\mathrm{MW}$, forced outage rate $0.05$.\n- Unit B: capacity $80~\\mathrm{MW}$, forced outage rate $0.10$.\n- Unit C: capacity $50~\\mathrm{MW}$, forced outage rate $0.08$.\n\nConstruct explicitly the Capacity Outage Probability Table (COPT), defined as the probability mass function over total capacity on outage (i.e., the sum of capacities of all units that are on forced outage), by enumerating all distinct outage states and their probabilities under the independence assumption. Then, for a single deterministic hourly load of $190~\\mathrm{MW}$, compute the probability that the available capacity is strictly less than the load (i.e., the one-hour loss-of-load probability). Express your final probability as a decimal (not a percentage) and round your final answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in standard power system reliability theory, is well-posed with sufficient data, and is stated objectively.\n\nLet $C_A$, $C_B$, and $C_C$ be the capacities of the three generating units, and let $p_A$, $p_B$, and $p_C$ be their respective forced outage rates (FORs). The given values are:\n- Unit A: $C_A = 120~\\mathrm{MW}$, $p_A = 0.05$\n- Unit B: $C_B = 80~\\mathrm{MW}$, $p_B = 0.10$\n- Unit C: $C_C = 50~\\mathrm{MW}$, $p_C = 0.08$\n\nThe probability that a unit is available is $q = 1 - p$. Thus, the availability probabilities are:\n- Unit A availability: $q_A = 1 - p_A = 1 - 0.05 = 0.95$\n- Unit B availability: $q_B = 1 - p_B = 1 - 0.10 = 0.90$\n- Unit C availability: $q_C = 1 - p_C = 1 - 0.08 = 0.92$\n\nSince the units have independent outages, the probability of any system state is the product of the individual unit state probabilities. There are $2^3 = 8$ possible system states. We enumerate them to construct the Capacity Outage Probability Table (COPT). Let $C_{outage}$ be the total capacity on outage for a given state.\n\n1.  **State 1: All units available.**\n    $C_{outage} = 0~\\mathrm{MW}$.\n    The probability of this state is $P_1 = q_A q_B q_C = (0.95)(0.90)(0.92) = 0.7866$.\n\n2.  **State 2: Unit C on outage.**\n    $C_{outage} = C_C = 50~\\mathrm{MW}$.\n    The probability of this state is $P_2 = q_A q_B p_C = (0.95)(0.90)(0.08) = 0.0684$.\n\n3.  **State 3: Unit B on outage.**\n    $C_{outage} = C_B = 80~\\mathrm{MW}$.\n    The probability of this state is $P_3 = q_A p_B q_C = (0.95)(0.10)(0.92) = 0.0874$.\n\n4.  **State 4: Unit A on outage.**\n    $C_{outage} = C_A = 120~\\mathrm{MW}$.\n    The probability of this state is $P_4 = p_A q_B q_C = (0.05)(0.90)(0.92) = 0.0414$.\n\n5.  **State 5: Units B and C on outage.**\n    $C_{outage} = C_B + C_C = 80~\\mathrm{MW} + 50~\\mathrm{MW} = 130~\\mathrm{MW}$.\n    The probability of this state is $P_5 = q_A p_B p_C = (0.95)(0.10)(0.08) = 0.0076$.\n\n6.  **State 6: Units A and C on outage.**\n    $C_{outage} = C_A + C_C = 120~\\mathrm{MW} + 50~\\mathrm{MW} = 170~\\mathrm{MW}$.\n    The probability of this state is $P_6 = p_A q_B p_C = (0.05)(0.90)(0.08) = 0.0036$.\n\n7.  **State 7: Units A and B on outage.**\n    $C_{outage} = C_A + C_B = 120~\\mathrm{MW} + 80~\\mathrm{MW} = 200~\\mathrm{MW}$.\n    The probability of this state is $P_7 = p_A p_B q_C = (0.05)(0.10)(0.92) = 0.0046$.\n\n8.  **State 8: All units on outage.**\n    $C_{outage} = C_A + C_B + C_C = 120 + 80 + 50 = 250~\\mathrm{MW}$.\n    The probability of this state is $P_8 = p_A p_B p_C = (0.05)(0.10)(0.08) = 0.0004$.\n\nThe explicit Capacity Outage Probability Table (COPT) is the probability mass function which lists the probability for each distinct outage capacity level:\n- $P(C_{outage} = 0~\\mathrm{MW}) = 0.7866$\n- $P(C_{outage} = 50~\\mathrm{MW}) = 0.0684$\n- $P(C_{outage} = 80~\\mathrm{MW}) = 0.0874$\n- $P(C_{outage} = 120~\\mathrm{MW}) = 0.0414$\n- $P(C_{outage} = 130~\\mathrm{MW}) = 0.0076$\n- $P(C_{outage} = 170~\\mathrm{MW}) = 0.0036$\n- $P(C_{outage} = 200~\\mathrm{MW}) = 0.0046$\n- $P(C_{outage} = 250~\\mathrm{MW}) = 0.0004$\n\nNext, we compute the one-hour loss-of-load probability (LOLP) for a load of $L = 190~\\mathrm{MW}$. A loss of load occurs if the available capacity, $C_{avail}$, is strictly less than the load. The total installed capacity is $C_{total} = C_A + C_B + C_C = 120 + 80 + 50 = 250~\\mathrm{MW}$. The available capacity is given by $C_{avail} = C_{total} - C_{outage}$.\nThe condition for loss of load is:\n$$C_{avail}  L$$\n$$C_{total} - C_{outage}  L$$\n$$250 - C_{outage}  190$$\n$$250 - 190  C_{outage}$$\n$$60~\\mathrm{MW}  C_{outage}$$\nThe LOLP is the probability that the total capacity on outage is strictly greater than $60~\\mathrm{MW}$. We must sum the probabilities of all states that satisfy this condition. From the COPT, these are the states with outage capacities of $80$, $120$, $130$, $170$, $200$, and $250~\\mathrm{MW}$.\n$$LOLP = P(C_{outage} > 60~\\mathrm{MW})$$\n$$LOLP = P(C_{outage}=80) + P(C_{outage}=120) + P(C_{outage}=130) + P(C_{outage}=170) + P(C_{outage}=200) + P(C_{outage}=250)$$\nSubstituting the probabilities calculated earlier:\n$$LOLP = 0.0874 + 0.0414 + 0.0076 + 0.0036 + 0.0046 + 0.0004$$\n$$LOLP = 0.1450$$\nThe problem requires the answer as a decimal rounded to four significant figures. The calculated value $0.1450$ is already in the required format.",
            "answer": "$$\\boxed{0.1450}$$"
        },
        {
            "introduction": "With a grasp of the system's outage probability distribution, the next step is to assess reliability over a full year by considering the varying load. This exercise bridges the gap between hourly probabilities and annual metrics by combining a capacity model with a Load Duration Curve (LDC) to calculate Loss of Load Expectation ($LOLE$) and Expected Unserved Energy ($EUE$) . This practice will not only solidify your computational skills but also highlight the crucial differences between frequency-based and volume-based reliability indices and their implications for system planning.",
            "id": "4119469",
            "problem": "A vertically integrated utility evaluates adequacy over a one-year horizon of $T=8760$ hours. The system load is represented by a stepwise load duration curve: the highest $h_{1}=100$ hours have load $L_{1}=1300$ megawatts, the next $h_{2}=600$ hours have load $L_{2}=1200$ megawatts, the next $h_{3}=1500$ hours have load $L_{3}=1000$ megawatts, the next $h_{4}=3000$ hours have load $L_{4}=800$ megawatts, and the remaining $h_{5}=3560$ hours have load $L_{5}=600$ megawatts. Available capacity is modeled as a discrete random variable $C$ (in megawatts) with the following probability mass function, assumed stationary across the year and independent of the load-rank: $\\mathbb{P}\\{C=1400\\}=0.88$, $\\mathbb{P}\\{C=1200\\}=0.08$, $\\mathbb{P}\\{C=1000\\}=0.03$, $\\mathbb{P}\\{C=800\\}=0.008$, $\\mathbb{P}\\{C=600\\}=0.002$. Assume that meeting load exactly, that is $C=L$, incurs no shortfall.\n\nStarting only from the formal definitions of Loss of Load Expectation (LOLE) as the expected number of hours in which load exceeds available capacity over the horizon, and Expected Unserved Energy (EUE) as the expected total energy not served over the horizon, compute both metrics for this system under the given assumptions. Express LOLE in hours and EUE in megawatt-hours (MWh). Round both quantities to four significant figures. Then, based on your computed values, articulate the planning implications if the two metrics convey different emphases about the nature of risk.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary data for a complete analysis. The total duration of the load blocks sums to $100+600+1500+3000+3560=8760$ hours, which matches the yearly horizon $T$. The probabilities of the available capacity states sum to $0.88+0.08+0.03+0.008+0.002=1.00$, forming a valid probability mass function. We may therefore proceed with the solution.\n\nThe problem requires the computation of two fundamental resource adequacy metrics: Loss of Load Expectation (LOLE) and Expected Unserved Energy (EUE).\n\nLet $L$ be the system load and $C$ be the available capacity, both measured in megawatts (MW). A shortfall event occurs if $L > C$. The problem states that if $C=L$, no shortfall is incurred.\n\nThe load is not constant but varies over time. The problem provides a load duration curve (LDC), which gives the number of hours, $h_i$, for which the load is at a certain level, $L_i$. The total time horizon is $T = \\sum_i h_i$. The available capacity $C$ is a random variable, independent of the load level, with a given probability mass function $\\mathbb{P}\\{C=c_k\\}$.\n\n**1. Calculation of Loss of Load Expectation (LOLE)**\n\nLOLE is formally defined as the expected number of hours within the time horizon $T$ during which the load $L$ exceeds the available capacity $C$.\nLet $I(L(t) > C)$ be an indicator function that is $1$ if $L(t) > C$ at hour $t$ and $0$ otherwise. Then,\n$$\n\\text{LOLE} = \\mathbb{E}\\left[\\int_{0}^{T} I(L(t) > C) \\,dt\\right]\n$$\nGiven the stepwise LDC, we can discretize this integral. For each load block $i$ with duration $h_i$ and load level $L_i$, the expected number of hours of shortfall is the duration of that block multiplied by the probability of a shortfall during that block. The probability of a shortfall at load level $L_i$ is the Loss of Load Probability, $LOLP(L_i) = \\mathbb{P}\\{C  L_i\\}$. Since the capacity state is independent for each hour, the total LOLE is the sum of the expected loss of load hours over all load blocks.\n$$\n\\text{LOLE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{P}\\{C  L_i\\}\n$$\nWe first compute the probability of shortfall for each load level $L_i$:\nThe available capacity states are $c \\in \\{1400, 1200, 1000, 800, 600\\}$.\n\nFor load block 1: $L_1 = 1300$ MW. A shortfall occurs if $C  1300$ MW.\n$$\n\\mathbb{P}\\{C  1300\\} = \\mathbb{P}\\{C=1200\\} + \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1300\\} = 0.08 + 0.03 + 0.008 + 0.002 = 0.12\n$$\nFor load block 2: $L_2 = 1200$ MW. A shortfall occurs if $C  1200$ MW.\n$$\n\\mathbb{P}\\{C  1200\\} = \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1200\\} = 0.03 + 0.008 + 0.002 = 0.04\n$$\nFor load block 3: $L_3 = 1000$ MW. A shortfall occurs if $C  1000$ MW.\n$$\n\\mathbb{P}\\{C  1000\\} = \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1000\\} = 0.008 + 0.002 = 0.01\n$$\nFor load block 4: $L_4 = 800$ MW. A shortfall occurs if $C  800$ MW.\n$$\n\\mathbb{P}\\{C  800\\} = \\mathbb{P}\\{C=600\\} = 0.002\n$$\nFor load block 5: $L_5 = 600$ MW. A shortfall occurs if $C  600$ MW. There are no capacity states below $600$ MW.\n$$\n\\mathbb{P}\\{C  600\\} = 0\n$$\nNow we can compute the total LOLE:\n$$\n\\text{LOLE} = (h_1 \\cdot \\mathbb{P}\\{C  L_1\\}) + (h_2 \\cdot \\mathbb{P}\\{C  L_2\\}) + (h_3 \\cdot \\mathbb{P}\\{C  L_3\\}) + (h_4 \\cdot \\mathbb{P}\\{C  L_4\\}) + (h_5 \\cdot \\mathbb{P}\\{C  L_5\\})\n$$\n$$\n\\text{LOLE} = (100 \\, \\text{hr} \\cdot 0.12) + (600 \\, \\text{hr} \\cdot 0.04) + (1500 \\, \\text{hr} \\cdot 0.01) + (3000 \\, \\text{hr} \\cdot 0.002) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{LOLE} = 12 \\, \\text{hr} + 24 \\, \\text{hr} + 15 \\, \\text{hr} + 6 \\, \\text{hr} + 0 \\, \\text{hr} = 57 \\, \\text{hr}\n$$\nRounding to four significant figures, LOLE is $57.00$ hours.\n\n**2. Calculation of Expected Unserved Energy (EUE)**\n\nEUE is the expected total energy not served over the horizon $T$. The unserved power at any moment is given by the random variable $\\max(0, L - C)$.\n$$\n\\text{EUE} = \\mathbb{E}\\left[\\int_{0}^{T} \\max(0, L(t) - C) \\,dt\\right]\n$$\nUsing the stepwise LDC, this becomes the sum of the expected unserved energy for each load block. For a given block $i$, the expected unserved power is $\\mathbb{E}[\\max(0, L_i - C)]$. The expected unserved energy for this block is $h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]$.\n$$\n\\text{EUE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]\n$$\nThe expectation $\\mathbb{E}[\\max(0, L_i - C)]$ is computed by summing over the discrete capacity states $c_k$:\n$$\n\\mathbb{E}[\\max(0, L_i - C)] = \\sum_{k} \\max(0, L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\} = \\sum_{k: c_k  L_i} (L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\}\n$$\nWe compute this for each load block:\n\nFor load block 1 ($L_1 = 1300$ MW):\n$$\n\\mathbb{E}[\\max(0, 1300-C)] = (1300-1200)(0.08) + (1300-1000)(0.03) + (1300-800)(0.008) + (1300-600)(0.002)\n$$\n$$\n= (100)(0.08) + (300)(0.03) + (500)(0.008) + (700)(0.002) = 8 + 9 + 4 + 1.4 = 22.4 \\, \\text{MW}\n$$\nFor load block 2 ($L_2 = 1200$ MW):\n$$\n\\mathbb{E}[\\max(0, 1200-C)] = (1200-1000)(0.03) + (1200-800)(0.008) + (1200-600)(0.002)\n$$\n$$\n= (200)(0.03) + (400)(0.008) + (600)(0.002) = 6 + 3.2 + 1.2 = 10.4 \\, \\text{MW}\n$$\nFor load block 3 ($L_3 = 1000$ MW):\n$$\n\\mathbb{E}[\\max(0, 1000-C)] = (1000-800)(0.008) + (1000-600)(0.002)\n$$\n$$\n= (200)(0.008) + (400)(0.002) = 1.6 + 0.8 = 2.4 \\, \\text{MW}\n$$\nFor load block 4 ($L_4 = 800$ MW):\n$$\n\\mathbb{E}[\\max(0, 800-C)] = (800-600)(0.002) = (200)(0.002) = 0.4 \\, \\text{MW}\n$$\nFor load block 5 ($L_5 = 600$ MW): The shortfall is always zero since no capacity state is below $600$ MW.\n$$\n\\mathbb{E}[\\max(0, 600-C)] = 0 \\, \\text{MW}\n$$\nNow we can compute the total EUE:\n$$\n\\text{EUE} = (100 \\, \\text{hr} \\cdot 22.4 \\, \\text{MW}) + (600 \\, \\text{hr} \\cdot 10.4 \\, \\text{MW}) + (1500 \\, \\text{hr} \\cdot 2.4 \\, \\text{MW}) + (3000 \\, \\text{hr} \\cdot 0.4 \\, \\text{MW}) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{EUE} = 2240 \\, \\text{MWh} + 6240 \\, \\text{MWh} + 3600 \\, \\text{MWh} + 1200 \\, \\text{MWh} + 0 \\, \\text{MWh}\n$$\n$$\n\\text{EUE} = 13280 \\, \\text{MWh}\n$$\nThis value has four significant figures.\n\n**3. Articulation of Planning Implications**\n\nThe computed metrics are $\\text{LOLE} \\approx 57.00$ hours/year and $\\text{EUE} = 13280$ MWh/year. These two metrics, while related, emphasize different aspects of system reliability risk.\n\nLOLE measures the *frequency* of reliability events. A value of $57$ hours per year is extremely high compared to typical industry targets (e.g., $0.1$ days/year, or $2.4$ hours/year). This indicates that the system is expected to experience capacity shortfalls frequently. A planner focusing solely on LOLE would conclude that the system is chronically unreliable and would prioritize investments that reduce the number of shortfall hours, regardless of their magnitude. This might include improving generator availability or adding small but highly reliable peaking units.\n\nEUE measures the expected *volume* of energy not served, which combines the frequency, duration, and magnitude of shortfalls. It is a measure of the total impact of unreliability. A high EUE indicates that the sum of all shortfalls, large and small, is significant. In this problem, the largest contribution to LOLE comes from the second-highest load block ($24$ hours), not the peak load block ($12$ hours). Similarly, the largest contribution to EUE also comes from this second block ($6240$ MWh), which is more than double the contribution from the peak block ($2240$ MWh).\n\nThe different emphases are clear:\n- The high LOLE signals that shortfalls are a common occurrence. The system frequently lacks a sufficient capacity margin.\n- The EUE analysis reveals that the most significant risk, in terms of unserved energy, is not from the very few peak load hours but from the more numerous hours of high, sustained load ($L_2=1200$ MW for $h_2=600$ hours). During these periods, the conditional expected shortfall size is larger than during peak hours, and these events occur for a longer total duration.\n\n**Planning Implications:**\nIf a planner were to focus only on LOLE, they might misdiagnose the primary driver of risk. For instance, they might focus on adding a small amount of capacity a \"peaker\" plant dedicated to serving the absolute peak load $L_1$. This would reduce LOLE but might have a smaller impact on EUE.\n\nThe EUE result, however, suggests a more systemic capacity shortage. The largest risk contributor is a load level that persists for $600$ hours. This implies that the solution should not be narrowly targeted at just the top few peak hours. Instead, a more robust solution is needed, such as adding a larger block of reliable capacity (a baseload or mid-merit plant) or implementing demand response programs that can be activated for extended durations to lower the load plateau represented by $L_2$. Thus, EUE provides a more nuanced view of risk that accounts for the severity of outages, guiding planners toward investments that more effectively mitigate the overall impact of unserved energy, not just the frequency of its occurrence. In this case, both metrics indicate poor reliability, but EUE better characterizes the nature and source of the risk, pointing to a need for more substantial, rather than merely peak-shaving, resource additions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n57.00  13280\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The ultimate purpose of calculating adequacy metrics is to guide investment and ensure a reliable, cost-effective power system. This final practice moves from assessment to application by framing a resource expansion challenge as a formal optimization problem . You will use the practical concept of Effective Load Carrying Capability ($ELCC$) to determine the least-cost portfolio of new resources required to meet a specific $LOLE$ target, and in doing so, you will uncover the economic value of reliability itself through the constraint's shadow price.",
            "id": "4119492",
            "problem": "Consider a resource adequacy planning problem for a small electric power system. The reliability metric of interest is the Loss of Load Expectation (LOLE), defined as the expected number of hours per year that system load exceeds available capacity. Formally, let $L_t$ denote the load in hour $t$, and let $C_t$ denote the available capacity in hour $t$; then the Loss of Load Expectation (LOLE) is the expectation of the total number of hours of shortfall over a year:\n$$\nLOLE = \\mathbb{E}\\left[\\sum_{t=1}^{T} \\mathbf{1}\\{L_t > C_t\\}\\right],\n$$\nwhere $\\mathbf{1}\\{\\cdot\\}$ is the indicator function and $T$ is the number of hours in a year. The available capacity $C_t$ is a random variable due to outages and variability, and the expectation is taken over the joint distribution of load and availability.\n\nIn expansion planning, candidate resources can be added with decision variables representing installed capacity measured in megawatts (MW). For small changes in capacity relative to the base system, the reduction in $LOLE$ can be approximated by a first-order sensitivity expansion, where each resource $i$ has an Effective Load Carrying Capability (ELCC) coefficient that represents the marginal reduction in $LOLE$ per megawatt added. Specifically, if $x_i$ denotes the capacity of resource $i$ added, and $a_i$ denotes its ELCC coefficient expressed in hours per year per megawatt, the total reduction in $LOLE$ relative to the base system is approximated by $\\sum_i a_i x_i$.\n\nThe annualized cost of installing capacity $x_i$ of resource $i$ is $c_i x_i$ dollars per year, where $c_i$ is the cost rate in dollars per megawatt-year. Each resource has a maximum build limit $u_i$ (in MW), and decision variables must satisfy $0 \\le x_i \\le u_i$.\n\nYour task is to solve, for each test case, the cost-minimizing portfolio of candidate resources subject to an $LOLE$ reliability constraint requiring that the resulting $LOLE$ does not exceed a target value. You must also compute and report the shadow price (dual value) of the binding reliability constraint. The shadow price must be expressed in dollars per hour-year and represents the marginal increase in optimal annualized cost for a one-hour tightening of the reliability requirement (i.e., a one-hour decrease in allowable $LOLE$).\n\nFundamental base to be used:\n- The definition of $LOLE$ as an expectation of an indicator sum over hours, as given above.\n- The concept of first-order sensitivity (linearization) of $LOLE$ with respect to added capacity, where the ELCC coefficients $a_i$ are given constants derived from reliability assessment of the base system.\n\nFormulate the optimization using these principles without relying on any pre-supplied shortcut formula. The decision variables are continuous capacities $x_i$ in megawatts (MW). The optimization must minimize total annualized cost subject to meeting or exceeding the required reduction in $LOLE$, and subject to the resource-specific capacity limits.\n\nUnits and output requirements:\n- All capacities $x_i$ must be computed in megawatts (MW).\n- The $LOLE$ values are in hours per year.\n- Costs are in dollars per year.\n- The shadow price must be expressed in dollars per hour-year.\n- Your program must print each numeric output as a decimal with $6$ digits after the decimal point.\n\nTest suite:\nSolve the problem for the following three test cases. In each case, the order of candidate resources is fixed as: resource $1$ is Solar Photovoltaic (PV), resource $2$ is Wind, and resource $3$ is Gas Combustion Turbine (CT).\n\n- Test case $1$:\n  - Base $LOLE$: $6.0$ hours per year.\n  - Target $LOLE$: $0.1$ hours per year.\n  - Resource data:\n    - Solar PV: $c_1 = 80000$ dollars per megawatt-year, $a_1 = 0.7$ hours per megawatt-year, $u_1 = 50$ megawatts.\n    - Wind: $c_2 = 70000$ dollars per megawatt-year, $a_2 = 0.4$ hours per megawatt-year, $u_2 = 80$ megawatts.\n    - Gas CT: $c_3 = 120000$ dollars per megawatt-year, $a_3 = 1.0$ hours per megawatt-year, $u_3 = 30$ megawatts.\n- Test case $2$:\n  - Base $LOLE$: $0.08$ hours per year.\n  - Target $LOLE$: $0.1$ hours per year.\n  - Resource data (same as test case $1$):\n    - Solar PV: $c_1 = 80000$, $a_1 = 0.7$, $u_1 = 50$.\n    - Wind: $c_2 = 70000$, $a_2 = 0.4$, $u_2 = 80$.\n    - Gas CT: $c_3 = 120000$, $a_3 = 1.0$, $u_3 = 30$.\n- Test case $3$:\n  - Base $LOLE$: $30.0$ hours per year.\n  - Target $LOLE$: $0.1$ hours per year.\n  - Resource data (tight build limits):\n    - Solar PV: $c_1 = 80000$, $a_1 = 0.7$, $u_1 = 20$.\n    - Wind: $c_2 = 70000$, $a_2 = 0.4$, $u_2 = 20$.\n    - Gas CT: $c_3 = 120000$, $a_3 = 1.0$, $u_3 = 10$.\n\nFinal output format:\n- For each test case, your program must compute the optimal capacities $(x_1, x_2, x_3)$ in megawatts and the shadow price $\\lambda$ in dollars per hour-year of the binding $LOLE$ reliability constraint.\n- Your program should produce a single line of output containing the results for all test cases concatenated in order, as a comma-separated list enclosed in square brackets. The per-test-case output order must be $[x_1, x_2, x_3, \\lambda]$, and the global output must be $[x_1^{(1)}, x_2^{(1)}, x_3^{(1)}, \\lambda^{(1)}, x_1^{(2)}, x_2^{(2)}, x_3^{(2)}, \\lambda^{(2)}, x_1^{(3)}, x_2^{(3)}, x_3^{(3)}, \\lambda^{(3)}]$, where the superscript denotes the test case index.\n- All printed numbers must have exactly $6$ digits after the decimal point and be in the units specified above.",
            "solution": "The problem presented is a classic resource adequacy optimization problem, which can be formulated and solved as a Linear Program (LP). The goal is to determine the least-cost investment portfolio of new generation resources that satisfies a system-wide reliability constraint, along with individual resource build limits.\n\nFirst, we formalize the optimization problem. Let $x_i$ be the continuous decision variable representing the capacity (in MW) of resource $i$ to be added, where $i \\in \\{1, 2, 3\\}$ for Solar PV, Wind, and Gas CT, respectively.\n\nThe objective function is to minimize the total annualized cost, which is a linear combination of the capacities built:\n$$\n\\text{Minimize} \\quad Z = \\sum_{i=1}^{3} c_i x_i\n$$\nwhere $c_i$ is the annualized cost rate for resource $i$ in dollars per megawatt-year.\n\nThe primary constraint is the reliability requirement. The initial system has a base $LOLE_{base}$. Adding capacities $x_i$ yields an LOLE reduction approximated by $\\sum_i a_i x_i$, where $a_i$ is the Effective Load Carrying Capability (ELCC) coefficient for resource $i$. The resulting LOLE, $LOLE_{final} = LOLE_{base} - \\sum_i a_i x_i$, must not exceed the target value, $LOLE_{target}$.\n$$\nLOLE_{base} - \\sum_{i=1}^{3} a_i x_i \\le LOLE_{target}\n$$\nThis inequality can be rearranged to express a minimum required LOLE reduction:\n$$\n\\sum_{i=1}^{3} a_i x_i \\ge LOLE_{base} - LOLE_{target}\n$$\nLet $\\Delta LOLE = LOLE_{base} - LOLE_{target}$ be the required total reduction in LOLE.\n\nAdditionally, the capacity of each new resource is non-negative and cannot exceed its maximum build limit, $u_i$:\n$$\n0 \\le x_i \\le u_i \\quad \\text{for } i=1, 2, 3\n$$\n\nThe complete LP formulation is:\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  Z = c_1 x_1 + c_2 x_2 + c_3 x_3 \\\\\n\\text{subject to} \\quad  a_1 x_1 + a_2 x_2 + a_3 x_3 \\ge \\Delta LOLE \\\\\n 0 \\le x_1 \\le u_1 \\\\\n 0 \\le x_2 \\le u_2 \\\\\n 0 \\le x_3 \\le u_3\n\\end{aligned}\n$$\n\nThis type of problem, known as a continuous knapsack problem, can be solved optimally using a greedy algorithm. The strategy is to prioritize resources that provide the required LOLE reduction at the lowest cost. To do this, we compute a cost-effectiveness ratio, $b_i$, for each resource, which represents the cost per unit of LOLE reduction:\n$$\nb_i = \\frac{c_i}{a_i} \\quad [\\text{in dollars per hour-year}]\n$$\nA lower value of $b_i$ indicates a more cost-effective resource for reliability improvement. The algorithm proceeds as follows:\n1. Calculate the required LOLE reduction, $\\Delta LOLE = LOLE_{base} - LOLE_{target}$. If $\\Delta LOLE \\le 0$, the system already meets the reliability target, so the optimal solution is to build nothing ($x_i = 0$ for all $i$), and the total cost is $0$. The LOLE constraint is not binding, so its shadow price is $0$.\n2. If $\\Delta LOLE > 0$, rank the resources in ascending order of their cost-effectiveness ratio $b_i$.\n3. Iterate through the ranked resources. For each resource $i$, add capacity up to its build limit $u_i$, or just enough to meet the remaining LOLE reduction requirement, whichever is smaller.\n4. The procedure stops once the total LOLE reduction requirement, $\\Delta LOLE$, is met. The last resource used to meet the target is called the marginal resource.\n\nThe shadow price, $\\lambda$, of the LOLE constraint represents the marginal cost to the system of tightening the constraint, i.e., increasing the required LOLE reduction $\\Delta LOLE$ by one hour. In this framework, this is exactly the cost of obtaining one more hour of LOLE reduction. This cost is determined by the cost-effectiveness ratio $b_i$ of the marginal resource. Thus, $\\lambda = b_{\\text{marginal_resource}} = c_{\\text{marginal_resource}} / a_{\\text{marginal_resource}}$. If no new resources are needed (Step 1), the constraint is non-binding, and $\\lambda = 0$.\n\nLet's apply this algorithm to Test Case 3 as an illustration:\n- **Givens**: $LOLE_{base} = 30.0$, $LOLE_{target} = 0.1$. Resources:\n  - PV ($i=1$): $c_1=80000$, $a_1=0.7$, $u_1=20$\n  - Wind ($i=2$): $c_2=70000$, $a_2=0.4$, $u_2=20$\n  - Gas CT ($i=3$): $c_3=120000$, $a_3=1.0$, $u_3=10$\n1. **Required Reduction**: $\\Delta LOLE = 30.0 - 0.1 = 29.9$ hours.\n2. **Cost-Effectiveness Ratios ($b_i$)**:\n   - PV: $b_1 = 80000 / 0.7 \\approx 114285.71$\n   - Wind: $b_2 = 70000 / 0.4 = 175000.00$\n   - Gas CT: $b_3 = 120000 / 1.0 = 120000.00$\n   The sorted order of preference is PV, then Gas CT, then Wind.\n3. **Greedy Allocation**:\n   - **Step 3.1 (PV)**: Select the most cost-effective resource, PV. Its maximum potential LOLE reduction is $a_1 u_1 = 0.7 \\times 20 = 14.0$ hours. Since $14.0  29.9$, we build the maximum capacity.\n     - $x_1 = 20.0$ MW.\n     - LOLE reduction achieved: $14.0$ hours.\n     - Remaining reduction needed: $29.9 - 14.0 = 15.9$ hours.\n   - **Step 3.2 (Gas CT)**: Select the next resource, Gas CT. Its maximum potential reduction is $a_3 u_3 = 1.0 \\times 10 = 10.0$ hours. Since $10.0  15.9$, we build the maximum capacity.\n     - $x_3 = 10.0$ MW.\n     - LOLE reduction achieved: $10.0$ hours.\n     - Remaining reduction needed: $15.9 - 10.0 = 5.9$ hours.\n   - **Step 3.3 (Wind)**: Select the last resource, Wind. We need $5.9$ hours of reduction. The maximum potential from Wind is $a_2 u_2 = 0.4 \\times 20 = 8.0$ hours. Since $5.9  8.0$, we only need to build a partial amount.\n     - Capacity needed: $x_2 = 5.9 / a_2 = 5.9 / 0.4 = 14.75$ MW. This is within the limit ($14.75 \\le 20$).\n     - $x_2 = 14.75$ MW.\n     - LOLE reduction achieved: $5.9$ hours.\n     - Remaining reduction needed: $5.9 - 5.9 = 0$. The target is met.\n4. **Final Portfolio**: $(x_1, x_2, x_3) = (20.0, 14.75, 10.0)$ MW.\n5. **Shadow Price**: The marginal resource is Wind, as it was the last one used.\n   - $\\lambda = b_2 = c_2 / a_2 = 70000 / 0.4 = 175000$ dollars per hour-year.\n\nThis systematic procedure is applied to each test case to generate the required outputs.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of resource adequacy optimization problems.\n\n    For each test case, the function calculates the cost-minimizing portfolio of\n    generation resources to meet a reliability target (LOLE) and computes the\n    shadow price of the reliability constraint. The problem is modeled as a\n    Linear Program and solved using a greedy algorithm based on the cost-\n    effectiveness of each resource.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"base_lole\": 6.0,\n            \"target_lole\": 0.1,\n            \"resources\": [  # (cost, elcc, max_build) for [PV, Wind, Gas CT]\n                (80000, 0.7, 50),\n                (70000, 0.4, 80),\n                (120000, 1.0, 30),\n            ]\n        },\n        {\n            \"base_lole\": 0.08,\n            \"target_lole\": 0.1,\n            \"resources\": [\n                (80000, 0.7, 50),\n                (70000, 0.4, 80),\n                (120000, 1.0, 30),\n            ]\n        },\n        {\n            \"base_lole\": 30.0,\n            \"target_lole\": 0.1,\n            \"resources\": [\n                (80000, 0.7, 20),\n                (70000, 0.4, 20),\n                (120000, 1.0, 10),\n            ]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        base_lole = case[\"base_lole\"]\n        target_lole = case[\"target_lole\"]\n        resource_data = case[\"resources\"]\n        num_resources = len(resource_data)\n\n        # Calculate the required reduction in LOLE\n        lole_reduction_needed = base_lole - target_lole\n\n        # Initialize results\n        x = np.zeros(num_resources)\n        shadow_price = 0.0\n\n        if lole_reduction_needed > 0:\n            # Create a list of resources with their original index and cost-effectiveness\n            # Ratio is cost / elcc_coeff (c/a)\n            # A lower ratio is more cost-effective\n            indexed_resources = []\n            for i, (c, a, u) in enumerate(resource_data):\n                cost_effectiveness = c / a if a > 0 else float('inf')\n                indexed_resources.append({\n                    'original_index': i,\n                    'cost': c,\n                    'elcc': a,\n                    'limit': u,\n                    'cost_effectiveness': cost_effectiveness\n                })\n\n            # Sort resources by cost-effectiveness (ascending)\n            sorted_resources = sorted(indexed_resources, key=lambda r: r['cost_effectiveness'])\n\n            remaining_reduction = lole_reduction_needed\n            \n            # Check for feasibility before allocation\n            total_possible_reduction = sum(r['elcc'] * r['limit'] for r in sorted_resources)\n            if total_possible_reduction  remaining_reduction:\n                # This case should not occur with the given problem data,\n                # but is good practice to include.\n                raise ValueError(\"Problem is infeasible: not enough resources to meet target LOLE.\")\n\n            # Greedily add capacity from the most cost-effective resources\n            for res in sorted_resources:\n                if remaining_reduction = 0:\n                    break\n\n                # The current resource becomes the marginal resource\n                shadow_price = res['cost_effectiveness']\n                original_idx = res['original_index']\n                \n                # Max LOLE reduction this resource can provide\n                max_reduction_from_res = res['elcc'] * res['limit']\n                \n                # Determine how much reduction to get from this resource\n                reduction_to_take = min(remaining_reduction, max_reduction_from_res)\n                \n                # Calculate the capacity to build\n                capacity_to_build = reduction_to_take / res['elcc']\n                x[original_idx] = capacity_to_build\n                \n                # Update the remaining LOLE reduction needed\n                remaining_reduction -= reduction_to_take\n\n        # Append the results for this case\n        all_results.extend(list(x) + [shadow_price])\n\n    # Format and print the final output string\n    formatted_results = [f\"{val:.6f}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}