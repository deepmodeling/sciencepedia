{
    "hands_on_practices": [
        {
            "introduction": "在评估可靠性之前，我们需要全面了解可用的发电容量。本练习将引导您掌握一种基础的递归算法，该算法用于将单个发电机的故障概率合并为整个系统容量的单一概率分布。掌握这个练习  是概率性资源充裕度分析的基石。",
            "id": "4102912",
            "problem": "您正在处理一个能源系统建模中的随机容量聚合问题。考虑 $n$ 个独立的两状态发电机组。对于每个机组 $i \\in \\{1,\\dots,n\\}$，其可用容量随机变量 $X_i$ 以概率 $a_i = 1 - q_i$ 取值为 $s_i$（单位为 $\\mathrm{MW}$），以概率 $q_i$ 取值为 $0$，其中 $q_i$ 是强迫停运率。假设所有 $X_i$ 相互独立。将总可用容量随机变量定义为 $C = \\sum_{i=1}^n X_i$。\n\n您的任务如下：\n\n- 仅从概率公理（例如，全概率定律和独立性）和给定设置出发，推导一个递归算法，用以计算 $C$ 的概率质量函数，记为 $p(c) = \\mathbb{P}(C = c)$，其中 $c$ 为所有整数 $c \\in \\{0,1,\\dots,S\\}$，且 $S = \\sum_{i=1}^n s_i$。机组容量 $s_i$ 和总容量 $S$ 的单位为 $\\mathrm{MW}$，且限定为整数值。\n\n- 根据 $n$ 和 $S$ 分析您的递归算法的计算复杂性。提供一个基于您的递归执行的基本概率更新次数的精确运算计数表达式，以及一个大$\\mathcal{O}$界。请明确定义什么构成一次基本更新。\n\n- 使用推导出的概率质量函数 $p(c)$，计算两个标准的充裕度指标：\n  - 缺负荷概率 (LOLP)：可用容量不足以满足负荷的期望时间分数。给定一个具有负荷水平 $L_j$（单位为 $\\mathrm{MW}$）和相关持续时间 $h_j$（单位为 $\\mathrm{hours}$）的离散负荷模型，定义 $w_j = h_j / H$，其中 $H = \\sum_j h_j$（单位为 $\\mathrm{hours}$），并以小数形式计算 $\\mathrm{LOLP} = \\sum_j w_j \\cdot \\mathbb{P}(C  L_j)$。\n  - 期望未服务电量 (EUE)：在考察期内的期望电量短缺，以 $\\mathrm{MWh}$ 为单位计算为 $\\mathrm{EUE} = \\sum_j h_j \\cdot \\mathbb{E}[(L_j - C)_+]$，其中 $(x)_+ = \\max\\{x,0\\}$，期望是关于概率质量函数 $p(c)$ 计算的。\n\n所有负荷 $L_j$ 必须是 $\\mathrm{MW}$ 为单位的整数，以与离散化的容量状态兼容，持续时间 $h_j$ 必须是 $\\mathrm{hours}$ 为单位的整数。将 $\\mathrm{LOLP}$ 表示为小数，$\\mathrm{EUE}$ 以 $\\mathrm{MWh}$ 为单位表示。在描述您的复杂性时，请使用 $n$ 和 $S$，并提供以整数表示的精确算术更新计数和使用大$\\mathcal{O}$表示法的渐近界。\n\n您的程序必须实现所推导的递归算法，并为每个测试用例计算三元组 `[LOLP, EUE, U]`，其中 $U$ 是您的递归执行的基本更新的精确整数计数（单次更新包括将一个概率贡献量添加到一个概率条目中）。将每个浮点指标四舍五入到 $6$ 位小数，并按指定顺序输出每个三元组。\n\n测试套件：\n- 测试用例 1 (一般情况)：\n  - 机组：$n = 3$，容量 $\\{s_1, s_2, s_3\\} = \\{50, 50, 30\\}$ $\\mathrm{MW}$，强迫停运率 $\\{q_1, q_2, q_3\\} = \\{0.1, 0.2, 0.05\\}$，因此可用率 $\\{a_1, a_2, a_3\\} = \\{0.9, 0.8, 0.95\\}$。\n  - 负荷水平：$\\{L_1, L_2, L_3\\} = \\{60, 90, 120\\}$ $\\mathrm{MW}$。\n  - 持续时间：$\\{h_1, h_2, h_3\\} = \\{3000, 4000, 1760\\}$ $\\mathrm{hours}$，所以 $H = 8760$ $\\mathrm{hours}$。\n\n- 测试用例 2 (边界情况：始终可用)：\n  - 机组：$n = 2$，容量 $\\{s_1, s_2\\} = \\{10, 20\\}$ $\\mathrm{MW}$，强迫停运率 $\\{q_1, q_2\\} = \\{0, 0\\}$，因此可用率 $\\{a_1, a_2\\} = \\{1, 1\\}$。\n  - 负荷水平：$\\{L_1\\} = \\{40\\}$ $\\mathrm{MW}$。\n  - 持续时间：$\\{h_1\\} = \\{8760\\}$ $\\mathrm{hours}$，所以 $H = 8760$ $\\mathrm{hours}$。\n\n- 测试用例 3 (边界情况：从不可用)：\n  - 机组：$n = 3$，容量 $\\{s_1, s_2, s_3\\} = \\{10, 15, 25\\}$ $\\mathrm{MW}$，强迫停运率 $\\{q_1, q_2, q_3\\} = \\{1, 1, 1\\}$，因此可用率 $\\{a_1, a_2, a_3\\} = \\{0, 0, 0\\}$。\n  - 负荷水平：$\\{L_1, L_2, L_3\\} = \\{5, 20, 30\\}$ $\\mathrm{MW}$。\n  - 持续时间：$\\{h_1, h_2, h_3\\} = \\{2000, 3000, 3760\\}$ $\\mathrm{hours}$，所以 $H = 8760$ $\\mathrm{hours}$。\n\n- 测试用例 4 (相同机组容量和对称可用性)：\n  - 机组：$n = 4$，容量 $\\{s_1, s_2, s_3, s_4\\} = \\{25, 25, 25, 25\\}$ $\\mathrm{MW}$，强迫停运率 $\\{q_1, q_2, q_3, q_4\\} = \\{0.5, 0.5, 0.5, 0.5\\}$，因此可用率 $\\{a_1, a_2, a_3, a_4\\} = \\{0.5, 0.5, 0.5, 0.5\\}$。\n  - 负荷水平：$\\{L_1, L_2, L_3\\} = \\{30, 70, 80\\}$ $\\mathrm{MW}$。\n  - 持续时间：$\\{h_1, h_2, h_3\\} = \\{1000, 3000, 4760\\}$ $\\mathrm{hours}$，所以 $H = 8760$ $\\mathrm{hours}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的三元组列表，每个测试用例一个三元组，并用方括号括起来。每个三元组本身也必须是按 `[LOLP, EUE, U]` 顺序排列、用方括号括起来的逗号分隔列表。例如，包含两个测试用例的输出应类似于 `[[x_1,y_1,z_1],[x_2,y_2,z_2]]`，其中 $x_k$ 和 $y_k$ 是四舍五入到 $6$ 位小数的浮点数，$z_k$ 是一个整数。",
            "solution": "问题陈述在能源系统建模领域提出了一个有效且定义明确的任务，具体涉及发电机组容量的可靠性评估。它在科学上基于概率论，在数学上是一致的，并且为获得唯一解提供了所有必要的参数和定义。它代表了一个计算容量停运概率表 (COPT) 及相关可靠性指标的标准问题。我将继续提供完整解决方案。\n\n**1. 概率质量函数 (PMF) 递归算法的推导**\n\n假设有 $n$ 个独立的两状态发电机组。对于机组 $i \\in \\{1, \\dots, n\\}$，其可用容量是一个随机变量 $X_i$，具有以下概率质量函数 (PMF)：\n$$\n\\mathbb{P}(X_i = s_i) = a_i = 1 - q_i\n$$\n$$\n\\mathbb{P}(X_i = 0) = q_i\n$$\n其中 $s_i$ 是容量（一个以 $\\mathrm{MW}$ 为单位的整数），$q_i$ 是强迫停运率，$a_i$ 是可用率。总可用容量是随机变量 $C = \\sum_{i=1}^n X_i$。我们需要求出 $C$ 的 PMF，记为 $p(c) = \\mathbb{P}(C=c)$。\n\n我们将推导一个递归算法。令 $C_k = \\sum_{i=1}^k X_i$ 为前 $k$ 个机组的累计容量，令 $p_k(c) = \\mathbb{P}(C_k=c)$ 为其 PMF。我们寻求的最终 PMF 是 $p_n(c)$。\n\n递归的基准情形是一个没有机组的系统。总容量 $C_0=0$ 的概率为 $1$。因此，初始 PMF 为：\n$$\np_0(0) = 1, \\quad \\text{and} \\quad p_0(c) = 0 \\text{ for } c \\neq 0\n$$\n\n对于递归步骤，我们希望在给定 $k-1$ 个机组的 PMF $p_{k-1}(c)$ 的情况下，求出 $k$ 个机组的 PMF $p_k(c)$。前 $k$ 个机组的容量是 $C_k = C_{k-1} + X_k$。由于所有机组都是独立的，随机变量 $X_k$ 与 $C_{k-1}$ 独立。两个独立离散随机变量之和的 PMF 是它们各自 PMF 的卷积。\n\n让我们应用全概率定律，以机组 $k$ 的状态为条件：\n$$\np_k(c) = \\mathbb{P}(C_k = c) = \\mathbb{P}(C_{k-1} + X_k = c)\n$$\n$$\np_k(c) = \\mathbb{P}(C_{k-1} + X_k = c | X_k = 0)\\mathbb{P}(X_k=0) + \\mathbb{P}(C_{k-1} + X_k = c | X_k = s_k)\\mathbb{P}(X_k=s_k)\n$$\n代入 $X_k$ 的概率：\n$$\np_k(c) = \\mathbb{P}(C_{k-1} + 0 = c) \\cdot q_k + \\mathbb{P}(C_{k-1} + s_k = c) \\cdot a_k\n$$\n这可以简化为核心递推关系：\n$$\np_k(c) = \\mathbb{P}(C_{k-1} = c) \\cdot q_k + \\mathbb{P}(C_{k-1} = c - s_k) \\cdot a_k\n$$\n$$\np_k(c) = p_{k-1}(c) \\cdot q_k + p_{k-1}(c - s_k) \\cdot a_k\n$$\n在此关系中，如果 $c  s_k$ 或者 $c-s_k$ 不是 $C_{k-1}$ 的一个可能容量状态，则 $p_{k-1}(c-s_k)$ 取为 $0$。\n\n这个递推关系提出了一个迭代算法。我们从 $k=0$ 的 PMF 开始，即在容量 $0$ 处有概率质量 $1$。然后，对于每个机组 $k=1, \\dots, n$，我们从前一个 PMF $p_{k-1}$ 构建新的 PMF $p_k$。对于 $C_{k-1}$ 定义域中概率为 $p_{k-1}(c')$ 的每个现有容量状态 $c'$，增加机组 $k$ 会产生两种可能性：\n1.  机组 $k$ 停运（概率为 $q_k$）：新容量为 $c'$，此路径的概率为 $p_{k-1}(c') \\cdot q_k$。此概率质量被添加到新 PMF 的状态 $c'$ 上。\n2.  机组 $k$ 可用（概率为 $a_k$）：新容量为 $c' + s_k$，此路径的概率为 $p_{k-1}(c') \\cdot a_k$。此概率质量被添加到新 PMF 的状态 $c' + s_k$ 上。\n\n在算法上，这可以通过维护一个表示当前 PMF 的数组来实现。在添加新机组时，使用一个临时数组来构建新的 PMF，以避免在计算过程中破坏当前的 PMF。\n\n**2. 计算复杂性分析**\n\n令 $S = \\sum_{i=1}^n s_i$ 为总装机容量。PMF 将存储在一个大小为 $S+1$ 的数组中。\n\n一次基本更新被定义为“将一个概率贡献量添加到一个概率条目中”。在我们的递归算法中，对于每个非零概率状态 $p_{k-1}(c')>0$，我们执行两次这样的更新来构建 $p_k$：一次用于停运情况，一次用于可用情况。\n\n令 $\\mathcal{C}_{k-1}$ 为所有满足 $p_{k-1}(c') > 0$ 的容量值 $c'$ 的集合。从 $p_{k-1}$ 计算 $p_k$ 所需的基本更新次数恰好是 $2 \\cdot |\\mathcal{C}_{k-1}|$，其中 $|\\cdot|$ 表示集合的基数。\n\n计算最终 PMF $p_n$ 的基本更新总数 $U$ 是对所有步骤 $k=1, \\dots, n$ 的总和：\n$$\nU = \\sum_{k=1}^{n} 2 \\cdot |\\mathcal{C}_{k-1}|\n$$\n其中 $\\mathcal{C}_0 = \\{0\\}$，所以 $|\\mathcal{C}_0| = 1$。这就是精确的运算计数表达式。\n\n对于渐近大$\\mathcal{O}$界，令 $S_k = \\sum_{i=1}^k s_i$。增加 $k$ 个机组后可能的容量状态数 $|\\mathcal{C}_k|$ 最多为 $S_k+1$。由于对所有 $k$ 都有 $S_k \\le S$，我们有 $|\\mathcal{C}_{k-1}| \\le S_{k-1}+1 \\le S+1$。\n\n总操作数受实现中循环的复杂性限制。一个标准的实现会遍历 $n$ 个机组。对于每个机组 $k$，它会遍历 $C_{k-1}$ 的所有可能容量水平，最多有 $S_{k-1}+1$ 个状态。最大可能容量是 $S$。因此，内层循环最多运行 $S+1$ 次。外层循环运行 $n$ 次。因此，复杂性为：\n$$\n\\mathcal{O}(n \\cdot S)\n$$\n\n**3. 充裕度指标**\n\n给定最终的 PMF，$p(c) = p_n(c)$，其中 $c \\in \\{0, 1, \\dots, S\\}$，我们计算可靠性指标。\n\n**缺负荷概率 (LOLP):**\nLOLP 是容量小于负荷的期望时间分数。对于离散负荷模型 ($L_j, h_j$)，公式为 $\\mathrm{LOLP} = \\sum_j w_j \\cdot \\mathbb{P}(C  L_j)$，其中 $w_j = h_j / H$ 且 $H = \\sum_j h_j$。\n\n概率项 $\\mathbb{P}(C  L_j)$ 可以从 PMF $p(c)$ 计算得出：\n$$\n\\mathbb{P}(C  L_j) = \\sum_{c=0}^{L_j - 1} p(c)\n$$\n这是累积分布函数 (CDF) 在 $L_j-1$ 处的值。令 $F_C(x) = \\mathbb{P}(C \\le x)$。那么 $\\mathbb{P}(C  L_j) = F_C(L_j - 1)$。\n\n**期望未服务电量 (EUE):**\nEUE 是在此期间内未供应的期望总电量。公式为 $\\mathrm{EUE} = \\sum_j h_j \\cdot \\mathbb{E}[(L_j - C)_+]$。项 $(x)_+ = \\max\\{x,0\\}$ 表示电量短缺。\n\n期望 $\\mathbb{E}[(L_j - C)_+]$ 是通过 $C$ 的分布计算的：\n$$\n\\mathbb{E}[(L_j - C)_+] = \\sum_{c=0}^{S} (L_j - c)_+ \\cdot p(c) = \\sum_{c=0}^{L_j-1} (L_j - c) \\cdot p(c)\n$$\n求和在 $L_j-1$ 处停止，因为对于 $c \\ge L_j$，短缺量 $(L_j - c)_+$ 为零。\n\n总 EUE 则是这些期望短缺量的总和，每个短缺量都按其持续时间 $h_j$ 加权：\n$$\n\\mathrm{EUE} = \\sum_j h_j \\left( \\sum_{c=0}^{L_j-1} (L_j - c) \\cdot p(c) \\right)\n$$\n一旦 PMF $p(c)$ 已知，这两个指标都可以直接计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the energy system reliability problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"units\": {\"s\": [50, 50, 30], \"q\": [0.1, 0.2, 0.05]},\n            \"load\": {\"L\": [60, 90, 120], \"h\": [3000, 4000, 1760]},\n        },\n        # Test case 2 (boundary: always available)\n        {\n            \"units\": {\"s\": [10, 20], \"q\": [0.0, 0.0]},\n            \"load\": {\"L\": [40], \"h\": [8760]},\n        },\n        # Test case 3 (boundary: never available)\n        {\n            \"units\": {\"s\": [10, 15, 25], \"q\": [1.0, 1.0, 1.0]},\n            \"load\": {\"L\": [5, 20, 30], \"h\": [2000, 3000, 3760]},\n        },\n        # Test case 4 (identical unit capacities and symmetric availability)\n        {\n            \"units\": {\"s\": [25, 25, 25, 25], \"q\": [0.5, 0.5, 0.5, 0.5]},\n            \"load\": {\"L\": [30, 70, 80], \"h\": [1000, 3000, 4760]},\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        s_values = case[\"units\"][\"s\"]\n        q_values = case[\"units\"][\"q\"]\n        units = list(zip(s_values, q_values))\n        \n        load_levels = case[\"load\"][\"L\"]\n        durations = case[\"load\"][\"h\"]\n        \n        # 1. Compute PMF and update count\n        pmf, update_count = calculate_pmf_and_updates(units)\n        \n        # 2. Compute LOLP and EUE\n        lolp, eue = calculate_metrics(pmf, load_levels, durations)\n        \n        # 3. Store results\n        result_triplet = [\n            round(lolp, 6),\n            round(eue, 6),\n            update_count\n        ]\n        all_results.append(result_triplet)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\ndef calculate_pmf_and_updates(units):\n    \"\"\"\n    Calculates the Probability Mass Function (PMF) of total available capacity\n    using a recursive algorithm and counts the elementary updates.\n\n    An elementary update is one addition of a probability mass contribution.\n    \"\"\"\n    total_capacity = sum(u[0] for u in units)\n    pmf = np.zeros(total_capacity + 1, dtype=np.float64)\n    pmf[0] = 1.0\n    \n    update_count = 0\n    current_max_cap = 0\n\n    for s, q in units:\n        a = 1.0 - q\n        \n        # Store the previous PMF to build the new one\n        pmf_prev = pmf.copy()\n        \n        # To count updates precisely, we iterate over non-zero states\n        # in the previous PMF.\n        non_zero_indices = np.where(pmf_prev[:current_max_cap + 1] > 0)[0]\n        \n        # Count updates for all non-zero source states\n        # Each source state generates two contributions to the new PMF.\n        update_count += 2 * len(non_zero_indices)\n        \n        # This implementation uses a backward iteration to update in place\n        # It's more memory efficient than using a temporary array.\n        # The logic for counting updates remains based on the conceptual model.\n        for c in range(current_max_cap, -1, -1):\n            if pmf[c] > 0:\n                prob_at_c = pmf[c]\n                # Contribution to state c + s (unit available)\n                pmf[c + s] += prob_at_c * a\n                # Update state c (unit on outage)\n                pmf[c] = prob_at_c * q\n        \n        current_max_cap += s\n\n    return pmf, update_count\n\ndef calculate_metrics(pmf, load_levels, durations):\n    \"\"\"\n    Computes LOLP and EUE using the final capacity PMF.\n    \"\"\"\n    S_total = len(pmf) - 1\n    total_hours = sum(durations)\n    \n    # Calculate Cumulative Distribution Function (CDF)\n    cdf = np.cumsum(pmf)\n    \n    # --- LOLP Calculation ---\n    lolp = 0.0\n    for L, h in zip(load_levels, durations):\n        w = h / total_hours\n        prob_shortfall = 0.0\n        if L > 0:\n            index = L - 1\n            if index  len(cdf):\n                prob_shortfall = cdf[index]\n            else: # Load is greater than max possible capacity\n                prob_shortfall = 1.0\n        lolp += w * prob_shortfall\n        \n    # --- EUE Calculation ---\n    eue = 0.0\n    capacities = np.arange(S_total + 1)\n    for L, h in zip(load_levels, durations):\n        # Calculate expected energy shortfall for this load level\n        # E[(L-C)+] = sum_{c=0}^{L-1} (L-c) * P(C=c)\n        limit = min(L, S_total + 1)\n        indices = np.arange(limit)\n        \n        shortfalls = L - capacities[indices]\n        probs = pmf[indices]\n        \n        expected_shortfall = np.sum(shortfalls * probs)\n        eue += h * expected_shortfall\n        \n    return lolp, eue\n\nsolve()\n```"
        },
        {
            "introduction": "有了系统容量模型后，我们就可以计算关键的可靠性指标。本练习将容量分布应用于负荷持续时间曲线，以计算缺电期望 ($LOLE$) 和期望缺供电量 ($EUE$)，这是资源充裕度的两个最重要指标。这个练习  不仅要求您执行计算，还挑战您解读这两个指标之间的差异对系统规划意味着什么。",
            "id": "4119469",
            "problem": "一家垂直一体化电力公司评估其电力系统在为期一年（$T=8760$ 小时）内的充裕性。系统负荷由一个阶梯式负荷持续时间曲线表示：最高的 $h_{1}=100$ 小时负荷为 $L_{1}=1300$ 兆瓦，接下来的 $h_{2}=600$ 小时负荷为 $L_{2}=1200$ 兆瓦，再接下来的 $h_{3}=1500$ 小时负荷为 $L_{3}=1000$ 兆瓦，再接下来的 $h_{4}=3000$ 小时负荷为 $L_{4}=800$ 兆瓦，剩余的 $h_{5}=3560$ 小时负荷为 $L_{5}=600$ 兆瓦。可用容量被建模为一个离散随机变量 $C$（单位：兆瓦），其概率质量函数如下，并假设其在一年中是平稳的，且与负荷排序无关：$\\mathbb{P}\\{C=1400\\}=0.88$，$\\mathbb{P}\\{C=1200\\}=0.08$，$\\mathbb{P}\\{C=1000\\}=0.03$，$\\mathbb{P}\\{C=800\\}=0.008$，$\\mathbb{P}\\{C=600\\}=0.002$。假设精确满足负荷，即 $C=L$ 时，不产生缺额。\n\n仅从负荷损失期望（LOLE，Loss of Load Expectation）——定义为考察期内负荷超过可用容量的期望小时数，和期望未服务能源（EUE，Expected Unserved Energy）——定义为考察期内未服务的总电量的期望值——的正式定义出发，计算该系统在给定假设下的这两个指标。LOLE 以小时表示，EUE 以兆瓦时（MWh）表示。将两个量都四舍五入到四位有效数字。然后，根据你计算出的值，阐述如果这两个指标对风险性质的强调有所不同，那么其在规划层面的启示是什么。",
            "solution": "该问题提法得当，有科学依据，并为全面分析提供了所有必要的数据。负荷块的总持续时间相加为 $100+600+1500+3000+3560=8760$ 小时，与年度考察期 $T$ 相符。可用容量状态的概率相加为 $0.88+0.08+0.03+0.008+0.002=1.00$，构成一个有效的概率质量函数。因此，我们可以开始求解。\n\n该问题要求计算两个基本的资源充裕性指标：负荷损失期望 (LOLE) 和期望未服务能源 (EUE)。\n\n设 $L$ 为系统负荷，$C$ 为可用容量，单位均为兆瓦 (MW)。如果 $L > C$，则发生缺额事件。问题说明，如果 $C=L$，则不产生缺额。\n\n负荷并非恒定，而是随时间变化。问题提供了一个负荷持续时间曲线 (LDC)，给出了负荷处于特定水平 $L_i$ 的小时数 $h_i$。总考察期为 $T = \\sum_i h_i$。可用容量 $C$ 是一个随机变量，与负荷水平无关，具有给定的概率质量函数 $\\mathbb{P}\\{C=c_k\\}$。\n\n**1. 负荷损失期望 (LOLE) 的计算**\n\nLOLE 的正式定义是在考察期 $T$ 内，负荷 $L$ 超过可用容量 $C$ 的期望小时数。\n设 $I(L(t) > C)$ 是一个指示函数，在 $t$ 小时若 $L(t) > C$ 则为 $1$，否则为 $0$。那么，\n$$\n\\text{LOLE} = \\mathbb{E}\\left[\\int_{0}^{T} I(L(t) > C) \\,dt\\right]\n$$\n给定阶梯式 LDC，我们可以将此积分离散化。对于每个持续时间为 $h_i$、负荷水平为 $L_i$ 的负荷块 $i$，其期望缺额小时数为该块的持续时间乘以该块期间发生缺额的概率。在负荷水平 $L_i$ 下发生缺额的概率是负荷损失概率，$LOLP(L_i) = \\mathbb{P}\\{C  L_i\\}$。由于每个小时的容量状态是独立的，总 LOLE 是所有负荷块的预期负荷损失小时数之和。\n$$\n\\text{LOLE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{P}\\{C  L_i\\}\n$$\n我们首先计算每个负荷水平 $L_i$ 的缺额概率：\n可用容量状态为 $c \\in \\{1400, 1200, 1000, 800, 600\\}$。\n\n对于负荷块 1：$L_1 = 1300$ MW。如果 $C  1300$ MW，则发生缺额。\n$$\n\\mathbb{P}\\{C  1300\\} = \\mathbb{P}\\{C=1200\\} + \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1300\\} = 0.08 + 0.03 + 0.008 + 0.002 = 0.12\n$$\n对于负荷块 2：$L_2 = 1200$ MW。如果 $C  1200$ MW，则发生缺额。\n$$\n\\mathbb{P}\\{C  1200\\} = \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1200\\} = 0.03 + 0.008 + 0.002 = 0.04\n$$\n对于负荷块 3：$L_3 = 1000$ MW。如果 $C  1000$ MW，则发生缺额。\n$$\n\\mathbb{P}\\{C  1000\\} = \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1000\\} = 0.008 + 0.002 = 0.01\n$$\n对于负荷块 4：$L_4 = 800$ MW。如果 $C  800$ MW，则发生缺额。\n$$\n\\mathbb{P}\\{C  800\\} = \\mathbb{P}\\{C=600\\} = 0.002\n$$\n对于负荷块 5：$L_5 = 600$ MW。如果 $C  600$ MW，则发生缺额。没有容量状态低于 $600$ MW。\n$$\n\\mathbb{P}\\{C  600\\} = 0\n$$\n现在我们可以计算总 LOLE：\n$$\n\\text{LOLE} = (h_1 \\cdot \\mathbb{P}\\{C  L_1\\}) + (h_2 \\cdot \\mathbb{P}\\{C  L_2\\}) + (h_3 \\cdot \\mathbb{P}\\{C  L_3\\}) + (h_4 \\cdot \\mathbb{P}\\{C  L_4\\}) + (h_5 \\cdot \\mathbb{P}\\{C  L_5\\})\n$$\n$$\n\\text{LOLE} = (100 \\, \\text{hr} \\cdot 0.12) + (600 \\, \\text{hr} \\cdot 0.04) + (1500 \\, \\text{hr} \\cdot 0.01) + (3000 \\, \\text{hr} \\cdot 0.002) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{LOLE} = 12 \\, \\text{hr} + 24 \\, \\text{hr} + 15 \\, \\text{hr} + 6 \\, \\text{hr} + 0 \\, \\text{hr} = 57 \\, \\text{hr}\n$$\n四舍五入到四位有效数字，LOLE 是 $57.00$ 小时。\n\n**2. 期望未服务能源 (EUE) 的计算**\n\nEUE 是在考察期 $T$ 内未服务的总电量的期望值。任何时刻的未服务功率由随机变量 $\\max(0, L - C)$ 给出。\n$$\n\\text{EUE} = \\mathbb{E}\\left[\\int_{0}^{T} \\max(0, L(t) - C) \\,dt\\right]\n$$\n使用阶梯式 LDC，这变为每个负荷块的期望未服务能源之和。对于给定的块 $i$，期望未服务功率是 $\\mathbb{E}[\\max(0, L_i - C)]$。该块的期望未服务能源是 $h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]$。\n$$\n\\text{EUE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]\n$$\n期望值 $\\mathbb{E}[\\max(0, L_i - C)]$ 通过对离散容量状态 $c_k$ 求和来计算：\n$$\n\\mathbb{E}[\\max(0, L_i - C)] = \\sum_{k} \\max(0, L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\} = \\sum_{k: c_k  L_i} (L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\}\n$$\n我们对每个负荷块进行计算：\n\n对于负荷块 1 ($L_1 = 1300$ MW):\n$$\n\\mathbb{E}[\\max(0, 1300-C)] = (1300-1200)(0.08) + (1300-1000)(0.03) + (1300-800)(0.008) + (1300-600)(0.002)\n$$\n$$\n= (100)(0.08) + (300)(0.03) + (500)(0.008) + (700)(0.002) = 8 + 9 + 4 + 1.4 = 22.4 \\, \\text{MW}\n$$\n对于负荷块 2 ($L_2 = 1200$ MW):\n$$\n\\mathbb{E}[\\max(0, 1200-C)] = (1200-1000)(0.03) + (1200-800)(0.008) + (1200-600)(0.002)\n$$\n$$\n= (200)(0.03) + (400)(0.008) + (600)(0.002) = 6 + 3.2 + 1.2 = 10.4 \\, \\text{MW}\n$$\n对于负荷块 3 ($L_3 = 1000$ MW):\n$$\n\\mathbb{E}[\\max(0, 1000-C)] = (1000-800)(0.008) + (1000-600)(0.002)\n$$\n$$\n= (200)(0.008) + (400)(0.002) = 1.6 + 0.8 = 2.4 \\, \\text{MW}\n$$\n对于负荷块 4 ($L_4 = 800$ MW):\n$$\n\\mathbb{E}[\\max(0, 800-C)] = (800-600)(0.002) = (200)(0.002) = 0.4 \\, \\text{MW}\n$$\n对于负荷块 5 ($L_5 = 600$ MW): 由于没有容量状态低于 $600$ MW，缺额始终为零。\n$$\n\\mathbb{E}[\\max(0, 600-C)] = 0 \\, \\text{MW}\n$$\n现在我们可以计算总 EUE：\n$$\n\\text{EUE} = (100 \\, \\text{hr} \\cdot 22.4 \\, \\text{MW}) + (600 \\, \\text{hr} \\cdot 10.4 \\, \\text{MW}) + (1500 \\, \\text{hr} \\cdot 2.4 \\, \\text{MW}) + (3000 \\, \\text{hr} \\cdot 0.4 \\, \\text{MW}) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{EUE} = 2240 \\, \\text{MWh} + 6240 \\, \\text{MWh} + 3600 \\, \\text{MWh} + 1200 \\, \\text{MWh} + 0 \\, \\text{MWh}\n$$\n$$\n\\text{EUE} = 13280 \\, \\text{MWh}\n$$\n该值有四位有效数字。\n\n**3. 规划启示的阐述**\n\n计算出的指标为 $\\text{LOLE} \\approx 57.00$ 小时/年和 $\\text{EUE} = 13280$ MWh/年。这两个指标虽然相关，但强调了系统可靠性风险的不同方面。\n\nLOLE 衡量可靠性事件的*频率*。每年 $57$ 小时的数值与典型的行业目标（例如，0.1天/年，或2.4小时/年）相比极高。这表明该系统预计会频繁出现容量缺额。一个只关注 LOLE 的规划者会得出结论，认为该系统长期不可靠，并将优先考虑那些能减少缺额小时数的投资，而不论其缺额大小。这可能包括提高发电机可用率或增加小型但高度可靠的调峰机组。\n\nEUE 衡量未服务能源的预期*总量*，它综合了缺额的频率、持续时间和严重程度。它是不可靠性总影响的度量。高 EUE 表明所有大大小小的缺额总量是显著的。在这个问题中，对 LOLE 贡献最大的是第二高的负荷块（$24$ 小时），而不是峰值负荷块（$12$ 小时）。同样，对 EUE 的最大贡献也来自这第二个负荷块（$6240$ MWh），是峰值负荷块贡献（$2240$ MWh）的两倍多。\n\n不同的侧重点很明显：\n- 高 LOLE 表明缺额是常见事件。系统经常缺乏足够的容量裕度。\n- EUE 分析揭示，就未服务能源而言，最显著的风险并非来自极少数的峰值负荷小时，而是来自为数更多的高持续负荷小时（$L_2=1200$ MW 持续 $h_2=600$ 小时）。在这些时段，条件期望缺额规模比峰值时段更大，且这些事件的总持续时间更长。\n\n**规划启示：**\n如果规划者只关注 LOLE，他们可能会误判风险的主要驱动因素。例如，他们可能会专注于增加少量容量，如一个专门用于满足绝对峰值负荷 $L_1$ 的“调峰电厂”。这将降低 LOLE，但可能对 EUE 的影响较小。\n\n然而，EUE 的结果表明存在更系统性的容量短缺。最大的风险贡献者是一个持续 $600$ 小时的负荷水平。这意味着解决方案不应仅仅狭隘地针对最高的少数几个峰值小时。相反，需要一个更稳健的解决方案，例如增加一个更大规模的可靠容量（基荷或中等负荷电厂），或实施可以长时间启动以降低 $L_2$ 所代表的负荷平台的需方响应计划。因此，EUE 提供了一个更细致入微的风险视角，它考虑了停电的严重性，引导规划者进行能更有效减轻未服务能源总体影响的投资，而不仅仅是降低其发生频率。在这种情况下，两个指标都表明可靠性差，但 EUE 更好地描述了风险的性质和来源，指出需要的是更实质性的、而不仅仅是削峰式的资源增补。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n57.00  13280\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然 $LOLE$ 和 $EUE$ 经常一起使用，但它们衡量的是可靠性风险的不同方面。这个思想实验  旨在深化您的概念理解，它展示了两个系统可以有完全相同的期望缺供电量 ($EUE$)，却有着截然不同的服务中断频率 ($LOLE$)。理解这一区别对于制定关于系统投资和风险管理的明智决策至关重要。",
            "id": "4102894",
            "problem": "一个电力系统规划师在一个日历年（包含$8760$小时）的时间范围内评估资源充裕性。对于每个小时 $t \\in \\{1,\\dots,8760\\}$，定义随机变量 $\\Delta_t \\ge 0$ 为该小时内的未服务电量，单位为兆瓦时（MWh）。假设对于一个给定的系统，$\\{\\Delta_t\\}_{t=1}^{8760}$ 在所有小时内是独立同分布的。\n\n有两个候选系统，系统A和系统B，它们仅在小时未服务电量的概率分布上有所不同。在两个系统中，小时未服务电量都是一个两部分的混合模型：以一定的概率发生缺电，其缺电量是一个连续随机变量；以互补的概率不发生缺电。具体来说：\n\n- 系统A：在任何小时，发生缺电的概率为 $q_A = 0.02$，条件缺电量服从均值为 $s_A = 10$ MWh的指数分布；否则，以 $1 - q_A$ 的概率，$\\Delta_t = 0$ MWh。\n- 系统B：在任何小时，发生缺电的概率为 $q_B = 0.005$，条件缺电量服从均值为 $s_B = 40$ MWh的指数分布；否则，以 $1 - q_B$ 的概率，$\\Delta_t = 0$ MWh。\n\n从以下基本定义出发：(i) 负荷损失期望（LOLE）是一年中发生缺电（$\\Delta_t > 0$）的期望小时数，以及 (ii) 未服务电量期望（EUE）是一年内总未服务电量的期望值，推导每个系统的LOLE和EUE的表达式。明确说明这两个系统是否可以在LOLE不同的情况下拥有相同的EUE，并用文字解释小时缺电分布的形状如何导致这一结果。\n\n计算每个系统的年LOLE（单位：小时/年）以及共同的EUE（单位：兆瓦时/年）（如果存在）。仅报告共同的EUE作为你的最终数值答案。将最终答案四舍五入到四位有效数字。最终电量以兆瓦时/年为单位表示。",
            "solution": "问题陈述经评估有效。它在科学上基于概率论和电力系统可靠性分析的原理，问题提出得当，提供了所有必要信息，并以客观、明确的语言表述。因此，我们可以进行求解。\n\n设时间范围为 $T = 8760$ 小时。对于每个小时 $t \\in \\{1,\\dots,T\\}$，未服务电量是一个随机变量 $\\Delta_t$。假设随机变量集合 $\\{\\Delta_t\\}_{t=1}^{T}$ 是独立同分布的（i.i.d.）。\n\n对于任意给定的小时，我们定义一个指示随机变量 $I_t$，使得当发生缺电时（$\\Delta_t > 0$），$I_t = 1$；当没有发生缺电时（$\\Delta_t = 0$），$I_t = 0$。根据问题陈述，$I_t$ 服从伯努利分布。发生缺电的概率为 $P(I_t=1) = q$，不发生缺电的概率为 $P(I_t=0) = 1-q$。\n\n未服务电量 $\\Delta_t$ 的大小由一个混合模型描述。如果 $I_t=0$，则 $\\Delta_t=0$。如果 $I_t=1$，则条件缺电量的大小服从均值为 $s$ 的指数分布。\n\n首先，我们推导负荷损失期望（LOLE）的一般表达式。LOLE定义为一年中发生缺电的期望小时数。设 $N$ 为一年中发生缺电的总小时数。则 $N = \\sum_{t=1}^{T} I_t$。\nLOLE是 $N$ 的期望值：\n$$ \\text{LOLE} = E[N] = E\\left[\\sum_{t=1}^{T} I_t\\right] $$\n根据期望的线性性质，\n$$ \\text{LOLE} = \\sum_{t=1}^{T} E[I_t] $$\n对于一个伯努利随机变量 $I_t$，其期望为 $E[I_t] = 1 \\cdot P(I_t=1) + 0 \\cdot P(I_t=0) = q$。因为各小时是独立同分布的，所以对所有的 $t$，$q$ 是常数。\n$$ \\text{LOLE} = T \\cdot q $$\n\n接下来，我们推导未服务电量期望（EUE）的一般表达式。EUE是一年中总未服务电量的期望值。设 $U$ 为总未服务电量。则 $U = \\sum_{t=1}^{T} \\Delta_t$。\nEUE是 $U$ 的期望值：\n$$ \\text{EUE} = E[U] = E\\left[\\sum_{t=1}^{T} \\Delta_t\\right] $$\n根据期望的线性性质，并且由于所有 $t$ 的分布是相同的，\n$$ \\text{EUE} = \\sum_{t=1}^{T} E[\\Delta_t] = T \\cdot E[\\Delta_1] $$\n我们使用全期望定律，以指示变量 $I_t$ 为条件，计算小时未服务电量的期望 $E[\\Delta_t]$：\n$$ E[\\Delta_t] = E[\\Delta_t | I_t=1] P(I_t=1) + E[\\Delta_t | I_t=0] P(I_t=0) $$\n根据问题陈述，我们有：\n- $P(I_t=1) = q$。\n- $P(I_t=0) = 1-q$。\n- $E[\\Delta_t | I_t=1] = s$，即条件指数分布的均值。\n- $E[\\Delta_t | I_t=0] = 0$，因为没有缺电时，未服务电量为零。\n将这些代入 $E[\\Delta_t]$ 的方程中：\n$$ E[\\Delta_t] = s \\cdot q + 0 \\cdot (1-q) = s \\cdot q $$\n因此，EUE的一般表达式为：\n$$ \\text{EUE} = T \\cdot s \\cdot q $$\n\n现在，我们将这些推导出的公式应用于系统A和系统B。\n对于系统A：\n- 缺电概率：$q_A = 0.02$。\n- 条件缺电均值：$s_A = 10$ MWh。\n系统A的LOLE为：\n$$ \\text{LOLE}_A = T \\cdot q_A = 8760 \\cdot 0.02 = 175.2 \\text{ 小时/年} $$\n系统A的EUE为：\n$$ \\text{EUE}_A = T \\cdot s_A \\cdot q_A = 8760 \\cdot 10 \\cdot 0.02 = 8760 \\cdot 0.2 = 1752 \\text{ MWh/年} $$\n\n对于系统B：\n- 缺电概率：$q_B = 0.005$。\n- 条件缺电均值：$s_B = 40$ MWh。\n系统B的LOLE为：\n$$ \\text{LOLE}_B = T \\cdot q_B = 8760 \\cdot 0.005 = 43.8 \\text{ 小时/年} $$\n系统B的EUE为：\n$$ \\text{EUE}_B = T \\cdot s_B \\cdot q_B = 8760 \\cdot 40 \\cdot 0.005 = 8760 \\cdot 0.2 = 1752 \\text{ MWh/年} $$\n\n现在我们可以明确地说明这两个系统是否可以在LOLE不同的情况下拥有相同的EUE。\n比较EUE值：\n$$ \\text{EUE}_A = 1752 \\text{ MWh/年} $$\n$$ \\text{EUE}_B = 1752 \\text{ MWh/年} $$\n因此，$\\text{EUE}_A = \\text{EUE}_B$。这两个系统确实具有相同的EUE。\n\n比较LOLE值：\n$$ \\text{LOLE}_A = 175.2 \\text{ 小时/年} $$\n$$ \\text{LOLE}_B = 43.8 \\text{ 小时/年} $$\n因此，$\\text{LOLE}_A \\neq \\text{LOLE}_B$。这两个系统具有不同的LOLE。\n\n导致这个结果的原因在于LOLE和EUE的定义以及小时缺电分布的参数。\n- LOLE是衡量供电中断频率的指标。其公式 $\\text{LOLE} = T \\cdot q$ 表明，它与缺电概率 $q$ 成正比，并且完全不受该缺电量 $s$ 的大小影响。\n- EUE是衡量未服务电量总量的指标。其公式 $\\text{EUE} = T \\cdot q \\cdot s$ 表明，它取决于缺电概率 $q$ 和平均缺电量 $s$ 的乘积。\n\n系统A的特点是缺电相对频繁但量小（$q_A = 0.02$, $s_A = 10$ MWh）。\n系统B的特点是缺电相对不频繁但量大（$q_B = 0.005$, $s_B = 40$ MWh）。\n\n问题的构造使得两个系统的频率和缺电量的乘积相同：\n$$ q_A s_A = 0.02 \\cdot 10 = 0.2 $$\n$$ q_B s_B = 0.005 \\cdot 40 = 0.2 $$\n由于 $\\text{EUE} \\propto q \\cdot s$，并且这个乘积对于两个系统是相同的，所以它们的年EUE值是相同的。\n然而，由于 $\\text{LOLE} \\propto q$，且 $q_A = 4 \\cdot q_B$，系统A的LOLE是系统B的四倍，这反映了其缺电事件的频率更高。\n\n本质上，系统A的小时缺电分布形状在较小的非零缺电值上具有较高的概率质量，而系统B的分布则在较大的缺电值上集中了较低的概率质量。这种频率和缺电量之间的权衡使得EUE可以保持不变，而LOLE可以变化。这说明了可靠性规划中的一个基本概念：具有相同总期望缺电量的系统，在客户经历停电的频率方面，可能呈现出截然不同的风险状况。\n\n问题要求计算共同的EUE，我们已计算出其值为 $1752$ MWh/年。问题还要求将此值四舍五入到四位有效数字。数字 $1752$ 已经恰好有四位有效数字（$1, 7, 5, 2$），因此无需四舍五入。\n共同的EUE为 $1752$ MWh/年。",
            "answer": "$$\\boxed{1752}$$"
        }
    ]
}