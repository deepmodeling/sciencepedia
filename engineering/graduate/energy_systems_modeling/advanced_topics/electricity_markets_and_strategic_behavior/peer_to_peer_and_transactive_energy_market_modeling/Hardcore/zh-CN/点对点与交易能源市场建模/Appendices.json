{
    "hands_on_practices": [
        {
            "introduction": "市场结算是能源交易后进行财务对账的关键环节。本练习通过一个常见的双结算系统，帮助您理解计划交易和实时偏差如何被定价和惩罚，从而掌握分析任何市场财务结果的基础技能。通过计算一个具体案例中的现金流，您将亲自体验交易平台如何根据预先设定的规则进行支付和收费。",
            "id": "4111212",
            "problem": "考虑一个点对点（P2P）交易能源市场，该市场在一个单一结算区间内运行，该区间的持续时间足够短，能量以千瓦时为单位进行计量和结算。产消者是指既能消费又能生产能源的参与者。假设以下背景和定义构成了结算设计的基础。\n\n- 在一个有许多小型参与者的竞争市场中，根据具有凸成本和可行性约束的标准福利最大化原则，统一出清价格等于福利最优时的边际社会成本。将此统一出清价格表示为 $p$，它适用于由市场平台出清的预定双边交易。\n- 平台采用两步结算方式：按统一价格进行事前计划出清，然后进行事后平衡。事后平衡反映了系统级的纠正措施，用以协调实际注入和提取量与出清计划量，并通过偏差惩罚进行收费。将绝对能量偏差表示为 $|E^{\\mathrm{act}} - E^{\\mathrm{sch}}|$，其中 $E^{\\mathrm{sch}}$ 是产消者的出清净注入计划，而 $E^{\\mathrm{act}}$ 是产消者在该区间内测得的实际净注入量。偏差按线性费率 $\\pi$ 收费，该费率代表平衡资源的影子价格，并按每单位绝对偏差应用。\n- 符号约定是：向市场净注入为正能量供应，净提取为负能量消耗。平台按统一出清价格对计划的净注入进行报酬支付。偏差不按统一价格获得报酬，仅产生平衡惩罚费用。\n\n某特定产消者出清的计划净注入量为 $E^{\\mathrm{sch}} = 5\\,\\mathrm{kWh}$，而在该区间内实际注入量为 $E^{\\mathrm{act}} = 6\\,\\mathrm{kWh}$。统一出清价格为 $p = \\$0.20/\\mathrm{kWh}$，平衡惩罚费率为 $\\pi = \\$0.05/\\mathrm{kWh}$。根据上述结算设计，确定该产消者在此结算区间的净结算现金流（收入减去费用）。\n\n请以美元表示最终答案，并四舍五入到四位有效数字。",
            "solution": "用户希望我按照指定的流程解决问题。\n\n### 第1步：提取已知信息\n- 市场：点对点（P2P）交易能源市场。\n- 结算区间：单一，持续时间短。能量以千瓦时（kWh）为单位计量。\n- 统一出清价格：$p$，等于边际社会成本。\n- 结算机制：两步式：按价格 $p$ 进行事前计划出清，然后进行事后平衡。\n- 偏差惩罚：按每单位绝对能量偏差的线性费率 $\\pi$。\n- 绝对能量偏差：$|E^{\\mathrm{act}} - E^{\\mathrm{sch}}|$。\n- $E^{\\mathrm{sch}}$：产消者的出清净注入计划。\n- $E^{\\mathrm{act}}$：产消者测得的实际净注入量。\n- 符号约定：净注入为正，净提取为负。\n- 报酬规则：计划的净注入按统一出清价格 $p$ 获得报酬。\n- 偏差结算规则：偏差不按统一价格获得报酬，仅产生平衡惩罚费用。\n- 产消者的计划净注入量：$E^{\\mathrm{sch}} = 5\\,\\mathrm{kWh}$。\n- 产消者的实际净注入量：$E^{\\mathrm{act}} = 6\\,\\mathrm{kWh}$。\n- 统一出清价格值：$p = \\$0.20/\\mathrm{kWh}$。\n- 平衡惩罚费率值：$\\pi = \\$0.05/\\mathrm{kWh}$。\n- 目标：确定产消者的净结算现金流。\n- 最终答案要求：以美元表示，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知信息进行验证\n根据验证标准对问题陈述进行评估。\n- **科学性**：该问题描述了一个简化的但标准的双结算电力市场模型。诸如统一出清价格、计划（事前）市场、实时（事后）平衡和偏差惩罚等概念是现代电力市场设计的基本组成部分。该模型基于已建立的微观经济学和能源系统原理。该问题具有科学合理性。\n- **适定性**：所有必需的参数（$E^{\\mathrm{sch}}$、$E^{\\mathrm{act}}$、$p$、$\\pi$）都已定义并赋予了具体的数值。计算收入和费用的规则明确无误。存在一个唯一的、有意义的净现金流解。\n- **客观性**：问题以精确、技术性的语言表述，没有主观性或个人观点。\n- **不完整或矛盾的设置**：问题是自洽的。它提供了所有必要的数据，并一致地定义了所有结算规则。例如，它明确指出“偏差不按统一价格获得报酬”，这是一个关键且不矛盾的规则。\n- **不切实际或不可行**：所提供的价格（$p = \\$0.20/\\mathrm{kWh}$）、惩罚费率（$\\pi = \\$0.05/\\mathrm{kWh}$）和电量（$5\\,\\mathrm{kWh}$，$6\\,\\mathrm{kWh}$）的数值，对于一个单一结算区间（例如一小时）内零售或P2P市场环境下的住宅规模产消者来说是合理的。\n- **不适定或结构不良**：问题结构清晰，在要求计算之前定义了术语和规则。没有歧义。\n- **伪深刻、琐碎或同义反复**：该问题需要仔细应用一个多部分结算公式。虽然算术不复杂，但其概念结构考验了对市场结算规则的理解，这是非同小可的。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学性、适定性、客观性、完整性和内部一致性。可以继续求解过程。\n\n### 解题过程\n产消者的净结算现金流，记作 $C_{\\text{net}}$，是从市场获得的总收入减去支付给市场的总费用。我们必须根据所提供的规则来确定这些组成部分。\n\n$1$. **收入计算**：\n问题陈述中提到，“平台按统一出清价格对计划的净注入进行报酬支付。” 这意味着收入是根据*计划*能量 $E^{\\mathrm{sch}}$ 计算的，而不是根据*实际*输送的能量。收入 $R$ 由计划净注入量与统一出清价格 $p$ 的乘积给出。\n$$R = p \\cdot E^{\\mathrm{sch}}$$\n问题还明确澄清，“偏差不按统一价格获得报酬。” 这证实了超出计划额外注入的能量 $E^{\\mathrm{act}} - E^{\\mathrm{sch}}$ 不会以价格 $p$ 产生收入。\n\n$2$. **费用计算**：\n问题陈述中提到，“偏差按线性费率 $\\pi$ 收费……按每单位绝对偏差应用。” 该费用是针对偏差的惩罚，记作 $C_{\\text{penalty}}$，计算方法为惩罚费率 $\\pi$ 与能量偏差绝对值的乘积。\n能量偏差是实际净注入量与计划净注入量之差，$E^{\\mathrm{act}} - E^{\\mathrm{sch}}$。\n绝对能量偏差为 $|E^{\\mathrm{act}} - E^{\\mathrm{sch}}|$。\n因此，惩罚费用为：\n$$C_{\\text{penalty}} = \\pi \\cdot |E^{\\mathrm{act}} - E^{\\mathrm{sch}}|$$\n\n$3$. **净现金流计算**：\n净结算现金流是收入减去惩罚费用。\n$$C_{\\text{net}} = R - C_{\\text{penalty}} = p \\cdot E^{\\mathrm{sch}} - \\pi \\cdot |E^{\\mathrm{act}} - E^{\\mathrm{sch}}|$$\n我们已知以下数值：\n- 计划净注入量：$E^{\\mathrm{sch}} = 5\\,\\mathrm{kWh}$\n- 实际净注入量：$E^{\\mathrm{act}} = 6\\,\\mathrm{kWh}$\n- 统一出清价格：$p = 0.20\\,\\$/\\mathrm{kWh}$\n- 平衡惩罚费率：$\\pi = 0.05\\,\\$/\\mathrm{kWh}$\n\n首先，我们计算收入部分：\n$$R = (0.20\\,\\$/\\mathrm{kWh}) \\cdot (5\\,\\mathrm{kWh}) = \\$1.00$$\n接下来，我们计算绝对偏差：\n$$|E^{\\mathrm{act}} - E^{\\mathrm{sch}}| = |6\\,\\mathrm{kWh} - 5\\,\\mathrm{kWh}| = |1\\,\\mathrm{kWh}| = 1\\,\\mathrm{kWh}$$\n然后，我们计算惩罚费用部分：\n$$C_{\\text{penalty}} = (0.05\\,\\$/\\mathrm{kWh}) \\cdot (1\\,\\mathrm{kWh}) = \\$0.05$$\n最后，我们计算净现金流：\n$$C_{\\text{net}} = R - C_{\\text{penalty}} = \\$1.00 - \\$0.05 = \\$0.95$$\n题目要求最终答案四舍五入到四位有效数字。计算值为 $0.95$。为了用四位有效数字表示，我们添加后缀零。\n$$C_{\\text{net}} = 0.9500$$\n最终答案以美元为单位。",
            "answer": "$$\n\\boxed{0.9500}\n$$"
        },
        {
            "introduction": "简单的统一电价可能导致效率低下，因为它忽略了能量在电网中传输的物理成本。本练习探讨了配电网节点边际电价（DLMPs）如何将线路损耗的边际成本内化到价格信号中，从而激励有利于电网高效运行的行为。通过计算网络盈余的变化，我们可以直接衡量这种先进市场设计的经济效益。",
            "id": "4111130",
            "problem": "一个配电级别的点对点平台使用配电系统节点边际电价 (DLMPs) 来结算双边交易。考虑在一条放射状馈线上，一个产消者卖方（位于节点 $1$）和一个消费者买方（位于节点 $2$）之间在一个小时的调度间隔内进行的一笔双边交易。配电系统运营商通过最优潮流计算 DLMPs，该计算使用了包含欧姆损耗的节点功率平衡的拉格朗日函数。假设在此间隔内没有发生拥塞。运营商还发布边际损耗因子 (MLFs)，它量化了每个节点净注入功率单位变化所引起的变电站参考母线注入功率的边际变化。\n\n对于这笔数量为 $q$ 的交易，考虑两种结算设计：\n- 无损耗结算（忽略 MLFs）：所有节点电价均等于变电站能源价格，记为 $\\lambda_{0}$。\n- 考虑损耗的结算（将 MLFs 纳入 DLMPs）：节点电价反映了边际损耗，因此因地点而异。\n\n基本原理：在节点定价系统中，节点 $j$ 的买方支付的费用是本地节点电价与计量消耗量的乘积，而节点 $i$ 的卖方获得的收入是本地节点电价与计量注入量的乘积。买方总支付额与卖方总收入之间的差额是网络盈余，用于支付实际损耗和剩余成本。边际损耗因子通过将通过电阻损耗向每个节点输送额外单位能量的增量成本内部化来改变节点电价；因此，相对于变电站价格，考虑损耗的结算通常会提高下游取电点的节点电价，并降低下游注入点的节点电价。\n\n对于所研究的这个小时，假设运营商报告了以下数据：\n- 变电站能源价格 $\\lambda_{0} = 50$ 美元/兆瓦时。\n- 交易量 $q = 6$ 兆瓦时，从节点 $1$（卖方）到节点 $2$（买方）。\n- 本小时内包含 MLFs 的考虑损耗的 DLMPs 为：节点 $1$ 处 $\\lambda_{1} = 48$ 美元/兆瓦时，节点 $2$ 处 $\\lambda_{2} = 52$ 美元/兆瓦时。\n\n任务：\n- 使用上述基本定义，解释在点对点市场中，通过 DLMPs 将边际损耗因子 (MLFs) 纳入结算如何影响卖方和买方的特定地点激励。您的讨论应是定性的，并基于边际损耗成本的因果关系。\n- 然后，计算对于这笔单一交易，从无损耗结算（忽略 MLFs）转变为考虑损耗的 DLMP 结算（包含 MLFs）时网络盈余的增加量。用美元 (USD) 表示最终差额。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其科学性、适定性和客观性。\n\n### 第1步：提取已知条件\n- 系统：在放射状馈线中使用配电系统节点边际电价 (DLMPs) 结算双边交易的配电级别点对点平台。\n- 交易：节点 $1$ 的卖方与节点 $2$ 的买方之间的一笔双边交易。\n- 间隔：长度为1小时的调度间隔。\n- 定价模型：通过最优潮流计算得出的 DLMPs，无拥塞。\n- 定义：\n    - 边际损耗因子 (MLF)：每个节点净注入功率单位变化所引起的变电站参考母线注入功率的边际变化。\n    - 无损耗结算：所有节点电价均等于变电站能源价格 $\\lambda_{0}$。\n    - 考虑损耗的结算：节点电价包含边际损耗。\n    - 节点 $j$ 的买方支付额：（本地节点电价） $\\times$ （计量消耗量）。\n    - 节点 $i$ 的卖方收入：（本地节点电价） $\\times$ （计量注入量）。\n    - 网络盈余：（买方总支付额） - （卖方总收入）。\n- 数据：\n    - 变电站能源价格：$\\lambda_{0} = 50$ 美元/兆瓦时。\n    - 交易量：$q = 6$ 兆瓦时。\n    - 卖方节点：节点 $1$。\n    - 买方节点：节点 $2$。\n    - 考虑损耗的 DLMPs：$\\lambda_{1} = 48$ 美元/兆瓦时（在节点 $1$）和 $\\lambda_{2} = 52$ 美元/兆瓦时（在节点 $2$）。\n\n### 第2步：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学性**：该问题基于电力系统经济学的既定原则，特别是节点定价 (DLMPs) 和电力市场中边际损耗的处理。这些是能源系统建模的核心概念。所提供的数据中，卖方价格 $\\lambda_1$ 低于参考价格 $\\lambda_0$，而买方价格 $\\lambda_2$ 高于参考价格，这正确反映了放射状馈线中潮流和损耗的物理规律。\n- **适定性**：该问题提供了回答定性和定量部分问题所需的所有数据和定义。目标明确，并且计算存在唯一的数值解。\n- **客观性**：该问题以该领域通用的精确技术语言陈述，没有歧义或主观性陈述。\n\n该问题没有科学上不健全、不完整或模棱两可等缺陷。它是能源系统分析中一个有效、可形式化的问题。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n解答按要求分为两部分：对激励机制的定性解释和对网络盈余变化的定量计算。\n\n**第1部分：激励机制的定性解释**\n\n配电系统节点边际电价 (DLMPs) 将向配电网中特定位置（节点）输送能量或从该位置注入能量的边际成本内部化。在一个没有约束性拥塞的系统中，节点间价格差异的主要驱动因素是欧姆损耗的边际成本。\n\n使用包含边际损耗因子 (MLFs) 的 DLMPs 会产生反映这一物理现实的价格信号，从而塑造市场参与者的经济激励：\n\n- **对卖方（产消者）的激励**：卖方的目标是最大化收入，即售出数量与收到的节点电价的乘积。位于下游节点（如节点 $1$）的卖方向电网注入电力，有助于满足本地需求。这减少了必须从主变电站传输的电量，从而降低了总的系统损耗。卖方节点的 DLMP $\\lambda_1$ 与变电站参考价格 $\\lambda_0$ 通过对损耗的边际效应相关联。$\\lambda_1 = 48$ 美元/兆瓦时低于 $\\lambda_0 = 50$ 美元/兆瓦时，这一事实表明，由于对网络整体损耗分布的复杂影响，在节点 $1$ 注入一个额外单位的能量，所替代的变电站发电量略少于一个单位。位置定价信号激励卖方将发电设备设置在能获得更高电价的节点。更高的价格意味着在该位置的注入对系统具有更大的价值，通常是通过更有效地减少整体损耗。因此，从经济上鼓励卖方将发电设备放置在对电网效率最有利的位置。\n\n- **对买方（消费者）的激励**：买方的目标是最小化成本，即消耗数量与支付的节点电价的乘积。要将电力输送给下游节点（如节点 $2$）的买方，能量必须从变电站和/或其他发电源流出，沿途会产生电阻损耗。因此，买方节点的 DLMP $\\lambda_2$ 必须包含能源本身的成本（$\\lambda_0$）加上传输过程中损耗能量的边际成本。这就是为什么买方价格 $\\lambda_2 = 52$ 美元/兆瓦时高于变电站价格 $\\lambda_0$ 的原因。这个价格信号直接让买方面临其消费的真实边际成本。因此，消费者被激励去减少负荷或将消费转移到 DLMPs 较低的时间或地点。这促进了与电网效率相一致的需求侧管理，鼓励在电气上“更接近”发电源、服务成本更低的位置进行消费。\n\n总而言之，通过从统一的“无损耗”价格转向特定地点的 DLMPs，市场提供了精细的经济信号，使个体参与者的自利行为与最小化能源损耗的系统范围目标保持一致。\n\n**第2部分：网络盈余增加量的计算**\n\n网络盈余 $S$ 定义为买方的总支付额减去卖方的总收入。我们将为两种结算设计计算此盈余。该交易涉及卖方在节点 $1$ 注入数量为 $q = 6$ 兆瓦时的电量，买方在节点 $2$ 取用。\n\n**情况 A：无损耗结算**\n在这种情况下，所有节点的电价均等于变电站能源价格 $\\lambda_0$。\n- 节点 $2$ 的买方支付额为 $P_{lossless} = \\lambda_0 \\times q$。\n- 节点 $1$ 的卖方收入为 $C_{lossless} = \\lambda_0 \\times q$。\n无损耗结算下的网络盈余 $S_{lossless}$ 为：\n$$S_{lossless} = P_{lossless} - C_{lossless} = \\lambda_0 q - \\lambda_0 q = 0$$\n\n**情况 B：考虑损耗的 DLMP 结算**\n在这种情况下，价格是特定于位置的。节点 $1$ 的卖方收到价格 $\\lambda_1$，节点 $2$ 的买方支付价格 $\\lambda_2$。\n- 节点 $2$ 的买方支付额为 $P_{loss-aware} = \\lambda_2 \\times q$。\n- 节点 $1$ 的卖方收入为 $C_{loss-aware} = \\lambda_1 \\times q$。\n考虑损耗结算下的网络盈余 $S_{loss-aware}$ 为：\n$$S_{loss-aware} = P_{loss-aware} - C_{loss-aware} = \\lambda_2 q - \\lambda_1 q = (\\lambda_2 - \\lambda_1)q$$\n这笔盈余代表配电系统运营商收取的收入，用于支付该特定交易所产生的物理能量损耗。\n\n**网络盈余的增加**\n从无损耗结算转为考虑损耗结算时，网络盈余的增加量 $\\Delta S$ 是两种盈余之间的差额：\n$$\\Delta S = S_{loss-aware} - S_{lossless}$$\n$$\\Delta S = (\\lambda_2 - \\lambda_1)q - 0 = (\\lambda_2 - \\lambda_1)q$$\n\n现在，我们代入给定的数值：\n- $\\lambda_1 = 48$ 美元/兆瓦时\n- $\\lambda_2 = 52$ 美元/兆瓦时\n- $q = 6$ 兆瓦时\n\n$$\\Delta S = (52 - 48) \\frac{\\text{USD}}{\\text{MWh}} \\times 6 \\text{ MWh}$$\n$$\\Delta S = 4 \\frac{\\text{USD}}{\\text{MWh}} \\times 6 \\text{ MWh}$$\n$$\\Delta S = 24 \\text{ USD}$$\n\n问题要求答案四舍五入到四位有效数字。计算出的值恰好是 $24$。为了用四位有效数字表示，我们写作 $24.00$。\n网络盈余的增加量为 $24.00$ 美元。",
            "answer": "$$\\boxed{24.00}$$"
        },
        {
            "introduction": "市场参与者并非总是价格的被动接受者，他们可能会预测他人的行为并做出策略性决策。本练习将产消者建模为策略性主体，应用经典的古诺（Cournot）竞争模型来分析他们的互动。通过推导最佳响应函数并求解纳什均衡，我们能够预测当少数有影响力的参与者在市场上竞争时，均衡价格和产量等关键市场结果。",
            "id": "4111166",
            "problem": "考虑一个具有两个产消者的单区间点对点（P2P）交易能源市场。每个产消者选择一个供应量，记为 $q_1$ 和 $q_2$，单位为兆瓦时（MWh）。市场总供应量为 $Q = q_1 + q_2$。逆需求函数是线性的，由 $p(Q) = a - Q$ 给出，其中 $p$ 是市场出清价格，单位为美元/兆瓦时（$/MWh$），$a > 0$ 是需求截距参数。产消者承担凸二次成本 $C_1(q_1) = c_1 q_1^2$ 和 $C_2(q_2) = c_2 q_2^2$，单位为美元 ($)。每个产消者同时选择其供应量以最大化自身利润，其利润函数为 $\\pi_i(q_i, q_j) = p(Q)\\,q_i - C_i(q_i)$，其中 $i \\in \\{1,2\\}$ 且 $j \\neq i$。纳什均衡（NE）是一个策略组合 $(q_1^\\star, q_2^\\star)$，在该组合中，两个产消者的选择互为最佳对策。\n\n从利润最大化和纳什均衡（NE）的基本定义出发，推导出一阶最优性条件，该条件将每个产消者的最佳对策量刻画为另一个产消者供应量的函数。然后，通过迭代最佳对策直至收敛，实现一个数值不动点方法来计算纳什均衡。强制执行非负约束 $q_1 \\ge 0$、$q_2 \\ge 0$ 和 $p \\ge 0$ 以确保物理现实性。\n\n您的程序必须为下面的每个测试用例计算：\n- 均衡供应量 $q_1^\\star$ 和 $q_2^\\star$（单位：MWh），\n- 均衡价格 $p^\\star$（单位：$/MWh$），\n- 均衡利润 $\\pi_1^\\star$ 和 $\\pi_2^\\star$（单位：美元 $）。\n\n所有输出均使用指定单位表示，并将每个报告的数值四舍五入到三位小数。\n\n测试集（每个用例为 $(a, c_1, c_2)$）：\n1. $(10, 1, 2)$\n2. $(10, 1, 1)$\n3. $(12, 0.5, 3)$\n4. $(1, 4, 5)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例结果的逗号分隔列表。每个测试用例的结果是一个包含五个浮点数的列表 $[q_1^\\star,q_2^\\star,p^\\star,\\pi_1^\\star,\\pi_2^\\star]$，四舍五入到三位小数，且整行输出被方括号包围。例如，输出必须如下所示：\n$[\\,[q_{1,1},q_{2,1},p_1,\\pi_{1,1},\\pi_{2,1}],\\,[q_{1,2},q_{2,2},p_2,\\pi_{1,2},\\pi_{2,2}],\\,\\ldots\\,]$",
            "solution": "用户提供的问题是一个在微观经济理论中有效且适定的问题，具体来说是一个应用于交易能源市场的 Cournot 双寡头模型。所有参数都已明确定义，目标在数学上是合理的。我们开始求解。\n\n该问题要求解一个具有两个产消者的单区间能源市场的纳什均衡（NE）。均衡点通过找到一个供应量组合 $(q_1^\\star, q_2^\\star)$ 来确定，在该组合中，每个产消者选择的供应量都是对另一方选择的最佳对策，即在给定对方选择的情况下，最大化自身利润。\n\n市场由以下几个部分定义：\n- 产消者供应量：$q_1, q_2$（单位：MWh）。\n- 总供应量：$Q = q_1 + q_2$。\n- 逆需求函数（价格）：$p(Q) = a - Q$，其中 $a  0$。\n- 产消者成本函数：$C_1(q_1) = c_1 q_1^2$ 和 $C_2(q_2) = c_2 q_2^2$。\n- 产消者利润函数：$\\pi_i(q_i, q_j) = p(Q)q_i - C_i(q_i)$，其中 $i,j \\in \\{1,2\\}$ 且 $i \\neq j$。\n\n我们还必须强制执行非负约束 $q_1 \\ge 0$、$q_2 \\ge 0$，并确保最终价格为非负值，$p \\ge 0$。\n\n### 最佳对策函数的推导\n\n为了找到纳什均衡，我们首先推导每个产消者的最佳对策函数。该函数记为 $BR_i(q_j)$，它给出了在产消者 $j$ 生产任意给定供应量 $q_j$ 的情况下，产消者 $i$ 的利润最大化供应量。\n\n让我们首先分析产消者 1。其利润函数为：\n$$\n\\pi_1(q_1, q_2) = p(q_1 + q_2)q_1 - C_1(q_1)\n$$\n代入给定的价格和成本函数：\n$$\n\\pi_1(q_1, q_2) = (a - (q_1 + q_2))q_1 - c_1 q_1^2\n$$\n$$\n\\pi_1(q_1, q_2) = a q_1 - q_1^2 - q_2 q_1 - c_1 q_1^2\n$$\n为了找到使该利润最大化的供应量 $q_1$，我们将 $\\pi_1$ 对 $q_1$ 求偏导数（将 $q_2$ 视为常数）并令其为零。这是一阶最优性条件（FOC）：\n$$\n\\frac{\\partial \\pi_1}{\\partial q_1} = a - 2q_1 - q_2 - 2c_1 q_1 = 0\n$$\n二阶条件确认这是一个最大值，因为 $\\frac{\\partial^2 \\pi_1}{\\partial q_1^2} = -2 - 2c_1 = -2(1+c_1)  0$（由于成本系数为正）。\n\n对 FOC 求解 $q_1$：\n$$\na - q_2 = 2q_1 + 2c_1 q_1 = (2 + 2c_1)q_1\n$$\n$$\nq_1 = \\frac{a - q_2}{2(1 + c_1)}\n$$\n这个表达式定义了在给定 $q_2$ 的情况下产消者 1 的最优供应量。然而，我们必须遵守供应量不能为负的物理约束，即 $q_1 \\ge 0$。因此，产消者 1 的最佳对策函数是：\n$$\nBR_1(q_2) = \\max\\left(0, \\frac{a - q_2}{2(1 + c_1)}\\right)\n$$\n根据对称性，产消者 2 的推导过程是类似的。其利润函数为：\n$$\n\\pi_2(q_1, q_2) = (a - (q_1 + q_2))q_2 - c_2 q_2^2\n$$\n对 $q_2$ 的一阶最优性条件是：\n$$\n\\frac{\\partial \\pi_2}{\\partial q_2} = a - q_1 - 2q_2 - 2c_2 q_2 = 0\n$$\n对 $q_2$ 求解并结合非负约束 $q_2 \\ge 0$，得到产消者 2 的最佳对策函数：\n$$\nBR_2(q_1) = \\max\\left(0, \\frac{a - q_1}{2(1 + c_2)}\\right)\n$$\n### 纳什均衡与不动点迭代\n\n纳什均衡 $(q_1^\\star, q_2^\\star)$ 是一个状态，在该状态下，两个产消者同时采取其最佳对策。在数学上，它是最佳对策函数的一个不动点：\n$$\nq_1^\\star = BR_1(q_2^\\star) \\quad \\text{and} \\quad q_2^\\star = BR_2(q_1^\\star)\n$$\n问题要求使用数值不动点方法找到该均衡。我们将使用一种称为最佳对策动态（或 Cournot 调整）的迭代方法。算法流程如下：\n1.  初始化两个产消者的供应量，例如 $(q_1^{(0)}, q_2^{(0)}) = (0, 0)$。\n2.  对于每次迭代 $k = 0, 1, 2, \\ldots$，使用最佳对策函数同时更新供应量：\n    $$\n    q_1^{(k+1)} = BR_1(q_2^{(k)})\n    $$\n    $$\n    q_2^{(k+1)} = BR_2(q_1^{(k)})\n    $$\n3.  重复步骤 2 直到供应量收敛。当连续迭代之间的变化量小于一个很小的容差 $\\epsilon$ 时，即当 $\\max(|q_1^{(k+1)} - q_1^{(k)}|, |q_2^{(k+1)} - q_2^{(k)}|)  \\epsilon$ 时，达到收敛。\n\n在给定条件下，这个迭代过程保证会收敛到该模型的唯一纳什均衡，因为最佳对策函数构成了一个压缩映射。\n\n### 最终计算\n\n一旦迭代过程收敛到均衡供应量 $(q_1^\\star, q_2^\\star)$，我们就可以计算剩余的市场结果：\n-   均衡总供应量：$Q^\\star = q_1^\\star + q_2^\\star$。\n-   均衡价格：$p^\\star = a - Q^\\star$。只要 $c_1, c_2 \\ge 0$，价格就将是非负的。\n-   均衡利润：\n    $$\n    \\pi_1^\\star = p^\\star q_1^\\star - c_1(q_1^\\star)^2\n    $$\n    $$\n    \\pi_2^\\star = p^\\star q_2^\\star - c_2(q_2^\\star)^2\n    $$\n该实现将对每个提供的测试用例应用此完整过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the Cournot duopoly problem for the given test cases\n    and print the results in the specified format.\n    \"\"\"\n\n    # Test suite: each tuple is (a, c1, c2)\n    test_cases = [\n        (10, 1, 2),\n        (10, 1, 1),\n        (12, 0.5, 3),\n        (1, 4, 5),\n    ]\n\n    def compute_equilibrium(a, c1, c2, tol=1e-12, max_iter=1000):\n        \"\"\"\n        Computes the Nash Equilibrium using fixed-point iteration of best responses.\n\n        Args:\n            a (float): Demand intercept parameter.\n            c1 (float): Cost coefficient for prosumer 1.\n            c2 (float): Cost coefficient for prosumer 2.\n            tol (float): Convergence tolerance.\n            max_iter (int): Maximum number of iterations.\n\n        Returns:\n            list: A list containing [q1*, q2*, p*, pi1*, pi2*].\n        \"\"\"\n        \n        # Best response function for prosumer 1, given q2\n        def br1(q2_val):\n            numerator = a - q2_val\n            denominator = 2.0 * (1.0 + c1)\n            return max(0.0, numerator / denominator)\n\n        # Best response function for prosumer 2, given q1\n        def br2(q1_val):\n            numerator = a - q1_val\n            denominator = 2.0 * (1.0 + c2)\n            return max(0.0, numerator / denominator)\n\n        # Initial guess for quantities\n        q1, q2 = 0.0, 0.0\n\n        for _ in range(max_iter):\n            q1_old, q2_old = q1, q2\n            \n            # Simultaneous update (Jacobi-style iteration)\n            q1_new = br1(q2_old)\n            q2_new = br2(q1_old)\n\n            q1, q2 = q1_new, q2_new\n            \n            # Check for convergence\n            if max(abs(q1 - q1_old), abs(q2 - q2_old))  tol:\n                break\n        \n        # At convergence, q1 and q2 are the equilibrium quantities q1_star, q2_star\n        q1_star = q1\n        q2_star = q2\n        \n        # Calculate equilibrium aggregate quantity and price\n        Q_star = q1_star + q2_star\n        p_star = a - Q_star\n        \n        # Calculate equilibrium costs and profits\n        C1_star = c1 * q1_star**2\n        C2_star = c2 * q2_star**2\n        pi1_star = p_star * q1_star - C1_star\n        pi2_star = p_star * q2_star - C2_star\n        \n        return [q1_star, q2_star, p_star, pi1_star, pi2_star]\n\n    all_results = []\n    for case in test_cases:\n        a_param, c1_param, c2_param = case\n        result = compute_equilibrium(a_param, c1_param, c2_param)\n        all_results.append(result)\n\n    # Format the results for the final output string.\n    # Each number is rounded to three decimal places.\n    result_strings = []\n    for res_list in all_results:\n        # Use f-string formatting to ensure rounding and fixed decimal places (e.g., 2.000)\n        formatted_nums = [f\"{val:.3f}\" for val in res_list]\n        result_strings.append(f\"[{','.join(formatted_nums)}]\")\n\n    # Join the string representations of each case's results with a comma.\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}