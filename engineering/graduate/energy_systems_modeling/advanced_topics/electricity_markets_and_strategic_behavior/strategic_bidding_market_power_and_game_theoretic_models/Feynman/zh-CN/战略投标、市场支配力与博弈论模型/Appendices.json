{
    "hands_on_practices": [
        {
            "introduction": "为分析战略行为，我们首先必须掌握完全竞争环境下的价格形成基础。本练习侧重于计算“节点边际电价”（LMPs），这是现代电力市场设计的基石。通过为一个简单的双节点系统求解成本最小化问题，您将学习LMPs如何由边际发电成本和网络阻塞共同决定，从而为理解市场力提供一个关键的基准 。",
            "id": "4126837",
            "problem": "一个独立系统运营商 (ISO) 在节点边际电价 (LMP) 机制下，采用直流 (DC) 潮流近似（无损耗）来清算一个双节点纯能量市场。ISO 通过在满足节点功率平衡和输电约束的条件下最小化总发电成本来最大化社会福利。假设市场为完全竞争性投标（无市场势力），因此每个发电机都如实地报出其恒定的边际成本，并忽略诸如最小出力水平和启停等非凸性。\n\n考虑由一条从 A 到 B 的单回输电线路连接的节点 A 和 B，其对称热容量为 $50$ 兆瓦 (MW)。节点需求固定为节点 A 处 $200$ MW，节点 B 处 $100$ MW。每个节点各有一个发电机，其边际成本为常数：节点 A 的边际成本为每兆瓦时 $30$ 美元 (`$/MWh`)，节点 B 的边际成本为每兆瓦时 $40$ 美元 (`$/MWh`)。两台发电机的容量都足够大，因此发电机容量约束不起作用。\n\n在直流潮流近似下，令 $g_A$ 和 $g_B$ 表示节点 A 和 B 的发电量，$d_A = 200$ 和 $d_B = 100$ 为需求量，$f$ 为从 A 到 B 的线路潮流。ISO 求解成本最小化调度问题，以确定受网络约束的均衡状态。请从第一性原理出发，不使用任何快捷公式，通过以下步骤推导出节点 A 和 B 的 LMP：\n- 建立以决策变量 $g_A$、$g_B$ 和 $f$ 表示的优化问题，包括节点功率平衡和线路容量约束。\n- 求解最优调度并确定哪些约束是紧约束。\n- 使用 Karush–Kuhn–Tucker (KKT) 条件来确定与每个节点注入功率的边际价值相对应的对偶变量，并将这些对偶变量解释为完全竞争、价格接受行为下的 LMP。\n\n计算节点 A 和 B 的 LMP 的数值。以行矩阵 $\\begin{pmatrix}\\text{LMP}_A  \\text{LMP}_B\\end{pmatrix}$ 的形式提供您的最终答案，单位为 $/MWh$。无需四舍五入，报告精确值。",
            "solution": "用户希望通过建立并求解一个直流优化潮流 (DC-OPF) 问题，来求得一个双节点电力系统的节点边际电价 (LMP)。该解答必须使用 Karush–Kuhn–Tucker (KKT) 条件从第一性原理推导得出。\n\n### 步骤一：问题验证\n\n**已知条件提取：**\n-   **系统**：一个由独立系统运营商 (ISO) 清算的双节点 (节点 A 和 B) 能量市场。\n-   **模型**：直流 (DC) 潮流近似，无损耗。\n-   **定价**：节点边际电价 (LMP)。\n-   **目标**：最大化社会福利，等同于最小化总发电成本。\n-   **市场假设**：完全竞争性投标 (发电机报出其恒定的边际成本)。\n-   **输电线路**：从节点 A 到节点 B 的单回线路，对称容量为 $50$ MW。\n-   **需求**：节点 A 的固定需求为 $d_A = 200$ MW，节点 B 的固定需求为 $d_B = 100$ MW。\n-   **发电机**：\n    -   节点 A：恒定边际成本 $c_A = 30$ $/MWh。\n    -   节点 B：恒定边际成本 $c_B = 40$ $/MWh。\n    -   两台发电机容量都足够大 (无容量约束起作用)。\n-   **决策变量**：节点 A 的发电量 ($g_A$)、节点 B 的发电量 ($g_B$) 和从 A 到 B 的功率潮流 ($f$)。\n-   **任务**：\n    1.  建立成本最小化的优化问题。\n    2.  求解最优调度 ($g_A, g_B, f$) 并确定紧约束。\n    3.  使用 KKT 条件找到与 LMP 对应的对偶变量。\n    4.  计算节点 A 和 B 的 LMP 数值 ($\\text{LMP}_A, \\text{LMP}_B$)。\n\n**验证分析：**\n这个问题是有科学依据的，是电力系统工程中的一个标准经济调度问题。它基于成熟的 DC-OPF 模型和 LMP 理论。这个问题是适定的；它是一个线性规划问题，具有明确的目标函数和一组线性约束，保证了唯一且稳定的解。问题陈述是客观的，使用了精确、明确的技术语言。所有必要的数据 ($c_A, c_B, d_A, d_B$, 线路容量) 都已提供，且没有内部矛盾。这个设置是一个经典的教科书例子，用于阐释阻塞管理和 LMP 计算的原理。因此，该问题是有效的。\n\n### 步骤二：求解\n\n**1. 优化问题的建立**\n\nISO 的目标是最小化总发电成本，即各个发电机成本之和。成本是边际成本与发电量的乘积。\n目标函数为：\n$$ \\min_{g_A, g_B, f} C(g_A, g_B) = 30 g_A + 40 g_B $$\n\n该最小化问题受以下几个约束条件限制：\n\n-   **发电量非负性**：发电量必须为非负。\n    $$ g_A \\ge 0 $$\n    $$ g_B \\ge 0 $$\n\n-   **节点功率平衡**：在每个节点，总注入功率必须等于总取出功率。功率注入来自发电机，功率取出用于满足需求和流出节点的线路潮流。\n    -   节点 A：$g_A = d_A + f$。由于 $d_A = 200$，即 $g_A - f - 200 = 0$。\n    -   节点 B：$g_B + f = d_B$。由于 $d_B = 100$，即 $g_B + f - 100 = 0$。\n\n-   **输电线路容量**：从节点 A 到节点 B 的潮流 $f$ 受线路热容量的限制。\n    $$ -50 \\le f \\le 50 $$\n    这等价于两个不等式约束：\n    $$ f \\le 50 $$\n    $$ f \\ge -50 \\quad (\\text{或 } -f \\le 50) $$\n\n完整的优化问题为：\n$$ \\min_{g_A, g_B, f} \\quad 30 g_A + 40 g_B $$\n约束条件为：\n\\begin{align*}\n     g_A - f - 200 = 0  \\quad (\\text{对偶变量 } \\lambda_A) \\\\\n     g_B + f - 100 = 0  \\quad (\\text{对偶变量 } \\lambda_B) \\\\\n     f - 50 \\le 0  \\quad (\\text{对偶变量 } \\mu_{AB} \\ge 0) \\\\\n     -f - 50 \\le 0  \\quad (\\text{对偶变量 } \\mu_{BA} \\ge 0) \\\\\n     -g_A \\le 0  \\quad (\\text{对偶变量 } \\eta_A \\ge 0) \\\\\n     -g_B \\le 0  \\quad (\\text{对偶变量 } \\eta_B \\ge 0)\n\\end{align*}\n\n**2. 求解最优调度**\n\n首先，考虑一个不考虑输电限制的“经济排序”调度。系统总需求为 $d_A + d_B = 200 + 100 = 300$ MW。为了最小化成本，ISO 会调度节点 A 处更便宜的发电机 ($c_A = 30$ $/MWh$) 来满足全部负荷。\n这将意味着 $g_A = 300$ MW 且 $g_B = 0$ MW。\n\n我们通过计算所需的功率潮流来检查这种调度是否可行。\n根据节点 A 的功率平衡：$g_A - f - 200 = 0 \\implies 300 - f - 200 = 0 \\implies f = 100$ MW。\n这个从 A 到 B 的 $100$ MW 的所需潮流超过了 $50$ MW 的输电线路容量。因此，无约束的解是不可行的，输电线路在从 A 到 B 的方向上发生了阻塞。\n\n在最优的有约束调度中，从 A 到 B 的潮流将处于其可能的最大值，以便尽可能多地利用来自节点 A 的廉价发电。\n所以，紧约束是 $f \\le 50$，这意味着在最优解中 $f = 50$ MW。\n\n当 $f = 50$ MW 时，我们可以从功率平衡方程确定最优发电水平：\n-   节点 A：$g_A = 200 + f = 200 + 50 = 250$ MW。\n-   节点 B：$g_B = 100 - f = 100 - 50 = 50$ MW。\n\n最优调度为 $g_A^* = 250$ MW，$g_B^* = 50$ MW，以及 $f^* = 50$ MW。\n$g_A^*$ 和 $g_B^*$ 都是正数，所以发电量的非负性约束不是紧约束。\n潮流 $f^* = 50$ MW 意味着约束 $f \\le 50$ 是紧约束，而约束 $f \\ge -50$ 不是紧约束 (因为 $50  -50$)。\n\n**3. 使用 KKT 条件推导 LMP**\n\n一个节点的节点边际电价 (LMP) 是与该节点功率平衡约束相关联的对偶变量。我们使用该优化问题的 KKT 条件来找到这些对偶变量 ($\\lambda_A$ 和 $\\lambda_B$)。\n\n该问题的拉格朗日函数 $\\mathcal{L}$ 是：\n$$ \\mathcal{L} = (30 g_A + 40 g_B) - \\lambda_A(g_A - f - 200) - \\lambda_B(g_B + f - 100) + \\mu_{AB}(f - 50) + \\mu_{BA}(-f - 50) - \\eta_A g_A - \\eta_B g_B $$\n\nKKT 平稳性条件要求在最优解处，拉格朗日函数对决策变量的偏导数为零：\n\\begin{align*}\n    \\frac{\\partial \\mathcal{L}}{\\partial g_A} = 30 - \\lambda_A - \\eta_A = 0 \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial g_B} = 40 - \\lambda_B - \\eta_B = 0 \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial f} = \\lambda_A - \\lambda_B + \\mu_{AB} - \\mu_{BA} = 0\n\\end{align*}\n\nKKT 互补松弛条件是：\n\\begin{align*}\n    \\mu_{AB}(f - 50) = 0 \\\\\n    \\mu_{BA}(-f - 50) = 0 \\\\\n    \\eta_A g_A = 0 \\\\\n    \\eta_B g_B = 0\n\\end{align*}\n\n现在我们使用我们的最优调度解 ($g_A^* = 250$, $g_B^* = 50$, $f^* = 50$) 来求解对偶变量：\n\n-   由于 $g_A^* = 250  0$，互补松弛条件 $\\eta_A g_A = 0$ 意味着 $\\eta_A = 0$。\n-   由于 $g_B^* = 50  0$，互补松弛条件 $\\eta_B g_B = 0$ 意味着 $\\eta_B = 0$。\n-   由于 $f^* = 50$，约束 $-f - 50 \\le 0$ 变为 $-50 - 50 = -100 \\le 0$，这不是紧约束。因此，其对偶变量必须为零：$\\mu_{BA} = 0$。\n-   由于 $f^* = 50$，约束 $f - 50 \\le 0$ 是紧约束。其对偶变量 $\\mu_{AB}$ 可以不为零 ($\\mu_{AB} \\ge 0$)。\n\n将 $\\eta_A=0$ 代入第一个平稳性条件：\n$$ 30 - \\lambda_A - 0 = 0 \\implies \\lambda_A = 30 $$\n因此，节点 A 的 LMP 是 $\\text{LMP}_A = \\lambda_A = 30$ $/MWh。\n\n将 $\\eta_B=0$ 代入第二个平稳性条件：\n$$ 40 - \\lambda_B - 0 = 0 \\implies \\lambda_B = 40 $$\n因此，节点 B 的 LMP 是 $\\text{LMP}_B = \\lambda_B = 40$ $/MWh。\n\n我们可以使用第三个平稳性条件来检查一致性：\n$$ \\lambda_A - \\lambda_B + \\mu_{AB} - \\mu_{BA} = 0 $$\n$$ 30 - 40 + \\mu_{AB} - 0 = 0 \\implies \\mu_{AB} = 10 $$\n由于 $\\mu_{AB} = 10 \\ge 0$，这与 KKT 条件一致。值 $\\mu_{AB}=10$ $/MWh 代表了输电线路的阻塞租金。\n\n解释是，每个节点的价格是由向该节点供应下一兆瓦能量的边际成本决定的。在节点 A，额外的 1 MW 可以由本地发电机以 $30$ $/MWh 的成本供应。在节点 B，由于来自 A 的更廉价的电力因阻塞而无法获得，额外的 1 MW 必须由本地更昂贵的发电机供应，从而将其价格设定为其边际成本 $40$ $/MWh。\n\n最终数值为 $\\text{LMP}_A = 30$ $/MWh 和 $\\text{LMP}_B = 40$ $/MWh。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30  40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在建立了竞争性基准之后，我们现在将探讨当少数几家公司进行战略互动时，市场结果会如何改变。本练习介绍了古诺模型（Cournot model），这是一个基础的博弈论工具，在该模型中，企业通过竞争产量进行博弈。通过推导对称均衡，您将亲眼看到与完全竞争的理想情况相比，寡头竞争如何导致更高的价格和更低的总产量 。",
            "id": "4126859",
            "problem": "一个单节点电力市场通过相同火电发电机组之间的非合作数量竞争，对一个交易区间进行出清。市场逆需求函数是线性的，由 $P(Q) = a - b Q$ 给出，其中 $P$ 是市场出清价格，单位为 $/MWh$，而 $Q$ 是该区间内的总供应功率，单位为 $\\mathrm{MW}$。市场中有 $N=3$ 个相同的公司。每个公司 $i \\in \\{1,2,3\\}$ 同时选择一个数量 $q_i \\in [0,\\bar{q}]$ 来最大化其利润 $\\pi_i = (P(Q) - c) q_i$，并受其容量约束，其中 $Q = \\sum_{j=1}^{3} q_j$。成本结构具有恒定的边际成本 $c$，没有固定成本。参数为 $a = 100$ $/MWh$，$b = 0.1$ $/(\\mathrm{MWh}\\cdot\\mathrm{MW})$，$c = 20$ $/MWh$，以及每个公司的容量 $\\bar{q} = 300$ $\\mathrm{MW}$。\n\n任务：\n1. 从古诺竞争下的利润最大化定义和线性逆需求函数出发，推导代表性公司的内部最优反应的一阶条件，并求出对称的内部古诺均衡候选解 $(q_1^*,q_2^*,q_3^*)$ 和 $P^*$。\n2. 验证内部解是否满足每个公司的容量约束。如果任何约束是紧的，确定与公司最优反应和市场出清一致的容量受限均衡，并计算相应的 $P^*$。\n3. 陈述你找到的均衡数量和价格，并确认容量是否是紧约束。\n\n仅报告最终的均衡价格 $P^*$ 作为你的最终数值答案，以 $/MWh$ 为单位，并四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其是适定的、有科学依据的和自洽的。\n\n**第 1 步：提取已知条件**\n- 市场逆需求函数：$P(Q) = a - b Q$\n- 总供应功率：$Q = \\sum_{j=1}^{3} q_j$\n- 相同公司的数量：$N=3$\n- 单个公司的数量：$q_i \\in [0, \\bar{q}]$\n- 公司 $i$ 的利润函数：$\\pi_i = (P(Q) - c) q_i$\n- 边际成本：$c = 20$ $/MWh$ (恒定)\n- 每个公司的容量：$\\bar{q} = 300$ $\\mathrm{MW}$\n- 参数 $a$：$a = 100$ $/MWh$\n- 参数 $b$：$b = 0.1$ $/(\\mathrm{MWh}\\cdot\\mathrm{MW})$\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个古诺竞争模型，这是微观经济学和博弈论中的一个标准和基本概念，通常用于模拟寡头市场（包括电力市场）中的战略互动。线性需求和恒定边际成本的假设是便于分析的标准假设。\n- **适定性**：该问题是适定的。它要求解一个具有凹利润函数和线性约束的博弈的纳什均衡。这种问题结构通常能保证均衡的存在性和唯一性，并且问题明确要求处理容量约束。\n- **客观性**：该问题使用精确、客观的数学和经济学术语进行陈述。\n- **完整性和一致性**：该问题提供了确定唯一解所需的所有函数、参数和约束。单位是一致的。例如，$bQ$ 的单位是 $(\\$/(\\text{MWh}\\cdot\\text{MW})) \\cdot \\text{MW} = \\$/\\text{MWh}$，这与 $P$ 和 $a$ 的单位相匹配。\n\n**第 3 步：结论与行动**\n问题被认为是有效的。将推导解答。\n\n问题要求解 $N=3$ 个相同公司的对称古诺-纳什均衡。每个公司 $i$ 选择其生产数量 $q_i$ 以最大化其利润 $\\pi_i$，同时将其他公司的数量 $Q_{-i} = \\sum_{j \\neq i} q_j$ 视为给定。\n\n公司 $i$ 的利润函数为：\n$$\n\\pi_i(q_i, Q_{-i}) = ( P(q_i + Q_{-i}) - c ) q_i\n$$\n代入线性逆需求函数 $P(Q) = a - bQ$：\n$$\n\\pi_i(q_i, Q_{-i}) = ( a - b(q_i + Q_{-i}) - c ) q_i\n$$\n这可以展开为：\n$$\n\\pi_i(q_i, Q_{-i}) = (a - c)q_i - b Q_{-i} q_i - b q_i^2\n$$\n为了找到公司 $i$ 的最优反应，我们首先假设一个内部解，其中 $0  q_i  \\bar{q}$，并对利润函数关于 $q_i$ 求一阶导数。然后我们将此导数设为零：\n$$\n\\frac{\\partial \\pi_i}{\\partial q_i} = a - c - b Q_{-i} - 2b q_i = 0\n$$\n二阶导数为 $\\frac{\\partial^2 \\pi_i}{\\partial q_i^2} = -2b$。由于 $b = 0.1 > 0$，二阶导数为负，这证实了利润函数在 $q_i$ 上是严格凹的，且一阶条件产生一个最大值。\n\n求解 $q_i$ 的一阶条件，得到公司 $i$ 的最优反应（或反应）函数：\n$$\nq_i(Q_{-i}) = \\frac{a - c - b Q_{-i}}{2b}\n$$\n在对称纳什均衡中，所有公司生产相同的数量，因此对于所有 $i \\in \\{1, 2, 3\\}$，都有 $q_i = q^*$。对于任何给定的公司 $i$，其竞争对手生产的总数量为 $Q_{-i} = (N-1)q^*$。将此代入最优反应函数：\n$$\nq^* = \\frac{a - c - b (N-1)q^*}{2b}\n$$\n现在，我们求解 $q^*$：\n$$\n2b q^* = a - c - b(N-1)q^*\n$$\n$$\n2b q^* + b(N-1)q^* = a - c\n$$\n$$\nb q^* (2 + N - 1) = a - c\n$$\n$$\nb q^* (N+1) = a - c\n$$\n对称的内部古诺均衡数量是：\n$$\nq^* = \\frac{a-c}{b(N+1)}\n$$\n这是每个公司均衡数量的候选解。我们代入给定的参数值：$a = 100$，$b = 0.1$，$c = 20$ 和 $N = 3$。\n$$\nq^* = \\frac{100 - 20}{0.1(3+1)} = \\frac{80}{0.1 \\times 4} = \\frac{80}{0.4} = 200 \\; \\mathrm{MW}\n$$\n公司的容量限制为 $\\bar{q} = 300 \\; \\mathrm{MW}$。我们必须验证计算出的内部解是否满足此约束。\n$$\nq^* = 200 \\text{ MW} \\le 300 \\text{ MW} = \\bar{q}\n$$\n由于最优无约束数量 $q^*$ 小于容量限制 $\\bar{q}$，因此容量约束对任何公司都不是紧的。因此，内部解是有效的均衡。\n\n均衡数量为 $(q_1^*, q_2^*, q_3^*) = (200, 200, 200)$ MW。容量不构成紧约束。\n\n供应到市场的总均衡数量是：\n$$\nQ^* = \\sum_{j=1}^{3} q_j^* = N q^* = 3 \\times 200 = 600 \\; \\mathrm{MW}\n$$\n相应的市场出清价格可以通过将 $Q^*$ 代入逆需求函数来找到：\n$$\nP^* = P(Q^*) = a - b Q^*\n$$\n$$\nP^* = 100 - 0.1 \\times 600 = 100 - 60 = 40 \\; \\$/\\mathrm{MWh}\n$$\n最终均衡价格为 $40$ $/MWh$。问题要求答案四舍五入到四位有效数字。\n\n最终均衡价格：$P^* = 40.00$ $/MWh$。",
            "answer": "$$\n\\boxed{40.00}\n$$"
        },
        {
            "introduction": "最后的这个练习综合了我们对网络约束和战略行为的理解，以模拟一种典型的市场力形式。我们将研究发电商如何通过“经济性容量扣留”——即战略性地减少其可用容量以制造人为稀缺——来获利。这个练习展示了一家公司的战略决策、电网的物理约束以及由此产生的对节点边际电价的操控之间的实际联系 。",
            "id": "4126869",
            "problem": "考虑一个使用直流最优潮流 (DC-OPF) 模型建模的双节点电网，其中有一条输电线路连接节点 $1$ 和节点 $2$。设节点 $1$ 的净需求为 $d_1 = 300$ 兆瓦 (MW)，节点 $2$ 的净需求为 $d_2 = 200$ MW。输电线路的对称热极限大小为 $F = 100$ MW；将从节点 $1$ 到节点 $2$ 的有功潮流变量表示为 $f$，并施加约束 $-F \\leq f \\leq F$。有三台发电机：\n- 位于节点 $1$ 的发电机 $1$，其边际成本为常数 $c_1 = 25$ 美元/兆瓦时 (`$/MWh`)，没有容量上限。\n- 位于节点 $2$ 的发电机 $2$，其边际成本为常数 $c_2 = 35$ $/MWh$。最初，假设其容量上限足够大以至于不起作用。在策略性容量削减的情况下，发电机 $2$ 将其可用容量减少至 $50$ MW。\n- 位于节点 $2$ 的调峰发电机 $3$，其边际成本为常数 $c_3 = 100$ $/MWh$，代表下一个可用的技术，没有容量上限。\n\n假设单周期市场出清，无损耗，无其他约束。系统运营商通过最小化总可变发电成本来出清市场，同时满足节点功率平衡和输电限制。节点上的节点边际电价 (LMP) 定义为 DC-OPF 中节点功率平衡约束的拉格朗日乘子。\n\n任务：\n1. 建立 DC-OPF 模型，并从第一性原理出发，推导出表征最优调度和节点边际电价 (LMP) 的 Karush–Kuhn–Tucker (KKT) 条件。\n2. 在基准情况（无容量削减）下，计算最优调度和 LMP $\\text{LMP}_1$ 与 $\\text{LMP}_2$。\n3. 通过对发电机 $2$ 施加容量上限约束 $g_2 \\leq 50$ MW 来模拟容量削减，并重新计算最优调度和 LMP $\\text{LMP}_1$ 与 $\\text{LMP}_2$。\n4. 计算发电机 $2$ 在基准情况和容量削减情况之间的利润变化。利润定义为收入减去可变成本，即 $\\pi_2 = \\text{LMP}_2 \\cdot g_2 - c_2 \\cdot g_2$。\n\n按以下顺序将您的最终结果报告为单个行向量：基准情况的 $\\text{LMP}_1$、基准情况的 $\\text{LMP}_2$、容量削减情况的 $\\text{LMP}_1$、容量削减情况的 $\\text{LMP}_2$ 以及发电机 $2$ 的利润变化。所有 LMP 以 $/MWh$ 表示，利润变化以 $/h$ 表示。提供精确的数值；无需四舍五入。",
            "solution": "这个问题是使用直流最优潮流 (DC-OPF) 模型进行电力市场分析的一个明确定义的练习。它具有科学依据，内部一致，并包含找到唯一解所需的所有必要信息。因此，该问题被认为是有效的。\n\n### 步骤 1：DC-OPF 模型建立与 KKT 条件\n\n系统运营商的目标是最小化总发电成本，该成本是发电输出 $g_1, g_2, g_3$ 的线性函数。优化变量是发电水平 $g_1, g_2, g_3$（单位：MW）和从节点 $1$到节点 $2$ 的潮流 $f$（单位：MW）。\n\n**目标函数：**\n最小化总发电成本 $C$：\n$$ \\min_{g_1, g_2, g_3, f} C = c_1 g_1 + c_2 g_2 + c_3 g_3 $$\n其中 $c_1=25$，$c_2=35$ 和 $c_3=100$ 是边际成本，单位为 $/MWh$。\n\n**约束条件：**\n1.  **节点 1 的节点功率平衡：** 节点 $1$ 的发电量必须满足当地需求 $d_1$ 和输出功率 $f$。\n    $$ g_1 - d_1 - f = 0 \\quad : \\quad \\text{LMP}_1 $$\n2.  **节点 2 的节点功率平衡：** 节点 $2$ 的发电量加上输入功率 $f$，必须满足当地需求 $d_2$。\n    $$ g_2 + g_3 - d_2 + f = 0 \\quad : \\quad \\text{LMP}_2 $$\n3.  **输电线路限制：** 潮流 $f$ 受线路容量 $F$ 的限制。\n    $$ f - F \\leq 0 \\quad : \\quad \\mu_{\\text{max}} $$\n    $$ -f - F \\leq 0 \\quad : \\quad \\mu_{\\text{min}} $$\n4.  **发电量非负性：** 发电水平不能为负。\n    $$ -g_1 \\leq 0 \\quad : \\quad \\nu_1 $$\n    $$ -g_2 \\leq 0 \\quad : \\quad \\nu_2 $$\n    $$ -g_3 \\leq 0 \\quad : \\quad \\nu_3 $$\n\n节点功率平衡约束的拉格朗日乘子是节点边际电价 (LMP)。乘子 $\\mu_{\\text{max}}$, $\\mu_{\\text{min}}$, $\\nu_1, \\nu_2, \\nu_3$ 必须为非负。\n\n此优化问题的拉格朗日函数 $\\mathcal{L}$ 为：\n$$ \\mathcal{L} = (c_1 g_1 + c_2 g_2 + c_3 g_3) - \\text{LMP}_1(g_1 - d_1 - f) - \\text{LMP}_2(g_2 + g_3 - d_2 + f) + \\mu_{\\text{max}}(f-F) + \\mu_{\\text{min}}(-f-F) - \\nu_1 g_1 - \\nu_2 g_2 - \\nu_3 g_3 $$\n\n最优性的 Karush-Kuhn-Tucker (KKT) 条件是：\n\n**1. 平稳性（$\\mathcal{L}$ 对原始变量的导数为零）：**\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 - \\text{LMP}_1 - \\nu_1 = 0 \\implies \\text{LMP}_1 = c_1 - \\nu_1 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 - \\text{LMP}_2 - \\nu_2 = 0 \\implies \\text{LMP}_2 = c_2 - \\nu_2 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_3} = c_3 - \\text{LMP}_2 - \\nu_3 = 0 \\implies \\text{LMP}_2 = c_3 - \\nu_3 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial f} = \\text{LMP}_1 - \\text{LMP}_2 + \\mu_{\\text{max}} - \\mu_{\\text{min}} = 0 \\implies \\text{LMP}_2 - \\text{LMP}_1 = \\mu_{\\text{max}} - \\mu_{\\text{min}} $$\n\n**2. 原始可行性：** 所有约束都必须满足。\n\n**3. 对偶可行性：** 所有不等式乘子必须为非负。\n$$ \\mu_{\\text{max}} \\geq 0, \\quad \\mu_{\\text{min}} \\geq 0, \\quad \\nu_1 \\geq 0, \\quad \\nu_2 \\geq 0, \\quad \\nu_3 \\geq 0 $$\n\n**4. 互补松弛性：**\n$$ \\mu_{\\text{max}}(f-F) = 0 $$\n$$ \\mu_{\\text{min}}(-f-F) = 0 $$\n$$ \\nu_1 g_1 = 0, \\quad \\nu_2 g_2 = 0, \\quad \\nu_3 g_3 = 0 $$\n\n根据这些条件，如果发电机 $i$ 被调度 ($g_i > 0$)，则 $\\nu_i=0$，其边际成本决定或低于其所在节点的 LMP（例如，$\\text{LMP}_1 = c_1$）。如果 LMP 高于发电机的成本，则该发电机是“边际内”的。边际发电机决定了 LMP。如果线路未拥塞 ($-F  f  F$)，则 $\\mu_{\\text{max}} = \\mu_{\\text{min}} = 0$，这意味着 $\\text{LMP}_1 = \\text{LMP}_2$。\n\n### 步骤 2：最优调度和 LMP（基准情况）\n\n给定数据：$d_1 = 300$ MW, $d_2 = 200$ MW, $F=100$ MW, $c_1=25$ $/MWh, $c_2=35$ $/MWh, $c_3=100$ $/MWh。总需求为 $d_1+d_2=500$ MW。\n\n首先，考虑无输电约束的情景。最便宜的发电机是 G1 ($c_1=25$)，它将满足全部 $500$ MW 的需求。这将需要 $g_1=500$，$g_2=0$，$g_3=0$。潮流将为 $f = g_1 - d_1 = 500 - 300 = 200$ MW。此潮流 $f=200$ MW 超过了极限 $F=100$ MW。因此，输电线路发生拥塞。\n\n在线路拥塞的情况下，潮流被限制在经济效益方向（从低成本的 G1 到节点 2 的负荷）的最大容量。因此，$f = F = 100$ MW。\n\n我们用 $f=100$ 求解节点功率平衡：\n- **节点 1：** $g_1 - d_1 = f \\implies g_1 - 300 = 100 \\implies g_1 = 400$ MW。\n- **节点 2：** $g_2 + g_3 - d_2 = -f \\implies g_2 + g_3 - 200 = -100 \\implies g_2 + g_3 = 100$ MW。\n\n现在，我们确定每个节点的发电量和 LMP：\n- 在节点 1，G1 必须生产 $400$ MW。由于 $g_1 > 0$，G1 被调度并决定了节点 1 的电价。\n  $$ \\text{LMP}_1 = c_1 = 25 \\text{ \\$/MWh} $$\n- 在节点 2，总共必须生成 $100$ MW。可用的发电机是 G2 ($c_2=35$) 和 G3 ($c_3=100$)。为了最小化成本，系统调度较便宜的发电机 G2。\n  $$ g_2 = 100 \\text{ MW}, \\quad g_3 = 0 \\text{ MW} $$\n- 由于 $g_2 > 0$ 并且它是节点 2 上运行的最昂贵的发电机，因此它是边际机组。\n  $$ \\text{LMP}_2 = c_2 = 35 \\text{ \\$/MWh} $$\n\n线路从节点 1 到 2 发生拥塞，因此我们预期 $\\text{LMP}_2 > \\text{LMP}_1$。确实，$35 > 25$。拥塞租金（约束的影子价格）为 $\\mu_{\\text{max}} = \\text{LMP}_2 - \\text{LMP}_1 = 35 - 25 = 10$ $/MWh。\n\n**基准情况结果：**\n- 调度：$g_1=400$ MW，$g_2=100$ MW，$g_3=0$ MW。\n- LMP：$\\text{LMP}_{1, \\text{base}} = 25$ $/MWh, \\text{LMP}_{2, \\text{base}} = 35$ $/MWh。\n\n### 步骤 3：最优调度和 LMP（容量削减情况）\n\n增加了一个新的约束条件：$g_2 \\leq 50$ MW。\n\n经济动机仍然是从便宜的节点 1 向节点 2 发送最大功率。我们假设线路保持在其极限拥塞状态，$f = F = 100$ MW。这个假设将通过最终的电价（$\\text{LMP}_2 > \\text{LMP}_1$）来验证。\n\n节点平衡保持不变：\n- **节点 1：** $g_1 = 400$ MW。\n- **节点 2：** $g_2 + g_3 = 100$ MW。\n\n调度和 LMP：\n- 在节点 1，发电量和电价保持不变。G1 被调度且没有容量限制。\n  $$ g_1 = 400 \\text{ MW}, \\quad \\text{LMP}_1 = c_1 = 25 \\text{ \\$/MWh} $$\n- 在节点 2，我们需要 $100$ MW。G2 ($c_2=35$) 首先被调度，但只能达到其新的极限 $50$ MW。\n  $$ g_2 = 50 \\text{ MW} $$\n  剩下的 $100 - 50 = 50$ MW 必须由次便宜的发电机 G3 ($c_3=100$) 提供。\n  $$ g_3 = 50 \\text{ MW} $$\n- 在节点 2，G3 现在是设定电价的边际机组，因为它是为满足需求而调度​​的最昂贵的机组。\n  $$ \\text{LMP}_2 = c_3 = 100 \\text{ \\$/MWh} $$\n\n我们关于拥塞的假设是有效的，因为 $\\text{LMP}_2 = 100 > \\text{LMP}_1 = 25$。现在的拥塞租金是 $\\mu_{\\text{max}} = 100 - 25 = 75$ $/MWh。\n\n**容量削减情况结果：**\n- 调度：$g_1=400$ MW, $g_2=50$ MW, $g_3=50$ MW。\n- LMP：$\\text{LMP}_{1, \\text{withhold}} = 25$ $/MWh, \\text{LMP}_{2, \\text{withhold}} = 100$ $/MWh。\n\n### 步骤 4：发电机 2 的利润变化\n\n发电机 2 的利润 $\\pi_2$ 定义为收入减去可变成本：$\\pi_2 = (\\text{LMP}_2 - c_2) \\cdot g_2$。\n\n**基准情况利润 ($\\pi_{2, \\text{base}}$):**\n- 在基准情况下，$g_{2, \\text{base}} = 100$ MW 且 $\\text{LMP}_{2, \\text{base}} = 35$ $/MWh。边际成本为 $c_2=35$ $/MWh。\n- $\\pi_{2, \\text{base}} = (35 - 35) \\cdot 100 = 0$ $/h。\n- 这是预料之中的，因为 G2 是定价的边际机组，因此其生产者剩余为零。\n\n**容量削减情况利润 ($\\pi_{2, \\text{withhold}}$):**\n- 在容量削减情况下，$g_{2, \\text{withhold}} = 50$ MW 且 $\\text{LMP}_{2, \\text{withhold}} = 100$ $/MWh。边际成本为 $c_2=35$ $/MWh。\n- $\\pi_{2, \\text{withhold}} = (100 - 35) \\cdot 50 = 65 \\cdot 50 = 3250$ $/h。\n- G2 现在是一个“边际内”机组，以一个更昂贵的发电机设定的价格出售其电力，从而获得了可观的利润。\n\n**利润变化 ($\\Delta \\pi_2$):**\n- 利润变化是容量削减情况和基准情况利润之间的差额。\n- $\\Delta \\pi_2 = \\pi_{2, \\text{withhold}} - \\pi_{2, \\text{base}} = 3250 - 0 = 3250$ $/h。\n\n需要报告的最终结果是：\n- 基准情况 $\\text{LMP}_1 = 25$\n- 基准情况 $\\text{LMP}_2 = 35$\n- 容量削减情况 $\\text{LMP}_1 = 25$\n- 容量削减情况 $\\text{LMP}_2 = 100$\n- G2 的利润变化 = $3250$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n25  35  25  100  3250\n\\end{pmatrix}\n}\n$$"
        }
    ]
}