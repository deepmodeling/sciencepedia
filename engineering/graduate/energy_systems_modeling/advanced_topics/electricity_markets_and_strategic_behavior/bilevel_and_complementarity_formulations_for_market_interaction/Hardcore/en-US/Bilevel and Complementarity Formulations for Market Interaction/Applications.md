## Applications and Interdisciplinary Connections

Having established the foundational principles and solution methodologies for bilevel programs and their complementarity-based reformulations, this chapter explores the breadth and depth of their application. The abstract mathematical structures discussed previously are not mere theoretical curiosities; they are powerful analytical tools used to model, analyze, and design complex systems characterized by hierarchical decision-making and [strategic interaction](@entry_id:141147). We will demonstrate how these frameworks provide crucial insights into a wide array of phenomena in energy systems, market design, policy analysis, and related interdisciplinary fields. Our focus will shift from the mechanics of the models to their utility in capturing the essence of real-world problems.

### Modeling Strategic Behavior of Market Participants

The most direct and widespread application of bilevel and [complementarity formulations](@entry_id:1122718) in energy systems is the modeling of strategic behavior in liberalized [electricity markets](@entry_id:1124241). In these markets, the Independent System Operator (ISO) acts as a central coordinator (the follower) that clears the market to ensure reliability and economic efficiency based on the bids it receives. The market participants, such as generating companies (GENCOs), act as strategic agents (the leaders) who submit bids to maximize their own profits, anticipating the ISO's reaction.

#### Individual Agent Market Power

A fundamental question in market analysis is how a single strategic agent can exercise market power. A bilevel framework can precisely quantify this behavior. Consider a simple transmission-constrained network where a strategic generator is located at a bus with significant local demand. If the transmission lines connecting this bus to cheaper sources of generation are congested, the strategic generator is no longer in direct competition with them. By submitting a high-priced offer, the generator can force the ISO, which must serve the local demand, to dispatch its expensive power. The Locational Marginal Price (LMP) at this bus is then set by the strategic generator's offer, not its true marginal cost. The generator can optimize its offer—both the price and the quantity—to maximize the resulting profit, a classic leader-follower problem. This strategy may involve physical withholding (offering less quantity than available) or economic withholding (offering at a price far above marginal cost) to induce congestion and exploit its locational advantage .

This [strategic interaction](@entry_id:141147) is a cornerstone of industrial organization theory, often conceptualized through the Stackelberg leader-follower model. In an energy context, a large, dominant firm can be modeled as a leader that optimizes its output quantity or price offer, anticipating the reaction of smaller, price-taking firms that constitute a "competitive fringe." The leader's problem is not to optimize against the total market demand, but against a *residual demand curve*—the portion of market demand that remains after the competitive fringe has supplied its profit-maximizing quantity at any given price. The fringe's supply behavior, derived from the first-order conditions of their own profit maximization, is embedded as a lower-level problem. By solving this bilevel program, one can derive the dominant firm's optimal production level and the resulting markup of price over its marginal cost, providing a quantitative measure of its market power  .

#### Intertemporal and Multi-Product Strategies

The strategic landscape extends beyond a single period and a single product. Agents with operational flexibility across time or the ability to offer multiple services can leverage [bilevel optimization](@entry_id:637138) to co-optimize their decisions.

A prime example is the operator of an energy storage facility, such as a battery or pumped-hydro plant. The storage operator acts as a leader, making decisions on when to charge (buy energy) and when to discharge (sell energy) to profit from price arbitrage. The follower is the market operator, who clears the market in each period, setting hourly prices based on the net demand, which is influenced by the storage operator's actions. The storage operator's upper-level problem is to maximize arbitrage profit over a planning horizon, subject to its own physical constraints (state of charge, power limits, efficiency). The lower-level problem, repeated for each hour, is the ISO's economic dispatch. By anticipating the price impact of its own charging and discharging decisions, the storage operator can devise a strategy that optimally shifts energy from low-price periods to high-price periods, often mitigating price volatility while maximizing its revenue .

Similarly, generators often participate in multiple markets simultaneously, most notably the markets for energy and [ancillary services](@entry_id:1121004) like [operating reserves](@entry_id:1129146). A generator with finite capacity must decide how to allocate that capacity between energy production and reserve provision. This is a multi-product strategic decision. A bilevel model can capture this by having the generator, as the leader, decide on its energy and reserve offers. The lower level represents the ISO's co-optimization of energy and reserve markets to meet system requirements at the minimum bid-in cost. A key insight from this formulation is the concept of *[opportunity cost](@entry_id:146217)*. The clearing price for reserves must not only compensate the generator for its explicit reserve offer but also for the profit it forgoes by not using that capacity to sell energy. This opportunity cost is endogenously determined within the model and is represented by the [shadow price](@entry_id:137037) on the generator's capacity constraint in the lower-level KKT conditions. This integrated view is essential for understanding price formation in modern multi-product electricity markets .

### From Single Leader (MPEC) to Multiple Interacting Leaders (EPEC)

While Mathematical Programs with Equilibrium Constraints (MPECs) are well-suited for modeling a single leader's interaction with a competitive market, real-world [electricity markets](@entry_id:1124241) are typically oligopolies with multiple, interacting strategic firms. When several leaders simultaneously solve their own bilevel problems, and these problems are coupled through a common lower-level problem (the shared market clearing), the resulting structure is known as an Equilibrium Problem with Equilibrium Constraints (EPEC).

In an EPEC, each generator $i$ solves its own profit-maximization problem by choosing its bid $b_i$, anticipating the bids of its rivals $b_{-i}$ and the subsequent market clearing. The Nash equilibrium of this game is a set of bids where no single generator can improve its profit by unilaterally changing its bid. Formally, the EPEC is a collection of MPECs, one for each strategic player, where the lower-level KKT conditions are identical and shared among all players, reflecting the single, centralized market clearing mechanism .

The solution to an EPEC is a Nash equilibrium, which can be interpreted as a fixed point of the players' best-response functions. For each generator, a best-response function maps the rivals' actions to the generator's own profit-maximizing action. In a Cournot-style game where generators choose quantities, each firm's [first-order condition](@entry_id:140702) defines its optimal quantity as a function of its competitors' quantities. The Nash Equilibrium is the set of quantities where all firms are simultaneously playing their [best response](@entry_id:272739) to each other—a fixed point of the system of best-response equations. This provides a powerful framework for analyzing oligopolistic competition in network-constrained markets .

### Applications in System Planning, Market Design, and Policy Analysis

The utility of bilevel and [complementarity formulations](@entry_id:1122718) extends beyond describing agent behavior to serving as a "virtual laboratory" for system planners, market designers, and policymakers.

#### Network Investment and Expansion

Long-term [transmission planning](@entry_id:1133374) requires evaluating the economic and reliability impacts of potential network upgrades. By embedding a DC-OPF market-clearing model within a larger analysis, planners can assess how adding a new transmission line, for example, alters the [market equilibrium](@entry_id:138207). The addition of a line changes the Power Transfer Distribution Factors (PTDFs), which in turn changes how power flows through the network. This can alleviate congestion, reduce the need for expensive local generation, lower overall system costs, and change the spatial pattern of LMPs. Comparing the market outcomes (total generation cost, welfare, LMPs) with and without the investment provides a quantitative basis for the investment decision. The [dual variables](@entry_id:151022) from the lower-level OPF—the LMPs and congestion shadow prices—are fundamental to this evaluation .

#### Incorporating Uncertainty and Risk

Energy systems are fraught with uncertainty, from fluctuating demand and renewable energy output to volatile fuel prices. Bilevel optimization can be integrated with techniques from robust optimization and financial engineering to address these challenges.

In *robust planning*, a system planner (the leader) can make investment decisions, such as setting [transmission capacity](@entry_id:1133361), that are resilient against a range of possible future conditions. The leader's objective becomes minimizing the cost of investment plus the system operating cost under the *worst-case* realization of an uncertain parameter (e.g., demand) within a defined [uncertainty set](@entry_id:634564). This creates a minimax structure, where the leader minimizes its objective against an adversarial "nature" that chooses the worst-case scenario. When the lower-level problem is an LP, this robust bilevel problem can often be reformulated into a tractable single-level problem, allowing planners to design systems that are guaranteed to perform well under a variety of adverse conditions .

From the perspective of a market participant, price uncertainty creates [financial risk](@entry_id:138097). A risk-averse Load-Serving Entity (LSE), for instance, can be modeled as a leader whose objective is not simply to minimize expected procurement cost, but to manage [tail risk](@entry_id:141564). By incorporating risk measures like Conditional Value at Risk (CVaR) into the upper-level objective, the model can capture the LSE's desire to hedge against extremely high-cost scenarios. The LSE chooses a forward contract position (the upper-level decision) to optimize this risk-reward trade-off, anticipating the distribution of spot prices determined by the scenario-dependent market clearing at the lower level. This provides a powerful interdisciplinary connection between [energy economics](@entry_id:1124463) and [financial risk management](@entry_id:138248) .

#### Analyzing Market Rules and Non-Convexities

Real-world [electricity markets](@entry_id:1124241) are governed by complex rules that can introduce non-convexities into the market-clearing problem, moving beyond the simple [linear programming](@entry_id:138188) framework. Bilevel and complementarity models are indispensable for studying the strategic implications of these rules. Market features like price caps, discrete bid increments, and complex bid formats can be explicitly modeled to understand their impact on equilibrium outcomes .

A critical source of non-[convexity](@entry_id:138568) is the "all-or-nothing" nature of certain decisions. This is apparent in **physical non-convexities** such as generator unit commitment. The decisions to turn a thermal generator on or off are binary, and are subject to operational constraints like minimum up and down times. These constraints are modeled using integer variables and linear inequalities, transforming the lower-level market clearing into a Mixed-Integer Linear Program (MILP). A strategic generator's problem thus becomes a Mixed-Integer MPEC, a computationally challenging but highly realistic modeling paradigm .

Similarly, **bidding non-convexities**, such as complex block bids, introduce [combinatorial complexity](@entry_id:747495). A block bid, which links energy across multiple hours, can only be accepted or rejected as a whole. This introduces binary decision variables into the ISO's problem. These non-convexities can lead to market outcomes that appear paradoxical. For instance, a block bid might be rejected by the market operator in the process of minimizing total cost, yet the bid would have been profitable for the bidder at the final clearing prices. This "paradoxically rejected profitable block bid" phenomenon highlights the intricate effects of non-convexities on [market efficiency](@entry_id:143751) and is a key area of study in market design .

### Empirical Applications and Model Calibration

To be practically useful, theoretical models of [strategic interaction](@entry_id:141147) must be grounded in empirical data. Calibrating a bilevel market model requires a rich and diverse set of information. The lower-level DC-OPF model alone necessitates a detailed physical representation of the system, including: generator capacities and their locations on the network; nodal demand profiles; and a network model defined by the PTDF matrix and line thermal limits. The upper-level strategic model requires data to construct generators' true marginal cost functions, which are typically derived from heat-rate curves and contemporaneous fuel prices. Credible data for these parameters must be drawn from authoritative sources such as government agencies (e.g., the U.S. Energy Information Administration), regulatory bodies (e.g., the Federal Energy Regulatory Commission), and the ISOs/RTOs themselves .

However, parameterizing these models from observed market data is not without its challenges. A central issue is *[identifiability](@entry_id:194150)*. From observing market prices and dispatches alone, it can be impossible to separately identify a generator's true marginal cost from its strategic markup. A high observed bid could be the result of a high true cost or a large strategic markup, and both explanations may be consistent with the data. This confounding can sometimes be resolved if there is an exogenous variable, such as a volatile fuel price, that shifts the true cost curve in a way that is uncorrelated with strategic intent. Furthermore, if multiple generators are physically identical or submit identical bids, the market-clearing dispatch may not be unique, leading to degeneracy. This creates observational equivalence, where the same underlying parameters could lead to multiple different observed outcomes, further complicating the task of model calibration and inference .

In conclusion, the frameworks of [bilevel optimization](@entry_id:637138) and equilibrium modeling with equilibrium constraints provide a unifying and rigorous language for analyzing a vast range of critical issues in modern energy systems. From the fine-grained strategic decisions of individual firms to the system-wide implications of market rules and long-term investment policies, these tools empower us to understand, predict, and ultimately improve the functioning of [electricity markets](@entry_id:1124241) in an increasingly complex and uncertain world.