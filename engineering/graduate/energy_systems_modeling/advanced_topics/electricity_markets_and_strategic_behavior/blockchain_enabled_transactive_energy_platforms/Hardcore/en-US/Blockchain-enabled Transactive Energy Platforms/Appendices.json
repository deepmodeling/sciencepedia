{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing a transactive energy market is to understand its core clearing mechanism. This practice establishes this foundation by having you calculate the equilibrium point where aggregate supply meets aggregate demand . By working through a hypothetical scenario with several prosumers and consumers, you will determine the single clearing price and total traded quantity, mastering a fundamental skill essential for evaluating any peer-to-peer market design.",
            "id": "4072829",
            "problem": "A distributed energy resource (DER) microgrid operates a blockchain-enabled transactive energy platform in a single settlement interval of duration $1$ hour. The platform uses a smart contract (SC) deployed on a Distributed Ledger Technology (DLT) to clear a continuous double auction among prosumers and consumers. Under the single-bus, lossless network assumption, the Locational Marginal Price (LMP) is uniform across all participants, and Kirchhoff’s current law implies a power balance constraint equating aggregate supply and aggregate demand at the clearing price. The SC enforces that bids are monotone supply and demand schedules and executes a welfare-maximizing uniform-price clearing subject to non-negativity of traded quantities.\n\nThere are $3$ prosumers with supply schedules $S_1(p)=2p$, $S_2(p)=p+1$, $S_3(p)=3$, representing the offered energy in $\\text{MWh}$ as a function of the uniform price $p$ in $\\$/\\text{MWh}$. There are $2$ consumers with demand schedules $D_1(p)=5-2p$ and $D_2(p)=4-p$, representing the requested energy in $\\text{MWh}$ as a function of the same uniform price $p$.\n\nAssume: (i) no network losses, (ii) no transaction or settlement fees on-chain, (iii) $p \\ge 0$, and (iv) the SC clears at the unique price $p^{\\ast}$ where total supply equals total demand and all individual quantities implied by $p^{\\ast}$ are non-negative.\n\nStarting from the energy balance principle and the monotonicity of the schedules, derive the clearing price $p^{\\ast}$ and the total traded quantity $Q^{\\ast}$ in closed form. Provide exact values with no rounding. Express the clearing price in $\\$/\\text{MWh}$ and the total traded quantity in $\\text{MWh}$.",
            "solution": "The problem is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Settlement interval duration: $1$ hour.\n- Platform: Blockchain-enabled transactive energy platform using a smart contract (SC) on a Distributed Ledger Technology (DLT).\n- Auction mechanism: Continuous double auction, cleared at a uniform price.\n- Network model: Single-bus, lossless.\n- Pricing model: Uniform Locational Marginal Price (LMP), denoted by $p$ in units of $\\$/\\text{MWh}$.\n- Governing principle: Power balance constraint (from Kirchhoff’s current law), aggregate supply equals aggregate demand.\n- Prosumer supply schedules (energy in $\\text{MWh}$):\n  - $S_1(p) = 2p$\n  - $S_2(p) = p+1$\n  - $S_3(p) = 3$\n- Consumer demand schedules (energy in $\\text{MWh}$):\n  - $D_1(p) = 5-2p$\n  - $D_2(p) = 4-p$\n- Assumptions:\n  - (i) no network losses.\n  - (ii) no transaction or settlement fees.\n  - (iii) price is non-negative, $p \\ge 0$.\n  - (iv) the SC clears at a unique price $p^{\\ast}$ where total supply equals total demand, and all individual traded quantities are non-negative.\n- Objective: Derive the clearing price $p^{\\ast}$ and total traded quantity $Q^{\\ast}$ in closed form.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, drawing upon established principles from microeconomics (supply-demand equilibrium, market clearing) and electrical engineering (power system modeling). The concept of a transactive energy market implemented on a blockchain is a current area of research in energy systems, and the model presented, although simplified (e.g., lossless, single-bus), is a standard approach for analyzing such systems at a fundamental level. The problem is well-posed; it provides all necessary mathematical functions and constraints to determine a unique solution. The given supply and demand schedules are linear, which typically leads to a unique market clearing point. The problem is stated objectively and uses precise terminology. It is free from scientific flaws, contradictions, or ambiguities. All assumptions are clearly listed. The non-negativity of traded quantities at the clearing price is a required condition to be verified but does not render the problem ill-posed.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\nThe core principle for clearing the market is that of market equilibrium, where the total quantity of energy supplied by the prosumers equals the total quantity of energy demanded by the consumers. This equilibrium point determines the uniform clearing price, $p^{\\ast}$, and the total traded quantity, $Q^{\\ast}$. The problem states that this is enforced by the smart contract under a power balance constraint.\n\nFirst, we determine the aggregate supply schedule, $S_{agg}(p)$, by summing the individual supply schedules of the $3$ prosumers:\n$$S_{agg}(p) = S_1(p) + S_2(p) + S_3(p)$$\nSubstituting the given functions:\n$$S_{agg}(p) = (2p) + (p+1) + 3$$\n$$S_{agg}(p) = 3p + 4$$\nThis aggregate supply function is valid for $p \\ge 0$.\n\nNext, we determine the aggregate demand schedule, $D_{agg}(p)$, by summing the individual demand schedules of the $2$ consumers:\n$$D_{agg}(p) = D_1(p) + D_2(p)$$\nSubstituting the given functions:\n$$D_{agg}(p) = (5-2p) + (4-p)$$\n$$D_{agg}(p) = 9 - 3p$$\nThis aggregate demand function is valid for prices where individual demands are non-negative. $D_1(p) \\ge 0$ implies $5-2p \\ge 0$, or $p \\le 2.5$. $D_2(p) \\ge 0$ implies $4-p \\ge 0$, or $p \\le 4$. Therefore, for both demands to be non-negative, the price must satisfy $p \\le 2.5$.\n\nThe market clears at the price $p^{\\ast}$ where aggregate supply equals aggregate demand:\n$$S_{agg}(p^{\\ast}) = D_{agg}(p^{\\ast})$$\nSubstituting the derived aggregate functions:\n$$3p^{\\ast} + 4 = 9 - 3p^{\\ast}$$\nTo solve for $p^{\\ast}$, we rearrange the equation:\n$$3p^{\\ast} + 3p^{\\ast} = 9 - 4$$\n$$6p^{\\ast} = 5$$\n$$p^{\\ast} = \\frac{5}{6}$$\n\nWe must now verify that this clearing price is consistent with the problem's assumptions.\n1.  The price is non-negative: $p^{\\ast} = \\frac{5}{6} \\ge 0$. This condition is met.\n2.  All individual traded quantities are non-negative. We check this for each participant at $p^{\\ast} = \\frac{5}{6}$:\n- $S_1(\\frac{5}{6}) = 2 \\left( \\frac{5}{6} \\right) = \\frac{10}{6} = \\frac{5}{3} \\ge 0$.\n- $S_2(\\frac{5}{6}) = \\frac{5}{6} + 1 = \\frac{11}{6} \\ge 0$.\n- $S_3(\\frac{5}{6}) = 3 \\ge 0$.\n- $D_1(\\frac{5}{6}) = 5 - 2 \\left( \\frac{5}{6} \\right) = 5 - \\frac{10}{6} = 5 - \\frac{5}{3} = \\frac{15-5}{3} = \\frac{10}{3} \\ge 0$.\n- $D_2(\\frac{5}{6}) = 4 - \\frac{5}{6} = \\frac{24-5}{6} = \\frac{19}{6} \\ge 0$.\nAll individual quantities are non-negative, and the price is within the valid domain for the demand functions ($p^{\\ast} = \\frac{5}{6} \\approx 0.833$, which is less than $2.5$). All conditions are satisfied. The unique clearing price is $p^{\\ast} = \\frac{5}{6} \\text{ \\$/MWh}$.\n\nFinally, we calculate the total traded quantity, $Q^{\\ast}$, by substituting $p^{\\ast}$ into either the aggregate supply or aggregate demand function.\nUsing the aggregate supply function:\n$$Q^{\\ast} = S_{agg}(p^{\\ast}) = 3p^{\\ast} + 4 = 3 \\left( \\frac{5}{6} \\right) + 4 = \\frac{15}{6} + 4 = \\frac{5}{2} + 4 = \\frac{5}{2} + \\frac{8}{2} = \\frac{13}{2}$$\nTo verify, we use the aggregate demand function:\n$$Q^{\\ast} = D_{agg}(p^{\\ast}) = 9 - 3p^{\\ast} = 9 - 3 \\left( \\frac{5}{6} \\right) = 9 - \\frac{15}{6} = 9 - \\frac{5}{2} = \\frac{18}{2} - \\frac{5}{2} = \\frac{13}{2}$$\nBoth calculations yield the same result. The total cleared quantity is $Q^{\\ast} = \\frac{13}{2} \\text{ MWh}$.\n\nThe clearing price is $p^{\\ast} = \\frac{5}{6}$ and the total traded quantity is $Q^{\\ast} = \\frac{13}{2}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{6}  \\frac{13}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the concept of equilibrium, we can approach market clearing from a more formal and powerful perspective: social welfare maximization. This exercise challenges you to model the market as a constrained optimization problem and derive its Karush-Kuhn-Tucker (KKT) conditions . In doing so, you will uncover the profound economic principle that the market clearing price is equivalent to the Lagrange multiplier on the energy balance constraint, revealing its role as the system's shadow price.",
            "id": "4072842",
            "problem": "A single-period, single-node Transactive Energy (TE) market is implemented on a blockchain-based settlement layer using smart contracts. The platform clears trades between an aggregate buyer and an aggregate seller. The aggregate buyer has a strictly concave utility function $U(d)$ in the cleared demand $d \\geq 0$, and the aggregate seller has a strictly convex cost function $C(s)$ in the cleared supply $s \\geq 0$. Settlement on the blockchain requires a per-unit protocol fee $\\phi \\geq 0$ for each unit of energy traded, which is consumed by the settlement layer (that is, it is not redistributed to market participants) and therefore reduces total social welfare.\n\nAssume the aggregate utility and cost are quadratic:\n$$U(d) = \\alpha d - \\frac{\\beta}{2} d^{2}, \\quad \\alpha  0, \\ \\beta  0,$$\n$$C(s) = \\gamma s + \\frac{\\delta}{2} s^{2}, \\quad \\gamma \\geq 0, \\ \\delta  0.$$\n\nThe platform clears the market by maximizing total social welfare net of the blockchain settlement fee, subject to energy balance and nonnegativity of decisions:\n$$\\max_{s,d} \\; \\left[ U(d) - C(s) - \\phi s \\right] \\quad \\text{subject to} \\quad s - d = 0, \\ s \\geq 0, \\ d \\geq 0.$$\n\nStarting from the definitions of convexity and concavity, the interpretation of marginal utility and marginal cost, and the first-order optimality framework from constrained optimization, derive the Karush–Kuhn–Tucker (KKT) conditions for this market-clearing problem. Interpret the Lagrange multiplier associated with the energy balance constraint as a market price signal implemented on-chain by the smart contract, and justify this interpretation from the KKT stationarity relations.\n\nAssume parameters satisfy $\\alpha - \\gamma - \\phi  0$, so that the socially optimal solution has strictly positive trade. Under this interior-solution regime, solve the KKT system to obtain a closed-form expression for the blockchain-clearing price $\\lambda^{\\star}$ as a function of $(\\alpha,\\beta,\\gamma,\\delta,\\phi)$. Provide the final answer as a single analytic expression for $\\lambda^{\\star}$ with no numerical evaluation. The economic unit of $\\lambda^{\\star}$ is currency per kilowatt-hour, but you should provide only the symbolic expression; no rounding is required and no units should be attached to the final expression.",
            "solution": "The user provides a well-posed problem from the domain of energy systems modeling and microeconomic theory. All components required for a rigorous mathematical solution are present, and the problem is scientifically and mathematically sound.\n\nThe problem is to find the market-clearing price in a single-node transactive energy market by solving a social welfare maximization problem. The optimization problem is stated as:\n$$\n\\max_{s,d} \\; W(s,d) = U(d) - C(s) - \\phi s\n$$\nsubject to the constraints:\n$$\ns - d = 0 \\\\\ns \\geq 0 \\\\\nd \\geq 0\n$$\nwhere the utility and cost functions are given by:\n$$\nU(d) = \\alpha d - \\frac{\\beta}{2} d^{2}, \\quad \\alpha  0, \\ \\beta  0\n$$\n$$\nC(s) = \\gamma s + \\frac{\\delta}{2} s^{2}, \\quad \\gamma \\geq 0, \\ \\delta  0\n$$\nThe term $\\phi \\geq 0$ is a per-unit transaction fee. The objective function $W(s,d)$ represents the total social welfare, which is the buyer's utility minus the seller's production cost and the settlement fee. Since $U(d)$ is strictly concave (its second derivative $U''(d) = -\\beta  0$) and $-C(s)$ is strictly concave (its second derivative $-C''(s) = -\\delta  0$), the objective function $W(s,d)$ is strictly concave in $(s,d)$. The constraints define a convex set. This is a convex optimization problem, which guarantees a unique solution.\n\nTo derive the Karush–Kuhn–Tucker (KKT) conditions, we first construct the Lagrangian function. To align the Lagrange multiplier with the economic interpretation of price, we will write the energy balance constraint as $d - s = 0$. We associate the Lagrange multiplier $\\lambda$ with this equality constraint, and the multipliers $\\mu_s$ and $\\mu_d$ with the nonnegativity constraints $-s \\leq 0$ and $-d \\leq 0$, respectively.\n\nThe Lagrangian $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(s, d, \\lambda, \\mu_s, \\mu_d) = U(d) - C(s) - \\phi s - \\lambda(d-s) - \\mu_s(-s) - \\mu_d(-d)\n$$\nSubstituting the given functions:\n$$\n\\mathcal{L}(s, d, \\lambda, \\mu_s, \\mu_d) = \\left(\\alpha d - \\frac{\\beta}{2} d^{2}\\right) - \\left(\\gamma s + \\frac{\\delta}{2} s^{2}\\right) - \\phi s - \\lambda(d-s) + \\mu_s s + \\mu_d d\n$$\n\nThe KKT conditions are composed of stationarity, primal feasibility, dual feasibility, and complementary slackness.\n\n1.  **Stationarity**: The partial derivatives of the Lagrangian with respect to the decision variables $s$ and $d$ must be zero at the optimal point $(s^{\\star}, d^{\\star})$.\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial s} = - \\frac{dC(s^{\\star})}{ds} - \\phi + \\lambda + \\mu_s = -(\\gamma + \\delta s^{\\star}) - \\phi + \\lambda + \\mu_s = 0\n    $$\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial d} = \\frac{dU(d^{\\star})}{dd} - \\lambda + \\mu_d = (\\alpha - \\beta d^{\\star}) - \\lambda + \\mu_d = 0\n    $$\n\n2.  **Primal Feasibility**: The optimal solution must satisfy all constraints.\n    $$\n    d^{\\star} - s^{\\star} = 0\n    $$\n    $$\n    s^{\\star} \\geq 0\n    $$\n    $$\n    d^{\\star} \\geq 0\n    $$\n\n3.  **Dual Feasibility**: The Lagrange multipliers for the inequality constraints must be non-negative.\n    $$\n    \\mu_s \\geq 0\n    $$\n    $$\n    \\mu_d \\geq 0\n    $$\n\n4.  **Complementary Slackness**: The product of each inequality-constraint multiplier and its corresponding slack must be zero.\n    $$\n    \\mu_s s^{\\star} = 0\n    $$\n    $$\n    \\mu_d d^{\\star} = 0\n    $$\n\nNow, we interpret the Lagrange multiplier $\\lambda$. The term $\\frac{dU}{dd} = U'(d)$ is the marginal utility, representing the buyer's willingness to pay for an additional unit of energy. The term $\\frac{dC}{ds} = C'(s)$ is the marginal cost, representing the seller's minimum acceptable price to produce an additional unit.\n\nThe stationarity conditions can be rewritten as:\n$$\n\\lambda + \\mu_s = C'(s^{\\star}) + \\phi = \\gamma + \\delta s^{\\star} + \\phi\n$$\n$$\n\\lambda - \\mu_d = U'(d^{\\star}) = \\alpha - \\beta d^{\\star}\n$$\nThe problem specifies that we operate in an interior-solution regime where trade is strictly positive, i.e., $s^{\\star}  0$ and $d^{\\star}  0$. From the complementary slackness conditions, if $s^{\\star}  0$, then $\\mu_s$ must be $0$. If $d^{\\star}  0$, then $\\mu_d$ must be $0$. The assumption that $\\alpha - \\gamma - \\phi  0$ ensures this regime, as a zero-trade solution would yield zero welfare, while any positive trade $q0$ near zero yields welfare of approximately $(\\alpha - \\gamma - \\phi)q  0$.\n\nUnder this interior solution assumption ($\\mu_s=0, \\mu_d=0$), the stationarity relations simplify to:\n$$\n\\lambda^{\\star} = C'(s^{\\star}) + \\phi\n$$\n$$\n\\lambda^{\\star} = U'(d^{\\star})\n$$\nThis provides a clear economic interpretation for $\\lambda^{\\star}$. It is the price at which the marginal utility of the buyer equals the marginal cost of the seller, including the transaction fee. The smart contract, by solving this optimization, determines a uniform clearing price $\\lambda^{\\star}$ that balances supply and demand. The buyer consumes until their marginal benefit $U'(d^{\\star})$ drops to the price $\\lambda^{\\star}$. The seller produces until their effective marginal cost $C'(s^{\\star}) + \\phi$ rises to the price $\\lambda^{\\star}$. This justifies interpreting $\\lambda^{\\star}$ as the blockchain-clearing price.\n\nFinally, we solve for $\\lambda^{\\star}$ using this simplified system of equations. Let the cleared quantity be $q^{\\star} = s^{\\star} = d^{\\star}$, as per the energy balance constraint.\n\nFrom the first simplified stationarity equation:\n$$\n\\lambda^{\\star} = \\alpha - \\beta d^{\\star} \\implies \\beta d^{\\star} = \\alpha - \\lambda^{\\star} \\implies d^{\\star} = \\frac{\\alpha - \\lambda^{\\star}}{\\beta}\n$$\n\nFrom the second simplified stationarity equation:\n$$\n\\lambda^{\\star} = \\gamma + \\delta s^{\\star} + \\phi \\implies \\delta s^{\\star} = \\lambda^{\\star} - \\gamma - \\phi \\implies s^{\\star} = \\frac{\\lambda^{\\star} - \\gamma - \\phi}{\\delta}\n$$\n\nSince $d^{\\star} = s^{\\star}$, we can equate the expressions for them:\n$$\n\\frac{\\alpha - \\lambda^{\\star}}{\\beta} = \\frac{\\lambda^{\\star} - \\gamma - \\phi}{\\delta}\n$$\n\nWe now solve this linear equation for $\\lambda^{\\star}$:\n$$\n\\delta(\\alpha - \\lambda^{\\star}) = \\beta(\\lambda^{\\star} - \\gamma - \\phi)\n$$\n$$\n\\alpha\\delta - \\delta\\lambda^{\\star} = \\beta\\lambda^{\\star} - \\beta\\gamma - \\beta\\phi\n$$\nCollect all terms involving $\\lambda^{\\star}$ on one side:\n$$\n\\alpha\\delta + \\beta\\gamma + \\beta\\phi = \\beta\\lambda^{\\star} + \\delta\\lambda^{\\star}\n$$\n$$\n\\alpha\\delta + \\beta(\\gamma + \\phi) = (\\beta + \\delta)\\lambda^{\\star}\n$$\nIsolating $\\lambda^{\\star}$ gives the closed-form expression for the clearing price:\n$$\n\\lambda^{\\star} = \\frac{\\alpha\\delta + \\beta\\gamma + \\beta\\phi}{\\beta + \\delta}\n$$\nThis expression is the socially optimal clearing price under the given quadratic utility/cost structure and a per-unit transaction fee.",
            "answer": "$$\n\\boxed{\\frac{\\alpha\\delta + \\beta\\gamma + \\beta\\phi}{\\beta + \\delta}}\n$$"
        },
        {
            "introduction": "A critical challenge in deploying transactive energy platforms on public blockchains is balancing transparency with the privacy of participants' bids. This practice delves into a state-of-the-art solution using Zero-Knowledge Succinct Non-Interactive Arguments of Knowledge (zk-SNARKs) to prove correct clearing without revealing sensitive data . You will conduct a detailed cost analysis of the on-chain gas consumption for such a system, providing a quantitative understanding of the engineering and economic trade-offs involved in implementing advanced cryptographic protocols on platforms like Ethereum.",
            "id": "4072833",
            "problem": "Consider a blockchain-enabled transactive energy platform that clears a double-sided market among prosumers and consumers. Let there be $N$ bids, with each bid $i$ characterized by a quantity $q_i$ and a price $p_i$. The platform computes a clearing price $\\lambda$ and an acceptance decision $x_i \\in \\{0,1\\}$ for each bid, such that the energy balance and merit-order conditions hold (accepted quantities sum to the cleared demand and accepted bids are at or below the clearing price). To preserve privacy while ensuring correctness, the platform submits on-chain a Zero-Knowledge Succinct Non-Interactive Argument of Knowledge (zk-SNARK) that proves the correctness of the clearing with respect to committed off-chain data.\n\nAssume the on-chain verification uses the Ethereum Virtual Machine (EVM) precompiles for pairing-based verification and that the following modeling assumptions hold:\n- The transaction fee model is defined by the rule that the fee paid in wei is the product of the total gas consumed and the gas price. Let the gas price be $\\gamma = 2.0 \\times 10^{10}$ wei per gas (that is, $20$ gwei).\n- The base transaction cost is $g_{\\mathrm{tx}} = 21{,}000$ gas.\n- Calldata incurs a cost of $g_{\\mathrm{byte}} = 16$ gas per non-zero byte.\n- The zk-SNARK is of the Groth16 type and its on-chain verification complexity is modeled as a fixed-base pairing component plus a linear term in the number of public inputs. Specifically, the verification gas for the pairing component is $g_{\\mathrm{pair,base}} = 45{,}000$ gas plus $P \\cdot g_{\\mathrm{pair}}$ gas, where $P = 3$ is the number of pairings and $g_{\\mathrm{pair}} = 80{,}000$ gas per pairing.\n- The per-public-input verification overhead is $g_{\\mathrm{pi}} = 12{,}000$ gas per input.\n- The public inputs to the verifier consist of the clearing price $\\lambda$, the total cleared energy $\\sum_{i=1}^{N} x_i q_i$, a Merkle root committing to all bids, and the acceptance indicator for each bid, so the total number of public inputs is $n_{\\mathrm{pi}} = N + 3$.\n- Each public input is encoded as $32$ bytes in calldata, and the zk-SNARK proof itself has size $S = 192$ bytes.\n- The block gas limit is $G_{\\max} = 3.0 \\times 10^{7}$ gas, which must not be exceeded by a single transaction.\n\nUsing only the above assumptions and the fundamental rule that transaction cost equals gas used times gas price, compute the total on-chain overhead in wei to submit and verify the proof for $N = 500$ bids. Your calculation must account for (i) base transaction gas, (ii) verification gas (pairing component plus per-public-input component), and (iii) calldata gas for both the proof and public inputs. Confirm feasibility under the block gas limit before computing the cost. Express the final answer in wei and round your answer to four significant figures.",
            "solution": "The problem asks for the computation of the total on-chain cost in wei for submitting and verifying a zk-SNARK proof for a transactive energy market clearing involving $N=500$ bids. Before computing the cost, the feasibility of the transaction must be confirmed against the block gas limit. The problem statement provides a detailed model for the gas consumption of the required on-chain operations.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- Number of bids: $N$\n- Gas price: $\\gamma = 2.0 \\times 10^{10}$ wei per gas\n- Base transaction cost: $g_{\\mathrm{tx}} = 21{,}000$ gas\n- Calldata gas cost: $g_{\\mathrm{byte}} = 16$ gas per non-zero byte\n- Base pairing verification gas: $g_{\\mathrm{pair,base}} = 45{,}000$ gas\n- Number of pairings: $P = 3$\n- Gas per pairing: $g_{\\mathrm{pair}} = 80{,}000$ gas\n- Gas per public input: $g_{\\mathrm{pi}} = 12{,}000$ gas\n- Total number of public inputs: $n_{\\mathrm{pi}} = N + 3$\n- Size of each public input in calldata: $32$ bytes\n- Size of the zk-SNARK proof: $S = 192$ bytes\n- Block gas limit: $G_{\\max} = 3.0 \\times 10^{7}$ gas\n- Specific number of bids for calculation: $N = 500$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a realistic application of blockchain technology and zero-knowledge proofs (zk-SNARKs) to energy systems. The gas cost model is a correct, albeit simplified, representation of the Ethereum Virtual Machine (EVM) fee structure. The given values for gas costs are plausible and consistent with typical EVM parameters. The problem is well-posed, providing all necessary data for a unique solution. The language is objective and formal. The problem statement does not violate any of the invalidity criteria. It is complete, consistent, realistic, and constitutes a non-trivial but solvable problem in the specified domain.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with a full solution.\n\nThe total on-chain cost is the product of the total gas consumed, $G_{\\mathrm{total}}$, and the gas price, $\\gamma$. The total gas is the sum of three components: the base transaction gas ($G_{\\mathrm{tx}}$), the verification gas ($G_{\\mathrm{verify}}$), and the calldata gas ($G_{\\mathrm{calldata}}$).\n\n$$ G_{\\mathrm{total}} = G_{\\mathrm{tx}} + G_{\\mathrm{verify}} + G_{\\mathrm{calldata}} $$\n\nI will now formulate and calculate each component.\n\n1.  **Base Transaction Gas ($G_{\\mathrm{tx}}$)**\n    This is a fixed cost for any transaction.\n    $$ G_{\\mathrm{tx}} = g_{\\mathrm{tx}} = 21{,}000 \\text{ gas} $$\n\n2.  **Verification Gas ($G_{\\mathrm{verify}}$)**\n    This cost is for executing the zk-SNARK verifier smart contract. It has two parts: the pairing component and the public input component.\n    \n    The pairing component cost, $G_{\\mathrm{pair}}$, is given by:\n    $$ G_{\\mathrm{pair}} = g_{\\mathrm{pair,base}} + P \\cdot g_{\\mathrm{pair}} $$\n    Substituting the given values:\n    $$ G_{\\mathrm{pair}} = 45{,}000 + 3 \\cdot 80{,}000 = 45{,}000 + 240{,}000 = 285{,}000 \\text{ gas} $$\n    \n    The public input component cost, $G_{\\mathrm{pi}}$, depends on the number of public inputs, $n_{\\mathrm{pi}}$.\n    $$ G_{\\mathrm{pi}} = n_{\\mathrm{pi}} \\cdot g_{\\mathrm{pi}} $$\n    For $N$ bids, the number of public inputs is $n_{\\mathrm{pi}} = N + 3$. For the specified case of $N=500$:\n    $$ n_{\\mathrm{pi}} = 500 + 3 = 503 $$\n    Therefore, the cost for the public inputs is:\n    $$ G_{\\mathrm{pi}} = 503 \\cdot 12{,}000 = 6{,}036{,}000 \\text{ gas} $$\n    \n    The total verification gas is the sum of these two parts:\n    $$ G_{\\mathrm{verify}} = G_{\\mathrm{pair}} + G_{\\mathrm{pi}} = 285{,}000 + 6{,}036{,}000 = 6{,}321{,}000 \\text{ gas} $$\n\n3.  **Calldata Gas ($G_{\\mathrm{calldata}}$)**\n    This is the cost for storing the proof and public inputs as part of the transaction data. It also has two parts: the proof data and the public input data.\n    \n    The cost for the proof data, $G_{\\mathrm{proof,data}}$, is:\n    $$ G_{\\mathrm{proof,data}} = S \\cdot g_{\\mathrm{byte}} = 192 \\cdot 16 = 3{,}072 \\text{ gas} $$\n    \n    The cost for the public input data, $G_{\\mathrm{pi,data}}$, depends on the total byte size of all public inputs. Each of the $n_{\\mathrm{pi}}$ inputs is $32$ bytes.\n    $$ G_{\\mathrm{pi,data}} = n_{\\mathrm{pi}} \\cdot 32 \\cdot g_{\\mathrm{byte}} $$\n    Using $n_{\\mathrm{pi}} = 503$:\n    $$ G_{\\mathrm{pi,data}} = 503 \\cdot 32 \\cdot 16 = 257{,}536 \\text{ gas} $$\n    \n    The total calldata gas is the sum of these two parts:\n    $$ G_{\\mathrm{calldata}} = G_{\\mathrm{proof,data}} + G_{\\mathrm{pi,data}} = 3{,}072 + 257{,}536 = 260{,}608 \\text{ gas} $$\n\nNow, I will sum all components to find the total gas consumed.\n$$ G_{\\mathrm{total}} = G_{\\mathrm{tx}} + G_{\\mathrm{verify}} + G_{\\mathrm{calldata}} $$\n$$ G_{\\mathrm{total}} = 21{,}000 + 6{,}321{,}000 + 260{,}608 = 6{,}602{,}608 \\text{ gas} $$\n\nNext, I must confirm the feasibility of this transaction by comparing the total gas cost against the block gas limit, $G_{\\max}$.\n$$ G_{\\max} = 3.0 \\times 10^{7} = 30{,}000{,}000 \\text{ gas} $$\nSince $G_{\\mathrm{total}} = 6{,}602{,}608$ gas is less than $G_{\\max} = 30{,}000{,}000$ gas, the transaction is feasible and would fit within a single Ethereum block.\n\nFinally, I will compute the total on-chain overhead in wei. The cost, $C$, is given by the product of the total gas and the gas price.\n$$ C = G_{\\mathrm{total}} \\cdot \\gamma $$\nSubstituting the values:\n$$ C = 6{,}602{,}608 \\cdot (2.0 \\times 10^{10}) \\text{ wei} $$\n$$ C = 13{,}205{,}216 \\times 10^{10} \\text{ wei} $$\n$$ C = 1.3205216 \\times 10^{17} \\text{ wei} $$\n\nThe problem requires the answer to be rounded to four significant figures. The fifth significant digit is $5$, so we round up the fourth digit.\n$$ C \\approx 1.321 \\times 10^{17} \\text{ wei} $$\nThis is the final computed on-chain overhead.",
            "answer": "$$ \\boxed{1.321 \\times 10^{17}} $$"
        }
    ]
}