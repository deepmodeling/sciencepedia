{
    "hands_on_practices": [
        {
            "introduction": "To accurately stress-test a power system, we must first build robust models of how its individual components respond to climate stressors. This practice takes you back to first principles, focusing on a photovoltaic (PV) array during a heatwave. By deriving the relationship between ambient temperature, solar irradiance, and power output, you will gain a fundamental understanding of how temperature-induced derating physically manifests in renewable generation resources .",
            "id": "4077987",
            "problem": "A utility-scale photovoltaic (PV) array is being assessed under a heatwave stress-test scenario for a transmission-connected power system. The objective is to derive a physically grounded expression for the array’s electrical power as a function of irradiance and temperature, and then compute the expected output during the stress event.\n\nAssume the following foundational elements:\n\n- Under Standard Test Conditions (STC), defined as cell temperature $T_{STC} = 298\\ \\mathrm{K}$ and plane-of-array irradiance $G_{STC} = 1000\\ \\mathrm{W/m^2}$, the array’s electrical power is $P_{STC} = 4.5\\ \\mathrm{kW}$.\n- The array’s electrical power response to cell temperature $T_c$ can be approximated by a first-order linearization about $T_{STC}$ with a known temperature coefficient $\\gamma$ (units $\\mathrm{K^{-1}}$), where increasing $T_c$ reduces power when $\\gamma  0$.\n- The module cell temperature $T_c$ is governed by an energy balance between absorbed solar power and convective heat loss to ambient air, represented by a widely used steady-state thermal model parameterized by heat transfer coefficients.\n\nStarting only from these elements, and without invoking any shortcut formulas, do the following:\n\n1. Derive an expression for the PV array electrical power $P$ as a function of irradiance $G$, ambient air temperature $T_a$, and wind speed $v$, in terms of $P_{STC}$, $G_{STC}$, $T_{STC}$, $\\gamma$, the module electrical efficiency $\\eta$, and heat transfer coefficients $U_0$ and $U_1$. Your derivation must proceed from a heat balance at the module and a first-order approximation for electrical power around $T_{STC}$.\n2. Using your derived expression, compute the array power during the heatwave scenario with parameters: ambient air temperature $T_a = 310\\ \\mathrm{K}$, wind speed $v = 0.5\\ \\mathrm{m/s}$, irradiance $G = 950\\ \\mathrm{W/m^2}$, temperature coefficient $\\gamma = -0.004\\ \\mathrm{K^{-1}}$, module efficiency $\\eta = 0.18$, and thermal coefficients $U_0 = 20\\ \\mathrm{W/(m^2\\cdot K)}$ and $U_1 = 6\\ \\mathrm{W/(m^2\\cdot K)}$.\n3. Briefly discuss physically reasonable choices for $\\gamma$, $\\eta$, $U_0$, and $U_1$ in the context of climate risk stress testing, including how their values influence sensitivity of $P$ to heatwaves.\n\nRound your final numerical answer for $P$ to four significant figures. Express the final power in $\\mathrm{kW}$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is based on established first principles of photovoltaic device physics and heat transfer. Thus, the problem is deemed valid.\n\nThe solution is structured in three parts as requested: derivation of the power expression, numerical calculation for a specific scenario, and a physical discussion of the model parameters.\n\n### Part 1: Derivation of the PV Array Electrical Power Expression\n\nThe derivation proceeds from two foundational models: an electrical model for power output and a thermal model for the cell temperature.\n\n**1. Electrical Power Model**\nThe electrical power output, $P$, of a photovoltaic (PV) array is primarily proportional to the incident plane-of-array solar irradiance, $G$. Under standard test conditions (STC), the power is $P_{STC}$ at an irradiance of $G_{STC}$ and a cell temperature of $T_{STC}$. If the cell temperature were held constant at $T_{STC}$, the power at a different irradiance $G$ would be given by this proportionality:\n$$ P'(G) = P_{STC} \\frac{G}{G_{STC}} $$\nHowever, the electrical performance of PV cells degrades as their temperature increases. The problem specifies that this dependence can be modeled as a first-order linearization around the reference temperature $T_{STC}$. This is expressed using a temperature coefficient of power, $\\gamma$, which has units of $\\mathrm{K^{-1}}$ and is typically negative. The power $P$ at a cell temperature $T_c$ and irradiance $G$ is thus:\n$$ P(G, T_c) = P'(G) \\left[ 1 + \\gamma (T_c - T_{STC}) \\right] $$\nSubstituting the expression for $P'(G)$ gives the power as a function of irradiance and cell temperature:\n$$ P(G, T_c) = P_{STC} \\frac{G}{G_{STC}} \\left[ 1 + \\gamma (T_c - T_{STC}) \\right] $$\nThis equation is not yet in its final form, as it depends on the internal variable $T_c$. The next step is to express $T_c$ in terms of external, ambient conditions.\n\n**2. Thermal Model for Cell Temperature ($T_c$)**\nThe cell temperature $T_c$ is determined by a steady-state energy balance. In steady state, the thermal energy generated within the module equals the heat dissipated to the surrounding environment.\n\n*   **Heat Generation ($Q_{gen}$):** Incident solar radiation on a module of area $A$ provides power equal to $G \\cdot A$. A fraction of this power, described by the module's electrical efficiency $\\eta$, is converted into electrical energy, $P_{elec} = \\eta G A$. The remainder of the incident energy is converted into thermal energy that must be dissipated. Therefore, the rate of heat generation is:\n    $$ Q_{gen} = G A - P_{elec} = G A - \\eta G A = G A (1 - \\eta) $$\n*   **Heat Dissipation ($Q_{loss}$):** Heat is lost from the module surface to the ambient air (at temperature $T_a$) via convection and radiation. This process is modeled using Newton's law of cooling, where the rate of heat loss is proportional to the temperature difference between the cell and the ambient air, $(T_c - T_a)$, and a total heat transfer coefficient, $U_L$.\n    $$ Q_{loss} = U_L A (T_c - T_a) $$\n    The problem specifies that $U_L$ is a linear function of wind speed, $v$, parameterized by coefficients $U_0$ (representing wind-independent heat transfer like radiation and natural convection) and $U_1$ (representing forced convection):\n    $$ U_L = U_0 + U_1 v $$\n    Substituting this into the heat loss equation gives:\n    $$ Q_{loss} = (U_0 + U_1 v) A (T_c - T_a) $$\n\n*   **Steady-State Energy Balance:** By equating heat generation and heat loss ($Q_{gen} = Q_{loss}$):\n    $$ G A (1 - \\eta) = (U_0 + U_1 v) A (T_c - T_a) $$\n    The module area, $A$, which was not given, conveniently cancels from both sides of the equation. We can now solve for the cell temperature, $T_c$:\n    $$ G (1 - \\eta) = (U_0 + U_1 v) (T_c - T_a) $$\n    $$ T_c - T_a = \\frac{G(1 - \\eta)}{U_0 + U_1 v} $$\n    $$ T_c = T_a + \\frac{G(1 - \\eta)}{U_0 + U_1 v} $$\n\n**3. Final Power Expression**\nFinally, we substitute the derived expression for $T_c$ into the electrical power model to obtain the PV power $P$ as a function of the independent variables $G$, $T_a$, and $v$:\n$$ P(G, T_a, v) = P_{STC} \\frac{G}{G_{STC}} \\left[ 1 + \\gamma \\left( \\left( T_a + \\frac{G(1 - \\eta)}{U_0 + U_1 v} \\right) - T_{STC} \\right) \\right] $$\nThis is the required physically grounded expression.\n\n### Part 2: Calculation of Array Power in Heatwave Scenario\n\nWe now use the derived formula and the provided parameters to compute the array power.\nThe given values are:\n$P_{STC} = 4.5\\ \\mathrm{kW}$\n$G_{STC} = 1000\\ \\mathrm{W/m^2}$\n$T_{STC} = 298\\ \\mathrm{K}$\n$G = 950\\ \\mathrm{W/m^2}$\n$T_a = 310\\ \\mathrm{K}$\n$v = 0.5\\ \\mathrm{m/s}$\n$\\gamma = -0.004\\ \\mathrm{K^{-1}}$\n$\\eta = 0.18$\n$U_0 = 20\\ \\mathrm{W/(m^2\\cdot K)}$\n$U_1 = 6\\ \\mathrm{W/(m^2\\cdot K)}$\n\nFirst, we calculate the cell temperature $T_c$ under the heatwave conditions:\n$$ T_c = T_a + \\frac{G(1 - \\eta)}{U_0 + U_1 v} = 310 + \\frac{950(1 - 0.18)}{20 + 6(0.5)} $$\n$$ T_c = 310 + \\frac{950(0.82)}{20 + 3} = 310 + \\frac{779}{23} $$\n$$ T_c \\approx 310 + 33.869565\\ \\mathrm{K} = 343.869565\\ \\mathrm{K} $$\n\nNext, we calculate the power $P$ using this cell temperature:\n$$ P = P_{STC} \\frac{G}{G_{STC}} \\left[ 1 + \\gamma (T_c - T_{STC}) \\right] $$\n$$ P = 4.5\\ \\mathrm{kW} \\times \\frac{950}{1000} \\left[ 1 + (-0.004) (343.869565 - 298) \\right] $$\n$$ P = 4.275\\ \\mathrm{kW} \\times \\left[ 1 - 0.004 (45.869565) \\right] $$\n$$ P = 4.275\\ \\mathrm{kW} \\times \\left[ 1 - 0.183478 \\right] $$\n$$ P = 4.275\\ \\mathrm{kW} \\times 0.816522 $$\n$$ P \\approx 3.491413\\ \\mathrm{kW} $$\nRounding to four significant figures, the expected array power during the heatwave scenario is $3.491\\ \\mathrm{kW}$.\n\n### Part 3: Physical Discussion of Model Parameters\n\nA brief discussion of the parameters $\\gamma$, $\\eta$, $U_0$, and $U_1$ and their influence on system performance during heatwaves is provided below.\n\n*   **$\\gamma$, the temperature coefficient of power:** This parameter quantifies the sensitivity of the PV module's power output to changes in its operating temperature. For crystalline silicon technology, which dominates the market, $\\gamma$ typically ranges from $-0.003\\ \\mathrm{K^{-1}}$ to $-0.005\\ \\mathrm{K^{-1}}$. The given value of $-0.004\\ \\mathrm{K^{-1}}$ is standard. A more negative value (larger magnitude) signifies greater power loss per degree of temperature rise. In the context of climate risk stress testing, selecting a $\\gamma$ at the more sensitive end of the plausible range (e.g., $-0.005\\ \\mathrm{K^{-1}}$) for a given technology constitutes a conservative, worst-case assumption for heatwave impacts.\n\n*   **$\\eta$, the module electrical efficiency:** This represents the fraction of incident solar energy converted to electricity. For modern utility-scale silicon modules, $\\eta$ typically lies between $0.18$ and $0.22$ ($18\\%$ to $22\\%$). The value $\\eta = 0.18$ is reasonable. From the thermal model, a higher $\\eta$ means a smaller fraction of solar energy, $(1-\\eta)$, is converted to waste heat. This leads to a lower operating cell temperature $T_c$. Consequently, higher efficiency modules inherently run cooler and are slightly less affected by temperature-induced power degradation. For stress testing, using a lower-bound but realistic efficiency for the modeled technology is a conservative choice, as it will predict higher cell temperatures and thus greater power losses during a heatwave.\n\n*   **$U_0$ and $U_1$, the thermal transfer coefficients:** These coefficients define the module's ability to dissipate heat. $U_0$ captures radiative and natural convective cooling, while $U_1$ models forced convective cooling from wind. Their values are highly dependent on module mounting; an open-rack installation with good air circulation will have higher $U_0$ and $U_1$ values than a roof-integrated system with restricted airflow. For typical open-rack mounting, $U_0$ is often in the range of $20-30\\ \\mathrm{W/(m^2\\cdot K)}$ and $U_1$ in the range of $2-7\\ \\mathrm{W/(m^2\\cdot K)}$. The supplied values ($U_0 = 20\\ \\mathrm{W/(m^2\\cdot K)}$, $U_1 = 6\\ \\mathrm{W/(m^2\\cdot K)}$) are physically reasonable. Lower values of $U_0$ and $U_1$ signify poorer heat dissipation, leading to higher cell temperatures and greater power losses. Heatwaves are often associated with stagnant air (low wind speed, $v$), which diminishes the contribution of the $U_1$ term and makes the system performance critically dependent on $U_0$. For a conservative stress test, one would choose values for $U_0$ and $U_1$ that correspond to a mounting configuration with poor ventilation, thus maximizing the predicted temperature rise.",
            "answer": "$$\\boxed{3.491}$$"
        },
        {
            "introduction": "Effective stress testing requires translating uncertain climate projections into quantifiable impacts on the power system. This exercise focuses on a core task: processing outputs from multiple General Circulation Models (GCMs) to create a probabilistic forecast for summer temperatures. You will apply fundamental statistical principles to combine model uncertainty and natural variability, and then propagate this temperature forecast through a sensitivity model to project future peak electricity demand .",
            "id": "4078017",
            "problem": "Consider a regional power system performing climate risk stress testing for a future summer season in year $2050$. An ensemble of $5$ General Circulation Models (GCMs) provides projections of the summer-mean $2$-meter temperature for the region. The ensemble is characterized by model-specific projected summer-mean temperatures $\\mu_i$ and performance-based weights $w_i$, with $\\sum_{i=1}^{5} w_i = 1$. Interannual summer variability about each model’s mean is approximated as Gaussian with a common standard deviation $\\sigma$. To represent model spread and internal variability jointly, adopt the hierarchical representation in which the latent model mean $\\mu$ is treated as a random variable and interannual temperatures $T$ are distributed as a Gaussian conditional on $\\mu$. The GCM ensemble provides the inputs:\n- Weighted model means: $(\\mu_1, \\mu_2, \\mu_3, \\mu_4, \\mu_5) = (30.1, 29.8, 30.5, 30.3, 30.0)$ degrees Celsius,\n- Weights: $(w_1, w_2, w_3, w_4, w_5) = (0.25, 0.15, 0.20, 0.25, 0.15)$,\n- Interannual standard deviation: $\\sigma = 1.1$ degrees Celsius.\n\nAssume $\\mu$ is modeled as a Gaussian random variable whose mean and variance are determined from the weighted ensemble of $(\\mu_i, w_i)$. Conditional on $\\mu$, the summer temperature $T$ is Gaussian with mean $\\mu$ and variance $\\sigma^2$.\n\nA linear temperature–demand sensitivity model is used for summer peak demand forecasting. Let the baseline peak demand at a reference temperature be $D_{\\mathrm{ref}} = 9.5$ gigawatts at $T_{\\mathrm{ref}} = 28$ degrees Celsius. The temperature sensitivity coefficient is $\\alpha = 0.35$ gigawatts per degree Celsius, and peak demand is modeled as $D(T) = D_{\\mathrm{ref}} + \\alpha \\,(T - T_{\\mathrm{ref}})$.\n\nStarting from fundamental definitions of ensemble averages, laws of total expectation and total variance, and the definition of quantiles via the cumulative distribution function (CDF) of the Gaussian distribution, derive from first principles the ensemble mean and the upper decile (the $0.9$-quantile) of $T$. Then propagate the $0.9$-quantile temperature into the peak demand forecast using the linear sensitivity model.\n\nCompute the projected $0.9$-quantile summer peak demand for the year $2050$. Express your final answer in gigawatts and round to four significant figures.",
            "solution": "The problem is evaluated as valid because it is scientifically grounded in standard statistical and energy modeling practices, well-posed with all necessary information, and expressed in objective, unambiguous language. All data are consistent and physically plausible.\n\nThe objective is to compute the $0.9$-quantile of the summer peak demand, $D$, for the year $2050$. The demand $D$ is a linear function of the summer-mean temperature $T$, which is a random variable. The solution proceeds in three main steps: first, deriving the unconditional probability distribution of $T$ from the given hierarchical model; second, calculating the $0.9$-quantile of the temperature, $T_{0.9}$; and third, propagating this quantile through the demand model to find the corresponding demand quantile, $D_{0.9}$.\n\n**Step 1: Derive the unconditional distribution of temperature $T$**\n\nThe temperature $T$ is described by a hierarchical Gaussian model. The latent mean temperature, $\\mu$, representing model uncertainty, is modeled as a Gaussian random variable whose parameters are derived from the weighted GCM ensemble. Conditional on a specific value of $\\mu$, the summer temperature $T$ is also Gaussian, representing interannual variability.\n\nThe distribution for the latent mean $\\mu$ is given by $\\mu \\sim \\mathcal{N}(\\mu_{ens}, \\sigma_{ens}^2)$, where $\\mu_{ens}$ is the weighted mean and $\\sigma_{ens}^2$ is the weighted variance of the GCM ensemble projections.\nThe mean of $\\mu$ is its expectation, $E[\\mu]$, calculated as the weighted average of the GCM means $\\mu_i$:\n$$E[\\mu] = \\mu_{ens} = \\sum_{i=1}^{5} w_i \\mu_i$$\nThe variance of $\\mu$, $\\text{Var}(\\mu)$, is the weighted variance of the GCM means:\n$$\\text{Var}(\\mu) = \\sigma_{ens}^2 = \\sum_{i=1}^{5} w_i (\\mu_i - \\mu_{ens})^2$$\n\nThe conditional distribution of temperature $T$ given the latent mean $\\mu$ is $T \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma^2)$, where $\\sigma$ is the interannual standard deviation.\n\nTo find the unconditional distribution of $T$, we apply the laws of total expectation and total variance.\n\nThe unconditional mean of $T$ is found using the Law of Total Expectation:\n$$E[T] = E[E[T \\mid \\mu]]$$\nSince $E[T \\mid \\mu] = \\mu$, we have:\n$$E[T] = E[\\mu] = \\mu_{ens}$$\nThe unconditional variance of $T$ is found using the Law of Total Variance:\n$$\\text{Var}(T) = E[\\text{Var}(T \\mid \\mu)] + \\text{Var}(E[T \\mid \\mu])$$\nSince $\\text{Var}(T \\mid \\mu) = \\sigma^2$ (a constant) and $E[T \\mid \\mu] = \\mu$:\n$$\\text{Var}(T) = E[\\sigma^2] + \\text{Var}(\\mu) = \\sigma^2 + \\sigma_{ens}^2$$\nBecause the mixing distribution ($\\mu$) and the conditional distribution ($T \\mid \\mu$) are both Gaussian, the resulting unconditional distribution for $T$ is also Gaussian:\n$$T \\sim \\mathcal{N}(\\mu_{ens}, \\sigma_{ens}^2 + \\sigma^2)$$\n\nNow, we compute the numerical values for these parameters using the provided data:\n$\\mu_i = (30.1, 29.8, 30.5, 30.3, 30.0)$\n$w_i = (0.25, 0.15, 0.20, 0.25, 0.15)$\n$\\sigma = 1.1$\n\nThe ensemble mean $\\mu_{ens}$ is:\n$$\\mu_{ens} = (0.25)(30.1) + (0.15)(29.8) + (0.20)(30.5) + (0.25)(30.3) + (0.15)(30.0)$$\n$$\\mu_{ens} = 7.525 + 4.470 + 6.100 + 7.575 + 4.500 = 30.17$$\nThe ensemble variance $\\sigma_{ens}^2$ is:\n$$\\sigma_{ens}^2 = 0.25(30.1 - 30.17)^2 + 0.15(29.8 - 30.17)^2 + 0.20(30.5 - 30.17)^2 + 0.25(30.3 - 30.17)^2 + 0.15(30.0 - 30.17)^2$$\n$$\\sigma_{ens}^2 = 0.25(-0.07)^2 + 0.15(-0.37)^2 + 0.20(0.33)^2 + 0.25(0.13)^2 + 0.15(-0.17)^2$$\n$$\\sigma_{ens}^2 = 0.25(0.0049) + 0.15(0.1369) + 0.20(0.1089) + 0.25(0.0169) + 0.15(0.0289)$$\n$$\\sigma_{ens}^2 = 0.001225 + 0.020535 + 0.021780 + 0.004225 + 0.004335 = 0.0521$$\nThe total variance of the temperature $T$ is:\n$$\\text{Var}(T) = \\sigma^2 + \\sigma_{ens}^2 = (1.1)^2 + 0.0521 = 1.21 + 0.0521 = 1.2621$$\nThus, the unconditional distribution of temperature is $T \\sim \\mathcal{N}(30.17, 1.2621)$. The ensemble mean temperature is $30.17$ degrees Celsius.\n\n**Step 2: Calculate the $0.9$-quantile of temperature ($T_{0.9}$)**\n\nThe $q$-quantile of a random variable $X$ with cumulative distribution function (CDF) $F_X(x)$ is the value $x_q$ such that $F_X(x_q) = P(X \\le x_q) = q$. For a Gaussian variable $T \\sim \\mathcal{N}(\\mu_T, \\sigma_T^2)$, the $q$-quantile, $T_q$, is given by:\n$$T_q = \\mu_T + \\sigma_T z_q$$\nwhere $z_q$ is the $q$-quantile of the standard normal distribution, $\\mathcal{N}(0, 1)$.\n\nWe need to find the $0.9$-quantile ($q=0.9$), also known as the upper decile. From standard statistical tables or computation, the $z$-score corresponding to a cumulative probability of $0.9$ is $z_{0.9} \\approx 1.28155$.\nThe parameters for the distribution of $T$ are $\\mu_T = 30.17$ and $\\sigma_T^2 = 1.2621$. The standard deviation is $\\sigma_T = \\sqrt{1.2621}$.\n$$T_{0.9} = 30.17 + \\sqrt{1.2621} \\times z_{0.9} \\approx 30.17 + (1.123432) \\times (1.28155) \\approx 30.17 + 1.43979 \\approx 31.60979$$\n\n**Step 3: Propagate the quantile to peak demand**\n\nThe peak demand $D$ is a linear function of temperature $T$:\n$$D(T) = D_{\\mathrm{ref}} + \\alpha (T - T_{\\mathrm{ref}})$$\nwith $D_{\\mathrm{ref}} = 9.5$ GW, $T_{\\mathrm{ref}} = 28$ degrees Celsius, and $\\alpha = 0.35$ GW/°C.\nSince the coefficient $\\alpha = 0.35  0$, the function $D(T)$ is monotonically increasing. For a monotonically increasing function $g(X)$, the $q$-quantile of the transformed variable $Y=g(X)$ is given by $y_q = g(x_q)$. Therefore, the $0.9$-quantile of demand, $D_{0.9}$, is found by evaluating the demand function at $T_{0.9}$.\n$$D_{0.9} = D(T_{0.9}) = D_{\\mathrm{ref}} + \\alpha (T_{0.9} - T_{\\mathrm{ref}})$$\nSubstituting the numerical values:\n$$D_{0.9} \\approx 9.5 + 0.35 (31.60979 - 28)$$\n$$D_{0.9} \\approx 9.5 + 0.35 (3.60979) \\approx 9.5 + 1.2634265 = 10.7634265$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$D_{0.9} \\approx 10.76$$\n\nThe projected $0.9$-quantile summer peak demand for the year $2050$ is $10.76$ gigawatts.",
            "answer": "$$\\boxed{10.76}$$"
        },
        {
            "introduction": "The true risk of a climate event often lies in its simultaneous impact on both electricity supply and demand. This final practice integrates these compounding effects into a holistic system reliability assessment. You will model both temperature-driven demand increases and generation capacity derating to calculate the incremental Loss of Load Expectation (LOLE), a cornerstone metric in power system planning, providing a quantitative measure of the system's vulnerability to a heatwave .",
            "id": "4078015",
            "problem": "Consider a single-zone electric power system subject to a heatwave event. The Loss of Load Expectation (LOLE) is defined as the integral over time of the probability that load exceeds available generation capacity. Formally, for time indexed by $t$, the LOLE over an event window $\\mathcal{T}$ is\n$$\n\\mathrm{LOLE} \\;=\\; \\int_{t \\in \\mathcal{T}} \\mathbb{P}\\!\\left( D(t) \\;\\; C(t) \\right)\\, dt,\n$$\nwhere $D(t)$ is the electric demand and $C(t)$ is the available capacity. The incremental LOLE due to the heatwave is the difference between the LOLE computed under the heatwave temperatures and the LOLE under baseline temperature conditions over the same time window. In this problem, you will compute this incremental LOLE under temperature-induced derating using a probabilistic model for demand and capacity.\n\nAssume the following for each hour $t$:\n- Demand $D(t)$ is modeled as a Gaussian (Normal) random variable with mean $\\mu_D(T(t))$ and standard deviation $\\sigma_D$, where temperature $T(t)$ modifies the mean linearly:\n$$\n\\mu_D(T(t)) \\;=\\; \\mu_{D,0} \\;+\\; \\beta \\cdot \\left(T(t) - T_0\\right).\n$$\n- Available capacity $C(t)$ is modeled as a Gaussian (Normal) random variable with mean $\\mu_C(T(t))$ and standard deviation $\\sigma_C$, with temperature-induced fractional derating on the mean that is linear in the temperature deviation from the baseline $T_0$:\n$$\n\\mu_C(T(t)) \\;=\\; \\mu_{C,0} \\cdot \\left( 1 \\;-\\; \\gamma \\cdot \\left(T(t) - T_0\\right) \\right).\n$$\n- The parameters $\\mu_{D,0}$ and $\\mu_{C,0}$ are baseline means at the baseline temperature $T_0$. The coefficients $\\beta$ (units of $\\mathrm{MW}/^{\\circ}\\mathrm{C}$) and $\\gamma$ (units of $^{\\circ}\\mathrm{C}^{-1}$) represent demand sensitivity and capacity derating, respectively. The standard deviations $\\sigma_D$ and $\\sigma_C$ are in $\\mathrm{MW}$.\n- Conditional on temperature, $D(t)$ and $C(t)$ are statistically independent.\n\nLet the baseline LOLE be computed over the same time horizon using $T(t) = T_0$ for all hours $t \\in \\mathcal{T}$ with the same $\\mu_{D,0}$, $\\mu_{C,0}$, $\\sigma_D$, and $\\sigma_C$. Let the heatwave LOLE be computed using the hour-by-hour temperatures $T(t)$ specified for each test case. The incremental LOLE is defined as\n$$\n\\Delta \\mathrm{LOLE} \\;=\\; \\mathrm{LOLE}_{\\text{heatwave}} \\;-\\; \\mathrm{LOLE}_{\\text{baseline}}.\n$$\n\nUnits and output requirements:\n- All demand and capacity parameters are in $\\mathrm{MW}$.\n- Temperature is in degrees Celsius ($^{\\circ}\\mathrm{C}$).\n- Time is in hours ($\\mathrm{h}$). The LOLE and incremental LOLE must be reported in $\\mathrm{h}$ as real numbers (floats).\n- The final output must be a single line containing a comma-separated list of the incremental LOLE values for all test cases, enclosed in square brackets, for example $[x_1,x_2,x_3]$. Do not include any units or additional text in the output. Each entry must be a float.\n\nYour program must compute the incremental LOLE by evaluating, for each hour $t$, the probability $\\mathbb{P}\\!\\left(D(t)  C(t)\\right)$ implied by the specified Gaussian models and then summing over the event window with the given time step $\\Delta t$ (in hours). For the baseline LOLE, use $T(t) = T_0$ for all $t$ in the event window. Handle the boundary case where $\\sigma_D^2 + \\sigma_C^2 = 0$ by treating the probability $\\mathbb{P}\\!\\left(D(t)  C(t)\\right)$ as $1$ if $\\mu_D(T(t))  \\mu_C(T(t))$, $0.5$ if equality holds, and $0$ otherwise.\n\nTest suite:\nCompute $\\Delta \\mathrm{LOLE}$ for the following five parameter sets. Each case provides $(\\mu_{C,0}, \\sigma_C, \\mu_{D,0}, \\sigma_D, \\gamma, \\beta, T_0, \\Delta t, \\{T(t)\\}_{t \\in \\mathcal{T}})$.\n\n- Case $1$ (general heatwave, moderate variances):\n  - $\\mu_{C,0} = 10000\\ \\mathrm{MW}$,\n  - $\\sigma_C = 300\\ \\mathrm{MW}$,\n  - $\\mu_{D,0} = 9300\\ \\mathrm{MW}$,\n  - $\\sigma_D = 600\\ \\mathrm{MW}$,\n  - $\\gamma = 0.002 /^{\\circ}\\mathrm{C}$,\n  - $\\beta = 100\\ \\mathrm{MW}/^{\\circ}\\mathrm{C}$,\n  - $T_0 = 25\\ ^{\\circ}\\mathrm{C}$,\n  - $\\Delta t = 1\\ \\mathrm{h}$,\n  - Hourly temperatures $\\{T(t)\\}$ over $24$ hours (in $^{\\circ}\\mathrm{C}$):\n    $[33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 32, 33, 34]$\n\n- Case $2$ (deterministic boundary, zero variances):\n  - $\\mu_{C,0} = 1200\\ \\mathrm{MW}$,\n  - $\\sigma_C = 0\\ \\mathrm{MW}$,\n  - $\\mu_{D,0} = 1000\\ \\mathrm{MW}$,\n  - $\\sigma_D = 0\\ \\mathrm{MW}$,\n  - $\\gamma = 0.01 /^{\\circ}\\mathrm{C}$,\n  - $\\beta = 25\\ \\mathrm{MW}/^{\\circ}\\mathrm{C}$,\n  - $T_0 = 20\\ ^{\\circ}\\mathrm{C}$,\n  - $\\Delta t = 1\\ \\mathrm{h}$,\n  - Hourly temperatures $\\{T(t)\\}$ over $8$ hours (in $^{\\circ}\\mathrm{C}$):\n    $[20, 22, 24, 26, 28, 30, 32, 34]$\n\n- Case $3$ (no derating, demand-only sensitivity):\n  - $\\mu_{C,0} = 6500\\ \\mathrm{MW}$,\n  - $\\sigma_C = 250\\ \\mathrm{MW}$,\n  - $\\mu_{D,0} = 6000\\ \\mathrm{MW}$,\n  - $\\sigma_D = 350\\ \\mathrm{MW}$,\n  - $\\gamma = 0.0 /^{\\circ}\\mathrm{C}$,\n  - $\\beta = 60\\ \\mathrm{MW}/^{\\circ}\\mathrm{C}$,\n  - $T_0 = 23\\ ^{\\circ}\\mathrm{C}$,\n  - $\\Delta t = 1\\ \\mathrm{h}$,\n  - Hourly temperatures $\\{T(t)\\}$ over $12$ hours (in $^{\\circ}\\mathrm{C}$):\n    $[23, 25, 27, 29, 31, 33, 35, 33, 31, 29, 27, 25]$\n\n- Case $4$ (high-variance edge, probabilities near symmetry):\n  - $\\mu_{C,0} = 5000\\ \\mathrm{MW}$,\n  - $\\sigma_C = 1500\\ \\mathrm{MW}$,\n  - $\\mu_{D,0} = 4800\\ \\mathrm{MW}$,\n  - $\\sigma_D = 1500\\ \\mathrm{MW}$,\n  - $\\gamma = 0.002 /^{\\circ}\\mathrm{C}$,\n  - $\\beta = 40\\ \\mathrm{MW}/^{\\circ}\\mathrm{C}$,\n  - $T_0 = 24\\ ^{\\circ}\\mathrm{C}$,\n  - $\\Delta t = 1\\ \\mathrm{h}$,\n  - Hourly temperatures $\\{T(t)\\}$ over $6$ hours (in $^{\\circ}\\mathrm{C}$):\n    $[30, 30, 30, 30, 30, 30]$\n\n- Case $5$ (no heatwave, temperatures equal to baseline):\n  - $\\mu_{C,0} = 8000\\ \\mathrm{MW}$,\n  - $\\sigma_C = 400\\ \\mathrm{MW}$,\n  - $\\mu_{D,0} = 7800\\ \\mathrm{MW}$,\n  - $\\sigma_D = 300\\ \\mathrm{MW}$,\n  - $\\gamma = 0.003 /^{\\circ}\\mathrm{C}$,\n  - $\\beta = 20\\ \\mathrm{MW}/^{\\circ}\\mathrm{C}$,\n  - $T_0 = 26\\ ^{\\circ}\\mathrm{C}$,\n  - $\\Delta t = 1\\ \\mathrm{h}$,\n  - Hourly temperatures $\\{T(t)\\}$ over $24$ hours (in $^{\\circ}\\mathrm{C}$):\n    $[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26]$\n\nYour program should produce a single line of output containing the incremental LOLEs for Cases $1$ through $5$ as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is a float in $\\mathrm{h}$.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of power system reliability and probability theory, self-contained with all necessary data provided, and well-posed, admitting a unique and stable solution. The problem statement is objective and uses clear, formal language. Therefore, I will proceed with a full solution.\n\nThe problem requires the computation of the incremental Loss of Load Expectation ($\\Delta \\mathrm{LOLE}$) for a single-zone power system under a heatwave. The solution involves modeling both electricity demand and available generation capacity as Gaussian random variables whose means are dependent on temperature.\n\nFirst, let us formalize the probability of a loss of load event at any given time $t$. A loss of load occurs when demand $D(t)$ exceeds capacity $C(t)$. We are asked to compute $\\mathbb{P}(D(t) > C(t))$. Let us define a margin variable $X(t) = D(t) - C(t)$. A loss of load event is equivalent to the condition $X(t)  0$.\n\nThe problem states that demand $D(t)$ and capacity $C(t)$ are independent Gaussian random variables:\n$$\nD(t) \\sim \\mathcal{N}(\\mu_D(t), \\sigma_D^2)\n$$\n$$\nC(t) \\sim \\mathcal{N}(\\mu_C(t), \\sigma_C^2)\n$$\nThe difference of two independent Gaussian variables is also a Gaussian variable. Thus, $X(t)$ follows a Gaussian distribution $X(t) \\sim \\mathcal{N}(\\mu_X(t), \\sigma_X^2)$, where its mean and variance are:\n$$\n\\mu_X(t) = \\mathbb{E}[D(t) - C(t)] = \\mathbb{E}[D(t)] - \\mathbb{E}[C(t)] = \\mu_D(t) - \\mu_C(t)\n$$\n$$\n\\sigma_X^2 = \\mathrm{Var}(D(t) - C(t)) = \\mathrm{Var}(D(t)) + \\mathrm{Var}(C(t)) = \\sigma_D^2 + \\sigma_C^2\n$$\nThe second step for the variance calculation follows from the statistical independence of $D(t)$ and $C(t)$. The combined standard deviation is therefore $\\sigma_X = \\sqrt{\\sigma_D^2 + \\sigma_C^2}$.\n\nThe means $\\mu_D(t)$ and $\\mu_C(t)$ are functions of the ambient temperature $T(t)$:\n$$\n\\mu_D(T(t)) = \\mu_{D,0} + \\beta \\cdot (T(t) - T_0)\n$$\n$$\n\\mu_C(T(t)) = \\mu_{C,0} \\cdot \\left( 1 - \\gamma \\cdot (T(t) - T_0) \\right)\n$$\nwhere $\\mu_{D,0}$ and $\\mu_{C,0}$ are the baseline means at the reference temperature $T_0$.\n\nTo find the probability $\\mathbb{P}(X(t)  0)$, we standardize the variable $X(t)$ to a standard normal variable $Z \\sim \\mathcal{N}(0, 1)$:\n$$\nZ = \\frac{X(t) - \\mu_X(t)}{\\sigma_X}\n$$\nThe inequality $X(t)  0$ becomes:\n$$\n\\frac{X(t) - \\mu_X(t)}{\\sigma_X}  \\frac{0 - \\mu_X(t)}{\\sigma_X} \\implies Z  -\\frac{\\mu_X(t)}{\\sigma_X}\n$$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution. The probability is given by:\n$$\np(t) = \\mathbb{P}(X(t)  0) = \\mathbb{P}\\left(Z  -\\frac{\\mu_X(t)}{\\sigma_X}\\right) = 1 - \\Phi\\left(-\\frac{\\mu_X(t)}{\\sigma_X}\\right)\n$$\nUsing the identity $\\Phi(-z) = 1 - \\Phi(z)$, this simplifies to:\n$$\np(t) = \\Phi\\left(\\frac{\\mu_X(t)}{\\sigma_X}\\right) = \\Phi\\left(\\frac{\\mu_D(T(t)) - \\mu_C(T(t))}{\\sqrt{\\sigma_D^2 + \\sigma_C^2}}\\right)\n$$\nThis is the loss of load probability for a single hour $t$.\n\nThe problem defines LOLE as an integral over the event window $\\mathcal{T}$. For a discrete set of hourly temperatures, this integral is approximated by a sum:\n$$\n\\mathrm{LOLE} \\approx \\sum_{t_i \\in \\mathcal{T}_{\\text{discrete}}} p(t_i) \\, \\Delta t\n$$\nwhere $\\Delta t$ is the time step, given as $1$ hour for all test cases.\n\nThe incremental LOLE, $\\Delta \\mathrm{LOLE}$, is the difference between the LOLE calculated under heatwave conditions ($\\mathrm{LOLE}_{\\text{heatwave}}$) and under baseline conditions ($\\mathrm{LOLE}_{\\text{baseline}}$).\n\nFor $\\mathrm{LOLE}_{\\text{heatwave}}$, we compute $p(t_i)$ for each hour using the specified hourly temperatures $T(t_i)$ and sum the results:\n$$\n\\mathrm{LOLE}_{\\text{heatwave}} = \\Delta t \\sum_{i=1}^{N} \\Phi\\left(\\frac{\\mu_D(T(t_i)) - \\mu_C(T(t_i))}{\\sqrt{\\sigma_D^2 + \\sigma_C^2}}\\right)\n$$\nwhere $N$ is the number of hours in the event window.\n\nFor $\\mathrm{LOLE}_{\\text{baseline}}$, the temperature is held constant at $T(t) = T_0$ for all hours in the window. This makes the probability $p(t)$ constant for all baseline hours. At $T(t)=T_0$, the mean demand and capacity are simply $\\mu_{D,0}$ and $\\mu_{C,0}$. The baseline probability is:\n$$\np_{\\text{base}} = \\Phi\\left(\\frac{\\mu_{D,0} - \\mu_{C,0}}{\\sqrt{\\sigma_D^2 + \\sigma_C^2}}\\right)\n$$\nThe total baseline LOLE over the $N$-hour window is then:\n$$\n\\mathrm{LOLE}_{\\text{baseline}} = N \\cdot p_{\\text{base}} \\cdot \\Delta t\n$$\nFinally, the incremental LOLE is $\\Delta \\mathrm{LOLE} = \\mathrm{LOLE}_{\\text{heatwave}} - \\mathrm{LOLE}_{\\text{baseline}}$.\n\nA special boundary case occurs when $\\sigma_D^2 + \\sigma_C^2 = 0$, which implies $\\sigma_D=0$ and $\\sigma_C=0$. In this deterministic scenario, $D(t)$ and $C(t)$ are not random variables but fixed values equal to their means. The probability $\\mathbb{P}(D(t)  C(t))$ is no longer calculated via a CDF but becomes a simple comparison:\n- $1$ if $\\mu_D(T(t))  \\mu_C(T(t))$\n- $0.5$ if $\\mu_D(T(t)) = \\mu_C(T(t))$\n- $0$ if $\\mu_D(T(t))  \\mu_C(T(t))$\n\nThe algorithm for each test case is as follows:\n1. Extract all parameters: $(\\mu_{C,0}, \\sigma_C, \\mu_{D,0}, \\sigma_D, \\gamma, \\beta, T_0, \\Delta t, \\{T(t)\\})$.\n2. Calculate the total variance $\\sigma_X^2 = \\sigma_D^2 + \\sigma_C^2$ and standard deviation $\\sigma_X = \\sqrt{\\sigma_X^2}$.\n3. Calculate $\\mathrm{LOLE}_{\\text{baseline}}$:\n    a. Determine the baseline probability $p_{\\text{base}}$ using either the CDF formula (if $\\sigma_X  0$) or the deterministic comparison rules (if $\\sigma_X=0$) with means $\\mu_{D,0}$ and $\\mu_{C,0}$.\n    b. Compute $\\mathrm{LOLE}_{\\text{baseline}} = N \\cdot p_{\\text{base}} \\cdot \\Delta t$, where $N$ is the number of hours in the event.\n4. Calculate $\\mathrm{LOLE}_{\\text{heatwave}}$:\n    a. Initialize $\\mathrm{LOLE}_{\\text{heatwave}} = 0$.\n    b. For each hour $t_i$ with temperature $T(t_i)$:\n        i. Calculate the temperature-dependent means $\\mu_D(T(t_i))$ and $\\mu_C(T(t_i))$.\n        ii. Calculate the hourly probability $p(t_i)$ using either the CDF (if $\\sigma_X  0$) or the deterministic rules (if $\\sigma_X = 0$).\n        iii. Add $p(t_i) \\cdot \\Delta t$ to $\\mathrm{LOLE}_{\\text{heatwave}}$.\n5. Compute the final result: $\\Delta \\mathrm{LOLE} = \\mathrm{LOLE}_{\\text{heatwave}} - \\mathrm{LOLE}_{\\text{baseline}}$.\nThis procedure is applied to each of the five test cases provided.\n\n```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"mu_c0\": 10000.0, \"sigma_c\": 300.0,\n            \"mu_d0\": 9300.0, \"sigma_d\": 600.0,\n            \"gamma\": 0.002, \"beta\": 100.0,\n            \"t0\": 25.0, \"dt\": 1.0,\n            \"temps\": [33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 32, 33, 34]\n        },\n        # Case 2\n        {\n            \"mu_c0\": 1200.0, \"sigma_c\": 0.0,\n            \"mu_d0\": 1000.0, \"sigma_d\": 0.0,\n            \"gamma\": 0.01, \"beta\": 25.0,\n            \"t0\": 20.0, \"dt\": 1.0,\n            \"temps\": [20, 22, 24, 26, 28, 30, 32, 34]\n        },\n        # Case 3\n        {\n            \"mu_c0\": 6500.0, \"sigma_c\": 250.0,\n            \"mu_d0\": 6000.0, \"sigma_d\": 350.0,\n            \"gamma\": 0.0, \"beta\": 60.0,\n            \"t0\": 23.0, \"dt\": 1.0,\n            \"temps\": [23, 25, 27, 29, 31, 33, 35, 33, 31, 29, 27, 25]\n        },\n        # Case 4\n        {\n            \"mu_c0\": 5000.0, \"sigma_c\": 1500.0,\n            \"mu_d0\": 4800.0, \"sigma_d\": 1500.0,\n            \"gamma\": 0.002, \"beta\": 40.0,\n            \"t0\": 24.0, \"dt\": 1.0,\n            \"temps\": [30, 30, 30, 30, 30, 30]\n        },\n        # Case 5\n        {\n            \"mu_c0\": 8000.0, \"sigma_c\": 400.0,\n            \"mu_d0\": 7800.0, \"sigma_d\": 300.0,\n            \"gamma\": 0.003, \"beta\": 20.0,\n            \"t0\": 26.0, \"dt\": 1.0,\n            \"temps\": [26] * 24\n        }\n    ]\n\n    results = [calculate_incremental_lole(case) for case in test_cases]\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\ndef calculate_incremental_lole(params):\n    \"\"\"\n    Calculates the incremental LOLE for a single test case.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the case.\n\n    Returns:\n        float: The calculated incremental LOLE in hours.\n    \"\"\"\n    mu_c0 = params[\"mu_c0\"]\n    sigma_c = params[\"sigma_c\"]\n    mu_d0 = params[\"mu_d0\"]\n    sigma_d = params[\"sigma_d\"]\n    gamma = params[\"gamma\"]\n    beta = params[\"beta\"]\n    t0 = params[\"t0\"]\n    dt = params[\"dt\"]\n    temps = params[\"temps\"]\n    \n    n_hours = len(temps)\n    total_variance = sigma_c**2 + sigma_d**2\n    \n    # Calculate LOLE_baseline\n    mu_diff_base = mu_d0 - mu_c0\n    if total_variance == 0:\n        if mu_diff_base  0:\n            p_base = 1.0\n        elif mu_diff_base == 0:\n            p_base = 0.5\n        else:\n            p_base = 0.0\n    else:\n        total_std_dev = np.sqrt(total_variance)\n        z_base = mu_diff_base / total_std_dev\n        p_base = norm.cdf(z_base)\n        \n    lole_baseline = p_base * n_hours * dt\n\n    # Calculate LOLE_heatwave\n    lole_heatwave = 0.0\n    for t_hour in temps:\n        delta_t = t_hour - t0\n        \n        mu_d_t = mu_d0 + beta * delta_t\n        mu_c_t = mu_c0 * (1 - gamma * delta_t)\n        \n        mu_diff_hw = mu_d_t - mu_c_t\n\n        if total_variance == 0:\n            if mu_diff_hw  0:\n                p_hw = 1.0\n            elif mu_diff_hw == 0:\n                p_hw = 0.5\n            else:\n                p_hw = 0.0\n        else:\n            total_std_dev = np.sqrt(total_variance)\n            z_hw = mu_diff_hw / total_std_dev\n            p_hw = norm.cdf(z_hw)\n            \n        lole_heatwave += p_hw * dt\n\n    return lole_heatwave - lole_baseline\n\nif __name__ == \"__main__\":\n    solve()\n```",
            "answer": "[12.4344078772,5.0000000000,2.1557008688,0.3013233863,0.0000000000]"
        }
    ]
}