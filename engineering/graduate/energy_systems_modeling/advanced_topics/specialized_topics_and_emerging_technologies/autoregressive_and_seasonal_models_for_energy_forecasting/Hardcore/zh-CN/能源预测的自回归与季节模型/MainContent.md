## 引言
在现代能源系统中，精准的预测是实现高效运营、优化调度和保障供应安全的关键。从[电力](@entry_id:264587)负荷到可再生能源发电量，对未来趋势的准确把握直接影响着经济效益和[系统稳定性](@entry_id:273248)。自回归与季节性模型，作为[时间序列分析](@entry_id:178930)的经典支柱，为此提供了强大而灵活的工具集。然而，从掌握平稳性、自相关性等基本概念，到熟练运用复杂的[SARIMA模型](@entry_id:1131200)解决真实世界的预测难题，存在着一条陡峭的学习曲线。本文旨在填补这一知识鸿沟，为读者提供一个从核心原理到高级应用的系统性指南。

本文将带领读者踏上一段结构化的学习之旅。在第一章**“原理与机制”**中，我们将奠定坚实的理论基础，深入剖析构成自回归与季节性模型的核心构件，如[平稳性](@entry_id:143776)、[ARMA过程](@entry_id:260629)、差分以及完整的S[ARIMA](@entry_id:1121103)框架，并介绍经典的Box-Jenkins建模流程。随后，在第二章**“应用与跨学科联系”**中，我们将视野扩展到实际应用，探讨如何利用这些模型处理外生变量（如温度）、捕捉多重季节性、应对[结构突变](@entry_id:636506)，并了解其在[多变量系统](@entry_id:169616)（VAR、ECM）和能源之外的领域（如流行病学）中的延伸。最后，在第三章**“动手实践”**中，通过精心设计的练习，读者将有机会亲手应用所学知识，将理论转化为解决具体问题的实践能力。通过这三章的学习，您将构建起对自回归与季节性模型的全面理解，并有能力将其应用于能源预测及更广泛的分析任务中。

## 原理与机制

在深入探讨能源预测的复杂模型之前，我们必须首先掌握构建这些模型的基本原理和核心机制。本章将系统性地阐述构成自回归和季节性模型基础的若干关键概念，从时间序列的平稳性，到自回归（AR）和移动平均（MA）过程的构建，再到处理非平稳性和季节性的积分（I）与季节性（S）组件。我们将最终把这些构件组合成一个完整且强大的框架——季节性自回归积分移动平均（S[ARIMA](@entry_id:1121103)）模型，并阐述在实际应用中识别、估计和诊断这些模型的系统性流程。

### [时间序列建模](@entry_id:1133184)的基石：[平稳性](@entry_id:143776)

在时间序列分析中，**[平稳性](@entry_id:143776) (stationarity)** 是一个核心概念。一个[随机过程](@entry_id:268487)如果具有平稳性，意味着其统计特性（如均值、方差和[自相关](@entry_id:138991)性）不随时间推移而改变。这一特性至关重要，因为它确保了我们在一个时间段内观察到的模式（例如，一个小时前的负荷与当前负荷的关系）在未来也同样适用。没有[平稳性](@entry_id:143776)，过去将无法成为未来的可靠指南，预测也就无从谈起。

在实践中，我们主要关注**[弱平稳性](@entry_id:171204) (weak stationarity)**，也称为协方差平稳性。一个时间序列 $\{L_t\}$ 若要满足[弱平稳性](@entry_id:171204)，必须具备以下三个条件 ：
1.  **均值恒定**: 过程的[期望值](@entry_id:150961) $\mathbb{E}[L_t]$ 对所有时间点 $t$ 都是一个常数 $\mu$。
2.  **方差有限且恒定**: 过程的方差 $\operatorname{Var}(L_t)$ 对所有时间点 $t$ 都是一个常数 $\sigma^2$，这意味着二阶矩 $\mathbb{E}[L_t^2]$ 是有限的。
3.  **[自协方差](@entry_id:270483)仅依赖于时间间隔**: 任意两个时间点 $t$ 和 $t+h$ 的协方差 $\operatorname{Cov}(L_t, L_{t+h})$ 仅依赖于时间滞后 $h$，而与具体的时间点 $t$ 无关。我们可以将其表示为 $\gamma(h)$。

一个更强的概念是**[严平稳性](@entry_id:260987) (strict stationarity)**，它要求对于任意一组时间点 $\{t_1, t_2, \dots, t_k\}$ 和任意[时间平移](@entry_id:261541) $\tau$，其[联合概率分布](@entry_id:171550)与平移后的时间点 $\{t_1+\tau, t_2+\tau, \dots, t_k+\tau\}$ 的[联合概率分布](@entry_id:171550)完全相同。[严平稳性](@entry_id:260987)意味着所有阶的矩（如果存在）都不随时间变化，因此，一个满足[严平稳性](@entry_id:260987)且前两阶矩有限的过程必然是弱平稳的。反之则不一定成立。然而，在一个重要的特例中——**高斯过程 (Gaussian process)**——[弱平稳性](@entry_id:171204)与[严平稳性](@entry_id:260987)是等价的。因为[高斯过程](@entry_id:182192)的全部概率分布信息都由其[均值函数](@entry_id:264860)和协方差函数完全确定，所以只要这两个函数满足弱[平稳性条件](@entry_id:191085)，整个分布结构就是时不变的。

对于[能源系统建模](@entry_id:1124496)而言，原始的[电力](@entry_id:264587)负荷数据，无论是小时、日还是周的频率，几乎总是**非平稳的**。负荷序列通常包含明显的趋势（如经济增长导致的长期需求增加）和复杂的季节性（如日内高峰和低谷、工作日与周末的差异、年度温度变化引起的周期）。这些模式意味着负荷的均值 $\mathbb{E}[L_t]$ 随时间变化（例如，周一上午9点的平均负荷显然不同于周日凌晨3点的平均负荷），直接违反了[弱平稳性](@entry_id:171204)的第一个条件。因此，在应用依赖于[平稳性假设](@entry_id:272270)的模型（如 ARMA 模型）之前，必须对数据进行预处理，以消除这些非平稳成分。这正是 [ARIMA](@entry_id:1121103) 和 S[ARIMA](@entry_id:1121103) 模型中“积分”（I）和“季节性”（S）组件的核心功能，它们通过差分或显式建模来移除趋势和季节性，从而得到一个可以被视为平稳的残差序列。

### 模拟[平稳过程](@entry_id:196130)：[ARMA模型](@entry_id:139294)

在将非[平稳序列](@entry_id:144560)转换为[平稳序列](@entry_id:144560)后，我们需要工具来描述其内在的[线性依赖](@entry_id:185830)结构。[自回归移动平均](@entry_id:143076)（ARMA）模型正是为此而生，它由自回归（AR）和移动平均（MA）两个基本部分组成。

#### 自回归（AR）模型

**自回归 (Autoregressive, AR)** 模型的思想是，一个序列的当前值可以由其过去值的线性组合来预测。一个 $p$ 阶的[自回归模型](@entry_id:140558)，记为 AR($p$)，其数学表达式为：
$$
y_t = c + \sum_{i=1}^{p} \phi_i y_{t-i} + \varepsilon_t
$$
其中，$y_t$ 是时间序列在 $t$ 时刻的值，$\phi_1, \dots, \phi_p$是模型参数，$c$ 是常数项，而 $\varepsilon_t$ 是一个**[白噪声](@entry_id:145248) (white noise)** 过程，即均值为零、方差恒定且序列不相关的随机扰动项。

使用**[滞后算子](@entry_id:266398) (backshift operator)** $B$（定义为 $B y_t = y_{t-1}$），AR($p$) 模型可以更紧凑地写作：
$$
\Phi(B) y_t = c + \varepsilon_t, \quad \text{其中 } \Phi(B) = 1 - \sum_{i=1}^{p} \phi_i B^i
$$
多项式 $\Phi(B)$ 被称为自回归[特征多项式](@entry_id:150909)。

一个关键的属性是**因果性 (causality)**。因果性保证了 $y_t$ 可以完全由当前和过去的白噪声项 $\varepsilon_t, \varepsilon_{t-1}, \dots$ 表示，这意味着系统的输出不会依赖于未来的扰动。[因果性条件](@entry_id:161083)可以通过考察[特征方程](@entry_id:265849) $\Phi(z) = 1 - \sum_{i=1}^{p} \phi_i z^i = 0$ 的根来判断。一个 AR($p$) 过程是因果的，当且仅当该方程的所有复数根 $z$ 都位于复平面的单位圆之外，即 $|z| > 1$ 。这个条件也等价于过程的[平稳性](@entry_id:143776)。

例如，考虑一个为小时[负荷建模](@entry_id:1127383)的 AR(2) 过程，其参数为 $\phi_1 = 1.2$ 和 $\phi_2 = -0.32$。[特征方程](@entry_id:265849)为 $1 - 1.2z + 0.32z^2 = 0$。解这个[二次方程](@entry_id:163234)得到的根为 $z_1 = 1.25$ 和 $z_2 = 2.5$。由于这两个根的模都大于1，因此该 AR(2) 模型是因果且平稳的 。值得注意的是，[因果性条件](@entry_id:161083)是关于所有系数共同决定的根的位置，而非单个系数的大小，例如本例中 $|\phi_1| = 1.2 > 1$，但模型依然是平稳的。

#### 移动平均（MA）模型

与 AR 模型不同，**移动平均 (Moving Average, MA)** 模型假设序列的当前值是当前和过去[白噪声](@entry_id:145248)扰动项的[线性组合](@entry_id:154743)。一个 $q$ 阶的[移动平均模型](@entry_id:136461)，记为 MA($q$)，其表达式为：
$$
y_t = \mu + \varepsilon_t + \sum_{j=1}^{q} \theta_j \varepsilon_{t-j}
$$
其中，$\mu$ 是序列的均值，$\theta_1, \dots, \theta_q$是模型参数。同样，使用[滞后算子](@entry_id:266398)，我们可以写作：
$$
y_t = \mu + \Theta(B) \varepsilon_t, \quad \text{其中 } \Theta(B) = 1 + \sum_{j=1}^{q} \theta_j B^j
$$
其中 $\theta_0$ 通常被[标准化](@entry_id:637219)为1。

一个有限阶的 MA($q$) 过程总是弱平稳的，因为它的均值和方差是常数，并且其[自协方差](@entry_id:270483)在滞后 $q$ 之后恒为零。对于 MA 模型，我们关心的是**可逆性 (invertibility)**。[可逆性](@entry_id:143146)保证了我们可以将不可观测的[白噪声](@entry_id:145248)项 $\varepsilon_t$ 表示为当前和过去观测值 $y_t, y_{t-1}, \dots$ 的收敛[无穷级数](@entry_id:143366)。这个属性对于模型估计和将 MA 组件嵌入更广泛的 ARMA 结构中至关重要。

与 AR 模型的[因果性条件](@entry_id:161083)类似，MA($q$) 过程的可逆性条件也由其[特征多项式](@entry_id:150909) $\Theta(z) = 1 + \sum_{j=1}^{q} \theta_j z^j = 0$ 的根决定。一个 MA($q$) 过程是可逆的，当且仅当该方程的所有复数根 $z$ 都位于[单位圆](@entry_id:267290)之外，即 $|z| > 1$ 。

### 处理非平稳性：[ARIMA](@entry_id:1121103)框架

我们已经知道，现实世界的能源时间序列通常是非平稳的。[ARIMA](@entry_id:1121103)（自回归积分[移动平均](@entry_id:203766)）模型正是通过引入“积分”（Integrated）这一概念来处理此类[非平稳性](@entry_id:180513)。

#### 差分与[单位根](@entry_id:143302)

在 AR($p$) 模型中，如果其[特征方程](@entry_id:265849) $\Phi(z)=0$ 有一个根恰好落在单位圆上（即 $|z|=1$），我们就称该过程含有**[单位根](@entry_id:143302) (unit root)**。最常见的[单位根](@entry_id:143302)是 $z=1$，它对应于一个随机游走的行为，是造成随机趋势和[非平稳性](@entry_id:180513)的根源。例如，在一个 AR(1) 模型 $y_t = \phi y_{t-1} + \varepsilon_t$ 中，当 $\phi=1$ 时，模型变为 $y_t = y_{t-1} + \varepsilon_t$，这是一个[随机游走过程](@entry_id:171699)。任何一次冲击 $\varepsilon_t$ 的影响都会永久地保留在系统中，而不会衰减，导致序列的方差随时间无限增大，从而破坏了平稳性 。

处理[单位根](@entry_id:143302)的有效方法是进行**差分 (differencing)**。对一个含有[单位根](@entry_id:143302) $z=1$ 的序列进行[一阶差分](@entry_id:275675)，即计算 $\Delta y_t = y_t - y_{t-1} = (1-B)y_t$，通常可以消除这种非平稳性。

从代数角度看，一个含有[单位根](@entry_id:143302)的 ARMA($p,q$) 模型可以被重新解释为一个对差分序列建模的 ARMA($p-1, q$) 模型。假设一个 ARMA($p,q$) 模型的 AR 多项式 $\Phi(L)$ 有一个[单位根](@entry_id:143302)，即 $\Phi(1)=0$。根据多项式因子定理，我们可以将其分解为 $\Phi(L) = (1-L)\phi(L)$，其中 $\phi(L)$ 是一个 $p-1$ 阶的多项式。原模型 $\Phi(L)y_t = c + \Theta(L)\varepsilon_t$ 就可以被重写为：
$$
(1-L)\phi(L)y_t = c + \Theta(L)\varepsilon_t
$$
定义差分序列 $w_t = (1-L)y_t$，上式变为：
$$
\phi(L)w_t = c + \Theta(L)\varepsilon_t
$$
这表明，原始的非[平稳序列](@entry_id:144560) $y_t$ 经过[一阶差分](@entry_id:275675)后得到的序列 $w_t$，遵循一个平稳的 ARMA($p-1,q$) 过程（前提是 $\phi(L)$ 的根都在[单位圆](@entry_id:267290)外）。这个整体结构被称为 [ARIMA](@entry_id:1121103)($p,1,q$) 模型，其中整数“1”代表进行了[一阶差分](@entry_id:275675) 。常数项 $c$ 在[差分方程](@entry_id:262177)中表示 $w_t$ 的非零均值，这意味着原始序列 $y_t$ 存在一个线性的确定性趋势，即**漂移 (drift)**。

#### [单位根检验](@entry_id:142963)

在实践中，我们如何判断一个序列是否需要差分呢？这需要通过统计检验来完成。**[增广迪基-福勒检验](@entry_id:141151) (Augmented Dickey-Fuller, ADF test)** 是最常用的[单位根检验](@entry_id:142963)方法。AD[F检验](@entry_id:274297)的[原假设](@entry_id:265441)（null hypothesis）是序列存在一个[单位根](@entry_id:143302)（即非平稳），[备择假设](@entry_id:167270)（alternative hypothesis）是序列是平稳的。

ADF 检验通过一个回归方程来执行，该方程不仅包含了待检验的滞后项，还包含了序列差分的若干滞后项。这些额外的“增广”项的作用是吸收序列中可能存在的短期[自相关](@entry_id:138991)，确保回归方程的残差是白噪声，从而使[检验统计量](@entry_id:897871)的分布有效 。

在处理像日度[电力](@entry_id:264587)需求这样的数据时，序列中通常还包含确定性的成分，如周内效应。为了避免将这些确定性模式误判为随机趋势，我们可以在 ADF 检验的回归方程中加入相应的[控制变量](@entry_id:137239)，例如，加入6个星期[虚拟变量](@entry_id:138900)来捕捉周一到周六相对于周日的固定差异，以及一个线性时间趋势项 $t$。通过这种方式，ADF 检验可以有效地将随机趋势（[单位根](@entry_id:143302)）与确定性趋势和季节性分离开来 。

### 融合季节性：[SARIMA模型](@entry_id:1131200)

能源数据最显著的特征之一是其强烈的季节性。S[ARIMA](@entry_id:1121103) 模型通过在 [ARIMA](@entry_id:1121103) 框架中加入季节性成分来专门处理这一特征。

#### 确定性季节性与随机性季节性

首先，区分两种不同性质的季节性至关重要 。
*   **确定性季节性 (Deterministic Seasonality)**: 这种季节性表现为一个固定的、可预测的周期性函数 $m(t)$，满足 $m(t) = m(t-s)$，其中 $s$ 是季节周期（例如，对于小时数据，日周期 $s=24$）。如果一个序列 $D_t = m(t) + Y_t$（其中 $Y_t$ 是[平稳过程](@entry_id:196130)），那么它的均值会随时间周期性变化，导致整个序列非平稳。这种模式的标志是，其样本自相关函数（ACF）在季节性滞后 $s, 2s, 3s, \dots$ 处会显示出非常强且**不会衰减**的峰值。
*   **随机性季节性 (Stochastic Seasonality)**: 这种季节性本身是一个[随机过程](@entry_id:268487)，其形态在不同周期之间可能略有变化。一个典型的例子是季节性自回归模型 SAR(1)，如 $D_t = \Phi D_{t-s} + \varepsilon_t$。如果参数 $|\Phi|1$，该过程是平稳的。它的ACF同样会在季节性滞后处出现峰值，但这些峰值的高度会随着滞后阶数的增加而**几何衰减**。如果 $|\Phi|=1$，则称为季节性[单位根](@entry_id:143302)，表现为一种非平稳的随机季节性，其样本 ACF 在季节性滞后处的峰值同样接近1且衰减极其缓慢。

#### 季节性差分

处理季节性，特别是确定性季节性和季节性[单位根](@entry_id:143302)的工具是**季节性差分 (seasonal differencing)**，其算子为 $(1-B^s)$。

季节性差分算子可以完美地消除一个固定的确定性周期。如果一个成分 $S_t$ 满足 $S_t = S_{t-s}$，那么对其进行季节性差分会得到 $(1-B^s)S_t = S_t - S_{t-s} = 0$，季节性成分被完全移除 。

当应用于具有随机季节性的[平稳过程](@entry_id:196130) $Y_t$ 时，季节性差分会改变其自相关结构，但通常不会将其完全消除。例如，差分后的序列 $Z_t = Y_t - Y_{t-s}$ 的[自协方差](@entry_id:270483)会是原始序列 $Y_t$ [自协方差](@entry_id:270483)的线性组合。这意味着，即使在季节性差分之后，残差序列中仍可能存在季节性相关性，这为后续使用季节性 ARMA 模型提供了依据 。对于季节性[单位根](@entry_id:143302)过程，季节性差分则能将其转换为[平稳过程](@entry_id:196130)。

#### 完整的乘法[SARIMA模型](@entry_id:1131200)

现在，我们可以将所有部件组装成完整的**[季节性自回归积分移动平均模型](@entry_id:1131200)**，即 S[ARIMA](@entry_id:1121103)$(p,d,q)\times(P,D,Q)_s$。其通用数学表达式为 ：
$$
\phi_p(B) \Phi_P(B^s) (1-B)^d (1-B^s)^D y_t = \theta_q(B) \Theta_Q(B^s) \varepsilon_t
$$
这个方程的各个组成部分的作用如下：
*   **非季节性部分 $(p,d,q)$**:
    *   $(1-B)^d$: 进行 $d$ 阶非季节性差分，以消除趋势和低阶随机游走。
    *   $\phi_p(B)$: $p$ 阶非季节性自回归多项式，用于捕捉短期间隔（如小时到小时）的依赖关系。
    *   $\theta_q(B)$: $q$ 阶非季节性移动平均多项式，用于模拟短期扰动的持续效应。
*   **季节性部分 $(P,D,Q)_s$**:
    *   $(1-B^s)^D$: 进行 $D$ 阶季节性差分（周期为 $s$），以消除季节性趋势和季节性[单位根](@entry_id:143302)。
    *   $\Phi_P(B^s)$: $P$ 阶季节性自回归多项式，用于捕捉季节性间隔（如今天某小时与昨天同一小时）的依赖关系。
    *   $\Theta_Q(B^s)$: $Q$ 阶季节性[移动平均](@entry_id:203766)多项式，用于模拟季节性扰动的持续效应。

该模型的一个关键特征是其**乘法结构**。非季节性多项式和季节性多项式相乘，产生了一个比简单相加更丰富的滞后结构。例如，一个 S[ARIMA](@entry_id:1121103)(1,d,0) $\times$ (1,D,0)$_s$ 模型的完整自回归部分是 $(1-\phi_1 B)(1-\Phi_1 B^s) = 1 - \phi_1 B - \Phi_1 B^s + \phi_1\Phi_1 B^{s+1}$。这意味着当前值不仅依赖于前一个时刻的值（滞后1）和前一个季节同一时刻的值（滞后 $s$），还依赖于一个混合滞后项（滞后 $s+1$）。在小时[负荷预测](@entry_id:1127381)的背景下，这捕捉了“今天上午10点的负荷可能与昨天上午9点的负荷有关”这类复杂的跨日动态。

### 实践中的建模流程

掌握了所有理论构件后，我们便可以遵循一个系统性的流程——通常称为**[Box-Jenkins方法](@entry_id:169235)**——来构建一个有效的[SARIMA模型](@entry_id:1131200)。这个流程是迭代的，主要包括三个阶段：识别、估计与选择、以及诊断检验 。

#### 1. 识别 (Identification)

识别阶段的目标是确定模型的阶数 $(p,d,q)$ 和 $(P,D,Q)_s$。
*   **[数据预处理](@entry_id:197920)**: 首先，通过观察时间[序列图](@entry_id:165947)来了解其基本模式。如果序列的波动幅度随水平变化（异方差性），则可能需要进行[方差稳定化](@entry_id:902693)变换，如[对数变换](@entry_id:267035)或[Box-Cox变换](@entry_id:910653)。
*   **确定差分阶数 $(d, D)$**: 通过观察[序列图](@entry_id:165947)和ACF图的衰减行为，初步判断是否需要差分。然后，使用[单位根检验](@entry_id:142963)（如AD[F检验](@entry_id:274297)）和季节性[单位根检验](@entry_id:142963)来正式确定非季节性差分阶数 $d$ 和季节性差分阶数 $D$，直到序列达到平稳。
*   **确定ARMA阶数 $(p,q,P,Q)$**: 对平稳化后的序列绘制自相关函数（ACF）和[偏自相关函数](@entry_id:143703)（PACF）图。根据它们的特征行为来初步选择AR和MA的阶数：
    *   **AR($p$)过程**: ACF呈指数衰减或正弦衰减，PACF在滞后 $p$ 处截尾（即在 $p$ 之后突然变为零）。
    *   **MA($q$)过程**: PACF呈指数衰减或正弦衰减，ACF在滞后 $q$ 处截尾。
    *   这个规则同样适用于季节性阶数 $P$ 和 $Q$，只需考察ACF/PACF图在季节性滞后 $s, 2s, \dots$ 处的行为即可。

#### 2. 估计与选择 (Estimation and Selection)

根据识别阶段的发现，我们通常会得到一个或几个候选模型。
*   **[参数估计](@entry_id:139349)**: 对每个候选模型，使用最大似然估计等方法来估计其参数（$\phi, \theta, \Phi, \Theta$）。
*   **[模型选择](@entry_id:155601)**: 为了在[拟合优度](@entry_id:176037)和[模型简约性](@entry_id:1128045)之间取得平衡，我们使用**信息准则 (Information Criteria)** 来比较不同的模型。最常用的两个准则是：
    *   **[赤池信息准则 (AIC)](@entry_id:193149)**: $AIC = -2\ln(L) + 2k$
    *   **[贝叶斯信息准则 (BIC)](@entry_id:181959)**: $BIC = -2\ln(L) + k \ln(n)$
    其中，$L$ 是模型的[最大似然](@entry_id:146147)值，$k$ 是模型中自由参数的总数，$n$ 是观测数据的数量。BIC对模型复杂度的惩罚比AIC更重，因此在大样本情况下倾向于选择更简约的模型。一般原则是选择AIC或BIC值最小的模型。

#### 3. 诊断检验 (Diagnostic Checking)

这是建模流程中至关重要的一步。一个好的模型必须能够充分捕捉数据中的相关性，使其残差序列 $\{e_t\}$ 表现为白噪声。
*   **[残差分析](@entry_id:191495)**: 检验模型残差的ACF和PACF图。如果模型合适，残差的自相关和偏自相关应该在所有滞后阶数上都不显著。
*   **Portmanteau检验**: 为了进行更正式的检验，我们使用所谓的“综合检验”（Portmanteau test），如**[Ljung-Box检验](@entry_id:194194)**。该检验的[原假设](@entry_id:265441)是残差序列的前 $m$ 个自[相关系数](@entry_id:147037)均为零（即残差是[白噪声](@entry_id:145248)）。
    Ljung-Box统计量定义为 ：
    $$
    Q_{\mathrm{LB}}(m) = n(n+2) \sum_{h=1}^{m} \frac{\hat{\rho}_h^2}{n-h}
    $$
    其中，$n$ 是样本量，$\hat{\rho}_h$ 是残差在滞后 $h$ 时的样本自[相关系数](@entry_id:147037)。在原假设下，该统计量近似服从[卡方分布](@entry_id:263145)。
    一个关键点是，当应用于模型残差时，[卡方分布](@entry_id:263145)的自由度需要进行调整。自由度应为 $m - k$，其中 $k$ 是模型中估计的AR和MA参数总数，即 $k = p+q+P+Q$。差分阶数 $d$ 和 $D$ 不计入参数数量。
    如果[Ljung-Box检验](@entry_id:194194)的[p值](@entry_id:136498)很小（例如，小于0.05），我们则拒绝[原假设](@entry_id:265441)，认为残差中仍存在显著的[自相关](@entry_id:138991)，模型需要重新设定。

如果诊断检验通过，模型便可用于预测。如果未通过，则需返回识别阶段，根据残差的结构修正模型，开始新一轮的迭代。这一严谨的、迭代的流程确保了我们最终得到的模型不仅在统计上是合理的，而且能够为能源系统的决策提供可靠的预测支持。