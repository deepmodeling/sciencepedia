{
    "hands_on_practices": [
        {
            "introduction": "To manage the complexity of large-scale power systems, modelers often simplify the network by aggregating buses into larger zones. This practice explores the fundamental mechanics of such a network reduction within the DC power flow approximation. By working through a concrete example, you will derive the physically consistent weighting for merging two buses and compute the resulting aggregated Power Transfer Distribution Factor (PTDF), a cornerstone of transmission analysis. ",
            "id": "4133834",
            "problem": "Consider the Direct-Current (DC) power flow approximation on a $3$-bus network with buses labeled $1$, $2$, and $3$. The network has three transmission lines: $(1,2)$, $(1,3)$, and $(2,3)$. Let the series reactances be $x_{12} = 0.5$, $x_{13} = 1$, and $x_{23} = 1$. Denote the corresponding susceptances by $b_{ij} = \\frac{1}{x_{ij}}$. Take bus $1$ as the slack bus with angle $\\theta_{1} = 0$. Adopt the line orientation from lower-numbered to higher-numbered bus, i.e., $1 \\to 2$, $1 \\to 3$, and $2 \\to 3$, and define line flows $f_{ij} = b_{ij}(\\theta_{i} - \\theta_{j})$ along these orientations.\n\nYou will merge buses $2$ and $3$ into an aggregated bus $A$. Define the aggregated transfer as a unit injection at bus $1$ and a unit withdrawal at bus $A$, with the withdrawal at bus $A$ split between the original buses $2$ and $3$ as $p_{2} = -\\alpha$ and $p_{3} = -(1-\\alpha)$, where $0 \\leq \\alpha \\leq 1$. Impose the angle consistency constraint required by a physical merge, namely $\\theta_{2} = \\theta_{3}$ under the aggregated withdrawal.\n\nStarting solely from the DC power flow definitions and the network data provided, determine the unique $\\alpha$ that enforces $\\theta_{2} = \\theta_{3}$ and compute the resulting aggregated Power Transfer Distribution Factor (PTDF) for the physical line $(1,2)$ with respect to the unit transfer from bus $1$ to bus $A$. The aggregated PTDF for line $(1,2)$ is defined as the fraction of the unit transfer that flows on $(1,2)$ in the original network under the withdrawal split that enforces $\\theta_{2} = \\theta_{3}$. Verify in your derivation that:\n- The total flow on $(1,2)$ and $(1,3)$ sums to the unit transfer (power balance), and\n- The aggregated PTDF equals the weighted sum of the bus-level PTDFs for sinks at buses $2$ and $3$ when weighted by the same $\\alpha$ and $1-\\alpha$.\n\nProvide the aggregated PTDF on line $(1,2)$ as an exact fraction. No units. No rounding is required.",
            "solution": "The problem statement will first be validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Network: $3$-bus network with buses labeled $1$, $2$, and $3$.\n- Transmission lines: $(1,2)$, $(1,3)$, and $(2,3)$.\n- Series reactances: $x_{12} = 0.5$, $x_{13} = 1$, $x_{23} = 1$.\n- Susceptances: $b_{ij} = \\frac{1}{x_{ij}}$.\n- Slack bus: Bus $1$ is the slack bus with phase angle $\\theta_{1} = 0$.\n- Line flow definition: $f_{ij} = b_{ij}(\\theta_{i} - \\theta_{j})$ for orientation $i \\to j$. Orientations are given as $1 \\to 2$, $1 \\to 3$, and $2 \\to 3$.\n- Aggregation: Buses $2$ and $3$ are merged into an aggregated bus $A$.\n- Aggregated transfer: A unit injection at bus $1$ ($p_1 = 1$) and a unit withdrawal at bus $A$.\n- Withdrawal split: The withdrawal at bus $A$ is distributed as $p_{2} = -\\alpha$ and $p_{3} = -(1-\\alpha)$, where $0 \\leq \\alpha \\leq 1$.\n- Angle consistency constraint: $\\theta_{2} = \\theta_{3}$ is imposed.\n- Aggregated PTDF definition: The flow on line $(1,2)$ resulting from the unit transfer from bus $1$ to bus $A$ under the withdrawal split that enforces $\\theta_{2} = \\theta_{3}$.\n- Verification requirements: (1) The sum of flows $f_{12}$ and $f_{13}$ equals the unit transfer. (2) The aggregated PTDF equals the weighted sum $\\alpha \\cdot PTDF_{12, 12} + (1-\\alpha) \\cdot PTDF_{12, 13}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded (Critical)**: The problem is based on the Direct-Current (DC) power flow approximation, a standard and fundamental tool in power system analysis. The concept of network aggregation and Power Transfer Distribution Factors (PTDFs) are also well-established principles. All definitions and relationships are consistent with the accepted theory of power systems engineering.\n- **Well-Posed**: The problem provides a complete set of linear equations with a sufficient number of constraints to determine a unique solution for the unknown variables ($\\alpha$, $\\theta_2$, $\\theta_3$).\n- **Objective (Critical)**: The problem is stated using precise, standard terminology from power system engineering. The data is numerical and the objectives are quantitative. There are no subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined, self-contained, and scientifically sound exercise in power system analysis. The solution process may proceed.\n\n### Solution Derivation\nThe primary objective is to find the value of $\\alpha$ that satisfies the angle consistency constraint $\\theta_{2} = \\theta_{3}$, and then to compute the resulting aggregated Power Transfer Distribution Factor (PTDF) for the line $(1,2)$.\n\nFirst, we calculate the susceptances $b_{ij}$ from the given reactances $x_{ij}$. The values are assumed to be in per-unit.\n$b_{12} = \\frac{1}{x_{12}} = \\frac{1}{0.5} = 2$\n$b_{13} = \\frac{1}{x_{13}} = \\frac{1}{1} = 1$\n$b_{23} = \\frac{1}{x_{23}} = \\frac{1}{1} = 1$\n\nThe DC power flow equations are given by the matrix relationship $P = B\\theta$, where $P$ is the vector of net power injections, $\\theta$ is the vector of bus voltage angles, and $B$ is the susceptance matrix of the network. The elements of the $B$ matrix are:\n$B_{ii} = \\sum_{j \\neq i} b_{ij}$\n$B_{ij} = -b_{ij}$ for $i \\neq j$\n\nFor the given network, the full $B$ matrix is:\n$B_{11} = b_{12} + b_{13} = 2 + 1 = 3$\n$B_{22} = b_{12} + b_{23} = 2 + 1 = 3$\n$B_{33} = b_{13} + b_{23} = 1 + 1 = 2$\n$B_{12} = B_{21} = -b_{12} = -2$\n$B_{13} = B_{31} = -b_{13} = -1$\n$B_{23} = B_{32} = -b_{23} = -1$\n\nSo, the full susceptance matrix is:\n$$ B = \\begin{pmatrix} 3 & -2 & -1 \\\\ -2 & 3 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} $$\nSince bus $1$ is the slack bus with $\\theta_1 = 0$, we can write the reduced system of equations for the non-slack buses ($2$ and $3$):\n$$ \\begin{pmatrix} p_2 \\\\ p_3 \\end{pmatrix} = \\begin{pmatrix} B_{22} & B_{23} \\\\ B_{32} & B_{33} \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} $$\nThis is the system $P' = B'\\theta'$, where $P'$ is the vector of injections at non-slack buses and $B'$ is the reduced susceptance matrix.\nThe power injections are given as $p_2 = -\\alpha$ and $p_3 = -(1-\\alpha)$. The reduced system is:\n$$ \\begin{pmatrix} -\\alpha \\\\ -(1-\\alpha) \\end{pmatrix} = \\begin{pmatrix} 3 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} $$\nTo solve for the angles $\\theta_2$ and $\\theta_3$, we must find the inverse of the reduced matrix $B'$.\n$\\det(B') = (3)(2) - (-1)(-1) = 6 - 1 = 5$.\nThe inverse is $(B')^{-1} = \\frac{1}{5} \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}$.\n\nNow we can solve for the angles in terms of $\\alpha$:\n$$ \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = (B')^{-1} \\begin{pmatrix} p_2 \\\\ p_3 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix} \\begin{pmatrix} -\\alpha \\\\ -(1-\\alpha) \\end{pmatrix} $$\n$\\theta_2 = \\frac{1}{5} (2(-\\alpha) + 1(-(1-\\alpha))) = \\frac{1}{5} (-2\\alpha - 1 + \\alpha) = \\frac{1}{5} (-\\alpha - 1)$\n$\\theta_3 = \\frac{1}{5} (1(-\\alpha) + 3(-(1-\\alpha))) = \\frac{1}{5} (-\\alpha - 3 + 3\\alpha) = \\frac{1}{5} (2\\alpha - 3)$\n\nThe aggregation requires the physical constraint $\\theta_2 = \\theta_3$. We enforce this to find the unique value of $\\alpha$:\n$\\frac{1}{5} (-\\alpha - 1) = \\frac{1}{5} (2\\alpha - 3)$\n$-\\alpha - 1 = 2\\alpha - 3$\n$2 = 3\\alpha$\n$\\alpha = \\frac{2}{3}$\n\nWith this value of $\\alpha$, we can find the numerical values of the angles:\n$\\theta_2 = \\frac{1}{5} \\left(-\\frac{2}{3} - 1\\right) = \\frac{1}{5} \\left(-\\frac{5}{3}\\right) = -\\frac{1}{3}$\n$\\theta_3 = \\frac{1}{5} \\left(2\\left(\\frac{2}{3}\\right) - 3\\right) = \\frac{1}{5} \\left(\\frac{4}{3} - \\frac{9}{3}\\right) = \\frac{1}{5} \\left(-\\frac{5}{3}\\right) = -\\frac{1}{3}$\nThe angles are indeed equal, as required.\n\nThe aggregated PTDF for line $(1,2)$ with respect to the transfer from bus $1$ to the aggregated bus $A$ is the power flow $f_{12}$ under these conditions.\n$f_{12} = b_{12}(\\theta_1 - \\theta_2) = 2\\left(0 - \\left(-\\frac{1}{3}\\right)\\right) = 2\\left(\\frac{1}{3}\\right) = \\frac{2}{3}$.\nThus, the aggregated PTDF for line $(1,2)$ is $\\frac{2}{3}$.\n\nNext, we perform the two specified verifications.\n\n**Verification 1: Power Balance**\nWe must verify that the total flow out of the source bus $1$ equals the unit injection. The total flow is $f_{12} + f_{13}$.\nWe already have $f_{12} = \\frac{2}{3}$.\nWe calculate $f_{13} = b_{13}(\\theta_1 - \\theta_3) = 1\\left(0 - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{1}{3}$.\nThe total flow is $f_{12} + f_{13} = \\frac{2}{3} + \\frac{1}{3} = 1$. This matches the unit injection $p_1=1$ at bus $1$. The verification is successful.\n\n**Verification 2: Weighted Sum of Bus-level PTDFs**\nWe need to show that the aggregated PTDF equals $\\alpha \\cdot PTDF_{12, 12} + (1-\\alpha) \\cdot PTDF_{12, 13}$. First, we compute the individual bus-level PTDFs.\n\n$PTDF_{12, 12}$: This is the flow on line $(1,2)$ for a unit transfer from bus $1$ to bus $2$. The injections are $p_1=1$, $p_2=-1$, $p_3=0$.\n$\\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = (B')^{-1} \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix}$.\nSo, $\\theta_2 = -\\frac{2}{5}$.\nThe flow is $f_{12} = b_{12}(\\theta_1 - \\theta_2) = 2\\left(0 - \\left(-\\frac{2}{5}\\right)\\right) = \\frac{4}{5}$.\nTherefore, $PTDF_{12, 12} = \\frac{4}{5}$.\n\n$PTDF_{12, 13}$: This is the flow on line $(1,2)$ for a unit transfer from bus $1$ to bus $3$. The injections are $p_1=1$, $p_2=0$, $p_3=-1$.\n$\\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = (B')^{-1} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix}$.\nSo, $\\theta_2 = -\\frac{1}{5}$.\nThe flow is $f_{12} = b_{12}(\\theta_1 - \\theta_2) = 2\\left(0 - \\left(-\\frac{1}{5}\\right)\\right) = \\frac{2}{5}$.\nTherefore, $PTDF_{12, 13} = \\frac{2}{5}$.\n\nNow, we compute the weighted sum using $\\alpha = \\frac{2}{3}$ and $1-\\alpha = \\frac{1}{3}$:\nWeighted Sum = $\\alpha \\cdot PTDF_{12, 12} + (1-\\alpha) \\cdot PTDF_{12, 13}$\nWeighted Sum = $\\left(\\frac{2}{3}\\right) \\left(\\frac{4}{5}\\right) + \\left(\\frac{1}{3}\\right) \\left(\\frac{2}{5}\\right) = \\frac{8}{15} + \\frac{2}{15} = \\frac{10}{15} = \\frac{2}{3}$.\nThis value, $\\frac{2}{3}$, is identical to the aggregated PTDF calculated earlier. This verification is also successful.\n\nThe final answer is the value of the aggregated PTDF for line $(1,2)$.",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "Aggregation simplifies not just physical networks but also optimization problems like unit commitment, often by relaxing discrete decisions into continuous ones. This practice confronts a critical consequence of such an approach: the 'relaxation gap' between the computationally tractable aggregated model and the physically constrained reality. By constructing a case where the aggregated model is feasible but the original is not, you will quantify this discrepancy and analyze its profound operational implications for system operators. ",
            "id": "4133909",
            "problem": "Consider a single-period Unit Commitment (UC) setting with a cluster of identical thermal generating units. There are $N$ identical units, each characterized by a binary on/off decision and a minimum stable operating level. The original disjunctive per-unit feasible set for power output $p_i$ and commitment $u_i$ is\n$$\n\\mathcal{S} \\;=\\; \\{(u_i,p_i) \\,\\mid\\, u_i \\in \\{0,1\\},\\; p_i = 0 \\text{ if } u_i=0,\\; P^{\\min} \\le p_i \\le P^{\\max} \\text{ if } u_i=1\\}.\n$$\nPower balance must hold exactly, and there is no spillage and no load curtailment.\n\nNow aggregate the $N$ identical units into a single cluster and consider the standard convex aggregation in which the integer number of committed units is relaxed to a continuous quantity $y \\in [0,N]$, and the cluster output $p$ satisfies the convex envelope implied by the convex hull of $\\mathcal{S}$:\n$$\ny \\in [0,N], \\qquad y\\,P^{\\min} \\le p \\le y\\,P^{\\max}.\n$$\n\nYou are given the following data defining a specific instance:\n- Number of units $N = 3$,\n- Minimum and maximum outputs $P^{\\min} = 50$ MW and $P^{\\max} = 100$ MW,\n- Net load to be served exactly $D = 30$ MW.\n\nTasks:\n1) Using only the model definitions above, construct a feasible point for the aggregated convex relaxation that meets the load exactly, and justify why it is feasible in the aggregated model.\n2) Prove that the original disjunctive integer UC model is infeasible for the same data.\n3) Define the feasibility gap $G$ as the minimum absolute power-balance violation (in MW) achievable by the original disjunctive model when the exact power-balance equality is replaced by an absolute-mismatch objective, that is,\n$$\nG \\;:=\\; \\min_{\\substack{u_i \\in \\{0,1\\}\\\\ p_i}} \\left| \\sum_{i=1}^{N} p_i \\;-\\; D \\right| \\quad \\text{subject to } (u_i,p_i) \\in \\mathcal{S} \\text{ for all } i \\in \\{1,\\ldots,N\\}.\n$$\nCompute $G$ for the given data. State $G$ in MW and round your answer to four significant figures.\n\nFinally, briefly explain the operational implications of the computed $G$ in terms of what physical actions (if any) would be required to realize the aggregated-relaxation dispatch with the original physical units. Your final numerical answer must be the single value of $G$ only (in MW, rounded as instructed).",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of power systems engineering and optimization, well-posed with a clear and complete setup, and objective in its formulation. We can therefore proceed with a full solution.\n\nThe problem asks for three tasks to be completed based on the provided data for a unit commitment problem: $N=3$ identical units, each with a minimum output of $P^{\\min} = 50$ MW and a maximum output of $P^{\\max} = 100$ MW. The net load to be served is $D = 30$ MW.\n\n**Task 1: Feasibility of the Aggregated Convex Relaxation**\n\nThe aggregated convex relaxation model is defined by the variables $y$, representing the continuous number of committed units, and $p$, the total power output of the cluster. The constraints are:\n$$(1) \\quad y \\in [0, N]$$\n$$(2) \\quad y P^{\\min} \\le p \\le y P^{\\max}$$\nWe are given $N=3$, $P^{\\min}=50$, and $P^{\\max}=100$. The model must also satisfy the power balance equation, which requires the total output to be equal to the load:\n$$(3) \\quad p = D$$\nGiven $D=30$, we need to find a value of $y$ that satisfies all constraints. Substituting $p=D=30$ into inequality $(2)$, we get:\n$$y \\times 50 \\le 30 \\le y \\times 100$$\nThis compound inequality can be separated into two parts:\n$$y \\times 50 \\le 30 \\implies y \\le \\frac{30}{50} \\implies y \\le 0.6$$\n$$30 \\le y \\times 100 \\implies y \\ge \\frac{30}{100} \\implies y \\ge 0.3$$\nSo, we must find a $y$ that satisfies $0.3 \\le y \\le 0.6$. We must also satisfy constraint $(1)$, which is $y \\in [0, 3]$. The interval $[0.3, 0.6]$ is a subset of $[0, 3]$, so any $y$ in $[0.3, 0.6]$ is valid.\n\nTo construct a feasible point, we can choose any value for $y$ in this range, for example, $y=0.4$. This gives the point $(y,p) = (0.4, 30)$.\nThis point is feasible in the aggregated model because:\n1.  The power output $p=30$ MW exactly meets the load $D=30$ MW.\n2.  The continuous commitment variable $y=0.4$ is within its allowed bounds, since $0 \\le 0.4 \\le 3$.\n3.  The generation inequality is satisfied: $y P^{\\min} \\le p \\le y P^{\\max}$ becomes $0.4 \\times 50 \\le 30 \\le 0.4 \\times 100$, which simplifies to $20 \\le 30 \\le 40$. This is a true statement.\nThus, a feasible point exists for the aggregated convex relaxation.\n\n**Task 2: Infeasibility of the Original Disjunctive Model**\n\nThe original disjunctive model requires the number of committed units, $n_{on} = \\sum_{i=1}^{3} u_i$, to be an integer, where $u_i \\in \\{0, 1\\}$. The total power output $P_{total} = \\sum_{i=1}^{3} p_i$ must equal the load $D=30$ MW. Each active unit $i$ (with $u_i=1$) must produce power $p_i$ in the range $[P^{\\min}, P^{\\max}]$, i.e., $[50, 100]$.\n\nLet's analyze the possible feasible total power outputs based on the integer number of committed units, $n_{on} \\in \\{0, 1, 2, 3\\}$.\n-   If $n_{on} = 0$: All units are off ($u_i=0$ for all $i$), so $p_i=0$ for all $i$. The total power output is $P_{total} = 0$ MW. This does not equal the load $D=30$ MW.\n-   If $n_{on} = 1$: One unit is on. Its power output $p_1$ must be in the range $[50, 100]$. The total power $P_{total} = p_1$ is therefore also in the range $[50, 100]$ MW. The required load $D=30$ MW is outside this range.\n-   If $n_{on} = 2$: Two units are on. The total power output $P_{total} = p_1 + p_2$ must be in the range $[2 \\times P^{\\min}, 2 \\times P^{\\max}]$, which is $[2 \\times 50, 2 \\times 100] = [100, 200]$ MW. The required load $D=30$ MW is outside this range.\n-   If $n_{on} = 3$: Three units are on. The total power output $P_{total} = p_1 + p_2 + p_3$ must be in the range $[3 \\times P^{\\min}, 3 \\times P^{\\max}]$, which is $[3 \\times 50, 3 \\times 100] = [150, 300]$ MW. The required load $D=30$ MW is outside this range.\n\nSince for every possible integer number of committed units, the range of achievable total power output does not include $D=30$ MW, it is impossible to satisfy the power balance constraint. Therefore, the original disjunctive integer UC model is infeasible for the given data.\n\n**Task 3: Computation of the Feasibility Gap $G$**\n\nThe feasibility gap $G$ is defined as the minimum possible absolute power-balance violation for the original disjunctive model:\n$$G = \\min_{\\substack{u_i \\in \\{0,1\\}\\\\ p_i}} \\left| \\sum_{i=1}^{N} p_i - D \\right| \\quad \\text{subject to } (u_i,p_i) \\in \\mathcal{S}$$\nWe need to find the feasible total power output $P_{total} = \\sum p_i$ that is closest to the load $D=30$ MW. The set of all possible values for $P_{total}$ is the union of the ranges we found in Task 2:\n$$\\text{Feasible } P_{total} \\in \\{0\\} \\cup [50, 100] \\cup [100, 200] \\cup [150, 300]$$\nThis simplifies to the set $\\{0\\} \\cup [50, 300]$. We want to find the point in this set that minimizes the distance to $30$.\n\nWe evaluate the distance for the two disjoint parts of the set:\n1.  For the point $P_{total}=0$, the mismatch is $|0 - 30| = 30$.\n2.  For the interval $P_{total} \\in [50, 300]$, the point closest to $30$ is the lower bound of the interval, which is $50$. The mismatch is $|50 - 30| = 20$.\n\nComparing the two minimum mismatches, $\\min(30, 20) = 20$.\nTherefore, the feasibility gap is $G = 20$ MW. Rounding to four significant figures gives $20.00$.\n\n**Operational Implications**\n\nThe existence of a feasible solution for the aggregated relaxation but not for the original integer model highlights the \"relaxation gap\". The aggregated model, often used for economic dispatch due to its convexity and computational tractability, produces a solution $(y,p)=(0.4, 30)$ that is economically desirable (serves the load exactly) but physically unrealizable with the given discrete units.\n\nThe feasibility gap $G=20$ MW quantifies the minimum extent to which physical reality must deviate from the relaxed model's target. The closest physically achievable dispatch to serving the $30$ MW load is to commit one unit and run it at its minimum stable level of $P^{\\min}=50$ MW. This results in a power surplus of $50 - 30 = 20$ MW, which is exactly the value of $G$.\n\nThe operational implication is that to realize the economic outcome suggested by the aggregated model (i.e., perfectly serving the $30$ MW load), the system operator would have to take additional physical actions not captured in the simple UC model. These actions must manage the $20$ MW of over-generation. This could involve:\n-   **Energy Curtailment:** Intentionally wasting or \"spilling\" the excess $20$ MW of power.\n-   **Energy Storage:** Directing the excess $20$ MW to an energy storage system, like a battery or pumped hydro.\n-   **Ancillary Services:** Using other resources on the grid, such as fast-ramping generators or demand-side response, to absorb the surplus.\n\nIn essence, the feasibility gap $G$ represents the minimum amount of corrective action (in MW) required from ancillary services or other out-of-model mechanisms to bridge the discrepancy between the continuous, economically-optimal relaxation and the discrete, physically-constrained reality.",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "Having explored the mechanics and consequences of aggregation, we now turn to the question of how to form the clusters in the first place. This practice introduces spectral clustering, a powerful graph-theoretic method for identifying natural 'communities' of nodes based on their interconnection patterns. You will implement the algorithm using the graph Laplacian's Fiedler vector to partition a network and then evaluate the quality of the resulting clusters, providing a foundational skill for creating meaningful model aggregations. ",
            "id": "4133839",
            "problem": "Consider a weighted, undirected graph representing an energy systems model with $5$ sites (nodes) where the edge weights encode dimensionless similarity in the interval $[0,1]$ (for example, correlation of net-load time series or normalized interconnection strengths). Let $W \\in \\mathbb{R}^{5 \\times 5}$ be the symmetric adjacency matrix with zero diagonal, where $w_{ij} = w_{ji} \\in [0,1]$ and $w_{ii} = 0$. Define the degree matrix $D \\in \\mathbb{R}^{5 \\times 5}$ as diagonal with entries $d_i = \\sum_{j=1}^{5} w_{ij}$ and the (unnormalized) graph Laplacian $L = D - W$. The spectral bipartition is constructed by computing the Fiedler vector, which is the eigenvector $v \\in \\mathbb{R}^{5}$ associated with the smallest strictly positive eigenvalue of $L$ (the algebraic connectivity), and then thresholding its entries to form two clusters. Specifically, impose the sign-based rule: assign node $i$ to cluster $C_{+}$ if $v_i > 0$, to cluster $C_{-}$ if $v_i < 0$, and if $v_i = 0$, assign node $i$ to the cluster (either $C_{+}$ or $C_{-}$) that yields the larger total similarity weight from node $i$ to that cluster; if the totals are equal, assign node $i$ to $C_{+}$. If the Fiedler vector has entries of only one sign (for example, all nonnegative), use the median value of $v$ as the threshold to enforce a bipartition: assign node $i$ to $C_{+}$ if $v_i$ is strictly greater than the median and to $C_{-}$ otherwise.\n\nTo verify cluster cohesion in the context of unit aggregation, define for any nonempty cluster $C \\subset \\{1,2,3,4,5\\}$:\n- the intra-cluster average similarity\n$$\n\\bar{w}_{\\mathrm{intra}}(C) = \\begin{cases}\n\\frac{1}{|C|(|C|-1)/2} \\sum_{\\substack{i,j \\in C \\\\ i<j}} w_{ij}, & \\text{if } |C| \\geq 2,\\\\\n0, & \\text{if } |C| = 1,\n\\end{cases}\n$$\n- and the inter-cluster average similarity\n$$\n\\bar{w}_{\\mathrm{inter}}(C) = \\begin{cases}\n\\frac{1}{|C|\\,(5-|C|)} \\sum_{i \\in C} \\sum_{j \\in C^{c}} w_{ij}, & \\text{if } |C| \\in \\{1,2,3,4\\},\\\\\n0, & \\text{if } |C| = 5,\n\\end{cases}\n$$\nwhere $C^{c}$ denotes the complement of $C$ in $\\{1,2,3,4,5\\}$. A bipartition $\\{C_{+}, C_{-}\\}$ is declared cohesive if both clusters satisfy $\\bar{w}_{\\mathrm{intra}}(C) > \\bar{w}_{\\mathrm{inter}}(C)$ with strict inequality.\n\nStarting from the fundamental base that the Laplacian $L$ is symmetric positive semidefinite, its eigenvalues are real and nonnegative, and the number of zero eigenvalues equals the number of connected components, the Fiedler vector arises from the continuous relaxation of the discrete cut optimization through the Rayleigh quotient, which under orthogonality to the all-ones vector $1$ and normalization of $v$ identifies the second smallest eigenpair.\n\nYour task is to implement the spectral bipartition using the Fiedler vector for the following test suite of three adjacency matrices $W$ (each is of size $5 \\times 5$), construct the two clusters by thresholding, and verify cohesion as defined above. For each matrix, output a single boolean indicating whether the resulting bipartition is cohesive.\n\nTest suite:\n- Case $1$ (clear two-community structure; happy path):\n$$\nW^{(1)} = \\begin{bmatrix}\n0 & 0.9 & 0.9 & 0.05 & 0.05 \\\\\n0.9 & 0 & 0.9 & 0.05 & 0.05 \\\\\n0.9 & 0.9 & 0 & 0.05 & 0.05 \\\\\n0.05 & 0.05 & 0.05 & 0 & 0.8 \\\\\n0.05 & 0.05 & 0.05 & 0.8 & 0\n\\end{bmatrix}.\n$$\n- Case $2$ (nearly disconnected components; boundary condition):\n$$\nW^{(2)} = \\begin{bmatrix}\n0 & 0.7 & 0.01 & 0 & 0 \\\\\n0.7 & 0 & 0.01 & 0 & 0 \\\\\n0.01 & 0.01 & 0 & 0.6 & 0.6 \\\\\n0 & 0 & 0.6 & 0 & 0.6 \\\\\n0 & 0 & 0.6 & 0.6 & 0\n\\end{bmatrix}.\n$$\n- Case $3$ (uniform complete graph; edge case with ambiguous cut):\n$$\nW^{(3)} = \\begin{bmatrix}\n0 & 0.5 & 0.5 & 0.5 & 0.5 \\\\\n0.5 & 0 & 0.5 & 0.5 & 0.5 \\\\\n0.5 & 0.5 & 0 & 0.5 & 0.5 \\\\\n0.5 & 0.5 & 0.5 & 0 & 0.5 \\\\\n0.5 & 0.5 & 0.5 & 0.5 & 0\n\\end{bmatrix}.\n$$\n\nAlgorithmic requirements:\n- Construct $D$ and $L$ for each case.\n- Compute the eigenvalues and eigenvectors of $L$ and select the eigenvector associated with the smallest eigenvalue strictly greater than a tolerance (for example, $10^{-12}$) as the Fiedler vector. If no eigenvalue exceeds the tolerance, use the eigenvector associated with the second smallest eigenvalue by index.\n- Apply the thresholding rule described above to form $C_{+}$ and $C_{-}$.\n- Compute $\\bar{w}_{\\mathrm{intra}}(C_{+})$, $\\bar{w}_{\\mathrm{inter}}(C_{+})$, $\\bar{w}_{\\mathrm{intra}}(C_{-})$, and $\\bar{w}_{\\mathrm{inter}}(C_{-})$, and evaluate the cohesion condition for each cluster.\n- Produce a final boolean per case indicating whether both clusters are cohesive (true) or not (false).\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result\\_1,result\\_2,result\\_3]$), where each $result\\_k$ is either $True$ or $False$ corresponding to Case $k$ in the test suite.",
            "solution": "The problem requires the implementation and evaluation of a spectral bipartitioning algorithm on three given graphs, represented by their similarity weight matrices $W$. The core of the method lies in spectral graph theory, which uses the eigensystem of the graph Laplacian to reveal structural properties of the graph.\n\nFirst, we define the necessary graph-theoretic matrices for a graph with $n=5$ nodes and a symmetric adjacency (weight) matrix $W \\in \\mathbb{R}^{5 \\times 5}$ with entries $w_{ij}$ and $w_{ii}=0$.\n\nThe degree matrix $D$ is a diagonal matrix where each diagonal entry $d_i$ is the sum of weights of all edges connected to node $i$:\n$$\nd_i = \\sum_{j=1}^{5} w_{ij}\n$$\nThe unnormalized graph Laplacian $L$ is then defined as:\n$$\nL = D - W\n$$\nThe Laplacian matrix $L$ is symmetric and positive semidefinite. For a connected graph, its smallest eigenvalue is $\\lambda_1 = 0$, with a corresponding eigenvector proportional to the all-ones vector, $\\mathbf{1} = [1, 1, 1, 1, 1]^T$.\n\nThe key to spectral partitioning is the second smallest eigenvalue of $L$, denoted $\\lambda_2$, also known as the algebraic connectivity of the graph. The corresponding eigenvector, $v$, is called the Fiedler vector. The Fiedler vector provides a continuous relaxation to the discrete problem of finding a bipartition of the graph's nodes that minimizes the weight of edges between the two partitions (the min-cut problem). We can obtain a discrete partition by thresholding the components of the Fiedler vector.\n\nThe partitioning procedure is as follows:\n1.  Compute the eigenvalues and eigenvectors of $L$. Since $L$ is symmetric, we use a numerical method like the Lanczos algorithm (as implemented in `scipy.linalg.eigh`) which guarantees real eigenvalues and a set of orthonormal eigenvectors. The eigenvalues are sorted in non-decreasing order: $\\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_5$.\n2.  The Fiedler vector $v$ is the eigenvector corresponding to $\\lambda_2$. For a connected graph, $\\lambda_1 \\approx 0$ and $\\lambda_2 > 0$. The eigenvector corresponding to $\\lambda_1$ is orthogonal to all other eigenvectors, including the Fiedler vector $v$. This implies $\\mathbf{1}^T v = \\sum_i v_i = 0$, ensuring that $v$ has both positive and negative components (unless $v$ is the zero vector, which is not the case for a non-trivial graph).\n3.  The primary partitioning rule is sign-based. Nodes are assigned to clusters $C_{+}$ and $C_{-}$ based on the sign of their corresponding component in $v$:\n    - Node $i$ is assigned to $C_{+}$ if $v_i > 0$.\n    - Node $i$ is assigned to $C_{-}$ if $v_i < 0$.\n4.  If any component $v_i$ is zero (or numerically close to zero), a tie-breaking rule is applied. The node $i$ is assigned to the cluster to which it has a greater total similarity. The total similarity to a preliminary cluster $C$ is $\\sum_{j \\in C} w_{ij}$. If these sums are equal, the node is assigned to $C_{+}$.\n5.  A fallback rule is specified for the case where the Fiedler vector has entries of only one sign (e.g., all non-negative). In this scenario, the median of the vector's components is used as the threshold: nodes with values strictly greater than the median form one cluster, and the rest form the other. As noted, for a connected graph, this case will not occur.\n\nOnce the bipartition $\\{C_{+}, C_{-}\\}$ is formed, its quality is assessed using cohesion metrics. For any cluster $C$, we define:\n-   $\\bar{w}_{\\mathrm{intra}}(C)$: The average similarity between distinct pairs of nodes within the cluster. A high value signifies a tightly connected cluster. Its formula is $\\frac{1}{|C|(|C|-1)/2} \\sum_{i,j \\in C, i<j} w_{ij}$ for $|C| \\ge 2$, and $0$ for $|C|=1$.\n-   $\\bar{w}_{\\mathrm{inter}}(C)$: The average similarity between nodes in $C$ and nodes in its complement $C^c$. A low value signifies good separation from the rest of the graph. Its formula is $\\frac{1}{|C|\\,|C^c|} \\sum_{i \\in C, j \\in C^c} w_{ij}$ for $1 \\le |C| \\le 4$, and $0$ otherwise.\n\nA bipartition is declared \"cohesive\" if and only if for both clusters, the intra-cluster average similarity is strictly greater than the inter-cluster average similarity: $\\bar{w}_{\\mathrm{intra}}(C) > \\bar{w}_{\\mathrm{inter}}(C)$.\n\nThis procedure is applied to each of the three test cases.\n\n**Case 1:** The matrix $W^{(1)}$ represents a graph with two clear communities: $\\{1,2,3\\}$ and $\\{4,5\\}$.\n- The Laplacian $L^{(1)}$ is constructed.\n- The Fiedler vector is computed. Its components for nodes $\\{1,2,3\\}$ have one sign, and for nodes $\\{4,5\\}$ have the opposite sign. This yields the partition $C_1=\\{1,2,3\\}$ and $C_2=\\{4,5\\}$.\n- For $C_1$: $\\bar{w}_{\\mathrm{intra}}(C_1) = \\frac{0.9+0.9+0.9}{3} = 0.9$. $\\bar{w}_{\\mathrm{inter}}(C_1) = \\frac{6 \\times 0.05}{3 \\times 2} = 0.05$. The condition $0.9 > 0.05$ holds.\n- For $C_2$: $\\bar{w}_{\\mathrm{intra}}(C_2) = \\frac{0.8}{1} = 0.8$. $\\bar{w}_{\\mathrm{inter}}(C_2) = \\frac{6 \\times 0.05}{2 \\times 3} = 0.05$. The condition $0.8 > 0.05$ holds.\nBoth clusters are cohesive, so the result is True.\n\n**Case 2:** The matrix $W^{(2)}$ represents a graph with two nearly disconnected communities, linked by weak ties.\n- The Fiedler vector correctly separates the nodes into $C_1=\\{1,2\\}$ and $C_2=\\{3,4,5\\}$.\n- For $C_1$: $\\bar{w}_{\\mathrm{intra}}(C_1) = 0.7$. $\\bar{w}_{\\mathrm{inter}}(C_1) = \\frac{0.01+0.01}{2 \\times 3} \\approx 0.0033$. The condition $0.7 > 0.0033$ holds.\n- For $C_2$: $\\bar{w}_{\\mathrm{intra}}(C_2) = \\frac{0.6+0.6+0.6}{3} = 0.6$. $\\bar{w}_{\\mathrm{inter}}(C_2) \\approx 0.0033$. The condition $0.6 > 0.0033$ holds.\nBoth clusters are cohesive, so the result is True.\n\n**Case 3:** The matrix $W^{(3)}$ represents a complete graph with uniform edge weights. There is no natural bipartition.\n- The Laplacian $L^{(3)}$ has one eigenvalue at $0$ and a repeated eigenvalue $\\lambda_2=\\lambda_3=\\lambda_4=\\lambda_5 = 2.5$. The Fiedler vector is not unique; any vector in the eigenspace of $\\lambda=2.5$ is a valid choice. The numerically computed eigenvector partitions the graph into $C_1=\\{i\\}$ and $C_2=\\{1,..,5\\}\\setminus\\{i\\}$ for some node $i$. Let's assume the partition is $C_1=\\{1\\}$, $C_2=\\{2,3,4,5\\}$.\n- For $C_1$: $|C_1|=1$, so $\\bar{w}_{\\mathrm{intra}}(C_1)=0$. The inter-cluster similarity is $\\bar{w}_{\\mathrm{inter}}(C_1) = \\frac{4 \\times 0.5}{1 \\times 4} = 0.5$. The condition $0 > 0.5$ is false.\nThe bipartition is not cohesive. The result is False.",
            "answer": "$$\\boxed{\\text{[True, True, False]}}$$"
        }
    ]
}