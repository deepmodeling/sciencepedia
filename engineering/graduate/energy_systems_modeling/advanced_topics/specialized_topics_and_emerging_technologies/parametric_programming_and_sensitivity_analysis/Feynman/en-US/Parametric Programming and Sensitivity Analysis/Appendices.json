{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on practice by exploring how a parameter in the objective function can alter an optimal solution. This exercise  uses the highly relevant context of a carbon price to demonstrate how the economic merit order of power generators can switch. By deriving the switching point from first principles, you will gain a fundamental understanding of basis changes and how to use the envelope theorem to assess the cost sensitivity at these critical junctures.",
            "id": "4110397",
            "problem": "Consider a single-period economic dispatch of two thermal generators over a one-hour interval in an electricity system with inelastic demand. Generator $1$ has variable operating cost excluding carbon of $c_1$ in dollars per megawatt-hour, direct carbon dioxide emission intensity $\\tau_1$ in metric tons of carbon dioxide per megawatt-hour, and nameplate capacity $U_1$ in megawatts. Generator $2$ has corresponding parameters $c_2$, $\\tau_2$, and $U_2$. A uniform carbon price $p$ in dollars per metric ton of carbon dioxide applies to all emitters. The system operator minimizes total variable operating cost inclusive of carbon costs to meet an inelastic demand $D$ in megawatts over the one-hour period, assuming non-negativity and capacity limits for each generator. The decision variables are the dispatch levels $x_1$ and $x_2$ in megawatts, representing the average power output over the hour.\n\nThe dispatch problem is formulated as the following optimization problem:\n- Decision variables: $x_1, x_2$.\n- Objective: minimize the total generation cost over the one-hour interval, inclusive of carbon pricing.\n- Constraints: meet demand and respect generator capacities.\n\nUse only fundamental principles of linear optimization and parametric sensitivity. In particular, start from first principles by writing the appropriate linear program, and derive conditions for optimality using the Karush-Kuhn-Tucker (KKT) conditions, dual feasibility, and complementary slackness. Then use these to determine how the optimal basis changes as the carbon price parameter $p$ varies. Lastly, use the envelope theorem and duality to compute the sensitivity of the minimum cost with respect to $p$.\n\nAssume the following parameter values:\n- $c_1 = 21$ dollars per megawatt-hour, $\\tau_1 = 0.88$ metric tons of carbon dioxide per megawatt-hour, and $U_1 = 500$ megawatts.\n- $c_2 = 36$ dollars per megawatt-hour, $\\tau_2 = 0.39$ metric tons of carbon dioxide per megawatt-hour, and $U_2 = 500$ megawatts.\n- Demand $D = 320$ megawatts over the one-hour interval.\n\nTasks:\n1. Derive, from first principles, the parametric carbon price value $p$ at which the dispatch order between the two generators switches. You must identify this switching value starting from the linear program and its optimality conditions, not by invoking any pre-stated specialized formulas.\n2. Using rigorous sensitivity analysis of the optimal value with respect to the parameter $p$, determine the right-hand derivative at the switching carbon price of the minimum total generation cost with respect to $p$.\n\nAnswer specification:\n- Express the switching carbon price in dollars per metric ton of carbon dioxide.\n- Express the right-hand derivative at the switching point in metric tons of carbon dioxide per hour.\n- Round both quantities to four significant figures.\n- The final answer must be presented as two numbers in a single row in the order: switching carbon price, right-hand derivative.",
            "solution": "The economic dispatch problem is a linear program (LP) that seeks to minimize the total generation cost subject to meeting demand and respecting operational constraints. The decision variables are the dispatch levels $x_1$ and $x_2$ for the two generators.\n\nThe total cost for generator $i$ over the one-hour interval, inclusive of the carbon price $p$, is the sum of its fuel cost and its carbon cost. The marginal cost of generation, which includes the carbon cost, is given by $mc_i(p) = c_i + p \\tau_i$. The objective function is to minimize the total system cost, which is the sum of costs from both generators.\n\nThe LP is formulated as:\n$$\n\\min_{x_1, x_2} C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2\n$$\nsubject to:\n\\begin{align*}\n    x_1 + x_2 &= D & (\\text{dual variable: } \\lambda) \\\\\n    x_1 &\\ge 0 & (\\text{dual variable: } \\mu_1) \\\\\n    x_2 &\\ge 0 & (\\text{dual variable: } \\mu_2) \\\\\n    x_1 &\\le U_1 & (\\text{dual variable: } \\gamma_1) \\\\\n    x_2 &\\le U_2 & (\\text{dual variable: } \\gamma_2)\n\\end{align*}\nThe problem is to find the value of the parameter $p$ at which the optimal basis changes, and the sensitivity of the optimal cost to $p$ at this point.\n\nTask 1: Derive the switching carbon price.\nThe dispatch order, or merit order, is determined by the marginal costs $mc_1(p)$ and $mc_2(p)$. The generator with the lower marginal cost is dispatched first. A switch in the dispatch order occurs when the marginal costs become equal. We will formally derive this condition using the Karush-Kuhn-Tucker (KKT) conditions.\n\nFirst, we rewrite the constraints in the standard form $g_j(x) \\le 0$:\n$h_1(x) = x_1 + x_2 - D = 0$\n$g_1(x) = -x_1 \\le 0$\n$g_2(x) = -x_2 \\le 0$\n$g_3(x) = x_1 - U_1 \\le 0$\n$g_4(x) = x_2 - U_2 \\le 0$\n\nThe Lagrangian is:\n$L(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\gamma_1, \\gamma_2) = (c_1+p\\tau_1)x_1 + (c_2+p\\tau_2)x_2 + \\lambda(x_1+x_2-D) + \\mu_1(-x_1) + \\mu_2(-x_2) + \\gamma_1(x_1-U_1) + \\gamma_2(x_2-U_2)$,\nwhere the dual variables for inequality constraints must be non-negative: $\\mu_1, \\mu_2, \\gamma_1, \\gamma_2 \\ge 0$.\n\nThe KKT stationarity conditions are $\\frac{\\partial L}{\\partial x_1} = 0$ and $\\frac{\\partial L}{\\partial x_2} = 0$:\n\\begin{align*}\n    c_1 + p\\tau_1 + \\lambda - \\mu_1 + \\gamma_1 &= 0 \\quad (1) \\\\\n    c_2 + p\\tau_2 + \\lambda - \\mu_2 + \\gamma_2 &= 0 \\quad (2)\n\\end{align*}\nComplementary slackness conditions are $\\mu_1 x_1 = 0$, $\\mu_2 x_2 = 0$, $\\gamma_1(x_1 - U_1) = 0$, and $\\gamma_2(x_2 - U_2) = 0$.\n\nThe demand is $D = 320\\text{ MW}$, which is less than either generator's capacity ($U_1 = 500\\text{ MW}$, $U_2 = 500\\text{ MW}$). Thus, one generator can satisfy the entire demand. The optimal solution will be a corner solution where one generator produces $D$ and the other produces $0$, unless their marginal costs are equal.\n\nCase A: Generator 1 serves the entire demand.\nThe proposed solution is $x_1^* = D$ and $x_2^* = 0$.\nSince $D > 0$ and $D < U_1$, we have $x_1^* > 0$ and $x_1^* < U_1$. Complementary slackness implies $\\mu_1 = 0$ and $\\gamma_1 = 0$.\nSince $x_2^* = 0$, $\\mu_2 \\ge 0$. Since $x_2^* < U_2$, $\\gamma_2=0$.\nSubstituting these into the stationarity equations:\nFrom $(1)$: $c_1 + p\\tau_1 + \\lambda = 0 \\implies \\lambda = -(c_1 + p\\tau_1)$.\nFrom $(2)$: $c_2 + p\\tau_2 + \\lambda - \\mu_2 = 0$.\nSubstituting $\\lambda$: $c_2 + p\\tau_2 - (c_1 + p\\tau_1) - \\mu_2 = 0 \\implies \\mu_2 = (c_2 + p\\tau_2) - (c_1 + p\\tau_1)$.\nFor this solution to be optimal, dual feasibility requires $\\mu_2 \\ge 0$. This implies $c_2 + p\\tau_2 \\ge c_1 + p\\tau_1$.\nThis confirms that Generator $1$ is dispatched when its marginal cost is less than or equal to that of Generator $2$.\n\nCase B: Generator 2 serves the entire demand.\nThe proposed solution is $x_1^* = 0$ and $x_2^* = D$.\nBy symmetric reasoning, complementary slackness implies $\\mu_1 \\ge 0, \\gamma_1 = 0, \\mu_2 = 0, \\gamma_2 = 0$.\nSubstituting into stationarity equations:\nFrom $(2)$: $c_2 + p\\tau_2 + \\lambda = 0 \\implies \\lambda = -(c_2 + p\\tau_2)$.\nFrom $(1)$: $c_1 + p\\tau_1 + \\lambda - \\mu_1 = 0$.\nSubstituting $\\lambda$: $c_1 + p\\tau_1 - (c_2 + p\\tau_2) - \\mu_1 = 0 \\implies \\mu_1 = (c_1 + p\\tau_1) - (c_2 + p\\tau_2)$.\nFor this solution to be optimal, dual feasibility requires $\\mu_1 \\ge 0$. This implies $c_1 + p\\tau_1 \\ge c_2 + p\\tau_2$.\nThis confirms that Generator $2$ is dispatched when its marginal cost is less than or equal to that of Generator $1$.\n\nThe switch in dispatch order occurs when the condition for optimality switches from one case to the other. This happens at the boundary where both conditions hold, which is when the marginal costs are equal:\n$$c_1 + p_{\\text{switch}}\\tau_1 = c_2 + p_{\\text{switch}}\\tau_2$$\nSolving for $p_{\\text{switch}}$:\n$$p_{\\text{switch}}(\\tau_1 - \\tau_2) = c_2 - c_1$$\n$$p_{\\text{switch}} = \\frac{c_2 - c_1}{\\tau_1 - \\tau_2}$$\nUsing the given values: $c_1=21$, $c_2=36$, $\\tau_1=0.88$, $\\tau_2=0.39$.\n$$p_{\\text{switch}} = \\frac{36 - 21}{0.88 - 0.39} = \\frac{15}{0.49} \\approx 30.61224\\dots$$\nRounded to four significant figures, the switching price is $30.61$ dollars per metric ton of $\\text{CO}_2$.\n\nTask 2: Right-hand derivative of the minimum cost.\nLet $C^*(p)$ be the minimum total cost as a function of the carbon price $p$. We need to calculate the right-hand derivative $\\frac{dC^*(p)}{dp^+}|_{p=p_{\\text{switch}}}$.\nThe problem requires using the envelope theorem. For a parameterized minimization problem $V(\\theta) = \\min_x F(x, \\theta)$, the theorem states that $\\frac{dV}{d\\theta} = \\frac{\\partial L}{\\partial \\theta}|_{x=x^*(\\theta)}$, where $L$ is the Lagrangian and $x^*(\\theta)$ is the optimal solution. When the parameter only appears in the objective function, this simplifies to $\\frac{dV}{d\\theta} = \\frac{\\partial F}{\\partial \\theta}|_{x=x^*(\\theta)}$.\n\nOur objective function is $C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2$.\nThe partial derivative with respect to $p$ is:\n$$\\frac{\\partial C}{\\partial p} = \\tau_1 x_1 + \\tau_2 x_2$$\nBy the envelope theorem, the sensitivity of the optimal cost to the carbon price is:\n$$\\frac{dC^*(p)}{dp} = \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p)$$\nThis expression represents the total carbon emissions (in metric tons per hour) of the optimal dispatch.\n\nTo find the right-hand derivative at $p = p_{\\text{switch}}$, we need to evaluate this expression using the optimal solution $x^*(p)$ that holds for $p > p_{\\text{switch}}$.\nLet's analyze the marginal costs for $p > p_{\\text{switch}}$.\nWith $c_1=21$, $c_2=36$, $\\tau_1=0.88$, $\\tau_2=0.39$, we have $c_2 > c_1$ and $\\tau_1 > \\tau_2$. This means Generator $1$ has a lower non-carbon cost but a higher emissions intensity. As the carbon price $p$ increases, the marginal cost of Generator $1$ rises faster than that of Generator $2$.\nFor $p < p_{\\text{switch}}$, $mc_1(p) < mc_2(p)$.\nFor $p > p_{\\text{switch}}$, $mc_1(p) > mc_2(p)$.\nThus, for any $p$ just to the right of $p_{\\text{switch}}$, Generator $2$ is the cheaper one. The optimal dispatch is to use Generator $2$ to meet the entire demand:\n$$x_1^*(p) = 0, \\quad x_2^*(p) = D = 320$$\nThe right-hand derivative is therefore:\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = \\lim_{p\\to p_{\\text{switch}}^+} \\left( \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p) \\right) = \\tau_1 (0) + \\tau_2 (D) = \\tau_2 D\n$$\nSubstituting the numerical values:\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = 0.39 \\frac{\\text{tCO}_2}{\\text{MWh}} \\times 320 \\text{ MW} = 124.8 \\frac{\\text{tCO}_2}{\\text{h}}\n$$\nThis value has four significant figures.\n\nThe results are:\nSwitching carbon price: $p_{\\text{switch}} = 30.61$ \\$/tCO$_2$.\nRight-hand derivative of minimum cost: $\\frac{dC^*}{dp^+} = 124.8$ tCO$_2$/h.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.61 & 124.8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having examined perturbations in the objective function, we now turn our attention to the right-hand side (RHS) of the constraints. This problem  challenges you to determine the feasibility range of a given dispatch plan as system demand, represented by a parameter $p$, increases. This is a core skill in sensitivity analysis, as it allows modelers to quantify the robustness of an operational plan without re-solving the entire optimization problem.",
            "id": "4110403",
            "problem": "Consider a simplified Linear Programming (LP) model of an electric power system with three thermal generators, where the current basis consists of the generator output variables $x_1$, $x_2$, and $x_3$. The basic variables are determined by three aggregated nodal-balance constraints. The coefficient submatrix of the constraint matrix corresponding to this basis is\n$$\nB \\;=\\;\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n1 & 1 & 0 \\\\\n0 & 1 & 1\n\\end{pmatrix},\n$$\nand the Right-Hand Side (RHS) vector of the constraints depends on a scalar demand parameter $p \\ge 0$ as\n$$\nb(p) \\;=\\; b_0 + p\\,d,\n\\quad\nb_0 \\;=\\; \\begin{pmatrix} 200 \\\\ 350 \\\\ 300 \\end{pmatrix},\n\\quad\nd \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\nAssume $B$ is nonsingular and the current basic solution is feasible at $p=0$. The basic variables must remain nonnegative for feasibility, and the nonbasic variables are held at zero. The scalar parameter $p$ represents an incremental net demand increase in the second aggregated zone. Determine the maximal value of $p$ such that the basic solution associated with the fixed basis remains feasible, and identify which basic variable first violates nonnegativity as $p$ increases from $0$.\n\nExpress the maximal allowable increase in the demand parameter in megawatts (MW). Round your answer to four significant figures. Your final output must include both the maximal value of $p$ and the index $i \\in \\{1,2,3\\}$ of the basic variable $x_i$ that first violates nonnegativity, in that order.",
            "solution": "The problem asks for the maximal value of the parameter $p$ for which the basic solution $x_B$ remains feasible (i.e., non-negative). The basic solution is given by the formula $x_B(p) = B^{-1} b(p)$.\n\nFirst, we compute the inverse of the basis matrix $B$:\n$$\nB = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n1 & 1 & 0 \\\\\n0 & 1 & 1\n\\end{pmatrix}\n$$\nSince $B$ is a lower triangular matrix, its inverse $B^{-1}$ can be found by forward substitution or inspection.\n$$\nB^{-1} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n-1 & 1 & 0 \\\\\n1 & -1 & 1\n\\end{pmatrix}\n$$\nNext, we express the basic solution $x_B(p)$ as a function of $p$:\n$$\nx_B(p) = B^{-1} b(p) = B^{-1} (b_0 + p\\,d) = B^{-1} b_0 + p (B^{-1} d)\n$$\nWe calculate the two terms separately.\n$$\nB^{-1} b_0 = \\begin{pmatrix} 1 & 0 & 0 \\\\ -1 & 1 & 0 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 200 \\\\ 350 \\\\ 300 \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ -200 + 350 \\\\ 200 - 350 + 300 \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ 150 \\\\ 150 \\end{pmatrix}\n$$\nThis is the initial feasible solution at $p=0$.\n$$\nB^{-1} d = \\begin{pmatrix} 1 & 0 & 0 \\\\ -1 & 1 & 0 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\nNow, we combine them to get the parametric solution for the basic variables $x_B = (x_1, x_2, x_3)^T$:\n$$\nx_B(p) = \\begin{pmatrix} x_1(p) \\\\ x_2(p) \\\\ x_3(p) \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ 150 \\\\ 150 \\end{pmatrix} + p \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ 150 + p \\\\ 150 - p \\end{pmatrix}\n$$\nFor the solution to remain feasible, all basic variables must be non-negative:\n1. $x_1(p) = 200 \\ge 0$. This is always satisfied.\n2. $x_2(p) = 150 + p \\ge 0$. Since the problem states $p \\ge 0$, this is always satisfied.\n3. $x_3(p) = 150 - p \\ge 0 \\implies p \\le 150$.\n\nThe most restrictive condition is $p \\le 150$. Therefore, the maximal value of $p$ for which the basis remains feasible is $150$. As $p$ increases beyond $150$, the variable $x_3$ will become negative. Thus, the basic variable that first violates nonnegativity is $x_3$.\n\nThe maximal value of $p$ is $150.0$ MW, and the index of the variable that first violates the constraint is $3$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 150.0 & 3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our final practice moves from linear to more realistic quadratic programming (QP) models, incorporating dynamic constraints like generator ramping. In this advanced exercise , you will derive the general sensitivity system for a QP by differentiating its Karush-Kuhn-Tucker (KKT) conditions. Mastering this technique provides a powerful, analytical tool to understand how the optimal dispatch and its associated prices respond to continuous changes in system parameters, such as a scaling demand profile.",
            "id": "4110428",
            "problem": "Consider an economic dispatch problem in an energy system with $N$ thermal generators over $T$ discrete time intervals. Let $x \\in \\mathbb{R}^{n}$ with $n = N T$ collect the generation outputs $x_{g,t}$ for generator index $g \\in \\{1,\\dots,N\\}$ and time index $t \\in \\{1,\\dots,T\\}$. The generation cost is modeled as a strictly convex quadratic function with symmetric positive definite Hessian $Q \\in \\mathbb{R}^{n \\times n}$ and linear term $c \\in \\mathbb{R}^{n}$. The load balance at each time is enforced by equality constraints of the form\n$$\n\\sum_{g=1}^{N} x_{g,t} \\;=\\; p \\, d_{t} \\quad \\text{for all } t \\in \\{1,\\dots,T\\},\n$$\nwhere $d \\in \\mathbb{R}^{T}$ is a fixed, strictly positive demand profile and $p > 0$ is a scalar parameter that scales the demand. Collect these $T$ equality constraints into a compact form $A x = p d$, where $A \\in \\mathbb{R}^{T \\times n}$ is the time-aggregation matrix that maps unit-level outputs to total load per time.\n\nIntertemporal ramping constraints couple consecutive time periods for each generator, enforcing\n$$\n- R^{-}_{g,t} \\;\\le\\; x_{g,t+1} - x_{g,t} \\;\\le\\; R^{+}_{g,t} \\quad \\text{for } t \\in \\{1,\\dots,T-1\\}, \\; g \\in \\{1,\\dots,N\\},\n$$\nwith given ramp-down limits $R^{-}_{g,t} > 0$ and ramp-up limits $R^{+}_{g,t} > 0$. These can be written compactly as $G x \\le r$, where $G \\in \\mathbb{R}^{m_{\\mathrm{ineq}} \\times n}$ and $r \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ collect the linear coefficients and bounds of the inequality constraints.\n\nAssume the following regularity and realism conditions hold at an optimal solution for a given parameter value $p$:\n- The Hessian $Q$ is symmetric positive definite.\n- The Linear Independence Constraint Qualification (LICQ) holds for the active constraints at the optimum.\n- Strict complementarity holds for the active inequalities.\n- The active inequality set $\\mathcal{A}$ (the index set of ramp constraints that bind at the optimum) remains unchanged in an open neighborhood of the given $p$.\n\nLet $G_{\\mathcal{A}} \\in \\mathbb{R}^{k \\times n}$ denote the submatrix of $G$ associated with the $k$ active ramp constraints, and let $r_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ denote the corresponding bounds. The optimal primal-dual variables are $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu^{\\star}_{\\mathcal{A}}(p))$, where $\\lambda^{\\star} \\in \\mathbb{R}^{T}$ are the equality-constraint multipliers and $\\mu^{\\star}_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ are the multipliers of the active ramp constraints.\n\nStarting from first principles for convex quadratic optimization and the Karush-Kuhn-Tucker (KKT) optimality conditions, derive the sensitivity system that governs $\\frac{d x^{\\star}}{d p}$, $\\frac{d \\lambda^{\\star}}{d p}$, and $\\frac{d \\mu^{\\star}_{\\mathcal{A}}}{d p}$ when the parameter $p$ multiplies the demand vector $d$ on the right-hand side of the equality constraints. Under the stated regularity assumptions, express $\\frac{d x^{\\star}}{d p}$ as a single closed-form analytic expression using a block-matrix inverse, in terms of $Q$, $A$, $G_{\\mathcal{A}}$, and $d$ only. Provide your final expression for $\\frac{d x^{\\star}}{d p}$.\n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "To find the sensitivity of the optimal solution with respect to the demand scaling parameter $p$, we start by formulating the Karush-Kuhn-Tucker (KKT) conditions for the given parametric quadratic program (QP). The derivation will leverage the provided regularity assumptions, which allow us to differentiate the optimality conditions.\n\nThe optimization problem can be formulated as a parametric QP:\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad & \\frac{1}{2} x^T Q x + c^T x \\\\\n\\text{subject to} \\quad & A x = p d \\\\\n& G x \\le r\n\\end{aligned}\n$$\nwhere $x$ is the vector of generation outputs, $Q$ is the symmetric positive definite cost Hessian, $c$ is the linear cost vector, $A$ is the time-aggregation matrix for the load balance constraints, $d$ is the base demand profile, $p$ is the scalar parameter, $G$ represents the ramping constraints, and $r$ contains the ramp limits.\n\nThe Lagrangian for this problem is:\n$$\n\\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} x^T Q x + c^T x + \\lambda^T (A x - p d) + \\mu^T (G x - r)\n$$\nHere, $\\lambda \\in \\mathbb{R}^T$ are the Lagrange multipliers for the equality constraints, and $\\mu \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ are the multipliers for the inequality constraints.\n\nThe KKT conditions for an optimal solution $(x^{\\star}, \\lambda^{\\star}, \\mu^{\\star})$ are:\n1.  **Stationarity:** $\\nabla_x \\mathcal{L} = Q x^{\\star} + c + A^T \\lambda^{\\star} + G^T \\mu^{\\star} = 0$\n2.  **Primal Feasibility (Equality):** $A x^{\\star} - p d = 0$\n3.  **Primal Feasibility (Inequality):** $G x^{\\star} - r \\le 0$\n4.  **Dual Feasibility:** $\\mu^{\\star} \\ge 0$\n5.  **Complementary Slackness:** $\\mu_i^{\\star}((G x^{\\star})_i - r_i) = 0$ for all $i = 1, \\dots, m_{\\mathrm{ineq}}$.\n\nThe problem states crucial regularity conditions for a given optimal solution corresponding to the parameter value $p$. Specifically, Linear Independence Constraint Qualification (LICQ) and strict complementarity hold, and—most importantly—the set of active inequality constraints, denoted by $\\mathcal{A}$, is assumed to be constant in an open neighborhood of $p$. This allows us to treat the optimal solution and its multipliers as differentiable functions of $p$, i.e., $x^{\\star}(p)$, $\\lambda^{\\star}(p)$, and $\\mu^{\\star}(p)$.\n\nUnder the constant active set assumption, the KKT system simplifies. For inequality constraints with index $i \\in \\mathcal{A}$, the constraint is binding, i.e., $(G_{\\mathcal{A}} x^{\\star}(p))_i = (r_{\\mathcal{A}})_i$. For indices $j \\notin \\mathcal{A}$, the constraint is slack, $(G x^{\\star}(p))_j < r_j$, and by complementary slackness, the corresponding multiplier is zero, $\\mu_j^{\\star}(p) = 0$.\nThus, the Stationarity condition simplifies to $Q x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0$, where $\\mu_{\\mathcal{A}}^{\\star}$ contains only the multipliers for the active constraints.\n\nThe optimality conditions for the solution path $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu_{\\mathcal{A}}^{\\star}(p))$ in a neighborhood of $p$ become a system of equations:\n$$\n\\begin{cases}\nQ x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0 \\\\\nA x^{\\star}(p) - p d = 0 \\\\\nG_{\\mathcal{A}} x^{\\star}(p) - r_{\\mathcal{A}} = 0\n\\end{cases}\n$$\nTo find the sensitivities, we differentiate this system with respect to the parameter $p$. We denote the derivatives as $\\frac{d x^{\\star}}{d p}$, $\\frac{d \\lambda^{\\star}}{d p}$, and $\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}$. The matrices $Q$, $A$, $G_{\\mathcal{A}}$ and vectors $c$, $d$, $r_{\\mathcal{A}}$ are constant with respect to $p$.\n\nDifferentiating the first equation yields:\n$$\nQ \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0\n$$\nDifferentiating the second equation yields:\n$$\nA \\frac{d x^{\\star}}{d p} - d = 0 \\implies A \\frac{d x^{\\star}}{d p} = d\n$$\nDifferentiating the third equation yields:\n$$\nG_{\\mathcal{A}} \\frac{d x^{\\star}}{d p} = 0\n$$\nWe can arrange these three linear equations for the unknown derivatives into a single block-matrix system:\n$$\n\\begin{pmatrix}\nQ & A^T & G_{\\mathcal{A}}^T \\\\\nA & 0 & 0 \\\\\nG_{\\mathcal{A}} & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{d x^{\\star}}{d p} \\\\\n\\frac{d \\lambda^{\\star}}{d p} \\\\\n\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\nd \\\\\n0\n\\end{pmatrix}\n$$\nThe problem asks for an expression for $\\frac{d x^{\\star}}{d p}$. We can solve this system using block substitution. Let's rewrite the system by isolating the first block-row equation and combining the second and third:\n1. $Q \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0$\n2. $\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\frac{d x^{\\star}}{d p} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}$\n\nFrom (1), since $Q$ is positive definite and thus invertible, we can express $\\frac{d x^{\\star}}{d p}$ in terms of the multiplier sensitivities:\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\left( A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\right) = - Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix}\n$$\nNow, substitute this expression into equation (2):\n$$\n\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\left( -Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} \\right) = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nRearranging gives:\n$$\n- \\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nMultiplying out the block matrices gives the Schur complement of the $Q$ block:\n$$\n- \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nThe matrix on the left is invertible due to the LICQ and positive definiteness of $Q$. We can solve for the vector of multiplier sensitivities:\n$$\n\\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = - \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nFinally, we substitute this back into our expression for $\\frac{d x^{\\star}}{d p}$:\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\left( - \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix} \\right)\n$$\nSimplifying the signs, we arrive at the final closed-form expression for the sensitivity of the primal variables:\n$$\n\\frac{d x^{\\star}}{d p} = Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nThis expression provides the derivative of the optimal generation vector with respect to the demand scaling parameter, exclusively in terms of the problem data $Q$, $A$, $G_{\\mathcal{A}}$, and $d$, as required. Note that $Q^{-1}$ is derived directly from $Q$.",
            "answer": "$$\n\\boxed{Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}}\n$$"
        }
    ]
}