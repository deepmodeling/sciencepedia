{
    "hands_on_practices": [
        {
            "introduction": "碳定价是影响发电调度决策的关键经济杠杆。本练习通过一个简化的双发电机经济调度模型，让您从基本原理出发，推导决定调度顺序切换点的临界碳价。这个过程将加深您对参数如何改变线性规划最优基的理解，并让您掌握在这些关键点上进行精确成本敏感性分析的方法。",
            "id": "4110397",
            "problem": "考虑一个电力系统中两个火力发电机组在一小时时间间隔内的单周期经济调度，该系统具有无弹性需求。发电机组 $1$ 的不含碳成本的可变运行成本为 $c_1$ 美元/兆瓦时，直接二氧化碳排放强度为 $\\tau_1$ 公吨$\\text{CO}_2$/兆瓦时，铭牌容量为 $U_1$ 兆瓦。发电机组 $2$ 的相应参数为 $c_2$、$\\tau_2$ 和 $U_2$。统一碳价 $p$（单位为美元/公吨$\\text{CO}_2$）适用于所有排放者。系统运营商通过最小化包含碳成本的总可变运行成本，来满足一小时内 $D$ 兆瓦的无弹性需求，同时假设每个发电机组的出力为非负且有容量限制。决策变量是调度水平 $x_1$ 和 $x_2$（单位为兆瓦），代表该小时内的平均功率输出。\n\n该调度问题被表述为以下优化问题：\n- 决策变量：$x_1, x_2$。\n- 目标：最小化一小时时间间隔内包含碳定价的总发电成本。\n- 约束：满足需求并遵守发电机组容量限制。\n\n仅使用线性优化和参数灵敏度的基本原理。具体来说，从第一性原理出发，写出相应的线性规划，并使用 Karush-Kuhn-Tucker (KKT) 条件、对偶可行性和互补松弛性来推导最优性条件。然后用这些条件来确定最优基如何随碳价参数 $p$ 的变化而变化。最后，使用包络定理和对偶性来计算最小成本相对于 $p$ 的灵敏度。\n\n假设以下参数值：\n- $c_1 = 21$ 美元/兆瓦时，$\\tau_1 = 0.88$ 公吨$\\text{CO}_2$/兆瓦时，以及 $U_1 = 500$ 兆瓦。\n- $c_2 = 36$ 美元/兆瓦时，$\\tau_2 = 0.39$ 公吨$\\text{CO}_2$/兆瓦时，以及 $U_2 = 500$ 兆瓦。\n- 需求 $D = 320$ 兆瓦，在一小时时间间隔内。\n\n任务：\n1. 从第一性原理出发，推导两个发电机组之间调度顺序发生切换时的参数化碳价 $p$。您必须从线性规划及其最优性条件开始确定此切换值，而不是通过调用任何预先给定的专门公式。\n2. 使用最优值相对于参数 $p$ 的严格灵敏度分析，确定最小总发电成本在切换碳价处相对于 $p$ 的右导数。\n\n答案规格：\n- 以美元/公吨$\\text{CO}_2$表示切换碳价。\n- 以公吨$\\text{CO}_2$/小时表示切换点处的右导数。\n- 将两个量都四舍五入到四位有效数字。\n- 最终答案必须以单行两个数字的形式呈现，顺序为：切换碳价，右导数。",
            "solution": "经济调度问题是一个线性规划 (LP) 问题，旨在满足需求和遵守运行约束的条件下最小化总发电成本。决策变量是两个发电机组的调度水平 $x_1$ 和 $x_2$。\n\n在一小时时间间隔内，包含碳价 $p$ 的发电机组 $i$ 的总成本是其燃料成本和碳成本之和。包含碳成本的发电边际成本由 $mc_i(p) = c_i + p \\tau_i$ 给出。目标函数是最小化总系统成本，即两个发电机组的成本之和。\n\n该线性规划表述如下：\n$$\n\\min_{x_1, x_2} C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2\n$$\n约束条件为：\n\\begin{align*}\n    x_1 + x_2 = D  &\\quad (\\text{对偶变量: } \\lambda) \\\\\n    x_1 \\ge 0  &\\quad (\\text{对偶变量: } \\mu_1) \\\\\n    x_2 \\ge 0  &\\quad (\\text{对偶变量: } \\mu_2) \\\\\n    x_1 \\le U_1  &\\quad (\\text{对偶变量: } \\gamma_1) \\\\\n    x_2 \\le U_2  &\\quad (\\text{对偶变量: } \\gamma_2)\n\\end{align*}\n问题在于找出最优基发生变化时参数 $p$ 的值，以及在该点最优成本对 $p$ 的灵敏度。\n\n任务 1：推导切换碳价。\n调度顺序（或称优序）由边际成本 $mc_1(p)$ 和 $mc_2(p)$ 决定。边际成本较低的发电机组被首先调度。当边际成本相等时，调度顺序发生切换。我们将使用 Karush-Kuhn-Tucker (KKT) 条件来正式推导这个条件。\n\n首先，我们将约束重写为标准形式 $g_j(x) \\le 0$：\n$h_1(x) = x_1 + x_2 - D = 0$\n$g_1(x) = -x_1 \\le 0$\n$g_2(x) = -x_2 \\le 0$\n$g_3(x) = x_1 - U_1 \\le 0$\n$g_4(x) = x_2 - U_2 \\le 0$\n\n拉格朗日函数为：\n$L(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\gamma_1, \\gamma_2) = (c_1+p\\tau_1)x_1 + (c_2+p\\tau_2)x_2 + \\lambda(x_1+x_2-D) - \\mu_1 x_1 - \\mu_2 x_2 + \\gamma_1(x_1-U_1) + \\gamma_2(x_2-U_2)$,\n其中不等式约束的对偶变量必须为非负：$\\mu_1, \\mu_2, \\gamma_1, \\gamma_2 \\ge 0$。\n\nKKT 平稳性条件为 $\\frac{\\partial L}{\\partial x_1} = 0$ 和 $\\frac{\\partial L}{\\partial x_2} = 0$：\n\\begin{align*}\n    c_1 + p\\tau_1 + \\lambda - \\mu_1 + \\gamma_1 = 0 \\quad (1) \\\\\n    c_2 + p\\tau_2 + \\lambda - \\mu_2 + \\gamma_2 = 0 \\quad (2)\n\\end{align*}\n互补松弛性条件为 $\\mu_1 x_1 = 0$、$\\mu_2 x_2 = 0$、$\\gamma_1(x_1 - U_1) = 0$ 和 $\\gamma_2(x_2 - U_2) = 0$。\n\n需求为 $D = 320\\text{ MW}$，小于任一发电机组的容量（$U_1 = 500\\text{ MW}$，$U_2 = 500\\text{ MW}$）。因此，一个发电机组就可以满足全部需求。最优解将是一个角点解，其中一个发电机组产生 $D$ 的功率，另一个产生 $0$，除非它们的边际成本相等。\n\n情况 A：发电机组 1 满足全部需求。\n建议的解为 $x_1^* = D$ 和 $x_2^* = 0$。\n由于 $D > 0$ 且 $D  U_1$，我们有 $x_1^* > 0$ 且 $x_1^*  U_1$。互补松弛性意味着 $\\mu_1 = 0$ 且 $\\gamma_1 = 0$。\n由于 $x_2^* = 0$，所以 $\\mu_2 \\ge 0$。由于 $x_2^*  U_2$，所以 $\\gamma_2=0$。\n将这些代入平稳性方程：\n由 $(1)$：$c_1 + p\\tau_1 + \\lambda = 0 \\implies \\lambda = -(c_1 + p\\tau_1)$。\n由 $(2)$：$c_2 + p\\tau_2 + \\lambda - \\mu_2 = 0$。\n代入 $\\lambda$：$c_2 + p\\tau_2 - (c_1 + p\\tau_1) - \\mu_2 = 0 \\implies \\mu_2 = (c_2 + p\\tau_2) - (c_1 + p\\tau_1)$。\n为使此解为最优解，对偶可行性要求 $\\mu_2 \\ge 0$。这意味着 $c_2 + p\\tau_2 \\ge c_1 + p\\tau_1$。\n这证实了当发电机组 1 的边际成本小于或等于发电机组 2 的边际成本时，它会被调度。\n\n情况 B：发电机组 2 满足全部需求。\n建议的解为 $x_1^* = 0$ 和 $x_2^* = D$。\n通过对称推理，互补松弛性意味着 $\\mu_1 \\ge 0, \\gamma_1 = 0, \\mu_2 = 0, \\gamma_2 = 0$。\n代入平稳性方程：\n由 $(2)$：$c_2 + p\\tau_2 + \\lambda = 0 \\implies \\lambda = -(c_2 + p\\tau_2)$。\n由 $(1)$：$c_1 + p\\tau_1 + \\lambda - \\mu_1 = 0$。\n代入 $\\lambda$：$c_1 + p\\tau_1 - (c_2 + p\\tau_2) - \\mu_1 = 0 \\implies \\mu_1 = (c_1 + p\\tau_1) - (c_2 + p\\tau_2)$。\n为使此解为最优解，对偶可行性要求 $\\mu_1 \\ge 0$。这意味着 $c_1 + p\\tau_1 \\ge c_2 + p\\tau_2$。\n这证实了当发电机组 2 的边际成本小于或等于发电机组 1 的边际成本时，它会被调度。\n\n调度顺序的切换发生在最优性条件从一种情况切换到另一种情况时。这发生在两种条件都成立的边界处，即边际成本相等时：\n$$c_1 + p_{\\text{switch}}\\tau_1 = c_2 + p_{\\text{switch}}\\tau_2$$\n求解 $p_{\\text{switch}}$：\n$$p_{\\text{switch}}(\\tau_1 - \\tau_2) = c_2 - c_1$$\n$$p_{\\text{switch}} = \\frac{c_2 - c_1}{\\tau_1 - \\tau_2}$$\n使用给定值：$c_1=21$，$c_2=36$，$\\tau_1=0.88$，$\\tau_2=0.39$。\n$$p_{\\text{switch}} = \\frac{36 - 21}{0.88 - 0.39} = \\frac{15}{0.49} \\approx 30.61224\\dots$$\n四舍五入到四位有效数字，切换价格为 $30.61$ 美元/公吨 $\\text{CO}_2$。\n\n任务 2：最小成本的右导数。\n令 $C^*(p)$ 为作为碳价 $p$ 的函数的最小总成本。我们需要计算右导数 $\\frac{dC^*(p)}{dp^+}|_{p=p_{\\text{switch}}}$。\n该问题要求使用包络定理。对于一个参数化的最小化问题 $V(\\theta) = \\min_x F(x, \\theta)$，该定理指出 $\\frac{dV}{d\\theta} = \\frac{\\partial \\mathcal{L}}{\\partial \\theta}|_{x=x^*(\\theta)}$，其中 $\\mathcal{L}$ 是拉格朗日量，$x^*(\\theta)$ 是最优解。当参数只出现在目标函数中时，这简化为 $\\frac{dV}{d\\theta} = \\frac{\\partial F}{\\partial \\theta}|_{x=x^*(\\theta)}$。\n\n我们的目标函数是 $C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2$。\n关于 $p$ 的偏导数是：\n$$\\frac{\\partial C}{\\partial p} = \\tau_1 x_1 + \\tau_2 x_2$$\n根据包络定理，最优成本对碳价的灵敏度是：\n$$\\frac{dC^*(p)}{dp} = \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p)$$\n该表达式代表了最优调度下的总碳排放量（单位为公吨/小时）。\n\n为了找到在 $p = p_{\\text{switch}}$ 处的右导数，我们需要使用对 $p > p_{\\text{switch}}$ 成立的最优解 $x^*(p)$ 来计算该表达式的值。\n让我们分析当 $p$ 变化时边际成本。\n当 $c_1=21$, $c_2=36$, $\\tau_1=0.88$, $\\tau_2=0.39$ 时，我们有 $c_2 > c_1$ 和 $\\tau_1 > \\tau_2$。这意味着发电机组 1 的非碳成本较低，但排放强度较高。随着碳价 $p$ 的增加，发电机组 1 的边际成本比发电机组 2 上升得更快。\n当 $p  p_{\\text{switch}}$ 时，$mc_1(p)  mc_2(p)$。\n当 $p > p_{\\text{switch}}$ 时，$mc_1(p) > mc_2(p)$。\n因此，对于任何刚好大于 $p_{\\text{switch}}$ 的 $p$ 值，发电机组 2 更便宜。最优调度是使用发电机组 2 来满足全部需求：\n$$x_1^*(p) = 0, \\quad x_2^*(p) = D = 320$$\n因此，右导数为：\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = \\lim_{p\\to p_{\\text{switch}}^+} \\left( \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p) \\right) = \\tau_1 (0) + \\tau_2 (D) = \\tau_2 D\n$$\n代入数值：\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = 0.39 \\frac{\\text{tCO}_2}{\\text{MWh}} \\times 320 \\text{ MW} = 124.8 \\frac{\\text{tCO}_2}{\\text{h}}\n$$\n该值有四位有效数字。\n\n结果是：\n切换碳价：$p_{\\text{switch}} = 30.61$ 美元/公吨$\\text{CO}_2$。\n最小成本的右导数：$\\frac{dC^*}{dp^+} = 124.8$ 公吨$\\text{CO}_2$/小时。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.61  124.8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的电力市场模型中，我们常常会遇到边际成本相同或相近的情况，这会导致简并性（degeneracy）和多重最优解。本练习探讨了当发电机容量这一约束参数发生变化时，系统最优成本的敏感性行为。通过分析一个边际成本相同的特例，您将理解为何在某些参数区间内，最优目标值会保持不变，并揭示其与非基本变量的检验数为零之间的深刻联系。",
            "id": "4110427",
            "problem": "考虑一个电力系统中的单周期经济调度模型，其中有两个火力发电机组为一个固定的负荷供电。设决策变量为 $x_1$ 和 $x_2$，分别表示发电机1和发电机2在一小时内的发电出力（单位：$\\mathrm{MW}$）。系统负荷为一个固定常数 $D$（单位：$\\mathrm{MW}$）。发电机1的铭牌容量为 $\\theta$（单位：$\\mathrm{MW}$），这是一个参数。发电机2的铭牌容量为 $U_2$（单位：$\\mathrm{MW}$），满足 $U_2 > D$。两台发电机具有相同的恒定边际成本，均为 $\\bar{c}$（单位：$\\mathrm{\\$}/\\mathrm{MWh}$）。忽略启动成本、最小出力水平和爬坡限制。\n\n建立以下线性规划（LP）问题（理解为最小化一小时内的总运行成本，单位：$\\mathrm{\\$}$）：\n$$\n\\min_{x_1,x_2} \\ \\bar{c}\\,x_1 + \\bar{c}\\,x_2\n$$\n约束条件为\n$$\nx_1 + x_2 \\,=\\, D,\\quad 0 \\,\\le\\, x_1 \\,\\le\\, \\theta,\\quad 0 \\,\\le\\, x_2 \\,\\le\\, U_2.\n$$\n\n仅使用基本的LP最优性条件（原始可行性、对偶可行性和互补松弛性）和判别成本的定义，分析对容量参数 $\\theta$ 的参数依赖性，并确定一个非空的 $\\theta$ 区间，在该区间上：\n- 在一个最优基本可行解中，$x_1$ 保持在其下界 $x_1^{\\star} = 0$ 的同时，其判别成本保持为零，并且\n- 最优目标值 $V^{\\star}(\\theta)$ 相对于 $\\theta$ 是一个常数（平坦的）。\n\n在该区间上，计算灵敏度 $\\frac{d}{d\\theta} V^{\\star}(\\theta)$ 的精确值，并以 $\\mathrm{\\$}/\\mathrm{h}/\\mathrm{MW}$ 为单位表示。无需四舍五入。请明确写出所要求的最终数值。",
            "solution": "目标函数是最小化 $V = \\bar{c}\\,x_1 + \\bar{c}\\,x_2$。这可以重写为 $V = \\bar{c}\\,(x_1 + x_2)$。\n第一个约束是负荷平衡方程：$x_1 + x_2 = D$。\n将该约束代入目标函数，我们发现对于任何可行解，目标值都是一个常数：\n$$\nV = \\bar{c}\\,D\n$$\n这意味着任何可行解都是最优解。问题因而简化为刻画可行解集并分析其作为参数 $\\theta$ 的函数的性质。\n\n只要可行集非空，最优目标值 $V^{\\star}(\\theta)$ 就等于 $\\bar{c}D$。让我们确定可行性的条件。约束条件为：\n1.  $x_1 + x_2 = D$\n2.  $0 \\le x_1 \\le \\theta$\n3.  $0 \\le x_2 \\le U_2$\n\n从(1)中，我们可以将 $x_2$ 表示为 $x_2 = D - x_1$。将其代入(3)得到：\n$0 \\le D - x_1 \\le U_2$。\n这给出了关于 $x_1$ 的两个不等式：\n-   $D - x_1 \\ge 0 \\implies x_1 \\le D$。\n-   $D - x_1 \\le U_2 \\implies x_1 \\ge D - U_2$。\n\n合并所有关于 $x_1$ 的约束：\n-   从 $x_1 \\ge 0$ 和 $x_1 \\ge D-U_2$ 以及已知条件 $U_2 > D \\implies D-U_2  0$，有效的下界是 $x_1 \\ge 0$。\n-   从 $x_1 \\le \\theta$ 和 $x_1 \\le D$，有效的上界是 $x_1 \\le \\min(\\theta, D)$。\n\n因此，$x_1$ 的可行值集合是区间 $[0, \\min(\\theta, D)]$。为使该区间非空，我们需要 $0 \\le \\min(\\theta, D)$，这要求 $\\theta \\ge 0$（假设负荷 $D > 0$）。\n对于任何 $\\theta \\ge 0$，问题都是可行的，且最优目标值为 $V^{\\star}(\\theta) = \\bar{c}D$。由于 $\\bar{c}$ 和 $D$ 是常数，因此对于所有 $\\theta \\ge 0$，$V^{\\star}(\\theta)$ 是一个常数（平坦的）。这满足了问题对于区间 $\\theta \\in [0, \\infty)$ 的第三个条件。\n\n接下来，我们需要找到一个 $x_1^{\\star} = 0$ 的最优基本可行解（BFS）。一个BFS对应于可行域的一个顶点。$x_1$ 的可行域是区间 $[0, \\min(\\theta,D)]$。顶点是 $x_1 = 0$ 和 $x_1 = \\min(\\theta, D)$。\n对应于顶点 $x_1 = 0$ 的解是 $(x_1^{\\star}, x_2^{\\star}) = (0, D)$。这是一个BFS。由于所有可行解都是最优解，所以这个BFS是一个最优BFS。该解对于任何 $\\theta \\ge 0$ 都有效，因为约束 $0 \\le x_1^{\\star} \\le \\theta$ 变为 $0 \\le 0 \\le \\theta$，这对所有 $\\theta \\ge 0$ 都成立。这满足了问题对于区间 $\\theta \\in [0, \\infty)$ 的第二个条件。\n\n最后，我们必须检查 $x_1$ 的判别成本。在单纯形法的背景下，对于一个只有一个等式约束 $x_1+x_2=D$ 的问题，一个BFS将有一个基变量和一个非基变量。对于BFS $(0, D)$，变量 $x_1$ 处于其下界，因此它是非基变量。变量 $x_2 = D$ 假定严格处于其界限之间（如果 $0  D  U_2$），因此它必须是基变量。\n\n为了找到判别成本，我们将目标函数表示为非基变量的函数。基变量是 $x_2$。根据等式约束，我们有 $x_2 = D - x_1$。\n将其代入目标函数：\n$$\nV(x_1) = \\bar{c}\\,x_1 + \\bar{c}\\,(D - x_1) = \\bar{c}\\,x_1 + \\bar{c}D - \\bar{c}\\,x_1 = \\bar{c}D + 0 \\cdot x_1\n$$\n非基变量的判别成本是当目标函数表示为非基变量的函数时，该变量的系数。在这里，$x_1$ 的系数是 $0$。因此，$x_1$ 的判别成本是 $0$。这是两台发电机边际成本相同所导致的直接结果，这导致了一个退化的LP，其中整个解空间的一个线段都是最优的。一个非基变量的判别成本为零表示存在备选最优解，这对于任何 $\\theta > 0$ 在此都成立。这对于整个区间 $\\theta \\in [0, \\infty)$ 都成立。\n\n问题中指定的所有三个条件在区间 $\\theta \\in [0, \\infty)$ 上都得到满足。这是一个有效的非空区间。\n\n最后的任务是在此区间上计算灵敏度 $\\frac{d}{d\\theta} V^{\\star}(\\theta)$。\n如前所述，对于区间 $[0, \\infty)$ 中的任何 $\\theta$，最优目标值由下式给出：\n$$\nV^{\\star}(\\theta) = \\bar{c}D\n$$\n由于 $V^{\\star}(\\theta)$ 不依赖于 $\\theta$，它对 $\\theta$ 的导数为零。\n$$\n\\frac{d}{d\\theta} V^{\\star}(\\theta) = \\frac{d}{d\\theta} (\\bar{c}D) = 0\n$$\n这一结果与线性规划中的灵敏度分析理论是一致的。最优值对于一个约束右端项变化的灵敏度由该约束的对偶变量（影子价格）的最优值给出。涉及 $\\theta$ 的约束是 $x_1 \\le \\theta$。对于最优BFS $(0, D)$ 和任何 $\\theta > 0$，该约束不是紧的（$0  \\theta$），因此其影子价格为零。即使在 $\\theta=0$ 时，要求 $x_1$ 的判别成本必须为零的额外条件也迫使 $x_1 \\le \\theta$ 约束的影子价格为零。因此，在整个区间内灵敏度为零。要求的单位是 $\\mathrm{\\$}/\\mathrm{h}/\\mathrm{MW}$，数值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "现实世界的能源系统模型通常是包含二次成本函数和复杂动态约束（如爬坡限制）的二次规划（QP）问题。本练习将引导您进入更高级的敏感性分析领域，要求您从KKT（Karush-Kuhn-Tucker）条件出发，为这类复杂模型推导出一个描述最优解对需求参数变化的完整敏感性方程组。掌握这一通用方法是分析复杂能源系统对外部扰动响应能力的核心技能。",
            "id": "4110428",
            "problem": "考虑一个能源系统中 $N$ 个发电机组在 $T$ 个离散时间区间内的经济调度问题。令 $x \\in \\mathbb{R}^{n}$（其中 $n = N T$）集合了发电机组索引 $g \\in \\{1,\\dots,N\\}$ 和时间索引 $t \\in \\{1,\\dots,T\\}$ 的发电出力 $x_{g,t}$。发电成本被建模为一个严格凸的二次函数，其海森矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，线性项为 $c \\in \\mathbb{R}^{n}$。每个时间的负荷平衡由以下形式的等式约束强制执行\n$$\n\\sum_{g=1}^{N} x_{g,t} \\;=\\; p \\, d_{t} \\quad \\text{for all } t \\in \\{1,\\dots,T\\},\n$$\n其中 $d \\in \\mathbb{R}^{T}$ 是一个固定的、严格为正的需求曲线，$p > 0$ 是一个缩放需求的标量参数。将这 $T$ 个等式约束集合成紧凑形式 $A x = p d$，其中 $A \\in \\mathbb{R}^{T \\times n}$ 是时间聚合矩阵，它将机组级别的出力映射到每个时间的总负荷。\n\n跨时段的爬坡约束耦合了每个发电机组的连续时间段，强制执行\n$$\n- R^{-}_{g,t} \\;\\le\\; x_{g,t+1} - x_{g,t} \\;\\le\\; R^{+}_{g,t} \\quad \\text{for } t \\in \\{1,\\dots,T-1\\}, \\; g \\in \\{1,\\dots,N\\},\n$$\n其中给定了向下爬坡限制 $R^{-}_{g,t} > 0$ 和向上爬坡限制 $R^{+}_{g,t} > 0$。这些可以紧凑地写成 $G x \\le r$，其中 $G \\in \\mathbb{R}^{m_{\\mathrm{ineq}} \\times n}$ 和 $r \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ 集合了不等式约束的线性系数和界限。\n\n假设对于给定的参数值 $p$，在最优解处以下正则性和现实性条件成立：\n- 海森矩阵 $Q$ 是对称正定的。\n- 线性无关约束规范 (LICQ) 对最优解处的有效约束成立。\n- 严格互补性对有效不等式成立。\n- 有效不等式集合 $\\mathcal{A}$（在最优解处起作用的爬坡约束的索引集）在给定 $p$ 的一个开放邻域内保持不变。\n\n令 $G_{\\mathcal{A}} \\in \\mathbb{R}^{k \\times n}$ 表示与 $k$ 个有效爬坡约束相关的 $G$ 的子矩阵，并令 $r_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ 表示相应的界限。最优原始-对偶变量为 $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu^{\\star}_{\\mathcal{A}}(p))$，其中 $\\lambda^{\\star} \\in \\mathbb{R}^{T}$ 是等式约束的乘子，$\\mu^{\\star}_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ 是有效爬坡约束的乘子。\n\n从凸二次优化的第一性原理和 Karush-Kuhn-Tucker (KKT) 最优性条件出发，当参数 $p$ 乘以等式约束右侧的需求向量 $d$ 时，推导控制 $\\frac{d x^{\\star}}{d p}$、$\\frac{d \\lambda^{\\star}}{d p}$ 和 $\\frac{d \\mu^{\\star}_{\\mathcal{A}}}{d p}$ 的灵敏度系统。在所述的正则性假设下，仅使用 $Q$、$A$、$G_{\\mathcal{A}}$ 和 $d$，通过分块矩阵逆将 $\\frac{d x^{\\star}}{d p}$ 表示为单个封闭形式的解析表达式。提供您关于 $\\frac{d x^{\\star}}{d p}$ 的最终表达式。\n\n您的最终答案必须是单个封闭形式的解析表达式。不需要进行数值计算。",
            "solution": "该优化问题可以表述为一个参数二次规划 (QP)：\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad  \\frac{1}{2} x^T Q x + c^T x \\\\\n\\text{subject to} \\quad  A x = p d \\\\\n G x \\le r\n\\end{aligned}\n$$\n其中 $x$ 是发电出力向量，$Q$ 是对称正定的成本海森矩阵，$c$ 是线性成本向量，$A$ 是负荷平衡约束的时间聚合矩阵，$d$ 是基础需求曲线，$p$ 是标量参数，$G$ 代表爬坡约束，$r$ 包含爬坡限制。\n\n此问题的拉格朗日函数是：\n$$\n\\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} x^T Q x + c^T x + \\lambda^T (A x - p d) + \\mu^T (G x - r)\n$$\n这里，$\\lambda \\in \\mathbb{R}^T$ 是等式约束的拉格朗日乘子，$\\mu \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ 是不等式约束的乘子。\n\n最优解 $(x^{\\star}, \\lambda^{\\star}, \\mu^{\\star})$ 的 KKT 条件是：\n1.  **平稳性 (Stationarity):** $\\nabla_x \\mathcal{L} = Q x^{\\star} + c + A^T \\lambda^{\\star} + G^T \\mu^{\\star} = 0$\n2.  **原始可行性 (等式):** $A x^{\\star} - p d = 0$\n3.  **原始可行性 (不等式):** $G x^{\\star} - r \\le 0$\n4.  **对偶可行性:** $\\mu^{\\star} \\ge 0$\n5.  **互补松弛性 (Complementary Slackness):** 对于所有 $i = 1, \\dots, m_{\\mathrm{ineq}}$，有 $\\mu_i^{\\star}((G x^{\\star})_i - r_i) = 0$。\n\n问题陈述了对应于参数值 $p$ 的给定最优解的关键正则性条件。具体来说，线性无关约束规范 (LICQ) 和严格互补性成立，并且最重要的是，有效不等式约束的集合（用 $\\mathcal{A}$ 表示）被假定在 $p$ 的一个开放邻域内是恒定的。这使我们能够将最优解及其乘子视为 $p$ 的可微函数，即 $x^{\\star}(p)$、$\\lambda^{\\star}(p)$ 和 $\\mu^{\\star}(p)$。\n\n在有效集不变的假设下，KKT 系统得以简化。对于索引 $i \\in \\mathcal{A}$ 的不等式约束，该约束是紧的，即 $(G_{\\mathcal{A}} x^{\\star}(p))_i = (r_{\\mathcal{A}})_i$。对于索引 $j \\notin \\mathcal{A}$，该约束是松弛的，$(G x^{\\star}(p))_j  r_j$，并且根据互补松弛性，相应的乘子为零，$\\mu_j^{\\star}(p) = 0$。\n因此，平稳性条件简化为 $Q x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0$，其中 $\\mu_{\\mathcal{A}}^{\\star}$ 仅包含有效约束的乘子。\n\n在 $p$ 的邻域内，解路径 $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu_{\\mathcal{A}}^{\\star}(p))$ 的最优性条件成为一个方程组：\n$$\n\\begin{cases}\nQ x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0 \\\\\nA x^{\\star}(p) - p d = 0 \\\\\nG_{\\mathcal{A}} x^{\\star}(p) - r_{\\mathcal{A}} = 0\n\\end{cases}\n$$\n为了找到灵敏度，我们对这个系统关于参数 $p$ 求导。我们将导数表示为 $\\frac{d x^{\\star}}{d p}$、$\\frac{d \\lambda^{\\star}}{d p}$ 和 $\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}$。矩阵 $Q$、$A$、$G_{\\mathcal{A}}$ 以及向量 $c$、$d$、$r_{\\mathcal{A}}$ 相对于 $p$ 是常数。\n\n对第一个方程求导得出：\n$$\nQ \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0\n$$\n对第二个方程求导得出：\n$$\nA \\frac{d x^{\\star}}{d p} - d = 0 \\implies A \\frac{d x^{\\star}}{d p} = d\n$$\n对第三个方程求导得出：\n$$\nG_{\\mathcal{A}} \\frac{d x^{\\star}}{d p} = 0\n$$\n我们可以将这三个关于未知导数的线性方程组排列成一个单一的分块矩阵系统：\n$$\n\\begin{pmatrix}\nQ  A^T  G_{\\mathcal{A}}^T \\\\\nA  0  0 \\\\\nG_{\\mathcal{A}}  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{d x^{\\star}}{d p} \\\\\n\\frac{d \\lambda^{\\star}}{d p} \\\\\n\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\nd \\\\\n0\n\\end{pmatrix}\n$$\n问题要求给出 $\\frac{d x^{\\star}}{d p}$ 的表达式。我们可以使用分块代入法来求解这个系统。让我们通过隔离第一个分块行方程并组合第二和第三个方程来重写该系统：\n1. $Q \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0$\n2. $\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\frac{d x^{\\star}}{d p} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}$\n\n从 (1) 可知，由于 $Q$ 是正定的，因此是可逆的，我们可以用乘子灵敏度来表示 $\\frac{d x^{\\star}}{d p}$：\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\left( A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\right) = - Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix}\n$$\n现在，将此表达式代入方程 (2)：\n$$\n\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\left( -Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} \\right) = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n整理后得到：\n$$\n- \\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n将分块矩阵相乘得到 $Q$ 块的舒尔补 (Schur complement)：\n$$\n- \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n由于 LICQ 和 $Q$ 的正定性，左侧的矩阵是可逆的。我们可以求解乘子灵敏度向量：\n$$\n\\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = - \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n最后，我们将其代回到 $\\frac{d x^{\\star}}{d p}$ 的表达式中：\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\left( - \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix} \\right)\n$$\n简化符号后，我们得到原始变量灵敏度的最终封闭形式表达式：\n$$\n\\frac{d x^{\\star}}{d p} = Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n该表达式提供了最优发电向量相对于需求缩放参数的导数，并且完全由问题数据 $Q$、$A$、$G_{\\mathcal{A}}$ 和 $d$ 表示，符合要求。请注意，$Q^{-1}$ 直接由 $Q$ 导出。",
            "answer": "$$\n\\boxed{Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}}\n$$"
        }
    ]
}