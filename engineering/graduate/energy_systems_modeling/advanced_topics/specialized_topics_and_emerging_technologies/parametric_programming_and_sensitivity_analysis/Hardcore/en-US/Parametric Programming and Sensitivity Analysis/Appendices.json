{
    "hands_on_practices": [
        {
            "introduction": "This first practice problem grounds our exploration in a classic energy systems scenario: the economic dispatch of two generators. By introducing a parametric carbon price $p$, we shift the analysis from a static optimization to a dynamic one, examining how the optimal dispatch strategy changes as policy incentives vary. The exercise challenges you to derive the critical \"switching price\" from first principles—using the Karush-Kuhn-Tucker (KKT) conditions—and then apply the envelope theorem to determine the sensitivity of the total system cost to this price . This practice is fundamental for understanding how to model and quantify the economic impacts of environmental policies on power system operations.",
            "id": "4110397",
            "problem": "Consider a single-period economic dispatch of two thermal generators over a one-hour interval in an electricity system with inelastic demand. Generator $1$ has variable operating cost excluding carbon of $c_1$ in dollars per megawatt-hour, direct carbon dioxide emission intensity $\\tau_1$ in metric tons of carbon dioxide per megawatt-hour, and nameplate capacity $U_1$ in megawatts. Generator $2$ has corresponding parameters $c_2$, $\\tau_2$, and $U_2$. A uniform carbon price $p$ in dollars per metric ton of carbon dioxide applies to all emitters. The system operator minimizes total variable operating cost inclusive of carbon costs to meet an inelastic demand $D$ in megawatts over the one-hour period, assuming non-negativity and capacity limits for each generator. The decision variables are the dispatch levels $x_1$ and $x_2$ in megawatts, representing the average power output over the hour.\n\nThe dispatch problem is formulated as the following optimization problem:\n- Decision variables: $x_1, x_2$.\n- Objective: minimize the total generation cost over the one-hour interval, inclusive of carbon pricing.\n- Constraints: meet demand and respect generator capacities.\n\nUse only fundamental principles of linear optimization and parametric sensitivity. In particular, start from first principles by writing the appropriate linear program, and derive conditions for optimality using the Karush-Kuhn-Tucker (KKT) conditions, dual feasibility, and complementary slackness. Then use these to determine how the optimal basis changes as the carbon price parameter $p$ varies. Lastly, use the envelope theorem and duality to compute the sensitivity of the minimum cost with respect to $p$.\n\nAssume the following parameter values:\n- $c_1 = 21$ dollars per megawatt-hour, $\\tau_1 = 0.88$ metric tons of carbon dioxide per megawatt-hour, and $U_1 = 500$ megawatts.\n- $c_2 = 36$ dollars per megawatt-hour, $\\tau_2 = 0.39$ metric tons of carbon dioxide per megawatt-hour, and $U_2 = 500$ megawatts.\n- Demand $D = 320$ megawatts over the one-hour interval.\n\nTasks:\n1. Derive, from first principles, the parametric carbon price value $p$ at which the dispatch order between the two generators switches. You must identify this switching value starting from the linear program and its optimality conditions, not by invoking any pre-stated specialized formulas.\n2. Using rigorous sensitivity analysis of the optimal value with respect to the parameter $p$, determine the right-hand derivative at the switching carbon price of the minimum total generation cost with respect to $p$.\n\nAnswer specification:\n- Express the switching carbon price in dollars per metric ton of carbon dioxide.\n- Express the right-hand derivative at the switching point in metric tons of carbon dioxide per hour.\n- Round both quantities to four significant figures.\n- The final answer must be presented as two numbers in a single row in the order: switching carbon price, right-hand derivative.",
            "solution": "The economic dispatch problem is a linear program (LP) that seeks to minimize the total generation cost subject to meeting demand and respecting operational constraints. The decision variables are the dispatch levels $x_1$ and $x_2$ for the two generators.\n\nThe total cost for generator $i$ over the one-hour interval, inclusive of the carbon price $p$, is the sum of its fuel cost and its carbon cost. The marginal cost of generation, which includes the carbon cost, is given by $mc_i(p) = c_i + p \\tau_i$. The objective function is to minimize the total system cost, which is the sum of costs from both generators.\n\nThe LP is formulated as:\n$$\n\\min_{x_1, x_2} C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2\n$$\nsubject to:\n\\begin{align*}\n    x_1 + x_2 &= D & (\\text{dual variable: } \\lambda) \\\\\n    x_1 &\\ge 0 & (\\text{dual variable: } \\mu_1) \\\\\n    x_2 &\\ge 0 & (\\text{dual variable: } \\mu_2) \\\\\n    x_1 &\\le U_1 & (\\text{dual variable: } \\gamma_1) \\\\\n    x_2 &\\le U_2 & (\\text{dual variable: } \\gamma_2)\n\\end{align*}\nThe problem is to find the value of the parameter $p$ at which the optimal basis changes, and the sensitivity of the optimal cost to $p$ at this point.\n\nTask 1: Derive the switching carbon price.\nThe dispatch order, or merit order, is determined by the marginal costs $mc_1(p)$ and $mc_2(p)$. The generator with the lower marginal cost is dispatched first. A switch in the dispatch order occurs when the marginal costs become equal. We will formally derive this condition using the Karush-Kuhn-Tucker (KKT) conditions.\n\nFirst, we rewrite the constraints in the standard form $g_j(x) \\le 0$:\n$h_1(x) = x_1 + x_2 - D = 0$\n$g_1(x) = -x_1 \\le 0$\n$g_2(x) = -x_2 \\le 0$\n$g_3(x) = x_1 - U_1 \\le 0$\n$g_4(x) = x_2 - U_2 \\le 0$\n\nThe Lagrangian is:\n$\\mathcal{L}(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\gamma_1, \\gamma_2) = (c_1+p\\tau_1)x_1 + (c_2+p\\tau_2)x_2 + \\lambda(x_1+x_2-D) - \\mu_1 x_1 - \\mu_2 x_2 + \\gamma_1(x_1-U_1) + \\gamma_2(x_2-U_2)$,\nwhere the dual variables for inequality constraints must be non-negative: $\\mu_1, \\mu_2, \\gamma_1, \\gamma_2 \\ge 0$.\n\nThe KKT stationarity conditions are $\\frac{\\partial \\mathcal{L}}{\\partial x_1} = 0$ and $\\frac{\\partial \\mathcal{L}}{\\partial x_2} = 0$:\n\\begin{align*}\n    c_1 + p\\tau_1 + \\lambda - \\mu_1 + \\gamma_1 &= 0 \\quad (1) \\\\\n    c_2 + p\\tau_2 + \\lambda - \\mu_2 + \\gamma_2 &= 0 \\quad (2)\n\\end{align*}\nComplementary slackness conditions are $\\mu_1 x_1 = 0$, $\\mu_2 x_2 = 0$, $\\gamma_1(x_1 - U_1) = 0$, and $\\gamma_2(x_2 - U_2) = 0$.\n\nThe demand is $D = 320\\text{ MW}$, which is less than either generator's capacity ($U_1 = 500\\text{ MW}$, $U_2 = 500\\text{ MW}$). Thus, one generator can satisfy the entire demand. The optimal solution will be a corner solution where one generator produces $D$ and the other produces $0$, unless their marginal costs are equal.\n\nCase A: Generator 1 serves the entire demand.\nThe proposed solution is $x_1^* = D$ and $x_2^* = 0$.\nSince $D > 0$ and $D < U_1$, we have $x_1^* > 0$ and $x_1^* < U_1$. Complementary slackness implies $\\mu_1 = 0$ and $\\gamma_1 = 0$.\nSince $x_2^* = 0$, $\\mu_2 \\ge 0$. Since $x_2^* < U_2$, $\\gamma_2=0$.\nSubstituting these into the stationarity equations:\nFrom $(1)$: $c_1 + p\\tau_1 + \\lambda = 0 \\implies \\lambda = -(c_1 + p\\tau_1)$.\nFrom $(2)$: $c_2 + p\\tau_2 + \\lambda - \\mu_2 = 0$.\nSubstituting $\\lambda$: $c_2 + p\\tau_2 - (c_1 + p\\tau_1) - \\mu_2 = 0 \\implies \\mu_2 = (c_2 + p\\tau_2) - (c_1 + p\\tau_1)$.\nFor this solution to be optimal, dual feasibility requires $\\mu_2 \\ge 0$. This implies $c_2 + p\\tau_2 \\ge c_1 + p\\tau_1$.\nThis confirms that Generator $1$ is dispatched when its marginal cost is less than or equal to that of Generator $2$.\n\nCase B: Generator 2 serves the entire demand.\nThe proposed solution is $x_1^* = 0$ and $x_2^* = D$.\nBy symmetric reasoning, complementary slackness implies $\\mu_1 \\ge 0, \\gamma_1 = 0, \\mu_2 = 0, \\gamma_2 = 0$.\nSubstituting into stationarity equations:\nFrom $(2)$: $c_2 + p\\tau_2 + \\lambda = 0 \\implies \\lambda = -(c_2 + p\\tau_2)$.\nFrom $(1)$: $c_1 + p\\tau_1 + \\lambda - \\mu_1 = 0$.\nSubstituting $\\lambda$: $c_1 + p\\tau_1 - (c_2 + p\\tau_2) - \\mu_1 = 0 \\implies \\mu_1 = (c_1 + p\\tau_1) - (c_2 + p\\tau_2)$.\nFor this solution to be optimal, dual feasibility requires $\\mu_1 \\ge 0$. This implies $c_1 + p\\tau_1 \\ge c_2 + p\\tau_2$.\nThis confirms that Generator $2$ is dispatched when its marginal cost is less than or equal to that of Generator $1$.\n\nThe switch in dispatch order occurs when the condition for optimality switches from one case to the other. This happens at the boundary where both conditions hold, which is when the marginal costs are equal:\n$$c_1 + p_{\\text{switch}}\\tau_1 = c_2 + p_{\\text{switch}}\\tau_2$$\nSolving for $p_{\\text{switch}}$:\n$$p_{\\text{switch}}(\\tau_1 - \\tau_2) = c_2 - c_1$$\n$$p_{\\text{switch}} = \\frac{c_2 - c_1}{\\tau_1 - \\tau_2}$$\nUsing the given values: $c_1=21$, $c_2=36$, $\\tau_1=0.88$, $\\tau_2=0.39$.\n$$p_{\\text{switch}} = \\frac{36 - 21}{0.88 - 0.39} = \\frac{15}{0.49} \\approx 30.61224\\dots$$\nRounded to four significant figures, the switching price is $30.61$ $\\text{\\$/tCO}_2$.\n\nTask 2: Right-hand derivative of the minimum cost.\nLet $C^*(p)$ be the minimum total cost as a function of the carbon price $p$. We need to calculate the right-hand derivative $\\frac{dC^*(p)}{dp^+}|_{p=p_{\\text{switch}}}$.\nThe problem requires using the envelope theorem. For a parameterized minimization problem $V(\\theta) = \\min_x F(x, \\theta)$, the theorem states that $\\frac{dV}{d\\theta} = \\frac{\\partial \\mathcal{L}}{\\partial \\theta}|_{x=x^*(\\theta)}$, where $\\mathcal{L}$ is the Lagrangian and $x^*(\\theta)$ is the optimal solution. When the parameter only appears in the objective function, this simplifies to $\\frac{dV}{d\\theta} = \\frac{\\partial F}{\\partial \\theta}|_{x=x^*(\\theta)}$.\n\nOur objective function is $C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2$.\nThe partial derivative with respect to $p$ is:\n$$\\frac{\\partial C}{\\partial p} = \\tau_1 x_1 + \\tau_2 x_2$$\nBy the envelope theorem, the sensitivity of the optimal cost to the carbon price is:\n$$\\frac{dC^*(p)}{dp} = \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p)$$\nThis expression represents the total carbon emissions (in metric tons per hour) of the optimal dispatch.\n\nTo find the right-hand derivative at $p = p_{\\text{switch}}$, we need to evaluate this expression using the optimal solution $x^*(p)$ that holds for $p > p_{\\text{switch}}$.\nLet's analyze the marginal costs for $p > p_{\\text{switch}}$.\nWith $c_1=21$, $c_2=36$, $\\tau_1=0.88$, $\\tau_2=0.39$, we have $c_2 > c_1$ and $\\tau_1 > \\tau_2$. This means Generator $1$ has a lower non-carbon cost but a higher emissions intensity. As the carbon price $p$ increases, the marginal cost of Generator $1$ rises faster than that of Generator $2$.\nFor $p < p_{\\text{switch}}$, $mc_1(p) < mc_2(p)$.\nFor $p > p_{\\text{switch}}$, $mc_1(p) > mc_2(p)$.\nThus, for any $p$ just to the right of $p_{\\text{switch}}$, Generator $2$ is the cheaper one. The optimal dispatch is to use Generator $2$ to meet the entire demand:\n$$x_1^*(p) = 0, \\quad x_2^*(p) = D = 320$$\nThe right-hand derivative is therefore:\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = \\lim_{p\\to p_{\\text{switch}}^+} \\left( \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p) \\right) = \\tau_1 (0) + \\tau_2 (D) = \\tau_2 D\n$$\nSubstituting the numerical values:\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = 0.39 \\frac{\\text{tCO}_2}{\\text{MWh}} \\times 320 \\text{ MW} = 124.8 \\frac{\\text{tCO}_2}{\\text{h}}\n$$\nThis value has four significant figures.\n\nThe results are:\nSwitching carbon price: $p_{\\text{switch}} = 30.61$ $\\text{\\$/tCO}_2$.\nRight-hand derivative of minimum cost: $\\frac{dC^*}{dp^+} = 124.8$ $\\text{tCO}_2/\\text{h}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.61 & 124.8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the previous exercise, this problem explores the important and often counter-intuitive concept of degeneracy in linear programming. By setting the marginal costs of two generators to be identical, we create a situation with multiple optimal solutions. Your task is to analyze how the optimal solution and its value behave as a generator's capacity, $\\theta$, changes . This practice is designed to sharpen your understanding of reduced costs and shadow prices, revealing why a non-basic variable can have a zero reduced cost and why the objective function's sensitivity can be zero even when a constraint is being modified.",
            "id": "4110427",
            "problem": "Consider a single-period economic dispatch model for two thermal generators supplying a fixed demand in an electricity system. Let the decision variables be $x_1$ and $x_2$, the electrical outputs (in $\\mathrm{MW}$) of Generator $1$ and Generator $2$, respectively, during an hour. The system demand is a fixed constant $D$ (in $\\mathrm{MW}$). Generator $1$ has a nameplate capacity $\\theta$ (in $\\mathrm{MW}$), which is a parameter. Generator $2$ has a nameplate capacity $U_2$ (in $\\mathrm{MW}$) that satisfies $U_2 > D$. Both generators have identical constant marginal costs equal to $\\bar{c}$ (in $\\mathrm{\\$}/\\mathrm{MWh}$). Ignore start-up costs, minimum output levels, and ramping limits.\n\nFormulate the following Linear Programming (LP) problem (to be understood as minimizing total operating cost in $\\mathrm{\\$}$ over the hour):\n$$\n\\min_{x_1,x_2} \\ \\bar{c}\\,x_1 + \\bar{c}\\,x_2\n$$\nsubject to\n$$\nx_1 + x_2 \\,=\\, D,\\quad 0 \\,\\le\\, x_1 \\,\\le\\, \\theta,\\quad 0 \\,\\le\\, x_2 \\,\\le\\, U_2.\n$$\n\nUsing only fundamental LP optimality conditions (primal feasibility, dual feasibility, and complementary slackness) and the definition of reduced costs, analyze the parametric dependence on the capacity parameter $\\theta$ and establish a nonempty interval of $\\theta$ over which:\n- the reduced cost of $x_1$ remains equal to zero while $x_1$ stays at its lower bound $x_1^{\\star} = 0$ in an optimal basic feasible solution, and\n- the optimal objective value $V^{\\star}(\\theta)$ is constant (flat) with respect to $\\theta$.\n\nOver that interval, compute the exact value of the sensitivity $\\frac{d}{d\\theta} V^{\\star}(\\theta)$ and express it in $\\mathrm{\\$}/\\mathrm{h}/\\mathrm{MW}$. No rounding is required. Clearly state the final numerical value asked for.",
            "solution": "The objective function is to minimize $V = \\bar{c}\\,x_1 + \\bar{c}\\,x_2$, which can be rewritten as $V = \\bar{c}\\,(x_1 + x_2)$.\nThe first constraint is the demand balance equation: $x_1 + x_2 = D$.\nSubstituting this constraint into the objective function, we find that for any feasible solution, the objective value is constant:\n$$ V = \\bar{c}\\,D $$\nThis implies that any feasible solution is an optimal solution. The optimal objective value, $V^{\\star}(\\theta)$, is therefore equal to $\\bar{c}D$ as long as the problem's feasible set is non-empty. The problem is feasible for any $\\theta \\ge 0$, because the constraint $U_2 > D$ ensures Generator 2 alone can meet demand. Thus, for the entire interval $\\theta \\in [0, \\infty)$, the optimal objective value is constant, $V^{\\star}(\\theta) = \\bar{c}D$. This satisfies the third condition given in the problem statement.\n\nNext, we require an optimal basic feasible solution (BFS) with $x_1^{\\star} = 0$. The solution $(x_1^{\\star}, x_2^{\\star}) = (0, D)$ is a BFS. Since any feasible solution is optimal, this is an optimal BFS. This solution satisfies the constraint $0 \\le x_1^{\\star} \\le \\theta$ (i.e., $0 \\le 0 \\le \\theta$) for all $\\theta \\ge 0$. This satisfies the second condition for the interval $\\theta \\in [0, \\infty)$.\n\nFinally, we must verify that the reduced cost of the non-basic variable $x_1$ is zero for this BFS. Let's find the dual variable for the demand balance constraint. The Lagrangian is:\n$$ \\mathcal{L}(x_1, x_2, \\lambda, \\dots) = \\bar{c}\\,x_1 + \\bar{c}\\,x_2 + \\lambda(D - x_1 - x_2) + \\dots $$\nThe KKT stationarity condition for the basic variable $x_2$ (which is strictly between its bounds $0$ and $U_2$) must hold with its inequality multipliers being zero:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial x_2} = \\bar{c} - \\lambda = 0 \\implies \\lambda = \\bar{c} $$\nThe reduced cost of the non-basic variable $x_1$ (at its lower bound) is given by the derivative of the Lagrangian with respect to $x_1$, evaluated at the optimal dual values:\n$$ \\text{Reduced Cost}_{x_1} = \\frac{\\partial \\mathcal{L}}{\\partial x_1} = \\bar{c} - \\lambda = \\bar{c} - \\bar{c} = 0 $$\nThis satisfies the first condition. All three conditions are met for the non-empty interval $\\theta \\in [0, \\infty)$.\n\nThe final task is to compute the sensitivity $\\frac{d}{d\\theta} V^{\\star}(\\theta)$ over this interval. Since we established that $V^{\\star}(\\theta) = \\bar{c}D$, a constant, its derivative with respect to $\\theta$ is zero.\n$$ \\frac{d}{d\\theta} V^{\\star}(\\theta) = \\frac{d}{d\\theta} (\\bar{c}D) = 0 $$\nThe sensitivity is 0 $\\mathrm{\\$}/\\mathrm{h}/\\mathrm{MW}$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Our final practice problem elevates the analysis to a more realistic and complex model: a multi-period economic dispatch formulated as a convex Quadratic Program (QP) with inter-temporal ramping constraints. Here, the parameter $p$ scales the entire demand profile, affecting the right-hand side of the equality constraints. Under the assumption of a constant active set of constraints, you will derive the linear system that defines the sensitivity of the optimal generation dispatch with respect to the demand parameter . This advanced exercise demonstrates a powerful, generalizable method for sensitivity analysis by differentiating the KKT conditions, a technique essential for studying the stability and response of complex energy system models.",
            "id": "4110428",
            "problem": "Consider an economic dispatch problem in an energy system with $N$ thermal generators over $T$ discrete time intervals. Let $x \\in \\mathbb{R}^{n}$ with $n = N T$ collect the generation outputs $x_{g,t}$ for generator index $g \\in \\{1,\\dots,N\\}$ and time index $t \\in \\{1,\\dots,T\\}$. The generation cost is modeled as a strictly convex quadratic function with symmetric positive definite Hessian $Q \\in \\mathbb{R}^{n \\times n}$ and linear term $c \\in \\mathbb{R}^{n}$. The load balance at each time is enforced by equality constraints of the form\n$$\n\\sum_{g=1}^{N} x_{g,t} \\;=\\; p \\, d_{t} \\quad \\text{for all } t \\in \\{1,\\dots,T\\},\n$$\nwhere $d \\in \\mathbb{R}^{T}$ is a fixed, strictly positive demand profile and $p > 0$ is a scalar parameter that scales the demand. Collect these $T$ equality constraints into a compact form $A x = p d$, where $A \\in \\mathbb{R}^{T \\times n}$ is the time-aggregation matrix that maps unit-level outputs to total load per time.\n\nIntertemporal ramping constraints couple consecutive time periods for each generator, enforcing\n$$\n- R^{-}_{g,t} \\;\\le\\; x_{g,t+1} - x_{g,t} \\;\\le\\; R^{+}_{g,t} \\quad \\text{for } t \\in \\{1,\\dots,T-1\\}, \\; g \\in \\{1,\\dots,N\\},\n$$\nwith given ramp-down limits $R^{-}_{g,t} > 0$ and ramp-up limits $R^{+}_{g,t} > 0$. These can be written compactly as $G x \\le r$, where $G \\in \\mathbb{R}^{m_{\\mathrm{ineq}} \\times n}$ and $r \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ collect the linear coefficients and bounds of the inequality constraints.\n\nAssume the following regularity and realism conditions hold at an optimal solution for a given parameter value $p$:\n- The Hessian $Q$ is symmetric positive definite.\n- The Linear Independence Constraint Qualification (LICQ) holds for the active constraints at the optimum.\n- Strict complementarity holds for the active inequalities.\n- The active inequality set $\\mathcal{A}$ (the index set of ramp constraints that bind at the optimum) remains unchanged in an open neighborhood of the given $p$.\n\nLet $G_{\\mathcal{A}} \\in \\mathbb{R}^{k \\times n}$ denote the submatrix of $G$ associated with the $k$ active ramp constraints, and let $r_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ denote the corresponding bounds. The optimal primal-dual variables are $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu^{\\star}_{\\mathcal{A}}(p))$, where $\\lambda^{\\star} \\in \\mathbb{R}^{T}$ are the equality-constraint multipliers and $\\mu^{\\star}_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ are the multipliers of the active ramp constraints.\n\nStarting from first principles for convex quadratic optimization and the Karush-Kuhn-Tucker (KKT) optimality conditions, derive the sensitivity system that governs $\\frac{d x^{\\star}}{d p}$, $\\frac{d \\lambda^{\\star}}{d p}$, and $\\frac{d \\mu^{\\star}_{\\mathcal{A}}}{d p}$ when the parameter $p$ multiplies the demand vector $d$ on the right-hand side of the equality constraints. Under the stated regularity assumptions, express $\\frac{d x^{\\star}}{d p}$ as a single closed-form analytic expression using a block-matrix inverse, in terms of $Q$, $A$, $G_{\\mathcal{A}}$, and $d$ only. Provide your final expression for $\\frac{d x^{\\star}}{d p}$.\n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The user wants to derive the sensitivity of the optimal generation outputs, $\\frac{d x^{\\star}}{d p}$, with respect to a demand scaling parameter $p$ for a convex quadratic economic dispatch problem. The derivation must start from first principles, leveraging the Karush-Kuhn-Tucker (KKT) conditions and the provided regularity assumptions.\n\nThe optimization problem can be formulated as a parametric quadratic program (QP):\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad & \\frac{1}{2} x^T Q x + c^T x \\\\\n\\text{subject to} \\quad & A x = p d \\\\\n& G x \\le r\n\\end{aligned}\n$$\nwhere $x$ is the vector of generation outputs, $Q$ is the symmetric positive definite cost Hessian, $c$ is the linear cost vector, $A$ is the time-aggregation matrix for the load balance constraints, $d$ is the base demand profile, $p$ is the scalar parameter, $G$ represents the ramping constraints, and $r$ contains the ramp limits.\n\nThe Lagrangian for this problem is:\n$$\n\\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} x^T Q x + c^T x + \\lambda^T (A x - p d) + \\mu^T (G x - r)\n$$\nHere, $\\lambda \\in \\mathbb{R}^T$ are the Lagrange multipliers for the equality constraints, and $\\mu \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ are the multipliers for the inequality constraints.\n\nThe KKT conditions for an optimal solution $(x^{\\star}, \\lambda^{\\star}, \\mu^{\\star})$ are:\n1.  **Stationarity:** $\\nabla_x \\mathcal{L} = Q x^{\\star} + c + A^T \\lambda^{\\star} + G^T \\mu^{\\star} = 0$\n2.  **Primal Feasibility (Equality):** $A x^{\\star} - p d = 0$\n3.  **Primal Feasibility (Inequality):** $G x^{\\star} - r \\le 0$\n4.  **Dual Feasibility:** $\\mu^{\\star} \\ge 0$\n5.  **Complementary Slackness:** $\\mu_i^{\\star}((G x^{\\star})_i - r_i) = 0$ for all $i = 1, \\dots, m_{\\mathrm{ineq}}$.\n\nThe problem states crucial regularity conditions for a given optimal solution corresponding to the parameter value $p$. Specifically, Linear Independence Constraint Qualification (LICQ) and strict complementarity hold, and—most importantly—the set of active inequality constraints, denoted by $\\mathcal{A}$, is assumed to be constant in an open neighborhood of $p$. This allows us to treat the optimal solution and its multipliers as differentiable functions of $p$, i.e., $x^{\\star}(p)$, $\\lambda^{\\star}(p)$, and $\\mu^{\\star}(p)$.\n\nUnder the constant active set assumption, the KKT system simplifies. For inequality constraints with index $i \\in \\mathcal{A}$, the constraint is binding, i.e., $(G_{\\mathcal{A}} x^{\\star}(p))_i = (r_{\\mathcal{A}})_i$. For indices $j \\notin \\mathcal{A}$, the constraint is slack, $(G x^{\\star}(p))_j < r_j$, and by complementary slackness, the corresponding multiplier is zero, $\\mu_j^{\\star}(p) = 0$.\nThus, the Stationarity condition simplifies to $Q x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0$, where $\\mu_{\\mathcal{A}}^{\\star}$ contains only the multipliers for the active constraints.\n\nThe optimality conditions for the solution path $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu_{\\mathcal{A}}^{\\star}(p))$ in a neighborhood of $p$ become a system of equations:\n$$\n\\begin{cases}\nQ x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0 \\\\\nA x^{\\star}(p) - p d = 0 \\\\\nG_{\\mathcal{A}} x^{\\star}(p) - r_{\\mathcal{A}} = 0\n\\end{cases}\n$$\nTo find the sensitivities, we differentiate this system with respect to the parameter $p$. We denote the derivatives as $\\frac{d x^{\\star}}{d p}$, $\\frac{d \\lambda^{\\star}}{d p}$, and $\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}$. The matrices $Q$, $A$, $G_{\\mathcal{A}}$ and vectors $c$, $d$, $r_{\\mathcal{A}}$ are constant with respect to $p$.\n\nDifferentiating the first equation yields:\n$$\nQ \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0\n$$\nDifferentiating the second equation yields:\n$$\nA \\frac{d x^{\\star}}{d p} - d = 0 \\implies A \\frac{d x^{\\star}}{d p} = d\n$$\nDifferentiating the third equation yields:\n$$\nG_{\\mathcal{A}} \\frac{d x^{\\star}}{d p} = 0\n$$\nWe can arrange these three linear equations for the unknown derivatives into a single block-matrix system:\n$$\n\\begin{pmatrix}\nQ & A^T & G_{\\mathcal{A}}^T \\\\\nA & 0 & 0 \\\\\nG_{\\mathcal{A}} & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{d x^{\\star}}{d p} \\\\\n\\frac{d \\lambda^{\\star}}{d p} \\\\\n\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\nd \\\\\n0\n\\end{pmatrix}\n$$\nThe problem asks for an expression for $\\frac{d x^{\\star}}{d p}$. We can solve this system using block substitution. Let's rewrite the system by isolating the first block-row equation and combining the second and third:\n1. $Q \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0$\n2. $\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\frac{d x^{\\star}}{d p} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}$\n\nFrom (1), since $Q$ is positive definite and thus invertible, we can express $\\frac{d x^{\\star}}{d p}$ in terms of the multiplier sensitivities:\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\left( A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\right) = - Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix}\n$$\nNow, substitute this expression into equation (2):\n$$\n\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\left( -Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} \\right) = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nRearranging gives:\n$$\n- \\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nMultiplying out the block matrices gives the Schur complement of the $Q$ block:\n$$\n- \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nThe matrix on the left is invertible due to the LICQ and positive definiteness of $Q$. We can solve for the vector of multiplier sensitivities:\n$$\n\\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = - \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nFinally, we substitute this back into our expression for $\\frac{d x^{\\star}}{d p}$:\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\left( - \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix} \\right)\n$$\nSimplifying the signs, we arrive at the final closed-form expression for the sensitivity of the primal variables:\n$$\n\\frac{d x^{\\star}}{d p} = Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\nThis expression provides the derivative of the optimal generation vector with respect to the demand scaling parameter, exclusively in terms of the problem data $Q$, $A$, $G_{\\mathcal{A}}$, and $d$, as required. Note that $Q^{-1}$ is derived directly from $Q$.",
            "answer": "$$\n\\boxed{Q^{-1} \\begin{pmatrix} A^T & G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T & A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T & G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}}\n$$"
        }
    ]
}