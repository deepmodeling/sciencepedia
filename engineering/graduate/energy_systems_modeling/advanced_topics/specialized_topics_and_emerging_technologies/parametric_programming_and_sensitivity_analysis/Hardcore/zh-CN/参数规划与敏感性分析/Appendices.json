{
    "hands_on_practices": [
        {
            "introduction": "碳定价是影响电力系统运行和经济性的关键政策工具。本练习旨在通过一个双发电机经济调度模型，实践如何确定导致发电机调度顺序（即“经济排序”）发生改变的关键碳价格点。通过从第一性原理出发应用KKT条件，您将深入理解参数变化如何改变线性规划的最优基，这对于分析政策对电力系统的影响至关重要。",
            "id": "4110397",
            "problem": "考虑一个电力系统中两个火力发电机组在一个小时内的单周期经济调度，该系统具有非弹性需求。发电机组 $1$ 的不含碳成本的可变运行成本为 $c_1$ 美元/兆瓦时，直接二氧化碳排放强度为 $\\tau_1$ 公吨二氧化碳/兆瓦时，铭牌容量为 $U_1$ 兆瓦。发电机组 $2$ 的相应参数为 $c_2$、$\\tau_2$ 和 $U_2$。统一的碳价 $p$（美元/公吨二氧化碳）适用于所有排放源。系统运营商通过最小化包含碳成本在内的总可变运行成本，来满足一小时内 $D$ 兆瓦的非弹性需求，同时假设每个发电机组的出力非负且受容量限制。决策变量是调度水平 $x_1$ 和 $x_2$（单位为兆瓦），表示一小时内的平均功率输出。\n\n该调度问题被表述为以下优化问题：\n- 决策变量：$x_1, x_2$。\n- 目标：最小化一小时内包含碳定价的总发电成本。\n- 约束条件：满足需求并遵守发电机组容量限制。\n\n仅使用线性优化和参数敏感性的基本原理。具体而言，从第一性原理出发，编写适当的线性规划，并使用Karush-Kuhn-Tucker (KKT) 条件、对偶可行性和互补松弛性推导最优性条件。然后利用这些条件确定最优基如何随碳价参数 $p$ 的变化而变化。最后，使用包络定理和对偶性计算最小成本相对于 $p$ 的敏感性。\n\n假设以下参数值：\n- $c_1 = 21$ 美元/兆瓦时，$\\tau_1 = 0.88$ 公吨二氧化碳/兆瓦时，以及 $U_1 = 500$ 兆瓦。\n- $c_2 = 36$ 美元/兆瓦时，$\\tau_2 = 0.39$ 公吨二氧化碳/兆瓦时，以及 $U_2 = 500$ 兆瓦。\n- 需求 $D = 320$ 兆瓦（在一小时内）。\n\n任务：\n1. 从第一性原理出发，推导两个发电机组之间调度顺序发生切换时的参数化碳价 $p$。您必须从线性规划及其最优性条件开始确定此切换值，而不是调用任何预先给定的专门公式。\n2. 使用最优值相对于参数 $p$ 的严格敏感性分析，确定在切换碳价处，最小总发电成本相对于 $p$ 的右导数。\n\n答案规格：\n- 以美元/公吨二氧化碳表示切换碳价。\n- 以公吨二氧化碳/小时表示切换点处的右导数。\n- 将两个量均四舍五入至四位有效数字。\n- 最终答案必须以单行两个数字的形式呈现，顺序为：切换碳价，右导数。",
            "solution": "经济调度问题是一个线性规划（LP），旨在最小化总发电成本，同时满足需求并遵守运行约束。决策变量是两个发电机组的调度水平 $x_1$ 和 $x_2$。\n\n在一小时内，发电机组 $i$ 的总成本（包括碳价 $p$）是其燃料成本和碳成本之和。包含碳成本的边际发电成本由 $mc_i(p) = c_i + p \\tau_i$ 给出。目标函数是最小化总系统成本，即两个发电机组的成本之和。\n\n该线性规划表述为：\n$$\n\\min_{x_1, x_2} C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2\n$$\n约束条件：\n\\begin{align*}\n    x_1 + x_2 = D  (\\text{对偶变量: } \\lambda) \\\\\n    x_1 \\ge 0  (\\text{对偶变量: } \\mu_1) \\\\\n    x_2 \\ge 0  (\\text{对偶变量: } \\mu_2) \\\\\n    x_1 \\le U_1  (\\text{对偶变量: } \\gamma_1) \\\\\n    x_2 \\le U_2  (\\text{对偶变量: } \\gamma_2)\n\\end{align*}\n问题在于找到最优基发生变化的参数 $p$ 的值，以及在该点最优成本对 $p$ 的敏感性。\n\n任务1：推导切换碳价。\n调度顺序，或称优先顺序，由边际成本 $mc_1(p)$ 和 $mc_2(p)$ 决定。边际成本较低的发电机组优先调度。当边际成本相等时，调度顺序发生切换。我们将使用 Karush-Kuhn-Tucker (KKT) 条件来正式推导这个条件。\n\n首先，我们将约束重写为标准形式 $g_j(x) \\le 0$：\n$h_1(x) = x_1 + x_2 - D = 0$\n$g_1(x) = -x_1 \\le 0$\n$g_2(x) = -x_2 \\le 0$\n$g_3(x) = x_1 - U_1 \\le 0$\n$g_4(x) = x_2 - U_2 \\le 0$\n\n拉格朗日函数是：\n$L(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\gamma_1, \\gamma_2) = (c_1+p\\tau_1)x_1 + (c_2+p\\tau_2)x_2 + \\lambda(x_1+x_2-D) + \\mu_1(-x_1) + \\mu_2(-x_2) + \\gamma_1(x_1-U_1) + \\gamma_2(x_2-U_2)$,\n其中不等式约束的对偶变量必须为非负：$\\mu_1, \\mu_2, \\gamma_1, \\gamma_2 \\ge 0$。\n\nKKT 平稳性条件是 $\\frac{\\partial L}{\\partial x_1} = 0$ 和 $\\frac{\\partial L}{\\partial x_2} = 0$：\n\\begin{align*}\n    c_1 + p\\tau_1 + \\lambda - \\mu_1 + \\gamma_1 = 0 \\quad (1) \\\\\n    c_2 + p\\tau_2 + \\lambda - \\mu_2 + \\gamma_2 = 0 \\quad (2)\n\\end{align*}\n互补松弛性条件是 $\\mu_1 x_1 = 0$、$\\mu_2 x_2 = 0$、$\\gamma_1(x_1 - U_1) = 0$ 和 $\\gamma_2(x_2 - U_2) = 0$。\n\n需求为 $D = 320 \\text{ MW}$，小于任一发电机组的容量（$U_1 = 500\\text{ MW}$，$U_2 = 500\\text{ MW}$）。因此，单个发电机组即可满足全部需求。最优解将是一个角点解，其中一个发电机组产出为 $D$，另一个为 $0$，除非它们的边际成本相等。\n\n情况A：发电机组1满足全部需求。\n提出的解为 $x_1^* = D$ 和 $x_2^* = 0$。\n由于 $D > 0$ 且 $D  U_1$，我们有 $x_1^* > 0$ 和 $x_1^*  U_1$。互补松弛性意味着 $\\mu_1 = 0$ 和 $\\gamma_1 = 0$。\n由于 $x_2^* = 0$，$\\mu_2 \\ge 0$。由于 $x_2^*  U_2$，$\\gamma_2=0$。\n将这些代入平稳性方程：\n由(1)式：$c_1 + p\\tau_1 + \\lambda = 0 \\implies \\lambda = -(c_1 + p\\tau_1)$。\n由(2)式：$c_2 + p\\tau_2 + \\lambda - \\mu_2 = 0$。\n代入 $\\lambda$：$c_2 + p\\tau_2 - (c_1 + p\\tau_1) - \\mu_2 = 0 \\implies \\mu_2 = (c_2 + p\\tau_2) - (c_1 + p\\tau_1)$。\n为使此解为最优解，对偶可行性要求 $\\mu_2 \\ge 0$。这意味着 $c_2 + p\\tau_2 \\ge c_1 + p\\tau_1$。\n这证实了当发电机组1的边际成本小于或等于发电机组2时，调度发电机组1。\n\n情况B：发电机组2满足全部需求。\n提出的解为 $x_1^* = 0$ 和 $x_2^* = D$。\n通过对称推理，互补松弛性意味着 $\\mu_1 \\ge 0, \\gamma_1 = 0, \\mu_2 = 0, \\gamma_2 = 0$。\n代入平稳性方程：\n由(2)式：$c_2 + p\\tau_2 + \\lambda = 0 \\implies \\lambda = -(c_2 + p\\tau_2)$。\n由(1)式：$c_1 + p\\tau_1 + \\lambda - \\mu_1 = 0$。\n代入 $\\lambda$：$c_1 + p\\tau_1 - (c_2 + p\\tau_2) - \\mu_1 = 0 \\implies \\mu_1 = (c_1 + p\\tau_1) - (c_2 + p\\tau_2)$。\n为使此解为最优解，对偶可行性要求 $\\mu_1 \\ge 0$。这意味着 $c_1 + p\\tau_1 \\ge c_2 + p\\tau_2$。\n这证实了当发电机组2的边际成本小于或等于发电机组1时，调度发电机组2。\n\n调度顺序的切换发生在最优性条件从一种情况切换到另一种情况时。这发生在两种条件都成立的边界上，即边际成本相等时：\n$$c_1 + p_{\\text{switch}}\\tau_1 = c_2 + p_{\\text{switch}}\\tau_2$$\n求解 $p_{\\text{switch}}$：\n$$p_{\\text{switch}}(\\tau_1 - \\tau_2) = c_2 - c_1$$\n$$p_{\\text{switch}} = \\frac{c_2 - c_1}{\\tau_1 - \\tau_2}$$\n使用给定值：$c_1=21$，$c_2=36$，$\\tau_1=0.88$，$\\tau_2=0.39$。\n$$p_{\\text{switch}} = \\frac{36 - 21}{0.88 - 0.39} = \\frac{15}{0.49} \\approx 30.61224\\dots$$\n四舍五入到四位有效数字，切换价格为 $30.61$ 美元/公吨 $\\text{CO}_2$。\n\n任务2：最小成本的右导数。\n令 $C^*(p)$ 为作为碳价 $p$ 函数的最小总成本。我们需要计算右导数 $\\frac{dC^*(p)}{dp^+}|_{p=p_{\\text{switch}}}$。\n该问题要求使用包络定理。对于参数化最小化问题 $V(\\theta) = \\min_x F(x, \\theta)$，该定理指出 $\\frac{dV}{d\\theta} = \\frac{\\partial L}{\\partial \\theta}|_{x=x^*(\\theta)}$，其中 $L$ 是拉格朗日函数，$x^*(\\theta)$ 是最优解。当参数仅出现在目标函数中时，这简化为 $\\frac{dV}{d\\theta} = \\frac{\\partial F}{\\partial \\theta}|_{x=x^*(\\theta)}$。\n\n我们的目标函数是 $C(x_1, x_2, p) = (c_1 + p \\tau_1) x_1 + (c_2 + p \\tau_2) x_2$。\n关于 $p$ 的偏导数是：\n$$\\frac{\\partial C}{\\partial p} = \\tau_1 x_1 + \\tau_2 x_2$$\n根据包络定理，最优成本对碳价的敏感性为：\n$$\\frac{dC^*(p)}{dp} = \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p)$$\n该表达式表示最优调度下的总碳排放量（单位为公吨/小时）。\n\n为了求出 $p = p_{\\text{switch}}$ 处的右导数，我们需要使用在 $p > p_{\\text{switch}}$ 时成立的最优解 $x^*(p)$ 来计算此表达式。\n我们来分析 $p > p_{\\text{switch}}$ 时的边际成本。\n当 $c_1=21$，$c_2=36$，$\\tau_1=0.88$，$\\tau_2=0.39$ 时，我们有 $c_2 > c_1$ 和 $\\tau_1 > \\tau_2$。这意味着发电机组1的非碳成本较低，但排放强度较高。随着碳价 $p$ 的增加，发电机组1的边际成本比发电机组2的上升得更快。\n对于 $p  p_{\\text{switch}}$，$mc_1(p)  mc_2(p)$。\n对于 $p > p_{\\text{switch}}$，$mc_1(p) > mc_2(p)$。\n因此，对于任何刚好在 $p_{\\text{switch}}$ 右侧的 $p$ 值，发电机组2都更便宜。最优调度是使用发电机组2来满足全部需求：\n$$x_1^*(p) = 0, \\quad x_2^*(p) = D = 320$$\n因此，右导数为：\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = \\lim_{p\\to p_{\\text{switch}}^+} \\left( \\tau_1 x_1^*(p) + \\tau_2 x_2^*(p) \\right) = \\tau_1 (0) + \\tau_2 (D) = \\tau_2 D\n$$\n代入数值：\n$$\n\\frac{dC^*}{dp^+}\\bigg|_{p=p_{\\text{switch}}} = 0.39 \\frac{\\text{tCO}_2}{\\text{MWh}} \\times 320 \\text{ MW} = 124.8 \\frac{\\text{tCO}_2}{\\text{h}}\n$$\n该值有四位有效数字。\n\n结果是：\n切换碳价：$p_{\\text{switch}} = 30.61$ 美元/吨CO$_2$。\n最小成本的右导数：$\\frac{dC^*}{dp^+} = 124.8$ 吨CO$_2$/小时。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.61  124.8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现实世界的能源系统模型常常超越线性规划，采用二次规划（QP）来更精确地描述成本函数。本项高级练习将指导您从第一性原理出发，为带有时序关联约束（如爬坡率）的二次经济调度问题推导其解的灵敏度。通过对KKT条件进行微分，您将构建一个线性方程组，它描述了当需求参数 $p$ 变化时，最优发电策略将如何响应，这是进行高级模型分析和算法设计的核心技能。",
            "id": "4110428",
            "problem": "考虑一个能源系统中的经济调度问题，该系统包含 $N$ 台火力发电机组和 $T$ 个离散时间间隔。令 $x \\in \\mathbb{R}^{n}$ (其中 $n = N T$) 集合了发电机组索引 $g \\in \\{1,\\dots,N\\}$ 和时间索引 $t \\in \\{1,\\dots,T\\}$ 的发电出力 $x_{g,t}$。发电成本被建模为一个严格凸二次函数，其Hessian矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，线性项为 $c \\in \\mathbb{R}^{n}$。每个时间的负荷平衡由以下形式的等式约束强制执行\n$$\n\\sum_{g=1}^{N} x_{g,t} \\;=\\; p \\, d_{t} \\quad \\text{for all } t \\in \\{1,\\dots,T\\},\n$$\n其中 $d \\in \\mathbb{R}^{T}$ 是一个固定的、严格为正的需求曲线，$p  0$ 是一个缩放需求的标量参数。将这 $T$ 个等式约束集合成紧凑形式 $A x = p d$，其中 $A \\in \\mathbb{R}^{T \\times n}$ 是时间聚合矩阵，它将机组级出力映射到每个时间的总负荷。\n\n跨时段爬坡约束将每个发电机组的连续时间段耦合起来，强制执行\n$$\n- R^{-}_{g,t} \\;\\le\\; x_{g,t+1} - x_{g,t} \\;\\le\\; R^{+}_{g,t} \\quad \\text{for } t \\in \\{1,\\dots,T-1\\}, \\; g \\in \\{1,\\dots,N\\},\n$$\n其中给定了向下爬坡限制 $R^{-}_{g,t}  0$ 和向上爬坡限制 $R^{+}_{g,t}  0$。这些可以紧凑地写成 $G x \\le r$，其中 $G \\in \\mathbb{R}^{m_{\\mathrm{ineq}} \\times n}$ 和 $r \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ 集合了不等式约束的线性系数和界限。\n\n假设对于给定的参数值 $p$，在最优解处满足以下正则性和现实性条件：\n- Hessian矩阵 $Q$ 是对称正定的。\n- 线性无关约束规范 (LICQ) 对最优解处的积极约束成立。\n- 严格互补性对积极不等式成立。\n- 积极不等式集合 $\\mathcal{A}$ (在最优解处达到边界的爬坡约束的索引集) 在给定 $p$ 的一个开放邻域内保持不变。\n\n令 $G_{\\mathcal{A}} \\in \\mathbb{R}^{k \\times n}$ 表示与 $k$ 个积极爬坡约束相关联的 $G$ 的子矩阵，并令 $r_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ 表示相应的界限。最优原始-对偶变量为 $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu^{\\star}_{\\mathcal{A}}(p))$，其中 $\\lambda^{\\star} \\in \\mathbb{R}^{T}$ 是等式约束乘子，$\\mu^{\\star}_{\\mathcal{A}} \\in \\mathbb{R}^{k}$ 是积极爬坡约束的乘子。\n\n从凸二次优化的第一性原理和 Karush-Kuhn-Tucker (KKT) 最优性条件出发，当参数 $p$ 乘以等式约束右侧的需求向量 $d$ 时，推导控制 $\\frac{d x^{\\star}}{d p}$、$\\frac{d \\lambda^{\\star}}{d p}$ 和 $\\frac{d \\mu^{\\star}_{\\mathcal{A}}}{d p}$ 的灵敏度系统。在所述的正则性假设下，仅使用 $Q$、$A$、$G_{\\mathcal{A}}$ 和 $d$，通过分块矩阵求逆将 $\\frac{d x^{\\star}}{d p}$ 表示为单一的闭式解析表达式。提供您关于 $\\frac{d x^{\\star}}{d p}$ 的最终表达式。\n\n您的最终答案必须是单一的闭式解析表达式。无需进行数值计算。",
            "solution": "用户希望针对一个凸二次经济调度问题，推导最优发电出力对需求缩放参数 $p$ 的灵敏度 $\\frac{d x^{\\star}}{d p}$。推导必须从第一性原理开始，利用 Karush-Kuhn-Tucker (KKT) 条件和所提供的正则性假设。\n\n该优化问题可以被表述为一个参数二次规划 (QP)：\n$$\n\\begin{aligned}\n\\min_{x \\in \\mathbb{R}^n} \\quad  \\frac{1}{2} x^T Q x + c^T x \\\\\n\\text{subject to} \\quad  A x = p d \\\\\n G x \\le r\n\\end{aligned}\n$$\n其中 $x$ 是发电出力向量，$Q$ 是对称正定的成本Hessian矩阵，$c$ 是线性成本向量，$A$ 是负荷平衡约束的时间聚合矩阵，$d$ 是基础需求曲线，$p$ 是标量参数，$G$ 代表爬坡约束，$r$ 包含爬坡限制。\n\n该问题的拉格朗日函数是：\n$$\n\\mathcal{L}(x, \\lambda, \\mu) = \\frac{1}{2} x^T Q x + c^T x + \\lambda^T (A x - p d) + \\mu^T (G x - r)\n$$\n这里，$\\lambda \\in \\mathbb{R}^T$ 是等式约束的拉格朗日乘子，$\\mu \\in \\mathbb{R}^{m_{\\mathrm{ineq}}}$ 是不等式约束的乘子。\n\n最优解 $(x^{\\star}, \\lambda^{\\star}, \\mu^{\\star})$ 的KKT条件是：\n1.  **驻点条件：** $\\nabla_x \\mathcal{L} = Q x^{\\star} + c + A^T \\lambda^{\\star} + G^T \\mu^{\\star} = 0$\n2.  **原始可行性 (等式)：** $A x^{\\star} - p d = 0$\n3.  **原始可行性 (不等式)：** $G x^{\\star} - r \\le 0$\n4.  **对偶可行性：** $\\mu^{\\star} \\ge 0$\n5.  **互补松弛性：** $\\mu_i^{\\star}((G x^{\\star})_i - r_i) = 0$ for all $i = 1, \\dots, m_{\\mathrm{ineq}}$.\n\n问题陈述了对应于参数值 $p$ 的给定最优解的关键正则性条件。具体来说，线性无关约束规范 (LICQ) 和严格互补性成立，并且——最重要的是——假设积极不等式约束的集合（记为 $\\mathcal{A}$）在 $p$ 的一个开放邻域内是恒定的。这使我们能够将最优解及其乘子视为 $p$ 的可微函数，即 $x^{\\star}(p)$、$\\lambda^{\\star}(p)$ 和 $\\mu^{\\star}(p)$。\n\n在积极集不变假设下，KKT系统得以简化。对于索引 $i \\in \\mathcal{A}$ 的不等式约束，该约束是紧的，即 $(G_{\\mathcal{A}} x^{\\star}(p))_i = (r_{\\mathcal{A}})_i$。对于索引 $j \\notin \\mathcal{A}$，约束是松弛的，即 $(G x^{\\star}(p))_j  r_j$，并且根据互补松弛性，相应的乘子为零，即 $\\mu_j^{\\star}(p) = 0$。\n因此，驻点条件简化为 $Q x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0$，其中 $\\mu_{\\mathcal{A}}^{\\star}$ 仅包含积极约束的乘子。\n\n在 $p$ 的一个邻域内，解路径 $(x^{\\star}(p), \\lambda^{\\star}(p), \\mu_{\\mathcal{A}}^{\\star}(p))$ 的最优性条件成为一个方程组：\n$$\n\\begin{cases}\nQ x^{\\star}(p) + c + A^T \\lambda^{\\star}(p) + G_{\\mathcal{A}}^T \\mu_{\\mathcal{A}}^{\\star}(p) = 0 \\\\\nA x^{\\star}(p) - p d = 0 \\\\\nG_{\\mathcal{A}} x^{\\star}(p) - r_{\\mathcal{A}} = 0\n\\end{cases}\n$$\n为了找到灵敏度，我们对该系统关于参数 $p$ 求导。我们将导数表示为 $\\frac{d x^{\\star}}{d p}$、$\\frac{d \\lambda^{\\star}}{d p}$ 和 $\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}$。矩阵 $Q$、$A$、$G_{\\mathcal{A}}$ 和向量 $c$、$d$、$r_{\\mathcal{A}}$ 相对于 $p$ 是常数。\n\n对第一个方程求导得出：\n$$\nQ \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0\n$$\n对第二个方程求导得出：\n$$\nA \\frac{d x^{\\star}}{d p} - d = 0 \\implies A \\frac{d x^{\\star}}{d p} = d\n$$\n对第三个方程求导得出：\n$$\nG_{\\mathcal{A}} \\frac{d x^{\\star}}{d p} = 0\n$$\n我们可以将这三个关于未知导数的线性方程组排列成一个单一的分块矩阵系统：\n$$\n\\begin{pmatrix}\nQ  A^T  G_{\\mathcal{A}}^T \\\\\nA  0  0 \\\\\nG_{\\mathcal{A}}  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{d x^{\\star}}{d p} \\\\\n\\frac{d \\lambda^{\\star}}{d p} \\\\\n\\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\nd \\\\\n0\n\\end{pmatrix}\n$$\n问题要求 $\\frac{d x^{\\star}}{d p}$ 的表达式。我们可以使用分块代入法求解该系统。我们重写该系统，分离出第一个分块行方程，并合并第二和第三个方程：\n1. $Q \\frac{d x^{\\star}}{d p} + A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} = 0$\n2. $\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\frac{d x^{\\star}}{d p} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}$\n\n从(1)可知，由于 $Q$ 是正定的，因此是可逆的，我们可以用乘子灵敏度来表示 $\\frac{d x^{\\star}}{d p}$：\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\left( A^T \\frac{d \\lambda^{\\star}}{d p} + G_{\\mathcal{A}}^T \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\right) = - Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix}\n$$\n现在，将此表达式代入方程(2)：\n$$\n\\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} \\left( -Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} \\right) = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n整理后得到：\n$$\n- \\begin{pmatrix} A \\\\ G_{\\mathcal{A}} \\end{pmatrix} Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n将分块矩阵相乘得到 $Q$ 块的舒尔补：\n$$\n- \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n由于LICQ和 $Q$ 的正定性，左侧的矩阵是可逆的。我们可以求解乘子灵敏度向量：\n$$\n\\begin{pmatrix} \\frac{d \\lambda^{\\star}}{d p} \\\\ \\frac{d \\mu_{\\mathcal{A}}^{\\star}}{d p} \\end{pmatrix} = - \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n最后，我们将其代回到我们关于 $\\frac{d x^{\\star}}{d p}$ 的表达式中：\n$$\n\\frac{d x^{\\star}}{d p} = - Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\left( - \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix} \\right)\n$$\n简化符号后，我们得到原始变量灵敏度的最终闭式表达式：\n$$\n\\frac{d x^{\\star}}{d p} = Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}\n$$\n该表达式提供了最优发电向量相对于需求缩放参数的导数，并且如要求的那样，仅用问题数据 $Q$、$A$、$G_{\\mathcal{A}}$ 和 $d$ 来表示。注意 $Q^{-1}$ 是直接从 $Q$ 推导出来的。",
            "answer": "$$\n\\boxed{Q^{-1} \\begin{pmatrix} A^T  G_{\\mathcal{A}}^T \\end{pmatrix} \\begin{pmatrix} A Q^{-1} A^T  A Q^{-1} G_{\\mathcal{A}}^T \\\\ G_{\\mathcal{A}} Q^{-1} A^T  G_{\\mathcal{A}} Q^{-1} G_{\\mathcal{A}}^T \\end{pmatrix}^{-1} \\begin{pmatrix} d \\\\ 0 \\end{pmatrix}}\n$$"
        }
    ]
}