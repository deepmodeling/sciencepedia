{
    "hands_on_practices": [
        {
            "introduction": "在构建数据驱动的代理模型之前，关键的第一步是高效地从高维输入空间中采集数据。拉丁超立方抽样（LHS）是一种强大的实验设计技术，它能确保样本在每个维度上都均匀分布，避免了样本聚集问题。这项实践将指导您构建一个LHS设计，并使用标准指标来评估其空间填充特性，这是确保代理模型泛化能力的基础。",
            "id": "4127533",
            "problem": "您的任务是为能源系统建模中的代理模型训练设计和评估抽样方案。考虑一个超立方体的输入空间。请使用以下精确定义和要求来制定您的程序并生成所需的输出。\n\n设输入域为 $d$ 维单位超立方体 $[0,1]^d$。一个在 $d$ 维空间中包含 $n$ 个点的拉丁超立方抽样 (LHS) 设计，是 $[0,1]^d$ 中 $n$ 个向量的集合，使得对于每个维度 $j \\in \\{1,\\dots,d\\}$，这 $n$ 个点的 $n$ 个标量坐标被分层到 $n$ 个等长的互不相交的区间中，并且每个区间内恰好落入一个坐标。您必须使用伪随机构造方法生成这样的设计。\n\n构建设计后，计算以下量：\n- 所有维度对之间的成对 Pearson 相关系数，该系数由在 $n$ 个点上计算的样本协方差和样本标准差得到。作为摘要统计量，报告所有不同维度对之间的最大绝对相关性。\n- 用于表征样本分布均匀性的空间填充度量：\n  1. $[0,1]^d$ 中任意两点之间的最小成对欧几里得距离。\n  2. 所有无序的不同点对的成对距离平方倒数之和，该指标对聚类进行惩罚。\n  3. 所有维度上的最大一维投影间隙，定义如下：对于给定维度 $j$，对 $n$ 个坐标 $x_{1j},\\dots,x_{nj}$ 进行排序，附加边界点 $0$ 和 $1$，取最大的相邻差值；然后在所有 $j \\in \\{1,\\dots,d\\}$ 上取最大值。\n\n您必须使用分层随机构造方法实现 LHS，该方法在每个层内均匀地生成坐标。对于指定的伪随机数生成器整数种子，您的实现必须是确定性的。所有计算都应在单位超立方体上以纯数学术语进行，不涉及物理单位。\n\n测试套件：\n- 案例 1：$d=10$，$n=50$，种子 $=12345$。\n- 案例 2：$d=5$，$n=10$，种子 $=2025$。\n- 案例 3：$d=2$，$n=2$，种子 $=7$。\n\n对于每个案例，生成一个拉丁超立方抽样设计并计算：\n- 跨维度的最大绝对成对 Pearson 相关性（浮点数）。\n- 最小成对欧几里得距离（浮点数）。\n- 所有无序对的成对距离平方倒数之和（浮点数）。\n- 所有维度上的最大一维投影间隙（浮点数）。\n\n您的程序应生成单行输出，其中包含所有三个案例的结果，格式为一个用方括号括起来的逗号分隔列表，每个案例的结果是包含四个浮点数的列表，四舍五入到六位小数。例如，格式必须像 $[[r_{11},r_{12},r_{13},r_{14}],[r_{21},r_{22},r_{23},r_{24}],[r_{31},r_{32},r_{33},r_{34}]]$，其中 $r_{ij}$ 表示第 $i$ 个测试案例的第 $j$ 个结果。",
            "solution": "问题陈述经评估有效。它在数值方法和统计学领域具有科学依据，定义清晰，测试案例明确，提法恰当，并且表述客观。所有必要信息均已提供，问题内部一致且计算上可行。因此，我们可以着手提供解决方案。\n\n任务是生成拉丁超立方抽样 (LHS) 设计，并使用四个指定的度量指标来评估其质量。该过程涉及两个主要阶段：设计的构建和度量指标的计算。\n\n**1. 拉丁超立方抽样 (LHS) 构建**\n\n设维度数为 $d$，样本点数为 $n$。输入域为单位超立方体 $[0, 1]^d$。构建一个分层随机 LHS 设计，以确保对于每个维度，形式为 $[(k-1)/n, k/n)$（其中 $k \\in \\{1, \\dots, n\\}$）的 $n$ 个层中的每一层都恰好包含一个点的投影。算法如下：\n\n1.  初始化一个空的 $n \\times d$ 矩阵 $X$，用于存放设计点。\n2.  对于每个维度 $j \\in \\{1, 2, \\dots, d\\}$：\n    a. 生成整数集合 $\\{0, 1, \\dots, n-1\\}$ 的一个随机排列 $\\pi_j$。此排列为当前维度的 $n$ 个点中的每一个分配一个唯一的层索引，从而确保拉丁超立方性质。\n    b. 生成一个包含 $n$ 个独立随机数的向量 $U_j = (u_{1j}, u_{2j}, \\dots, u_{nj})$，其中每个 $u_{ij}$ 均从均匀分布 $U(0, 1)$ 中抽取。\n    c. 第 $i$ 个点在第 $j$ 个维度上的坐标（表示为 $x_{ij}$）通过将其随机放置在其分配的层内来计算：\n        $$x_{ij} = \\frac{\\pi_j(i) + u_{ij}}{n}$$\n        这里，$\\pi_j(i)$ 是维度 $j$ 的排列的第 $i$ 个元素。此公式将点映射到区间 $[\\pi_j(i)/n, (\\pi_j(i)+1)/n)$ 内。\n3.  完整的 LHS 设计是最终得到的 $n \\times d$ 矩阵 $X = [x_{ij}]$，其中每一行是 $[0, 1]^d$ 中的一个点。通过使用指定的整数种子初始化伪随机数生成器，可以使整个过程具有确定性。\n\n**2. 评估度量指标**\n\n一旦生成了设计矩阵 $X$，便使用四个度量指标来评估其质量。\n\n**度量指标 1：最大绝对成对 Pearson 相关性**\n两个维度 $j$ 和 $k$ 之间的 Pearson 相关系数 $r_{jk}$ 量化了设计矩阵对应列之间的线性关系。它由样本协方差和样本标准差定义：\n$$r_{jk} = \\frac{\\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)(x_{ik} - \\bar{x}_k)}{\\sqrt{\\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)^2} \\sqrt{\\sum_{i=1}^{n} (x_{ik} - \\bar{x}_k)^2}}$$\n其中 $\\bar{x}_j$ 是维度 $j$ 中坐标的样本均值。摘要统计量是该系数在所有唯一维度对上的最大绝对值，它提供了设计中最坏情况下线性依赖性的度量。\n$$C_{\\text{max}} = \\max_{1 \\le j  k \\le d} |r_{jk}|$$\n较低的 $C_{\\text{max}}$ 值是理想的。如果 $d  2$，则不存在不同的维度对，该度量指标取值为 $0$。\n\n**度量指标 2：最小成对欧几里得距离**\n该度量指标评估点的分离程度。设计中两点 $x_i = (x_{i1}, \\dots, x_{id})$ 和 $x_k = (x_{k1}, \\dots, x_{kd})$ 之间的欧几里得距离由以下公式给出：\n$$d(x_i, x_k) = \\sqrt{\\sum_{j=1}^{d} (x_{ij} - x_{kj})^2}$$\n该度量指标是在设计中所有 $\\binom{n}{2}$ 个不同点对中找到的最小距离：\n$$D_{\\text{min}} = \\min_{1 \\le i  k \\le n} d(x_i, x_k)$$\n较大的 $D_{\\text{min}}$ 值表示更好的空间填充特性，因为它意味着点没有过度聚类。\n\n**度量指标 3：成对距离平方倒数之和**\n该度量指标强烈惩罚点的聚类。它通过对所有无序的不同点对的欧几里得距离平方倒数求和来计算：\n$$S_{\\text{inv}} = \\sum_{1 \\le i  k \\le n} \\frac{1}{d(x_i, x_k)^2}$$\n其中 $d(x_i, x_k)$ 是上面定义的距离。较小的 $S_{\\text{inv}}$ 值表明点的分布更均匀。如果任意两点相同，$d(x_i, x_k)=0$，则此和将发散到无穷大；然而，所选的 LHS 构建方法使这种情况实际上不可能发生。\n\n**度量指标 4：最大一维投影间隙**\n该度量指标评估设计在每个轴上投影的均匀性。对于每个维度 $j \\in \\{1, \\dots, d\\}$：\n1.  取维度 $j$ 的坐标集合 $\\{x_{1j}, x_{2j}, \\dots, x_{nj}\\}$。\n2.  用边界点 $0$ 和 $1$ 扩充此集合。\n3.  对这 $n+2$ 个值进行排序，形成一个有序序列 $p_0, p_1, \\dots, p_{n+1}$，其中 $p_0=0$ 且 $p_{n+1}=1$。\n4.  间隙是相邻值之间的差值：$g_i = p_i - p_{i-1}$，其中 $i \\in \\{1, \\dots, n+1\\}$。\n5.  维度 $j$ 的最大间隙为 $G_j = \\max_{i=1, \\dots, n+1} g_i$。\n最终的度量指标是所有维度上这些间隙的最大值，表示沿任何单个轴的最大“空”区间。\n$$G_{\\text{max}} = \\max_{j=1, \\dots, d} G_j$$\n较小的 $G_{\\text{max}}$ 值表示更好的一维均匀性。\n\n该实现将把这个完整的过程应用于所提供的三个测试案例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.spatial.distance import pdist\n\ndef solve():\n    \"\"\"\n    Main function to generate LHS designs and compute metrics for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (10, 50, 12345),\n        (5, 10, 2025),\n        (2, 2, 7),\n    ]\n\n    all_results = []\n    for d, n, seed in test_cases:\n        # Step 1: Generate Latin Hypercube Sampling design\n        rng = np.random.default_rng(seed)\n        lhs_matrix = np.zeros((n, d))\n        for j in range(d):\n            permutation = rng.permutation(n)\n            uniform_variates = rng.uniform(size=n)\n            lhs_matrix[:, j] = (permutation + uniform_variates) / n\n\n        # Step 2: Compute evaluation metrics\n\n        # Metric 1: Maximum absolute pairwise Pearson correlation\n        if d  2:\n            max_abs_corr = 0.0\n        else:\n            correlation_matrix = np.corrcoef(lhs_matrix, rowvar=False)\n            # Set diagonal to zero to ignore self-correlation\n            np.fill_diagonal(correlation_matrix, 0)\n            max_abs_corr = np.max(np.abs(correlation_matrix))\n\n        # Metric 2  3: Minimum distance and sum of inverse squared distances\n        if n  2:\n            min_dist = 0.0\n            sum_inv_sq_dist = 0.0\n        else:\n            # pdist computes distances for all unordered pairs of distinct points\n            pairwise_distances = pdist(lhs_matrix, 'euclidean')\n            \n            # Metric 2: Minimum pairwise Euclidean distance\n            min_dist = np.min(pairwise_distances)\n            \n            # Metric 3: Sum of inverse squared pairwise distances\n            sum_inv_sq_dist = np.sum(1.0 / (pairwise_distances**2))\n\n        # Metric 4: Maximum one-dimensional projected gap\n        max_overall_gap = 0.0\n        for j in range(d):\n            projection = lhs_matrix[:, j]\n            # Append boundary points 0 and 1, then sort\n            sorted_points = np.sort(np.concatenate(([0.0], projection, [1.0])))\n            # Calculate gaps between adjacent points\n            gaps = np.diff(sorted_points)\n            # Update the maximum gap found so far\n            max_overall_gap = max(max_overall_gap, np.max(gaps))\n\n        # Store the four computed metrics for the current case\n        case_results = [max_abs_corr, min_dist, sum_inv_sq_dist, max_overall_gap]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    formatted_cases = []\n    for case_res in all_results:\n        # Format each float to six decimal places\n        formatted_values = [f\"{v:.6f}\" for v in case_res]\n        formatted_cases.append(f\"[{','.join(formatted_values)}]\")\n    \n    final_output_string = f\"[{','.join(formatted_cases)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "获得训练数据后，下一步便是构建代理模型。径向基函数（RBF）插值是一种流行且功能强大的方法，它能创建一个精确通过所有训练数据点的连续响应面。本练习将带您深入RBF的数学核心，通过解析推导插值结果，并探讨其关键超参数（如形状参数 $c$）对模型光滑度和稳定性的影响。",
            "id": "4127524",
            "problem": "考虑一个能源系统建模中的代理建模任务，其中一个标量、无量纲的性能指标 $y$（例如，归一化净发电成本）必须从代表归一化电负荷和热负荷水平的二维（$2$D）操作条件 $\\mathbf{x} \\in \\mathbb{R}^2$ 中推断出来。给定 $4$ 个位于操作点的训练快照\n$$\\mathbf{x}_1 = (1,0),\\quad \\mathbf{x}_2 = (-1,0),\\quad \\mathbf{x}_3 = (0,1),\\quad \\mathbf{x}_4 = (0,-1),$$\n其测得的响应为\n$$y_1 = 1,\\quad y_2 = 1,\\quad y_3 = 1,\\quad y_4 = 1.$$\n采用一个由平移的径向基函数的线性组合定义的径向基代理模型，即形状参数为 $c0$ 的多象限函数，\n$$\\phi(r)=\\sqrt{r^2 + c^2},$$\n其中 $r$ 表示 $\\mathbb{R}^2$ 中的欧几里得距离。在 $4$ 个训练快照上施加精确插值条件。仅使用插值定义和欧几里得范数，推导系数并在新的操作点\n$$\\mathbf{x}^{\\ast}=(0,0),$$ \n处评估插值函数，并将最终结果解析地表示为形状参数 $c$ 的函数。此外，根据你的推导，解释 $c$ 的选择如何影响该数据集的代理模型拟合的平滑性、局部性和条件性，将你的讨论建立在插值系统的极限行为和结构特性之上。将 $\\mathbf{x}^{\\ast}$ 处的插值函数值以 $c$ 的单个闭式解析表达式形式给出。无需四舍五入，由于 $y$ 是无量纲的，因此没有物理单位。",
            "solution": "此任务是使用径向基函数（RBF）插值构建一个代理模型，并在一个特定点进行评估。我们还需要分析形状参数 $c$ 的作用。\n\n对于一组包含 $N$ 个训练点 $\\{\\mathbf{x}_i\\}_{i=1}^N$ 及其对应值 $\\{y_i\\}_{i=1}^N$ 的 RBF 插值函数 $S(\\mathbf{x})$ 的一般形式由平移的基函数的线性组合给出：\n$$S(\\mathbf{x}) = \\sum_{j=1}^{N} w_j \\phi(\\|\\mathbf{x} - \\mathbf{x}_j\\|)$$\n其中 $w_j$ 是待定权重，$\\phi$ 是径向基函数，$\\|\\cdot\\|$ 表示欧几里得范数。在这个问题中，$N=4$，RBF 是形状参数为 $c0$ 的多象限函数 $\\phi(r) = \\sqrt{r^2 + c^2}$。\n\n精确插值条件要求代理模型与训练数据完全匹配，即对每个 $i \\in \\{1, 2, 3, 4\\}$ 都有 $S(\\mathbf{x}_i) = y_i$。这为 $4$ 个未知权重 $w_j$ 导出了一个包含 $4$ 个线性方程的方程组：\n$$\\sum_{j=1}^{4} w_j \\phi(\\|\\mathbf{x}_i - \\mathbf{x}_j\\|) = y_i, \\quad \\text{for } i = 1, 2, 3, 4.$$\n该系统可以写成矩阵形式 $\\mathbf{\\Phi} \\mathbf{w} = \\mathbf{y}$，其中 $\\mathbf{w} = [w_1, w_2, w_3, w_4]^T$ 是权重向量，$\\mathbf{y} = [y_1, y_2, y_3, y_4]^T$ 是观测响应向量，$\\mathbf{\\Phi}$ 是插值矩阵，其元素为 $\\Phi_{ij} = \\phi(\\|\\mathbf{x}_i - \\mathbf{x}_j\\|)$。\n\n首先，我们计算给定训练点 $\\mathbf{x}_1 = (1,0)$、$\\mathbf{x}_2 = (-1,0)$、$\\mathbf{x}_3 = (0,1)$ 和 $\\mathbf{x}_4 = (0,-1)$ 之间的欧几里得距离矩阵 $r_{ij} = \\|\\mathbf{x}_i - \\mathbf{x}_j\\|$。\n对角线元素为 $r_{ii} = 0$。\n非对角线距离为：\n$r_{12} = \\|\\mathbf{x}_1 - \\mathbf{x}_2\\| = \\|(1 - (-1), 0 - 0)\\| = \\|(2,0)\\| = 2$。\n$r_{13} = \\|\\mathbf{x}_1 - \\mathbf{x}_3\\| = \\|(1 - 0, 0 - 1)\\| = \\|(1,-1)\\| = \\sqrt{1^2 + (-1)^2} = \\sqrt{2}$。\n$r_{14} = \\|\\mathbf{x}_1 - \\mathbf{x}_4\\| = \\|(1 - 0, 0 - (-1))\\| = \\|(1,1)\\| = \\sqrt{1^2 + 1^2} = \\sqrt{2}$。\n$r_{23} = \\|\\mathbf{x}_2 - \\mathbf{x}_3\\| = \\|(-1 - 0, 0 - 1)\\| = \\|(-1,-1)\\| = \\sqrt{(-1)^2 + (-1)^2} = \\sqrt{2}$。\n$r_{24} = \\|\\mathbf{x}_2 - \\mathbf{x}_4\\| = \\|(-1 - 0, 0 - (-1))\\| = \\|(-1,1)\\| = \\sqrt{(-1)^2 + 1^2} = \\sqrt{2}$。\n$r_{34} = \\|\\mathbf{x}_3 - \\mathbf{x}_4\\| = \\|(0 - 0, 1 - (-1))\\| = \\|(0,2)\\| = 2$。\n根据对称性，$r_{ij} = r_{ji}$。\n\n接下来，我们通过将 RBF $\\phi(r) = \\sqrt{r^2 + c^2}$ 应用于每个距离 $r_{ij}$ 来构建插值矩阵 $\\mathbf{\\Phi}$：\n$\\Phi_{ii} = \\phi(0) = \\sqrt{0^2 + c^2} = c$。\n$\\Phi_{12} = \\phi(2) = \\sqrt{2^2 + c^2} = \\sqrt{4 + c^2}$。\n$\\Phi_{13} = \\phi(\\sqrt{2}) = \\sqrt{(\\sqrt{2})^2 + c^2} = \\sqrt{2 + c^2}$。\n完整的矩阵是：\n$$\n\\mathbf{\\Phi} = \\begin{pmatrix}\nc  \\sqrt{4+c^2}  \\sqrt{2+c^2}  \\sqrt{2+c^2} \\\\\n\\sqrt{4+c^2}  c  \\sqrt{2+c^2}  \\sqrt{2+c^2} \\\\\n\\sqrt{2+c^2}  \\sqrt{2+c^2}  c  \\sqrt{4+c^2} \\\\\n\\sqrt{2+c^2}  \\sqrt{2+c^2}  \\sqrt{4+c^2}  c\n\\end{pmatrix}\n$$\n响应向量由 $\\mathbf{y} = [1, 1, 1, 1]^T$ 给出。线性系统是 $\\mathbf{\\Phi} \\mathbf{w} = \\mathbf{y}$。\n\n由于问题设置中的高度对称性（这些点是以原点为中心的正方形的顶点，且所有响应值都相同），我们可以推断权重也必须是对称的，即 $w_1 = w_2 = w_3 = w_4 = w$。我们来验证这一点。如果我们将所有权重设为同一个值 $w$，系统 $\\mathbf{\\Phi}\\mathbf{w}=\\mathbf{y}$ 的第一行变为：\n$$(c)w + (\\sqrt{4+c^2})w + (\\sqrt{2+c^2})w + (\\sqrt{2+c^2})w = 1$$\n$$w(c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}) = 1$$\n矩阵 $\\mathbf{\\Phi}$ 的每一行都是第一行元素的排列。由于 $\\mathbf{y}$ 的所有元素都为 $1$，因此将 $\\mathbf{\\Phi}$ 的任意一行的元素求和再乘以 $w$ 必须等于 $1$。每一行的元素之和是相同的：$c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}$。因此，假设 $w_1 = w_2 = w_3 = w_4 = w$ 是正确的，并满足整个方程组。\n因此，统一的权重 $w$ 为：\n$$w = \\frac{1}{c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}}$$\n系数为 $w_1 = w_2 = w_3 = w_4 = w$。\n\n现在，我们在新的操作点 $\\mathbf{x}^{\\ast}=(0,0)$ 评估插值函数 $S(\\mathbf{x})$：\n$$S(\\mathbf{x}^{\\ast}) = \\sum_{j=1}^{4} w_j \\phi(\\|\\mathbf{x}^{\\ast} - \\mathbf{x}_j\\|)$$\n从 $\\mathbf{x}^{\\ast}=(0,0)$ 到各训练点的距离为：\n$\\|\\mathbf{x}^{\\ast} - \\mathbf{x}_1\\| = \\|(0,0) - (1,0)\\| = 1$。\n$\\|\\mathbf{x}^{\\ast} - \\mathbf{x}_2\\| = \\|(0,0) - (-1,0)\\| = 1$。\n$\\|\\mathbf{x}^{\\ast} - \\mathbf{x}_3\\| = \\|(0,0) - (0,1)\\| = 1$。\n$\\|\\mathbf{x}^{\\ast} - \\mathbf{x}_4\\| = \\|(0,0) - (0,-1)\\| = 1$。\n所有距离都等于 $1$。相应的 RBF 值为 $\\phi(1) = \\sqrt{1^2 + c^2} = \\sqrt{1+c^2}$。\n将权重和 RBF 值代入 $S(\\mathbf{x}^{\\ast})$ 的表达式中：\n$$S(\\mathbf{x}^{\\ast}) = w_1\\phi(1) + w_2\\phi(1) + w_3\\phi(1) + w_4\\phi(1) = (w_1+w_2+w_3+w_4)\\phi(1) = 4w\\phi(1)$$\n$$S(\\mathbf{x}^{\\ast}) = 4 \\left( \\frac{1}{c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}} \\right) \\sqrt{1+c^2}$$\n$$S(\\mathbf{x}^{\\ast}) = \\frac{4\\sqrt{1+c^2}}{c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}}$$\n\n最后，我们讨论形状参数 $c$ 的影响。\n1.  **平滑性**：对于任何 $c0$，多象限 RBF $\\phi(r) = \\sqrt{r^2+c^2}$ 都是无限可微的（$C^\\infty$）。插值函数 $S(\\mathbf{x})$ 作为此类函数的线性组合，也是 $C^\\infty$。然而，所得曲面的有效平滑度或平坦度由 $c$ 控制。当 $c \\to \\infty$ 时，基函数 $\\phi(r) \\approx c + \\frac{r^2}{2c}$，变得非常平坦，并接近一个常数加上一个二次项。这会产生一个全局“更平滑”的插值函数，类似于一个低阶多项式。相反，当 $c \\to 0$ 时，$\\phi(r) \\to \\sqrt{r^2} = r$，这就是锥形 RBF。该函数仅是连续的（$C^0$），并在 $r=0$ 处有一个尖峰。所得的插值函数变得“更尖”且更不平滑。\n\n2.  **局部性**：参数 $c$ 控制基函数的“宽度”。\n    对于小的 $c$，函数 $\\phi(r)$ 在 $r=0$ 处有尖峰并且衰减相对较快，使其成为一个局部化的函数。这意味着在一点 $\\mathbf{x}$ 处的插值函数值主要受最近的训练点影响。\n    对于大的 $c$，函数 $\\phi(r)$ 非常平坦和宽广，使其成为一个全局函数。在这种情况下，每个训练点都对整个域上的插值函数值有显著影响。小的 $c$ 意味着高局部性；大的 $c$ 意味着低局部性。\n\n3.  **条件性**：线性系统 $\\mathbf{\\Phi}\\mathbf{w} = \\mathbf{y}$ 的条件性由矩阵 $\\mathbf{\\Phi}$ 的条件数决定。当 $c \\to \\infty$ 时，非对角线元素 $\\sqrt{r^2+c^2} = c\\sqrt{1+r^2/c^2} \\approx c(1 + \\frac{r^2}{2c^2}) = c + \\frac{r^2}{2c}$ 接近对角线元素 $c$。矩阵 $\\mathbf{\\Phi}$ 的所有元素都变得非常接近。这导致 $\\mathbf{\\Phi}$ 的列（和行）变得近乎线性相关，使得矩阵几乎是奇异的。因此，随着 $c \\to \\infty$，$\\mathbf{\\Phi}$ 的条件数变得非常大，导致数值病态系统。对于小的 $c$ 值，矩阵通常是良态的。这种权衡是 RBF 插值的一个基本方面：更平坦的基函数（大 $c$）可以产生更平滑的拟合，但代价是数值不稳定性。\n\n在这个具体问题中，当 $c \\to \\infty$ 时，由于所有数据点的 $y_i=1$，插值函数必须趋近于常数值 $1$。我们的结果证实了这一点：$\\lim_{c \\to \\infty} S(\\mathbf{x}^{\\ast}) = \\lim_{c \\to \\infty} \\frac{4c}{c+c+2c} = \\frac{4c}{4c} = 1$。当 $c \\to 0$ 时，我们的结果趋近于一个有限值 $S(\\mathbf{x}^{\\ast}) \\to \\frac{4}{2+2\\sqrt{2}} = 2(\\sqrt{2}-1) \\approx 0.828$，这对应于使用锥形基函数的插值。",
            "answer": "$$\\boxed{\\frac{4\\sqrt{1+c^2}}{c + \\sqrt{4+c^2} + 2\\sqrt{2+c^2}}}$$"
        },
        {
            "introduction": "除了构建输入-输出代理模型，另一种核心降阶技术是直接简化系统状态空间的复杂度。奇异值分解（SVD）是本征正交分解（POD）的数学基石，后者是许多降阶模型（ROMs）的核心。这项实践的核心任务是量化降阶后的模型保留了原始系统多少“能量”，这是评估和选择降阶模型秩（rank）的关键步骤。",
            "id": "4127506",
            "problem": "给定一个能量系统的快照矩阵 $X \\in \\mathbb{R}^{m \\times n}$，其中行对应状态分量（如节点电压或热状态），列对应时间或工作点采样。通过选择主导的奇异值分解模态，可以获得一个降阶（代理）表示。您的任务是量化通过秩-$r$截断所保留的总能量的比例，该比例由弗罗贝尼乌斯范数的平方来衡量。秩 $r$ 的保留能量比例定义为由前 $r$ 个奇异值捕获的能量与 $X$ 的总能量之比。\n\n从以下基本概念开始：\n- 矩阵 $X$ 的弗罗贝尼乌斯范数的平方定义为 $\\lVert X \\rVert_F^2 = \\sum_{i=1}^m \\sum_{j=1}^n X_{ij}^2$。\n- $X$ 的奇异值分解 (SVD) 定义为 $X = U \\Sigma V^\\top$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵（即 $U^\\top U = I_m$ 和 $V^\\top V = I_n$），而 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个对角矩形矩阵，其对角线上包含奇异值 $\\sigma_1, \\sigma_2, \\dots, \\sigma_p$，其中 $p = \\min(m,n)$ 且 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_p \\ge 0$。\n- 弗罗贝尼乌斯范数的正交不变性意味着 $\\lVert X \\rVert_F^2 = \\lVert \\Sigma \\rVert_F^2 = \\sum_{i=1}^p \\sigma_i^2$。\n\n将选定秩 $r$ 的保留能量比例定义为\n$$\nE_r = \\frac{\\sum_{i=1}^{r} \\sigma_i^2}{\\sum_{i=1}^{p} \\sigma_i^2},\n$$\n其中 $p = \\min(m,n)$，$r$ 是一个整数，满足 $0 \\le r \\le p$。如果 $r  p$，则将 $r$ 视为 $p$。如果 $\\sum_{i=1}^{p} \\sigma_i^2 = 0$（即 $X$ 是零矩阵），则对于任何 $r$ 定义 $E_r = 0$。\n\n实现一个程序，对于每个指定的测试矩阵和秩 $r$，通过以下步骤计算 $E_r$：\n- 计算 $X$ 的奇异值分解。\n- 使用奇异值完全按照上述定义来计算 $E_r$。\n\n将每个保留能量比例 $E_r$ 表示为四舍五入到六位小数的十进制数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，\"[$0.500000,0.750000$]\"），不含空格。\n\n使用以下测试套件（每个案例提供 $X$ 和 $r$）：\n- 案例 1：$X = \\begin{bmatrix} 5  0  0 \\\\ 0  3  0 \\\\ 0  0  1 \\end{bmatrix}$，$r = 2$。\n- 案例 2：$X = \\begin{bmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{bmatrix}$，$r = 3$。\n- 案例 3：$X = \\begin{bmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{bmatrix}$，$r = 1$。\n- 案例 4：$X = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$r = 0$。\n- 案例 5：$X = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$，$r = 2$。\n- 案例 6：$X = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$r = 5$。\n\n您的程序应将六个案例的保留能量比例作为单行输出，格式严格为 \"[$E_1,E_2,E_3,E_4,E_5,E_6$]\"，其中每个 $E_i$ 都按要求四舍五入到六位小数。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于线性代数，特别是奇异值分解 (SVD) 理论，其在模型降阶中的应用是一个标准且定义明确的概念。该问题是自包含的，所有必要的定义、数据和边界条件都已明确指定。没有矛盾、歧义或事实错误。\n\n任务是计算给定快照矩阵 $X$ 进行秩-$r$ 截断后的保留能量比例 $E_r$。这个比例量化了由前 $r$ 个主导奇异模态捕获的系统总“能量”部分，其中能量由弗罗贝尼乌斯范数的平方来衡量。公式如下：\n$$\nE_r = \\frac{\\sum_{i=1}^{r} \\sigma_i^2}{\\sum_{i=1}^{p} \\sigma_i^2}\n$$\n其中 $\\sigma_i$ 是 $X$ 按降序排列的奇异值，$p = \\min(m, n)$ 是一个 $m \\times n$ 矩阵的奇异值数量，$r$ 是所选近似的秩。\n\n基本原理是弗罗贝尼乌斯范数的正交不变性，即 $\\lVert X \\rVert_F^2 = \\lVert U \\Sigma V^\\top \\rVert_F^2 = \\lVert \\Sigma \\rVert_F^2$。因为 $\\Sigma$ 是一个对角线上为奇异值 $\\sigma_i$ 的对角矩形矩阵，其弗罗贝尼乌斯范数的平方就是奇异值的平方和：\n$$\n\\lVert X \\rVert_F^2 = \\sum_{i=1}^{p} \\sigma_i^2\n$$\n这个和代表了系统快照矩阵 $X$ 中的总能量。$X$ 的一个秩-$r$ 近似，记为 $X_r$，是仅使用前 $r$ 个奇异值及其对应的奇异向量构建的。这个近似的能量是 $\\lVert X_r \\rVert_F^2 = \\sum_{i=1}^{r} \\sigma_i^2$。保留能量比例 $E_r$ 就是这两个量的比值。\n\n步骤如下：\n1. 对于每个矩阵 $X$ 和秩 $r$，确定矩阵维度 $m$ 和 $n$，以及最大可能秩 $p = \\min(m, n)$。\n2. 根据指定规则调整请求的秩 $r$：如果 $r  p$，则将其视为 $r=p$。用于分子求和的有效秩是 $r_{eff} = \\min(r, p)$。\n3. 计算 $X$ 的奇异值 $\\sigma_1, \\sigma_2, \\dots, \\sigma_p$。\n4. 计算总能量（分母）：$E_{total} = \\sum_{i=1}^{p} \\sigma_i^2$。\n5. 处理 $E_{total} = 0$ 的特殊情况（即 $X$ 是零矩阵）。在这种情况下，$E_r$ 定义为 $0$。\n6. 否则，计算保留能量（分子）：$E_{retained} = \\sum_{i=1}^{r_{eff}} \\sigma_i^2$。\n7. 计算比例 $E_r = E_{retained} / E_{total}$。\n\n我们现在将此过程应用于每个测试案例。\n\n**案例 1：**\n- 给定：$X = \\begin{bmatrix} 5  0  0 \\\\ 0  3  0 \\\\ 0  0  1 \\end{bmatrix}$，$r = 2$。\n- 维度：$m=3, n=3$，所以 $p = \\min(3, 3) = 3$。\n- 矩阵 $X$ 是对角矩阵，因此其奇异值为对角元素的绝对值，按降序排列：$\\sigma_1=5, \\sigma_2=3, \\sigma_3=1$。\n- 总能量：$\\sum_{i=1}^{3} \\sigma_i^2 = 5^2 + 3^2 + 1^2 = 25 + 9 + 1 = 35$。\n- 对于 $r=2$ 的保留能量：$\\sum_{i=1}^{2} \\sigma_i^2 = 5^2 + 3^2 = 25 + 9 = 34$。\n- $E_2 = \\frac{34}{35} \\approx 0.97142857$。四舍五入到六位小数，结果为 $0.971429$。\n\n**案例 2：**\n- 给定：$X = \\begin{bmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{bmatrix}$，$r = 3$。\n- 维度：$m=4, n=3$，所以 $p = \\min(4, 3) = 3$。\n- 奇异值是主对角线上的非零项，排序后为：$\\sigma_1=4, \\sigma_2=2, \\sigma_3=1$。\n- 总能量：$\\sum_{i=1}^{3} \\sigma_i^2 = 4^2 + 2^2 + 1^2 = 16 + 4 + 1 = 21$。\n- 秩为 $r=3$，等于 $p$。保留能量即为总能量。\n- $E_3 = \\frac{21}{21} = 1$。值为 $1.000000$。\n\n**案例 3：**\n- 给定：$X = \\begin{bmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{bmatrix}$，$r = 1$。\n- 维度：$m=3, n=2$，所以 $p = \\min(3, 2) = 2$。\n- 第二列是第一列的倍数，所以矩阵的秩为 $1$。这意味着只有一个奇异值非零。$X^\\top X = \\begin{bmatrix} 14  28 \\\\ 28  56 \\end{bmatrix}$ 的特征值为 $\\lambda_1=70, \\lambda_2=0$。\n- 奇异值为 $\\sigma_1 = \\sqrt{70}, \\sigma_2 = 0$。\n- 总能量：$\\sum_{i=1}^{2} \\sigma_i^2 = (\\sqrt{70})^2 + 0^2 = 70$。\n- 对于 $r=1$ 的保留能量：$\\sum_{i=1}^{1} \\sigma_i^2 = (\\sqrt{70})^2 = 70$。\n- $E_1 = \\frac{70}{70} = 1$。值为 $1.000000$。\n\n**案例 4：**\n- 给定：$X = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$r = 0$。\n- 维度：$m=2, n=2$，所以 $p = \\min(2, 2) = 2$。\n- 矩阵是单位矩阵 $I_2$。其奇异值为 $\\sigma_1=1, \\sigma_2=1$。\n- 总能量：$\\sum_{i=1}^{2} \\sigma_i^2 = 1^2 + 1^2 = 2$。\n- 秩为 $r=0$。分子是空和，为 $0$。\n- 对于 $r=0$ 的保留能量：$\\sum_{i=1}^{0} \\sigma_i^2 = 0$。\n- $E_0 = \\frac{0}{2} = 0$。值为 $0.000000$。\n\n**案例 5：**\n- 给定：$X = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$，$r = 2$。\n- 维度：$m=3, n=3$，所以 $p = \\min(3, 3) = 3$。\n- 这是零矩阵。其所有奇异值均为 $0$。\n- 总能量：$\\sum_{i=1}^{3} \\sigma_i^2 = 0^2 + 0^2 + 0^2 = 0$。\n- 根据问题定义，如果总能量为 $0$，则对于任何 $r$，$E_r=0$。\n- $E_2 = 0$。值为 $0.000000$。\n\n**案例 6：**\n- 给定：$X = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$r = 5$。\n- 维度：$m=2, n=2$，所以 $p = \\min(2, 2) = 2$。\n- 奇异值为 $\\sigma_1=1, \\sigma_2=1$。\n- 请求的秩 $r=5$ 大于 $p=2$。问题陈述在这种情况下将 $r$ 视为 $p$。所以，有效秩为 $r_{eff}=2$。\n- 总能量：$\\sum_{i=1}^{2} \\sigma_i^2 = 1^2 + 1^2 = 2$。\n- 对于 $r_{eff}=2$ 的保留能量：$\\sum_{i=1}^{2} \\sigma_i^2 = 1^2 + 1^2 = 2$。\n- $E_5 = \\frac{2}{2} = 1$。值为 $1.000000$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the retained energy fraction for a series of test cases\n    involving matrix truncation via SVD.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (np.array([[5, 0, 0], [0, 3, 0], [0, 0, 1]], dtype=float), 2),\n        (np.array([[4, 0, 0], [0, 2, 0], [0, 0, 1], [0, 0, 0]], dtype=float), 3),\n        (np.array([[1, 2], [2, 4], [3, 6]], dtype=float), 1),\n        (np.array([[1, 0], [0, 1]], dtype=float), 0),\n        (np.array([[0, 0, 0], [0, 0, 0], [0, 0, 0]], dtype=float), 2),\n        (np.array([[1, 0], [0, 1]], dtype=float), 5),\n    ]\n\n    results = []\n    for X, r in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        \n        # Get matrix dimensions and maximum possible rank p\n        m, n = X.shape\n        p = min(m, n)\n\n        # Compute singular values. We only need the values, not the full SVD.\n        s = np.linalg.svd(X, compute_uv=False)\n\n        # Square the singular values to represent their energy.\n        s_sq = np.square(s)\n\n        # The total energy is the sum of all squared singular values.\n        total_energy = np.sum(s_sq)\n\n        # Per the problem: if total energy is 0, the fraction is 0.\n        if total_energy == 0:\n            e_r = 0.0\n        else:\n            # The effective rank for summation cannot exceed p.\n            # Also handles r=0 correctly with slicing.\n            # Per problem statement: if r > p, treat r as p.\n            rank_k = min(r, p)\n            \n            # The retained energy is the sum of the first rank_k squared singular values.\n            # s is already sorted in descending order by np.linalg.svd.\n            retained_energy = np.sum(s_sq[:rank_k])\n            \n            # The fraction is the ratio of retained to total energy.\n            e_r = retained_energy / total_energy\n        \n        results.append(e_r)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to six decimal places.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}