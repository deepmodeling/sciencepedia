{
    "hands_on_practices": [
        {
            "introduction": "One of the primary goals of building a Vector Autoregression (VAR) model is to understand the predictive relationships among variables. The concept of Granger causality offers a formal framework for testing whether past values of one variable provide statistically significant information for forecasting another. This exercise provides direct practice in applying this concept by setting up the formal hypothesis for a Granger non-causality test and computing the associated Wald statistic based on a hypothetical VAR model of electricity prices and system load .",
            "id": "4135251",
            "problem": "Consider a bivariate Vector Autoregression (VAR) of order $2$ for the pair of energy market variables $y_{t} = \\begin{pmatrix} p_{t} \\\\ \\ell_{t} \\end{pmatrix}$, where $p_{t}$ denotes the day-ahead electricity price and $\\ell_{t}$ denotes the system load. Suppose both series have been seasonally adjusted and pre-tested to be covariance-stationary so that a VAR in levels is appropriate. The VAR($2$) is\n$$\ny_{t} = c + A_{1} y_{t-1} + A_{2} y_{t-2} + u_{t},\n$$\nwith intercept $c \\in \\mathbb{R}^{2}$, coefficient matrices $A_{1}, A_{2} \\in \\mathbb{R}^{2 \\times 2}$, and zero-mean innovation $u_{t}$ with finite covariance. You are given the estimated coefficient matrices\n$$\nA_{1} = \\begin{pmatrix}\n0.45 & 0.12 \\\\\n0.08 & 0.51\n\\end{pmatrix},\n\\quad\nA_{2} = \\begin{pmatrix}\n-0.10 & 0.05 \\\\\n0.02 & -0.12\n\\end{pmatrix},\n$$\nand intercept $c = \\begin{pmatrix} 2.10 \\\\ 15.7 \\end{pmatrix}$. Focus on the price equation, i.e., the first row of the VAR. The hypothesis that load does not Granger-cause price corresponds to the joint null that the coefficients on lagged load in the price equation are zero at all lags.\n\nStarting from the definition of Granger non-causality and the ordinary least squares (OLS) asymptotic normality of the coefficient estimates, formulate the null hypothesis in terms of restrictions on the entries of $\\{A_{i}\\}_{i=1}^{2}$ and derive the Wald test statistic for this hypothesis. For the price equationâ€™s lagged-load coefficients, let the estimated coefficient vector be\n$$\nb = \\begin{pmatrix} a_{12}(1) \\\\ a_{12}(2) \\end{pmatrix}\n= \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix},\n$$\nwith estimated covariance matrix\n$$\n\\widehat{\\mathrm{Var}}(b) = V = \\begin{pmatrix}\n0.0016 & 0.0002 \\\\\n0.0002 & 0.0009\n\\end{pmatrix}.\n$$\nCompute the value of the Wald statistic for testing the null of no Granger causality from load to price. State clearly the restriction, the form of the statistic you use, and then evaluate it numerically using the provided $b$ and $V$. Round your final numerical value to three significant figures. No units are required in the final answer.",
            "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in the field of time series econometrics, providing all necessary information to compute the requested test statistic. No scientific or logical flaws are present.\n\nThe problem requires the computation of a Wald statistic to test for Granger non-causality in a bivariate Vector Autoregressive model of order $2$, denoted VAR($2$). The model relates the day-ahead electricity price, $p_{t}$, and the system load, $\\ell_{t}$, which are components of the vector $y_{t} = \\begin{pmatrix} p_{t} \\\\ \\ell_{t} \\end{pmatrix}$. The VAR($2$) model is given by:\n$$\ny_{t} = c + A_{1} y_{t-1} + A_{2} y_{t-2} + u_{t}\n$$\nwhere $c$ is a $2 \\times 1$ intercept vector, $A_{1}$ and $A_{2}$ are $2 \\times 2$ coefficient matrices, and $u_{t}$ is a $2 \\times 1$ vector of zero-mean innovations.\n\nLet the entries of the coefficient matrices be denoted as $A_k = \\begin{pmatrix} a_{11}(k) & a_{12}(k) \\\\ a_{21}(k) & a_{22}(k) \\end{pmatrix}$ for lags $k=1, 2$. The equation for the price variable, $p_{t}$, corresponds to the first row of the VAR system:\n$$\np_{t} = c_{1} + a_{11}(1) p_{t-1} + a_{12}(1) \\ell_{t-1} + a_{11}(2) p_{t-2} + a_{12}(2) \\ell_{t-2} + u_{1t}\n$$\nThe hypothesis that the system load, $\\ell_t$, does not Granger-cause the price, $p_t$, implies that past values of $\\ell_t$ have no predictive power for the current value of $p_t$, once past values of $p_t$ have been taken into account. In the context of this VAR($2$) model, this translates to a joint null hypothesis that the coefficients on the lagged load variables, $\\ell_{t-1}$ and $\\ell_{t-2}$, in the price equation are both equal to zero.\n\nThe null hypothesis, $H_0$, can be formally stated as:\n$$\nH_0: a_{12}(1) = 0 \\quad \\text{and} \\quad a_{12}(2) = 0\n$$\nThis represents a set of $q=2$ linear restrictions on the model's parameters.\nThe problem defines the vector of these coefficients as $b$:\n$$\nb = \\begin{pmatrix} a_{12}(1) \\\\ a_{12}(2) \\end{pmatrix}\n$$\nThus, the null hypothesis can be expressed in vector form as $H_0: b = \\mathbf{0}$, where $\\mathbf{0}$ is the $2 \\times 1$ zero vector.\n\nThe Wald test is used to test such hypotheses. Let $\\hat{b}$ be the ordinary least squares (OLS) estimate of the coefficient vector $b$. Under standard asymptotic theory for stationary VAR models, the estimator $\\hat{b}$ is asymptotically normally distributed. The Wald statistic for testing $H_0: b = \\mathbf{0}$ is a quadratic form given by:\n$$\nW = \\hat{b}^T [\\widehat{\\mathrm{Var}}(\\hat{b})]^{-1} \\hat{b}\n$$\nwhere $\\widehat{\\mathrm{Var}}(\\hat{b})$ is the estimated covariance matrix of the coefficient estimator $\\hat{b}$. Under the null hypothesis, the Wald statistic $W$ follows an asymptotic chi-squared distribution with degrees of freedom equal to the number of restrictions, $q$. In this case, $W \\sim \\chi^2(2)$.\n\nThe problem provides the estimated coefficient vector and its estimated covariance matrix:\n$$\n\\hat{b} = \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}, \\quad V = \\widehat{\\mathrm{Var}}(\\hat{b}) = \\begin{pmatrix} 0.0016 & 0.0002 \\\\ 0.0002 & 0.0009 \\end{pmatrix}\n$$\nTo compute the Wald statistic $W = \\hat{b}^T V^{-1} \\hat{b}$, we first need to find the inverse of the covariance matrix $V$. For a general $2 \\times 2$ matrix $M = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, its inverse is $M^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\n\nFirst, we calculate the determinant of $V$:\n$$\n\\det(V) = (0.0016)(0.0009) - (0.0002)(0.0002)\n$$\n$$\n\\det(V) = 0.00000144 - 0.00000004 = 0.00000140 = 1.4 \\times 10^{-6}\n$$\nNext, we find the inverse matrix $V^{-1}$:\n$$\nV^{-1} = \\frac{1}{1.4 \\times 10^{-6}} \\begin{pmatrix} 0.0009 & -0.0002 \\\\ -0.0002 & 0.0016 \\end{pmatrix}\n$$\nNow we compute the Wald statistic:\n$$\nW = \\begin{pmatrix} 0.12 & 0.05 \\end{pmatrix} \\left( \\frac{1}{1.4 \\times 10^{-6}} \\begin{pmatrix} 0.0009 & -0.0002 \\\\ -0.0002 & 0.0016 \\end{pmatrix} \\right) \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}\n$$\nWe can rewrite this as $W = \\frac{\\hat{b}^T \\mathrm{adj}(V) \\hat{b}}{\\det(V)}$, where $\\mathrm{adj}(V)$ is the adjugate matrix of $V$.\nThe numerator is the quadratic form $\\hat{b}^T \\mathrm{adj}(V) \\hat{b}$:\n$$\n\\mathrm{Numerator} = \\begin{pmatrix} 0.12 & 0.05 \\end{pmatrix} \\begin{pmatrix} 0.0009 & -0.0002 \\\\ -0.0002 & 0.0016 \\end{pmatrix} \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}\n$$\nFirst, we compute the product of the last two terms:\n$$\n\\begin{pmatrix} 0.0009 & -0.0002 \\\\ -0.0002 & 0.0016 \\end{pmatrix} \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix} = \\begin{pmatrix} (0.0009)(0.12) - (0.0002)(0.05) \\\\ -(0.0002)(0.12) + (0.0016)(0.05) \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.000108 - 0.000010 \\\\ -0.000024 + 0.000080 \\end{pmatrix} = \\begin{pmatrix} 0.000098 \\\\ 0.000056 \\end{pmatrix}\n$$\nNow, we pre-multiply by $\\hat{b}^T$:\n$$\n\\mathrm{Numerator} = \\begin{pmatrix} 0.12 & 0.05 \\end{pmatrix} \\begin{pmatrix} 0.000098 \\\\ 0.000056 \\end{pmatrix}\n$$\n$$\n= (0.12)(0.000098) + (0.05)(0.000056) = 0.00001176 + 0.00000280 = 0.00001456\n$$\nFinally, we divide the numerator by the determinant of $V$:\n$$\nW = \\frac{0.00001456}{0.00000140} = \\frac{1.456 \\times 10^{-5}}{1.4 \\times 10^{-6}} = \\frac{14.56}{1.4} = 10.4\n$$\nThe value of the Wald statistic is $10.4$. The problem requires rounding to three significant figures. The value $10.4$ is already given to three significant figures.",
            "answer": "$$\\boxed{10.4}$$"
        },
        {
            "introduction": "While VAR models describe short-run dynamics, a crucial aspect of market analysis involves understanding the cumulative, long-term consequences of shocks. A one-time shock might fade, but what is the effect of a permanent shift in market conditions? This practice explores how to quantify these persistent effects by deriving and calculating the long-run impact matrix, which aggregates the impulse responses over an infinite horizon, and interpreting its implications for energy prices .",
            "id": "4135202",
            "problem": "Consider a bivariate Vector Autoregression (VAR) of order two for standardized log-prices in an energy system market. Let $x_t = \\begin{pmatrix} \\tilde{p}^{el}_t \\\\ \\tilde{p}^{gas}_t \\end{pmatrix}$ denote the vector of standardized log day-ahead electricity price and standardized log natural gas price, respectively, where each component has been demeaned and scaled to unit variance so that both series are dimensionless. The dynamics are given by the stationary VAR(2)\n$$\nx_t = A_1 x_{t-1} + A_2 x_{t-2} + u_t,\n$$\nwhere $u_t$ is a zero-mean, serially uncorrelated innovation vector with identity covariance, and the lag matrices are\n$$\nA_1 = \\begin{pmatrix} 0.35 & 0.10 \\\\ 0.05 & 0.30 \\end{pmatrix}, \\quad A_2 = \\begin{pmatrix} 0.20 & -0.05 \\\\ 0.00 & 0.10 \\end{pmatrix}.\n$$\nAssume all eigenvalues of the associated companion form lie strictly inside the unit circle so that the VAR is stable and admits a Wold representation.\n\nStarting from the core definitions of the lag operator and the Wold decomposition for stationary multivariate time series, derive an expression for the long-run impact matrix\n$$\n\\Psi(1) = \\sum_{h=0}^{\\infty} \\Phi_h,\n$$\nwhere the matrices $\\Phi_h$ are the moving-average (MA) coefficients in the Wold representation $x_t = \\sum_{h=0}^{\\infty} \\Phi_h u_{t-h}$. Then, for the given $A_1$ and $A_2$, compute $\\Psi(1)$ exactly, and report its numerical value rounded to four significant figures. Because the series are standardized and dimensionless, express the final matrix without physical units.\n\nFinally, interpret the entries of $\\Psi(1)$ in terms of persistent effects on energy prices: explain what a one-unit permanent shift in the mean of each innovation component implies for the long-run standardized log-prices of electricity and natural gas, and distinguish this from the effect of a one-time impulse shock.\n\nRound all reported numerical entries of $\\Psi(1)$ to four significant figures. Do not include any physical units in your numerical answer.",
            "solution": "The problem is well-posed and scientifically sound, representing a standard application of vector autoregressive (VAR) models in time series analysis. We proceed with the solution.\n\nThe problem asks for three things:\n1. A derivation of the expression for the long-run impact matrix, $\\Psi(1)$.\n2. The numerical calculation of $\\Psi(1)$ for the given VAR(2) model.\n3. An interpretation of the resulting matrix entries.\n\n**1. Derivation of the Long-Run Impact Matrix $\\Psi(1)$**\n\nWe start with the given stationary VAR(2) model:\n$$\nx_t = A_1 x_{t-1} + A_2 x_{t-2} + u_t\n$$\nwhere $x_t$ is a $2 \\times 1$ vector of endogenous variables, $A_1$ and $A_2$ are $2 \\times 2$ coefficient matrices, and $u_t$ is a $2 \\times 1$ vector of white noise innovations.\n\nWe can express this model using the lag operator $L$, where $L^k x_t = x_{t-k}$. Applying this to the equation gives:\n$$\nx_t = A_1 L x_t + A_2 L^2 x_t + u_t\n$$\nRearranging the terms to group the $x_t$ vectors yields:\n$$\n(I - A_1 L - A_2 L^2) x_t = u_t\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. We can define the autoregressive lag polynomial as $A(L) = I - A_1 L - A_2 L^2$. The equation is then concisely written as:\n$$\nA(L) x_t = u_t\n$$\nThe problem states that the VAR process is stable, which implies that it has a Wold representation, also known as a Vector Moving Average (VMA) representation of infinite order, VMA$(\\infty)$. This representation expresses $x_t$ as a linear combination of current and past innovations:\n$$\nx_t = \\sum_{h=0}^{\\infty} \\Phi_h u_{t-h}\n$$\nBy convention, $\\Phi_0 = I$. In lag operator notation, this is:\n$$\nx_t = \\left(\\sum_{h=0}^{\\infty} \\Phi_h L^h\\right) u_t = \\Phi(L) u_t\n$$\nwhere $\\Phi(L)$ is the moving-average lag polynomial.\n\nSubstituting the VMA$(\\infty)$ representation into the VAR equation gives:\n$$\nA(L) \\left( \\Phi(L) u_t \\right) = u_t\n$$\nFor this identity to hold for any sequence of innovations $u_t$, the lag polynomials must satisfy the relationship:\n$$\nA(L) \\Phi(L) = I\n$$\nThis means that the MA polynomial matrix is the inverse of the AR polynomial matrix:\n$$\n\\Phi(L) = [A(L)]^{-1}\n$$\nThe long-run impact matrix, denoted $\\Psi(1)$, is defined as the sum of all the moving-average coefficient matrices $\\Phi_h$:\n$$\n\\Psi(1) = \\sum_{h=0}^{\\infty} \\Phi_h\n$$\nThis sum is equivalent to evaluating the MA polynomial matrix $\\Phi(L)$ at $L=1$:\n$$\n\\Psi(1) = \\Phi(1) = \\sum_{h=0}^{\\infty} \\Phi_h (1)^h = \\sum_{h=0}^{\\infty} \\Phi_h\n$$\nNow, we use the relationship $A(L) \\Phi(L) = I$. Evaluating this at $L=1$ gives:\n$$\nA(1) \\Phi(1) = I\n$$\nSolving for $\\Phi(1)$ (which is $\\Psi(1)$), we get:\n$$\n\\Psi(1) = [A(1)]^{-1}\n$$\nThe matrix $A(1)$ is found by substituting $L=1$ into the AR polynomial $A(L) = I - A_1 L - A_2 L^2$:\n$$\nA(1) = I - A_1 (1) - A_2 (1)^2 = I - A_1 - A_2\n$$\nThus, the final expression for the long-run impact matrix is:\n$$\n\\Psi(1) = (I - A_1 - A_2)^{-1}\n$$\nThe stability of the VAR process ensures that the matrix $(I - A_1 - A_2)$ is invertible.\n\n**2. Calculation of $\\Psi(1)$**\n\nWe are given the matrices:\n$$\nA_1 = \\begin{pmatrix} 0.35 & 0.10 \\\\ 0.05 & 0.30 \\end{pmatrix}, \\quad A_2 = \\begin{pmatrix} 0.20 & -0.05 \\\\ 0.00 & 0.10 \\end{pmatrix}\n$$\nFirst, we compute the matrix $M = I - A_1 - A_2$:\n$$\nM = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0.35 & 0.10 \\\\ 0.05 & 0.30 \\end{pmatrix} - \\begin{pmatrix} 0.20 & -0.05 \\\\ 0.00 & 0.10 \\end{pmatrix}\n$$\n$$\nM = \\begin{pmatrix} 1 - 0.35 - 0.20 & 0 - 0.10 - (-0.05) \\\\ 0 - 0.05 - 0.00 & 1 - 0.30 - 0.10 \\end{pmatrix}\n$$\n$$\nM = \\begin{pmatrix} 0.45 & -0.05 \\\\ -0.05 & 0.60 \\end{pmatrix}\n$$\nNext, we find the inverse of $M$, which is $\\Psi(1) = M^{-1}$. For a generic $2 \\times 2$ matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the inverse is $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\n\nThe determinant of $M$ is:\n$$\n\\det(M) = (0.45)(0.60) - (-0.05)(-0.05) = 0.27 - 0.0025 = 0.2675\n$$\nNow we compute the inverse:\n$$\n\\Psi(1) = M^{-1} = \\frac{1}{0.2675} \\begin{pmatrix} 0.60 & 0.05 \\\\ 0.05 & 0.45 \\end{pmatrix}\n$$\n$$\n\\Psi(1) = \\begin{pmatrix} \\frac{0.60}{0.2675} & \\frac{0.05}{0.2675} \\\\ \\frac{0.05}{0.2675} & \\frac{0.45}{0.2675} \\end{pmatrix} = \\begin{pmatrix} 2.2430... & 0.18691... \\\\ 0.18691... & 1.68224... \\end{pmatrix}\n$$\nRounding each entry to four significant figures, we get:\n$$\n\\Psi(1) \\approx \\begin{pmatrix} 2.243 & 0.1869 \\\\ 0.1869 & 1.682 \\end{pmatrix}\n$$\n\n**3. Interpretation of $\\Psi(1)$**\n\nThe matrix $\\Psi(1)$ represents the long-run multipliers of the system. Its entries, $\\Psi(1)_{ij}$, quantify the total long-run effect on the level of variable $i$ resulting from a permanent unit shift in the mean of the innovation for variable $j$.\n\nLet's consider the initial process $x_t$ with mean $\\mathbb{E}[x_t] = \\mu_x = 0$. Now, suppose there is a permanent shift in the mean of the innovations, such that the new innovation process is $v_t = u_t + c$, where $c$ is a constant $2 \\times 1$ vector. The VAR model becomes $x_t = A_1 x_{t-1} + A_2 x_{t-2} + v_t$. The new long-run equilibrium mean, $\\mu_x^* = \\mathbb{E}[x_t]$, must satisfy:\n$$\n\\mu_x^* = A_1 \\mu_x^* + A_2 \\mu_x^* + \\mathbb{E}[v_t]\n$$\n$$\n(I - A_1 - A_2) \\mu_x^* = c\n$$\n$$\n\\mu_x^* = (I - A_1 - A_2)^{-1} c = \\Psi(1) c\n$$\nThis shows that $\\Psi(1)$ maps a permanent shift in the mean of the innovations to the resulting permanent shift in the mean of the process variables $x_t$.\n\n*Distinction from a one-time impulse shock*: A one-time impulse shock at time $t$ is a single non-zero value of $u_t$, for example $u_t = c$, while $u_{s}=0$ for $s \\neq t$. The effect of this shock on the level of $x_{t+h}$ is given by $\\Phi_h c$. For a stationary process, this effect dissipates over time, meaning $\\Phi_h \\to 0$ as $h \\to \\infty$. The level of $x_t$ eventually returns to its original mean. The cumulative effect of this single shock across all future periods is $\\sum_{h=0}^\\infty \\Phi_h c = \\Psi(1) c$. So, while a one-time shock has a temporary effect on the level of the variables (which eventually die out), a permanent shift in the innovation process leads to a permanent shift in the equilibrium level of the variables, and the magnitude of this level shift is given by the cumulative impulse response, $\\Psi(1)$.\n\nApplying this interpretation to our numerical result for $x_t = (\\tilde{p}^{el}_t, \\tilde{p}^{gas}_t)^T$:\n\n-   $\\Psi(1)_{11} \\approx 2.243$: A permanent one-unit increase in the mean of the electricity price innovation, $u_t^{el}$, leads to a permanent long-run increase of approximately $2.243$ units in the standardized log-price of electricity, $\\tilde{p}^{el}$.\n-   $\\Psi(1)_{12} \\approx 0.1869$: A permanent one-unit increase in the mean of the gas price innovation, $u_t^{gas}$, leads to a permanent long-run increase of approximately $0.1869$ units in the standardized log-price of electricity, $\\tilde{p}^{el}$. This is the long-run cross-effect of a gas market shock on electricity prices.\n-   $\\Psi(1)_{21} \\approx 0.1869$: A permanent one-unit increase in the mean of the electricity price innovation, $u_t^{el}$, leads to a permanent long-run increase of approximately $0.1869$ units in the standardized log-price of natural gas, $\\tilde{p}^{gas}$.\n-   $\\Psi(1)_{22} \\approx 1.682$: A permanent one-unit increase in the mean of the gas price innovation, $u_t^{gas}$, leads to a permanent long-run increase of approximately $1.682$ units in the standardized log-price of natural gas, $\\tilde{p}^{gas}$.\n\nThe results indicate positive long-run spillovers between the two markets, with own-market shocks having a larger persistent effect than cross-market shocks, as would be expected.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.243 & 0.1869 \\\\ 0.1869 & 1.682 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world energy prices often move together in the long run, bound by economic fundamentals, a phenomenon known as cointegration. The Vector Error Correction Model (VECM) is the appropriate tool for such systems, as it jointly models short-run dynamics and adjustments back to long-run equilibrium. This final practice moves from theory to application by challenging you to simulate a full VECM to conduct a scenario analysis, tracing the dynamic impact of a sustained structural shock in one market (natural gas) across the entire energy system .",
            "id": "4135269",
            "problem": "Design and implement a scenario analysis program to assess the effect of a sustained gas price shock on electricity prices and load using identified structural shocks within a cointegrated energy market modeled by a Vector Error Correction Model (VECM). The system consists of three logged variables: gas price, electricity price, and electrical load, collected at a monthly frequency. All variables are in log units and therefore dimensionless. The program must compute, for each scenario, the resulting changes in the electricity price and load at a specified forecast horizon, expressed as decimal values.\n\nBase definitions and assumptions:\n- A Vector Autoregression (VAR) of order $p$ for the vector of logged variables $\\mathbf{x}_t \\in \\mathbb{R}^3$ can be written in levels as $$\\mathbf{x}_t = \\sum_{i=1}^p \\mathbf{A}_i \\mathbf{x}_{t-i} + \\boldsymbol{\\varepsilon}_t,$$ where $\\boldsymbol{\\varepsilon}_t$ are reduced-form innovations.\n- If the system is cointegrated with rank $r$, the VAR representation can be rewritten as a Vector Error Correction Model (VECM): $$\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\sum_{i=1}^{p-1} \\boldsymbol{\\Gamma}_i \\Delta \\mathbf{x}_{t-i} + \\mathbf{K} \\mathbf{u}_t,$$ where $\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top$ has rank $r$, $\\boldsymbol{\\alpha} \\in \\mathbb{R}^{3 \\times r}$ are adjustment (loading) coefficients, $\\boldsymbol{\\beta} \\in \\mathbb{R}^{3 \\times r}$ are cointegration vectors, $\\boldsymbol{\\Gamma}_i \\in \\mathbb{R}^{3 \\times 3}$ capture short-run dynamics, and $\\mathbf{u}_t \\in \\mathbb{R}^3$ are identified structural shocks with identity covariance. Identification means that structural shocks are orthonormal and mapped contemporaneously to the system via $\\mathbf{K}$, with each component corresponding to a specific structural disturbance (gas, electricity, load).\n- Energy market interpretation: cointegration encodes a long-run equilibrium relation among gas price, electricity price, and load, with electricity price adjusting more strongly to deviations than gas price or load. Structural shocks represent economically interpretable innovations (for example, a gas supply shock).\n\nUse the following scientifically plausible parameterization for a monthly three-variable cointegrated VECM with $p = 2$ and cointegration rank $r = 1$:\n- Cointegration vector: $$\\boldsymbol{\\beta} = \\begin{bmatrix} 0.6 \\\\ -1.0 \\\\ 0.2 \\end{bmatrix},$$ encoding the stationary relation $0.6 \\cdot \\text{gas} - 1.0 \\cdot \\text{electricity} + 0.2 \\cdot \\text{load} = \\text{constant}.$\n- Loading (adjustment) coefficients: $$\\boldsymbol{\\alpha} = \\begin{bmatrix} 0.10 \\\\ 0.25 \\\\ -0.05 \\end{bmatrix},$$ meaning electricity price adjusts more strongly than gas price, while load adjusts weakly and in the opposite direction.\n- Error-correction matrix: $$\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top \\in \\mathbb{R}^{3 \\times 3}.$$\n- Short-run dynamics (one lag of changes since $p=2$): $$\\boldsymbol{\\Gamma}_1 = \\begin{bmatrix} 0.10 & 0.05 & 0.00 \\\\ 0.02 & 0.15 & 0.03 \\\\ -0.01 & 0.02 & 0.10 \\end{bmatrix}.$$\n- Contemporaneous structural impact matrix: $$\\mathbf{K} = \\mathbf{I}_3,$$ the $3 \\times 3$ identity matrix, identifying each structural shock component as an orthonormal and distinct disturbance.\n\nDefine the sustained gas price shock scenario as a stream of structural shocks applied to the gas component only, with amplitude $s$, persistence factor $\\lambda$, and duration $T_{\\text{shock}}$ months. Specifically, for $t = 1, 2, \\dots, T_{\\text{shock}}$, set $u_{g,t} = s \\cdot \\lambda^{t-1}$ and $u_{e,t} = 0$, $u_{l,t} = 0$. For $t > T_{\\text{shock}}$, all shock components are zero. Initialize the system at equilibrium $\\mathbf{x}_0 = \\mathbf{0}$ and $\\Delta \\mathbf{x}_0 = \\mathbf{0}$, which satisfies the cointegration relation.\n\nFor each scenario, simulate the VECM forward for a forecast horizon $H$ months and report the electricity price and load at time $H$ as deviations from baseline (which remains at equilibrium), i.e., simply the simulated $\\mathbf{x}_H$ components. Because the variables are logs, both outputs are dimensionless and must be expressed as decimals (not percentages).\n\nImplement the recursive computation implied by the VECM without using shortcut formulas. For $t = 1, 2, \\dots, H$, compute:\n$$\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\boldsymbol{\\Gamma}_1 \\Delta \\mathbf{x}_{t-1} + \\mathbf{K} \\mathbf{u}_t,$$\nand update:\n$$\\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t.$$\n\nTest suite:\nProvide the following scenarios, each specified by $(s, \\lambda, T_{\\text{shock}}, H)$:\n- Case $1$ (general, happy path): $(0.1, 0.9, 12, 24)$.\n- Case $2$ (boundary, zero shock amplitude): $(0.0, 0.9, 12, 24)$.\n- Case $3$ (edge, unit persistence with long duration): $(0.2, 1.0, 24, 36)$.\n- Case $4$ (edge, negative amplitude and shorter horizon than shock duration): $(-0.2, 0.95, 18, 12)$.\n- Case $5$ (boundary, low persistence and short duration): $(0.1, 0.5, 6, 24)$.\n\nProgram requirements:\n- The program must compute, for each case, a two-element list containing the electricity price deviation and load deviation at horizon $H$, i.e., $[\\text{electricity}(H), \\text{load}(H)]$, both in log units (dimensionless decimals).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and preserving the case order, where each case result is itself a two-element list, for example: $[[a_1,b_1],[a_2,b_2],\\dots]$.\n\nAll numerical outputs must be in decimal form. No angles are involved. No physical units are required because the variables are in log units.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of time series econometrics (Vector Error Correction Models), well-posed as a deterministic simulation of a system of linear difference equations with defined initial conditions, and objective with all parameters and procedures specified unambiguously.\n\nThe task is to simulate a three-variable VECM representing a cointegrated energy market to analyze the impact of a sustained gas price shock. The state of the system is described by the vector of logged variables $\\mathbf{x}_t = [\\text{gas}_t, \\text{electricity}_t, \\text{load}_t]^\\top$.\n\nThe model dynamics are governed by the VECM equation:\n$$\n\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\boldsymbol{\\Gamma}_1 \\Delta \\mathbf{x}_{t-1} + \\mathbf{K} \\mathbf{u}_t\n$$\nThe level of the variables is updated at each step via the identity:\n$$\n\\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t\n$$\n\nThe parameter matrices are defined as follows:\nThe cointegration vector is $\\boldsymbol{\\beta} = [0.6, -1.0, 0.2]^\\top$, and the loading coefficients are $\\boldsymbol{\\alpha} = [0.10, 0.25, -0.05]^\\top$. The long-run error-correction matrix $\\boldsymbol{\\Pi}$ is their outer product:\n$$\n\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top = \\begin{bmatrix} 0.10 \\\\ 0.25 \\\\ -0.05 \\end{bmatrix} \\begin{bmatrix} 0.6 & -1.0 & 0.2 \\end{bmatrix} = \\begin{bmatrix} 0.06 & -0.10 & 0.02 \\\\ 0.15 & -0.25 & 0.05 \\\\ -0.03 & 0.05 & -0.01 \\end{bmatrix}\n$$\nThe short-run dynamics matrix $\\boldsymbol{\\Gamma}_1$ is given by:\n$$\n\\boldsymbol{\\Gamma}_1 = \\begin{bmatrix} 0.10 & 0.05 & 0.00 \\\\ 0.02 & 0.15 & 0.03 \\\\ -0.01 & 0.02 & 0.10 \\end{bmatrix}\n$$\nThe contemporaneous structural impact matrix $\\mathbf{K}$ is the $3 \\times 3$ identity matrix, $\\mathbf{K} = \\mathbf{I}_3$.\n\nThe scenario analysis requires simulating the system's response to a specific structural shock. The shock is applied only to the gas price component of the structural innovations vector $\\mathbf{u}_t = [u_{g,t}, u_{e,t}, u_{l,t}]^\\top$. The shock has an initial amplitude of $s$, a persistence factor of $\\lambda$, and a duration of $T_{\\text{shock}}$ months. The shock is defined as:\n$$\nu_{g,t} = \\begin{cases} s \\cdot \\lambda^{t-1} & \\text{for } 1 \\le t \\le T_{\\text{shock}} \\\\ 0 & \\text{for } t > T_{\\text{shock}} \\end{cases}\n$$\nThe other structural shock components are zero, i.e., $u_{e,t} = 0$ and $u_{l,t} = 0$ for all $t \\geq 1$.\n\nThe simulation proceeds via a recursive algorithm for a total forecast horizon of $H$ months.\n\n**Algorithm:**\n\n1.  **Initialization (at $t=0$)**: The system starts at equilibrium. We set the initial state vectors as $3 \\times 1$ column vectors:\n    $$\n    \\mathbf{x}_0 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad \\Delta \\mathbf{x}_0 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n    $$\n\n2.  **Iterative Simulation (for $t=1, 2, \\dots, H$)**: We loop through each time step up to the horizon $H$. In each step $t$:\n    a.  **Construct the shock vector $\\mathbf{u}_t$**: Based on the current time step $t$ and the scenario parameters $(s, \\lambda, T_{\\text{shock}})$, we define the shock vector $\\mathbf{u}_t$. If $t \\le T_{\\text{shock}}$, the first element is $s \\cdot \\lambda^{t-1}$; otherwise, it is $0$. The other two elements are always $0$.\n    b.  **Compute the change $\\Delta \\mathbf{x}_t$**: Using the state from the previous step, $\\mathbf{x}_{t-1}$ and $\\Delta \\mathbf{x}_{t-1}$, we apply the VECM equation. This involves matrix-vector multiplications:\n        $$\n        \\Delta \\mathbf{x}_t = (\\boldsymbol{\\Pi} \\cdot \\mathbf{x}_{t-1}) + (\\boldsymbol{\\Gamma}_1 \\cdot \\Delta \\mathbf{x}_{t-1}) + (\\mathbf{K} \\cdot \\mathbf{u}_t)\n        $$\n    c.  **Compute the new level $\\mathbf{x}_t$**: The new state is found by adding the computed change to the previous state:\n        $$\n        \\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t\n        $$\n    d.  **Update State**: The computed $\\mathbf{x}_t$ and $\\Delta \\mathbf{x}_t$ become the \"previous\" state for the next iteration, $t+1$.\n\n3.  **Result Extraction**: After the loop completes (i.e., at $t=H$), the final state vector is $\\mathbf{x}_H$. The problem asks for the deviations in electricity price and load, which are the second and third components of this vector, respectively. The result for a given scenario is the list $[\\mathbf{x}_H[1], \\mathbf{x}_H[2]]$.\n\nThis procedure is implemented for each test case provided, and the results are aggregated into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the VECM simulation for all test cases and print results.\n    \"\"\"\n    \n    # Base parameters for the VECM model.\n    # Cointegration vector beta (3x1)\n    beta = np.array([[0.6], [-1.0], [0.2]])\n    \n    # Loading coefficients alpha (3x1)\n    alpha = np.array([[0.10], [0.25], [-0.05]])\n    \n    # Long-run error-correction matrix Pi = alpha * beta.T (3x3)\n    Pi = alpha @ beta.T\n    \n    # Short-run dynamics matrix Gamma_1 (3x3)\n    Gamma_1 = np.array([\n        [0.10, 0.05, 0.00],\n        [0.02, 0.15, 0.03],\n        [-0.01, 0.02, 0.10]\n    ])\n    \n    # Contemporaneous structural impact matrix K (identity matrix, 3x3)\n    K = np.identity(3)\n\n    # All model matrices are now defined.\n    model_params = (Pi, Gamma_1, K)\n\n    # Test suite: each case is (s, lambda, T_shock, H)\n    test_cases = [\n        (0.1, 0.9, 12, 24),    # Case 1\n        (0.0, 0.9, 12, 24),    # Case 2\n        (0.2, 1.0, 24, 36),    # Case 3\n        (-0.2, 0.95, 18, 12),  # Case 4\n        (0.1, 0.5, 6, 24)      # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        s, lam, T_shock, H = case\n        # Run simulation for the current case\n        final_x = run_simulation(s, lam, T_shock, H, model_params)\n        \n        # Extract electricity price (index 1) and load (index 2)\n        # and convert to a plain list of floats.\n        result_pair = [final_x[1, 0], final_x[2, 0]]\n        results.append(result_pair)\n\n    # Format the output as a string representation of a list of lists.\n    # e.g., [[val1, val2], [val3, val4]]\n    # str(results) produces this format directly.\n    # The requirement is [[a_1,b_1],[a_2,b_2],...], which comma separating produces.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(s: float, lam: float, T_shock: int, H: int, model_params):\n    \"\"\"\n    Simulates the VECM for a given shock scenario.\n\n    Args:\n        s: Initial shock amplitude.\n        lam: Shock persistence factor (lambda).\n        T_shock: Duration of the shock in months.\n        H: Forecast horizon in months.\n        model_params: Tuple containing (Pi, Gamma_1, K) matrices.\n\n    Returns:\n        The final state vector x_H as a numpy array.\n    \"\"\"\n    Pi, Gamma_1, K = model_params\n\n    # Initialize state vectors at t=0\n    # x_t represents [gas, electricity, load] in log units\n    x_prev = np.zeros((3, 1))  # x_{t-1}\n    delta_x_prev = np.zeros((3, 1)) # Delta_x_{t-1}\n\n    # Simulate from t=1 to H\n    for t in range(1, H + 1):\n        # 1. Construct the structural shock vector u_t\n        u_t = np.zeros((3, 1))\n        if t <= T_shock:\n            # Shock is applied to the gas component (first element)\n            u_t[0, 0] = s * (lam ** (t - 1))\n\n        # 2. Compute the change delta_x_t using the VECM equation\n        # delta_x_t = Pi @ x_{t-1} + Gamma_1 @ delta_x_{t-1} + K @ u_t\n        term_pi = Pi @ x_prev\n        term_gamma = Gamma_1 @ delta_x_prev\n        term_k = K @ u_t\n        delta_x_curr = term_pi + term_gamma + term_k\n\n        # 3. Compute the new level x_t\n        # x_t = x_{t-1} + delta_x_t\n        x_curr = x_prev + delta_x_curr\n\n        # 4. Update state variables for the next iteration\n        x_prev = x_curr\n        delta_x_prev = delta_x_curr\n    \n    # After the loop, x_prev holds the final state x_H\n    return x_prev\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}