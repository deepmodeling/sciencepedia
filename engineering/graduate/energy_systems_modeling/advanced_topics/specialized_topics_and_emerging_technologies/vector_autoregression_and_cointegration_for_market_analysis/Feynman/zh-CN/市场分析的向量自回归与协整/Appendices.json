{
    "hands_on_practices": [
        {
            "introduction": "向量自回归（VAR）模型的核心应用之一是检验变量之间的预测关系。格兰杰因果关系检验（Granger causality test）提供了一个正式的框架来确定一个时间序列的过去值是否有助于预测另一个时间序列。这项练习将引导你通过一个具体的能源市场案例，使用瓦尔德统计量（Wald statistic）来检验系统负荷是否格兰杰因果影响日前电价，从而让你掌握在VAR框架下进行假设检验的关键技能。",
            "id": "4135251",
            "problem": "考虑一个关于能源市场变量对 $y_{t} = \\begin{pmatrix} p_{t} \\\\ \\ell_{t} \\end{pmatrix}$ 的二元二阶向量自回归（VAR）模型，其中 $p_{t}$ 表示日前电价，$\\ell_{t}$ 表示系统负荷。假设这两个序列都经过了季节性调整，并预先检验为协方差平稳，因此适用水平VAR模型。这个VAR($2$)模型为\n$$\ny_{t} = c + A_{1} y_{t-1} + A_{2} y_{t-2} + u_{t},\n$$\n其中截距项 $c \\in \\mathbb{R}^{2}$，系数矩阵 $A_{1}, A_{2} \\in \\mathbb{R}^{2 \\times 2}$，以及具有有限协方差的零均值新息 $u_{t}$。给定估计的系数矩阵\n$$\nA_{1} = \\begin{pmatrix}\n0.45  0.12 \\\\\n0.08  0.51\n\\end{pmatrix},\n\\quad\nA_{2} = \\begin{pmatrix}\n-0.10  0.05 \\\\\n0.02  -0.12\n\\end{pmatrix},\n$$\n和截距项 $c = \\begin{pmatrix} 2.10 \\\\ 15.7 \\end{pmatrix}$。关注价格方程，即VAR模型的第一行。“负荷不会格兰杰引起价格”这一假设对应于一个联合原假设，即价格方程中所有滞后负荷的系数均为零。\n\n从格兰杰非因果关系的定义以及系数估计的普通最小二乘法（OLS）渐近正态性出发，以 $\\{A_{i}\\}_{i=1}^{2}$ 各项的约束条件形式来建立原假设，并为该假设推导瓦尔德检验统计量。对于价格方程的滞后负荷系数，设估计的系数向量为\n$$\nb = \\begin{pmatrix} a_{12}(1) \\\\ a_{12}(2) \\end{pmatrix}\n= \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix},\n$$\n其估计的协方差矩阵为\n$$\n\\widehat{\\mathrm{Var}}(b) = V = \\begin{pmatrix}\n0.0016  0.0002 \\\\\n0.0002  0.0009\n\\end{pmatrix}.\n$$\n计算用于检验“负荷对价格不存在格兰杰因果关系”这一原假设的瓦尔德统计量的值。请清楚地陈述约束条件、您使用的统计量形式，然后使用给定的 $b$ 和 $V$ 进行数值计算。将最终数值结果四舍五入至三位有效数字。最终答案无需单位。",
            "solution": "该问题陈述已被验证，并被认为是合理的。这是一个时间序列计量经济学领域的适定问题，提供了计算所要求的检验统计量所需的所有信息。不存在科学或逻辑上的缺陷。\n\n该问题要求计算一个瓦尔德统计量，以检验一个记为VAR(2)的二元二阶向量自回归模型中的格兰杰非因果关系。该模型关联了日前电价 $p_{t}$ 和系统负荷 $\\ell_{t}$，它们是向量 $y_{t} = \\begin{pmatrix} p_{t} \\\\ \\ell_{t} \\end{pmatrix}$ 的分量。该VAR(2)模型由下式给出：\n$$\ny_{t} = c + A_{1} y_{t-1} + A_{2} y_{t-2} + u_{t}\n$$\n其中 $c$ 是一个 $2 \\times 1$ 的截距向量，$A_{1}$ 和 $A_{2}$ 是 $2 \\times 2$ 的系数矩阵，$u_{t}$ 是一个 $2 \\times 1$ 的零均值新息向量。\n\n设系数矩阵的元素表示为 $A_k = \\begin{pmatrix} a_{11}(k)  a_{12}(k) \\\\ a_{21}(k)  a_{22}(k) \\end{pmatrix}$，其中滞后阶数 $k=1, 2$。价格变量 $p_{t}$ 的方程对应于VAR系统的第一行：\n$$\np_{t} = c_{1} + a_{11}(1) p_{t-1} + a_{12}(1) \\ell_{t-1} + a_{11}(2) p_{t-2} + a_{12}(2) \\ell_{t-2} + u_{1t}\n$$\n“系统负荷 $\\ell_t$ 不会格兰杰引起价格 $p_t$”这一假设意味着，在考虑了 $p_t$ 的过去值之后，$\\ell_t$ 的过去值对 $p_t$ 的当前值没有预测能力。在此VAR(2)模型的背景下，这转化为一个联合原假设，即价格方程中滞后负荷变量 $\\ell_{t-1}$ 和 $\\ell_{t-2}$ 的系数都等于零。\n\n原假设 $H_0$ 可以正式表述为：\n$$\nH_0: a_{12}(1) = 0 \\quad \\text{和} \\quad a_{12}(2) = 0\n$$\n这代表了对模型参数的一组 $q=2$ 个线性约束。\n问题将这些系数的向量定义为 $b$：\n$$\nb = \\begin{pmatrix} a_{12}(1) \\\\ a_{12}(2) \\end{pmatrix}\n$$\n因此，原假设可以用向量形式表示为 $H_0: b = \\mathbf{0}$，其中 $\\mathbf{0}$ 是 $2 \\times 1$ 的零向量。\n\n瓦尔德检验用于检验此类假设。令 $\\hat{b}$ 为系数向量 $b$ 的普通最小二乘法（OLS）估计。根据平稳VAR模型的标准渐近理论，估计量 $\\hat{b}$ 是渐近正态分布的。用于检验 $H_0: b = \\mathbf{0}$ 的瓦尔德统计量是一个由下式给出的二次型：\n$$\nW = \\hat{b}^T [\\widehat{\\mathrm{Var}}(\\hat{b})]^{-1} \\hat{b}\n$$\n其中 $\\widehat{\\mathrm{Var}}(\\hat{b})$ 是系数估计量 $\\hat{b}$ 的估计协方差矩阵。在原假设下，瓦尔德统计量 $W$ 服从渐近卡方分布，其自由度等于约束的数量 $q$。在本例中，$W \\sim \\chi^2(2)$。\n\n问题提供了估计的系数向量及其估计的协方差矩阵：\n$$\n\\hat{b} = \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}, \\quad V = \\widehat{\\mathrm{Var}}(\\hat{b}) = \\begin{pmatrix} 0.0016  0.0002 \\\\ 0.0002  0.0009 \\end{pmatrix}\n$$\n为了计算瓦尔德统计量 $W = \\hat{b}^T V^{-1} \\hat{b}$，我们首先需要求出协方差矩阵 $V$ 的逆。对于一个一般的 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $M^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n\n首先，我们计算 $V$ 的行列式：\n$$\n\\det(V) = (0.0016)(0.0009) - (0.0002)(0.0002)\n$$\n$$\n\\det(V) = 0.00000144 - 0.00000004 = 0.00000140 = 1.4 \\times 10^{-6}\n$$\n接下来，我们求逆矩阵 $V^{-1}$：\n$$\nV^{-1} = \\frac{1}{1.4 \\times 10^{-6}} \\begin{pmatrix} 0.0009  -0.0002 \\\\ -0.0002  0.0016 \\end{pmatrix}\n$$\n现在我们计算瓦尔德统计量：\n$$\nW = \\begin{pmatrix} 0.12  0.05 \\end{pmatrix} \\left( \\frac{1}{1.4 \\times 10^{-6}} \\begin{pmatrix} 0.0009  -0.0002 \\\\ -0.0002  0.0016 \\end{pmatrix} \\right) \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}\n$$\n我们可以将其重写为 $W = \\frac{\\hat{b}^T \\mathrm{adj}(V) \\hat{b}}{\\det(V)}$，其中 $\\mathrm{adj}(V)$ 是 $V$ 的伴随矩阵。\n分子是二次型 $\\hat{b}^T \\mathrm{adj}(V) \\hat{b}$：\n$$\n\\mathrm{Numerator} = \\begin{pmatrix} 0.12  0.05 \\end{pmatrix} \\begin{pmatrix} 0.0009  -0.0002 \\\\ -0.0002  0.0016 \\end{pmatrix} \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix}\n$$\n首先，我们计算后两项的乘积：\n$$\n\\begin{pmatrix} 0.0009  -0.0002 \\\\ -0.0002  0.0016 \\end{pmatrix} \\begin{pmatrix} 0.12 \\\\ 0.05 \\end{pmatrix} = \\begin{pmatrix} (0.0009)(0.12) - (0.0002)(0.05) \\\\ -(0.0002)(0.12) + (0.0016)(0.05) \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.000108 - 0.000010 \\\\ -0.000024 + 0.000080 \\end{pmatrix} = \\begin{pmatrix} 0.000098 \\\\ 0.000056 \\end{pmatrix}\n$$\n现在，我们用 $\\hat{b}^T$ 进行左乘：\n$$\n\\mathrm{Numerator} = \\begin{pmatrix} 0.12  0.05 \\end{pmatrix} \\begin{pmatrix} 0.000098 \\\\ 0.000056 \\end{pmatrix}\n$$\n$$\n= (0.12)(0.000098) + (0.05)(0.000056) = 0.00001176 + 0.00000280 = 0.00001456\n$$\n最后，我们将分子除以 $V$ 的行列式：\n$$\nW = \\frac{0.00001456}{0.00000140} = \\frac{1.456 \\times 10^{-5}}{1.4 \\times 10^{-6}} = \\frac{14.56}{1.4} = 10.4\n$$\n瓦尔德统计量的值为 $10.4$。问题要求四舍五入到三位有效数字。值 $10.4$ 已经是以三位有效数字给出。",
            "answer": "$$\\boxed{10.4}$$"
        },
        {
            "introduction": "在理解了变量间的短期预测关系之后，下一步是量化冲击的长期累积效应。长期影响矩阵（long-run impact matrix）正是为此而设计的工具，它揭示了一个永久性冲击对系统中所有变量的最终均衡水平的影响。通过这个练习，你将学习如何从一个平稳的VAR模型参数中推导出该矩阵，并解释其经济含义，从而更深入地理解市场变量之间的持久相互作用。",
            "id": "4135202",
            "problem": "考虑一个用于能源系统市场中标准化对数价格的二阶双变量向量自回归 (VAR) 模型。令 $x_t = \\begin{pmatrix} \\tilde{p}^{el}_t \\\\ \\tilde{p}^{gas}_t \\end{pmatrix}$ 分别表示标准化对数日前电价和标准化对数天然气价格的向量，其中每个分量都已去均值并缩放到单位方差，因此两个序列都是无量纲的。其动态由平稳的 VAR(2) 给出\n$$\nx_t = A_1 x_{t-1} + A_2 x_{t-2} + u_t,\n$$\n其中 $u_t$ 是一个零均值、序列不相关的创新向量，其协方差为单位矩阵，滞后矩阵为\n$$\nA_1 = \\begin{pmatrix} 0.35  0.10 \\\\ 0.05  0.30 \\end{pmatrix}, \\quad A_2 = \\begin{pmatrix} 0.20  -0.05 \\\\ 0.00  0.10 \\end{pmatrix}.\n$$\n假设相关伴随形式的所有特征值都严格位于单位圆内，因此该 VAR 模型是稳定的，并允许 Wold 表示。\n\n从平稳多元时间序列的滞后算子和 Wold 分解的核心定义出发，推导长期影响矩阵的表达式\n$$\n\\Psi(1) = \\sum_{h=0}^{\\infty} \\Phi_h,\n$$\n其中矩阵 $\\Phi_h$ 是 Wold 表示 $x_t = \\sum_{h=0}^{\\infty} \\Phi_h u_{t-h}$ 中的移动平均 (MA) 系数。然后，对于给定的 $A_1$ 和 $A_2$，精确计算 $\\Psi(1)$，并报告其四舍五入到四位有效数字的数值。由于序列是标准化的且无量纲的，最终矩阵的表示无需物理单位。\n\n最后，根据对能源价格的持续性影响来解释 $\\Psi(1)$ 的各项：解释每个创新分量的均值发生一个单位的永久性变化对电力和天然气的长期标准化对数价格意味着什么，并将其与一次性脉冲冲击的影响区分开来。\n\n将 $\\Psi(1)$ 的所有报告数值四舍五入到四位有效数字。数值答案中不要包含任何物理单位。",
            "solution": "该问题陈述清晰且科学上合理，代表了向量自回归 (VAR) 模型在时间序列分析中的一个标准应用。我们开始解题。\n\n问题要求做三件事：\n1. 推导长期影响矩阵 $\\Psi(1)$ 的表达式。\n2. 对给定的 VAR(2) 模型进行 $\\Psi(1)$ 的数值计算。\n3. 对所得矩阵的各项进行解释。\n\n**1. 长期影响矩阵 $\\Psi(1)$ 的推导**\n\n我们从给定的平稳 VAR(2) 模型开始：\n$$\nx_t = A_1 x_{t-1} + A_2 x_{t-2} + u_t\n$$\n其中 $x_t$ 是一个 $2 \\times 1$ 的内生变量向量，$A_1$ 和 $A_2$ 是 $2 \\times 2$ 的系数矩阵，$u_t$ 是一个 $2 \\times 1$ 的白噪声创新向量。\n\n我们可以使用滞后算子 $L$ 来表示这个模型，其中 $L^k x_t = x_{t-k}$。将其应用于该方程得到：\n$$\nx_t = A_1 L x_t + A_2 L^2 x_t + u_t\n$$\n重新整理各项，将 $x_t$ 向量组合在一起得到：\n$$\n(I - A_1 L - A_2 L^2) x_t = u_t\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。我们可以定义自回归滞后多项式为 $A(L) = I - A_1 L - A_2 L^2$。于是该方程可以简洁地写为：\n$$\nA(L) x_t = u_t\n$$\n问题指出 VAR 过程是稳定的，这意味着它有一个 Wold 表示，也称为无限阶向量移动平均 (VMA) 表示，即 VMA$(\\infty)$。该表示将 $x_t$ 表示为当前和过去创新的线性组合：\n$$\nx_t = \\sum_{h=0}^{\\infty} \\Phi_h u_{t-h}\n$$\n按照惯例，$\\Phi_0 = I$。用滞后算子表示法，即为：\n$$\nx_t = \\left(\\sum_{h=0}^{\\infty} \\Phi_h L^h\\right) u_t = \\Phi(L) u_t\n$$\n其中 $\\Phi(L)$ 是移动平均滞后多项式。\n\n将 VMA$(\\infty)$ 表示代入 VAR 方程得到：\n$$\nA(L) \\left( \\Phi(L) u_t \\right) = u_t\n$$\n为使此恒等式对任何创新序列 $u_t$ 都成立，滞后多项式必须满足以下关系：\n$$\nA(L) \\Phi(L) = I\n$$\n这意味着 MA 多项式矩阵是 AR 多项式矩阵的逆：\n$$\n\\Phi(L) = [A(L)]^{-1}\n$$\n长期影响矩阵，记作 $\\Psi(1)$，定义为所有移动平均系数矩阵 $\\Phi_h$ 的和：\n$$\n\\Psi(1) = \\sum_{h=0}^{\\infty} \\Phi_h\n$$\n这个和等价于在 $L=1$ 处对 MA 多项式矩阵 $\\Phi(L)$ 求值：\n$$\n\\Psi(1) = \\Phi(1) = \\sum_{h=0}^{\\infty} \\Phi_h (1)^h = \\sum_{h=0}^{\\infty} \\Phi_h\n$$\n现在，我们使用关系式 $A(L) \\Phi(L) = I$。在 $L=1$ 处求值得到：\n$$\nA(1) \\Phi(1) = I\n$$\n求解 $\\Phi(1)$ (即 $\\Psi(1)$)，我们得到：\n$$\n\\Psi(1) = [A(1)]^{-1}\n$$\n矩阵 $A(1)$ 是通过将 $L=1$ 代入 AR 多项式 $A(L) = I - A_1 L - A_2 L^2$得到的：\n$$\nA(1) = I - A_1 (1) - A_2 (1)^2 = I - A_1 - A_2\n$$\n因此，长期影响矩阵的最终表达式为：\n$$\n\\Psi(1) = (I - A_1 - A_2)^{-1}\n$$\nVAR 过程的稳定性确保了矩阵 $(I - A_1 - A_2)$ 是可逆的。\n\n**2. $\\Psi(1)$ 的计算**\n\n我们已知矩阵：\n$$\nA_1 = \\begin{pmatrix} 0.35  0.10 \\\\ 0.05  0.30 \\end{pmatrix}, \\quad A_2 = \\begin{pmatrix} 0.20  -0.05 \\\\ 0.00  0.10 \\end{pmatrix}\n$$\n首先，我们计算矩阵 $M = I - A_1 - A_2$：\n$$\nM = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0.35  0.10 \\\\ 0.05  0.30 \\end{pmatrix} - \\begin{pmatrix} 0.20  -0.05 \\\\ 0.00  0.10 \\end{pmatrix}\n$$\n$$\nM = \\begin{pmatrix} 1 - 0.35 - 0.20  0 - 0.10 - (-0.05) \\\\ 0 - 0.05 - 0.00  1 - 0.30 - 0.10 \\end{pmatrix}\n$$\n$$\nM = \\begin{pmatrix} 0.45  -0.05 \\\\ -0.05  0.60 \\end{pmatrix}\n$$\n接下来，我们求 $M$ 的逆矩阵，即 $\\Psi(1) = M^{-1}$。对于一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n\n$M$ 的行列式为：\n$$\n\\det(M) = (0.45)(0.60) - (-0.05)(-0.05) = 0.27 - 0.0025 = 0.2675\n$$\n现在我们计算逆矩阵：\n$$\n\\Psi(1) = M^{-1} = \\frac{1}{0.2675} \\begin{pmatrix} 0.60  0.05 \\\\ 0.05  0.45 \\end{pmatrix}\n$$\n$$\n\\Psi(1) = \\begin{pmatrix} \\frac{0.60}{0.2675}  \\frac{0.05}{0.2675} \\\\ \\frac{0.05}{0.2675}  \\frac{0.45}{0.2675} \\end{pmatrix} = \\begin{pmatrix} 2.2430...  0.18691... \\\\ 0.18691...  1.68224... \\end{pmatrix}\n$$\n将每个元素四舍五入到四位有效数字，我们得到：\n$$\n\\Psi(1) \\approx \\begin{pmatrix} 2.243  0.1869 \\\\ 0.1869  1.682 \\end{pmatrix}\n$$\n\n**3. $\\Psi(1)$ 的解释**\n\n矩阵 $\\Psi(1)$ 代表了系统的长期乘数。其元素 $\\Psi(1)_{ij}$ 量化了变量 $j$ 的创新均值发生一个单位的永久性变化对变量 $i$ 水平所造成的总长期效应。\n\n让我们考虑初始过程 $x_t$ 的均值为 $\\mathbb{E}[x_t] = \\mu_x = 0$。现在，假设创新的均值发生了永久性变化，使得新的创新过程为 $v_t = u_t + c$，其中 $c$ 是一个常数 $2 \\times 1$ 向量。VAR模型变为 $x_t = A_1 x_{t-1} + A_2 x_{t-2} + v_t$。新的长期均衡均值 $\\mu_x^* = \\mathbb{E}[x_t]$ 必须满足：\n$$\n\\mu_x^* = A_1 \\mu_x^* + A_2 \\mu_x^* + \\mathbb{E}[v_t]\n$$\n$$\n(I - A_1 - A_2) \\mu_x^* = c\n$$\n$$\n\\mu_x^* = (I - A_1 - A_2)^{-1} c = \\Psi(1) c\n$$\n这表明 $\\Psi(1)$ 将创新均值的永久性变化映射到过程变量 $x_t$ 均值所产生的永久性变化。\n\n*与一次性脉冲冲击的区别*：$t$ 时刻的一次性脉冲冲击是指 $u_t$ 的单个非零值，例如 $u_t = c$，而当 $s \\neq t$ 时 $u_s=0$。这种冲击对 $x_{t+h}$ 水平的影响由 $\\Phi_h c$ 给出。对于一个平稳过程，这种影响会随时间消散，即当 $h \\to \\infty$ 时 $\\Phi_h \\to 0$。$x_t$ 的水平最终会回到其原始均值。这一单个冲击在所有未来时期的累积效应是 $\\sum_{h=0}^\\infty \\Phi_h c = \\Psi(1) c$。因此，虽然一次性冲击对变量的水平有暂时性影响（最终会消失），但创新过程的永久性变化会导致变量均衡水平的永久性变化，而这种水平变化的幅度由累积脉冲响应 $\\Psi(1)$ 给出。\n\n将此解释应用于我们关于 $x_t = (\\tilde{p}^{el}_t, \\tilde{p}^{gas}_t)^T$ 的数值结果：\n\n-   $\\Psi(1)_{11} \\approx 2.243$：电价创新 $u_t^{el}$ 的均值永久性增加一个单位，会导致电力标准化对数价格 $\\tilde{p}^{el}$ 永久性长期增加约 $2.243$ 个单位。\n-   $\\Psi(1)_{12} \\approx 0.1869$：天然气价格创新 $u_t^{gas}$ 的均值永久性增加一个单位，会导致电力标准化对数价格 $\\tilde{p}^{el}$ 永久性长期增加约 $0.1869$ 个单位。这是天然气市场冲击对电价的长期交叉效应。\n-   $\\Psi(1)_{21} \\approx 0.1869$：电价创新 $u_t^{el}$ 的均值永久性增加一个单位，会导致天然气标准化对数价格 $\\tilde{p}^{gas}$ 永久性长期增加约 $0.1869$ 个单位。\n-   $\\Psi(1)_{22} \\approx 1.682$：天然气价格创新 $u_t^{gas}$ 的均值永久性增加一个单位，会导致天然气标准化对数价格 $\\tilde{p}^{gas}$ 永久性长期增加约 $1.682$ 个单位。\n\n结果表明，两个市场之间存在正向的长期溢出效应，其中自有市场冲击的持续性影响大于交叉市场冲击，这与预期相符。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.243  0.1869 \\\\ 0.1869  1.682 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论分析最终要服务于实际应用。此前的练习侧重于分析VAR模型的特定属性，而本练习则将这些概念整合到一个更完整、更现实的向量误差修正模型（VECM）框架中。你将通过编程实践，模拟一个协整的能源市场系统对持续性外部冲击的动态响应。这项实践不仅能巩固你对VECM动力学的理解，还能让你掌握进行情景分析的核心技能，这在能源政策评估和风险管理中至关重要。",
            "id": "4135269",
            "problem": "设计并实现一个情景分析程序，以评估持续的天然气价格冲击对电价和电力负荷的影响。该评估使用由向量误差修正模型 (VECM) 建模的协整能源市场中识别出的结构性冲击。该系统由三个对数变量组成：天然气价格、电价和电力负荷，按月度频率收集。所有变量均以对数单位表示，因此是无量纲的。程序必须计算每种情景下，在指定的预测期内，电价和负荷的最终变化，结果以十进制数值表示。\n\n基本定义和假设：\n- 对于对数变量向量 $\\mathbf{x}_t \\in \\mathbb{R}^3$，一个 $p$ 阶向量自回归 (VAR) 模型可以写成水平形式：$$\\mathbf{x}_t = \\sum_{i=1}^p \\mathbf{A}_i \\mathbf{x}_{t-i} + \\boldsymbol{\\varepsilon}_t,$$ 其中 $\\boldsymbol{\\varepsilon}_t$ 是简化式创新。\n- 如果系统是协整的，且协整秩为 $r$，则 VAR 表示可以重写为向量误差修正模型 (VECM)：$$\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\sum_{i=1}^{p-1} \\boldsymbol{\\Gamma}_i \\Delta \\mathbf{x}_{t-i} + \\mathbf{K} \\mathbf{u}_t,$$ 其中 $\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top$ 的秩为 $r$，$\\boldsymbol{\\alpha} \\in \\mathbb{R}^{3 \\times r}$ 是调整（载荷）系数，$\\boldsymbol{\\beta} \\in \\mathbb{R}^{3 \\times r}$ 是协整向量，$\\boldsymbol{\\Gamma}_i \\in \\mathbb{R}^{3 \\times 3}$ 捕捉短期动态，而 $\\mathbf{u}_t \\in \\mathbb{R}^3$ 是已识别的、具有单位协方差的结构性冲击。识别意味着结构性冲击是标准正交的，并通过 $\\mathbf{K}$ 同期映射到系统，每个分量对应一个特定的结构性扰动（天然气、电力、负荷）。\n- 能源市场解读：协整关系编码了天然气价格、电价和负荷之间的长期均衡关系，其中电价对偏离均衡的调整比天然气价格或负荷更强。结构性冲击代表了经济上可解释的创新（例如，天然气供给冲击）。\n\n对于一个月度的三变量协整VECM，使用以下科学上合理的参数化，其中 $p = 2$，协整秩 $r = 1$：\n- 协整向量：$$\\boldsymbol{\\beta} = \\begin{bmatrix} 0.6 \\\\ -1.0 \\\\ 0.2 \\end{bmatrix},$$ 编码了平稳关系 $0.6 \\cdot \\text{天然气} - 1.0 \\cdot \\text{电力} + 0.2 \\cdot \\text{负荷} = \\text{常数}$。\n- 载荷（调整）系数：$$\\boldsymbol{\\alpha} = \\begin{bmatrix} 0.10 \\\\ 0.25 \\\\ -0.05 \\end{bmatrix},$$ 意味着电价的调整比天然气价格更强，而负荷的调整较弱且方向相反。\n- 误差修正矩阵：$$\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top \\in \\mathbb{R}^{3 \\times 3}.$$\n- 短期动态（由于 $p=2$，存在一阶变化滞后）：$$\\boldsymbol{\\Gamma}_1 = \\begin{bmatrix} 0.10  0.05  0.00 \\\\ 0.02  0.15  0.03 \\\\ -0.01  0.02  0.10 \\end{bmatrix}.$$\n- 同期结构性影响矩阵：$$\\mathbf{K} = \\mathbf{I}_3,$$ 即 $3 \\times 3$ 的单位矩阵，将每个结构性冲击分量识别为一个标准正交且独立的扰动。\n\n将持续的天然气价格冲击情景定义为仅应用于天然气分量的一系列结构性冲击，其振幅为 $s$，持续性因子为 $\\lambda$，持续时间为 $T_{\\text{shock}}$ 个月。具体来说，对于 $t = 1, 2, \\dots, T_{\\text{shock}}$，设置 $u_{g,t} = s \\cdot \\lambda^{t-1}$ 且 $u_{e,t} = 0$, $u_{l,t} = 0$。对于 $t > T_{\\text{shock}}$，所有冲击分量均为零。系统初始化于均衡状态 $\\mathbf{x}_0 = \\mathbf{0}$ 和 $\\Delta \\mathbf{x}_0 = \\mathbf{0}$，这满足协整关系。\n\n对于每个情景，向前模拟 VECM 模型 $H$ 个月，并报告在时间 $H$ 的电价和负荷，作为与基准（保持在均衡状态）的偏差，即模拟出的 $\\mathbf{x}_H$ 分量。由于变量是对数值，两个输出都是无量纲的，并且必须表示为小数（而非百分比）。\n\n不使用简化公式，实现 VECM 所蕴含的递归计算。对于 $t = 1, 2, \\dots, H$，计算：\n$$\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\boldsymbol{\\Gamma}_1 \\Delta \\mathbf{x}_{t-1} + \\mathbf{K} \\mathbf{u}_t,$$\n并更新：\n$$\\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t.$$\n\n测试套件：\n提供以下情景，每个情景由 $(s, \\lambda, T_{\\text{shock}}, H)$ 指定：\n- 情况 1（通用情况，正常路径）：$(0.1, 0.9, 12, 24)$。\n- 情况 2（边界情况，零冲击振幅）：$(0.0, 0.9, 12, 24)$。\n- 情况 3（边缘情况，单位持续性且持续时间长）：$(0.2, 1.0, 24, 36)$。\n- 情况 4（边缘情况，负振幅且预测期短于冲击持续时间）：$(-0.2, 0.95, 18, 12)$。\n- 情况 5（边界情况，低持续性且持续时间短）：$(0.1, 0.5, 6, 24)$。\n\n程序要求：\n- 程序必须为每种情况计算一个包含两个元素的列表，其中包含在预测期 $H$ 的电价偏差和负荷偏差，即 $[\\text{electricity}(H), \\text{load}(H)]$，两者均以对数单位（无量纲小数）表示。\n- 你的程序应生成单行输出，包含一个用方括号括起来的、逗号分隔的结果列表，并保持情况的顺序，其中每个情况的结果本身是一个双元素列表，例如：$[[a_1,b_1],[a_2,b_2],\\dots]$。\n\n所有数值输出必须为十进制形式。不涉及角度。由于变量是对数单位，不需要物理单位。",
            "solution": "该问题是有效的。它在科学上基于时间序列计量经济学（向量误差修正模型）的原理，作为一个具有确定初始条件的线性差分方程组的确定性模拟问题，其设定是完善的，并且所有参数和程序都得到了明确的规定，因此是客观的。\n\n任务是模拟一个代表协整能源市场的三变量VECM，以分析持续的天然气价格冲击的影响。系统状态由对数变量向量 $\\mathbf{x}_t = [\\text{天然气}_t, \\text{电力}_t, \\text{负荷}_t]^\\top$ 描述。\n\n模型动态由VECM方程决定：\n$$\n\\Delta \\mathbf{x}_t = \\boldsymbol{\\Pi} \\mathbf{x}_{t-1} + \\boldsymbol{\\Gamma}_1 \\Delta \\mathbf{x}_{t-1} + \\mathbf{K} \\mathbf{u}_t\n$$\n变量的水平值在每一步通过以下恒等式更新：\n$$\n\\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t\n$$\n\n参数矩阵定义如下：\n协整向量为 $\\boldsymbol{\\beta} = [0.6, -1.0, 0.2]^\\top$，载荷系数为 $\\boldsymbol{\\alpha} = [0.10, 0.25, -0.05]^\\top$。长期误差修正矩阵 $\\boldsymbol{\\Pi}$ 是它们的外积：\n$$\n\\boldsymbol{\\Pi} = \\boldsymbol{\\alpha} \\boldsymbol{\\beta}^\\top = \\begin{bmatrix} 0.10 \\\\ 0.25 \\\\ -0.05 \\end{bmatrix} \\begin{bmatrix} 0.6  -1.0  0.2 \\end{bmatrix} = \\begin{bmatrix} 0.06  -0.10  0.02 \\\\ 0.15  -0.25  0.05 \\\\ -0.03  0.05  -0.01 \\end{bmatrix}\n$$\n短期动态矩阵 $\\boldsymbol{\\Gamma}_1$ 由下式给出：\n$$\n\\boldsymbol{\\Gamma}_1 = \\begin{bmatrix} 0.10  0.05  0.00 \\\\ 0.02  0.15  0.03 \\\\ -0.01  0.02  0.10 \\end{bmatrix}\n$$\n同期结构性影响矩阵 $\\mathbf{K}$ 是 $3 \\times 3$ 的单位矩阵，$\\mathbf{K} = \\mathbf{I}_3$。\n\n情景分析需要模拟系统对特定结构性冲击的响应。该冲击仅施加于结构性创新向量 $\\mathbf{u}_t = [u_{g,t}, u_{e,t}, u_{l,t}]^\\top$ 的天然气价格分量。冲击的初始振幅为 $s$，持续性因子为 $\\lambda$，持续时间为 $T_{\\text{shock}}$ 个月。冲击定义为：\n$$\nu_{g,t} = \\begin{cases} s \\cdot \\lambda^{t-1}  \\text{对于 } 1 \\le t \\le T_{\\text{shock}} \\\\ 0  \\text{对于 } t > T_{\\text{shock}} \\end{cases}\n$$\n其他结构性冲击分量为零，即对于所有 $t \\geq 1$，$u_{e,t} = 0$ 且 $u_{l,t} = 0$。\n\n模拟通过一个递归算法进行，总预测期为 $H$ 个月。\n\n**算法：**\n\n1.  **初始化 (在 $t=0$ 时)**：系统从均衡状态开始。我们将初始状态向量设置为 $3 \\times 1$ 的列向量：\n    $$\n    \\mathbf{x}_0 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad \\Delta \\mathbf{x}_0 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n    $$\n\n2.  **迭代模拟 (对于 $t=1, 2, \\dots, H$)**：我们循环遍历直到预测期 $H$ 的每个时间步。在每个步骤 $t$：\n    a.  **构建冲击向量 $\\mathbf{u}_t$**：根据当前时间步 $t$ 和情景参数 $(s, \\lambda, T_{\\text{shock}})$，我们定义冲击向量 $\\mathbf{u}_t$。如果 $t \\le T_{\\text{shock}}$，第一个元素是 $s \\cdot \\lambda^{t-1}$；否则为 $0$。其他两个元素始终为 $0$。\n    b.  **计算变化量 $\\Delta \\mathbf{x}_t$**：使用上一步的状态 $\\mathbf{x}_{t-1}$ 和 $\\Delta \\mathbf{x}_{t-1}$，我们应用VECM方程。这涉及矩阵-向量乘法：\n        $$\n        \\Delta \\mathbf{x}_t = (\\boldsymbol{\\Pi} \\cdot \\mathbf{x}_{t-1}) + (\\boldsymbol{\\Gamma}_1 \\cdot \\Delta \\mathbf{x}_{t-1}) + (\\mathbf{K} \\cdot \\mathbf{u}_t)\n        $$\n    c.  **计算新水平值 $\\mathbf{x}_t$**：通过将计算出的变化量加到先前的状态上，找到新的状态：\n        $$\n        \\mathbf{x}_t = \\mathbf{x}_{t-1} + \\Delta \\mathbf{x}_t\n        $$\n    d.  **更新状态**：计算出的 $\\mathbf{x}_t$ 和 $\\Delta \\mathbf{x}_t$ 成为下一次迭代（即 $t+1$）的“先前”状态。\n\n3.  **结果提取**：循环完成后（即在 $t=H$ 时），最终的状态向量为 $\\mathbf{x}_H$。问题要求的是电价和负荷的偏差，它们分别是该向量的第二个和第三个分量。给定情景的结果是列表 $[\\mathbf{x}_H[1], \\mathbf{x}_H[2]]$。\n\n此过程将为提供的每个测试用例实施，并将结果汇总成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the VECM simulation for all test cases and print results.\n    \"\"\"\n    \n    # Base parameters for the VECM model.\n    # Cointegration vector beta (3x1)\n    beta = np.array([[0.6], [-1.0], [0.2]])\n    \n    # Loading coefficients alpha (3x1)\n    alpha = np.array([[0.10], [0.25], [-0.05]])\n    \n    # Long-run error-correction matrix Pi = alpha * beta.T (3x3)\n    Pi = alpha @ beta.T\n    \n    # Short-run dynamics matrix Gamma_1 (3x3)\n    Gamma_1 = np.array([\n        [0.10, 0.05, 0.00],\n        [0.02, 0.15, 0.03],\n        [-0.01, 0.02, 0.10]\n    ])\n    \n    # Contemporaneous structural impact matrix K (identity matrix, 3x3)\n    K = np.identity(3)\n\n    # All model matrices are now defined.\n    model_params = (Pi, Gamma_1, K)\n\n    # Test suite: each case is (s, lambda, T_shock, H)\n    test_cases = [\n        (0.1, 0.9, 12, 24),    # Case 1\n        (0.0, 0.9, 12, 24),    # Case 2\n        (0.2, 1.0, 24, 36),    # Case 3\n        (-0.2, 0.95, 18, 12),  # Case 4\n        (0.1, 0.5, 6, 24)      # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        s, lam, T_shock, H = case\n        # Run simulation for the current case\n        final_x = run_simulation(s, lam, T_shock, H, model_params)\n        \n        # Extract electricity price (index 1) and load (index 2)\n        # and convert to a plain list of floats.\n        result_pair = [final_x[1, 0], final_x[2, 0]]\n        results.append(result_pair)\n\n    # Format the output as a string representation of a list of lists.\n    # e.g., [[val1, val2], [val3, val4]]\n    # str(results) produces this format directly.\n    # The requirement is [[a_1,b_1],[a_2,b_2],...], which comma separating produces.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(s: float, lam: float, T_shock: int, H: int, model_params):\n    \"\"\"\n    Simulates the VECM for a given shock scenario.\n\n    Args:\n        s: Initial shock amplitude.\n        lam: Shock persistence factor (lambda).\n        T_shock: Duration of the shock in months.\n        H: Forecast horizon in months.\n        model_params: Tuple containing (Pi, Gamma_1, K) matrices.\n\n    Returns:\n        The final state vector x_H as a numpy array.\n    \"\"\"\n    Pi, Gamma_1, K = model_params\n\n    # Initialize state vectors at t=0\n    # x_t represents [gas, electricity, load] in log units\n    x_prev = np.zeros((3, 1))  # x_{t-1}\n    delta_x_prev = np.zeros((3, 1)) # Delta_x_{t-1}\n\n    # Simulate from t=1 to H\n    for t in range(1, H + 1):\n        # 1. Construct the structural shock vector u_t\n        u_t = np.zeros((3, 1))\n        if t = T_shock:\n            # Shock is applied to the gas component (first element)\n            u_t[0, 0] = s * (lam ** (t - 1))\n\n        # 2. Compute the change delta_x_t using the VECM equation\n        # delta_x_t = Pi @ x_{t-1} + Gamma_1 @ delta_x_{t-1} + K @ u_t\n        term_pi = Pi @ x_prev\n        term_gamma = Gamma_1 @ delta_x_prev\n        term_k = K @ u_t\n        delta_x_curr = term_pi + term_gamma + term_k\n\n        # 3. Compute the new level x_t\n        # x_t = x_{t-1} + delta_x_t\n        x_curr = x_prev + delta_x_curr\n\n        # 4. Update state variables for the next iteration\n        x_prev = x_curr\n        delta_x_prev = delta_x_curr\n    \n    # After the loop, x_prev holds the final state x_H\n    return x_prev\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}