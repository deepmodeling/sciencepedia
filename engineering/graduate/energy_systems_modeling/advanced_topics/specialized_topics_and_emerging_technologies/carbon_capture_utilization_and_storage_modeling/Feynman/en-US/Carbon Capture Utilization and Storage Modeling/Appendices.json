{
    "hands_on_practices": [
        {
            "introduction": "Amine scrubbing is a cornerstone technology for post-combustion $CO_2$ capture, but its long-term performance is influenced by factors like solvent degradation. This exercise delves into the dynamic performance of an absorber, challenging you to model how the chemical breakdown of the solvent over time impacts overall capture efficiency . By deriving and implementing a model that couples mass transfer principles with degradation kinetics, you will develop a deeper understanding of the operational trade-offs and lifetime performance considerations for these critical systems.",
            "id": "4076063",
            "problem": "An amine-based Carbon Dioxide ($CO_2$) absorber operates as a plug-flow device with gas-phase molar flow rate $F_g$ in $\\mathrm{mol/s}$, cross-sectional area $A$ in $\\mathrm{m^2}$, packing interfacial area $a$ in $\\mathrm{m^2/m^3}$, liquid-side mass transfer coefficient $k_L$ in $\\mathrm{m/s}$, absorber height $H_{\\mathrm{col}}$ in $\\mathrm{m}$, and total pressure $P$ in $\\mathrm{Pa}$. The inlet $CO_2$ mol fraction is $y_{\\mathrm{in}}$ (dimensionless). The Henry’s law constant for $CO_2$ in water is $H_{\\mathrm{CO2}}$ in $\\mathrm{Pa \\cdot m^3/mol}$, relating equilibrium dissolved concentration $c^*$ to gas partial pressure via $c^* = p_{\\mathrm{CO2}} / H_{\\mathrm{CO2}}$, where $p_{\\mathrm{CO2}} = y P$. The diffusivity of $CO_2$ in the solvent is $D_{\\mathrm{CO2}}$ in $\\mathrm{m^2/s}$. Solvent reactivity follows pseudo-first-order kinetics with a time-dependent rate constant $k_{\\mathrm{rxn}}(t)$ in $\\mathrm{s^{-1}}$ that decays due to solvent degradation according to first-order deactivation with rate $k_{\\mathrm{deg}}$ in $\\mathrm{h^{-1}}$, so that $k_{\\mathrm{rxn}}(t) = k_{\\mathrm{rxn},0} \\exp(-k_{\\mathrm{deg}} t)$, where $t$ is the cumulative operation time in $\\mathrm{h}$ and $k_{\\mathrm{rxn},0}$ is the initial pseudo-first-order rate constant in $\\mathrm{s^{-1}}$.\n\nStarting from:\n- gas-phase plug-flow mass balance $d(F_g y)/dz = -A N_{\\mathrm{CO2}}$ with axial coordinate $z$ in $\\mathrm{m}$,\n- two-film theory where the liquid-side flux is $N_{\\mathrm{CO2}} = k_L a \\mathcal{E}(t) (c^* - c_{\\mathrm{bulk}})$,\n- Henry’s law $c^* = y P / H_{\\mathrm{CO2}}$,\n- the Danckwerts enhancement factor for a pseudo-first-order reaction in the liquid film $\\mathcal{E}(t) = \\sqrt{1 + \\mathrm{Ha}(t)^2}$ with the Hatta number $\\mathrm{Ha}(t) = \\sqrt{k_{\\mathrm{rxn}}(t) D_{\\mathrm{CO2}}}/k_L$,\n\nand assuming dilute absorption such that $c_{\\mathrm{bulk}} \\approx 0$ and $F_g$ is approximately constant along $z$, derive an expression for the instantaneous capture efficiency $\\eta(t)$ at time $t$ and quantify the efficiency decline $\\Delta \\eta(t) = \\eta(0) - \\eta(t)$ as a decimal fraction (no percentage sign), where $\\eta(t) = 1 - y_{\\mathrm{out}}(t)/y_{\\mathrm{in}}$ and $y_{\\mathrm{out}}(t)$ is the outlet mol fraction at $z = H_{\\mathrm{col}}$.\n\nYour program must implement the derived expression and compute $\\Delta \\eta(t)$ for the following test suite. Use the provided parameter values with the indicated units, and produce the results in a single line as a comma-separated list enclosed in square brackets. Each result must be a float rounded to six decimal places. Scientific realism must be maintained: do not alter the modeling assumptions listed above, and ensure dimensional consistency.\n\nConstants common to all cases:\n- $P = 101325$ in $\\mathrm{Pa}$,\n- $H_{\\mathrm{CO2}} = 3000$ in $\\mathrm{Pa \\cdot m^3/mol}$,\n- $k_L = 5 \\times 10^{-4}$ in $\\mathrm{m/s}$,\n- $a = 250$ in $\\mathrm{m^2/m^3}$,\n- $D_{\\mathrm{CO2}} = 1.6 \\times 10^{-9}$ in $\\mathrm{m^2/s}$,\n- $A = 1.0$ in $\\mathrm{m^2}$,\n- $F_g = 100$ in $\\mathrm{mol/s}$,\n- $y_{\\mathrm{in}} = 0.12$ (dimensionless).\n\nTest suite (each case specifies $(H_{\\mathrm{col}}$ in $\\mathrm{m}$, $k_{\\mathrm{rxn},0}$ in $\\mathrm{s^{-1}}$, $k_{\\mathrm{deg}}$ in $\\mathrm{h^{-1}}$, $t$ in $\\mathrm{h})$):\n1. $(10,\\ 200,\\ 0.02,\\ 24)$: general case with moderate degradation over one day.\n2. $(10,\\ 200,\\ 0.0,\\ 100)$: boundary case of no degradation; decline should be $0$.\n3. $(10,\\ 200,\\ 0.5,\\ 48)$: edge case with rapid degradation over two days.\n4. $(10,\\ 0,\\ 0.1,\\ 24)$: edge case of purely physical absorption (no reaction); decline should be $0$.\n5. $(30,\\ 200,\\ 0.02,\\ 24)$: tall absorber to test sensitivity to $H_{\\mathrm{col}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[result1,result2,result3,result4,result5]”), where each “result” is $\\Delta \\eta(t)$ for the corresponding case, expressed as a decimal fraction rounded to six decimal places.",
            "solution": "The user has provided a problem on modeling a CO$_2$ absorber and requested a derivation and numerical solution.\n\n### Step 1: Extract Givens\n\n**System Variables and Equations:**\n- Gas-phase molar flow rate: $F_g$ (mol/s)\n- Absorber cross-sectional area: $A$ ($\\mathrm{m^2}$)\n- Packing interfacial area: $a$ ($\\mathrm{m^2/m^3}$)\n- Liquid-side mass transfer coefficient: $k_L$ (m/s)\n- Absorber height: $H_{\\mathrm{col}}$ (m)\n- Total pressure: $P$ (Pa)\n- Inlet CO$_2$ mol fraction: $y_{\\mathrm{in}}$ (dimensionless)\n- Outlet CO$_2$ mol fraction at time $t$: $y_{\\mathrm{out}}(t)$ (dimensionless)\n- Henry’s law constant: $H_{\\mathrm{CO2}}$ ($\\mathrm{Pa \\cdot m^3/mol}$)\n- Diffusivity of CO$_2$ in solvent: $D_{\\mathrm{CO2}}$ ($\\mathrm{m^2/s}$)\n- Initial pseudo-first-order rate constant: $k_{\\mathrm{rxn},0}$ ($\\mathrm{s^{-1}}$)\n- First-order deactivation rate constant: $k_{\\mathrm{deg}}$ ($\\mathrm{h^{-1}}$)\n- Cumulative operation time: $t$ (h)\n- Axial coordinate: $z$ (m)\n\n**Governing Relations and Definitions:**\n1.  Gas-phase plug-flow mass balance: $d(F_g y)/dz = -A N_{\\mathrm{CO2}}$\n2.  Time-dependent reaction rate constant: $k_{\\mathrm{rxn}}(t) = k_{\\mathrm{rxn},0} \\exp(-k_{\\mathrm{deg}} t)$\n3.  Two-film theory flux: $N_{\\mathrm{CO2}} = k_L a \\mathcal{E}(t) (c^* - c_{\\mathrm{bulk}})$\n4.  Henry's Law: $c^* = y P / H_{\\mathrm{CO2}}$\n5.  Danckwerts enhancement factor: $\\mathcal{E}(t) = \\sqrt{1 + \\mathrm{Ha}(t)^2}$\n6.  Hatta number: $\\mathrm{Ha}(t) = \\sqrt{k_{\\mathrm{rxn}}(t) D_{\\mathrm{CO2}}}/k_L$\n7.  Instantaneous capture efficiency: $\\eta(t) = 1 - y_{\\mathrm{out}}(t)/y_{\\mathrm{in}}$\n8.  Efficiency decline: $\\Delta \\eta(t) = \\eta(0) - \\eta(t)$\n\n**Assumptions:**\n1.  Dilute absorption: bulk liquid concentration $c_{\\mathrm{bulk}} \\approx 0$.\n2.  Constant gas-phase molar flow rate: $F_g$ is constant along the absorber height $z$.\n\n**Constants Common to All Cases:**\n- $P = 101325$ Pa\n- $H_{\\mathrm{CO2}} = 3000$ $\\mathrm{Pa \\cdot m^3/mol}$\n- $k_L = 5 \\times 10^{-4}$ m/s\n- $a = 250$ $\\mathrm{m^2/m^3}$\n- $D_{\\mathrm{CO2}} = 1.6 \\times 10^{-9}$ $\\mathrm{m^2/s}$\n- $A = 1.0$ $\\mathrm{m^2}$\n- $F_g = 100$ mol/s\n- $y_{\\mathrm{in}} = 0.12$\n\n**Test Suite (case format: $(H_{\\mathrm{col}}, k_{\\mathrm{rxn},0}, k_{\\mathrm{deg}}, t)$):**\n1.  $(10, 200, 0.02, 24)$\n2.  $(10, 200, 0.0, 100)$\n3.  $(10, 200, 0.5, 48)$\n4.  $(10, 0, 0.1, 24)$\n5.  $(30, 200, 0.02, 24)$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n-   **Scientifically Grounded**: The problem is based on standard, well-established principles of chemical reaction engineering and mass transfer, specifically the modeling of a packed-bed gas absorber with a chemical reaction (e.g., amine scrubbing). The two-film theory, Henry's law, Danckwerts enhancement factor, Hatta number, and plug-flow reactor model are all cornerstones of this field. The modeling of solvent degradation as a first-order decay process is a reasonable and common kinetic simplification. The physical constants are of a realistic order of magnitude for such systems. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides a complete set of equations, parameters, and boundary conditions ($y(z=0) = y_{\\mathrm{in}}$) to derive a unique expression for the outlet concentration $y_{\\mathrm{out}}(t)$ and thus the efficiency $\\eta(t)$. The simplifying assumptions ($c_{\\mathrm{bulk}} \\approx 0$, constant $F_g$) render the governing differential equation analytically solvable. The task is clearly defined: derive an expression and compute a specific quantity, $\\Delta \\eta(t)$, for a given set of test cases. A unique, stable, and meaningful solution exists.\n-   **Objective**: The problem is stated in precise, quantitative, and technical language. It is free from subjective claims, opinions, or ambiguity.\n-   **Other Flaws**: The problem is not incomplete, contradictory, unrealistic, ill-posed, trivial, or unverifiable. It is a standard, formalizable engineering problem.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A step-by-step derivation of the solution will be performed.\n\n### Derivation of the Solution\n\nThe goal is to derive an expression for the efficiency decline, $\\Delta \\eta(t) = \\eta(0) - \\eta(t)$.\n\n1.  **Simplify the Mass Balance:** Start with the plug-flow mass balance, $d(F_g y)/dz = -A N_{\\mathrm{CO2}}$. Given the assumption that the gas molar flow rate $F_g$ is constant, we can write:\n    $$ F_g \\frac{dy}{dz} = -A N_{\\mathrm{CO2}} $$\n\n2.  **Formulate the Flux Expression:** The flux of CO$_2$ into the liquid, $N_{\\mathrm{CO2}}$, is given by the two-film theory: $N_{\\mathrm{CO2}} = k_L a \\mathcal{E}(t) (c^* - c_{\\mathrm{bulk}})$. Applying the assumption $c_{\\mathrm{bulk}} \\approx 0$ and substituting Henry's Law, $c^* = y P / H_{\\mathrm{CO2}}$, we get:\n    $$ N_{\\mathrm{CO2}} = k_L a \\mathcal{E}(t) \\frac{y P}{H_{\\mathrm{CO2}}} $$\n\n3.  **Construct the Differential Equation:** Substitute the flux expression into the mass balance:\n    $$ F_g \\frac{dy}{dz} = -A \\left( k_L a \\mathcal{E}(t) \\frac{y P}{H_{\\mathrm{CO2}}} \\right) $$\n    This is a first-order ordinary differential equation in $y(z)$. All terms on the right-hand side, except for $y$, are constant with respect to the spatial coordinate $z$. Rearranging for integration gives:\n    $$ \\frac{dy}{y} = - \\left( \\frac{A k_L a P \\mathcal{E}(t)}{F_g H_{\\mathrm{CO2}}} \\right) dz $$\n\n4.  **Integrate the Differential Equation:** We integrate along the length of the absorber, from $z=0$ to $z=H_{\\mathrm{col}}$, where the mol fraction changes from $y(0) = y_{\\mathrm{in}}$ to $y(H_{\\mathrm{col}}) = y_{\\mathrm{out}}(t)$:\n    $$ \\int_{y_{\\mathrm{in}}}^{y_{\\mathrm{out}}(t)} \\frac{dy}{y} = \\int_{0}^{H_{\\mathrm{col}}} - \\frac{A k_L a P \\mathcal{E}(t)}{F_g H_{\\mathrm{CO2}}} dz $$\n    $$ \\ln(y)\\Big|_{y_{\\mathrm{in}}}^{y_{\\mathrm{out}}(t)} = - \\frac{A k_L a P H_{\\mathrm{col}}}{F_g H_{\\mathrm{CO2}}} \\mathcal{E}(t) $$\n    $$ \\ln\\left(\\frac{y_{\\mathrm{out}}(t)}{y_{\\mathrm{in}}}\\right) = - \\frac{A k_L a P H_{\\mathrm{col}}}{F_g H_{\\mathrm{CO2}}} \\mathcal{E}(t) $$\n\n5.  **Solve for Capture Efficiency $\\eta(t)$:** Exponentiating both sides gives the ratio of outlet to inlet mol fractions:\n    $$ \\frac{y_{\\mathrm{out}}(t)}{y_{\\mathrm{in}}} = \\exp\\left( - \\frac{A k_L a P H_{\\mathrm{col}}}{F_g H_{\\mathrm{CO2}}} \\mathcal{E}(t) \\right) $$\n    The capture efficiency is defined as $\\eta(t) = 1 - y_{\\mathrm{out}}(t)/y_{\\mathrm{in}}$. Substituting the expression for the mol fraction ratio:\n    $$ \\eta(t) = 1 - \\exp\\left( - \\frac{A k_L a P H_{\\mathrm{col}}}{F_g H_{\\mathrm{CO2}}} \\mathcal{E}(t) \\right) $$\n\n6.  **Express the Time-Dependent Enhancement Factor $\\mathcal{E}(t)$:**\n    The Hatta number at time $t$ is $\\mathrm{Ha}(t) = \\sqrt{k_{\\mathrm{rxn}}(t) D_{\\mathrm{CO2}}}/k_L$.\n    Substituting the expression for the decaying rate constant, $k_{\\mathrm{rxn}}(t) = k_{\\mathrm{rxn},0} \\exp(-k_{\\mathrm{deg}} t)$:\n    $$ \\mathrm{Ha}(t)^2 = \\frac{k_{\\mathrm{rxn}}(t) D_{\\mathrm{CO2}}}{k_L^2} = \\frac{k_{\\mathrm{rxn},0} D_{\\mathrm{CO2}}}{k_L^2} \\exp(-k_{\\mathrm{deg}} t) $$\n    The enhancement factor is $\\mathcal{E}(t) = \\sqrt{1 + \\mathrm{Ha}(t)^2}$:\n    $$ \\mathcal{E}(t) = \\sqrt{1 + \\frac{k_{\\mathrm{rxn},0} D_{\\mathrm{CO2}}}{k_L^2} \\exp(-k_{\\mathrm{deg}} t)} $$\n    Note that the units for $k_{\\mathrm{deg}}$ ($\\mathrm{h^{-1}}$) and $t$ ($\\mathrm{h}$) are consistent, making the term $k_{\\mathrm{deg}}t$ dimensionless.\n\n7.  **Derive the Efficiency Decline $\\Delta \\eta(t)$:** The efficiency decline is $\\Delta \\eta(t) = \\eta(0) - \\eta(t)$.\n    Let's define a grouped parameter $\\beta$ for clarity, which represents the number of transfer units for purely physical absorption multiplied by the column height:\n    $$ \\beta_H = \\frac{A k_L a P H_{\\mathrm{col}}}{F_g H_{\\mathrm{CO2}}} $$\n    The efficiency expressions become:\n    $$ \\eta(t) = 1 - \\exp(-\\beta_H \\mathcal{E}(t)) $$\n    $$ \\eta(0) = 1 - \\exp(-\\beta_H \\mathcal{E}(0)) $$\n    where $\\mathcal{E}(0) = \\sqrt{1 + k_{\\mathrm{rxn},0} D_{\\mathrm{CO2}} / k_L^2}$ since $\\exp(0) = 1$.\n    The decline is therefore:\n    $$ \\Delta \\eta(t) = \\left[1 - \\exp(-\\beta_H \\mathcal{E}(0))\\right] - \\left[1 - \\exp(-\\beta_H \\mathcal{E}(t))\\right] $$\n    $$ \\Delta \\eta(t) = \\exp(-\\beta_H \\mathcal{E}(t)) - \\exp(-\\beta_H \\mathcal{E}(0)) $$\n    This is the final expression to be implemented. The calculation involves first computing the Hatta number at $t=0$ and time $t$, then the corresponding enhancement factors $\\mathcal{E}(0)$ and $\\mathcal{E}(t)$, and finally substituting these into the expression for $\\Delta \\eta(t)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the CO2 capture efficiency decline for a set of test cases\n    based on a derived model for an amine-based absorber.\n    \"\"\"\n    # Define constants common to all cases\n    P = 101325.0       # Total pressure, Pa\n    H_CO2 = 3000.0     # Henry's law constant, Pa * m^3 / mol\n    k_L = 5.0e-4       # Liquid-side mass transfer coefficient, m/s\n    a = 250.0          # Packing interfacial area, m^2/m^3\n    D_CO2 = 1.6e-9     # Diffusivity of CO2 in solvent, m^2/s\n    A = 1.0            # Absorber cross-sectional area, m^2\n    F_g = 100.0        # Gas-phase molar flow rate, mol/s\n    # y_in = 0.12, not needed for delta_eta calculation\n\n    # Define the test cases from the problem statement.\n    # Format: (H_col (m), k_rxn_0 (s^-1), k_deg (h^-1), t (h))\n    test_cases = [\n        (10.0, 200.0, 0.02, 24.0), # general case\n        (10.0, 200.0, 0.0, 100.0), # no degradation\n        (10.0, 200.0, 0.5, 48.0),  # rapid degradation\n        (10.0, 0.0, 0.1, 24.0),    # no reaction (physical absorption)\n        (30.0, 200.0, 0.02, 24.0)  # tall absorber\n    ]\n\n    results = []\n\n    # Pre-calculate constant groups to simplify the loop\n    beta_base = (A * k_L * a * P) / (F_g * H_CO2)\n    Ha_sq_base = D_CO2 / (k_L**2)\n\n    for case in test_cases:\n        H_col, k_rxn_0, k_deg, t = case\n\n        # Calculate the dimensionless group for the exponent\n        beta_H = beta_base * H_col\n\n        # Calculate the square of the initial Hatta number\n        Ha_0_sq = Ha_sq_base * k_rxn_0\n\n        # Calculate the enhancement factor at time t=0\n        # E(0) = sqrt(1 + Ha(0)^2)\n        E_0 = np.sqrt(1.0 + Ha_0_sq)\n\n        # Calculate the enhancement factor at time t\n        # k_rxn(t) = k_rxn_0 * exp(-k_deg * t)\n        # E(t) = sqrt(1 + Ha(0)^2 * exp(-k_deg * t))\n        # Note: k_deg is in h^-1 and t is in h, so k_deg*t is dimensionless.\n        E_t = np.sqrt(1.0 + Ha_0_sq * np.exp(-k_deg * t))\n\n        # Calculate the efficiency decline delta_eta(t) = eta(0) - eta(t)\n        # delta_eta(t) = exp(-beta_H * E(t)) - exp(-beta_H * E(0))\n        delta_eta = np.exp(-beta_H * E_t) - np.exp(-beta_H * E_0)\n        \n        results.append(delta_eta)\n\n    # Format results as a list of strings with 6 decimal places\n    results_str = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Ensuring the long-term security of geologically stored CO2 requires a sophisticated understanding of subsurface geochemistry. When CO2 dissolves in brine, it forms a weak acid that reacts with reservoir minerals, altering the rock's physical properties. This practice guides you through simulating these complex interactions, focusing on the kinetics of mineral dissolution and secondary mineral precipitation . By implementing a numerical model to track these reactions, you will build a fundamental tool for assessing the evolution of reservoir porosity and permeability, which are crucial for predicting the permanence and capacity of a storage site.",
            "id": "4076068",
            "problem": "You are modeling mineral reactions relevant to Carbon Capture, Utilization, and Storage (CCUS). When carbon dioxide is injected into a saline aquifer, brine becomes acidified and silicate minerals such as feldspar dissolve, potentially forming secondary aluminosilicate minerals like kaolinite. Assume a batch reactor with constant brine pH and constant saturation indices provided by prior speciation calculations. Your task is to compute the feldspar dissolution rate under acidified brine conditions using a kinetic rate law grounded in Arrhenius kinetics and acid-promoted dissolution, and then estimate the formation of a secondary mineral (kaolinite) over a specified time horizon by integrating mass-balance Ordinary Differential Equations (ODEs).\n\nFundamental base and modeling assumptions:\n- Use the Arrhenius law for temperature dependence of the rate constant: the dissolution rate constant is $k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{R T}\\right)$, where $R$ is the universal gas constant.\n- Acid-promoted dissolution follows a power-law dependence on hydrogen ion activity: the rate term includes $a_{\\mathrm{H^+}}^n$, with $a_{\\mathrm{H^+}} = 10^{-\\mathrm{pH}}$.\n- The thermodynamic driving force is represented by the saturation ratio $Q/K$. Use a linear affinity term $1 - Q/K$ for dissolution and $Q/K - 1$ for precipitation, clamped at zero to prevent sign reversal of rates.\n- Consider albite feldspar dissolution releasing aluminum and silicon according to stoichiometry $\\mathrm{NaAlSi_3O_8} \\rightarrow \\mathrm{Na^+} + \\mathrm{Al}^{3+}(\\text{aq}) + 3\\,\\mathrm{Si}^{4+}(\\text{aq})$ under acid conditions. For kaolinite precipitation with formula $\\mathrm{Al_2Si_2O_5(OH)_4}$, consume $2$ moles of aluminum and $2$ moles of silicon per mole of kaolinite formed.\n- Reactive surface areas are constant in time.\n- Brine pH and saturation ratios are constant over the time horizon.\n- No transport; well-mixed batch.\n\nMathematical model:\n- Dissolution rate per area is $r_{\\mathrm{diss,area}} = k(T)\\,a_{\\mathrm{H^+}}^{n}\\,\\max\\!\\left(0,\\,1 - \\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}}\\right)$ in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$, where the subscript $\\mathrm{F}$ denotes feldspar and $Q_{\\mathrm{F}}/K_{\\mathrm{F}}$ is given.\n- Total dissolution rate is $r_{\\mathrm{diss}} = r_{\\mathrm{diss,area}}\\,A_{\\mathrm{F}}$ in $\\mathrm{mol\\,s^{-1}}$, with $A_{\\mathrm{F}}$ the feldspar reactive surface area.\n- Precipitation rate (pseudo-first-order, driven by supersaturation) is $r_{\\mathrm{precip}} = k_{\\mathrm{precip}}\\,\\max\\!\\left(0,\\,\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} - 1\\right)\\,A_{\\mathrm{K}}$ in $\\mathrm{mol\\,s^{-1}}$, where subscript $\\mathrm{K}$ denotes kaolinite and $A_{\\mathrm{K}}$ is the precipitation surface area.\n- Mass-balance ODEs for species in moles:\n  - $\\dfrac{dN_{\\mathrm{F}}}{dt} = -\\,r_{\\mathrm{diss}}$,\n  - $\\dfrac{dN_{\\mathrm{Al}}}{dt} = 1\\cdot r_{\\mathrm{diss}} - 2\\cdot r_{\\mathrm{precip,eff}}$,\n  - $\\dfrac{dN_{\\mathrm{Si}}}{dt} = 3\\cdot r_{\\mathrm{diss}} - 2\\cdot r_{\\mathrm{precip,eff}}$,\n  - $\\dfrac{dN_{\\mathrm{Kln}}}{dt} = r_{\\mathrm{precip,eff}}$,\n  where $r_{\\mathrm{precip,eff}}$ is the precipitation rate limited by stoichiometric availability each step: $r_{\\mathrm{precip,eff}} = \\min\\!\\left(r_{\\mathrm{precip}},\\,\\dfrac{N_{\\mathrm{Al}}}{2\\,\\Delta t},\\,\\dfrac{N_{\\mathrm{Si}}}{2\\,\\Delta t}\\right)$ and $\\Delta t$ is the time step.\n\nNumerical integration:\n- Use an explicit Euler method with time step $\\Delta t$ to integrate over the time horizon $t_{\\mathrm{horizon}}$.\n- Clamp $r_{\\mathrm{diss}}$ by available feldspar to prevent negative inventory: the moles dissolved per step are $\\min(r_{\\mathrm{diss}}\\Delta t, N_{\\mathrm{F}})$.\n- Clamp species inventories to be non-negative.\n\nConstants and parameters:\n- Universal gas constant $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Dissolution Arrhenius pre-exponential $k_0 = 3000.0\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n- Activation energy $E_a = 65000.0\\,\\mathrm{J\\,mol^{-1}}$.\n- Acid reaction order $n = 0.5$.\n- Kaolinite precipitation pseudo-rate constant $k_{\\mathrm{precip}} = 10^{-6}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n\nTest suite:\nCompute the final total moles of kaolinite formed $N_{\\mathrm{Kln}}(t_{\\mathrm{horizon}})$ for each parameter set below. All temperatures must be in Kelvin, times in seconds, surface areas in square meters, and the final requested outputs must be expressed in moles. Round each final output to six decimal places in your program.\n\n- Case A (happy path, dissolves and precipitates):\n  - Initial feldspar inventory $N_{\\mathrm{F},0} = 5.0\\,\\mathrm{mol}$,\n  - Feldspar area $A_{\\mathrm{F}} = 10.0\\,\\mathrm{m^2}$,\n  - Precipitation area $A_{\\mathrm{K}} = 5.0\\,\\mathrm{m^2}$,\n  - Temperature $T = 323\\,\\mathrm{K}$,\n  - $\\mathrm{pH} = 3.0$,\n  - Feldspar saturation ratio $\\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}} = 0.2$,\n  - Kaolinite saturation ratio $\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} = 1.5$,\n  - Time horizon $t_{\\mathrm{horizon}} = 604800\\,\\mathrm{s}$,\n  - Time step $\\Delta t = 3600\\,\\mathrm{s}$.\n\n- Case B (boundary: zero reactive surface area, no dissolution):\n  - $N_{\\mathrm{F},0} = 1.0\\,\\mathrm{mol}$,\n  - $A_{\\mathrm{F}} = 0.0\\,\\mathrm{m^2}$,\n  - $A_{\\mathrm{K}} = 5.0\\,\\mathrm{m^2}$,\n  - $T = 298\\,\\mathrm{K}$,\n  - $\\mathrm{pH} = 3.5$,\n  - $\\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}} = 0.5$,\n  - $\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} = 1.2$,\n  - $t_{\\mathrm{horizon}} = 86400\\,\\mathrm{s}$,\n  - $\\Delta t = 3600\\,\\mathrm{s}$.\n\n- Case C (edge: near feldspar saturation, no kaolinite supersaturation):\n  - $N_{\\mathrm{F},0} = 2.0\\,\\mathrm{mol}$,\n  - $A_{\\mathrm{F}} = 8.0\\,\\mathrm{m^2}$,\n  - $A_{\\mathrm{K}} = 5.0\\,\\mathrm{m^2}$,\n  - $T = 298\\,\\mathrm{K}$,\n  - $\\mathrm{pH} = 4.0$,\n  - $\\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}} = 0.98$,\n  - $\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} = 0.9$,\n  - $t_{\\mathrm{horizon}} = 172800\\,\\mathrm{s}$,\n  - $\\Delta t = 3600\\,\\mathrm{s}$.\n\n- Case D (high temperature and strong acidity, moderate supersaturation):\n  - $N_{\\mathrm{F},0} = 20.0\\,\\mathrm{mol}$,\n  - $A_{\\mathrm{F}} = 50.0\\,\\mathrm{m^2}$,\n  - $A_{\\mathrm{K}} = 10.0\\,\\mathrm{m^2}$,\n  - $T = 353\\,\\mathrm{K}$,\n  - $\\mathrm{pH} = 2.5$,\n  - $\\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}} = 0.05$,\n  - $\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} = 1.1$,\n  - $t_{\\mathrm{horizon}} = 86400\\,\\mathrm{s}$,\n  - $\\Delta t = 1800\\,\\mathrm{s}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in moles, rounded to six decimal places for each test case, ordered as Case A, Case B, Case C, Case D. For example, the output format is $[x_1,x_2,x_3,x_4]$ where each $x_i$ is a float in moles rounded to six decimal places.",
            "solution": "The problem requires the calculation of kaolinite mineral formation over a specified time horizon in a simplified geochemical batch reactor model. The model simulates the dissolution of feldspar and the subsequent precipitation of kaolinite. The problem is scientifically grounded in established principles of chemical kinetics and thermodynamics, well-posed with a complete set of parameters and equations, and objective in its formulation. It is therefore deemed a valid problem.\n\nThe solution will be developed by implementing a numerical integration of the provided system of mass-balance ordinary differential equations (ODEs). An explicit, time-stepping algorithm based on the Euler method is specified, which will be implemented following an operator-splitting approach. This approach separates the processes of dissolution and precipitation within each time step, which is a common and robust technique in reactive transport modeling. This ensures that materials dissolved in a given step are available for precipitation in the same step, accurately reflecting the physical process coupling.\n\nFirst, we define the state variables of the system, which are the molar inventories of the minerals and aqueous species: $N_{\\mathrm{F}}$ (feldspar), $N_{\\mathrm{Kln}}$ (kaolinite), $N_{\\mathrm{Al}}$ (aqueous aluminum), and $N_{\\mathrm{Si}}$ (aqueous silicon). The initial conditions are $N_{\\mathrm{F}}(0) = N_{\\mathrm{F},0}$ and $N_{\\mathrm{Kln}}(0) = N_{\\mathrm{Al}}(0) = N_{\\mathrm{Si}}(0) = 0$.\n\nThe core of the simulation involves calculating the rates of reaction. The problem states that several key parameters are constant over the simulation time: brine $\\mathrm{pH}$, saturation ratios ($Q/K$), and reactive surface areas ($A$). This significantly simplifies the calculation, as the potential rates of dissolution and precipitation are constant throughout the simulation.\n\nThe dissolution rate for feldspar is governed by an Arrhenius law for temperature dependence and a power law for the effect of acid concentration. The rate per unit area, $r_{\\mathrm{diss,area}}$, is given by:\n$$r_{\\mathrm{diss,area}} = k(T)\\,a_{\\mathrm{H^+}}^{n}\\,\\max\\!\\left(0,\\,1 - \\dfrac{Q_{\\mathrm{F}}}{K_{\\mathrm{F}}}\\right)$$\nwhere the temperature-dependent rate constant $k(T)$ is:\n$$k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{R T}\\right)$$\nThe term $a_{\\mathrm{H^+}}$ is the hydrogen ion activity, calculated as $a_{\\mathrm{H^+}} = 10^{-\\mathrm{pH}}$. The constants provided are the universal gas constant $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, the pre-exponential factor $k_0 = 3000.0\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$, the activation energy $E_a = 65000.0\\,\\mathrm{J\\,mol^{-1}}$, and the acid reaction order $n = 0.5$. The total potential dissolution rate, $r_{\\mathrm{diss}}$, is then obtained by multiplying by the feldspar reactive surface area $A_{\\mathrm{F}}$:\n$$r_{\\mathrm{diss}} = r_{\\mathrm{diss,area}} \\cdot A_{\\mathrm{F}}$$\n\nThe precipitation rate for kaolinite is modeled as a pseudo-first-order process driven by supersaturation:\n$$r_{\\mathrm{precip}} = k_{\\mathrm{precip}}\\,\\max\\!\\left(0,\\,\\dfrac{Q_{\\mathrm{K}}}{K_{\\mathrm{K}}} - 1\\right)\\,A_{\\mathrm{K}}$$\nwhere $k_{\\mathrm{precip}} = 10^{-6}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ is the precipitation rate constant and $A_{\\mathrm{K}}$ is the precipitation surface area.\n\nThe simulation proceeds by stepping through time from $t=0$ to $t=t_{\\mathrm{horizon}}$ with a discrete time step $\\Delta t$. Within each time step, we apply the operator-splitting algorithm:\n\n1.  **Dissolution Step**: First, we calculate the change in moles due to feldspar dissolution. The potential amount of feldspar dissolved in one time step is $\\Delta N_{\\mathrm{F,pot}} = r_{\\mathrm{diss}} \\cdot \\Delta t$. To ensure the inventory does not become negative, this amount is clamped by the available feldspar, $N_{\\mathrm{F}}$. The effective amount dissolved is $\\Delta N_{\\mathrm{F,eff}} = \\min(\\Delta N_{\\mathrm{F,pot}}, N_{\\mathrm{F}})$. The inventories are then updated according to the stoichiometry $\\mathrm{NaAlSi_3O_8} \\rightarrow \\dots + 1\\,\\mathrm{Al} + 3\\,\\mathrm{Si}$:\n    $$N_{\\mathrm{F}} \\leftarrow N_{\\mathrm{F}} - \\Delta N_{\\mathrm{F,eff}}$$\n    $$N_{\\mathrm{Al}} \\leftarrow N_{\\mathrm{Al}} + 1 \\cdot \\Delta N_{\\mathrm{F,eff}}$$\n    $$N_{\\mathrm{Si}} \\leftarrow N_{\\mathrm{Si}} + 3 \\cdot \\Delta N_{\\mathrm{F,eff}}$$\n\n2.  **Precipitation Step**: Next, we calculate the change in moles due to kaolinite precipitation. The potential amount of kaolinite precipitated is $\\Delta N_{\\mathrm{K,pot}} = r_{\\mathrm{precip}} \\cdot \\Delta t$. This precipitation is limited by the stoichiometric availability of the aqueous reactants, Al and Si. According to the reaction which consumes $2$ moles of Al and $2$ moles of Si per mole of kaolinite, the effective amount of kaolinite precipitated is $\\Delta N_{\\mathrm{K,eff}} = \\min(\\Delta N_{\\mathrm{K,pot}}, N_{\\mathrm{Al}}/2, N_{\\mathrm{Si}}/2)$. The inventories are then updated:\n    $$N_{\\mathrm{Kln}} \\leftarrow N_{\\mathrm{Kln}} + \\Delta N_{\\mathrm{K,eff}}$$\n    $$N_{\\mathrm{Al}} \\leftarrow N_{\\mathrm{Al}} - 2 \\cdot \\Delta N_{\\mathrm{K,eff}}$$\n    $$N_{\\mathrm{Si}} \\leftarrow N_{\\mathrm{Si}} - 2 \\cdot \\Delta N_{\\mathrm{K,eff}}$$\n\nThis two-step process is repeated for the total number of time steps, $N_{\\mathrm{steps}} = t_{\\mathrm{horizon}} / \\Delta t$. The final value of $N_{\\mathrm{Kln}}$ at $t=t_{\\mathrm{horizon}}$ is the desired result for each test case. This algorithm correctly interprets the problem's formulation of the effective precipitation rate, $r_{\\mathrm{precip,eff}}$, as part of the numerical scheme. The expression for the moles of kaolinite precipitated in a step, $\\Delta N_{\\mathrm{K,eff}}$, is equivalent to the problem's implicit definition through $r_{\\mathrm{precip,eff}}\\,\\Delta t$, where the inventories $N_{\\mathrm{Al}}$ and $N_{\\mathrm{Si}}$ are those available at the beginning of the precipitation substep.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulations for all test cases and print the results.\n    \"\"\"\n\n    # Universal constants and shared parameters\n    R = 8.314  # J mol^-1 K^-1\n    K0_DISS = 3000.0  # mol m^-2 s^-1\n    EA_DISS = 65000.0  # J mol^-1\n    N_ACID = 0.5\n    K_PRECIP = 1.0e-6  # mol m^-2 s^-1\n\n    test_cases = [\n        # Case A: happy path, dissolves and precipitates\n        {\n            \"N_F0\": 5.0, \"A_F\": 10.0, \"A_K\": 5.0, \"T\": 323.0, \"pH\": 3.0,\n            \"Q_F_K_F\": 0.2, \"Q_K_K_K\": 1.5, \"t_horizon\": 604800.0, \"dt\": 3600.0\n        },\n        # Case B: boundary: zero reactive surface area, no dissolution\n        {\n            \"N_F0\": 1.0, \"A_F\": 0.0, \"A_K\": 5.0, \"T\": 298.0, \"pH\": 3.5,\n            \"Q_F_K_F\": 0.5, \"Q_K_K_K\": 1.2, \"t_horizon\": 86400.0, \"dt\": 3600.0\n        },\n        # Case C: edge: near feldspar saturation, no kaolinite supersaturation\n        {\n            \"N_F0\": 2.0, \"A_F\": 8.0, \"A_K\": 5.0, \"T\": 298.0, \"pH\": 4.0,\n            \"Q_F_K_F\": 0.98, \"Q_K_K_K\": 0.9, \"t_horizon\": 172800.0, \"dt\": 3600.0\n        },\n        # Case D: high temperature and strong acidity, moderate supersaturation\n        {\n            \"N_F0\": 20.0, \"A_F\": 50.0, \"A_K\": 10.0, \"T\": 353.0, \"pH\": 2.5,\n            \"Q_F_K_F\": 0.05, \"Q_K_K_K\": 1.1, \"t_horizon\": 86400.0, \"dt\": 1800.0\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Initialize state variables (moles)\n        N_F = case[\"N_F0\"]\n        N_Al = 0.0\n        N_Si = 0.0\n        N_Kln = 0.0\n\n        # Pre-calculate time-invariant rates (mol/s)\n        \n        # Dissolution rate\n        a_H = 10**(-case[\"pH\"])\n        k_T = K0_DISS * np.exp(-EA_DISS / (R * case[\"T\"]))\n        thermo_diss_term = max(0.0, 1.0 - case[\"Q_F_K_F\"])\n        r_diss = k_T * (a_H**N_ACID) * thermo_diss_term * case[\"A_F\"]\n\n        # Precipitation rate\n        thermo_precip_term = max(0.0, case[\"Q_K_K_K\"] - 1.0)\n        r_precip = K_PRECIP * thermo_precip_term * case[\"A_K\"]\n\n        # Time-stepping loop\n        num_steps = int(case[\"t_horizon\"] / case[\"dt\"])\n        \n        for _ in range(num_steps):\n            # 1. Dissolution Sub-step\n            # Potential moles of feldspar to dissolve in this time step\n            delta_N_F_potential = r_diss * case[\"dt\"]\n            # Effective moles dissolved, clamped by available inventory\n            delta_N_F_effective = min(delta_N_F_potential, N_F)\n            \n            # Update inventories based on dissolution\n            N_F -= delta_N_F_effective\n            # Stoichiometry: 1 Al, 3 Si per mole of feldspar\n            N_Al += 1.0 * delta_N_F_effective\n            N_Si += 3.0 * delta_N_F_effective\n\n            # 2. Precipitation Sub-step\n            # Potential moles of kaolinite to precipitate\n            delta_N_K_potential = r_precip * case[\"dt\"]\n            \n            # Effective moles precipitated, limited by reactant availability\n            # Stoichiometry: 2 Al, 2 Si per mole of kaolinite\n            if N_Al > 0 and N_Si > 0:\n                delta_N_K_effective = min(delta_N_K_potential, N_Al / 2.0, N_Si / 2.0)\n            else:\n                delta_N_K_effective = 0.0\n\n            # Update inventories based on precipitation\n            N_Kln += delta_N_K_effective\n            N_Al -= 2.0 * delta_N_K_effective\n            N_Si -= 2.0 * delta_N_K_effective\n\n            # Safety clamp to prevent negative values due to floating point error\n            N_F = max(0.0, N_F)\n            N_Al = max(0.0, N_Al)\n            N_Si = max(0.0, N_Si)\n\n        results.append(N_Kln)\n\n    # Format the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Robust monitoring is essential for verifying the containment of stored CO2 and ensuring public confidence in CCUS projects. This hands-on exercise addresses this by modeling the transport of a potential CO2 leak from a deep storage formation toward the surface . By numerically solving the transient diffusion equation in the vadose zone, you will quantify the sensitivity of surface and near-surface sensors to a subsurface leak, a critical step in designing effective monitoring, verification, and accounting (MVA) strategies that can detect anomalies in a timely manner.",
            "id": "4076105",
            "problem": "A monitoring program for Carbon Capture, Utilization, and Storage (CCUS) aims to evaluate the sensitivity of surface carbon dioxide (CO$_2$) flux measurements to subsurface leakage using a one-dimensional diffusion model in the vadose zone and to compute expected concentration changes at subsurface sensors. Starting from first principles, use the diffusion of a passive scalar in a porous medium along depth to model transient transport of CO$_2$ in gas-filled pores. The fundamental base is Fick’s second law of diffusion in one spatial dimension with a source term, stated as follows: $$\\frac{\\partial C(z,t)}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(D \\frac{\\partial C(z,t)}{\\partial z}\\right) + s(z,t),$$ where $C(z,t)$ is the molar concentration in $\\mathrm{mol/m^3}$, $D$ is the effective diffusion coefficient in $\\mathrm{m^2/s}$ (assumed constant in space and time for this problem), and $s(z,t)$ is a volumetric source term in $\\mathrm{mol/(m^3\\,s)}$. The domain is semi-infinite in principle, but for computation use a finite depth $z \\in [0,L]$ with a Dirichlet boundary at the surface and a Neumann boundary at depth: $$C(0,t) = C_{\\mathrm{atm}}, \\quad \\frac{\\partial C(L,t)}{\\partial z} = 0.$$ The initial condition is a uniform background concentration: $$C(z,0) = C_{\\mathrm{bg}}.$$\n\nModel subsurface leakage at a depth $z_0$ as an areal molar flux $F_{\\mathrm{leak}}$ in $\\mathrm{mol/(m^2\\,s)}$ injected into the pore space across a thin layer at $z=z_0$. For numerical implementation on a uniform grid with spacing $\\Delta z$, approximate this as a volumetric source within the grid cell containing $z_0$ with magnitude $$s(z,t) = \\frac{F_{\\mathrm{leak}}}{\\Delta z}$$ during the leakage interval $0 \\le t \\le T_{\\mathrm{leak}}$, and $s(z,t)=0$ otherwise. Assume $C_{\\mathrm{atm}} = C_{\\mathrm{bg}}$ for this problem.\n\nDefine the measurable surface diffusive efflux using Fick’s first law: $$J(0,t) = -D \\left.\\frac{\\partial C}{\\partial z}\\right|_{z=0},$$ which has units of $\\mathrm{mol/(m^2\\,s)}$. The sensitivity of the surface flux measurement to the subsurface leakage is defined as the dimensionless ratio $$S = \\frac{J(0,T)}{F_{\\mathrm{leak}}},$$ evaluated at a specified final time $T$. Additionally, for a given set of sensor depths $\\{z_s\\}$, compute the expected change in concentration relative to background at those depths at time $T$, $$\\Delta C(z_s,T) = C(z_s,T) - C_{\\mathrm{bg}}.$$ All outputs must be expressed in the stated physical units, with times in $\\mathrm{s}$, depths in $\\mathrm{m}$, diffusion coefficients in $\\mathrm{m^2/s}$, molar concentrations in $\\mathrm{mol/m^3}$, and fluxes in $\\mathrm{mol/(m^2\\,s)}$.\n\nAlgorithmic requirements:\n- Discretize the governing equation in $z$ on a uniform grid with spacing $\\Delta z$ and integrate in time using an unconditionally stable implicit method derived from Fick’s laws and the stated boundary conditions. Ensure correct implementation of the Dirichlet boundary at $z=0$ and the Neumann boundary at $z=L$.\n- Represent the leakage source as specified and superimposed on the baseline.\n- Compute $J(0,T)$ from the discrete concentration gradient at the surface and evaluate the sensitivity $S$ as defined above.\n- Compute $\\Delta C(z_s,T)$ at each sensor depth using appropriate interpolation from the grid if needed.\n\nTest suite:\nUse the following parameter sets to evaluate the program. In each case, report one sensitivity followed by all sensor concentration changes, in the order specified.\n\n- Case $1$ (general \"happy path\"):\n  - $L = 5.0\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$,\n  - $D = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$,\n  - $T = 86400\\,\\mathrm{s}$, $\\Delta t = 120\\,\\mathrm{s}$,\n  - $z_0 = 2.0\\,\\mathrm{m}$,\n  - $F_{\\mathrm{leak}} = 1.0\\times 10^{-5}\\,\\mathrm{mol/(m^2\\,s)}$,\n  - $T_{\\mathrm{leak}} = 86400\\,\\mathrm{s}$,\n  - $C_{\\mathrm{bg}} = 1.6\\times 10^{-2}\\,\\mathrm{mol/m^3}$,\n  - Sensor depths $\\{z_s\\} = [0.1\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 2.0\\,\\mathrm{m}, 4.0\\,\\mathrm{m}]$.\n\n- Case $2$ (boundary case: very shallow leak, short horizon):\n  - $L = 5.0\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$,\n  - $D = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$,\n  - $T = 10000\\,\\mathrm{s}$, $\\Delta t = 60\\,\\mathrm{s}$,\n  - $z_0 = 0.1\\,\\mathrm{m}$,\n  - $F_{\\mathrm{leak}} = 1.0\\times 10^{-5}\\,\\mathrm{mol/(m^2\\,s)}$,\n  - $T_{\\mathrm{leak}} = 10000\\,\\mathrm{s}$,\n  - $C_{\\mathrm{bg}} = 1.6\\times 10^{-2}\\,\\mathrm{mol/m^3}$,\n  - Sensor depths $\\{z_s\\} = [0.1\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 2.0\\,\\mathrm{m}, 4.0\\,\\mathrm{m}]$.\n\n- Case $3$ (edge case: deep leak, low diffusivity):\n  - $L = 5.0\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$,\n  - $D = 1.0\\times 10^{-7}\\,\\mathrm{m^2/s}$,\n  - $T = 50000\\,\\mathrm{s}$, $\\Delta t = 100\\,\\mathrm{s}$,\n  - $z_0 = 4.0\\,\\mathrm{m}$,\n  - $F_{\\mathrm{leak}} = 1.0\\times 10^{-5}\\,\\mathrm{mol/(m^2\\,s)}$,\n  - $T_{\\mathrm{leak}} = 50000\\,\\mathrm{s}$,\n  - $C_{\\mathrm{bg}} = 1.6\\times 10^{-2}\\,\\mathrm{mol/m^3}$,\n  - Sensor depths $\\{z_s\\} = [0.1\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 2.0\\,\\mathrm{m}, 4.0\\,\\mathrm{m}]$.\n\n- Case $4$ (transient leak: short-duration injection, longer horizon):\n  - $L = 5.0\\,\\mathrm{m}$, $\\Delta z = 0.01\\,\\mathrm{m}$,\n  - $D = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$,\n  - $T = 86400\\,\\mathrm{s}$, $\\Delta t = 120\\,\\mathrm{s}$,\n  - $z_0 = 3.0\\,\\mathrm{m}$,\n  - $F_{\\mathrm{leak}} = 1.0\\times 10^{-5}\\,\\mathrm{mol/(m^2\\,s)}$,\n  - $T_{\\mathrm{leak}} = 3600\\,\\mathrm{s}$,\n  - $C_{\\mathrm{bg}} = 1.6\\times 10^{-2}\\,\\mathrm{mol/m^3}$,\n  - Sensor depths $\\{z_s\\} = [0.1\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 2.0\\,\\mathrm{m}, 4.0\\,\\mathrm{m}]$.\n\nAnswer specification and final output format:\n- For each case, compute $S$ and the list $[\\Delta C(z_{s,1},T), \\Delta C(z_{s,2},T), \\dots]$ in $\\mathrm{mol/m^3}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, with each inner list ordered as $[S, \\Delta C(z_{s,1},T), \\Delta C(z_{s,2},T), \\dots]$. For example: $$[[S_1,\\Delta C_{1,1},\\dots],[S_2,\\Delta C_{2,1},\\dots],\\dots].$$",
            "solution": "The user wants to solve a one-dimensional transient diffusion problem with a source term to model carbon dioxide leakage and compute measurable quantities.\n\n### **1. Problem Statement Formalization**\n\nThe governing partial differential equation (PDE) for the molar concentration $C(z,t)$ in $\\mathrm{mol/m^3}$ as a function of depth $z$ and time $t$ is Fick's second law with a source term:\n$$\n\\frac{\\partial C(z,t)}{\\partial t} = D \\frac{\\partial^2 C(z,t)}{\\partial z^2} + s(z,t)\n$$\nwhere $D$ is the constant effective diffusion coefficient in $\\mathrm{m^2/s}$ and $s(z,t)$ is the volumetric source term in $\\mathrm{mol/(m^3 \\cdot s)}$.\n\nThe domain is $z \\in [0,L]$ with the following initial and boundary conditions:\n- Initial Condition: $C(z,0) = C_{\\mathrm{bg}}$\n- Boundary Condition at $z=0$ (surface): $C(0,t) = C_{\\mathrm{atm}}$\n- Boundary Condition at $z=L$ (deep boundary): $\\frac{\\partial C(L,t)}{\\partial z} = 0$\n\nThe problem specifies that the atmospheric concentration equals the background concentration, $C_{\\mathrm{atm}} = C_{\\mathrm{bg}}$.\n\nTo simplify the problem numerically, we define the concentration change relative to the background, $\\Delta C(z,t) = C(z,t) - C_{\\mathrm{bg}}$. Since $C_{\\mathrm{bg}}$ is a constant, the derivatives are $\\frac{\\partial \\Delta C}{\\partial t} = \\frac{\\partial C}{\\partial t}$ and $\\frac{\\partial \\Delta C}{\\partial z} = \\frac{\\partial C}{\\partial z}$. Substituting into the governing equation and boundary/initial conditions yields a transformed problem for $\\Delta C$:\n- PDE: $\\frac{\\partial \\Delta C(z,t)}{\\partial t} = D \\frac{\\partial^2 \\Delta C(z,t)}{\\partial z^2} + s(z,t)$\n- Initial Condition: $\\Delta C(z,0) = C(z,0) - C_{\\mathrm{bg}} = C_{\\mathrm{bg}} - C_{\\mathrm{bg}} = 0$\n- Boundary Condition at $z=0$: $\\Delta C(0,t) = C(0,t) - C_{\\mathrm{bg}} = C_{\\mathrm{atm}} - C_{\\mathrm{bg}} = 0$\n- Boundary Condition at $z=L$: $\\frac{\\partial \\Delta C(L,t)}{\\partial z} = 0$\n\nThis transformed problem is more convenient as it has homogeneous initial and Dirichlet boundary conditions.\n\n### **2. Numerical Discretization**\n\nWe will solve the transformed problem using the Finite Difference Method. The spatial domain $z \\in [0,L]$ is discretized into a uniform grid with $N_z$ points, such that $z_i = i \\cdot \\Delta z$ for $i=0, 1, \\dots, N_z-1$, where the total number of points is $N_z = L/\\Delta z + 1$. The time domain is discretized with a constant step size $\\Delta t$, such that $t_n = n \\cdot \\Delta t$. Let $u_i^n \\approx \\Delta C(z_i, t_n)$.\n\n**Time Discretization:** We use the implicit (backward) Euler method, which is unconditionally stable:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = D \\left(\\frac{\\partial^2 \\Delta C}{\\partial z^2}\\right)\\bigg|_{i}^{n+1} + s_i^{n+1}\n$$\n\n**Spatial Discretization:** We use a second-order central difference scheme for the spatial derivative:\n$$\n\\left(\\frac{\\partial^2 \\Delta C}{\\partial z^2}\\right)\\bigg|_{i}^{n+1} \\approx \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{(\\Delta z)^2}\n$$\n\nCombining these for an interior grid node ($i = 1, \\dots, N_z-2$), we get:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = D \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{(\\Delta z)^2} + s_i^{n+1}\n$$\nRearranging to group terms at time step $n+1$ on the left-hand side:\n$$\n- \\frac{D \\Delta t}{(\\Delta z)^2} u_{i-1}^{n+1} + \\left(1 + 2\\frac{D \\Delta t}{(\\Delta z)^2}\\right) u_i^{n+1} - \\frac{D \\Delta t}{(\\Delta z)^2} u_{i+1}^{n+1} = u_i^n + \\Delta t \\, s_i^{n+1}\n$$\nDefining the dimensionless diffusion number $\\alpha = \\frac{D \\Delta t}{(\\Delta z)^2}$, the equation becomes:\n$$\n-\\alpha u_{i-1}^{n+1} + (1 + 2\\alpha) u_i^{n+1} - \\alpha u_{i+1}^{n+1} = u_i^n + \\Delta t \\, s_i^{n+1}\n$$\n\n### **3. Boundary Conditions Implementation**\n\nThe system of equations involves the unknown concentrations $u_i^{n+1}$ for $i=1, \\dots, N_z-1$. The value $u_0^{n+1}$ is known from the boundary condition.\n\n- **Surface ($z=0$, $i=0$):** The Dirichlet condition is $u_0^{n+1} = \\Delta C(0, t_{n+1}) = 0$. This value is known and fixed for all time steps.\n\n- **Deep Boundary ($z=L$, $i=N_z-1$):** The Neumann condition is $\\frac{\\partial \\Delta C}{\\partial z} = 0$. To maintain second-order accuracy, we employ a \"ghost point\" at $z_{N_z} = L + \\Delta z$. The centered difference approximation for the derivative at $z_{N_z-1}=L$ is:\n$$\n\\frac{u_{N_z}^{n+1} - u_{N_z-2}^{n+1}}{2 \\Delta z} = 0 \\implies u_{N_z}^{n+1} = u_{N_z-2}^{n+1}\n$$\nNow, we write the discretized PDE at the boundary node $i=N_z-1$:\n$$\n-\\alpha u_{N_z-2}^{n+1} + (1 + 2\\alpha) u_{N_z-1}^{n+1} - \\alpha u_{N_z}^{n+1} = u_{N_z-1}^n + \\Delta t \\, s_{N_z-1}^{n+1}\n$$\nSubstituting the ghost point condition $u_{N_z}^{n+1} = u_{N_z-2}^{n+1}$:\n$$\n-2\\alpha u_{N_z-2}^{n+1} + (1 + 2\\alpha) u_{N_z-1}^{n+1} = u_{N_z-1}^n + \\Delta t \\, s_{N_z-1}^{n+1}\n$$\n\n### **4. Linear System Formulation**\n\nThe set of equations for the unknown vector $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\dots, u_{N_z-1}^{n+1}]^T$ forms a linear system $\\mathbf{A}\\mathbf{u}^{n+1} = \\mathbf{b}$. The matrix $\\mathbf{A}$ is a tridiagonal matrix of size $(N_z-1) \\times (N_z-1)$ and is constant in time:\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1+2\\alpha & -\\alpha & 0 & \\dots & 0 \\\\\n-\\alpha & 1+2\\alpha & -\\alpha & \\dots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & \\vdots \\\\\n0 & \\dots & -\\alpha & 1+2\\alpha & -\\alpha \\\\\n0 & \\dots & 0 & -2\\alpha & 1+2\\alpha\n\\end{pmatrix}\n$$\nThe right-hand side vector $\\mathbf{b}$ depends on the solution at the previous time step $\\mathbf{u}^n$ and the source term:\n- For $i=1$: $b_1 = u_1^n + \\Delta t \\, s_1^{n+1} + \\alpha u_0^{n+1} = u_1^n + \\Delta t \\, s_1^{n+1}$ (since $u_0=0$).\n- For $1 < i < N_z-1$: $b_i = u_i^n + \\Delta t \\, s_i^{n+1}$.\n- For $i=N_z-1$: $b_{N_z-1} = u_{N_z-1}^n + \\Delta t \\, s_{N_z-1}^{n+1}$.\n\n### **5. Source Term and Output Calculation**\n\n- **Source Term:** The leakage flux $F_{\\mathrm{leak}}$ at depth $z_0$ is modeled as a volumetric source $s = F_{\\mathrm{leak}} / \\Delta z$ within the grid cell containing $z_0$. Let $i_0 = \\text{round}(z_0 / \\Delta z)$. The source vector $\\mathbf{s}^{n+1}$ has one non-zero element, $s_{i_0}^{n+1} = F_{\\mathrm{leak}}/\\Delta z$, if $t_{n+1} \\le T_{\\mathrm{leak}}$, and is zero otherwise.\n\n- **Surface Flux $J(0,T)$:** The surface efflux is given by Fick's first law. We evaluate it at the final time $T$ using the solution for $\\Delta C$. A first-order forward difference approximation is used for the gradient at $z=0$:\n$$\nJ(0,T) = -D \\left.\\frac{\\partial C}{\\partial z}\\right|_{z=0,t=T} = -D \\left.\\frac{\\partial \\Delta C}{\\partial z}\\right|_{z=0,t=T} \\approx -D \\frac{u_1^N - u_0^N}{\\Delta z} = -D \\frac{u_1^N}{\\Delta z}\n$$\nwhere $N$ is the final time step index.\n\n- **Sensitivity $S$:** The sensitivity is calculated as the dimensionless ratio:\n$$\nS = \\frac{J(0,T)}{F_{\\mathrm{leak}}}\n$$\n\n- **Concentration Change $\\Delta C(z_s,T)$:** For each sensor at depth $z_s$, we find the value $\\Delta C(z_s,T)$ from the final concentration profile $u_i^N$. If $z_s$ does not coincide with a grid point, linear interpolation is used. For a given $z_s$, we find the lower grid index $i = \\lfloor z_s / \\Delta z \\rfloor$ and the fractional distance $\\phi = (z_s/\\Delta z) - i$. The interpolated value is:\n$$\n\\Delta C(z_s,T) \\approx u_i^N (1 - \\phi) + u_{i+1}^N \\phi\n$$\nSince the problem is solved directly for $\\Delta C$, this interpolated value is the final required quantity.\n\nThe overall algorithm consists of initializing $\\mathbf{u}^0 = \\mathbf{0}$, constructing the time-independent matrix $\\mathbf{A}$, and then iterating through time steps. In each step, the right-hand side vector $\\mathbf{b}$ is assembled and the computationally efficient `scipy.linalg.solve_banded` is used to solve the tridiagonal system for $\\mathbf{u}^{n+1}$. Finally, the required outputs are computed from the final concentration profile $\\mathbf{u}^N$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef run_simulation(L, delta_z, D, T, delta_t, z0, F_leak, T_leak, C_bg, sensor_depths):\n    \"\"\"\n    Solves the 1D diffusion equation for CCUS leakage monitoring.\n\n    The function solves for delta_C = C - C_bg.\n    PDE: d(delta_C)/dt = D * d^2(delta_C)/dz^2 + s(z,t)\n    IC: delta_C(z,0) = 0\n    BC: delta_C(0,t) = 0 (Dirichlet), d(delta_C)/dz(L,t) = 0 (Neumann)\n    \"\"\"\n\n    # 1. Grid and Time Setup\n    Nz = int(round(L / delta_z)) + 1\n    z_nodes = np.linspace(0, L, Nz)\n    \n    time_steps = np.arange(0, T + delta_t, delta_t)\n    Nt = len(time_steps) - 1\n\n    # Number of internal nodes (unknowns)\n    M = Nz - 1\n\n    # 2. Discretization Parameters and Initialization\n    # Dimensionless diffusion number (alpha)\n    alpha = D * delta_t / (delta_z ** 2)\n    \n    # Initialize concentration change vector delta_C (u)\n    # The full vector includes the boundary at z=0\n    u_full = np.zeros(Nz)\n    \n    # Internal nodes vector (the unknowns we solve for)\n    u_internal = u_full[1:]\n\n    # 3. Construct the Tridiagonal Matrix A\n    # A is of size M x M, for unknowns u_1 to u_{Nz-1}\n    # Using scipy.linalg.solve_banded which requires bands format\n    # ab has shape (3, M), for l=1, u=1\n    ab = np.zeros((3, M))\n    # Main diagonal (b_i)\n    ab[1, :] = 1 + 2 * alpha\n    # Upper diagonal (c_i)\n    ab[0, 1:] = -alpha\n    # Lower diagonal (a_i)\n    ab[2, :-1] = -alpha\n    # Modify for Neumann boundary at z=L (i=Nz-1)\n    # Equation: -2*alpha*u_{M-2} + (1+2*alpha)*u_{M-1} = ...\n    # This affects the last element of the lower diagonal\n    ab[2, M - 2] = -2 * alpha\n\n    # 4. Source Term Setup\n    s_vec = np.zeros(Nz)\n    i0 = int(round(z0 / delta_z))\n    if i0 > 0 and i0  Nz:\n        volumetric_source = F_leak / delta_z\n        s_vec[i0] = volumetric_source\n\n    s_internal = s_vec[1:] # Source term for internal nodes\n\n    # 5. Time Stepping Loop\n    for n in range(Nt):\n        current_time = (n + 1) * delta_t\n\n        # Right-hand side vector b\n        b = u_internal.copy()\n        \n        # Add source term if leakage is active\n        if current_time = T_leak:\n            b += delta_t * s_internal\n        \n        # The Dirichlet BC u_0 = 0 means no term is added from the z=0 boundary\n        \n        # Solve the linear system A * u_new = b\n        u_internal = solve_banded((1, 1), ab, b)\n    \n    # Final concentration profile (full array)\n    u_final_full = np.zeros(Nz)\n    u_final_full[1:] = u_internal\n    \n    # 6. Calculate Output Quantities\n    \n    # Surface diffusive efflux J(0,T)\n    # J = -D * d(delta_C)/dz at z=0\n    # Using first-order forward difference: (u_1 - u_0) / delta_z\n    J_surface = -D * (u_final_full[1] - u_final_full[0]) / delta_z\n\n    # Sensitivity S\n    S = J_surface / F_leak if F_leak != 0 else 0.0\n\n    # Concentration change at sensor depths\n    delta_C_sensors = []\n    for zs in sensor_depths:\n        # Using linear interpolation\n        idx_float = zs / delta_z\n        idx_floor = int(idx_float)\n        frac = idx_float - idx_floor\n        \n        if idx_floor + 1  Nz:\n            val = u_final_full[idx_floor] * (1 - frac) + u_final_full[idx_floor + 1] * frac\n        else: # On the last node\n            val = u_final_full[idx_floor]\n        delta_C_sensors.append(val)\n\n    return [S] + delta_C_sensors\n\ndef solve():\n    test_cases = [\n        {\n            \"L\": 5.0, \"delta_z\": 0.01,\n            \"D\": 1.0e-6,\n            \"T\": 86400, \"delta_t\": 120,\n            \"z0\": 2.0,\n            \"F_leak\": 1.0e-5,\n            \"T_leak\": 86400,\n            \"C_bg\": 1.6e-2,\n            \"sensor_depths\": [0.1, 0.5, 1.0, 2.0, 4.0]\n        },\n        {\n            \"L\": 5.0, \"delta_z\": 0.01,\n            \"D\": 1.0e-6,\n            \"T\": 10000, \"delta_t\": 60,\n            \"z0\": 0.1,\n            \"F_leak\": 1.0e-5,\n            \"T_leak\": 10000,\n            \"C_bg\": 1.6e-2,\n            \"sensor_depths\": [0.1, 0.5, 1.0, 2.0, 4.0]\n        },\n        {\n            \"L\": 5.0, \"delta_z\": 0.01,\n            \"D\": 1.0e-7,\n            \"T\": 50000, \"delta_t\": 100,\n            \"z0\": 4.0,\n            \"F_leak\": 1.0e-5,\n            \"T_leak\": 50000,\n            \"C_bg\": 1.6e-2,\n            \"sensor_depths\": [0.1, 0.5, 1.0, 2.0, 4.0]\n        },\n        {\n            \"L\": 5.0, \"delta_z\": 0.01,\n            \"D\": 1.0e-6,\n            \"T\": 86400, \"delta_t\": 120,\n            \"z0\": 3.0,\n            \"F_leak\": 1.0e-5,\n            \"T_leak\": 3600,\n            \"C_bg\": 1.6e-2,\n            \"sensor_depths\": [0.1, 0.5, 1.0, 2.0, 4.0]\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = run_simulation(**params)\n        all_results.append(result)\n    \n    # Format the final output as a string representation of a list of lists\n    # e.g., [[S1, dC1_1, dC1_2], [S2, dC2_1, dC2_2]]\n    output_str = \"[\" + \",\".join(\n        \"[\" + \",\".join(f\"{val:.6e}\" for val in res) + \"]\"\n        for res in all_results\n    ) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}