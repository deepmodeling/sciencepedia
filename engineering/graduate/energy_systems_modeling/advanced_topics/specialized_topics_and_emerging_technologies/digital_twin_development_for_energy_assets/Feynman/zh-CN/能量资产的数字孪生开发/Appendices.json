{
    "hands_on_practices": [
        {
            "introduction": "数字孪生依赖于来自传感器的准确实时数据。当多个传感器测量同一物理量时，我们可以融合它们的读数，以获得比任何单个传感器都更精确、更可靠的估计值。此练习将探索最佳线性无偏估计 (Best Linear Unbiased Estimator, BLUE)，这是一种数据融合中的基础技术。通过从第一性原理推导最优权重，您将深入理解如何智能地融合传感器数据，这是任何数据驱动建模或数字孪生应用中的关键第一步。",
            "id": "4084247",
            "problem": "能源管道资产的数字孪生通过在每个同化步骤中同化冗余传感器数据，来维持一个基于物理的内部压力估计。在给定的时间戳，该数字孪生从3个经过校准的冗余静压传感器接收同步读数，这些传感器被假定测量的是同一个真实管道压力 $p^{\\ast}$。每个传感器被建模为一个受到独立的、零均值、具有已知方差的高斯噪声干扰的无偏测量。设测量模型为 $y_{i} = p^{\\ast} + \\varepsilon_{i}$，其中 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ 且 $\\varepsilon_{i}$ 在各传感器之间是独立的。数字孪生寻求一个线性的融合估计 $\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}$，该估计是无偏的且具有最小方差。\n\n从无偏性和方差的定义出发，且不援引任何预先推导的估计器公式，利用拉格朗日乘数法建立并求解约束优化问题，以确定最优的融合权重。明确推导出以已知方差表示的最优权重的一般表达式。\n\n然后，使用以下传感器数据和已知方差，计算融合后的压力估计值：\n- 传感器读数：$y_{1} = 102.3$ kPa, $y_{2} = 101.9$ kPa, $y_{3} = 103.1$ kPa。\n- 噪声方差：$\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$, $\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$, $\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$。\n\n以 kPa 为单位表示最终的融合压力，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "该问题陈述是适定的，有科学依据，并包含了推导出唯一解所需的所有信息。这是一个估计理论中的标准问题，具体而言，是从具有已知噪声特性的多次测量中寻找一个常数参数的最佳线性无偏估计器 (BLUE)。我们将开始推导。\n\n问题要求一个真实压力 $p^{\\ast}$ 的线性融合估计，其形式为：\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}\n$$\n其中 $y_i$ 是传感器测量值，$w_i$ 是待定权重。每个传感器的测量模型由 $y_{i} = p^{\\ast} + \\varepsilon_{i}$ 给出，其中噪声项 $\\varepsilon_{i}$ 是独立的，并且服从均值为零、方差为 $\\sigma_{i}^{2}$ 的正态分布，即 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma_{i}^{2})$。\n\n估计值 $\\hat{p}$ 必须满足两个条件：它必须是无偏的，并且具有最小方差。\n\n首先，我们将无偏性约束形式化。如果一个估计器的期望值等于被估计参数的真实值，那么该估计器就是无偏的。在这里，我们要求 $E[\\hat{p}] = p^{\\ast}$。\n$$\nE[\\hat{p}] = E\\left[\\sum_{i=1}^{3} w_{i} y_{i}\\right]\n$$\n根据期望算子的线性性质：\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} E[y_{i}]\n$$\n每个测量值的期望值为：\n$$\nE[y_{i}] = E[p^{\\ast} + \\varepsilon_{i}] = E[p^{\\ast}] + E[\\varepsilon_{i}]\n$$\n由于 $p^{\\ast}$ 是一个常数（在给定时间点的真实压力），所以 $E[p^{\\ast}] = p^{\\ast}$。噪声项 $\\varepsilon_{i}$ 的均值为零，所以 $E[\\varepsilon_{i}] = 0$。因此，$E[y_{i}] = p^{\\ast}$。\n将此代回到 $E[\\hat{p}]$ 的表达式中：\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} p^{\\ast} = p^{\\ast} \\sum_{i=1}^{3} w_{i}\n$$\n为了使无偏条件 $E[\\hat{p}] = p^{\\ast}$ 对任何非零的 $p^{\\ast}$ 都成立，我们必须有：\n$$\n\\sum_{i=1}^{3} w_{i} = 1\n$$\n这是我们优化问题的约束条件。\n\n接下来，我们构建目标函数，即待最小化的估计器 $\\hat{p}$ 的方差。\n$$\n\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\sum_{i=1}^{3} w_{i} y_{i}\\right)\n$$\n由于噪声项 $\\varepsilon_{i}$ 是独立的，所以测量值 $y_{i}$ 也是独立的。对于独立的随机变量，其加权和的方差为：\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} \\text{Var}(w_{i} y_{i})\n$$\n使用方差性质 $\\text{Var}(aX) = a^2 \\text{Var}(X)$：\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\text{Var}(y_{i})\n$$\n单个测量值的方差为：\n$$\n\\text{Var}(y_{i}) = \\text{Var}(p^{\\ast} + \\varepsilon_{i}) = \\text{Var}(\\varepsilon_{i}) = \\sigma_{i}^{2}\n$$\n因为加上一个常数（$p^{\\ast}$）不会改变方差。\n因此，待最小化的目标函数是：\n$$\nf(w_1, w_2, w_3) = \\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}\n$$\n\n问题现在是一个约束优化问题：在约束条件 $g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i} - 1 = 0$ 下，最小化 $f(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}$。我们使用拉格朗日乘数法。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(w_1, w_2, w_3, \\lambda) = f(w_1, w_2, w_3) - \\lambda g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2} - \\lambda \\left(\\sum_{i=1}^{3} w_{i} - 1\\right)\n$$\n为了找到最小值，我们将 $\\mathcal{L}$ 对每个 $w_i$ 和 $\\lambda$ 的偏导数设为零。对于每个 $i \\in \\{1, 2, 3\\}$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{i}} = 2 w_{i} \\sigma_{i}^{2} - \\lambda = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{i=1}^{3} w_{i} - 1\\right) = 0\n$$\n从第一组方程中，我们解出以 $\\lambda$ 表示的 $w_i$：\n$$\nw_{i} = \\frac{\\lambda}{2\\sigma_{i}^{2}}\n$$\n这表明每个传感器的最优权重与其方差成反比，这在直观上是正确的。现在，我们将 $w_i$ 的这个表达式代入约束方程：\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda}{2\\sigma_{i}^{2}} = 1\n$$\n提出常数项：\n$$\n\\frac{\\lambda}{2} \\sum_{i=1}^{3} \\frac{1}{\\sigma_{i}^{2}} = 1\n$$\n解出拉格朗日乘数 $\\lambda$：\n$$\n\\lambda = \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n最后，我们将 $\\lambda$ 代回到 $w_i$ 的表达式中，以找到最优权重的一般公式：\n$$\nw_{i} = \\frac{1}{2\\sigma_{i}^{2}} \\left( \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}} \\right) = \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n这就是最优融合权重的一般表达式。\n\n现在，我们将此结果应用于给定数据：\n- 传感器读数：$y_{1} = 102.3$ kPa, $y_{2} = 101.9$ kPa, $y_{3} = 103.1$ kPa。\n- 噪声方差：$\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$, $\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$, $\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$。\n\n首先，我们计算方差的倒数及其和。令 $S = \\sum_{j=1}^{3} 1/\\sigma_{j}^{2}$。\n$$\n\\frac{1}{\\sigma_{1}^{2}} = \\frac{1}{1.0} = 1.0\n$$\n$$\n\\frac{1}{\\sigma_{2}^{2}} = \\frac{1}{4.0} = 0.25\n$$\n$$\n\\frac{1}{\\sigma_{3}^{2}} = \\frac{1}{9.0}\n$$\n和为：\n$$\nS = 1.0 + 0.25 + \\frac{1}{9} = \\frac{5}{4} + \\frac{1}{9} = \\frac{45 + 4}{36} = \\frac{49}{36}\n$$\n现在，我们计算最优权重 $w_i = (1/\\sigma_i^2)/S$：\n$$\nw_{1} = \\frac{1.0}{49/36} = \\frac{36}{49}\n$$\n$$\nw_{2} = \\frac{0.25}{49/36} = \\frac{1/4}{49/36} = \\frac{1}{4} \\cdot \\frac{36}{49} = \\frac{9}{49}\n$$\n$$\nw_{3} = \\frac{1/9}{49/36} = \\frac{1}{9} \\cdot \\frac{36}{49} = \\frac{4}{49}\n$$\n作为检验，权重之和为1：$w_1+w_2+w_3 = \\frac{36+9+4}{49} = \\frac{49}{49} = 1$。\n\n最后，我们计算融合压力估计值 $\\hat{p}$：\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i} = w_{1}y_{1} + w_{2}y_{2} + w_{3}y_{3}\n$$\n$$\n\\hat{p} = \\left(\\frac{36}{49}\\right)(102.3) + \\left(\\frac{9}{49}\\right)(101.9) + \\left(\\frac{4}{49}\\right)(103.1)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 36 \\times 102.3 + 9 \\times 101.9 + 4 \\times 103.1 \\right)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 3682.8 + 917.1 + 412.4 \\right)\n$$\n$$\n\\hat{p} = \\frac{5012.3}{49} \\approx 102.2918367...\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$2$、$2$。第五位数字是 $9$，所以我们将第四位数字向上取整。\n$$\n\\hat{p} \\approx 102.3 \\text{ kPa}\n$$",
            "answer": "$$\n\\boxed{102.3}\n$$"
        },
        {
            "introduction": "一个有效的数字孪生不仅要能复现资产的行为，还必须遵循基本的物理定律。对于换热器这样的热力学系统，这既包括热力学第一定律，也包括第二定律。本练习要求您推导能量损失率和㶲损率，后者代表了过程的不可逆性。通过这个实践，您将学会如何制定超越简单温度匹配的、具有物理意义的校准目标，确保您的数字孪生模型能同时捕捉能量平衡和过程效率，这对于性能优化至关重要。",
            "id": "4084186",
            "problem": "一个热电联产（CHP）厂中的管壳式换热器的数字孪生（DT）必须被校准，以在实际损失下同时匹配能量传递和不可逆性。考虑一个具有热油流和冷水流的稳态逆流换热器。环境参考温度为 $T_{0} = 300\\,\\mathrm{K}$。热流的质量流率为 $m_{h} = 5\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$，定压比热为 $c_{p,h} = 2.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，入口温度为 $T_{h,i} = 450\\,\\mathrm{K}$，出口温度为 $T_{h,o} = 400\\,\\mathrm{K}$。冷流的质量流率为 $m_{c} = 3\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$，定压比热为 $c_{p,c} = 4.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，入口温度为 $T_{c,i} = 300\\,\\mathrm{K}$，出口温度为 $T_{c,o} = 330\\,\\mathrm{K}$。假设动能和势能的变化可忽略不计，压降也可忽略不计。将两种流体均视为具有恒定比热的不可压缩流体。\n\n仅从稳流控制体的热力学第一定律和稳流熵平衡方程出发，并使用显焓变的核心定义 $h \\approx c_{p} T$ 和具有恒定 $c_{p}$ 的不可压缩流体的比熵变 $\\Delta s \\approx c_{p} \\ln\\!\\left(\\frac{T_{2}}{T_{1}}\\right)$，执行以下操作：\n\n1. 推导换热器的稳态能量平衡方程，该方程明确包含一个向温度为 $T_{0}$ 的环境的热损失项 $Q_{\\mathrm{loss}}$，并用给定的质量流率、比热和流体温度来表示。\n2. 根据热流和冷流的熵变以及向温度为 $T_{0}$ 的环境的热传递，推导换热器的稳态熵产率 $\\dot{S}_{\\mathrm{gen}}$。\n3. 使用 Gouy–Stodola 关系，根据上述量推导㶲损失率 $\\dot{E}_{d}$ 的闭式表达式。\n4. 对给定数据进行数值计算，得出一个单一的标量校准目标，数字孪生可用该目标来调整其损失和污垢参数。这个标量目标就是㶲损失率 $\\dot{E}_{d}$。\n\n将最终数值答案四舍五入到四位有效数字。以 $\\mathrm{kW}$ 为单位表示最终的㶲损失率。",
            "solution": "基础出发点是稳流控制体的热力学第一定律和稳流熵平衡方程，以及经过充分检验的、用于具有恒定比热的不可压缩流体的显焓变和熵变的表达式。\n\n首先，为包含整个换热器的控制体写出稳态能量平衡方程。在没有轴功且动能和势能变化可忽略不计的情况下，能量平衡表明，热流的焓降净速率等于冷流的焓增速率与向环境的热损失之和：\n$$\nm_{h}\\left(h_{h,i} - h_{h,o}\\right) \\;=\\; m_{c}\\left(h_{c,o} - h_{c,i}\\right) \\;+\\; Q_{\\mathrm{loss}}.\n$$\n对于具有恒定比热的不可压缩流体，近似为 $h \\approx c_{p} T$。代入得，\n$$\nQ_{\\mathrm{loss}} \\;=\\; m_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;-\\; m_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right).\n$$\n\n第二，为同一控制体写出稳态熵平衡方程。通用的稳流熵平衡方程为\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; \\sum_{\\text{out}} \\dot{m}\\, s_{\\text{out}} \\;-\\; \\sum_{\\text{in}} \\dot{m}\\, s_{\\text{in}} \\;-\\; \\sum_{j} \\frac{\\dot{Q}_{j}}{T_{j}},\n$$\n其中 $\\dot{Q}_{j}$ 是在边界温度 $T_{j}$ 下穿过边界 $j$ 进入控制体的传热率。在这里，唯一的外部热相互作用是向环境的损失，即热量离开控制体。如果我们将从控制体流向环境的热量 $Q_{\\mathrm{loss}}$ 定义为正，那么在 $T_{0}$ 时进入控制体的传热为 $\\dot{Q}_{\\text{into}} = - Q_{\\mathrm{loss}}$。因此，\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; m_{h}\\left(s_{h,o} - s_{h,i}\\right) \\;+\\; m_{c}\\left(s_{c,o} - s_{c,i}\\right) \\;+\\; \\frac{Q_{\\mathrm{loss}}}{T_{0}}.\n$$\n对于具有恒定 $c_{p}$ 的不可压缩流体，比熵变为 $\\Delta s \\approx c_{p} \\ln\\!\\left(\\frac{T_{2}}{T_{1}}\\right)$。因此，\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; m_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;+\\; m_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;+\\; \\frac{Q_{\\mathrm{loss}}}{T_{0}}.\n$$\n\n第三，引用 Gouy–Stodola 关系，该关系指出，㶲损失率等于环境温度乘以熵产率：\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\, \\dot{S}_{\\mathrm{gen}}.\n$$\n代入推导出的 $\\dot{S}_{\\mathrm{gen}}$ 表达式，\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\left[ m_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;+\\; m_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\right] \\;+\\; Q_{\\mathrm{loss}}.\n$$\n这就是闭式㶲损失率，明确地包含了流体不可逆性和向环境的热损失。它为数字孪生提供了一个标量校准目标：匹配 $\\dot{E}_{d}$ 可以确保孪生体能同时复现冷侧的能量短缺以及由有限温差传热和损失引起的总不可逆性。在实践中，数字孪生通过调整有效的总传热系数与面积的乘积（UA）和污垢因子，来同时再现测得的 $Q_{\\mathrm{loss}}$ 和 $\\dot{E}_{d}$。\n\n第四，进行数值计算。首先通过能量平衡计算热损失：\n$$\nQ_{\\mathrm{loss}} \\;=\\; m_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;-\\; m_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right).\n$$\n计算热侧焓降率：\n$$\nm_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;=\\; \\left(5\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\right)\\left(2.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\right)\\left(450\\,\\mathrm{K} - 400\\,\\mathrm{K}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times 50\\,\\mathrm{K} \\;=\\; 500\\,\\mathrm{kW}.\n$$\n计算冷侧焓增率：\n$$\nm_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right) \\;=\\; \\left(3\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\right)\\left(4.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\right)\\left(330\\,\\mathrm{K} - 300\\,\\mathrm{K}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times 30\\,\\mathrm{K} \\;=\\; 360\\,\\mathrm{kW}.\n$$\n因此，\n$$\nQ_{\\mathrm{loss}} \\;=\\; 500\\,\\mathrm{kW} - 360\\,\\mathrm{kW} \\;=\\; 140\\,\\mathrm{kW}.\n$$\n接下来，计算流体熵变的贡献：\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{400}{450}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{8}{9}\\right).\n$$\n使用 $\\ln\\!\\left(\\frac{8}{9}\\right) \\approx -0.117783035$，\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;\\approx\\; -1.17783035\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\n类似地，\n$$\nm_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{330}{300}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{11}{10}\\right).\n$$\n使用 $\\ln\\!\\left(\\frac{11}{10}\\right) \\approx 0.0953101798$，\n$$\nm_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;\\approx\\; 1.143722158\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\n因此，净流体熵项为\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) + m_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;\\approx\\; -0.034108192\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\n加上环境热损失的熵传递：\n$$\n\\frac{Q_{\\mathrm{loss}}}{T_{0}} \\;=\\; \\frac{140\\,\\mathrm{kW}}{300\\,\\mathrm{K}} \\;=\\; 0.466666667\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\n因此，\n$$\n\\dot{S}_{\\mathrm{gen}} \\;\\approx\\; -0.034108192\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} + 0.466666667\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} \\;=\\; 0.432558475\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\n最后，应用 Gouy–Stodola 关系：\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\, \\dot{S}_{\\mathrm{gen}} \\;=\\; 300\\,\\mathrm{K}\\times 0.432558475\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} \\;\\approx\\; 129.7675425\\,\\mathrm{kW}.\n$$\n四舍五入到四位有效数字并以 $\\mathrm{kW}$ 表示，数字孪生的㶲损失率校准目标是 $129.8\\,\\mathrm{kW}$。",
            "answer": "$$\\boxed{129.8}$$"
        },
        {
            "introduction": "校准数字孪生模型通常需要根据实验数据来估计其参数，但这些数据有时会导致数学上的病态问题 (ill-conditioned problems)，此时很难找到唯一的解。本练习将介绍吉洪诺夫正则化 (Tikhonov regularization)，这是一种在这种情况下稳定参数估计的强大技术。您将把它应用于一个超级电容器的等效电路模型。通过推导和应用正则化最小二乘法，您将学会如何构建稳健的估计算法，以处理在实际工程应用中常见的非理想数据。",
            "id": "4084209",
            "problem": "使用一个由串联电阻和串联电容组成的等效电路模型，为基于超级电容器的储能模块构建一个数字孪生。超级电容器的端电压 $v(t)$ 满足欧姆定律和电容器电荷-电压关系的本构关系：端电压是串联电阻压降和电容电压之和，且电容器动态特性满足 $\\frac{d v_{C}(t)}{dt} = \\frac{i(t)}{C}$，其中 $i(t)$ 是端电流，$C$ 是电容值，$v_{C}(t)$ 是电容电压。该模块由一个电流曲线激励，并以均匀的采样间隔在时刻 $t_{k}$ 进行采样，从而得到测量值 $\\{(i_{k}, v_{k})\\}_{k=1}^{N}$ 以及从电流测量值构建的、通过数值积分得到的电荷序列 $q_{k} \\approx \\int_{0}^{t_{k}} i(\\tau)\\, d\\tau$。在这些条件下，并假设初始电容电压的贡献被吸收到一个恒定的偏移量中，仿射测量关系变为 $v_{k} = \\theta_{1}\\, i_{k} + \\theta_{2}\\, q_{k} + \\theta_{3}$，其中参数向量 $\\theta = (\\theta_{1}, \\theta_{2}, \\theta_{3})^{\\top}$ 分别对应于串联电阻 $\\theta_{1}$、电容的倒数 $\\theta_{2} = 1/C$ 和一个偏移量 $\\theta_{3}$。\n\n您将使用适用于病态回归的 Tikhonov $L_{2}$ 正则化最小二乘准则来估计该线性模型的 $\\theta$。从基本定义出发：基尔霍夫电压定律、欧姆定律和电容器的电流-电压关系。建立线性回归模型 $y = X \\theta$（其中 $y \\in \\mathbb{R}^{N}$，$X \\in \\mathbb{R}^{N \\times 3}$），并为带有惩罚矩阵 $\\Gamma \\in \\mathbb{R}^{p \\times 3}$ 和标量权重 $\\lambda > 0$ 的 Tikhonov 正则化问题推导出一阶最优性条件（正规方程），其成本函数为 $J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$。从线性代数和条件数的角度解释，当回归是病态的时，正则化如何改变正规方程以稳定估计。\n\n然后，将您的推导应用于以下数据集（采样间隔为 $1\\,\\mathrm{s}$）：\n- $N = 4$ 个样本，\n- $i_{k}$ 序列：$[1.0,\\, 1.0,\\, 1.0,\\, 1.0]\\,\\mathrm{A}$，\n- 通过数值积分计算的 $q_{k}$ 序列：$[1.0,\\, 2.0,\\, 3.0,\\, 4.0]\\,\\mathrm{C}$，\n- 测量的端电压 $v_{k}$ 序列：$[2.7,\\, 2.9,\\, 3.1,\\, 3.3]\\,\\mathrm{V}$。\n\n使用单位矩阵正则化，其中 $\\Gamma = I_{3}$ 且 $\\lambda = 1$。计算最小化 $J(\\theta)$ 的 Tikhonov 正则化估计值 $\\theta^{\\star} = (\\theta_{1}^{\\star}, \\theta_{2}^{\\star}, \\theta_{3}^{\\star})^{\\top}$。将最终答案的每个分量四舍五入到四位有效数字。将 $\\theta_{1}^{\\star}$ 以欧姆为单位表示，将 $\\theta_{2}^{\\star}$ 以法拉的倒数为单位表示，将 $\\theta_{3}^{\\star}$ 以伏特为单位表示。",
            "solution": "该问题要求使用 Tikhonov 正则化来估计一个线性模型的参数，该模型来自于一个病态数据集。我们将首先推导正则化最小二乘解，然后将其应用于给定的数据。\n\n1.  **模型建立与正规方程推导**\n\n    给定的仿射模型为 $v_{k} = \\theta_{1}\\, i_{k} + \\theta_{2}\\, q_{k} + \\theta_{3}$。对于 $N$ 个样本，我们可以将其写成矩阵形式 $y = X\\theta + \\epsilon$，其中：\n    $$\n    y = \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ \\vdots \\\\ v_{N} \\end{pmatrix}, \\quad\n    X = \\begin{pmatrix} i_{1}  q_{1}  1 \\\\ i_{2}  q_{2}  1 \\\\ \\vdots  \\vdots  \\vdots \\\\ i_{N}  q_{N}  1 \\end{pmatrix}, \\quad\n    \\theta = \\begin{pmatrix} \\theta_{1} \\\\ \\theta_{2} \\\\ \\theta_{3} \\end{pmatrix}\n    $$\n    Tikhonov 正则化的成本函数为 $J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$。\n    我们可以将其展开为矩阵形式：\n    $$\n    J(\\theta) = (X\\theta - y)^{\\top}(X\\theta - y) + \\lambda ( \\Gamma \\theta )^{\\top}(\\Gamma \\theta)\n    $$\n    $$\n    J(\\theta) = (\\theta^{\\top}X^{\\top} - y^{\\top})(X\\theta - y) + \\lambda \\theta^{\\top}\\Gamma^{\\top}\\Gamma\\theta\n    $$\n    $$\n    J(\\theta) = \\theta^{\\top}X^{\\top}X\\theta - \\theta^{\\top}X^{\\top}y - y^{\\top}X\\theta + y^{\\top}y + \\lambda \\theta^{\\top}\\Gamma^{\\top}\\Gamma\\theta\n    $$\n    由于 $\\theta^{\\top}X^{\\top}y$ 是一个标量，它等于其转置 $y^{\\top}X\\theta$。因此：\n    $$\n    J(\\theta) = \\theta^{\\top}(X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)\\theta - 2y^{\\top}X\\theta + y^{\\top}y\n    $$\n    为了找到最小化 $J(\\theta)$ 的 $\\theta$，我们计算其关于 $\\theta$ 的梯度并将其设为零：\n    $$\n    \\frac{\\partial J(\\theta)}{\\partial \\theta} = 2(X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)\\theta - 2X^{\\top}y = 0\n    $$\n    这给出了 Tikhonov 正则化的正规方程：\n    $$\n    (X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)\\theta^{\\star} = X^{\\top}y\n    $$\n    因此，正则化解为 $\\theta^{\\star} = (X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)^{-1}X^{\\top}y$。\n\n    **正则化的作用**：在本问题中，电流 $i_k$ 是恒定的。这意味着 $X$ 矩阵的第一列（对应 $\\theta_1$）与第三列（对应 $\\theta_3$）是线性相关的（第一列是第三列的常数倍）。因此，矩阵 $X$ 是列秩亏的，这导致 $X^{\\top}X$ 是奇异矩阵（不可逆）。标准的最小二乘解 $\\theta = (X^{\\top}X)^{-1}X^{\\top}y$ 不存在唯一解。Tikhonov 正则化通过向 $X^{\\top}X$ 添加一个正定矩阵 $\\lambda \\Gamma^{\\top}\\Gamma$（在本例中为 $\\lambda I$）来解决这个问题。这个相加的项确保了矩阵 $(X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)$ 总是可逆的，从而稳定了问题并产生一个唯一的解。这个正则化项有效地惩罚了大的参数值，从而在多个可能的解中选择了一个范数较小的解。\n\n2.  **数值计算**\n\n    根据给定的数据：\n    $$\n    y = \\begin{pmatrix} 2.7 \\\\ 2.9 \\\\ 3.1 \\\\ 3.3 \\end{pmatrix}, \\quad\n    X = \\begin{pmatrix} 1.0  1.0  1 \\\\ 1.0  2.0  1 \\\\ 1.0  3.0  1 \\\\ 1.0  4.0  1 \\end{pmatrix}\n    $$\n    我们计算 $X^{\\top}X$ 和 $X^{\\top}y$：\n    $$\n    X^{\\top}X = \\begin{pmatrix} 1  1  1  1 \\\\ 1  2  3  4 \\\\ 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1  1  1 \\\\ 1  2  1 \\\\ 1  3  1 \\\\ 1  4  1 \\end{pmatrix} = \\begin{pmatrix} 4  10  4 \\\\ 10  30  10 \\\\ 4  10  4 \\end{pmatrix}\n    $$\n    $$\n    X^{\\top}y = \\begin{pmatrix} 1  1  1  1 \\\\ 1  2  3  4 \\\\ 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 2.7 \\\\ 2.9 \\\\ 3.1 \\\\ 3.3 \\end{pmatrix} = \\begin{pmatrix} 12.0 \\\\ 31.0 \\\\ 12.0 \\end{pmatrix}\n    $$\n    我们使用 $\\lambda=1$ 和 $\\Gamma = I_{3}$。正规方程变为 $(X^{\\top}X + I)\\theta^{\\star} = X^{\\top}y$。\n    $$\n    A = X^{\\top}X + I = \\begin{pmatrix} 4  10  4 \\\\ 10  30  10 \\\\ 4  10  4 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 5  10  4 \\\\ 10  31  10 \\\\ 4  10  5 \\end{pmatrix}\n    $$\n    我们需要求解线性系统 $A\\theta^{\\star} = X^{\\top}y$。我们可以通过计算 $A$ 的逆矩阵来求解。\n    $A$ 的行列式为：\n    $\\det(A) = 5(31 \\cdot 5 - 10 \\cdot 10) - 10(10 \\cdot 5 - 10 \\cdot 4) + 4(10 \\cdot 10 - 31 \\cdot 4) = 5(55) - 10(10) + 4(-24) = 275 - 100 - 96 = 79$。\n    $A$ 的逆矩阵为：\n    $$\n    A^{-1} = \\frac{1}{79} \\begin{pmatrix}\n    (31 \\cdot 5 - 10 \\cdot 10)  -(10 \\cdot 5 - 4 \\cdot 10)  (10 \\cdot 10 - 4 \\cdot 31) \\\\\n    -(10 \\cdot 5 - 10 \\cdot 4)  (5 \\cdot 5 - 4 \\cdot 4)  -(5 \\cdot 10 - 4 \\cdot 10) \\\\\n    (10 \\cdot 10 - 31 \\cdot 4)  -(5 \\cdot 10 - 10 \\cdot 4)  (5 \\cdot 31 - 10 \\cdot 10)\n    \\end{pmatrix} = \\frac{1}{79} \\begin{pmatrix} 55  -10  -24 \\\\ -10  9  -10 \\\\ -24  -10  55 \\end{pmatrix}\n    $$\n    现在计算 $\\theta^{\\star} = A^{-1}X^{\\top}y$：\n    $$\n    \\theta^{\\star} = \\frac{1}{79} \\begin{pmatrix} 55  -10  -24 \\\\ -10  9  -10 \\\\ -24  -10  55 \\end{pmatrix} \\begin{pmatrix} 12 \\\\ 31 \\\\ 12 \\end{pmatrix}\n    $$\n    $$\n    \\theta^{\\star} = \\frac{1}{79} \\begin{pmatrix} 55 \\cdot 12 - 10 \\cdot 31 - 24 \\cdot 12 \\\\ -10 \\cdot 12 + 9 \\cdot 31 - 10 \\cdot 12 \\\\ -24 \\cdot 12 - 10 \\cdot 31 + 55 \\cdot 12 \\end{pmatrix} = \\frac{1}{79} \\begin{pmatrix} 660 - 310 - 288 \\\\ -120 + 279 - 120 \\\\ -288 - 310 + 660 \\end{pmatrix} = \\frac{1}{79} \\begin{pmatrix} 62 \\\\ 39 \\\\ 62 \\end{pmatrix}\n    $$\n    最后，计算每个分量的数值并四舍五入到四位有效数字：\n    $$\n    \\theta_{1}^{\\star} = \\frac{62}{79} \\approx 0.78481... \\approx 0.7848\n    $$\n    $$\n    \\theta_{2}^{\\star} = \\frac{39}{79} \\approx 0.49367... \\approx 0.4937\n    $$\n    $$\n    \\theta_{3}^{\\star} = \\frac{62}{79} \\approx 0.78481... \\approx 0.7848\n    $$\n    因此，正则化的参数估计值为 $\\theta_{1}^{\\star} \\approx 0.7848\\,\\Omega$, $\\theta_{2}^{\\star} \\approx 0.4937\\,\\mathrm{F}^{-1}$, and $\\theta_{3}^{\\star} \\approx 0.7848\\,\\mathrm{V}$。",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\n\\theta_{1}^{\\star} \\approx 0.7848 \\, \\Omega \\\\\n\\theta_{2}^{\\star} \\approx 0.4937 \\, \\mathrm{F}^{-1} \\\\\n\\theta_{3}^{\\star} \\approx 0.7848 \\, \\mathrm{V}\n\\end{aligned}\n}\n$$"
        }
    ]
}