{
    "hands_on_practices": [
        {
            "introduction": "A robust digital twin is not just a geometric replica; it is a dynamic, physics-based model. This exercise grounds you in the first principles of thermodynamics by tasking you with analyzing a heat exchanger, a common asset in many energy systems. By deriving the energy balance and entropy generation, you will compute the rate of exergy destruction, a critical metric that quantifies irreversibility and serves as a vital calibration target for the twin .",
            "id": "4084186",
            "problem": "A Digital Twin (DT) of a shell-and-tube heat exchanger in a Combined Heat and Power (CHP) plant must be calibrated to simultaneously match energy transfer and irreversibility under realistic losses. Consider a steady-state counterflow heat exchanger with a hot oil stream and a cold water stream. The ambient reference temperature is $T_{0} = 300\\,\\mathrm{K}$. The hot stream has mass flow rate $m_{h} = 5\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$, constant specific heat $c_{p,h} = 2.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, inlet temperature $T_{h,i} = 450\\,\\mathrm{K}$, and outlet temperature $T_{h,o} = 400\\,\\mathrm{K}$. The cold stream has mass flow rate $m_{c} = 3\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$, constant specific heat $c_{p,c} = 4.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, inlet temperature $T_{c,i} = 300\\,\\mathrm{K}$, and outlet temperature $T_{c,o} = 330\\,\\mathrm{K}$. Assume negligible changes in kinetic and potential energies and negligible pressure drops. Treat both fluids as incompressible with constant specific heats.\n\nStarting only from the First Law of Thermodynamics for a steady-flow control volume and the entropy balance for steady flow, and using the core definitions for sensible enthalpy change $h \\approx c_{p} T$ and the specific entropy change of an incompressible fluid with constant $c_{p}$, $\\Delta s \\approx c_{p} \\ln\\!\\left(\\frac{T_{2}}{T_{1}}\\right)$, perform the following:\n\n1. Derive the steady-state energy balance for the exchanger that explicitly includes a heat loss term $Q_{\\mathrm{loss}}$ to the ambient at temperature $T_{0}$, expressing it in terms of the given mass flow rates, specific heats, and stream temperatures.\n2. Derive the steady-state entropy generation rate $\\dot{S}_{\\mathrm{gen}}$ for the exchanger in terms of the hot and cold stream entropy changes and the heat transfer to the ambient at $T_{0}$.\n3. Using the Gouy–Stodola relation, derive a closed-form expression for the exergy destruction rate $\\dot{E}_{d}$ in terms of the quantities specified above.\n4. Evaluate your expression numerically for the given data to produce a single scalar calibration target that the DT can use to tune its loss and fouling parameters. This scalar target is the exergy destruction rate $\\dot{E}_{d}$.\n\nRound your final numerical answer to four significant figures. Express the final exergy destruction rate in $\\mathrm{kW}$.",
            "solution": "The foundational starting point is the First Law of Thermodynamics for a steady-flow control volume and the entropy balance for steady flow, together with well-tested expressions for sensible enthalpy and entropy changes of incompressible fluids with constant specific heat.\n\nFirst, write the steady-state energy balance for the control volume comprising the entire heat exchanger. With no shaft work and negligible kinetic and potential energy changes, the energy balance states that the net rate of enthalpy decrease of the hot stream equals the sum of the rate of enthalpy increase of the cold stream and the heat loss to the ambient:\n$$\nm_{h}\\left(h_{h,i} - h_{h,o}\\right) \\;=\\; m_{c}\\left(h_{c,o} - h_{c,i}\\right) \\;+\\; Q_{\\mathrm{loss}}.\n$$\nFor incompressible fluids with constant specific heat, approximate $h \\approx c_{p} T$. Substituting,\n$$\nQ_{\\mathrm{loss}} \\;=\\; m_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;-\\; m_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right).\n$$\n\nSecond, write the steady-state entropy balance for the same control volume. The general steady-flow entropy balance is\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; \\sum_{\\text{out}} \\dot{m}\\, s_{\\text{out}} \\;-\\; \\sum_{\\text{in}} \\dot{m}\\, s_{\\text{in}} \\;-\\; \\sum_{j} \\frac{\\dot{Q}_{j}}{T_{j}},\n$$\nwhere $\\dot{Q}_{j}$ is the heat transfer rate into the control volume across boundary $j$ at the boundary temperature $T_{j}$. Here, the only external heat interaction is the loss to the ambient, which is heat leaving the control volume. If we define $Q_{\\mathrm{loss}}$ as positive for heat flowing from the control volume to the ambient, then the heat transfer into the control volume is $\\dot{Q}_{\\text{into}} = - Q_{\\mathrm{loss}}$ at $T_{0}$. Therefore,\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; m_{h}\\left(s_{h,o} - s_{h,i}\\right) \\;+\\; m_{c}\\left(s_{c,o} - s_{c,i}\\right) \\;+\\; \\frac{Q_{\\mathrm{loss}}}{T_{0}}.\n$$\nFor incompressible fluids with constant $c_{p}$, the specific entropy change is $\\Delta s \\approx c_{p} \\ln\\!\\left(\\frac{T_{2}}{T_{1}}\\right)$. Hence,\n$$\n\\dot{S}_{\\mathrm{gen}} \\;=\\; m_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;+\\; m_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;+\\; \\frac{Q_{\\mathrm{loss}}}{T_{0}}.\n$$\n\nThird, invoke the Gouy–Stodola relation, which states that the exergy destruction rate equals the ambient temperature times the entropy generation rate:\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\, \\dot{S}_{\\mathrm{gen}}.\n$$\nSubstituting the derived expression for $\\dot{S}_{\\mathrm{gen}}$,\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\left[ m_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;+\\; m_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\right] \\;+\\; Q_{\\mathrm{loss}}.\n$$\nThis is the closed-form exergy destruction rate, explicitly incorporating both stream irreversibilities and ambient heat loss. It provides a scalar calibration target for the DT: matching $\\dot{E}_{d}$ ensures the twin replicates both the energy shortfall to the cold side and the aggregate irreversibility due to finite-temperature-gradient heat transfer and losses. In practice, the DT adjusts effective Overall Heat Transfer Coefficient times Area (UA) and fouling factors to concurrently reproduce the measured $Q_{\\mathrm{loss}}$ and $\\dot{E}_{d}$.\n\nFourth, evaluate numerically. Begin by computing the heat loss via the energy balance:\n$$\nQ_{\\mathrm{loss}} \\;=\\; m_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;-\\; m_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right).\n$$\nCompute the hot-side enthalpy decrease rate:\n$$\nm_{h} c_{p,h} \\left(T_{h,i} - T_{h,o}\\right) \\;=\\; \\left(5\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\right)\\left(2.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\right)\\left(450\\,\\mathrm{K} - 400\\,\\mathrm{K}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times 50\\,\\mathrm{K} \\;=\\; 500\\,\\mathrm{kW}.\n$$\nCompute the cold-side enthalpy increase rate:\n$$\nm_{c} c_{p,c} \\left(T_{c,o} - T_{c,i}\\right) \\;=\\; \\left(3\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\right)\\left(4.0\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\right)\\left(330\\,\\mathrm{K} - 300\\,\\mathrm{K}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times 30\\,\\mathrm{K} \\;=\\; 360\\,\\mathrm{kW}.\n$$\nThus,\n$$\nQ_{\\mathrm{loss}} \\;=\\; 500\\,\\mathrm{kW} - 360\\,\\mathrm{kW} \\;=\\; 140\\,\\mathrm{kW}.\n$$\nNext, compute the stream entropy change contributions:\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{400}{450}\\right) \\;=\\; 10\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{8}{9}\\right).\n$$\nUsing $\\ln\\!\\left(\\frac{8}{9}\\right) \\approx -0.117783035$,\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) \\;\\approx\\; -1.17783035\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\nSimilarly,\n$$\nm_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{330}{300}\\right) \\;=\\; 12\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}\\times \\ln\\!\\left(\\frac{11}{10}\\right).\n$$\nUsing $\\ln\\!\\left(\\frac{11}{10}\\right) \\approx 0.0953101798$,\n$$\nm_{c} c_{p,c} \\ln\\!\\left(\\frac{T_{c,o}}{T_{c,i}}\\right) \\;\\approx\\; 1.143722158\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\nTherefore, the net stream entropy term is\n$$\nm_{h} c_{p,h} \\ln\\!\\left(\\frac{T_{h,o}}{T_{h,i}}\\right) + m_{c} c_{p,c} \\ln\\!\\left(\\fracT_{c,o}}{T_{c,i}}\\right) \\;\\approx\\; -0.034108192\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\nAdd the ambient heat-loss entropy transfer:\n$$\n\\frac{Q_{\\mathrm{loss}}}{T_{0}} \\;=\\; \\frac{140\\,\\mathrm{kW}}{300\\,\\mathrm{K}} \\;=\\; 0.466666667\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\nHence,\n$$\n\\dot{S}_{\\mathrm{gen}} \\;\\approx\\; -0.034108192\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} + 0.466666667\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} \\;=\\; 0.432558475\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}.\n$$\nFinally, apply the Gouy–Stodola relation:\n$$\n\\dot{E}_{d} \\;=\\; T_{0}\\, \\dot{S}_{\\mathrm{gen}} \\;=\\; 300\\,\\mathrm{K}\\times 0.432558475\\,\\mathrm{kW}\\,\\mathrm{K}^{-1} \\;\\approx\\; 129.7675425\\,\\mathrm{kW}.\n$$\nRounded to four significant figures and expressed in $\\mathrm{kW}$, the exergy destruction rate calibration target for the DT is $129.8\\,\\mathrm{kW}$.",
            "answer": "$$\\boxed{129.8}$$"
        },
        {
            "introduction": "Once a physical model structure is established, its parameters must be identified from experimental data—a process known as calibration. This practice guides you through estimating the parameters of an equivalent circuit model for a supercapacitor, a key energy storage asset. You will encounter the common challenge of an ill-conditioned regression and learn to apply Tikhonov regularization to obtain a stable and physically meaningful solution .",
            "id": "4084209",
            "problem": "A Digital Twin for a supercapacitor-based energy storage module is constructed using an Equivalent Circuit Model comprised of a series resistor and a capacitor in series. The supercapacitor terminal voltage $v(t)$ satisfies the constitutive relations of Ohm's law and the capacitor charge-voltage relation: the terminal voltage is the sum of the series resistive drop and the capacitor voltage, and the capacitor dynamics satisfy $\\frac{d v_{C}(t)}{dt} = \\frac{i(t)}{C}$, where $i(t)$ is the terminal current, $C$ is the capacitance, and $v_{C}(t)$ is the capacitor voltage. The module is excited by a current profile and sampled at times $t_{k}$ with uniform sampling interval, yielding measurements $\\{(i_{k}, v_{k})\\}_{k=1}^{N}$ and the numerically integrated charge sequence $q_{k} \\approx \\int_{0}^{t_{k}} i(\\tau)\\, d\\tau$ constructed from the current measurement. Under these conditions and assuming the initial capacitor voltage contribution is absorbed into a constant offset, the affine measurement relation becomes $v_{k} = \\theta_{1}\\, i_{k} + \\theta_{2}\\, q_{k} + \\theta_{3}$, where the parameter vector $\\theta = (\\theta_{1}, \\theta_{2}, \\theta_{3})^{\\top}$ corresponds to the series resistance $\\theta_{1}$, the inverse capacitance $\\theta_{2} = 1/C$, and an offset $\\theta_{3}$.\n\nYou will estimate $\\theta$ for this linear model using a Tikhonov $L_{2}$-regularized least squares criterion, appropriate for ill-conditioned regressions. Start from fundamental definitions: Kirchhoff’s Voltage Law, Ohm’s law, and the capacitor current-voltage relation. Form the linear regression $y = X \\theta$ with $y \\in \\mathbb{R}^{N}$ and $X \\in \\mathbb{R}^{N \\times 3}$, and derive the first-order optimality condition (normal equations) for the Tikhonov-regularized problem with penalty matrix $\\Gamma \\in \\mathbb{R}^{p \\times 3}$ and scalar weight $\\lambda > 0$, where the cost function is $J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$. Explain, in terms of linear algebra and conditioning, how the regularization alters the normal equations to stabilize the estimation when the regression is ill-conditioned.\n\nThen, apply your derivation to the following dataset (sampling interval is $1\\,\\mathrm{s}$):\n- $N = 4$ samples,\n- $i_{k}$ sequence: $[1.0,\\, 1.0,\\, 1.0,\\, 1.0]\\,\\mathrm{A}$,\n- computed $q_{k}$ sequence via numerical integration: $[1.0,\\, 2.0,\\, 3.0,\\, 4.0]\\,\\mathrm{C}$,\n- measured terminal voltage $v_{k}$ sequence: $[2.7,\\, 2.9,\\, 3.1,\\, 3.3]\\,\\mathrm{V}$.\n\nUse identity regularization with $\\Gamma = I_{3}$ and $\\lambda = 1$. Compute the Tikhonov-regularized estimate $\\theta^{\\star} = (\\theta_{1}^{\\star}, \\theta_{2}^{\\star}, \\theta_{3}^{\\star})^{\\top}$ that minimizes $J(\\theta)$. Round each component of the final answer to four significant figures. Express $\\theta_{1}^{\\star}$ in ohms, $\\theta_{2}^{\\star}$ in inverse farads, and $\\theta_{3}^{\\star}$ in volts.",
            "solution": "The goal is to find the parameter vector $\\theta = (\\theta_1, \\theta_2, \\theta_3)^{\\top}$ for the affine model $v_k = \\theta_1 i_k + \\theta_2 q_k + \\theta_3$ by minimizing the Tikhonov-regularized cost function.\n\n**1. Formulation of the Linear Regression**\n\nThe model $v_k = \\theta_1 i_k + \\theta_2 q_k + \\theta_3$ can be written in matrix form as $y = X\\theta$, where $y$ is the vector of voltage measurements, and $X$ is the design matrix.\nGiven the data:\n- $i_k$: $[1.0, 1.0, 1.0, 1.0]$\n- $q_k$: $[1.0, 2.0, 3.0, 4.0]$\n- $v_k$: $[2.7, 2.9, 3.1, 3.3]$\n\nThe vector $y$ and matrix $X$ are:\n$$\ny = \\begin{pmatrix} 2.7 \\\\ 2.9 \\\\ 3.1 \\\\ 3.3 \\end{pmatrix}, \\quad\nX = \\begin{pmatrix}\ni_1 & q_1 & 1 \\\\\ni_2 & q_2 & 1 \\\\\ni_3 & q_3 & 1 \\\\\ni_4 & q_4 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 1 & 1 \\\\\n1 & 2 & 1 \\\\\n1 & 3 & 1 \\\\\n1 & 4 & 1\n\\end{pmatrix}\n$$\n\n**2. Derivation of the Tikhonov-Regularized Solution**\n\nThe cost function to minimize is $J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$.\nTo find the minimum, we compute the gradient with respect to $\\theta$ and set it to zero:\n$$\n\\nabla_{\\theta} J(\\theta) = \\nabla_{\\theta} \\left( (X\\theta - y)^{\\top}(X\\theta - y) + \\lambda (\\Gamma\\theta)^{\\top}(\\Gamma\\theta) \\right)\n$$\n$$\n\\nabla_{\\theta} J(\\theta) = \\nabla_{\\theta} \\left( \\theta^{\\top}X^{\\top}X\\theta - 2y^{\\top}X\\theta + y^{\\top}y + \\lambda \\theta^{\\top}\\Gamma^{\\top}\\Gamma\\theta \\right)\n$$\n$$\n\\nabla_{\\theta} J(\\theta) = 2X^{\\top}X\\theta - 2X^{\\top}y + 2\\lambda\\Gamma^{\\top}\\Gamma\\theta = 0\n$$\nRearranging gives the normal equations for the Tikhonov-regularized problem:\n$$\n(X^{\\top}X + \\lambda\\Gamma^{\\top}\\Gamma)\\theta^{\\star} = X^{\\top}y\n$$\nThe solution is $\\theta^{\\star} = (X^{\\top}X + \\lambda\\Gamma^{\\top}\\Gamma)^{-1}X^{\\top}y$.\n\n**3. Ill-Conditioning and Regularization**\n\nIn this problem, the first column of $X$ (from $i_k$) and the third column (the constant offset) are identical. This means the columns are linearly dependent, so the matrix $X$ is not full column rank. As a result, the matrix $X^{\\top}X$ is singular and not invertible, making standard least squares unusable. The regularization term $\\lambda\\Gamma^{\\top}\\Gamma$ (here $\\lambda I$ since $\\Gamma=I_3$ and $\\lambda=1$) adds a positive-definite matrix to $X^{\\top}X$. This ensures that the combined matrix $(X^{\\top}X + \\lambda I)$ is invertible, thus \"stabilizing\" the problem and allowing for a unique solution.\n\n**4. Numerical Calculation**\n\nFirst, compute $X^{\\top}X$ and $X^{\\top}y$:\n$$\nX^{\\top} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 1 & 2 & 3 & 4 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix}\n$$\n$$\nX^{\\top}X = \\begin{pmatrix} 4 & 10 & 4 \\\\ 10 & 30 & 10 \\\\ 4 & 10 & 4 \\end{pmatrix}\n$$\n$$\nX^{\\top}y = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 1 & 2 & 3 & 4 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 2.7 \\\\ 2.9 \\\\ 3.1 \\\\ 3.3 \\end{pmatrix} = \\begin{pmatrix} 12.0 \\\\ 31.0 \\\\ 12.0 \\end{pmatrix}\n$$\nNow, form the regularized matrix $A = X^{\\top}X + \\lambda I$ with $\\lambda=1$:\n$$\nA = \\begin{pmatrix} 4 & 10 & 4 \\\\ 10 & 30 & 10 \\\\ 4 & 10 & 4 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 5 & 10 & 4 \\\\ 10 & 31 & 10 \\\\ 4 & 10 & 5 \\end{pmatrix}\n$$\nWe need to solve $A \\theta^{\\star} = X^{\\top}y$. The inverse of $A$ is:\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\text{adj}(A) = \\frac{1}{79} \\begin{pmatrix} 55 & -10 & -24 \\\\ -10 & 9 & -10 \\\\ -24 & -10 & 55 \\end{pmatrix}\n$$\nNow, compute $\\theta^{\\star} = A^{-1}X^{\\top}y$:\n$$\n\\theta^{\\star} = \\frac{1}{79} \\begin{pmatrix} 55 & -10 & -24 \\\\ -10 & 9 & -10 \\\\ -24 & -10 & 55 \\end{pmatrix} \\begin{pmatrix} 12 \\\\ 31 \\\\ 12 \\end{pmatrix} = \\frac{1}{79} \\begin{pmatrix} (55)(12) - (10)(31) - (24)(12) \\\\ (-10)(12) + (9)(31) - (10)(12) \\\\ (-24)(12) - (10)(31) + (55)(12) \\end{pmatrix}\n$$\n$$\n\\theta^{\\star} = \\frac{1}{79} \\begin{pmatrix} 660 - 310 - 288 \\\\ -120 + 279 - 120 \\\\ -288 - 310 + 660 \\end{pmatrix} = \\frac{1}{79} \\begin{pmatrix} 62 \\\\ 39 \\\\ 62 \\end{pmatrix} \\approx \\begin{pmatrix} 0.78481 \\\\ 0.49367 \\\\ 0.78481 \\end{pmatrix}\n$$\nRounding each component to four significant figures, we get the final regularized estimate:\n$$\n\\theta_{1}^{\\star} \\approx 0.7848 \\text{ (ohms)} \\\\\n\\theta_{2}^{\\star} \\approx 0.4937 \\text{ (inverse farads)} \\\\\n\\theta_{3}^{\\star} \\approx 0.7848 \\text{ (volts)}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7848 \\\\\n0.4937 \\\\\n0.7848\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A core function of a digital twin is to synthesize streams of noisy sensor data into a single, coherent \"best estimate\" of the asset's state. This practice delves into the fundamental theory of data fusion. You will derive the optimal weights for combining measurements from multiple redundant sensors to produce a linear unbiased estimate with minimum variance, a cornerstone of modern estimation techniques used in digital twins .",
            "id": "4084247",
            "problem": "A digital twin for an energy pipeline asset maintains a physics-informed estimate of internal pressure by assimilating redundant sensor data at each assimilation step. At a given time stamp, the digital twin receives simultaneous readings from $3$ calibrated, redundant static pressure sensors assumed to measure the same true pipeline pressure $p^{\\ast}$. Each sensor is modeled as an unbiased measurement corrupted by independent, zero-mean Gaussian noise with known variance. Let the measurement model be $y_{i} = p^{\\ast} + \\varepsilon_{i}$, where $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ and $\\varepsilon_{i}$ are independent across sensors. The digital twin seeks a linear fused estimate $\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}$ that is unbiased and has minimum variance. \n\nStarting from the definitions of unbiasedness and variance, and without invoking any pre-derived estimator formulas, formulate and solve the constrained optimization problem that determines the optimal fusion weights using the method of Lagrange multipliers. Explicitly derive the general expression for the optimal weights in terms of the known variances. \n\nThen, using the following sensor data and known variances, compute the fused pressure estimate:\n- Sensor readings: $y_{1} = 102.3$ kPa, $y_{2} = 101.9$ kPa, $y_{3} = 103.1$ kPa.\n- Noise variances: $\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$, $\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$, $\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$.\n\nExpress the final fused pressure in kPa and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The problem statement is well-posed, scientifically grounded, and contains all necessary information to derive a unique solution. It is a standard problem in estimation theory, specifically finding the Best Linear Unbiased Estimator (BLUE) for a constant parameter from multiple measurements with known noise characteristics. We shall proceed with the derivation.\n\nThe problem asks for a linear fused estimate of the true pressure $p^{\\ast}$ of the form:\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}\n$$\nwhere $y_i$ are the sensor measurements and $w_i$ are the weights to be determined. The measurement model for each sensor is given by $y_{i} = p^{\\ast} + \\varepsilon_{i}$, where the noise terms $\\varepsilon_{i}$ are independent and drawn from a normal distribution with zero mean and variance $\\sigma_{i}^{2}$, i.e., $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma_{i}^{2})$.\n\nThe estimate $\\hat{p}$ must satisfy two conditions: it must be unbiased and have minimum variance.\n\nFirst, we formalize the unbiasedness constraint. An estimator is unbiased if its expected value equals the true value of the parameter being estimated. Here, we require $E[\\hat{p}] = p^{\\ast}$.\n$$\nE[\\hat{p}] = E\\left[\\sum_{i=1}^{3} w_{i} y_{i}\\right]\n$$\nBy the linearity of the expectation operator:\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} E[y_{i}]\n$$\nThe expected value of each measurement is:\n$$\nE[y_{i}] = E[p^{\\ast} + \\varepsilon_{i}] = E[p^{\\ast}] + E[\\varepsilon_{i}]\n$$\nSince $p^{\\ast}$ is a constant (the true pressure at a given time), $E[p^{\\ast}] = p^{\\ast}$. The noise term $\\varepsilon_{i}$ has zero mean, so $E[\\varepsilon_{i}] = 0$. Therefore, $E[y_{i}] = p^{\\ast}$.\nSubstituting this back into the expression for $E[\\hat{p}]$:\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} p^{\\ast} = p^{\\ast} \\sum_{i=1}^{3} w_{i}\n$$\nFor the unbiasedness condition $E[\\hat{p}] = p^{\\ast}$ to hold for any non-zero $p^{\\ast}$, we must have:\n$$\n\\sum_{i=1}^{3} w_{i} = 1\n$$\nThis is the constraint for our optimization problem.\n\nNext, we formulate the objective function, which is the variance of the estimator $\\hat{p}$, to be minimized.\n$$\n\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\sum_{i=1}^{3} w_{i} y_{i}\\right)\n$$\nSince the noise terms $\\varepsilon_{i}$ are independent, the measurements $y_{i}$ are also independent. For independent random variables, the variance of a weighted sum is the weighted sum of the variances:\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} \\text{Var}(w_{i} y_{i})\n$$\nUsing the variance property $\\text{Var}(aX) = a^2 \\text{Var}(X)$:\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\text{Var}(y_{i})\n$$\nThe variance of a single measurement is:\n$$\n\\text{Var}(y_{i}) = \\text{Var}(p^{\\ast} + \\varepsilon_{i}) = \\text{Var}(\\varepsilon_{i}) = \\sigma_{i}^{2}\n$$\nsince adding a constant ($p^{\\ast}$) does not change the variance.\nThus, the objective function to be minimized is:\n$$\nf(w_1, w_2, w_3) = \\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}\n$$\n\nThe problem is now a constrained optimization problem: minimize $f(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}$ subject to the constraint $g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i} - 1 = 0$. We use the method of Lagrange multipliers. The Lagrangian function $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(w_1, w_2, w_3, \\lambda) = f(w_1, w_2, w_3) - \\lambda g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2} - \\lambda \\left(\\sum_{i=1}^{3} w_{i} - 1\\right)\n$$\nTo find the minimum, we set the partial derivatives of $\\mathcal{L}$ with respect to each $w_i$ and $\\lambda$ to zero. For each $i \\in \\{1, 2, 3\\}$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{i}} = 2 w_{i} \\sigma_{i}^{2} - \\lambda = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{i=1}^{3} w_{i} - 1\\right) = 0\n$$\nFrom the first set of equations, we solve for $w_i$ in terms of $\\lambda$:\n$$\nw_{i} = \\frac{\\lambda}{2\\sigma_{i}^{2}}\n$$\nThis shows that the optimal weight for each sensor is inversely proportional to its variance, which is intuitively correct. Now, we substitute this expression for $w_i$ into the constraint equation:\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda}{2\\sigma_{i}^{2}} = 1\n$$\nFactoring out the constant terms:\n$$\n\\frac{\\lambda}{2} \\sum_{i=1}^{3} \\frac{1}{\\sigma_{i}^{2}} = 1\n$$\nSolving for the Lagrange multiplier $\\lambda$:\n$$\n\\lambda = \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\nFinally, we substitute $\\lambda$ back into the expression for $w_i$ to find the general formula for the optimal weights:\n$$\nw_{i} = \\frac{1}{2\\sigma_{i}^{2}} \\left( \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}} \\right) = \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\nThis is the general expression for the optimal fusion weights.\n\nNow, we apply this result to the given data:\n- Sensor readings: $y_{1} = 102.3$ kPa, $y_{2} = 101.9$ kPa, $y_{3} = 103.1$ kPa.\n- Noise variances: $\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$, $\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$, $\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$.\n\nFirst, we compute the inverse variances and their sum. Let $S = \\sum_{j=1}^{3} 1/\\sigma_{j}^{2}$.\n$$\n\\frac{1}{\\sigma_{1}^{2}} = \\frac{1}{1.0} = 1.0\n$$\n$$\n\\frac{1}{\\sigma_{2}^{2}} = \\frac{1}{4.0} = 0.25\n$$\n$$\n\\frac{1}{\\sigma_{3}^{2}} = \\frac{1}{9.0}\n$$\nThe sum is:\n$$\nS = 1.0 + 0.25 + \\frac{1}{9} = \\frac{5}{4} + \\frac{1}{9} = \\frac{45 + 4}{36} = \\frac{49}{36}\n$$\nNow, we calculate the optimal weights $w_i = (1/\\sigma_i^2)/S$:\n$$\nw_{1} = \\frac{1.0}{49/36} = \\frac{36}{49}\n$$\n$$\nw_{2} = \\frac{0.25}{49/36} = \\frac{1/4}{49/36} = \\frac{1}{4} \\cdot \\frac{36}{49} = \\frac{9}{49}\n$$\n$$\nw_{3} = \\frac{1/9}{49/36} = \\frac{1}{9} \\cdot \\frac{36}{49} = \\frac{4}{49}\n$$\nAs a check, the weights sum to unity: $w_1+w_2+w_3 = \\frac{36+9+4}{49} = \\frac{49}{49} = 1$.\n\nFinally, we compute the fused pressure estimate $\\hat{p}$:\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i} = w_{1}y_{1} + w_{2}y_{2} + w_{3}y_{3}\n$$\n$$\n\\hat{p} = \\left(\\frac{36}{49}\\right)(102.3) + \\left(\\frac{9}{49}\\right)(101.9) + \\left(\\frac{4}{49}\\right)(103.1)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 36 \\times 102.3 + 9 \\times 101.9 + 4 \\times 103.1 \\right)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 3682.8 + 917.1 + 412.4 \\right)\n$$\n$$\n\\hat{p} = \\frac{5012.3}{49} \\approx 102.2918367...\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are 1, 0, 2, 2. The fifth digit is 9, so we round up the fourth digit.\n$$\n\\hat{p} \\approx 102.3 \\text{ kPa}\n$$",
            "answer": "$$\n\\boxed{102.3}\n$$"
        }
    ]
}