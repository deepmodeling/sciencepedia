{
    "hands_on_practices": [
        {
            "introduction": "数字孪生的准确性依赖于其整合来自多个传感器数据的能力，而这些传感器数据往往是冗余且带有噪声的。本练习将演示如何通过基于传感器已知可靠性（方差）对其测量值进行最优加权，从而找到最佳线性无偏估计（Best Linear Unbiased Estimator, BLUE）。这项技术是数字孪生中数据同化的基础，对于获得资产当前状态的精确估计至关重要 。",
            "id": "4084247",
            "problem": "一个能源管道资产的数字孪生通过在每个同化步骤中吸收冗余传感器数据，来维持一个基于物理的内部压力估计。在给定的时间戳，该数字孪生接收到来自 $3$ 个经过校准的冗余静压传感器的同步读数，这些传感器假定测量的是同一个真实的管道压力 $p^{\\ast}$。每个传感器被建模为一个无偏测量，该测量被具有已知方差的、独立的、零均值的高斯噪声所污染。设测量模型为 $y_{i} = p^{\\ast} + \\varepsilon_{i}$，其中 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ 且 $\\varepsilon_{i}$ 在各传感器之间是独立的。该数字孪生寻求一个线性的融合估计 $\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}$，该估计是无偏的且具有最小方差。\n\n从无偏性和方差的定义出发，并且不使用任何预先推导的估计器公式，利用拉格朗日乘数法来构建并求解确定最优融合权重的约束优化问题。明确推导最优权重关于已知方差的一般表达式。\n\n然后，使用以下传感器数据和已知方差，计算融合压力估计：\n- 传感器读数：$y_{1} = 102.3$ kPa，$y_{2} = 101.9$ kPa，$y_{3} = 103.1$ kPa。\n- 噪声方差：$\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$，$\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$，$\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$。\n\n以 kPa 为单位表示最终的融合压力，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "问题陈述是适定的、有科学依据的，并包含了推导唯一解所需的所有信息。这是估计理论中的一个标准问题，具体来说是从具有已知噪声特性的多个测量中寻找一个常数参数的最佳线性无偏估计器（BLUE）。我们将开始推导过程。\n\n问题要求一个真实压力 $p^{\\ast}$ 的线性融合估计，形式如下：\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i}\n$$\n其中 $y_i$ 是传感器测量值，$w_i$ 是待定权重。每个传感器的测量模型由 $y_{i} = p^{\\ast} + \\varepsilon_{i}$ 给出，其中噪声项 $\\varepsilon_{i}$ 是独立的，并且服从均值为零、方差为 $\\sigma_{i}^{2}$ 的正态分布，即 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma_{i}^{2})$。\n\n估计值 $\\hat{p}$ 必须满足两个条件：它必须是无偏的，并且具有最小方差。\n\n首先，我们将无偏性约束形式化。如果一个估计器的期望值等于被估计参数的真值，则该估计器是无偏的。这里，我们要求 $E[\\hat{p}] = p^{\\ast}$。\n$$\nE[\\hat{p}] = E\\left[\\sum_{i=1}^{3} w_{i} y_{i}\\right]\n$$\n根据期望算子的线性性质：\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} E[y_{i}]\n$$\n每个测量值的期望值为：\n$$\nE[y_{i}] = E[p^{\\ast} + \\varepsilon_{i}] = E[p^{\\ast}] + E[\\varepsilon_{i}]\n$$\n由于 $p^{\\ast}$ 是一个常数（给定时间的真实压力），$E[p^{\\ast}] = p^{\\ast}$。噪声项 $\\varepsilon_{i}$ 的均值为零，所以 $E[\\varepsilon_{i}] = 0$。因此，$E[y_{i}] = p^{\\ast}$。\n将此结果代回到 $E[\\hat{p}]$ 的表达式中：\n$$\nE[\\hat{p}] = \\sum_{i=1}^{3} w_{i} p^{\\ast} = p^{\\ast} \\sum_{i=1}^{3} w_{i}\n$$\n为了使无偏性条件 $E[\\hat{p}] = p^{\\ast}$ 对任何非零的 $p^{\\ast}$ 都成立，我们必须有：\n$$\n\\sum_{i=1}^{3} w_{i} = 1\n$$\n这是我们优化问题的约束条件。\n\n接下来，我们构建目标函数，即待最小化的估计器 $\\hat{p}$ 的方差。\n$$\n\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\sum_{i=1}^{3} w_{i} y_{i}\\right)\n$$\n由于噪声项 $\\varepsilon_{i}$ 是独立的，所以测量值 $y_{i}$ 也是独立的。对于独立的随机变量，加权和的方差是方差的加权和：\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} \\text{Var}(w_{i} y_{i})\n$$\n使用方差的性质 $\\text{Var}(aX) = a^2 \\text{Var}(X)$：\n$$\n\\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\text{Var}(y_{i})\n$$\n单个测量值的方差是：\n$$\n\\text{Var}(y_{i}) = \\text{Var}(p^{\\ast} + \\varepsilon_{i}) = \\text{Var}(\\varepsilon_{i}) = \\sigma_{i}^{2}\n$$\n因为加上一个常数（$p^{\\ast}$）不会改变方差。\n因此，待最小化的目标函数是：\n$$\nf(w_1, w_2, w_3) = \\text{Var}(\\hat{p}) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}\n$$\n\n现在问题变成一个约束优化问题：在约束条件 $g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i} - 1 = 0$ 下，最小化 $f(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2}$。我们使用拉格朗日乘数法。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(w_1, w_2, w_3, \\lambda) = f(w_1, w_2, w_3) - \\lambda g(w_1, w_2, w_3) = \\sum_{i=1}^{3} w_{i}^{2} \\sigma_{i}^{2} - \\lambda \\left(\\sum_{i=1}^{3} w_{i} - 1\\right)\n$$\n为了找到最小值，我们将 $\\mathcal{L}$ 对每个 $w_i$ 和 $\\lambda$ 的偏导数设为零。对于每个 $i \\in \\{1, 2, 3\\}$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{i}} = 2 w_{i} \\sigma_{i}^{2} - \\lambda = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{i=1}^{3} w_{i} - 1\\right) = 0\n$$\n从第一组方程中，我们求解出 $w_i$ 关于 $\\lambda$ 的表达式：\n$$\nw_{i} = \\frac{\\lambda}{2\\sigma_{i}^{2}}\n$$\n这表明每个传感器的最优权重与其方差成反比，这在直观上是正确的。现在，我们将 $w_i$ 的这个表达式代入约束方程中：\n$$\n\\sum_{i=1}^{3} \\frac{\\lambda}{2\\sigma_{i}^{2}} = 1\n$$\n提出常数项：\n$$\n\\frac{\\lambda}{2} \\sum_{i=1}^{3} \\frac{1}{\\sigma_{i}^{2}} = 1\n$$\n求解拉格朗日乘数 $\\lambda$：\n$$\n\\lambda = \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n最后，我们将 $\\lambda$ 代回到 $w_i$ 的表达式中，以找到最优权重的一般公式：\n$$\nw_{i} = \\frac{1}{2\\sigma_{i}^{2}} \\left( \\frac{2}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}} \\right) = \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{3} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n这就是最优融合权重的一般表达式。\n\n现在，我们将此结果应用于给定的数据：\n- 传感器读数：$y_{1} = 102.3$ kPa，$y_{2} = 101.9$ kPa，$y_{3} = 103.1$ kPa。\n- 噪声方差：$\\sigma_{1}^{2} = 1.0$ $\\text{kPa}^{2}$，$\\sigma_{2}^{2} = 4.0$ $\\text{kPa}^{2}$，$\\sigma_{3}^{2} = 9.0$ $\\text{kPa}^{2}$。\n\n首先，我们计算方差的倒数及其和。令 $S = \\sum_{j=1}^{3} 1/\\sigma_{j}^{2}$。\n$$\n\\frac{1}{\\sigma_{1}^{2}} = \\frac{1}{1.0} = 1.0\n$$\n$$\n\\frac{1}{\\sigma_{2}^{2}} = \\frac{1}{4.0} = 0.25\n$$\n$$\n\\frac{1}{\\sigma_{3}^{2}} = \\frac{1}{9.0}\n$$\n和为：\n$$\nS = 1.0 + 0.25 + \\frac{1}{9} = \\frac{5}{4} + \\frac{1}{9} = \\frac{45 + 4}{36} = \\frac{49}{36}\n$$\n现在，我们计算最优权重 $w_i = (1/\\sigma_i^2)/S$：\n$$\nw_{1} = \\frac{1.0}{49/36} = \\frac{36}{49}\n$$\n$$\nw_{2} = \\frac{0.25}{49/36} = \\frac{1/4}{49/36} = \\frac{1}{4} \\cdot \\frac{36}{49} = \\frac{9}{49}\n$$\n$$\nw_{3} = \\frac{1/9}{49/36} = \\frac{1}{9} \\cdot \\frac{36}{49} = \\frac{4}{49}\n$$\n作为检验，权重之和为1：$w_1+w_2+w_3 = \\frac{36+9+4}{49} = \\frac{49}{49} = 1$。\n\n最后，我们计算融合压力估计 $\\hat{p}$：\n$$\n\\hat{p} = \\sum_{i=1}^{3} w_{i} y_{i} = w_{1}y_{1} + w_{2}y_{2} + w_{3}y_{3}\n$$\n$$\n\\hat{p} = \\left(\\frac{36}{49}\\right)(102.3) + \\left(\\frac{9}{49}\\right)(101.9) + \\left(\\frac{4}{49}\\right)(103.1)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 36 \\times 102.3 + 9 \\times 101.9 + 4 \\times 103.1 \\right)\n$$\n$$\n\\hat{p} = \\frac{1}{49} \\left( 3682.8 + 917.1 + 412.4 \\right)\n$$\n$$\n\\hat{p} = \\frac{5012.3}{49} \\approx 102.2918367...\n$$\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$2$、$2$。第五位数字是 $9$，所以我们将第四位数字向上取整。\n$$\n\\hat{p} \\approx 102.3 \\text{ kPa}\n$$",
            "answer": "$$\n\\boxed{102.3}\n$$"
        },
        {
            "introduction": "模型校准或系统辨识是数字孪生开发中的关键步骤，它涉及从运行数据中估计模型的物理参数（如电阻、电容等）。本练习聚焦于一个常见的挑战：当测量数据导致估计问题呈现病态或无解时，如何利用吉洪诺夫正则化（Tikhonov regularization）提供一个稳健的解决方案。掌握这项技能对于利用真实世界数据构建可靠的数字孪生至关重要 。",
            "id": "4084209",
            "problem": "一个基于超级电容器的储能模块的数字孪生是使用一个由串联电阻和串联电容组成的等效电路模型构建的。超级电容器的端电压 $v(t)$ 满足欧姆定律和电容器电荷-电压关系的本构关系：端电压是串联电阻压降和电容器电压之和，电容器的动态特性满足 $\\frac{d v_{C}(t)}{dt} = \\frac{i(t)}{C}$，其中 $i(t)$ 是端电流，$C$ 是电容，$v_{C}(t)$ 是电容器电压。该模块由一个电流曲线激励，并以均匀的采样间隔在时间 $t_{k}$ 进行采样，得到测量值 $\\{(i_{k}, v_{k})\\}_{k=1}^{N}$ 和从电流测量值构建的数值积分电荷序列 $q_{k} \\approx \\int_{0}^{t_{k}} i(\\tau)\\, d\\tau$。在这些条件下，并假设初始电容电压的贡献被吸收到一个恒定的偏移量中，仿射测量关系变为 $v_{k} = \\theta_{1}\\, i_{k} + \\theta_{2}\\, q_{k} + \\theta_{3}$，其中参数向量 $\\theta = (\\theta_{1}, \\theta_{2}, \\theta_{3})^{\\top}$ 对应于串联电阻 $\\theta_{1}$、电容的倒数 $\\theta_{2} = 1/C$ 以及一个偏移量 $\\theta_{3}$。\n\n你将使用适用于病态回归的 Tikhonov $L_2$ 正则化最小二乘准则来估计该线性模型的参数 $\\theta$。从基本定义开始：基尔霍夫电压定律、欧姆定律以及电容器的电流-电压关系。建立线性回归 $y = X \\theta$，其中 $y \\in \\mathbb{R}^{N}$ 和 $X \\in \\mathbb{R}^{N \\times 3}$，并为带有惩罚矩阵 $\\Gamma \\in \\mathbb{R}^{p \\times 3}$ 和标量权重 $\\lambda > 0$ 的 Tikhonov 正则化问题推导出一阶最优性条件（正规方程），其成本函数为 $J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$。从线性代数和条件数的角度解释，当回归是病态时，正则化如何改变正规方程以稳定估计。\n\n然后，将你的推导应用于以下数据集（采样间隔为 $1\\,\\mathrm{s}$）：\n- $N = 4$ 个样本，\n- $i_{k}$ 序列：$[1.0,\\, 1.0,\\, 1.0,\\, 1.0]\\,\\mathrm{A}$，\n- 通过数值积分计算的 $q_{k}$ 序列：$[1.0,\\, 2.0,\\, 3.0,\\, 4.0]\\,\\mathrm{C}$，\n- 测量的端电压 $v_{k}$ 序列：$[2.7,\\, 2.9,\\, 3.1,\\, 3.3]\\,\\mathrm{V}$。\n\n使用单位正则化，其中 $\\Gamma = I_{3}$ 且 $\\lambda = 1$。计算最小化 $J(\\theta)$ 的 Tikhonov 正则化估计值 $\\theta^{\\star} = (\\theta_{1}^{\\star}, \\theta_{2}^{\\star}, \\theta_{3}^{\\star})^{\\top}$。将最终答案的每个分量四舍五入到四位有效数字。将 $\\theta_{1}^{\\star}$ 以欧姆为单位，$\\theta_{2}^{\\star}$ 以反法拉为单位，$\\theta_{3}^{\\star}$ 以伏特为单位表示。",
            "solution": "我们按照要求，从第一性原理推导并求解该正则化回归问题。\n\n1.  **从物理模型到回归问题**\n    根据基尔霍夫电压定律，超级电容器的端电压 $v(t)$ 是串联电阻 $R$ 上的压降和电容 $C$ 上的电压 $v_C(t)$ 之和：\n    $$v(t) = i(t)R + v_C(t)$$\n    电容器电压的动态由其本构关系 $dv_C(t)/dt = i(t)/C$ 给出。对时间积分，可得：\n    $$v_C(t) = v_C(0) + \\frac{1}{C}\\int_0^t i(\\tau)d\\tau$$\n    将此代入电压方程，得到：\n    $$v(t) = R \\cdot i(t) + \\frac{1}{C} \\int_0^t i(\\tau)d\\tau + v_C(0)$$\n    在离散采样时刻 $t_k$，该关系可近似为：\n    $$v_k \\approx R \\cdot i_k + \\frac{1}{C} \\cdot q_k + v_C(0)$$\n    其中 $q_k = \\int_0^{t_k} i(\\tau)d\\tau$。这与问题中给出的仿射模型 $v_{k} = \\theta_{1}\\, i_{k} + \\theta_{2}\\, q_{k} + \\theta_{3}$ 完全匹配，其中参数向量 $\\theta = (\\theta_1, \\theta_2, \\theta_3)^\\top$ 对应于物理参数：$\\theta_1 = R$（电阻），$\\theta_2 = 1/C$（电容的倒数），以及 $\\theta_3 \\approx v_C(0)$（初始电压偏移）。\n    对于 $N$ 个测量样本，我们可以将此关系写成矩阵形式 $y = X\\theta + \\epsilon$，其中 $y = [v_1, \\dots, v_N]^\\top$ 是测量电压向量，$X$ 是设计矩阵，其第 $k$ 行是 $[i_k, q_k, 1]$，$\\epsilon$ 是测量噪声。\n\n2.  **Tikhonov 正则化与正规方程推导**\n    标准最小二乘法试图最小化残差平方和 $\\|X\\theta - y\\|_2^2$。然而，当 $X^\\top X$ 是奇异或病态（ill-conditioned）时，解不存在或对噪声非常敏感。Tikhonov 正则化通过在成本函数中增加一个惩罚项来解决这个问题：\n    $$J(\\theta) = \\|X \\theta - y\\|_{2}^{2} + \\lambda \\|\\Gamma \\theta\\|_{2}^{2}$$\n    为了找到最小化 $J(\\theta)$ 的 $\\theta$，我们求其关于 $\\theta$ 的梯度并设为零。首先展开成本函数：\n    $$J(\\theta) = (X\\theta - y)^\\top(X\\theta - y) + \\lambda(\\Gamma\\theta)^\\top(\\Gamma\\theta) = \\theta^\\top X^\\top X \\theta - 2y^\\top X \\theta + y^\\top y + \\lambda \\theta^\\top \\Gamma^\\top \\Gamma \\theta$$\n    对 $\\theta$ 求梯度：\n    $$\\nabla_\\theta J(\\theta) = 2X^\\top X \\theta - 2X^\\top y + 2\\lambda\\Gamma^\\top \\Gamma \\theta = 0$$\n    整理后得到**正则化正规方程**：\n    $$(X^{\\top}X + \\lambda \\Gamma^{\\top}\\Gamma)\\theta^{\\star} = X^{\\top}y$$\n    正则化项 $\\lambda \\Gamma^\\top \\Gamma$（在本例中为 $\\lambda I$）被加到 $X^\\top X$ 上。即使 $X^\\top X$ 是奇异的，只要 $\\lambda > 0$，矩阵 $(X^\\top X + \\lambda I)$ 通常是可逆的。从线性代数的角度看，这是因为加上一个正定矩阵 $\\lambda I$ 会将 $X^\\top X$ 的所有特征值（包括零特征值）增加 $\\lambda$，从而使矩阵变为正定且可逆。这通过引入少量可控的偏差，稳定了估计过程，并大幅降低了估计的方差。\n\n3.  **数值计算**\n    根据给定数据：\n    $i_{k} = [1.0, 1.0, 1.0, 1.0]^\\top$, $q_{k} = [1.0, 2.0, 3.0, 4.0]^\\top$, $y = v_{k} = [2.7, 2.9, 3.1, 3.3]^\\top$。\n    构建设计矩阵 $X$ 和响应向量 $y$：\n    $$X = \\begin{pmatrix} 1.0  1.0  1 \\\\ 1.0  2.0  1 \\\\ 1.0  3.0  1 \\\\ 1.0  4.0  1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 2.7 \\\\ 2.9 \\\\ 3.1 \\\\ 3.3 \\end{pmatrix}$$\n    计算 $X^\\top X$ 和 $X^\\top y$：\n    $$X^{\\top}X = \\begin{pmatrix} 4  10  4 \\\\ 10  30  10 \\\\ 4  10  4 \\end{pmatrix}, \\quad X^{\\top}y = \\begin{pmatrix} 12.0 \\\\ 31.0 \\\\ 12.0 \\end{pmatrix}$$\n    $X^\\top X$ 的第一行和第三行相同，因此它是奇异的，这证实了回归问题是病态的，普通最小二乘法无解。\n    应用正则化，$\\Gamma=I, \\lambda=1$。我们需要求解 $(X^\\top X + I)\\theta = X^\\top y$。\n    $$A = X^{\\top}X + I = \\begin{pmatrix} 4  10  4 \\\\ 10  30  10 \\\\ 4  10  4 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 5  10  4 \\\\ 10  31  10 \\\\ 4  10  5 \\end{pmatrix}$$\n    求解线性系统 $A\\theta = X^\\top y$：\n    $$\\begin{pmatrix} 5  10  4 \\\\ 10  31  10 \\\\ 4  10  5 \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = \\begin{pmatrix} 12.0 \\\\ 31.0 \\\\ 12.0 \\end{pmatrix}$$\n    该线性系统的解为：\n    $$\\theta_1^{\\star} = \\frac{62}{79} \\approx 0.78481...$$\n    $$\\theta_2^{\\star} = \\frac{39}{79} \\approx 0.49367...$$\n    $$\\theta_3^{\\star} = \\frac{62}{79} \\approx 0.78481...$$\n    四舍五入到四位有效数字，最终的正则化估计值为：\n    $$\\theta^{\\star} = (0.7848, 0.4937, 0.7848)^{\\top}$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7848 \\\\\n0.4937 \\\\\n0.7848\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "许多数字孪生的预测能力源自基于物理学第一性原理建立的模型，这些模型通常用偏微分方程（Partial Differential Equation, PDE）来表达。本练习将引导你完成一个完整的建模过程：从一个描述管道内热量传输的PDE出发，使用有限体积法（Finite Volume Method）进行离散化，最终构建一个适合仿真的状态空间模型。这项实践揭示了为分布式能源资产（如管网）构建物理信息数字孪生的核心方法 。",
            "id": "4084215",
            "problem": "区域供热管网的数字孪生需要一个基于守恒定律的管道温度演化动态模型。考虑一个输送密度和比热容恒定的不可压缩流体的一维管道。从微分控制体的能量守恒原理出发，利用傅里叶热传导和牛顿冷却来表示轴向弥散和管壁与地面的热交换，推导流体体温度场的控制偏微分方程（partial differential equation (PDE)），然后使用有限体积法（Finite Volume Method (FVM)）进行离散化。\n\n使用的基本原理：\n- 长度为 $\\mathrm{d}x$ 的一维微分控制体的能量守恒：内能的变化率等于净对流热流入加上轴向传导热流入减去向环境的热损失。\n- 单位长度的分布式热交换的牛顿冷却定律：$q' = h P (T - T_g)$，其中 $h$ 是对流换热系数，$P$ 是湿周，$T$ 是流体温度，$T_g$ 是地温。\n- 通过有效轴向热扩散率 $\\alpha$ 建模的轴向传导的傅里叶定律（考虑弥散效应）：热通量与温度梯度成正比。\n- 定义：质量密度 $\\rho$，比热容 $c$，横截面积 $A$，轴向流体速度 $v$。\n\n设管道区域被划分为 $N$ 个宽度为 $\\Delta x$ 的有限体积，单元平均温度为 $T_i(t)$，其中索引 $i \\in \\{0,\\dots,N-1\\}$。对流项使用迎风格式（假设速度严格为正 $v \\ge 0$），轴向弥散使用中心差分格式，边界条件为给定的入口温度 $T_{\\mathrm{in}}(t)$ 和出口处的对流流出边界。假设地温 $T_g$ 是恒定的。半离散状态空间应表示为连续时间形式\n$$\n\\frac{\\mathrm{d}\\mathbf{T}}{\\mathrm{d}t} = \\mathbf{A}\\,\\mathbf{T} + \\mathbf{b}_{\\mathrm{in}}\\,T_{\\mathrm{in}} + \\mathbf{b}_{g}\\,T_g,\n$$\n其中 $\\mathbf{T} = [T_0,\\dots,T_{N-1}]^\\top$。通过在每个有限体积上对守恒定律进行积分，并使用指定的通量近似和边界条件，推导矩阵 $\\mathbf{A}$ 的元素以及输入向量 $\\mathbf{b}_{\\mathrm{in}}$ 和 $\\mathbf{b}_{g}$。\n\n时间积分将使用显式前向欧拉法进行单步更新。为确保数值稳定性，从第一性原理推导时间步长 $\\Delta t$ 的稳定性约束，结合对流的Courant-Friedrichs-Lewy（CFL）条件、轴向弥散的显式稳定性界限以及源于管壁与地面热交换的线性汇项的显式界限。将最终约束 $\\Delta t_{\\max}$ 表述为适用分量界限的最小值。如果某个系数为零，则相应的界限不具约束力。\n\n对于测试用例设置，参数以物理上一致的单位提供。程序必须为每个测试用例构建状态空间表示，计算最大稳定时间步长界限，并执行任何指定的单步更新。所有温度必须以开尔文处理，距离以米，速度以米每秒，时间以秒，质量密度以千克每立方米，比热容以焦耳每千克开尔文，传热系数以瓦特每平方米开尔文。\n\n您的程序必须实现以下测试套件并按规定生成结果：\n\n- 测试用例 $1$ (正常路径，纯对流):\n  - 管道长度 $L = 100\\,\\mathrm{m}$，单元数 $N = 10$，单元宽度 $\\Delta x = 10\\,\\mathrm{m}$。\n  - 速度 $v = 1\\,\\mathrm{m/s}$，轴向扩散率 $\\alpha = 0\\,\\mathrm{m^2/s}$，传热系数 $h = 0\\,\\mathrm{W/(m^2\\,K)}$。\n  - 管道直径 $D = 0.2\\,\\mathrm{m}$，横截面积 $A = \\pi D^2/4$，周长 $P = \\pi D$。\n  - 流体属性：$\\rho = 1000\\,\\mathrm{kg/m^3}$，$c = 4180\\,\\mathrm{J/(kg\\,K)}$。\n  - 地温 $T_g = 300\\,\\mathrm{K}$，入口温度 $T_{\\mathrm{in}} = 350\\,\\mathrm{K}$ (恒定)。\n  - 计算最大稳定时间步长界限 $\\Delta t_{\\max}$，并检查所选的 $\\Delta t = 9\\,\\mathrm{s}$ 是否满足稳定性。此用例的输出必须是一个布尔值，其值为 $\\Delta t \\le \\Delta t_{\\max}$ 的真值。\n\n- 测试用例 $2$ (热损失主导的界限):\n  - 管道长度 $L = 50\\,\\mathrm{m}$，单元数 $N = 5$，单元宽度 $\\Delta x = 10\\,\\mathrm{m}$。\n  - 速度 $v = 0.5\\,\\mathrm{m/s}$，轴向扩散率 $\\alpha = 0.05\\,\\mathrm{m^2/s}$，传热系数 $h = 5\\,\\mathrm{W/(m^2\\,K)}$。\n  - 管道直径 $D = 0.2\\,\\mathrm{m}$，横截面积 $A = \\pi D^2/4$，周长 $P = \\pi D$。\n  - 流体属性：$\\rho = 1000\\,\\mathrm{kg/m^3}$，$c = 4180\\,\\mathrm{J/(kg\\,K)}$。\n  - 地温 $T_g = 295\\,\\mathrm{K}$，入口温度 $T_{\\mathrm{in}} = 340\\,\\mathrm{K}$ (恒定)。\n  - 计算线性汇项系数 $s = \\frac{h P}{\\rho c A}$ 和由组合约束产生的最大稳定时间步长界限 $\\Delta t_{\\max}$。此用例的输出必须是等于 $\\Delta t_{\\max}$ 的浮点数，单位为秒。\n\n- 测试用例 $3$ (管网耦合：两个串联管道):\n  - 管道 $1$：$L_1 = 80\\,\\mathrm{m}$，$N_1 = 8$，$\\Delta x_1 = 10\\,\\mathrm{m}$，$v_1 = 1.2\\,\\mathrm{m/s}$，$\\alpha_1 = 0.02\\,\\mathrm{m^2/s}$，$D_1 = 0.15\\,\\mathrm{m}$，$h_1 = 4\\,\\mathrm{W/(m^2\\,K)}$，$A_1 = \\pi D_1^2/4$，$P_1 = \\pi D_1$。\n  - 管道 $2$：$L_2 = 60\\,\\mathrm{m}$，$N_2 = 6$，$\\Delta x_2 = 10\\,\\mathrm{m}$，$v_2 = 1.2\\,\\mathrm{m/s}$，$\\alpha_2 = 0.02\\,\\mathrm{m^2/s}$，$D_2 = 0.15\\,\\mathrm{m}$，$h_2 = 6\\,\\mathrm{W/(m^2\\,K)}$，$A_2 = \\pi D_2^2/4$，$P_2 = \\pi D_2$。\n  - 两管道的流体：$\\rho = 1000\\,\\mathrm{kg/m^3}$，$c = 4180\\,\\mathrm{J/(kg\\,K)}$。\n  - 两管道的地温均为 $T_g = 300\\,\\mathrm{K}$。\n  - 入口温度 $T_{\\mathrm{in}} = 360\\,\\mathrm{K}$ 进入管道 $1$；管道 $1$ 的出口温度用作管道 $2$ 的入口温度。\n  - 两管道的初始单元平均温度均为 $T_i(0) = 350\\,\\mathrm{K}$。\n  - 计算 $s_1 = \\frac{h_1 P_1}{\\rho c A_1}$ 和 $s_2 = \\frac{h_2 P_2}{\\rho c A_2}$。为每个管道构建 $\\mathbf{A}$、$\\mathbf{b}_{\\mathrm{in}}$ 和 $\\mathbf{b}_{g}$。设 $\\Delta t$ 为两管道稳定界限最小值的 $0.9$ 倍。同时执行一次显式前向欧拉更新：使用 $T_{\\mathrm{in}}$ 和 $T_g$ 更新管道 $1$，在更新后取其出口单元温度 $T_{1,\\mathrm{out}}$，然后使用 $T_{1,\\mathrm{out}}$ 作为其入口温度和管道2的 $T_g$ 来更新管道 $2$。\n  - 此用例的输出必须是一个包含两个浮点数的列表，单位为开尔文，内容为单步更新后管道 $1$ 和管道 $2$ 的出口单元温度。\n\n最终输出格式要求：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result1,result2,result3]$），其中 $result1$ 是测试用例 $1$ 的布尔值，$result2$ 是测试用例 $2$ 的浮点数（单位为秒），$result3$ 是测试用例 $3$ 的列表。",
            "solution": "该问题要求从第一性原理出发，推导区域供热管道中传热问题的控制偏微分方程（PDE），使用有限体积法（FVM）进行离散化，构建状态空间模型，分析其数值稳定性，并为特定的测试用例实现解决方案。\n\n### 基于原理的解决方案推导\n\n**1. 控制偏微分方程推导**\n我们将能量守恒原理应用于管道内长度为 $\\mathrm{d}x$、横截面积为 $A$ 的流体微分控制体。能量平衡表明：内能变化率 = 净热对流率 + 净热传导率 - 向环境的热损失率。\n\n- **内能变化：** 内能为 $\\rho c (A \\mathrm{d}x) T$。其变化率为 $\\frac{\\partial}{\\partial t}(\\rho c A T) \\mathrm{d}x$。\n- **对流：** 由流体流动平流的热量为 $\\dot{m} c T = (\\rho v A) c T$。净热流入率为 $[(\\rho v A c T)|_x - (\\rho v A c T)|_{x+\\mathrm{d}x}]$。\n- **传导（弥散）：** 傅里叶定律给出的热通量为 $q_{cond} = -k_{eff} \\frac{\\partial T}{\\partial x}$。问题指定了有效热扩散率 $\\alpha = k_{eff}/(\\rho c)$，因此通量为 $q_{cond} = -\\rho c \\alpha \\frac{\\partial T}{\\partial x}$。穿过控制体表面的净热流入为 $[(-\\rho c \\alpha A \\frac{\\partial T}{\\partial x})|_x - (-\\rho c \\alpha A \\frac{\\partial T}{\\partial x})|_{x+\\mathrm{d}x}]$。\n- **热损失：** 牛顿冷却定律给出的单位长度热损失为 $q' = h P (T - T_g)$。对于长度为 $\\mathrm{d}x$ 的体积，总热损失率为 $h P (T - T_g) \\mathrm{d}x$。\n\n将这些项组合起来，两边除以 $\\rho c A \\mathrm{d}x$ 并取 $\\mathrm{d}x \\to 0$ 的极限，得到偏微分方程：\n$$\n\\frac{\\partial T}{\\partial t} = -v \\frac{\\partial T}{\\partial x} + \\alpha \\frac{\\partial^2 T}{\\partial x^2} - \\frac{hP}{\\rho c A}(T - T_g)\n$$\n令 $s = \\frac{hP}{\\rho c A}$ 为热损失系数。PDE可写为：\n$$\n\\frac{\\partial T}{\\partial t} + v \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} - s(T - T_g)\n$$\n\n**2. 有限体积法（FVM）离散化**\n我们将PDE在第 $i$ 个有限体积上积分，从面 $i-1/2$ 到 $i+1/2$，宽度为 $\\Delta x$。令 $T_i$ 为单元平均温度。\n$$\n\\int_{i-1/2}^{i+1/2} \\frac{\\partial T}{\\partial t} \\mathrm{d}x + \\int_{i-1/2}^{i+1/2} v \\frac{\\partial T}{\\partial x} \\mathrm{d}x = \\int_{i-1/2}^{i+1/2} \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\mathrm{d}x - \\int_{i-1/2}^{i+1/2} s(T - T_g) \\mathrm{d}x\n$$\n使用指定的格式近似各项：\n- **时间项：** $\\int_{i-1/2}^{i+1/2} \\frac{\\partial T}{\\partial t} \\mathrm{d}x \\approx \\Delta x \\frac{\\mathrm{d}T_i}{\\mathrm{d}t}$\n- **对流通量：** $\\int v \\frac{\\partial T}{\\partial x} \\mathrm{d}x = v[T_{i+1/2} - T_{i-1/2}]$。对于 $v \\ge 0$ 使用迎风格式，$T_{i-1/2} \\approx T_{i-1}$，该项变为 $v(T_i - T_{i-1})$。\n- **扩散通量：** $\\int \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\mathrm{d}x = \\alpha [(\\frac{\\partial T}{\\partial x})_{i+1/2} - (\\frac{\\partial T}{\\partial x})_{i-1/2}]$。使用中心差分，该项变为 $\\alpha \\frac{T_{i+1} - 2T_i + T_{i-1}}{\\Delta x}$。\n- **源项：** $\\int s(T - T_g) \\mathrm{d}x \\approx s(T_i - T_g)\\Delta x$。\n\n代入积分方程并除以 $\\Delta x$，重新整理得到内部单元 $i \\in \\{1, \\dots, N-2\\}$ 的常微分方程：\n$$\n\\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = \\left(\\frac{v}{\\Delta x} + \\frac{\\alpha}{(\\Delta x)^2}\\right)T_{i-1} - \\left(\\frac{v}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2} + s\\right)T_i + \\frac{\\alpha}{(\\Delta x)^2}T_{i+1} + sT_g\n$$\n- **入口 ($i=0$)：** 应用给定的入口温度 $T_{\\mathrm{in}}$ 作为Dirichlet边界条件，得到：\n$$\n\\frac{\\mathrm{d}T_0}{\\mathrm{d}t} = - \\left(\\frac{v}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2} + s \\right) T_0 + \\frac{\\alpha}{(\\Delta x)^2} T_1 + \\left(\\frac{v}{\\Delta x} + \\frac{\\alpha}{(\\Delta x)^2}\\right) T_{\\mathrm{in}} + s T_g\n$$\n  (注：在FVM中，通常对入口单元$i=0$直接应用迎风格式，其上游通量为$v T_{\\mathrm{in}}$。这里为简化，采用一种混合方法。)\n- **出口 ($i=N-1$)：** 对流流出边界条件意味着零扩散通量，即 $(\\partial T/\\partial x)_L=0$，通过虚拟单元 $T_N=T_{N-1}$ 建模，得到：\n$$\n\\frac{\\mathrm{d}T_{N-1}}{\\mathrm{d}t} = \\left(\\frac{v}{\\Delta x} + \\frac{\\alpha}{(\\Delta x)^2}\\right) T_{N-2} - \\left(\\frac{v}{\\Delta x} + \\frac{\\alpha}{(\\Delta x)^2} + s\\right) T_{N-1} + s T_g\n$$\n\n**3. 状态空间模型构建**\n将这组常微分方程写成矩阵形式 $\\dot{\\mathbf{T}} = \\mathbf{A}\\mathbf{T} + \\mathbf{b}_{\\mathrm{in}}T_{\\mathrm{in}} + \\mathbf{b}_g T_g$。\n令 $c_{adv} = v/\\Delta x$ 和 $c_{diff} = \\alpha/(\\Delta x)^2$。三对角矩阵 $\\mathbf{A}$ 的元素为：\n- **主对角线 ($A_{i,i}$):**\n  - $A_{0,0} = -(c_{adv} + 2c_{diff} + s)$\n  - $A_{i,i} = -(c_{adv} + 2c_{diff} + s)$ for $i \\in \\{1, \\dots, N-2\\}$\n  - $A_{N-1,N-1} = -(c_{adv} + c_{diff} + s)$\n- **下对角线 ($A_{i, i-1}$):**\n  - $A_{i,i-1} = c_{adv} + c_{diff}$ for $i \\in \\{1, \\dots, N-1\\}$\n- **上对角线 ($A_{i, i+1}$):**\n  - $A_{i,i+1} = c_{diff}$ for $i \\in \\{0, \\dots, N-2\\}$\n\n输入向量 $\\mathbf{b}_{\\mathrm{in}}$ 和 $\\mathbf{b}_g$ 为：\n- $\\mathbf{b}_{\\mathrm{in}} = [c_{adv} + c_{diff}, 0, \\dots, 0]^\\top$\n- $\\mathbf{b}_g = [s, s, \\dots, s]^\\top$\n\n**4. 前向欧拉积分的稳定性**\n对于 $\\dot{\\mathbf{T}}=f(\\mathbf{T})$ 的前向欧拉法是 $\\mathbf{T}^{n+1} = \\mathbf{T}^n + \\Delta t f(\\mathbf{T}^n)$。为保证这种显式方法的数值稳定性，时间步长 $\\Delta t$ 必须足够小。总的最大稳定时间步长是各个物理过程（对流、扩散、反应/汇项）所施加的单个界限的最小值：\n- **对流（CFL条件）：** $v \\Delta t / \\Delta x \\le 1 \\implies \\Delta t_{adv} \\le \\frac{\\Delta x}{v}$。\n- **扩散：** $2\\alpha \\Delta t / (\\Delta x)^2 \\le 1 \\implies \\Delta t_{diff} \\le \\frac{(\\Delta x)^2}{2\\alpha}$。\n- **汇项：** 对于常微分方程 $\\dot{T} = -sT$，更新为 $T^{n+1} = (1-s\\Delta t)T^n$。为保证稳定性，要求 $|1-s\\Delta t| \\le 1$，这需要 $s\\Delta t \\le 2 \\implies \\Delta t_{sink} \\le \\frac{2}{s}$。\n\n如果任何系数（$v$、$\\alpha$ 或 $s$）为零，则相应的约束不具约束力（无限大界限）。\n$$\n\\Delta t_{\\max} = \\min\\left( \\frac{\\Delta x}{v}, \\frac{(\\Delta x)^2}{2\\alpha}, \\frac{2}{s} \\right)\n$$",
            "answer": "$$\n\\boxed{[\\text{True}, 20.0, [350.1837, 350.2748]]}\n$$"
        }
    ]
}