{
    "hands_on_practices": [
        {
            "introduction": "掌握模糊控制的核心在于理解其完整的推理过程。本练习将引导你逐步完成一个经典的 Mamdani 模糊推理系统计算，该系统用于控制暖通空调（HVAC）的风扇速度 。通过这个实践，你将学会如何从语言规则和模糊输入出发，经过规则激活、蕴涵、聚合，最终通过质心法（centroid defuzzification）得到一个精确的控制输出值，这是将模糊逻辑应用于实际控制问题的基础。",
            "id": "4092336",
            "problem": "在一个由 Mamdani 模糊推理系统 (FIS) 建模的供暖、通风和空调 (HVAC) 能量控制模块中，目标是基于两个输入语言评估来计算一个清晰的风扇速度指令：“温度高”的隶属度为 $0.6$，“湿度中等”的隶属度为 $0.4$。假设如下：\n\n- 规则库（三条规则）：\n  1. 如果温度高，则风扇速度高。\n  2. 如果湿度中等，则风扇速度中等。\n  3. 如果温度高且湿度中等，则风扇速度高。\n\n- 推理和聚合约定：\n  - 逻辑“与”通过最小算子建模。\n  - 蕴含通过最小算子进行截断建模。\n  - 对后件的聚合通过最大算子建模。\n\n- 风扇速度 $s$ 的输出论域是闭区间 $[0,100]$（解释为 $0$到$100$的指令标度）。输出隶属函数定义如下：\n  - 中等 (三角形):\n    $$\n    \\mu_{\\text{med}}(s) = \\begin{cases}\n    \\dfrac{s-30}{20},  30 \\le s \\le 50 \\\\\n    \\dfrac{70 - s}{20},  50  s \\le 70 \\\\\n    0,  \\text{其它情况}\n    \\end{cases}\n    $$\n  - 高 (三角形):\n    $$\n    \\mu_{\\text{high}}(s) = \\begin{cases}\n    \\dfrac{s - 60}{20},  60 \\le s \\le 80 \\\\\n    \\dfrac{100 - s}{20},  80  s \\le 100 \\\\\n    0,  \\text{其它情况}\n    \\end{cases}\n    $$\n\n- 解模糊化采用质心（面积中心）法：\n  $$s^{\\ast} \\;=\\; \\dfrac{\\displaystyle \\int_{0}^{100} s\\, \\mu_{\\text{agg}}(s)\\, ds}{\\displaystyle \\int_{0}^{100} \\mu_{\\text{agg}}(s)\\, ds},$$\n  其中 $\\mu_{\\text{agg}}(s)$ 是经过规则评估、蕴含和聚合后的聚合输出隶属函数。\n\n使用给定的输入隶属度 $0.6$（对于“温度高”）和 $0.4$（对于“湿度中等”），应用 Mamdani 推理和最小-最大聚合，并计算质心 $s^{\\ast}$。将最终数值结果四舍五入到四位有效数字。将结果报告为 $0$–$100$ 标度上的一个标量值（不包括百分号）。",
            "solution": "该问题是 Mamdani 模糊推理的一个适定应用。它具有科学依据，内容自洽，并且有唯一解。我们开始求解。\n\n该过程包括五个步骤：\n1.  评估规则前件（激活强度）。\n2.  将蕴含应用于后件。\n3.  聚合规则输出。\n4.  使用质心法进行解模糊化。\n\n给定的输入是语言变量的隶属度：\n-   “温度高”的隶属度为 $d_T = 0.6$。\n-   “湿度中等”的隶属度为 $d_H = 0.4$。\n\n风扇速度 $s \\in [0, 100]$ 的输出隶属函数为：\n-   中等: $\\mu_{\\text{med}}(s)$\n-   高: $\\mu_{\\text{high}}(s)$\n\n算子为：\n-   与: 最小, $\\min(a,b)$。\n-   蕴含 (截断): 最小, $\\min(a,b)$。\n-   聚合: 最大, $\\max(a,b)$。\n\n**步骤 1: 规则激活强度**\n\n我们计算三条规则中每条规则的激活强度 $w_i$。\n-   **规则 1:** “如果温度高，则风扇速度高。”\n    激活强度是前件（“温度高”）为真的程度。\n    $$w_1 = d_T = 0.6$$\n-   **规则 2:** “如果湿度中等，则风扇速度中等。”\n    激活强度是前件（“湿度中等”）为真的程度。\n    $$w_2 = d_H = 0.4$$\n-   **规则 3:** “如果温度高且湿度中等，则风扇速度高。”\n    前件通过逻辑“与”组合了两个命题，该逻辑“与”通过最小算子建模。\n    $$w_3 = \\min(d_T, d_H) = \\min(0.6, 0.4) = 0.4$$\n\n**步骤 2: 蕴含**\n\n蕴含方法是使用最小算子进行截断。每条规则的输出是一个模糊集，通过在规则激活强度的水平上裁剪后件的隶属函数得到。\n-   **规则 1 输出:** $\\mu_1(s) = \\min(w_1, \\mu_{\\text{high}}(s)) = \\min(0.6, \\mu_{\\text{high}}(s))$。\n-   **规则 2 输出:** $\\mu_2(s) = \\min(w_2, \\mu_{\\text{med}}(s)) = \\min(0.4, \\mu_{\\text{med}}(s))$。\n-   **规则 3 输出:** $\\mu_3(s) = \\min(w_3, \\mu_{\\text{high}}(s)) = \\min(0.4, \\mu_{\\text{high}}(s))$。\n\n**步骤 3: 聚合**\n\n使用最大算子聚合各条规则的输出，形成输出变量的单个模糊集 $\\mu_{\\text{agg}}(s)$。\n$$\\mu_{\\text{agg}}(s) = \\max(\\mu_1(s), \\mu_2(s), \\mu_3(s))$$\n我们观察到，对于任何 $s$ 值，$\\mu_{\\text{high}}(s) \\ge 0$。由于 $0.4  0.6$，因此 $\\min(0.4, \\mu_{\\text{high}}(s)) \\le \\min(0.6, \\mu_{\\text{high}}(s))$。所以，对于所有 $s$，$\\mu_3(s) \\le \\mu_1(s)$。这意味着在最大聚合步骤中，规则 3 被规则 1 所包涵，因此 $\\max(\\mu_1(s), \\mu_3(s)) = \\mu_1(s)$。聚合函数简化为：\n$$\\mu_{\\text{agg}}(s) = \\max(\\mu_1(s), \\mu_2(s)) = \\max(\\min(0.6, \\mu_{\\text{high}}(s)), \\min(0.4, \\mu_{\\text{med}}(s)))$$\n为了分段定义此函数，我们首先分析被截断的组件。\n-   对于 $\\min(0.4, \\mu_{\\text{med}}(s))$: $\\mu_{\\text{med}}(s)$ 在 $s=30+20(0.4)=38$ 和 $s=70-20(0.4)=62$ 处达到值 $0.4$。\n-   对于 $\\min(0.6, \\mu_{\\text{high}}(s))$: $\\mu_{\\text{high}}(s)$ 在 $s=60+20(0.6)=72$ 和 $s=100-20(0.6)=88$ 处达到值 $0.6$。\n\n聚合隶属函数 $\\mu_{\\text{agg}}(s)$ 通过取两个截断模糊集的逐点最大值来分段定义：\n$$\n\\mu_{\\text{agg}}(s) = \\begin{cases}\n\\dfrac{s-30}{20},  30 \\le s  38 \\\\\n0.4,  38 \\le s  62 \\\\\n\\dfrac{70-s}{20},  62 \\le s  65 \\\\\n\\dfrac{s-60}{20},  65 \\le s  72 \\\\\n0.6,  72 \\le s  88 \\\\\n\\dfrac{100-s}{20},  88 \\le s \\le 100 \\\\\n0,  \\text{其它情况}\n\\end{cases}\n$$\n通过令 $\\frac{70-s}{20} = \\frac{s-60}{20}$，可以找到在 $s=65$ 处的切换点，这得出 $130 = 2s$，所以 $s=65$。\n\n**步骤 4: 解模糊化**\n\n我们使用质心法找到清晰输出 $s^*$：\n$$s^{\\ast} = \\frac{\\displaystyle \\int_{0}^{100} s\\, \\mu_{\\text{agg}}(s)\\, ds}{\\displaystyle \\int_{0}^{100} \\mu_{\\text{agg}}(s)\\, ds} = \\frac{M}{A}$$\n我们通过在定义域 $[0, 100]$ 的适当分区上积分来计算面积 $A$ 和面积一阶矩 $M$。\n\n分母 (面积, $A$):\n$A = \\int_{30}^{38} \\frac{s-30}{20} ds + \\int_{38}^{62} 0.4 ds + \\int_{62}^{65} \\frac{70-s}{20} ds + \\int_{65}^{72} \\frac{s-60}{20} ds + \\int_{72}^{88} 0.6 ds + \\int_{88}^{100} \\frac{100-s}{20} ds$\n这些积分对应于两个三角形、两个矩形和两个梯形的面积，我们可以将它们组合起来。\n$A_1 = \\frac{1}{2}(38-30)(0.4) = 1.6$\n$A_2 = (62-38)(0.4) = 9.6$\n$A_3 = \\frac{1}{2}(65-62)(0.4 + 0.25) = \\frac{1}{2}(3)(0.65) = 0.975$\n$A_4 = \\frac{1}{2}(72-65)(0.25 + 0.6) = \\frac{1}{2}(7)(0.85) = 2.975$\n$A_5 = (88-72)(0.6) = 9.6$\n$A_6 = \\frac{1}{2}(100-88)(0.6) = 3.6$\n总面积: $A = 1.6 + 9.6 + 0.975 + 2.975 + 9.6 + 3.6 = 28.35$\n\n分子 (面积一阶矩, $M$):\n$M = \\int_{30}^{100} s \\mu_{\\text{agg}}(s) ds$。我们可以通过计算每个几何子形状的面积一阶矩之和来计算它，$M_i = A_i c_i$，其中 $c_i$ 是每个形状的质心。\n$M_1 = \\int_{30}^{38} s \\frac{s-30}{20} ds = \\frac{1}{20}[\\frac{s^3}{3}-15s^2]_{30}^{38} = \\frac{3392}{60} \\approx 56.533$\n$M_2 = \\int_{38}^{62} 0.4 s ds = 0.2[s^2]_{38}^{62} = 480$\n$M_3 = \\int_{62}^{65} s \\frac{70-s}{20} ds = \\frac{1}{20}[35s^2-\\frac{s^3}{3}]_{62}^{65} = 61.8$\n$M_4 = \\int_{65}^{72} s \\frac{s-60}{20} ds = \\frac{1}{20}[\\frac{s^3}{3}-30s^2]_{65}^{72} = \\frac{12313}{60} \\approx 205.217$\n$M_5 = \\int_{72}^{88} 0.6 s ds = 0.3[s^2]_{72}^{88} = 768$\n$M_6 = \\int_{88}^{100} s \\frac{100-s}{20} ds = \\frac{1}{20}[50s^2-\\frac{s^3}{3}]_{88}^{100} = 331.2$\n总面积一阶矩: $M \\approx 56.533 + 480 + 61.8 + 205.217 + 768 + 331.2 = 1902.75$。\n使用精确分数，$M = \\frac{3392}{60} + \\frac{28800}{60} + \\frac{3708}{60} + \\frac{12313}{60} + \\frac{46080}{60} + \\frac{19872}{60} = \\frac{114165}{60} = \\frac{7611}{4} = 1902.75$。\n\n质心计算:\n$$s^{\\ast} = \\frac{M}{A} = \\frac{1902.75}{28.35} = \\frac{7611/4}{567/20} = \\frac{7611}{4} \\cdot \\frac{20}{567} = \\frac{7611 \\cdot 5}{567} = \\frac{12685}{189}$$\n$$s^{\\ast} \\approx 67.116402...$$\n四舍五入到四位有效数字，我们得到 $s^{\\ast} = 67.12$。",
            "answer": "$$\\boxed{67.12}$$"
        },
        {
            "introduction": "与 Mamdani 模型不同，Takagi-Sugeno-Kang (TSK) 或 Sugeno 模型在规则的结论部分使用数学函数，这使其在计算上更为高效。本练习聚焦于一个为电池储能系统设计充电电流的 Sugeno 控制器 。你将实践如何利用规则的激活强度（firing strengths）和线性结论函数，通过加权平均法直接计算出最终的清晰控制设定值，这种方法在需要自适应和在线优化的能源控制应用中尤为常见。",
            "id": "4092340",
            "problem": "一个锂离子电池储能系统使用一个双规则 Takagi–Sugeno–Kang (TSK) 模糊控制器来生成充电电流设定点，单位为 C-rate（无量纲，定义为每小时额定容量的倍数）。控制器的输入变量是充电状态 (SOC) 和一个归一化的电池包温度，其中 $\\text{SOC} \\in [0,1]$ 且 $\\text{Temp} \\in [0,1]$。这两条规则具有一阶线性后件，由 $y_1 = 0.5 - 0.3 \\cdot \\text{SOC}$ 和 $y_2 = 0.6 - 0.5 \\cdot \\text{Temp}$ 给出。在对前件进行模糊化和 t-范数聚合后得到的规则激发强度为 $w_1 = 0.68$ 和 $w_2 = 0.31$。对于工作点 $\\text{SOC} = 0.42$ 和 $\\text{Temp} = 0.65$，使用带有归一化激发强度的 Sugeno 推理的正式定义来确定最终的充电电流设定点。将最终设定点表示为一个以 C-rate 为单位的纯数（无量纲）。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个双规则 Takagi–Sugeno–Kang (TSK) 模糊控制器的输出。该问题被认为是有效的，因为它在控制理论中有科学依据，问题设定良好、客观，并为唯一解提供了所有必要信息。\n\nTSK 模糊推理系统的输出，通常称为解模糊输出，是根据各个规则后件输出的加权平均值计算得出的。权重是相应规则的激发强度。对于一个有 $N$ 条规则的系统，最终输出 $y$ 由以下公式给出：\n$$\ny = \\frac{\\sum_{i=1}^{N} w_i y_i}{\\sum_{i=1}^{N} w_i}\n$$\n其中 $w_i$ 是第 $i$ 条规则的激发强度，$y_i$ 是第 $i$ 条规则的后件函数在当前输入值下的评价值。这个公式内在地使用了归一化的激发强度。\n\n问题提供了以下信息：\n- 规则数量，$N = 2$。\n- 输入变量为充电状态 $\\text{SOC}$ 和归一化温度 $\\text{Temp}$。\n- 具体工作点为 $\\text{SOC} = 0.42$ 和 $\\text{Temp} = 0.65$。\n- 两条规则的后件函数是一阶线性方程：\n  - 规则 1：$y_1 = 0.5 - 0.3 \\cdot \\text{SOC}$\n  - 规则 2：$y_2 = 0.6 - 0.5 \\cdot \\text{Temp}$\n- 在此工作点，规则的激发强度为：\n  - 规则 1：$w_1 = 0.68$\n  - 规则 2：$w_2 = 0.31$\n\n首先，我们在给定的工作点评估后件函数 $y_1$ 和 $y_2$。\n\n对于规则 1，我们将 $\\text{SOC} = 0.42$ 代入 $y_1$ 的表达式中：\n$$\ny_1 = 0.5 - 0.3 \\cdot (0.42)\n$$\n$$\ny_1 = 0.5 - 0.126\n$$\n$$\ny_1 = 0.374\n$$\n\n对于规则 2，我们将 $\\text{Temp} = 0.65$ 代入 $y_2$ 的表达式中：\n$$\ny_2 = 0.6 - 0.5 \\cdot (0.65)\n$$\n$$\ny_2 = 0.6 - 0.325\n$$\n$$\ny_2 = 0.275\n$$\n\n接下来，我们应用加权平均公式计算最终输出 $y$。分子是激发强度与其对应后件值的乘积之和，分母是激发强度之和。\n\n分子是 $\\sum_{i=1}^{2} w_i y_i = w_1 y_1 + w_2 y_2$：\n$$\nw_1 y_1 + w_2 y_2 = (0.68)(0.374) + (0.31)(0.275)\n$$\n$$\nw_1 y_1 + w_2 y_2 = 0.25432 + 0.08525\n$$\n$$\nw_1 y_1 + w_2 y_2 = 0.33957\n$$\n\n分母是激发强度的总和，$\\sum_{i=1}^{2} w_i = w_1 + w_2$：\n$$\nw_1 + w_2 = 0.68 + 0.31\n$$\n$$\nw_1 + w_2 = 0.99\n$$\n\n最后，我们通过将分子除以分母来计算输出 $y$：\n$$\ny = \\frac{0.33957}{0.99}\n$$\n$$\ny \\approx 0.342999...\n$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3$、$4$、$2$ 和 $9$。第五位有效数字是 $9$，大于或等于 $5$，所以我们将第四位有效数字向上取整。\n$$\ny \\approx 0.3430\n$$\n该值代表以 C-rate 为单位的充电电流设定点。",
            "answer": "$$\\boxed{0.3430}$$"
        },
        {
            "introduction": "模糊逻辑的强大之处不仅在于处理不确定性，还在于其为复杂的多目标决策问题提供了优雅的框架。本练习将挑战你解决一个能源系统中的经济调度问题，目标是在满足电力需求的同时，最小化一个由成本和排放的模糊“不满意度”构成的加权目标函数 $J(p_1, p_2)$ 。这个实践要求你将模糊集理论与优化方法相结合，通过编程实现一个决策模型，这代表了模糊推理在高级能源管理策略中的实际应用。",
            "id": "4092404",
            "problem": "考虑一个由模糊逻辑控制的能源系统中的双发电机经济调度问题。设决策变量为每小时调度中发电机1和2的输出功率 $p_1$ 和 $p_2$，单位为兆瓦 (MW)。物理和经济量定义如下：\n- 功率平衡为 $p_1 + p_2 = D$，其中 $D$ 是需求，单位为 MW。\n- 发电机 $i$ 的出力限制为 $p_i^{\\min} \\le p_i \\le p_i^{\\max}$，单位为 MW。\n- 每小时总成本为 $C = c_1 p_1 + c_2 p_2$，单位为美元/小时 ($\\$$/h)，其中 $c_1$ 和 $c_2$ 是恒定的边际成本，单位为美元/兆瓦时 ($\\$$/MWh)，并且调度是按小时进行的。\n- 每小时总排放量为 $E = e_1 p_1 + e_2 p_2$，单位为千克/小时 (kg/h)，其中 $e_1$ 和 $e_2$ 是恒定的单位排放量，单位为千克/兆瓦时 (kg/MWh)，并且调度是按小时进行的。\n\n模糊控制中的近似推理使用模糊集和隶属函数来量化满意度。成本满意度隶属函数为 $\\mu_c(C)$，排放满意度隶属函数为 $\\mu_e(E)$。每个隶属函数都由一系列点 $(x_k, y_k)$ 定义的分段线性曲线指定，其中 $x_k$ 是 $C$ 或 $E$，而 $y_k \\in [0,1]$ 代表满意度。隶属函数通过给定点之间的线性插值定义，并在极值点之外保持恒定（即，低于第一个 $x$ 值时等于第一个 $y$ 值，高于最后一个 $x$ 值时等于最后一个 $y$ 值）。模糊不满意度是满意度的补集，因此不满意度贡献分别为成本的 $1 - \\mu_c(C)$ 和排放的 $1 - \\mu_e(E)$。\n\n总体目标是模糊不满意度的加权和，\n$$\nJ(p_1, p_2) = w_c \\left(1 - \\mu_c(C)\\right) + w_e \\left(1 - \\mu_e(E)\\right),\n$$\n其中 $w_c \\ge 0$ 和 $w_e \\ge 0$ 是权重，且 $w_c + w_e = 1$。\n\n目标是计算最优调度 $(p_1^\\star, p_2^\\star)$，以最小化 $J(p_1, p_2)$，同时满足功率平衡和发电机出力限制。使用基于所述定义的纯数学和逻辑推理。将 $p_1^\\star$ 和 $p_2^\\star$ 以 MW 表示，将 $J^\\star$ 表示为无量纲浮点数。所有输出必须四舍五入到三位小数。\n\n为确保科学真实性，所有测试用例均使用以下恒定发电机参数：\n- 发电机 1：$p_1^{\\min} = 50$, $p_1^{\\max} = 200$, $c_1 = 30$ $\\$$/MWh, $e_1 = 900$ kg/MWh。\n- 发电机 2：$p_2^{\\min} = 30$, $p_2^{\\max} = 200$, $c_2 = 40$ $\\$$/MWh, $e_2 = 400$ kg/MWh。\n\n您的程序必须为以下每个测试用例求解优化问题。对于每个测试用例，隶属函数由断点给出。将每个点列表解释为 $x_k$ 递增的有序对 $(x_k, y_k)$；在点之间进行线性插值，并在极值范围外进行钳位。\n\n测试套件：\n- 案例 1 (常规成功路径):\n  - 需求: $D = 180$ MW。\n  - 权重: $w_c = 0.5$, $w_e = 0.5$。\n  - 成本隶属度点: $\\{(5500, 1.0), (6500, 0.6), (8000, 0.0)\\}$，单位 $\\$$/h。\n  - 排放隶属度点: $\\{(60000, 1.0), (75000, 0.4), (90000, 0.0)\\}$，单位 kg/h。\n- 案例 2 (在总最小出力下边界可行):\n  - 需求: $D = 80$ MW。\n  - 权重: $w_c = 0.5$, $w_e = 0.5$。\n  - 成本隶属度点: $\\{(5500, 1.0), (6500, 0.6), (8000, 0.0)\\}$，单位 $\\$$/h。\n  - 排放隶属度点: $\\{(60000, 1.0), (75000, 0.4), (90000, 0.0)\\}$，单位 kg/h。\n- 案例 3 (成本权重占优):\n  - 需求: $D = 180$ MW。\n  - 权重: $w_c = 0.9$, $w_e = 0.1$。\n  - 成本隶属度点: $\\{(5500, 1.0), (6500, 0.6), (8000, 0.0)\\}$，单位 $\\$$/h。\n  - 排放隶属度点: $\\{(60000, 1.0), (75000, 0.4), (90000, 0.0)\\}$，单位 kg/h。\n- 案例 4 (排放权重占优):\n  - 需求: $D = 180$ MW。\n  - 权重: $w_c = 0.1$, $w_e = 0.9$。\n  - 成本隶属度点: $\\{(5500, 1.0), (6500, 0.6), (8000, 0.0)\\}$，单位 $\\$$/h。\n  - 排放隶属度点: $\\{(60000, 1.0), (75000, 0.4), (90000, 0.0)\\}$，单位 kg/h。\n- 案例 5 (在可行范围内排放满意度存在平台区且成本目标改变):\n  - 需求: $D = 280$ MW。\n  - 权重: $w_c = 0.5$, $w_e = 0.5$。\n  - 成本隶属度点: $\\{(9000, 1.0), (10000, 0.7), (13000, 0.0)\\}$，单位 $\\$$/h。\n  - 排放隶属度点: $\\{(140000, 1.0), (160000, 1.0), (220000, 0.0)\\}$，单位 kg/h。\n\n最终输出格式:\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是 $[p_1^\\star, p_2^\\star, J^\\star]$ 形式的列表，所有数字均四舍五入到三位小数；例如，`[[p_1^\\star, p_2^\\star, J^\\star], \\dots]`。\n- 所有发电机的输出必须以 MW 为单位报告，目标函数值必须是无量纲的。\n\n注意：不需要线性规划 (LP) 或其他求解器；您必须根据分段线性隶属函数和线性调度约束的定义和结构直接实现逻辑。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **决策变量**：发电机输出 $p_1$ 和 $p_2$，单位为兆瓦 (MW)。\n- **功率平衡约束**：$p_1 + p_2 = D$，其中 $D$ 是需求，单位为 MW。\n- **发电机出力限制**：$p_i^{\\min} \\le p_i \\le p_i^{\\max}$，其中 $i \\in \\{1, 2\\}$。\n- **总成本函数**：$C = c_1 p_1 + c_2 p_2$，单位为美元/小时 ($\\$$/h)。$c_i$ 是边际成本，单位为 $\\$$/MWh。\n- **总排放函数**：$E = e_1 p_1 + e_2 p_2$，单位为千克/小时 (kg/h)。$e_i$ 是单位排放量，单位为 kg/MWh。\n- **隶属函数**：$\\mu_c(C)$ 和 $\\mu_e(E)$ 是由一系列点 $(x_k, y_k)$ 定义的分段线性函数，其中 $y_k \\in [0,1]$ 是满意度水平。点之间使用线性插值，值在极值点之外被钳位。\n- **目标函数**：最小化模糊不满意度的加权和，$J(p_1, p_2) = w_c \\left(1 - \\mu_c(C)\\right) + w_e \\left(1 - \\mu_e(E)\\right)$。\n- **权重**：$w_c \\ge 0$，$w_e \\ge 0$，且 $w_c + w_e = 1$。\n- **目标**：找到最优调度 $(p_1^\\star, p_2^\\star)$ 和最小目标值 $J^\\star$。\n- **恒定参数**：\n  - 发电机 1：$p_1^{\\min} = 50$ MW, $p_1^{\\max} = 200$ MW, $c_1 = 30$ $\\$$/MWh, $e_1 = 900$ kg/MWh。\n  - 发电机 2：$p_2^{\\min} = 30$ MW, $p_2^{\\max} = 200$ MW, $c_2 = 40$ $\\$$/MWh, $e_2 = 400$ kg/MWh。\n- **测试用例**：提供了五个不同的案例，每个案例指定了 $D$、$w_c$、$w_e$ 以及 $\\mu_c(C)$ 和 $\\mu_e(E)$ 的断点。\n- **输出格式**：一个列表的列表 $[[p_1^\\star, p_2^\\star, J^\\star], \\dots]$，所有数字四舍五入到三位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学基础**：该问题是电力系统工程中一个成熟的经济调度问题，并增加了一个基于模糊逻辑的多目标优化框架。模糊逻辑是处理此类问题的有效数学工具。成本和排放函数是线性的，这是一种常见且有效的简化。给定的参数是合理的。该问题具有科学基础。\n- **适定性**：该问题涉及在一个紧凑（闭合且有界）可行集上最小化一个连续函数。决策空间可以简化为单个变量 $p_1$。目标函数 $J$ 成为 $p_1$ 的一个连续分段线性函数。根据极值定理，一个在紧凑集上的连续函数保证能达到其最小值。一个分段线性函数的最小值必然出现在可行区间的边界点或函数斜率改变的“断点”之一。这种结构确保了解的存在性，并且可以通过评估有限数量的点来找到解。所有测试用例中的总需求 $D$ 都在发电机的总容量范围 $[p_1^{\\min}+p_2^{\\min}, p_1^{\\max}+p_2^{\\max}] = [80, 400]$ MW 之内，确保了非空可行集。该问题是适定的。\n- **客观性**：问题陈述使用了精确的数学定义和客观、可验证的数据。它没有主观或基于意见的主张。\n- **缺陷分析**：\n  - 不存在科学或事实上的不健全之处。\n  - 问题定义正式且切题。\n  - 设置完整且一致。\n  - 条件和数据是现实和可行的。\n  - 问题结构良好，不是病态问题。\n  - 问题并非微不足道；它需要一种系统化的方法来构建和最小化一个分段目标函数。\n  - 结果是科学上可验证的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n### 解题推导\n这个双变量优化问题可以通过使用功率平衡约束简化为单变量问题。\n\n**1. 单变量问题重构**\n根据功率平衡方程 $p_1 + p_2 = D$，我们将 $p_2$ 表示为 $p_1$ 的函数：\n$$p_2 = D - p_1$$\n我们将其代入成本和排放函数，使其仅为 $p_1$ 的函数：\n$$C(p_1) = c_1 p_1 + c_2 (D - p_1) = (c_1 - c_2) p_1 + c_2 D$$\n$$E(p_1) = e_1 p_1 + e_2 (D - p_1) = (e_1 - e_2) p_1 + e_2 D$$\n使用给定的常数 $c_1=30$, $c_2=40$, $e_1=900$, 和 $e_2=400$：\n$$C(p_1) = (30 - 40) p_1 + 40D = -10 p_1 + 40D$$\n$$E(p_1) = (500 - 400) p_1 + 400D = 500 p_1 + 400D$$\n需要最小化的目标函数是 $J(p_1) = w_c (1 - \\mu_c(C(p_1))) + w_e (1 - \\mu_e(E(p_1)))$。\n\n**2. 确定 $p_1$ 的可行域**\n决策变量 $p_1$ 受到两台发电机运行限制的约束：\n- $p_1^{\\min} \\le p_1 \\le p_1^{\\max} \\implies 50 \\le p_1 \\le 200$\n- $p_2^{\\min} \\le p_2 \\le p_2^{\\max} \\implies 30 \\le D - p_1 \\le 200 \\implies D - 200 \\le p_1 \\le D - 30$\n综合这些， $p_1$ 的可行域是一个闭区间 $[P_{1,\\text{min}}, P_{1,\\text{max}}]$，其中：\n$$P_{1,\\text{min}} = \\max(50, D - 200)$$\n$$P_{1,\\text{max}} = \\min(200, D - 30)$$\n\n**3. 优化策略**\n目标函数 $J(p_1)$ 是一个关于 $p_1$ 的连续分段线性函数。这是因为 $C(p_1)$ 和 $E(p_1)$ 是 $p_1$ 的线性函数，隶属函数 $\\mu_c$ 和 $\\mu_e$ 是分段线性的，而 $J$ 是这些函数的线性组合。这样一个函数在闭区间 $[P_{1,\\text{min}}, P_{1,\\text{max}}]$ 上的最小值保证在以下候选点之一处取得：\n- 可行区间的端点：$P_{1,\\text{min}}$ 和 $P_{1,\\text{max}}$。\n- 分段函数的“断点”，这些点对应于 $C(p_1)$ 或 $E(p_1)$ 穿过其各自隶属函数断点 $x_k$ 时的 $p_1$ 值。\n\n成本隶属函数的断点发生在 $p_1$ 的某个值使得 $C(p_1) = C_k$（对于某个成本断点 $C_k$）。求解 $p_1$：\n$$p_{1,k}^c = \\frac{C_k - c_2 D}{c_1 - c_2} = \\frac{C_k - 40D}{-10}$$\n类似地，排放隶属函数的断点发生在 $E(p_1) = E_k$ 时：\n$$p_{1,k}^e = \\frac{E_k - e_2 D}{e_1 - e_2} = \\frac{E_k - 400D}{500}$$\n最优 $p_1$ 的候选点集由可行区间的端点和所有严格位于可行区间 $(P_{1,\\text{min}}, P_{1,\\text{max}})$ 的断点 $\\{p_{1,k}^c\\}$、$\\{p_{1,k}^e\\}$ 的并集构成。\n\n每个测试用例的算法如下：\n1.  计算可行区间 $[P_{1,\\text{min}}, P_{1,\\text{max}}]$。如果区间退化为单点，则该点即为解。\n2.  用 $\\{P_{1,\\text{min}}, P_{1,\\text{max}}\\}$ 初始化候选点集。\n3.  对于测试用例数据中的每个成本断点 $C_k$，计算相应的 $p_{1,k}^c$。如果 $P_{1,\\text{min}}  p_{1,k}^c  P_{1,\\text{max}}$，则将其添加到候选点集。\n4.  对于每个排放断点 $E_k$，计算相应的 $p_{1,k}^e$。如果 $P_{1,\\text{min}}  p_{1,k}^e  P_{1,\\text{max}}$，则将其添加到候选点集。\n5.  遍历唯一的候选点集。对于每个候选点 $p_{1,cand}$：\n    a. 计算 $C(p_{1,cand})$ 和 $E(p_{1,cand})$。\n    b. 根据给定的断点数据，使用分段线性插值找到 $\\mu_c(C(p_{1,cand}))$ 和 $\\mu_e(E(p_{1,cand}))$。\n    c. 评估 $J(p_{1,cand}) = w_c (1 - \\mu_c) + w_e (1 - \\mu_e)$。\n6.  最优值 $p_1^\\star$ 是产生最小 $J$ 值的候选点。相应的 $p_2^\\star$ 是 $D - p_1^\\star$，$J^\\star$ 是最小目标值。\n7.  最终结果四舍五入到三位小数。\n\n此过程保证能找到给定问题结构的全局最小值。实现将使用 `numpy.interp` 进行分段线性插值，该函数能正确处理超出定义范围的钳位操作。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fuzzy economic dispatch problem for a set of test cases.\n    \"\"\"\n    # Constant generator parameters\n    P1_MIN, P1_MAX = 50.0, 200.0\n    P2_MIN, P2_MAX = 30.0, 200.0\n    C1, C2 = 30.0, 40.0\n    E1, E2 = 900.0, 400.0\n    \n    # Test suite\n    test_cases = [\n        # Case 1: general happy path\n        {\n            \"D\": 180.0, \"wc\": 0.5, \"we\": 0.5,\n            \"cost_points\": [(5500, 1.0), (6500, 0.6), (8000, 0.0)],\n            \"emission_points\": [(60000, 1.0), (75000, 0.4), (90000, 0.0)]\n        },\n        # Case 2: boundary feasibility at lower total minimum\n        {\n            \"D\": 80.0, \"wc\": 0.5, \"we\": 0.5,\n            \"cost_points\": [(5500, 1.0), (6500, 0.6), (8000, 0.0)],\n            \"emission_points\": [(60000, 1.0), (75000, 0.4), (90000, 0.0)]\n        },\n        # Case 3: dominant cost weight\n        {\n            \"D\": 180.0, \"wc\": 0.9, \"we\": 0.1,\n            \"cost_points\": [(5500, 1.0), (6500, 0.6), (8000, 0.0)],\n            \"emission_points\": [(60000, 1.0), (75000, 0.4), (90000, 0.0)]\n        },\n        # Case 4: dominant emission weight\n        {\n            \"D\": 180.0, \"wc\": 0.1, \"we\": 0.9,\n            \"cost_points\": [(5500, 1.0), (6500, 0.6), (8000, 0.0)],\n            \"emission_points\": [(60000, 1.0), (75000, 0.4), (90000, 0.0)]\n        },\n        # Case 5: plateau in emission satisfaction\n        {\n            \"D\": 280.0, \"wc\": 0.5, \"we\": 0.5,\n            \"cost_points\": [(9000, 1.0), (10000, 0.7), (13000, 0.0)],\n            \"emission_points\": [(140000, 1.0), (160000, 1.0), (220000, 0.0)]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        D = case[\"D\"]\n        wc = case[\"wc\"]\n        we = case[\"we\"]\n        cost_points = case[\"cost_points\"]\n        emission_points = case[\"emission_points\"]\n\n        # 1. Determine feasible domain for p1\n        p1_feasible_min = max(P1_MIN, D - P2_MAX)\n        p1_feasible_max = min(P1_MAX, D - P2_MIN)\n\n        if p1_feasible_min > p1_feasible_max:\n             # This case should not occur based on problem validation\n             # but is good practice to handle.\n            all_results.append([float('nan'), float('nan'), float('nan')])\n            continue\n\n        # 2. Build the set of candidate points for p1\n        candidate_p1s = {p1_feasible_min, p1_feasible_max}\n\n        # Add cost break points\n        c_p1_denom = C1 - C2\n        if c_p1_denom != 0:\n            for c_k, _ in cost_points:\n                p1_break = (c_k - C2 * D) / c_p1_denom\n                if p1_feasible_min  p1_break  p1_feasible_max:\n                    candidate_p1s.add(p1_break)\n\n        # Add emission break points\n        e_p1_denom = E1 - E2\n        if e_p1_denom != 0:\n            for e_k, _ in emission_points:\n                p1_break = (e_k - E2 * D) / e_p1_denom\n                if p1_feasible_min  p1_break  p1_feasible_max:\n                    candidate_p1s.add(p1_break)\n\n        best_p1, min_J = -1, float('inf')\n        \n        # Prepare for interpolation\n        cost_x = np.array([p[0] for p in cost_points])\n        cost_y = np.array([p[1] for p in cost_points])\n        emission_x = np.array([p[0] for p in emission_points])\n        emission_y = np.array([p[1] for p in emission_points])\n\n        # 3. Evaluate objective function at each candidate point\n        sorted_candidates = sorted(list(candidate_p1s))\n\n        for p1 in sorted_candidates:\n            # Calculate cost and emissions\n            cost = (C1 - C2) * p1 + C2 * D\n            emission = (E1 - E2) * p1 + E2 * D\n            \n            # Calculate satisfaction using linear interpolation\n            mu_c = np.interp(cost, cost_x, cost_y)\n            mu_e = np.interp(emission, emission_x, emission_y)\n            \n            # Calculate total dissatisfaction\n            J = wc * (1 - mu_c) + we * (1 - mu_e)\n            \n            if J  min_J:\n                min_J = J\n                best_p1 = p1\n\n        p1_star = best_p1\n        p2_star = D - p1_star\n        J_star = min_J\n        \n        # Round and append results\n        all_results.append([round(p1_star, 3), round(p2_star, 3), round(J_star, 3)])\n\n    # 4. Format and print the final output\n    print(f\"[\" + \",\".join(map(str, all_results)) + \"]\")\n\nsolve()\n```"
        }
    ]
}