{
    "hands_on_practices": [
        {
            "introduction": "深度学习模型的性能在很大程度上取决于输入特征的质量。在电网监控中，原始测量数据（如频率）通常需要被转换为更具信息量的特征。本练习将带您实践如何从离散的频率采样中计算频率变化率（Rate of Change of Frequency, RoCoF），这是一个关键的电网扰动指标。通过在滑动窗口上应用最小二乘法，您将掌握一项重要的信号处理技术，这是构建任何高级监控与诊断系统不可或缺的预处理步骤 。",
            "id": "4083510",
            "problem": "一个相量测量单元 (PMU) 监测一个标称频率为 $50\\,\\text{Hz}$ 的电力系统的电网频率。PMU 的采样率为每秒 $50$ 个样本，因此每个采样发生在时间 $t_k = k \\times 0.02\\,\\text{s}$（对于整数 $k \\geq 0$）。一个深度学习故障诊断流程结合了一个长短期记忆 (LSTM) 网络和一个基于阈值的预警模块。输入到 LSTM 的一个工程特征是频率变化率 (RoCoF)，对于 PMU 的离散时间测量值，它是在每个采样点通过计算一个包含 $M=5$ 个样本的后随窗口内频率对时间的最佳拟合线（普通最小二乘法）的斜率得出的。\n\n发生了一个事件，由于净发电量跳闸，导致频率呈线性斜坡变化。PMU 报告了以下频率样本，其中斜坡变化从 $t = 0.10\\,\\text{s}$ 开始：\n\n| 索引 (k) | 时间 (t_k) [s] | 频率 (f_k) [Hz] |\n|:---:|:---:|:---:|\n| 0 | 0.00 | 50.000 |\n| 1 | 0.02 | 50.000 |\n| 2 | 0.04 | 50.000 |\n| 3 | 0.06 | 50.000 |\n| 4 | 0.08 | 50.000 |\n| 5 | 0.10 | 50.000 |\n| 6 | 0.12 | 49.988 |\n| 7 | 0.14 | 49.976 |\n| 8 | 0.16 | 49.964 |\n| 9 | 0.18 | 49.952 |\n| 10 | 0.20 | 49.940 |\n| 11 | 0.22 | 49.928 |\n| 12 | 0.24 | 49.916 |\n\n当估计的 RoCoF（计算为最近 $M=5$ 个样本的斜率）的绝对值首次超过阈值 $\\theta = 0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$ 时，基于阈值的预警模块会触发。\n\n从第一性原理出发，使用 RoCoF 作为频率时间导数的定义，及其通过在指定窗口上进行最小二乘斜率计算的离散时间估计，来确定：\n- 在满足阈值条件的最早样本点处的 RoCoF 估计值（单位为 $\\text{Hz}\\cdot \\text{s}^{-1}$）。\n- 最早检测时间（单位为 $\\text{s}$），定义为该样本的时间戳 $t_k$。\n\n将所求的两个量均四舍五入至四位有效数字。以秒为单位表示检测时间。",
            "solution": "该问题要求从一个离散的频率测量序列中计算频率变化率 (RoCoF)。RoCoF 是通过在一个包含 $M=5$ 个样本的后随窗口上使用普通最小二乘 (OLS) 回归来估计最佳拟合线的斜率。我们必须找到第一个时间点 $t_k$，在该时间点，这个估计的 RoCoF 的绝对值超过阈值 $\\theta = 0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n\n首先，让我们建立 OLS 斜率的公式。对于一组 $M$ 个数据点 $(x_i, y_i)$，最佳拟合线 $y = a + bx$ 的斜率 $b$ 由以下公式给出：\n$$\nb = \\frac{M \\sum_{i=1}^{M} x_i y_i - (\\sum_{i=1}^{M} x_i) (\\sum_{i=1}^{M} y_i)}{M \\sum_{i=1}^{M} x_i^2 - (\\sum_{i=1}^{M} x_i)^2}\n$$\n在我们的情况下，数据点是时间和频率，即 $(t_j, f_j)$。时间样本是均匀间隔的，采样周期为 $\\Delta t = 0.02\\,\\text{s}$。这种均匀性使得斜率公式可以被显著简化。\n\n让我们考虑一个在索引 $k$ 处结束的包含 $M=5$ 个样本的窗口。此窗口中的样本索引为从 $k-4$ 到 $k$。为了简化 OLS 公式，我们可以为该窗口定义一个局部的、居中的时间变量。设窗口内的索引为 $j \\in \\{-2, -1, 0, 1, 2\\}$，对应于样本索引 $\\{k-4, k-3, k-2, k-1, k\\}$。相对于窗口中心 ($t_{k-2}$) 的时间坐标是 $\\tau_j = j \\Delta t$。使用这个居中的时间变量，$\\sum \\tau_j = 0$，斜率公式简化为：\n$$\n\\text{RoCoF}_k = b = \\frac{\\sum_{j=-2}^{2} \\tau_j f_{k-2+j}}{\\sum_{j=-2}^{2} \\tau_j^2}\n$$\n对于固定的窗口大小和采样率，分母是一个常数：\n$$\n\\sum_{j=-2}^{2} \\tau_j^2 = \\sum_{j=-2}^{2} (j \\Delta t)^2 = (\\Delta t)^2 \\sum_{j=-2}^{2} j^2 = (\\Delta t)^2 ((-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2) = 10(\\Delta t)^2\n$$\n代入 $\\Delta t = 0.02\\,\\text{s}$，分母为 $10 \\times (0.02)^2 = 10 \\times 0.0004 = 0.004\\,\\text{s}^2$。\n\n分子为：\n$$\n\\sum_{j=-2}^{2} \\tau_j f_{k-2+j} = \\Delta t \\sum_{j=-2}^{2} j f_{k-2+j} = \\Delta t (-2f_{k-4} - 1f_{k-3} + 0f_{k-2} + 1f_{k-1} + 2f_k)\n$$\n结合分子和分母，在样本 $k$ 处的 RoCoF 为：\n$$\n\\text{RoCoF}_k = \\frac{\\Delta t (-2f_{k-4} - f_{k-3} + f_{k-1} + 2f_k)}{10(\\Delta t)^2} = \\frac{-2f_{k-4} - f_{k-3} + f_{k-1} + 2f_k}{10 \\Delta t}\n$$\n因为 $10 \\Delta t = 10 \\times 0.02 = 0.2\\,\\text{s}$，公式变为：\n$$\n\\text{RoCoF}_k = \\frac{1}{0.2} (-2f_{k-4} - f_{k-3} + f_{k-1} + 2f_k) = 5(-2f_{k-4} - f_{k-3} + f_{k-1} + 2f_k)\n$$\n我们现在可以迭代地应用此公式，从第一个可能的窗口（在 $k=4$ 处结束）开始，直到满足条件 $|\\text{RoCoF}_k| > 0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。频率数据 $f_k$ 已给出。\n\n对于 $k  6$，任何 5 样本窗口都只包含频率值为 $50.000\\,\\text{Hz}$ 的样本。常数函数的斜率为零。\n对于 $k=4$，窗口为 $\\{f_0, f_1, f_2, f_3, f_4\\}$，所有值均为 $50.000\\,\\text{Hz}$。因此，$\\text{RoCoF}_4 = 0$。\n对于 $k=5$，窗口为 $\\{f_1, f_2, f_3, f_4, f_5\\}$，所有值均为 $50.000\\,\\text{Hz}$。因此，$\\text{RoCoF}_5 = 0$。\n$|\\text{RoCoF}_k|$ 为 $0$，不大于 $0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n\n对于 $k=6$：窗口样本为 $\\{f_2, f_3, f_4, f_5, f_6\\}$。\n频率：$\\{50.000, 50.000, 50.000, 50.000, 49.988\\}$。\n$$\n\\text{RoCoF}_6 = 5 \\times (-2f_2 - f_3 + f_5 + 2f_6) = 5 \\times [-2(50.000) - 1(50.000) + 1(50.000) + 2(49.988)]\n$$\n$$\n\\text{RoCoF}_6 = 5 \\times [-100.000 + 2(49.988)] = 5 \\times [-100.000 + 99.976] = 5 \\times (-0.024) = -0.12\\,\\text{Hz}\\cdot \\text{s}^{-1}\n$$\n$|\\text{RoCoF}_6| = 0.12\\,\\text{Hz}\\cdot \\text{s}^{-1}$，不大于 $0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n\n对于 $k=7$：窗口样本为 $\\{f_3, f_4, f_5, f_6, f_7\\}$。\n频率：$\\{50.000, 50.000, 50.000, 49.988, 49.976\\}$。\n$$\n\\text{RoCoF}_7 = 5 \\times (-2f_3 - f_4 + f_6 + 2f_7) = 5 \\times [-2(50.000) - 1(50.000) + 1(49.988) + 2(49.976)]\n$$\n$$\n\\text{RoCoF}_7 = 5 \\times [-150.000 + 49.988 + 99.952] = 5 \\times [-150.000 + 149.940] = 5 \\times (-0.060) = -0.30\\,\\text{Hz}\\cdot \\text{s}^{-1}\n$$\n$|\\text{RoCoF}_7| = 0.30\\,\\text{Hz}\\cdot \\text{s}^{-1}$，不大于 $0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n\n对于 $k=8$：窗口样本为 $\\{f_4, f_5, f_6, f_7, f_8\\}$。\n频率：$\\{50.000, 50.000, 49.988, 49.976, 49.964\\}$。\n$$\n\\text{RoCoF}_8 = 5 \\times (-2f_4 - f_5 + f_7 + 2f_8) = 5 \\times [-2(50.000) - 1(50.000) + 1(49.976) + 2(49.964)]\n$$\n$$\n\\text{RoCoF}_8 = 5 \\times [-150.000 + 49.976 + 99.928] = 5 \\times [-150.000 + 149.904] = 5 \\times (-0.096) = -0.48\\,\\text{Hz}\\cdot \\text{s}^{-1}\n$$\n$|\\text{RoCoF}_8| = 0.48\\,\\text{Hz}\\cdot \\text{s}^{-1}$。这个值大于阈值 $0.4\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n这是第一个满足阈值条件的样本索引。\n\n所求的量为：\n1. 此样本处的 RoCoF 估计值：$\\text{RoCoF}_8 = -0.48\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n2. 最早检测时间，即此样本的时间戳：$t_8$。\n时间由 $t_k = k \\times 0.02\\,\\text{s}$ 给出。\n$t_8 = 8 \\times 0.02\\,\\text{s} = 0.16\\,\\text{s}$。\n\n问题要求将两个量都四舍五入到四位有效数字。\n- RoCoF 估计值：$-0.48\\,\\text{Hz}\\cdot \\text{s}^{-1}$ 四舍五入到四位有效数字是 $-0.4800\\,\\text{Hz}\\cdot \\text{s}^{-1}$。\n- 检测时间：$0.16\\,\\text{s}$ 四舍五入到四位有效数字是 $0.1600\\,\\text{s}$。\n因此，最终答案是 $-0.4800$ 和 $0.1600$。",
            "answer": "$$\\boxed{\\begin{pmatrix} -0.4800  0.1600 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在故障诊断等类别极不平衡的应用场景中，评估分类模型的性能极具挑战性，因为传统的准确率指标可能会产生误导。本练习旨在强调在这种情况下选择恰当评估指标的重要性。您将基于一个典型的故障检测混淆矩阵，从头开始计算 F1 分数和马修斯相关系数 (Matthews Correlation Coefficient, MCC)，从而深入理解它们在评估不平衡数据集分类器性能时的独特优势与差异 。",
            "id": "4083465",
            "problem": "一个公用事业规模的配电网由时间同步的相量测量单元（PMU）进行监控，这些单元产生高速率的测量数据。一个卷积神经网络（CNN）被训练用于从带标签的PMU时间窗口中检测暂态线路故障。在为期一周的部署中，CNN对每个时间窗口产生一个二元决策 $X \\in \\{0,1\\}$，而真实标签为 $Y \\in \\{0,1\\}$，其中 $X=1$ 和 $Y=1$ 表示故障窗口。\n\n评估集包含 $N$ 个独立的窗口，具有故障监控中典型的严重类别不平衡：混淆矩阵的计数如下\n- 真阳性 $TP = 600$，\n- 假阳性 $FP = 400$，\n- 假阴性 $FN = 1{,}400$，\n- 真阴性 $TN = 199{,}600$，\n因此窗口总数为 $N = TP + FP + FN + TN = 202{,}000$，正类的基本比率为 $202{,}000$ 分之 $2{,}000$。\n\n仅从第一性原理和适用于分类与相关的核心定义（即，二元随机变量的皮尔逊积矩相关系数定义，以及精确率、召回率和谐波平均值的定义）出发，推导出此二元混淆矩阵的马修斯相关系数（MCC）和F1分数。然后计算给定计数的比率 $\\text{MCC}/\\text{F1}$。\n\n将最终比率表示为无单位的纯数，并将您的答案四舍五入到四位有效数字。",
            "solution": "本题要求计算并比较两个常用的分类评估指标：F1分数和马修斯相关系数 (MCC)，特别是在一个类别不平衡的场景下。\n\n### 1. F1分数的推导与计算\n\nF1分数是精确率 (Precision, P) 和召回率 (Recall, R) 的调和平均数，旨在平衡这两者。\n\n首先，我们定义精确率和召回率：\n-   **精确率 (P)**：在所有被预测为正类的样本中，真正为正类的比例。\n    $$ P = \\frac{TP}{TP + FP} $$\n-   **召回率 (R)**：在所有真正为正类的样本中，被成功预测为正类的比例。\n    $$ R = \\frac{TP}{TP + FN} $$\n\nF1分数作为它们的调和平均数，其公式为：\n$$ F1 = \\frac{2 \\cdot P \\cdot R}{P + R} = \\frac{2 \\cdot \\frac{TP}{TP+FP} \\cdot \\frac{TP}{TP+FN}}{\\frac{TP}{TP+FP} + \\frac{TP}{TP+FN}} = \\frac{2TP}{2TP + FP + FN} $$\n\n使用给定的数值：$TP = 600$, $FP = 400$, $FN = 1{,}400$。\n$$ F1 = \\frac{2 \\times 600}{2 \\times 600 + 400 + 1{,}400} = \\frac{1{,}200}{1{,}200 + 1{,}800} = \\frac{1{,}200}{3{,}000} = 0.4 $$\n\n### 2. 马修斯相关系数 (MCC) 的推导与计算\n\nMCC是衡量二元分类质量的指标，其本质是真实值与预测值之间的皮尔逊相关系数。它考虑了混淆矩阵中的所有四个值（TP, TN, FP, FN），因此在类别不平衡的情况下被认为是一个非常可靠的评估指标。\n\n其公式定义如下：\n$$ \\text{MCC} = \\frac{TP \\cdot TN - FP \\cdot FN}{\\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}} $$\n\n使用给定的数值：$TP = 600$, $FP = 400$, $FN = 1{,}400$, $TN = 199{,}600$。\n\n-   **分子**:\n    $$ TP \\cdot TN - FP \\cdot FN = (600)(199{,}600) - (400)(1{,}400) = 119{,}760{,}000 - 560{,}000 = 119{,}200{,}000 $$\n\n-   **分母**:\n    -   $TP+FP = 600 + 400 = 1{,}000$\n    -   $TP+FN = 600 + 1{,}400 = 2{,}000$\n    -   $TN+FP = 199{,}600 + 400 = 200{,}000$\n    -   $TN+FN = 199{,}600 + 1{,}400 = 201{,}000$\n\n    分母为：\n    $$ \\sqrt{1{,}000 \\times 2{,}000 \\times 200{,}000 \\times 201{,}000} = \\sqrt{8.04 \\times 10^{16}} \\approx 2.835489 \\times 10^8 $$\n\n-   **MCC 值**:\n    $$ \\text{MCC} = \\frac{119{,}200{,}000}{2.835489 \\times 10^8} \\approx \\frac{1.192 \\times 10^8}{2.835489 \\times 10^8} \\approx 0.42038 $$\n\n### 3. 比率 MCC/F1 的计算\n\n最后，我们计算所求的比率：\n$$ \\frac{\\text{MCC}}{\\text{F1}} = \\frac{0.42038}{0.4} \\approx 1.05095 $$\n将结果四舍五入到四位有效数字，得到 **1.051**。",
            "answer": "$$\\boxed{1.051}$$"
        },
        {
            "introduction": "深度学习模型的输出远不止一个简单的分类标签，它可以作为进行复杂概率推断的基础。本练习将向您展示如何将深度神经网络提取的特征与贝叶斯框架相结合，以实现更精细的故障诊断。您将利用一个高斯类条件模型，根据一个给定的潜在特征向量，计算特定故障类型的后验概率，从而学会如何将模型的预测转化为一个更具洞察力和可操作性的概率诊断结果 。",
            "id": "4083436",
            "problem": "一个输电网级别的相量测量单元 (PMU) 在事件期间以高采样率流式传输同步的电流相量。一个经过训练的深度神经网络 (DNN) 编码器将三相电流波形的短窗口映射到一个二维潜在特征向量 $x = [\\Delta |I|, \\Delta \\theta]^{\\top}$，其中 $\\Delta |I|$ 是电流幅值的单位阶跃变化，$\\Delta \\theta$ 是事件发生时以弧度为单位的相角突变。在潜在空间中，使用高斯类条件生成模型进行故障诊断。类别包括正常（无故障）、单相接地、相间和三相，表示为 $\\mathcal{C} \\in \\{\\mathrm{N}, \\mathrm{SLG}, \\mathrm{LL}, 3\\phi\\}$，其先验概率分别为 $\\pi_{\\mathrm{N}} = 0.985$、$\\pi_{\\mathrm{SLG}} = 0.010$、$\\pi_{\\mathrm{LL}} = 0.004$ 和 $\\pi_{3\\phi} = 0.001$。以类别 $c$ 为条件，潜在向量 $x$ 被建模为具有均值 $\\mu_{c}$ 和对角协方差 $\\Sigma_{c} = \\mathrm{diag}(\\sigma_{I,c}^{2}, \\sigma_{\\theta,c}^{2})$ 的二元高斯分布：\n- 对于 $\\mathrm{N}$：$\\mu_{\\mathrm{N}} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{N}} = 0.05$，$\\sigma_{\\theta,\\mathrm{N}} = 0.02$。\n- 对于 $\\mathrm{SLG}$：$\\mu_{\\mathrm{SLG}} = \\begin{bmatrix} 0.8 \\\\ -0.3 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{SLG}} = 0.3$，$\\sigma_{\\theta,\\mathrm{SLG}} = 0.1$。\n- 对于 $\\mathrm{LL}$：$\\mu_{\\mathrm{LL}} = \\begin{bmatrix} 1.2 \\\\ -0.5 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{LL}} = 0.25$，$\\sigma_{\\theta,\\mathrm{LL}} = 0.15$。\n- 对于 $3\\phi$：$\\mu_{3\\phi} = \\begin{bmatrix} 1.6 \\\\ -0.05 \\end{bmatrix}$，$\\sigma_{I,3\\phi} = 0.2$，$\\sigma_{\\theta,3\\phi} = 0.05$。\n\n在一个受监测的母线上模拟的三相故障产生了一个潜在特征测量值 $x^{\\ast} = \\begin{bmatrix} \\Delta |I| \\\\ \\Delta \\theta \\end{bmatrix} = \\begin{bmatrix} 1.55 \\\\ -0.06 \\end{bmatrix}$，其中 $\\Delta |I|$ 以单位值表示，$\\Delta \\theta$ 以弧度表示。在上述高斯类条件模型和先验条件下，计算后验概率 $p(\\mathcal{C} = 3\\phi \\mid x^{\\ast})$。请将最终答案表示为十进制数（无单位），并四舍五入到四位有效数字。",
            "solution": "该问题要求计算给定潜在特征测量值 $x^{\\ast}$ 下的后验概率 $p(\\mathcal{C} = 3\\phi \\mid x^{\\ast})$。这是一个经典的贝叶斯推断问题。我们将使用贝叶斯定理，该定理指出，在给定观测值 $x$ 的情况下，类别 $\\mathcal{C}=c$ 的后验概率与给定该类别下观测值的似然和该类别的先验概率的乘积成正比。\n\n后验概率的公式是：\n$$ p(\\mathcal{C}=c \\mid x) = \\frac{p(x \\mid \\mathcal{C}=c) p(\\mathcal{C}=c)}{p(x)} $$\n其中 $p(x \\mid \\mathcal{C}=c)$ 是类条件似然，$p(\\mathcal{C}=c)$ 是类先验概率，$p(x)$ 是证据的边缘概率。证据项是一个归一化常数，通过使用全概率定律对所有可能的类别求和来计算：\n$$ p(x) = \\sum_{c' \\in \\{\\mathrm{N}, \\mathrm{SLG}, \\mathrm{LL}, 3\\phi\\}} p(x \\mid \\mathcal{C}=c') p(\\mathcal{C}=c') $$\n对于特定类别 $\\mathcal{C} = 3\\phi$ 和测量值 $x^{\\ast}$，后验概率为：\n$$ p(\\mathcal{C}=3\\phi \\mid x^{\\ast}) = \\frac{p(x^{\\ast} \\mid \\mathcal{C}=3\\phi) p(\\mathcal{C}=3\\phi)}{\\sum_{c' \\in \\{\\mathrm{N}, \\mathrm{SLG}, \\mathrm{LL}, 3\\phi\\}} p(x^{\\ast} \\mid \\mathcal{C}=c') p(\\mathcal{C}=c')} $$\n类条件似然 $p(x \\mid \\mathcal{C}=c)$ 是一个具有对角协方差矩阵 $\\Sigma_c = \\mathrm{diag}(\\sigma_{I,c}^{2}, \\sigma_{\\theta,c}^{2})$ 的二元高斯分布 $\\mathcal{N}(x \\mid \\mu_c, \\Sigma_c)$。对于潜在向量 $x = [\\Delta |I|, \\Delta \\theta]^{\\top} \\equiv [x_I, x_\\theta]^{\\top}$，其概率密度函数 (PDF) 为：\n$$ p(x \\mid \\mathcal{C}=c) = \\frac{1}{2\\pi \\sigma_{I,c} \\sigma_{\\theta,c}} \\exp\\left(-\\frac{1}{2}\\left[\\left(\\frac{x_I - \\mu_{I,c}}{\\sigma_{I,c}}\\right)^2 + \\left(\\frac{x_\\theta - \\mu_{\\theta,c}}{\\sigma_{\\theta,c}}\\right)^2\\right]\\right) $$\n令 $U_c = p(x^{\\ast} \\mid \\mathcal{C}=c) p(\\mathcal{C}=c)$ 为类别 $c$ 的未归一化后验概率。则后验概率为 $p(\\mathcal{C}=c \\mid x^{\\ast}) = U_c / \\sum_{c'} U_{c'}$。$1/(2\\pi)$ 项是所有似然中的公因子，将会被约掉。因此，我们可以使用一个成比例的量 $u_c$：\n$$ u_c = \\frac{\\pi_c}{\\sigma_{I,c} \\sigma_{\\theta,c}} \\exp\\left(-\\frac{1}{2} E_c\\right) $$\n其中 $\\pi_c = p(\\mathcal{C}=c)$ 是先验概率，而 $E_c$ 是指数中的马氏距离平方项：\n$$ E_c = \\left(\\frac{x_I^{\\ast} - \\mu_{I,c}}{\\sigma_{I,c}}\\right)^2 + \\left(\\frac{x_\\theta^{\\ast} - \\mu_{\\theta,c}}{\\sigma_{\\theta,c}}\\right)^2 $$\n给定测量值 $x^{\\ast} = \\begin{bmatrix} 1.55 \\\\ -0.06 \\end{bmatrix}$。我们现在为四个类别中的每一个计算 $E_c$ 和 $u_c$。\n\n1.  **正常类别 ($\\mathrm{N}$):**\n    $\\mu_{\\mathrm{N}} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{N}} = 0.05$，$\\sigma_{\\theta,\\mathrm{N}} = 0.02$，$\\pi_{\\mathrm{N}} = 0.985$。\n    $$ E_{\\mathrm{N}} = \\left(\\frac{1.55 - 0}{0.05}\\right)^2 + \\left(\\frac{-0.06 - 0}{0.02}\\right)^2 = 31^2 + (-3)^2 = 961 + 9 = 970 $$\n    $$ u_{\\mathrm{N}} = \\frac{0.985}{0.05 \\times 0.02} \\exp\\left(-\\frac{970}{2}\\right) = 985 \\exp(-485) $$\n    这个值非常小，可以近似为 $0$。\n\n2.  **单相接地类别 ($\\mathrm{SLG}$):**\n    $\\mu_{\\mathrm{SLG}} = \\begin{bmatrix} 0.8 \\\\ -0.3 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{SLG}} = 0.3$，$\\sigma_{\\theta,\\mathrm{SLG}} = 0.1$，$\\pi_{\\mathrm{SLG}} = 0.010$。\n    $$ E_{\\mathrm{SLG}} = \\left(\\frac{1.55 - 0.8}{0.3}\\right)^2 + \\left(\\frac{-0.06 - (-0.3)}{0.1}\\right)^2 = (2.5)^2 + (2.4)^2 = 6.25 + 5.76 = 12.01 $$\n    $$ u_{\\mathrm{SLG}} = \\frac{0.010}{0.3 \\times 0.1} \\exp\\left(-\\frac{12.01}{2}\\right) = \\frac{1}{3} \\exp(-6.005) \\approx 8.2221 \\times 10^{-4} $$\n\n3.  **相间类别 ($\\mathrm{LL}$):**\n    $\\mu_{\\mathrm{LL}} = \\begin{bmatrix} 1.2 \\\\ -0.5 \\end{bmatrix}$，$\\sigma_{I,\\mathrm{LL}} = 0.25$，$\\sigma_{\\theta,\\mathrm{LL}} = 0.15$，$\\pi_{\\mathrm{LL}} = 0.004$。\n    $$ E_{\\mathrm{LL}} = \\left(\\frac{1.55 - 1.2}{0.25}\\right)^2 + \\left(\\frac{-0.06 - (-0.5)}{0.15}\\right)^2 = (1.4)^2 + \\left(\\frac{0.44}{0.15}\\right)^2 \\approx 1.96 + (2.933)^2 \\approx 1.96 + 8.604 \\approx 10.564 $$\n    $$ u_{\\mathrm{LL}} = \\frac{0.004}{0.25 \\times 0.15} \\exp\\left(-\\frac{10.564}{2}\\right) = \\frac{0.004}{0.0375} \\exp(-5.282) \\approx 5.4198 \\times 10^{-4} $$\n\n4.  **三相类别 ($3\\phi$):**\n    $\\mu_{3\\phi} = \\begin{bmatrix} 1.6 \\\\ -0.05 \\end{bmatrix}$，$\\sigma_{I,3\\phi} = 0.2$，$\\sigma_{\\theta,3\\phi} = 0.05$，$\\pi_{3\\phi} = 0.001$。\n    $$ E_{3\\phi} = \\left(\\frac{1.55 - 1.6}{0.2}\\right)^2 + \\left(\\frac{-0.06 - (-0.05)}{0.05}\\right)^2 = (-0.25)^2 + (-0.2)^2 = 0.0625 + 0.04 = 0.1025 $$\n    $$ u_{3\\phi} = \\frac{0.001}{0.2 \\times 0.05} \\exp\\left(-\\frac{0.1025}{2}\\right) = \\frac{0.001}{0.01} \\exp(-0.05125) = 0.1 \\exp(-0.05125) \\approx 0.095004 $$\n\n现在，我们计算这些未归一化后验值的总和，它与证据 $p(x^{\\ast})$ 成正比：\n$$ \\sum_{c'} u_{c'} = u_{\\mathrm{N}} + u_{\\mathrm{SLG}} + u_{\\mathrm{LL}} + u_{3\\phi} \\approx 0 + (8.2221 \\times 10^{-4}) + (5.4198 \\times 10^{-4}) + 0.095004 \\approx 0.096368 $$\n最后，三相故障类别的后验概率是其未归一化后验与总和的比值：\n$$ p(\\mathcal{C}=3\\phi \\mid x^{\\ast}) = \\frac{u_{3\\phi}}{\\sum_{c'} u_{c'}} \\approx \\frac{0.095004}{0.096368} \\approx 0.985846 $$\n四舍五入到四位有效数字，我们得到 $0.9858$。",
            "answer": "$$\\boxed{0.9858}$$"
        }
    ]
}