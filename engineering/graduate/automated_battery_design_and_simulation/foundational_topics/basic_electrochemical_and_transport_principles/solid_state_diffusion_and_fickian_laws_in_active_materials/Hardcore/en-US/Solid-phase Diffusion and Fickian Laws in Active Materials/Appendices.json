{
    "hands_on_practices": [
        {
            "introduction": "To effectively analyze and compare diffusion processes across different scales and conditions, we must first simplify the governing equations. This practice focuses on the powerful technique of non-dimensionalization, applied to diffusion within a spherical particle. By systematically rescaling variables, you will uncover the fundamental dimensionless groups—the Fourier number ($Fo$) and the Biot number ($Bi$)—that dictate the interplay between internal diffusion rates and surface kinetic limitations .",
            "id": "3950996",
            "problem": "A spherical intercalation particle of radius $R$ in a lithium-ion battery electrode serves as the active material domain for solid-state diffusion of lithium. The solid-state concentration field is $c(r,t)$, where $r$ is the radial coordinate and $t$ is time. Assume a constant solid-state diffusion coefficient $D$ and isotropic diffusion. Let the outward normal molar flux at the surface be governed by linear interfacial kinetics with a mass-transfer coefficient $k$ such that the surface flux is proportional to the difference between the surface concentration and an externally imposed reference concentration $c_{\\mathrm{e}}$. The governing physics is based on Fick's first law $J_{r}=-D\\,\\partial c/\\partial r$ and local mass conservation in spherical coordinates. The symmetry condition at the particle center enforces $\\partial c/\\partial r=0$ at $r=0$. At the surface $r=R$, the kinetic boundary condition relates the diffusive flux and interfacial kinetics. An initial uniform concentration $c(r,0)=c_{0}$ is imposed.\n\nStarting from these fundamental laws and conditions, derive the dimensionless form of the diffusion problem by introducing a dimensionless radial coordinate and a dimensionless time variable that isolates the characteristic solid diffusion time scale set by the particle size and diffusivity. Use a concentration scaling that renders the interfacial boundary condition homogeneous in the dimensionless concentration. In your derivation, identify the two key dimensionless numbers that govern the interplay between internal diffusion and surface kinetics: the Fourier number $\\mathrm{Fo}$ and the Biot number $\\mathrm{Bi}$.\n\nReport the final expressions for $\\mathrm{Fo}$ and $\\mathrm{Bi}$ purely in terms of the parameters $D$, $R$, $k$, and $t$ as a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment. The final answer must be a single closed-form analytic expression. No units should be included in the final answer.",
            "solution": "The problem requires the derivation of the dimensionless form of a solid-state diffusion problem in a spherical particle and the identification of the governing dimensionless numbers, the Fourier number ($\\mathrm{Fo}$) and the Biot number ($\\mathrm{Bi}$).\n\nFirst, we must formulate the complete mathematical model in dimensional form. The governing partial differential equation (PDE) for diffusion arises from combining Fick's first law with the principle of local mass conservation.\n\nThe local mass conservation for a species with concentration $c(r, t)$ is given by:\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0\n$$\nwhere $\\mathbf{J}$ is the molar flux vector. In spherical coordinates with isotropic diffusion, the radial component of the flux, $J_r$, is given by Fick's first law:\n$$\nJ_r = -D \\frac{\\partial c}{\\partial r}\n$$\nwhere $D$ is the constant solid-state diffusion coefficient. The divergence of the flux vector in spherical coordinates, assuming radial symmetry, is $\\nabla \\cdot \\mathbf{J} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}(r^2 J_r)$. Substituting Fick's law into the conservation equation yields Fick's second law for this geometry:\n$$\n\\frac{\\partial c}{\\partial t} = \\frac{D}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c}{\\partial r}\\right)\n$$\nThis PDE governs the concentration field $c(r,t)$ for $r \\in [0, R]$ and $t > 0$.\n\nNext, we specify the initial and boundary conditions as provided in the problem statement.\nThe initial condition is a uniform concentration $c_0$:\n$$\nc(r, 0) = c_0 \\quad \\text{for } 0 \\le r \\le R\n$$\nThe first boundary condition is the symmetry condition at the center of the particle ($r=0$):\n$$\n\\left. \\frac{\\partial c}{\\partial r} \\right|_{r=0} = 0\n$$\nThe second boundary condition is at the surface of the particle ($r=R$). The problem states that the outward normal molar flux, $J_r(R,t)$, is governed by linear interfacial kinetics:\n$$\nJ_r(R,t) = k(c(R,t) - c_{\\mathrm{e}})\n$$\nwhere $k$ is the mass-transfer coefficient and $c_{\\mathrm{e}}$ is an external reference concentration. By equating this kinetic expression for the flux with Fick's first law at the surface, we obtain the Robin boundary condition:\n$$\n-D \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=R} = k(c(R,t) - c_{\\mathrm{e}})\n$$\n\nWith the full initial-boundary value problem established, we proceed to nondimensionalize it. We introduce the following dimensionless variables:\n\n1.  A dimensionless concentration, $\\theta$. The problem requires a choice that makes the boundary condition at $r=R$ homogeneous. The term $c(R,t) - c_{\\mathrm{e}}$ suggests a shifted and scaled concentration. We define $\\theta$ as:\n    $$\n    \\theta = \\frac{c(r,t) - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}}\n    $$\n    This assumes $c_0 \\neq c_{\\mathrm{e}}$, which is necessary for a non-trivial problem.\n\n2.  A dimensionless radial coordinate, $\\rho$, by scaling with the particle radius $R$:\n    $$\n    \\rho = \\frac{r}{R}\n    $$\n    The spatial domain becomes $\\rho \\in [0, 1]$.\n\n3.  A dimensionless time, $\\tau$. The problem asks to isolate the characteristic diffusion time scale, which is $R^2/D$. We define $\\tau$ as:\n    $$\n    \\tau = \\frac{Dt}{R^2}\n    $$\n    This dimensionless group is the Fourier number, $\\mathrm{Fo}$.\n\nNow we transform the derivatives using the chain rule:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\frac{D}{R^2} \\frac{\\partial}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial}{\\partial r} = \\frac{\\partial \\rho}{\\partial r} \\frac{\\partial}{\\partial \\rho} = \\frac{1}{R} \\frac{\\partial}{\\partial \\rho}\n$$\nAnd the concentration $c$ is expressed in terms of $\\theta$:\n$$\nc(r,t) = c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta(\\rho, \\tau)\n$$\n\nWe substitute these into the governing PDE:\n$$\n\\frac{\\partial}{\\partial t} \\left[ c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta \\right] = \\frac{D}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial}{\\partial r}\\left[ c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta \\right]\\right)\n$$\nThe constant $c_{\\mathrm{e}}$ terms vanish upon differentiation.\n$$\n(c_0 - c_{\\mathrm{e}}) \\frac{\\partial \\theta}{\\partial t} = \\frac{D(c_0 - c_{\\mathrm{e}})}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial \\theta}{\\partial r}\\right)\n$$\nNow, apply the chain rule transformations for the derivatives and variables:\n$$\n(c_0 - c_{\\mathrm{e}}) \\left(\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau}\\right) = \\frac{D(c_0 - c_{\\mathrm{e}})}{(R\\rho)^2} \\left(\\frac{1}{R}\\frac{\\partial}{\\partial \\rho}\\right) \\left((R\\rho)^2 \\left(\\frac{1}{R}\\frac{\\partial \\theta}{\\partial \\rho}\\right)\\right)\n$$\nCanceling the constant factor $(c_0 - c_{\\mathrm{e}})$ from both sides:\n$$\n\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{D}{R^2 \\rho^2} \\frac{1}{R}\\frac{\\partial}{\\partial \\rho}\\left(R \\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\n$$\n\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{D}{R^3 \\rho^2} (R) \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right) = \\frac{D}{R^2 \\rho^2} \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\nDividing by $D/R^2$ gives the dimensionless PDE:\n$$\n\\frac{\\partial \\theta}{\\partial \\tau} = \\frac{1}{\\rho^2} \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\n\nNext, we transform the initial and boundary conditions.\nThe initial condition $c(r,0) = c_0$ becomes:\n$$\n\\theta(\\rho, 0) = \\frac{c(r,0) - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}} = \\frac{c_0 - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}} = 1\n$$\nThe symmetry condition at the center, $\\left. \\frac{\\partial c}{\\partial r} \\right|_{r=0} = 0$, becomes:\n$$\n\\left. (c_0 - c_{\\mathrm{e}}) \\frac{1}{R} \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=0} = 0 \\implies \\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=0} = 0\n$$\nThe kinetic boundary condition at the surface, $-D \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=R} = k(c(R,t) - c_{\\mathrm{e}})$, transforms as follows:\n$$\n-D \\left. (c_0 - c_{\\mathrm{e}}) \\frac{1}{R} \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = k \\left[ (c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta(1, \\tau)) - c_{\\mathrm{e}} \\right]\n$$\n$$\n-\\frac{D(c_0 - c_{\\mathrm{e}})}{R} \\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = k (c_0 - c_{\\mathrm{e}})\\theta(1, \\tau)\n$$\nCanceling $(c_0 - c_{\\mathrm{e}})$ and rearranging gives the dimensionless boundary condition:\n$$\n\\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = -\\left(\\frac{kR}{D}\\right) \\theta(1, \\tau)\n$$\nThis boundary condition is now homogeneous in $\\theta$, as required. The dimensionless group that has appeared is $\\frac{kR}{D}$. This group represents the ratio of the rate of mass transfer at the surface to the rate of diffusion within the particle, and it is defined as the Biot number for mass transfer, $\\mathrm{Bi}$.\n\nThe two key dimensionless numbers that govern the problem are therefore:\n1.  The Fourier number, $\\mathrm{Fo}$, which arose from the nondimensionalization of time:\n    $$\n    \\mathrm{Fo} = \\tau = \\frac{Dt}{R^2}\n    $$\n2.  The Biot number, $\\mathrm{Bi}$, which arose from the nondimensionalization of the surface kinetic boundary condition:\n    $$\n    \\mathrm{Bi} = \\frac{kR}{D}\n    $$\n\nThe problem asks for these final expressions purely in terms of the given parameters $D$, $R$, $k$, and $t$.\nThe expression for the Fourier number is $\\mathrm{Fo} = \\frac{Dt}{R^2}$.\nThe expression for the Biot number is $\\mathrm{Bi} = \\frac{kR}{D}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Dt}{R^2}  \\frac{kR}{D}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Analytical models provide deep physical insight but often rely on simplifying assumptions, such as an infinite domain. This computational exercise tasks you with quantifying the accuracy of such an approximation by comparing it against a more realistic numerical solution for a finite-sized material . By implementing a numerical solver and an analytical formula, you will determine the precise time window where the simpler model is valid, a crucial skill in practical battery simulation.",
            "id": "3950980",
            "problem": "You are tasked with quantifying the early-time accuracy of a semi-infinite analytical approximation for solid-state diffusion in an active material against a finite-length numerical solution, within the context of automated battery design and simulation. The physical system is a one-dimensional planar slab of thickness $L$ representing the depth of the active material, with uniform initial concentration $c_0$. Lithium intercalation is modeled by a constant molar flux $J$ at the electrolyte-facing surface (at $x=0$), while the backside (at $x=L$) is impermeable. Diffusion is governed by Fick's second law with constant diffusivity $D$.\n\nBase laws and definitions to use:\n- Fick's second law for one-dimensional diffusion in a solid with constant diffusivity:\n$$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}.$$\n- Boundary conditions:\n  - At the electrolyte-facing surface ($x=0$), a constant molar flux $J$ enters the solid:\n  $$-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J.$$\n  - At the backside ($x=L$), the flux is zero (impermeable boundary):\n  $$\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=L} = 0.$$\n- Initial condition: \n$$c(x,0) = c_0.$$\nAll concentrations must be treated in $\\mathrm{mol/m^3}$, flux in $\\mathrm{mol/m^2/s}$, thickness in $\\mathrm{m}$, diffusivity in $\\mathrm{m^2/s}$, and time in $\\mathrm{s}$.\n\nYour program must:\n1. Derive from the base laws the semi-infinite approximation for the surface concentration at $x=0$ as a function of time $t$, valid when the diffusion length is much smaller than the slab thickness. Do not rely on any ungrounded heuristic; start from the stated base laws.\n2. Compute the finite-length numerical solution for the surface concentration $c(0,t)$ using the method of lines for the partial differential equation (PDE), with a central finite difference discretization in space and an ordinary differential equation (ODE) solver in time. Impose the flux boundary condition at $x=0$ and the zero-flux boundary at $x=L$ using consistent numerical boundary treatments. Use at least $N=61$ spatial nodes to resolve the slab and ensure numerical stability and accuracy.\n3. Compare the semi-infinite approximation for the surface concentration $c_{\\mathrm{semi}}(0,t)$ to the finite-length numerical solution $c_{\\mathrm{num}}(0,t)$ by computing the relative error in the surface excursion:\n$$e(t) = \\frac{\\left| \\left(c_{\\mathrm{num}}(0,t)-c_0\\right) - \\left(c_{\\mathrm{semi}}(0,t)-c_0\\right) \\right|}{\\max\\left(\\left|c_{\\mathrm{semi}}(0,t)-c_0\\right|,\\ \\delta\\right)},$$\nwhere $\\delta$ is a small positive regularization constant to avoid division by zero when $J=0$. Use $\\delta = 10^{-12}$ in $\\mathrm{mol/m^3}$.\n4. Determine the largest time $t_{\\max}$ such that $e(t) \\le \\varepsilon$ for all $t \\in [0, t_{\\max}]$, where $\\varepsilon$ is a user-specified tolerance expressed as a decimal (not a percentage). In other words, your $t_{\\max}$ must mark the end of the contiguous early-time window in which the semi-infinite approximation remains accurate within the specified error tolerance before boundary effects significantly influence the solution.\n5. Use a geometrically spaced time grid between $t_{\\min}$ and $t_{\\mathrm{upper}}$, with $t_{\\min} = 10^{-8}$ and $t_{\\mathrm{upper}} = \\alpha L^2 / D$, and $\\alpha = 0.1$, to capture early-time dynamics that scale with the diffusion length. Use $N_t = 60$ time points. All times are in $\\mathrm{s}$.\n\nTest suite:\nCompute $t_{\\max}$ (in seconds) for each of the following parameter sets. All outputs must be expressed in $\\mathrm{s}$.\n- Case $1$: $D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$, $L = 5.0 \\times 10^{-6}\\ \\mathrm{m}$, $J = 1.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$, $c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$, $\\varepsilon = 0.05$.\n- Case $2$: $D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$, $L = 5.0 \\times 10^{-6}\\ \\mathrm{m}$, $J = 0.0\\ \\mathrm{mol/m^2/s}$, $c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$, $\\varepsilon = 0.05$.\n- Case $3$: $D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$, $L = 1.0 \\times 10^{-6}\\ \\mathrm{m}$, $J = 1.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$, $c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$, $\\varepsilon = 0.02$.\n- Case $4$: $D = 5.0 \\times 10^{-15}\\ \\mathrm{m^2/s}$, $L = 1.0 \\times 10^{-5}\\ \\mathrm{m}$, $J = 2.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$, $c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$, $\\varepsilon = 0.05$.\n\nAlgorithmic requirements:\n- Spatial discretization: Use $N=61$ equally spaced nodes over $[0,L]$. Denote the spatial step as $dx = L/(N-1)$.\n- Numerical boundary implementation:\n  - At $x=0$: impose the flux boundary via a one-sided ghost node construction consistent with the derivative, using the relation for the ghost concentration $c_{-1} = c_1 + 2\\,dx\\,J/D$, which enforces $-D(c_1 - c_{-1})/(2\\,dx) = J$.\n  - At $x=L$: impose the zero-flux boundary with a ghost node satisfying $c_N = c_{N-2}$, which enforces $(c_N - c_{N-2})/(2\\,dx) = 0$.\n- Time integration: Solve the resulting system of ordinary differential equations using a stiff solver suitable for diffusive dynamics.\n- Semi-infinite approximation: Derive from the base laws an explicit surface concentration $c_{\\mathrm{semi}}(0,t)$ valid for early times when $\\sqrt{D t} \\ll L$.\n- Error-window computation: Identify $t_{\\max}$ as the largest time in the chosen grid such that all prior times satisfy $e(t) \\le \\varepsilon$. If $e(t)$ exceeds $\\varepsilon$ at the first time in the grid, return $t_{\\max} = 0$.\n\nFinal output format:\nYour program should produce a single line of output containing the resulting $t_{\\max}$ values for the $4$ test cases, as a comma-separated list enclosed in square brackets, each value formatted to six decimal places, for example, $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4\\right]$. The values must be expressed in $\\mathrm{s}$.\n\nNo user input is required; all parameters are fixed and provided above. You must ensure physical realism and numerical consistency throughout.",
            "solution": "The problem is assessed as valid. It is a scientifically grounded, well-posed problem in chemical engineering and materials science, specifically addressing solid-state diffusion. The governing equations, initial conditions, and boundary conditions are clearly stated and physically consistent. The numerical and analytical tasks are well-defined, and the parameters provided are realistic for battery electrode materials.\n\n### 1. Derivation of the Semi-Infinite Analytical Solution\n\nThe problem requires the derivation of the surface concentration for a semi-infinite solid, which is a valid approximation for a finite slab at early times, i.e., when the diffusion length $\\sqrt{Dt}$ is much smaller than the slab thickness $L$.\n\nThe governing system for a semi-infinite medium ($x \\in [0, \\infty)$) is:\n- PDE: $\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$\n- IC: $c(x,0) = c_0$\n- BC1 (flux at surface): $-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J$\n- BC2 (concentration far from surface): $\\lim_{x \\to \\infty} c(x,t) = c_0$\n\nTo simplify the solution process, we define the concentration excursion from the initial state as $\\theta(x,t) = c(x,t) - c_0$. The system transforms to:\n- PDE: $\\frac{\\partial \\theta}{\\partial t} = D \\frac{\\partial^2 \\theta}{\\partial x^2}$\n- IC: $\\theta(x,0) = 0$\n- BC1: $-D \\left.\\frac{\\partial \\theta}{\\partial x}\\right|_{x=0} = J$\n- BC2: $\\lim_{x \\to \\infty} \\theta(x,t) = 0$\n\nWe solve this linear PDE using the Laplace transform with respect to time, where $\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$. Transforming the PDE and applying the initial condition gives an ordinary differential equation (ODE) in the spatial variable $x$:\n$$s\\bar{\\theta}(x,s) - \\theta(x,0) = D \\frac{d^2 \\bar{\\theta}}{dx^2} \\implies \\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{D} \\bar{\\theta} = 0$$\nThe general solution to this ODE is $\\bar{\\theta}(x,s) = A e^{\\sqrt{s/D}x} + B e^{-\\sqrt{s/D}x}$.\n\nThe boundary conditions are also transformed:\n- The condition at infinity, $\\lim_{x \\to \\infty} \\theta(x,t) = 0$, implies $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$. This requires the coefficient $A$ of the exponentially growing term to be zero. Thus, the solution simplifies to $\\bar{\\theta}(x,s) = B e^{-\\sqrt{s/D}x}$.\n- The flux boundary condition transforms to $-D \\frac{d\\bar{\\theta}}{dx}\\big|_{x=0} = \\mathcal{L}\\{J\\} = \\frac{J}{s}$.\nWe compute the derivative of $\\bar{\\theta}(x,s)$: $\\frac{d\\bar{\\theta}}{dx} = -B\\sqrt{\\frac{s}{D}}e^{-\\sqrt{s/D}x}$.\nAt $x=0$, this gives $\\frac{d\\bar{\\theta}}{dx}\\big|_{x=0} = -B\\sqrt{\\frac{s}{D}}$.\nSubstituting this into the transformed flux boundary condition:\n$$-D \\left(-B\\sqrt{\\frac{s}{D}}\\right) = \\frac{J}{s} \\implies B\\sqrt{sD} = \\frac{J}{s} \\implies B = \\frac{J}{\\sqrt{D}}s^{-3/2}$$\nSo, the solution in the Laplace domain is $\\bar{\\theta}(x,s) = \\frac{J}{\\sqrt{D}}s^{-3/2} e^{-\\sqrt{s/D}x}$.\n\nWe are interested in the surface concentration at $x=0$, which is $\\bar{\\theta}(0,s) = \\frac{J}{\\sqrt{D}}s^{-3/2}$.\nTo find $\\theta(0,t)$, we take the inverse Laplace transform of $\\bar{\\theta}(0,s)$. Using the known transform pair $\\mathcal{L}^{-1}\\{s^{-3/2}\\} = 2\\sqrt{t/\\pi}$, we get:\n$$\\theta(0,t) = \\mathcal{L}^{-1}\\left\\{\\frac{J}{\\sqrt{D}}s^{-3/2}\\right\\} = \\frac{J}{\\sqrt{D}} \\left(2\\sqrt{\\frac{t}{\\pi}}\\right) = 2J\\sqrt{\\frac{t}{\\pi D}}$$\nFinally, converting back to the original concentration variable $c(x,t)$:\n$$c_{\\mathrm{semi}}(0,t) = c_0 + \\theta(0,t) = c_0 + 2J\\sqrt{\\frac{t}{\\pi D}}$$\nThis is the required analytical expression for the surface concentration in the semi-infinite approximation.\n\n### 2. Numerical Solution via Method of Lines (MOL)\n\nThe finite-length numerical solution is computed using the Method of Lines. The spatial domain $[0, L]$ is discretized into $N$ equally spaced nodes $x_i = i \\cdot dx$ for $i=0, 1, \\dots, N-1$, where the spatial step is $dx = L/(N-1)$. The PDE $\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$ is converted into a system of coupled ODEs.\n\nFor the interior nodes ($i = 1, \\dots, N-2$), a central finite difference scheme approximates the spatial second derivative:\n$$\\frac{d c_i}{d t} = D \\frac{c_{i+1} - 2c_i + c_{i-1}}{dx^2}$$\n\nThe boundary nodes ($i=0$ and $i=N-1$) require special treatment based on the specified ghost node method.\n\n**At $x=0$ (Node $i=0$):**\nThe constant flux boundary condition is $-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J$. This is discretized using a central difference around $x=0$ involving a ghost node $c_{-1}$ at $x=-dx$:\n$$-D \\frac{c_1 - c_{-1}}{2dx} = J \\implies c_{-1} = c_1 + \\frac{2Jdx}{D}$$\nThe PDE at node $i=0$ is then written as $\\frac{dc_0}{dt} = D \\frac{c_1 - 2c_0 + c_{-1}}{dx^2}$. Substituting the expression for $c_{-1}$:\n$$\\frac{d c_0}{d t} = D \\frac{c_1 - 2c_0 + \\left(c_1 + \\frac{2Jdx}{D}\\right)}{dx^2} = D \\frac{2c_1 - 2c_0}{dx^2} + \\frac{2J}{dx} = \\frac{2D}{dx^2}(c_1 - c_0) + \\frac{2J}{dx}$$\n\n**At $x=L$ (Node $i=N-1$):**\nThe impermeable boundary condition is $\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=L} = 0$. This is discretized using a central difference around $x_{N-1}=L$ involving a ghost node $c_N$ at $x=L+dx$:\n$$\\frac{c_N - c_{N-2}}{2dx} = 0 \\implies c_N = c_{N-2}$$\nThe PDE at node $i=N-1$ is $\\frac{dc_{N-1}}{dt} = D \\frac{c_N - 2c_{N-1} + c_{N-2}}{dx^2}$. Substituting the expression for $c_N$:\n$$\\frac{d c_{N-1}}{d t} = D \\frac{c_{N-2} - 2c_{N-1} + c_{N-2}}{dx^2} = \\frac{2D}{dx^2}(c_{N-2} - c_{N-1})$$\n\nThis forms a system of $N$ stiff, linear, first-order ODEs, which can be written in the form $\\frac{d\\vec{c}}{dt} = \\mathbf{A}\\vec{c} + \\vec{b}$. This system is integrated numerically from the initial condition $c_i(0) = c_0$ for all $i$ using a stiff ODE solver.\n\n### 3. Error Calculation and Time Window Determination\n\nThe accuracy of the semi-infinite model is quantified by the relative error in the surface concentration excursion:\n$$e(t) = \\frac{\\left| \\left(c_{\\mathrm{num}}(0,t)-c_0\\right) - \\left(c_{\\mathrm{semi}}(0,t)-c_0\\right) \\right|}{\\max\\left(\\left|c_{\\mathrm{semi}}(0,t)-c_0\\right|,\\ \\delta\\right)}$$\nwhere $c_{\\mathrm{num}}(0,t)$ is the numerical solution at the surface, $c_{\\mathrm{semi}}(0,t)$ is the analytical approximation, and $\\delta = 10^{-12} \\, \\mathrm{mol/m^3}$ is a regularization constant.\n\nThe simulation is performed over a geometrically spaced time grid of $N_t=60$ points from $t_{\\min} = 10^{-8} \\, \\mathrm{s}$ to $t_{\\mathrm{upper}} = 0.1 L^2 / D$. We then find the largest time $t_{\\max}$ from this grid such that the error $e(t)$ has not exceeded the tolerance $\\varepsilon$ for any preceding time point. If $e(t) > \\varepsilon$ at the very first time point, $t_{\\max}$ is set to $0$.\n\n### 4. Special Case: $J=0$\n\nWhen the applied flux $J=0$, the analytical solution becomes $c_{\\mathrm{semi}}(0,t) = c_0$. For the numerical solution, the ODE for the surface becomes $\\frac{dc_0}{dt} = \\frac{2D}{dx^2}(c_1 - c_0)$. With a uniform initial condition $c_i(0)=c_0$ for all $i$, and with no external forcing term, the concentration gradient remains zero everywhere for all time. Thus, $\\frac{d\\vec{c}}{dt} = \\vec{0}$, and the numerical solution remains $c_{\\mathrm{num}}(x,t)=c_0$. Consequently, the error $e(t)$ is identically zero for all $t$. In this case, the error never exceeds any positive tolerance $\\varepsilon$, so $t_{\\max}$ is the largest time in the evaluation grid, $t_{\\mathrm{upper}}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the maximum time t_max for which a semi-infinite diffusion model\n    is accurate within a given tolerance, compared to a finite-length numerical model.\n    \"\"\"\n    \n    test_cases = [\n        # D (m^2/s), L (m), J (mol/m^2/s), c0 (mol/m^3), epsilon\n        (1.0e-14, 5.0e-6, 1.0e-4, 2.3e4, 0.05),\n        (1.0e-14, 5.0e-6, 0.0, 2.3e4, 0.05),\n        (1.0e-14, 1.0e-6, 1.0e-4, 2.3e4, 0.02),\n        (5.0e-15, 1.0e-5, 2.0e-4, 2.3e4, 0.05),\n    ]\n\n    results = []\n\n    # Shared parameters\n    N = 61  # Number of spatial nodes\n    N_t = 60 # Number of time points\n    t_min = 1.0e-8 # s\n    delta = 1.0e-12 # mol/m^3\n\n    for D, L, J, c0, epsilon in test_cases:\n        \n        t_upper = 0.1 * L**2 / D\n        \n        # Special case for zero flux\n        if J == 0.0:\n            results.append(t_upper)\n            continue\n            \n        t_eval = np.geomspace(t_min, t_upper, N_t)\n        dx = L / (N - 1)\n\n        def dcdt(t, c):\n            \"\"\"\n            RHS of the ODE system for the method of lines.\n            c is the concentration vector [c_0, c_1, ..., c_{N-1}].\n            \"\"\"\n            dcdt_arr = np.zeros(N)\n            \n            # Interior nodes (i=1 to N-2)\n            dcdt_arr[1:-1] = (D / dx**2) * (c[2:] - 2 * c[1:-1] + c[:-2])\n            \n            # Boundary at x=0 (i=0)\n            # dc0/dt = 2D/dx^2 * (c1 - c0) + 2J/dx\n            dcdt_arr[0] = (2 * D / dx**2) * (c[1] - c[0]) + (2 * J / dx)\n            \n            # Boundary at x=L (i=N-1)\n            # d(c_{N-1})/dt = 2D/dx^2 * (c_{N-2} - c_{N-1})\n            dcdt_arr[-1] = (2 * D / dx**2) * (c[-2] - c[-1])\n            \n            return dcdt_arr\n\n        # Initial condition: uniform concentration\n        c_initial = np.full(N, c0)\n\n        # Solve the system of ODEs\n        sol = solve_ivp(\n            fun=dcdt,\n            t_span=(t_eval[0], t_eval[-1]),\n            y0=c_initial,\n            t_eval=t_eval,\n            method='BDF', # Stiff solver\n        )\n        \n        # Extract numerical solution for surface concentration\n        c_num_surface = sol.y[0, :]\n\n        # Calculate semi-infinite analytical solution for surface concentration\n        c_semi_surface = c0 + 2 * J * np.sqrt(t_eval / (np.pi * D))\n        \n        # Calculate concentration excursions\n        excursion_num = c_num_surface - c0\n        excursion_semi = c_semi_surface - c0\n\n        # Calculate relative error\n        numerator = np.abs(excursion_num - excursion_semi)\n        denominator = np.maximum(np.abs(excursion_semi), delta)\n        error = numerator / denominator\n        \n        # Find t_max\n        # Find the first index where the error exceeds the tolerance\n        invalid_indices = np.where(error > epsilon)[0]\n        \n        t_max = 0.0 # Default value\n        if len(invalid_indices) == 0:\n            # If error never exceeds tolerance, t_max is the last time point\n            t_max = t_eval[-1]\n        else:\n            first_invalid_idx = invalid_indices[0]\n            if first_invalid_idx > 0:\n                # t_max is the time point just before the first failure\n                t_max = t_eval[first_invalid_idx - 1]\n            # else, if first_invalid_idx is 0, t_max remains 0\n\n        results.append(t_max)\n        \n    # Format and print the final results\n    print(f\"[{','.join(f'{val:.6f}' for val in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The diffusion coefficient, $D$, is not a universal constant but a material property that is strongly dependent on temperature. This data analysis exercise bridges theory and experiment by having you fit the Arrhenius equation to measured diffusivity data to extract key parameters like activation energy ($E_a$) . You will also employ statistical model selection criteria to rigorously assess whether the simple Arrhenius model is sufficient or if a more complex model is needed to capture the material's behavior.",
            "id": "3950999",
            "problem": "You are given sets of experimental measurements of the diffusion coefficient $D$ as a function of absolute temperature $T$ for a lithium-ion cathode active material. Under solid-state diffusion governed by Fick's laws and thermally activated hopping in crystalline lattices, thermally activated transport over a single dominant energy barrier yields a temperature dependence that is consistent with a linear relationship between the logarithm of the diffusion coefficient and the reciprocal of absolute temperature. Your task is to:\n\n- Use first-principles reasoning rooted in Fickian diffusion and thermally activated hopping to justify a linear regression model for $\\ln D$ versus $1/T$ when a single activation barrier controls mass transport.\n- Implement ordinary least squares regression on $\\ln D$ versus $1/T$ to obtain the linear-fit parameters, and from them extract the activation energy $E_a$ and the pre-exponential factor $D_0$.\n- Assess deviations from single-barrier Arrhenius behavior by comparing the goodness-of-fit of the linear model to that of a quadratic model in $1/T$ through an information-theoretic criterion. Specifically, compute an information criterion difference between the two models and classify whether the data are adequately Arrhenius-like.\n\nScientific assumptions and requirements:\n- Absolute temperature $T$ is provided in kelvin and the diffusion coefficient $D$ is provided in square meters per second. You must return the activation energy $E_a$ in joules per mole and the pre-exponential factor $D_0$ in square meters per second.\n- The assessment of non-Arrhenius behavior must be based on comparing the fit of a linear model for $\\ln D$ versus $1/T$ to a quadratic model for $\\ln D$ versus $1/T$ using a standard information criterion that penalizes model complexity. Report the difference between the linear-model criterion and the quadratic-model criterion. Define a boolean classification that returns $\\text{True}$ if the data are adequately Arrhenius-like, and $\\text{False}$ otherwise. Use a fixed threshold of $2$ on the criterion difference to make this classification decision.\n- Do not assume any shortcut formulas beyond the fundamental principles described. Your regression and model comparison must be implemented from first principles.\n\nNumerical details:\n- Use the molar gas constant $R$ to connect the slope of the $\\ln D$ versus $1/T$ relation to $E_a$.\n- Report $E_a$ in joules per mole and $D_0$ in square meters per second.\n- All logarithms are natural logarithms.\n\nTest suite:\nFor each test case below, the temperature array $T$ is given in kelvin and the diffusion coefficient array $D$ is given in square meters per second. Your program must process each case independently and return a list per case containing $[E_a,\\ D_0,\\ \\Delta,\\ \\text{is\\_Arrhenius}]$, where $E_a$ is a float in joules per mole, $D_0$ is a float in square meters per second, $\\Delta$ is a float representing the information-criterion difference between the linear and quadratic models, and $\\text{is\\_Arrhenius}$ is a boolean classification using the threshold $2$.\n\n- Case 1 (nominal Arrhenius-like behavior):\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (kelvin)\n  - $D = [1.5\\times 10^{-14},\\ 4.9\\times 10^{-14},\\ 1.4\\times 10^{-13},\\ 4.0\\times 10^{-13},\\ 8.0\\times 10^{-13}]$ (square meters per second)\n- Case 2 (Arrhenius-like with noticeable experimental noise):\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (kelvin)\n  - $D = [2.1\\times 10^{-13},\\ 2.7\\times 10^{-13},\\ 2.5\\times 10^{-13},\\ 2.9\\times 10^{-13},\\ 3.8\\times 10^{-13}]$ (square meters per second)\n- Case 3 (non-Arrhenius, two-regime behavior):\n  - $T = [260.0,\\ 280.0,\\ 300.0,\\ 320.0,\\ 340.0]$ (kelvin)\n  - $D = [1.0\\times 10^{-14},\\ 1.6\\times 10^{-14},\\ 2.5\\times 10^{-14},\\ 8.5\\times 10^{-13},\\ 2.4\\times 10^{-12}]$ (square meters per second)\n- Case 4 (near-constant diffusivity across temperature; edge case):\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (kelvin)\n  - $D = [1.00\\times 10^{-11},\\ 1.05\\times 10^{-11},\\ 1.02\\times 10^{-11},\\ 1.06\\times 10^{-11},\\ 1.01\\times 10^{-11}]$ (square meters per second)\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets. Each case result must itself be a list in the order $[E_a,\\ D_0,\\ \\Delta,\\ \\text{is\\_Arrhenius}]$.\n- For example: $[[E_{a,1},D_{0,1},\\Delta_1,\\text{is\\_Arrhenius}_1],[E_{a,2},D_{0,2},\\Delta_2,\\text{is\\_Arrhenius}_2],[E_{a,3},D_{0,3},\\Delta_3,\\text{is\\_Arrhenius}_3],[E_{a,4},D_{0,4},\\Delta_4,\\text{is\\_Arrhenius}_4]]$.",
            "solution": "The problem of determining the activation energy and pre-exponential factor for diffusion from temperature-dependent data is a standard task in materials science and physical chemistry. The validity of the problem statement is assessed first.\n\n### Step 1: Extract Givens\n- **Task**: Analyze experimental data of diffusion coefficient $D$ versus absolute temperature $T$.\n- **Theoretical Framework**: Solid-state diffusion is governed by Fick's laws and thermally activated hopping in a crystalline lattice with a single dominant energy barrier. This leads to a linear relationship between $\\ln D$ and $1/T$.\n- **Methodology**:\n    1. Justify a linear regression model for $\\ln D$ versus $1/T$ from first principles.\n    2. Implement ordinary least squares (OLS) regression to find the linear fit parameters.\n    3. Extract the activation energy $E_a$ and pre-exponential factor $D_0$ from these parameters.\n    4. Assess non-Arrhenius behavior by comparing the linear model to a quadratic model in $1/T$ using an information criterion.\n- **Scientific Assumptions  Requirements**:\n    - $T$ is in kelvin (K), $D$ is in square meters per second (m²/s).\n    - $E_a$ must be returned in joules per mole (J/mol), $D_0$ in m²/s.\n    - Model comparison must use a standard information criterion that penalizes complexity.\n    - The output for model comparison is $\\Delta = \\text{IC}_{\\text{linear}} - \\text{IC}_{\\text{quadratic}}$.\n    - A boolean classification, `is_Arrhenius`, is `True` if the data are adequately Arrhenius-like, defined by $\\Delta  2$, and `False` otherwise.\n    - All logarithms are natural logarithms ($\\ln$).\n    - The molar gas constant $R$ is to be used.\n- **Test Data**:\n    - **Case 1**: $T = [280.0, 300.0, 320.0, 340.0, 360.0]$; $D = [1.5\\times 10^{-14}, 4.9\\times 10^{-14}, 1.4\\times 10^{-13}, 4.0\\times 10^{-13}, 8.0\\times 10^{-13}]$.\n    - **Case 2**: $T = [280.0, 300.0, 320.0, 340.0, 360.0]$; $D = [2.1\\times 10^{-13}, 2.7\\times 10^{-13}, 2.5\\times 10^{-13}, 2.9\\times 10^{-13}, 3.8\\times 10^{-13}]$.\n    - **Case 3**: $T = [260.0, 280.0, 300.0, 320.0, 340.0]$; $D = [1.0\\times 10^{-14}, 1.6\\times 10^{-14}, 2.5\\times 10^{-14}, 8.5\\times 10^{-13}, 2.4\\times 10^{-12}]$.\n    - **Case 4**: $T = [280.0, 300.0, 320.0, 340.0, 360.0]$; $D = [1.00\\times 10^{-11}, 1.05\\times 10^{-11}, 1.02\\times 10^{-11}, 1.06\\times 10^{-11}, 1.01\\times 10^{-11}]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Arrhenius equation, a fundamental and empirically verified model for the temperature dependence of rate processes, including solid-state diffusion. The use of ordinary least squares for parameter estimation and information criteria (like AIC) for model selection are standard, rigorous statistical methods. The problem is scientifically sound.\n- **Well-Posed**: The problem provides specific input data ($T$, $D$) and requires specific, well-defined outputs ($E_a$, $D_0$, $\\Delta$, `is_Arrhenius`). The procedure is explicitly outlined, leading to a unique and meaningful solution for each test case.\n- **Objective**: The problem is stated in precise, quantitative terms, free from any subjective or biased language.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. While it refers to \"a standard information criterion,\" this is acceptable as it allows for the implementation of any appropriate choice, such as the Akaike Information Criterion (AIC), which fits the description. The threshold for classification is explicitly given ($\\Delta  2$).\n- **Unrealistic or Infeasible**: The temperature ranges and diffusion coefficient magnitudes are physically realistic for lithium-ion diffusion in cathode materials.\n- **Other Flaws**: The problem is free of other identified flaws like being ill-posed, tautological, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Principle-Based Solution Design\n\n#### 1. Theoretical Justification of the Arrhenius Relation\nSolid-state diffusion via a hopping mechanism involves ions or atoms moving from one lattice site to an adjacent vacant site. This process requires the diffusing species to overcome a potential energy barrier. The height of this barrier is the activation energy, $E_a$.\n\nAccording to statistical mechanics, the probability that a particle has sufficient thermal energy to surmount this barrier is proportional to the Boltzmann factor, $\\exp\\left(-\\frac{E_a}{k_B T}\\right)$, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. The diffusion coefficient, $D$, which is proportional to the hopping rate, will therefore exhibit a similar temperature dependence. This relationship is formalized by the Arrhenius equation:\n$$D(T) = D_0 \\exp\\left(-\\frac{E_a}{RT}\\right)$$\nIn this form, $E_a$ represents the molar activation energy (in J/mol), and $R$ is the molar gas constant. The term $D_0$ is the pre-exponential factor, which consolidates factors such as the jump distance, attempt frequency, and geometric factors of the lattice.\n\nTo establish a linear model amenable to regression analysis, we take the natural logarithm of both sides of the Arrhenius equation:\n$$\\ln(D) = \\ln\\left(D_0 \\exp\\left(-\\frac{E_a}{RT}\\right)\\right)$$\nUsing the properties of logarithms, this simplifies to:\n$$\\ln(D) = \\ln(D_0) - \\frac{E_a}{R} \\left(\\frac{1}{T}\\right)$$\nThis equation is in the form of a straight line, $y = c + mx$, where:\n- The dependent variable is $y = \\ln(D)$.\n- The independent variable is $x = 1/T$.\n- The y-intercept is $c = \\ln(D_0)$.\n- The slope is $m = -E_a/R$.\n\nThis direct theoretical linkage justifies using linear regression on a plot of $\\ln(D)$ versus $1/T$ to determine the parameters $m$ and $c$, from which $E_a$ and $D_0$ can be extracted.\n\n#### 2. Ordinary Least Squares (OLS) Regression\nWe are given $n$ data points $(T_i, D_i)$. We transform these to $(x_i, y_i)$, where $x_i = 1/T_i$ and $y_i = \\ln(D_i)$. We want to find the parameters $\\boldsymbol{\\beta}$ of a model that best fits the data. For a general polynomial model of degree $p-1$, $y = \\beta_0 + \\beta_1 x + \\dots + \\beta_{p-1} x^{p-1}$, we can use matrix algebra.\n\nLet $\\mathbf{y}$ be the vector of observed $y_i$ values. The model can be written as $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$, where $\\mathbf{X}$ is the design matrix, $\\boldsymbol{\\beta}$ is the vector of coefficients, and $\\boldsymbol{\\epsilon}$ is the vector of errors. The OLS estimate for $\\boldsymbol{\\beta}$ that minimizes the residual sum of squares ($\\text{RSS} = \\boldsymbol{\\epsilon}^T \\boldsymbol{\\epsilon}$) is given by the normal equations:\n$$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$$\n\nFor the **linear model** ($M_1: y = \\beta_0 + \\beta_1 x$):\nThe design matrix $\\mathbf{X}_1$ is an $n \\times 2$ matrix:\n$$\\mathbf{X}_1 = \\begin{pmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_n \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}$$\nThe estimated coefficients are $\\hat{\\beta}_0 = c$ and $\\hat{\\beta}_1 = m$. From these, we calculate:\n$$E_a = -\\hat{\\beta}_1 R$$\n$$D_0 = \\exp(\\hat{\\beta}_0)$$\n\nFor the **quadratic model** ($M_2: y = \\gamma_0 + \\gamma_1 x + \\gamma_2 x^2$):\nThe design matrix $\\mathbf{X}_2$ is an $n \\times 3$ matrix:\n$$\\mathbf{X}_2 = \\begin{pmatrix} 1  x_1  x_1^2 \\\\ 1  x_2  x_2^2 \\\\ \\vdots  \\vdots  \\vdots \\\\ 1  x_n  x_n^2 \\end{pmatrix}, \\quad \\boldsymbol{\\gamma} = \\begin{pmatrix} \\gamma_0 \\\\ \\gamma_1 \\\\ \\gamma_2 \\end{pmatrix}$$\nThe OLS procedure is the same, yielding estimates $\\hat{\\boldsymbol{\\gamma}}$.\n\n#### 3. Model Comparison using Akaike Information Criterion (AIC)\nA simple Arrhenius model is not always sufficient. Multiple diffusion mechanisms or phase a transition can lead to a curved Arrhenius plot. The quadratic model $M_2$ provides one way to capture such curvature. To decide if the additional complexity of $M_2$ is justified by the data, we use an information criterion.\n\nThe Akaike Information Criterion (AIC) is a suitable choice. For a least-squares model with normally distributed errors, AIC can be calculated as:\n$$\\text{AIC} = n \\ln\\left(\\frac{\\text{RSS}}{n}\\right) + 2k$$\nwhere $n$ is the number of data points, $\\text{RSS}$ is the residual sum of squares for the model, and $k$ is the number of estimated parameters. For a regression model, $k$ includes the regression coefficients plus one for the variance of the residuals ($\\sigma^2$).\n\n- For the linear model ($M_1$): $k_1 = 2 \\text{ (for } \\beta_0, \\beta_1) + 1 \\text{ (for } \\sigma^2) = 3$.\n- For the quadratic model ($M_2$): $k_2 = 3 \\text{ (for } \\gamma_0, \\gamma_1, \\gamma_2) + 1 \\text{ (for } \\sigma^2) = 4$.\n\nThe RSS for each model is calculated from the predicted values $\\hat{\\mathbf{y}} = \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$:\n$$\\text{RSS} = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2$$\n\nThe problem asks for the difference $\\Delta = \\text{AIC}_1 - \\text{AIC}_2$.\n$$\\Delta = \\left[n \\ln\\left(\\frac{\\text{RSS}_1}{n}\\right) + 2k_1\\right] - \\left[n \\ln\\left(\\frac{\\text{RSS}_2}{n}\\right) + 2k_2\\right]$$\n$$\\Delta = n \\ln\\left(\\frac{\\text{RSS}_1}{\\text{RSS}_2}\\right) + 2(k_1 - k_2) = n \\ln\\left(\\frac{\\text{RSS}_1}{\\text{RSS}_2}\\right) - 2$$\n\nThe classification rule is: `is_Arrhenius` is `True` if $\\Delta  2$. This threshold implies that if the evidence in favor of the more complex quadratic model is not substantial (i.e., the reduction in AIC is less than $2$), the simpler linear (Arrhenius) model is considered an adequate description of the data.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing temperature-dependent diffusion data.\n    For each test case, it performs linear and quadratic regression on ln(D) vs 1/T,\n    extracts Arrhenius parameters, and compares the models using AIC.\n    \"\"\"\n\n    # Molar gas constant in J/(mol·K)\n    R = 8.314462618\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (nominal Arrhenius-like behavior)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([1.5e-14, 4.9e-14, 1.4e-13, 4.0e-13, 8.0e-13])\n        ),\n        # Case 2 (Arrhenius-like with noticeable experimental noise)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([2.1e-13, 2.7e-13, 2.5e-13, 2.9e-13, 3.8e-13])\n        ),\n        # Case 3 (non-Arrhenius, two-regime behavior)\n        (\n            np.array([260.0, 280.0, 300.0, 320.0, 340.0]),\n            np.array([1.0e-14, 1.6e-14, 2.5e-14, 8.5e-13, 2.4e-12])\n        ),\n        # Case 4 (near-constant diffusivity across temperature; edge case)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([1.00e-11, 1.05e-11, 1.02e-11, 1.06e-11, 1.01e-11])\n        ),\n    ]\n\n    results = []\n    \n    for T_data, D_data in test_cases:\n        # Transform variables for regression\n        n = len(T_data)\n        x_var = 1.0 / T_data\n        y_var = np.log(D_data)\n\n        # ---- Linear Model (M1: y = b0 + b1*x) ----\n        # Construct the design matrix X1\n        X1 = np.vstack([np.ones(n), x_var]).T\n        \n        # Calculate coefficients using OLS normal equation: beta = (X'X)^-1 * X'y\n        try:\n            beta1 = np.linalg.inv(X1.T @ X1) @ X1.T @ y_var\n        except np.linalg.LinAlgError:\n            # Handle potential singularity for edge cases, though unlikely here\n            results.append([float('nan'), float('nan'), float('nan'), False])\n            continue\n            \n        # Extract physical parameters from linear fit\n        # c = beta1[0] = ln(D0) -> D0 = exp(beta1[0])\n        # m = beta1[1] = -Ea/R -> Ea = -beta1[1] * R\n        D0 = np.exp(beta1[0])\n        Ea = -beta1[1] * R\n\n        # Calculate Residual Sum of Squares (RSS) for the linear model\n        y_pred1 = X1 @ beta1\n        RSS1 = np.sum((y_var - y_pred1)**2)\n\n        # Calculate AIC for the linear model\n        # k1 = number of parameters (beta0, beta1) + variance = 3\n        k1 = 3\n        if RSS1 > 0:\n            AIC1 = n * np.log(RSS1 / n) + 2 * k1\n        else:\n            # Perfect fit, log(0) is -inf. In practice use a very small number or handle as a special case.\n            # AIC would be -inf, model is perfectly predictive.\n            AIC1 = -np.inf\n\n        # ---- Quadratic Model (M2: y = g0 + g1*x + g2*x^2) ----\n        # Construct the design matrix X2\n        X2 = np.vstack([np.ones(n), x_var, x_var**2]).T\n\n        # Calculate coefficients using OLS\n        try:\n            beta2 = np.linalg.inv(X2.T @ X2) @ X2.T @ y_var\n        except np.linalg.LinAlgError:\n            # Handle potential singularity\n            results.append([float('nan'), float('nan'), float('nan'), False])\n            continue\n\n        # Calculate RSS for the quadratic model\n        y_pred2 = X2 @ beta2\n        RSS2 = np.sum((y_var - y_pred2)**2)\n\n        # Calculate AIC for the quadratic model\n        # k2 = number of parameters (gamma0, gamma1, gamma2) + variance = 4\n        k2 = 4\n        if RSS2 > 0:\n            AIC2 = n * np.log(RSS2 / n) + 2 * k2\n        else:\n            AIC2 = -np.inf\n\n        # ---- Model Comparison ----\n        # Calculate the AIC difference\n        if np.isinf(AIC1) or np.isinf(AIC2):\n            # If one model is a perfect fit and the other isn't, the difference is infinite.\n            # A perfect quadratic fit to imperfect linear data implies strong non-Arrhenius behavior.\n            Delta = AIC1 - AIC2\n        else:\n            Delta = AIC1 - AIC2\n            # Alternative calculation: delta = n * np.log(RSS1/RSS2) - 2\n            # which is equivalent, but avoids intermediate AIC values\n        \n        # Classify based on the threshold\n        is_Arrhenius = Delta  2.0\n\n        # Append results for the current case\n        results.append([Ea, D0, Delta, is_Arrhenius])\n\n    # Format the final output string\n    # Using a nested list comprehension with f-strings for precise formatting\n    output_str = \"[\" + \",\".join([\n        f\"[{res[0]:.6f},{res[1]:.6e},{res[2]:.6f},{str(res[3]).lower()}]\" \n        for res in results\n    ]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}