{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on the core function of a Phase Change Material (PCM): storing thermal energy. We'll begin with a foundational exercise to calculate the total enthalpy change in a PCM as it heats up through its melting transition. By working through this problem , you will reinforce your understanding of the distinction between sensible heat (related to temperature change) and latent heat (related to phase change) using a straightforward, piecewise linear model for the melting process.",
            "id": "3939072",
            "problem": "In automated battery design and simulation, Phase Change Materials (PCM) are often incorporated into pack enclosures to buffer transient heat release by storing energy in both sensible and latent forms. Consider a PCM with mass density $\\rho$ and constant specific heat capacity $c_p$ over the temperature range of interest. Let the latent heat of fusion be $L$, and assume the melt fraction $g(T)$ varies linearly with temperature over a finite melting interval, with onset at $40\\,^\\circ\\text{C}$ and completion at $45\\,^\\circ\\text{C}$. The nominal melt temperature is $T_m=42\\,^\\circ\\text{C}$. The PCM begins at $35\\,^\\circ\\text{C}$ and warms to $50\\,^\\circ\\text{C}$.\n\nStarting from the definition of specific enthalpy for a phase-changing medium as the sum of a sensible contribution and a latent contribution accumulated through the evolving melt fraction, derive and evaluate the enthalpy increase per unit volume for this thermal excursion. You may assume negligible hysteresis and subcooling, and that the linear melt fraction model implies $g(T)=0$ for $T<40\\,^\\circ\\text{C}$, $g(T)=1$ for $T>45\\,^\\circ\\text{C}$, and $g(T)$ varies linearly in between.\n\nUse $\\rho=900\\ \\mathrm{kg\\,m^{-3}}$, $L=200\\ \\mathrm{kJ\\,kg^{-1}}$, $c_p=2.0\\ \\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, and $T_m=42\\,^\\circ\\text{C}$. Express your final enthalpy increase per unit volume in $\\mathrm{MJ\\,m^{-3}}$, and round your answer to four significant figures.",
            "solution": "The problem asks for the total enthalpy increase per unit volume for a Phase Change Material (PCM) undergoing a specific thermal excursion. The solution requires starting from the fundamental definition of specific enthalpy, which incorporates both sensible and latent heat storage.\n\nThe specific enthalpy, $h$, of a material is a function of its temperature, $T$. For a PCM, the change in specific enthalpy, $dh$, can be expressed as the sum of the sensible heat component and the latent heat component:\n$$dh = c_p dT + L dg$$\nwhere $c_p$ is the specific heat capacity, $L$ is the latent heat of fusion, and $g(T)$ is the melt fraction, which represents the fraction of the material that has undergone phase change from solid to liquid.\n\nBy expressing the change in melt fraction $dg$ in terms of the change in temperature $dT$ using the chain rule, $dg = \\frac{dg}{dT} dT$, we can write the expression for $dh$ as:\n$$dh = \\left(c_p + L \\frac{dg}{dT}\\right) dT$$\nThe term within the parentheses is known as the apparent specific heat capacity, $c_{p,app}(T) = c_p + L \\frac{dg}{dT}$, which accounts for both sensible and latent heat effects as a function of temperature.\n\nThe total increase in specific enthalpy, $\\Delta h$, when the material is heated from an initial temperature $T_\\text{initial}$ to a final temperature $T_\\text{final}$ is found by integrating this differential expression:\n$$\\Delta h = \\int_{T_\\text{initial}}^{T_\\text{final}} c_{p,app}(T) dT = \\int_{T_\\text{initial}}^{T_\\text{final}} \\left(c_p + L \\frac{dg}{dT}\\right) dT$$\n\nThe problem specifies the melt fraction $g(T)$ as a piecewise linear function of temperature. Let $T_\\text{onset} = 40\\,^\\circ\\text{C}$ and $T_\\text{complete} = 45\\,^\\circ\\text{C}$.\nThe melt fraction $g(T)$ is defined as:\n1.  For $T  T_\\text{onset}$: The material is fully solid, so $g(T) = 0$.\n2.  For $T_\\text{onset} \\le T \\le T_\\text{complete}$: The material is melting, and $g(T)$ varies linearly from $0$ to $1$. The function is given by:\n    $$g(T) = \\frac{T - T_\\text{onset}}{T_\\text{complete} - T_\\text{onset}} = \\frac{T - 40}{45 - 40} = \\frac{T - 40}{5}$$\n3.  For $T > T_\\text{complete}$: The material is fully liquid, so $g(T) = 1$.\n\nFrom this definition, we can find the derivative $\\frac{dg}{dT}$:\n$$\\frac{dg}{dT} = \\begin{cases} 0  \\text{for } T  40\\,^\\circ\\text{C} \\text{ or } T  45\\,^\\circ\\text{C} \\\\ \\frac{1}{5}\\,(^\\circ\\text{C})^{-1}  \\text{for } 40\\,^\\circ\\text{C}  T  45\\,^\\circ\\text{C} \\end{cases}$$\nThe temperature is given in degrees Celsius. Since specific heat capacity is given in per Kelvin, we note that a temperature difference $\\Delta T$ in degrees Celsius is equal to the temperature difference in Kelvin. The derivative $\\frac{dg}{dT}$ has units of $\\mathrm{K}^{-1}$ or $(^\\circ\\text{C})^{-1}$. The provided value for nominal melt temperature, $T_m=42\\,^\\circ\\text{C}$, is not used in the calculation, as the behavior of $g(T)$ is explicitly defined by the onset and completion temperatures.\n\nWe need to evaluate the integral for $\\Delta h$ from $T_\\text{initial} = 35\\,^\\circ\\text{C}$ to $T_\\text{final} = 50\\,^\\circ\\text{C}$. We split the integral into three segments corresponding to the piecewise definition of $\\frac{dg}{dT}$:\n$$\\Delta h = \\int_{35}^{50} \\left(c_p + L \\frac{dg}{dT}\\right) dT = \\int_{35}^{40} \\left(c_p + L \\frac{dg}{dT}\\right) dT + \\int_{40}^{45} \\left(c_p + L \\frac{dg}{dT}\\right) dT + \\int_{45}^{50} \\left(c_p + L \\frac{dg}{dT}\\right) dT$$\n\nEvaluating each segment:\n1.  From $35\\,^\\circ\\text{C}$ to $40\\,^\\circ\\text{C}$: $\\frac{dg}{dT} = 0$.\n    $$\\int_{35}^{40} c_p dT = c_p [T]_{35}^{40} = c_p(40 - 35) = 5c_p$$\n2.  From $40\\,^\\circ\\text{C}$ to $45\\,^\\circ\\text{C}$: $\\frac{dg}{dT} = \\frac{1}{5}$.\n    $$\\int_{40}^{45} \\left(c_p + \\frac{L}{5}\\right) dT = \\left(c_p + \\frac{L}{5}\\right) [T]_{40}^{45} = \\left(c_p + \\frac{L}{5}\\right)(45 - 40) = 5\\left(c_p + \\frac{L}{5}\\right) = 5c_p + L$$\n3.  From $45\\,^\\circ\\text{C}$ to $50\\,^\\circ\\text{C}$: $\\frac{dg}{dT} = 0$.\n    $$\\int_{45}^{50} c_p dT = c_p [T]_{45}^{50} = c_p(50 - 45) = 5c_p$$\n\nThe total increase in specific enthalpy is the sum of these three contributions:\n$$\\Delta h = 5c_p + (5c_p + L) + 5c_p = 15c_p + L$$\nThis result is physically intuitive: it is the sensible heat required to raise the temperature by $15\\,^\\circ\\text{C}$ (from $35\\,^\\circ\\text{C}$ to $50\\,^\\circ\\text{C}$) plus the full latent heat of fusion, as the material has completely melted.\n\nNow, we substitute the given values: $c_p = 2.0\\ \\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$ and $L = 200\\ \\mathrm{kJ\\,kg^{-1}}$.\n$$\\Delta h = (15\\ \\mathrm{K}) \\times (2.0\\ \\mathrm{kJ\\,kg^{-1}\\,K^{-1}}) + 200\\ \\mathrm{kJ\\,kg^{-1}}$$\n$$\\Delta h = 30\\ \\mathrm{kJ\\,kg^{-1}} + 200\\ \\mathrm{kJ\\,kg^{-1}} = 230\\ \\mathrm{kJ\\,kg^{-1}}$$\n\nThe problem asks for the enthalpy increase per unit volume, $\\Delta H_v$, which is the product of the specific enthalpy increase $\\Delta h$ and the mass density $\\rho$.\n$$\\Delta H_v = \\rho \\cdot \\Delta h$$\nUsing the given density $\\rho = 900\\ \\mathrm{kg\\,m^{-3}}$:\n$$\\Delta H_v = (900\\ \\mathrm{kg\\,m^{-3}}) \\times (230\\ \\mathrm{kJ\\,kg^{-1}}) = 207000\\ \\mathrm{kJ\\,m^{-3}}$$\n\nFinally, we convert the units to megajoules per cubic meter ($\\mathrm{MJ\\,m^{-3}}$) and round to four significant figures. Since $1\\ \\mathrm{MJ} = 1000\\ \\mathrm{kJ}$:\n$$\\Delta H_v = 207000\\ \\mathrm{kJ\\,m^{-3}} \\times \\frac{1\\ \\mathrm{MJ}}{1000\\ \\mathrm{kJ}} = 207\\ \\mathrm{MJ\\,m^{-3}}$$\nRounding to four significant figures gives $207.0\\ \\mathrm{MJ\\,m^{-3}}$.",
            "answer": "$$\\boxed{207.0}$$"
        },
        {
            "introduction": "Real-world PCMs rarely melt at a single, precise temperature; instead, the transition occurs over a range and often exhibits hysteresis between melting and freezing cycles. This practice bridges the gap between abstract theory and experimental reality. Using mock Differential Scanning Calorimetry (DSC) data, you will construct a smooth, continuous model for the PCM's effective heat capacity and learn to quantify hysteresis , a critical non-ideal effect essential for creating accurate thermal simulations.",
            "id": "3939109",
            "problem": "A developer is implementing a numerical module for Phase Change Material (PCM) thermal management within automated battery design and simulation. The goal is to construct a smooth effective heat capacity function and quantify thermal hysteresis using Differential Scanning Calorimetry (DSC) data.\n\nAssume the following foundational modeling framework derived from thermodynamics and calorimetry:\n- The total specific enthalpy $H(T)$ of the PCM under a controlled scan is the path integral of the specific heat rate over temperature, and the DSC heat flow $\\dot{Q}$ under a constant scan rate $\\beta = dT/dt$ yields $dH/dT = \\dot{Q}/\\beta$, which is the effective heat capacity $c_p^{\\text{eff}}(T)$.\n- Decompose $c_p^{\\text{eff}}(T)$ into a sensible part and a latent part as $c_p^{\\text{eff}}(T) = c_p + L \\, g(T)$, where $c_p$ is the baseline sensible specific heat capacity, $L$ is the latent heat of fusion per unit mass, and $g(T)$ is a unimodal probability density function (PDF) in temperature that integrates to $1$ and models the distribution of latent heat uptake across temperature during melting. The associated liquid fraction is $\\phi(T) = \\int_{-\\infty}^{T} g(\\theta)\\, d\\theta$, and the latent enthalpy contribution is $L \\, \\phi(T)$.\n- For freezing (cooling scan), hysteresis is captured by a shifted and possibly reshaped latent heat distribution $g_{\\downarrow}(T)$ with parameters distinct from those of heating.\n\nYou must:\n1. Using the heating DSC data (onset temperature, peak temperature, completion temperature, integrated latent heat $L$), fit a smooth $dH/dT = c_p^{\\text{eff}}(T)$ by selecting a unimodal $g(T)$ anchored at the peak temperature and consistent with onset and completion temperatures treated as cumulative quantiles. Constrain $g(T)$ so that $\\int_{-\\infty}^{\\infty} g(T)\\, dT = 1$ and therefore the integrated latent enthalpy over the transition equals $L$. Use the cumulative quantile mapping at probabilities $p_{\\text{low}} = 0.1$ and $p_{\\text{high}} = 0.9$ for the onset and completion temperatures respectively.\n2. For the freezing (cooling) DSC data, fit an analogous smooth $c_{p,\\downarrow}^{\\text{eff}}(T)$ using the same modeling approach, but allow the fitted parameters to differ. Quantify hysteresis by computing:\n   - The midpoint shift $\\Delta T_{\\text{mid}}$ defined as the difference between the temperatures at which the liquid fraction $\\phi(T)$ equals $0.5$ on heating and cooling.\n   - The width ratio $r_{\\sigma}$ defined as the ratio of the distribution width on cooling to that on heating.\n   - The loop area $A_{\\text{loop}}$ defined as $A_{\\text{loop}} = L \\int_{-\\infty}^{\\infty} \\left|\\phi_{\\uparrow}(T) - \\phi_{\\downarrow}(T)\\right|\\, dT$, which measures the hysteresis in the temperature-enthalpy plane. Evaluate this integral numerically over a finite domain sufficiently wide to capture the support of both distributions.\n\nAll temperatures must be expressed in Kelvin, all specific heats in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, and all latent heats in $\\text{kJ}\\,\\text{kg}^{-1}$. The loop area $A_{\\text{loop}}$ must be expressed in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}$.\n\nTest suite:\nProvide computations for three independent test cases. Each test case contains heating DSC data $(T_{\\text{onset},\\uparrow}, T_{\\text{peak},\\uparrow}, T_{\\text{comp},\\uparrow}, L, c_p)$ and cooling DSC data $(T_{\\text{onset},\\downarrow}, T_{\\text{peak},\\downarrow}, T_{\\text{comp},\\downarrow})$, with the following values:\n- Case $1$ (general case):\n  - Heating: $T_{\\text{onset},\\uparrow} = 313.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 317.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 320.15\\ \\text{K}$, $L = 220\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 2.0\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n  - Cooling: $T_{\\text{onset},\\downarrow} = 311.15\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 315.15\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 318.15\\ \\text{K}$.\n- Case $2$ (narrow transition):\n  - Heating: $T_{\\text{onset},\\uparrow} = 319.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 320.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 321.15\\ \\text{K}$, $L = 180\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 2.2\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n  - Cooling: $T_{\\text{onset},\\downarrow} = 318.65\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 319.65\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 320.65\\ \\text{K}$.\n- Case $3$ (wide transition):\n  - Heating: $T_{\\text{onset},\\uparrow} = 300.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 310.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 330.15\\ \\text{K}$, $L = 50\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 1.8\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n  - Cooling: $T_{\\text{onset},\\downarrow} = 295.15\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 305.15\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 325.15\\ \\text{K}$.\n\nFor each test case, produce a result list containing the following six quantities:\n- The fitted peak temperature on heating $\\mu_{\\uparrow}$ in $\\text{K}$.\n- The fitted width on heating $\\sigma_{\\uparrow}$ in $\\text{K}$.\n- The peak effective heat capacity $c_{p,\\uparrow}^{\\text{eff}}(\\mu_{\\uparrow})$ in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n- The midpoint shift $\\Delta T_{\\text{mid}} = \\mu_{\\uparrow} - \\mu_{\\downarrow}$ in $\\text{K}$.\n- The width ratio $r_{\\sigma} = \\sigma_{\\downarrow}/\\sigma_{\\uparrow}$ (dimensionless).\n- The hysteresis loop area $A_{\\text{loop}}$ in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}$.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a bracketed comma-separated list with no spaces (for example, $[[x_1,y_1],[x_2,y_2]]$). Concretely, the format must be $[[r_{11},r_{12},r_{13},r_{14},r_{15},r_{16}],[r_{21},r_{22},r_{23},r_{24},r_{25},r_{26}],[r_{31},r_{32},r_{33},r_{34},r_{35},r_{36}]]$.",
            "solution": "The user wants me to solve a problem.\n\n**Step 1: Extract Givens**\n\n- **Model for effective specific heat capacity, $c_p^{\\text{eff}}(T)$**: $c_p^{\\text{eff}}(T) = c_p + L \\, g(T)$.\n- **$c_p$**: baseline sensible specific heat capacity.\n- **$L$**: latent heat of fusion per unit mass.\n- **$g(T)$**: a unimodal probability density function (PDF) that integrates to $1$ over $(-\\infty, \\infty)$.\n- **Liquid fraction, $\\phi(T)$**: $\\phi(T) = \\int_{-\\infty}^{T} g(\\theta)\\, d\\theta$.\n- **Latent enthalpy contribution**: $L \\, \\phi(T)$.\n- **Hysteresis model**: Freezing process (cooling scan) is modeled by a distinct distribution $g_{\\downarrow}(T)$.\n- **Fitting constraints for $g(T)$**:\n    - Anchored at the peak temperature.\n    - Onset and completion temperatures are treated as cumulative quantiles corresponding to probabilities $p_{\\text{low}} = 0.1$ and $p_{\\text{high}} = 0.9$, respectively.\n- **Hysteresis metrics definitions**:\n    - Midpoint shift: $\\Delta T_{\\text{mid}} = T_{0.5, \\uparrow} - T_{0.5, \\downarrow}$, where $\\phi(T_{0.5}) = 0.5$.\n    - Width ratio: $r_{\\sigma} = \\sigma_{\\downarrow}/\\sigma_{\\uparrow}$, where $\\sigma$ is the width parameter of the distribution.\n    - Loop area: $A_{\\text{loop}} = L \\int_{-\\infty}^{\\infty} |\\phi_{\\uparrow}(T) - \\phi_{\\downarrow}(T)| \\, dT$.\n- **Units**: Temperatures in Kelvin ($\\text{K}$), specific heats in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, latent heats in $\\text{kJ}\\,\\text{kg}^{-1}$, loop area in $\\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}$.\n- **Test Case 1**:\n    - Heating: $T_{\\text{onset},\\uparrow} = 313.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 317.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 320.15\\ \\text{K}$, $L = 220\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 2.0\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n    - Cooling: $T_{\\text{onset},\\downarrow} = 311.15\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 315.15\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 318.15\\ \\text{K}$.\n- **Test Case 2**:\n    - Heating: $T_{\\text{onset},\\uparrow} = 319.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 320.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 321.15\\ \\text{K}$, $L = 180\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 2.2\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n    - Cooling: $T_{\\text{onset},\\downarrow} = 318.65\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 319.65\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 320.65\\ \\text{K}$.\n- **Test Case 3**:\n    - Heating: $T_{\\text{onset},\\uparrow} = 300.15\\ \\text{K}$, $T_{\\text{peak},\\uparrow} = 310.15\\ \\text{K}$, $T_{\\text{comp},\\uparrow} = 330.15\\ \\text{K}$, $L = 50\\ \\text{kJ}\\,\\text{kg}^{-1}$, $c_p = 1.8\\ \\text{kJ}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$.\n    - Cooling: $T_{\\text{onset},\\downarrow} = 295.15\\ \\text{K}$, $T_{\\text{peak},\\downarrow} = 305.15\\ \\text{K}$, $T_{\\text{comp},\\downarrow} = 325.15\\ \\text{K}$.\n- **Required output quantities**: $\\mu_{\\uparrow}$, $\\sigma_{\\uparrow}$, $c_{p,\\uparrow}^{\\text{eff}}(\\mu_{\\uparrow})$, $\\Delta T_{\\text{mid}}$, $r_{\\sigma}$, $A_{\\text{loop}}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on established principles of calorimetry and the thermodynamics of phase change. The decomposition of effective heat capacity into sensible and latent parts, and modeling the latent heat release/absorption with a distribution function, is a standard and physically sound approach in materials science and thermal engineering.\n- **Well-Posed**: The problem provides all necessary data and defines the required calculations and output quantities. A specific unimodal PDF must be chosen; the Normal (Gaussian) distribution is a standard and appropriate choice that fits the criteria. The method for parameter fitting is described, and while a minor ambiguity exists regarding the use of asymmetric onset/completion data with a symmetric PDF, a robust interpretation is available and leads to a unique solution.\n- **Objective**: The problem is formulated with precise mathematical definitions and objective numerical data. It requires quantitative analysis, not subjective judgment.\n- **Other checks**: The problem is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, ill-posed, trivial, or outside scientific verifiability. The units are consistent.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A reasoned solution will be provided.\n\nThe problem requires fitting a smooth, unimodal probability density function $g(T)$ to characterize the latent heat contribution to the effective heat capacity $c_p^{\\text{eff}}(T)$. The Normal (Gaussian) distribution is a suitable choice for $g(T)$ due to its unimodality and mathematical tractability.\n\nA Normal distribution is defined by two parameters: the mean $\\mu$, which represents the center of the distribution, and the standard deviation $\\sigma$, which represents its width. The PDF is given by:\n$$ g(T; \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(T-\\mu)^2}{2\\sigma^2}\\right) $$\nThe corresponding cumulative distribution function (CDF), representing the liquid fraction $\\phi(T)$, is:\n$$ \\phi(T; \\mu, \\sigma) = \\int_{-\\infty}^{T} g(\\theta; \\mu, \\sigma) \\, d\\theta = \\Phi\\left(\\frac{T-\\mu}{\\sigma}\\right) $$\nwhere $\\Phi(z)$ is the CDF of the standard normal distribution ($N(0,1)$).\n\n**Parameter Fitting**\n\nWe will fit the parameters $\\mu$ and $\\sigma$ for both the heating ($\\uparrow$) and cooling ($\\downarrow$) processes using the provided DSC data.\n1.  **Mean ($\\mu$)**: The problem states that the distribution $g(T)$ should be \"anchored at the peak temperature.\" This directly implies that the mean $\\mu$ of our Normal distribution should be set to the given peak temperature, $T_{\\text{peak}}$.\n    $$ \\mu_{\\uparrow} = T_{\\text{peak},\\uparrow} \\quad \\text{and} \\quad \\mu_{\\downarrow} = T_{\\text{peak},\\downarrow} $$\n\n2.  **Standard Deviation ($\\sigma$)**: The problem specifies that the onset and completion temperatures correspond to cumulative quantiles $p_{\\text{low}} = 0.1$ and $p_{\\text{high}} = 0.9$. Let $z_p$ be the $p$-th quantile of the standard normal distribution, i.e., $\\Phi(z_p) = p$.\n    The relationships are:\n    $$ \\phi(T_{\\text{onset}}) = \\Phi\\left(\\frac{T_{\\text{onset}}-\\mu}{\\sigma}\\right) = 0.1 \\implies \\frac{T_{\\text{onset}}-\\mu}{\\sigma} = z_{0.1} $$\n    $$ \\phi(T_{\\text{comp}}) = \\Phi\\left(\\frac{T_{\\text{comp}}-\\mu}{\\sigma}\\right) = 0.9 \\implies \\frac{T_{\\text{comp}}-\\mu}{\\sigma} = z_{0.9} $$\n    By subtracting the first equation from the second, we can solve for $\\sigma$:\n    $$ \\frac{T_{\\text{comp}} - T_{\\text{onset}}}{\\sigma} = z_{0.9} - z_{0.1} $$\n    Due to the symmetry of the Normal distribution, $z_{0.1} = -z_{0.9}$. Therefore, $z_{0.9} - z_{0.1} = 2z_{0.9}$.\n    $$ \\sigma = \\frac{T_{\\text{comp}} - T_{\\text{onset}}}{2 z_{0.9}} $$\n    This method robustly uses the defined width of the transition ($10\\%$ to $90\\%$) to determine the distribution's spread. The value of $z_{0.9}$ is a constant, $z_{0.9} = \\Phi^{-1}(0.9) \\approx 1.28155$. We will use this formula to find $\\sigma_{\\uparrow}$ and $\\sigma_{\\downarrow}$ using their respective onset and completion temperatures.\n\n**Calculation of Required Quantities**\n\nFor each test case, we compute the following six quantities:\n1.  **Fitted peak temperature on heating, $\\mu_{\\uparrow}$**: As determined, $\\mu_{\\uparrow} = T_{\\text{peak},\\uparrow}$.\n2.  **Fitted width on heating, $\\sigma_{\\uparrow}$**: Calculated as $\\sigma_{\\uparrow} = (T_{\\text{comp},\\uparrow} - T_{\\text{onset},\\uparrow}) / (2 z_{0.9})$.\n3.  **Peak effective heat capacity, $c_{p,\\uparrow}^{\\text{eff}}(\\mu_{\\uparrow})$**: The effective heat capacity is $c_p^{\\text{eff}}(T) = c_p + L \\, g(T)$. At its peak ($T=\\mu_{\\uparrow}$), the value of the Normal PDF is maximal: $g(\\mu_{\\uparrow}) = 1/(\\sigma_{\\uparrow}\\sqrt{2\\pi})$.\n    $$ c_{p,\\uparrow}^{\\text{eff}}(\\mu_{\\uparrow}) = c_p + \\frac{L}{\\sigma_{\\uparrow}\\sqrt{2\\pi}} $$\n4.  **Midpoint shift, $\\Delta T_{\\text{mid}}$**: This is the difference between the temperatures at which the liquid fraction is $0.5$. For a Normal distribution, $\\phi(T) = 0.5$ occurs precisely at the mean, $T = \\mu$.\n    $$ \\Delta T_{\\text{mid}} = \\mu_{\\uparrow} - \\mu_{\\downarrow} $$\n5.  **Width ratio, $r_{\\sigma}$**: This is the ratio of the fitted standard deviations for cooling and heating.\n    $$ r_{\\sigma} = \\frac{\\sigma_{\\downarrow}}{\\sigma_{\\uparrow}} $$\n6.  **Hysteresis loop area, $A_{\\text{loop}}$**: Defined as $A_{\\text{loop}} = L \\int_{-\\infty}^{\\infty} |\\phi_{\\uparrow}(T) - \\phi_{\\downarrow}(T)| \\, dT$.\n    With the fitted parameters, the integrand is $|\\Phi(\\frac{T-\\mu_{\\uparrow}}{\\sigma_{\\uparrow}}) - \\Phi(\\frac{T-\\mu_{\\downarrow}}{\\sigma_{\\downarrow}})|$. This integral does not have a general closed-form solution and must be evaluated numerically. We use numerical quadrature over a sufficiently wide temperature range (e.g., $\\mu \\pm 10\\sigma$) to accurately capture the integral's value. The latent heat $L$ is taken from the heating data as specified.\n\nThe procedure is applied to each test case to generate the required results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Each case: ((T_onset_up, T_peak_up, T_comp_up, L, c_p), \n    #             (T_onset_down, T_peak_down, T_comp_down))\n    test_cases = [\n        # Case 1 (general case)\n        ((313.15, 317.15, 320.15, 220.0, 2.0),\n         (311.15, 315.15, 318.15)),\n        # Case 2 (narrow transition)\n        ((319.15, 320.15, 321.15, 180.0, 2.2),\n         (318.65, 319.65, 320.65)),\n        # Case 3 (wide transition)\n        ((300.15, 310.15, 330.15, 50.0, 1.8),\n         (295.15, 305.15, 325.15)),\n    ]\n\n    # Pre-calculate the standard normal quantile for p=0.9\n    z_90 = norm.ppf(0.9)\n\n    results = []\n    for heating_params, cooling_params in test_cases:\n        case_results = calculate_metrics(heating_params, cooling_params, z_90)\n        results.append(f\"[{','.join(f'{x:.8f}' for x in case_results)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_metrics(heating_params, cooling_params, z_90):\n    \"\"\"\n    Calculates the six required metrics for a single test case.\n    \n    Args:\n        heating_params (tuple): (T_onset, T_peak, T_comp, L, c_p) for heating.\n        cooling_params (tuple): (T_onset, T_peak, T_comp) for cooling.\n        z_90 (float): Standard normal quantile for p=0.9.\n\n    Returns:\n        list: A list of the six computed metrics.\n    \"\"\"\n    T_onset_up, T_peak_up, T_comp_up, L, c_p = heating_params\n    T_onset_down, T_peak_down, T_comp_down = cooling_params\n\n    # 1. Fit heating parameters (mu_up, sigma_up)\n    mu_up = T_peak_up\n    sigma_up = (T_comp_up - T_onset_up) / (2 * z_90)\n\n    # 2. Calculate peak effective heat capacity\n    # g(T) at peak is 1 / (sigma * sqrt(2*pi))\n    g_peak = 1 / (sigma_up * np.sqrt(2 * np.pi))\n    c_p_eff_peak = c_p + L * g_peak\n\n    # 3. Fit cooling parameters (mu_down, sigma_down)\n    mu_down = T_peak_down\n    sigma_down = (T_comp_down - T_onset_down) / (2 * z_90)\n\n    # 4. Calculate hysteresis metrics\n    # Midpoint shift (delta T_mid)\n    delta_T_mid = mu_up - mu_down\n\n    # Width ratio (r_sigma)\n    # Avoid division by zero, though sigma_up should not be zero here.\n    r_sigma = sigma_down / sigma_up if sigma_up != 0 else np.inf\n\n    # Hysteresis loop area (A_loop)\n    # Integrand: |phi_up(T) - phi_down(T)|\n    integrand = lambda T: np.abs(norm.cdf((T - mu_up) / sigma_up) - \n                                 norm.cdf((T - mu_down) / sigma_down))\n\n    # Define integration limits to be sufficiently wide\n    # Using +-10 standard deviations from each mean should be more than enough\n    lower_bound = min(mu_up - 10 * sigma_up, mu_down - 10 * sigma_down)\n    upper_bound = max(mu_up + 10 * sigma_up, mu_down + 10 * sigma_down)\n\n    # Perform numerical integration\n    integral_val, _ = quad(integrand, lower_bound, upper_bound)\n    A_loop = L * integral_val\n\n    # Collect results\n    return [mu_up, sigma_up, c_p_eff_peak, delta_T_mid, r_sigma, A_loop]\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice is a capstone design challenge, integrating the preceding concepts into a realistic engineering scenario. You will confront a critical trade-off in composite PCMs: the enhancement of thermal conductivity, $k_\\text{eff}$, by adding fillers versus the consequent reduction in latent heat storage capacity, $L_\\text{eff}$. By implementing a transient thermal simulation of a battery module, you will optimize the filler concentration to satisfy a peak temperature constraint , mirroring a genuine task in automated battery design.",
            "id": "3939032",
            "problem": "Consider a single battery module in thermal contact with a slab of composite Phase Change Material (PCM) containing dispersed conductive fillers. The objective is to select the filler volume fraction to balance enhanced conduction and reduced latent heat capacity, and thereby keep the battery peak temperature below a prescribed maximum, under a fixed composite mass budget.\n\nFundamental base and modeling assumptions:\n- Energy conservation for a lumped battery temperature is given by the first law of thermodynamics and Fourier heat conduction: the rate of change of total enthalpy equals internal heat generation minus heat flow to the ambient.\n- The composite PCM is treated as a homogeneous medium whose effective properties depend on the filler volume fraction, consistent with classical effective medium theory for spherical inclusions.\n- Latent heat absorption is modeled by an effective heat capacity over a finite melting interval (enthalpy method).\n\nGeometry and boundary:\n- The battery face is a flat plate of area $A$ in perfect thermal contact with the composite PCM slab of thickness $t$. The opposite side of the slab is held at the ambient temperature $T_{\\text{amb}}$ by a large heat sink.\n- One-dimensional heat conduction through the slab is assumed, and heat flow across the contact is represented by an additional thermal resistance $R_{\\text{contact}}$.\n\nComposite material properties as functions of filler volume fraction $\\phi$:\n- Let $k_m$ and $k_f$ be the thermal conductivities of the PCM matrix and the filler, respectively. The effective thermal conductivity $k_{\\text{eff}}(\\phi)$ follows the Maxwell–Eucken model for spherical inclusions:\n$$\nk_{\\text{eff}}(\\phi) = k_m \\, \\frac{k_f + 2 k_m - 2 \\phi (k_m - k_f)}{k_f + 2 k_m + \\phi (k_m - k_f)}.\n$$\n- Let $\\rho_m$ and $\\rho_f$ be the densities of the PCM matrix and filler. The effective composite density is\n$$\n\\rho_{\\text{eff}}(\\phi) = (1-\\phi) \\rho_m + \\phi \\rho_f.\n$$\n- Let $c_m$ and $c_f$ be the specific heats at constant pressure of the PCM matrix and filler. The effective sensible specific heat of the composite is\n$$\nc_{\\text{sens,eff}}(\\phi) = (1-\\phi) c_m + \\phi c_f.\n$$\n- The latent heat per unit mass of the composite is reduced according to\n$$\nL_{\\text{eff}}(\\phi) = (1-\\phi) L,\n$$\nwhere $L$ is the latent heat of the pure PCM matrix.\n\nThermal resistance and mass budget:\n- The composite mass budget is fixed at $M_c$. The slab thickness is determined by the mass budget and the effective density:\n$$\nt(\\phi) = \\frac{M_c}{\\rho_{\\text{eff}}(\\phi) \\, A}.\n$$\n- The total thermal resistance between the battery and ambient through the slab and contact is\n$$\nR_{\\text{th}}(\\phi) = \\frac{t(\\phi)}{k_{\\text{eff}}(\\phi) \\, A} + R_{\\text{contact}}.\n$$\n\nBattery and PCM thermal model:\n- Let $m_b$ be the battery mass and $c_b$ its specific heat. The battery temperature $T(t)$ is modeled as lumped and spatially uniform. The heat generation rate $q(t)$ within the battery is specified and nonnegative.\n- The effective heat capacity $C_{\\text{eff}}(T,\\phi)$ of the coupled battery–PCM system uses the enthalpy method with a melting interval of width $\\Delta T$ centered at the melting temperature $T_m$, such that:\n$$\nC_{\\text{eff}}(T,\\phi) = m_b c_b + M_c c_{\\text{sens,eff}}(\\phi) + \\chi(T) \\, \\frac{M_c L_{\\text{eff}}(\\phi)}{\\Delta T},\n$$\nwhere the indicator function $\\chi(T)$ equals $1$ if $|T - T_m| \\le \\Delta T/2$ and $0$ otherwise.\n- The energy balance gives the temperature evolution:\n$$\nC_{\\text{eff}}(T,\\phi) \\, \\frac{dT}{dt} = q(t) - \\frac{T(t) - T_{\\text{amb}}}{R_{\\text{th}}(\\phi)}.\n$$\n- Initial condition: $T(0) = T_{\\text{amb}}$.\n\nOptimization problem:\n- Given a maximum allowable peak temperature $T_{\\max}$ and an upper bound on filler fraction $\\phi_{\\max}$, select $\\phi \\in [0,\\phi_{\\max}]$ to satisfy the peak temperature constraint $T_{\\text{peak}}(\\phi) \\le T_{\\max}$ over a specified time horizon while respecting the mass budget $M_c$. Among all feasible $\\phi$, select the smallest $\\phi$ to minimize filler usage. If no $\\phi \\in [0,\\phi_{\\max}]$ is feasible, report no solution.\n\nNumerical requirements:\n- Implement the temperature evolution by explicit time stepping of the differential equation with a constant time step $\\Delta t$, using the indicator form of the enthalpy method described above.\n- For each test case, search over $\\phi$ on a uniform grid over $[0,\\phi_{\\max}]$ with resolution $\\Delta \\phi$, and determine the smallest feasible $\\phi$.\n\nYour program must solve the following three test cases. All quantities must be used with the units indicated.\n\nGlobal constants (shared across test cases):\n- $A = 0.01 \\, \\mathrm{m^2}$.\n- $T_{\\text{amb}} = 298.15 \\, \\mathrm{K}$.\n- $R_{\\text{contact}} = 0.001 \\, \\mathrm{K/W}$.\n- $m_b = 0.8 \\, \\mathrm{kg}$, $c_b = 1000 \\, \\mathrm{J/(kg \\cdot K)}$.\n- PCM matrix properties: $k_m = 0.25 \\, \\mathrm{W/(m \\cdot K)}$, $\\rho_m = 900 \\, \\mathrm{kg/m^3}$, $c_m = 2000 \\, \\mathrm{J/(kg \\cdot K)}$, $L = 250000 \\, \\mathrm{J/kg}$, $T_m = 305 \\, \\mathrm{K}$, $\\Delta T = 6 \\, \\mathrm{K}$.\n- Filler properties: $k_f = 200 \\, \\mathrm{W/(m \\cdot K)}$, $\\rho_f = 2000 \\, \\mathrm{kg/m^3}$, $c_f = 800 \\, \\mathrm{J/(kg \\cdot K)}$.\n- Time stepping: $\\Delta t = 0.5 \\, \\mathrm{s}$, total duration $t_f$ as specified per test case.\n- Filler search grid resolution: $\\Delta \\phi = 0.001$.\n\nTest suite:\n1. Case $1$ (happy path):\n   - Mass budget $M_c = 0.6 \\, \\mathrm{kg}$.\n   - Heat generation $q(t) = Q_0$ for $0 \\le t \\le \\tau$, and $q(t) = 0$ otherwise, with $Q_0 = 80 \\, \\mathrm{W}$, $\\tau = 600 \\, \\mathrm{s}$.\n   - Maximum filler fraction $\\phi_{\\max} = 0.35$.\n   - Temperature constraint $T_{\\max} = 315 \\, \\mathrm{K}$.\n   - Simulation duration $t_f = 1200 \\, \\mathrm{s}$.\n\n2. Case $2$ (stringent constraint, potentially infeasible):\n   - Mass budget $M_c = 0.6 \\, \\mathrm{kg}$.\n   - Heat generation $q(t) = Q_0$ for $0 \\le t \\le \\tau$, and $q(t) = 0$ otherwise, with $Q_0 = 150 \\, \\mathrm{W}$, $\\tau = 600 \\, \\mathrm{s}$.\n   - Maximum filler fraction $\\phi_{\\max} = 0.50$.\n   - Temperature constraint $T_{\\max} = 313 \\, \\mathrm{K}$.\n   - Simulation duration $t_f = 1200 \\, \\mathrm{s}$.\n\n3. Case $3$ (low heat, no melting expected):\n   - Mass budget $M_c = 0.3 \\, \\mathrm{kg}$.\n   - Heat generation $q(t) = Q_0$ for $0 \\le t \\le \\tau$, and $q(t) = 0$ otherwise, with $Q_0 = 30 \\, \\mathrm{W}$, $\\tau = 300 \\, \\mathrm{s}$.\n   - Maximum filler fraction $\\phi_{\\max} = 0.30$.\n   - Temperature constraint $T_{\\max} = 310 \\, \\mathrm{K}$.\n   - Simulation duration $t_f = 900 \\, \\mathrm{s}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the optimal filler volume fractions for the three test cases as a comma-separated Python-style list, with each entry rounded to four decimal places if feasible, or the integer $-1$ if no $\\phi \\in [0,\\phi_{\\max}]$ satisfies the peak temperature constraint. For example: $[0.1234,-1,0.0000]$.",
            "solution": "The problem presented is a well-posed optimization task in the domain of thermal engineering, specifically concerning the thermal management of a battery module using a composite Phase Change Material (PCM). The problem is scientifically grounded in the principles of energy conservation and heat transfer, and all necessary parameters and constitutive models are provided. The formulation is objective and contains no contradictions or ambiguities. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe objective is to find the minimum filler volume fraction, $\\phi$, within a given range $[0, \\phi_{\\max}]$, that ensures the peak temperature of a battery, $T_{\\text{peak}}$, does not exceed a specified maximum, $T_{\\max}$. The search for the optimal $\\phi$ must be performed over a discrete grid with resolution $\\Delta\\phi$.\n\nThe solution methodology involves the following steps:\n1.  **Parameter Discretization and Search**: The continuous design variable $\\phi$ is discretized into a uniform grid of candidate values, $\\phi_j = j \\Delta\\phi$, starting from $\\phi=0$ up to $\\phi_{\\max}$. The search proceeds sequentially through this grid.\n2.  **System Characterization**: For each candidate value of $\\phi$, the effective properties of the composite PCM and the overall thermal resistance of the system are calculated.\n3.  **Transient Thermal Simulation**: The temperature evolution of the battery, $T(t)$, is simulated by numerically integrating the governing ordinary differential equation (ODE) using an explicit time-stepping method.\n4.  **Constraint Evaluation**: The peak temperature, $T_{\\text{peak}}(\\phi) = \\max_{t \\in [0, t_f]} T(t)$, is determined from the simulation. This value is checked against the constraint $T_{\\text{peak}}(\\phi) \\le T_{\\max}$.\n5.  **Optimal Selection**: Since the search proceeds from the smallest $\\phi$ upwards, the first value that satisfies the temperature constraint is the desired minimal solution. If the search completes without finding a feasible $\\phi$, no solution exists within the discretized search space.\n\nThe core of the problem lies in the trade-offs governed by the filler fraction $\\phi$. Increasing $\\phi$ enhances thermal conductivity but reduces latent heat capacity. This balance dictates the system's thermal performance.\n\n**1. Composite Properties as a Function of $\\phi$**\n\nFor a given filler volume fraction $\\phi$, the effective properties of the composite material are calculated using the provided models:\n-   **Effective Thermal Conductivity** ($k_{\\text{eff}}$): The Maxwell–Eucken model describes the conductivity of a matrix with dispersed spherical fillers.\n    $$k_{\\text{eff}}(\\phi) = k_m \\, \\frac{k_f + 2 k_m - 2 \\phi (k_m - k_f)}{k_f + 2 k_m + \\phi (k_m - k_f)}$$\n    An increase in $\\phi$ raises $k_{\\text{eff}}$ because the filler conductivity $k_f$ is much greater than the matrix conductivity $k_m$.\n-   **Effective Density** ($\\rho_{\\text{eff}}$): A simple rule of mixtures based on volume fractions.\n    $$\\rho_{\\text{eff}}(\\phi) = (1-\\phi) \\rho_m + \\phi \\rho_f$$\n    Since $\\rho_f  \\rho_m$, $\\rho_{\\text{eff}}$ increases with $\\phi$.\n-   **Effective Sensible Specific Heat** ($c_{\\text{sens,eff}}$): A rule of mixtures based on mass fractions, which simplifies to the provided form for this problem structure.\n    $$c_{\\text{sens,eff}}(\\phi) = (1-\\phi) c_m + \\phi c_f$$\n-   **Effective Latent Heat** ($L_{\\text{eff}}$): The latent heat capacity is proportional to the mass fraction of the PCM matrix. Since the composite mass is $M_c$, the mass of the matrix is $(1-\\phi)\\rho_m / \\rho_{\\text{eff}}(\\phi) \\cdot M_c$. A simpler, direct reduction per unit mass of the composite is given:\n    $$L_{\\text{eff}}(\\phi) = (1-\\phi) L$$\n    This shows that adding filler directly reduces the latent heat storage capacity per unit mass of the composite.\n\n**2. Thermal Resistance and Mass Budget**\n\nThe fixed mass budget, $M_c$, links the slab thickness, $t$, to the composite density, $\\rho_{\\text{eff}}(\\phi)$:\n$$t(\\phi) = \\frac{M_c}{\\rho_{\\text{eff}}(\\phi) \\, A}$$\nA higher $\\phi$ results in a denser composite and thus a thinner slab for the same mass. The total thermal resistance, $R_{\\text{th}}(\\phi)$, between the battery and the ambient heat sink is the sum of the slab's conductive resistance and the contact resistance:\n$$R_{\\text{th}}(\\phi) = \\frac{t(\\phi)}{k_{\\text{eff}}(\\phi) \\, A} + R_{\\text{contact}} = \\frac{M_c}{\\rho_{\\text{eff}}(\\phi) k_{\\text{eff}}(\\phi) A^2} + R_{\\text{contact}}$$\nIncreasing $\\phi$ increases both $\\rho_{\\text{eff}}$ and $k_{\\text{eff}}$. The product $\\rho_{\\text{eff}} k_{\\text{eff}}$ generally increases faster than linearly, causing $R_{\\text{th}}$ to decrease. This improves steady-state heat dissipation.\n\n**3. Governing Differential Equation and Numerical Integration**\n\nThe thermal behavior of the lumped-capacitance battery-PCM system is governed by the energy balance equation:\n$$C_{\\text{eff}}(T,\\phi) \\, \\frac{dT}{dt} = q(t) - \\frac{T(t) - T_{\\text{amb}}}{R_{\\text{th}}(\\phi)}$$\nThe effective thermal capacitance, $C_{\\text{eff}}(T, \\phi)$, includes contributions from the battery, the sensible heat of the composite, and the latent heat absorbed during melting:\n$$C_{\\text{eff}}(T,\\phi) = m_b c_b + M_c c_{\\text{sens,eff}}(\\phi) + \\chi(T) \\, \\frac{M_c L_{\\text{eff}}(\\phi)}{\\Delta T}$$\nwhere the indicator function $\\chi(T)$ is $1$ if $T_m - \\Delta T/2 \\le T \\le T_m + \\Delta T/2$ and $0$ otherwise. This term represents the substantial increase in thermal capacitance during phase change.\n\nTo solve for $T(t)$, we rearrange the ODE:\n$$\\frac{dT}{dt} = \\frac{1}{C_{\\text{eff}}(T, \\phi)} \\left( q(t) - \\frac{T(t) - T_{\\text{amb}}}{R_{\\text{th}}(\\phi)} \\right)$$\nThis equation is integrated numerically using the explicit Euler forward method, as specified. Given the temperature $T_i$ at time $t_i$, the temperature $T_{i+1}$ at the next time step $t_{i+1} = t_i + \\Delta t$ is:\n$$T_{i+1} = T_i + \\Delta t \\cdot \\left[ \\frac{1}{C_{\\text{eff}}(T_i, \\phi)} \\left( q(t_i) - \\frac{T_i - T_{\\text{amb}}}{R_{\\text{th}}(\\phi)} \\right) \\right]$$\nThe simulation starts with the initial condition $T_0 = T(0) = T_{\\text{amb}}$ and proceeds until the final time $t_f$. The peak temperature $T_{\\text{peak}}$ is recorded throughout this process.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global constants as per problem statement\nA = 0.01  # m^2\nT_AMB = 298.15  # K\nR_CONTACT = 0.001  # K/W\nM_B = 0.8  # kg\nC_B = 1000.0  # J/(kg.K)\n\n# PCM matrix properties\nK_M = 0.25  # W/(m.K)\nRHO_M = 900.0  # kg/m^3\nC_M = 2000.0  # J/(kg.K)\nL = 250000.0  # J/kg\nT_M = 305.0  # K\nDELTA_T_MELT = 6.0  # K\n\n# Filler properties\nK_F = 200.0  # W/(m.K)\nRHO_F = 2000.0  # kg/m^3\nC_F = 800.0  # J/(kg.K)\n\n# Numerical parameters\nDT = 0.5  # s\nDELTA_PHI = 0.001\n\ndef run_simulation(phi, params):\n    \"\"\"\n    Simulates the temperature evolution for a given filler fraction phi and returns the peak temperature.\n    \n    Args:\n        phi (float): The filler volume fraction.\n        params (dict): A dictionary of case-specific parameters.\n\n    Returns:\n        float: The peak temperature reached during the simulation.\n    \"\"\"\n    # Unpack case-specific parameters\n    m_c = params['M_c']\n    q0 = params['Q0']\n    tau = params['tau']\n    t_f = params['t_f']\n    \n    # 1. Calculate effective properties for the given phi\n    # Effective thermal conductivity (Maxwell-Eucken)\n    k_eff_num = K_F + 2 * K_M - 2 * phi * (K_M - K_F)\n    k_eff_den = K_F + 2 * K_M + phi * (K_M - K_F)\n    k_eff = K_M * k_eff_num / k_eff_den\n    \n    # Effective density (Rule of mixtures)\n    rho_eff = (1 - phi) * RHO_M + phi * RHO_F\n    \n    # Effective sensible specific heat (Rule of mixtures)\n    c_sens_eff = ((1 - phi) * RHO_M * C_M + phi * RHO_F * C_F) / rho_eff\n    \n    # The problem statement gives c_sens_eff as (1-phi)c_m + phi*c_f. Let's strictly adhere to that.\n    c_sens_eff = (1-phi) * C_M + phi * C_F\n\n    # Effective latent heat\n    l_eff = (1 - phi) * L\n    \n    # 2. Calculate derived quantities\n    # Slab thickness from mass budget\n    t_phi = m_c / (rho_eff * A)\n    \n    # Total thermal resistance\n    r_th = t_phi / (k_eff * A) + R_CONTACT\n    \n    # 3. Time-stepping simulation\n    num_steps = int(t_f / DT)\n    T = T_AMB\n    T_peak = T_AMB\n    \n    T_melt_min = T_M - DELTA_T_MELT / 2\n    T_melt_max = T_M + DELTA_T_MELT / 2\n    \n    # Pre-calculate constant part of C_eff and latent term\n    c_sens_total = M_B * C_B + m_c * c_sens_eff\n    c_latent_term = m_c * l_eff / DELTA_T_MELT if DELTA_T_MELT  0 else 0\n    \n    for i in range(num_steps):\n        current_time = i * DT\n        \n        # Heat generation pulse\n        q_t = q0 if current_time = tau else 0.0\n        \n        # Effective heat capacity (Enthalpy method) based on indicator function chi(T)\n        is_melting = 1.0 if T_melt_min = T = T_melt_max else 0.0\n        c_eff = c_sens_total + is_melting * c_latent_term\n        \n        # Temperature derivative from the energy balance ODE\n        if c_eff  1e-9: # Avoid division by zero, though c_eff should always be positive\n            dT_dt = (q_t - (T - T_AMB) / r_th) / c_eff\n        else:\n            dT_dt = 0.0\n\n        # Update temperature using Explicit Euler method\n        T += dT_dt * DT\n        \n        # Update peak temperature\n        if T  T_peak:\n            T_peak = T\n            \n    return T_peak\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            'M_c': 0.6, 'Q0': 80.0, 'tau': 600.0, 'phi_max': 0.35, \n            'T_max': 315.0, 't_f': 1200.0\n        },\n        { # Case 2\n            'M_c': 0.6, 'Q0': 150.0, 'tau': 600.0, 'phi_max': 0.50,\n            'T_max': 313.0, 't_f': 1200.0\n        },\n        { # Case 3\n            'M_c': 0.3, 'Q0': 30.0, 'tau': 300.0, 'phi_max': 0.30,\n            'T_max': 310.0, 't_f': 900.0\n        }\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        phi_max = case_params['phi_max']\n        t_max_constraint = case_params['T_max']\n        \n        # Create a uniform grid for phi from 0 to phi_max\n        num_phi_steps = int(round(phi_max / DELTA_PHI)) + 1\n        phi_grid = np.linspace(0, phi_max, num_phi_steps)\n        \n        found_solution = False\n        for phi in phi_grid:\n            peak_temp = run_simulation(phi, case_params)\n            \n            # Check if the peak temperature constraint is satisfied\n            if peak_temp = t_max_constraint:\n                results.append(f\"{phi:.4f}\")\n                found_solution = True\n                break  # Found the smallest feasible phi, move to next case\n        \n        if not found_solution:\n            results.append(\"-1\")\n            \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}