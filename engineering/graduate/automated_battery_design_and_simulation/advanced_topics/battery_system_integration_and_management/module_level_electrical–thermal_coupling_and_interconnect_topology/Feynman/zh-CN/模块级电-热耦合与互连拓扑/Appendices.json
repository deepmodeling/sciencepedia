{
    "hands_on_practices": [
        {
            "introduction": "在分析电池模块的电热性能时，首要步骤是建立其等效电路模型。本练习将指导您应用基尔霍夫定律，分析包含母线、连接片及接触电阻在内的复杂互连拓扑，从而揭示不同支路电阻的微小差异如何导致并联电芯间产生显著的电流不均衡现象。理解并量化这种不均衡对于确保模块的性能、安全性和寿命至关重要。",
            "id": "3930497",
            "problem": "一个方形锂离子电池模组由连接到公共正负汇流排的两个并联串来表示。每个串由串联的电芯堆、极耳触点和特定支路互连段组成。汇流排本身在分流到两个串之前具有一个公共电阻。在自动化电池设计和仿真中，模组级的电-热耦合要求从第一性原理出发，将包括接触电阻在内的互连拓扑结构纳入电网络，并将电损耗映射为热源。为进行电气计算，假设在 $T=298\\,\\mathrm{K}$ 下为等温条件。\n\n从欧姆定律 ($V=IR$)、基尔霍夫电压定律 (KVL) 和基尔霍夫电流定律 (KCL) 出发，按如下方式对双串网络进行建模：\n- 一个恒定的总线电压 $V=36\\,\\mathrm{V}$ 施加在模组两端。\n- 正极汇流排在分流到两个支路段之前有一个公共段电阻 $R_{p,s}=0.040\\,\\mathrm{\\Omega}$，两个支路段的电阻分别为 $r_{p,a}=0.030\\,\\mathrm{\\Omega}$ 和 $r_{p,b}=0.020\\,\\mathrm{\\Omega}$，分别馈入串 $a$ 和串 $b$。\n- 负极汇流排在分流到两个支路段之前有一个公共段电阻 $R_{n,s}=0.040\\,\\mathrm{\\Omega}$，两个支路段的电阻分别为 $r_{n,a}=0.030\\,\\mathrm{\\Omega}$ 和 $r_{n,b}=0.020\\,\\mathrm{\\Omega}$，分别从串 $a$ 和串 $b$ 返回。\n- 串 $a$ 的聚合串联内阻为 $R_{\\text{cell},a}=1.44\\,\\mathrm{\\Omega}$，极耳接触电阻为 $R_{c+,a}=0.020\\,\\mathrm{\\Omega}$ 和 $R_{c-,a}=0.020\\,\\mathrm{\\Omega}$。\n- 串 $b$ 的聚合串联内阻为 $R_{\\text{cell},b}=1.36\\,\\mathrm{\\Omega}$，极耳接触电阻为 $R_{c+,b}=0.015\\,\\mathrm{\\Omega}$ 和 $R_{c-,b}=0.015\\,\\mathrm{\\Omega}$。\n\n将公共汇流排段视为承载总模组电流，并将特定支路的段、触点和内阻视为每个支路中的串联元件。在这些假设下，使用 KCL 和 KVL 推导支路电流 $I_a$ 和 $I_b$ 的表达式。然后，假设由于夹紧压力的变化，串 $a$ 的正极耳接触电阻增加一倍，使得 $R_{c+,a}$ 变为 $2\\times 0.020\\,\\mathrm{\\Omega}$。计算在这个翻倍的接触电阻下，串 $a$ 和串 $b$ 的新支路电流。\n\n以安培 ($\\mathrm{A}$) 为单位表示最终电流，并将您的数值结果四舍五入到 $4$ 位有效数字。您的最终答案必须只包含一个单行矩阵中的两个电流值。",
            "solution": "该问题陈述清晰，具有科学依据，并包含推导唯一解所需的所有必要信息。这是一个基于基本电气原理的标准直流电路分析问题。\n\n该电池模组可以建模为一个电路。一个恒定电压源 $V$ 施加在模组两端。该电压驱动总电流 $I$流经一个公共电阻 $R_s$。然后电流分流到两个并联支路，即串 $a$ 和串 $b$，其电流分别为 $I_a$ 和 $I_b$。每个支路包含一系列阻性元件。\n\n首先，我们根据所提供的数据定义每个组件组的总电阻。\n公共电阻 $R_s$ 是正负公共汇流排段电阻之和：\n$$R_s = R_{p,s} + R_{n,s}$$\n串 $a$ 的总电阻（表示为 $R_a$）是其特定支路互连件、极耳触点和电芯内阻的总和：\n$$R_a = r_{p,a} + R_{c+,a} + R_{\\text{cell},a} + R_{c-,a} + r_{n,a}$$\n同样，串 $b$ 的总电阻（表示为 $R_b$）是：\n$$R_b = r_{p,b} + R_{c+,b} + R_{\\text{cell},b} + R_{c-,b} + r_{n,b}$$\n\n根据基尔霍夫电流定律 (KCL)，流入并联节点的总电流 $I$ 必须等于流出节点的电流之和：\n$$I = I_a + I_b$$\n\n根据基尔霍夫电压定律 (KVL)，任何闭合回路周围的电压降之和必须等于所施加的总电压。我们可以为包含每个支路的回路写出两个 KVL 方程：\n对于通过支路 $a$ 的回路：\n$$V = I R_s + I_a R_a$$\n对于通过支路 $b$ 的回路：\n$$V = I R_s + I_b R_b$$\n\n从这两个 KVL 方程可以清楚地看出，电路并联部分的电压降对于两个支路是相同的：\n$$I_a R_a = I_b R_b$$\n这种关系允许我们用另一个支路电流来表示一个支路电流。例如：\n$$I_b = I_a \\frac{R_a}{R_b}$$\n\n为了推导 $I_a$ 的表达式，我们将 $I = I_a + I_b$ 和 $I_b$ 的表达式代入包含支路 a 的回路的 KVL 方程中：\n$$V = (I_a + I_b) R_s + I_a R_a$$\n$$V = \\left(I_a + I_a \\frac{R_a}{R_b}\\right) R_s + I_a R_a$$\n提出因子 $I_a$：\n$$V = I_a \\left[ \\left(1 + \\frac{R_a}{R_b}\\right) R_s + R_a \\right]$$\n$$V = I_a \\left[ \\frac{R_b + R_a}{R_b} R_s + R_a \\right]$$\n$$V = I_a \\left[ \\frac{(R_a + R_b)R_s + R_a R_b}{R_b} \\right]$$\n求解 $I_a$：\n$$I_a = V \\frac{R_b}{R_a R_b + (R_a + R_b)R_s}$$\n通过对称性，我们可以通过交换下标 'a' 和 'b' 来找到 $I_b$ 的表达式：\n$$I_b = V \\frac{R_a}{R_b R_a + (R_b + R_a)R_s}$$\n\n问题要求我们计算串 $a$ 的正极耳接触电阻加倍后的新支路电流。我们用 $R_{c+,a}$ 表示原始电阻，用 $R'_{c+,a}$ 表示新电阻。\n$$R'_{c+,a} = 2 \\times R_{c+,a}$$\n这个变化影响了支路 $a$ 的总电阻，产生了一个新值 $R'_a$。支路 $b$ 的电阻 $R_b$ 保持不变。\n$$R'_a = r_{p,a} + R'_{c+,a} + R_{\\text{cell},a} + R_{c-,a} + r_{n,a}$$\n新的电流 $I'_a$ 和 $I'_b$ 则由以下公式给出：\n$$I'_a = V \\frac{R_b}{R'_a R_b + (R'_a + R_b)R_s}$$\n$$I'_b = V \\frac{R'_a}{R'_a R_b + (R'_a + R_b)R_s}$$\n\n现在我们代入给定的数值。所有电阻的单位都是欧姆 ($\\mathrm{\\Omega}$)。\n$V = 36\\,\\mathrm{V}$\n$R_{p,s} = 0.040\\,\\mathrm{\\Omega}$, $R_{n,s} = 0.040\\,\\mathrm{\\Omega}$\n$r_{p,a} = 0.030\\,\\mathrm{\\Omega}$, $r_{n,a} = 0.030\\,\\mathrm{\\Omega}$\n$r_{p,b} = 0.020\\,\\mathrm{\\Omega}$, $r_{n,b} = 0.020\\,\\mathrm{\\Omega}$\n$R_{\\text{cell},a} = 1.44\\,\\mathrm{\\Omega}$, $R_{c-,a} = 0.020\\,\\mathrm{\\Omega}$\n$R_{\\text{cell},b} = 1.36\\,\\mathrm{\\Omega}$, $R_{c+,b} = 0.015\\,\\mathrm{\\Omega}$, $R_{c-,b} = 0.015\\,\\mathrm{\\Omega}$\n串 $a$ 的正极耳接触电阻的原始值为 $R_{c+,a} = 0.020\\,\\mathrm{\\Omega}$。该值加倍，因此新电阻为：\n$$R'_{c+,a} = 2 \\times 0.020\\,\\mathrm{\\Omega} = 0.040\\,\\mathrm{\\Omega}$$\n首先，我们计算 $R_s$、$R_b$ 和新的 $R'_a$ 的值：\n$$R_s = R_{p,s} + R_{n,s} = 0.040 + 0.040 = 0.080\\,\\mathrm{\\Omega}$$\n$$R_b = r_{p,b} + R_{c+,b} + R_{\\text{cell},b} + R_{c-,b} + r_{n,b} = 0.020 + 0.015 + 1.36 + 0.015 + 0.020 = 1.43\\,\\mathrm{\\Omega}$$\n$$R'_a = r_{p,a} + R'_{c+,a} + R_{\\text{cell},a} + R_{c-,a} + r_{n,a} = 0.030 + 0.040 + 1.44 + 0.020 + 0.030 = 1.56\\,\\mathrm{\\Omega}$$\n\n接下来，我们计算电流表达式的公分母，$D = R'_a R_b + (R'_a + R_b)R_s$：\n$$D = (1.56)(1.43) + (1.56 + 1.43)(0.080)$$\n$$D = 2.2308 + (2.99)(0.080)$$\n$$D = 2.2308 + 0.2392 = 2.47$$\n现在我们可以计算新电流 $I'_a$ 和 $I'_b$：\n$$I'_a = V \\frac{R_b}{D} = 36 \\times \\frac{1.43}{2.47} = \\frac{51.48}{2.47} \\approx 20.842105... \\,\\mathrm{A}$$\n$$I'_b = V \\frac{R'_a}{D} = 36 \\times \\frac{1.56}{2.47} = \\frac{56.16}{2.47} \\approx 22.736842... \\,\\mathrm{A}$$\n\n问题要求将最终数值结果四舍五入到 4 位有效数字。\n$$I'_a \\approx 20.84\\,\\mathrm{A}$$\n$$I'_b \\approx 22.74\\,\\mathrm{A}$$\n这些是接触电阻变化后串 $a$ 和串 $b$ 的新支路电流。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n20.84  22.74\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了电流在各互连件中的分布后，下一步是分析其热学后果。本练习将焦耳热（$q=\\rho J^{2}$）与一维热传导方程相结合，推导电流承载母线内部的稳态温度分布。通过这个实践，您将学会如何将电路中的电能损耗与具体部件的温度梯度联系起来，这是从集总参数模型迈向更精确的分布式热分析的关键一步。",
            "id": "3930564",
            "problem": "一个电池模组采用一个直的铜母线排互连件，其长度为 $L$，均匀横截面积为 $A$，导热系数为 $k$，用于在电芯组之间传导稳定的直流电流 $I$。在所关注的工作温度范围内，铜具有恒定的电阻率 $\\rho$。假设电流密度沿母线排空间均匀分布，材料属性恒定，且通过对流和辐射的热损失可以忽略不计。热量仅通过沿母线排向位于 $x=0$ 处的冷端机械锚点传导而被移除，该锚点维持在恒定温度 $T_{c}$。位于 $x=L$ 的远端由于设计上连接到一个比母线排热阻大得多的柔性极耳叠片，因此是绝热的。将热传导视为沿 $x$ 轴的一维（$1$D）传导。\n\n从能量守恒定律、傅里叶热传导定律以及焦耳热关系式 $q=\\rho J^{2}$（其中电流密度 $J=I/A$ 是均匀的）出发，在边界条件 $T(0)=T_{c}$ 和 $x=L$ 处绝热的情况下，推导沿母线排的稳态温升 $\\Delta T(x)=T(x)-T_{c}$（$0 \\le x \\le L$）。将最终答案表示为以开尔文为单位的单一闭式解析表达式 $\\Delta T(x)$，不要引入任何额外的假设。不需要进行数值代入，也不需要四舍五入。",
            "solution": "该问题要求推导在一个有内部热源生成和一维热传导的载流母线排中的稳态温度分布。\n\n带均匀内部热源的一维稳态热传导的控制方程源于对长度为 $dx$ 的微分单元的能量平衡。该方程的一般形式为：\n$$ \\frac{d}{dx} \\left( k A \\frac{dT}{dx} \\right) + \\dot{q}_{gen} A = 0 $$\n其中 $T(x)$ 是作为位置 $x$ 函数的温度，$k$ 是导热系数，$A$ 是横截面积，$\\dot{q}_{gen}$ 是体积生热率。\n\n问题陈述 $k$ 和 $A$ 是常数。因此，方程简化为：\n$$ k A \\frac{d^2T}{dx^2} + \\dot{q}_{gen} A = 0 $$\n$$ \\frac{d^2T}{dx^2} = -\\frac{\\dot{q}_{gen}}{k} $$\n\n体积生热率 $\\dot{q}_{gen}$ 是由焦耳热引起的。问题给出了关系式 $q = \\rho J^2$，我们将其识别为 $\\dot{q}_{gen}$。电流密度 $J$ 是均匀的，由 $J = I/A$ 给出，其中 $I$ 是总的稳态直流电流。电阻率 $\\rho$ 是恒定的。将这些代入 $\\dot{q}_{gen}$ 的表达式中：\n$$ \\dot{q}_{gen} = \\rho \\left(\\frac{I}{A}\\right)^2 = \\frac{\\rho I^2}{A^2} $$\n\n将这个 $\\dot{q}_{gen}$ 的表达式代入热方程，得到温度分布 $T(x)$ 的特定二阶常微分方程：\n$$ \\frac{d^2T}{dx^2} = -\\frac{\\rho I^2}{k A^2} $$\n为简洁起见，将右侧的常数项表示为 $C = -\\frac{\\rho I^2}{k A^2}$。\n\n为了求得温度分布 $T(x)$，我们对该微分方程对 $x$ 积分两次。第一次积分得到温度梯度：\n$$ \\frac{dT}{dx} = \\int \\left(-\\frac{\\rho I^2}{k A^2}\\right) dx = -\\frac{\\rho I^2}{k A^2} x + C_1 $$\n其中 $C_1$ 是第一个积分常数。\n\n第二次积分得到温度分布的通解：\n$$ T(x) = \\int \\left(-\\frac{\\rho I^2}{k A^2} x + C_1\\right) dx = -\\frac{\\rho I^2}{2 k A^2} x^2 + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n接下来，我们应用指定的边界条件来确定常数 $C_1$ 和 $C_2$。\n\n边界条件 1：在 $x=0$ 处，母线排连接到一个维持在恒定温度 $T_c$ 的冷端锚点。\n$$ T(0) = T_c $$\n将此条件应用于 $T(x)$ 的通解：\n$$ T(0) = -\\frac{\\rho I^2}{2 k A^2} (0)^2 + C_1 (0) + C_2 = T_c $$\n这得出 $C_2 = T_c$。\n\n边界条件 2：在远端 $x=L$ 处，母线排是绝热的。这是一个绝热边界条件，意味着该点的热通量为零。根据傅里叶热传导定律，热通量 $q_x$ 由 $q_x = -k A \\frac{dT}{dx}$ 给出。因此，绝热条件意味着温度梯度为零。\n$$ \\frac{dT}{dx} \\bigg|_{x=L} = 0 $$\n将此条件应用于温度梯度的表达式：\n$$ \\frac{dT}{dx} \\bigg|_{x=L} = -\\frac{\\rho I^2}{k A^2} L + C_1 = 0 $$\n求解 $C_1$：\n$$ C_1 = \\frac{\\rho I^2 L}{k A^2} $$\n\n现在，我们将已确定的常数 $C_1$ 和 $C_2$ 代回 $T(x)$ 的通解中：\n$$ T(x) = -\\frac{\\rho I^2}{2 k A^2} x^2 + \\left(\\frac{\\rho I^2 L}{k A^2}\\right) x + T_c $$\n\n问题要求的是温升 $\\Delta T(x) = T(x) - T_c$。我们从 $T(x)$ 方程的两边减去 $T_c$：\n$$ \\Delta T(x) = T(x) - T_c = -\\frac{\\rho I^2}{2 k A^2} x^2 + \\frac{\\rho I^2 L}{k A^2} x $$\n\n为了以更紧凑的形式呈现，我们可以提取公因式：\n$$ \\Delta T(x) = \\frac{\\rho I^2}{k A^2} \\left( L x - \\frac{x^2}{2} \\right) $$\n或者，这可以写成：\n$$ \\Delta T(x) = \\frac{\\rho I^2 x}{2 k A^2} (2L - x) $$\n该表达式表示沿母线排的抛物线形温升，最高温度出现在绝热端 $x=L$。",
            "answer": "$$\n\\boxed{\\frac{\\rho I^2}{k A^2} \\left( L x - \\frac{x^2}{2} \\right)}\n$$"
        },
        {
            "introduction": "电池模块设计的核心挑战在于处理电学行为与热学状态之间复杂的双向耦合。本练习将引导您建立一个动态耦合模型，其中电芯电阻随温度变化，而温度又由电阻产生的焦耳热驱动。通过构建并求解这组耦合常微分方程（ODEs），您将能够模拟电流分担的暂态过程及其对热失衡的敏感性，这是进行高级电池管理系统设计和故障诊断的必备技能。",
            "id": "3930548",
            "problem": "考虑一个由 $M$ 个并联电化学电池组成的电池模组，其互连拓扑被建模为每个电池与公共母线之间的串联电阻链路。每个电池支路 $i$ 都有一个取决于其温度的内部欧姆电阻，记为 $R_{\\text{cell},i}\\!\\left(T_i\\right)$，以及一个串联互连电阻 $R_{\\text{int},i}$。该支路还有一个小的集总电感 $L_i$，用于捕捉母线电压阶跃下电流的快速动态特性。母线电压被指定为一个已知函数 $V_{\\text{bus}}\\!\\left(t\\right)$，并且每个电池都有一个开路电压 $E_i$，在所关注的时间范围内假设为常数。热动态特性由每个电池的集总热容 $C_{\\text{th},i}$ 表示，与环境的对流传热通过与环境温度 $T_{\\text{amb}}$ 之间的热导 $H_i$ 建模，与相邻电池的传导耦合则通过一个无向互连拓扑图上的对称热导矩阵 $K_{ij}$ 捕捉。\n\n严格从基本定律和核心定义出发，推导并实现控制瞬态电流 $I_i\\!\\left(t\\right)$ 和温度 $T_i\\!\\left(t\\right)$ (其中 $i=1,\\dots,M$) 的耦合常微分方程 (ODEs)。使用以下基本依据：\n\n- 欧姆定律和基尔霍夫电压定律 (KVL)：对于支路 $i$，电感和电阻上的瞬时电压降等于施加的母线到电池的电压差，强制执行 $L_i\\,\\dfrac{d I_i}{dt}$ 加上电阻压降。\n- 焦耳热：在电池内阻上耗散的电功率等于 $I_i^2\\,R_{\\text{cell},i}\\!\\left(T_i\\right)$。\n- 集总热能平衡：电池 $i$ 的热能变化率等于净产热减去向环境的散热，再加上与相邻电池的传导交换。\n- 温敏电阻模型：$R_{\\text{cell},i}\\!\\left(T_i\\right)$ 遵循一个相对于参考温度的线性温度系数。\n\n您必须首先使用这些基本依据和指定的模型选择，以 $I_i\\!\\left(t\\right)$ 和 $T_i\\!\\left(t\\right)$ 的形式建立耦合 ODEs。然后实现一个程序，对提供的测试套件中的这些 ODEs 进行数值积分。使用以下显式函数形式和模型选择：\n\n- 每个支路 $i$ 的电动特性：使用母线电压的 KVL 给出\n$$\nL_i\\,\\frac{d I_i}{dt} \\;=\\; V_{\\text{bus}}\\!\\left(t\\right) - E_i \\;-\\; \\bigl(R_{\\text{cell},i}\\!\\left(T_i\\right) + R_{\\text{int},i}\\bigr)\\,I_i.\n$$\n- 温敏内阻：\n$$\nR_{\\text{cell},i}\\!\\left(T_i\\right) \\;=\\; R_{0,i}\\,\\bigl(1 + \\alpha_i\\,(T_i - T_{\\text{ref}})\\bigr).\n$$\n- 每个电池 $i$ 的热动态特性：\n$$\nC_{\\text{th},i}\\,\\frac{d T_i}{dt} \\;=\\; I_i^2\\,R_{\\text{cell},i}\\!\\left(T_i\\right) \\;-\\; H_i\\,(T_i - T_{\\text{amb}}) \\;+\\; \\sum_{j=1}^{M} K_{ij}\\,(T_j - T_i),\n$$\n其中 $K_{ii} = 0$ 且 $K_{ij} = K_{ji}$。\n\n所有测试用例的初始条件为\n$$\nI_i(0) = 0 \\text{ A},\\quad T_i(0) = T_{\\text{amb}} \\text{ K}.\n$$\n\n您的程序必须在有限时间范围内对这些 ODEs 进行积分，并为每个测试用例计算一个标量指标，用以量化电-热耦合下的瞬态电流分配情况。将最终时刻 $t_{\\text{end}}$ 的电流不均衡比定义为\n$$\nS \\;=\\; \\frac{\\max_{i} I_i(t_{\\text{end}})}{\\min_{i} I_i(t_{\\text{end}})},\n$$\n以无单位小数表示。为确保覆盖性，请使用以下代表不同互连拓扑和耦合强度的参数值测试套件。在所有情况下，设置 $M = 3$ 和一个恒定的母线电压阶跃 $V_{\\text{bus}}\\!\\left(t\\right) = V_{\\text{step}}$：\n\n- 测试用例 1 (具有不匹配互连和中等热耦合的一般情况)：\n    - $V_{\\text{step}} = 4.10 \\text{ V}$，$E_i = 4.00 \\text{ V}$ (对所有 $i$)。\n    - $L_i = 5.0\\times 10^{-6} \\text{ H}$ (对所有 $i$)。\n    - $R_{0,i} = 3.0\\times 10^{-3} \\text{ }\\Omega$ (对所有 $i$)，$\\alpha_i = 2.0\\times 10^{-3} \\text{ K}^{-1}$ (对所有 $i$)，$T_{\\text{ref}} = 298.15 \\text{ K}$。\n    - $R_{\\text{int}} = [5.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,1.5\\times 10^{-3}] \\text{ }\\Omega$。\n    - $C_{\\text{th},i} = 150.0 \\text{ J/K}$ (对所有 $i$)，$H_i = 4.0 \\text{ W/K}$ (对所有 $i$)，$T_{\\text{amb}} = 298.15 \\text{ K}$。\n    - 热导矩阵仅在线性拓扑中的相邻单元之间非零：$K_{12} = K_{21} = 0.8 \\text{ W/K}$，$K_{23} = K_{32} = 0.8 \\text{ W/K}$，以及 $K_{13} = K_{31} = 0$。\n    - 最终时间 $t_{\\text{end}} = 10.0 \\text{ s}$。\n- 测试用例 2 (具有相同互连且无温度系数的边界情况)：\n    - $V_{\\text{step}} = 4.10 \\text{ V}$，$E_i = 4.00 \\text{ V}$ (对所有 $i$)。\n    - $L_i = 5.0\\times 10^{-6} \\text{ H}$ (对所有 $i$)。\n    - $R_{0,i} = 3.0\\times 10^{-3} \\text{ }\\Omega$ (对所有 $i$)，$\\alpha_i = 0.0 \\text{ K}^{-1}$ (对所有 $i$)，$T_{\\text{ref}} = 298.15 \\text{ K}$。\n    - $R_{\\text{int}} = [1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3}] \\text{ }\\Omega$。\n    - $C_{\\text{th},i} = 150.0 \\text{ J/K}$ (对所有 $i$)，$H_i = 4.0 \\text{ W/K}$ (对所有 $i$)，$T_{\\text{amb}} = 298.15 \\text{ K}$。\n    - 热导矩阵全为零：$K_{ij} = 0$ (对所有 $i,j$)。\n    - 最终时间 $t_{\\text{end}} = 10.0 \\text{ s}$。\n- 测试用例 3 (具有高温度系数和较弱冷却的边缘情况)：\n    - $V_{\\text{step}} = 4.10 \\text{ V}$，$E_i = 4.00 \\text{ V}$ (对所有 $i$)。\n    - $L_i = 5.0\\times 10^{-6} \\text{ H}$ (对所有 $i$)。\n    - $R_{0,i} = 3.0\\times 10^{-3} \\text{ }\\Omega$ (对所有 $i$)，$\\alpha_i = 1.0\\times 10^{-2} \\text{ K}^{-1}$ (对所有 $i$)，$T_{\\text{ref}} = 298.15 \\text{ K}$。\n    - $R_{\\text{int}} = [5.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,1.5\\times 10^{-3}] \\text{ }\\Omega$。\n    - $C_{\\text{th},i} = 150.0 \\text{ J/K}$ (对所有 $i$)，$H_i = 2.0 \\text{ W/K}$ (对所有 $i$)，$T_{\\text{amb}} = 298.15 \\text{ K}$。\n    - 热导矩阵仅在相邻单元之间非零：$K_{12} = K_{21} = 0.4 \\text{ W/K}$，$K_{23} = K_{32} = 0.4 \\text{ W/K}$，以及 $K_{13} = K_{31} = 0$。\n    - 最终时间 $t_{\\text{end}} = 10.0 \\text{ s}$。\n- 测试用例 4 (强热耦合和较弱对流)：\n    - $V_{\\text{step}} = 4.10 \\text{ V}$，$E_i = 4.00 \\text{ V}$ (对所有 $i$)。\n    - $L_i = 5.0\\times 10^{-6} \\text{ H}$ (对所有 $i$)。\n    - $R_{0,i} = 3.0\\times 10^{-3} \\text{ }\\Omega$ (对所有 $i$)，$\\alpha_i = 2.0\\times 10^{-3} \\text{ K}^{-1}$ (对所有 $i$)，$T_{\\text{ref}} = 298.15 \\text{ K}$。\n    - $R_{\\text{int}} = [5.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,1.5\\times 10^{-3}] \\text{ }\\Omega$。\n    - $C_{\\text{th},i} = 150.0 \\text{ J/K}$ (对所有 $i$)，$H_i = 1.5 \\text{ W/K}$ (对所有 $i$)，$T_{\\text{amb}} = 298.15 \\text{ K}$。\n    - 热导矩阵仅在相邻单元之间非零：$K_{12} = K_{21} = 3.0 \\text{ W/K}$，$K_{23} = K_{32} = 3.0 \\text{ W/K}$，以及 $K_{13} = K_{31} = 0$。\n    - 最终时间 $t_{\\text{end}} = 15.0 \\text{ s}$。\n\n您的程序必须为每个测试用例生成电流不均衡比 $S$，四舍五入到六位小数，并输出一行包含这些值的逗号分隔列表，并用方括号括起来，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。不应打印任何其他文本。比率 $S$ 是无单位的，必须表示为小数。本问题不涉及角度。数值积分应使用适合潜在刚性 ODEs 的稳健方法完成。生成的列表条目必须是浮点数。通过遵循给定的参数值并正确实现电学和热学状态之间通过 $R_{\\text{cell},i}\\!\\left(T_i\\right)$ 和 $K_{ij}$ 的耦合项，来确保科学真实性。",
            "solution": "问题陈述已经过仔细审查，并被确定为 **有效**。它在科学上基于电路理论和传热学原理，在数学上是作为一个常微分方程组 (ODEs) 的初值问题而适定的，并提供了一套完整且一致的参数和条件。\n\n任务是为一个由 `$M=3$` 个并联电池组成的电池模组的耦合电-热瞬态行为建模。系统在任何时刻 `$t$` 的状态可以用一个大小为 `$2M = 6$` 的状态向量 `$y(t)$` 来描述。这个向量连接了每个电池 `$i=1, 2, 3$` 的电流 `$I_i(t)$` 和温度 `$T_i(t)$`。\n$$\ny(t) = [I_1(t), I_2(t), I_3(t), T_1(t), T_2(t), T_3(t)]^T\n$$\n这个状态向量的演化由一个一阶 ODEs 系统 `$\\frac{dy}{dt} = f(t, y)$` 控制。我们将根据所提供的物理定律和模型方程来构建函数 `$f(t, y)$`。\n\n**1. 耦合 ODE 系统的构建**\n\n该系统由 `$M=3$` 个电学方程和 `$M=3$` 个热学方程组成。\n\n**电动特性：**\n对于每个支路 `$i$`，应用基尔霍夫电压定律 (KVL)。电感上的电压降 (`$L_i \\frac{dI_i}{dt}$`) 加上总串联电阻上的电压降，必须等于施加在该支路上的净电压，即母线电压 `$V_{\\text{bus}}(t)$` 减去电池的开路电压 `$E_i$`。总电阻是温敏内阻 `$R_{\\text{cell},i}(T_i)$` 和固定互连电阻 `$R_{\\text{int},i}$` 的和。这得出了问题中提供的方程：\n$$\nL_i \\frac{dI_i}{dt} = V_{\\text{bus}}(t) - E_i - \\left(R_{\\text{cell},i}(T_i) + R_{\\text{int},i}\\right) I_i\n$$\n温敏电阻由一个线性模型给出：\n$$\nR_{\\text{cell},i}(T_i) = R_{0,i} \\left(1 + \\alpha_i (T_i - T_{\\text{ref}})\\right)\n$$\n将此代入 KVL 方程并分离出导数 `$\\frac{dI_i}{dt}$`，我们得到 ODE 系统的前 `$M=3$` 个分量：\n$$\n\\frac{dI_i}{dt} = \\frac{1}{L_i} \\left[ V_{\\text{bus}}(t) - E_i - \\left( R_{0,i} (1 + \\alpha_i (T_i - T_{\\text{ref}})) + R_{\\text{int},i} \\right) I_i \\right] \\quad \\text{for } i=1, 2, 3.\n$$\n\n**热动态特性：**\n对于每个电池 `$i$`，热动态特性由能量守恒原理控制。热能变化率 `$C_{\\text{th},i} \\frac{dT_i}{dt}$` 等于净热量增加率。这个净率包括三个部分：\n1.  **焦耳热（产热）：** 由于电流 `$I_i$` 流过内阻 `$R_{\\text{cell},i}(T_i)$`，内部会产生热量。作为热量耗散的功率为 `$P_{\\text{gen},i} = I_i^2 R_{\\text{cell},i}(T_i)$`。\n2.  **对流冷却（散热）：** 热量散失到周围环境中。这被建模为与温度为 `$T_{\\text{amb}}$` 的环境之间通过热导 `$H_i$` 进行的对流传热。散热率为 `$P_{\\text{loss},i} = H_i (T_i - T_{\\text{amb}})$`。\n3.  **传导交换（传递）：** 热量通过传导路径与相邻电池 `$j$` 进行交换，由一个热导矩阵 `$K_{ij}$` 建模。从所有相邻单元流入电池 `$i$` 的净热流率为 `$P_{\\text{cond},i} = \\sum_{j=1}^{M} K_{ij} (T_j - T_i)$`。\n\n综合这些项，得到能量平衡方程：\n$$\nC_{\\text{th},i} \\frac{dT_i}{dt} = I_i^2 R_{\\text{cell},i}(T_i) - H_i (T_i - T_{\\text{amb}}) + \\sum_{j=1}^{M} K_{ij} (T_j - T_i)\n$$\n分离出导数 `$\\frac{dT_i}{dt}$`，得到我们 ODE 系统的最后 `$M=3$` 个分量：\n$$\n\\frac{dT_i}{dt} = \\frac{1}{C_{\\text{th},i}} \\left[ I_i^2 R_{0,i} (1 + \\alpha_i (T_i - T_{\\text{ref}})) - H_i (T_i - T_{\\text{amb}}) + \\sum_{j=1}^{M} K_{ij} (T_j - T_i) \\right] \\quad \\text{for } i=1, 2, 3.\n$$\n\n**2. 数值积分**\n\n完整的系统包含 `$6$` 个耦合、一阶、非线性的 ODEs。问题给出了初始条件 `$I_i(0) = 0 \\text{ A}$` 和 `$T_i(0) = T_{\\text{amb}}$`。电动特性的特征时间尺度（约为 `$L/R \\approx 10^{-3} \\text{ s}$` 量级）和热动态特性的特征时间尺度（约为 `$C_{th}/H \\approx 40 \\text{ s}$` 量级）差异巨大。这种差异表明该系统是数值刚性的。因此，必须使用适合刚性 ODEs 的数值求解器来确保解的稳定性和效率。`scipy.integrate.solve_ivp` 中可用的 `Radau` 或 `BDF` 方法是合适的选择。我们将使用 `Radau`。\n\n对于每个测试用例，将在时间区间 `$[0, t_{\\text{end}}]$` 上执行积分。\n\n**3. 指标计算**\n\n求解 ODE 系统后，我们得到指定最终时间 `$t_{\\text{end}}$` 时的状态向量 `$y(t_{\\text{end}})$`。从这个向量中，我们提取每个电池的最终电流 `$I_i(t_{\\text{end}})$`。然后，电流不均衡比 `$S$` 计算为所有电池中最大最终电流与最小最终电流的比值：\n$$\nS = \\frac{\\max_{i} I_i(t_{\\text{end}})}{\\min_{i} I_i(t_{\\text{end}})}\n$$\n对提供的四个测试用例中的每一个重复此过程，并报告所得的 `$S$` 值。该实现将封装在一个 Python 脚本中，使用 `numpy` 库进行向量化计算，并使用 `scipy.integrate.solve_ivp` 进行数值积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coupled electro-thermal ODEs for a battery module\n    and calculates the current imbalance ratio for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: General case\n        {\n            \"V_step\": 4.10, \"E\": 4.00,\n            \"L\": 5.0e-6,\n            \"R0\": 3.0e-3, \"alpha\": 2.0e-3, \"T_ref\": 298.15,\n            \"R_int\": np.array([5.0e-4, 1.0e-3, 1.5e-3]),\n            \"C_th\": 150.0, \"H\": 4.0, \"T_amb\": 298.15,\n            \"K\": np.array([[0, 0.8, 0], [0.8, 0, 0.8], [0, 0.8, 0]]),\n            \"t_end\": 10.0\n        },\n        # Test Case 2: Identical interconnects, no temperature coefficient\n        {\n            \"V_step\": 4.10, \"E\": 4.00,\n            \"L\": 5.0e-6,\n            \"R0\": 3.0e-3, \"alpha\": 0.0, \"T_ref\": 298.15,\n            \"R_int\": np.array([1.0e-3, 1.0e-3, 1.0e-3]),\n            \"C_th\": 150.0, \"H\": 4.0, \"T_amb\": 298.15,\n            \"K\": np.zeros((3, 3)),\n            \"t_end\": 10.0\n        },\n        # Test Case 3: High temperature coefficient, weaker cooling\n        {\n            \"V_step\": 4.10, \"E\": 4.00,\n            \"L\": 5.0e-6,\n            \"R0\": 3.0e-3, \"alpha\": 1.0e-2, \"T_ref\": 298.15,\n            \"R_int\": np.array([5.0e-4, 1.0e-3, 1.5e-3]),\n            \"C_th\": 150.0, \"H\": 2.0, \"T_amb\": 298.15,\n            \"K\": np.array([[0, 0.4, 0], [0.4, 0, 0.4], [0, 0.4, 0]]),\n            \"t_end\": 10.0\n        },\n        # Test Case 4: Strong thermal coupling, weaker convection\n        {\n            \"V_step\": 4.10, \"E\": 4.00,\n            \"L\": 5.0e-6,\n            \"R0\": 3.0e-3, \"alpha\": 2.0e-3, \"T_ref\": 298.15,\n            \"R_int\": np.array([5.0e-4, 1.0e-3, 1.5e-3]),\n            \"C_th\": 150.0, \"H\": 1.5, \"T_amb\": 298.15,\n            \"K\": np.array([[0, 3.0, 0], [3.0, 0, 3.0], [0, 3.0, 0]]),\n            \"t_end\": 15.0\n        }\n    ]\n\n    results = []\n    \n    M = 3 # Number of cells\n\n    for case in test_cases:\n        # Unpack parameters\n        V_step = case[\"V_step\"]\n        # Convert scalar parameters to numpy arrays for vectorization\n        E = np.full(M, case[\"E\"])\n        L = np.full(M, case[\"L\"])\n        R0 = np.full(M, case[\"R0\"])\n        alpha = np.full(M, case[\"alpha\"])\n        T_ref = case[\"T_ref\"]\n        R_int = case[\"R_int\"]\n        C_th = np.full(M, case[\"C_th\"])\n        H = np.full(M, case[\"H\"])\n        T_amb = case[\"T_amb\"]\n        K = case[\"K\"]\n        t_end = case[\"t_end\"]\n        \n        # Pre-calculate for efficiency inside the ODE function\n        K_row_sum = np.sum(K, axis=1)\n\n        def ode_system(t, y):\n            \"\"\"\n            Defines the system of 2M coupled ODEs.\n            y = [I_1, ..., I_M, T_1, ..., T_M]\n            \"\"\"\n            I = y[0:M]\n            T = y[M:2*M]\n\n            # Electrical dynamics\n            R_cell = R0 * (1 + alpha * (T - T_ref))\n            dI_dt = (1 / L) * (V_step - E - (R_cell + R_int) * I)\n\n            # Thermal dynamics\n            joule_heating = I**2 * R_cell\n            convection_loss = H * (T - T_amb)\n            # Net conductive heat flow into each cell\n            conduction_exchange = K @ T - T * K_row_sum\n            \n            dT_dt = (1 / C_th) * (joule_heating - convection_loss + conduction_exchange)\n\n            return np.concatenate((dI_dt, dT_dt))\n\n        # Initial conditions: I_i(0)=0, T_i(0)=T_amb\n        y0 = np.zeros(2 * M)\n        y0[M:2*M] = T_amb\n\n        # Time span for integration\n        t_span = (0, t_end)\n        \n        # Solve the ODE system using a method for stiff problems\n        sol = solve_ivp(ode_system, t_span, y0, method='Radau', rtol=1e-6, atol=1e-9)\n        \n        # Extract currents at the final time\n        final_currents = sol.y[0:M, -1]\n        \n        # Calculate imbalance ratio S\n        # Handle potential division by zero, although not expected here\n        min_I = np.min(final_currents)\n        if min_I > 0:\n            S = np.max(final_currents) / min_I\n        else:\n            S = np.inf # Should not happen in these test cases\n        \n        results.append(f\"{S:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}