{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的多物理场仿真之前，建立对关键物理过程时间尺度的直观理解至关重要。本练习将指导您从热传导第一性原理出发，通过量纲分析推导出特征热扩散时间，并将其应用于评估一维热模型在模拟电池内部短路等快速瞬态事件时的适用性。通过这项基础计算，您可以掌握在何种条件下简化模型是合理且有效的，这是高效建模的关键一步。",
            "id": "3921550",
            "problem": "一个圆柱形卷绕式锂离子电池经历了一次局部的内部短路 (ISC) 事件，在短时间内于轴向中面附近沉积了热量。为了评估一维 (1D) 厚度方向热模型是否足以模拟此类短时事件中的早期瞬态过程，请比较热量在电极-隔膜堆叠层厚度方向和卷芯半径方向上的扩散时间尺度。请从热传导方程和基本热物理定义出发，不使用任何预先推导的简化关系，通过量纲分析推导出特征扩散时间尺度。\n\n请考虑复合堆叠层和卷芯的以下科学上合理的均质化等效属性和尺寸：\n- 等效质量密度：$\\rho = 2.2 \\times 10^{3}\\ \\mathrm{kg\\,m^{-3}}$，\n- 等效比热容：$c_{p} = 9.0 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，\n- 分层电极-隔膜堆叠层的等效厚度方向热导率：$k_{z} = 0.55\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，\n- 卷芯的等效径向热导率：$k_{r} = 0.20\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，\n- 电极-隔膜堆叠层厚度（两个涂层加隔膜，视为一个平板）：$L_{z} = 1.5 \\times 10^{-4}\\ \\mathrm{m}$，\n- 从 ISC 位置到电池外壳的特征径向长度：$L_{r} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$。\n\n使用热传导方程和量纲分析，推导沿厚度方向的特征热扩散时间 $t_{z}$ 和沿半径方向的特征热扩散时间 $t_{r}$，并利用这些时间推断在哪种事件持续时间 $t_{\\mathrm{event}}$ 的范围内，一维厚度方向热模型在短时瞬态过程中是足够的（即，当厚度方向的温度梯度已经弛豫，但径向的热量重新分布仍然有限时）。作为您的最终数值输出，请报告比值 $t_{r}/t_{z}$。将您的最终比值四舍五入至三位有效数字，并以科学记数法的纯数（无量纲）形式表示。",
            "solution": "分析始于固体传热的基本控制方程——热传导方程。在没有流体运动并考虑一个潜在内部热源 $\\dot{q}$ 的情况下，该方程为：\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + \\dot{q}\n$$\n此处，$\\rho$ 是质量密度，$c_p$ 是定压比热容，$T$ 是温度，$t$ 是时间，$k$ 是热导率（在各向异性材料中可以是一个张量），$\\dot{q}$ 是体积生热率。\n\n特征热扩散时间 $\\tau$ 是热量扩散通过一个特征长度 $L$ 的时间尺度。为了推导这个时间尺度，我们对热方程的瞬态项和扩散项进行量纲分析，因为扩散时间尺度是热传播的内在属性，与源项 $\\dot{q}$ 无关。我们将瞬态项与热通量项的散度相平衡：\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} \\sim \\nabla \\cdot (k \\nabla T)\n$$\n我们用特征尺度替换微分算子。设 $\\Delta T$ 为长度尺度 $L$ 上的特征温差，$\\tau$ 为此热变化发生的特征时间。\n左侧（瞬态项）的尺度为：\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} \\sim \\rho c_p \\frac{\\Delta T}{\\tau}\n$$\n右侧（扩散项）的尺度为：\n$$\n\\nabla \\cdot (k \\nabla T) \\sim \\frac{k \\Delta T}{L^2}\n$$\n令这两项的尺度相等，可得：\n$$\n\\rho c_p \\frac{\\Delta T}{\\tau} \\sim \\frac{k \\Delta T}{L^2}\n$$\n特征温差 $\\Delta T$ 被消去，留下特征时间 $\\tau$ 的关系式：\n$$\n\\tau \\sim \\frac{\\rho c_p L^2}{k}\n$$\n此表达式代表了热扩散的特征时间。它通常用热扩散率 $\\alpha$ 来表示，其定义为 $\\alpha = \\frac{k}{\\rho c_p}$。使用此定义，尺度关系变为 $\\tau \\sim \\frac{L^2}{\\alpha}$。题目要求从基本属性推导，因此我们将使用完整的表达式。\n\n题目指定了两个主要的热流方向，每个方向都有其自身的特征长度和热导率。我们将推导出的尺度关系应用于每个方向。\n\n1.  **厚度方向的扩散时间 ($t_z$):**\n    对于沿电极-隔膜堆叠层厚度方向的扩散，特征长度为 $L_z$，相关热导率为等效厚度方向值 $k_z$。相应的特征时间 $t_z$ 为：\n    $$\n    t_z = \\frac{\\rho c_p L_z^2}{k_z}\n    $$\n\n2.  **径向扩散时间 ($t_r$):**\n    对于沿卷芯半径方向的扩散，特征长度为 $L_r$，热导率为等效径向值 $k_r$。相应的特征时间 $t_r$ 为：\n    $$\n    t_r = \\frac{\\rho c_p L_r^2}{k_r}\n    $$\n    题目要求计算这两个时间尺度的比值 $\\frac{t_r}{t_z}$。我们可以象征性地构建这个比值：\n    $$\n    \\frac{t_r}{t_z} = \\frac{\\left( \\frac{\\rho c_p L_r^2}{k_r} \\right)}{\\left( \\frac{\\rho c_p L_z^2}{k_z} \\right)}\n    $$\n    材料属性 $\\rho$ 和 $c_p$ 被视为整个体积的均质化等效属性，因此它们被消去：\n    $$\n    \\frac{t_r}{t_z} = \\frac{L_r^2}{k_r} \\cdot \\frac{k_z}{L_z^2} = \\left(\\frac{k_z}{k_r}\\right) \\left(\\frac{L_r}{L_z}\\right)^2\n    $$\n    此表达式表明，时间尺度的比值取决于热导率的比值和特征长度比值的平方。\n\n当热量有足够的时间在厚度方向上达到平衡，但还没有足够的时间径向扩散时，一维 (1D) 厚度方向热模型是一个合理的近似。这对应于事件持续时间 $t_{\\mathrm{event}}$ 满足条件 $t_z \\ll t_{\\mathrm{event}} \\ll t_r$。一个大的 $t_r/t_z$ 比值表明存在这样一个宽泛的中间时间区域，这为在短暂、局部热量沉积事件后使用简化的 1D 模型进行早期瞬态分析提供了依据。\n\n现在我们将给定的数值代入推导出的比值表达式中：\n-   $k_z = 0.55\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $k_r = 0.20\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $L_z = 1.5 \\times 10^{-4}\\ \\mathrm{m}$\n-   $L_r = 8.0 \\times 10^{-3}\\ \\mathrm{m}$\n\n比值计算如下：\n$$\n\\frac{t_r}{t_z} = \\left(\\frac{0.55}{0.20}\\right) \\left(\\frac{8.0 \\times 10^{-3}}{1.5 \\times 10^{-4}}\\right)^2\n$$\n$$\n\\frac{t_r}{t_z} = (2.75) \\left(\\frac{80}{1.5}\\right)^2 = (2.75) \\left(\\frac{160}{3}\\right)^2\n$$\n$$\n\\frac{t_r}{t_z} = (2.75) \\left(\\frac{25600}{9}\\right) = \\frac{11}{4} \\cdot \\frac{25600}{9} = 11 \\cdot \\frac{6400}{9} = \\frac{70400}{9}\n$$\n$$\n\\frac{t_r}{t_z} \\approx 7822.22...\n$$\n题目要求最终答案四舍五入至三位有效数字，并用科学记数法表示。\n$$\n\\frac{t_r}{t_z} \\approx 7.82 \\times 10^3\n$$\n这个很大的值证实了径向热扩散远慢于厚度方向的热扩散，从而提供了一个宽广的时间窗口，在此窗口内，一维模型是一个有效的简化。",
            "answer": "$$\n\\boxed{7.82 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "为了准确预测由内部短路引发的热失控，我们必须理解电流如何在电池复杂的多层结构中重新分布，并最终导致局部过热。本练习将引导您构建一个圆柱形卷绕电芯的集电体多层传输线模型，这是一个强大的耦合电热分析方法。通过求解这个网络模型，您将能够模拟短路发生后电流在各层之间的流动路径，并最终定位由此产生的热点位置。",
            "id": "3921506",
            "problem": "给定一个圆柱形卷绕式电极堆的多层电阻-电热网络模型。该卷绕式电极堆被建模为 $L$ 个同心层，每层沿其卷绕方向离散为 $M$ 段，每层形成一个闭合的一维环。每个环的每一段都具有均匀的串联电阻。内部短路被建模为单个并联电阻器，它将选定的一个偶数索引层的某一段连接到相邻奇数索引层的同一段，从而绕过了隔膜。外部端子在每层上表示为固定电势（狄利克雷）节点：所有偶数索引层在段索引 $s_{+}$ 处有一个节点固定在 $+V_{\\mathrm{OC}}/2$，所有奇数索引层在段索引 $s_{-}$ 处有一个节点固定在 $-V_{\\mathrm{OC}}/2$，其中 $V_{\\mathrm{OC}}$ 是电池的开路电压。\n\n使用基尔霍夫电流定律（KCL）、欧姆定律和稳态热平衡来计算各层间的电流重新分布和由此产生的温度场，然后预测热点位置。您必须使用的基本定律是：\n\n- 欧姆定律：对于电阻为 $R_{ij}$ 的任意连接节点 $i$ 和节点 $j$ 的电学边，其支路电流为 $I_{ij} = (V_i - V_j)/R_{ij}$。\n- 基尔霍夫电流定律：对于每个没有固定电势的电学节点 $i$，$\\sum_{j \\in \\mathcal{N}(i)} I_{ij} = 0$，其中 $\\mathcal{N}(i)$ 是其电学上连接的邻居节点。\n- 每个热学节点 $i$ 的稳态热平衡：$\\sum_{j \\in \\mathcal{N}_T(i)} k_{ij} (T_i - T_j) + h_i (T_i - T_{\\mathrm{amb}}) = q_i$，其中 $k_{ij}$ 是到邻居节点 $j$ 的热导，$h_i$ 是到环境的热导，$T_{\\mathrm{amb}}$ 是环境温度，$q_i$ 是节点 $i$ 处的焦耳热输入。\n\n电学网络规范：\n\n- 层索引为 $l \\in \\{0,1,\\dots,L-1\\}$，段索引为 $s \\in \\{0,1,\\dots,M-1\\}$。节点索引映射为 $p = l M + s$。\n- 每层 $l$ 是一个环，每个节点有两个电学邻居：节点 $(l,s)$ 通过每段电阻 $R_{\\mathrm{seg}}$ 连接到 $(l,(s+1) \\bmod M)$ 和 $(l,(s-1) \\bmod M)$；对应的电导为 $g_{\\mathrm{seg}} = 1/R_{\\mathrm{seg}}$。\n- 单个内部短路通过电阻 $R_{\\mathrm{short}}$（电导 $g_{\\mathrm{short}} = 1/R_{\\mathrm{short}}$）连接节点 $(l_a, s_{\\mathrm{short}})$ 和节点 $(l_b, s_{\\mathrm{short}})$，其中 $l_a$ 为偶数，$l_b = l_a + 1$ 为奇数。\n- 固定电势节点：对于每个偶数 $l$，节点 $(l, s_{+})$ 的电势为 $V_{l,s_+} = +V_{\\mathrm{OC}}/2$；对于每个奇数 $l$，节点 $(l, s_{-})$ 的电势为 $V_{l,s_-} = -V_{\\mathrm{OC}}/2$。\n\n热学网络规范：\n\n- 节点 $(l,s)$ 的热学邻居是其层内环形邻居 $(l,(s\\pm 1) \\bmod M)$（热导为 $k_{\\mathrm{in}}$），以及层间邻居 $(l-1,s)$ 和 $(l+1,s)$（当在边界内时）（热导为 $k_{\\mathrm{lay}}$）。\n- 每个节点通过热导 $h$ 与环境温度为 $T_{\\mathrm{amb}}$ 的环境耦合。\n- 节点 $i$ 处的焦耳热 $q_i$ 是通过将每个电阻器的总焦耳功率 $P_{ij} = I_{ij}^2 R_{ij}$ 的一半分配给其两个关联节点来计算的。\n\n任务：\n\n1. 在给定极耳节点的固定电势和内部短路电阻的情况下，建立并求解 KCL 方程组，以获得所有节点的电势 $V_{l,s}$。\n2. 计算所有电学边（环段和短路）的支路电流，以及每个节点处的总焦耳热 $q_{l,s}$。\n3. 建立并求解稳态热学系统，以获得所有节点的温度 $T_{l,s}$。\n4. 将具有最高温度的节点 $(l^\\ast,s^\\ast)$ 确定为热点位置，并计算短路电流的大小 $I_{\\mathrm{short}} = |(V_{l_a,s_{\\mathrm{short}}} - V_{l_b,s_{\\mathrm{short}}})/R_{\\mathrm{short}}|$。\n\n答案格式和单位：\n\n- 对于每个测试用例，输出一个列表 $[l^\\ast, s^\\ast, I_{\\mathrm{short}}]$，其中 $l^\\ast$ 和 $s^\\ast$ 是整数，$I_{\\mathrm{short}}$ 是一个以安培（A）为单位的浮点数，四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含所有给定测试用例的结果，格式为一个用方括号括起来的逗号分隔列表，不含空格，例如：$[[l_1^\\ast,s_1^\\ast,I_{\\mathrm{short},1}],[l_2^\\ast,s_2^\\ast,I_{\\mathrm{short},2}]]$。\n\n测试套件：\n\n为以下测试用例提供结果。所有物理参数值对于稳态分析都是科学上合理的，并且是自洽的。\n\n- 案例 A（通用多层，极耳偏移，中等程度短路）：\n  - $L = 6$, $M = 16$\n  - $V_{\\mathrm{OC}} = 4.2\\ \\mathrm{V}$\n  - $R_{\\mathrm{seg}} = 0.02\\ \\Omega$\n  - $R_{\\mathrm{short}} = 0.001\\ \\Omega$\n  - $s_{+} = 0$, $s_{-} = 8$\n  - 在 $s_{\\mathrm{short}} = 7$ 处，$l_a = 2$ 和 $l_b = 3$ 之间发生短路\n  - 热学参数：$k_{\\mathrm{in}} = 0.25\\ \\mathrm{W/K}$, $k_{\\mathrm{lay}} = 0.08\\ \\mathrm{W/K}$, $h = 0.06\\ \\mathrm{W/K}$, $T_{\\mathrm{amb}} = 298\\ \\mathrm{K}$\n\n- 案例 B（边界情况：极耳与短路位置重合，层间导热性更强，与环境耦合度低）：\n  - $L = 4$, $M = 12$\n  - $V_{\\mathrm{OC}} = 3.7\\ \\mathrm{V}$\n  - $R_{\\mathrm{seg}} = 0.03\\ \\Omega$\n  - $R_{\\mathrm{short}} = 0.0005\\ \\Omega$\n  - $s_{+} = 0$, $s_{-} = 0$\n  - 在 $s_{\\mathrm{short}} = 0$ 处，$l_a = 0$ 和 $l_b = 1$ 之间发生短路\n  - 热学参数：$k_{\\mathrm{in}} = 0.30\\ \\mathrm{W/K}$, $k_{\\mathrm{lay}} = 0.20\\ \\mathrm{W/K}$, $h = 0.02\\ \\mathrm{W/K}$, $T_{\\mathrm{amb}} = 300\\ \\mathrm{K}$\n\n- 案例 C（边缘情况：长路径，更高环电阻，中等程度短路）：\n  - $L = 8$, $M = 20$\n  - $V_{\\mathrm{OC}} = 4.0\\ \\mathrm{V}$\n  - $R_{\\mathrm{seg}} = 0.20\\ \\Omega$\n  - $R_{\\mathrm{short}} = 0.0002\\ \\Omega$\n  - $s_{+} = 10$, $s_{-} = 10$\n  - 在 $s_{\\mathrm{short}} = 15$ 处，$l_a = 4$ 和 $l_b = 5$ 之间发生短路\n  - 热学参数：$k_{\\mathrm{in}} = 0.15\\ \\mathrm{W/K}$, $k_{\\mathrm{lay}} = 0.05\\ \\mathrm{W/K}$, $h = 0.10\\ \\mathrm{W/K}$, $T_{\\mathrm{amb}} = 295\\ \\mathrm{K}$\n\n你的程序必须实现上述物理模型，求解电学和热学线性系统，并输出每个案例的热点索引和短路电流大小（单位：安培 A），四舍五入到三位小数，并汇总为上述描述的单行格式。",
            "solution": "该问题是有效的。它是一个在计算物理领域，特别是在耦合电热分析领域中，有科学依据且适定的问题。所有必要的参数和边界条件都已提供，并且其物理原理——欧姆定律、基尔霍夫电流定律和稳态热方程——是合理的。任务定义清晰，并遵循从电学分析到热学分析的逻辑顺序。因此，我们可以进行正式求解。\n\n该问题要求解两个耦合的线性系统，分别代表离散化的电池卷芯的电学和热学行为。求解过程按照问题陈述中概述的四个连续阶段进行。\n\n**1. 电势场求解**\n\n第一步是确定网格中每个节点 $(l,s)$ 的电势 $V_{l,s}$，其中 $l \\in \\{0, 1, \\dots, L-1\\}$ 是层索引，$s \\in \\{0, 1, \\dots, M-1\\}$ 是段索引。总节点数为 $N = LM$。节点电势由基尔霍夫电流定律（KCL）控制，该定律规定流入任何节点的电流总和必须为零。对于任何未设定固定电势的节点 $i$，可表示为：\n$$\n\\sum_{j \\in \\mathcal{N}(i)} I_{ij} = 0\n$$\n其中 $\\mathcal{N}(i)$ 是与节点 $i$ 电学连接的节点集合，$I_{ij}$ 是从节点 $j$ 流向节点 $i$ 的电流。根据欧姆定律，$I_{ij} = (V_j - V_i)/R_{ij} = g_{ij}(V_j - V_i)$，其中 $g_{ij} = 1/R_{ij}$ 是电导，KCL方程变为：\n$$\n\\sum_{j \\in \\mathcal{N}(i)} g_{ij}(V_j - V_i) = 0 \\implies \\left(\\sum_{j \\in \\mathcal{N}(i)} g_{ij}\\right) V_i - \\sum_{j \\in \\mathcal{N}(i)} g_{ij} V_j = 0\n$$\n该公式构成一个线性方程组。一部分被称为“极耳”的节点，其电势由狄利克雷边界条件固定：对于偶数层 $l$，$V_{l,s_+} = +V_{\\mathrm{OC}}/2$；对于奇数层 $l$，$V_{l,s_-} = -V_{\\mathrm{OC}}/2$。其余节点是“自由”节点。我们可以为 $N_{\\mathrm{free}}$ 个自由节点的电势建立一个线性系统。\n\n设 $\\mathbf{V}_{\\mathrm{free}}$ 是自由节点处未知电势的向量。该系统为 $\\mathbf{G}_{\\mathrm{free}} \\mathbf{V}_{\\mathrm{free}} = \\mathbf{I}_{\\mathrm{src}}$，其中 $\\mathbf{G}_{\\mathrm{free}}$ 是自由节点子图的 $N_{\\mathrm{free}} \\times N_{\\mathrm{free}}$ 电导矩阵，$\\mathbf{I}_{\\mathrm{src}}$ 是由与固定电势节点的连接产生的电流源向量。\n- 对于一个自由节点 $i$，矩阵的对角元素为 $G_{ii} = \\sum_{j \\in \\mathcal{N}(i)} g_{ij}$。\n- 对于一个相连的自由节点 $j$，非对角元素为 $G_{ij} = -g_{ij}$。\n- 节点 $i$ 的源项为 $I_i = \\sum_{k \\in \\mathcal{N}_{\\mathrm{fixed}}(i)} g_{ik} V_k$，其中 $\\mathcal{N}_{\\mathrm{fixed}}(i)$ 是 $i$ 的固定电势邻居。\n\n节点 $(l,s)$ 的电学连接包括其两个环形邻居 $(l, (s \\pm 1) \\pmod M)$（电导为 $g_{\\mathrm{seg}} = 1/R_{\\mathrm{seg}}$），以及两个特定节点 $(l_a, s_{\\mathrm{short}})$ 和 $(l_b, s_{\\mathrm{short}})$ 之间的一个额外连接（电导为 $g_{\\mathrm{short}} = 1/R_{\\mathrm{short}}$）。构建此稀疏线性系统后，我们使用标准线性求解器求解 $\\mathbf{V}_{\\mathrm{free}}$。然后，从 $\\mathbf{V}_{\\mathrm{free}}$ 和已知的固定电势组装完整的电势场 $\\mathbf{V}$。\n\n**2. 焦耳热生成**\n\n有了完整的电势场 $\\mathbf{V}$，我们计算电流流过时产生的焦耳热。连接节点 $i$ 和 $j$ 的每个电阻元件中耗散的功率为：\n$$\nP_{ij} = I_{ij}^2 R_{ij} = \\frac{(V_i - V_j)^2}{R_{ij}}\n$$\n根据问题规范，该功率平均分配给其连接的两个节点。节点 $i$ 产生的总热量 $q_i$ 是所有相连电阻贡献的总和：\n$$\nq_i = \\sum_{j \\in \\mathcal{N}(i)} \\frac{1}{2} P_{ij} = \\frac{1}{2} \\sum_{j \\in \\mathcal{N}(i)} \\frac{(V_i - V_j)^2}{R_{ij}}\n$$\n对所有电学连接（层内段和短路路径）执行此计算，以创建一个大小为 $N$ 的热源向量 $\\mathbf{q}$。短路电流的大小也在此阶段计算：$I_{\\mathrm{short}} = |(V_{l_a,s_{\\mathrm{short}}} - V_{l_b,s_{\\mathrm{short}}}) / R_{\\mathrm{short}}|$。\n\n**3. 温度场求解**\n\n温度场 $\\mathbf{T}$ 通过求解每个节点 $i$ 的稳态热平衡方程来确定：\n$$\n\\sum_{j \\in \\mathcal{N}_T(i)} k_{ij} (T_i - T_j) + h (T_i - T_{\\mathrm{amb}}) = q_i\n$$\n其中 $\\mathcal{N}_T(i)$ 是热学连接的邻居集合，$k_{ij}$ 是节点 $i$ 和 $j$ 之间的热导，$h$ 是每个节点到环境的热导，$T_{\\mathrm{amb}}$ 是环境温度，$q_i$ 是先前计算的焦耳热源项。\n\n重新整理节点 $i$ 的方程可得：\n$$\n\\left(h + \\sum_{j \\in \\mathcal{N}_T(i)} k_{ij}\\right) T_i - \\sum_{j \\in \\mathcal{N}_T(i)} k_{ij} T_j = q_i + h T_{\\mathrm{amb}}\n$$\n这构成了温度向量 $\\mathbf{T}$（大小为 $N$）的线性系统 $\\mathbf{K} \\mathbf{T} = \\mathbf{f}$。\n- 热导矩阵 $\\mathbf{K}$ 的对角元素为 $K_{ii} = h + \\sum_{j \\in \\mathcal{N}_T(i)} k_{ij}$，非对角元素为 $K_{ij} = -k_{ij}$（对于热学连接的节点 $i$ 和 $j$）。\n- 热源向量 $\\mathbf{f}$ 的元素为 $f_i = q_i + h T_{\\mathrm{amb}}$。\n\n节点 $(l,s)$ 的热学邻居是其层内邻居 $(l, (s \\pm 1) \\pmod M)$（热导为 $k_{\\mathrm{in}}$）及其层间邻居 $(l \\pm 1, s)$（如果存在）（热导为 $k_{\\mathrm{lay}}$）。构建 $N \\times N$ 矩阵 $\\mathbf{K}$ 和向量 $\\mathbf{f}$ 后，求解该系统得到温度向量 $\\mathbf{T}$。\n\n**4. 热点识别**\n\n最后的任务是确定热点的位置，即温度最高的节点。我们找到索引 $p^*$ 使得 $T_{p^*} = \\max(\\mathbf{T})$。然后将此线性索引映射回层和段索引 $(l^*, s^*)$，使用 $l^* = \\lfloor p^*/M \\rfloor$ 和 $s^* = p^* \\pmod M$。每个测试用例的最终结果是三元组 $[l^*, s^*, I_{\\mathrm{short}}]$。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the electro-thermal problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case A\n        {'L': 6, 'M': 16, 'V_OC': 4.2, 'R_seg': 0.02, 'R_short': 0.001,\n         's_plus': 0, 's_minus': 8, 'l_a': 2, 'l_b': 3, 's_short': 7,\n         'k_in': 0.25, 'k_lay': 0.08, 'h': 0.06, 'T_amb': 298.0},\n        # Case B\n        {'L': 4, 'M': 12, 'V_OC': 3.7, 'R_seg': 0.03, 'R_short': 0.0005,\n         's_plus': 0, 's_minus': 0, 'l_a': 0, 'l_b': 1, 's_short': 0,\n         'k_in': 0.30, 'k_lay': 0.20, 'h': 0.02, 'T_amb': 300.0},\n        # Case C\n        {'L': 8, 'M': 20, 'V_OC': 4.0, 'R_seg': 0.20, 'R_short': 0.0002,\n         's_plus': 10, 's_minus': 10, 'l_a': 4, 'l_b': 5, 's_short': 15,\n         'k_in': 0.15, 'k_lay': 0.05, 'h': 0.10, 'T_amb': 295.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_for_case(params)\n        results.append(result)\n\n    # Format output as a list of lists with no spaces\n    result_strs = [f\"[{r[0]},{r[1]},{r[2]:.3f}]\" for r in results]\n    print(f\"[{','.join(result_strs)}]\")\n\ndef compute_for_case(params):\n    \"\"\"\n    Solves the electro-thermal problem for a single parameter set.\n    \"\"\"\n    L, M, V_OC, R_seg, R_short = params['L'], params['M'], params['V_OC'], params['R_seg'], params['R_short']\n    s_plus, s_minus, l_a, l_b, s_short = params['s_plus'], params['s_minus'], params['l_a'], params['l_b'], params['s_short']\n    k_in, k_lay, h, T_amb = params['k_in'], params['k_lay'], params['h'], params['T_amb']\n\n    N = L * M\n    g_seg = 1.0 / R_seg\n    g_short = 1.0 / R_short\n    V_plus = V_OC / 2.0\n    V_minus = -V_OC / 2.0\n\n    # ----- 1. Electrical System Setup -----\n    node_map = lambda l, s: l * M + s\n\n    fixed_indices = set()\n    fixed_potentials = {}\n    for l in range(L):\n        if l % 2 == 0:  # Even layer\n            idx = node_map(l, s_plus)\n            fixed_indices.add(idx)\n            fixed_potentials[idx] = V_plus\n        else:  # Odd layer\n            idx = node_map(l, s_minus)\n            fixed_indices.add(idx)\n            fixed_potentials[idx] = V_minus\n    \n    free_indices = [i for i in range(N) if i not in fixed_indices]\n    free_idx_map = {p: i for i, p in enumerate(free_indices)}\n    N_free = len(free_indices)\n\n    G_free = np.zeros((N_free, N_free))\n    I_src = np.zeros(N_free)\n\n    # Build electrical system for free nodes\n    for i, p_idx in enumerate(free_indices):\n        l, s = p_idx // M, p_idx % M\n        \n        # In-layer neighbors\n        neighbors = [(node_map(l, (s - 1) % M), g_seg), (node_map(l, (s + 1) % M), g_seg)]\n        \n        # Short-circuit neighbor\n        if l == l_a and s == s_short:\n            neighbors.append((node_map(l_b, s_short), g_short))\n        elif l == l_b and s == s_short:\n            neighbors.append((node_map(l_a, s_short), g_short))\n\n        for neighbor_idx, g in neighbors:\n            G_free[i, i] += g\n            if neighbor_idx in free_idx_map:\n                j = free_idx_map[neighbor_idx]\n                G_free[i, j] -= g\n            else: # Neighbor is a fixed node\n                I_src[i] += g * fixed_potentials[neighbor_idx]\n\n    # Solve for free node potentials\n    V_free = np.linalg.solve(G_free, I_src)\n    \n    # Assemble full potential vector\n    V = np.zeros(N)\n    for i, p_idx in enumerate(free_indices):\n        V[p_idx] = V_free[i]\n    for p_idx, pot in fixed_potentials.items():\n        V[p_idx] = pot\n\n    # ----- 2. Joule Heat and Short Current Calculation -----\n    q = np.zeros(N)\n    \n    # In-layer resistors\n    for l in range(L):\n        for s in range(M):\n            p1 = node_map(l, s)\n            p2 = node_map(l, (s + 1) % M)\n            power = (V[p1] - V[p2])**2 / R_seg\n            q[p1] += power / 2.0\n            q[p2] += power / 2.0\n    \n    # Short resistor\n    p_a = node_map(l_a, s_short)\n    p_b = node_map(l_b, s_short)\n    power_short = (V[p_a] - V[p_b])**2 / R_short\n    q[p_a] += power_short / 2.0\n    q[p_b] += power_short / 2.0\n    \n    I_short_val = abs((V[p_a] - V[p_b]) / R_short)\n\n    # ----- 3. Thermal System Solution -----\n    K = np.zeros((N, N))\n    f = q + h * T_amb\n    \n    for p_idx in range(N):\n        l, s = p_idx // M, p_idx % M\n        \n        K[p_idx, p_idx] += h\n        \n        # Thermal neighbors\n        thermal_neighbors = []\n        # In-layer\n        thermal_neighbors.append((node_map(l, (s - 1) % M), k_in))\n        thermal_neighbors.append((node_map(l, (s + 1) % M), k_in))\n        # Inter-layer\n        if l > 0:\n            thermal_neighbors.append((node_map(l - 1, s), k_lay))\n        if l < L - 1:\n            thermal_neighbors.append((node_map(l + 1, s), k_lay))\n\n        for neighbor_idx, k in thermal_neighbors:\n            K[p_idx, p_idx] += k\n            K[p_idx, neighbor_idx] -= k\n            \n    T = np.linalg.solve(K, f)\n\n    # ----- 4. Hot Spot Identification -----\n    hotspot_idx = np.argmax(T)\n    l_star = hotspot_idx // M\n    s_star = hotspot_idx % M\n    \n    return [l_star, s_star, round(I_short_val, 3)]\n\nif __name__ == '__main__':\n    solve()\n```",
            "answer": "[[2,7,3404.145],[0,0,7258.118],[4,15,19999.000]]"
        },
        {
            "introduction": "在工程与科研中，精细的滥用仿真通常计算成本高昂且涉及众多不确定参数。因此，在投入大量计算资源之前，有效筛选并确定哪些参数对结果影响最显著是一项至关重要的技能。本练习将向您介绍一种全局敏感性分析技术——Morris方法，通过实施一个参数筛选实验，您将学会如何系统性地评估模型参数的影响力，从而优化仿真策略，将计算资源集中在最关键的因素上。",
            "id": "3921483",
            "problem": "您的任务是基于 Morris 方法，实现一次只改变一个（One-At-a-Time, OAT）全局灵敏度筛选实验，以识别锂离子电池简化内部短路滥用场景中的非影响性参数。目标是在运行计算成本高昂的多物理场仿真之前，确定哪些参数可以被固定。该筛选将使用一个基于物理推导的集总热模型，并将在离散化的参数空间上进行操作。\n\n从以下符合背景的物理基础出发：\n- 欧姆定律和焦耳热：对于开路电压为 $V$、总内阻为 $R_{tot}$ 的电池，短路电流为 $I = V / R_{tot}$，总电功率耗散为 $P_{elec} = I^2 R_{tot} = V^2 / R_{tot}$。\n- 集总能量平衡：当集总热容为 $C$，复合对流系数乘以面积为 $hA$ 时，电池温度 $T(t)$ 的演化遵循以下公式\n$$\nC \\frac{dT}{dt} = P_{elec} + Q_{rxn}(T) - hA \\left(T - T_a\\right),\n$$\n其中 $T_a$ 是环境温度，$Q_{rxn}(T)$ 是在超过起始温度 $T_{on}$ 时激活的放热反应热源。\n- 反应热建模：在起始温度之上使用阿伦尼乌斯型激活模型，\n$$\nQ_{rxn}(T) = H \\cdot \\mathbf{1}_{\\{T > T_{on}\\}} \\cdot \\exp\\left(-\\frac{E_a}{R_g T}\\right),\n$$\n其中反应热标度 $H$ 的单位为 $\\mathrm{W}$，活化能 $E_a$ 的单位为 $\\mathrm{J/mol}$，通用气体常数 $R_g$ 的单位为 $\\mathrm{J/(mol\\cdot K)}$。\n\n将关注量 (QOI) 定义为在固定仿真时域 $[0, t_{end}]$ 内达到的最高温度，\n$$\nT_{max} = \\max_{t \\in [0,t_{end}]} T(t),\n$$\n初始条件为 $T(0) = T_a$。所有温度单位必须为 $\\mathrm{K}$，电压单位为 $\\mathrm{V}$，电阻单位为 $\\Omega$，热容单位为 $\\mathrm{J/K}$，对流系数-面积乘积单位为 $\\mathrm{W/K}$。通用气体常数应取 $R_g = 8.314\\,\\mathrm{J/(mol\\cdot K)}$。\n\n在 $p$ 水平的网格上为 $d$ 维参数向量 $x \\in [0,1]^d$ 实现 Morris OAT 方法。物理参数向量通过将每个归一化分量 $x_i$ 仿射映射到其物理范围 $[L_i, U_i]$ 来获得：\n$$\n\\theta_i(x_i) = L_i + x_i (U_i - L_i).\n$$\n使用网格步长 $\\delta = 1/(p-1)$，使得单个参数的移动对应一个网格增量。对于 $r$ 条随机 OAT 轨迹中的每一条：\n- 抽取一个随机基点 $x^{(0)}$，其每个分量都在网格 $\\{0, \\delta, 2\\delta, \\dots, 1-\\delta\\}$ 上，以便向前移动 $\\delta$ 后仍在 $[0,1]$ 区间内。\n- 抽取坐标索引 $\\{1,2,\\dots,d\\}$ 的一个随机排列 $\\pi$。从 $x^{(0)}$ 开始，对于 $j = 1$ 到 $d$，将坐标 $i = \\pi(j)$ 增加 $\\delta$ 来定义 $x^{(j)} = x^{(j-1)} + \\delta e_i$，其中 $e_i$ 是第 $i$ 个标准基向量。\n- 对于每次这样的移动，计算坐标 $i$ 的基本效应，即归一化域上的前向差商：\n$$\nEE_i = \\frac{f\\big(x^{(j)}\\big) - f\\big(x^{(j-1)}\\big)}{\\delta},\n$$\n其中 $f(x)$ 是关注量 $T_{max}$，通过使用欧拉显式方法在固定时间步长 $dt$ 下对 $[0, t_{end}]$ 上的能量平衡方程进行积分得到。\n\n对于每个参数 $i$，汇总所有轨迹的基本效应，以计算\n- 绝对效应的均值 $\\mu_i^* = \\frac{1}{N_i} \\sum |EE_i|$，\n- 以及（带符号的）$EE_i$ 值的标准差 $\\sigma_i$，\n其中 $N_i$ 是为参数 $i$ 收集的基本效应的数量（在所描述的程序下等于 $r$）。\n\n决策规则：如果 $\\mu_i^* \\le \\varepsilon$ 和 $\\sigma_i \\le \\gamma$ 同时成立，则将参数 $i$ 分类为非影响性参数，其中阈值 $\\varepsilon$ 和 $\\gamma$ 根据每个测试用例指定。阈值的单位是 K/单位归一化步长。\n\n您的程序必须实现此过程并评估以下测试套件。在所有情况下，活化能固定为 $E_a = 1.2 \\times 10^5\\,\\mathrm{J/mol}$。\n\n测试用例 A（一般情况）：\n- 参数范围（下界 $L_i$，上界 $U_i$）：\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$，\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$，\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$，\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$，\n    - $hA$: $[3, 25]\\,\\mathrm{W/K}$，\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$，\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$，\n    - $H$: $[0, 400]\\,\\mathrm{W}$。\n- 网格水平 $p = 6$，轨迹数 $r = 10$，仿真时域 $t_{end} = 120\\,\\mathrm{s}$，时间步长 $dt = 0.05\\,\\mathrm{s}$，阈值 $\\varepsilon = 1.0\\,\\mathrm{K}$ 和 $\\gamma = 0.5\\,\\mathrm{K}$。\n\n测试用例 B（边界情况：反应被抑制）：\n- 参数范围：\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$，\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$，\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$，\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$，\n    - $hA$: $[3, 25]\\,\\mathrm{W/K}$，\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$，\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$，\n    - $H$: $[0, 0]\\,\\mathrm{W}$。\n- 网格水平 $p = 4$，轨迹数 $r = 8$，仿真时域 $t_{end} = 60\\,\\mathrm{s}$，时间步长 $dt = 0.05\\,\\mathrm{s}$，阈值 $\\varepsilon = 0.8\\,\\mathrm{K}$ 和 $\\gamma = 0.4\\,\\mathrm{K}$。\n\n测试用例 C（边界冷却主导区域）：\n- 参数范围：\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$，\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$，\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$，\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$，\n    - $hA$: $[20, 25]\\,\\mathrm{W/K}$，\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$，\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$，\n    - $H$: $[0, 400]\\,\\mathrm{W}$。\n- 网格水平 $p = 6$，轨迹数 $r = 12$，仿真时域 $t_{end} = 180\\,\\mathrm{s}$，时间步长 $dt = 0.05\\,\\mathrm{s}$，阈值 $\\varepsilon = 0.5\\,\\mathrm{K}$ 和 $\\gamma = 0.3\\,\\mathrm{K}$。\n\n对于每个测试用例，您的程序应按照参数顺序 $\\left[V, R_s, R_{sh}, C, hA, T_a, T_{on}, H\\right]$ 输出一个长度为 8 的布尔列表，指示根据决策规则哪些参数是非影响性的。最终输出必须是单行，包含一个由方括号括起来的、由逗号分隔的三个布尔列表，例如\n$$\n[\\,[b_{A1},\\dots,b_{A8}],\\,[b_{B1},\\dots,b_{B8}],\\,[b_{C1},\\dots,b_{C8}]\\,],\n$$\n其中每个 $b_{\\cdot\\cdot}$ 等于 $\\mathrm{True}$ 或 $\\mathrm{False}$。",
            "solution": "该问题被评估为有效，因为它具有科学依据、数学上适定，并提供了一套完整且一致的定义、参数和目标。物理模型虽然经过简化，但基于热工和电气工程的基本原理。用于灵敏度分析的 Morris 方法是实现所述参数筛选目标的标准且适用的技术。三个测试用例所需的所有数据都已明确提供。唯一需要解释的一个小点是，如何根据给定的串联电阻 $R_s$ 和短路电阻 $R_{sh}$ 来定义总电阻 $R_{tot}$。对于简化的短路模型，最直接且物理上一致的解释是电压源驱动电流串联通过这两个电阻，因此 $R_{tot} = R_s + R_{sh}$。问题的其他所有方面都已明确定义。因此，我们可以着手求解。\n\n目标是使用 Morris 一次只改变一个（OAT）方法实现全局灵敏度筛选，以识别经历内部短路的锂离子电池集总参数热模型中的非影响性参数。如果一个参数的相应灵敏度指标低于指定阈值，则该参数被视为非影响性参数。\n\n首先，我们将物理模型形式化。该系统由一个描述电池温度 $T(t)$ 的常微分方程（ODE）描述。待研究的参数包括开路电压 $V$、串联电阻 $R_s$、短路电阻 $R_{sh}$、热容 $C$、传热系数-面积乘积 $hA$、环境温度 $T_a$、反应起始温度 $T_{on}$ 和反应热标度 $H$。状态变量是温度 $T(t)$，初始条件是 $T(0) = T_a$。\n\n能量平衡方程如下：\n$$\nC \\frac{dT}{dt} = P_{elec} + Q_{rxn}(T) - Q_{cool}(T, T_a)\n$$\n其中：\n1.  $P_{elec}$ 是由于短路而以热量形式耗散的电功率。基于欧姆定律，电流为 $I = V / R_{tot}$，功率为 $P_{elec} = I^2 R_{tot}$。如上所述，我们将总电阻定义为 $R_{tot} = R_s + R_{sh}$。这产生了一个恒定的焦耳热项：\n    $$\n    P_{elec} = \\frac{V^2}{R_s + R_{sh}}\n    $$\n2.  $Q_{rxn}(T)$ 是由放热副反应产生的热量，采用一个在起始温度 $T_{on}$ 以上被激活的阿伦尼乌斯型表达式进行建模：\n    $$\n    Q_{rxn}(T) = H \\cdot \\mathbf{1}_{\\{T > T_{on}\\}} \\cdot \\exp\\left(-\\frac{E_a}{R_g T}\\right)\n    $$\n    这里，$\\mathbf{1}_{\\{\\cdot\\}}$ 是指示函数，$E_a$ 是活化能（固定为 $1.2 \\times 10^5\\,\\mathrm{J/mol}$），$R_g$ 是通用气体常数（$8.314\\,\\mathrm{J/(mol\\cdot K)}$）。\n3.  $Q_{cool}(T, T_a)$ 是通过对流散失到环境中的热量，由牛顿冷却定律描述：\n    $$\n    Q_{cool}(T, T_a) = hA (T - T_a)\n    $$\n\n关注量 (QOI) 是在持续时间为 $t_{end}$ 的仿真过程中达到的最高温度：\n$$\nT_{max} = \\max_{t \\in [0,t_{end}]} T(t)\n$$\n为了找到 $T_{max}$，我们必须对常微分方程（ODE）进行数值求解。我们采用具有固定时间步长 $dt$ 的显式欧拉方法。时间步 $n+1$ 的温度由时间步 $n$ 的温度更新如下：\n$$\nT^{n+1} = T^n + \\frac{dt}{C} \\left[ \\frac{V^2}{R_s + R_{sh}} + Q_{rxn}(T^n) - hA(T^n - T_a) \\right]\n$$\n此积分从 $t=0$ 执行到 $t=t_{end}$，起始温度为 $T^0 = T_a$，并记录遇到的最高温度。这整个计算过程定义了我们的模型函数 $f(x)$，其中 $x$ 是归一化参数的向量。\n\nMorris 方法是一种全局灵敏度分析技术，通过一系列轨迹来探索参数空间。$d=8$ 维参数空间被归一化到单位超立方体 $x \\in [0,1]^d$。物理参数向量 $\\theta = [V, R_s, R_{sh}, C, hA, T_a, T_{on}, H]^T$ 是通过将每个分量 $x_i$ 从其归一化范围缩放到其物理范围 $[L_i, U_i]$ 得到的：\n$$\n\\theta_i(x_i) = L_i + x_i (U_i - L_i)\n$$\n参数空间被离散化为一个 $p$ 水平的网格。在归一化空间中沿任何维度的步长为 $\\delta = 1/(p-1)$。\n\n筛选过程涉及生成 $r$ 条随机 OAT 轨迹。对于每条轨迹：\n1.  选择一个随机基点 $x^{(0)}$。其分量 $x_i^{(0)}$ 从网格 $\\{0, \\delta, 2\\delta, \\dots, 1-\\delta\\}$ 中选取，这样向前一步 $\\delta$ 始终在 $[0,1]$ 域内。这意味着每个 $x_i^{(0)}$ 都是从 $\\{0, \\delta, \\dots, (p-2)\\delta\\}$ 中抽取的。\n2.  生成参数索引 $\\{0, 1, \\dots, d-1\\}$ 的一个随机排列 $\\pi$，以确定扰动顺序。\n3.  从 $y^{(0)} = f(x^{(0)})$ 开始，通过依次对每个参数进行步进构造轨迹。对于 $j=1, \\dots, d$，令 $i = \\pi(j-1)$ 为待扰动参数的索引。新点为 $x^{(j)} = x^{(j-1)} + \\delta e_i$，其中 $e_i$ 是第 $i$ 个标准基向量。在此新点上评估模型以得到 $y^{(j)} = f(x^{(j)})$。\n4.  该轨迹中参数 $i$ 的基本效应通过有限差分计算得出：\n    $$\n    EE_i = \\frac{y^{(j)} - y^{(j-1)}}{\\delta} = \\frac{f(x^{(j)}) - f(x^{(j-1)})}{\\delta}\n    $$\n    存储该值，并以 $x^{(j)}$ 作为下一次扰动的基点继续该过程。\n\n生成 $r$ 条轨迹后，我们将为 $d$ 个参数中的每一个收集到 $r$ 个基本效应。从每个参数 $i$ 的效应集合 $\\{EE_{i,1}, EE_{i,2}, \\dots, EE_{i,r}\\}$ 中，我们计算两个统计量：\n1.  基本效应绝对值的均值 $\\mu_i^*$：\n    $$\n    \\mu_i^* = \\frac{1}{r} \\sum_{k=1}^{r} |EE_{i,k}|\n    $$\n    该度量估计了参数 $i$ 对输出的总体影响。\n2.  基本效应的标准差 $\\sigma_i$：\n    $$\n    \\sigma_i = \\sqrt{\\frac{1}{r-1} \\sum_{k=1}^{r} (EE_{i,k} - \\bar{EE}_i)^2}\n    $$\n    其中 $\\bar{EE}_i$ 是 $EE_{i,k}$ 的均值。该度量估计了非线性效应或与其他参数相互作用的程度。高 $\\sigma_i$ 值表示参数 $i$ 的效应会随着其他参数值的变化而改变。\n\n最后，如果参数 $i$ 的两个度量都低于给定的阈值 $\\varepsilon$ 和 $\\gamma$，则将其分类为非影响性参数：\n$$\n\\text{非影响性} \\iff (\\mu_i^* \\le \\varepsilon) \\land (\\sigma_i \\le \\gamma)\n$$\n将这整个过程应用于指定的三个测试用例中的每一个，为每个案例生成一个布尔列表，指明 8 个参数中每个参数的分类。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Morris sensitivity analysis for all test cases.\n    \"\"\"\n    \n    # Universal constants\n    R_G = 8.314  # J/(mol*K)\n    E_A = 1.2e5  # J/mol\n    \n    # Test case definitions\n    test_cases_spec = {\n        'A': {\n            'p': 6, 'r': 10, 't_end': 120.0, 'dt': 0.05,\n            'epsilon': 1.0, 'gamma': 0.5,\n            'L': np.array([3.6, 0.002, 0.0005, 2000, 3, 298, 370, 0]),\n            'U': np.array([4.2, 0.010, 0.0050, 10000, 25, 320, 420, 400]),\n        },\n        'B': {\n            'p': 4, 'r': 8, 't_end': 60.0, 'dt': 0.05,\n            'epsilon': 0.8, 'gamma': 0.4,\n            'L': np.array([3.6, 0.002, 0.0005, 2000, 3, 298, 370, 0]),\n            'U': np.array([4.2, 0.010, 0.0050, 10000, 25, 320, 420, 0]),\n        },\n        'C': {\n            'p': 6, 'r': 12, 't_end': 180.0, 'dt': 0.05,\n            'epsilon': 0.5, 'gamma': 0.3,\n            'L': np.array([3.6, 0.002, 0.0005, 2000, 20, 298, 370, 0]),\n            'U': np.array([4.2, 0.010, 0.0050, 10000, 25, 320, 420, 400]),\n        }\n    }\n\n    def compute_T_max(physical_params, t_end, dt):\n        \"\"\"\n        Simulates the thermal model and returns the maximum temperature.\n        \"\"\"\n        V, R_s, R_sh, C, hA, T_a, T_on, H = physical_params\n        \n        if C <= 0:\n            return np.inf\n\n        T = T_a\n        max_T = T_a\n        \n        P_elec = V**2 / (R_s + R_sh)\n        \n        num_steps = int(t_end / dt)\n        \n        for _ in range(num_steps):\n            Q_rxn = 0\n            if T > T_on:\n                if T > 1e-6:\n                    Q_rxn = H * np.exp(-E_A / (R_G * T))\n\n            Q_cool = hA * (T - T_a)\n            \n            dT_dt = (P_elec + Q_rxn - Q_cool) / C\n            \n            T += dT_dt * dt\n            \n            if T > max_T:\n                max_T = T\n                \n        return max_T\n\n    def run_morris_screening(case_spec):\n        \"\"\"\n        Executes the full Morris OAT screening for a single test case.\n        \"\"\"\n        p = case_spec['p']\n        r = case_spec['r']\n        t_end = case_spec['t_end']\n        dt = case_spec['dt']\n        epsilon = case_spec['epsilon']\n        gamma = case_spec['gamma']\n        L = case_spec['L']\n        U = case_spec['U']\n        \n        d = len(L)\n        delta = 1.0 / (p - 1)\n        \n        # Use a consistent random seed for reproducibility\n        rng = np.random.default_rng(seed=0)\n        \n        elementary_effects = [[] for _ in range(d)]\n        \n        for _ in range(r):\n            grid_indices = rng.integers(0, p - 1, size=d)\n            x_old = grid_indices * delta\n            \n            permutation = rng.permutation(d)\n            \n            theta_old = L + x_old * (U - L)\n            f_old = compute_T_max(theta_old, t_end, dt)\n            \n            for param_idx in permutation:\n                x_new = x_old.copy()\n                x_new[param_idx] += delta\n                \n                theta_new = L + x_new * (U - L)\n                f_new = compute_T_max(theta_new, t_end, dt)\n                \n                ee = (f_new - f_old) / delta\n                elementary_effects[param_idx].append(ee)\n                \n                x_old = x_new\n                f_old = f_new\n\n        results = []\n        for i in range(d):\n            effects = np.array(elementary_effects[i])\n            mu_star = np.mean(np.abs(effects))\n            sigma = np.std(effects, ddof=1) if len(effects) > 1 else 0.0\n            \n            is_non_influential = (mu_star <= epsilon) and (sigma <= gamma)\n            results.append(is_non_influential)\n            \n        return results\n\n    # Main execution loop for all test cases\n    final_results = []\n    for case_id in ['A', 'B', 'C']:\n        case_result = run_morris_screening(test_cases_spec[case_id])\n        final_results.append(case_result)\n        \n    # Format and print the final output exactly as required\n    print(str(final_results).replace(\" \", \"\").replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```",
            "answer": "[[false,false,false,false,false,false,false,false],[false,false,false,false,false,false,true,true],[false,false,false,false,false,true,false,true]]"
        }
    ]
}