{
    "hands_on_practices": [
        {
            "introduction": "在硬件在环（HIL）和软件在环（SIL）验证中，核心任务是量化仿真模型与真实物理系统之间的一致性。选择合适的评估指标至关重要，因为它直接定义了我们如何衡量“准确性”。本练习旨在探讨几种关键性能指标的定义及其适用场景，帮助您理解如何根据验证目标（例如，强调峰值误差、对噪声的鲁棒性或能量平衡）选择最恰当的度量标准。",
            "id": "3918330",
            "problem": "一个电池管理系统 (BMS) 模型，在动态汽车行驶工况期间，针对端电压、电流、温度和功率，通过软件在环 (SIL) 和硬件在环 (HIL) 配置与实验室基准真相进行验证。设基准真相信号表示为 $y(t)$，SIL/HIL 输出表示为 $\\hat{y}(t)$。对于以速率 $f_{\\mathrm{s}}$ 进行的离散时间采样，共有 $N$ 个样本，将序列表示为 $y_k = y(k/f_{\\mathrm{s}})$ 和 $\\hat{y}_k = \\hat{y}(k/f_{\\mathrm{s}})$，其中 $k \\in \\{1,2,\\dots,N\\}$。考虑误差信号 $e_k = \\hat{y}_k - y_k$ 和连续时间误差 $e(t) = \\hat{y}(t) - y(t)$。假设以下基本事实：误差的 $L_2$ 和 $L_1$ 范数分别量化了平均平方偏差和平均绝对偏差；互相关 $R_{xy}(\\tau)$ 识别信号之间的时滞关系；电池在一段时间内释放或吸收的能量是功率的时间积分，其中 $P(t) = V(t) I(t)$，$V(t)$ 是端电压，$I(t)$ 是电流。在 HIL 中，通信和采集子系统可能会引入固定的延迟 $\\tau$，并且可能出现偶然的测量尖峰。\n\n选择所有正确定义了用于比较 SIL/HIL 输出与基准真相的命名指标，并正确解释了在自动化电池设计和仿真验证的背景下，每个指标何时适用的选项。\n\nA. 均方根误差 (RMSE): $ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( \\hat{y}_k - y_k \\right)^2 } $。当误差近似为高斯分布，且大的瞬态不匹配（例如，高 C 倍率下的快速电压偏移）应比小误差受到更重惩罚时适用。\n\nB. 平均绝对误差 (MAE): $ \\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| \\hat{y}_k - y_k \\right| $。当需要对异常值（例如，HIL 中的零星传感器尖峰或量化伪影）具有鲁棒性，并且倾向于选择类似中位数的性能而不是类似方差的灵敏度时适用。\n\nC. 时间对齐动态误差: $ E_{\\mathrm{dyn}} = \\min_{\\tau \\in \\mathbb{R}} \\sqrt{ \\frac{1}{N'} \\sum_{k=1}^{N'} \\left( \\hat{y}_{k+\\tau'} - y_k \\right)^2 } $，其中 $\\tau'$ 是对应于连续时间滞后 $\\tau$ 的离散索引偏移，而 $N'$ 是在给定 $\\tau'$ 下两个信号重叠的索引数量。滞后 $\\tau$ 通过最大化互相关 $R_{y\\hat{y}}(\\tau) = \\int_{0}^{T} y(t)\\,\\hat{y}(t+\\tau)\\, dt$ 来估计。当评估 HIL 中存在固定延迟情况下的动态形状一致性时适用，这样以对齐为重点的比较可以防止延迟主导误差。\n\nD. 在 $[0,T]$ 上的能量偏差: $ \\Delta E = \\int_{0}^{T} \\left( \\hat{P}(t) - P(t) \\right) dt = \\int_{0}^{T} \\left( \\hat{V}(t)\\,\\hat{I}(t) - V(t)\\,I(t) \\right) dt $。当评估净能量吞吐量的偏差及其对行驶工况期间的热负荷、效率和荷电状态跟踪的影响时适用。\n\nE. RMSE 对偶然的大误差尖峰不如 MAE 敏感，因为平方运算会减弱异常值的影响；因此当 HIL 中存在异常值时，RMSE 优于 MAE。\n\nF. 一种用于电池验证的能量偏差度量可以计算为 $ \\Delta E_V = \\int_{0}^{T} \\left( \\hat{V}(t) - V(t) \\right) dt $；这适用于量化总能量吞吐量差异，因为仅电压就足以捕捉能量偏差。",
            "solution": "从定义和物理基础开始。对于离散时间误差序列 $e_k = \\hat{y}_k - y_k$，$L_2$ 范数提供了一个与平均平方偏差成正比的度量，而 $L_1$ 范数提供了一个与平均绝对偏差成正比的度量。在信号处理中，互相关 $R_{xy}(\\tau) = \\int_{0}^{T} x(t)\\,y(t+\\tau)\\,dt$ 识别出能最好地对齐 $x(t)$ 和 $y(t)$ 形状的时滞 $\\tau$，这在硬件在环 (HIL) 中固定延迟导致信号偏移时具有相关性。对于能量，在区间 $[0,T]$ 上的能量为 $E = \\int_{0}^{T} P(t) \\, dt$，其中 $P(t) = V(t)\\,I(t)$。\n\n选项 A: 公式 $ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( \\hat{y}_k - y_k \\right)^2 } $ 是标准的均方根误差 (RMSE)，由 $L_2$ 范数按 $1/\\sqrt{N}$ 缩放得出。在误差 $e_k$ 近似为零均值的独立同分布高斯分布的假设下，平方损失在最大似然意义上是最优的，并且由于 $\\left( e_k \\right)^2$ 呈二次方增长，它对较大偏差的惩罚比对较小偏差的惩罚更重。在电池验证中，快速瞬变（例如，高 C 倍率脉冲期间的电压偏移）需要一个能强力惩罚峰值不匹配的指标。因此，定义和所述的适用性是正确的。结论：正确。\n\n选项 B: 公式 $ \\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| \\hat{y}_k - y_k \\right| $ 是标准的平均绝对误差 (MAE)，由 $L_1$ 范数按 $1/N$ 缩放得出。$L_1$ 损失比 $L_2$ 损失对异常值更具鲁棒性，因为惩罚随 $|e_k|$ 线性增长，而不是二次方增长。如果 HIL 由于模数转换器 (ADC) 量化或通信故障而引入零星尖峰，MAE 提供了一个受罕见大误差影响较小的集中趋势度量，类似于中位数在拉普拉斯噪声下最小化 $L_1$ 风险的性质。在电池验证中，当关注点是典型性能而非峰值误差灵敏度时，MAE 是合适的。结论：正确。\n\n选项 C: 时间对齐动态误差旨在将形状不匹配与固定延迟解耦。连续时间互相关 $R_{y\\hat{y}}(\\tau) = \\int_{0}^{T} y(t)\\,\\hat{y}(t+\\tau)\\, dt$ 识别出使相似性最大化的滞后 $\\tau$。等效地，通过对滞后 $\\tau$ 最小化均方误差来对齐信号：$ E_{\\mathrm{dyn}}(\\tau) = \\sqrt{ \\frac{1}{N'(\\tau)} \\sum_{k=1}^{N'(\\tau)} \\left( \\hat{y}_{k+\\tau'} - y_k \\right)^2 } $，其中 $N'(\\tau)$ 是重叠长度。在 HIL 中，来自通信或执行的固定延迟会使 $\\hat{y}(t)$ 在时间上发生偏移。通过对 $\\tau$ 取最小值，可以将动态形状保真度与延迟效应分离开来，这在目标是评估模型动态性而非时序基础设施时是合适的。使用对 $\\tau$ 的最小化和互相关进行滞后估计的定义是正确的，其适用性也是准确的。结论：正确。\n\n选项 D: 能量是 $E = \\int_{0}^{T} P(t)\\, dt$，其中 $P(t) = V(t)\\, I(t)$。能量偏差 $ \\Delta E = \\int_{0}^{T} \\left( \\hat{P}(t) - P(t) \\right) dt = \\int_{0}^{T} \\left( \\hat{V}(t)\\,\\hat{I}(t) - V(t)\\,I(t) \\right) dt $ 量化了净能量吞吐量的偏差，这直接影响热负荷、效率和荷电状态 (SOC) 跟踪。在自动化电池验证中，匹配行驶工况期间的能量对于容量和热预测至关重要。因此，定义和所描述的用例都是正确的。结论：正确。\n\n选项 E: 声称 RMSE 对异常值比 MAE 不敏感是错误的，因为平方运算 $e_k^2$ 会放大大的误差；RMSE 对异常值的惩罚比 MAE 更重。在出现零星尖峰的情况下，通常首选 MAE 以保证鲁棒性。因此，该陈述和理由都是不正确的。结论：不正确。\n\n选项 F: 将能量偏差计算为 $ \\Delta E_V = \\int_{0}^{T} \\left( \\hat{V}(t) - V(t) \\right) dt $ 忽略了电流 $I(t)$，因此不代表能量，能量取决于乘积 $V(t)\\,I(t)$。仅电压无法捕捉功率或能量吞吐量的差异；例如，两种电压相同但电流不同的情况会产生不同的能量。所述的适用性（即仅电压就足以捕捉能量偏差）是不正确的。结论：不正确。\n\n总之，选项 A、B、C 和 D 正确地定义了指标并恰当地解释了它们在 SIL/HIL 电池验证中的应用，而选项 E 和 F 基于基本的范数属性和能量定义是不正确的。",
            "answer": "$$\\boxed{ABCD}$$"
        },
        {
            "introduction": "在理想的仿真中，模型输出与实验数据应在时间上完美同步，但HIL系统的通信和数据采集链不可避免地会引入延迟。这种延迟若不加以处理，会严重扭曲动态误差的评估，使模型看起来比实际更差。本练习提供了一个具体的案例，要求您从第一性原理出发，推导一种时间对齐算法，以数学方式补偿这种系统性延迟，从而更准确地评估模型本身的动态响应特性。",
            "id": "3918356",
            "problem": "由周期性负载引起的电池组端电压纹波；\n用于在硬件在环 (HIL) 和软件在环 (SIL) 工作流程中验证一个基于物理的电化学模型，以实现自动化电池设计和仿真。仿真电压（表示为 $v_{s}(t)$）和测量电压（表示为 $v_{m}(t)$）主要由所施加负载引起的单一频率分量主导。在稳态运行下，在任何一个周期的观测区间内，两者都可以建模为\n$$v_{s}(t) = V_{0} + A_{s}\\sin(\\omega t + \\theta_{s}), \\quad v_{m}(t) = V_{0} + A_{m}\\sin\\big(\\omega(t - L) + \\theta_{m}\\big) + \\epsilon(t),$$\n其中 $V_{0}$ 是直流基线电压，$A_{s}$ 和 $A_{m}$ 分别是仿真和测量的纹波幅值，$\\omega$ 是角频率，$\\theta_{s}$ 和 $\\theta_{m}$ 是相位偏移，$L$ 是由 HIL 数据采集链引起的已知管道延迟，$\\epsilon(t)$ 是零均值测量噪声，其值小到在推导中可以忽略不计。考虑一个时间对齐算法，该算法通过一个附加相移 $\\delta$ 来调整仿真，将对齐后的仿真信号定义为\n$$v_{s,\\delta}(t) = V_{0} + A_{s}\\sin\\big(\\omega t + \\theta_{s} + \\delta\\big).$$\n在单个周期 $T = 2\\pi/\\omega$ 内，将对齐后的仿真相对于测量的均方根误差 (RMSE) 定义为\n$$\\mathrm{RMSE}(\\delta) = \\sqrt{\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T}\\big(v_{s,\\delta}(t) - v_{m}(t)\\big)^{2}\\,dt},$$\n其中 $t_{0}$ 是任意的。仅从 $\\mathrm{RMSE}(\\delta)$ 的定义和三角函数的基本性质（包括它们在一个周期内的正交性）出发，推导出使 $\\mathrm{RMSE}(\\delta)$ 最小化的 $\\delta$ 值。然后，通过计算定义为如下的对齐后报告准确度，来量化时间对齐的效果\n$$a = 1 - \\frac{\\mathrm{RMSE}(\\delta_{\\mathrm{opt}})}{\\mathrm{RMS}_{m}},$$\n其中 $\\mathrm{RMS}_{m}$ 是测量纹波 $v_{m}(t) - V_{0}$ 在同一周期 $T$ 内的均方根值。对一个承受低频周期性负载的电池组，使用以下科学上符合实际的参数：\n- $V_{0} = 3.7\\,\\text{V}$,\n- $A_{s} = 0.050\\,\\text{V}$,\n- $A_{m} = 0.048\\,\\text{V}$,\n- $\\omega = \\pi\\,\\text{rad/s}$,\n- $L = 0.35\\,\\text{s}$,\n- $\\theta_{s} = 0.2\\,\\text{rad}$,\n- $\\theta_{m} = -0.1\\,\\text{rad}$,\n- 在解析推导中忽略 $\\epsilon(t)$。\n\n以行矩阵的形式提供您的最终答案，其中包含以弧度为单位的最优相移 $\\delta_{\\mathrm{opt}}$ 和以小数形式表示的对齐后准确度 $a$。将每个量四舍五入到四位有效数字。相移以弧度表示。",
            "solution": "问题要求我们确定最优相移 $\\delta_{\\mathrm{opt}}$，以最小化仿真电压信号与测量电压信号之间的均方根误差 (RMSE)。随后，我们要计算对齐后的准确度指标 $a$。\n\n在纳入对齐相移 $\\delta$ 并忽略噪声项 $\\epsilon(t)$ 后，仿真和测量电压信号由以下公式给出：\n$$v_{s,\\delta}(t) = V_{0} + A_{s}\\sin(\\omega t + \\theta_{s} + \\delta)$$\n$$v_{m}(t) = V_{0} + A_{m}\\sin(\\omega(t - L) + \\theta_{m}) = V_{0} + A_{m}\\sin(\\omega t - \\omega L + \\theta_{m})$$\n\n均方根误差 $\\mathrm{RMSE}(\\delta)$ 在单个周期 $T = 2\\pi/\\omega$ 内定义为：\n$$\\mathrm{RMSE}(\\delta) = \\sqrt{\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T}\\big(v_{s,\\delta}(t) - v_{m}(t)\\big)^{2}\\,dt}$$\n\n为了找到使 $\\mathrm{RMSE}(\\delta)$ 最小化的 $\\delta$ 值，我们可以等价地最小化其平方，记为 $E_{\\mathrm{sq}}(\\delta) = \\left(\\mathrm{RMSE}(\\delta)\\right)^{2}$。\n$$E_{\\mathrm{sq}}(\\delta) = \\frac{1}{T}\\int_{t_{0}}^{t_{0}+T}\\big(v_{s,\\delta}(t) - v_{m}(t)\\big)^{2}\\,dt$$\n\n信号之间的差值为：\n$$v_{s,\\delta}(t) - v_{m}(t) = A_{s}\\sin(\\omega t + \\theta_{s} + \\delta) - A_{m}\\sin(\\omega t - \\omega L + \\theta_{m})$$\n为清晰起见，我们定义相位参数：\n$\\phi_s(\\delta) = \\omega t + \\theta_{s} + \\delta$\n$\\phi_m = \\omega t - \\omega L + \\theta_{m}$\n\n被积函数变为：\n$$\\big(A_{s}\\sin(\\phi_s(\\delta)) - A_{m}\\sin(\\phi_m)\\big)^{2} = A_{s}^{2}\\sin^{2}(\\phi_s(\\delta)) + A_{m}^{2}\\sin^{2}(\\phi_m) - 2A_{s}A_{m}\\sin(\\phi_s(\\delta))\\sin(\\phi_m)$$\n\n现在我们将此表达式在一个周期 $[t_0, t_0+T]$ 上积分。我们使用以下标准三角函数积分公式：\n1. $\\int_{t_{0}}^{t_{0}+T} \\sin^{2}(\\omega t + \\alpha) \\,dt = \\frac{T}{2}$\n2. $\\int_{t_{0}}^{t_{0}+T} \\sin(\\omega t + \\alpha_{1})\\sin(\\omega t + \\alpha_{2}) \\,dt = \\frac{T}{2}\\cos(\\alpha_{1} - \\alpha_{2})$\n\n将这些恒等式应用于展开的平方误差的各项：\n$$\\int_{t_{0}}^{t_{0}+T} A_{s}^{2}\\sin^{2}(\\phi_s(\\delta)) \\,dt = A_{s}^{2} \\frac{T}{2}$$\n$$\\int_{t_{0}}^{t_{0}+T} A_{m}^{2}\\sin^{2}(\\phi_m) \\,dt = A_{m}^{2} \\frac{T}{2}$$\n$$\\int_{t_{0}}^{t_{0}+T} -2A_{s}A_{m}\\sin(\\phi_s(\\delta))\\sin(\\phi_m) \\,dt = -2A_{s}A_{m} \\frac{T}{2}\\cos\\big((\\theta_{s} + \\delta) - (-\\omega L + \\theta_{m})\\big)$$\n$$ = -A_{s}A_{m}T\\cos(\\theta_{s} - \\theta_{m} + \\omega L + \\delta)$$\n\n将这些积分项求和并除以 $T$，得到 $E_{\\mathrm{sq}}(\\delta)$：\n$$E_{\\mathrm{sq}}(\\delta) = \\frac{A_{s}^{2}}{2} + \\frac{A_{m}^{2}}{2} - A_{s}A_{m}\\cos(\\theta_{s} - \\theta_{m} + \\omega L + \\delta)$$\n\n为了最小化 $E_{\\mathrm{sq}}(\\delta)$，我们必须最大化项 $A_{s}A_{m}\\cos(\\theta_{s} - \\theta_{m} + \\omega L + \\delta)$。由于幅值 $A_s$ 和 $A_m$ 均为正，这等价于最大化余弦项。$\\cos(x)$ 的最大值为 1，此时其自变量 $x$ 是 $2\\pi$ 的偶数倍，即 $x = 2k\\pi$（其中 $k$ 为任意整数）。\n因此，为了得到最小误差，我们必须有：\n$$\\theta_{s} - \\theta_{m} + \\omega L + \\delta_{\\mathrm{opt}} = 2k\\pi$$\n解出 $\\delta_{\\mathrm{opt}}$ 得到：\n$$\\delta_{\\mathrm{opt}} = 2k\\pi - (\\theta_{s} - \\theta_{m} + \\omega L) = 2k\\pi + \\theta_{m} - \\theta_{s} - \\omega L$$\n我们通常寻找主值，即幅值最小的那个值（通过选择 $k=0$ 或其他整数将结果置于区间 $(-\\pi, \\pi]$ 内）。对于通用表达式，我们选择 $k=0$：\n$$\\delta_{\\mathrm{opt}} = \\theta_{m} - \\theta_{s} - \\omega L$$\n代入给定的数值：\n$\\theta_{m} = -0.1\\,\\text{rad}$，$\\theta_{s} = 0.2\\,\\text{rad}$，$\\omega = \\pi\\,\\text{rad/s}$，$L = 0.35\\,\\text{s}$。\n$$\\delta_{\\mathrm{opt}} = -0.1 - 0.2 - (\\pi \\times 0.35) = -0.3 - 0.35\\pi$$\n数值上，$\\delta_{\\mathrm{opt}} \\approx -0.3 - 0.35 \\times 3.14159265 = -0.3 - 1.09955743 = -1.39955743\\,\\text{rad}$。\n该值位于区间 $(-\\pi, \\pi]$ 内，因此是一个可接受的主值。四舍五入到四位有效数字，我们得到 $\\delta_{\\mathrm{opt}} = -1.400\\,\\text{rad}$。\n\n接下来，我们必须计算对齐后准确度 $a$。\n$$a = 1 - \\frac{\\mathrm{RMSE}(\\delta_{\\mathrm{opt}})}{\\mathrm{RMS}_{m}}$$\n首先，我们计算 $\\mathrm{RMSE}(\\delta_{\\mathrm{opt}})$。在最优相移下，$\\cos(\\theta_{s} - \\theta_{m} + \\omega L + \\delta_{\\mathrm{opt}}) = 1$。\n$$E_{\\mathrm{sq}}(\\delta_{\\mathrm{opt}}) = (\\mathrm{RMSE}(\\delta_{\\mathrm{opt}}))^{2} = \\frac{A_{s}^{2}}{2} + \\frac{A_{m}^{2}}{2} - A_{s}A_{m} = \\frac{1}{2}(A_{s}^{2} - 2A_{s}A_{m} + A_{m}^{2}) = \\frac{(A_{s} - A_{m})^{2}}{2}$$\n$$\\mathrm{RMSE}(\\delta_{\\mathrm{opt}}) = \\sqrt{\\frac{(A_{s} - A_{m})^{2}}{2}} = \\frac{|A_{s} - A_{m}|}{\\sqrt{2}}$$\n\n接下来，我们计算 $\\mathrm{RMS}_{m}$，即测量纹波 $v_{m}(t) - V_{0} = A_{m}\\sin(\\omega t - \\omega L + \\theta_{m})$ 的均方根值。\n$$(\\mathrm{RMS}_{m})^{2} = \\frac{1}{T}\\int_{t_{0}}^{t_{0}+T} \\big(A_{m}\\sin(\\omega t - \\omega L + \\theta_{m})\\big)^{2}\\,dt$$\n$$(\\mathrm{RMS}_{m})^{2} = \\frac{A_{m}^{2}}{T} \\int_{t_{0}}^{t_{0}+T} \\sin^{2}(\\omega t - \\omega L + \\theta_{m}) \\,dt = \\frac{A_{m}^{2}}{T} \\cdot \\frac{T}{2} = \\frac{A_{m}^{2}}{2}$$\n$$\\mathrm{RMS}_{m} = \\sqrt{\\frac{A_{m}^{2}}{2}} = \\frac{A_{m}}{\\sqrt{2}}$$\n（因为 $A_m$ 是一个正幅值）。\n\n现在我们可以计算准确度 $a$：\n$$a = 1 - \\frac{\\mathrm{RMSE}(\\delta_{\\mathrm{opt}})}{\\mathrm{RMS}_{m}} = 1 - \\frac{|A_{s} - A_{m}|/\\sqrt{2}}{A_{m}/\\sqrt{2}} = 1 - \\frac{|A_{s} - A_{m}|}{A_{m}}$$\n代入给定的幅值：\n$A_{s} = 0.050\\,\\text{V}$ 和 $A_{m} = 0.048\\,\\text{V}$。\n$$a = 1 - \\frac{|0.050 - 0.048|}{0.048} = 1 - \\frac{0.002}{0.048} = 1 - \\frac{2}{48} = 1 - \\frac{1}{24}$$\n数值上，$a = 1 - 0.041666... = 0.958333...$\n四舍五入到四位有效数字，我们得到 $a = 0.9583$。\n\n最终结果为 $\\delta_{\\mathrm{opt}} = -1.400\\,\\text{rad}$ 和 $a = 0.9583$。",
            "answer": "$$\\boxed{\\begin{pmatrix}-1.400  0.9583\\end{pmatrix}}$$"
        },
        {
            "introduction": "HIL验证的成功不仅取决于模型的保真度，还取决于仿真平台能否满足严格的实时性要求。一个HIL系统通常需要并发执行多个任务，如模型求解、控制算法和数据记录，所有这些任务都必须在各自的截止時間（deadline）内完成。本练习将引导您应用实时系统理论中的速率单调调度（Rate-Monotonic Scheduling）方法，为一个典型的HIL任务集进行可调度性分析，确保整个验证系统的实时性能和可靠性。",
            "id": "3918331",
            "problem": "一个电池硬件在环 (HIL) 和软件在环 (SIL) 验证平台在一个单核、可抢占、固定优先级的内核下，使用速率单调调度 (RMS) 执行三个周期性实时任务：一个用于降阶电化学模型的状态估计器、一个用于驱动负载模拟器的电流控制回路，以及一个将同步测量和状态估计写入非易失性存储器的数据记录器。所有任务的截止时间等于其周期，在时间 $t = 0$ 同步释放，释放抖动可忽略不计，且上下文切换和中断开销为零。估计器和控制器在目标平台上的最坏情况执行时间已经测定，而记录器的最坏情况执行时间必须被选择以确保可调度性。\n\n- 估计器任务 $E$：周期 $T_{E} = 1$ ms，最坏情况执行时间 $C_{E} = 0.18$ ms。\n- 控制任务 $C$：周期 $T_{C} = 2$ ms，最坏情况执行时间 $C_{C} = 0.22$ ms。\n- 记录任务 $L$：周期 $T_{L} = 10$ ms，最坏情况执行时间 $C_{L}$ (待定)。\n\n根据速率单调调度，任务按其周期进行优先级排序。请使用固定优先级可调度性分析的基本原理以及针对周期性任务的经典基于利用率的充分可调度性边界，完成以下任务：\n\n1. 确定在速率单调调度下，保证任务集可调度的最大允许值 $C_{L}$。\n2. 在计算出的最大 $C_{L}$ 值下，构建从 $t = 0$到 $t = 10$ ms 一个超周期内的可执行调度，指明 $E$、$C$ 和 $L$ 之间的抢占点，并论证为何 $L$ 在其截止时间 $t = 10$ ms 前完成。\n\n将最大允许值 $C_{L}$ 的最终数值答案四舍五入到四位有效数字。最终答案以毫秒为单位表示。",
            "solution": "问题陈述是连贯的、内部一致的，并且基于实时系统调度理论的既定原则。分析所需的所有参数均已提供。其背景，即用于电池系统的硬件在环 (HIL) 和软件在环 (SIL) 验证平台，是该理论一个可信且相关的应用。因此，该问题被认为是有效的，可以构建一个正式的解决方案。\n\n该问题需要一个两部分的解决方案：首先，基于一个充分的利用率测试，确定记录任务 $L$ 的最大最坏情况执行时间 $C_L$ 以保证可调度性；其次，构建一个超周期内的明确调度，以证明最低优先级的任务能够满足其截止时间。\n\n**1. 最大允许值 $C_L$ 的确定**\n\n调度策略是速率单调调度 (RMS)，这是一种可抢占的固定优先级方案，其中优先级与任务的周期成反比。给定的任务如下：\n- 估计器任务 $E$：$T_{E} = 1$ ms, $C_{E} = 0.18$ ms。\n- 控制任务 $C$：$T_{C} = 2$ ms, $C_{C} = 0.22$ ms。\n- 记录任务 $L$：$T_{L} = 10$ ms, $C_{L}$ 待定。\n\n由于 $T_{E} < T_{C} < T_{L}$，优先级分配为 $Priority(E) > Priority(C) > Priority(L)$。\n\n问题指定使用由 Liu and Layland 建立的、针对 $n$ 个周期性任务集的经典基于利用率的充分可调度性边界。该条件指出，如果一个任务集的总处理器利用率 $U$ 不超过一个特定的边界，则该任务集在 RMS 下是可调度的：\n$$ U = \\sum_{i=1}^{n} \\frac{C_i}{T_i} \\le n(2^{1/n} - 1) $$\n对于给定系统，任务数量为 $n = 3$。利用率边界为：\n$$ U_{bound} = 3(2^{1/3} - 1) $$\n我们计算已知任务的利用率：\n$$ U_E = \\frac{C_E}{T_E} = \\frac{0.18\\,\\text{ms}}{1\\,\\text{ms}} = 0.18 $$\n$$ U_C = \\frac{C_C}{T_C} = \\frac{0.22\\,\\text{ms}}{2\\,\\text{ms}} = 0.11 $$\n记录任务的利用率为 $U_L = \\frac{C_L}{T_L} = \\frac{C_L}{10}$。\n\n总利用率 $U = U_E + U_C + U_L$ 必须满足可调度性条件：\n$$ 0.18 + 0.11 + \\frac{C_L}{10} \\le 3(2^{1/3} - 1) $$\n$$ 0.29 + \\frac{C_L}{10} \\le 3(2^{1/3} - 1) $$\n为了找到最大允许值 $C_L$，我们求解 $C_L$：\n$$ \\frac{C_L}{10} \\le 3(2^{1/3} - 1) - 0.29 $$\n$$ C_L \\le 10 \\left( 3(2^{1/3} - 1) - 0.29 \\right) $$\n数值计算该表达式：\n$$ C_L \\le 10 \\left( 3(1.259921...) - 3 - 0.29 \\right) $$\n$$ C_L \\le 10 \\left( 0.779763... - 0.29 \\right) $$\n$$ C_L \\le 10 \\left( 0.489763... \\right) $$\n$$ C_L \\le 4.89763... \\,\\text{ms} $$\n按要求四舍五入到四位有效数字，记录任务的最大允许最坏情况执行时间为 $C_L = 4.898$ ms。\n\n**2. 调度构建与验证**\n\n我们现在使用计算出的值 $C_L = 4.898$ ms 构建一个超周期内的调度。超周期是任务周期的最小公倍数：$H = \\text{lcm}(1, 2, 10) = 10$ ms。所有任务都在 $t=0$ 时同步释放。\n\n在区间 $[0, 10]$ ms 内的调度如下，跟踪每个作业的执行并记录抢占情况：\n- **`t = 0.000`**: 作业 $E_1$、$C_1$ 和 $L_1$ 被释放。$E_1$（最高优先级）运行。\n- **`[0.000, 0.180]`**: $E_1$ 执行 $C_E=0.18$ ms 并完成。\n- **`[0.180, 0.400]`**: $C_1$（次高优先级）执行 $C_C=0.22$ ms 并完成。\n- **`[0.400, 1.000]`**: $L_1$（最低优先级）执行 $0.600$ ms。$L_1$ 的剩余执行时间为 $4.898 - 0.600 = 4.298$ ms。\n- **`t = 1.000`**: 作业 $E_2$ 被释放并抢占 $L_1$。\n- **`[1.000, 1.180]`**: $E_2$ 执行并完成。\n- **`[1.180, 2.000]`**: $L_1$ 恢复执行，执行 $0.820$ ms。剩余 $C_L = 4.298 - 0.820 = 3.478$ ms。\n- **`t = 2.000`**: 作业 $E_3$ 和 $C_2$ 被释放。$E_3$ 抢占 $L_1$。\n- **`[2.000, 2.180]`**: $E_3$ 执行并完成。\n- **`[2.180, 2.400]`**: $C_2$ 执行并完成。\n- **`[2.400, 3.000]`**: $L_1$ 恢复执行，执行 $0.600$ ms。剩余 $C_L = 3.478 - 0.600 = 2.878$ ms。\n- **`t = 3.000`**: 作业 $E_4$ 被释放并抢占 $L_1$。\n- **`[3.000, 3.180]`**: $E_4$ 执行并完成。\n- **`[3.180, 4.000]`**: $L_1$ 恢复执行，执行 $0.820$ ms。剩余 $C_L = 2.878 - 0.820 = 2.058$ ms。\n- **`t = 4.000`**: 作业 $E_5$ 和 $C_3$ 被释放。$E_5$ 抢占 $L_1$。\n- **`[4.000, 4.180]`**: $E_5$ 执行并完成。\n- **`[4.180, 4.400]`**: $C_3$ 执行并完成。\n- **`[4.400, 5.000]`**: $L_1$ 恢复执行，执行 $0.600$ ms。剩余 $C_L = 2.058 - 0.600 = 1.458$ ms。\n- **`t = 5.000`**: 作业 $E_6$ 被释放并抢占 $L_1$。\n- **`[5.000, 5.180]`**: $E_6$ 执行并完成。\n- **`[5.180, 6.000]`**: $L_1$ 恢复执行，执行 $0.820$ ms。剩余 $C_L = 1.458 - 0.820 = 0.638$ ms。\n- **`t = 6.000`**: 作业 $E_7$ 和 $C_4$ 被释放。$E_7$ 抢占 $L_1$。\n- **`[6.000, 6.180]`**: $E_7$ 执行并完成。\n- **`[6.180, 6.400]`**: $C_4$ 执行并完成。\n- **`[6.400, 7.000]`**: $L_1$ 恢复执行，执行 $0.600$ ms。剩余 $C_L = 0.638 - 0.600 = 0.038$ ms。\n- **`t = 7.000`**: 作业 $E_8$ 被释放并抢占 $L_1$。\n- **`[7.000, 7.180]`**: $E_8$ 执行并完成。\n- **`[7.180, 7.218]`**: $L_1$ 恢复执行，完成其最后的 $0.038$ ms。**$L_1$ 在 $t=7.218$ ms 时完成。**\n- **`t > 7.218`**: 处理器空闲，直到下一个作业在 $t=8.000$ 释放。后续作业 ($E_9, C_5, E_{10}$) 也在超周期的剩余部分内运行并远在其截止时间前完成。\n\n**关于满足截止时间的论证：**\n对调度的分析提供了明确的论证。记录任务的第一个也是唯一一个作业 $L_1$ 在 $t=0$ 时释放，其截止时间为 $t=T_L=10$ ms。详细的调度仿真显示，在被任务 $E$ 的 $8$ 个作业和任务 $C$ 的 $4$ 个作业抢占后，作业 $L_1$ 累积了其所需的 $4.898$ ms 执行时间，并在时间 $t_{finish} = 7.218$ ms 完成。由于其完成时间 $t_{finish} = 7.218$ ms 小于其截止时间 $D_L = 10$ ms，任务 $L$ 满足其截止时间。通过检查可知，所有更高优先级的任务也满足其截止时间，因为它们不会被抢占。因此，当 $C_L = 4.898$ ms 时，该任务集是可调度的。",
            "answer": "$$\\boxed{4.898}$$"
        }
    ]
}