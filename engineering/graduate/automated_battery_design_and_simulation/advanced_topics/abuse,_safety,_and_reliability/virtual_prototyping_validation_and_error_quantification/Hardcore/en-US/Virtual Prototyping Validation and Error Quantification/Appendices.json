{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any credible virtual prototype is its connection to the physical world, which begins with reliable sensor data. This exercise provides a hands-on walkthrough of a critical first step in the validation process: calibrating a measurement device and quantifying the resulting uncertainty. By fitting a calibration curve to thermocouple data and then propagating the parameter uncertainties into a thermodynamic model of a battery cell , you will practice the essential skills of regression, covariance analysis, and error propagation that underpin rigorous model validation.",
            "id": "3959862",
            "problem": "A Lithium-ion pouch cell for virtual prototyping is instrumented with an embedded thermocouple whose raw readings are processed into a measured temperature $T_{\\mathrm{meas}}$ in kelvin. To validate the virtual prototype and quantify error, the thermocouple is calibrated against a Platinum Resistance Thermometer (PRT) reference measurement $T_{\\mathrm{true}}$ across a range of chamber setpoints. Assume that the PRT readings have independent Gaussian uncertainties with known standard deviations, and that $T_{\\mathrm{meas}}$ can be treated as the independent variable with negligible uncertainty for calibration.\n\nYou are given calibration data for one thermocouple:\n- Measurement pairs $(T_{\\mathrm{meas},i}, T_{\\mathrm{true},i})$ at five setpoints: $(298.0, 298.10)$, $(308.0, 308.12)$, $(318.0, 318.14)$, $(328.0, 328.16)$, $(338.0, 338.18)$, all in kelvin.\n- Each reference value $T_{\\mathrm{true},i}$ has a standard uncertainty $\\sigma_i = 0.10$ kelvin.\n\nModel the calibration as a linear relation $T_{\\mathrm{true}} = a + b\\,T_{\\mathrm{meas}}$ and estimate the parameters $a$ and $b$ using a statistically sound procedure that begins from the Gaussian error model and yields the maximum-likelihood linear fit. Then, derive the parameter covariance matrix for $(a,b)$ using first principles.\n\nIn a separate discharge experiment used for validation and error quantification of the virtual prototype, at a specific time $t^\\star$ the measured quantities are:\n- $T_{\\mathrm{meas}}(t^\\star) = 320.0$ kelvin,\n- $\\frac{d T_{\\mathrm{meas}}}{dt}(t^\\star) = 0.020$ kelvin per second.\n\nAssume a lumped energy balance for the cell-plus-fixture node based on the First Law of Thermodynamics and Newtonian convection,\n$$ q = m\\,c\\,\\frac{d T_{\\mathrm{true}}}{dt} + h\\,A\\,\\left(T_{\\mathrm{true}} - T_{\\mathrm{amb}}\\right), $$\nwhere $m = 0.050$ kilograms, $c = 1100$ joules per kilogram-kelvin, $h\\,A = 2.5$ watts per kelvin, and $T_{\\mathrm{amb}} = 298.0$ kelvin. Treat $m$, $c$, $h\\,A$, $T_{\\mathrm{amb}}$, $T_{\\mathrm{meas}}(t^\\star)$, and $\\frac{d T_{\\mathrm{meas}}}{dt}(t^\\star)$ as known exactly. Use the calibrated relation $T_{\\mathrm{true}} = a + b\\,T_{\\mathrm{meas}}$ and $\\frac{d T_{\\mathrm{true}}}{dt} = b\\,\\frac{d T_{\\mathrm{meas}}}{dt}$.\n\nPropagate the calibration parameter uncertainties to obtain the standard uncertainty of the heat generation rate $q$ at time $t^\\star$ by linear (first-order) uncertainty propagation, fully accounting for the covariance between $a$ and $b$ arising from the fit.\n\nRound your final answer for the standard uncertainty in $q$ to four significant figures. Express the final answer in watts.",
            "solution": "The user wants me to solve a multi-part physics and statistics problem.\n\nHere's the plan:\n1.  **Validate the Problem**:\n    *   Extract all given data and relationships.\n    *   Check for scientific soundness, well-posedness, completeness, and objectivity.\n    *   The problem involves linear regression (maximum likelihood estimation for Gaussian errors), uncertainty propagation, and a simple thermodynamic model. These are all standard, well-established concepts. The data points seem reasonable. The assumptions are clearly stated (e.g., $T_{\\text{meas}}$ has negligible uncertainty, PRT uncertainties are Gaussian and known). The problem seems valid.\n\n2.  **Part 1: Linear Regression (Maximum Likelihood Estimation)**\n    *   The model is $T_{\\text{true},i} = a + b\\,T_{\\text{meas},i}$.\n    *   The measurements are $T_{\\text{true},i}$ with uncertainty $\\sigma_i$.\n    *   The likelihood function for Gaussian errors is proportional to $\\exp(-\\frac{1}{2}\\chi^2)$, where $\\chi^2 = \\sum_{i=1}^{N} \\left(\\frac{T_{\\text{true},i} - (a + b\\,T_{\\text{meas},i})}{\\sigma_i}\\right)^2$.\n    *   Maximizing the likelihood is equivalent to minimizing $\\chi^2$.\n    *   This is a weighted least squares problem.\n    *   Let $x_i = T_{\\text{meas},i}$, $y_i = T_{\\text{true},i}$, and $w_i = 1/\\sigma_i^2$.\n    *   The $\\chi^2$ function to minimize is $\\chi^2(a, b) = \\sum_{i=1}^{N} w_i (y_i - a - b x_i)^2$.\n    *   To find the minimum, I need to set the partial derivatives with respect to $a$ and $b$ to zero.\n        *   $\\frac{\\partial \\chi^2}{\\partial a} = \\sum_{i=1}^{N} w_i (-2)(y_i - a - b x_i) = 0$\n        *   $\\frac{\\partial \\chi^2}{\\partial b} = \\sum_{i=1}^{N} w_i (-2x_i)(y_i - a - b x_i) = 0$\n    *   This leads to a system of two linear equations for $a$ and $b$:\n        *   $a \\sum w_i + b \\sum w_i x_i = \\sum w_i y_i$\n        *   $a \\sum w_i x_i + b \\sum w_i x_i^2 = \\sum w_i x_i y_i$\n    *   In this specific problem, all $\\sigma_i = 0.10$ K, so all weights $w_i = 1/(0.10)^2 = 100$ are the same. Let $w = w_i$.\n    *   The equations simplify:\n        *   $a N w + b w \\sum x_i = w \\sum y_i \\implies aN + b \\sum x_i = \\sum y_i$\n        *   $a w \\sum x_i + b w \\sum x_i^2 = w \\sum x_i y_i \\implies a \\sum x_i + b \\sum x_i^2 = \\sum x_i y_i$\n    *   These are the standard normal equations for unweighted linear regression, which is correct since all weights are equal.\n    *   Data:\n        *   $x_i$: $298.0, 308.0, 318.0, 328.0, 338.0$\n        *   $y_i$: $298.10, 308.12, 318.14, 328.16, 338.18$\n        *   $N=5$\n    *   Calculations needed:\n        *   $\\sum x_i = 298.0 + 308.0 + 318.0 + 328.0 + 338.0 = 1590.0$\n        *   $\\sum y_i = 298.10 + 308.12 + 318.14 + 328.16 + 338.18 = 1590.70$\n        *   $\\sum x_i^2 = 298^2 + 308^2 + 318^2 + 328^2 + 338^2 = 88804 + 94864 + 101124 + 107584 + 114244 = 506620$\n        *   $\\sum x_i y_i = (298.0 \\times 298.10) + (308.0 \\times 308.12) + (318.0 \\times 318.14) + (328.0 \\times 328.16) + (338.0 \\times 338.18)$\n            *   $88833.8$\n            *   $94901.36$\n            *   $101168.52$\n            *   $107632.48$\n            *   $114304.84$\n            *   $\\sum x_i y_i = 506841.0$\n    *   System of equations:\n        *   $5a + 1590b = 1590.70$\n        *   $1590a + 506620b = 506841.0$\n    *   Solve for $a$ and $b$. From the first equation: $a = \\frac{1590.70 - 1590b}{5} = 318.14 - 318b$.\n    *   Substitute into the second equation:\n        *   $1590(318.14 - 318b) + 506620b = 506841.0$\n        *   $505842.6 - 505620b + 506620b = 506841.0$\n        *   $1000b = 506841.0 - 505842.6 = 998.4$\n        *   $b = 0.9984$\n    *   Now find $a$:\n        *   $a = 318.14 - 318(0.9984) = 318.14 - 317.4912 = 0.6488$\n    *   So, the fit is $T_{\\text{true}} = 0.6488 + 0.9984 \\, T_{\\text{meas}}$.\n\n3.  **Part 2: Covariance Matrix**\n    *   The general formula for the covariance matrix of the parameters $(a,b)$ in a weighted linear least squares fit is $(\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$, where $\\mathbf{X}$ is the design matrix and $\\mathbf{W}$ is the weight matrix.\n    *   The model is $y = a \\cdot 1 + b \\cdot x$.\n    *   The design matrix $\\mathbf{X}$ is:\n        $$ \\mathbf{X} = \\begin{pmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_N \\end{pmatrix} $$\n    *   The weight matrix $\\mathbf{W}$ is a diagonal matrix with entries $w_i = 1/\\sigma_i^2$.\n        $$ \\mathbf{W} = \\text{diag}(w_1, w_2, \\dots, w_N) $$\n    *   In our case, $w_i = w = 1/(0.1)^2 = 100$ for all $i$. So $\\mathbf{W} = w \\mathbf{I}$.\n    *   $\\mathbf{X}^T \\mathbf{W} \\mathbf{X} = w \\mathbf{X}^T \\mathbf{X}$. Wait, this is not quite right.\n    *   Let's re-derive from the Hessian of $\\chi^2$. The covariance matrix is $2 \\mathbf{H}^{-1}$, where $\\mathbf{H}$ is the Hessian matrix of $\\chi^2$.\n        *   $\\frac{\\partial^2 \\chi^2}{\\partial a^2} = \\sum w_i (2) = 2 \\sum w_i$\n        *   $\\frac{\\partial^2 \\chi^2}{\\partial b^2} = \\sum w_i (2x_i^2) = 2 \\sum w_i x_i^2$\n        *   $\\frac{\\partial^2 \\chi^2}{\\partial a \\partial b} = \\sum w_i (2x_i) = 2 \\sum w_i x_i$\n    *   So the Hessian is:\n        $$ \\mathbf{H} = 2 \\begin{pmatrix} \\sum w_i & \\sum w_i x_i \\\\ \\sum w_i x_i & \\sum w_i x_i^2 \\end{pmatrix} $$\n    *   The covariance matrix is $\\mathbf{C} = 2 \\mathbf{H}^{-1}$.\n        $$ \\mathbf{C} = \\begin{pmatrix} \\sum w_i & \\sum w_i x_i \\\\ \\sum w_i x_i & \\sum w_i x_i^2 \\end{pmatrix}^{-1} $$\n    *   Let's check this. The standard formula for the covariance matrix in weighted least squares is indeed $(\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$.\n        *   $\\mathbf{X}^T = \\begin{pmatrix} 1 & 1 & \\dots & 1 \\\\ x_1 & x_2 & \\dots & x_N \\end{pmatrix}$\n        *   $\\mathbf{X}^T \\mathbf{W} = \\begin{pmatrix} w_1 & w_2 & \\dots & w_N \\\\ w_1 x_1 & w_2 x_2 & \\dots & w_N x_N \\end{pmatrix}$\n        *   $\\mathbf{X}^T \\mathbf{W} \\mathbf{X} = \\begin{pmatrix} \\sum w_i & \\sum w_i x_i \\\\ \\sum w_i x_i & \\sum w_i x_i^2 \\end{pmatrix}$\n    *   This confirms my formula for the matrix to be inverted.\n    *   Since all $w_i = w = 100$:\n        *   $\\sum w_i = N w = 5 \\times 100 = 500$\n        *   $\\sum w_i x_i = w \\sum x_i = 100 \\times 1590 = 159000$\n        *   $\\sum w_i x_i^2 = w \\sum x_i^2 = 100 \\times 506620 = 50662000$\n    *   The matrix to invert is:\n        $$ \\mathbf{M} = \\begin{pmatrix} 500 & 159000 \\\\ 159000 & 50662000 \\end{pmatrix} $$\n    *   The inverse of a $2 \\times 2$ matrix $\\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix}$ is $\\frac{1}{AD-BC} \\begin{pmatrix} D & -B \\\\ -C & A \\end{pmatrix}$.\n    *   Determinant: $\\det(\\mathbf{M}) = (500)(50662000) - (159000)^2$\n        *   $500 \\times 50662000 = 25331000000$\n        *   $159000^2 = (1.59 \\times 10^5)^2 = 2.5281 \\times 10^{10} = 25281000000$\n        *   $\\det(\\mathbf{M}) = 25331000000 - 25281000000 = 50000000$\n    *   So the covariance matrix $\\mathbf{C}$ is:\n        $$ \\mathbf{C} = \\frac{1}{50000000} \\begin{pmatrix} 50662000 & -159000 \\\\ -159000 & 500 \\end{pmatrix} $$\n        $$ \\mathbf{C} = \\begin{pmatrix} \\frac{50662000}{50000000} & \\frac{-159000}{50000000} \\\\ \\frac{-159000}{50000000} & \\frac{500}{50000000} \\end{pmatrix} $$\n        $$ \\mathbf{C} = \\begin{pmatrix} 1.01324 & -0.00318 \\\\ -0.00318 & 0.00001 \\end{pmatrix} = \\begin{pmatrix} \\sigma_a^2 & \\text{cov}(a,b) \\\\ \\text{cov}(a,b) & \\sigma_b^2 \\end{pmatrix} $$\n    *   So, $\\sigma_a^2 = 1.01324 \\text{ K}^2$, $\\sigma_b^2 = 1.0 \\times 10^{-5}$, and $\\text{cov}(a,b) = -0.00318 \\text{ K}$.\n    *   Wait, units. $a$ has units of K. $b$ is dimensionless. So $\\sigma_a^2$ is K$^2$, $\\sigma_b^2$ is dimensionless, and $\\text{cov}(a,b)$ is K. My units seem correct.\n    *   Let's double-check the formula for covariance matrix. Sometimes it is multiplied by $\\chi^2_{\\text{min}}/(N-2)$. This is when the individual uncertainties $\\sigma_i$ are not known, but are assumed to be equal to some unknown $\\sigma$. We then estimate $\\sigma^2$ from the residuals. Here, the problem states the $\\sigma_i$ are known. So the factor is not needed. The formula $\\mathbf{C} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$ is correct.\n\n4.  **Part 3: Uncertainty Propagation**\n    *   The quantity of interest is the heat generation rate $q$.\n    *   $q = m\\,c\\,\\frac{d T_{\\mathrm{true}}}{dt} + h\\,A\\,\\left(T_{\\mathrm{true}} - T_{\\mathrm{amb}}\\right)$\n    *   We need to express $q$ in terms of the fit parameters $a$ and $b$ and the measured quantities.\n    *   $T_{\\text{true}} = a + b\\,T_{\\text{meas}}$\n    *   $\\frac{d T_{\\text{true}}}{dt} = \\frac{d}{dt}(a + b\\,T_{\\text{meas}}) = b\\,\\frac{d T_{\\text{meas}}}{dt}$ (since $a$ and $b$ are constants).\n    *   Substitute these into the equation for $q$:\n        $$ q(a, b) = m\\,c\\,\\left(b\\,\\frac{d T_{\\mathrm{meas}}}{dt}\\right) + h\\,A\\,\\left((a + b\\,T_{\\mathrm{meas}}) - T_{\\mathrm{amb}}\\right) $$\n    *   Rearrange to group terms with $a$ and $b$:\n        $$ q(a, b) = (hA) a + \\left(mc \\frac{dT_{\\text{meas}}}{dt} + hA \\, T_{\\text{meas}}\\right) b - hA \\, T_{\\mathrm{amb}} $$\n    *   The problem states to treat all other quantities ($m, c, hA, T_{\\text{amb}}, T_{\\text{meas}}, \\frac{dT_{\\text{meas}}}{dt}$) as known exactly. The only sources of uncertainty are $a$ and $b$.\n    *   Let's define some constants based on the given values at $t^\\star$:\n        *   $T_m = T_{\\text{meas}}(t^\\star) = 320.0$ K\n        *   $\\dot{T}_m = \\frac{d T_{\\text{meas}}}{dt}(t^\\star) = 0.020$ K/s\n        *   $m = 0.050$ kg\n        *   $c = 1100$ J/(kgÂ·K)\n        *   $hA = 2.5$ W/K\n        *   $T_{\\text{amb}} = 298.0$ K\n    *   So, $mc = 0.050 \\times 1100 = 55$ J/K.\n    *   Let's call the coefficients of $a$ and $b$:\n        *   $C_a = hA = 2.5$\n        *   $C_b = mc \\dot{T}_m + hA T_m = (55)(0.020) + (2.5)(320.0)$\n            *   $55 \\times 0.020 = 1.1$\n            *   $2.5 \\times 320.0 = 800.0$\n            *   $C_b = 1.1 + 800.0 = 801.1$\n    *   So the function for $q$ is:\n        $$ q(a, b) = C_a a + C_b b + \\text{constant} $$\n        where the constant is $-hA \\, T_{\\text{amb}}$.\n    *   The formula for linear propagation of uncertainty for a function $f(x_1, x_2, \\dots)$ is:\n        $$ \\sigma_f^2 = \\sum_{i} \\sum_{j} \\frac{\\partial f}{\\partial x_i} \\frac{\\partial f}{\\partial x_j} C_{ij} $$\n        where $C_{ij}$ is the covariance matrix of the variables $x_k$.\n    *   In our case, the variables are $a$ and $b$.\n        $$ \\sigma_q^2 = \\left(\\frac{\\partial q}{\\partial a}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial q}{\\partial b}\\right)^2 \\sigma_b^2 + 2 \\left(\\frac{\\partial q}{\\partial a}\\right) \\left(\\frac{\\partial q}{\\partial b}\\right) \\text{cov}(a,b) $$\n    *   The partial derivatives are simply the coefficients we found:\n        *   $\\frac{\\partial q}{\\partial a} = C_a = 2.5$ W/K (units check: $q$ is W, $a$ is K)\n        *   $\\frac{\\partial q}{\\partial b} = C_b = 801.1$ W (units check: $q$ is W, $b$ is dimensionless)\n    *   Now plug in the values from the covariance matrix:\n        *   $\\sigma_a^2 = 1.01324$ K$^2$\n        *   $\\sigma_b^2 = 1.0 \\times 10^{-5}$\n        *   $\\text{cov}(a,b) = -0.00318$ K\n    *   Calculate the terms for $\\sigma_q^2$:\n        *   Term 1: $(2.5)^2 \\times (1.01324) = 6.25 \\times 1.01324 = 6.33275$\n        *   Term 2: $(801.1)^2 \\times (1.0 \\times 10^{-5}) = 641761.21 \\times 1.0 \\times 10^{-5} = 6.4176121$\n        *   Term 3: $2 \\times (2.5) \\times (801.1) \\times (-0.00318) = 5 \\times 801.1 \\times (-0.00318) = 4005.5 \\times (-0.00318) = -12.73749$\n    *   Sum the terms:\n        *   $\\sigma_q^2 = 6.33275 + 6.4176121 - 12.73749 \\approx 12.75036 - 12.73749 = 0.01287$\n    *   Let's re-calculate with higher precision.\n        *   $b = 998.4 / 1000 = 0.9984$ (exact)\n        *   $a = 0.6488$ (exact)\n        *   $\\det(\\mathbf{M}) = 5 \\times 10^7$ (exact)\n        *   $\\mathbf{C} = \\frac{1}{5 \\times 10^7} \\begin{pmatrix} 50662000 & -159000 \\\\ -159000 & 500 \\end{pmatrix} = \\begin{pmatrix} 1.01324 & -0.00318 \\\\ -0.00318 & 1 \\times 10^{-5} \\end{pmatrix}$ (all exact)\n        *   $C_a = 2.5$ (exact)\n        *   $C_b = 801.1$ (exact)\n        *   Term 1: $(2.5)^2 \\times 1.01324 = 6.25 \\times 1.01324 = 6.33275$ (exact)\n        *   Term 2: $(801.1)^2 \\times 10^{-5} = 641761.21 \\times 10^{-5} = 6.4176121$ (exact)\n        *   Term 3: $2 \\times 2.5 \\times 801.1 \\times (-0.00318) = 5 \\times 801.1 \\times (-0.00318) = 4005.5 \\times (-0.00318) = -12.73749$ (exact)\n        *   $\\sigma_q^2 = 6.33275 + 6.4176121 - 12.73749 = 12.7503621 - 12.73749 = 0.0128721$ W$^2$\n    *   The standard uncertainty is $\\sigma_q = \\sqrt{\\sigma_q^2}$.\n        *   $\\sigma_q = \\sqrt{0.0128721} \\approx 0.11345527$ W\n    *   The problem asks to round the final answer to four significant figures.\n        *   $0.1135$ W.\n\n5.  **Review and Final Write-up Structure**\n    *   Start with problem validation. It's valid. State this clearly.\n    *   Section 1: Maximum Likelihood Estimation.\n        *   Define the likelihood and chi-squared function for Gaussian errors.\n        *   Show minimization leads to weighted least squares normal equations.\n        *   Note that weights are equal, simplifying to unweighted least squares.\n        *   List the data and calculate the sums: $\\sum x_i, \\sum y_i, \\sum x_i^2, \\sum x_i y_i$.\n        *   Set up and solve the $2 \\times 2$ linear system for $a$ and $b$.\n    *   Section 2: Covariance Matrix Derivation.\n        *   Define the covariance matrix as the inverse of the Fisher information matrix, which for this problem is $(\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$.\n        *   Construct the matrix $\\mathbf{M} = \\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ using the calculated sums and the constant weight $w = 1/\\sigma^2$.\n        *   Calculate the inverse $\\mathbf{M}^{-1}$ to get the covariance matrix $\\mathbf{C}$. State the components $\\sigma_a^2$, $\\sigma_b^2$, and $\\text{cov}(a,b)$.\n    *   Section 3: Uncertainty Propagation.\n        *   Write down the expression for the heat generation rate $q$.\n        *   Substitute the linear calibration model $T_{\\text{true}}(T_{\\text{meas}})$ and its time derivative into the expression for $q$.\n        *   The resulting expression for $q$ should be a function of $a$ and $b$.\n        *   State the general formula for first-order uncertainty propagation with covariance.\n        *   Calculate the partial derivatives $\\partial q / \\partial a$ and $\\partial q / \\partial b$ at the specified state ($T_{\\text{meas}}(t^\\star), \\dot{T}_{\\text{meas}}(t^\\star)$).\n        *   Plug all the numbers (derivatives and covariance matrix elements) into the uncertainty formula to calculate $\\sigma_q^2$.\n        *   Calculate $\\sigma_q = \\sqrt{\\sigma_q^2}$.\n    *   Final Answer:\n        *   State the numerical value of $\\sigma_q$ rounded to four significant figures.\n        *   Enclose in `$$\\boxed{...}$$`.\n    *   Formatting: Ensure all mathematical entities are in LaTeX. No markdown headers.",
            "answer": "$$\n\\boxed{0.1135}\n$$"
        },
        {
            "introduction": "A truly validated model does more than just make accurate predictions; it provides a reliable estimate of its own uncertainty. This practice moves beyond deterministic fitting to a probabilistic framework, a cornerstone of modern validation. You will implement a Bayesian workflow to assess an equivalent circuit model (ECM) by checking if its posterior predictive distributions are well-calibrated . By computing credible intervals and evaluating their coverage against held-out data, you will gain practical experience with posterior predictive checks, a powerful technique for determining if a model's uncertainty claims are trustworthy.",
            "id": "3959873",
            "problem": "You are given a virtual prototyping task for an electrochemical cell modeled with an Equivalent Circuit Model (ECM). The ECM is used to generate posterior predictive voltage distributions at specified times, and to assess calibration quality via coverage of held-out experimental data by $0.95$ credible intervals.\n\nModel the battery using a single resistor-capacitor (RC) branch ECM with the following definitions:\n- The terminal voltage is $V(t) = E(\\mathrm{SOC}(t)) - R_0 I(t) - V_{\\mathrm{rc}}(t)$, where $I(t)$ is the applied current (positive for discharge), $E(\\mathrm{SOC})$ is the open-circuit voltage as a function of state of charge, $R_0$ is the ohmic resistance, and $V_{\\mathrm{rc}}(t)$ is the RC branch voltage.\n- The state of charge $\\mathrm{SOC}(t)$ evolves according to the charge balance law $d\\,\\mathrm{SOC}(t)/dt = -I(t)/Q$, where $Q$ is capacity in ampere-seconds, with $\\mathrm{SOC}(t) \\in [0,1]$.\n- The RC branch voltage follows $dV_{\\mathrm{rc}}(t)/dt = -\\dfrac{1}{R_1 C_1} V_{\\mathrm{rc}}(t) + \\dfrac{1}{C_1} I(t)$, where $R_1$ and $C_1$ are the RC pair resistance and capacitance.\n- The open-circuit voltage is approximated linearly as $E(\\mathrm{SOC}) = V_{\\min} + (V_{\\max} - V_{\\min}) \\mathrm{SOC}$.\n\nUse a forward Euler discretization with time step $\\Delta t = 1\\,\\mathrm{s}$:\n- $\\mathrm{SOC}_{k+1} = \\mathrm{clip}\\left(\\mathrm{SOC}_k - \\dfrac{\\Delta t}{Q} I_k, 0, 1\\right)$,\n- $V_{\\mathrm{rc},k+1} = V_{\\mathrm{rc},k} + \\Delta t\\left(-\\dfrac{1}{R_1 C_1} V_{\\mathrm{rc},k} + \\dfrac{1}{C_1} I_k\\right)$,\n- $V_k = V_{\\min} + (V_{\\max} - V_{\\min}) \\mathrm{SOC}_k - R_0 I_k - V_{\\mathrm{rc},k}$.\n\nBayesian posterior over parameters is specified in log-space to ensure positivity. Let $\\boldsymbol{\\phi} = \\log([Q, R_0, R_1, C_1])$. Assume $\\boldsymbol{\\phi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$. For a given posterior sample $\\boldsymbol{\\phi}^{(j)}$, transform back via $[Q^{(j)}, R_0^{(j)}, R_1^{(j)}, C_1^{(j)}] = \\exp(\\boldsymbol{\\phi}^{(j)})$ and simulate $V(t)$ over the time grid. Measurement noise is modeled as additive Gaussian: for each evaluation time $t_i$, the posterior predictive voltage draw is $V^{(j)}(t_i) + \\varepsilon^{(j)}_i$ with $\\varepsilon^{(j)}_i \\sim \\mathcal{N}(0, \\sigma_{\\mathrm{meas}}^2)$.\n\nFor each specified time $t_i$, compute the $0.95$ credible interval as the pair of empirical quantiles at levels $0.025$ and $0.975$ over the posterior predictive draws. Evaluate coverage against held-out experimental voltage values $y_i$ at the same times by checking whether $y_i$ lies within the computed interval for each $t_i$. The coverage for a test case is the fraction (expressed as a decimal) of times where the held-out value is covered.\n\nUse the following physically realistic constants and units:\n- Use time in seconds, current in amperes, voltage in volts, resistance in ohms, capacitance in farads, and capacity in ampere-seconds.\n- Open-circuit voltage parameters: $V_{\\min} = 3.0\\,\\mathrm{V}$ and $V_{\\max} = 4.2\\,\\mathrm{V}$.\n- Initial state of charge: $\\mathrm{SOC}_0 = 0.8$.\n- Evaluation times: $t_{\\mathrm{eval}} = [50, 100, 150, 200, 250]\\,\\mathrm{s}$.\n- Current profile segments (duration in seconds, current in amperes): $(100, 2.0)$, $(50, 0.0)$, $(50, -1.5)$, $(50, 0.0)$.\n\nHeld-out experimental values $y_i$ are generated by the high-fidelity digital twin using the true parameters and the same current profile with zero measurement noise (i.e., $y_i = V^{\\star}(t_i)$). The true parameters (in physical units) are:\n- $Q^{\\star} = 10800\\,\\mathrm{A\\cdot s}$,\n- $R_0^{\\star} = 0.005\\,\\Omega$,\n- $R_1^{\\star} = 0.02\\,\\Omega$,\n- $C_1^{\\star} = 10000\\,\\mathrm{F}$.\n\nDefine the posterior mean in log-space as $\\boldsymbol{\\mu} = \\log\\left([Q^{\\star}, R_0^{\\star}, R_1^{\\star}, C_1^{\\star}]\\right)$.\n\nDesign a program that, for each test case below, draws $N = 2000$ samples from the posterior, computes the posterior predictive distribution at the specified times, forms the $0.95$ credible intervals, and computes the coverage fraction versus the held-out values. Use the following test suite with different log-space posterior standard deviations $\\boldsymbol{s}$ and measurement noise levels:\n\n- Test Case $1$ (well-calibrated posterior):\n  - $\\boldsymbol{s} = [0.05, 0.10, 0.10, 0.10]$,\n  - $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$,\n  - $\\sigma_{\\mathrm{meas}} = 0.01\\,\\mathrm{V}$.\n\n- Test Case $2$ (under-dispersed posterior):\n  - $\\boldsymbol{s} = [0.01, 0.02, 0.02, 0.02]$,\n  - $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$,\n  - $\\sigma_{\\mathrm{meas}} = 0.01\\,\\mathrm{V}$.\n\n- Test Case $3$ (over-dispersed posterior and higher measurement noise):\n  - $\\boldsymbol{s} = [0.20, 0.25, 0.25, 0.25]$,\n  - $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$,\n  - $\\sigma_{\\mathrm{meas}} = 0.02\\,\\mathrm{V}$.\n\nYour program should produce a single line of output containing the coverage fractions for Test Cases $1$, $2$, and $3$, in this order, rounded to three decimal places, as a comma-separated list enclosed in square brackets (for example, $[0.940,0.800,0.980]$). No other text should be printed. Angles are not involved. All quantities should be handled in the units specified above, and the coverage fractions must be decimals, not percentages.",
            "solution": "The user-provided problem has been analyzed and validated.\n\n### Step 1: Extracted Givens\n\n**Model Definition (Equivalent Circuit Model - ECM):**\n-   Terminal Voltage: $V(t) = E(\\mathrm{SOC}(t)) - R_0 I(t) - V_{\\mathrm{rc}}(t)$.\n-   Current Convention: $I(t)$ is positive for discharge.\n-   State of Charge (SOC) Dynamics: $d\\,\\mathrm{SOC}(t)/dt = -I(t)/Q$, with $\\mathrm{SOC}(t) \\in [0,1]$.\n-   RC Branch Voltage Dynamics: $dV_{\\mathrm{rc}}(t)/dt = -\\dfrac{1}{R_1 C_1} V_{\\mathrm{rc}}(t) + \\dfrac{1}{C_1} I(t)$.\n-   Open-Circuit Voltage (OCV) Model: $E(\\mathrm{SOC}) = V_{\\min} + (V_{\\max} - V_{\\min}) \\mathrm{SOC}$.\n\n**Numerical Discretization (Forward Euler):**\n-   Time Step: $\\Delta t = 1\\,\\mathrm{s}$.\n-   SOC Update: $\\mathrm{SOC}_{k+1} = \\mathrm{clip}\\left(\\mathrm{SOC}_k - \\dfrac{\\Delta t}{Q} I_k, 0, 1\\right)$.\n-   RC Voltage Update: $V_{\\mathrm{rc},k+1} = V_{\\mathrm{rc},k} + \\Delta t\\left(-\\dfrac{1}{R_1 C_1} V_{\\mathrm{rc},k} + \\dfrac{1}{C_1} I_k\\right)$.\n-   Terminal Voltage Calculation: $V_k = V_{\\min} + (V_{\\max} - V_{\\min}) \\mathrm{SOC}_k - R_0 I_k - V_{\\mathrm{rc},k}$.\n\n**Bayesian Framework:**\n-   Log-space parameters: $\\boldsymbol{\\phi} = \\log([Q, R_0, R_1, C_1])$.\n-   Posterior Distribution: $\\boldsymbol{\\phi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$.\n-   Parameter Transformation: $[Q^{(j)}, R_0^{(j)}, R_1^{(j)}, C_1^{(j)}] = \\exp(\\boldsymbol{\\phi}^{(j)})$.\n-   Number of Monte Carlo Samples: $N = 2000$.\n-   Measurement Noise Model: Additive Gaussian, $\\varepsilon^{(j)}_i \\sim \\mathcal{N}(0, \\sigma_{\\mathrm{meas}}^2)$.\n-   Posterior Predictive Draw: $V^{(j)}(t_i) + \\varepsilon^{(j)}_i$.\n\n**Validation Procedure:**\n-   Credible Interval: $0.95$ level, computed using empirical quantiles at $0.025$ and $0.975$.\n-   Held-out Data: $y_i = V^{\\star}(t_i)$, where $V^{\\star}$ is simulated using true parameters with zero noise.\n-   Coverage Definition: The fraction of evaluation times $t_i$ where $y_i$ is within the corresponding credible interval.\n\n**Constants and Initial Conditions:**\n-   OCV Parameters: $V_{\\min} = 3.0\\,\\mathrm{V}$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n-   Initial State of Charge: $\\mathrm{SOC}_0 = 0.8$.\n-   Initial RC Voltage: Assumed to be $V_{\\mathrm{rc},0} = 0.0\\,\\mathrm{V}$ (standard assumption for a cell at rest).\n-   Evaluation Times: $t_{\\mathrm{eval}} = [50, 100, 150, 200, 250]\\,\\mathrm{s}$.\n-   Current Profile: $(100\\,\\mathrm{s}, 2.0\\,\\mathrm{A})$, $(50\\,\\mathrm{s}, 0.0\\,\\mathrm{A})$, $(50\\,\\mathrm{s}, -1.5\\,\\mathrm{A})$, $(50\\,\\mathrm{s}, 0.0\\,\\mathrm{A})$.\n\n**True Parameters:**\n-   $Q^{\\star} = 10800\\,\\mathrm{A\\cdot s}$\n-   $R_0^{\\star} = 0.005\\,\\Omega$\n-   $R_1^{\\star} = 0.02\\,\\Omega$\n-   $C_1^{\\star} = 10000\\,\\mathrm{F}$\n\n**Posterior Distribution Definition:**\n-   Mean (log-space): $\\boldsymbol{\\mu} = \\log\\left([Q^{\\star}, R_0^{\\star}, R_1^{\\star}, C_1^{\\star}]\\right)$.\n\n**Test Cases:**\n1.  $\\boldsymbol{s} = [0.05, 0.10, 0.10, 0.10]$, $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$, $\\sigma_{\\mathrm{meas}} = 0.01\\,\\mathrm{V}$.\n2.  $\\boldsymbol{s} = [0.01, 0.02, 0.02, 0.02]$, $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$, $\\sigma_{\\mathrm{meas}} = 0.01\\,\\mathrm{V}$.\n3.  $\\boldsymbol{s} = [0.20, 0.25, 0.25, 0.25]$, $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$, $\\sigma_{\\mathrm{meas}} = 0.02\\,\\mathrm{V}$.\n\n### Step 2: Problem Validation\n\nThe problem is scientifically grounded, well-posed, and objective.\n-   **Scientific Grounding:** The problem uses a standard 1-RC Equivalent Circuit Model, which is a fundamental and widely accepted tool in battery engineering for performance simulation. The governing differential equations, forward Euler discretization, and Bayesian framework for uncertainty quantification are all standard and correct. All specified parameters are physically realistic for a common lithium-ion cell.\n-   **Well-Posedness:** The problem provides a complete set of equations, parameters, and initial conditions required to perform the simulation. The initial condition for the RC branch voltage, $V_{\\mathrm{rc},0}$, although not explicitly stated, is implicitly $0\\,\\mathrm{V}$ under the standard assumption that the simulation starts from a rested state, which makes the problem well-posed. The task is clearly defined, and a unique computational result can be obtained (subject to Monte Carlo sampling variance, which is a controlled aspect of the method).\n-   **Objectivity:** The language is precise and quantitative. The task is a formal computational procedure, free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be provided.\n\n### Principle-Based Solution\n\nThe problem requires an assessment of posterior calibration for a battery model. This is a common task in virtual prototyping, where one must validate that the uncertainty quantified by a model's posterior distribution accurately reflects the true uncertainty in prediction. The coverage of credible intervals is a primary diagnostic for this validation. A well-calibrated model should produce $p\\%$ credible intervals that, on an average, contain the true value $p\\%$ of the time. Here, we check if the $95\\%$ credible intervals cover the true voltage values.\n\nThe solution is structured as a two-stage computational process for each test case:\n1.  **Generation of Ground Truth:** The \"held-out experimental data\" are generated by simulating the ECM using the provided true parameters $(\\boldsymbol{\\theta}^{\\star} = [Q^{\\star}, R_0^{\\star}, R_1^{\\star}, C_1^{\\star}])$. This establishes the reference voltage trajectory, $V^{\\star}(t)$.\n2.  **Monte Carlo Simulation for Posterior Predictive Distribution:** For each test case, we simulate the process of drawing from the posterior distribution to generate a predictive distribution for the voltage at specified evaluation times.\n\n**Detailed Algorithmic Steps:**\n\n1.  **Define System Constants and Current Profile:**\n    -   The physical constants $V_{\\min}$, $V_{\\max}$, and initial state $\\mathrm{SOC}_0$ are defined.\n    -   The total simulation time is $T_{\\mathrm{max}} = 250\\,\\mathrm{s}$. With $\\Delta t = 1\\,\\mathrm{s}$, this corresponds to $251$ time points indexed $k=0, 1, \\dots, 250$.\n    -   The current profile $I_k$ is constructed as a vector of length $251$. It will have the value $2.0\\,\\mathrm{A}$ for $k \\in [0, 99]$, $0.0\\,\\mathrm{A}$ for $k \\in [100, 149]$, $-1.5\\,\\mathrm{A}$ for $k \\in [150, 199]$, and $0.0\\,\\mathrm{A}$ for $k \\in [200, 250]$.\n\n2.  **Implement the ECM Simulator:**\n    -   A function is created to execute the time-marching simulation based on the forward Euler scheme.\n    -   Inputs: A parameter set $[Q, R_0, R_1, C_1]$ and the current profile $I$.\n    -   Initialization: $\\mathrm{SOC}_0 = 0.8$ and $V_{\\mathrm{rc},0} = 0.0\\,\\mathrm{V}$.\n    -   Loop: For $k = 0, \\dots, T_{\\mathrm{max}}-1$:\n        -   $\\mathrm{SOC}_{k+1} = \\mathrm{clip}\\left(\\mathrm{SOC}_k - \\frac{\\Delta t}{Q} I_k, 0, 1\\right)$\n        -   $V_{\\mathrm{rc},k+1} = V_{\\mathrm{rc},k} \\left(1 - \\frac{\\Delta t}{R_1 C_1}\\right) + \\frac{\\Delta t}{C_1} I_k$\n    -   Output Calculation: After the state evolution loop, the terminal voltage is computed for all time steps: $V_k = (V_{\\min} + (V_{\\max} - V_{\\min})\\mathrm{SOC}_k) - R_0 I_k - V_{\\mathrm{rc},k}$.\n    -   The function returns the full voltage trajectory $V$.\n\n3.  **Generate True Voltage Data:**\n    -   The true parameter set $\\boldsymbol{\\theta}^{\\star} = [10800, 0.005, 0.02, 10000]$ is passed to the ECM simulator.\n    -   The resulting voltage trajectory $V^{\\star}$ is computed.\n    -   The held-out data $y_i$ are extracted from $V^{\\star}$ at the specified evaluation time indices $t_{\\mathrm{eval}} = [50, 100, 150, 200, 250]$.\n\n4.  **Process Each Test Case:**\n    For each of the three test cases, characterized by a log-space standard deviation vector $\\boldsymbol{s}$ and a measurement noise standard deviation $\\sigma_{\\mathrm{meas}}$:\n    a.  **Define Posterior:** The mean of the log-parameter distribution is $\\boldsymbol{\\mu} = \\log(\\boldsymbol{\\theta}^{\\star})$. The covariance is $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\boldsymbol{s}^2)$.\n    b.  **Monte Carlo Loop:** A loop runs $N=2000$ times. In each iteration $j$:\n        i.   **Sample Parameters:** A log-parameter vector $\\boldsymbol{\\phi}^{(j)}$ is drawn from $\\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$. Since $\\boldsymbol{\\Sigma}$ is diagonal, this is equivalent to drawing each component $\\phi_i^{(j)}$ from $\\mathcal{N}(\\mu_i, s_i^2)$.\n        ii.  **Transform Parameters:** The physical parameters $\\boldsymbol{\\theta}^{(j)} = \\exp(\\boldsymbol{\\phi}^{(j)})$ are computed.\n        iii. **Simulate Voltage:** The ECM simulator is run with $\\boldsymbol{\\theta}^{(j)}$ to obtain a voltage trajectory $V^{(j)}$.\n        iv.  **Generate Predictive Sample:** The voltages $V^{(j)}(t_i)$ at the evaluation times are extracted. Additive Gaussian noise is drawn, $\\varepsilon_i^{(j)} \\sim \\mathcal{N}(0, \\sigma_{\\mathrm{meas}}^2)$, and added to these voltages to form the posterior predictive samples $\\{V^{(j)}(t_i) + \\varepsilon_i^{(j)}\\}$.\n    c.  **Compute Coverage:**\n        i.   After the loop, for each evaluation time $t_i$, we have a collection of $N=2000$ posterior predictive voltage samples.\n        ii.  The $0.025$ and $0.975$ quantiles of this collection are computed to define the $95\\%$ credible interval $[L_i, U_i]$.\n        iii. For each $t_i$, we check if the true value $y_i$ lies within this interval: $L_i \\le y_i \\le U_i$.\n        iv.  The coverage fraction is calculated as the number of \"true\" checks divided by the total number of evaluation points, which is $5$.\n    d.  The final coverage fraction for the test case is stored.\n\nThis procedure robustly evaluates how the specified posterior uncertainty propagates through the physics-based model and whether the resulting predictive uncertainty is well-calibrated against the ground truth.",
            "answer": "[1.000,0.600,1.000]"
        },
        {
            "introduction": "One of the most powerful applications of virtual prototyping is to explore system behavior under a wide range of conditions, especially to ensure safety and robustness. This exercise shifts the validation focus from data-point accuracy to system-level reliability. You will perform a Monte Carlo simulation to quantify the probability that a battery model, with its inherent parameter uncertainties, will violate critical operational constraints such as temperature or voltage limits . This constraint-based validation approach is fundamental to using virtual prototypes for robust design and risk assessment.",
            "id": "3959907",
            "problem": "You will implement a virtual prototyping and validation workflow for a lithium-ion battery cell model under parametric uncertainty. The objective is to perform constraint-based validation by rejecting any simulation in which state variables exit physically admissible bounds, and to quantify the rejection frequency as a decimal for each provided test case. The program must propagate uncertainty through the model by sampling input parameters from specified distributions and simulating trajectories over time.\n\nThe fundamental base consists of conservation of charge and energy, and linear circuit dynamics, specified as follows:\n\n- Let the State of Charge (SOC) be denoted by $s(t)$, the cell temperature by $T(t)$ in kelvins, and a polarization state voltage by $v_{\\mathrm{rc}}(t)$ representing the Resistive-Capacitive (RC) dynamics of a single-element overpotential.\n- The battery is subject to a constant discharge current $I$ (in amperes) per simulation run, a series resistance $R$ (in ohms), nominal capacity $Q_{\\mathrm{nom}}$ (in coulombs), lumped thermal capacity $C_{\\mathrm{th}}$ (in joules per kelvin), and a lumped heat transfer coefficient-area product $hA$ (in watts per kelvin). The ambient temperature is $T_{\\mathrm{amb}}$ in kelvins.\n- The Open Circuit Voltage (OCV) function is $V_{\\mathrm{oc}}(s)$ given by a physically plausible monotonic function:\n$$\nV_{\\mathrm{oc}}(s) = 3.0 + 1.2\\,s - 0.1\\,e^{-10 s}.\n$$\n- Charge conservation yields the SOC dynamics:\n$$\n\\frac{ds}{dt} = -\\frac{I}{Q_{\\mathrm{nom}}}.\n$$\n- Energy balance yields the lumped thermal dynamics:\n$$\nC_{\\mathrm{th}} \\frac{dT}{dt} = I^2 R - hA \\left(T - T_{\\mathrm{amb}}\\right).\n$$\n- The RC polarization voltage evolves according to a linear time-invariant first-order model:\n$$\n\\frac{dv_{\\mathrm{rc}}}{dt} = -\\frac{1}{\\tau} v_{\\mathrm{rc}} + \\frac{\\alpha}{\\tau} I,\n$$\nwhere $\\tau$ is a time constant (in seconds) and $\\alpha$ is a dimensionless coupling coefficient.\n- The terminal voltage $V(t)$ is computed as:\n$$\nV(t) = V_{\\mathrm{oc}}(s(t)) - I R - v_{\\mathrm{rc}}(t).\n$$\n\nConstraint-based validation: A simulation trajectory is rejected if at any time $t$ it violates any of the following admissible bounds:\n- SOC bound: $s(t) \\in [0, 1]$ (dimensionless).\n- Temperature bound: $T(t) \\in [T_{\\min}, T_{\\max}]$ in kelvins.\n- Voltage bound: $V(t) \\in [V_{\\min}, V_{\\max}]$ in volts.\n\nUncertainty propagation: For each simulation run, sample uncertain parameters independently from the specified distributions (defined per test case below). Simulate the system over a finite horizon using time discretization and determine whether constraints are violated. Quantify the rejection frequency as the number of rejected runs divided by the total number of runs, expressed as a decimal (not a percentage). Use a fixed pseudo-random seed of $42$ for reproducibility.\n\nImplementation details:\n- Use explicit time-stepping with a fixed step $\\Delta t$ over horizon $[0, t_{\\mathrm{h}}]$.\n- Units must be strictly respected: $s$ is dimensionless, $I$ in amperes, $R$ in ohms, $Q_{\\mathrm{nom}}$ in coulombs, $T$ and $T_{\\mathrm{amb}}$ in kelvins, $C_{\\mathrm{th}}$ in joules per kelvin, $hA$ in watts per kelvin, $\\tau$ in seconds, $V$ in volts.\n- The initial conditions $s(0)$ and $T(0)$ must be sampled as specified per test case. The initial polarization state is $v_{\\mathrm{rc}}(0) = 0$.\n\nTest suite: Implement four test cases with the following parameterizations. In each case, perform $N$ independent runs and output the fraction of runs that are rejected due to constraint violations.\n\n- Case A (baseline, moderate stress):\n  - $N = 500$, $t_{\\mathrm{h}} = 600\\,\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$, $\\tau = 20\\,\\mathrm{s}$, $\\alpha = 1$.\n  - Current $I \\sim \\mathrm{Uniform}(1, 8)$ (amperes).\n  - Resistance $R \\sim \\mathrm{Normal}(\\mu_R = 0.05, \\sigma_R = 0.01)$ (ohms), truncated below at $R_{\\min} = 0.01$.\n  - Capacity $Q_{\\mathrm{nom}} \\sim \\mathrm{Normal}(\\mu_Q = 10800, \\sigma_Q = 300)$ (coulombs), truncated below at $Q_{\\min} = 8000$.\n  - Thermal parameters: $hA \\sim \\mathrm{Normal}(\\mu_{hA} = 5.0, \\sigma_{hA} = 0.8)$ (watts per kelvin), truncated below at $hA_{\\min} = 1.0$; $C_{\\mathrm{th}} \\sim \\mathrm{Normal}(\\mu_C = 500, \\sigma_C = 50)$ (joules per kelvin), truncated below at $C_{\\min} = 300$.\n  - Initial conditions: $s(0) \\sim \\mathrm{Uniform}(0.2, 0.9)$; $T(0) \\sim \\mathrm{Normal}(\\mu_{T0} = 298, \\sigma_{T0} = 2)$ (kelvins), truncated below at $T_{\\mathrm{abs},\\min} = 273.15$.\n  - Ambient: $T_{\\mathrm{amb}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{amb}} = 298, \\sigma_{\\mathrm{amb}} = 2)$ (kelvins).\n  - Bounds: $T_{\\min} = 273.15\\,\\mathrm{K}$, $T_{\\max} = 335\\,\\mathrm{K}$, $V_{\\min} = 2.5\\,\\mathrm{V}$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n\n- Case B (high-current stress and extended horizon):\n  - $N = 500$, $t_{\\mathrm{h}} = 1200\\,\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$, $\\tau = 20\\,\\mathrm{s}$, $\\alpha = 1$.\n  - Current $I \\sim \\mathrm{Uniform}(6, 12)$ (amperes).\n  - Resistance $R \\sim \\mathrm{Normal}(\\mu_R = 0.06, \\sigma_R = 0.012)$ (ohms), truncated below at $R_{\\min} = 0.015$.\n  - Capacity $Q_{\\mathrm{nom}} \\sim \\mathrm{Normal}(\\mu_Q = 10500, \\sigma_Q = 350)$ (coulombs), truncated below at $Q_{\\min} = 8000$.\n  - Thermal: $hA \\sim \\mathrm{Normal}(\\mu_{hA} = 4.0, \\sigma_{hA} = 0.7)$ (watts per kelvin), truncated below at $hA_{\\min} = 1.0$; $C_{\\mathrm{th}} \\sim \\mathrm{Normal}(\\mu_C = 450, \\sigma_C = 60)$ (joules per kelvin), truncated below at $C_{\\min} = 300$.\n  - Initial: $s(0) \\sim \\mathrm{Uniform}(0.3, 0.8)$; $T(0) \\sim \\mathrm{Normal}(\\mu_{T0} = 300, \\sigma_{T0} = 2.5)$ (kelvins), truncated below at $T_{\\mathrm{abs},\\min} = 273.15$.\n  - Ambient: $T_{\\mathrm{amb}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{amb}} = 300, \\sigma_{\\mathrm{amb}} = 3)$ (kelvins).\n  - Bounds: $T_{\\min} = 273.15\\,\\mathrm{K}$, $T_{\\max} = 335\\,\\mathrm{K}$, $V_{\\min} = 2.5\\,\\mathrm{V}$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n\n- Case C (low-current, conservative thermal management):\n  - $N = 400$, $t_{\\mathrm{h}} = 900\\,\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$, $\\tau = 20\\,\\mathrm{s}$, $\\alpha = 1$.\n  - Current $I \\sim \\mathrm{Uniform}(0, 0.5)$ (amperes).\n  - Resistance $R \\sim \\mathrm{Normal}(\\mu_R = 0.045, \\sigma_R = 0.008)$ (ohms), truncated below at $R_{\\min} = 0.01$.\n  - Capacity $Q_{\\mathrm{nom}} \\sim \\mathrm{Normal}(\\mu_Q = 11200, \\sigma_Q = 250)$ (coulombs), truncated below at $Q_{\\min} = 9000$.\n  - Thermal: $hA \\sim \\mathrm{Normal}(\\mu_{hA} = 6.0, \\sigma_{hA} = 0.9)$ (watts per kelvin), truncated below at $hA_{\\min} = 1.0$; $C_{\\mathrm{th}} \\sim \\mathrm{Normal}(\\mu_C = 520, \\sigma_C = 40)$ (joules per kelvin), truncated below at $C_{\\min} = 350$.\n  - Initial: $s(0) \\sim \\mathrm{Uniform}(0.4, 0.95)$; $T(0) \\sim \\mathrm{Normal}(\\mu_{T0} = 297, \\sigma_{T0} = 1.5)$ (kelvins), truncated below at $T_{\\mathrm{abs},\\min} = 273.15$.\n  - Ambient: $T_{\\mathrm{amb}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{amb}} = 297, \\sigma_{\\mathrm{amb}} = 1.5)$ (kelvins).\n  - Bounds: $T_{\\min} = 273.15\\,\\mathrm{K}$, $T_{\\max} = 335\\,\\mathrm{K}$, $V_{\\min} = 2.5\\,\\mathrm{V}$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n\n- Case D (boundary SOC near depletion with moderate current):\n  - $N = 300$, $t_{\\mathrm{h}} = 1800\\,\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$, $\\tau = 20\\,\\mathrm{s}$, $\\alpha = 1$.\n  - Current $I \\sim \\mathrm{Uniform}(2, 4)$ (amperes).\n  - Resistance $R \\sim \\mathrm{Normal}(\\mu_R = 0.05, \\sigma_R = 0.01)$ (ohms), truncated below at $R_{\\min} = 0.01$.\n  - Capacity $Q_{\\mathrm{nom}} \\sim \\mathrm{Normal}(\\mu_Q = 10800, \\sigma_Q = 300)$ (coulombs), truncated below at $Q_{\\min} = 9000$.\n  - Thermal: $hA \\sim \\mathrm{Normal}(\\mu_{hA} = 5.0, \\sigma_{hA} = 0.8)$ (watts per kelvin), truncated below at $hA_{\\min} = 1.0$; $C_{\\mathrm{th}} \\sim \\mathrm{Normal}(\\mu_C = 500, \\sigma_C = 50)$ (joules per kelvin), truncated below at $C_{\\min} = 300$.\n  - Initial: $s(0) \\sim \\mathrm{Uniform}(0.05, 0.15)$; $T(0) \\sim \\mathrm{Normal}(\\mu_{T0} = 298, \\sigma_{T0} = 2)$ (kelvins), truncated below at $T_{\\mathrm{abs},\\min} = 273.15$.\n  - Ambient: $T_{\\mathrm{amb}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{amb}} = 298, \\sigma_{\\mathrm{amb}} = 2)$ (kelvins).\n  - Bounds: $T_{\\min} = 273.15\\,\\mathrm{K}$, $T_{\\max} = 335\\,\\mathrm{K}$, $V_{\\min} = 2.5\\,\\mathrm{V}$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n\nNumerical requirements:\n- Express all computed rejection frequencies as decimals in $[0,1]$.\n- The final program output must be a single line containing a comma-separated list of the four rejection frequencies enclosed in square brackets, for example, $[0.12,0.34,0.00,0.67]$, with no additional text.\n\nAngle units do not appear in this problem. Ensure all temperature values are in kelvins, currents in amperes, resistances in ohms, capacities in coulombs, energy-related parameters in joules per kelvin or watts per kelvin as specified, time in seconds, and voltage in volts.",
            "solution": "The problem requires the implementation of a virtual prototyping workflow for a lithium-ion battery cell model to quantify the frequency of constraint violations under parametric uncertainty. This task is accomplished through a Monte Carlo simulation. For each of four specified test cases, a large number of simulations ($N$) are performed. In each simulation run, the model's parameters are sampled from specified probability distributions. The system's state is then evolved over time using numerical integration. The trajectory of each state variable is checked against predefined physical and operational constraints. A run is deemed \"rejected\" if any constraint is violated at any point in time. The final output for each case is the rejection frequency, calculated as the ratio of rejected runs to the total number of runs, $N$.\n\nThe model consists of a system of three coupled ordinary differential equations (ODEs) describing the evolution of the State of Charge $s(t)$, temperature $T(t)$, and a polarization voltage $v_{\\mathrm{rc}}(t)$.\n\nThe governing equations are:\n1.  **State of Charge dynamics (Charge Conservation):**\n    $$\n    \\frac{ds}{dt} = -\\frac{I}{Q_{\\mathrm{nom}}}\n    $$\n    where $I$ is the discharge current and $Q_{\\mathrm{nom}}$ is the nominal capacity.\n\n2.  **Temperature dynamics (Energy Balance):**\n    $$\n    C_{\\mathrm{th}} \\frac{dT}{dt} = I^2 R - hA \\left(T - T_{\\mathrm{amb}}\\right)\n    $$\n    where $C_{\\mathrm{th}}$ is the thermal capacity, $R$ is the internal resistance, $hA$ is the heat transfer coefficient-area product, and $T_{\\mathrm{amb}}$ is the ambient temperature. The term $I^2 R$ represents Joule heating.\n\n3.  **Polarization dynamics (RC Circuit):**\n    $$\n    \\frac{dv_{\\mathrm{rc}}}{dt} = -\\frac{1}{\\tau} v_{\\mathrm{rc}} + \\frac{\\alpha}{\\tau} I\n    $$\n    where $\\tau$ is the time constant and $\\alpha$ is a coupling coefficient for the single-element Resistive-Capacitive (RC) pair.\n\nThe terminal voltage $V(t)$ is an algebraic function of the states:\n$$\nV(t) = V_{\\mathrm{oc}}(s(t)) - I R - v_{\\mathrm{rc}}(t)\n$$\nwith the Open Circuit Voltage (OCV) given by:\n$$\nV_{\\mathrm{oc}}(s) = 3.0 + 1.2\\,s - 0.1\\,e^{-10 s}\n$$\n\nThe solution methodology involves these key steps:\n\n**1. Numerical Integration:**\nThe system of ODEs is solved numerically using the explicit Euler method with a fixed time step $\\Delta t$. For a state vector $\\mathbf{x}_k = [s_k, T_k, v_{\\mathrm{rc},k}]^T$ at time $t_k = k \\Delta t$, the state at the next time step $t_{k+1}$ is computed as:\n$$\ns_{k+1} = s_k - \\frac{I}{Q_{\\mathrm{nom}}} \\Delta t\n$$\n$$\nT_{k+1} = T_k + \\frac{\\Delta t}{C_{\\mathrm{th}}} \\left(I^2 R - hA (T_k - T_{\\mathrm{amb}})\\right)\n$$\n$$\nv_{\\mathrm{rc},k+1} = v_{\\mathrm{rc},k} \\left(1 - \\frac{\\Delta t}{\\tau}\\right) + I \\frac{\\alpha \\Delta t}{\\tau}\n$$\n\n**2. Uncertainty Propagation:**\nFor each of the $N$ runs in a given test case, the uncertain parameters ($I, R, Q_{\\mathrm{nom}}, C_{\\mathrm{th}}, hA$) and initial conditions ($s(0), T(0)$) are sampled from their respective specified distributions (Uniform or Normal, possibly truncated). A single pseudo-random number generator is initialized with a fixed seed of $42$ to ensure reproducibility of the entire sequence of random samples.\n-   For Uniform distributions $\\mathrm{Uniform}(a, b)$, samples are drawn using standard library functions.\n-   For Normal distributions $\\mathrm{Normal}(\\mu, \\sigma)$, samples are drawn similarly.\n-   For truncated Normal distributions, with a mean $\\mu$, standard deviation $\\sigma$, and a lower bound $x_{\\min}$, we use specialized functions, such as `scipy.stats.truncnorm`. The standardized lower bound for sampling is calculated as $a = (x_{\\min} - \\mu) / \\sigma$, with the upper bound $b = \\infty$.\n\n**3. Constraint Validation:**\nIn each run, at every time step $t_k$ from $t_0 = 0$ to the simulation horizon $t_{\\mathrm{h}}$, the state variables and the computed terminal voltage are checked against the following constraints:\n-   $s(t_k) \\in [0, 1]$\n-   $T(t_k) \\in [T_{\\min}, T_{\\max}]$\n-   $V(t_k) \\in [V_{\\min}, V_{\\max}]$\n\nIf any of these conditions are violated at any $t_k$, the simulation for that run is immediately terminated, and the run is counted as \"rejected\".\n\n**4. Rejection Frequency Quantification:**\nAfter completing all $N$ runs for a test case, the rejection frequency $f_{\\mathrm{reject}}$ is computed as:\n$$\nf_{\\mathrm{reject}} = \\frac{\\text{Number of rejected runs}}{N}\n$$\nThis process is repeated for all four test cases, and the resulting frequencies are collected.\n\n**Implementation Summary:**\nThe algorithm is implemented in Python using the `numpy` library for numerical operations and `scipy.stats.truncnorm` for sampling from truncated normal distributions. A main function orchestrates the simulations for the four test cases. A helper function is used to handle the sampling of truncated normal variables cleanly. The main simulation logic iterates through each of the $N$ runs. Within each run, another loop iterates through the time steps, updating the state and performing constraint checks.\nThe initial conditions for each run are $s(0)$ and $T(0)$ sampled from their distributions, and $v_{\\mathrm{rc}}(0) = 0$. The check for constraint violation is performed starting at $t=0$ to ensure the initial state itself is valid.",
            "answer": "[0.258,0.992,0.000,0.797]"
        }
    ]
}