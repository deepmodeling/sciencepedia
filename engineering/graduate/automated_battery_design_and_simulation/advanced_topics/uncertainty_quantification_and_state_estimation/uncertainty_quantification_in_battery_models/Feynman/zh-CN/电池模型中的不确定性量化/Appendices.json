{
    "hands_on_practices": [
        {
            "introduction": "在电池制造过程中，材料特性的微小变化是不可避免的。了解这些微小的不确定性如何传播并影响电池的电气性能（例如电压）是实现稳健设计的关键第一步。本练习将介绍“delta方法”，这是一种强大而高效的技术，用于近似模型输出的方差。通过利用局部敏感度信息——即输出如何随输入的微小变化而变化——我们可以在不进行大量仿真的情况下，估算整体性能的变异性。",
            "id": "3959245",
            "problem": "在固定电流密度下运行的锂离子电池由一个简化的物理模型描述，其中电池电压 $V$ 取决于固相锂扩散系数 $D_s$ 和表面反应速率常数 $k$。在不确定性量化 (UQ) 中，将 $D_s$ 和 $k$ 视为由制造变异性产生的随机输入，并建模为独立的标准随机变量 $D_s \\sim \\mathcal{N}(\\mu_{D_s},\\sigma_{D_s}^{2})$ 和 $k \\sim \\mathcal{N}(\\mu_{k},\\sigma_{k}^{2})$。通过高保真模拟，在 $(\\mu_{D_s},\\mu_{k})$ 处计算了电压对这些参数的工作点灵敏度，这些灵敏度是通过对基于菲克扩散和 Butler-Volmer (BV) 动力学的简化模型进行小信号线性化得到的。其值为\n$$\\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s},\\mu_{k})} = -3.0 \\times 10^{5}\\ \\mathrm{V\\,s/m^{2}}, \\quad \\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s},\\mu_{k})} = -3.0 \\times 10^{3}\\ \\mathrm{V\\,s/m}.$$\n假设以下参数统计数据，与在中等电流下运行的先进电极材料一致：\n$$\\mu_{D_s} = 1.0 \\times 10^{-14}\\ \\mathrm{m^{2}/s}, \\quad \\sigma_{D_s} = 2.0 \\times 10^{-15}\\ \\mathrm{m^{2}/s},$$\n$$\\mu_{k} = 1.0 \\times 10^{-10}\\ \\mathrm{m/s}, \\quad \\sigma_{k} = 2.0 \\times 10^{-11}\\ \\mathrm{m/s},$$\n并且 $D_s$ 和 $k$ 是独立的。使用 $V(D_s,k)$ 在 $(\\mu_{D_s},\\mu_k)$ 附近的一阶泰勒展开和独立性下的方差定律，推导并计算电压方差 $\\mathrm{Var}[V]$ 的一阶 delta 方法近似值。以 $\\mathrm{V^{2}}$ 为单位表示最终方差，并将您的答案四舍五入到 $4$ 位有效数字。最终答案必须是一个实数。",
            "solution": "用户想要解决以下问题：\n在固定电流密度下运行的锂离子电池由一个简化的物理模型描述，其中电池电压 $V$ 取决于固相锂扩散系数 $D_s$ 和表面反应速率常数 $k$。在不确定性量化 (UQ) 中，将 $D_s$ 和 $k$ 视为由制造变异性产生的随机输入，并建模为独立的标准随机变量 $D_s \\sim \\mathcal{N}(\\mu_{D_s},\\sigma_{D_s}^{2})$ 和 $k \\sim \\mathcal{N}(\\mu_{k},\\sigma_{k}^{2})$。通过高保真模拟，在 $(\\mu_{D_s},\\mu_{k})$ 处计算了电压对这些参数的工作点灵敏度，这些灵敏度是通过对基于菲克扩散和 Butler-Volmer (BV) 动力学的简化模型进行小信号线性化得到的。其值为\n$$\\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s},\\mu_{k})} = -3.0 \\times 10^{5}\\ \\mathrm{V\\,s/m^{2}}, \\quad \\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s},\\mu_{k})} = -3.0 \\times 10^{3}\\ \\mathrm{V\\,s/m}.$$\n假设以下参数统计数据，与在中等电流下运行的先进电极材料一致：\n$$\\mu_{D_s} = 1.0 \\times 10^{-14}\\ \\mathrm{m^{2}/s}, \\quad \\sigma_{D_s} = 2.0 \\times 10^{-15}\\ \\mathrm{m^{2}/s},$$\n$$\\mu_{k} = 1.0 \\times 10^{-10}\\ \\mathrm{m/s}, \\quad \\sigma_{k} = 2.0 \\times 10^{-11}\\ \\mathrm{m/s},$$\n并且 $D_s$ 和 $k$ 是独立的。使用 $V(D_s,k)$ 在 $(\\mu_{D_s},\\mu_k)$ 附近的一阶泰勒展开和独立性下的方差定律，推导并计算电压方差 $\\mathrm{Var}[V]$ 的一阶 delta 方法近似值。以 $\\mathrm{V^{2}}$ 为单位表示最终方差，并将您的答案四舍五入到 $4$ 位有效数字。最终答案必须是一个实数。\n\n首先验证问题，以确保其具有科学依据、问题设定良好，并且所有必要的数据都已提供且一致。该问题描述了在电池建模背景下使用 delta 方法进行不确定性传播的标准应用。物理参数 ($D_s$, $k$)、它们的统计数据 ($\\mu$, $\\sigma$) 以及它们的灵敏度都给出了具有一致物理单位的值。在此类分析中，对于正的物理量假设为正态分布是一种常见且可接受的近似，特别是当均值距离零有几个标准差时（此处，对于两个参数均为 $\\mu = 5\\sigma$）。该问题是自洽的、明确的，并且在科学上是合理的。因此，该问题被认为是有效的，并将提供解决方案。\n\n目标是使用一阶近似计算电池电压的方差 $\\mathrm{Var}[V]$。电池电压 $V$ 是两个独立随机变量的函数，即固相扩散系数 $D_s$ 和表面反应速率常数 $k$。这个任务是使用 delta 方法完成的，该方法通过在变量均值附近对函数进行泰勒级数展开来近似随机变量函数的方差。\n\n设电压由函数 $V(D_s, k)$ 表示。$V(D_s, k)$ 在参数均值 $(\\mu_{D_s}, \\mu_k)$ 附近的一阶泰勒展开由下式给出：\n$$V(D_s, k) \\approx V(\\mu_{D_s}, \\mu_k) + \\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)} (D_s - \\mu_{D_s}) + \\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)} (k - \\mu_k)$$\n为求 $V$ 的方差，我们取此近似表达式的方差：\n$$\\mathrm{Var}[V] \\approx \\mathrm{Var}\\left[V(\\mu_{D_s}, \\mu_k) + \\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)} (D_s - \\mu_{D_s}) + \\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)} (k - \\mu_k)\\right]$$\n我们使用随机变量 $X$ 和 $Y$ 与常数 $a, b, c$ 的线性组合的方差的一般性质：$\\mathrm{Var}[aX + bY + c] = a^2 \\mathrm{Var}[X] + b^2 \\mathrm{Var}[Y] + 2ab \\mathrm{Cov}[X, Y]$。\n在我们的表达式中，项 $V(\\mu_{D_s}, \\mu_k)$ 是一个常数，而灵敏度 $\\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)}$ 和 $\\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)}$ 也是在均值处计算的常数。项 $- \\mu_{D_s}$ 和 $- \\mu_k$ 是常数平移。由于方差对常数平移不变，表达式得以简化。\n问题陈述 $D_s$ 和 $k$ 是独立的随机变量。独立性的一个推论是它们的协方差为零，即 $\\mathrm{Cov}[D_s, k] = 0$。应用这些性质，电压的方差近似为：\n$$\\mathrm{Var}[V] \\approx \\left(\\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)}\\right)^2 \\mathrm{Var}[D_s] + \\left(\\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)}\\right)^2 \\mathrm{Var}[k]$$\n输入参数的方差是其标准差的平方：$\\mathrm{Var}[D_s] = \\sigma_{D_s}^2$ 和 $\\mathrm{Var}[k] = \\sigma_k^2$。将这些代入方程，得到电压方差一阶近似的最终公式：\n$$\\mathrm{Var}[V] \\approx \\left(\\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)}\\right)^2 \\sigma_{D_s}^2 + \\left(\\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)}\\right)^2 \\sigma_k^2$$\n现在，我们将给定的数值代入此公式。\n给定的灵敏度为：\n$$S_{D_s} = \\left.\\frac{\\partial V}{\\partial D_s}\\right|_{(\\mu_{D_s}, \\mu_k)} = -3.0 \\times 10^{5}\\ \\mathrm{V\\,s/m^{2}}$$\n$$S_k = \\left.\\frac{\\partial V}{\\partial k}\\right|_{(\\mu_{D_s}, \\mu_k)} = -3.0 \\times 10^{3}\\ \\mathrm{V\\,s/m}$$\n给定的标准差为：\n$$\\sigma_{D_s} = 2.0 \\times 10^{-15}\\ \\mathrm{m^{2}/s}$$\n$$\\sigma_k = 2.0 \\times 10^{-11}\\ \\mathrm{m/s}$$\n我们分别计算方差贡献的两个项。\n来自 $D_s$ 不确定性的贡献是：\n$$\\mathrm{Var}_{D_s}[V] = (S_{D_s})^2 \\sigma_{D_s}^2 = (-3.0 \\times 10^{5})^2 (2.0 \\times 10^{-15})^2$$\n$$\\mathrm{Var}_{D_s}[V] = (9.0 \\times 10^{10}) \\times (4.0 \\times 10^{-30})$$\n$$\\mathrm{Var}_{D_s}[V] = 36.0 \\times 10^{-20} = 3.6 \\times 10^{-19}\\ \\mathrm{V^2}$$\n来自 $k$ 不确定性的贡献是：\n$$\\mathrm{Var}_k[V] = (S_k)^2 \\sigma_k^2 = (-3.0 \\times 10^{3})^2 (2.0 \\times 10^{-11})^2$$\n$$\\mathrm{Var}_k[V] = (9.0 \\times 10^{6}) \\times (4.0 \\times 10^{-22})$$\n$$\\mathrm{Var}_k[V] = 36.0 \\times 10^{-16} = 3.6 \\times 10^{-15}\\ \\mathrm{V^2}$$\n总方差是这两个贡献的总和：\n$$\\mathrm{Var}[V] \\approx \\mathrm{Var}_{D_s}[V] + \\mathrm{Var}_k[V]$$\n$$\\mathrm{Var}[V] \\approx 3.6 \\times 10^{-19}\\ \\mathrm{V^2} + 3.6 \\times 10^{-15}\\ \\mathrm{V^2}$$\n为了将这些数字相加，我们用相同的 10 的幂来表示它们：\n$$\\mathrm{Var}[V] \\approx (0.00036 \\times 10^{-15})\\ \\mathrm{V^2} + (3.6 \\times 10^{-15})\\ \\mathrm{V^2}$$\n$$\\mathrm{Var}[V] \\approx (0.00036 + 3.6) \\times 10^{-15}\\ \\mathrm{V^2}$$\n$$\\mathrm{Var}[V] \\approx 3.60036 \\times 10^{-15}\\ \\mathrm{V^2}$$\n问题要求最终答案四舍五入到 4 位有效数字。\n$$\\mathrm{Var}[V] \\approx 3.600 \\times 10^{-15}\\ \\mathrm{V^2}$$\n这就是电压方差的一阶 delta 方法近似值。",
            "answer": "$$\n\\boxed{3.600 \\times 10^{-15}}\n$$"
        },
        {
            "introduction": "一旦我们知道电池的性能存在变异性，就需要确定这种变异的主要来源，以指导设计改进和质量控制。全局敏感度分析（Global Sensitivity Analysis, GSA）为此提供了一个严谨的框架，它超越了局部方法的局限性。本实践将深入探讨Sobol'指数估计器的推导，这是GSA的基石，它量化了每个不确定参数在其整个不确定性范围内对输出方差的贡献。您将使用Saltelli抽样方案，这是一种通过蒙特卡洛模拟计算这些指数的巧妙而高效的方法。",
            "id": "3959226",
            "problem": "考虑一个用于自动化电池设计的基于物理的锂离子电池模型，其中预测的关注量是在恒流放电下，于指定时间的端电压，该电压表示为一个从不确定的、与设计相关的输入向量 $\\boldsymbol{x} = (x_{1}, \\dots, x_{d})$ 到一个实数的确定性映射 $f(\\boldsymbol{x})$。假设输入 $(x_{1}, \\dots, x_{d})$ 是具有已知边际概率律的独立随机变量。此类输入的示例包括固相扩散系数 $D_{s}$、反应速率常数 $k_{0}$、接触电阻 $R_{c}$ 以及开路电压曲线的参数，但此问题中无需指定模型 $f$ 的显式形式。设 $X = (X_{1}, \\dots, X_{d})$ 是一个与 $\\boldsymbol{x}$ 具有相同分布的随机向量，并设 $\\mu = \\mathbb{E}[f(X)]$ 和 $\\sigma^{2} = \\mathbb{V}[f(X)]$。\n\n对于输入 $X_{i}$ 的一阶 Sobol’ 敏感度指数 $S_{i}$ 根据全方差公式定义为\n$$\nS_{i} = \\frac{\\mathbb{V}\\!\\left(\\mathbb{E}\\!\\left[f(X)\\mid X_{i}\\right]\\right)}{\\mathbb{V}\\!\\left(f(X)\\right)}.\n$$\n\n仅使用输入的独立性、全期望和全方差公式以及独立同分布（IID）样本期望的蒙特卡洛（MC）估计原理，基于 Saltelli 的采样方案推导出一阶 Sobol’ 指数 $S_{i}$ 的蒙特卡洛估计量。该方案描述如下：抽取两个 IID 样本矩阵\n$$\n\\mathbf{A} = \\begin{pmatrix}\n\\mathbf{a}^{(1)}\\\\\n\\vdots\\\\\n\\mathbf{a}^{(N)}\n\\end{pmatrix}\n\\in \\mathbb{R}^{N\\times d}\n\\quad \\text{and} \\quad\n\\mathbf{B} = \\begin{pmatrix}\n\\mathbf{b}^{(1)}\\\\\n\\vdots\\\\\n\\mathbf{b}^{(N)}\n\\end{pmatrix}\n\\in \\mathbb{R}^{N\\times d},\n$$\n其中每一行 $\\mathbf{a}^{(k)}$ 和 $\\mathbf{b}^{(k)}$ 都是从 $X$ 的联合分布中独立同分布地抽取的。对于每个 $i \\in \\{1, \\dots, d\\}$，构建混合矩阵 $\\mathbf{A}_{B}^{(i)}$，其第 $k$ 行 $\\mathbf{a}_{b}^{(i,k)}$ 等于 $\\mathbf{a}^{(k)}$，但其第 $i$ 个分量被 $\\mathbf{b}^{(k)}$ 的第 $i$ 个分量替换。你可以使用模型在 $f(\\mathbf{a}^{(k)})$、$f(\\mathbf{b}^{(k)})$ 和 $f(\\mathbf{a}_{b}^{(i,k)})$ 上的评价值，其中 $k=1,\\dots,N$。\n\n从 $S_{i}$ 的基本定义以及独立性条件下条件期望的性质出发，说明 Saltelli 的构造如何产生一个经验估计量。以可用的模型评价值和 $N$ 的形式，提供你的最终估计量的单一闭式解析表达式。然后，讨论该估计量的有限样本偏差和方差性质，根据第一性原理，指出任何偏差的来源以及方差随 $N$ 变化的尺度关系。无需舍入。最终的估计量没有物理单位：请将其表示为无单位的解析表达式。",
            "solution": "该问题要求使用 Saltelli 采样方案推导一阶 Sobol' 敏感度指数 $S_{i}$ 的蒙特卡洛估计量，并讨论该估计量的性质。\n\n输入 $X_{i}$ 的一阶 Sobol' 指数定义为可归因于单独 $X_{i}$ 方差的模型输出 $f(X)$ 总方差的比例：\n$$\nS_{i} = \\frac{\\mathbb{V}\\!\\left(\\mathbb{E}\\!\\left[f(X)\\mid X_{i}\\right]\\right)}{\\mathbb{V}\\!\\left(f(X)\\right)}\n$$\n我们将分子记为 $V_{i} = \\mathbb{V}\\!\\left(\\mathbb{E}\\!\\left[f(X)\\mid X_{i}\\right]\\right)$，分母记为 $V = \\mathbb{V}\\!\\left(f(X)\\right)$。我们需要使用提供的样本矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$ 为 $V_{i}$ 和 $V$ 构建估计量。\n\n设 $A$ 和 $B$ 是两个独立的随机向量，代表从 $X=(X_1, \\dots, X_d)$ 的联合分布中的一次抽样。矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$ 的行，记为 $\\mathbf{a}^{(k)}$ 和 $\\mathbf{b}^{(k)}$（其中 $k=1, \\dots, N$），是 $A$ 和 $B$ 的 $N$ 个独立实现。设 $A_{\\sim i}$ 和 $B_{\\sim i}$ 表示移除了第 $i$ 个分量的向量 $A$ 和 $B$。设 $A_i$ 和 $B_i$ 是 $A$ 和 $B$ 的第 $i$ 个分量。混合向量 $\\mathbf{a}_{b}^{(i,k)}$ 是一个随机向量的实现，我们可以将其表示为 $A_{B}^{(i)}$，构造为 $(A_1, \\dots, A_{i-1}, B_i, A_{i+1}, \\dots, A_d)$。\n\n首先，我们推导分子 $V_{i}$ 的一个替代表达式。使用方差的定义 $\\mathbb{V}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$，我们有：\n$$\nV_{i} = \\mathbb{E}\\left[\\left(\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right)^2\\right] - \\left(\\mathbb{E}\\left[\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right]\\right)^2\n$$\n根据全期望公式，第二项简化为：$\\mathbb{E}\\left[\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right] = \\mathbb{E}[f(X)] = \\mu$。所以，分子是：\n$$\nV_{i} = \\mathbb{E}\\left[\\left(\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right)^2\\right] - \\mu^2\n$$\n主要的挑战是为第一项 $\\mathbb{E}\\left[\\left(\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right)^2\\right]$ 找到一个可估计的表达式。让我们分析由 Saltelli 方案构建的模型评价值乘積的期望。考虑乘积 $f(B) f(A_B^{(i)})$。期望是关于 $A$ 和 $B$ 的联合分布计算的。\n$$\n\\mathbb{E}\\left[ f(B) f(A_B^{(i)}) \\right] = \\mathbb{E}\\left[ f(B_i, B_{\\sim i}) f(A_{\\sim i}, B_i) \\right]\n$$\n我们可以通过以 $B_i$ 为条件来计算这个期望。由于 $A$ 和 $B$ 是独立的， $A_{\\sim i}$ 和 $B_{\\sim i}$ 也是独立的。\n$$\n\\mathbb{E}\\left[ f(B) f(A_B^{(i)}) \\right] = \\mathbb{E}_{B_i}\\left[ \\mathbb{E}_{A_{\\sim i}, B_{\\sim i}}\\left[ f(B_i, B_{\\sim i}) f(A_{\\sim i}, B_i) \\mid B_i \\right] \\right]\n$$\n由于 $A_{\\sim i}$ 和 $B_{\\sim i}$ 之间的独立性，内部期望可以分离为期望的乘积：\n$$\n\\mathbb{E}_{B_i}\\left[ \\mathbb{E}_{B_{\\sim i}}\\left[ f(B_i, B_{\\sim i}) \\mid B_i \\right] \\cdot \\mathbb{E}_{A_{\\sim i}}\\left[ f(A_{\\sim i}, B_i) \\mid B_i \\right] \\right]\n$$\n这两个内部期望是条件变量的相同函数，条件变量是 $B_i$。它们都对应于 $\\mathbb{E}_{X_{\\sim i}}[f(X_i, X_{\\sim i}) \\mid X_i = B_i]$，这正是 $\\mathbb{E}[f(X) \\mid X_i = B_i]$。因此，该表达式变为：\n$$\n\\mathbb{E}_{B_i}\\left[ \\left(\\mathbb{E}\\left[f(X)\\mid X_i=B_i\\right]\\right)^2 \\right]\n$$\n由于 $B_i$ 和 $X_i$ 具有相同的分布，这正是 $\\mathbb{E}\\left[\\left(\\mathbb{E}\\left[f(X)\\mid X_{i}\\right]\\right)^2\\right]$。\n\n我们已经发现 $\\mathbb{E}\\left[f(B) f(A_B^{(i)})\\right] = \\mathbb{E}\\left[\\left(\\mathbb{E}\\left[f(X)\\mid X_i\\right]\\right)^2\\right]$。现在考虑另一个乘积的期望 $f(B) f(A)$。由于 $A$ 和 $B$ 的独立性，$\\mathbb{E}[f(B)f(A)] = \\mathbb{E}[f(B)] \\mathbb{E}[f(A)] = \\mu \\cdot \\mu = \\mu^2$。\n结合这些结果，我们可以将分子 $V_i$ 表示为：\n$$\nV_{i} = \\mathbb{E}\\left[f(B) f(A_B^{(i)})\\right] - \\mathbb{E}[f(B)f(A)] = \\mathbb{E}\\left[ f(B) \\left( f(A_B^{(i)}) - f(A) \\right) \\right]\n$$\n这种形式将理论量 $V_i$ 与 Saltelli 方案生成的随机变量直接联系起来。根据蒙特卡洛估计原理，我们可以通过对 $N$ 个可用样本进行平均，为 $V_i$ 构建一个无偏估计量：\n$$\n\\widehat{V}_i = \\frac{1}{N} \\sum_{k=1}^{N} f(\\mathbf{b}^{(k)}) \\left( f(\\mathbf{a}_{b}^{(i,k)}) - f(\\mathbf{a}^{(k)}) \\right)\n$$\n\n接下来，我们需要一个总方差 $V = \\mathbb{V}(f(X)) = \\mathbb{E}[f(X)^2] - \\mu^2$ 的估计量。我们可以使用模型评价值集合 $f(\\mathbf{a}^{(k)})$（其中 $k=1, \\dots, N$）来估计 $V$。标准样本方差是一种选择，但为了比率估计量的一致性，通常使用有偏样本方差（除以 $N$）：\n$$\n\\widehat{V} = \\frac{1}{N} \\sum_{k=1}^{N} \\left(f(\\mathbf{a}^{(k)})\\right)^2 - \\left( \\frac{1}{N} \\sum_{k=1}^{N} f(\\mathbf{a}^{(k)}) \\right)^2\n$$\n这个 $V$ 的估计量仅使用样本矩阵 $\\mathbf{A}$ 上的模型评价值计算。\n\n最后，Sobol' 指数 $\\hat{S}_i$ 的蒙特卡洛估计量是分子估计量与分母估计量的比值：\n$$\n\\hat{S}_i = \\frac{\\widehat{V}_i}{\\widehat{V}} = \\frac{\\frac{1}{N} \\sum_{k=1}^{N} f(\\mathbf{b}^{(k)}) \\left( f(\\mathbf{a}_{b}^{(i,k)}) - f(\\mathbf{a}^{(k)}) \\right)}{\\frac{1}{N} \\sum_{k=1}^{N} \\left(f(\\mathbf{a}^{(k)})\\right)^2 - \\left( \\frac{1}{N} \\sum_{k=1}^{N} f(\\mathbf{a}^{(k)}) \\right)^2}\n$$\n分子中的因子 $1/N$ 可以与分母表达式中开头的 $1/N$ 相消：\n$$\n\\hat{S}_i = \\frac{ \\sum_{k=1}^{N} f(\\mathbf{b}^{(k)}) \\left( f(\\mathbf{a}_{b}^{(i,k)}) - f(\\mathbf{a}^{(k)}) \\right) }{ \\sum_{k=1}^{N} \\left(f(\\mathbf{a}^{(k)})\\right)^2 - \\frac{1}{N}\\left(\\sum_{k=1}^{N} f(\\mathbf{a}^{(k)})\\right)^2 }\n$$\n这就是所要求的估计量的闭式解析表达式。\n\n现在，我们讨论这个估计量的统计性质。\n\n**有限样本偏差：** 对于有限的样本量 $N$，估计量 $\\hat{S}_i$ 是有偏的。这种偏差有两个主要来源。\n1.  **比率估计量偏差：** $\\hat{S}_i$ 是两个随机变量 $\\widehat{V}_i$ 和 $\\widehat{V}$ 的比值。通常，对于两个随机变量 $Y$ 和 $Z$，$\\mathbb{E}[Y/Z] \\neq \\mathbb{E}[Y]/\\mathbb{E}[Z]$。尽管分子估计量 $\\widehat{V}_i$ 对于 $V_i$ 是无偏的（因为 $\\mathbb{E}[\\widehat{V}_i] = V_i$），但比率的期望不等于期望的比率。这类偏差是比率估计量所固有的，通常为 $O(1/N)$ 阶。\n2.  **分母偏差：** 为总方差选择的估计量 $\\widehat{V}$ 是有偏样本方差。其期望为 $\\mathbb{E}[\\widehat{V}] = \\frac{N-1}{N} \\mathbb{V}(f(X)) = (1-\\frac{1}{N})V$。这种偏差也导致了 $\\hat{S}_i$ 的总体偏差，并且是 $O(1/N)$ 阶的。\n因为两种来源的偏差都随着 $N$ 的增加而减小，所以该估计量是渐近无偏的，即 $\\lim_{N \\to \\infty} \\mathbb{E}[\\hat{S}_i] = S_i$。\n\n**方差：** 估计量 $\\hat{S}_i$ 是一个基于 $N$ 个独立同分布项之和（在分子和分母中）的蒙特卡洛估计量。根据中心极限定理，这类估计量的方差随着样本量 $N$ 的增加而减小。具体来说，$\\hat{S}_i$ 的方差与 $N$ 成反比：\n$$\n\\mathbb{V}(\\hat{S}_i) \\propto \\frac{1}{N}\n$$\n方差的这种 $O(1/N)$ 收敛速度是蒙特卡洛方法的标准特征。这意味着为了将估计的标准误差减少2倍，样本数量 $N$（以及模型评估总次数，即 $N(d+2)$）必须增加4倍。确切的比例常数取决于分子和分母中所涉及项的方差和协方差。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{k=1}^{N} f(\\mathbf{b}^{(k)}) \\left( f(\\mathbf{a}_{b}^{(i,k)}) - f(\\mathbf{a}^{(k)}) \\right)}{\\sum_{k=1}^{N} \\left(f(\\mathbf{a}^{(k)})\\right)^{2} - \\frac{1}{N}\\left(\\sum_{k=1}^{N} f(\\mathbf{a}^{(k)})\\right)^{2}}}\n$$"
        },
        {
            "introduction": "为了构建精确的电池模型，我们必须根据实验数据对其进行校准，而实验数据总是会受到测量噪声的影响。现实世界中的传感器误差通常并非独立，而是在时间上相关，例如由于热漂移。本练习演示了如何通过自回归（AR）过程来表示测量误差，从而为这类场景构建一个统计上合理的模型。推导出正确的似然函数是使用贝叶斯推断或最大似然估计等方法从时间序列数据中准确估计模型参数的决定性步骤。",
            "id": "3959210",
            "problem": "在一个自动化电池设计和仿真流程中，一个锂离子电池由已知的电流曲线驱动，该曲线表示为序列 $\\{u_t\\}_{t=1}^T$。一个机理电压模型在离散时间 $t = 1, 2, \\dots, T$ 产生预测的端电压 $\\hat{v}_t = h(\\boldsymbol{\\theta}, u_t)$，其中 $\\boldsymbol{\\theta}$ 是一个设计参数向量。测量的端电压被建模为 $y_t = \\hat{v}_t + \\epsilon_t$，其中测量误差 $\\epsilon_t$ 捕捉了相关的传感器漂移。为了执行不确定性量化 (UQ)，假设误差过程是1阶自回归 (AR(1)) 的，即对于 $t \\geq 2$，有 $\\epsilon_t = \\phi \\epsilon_{t-1} + \\eta_t$，其中 $\\eta_t \\sim \\mathcal{N}(0, \\sigma_\\eta^2)$ 是独立同分布的，并且 $|\\phi|  1$。假设该过程是平稳的，因此 $\\epsilon_1 \\sim \\mathcal{N}\\!\\left(0, \\frac{\\sigma_\\eta^2}{1 - \\phi^2}\\right)$，并且 $\\{\\eta_t\\}_{t=2}^T$ 相互独立，且独立于 $\\epsilon_1$ 和 $\\boldsymbol{\\theta}$。定义残差 $r_t = y_t - \\hat{v}_t = y_t - h(\\boldsymbol{\\theta}, u_t)$，其中 $t = 1, \\dots, T$。从基本概率法则和高斯随机变量的性质出发，推导闭式似然函数 $p(y_{1:T} \\mid \\boldsymbol{\\theta}, \\phi, \\sigma_\\eta)$，使其成为 $\\{r_t\\}_{t=1}^T$、$\\phi$ 和 $\\sigma_\\eta$ 的函数。请提供似然函数 $p(y_{1:T} \\mid \\boldsymbol{\\theta}, \\phi, \\sigma_\\eta)$ 的单一解析表达式作为最终答案，该表达式用 $r_t$、$\\phi$、$\\sigma_\\eta$ 和 $T$ 表示。您可以将 $\\{u_t\\}_{t=1}^T$ 视为已知和固定的。最终答案必须是一个解析表达式，而不是不等式或隐式方程。",
            "solution": "我们从测量模型 $y_t = \\hat{v}_t + \\epsilon_t$ 开始，并定义残差 $r_t = y_t - \\hat{v}_t = \\epsilon_t$。残差序列 $\\{r_t\\}$ 继承了1阶自回归 (AR(1)) 的动态特性：\n$$\nr_t = \\phi r_{t-1} + \\eta_t \\quad \\text{for} \\quad t \\geq 2,\n$$\n其中 $\\eta_t \\sim \\mathcal{N}(0, \\sigma_\\eta^2)$ 是独立同分布的，并且具有平稳的初始分布 $r_1 \\sim \\mathcal{N}\\!\\left(0, \\frac{\\sigma_\\eta^2}{1 - \\phi^2}\\right)$。条件 $|\\phi|  1$ 确保了平稳性。\n\n似然函数 $p(y_{1:T} \\mid \\boldsymbol{\\theta}, \\phi, \\sigma_\\eta)$ 与联合密度 $p(r_{1:T} \\mid \\phi, \\sigma_\\eta)$ 相同，因为在给定 $\\boldsymbol{\\theta}$ 和 $\\{u_t\\}_{t=1}^T$ 的情况下，$\\hat{v}_t = h(\\boldsymbol{\\theta}, u_t)$ 是确定性的。使用概率的链式法则，\n$$\np(r_{1:T} \\mid \\phi, \\sigma_\\eta) = p(r_1 \\mid \\phi, \\sigma_\\eta)\\prod_{t=2}^T p(r_t \\mid r_{t-1}, \\phi, \\sigma_\\eta).\n$$\n根据 AR(1) 模型和高斯性质，\n- 初始项为\n$$\np(r_1 \\mid \\phi, \\sigma_\\eta) = \\frac{1}{\\sqrt{2\\pi \\, \\sigma_1^2}} \\exp\\!\\left(-\\frac{r_1^2}{2\\sigma_1^2}\\right), \\quad \\text{with} \\quad \\sigma_1^2 = \\frac{\\sigma_\\eta^2}{1 - \\phi^2}.\n$$\n- 条件项为\n$$\np(r_t \\mid r_{t-1}, \\phi, \\sigma_\\eta) = \\frac{1}{\\sqrt{2\\pi \\, \\sigma_\\eta^2}} \\exp\\!\\left(-\\frac{(r_t - \\phi r_{t-1})^2}{2\\sigma_\\eta^2}\\right), \\quad t = 2, \\dots, T.\n$$\n\n将这些密度相乘，\n$$\np(r_{1:T} \\mid \\phi, \\sigma_\\eta)\n= \\left[\\frac{1}{\\sqrt{2\\pi \\, \\sigma_1^2}}\\right] \\prod_{t=2}^T \\left[\\frac{1}{\\sqrt{2\\pi \\, \\sigma_\\eta^2}}\\right]\n\\exp\\!\\left(-\\frac{r_1^2}{2\\sigma_1^2} - \\sum_{t=2}^T \\frac{(r_t - \\phi r_{t-1})^2}{2\\sigma_\\eta^2}\\right).\n$$\n代入 $\\sigma_1^2 = \\frac{\\sigma_\\eta^2}{1 - \\phi^2}$ 以获得归一化常数：\n$$\n\\frac{1}{\\sqrt{2\\pi \\, \\sigma_1^2}} \\prod_{t=2}^T \\frac{1}{\\sqrt{2\\pi \\, \\sigma_\\eta^2}}\n= (2\\pi)^{-T/2} \\left(\\frac{1 - \\phi^2}{\\sigma_\\eta^2}\\right)^{1/2} \\left(\\sigma_\\eta^2\\right)^{-(T-1)/2}\n= (2\\pi)^{-T/2} (1 - \\phi^2)^{1/2} \\, \\sigma_\\eta^{-T}.\n$$\n指数部分简化为\n$$\n-\\frac{r_1^2}{2\\sigma_1^2} - \\sum_{t=2}^T \\frac{(r_t - \\phi r_{t-1})^2}{2\\sigma_\\eta^2}\n= -\\frac{1}{2\\sigma_\\eta^2}\\left[(1 - \\phi^2) r_1^2 + \\sum_{t=2}^T (r_t - \\phi r_{t-1})^2 \\right].\n$$\n\n因此，在给定 $(\\boldsymbol{\\theta}, \\phi, \\sigma_\\eta)$ 的条件下，观测值 $\\{y_t\\}_{t=1}^T$ 的联合似然函数（用残差 $r_t = y_t - h(\\boldsymbol{\\theta}, u_t)$ 表示）为\n$$\np(y_{1:T} \\mid \\boldsymbol{\\theta}, \\phi, \\sigma_\\eta)\n= (2\\pi)^{-T/2} (1 - \\phi^2)^{1/2} \\, \\sigma_\\eta^{-T}\n\\exp\\!\\left(\n-\\frac{1}{2\\sigma_\\eta^2}\n\\left[\n(1 - \\phi^2) r_1^2 + \\sum_{t=2}^T (r_t - \\phi r_{t-1})^2\n\\right]\n\\right),\n$$\n这是一个根据基本概率法则和平稳性下的高斯AR(1)性质构建的闭式解析表达式。",
            "answer": "$$\\boxed{(2\\pi)^{-T/2}\\,(1-\\phi^{2})^{1/2}\\,\\sigma_{\\eta}^{-T}\\,\\exp\\!\\left(-\\frac{1}{2\\sigma_{\\eta}^{2}}\\left[(1-\\phi^{2})\\,r_{1}^{2}+\\sum_{t=2}^{T}\\left(r_{t}-\\phi\\,r_{t-1}\\right)^{2}\\right]\\right)}$$"
        }
    ]
}