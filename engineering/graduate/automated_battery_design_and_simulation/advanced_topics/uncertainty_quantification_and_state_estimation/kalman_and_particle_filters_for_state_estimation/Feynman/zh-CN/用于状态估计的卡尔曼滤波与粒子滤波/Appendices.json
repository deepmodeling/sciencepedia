{
    "hands_on_practices": [
        {
            "introduction": "在实现任何数字滤波器之前，一个关键的步骤是将描述物理系统的连续时间模型 $\\dot{x} = Ax + Bu$ 转换为离散时间形式 $x_{k+1} = A_d x_k + B_d u_k$。这个练习将带你实践这一过程，你会为一个标准的电池等效电路模型推导精确的离散化矩阵 $A_d$ 和 $B_d$。通过将精确解与简单的一阶欧拉近似进行比较，你将能够量化离散化误差，从而深刻理解在建模准确性与计算简便性之间进行权衡的重要性。",
            "id": "3922770",
            "problem": "在自动化电池设计与仿真中，为了实现用于状态估计的卡尔曼滤波器（KF）和粒子滤波器（PF），电化学动力学的离散时间模型是必不可少的。考虑一个典型的双支路阻容网络，即双电阻双电容等效电路模型（ECM），该模型由一个施加的电流输入驱动。设状态为支路电容电压，记作 $v_{1}(t)$ 和 $v_{2}(t)$，分别与电阻-电容对 $(R_{1},C_{1})$ 和 $(R_{2},C_{2})$ 相关联。假设RC支路的连续时间线性时不变动力学由电容器的基本电路关系 $i_{C} = C \\, dv/dt$ 和欧姆定律 $v = R i$ 支配，在由施加电流 $i(t)$ 驱动的支路电流叠加下，具有以下状态空间表示：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nv_{1}(t) \\\\ v_{2}(t)\n\\end{pmatrix}\n=\n\\underbrace{\n\\begin{pmatrix}\n-\\frac{1}{R_{1} C_{1}} & 0 \\\\\n0 & -\\frac{1}{R_{2} C_{2}}\n\\end{pmatrix}}_{A}\n\\begin{pmatrix}\nv_{1}(t) \\\\ v_{2}(t)\n\\end{pmatrix}\n+\n\\underbrace{\n\\begin{pmatrix}\n\\frac{1}{C_{1}} \\\\ \\frac{1}{C_{2}}\n\\end{pmatrix}}_{B}\n\\, i(t).\n$$\n设采样周期为 $\\Delta t > 0$，并假设输入上有一个零阶保持器（ZOH），这意味着 $i(t)$ 在每个区间 $[k \\Delta t,(k+1)\\Delta t)$ 上是恒定的。\n\n从线性时不变系统的基本解出发，推导与以下映射相对应的精确ZOH离散时间状态转移矩阵 $(A_{d},B_{d})$：\n$$\n\\begin{pmatrix}\nv_{1}( (k+1)\\Delta t) \\\\ v_{2}( (k+1)\\Delta t)\n\\end{pmatrix}\n=\nA_{d}\n\\begin{pmatrix}\nv_{1}(k \\Delta t) \\\\ v_{2}(k \\Delta t)\n\\end{pmatrix}\n+\nB_{d} \\, i(k \\Delta t).\n$$\n然后，通过构建分块矩阵 $G_{d} = [\\, A_{d} \\; B_{d} \\,]$ 和 $G_{e} = [\\, A_{e} \\; B_{e} \\,]$，来量化一阶前向欧拉法相对于精确ZOH离散化的离散化误差，其中 $A_{e}$ 和 $B_{e}$ 是从相同的连续时间系统 $(A,B)$ 导出的一阶欧拉离散化矩阵。将误差大小定义为弗罗贝尼乌斯范数\n$$\n\\| G_{d} - G_{e} \\|_{F},\n$$\n并将此标量精确地表示为 $R_{1}$、$C_{1}$、$R_{2}$、$C_{2}$ 和 $\\Delta t$ 的函数。\n\n您最终报告的量必须是 $\\| G_{d} - G_{e} \\|_{F}$ 作为 $R_{1}$、$C_{1}$、$R_{2}$、$C_{2}$ 和 $\\Delta t$ 函数的精确闭式解析表达式。不要进行四舍五入。报告的标量不需要物理单位。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于线性系统理论和电路分析，信息完备、问题适定，并且表述客观。任务虽然计算量大，但在数学上是明确定义的，可以导出一个唯一的解析解。\n\n该问题要求针对一个给定的连续时间线性时不变（LTI）系统，推导精确零阶保持器（ZOH）方法与一阶前向欧拉法之间的离散化误差。该系统描述了一个电池的双电阻双电容（2R2C）等效电路模型。误差通过增广状态转移矩阵之差的弗罗贝尼乌斯范数来量化。\n\n设状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} v_{1}(t) \\\\ v_{2}(t) \\end{pmatrix}$，输入为 $u(t) = i(t)$。连续时间状态空间表示为 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)$，其中矩阵为：\n$$\nA = \\begin{pmatrix} -\\frac{1}{R_{1} C_{1}} & 0 \\\\ 0 & -\\frac{1}{R_{2} C_{2}} \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} \\frac{1}{C_{1}} \\\\ \\frac{1}{C_{2}} \\end{pmatrix}\n$$\n我们定义时间常数 $\\tau_{1} = R_{1}C_{1}$ 和 $\\tau_{2} = R_{2}C_{2}$。矩阵 $A$ 是一个对角矩阵：\n$$\nA = \\begin{pmatrix} -\\frac{1}{\\tau_{1}} & 0 \\\\ 0 & -\\frac{1}{\\tau_{2}} \\end{pmatrix}\n$$\n\n**1. 精确零阶保持器（ZOH）离散化**\n\nLTI系统方程在采样区间 $[k\\Delta t, (k+1)\\Delta t]$ 上的解由常数变易法给出。对于一个ZOH输入，其中 $u(t) = u(k\\Delta t) = u_k$ 在该区间上为常数，其精确的离散时间等效形式为：\n$$\n\\mathbf{x}((k+1)\\Delta t) = e^{A\\Delta t} \\mathbf{x}(k\\Delta t) + \\left( \\int_{0}^{\\Delta t} e^{As} ds \\right) B u(k\\Delta t)\n$$\n这给出了离散时间矩阵 $A_d = e^{A\\Delta t}$ 和 $B_d = \\left( \\int_{0}^{\\Delta t} e^{As} ds \\right) B$。\n\n由于 $A$ 是一个对角矩阵，其矩阵指数可以通过对对角元素取指数来得到：\n$$\nA_d = e^{A\\Delta t} = \\begin{pmatrix} \\exp\\left(-\\frac{\\Delta t}{\\tau_{1}}\\right) & 0 \\\\ 0 & \\exp\\left(-\\frac{\\Delta t}{\\tau_{2}}\\right) \\end{pmatrix} = \\begin{pmatrix} \\exp\\left(-\\frac{\\Delta t}{R_1 C_1}\\right) & 0 \\\\ 0 & \\exp\\left(-\\frac{\\Delta t}{R_2 C_2}\\right) \\end{pmatrix}\n$$\n积分项也逐元素计算：\n$$\n\\int_{0}^{\\Delta t} e^{As} ds = \\begin{pmatrix} \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau_{1}}\\right) ds & 0 \\\\ 0 & \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau_{2}}\\right) ds \\end{pmatrix} = \\begin{pmatrix} [-\\tau_{1} \\exp\\left(-\\frac{s}{\\tau_{1}}\\right)]_{0}^{\\Delta t} & 0 \\\\ 0 & [-\\tau_{2} \\exp\\left(-\\frac{s}{\\tau_{2}}\\right)]_{0}^{\\Delta t} \\end{pmatrix}\n$$\n$$\n\\int_{0}^{\\Delta t} e^{As} ds = \\begin{pmatrix} \\tau_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_{1}}\\right)\\right) & 0 \\\\ 0 & \\tau_{2} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_{2}}\\right)\\right) \\end{pmatrix}\n$$\n现在，我们计算 $B_d$：\n$$\nB_d = \\begin{pmatrix} \\tau_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_{1}}\\right)\\right) & 0 \\\\ 0 & \\tau_{2} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_{2}}\\right)\\right) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{C_{1}} \\\\ \\frac{1}{C_{2}} \\end{pmatrix}\n$$\n代入 $\\tau_1 = R_1 C_1$ 和 $\\tau_2 = R_2 C_2$：\n$$\nB_d = \\begin{pmatrix} R_{1}C_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{1}C_{1}}\\right)\\right) \\frac{1}{C_{1}} \\\\ R_{2}C_{2} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{2}C_{2}}\\right)\\right) \\frac{1}{C_{2}} \\end{pmatrix} = \\begin{pmatrix} R_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{1}C_{1}}\\right)\\right) \\\\ R_{2} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{2}C_{2}}\\right)\\right) \\end{pmatrix}\n$$\n\n**2. 一阶前向欧拉离散化**\n\n前向欧拉法通过前向差分 $\\frac{\\mathbf{x}_{k+1} - \\mathbf{x}_k}{\\Delta t}$ 来近似导数 $\\dot{\\mathbf{x}}(t)$。将此应用于连续时间系统：\n$$\n\\frac{\\mathbf{x}_{k+1} - \\mathbf{x}_k}{\\Delta t} = A \\mathbf{x}_k + B u_k\n$$\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + A\\Delta t \\mathbf{x}_k + B\\Delta t u_k = (I + A\\Delta t) \\mathbf{x}_k + (B\\Delta t) u_k\n$$\n这给出了欧拉近似矩阵 $A_e = I + A\\Delta t$ 和 $B_e = B\\Delta t$。\n$$\nA_e = I + A\\Delta t = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} -\\frac{\\Delta t}{R_1 C_1} & 0 \\\\ 0 & -\\frac{\\Delta t}{R_2 C_2} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{\\Delta t}{R_1 C_1} & 0 \\\\ 0 & 1 - \\frac{\\Delta t}{R_2 C_2} \\end{pmatrix}\n$$\n$$\nB_e = B\\Delta t = \\begin{pmatrix} \\frac{1}{C_{1}} \\\\ \\frac{1}{C_{2}} \\end{pmatrix} \\Delta t = \\begin{pmatrix} \\frac{\\Delta t}{C_{1}} \\\\ \\frac{\\Delta t}{C_{2}} \\end{pmatrix}\n$$\n\n**3. 误差矩阵与弗罗贝尼乌斯范数计算**\n\n我们构建增广矩阵 $G_d = [A_d \\ B_d]$ 和 $G_e = [A_e \\ B_e]$。误差矩阵为 $\\Delta G = G_d - G_e$。\n$$\n\\Delta G = [A_d - A_e \\quad B_d - B_e]\n$$\n让我们计算 $\\Delta G$ 的分量。第一个块是 $A_d - A_e$：\n$$\nA_d - A_e = \\begin{pmatrix} \\exp\\left(-\\frac{\\Delta t}{R_1 C_1}\\right) - \\left(1 - \\frac{\\Delta t}{R_1 C_1}\\right) & 0 \\\\ 0 & \\exp\\left(-\\frac{\\Delta t}{R_2 C_2}\\right) - \\left(1 - \\frac{\\Delta t}{R_2 C_2}\\right) \\end{pmatrix}\n$$\n第二个块是 $B_d - B_e$：\n$$\nB_d - B_e = \\begin{pmatrix} R_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{1}C_{1}}\\right)\\right) - \\frac{\\Delta t}{C_{1}} \\\\ R_{2} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{2}C_{2}}\\right)\\right) - \\frac{\\Delta t}{C_{2}} \\end{pmatrix}\n$$\n我们可以通过提出因子 $R_1$ 和 $R_2$ 来重写第二个块：\n$$\n\\frac{\\Delta t}{C_1} = R_1 \\frac{\\Delta t}{R_1 C_1}\n$$\n所以 $B_d - B_e$ 的第一个分量是：\n$$\nR_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{1}C_{1}}\\right)\\right) - R_1 \\frac{\\Delta t}{R_1 C_1} = R_{1} \\left(1 - \\exp\\left(-\\frac{\\Delta t}{R_{1}C_{1}}\\right) - \\frac{\\Delta t}{R_{1}C_{1}}\\right)\n$$\n这可以写成 $-R_1$ 乘以 $A_d - A_e$ 的 $(1,1)$ 元素。设 $E_1 = \\exp\\left(-\\frac{\\Delta t}{R_1 C_1}\\right) - 1 + \\frac{\\Delta t}{R_1 C_1}$ 和 $E_2 = \\exp\\left(-\\frac{\\Delta t}{R_2 C_2}\\right) - 1 + \\frac{\\Delta t}{R_2 C_2}$。\n误差矩阵 $\\Delta G$ 是：\n$$\n\\Delta G = \\begin{pmatrix} E_1 & 0 & -R_1 E_1 \\\\ 0 & E_2 & -R_2 E_2 \\end{pmatrix}\n$$\n弗罗贝尼乌斯范数为 $\\|M\\|_F = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$。\n$$\n\\|\\Delta G\\|_{F}^2 = E_1^2 + 0^2 + (-R_1 E_1)^2 + 0^2 + E_2^2 + (-R_2 E_2)^2\n$$\n$$\n\\|\\Delta G\\|_{F}^2 = E_1^2 + R_1^2 E_1^2 + E_2^2 + R_2^2 E_2^2\n$$\n$$\n\\|\\Delta G\\|_{F}^2 = (1 + R_1^2) E_1^2 + (1 + R_2^2) E_2^2\n$$\n取平方根并代入 $E_1$ 和 $E_2$ 的表达式：\n$$\n\\|\\Delta G\\|_{F} = \\sqrt{(1 + R_1^2) \\left(\\exp\\left(-\\frac{\\Delta t}{R_1 C_1}\\right) - 1 + \\frac{\\Delta t}{R_1 C_1}\\right)^2 + (1 + R_2^2) \\left(\\exp\\left(-\\frac{\\Delta t}{R_2 C_2}\\right) - 1 + \\frac{\\Delta t}{R_2 C_2}\\right)^2}\n$$\n这就是误差大小的精确闭式表达式。",
            "answer": "$$\\boxed{\\sqrt{\\left(1+R_1^2\\right) \\left(\\exp\\left(-\\frac{\\Delta t}{R_1 C_1}\\right) - 1 + \\frac{\\Delta t}{R_1 C_1}\\right)^2 + \\left(1+R_2^2\\right) \\left(\\exp\\left(-\\frac{\\Delta t}{R_2 C_2}\\right) - 1 + \\frac{\\Delta t}{R_2 C_2}\\right)^2}}$$"
        },
        {
            "introduction": "拥有了离散时间模型后，我们便可以应用卡尔曼滤波算法进行状态估计。这个练习将引导你完整地走过卡尔曼滤波的一个核心循环：预测和校正。通过具体的数值计算，你将亲手实现从预测状态 $x_{k|k-1}$、计算新息，到最终更新状态估计 $x_{k|k}$ 及其协方差 $P_{k|k}$ 的全过程，从而揭开卡尔曼滤波这一强大工具的神秘面纱。",
            "id": "3922746",
            "problem": "考虑一个锂离子电池，其在恒流采样区间内可由一个一阶电阻-电容 (1-RC) 戴维南等效电路近似。其内部 RC 极化电压和荷电状态 (SoC) 在离散时间内通过一个线性高斯状态空间系统进行建模。设状态为 $x_{k} = \\begin{pmatrix} v_{\\mathrm{rc},k} \\\\ z_{k} \\end{pmatrix}$，其中 $v_{\\mathrm{rc},k}$ 是 RC 支路电压，$z_{k}$ 是 SoC（表示为 $0$ 到 $1$ 之间的小数）。电流输入为 $u_{k}$（放电为正），测量的端电压为 $y_{k}$。离散时间动态和测量由以下公式给出\n$$\nx_{k+1} = A_{d}\\,x_{k} + B_{d}\\,u_{k} + w_{k}, \\quad w_{k} \\sim \\mathcal{N}(0, Q_{d}),\n$$\n$$\ny_{k} = V_{0} + C_{d}\\,x_{k} + D_{d}\\,u_{k} + \\eta_{k}, \\quad \\eta_{k} \\sim \\mathcal{N}(0, R),\n$$\n其中矩阵和标量已知\n$$\nA_{d} = \\begin{pmatrix} 0.951229 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad B_{d} = \\begin{pmatrix} -0.0004877 \\\\ -5.5556 \\times 10^{-5} \\end{pmatrix}, \\quad C_{d} = \\begin{pmatrix} -1 & 0.2 \\end{pmatrix}, \\quad D_{d} = -0.02,\n$$\n$$\nQ_{d} = \\begin{pmatrix} 1.0 \\times 10^{-5} & 0 \\\\ 0 & 1.0 \\times 10^{-6} \\end{pmatrix}, \\quad R = 1.0 \\times 10^{-4}, \\quad V_{0} = 3.7.\n$$\n假设在时间 $k=0$ 时的先验状态估计和协方差为\n$$\nx_{0|0} = \\begin{pmatrix} 0.050 \\\\ 0.800 \\end{pmatrix}, \\quad P_{0|0} = \\begin{pmatrix} 2.0 \\times 10^{-3} & 0 \\\\ 0 & 4.0 \\times 10^{-4} \\end{pmatrix}.\n$$\n给定以下电流输入和测量端电压序列：\n$$\nu_{1} = 2.0, \\quad y_{1} = 3.760; \\quad u_{2} = 1.5, \\quad y_{2} = 3.770; \\quad u_{3} = 0.0, \\quad y_{3} = 3.780.\n$$\n从离散时间线性高斯状态空间模型和最小方差线性估计器的基本定义出发，使用数据对 $(u_{1}, y_{1})$ 在 $k=1$ 时执行一次完整的卡尔曼滤波器 (KF) 迭代，以计算：\n- 预测状态 $x_{1|0}$，\n- 新息 $v_{1}$，\n- 新息协方差 $S_{1}$，\n- 卡尔曼增益 $K_{1}$，\n- 更新状态 $x_{1|1}$，\n- 以及更新协方差 $P_{1|1}$（协方差更新使用 Joseph 稳定形式）。\n\n电压以 $\\mathrm{V}$ 为单位，SoC 以无单位小数表示，协方差以适当的平方单位表示；新息及其协方差与电压通道有关。将最终数值四舍五入至四位有效数字。将最终答案表示为包含以下各项的单行矩阵，按顺序排列：\n$$\n\\big( v_{\\mathrm{rc},1|0}, \\, z_{1|0}, \\, v_{1}, \\, S_{1}, \\, K_{1}^{(1)}, \\, K_{1}^{(2)}, \\, v_{\\mathrm{rc},1|1}, \\, z_{1|1}, \\, P_{1|1}^{(1,1)}, \\, P_{1|1}^{(1,2)}, \\, P_{1|1}^{(2,1)}, \\, P_{1|1}^{(2,2)} \\big).\n$$\n最终答案框中不包含单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、问题设定良好、客观，并包含执行一次离散时间卡尔曼滤波器迭代所需的所有信息。该模型是电池电气行为的标准线性高斯状态空间表示，所要求的任务是一个成熟算法的直接应用。\n\n卡尔曼滤波器是一种递归算法，可提供线性高斯系统状态的最优（在最小均方误差意义上）估计。它以一个两步循环运行：一个预测（或时间更新）步骤和一个校正（或测量更新）步骤。\n\n设在时间步 $k-1$ 的状态估计为 $x_{k-1|k-1}$，其相关的误差协方差为 $P_{k-1|k-1}$。系统描述如下：\n$$x_{k} = A_{d}\\,x_{k-1} + B_{d}\\,u_{k-1} + w_{k-1}, \\quad w_{k-1} \\sim \\mathcal{N}(0, Q_{d})$$\n$$y_{k} = H_{d}\\,x_{k} + E_{d}\\,u_{k} + v_{k}, \\quad v_{k} \\sim \\mathcal{N}(0, R)$$\n对于本问题，测量方程给出为 $y_{k} = V_{0} + C_{d}\\,x_{k} + D_{d}\\,u_{k} + \\eta_{k}$。为了使其与标准形式对齐，我们可以定义一个修正后的测量值 $y'_{k} = y_{k} - V_{0} - D_{d}u_{k}$。测量方程则变为 $y'_{k} = C_{d}x_{k} + \\eta_{k}$。新息将根据原始形式计算。\n\n在时间 $k=0$ 时的初始条件如下：\n$$x_{0|0} = \\begin{pmatrix} 0.050 \\\\ 0.800 \\end{pmatrix}, \\quad P_{0|0} = \\begin{pmatrix} 2.0 \\times 10^{-3} & 0 \\\\ 0 & 4.0 \\times 10^{-4} \\end{pmatrix}$$\n任务是在 $k=1$ 时执行一次完整的迭代，使用输入 $u_{1} = 2.0$ 和测量值 $y_{1} = 3.760$。\n\n**第 1 步：预测（时间更新）**\n\n预测步骤在融合 $k=1$ 时的测量值之前，将状态和协方差从 $k=0$ 投影到 $k=1$。\n\n预测状态均值 $x_{1|0}$ 计算如下：\n$$x_{1|0} = A_{d}\\,x_{0|0} + B_{d}\\,u_{1}$$\n$$x_{1|0} = \\begin{pmatrix} 0.951229 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.050 \\\\ 0.800 \\end{pmatrix} + \\begin{pmatrix} -0.0004877 \\\\ -5.5556 \\times 10^{-5} \\end{pmatrix} (2.0)$$\n$$x_{1|0} = \\begin{pmatrix} 0.04756145 \\\\ 0.800 \\end{pmatrix} + \\begin{pmatrix} -0.0009754 \\\\ -0.000111112 \\end{pmatrix} = \\begin{pmatrix} 0.04658605 \\\\ 0.79988889 \\end{pmatrix}$$\n因此，$v_{\\mathrm{rc},1|0} \\approx 0.046586$ 且 $z_{1|0} \\approx 0.79989$。\n\n预测误差协方差 $P_{1|0}$ 计算如下：\n$$P_{1|0} = A_{d}\\,P_{0|0}\\,A_{d}^T + Q_{d}$$\n$$P_{1|0} = \\begin{pmatrix} 0.951229 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.002 & 0 \\\\ 0 & 0.0004 \\end{pmatrix} \\begin{pmatrix} 0.951229 & 0 \\\\ 0 & 1 \\end{pmatrix}^T + \\begin{pmatrix} 1.0 \\times 10^{-5} & 0 \\\\ 0 & 1.0 \\times 10^{-6} \\end{pmatrix}$$\n$$P_{1|0} = \\begin{pmatrix} (0.951229)^2(0.002) & 0 \\\\ 0 & (1)^2(0.0004) \\end{pmatrix} + \\begin{pmatrix} 0.00001 & 0 \\\\ 0 & 0.000001 \\end{pmatrix}$$\n$$P_{1|0} = \\begin{pmatrix} 0.00180967 & 0 \\\\ 0 & 0.0004 \\end{pmatrix} + \\begin{pmatrix} 0.00001 & 0 \\\\ 0 & 0.000001 \\end{pmatrix} = \\begin{pmatrix} 0.00181967 & 0 \\\\ 0 & 0.000401 \\end{pmatrix}$$\n\n**第 2 步：校正（测量更新）**\n\n校正步骤使用测量值 $y_{1}$ 来修正预测的状态和协方差。\n\n新息（或测量残差）$v_{1}$ 是实际测量值与预测测量值之间的差值：\n$$v_{1} = y_{1} - \\hat{y}_{1|0} = y_{1} - (V_{0} + C_{d}\\,x_{1|0} + D_{d}\\,u_{1})$$\n$$v_{1} = 3.760 - \\left( 3.7 + \\begin{pmatrix} -1 & 0.2 \\end{pmatrix} \\begin{pmatrix} 0.04658605 \\\\ 0.79988889 \\end{pmatrix} + (-0.02)(2.0) \\right)$$\n$$v_{1} = 3.760 - (3.7 - 0.04658605 + 0.15997778 - 0.04) = 3.760 - 3.77339173 = -0.01339173$$\n\n新息协方差 $S_{1}$ 计算如下：\n$$S_{1} = C_{d}\\,P_{1|0}\\,C_{d}^T + R$$\n$$S_{1} = \\begin{pmatrix} -1 & 0.2 \\end{pmatrix} \\begin{pmatrix} 0.00181967 & 0 \\\\ 0 & 0.000401 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0.2 \\end{pmatrix} + 1.0 \\times 10^{-4}$$\n$$S_{1} = ((-1)^2(0.00181967) + (0.2)^2(0.000401)) + 0.0001$$\n$$S_{1} = (0.00181967 + 0.00001604) + 0.0001 = 0.00183571 + 0.0001 = 0.00193571$$\n\n最优卡尔曼增益 $K_{1}$ 为：\n$$K_{1} = P_{1|0}\\,C_{d}^T\\,S_{1}^{-1}$$\n$$P_{1|0}\\,C_{d}^T = \\begin{pmatrix} 0.00181967 & 0 \\\\ 0 & 0.000401 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.00181967 \\\\ 0.0000802 \\end{pmatrix}$$\n$$K_{1} = \\begin{pmatrix} -0.00181967 \\\\ 0.0000802 \\end{pmatrix} (0.00193571)^{-1} = \\begin{pmatrix} -0.940053 \\\\ 0.0414320 \\end{pmatrix}$$\n因此，$K_{1}^{(1)} \\approx -0.94005$ 且 $K_{1}^{(2)} \\approx 0.041432$。\n\n更新后的状态估计 $x_{1|1}$ 为：\n$$x_{1|1} = x_{1|0} + K_{1}\\,v_{1}$$\n$$x_{1|1} = \\begin{pmatrix} 0.04658605 \\\\ 0.79988889 \\end{pmatrix} + \\begin{pmatrix} -0.940053 \\\\ 0.0414320 \\end{pmatrix} (-0.01339173)$$\n$$x_{1|1} = \\begin{pmatrix} 0.04658605 \\\\ 0.79988889 \\end{pmatrix} + \\begin{pmatrix} 0.0125889 \\\\ -0.0005548 \\end{pmatrix} = \\begin{pmatrix} 0.059175 \\\\ 0.799334 \\end{pmatrix}$$\n因此，$v_{\\mathrm{rc},1|1} \\approx 0.059175$ 且 $z_{1|1} \\approx 0.79933$。\n\n更新后的误差协方差 $P_{1|1}$ 按要求使用 Joseph 稳定形式计算，这种形式保证了对称性和半正定性：\n$$P_{1|1} = (I - K_{1}\\,C_{d})\\,P_{1|0}\\,(I - K_{1}\\,C_{d})^T + K_{1}\\,R\\,K_{1}^T$$\n第一项计算：\n$$I - K_{1}\\,C_{d} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} -0.940053 \\\\ 0.0414320 \\end{pmatrix}\\begin{pmatrix} -1 & 0.2 \\end{pmatrix} = \\begin{pmatrix} 1-0.940053 & 0.1880106 \\\\ 0.0414320 & 1-0.0082864 \\end{pmatrix} = \\begin{pmatrix} 0.059947 & 0.1880106 \\\\ 0.0414320 & 0.9917136 \\end{pmatrix}$$\n令 $M = I-K_1 C_d$。第一项为 $M P_{1|0} M^T$：\n$$ M P_{1|0} M^T \\approx \\begin{pmatrix} 2.0713 \\times 10^{-5} & 7.9287 \\times 10^{-5} \\\\ 7.9287 \\times 10^{-5} & 3.9751 \\times 10^{-4} \\end{pmatrix}$$\n第二项计算，$K_{1}\\,R\\,K_{1}^T$：\n$$K_{1}\\,R\\,K_{1}^T = \\begin{pmatrix} -0.940053 \\\\ 0.0414320 \\end{pmatrix} (1.0 \\times 10^{-4}) \\begin{pmatrix} -0.940053 & 0.0414320 \\end{pmatrix}$$\n$$K_{1}\\,R\\,K_{1}^T \\approx \\begin{pmatrix} 8.8370 \\times 10^{-5} & -3.8943 \\times 10^{-6} \\\\ -3.8943 \\times 10^{-6} & 1.7166 \\times 10^{-7} \\end{pmatrix}$$\n两项相加：\n$$P_{1|1} = \\begin{pmatrix} 2.0713 \\times 10^{-5} + 8.8370 \\times 10^{-5} & 7.9287 \\times 10^{-5} - 3.8943 \\times 10^{-6} \\\\ 7.9287 \\times 10^{-5} - 3.8943 \\times 10^{-6} & 3.9751 \\times 10^{-4} + 1.7166 \\times 10^{-7} \\end{pmatrix}$$\n$$P_{1|1} = \\begin{pmatrix} 1.09083 \\times 10^{-4} & 7.5393 \\times 10^{-5} \\\\ 7.5393 \\times 10^{-5} & 3.9768 \\times 10^{-4} \\end{pmatrix}$$\n\n将最终结果四舍五入至四位有效数字：\n$v_{\\mathrm{rc},1|0} \\approx 0.04659$\n$z_{1|0} \\approx 0.7999$\n$v_{1} \\approx -0.01339$\n$S_{1} \\approx 0.001936$\n$K_{1}^{(1)} \\approx -0.9401$\n$K_{1}^{(2)} \\approx 0.04143$\n$v_{\\mathrm{rc},1|1} \\approx 0.05917$\n$z_{1|1} \\approx 0.7993$\n$P_{1|1}^{(1,1)} \\approx 1.091 \\times 10^{-4}$\n$P_{1|1}^{(1,2)} \\approx 7.539 \\times 10^{-5}$\n$P_{1|1}^{(2,1)} \\approx 7.539 \\times 10^{-5}$\n$P_{1|1}^{(2,2)} \\approx 3.977 \\times 10^{-4}$\n\n这些值被格式化为最终答案所需的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.04659 & 0.7999 & -0.01339 & 0.001936 & -0.9401 & 0.04143 & 0.05917 & 0.7993 & 0.0001091 & 0.00007539 & 0.00007539 & 0.0003977\n\\end{pmatrix}\n}\n$$"
        }
    ]
}