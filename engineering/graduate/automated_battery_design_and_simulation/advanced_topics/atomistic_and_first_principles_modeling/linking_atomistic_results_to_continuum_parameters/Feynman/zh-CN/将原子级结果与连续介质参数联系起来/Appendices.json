{
    "hands_on_practices": [
        {
            "introduction": "将原子尺度的模拟结果与宏观连续介质模型联系起来，是多尺度建模中的一个核心挑战。本练习将指导您完成一项基础但至关重要的任务：从分子动力学（MD）模拟中提取宏观热力学参数。您将学习如何利用统计力学中的涨落-耗散定理，通过分析系统总能量的微观涨落，来计算材料的等容热容（$c_{V,m}$）和等压热容（$c_{p,m}$），这对于电池等设备的热管理模型至关重要。",
            "id": "3923605",
            "problem": "您正在设计一个计算流程，用于将原子级别的分子动力学（MD）结果与连续介质热力学参数相关联，这些参数与自动化电池设计和模拟相关。从基本的热力学定义和正则系综结果出发，您必须实现一个程序，根据分子动力学（MD）的能量时间序列，估算代表性电池材料的定容热容和定压热容。\n\n需使用的定义：\n- 定容热容定义为 $C_V = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$，其中 $U$ 是内能，$T$ 是温度。\n- 定压热容定义为 $C_p = \\left(\\frac{\\partial H}{\\partial T}\\right)_p$，其中 $H$ 是焓。\n- 在正则系综中，能量涨落通过以下公式与定容热容相关：$C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2}$，其中 $E$ 是系统能量，$k_B$ 是玻尔兹曼常数。尖括号表示系综平均。\n\n为了将原子级别的估算值映射到连续介质的摩尔量，设 $N_{\\text{units}}$ 为 MD 系统中表示的化学式单位或分子的数量，设 $N_A$ 为 Avogadro 常数。物质的量为 $n_{\\text{moles}} = \\frac{N_{\\text{units}}}{N_A}$，对于系统体积 V，摩尔体积为 $v_m = \\frac{V}{n_{\\text{moles}}}$。那么摩尔热容为\n- $c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$，\n- $c_{p,m} = c_{V,m} + \\frac{T \\alpha^2 v_m}{\\kappa_T}$，\n其中 $\\alpha$ 是体热膨胀系数，$\\kappa_T$ 是等温压缩系数。等式 $C_p - C_V = \\frac{T \\alpha^2 V}{\\kappa_T}$ 是凝聚态物质系统中一个经过充分验证的关系式，除以 $n_{\\text{moles}}$ 可得到其摩尔形式 $c_{p,m} - c_{V,m} = \\frac{T \\alpha^2 v_m}{\\kappa_T}$。\n\n程序要求：\n- 实现一个程序，为下面指定的每个测试用例计算 $c_{V,m}$ 和 $c_{p,m}$。使用正则系综涨落估算公式 $C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2}$，其中样本平均值通过对所提供的 MD 能量时间序列取算术平均值来计算。\n- MD 能量以电子伏特（electronvolts）为单位提供；使用基本电荷 $e = 1.602176634\\times 10^{-19}$ 库仑将能量转换为焦耳。使用 $k_B = 1.380649\\times 10^{-23}$ 焦耳/开尔文和 $N_A = 6.02214076\\times 10^{23}$ /摩尔。\n- 将 $c_{V,m}$ 和 $c_{p,m}$ 均以焦耳/摩尔·开尔文为单位表示，并四舍五入到六位小数。\n- 为了数值稳定性，如果由于有限精度导致计算出的方差 $\\langle E^2\\rangle - \\langle E\\rangle^2$ 为负，则将其截断为 0。\n\n测试套件：\n- 用例 A (层状氧化物，类 LiCoO$_2$):\n  - 能量时间序列 (单位: 电子伏特): $[-100002.5, -100000.8, -99998.7, -100003.3, -99999.5, -100001.2, -99997.9, -100002.1, -100000.3, -99998.9, -100001.8, -99999.1]$\n  - 温度 (单位: 开尔文): $300$\n  - 单位数量: $5000$\n  - 体积 (单位: 立方米): $1.626\\times 10^{-25}$\n  - 热膨胀系数 (单位: 1/开尔文): $1.5\\times 10^{-5}$\n  - 等温压缩系数 (单位: 1/帕斯卡): $1.6\\times 10^{-11}$\n\n- 用例 B (类石墨固体):\n  - 能量时间序列 (单位: 电子伏特): $[-50001.2, -49999.9, -50000.3, -50002.1, -49998.5, -50000.7, -50001.5, -49999.0, -50000.0, -50001.0]$\n  - 温度 (单位: 开尔文): $300$\n  - 单位数量: $10000$\n  - 体积 (单位: 立方米): $8.798\\times 10^{-26}$\n  - 热膨胀系数 (单位: 1/开尔文): $2.5\\times 10^{-6}$\n  - 等温压缩系数 (单位: 1/帕斯卡): $3.0\\times 10^{-11}$\n\n- 用例 C (液体电解质):\n  - 能量时间序列 (单位: 电子伏特): $[-20010.3, -19995.7, -20005.1, -20000.2, -19990.8, -20012.4, -19998.6, -20007.9, -19993.3, -20001.6, -19997.2, -20009.8]$\n  - 温度 (单位: 开尔文): $300$\n  - 单位数量: $2000$\n  - 体积 (单位: 立方米): $3.321\\times 10^{-25}$\n  - 热膨胀系数 (单位: 1/开尔文): $7.0\\times 10^{-4}$\n  - 等温压缩系数 (单位: 1/帕斯卡): $4.5\\times 10^{-10}$\n\n- 用例 D (边界情况：能量涨落可忽略不计):\n  - 能量时间序列 (单位: 电子伏特): $[-1000.0, -1000.0, -1000.0, -1000.0, -1000.0, -1000.0]$\n  - 温度 (单位: 开尔文): $300$\n  - 单位数量: $1000$\n  - 体积 (单位: 立方米): $4.980\\times 10^{-26}$\n  - 热膨胀系数 (单位: 1/开尔文): $1.0\\times 10^{-5}$\n  - 等温压缩系数 (单位: 1/帕斯卡): $1.0\\times 10^{-11}$\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出两个浮点数：首先是 $c_{V,m}$，然后是 $c_{p,m}$，两者都以焦耳/摩尔·开尔文为单位，四舍五入到六位小数。总输出应是按 A、B、C、D 顺序聚合所有用例的单个列表，例如，$[c_{V,m}^{(A)}, c_{p,m}^{(A)}, c_{V,m}^{(B)}, c_{p,m}^{(B)}, c_{V,m}^{(C)}, c_{p,m}^{(C)}, c_{V,m}^{(D)}, c_{p,m}^{(D)}]$。",
            "solution": "该问题要求实现一种计算方法，以根据分子动力学（MD）模拟数据确定摩尔定容热容 $c_{V,m}$ 和摩尔定压热容 $c_{p,m}$。此项任务的理论基础在于统计力学和热力学。\n\n对于处于正则（NVT）系综中的系统，其定容热容 $C_V$ 与其总能量 $E$ 的涨落有关。所提供的具体公式是统计力学的一个基石：\n$$C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2} = \\frac{\\sigma_E^2}{k_B T^2}$$\n在这里，$T$ 是系统的绝对温度，$k_B$ 是 Boltzmann 常数（$1.380649\\times 10^{-23}$ J/K），尖括号 $\\langle \\cdot \\rangle$ 表示系综平均。项 $\\sigma_E^2 = \\langle E^2\\rangle - \\langle E\\rangle^2$ 是能量的方差。在计算环境中，我们从 MD 模拟中获得一个能量值的时间序列 $\\{E_1, E_2, \\dots, E_N\\}$，系综平均值通过样本平均值（算术平均值）来估算：\n$$\\langle E \\rangle \\approx \\bar{E} = \\frac{1}{N} \\sum_{i=1}^{N} E_i$$\n$$\\langle E^2 \\rangle \\approx \\overline{E^2} = \\frac{1}{N} \\sum_{i=1}^{N} E_i^2$$\n问题中提供的能量单位是电子伏特（eV），必须将其转换为国际单位制（SI）中的标准能量单位焦耳（J），以与 $k_B$ 的单位保持一致。该转换使用基本电荷 $e = 1.602176634\\times 10^{-19}$ C 进行，其中 1 eV 等于 $1.602176634\\times 10^{-19}$ J。由于有限精度算法，计算出的方差 $\\overline{E^2} - \\bar{E}^2$ 可能为微小的负值；问题规定将此类值截断为 0。\n\n一旦计算出整个模拟单元的 $C_V$（单位：J/K），就必须将其转换为一个强度性质的摩尔量 $c_{V,m}$（单位：J/(mol·K)）。这通过除以模拟中存在的物质的量 $n_{\\text{moles}}$ 来实现。物质的量是根据化学式单位或分子的数量 $N_{\\text{units}}$ 和 Avogadro 常数 $N_A = 6.02214076\\times 10^{23}$ mol$^{-1}$ 计算得出的：\n$$n_{\\text{moles}} = \\frac{N_{\\text{units}}}{N_A}$$\n因此，摩尔定容热容为：\n$$c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$$\n为了求得摩尔定压热容 $c_{p,m}$，我们使用所提供的热力学恒等式，该恒等式对凝聚态物质系统有效：\n$$c_{p,m} = c_{V,m} + \\frac{T \\alpha^2 v_m}{\\kappa_T}$$\n此关系式需要体热膨胀系数 $\\alpha$、等温压缩系数 $\\kappa_T$ 和摩尔体积 $v_m$。摩尔体积是系统体积 $V$ 除以物质的量：\n$$v_m = \\frac{V}{n_{\\text{moles}}}$$\n结合这些步骤，每个测试用例的完整算法如下：\n\n1.  获取能量时间序列 $E_i^{\\text{eV}}$ 并将每个值转换为焦耳：$E_i^{\\text{J}} = E_i^{\\text{eV}} \\times e$。\n2.  计算平均能量 $\\bar{E} = \\frac{1}{N} \\sum E_i^{\\text{J}}$ 和平均能量平方 $\\overline{E^2} = \\frac{1}{N} \\sum (E_i^{\\text{J}})^2$。\n3.  计算能量方差 $\\sigma_E^2 = \\overline{E^2} - \\bar{E}^2$。如果 $\\sigma_E^2  0$，则设置 $\\sigma_E^2 = 0$。\n4.  计算系统的定容热容：$C_V = \\frac{\\sigma_E^2}{k_B T^2}$。\n5.  确定系统中的物质的量：$n_{\\text{moles}} = N_{\\text{units}} / N_A$。\n6.  计算摩尔定容热容：$c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$。\n7.  计算摩尔体积：$v_m = \\frac{V}{n_{\\text{moles}}}$。\n8.  计算用于求定压热容的校正项：$\\Delta c_m = \\frac{T \\alpha^2 v_m}{\\kappa_T}$。\n9.  计算摩尔定压热容：$c_{p,m} = c_{V,m} + \\Delta c_m$。\n10. 根据要求将 $c_{V,m}$ 和 $c_{p,m}$ 四舍五入到六位小数。\n\n该程序被系统地应用于为四个测试用例中每一个所提供的数据。用例 D 的能量值为常数，代表了能量零涨落的情景，导致 $\\sigma_E^2 = 0$ 并因此得到 $c_{V,m} = 0$。然而，$c_{p,m}$ 将不为零，因为校正项 $\\Delta c_m$ 通常是正的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molar heat capacity at constant volume (c_V,m) and\n    constant pressure (c_p,m) from molecular dynamics energy time series data.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    e = 1.602176634e-19  # Elementary charge in Coulombs (J/eV)\n    k_B = 1.380649e-23     # Boltzmann constant in J/K\n    N_A = 6.02214076e23    # Avogadro constant in 1/mol\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (Layered oxide)\",\n            \"energies_eV\": [-100002.5, -100000.8, -99998.7, -100003.3, -99999.5, -100001.2, -99997.9, -100002.1, -100000.3, -99998.9, -100001.8, -99999.1],\n            \"T_K\": 300,\n            \"N_units\": 5000,\n            \"V_m3\": 1.626e-25,\n            \"alpha_per_K\": 1.5e-5,\n            \"kappa_T_per_Pa\": 1.6e-11,\n        },\n        {\n            \"name\": \"Case B (Graphite-like solid)\",\n            \"energies_eV\": [-50001.2, -49999.9, -50000.3, -50002.1, -49998.5, -50000.7, -50001.5, -49999.0, -50000.0, -50001.0],\n            \"T_K\": 300,\n            \"N_units\": 10000,\n            \"V_m3\": 8.798e-26,\n            \"alpha_per_K\": 2.5e-6,\n            \"kappa_T_per_Pa\": 3.0e-11,\n        },\n        {\n            \"name\": \"Case C (Liquid electrolyte)\",\n            \"energies_eV\": [-20010.3, -19995.7, -20005.1, -20000.2, -19990.8, -20012.4, -19998.6, -20007.9, -19993.3, -20001.6, -19997.2, -20009.8],\n            \"T_K\": 300,\n            \"N_units\": 2000,\n            \"V_m3\": 3.321e-25,\n            \"alpha_per_K\": 7.0e-4,\n            \"kappa_T_per_Pa\": 4.5e-10,\n        },\n         {\n            \"name\": \"Case D (Edge case: negligible energy fluctuation)\",\n            \"energies_eV\": [-1000.0, -1000.0, -1000.0, -1000.0, -1000.0, -1000.0],\n            \"T_K\": 300,\n            \"N_units\": 1000,\n            \"V_m3\": 4.980e-26,\n            \"alpha_per_K\": 1.0e-5,\n            \"kappa_T_per_Pa\": 1.0e-11,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        energies_eV = np.array(case[\"energies_eV\"])\n        T = case[\"T_K\"]\n        N_units = case[\"N_units\"]\n        V = case[\"V_m3\"]\n        alpha = case[\"alpha_per_K\"]\n        kappa_T = case[\"kappa_T_per_Pa\"]\n\n        # 1. Convert energies from eV to Joules\n        energies_J = energies_eV * e\n\n        # 2. Compute mean energy and mean squared energy\n        mean_E = np.mean(energies_J)\n        mean_E2 = np.mean(energies_J**2)\n\n        # 3. Calculate energy variance and clip if negative\n        var_E = mean_E2 - mean_E**2\n        if var_E  0:\n            var_E = 0.0\n        \n        # 4. Compute heat capacity at constant volume (for the simulation cell)\n        C_V = var_E / (k_B * T**2)\n\n        # 5. Calculate number of moles\n        n_moles = N_units / N_A\n        \n        # 6. Calculate molar heat capacity at constant volume\n        # Handle division by zero if n_moles is zero (not expected with given inputs)\n        c_Vm = C_V / n_moles if n_moles  0 else 0.0\n\n        # 7. Calculate molar volume\n        v_m = V / n_moles if n_moles  0 else 0.0\n        \n        # 8. Calculate the difference between c_p,m and c_V,m\n        cp_cv_diff = (T * alpha**2 * v_m) / kappa_T\n\n        # 9. Compute molar heat capacity at constant pressure\n        c_pm = c_Vm + cp_cv_diff\n        \n        # 10. Round results to six decimal places and append to the list\n        results.append(round(c_Vm, 6))\n        results.append(round(c_pm, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从电极被电解液润湿，到固体电解质界面（SEI）膜的形成，界面现象主导了电池中的许多关键过程。本练习将演示如何从第一性原理（如密度泛函理论）计算得到的总能量中，求出固-液界面的自由能（$\\gamma_{\\mathrm{SL}}$）。接下来，您将运用杨氏方程（Young's equation），将这个原子尺度的能量值与宏观的润湿现象联系起来，计算出宏观接触角（$\\theta$），从而掌握连接微观计算与宏观界面性质的关键方法。",
            "id": "3923594",
            "problem": "给定与锂离子电池组件相关的固液界面的密度泛函理论 (DFT) 计算的原子尺度能量结果。您的任务是推导、实现并计算单位面积的界面自由能，然后利用毛细理论将其映射到连续介质尺度的宏观润湿接触角。从界面自由能的热力学定义以及三相接触线处的力学平衡开始。所有结果必须以国际单位制 (SI 单位) 表示。您必须编写一个程序，对提供的测试套件执行指定的计算，并按要求的格式输出结果。\n\n使用的基本原理：\n- 热力学定义：单位面积的界面自由能 $\\gamma$ 是与界面相关的过剩自由能除以界面面积。\n- 三相接触线处的力学平衡 (Young 方程)：表面张力的平衡得出了固-汽表面能、固-液界面能、液-汽表面张力与宏观接触角之间的关系。\n\n任务详情：\n1. 对每个测试用例，使用给定的界面构型的总能量 $E_{\\mathrm{interface}}$、相应体相参考系统的能量 $E_{\\mathrm{bulk,1}}$ 和 $E_{\\mathrm{bulk,2}}$ 以及界面面积 $A$，通过原子平板模型计算来计算单位面积的固-液界面自由能 $\\gamma_{\\mathrm{SL}}$。利用热力学定义得到以 $\\text{J/m}^2$ 为单位的 $\\gamma_{\\mathrm{SL}}$。如果计算值为负，则通过设置 $\\gamma_{\\mathrm{SL}} = \\max(0, \\gamma_{\\mathrm{SL}})$ 来强制施加非负约束。\n2. 利用给定的固-汽表面能 $\\gamma_{\\mathrm{SV}}$ 和液-汽表面张力 $\\gamma_{\\mathrm{LV}}$, 通过 Young 方程所蕴含的力学平衡，将 $\\gamma_{\\mathrm{SL}}$ 映射到宏观接触角 $\\theta$。计算 $\\cos\\theta = (\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}}) / \\gamma_{\\mathrm{LV}}$。为确保物理上的可实现性，在计算 $\\theta = \\arccos(\\cos\\theta)$ 之前，将 $\\cos\\theta$ 的值限制在区间 $[-1,1]$ 内。\n3. 以 $\\text{J/m}^2$ 为单位表示 $\\gamma_{\\mathrm{SL}}$，以弧度为单位表示 $\\theta$。最终输出必须是实值浮点数。\n\n测试套件：\n计算以下四组参数集的结果。所有能量单位为焦耳，面积单位为平方米，表面能单位为 $\\text{J/m}^2$。\n\n- 情况 1 (一般情况)：\n  - $E_{\\mathrm{interface}}=1.801\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,1}}=1.000\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,2}}=8.000\\times 10^{-17}$\n  - $A=1.0\\times 10^{-18}$\n  - $\\gamma_{\\mathrm{SV}}=0.13$\n  - $\\gamma_{\\mathrm{LV}}=0.06$\n- 情况 2 (边界情况 $\\cos\\theta=1$)：\n  - $E_{\\mathrm{interface}}=4.0016\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,1}}=2.500\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,2}}=1.500\\times 10^{-16}$\n  - $A=2.0\\times 10^{-18}$\n  - $\\gamma_{\\mathrm{SV}}=0.12$\n  - $\\gamma_{\\mathrm{LV}}=0.04$\n- 情况 3 (边界情况 $\\cos\\theta=-1$)：\n  - $E_{\\mathrm{interface}}=2.003\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,1}}=9.000\\times 10^{-17}$\n  - $E_{\\mathrm{bulk,2}}=1.100\\times 10^{-16}$\n  - $A=1.0\\times 10^{-18}$\n  - $\\gamma_{\\mathrm{SV}}=0.25$\n  - $\\gamma_{\\mathrm{LV}}=0.05$\n- 情况 4 (边缘情况，原始 $\\gamma_{\\mathrm{SL}}$ 为负，需要强制非负性)：\n  - $E_{\\mathrm{interface}}=1.5549\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,1}}=1.234\\times 10^{-16}$\n  - $E_{\\mathrm{bulk,2}}=3.210\\times 10^{-17}$\n  - $A=1.0\\times 10^{-18}$\n  - $\\gamma_{\\mathrm{SV}}=0.20$\n  - $\\gamma_{\\mathrm{LV}}=0.05$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，且不含空格。每个测试用例的结果本身必须是一个双元素列表，结构为 $[\\gamma_{\\mathrm{SL}}, \\theta]$，其中 $\\gamma_{\\mathrm{SL}}$ 的单位是 $\\text{J/m}^2$，$\\theta$ 的单位是弧度。例如：$[[0.1,1.0471975512],[\\dots]]$。",
            "solution": "该问题要求从密度泛函理论 (DFT) 计算得到的原子尺度能量数据中，推导出连续介质尺度的润湿参数，即接触角 $\\theta$。这构成了一项基本的多尺度建模任务，它将原子层面的计算材料科学与宏观毛细理论联系起来。该过程包括两个主要步骤：首先，根据给定的总能量确定单位面积的固-液界面自由能 $\\gamma_{\\mathrm{SL}}$；其次，利用 Young's 方程将 $\\gamma_{\\mathrm{SL}}$ 与接触角 $\\theta$ 关联起来。\n\n**1. 固-液界面自由能 ($\\gamma_{\\mathrm{SL}}$) 的计算**\n\n单位面积的界面自由能 $\\gamma$ 定义为由于界面的存在而导致的系统过剩吉布斯自由能，并按界面面积 $A$ 进行归一化。在温度 $T=0 \\, \\mathrm{K}$ 和恒定体积的条件下（这是静态 DFT 计算的典型假设），吉布斯自由能 $G$ 等同于总内能 $E$。过剩能量 $\\Delta E_{\\mathrm{excess}}$ 是含有界面的系统的能量减去等量组分材料在其体相（无界面）参考态下的能量。\n\n给定包含固-液界面的平板模型的总能量 $E_{\\mathrm{interface}}$，以及固相和液相组分相应体相参考系统的总能量 $E_{\\mathrm{bulk,1}}$ 和 $E_{\\mathrm{bulk,2}}$，过剩能量计算如下：\n$$\n\\Delta E_{\\mathrm{excess}} = E_{\\mathrm{interface}} - (E_{\\mathrm{bulk,1}} + E_{\\mathrm{bulk,2}})\n$$\n此公式假定用于计算 $E_{\\mathrm{bulk,1}}$ 和 $E_{\\mathrm{bulk,2}}$ 的参考计算所包含的每种元素的原子数量，与界面平板模型中相应固相和液相部分的原子数量完全相同。\n\n然后，通过将过剩能量除以界面面积 $A$，可以得到单位面积的固-液界面能 $\\gamma_{\\mathrm{SL}}$：\n$$\n\\gamma_{\\mathrm{SL, raw}} = \\frac{\\Delta E_{\\mathrm{excess}}}{A} = \\frac{E_{\\mathrm{interface}} - E_{\\mathrm{bulk,1}} - E_{\\mathrm{bulk,2}}}{A}\n$$\n能量的单位是焦耳 ($J$)，面积的单位是平方米 ($\\mathrm{m}^2$)，因此 $\\gamma_{\\mathrm{SL}}$ 的单位正确表示为 $\\mathrm{J/m^2}$。\n\n一个基本的物理原理指出，对于一个热力学稳定（或亚稳态）的平坦界面的存在，其形成在能量上必须是不利的，这意味着界面自由能必须是非负的 ($\\gamma_{\\mathrm{SL}} \\ge 0$)。负值意味着系统可以通过自发地产生更多界面面积来降低其总能量，从而导致不稳定（例如，完全混合或溶解）。因此，任何计算出的负的原始值都是计算或定义限制造成的人为结果，必须被视为真实界面能有效为零的情况。我们通过设置以下方式来强制施加这种物理约束：\n$$\n\\gamma_{\\mathrm{SL}} = \\max(0, \\gamma_{\\mathrm{SL, raw}})\n$$\n\n**2. 宏观接触角 ($\\theta$) 的计算**\n\n宏观接触角 $\\theta$ 是衡量液体对固体表面润湿性的一个指标。在固 (S)、液 (L)、汽 (V) 三相相交的三相接触线上，系统达到力学平衡。这种平衡由 Young's 方程描述，该方程平衡了界面张力的水平分量：\n$$\n\\gamma_{\\mathrm{SV}} = \\gamma_{\\mathrm{SL}} + \\gamma_{\\mathrm{LV}} \\cos\\theta\n$$\n在此，$\\gamma_{\\mathrm{SV}}$ 是固-汽表面能，$\\gamma_{\\mathrm{SL}}$ 是固-液界面能（在上一步中计算得出），而 $\\gamma_{\\mathrm{LV}}$ 是液-汽表面张力。\n\n为了求出接触角 $\\theta$，我们可以重排 Young's 方程：\n$$\n\\cos\\theta = \\frac{\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}}}{\\gamma_{\\mathrm{LV}}}\n$$\n余弦函数的数学共域是 $[-1, 1]$。然而，右侧的表达式并不能先验地保证会落在此范围内。我们必须考虑值超出此区间的物理含义：\n- 如果 $\\frac{\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}}}{\\gamma_{\\mathrm{LV}}}  1$，则意味着 $\\gamma_{\\mathrm{SV}}  \\gamma_{\\mathrm{SL}} + \\gamma_{\\mathrm{LV}}$。在这种情况下，当固体完全被液体覆盖时能量最低，这种情况被称为完全润湿。接触角为 $\\theta=0$，因此 $\\cos\\theta=1$。\n- 如果 $\\frac{\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}}}{\\gamma_{\\mathrm{LV}}}  -1$，则意味着 $\\gamma_{\\mathrm{SL}}  \\gamma_{\\mathrm{SV}} + \\gamma_{\\mathrm{LV}}$。这种情况（违反了表面能的三角不等式）描述了完全不润湿，此时液体形成与表面接触最小的球形液滴。接触角为 $\\theta=\\pi$，因此 $\\cos\\theta=-1$。\n\n为确保结果具有物理意义，计算出的 $\\cos\\theta$ 值必须被限制在区间 $[-1, 1]$ 内。设 $C = (\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}})/\\gamma_{\\mathrm{LV}}$。物理上有效的 $\\cos\\theta$ 值为：\n$$\n\\cos\\theta = \\mathrm{clamp}(C, -1, 1) = \\max(-1, \\min(1, C))\n$$\n然后，通过取反余弦，可以在 $[0, \\pi]$ 范围内唯一确定接触角 $\\theta$：\n$$\n\\theta = \\arccos\\left(\\frac{\\gamma_{\\mathrm{SV}} - \\gamma_{\\mathrm{SL}}}{\\gamma_{\\mathrm{LV}}}\\right)\n$$\n其中使用了经过适当限制的参数值。$\\theta$ 的结果以弧度表示。\n\n将要实现的算法，对于每个测试用例，将首先使用指定的能量和面积值计算 $\\gamma_{\\mathrm{SL}}$，同时强制其非负性。其次，它将使用这个 $\\gamma_{\\mathrm{SL}}$ 以及提供的 $\\gamma_{\\mathrm{SV}}$ 和 $\\gamma_{\\mathrm{LV}}$ 来计算 $\\cos\\theta$，将结果限制在 $[-1, 1]$ 内，最后通过反余弦函数计算 $\\theta$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the solid-liquid interfacial free energy (gamma_SL) and the\n    macroscopic contact angle (theta) from atomistic calculation data for\n    several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple:\n    # (E_interface, E_bulk1, E_bulk2, A, gamma_SV, gamma_LV)\n    # All units are SI units: energies in J, area in m^2, surface energies in J/m^2.\n    test_cases = [\n        # Case 1 (general case)\n        (1.801e-16, 1.000e-16, 8.000e-17, 1.0e-18, 0.13, 0.06),\n        # Case 2 (boundary case cos(theta) = 1)\n        (4.0016e-16, 2.500e-16, 1.500e-16, 2.0e-18, 0.12, 0.04),\n        # Case 3 (boundary case cos(theta) = -1)\n        (2.003e-16, 9.000e-17, 1.100e-16, 1.0e-18, 0.25, 0.05),\n        # Case 4 (edge case with negative raw gamma_SL)\n        (1.5549e-16, 1.234e-16, 3.210e-17, 1.0e-18, 0.20, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        e_interface, e_bulk1, e_bulk2, area, gamma_sv, gamma_lv = case\n\n        # Step 1: Compute the solid-liquid interfacial free energy (gamma_SL).\n        # gamma_SL_raw = (E_interface - E_bulk1 - E_bulk2) / A\n        gamma_sl_raw = (e_interface - e_bulk1 - e_bulk2) / area\n        \n        # Enforce the non-negativity constraint.\n        gamma_sl = max(0.0, gamma_sl_raw)\n\n        # Step 2: Map gamma_SL to the macroscopic contact angle (theta).\n        # cos(theta) = (gamma_SV - gamma_SL) / gamma_LV\n        cos_theta_raw = (gamma_sv - gamma_sl) / gamma_lv\n        \n        # Clamp cos(theta) to the physical interval [-1, 1].\n        cos_theta = np.clip(cos_theta_raw, -1.0, 1.0)\n        \n        # Compute theta in radians.\n        theta = np.arccos(cos_theta)\n        \n        results.append([gamma_sl, theta])\n\n    # Final print statement in the exact required format:\n    # [[gamma_sl_1,theta_1],[gamma_sl_2,theta_2],...]\n    # The string is built manually to avoid spaces introduced by str(list).\n    result_str = \",\".join([f\"[{g},{t}]\" for g, t in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在实际的电化学系统中，由于微观上的粗糙度，电极的真实表面积往往远大于其几何投影面积，这会显著影响电化学反应的速率。本练习将向您展示如何量化这一效应，即从表面的统计描述（如高度场的自相关函数）中推导出表面粗糙度因子（$R_{f}$）。最终，您将利用该因子来修正本征交换电流密度（$i_{0,\\mathrm{true}}$），得到一个可用于宏观连续介质模型的有效交换电流密度（$i_{0,\\mathrm{eff}}$），从而更准确地描述粗糙界面上的电荷转移过程。",
            "id": "3923658",
            "problem": "一项针对电池阴极-电解质界面的原子模拟报告了固体表面的高度场 $h(x,y)$，该表面被建模为零均值的平稳各向同性高斯随机场。其两点自协方差为 $C(r) = \\langle h(\\mathbf{0}) h(\\mathbf{r}) \\rangle = \\sigma^{2} \\exp\\!\\big(-r^{2}/(2\\xi^{2})\\big)$，其中 $r = |\\mathbf{r}|$，均方根粗糙度为 $\\sigma = 0.90~\\text{nm}$，横向相关长度为 $\\xi = 2.70~\\text{nm}$。一个连续介质电化学模型在几何表面上施加了 Butler–Volmer (BV) 边界条件，其交换电流密度 $i_{0}$ 定义为单位几何面积上的值。原子计算提供了界面上单位真实表面积的本征交换电流密度 $i_{0,\\mathrm{true}}$，在所关注的工作状态下，$i_{0,\\mathrm{true}} = 1.36~\\text{A m}^{-2}$。\n\n仅从高度图 $z = h(x,y)$ 的表面积几何定义和统计平稳性出发，在小斜坡假设下，推导有效粗糙度因子 $R_{f} = A_{\\mathrm{eff}}/A_{0}$，其中 $A_{\\mathrm{eff}}$ 是期望的真实表面积，$A_{0}$ 是投影的几何面积。然后使用 $R_{f}$ 对连续介质 BV 边界条件的交换电流密度进行缩放，即 $i_{0,\\mathrm{eff}} = R_{f}\\,i_{0,\\mathrm{true}}$。计算在给定 $\\sigma$、$\\xi$ 和 $i_{0,\\mathrm{true}}$ 下的 $i_{0,\\mathrm{eff}}$。将最终答案四舍五入至四位有效数字，并以 $\\text{A m}^{-2}$ 为单位表示。",
            "solution": "该问题要求基于原子模拟数据，为连续介质模型推导有效交换电流密度 $i_{0,\\mathrm{eff}}$。这包括两个主要步骤：首先，在小斜坡近似下推导表面粗糙度因子 $R_f$；其次，使用该因子对本征交换电流密度 $i_{0,\\mathrm{true}}$ 进行缩放。\n\n由高度场 $z=h(x,y)$ 定义的、投影在平面区域 $A_0$ 上的表面的真实表面积 $A_{\\mathrm{true}}$ 由以下面积分给出：\n$$A_{\\mathrm{true}} = \\iint_{A_0} \\sqrt{1 + \\left(\\frac{\\partial h}{\\partial x}\\right)^2 + \\left(\\frac{\\partial h}{\\partial y}\\right)^2} \\,dx\\,dy$$\n问题指出 $h(x,y)$ 是一个平稳随机场。有效表面积 $A_{\\mathrm{eff}}$ 是真实面积的统计期望值 $\\langle A_{\\mathrm{true}} \\rangle$。由于期望算子的线性和场的平稳性（这意味着 $h$ 及其导数的任何函数的期望值都与位置无关），我们可以写出：\n$$A_{\\mathrm{eff}} = \\left\\langle \\iint_{A_0} \\sqrt{1 + (\\partial_x h)^2 + (\\partial_y h)^2} \\,dx\\,dy \\right\\rangle = \\iint_{A_0} \\left\\langle \\sqrt{1 + (\\partial_x h)^2 + (\\partial_y h)^2} \\right\\rangle \\,dx\\,dy$$\n$$A_{\\mathrm{eff}} = A_0 \\left\\langle \\sqrt{1 + (\\partial_x h)^2 + (\\partial_y h)^2} \\right\\rangle$$\n有效粗糙度因子 $R_f$ 定义为有效面积与投影面积之比，$R_f = A_{\\mathrm{eff}}/A_0$。因此，\n$$R_f = \\left\\langle \\sqrt{1 + (\\partial_x h)^2 + (\\partial_y h)^2} \\right\\rangle$$\n我们被要求使用小斜坡假设，这意味着梯度 $\\partial_x h$ 和 $\\partial_y h$ 很小。这为平方根项的泰勒展开提供了依据。设 $u = (\\partial_x h)^2 + (\\partial_y h)^2$。对于小的 $u$，有 $\\sqrt{1+u} \\approx 1 + \\frac{1}{2}u$。将此代入 $R_f$ 的表达式中：\n$$R_f \\approx \\left\\langle 1 + \\frac{1}{2} \\left( (\\partial_x h)^2 + (\\partial_y h)^2 \\right) \\right\\rangle$$\n利用期望的线性性质，我们得到：\n$$R_f \\approx 1 + \\frac{1}{2} \\left( \\langle (\\partial_x h)^2 \\rangle + \\langle (\\partial_y h)^2 \\rangle \\right)$$\n项 $\\langle (\\partial_x h)^2 \\rangle$ 和 $\\langle (\\partial_y h)^2 \\rangle$ 是均方斜率。由于 $h$ 是一个零均值高斯随机场，其导数也是零均值高斯随机场。因此，这些项是斜率分量的方差。\n均方斜率可以与自协方差函数 $C(\\mathbf{r}) = \\langle h(\\mathbf{r}_0) h(\\mathbf{r}_0 + \\mathbf{r}) \\rangle$ 相关联。对于任何可微的平稳随机过程，导数的方差与自协方差函数在原点的二阶导数有关：\n$$\\langle (\\partial_x h)^2 \\rangle = -\\left[\\frac{\\partial^2 C(\\mathbf{r})}{\\partial x^2}\\right]_{\\mathbf{r}=\\mathbf{0}}$$\n$$\\langle (\\partial_y h)^2 \\rangle = -\\left[\\frac{\\partial^2 C(\\mathbf{r})}{\\partial y^2}\\right]_{\\mathbf{r}=\\mathbf{0}}$$\n题目说明表面是各向同性的，这意味着 $C(\\mathbf{r})$ 仅是模 $r=|\\mathbf{r}|$ 的函数。这表明统计特性在所有方向上都是相同的，所以 $\\langle (\\partial_x h)^2 \\rangle = \\langle (\\partial_y h)^2 \\rangle$。因此，我们可以写出：\n$$\\langle (\\partial_x h)^2 \\rangle + \\langle (\\partial_y h)^2 \\rangle = -\\left[\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)C(r)\\right]_{r=0} = -[\\nabla^2 C(r)]_{r=0}$$\n给定的自协方差函数是 $C(r) = \\sigma^2 \\exp(-r^2/(2\\xi^2))$。我们需要计算其拉普拉斯算子，$\\nabla^2 C(r) = \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dC}{dr}\\right) = C''(r) + \\frac{1}{r}C'(r)$。\n首先，我们计算 $C(r)$ 关于 $r$ 的一阶和二阶导数：\n$$C'(r) = \\frac{dC}{dr} = \\sigma^2 \\exp\\left(-\\frac{r^2}{2\\xi^2}\\right) \\cdot \\left(-\\frac{2r}{2\\xi^2}\\right) = -\\frac{\\sigma^2 r}{\\xi^2} \\exp\\left(-\\frac{r^2}{2\\xi^2}\\right)$$\n$$C''(r) = \\frac{d^2C}{dr^2} = -\\frac{\\sigma^2}{\\xi^2} \\left[ \\exp\\left(-\\frac{r^2}{2\\xi^2}\\right) + r \\cdot \\left(-\\frac{r}{\\xi^2}\\right)\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right) \\right] = -\\frac{\\sigma^2}{\\xi^2}\\left(1-\\frac{r^2}{\\xi^2}\\right)\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right)$$\n拉普拉斯算子为：\n$$\\nabla^2 C(r) = C''(r) + \\frac{C'(r)}{r} = -\\frac{\\sigma^2}{\\xi^2}\\left(1-\\frac{r^2}{\\xi^2}\\right)\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right) - \\frac{\\sigma^2}{\\xi^2}\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right)$$\n$$\\nabla^2 C(r) = -\\frac{\\sigma^2}{\\xi^2}\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right) \\left(1-\\frac{r^2}{\\xi^2} + 1\\right) = -\\frac{\\sigma^2}{\\xi^2}\\left(2-\\frac{r^2}{\\xi^2}\\right)\\exp\\left(-\\frac{r^2}{2\\xi^2}\\right)$$\n我们计算在 $r=0$ 处的拉普拉斯算子：\n$$[\\nabla^2 C(r)]_{r=0} = -\\frac{\\sigma^2}{\\xi^2}(2-0)\\exp(0) = -\\frac{2\\sigma^2}{\\xi^2}$$\n现在我们求均方斜率之和：\n$$\\langle (\\partial_x h)^2 \\rangle + \\langle (\\partial_y h)^2 \\rangle = -[\\nabla^2 C(r)]_{r=0} = -\\left(-\\frac{2\\sigma^2}{\\xi^2}\\right) = \\frac{2\\sigma^2}{\\xi^2}$$\n将此代回 $R_f$ 的表达式中：\n$$R_f \\approx 1 + \\frac{1}{2}\\left(\\frac{2\\sigma^2}{\\xi^2}\\right) = 1 + \\frac{\\sigma^2}{\\xi^2}$$\n这是在小斜坡近似下推导出的粗糙度因子表达式。\n\n接下来，我们使用给定的参数计算 $R_f$ 的数值：均方根粗糙度 $\\sigma = 0.90~\\text{nm}$ 和横向相关长度 $\\xi = 2.70~\\text{nm}$。\n$$R_f = 1 + \\left(\\frac{0.90}{2.70}\\right)^2 = 1 + \\left(\\frac{1}{3}\\right)^2 = 1 + \\frac{1}{9} = \\frac{10}{9}$$\n最后，我们使用关系式 $i_{0,\\mathrm{eff}} = R_{f}\\,i_{0,\\mathrm{true}}$ 计算有效交换电流密度 $i_{0,\\mathrm{eff}}$。给定的本征交换电流密度为 $i_{0,\\mathrm{true}} = 1.36~\\text{A m}^{-2}$。\n$$i_{0,\\mathrm{eff}} = \\frac{10}{9} \\times 1.36~\\text{A m}^{-2} = \\frac{13.6}{9}~\\text{A m}^{-2} \\approx 1.5111... ~\\text{A m}^{-2}$$\n题目要求将答案四舍五入到四位有效数字。\n$$i_{0,\\mathrm{eff}} \\approx 1.511~\\text{A m}^{-2}$$",
            "answer": "$$\\boxed{1.511}$$"
        }
    ]
}