{
    "hands_on_practices": [
        {
            "introduction": "The density of states (DOS) is a central concept in solid-state physics, providing a \"fingerprint\" of a material's electronic structure. This exercise provides fundamental practice in connecting the theoretical DOS, a primary output of DFT calculations, to a basic and verifiable physical quantity: the number of valence electrons in the system. By integrating the DOS up to the Fermi energy $E_F$, you will reinforce your understanding of how electronic states are occupied and build a foundational skill for analyzing DFT results for electrode materials .",
            "id": "3904873",
            "problem": "Consider an electrode material modeled within the spin-polarized Kohn–Sham formulation of Density Functional Theory (DFT), using collinear spin along a fixed axis. The spin channel index is $\\sigma \\in \\{\\uparrow,\\downarrow\\}$. Begin from first principles: the normalization of Kohn–Sham orbitals, the Pauli exclusion principle for occupancy, and the definition of the spin-resolved density of states (DOS) as the number of single-particle Kohn–Sham states per unit energy per unit cell. Use the standard equilibrium occupancy by the Fermi–Dirac distribution at temperature $T$ and chemical potential (Fermi energy) $E_{F}$, and then take the $T \\to 0$ limit.\n\nTask 1 (derivation): Derive, from the above bases, a general expression for the total valence electron count per unit cell as a functional of the spin-resolved DOS and the occupancy, and then write its zero-temperature specialization in terms of an energy integral up to $E_{F}$ over the spin-resolved DOS.\n\nTask 2 (application): Consider an idealized ferromagnetic cathode unit cell whose valence manifold is described by the following coarse-grained spin-resolved DOS functions (per unit cell), given relative to a fixed energy zero, with the Fermi energy located at $E_{F} = -1\\,\\mathrm{eV}$:\n- Spin-up DOS:\n  $D_{\\uparrow}(E) = 2\\,\\mathrm{eV}^{-1}$ for $E \\in [-5\\,\\mathrm{eV},-2\\,\\mathrm{eV}]$, $D_{\\uparrow}(E) = 1\\,\\mathrm{eV}^{-1}$ for $E \\in [-2\\,\\mathrm{eV},0\\,\\mathrm{eV}]$, and $D_{\\uparrow}(E)=0$ elsewhere.\n- Spin-down DOS:\n  $D_{\\downarrow}(E) = 1.5\\,\\mathrm{eV}^{-1}$ for $E \\in [-4\\,\\mathrm{eV},1\\,\\mathrm{eV}]$, and $D_{\\downarrow}(E)=0$ elsewhere.\n\nAssume zero temperature so that states with $E \\leq E_{F}$ are fully occupied and states with $E > E_{F}$ are empty in each spin channel. Using your derived relation, compute the total valence electron count per unit cell. Express your final result in electrons per unit cell. Give your final answer exactly, without rounding.",
            "solution": "The user has provided a problem in two parts. First, a derivation of the total valence electron count from the spin-resolved density of states (DOS) in Density Functional Theory (DFT). Second, an application of this derived formula to an idealized ferromagnetic material at zero temperature.\n\n### Problem Validation\n\nThe problem statement is validated according to the specified criteria.\n\n**Step 1: Extracted Givens**\n- System model: Spin-polarized Kohn–Sham DFT with collinear spin, index $\\sigma \\in \\{\\uparrow,\\downarrow\\}$.\n- Foundational principles: Normalization of Kohn–Sham orbitals, Pauli exclusion principle, and the definition of spin-resolved DOS, $D_{\\sigma}(E)$, as the number of states per unit energy per unit cell.\n- Statistics: Equilibrium occupancy governed by the Fermi–Dirac distribution $f(E, T, E_F)$ at temperature $T$ and chemical potential $E_F$.\n- Condition: The zero-temperature limit ($T \\to 0$) is to be applied.\n- Task 1: Derive the general expression for total valence electron count per unit cell, $N_{val}$, as a functional of $D_{\\sigma}(E)$ and occupancy, and then specialize it for $T=0$.\n- Task 2: For an idealized ferromagnetic cathode with $E_F = -1\\,\\mathrm{eV}$ and at $T=0$, compute $N_{val}$ using the given piecewise DOS functions:\n  - $D_{\\uparrow}(E) = 2\\,\\mathrm{eV}^{-1}$ for $E \\in [-5\\,\\mathrm{eV},-2\\,\\mathrm{eV}]$; $D_{\\uparrow}(E) = 1\\,\\mathrm{eV}^{-1}$ for $E \\in [-2\\,\\mathrm{eV},0\\,\\mathrm{eV}]$; and $D_{\\uparrow}(E)=0$ elsewhere.\n  - $D_{\\downarrow}(E) = 1.5\\,\\mathrm{eV}^{-1}$ for $E \\in [-4\\,\\mathrm{eV},1\\,\\mathrm{eV}]$; and $D_{\\downarrow}(E)=0$ elsewhere.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on standard, well-established principles of solid-state physics and DFT. All concepts are fundamental to the field.\n- **Well-Posed**: The problem is clearly stated. Task 1 is a standard derivation. Task 2 provides all necessary data (explicit forms for $D_{\\sigma}(E)$ and a value for $E_F$) to compute a unique solution.\n- **Objective**: The problem is formulated with precise, unambiguous scientific language.\n- **Consistency and Completeness**: The problem is self-contained and internally consistent. The provided DOS functions, though simplified, are mathematically and physically plausible for a toy model. The assumption of ferromagnetism ($D_{\\uparrow}(E) \\neq D_{\\downarrow}(E)$) is consistent with the provided data.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. The solution process will proceed.\n\n### Task 1: Derivation\n\nThe number of single-particle Kohn-Sham states for a given spin channel $\\sigma$ in an infinitesimal energy interval $[E, E+dE]$ within a unit cell is given by $D_{\\sigma}(E)dE$, where $D_{\\sigma}(E)$ is the spin-resolved density of states.\n\nAccording to the principles of quantum statistics, the probability that a state with energy $E$ is occupied by an electron is given by the Fermi–Dirac distribution function:\n$$ f(E, T, E_F) = \\frac{1}{\\exp\\left(\\frac{E-E_F}{k_B T}\\right) + 1} $$\nwhere $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $E_F$ is the Fermi energy (chemical potential).\n\nThe number of electrons of spin $\\sigma$ per unit cell in the energy interval $[E, E+dE]$, denoted $dN_{\\sigma}$, is the product of the number of available states and their occupation probability:\n$$ dN_{\\sigma} = f(E, T, E_F) D_{\\sigma}(E) dE $$\n\nTo find the total number of valence electrons with spin $\\sigma$, $N_{\\sigma}$, we must integrate this quantity over all possible energies:\n$$ N_{\\sigma} = \\int_{-\\infty}^{\\infty} dN_{\\sigma} = \\int_{-\\infty}^{\\infty} f(E, T, E_F) D_{\\sigma}(E) dE $$\n\nThe total number of valence electrons per unit cell, $N_{val}$, is the sum of the contributions from both spin channels, $\\sigma = \\uparrow$ and $\\sigma = \\downarrow$:\n$$ N_{val} = N_{\\uparrow} + N_{\\downarrow} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{\\infty} f(E, T, E_F) D_{\\sigma}(E) dE $$\nThis is the general expression for the total valence electron count as a functional of the spin-resolved DOS and the occupancy function.\n\nFor the zero-temperature specialization, we consider the limit $T \\to 0$. In this limit, the Fermi-Dirac distribution becomes a Heaviside step function, $\\Theta(E_F - E)$:\n$$ \\lim_{T \\to 0} f(E, T, E_F) = \\begin{cases} 1  \\text{if } E \\leq E_F \\\\ 0  \\text{if } E  E_F \\end{cases} $$\nThis reflects the Pauli exclusion principle at $T=0$: all states with energy less than or equal to the Fermi energy are fully occupied ($1$ electron per state, since we are already considering spin channels), and all states with energy greater than the Fermi energy are empty.\n\nSubstituting the zero-temperature occupancy function into the general expression for $N_{val}$ gives:\n$$ N_{val}(T=0) = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{\\infty} \\Theta(E_F - E) D_{\\sigma}(E) dE $$\nThe step function $\\Theta(E_F - E)$ is non-zero only for $E \\leq E_F$. Therefore, it effectively sets the upper limit of the integration to $E_F$:\n$$ N_{val} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{E_F} D_{\\sigma}(E) dE $$\nThis is the required zero-temperature specialization. This formula states that the total number of valence electrons per unit cell is the integral of the total DOS, $D_{total}(E) = D_{\\uparrow}(E) + D_{\\downarrow}(E)$, from $-\\infty$ up to the Fermi energy $E_F$.\n\n### Task 2: Application\n\nWe apply the derived zero-temperature formula to the given idealized ferromagnetic cathode.\nThe total valence electron count is $N_{val} = N_{\\uparrow} + N_{\\downarrow}$, where:\n$$ N_{\\uparrow} = \\int_{-\\infty}^{E_F} D_{\\uparrow}(E) dE \\quad \\text{and} \\quad N_{\\downarrow} = \\int_{-\\infty}^{E_F} D_{\\downarrow}(E) dE $$\nThe Fermi energy is given as $E_F = -1\\,\\mathrm{eV}$.\n\nFirst, we compute the number of spin-up electrons, $N_{\\uparrow}$. The DOS $D_{\\uparrow}(E)$ is piecewise. We split the integral over the intervals where $D_{\\uparrow}(E)$ is non-zero, up to the integration limit $E_F = -1\\,\\mathrm{eV}$.\nThe non-zero regions for $D_{\\uparrow}(E)$ are $[-5\\,\\mathrm{eV}, -2\\,\\mathrm{eV}]$ and $[-2\\,\\mathrm{eV}, 0\\,\\mathrm{eV}]$. The integration up to $E_F = -1\\,\\mathrm{eV}$ covers the entire first region and part of the second region.\n$$ N_{\\uparrow} = \\int_{-5\\,\\mathrm{eV}}^{-2\\,\\mathrm{eV}} (2\\,\\mathrm{eV}^{-1}) \\,dE + \\int_{-2\\,\\mathrm{eV}}^{-1\\,\\mathrm{eV}} (1\\,\\mathrm{eV}^{-1}) \\,dE $$\nEvaluating the integrals (the electron count is a dimensionless quantity):\n$$ N_{\\uparrow} = 2 \\times [E]_{-5}^{-2} + 1 \\times [E]_{-2}^{-1} $$\n$$ N_{\\uparrow} = 2 \\times ((-2) - (-5)) + 1 \\times ((-1) - (-2)) $$\n$$ N_{\\uparrow} = 2 \\times (3) + 1 \\times (1) $$\n$$ N_{\\uparrow} = 6 + 1 = 7 $$\nSo, there are $7$ spin-up valence electrons per unit cell.\n\nNext, we compute the number of spin-down electrons, $N_{\\downarrow}$. The DOS $D_{\\downarrow}(E)$ is non-zero in the interval $[-4\\,\\mathrm{eV}, 1\\,\\mathrm{eV}]$. The integration up to $E_F = -1\\,\\mathrm{eV}$ covers part of this region.\n$$ N_{\\downarrow} = \\int_{-4\\,\\mathrm{eV}}^{-1\\,\\mathrm{eV}} (1.5\\,\\mathrm{eV}^{-1}) \\,dE $$\nEvaluating the integral:\n$$ N_{\\downarrow} = 1.5 \\times [E]_{-4}^{-1} $$\n$$ N_{\\downarrow} = 1.5 \\times ((-1) - (-4)) $$\n$$ N_{\\downarrow} = 1.5 \\times (3) $$\n$$ N_{\\downarrow} = 4.5 $$\nSo, there are $4.5$ spin-down valence electrons per unit cell.\n\nFinally, the total valence electron count per unit cell, $N_{val}$, is the sum of the spin-up and spin-down contributions:\n$$ N_{val} = N_{\\uparrow} + N_{\\downarrow} = 7 + 4.5 = 11.5 $$\nThe total valence electron count per unit cell is $11.5$. A non-integer value is physically meaningful as it represents an average electron density within the defined volume of the unit cell in a periodic crystal. The difference between $N_{\\uparrow}$ and $N_{\\downarrow}$ results in a net spin magnetization, consistent with the material being ferromagnetic.",
            "answer": "$$\\boxed{11.5}$$"
        },
        {
            "introduction": "In many electrode materials, charge carriers like electrons or holes do not move freely but become \"trapped\" by self-inducing a local distortion in the crystal lattice, forming a quasiparticle known as a small polaron. This exercise challenges you to translate this physical picture into a quantitative, automatable diagnostic from the calculated charge density difference $\\Delta \\rho(\\mathbf{r})$ and atomic positions. You will learn to combine information from electronic and structural data to create a robust criterion for identifying polaron localization, a critical skill for understanding charge transport mechanisms in battery materials .",
            "id": "3904815",
            "problem": "You are tasked with designing and implementing a programmatic diagnostic to confirm small polaron localization in electrode materials using Density Functional Theory (DFT). The diagnostic must be grounded in the physical picture that a localized charge in a crystal produces a spatially concentrated change in electron density and induces local structural distortions. The task must begin from the following fundamental base: Kohn-Sham Density Functional Theory (DFT) defines the ground-state electron density $\\rho(\\mathbf{r})$ of an interacting electron system; the presence or removal of an electron produces a change $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\text{charged}}(\\mathbf{r}) - \\rho_{\\text{neutral}}(\\mathbf{r})$. A small polaron is a quasi-particle consisting of a charge localized over a small number of atomic sites together with a local lattice distortion due to electron–phonon coupling. From this base, derive a mathematically precise diagnostic that combines a measure of spatial localization of the charge density difference and a measure of local distortion magnitude. Implement this diagnostic in a program that takes discrete data and outputs a boolean per case indicating whether a polaron is localized.\n\nYou will work with a discrete approximation in which the domain is partitioned into $N$ disjoint basins or cells $\\{\\Omega_i\\}_{i=1}^N$. The charge difference per cell is defined as $\\Delta q_i = \\int_{\\Omega_i} \\Delta \\rho(\\mathbf{r})\\,\\mathrm{d}^3 r$ measured in electrons. Because both electron ($\\Delta q_i  0$) and hole ($\\Delta q_i  0$) polarons are possible, your localization measure must depend on $|\\Delta q_i|$. You are also given local bond lengths around the candidate polaron site for the reference (undistorted) and the relaxed (distorted) structures. Bond lengths are provided in angstroms and must be treated consistently as such.\n\nYour derived diagnostic must produce a boolean decision for each test case using the following thresholds, which you must apply to your derived measures without shortcutting their derivation:\n- The effective number of sites over which the charge is localized must be less than or equal to $S_{\\mathrm{max}} = 3.0$.\n- The average local bond-length distortion magnitude must be greater than or equal to $D_{\\mathrm{min}} = 0.02$.\n\nAngles are not involved. Bond lengths are in angstroms. Distortion is dimensionless by construction. The final output for each test case must be a boolean indicating whether both conditions are satisfied based on your derived measures.\n\nYour program must implement the diagnostic for the following test suite. Each test case provides $(N, \\{\\Delta q_i\\}_{i=1}^N, \\{d^{(0)}_j\\}_{j=1}^M, \\{d_j\\}_{j=1}^M)$ where $N$ is the number of cells, $\\Delta q_i$ are the per-cell charge differences in electrons, $d^{(0)}_j$ are the reference bond lengths in angstroms, and $d_j$ are the relaxed bond lengths in angstroms. The number of bonds $M$ equals $6$ for all cases.\n\n- Case A (happy path: electron polaron localized with significant distortion): $N = 12$, $\\{\\Delta q_i\\} = [0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ angstrom, $\\{d_j\\} = [2.10, 2.06, 1.94, 1.95, 2.00, 2.00]$ angstrom.\n- Case B (delocalized charge with minimal distortion): $N = 12$, $\\{\\Delta q_i\\} = [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ angstrom, $\\{d_j\\} = [2.01, 2.01, 1.99, 1.99, 2.00, 2.00]$ angstrom.\n- Case C (hole polaron localized with significant distortion): $N = 12$, $\\{\\Delta q_i\\} = [-0.02, -0.01, -0.01, -0.02, -0.02, -0.75, -0.08, -0.03, -0.02, 0.00, 0.00, -0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ angstrom, $\\{d_j\\} = [1.90, 1.95, 2.06, 2.05, 2.00, 2.00]$ angstrom.\n- Case D (borderline density localization but insufficient distortion): $N = 12$, $\\{\\Delta q_i\\} = [0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ angstrom, $\\{d_j\\} = [2.01, 2.00, 1.99, 2.00, 2.00, 2.00]$ angstrom.\n- Case E (two-site polaron with moderate distortion): $N = 12$, $\\{\\Delta q_i\\} = [0.00, 0.00, 0.00, 0.48, 0.48, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ angstrom, $\\{d_j\\} = [2.08, 2.06, 1.94, 1.94, 2.00, 2.00]$ angstrom.\n\nYour program must:\n- Derive from first principles a normalization of $\\{|\\Delta q_i|\\}$ to a discrete probability distribution over $N$ cells, a mathematically justified localization index based on this distribution, and a distortion metric based on the provided bond lengths.\n- Determine polaron localization as a boolean per case by checking whether the derived effective support size is less than or equal to $S_{\\mathrm{max}}$ and whether the derived average distortion is greater than or equal to $D_{\\mathrm{min}}$.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E]$.\n\nThe final output type for each case is a boolean. Bond lengths must be treated in angstroms. Distortion must be dimensionless. No angles are involved. The program must not read external files or take input and must operate only on the provided test suite.",
            "solution": "The problem statement has been analyzed and is deemed to be valid. It is scientifically grounded in the principles of Density Functional Theory and the physics of small polarons. The problem is well-posed, providing a self-contained set of data and clear objectives, requiring the derivation of physically meaningful metrics from first principles. The language is objective and the provided numerical data are physically plausible. The task is to derive a diagnostic and apply it, which constitutes a non-trivial but solvable problem in computational materials science.\n\nThe objective is to formulate a quantitative diagnostic for small polaron localization based on two criteria: the spatial localization of the charge density difference, $\\Delta\\rho(\\mathbf{r})$, and the magnitude of the associated local lattice distortion. We are given discrete data for charge and bond lengths and must produce a boolean decision for several test cases.\n\nFirst, we derive a metric for charge localization. The problem provides the net charge difference, $\\Delta q_i$, within $N$ discrete cells, where $\\Delta q_i = \\int_{\\Omega_i} \\Delta \\rho(\\mathbf{r})\\,\\mathrm{d}^3 r$. A localized polaron implies that the majority of the excess charge (for an electron polaron, $\\sum_i \\Delta q_i \\approx +1$) or charge deficit (for a hole polaron, $\\sum_i \\Delta q_i \\approx -1$) is concentrated in a small number of cells. To create a universal metric applicable to both electron and hole polarons, we must work with the magnitude of the charge difference, $|\\Delta q_i|$.\n\nWe can conceptualize the distribution of the charge change magnitude as a discrete probability distribution. Let us define a set of non-negative weights $w_i = |\\Delta q_i|$ for each cell $i=1, \\dots, N$. To form a probability distribution $\\{p_i\\}$, we normalize these weights:\n$$\np_i = \\frac{w_i}{\\sum_{k=1}^N w_k} = \\frac{|\\Delta q_i|}{\\sum_{k=1}^N |\\Delta q_k|}\n$$\nThis quantity $p_i$ represents the fraction of the total magnitude of charge redistribution occurring in cell $i$. By construction, $p_i \\ge 0$ and $\\sum_{i=1}^N p_i = 1$.\n\nA highly localized charge distribution corresponds to a probability distribution that is sharply peaked, whereas a delocalized charge corresponds to a uniform-like distribution. A standard and physically meaningful way to quantify the degree of localization of a distribution is through its information entropy. The Shannon entropy of the distribution $\\{p_i\\}$ is given by:\n$$\nH = -\\sum_{i=1}^N p_i \\ln p_i\n$$\nwhere the term $p_i \\ln p_i$ is taken to be $0$ if $p_i=0$. The entropy $H$ is minimal ($H=0$) for a perfectly localized distribution where all charge is in one cell ($p_k=1$ for some $k$, and $p_{i \\ne k}=0$). It is maximal ($H=\\ln N$) for a perfectly delocalized distribution where the charge is spread evenly across all $N$ cells ($p_i=1/N$ for all $i$).\n\nTo interpret this entropy as an \"effective number of sites\" over which the charge is spread, we define the localization index $S$ as the exponential of the entropy:\n$$\nS = \\exp(H) = \\exp\\left(-\\sum_{i=1}^N p_i \\ln p_i\\right)\n$$\nThis quantity, sometimes known as the perplexity or number of effective modes, ranges from $S=1$ for perfect localization on a single site to $S=N$ for perfect delocalization over $N$ sites. The first condition for polaron localization is that this effective number of sites must be below a given threshold, $S_{\\mathrm{max}}$:\n$$\nS \\le S_{\\mathrm{max}} = 3.0\n$$\n\nSecond, we derive a metric for the local lattice distortion. We are given $M$ reference bond lengths, $\\{d_j^{(0)}\\}_{j=1}^M$, and the corresponding bond lengths in the relaxed (charged) structure, $\\{d_j\\}_{j=1}^M$. The problem requires a dimensionless measure of the average distortion magnitude.\n\nFor each bond $j$, the change in length is $\\Delta d_j = d_j - d_j^{(0)}$. To make this change dimensionless and independent of the absolute bond length, we compute the fractional distortion:\n$$\n\\delta_j = \\frac{d_j - d_j^{(0)}}{d_j^{(0)}}\n$$\nSince distortion can involve both bond elongation ($\\delta_j  0$) and compression ($\\delta_j  0$), and we are interested in the overall magnitude of the structural change, we consider the absolute value of the fractional distortion, $|\\delta_j|$.\n\nTo obtain a single metric representing the average local distortion, we take the arithmetic mean of these magnitudes over all $M$ bonds:\n$$\nD = \\frac{1}{M}\\sum_{j=1}^M |\\delta_j| = \\frac{1}{M}\\sum_{j=1}^M \\left| \\frac{d_j - d_j^{(0)}}{d_j^{(0)}} \\right|\n$$\nThis metric $D$ is a dimensionless, positive-semidefinite quantity that quantifies the average magnitude of bond length changes around the polaron site. The second condition for polaron localization is that this average distortion must be above a given threshold, $D_{\\mathrm{min}}$:\n$$\nD \\ge D_{\\mathrm{min}} = 0.02\n$$\n\nThe final polaron diagnostic is a boolean AND of these two conditions. A system is determined to host a localized small polaron if and only if both the charge is sufficiently localized ($S \\le S_{\\mathrm{max}}$) and the lattice distortion is sufficiently large ($D \\ge D_{\\mathrm{min}}$). This combined criterion correctly captures the dual nature of the polaron as a quasiparticle of both charge and lattice-distortion character. The logic will now be implemented and applied to the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... # Scipy is available but not required for this implementation.\n\ndef solve():\n    \"\"\"\n    Derives and applies a diagnostic for small polaron localization based on DFT data.\n    The diagnostic evaluates two conditions:\n    1. Charge Localization: The effective number of sites for charge spread must be low.\n    2. Lattice Distortion: The average local bond distortion must be high.\n    A polaron is considered localized if both conditions are met.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"Case A\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.10, 2.06, 1.94, 1.95, 2.00, 2.00]),\n        },\n        \"Case B\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.01, 2.01, 1.99, 1.99, 2.00, 2.00]),\n        },\n        \"Case C\": {\n            \"N\": 12,\n            \"delta_q\": np.array([-0.02, -0.01, -0.01, -0.02, -0.02, -0.75, -0.08, -0.03, -0.02, 0.00, 0.00, -0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([1.90, 1.95, 2.06, 2.05, 2.00, 2.00]),\n        },\n        \"Case D\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.01, 2.00, 1.99, 2.00, 2.00, 2.00]),\n        },\n        \"Case E\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.00, 0.00, 0.00, 0.48, 0.48, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.08, 2.06, 1.94, 1.94, 2.00, 2.00]),\n        },\n    }\n\n    # Define thresholds from the problem statement\n    S_max = 3.0\n    D_min = 0.02\n\n    def check_polaron_localization(delta_q, d0, d):\n        \"\"\"\n        Calculates the localization index S and distortion metric D for a single case.\n        Returns a boolean indicating if the polaron is localized.\n        \"\"\"\n        # 1. Calculate the charge localization index S\n        abs_delta_q = np.abs(delta_q)\n        total_abs_q = np.sum(abs_delta_q)\n\n        # Handle the edge case of no charge difference\n        if total_abs_q == 0:\n            # If there's no charge, it's perfectly delocalized over all sites.\n            # Could be N, but this case isn't physically interesting for a polaron search.\n            # In any case, it's not localized on a few sites.\n            S = float('inf') \n        else:\n            p = abs_delta_q / total_abs_q\n            # Filter out p_i = 0 to avoid log(0) errors. The term p_i*log(p_i) is 0 for p_i=0.\n            p_nonzero = p[p > 0]\n            # Calculate Shannon entropy H\n            H = -np.sum(p_nonzero * np.log(p_nonzero))\n            # Calculate localization index S (effective number of sites)\n            S = np.exp(H)\n        \n        is_charge_localized = (S = S_max)\n\n        # 2. Calculate the lattice distortion metric D\n        # Use np.divide to handle potential division by zero if a bond length is 0,\n        # although physically d0 should always be positive.\n        fractional_distortion = np.divide(d - d0, d0)\n        D = np.mean(np.abs(fractional_distortion))\n        \n        is_distorted = (D >= D_min)\n\n        # 3. Final polaron diagnostic\n        is_polaron_localized = is_charge_localized and is_distorted\n        \n        return is_polaron_localized\n\n    results = []\n    # The order of cases must be preserved for the final output.\n    case_order = [\"Case A\", \"Case B\", \"Case C\", \"Case D\", \"Case E\"]\n    for case_name in case_order:\n        case_data = test_cases[case_name]\n        result = check_polaron_localization(case_data[\"delta_q\"], case_data[\"d0\"], case_data[\"d\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The output format for booleans in Python's str() is 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A primary goal of computational battery research is the accurate prediction of open-circuit voltage, a key performance metric. This advanced practice moves beyond simple zero-temperature energy differences and guides you through a complete workflow to calculate voltage at a finite temperature $T$. You will integrate DFT total energies with principles from statistical mechanics to account for vibrational free energies $F_{\\mathrm{vib}}(T)$ and configurational entropy $S_{\\mathrm{conf}}(x)$, demonstrating how to build a comprehensive thermodynamic model for realistic property prediction .",
            "id": "3904866",
            "problem": "You are asked to implement a principled computational workflow to include vibrational free energy and configurational entropy corrections into the finite-temperature Gibbs free energy $G(T)$ of lithium-intercalation electrode materials, and to use this to predict open-circuit voltages at finite temperature. The scenario is grounded in Density Functional Theory (DFT), a quantum mechanical method used to obtain $E_{\\mathrm{DFT}}$ total energies, and Statistical Mechanics for vibrational and configurational contributions. Your program must compute $G(T)$ for given compositions, combine it into a reaction free energy for a lithium insertion step using the chemical potential of lithium metal, and then translate this into a voltage.\n\nStart from the following foundational facts and definitions:\n- Gibbs free energy is defined as $G = U - T S + p V$. For condensed-phase solids at ambient conditions, the $pV$ term is negligible, so $G(T)$ can be approximated as $G(T) \\approx E_{\\mathrm{DFT}} + F_{\\mathrm{vib}}(T) - T S_{\\mathrm{conf}}(x)$, where $E_{\\mathrm{DFT}}$ is the total energy from Density Functional Theory, $F_{\\mathrm{vib}}(T)$ is the vibrational Helmholtz free energy at temperature $T$, and $S_{\\mathrm{conf}}(x)$ is the configurational entropy associated with lithium/vacancy mixing at fractional occupancy $x$ on a set of equivalent sites.\n- In the harmonic approximation for phonons, each normal mode with angular frequency $\\omega_i$ contributes to the vibrational Helmholtz free energy as\n$$\nF_{\\mathrm{vib}}(T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_i + k_B T \\ln\\left(1 - e^{-\\hbar \\omega_i / (k_B T)} \\right) \\right),\n$$\nwhere $k_B$ is the Boltzmann constant, and $\\hbar$ is the reduced Planck constant. If frequencies are provided in cycles per second $f_i$, then $\\omega_i = 2 \\pi f_i$.\n- For a binary ideal mixing of lithium and vacancy on $N_{\\mathrm{sites}}$ equivalent sites per formula unit, the configurational entropy is\n$$\nS_{\\mathrm{conf}}(x) = -k_B N_{\\mathrm{sites}} \\left[ x \\ln x + (1-x) \\ln (1-x) \\right],\n$$\nfor $0  x  1$, and $S_{\\mathrm{conf}}(0) = S_{\\mathrm{conf}}(1) = 0$ by continuity.\n- For the lithium insertion reaction from $x_2$ to $x_1$ in the host,\n$$\n\\Delta G(T) = G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T) - (x_1 - x_2)\\,\\mu_{\\mathrm{Li}}(T),\n$$\nwhere $\\mu_{\\mathrm{Li}}(T)$ is the chemical potential of lithium metal per atom (approximated via DFT and vibrational contributions), and\n$$\nG_{\\mathrm{host}}(x,T) = E_{\\mathrm{DFT}}^{\\mathrm{host}}(x) + F_{\\mathrm{vib}}^{\\mathrm{host}}(x,T) - T S_{\\mathrm{conf}}(x).\n$$\n- The open-circuit voltage at temperature $T$ is given by\n$$\nV(T) = -\\frac{\\Delta G(T)}{x_1 - x_2}.\n$$\nWhen all energies are tracked in electronvolts per formula unit and per atom, this expression yields the voltage in volts because $1\\,\\mathrm{eV}$ per electron corresponds to $1\\,\\mathrm{V}$.\n\nYour program must implement the above principles with the following numerical and physical inputs and conventions:\n- Use $k_B = 8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$ and $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$. Use $\\omega = 2\\pi f$ and $1\\,\\mathrm{THz} = 10^{12}\\,\\mathrm{Hz}$. All vibrational frequencies are given in terahertz (THz).\n- Host composition is parameterized by the lithium fraction $x$ per formula unit, with $N_{\\mathrm{sites}} = 1$ site per formula unit. Use the following Density Functional Theory (DFT) total energies for the host in electronvolts (per formula unit):\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.0) = -100.000\\,\\mathrm{eV}$,\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.5) = -102.500\\,\\mathrm{eV}$,\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.95) = -104.100\\,\\mathrm{eV}$,\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(1.0) = -104.200\\,\\mathrm{eV}$.\n- Vibrational frequencies (in THz) for the host at each composition $x$ (per formula unit, harmonic normal modes):\n    - For $x=0.0$: $[5.0,\\,8.0,\\,12.0,\\,15.0,\\,3.0,\\,7.0,\\,10.0,\\,14.0,\\,18.0]$,\n    - For $x=0.5$: $[4.5,\\,7.5,\\,11.5,\\,14.5,\\,2.5,\\,6.5,\\,9.5,\\,13.5,\\,17.0]$,\n    - For $x=0.95$: $[4.2,\\,7.0,\\,11.0,\\,14.0,\\,2.2,\\,6.2,\\,9.2,\\,13.2,\\,16.5]$,\n    - For $x=1.0$: $[4.0,\\,6.8,\\,10.8,\\,13.8,\\,2.0,\\,6.0,\\,9.0,\\,13.0,\\,16.0]$.\n- Lithium metal (per atom) DFT energy and vibrational frequencies (in THz):\n    - $E_{\\mathrm{DFT}}^{\\mathrm{Li}} = -1.600\\,\\mathrm{eV}$,\n    - frequencies $[2.0,\\,4.0,\\,6.0]$.\n\nAlgorithmic requirements:\n- Implement a robust evaluation of $F_{\\mathrm{vib}}(T)$ that returns the zero-point energy $\\sum_i \\frac{1}{2}\\hbar\\omega_i$ at $T=0$, and otherwise uses the full harmonic free energy expression. Avoid numerical issues by implementing a threshold for very small $T$.\n- Implement $S_{\\mathrm{conf}}(x)$ with numerically stable handling of $x=0$ and $x=1$ so that $S_{\\mathrm{conf}}(0)=S_{\\mathrm{conf}}(1)=0$.\n\nTest Suite:\nCompute voltages in volts (V), rounded to six decimal places, for the following four cases:\n1. $T = 300\\,\\mathrm{K}$, $x_2=0.0$, $x_1=0.5$.\n2. $T = 1\\,\\mathrm{K}$, $x_2=0.0$, $x_1=0.5$.\n3. $T = 1000\\,\\mathrm{K}$, $x_2=0.5$, $x_1=1.0$.\n4. $T = 300\\,\\mathrm{K}$, $x_2=0.95$, $x_1=1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[v_1,v_2,v_3,v_4]$), where each $v_i$ is the predicted voltage in volts rounded to six decimal places. No other text should be printed. All internal computations must use the provided constants and units consistently, and the final answers must be expressed in $\\mathrm{V}$.",
            "solution": "The problem requires the implementation of a computational workflow to determine the open-circuit voltage of a lithium-intercalation electrode at finite temperatures. The methodology is rooted in the principles of density functional theory (DFT) for total energy calculations and statistical mechanics for thermal and entropic contributions to the Gibbs free energy. The solution will be constructed following a rigorous, step-by-step derivation based on the provided physical models and data.\n\nThe Gibbs free energy, $G(T)$, for a solid phase at temperature $T$ under negligible pressure is approximated by the Helmholtz free energy, $A(T) = U - TS$. In our model, this is further decomposed as:\n$$\nG(T) \\approx G(x,T) = E_{\\mathrm{DFT}}(x) + F_{\\mathrm{vib}}(x,T) - T S_{\\mathrm{conf}}(x)\n$$\nHere, $x$ is the fractional occupancy of lithium, $E_{\\mathrm{DFT}}(x)$ is the static total energy at $T=0\\,\\mathrm{K}$ obtained from DFT, $F_{\\mathrm{vib}}(x,T)$ is the vibrational Helmholtz free energy, and $S_{\\mathrm{conf}}(x)$ is the configurational entropy arising from the statistical arrangement of lithium ions and vacancies.\n\nThe computational procedure is structured as follows:\n\n1.  **Modeling of Thermodynamic Quantities:** We first establish robust functions to compute the constituent thermodynamic quantities for any given composition and temperature.\n\n    -   **Vibrational Helmholtz Free Energy, $F_{\\mathrm{vib}}(T)$:** Within the harmonic approximation, the vibrational free energy for a set of normal modes with angular frequencies $\\{\\omega_i\\}$ is given by:\n        $$\n        F_{\\mathrm{vib}}(T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_i + k_B T \\ln\\left(1 - e^{-\\hbar \\omega_i / (k_B T)} \\right) \\right)\n        $$\n        The first term, $\\sum_i \\frac{1}{2}\\hbar \\omega_i$, is the temperature-independent zero-point energy (ZPE). The second term represents the thermal contribution to the free energy. The implementation must handle the conversion of input frequencies $f_i$ (in THz) to angular frequencies $\\omega_i = 2 \\pi f_i$. Numerically, for very small $T$, the argument of the logarithm approaches $0$, which can lead to instability. At $T \\to 0\\,\\mathrm{K}$, the logarithmic term vanishes, and $F_{\\mathrm{vib}}(0)$ correctly reduces to the ZPE. Our implementation respects this limit and uses numerically stable library functions (i.e., `numpy.log1p`) to evaluate the logarithmic term accurately. The physical constants used are the Boltzmann constant $k_B=8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$ and the reduced Planck constant $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$.\n\n    -   **Configurational Entropy, $S_{\\mathrm{conf}}(x)$:** For an ideal solid solution of lithium and vacancies on $N_{\\mathrm{sites}}$ equivalent sites per formula unit, the configurational entropy is given by the Boltzmann formula for mixing:\n        $$\n        S_{\\mathrm{conf}}(x) = -k_B N_{\\mathrm{sites}} \\left[ x \\ln x + (1-x) \\ln (1-x) \\right]\n        $$\n        This expression is valid for $x \\in (0,1)$. For the pure phases, $x=0$ and $x=1$, there is no configurational disorder, so $S_{\\mathrm{conf}}(0)=S_{\\mathrm{conf}}(1)=0$. The implementation must explicitly handle these endpoint conditions to avoid numerical errors from evaluating $\\ln(0)$. The problem specifies $N_{\\mathrm{sites}} = 1$.\n\n2.  **Calculation of Chemical Potentials and Gibbs Free Energies:**\n\n    -   **Chemical Potential of Lithium Metal, $\\mu_{\\mathrm{Li}}(T)$:** The reference for the lithium chemical potential is taken as pure lithium metal. Its Gibbs free energy per atom is calculated as:\n        $$\n        \\mu_{\\mathrm{Li}}(T) = G_{\\mathrm{Li}}(T) = E_{\\mathrm{DFT}}^{\\mathrm{Li}} + F_{\\mathrm{vib}}^{\\mathrm{Li}}(T)\n        $$\n        Here, $E_{\\mathrm{DFT}}^{\\mathrm{Li}}$ and the vibrational frequencies for Li metal are provided. The configurational entropy for a pure element is zero.\n\n    -   **Gibbs Free Energy of the Host Material, $G_{\\mathrm{host}}(x,T)$:** Using the functions developed in the first step and the provided DFT energies and vibrational frequencies for the host material at various compositions $x$, we compute the total Gibbs free energy per formula unit:\n        $$\n        G_{\\mathrm{host}}(x,T) = E_{\\mathrm{DFT}}^{\\mathrm{host}}(x) + F_{\\mathrm{vib}}^{\\mathrm{host}}(x,T) - T S_{\\mathrm{conf}}(x)\n        $$\n\n3.  **Determination of the Open-Circuit Voltage:** The electromotive force, or open-circuit voltage ($V$), is determined by the change in Gibbs free energy for the electrochemical reaction. For the insertion of $(x_1 - x_2)$ moles of lithium into the host material, the reaction is $\\mathrm{Host}(x_2) + (x_1 - x_2)\\mathrm{Li} \\rightarrow \\mathrm{Host}(x_1)$. The change in Gibbs free energy for this process is:\n    $$\n    \\Delta G(T) = G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T) - (x_1 - x_2)\\,\\mu_{\\mathrm{Li}}(T)\n    $$\n    The voltage is the negative of the free energy change per mole of charge transferred. With all energies in electronvolts (eV) and considering the transfer of $(x_1 - x_2)$ electrons (for $(x_1 - x_2)$ Li$^+$ ions), the voltage in volts (V) is:\n    $$\n    V(T) = -\\frac{\\Delta G(T)}{x_1 - x_2} = -\\left( \\frac{G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T)}{x_1 - x_2} - \\mu_{\\mathrm{Li}}(T) \\right)\n    $$\n    The term $\\frac{G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T)}{x_1 - x_2}$ is a finite-difference approximation of the chemical potential of lithium in the host, $\\mu_{\\mathrm{Li}}^{\\mathrm{host}}(T)$.\n\nThe final program implements this entire workflow. It defines the physical constants and input data, implements the functions for $F_{\\mathrm{vib}}(T)$ and $S_{\\mathrm{conf}}(x)$, and then combines them to calculate $G_{\\mathrm{host}}(x,T)$ and $\\mu_{\\mathrm{Li}}(T)$. Finally, it iterates through the specified test cases, computes the voltage for each, rounds the result to six decimal places, and prints the formatted output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes open-circuit voltages at finite temperature for a Li-intercalation electrode.\n    The calculation is based on DFT total energies and statistical mechanics for\n    vibrational and configurational contributions to the Gibbs free energy.\n    \"\"\"\n\n    # Define the physical constants provided in the problem statement.\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    hbar = 6.582119569e-16 # Reduced Planck constant in eV*s\n\n    # Define the input data for the host material.\n    E_dft_host = {\n        0.0: -100.000,\n        0.5: -102.500,\n        0.95: -104.100,\n        1.0: -104.200,\n    }\n    freqs_host = {\n        0.0: np.array([5.0, 8.0, 12.0, 15.0, 3.0, 7.0, 10.0, 14.0, 18.0]),\n        0.5: np.array([4.5, 7.5, 11.5, 14.5, 2.5, 6.5, 9.5, 13.5, 17.0]),\n        0.95: np.array([4.2, 7.0, 11.0, 14.0, 2.2, 6.2, 9.2, 13.2, 16.5]),\n        1.0: np.array([4.0, 6.8, 10.8, 13.8, 2.0, 6.0, 9.0, 13.0, 16.0]),\n    }\n    N_sites = 1\n\n    # Define the input data for Lithium metal.\n    E_dft_li = -1.600\n    freqs_li = np.array([2.0, 4.0, 6.0])\n\n    def calculate_F_vib(T, freqs_thz):\n        \"\"\"\n        Calculates the vibrational Helmholtz free energy F_vib(T) in the harmonic approximation.\n        \n        Args:\n            T (float): Temperature in Kelvin.\n            freqs_thz (np.ndarray): Array of vibrational frequencies in THz.\n\n        Returns:\n            float: Vibrational free energy in eV.\n        \"\"\"\n        # omega = 2 * pi * f\n        omegas = 2 * np.pi * freqs_thz * 1e12  # Angular frequencies in rad/s\n\n        # Zero-point energy (ZPE) = sum(0.5 * hbar * omega)\n        zpe = 0.5 * hbar * np.sum(omegas)\n\n        # At T=0, F_vib is just the ZPE. Use a small threshold for numerical stability.\n        if T  1e-6:\n            return zpe\n\n        # Thermal contribution to free energy\n        k_B_T = k_B * T\n        hbar_omegas = hbar * omegas\n        \n        # Argument of the exponential: x = hbar * omega / (k_B * T)\n        # Avoid division by zero if k_B_T is zero, though already handled by T check.\n        exponents = hbar_omegas / k_B_T\n        \n        # Use np.log1p for better numerical precision for log(1-y) where y is small.\n        # log(1 - exp(-x)) = log1p(-exp(-x))\n        thermal_terms = k_B_T * np.log1p(-np.exp(-exponents))\n        thermal_F = np.sum(thermal_terms)\n        \n        return zpe + thermal_F\n\n    def calculate_S_conf(x):\n        \"\"\"\n        Calculates the configurational entropy S_conf(x) for ideal binary mixing.\n\n        Args:\n            x (float): Lithium fraction, between 0 and 1.\n\n        Returns:\n            float: Configurational entropy in eV/K.\n        \"\"\"\n        # For pure phases (x=0 or x=1), entropy is 0. Use tolerance for float comparison.\n        if x  1e-9 or x > (1.0 - 1e-9):\n            return 0.0\n        \n        return -k_B * N_sites * (x * np.log(x) + (1 - x) * np.log(1 - x))\n\n    def calculate_G_host(x, T):\n        \"\"\"\n        Calculates the Gibbs free energy G(x, T) for the host material.\n        \n        Args:\n            x (float): Lithium fraction.\n            T (float): Temperature in Kelvin.\n            \n        Returns:\n            float: Gibbs free energy in eV.\n        \"\"\"\n        E_dft = E_dft_host[x]\n        freqs = freqs_host[x]\n        \n        F_vib = calculate_F_vib(T, freqs)\n        S_conf = calculate_S_conf(x)\n        \n        return E_dft + F_vib - T * S_conf\n\n    def calculate_mu_li(T):\n        \"\"\"\n        Calculates the chemical potential mu(T) for lithium metal.\n\n        Args:\n            T (float): Temperature in Kelvin.\n\n        Returns:\n            float: Chemical potential of Li metal in eV/atom.\n        \"\"\"\n        F_vib = calculate_F_vib(T, freqs_li)\n        # S_conf for a pure element is 0.\n        return E_dft_li + F_vib\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (300, 0.0, 0.5),   # Case 1\n        (1, 0.0, 0.5),     # Case 2\n        (1000, 0.5, 1.0),  # Case 3\n        (300, 0.95, 1.0),  # Case 4\n    ]\n\n    results = []\n    for T, x2, x1 in test_cases:\n        # Calculate Gibbs free energies for the host at initial and final compositions\n        G_host_x1 = calculate_G_host(x1, T)\n        G_host_x2 = calculate_G_host(x2, T)\n        \n        # Calculate the chemical potential of the Li reservoir\n        mu_li_T = calculate_mu_li(T)\n        \n        # Calculate the change in Gibbs free energy for the reaction\n        delta_x = x1 - x2\n        delta_G = G_host_x1 - G_host_x2 - delta_x * mu_li_T\n        \n        # Calculate the voltage\n        voltage = -delta_G / delta_x\n        \n        # Round to six decimal places as specified\n        results.append(round(voltage, 6))\n\n    # Format the final list of results into the required output string.\n    # Using .6f ensures that numbers like 2.0 are printed as 2.000000.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}