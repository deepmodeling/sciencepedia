{
    "hands_on_practices": [
        {
            "introduction": "Understanding the origin and magnitude of stress is the first step in predicting particle fracture. This practice explores the fundamental coupling between chemical diffusion and mechanical stress in a constrained material, a core concept in chemo-mechanics. By performing a nondimensional analysis, you will identify a critical material parameter group that governs stress generation and use it to compare the intrinsic fracture susceptibility of common anode materials like graphite and silicon .",
            "id": "3937828",
            "problem": "A single-crystal active material undergoes lithiation-induced swelling that couples diffusional transport and stress generation. Consider an isotropic, linearly elastic solid in a thin-film or locally equi-biaxial in-plane stress state appropriate to a particle surface layer, where the in-plane constraint produces the dominant tensile stress that drives cracking. The mechanics are governed by mechanical equilibrium, $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$, and generalized Hooke’s law with an isotropic chemical eigenstrain. The chemistry is governed by mass conservation $\\partial c/\\partial t + \\nabla \\cdot \\boldsymbol{J} = 0$ and Onsager transport $\\boldsymbol{J} = - M_{c} \\nabla \\mu$, where the chemical potential includes stress coupling as in the Larché–Cahn framework, $\\mu = \\mu_{\\mathrm{chem}}(c) + \\chi\\, \\sigma_{h}$, with $\\sigma_{h}$ the hydrostatic stress and $\\chi$ a constant coupling coefficient. Let the isotropic chemical eigenstrain be $\\boldsymbol{\\epsilon}^{*}(c) = \\Omega\\, c\\, \\boldsymbol{I}$, where $\\Omega$ is the linear chemical expansion coefficient (strain per unit concentration) and $c$ is the intercalant concentration.\n\nStarting from these governing statements and standard kinematics $\\boldsymbol{\\epsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}})$, perform a nondimensionalization that uses:\n- a characteristic length $L$,\n- a characteristic time $t_{D} = L^{2}/D$ with $D$ a representative diffusivity,\n- a concentration scale $c_{0} = c_{\\max}$,\n- a displacement scale $u_{0} = L\\, \\Omega\\, c_{\\max}$,\n- and a stress scale $\\sigma_{0}$ to be chosen to eliminate material prefactors in the elastic constitutive relation for the in-plane stress state.\n\nIdentify the single combination of material parameters that sets the characteristic lithiation-induced stress amplitude controlling crack initiation in this constrained in-plane state. Write this combination explicitly in terms of $\\Omega$, $c_{\\max}$, $E$, and $\\nu$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio, and interpret it physically.\n\nThen, using the data below, compute its magnitude for fully lithiated graphite and silicon. Express your answers in gigapascals (GPa) and round to three significant figures.\n\nUse the following representative properties at room temperature:\n- Graphite: $E = 10\\,\\mathrm{GPa}$, $\\nu = 0.30$, $\\Omega\\, c_{\\max} = 0.030$.\n- Silicon: $E = 90\\,\\mathrm{GPa}$, $\\nu = 0.22$, $\\Omega\\, c_{\\max} = 0.60$.\n\nState any additional assumptions you make and ensure all steps in your nondimensionalization are clearly justified from the listed fundamental laws and core definitions. The final result to report is the numeric value of the identified combination for graphite and silicon, in GPa, rounded to three significant figures. No other quantities are required in the final answer.",
            "solution": "The problem requires the derivation of a characteristic stress scale for lithiation-induced stress in a constrained thin layer of an active material, followed by its calculation for graphite and silicon. The derivation will begin from the fundamental principles of continuum chemo-mechanics provided.\n\nFirst, we establish the constitutive relationship between stress, strain, and concentration. The total strain $\\boldsymbol{\\epsilon}$ is the sum of the elastic strain $\\boldsymbol{\\epsilon}^{e}$ and the chemical eigenstrain (swelling strain) $\\boldsymbol{\\epsilon}^{*}$, so $\\boldsymbol{\\epsilon} = \\boldsymbol{\\epsilon}^{e} + \\boldsymbol{\\epsilon}^{*}$. The chemical eigenstrain is given as isotropic: $\\boldsymbol{\\epsilon}^{*}(c) = \\Omega c \\boldsymbol{I}$, where $\\Omega$ is the chemical expansion coefficient, $c$ is the intercalant concentration, and $\\boldsymbol{I}$ is the identity tensor. In index notation, this is $\\epsilon^{*}_{ij} = \\Omega c \\delta_{ij}$.\n\nThe elastic strain $\\boldsymbol{\\epsilon}^{e}$ is related to the stress $\\boldsymbol{\\sigma}$ by the generalized Hooke's law for an isotropic, linearly elastic solid. The inverted form, expressing strain as a function of stress, is:\n$$ \\epsilon^{e}_{ij} = \\frac{1+\\nu}{E} \\sigma_{ij} - \\frac{\\nu}{E} \\sigma_{kk} \\delta_{ij} $$\nwhere $E$ is Young's modulus, $\\nu$ is Poisson's ratio, and $\\sigma_{kk}$ is the trace of the stress tensor (sum of diagonal components), which is proportional to the hydrostatic stress $\\sigma_h = \\sigma_{kk}/3$.\n\nCombining these relations, we express the total strain in terms of stress and concentration:\n$$ \\epsilon_{ij} = \\epsilon^{e}_{ij} + \\epsilon^{*}_{ij} = \\left( \\frac{1+\\nu}{E} \\sigma_{ij} - \\frac{\\nu}{E} \\sigma_{kk} \\delta_{ij} \\right) + \\Omega c \\delta_{ij} $$\n\nNext, we apply the specific conditions described in the problem: a \"thin-film or locally equi-biaxial in-plane stress state\" with an \"in-plane constraint\". This physical description is modeled with the following set of formal assumptions:\n1.  The state is one of plane stress, which is appropriate for a thin layer. We define the plane of the layer as the $x$-$y$ plane, so the stress component normal to the surface is zero: $\\sigma_{zz} = 0$. The in-plane shear stresses are also zero due to symmetry: $\\sigma_{xy}=\\sigma_{yx}=0$.\n2.  The in-plane stress is equi-biaxial, meaning $\\sigma_{xx} = \\sigma_{yy} = \\sigma_{\\parallel}$.\n3.  The \"in-plane constraint\" means the layer is prevented from expanding or contracting within the plane. This corresponds to zero total in-plane strain: $\\epsilon_{xx} = \\epsilon_{yy} = 0$.\n\nWith these assumptions, the trace of the stress tensor becomes $\\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz} = \\sigma_{\\parallel} + \\sigma_{\\parallel} + 0 = 2\\sigma_{\\parallel}$.\n\nNow, we apply these conditions to the constitutive equation for an in-plane component, for example, the $x$-component ($i=j=x$):\n$$ \\epsilon_{xx} = \\frac{1+\\nu}{E} \\sigma_{xx} - \\frac{\\nu}{E} \\sigma_{kk} + \\Omega c $$\nSubstituting $\\epsilon_{xx}=0$, $\\sigma_{xx}=\\sigma_{\\parallel}$, and $\\sigma_{kk}=2\\sigma_{\\parallel}$:\n$$ 0 = \\frac{1+\\nu}{E} \\sigma_{\\parallel} - \\frac{\\nu}{E} (2\\sigma_{\\parallel}) + \\Omega c $$\nWe can now solve for the in-plane stress $\\sigma_{\\parallel}$:\n$$ 0 = \\frac{\\sigma_{\\parallel}}{E} ((1+\\nu) - 2\\nu) + \\Omega c $$\n$$ 0 = \\frac{\\sigma_{\\parallel}}{E} (1-\\nu) + \\Omega c $$\n$$ \\sigma_{\\parallel} = - \\frac{E \\Omega c}{1-\\nu} $$\nThis equation gives the stress generated in the layer as a function of the intercalant concentration $c$ and the material properties.\n\nThe problem asks for a nondimensionalization using a characteristic stress scale $\\sigma_0$ that eliminates material prefactors. Let us define the dimensionless stress $\\bar{\\sigma} = \\sigma_{\\parallel}/\\sigma_0$ and the dimensionless concentration $\\bar{c} = c/c_{\\max}$. Substituting these into the derived equation for $\\sigma_{\\parallel}$:\n$$ \\bar{\\sigma} \\sigma_0 = - \\frac{E \\Omega (c_{\\max} \\bar{c})}{1-\\nu} $$\nRearranging for the dimensionless stress $\\bar{\\sigma}$:\n$$ \\bar{\\sigma} = - \\left( \\frac{E \\Omega c_{\\max}}{(1-\\nu)\\sigma_0} \\right) \\bar{c} $$\nTo eliminate the material prefactor, the term in the parenthesis must be set to unity. This choice defines the characteristic stress scale $\\sigma_0$:\n$$ \\sigma_0 = \\frac{E \\Omega c_{\\max}}{1-\\nu} $$\nThis is the single combination of material parameters that sets the characteristic lithiation-induced stress amplitude.\n\nPhysically, the term $\\Omega c_{\\max}$ represents the maximum linear strain the material would experience due to chemical changes if it were completely unconstrained. The term $E/(1-\\nu)$ is the biaxial modulus, which represents the material's elastic stiffness under equi-biaxial deformation in a plane stress condition. Therefore, $\\sigma_0$ is the magnitude of the stress generated when the material's maximum potential for chemical swelling is perfectly opposed by an in-plane mechanical constraint. It is a critical parameter for predicting fracture, as cracking initiates when the generated stress exceeds the material's fracture strength.\n\nFinally, we compute the magnitude of this characteristic stress for graphite and silicon using the provided data.\n\nFor graphite:\n$E = 10\\,\\mathrm{GPa}$, $\\nu = 0.30$, and the maximum chemical strain $\\Omega c_{\\max} = 0.030$.\n$$ \\sigma_{0, \\text{graphite}} = \\frac{(10\\,\\mathrm{GPa}) \\times 0.030}{1 - 0.30} = \\frac{0.30}{0.70}\\,\\mathrm{GPa} \\approx 0.42857\\,\\mathrm{GPa} $$\nRounding to three significant figures, the stress is $0.429\\,\\mathrm{GPa}$.\n\nFor silicon:\n$E = 90\\,\\mathrm{GPa}$, $\\nu = 0.22$, and the maximum chemical strain $\\Omega c_{\\max} = 0.60$.\n$$ \\sigma_{0, \\text{silicon}} = \\frac{(90\\,\\mathrm{GPa}) \\times 0.60}{1 - 0.22} = \\frac{54}{0.78}\\,\\mathrm{GPa} \\approx 69.2307\\,\\mathrm{GPa} $$\nRounding to three significant figures, the stress is $69.2\\,\\mathrm{GPa}$.\n\nThe large difference in the characteristic stress (a factor of over $160$) highlights why silicon electrodes are far more susceptible to fracture and mechanical degradation during cycling compared to graphite electrodes.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.429 & 69.2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "To simulate fracture, we need a mathematical model that describes how a material separates under load. This exercise introduces the bilinear cohesive zone model, a widely used tool in computational fracture mechanics that defines a relationship between the traction across a potential crack plane and its opening displacement. You will learn how to calibrate the parameters of this model using experimentally measurable properties like tensile strength and fracture energy, bridging the gap between physical testing and simulation inputs .",
            "id": "3937879",
            "problem": "A Lithium Nickel Manganese Cobalt Oxide (NMC) secondary particle is modeled for crack initiation using a cohesive zone in an automated battery design and simulation workflow. The normal traction–separation relation is taken as a bilinear cohesive law: an initial linear elastic branch with normal penalty stiffness $K_{n}$ up to a peak traction (tensile strength) $\\sigma_{\\max}$ at separation $\\delta_{0}$, followed by a linear softening branch to zero traction at a critical separation $\\delta_{c}$. The measured material properties for the particle are a tensile strength $\\sigma_{\\max} = 1.5 \\times 10^{8}\\ \\mathrm{Pa}$ and a mode-I fracture energy $G_{c} = 30\\ \\mathrm{J/m^{2}}$. The numerical implementation requires choosing a penalty stiffness; take $K_{n} = 6.0 \\times 10^{15}\\ \\mathrm{N/m^{3}}$.\n\nStarting from fundamental definitions of work of separation per unit area for cohesive fracture and the geometry of the traction–separation curve, derive the expressions needed to calibrate the bilinear law parameters $\\delta_{0}$ and $\\delta_{c}$ in terms of $K_{n}$, $\\sigma_{\\max}$, and $G_{c}$. Then, consider the limiting case where the initial elastic branch is infinitely stiff and the cohesive law reduces to a single linear softening branch beginning at zero separation. Under this limiting linear softening law, compute the critical separation $\\delta_{c}$ using the same measured $\\sigma_{\\max}$ and $G_{c}$.\n\nExpress the final $\\delta_{c}$ for the limiting linear softening law in meters and round your answer to three significant figures.",
            "solution": "### Solution Derivation\n\nThe problem requires the derivation of parameters for a bilinear cohesive law and the calculation of one of these parameters under a limiting condition.\n\n#### Part 1: Derivation of Bilinear Law Parameters\nThe bilinear traction-separation law consists of two linear segments. Let $T$ be the traction and $\\delta$ be the separation.\n\n1.  **Initial Linear Elastic Branch:** For separations from $\\delta=0$ to $\\delta=\\delta_{0}$, the traction increases linearly with separation. The constant of proportionality is the penalty stiffness, $K_{n}$.\n    $$T(\\delta) = K_{n} \\delta \\quad \\text{for } 0 \\le \\delta \\le \\delta_{0}$$\n    At the end of this branch, the separation is $\\delta_{0}$ and the traction reaches its maximum value, $\\sigma_{\\max}$.\n    $$\\sigma_{\\max} = K_{n} \\delta_{0}$$\n    Solving for $\\delta_{0}$ provides the first required expression:\n    $$\\delta_{0} = \\frac{\\sigma_{\\max}}{K_{n}}$$\n\n2.  **Linear Softening Branch:** For separations from $\\delta=\\delta_{0}$ to $\\delta=\\delta_{c}$, the traction decreases linearly from $\\sigma_{\\max}$ to $0$. The equation of the line connecting the points $(\\delta_{0}, \\sigma_{\\max})$ and $(\\delta_{c}, 0)$ is:\n    $$T(\\delta) = \\sigma_{\\max} \\left( \\frac{\\delta_{c} - \\delta}{\\delta_{c} - \\delta_{0}} \\right) \\quad \\text{for } \\delta_{0} < \\delta \\le \\delta_{c}$$\n\n3.  **Fracture Energy:** The mode-I fracture energy, $G_{c}$, is defined as the work of separation per unit area, which is equivalent to the total area under the traction-separation ($T$-$\\delta$) curve.\n    $$G_{c} = \\int_{0}^{\\delta_{c}} T(\\delta) \\, d\\delta$$\n    Geometrically, the area under the bilinear curve is a triangle with vertices at $(0,0)$, $(\\delta_{c}, 0)$, and $(\\delta_{0}, \\sigma_{\\max})$. The area of this triangle is given by $\\frac{1}{2} \\times \\text{base} \\times \\text{height}$. The base of the triangle is $\\delta_{c}$ and its height is $\\sigma_{\\max}$.\n    \n    Alternatively, we can sum the areas of the two triangular regions corresponding to the two branches:\n    - Area of the first region (elastic loading): $A_{1} = \\frac{1}{2} \\delta_{0} \\sigma_{\\max}$\n    - Area of the second region (softening): $A_{2} = \\frac{1}{2} (\\delta_{c} - \\delta_{0}) \\sigma_{\\max}$\n    \n    The total area is the sum $A_{1} + A_{2}$:\n    $$G_{c} = \\frac{1}{2} \\delta_{0} \\sigma_{\\max} + \\frac{1}{2} (\\delta_{c} - \\delta_{0}) \\sigma_{\\max} = \\frac{1}{2} \\sigma_{\\max} (\\delta_{0} + \\delta_{c} - \\delta_{0})$$\n    $$G_{c} = \\frac{1}{2} \\sigma_{\\max} \\delta_{c}$$\n    Solving this equation for $\\delta_{c}$ yields the second required expression:\n    $$\\delta_{c} = \\frac{2 G_{c}}{\\sigma_{\\max}}$$\n    \n    The derived expressions are $\\delta_{0} = \\frac{\\sigma_{\\max}}{K_{n}}$ and $\\delta_{c} = \\frac{2 G_{c}}{\\sigma_{\\max}}$. Note that $\\delta_{c}$ is independent of the penalty stiffness $K_{n}$.\n\n#### Part 2: Limiting Case and Calculation\nThe problem asks to consider the limiting case where the initial elastic branch is infinitely stiff, which corresponds to $K_{n} \\to \\infty$.\n\nIn this limit, we examine the behavior of $\\delta_{0}$:\n$$\\lim_{K_{n} \\to \\infty} \\delta_{0} = \\lim_{K_{n} \\to \\infty} \\frac{\\sigma_{\\max}}{K_{n}} = 0$$\nAs $K_{n}$ approaches infinity, $\\delta_{0}$ approaches zero. The bilinear law degenerates into a single linear softening law, where the traction is instantaneously $\\sigma_{\\max}$ at $\\delta=0$ and then decreases linearly to $0$ at $\\delta=\\delta_{c}$. This is also known as a triangular cohesive law.\n\nThe traction-separation relation becomes:\n$$T(\\delta) = \\sigma_{\\max} \\left( 1 - \\frac{\\delta}{\\delta_{c}} \\right) \\quad \\text{for } 0 \\le \\delta \\le \\delta_{c}$$\nThe fracture energy $G_{c}$ is the area under this curve, which is the area of a right triangle with base $\\delta_{c}$ and height $\\sigma_{\\max}$.\n$$G_{c} = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\delta_{c} \\sigma_{\\max}$$\nThis leads to the same expression for $\\delta_{c}$ as in the general bilinear case:\n$$\\delta_{c} = \\frac{2 G_{c}}{\\sigma_{\\max}}$$\n\nNow, we compute the numerical value for $\\delta_{c}$ using the provided material properties:\n- $G_{c} = 30\\ \\mathrm{J/m^{2}}$\n- $\\sigma_{\\max} = 1.5 \\times 10^{8}\\ \\mathrm{Pa}$\n\nSubstituting these values into the expression for $\\delta_{c}$:\n$$\\delta_{c} = \\frac{2 \\times 30\\ \\mathrm{J/m^{2}}}{1.5 \\times 10^{8}\\ \\mathrm{Pa}} = \\frac{60}{1.5 \\times 10^{8}}\\ \\mathrm{m}$$\nUnit check: $\\frac{\\mathrm{J/m^{2}}}{\\mathrm{Pa}} = \\frac{\\mathrm{N \\cdot m / m^{2}}}{\\mathrm{N/m^{2}}} = \\frac{\\mathrm{N/m}}{\\mathrm{N/m^{2}}} = \\mathrm{m}$. The units are correct.\n\n$$\\delta_{c} = \\frac{60}{1.5} \\times 10^{-8}\\ \\mathrm{m} = 40 \\times 10^{-8}\\ \\mathrm{m} = 4.0 \\times 10^{-7}\\ \\mathrm{m}$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\delta_{c} = 4.00 \\times 10^{-7}\\ \\mathrm{m}$$",
            "answer": "$$\\boxed{4.00 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Advanced simulations allow us to predict not just the onset of fracture, but how damage accumulates over many charge-discharge cycles. This practice challenges you to implement a phase-field model, a powerful continuum approach for simulating complex crack evolution, coupled with an energy-based law to account for material fatigue. By writing a program to solve for damage evolution, you will gain hands-on experience with the numerical methods that underpin modern battery degradation and lifetime prediction tools .",
            "id": "3937836",
            "problem": "You are given a one-dimensional phase-field representation of a single battery active particle segment of length $L$ subjected to cyclic lithiation-induced strain. The goal is to use a physically grounded energy-based fatigue degradation law within a phase-field fracture model to simulate the evolution of a crack network over $N$ cycles and to estimate the final crack density. The simulation must be expressed in purely mathematical terms and implemented as a complete, runnable program.\n\nStarting point and assumptions:\n- Begin from the energy competition central to Linear Elastic Fracture Mechanics (LEFM): the Griffith criterion equates the crack driving energy release rate to the fracture toughness. In the phase-field formulation, crack evolution is described by minimizing a total energy functional that combines degraded elastic energy and a crack-surface functional.\n- Consider a one-dimensional bar of length $L$ with spatial coordinate $x \\in [0,L]$, discretized into $M$ evenly spaced nodes using the Finite Difference Method (FDM).\n- Use a scalar damage (phase-field) variable $d(x) \\in [0,1]$, where $d(x)=0$ indicates intact material and $d(x)=1$ indicates fully cracked material.\n- Use a small but finite regularization length $\\,\\ell>0\\,$ to ensure well-posedness of the crack surface density in a phase-field model.\n\nPhysical and constitutive ingredients:\n- Let the elastic energy density be $\\psi_0(\\varepsilon) = \\frac{1}{2} E \\varepsilon^2$ with elastic modulus $E$, and use a cycle strain amplitude $\\varepsilon_{\\mathrm{amp}}$ (assumed spatially uniform baseline). Small spatial heterogeneity should be admitted in the energy density (to mimic microstructural variability), but it must remain bounded and physically reasonable.\n- The total energy per unit out-of-plane thickness is composed of a degraded elastic part and a crack-surface regularization, consistent with a phase-field fracture model with internal length $\\,\\ell\\,$ and fracture toughness $G_c$. Express the energy functional in terms of $d(x)$ and its gradient.\n- Introduce an energy-based fatigue degradation variable $\\alpha \\in [0, \\alpha_{\\max}]$ that accumulates cycle-by-cycle in proportion to the dissipated energy per unit area. The fatigue variable reduces the effective fracture toughness $G_c^{\\mathrm{eff}}$ multiplicatively.\n\nTasks:\n1. Derive, from first principles and the stated base, an algorithm suitable for numerical implementation that updates the phase-field variable $d(x)$ over $N$ cycles under cyclic strain amplitude $\\varepsilon_{\\mathrm{amp}}$, along with cycle-wise updating of an energy-based fatigue degradation variable $\\alpha$ that reduces the effective fracture toughness $G_c^{\\mathrm{eff}}$.\n2. Choose physically consistent boundary conditions for the one-dimensional bar (for example, vanishing gradient of the phase-field at the boundaries).\n3. Ensure the heterogeneity in the elastic energy density remains bounded and does not violate physical realism.\n4. Simulate $N$ cycles, updating $d(x)$ and $\\alpha$ per cycle, and produce a final crack network characterized by the number of disconnected cracked segments. A cracked segment is defined as a contiguous set of nodes where $d(x)$ exceeds a threshold close to unity.\n5. Compute the final crack density as the number of cracked segments divided by the length $L$.\n\nUnits and reporting:\n- The elastic modulus $E$ must be given in pascal ($\\mathrm{Pa}$).\n- The fracture toughness $G_c$ must be given in joule per square meter ($\\mathrm{J/m}^2$).\n- The regularization length $\\,\\ell\\,$ and domain length $L$ must be given in meters ($\\mathrm{m}$).\n- The strain amplitude $\\varepsilon_{\\mathrm{amp}}$ is dimensionless.\n- The fatigue coefficient $k_f$ must be chosen consistently with the energy dissipated per cycle so that $\\alpha$ is dimensionless.\n- The crack density must be reported in inverse meters ($\\mathrm{m}^{-1}$), rounded to three decimal places.\n\nTest suite:\nUse the following parameter sets that test different aspects, including typical behavior, no-fatigue boundary condition, and sensitivity to regularization length and toughness. For each case, your program must output the final crack density.\n\n- Case $1$ (typical progressive fatigue-driven cracking):\n  - $L = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $M = 256$, $E = 1.0 \\times 10^{11}\\,\\mathrm{Pa}$, $G_c = 10.0\\,\\mathrm{J/m}^2$, $\\ell = 5.0 \\times 10^{-5}\\,\\mathrm{m}$,\n  - $\\varepsilon_{\\mathrm{amp}} = 6.0 \\times 10^{-4}$, $k_f = 5.0 \\times 10^{-3}$, $\\alpha_{\\max} = 9.0 \\times 10^{-1}$, $N = 10$, heterogeneity amplitude $h = 2.0 \\times 10^{-2}$.\n\n- Case $2$ (no-fatigue boundary condition to test stability and absence of progressive degradation):\n  - $L = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $M = 256$, $E = 1.0 \\times 10^{11}\\,\\mathrm{Pa}$, $G_c = 10.0\\,\\mathrm{J/m}^2$, $\\ell = 5.0 \\times 10^{-5}\\,\\mathrm{m}$,\n  - $\\varepsilon_{\\mathrm{amp}} = 8.0 \\times 10^{-4}$, $k_f = 0.0$, $\\alpha_{\\max} = 9.0 \\times 10^{-1}$, $N = 50$, heterogeneity amplitude $h = 2.0 \\times 10^{-2}$.\n\n- Case $3$ (edge case with smaller regularization length and lower fracture toughness, higher amplitude, and faster fatigue):\n  - $L = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $M = 256$, $E = 1.0 \\times 10^{11}\\,\\mathrm{Pa}$, $G_c = 5.0\\,\\mathrm{J/m}^2$, $\\ell = 2.0 \\times 10^{-5}\\,\\mathrm{m}$,\n  - $\\varepsilon_{\\mathrm{amp}} = 1.2 \\times 10^{-3}$, $k_f = 1.0 \\times 10^{-2}$, $\\alpha_{\\max} = 8.0 \\times 10^{-1}$, $N = 5$, heterogeneity amplitude $h = 5.0 \\times 10^{-2}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the three crack densities for the cases above, reported as a comma-separated list enclosed in square brackets (e.g., $[d_1,d_2,d_3]$), where each $d_i$ is in $\\mathrm{m}^{-1}$ and rounded to three decimal places.",
            "solution": "The problem requires the formulation and implementation of a one-dimensional, energy-based, phase-field fatigue fracture model to simulate crack network evolution in a battery active particle segment. The problem is scientifically grounded, well-posed, and provides sufficient information to derive a standard numerical model.\n\n**1. Theoretical Formulation**\n\nThe core of the phase-field fracture model is a total energy functional, $\\mathcal{E}$, which is minimized to find the equilibrium state of the material, including the crack pattern. For a one-dimensional domain of length $L$ with coordinate $x \\in [0, L]$, the energy per unit cross-sectional area is given by:\n$$ \\mathcal{E}[d, \\varepsilon] = \\int_0^L \\left[ (1-d(x))^2 \\psi_0(\\varepsilon, x) + G_c \\gamma(d(x), \\nabla d(x)) \\right] dx $$\nwhere:\n- $d(x)$ is the phase-field variable, representing damage. $d=0$ signifies undamaged material, and $d=1$ signifies a fully formed crack.\n- $\\varepsilon$ is the strain.\n- $\\psi_0(\\varepsilon, x)$ is the elastic strain energy density of the pristine material.\n- $G_c$ is the material's intrinsic fracture toughness (critical energy release rate).\n- $\\gamma(d, \\nabla d)$ is the crack surface density functional, which regularizes the sharp crack topology. In its common form, it is given by:\n$$ \\gamma(d, \\nabla d) = \\frac{d^2}{2\\ell} + \\frac{\\ell}{2} \\left( \\frac{\\partial d}{\\partial x} \\right)^2 $$\nHere, $\\ell$ is a positive regularization length parameter that controls the width of the smeared crack representation. The term $(1-d)^2$ is a degradation function that reduces the material's stiffness as damage accumulates.\n\nThe problem specifies a spatially uniform baseline strain amplitude $\\varepsilon_{\\mathrm{amp}}$ and allows for small spatial heterogeneity. We model this by modifying the strain energy density:\n$$ \\psi_0(\\varepsilon, x) = \\frac{1}{2} E \\varepsilon^2 (1 + h \\cdot \\eta(x)) $$\nwhere $E$ is the elastic modulus, $h$ is the heterogeneity amplitude, and $\\eta(x)$ is a random field (e.g., uniformly distributed in $[-0.5, 0.5]$) representing microstructural variations. For cyclic loading with a constant amplitude, damage evolution is driven by the peak strain energy, so we set $\\varepsilon = \\varepsilon_{\\mathrm{amp}}$.\n\nDamage is an irreversible process, meaning it can only increase or stay constant: $d(x, t_2) \\ge d(x, t_1)$ for $t_2 > t_1$.\n\nThe equilibrium crack field $d(x)$ for a given strain is found by minimizing $\\mathcal{E}[d, \\varepsilon]$. The corresponding Euler-Lagrange equation, which expresses a necessary condition for the minimum, is derived from the calculus of variations, $\\frac{\\delta \\mathcal{E}}{\\delta d} = 0$:\n$$ 2(1-d)\\psi_0(\\varepsilon_{\\mathrm{amp}}, x) = G_c \\left( \\frac{d}{\\ell} - \\ell \\frac{\\partial^2 d}{\\partial x^2} \\right) $$\n\n**2. Fatigue Degradation Model**\n\nFatigue is introduced by progressively reducing the material's resistance to fracture. The effective fracture toughness, $G_c^{\\mathrm{eff}}$, is degraded by a fatigue variable $\\alpha \\in [0, \\alpha_{\\max}]$:\n$$ G_c^{\\mathrm{eff},(n)} = (1 - \\alpha^{(n-1)}) G_c $$\nwhere the superscript $(n)$ denotes the cycle number.\n\nThe fatigue variable $\\alpha$ accumulates in proportion to the energy dissipated during crack evolution in each cycle. The total energy dissipated in cycle $n$ is the reduction of the system's total energy functional as the damage field advances from $d^{(n-1)}$ to $d^{(n)}$:\n$$ \\Delta \\mathcal{W}_{\\text{diss}}^{(n)} = \\mathcal{E}[d^{(n-1)}, \\varepsilon_{\\mathrm{amp}}] - \\mathcal{E}[d^{(n)}, \\varepsilon_{\\mathrm{amp}}] $$\nThe problem requires that the increment to $\\alpha$ be dimensionless. We construct a dimensionless energy term by normalizing the dissipated energy with a characteristic system energy, $(G_c/\\ell) \\cdot L$, which represents the critical energy density scaled by the system size. The update rule for $\\alpha$ is:\n$$ \\alpha^{(n)} = \\min \\left( \\alpha^{(n-1)} + k_f \\frac{\\Delta \\mathcal{W}_{\\text{diss}}^{(n)}}{(G_c/\\ell)L}, \\alpha_{\\max} \\right) $$\nwhere $k_f$ is the given dimensionless fatigue coefficient.\n\n**3. Numerical Implementation Algorithm**\n\nWe use the Finite Difference Method (FDM) on a uniform grid of $M$ nodes, with spacing $\\Delta x = L/(M-1)$. The variables become discrete arrays $d_i = d(x_i)$, $\\psi_{0,i} = \\psi_0(x_i)$, etc.\n\n**Initialization ($n=0$):**\n- Grid: $x_i = i \\cdot \\Delta x$ for $i=0, \\dots, M-1$.\n- Damage: $d_i^{(0)} = 0$ for all $i$.\n- Fatigue: $\\alpha^{(0)} = 0$.\n- Heterogeneity: Generate a random array $\\eta_i$ from a uniform distribution on $[-0.5, 0.5]$ and compute $\\psi_{0,i} = \\frac{1}{2} E \\varepsilon_{\\mathrm{amp}}^2 (1 + h \\cdot \\eta_i)$.\n\n**Cyclic Update (for $n=1, \\dots, N$):**\n\n1.  **Update Properties:** Calculate $G_{c, \\text{eff}}^{(n)} = (1-\\alpha^{(n-1)})G_c$.\n\n2.  **Solve for Damage Field $d^{(n)}$:** The discretized Euler-Lagrange equation for each node $i$ becomes a non-linear system. We solve it using a Picard iteration scheme. Let $d_i^{\\text{old}}$ be the damage from the previous iteration. We solve the following linear system for the new estimate $d_i^{\\text{new}}$:\n    $$ -\\frac{G_{c,\\mathrm{eff}} \\ell}{\\Delta x^2} d_{i-1}^{\\text{new}} + \\left(\\frac{G_{c,\\mathrm{eff}}}{\\ell} + \\frac{2G_{c,\\mathrm{eff}} \\ell}{\\Delta x^2}\\right) d_i^{\\text{new}} - \\frac{G_{c,\\mathrm{eff}} \\ell}{\\Delta x^2} d_{i+1}^{\\text{new}} = 2(1 - d_i^{\\text{old}}) \\psi_{0,i} $$\n    This is a tridiagonal system of the form $A \\cdot \\vec{d}^{\\text{new}} = \\vec{b}(\\vec{d}^{\\text{old}})$. We iterate until convergence, i.e., $\\|\\vec{d}^{\\text{new}} - \\vec{d}^{\\text{old}}\\|_{\\infty} < \\text{tolerance}$.\n    - **Boundary Conditions:** The problem specifies zero-gradient boundary conditions, $\\frac{\\partial d}{\\partial x}=0$ at $x=0, L$. Using ghost points, this modifies the first and last equations of the linear system. For $i=0$, the term for $d_{-1}$ is replaced by $d_1$, and for $i=M-1$, $d_M$ is replaced by $d_{M-2}$. This leads to doubling the off-diagonal coefficient in the corresponding rows of matrix $A$.\n    - **Irreversibility:** After solving the linear system, we enforce irreversibility and the physical bound $d \\in [0,1]$ by setting the updated damage as $d_i^{(n)} = \\max(d_i^{(n-1)}, \\min(1.0, d_i^{\\text{new}}))$. The initial guess for the iterative solver in cycle $n$ is $d^{(n-1)}$.\n\n3.  **Update Fatigue Variable $\\alpha^{(n)}$:**\n    - Calculate the discrete total energy before the update, $E_{\\text{before}}$, using $d^{(n-1)}$ and $G_{c, \\text{eff}}^{(n)}$.\n    - Calculate the discrete total energy after the update, $E_{\\text{after}}$, using the newly converged $d^{(n)}$ and $G_{c, \\text{eff}}^{(n)}$. The energy is computed by summing the energy density at each node multiplied by $\\Delta x$.\n    - Calculate the dissipated energy: $\\Delta \\mathcal{W}_{\\text{diss}}^{(n)} = \\max(0, E_{\\text{before}} - E_{\\text{after}})$.\n    - Update $\\alpha$ using the fatigue law derived earlier.\n\n**4. Final Crack Density Calculation**\n\nAfter $N$ cycles, we obtain the final damage profile $d^{(N)}$.\n- A node $i$ is considered cracked if $d_i^{(N)} > 0.99$.\n- A cracked segment is a contiguous block of cracked nodes.\n- The number of segments is counted by identifying transitions from an uncracked state ($d \\le 0.99$) to a cracked state ($d > 0.99$).\n- The final crack density is the number of cracked segments divided by the total length $L$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef run_simulation(L, M, E, Gc, l, eps_amp, kf, alpha_max, N, h):\n    \"\"\"\n    Simulates fatigue-driven cracking in a 1D bar using a phase-field model.\n    \"\"\"\n    # 1. Initialization\n    dx = L / (M - 1)\n    x = np.linspace(0, L, M)\n\n    # Seed for reproducible heterogeneity\n    np.random.seed(42)\n    # Generate heterogeneity profile eta in [-0.5, 0.5]\n    eta = np.random.rand(M) - 0.5\n    psi0_base = 0.5 * E * eps_amp**2\n    psi0 = psi0_base * (1 + h * eta)\n\n    d = np.zeros(M)\n    alpha = 0.0\n\n    # Iterative solver parameters for damage field\n    iter_max = 100\n    tol = 1e-5\n    \n    # 2. Cycle Loop\n    for _ in range(N):\n        Gc_eff = Gc * (1 - alpha)\n        if Gc_eff <= 0: # Stop if material has no fracture resistance\n            break\n\n        # Setup the linear system A * d_new = b(d_old_iter)\n        # The matrix A is constant within a cycle.\n        main_diag_val = Gc_eff / l + 2 * Gc_eff * l / dx**2\n        off_diag_val = -Gc_eff * l / dx**2\n\n        ab = np.zeros((3, M))\n        ab[0, 1:] = off_diag_val   # Super-diagonal\n        ab[1, :] = main_diag_val     # Main diagonal\n        ab[2, :-1] = off_diag_val  # Sub-diagonal\n\n        # Apply zero-gradient boundary conditions\n        ab[0, 1] = 2 * off_diag_val\n        ab[2, M-2] = 2 * off_diag_val\n        \n        d_cycle_old = np.copy(d)\n        d_iter = np.copy(d)\n        \n        # Iteratively solve for damage field d\n        for _ in range(iter_max):\n            d_iter_old = np.copy(d_iter)\n            \n            # Form the right-hand side vector\n            b = 2 * (1 - d_iter) * psi0\n            \n            # Solve the tridiagonal system\n            d_sol = solve_banded((1, 1), ab, b)\n            \n            # Enforce constraints: 0 <= d_old <= d_new <= 1\n            d_iter = np.maximum(d_cycle_old, np.minimum(1.0, d_sol))\n            \n            # Check for convergence\n            if np.max(np.abs(d_iter - d_iter_old)) < tol:\n                break\n        \n        d_new = d_iter\n\n        # 3. Update fatigue variable alpha\n        def calculate_total_energy(d_field, current_Gc_eff):\n            grad_d = np.gradient(d_field, dx)\n            \n            elastic_energy_density = (1 - d_field)**2 * psi0\n            crack_energy_density = current_Gc_eff * (d_field**2 / (2 * l) + l / 2 * grad_d**2)\n            \n            total_energy_per_area = np.sum((elastic_energy_density + crack_energy_density)) * dx\n            return total_energy_per_area\n\n        energy_before = calculate_total_energy(d_cycle_old, Gc_eff)\n        energy_after = calculate_total_energy(d_new, Gc_eff)\n        \n        dissipated_energy = max(0, energy_before - energy_after)\n        \n        if Gc > 0 and l > 0 and L > 0:\n            # normalization term (Gc/l)*L has units of J/m^2\n            norm_energy = (Gc / l) * L\n            if norm_energy > 0:\n                alpha_increment = kf * (dissipated_energy / norm_energy)\n                alpha = min(alpha + alpha_increment, alpha_max)\n\n        d = d_new\n    \n    # 4. Post-processing: Calculate crack density\n    crack_threshold = 0.99\n    is_cracked = d > crack_threshold\n    \n    # Pad with False to correctly count segments at the boundaries\n    padded_cracked = np.concatenate(([False], is_cracked, [False]))\n    \n    # A new segment starts where the diff is 1\n    diffs = np.diff(padded_cracked.astype(int))\n    num_segments = np.sum(diffs == 1)\n    \n    crack_density = num_segments / L\n    \n    return round(crack_density, 3)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (typical)\n        {'L': 1.0e-3, 'M': 256, 'E': 1.0e11, 'Gc': 10.0, 'l': 5.0e-5,\n         'eps_amp': 6.0e-4, 'kf': 5.0e-3, 'alpha_max': 0.9, 'N': 10, 'h': 2.0e-2},\n        # Case 2 (no fatigue)\n        {'L': 1.0e-3, 'M': 256, 'E': 1.0e11, 'Gc': 10.0, 'l': 5.0e-5,\n         'eps_amp': 8.0e-4, 'kf': 0.0, 'alpha_max': 0.9, 'N': 50, 'h': 2.0e-2},\n        # Case 3 (edge case)\n        {'L': 1.0e-3, 'M': 256, 'E': 1.0e11, 'Gc': 5.0, 'l': 2.0e-5,\n         'eps_amp': 1.2e-3, 'kf': 1.0e-2, 'alpha_max': 0.8, 'N': 5, 'h': 5.0e-2}\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(**params)\n        results.append(f\"{result:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}