{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational link between first-principles calculations and real-world thermodynamics. By using total energies from Density Functional Theory (DFT), you will calculate the oxygen vacancy formation energy as a function of temperature and oxygen partial pressure. This practice is essential for developing a quantitative understanding of a material's intrinsic stability against oxygen loss under specific environmental conditions .",
            "id": "3935653",
            "problem": "Given a layered oxide cathode supercell modeled via Density Functional Theory (DFT), consider thermodynamic oxygen release as the formation of a neutral oxygen vacancy, which exchanges oxygen with an external diatomic oxygen gas reservoir characterized by temperature and partial pressure. Use the fundamental thermodynamic definition of formation free energy and the ideal gas chemical potential relation to compute the vacancy formation free energy and the critical oxygen partial pressure at which oxygen release becomes thermodynamically favorable. The derivation must start from the following bases: (i) Gibbs free energy minimization for equilibrium, (ii) chemical potential definition for an ideal gas, and (iii) the stoichiometric relation between the oxygen atom and the diatomic oxygen molecule. Assume a neutral vacancy (no electrostatic terms) and negligible solid-state finite-temperature corrections relative to electronic DFT energies. The goal is to compute the formation free energy of a single oxygen vacancy at specified conditions, and the critical oxygen partial pressure at which the formation free energy becomes zero.\n\nDefinitions and assumptions:\n- Let $E_{\\mathrm{perf}}$ be the DFT total energy of the perfect supercell in $\\mathrm{eV}$.\n- Let $E_{\\mathrm{def}}$ be the DFT total energy of the supercell containing one oxygen vacancy in $\\mathrm{eV}$.\n- Let $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$ be the DFT energy difference in $\\mathrm{eV}$.\n- The oxygen chemical potential per oxygen atom is $\\mu_{\\mathrm{O}}(T,p)$, related to the diatomic oxygen chemical potential as $\\mu_{\\mathrm{O}}(T,p) = \\tfrac{1}{2}\\mu_{\\mathrm{O}_2}(T,p)$.\n- For an ideal gas, $\\mu_{\\mathrm{O}_2}(T,p) = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature in $\\mathrm{K}$, $p$ is the oxygen partial pressure in $\\mathrm{bar}$, and $p^{\\circ}$ is the reference pressure in $\\mathrm{bar}$. The quantity $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$ is the diatomic oxygen chemical potential at the specified temperature and reference pressure, expressed in $\\mathrm{eV}$, consistent with the DFT energy reference choice.\n- The neutral oxygen vacancy formation free energy at $(T,p)$ is $G_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\mu_{\\mathrm{O}}(T,p)$ in $\\mathrm{eV}$.\n- Oxygen release is thermodynamically favorable when $G_{f}(V_{\\mathrm{O}};T,p) \\leq 0$.\n- The critical oxygen partial pressure is defined by the condition $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$.\n\nYour task is to write a program that, for each test case, computes:\n1. $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$ in $\\mathrm{eV}$ at the specified evaluation pressure $p_{\\mathrm{eval}}$.\n2. $p_{\\mathrm{crit}}$ in $\\mathrm{bar}$ such that $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$.\n\nUse $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$.\n\nExpress all energies in $\\mathrm{eV}$ and all pressures in $\\mathrm{bar}$. Angles do not appear in this problem. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $\\left[G_{f,1},p_{\\mathrm{crit},1},G_{f,2},p_{\\mathrm{crit},2},\\ldots\\right]$.\n\nTest suite:\n- Case A (general case):\n  - $E_{\\mathrm{perf}} = -1000.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -998.000\\ \\mathrm{eV}$\n  - $T = 800\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -3.500\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 0.210\\ \\mathrm{bar}$\n- Case B (boundary condition $p_{\\mathrm{crit}} = p^{\\circ}$):\n  - $E_{\\mathrm{perf}} = -1200.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -1198.000\\ \\mathrm{eV}$\n  - $T = 1000\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.000\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 1.000\\ \\mathrm{bar}$\n- Case C (high $p_{\\mathrm{crit}}$):\n  - $E_{\\mathrm{perf}} = -500.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -498.000\\ \\mathrm{eV}$\n  - $T = 800\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.317\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 10.000\\ \\mathrm{bar}$\n\nThe final output must be a single line in the exact format: a comma-separated list of the six floating-point results enclosed in square brackets, corresponding to the three cases in sequence.",
            "solution": "The user wants me to act as a meticulous and exacting professor in the STEM fields. I must first validate the problem statement and then, if it is valid, provide a complete, reasoned solution.\n\n### Step 1: Extract Givens\n\n-   **Definition of $\\Delta E$**: $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$, where $E_{\\mathrm{perf}}$ is the DFT total energy of the perfect supercell in $\\mathrm{eV}$ and $E_{\\mathrm{def}}$ is the DFT total energy of the supercell with one oxygen vacancy in $\\mathrm{eV}$.\n-   **Oxygen chemical potential relation**: $\\mu_{\\mathrm{O}}(T,p) = \\tfrac{1}{2}\\mu_{\\mathrm{O}_2}(T,p)$, where $\\mu_{\\mathrm{O}}$ is per O atom.\n-   **Ideal gas chemical potential**: $\\mu_{\\mathrm{O}_2}(T,p) = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right)$. Variables are temperature $T$ in $\\mathrm{K}$, pressure $p$ in $\\mathrm{bar}$, reference pressure $p^{\\circ}$ in $\\mathrm{bar}$. $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$ is the standard chemical potential in $\\mathrm{eV}$.\n-   **Vacancy formation free energy**: $G_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\mu_{\\mathrm{O}}(T,p)$ in $\\mathrm{eV}$.\n-   **Condition for favorable oxygen release**: $G_{f}(V_{\\mathrm{O}};T,p) \\leq 0$.\n-   **Definition of critical pressure**: $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$.\n-   **Boltzmann constant**: $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$.\n-   **Test Case A**: $E_{\\mathrm{perf}} = -1000.000\\ \\mathrm{eV}$, $E_{\\mathrm{def}} = -998.000\\ \\mathrm{eV}$, $T = 800\\ \\mathrm{K}$, $p^{\\circ} = 1.000\\ \\mathrm{bar}$, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -3.500\\ \\mathrm{eV}$, $p_{\\mathrm{eval}} = 0.210\\ \\mathrm{bar}$.\n-   **Test Case B**: $E_{\\mathrm{perf}} = -1200.000\\ \\mathrm{eV}$, $E_{\\mathrm{def}} = -1198.000\\ \\mathrm{eV}$, $T = 1000\\ \\mathrm{K}$, $p^{\\circ} = 1.000\\ \\mathrm{bar}$, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.000\\ \\mathrm{eV}$, $p_{\\mathrm{eval}} = 1.000\\ \\mathrm{bar}$.\n-   **Test Case C**: $E_{\\mathrm{perf}} = -500.000\\ \\mathrm{eV}$, $E_{\\mathrm{def}} = -498.000\\ \\mathrm{eV}$, $T = 800\\ \\mathrm{K}$, $p^{\\circ} = 1.000\\ \\mathrm{bar}$, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.317\\ \\mathrm{eV}$, $p_{\\mathrm{eval}} = 10.000\\ \\mathrm{bar}$.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded**: The problem is based on standard principles of solid-state thermodynamics and statistical mechanics, specifically the formation of point defects in solids in equilibrium with a gas phase. The definitions of formation energy and chemical potential are conventional in the field of computational materials science.\n2.  **Well-Posed**: The problem is well-posed. It provides all necessary equations, constants, and data to calculate the two required quantities for each test case. The algebraic manipulations lead to unique analytical solutions for both quantities.\n3.  **Objective**: The problem is stated in precise, objective language with clear, formal definitions. There is no subjective or ambiguous terminology.\n4.  **Completeness and Consistency**: The problem statement is self-contained. All variables and constants are defined, and their units are specified. The provided data are consistent and sufficient for a solution. The sign convention for the formation energy, $G_{f} = \\Delta E + \\mu_{\\mathrm{O}}$, correctly models the dependence of vacancy formation on the chemical potential of the species being removed, which is a standard convention.\n5.  **Realism and Feasibility**: The energy values, temperatures, and pressures are within physically realistic ranges for DFT studies of cathode materials and their operating or synthesis conditions.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, objective, and self-contained. I will proceed with the solution.\nThe objective is to compute two quantities for each test case: the vacancy formation free energy $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$ at a specified evaluation pressure $p_{\\mathrm{eval}}$, and the critical oxygen partial pressure $p_{\\mathrm{crit}}$ at which vacancy formation becomes thermodynamically spontaneous ($G_f=0$). The solution is derived from the fundamental thermodynamic relations provided.\n\nFirst, we establish the working equations. The formation free energy of a neutral oxygen vacancy, $G_{f}(V_{\\mathrm{O}};T,p)$, is given by:\n$$\nG_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\mu_{\\mathrm{O}}(T,p)\n$$\nwhere $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$ is the energy difference between the defective and perfect supercells. The oxygen chemical potential, $\\mu_{\\mathrm{O}}(T,p)$, is determined by the external oxygen gas reservoir, modeled as an ideal gas. It is related to the chemical potential of diatomic oxygen, $\\mu_{\\mathrm{O}_2}(T,p)$, by the stoichiometric relation:\n$$\n\\mu_{\\mathrm{O}}(T,p) = \\frac{1}{2}\\mu_{\\mathrm{O}_2}(T,p)\n$$\nThe chemical potential of the diatomic oxygen gas depends on temperature $T$ and partial pressure $p$ as:\n$$\n\\mu_{\\mathrm{O}_2}(T,p) = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right)\n$$\nHere, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$ is the chemical potential at a reference pressure $p^{\\circ}$, and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nCombining these expressions, we obtain the full dependency of the vacancy formation free energy on temperature and pressure:\n$$\nG_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right) \\right]\n$$\nThis equation forms the basis for our first computational task.\n\n**Part 1: Calculation of $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$**\nTo compute the formation free energy at the specified evaluation pressure $p_{\\mathrm{eval}}$, we substitute $p=p_{\\mathrm{eval}}$ into the derived equation:\n$$\nG_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}}) = (E_{\\mathrm{def}} - E_{\\mathrm{perf}}) + \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{eval}}}{p^{\\circ}}\\right) \\right]\n$$\nThe algorithmic procedure is to first calculate $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$, then substitute all given parameters for a specific test case ($T$, $p_{\\mathrm{eval}}$, $p^{\\circ}$, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$) and the constant $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$ into this expression.\n\n**Part 2: Calculation of $p_{\\mathrm{crit}}$**\nThe critical pressure $p_{\\mathrm{crit}}$ is defined by the condition where oxygen release becomes thermodynamically favorable, i.e., $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$. We set the formation energy expression to zero and solve for the pressure, which is now $p_{\\mathrm{crit}}$:\n$$\n0 = \\Delta E + \\mu_{\\mathrm{O}}(T,p_{\\mathrm{crit}})\n$$\n$$\n-\\Delta E = \\mu_{\\mathrm{O}}(T,p_{\\mathrm{crit}}) = \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) \\right]\n$$\nRearranging to solve for $p_{\\mathrm{crit}}$:\n$$\n-2\\Delta E = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right)\n$$\n$$\nk_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) = -2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})\n$$\n$$\n\\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) = \\frac{-2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T}\n$$\nExponentiating both sides gives the final expression for $p_{\\mathrm{crit}}$:\n$$\np_{\\mathrm{crit}} = p^{\\circ} \\exp\\left( \\frac{-2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T} \\right) = p^{\\circ} \\exp\\left( -\\frac{2(E_{\\mathrm{def}} - E_{\\mathrm{perf}}) + \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T} \\right)\n$$\nThe algorithm implements this analytical formula, again substituting the given parameters for each test case.\n\nThe final program will systematically apply these two derived formulas to each of the three test cases provided, collecting the results ($G_f$ and $p_{\\mathrm{crit}}$) for each case and formatting them into the specified output string.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the oxygen vacancy formation free energy and the critical oxygen\n    partial pressure for layered oxide cathodes based on DFT energies and\n    thermodynamic principles.\n    \"\"\"\n    # Define the Boltzmann constant in eV/K.\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_perf, E_def, T, p_circ, mu_O2_circ, p_eval)\n    test_cases = [\n        # Case A (general case)\n        (-1000.000, -998.000, 800, 1.000, -3.500, 0.210),\n        # Case B (boundary condition p_crit = p_circ)\n        (-1200.000, -1198.000, 1000, 1.000, -4.000, 1.000),\n        # Case C (high p_crit)\n        (-500.000, -498.000, 800, 1.000, -4.317, 10.000),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_perf, E_def, T, p_circ, mu_O2_circ, p_eval = case\n\n        # Calculate DFT energy difference\n        delta_E = E_def - E_perf\n\n        # Calculate thermal energy term\n        k_B_T = k_B * T\n\n        # Part 1: Calculate the formation free energy G_f at p_eval\n        # G_f(T, p) = delta_E + 0.5 * (mu_O2_circ + k_B * T * ln(p / p_circ))\n        ln_term_Gf = np.log(p_eval / p_circ)\n        Gf_eval = delta_E + 0.5 * (mu_O2_circ + k_B_T * ln_term_Gf)\n        results.append(Gf_eval)\n\n        # Part 2: Calculate the critical pressure p_crit\n        # p_crit = p_circ * exp(-(2*delta_E + mu_O2_circ) / (k_B * T))\n        exponent = -(2 * delta_E + mu_O2_circ) / k_B_T\n        p_crit = p_circ * np.exp(exponent)\n        results.append(p_crit)\n\n    # Format the final output as a single line: a comma-separated list of\n    # floating-point results enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Moving from thermodynamics to its electronic origins, this practice demonstrates how to extract a powerful materials descriptor from electronic structure data. You will calculate the oxygen $2p$-band center, $\\varepsilon_{2p}$, from a model density of states and use it in an empirical scaling relation to predict the electrochemical potential for oxygen evolution. This exercise highlights how microscopic electronic features govern macroscopic material properties, a core concept in rational materials design .",
            "id": "3935623",
            "problem": "A high-throughput electronic structure workflow for a Nickel-rich layered oxide provides a projected Density of States (DOS) for oxygen $2p$ states, denoted $D_{2p}(E)$, referenced to the Fermi level $E_F$ at $E=0$. Assume low temperature so that the Fermi–Dirac occupation is a step function with unit occupancy for $E<E_F$ and zero otherwise. The oxygen $2p$ DOS is modeled as a sum of two truncated, normalized-parabola lobes (representing hybridized ligand bands) as follows:\n- For $E \\in [-6.0, -3.0]$ electron-volts, $D_{2p}(E) = c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right)$.\n- For $E \\in [-3.0, 0.0]$ electron-volts, $D_{2p}(E) = c_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right)$.\n- Elsewhere, $D_{2p}(E)=0$.\nHere, $c_1 = 2.0$ and $c_2 = 1.0$ in units of states per electron-volt per oxygen.\n\n1. Using the core definition of a band centroid, compute the oxygen $2p$ band center $\\varepsilon_{2p}$ relative to the Fermi level,\n$$\n\\varepsilon_{2p} \\equiv \\frac{\\int_{-\\infty}^{E_F} E \\, D_{2p}(E)\\, dE}{\\int_{-\\infty}^{E_F} D_{2p}(E)\\, dE}.\n$$\n\n2. In an automated battery design framework, an empirically calibrated, well-tested linear scaling between the oxygen $2p$ band center and the experimentally observed onset potential of oxygen evolution $E_{\\mathrm{onset}}$ versus lithium ion/lithium (Li$^{+}$/Li) is used for Nickel-rich layered oxides:\n$$\nE_{\\mathrm{onset}} = \\alpha \\, \\big(-\\varepsilon_{2p}\\big) + \\beta,\n$$\nwith $\\alpha = 0.40$ volts per electron-volt and $\\beta = 2.80$ volts.\n\nCompute $E_{\\mathrm{onset}}$ based on your $\\varepsilon_{2p}$. Express the final onset potential in volts versus Li$^{+}$/Li and round your answer to three significant figures.",
            "solution": "The user has provided a problem requiring the calculation of the oxygen evolution onset potential, $E_{\\mathrm{onset}}$, based on a materials descriptor derived from the electronic density of states (DOS). The problem is divided into two main parts: first, to compute the oxygen $2p$ band center, $\\varepsilon_{2p}$, and second, to use this value in a given linear scaling relation to find $E_{\\mathrm{onset}}$.\n\nThe problem statement has been validated and found to be scientifically grounded, well-posed, and objective. It is based on standard concepts in computational materials science and electrochemistry, providing all necessary information for a unique solution.\n\nThe first step is to calculate the oxygen $2p$ band center, $\\varepsilon_{2p}$, which is defined as the first moment of the occupied projected DOS, normalized by the total number of occupied states. The definition is given as:\n$$\n\\varepsilon_{2p} \\equiv \\frac{\\int_{-\\infty}^{E_F} E \\, D_{2p}(E)\\, dE}{\\int_{-\\infty}^{E_F} D_{2p}(E)\\, dE}\n$$\nThe problem specifies that the Fermi level is at $E_F = 0$ eV. The DOS, $D_{2p}(E)$, is non-zero only in the interval $E \\in [-6.0, 0.0]$ eV. Therefore, the integration limits can be adjusted from $(-\\infty, E_F]$ to $[-6.0, 0.0]$.\n\nLet us compute the denominator first, which represents the total number of occupied oxygen $2p$ states, $N_{2p}$.\n$$\nN_{2p} = \\int_{-6.0}^{0.0} D_{2p}(E)\\, dE\n$$\nThe function $D_{2p}(E)$ is piecewise, so we must split the integral into two parts corresponding to the two lobes:\n$$\nN_{2p} = \\int_{-6.0}^{-3.0} c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right) dE + \\int_{-3.0}^{0.0} c_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right) dE\n$$\nLet's evaluate the first integral, $I_{D1}$:\n$I_{D1} = \\int_{-6.0}^{-3.0} c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right) dE$.\nWe perform a substitution. Let $u = \\frac{E + 4.5}{1.5}$. Then $dE = 1.5 \\, du$. The integration limits change from $E = -6.0$ to $u = \\frac{-6.0 + 4.5}{1.5} = -1$, and from $E = -3.0$ to $u = \\frac{-3.0 + 4.5}{1.5} = 1$.\n$$\nI_{D1} = c_1 \\int_{-1}^{1} (1 - u^2) (1.5 \\, du) = 1.5 \\, c_1 \\left[u - \\frac{u^3}{3}\\right]_{-1}^{1} = 1.5 \\, c_1 \\left( \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{-1}{3}\\right) \\right) = 1.5 \\, c_1 \\left( \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) \\right) = 1.5 \\, c_1 \\left(\\frac{4}{3}\\right) = 2 c_1\n$$\nGiven $c_1 = 2.0$, we have $I_{D1} = 2 \\times 2.0 = 4.0$.\n\nNow, let's evaluate the second integral, $I_{D2}$:\n$I_{D2} = \\int_{-3.0}^{0.0} c_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right) dE$.\nThis integral has the same mathematical form. Let $v = \\frac{E + 1.5}{1.5}$, so $dE = 1.5 \\, dv$. The limits are $E = -3.0 \\to v = -1$ and $E = 0.0 \\to v = 1$.\n$$\nI_{D2} = c_2 \\int_{-1}^{1} (1 - v^2) (1.5 \\, dv) = 1.5 \\, c_2 \\left[v - \\frac{v^3}{3}\\right]_{-1}^{1} = 1.5 \\, c_2 \\left(\\frac{4}{3}\\right) = 2 c_2\n$$\nGiven $c_2 = 1.0$, we have $I_{D2} = 2 \\times 1.0 = 2.0$.\nThe total number of states is the sum of the two integrals:\n$N_{2p} = I_{D1} + I_{D2} = 4.0 + 2.0 = 6.0$ states per oxygen atom.\n\nNext, we compute the numerator, which is the first energy moment of the occupied DOS, $M_{2p}$.\n$$\nM_{2p} = \\int_{-6.0}^{0.0} E \\, D_{2p}(E)\\, dE = \\int_{-6.0}^{-3.0} E \\, D_{1}(E) dE + \\int_{-3.0}^{0.0} E \\, D_{2}(E) dE\n$$\nwhere $D_1(E)$ and $D_2(E)$ are the expressions for the first and second lobes, respectively.\nLet's evaluate the first integral, $I_{N1}$. We note that the first lobe, $D_1(E)=c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right)$, is a symmetric function about $E_c = -4.5$ eV. The integral of $E \\cdot D_1(E)$ can be simplified by exploiting this symmetry.\n$$\nI_{N1} = \\int_{-6.0}^{-3.0} E \\, D_1(E) dE = \\int_{-6.0}^{-3.0} ((E - E_c) + E_c) \\, D_1(E) dE = \\int_{-6.0}^{-3.0} (E - E_c) \\, D_1(E) dE + E_c \\int_{-6.0}^{-3.0} D_1(E) dE\n$$\nThe term $(E - E_c)$ is an odd function with respect to the center $E_c$, while $D_1(E)$ is an even function with respect to $E_c$. Their product is an odd function. The integral of an odd function over a symmetric interval (from $E_c-1.5$ to $E_c+1.5$) is zero. Thus, the first term vanishes.\n$$\nI_{N1} = E_c \\int_{-6.0}^{-3.0} D_1(E) dE = E_c \\cdot I_{D1} = (-4.5) \\times (4.0) = -18.0\n$$\nSimilarly, for the second integral, $I_{N2}$, the second lobe $D_2(E)$ is symmetric about $E_c = -1.5$ eV.\n$$\nI_{N2} = \\int_{-3.0}^{0.0} E \\, D_2(E) dE = (-1.5) \\int_{-3.0}^{0.0} D_2(E) dE = (-1.5) \\cdot I_{D2} = (-1.5) \\times (2.0) = -3.0\n$$\nThe total moment is the sum of the two parts:\n$M_{2p} = I_{N1} + I_{N2} = -18.0 - 3.0 = -21.0$ eV$\\cdot$states per oxygen atom.\n\nNow we can calculate the band center $\\varepsilon_{2p}$:\n$$\n\\varepsilon_{2p} = \\frac{M_{2p}}{N_{2p}} = \\frac{-21.0}{6.0} = -3.5 \\, \\text{eV}\n$$\n\nThe second part of the problem is to compute the onset potential for oxygen evolution, $E_{\\mathrm{onset}}$, using the provided linear scaling relation:\n$$\nE_{\\mathrm{onset}} = \\alpha \\, \\big(-\\varepsilon_{2p}\\big) + \\beta\n$$\nThe given parameters are $\\alpha = 0.40$ V/eV and $\\beta = 2.80$ V. Substituting the value of $\\varepsilon_{2p}$:\n$$\nE_{\\mathrm{onset}} = 0.40 \\times (-(-3.5)) + 2.80\n$$\n$$\nE_{\\mathrm{onset}} = 0.40 \\times 3.5 + 2.80\n$$\n$$\nE_{\\mathrm{onset}} = 1.40 + 2.80 = 4.20 \\, \\text{V}\n$$\nThe problem requires the answer to be rounded to three significant figures. The result $4.20$ V is already expressed with three significant figures.",
            "answer": "$$\n\\boxed{4.20}\n$$"
        },
        {
            "introduction": "Even if thermodynamically favorable, oxygen release is ultimately governed by kinetics. This practice introduces a powerful technique to study reaction dynamics by having you implement a Nudged Elastic Band (NEB) simulation on a model potential energy surface. By mapping the minimum energy path for O$_2$ formation, you will determine the activation barrier, $\\Delta E^{\\ddagger}$, and gain insight into how coupled atomic motions, like cation migration, facilitate this critical failure mechanism .",
            "id": "3935649",
            "problem": "Consider a simplified two-dimensional potential energy surface modeling oxygen molecule formation from two neighboring lattice oxygens in a layered oxide during high-voltage charging. The two collective coordinates are the oxygen–oxygen separation $x$ (in ångströms, denoted $\\text{\\AA}$) and a scalar cation migration coordinate $m$ (dimensionless). The goal is to construct the minimum-energy reaction coordinate for molecular oxygen formation using the Nudged Elastic Band (NEB) method and to quantify the role of cation migration in accommodating oxygen–oxygen bond formation.\n\nStart from the following fundamental and well-tested bases:\n- The total energy of a system on a potential energy surface $E(x,m)$ is minimized along thermodynamically stable configurations.\n- A discrete NEB string of $N_\\text{img}$ images $\\{\\mathbf{R}_i\\}_{i=0}^{N_\\text{img}-1}$, where $\\mathbf{R}_i = (x_i, m_i)$, approximates a path between fixed endpoints by minimizing the sum of the true potential projected perpendicular to the tangent and harmonic spring energies along the path.\n- Steepest-descent dynamics update positions according to $\\mathbf{R}_i \\leftarrow \\mathbf{R}_i + \\Delta t \\,\\mathbf{F}_i$, where $\\mathbf{F}_i$ is the NEB force on image $i$ and $\\Delta t$ is a small step.\n\nDefine the potential energy surface by\n$$\nE(x,m) \\;=\\; E_0\\,(x - x_0)^2\\,(x - x_1)^2 \\;+\\; \\frac{1}{2}\\,k_m\\,\\big(m - m_\\mathrm{pref}(x)\\big)^2,\n$$\nwhere $x_0$ is the initial lattice oxygen–oxygen separation minimum, $x_1$ is the final molecular oxygen bond length minimum, $E_0$ sets the scale of the double-well barrier along $x$, $k_m$ penalizes cation migration away from its local preference, and\n$$\nm_\\mathrm{pref}(x) \\;=\\; \\gamma \\,\\exp\\!\\left(-\\frac{(x - x_1)^2}{2s^2}\\right)\n$$\nis the preferred cation migration amplitude as a function of $x$ with amplitude $\\gamma$ and width $s$ (both dimensionless). This functional form captures that cation migration becomes energetically favorable when an oxygen–oxygen dimer begins to form near $x \\approx x_1$.\n\nYour tasks are:\n1. Implement a discrete NEB algorithm with $N_\\text{img}$ images, fixed endpoints, constant spring stiffness $k_s$ (dimensionless with respect to the coordinates), and steepest-descent updates. At each iteration, for interior images $i \\in \\{1,\\dots,N_\\text{img}-2\\}$:\n   - Compute the tangent unit vector $\\hat{\\boldsymbol{\\tau}}_i$ from adjacent images using a central difference chord $\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}$ and normalizing it to unit length.\n   - Compute the true force $\\mathbf{F}^{\\mathrm{true}}_i \\,=\\, -\\nabla E(\\mathbf{R}_i)$ and its perpendicular component $\\mathbf{F}^{\\perp}_i \\,=\\, \\mathbf{F}^{\\mathrm{true}}_i - \\big(\\mathbf{F}^{\\mathrm{true}}_i \\cdot \\hat{\\boldsymbol{\\tau}}_i\\big)\\,\\hat{\\boldsymbol{\\tau}}_i$.\n   - Compute the spring force along the tangent $\\mathbf{F}^{\\mathrm{spr}}_i \\,=\\, k_s\\big(\\lVert \\mathbf{R}_{i+1} - \\mathbf{R}_i\\rVert - \\lVert \\mathbf{R}_i - \\mathbf{R}_{i-1}\\rVert\\big)\\,\\hat{\\boldsymbol{\\tau}}_i$.\n   - Use the NEB force $\\mathbf{F}_i \\,=\\, \\mathbf{F}^{\\perp}_i + \\mathbf{F}^{\\mathrm{spr}}_i$ for the update.\n   - Keep endpoints $i=0$ and $i=N_\\text{img}-1$ fixed at the prescribed minima.\n   - Iterate until the maximum NEB force norm over interior images is less than a tolerance $\\varepsilon$, or a maximum number of iterations is reached.\n2. For each converged path, compute:\n   - The activation barrier $\\Delta E^\\ddagger$ in electronvolts (eV), defined as the maximum energy along the converged images minus the energy at the initial image.\n   - The cation migration amplitude at the highest-energy image $m_\\mathrm{TS}$ (dimensionless).\n3. Express the activation barrier $\\Delta E^\\ddagger$ in $\\mathrm{eV}$, rounded to three decimals, and $m_\\mathrm{TS}$ as a decimal rounded to three decimals.\n4. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $[\\Delta E^\\ddagger, m_\\mathrm{TS}]$ for each test case in the test suite, preserving order. For example: $[[\\Delta E^\\ddagger_1,m_{\\mathrm{TS},1}],[\\Delta E^\\ddagger_2,m_{\\mathrm{TS},2}],\\dots]$.\n\nConstants and computational parameters to use in all cases:\n- Use $N_\\text{img} = 11$ images, linearly interpolated between endpoints for initialization.\n- Use $k_s = 5.0$.\n- Use a steepest-descent step $\\Delta t = 0.02$.\n- Use a convergence tolerance $\\varepsilon = 10^{-3}$ and a maximum of $N_\\text{iter}^\\mathrm{max} = 2000$ iterations.\n- Fix endpoints at $(x_0,0)$ and $(x_1,\\gamma)$.\n\nTest suite. For each parameter set below, compute and return $[\\Delta E^\\ddagger, m_\\mathrm{TS}]$ as specified:\n- Case $1$ (happy path, moderate coupling): $E_0 = 1.0\\,\\mathrm{eV}$, $k_m = 1.0$, $\\gamma = 1.0$, $s = 0.6$, $x_0 = 3.0\\,\\mathrm{\\AA}$, $x_1 = 1.25\\,\\mathrm{\\AA}$.\n- Case $2$ (edge case, strong penalty for migration): $E_0 = 1.0\\,\\mathrm{eV}$, $k_m = 5.0$, $\\gamma = 1.0$, $s = 0.6$, $x_0 = 3.0\\,\\mathrm{\\AA}$, $x_1 = 1.25\\,\\mathrm{\\AA}$.\n- Case $3$ (boundary case, zero coupling): $E_0 = 1.0\\,\\mathrm{eV}$, $k_m = 1.0$, $\\gamma = 0.0$, $s = 0.6$, $x_0 = 3.0\\,\\mathrm{\\AA}$, $x_1 = 1.25\\,\\mathrm{\\AA}$.\n\nUnits and rounding:\n- Report $\\Delta E^\\ddagger$ in $\\mathrm{eV}$, rounded to three decimals.\n- Report $m_\\mathrm{TS}$ as a decimal rounded to three decimals.\n- Angles are not used.\n- Percentages are not used.\n\nYour program must not read any input and must emit exactly one line in the required output format.",
            "solution": "The user has provided a valid problem. The analysis proceeds as follows.\n\nThe problem requires the implementation of the Nudged Elastic Band (NEB) method to find the minimum energy path (MEP) for oxygen molecule formation on a given two-dimensional potential energy surface (PES), $E(x,m)$. The coordinates are the O-O separation $x$ and a cation migration coordinate $m$. The objective is to compute the activation energy barrier $\\Delta E^\\ddagger$ and the extent of cation migration at the transition state, $m_\\mathrm{TS}$, for several parameter sets.\n\nThe provided potential energy surface is given by:\n$$\nE(x,m) = E_0(x - x_0)^2(x - x_1)^2 + \\frac{1}{2}k_m\\big(m - m_\\mathrm{pref}(x)\\big)^2\n$$\nwhere the term $m_\\mathrm{pref}(x)$ represents the preferred cation configuration as a function of the oxygen separation $x$:\n$$\nm_\\mathrm{pref}(x) = \\gamma \\exp\\left(-\\frac{(x - x_1)^2}{2s^2}\\right)\n$$\nThis PES models a double-well potential along the $x$-coordinate, describing the initial and final states of the O-O bond, coupled to a harmonic-like potential along the $m$-coordinate, which penalizes deviations from an $x$-dependent preferred cation configuration.\n\nThe first step in implementing the NEB algorithm is to compute the true force on each image, which is the negative gradient of the potential energy, $\\mathbf{F}^{\\mathrm{true}} = -\\nabla E(x,m)$. The components of the gradient are derived analytically:\n$$\n\\frac{\\partial E}{\\partial x} = 2 E_0 (x-x_0)(x-x_1) (2x - x_0 - x_1) + k_m \\frac{(x-x_1)}{s^2} (m - m_\\mathrm{pref}(x)) m_\\mathrm{pref}(x)\n$$\n$$\n\\frac{\\partial E}{\\partial m} = k_m (m - m_\\mathrm{pref}(x))\n$$\nThe NEB method approximates the MEP using a discrete set of images, $\\{\\mathbf{R}_i\\}_{i=0}^{N_\\mathrm{img}-1}$, where each image is a point $\\mathbf{R}_i = (x_i, m_i)$ in the coordinate space. The images are connected by springs to form a path, or \"elastic band\", between fixed initial and final states, $\\mathbf{R}_0 = (x_0, 0)$ and $\\mathbf{R}_{N_\\mathrm{img}-1} = (x_1, \\gamma)$. The algorithm iteratively updates the positions of the intermediate images, $i \\in \\{1, \\dots, N_\\mathrm{img}-2\\}$, to minimize the energy of the band.\n\nThe force on each interior image $i$, $\\mathbf{F}_i$, is a sum of two components: the perpendicular component of the true force, $\\mathbf{F}^{\\perp}_i$, and a parallel spring force, $\\mathbf{F}^{\\mathrm{spr}}_i$.\nTo calculate these forces, the local tangent to the path at image $i$ is first estimated using a central difference scheme:\n$$\n\\hat{\\boldsymbol{\\tau}}_i = \\frac{\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}}{\\lVert\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}\\rVert}\n$$\nThe component of the true force perpendicular to this tangent is then computed. This force component drives the path towards the MEP without causing the images to slide down the path:\n$$\n\\mathbf{F}^{\\perp}_i = \\mathbf{F}^{\\mathrm{true}}_i - \\big(\\mathbf{F}^{\\mathrm{true}}_i \\cdot \\hat{\\boldsymbol{\\tau}}_i\\big)\\hat{\\boldsymbol{\\tau}}_i\n$$\nThe spring force component acts along the tangent and serves to maintain an approximately equal spacing between the images. It is defined as:\n$$\n\\mathbf{F}^{\\mathrm{spr}}_i = k_s\\big(\\lVert \\mathbf{R}_{i+1} - \\mathbf{R}_i\\rVert - \\lVert \\mathbf{R}_i - \\mathbf{R}_{i-1}\\rVert\\big)\\hat{\\boldsymbol{\\tau}}_i\n$$\nwhere $k_s$ is the spring constant. The total NEB force on image $i$ is the sum of these two components:\n$$\n\\mathbf{F}_i = \\mathbf{F}^{\\perp}_i + \\mathbf{F}^{\\mathrm{spr}}_i\n$$\nThe images are updated using a steepest descent optimization scheme. At each iteration, the positions of the interior images are moved in the direction of the NEB force:\n$$\n\\mathbf{R}_i \\leftarrow \\mathbf{R}_i + \\Delta t \\,\\mathbf{F}_i\n$$\nwhere $\\Delta t$ is a small, fixed time step.\n\nThe implementation begins by initializing the path. The $N_\\text{img} = 11$ images are created, with the endpoints fixed at $\\mathbf{R}_0 = (x_0, 0)$ and $\\mathbf{R}_{10} = (x_1, \\gamma)$. The interior images are initialized by linear interpolation between these endpoints. The system is then evolved iteratively. The process terminates when the maximum norm of the NEB force on any interior image falls below a tolerance $\\varepsilon = 10^{-3}$, or when a maximum of $N_\\text{iter}^\\mathrm{max} = 2000$ iterations is reached.\n\nUpon convergence, the final path provides an approximation of the MEP. The energy of each image on the converged path is calculated. The activation barrier, $\\Delta E^\\ddagger$, is determined by finding the maximum energy along the path, $E_\\mathrm{max} = \\max_{i} E(\\mathbf{R}_i)$, and subtracting the energy of the initial state, $E(\\mathbf{R}_0)$.\n$$\n\\Delta E^\\ddagger = E_\\mathrm{max} - E(\\mathbf{R}_0)\n$$\nThe image with the highest energy is identified as the transition state (TS). The cation migration at the transition state, $m_\\mathrm{TS}$, is the value of the $m$-coordinate of this highest-energy image. The final results, $\\Delta E^\\ddagger$ and $m_\\mathrm{TS}$, are rounded to three decimal places as specified. This procedure is repeated for each of the three test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the NEB simulation for all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'E0': 1.0, 'km': 1.0, 'gamma': 1.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 1\n        {'E0': 1.0, 'km': 5.0, 'gamma': 1.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 2\n        {'E0': 1.0, 'km': 1.0, 'gamma': 0.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 3\n    ]\n\n    # Computational parameters\n    params = {\n        'N_img': 11,\n        'ks': 5.0,\n        'dt': 0.02,\n        'epsilon': 1e-3,\n        'N_iter_max': 2000,\n    }\n\n    results = []\n    for case in test_cases:\n        # Combine case-specific and general parameters\n        current_params = {**case, **params}\n        result = run_neb_for_case(current_params)\n        results.append(result)\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef run_neb_for_case(p):\n    \"\"\"\n    Performs a Nudged Elastic Band simulation for a single parameter set.\n\n    Args:\n        p (dict): A dictionary containing all parameters for the simulation.\n\n    Returns:\n        list: A list containing [delta_E_rounded, m_ts_rounded].\n    \"\"\"\n    # Unpack parameters\n    E0, km, gamma, s, x0, x1 = p['E0'], p['km'], p['gamma'], p['s'], p['x0'], p['x1']\n    N_img, ks, dt, epsilon, N_iter_max = p['N_img'], p['ks'], p['dt'], p['epsilon'], p['N_iter_max']\n\n    def m_pref(x):\n        return gamma * np.exp(-(x - x1)**2 / (2 * s**2))\n\n    def potential_energy(r):\n        x, m = r\n        m_p = m_pref(x)\n        return E0 * (x - x0)**2 * (x - x1)**2 + 0.5 * km * (m - m_p)**2\n\n    def gradient(r):\n        x, m = r\n        m_p = m_pref(x)\n        \n        # dE/dx\n        grad_x_term1 = 2 * E0 * (x - x0) * (x - x1) * (2*x - x0 - x1)\n        grad_x_term2 = km * (x - x1) / s**2 * (m - m_p) * m_p\n        grad_x = grad_x_term1 + grad_x_term2\n        \n        # dE/dm\n        grad_m = km * (m - m_p)\n        \n        return np.array([grad_x, grad_m])\n\n    # Initialize the path (band)\n    R = np.zeros((N_img, 2))\n    R0 = np.array([x0, 0.0])\n    R_end = np.array([x1, gamma])\n    for i in range(N_img):\n        R[i] = R0 + i / (N_img - 1.0) * (R_end - R0)\n\n    # Optimization loop\n    for _ in range(N_iter_max):\n        forces = np.zeros_like(R)\n        \n        # Calculate forces on interior images\n        for i in range(1, N_img - 1):\n            # Tangent calculation\n            tau = R[i+1] - R[i-1]\n            tau_norm = np.linalg.norm(tau)\n            if tau_norm < 1e-9: # Safety check\n                tau_hat = np.zeros(2)\n            else:\n                tau_hat = tau / tau_norm\n\n            # True force calculation\n            F_true = -gradient(R[i])\n            \n            # Perpendicular component of the true force\n            F_perp = F_true - np.dot(F_true, tau_hat) * tau_hat\n            \n            # Spring force component\n            d_plus = np.linalg.norm(R[i+1] - R[i])\n            d_minus = np.linalg.norm(R[i] - R[i-1])\n            F_spring_mag = ks * (d_plus - d_minus)\n            F_spring = F_spring_mag * tau_hat\n            \n            # Total NEB force\n            forces[i] = F_perp + F_spring\n\n        # Update positions\n        R[1:-1] += dt * forces[1:-1]\n        \n        # Check for convergence\n        max_force_norm = np.max(np.linalg.norm(forces[1:-1], axis=1))\n        if max_force_norm < epsilon:\n            break\n\n    # Calculate final results from the converged path\n    energies = np.array([potential_energy(r) for r in R])\n    \n    E_initial = energies[0]\n    E_max = np.max(energies)\n    delta_E = E_max - E_initial\n    \n    ts_idx = np.argmax(energies)\n    m_ts = R[ts_idx, 1]\n\n    # Round to specified precision\n    delta_E_rounded = round(delta_E, 3)\n    m_ts_rounded = round(m_ts, 3)\n    \n    return [delta_E_rounded, m_ts_rounded]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}