{
    "hands_on_practices": [
        {
            "introduction": "理解氧气释放何时在能量上变得有利，是评估正极材料稳定性的第一步。本练习通过化学势的概念，将原子尺度的密度泛函理论（DFT）能量与宏观热力学条件（温度和压力）联系起来。通过完成此计算，您将对控制层状氧化物中氧气释放的热力学驱动力有定量的理解。",
            "id": "3935653",
            "problem": "给定一个通过密度泛函理论（DFT）建模的层状氧化物正极超胞，将热力学释氧过程视为一个中性氧空位的形成过程，该过程与一个由温度和分压表征的外部双原子氧气气库进行氧交换。使用形成自由能的基本热力学定义和理想气体化学势关系式，计算空位形成自由能以及释氧在热力学上变得有利时的临界氧分压。推导必须从以下基础出发：(i) 平衡态的吉布斯自由能最小化，(ii) 理想气体的化学势定义，以及 (iii) 氧原子和双原子氧分子之间的化学计量关系。假设为空位是中性的（无静电项），并且相对于电子DFT能量，固态有限温度修正是可以忽略的。目标是计算在指定条件下单个氧空位的形成自由能，以及形成自由能为零时的临界氧分压。\n\n定义与假设：\n- 令 $E_{\\mathrm{perf}}$ 为完美超胞的DFT总能量，单位为 $\\mathrm{eV}$。\n- 令 $E_{\\mathrm{def}}$ 为含有一个氧空位的超胞的DFT总能量，单位为 $\\mathrm{eV}$。\n- 令 $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$ 为DFT能量差，单位为 $\\mathrm{eV}$。\n- 每个氧原子的氧化学势为 $\\mu_{\\mathrm{O}}(T,p)$，与双原子氧的化学势关系为 $\\mu_{\\mathrm{O}}(T,p) = \\tfrac{1}{2}\\mu_{\\mathrm{O}_2}(T,p)$。\n- 对于理想气体，$\\mu_{\\mathrm{O}_2}(T,p) = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度（单位为 $\\mathrm{K}$），$p$ 是氧分压（单位为 $\\mathrm{bar}$），$p^{\\circ}$ 是参考压力（单位为 $\\mathrm{bar}$）。量 $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$ 是在指定温度和参考压力下的双原子氧化学势，以 $\\mathrm{eV}$ 表示，与DFT能量参考选择一致。\n- 在 $(T,p)$ 条件下，中性氧空位的形成自由能为 $G_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\mu_{\\mathrm{O}}(T,p)$，单位为 $\\mathrm{eV}$。\n- 当 $G_{f}(V_{\\mathrm{O}};T,p) \\leq 0$ 时，释氧在热力学上是有利的。\n- 临界氧分压由条件 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$ 定义。\n\n您的任务是编写一个程序，为每个测试用例计算：\n1. 在指定的评估压力 $p_{\\mathrm{eval}}$ 下的 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$，单位为 $\\mathrm{eV}$。\n2. 使得 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$ 成立的 $p_{\\mathrm{crit}}$，单位为 $\\mathrm{bar}$。\n\n使用 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$。\n\n所有能量以 $\\mathrm{eV}$ 表示，所有压力以 $\\mathrm{bar}$ 表示。本问题不涉及角度。您的程序应生成单行输出，其中包含结果，格式为方括号内以逗号分隔的列表，顺序为 $\\left[G_{f,1},p_{\\mathrm{crit},1},G_{f,2},p_{\\mathrm{crit},2},\\ldots\\right]$。\n\n测试套件：\n- 案例 A（一般情况）：\n  - $E_{\\mathrm{perf}} = -1000.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -998.000\\ \\mathrm{eV}$\n  - $T = 800\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -3.500\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 0.210\\ \\mathrm{bar}$\n- 案例 B（边界条件 $p_{\\mathrm{crit}} = p^{\\circ}$）：\n  - $E_{\\mathrm{perf}} = -1200.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -1198.000\\ \\mathrm{eV}$\n  - $T = 1000\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.000\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 1.000\\ \\mathrm{bar}$\n- 案例 C（高 $p_{\\mathrm{crit}}$）：\n  - $E_{\\mathrm{perf}} = -500.000\\ \\mathrm{eV}$\n  - $E_{\\mathrm{def}} = -498.000\\ \\mathrm{eV}$\n  - $T = 800\\ \\mathrm{K}$\n  - $p^{\\circ} = 1.000\\ \\mathrm{bar}$\n  - $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) = -4.317\\ \\mathrm{eV}$\n  - $p_{\\mathrm{eval}} = 10.000\\ \\mathrm{bar}$\n\n最终输出必须是遵循确切格式的单行文本：一个方括号内包含六个浮点数结果并以逗号分隔的列表，按顺序对应三个案例。",
            "solution": "目标是为每个测试用例计算两个量：在指定的评估压力 $p_{\\mathrm{eval}}$ 下的空位形成自由能 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$，以及空位形成变为热力学自发（$G_f=0$）时的临界氧分压 $p_{\\mathrm{crit}}$。解决方案是从提供的基本热力学关系推导出来的。\n\n首先，我们建立工作方程。中性氧空位的形成自由能 $G_{f}(V_{\\mathrm{O}};T,p)$ 由下式给出：\n$$\nG_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\mu_{\\mathrm{O}}(T,p)\n$$\n其中 $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$ 是有缺陷超胞和完美超胞之间的能量差。氧化学势 $\\mu_{\\mathrm{O}}(T,p)$ 由外部氧气气库决定，该气库被建模为理想气体。它通过化学计量关系与双原子氧的化学势 $\\mu_{\\mathrm{O}_2}(T,p)$ 相关联：\n$$\n\\mu_{\\mathrm{O}}(T,p) = \\frac{1}{2}\\mu_{\\mathrm{O}_2}(T,p)\n$$\n双原子氧气的化学势取决于温度 $T$ 和分压 $p$，如下所示：\n$$\n\\mu_{\\mathrm{O}_2}(T,p) = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right)\n$$\n这里，$\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$ 是在参考压力 $p^{\\circ}$ 下的化学势，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n\n结合这些表达式，我们得到空位形成自由能对温度和压力的完整依赖关系：\n$$\nG_{f}(V_{\\mathrm{O}};T,p) = \\Delta E + \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p}{p^{\\circ}}\\right) \\right]\n$$\n该方程构成了我们第一个计算任务的基础。\n\n**第 1 部分：计算 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}})$**\n为了计算在指定评估压力 $p_{\\mathrm{eval}}$ 下的形成自由能，我们将 $p=p_{\\mathrm{eval}}$ 代入推导出的方程中：\n$$\nG_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{eval}}) = (E_{\\mathrm{def}} - E_{\\mathrm{perf}}) + \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{eval}}}{p^{\\circ}}\\right) \\right]\n$$\n算法步骤是首先计算 $\\Delta E = E_{\\mathrm{def}} - E_{\\mathrm{perf}}$，然后将特定测试用例的所有给定参数（$T$, $p_{\\mathrm{eval}}$, $p^{\\circ}$, $\\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})$）和常数 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$ 代入此表达式。\n\n**第 2 部分：计算 $p_{\\mathrm{crit}}$**\n临界压力 $p_{\\mathrm{crit}}$ 由释氧在热力学上变得有利的条件定义，即 $G_{f}(V_{\\mathrm{O}};T,p_{\\mathrm{crit}}) = 0$。我们将形成能表达式设为零，并求解压力，此时压力即为 $p_{\\mathrm{crit}}$：\n$$\n0 = \\Delta E + \\mu_{\\mathrm{O}}(T,p_{\\mathrm{crit}})\n$$\n$$\n-\\Delta E = \\mu_{\\mathrm{O}}(T,p_{\\mathrm{crit}}) = \\frac{1}{2} \\left[ \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) \\right]\n$$\n重新整理以求解 $p_{\\mathrm{crit}}$：\n$$\n-2\\Delta E = \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ}) + k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right)\n$$\n$$\nk_{\\mathrm{B}} T \\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) = -2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})\n$$\n$$\n\\ln\\!\\left(\\frac{p_{\\mathrm{crit}}}{p^{\\circ}}\\right) = \\frac{-2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T}\n$$\n对两边取指数，得到 $p_{\\mathrm{crit}}$ 的最终表达式：\n$$\np_{\\mathrm{crit}} = p^{\\circ} \\exp\\left( \\frac{-2\\Delta E - \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T} \\right) = p^{\\circ} \\exp\\left( -\\frac{2(E_{\\mathrm{def}} - E_{\\mathrm{perf}}) + \\mu_{\\mathrm{O}_2}^{\\circ}(T,p^{\\circ})}{k_{\\mathrm{B}} T} \\right)\n$$\n该算法实现了这个解析公式，同样是代入每个测试用例的给定参数。\n\n最终的程序将系统地将这两个推导出的公式应用于所提供的三个测试用例中的每一个，收集每个案例的结果（$G_f$ 和 $p_{\\mathrm{crit}}$），并将其格式化为指定的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the oxygen vacancy formation free energy and the critical oxygen\n    partial pressure for layered oxide cathodes based on DFT energies and\n    thermodynamic principles.\n    \"\"\"\n    # Define the Boltzmann constant in eV/K.\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_perf, E_def, T, p_circ, mu_O2_circ, p_eval)\n    test_cases = [\n        # Case A (general case)\n        (-1000.000, -998.000, 800, 1.000, -3.500, 0.210),\n        # Case B (boundary condition p_crit = p_circ)\n        (-1200.000, -1198.000, 1000, 1.000, -4.000, 1.000),\n        # Case C (high p_crit)\n        (-500.000, -498.000, 800, 1.000, -4.317, 10.000),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_perf, E_def, T, p_circ, mu_O2_circ, p_eval = case\n\n        # Calculate DFT energy difference\n        delta_E = E_def - E_perf\n\n        # Calculate thermal energy term\n        k_B_T = k_B * T\n\n        # Part 1: Calculate the formation free energy G_f at p_eval\n        # G_f(T, p) = delta_E + 0.5 * (mu_O2_circ + k_B * T * ln(p / p_circ))\n        ln_term_Gf = np.log(p_eval / p_circ)\n        Gf_eval = delta_E + 0.5 * (mu_O2_circ + k_B_T * ln_term_Gf)\n        results.append(Gf_eval)\n\n        # Part 2: Calculate the critical pressure p_crit\n        # p_crit = p_circ * exp(-(2*delta_E + mu_O2_circ) / (k_B * T))\n        exponent = -(2 * delta_E + mu_O2_circ) / k_B_T\n        p_crit = p_circ * np.exp(exponent)\n        results.append(p_crit)\n\n    # Format the final output as a single line: a comma-separated list of\n    # floating-point results enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "即使氧气释放在热力学上是可能的，其速率也受反应路径的能垒控制。本练习采用“微动弹性带”（Nudged Elastic Band, NEB）方法，这是一种强大的计算技术，用于寻找化学反应的最小能量路径和活化能。通过实现一个简化的NEB模拟，您将获得模拟反应动力学的实践经验，并了解阳离子迁移等结构变化如何影响O$_2$形成的能垒。",
            "id": "3935649",
            "problem": "考虑一个简化的二维势能面，用于模拟高压充电过程中层状氧化物中两个相邻晶格氧形成氧分子的过程。两个集体坐标分别是氧-氧间距 $x$（单位为埃，记作 $\\mathrm{\\AA}$）和一个标量阳离子迁移坐标 $m$（无量纲）。目标是使用微动弹性带 (Nudged Elastic Band, NEB) 方法构建氧分子形成的最小能量反应坐标，并量化阳离子迁移在促进氧-氧键形成中的作用。\n\n从以下基本且经过充分检验的基础出发：\n- 系统在势能面 $E(x,m)$ 上的总能量沿着热力学稳定构型最小化。\n- 一个由 $N_\\text{img}$ 个“像”组成的离散NEB链 $\\{\\mathbf{R}_i\\}_{i=0}^{N_\\text{img}-1}$（其中 $\\mathbf{R}_i = (x_i, m_i)$）通过最小化真实势在切线法向上的投影与路径上的谐振子弹簧能量之和，来近似连接固定端点的路径。\n- 最速下降动力学根据 $\\mathbf{R}_i \\leftarrow \\mathbf{R}_i + \\Delta t \\,\\mathbf{F}_i$ 更新位置，其中 $\\mathbf{F}_i$ 是作用在像 $i$ 上的NEB力，$\\Delta t$ 是一个喁的时间步长。\n\n势能面定义为\n$$\nE(x,m) \\;=\\; E_0\\,(x - x_0)^2\\,(x - x_1)^2 \\;+\\; \\frac{1}{2}\\,k_m\\,\\big(m - m_\\mathrm{pref}(x)\\big)^2,\n$$\n其中 $x_0$ 是初始晶格氧-氧间距的最小值，$x_1$ 是最终氧分子键长的最小值，$E_0$ 设定了沿 $x$ 轴的双势阱能垒的尺度，$k_m$ 用于惩罚阳离子偏离其局部偏好位置的迁移，以及\n$$\nm_\\mathrm{pref}(x) \\;=\\; \\gamma \\,\\exp\\!\\left(-\\frac{(x - x_1)^2}{2s^2}\\right)\n$$\n是作为 $x$ 函数的优选阳离子迁移幅度，其振幅为 $\\gamma$，宽度为 $s$（两者均为无量纲）。该函数形式表明，当氧-氧二聚体在 $x \\approx x_1$ 附近开始形成时，阳离子迁移在能量上变得有利。\n\n您的任务是：\n1. 实现一个离散NEB算法，包含 $N_\\text{img}$ 个像、固定的端点、恒定的弹簧刚度 $k_s$（相对于坐标是无量纲的）以及最速下降更新。在每次迭代中，对于内部的像 $i \\in \\{1,\\dots,N_\\text{img}-2\\}$：\n   - 使用中心差分弦 $\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}$ 计算相邻像之间的切线单位向量 $\\hat{\\boldsymbol{\\tau}}_i$，并将其归一化。\n   - 计算真实力 $\\mathbf{F}^{\\mathrm{true}}_i \\,=\\, -\\nabla E(\\mathbf{R}_i)$ 及其垂直分量 $\\mathbf{F}^{\\perp}_i \\,=\\, \\mathbf{F}^{\\mathrm{true}}_i - \\big(\\mathbf{F}^{\\mathrm{true}}_i \\cdot \\hat{\\boldsymbol{\\tau}}_i\\big)\\,\\hat{\\boldsymbol{\\tau}}_i$。\n   - 计算沿切线方向的弹簧力 $\\mathbf{F}^{\\mathrm{spr}}_i \\,=\\, k_s\\big(\\lVert \\mathbf{R}_{i+1} - \\mathbf{R}_i\\rVert - \\lVert \\mathbf{R}_i - \\mathbf{R}_{i-1}\\rVert\\big)\\,\\hat{\\boldsymbol{\\tau}}_i$。\n   - 使用NEB力 $\\mathbf{F}_i \\,=\\, \\mathbf{F}^{\\perp}_i + \\mathbf{F}^{\\mathrm{spr}}_i$ 进行更新。\n   - 保持端点 $i=0$ 和 $i=N_\\text{img}-1$ 固定在预设的最小值处。\n   - 迭代直至所有内部像上的最大NEB力范数小于容差 $\\varepsilon$，或达到最大迭代次数。\n2. 对每个收敛的路径，计算：\n   - 活化能垒 $\\Delta E^\\ddagger$（单位为电子伏特，eV），定义为收敛路径上的最大能量减去初始像的能量。\n   - 最高能量像处的阳离子迁移幅度 $m_\\mathrm{TS}$（无量纲）。\n3. 将活化能垒 $\\Delta E^\\ddagger$ 以 $\\mathrm{eV}$ 为单位表示，四舍五入到三位小数；将 $m_\\mathrm{TS}$ 表示为小数，四舍五入到三位小数。\n4. 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是测试套件中每个测试用例的 $[\\Delta E^\\ddagger, m_\\mathrm{TS}]$ 双元素列表，并保持顺序。例如：$[[\\Delta E^\\ddagger_1,m_{\\mathrm{TS},1}],[\\Delta E^\\ddagger_2,m_{\\mathrm{TS},2}],\\dots]$。\n\n在所有情况下使用的常量和计算参数：\n- 使用 $N_\\text{img} = 11$ 个像，通过端点之间的线性插值进行初始化。\n- 使用 $k_s = 5.0$。\n- 使用最速下降步长 $\\Delta t = 0.02$。\n- 使用收敛容差 $\\varepsilon = 10^{-3}$ 和最大迭代次数 $N_\\text{iter}^\\mathrm{max} = 2000$。\n- 将端点固定在 $(x_0,0)$ 和 $(x_1,\\gamma)$。\n\n测试套件。对于下面的每个参数集，按规定计算并返回 $[\\Delta E^\\ddagger, m_\\mathrm{TS}]$：\n- 情况1（理想路径，中等耦合）：$E_0 = 1.0\\,\\mathrm{eV}$，$k_m = 1.0$，$\\gamma = 1.0$，$s = 0.6$，$x_0 = 3.0\\,\\mathrm{\\AA}$，$x_1 = 1.25\\,\\mathrm{\\AA}$。\n- 情况2（边缘情况，强迁移惩罚）：$E_0 = 1.0\\,\\mathrm{eV}$，$k_m = 5.0$，$\\gamma = 1.0$，$s = 0.6$，$x_0 = 3.0\\,\\mathrm{\\AA}$，$x_1 = 1.25\\,\\mathrm{\\AA}$。\n- 情况3（边界情况，零耦合）：$E_0 = 1.0\\,\\mathrm{eV}$，$k_m = 1.0$，$\\gamma = 0.0$，$s = 0.6$，$x_0 = 3.0\\,\\mathrm{\\AA}$，$x_1 = 1.25\\,\\mathrm{\\AA}$。\n\n单位与四舍五入：\n- 以 $\\mathrm{eV}$ 为单位报告 $\\Delta E^\\ddagger$，四舍五入到三位小数。\n- 将 $m_\\mathrm{TS}$ 报告为小数，四舍五入到三位小数。\n- 不使用角度。\n- 不使用百分比。\n\n您的程序不得读取任何输入，并且必须以所需的输出格式精确输出一行。",
            "solution": "该问题要求实现微动弹性带 (Nudged Elastic Band, NEB) 方法，以在给定的二维势能面 (potential energy surface, PES) $E(x,m)$ 上找到氧分子形成的最小能量路径 (minimum energy path, MEP)。坐标为 O-O 间距 $x$ 和阳离子迁移坐标 $m$。目标是为几组参数集计算活化能垒 $\\Delta E^\\ddagger$ 和过渡态时的阳离子迁移程度 $m_\\mathrm{TS}$。\n\n给定的势能面由以下公式给出：\n$$\nE(x,m) = E_0(x - x_0)^2(x - x_1)^2 + \\frac{1}{2}k_m\\big(m - m_\\mathrm{pref}(x)\\big)^2\n$$\n其中，$m_\\mathrm{pref}(x)$ 项代表作为氧间距 $x$ 函数的优选阳离子构型：\n$$\nm_\\mathrm{pref}(x) = \\gamma \\exp\\left(-\\frac{(x - x_1)^2}{2s^2}\\right)\n$$\n此势能面模型描述了沿 $x$ 坐标的双势阱势，该势描述了 O-O 键的初态和末态，并与沿 $m$ 坐标的类谐振子势耦合，该势用于惩罚偏离依赖于 $x$ 的优选阳离子构型的行为。\n\n实现 NEB 算法的第一步是计算每个像上的真实力，即势能的负梯度 $\\mathbf{F}^{\\mathrm{true}} = -\\nabla E(x,m)$。梯度的分量可解析推导如下：\n$$\n\\frac{\\partial E}{\\partial x} = 2 E_0 (x-x_0)(x-x_1) (2x - x_0 - x_1) + k_m \\frac{(x-x_1)}{s^2} (m - m_\\mathrm{pref}(x)) m_\\mathrm{pref}(x)\n$$\n$$\n\\frac{\\partial E}{\\partial m} = k_m (m - m_\\mathrm{pref}(x))\n$$\nNEB 方法使用一组离散的像 $\\{\\mathbf{R}_i\\}_{i=0}^{N_\\mathrm{img}-1}$ 来近似 MEP，其中每个像都是坐标空间中的一个点 $\\mathbf{R}_i = (x_i, m_i)$。这些像通过弹簧连接，形成一条在固定的初态 $\\mathbf{R}_0 = (x_0, 0)$ 和末态 $\\mathbf{R}_{N_\\mathrm{img}-1} = (x_1, \\gamma)$ 之间的路径，即“弹性带”。该算法迭代更新中间像的位置（$i \\in \\{1, \\dots, N_\\mathrm{img}-2\\}$），以最小化弹性带的能量。\n\n作用于每个内部像 $i$ 的力 $\\mathbf{F}_i$ 是两个分量的和：真实力的垂直分量 $\\mathbf{F}^{\\perp}_i$ 和一个平行的弹簧力 $\\mathbf{F}^{\\mathrm{spr}}_i$。\n为计算这些力，首先使用中心差分格式估算在像 $i$ 处的路径局部切线：\n$$\n\\hat{\\boldsymbol{\\tau}}_i = \\frac{\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}}{\\lVert\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}\\rVert}\n$$\n然后计算真实力垂直于该切线的分量。该力分量将路径推向 MEP，而不会导致像沿路径滑落：\n$$\n\\mathbf{F}^{\\perp}_i = \\mathbf{F}^{\\mathrm{true}}_i - \\big(\\mathbf{F}^{\\mathrm{true}}_i \\cdot \\hat{\\boldsymbol{\\tau}}_i\\big)\\hat{\\boldsymbol{\\tau}}_i\n$$\n弹簧力分量沿切线方向作用，用于在像之间维持近似相等的间距。其定义为：\n$$\n\\mathbf{F}^{\\mathrm{spr}}_i = k_s\\big(\\lVert \\mathbf{R}_{i+1} - \\mathbf{R}_i\\rVert - \\lVert \\mathbf{R}_i - \\mathbf{R}_{i-1}\\rVert\\big)\\hat{\\boldsymbol{\\tau}}_i\n$$\n其中 $k_s$ 是弹簧常数。作用于像 $i$ 的总 NEB 力是这两个分量的和：\n$$\n\\mathbf{F}_i = \\mathbf{F}^{\\perp}_i + \\mathbf{F}^{\\mathrm{spr}}_i\n$$\n使用最速下降优化方案更新像的位置。在每次迭代中，内部像的位置沿 NEB 力的方向移动：\n$$\n\\mathbf{R}_i \\leftarrow \\mathbf{R}_i + \\Delta t \\,\\mathbf{F}_i\n$$\n其中 $\\Delta t$ 是一个小的固定时间步长。\n\n实现始于路径的初始化。创建 $N_\\text{img} = 11$ 个像，其端点固定在 $\\mathbf{R}_0 = (x_0, 0)$ 和 $\\mathbf{R}_{10} = (x_1, \\gamma)$。内部像通过在这些端点之间进行线性插值来初始化。然后系统进行迭代演化。当任何内部像上的 NEB 力的最大范数降至容差 $\\varepsilon = 10^{-3}$ 以下，或达到最大迭代次数 $N_\\text{iter}^\\mathrm{max} = 2000$ 时，该过程终止。\n\n收敛后，最终路径提供了对 MEP 的近似。计算收敛路径上每个像的能量。通过找到路径上的最大能量 $E_\\mathrm{max} = \\max_{i} E(\\mathbf{R}_i)$ 并减去初始态的能量 $E(\\mathbf{R}_0)$ 来确定活化能垒 $\\Delta E^\\ddagger$。\n$$\n\\Delta E^\\ddagger = E_\\mathrm{max} - E(\\mathbf{R}_0)\n$$\n能量最高的像被确定为过渡态 (transition state, TS)。过渡态的阳离子迁移 $m_\\mathrm{TS}$ 是这个最高能量像的 $m$ 坐标值。最终结果 $\\Delta E^\\ddagger$ 和 $m_\\mathrm{TS}$ 按要求四舍五入到三位小数。对三个测试用例中的每一个都重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the NEB simulation for all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'E0': 1.0, 'km': 1.0, 'gamma': 1.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 1\n        {'E0': 1.0, 'km': 5.0, 'gamma': 1.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 2\n        {'E0': 1.0, 'km': 1.0, 'gamma': 0.0, 's': 0.6, 'x0': 3.0, 'x1': 1.25}, # Case 3\n    ]\n\n    # Computational parameters\n    params = {\n        'N_img': 11,\n        'ks': 5.0,\n        'dt': 0.02,\n        'epsilon': 1e-3,\n        'N_iter_max': 2000,\n    }\n\n    results = []\n    for case in test_cases:\n        # Combine case-specific and general parameters\n        current_params = {**case, **params}\n        result = run_neb_for_case(current_params)\n        results.append(result)\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef run_neb_for_case(p):\n    \"\"\"\n    Performs a Nudged Elastic Band simulation for a single parameter set.\n\n    Args:\n        p (dict): A dictionary containing all parameters for the simulation.\n\n    Returns:\n        list: A list containing [delta_E_rounded, m_ts_rounded].\n    \"\"\"\n    # Unpack parameters\n    E0, km, gamma, s, x0, x1 = p['E0'], p['km'], p['gamma'], p['s'], p['x0'], p['x1']\n    N_img, ks, dt, epsilon, N_iter_max = p['N_img'], p['ks'], p['dt'], p['epsilon'], p['N_iter_max']\n\n    def m_pref(x):\n        return gamma * np.exp(-(x - x1)**2 / (2 * s**2))\n\n    def potential_energy(r):\n        x, m = r\n        m_p = m_pref(x)\n        return E0 * (x - x0)**2 * (x - x1)**2 + 0.5 * km * (m - m_p)**2\n\n    def gradient(r):\n        x, m = r\n        m_p = m_pref(x)\n        \n        # dE/dx\n        grad_x_term1 = 2 * E0 * (x - x0) * (x - x1) * (2*x - x0 - x1)\n        grad_x_term2 = km * (x - x1) / s**2 * (m - m_p) * m_p\n        grad_x = grad_x_term1 + grad_x_term2\n        \n        # dE/dm\n        grad_m = km * (m - m_p)\n        \n        return np.array([grad_x, grad_m])\n\n    # Initialize the path (band)\n    R = np.zeros((N_img, 2))\n    R0 = np.array([x0, 0.0])\n    R_end = np.array([x1, gamma])\n    for i in range(N_img):\n        R[i] = R0 + i / (N_img - 1.0) * (R_end - R0)\n\n    # Optimization loop\n    for _ in range(N_iter_max):\n        forces = np.zeros_like(R)\n        \n        # Calculate forces on interior images\n        for i in range(1, N_img - 1):\n            # Tangent calculation\n            tau = R[i+1] - R[i-1]\n            tau_norm = np.linalg.norm(tau)\n            if tau_norm  1e-9: # Safety check\n                tau_hat = np.zeros(2)\n            else:\n                tau_hat = tau / tau_norm\n\n            # True force calculation\n            F_true = -gradient(R[i])\n            \n            # Perpendicular component of the true force\n            F_perp = F_true - np.dot(F_true, tau_hat) * tau_hat\n            \n            # Spring force component\n            d_plus = np.linalg.norm(R[i+1] - R[i])\n            d_minus = np.linalg.norm(R[i] - R[i-1])\n            F_spring_mag = ks * (d_plus - d_minus)\n            F_spring = F_spring_mag * tau_hat\n            \n            # Total NEB force\n            forces[i] = F_perp + F_spring\n\n        # Update positions\n        R[1:-1] += dt * forces[1:-1]\n        \n        # Check for convergence\n        max_force_norm = np.max(np.linalg.norm(forces[1:-1], axis=1))\n        if max_force_norm  epsilon:\n            break\n\n    # Calculate final results from the converged path\n    energies = np.array([potential_energy(r) for r in R])\n    \n    E_initial = energies[0]\n    E_max = np.max(energies)\n    delta_E = E_max - E_initial\n    \n    ts_idx = np.argmax(energies)\n    m_ts = R[ts_idx, 1]\n\n    # Round to specified precision\n    delta_E_rounded = round(delta_E, 3)\n    m_ts_rounded = round(m_ts, 3)\n    \n    return [delta_E_rounded, m_ts_rounded]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "材料中氧参与氧化还原反应的倾向，深植于其电子结构之中。本练习使用从态密度计算出的氧$2p$带中心作为描述符，来预测材料的析氧电位。这个练习展示了电子结构的一个关键特征如何能作为预测电化学性质的有力描述符，这也是现代数据驱动材料设计的核心概念之一。",
            "id": "3935623",
            "problem": "一个针对富镍层状氧化物的高通量电子结构工作流程提供了一个关于氧$2p$态的投影态密度（DOS），记为$D_{2p}(E)$，其能量参考费米能级$E_F$，$E=0$。假设在低温下，费米-狄拉克占据数是一个阶跃函数，当$E  E_F$时为1，否则为0。$D_{2p}(E)$由两个对称的抛物线瓣（parabolic lobes）组成，表示如下：\n$$\nD_{2p}(E) = \\begin{cases}\nc_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right)  \\text{for } E \\in [-6.0, -3.0] \\\\\nc_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right)  \\text{for } E \\in (-3.0, 0.0] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其中，能量$E$的单位是$\\mathrm{eV}$，DOS的单位是态数/$\\mathrm{eV}$/氧原子。尺度因子为$c_1=2.0$和$c_2=1.0$。\n\n您的任务是：\n1.  计算被占据的氧$2p$带中心$\\varepsilon_{2p}$，它被定义为被占据$p$态的能量一阶矩，并用总被占据态数进行归一化：\n    $$\n    \\varepsilon_{2p} \\equiv \\frac{\\int_{-\\infty}^{E_F} E \\cdot D_{2p}(E) \\, dE}{\\int_{-\\infty}^{E_F} D_{2p}(E) \\, dE}\n    $$\n2.  使用计算出的$\\varepsilon_{2p}$，在一个已建立的线性标度关系中预测析氧起始电位$E_{\\mathrm{onset}}$（相对于$\\mathrm{Li/Li^+}$）：\n    $$\n    E_{\\mathrm{onset}} = \\alpha \\cdot (-\\varepsilon_{2p}) + \\beta\n    $$\n    其中，$\\alpha = 0.40\\ \\mathrm{V/eV}$是标度因子，$\\beta = 2.80\\ \\mathrm{V}$是偏移量。\n\n以$\\mathrm{V}$为单位给出$E_{\\mathrm{onset}}$的值，四舍五入到三位有效数字。",
            "solution": "该问题要求基于从电子态密度（DOS）派生的材料描述符来计算析氧起始电位$E_{\\mathrm{onset}}$。该问题分为两个主要部分：首先，计算氧$2p$带中心$\\varepsilon_{2p}$；其次，使用该值在一个给定的线性标度关系中求出$E_{\\mathrm{onset}}$。\n\n第一步是计算氧$2p$带中心$\\varepsilon_{2p}$，其定义为被占据的投影态密度的一阶矩，并用总被占据态数进行归一化。其定义如下：\n$$\n\\varepsilon_{2p} \\equiv \\frac{\\int_{-\\infty}^{E_F} E \\, D_{2p}(E)\\, dE}{\\int_{-\\infty}^{E_F} D_{2p}(E)\\, dE}\n$$\n问题指明费米能级位于$E_F = 0$ eV。态密度$D_{2p}(E)$仅在区间$E \\in [-6.0, 0.0]$ eV内非零。因此，积分上下限可以从$(-\\infty, E_F]$调整为$[-6.0, 0.0]$。\n\n我们首先计算分母，它代表被占据的氧$2p$态的总数$N_{2p}$。\n$$\nN_{2p} = \\int_{-6.0}^{0.0} D_{2p}(E)\\, dE\n$$\n函数$D_{2p}(E)$是分段的，所以我们必须将积分分成与两个瓣对应的两部分：\n$$\nN_{2p} = \\int_{-6.0}^{-3.0} c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right) dE + \\int_{-3.0}^{0.0} c_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right) dE\n$$\n我们来计算第一个积分$I_{D1}$：\n$I_{D1} = \\int_{-6.0}^{-3.0} c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right) dE$。\n我们进行换元。令$u = \\frac{E + 4.5}{1.5}$。则$dE = 1.5 \\, du$。积分上下限从$E = -6.0$变为$u = \\frac{-6.0 + 4.5}{1.5} = -1$，从$E = -3.0$变为$u = \\frac{-3.0 + 4.5}{1.5} = 1$。\n$$\nI_{D1} = c_1 \\int_{-1}^{1} (1 - u^2) (1.5 \\, du) = 1.5 \\, c_1 \\left[u - \\frac{u^3}{3}\\right]_{-1}^{1} = 1.5 \\, c_1 \\left( \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{-1}{3}\\right) \\right) = 1.5 \\, c_1 \\left( \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) \\right) = 1.5 \\, c_1 \\left(\\frac{4}{3}\\right) = 2 c_1\n$$\n给定$c_1 = 2.0$，我们有$I_{D1} = 2 \\times 2.0 = 4.0$。\n\n现在，我们来计算第二个积分$I_{D2}$：\n$I_{D2} = \\int_{-3.0}^{0.0} c_2 \\left(1 - \\left(\\frac{E + 1.5}{1.5}\\right)^{2}\\right) dE$。\n这个积分具有相同的数学形式。令$v = \\frac{E + 1.5}{1.5}$，所以$dE = 1.5 \\, dv$。上下限为$E = -3.0 \\to v = -1$和$E = 0.0 \\to v = 1$。\n$$\nI_{D2} = c_2 \\int_{-1}^{1} (1 - v^2) (1.5 \\, dv) = 1.5 \\, c_2 \\left[v - \\frac{v^3}{3}\\right]_{-1}^{1} = 1.5 \\, c_2 \\left(\\frac{4}{3}\\right) = 2 c_2\n$$\n给定$c_2 = 1.0$，我们有$I_{D2} = 2 \\times 1.0 = 2.0$。\n总态数是两个积分之和：\n$N_{2p} = I_{D1} + I_{D2} = 4.0 + 2.0 = 6.0$个态/氧原子。\n\n接下来，我们计算分子，即被占据态密度的一阶能量矩$M_{2p}$。\n$$\nM_{2p} = \\int_{-6.0}^{0.0} E \\, D_{2p}(E)\\, dE = \\int_{-6.0}^{-3.0} E \\, D_{1}(E) dE + \\int_{-3.0}^{0.0} E \\, D_{2}(E) dE\n$$\n其中$D_1(E)$和$D_2(E)$分别是第一和第二个瓣的表达式。\n我们来计算第一个积分$I_{N1}$。我们注意到第一个瓣$D_1(E)=c_1 \\left(1 - \\left(\\frac{E + 4.5}{1.5}\\right)^{2}\\right)$是一个关于$E_c = -4.5$ eV的对称函数。$E \\cdot D_1(E)$的积分可以利用这种对称性来简化。\n$$\nI_{N1} = \\int_{-6.0}^{-3.0} E \\, D_1(E) dE = \\int_{-6.0}^{-3.0} ((E - E_c) + E_c) \\, D_1(E) dE = \\int_{-6.0}^{-3.0} (E - E_c) \\, D_1(E) dE + E_c \\int_{-6.0}^{-3.0} D_1(E) dE\n$$\n项$(E - E_c)$是关于中心$E_c$的奇函数，而$D_1(E)$是关于$E_c$的偶函数。它们的乘积是一个奇函数。奇函数在对称区间（从$E_c-1.5$到$E_c+1.5$）上的积分为零。因此，第一项消失。\n$$\nI_{N1} = E_c \\int_{-6.0}^{-3.0} D_1(E) dE = E_c \\cdot I_{D1} = (-4.5) \\times (4.0) = -18.0\n$$\n类似地，对于第二个积分$I_{N2}$，第二个瓣$D_2(E)$关于$E_c = -1.5$ eV对称。\n$$\nI_{N2} = \\int_{-3.0}^{0.0} E \\, D_2(E) dE = (-1.5) \\int_{-3.0}^{0.0} D_2(E) dE = (-1.5) \\cdot I_{D2} = (-1.5) \\times (2.0) = -3.0\n$$\n总矩是两部分之和：\n$M_{2p} = I_{N1} + I_{N2} = -18.0 - 3.0 = -21.0$ eV$\\cdot$态/氧原子。\n\n现在我们可以计算带中心$\\varepsilon_{2p}$：\n$$\n\\varepsilon_{2p} = \\frac{M_{2p}}{N_{2p}} = \\frac{-21.0}{6.0} = -3.5 \\, \\text{eV}\n$$\n\n问题的第二部分是使用提供的线性标度关系计算析氧起始电位$E_{\\mathrm{onset}}$：\n$$\nE_{\\mathrm{onset}} = \\alpha \\, \\big(-\\varepsilon_{2p}\\big) + \\beta\n$$\n给定参数为$\\alpha = 0.40$ V/eV和$\\beta = 2.80$ V。代入$\\varepsilon_{2p}$的值：\n$$\nE_{\\mathrm{onset}} = 0.40 \\times (-(-3.5)) + 2.80\n$$\n$$\nE_{\\mathrm{onset}} = 0.40 \\times 3.5 + 2.80\n$$\n$$\nE_{\\mathrm{onset}} = 1.40 + 2.80 = 4.20 \\, \\text{V}\n$$\n问题要求答案四舍五入到三位有效数字。结果$4.20$ V已经是三位有效数字。",
            "answer": "$$\n\\boxed{4.20}\n$$"
        }
    ]
}