{
    "hands_on_practices": [
        {
            "introduction": "稳健优化的核心挑战在于如何处理必须在整个不确定性集合内都成立的约束条件。这个练习将引导你掌握一项基本但功能强大的技术：利用对偶理论将一个带有不确定性预算的稳健线性约束，转化为一个标准的、可以使用现成求解器处理的线性规划（LP）问题。通过这个具体的电池母线电压降案例，你将亲手推导并计算不确定性预算参数 $\\Gamma$ 如何量化地影响最坏情况下的性能，从而深刻理解稳健性与保守性之间的权衡。",
            "id": "3947214",
            "problem": "在自动化电池包设计和仿真中，稳态母线电压降遵循欧姆定律。对于一个有 $N$ 个串联母线段并承载放电电流的电池包，总电压降是各段电压降之和，其模型为 $V_{\\text{drop}} = \\sum_{k=1}^{N} r_{k} i_{k}$，其中 $r_{k}$ 是第 $k$ 段的电阻，$i_{k} \\ge 0$ 是对应的电流。在制造差异和热效应的影响下，各段的电阻是不确定的。假设电阻存在单边增加 $r_{k} = r_{k}^{0} + \\delta_{k}$，其中 $r_{k}^{0}$ 是标称电阻，$0 \\le \\delta_{k} \\le d_{k}$ 是一个受 $d_{k}$ 限制的未知偏差。为了调节整体的保守性，使用鲁棒优化中引入的不确定性预算参数 $\\Gamma$：最多有 $\\Gamma$ 个分段可以同时达到其最大偏差，而其他分段可能仅部分偏离。\n\n考虑一个鲁棒设计要求，即最坏情况下的电压降不超过允许的上限 $V_{\\max}$，也就是说，该约束必须对所有满足不确定性预算的偏差都成立。请使用带有辅助变量的线性规划 (LP) 来重构此鲁棒线性约束，使其能在标准 LP 求解器中执行。然后，通过第一性原理和适当的对偶推理，推导预算 $\\Gamma$ 如何控制对标称电压降的最坏情况附加惩罚的大小。\n\n最后，将您的公式应用于以下具有放电电流和电阻数据的四段案例（$N=4$）：\n- 电流：$i_{1} = 80$，$i_{2} = 60$，$i_{3} = 50$，$i_{4} = 40$（单位均为 $\\mathrm{A}$）。\n- 标称电阻：$r_{1}^{0} = 0.5$，$r_{2}^{0} = 0.8$，$r_{3}^{0} = 0.3$，$r_{4}^{0} = 0.6$（单位均为 $\\mathrm{m}\\Omega$）。\n- 偏差界限：$d_{1} = 0.1$，$d_{2} = 0.2$，$d_{3} = 0.05$，$d_{4} = 0.15$（单位均为 $\\mathrm{m}\\Omega$）。\n\n假设 $\\Gamma = 2.3$，并根据您的鲁棒 LP 重构和分析，计算最坏情况下的总电压降 $V_{\\text{drop}}^{\\star}(\\Gamma)$。最终答案以伏特为单位表示，并四舍五入至四位有效数字。仅提供所要求的最终最坏情况电压降值；不要在答案框中包含中间步骤。",
            "solution": "该问题在科学上和数学上是有效的。它描述了鲁棒优化的一个标准应用，使用了不确定性预算模型，这是一种处理线性规划中参数不确定性的成熟技术。其底层的物理模型是欧姆定律的正确应用。所有必要的数据都已提供，且没有内部矛盾。\n\n该问题要求三部分解答：将鲁棒约束重构为标准线性规划（LP）形式，推导不确定性预算 $\\Gamma$ 如何控制最坏情况下的惩罚，以及计算一个特定情况下的最坏情况电压降。\n\n首先，我们定义总电压降。给定第 $k$ 段的电阻为 $r_k = r_k^0 + \\delta_k$，总电压降为：\n$$ V_{\\text{drop}} = \\sum_{k=1}^{N} r_k i_k = \\sum_{k=1}^{N} (r_k^0 + \\delta_k) i_k = \\sum_{k=1}^{N} r_k^0 i_k + \\sum_{k=1}^{N} \\delta_k i_k $$\n第一项 $\\sum_{k=1}^{N} r_k^0 i_k$ 是标称电压降，我们记为 $V_{\\text{nom}}$。第二项是由电阻偏差引起的额外电压降。\n\n鲁棒设计要求是约束 $V_{\\text{drop}} \\le V_{\\max}$ 必须对指定不确定性集合内的所有可能偏差 $\\delta_k$ 都成立。这等同于确保最坏情况下的电压降不超过 $V_{\\max}$：\n$$ \\max_{\\delta \\in U} \\left( \\sum_{k=1}^{N} r_k^0 i_k + \\sum_{k=1}^{N} \\delta_k i_k \\right) \\le V_{\\max} $$\n$$ V_{\\text{nom}} + \\max_{\\delta \\in U} \\left( \\sum_{k=1}^{N} \\delta_k i_k \\right) \\le V_{\\max} $$\n不确定性集合 $U$ 由以下约束定义：对所有 $k \\in \\{1, \\dots, N\\}$，$0 \\le \\delta_k \\le d_k$，以及预算约束 $\\sum_{k=1}^{N} \\frac{\\delta_k}{d_k} \\le \\Gamma$。\n\n问题的核心是内部最大化问题，它用于找到电压降的最坏情况惩罚：\n$$ \\Pi(\\Gamma) = \\max \\sum_{k=1}^{N} i_k \\delta_k $$\n约束条件为：\n$$ \\sum_{k=1}^{N} \\frac{1}{d_k} \\delta_k \\le \\Gamma $$\n$$ 0 \\le \\delta_k \\le d_k, \\quad k=1, \\dots, N $$\n这是一个线性规划问题。为了得到鲁棒约束的 LP 重构形式，我们推导这个问题的对偶问题。设 $\\lambda \\ge 0$ 为预算约束的对偶变量，$\\rho_k \\ge 0$ 为上界约束 $\\delta_k \\le d_k$ 的对偶变量。约束 $\\delta_k \\ge 0$ 被隐式处理。\n\n对偶问题是：\n$$ \\min_{\\lambda \\ge 0, \\rho_k \\ge 0} \\left( \\Gamma \\lambda + \\sum_{k=1}^{N} d_k \\rho_k \\right) $$\n约束条件为：\n$$ \\frac{\\lambda}{d_k} + \\rho_k \\ge i_k, \\quad k=1, \\dots, N $$\n根据 LP 的强对偶性，$\\Pi(\\Gamma)$ 等于该对偶问题的最优值。因此，原始的鲁棒约束等价于以下涉及辅助变量 $\\lambda$ 和 $\\rho_k$ 的线性约束系统：\n$$ V_{\\text{nom}} + \\Gamma \\lambda + \\sum_{k=1}^{N} d_k \\rho_k \\le V_{\\max} $$\n$$ \\lambda + d_k \\rho_k \\ge i_k d_k, \\quad k=1, \\dots, N $$\n$$ \\lambda \\ge 0, \\quad \\rho_k \\ge 0 $$\n这就是所要求的 LP 重构。\n\n接下来，我们推导 $\\Gamma$ 如何控制最坏情况惩罚 $\\Pi(\\Gamma)$ 的大小。我们直接求解原始最大化问题。引入缩放偏差变量 $z_k = \\delta_k/d_k$，使得 $0 \\le z_k \\le 1$。问题变为：\n$$ \\Pi(\\Gamma) = \\max \\sum_{k=1}^{N} (i_k d_k) z_k $$\n约束条件为：\n$$ \\sum_{k=1}^{N} z_k \\le \\Gamma $$\n$$ 0 \\le z_k \\le 1, \\quad k=1, \\dots, N $$\n这是一个连续背包问题。最优解可以通过贪心方法找到。我们应该优先考虑那些具有最大潜在电压降增加的分段，该增加由乘积 $v_k = i_k d_k$ 给出。设 $\\pi$ 为索引 $\\{1, \\dots, N\\}$ 的一个排列，使得 $v_{\\pi(1)} \\ge v_{\\pi(2)} \\ge \\dots \\ge v_{\\pi(N)}$。\n\n贪心策略是对于具有最大 $v_k$ 值的项，将其 $z_k$ 设置为最大值 $1$，直到预算 $\\Gamma$ 耗尽。设 $m = \\lfloor \\Gamma \\rfloor$ 为 $\\Gamma$ 的整数部分，$\\{\\Gamma\\} = \\Gamma - m$ 为其小数部分。\n最优解是设置：\n$z_{\\pi(k)} = 1$ 对于 $k = 1, \\dots, m$。\n$z_{\\pi(m+1)} = \\{\\Gamma\\}$。\n$z_{\\pi(k)} = 0$ 对于 $k  m+1$。\n总和为 $\\sum z_k = m \\cdot 1 + \\{\\Gamma\\} + 0 = \\Gamma$，满足预算约束。\n因此，最坏情况下的附加惩罚为：\n$$ \\Pi(\\Gamma) = \\sum_{k=1}^{N} v_k z_k = \\sum_{k=1}^{m} v_{\\pi(k)} \\cdot 1 + v_{\\pi(m+1)} \\cdot \\{\\Gamma\\} + \\sum_{k=m+2}^{N} v_{\\pi(k)} \\cdot 0 $$\n$$ \\Pi(\\Gamma) = \\sum_{k=1}^{\\lfloor \\Gamma \\rfloor} v_{\\pi(k)} + \\{\\Gamma\\} \\cdot v_{\\pi(\\lfloor \\Gamma \\rfloor + 1)} $$\n这个显式公式表明，惩罚是 $\\Gamma$ 的一个分段线性凸函数。随着 $\\Gamma$ 的增加，惩罚函数的斜率减小，在区间 $\\Gamma \\in [m, m+1]$ 内的斜率等于第 $(m+1)$ 大的 $i_k d_k$ 值。\n\n最后，我们将此应用于给定的四段案例。\n数据：\n电流：$i_{1} = 80 \\, \\mathrm{A}$，$i_{2} = 60 \\, \\mathrm{A}$，$i_{3} = 50 \\, \\mathrm{A}$，$i_{4} = 40 \\, \\mathrm{A}$。\n标称电阻：$r_{1}^{0} = 0.5 \\, \\mathrm{m}\\Omega$，$r_{2}^{0} = 0.8 \\, \\mathrm{m}\\Omega$，$r_{3}^{0} = 0.3 \\, \\mathrm{m}\\Omega$，$r_{4}^{0} = 0.6 \\, \\mathrm{m}\\Omega$。\n偏差界限：$d_{1} = 0.1 \\, \\mathrm{m}\\Omega$，$d_{2} = 0.2 \\, \\mathrm{m}\\Omega$，$d_{3} = 0.05 \\, \\mathrm{m}\\Omega$，$d_{4} = 0.15 \\, \\mathrm{m}\\Omega$。\n预算：$\\Gamma = 2.3$。\n\n首先，计算标称电压降 $V_{\\text{nom}}$（单位为毫伏，$\\mathrm{mV}$）：\n$$ V_{\\text{nom}} = (80)(0.5) + (60)(0.8) + (50)(0.3) + (40)(0.6) = 40 + 48 + 15 + 24 = 127 \\, \\mathrm{mV} $$\n接下来，计算乘积 $v_k = i_k d_k$（单位为毫伏，$\\mathrm{mV}$）：\n$v_1 = i_1 d_1 = (80)(0.1) = 8 \\, \\mathrm{mV}$\n$v_2 = i_2 d_2 = (60)(0.2) = 12 \\, \\mathrm{mV}$\n$v_3 = i_3 d_3 = (50)(0.05) = 2.5 \\, \\mathrm{mV}$\n$v_4 = i_4 d_4 = (40)(0.15) = 6 \\, \\mathrm{mV}$\n\n将这些值按降序排序：\n$v_2 = 12$\n$v_1 = 8$\n$v_4 = 6$\n$v_3 = 2.5$\n索引 $\\pi$ 的排序为 $(2, 1, 4, 3)$。排序后的值为 $v_{\\pi(1)}=12$，$v_{\\pi(2)}=8$，$v_{\\pi(3)}=6$，$v_{\\pi(4)}=2.5$。\n\n对于 $\\Gamma = 2.3$，我们有 $\\lfloor \\Gamma \\rfloor = 2$ 和 $\\{\\Gamma\\} = 0.3$。\n使用最坏情况惩罚 $\\Pi(\\Gamma)$ 的公式：\n$$ \\Pi(2.3) = v_{\\pi(1)} + v_{\\pi(2)} + 0.3 \\cdot v_{\\pi(3)} $$\n$$ \\Pi(2.3) = 12 + 8 + 0.3 \\cdot 6 = 20 + 1.8 = 21.8 \\, \\mathrm{mV} $$\n最坏情况下的总电压降是标称压降和最坏情况惩罚之和：\n$$ V_{\\text{drop}}^{\\star}(\\Gamma) = V_{\\text{nom}} + \\Pi(\\Gamma) = 127 \\, \\mathrm{mV} + 21.8 \\, \\mathrm{mV} = 148.8 \\, \\mathrm{mV} $$\n转换为伏特：\n$$ V_{\\text{drop}}^{\\star}(2.3) = 0.1488 \\, \\mathrm{V} $$\n这个值有四位有效数字。",
            "answer": "$$\\boxed{0.1488}$$"
        },
        {
            "introduction": "虽然许多稳健优化问题可以被直接重构为标准的凸优化问题，但当底层模型像道尔-富勒-纽曼（Doyle–Fuller–Newman, DFN）模型一样复杂时，或者当不确定性结构不允许简单的封闭形式重构时，我们就需要更通用的算法。这个练习将向你介绍一种强大的迭代方法——切平面法。你将学习如何为具有椭球不确定性集的稳健约束设计一个“分离预言机”（separation oracle），该预言机能够迭代地找出最坏情况下的参数，并将其作为新的“切分”加入到主问题中，从而逐步逼近稳健最优解。",
            "id": "3947142",
            "problem": "考虑一个锂离子电池的鲁棒设计问题，其中决策变量 $x$（例如电极和隔膜的孔隙率、曲折度和厚度）的选择要确保由 Doyle–Fuller–Newman (DFN) 模型预测的电池端电压（定义为 $V(x;\\theta)$）在不确定的电化学参数 $\\theta \\in \\mathbb{R}^{p}$ 下不低于规格值 $V_{\\min}$。将鲁棒约束定义为\n$$\ng(x,\\theta) \\equiv V_{\\min} - V(x;\\theta) \\le 0 \\quad \\text{for all } \\theta \\in \\mathcal{U},\n$$\n其中不确定性集是椭球形的，\n$$\n\\mathcal{U} \\equiv \\left\\{ \\theta \\in \\mathbb{R}^{p} : \\left\\| W\\left(\\theta - \\bar{\\theta}\\right)\\right\\|_{2} \\le \\rho \\right\\},\n$$\n其中 $\\bar{\\theta}$ 是名义参数，$\\rho  0$ 是半径，而 $W \\in \\mathbb{R}^{p \\times p}$ 是一个编码了参数缩放或协方差的非奇异矩阵。DFN 模型由固相和电解质相中的电荷与质量守恒以及 Butler–Volmer 动力学控制；在对 $\\theta$ 具有足够平滑的依赖性且放电电流曲线固定的情况下，于 $\\bar{\\theta}$ 处对 $\\theta$ 进行局部线性化可得\n$$\ng(x,\\theta) \\approx g\\left(x,\\bar{\\theta}\\right) + s(x)^{\\top}\\left(\\theta - \\bar{\\theta}\\right),\n$$\n其中 $s(x) = \\nabla_{\\theta} g(x,\\theta)\\big|_{\\theta=\\bar{\\theta}}$ 是参数灵敏度向量，对于给定的 $x$，该向量可通过 DFN 模型的伴随模型获得。用于鲁棒优化的切平面法使用一个有限的工作场景集 $\\Theta_{k} \\subset \\mathcal{U}$ 来求解关于 $x$ 的主问题，然后调用一个分离预言机，来证明对所有 $\\theta \\in \\mathcal{U}$ 都有 $g(x,\\theta) \\le 0$，或者找出一个违反鲁棒约束的最坏情况 $\\theta^{\\star} \\in \\mathcal{U}$，然后将其作为新的割平面添加到 $\\Theta_{k}$ 中。\n\n哪个选项正确描述了切平面法如何为这个 DFN 约束的鲁棒设计问题迭代地添加最坏情况参数割平面，并基于上述线性和椭球不确定性集提出了一个有效的分离预言机？\n\nA. 给定当前设计 $x_{k}$，通过 DFN 伴随模型计算灵敏度 $s_{k} = \\nabla_{\\theta} g(x_{k},\\theta)\\big|_{\\theta=\\bar{\\theta}}$。分离预言机在线性化条件下求解 $\\max_{\\theta \\in \\mathcal{U}} g(x_{k},\\theta)$ 并返回\n$$\n\\theta^{\\star} = \\bar{\\theta} + \\rho\\, W^{-1}\\,\\frac{W^{-T}\\, s_{k}}{\\left\\|W^{-T}\\, s_{k}\\right\\|_{2}},\n$$\n然后将割平面 $g(x,\\theta^{\\star}) \\le 0$ 添加到主问题中；重复此过程直到找不到违规情况。\n\nB. 给定 $x_{k}$，使用 $s_{k}$ 在设计空间中进行一步梯度上升，并添加线性割平面 $s_{k}^{\\top}(x - x_{k}) \\le -g(x_{k},\\bar{\\theta})$；分离预言机返回关于 $x$ 的割平面而不是关于 $\\theta$ 的场景，因为不确定性通过灵敏度嵌入到了设计中。\n\nC. 给定 $x_{k}$，计算 $s_{k}$ 并返回单个确定性不等式\n$$\ng\\left(x,\\bar{\\theta}\\right) + \\rho \\left\\|W^{-T}\\, s(x)\\right\\|_{2} \\le 0,\n$$\n以取代无限个鲁棒约束族；迭代地添加场景割平面是不必要的，因为鲁棒对等问题被一个锥不等式所捕获。\n\nD. 给定 $x_{k}$，通过独立最大化每个分量来选择最坏情况参数，即 $\\theta^{\\star}_{i} = \\bar{\\theta}_{i} + \\rho\\, \\mathrm{sign}\\left(s_{k,i}\\right)$，并添加割平面 $g(x,\\theta^{\\star}) \\le 0$，因为椭球上的最坏情况可以通过将每个坐标推到其边界来找到。",
            "solution": "用户提供了一个应用于锂离子电池设计的鲁棒优化领域的问题。任务是为特定的问题表述，在切平面算法中识别分离预言机的正确描述。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤 1：提取已知条件**\n\n-   **决策变量：** $x$（设计参数，如孔隙率、曲折度、厚度）。\n-   **模型：** Doyle–Fuller–Newman (DFN) 模型。\n-   **性能函数：** 电池端电压 $V(x;\\theta)$。\n-   **不确定参数：** $\\theta \\in \\mathbb{R}^{p}$。\n-   **鲁棒约束：** 对于所有 $\\theta \\in \\mathcal{U}$，$g(x,\\theta) \\equiv V_{\\min} - V(x;\\theta) \\le 0$。\n-   **不确定性集：** 一个椭球 $\\mathcal{U} \\equiv \\left\\{ \\theta \\in \\mathbb{R}^{p} : \\left\\| W\\left(\\theta - \\bar{\\theta}\\right)\\right\\|_{2} \\le \\rho \\right\\}$。\n-   **$\\mathcal{U}$ 的参数：** 名义参数 $\\bar{\\theta}$，半径 $\\rho  0$，以及一个非奇异矩阵 $W \\in \\mathbb{R}^{p \\times p}$。\n-   **近似：** 约束函数在 $\\bar{\\theta}$ 处关于 $\\theta$ 线性化：$g(x,\\theta) \\approx g\\left(x,\\bar{\\theta}\\right) + s(x)^{\\top}\\left(\\theta - \\bar{\\theta}\\right)$。\n-   **灵敏度向量：** $s(x) = \\nabla_{\\theta} g(x,\\theta)\\big|_{\\theta=\\bar{\\theta}}$（通过伴随方法计算）。\n-   **算法：** 一种切平面法，它迭代地求解一个主问题并调用一个分离预言机来找到一个最坏情况的参数违规 $\\theta^{\\star}$，然后将其作为新的割平面添加。\n-   **问题：** 识别此问题的分离预言机和切平面更新步骤的正确描述。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题有充分的科学依据。DFN 模型是锂离子电池电化学的标准、基于物理的模型。鲁棒优化是优化理论的一个严谨分支。切平面算法是解决凸优化问题的经典方法，包括那些由鲁棒优化产生的问题。使用伴随方法进行灵敏度分析是计算科学和工程中的标准且高效的技术。该表述在科学上和数学上都是合理的。\n-   **适定性：** 该问题是适定的。它要求在一个指定的数学框架（在一个椭球集上对一个函数进行线性化）内推导最坏情况参数。这个子问题，即分离问题，有一个唯一的解析解，这使得该问题是可回答的，而不是不适定的。\n-   **客观性：** 语言是形式化、精确和客观的，使用了优化和电池建模的标准术语。\n-   **完整性和一致性：** 该问题提供了推导分离预言机所需的所有必要定义：要最大化的目标函数 ($g(x, \\theta)$)、其线性近似以及约束集 ($\\mathcal{U}$)。没有矛盾之处。\n\n**步骤 3：结论与行动**\n\n问题陈述有效。这是一个鲁棒优化领域中的适定且有科学依据的问题。我将继续推导解答。\n\n### 基于原理的分离预言机推导\n\n切平面法需要一个分离预言机。对于给定的设计迭代 $x_k$，预言机必须解决以下子问题，以找到不确定性集 $\\mathcal{U}$ 内导致约束最大（最坏情况）违规的参数 $\\theta$：\n$$\n\\max_{\\theta \\in \\mathcal{U}} g(x_k, \\theta)\n$$\n如果此最大化的结果为正，则约束被违反，并且必须返回使函数最大化的参数 $\\theta^{\\star}$。使用所提供的 $g(x, \\theta)$ 的线性近似并记 $s_k = s(x_k)$，子问题变为：\n$$\n\\max_{\\theta \\in \\mathcal{U}} \\left[ g(x_k, \\bar{\\theta}) + s_k^{\\top}(\\theta - \\bar{\\theta}) \\right]\n$$\n由于 $g(x_k, \\bar{\\theta})$ 和 $s_k$ 相对于优化变量 $\\theta$ 是常数，这等价于求解：\n$$\ng(x_k, \\bar{\\theta}) + \\max_{\\theta \\in \\mathcal{U}} \\left[ s_k^{\\top}(\\theta - \\bar{\\theta}) \\right]\n$$\n核心优化问题是 $\\max_{\\theta} s_k^{\\top}(\\theta - \\bar{\\theta})$，约束条件为 $\\left\\| W(\\theta - \\bar{\\theta}) \\right\\|_{2} \\le \\rho$。\n\n为了解决这个问题，我们引入变量替换。令 $z = W(\\theta - \\bar{\\theta})$。由于 $W$ 是非奇异的，我们可以写出 $\\theta - \\bar{\\theta} = W^{-1} z$。对 $z$ 的约束就变为 $\\left\\| z \\right\\|_{2} \\le \\rho$。代入目标函数中：\n$$\ns_k^{\\top}(\\theta - \\bar{\\theta}) = s_k^{\\top} W^{-1} z = (W^{-T} s_k)^{\\top} z\n$$\n问题现在被转换为一个标准形式：\n$$\n\\max_{z} (W^{-T} s_k)^{\\top} z \\quad \\text{subject to} \\quad \\|z\\|_{2} \\le \\rho\n$$\n根据柯西-施瓦茨不等式，当向量 $z$ 与向量 $W^{-T} s_k$ 共线且具有最大可能模长时，点积 $(W^{-T} s_k)^{\\top} z$ 达到最大值。约束允许的最大模长是 $\\rho$。因此，最优的 $z^{\\star}$ 是：\n$$\nz^{\\star} = \\rho \\frac{W^{-T} s_k}{\\left\\|W^{-T} s_k\\right\\|_{2}}\n$$\n这里假设 $s_k \\neq 0$。如果 $s_k=0$，对于任何 $\\theta$，目标都是零，任何 $\\theta \\in \\mathcal{U}$ 都是最优的。我们假设是非平凡的情况。\n\n为了找到最坏情况参数 $\\theta^{\\star}$，我们从 $z^{\\star}$ 变换回来：\n$$\nW(\\theta^{\\star} - \\bar{\\theta}) = z^{\\star}\n$$\n$$\n\\theta^{\\star} - \\bar{\\theta} = W^{-1} z^{\\star} = W^{-1} \\left( \\rho \\frac{W^{-T} s_k}{\\left\\|W^{-T} s_k\\right\\|_{2}} \\right)\n$$\n因此，最坏情况参数是：\n$$\n\\theta^{\\star} = \\bar{\\theta} + \\rho W^{-1} \\frac{W^{-T} s_k}{\\left\\|W^{-T} s_k\\right\\|_{2}}\n$$\n然后，切平面算法将一个涉及此 $\\theta^\\star$ 的约束（例如，$g(x, \\theta^\\star) \\le 0$）添加到主问题中，然后重新求解以找到下一个设计迭代 $x_{k+1}$。\n\n### 逐项分析\n\n**A. 给定当前设计 $x_{k}$，通过 DFN 伴随模型计算灵敏度 $s_{k} = \\nabla_{\\theta} g(x_{k},\\theta)\\big|_{\\theta=\\bar{\\theta}}$。分离预言机在线性化条件下求解 $\\max_{\\theta \\in \\mathcal{U}} g(x_{k},\\theta)$ 并返回\n$$\n\\theta^{\\star} = \\bar{\\theta} + \\rho\\, W^{-1}\\,\\frac{W^{-T}\\, s_{k}}{\\left\\|W^{-T}\\, s_{k}\\right\\|_{2}},\n$$\n然后将割平面 $g(x,\\theta^{\\star}) \\le 0$ 添加到主问题中；重复此过程直到找不到违规情况。**\n\n此选项正确地描述了该过程。它正确地识别了灵敏度向量 $s_k$ 的作用。它正确地给出了最坏情况参数 $\\theta^{\\star}$ 的表达式，该参数在给定的椭球不确定性集上最大化线性化函数，与我们的推导完全吻合。最后，它正确地描述了切平面算法的迭代过程，其中新的场景 $\\theta^\\star$ 被用来为主问题生成一个新的割平面。\n\n**结论：正确**\n\n**B. 给定 $x_{k}$，使用 $s_{k}$ 在设计空间中进行一步梯度上升，并添加线性割平面 $s_{k}^{\\top}(x - x_{k}) \\le -g(x_{k},\\bar{\\theta})$；分离预言机返回关于 $x$ 的割平面而不是关于 $\\theta$ 的场景，因为不确定性通过灵敏度嵌入到了设计中。**\n\n这个选项根本上是错误的。向量 $s_k=\\nabla_{\\theta} g(x_k, \\theta)|_{\\bar{\\theta}}$ 是约束函数关于*参数* $\\theta$ 的梯度，而不是关于*设计变量* $x$ 的梯度。在设计空间 $x$ 中基于梯度的优化步骤将需要 $\\nabla_x g$。此外，问题明确描述了一种切平面法，其中分离预言机从不确定性集 $\\mathcal{U}$ 中识别出一个最坏情况的*参数场景* $\\theta^\\star$。这个选项错误地描述了一种在设计变量 $x$ 上生成割平面的方法，并且与问题陈述中描述的算法不符。\n\n**结论：不正确**\n\n**C. 给定 $x_{k}$，计算 $s_{k}$ 并返回单个确定性不等式\n$$\ng\\left(x,\\bar{\\theta}\\right) + \\rho \\left\\|W^{-T}\\, s(x)\\right\\|_{2} \\le 0,\n$$\n以取代无限个鲁棒约束族；迭代地添加场景割平面是不必要的，因为鲁棒对等问题被一个锥不等式所捕获。**\n\n此选项描述了问题的“鲁棒对等”表述。如推导所示，线性化约束函数在 $\\mathcal{U}$ 上的最大值确实是 $g(x, \\bar{\\theta}) + \\rho \\|W^{-T} s(x)\\|_2$。因此，半无限约束 $\\sup_{\\theta \\in \\mathcal{U}} g(x, \\theta) \\le 0$ 等价于单个、确定性的二阶锥约束 $g(x, \\bar{\\theta}) + \\rho \\|W^{-T} s(x)\\|_2 \\le 0$。虽然这是一种有效且强大的解决鲁棒优化问题的方法，但它是切平面法的一种*替代*方法。问题明确地询问*切平面法*如何迭代地添加割平面。此选项认为这种方法是不必要的，因此未能回答所提出的问题。\n\n**结论：不正确**\n\n**D. 给定 $x_{k}$，通过独立最大化每个分量来选择最坏情况参数，即 $\\theta^{\\star}_{i} = \\bar{\\theta}_{i} + \\rho\\, \\mathrm{sign}\\left(s_{k,i}\\right)$，并添加割平面 $g(x,\\theta^{\\star}) \\le 0$，因为椭球上的最坏情况可以通过将每个坐标推到其边界来找到。**\n\n这个选项提出了一种不正确的寻找最坏情况参数的方法。通过独立地将每个变量推向极值来在约束集上最大化一个线性函数，通常只对形式为 $\\|\\theta - \\bar{\\theta}\\|_\\infty \\le \\text{const}$ 的超矩形（盒式）不确定性集有效。对于由 $L_2$-范数约束 $\\left\\| W(\\theta - \\bar{\\theta}) \\right\\|_{2} \\le \\rho$ 定义的椭球集，变量是耦合的。此选项构造的点 $\\theta^\\star$（使得 $\\theta^{\\star}_{i} = \\bar{\\theta}_{i} + \\rho\\, \\mathrm{sign}\\left(s_{k,i}\\right)$）通常会位于椭球 $\\mathcal{U}$ 之外，因此不是分离子问题的可行解。认为椭球上的最坏情况是这样找到的这个前提是错误的。\n\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论和算法的最终目的是解决实际工程问题。在设计稳健系统时，一个关键的实践问题是：我们应该将系统设计得多“稳健”？这个练习将让你扮演一名电池工程师，通过一个完整的、基于数据的实践工作流来回答这个问题。你将利用样本外验证（out-of-sample validation）的方法，系统地调整不确定性预算参数 $\\Gamma$，以在充电性能（例如充电量）和安全性（例如违反电压限制的风险）之间找到最佳平衡点。这个编码实践将理论与实际应用联系起来，展示了如何在面对不确定性时做出有原则的设计决策。",
            "id": "3947183",
            "problem": "考虑一个简化但科学上合理的锂离子电池组在电压限制下的快速充电设计问题。在离散时间步长 $t \\in \\{0,\\dots,T-1\\}$ 的端电压被建模为三个部分的和：来自标称模拟的开路电压 $U_{\\mathrm{nom},t}$、与施加电流 $I_t$ 成正比的欧姆压降，以及与步间电流变化幅度 $s_t = |I_t - I_{t-1}|$（约定 $I_{-1} = 0$）成正比的瞬态极化。该模型为\n$$\nV_t = U_{\\mathrm{nom},t} + R_{\\mathrm{nom}} I_t + P_{\\mathrm{nom}} s_t,\n$$\n其中 $R_{\\mathrm{nom}}$（欧姆电阻）和 $P_{\\mathrm{nom}}$（瞬态极化系数）是从先前的模拟和辨识中获得的名义系数。电压限制要求对于所有 $t$ 都有 $V_t \\le V_{\\max}$。\n\n我们通过每个时间步长带有预算参数 $\\Gamma \\in [0,2]$ 的预算不确定性模型（Bertsimas–Sim）来考虑参数 $R$ 和 $P$ 的不确定性。具体来说，我们假设 $R = R_{\\mathrm{nom}} + \\delta_R$ 和 $P = P_{\\mathrm{nom}} + \\delta_P$，其中非负偏差 $\\delta_R \\in [0,\\hat R]$ 和 $\\delta_P \\in [0,\\hat P]$ 受从训练数据估计出的不确定性半径 $\\hat R$ 和 $\\hat P$ 的限制。在预算 $\\Gamma$ 下，在每个时间步长 $t$，两个不确定性贡献中最多有 $\\Gamma$ 个可以同时取其最坏情况值，当 $\\Gamma$ 为非整数时允许分数分配。时间 $t$ 的电压约束的鲁棒对应为\n$$\nU_{\\mathrm{nom},t} + R_{\\mathrm{nom}} I_t + P_{\\mathrm{nom}} s_t + \\Gamma z_t + p_{t,1} + p_{t,2} \\le V_{\\max},\n$$\n带有辅助变量 $z_t \\ge 0$，$p_{t,i} \\ge 0$ 和线性约束\n$$\np_{t,1} \\ge \\hat R\\, I_t - z_t, \\quad p_{t,2} \\ge \\hat P\\, s_t - z_t.\n$$\n这些是线性不等式系数中预算不确定性的标准线性规划鲁棒对应约束。绝对值 $s_t = |I_t - I_{t-1}|$ 通过线性不等式强制执行\n$$\ns_t \\ge I_t - I_{t-1}, \\quad s_t \\ge I_{t-1} - I_t, \\quad s_t \\ge 0, \\quad I_{-1} = 0.\n$$\n\n设计目标是最大化总充电量 $Q = \\Delta t \\sum_{t=0}^{T-1} I_t$（单位：安秒），受限于 $0 \\le I_t \\le I_{\\max}$ 和所有 $t$ 的鲁棒电压约束。我们将使用样本外验证来调整预算参数 $\\Gamma$，以平衡鲁棒性（在不确定性下遵守电压限制）与性能（大的 $Q$）。给定一个固定的候选 $\\Gamma$，我们求解上述鲁棒线性规划以获得充电电流曲线 $I_t$ 和相关的步长变化幅度 $s_t$。然后，我们使用从指定分布中抽取的独立验证场景 $(\\delta_R,\\delta_P)$ 来评估样本外违规率，为每个场景计算是否有任何 $t$ 违反 $V_t \\le V_{\\max}$。风险调整后的性能指标定义为\n$$\n\\widetilde{Q} = Q \\cdot (1 - \\text{violation\\_rate}),\n$$\n我们选择在验证数据上最大化 $\\widetilde{Q}$ 的 $\\Gamma$，若出现平局则选择最小的 $\\Gamma$。\n\n您的任务是使用以下参数测试套件实现此鲁棒调整过程。所有物理量必须在国际单位制（SI）中解释。所有电压以伏特（$\\mathrm{V}$）表示，电流以安培（$\\mathrm{A}$）表示，时间以秒（$\\mathrm{s}$）表示，电荷以安秒（$\\mathrm{A}\\cdot \\mathrm{s}$）表示。角度不出现。最终输出必须是每个测试用例选定的 $\\Gamma$ 值，为浮点数。\n\n对于每个测试用例，使用训练数据将 $(\\hat R, \\hat P)$ 估计为从指定训练分布中抽取的非负偏差的经验 $0.95$-分位数。使用验证数据从指定的混合分布计算违规率。对于所有情况，使用 $\\Gamma$ 候选值 $\\{0.0, 0.5, 1.0, 1.5, 2.0\\}$。\n\n测试用例 1（理想路径）：\n- 时间范围长度 $T = 12$，步长 $\\Delta t = 5$。\n- 标称开路电压序列 $U_{\\mathrm{nom},t} = 380 + 0.4 t$ 对于 $t = 0, \\dots, 11$。\n- 电压限制 $V_{\\max} = 402$。\n- 电流限制 $I_{\\max} = 180$。\n- 标称欧姆电阻 $R_{\\mathrm{nom}} = 0.010$。\n- 标称极化系数 $P_{\\mathrm{nom}} = 0.004$。\n- 训练偏差是独立抽样：$\\delta_R^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_R^2)|$，其中 $\\sigma_R = 0.001$；以及 $\\delta_P^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_P^2)|$，其中 $\\sigma_P = 0.0005$；样本量 $N_{\\mathrm{train}} = 200$；随机种子 $123$。\n- 验证偏差遵循混合分布：以 $0.9$ 的概率从 $|\\mathcal{N}(0, \\sigma_R^2)| \\times |\\mathcal{N}(0, \\sigma_P^2)|$ 中抽取 $(\\delta_R, \\delta_P)$；以 $0.1$ 的概率从 $|\\mathcal{N}(0, \\sigma_{R,\\mathrm{hi}}^2)| \\times |\\mathcal{N}(0, \\sigma_{P,\\mathrm{hi}}^2)|$ 中抽取，其中 $\\sigma_{R,\\mathrm{hi}} = 0.002$，$\\sigma_{P,\\mathrm{hi}} = 0.0008$；样本量 $N_{\\mathrm{val}} = 1000$；随机种子 $456$。\n\n测试用例 2（电压裕度紧张边界）：\n- 时间范围长度 $T = 12$，步长 $\\Delta t = 5$。\n- 标称开路电压序列 $U_{\\mathrm{nom},t} = 397 + 0.3 t$ 对于 $t = 0, \\dots, 11$。\n- 电压限制 $V_{\\max} = 401$。\n- 电流限制 $I_{\\max} = 200$。\n- 标称欧姆电阻 $R_{\\mathrm{nom}} = 0.012$。\n- 标称极化系数 $P_{\\mathrm{nom}} = 0.005$。\n- 训练偏差：$\\delta_R^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_R^2)|$，其中 $\\sigma_R = 0.0012$；以及 $\\delta_P^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_P^2)|$，其中 $\\sigma_P = 0.0006$；样本量 $N_{\\mathrm{train}} = 200$；随机种子 $789$。\n- 验证偏差混合分布：以 $0.85$ 的概率从基础的 $\\sigma_R, \\sigma_P$ 中抽取；以 $0.15$ 的概率从 $\\sigma_{R,\\mathrm{hi}} = 0.0024$, $\\sigma_{P,\\mathrm{hi}} = 0.001$ 中抽取；样本量 $N_{\\mathrm{val}} = 1000$；随机种子 $2468$。\n\n测试用例 3（小时间范围边缘情况）：\n- 时间范围长度 $T = 4$，步长 $\\Delta t = 5$。\n- 标称开路电压序列 $U_{\\mathrm{nom},t} = 380 + 0.6 t$ 对于 $t = 0, \\dots, 3$。\n- 电压限制 $V_{\\max} = 390$。\n- 电流限制 $I_{\\max} = 220$。\n- 标称欧姆电阻 $R_{\\mathrm{nom}} = 0.009$。\n- 标称极化系数 $P_{\\mathrm{nom}} = 0.0035$。\n- 训练偏差：$\\delta_R^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_R^2)|$，其中 $\\sigma_R = 0.0008$；以及 $\\delta_P^{\\mathrm{train}} = |\\mathcal{N}(0, \\sigma_P^2)|$，其中 $\\sigma_P = 0.0004$；样本量 $N_{\\mathrm{train}} = 200$；随机种子 $1357$。\n- 验证偏差混合分布：以 $0.95$ 的概率从基础的 $\\sigma_R, \\sigma_P$ 中抽取；以 $0.05$ 的概率从 $\\sigma_{R,\\mathrm{hi}} = 0.0016$, $\\sigma_{P,\\mathrm{hi}} = 0.0007$ 中抽取；样本量 $N_{\\mathrm{val}} = 1000$；随机种子 $97531$。\n\n算法要求：\n- 对每个测试用例，从训练样本中将 $\\hat R$ 和 $\\hat P$ 估计为经验 $0.95$-分位数。\n- 对每个候选 $\\Gamma \\in \\{0.0, 0.5, 1.0, 1.5, 2.0\\}$，求解鲁棒线性规划以找到最大化 $Q$ 且满足鲁棒约束和界限的 $I_t$ 和 $s_t$。\n- 使用验证场景，计算得到的曲线 $(I_t, s_t)$ 在所有 $t$ 上的 $V_t \\le V_{\\max}$ 的违规率，并计算 $\\widetilde{Q} = Q \\cdot (1 - \\text{violation\\_rate})$。\n- 选择最大化 $\\widetilde{Q}$ 的 $\\Gamma$；如果多个 $\\Gamma$ 打平，选择最小的那个。\n\n最终输出规范：\n- 您的程序应生成一行输出，其中包含上述三个测试用例选定的 $\\Gamma$ 值，格式为方括号括起来的逗号分隔列表（例如，$[0.0,1.0,1.5]$）。结果必须是浮点数。\n\n科学基础和现实性：\n- 电压模型使用欧姆定律和一个标准的一阶极化项，这在等效电路电池模型中被广泛使用。\n- 鲁棒对应遵循 Bertsimas 和 Sim 提出的经过充分检验的预算不确定性框架，其结果是适合算法求解的线性规划约束。\n- 所有参数和量级都选择为对于汽车规模的电池组是合理的，电压在数百伏特，电流在数百安培。",
            "solution": "所呈现的问题是一项为锂离子电池组设计快速充电电流曲线的鲁棒优化任务。该问题具有科学依据，定义明确，并提供了所有必要的参数和程序。\n任务的核心是通过在充电性能与参数不确定性下违反电压安全限制的风险之间进行权衡，来确定鲁棒性预算参数 $\\Gamma$ 的最优值。该问题是有效的，并且可以通过算法求解。\n\n对于每个测试用例，该过程包括以下主要步骤：\n1.  **随机数据生成**：根据指定的统计分布为不确定参数生成训练和验证样本。\n2.  **不确定性集估计**：使用训练数据通过估计不确定性半径 $\\hat{R}$ 和 $\\hat{P}$ 来定义鲁棒优化模型的不确定性集。\n3.  **迭代鲁棒优化**：对于一组候选 $\\Gamma$ 值，求解一个鲁棒线性规划（LP）以找到最优的充电电流曲线。\n4.  **样本外验证**：使用独立的验证数据集评估每个曲线的性能和鲁棒性。\n5.  **最优参数选择**：选择使风险调整后性能指标最大化的 $\\Gamma$ 值。\n\n我们现在详细阐述数学公式和算法过程。\n\n**1. 模型和目标函数**\n\n在每个离散时间步 $t \\in \\{0, \\dots, T-1\\}$ 的端电压 $V_t$ 由下式给出：\n$$\nV_t(I_t, s_t; R, P) = U_{\\mathrm{nom},t} + R I_t + P s_t\n$$\n其中 $U_{\\mathrm{nom},t}$ 是标称开路电压，$I_t$ 是充电电流，$s_t = |I_t - I_{t-1}|$ 是电流变化的幅度（其中 $I_{-1} = 0$），$R$ 和 $P$ 分别是具有不确定性的欧姆电阻和极化系数。\n\n目标是在时间范围 $T$ 内最大化输送到电池的总电荷 $Q$：\n$$\n\\text{最大化} \\quad Q = \\Delta t \\sum_{t=0}^{T-1} I_t\n$$\n其中 $\\Delta t$ 是一个时间步的持续时间。\n\n**2. 鲁棒优化公式**\n\n参数 $R$ 和 $P$ 被建模为 $R = R_{\\mathrm{nom}} + \\delta_R$ 和 $P = P_{\\mathrm{nom}} + \\delta_P$，其中偏差 $\\delta_R \\in [0, \\hat{R}]$ 和 $\\delta_P \\in [0, \\hat{P}]$。半径 $\\hat{R}$ 和 $\\hat{P}$ 是根据从指定分布中抽取的训练数据的经验 $0.95$-分位数确定的。\n\n电压约束 $V_t \\le V_{\\max}$ 必须对所有 $t$ 和所有允许的参数偏差成立。使用带有预算 $\\Gamma \\in [0, 2]$ 的 Bertsimas-Sim 预算不确定性方法，为每个时间步 $t$ 构建不确定性的最坏情况实现。这导致了电压约束的鲁棒对应：\n$$\nU_{\\mathrm{nom},t} + R_{\\mathrm{nom}} I_t + P_{\\mathrm{nom}} s_t + \\underbrace{\\max_{\\substack{S \\subseteq \\{1, 2\\}, |S| \\le \\Gamma}} \\left\\{ \\sum_{i \\in S} \\text{dev}_i \\right\\}}_{\\text{鲁棒性项}} \\le V_{\\max}\n$$\n其中 $\\text{dev}_1 = \\hat{R}I_t$ 且 $\\text{dev}_2 = \\hat{P}s_t$。这个内部最大化问题的对偶问题产生了一组线性约束。完整的优化问题被公式化为一个线性规划（LP）。\n\n**决策变量**：\n对于每个时间步 $t \\in \\{0, \\dots, T-1\\}$，我们定义以下变量：\n- $I_t$：充电电流。\n- $s_t$：电流变化幅度。\n- $z_t, p_{t,1}, p_{t,2}$：用于鲁棒对应的辅助变量。\n\n决策变量的完整向量是 $\\mathbf{x} \\in \\mathbb{R}^{5T}$，结构如下：\n$$\n\\mathbf{x} = [I_0, \\dots, I_{T-1}, s_0, \\dots, s_{T-1}, z_0, \\dots, z_{T-1}, p_{0,1}, \\dots, p_{T-1,1}, p_{0,2}, \\dots, p_{T-1,2}]^T\n$$\n\n**线性规划公式**：\n问题是求解：\n$$\n\\max_{\\mathbf{x}} \\quad \\mathbf{c}^T \\mathbf{x} \\quad \\text{满足} \\quad \\mathbf{A}_{\\text{ub}} \\mathbf{x} \\le \\mathbf{b}_{\\text{ub}} \\quad \\text{和} \\quad \\mathbf{l} \\le \\mathbf{x} \\le \\mathbf{u}\n$$\n其中目标向量 $\\mathbf{c}$ 对每个 $I_t$ 的条目为 $\\Delta t$，其他为 $0$。由于 $\\Delta t$ 是一个正常数，我们可以等价地最大化 $\\sum I_t$ 并将结果乘以 $\\Delta t$。\n\n**每个 $t \\in \\{0, \\dots, T-1\\}$ 的约束**：\n1.  **鲁棒电压约束**：\n    $$R_{\\mathrm{nom}} I_t + P_{\\mathrm{nom}} s_t + \\Gamma z_t + p_{t,1} + p_{t,2} \\le V_{\\max} - U_{\\mathrm{nom},t}$$\n2.  **鲁棒对应辅助约束**：\n    $$\\hat{R} I_t - z_t - p_{t,1} \\le 0$$\n    $$\\hat{P} s_t - z_t - p_{t,2} \\le 0$$\n3.  **绝对值线性化**：约束 $s_t \\ge |I_t - I_{t-1}|$ 被线性化为：\n    $$I_t - I_{t-1} - s_t \\le 0$$\n    $$I_{t-1} - I_t - s_t \\le 0$$\n    （约定 $I_{-1} = 0$）。\n4.  **变量界限**：\n    $$0 \\le I_t \\le I_{\\max}$$\n    $$s_t \\ge 0, \\quad z_t \\ge 0, \\quad p_{t,1} \\ge 0, \\quad p_{t,2} \\ge 0$$\n\n**3. 调整预算参数 $\\Gamma$**\n\n主要任务是从候选集 $\\{0.0, 0.5, 1.0, 1.5, 2.0\\}$ 中选择最佳的 $\\Gamma$。选择基于在样本外验证数据上评估的风险调整后性能指标 $\\widetilde{Q}$。\n\n对于每个候选 $\\Gamma$：\n1.  构建并求解上述定义的 LP，以找到最优电流曲线 $\\{I_t^*\\}_{t=0}^{T-1}$ 和相应的电流变化 $\\{s_t^*\\}_{t=0}^{T-1}$。\n2.  计算总电荷：$Q^* = \\Delta t \\sum_{t=0}^{T-1} I_t^*$。\n3.  使用 $N_{\\mathrm{val}}$ 个验证场景 $(\\delta_{R,j}, \\delta_{P,j})$ 评估此曲线的鲁棒性。对于每个场景 $j=1, \\dots, N_{\\mathrm{val}}$，如果电压限制在任何时间步被违反，则发生一次违规：\n    $$\n    \\exists t \\in \\{0, \\dots, T-1\\} \\quad \\text{使得} \\quad U_{\\mathrm{nom},t} + (R_{\\mathrm{nom}} + \\delta_{R,j})I_t^* + (P_{\\mathrm{nom}} + \\delta_{P,j})s_t^*  V_{\\max}\n    $$\n4.  违规率 $v$ 是导致违规的验证场景的比例。\n5.  计算风险调整后电荷：$\\widetilde{Q} = Q^* \\cdot (1 - v)$。\n\n最优预算参数 $\\Gamma_{\\text{opt}}$ 是最大化 $\\widetilde{Q}$ 的那个。如果 $\\widetilde{Q}$ 值出现平局，则选择最小的 $\\Gamma$。\n\n**4. 算法实现**\n\n对于每个测试用例，算法按以下步骤进行：\n1.  为可复现性设置随机数生成器种子。从折叠正态分布 $|\\mathcal{N}(0, \\sigma^2)|$ 中生成 $N_{\\mathrm{train}}=200$ 个 $(\\delta_R^{\\mathrm{train}}, \\delta_P^{\\mathrm{train}})$ 样本。\n2.  将 $\\hat{R}$ 和 $\\hat{P}$ 计算为生成的 $\\delta_R^{\\mathrm{train}}$ 和 $\\delta_P^{\\mathrm{train}}$ 样本的 $0.95$-分位数。\n3.  设置一个新的种子，并从指定的混合分布中生成 $N_{\\mathrm{val}}=1000$ 个验证样本 $(\\delta_R^{\\mathrm{val}}, \\delta_P^{\\mathrm{val}})$。\n4.  初始化 $\\Gamma_{\\text{opt}} = -1.0$ 和 $\\widetilde{Q}_{\\max} = -1.0$。\n5.  遍历每个 $\\Gamma \\in \\{0.0, 0.5, 1.0, 1.5, 2.0\\}$：\n    a. 基于问题参数、估计的 $(\\hat{R}, \\hat{P})$ 和当前的 $\\Gamma$ 构建 LP 矩阵 $\\mathbf{c}$、$\\mathbf{A}_{\\text{ub}}$、$\\mathbf{b}_{\\text{ub}}$ 和界限 $(\\mathbf{l}, \\mathbf{u})$。\n    b. 使用标准求解器（例如 `scipy.optimize.linprog`）求解 LP 以获得最优解向量 $\\mathbf{x}^*$。\n    c. 提取最优电流曲线 $\\{I_t^*\\}$ 和步长变化 $\\{s_t^*\\}$。\n    d. 使用验证数据计算 $Q^*$ 和违规率 $v$。\n    e. 计算 $\\widetilde{Q} = Q^* \\cdot (1 - v)$。\n    f. 如果 $\\widetilde{Q}  \\widetilde{Q}_{\\max}$，则更新 $\\widetilde{Q}_{\\max} = \\widetilde{Q}$ 和 $\\Gamma_{\\text{opt}} = \\Gamma$。平局规则（选择最小的 $\\Gamma$）通过严格不等式来处理。\n6.  测试用例的最终结果是 $\\Gamma_{\\text{opt}}$。对所有三个测试用例重复整个过程。\n\n这种系统化的方法确保所选的充电策略不仅在输送电荷方面性能高，而且对电池参数的预期变化具有鲁棒性，这是安全可靠运行的关键考虑因素。",
            "answer": "$$\\boxed{\\text{[1.0, 1.5, 0.5]}}$$"
        }
    ]
}