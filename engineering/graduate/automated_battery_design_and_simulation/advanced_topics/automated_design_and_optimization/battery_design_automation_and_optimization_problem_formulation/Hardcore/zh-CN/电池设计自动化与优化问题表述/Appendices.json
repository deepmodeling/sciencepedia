{
    "hands_on_practices": [
        {
            "introduction": "在开始优化电池设计之前，我们必须首先界定我们探索的边界。这项基础实践将指导您如何运用欧姆定律和菲克扩散等基本物理原理，来构建一个可行的设计空间 。通过将输运限制转化为数学约束，您将学会为关键设计变量计算许用范围，从而确保后续的任何优化工作都建立在物理现实的基础之上。",
            "id": "3894809",
            "problem": "考虑一个一维锂离子电池 (LIB) 模型，该模型由厚度为 $L_n$ 的多孔负极、厚度为 $L_p$ 的多孔正极和厚度为 $L_s$ 的多孔聚合物隔膜组成。多孔电极的孔隙率分别为 $\\epsilon_n$ 和 $\\epsilon_p$，负极和正极中的特征活性颗粒半径分别为 $R_{p,n}$ 和 $R_{p,p}$。电解液是盐浓度均匀为 $c_0$ 的二元盐溶液。\n\n您的任务是构建传输可行性约束，并使用它们计算设计变量 $\\{L_n, L_p, \\epsilon_n, \\epsilon_p, R_{p,n}, R_{p,p}, L_s, c_0\\}$ 的容许边界，以用于自动化设计空间枚举。\n\n仅使用以下基本模型和事实：\n\n- 多孔介质中离子传导的欧姆定律：在厚度为 $L$、承载均匀表观电流密度 $j$ 的区域内，电解液相的欧姆降为 $\\Delta \\phi_e = j L / \\kappa_{\\text{eff}}$。\n- 电解液离子电导率与盐浓度成正比：$\\kappa_e(c_0) = \\kappa_m c_0$，其中 $\\kappa_m$ 是在所关注浓度范围内的已知比例常数。\n- 孔隙率为 $\\epsilon$ 的多孔区域中的有效离子电导率遵循 Bruggeman 关系式：$\\kappa_{\\text{eff}} = \\kappa_e(c_0)\\,\\epsilon^{b}$，其中 $b$ 为 Bruggeman 指数。\n- 菲克扩散时间尺度：\n  - 颗粒内的固相扩散时间：$t_{\\text{diff},s} = R_p^{2} / D_s$，其中 $D_s$ 是固态锂扩散系数。\n  - 穿过电极的电解液相扩散时间：$t_{\\text{diff},e} = L^{2} / (D_e\\,\\epsilon^{b})$，其中 $D_e$ 是二元电解质扩散系数，$\\epsilon^{b}$ 通过 Bruggeman 关系式来解释曲折度的影响。\n\n为获得稳健的自动化设计空间边界，施加以下传输可行性约束：\n\n1. 电解液欧姆降预算。将总电解液欧姆降限制在 $V_e^{\\max}$ 以内；为确保稳健性，将此预算的三分之一分配给每个区域：\n   - 负极：$j L_n / \\kappa_{\\text{eff},n} \\leq V_e^{\\max}/3$。\n   - 隔膜：$j L_s / \\kappa_{\\text{eff},s} \\leq V_e^{\\max}/3$。\n   - 正极：$j L_p / \\kappa_{\\text{eff},p} \\leq V_e^{\\max}/3$。\n   使用 $\\kappa_{\\text{eff},n} = \\kappa_m c_0 \\epsilon_n^{b}$、$\\kappa_{\\text{eff},p} = \\kappa_m c_0 \\epsilon_p^{b}$ 和 $\\kappa_{\\text{eff},s} = \\kappa_m c_0 \\epsilon_s^{b}$，其中隔膜孔隙率 $\\epsilon_s$ 视为固定值。\n\n2. 活性颗粒中的固相扩散约束。通过要求每个电极中的 $t_{\\text{diff},s} \\leq \\beta\\,t_d$ 来限制浓度梯度，其中 $t_d$ 是放电时间，$\\beta \\in (0,1)$ 是一个设计因子：\n   - 负极：$R_{p,n}^{2} / D_{s,n} \\leq \\beta\\,t_d$。\n   - 正极：$R_{p,p}^{2} / D_{s,p} \\leq \\beta\\,t_d$。\n\n3. 穿过电极的电解液扩散约束。通过要求每个多孔电极中的 $t_{\\text{diff},e} \\leq \\gamma\\,t_d$ 来限制电解液浓度梯度：\n   - 负极：$L_n^{2} / (D_e \\epsilon_n^{b}) \\leq \\gamma\\,t_d$。\n   - 正极：$L_p^{2} / (D_e \\epsilon_p^{b}) \\leq \\gamma\\,t_d$。\n\n为确保自动化枚举的逐变量容许边界，在计算每个边界时，请使用其允许范围内其他变量的最差情况值，以保证在整个枚举空间内的可行性。具体来说，对于隔膜约束，使用最差情况的隔膜厚度；对于电极约束，使用最小电极孔隙率。\n\n使用以下对于石墨（负极）和层状氧化物（正极）在碳酸酯电解液中于中等倍率下科学合理的数值和参数范围：\n\n- 电流密度：$j = 20\\,\\text{A}\\,\\text{m}^{-2}$。\n- 电解液欧姆降预算：$V_e^{\\max} = 0.15\\,\\text{V}$。\n- 电导率比例常数：$\\kappa_m = 1.0 \\times 10^{-3}\\,\\text{S}\\,\\text{m}^{3}\\,\\text{mol}^{-1}$。\n- Bruggeman 指数：$b = 1.5$。\n- 隔膜孔隙率：$\\epsilon_s = 0.40$。\n- 隔膜厚度范围：$L_s \\in [15 \\times 10^{-6},\\,25 \\times 10^{-6}]\\,\\text{m}$；在计算 $c_0$ 的边界时，使用最差情况 $L_s^{\\max} = 25 \\times 10^{-6}\\,\\text{m}$。\n- 电极孔隙率范围：$\\epsilon_n, \\epsilon_p \\in [0.30,\\,0.60]$；在计算 $L_n$ 和 $L_p$ 的边界时，使用 $\\epsilon_n^{\\min} = \\epsilon_p^{\\min} = 0.30$。\n- 电解液扩散系数：$D_e = 2.0 \\times 10^{-10}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n- 负极固相扩散系数：$D_{s,n} = 1.0 \\times 10^{-14}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n- 正极固相扩散系数：$D_{s,p} = 5.0 \\times 10^{-15}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n- 放电时间：$t_d = 3600\\,\\text{s}$。\n- 设计因子：$\\beta = 0.10$, $\\gamma = 0.10$。\n\n任务：\n\n(a) 使用约束条件和指定的最差情况值，推导 $c_0$、$L_n$、$L_p$、$R_{p,n}$、$R_{p,p}$ 的符号形式容许边界。您的推导必须从所列的基本模型开始，不得使用简化公式。\n\n(b) 使用给定的常数对推导出的边界进行数值评估。\n\n(c) 最后，报告在综合约束下，负极厚度 $L_n$ 的最大容许值（以微米为单位），取欧姆和电解液扩散边界中较严格的一个。最终厚度以微米表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求基于一组简化的一维传输模型和可行性约束，推导和计算锂离子电池 (LIB) 几个设计变量的容许边界。该过程包括验证问题陈述，推导边界的符号表达式，然后对这些边界进行数值评估。\n\n### 问题验证\n\n**第 1 步：提取给定信息**\n\n问题提供了以下信息：\n\n*   **设计变量**：$\\{L_n, L_p, \\epsilon_n, \\epsilon_p, R_{p,n}, R_{p,p}, L_s, c_0\\}$。\n*   **几何参数**：负极厚度 $L_n$，正极厚度 $L_p$，隔膜厚度 $L_s$。\n*   **微观结构参数**：负极孔隙率 $\\epsilon_n$，正极孔隙率 $\\epsilon_p$，负极颗粒半径 $R_{p,n}$，正极颗粒半径 $R_{p,p}$。\n*   **电解液参数**：均匀盐浓度 $c_0$。\n*   **基本模型**：\n    *   多孔介质的欧姆定律：$\\Delta \\phi_e = j L / \\kappa_{\\text{eff}}$。\n    *   电解液电导率：$\\kappa_e(c_0) = \\kappa_m c_0$。\n    *   Bruggeman 关系式：$\\kappa_{\\text{eff}} = \\kappa_e(c_0)\\,\\epsilon^{b}$。\n    *   固相扩散时间：$t_{\\text{diff},s} = R_p^{2} / D_s$。\n    *   电解液相扩散时间：$t_{\\text{diff},e} = L^{2} / (D_e\\,\\epsilon^{b})$。\n*   **传输可行性约束**：\n    1.  欧姆降预算 $\\leq V_e^{\\max}$，每个区域分配三分之一：\n        *   $j L_n / \\kappa_{\\text{eff},n} \\leq V_e^{\\max}/3$，其中 $\\kappa_{\\text{eff},n} = \\kappa_m c_0 \\epsilon_n^{b}$。\n        *   $j L_s / \\kappa_{\\text{eff},s} \\leq V_e^{\\max}/3$，其中 $\\kappa_{\\text{eff},s} = \\kappa_m c_0 \\epsilon_s^{b}$。\n        *   $j L_p / \\kappa_{\\text{eff},p} \\leq V_e^{\\max}/3$，其中 $\\kappa_{\\text{eff},p} = \\kappa_m c_0 \\epsilon_p^{b}$。\n    2.  固相扩散约束：$t_{\\text{diff},s} \\leq \\beta\\,t_d$。\n        *   $R_{p,n}^{2} / D_{s,n} \\leq \\beta\\,t_d$。\n        *   $R_{p,p}^{2} / D_{s,p} \\leq \\beta\\,t_d$。\n    3.  电解液扩散约束：$t_{\\text{diff},e} \\leq \\gamma\\,t_d$。\n        *   $L_n^{2} / (D_e \\epsilon_n^{b}) \\leq \\gamma\\,t_d$。\n        *   $L_p^{2} / (D_e \\epsilon_p^{b}) \\leq \\gamma\\,t_d$。\n*   **用于确定边界的最差情况假设**：\n    *   对于隔膜约束，使用 $L_s^{\\max}$。\n    *   对于电极约束，使用 $\\epsilon_n^{\\min}$ 和 $\\epsilon_p^{\\min}$。\n*   **数值和范围**：\n    *   $j = 20\\,\\text{A}\\,\\text{m}^{-2}$。\n    *   $V_e^{\\max} = 0.15\\,\\text{V}$。\n    *   $\\kappa_m = 1.0 \\times 10^{-3}\\,\\text{S}\\,\\text{m}^{3}\\,\\text{mol}^{-1}$。\n    *   $b = 1.5$。\n    *   $\\epsilon_s = 0.40$。\n    *   $L_s \\in [15 \\times 10^{-6},\\,25 \\times 10^{-6}]\\,\\text{m}$；使用 $L_s^{\\max} = 25 \\times 10^{-6}\\,\\text{m}$。\n    *   $\\epsilon_n, \\epsilon_p \\in [0.30,\\,0.60]$；使用 $\\epsilon_n^{\\min} = \\epsilon_p^{\\min} = 0.30$。\n    *   $D_e = 2.0 \\times 10^{-10}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n    *   $D_{s,n} = 1.0 \\times 10^{-14}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n    *   $D_{s,p} = 5.0 \\times 10^{-15}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n    *   $t_d = 3600\\,\\text{s}$。\n    *   $\\beta = 0.10$。\n    *   $\\gamma = 0.10$。\n\n**第 2 步：使用提取的给定信息进行验证**\n\n根据验证标准评估该问题。\n*   **科学性**：该问题基于标准但简化的传输现象模型（欧姆定律、菲克扩散、Bruggeman 相关式），这些是电化学工程和电池建模领域的基础。提供的数值对于指定的电池化学体系是合理的。\n*   **适定性**：问题定义清晰。它指定了模型、约束和一种明确的方法（最差情况分析），用于为设计变量推导明确的上限或下限。\n*   **客观性**：问题陈述是定量的，没有主观或含糊的语言。\n*   **缺陷清单检查**：该问题未违反任何指定的缺陷。它在科学上是合理的、可形式化的、完整的且内部一致的。所需的逻辑并非微不足道，并且与电池的自动化设计空间探索直接相关。\n\n**第 3 步：结论与行动**\n\n该问题是**有效的**。将提供一个完整的、有理有据的解决方案。\n\n### 求解推导\n\n求解过程首先按照任务 (a) 的要求推导所需边界的符号表达式，然后为任务 (b) 进行数值评估，最后确定任务 (c) 中要求的具体值。\n\n**(a) 符号形式容许边界的推导**\n\n1.  **盐浓度 $c_0$ 的边界**\n    关于 $c_0$ 的边界来自于隔膜中的欧姆降约束。这是一个下界约束，因为较低的浓度会降低电导率并增加电压降。\n    $$ \\frac{j L_s}{\\kappa_{\\text{eff},s}} \\leq \\frac{V_e^{\\max}}{3} $$\n    代入 $\\kappa_{\\text{eff},s} = \\kappa_m c_0 \\epsilon_s^{b}$：\n    $$ \\frac{j L_s}{\\kappa_m c_0 \\epsilon_s^{b}} \\leq \\frac{V_e^{\\max}}{3} $$\n    解出 $c_0$ 得到一个下界：\n    $$ c_0 \\geq \\frac{3 j L_s}{\\kappa_m \\epsilon_s^{b} V_e^{\\max}} $$\n    为了确保此约束在其允许范围内的任何隔膜厚度下都成立，我们必须使用最差情况（最大）值 $L_s^{\\max}$，这使得对 $c_0$ 的要求最为严格。因此，最小容许浓度为：\n    $$ c_0^{\\min} = \\frac{3 j L_s^{\\max}}{\\kappa_m \\epsilon_s^{b} V_e^{\\max}} $$\n\n2.  **颗粒半径 $R_{p,n}$ 和 $R_{p,p}$ 的边界**\n    颗粒半径的边界来自固相扩散约束，该约束限制了最大半径以确保锂在颗粒内的及时扩散。\n    对于负极：\n    $$ \\frac{R_{p,n}^{2}}{D_{s,n}} \\leq \\beta t_d \\implies R_{p,n} \\leq \\sqrt{\\beta t_d D_{s,n}} $$\n    这定义了负极的最大容许颗粒半径 $R_{p,n}^{\\max}$。\n    对于正极：\n    $$ \\frac{R_{p,p}^{2}}{D_{s,p}} \\leq \\beta t_d \\implies R_{p,p} \\leq \\sqrt{\\beta t_d D_{s,p}} $$\n    这定义了正极的最大容许颗粒半径 $R_{p,p}^{\\max}$。\n\n3.  **电极厚度 $L_n$ 和 $L_p$ 的边界**\n    每个电极的厚度同时受到欧姆降和电解液相扩散的约束。\n\n    *   **对于负极 ($L_n$)**：\n        *   **欧姆约束**：\n          $$ \\frac{j L_n}{\\kappa_{\\text{eff},n}} \\leq \\frac{V_e^{\\max}}{3} \\implies L_n \\leq \\frac{\\kappa_{\\text{eff},n} V_e^{\\max}}{3 j} = \\frac{\\kappa_m c_0 \\epsilon_n^{b} V_e^{\\max}}{3 j} $$\n          为了找到一个在整个设计空间内都有效的单一上限，我们使用其他变量的最差情况（最严格）值，即减小右侧的最小值：$c_0^{\\min}$ 和 $\\epsilon_n^{\\min}$。\n          $$ L_{n, \\text{ohm}}^{\\max} = \\frac{\\kappa_m c_0^{\\min} (\\epsilon_n^{\\min})^{b} V_e^{\\max}}{3 j} $$\n        *   **电解液扩散约束**：\n          $$ \\frac{L_n^{2}}{D_e \\epsilon_n^{b}} \\leq \\gamma t_d \\implies L_n \\leq \\sqrt{\\gamma t_d D_e \\epsilon_n^{b}} $$\n          为了找到最严格的上限，我们使用使右侧最小化的 $\\epsilon_n$ 值，即 $\\epsilon_n^{\\min}$。\n          $$ L_{n, \\text{diff}}^{\\max} = \\sqrt{\\gamma t_d D_e (\\epsilon_n^{\\min})^{b}} $$\n        $L_n$ 的总容许上限是这两个竞争约束中的最小值：$L_n^{\\max} = \\min(L_{n, \\text{ohm}}^{\\max}, L_{n, \\text{diff}}^{\\max})$。\n\n    *   **对于正极 ($L_p$)**：\n        推导过程与负极相同，只需将下标 $n$ 替换为 $p$。由于 $\\epsilon_p^{\\min} = \\epsilon_n^{\\min}$，得到的边界将是相同的。\n        $$ L_{p, \\text{ohm}}^{\\max} = \\frac{\\kappa_m c_0^{\\min} (\\epsilon_p^{\\min})^{b} V_e^{\\max}}{3 j} $$\n        $$ L_{p, \\text{diff}}^{\\max} = \\sqrt{\\gamma t_d D_e (\\epsilon_p^{\\min})^{b}} $$\n        总边界为 $L_p^{\\max} = \\min(L_{p, \\text{ohm}}^{\\max}, L_{p, \\text{diff}}^{\\max})$。\n\n**(b) 边界的数值评估**\n\n现在使用提供的数值参数对推导出的符号边界进行评估。所有计算均使用国际单位制。\n\n1.  **最小盐浓度, $c_0^{\\min}$**：\n    $$ c_0^{\\min} = \\frac{3 (20) (25 \\times 10^{-6})}{(1.0 \\times 10^{-3}) (0.40)^{1.5} (0.15)} = \\frac{1.5 \\times 10^{-3}}{3.7947 \\times 10^{-5}} \\approx 39.528\\,\\text{mol}\\,\\text{m}^{-3} $$\n\n2.  **最大颗粒半径, $R_{p,n}^{\\max}$ 和 $R_{p,p}^{\\max}$**：\n    $$ R_{p,n}^{\\max} = \\sqrt{(0.10) (3600) (1.0 \\times 10^{-14})} = \\sqrt{3.6 \\times 10^{-12}} = 1.897 \\times 10^{-6}\\,\\text{m} $$\n    $$ R_{p,p}^{\\max} = \\sqrt{(0.10) (3600) (5.0 \\times 10^{-15})} = \\sqrt{1.8 \\times 10^{-12}} \\approx 1.342 \\times 10^{-6}\\,\\text{m} $$\n\n3.  **最大负极厚度, $L_n^{\\max}$**：\n    首先，我们计算项 $(\\epsilon_n^{\\min})^{b} = (0.30)^{1.5} \\approx 0.16432$。\n    *   **欧姆边界**：\n      $$ L_{n, \\text{ohm}}^{\\max} = \\frac{(1.0 \\times 10^{-3})(39.528)(0.16432)(0.15)}{3(20)} \\approx 1.6239 \\times 10^{-5}\\,\\text{m} $$\n    *   **扩散边界**：\n      $$ L_{n, \\text{diff}}^{\\max} = \\sqrt{(0.10)(3600)(2.0 \\times 10^{-10})(0.16432)} \\approx \\sqrt{1.1831 \\times 10^{-8}} \\approx 1.0877 \\times 10^{-4}\\,\\text{m} $$\n\n4.  **最大正极厚度, $L_p^{\\max}$**：\n    由于 $\\epsilon_p^{\\min} = \\epsilon_n^{\\min}$，$L_p$ 的数值边界与 $L_n$ 相同。\n    *   $L_{p, \\text{ohm}}^{\\max} \\approx 1.6239 \\times 10^{-5}\\,\\text{m}$。\n    *   $L_{p, \\text{diff}}^{\\max} \\approx 1.0877 \\times 10^{-4}\\,\\text{m}$。\n\n**(c) 最终容许负极厚度**\n\n最后的任务是报告最大容许负极厚度 $L_n^{\\max}$，即两个推导出的上界中更严格（最小）的一个。\n$$ L_n^{\\max} = \\min(L_{n, \\text{ohm}}^{\\max}, L_{n, \\text{diff}}^{\\max}) = \\min(1.6239 \\times 10^{-5}\\,\\text{m}, 1.0877 \\times 10^{-4}\\,\\text{m}) $$\n$$ L_n^{\\max} = 1.6239 \\times 10^{-5}\\,\\text{m} $$\n发现在这些条件下，欧姆约束是限制电极厚度的因素。\n将此结果转换为微米：\n$$ L_n^{\\max} = (1.6239 \\times 10^{-5}\\,\\text{m}) \\times \\frac{10^6\\,\\mu\\text{m}}{1\\,\\text{m}} = 16.239\\,\\mu\\text{m} $$\n四舍五入到四位有效数字，最大容许厚度为 $16.24\\,\\mu\\text{m}$。",
            "answer": "$$\n\\boxed{16.24}\n$$"
        },
        {
            "introduction": "电池设计很少是优化单一指标；它是一种权衡的艺术，其中最著名的是能量密度与功率密度之间的平衡。本练习通过帕累托分析，向您介绍多目标评估的关键概念 。通过计算几个候选设计的面能量密度和面功率密度，您将学会识别哪些设计是“帕累托劣势”的，即它们在客观上逊于其他设计，这是驾驭复杂设计权衡的核心技能。",
            "id": "3894887",
            "problem": "考虑一个单一的多孔嵌入电极，其几何面积为 $A = 1\\,\\mathrm{m^2}$。您将比较四种候选设计，这些设计由电极厚度 $L$、孔隙率 $\\epsilon$ 和活性颗粒半径 $R_p$ 定义。假设对电极和隔膜不是速率限制因素，并忽略接触电阻；所有设计都使用相同的材料和温度。仅使用下面给出的关系式来构建能量密度和功率密度，并确定哪些设计是帕累托支配的。\n\n基本依据和参数：\n- 活性材料的面质量为 $m_{\\mathrm{areal}} = \\rho_{s}\\,(1 - \\epsilon)\\,L$，其中 $\\rho_s$ 是固相活性材料的密度。\n- 面容量为 $Q_{\\mathrm{areal}} = q_s\\,m_{\\mathrm{areal}}$，其中 $q_s$ 是活性材料的比容量。\n- 在标称电压 $V_{\\mathrm{nom}}$ 下的面能量为 $E_{\\mathrm{areal}} = V_{\\mathrm{nom}}\\,Q_{\\mathrm{areal}}$。\n- 内阻由三个串联部分组成：\n  1. 孔隙电解质中的离子传导，使用 Bruggeman 关系式 $\\sigma_{\\mathrm{ion,eff}} = \\sigma_e\\,\\epsilon^{b}$ 建模，得到 $R_{\\mathrm{ion}} = \\dfrac{L}{\\sigma_{\\mathrm{ion,eff}}\\,A}$。\n  2. 固相基体中的电子传导，建模为 $\\sigma_{\\mathrm{sol,eff}} = \\sigma_s\\,(1 - \\epsilon)^{b_s}$，得到 $R_{\\mathrm{sol}} = \\dfrac{L}{\\sigma_{\\mathrm{sol,eff}}\\,A}$。\n  3. 电荷转移电阻，从线性化的 Butler–Volmer 动力学获得，单位界面面积的电阻为 $r_{\\mathrm{ct}} = \\dfrac{RT}{F\\,i_0}$，单位几何面积上的总界面面积为 $a_s\\,L$，其中球形颗粒的比界面面积为 $a_s = \\dfrac{3\\,(1 - \\epsilon)}{R_p}$。因此 $R_{\\mathrm{ct}} = \\dfrac{RT}{F\\,i_0\\,a_s\\,A\\,L}$。\n- 总内阻为 $R_{\\mathrm{int}} = R_{\\mathrm{ion}} + R_{\\mathrm{sol}} + R_{\\mathrm{ct}}$。\n- 使用从第一性原理和最大功率传输定理推导出的集总电阻-电容（RC）时间近似，面功率密度为 $P_{\\mathrm{areal}} = \\dfrac{V_{\\mathrm{nom}}^{2}}{4\\,R_{\\mathrm{int}}\\,A}$。\n\n常数和材料属性：\n- $V_{\\mathrm{nom}} = 3.7\\,\\mathrm{V}$, $q_s = 160\\,\\mathrm{Ah\\,kg^{-1}}$, $\\rho_s = 4750\\,\\mathrm{kg\\,m^{-3}}$。\n- 电解质电导率 $\\sigma_e = 1.2\\,\\mathrm{S\\,m^{-1}}$，离子传输的 Bruggeman 指数 $b = 1.5$。\n- 固相电导率 $\\sigma_s = 5000\\,\\mathrm{S\\,m^{-1}}$，固相网络的指数 $b_s = 1.5$。\n- 交换电流密度 $i_0 = 5\\,\\mathrm{A\\,m^{-2}}$（每单位界面面积），法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$，理想气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，温度 $T = 298\\,\\mathrm{K}$。\n\n候选设计：\n- 设计 1: $L = 60\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.35$, $R_p = 4\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 2: $L = 100\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.40$, $R_p = 5\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 3: $L = 80\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.30$, $R_p = 3\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 4: $L = 120\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.45$, $R_p = 8\\times 10^{-6}\\,\\mathrm{m}$。\n\n任务：\n1. 对每个设计，计算以 $\\mathrm{Wh\\,m^{-2}}$ 为单位的面能量 $E_{\\mathrm{areal}}$。\n2. 对每个设计，使用上面提供的 RC 时间近似，计算以 $\\mathrm{W\\,m^{-2}}$ 为单位的面功率密度 $P_{\\mathrm{areal}}$。\n3. 确定哪些设计是帕累托支配的。如果存在另一个设计，其面能量至少一样高，面功率也至少一样高，并且这两个指标中至少有一个有严格的提升，那么一个设计就是帕累托支配的。\n\n将帕累托支配设计的索引按升序排列作为最终答案报告。最终答案无需舍入说明。在适用时，将中间能量以 $\\mathrm{Wh\\,m^{-2}}$ 表示，功率以 $\\mathrm{W\\,m^{-2}}$ 表示。",
            "solution": "**问题验证**\n\n**步骤 1：提取已知条件**\n- 几何面积：$A = 1\\,\\mathrm{m^2}$\n- 候选设计由以下参数定义：电极厚度 $L$、孔隙率 $\\epsilon$ 和活性颗粒半径 $R_p$。\n- 假设：对电极和隔膜不是速率限制因素；忽略接触电阻；所有设计共享相同的材料和温度。\n- 活性材料的面质量：$m_{\\mathrm{areal}} = \\rho_{s}\\,(1 - \\epsilon)\\,L$\n- 固相活性材料密度：$\\rho_s = 4750\\,\\mathrm{kg\\,m^{-3}}$\n- 面容量：$Q_{\\mathrm{areal}} = q_s\\,m_{\\mathrm{areal}}$\n- 活性材料的比容量：$q_s = 160\\,\\mathrm{Ah\\,kg^{-1}}$\n- 在标称电压 $V_{\\mathrm{nom}}$ 下的面能量：$E_{\\mathrm{areal}} = V_{\\mathrm{nom}}\\,Q_{\\mathrm{areal}}$\n- 标称电压：$V_{\\mathrm{nom}} = 3.7\\,\\mathrm{V}$\n- 总内阻：$R_{\\mathrm{int}} = R_{\\mathrm{ion}} + R_{\\mathrm{sol}} + R_{\\mathrm{ct}}$\n- 离子电阻：$R_{\\mathrm{ion}} = \\dfrac{L}{\\sigma_{\\mathrm{ion,eff}}\\,A}$，有效离子电导率 $\\sigma_{\\mathrm{ion,eff}} = \\sigma_e\\,\\epsilon^{b}$。\n- 电解质电导率：$\\sigma_e = 1.2\\,\\mathrm{S\\,m^{-1}}$\n- 离子传输的 Bruggeman 指数：$b = 1.5$\n- 电子电阻：$R_{\\mathrm{sol}} = \\dfrac{L}{\\sigma_{\\mathrm{sol,eff}}\\,A}$，有效固相电导率 $\\sigma_{\\mathrm{sol,eff}} = \\sigma_s\\,(1 - \\epsilon)^{b_s}$。\n- 固相电导率：$\\sigma_s = 5000\\,\\mathrm{S\\,m^{-1}}$\n- 固相网络的指数：$b_s = 1.5$\n- 电荷转移电阻：$R_{\\mathrm{ct}} = \\dfrac{RT}{F\\,i_0\\,a_s\\,A\\,L}$，单位体积的比界面面积 $a_s = \\dfrac{3\\,(1 - \\epsilon)}{R_p}$。\n- 普适气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- 温度：$T = 298\\,\\mathrm{K}$\n- 法拉第常数：$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n- 交换电流密度：$i_0 = 5\\,\\mathrm{A\\,m^{-2}}$\n- 面功率密度：$P_{\\mathrm{areal}} = \\dfrac{V_{\\mathrm{nom}}^{2}}{4\\,R_{\\mathrm{int}}\\,A}$\n- 设计 1: $L = 60\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.35$, $R_p = 4\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 2: $L = 100\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.40$, $R_p = 5\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 3: $L = 80\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.30$, $R_p = 3\\times 10^{-6}\\,\\mathrm{m}$。\n- 设计 4: $L = 120\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.45$, $R_p = 8\\times 10^{-6}\\,\\mathrm{m}$。\n- 任务：(1) 计算每个设计的 $E_{\\mathrm{areal}}$。(2) 计算每个设计的 $P_{\\mathrm{areal}}$。(3) 确定哪些设计是帕累托支配的。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，利用了已建立的多孔电极行为简化模型，例如用于有效电导率的 Bruggeman 关系式和用于电荷转移电阻的线性化 Butler-Volmer 动力学。所有方程、参数和常数在物理上都是合理的，并与电化学工程文献一致。该问题是适定的，提供了计算所需性能指标和执行帕累托分析所需的所有必要信息。语言是客观的，所有术语都已明确定义。因此，该问题是有效的。\n\n**步骤 3：结论和行动**\n问题有效。将制定完整的解决方案。\n\n**求解过程**\n\n该分析需要计算四个设计中每一个的面能量密度 ($E_{\\mathrm{areal}}$) 和面功率密度 ($P_{\\mathrm{areal}}$)。\n\n面能量密度由以下公式给出：\n$$E_{\\mathrm{areal}} = V_{\\mathrm{nom}} \\, Q_{\\mathrm{areal}} = V_{\\mathrm{nom}} \\, q_s \\, m_{\\mathrm{areal}} = V_{\\mathrm{nom}} \\, q_s \\, \\rho_s (1 - \\epsilon) L$$\n输入参数的单位（$V_{\\mathrm{nom}}$ 单位为 $\\mathrm{V}$，$q_s$ 单位为 $\\mathrm{Ah\\,kg^{-1}}$，$\\rho_s$ 单位为 $\\mathrm{kg\\,m^{-3}}$，$L$ 单位为 $\\mathrm{m}$）直接得出 $E_{\\mathrm{areal}}$ 的单位为 $\\mathrm{Wh\\,m^{-2}}$。\n\n面功率密度由 $P_{\\mathrm{areal}} = \\dfrac{V_{\\mathrm{nom}}^{2}}{4\\,R_{\\mathrm{int}}\\,A}$ 给出。由于几何面积指定为 $A = 1\\,\\mathrm{m^2}$，我们可以计算面电阻 $\\mathcal{R}_{\\mathrm{int}} = R_{\\mathrm{int}} A$。总面电阻是离子、电子和电荷转移贡献的总和：\n$$\\mathcal{R}_{\\mathrm{int}} = \\mathcal{R}_{\\mathrm{ion}} + \\mathcal{R}_{\\mathrm{sol}} + \\mathcal{R}_{\\mathrm{ct}}$$\n各个面电阻分量定义如下：\n1. 离子电阻：$\\mathcal{R}_{\\mathrm{ion}} = R_{\\mathrm{ion}}\\,A = \\dfrac{L}{\\sigma_e \\epsilon^b}$\n2. 电子电阻：$\\mathcal{R}_{\\mathrm{sol}} = R_{\\mathrm{sol}}\\,A = \\dfrac{L}{\\sigma_s (1 - \\epsilon)^{b_s}}$\n3. 电荷转移电阻：$\\mathcal{R}_{\\mathrm{ct}} = R_{\\mathrm{ct}}\\,A = \\dfrac{RT}{F i_0 a_s L}$。代入 $a_s = \\dfrac{3(1-\\epsilon)}{R_p}$，表达式变为 $\\mathcal{R}_{\\mathrm{ct}} = \\dfrac{RT}{F i_0} \\dfrac{R_p}{3(1-\\epsilon)L}$。\n\n然后功率密度计算如下：\n$$P_{\\mathrm{areal}} = \\frac{V_{\\mathrm{nom}}^2}{4 \\mathcal{R}_{\\mathrm{int}}}$$\n首先，我们计算常数组 $\\dfrac{RT}{F i_0}$：\n$$\\frac{RT}{F i_0} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(298\\,\\mathrm{K})}{(96485\\,\\mathrm{C\\,mol^{-1}})(5\\,\\mathrm{A\\,m^{-2}})} \\approx 0.0051358\\,\\mathrm{\\Omega\\,m^2}$$\n我们现在为四个设计中的每一个计算 $E_{\\mathrm{areal}}$ 和 $P_{\\mathrm{areal}}$。\n\n**设计 1：** $L = 60\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.35$, $R_p = 4\\times 10^{-6}\\,\\mathrm{m}$\n$E_{\\mathrm{areal},1} = (3.7) (160) (4750) (1-0.35) (60\\times 10^{-6}) = 109.668\\,\\mathrm{Wh\\,m^{-2}}$\n$\\mathcal{R}_{\\mathrm{ion},1} = \\dfrac{60\\times 10^{-6}}{1.2 \\times (0.35)^{1.5}} \\approx 2.4131 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{sol},1} = \\dfrac{60\\times 10^{-6}}{5000 \\times (0.65)^{1.5}} \\approx 2.2950 \\times 10^{-8}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{ct},1} = (0.0051358) \\dfrac{4\\times 10^{-6}}{3(1-0.35)(60\\times 10^{-6})} \\approx 1.7558 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{int},1} \\approx (2.4131 \\times 10^{-4}) + (2.2950 \\times 10^{-8}) + (1.7558 \\times 10^{-4}) \\approx 4.1691 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$P_{\\mathrm{areal},1} = \\dfrac{(3.7)^2}{4 \\times 4.1691 \\times 10^{-4}} \\approx 8209.19\\,\\mathrm{W\\,m^{-2}}$\n\n**设计 2：** $L = 100\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.40$, $R_p = 5\\times 10^{-6}\\,\\mathrm{m}$\n$E_{\\mathrm{areal},2} = (3.7) (160) (4750) (1-0.40) (100\\times 10^{-6}) = 168.72\\,\\mathrm{Wh\\,m^{-2}}$\n$\\mathcal{R}_{\\mathrm{ion},2} = \\dfrac{100\\times 10^{-6}}{1.2 \\times (0.40)^{1.5}} \\approx 3.2952 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{sol},2} = \\dfrac{100\\times 10^{-6}}{5000 \\times (0.60)^{1.5}} \\approx 4.3034 \\times 10^{-8}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{ct},2} = (0.0051358) \\dfrac{5\\times 10^{-6}}{3(1-0.40)(100\\times 10^{-6})} \\approx 1.4266 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{int},2} \\approx (3.2952 \\times 10^{-4}) + (4.3034 \\times 10^{-8}) + (1.4266 \\times 10^{-4}) \\approx 4.7222 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$P_{\\mathrm{areal},2} = \\dfrac{(3.7)^2}{4 \\times 4.7222 \\times 10^{-4}} \\approx 7247.50\\,\\mathrm{W\\,m^{-2}}$\n\n**设计 3：** $L = 80\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.30$, $R_p = 3\\times 10^{-6}\\,\\mathrm{m}$\n$E_{\\mathrm{areal},3} = (3.7) (160) (4750) (1-0.30) (80\\times 10^{-6}) = 157.472\\,\\mathrm{Wh\\,m^{-2}}$\n$\\mathcal{R}_{\\mathrm{ion},3} = \\dfrac{80\\times 10^{-6}}{1.2 \\times (0.30)^{1.5}} \\approx 4.0560 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{sol},3} = \\dfrac{80\\times 10^{-6}}{5000 \\times (0.70)^{1.5}} \\approx 2.7318 \\times 10^{-8}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{ct},3} = (0.0051358) \\dfrac{3\\times 10^{-6}}{3(1-0.30)(80\\times 10^{-6})} \\approx 0.9171 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{int},3} \\approx (4.0560 \\times 10^{-4}) + (2.7318 \\times 10^{-8}) + (0.9171 \\times 10^{-4}) \\approx 4.9734 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$P_{\\mathrm{areal},3} = \\dfrac{(3.7)^2}{4 \\times 4.9734 \\times 10^{-4}} \\approx 6881.56\\,\\mathrm{W\\,m^{-2}}$\n\n**设计 4：** $L = 120\\times 10^{-6}\\,\\mathrm{m}$, $\\epsilon = 0.45$, $R_p = 8\\times 10^{-6}\\,\\mathrm{m}$\n$E_{\\mathrm{areal},4} = (3.7) (160) (4750) (1-0.45) (120\\times 10^{-6}) = 185.592\\,\\mathrm{Wh\\,m^{-2}}$\n$\\mathcal{R}_{\\mathrm{ion},4} = \\dfrac{120\\times 10^{-6}}{1.2 \\times (0.45)^{1.5}} \\approx 3.3121 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{sol},4} = \\dfrac{120\\times 10^{-6}}{5000 \\times (0.55)^{1.5}} \\approx 5.8720 \\times 10^{-8}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{ct},4} = (0.0051358) \\dfrac{8\\times 10^{-6}}{3(1-0.45)(120\\times 10^{-6})} \\approx 2.0751 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$\\mathcal{R}_{\\mathrm{int},4} \\approx (3.3121 \\times 10^{-4}) + (5.8720 \\times 10^{-8}) + (2.0751 \\times 10^{-4}) \\approx 5.3878 \\times 10^{-4}\\,\\mathrm{\\Omega\\,m^2}$\n$P_{\\mathrm{areal},4} = \\dfrac{(3.7)^2}{4 \\times 5.3878 \\times 10^{-4}} \\approx 6352.28\\,\\mathrm{W\\,m^{-2}}$\n\n**帕累托支配分析**\n性能指标（$E_{\\mathrm{areal}}$ 单位为 $\\mathrm{Wh\\,m^{-2}}$，$P_{\\mathrm{areal}}$ 单位为 $\\mathrm{W\\,m^{-2}}$）如下：\n- 设计 1: ($109.668$, $8209.19$)\n- 设计 2: ($168.72$, $7247.50$)\n- 设计 3: ($157.472$, $6881.56$)\n- 设计 4: ($185.592$, $6352.28$)\n\n如果存在另一个设计 $j$ 使得 $E_j \\ge E_i$ 且 $P_j \\ge P_i$，并且至少有一个不等式是严格成立的，那么设计 $i$ 就是帕累托支配的。\n- 设计 1 具有最高的功率密度；它不可能被支配。\n- 设计 4 具有最高的能量密度；它不可能被支配。\n- 将设计 3 与其他设计比较：\n  - 与设计 1 相比：$E_3 > E_1$，但 $P_3  P_1$。不被设计 1 支配。\n  - 与设计 2 相比：$E_2 = 168.72 > E_3 = 157.472$，且 $P_2 = 7247.50 > P_3 = 6881.56$。由于设计 2 在能量和功率上都更优，**设计 3 被设计 2 帕累托支配**。\n  - 与设计 4 相比：$E_4 > E_3$，但 $P_4  P_3$。不被设计 4 支配。\n- 将设计 2 与其他设计比较：\n  - 与设计 1 相比：$E_2 > E_1$，但 $P_2  P_1$。不被设计 1 支配。\n  - 与设计 4 相比：$E_4 > E_2$，但 $P_4  P_2$。不被设计 4 支配。\n\n唯一被帕累托支配的设计是设计 3。问题要求给出被支配设计的索引。唯一的此类索引是 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在一个包含众多设计变量的复杂系统中，并非所有参数都同等重要。这个动手编程实践将展示如何使用全局敏感性分析 (Global Sensitivity Analysis, GSA) 来识别哪些变量对电池性能影响最大 。您将通过实现 Sobol 方法，来量化放电容量对电极厚度、孔隙率和颗粒尺寸的敏感性，从而为设计重点的确定和优化问题的简化提供宝贵的见解。",
            "id": "3894860",
            "problem": "构建一个完整的程序，用于计算单层锂离子电池的 $3\\mathrm{C}$ 放电容量相对于四个设计变量（负极厚度 $L_n$（单位：$\\mathrm{m}$）、正极厚度 $L_p$（单位：$\\mathrm{m}$）、负极孔隙率 $\\epsilon_n$（无量纲）和负极颗粒半径 $R_{p,n}$（单位：$\\mathrm{m}$））的一阶 Sobol 灵敏度指数。该程序必须实现一个基于基本传输和存储原理的物理信息代理模型，并且必须使用基于加扰 Sobol 低差异序列构建的 Saltelli 类型采样方案来估计这些指数。对于每个测试用例，最终输出必须报告四个一阶 Sobol 指数以及主导变量的索引。主导变量索引必须是与最大一阶指数对应的整数，映射关系为 $0 \\rightarrow L_n$、$1 \\rightarrow L_p$、$2 \\rightarrow \\epsilon_n$、$3 \\rightarrow R_{p,n}$。\n\n基于第一性原理的模型规范：设理论面容量受两个电极理论负载量中的较小值限制，这与电荷平衡一致。将理论面容量 $Q_{\\mathrm{theor}}$（单位为$\\mathrm{任意单位}$）定义为\n$$\nQ_{\\mathrm{theor}}(L_n,L_p,\\epsilon_n) = \\min\\left(\\rho_n (1-\\epsilon_n) L_n,\\ \\rho_p (1-\\epsilon_p) L_p\\right),\n$$\n其中 $\\rho_n$ 和 $\\rho_p$ 是有效体积存储系数，单位为 $\\mathrm{任意单位/m^3}$，$\\epsilon_p$ 是正极孔隙率（无量纲）。设 $3\\mathrm{C}$ 放电下的利用率因子由一个传输损耗因子表示，该因子对离子和固态扩散阻力施加惩罚：\n$$\nU(L_n,L_p,\\epsilon_n,R_{p,n}) = \\frac{1}{1 + \\phi_{\\mathrm{ion}}(L_n,L_p,\\epsilon_n) + \\phi_{\\mathrm{solid}}(R_{p,n})},\n$$\n其中\n$$\n\\phi_{\\mathrm{ion}}(L_n,L_p,\\epsilon_n) = c_i\\left(\\frac{L_n}{\\epsilon_n^{b}} + \\frac{L_p}{\\epsilon_p^{b}}\\right), \\quad \\phi_{\\mathrm{solid}}(R_{p,n}) = c_s R_{p,n}^2,\n$$\n其中 $b$ 是 Bruggeman 指数（无量纲），$c_i$ 是离子损耗系数（单位：$\\mathrm{m^{-1}}$），$c_s$ 是固体扩散损耗系数（单位：$\\mathrm{m^{-2}}$）。于是，$3\\mathrm{C}$ 面容量（单位为 $\\mathrm{任意单位}$）为\n$$\nQ_{3\\mathrm{C}}(L_n,L_p,\\epsilon_n,R_{p,n}) = Q_{\\mathrm{theor}}(L_n,L_p,\\epsilon_n)\\cdot U(L_n,L_p,\\epsilon_n,R_{p,n}).\n$$\n所有变量和参数必须取科学上合理的值，并且必须直接使用上述函数形式，不得改动。\n\n采样方案与 Sobol 指数估计器：使用两个独立的加扰 Sobol 序列来构建矩阵 $A \\in [0,1]^{{N}\\times 4}$ 和 $B \\in [0,1]^{{N}\\times 4}$，其中 $N = 2^m$，$m$ 为指定的整数且 $m \\ge 1$。使用仿射变换将 $A$ 和 $B$ 的每一列映射到相应的物理输入范围。对于每个输入 $i \\in \\{1,2,3,4\\}$，通过将 $A$ 的第 $i$ 列替换为 $B$ 的第 $i$ 列来构建 $A_{B}^{(i)}$。令 $f(\\cdot)$ 表示 $Q_{3\\mathrm{C}}(\\cdot)$。使用 $f(A)$ 的无偏样本方差来估计方差，并使用 Saltelli 估计器计算一阶 Sobol 指数：\n$$\nS_i \\approx \\frac{\\frac{1}{N}\\sum_{j=1}^{N} f(B_j)\\left[f\\!\\left((A_{B}^{(i)})_j\\right)-f(A_j)\\right]}{\\operatorname{Var}[f(A)]}.\n$$\n\n输入域和常量：对于所有测试用例，四个设计变量必须遵循以下输入边界：\n- $L_n \\in [4.0\\times 10^{-5}\\ \\mathrm{m},\\ 1.2\\times 10^{-4}\\ \\mathrm{m}]$,\n- $L_p \\in [5.0\\times 10^{-5}\\ \\mathrm{m},\\ 1.0\\times 10^{-4}\\ \\mathrm{m}]$,\n- $\\epsilon_n \\in [0.25,\\ 0.50]$,\n- $R_{p,n} \\in [1.0\\times 10^{-6}\\ \\mathrm{m},\\ 6.0\\times 10^{-6}\\ \\mathrm{m}]$.\n\n除非测试用例中另有说明，否则使用以下常量：$b = 1.5$，$\\epsilon_p = 0.35$，$\\rho_n = 1.0\\times 10^{6}$，$\\rho_p = 1.0\\times 10^{6}$，$c_i = 1.0\\times 10^{4}\\ \\mathrm{m^{-1}}$ 以及 $c_s = 1.0\\times 10^{10}\\ \\mathrm{m^{-2}}$。\n\n角度单位不适用。所有容量和指数均为无量纲或使用任意一致的单位，最终报告的 Sobol 指数是无量纲的。输出中不需要进行单位转换。\n\n测试套件：您的程序必须为以下四个测试用例执行 Sobol 估计。每个测试用例都完整地指定了 $m$ 值和任何对常量的覆盖值：\n\n- 测试用例 1（基准，正常路径）：$m = 9$。使用 $b = 1.5$，$\\epsilon_p = 0.35$，$\\rho_n = 1.0\\times 10^{6}$，$\\rho_p = 1.0\\times 10^{6}$，$c_i = 1.0\\times 10^{4}$，$c_s = 1.0\\times 10^{10}$。\n\n- 测试用例 2（固态扩散松弛边界）：$m = 9$。与基准情况相同，但 $c_s = 1.0\\times 10^{8}$。\n\n- 测试用例 3（电解质传输主导）：$m = 9$。与基准情况相同，但 $c_i = 1.0\\times 10^{5}$。\n\n- 测试用例 4（阴极限制边界）：$m = 9$。与基准情况相同，但 $\\epsilon_p = 0.25$ 且 $\\rho_p = 1.2\\times 10^{6}$。\n\n随机化：为确保可复现性，对每个测试用例，请使用带有固定整数种子的加扰 Sobol 序列。使用种子 $12345$ 构建矩阵 $A$，使用种子 $67890$ 构建矩阵 $B$。请勿引入任何其他随机性。\n\n程序行为要求：对于每个测试用例，按 $[S_{L_n}, S_{L_p}, S_{\\epsilon_n}, S_{R_{p,n}}]$ 的确切顺序计算一阶 Sobol 指数向量，并确定主导变量的索引。该索引为这四个值中最大值对应的整数，映射关系为 $0 \\rightarrow L_n$、$1 \\rightarrow L_p$、$2 \\rightarrow \\epsilon_n$、$3 \\rightarrow R_{p,n}$。将所有测试用例的结果聚合到一个列表中，其中每个元素都是一个包含五个元素的列表 $[S_{L_n}, S_{L_p}, S_{\\epsilon_n}, S_{R_{p,n}}, \\mathrm{dom\\_idx}]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有结果，格式为由逗号分隔的各测试用例列表，不含空格，并用方括号括起来。例如，一个包含两个虚拟用例的有效输出应如下所示：`[[0.1,0.2,0.3,0.4,2],[...]]`。您的程序不得打印任何其他文本或字符。",
            "solution": "问题陈述被认为是有效的。它具有科学依据、提法明确、计算上可行，并提供了一套完整且一致的定义、参数和程序。该任务是使用一阶 Sobol 指数，对一个用于模拟锂离子电池高倍率放电容量的物理信息代理模型进行全局灵敏度分析。\n\n解决方案是通过实现指定的模型和灵敏度分析协议来制定的。问题的核心在于理解四个关键设计变量——负极厚度 ($L_n$)、正极厚度 ($L_p$)、负极孔隙率 ($\\epsilon_n$) 和负极颗粒半径 ($R_{p,n}$)——如何影响电芯的 $3\\mathrm{C}$ 放电容量 ($Q_{3\\mathrm{C}}$)。\n\n$Q_{3\\mathrm{C}}$ 的模型由两个部分构成：\n1. 理论面容量 $Q_{\\mathrm{theor}}(L_n,L_p,\\epsilon_n)$，代表最大可能的电荷存储量。它受限于阳极和阴极容量中的较小者，这一原则被称为电极平衡：\n$$\nQ_{\\mathrm{theor}}(L_n,L_p,\\epsilon_n) = \\min\\left(\\rho_n (1-\\epsilon_n) L_n,\\ \\rho_p (1-\\epsilon_p) L_p\\right)\n$$\n此处，$\\rho_n$ 和 $\\rho_p$ 是有效体积存储系数，而 $(1-\\epsilon)L$ 代表单位面积的活性物质体积。\n\n2. 利用率因子 $U(L_n,L_p,\\epsilon_n,R_{p,n})$，它反映了高放电倍率（$3\\mathrm{C}$）下的性能损失。这些损失源于电解液中有限的离子传输速率和固态活性材料颗粒中的锂扩散。其函数形式将这些损耗机制组合为串联电阻：\n$$\nU(L_n,L_p,\\epsilon_n,R_{p,n}) = \\frac{1}{1 + \\phi_{\\mathrm{ion}}(L_n,L_p,\\epsilon_n) + \\phi_{\\mathrm{solid}}(R_{p,n})}\n$$\n离子损耗项 $\\phi_{\\mathrm{ion}} = c_i\\left(\\frac{L_n}{\\epsilon_n^{b}} + \\frac{L_p}{\\epsilon_p^{b}}\\right)$ 随电极厚度（更长的传输路径）增加而增加，随孔隙率（更通畅的路径）增加而减小，并受 Bruggeman 指数 $b$ 的控制。固态扩散损耗项 $\\phi_{\\mathrm{solid}} = c_s R_{p,n}^2$ 随颗粒半径呈二次方增长，反映了锂扩散进出更大颗粒需要更长的时间。\n\n最终的容量模型是这两个部分的乘积：\n$$\nQ_{3\\mathrm{C}}(L_n,L_p,\\epsilon_n,R_{p,n}) = Q_{\\mathrm{theor}} \\cdot U\n$$\n\n为了量化每个设计变量对 $Q_{3\\mathrm{C}}$ 的影响，我们进行 Sobol 灵敏度分析。该方法将模型输出的总方差分解为来自每个输入变量的贡献（一阶效应）及其相互作用的贡献（高阶效应）。一阶 Sobol 指数 $S_i$ 用于衡量仅由第 $i$ 个输入变量单独贡献的方差占总输出方差的比例。\n\n计算过程遵循 Saltelli 采样方法，该方法对于估算 Sobol 指数非常高效。实现步骤如下：\n\n1.  **准随机采样**：生成两个独立的、加扰的 Sobol 低差异序列，以创建样本矩阵 $A$ 和 $B$，大小均为 $N \\times 4$，其中 $N=2^m=2^9=512$，$4$ 是输入变量的数量。使用 `scipy.stats.qmc.Sobol` 引擎并设置固定种子（$A$ 用 $12345$，$B$ 用 $67890$）以确保可复现性。这些矩阵包含在单位超立方体 $[0,1]^4$ 中均匀分布的样本。\n\n2.  **输入空间映射**：使用对每个变量 $X_i$ 的仿射变换，将 $A$ 和 $B$ 中的样本从单位超立方体映射到设计变量的物理域：\n    $$\n    X_i = X_{i, \\min} + (X_{i, \\max} - X_{i, \\min}) \\cdot U_i\n    $$\n    其中 $U_i$ 是来自单位超立方体的样本，$[X_{i, \\min}, X_{i, \\max}]$ 是该变量的指定边界。\n\n3.  **模型评估**：对每个样本点评估 $Q_{3\\mathrm{C}}$ 模型。这将产生三组模型输出：$f(A)$、$f(B)$ 以及对于每个输入变量 $i$ 的 $f(A_B^{(i)})$。矩阵 $A_B^{(i)}$ 的构造方法是取矩阵 $A$ 并将其第 $i$ 列替换为矩阵 $B$ 的相应列。每个测试用例总共执行 $N \\times (D+2) = 512 \\times (4+2) = 3072$ 次模型评估。\n\n4.  **Sobol 指数估计**：使用指定的 Saltelli 估计器计算一阶 Sobol 指数：\n    $$\n    S_i \\approx \\frac{\\frac{1}{N}\\sum_{j=1}^{N} f(B_j)\\left[f\\!\\left((A_{B}^{(i)})_j\\right)-f(A_j)\\right]}{\\operatorname{Var}[f(A)]}\n    $$\n    分母 $\\operatorname{Var}[f(A)]$ 是来自矩阵 $A$ 的模型输出的无偏样本方差，计算时使用 $1$ 的自由度差（delta degree of freedom）。\n\n5.  **主导变量识别**：对于每个测试用例，比较计算出的四个一阶指数 $[S_{L_n}, S_{L_p}, S_{\\epsilon_n}, S_{R_{p,n}}]$。其中最大值的索引（从 $0$ 到 $3$）被确定为主导变量索引。\n\n对四个测试用例中的每一个都执行此完整过程，这些测试用例系统地改变模型的常量参数（$c_s$、$c_i$、$\\epsilon_p$、$\\rho_p$），以探索电池运行的不同物理机制（例如，固态扩散限制与电解质传输限制）。最终输出将所有案例的结果聚合为指定的列表格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import qmc\nimport json\n\ndef solve():\n    \"\"\"\n    Computes first-order Sobol sensitivity indices for a Li-ion battery model\n    across four test cases, adhering to the specified problem statement.\n    \"\"\"\n\n    # Define input variable bounds\n    bounds = np.array([\n        [4.0e-5, 1.2e-4],  # L_n [m]\n        [5.0e-5, 1.0e-4],  # L_p [m]\n        [0.25, 0.50],      # epsilon_n [-]\n        [1.0e-6, 6.0e-6]   # R_p,n [m]\n    ])\n\n    test_cases = [\n        # Case 1: Baseline\n        {'m': 9, 'b': 1.5, 'epsilon_p': 0.35, 'rho_n': 1.0e6, 'rho_p': 1.0e6, 'c_i': 1.0e4, 'c_s': 1.0e10},\n        # Case 2: Solid-diffusion-relaxed\n        {'m': 9, 'b': 1.5, 'epsilon_p': 0.35, 'rho_n': 1.0e6, 'rho_p': 1.0e6, 'c_i': 1.0e4, 'c_s': 1.0e8},\n        # Case 3: Electrolyte-transport-dominant\n        {'m': 9, 'b': 1.5, 'epsilon_p': 0.35, 'rho_n': 1.0e6, 'rho_p': 1.0e6, 'c_i': 1.0e5, 'c_s': 1.0e10},\n        # Case 4: Cathode-limited\n        {'m': 9, 'b': 1.5, 'epsilon_p': 0.25, 'rho_n': 1.0e6, 'rho_p': 1.2e6, 'c_i': 1.0e4, 'c_s': 1.0e10},\n    ]\n\n    all_results = []\n\n    for case_params in test_cases:\n        m = case_params['m']\n        N = 2**m\n        D = 4\n\n        # Generate scrambled Sobol sequences for matrices A and B\n        sampler_A = qmc.Sobol(d=D, scramble=True, seed=12345)\n        sampler_B = qmc.Sobol(d=D, scramble=True, seed=67890)\n        \n        A_unit = sampler_A.random(n=N)\n        B_unit = sampler_B.random(n=N)\n\n        # Scale samples from unit hypercube to physical domain\n        lower_bounds = bounds[:, 0]\n        upper_bounds = bounds[:, 1]\n        \n        A_physical = qmc.scale(A_unit, lower_bounds, upper_bounds)\n        B_physical = qmc.scale(B_unit, lower_bounds, upper_bounds)\n\n        # Physics-informed surrogate model\n        def Q_3C(variables, params):\n            L_n, L_p, epsilon_n, R_p_n = variables[:, 0], variables[:, 1], variables[:, 2], variables[:, 3]\n            \n            # Unpack parameters\n            b = params['b']\n            epsilon_p = params['epsilon_p']\n            rho_n = params['rho_n']\n            rho_p = params['rho_p']\n            c_i = params['c_i']\n            c_s = params['c_s']\n            \n            # Theoretical areal capacity\n            Q_theor_n = rho_n * (1 - epsilon_n) * L_n\n            Q_theor_p = rho_p * (1 - epsilon_p) * L_p\n            Q_theor = np.minimum(Q_theor_n, Q_theor_p)\n\n            # Transport loss terms\n            phi_ion = c_i * (L_n / (epsilon_n**b) + L_p / (epsilon_p**b))\n            phi_solid = c_s * R_p_n**2\n\n            # Utilization factor\n            U = 1.0 / (1.0 + phi_ion + phi_solid)\n\n            return Q_theor * U\n\n        # Evaluate the model for sample matrices\n        y_A = Q_3C(A_physical, case_params)\n        y_B = Q_3C(B_physical, case_params)\n\n        # Estimate the variance of the output, as specified\n        var_y_A = np.var(y_A, ddof=1)\n\n        sobol_indices = []\n        for i in range(D):\n            # Create the A_B^(i) matrix\n            A_B_i_physical = np.copy(A_physical)\n            A_B_i_physical[:, i] = B_physical[:, i]\n\n            # Evaluate model on A_B^(i)\n            y_A_B_i = Q_3C(A_B_i_physical, case_params)\n\n            # Calculate the numerator of the S_i estimator\n            numerator = np.mean(y_B * (y_A_B_i - y_A))\n\n            # Calculate the first-order Sobol index\n            s_i = numerator / var_y_A\n            sobol_indices.append(s_i)\n        \n        # Find the index of the dominant variable\n        dominant_index = int(np.argmax(sobol_indices))\n        \n        # Aggregate results for case\n        case_result = sobol_indices + [dominant_index]\n        all_results.append(case_result)\n\n\n    # Final print statement in the exact required format\n    # Use json.dumps for compact, space-free list formatting\n    print(json.dumps(all_results, separators=(',', ':')))\n\nsolve()\n```"
        }
    ]
}