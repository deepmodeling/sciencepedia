{
    "hands_on_practices": [
        {
            "introduction": "Accurate battery models are built upon a solid foundation of physical properties, and a critical parameter is the electrolyte's ionic conductivity. This first exercise starts from the fundamental Nernst-Planck flux to derive the relationship between microscopic ion mobilities and the macroscopic conductivity, a key link in multiscale modeling. By applying this derivation, you will see how non-ideal effects in Li-S chemistries, such as incomplete salt dissociation and ion pairing, can be quantified by comparing theoretical predictions with experimental measurements .",
            "id": "3929806",
            "problem": "A Lithium–Sulfur (Li–S) flow catholyte is prepared as a single-salt solution of dissolved $\\text{Li}_2\\text{S}_6$ in an aprotic ether solvent at temperature $T=298\\ \\mathrm{K}$. The analytical concentration of $\\text{Li}_2\\text{S}_6$ is $c_0 = 0.50\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}$. In the electrolyte, $\\text{Li}_2\\text{S}_6$ undergoes dissociation according to $\\text{Li}_2\\text{S}_6 \\rightleftharpoons 2\\,\\text{Li}^+ + \\text{S}_6^{2-}$. Let $\\alpha \\in [0,1]$ denote the degree of dissociation (the fraction of $\\text{Li}_2\\text{S}_6$ units that are dissociated into free ions). Assume there is no supporting salt, no convection, spatial homogeneity, and local electroneutrality. The electrophoretic mobilities (as defined in the Nernst–Planck flux with $D_i = u_i R T$) at $T=298\\ \\mathrm{K}$ are $u_{\\text{Li}^+} = 1.60 \\times 10^{-13}$ and $u_{\\text{S}_6^{2-}} = 0.60 \\times 10^{-13}$, and the absolute value of the charge of each species is given by its valence $z_i$ times the Faraday constant $F = 96485\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$. A bulk conductivity measurement at $T=298\\ \\mathrm{K}$ yields a value of $\\kappa_{\\mathrm{meas}} = 1.564\\ \\mathrm{S}\\ \\mathrm{m}^{-1}$.\n\nStarting only from the Nernst–Planck flux definition for each species, the Einstein relation connecting diffusivity and mobility, the definition of current density from ionic fluxes, and Ohm’s law relating current density to the electric field, derive the expression for the electrolyte’s bulk conductivity $\\kappa$ in terms of $\\{z_i,u_i,c_i\\}$. Then, using the stated assumptions, express the species concentrations $\\{c_i\\}$ in terms of $c_0$ and $\\alpha$, compute the fully dissociated conductivity (i.e., at $\\alpha=1$), and use the measured conductivity to infer the numerical value of the dissociation fraction $\\alpha$. \n\nReport the final inferred $\\alpha$ as a unitless decimal rounded to four significant figures. If you compute any intermediate conductivity values, express them in $\\mathrm{S}\\ \\mathrm{m}^{-1}$. Use the conversion $1\\ \\mathrm{mol}\\ \\mathrm{L}^{-1} = 1000\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$.",
            "solution": "The starting point is the Nernst–Planck flux for species $i$ in an isothermal, homogeneous solution without convection:\n$$\n\\mathbf{N}_i = -D_i \\nabla c_i - z_i u_i F c_i \\nabla \\phi,\n$$\nwhere $D_i$ is the diffusivity, $u_i$ is the electrophoretic mobility as defined via the migration term, $z_i$ is the valence, $F$ is the Faraday constant, and $\\phi$ is the electric potential. The Einstein relation connects $D_i$ and $u_i$ as\n$$\nD_i = u_i R T,\n$$\nwith $R$ the gas constant and $T$ the absolute temperature.\n\nUnder the stated conditions of spatial homogeneity (bulk, no concentration gradients), $\\nabla c_i = \\mathbf{0}$, so the flux is purely migrational:\n$$\n\\mathbf{N}_i = - z_i u_i F c_i \\nabla \\phi.\n$$\nThe current density $\\mathbf{J}$ is given by the sum over species of charge transported by each flux,\n$$\n\\mathbf{J} = F \\sum_i z_i \\mathbf{N}_i = F \\sum_i z_i \\left(- z_i u_i F c_i \\nabla \\phi \\right) = - F^2 \\sum_i z_i^2 u_i c_i \\nabla \\phi.\n$$\nOhm’s law relates the current density to the electric field $\\mathbf{E} = - \\nabla \\phi$:\n$$\n\\mathbf{J} = \\kappa \\mathbf{E} = - \\kappa \\nabla \\phi.\n$$\nMatching the two expressions for $\\mathbf{J}$, we identify the bulk conductivity as\n$$\n\\kappa = F^2 \\sum_i z_i^2 u_i c_i.\n$$\n\nFor the $\\text{Li}_2\\text{S}_6$ dissociation equilibrium $\\text{Li}_2\\text{S}_6 \\rightleftharpoons 2\\,\\text{Li}^+ + \\text{S}_6^{2-}$, if a fraction $\\alpha$ of the analytical concentration $c_0$ is dissociated, the bulk concentrations of the charged species are\n$$\nc_{\\text{Li}^+} = 2 \\alpha c_0,\\qquad c_{\\text{S}_6^{2-}} = \\alpha c_0.\n$$\nThe valences are $z_{\\text{Li}^+} = +1$ and $z_{\\text{S}_6^{2-}} = -2$. Because $\\kappa$ depends on $z_i^2$, the sign of $z_i$ does not affect the magnitude of each contribution. Hence,\n$$\n\\kappa(\\alpha) = F^2 \\left[z_{\\text{Li}^+}^2 u_{\\text{Li}^+} c_{\\text{Li}^+} + z_{\\text{S}_6^{2-}}^2 u_{\\text{S}_6^{2-}} c_{\\text{S}_6^{2-}}\\right] \n= F^2 \\left[(1)^2 u_{\\text{Li}^+} \\cdot (2 \\alpha c_0) + (-2)^2 u_{\\text{S}_6^{2-}} \\cdot (\\alpha c_0)\\right].\n$$\nFactor out $\\alpha$:\n$$\n\\kappa(\\alpha) = \\alpha F^2 \\left[2 u_{\\text{Li}^+} c_0 + 4 u_{\\text{S}_6^{2-}} c_0\\right].\n$$\nDefine the fully dissociated conductivity as $\\kappa_{\\mathrm{full}} \\equiv \\kappa(\\alpha=1)$:\n$$\n\\kappa_{\\mathrm{full}} = F^2 \\left[2 u_{\\text{Li}^+} c_0 + 4 u_{\\text{S}_6^{2-}} c_0\\right].\n$$\nWith $c_0 = 0.50\\ \\mathrm{mol}\\ \\mathrm{L}^{-1} = 500\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$, $u_{\\text{Li}^+} = 1.60 \\times 10^{-13}$, $u_{\\text{S}_6^{2-}} = 0.60 \\times 10^{-13}$, and $F = 96485\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$, compute the bracketed factor:\n$$\n2 u_{\\text{Li}^+} c_0 + 4 u_{\\text{S}_6^{2-}} c_0 = 2\\,(1.60 \\times 10^{-13})\\,(500) + 4\\,(0.60 \\times 10^{-13})\\,(500).\n$$\nEvaluate each term:\n$$\n2\\,(1.60 \\times 10^{-13})\\,(500) = (3.20 \\times 10^{-13})\\,(500) = 1.60 \\times 10^{-10},\n$$\n$$\n4\\,(0.60 \\times 10^{-13})\\,(500) = (2.40 \\times 10^{-13})\\,(500) = 1.20 \\times 10^{-10}.\n$$\nSum:\n$$\n1.60 \\times 10^{-10} + 1.20 \\times 10^{-10} = 2.80 \\times 10^{-10}.\n$$\nNow compute\n$$\n\\kappa_{\\mathrm{full}} = F^2 \\times 2.80 \\times 10^{-10},\\quad F^2 = (96485)^2 = 9{,}309{,}355{,}225.\n$$\nThus,\n$$\n\\kappa_{\\mathrm{full}} = 9.309355225 \\times 10^{9} \\times 2.80 \\times 10^{-10} = 2.606619463\\ \\mathrm{S}\\ \\mathrm{m}^{-1}.\n$$\nAssuming ideal behavior of the mobilities with respect to dissociation (i.e., neutral, undissociated $\\text{Li}_2\\text{S}_6$ pairs do not contribute to conductivity and the mobilities of the charged species are unchanged), the measured conductivity relates linearly to $\\alpha$:\n$$\n\\kappa_{\\mathrm{meas}} = \\alpha\\, \\kappa_{\\mathrm{full}} \\quad \\Longrightarrow \\quad \\alpha = \\frac{\\kappa_{\\mathrm{meas}}}{\\kappa_{\\mathrm{full}}}.\n$$\nInsert the measured value $\\kappa_{\\mathrm{meas}} = 1.564\\ \\mathrm{S}\\ \\mathrm{m}^{-1}$:\n$$\n\\alpha = \\frac{1.564}{2.606619463} \\approx 0.60001086.\n$$\nRounded to four significant figures, the inferred dissociation fraction is\n$$\n\\alpha = 0.6000.\n$$\nThis implies that a fraction $1 - \\alpha \\approx 0.4000$ of $\\text{Li}_2\\text{S}_6$ remains as neutral, non-conductive ion pairs (or higher aggregates) under the stated conditions, a level of ion association consistent with reduced conductivity relative to the fully dissociated prediction.",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "Building on bulk properties, we now turn to the complex environment of the porous electrode, where the solid matrix impedes ion transport. This practice guides you through the derivation of an effective diffusion coefficient, $D_{\\text{eff}}$, which accounts for the geometric constraints of porosity and tortuosity. By implementing a standard Bruggeman model and performing a sensitivity analysis, you will gain practical skills in parameterizing porous electrode models and identifying which microstructural features most critically impact species transport .",
            "id": "3929838",
            "problem": "Consider a porous cathode in a Lithium-Sulfur (Li-S) battery where the charge-carrying species of interest is the tetrathiolate anion $\\text{S}_4^{2-}$ dissolved in the liquid electrolyte phase occupying the pore space. At the microscopic scale, transport of $\\text{S}_4^{2-}$ within the electrolyte obeys Fick’s first law in the electrolyte-filled domain: the local molar flux $\\mathbf{J}$ satisfies $\\mathbf{J} = - D \\nabla c$, where $D$ is the tracer diffusion coefficient of $\\text{S}_4^{2-}$ in the bulk electrolyte and $c$ is the local molar concentration. In a homogenized, one-dimensional (1D), steady-state, isotropic porous medium of thickness $L$ with porosity $\\epsilon \\in (0,1)$ and a geometric tortuosity factor $\\psi \\ge 1$ (defined as the ratio of the average path length through the pore phase to the straight length $L$), the macroscale flux $\\bar{J}$ is related to a macroscale concentration gradient $dc/dx$ by an effective constitutive relation $\\bar{J} = - D_{\\text{eff}} \\, dc/dx$. \n\nStarting from these fundamental definitions and laws, and using only physical reasoning based on:\n- geometric area restriction due to porosity, and \n- path length stretching due to tortuosity, \n\nderive an expression for the effective diffusion coefficient $D_{\\text{eff}}$ as a function of $D$, $\\epsilon$, and $\\psi$ under the assumptions that: (i) diffusion occurs only in the electrolyte-filled pore space, (ii) the microstructure is statistically isotropic, and (iii) the macroscopic gradient is sufficiently small that linear response holds. Then, adopt a widely used power-law closure for the tortuosity–porosity relationship, introducing a Bruggeman-type exponent $b \\ge 1$ via a model of the form $\\psi(\\epsilon, b)$ such that $D_{\\text{eff}}$ becomes a function $D_{\\text{eff}}(D,\\epsilon,b)$ expressible as a power law in $\\epsilon$. \n\nNext, analytically compute the following sensitivity measures of $D_{\\text{eff}}(D,\\epsilon,b)$ with respect to the pore structure parameters:\n- the partial derivative with respect to porosity, $\\partial D_{\\text{eff}}/\\partial \\epsilon$,\n- the partial derivative with respect to the Bruggeman exponent, $\\partial D_{\\text{eff}}/\\partial b$,\n- the log–log sensitivity of $D_{\\text{eff}}$ to porosity, $S_{\\epsilon} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\epsilon$,\n- the logarithmic sensitivity of $D_{\\text{eff}}$ to the Bruggeman exponent, $S_{b} = \\partial \\ln D_{\\text{eff}} / \\partial b$,\n- and the log–log sensitivity of $D_{\\text{eff}}$ to the geometric tortuosity factor (at fixed $\\epsilon$), $S_{\\psi} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\psi$.\n\nAll values of $D_{\\text{eff}}$ and its dimensional derivatives must be expressed in square meters per second (m$^2$/s). All sensitivity measures $S_{\\epsilon}$, $S_{b}$, and $S_{\\psi}$ must be dimensionless.\n\nImplement your derived expressions in a program that evaluates the quantities listed above for the following test suite of physically plausible parameter sets $(D,\\epsilon,b)$:\n1. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.55, \\; 1.5)$,\n2. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.20, \\; 1.5)$,\n3. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.90, \\; 1.5)$,\n4. $(3.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.60, \\; 1.0)$,\n5. $(1.2 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.45, \\; 2.0)$.\n\nFor each test case, your program should compute and return a list containing, in this exact order:\n- $D_{\\text{eff}}$ in m$^2$/s,\n- $\\partial D_{\\text{eff}}/\\partial \\epsilon$ in m$^2$/s,\n- $\\partial D_{\\text{eff}}/\\partial b$ in m$^2$/s,\n- $S_{\\epsilon}$ (dimensionless),\n- $S_{b}$ (dimensionless),\n- $S_{\\psi}$ (dimensionless).\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of lists enclosed in square brackets, for example: \"[[case1_values],[case2_values],...]\" where each numeric entry is a real number. No additional text should be printed.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in transport phenomena within porous media, grounded in Fick's law and effective medium theory. The definitions of porosity, tortuosity, and the Bruggeman relation are standard in the field. The provided parameters are physically plausible for electrochemical systems. Therefore, the problem is valid, and a full solution is presented below.\n\nThe derivation and solution proceed in three main stages:\n1. Derivation of the general expression for the effective diffusion coefficient $D_{\\text{eff}}$ in terms of the bulk diffusion coefficient $D$, porosity $\\epsilon$, and tortuosity $\\psi$.\n2. Specialization of this expression using a Bruggeman-type model for tortuosity, leading to an expression for $D_{\\text{eff}}$ as a function of $D$, $\\epsilon$, and a Bruggeman exponent $b$.\n3. Analytical calculation of the required sensitivity measures.\n\n**1. Derivation of the Effective Diffusion Coefficient $D_{\\text{eff}}(\\boldsymbol{D}, \\boldsymbol{\\epsilon}, \\boldsymbol{\\psi})$**\n\nWe start from the local description of diffusion in the electrolyte phase, Fick's first law:\n$$\n\\mathbf{J} = -D \\nabla c\n$$\nwhere $\\mathbf{J}$ is the local molar flux, $D$ is the bulk diffusion coefficient, and $c$ is the local concentration of the species $\\text{S}_4^{2-}$.\n\nWe aim to find a macroscopic, or homogenized, version of this law that relates the macroscale flux $\\bar{J}$ to the macroscale concentration gradient $dc/dx$ in a one-dimensional porous medium of thickness $L$. The macroscopic law is given as:\n$$\n\\bar{J} = -D_{\\text{eff}} \\frac{dc}{dx}\n$$\nTo derive $D_{\\text{eff}}$, we consider the physical effects of the porous structure on the transport process, as directed by the problem statement.\n\n- **Geometric Area Restriction:** Diffusion can only occur through the pore space. For a total cross-sectional area $A$ of the porous medium, the area available for transport is the pore area, $A_{\\text{pore}} = \\epsilon A$. The macroscale flux $\\bar{J}$, defined as the total molar flow rate per total cross-sectional area, is thus reduced by a factor of $\\epsilon$ compared to the local flux within the pores.\n$$\n\\bar{J} \\propto \\epsilon\n$$\n\n- **Path Length Stretching:** The diffusion path through the tortuous pore network is longer than the straight-line thickness $L$ of the medium. The geometric tortuosity $\\psi$ is defined as the ratio of the average path length, $L_{\\text{path}}$, to the straight-line length, $L$.\n$$\n\\psi = \\frac{L_{\\text{path}}}{L} \\ge 1\n$$\nFor a given macroscopic concentration difference $\\Delta c$ across the thickness $L$, the macroscopic gradient has a magnitude of $\\Delta c / L$. However, the actual concentration gradient that drives diffusion along the pore path is experienced over the length $L_{\\text{path}}$. Assuming a linear profile along the path, this local gradient magnitude is $g_{\\text{local}} = \\Delta c / L_{\\text{path}}$. We can express this in terms of the macroscopic gradient magnitude $g_{\\text{macro}} = \\Delta c / L$:\n$$\ng_{\\text{local}} = \\frac{\\Delta c}{\\psi L} = \\frac{1}{\\psi} g_{\\text{macro}}\n$$\nThe local flux magnitude along the path is therefore $J_{\\text{path}} = D g_{\\text{local}} = D \\frac{g_{\\text{macro}}}{\\psi}$. The flux is reduced by a factor of $\\psi$ due to tortuosity.\n\nCombining these two effects: the total molar flow rate (moles per time) through the medium is the local flux density multiplied by the pore area:\n$$\n\\text{Flow Rate} = J_{\\text{path}} \\times A_{\\text{pore}} = \\left(D \\frac{g_{\\text{macro}}}{\\psi}\\right) \\times (\\epsilon A)\n$$\nThe macroscopic flux $\\bar{J}$ is the flow rate per total area $A$:\n$$\n\\bar{J} = \\frac{\\text{Flow Rate}}{A} = \\frac{1}{A} \\left(D\\frac{\\epsilon}{\\psi} g_{\\text{macro}} A\\right) = D \\frac{\\epsilon}{\\psi} g_{\\text{macro}}\n$$\nReplacing $g_{\\text{macro}}$ with the gradient $dc/dx$ (and reintroducing the sign convention), we have:\n$$\n\\bar{J} = -D \\frac{\\epsilon}{\\psi} \\frac{dc}{dx}\n$$\nComparing this with the definition $\\bar{J} = -D_{\\text{eff}} \\frac{dc}{dx}$, we arrive at the expression for the effective diffusion coefficient:\n$$\nD_{\\text{eff}} = D \\frac{\\epsilon}{\\psi}\n$$\n\n**2. Introduction of the Bruggeman Model**\n\nThe problem requires adopting a power-law closure for the tortuosity-porosity relationship of the form $\\psi(\\epsilon, b)$ such that $D_{\\text{eff}}$ becomes a power law in $\\epsilon$. The most common model of this type is the Bruggeman relation, which posits that $D_{\\text{eff}}$ is directly proportional to a power of the porosity:\n$$\nD_{\\text{eff}}(D, \\epsilon, b) = D \\epsilon^b\n$$\nHere, $b$ is the Bruggeman exponent. To ensure this is consistent with our physically derived expression, we equate the two forms for $D_{\\text{eff}}$:\n$$\nD \\epsilon^b = D \\frac{\\epsilon}{\\psi}\n$$\nSolving for the tortuosity $\\psi$, we find the specific model for $\\psi(\\epsilon, b)$ that satisfies the problem's conditions:\n$$\n\\psi(\\epsilon, b) = \\frac{\\epsilon}{\\epsilon^b} = \\epsilon^{1-b}\n$$\nThis form is consistent with the physical constraints. Since $\\epsilon \\in (0, 1)$ and the problem specifies $b \\ge 1$, the exponent $(1-b)$ is less than or equal to zero, which ensures that $\\psi = \\epsilon^{1-b} \\ge 1$, as required for a geometric tortuosity.\n\nOur final expression for the effective diffusion coefficient is therefore:\n$$\nD_{\\text{eff}}(D, \\epsilon, b) = D \\epsilon^b\n$$\n\n**3. Calculation of Sensitivity Measures**\n\nWe now compute the required partial derivatives and logarithmic sensitivities based on the expression $D_{\\text{eff}} = D \\epsilon^b$.\n\n- **Partial derivative with respect to porosity, $\\partial D_{\\text{eff}}/\\partial \\epsilon$**:\nUsing the power rule for differentiation:\n$$\n\\frac{\\partial D_{\\text{eff}}}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} (D \\epsilon^b) = D b \\epsilon^{b-1}\n$$\n\n- **Partial derivative with respect to the Bruggeman exponent, $\\partial D_{\\text{eff}}/\\partial b$**:\nTreating $b$ as the variable and recalling that $\\frac{d}{dx} a^x = a^x \\ln a$:\n$$\n\\frac{\\partial D_{\\text{eff}}}{\\partial b} = \\frac{\\partial}{\\partial b} (D \\epsilon^b) = D \\frac{\\partial}{\\partial b} (\\epsilon^b) = D \\epsilon^b \\ln \\epsilon\n$$\nNote that since $\\epsilon  1$, $\\ln \\epsilon$ is negative, so this derivative will be negative, meaning $D_{\\text{eff}}$ decreases as $b$ increases for a fixed $\\epsilon$.\n\n- **Log–log sensitivity of $D_{\\text{eff}}$ to porosity, $S_{\\epsilon} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\epsilon$**:\nFirst, take the natural logarithm of $D_{\\text{eff}}$:\n$$\n\\ln D_{\\text{eff}} = \\ln(D \\epsilon^b) = \\ln D + b \\ln \\epsilon\n$$\nNow, differentiate with respect to $\\ln \\epsilon$:\n$$\nS_{\\epsilon} = \\frac{\\partial (\\ln D + b \\ln \\epsilon)}{\\partial \\ln \\epsilon} = b\n$$\nThis is a classic result: the log-log sensitivity of a power-law function is simply its exponent.\n\n- **Logarithmic sensitivity of $D_{\\text{eff}}$ to the Bruggeman exponent, $S_{b} = \\partial \\ln D_{\\text{eff}} / \\partial b$**:\nUsing the expression for $\\ln D_{\\text{eff}}$ from the previous step, we differentiate with respect to $b$:\n$$\nS_{b} = \\frac{\\partial (\\ln D + b \\ln \\epsilon)}{\\partial b} = \\ln \\epsilon\n$$\n\n- **Log–log sensitivity of $D_{\\text{eff}}$ to the geometric tortuosity factor, $S_{\\psi} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\psi$ (at fixed $\\epsilon$)**:\nFor this calculation, we must return to the general expression $D_{\\text{eff}} = D \\frac{\\epsilon}{\\psi}$, where $\\psi$ is treated as an independent variable (since $\\epsilon$ is held constant).\nTaking the natural logarithm:\n$$\n\\ln D_{\\text{eff}} = \\ln \\left( D \\frac{\\epsilon}{\\psi} \\right) = \\ln D + \\ln \\epsilon - \\ln \\psi\n$$\nDifferentiating with respect to $\\ln \\psi$:\n$$\nS_{\\psi} = \\frac{\\partial (\\ln D + \\ln \\epsilon - \\ln \\psi)}{\\partial \\ln \\psi} = -1\n$$\nThis result indicates a simple inverse relationship: a $1\\%$ increase in tortuosity leads to a $1\\%$ decrease in effective diffusivity, all else being equal.\n\n**Summary of Formulae for Implementation:**\n- $D_{\\text{eff}} = D \\epsilon^b$\n- $\\frac{\\partial D_{\\text{eff}}}{\\partial \\epsilon} = D b \\epsilon^{b-1}$\n- $\\frac{\\partial D_{\\text{eff}}}{\\partial b} = D \\epsilon^b \\ln \\epsilon$\n- $S_{\\epsilon} = b$\n- $S_{b} = \\ln \\epsilon$\n- $S_{\\psi} = -1$\n\nThese expressions will now be implemented to evaluate the quantities for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates effective diffusion properties in a porous medium for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (D, epsilon, b) where:\n    # D: bulk diffusion coefficient in m^2/s\n    # epsilon: porosity (dimensionless)\n    # b: Bruggeman exponent (dimensionless)\n    test_cases = [\n        (4.0e-10, 0.55, 1.5),\n        (4.0e-10, 0.20, 1.5),\n        (4.0e-10, 0.90, 1.5),\n        (3.0e-10, 0.60, 1.0),\n        (1.2e-10, 0.45, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D, epsilon, b = case\n        \n        # Based on the derived formulae:\n        # D_eff = D * epsilon^b\n        # dD_eff/d_epsilon = D * b * epsilon^(b-1)\n        # dD_eff/d_b = D * epsilon^b * ln(epsilon) = D_eff * ln(epsilon)\n        # S_epsilon = b\n        # S_b = ln(epsilon)\n        # S_psi = -1\n\n        # Calculate D_eff in m^2/s\n        d_eff = D * (epsilon ** b)\n        \n        # Calculate partial derivative wrt epsilon in m^2/s\n        d_deff_depsilon = D * b * (epsilon ** (b - 1.0))\n        \n        # Calculate partial derivative wrt Bruggeman exponent in m^2/s\n        d_deff_db = d_eff * np.log(epsilon)\n        \n        # Calculate log-log sensitivity to porosity (dimensionless)\n        s_epsilon = b\n        \n        # Calculate logarithmic sensitivity to Bruggeman exponent (dimensionless)\n        s_b = np.log(epsilon)\n        \n        # Calculate log-log sensitivity to tortuosity (dimensionless)\n        s_psi = -1.0\n        \n        # Collect the results for the current case\n        case_results = [\n            d_eff,\n            d_deff_depsilon,\n            d_deff_db,\n            s_epsilon,\n            s_b,\n            s_psi\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[-1.2, 3.4], [5.6, -7.8]]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The dynamic behavior of Li-S and metal-air batteries is governed by the interplay of transport and reaction, which often occur on vastly different timescales, creating a \"stiff\" numerical problem. This challenge can render standard explicit time-stepping schemes prohibitively slow. This hands-on exercise introduces operator splitting, a powerful technique to efficiently solve such stiff reaction-diffusion systems, requiring you to implement a solver and derive the stability conditions that ensure your simulation is both robust and efficient .",
            "id": "3929802",
            "problem": "Consider a one-dimensional porous cathode of a Lithium-Sulfur (Li-S) battery in which a single dissolved polysulfide species undergoes Fickian transport and first-order consumption due to precipitation to solid lithium sulfide. Let the spatial domain be $x \\in [0,L]$, the concentration be $c(x,t)$ in $\\mathrm{mol\\,m^{-3}}$, the diffusion coefficient be $D$ in $\\mathrm{m^2\\,s^{-1}}$, and the first-order reaction rate constant be $k$ in $\\mathrm{s^{-1}}$. The molar flux at the left boundary $x=0$ is prescribed as $J_0$ in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ (into the domain), and the right boundary at $x=L$ is no-flux. The governing equation is the mass conservation law for a reactive species, starting from the definition of molar flux by Fick’s law and a linear reaction term: $$\\frac{\\partial c}{\\partial t} = -\\frac{\\partial N}{\\partial x} + R(c), \\quad N = -D\\frac{\\partial c}{\\partial x}, \\quad R(c) = -kc.$$\nThis yields the Partial Differential Equation (PDE) $$\\frac{\\partial c}{\\partial t} = D\\frac{\\partial^2 c}{\\partial x^2} - k c,$$ with boundary conditions $$-D\\frac{\\partial c}{\\partial x}(0,t) = J_0, \\quad \\frac{\\partial c}{\\partial x}(L,t) = 0,$$ and initial condition $$c(x,0)=c_0.$$\n\nYour task is to:\n- Implement operator splitting (Lie splitting) that decomposes the evolution over one time step $\\Delta t$ into a transport subproblem and a reaction subproblem. The transport step advances $c$ under $$\\frac{\\partial c}{\\partial t} = D\\frac{\\partial^2 c}{\\partial x^2}$$ subject to the given boundary conditions, and the reaction step advances $c$ under $$\\frac{\\partial c}{\\partial t} = -k c.$$ Use a uniform grid with $N$ nodes, grid spacing $\\Delta x = L/(N-1)$, and explicit Forward Euler updates for both subproblems with second-order central differences for the spatial second derivative in the transport subproblem. Enforce the flux boundary conditions via appropriate ghost-node relations consistent with the finite difference stencil.\n- Starting from the discrete updates and treating the transport and reaction steps independently, perform a linear stability analysis for each subproblem to obtain a restriction on $\\Delta t$ in terms of $D$, $k$, and $\\Delta x$. Justify the recommended time step selection by taking the minimum of the two subproblem stability limits multiplied by a safety factor $\\sigma$ with $0  \\sigma  1$. Do not assume or use any pre-derived shortcuts; derive the stability criteria from first principles of amplification factor analysis for linear updates.\n- Simulate until a specified final time $T$ and report the final domain-averaged concentration $\\bar{c}(T)$ defined by $$\\bar{c}(T) = \\frac{1}{L}\\int_0^L c(x,T)\\,dx,$$ approximated by the arithmetic mean of the nodal concentrations. Use $\\mathrm{mol\\,m^{-3}}$ for concentrations and $\\mathrm{s}$ for time. If $T$ is not an integer multiple of $\\Delta t$, your implementation must take a final truncated time step less than or equal to $\\Delta t$ to reach $T$ without exceeding stability limits.\n\nUse the following test suite of parameter values. Each test case is a tuple $(L, D, k, J_0, c_0, N, T, \\sigma)$ with the specified units:\n- Test case $1$ (general case): $(L = 5.0\\times 10^{-5}\\,\\mathrm{m}, D = 1.0\\times 10^{-10}\\,\\mathrm{m^2\\,s^{-1}}, k = 1.0\\,\\mathrm{s^{-1}}, J_0 = 1.0\\times 10^{-5}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}, c_0 = 1.0\\,\\mathrm{mol\\,m^{-3}}, N = 101, T = 5.0\\times 10^{-1}\\,\\mathrm{s}, \\sigma = 8.0\\times 10^{-1})$.\n- Test case $2$ (stiff reaction): $(L = 5.0\\times 10^{-5}\\,\\mathrm{m}, D = 1.0\\times 10^{-10}\\,\\mathrm{m^2\\,s^{-1}}, k = 1.0\\times 10^{3}\\,\\mathrm{s^{-1}}, J_0 = 1.0\\times 10^{-5}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}, c_0 = 1.0\\,\\mathrm{mol\\,m^{-3}}, N = 101, T = 2.0\\times 10^{-1}\\,\\mathrm{s}, \\sigma = 8.0\\times 10^{-1})$.\n- Test case $3$ (coarser grid and higher diffusion): $(L = 1.0\\times 10^{-4}\\,\\mathrm{m}, D = 5.0\\times 10^{-10}\\,\\mathrm{m^2\\,s^{-1}}, k = 5.0\\times 10^{1}\\,\\mathrm{s^{-1}}, J_0 = 5.0\\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}, c_0 = 5.0\\times 10^{-1}\\,\\mathrm{mol\\,m^{-3}}, N = 21, T = 5.0\\times 10^{-1}\\,\\mathrm{s}, \\sigma = 8.0\\times 10^{-1})$.\n\nFor each test case, compute and return the following four quantities:\n- The maximum stable time step for the transport subproblem, $\\Delta t_{\\mathrm{tr,max}}$, in $\\mathrm{s}$.\n- The maximum stable time step for the reaction subproblem, $\\Delta t_{\\mathrm{rx,max}}$, in $\\mathrm{s}$.\n- The used time step, $\\Delta t_{\\mathrm{used}} = \\sigma \\cdot \\min(\\Delta t_{\\mathrm{tr,max}}, \\Delta t_{\\mathrm{rx,max}})$, in $\\mathrm{s}$.\n- The final domain-averaged concentration $\\bar{c}(T)$ in $\\mathrm{mol\\,m^{-3}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, aggregating all test cases in order, with each test case contributing the four values in the sequence indicated. The final output must be in the format $[r_{1,1},r_{1,2},r_{1,3},r_{1,4},r_{2,1},r_{2,2},r_{2,3},r_{2,4},r_{3,1},r_{3,2},r_{3,3},r_{3,4}]$, where each $r_{i,j}$ is a floating-point number in the specified units.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of transport phenomena and chemical kinetics, mathematically well-posed as a linear parabolic partial differential equation with defined initial and boundary conditions, and is objective and complete. It presents a standard, albeit non-trivial, problem in computational science, requiring the derivation of stability criteria from first principles and the implementation of a numerical scheme. We now proceed with the solution.\n\nThe core of the problem is to solve the one-dimensional reaction-diffusion equation for the concentration $c(x,t)$ of a polysulfide species in a porous cathode:\n$$\n\\frac{\\partial c}{\\partial t} = D\\frac{\\partial^2 c}{\\partial x^2} - k c\n$$\nThe solution is developed using an operator splitting (Lie splitting) scheme, which decomposes the equation into a pure transport (diffusion) part and a pure reaction part.\n\n**1. Discretization and Operator Splitting**\n\nWe discretize the spatial domain $x \\in [0, L]$ using a uniform grid with $N$ nodes, indexed by $i = 0, 1, \\dots, N-1$. The grid points are located at $x_i = i \\Delta x$, where the grid spacing is $\\Delta x = L/(N-1)$. The concentration at grid point $x_i$ and time $t_n$ is denoted by $c_i^n \\approx c(x_i, t_n)$.\n\nThe operator splitting scheme approximates the evolution over a single time step $\\Delta t$ by sequentially solving two simpler problems. The update from $c^n$ to $c^{n+1}$ is performed as a composition of two operators: a transport operator $\\mathcal{L}_{\\mathrm{tr}}$ and a reaction operator $\\mathcal{L}_{\\mathrm{rx}}$.\n$$\nc^{n+1} = \\mathcal{L}_{\\mathrm{rx}}(\\Delta t) \\mathcal{L}_{\\mathrm{tr}}(\\Delta t) c^n\n$$\nThis is implemented in two steps:\n1.  **Transport Step**: Solve $\\frac{\\partial c}{\\partial t} = D\\frac{\\partial^2 c}{\\partial x^2}$ for a duration $\\Delta t$, starting from $c^n$. Let the result be $c^*$.\n    $$c^* = \\mathcal{L}_{\\mathrm{tr}}(\\Delta t) c^n$$\n2.  **Reaction Step**: Solve $\\frac{\\partial c}{\\partial t} = -k c$ for a duration $\\Delta t$, starting from the intermediate concentration $c^*$. The result is $c^{n+1}$.\n    $$c^{n+1} = \\mathcal{L}_{\\mathrm{rx}}(\\Delta t) c^*$$\n\n**2. Transport Subproblem: Discretization and Stability Analysis**\n\nThe transport subproblem is governed by the diffusion equation:\n$$\n\\frac{\\partial c}{\\partial t} = D\\frac{\\partial^2 c}{\\partial x^2}\n$$\nWe use the Forward Time, Central Space (FTCS) explicit scheme. The time derivative is approximated by a forward difference, and the spatial second derivative by a second-order central difference:\n$$\n\\frac{c_i^* - c_i^n}{\\Delta t} = D \\frac{c_{i+1}^n - 2c_i^n + c_{i-1}^n}{\\Delta x^2}\n$$\nThis yields the update rule for the interior nodes ($i=1, \\dots, N-2$):\n$$\nc_i^* = c_i^n + \\frac{D \\Delta t}{\\Delta x^2} (c_{i+1}^n - 2c_i^n + c_{i-1}^n)\n$$\nThe boundary conditions are of Neumann type. We implement them using ghost nodes, which are virtual nodes outside the physical domain, to maintain the second-order accuracy of the central difference stencil at the boundaries.\n-   At $x=0$ ($i=0$), the flux is $J_0$. Using a central difference for the gradient:\n    $$-D \\frac{c_1^n - c_{-1}^n}{2\\Delta x} = J_0 \\implies c_{-1}^n = c_1^n + \\frac{2\\Delta x J_0}{D}$$\n    Substituting this into the FTCS formula for $i=0$:\n    $$c_0^* = c_0^n + \\frac{D\\Delta t}{\\Delta x^2} (c_1^n - 2c_0^n + c_{-1}^n) = c_0^n + \\frac{D\\Delta t}{\\Delta x^2} \\left(c_1^n - 2c_0^n + c_1^n + \\frac{2\\Delta x J_0}{D}\\right)$$\n    $$c_0^* = c_0^n + \\frac{2D\\Delta t}{\\Delta x^2} (c_1^n - c_0^n) + \\frac{2\\Delta t J_0}{\\Delta x}$$\n-   At $x=L$ ($i=N-1$), the flux is zero. Using a central difference:\n    $$\\frac{\\partial c}{\\partial x}(L,t) = 0 \\implies \\frac{c_{N}^n - c_{N-2}^n}{2\\Delta x} = 0 \\implies c_{N}^n = c_{N-2}^n$$\n    Substituting this into the FTCS formula for $i=N-1$:\n    $$c_{N-1}^* = c_{N-1}^n + \\frac{D\\Delta t}{\\Delta x^2} (c_{N}^n - 2c_{N-1}^n + c_{N-2}^n) = c_{N-1}^n + \\frac{D\\Delta t}{\\Delta x^2} (c_{N-2}^n - 2c_{N-1}^n + c_{N-2}^n)$$\n    $$c_{N-1}^* = c_{N-1}^n + \\frac{2D\\Delta t}{\\Delta x^2} (c_{N-2}^n - c_{N-1}^n)$$\n\nTo perform a linear stability analysis (von Neumann analysis) for the interior nodes, we consider a single Fourier mode component of the numerical error, $c_j^n = G^n e^{i \\omega j \\Delta x}$, where $G$ is the amplification factor, $\\omega$ is the wave number, and $j$ is the spatial index. Substitution into the discretized interior equation gives:\n$$\nG^{n+1}e^{i \\omega j \\Delta x} = G^n e^{i \\omega j \\Delta x} + \\frac{D\\Delta t}{\\Delta x^2} \\left( G^n e^{i \\omega (j+1) \\Delta x} - 2G^n e^{i \\omega j \\Delta x} + G^n e^{i \\omega (j-1) \\Delta x} \\right)\n$$\nThe amplification factor $G = G^{n+1}/G^n$ is found by dividing through by $G^n e^{i \\omega j \\Delta x}$:\n$$\nG = 1 + \\frac{D\\Delta t}{\\Delta x^2} (e^{i \\omega \\Delta x} - 2 + e^{-i \\omega \\Delta x}) = 1 + \\frac{D\\Delta t}{\\Delta x^2} (2\\cos(\\omega \\Delta x) - 2)\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\nG = 1 - \\frac{4D\\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{\\omega \\Delta x}{2}\\right)\n$$\nFor stability, we require $|G| \\leq 1$. Since $D, \\Delta t, \\Delta x^2  0$, and $\\sin^2(\\cdot) \\geq 0$, $G \\leq 1$ is always satisfied. The non-trivial condition is $G \\geq -1$:\n$$\n-1 \\leq 1 - \\frac{4D\\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{\\omega \\Delta x}{2}\\right) \\implies \\frac{4D\\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{\\omega \\Delta x}{2}\\right) \\leq 2\n$$\nThe worst-case scenario occurs when $\\sin^2(\\omega\\Delta x/2) = 1$. This leads to the stability constraint:\n$$\n\\frac{4D\\Delta t}{\\Delta x^2} \\leq 2 \\implies \\Delta t \\leq \\frac{\\Delta x^2}{2D}\n$$\nTherefore, the maximum stable time step for the transport subproblem is $\\Delta t_{\\mathrm{tr,max}} = \\frac{\\Delta x^2}{2D}$.\n\n**3. Reaction Subproblem: Discretization and Stability Analysis**\n\nThe reaction subproblem is given by the ordinary differential equation (ODE) at each grid point:\n$$\n\\frac{dc_i}{dt} = -k c_i\n$$\nUsing a Forward Euler discretization:\n$$\n\\frac{c_i^{n+1} - c_i^*}{\\Delta t} = -k c_i^* \\implies c_i^{n+1} = c_i^* - k\\Delta t c_i^* = (1-k\\Delta t)c_i^*\n$$\nThe amplification factor is $G = 1 - k\\Delta t$. For stability, we require $|G| \\leq 1$, which is $-1 \\leq 1 - k\\Delta t \\leq 1$.\nSince $k0$ and $\\Delta t0$, the condition $1-k\\Delta t \\leq 1$ is always satisfied. The non-trivial condition is:\n$$\n-1 \\leq 1 - k\\Delta t \\implies k\\Delta t \\leq 2 \\implies \\Delta t \\leq \\frac{2}{k}\n$$\nThus, the maximum stable time step for the reaction subproblem is $\\Delta t_{\\mathrm{rx,max}} = \\frac{2}{k}$.\n\n**4. Simulation Algorithm**\n\nThe overall simulation proceeds as follows:\n1.  For a given test case $(L, D, k, J_0, c_0, N, T, \\sigma)$, calculate the grid spacing $\\Delta x = L/(N-1)$.\n2.  Calculate the maximum stable time steps for the transport and reaction subproblems: $\\Delta t_{\\mathrm{tr,max}} = \\frac{\\Delta x^2}{2D}$ and $\\Delta t_{\\mathrm{rx,max}} = \\frac{2}{k}$.\n3.  Determine the time step to be used in the simulation, incorporating the safety factor $\\sigma$: $\\Delta t_{\\mathrm{used}} = \\sigma \\cdot \\min(\\Delta t_{\\mathrm{tr,max}}, \\Delta t_{\\mathrm{rx,max}})$.\n4.  Initialize the concentration array $c$ of size $N$ with the initial value $c_0$, and set the current time $t=0$.\n5.  Enter a time-stepping loop that continues as long as $t  T$:\n    a. Determine the time step for the current iteration, $\\Delta t$, ensuring it does not overshoot the final time $T$: $\\Delta t = \\min(\\Delta t_{\\mathrm{used}}, T-t)$.\n    b.  **Transport Step**: Compute the intermediate concentration $c^*$ from $c$ by applying the discretized diffusion equation, including the specific update rules for the boundary nodes at $i=0$ and $i=N-1$.\n    c.  **Reaction Step**: Update $c^*$ to the new concentration $c$ by applying the discretized reaction equation.\n    d.  Increment the simulation time: $t = t + \\Delta t$.\n6.  After the loop terminates (at $t=T$), calculate the final domain-averaged concentration $\\bar{c}(T)$ as the arithmetic mean of the nodal concentrations: $\\bar{c}(T) = \\frac{1}{N}\\sum_{i=0}^{N-1} c_i(T)$.\n7.  Store the four required outputs: $\\Delta t_{\\mathrm{tr,max}}$, $\\Delta t_{\\mathrm{rx,max}}$, $\\Delta t_{\\mathrm{used}}$, and $\\bar{c}(T)$. Repeat for all test cases.\n\nThis structured approach ensures a stable and accurate numerical solution to the posed problem, respecting all a priori derived constraints.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D reaction-diffusion problem for a Li-S battery cathode\n    using operator splitting and reports stability/simulation results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, D, k, J0, c0, N, T, sigma)\n        (5.0e-5, 1.0e-10, 1.0, 1.0e-5, 1.0, 101, 0.5, 0.8),\n        (5.0e-5, 1.0e-10, 1.0e3, 1.0e-5, 1.0, 101, 0.2, 0.8),\n        (1.0e-4, 5.0e-10, 50.0, 5.0e-6, 0.5, 21, 0.5, 0.8),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L, D, k, J0, c0, N, T, sigma = case\n\n        # 1. Calculate discretization parameters and stability limits\n        dx = L / (N - 1)\n        \n        # Max stable time step for transport (diffusion)\n        dt_tr_max = dx**2 / (2 * D)\n        \n        # Max stable time step for reaction\n        dt_rx_max = 2.0 / k\n        \n        # Used time step with safety factor\n        dt_used = sigma * min(dt_tr_max, dt_rx_max)\n\n        # 2. Initialize simulation\n        c = np.full(N, c0, dtype=float)\n        t = 0.0\n\n        # 3. Main time-stepping loop\n        while t  T:\n            # Determine dt for this step, handling the final truncated step\n            dt = min(dt_used, T - t)\n\n            # --- Operator Splitting Step 1: Transport ---\n            c_star = np.copy(c)\n            # This constant is a shorthand for D * dt / dx^2\n            D_eff = D * dt / dx**2\n            \n            # Interior nodes\n            c_star[1:-1] = c[1:-1] + D_eff * (c[2:] - 2 * c[1:-1] + c[:-2])\n            \n            # Boundary node at x=0 (i=0) with flux J0\n            # c_0^* = c_0^n + (2*D*dt/dx^2)*(c_1^n - c_0^n) + (2*dt*J0/dx)\n            c_star[0] = c[0] + 2 * D_eff * (c[1] - c[0]) + 2 * dt * J0 / dx\n            \n            # Boundary node at x=L (i=N-1) with zero-flux\n            # c_{N-1}^* = c_{N-1}^n + (2*D*dt/dx^2)*(c_{N-2}^n - c_{N-1}^n)\n            c_star[-1] = c[-1] + 2 * D_eff * (c[-2] - c[-1])\n            \n            # --- Operator Splitting Step 2: Reaction ---\n            # c^{n+1} = c^* * (1 - k*dt)\n            c = c_star * (1 - k * dt)\n            \n            # Update time\n            t += dt\n\n        # 4. Calculate final domain-averaged concentration\n        c_avg_final = np.mean(c)\n\n        # 5. Store results for this case\n        all_results.extend([dt_tr_max, dt_rx_max, dt_used, c_avg_final])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}