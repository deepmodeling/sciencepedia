{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing hysteresis is to quantify its energetic impact directly from experimental data. This practice grounds the abstract concept of hysteresis in a tangible quantity—energy loss—by demonstrating how to calculate it from a measured voltage-composition ($V-c$) loop. By deriving the energy loss from fundamental electrochemical principles and comparing it to other sources of inefficiency like Joule heating, you will gain a quantitative understanding of its significance in overall battery performance .",
            "id": "3919050",
            "problem": "Consider a porous intercalation electrode for a lithium-ion battery undergoing a single-electron reaction, cycled galvanostatically between two lithium stoichiometric fractions per mole of host, denoted by the dimensionless variable $c \\in [0,1]$, where $c$ represents moles of lithium per mole of host. Assume the electrode contains exactly one mole of host formula units. The electrical work exchanged with the external circuit during infinitesimal intercalation is determined by fundamental electrochemical definitions: the electrical work increment equals the electrode potential times the charge increment, and the charge increment is related to the change in $c$ through the Faraday constant. Hysteresis in the measured voltage–composition loop arises from path-dependent metastable states in the intercalation host, and the energy dissipated per full charge–discharge cycle is the net nonconservative work over the closed loop in $(V,c)$-space.\n\nTask 1 (derivation): Starting from the fundamental definitions of electrical work and Faraday’s law, derive a general expression for the energy dissipated per cycle due to hysteresis in terms of a closed-path integral over the measured voltage–composition loop. Your derivation must explicitly connect the change in stoichiometry $c$ to the charge transferred and express the cycle energy loss solely as a functional of $V(c)$ traced along charge and discharge.\n\nTask 2 (evaluation for a measured loop): A measured Open-Circuit Voltage (OCV)–composition loop for the same electrode at temperature $T$ is parameterized as follows for the charge and discharge paths:\n- Charge path: $V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c + 0.030 + 0.010\\,c$.\n- Discharge path: $V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c - 0.030 - 0.010\\,c$.\nThe cycle traverses $c$ from $c_1 = 0.20$ to $c_2 = 0.80$ on charge and back to $c_1$ on discharge. Take the Faraday constant as $F = 96485 \\ \\mathrm{C\\,mol^{-1}}$.\n\nTask 3 (comparison to Joule and entropic heating): Under galvanostatic cycling with constant current magnitude $I = 0.20 \\ \\mathrm{A}$ and internal ohmic resistance $R = 0.050 \\ \\Omega$, compute the total Joule heating per cycle. Further, using equilibrium thermodynamics for a single-electron reaction, the reversible entropic heat per cycle at temperature $T = 298 \\ \\mathrm{K}$ is determined by the temperature dependence of the OCV along the actual (path-dependent) charge and discharge trajectories. The measured temperature coefficients on the two paths are:\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) = -0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$,\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) = -0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$.\nCompute the net reversible entropic heat over the full cycle using basic thermodynamic relations connecting reversible heat and the temperature derivative of the equilibrium potential.\n\nReport the hysteresis energy loss per cycle computed in Task 2 in kilojoules per mole. Round your answer to four significant figures and express the final energy in $\\mathrm{kJ\\,mol^{-1}}$.",
            "solution": "The problem requires a three-part analysis of energy dissipation in a porous intercalation electrode during a galvanostatic cycle. The analysis will proceed by first validating the problem statement, then performing the requested derivation and calculations.\n\n### Problem Validation\nThe problem statement has been evaluated and is determined to be **valid**. It is scientifically grounded in established principles of electrochemical thermodynamics, well-posed with a complete and consistent set of givens, and expressed in objective, formal language. There are no scientific flaws, ambiguities, or contradictions. The requested tasks are solvable using the information provided.\n\n### Task 1: Derivation of Hysteresis Energy Loss\nThe energy dissipated due to hysteresis, $E_{\\mathrm{hys}}$, is the net nonconservative work done on the electrochemical cell over a closed charge-discharge cycle. The infinitesimal electrical work, $dW_{\\mathrm{e}}$, done on the system when an infinitesimal charge, $dQ$, is transferred at an electrode potential $V$ is given by:\n$$dW_{\\mathrm{e}} = V \\, dQ$$\nThe problem considers a single-electron reaction ($z=1$) for the intercalation of lithium. The dimensionless variable $c$ represents the moles of lithium per mole of host material. Since the electrode is stated to contain exactly one mole of host, the total charge $Q$ passed is directly proportional to the change in lithium stoichiometry $c$. The relationship is given by Faraday's law:\n$$Q = z c F$$\nFor a single-electron reaction ($z=1$) and one mole of host, this simplifies to:\n$$Q = cF$$\nwhere $F$ is the Faraday constant. The infinitesimal change in charge, $dQ$, is therefore related to the infinitesimal change in stoichiometry, $dc$, by:\n$$dQ = F \\, dc$$\nSubstituting this expression for $dQ$ into the equation for electrical work gives the work done over an infinitesimal change in stoichiometry:\n$$dW_{\\mathrm{e}} = V(c) F \\, dc$$\nThe total energy dissipated over a full cycle is the net work done on the system, which is the closed-path integral of $dW_{\\mathrm{e}}$ over the cycle:\n$$E_{\\mathrm{hys}} = W_{\\mathrm{net}} = \\oint dW_{\\mathrm{e}} = \\oint F V(c) \\, dc$$\nThis closed-path integral can be written as the sum of the integral along the charging path (from $c_1$ to $c_2$) and the integral along the discharging path (from $c_2$ to $c_1$):\n$$E_{\\mathrm{hys}} = \\int_{c_1}^{c_2} F V_{\\mathrm{ch}}(c) \\, dc + \\int_{c_2}^{c_1} F V_{\\mathrm{dis}}(c) \\, dc$$\nBy reversing the limits of the second integral, we introduce a negative sign:\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} V_{\\mathrm{ch}}(c) \\, dc - F \\int_{c_1}^{c_2} V_{\\mathrm{dis}}(c) \\, dc$$\nThis combines into the final general expression for the hysteresis energy loss per cycle:\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} \\left[V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)\\right] \\, dc$$\nThis expression represents the energy dissipated as heat due to thermodynamic irreversibility within the electrode material, captured by the area enclosed by the voltage-composition loop.\n\n### Task 2: Evaluation of Hysteresis Energy for a Measured Loop\nThe problem provides parameterized expressions for the voltage on the charge and discharge paths, $V_{\\mathrm{ch}}(c)$ and $V_{\\mathrm{dis}}(c)$.\nFirst, we simplify the given expressions:\nFor the charge path:\n$$V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c + 0.030 + 0.010\\,c = 3.830 + 0.030\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\nFor the discharge path:\n$$V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c - 0.030 - 0.010\\,c = 3.770 + 0.010\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\nThe difference in potential, $V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)$, is the integrand required for the energy calculation. The logarithmic terms cancel out:\n$$V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c) = \\left(3.830 + 0.030\\,c\\right) - \\left(3.770 + 0.010\\,c\\right) = 0.060 + 0.020\\,c$$\nNow, we integrate this expression from $c_1 = 0.20$ to $c_2 = 0.80$:\n$$E_{\\mathrm{hys}} = F \\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc$$\nPerforming the integration:\n$$\\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc = \\left[ 0.060\\,c + 0.020\\,\\frac{c^2}{2} \\right]_{0.20}^{0.80} = \\left[ 0.060\\,c + 0.010\\,c^2 \\right]_{0.20}^{0.80}$$\nEvaluating at the limits of integration:\n$$= \\left( 0.060(0.80) + 0.010(0.80)^2 \\right) - \\left( 0.060(0.20) + 0.010(0.20)^2 \\right)$$\n$$= \\left( 0.048 + 0.010(0.64) \\right) - \\left( 0.012 + 0.010(0.04) \\right)$$\n$$= \\left( 0.048 + 0.0064 \\right) - \\left( 0.012 + 0.0004 \\right)$$\n$$= 0.0544 - 0.0124 = 0.0420$$\nThe integral has units of volts ($V$). The total energy is found by multiplying by the Faraday constant, $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$:\n$$E_{\\mathrm{hys}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (0.0420 \\, \\mathrm{V}) = 4052.37 \\, \\mathrm{J\\,mol^{-1}}$$\nThe problem asks for the result in kilojoules per mole ($\\mathrm{kJ\\,mol^{-1}}$), rounded to four significant figures:\n$$E_{\\mathrm{hys}} = 4.05237 \\, \\mathrm{kJ\\,mol^{-1}} \\approx 4.052 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n### Task 3: Comparison to Joule and Entropic Heating\nFor completeness, we compute the other sources of heat generation mentioned.\n\n**Joule Heating ($Q_{\\mathrm{Joule}}$)**\nJoule heating is given by $Q_{\\mathrm{Joule}} = I^2 R t_{\\mathrm{cycle}}$, where $t_{\\mathrm{cycle}}$ is the total time for one cycle. The charge transferred during the charge half-cycle (from $c_1 = 0.20$ to $c_2 = 0.80$) is $\\Delta Q = \\Delta c \\cdot F = (0.80 - 0.20)F = 0.60F$.\nThe time for the charge half-cycle is $t_{\\mathrm{ch}} = \\Delta Q / I = 0.60F / I$.\nThe total cycle time is $t_{\\mathrm{cycle}} = t_{\\mathrm{ch}} + t_{\\mathrm{dis}} = 2 \\times t_{\\mathrm{ch}} = 1.20F / I$.\nSubstituting the given values $I = 0.20 \\, \\mathrm{A}$, $R = 0.050 \\, \\Omega$, and $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$:\n$$t_{\\mathrm{cycle}} = \\frac{1.20 \\times 96485}{0.20} = 578910 \\, \\mathrm{s}$$\n$$Q_{\\mathrm{Joule}} = (0.20 \\, \\mathrm{A})^2 \\times (0.050 \\, \\Omega) \\times (578910 \\, \\mathrm{s}) = 0.04 \\times 0.050 \\times 578910 = 1157.82 \\, \\mathrm{J\\,mol^{-1}} = 1.158 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**Net Reversible Entropic Heat ($Q_{\\mathrm{rev}}$)**\nThe reversible heat generated over a path is $Q_{\\mathrm{rev}} = \\int T dS$. Using the electrochemical Maxwell relation $dS = F (\\partial U / \\partial T) dc$, the net reversible heat over the cycle is:\n$$Q_{\\mathrm{rev, cycle}} = F T \\oint \\left(\\frac{\\partial U}{\\partial T}\\right) dc = F T \\int_{c_1}^{c_2} \\left[ \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) \\right] dc$$\nThe difference in the temperature coefficients is:\n$$\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}} - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}} = (-0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}c) - (-0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}c)$$\n$$= (0.02 \\times 10^{-3}) + (0.02 \\times 10^{-3})c = 0.02 \\times 10^{-3} (1+c) \\, \\mathrm{V\\,K^{-1}}$$\nIntegrating this difference from $c_1 = 0.20$ to $c_2 = 0.80$:\n$$\\int_{0.20}^{0.80} 0.02 \\times 10^{-3} (1+c) \\, dc = 0.02 \\times 10^{-3} \\left[c + \\frac{c^2}{2}\\right]_{0.20}^{0.80}$$\n$$= 0.02 \\times 10^{-3} \\left[ \\left(0.80 + \\frac{0.80^2}{2}\\right) - \\left(0.20 + \\frac{0.20^2}{2}\\right) \\right]$$\n$$= 0.02 \\times 10^{-3} [ (0.80 + 0.32) - (0.20 + 0.02) ] = 0.02 \\times 10^{-3} [1.12 - 0.22] = 0.02 \\times 10^{-3} \\times 0.90 = 0.018 \\times 10^{-3}$$\nThe net entropic heat is then, with $T=298 \\, \\mathrm{K}$:\n$$Q_{\\mathrm{rev, cycle}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (298 \\, \\mathrm{K}) \\times (0.018 \\times 10^{-3} \\, \\mathrm{V\\,K^{-1}}) = 517.58 \\, \\mathrm{J\\,mol^{-1}} = 0.518 \\, \\mathrm{kJ\\,mol^{-1}}$$\nIn this specific cycle, the hysteresis loss ($4.052 \\, \\mathrm{kJ\\,mol^{-1}}$) is the dominant form of energy dissipation compared to Joule heating ($1.158 \\, \\mathrm{kJ\\,mol^{-1}}$) and net entropic heating ($0.518 \\, \\mathrm{kJ\\,mol^{-1}}$). The final requested answer is only the hysteresis energy loss.",
            "answer": "$$\\boxed{4.052}$$"
        },
        {
            "introduction": "After quantifying hysteresis, the next logical step for battery engineers is to develop predictive models that can explain its origins and forecast its behavior. This computational exercise guides you through building a model for the voltage response by combining key physical components: equilibrium thermodynamics, charge-transfer kinetics, and a specific hysteresis mechanism related to nucleation barriers . By systematically varying the nucleation parameter $\\gamma$ and observing its effect on the hysteresis loop, you will develop practical skills in using simulation to test hypotheses about the microscopic drivers of electrochemical behavior.",
            "id": "3919046",
            "problem": "Consider an intercalation electrode undergoing galvanostatic cycling between two filling fractions. You are asked to design and implement a computational experiment to test the nucleation-controlled hysteresis hypothesis by varying a nucleation barrier parameter and measuring the resulting change in hysteresis area. The experiment must be grounded in first principles and well-tested models from electrochemical thermodynamics and kinetics.\n\nYou will consider a single homogeneous particle model with the following ingredients:\n\n- Thermodynamics is described by a regular-solution free energy for the intercalated species with nonideal interactions. The equilibrium chemical potential is given by\n$$\n\\mu_{\\mathrm{eq}}(c) = R T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega\\,(1 - 2 c),\n$$\nwhere $c \\in (0,1)$ is the site occupancy (dimensionless), $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\Omega$ is the regular-solution interaction parameter (energy units per mole). The equilibrium open-circuit voltage relative to a reference is\n$$\nV_{\\mathrm{eq}}(c) = -\\frac{\\mu_{\\mathrm{eq}}(c)}{F},\n$$\nwhere $F$ is the Faraday constant.\n\n- Kinetics is described by symmetric Butler–Volmer (BV) charge transfer. For a given applied current density $I$ (positive for lithiation/charge, negative for delithiation/discharge), the BV equation relates current density to overpotential $\\eta$ via\n$$\nI = i_0(c)\\left[\\exp\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right],\n$$\nwhere the symmetry factor is $\\alpha = 1/2$, and the exchange current density is concentration-dependent,\n$$\ni_0(c) = i_{0,\\mathrm{ref}} \\sqrt{c(1-c)}.\n$$\nUnder the symmetric assumption ($\\alpha = 1/2$), solve for the overpotential:\n$$\n\\eta(I,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{I}{2\\,i_0(c)}\\right).\n$$\n\n- Nucleation-controlled hysteresis is introduced by a constant nucleation barrier overpotential parameter $\\gamma$, which must be overcome with a sign depending on the direction of transformation. The measured voltage under galvanostatic operation is modeled as\n$$\nV_{\\mathrm{meas}}(c; I, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(I,c) + \\mathrm{sgn}(I)\\,\\gamma,\n$$\nwhere $\\mathrm{sgn}(I)$ is the sign function.\n\n- The composition trajectory is controlled by a constant applied current density $I$ and a normalized capacity such that $c$ changes linearly in time; for the purpose of this problem, you should compute voltage as a function of $c$ directly and not integrate time.\n\nYour task:\n\n1. Starting from the above base, implement a numerical procedure to compute the hysteresis loop area in the voltage–composition plane over one full cycle. Define the cycle as charging from $c_{\\min}$ to $c_{\\max}$ at constant $I0$, and then discharging from $c_{\\max}$ back to $c_{\\min}$ at current $I0$. The hysteresis area $\\mathcal{A}$ is defined as the closed-loop integral\n$$\n\\mathcal{A} = \\oint V_{\\mathrm{meas}}(c; I, \\gamma)\\, dc = \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; +|I|, \\gamma)\\, dc \\;-\\; \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; -|I|, \\gamma)\\, dc,\n$$\nwhich has units of volts (since $c$ is dimensionless). Compute these integrals numerically using a sufficiently fine discretization of $c$.\n\n2. Systematically vary the nucleation barrier parameter $\\gamma$ and measure the resulting $\\mathcal{A}(\\gamma)$ to validate the nucleation-controlled hysteresis hypothesis. Use physically plausible parameters:\n   - Universal gas constant $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n   - Faraday constant $F = 96485\\,\\mathrm{C\\,mol^{-1}}$,\n   - Absolute temperature $T = 298\\,\\mathrm{K}$,\n   - Regular-solution parameter $\\Omega = 4000\\,\\mathrm{J\\,mol^{-1}}$,\n   - Exchange current density reference $i_{0,\\mathrm{ref}} = 1.0\\,\\mathrm{A\\,m^{-2}}$,\n   - Applied current density magnitude $|I| = 0.01\\,\\mathrm{A\\,m^{-2}}$,\n   - Lower and upper composition bounds $c_{\\min} = 0.05$ and $c_{\\max} = 0.95$.\n\n3. Use a uniform grid in $c$ with at least $N = 500$ points in $[c_{\\min}, c_{\\max}]$ for numerical integration.\n\n4. Test Suite. Compute $\\mathcal{A}(\\gamma)$ for the following set of nucleation barrier values (in volts):\n   - $\\gamma = 0.0$,\n   - $\\gamma = 0.01$,\n   - $\\gamma = 0.03$,\n   - $\\gamma = 0.05$,\n   - $\\gamma = 0.10$.\n   These cases are chosen to probe:\n   - The baseline with no nucleation barrier,\n   - Small barriers,\n   - Moderate barriers,\n   - Larger barriers.\n\n5. Numerical output requirements:\n   - Express the hysteresis area $\\mathcal{A}$ in volts for each test case.\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").\n   - Each result must be a floating-point number. You may compute to full double precision; no rounding is required beyond what standard printing of Python floats yields.\n\nEnsure scientific realism by keeping all parameters as specified, and ensure your algorithm is derived from the stated thermodynamic and kinetic bases without introducing shortcut formulas not supported by these bases. The problem is fully self-contained and must be solvable purely by algorithmic implementation in a modern programming language without external data. The final answers must be in volts (unit for $\\mathcal{A}$), expressed as floating-point numbers.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be **valid**. It is scientifically grounded in established electrochemical principles, quantitatively well-posed, objective, and internally consistent. All data and definitions required for a unique solution are provided.\n\nThe task is to compute the hysteresis area $\\mathcal{A}$ over a galvanostatic cycle for an intercalation electrode, and to study its dependence on a nucleation barrier parameter $\\gamma$. The solution proceeds by first deriving a more direct analytical expression for $\\mathcal{A}$ from the given definitions, and then implementing its numerical evaluation.\n\n**1. Analytical Formulation of the Hysteresis Area**\n\nThe hysteresis area $\\mathcal{A}$ is defined as the closed-loop integral of voltage with respect to the dimensionless composition $c$:\n$$\n\\mathcal{A} = \\oint V_{\\mathrm{meas}}(c; I, \\gamma)\\, dc\n$$\nThis cycle consists of a charging process from $c_{\\min}$ to $c_{\\max}$ with current $I = +|I|$, and a discharging process from $c_{\\max}$ back to $c_{\\min}$ with current $I = -|I|$. The integral can be expressed as:\n$$\n\\mathcal{A} = \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; +|I|, \\gamma)\\, dc \\;-\\; \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; -|I|, \\gamma)\\, dc\n$$\nThe measured voltage $V_{\\mathrm{meas}}$ is given by:\n$$\nV_{\\mathrm{meas}}(c; I, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(I,c) + \\mathrm{sgn}(I)\\,\\gamma\n$$\nwhere $V_{\\mathrm{eq}}(c)$ is the equilibrium voltage, $\\eta(I,c)$ is the kinetic overpotential, and $\\gamma$ is the nucleation overpotential.\n\nLet's substitute the expression for $V_{\\mathrm{meas}}$ into the formula for $\\mathcal{A}$.\nFor the charging path ($I = +|I|$), $\\mathrm{sgn}(I) = +1$:\n$$\nV_{\\mathrm{meas}}(c; +|I|, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(+|I|,c) + \\gamma\n$$\nFor the discharging path ($I = -|I|$), $\\mathrm{sgn}(I) = -1$:\n$$\nV_{\\mathrm{meas}}(c; -|I|, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(-|I|,c) - \\gamma\n$$\nThe difference in voltage between the charging and discharging curves at a given composition $c$ is:\n$$\n\\Delta V(c) = V_{\\mathrm{meas}}(c; +|I|, \\gamma) - V_{\\mathrm{meas}}(c; -|I|, \\gamma)\n$$\n$$\n\\Delta V(c) = [V_{\\mathrm{eq}}(c) + \\eta(+|I|,c) + \\gamma] - [V_{\\mathrm{eq}}(c) + \\eta(-|I|,c) - \\gamma]\n$$\nThe equilibrium potential $V_{\\mathrm{eq}}(c)$ cancels out:\n$$\n\\Delta V(c) = \\eta(+|I|,c) - \\eta(-|I|,c) + 2\\gamma\n$$\nThe overpotential $\\eta$ is given by the symmetric Butler-Volmer equation solution:\n$$\n\\eta(I,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{I}{2\\,i_0(c)}\\right)\n$$\nSince $\\mathrm{arcsinh}(x)$ is an odd function, i.e., $\\mathrm{arcsinh}(-x) = -\\mathrm{arcsinh}(x)$, we have:\n$$\n\\eta(-|I|,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{-|I|}{2\\,i_0(c)}\\right) = -\\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{|I|}{2\\,i_0(c)}\\right) = -\\eta(+|I|,c)\n$$\nSubstituting this into the expression for $\\Delta V(c)$:\n$$\n\\Delta V(c) = \\eta(+|I|,c) - (-\\eta(+|I|,c)) + 2\\gamma = 2\\eta(+|I|,c) + 2\\gamma\n$$\nThe hysteresis area $\\mathcal{A}$ is the integral of this voltage difference over the composition range:\n$$\n\\mathcal{A}(\\gamma) = \\int_{c_{\\min}}^{c_{\\max}} \\Delta V(c) \\,dc = \\int_{c_{\\min}}^{c_{\\max}} \\left[ 2\\eta(+|I|,c) + 2\\gamma \\right] dc\n$$\nThis can be separated into two terms: a kinetic contribution and a nucleation contribution.\n$$\n\\mathcal{A}(\\gamma) = 2 \\int_{c_{\\min}}^{c_{\\max}} \\eta(+|I|,c)\\,dc + 2 \\int_{c_{\\min}}^{c_{\\max}} \\gamma\\,dc\n$$\nThe second integral is trivial:\n$$\n2 \\int_{c_{\\min}}^{c_{\\max}} \\gamma\\,dc = 2\\gamma (c_{\\max} - c_{\\min})\n$$\nThe first integral, representing the area from kinetic (Butler-Volmer) hysteresis, must be computed numerically. The full expression for the hysteresis area is:\n$$\n\\mathcal{A}(\\gamma) = \\frac{2RT}{F} \\int_{c_{\\min}}^{c_{\\max}} \\mathrm{arcsinh}\\left(\\frac{|I|}{2\\,i_{0,\\mathrm{ref}} \\sqrt{c(1-c)}}\\right)\\,dc + 2\\gamma (c_{\\max} - c_{\\min})\n$$\nThis formulation reveals a linear relationship between the total hysteresis area $\\mathcal{A}$ and the nucleation barrier $\\gamma$, a direct consequence of the model's assumptions.\n\n**2. Algorithmic Design and Numerical Integration**\n\nThe numerical procedure will evaluate the expression for $\\mathcal{A}(\\gamma)$ using the specified parameters.\n\n- **Parameters**:\n  - Universal gas constant: $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - Faraday constant: $F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n  - Absolute temperature: $T = 298\\,\\mathrm{K}$\n  - Regular-solution parameter: $\\Omega = 4000\\,\\mathrm{J\\,mol^{-1}}$ (Note: $\\Omega$ is not needed for the calculation of $\\mathcal{A}$, as $V_{\\mathrm{eq}}$ cancels out).\n  - Exchange current density reference: $i_{0,\\mathrm{ref}} = 1.0\\,\\mathrm{A\\,m^{-2}}$\n  - Applied current density magnitude: $|I| = 0.01\\,\\mathrm{A\\,m^{-2}}$\n  - Composition bounds: $c_{\\min} = 0.05$ and $c_{\\max} = 0.95$\n\n- **Numerical Method**:\n  1. A uniform grid of $N=500$ points for the composition $c$ will be created over the interval $[c_{\\min}, c_{\\max}]$.\n  2. The integrand for the kinetic contribution, $f(c) = 2\\eta(+|I|,c)$, will be evaluated at each point on this grid.\n  3. The integral of $f(c)$ will be computed using the trapezoidal rule, which provides sufficient accuracy for a finely discretized smooth function.\n  4. The nucleation contribution, $2\\gamma(c_{\\max}-c_{\\min})$, will be calculated directly.\n  5. The total hysteresis area $\\mathcal{A}$ is the sum of these two contributions.\n\n- **Test Suite Execution**:\n  The above procedure will be repeated for each value of $\\gamma$ provided in the test suite:\n  - $\\gamma \\in \\{0.0, 0.01, 0.03, 0.05, 0.10\\}$ volts.\n\nThe final output will be a list of the computed $\\mathcal{A}(\\gamma)$ values, demonstrating the effect of the nucleation barrier on the total hysteresis. The linear dependence of $\\mathcal{A}$ on $\\gamma$ serves as a direct test of the nucleation-controlled hysteresis hypothesis within the framework of this model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... # Scipy is available but not required for this solution.\n\ndef solve():\n    \"\"\"\n    Computes hysteresis area for an intercalation electrode model\n    based on thermodynamic and kinetic principles.\n    \"\"\"\n    # Define physical constants and problem parameters.\n    R = 8.314  # J mol^-1 K^-1\n    F = 96485.0  # C mol^-1\n    T = 298.0  # K\n    i0_ref = 1.0  # A m^-2\n    I_abs = 0.01  # A m^-2\n    c_min = 0.05\n    c_max = 0.95\n    N = 500  # Number of points for numerical integration\n\n    # Define the test cases for the nucleation barrier gamma (in volts).\n    test_cases = [0.0, 0.01, 0.03, 0.05, 0.10]\n\n    results = []\n\n    # Create a uniform grid for the composition 'c'.\n    # The endpoints c_min and c_max are included.\n    c_grid = np.linspace(c_min, c_max, N)\n\n    # Calculate the kinetic contribution to the hysteresis area.\n    # This part of the calculation is independent of gamma and can be pre-computed.\n    \n    # Calculate exchange current density i_0(c) over the grid.\n    # A small epsilon is added to avoid division by zero at the theoretical\n    # limits c=0 and c=1, though the problem's c_grid is safely away from them.\n    eps = 1e-12\n    i0_c = i0_ref * np.sqrt(c_grid * (1.0 - c_grid) + eps)\n\n    # The argument for the arcsinh function.\n    arcsinh_arg = I_abs / (2.0 * i0_c)\n\n    # Calculate the overpotential for the positive current (+|I|) over the grid.\n    # This corresponds to the charging process.\n    eta_plus = (R * T / F) * np.arcsinh(arcsinh_arg)\n\n    # The kinetic contribution to the area is the integral of 2 * eta_plus.\n    # We use the trapezoidal rule for numerical integration.\n    kinetic_area = np.trapz(2.0 * eta_plus, c_grid)\n\n    for gamma in test_cases:\n        # The nucleation contribution to the hysteresis area is analytical.\n        # It is 2 * gamma * (c_max - c_min).\n        nucleation_area = 2.0 * gamma * (c_max - c_min)\n        \n        # The total hysteresis area is the sum of the kinetic and nucleation parts.\n        total_area = kinetic_area + nucleation_area\n        \n        results.append(total_area)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "To capture more complex hysteretic phenomena, such as the formation of minor loops during partial cycling, we must move beyond phenomenological parameters and model the underlying physical transformations. This advanced practice challenges you to simulate the core-shell growth of a new phase within a single electrode particle, directly linking the microscopic movement of the phase boundary to the macroscopic voltage signature . Mastering this type of physics-based modeling is crucial for developing high-fidelity simulations that can accurately predict battery performance under dynamic, real-world operating conditions.",
            "id": "3919083",
            "problem": "Consider a single spherical intercalation particle undergoing two-phase transformation between a low-lithium phase and a high-lithium phase under galvanostatic operation. Let the particle radius be $R$ (in $\\mathrm{m}$). Assume a sharp interface between the two phases, where a high-lithium shell of thickness $s(t)$ (in $\\mathrm{m}$) grows inward from the particle surface during lithiation and recedes during delithiation. Let $c_{\\alpha}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) denote the lithium concentration in the high-lithium phase and $c_{\\beta}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) denote the lithium concentration in the low-lithium phase, both treated as constants within the miscibility gap, and define $\\Delta c = c_{\\alpha} - c_{\\beta}  0$. The surface molar flux of lithium is $j$ (in $\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$), with $j  0$ for lithiation and $j  0$ for delithiation, and it is spatially uniform over the particle surface.\n\nStarting from fundamental mass conservation at a moving phase boundary in a sphere and the definition of the spherical geometry, derive the evolution equation of the interface radius $r_{i}(t)$ (in $\\mathrm{m}$), where $r_{i}(t) = R - s(t)$. Make the physically justified assumption that the total molar rate of lithium entering the particle equals the molar rate required to transform low-lithium phase into high-lithium phase at the moving interface. Enforce that the interfacial velocity is determined by this balance and depends on the interface area. Do not introduce any empirical shortcut formula for shell growth; the derivation must start from mass conservation, spherical geometry, and constant concentrations $c_{\\alpha}$ and $c_{\\beta}$.\n\nHaving obtained the governing equation, integrate it to obtain $s(t)$ under a constant lithiation flux $j  0$ and, under reversal, under a constant delithiation flux $j  0$, both starting from a given initial shell thickness $s(0)$. Treat the transformation as fully coherent so that the only geometric limitation is the sphere’s radius $R$. Provide explicit closed-form expressions that allow computing $s(t)$ during each constant-flux segment.\n\nTo connect phase growth to voltage hysteresis, adopt a minimal but physically consistent voltage model as follows:\n- The Open Circuit Voltage (OCV) plateau $U_{0}$ (in $\\mathrm{V}$) is constant within the two-phase region.\n- Coherency strain modifies the local chemical potential in proportion to the shell thickness. Model this as a voltage shift $\\pm \\gamma \\, s/R$ (in $\\mathrm{V}$), where $\\gamma  0$ (in $\\mathrm{V}$) is a material parameter; use the $+$ sign for lithiation and the $-$ sign for delithiation.\n- The interfacial reaction overpotential is governed by the linearized limit of the Butler–Volmer kinetics. With electrons per intercalant $n = 1$, the charge-transfer current density is $i_{\\mathrm{elec}} = n F j$ (in $\\mathrm{A}/\\mathrm{m}^{2}$), where $F$ is the Faraday constant (in $\\mathrm{C}/\\mathrm{mol}$). For small overpotentials, the linearized Butler–Volmer relation yields $\\eta \\approx i_{\\mathrm{elec}} \\, R_{g} T / (i_{0} F) = j \\, R_{g} T / i_{0}$ (in $\\mathrm{V}$), where $R_{g}$ is the universal gas constant (in $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$), $T$ is temperature (in $\\mathrm{K}$), and $i_{0}$ is the exchange current density (in $\\mathrm{A}/\\mathrm{m}^{2}$). Take $\\eta$ with the $+$ sign for lithiation and the $-$ sign for delithiation.\n\nUnder this model, the instantaneous voltage during lithiation is $V_{\\mathrm{L}}(t) = U_{0} + \\gamma \\, s(t)/R + j \\, R_{g} T / i_{0}$ and during delithiation is $V_{\\mathrm{D}}(t) = U_{0} - \\gamma \\, s(t)/R - |j| \\, R_{g} T / i_{0}$.\n\nDefine the volume fraction of the high-lithium phase $f_{\\alpha}(t)$ as the ratio of its volume to the particle volume. Under the core–shell geometry with interface radius $r_{i}(t)$, this fraction is $f_{\\alpha}(t) = 1 - \\left( r_{i}(t) / R \\right)^{3}$. Note that $f_{\\alpha}(t)$ is the same as the state-of-charge fraction on a per-particle basis within the two-phase region.\n\nYou must implement a discrete three-stage galvanostatic protocol on a single particle:\n- Stage A (lithiation): starting from $s(0) = 0$, apply constant flux $j_{1}  0$ for time $t_{1}$ (in $\\mathrm{s}$), compute $s_{1} = s(t_{1})$.\n- Stage B (delithiation): reverse with constant flux $j_{2}  0$ for time $t_{2}$ (in $\\mathrm{s}$), compute $s_{2} = s(t_{1} + t_{2})$; if $s_{2} \\le 0$, the shell is fully removed.\n- Stage C (re-lithiation): apply constant flux $j_{3}  0$ for time $t_{3}$ (in $\\mathrm{s}$), compute the final shell thickness $s_{3} = s(t_{1} + t_{2} + t_{3})$.\n\nTo quantify a minor loop in hysteresis caused by incomplete shell removal, evaluate the voltage difference at the end of Stage C between the lithiation branch and the delithiation branch at the same state-of-charge fraction $f_{\\alpha}(t_{1} + t_{2} + t_{3})$. Since $f_{\\alpha}$ uniquely determines $s$ via the geometry, this minor-loop width at the end of Stage C is\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}\\big(s_{3}, j_{3}\\big) - V_{\\mathrm{D}}\\big(s_{3}, j_{2}\\big) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} \\left( j_{3} + |j_{2}| \\right).\n$$\n\nYour program must:\n- Implement the closed-form $s(t)$ for each constant-flux segment.\n- Compute $f_{\\alpha}(t)$ from $s(t)$ and $R$.\n- Compute $V_{\\mathrm{L}}$ and $V_{\\mathrm{D}}$ as specified and then $\\Delta V_{\\mathrm{minor}}$.\n- Determine whether the shell was fully removed in Stage B, i.e., output a boolean indicating if $s_{2} \\le 0$.\n\nExpress shell thicknesses in $\\mathrm{m}$ and voltages in $\\mathrm{V}$, both as floating-point numbers.\n\nTest Suite. Use the following four parameter sets to exercise normal operation, full removal, early reversal, and zero-reversal-current edge case. For all cases, take $U_{0} = 3.4$ (in $\\mathrm{V}$), $\\gamma = 0.05$ (in $\\mathrm{V}$), $i_{0} = 100$ (in $\\mathrm{A}/\\mathrm{m}^{2}$), $T = 298$ (in $\\mathrm{K}$), $c_{\\alpha} - c_{\\beta} = \\Delta c = 3 \\times 10^{4}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$), and $R = 10^{-6}$ (in $\\mathrm{m}$). Each case specifies $(j_{1}, t_{1}, j_{2}, t_{2}, j_{3}, t_{3})$ with $j$ in $\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$ and $t$ in $\\mathrm{s}$:\n- Case $1$ (happy path, incomplete removal): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 900, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n- Case $2$ (boundary, full removal during Stage B): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 3600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n- Case $3$ (early reversal, small shell): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 60, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 30, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 90)$.\n- Case $4$ (edge case, zero reversal current): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1200, \\, j_{2} = 0, \\, t_{2} = 600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n\nFinal Output Specification. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result (per case) is a list of length $3$: $[s_{3}, \\Delta V_{\\mathrm{minor}}, \\mathrm{full\\_removal\\_StageB}]$, where $s_{3}$ is in $\\mathrm{m}$, $\\Delta V_{\\mathrm{minor}}$ is in $\\mathrm{V}$, and $\\mathrm{full\\_removal\\_StageB}$ is a boolean. For example, the overall output should look like $[[s_{3}^{(1)}, \\Delta V_{\\mathrm{minor}}^{(1)}, \\mathrm{bool}^{(1)}],[s_{3}^{(2)}, \\Delta V_{\\mathrm{minor}}^{(2)}, \\mathrm{bool}^{(2)}],[s_{3}^{(3)}, \\Delta V_{\\mathrm{minor}}^{(3)}, \\mathrm{bool}^{(3)}],[s_{3}^{(4)}, \\Delta V_{\\mathrm{minor}}^{(4)}, \\mathrm{bool}^{(4)}]]$.",
            "solution": "The problem is valid as it is scientifically grounded in established principles of electrochemistry and materials science, is well-posed with a clear objective and sufficient data, and is expressed in objective, formal language. We will proceed to solve it by first deriving the governing equation for the phase boundary motion, then integrating it to obtain a closed-form solution for the shell thickness, and finally applying this solution to the specified three-stage galvanostatic protocol.\n\n**Part 1: Derivation of the Interface Evolution Equation**\n\nThe model considers a spherical particle of radius $R$ with a sharp interface at radius $r_i(t)$ separating an outer high-lithium ($\\alpha$) phase from an inner low-lithium ($\\beta$) phase. The concentrations within each phase are constant, $c_{\\alpha}$ and $c_{\\beta}$ respectively, with $\\Delta c = c_{\\alpha} - c_{\\beta}  0$.\n\nThe core physical assumption is the conservation of mass: the total molar rate of lithium entering or leaving the particle through its surface must equal the rate at which lithium is consumed or released by the moving phase boundary.\n\nThe total molar rate of lithium entering the particle is given by the product of the uniform surface molar flux, $j$ (in $\\mathrm{mol}/\\mathrm{m}^2\\cdot\\mathrm{s}$), and the particle's surface area, $A_p = 4\\pi R^2$.\n$$\n\\text{Total Molar Rate} = j \\cdot (4\\pi R^2) \\quad [\\mathrm{mol/s}]\n$$\nA positive $j$ corresponds to lithiation (influx), and a negative $j$ corresponds to delithiation (outflux).\n\nThe phase boundary is a sphere of area $A_i(t) = 4\\pi r_i(t)^2$. In a time interval $dt$, the interface moves by a radial distance $dr_i$. The volume swept by the interface is $dV = A_i(t) \\cdot |dr_i| = 4\\pi r_i(t)^2 |dr_i|$. To transform this volume from phase $\\beta$ to phase $\\alpha$, the amount of lithium required is $dN = \\Delta c \\cdot dV$. The molar rate of lithium consumption at the interface is thus:\n$$\n\\frac{dN}{dt} = \\Delta c \\frac{dV}{dt} = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left| \\frac{dr_i}{dt} \\right|\n$$\nDuring lithiation ($j0$), the interface moves inward, so $r_i$ decreases, and $dr_i/dt  0$. Thus, $|dr_i/dt| = -dr_i/dt$. Equating the influx to the consumption rate:\n$$\nj \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( -\\frac{dr_i}{dt} \\right)\n$$\n$$\n\\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\nDuring delithiation ($j0$), the interface moves outward, so $r_i$ increases, and $dr_i/dt  0$. The rate of lithium leaving the particle, $|j| \\cdot 4\\pi R^2$, must be supplied by the transformation from phase $\\alpha$ to $\\beta$.\n$$\n|j| \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right)\n$$\nSince $j  0$, we have $|j| = -j$. Substituting this gives:\n$$\n-j \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right) \\implies \\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\nThis confirms that the same ordinary differential equation (ODE) governs the evolution of the interface radius $r_i(t)$ for both lithiation and delithiation.\n\n**Part 2: Integration for Constant-Flux Segments**\n\nThe derived ODE is separable:\n$$\nr_i(t)^2 \\, dr_i = -\\frac{j R^2}{\\Delta c} \\, dt\n$$\nWe integrate this equation over a time interval $\\Delta t = t_k - t_{k-1}$ during which the flux $j_k$ is constant. Let the initial interface radius be $r_{i, k-1}$ and the final radius be $r_{i, k}$.\n$$\n\\int_{r_{i, k-1}}^{r_{i, k}} r^2 \\, dr = \\int_{t_{k-1}}^{t_k} -\\frac{j_k R^2}{\\Delta c} \\, d\\tau\n$$\n$$\n\\left[ \\frac{r^3}{3} \\right]_{r_{i, k-1}}^{r_{i, k}} = -\\frac{j_k R^2}{\\Delta c} \\Delta t_k\n$$\n$$\nr_{i, k}^3 - r_{i, k-1}^3 = -\\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\nThis gives the evolution of the cubed interface radius. In terms of shell thickness $s(t) = R - r_i(t)$, we have $r_i(t) = R - s(t)$. Let $s_{k-1}$ be the initial shell thickness and $s_k$ be the final one for the step.\n$$\n(R - s_k)^3 = (R - s_{k-1})^3 - \\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\nThe shell thickness must be physically constrained, $0 \\le s(t) \\le R$, which implies $R \\ge r_i(t) \\ge 0$. This means $r_i(t)^3$ must be within the range $[0, R^3]$. The algorithm must enforce these bounds.\n\n**Part 3: Algorithmic Implementation of the Protocol**\n\nWe can define a constant $K = \\frac{3 R^2}{\\Delta c}$. The update rule for the cubed interface radius over a step with flux $j$ and duration $\\Delta t$, starting from $r_{i, \\text{start}}^3$, is:\n$$\nr_{i, \\text{end, raw}}^3 = r_{i, \\text{start}}^3 - K \\cdot j \\cdot \\Delta t\n$$\nTo enforce physical bounds, we clamp the result:\n$$\nr_{i, \\text{end}}^3 = \\max(0, \\min(R^3, r_{i, \\text{end, raw}}^3))\n$$\nThe final shell thickness for the step is $s_{\\text{end}} = R - (r_{i, \\text{end}}^3)^{1/3}$.\n\nThe three-stage protocol is implemented as follows:\n1.  **Stage A (Lithiation):** Initial state is $s(0)=0$, so $r_{i,0}^3 = R^3$. Apply flux $j_1$ for time $t_1$.\n    $r_{i,1}^3 = \\max(0, \\min(R^3, R^3 - K j_1 t_1))$. The final shell thickness is $s_1 = R - (r_{i,1}^3)^{1/3}$.\n2.  **Stage B (Delithiation):** Start from $r_{i,1}^3$. Apply flux $j_2$ for time $t_2$.\n    $r_{i,2, \\text{raw}}^3 = r_{i,1}^3 - K j_2 t_2$. We check for full shell removal: `full_removal_StageB` is true if $r_{i,2, \\text{raw}}^3 \\ge R^3$.\n    $r_{i,2}^3 = \\max(0, \\min(R^3, r_{i,2, \\text{raw}}^3))$. The final shell thickness is $s_2 = R - (r_{i,2}^3)^{1/3}$.\n3.  **Stage C (Re-lithiation):** Start from $r_{i,2}^3$. Apply flux $j_3$ for time $t_3$.\n    $r_{i,3}^3 = \\max(0, \\min(R^3, r_{i,2}^3 - K j_3 t_3))$. The final shell thickness is $s_3 = R - (r_{i,3}^3)^{1/3}$.\n\n**Part 4: Final Calculations**\n\nAfter computing the final shell thickness $s_3$, the minor-loop voltage width $\\Delta V_{\\mathrm{minor}}$ is calculated using the provided formula:\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}(s_{3}, j_{3}) - V_{\\mathrm{D}}(s_{3}, j_{2}) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} (j_{3} + |j_{2}|)\n$$\nwhere $R_g$ is the universal gas constant ($8.314462618 \\, \\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$) and $T$ is the temperature in Kelvin. The program will report the triplet $[s_3, \\Delta V_{\\mathrm{minor}}, \\text{full\\_removal\\_StageB}]$ for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating shell thickness and hysteresis voltage\n    for a three-stage galvanostatic protocol on a phase-transforming particle.\n    \"\"\"\n    \n    # Universal constants and parameters for all test cases\n    R = 1.0e-6  # Particle radius [m]\n    DELTA_C = 3.0e4  # Concentration difference [mol/m^3]\n    GAMMA = 0.05  # Strain-voltage coupling parameter [V]\n    I0 = 100.0  # Exchange current density [A/m^2]\n    T = 298.0  # Temperature [K]\n    RG = 8.314462618  # Universal gas constant [J/(mol*K)]\n\n    # Pre-calculated constants for efficiency\n    R_CUBED = R**3\n    K_CONST = 3 * R**2 / DELTA_C\n    OHMIC_PREFACTOR = RG * T / I0\n\n    test_cases = [\n        # (j1, t1, j2, t2, j3, t3) with j in [mol/m^2*s] and t in [s]\n        (2.0e-6, 1800.0, -1.0e-6, 900.0, 2.0e-6, 600.0),   # Case 1: Happy path\n        (2.0e-6, 1800.0, -1.0e-6, 3600.0, 2.0e-6, 600.0),  # Case 2: Full removal\n        (2.0e-6, 60.0, -1.0e-6, 30.0, 2.0e-6, 90.0),      # Case 3: Early reversal\n        (2.0e-6, 1200.0, 0.0, 600.0, 2.0e-6, 600.0)       # Case 4: Zero reversal current\n    ]\n\n    results = []\n\n    for case in test_cases:\n        j1, t1, j2, t2, j3, t3 = case\n\n        # Initialize with a fully delithiated particle (shell thickness s=0)\n        # The state is tracked by the cubed interface radius, ri_cubed.\n        # s = R - ri, so s=0 - ri=R - ri_cubed = R^3\n        ri_cubed_current = R_CUBED\n\n        # Stage A: Lithiation\n        j_A, dt_A = j1, t1\n        ri_cubed_after_A_raw = ri_cubed_current - K_CONST * j_A * dt_A\n        ri_cubed_after_A = np.clip(ri_cubed_after_A_raw, 0, R_CUBED)\n        \n        # Stage B: Delithiation\n        j_B, dt_B = j2, t2\n        ri_cubed_after_B_raw = ri_cubed_after_A - K_CONST * j_B * dt_B\n        # Check if the shell was fully removed before clamping the value\n        full_removal_StageB = (ri_cubed_after_B_raw = R_CUBED)\n        ri_cubed_after_B = np.clip(ri_cubed_after_B_raw, 0, R_CUBED)\n\n        # Stage C: Re-lithiation\n        j_C, dt_C = j3, t3\n        ri_cubed_after_C_raw = ri_cubed_after_B - K_CONST * j_C * dt_C\n        ri_cubed_after_C = np.clip(ri_cubed_after_C_raw, 0, R_CUBED)\n\n        # Calculate final shell thickness s3\n        s3 = R - np.cbrt(ri_cubed_after_C)\n\n        # Calculate minor loop voltage width delta_V_minor\n        strain_term = 2 * GAMMA * s3 / R\n        overpotential_term = OHMIC_PREFACTOR * (j3 + abs(j2))\n        delta_V_minor = strain_term + overpotential_term\n        \n        results.append([s3, delta_V_minor, full_removal_StageB])\n\n    # Format the final output as a string representation of a list of lists.\n    # This involves converting each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}