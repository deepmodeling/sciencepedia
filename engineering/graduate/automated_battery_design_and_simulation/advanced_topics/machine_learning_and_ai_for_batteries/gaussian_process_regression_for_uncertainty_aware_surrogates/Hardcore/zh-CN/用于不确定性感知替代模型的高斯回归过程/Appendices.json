{
    "hands_on_practices": [
        {
            "introduction": "高斯过程代理模型的性能在很大程度上取决于其核函数的超参数，例如长度尺度（lengthscale）。本练习将深入探讨自动调优这些超参数的核心机制，即通过最大化边际似然函数。为了使用高效的基于梯度的优化算法，推导出对数边际似然函数相对于超参数的梯度是至关重要的第一步 。通过这个实践，您将不仅加深对矩阵微积分的理解，还能洞悉高斯过程训练的内部工作原理。",
            "id": "3915981",
            "problem": "在一个自动化的锂离子电池单元设计工作流程中，一个高保真度的电化学模拟为放电容量关于设计变量的代理模型生成训练数据。令 $X \\in \\mathbb{R}^{n \\times d}$ 表示 $n$ 个模拟设计（每一行 $x_{i} \\in \\mathbb{R}^{d}$ 编码了孔隙率、活性材料分数、压延压力和隔膜曲折度等特征），并令 $y \\in \\mathbb{R}^{n}$ 为相应的标准化放电容量（零均值和单位方差）。考虑一个高斯过程（GP）回归代理模型，其均值为零，并使用各向同性平方指数核函数 $k(x, x^{\\prime}) = \\sigma_{f}^{2} \\exp\\!\\left(-\\frac{\\|x - x^{\\prime}\\|_{2}^{2}}{2 \\ell^{2}}\\right)$，以及方差为 $\\sigma_{n}^{2}$ 的加性独立高斯噪声。协方差矩阵为 $K = K_{y} + \\sigma_{n}^{2} I$，其中 $[K_{y}]_{ij} = k(x_{i}, x_{j})$，$I$ 是单位矩阵，超参数为 $\\theta = \\{\\ell, \\sigma_{f}^{2}, \\sigma_{n}^{2}\\}$。\n\n仅从多元高斯对数似然函数 $y \\sim \\mathcal{N}(0, K)$ 的定义出发，使用矩阵微积分推导其关于核函数长度尺度 $\\ell$ 的梯度 $\\frac{\\partial \\log p(y \\mid X, \\theta)}{\\partial \\ell}$。你的推导必须明确使用矩阵逆的导数和对数行列式的导数的恒等式，并且必须以符号形式保留所有常数。然后，将结果具体化到各向同性平方指数核函数，通过成对欧几里得距离 $d_{ij} = \\|x_{i} - x_{j}\\|_{2}$、向量 $\\alpha = K^{-1} y$ 和矩阵 $K^{-1}$ 来表示结果。\n\n在一个简短的段落中，解释这个梯度如何在实践中为自动化电池设计中的不确定性感知代理模型启用基于梯度的超参数优化，包括如何强制执行 $\\ell$ 的正性约束以及如何稳定地计算所需的线性代数。\n\n将你的最终梯度表示为包含对索引 $i$ 和 $j$ 的双重求和的单个闭式解析表达式。不需要进行数值计算。最终表达式中不要包含物理单位。不需要进行四舍五入。",
            "solution": "该问题要求推导高斯过程（GP）的对数边际似然函数关于核函数长度尺度超参数 $\\ell$ 的梯度，并随后解释其在超参数优化中的应用。\n\n观测数据向量 $y \\in \\mathbb{R}^{n}$ 被建模为从一个零均值、协方差矩阵为 $K$ 的多元高斯分布中抽取，即 $y \\sim \\mathcal{N}(0, K)$。对数边际似然函数，记作 $\\mathcal{L}(\\theta) = \\log p(y \\mid X, \\theta)$，由下式给出：\n$$\n\\mathcal{L}(\\theta) = \\log p(y \\mid K) = -\\frac{n}{2} \\log(2\\pi) - \\frac{1}{2} \\log|K| - \\frac{1}{2} y^T K^{-1} y\n$$\n此处，$K$ 是协方差矩阵，它依赖于超参数 $\\theta = \\{\\ell, \\sigma_f^2, \\sigma_n^2\\}$。我们的任务是求 $\\mathcal{L}(\\theta)$ 关于长度尺度 $\\ell$ 的偏导数。\n\n首先，我们对 $\\mathcal{L}(\\theta)$ 关于 $\\ell$ 求导。第一项 $-\\frac{n}{2} \\log(2\\pi)$ 是一个关于 $\\ell$ 的常数，所以其导数为零。剩下的两项通过矩阵 $K$ 依赖于 $\\ell$。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\ell} = -\\frac{1}{2} \\frac{\\partial}{\\partial \\ell} (\\log|K|) - \\frac{1}{2} \\frac{\\partial}{\\partial \\ell} (y^T K^{-1} y)\n$$\n我们应用矩阵导数的链式法则。对于一个矩阵的泛标量函数 $f(K)$，其关于一个标量参数 $\\lambda$ 的导数由 $\\frac{\\partial f(K)}{\\partial \\lambda} = \\text{Tr}\\left( \\frac{\\partial f(K)}{\\partial K} \\frac{\\partial K}{\\partial \\lambda} \\right)$ 给出，假设 $K$ 是对称的。\n\n对于对数行列式项，我们使用恒等式 $\\frac{\\partial \\log|K|}{\\partial K} = K^{-1}$。应用链式法则：\n$$\n\\frac{\\partial}{\\partial \\ell} (\\log|K|) = \\text{Tr}\\left( \\frac{\\partial \\log|K|}{\\partial K} \\frac{\\partial K}{\\partial \\ell} \\right) = \\text{Tr}\\left( K^{-1} \\frac{\\partial K}{\\partial \\ell} \\right)\n$$\n对于二次型项，我们首先使用矩阵逆的导数恒等式：$\\frac{\\partial K^{-1}}{\\partial \\lambda} = -K^{-1} \\frac{\\partial K}{\\partial \\lambda} K^{-1}$。应用此恒等式：\n$$\n\\frac{\\partial}{\\partial \\ell} (y^T K^{-1} y) = y^T \\left( \\frac{\\partial K^{-1}}{\\partial \\ell} \\right) y = y^T \\left( -K^{-1} \\frac{\\partial K}{\\partial \\ell} K^{-1} \\right) y\n$$\n结合这些结果，对数似然函数的梯度为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\ell} = -\\frac{1}{2} \\text{Tr}\\left( K^{-1} \\frac{\\partial K}{\\partial \\ell} \\right) - \\frac{1}{2} \\left( -y^T K^{-1} \\frac{\\partial K}{\\partial \\ell} K^{-1} y \\right) = \\frac{1}{2} \\left( y^T K^{-1} \\frac{\\partial K}{\\partial \\ell} K^{-1} y - \\text{Tr}\\left( K^{-1} \\frac{\\partial K}{\\partial \\ell} \\right) \\right)\n$$\n根据问题中的规定，令 $\\alpha = K^{-1} y$。由于 $K$ 是对称的，$\\alpha^T = (K^{-1}y)^T = y^T (K^{-1})^T = y^T K^{-1}$。将 $\\alpha$ 代入表达式：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\ell} = \\frac{1}{2} \\left( \\alpha^T \\frac{\\partial K}{\\partial \\ell} \\alpha - \\text{Tr}\\left( K^{-1} \\frac{\\partial K}{\\partial \\ell} \\right) \\right)\n$$\n第一项 $\\alpha^T \\frac{\\partial K}{\\partial \\ell} \\alpha$ 是一个标量，所以它等于自身的迹。利用迹的循环性质，$\\text{Tr}(ABC) = \\text{Tr}(BCA)$，我们有 $\\text{Tr}(\\alpha^T \\frac{\\partial K}{\\partial \\ell} \\alpha) = \\text{Tr}(\\alpha \\alpha^T \\frac{\\partial K}{\\partial \\ell})$。这使我们能够将导数项提取出来：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\ell} = \\frac{1}{2} \\text{Tr}\\left( \\alpha \\alpha^T \\frac{\\partial K}{\\partial \\ell} \\right) - \\frac{1}{2} \\text{Tr}\\left( K^{-1} \\frac{\\partial K}{\\partial \\ell} \\right) = \\frac{1}{2} \\text{Tr}\\left( (\\alpha \\alpha^T - K^{-1}) \\frac{\\partial K}{\\partial \\ell} \\right)\n$$\n接下来，我们将此结果具体化到各向同性平方指数核函数。协方差矩阵为 $K = K_y + \\sigma_n^2 I$，其中 $[K_y]_{ij} = k(x_i, x_j)$。噪声方差 $\\sigma_n^2$ 和单位矩阵 $I$ 不依赖于 $\\ell$，所以 $\\frac{\\partial K}{\\partial \\ell} = \\frac{\\partial K_y}{\\partial \\ell}$。核函数为 $k(x, x') = \\sigma_f^2 \\exp\\left(-\\frac{\\|x - x'\\|_2^2}{2\\ell^2}\\right)$。令 $d_{ij} = \\|x_i - x_j\\|_2$。$K$ 的第 $(i, j)$ 个元素关于 $\\ell$ 的偏导数为：\n$$\n\\frac{\\partial K_{ij}}{\\partial \\ell} = \\frac{\\partial}{\\partial \\ell} \\left( \\sigma_f^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) \\right) = \\sigma_f^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) \\cdot \\frac{\\partial}{\\partial \\ell} \\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) = \\sigma_f^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) \\cdot \\left( - \\frac{d_{ij}^2}{2} \\cdot (-2\\ell^{-3}) \\right)\n$$\n$$\n\\frac{\\partial K_{ij}}{\\partial \\ell} = \\sigma_f^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) \\frac{d_{ij}^2}{\\ell^3}\n$$\n迹项 $\\text{Tr}(AB)$ 可以计算为逐元素乘积之和，即 $\\sum_{i,j} A_{ij} B_{ji}$。由于矩阵 $(\\alpha\\alpha^T - K^{-1})$ 和 $\\frac{\\partial K}{\\partial \\ell}$ 都是对称的，这变为 $\\sum_{i,j} (\\alpha\\alpha^T - K^{-1})_{ij} (\\frac{\\partial K}{\\partial \\ell})_{ij}$。我们现在可以将梯度的最终表达式写成一个双重求和：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\ell} = \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n \\left( [\\alpha\\alpha^T]_{ij} - [K^{-1}]_{ij} \\right) \\frac{\\partial K_{ij}}{\\partial \\ell} = \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n \\left( \\alpha_i \\alpha_j - [K^{-1}]_{ij} \\right) \\left( \\sigma_f^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right) \\frac{d_{ij}^2}{\\ell^3} \\right)\n$$\n这个表达式可以稍微重新排列，将常数从求和中提取出来，从而得到所要求的最终形式。\n\n推导出的梯度对于在电池设计工作流程中自动化调整 GP 代理模型的超参数至关重要。目标是最大化关于超参数 $\\theta = \\{\\ell, \\sigma_f^2, \\sigma_n^2\\}$ 的对数边际似然函数，这个过程被称为第二类最大似然估计。这种优化通常使用基于梯度的算法来执行，例如 L-BFGS-B，这需要目标函数（对数似然函数）关于每个超参数的解析梯度。上面推导的表达式提供了关于 $\\ell$ 的梯度分量。因为长度尺度 $\\ell$ 必须为严格正数，直接对 $\\ell$ 进行优化是受约束的。为了处理这个问题，通常通过在一个无约束变量 $\\xi \\in \\mathbb{R}$ 上进行优化来重新参数化 $\\ell$，其中 $\\ell = \\exp(\\xi)$。然后通过链式法则计算关于 $\\xi$ 的梯度：$\\frac{\\partial \\mathcal{L}}{\\partial \\xi} = \\frac{\\partial \\mathcal{L}}{\\partial \\ell} \\frac{\\partial \\ell}{\\partial \\xi} = \\frac{\\partial \\mathcal{L}}{\\partial \\ell} \\exp(\\xi) = \\frac{\\partial \\mathcal{L}}{\\partial \\ell} \\ell$。从实践的角度来看，$\\alpha=K^{-1}y$ 和 $K^{-1}$ 的计算不是通过直接矩阵求逆来执行的，因为这种方法在数值上不稳定且计算成本高昂 ($O(n^3)$)。取而代之的是，计算 Cholesky 分解 $K = LL^T$。对于对称正定的协方差矩阵 $K$，这种分解在数值上是稳定的，并允许通过求解两个三角系统 $Lz=y$ 和 $L^T\\alpha=z$ 来高效地找到 $\\alpha$，时间复杂度为 $O(n^2)$。梯度所需的矩阵逆 $K^{-1}$ 也可以通过 Cholesky 因子稳定地计算得出，即 $K^{-1} = (L^T)^{-1}L^{-1}$。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_f^2}{2\\ell^3} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\left( \\alpha_i \\alpha_j - [K^{-1}]_{ij} \\right) d_{ij}^2 \\exp\\left(-\\frac{d_{ij}^2}{2\\ell^2}\\right)}\n$$"
        },
        {
            "introduction": "贝叶斯优化是高斯过程代理模型的一个强大应用，尤其适用于在昂贵的模拟或实验中寻找最优设计。在贝叶斯优化中，采集函数（acquisition function）的作用是指导搜索过程，以高效地平衡探索（exploration）和利用（exploitation）。本练习将通过推导和分析一个基础的采集函数——“提升概率”（Probability of Improvement, PI），来帮助您建立关于采集函数工作原理的直观认识，并理解其局限性 。",
            "id": "3915948",
            "problem": "在电池自动化设计和模拟中，放电容量作为设计变量的函数，记为 $f(x)$，使用高斯过程回归（GPR）进行建模。在候选设计 $x$ 处，根据 GPR 预测模型，假设给定数据的 $f(x)$ 的后验分布是均值为 $\\mu(x)$、方差为 $\\sigma^{2}(x)$ 的高斯分布，即 $f(x) \\mid \\mathcal{D} \\sim \\mathcal{N}\\!\\left(\\mu(x), \\sigma^{2}(x)\\right)$。设迄今为止观测到的最佳放电容量为 $f^{\\star}$，定义改进随机变量 $I(x)$ 为 $I(x) = \\max\\!\\left(f(x) - f^{\\star} - \\xi, 0\\right)$，其中 $\\xi \\ge 0$ 是一个用户指定的裕度，表示相对于当前最佳值的最小改进量。仅使用 $I(x)$ 的定义、$f(x)$ 的高斯预测模型以及高斯（正态）分布的性质，推导改进概率（PI）采集函数的封闭形式解析表达式。该函数定义为在 $x$ 处的预测分布中，一次抽样的值超过 $f^{\\star} + \\xi$ 的概率。然后，对于一个锂离子正极材料设计场景，其中 $f^{\\star} = 195\\,\\mathrm{mAh/g}$，裕度 $\\xi = 2\\,\\mathrm{mAh/g}$，且候选点 $x$ 的参数为 $\\mu(x) = 192\\,\\mathrm{mAh/g}$ 和 $\\sigma(x) = 10\\,\\mathrm{mAh/g}$，对 PI 进行数值计算。将计算出的 PI 数值表示为小数，并四舍五入到四位有效数字。最后，构建并讨论一对科学上合理的候选点 $x_{1}$ 和 $x_{2}$，使得它们的 PI 值相等，但期望改进（EI）采集函数的值有显著差异，并解释为何 PI 相对于 EI 可能会失效，原因是 PI 对改进的幅度不敏感。你可以假设标准正态累积分布函数和概率密度函数是明确定义的，并可以根据需要使用，但不得在没有推导的情况下使用任何快捷公式。",
            "solution": "该问题要求推导改进概率（PI）采集函数，对一个特定场景进行数值计算，并对 PI 和期望改进（EI）采集函数进行概念性比较讨论。该问题具有科学依据，提法恰当且客观，因此被认为是有效的。\n\n### 第一部分：改进概率（PI）的推导\n\n改进概率 $\\text{PI}(x)$ 定义为在候选设计点 $x$ 处，一次新的观测 $f(x)$ 的值将比迄今为止的最佳观测值 $f^\\star$ 至少大一个裕度 $\\xi$ 的概率。用数学形式表示为：\n$$\n\\text{PI}(x) = P(f(x) > f^\\star + \\xi)\n$$\n问题指出，放电容量 $f(x)$ 由高斯过程建模，其在 $x$ 处的后验预测分布是均值为 $\\mu(x)$、方差为 $\\sigma^2(x)$ 的正态分布：\n$$\nf(x) \\mid \\mathcal{D} \\sim \\mathcal{N}(\\mu(x), \\sigma^2(x))\n$$\n为了计算该概率，我们将随机变量 $f(x)$ 标准化为一个标准正态随机变量 $Z \\sim \\mathcal{N}(0, 1)$。标准化转换为：\n$$\nZ = \\frac{f(x) - \\mu(x)}{\\sigma(x)}\n$$\n我们将此转换应用于概率表达式内的不等式：\n$$\nf(x) > f^\\star + \\xi\n$$\n两边减去均值 $\\mu(x)$ 得到：\n$$\nf(x) - \\mu(x) > f^\\star + \\xi - \\mu(x)\n$$\n假设 $\\sigma(x) > 0$（方差为零的退化情况对于优化是无益的），我们可以用标准差 $\\sigma(x)$ 除两边而不改变不等式的方向：\n$$\n\\frac{f(x) - \\mu(x)}{\\sigma(x)} > \\frac{f^\\star + \\xi - \\mu(x)}{\\sigma(x)}\n$$\n左边是我们的标准正态变量 $Z$。因此，概率变为：\n$$\n\\text{PI}(x) = P\\left(Z > \\frac{f^\\star + \\xi - \\mu(x)}{\\sigma(x)}\\right)\n$$\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF），定义为 $\\Phi(z) = P(Z \\le z)$。$Z$ 超过值 $z$ 的概率由 $P(Z > z) = 1 - P(Z \\le z) = 1 - \\Phi(z)$ 给出。\n利用这一点，我们有：\n$$\n\\text{PI}(x) = 1 - \\Phi\\left(\\frac{f^\\star + \\xi - \\mu(x)}{\\sigma(x)}\\right)\n$$\n由于标准正态分布的对称性，$\\phi(-z) = \\phi(z)$，我们有性质 $1 - \\Phi(z) = \\Phi(-z)$。应用此性质，我们可以更紧凑地写出表达式：\n$$\n\\text{PI}(x) = \\Phi\\left(-\\left(\\frac{f^\\star + \\xi - \\mu(x)}{\\sigma(x)}\\right)\\right) = \\Phi\\left(\\frac{\\mu(x) - f^\\star - \\xi}{\\sigma(x)}\\right)\n$$\n这就是改进概率采集函数的封闭形式解析表达式。为方便起见，我们定义 CDF 的参数为 $\\gamma(x)$：\n$$\n\\gamma(x) = \\frac{\\mu(x) - f^\\star - \\xi}{\\sigma(x)}\n$$\n那么，最终表达式为 $\\text{PI}(x) = \\Phi(\\gamma(x))$。\n\n### 第二部分：数值计算\n\n给定锂离子正极材料设计场景的以下数值：\n- 最佳观测容量：$f^\\star = 195\\,\\mathrm{mAh/g}$\n- 裕度：$\\xi = 2\\,\\mathrm{mAh/g}$\n- 候选点 $x$ 处的预测均值：$\\mu(x) = 192\\,\\mathrm{mAh/g}$\n- 候选点 $x$ 处的预测标准差：$\\sigma(x) = 10\\,\\mathrm{mAh/g}$\n\n首先，我们计算标准化变量 $\\gamma(x)$ 的值：\n$$\n\\gamma(x) = \\frac{\\mu(x) - f^\\star - \\xi}{\\sigma(x)} = \\frac{192 - 195 - 2}{10} = \\frac{-5}{10} = -0.5\n$$\n那么，改进概率为：\n$$\n\\text{PI}(x) = \\Phi(-0.5)\n$$\n使用标准正态分布表或计算库，CDF 在 $z = -0.5$ 处的值约为 $\\Phi(-0.5) \\approx 0.3085375...$。\n根据要求将此值四舍五入到四位有效数字，得到：\n$$\n\\text{PI}(x) \\approx 0.3085\n$$\n\n### 第三部分：PI 与 EI 的比较\n\n为了说明 PI 的局限性，我们必须构建一个包含两个候选设计 $x_1$ 和 $x_2$ 的场景，使得 $\\text{PI}(x_1) = \\text{PI}(x_2)$，但它们的期望改进 $\\text{EI}(x_1)$ 和 $\\text{EI}(x_2)$ 有显著差异。\n\n条件 $\\text{PI}(x_1) = \\text{PI}(x_2)$ 意味着 $\\Phi(\\gamma(x_1)) = \\Phi(\\gamma(x_2))$。由于 $\\Phi$ 是一个单调递增函数，这等价于 $\\gamma(x_1) = \\gamma(x_2)$。\n$$\n\\frac{\\mu(x_1) - f^\\star - \\xi}{\\sigma(x_1)} = \\frac{\\mu(x_2) - f^\\star - \\xi}{\\sigma(x_2)}\n$$\n期望改进采集函数定义为 $\\text{EI}(x) = \\mathbb{E}[\\max(f(x) - f^{\\star} - \\xi, 0)]$。其封闭形式表达式为：\n$$\n\\text{EI}(x) = (\\mu(x) - f^\\star - \\xi) \\Phi(\\gamma(x)) + \\sigma(x) \\phi(\\gamma(x))\n$$\n其中 $\\phi(\\cdot)$ 是标准正态概率密度函数（PDF）。将 $\\mu(x) - f^\\star - \\xi = \\gamma(x)\\sigma(x)$ 代入 EI 公式，我们得到：\n$$\n\\text{EI}(x) = (\\gamma(x)\\sigma(x)) \\Phi(\\gamma(x)) + \\sigma(x) \\phi(\\gamma(x)) = \\sigma(x) \\left[ \\gamma(x)\\Phi(\\gamma(x)) + \\phi(\\gamma(x)) \\right]\n$$\n如果我们设 $\\gamma(x_1) = \\gamma(x_2) = \\gamma_0$，则方括号中的项对于两个候选点都是一个常数。那么 EI 值为：\n$\\text{EI}(x_1) = \\sigma(x_1) \\left[ \\gamma_0\\Phi(\\gamma_0) + \\phi(\\gamma_0) \\right]$\n$\\text{EI}(x_2) = \\sigma(x_2) \\left[ \\gamma_0\\Phi(\\gamma_0) + \\phi(\\gamma_0) \\right]$\nEI 值的比率就是标准差的比率：$\\frac{\\text{EI}(x_2)}{\\text{EI}(x_1)} = \\frac{\\sigma(x_2)}{\\sigma(x_1)}$。因此，如果我们选择 $\\sigma(x_1) \\neq \\sigma(x_2)$，EI 值将会不同。\n\n让我们构建一对合理的候选点，使用相同的上下文 $f^\\star = 195\\,\\mathrm{mAh/g}$ 和 $\\xi = 2\\,\\mathrm{mAh/g}$，所以改进阈值为 $f^\\star + \\xi = 197\\,\\mathrm{mAh/g}$。让我们选择一个共同值 $\\gamma_0 = 0.5$。\n\n- **候选点 $x_1$（低不确定性，利用性选择）：**\n  设预测不确定性较低，例如 $\\sigma(x_1) = 4\\,\\mathrm{mAh/g}$。\n  为满足 $\\gamma(x_1) = 0.5$，我们需要 $\\frac{\\mu(x_1) - 197}{4} = 0.5$。\n  这给出的预测均值为 $\\mu(x_1) = 197 + 0.5 \\times 4 = 199\\,\\mathrm{mAh/g}$。\n  所以，$x_1$ 的参数为 $(\\mu_1, \\sigma_1) = (199, 4)$。\n\n- **候选点 $x_2$（高不确定性，探索性选择）：**\n  设预测不确定性较高，例如 $\\sigma(x_2) = 12\\,\\mathrm{mAh/g}$，是 $x_1$ 的三倍。\n  为满足 $\\gamma(x_2) = 0.5$，我们需要 $\\frac{\\mu(x_2) - 197}{12} = 0.5$。\n  这给出的预测均值为 $\\mu(x_2) = 197 + 0.5 \\times 12 = 203\\,\\mathrm{mAh/g}$。\n  所以，$x_2$ 的参数为 $(\\mu_2, \\sigma_2) = (203, 12)$。\n\n对于这两个候选点，改进概率均为 $\\text{PI}(x_1) = \\text{PI}(x_2) = \\Phi(0.5) \\approx 0.6915$。从 PI 的角度来看，两个候选点同样可取。\n\n然而，它们的期望改进将显著不同。方括号中的项为 $C = [0.5 \\cdot \\Phi(0.5) + \\phi(0.5)]$。\n$\\text{EI}(x_1) = 4 \\times C$\n$\\text{EI}(x_2) = 12 \\times C = 3 \\times \\text{EI}(x_1)$\n\n**讨论：**\n在这种情况下，PI 采集函数会失效，因为它对潜在改进的*幅度*不敏感。它只记录了发生改进的概率，将所有改进（无论是微小的还是显著的）都同等对待。候选点 $x_1$ 提供了高概率的微小改进（其均值仅略高于阈值，且方差较小）。候选点 $x_2$ 具有相同的改进概率，但其更高的均值和大得多的方差意味着有很大机会获得非常大的改进。$f(x_2)$ 更宽的分布意味着其对应于大容量值的上尾部分，相比于 $f(x_1)$，有更多的概率质量远离均值。\n\nEI 采集函数通过计算改进的期望值，正确地平衡了改进的概率与其可能的幅度。它在改进区域上对改进量（$f(x) - (f^\\star + \\xi)$）与其概率密度的乘积进行积分。因此，EI 正确地将 $x_2$ 识别为更有希望的候选点，因为获得巨大、改变格局的发现的潜力，超过了 $x_1$ 所提供的获得微小改进的相似概率。这使得 EI 成为一种更有效的搜索指导策略，因为它自然地平衡了“利用”（在已知优点附近采样，如 $x_1$）和“探索”（在高不确定性区域采样，如 $x_2$，这可能导致发现新的最优点）。PI 因为“对幅度不敏感”，可能会陷入对局部小改进的利用中，而无法探索具有高潜在增益的区域。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\Phi\\left(\\frac{\\mu(x) - f^{\\star} - \\xi}{\\sigma(x)}\\right) & 0.3085 \\end{pmatrix}}$$"
        }
    ]
}