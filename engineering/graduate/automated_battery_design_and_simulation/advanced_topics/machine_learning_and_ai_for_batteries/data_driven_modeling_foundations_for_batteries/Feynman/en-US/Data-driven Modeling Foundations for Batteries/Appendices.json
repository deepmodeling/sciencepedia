{
    "hands_on_practices": [
        {
            "introduction": "High-fidelity battery models, such as the Doyle-Fuller-Newman (DFN) framework, can be mathematically complex with numerous interacting parameters. This exercise demonstrates the power of nondimensionalization, a fundamental technique used to simplify complex models and uncover the core physical relationships governing system behavior. By recasting the governing equations into a dimensionless form, you will derive and interpret key parameter groupings like the Damköhler number and Thiele modulus, gaining insight into the competition between reaction kinetics and mass transport limitations without needing to run a full simulation .",
            "id": "3904421",
            "problem": "Consider a porous electrode in a lithium-ion battery modeled by the Doyle–Fuller–Newman (DFN) framework, where the active material consists of spherical particles of radius $R_{p}$ embedded in a matrix. The electrode has thickness $L$, cross-sectional area $A$, solid-phase volume fraction $\\epsilon_{s}$, and internal active surface area density $a_{s}$ (total internal reaction area per unit electrode volume). The solid-phase lithium concentration inside a particle, $c_{s}(r,t)$, evolves according to Fickian diffusion with spherical symmetry, and the interfacial reaction at the particle surface is described by Butler–Volmer kinetics. Assume isothermal operation and constant applied current $I$.\n\nStarting from conservation of mass in the solid phase and the definition of diffusive flux, the solid-state concentration $c_{s}(r,t)$ obeys\n$$\n\\frac{\\partial c_{s}}{\\partial t} \\;=\\; \\frac{D_{s}}{r^{2}} \\,\\frac{\\partial}{\\partial r}\\!\\left( r^{2}\\,\\frac{\\partial c_{s}}{\\partial r} \\right),\n$$\nwith boundary condition at the particle surface\n$$\n-D_{s}\\,\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R_{p}} \\;=\\; \\frac{j}{F},\n$$\nwhere $D_{s}$ is the solid-phase diffusion coefficient, $j$ is the interfacial current density (reaction rate per unit area), and $F$ is the Faraday constant. The particle center symmetry condition implies $\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0}=0$. Under the assumption of uniform reaction distribution across the electrode thickness, conservation of charge in the porous electrode gives the relation between the applied current and the interfacial current density,\n$$\n\\frac{I}{A} \\;=\\; a_{s}\\,L\\,j.\n$$\n\nNear a chosen reference state of charge and small overpotential, linearize the Butler–Volmer kinetics to a first-order form $j \\approx F\\,\\kappa\\,c_{s,\\mathrm{surf}}$, where $\\kappa$ is a constant kinetic coefficient and $c_{s,\\mathrm{surf}}$ is the surface solid concentration. Let the solid concentration scale be $c_{s}^{\\ast} = c_{s,\\mathrm{max}}$ (the maximum solid concentration), the radial coordinate scale be $r^{\\ast} = R_{p}$, and the time scale be $t^{\\ast} = R_{p}^{2}/D_{s}$ (the particle diffusion time). Introduce dimensionless variables $\\tilde{r} = r/R_{p}$, $\\tilde{t} = t\\,D_{s}/R_{p}^{2}$, and $\\tilde{c}_{s} = c_{s}/c_{s,\\mathrm{max}}$.\n\na) Using these scales, nondimensionalize the particle diffusion equation and boundary condition to identify the Damköhler number $Da$ that multiplies the dimensionless boundary flux at $\\tilde{r}=1$. Express $Da$ in terms of the primitive dimensional parameters $\\{I,\\,A,\\,L,\\,a_{s},\\,R_{p},\\,D_{s},\\,c_{s,\\mathrm{max}},\\,F\\}$.\n\nb) By comparing the characteristic interfacial kinetic rate to the particle diffusion rate, define the particle-scale Thiele modulus $\\phi$ that captures the competition between interfacial kinetics and solid-state diffusion under the above linearization. Express $\\phi$ in terms of $\\{a_{s},\\,\\kappa,\\,R_{p},\\,D_{s}\\}$.\n\nc) Define a C-rate-like dimensionless group $C$ as the ratio of the particle diffusion time scale $t^{\\ast}$ to the discharge time $t_{\\mathrm{dis}}$ implied by the applied current and the total solid-phase lithium inventory per electrode area, i.e., $t_{\\mathrm{dis}} = \\frac{F\\,A\\,L\\,\\epsilon_{s}\\,c_{s,\\mathrm{max}}}{I}$. Express $C$ in terms of $\\{I,\\,A,\\,L,\\,\\epsilon_{s},\\,c_{s,\\mathrm{max}},\\,R_{p},\\,D_{s},\\,F\\}$.\n\nd) Consider the composite grouping\n$$\nG \\;\\equiv\\; \\frac{\\phi^{2}}{Da}\\,C.\n$$\nSimplify $G$ to a single closed-form analytic expression in terms of the primitive dimensional parameters $\\{a_{s},\\,\\kappa,\\,R_{p},\\,D_{s},\\,\\epsilon_{s}\\}$. No rounding is required. Provide this simplified expression for $G$ as your final answer.\n\nIn your derivation, briefly interpret the regimes associated with $Da \\ll 1$ versus $Da \\gg 1$, $\\phi \\ll 1$ versus $\\phi \\gg 1$, and $C \\ll 1$ versus $C \\gg 1$, in terms of transport limitation versus kinetic limitation. The final answer must be the simplified symbolic expression for $G$ only, with no units included in the final boxed expression.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It is based on the standard Doyle–Fuller–Newman (DFN) model for lithium-ion batteries and employs standard techniques of nondimensionalization from transport phenomena. All necessary information is provided, and the questions lead to a unique, verifiable result. Therefore, the problem is deemed valid. We proceed with the solution.\n\nThe solution is divided into four parts as requested by the problem statement.\n\na) Nondimensionalization and the Damköhler number $Da$\n\nWe begin with the governing partial differential equation for the solid-phase concentration $c_{s}(r,t)$:\n$$\n\\frac{\\partial c_{s}}{\\partial t} \\;=\\; \\frac{D_{s}}{r^{2}} \\,\\frac{\\partial}{\\partial r}\\!\\left( r^{2}\\,\\frac{\\partial c_{s}}{\\partial r} \\right)\n$$\nWe introduce the dimensionless variables $\\tilde{c}_{s} = c_{s}/c_{s,\\mathrm{max}}$, $\\tilde{r} = r/R_{p}$, and $\\tilde{t} = t\\,D_{s}/R_{p}^{2}$. The chain rule is used to transform the derivatives:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tilde{t}}{\\partial t} \\frac{\\partial}{\\partial \\tilde{t}} = \\frac{D_{s}}{R_{p}^{2}} \\frac{\\partial}{\\partial \\tilde{t}}\n$$\n$$\n\\frac{\\partial}{\\partial r} = \\frac{\\partial \\tilde{r}}{\\partial r} \\frac{\\partial}{\\partial \\tilde{r}} = \\frac{1}{R_{p}} \\frac{\\partial}{\\partial \\tilde{r}}\n$$\nSubstituting these into the governing equation:\n$$\n\\frac{\\partial (c_{s,\\mathrm{max}} \\tilde{c}_{s})}{\\partial t} = c_{s,\\mathrm{max}} \\frac{D_{s}}{R_{p}^{2}} \\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{t}}\n$$\n$$\n\\frac{D_{s}}{r^{2}} \\,\\frac{\\partial}{\\partial r}\\!\\left( r^{2}\\,\\frac{\\partial c_{s}}{\\partial r} \\right) = \\frac{D_{s}}{(\\tilde{r}R_{p})^{2}} \\frac{1}{R_{p}} \\frac{\\partial}{\\partial \\tilde{r}}\\!\\left( (\\tilde{r}R_{p})^{2}\\,\\frac{1}{R_{p}}\\frac{\\partial (c_{s,\\mathrm{max}} \\tilde{c}_{s})}{\\partial \\tilde{r}} \\right) = \\frac{D_{s} c_{s,\\mathrm{max}}}{R_{p}^{2}} \\frac{1}{\\tilde{r}^{2}} \\frac{\\partial}{\\partial \\tilde{r}}\\!\\left(\\tilde{r}^{2} \\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{r}}\\right)\n$$\nEquating the two expressions and canceling common terms yields the dimensionless diffusion equation:\n$$\n\\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{t}} = \\frac{1}{\\tilde{r}^{2}} \\frac{\\partial}{\\partial \\tilde{r}}\\!\\left(\\tilde{r}^{2} \\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{r}}\\right)\n$$\nNext, we nondimensionalize the boundary condition at the particle surface $r=R_{p}$ (or $\\tilde{r}=1$):\n$$\n-D_{s}\\,\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R_{p}} \\;=\\; \\frac{j}{F}\n$$\nSubstituting the dimensionless variables and the given expression for the interfacial current density $j = I/(A a_{s} L)$:\n$$\n-D_{s}\\,\\left.\\frac{c_{s,\\mathrm{max}}}{R_{p}}\\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{r}}\\right|_{\\tilde{r}=1} \\;=\\; \\frac{I}{A a_{s} L F}\n$$\nRearranging to isolate the dimensionless gradient:\n$$\n\\left.\\frac{\\partial \\tilde{c}_{s}}{\\partial \\tilde{r}}\\right|_{\\tilde{r}=1} \\;=\\; - \\frac{I R_{p}}{A a_{s} L F D_{s} c_{s,\\mathrm{max}}}\n$$\nThe problem specifies a boundary condition where the Damköhler number $Da$ multiplies a dimensionless flux. In this context, the entire right-hand side represents the prescribed dimensionless flux (up to a sign). Therefore, we identify the Damköhler number as:\n$$\nDa = \\frac{I R_{p}}{A a_{s} L F D_{s} c_{s,\\mathrm{max}}}\n$$\nThe Damköhler number $Da$ is the ratio of the characteristic diffusion time $\\tau_{\\mathrm{diff}} = R_{p}^{2}/D_{s}$ to a characteristic particle filling time $\\tau_{\\mathrm{fill}}$ due to the imposed current. For $Da \\ll 1$, diffusion is much faster than the filling rate, leading to small concentration gradients within the particle (kinetically/externally limited). For $Da \\gg 1$, diffusion is much slower than the filling rate, causing large concentration gradients to build up (diffusion limited).\n\nb) The particle-scale Thiele modulus $\\phi$\n\nThe Thiele modulus $\\phi$ captures the competition between a reaction rate and a diffusion rate. The problem asks for a particle-scale modulus based on the linearized kinetics $j \\approx F \\kappa c_{s,\\mathrm{surf}}$ and expressed in terms of $\\{a_{s}, \\kappa, R_{p}, D_{s}\\}$. A Thiele modulus squared is often defined as the ratio of a characteristic diffusion time to a characteristic reaction time, $\\phi^{2} = \\tau_{\\mathrm{diff}} / \\tau_{\\mathrm{react}}$.\nThe diffusion time is $\\tau_{\\mathrm{diff}} = R_{p}^{2}/D_{s}$.\nThe reaction time scale must be constructed from the given parameters. The term $a_{s}\\kappa$ has units of $(m^{-1}) \\cdot (m/s) = s^{-1}$, which corresponds to a first-order reaction rate constant, let's call it $k_{\\mathrm{eff}}$. The characteristic reaction time is then $\\tau_{\\mathrm{react}} = 1/k_{\\mathrm{eff}} = 1/(a_{s}\\kappa)$.\nUsing this definition, the Thiele modulus squared is:\n$$\n\\phi^{2} = \\frac{\\tau_{\\mathrm{diff}}}{\\tau_{\\mathrm{react}}} = \\frac{R_{p}^{2}/D_{s}}{1/(a_{s}\\kappa)} = \\frac{a_{s} \\kappa R_{p}^{2}}{D_{s}}\n$$\nTaking the square root gives the Thiele modulus:\n$$\n\\phi = R_{p} \\sqrt{\\frac{a_{s} \\kappa}{D_{s}}}\n$$\nThis modulus compares the surface reaction rate to the solid-state diffusion rate. For $\\phi \\ll 1$, diffusion within the particle is fast compared to the surface reaction, resulting in a nearly uniform internal concentration (kinetically limited). For $\\phi \\gg 1$, the surface reaction is fast compared to diffusion, leading to a depletion of reactants at the surface and large internal concentration gradients (diffusion limited).\n\nc) The C-rate-like dimensionless group $C$\n\nThe group $C$ is defined as the ratio of the particle diffusion time scale $t^{\\ast}$ to the total discharge time $t_{\\mathrm{dis}}$.\nThe given definitions are:\n$$\nt^{\\ast} = \\frac{R_{p}^{2}}{D_{s}}\n$$\n$$\nt_{\\mathrm{dis}} = \\frac{F\\,A\\,L\\,\\epsilon_{s}\\,c_{s,\\mathrm{max}}}{I}\n$$\nThe ratio is therefore:\n$$\nC = \\frac{t^{\\ast}}{t_{\\mathrm{dis}}} = \\frac{R_{p}^{2}/D_{s}}{F A L \\epsilon_{s} c_{s,\\mathrm{max}}/I} = \\frac{I R_{p}^{2}}{A L D_{s} F \\epsilon_{s} c_{s,\\mathrm{max}}}\n$$\nThis group compares the time scale for diffusion within a single particle to the time scale for discharging the entire electrode. For $C \\ll 1$, the applied current is low (low C-rate), and diffusion has ample time to equilibrate within particles relative to the overall discharge process. For $C \\gg 1$, the applied current is high (high C-rate), and the discharge is so fast that particles cannot internally equilibrate, leading to poor material utilization.\n\nd) Simplification of the composite group $G$\n\nThe composite group $G$ is defined as:\n$$\nG \\equiv\\; \\frac{\\phi^{2}}{Da}\\,C\n$$\nSubstituting the expressions derived in the previous parts:\n$$\n\\phi^{2} = \\frac{a_{s} \\kappa R_{p}^{2}}{D_{s}}\n$$\n$$\nDa = \\frac{I R_{p}}{A a_{s} L F D_{s} c_{s,\\mathrm{max}}}\n$$\n$$\nC = \\frac{I R_{p}^{2}}{A L D_{s} F \\epsilon_{s} c_{s,\\mathrm{max}}}\n$$\nWe assemble the expression for $G$:\n$$\nG = \\left( \\frac{a_{s} \\kappa R_{p}^{2}}{D_{s}} \\right) \\left( \\frac{A a_{s} L F D_{s} c_{s,\\mathrm{max}}}{I R_{p}} \\right) \\left( \\frac{I R_{p}^{2}}{A L D_{s} F \\epsilon_{s} c_{s,\\mathrm{max}}} \\right)\n$$\nWe can now cancel terms between the numerator and denominator:\n$$\nG = \\frac{(a_{s} \\kappa R_{p}^{2}) (A a_{s} L F D_{s} c_{s,\\mathrm{max}}) (I R_{p}^{2})}{(D_{s}) (I R_{p}) (A L D_{s} F \\epsilon_{s} c_{s,\\mathrm{max}})}\n$$\nThe terms $I$, $A$, $L$, $F$, and $c_{s,\\mathrm{max}}$ cancel out.\nOne $D_{s}$ from the numerator cancels one from the denominator.\nThis leaves:\n$$\nG = \\frac{(a_{s} \\kappa R_{p}^{2}) (a_{s}) (R_{p}^{2})}{(1) (R_{p}) (D_{s} \\epsilon_{s})} = \\frac{a_{s}^{2} \\kappa R_{p}^{4}}{D_s \\epsilon_{s} R_{p}}\n$$\nSimplifying the powers of $R_{p}$:\n$$\nG = \\frac{a_{s}^{2} \\kappa R_{p}^{3}}{\\epsilon_{s} D_{s}}\n$$\nThis is the final simplified expression for the composite group $G$.\nA dimensional analysis confirms that $G$ is dimensionless:\n$$\n[G] = \\frac{(m^{-1})^{2} (m \\cdot s^{-1}) (m)^{3}}{(-) (m^{2} \\cdot s^{-1})} = \\frac{m^{-2} \\cdot m \\cdot s^{-1} \\cdot m^{3}}{m^{2} \\cdot s^{-1}} = \\frac{m^{2} \\cdot s^{-1}}{m^{2} \\cdot s^{-1}} = 1\n$$\nThe expression is dimensionally consistent and derived from the previous valid steps.",
            "answer": "$$\\boxed{\\frac{a_{s}^{2} \\kappa R_{p}^{3}}{\\epsilon_{s} D_{s}}}$$"
        },
        {
            "introduction": "A data-driven model is only as reliable as its parameters, which are typically calibrated from experimental measurements. However, not all parameters are equally \"visible\" in the data. This practice introduces Fisher Information Matrix (FIM) analysis as a rigorous method to assess parameter identifiability before attempting a costly fitting procedure. Using a simplified thermal model, you will learn how to use sensitivity analysis to quantify how much information an experiment provides about a specific parameter, a critical skill for designing effective experiments and ensuring robust model calibration .",
            "id": "3904397",
            "problem": "Consider a prismatic lithium-ion battery cell whose near-surface thermal behavior over short times is well-approximated by one-dimensional semi-infinite heat conduction into the solid. Let the temperature field be $T(x,t)$ for position $x \\geq 0$ and time $t \\geq 0$, and let the thermal conductivity be $k$, the mass density be $\\rho$, and the specific heat capacity be $c_{p}$. The thermal diffusivity is defined by $\\alpha = k/(\\rho c_{p})$. The governing equation and boundary/initial conditions under a controlled experiment are:\n$$\\rho c_{p} \\,\\frac{\\partial T}{\\partial t} = k \\,\\frac{\\partial^{2} T}{\\partial x^{2}}, \\quad x > 0, \\quad t > 0,$$\nwith initial condition\n$$T(x,0) = 0,$$\nand a prescribed surface heat flux input at $x=0$,\n$$-k \\,\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q''(t),$$\nwhere $q''(t)$ is a known, externally applied heat flux. In this experiment, the applied flux is a constant step $q''(t) = q''_{0}$ for $t \\geq 0$ with $q''_{0} > 0$. The measurement is the external surface temperature $T_{s}(t) \\equiv T(0,t)$ recorded at discrete times $t_{i} = i\\,\\Delta t$ for $i = 1,2,\\dots,M$, with independent, zero-mean Gaussian measurement noise of variance $\\sigma^{2}$ per sample. You seek to investigate identifiability of $k$ from these measurements using a sensitivity-based Fisher Information Matrix (FIM) analysis. For a single parameter $k$, the Fisher information reduces to the scalar\n$$I(k) = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{M} \\left(\\frac{\\partial T_{s}(t_{i})}{\\partial k}\\right)^{2}.$$\nStarting from the heat equation and boundary conditions above, derive the functional dependence of $T_{s}(t)$ on $k$ and compute the sensitivity $\\partial T_{s}(t)/\\partial k$. Then, derive a closed-form expression for $I(k)$ in terms of $q''_{0}$, $\\rho$, $c_{p}$, $\\sigma^{2}$, $\\Delta t$, $M$, and $k$. Finally, evaluate $I(k)$ numerically for the following scientifically realistic parameter values:\n- $\\rho = 2.5 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$,\n- $c_{p} = 1.0 \\times 10^{3}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $q''_{0} = 5.0 \\times 10^{3}\\,\\mathrm{W\\,m^{-2}}$,\n- $\\Delta t = 1.0\\,\\mathrm{s}$,\n- $M = 100$,\n- $\\sigma = 5.0 \\times 10^{-2}\\,\\mathrm{K}$,\n- $k = 1.2\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$.\nExpress the final Fisher information in $\\mathrm{m^{2}\\,K^{2}\\,W^{-2}}$. Round your final numerical answer to four significant figures.",
            "solution": "The problem requires deriving the Fisher Information for the thermal conductivity parameter $k$ based on a semi-infinite heat conduction experiment.\n\nFirst, we find the expression for the surface temperature $T_s(t) = T(0, t)$. The problem describes one-dimensional transient heat conduction in a semi-infinite solid ($x \\ge 0$) with a constant surface heat flux $q''_0$. The governing equation is the heat equation $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$, where $\\alpha = k/(\\rho c_p)$. The initial condition is $T(x,0)=0$, and the boundary condition is $-k \\frac{\\partial T}{\\partial x}|_{x=0} = q''_0$.\n\nThe standard solution for the surface temperature under these conditions (from sources such as Carslaw and Jaeger, *Conduction of Heat in Solids*) is:\n$$T_s(t) = \\frac{2q''_0 \\sqrt{\\alpha t}}{k\\sqrt{\\pi}}$$\nSubstituting the definition of thermal diffusivity $\\alpha = k/(\\rho c_p)$:\n$$T_s(t) = \\frac{2q''_0 \\sqrt{t}}{k\\sqrt{\\pi}}\\sqrt{\\frac{k}{\\rho c_p}} = \\frac{2q''_0 \\sqrt{t}}{\\sqrt{\\pi \\rho c_p k}}$$\nThis shows that the surface temperature is proportional to $k^{-1/2}$.\n\nNext, we compute the sensitivity of the measurement, $\\frac{\\partial T_s(t)}{\\partial k}$:\n$$\\frac{\\partial T_s(t)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ \\left(\\frac{2q''_0 \\sqrt{t}}{\\sqrt{\\pi \\rho c_p}}\\right) k^{-1/2} \\right]$$\n$$\\frac{\\partial T_s(t)}{\\partial k} = \\left(\\frac{2q''_0 \\sqrt{t}}{\\sqrt{\\pi \\rho c_p}}\\right) \\left(-\\frac{1}{2} k^{-3/2}\\right) = -\\frac{q''_0 \\sqrt{t}}{k^{3/2}\\sqrt{\\pi \\rho c_p}}$$\n\nNow, we can formulate the Fisher information, $I(k)$. For discrete measurements at times $t_i = i\\,\\Delta t$:\n$$I(k) = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{M} \\left(\\frac{\\partial T_{s}(t_{i})}{\\partial k}\\right)^{2} = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{M} \\left(-\\frac{q''_0 \\sqrt{t_i}}{k^{3/2}\\sqrt{\\pi \\rho c_p}}\\right)^{2}$$\n$$I(k) = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{M} \\frac{(q''_0)^2 t_i}{k^3 \\pi \\rho c_p} = \\frac{(q''_0)^2}{\\sigma^2 k^3 \\pi \\rho c_p} \\sum_{i=1}^{M} t_i$$\nThe sum of the time points is $\\sum_{i=1}^{M} t_i = \\sum_{i=1}^{M} i\\,\\Delta t = \\Delta t \\sum_{i=1}^{M} i = \\Delta t \\frac{M(M+1)}{2}$.\nSubstituting this back gives the final closed-form expression for the Fisher information:\n$$I(k) = \\frac{(q''_0)^2 \\Delta t M(M+1)}{2\\sigma^2 k^3 \\pi \\rho c_p}$$\n\nFinally, we substitute the given numerical values:\n- $\\rho c_p = (2.5 \\times 10^3) \\times (1.0 \\times 10^3) = 2.5 \\times 10^6 \\, \\mathrm{J\\,m^{-3}\\,K^{-1}}$\n- $q''_0 = 5.0 \\times 10^3 \\, \\mathrm{W\\,m^{-2}}$\n- $\\Delta t = 1.0 \\, \\mathrm{s}$\n- $M = 100$\n- $\\sigma^2 = (5.0 \\times 10^{-2})^2 = 2.5 \\times 10^{-3} \\, \\mathrm{K^2}$\n- $k = 1.2 \\, \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n\n$$I(k) = \\frac{(5.0 \\times 10^3)^2 \\times (1.0) \\times 100(100+1)}{2 \\times (2.5 \\times 10^{-3}) \\times (1.2)^3 \\times \\pi \\times (2.5 \\times 10^6)}$$\n$$I(k) = \\frac{(2.5 \\times 10^7) \\times (10100)}{2 \\times (2.5 \\times 10^{-3}) \\times 1.728 \\times \\pi \\times (2.5 \\times 10^6)}$$\n$$I(k) = \\frac{2.525 \\times 10^{11}}{ (5.0 \\times 10^{-3}) \\times 1.728 \\times \\pi \\times (2.5 \\times 10^6) }$$\n$$I(k) = \\frac{2.525 \\times 10^{11}}{ 67858.40... } \\approx 3720983.4 \\, \\mathrm{m^2\\,K^2\\,W^{-2}}$$\nRounding the result to four significant figures gives $3.721 \\times 10^6$.",
            "answer": "$$\\boxed{3.721 \\times 10^{6}}$$"
        },
        {
            "introduction": "While physics-based models offer deep insight, their computational expense often makes them impractical for real-time control or large-scale design automation. This hands-on exercise tackles this challenge by guiding you through model order reduction, a systematic process for creating computationally efficient surrogate models. You will implement the balanced truncation algorithm, which leverages the core concepts of controllability and observability to identify and retain only the most dynamically significant states, providing a foundational skill for developing the fast and accurate models required for advanced battery management systems and automated design workflows .",
            "id": "3904356",
            "problem": "You are tasked with designing and implementing a complete, runnable program that performs balanced truncation for a linearized Doyle–Fuller–Newman (DFN) battery model around a specified operating point, and quantitatively assesses the sufficiency of the reduced-order model by computing the fraction of retained Hankel singular values. The derivation and implementation must proceed from first principles of state-space modeling, linearization, and energy-based controllability and observability characterizations for linear time-invariant systems. The problem is framed purely in mathematical terms, but the chosen parameters are representative of physically realistic battery dynamics. No external input is required; all parameters are provided below.\n\nYou will approximate the linearized DFN small-signal behavior using a rational state-space model that captures diffusion-driven dynamics via a finite set of first-order modes, which is a standard surrogate for the diffusion impedance arising from the DFN partial differential equations. The continuous-time system is of the form $\\dot{\\mathbf{x}}(t)=\\mathbf{A}\\mathbf{x}(t)+\\mathbf{B}u(t)$ and $y(t)=\\mathbf{C}\\mathbf{x}(t)$, where $u(t)$ is a scalar current perturbation input (in amperes) and $y(t)$ is the terminal voltage perturbation output (in volts). The states and parameters are selected so that $\\mathbf{A}$ is stable, ensuring well-defined energy measures. The target quantity to report for each test case is the decimal fraction of the sum of the $r$ largest Hankel singular values retained after truncation to order $r$, divided by the sum of all Hankel singular values of the original full-order model. The retained fraction is unitless.\n\nYour program must implement the following tasks for each provided test case:\n- Construct the continuous-time, linear time-invariant state-space matrices $\\mathbf{A}$, $\\mathbf{B}$, and $\\mathbf{C}$ using the provided lists of time constants and weights, representing a rational approximation of diffusion in the solid and electrolyte phases. The construction is as follows: each state corresponds to a diffusion mode with a time constant (in seconds), with linear dynamics driven by the input and contributing linearly to the output. The matrix $\\mathbf{A}$ is diagonal with entries $-\\frac{1}{\\tau_i}$, the vector $\\mathbf{B}$ contains the input coupling weights, and the row vector $\\mathbf{C}$ contains the output sensitivity weights. All given time constants are in seconds; all weights are dimensionless couplings. The resulting matrices should produce a stable system.\n- Perform balanced truncation of order $r$ based on the energy characterizations of controllability and observability for stable continuous-time linear time-invariant systems. Construct the balancing transformation from these energy measures and form the reduced model by retaining the most energy-relevant states. Do not rely on prepackaged model reduction routines; the algorithm must be implemented using fundamental linear algebra operations.\n- Compute the Hankel singular values of the full-order model and quantify the retained fraction after truncation, defined as the sum of the $r$ largest Hankel singular values divided by the sum of all Hankel singular values. This fraction is a unitless decimal number.\n\nYour program should process the following test suite, where each test case is specified as a tuple containing the solid-phase time constants, solid-phase input weights, solid-phase output weights, electrolyte-phase time constants, electrolyte-phase input weights, electrolyte-phase output weights, and the reduced order $r$. All time constants are in seconds. The input and output weights are dimensionless couplings consistent with linearized DFN behavior. The output for each test case must be the retained fraction (a float). The system must ensure scientific realism: $\\mathbf{A}$ must be stable, and weights must be nonnegative with magnitudes that reflect plausible controllability and observability.\n\nTest Suite:\n1. Happy path with well-separated diffusion modes:\n   - Solid-phase time constants: $[10^{-2}, 10^{-1}, 1, 10, 100]$ (seconds)\n   - Solid-phase input weights: $[0.6, 0.4, 0.3, 0.2, 0.1]$\n   - Solid-phase output weights: $[0.8, 0.5, 0.4, 0.2, 0.1]$\n   - Electrolyte-phase time constants: $[5\\times 10^{-3}, 5\\times 10^{-2}, 0.5]$ (seconds)\n   - Electrolyte-phase input weights: $[0.2, 0.1, 0.05]$\n   - Electrolyte-phase output weights: $[0.3, 0.15, 0.08]$\n   - Reduced order: $r=3$\n2. Boundary case with no truncation:\n   - Same parameters as Case 1\n   - Reduced order: $r=8$ (equal to the full order)\n3. Edge case with a nearly uncontrollable and unobservable slow mode:\n   - Solid-phase time constants: $[2\\times 10^{-2}, 2\\times 10^{-1}, 2, 20, 200]$ (seconds)\n   - Solid-phase input weights: $[0.5, 0.3, 0.1, 0.01, 10^{-6}]$\n   - Solid-phase output weights: $[0.7, 0.4, 0.2, 0.01, 10^{-6}]$\n   - Electrolyte-phase time constants: $[10^{-2}, 10^{-1}]$ (seconds)\n   - Electrolyte-phase input weights: $[0.2, 0.05]$\n   - Electrolyte-phase output weights: $[0.25, 0.1]$\n   - Reduced order: $r=4$\n4. Clustered time constants requiring more modes to capture energy:\n   - Solid-phase time constants: $[0.5, 0.6, 0.7, 0.8]$ (seconds)\n   - Solid-phase input weights: $[0.3, 0.3, 0.3, 0.3]$\n   - Solid-phase output weights: $[0.3, 0.3, 0.3, 0.3]$\n   - Electrolyte-phase time constants: $[0.05, 0.06]$ (seconds)\n   - Electrolyte-phase input weights: $[0.1, 0.1]$\n   - Electrolyte-phase output weights: $[0.1, 0.1]$\n   - Reduced order: $r=2$\n\nFinal Output Format:\nYour program should produce a single line of output containing the retained fractions for the four test cases, formatted as a comma-separated list enclosed in square brackets, for example, \"[f1,f2,f3,f4]\". Each entry must be a float. No other text should be printed.\n\nConstraints and Notes:\n- Angles are not involved in this problem.\n- Physical units: time constants are given in seconds; the retained fraction is unitless.\n- You may use standard numerical linear algebra operations to compute energy measures and construct the balancing transformation.\n- Design for numerical stability and robustness when computing the Hankel singular values. Ensure the stability of $\\mathbf{A}$ and handle small numerical errors in eigenvalue computations appropriately. The program must run without any user input or external resources.",
            "solution": "The user has requested the design and implementation of an algorithm to perform balanced truncation on a linearized battery model and to quantify the model reduction error. The problem is well-defined, scientifically sound, and can be solved using established principles of control theory.\n\n### Principle-Based Design\n\nThe problem centers on the balanced truncation of a continuous-time, linear time-invariant (LTI) state-space system of the form:\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B}u(t)\n$$\n$$\ny(t) = \\mathbf{C}\\mathbf{x}(t)\n$$\nwhere $\\mathbf{x} \\in \\mathbb{R}^n$ is the state vector, $u \\in \\mathbb{R}$ is the scalar input (current), and $y \\in \\mathbb{R}$ is the scalar output (voltage). The system is constructed to be stable, meaning all eigenvalues of the matrix $\\mathbf{A}$ have negative real parts.\n\nThe core idea of balanced truncation is to find a new state representation, $\\mathbf{z}(t) = \\mathbf{T}^{-1}\\mathbf{x}(t)$, where the states are simultaneously easy to control (reachable from the input) and easy to observe (their effect is visible at the output). This \"importance\" of each state is quantified by the Hankel singular values (HSVs). States corresponding to small HSVs are weakly coupled to the input-output behavior and can be truncated with minimal loss of fidelity.\n\n#### 1. System Construction\nFor each test case, we are given a set of time constants $\\{\\tau_i\\}$, input coupling weights $\\{b_i\\}$, and output sensitivity weights $\\{c_i\\}$. These are combined from the solid-phase and electrolyte-phase descriptions to form a single full-order model. The state-space matrices for the $n$-dimensional system are constructed as follows:\n- The state dynamics matrix $\\mathbf{A}$ is a diagonal matrix whose entries are the negative reciprocals of the time constants, representing the stable first-order dynamics of each diffusion mode:\n  $$\n  \\mathbf{A} = \\text{diag}\\left(-\\frac{1}{\\tau_1}, -\\frac{1}{\\tau_2}, \\dots, -\\frac{1}{\\tau_n}\\right)\n  $$\n  Since all $\\tau_i > 0$, all eigenvalues of $\\mathbf{A}$ are strictly negative, guaranteeing system stability.\n- The input matrix $\\mathbf{B}$ is a column vector of the input weights:\n  $$\n  \\mathbf{B} = [b_1, b_2, \\dots, b_n]^T\n  $$\n- The output matrix $\\mathbf{C}$ is a row vector of the output weights:\n  $$\n  \\mathbf{C} = [c_1, c_2, \\dots, c_n]\n  $$\n\n#### 2. Controllability and Observability Gramians\nThe controllability and observability of the system are characterized by their respective Gramians, $W_c$ and $W_o$. For a stable continuous-time LTI system, these are the unique, symmetric, positive semi-definite solutions to the continuous-time Lyapunov equations:\n$$\n\\mathbf{A}W_c + W_c\\mathbf{A}^T + \\mathbf{B}\\mathbf{B}^T = 0 \\quad (\\text{Controllability Gramian } W_c)\n$$\n$$\n\\mathbf{A}^TW_o + W_o\\mathbf{A} + \\mathbf{C}^T\\mathbf{C} = 0 \\quad (\\text{Observability Gramian } W_o)\n$$\nThe controllability Gramian $W_c$ quantifies the energy required to drive the state to any particular value, while the observability Gramian $W_o$ quantifies the energy produced at the output by a given initial state. These equations can be solved numerically using standard linear algebra routines.\n\n#### 3. Hankel Singular Values (HSVs)\nThe Hankel singular values, $\\{\\sigma_i\\}_{i=1}^n$, are the primary measure of a state's importance to the input-output energy transfer. They are defined as the square roots of the eigenvalues of the product of the Gramians:\n$$\n\\sigma_i = \\sqrt{\\lambda_i(W_c W_o)}\n$$\nA numerically superior method for computing the HSVs, which avoids the potentially ill-conditioned product $W_c W_o$, is based on Cholesky factorization and Singular Value Decomposition (SVD).\n1.  Compute the Cholesky factorizations of the Gramians: $W_c = L_c L_c^T$ and $W_o = L_o L_o^T$, where $L_c$ and $L_o$ are lower-triangular matrices.\n2.  The Hankel singular values are the singular values of the matrix product $L_o^T L_c$.\n    $$\n    \\{\\sigma_i\\} = \\text{svd}(L_o^T L_c)\n    $$\n    This method is robust and accurate. The HSVs are sorted in descending order, $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_n \\ge 0$.\n\n#### 4. Model Truncation and Error Quantification\nA reduced-order model of order $r < n$ is formed by retaining the $r$ states corresponding to the $r$ largest Hankel singular values. The key insight of balanced truncation is that the error introduced by this truncation is bounded by the sum of the discarded HSVs.\n\nThe problem asks for the fraction of the total \"energy\" (as captured by the sum of HSVs) retained by the reduced-order model. This is a direct measure of the sufficiency of the approximation. The retained fraction, $f$, is calculated as:\n$$\nf = \\frac{\\sum_{i=1}^{r} \\sigma_i}{\\sum_{i=1}^{n} \\sigma_i}\n$$\nwhere $r$ is the order of the reduced model and $n$ is the order of the full model. This fraction provides a quantitative assessment of how well the $r$-state model captures the dynamics of the original $n$-state system.\n\nThe algorithm proceeds by implementing these steps for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_continuous_lyapunov, cholesky, svd\n\ndef solve():\n    \"\"\"\n    Solves the balanced truncation problem for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy path\n        {\n            \"solid_tau\": [1e-2, 1e-1, 1, 10, 100],\n            \"solid_b\": [0.6, 0.4, 0.3, 0.2, 0.1],\n            \"solid_c\": [0.8, 0.5, 0.4, 0.2, 0.1],\n            \"electrolyte_tau\": [5e-3, 5e-2, 0.5],\n            \"electrolyte_b\": [0.2, 0.1, 0.05],\n            \"electrolyte_c\": [0.3, 0.15, 0.08],\n            \"r\": 3\n        },\n        # Case 2: Boundary case (no truncation)\n        {\n            \"solid_tau\": [1e-2, 1e-1, 1, 10, 100],\n            \"solid_b\": [0.6, 0.4, 0.3, 0.2, 0.1],\n            \"solid_c\": [0.8, 0.5, 0.4, 0.2, 0.1],\n            \"electrolyte_tau\": [5e-3, 5e-2, 0.5],\n            \"electrolyte_b\": [0.2, 0.1, 0.05],\n            \"electrolyte_c\": [0.3, 0.15, 0.08],\n            \"r\": 8\n        },\n        # Case 3: Edge case (nearly uncontrollable/unobservable mode)\n        {\n            \"solid_tau\": [2e-2, 2e-1, 2, 20, 200],\n            \"solid_b\": [0.5, 0.3, 0.1, 0.01, 1e-6],\n            \"solid_c\": [0.7, 0.4, 0.2, 0.01, 1e-6],\n            \"electrolyte_tau\": [1e-2, 1e-1],\n            \"electrolyte_b\": [0.2, 0.05],\n            \"electrolyte_c\": [0.25, 0.1],\n            \"r\": 4\n        },\n        # Case 4: Clustered time constants\n        {\n            \"solid_tau\": [0.5, 0.6, 0.7, 0.8],\n            \"solid_b\": [0.3, 0.3, 0.3, 0.3],\n            \"solid_c\": [0.3, 0.3, 0.3, 0.3],\n            \"electrolyte_tau\": [0.05, 0.06],\n            \"electrolyte_b\": [0.1, 0.1],\n            \"electrolyte_c\": [0.1, 0.1],\n            \"r\": 2\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Construct the full-order state-space model (A, B, C)\n        \n        # Combine solid and electrolyte parameters\n        tau = np.array(case[\"solid_tau\"] + case[\"electrolyte_tau\"])\n        b_vec = np.array(case[\"solid_b\"] + case[\"electrolyte_b\"])\n        c_vec = np.array(case[\"solid_c\"] + case[\"electrolyte_c\"])\n        \n        n = len(tau) # Full order of the system\n        \n        # A matrix is diagonal with -1/tau_i\n        A = np.diag(-1.0 / tau)\n        \n        # B is a column vector, C is a row vector\n        B = b_vec.reshape((n, 1))\n        C = c_vec.reshape((1, n))\n        \n        # 2. Compute Controllability and Observability Gramians\n        \n        # Solve the continuous-time Lyapunov equation: A*Wc + Wc*A' + B*B' = 0\n        # The solver expects A*X + X*A' = -Q, so Q = B*B'\n        Qc = B @ B.T\n        Wc = solve_continuous_lyapunov(A, -Qc)\n        \n        # Solve A'*Wo + Wo*A + C'*C = 0\n        # The solver expects A*X + X*A' = -Q, we use A' for A and Q = C'*C.\n        Qo = C.T @ C\n        Wo = solve_continuous_lyapunov(A.T, -Qo)\n        \n        # 3. Compute Hankel Singular Values (HSVs)\n        \n        # For numerical stability, compute HSVs via Cholesky and SVD\n        # Wc = Lc * Lc.T, Wo = Lo * Lo.T\n        try:\n            Lc = cholesky(Wc, lower=True)\n            Lo = cholesky(Wo, lower=True)\n        except np.linalg.LinAlgError:\n            # Handle cases where Gramians might not be perfectly positive definite\n            # due to numerical precision issues, although unlikely with stable A.\n            # Add a small identity matrix to regularize.\n            eps = 1e-15\n            Lc = cholesky(Wc + eps * np.identity(n), lower=True)\n            Lo = cholesky(Wo + eps * np.identity(n), lower=True)\n\n        # HSVs are the singular values of Lo.T * Lc\n        # np.linalg.svd returns values in descending order\n        hsv = svd(Lo.T @ Lc, compute_uv=False)\n        \n        # 4. Quantify the retained fraction\n        \n        r = case[\"r\"]\n        \n        # Sum of all HSVs\n        total_hsv_sum = np.sum(hsv)\n        \n        # Sum of the r largest HSVs\n        retained_hsv_sum = np.sum(hsv[:r])\n        \n        # Avoid division by zero if all HSVs are zero (trivial system)\n        if total_hsv_sum > 0:\n            fraction = retained_hsv_sum / total_hsv_sum\n        else:\n            fraction = 1.0 if r > 0 else 0.0\n\n        results.append(fraction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}