{
    "hands_on_practices": [
        {
            "introduction": "复杂的电池仿真会产生高维数据（例如，跨越空间域的电势场）。代理模型的构建通常始于降低此数据的维度，以创建一个更易于处理的表示。本练习  探讨了模型降阶的基石技术——主成分分析（Principal Component Analysis, PCA），通过推导其理论误差界限，帮助我们从根本上理解模型简化度与保真度之间的权衡。",
            "id": "3926888",
            "problem": "锂离子电池电解质域中的一个零均值电解质电势场，在经过空间离散化后，由一个随机向量 $\\boldsymbol{\\phi}\\in\\mathbb{R}^{M}$ 表示，其协方差矩阵为 $\\mathbf{C}=\\mathbb{E}[\\boldsymbol{\\phi}\\boldsymbol{\\phi}^{\\top}]$。假设 $\\mathbf{C}$ 是对称半正定的，其特征分解为 $\\mathbf{C}=\\mathbf{U}\\,\\boldsymbol{\\Lambda}\\,\\mathbf{U}^{\\top}$，其中 $\\mathbf{U}=\\big[\\mathbf{u}_{1},\\dots,\\mathbf{u}_{M}\\big]$ 是标准正交矩阵，$\\boldsymbol{\\Lambda}=\\operatorname{diag}(\\lambda_{1},\\dots,\\lambda_{M})$ 的对角元素为按 $\\lambda_{1}\\ge\\lambda_{2}\\ge\\cdots\\ge\\lambda_{M}\\ge 0$ 排序的特征值。考虑通过向一个 $k$ 维子空间进行正交投影得到的电解质电势场的线性秩-$k$ 代理模型，特别是投影到由前 $k$ 个特征向量张成的子空间（主成分分析 (PCA)）。在整个问题中，使用欧几里得范数，并假设离散化已经过缩放，使得 $\\|\\boldsymbol{\\phi}\\|_{2}^{2}$ 的单位为平方伏特。\n\n任务：\n- 仅从协方差、正交投影和谱定理的定义出发，推导在所有秩-$k$ 线性代理模型中可实现的最小期望平方重构误差 $\\mathbb{E}\\big[\\|\\boldsymbol{\\phi}-\\hat{\\boldsymbol{\\phi}}\\|_{2}^{2}\\big]$ 的表达式，并证明 PCA 代理模型达到了这个最小值。用特征值 $\\{\\lambda_{i}\\}_{i=1}^{M}$ 表示结果。然后，解释其对于电解质电势场的物理意义。\n- 对于一个被离散化为 $M\\ge 5$ 个节点的特定电解质数据集，测量其前五个特征值（单位为平方伏特）为\n$$\n\\lambda_{1}=3.2\\times 10^{-4},\\quad\n\\lambda_{2}=1.6\\times 10^{-4},\\quad\n\\lambda_{3}=8.0\\times 10^{-5},\\quad\n\\lambda_{4}=4.0\\times 10^{-5},\\quad\n\\lambda_{5}=2.0\\times 10^{-5},\n$$\n就本问题而言，所有后续的特征值均可忽略不计。如果使用 $k=2$ 的 PCA 代理模型，计算你的推导所隐含的最小期望平方重构误差界的数值。将你的答案四舍五入到四位有效数字，并以平方伏特为单位表示。",
            "solution": "我们从定义开始。设 $\\boldsymbol{\\phi}\\in\\mathbb{R}^{M}$ 是一个零均值随机向量，其协方差为 $\\mathbf{C}=\\mathbb{E}[\\boldsymbol{\\phi}\\boldsymbol{\\phi}^{\\top}]$。考虑由一个到 $k$ 维子空间的正交投影算子 $\\mathbf{P}$ 形成的任意秩-$k$ 线性代理模型，因此重构为 $\\hat{\\boldsymbol{\\phi}}=\\mathbf{P}\\boldsymbol{\\phi}$，其中 $\\mathbf{P}^{2}=\\mathbf{P}$，$\\mathbf{P}^{\\top}=\\mathbf{P}$，且 $\\operatorname{rank}(\\mathbf{P})=k$。期望平方重构误差为\n$$\n\\mathbb{E}\\big[\\|\\boldsymbol{\\phi}-\\hat{\\boldsymbol{\\phi}}\\|_{2}^{2}\\big]\n=\\mathbb{E}\\big[\\|(\\mathbf{I}-\\mathbf{P})\\boldsymbol{\\phi}\\|_{2}^{2}\\big]\n=\\mathbb{E}\\big[\\boldsymbol{\\phi}^{\\top}(\\mathbf{I}-\\mathbf{P})^{\\top}(\\mathbf{I}-\\mathbf{P})\\boldsymbol{\\phi}\\big].\n$$\n由于 $\\mathbf{P}$ 是一个正交投影算子，$(\\mathbf{I}-\\mathbf{P})^{\\top}(\\mathbf{I}-\\mathbf{P})=\\mathbf{I}-\\mathbf{P}$。利用迹的循环性质以及 $\\mathbb{E}[\\boldsymbol{\\phi}\\boldsymbol{\\phi}^{\\top}]=\\mathbf{C}$ 这一事实，我们有\n$$\n\\mathbb{E}\\big[\\|\\boldsymbol{\\phi}-\\hat{\\boldsymbol{\\phi}}\\|_{2}^{2}\\big]\n=\\mathbb{E}\\big[\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\boldsymbol{\\phi}\\boldsymbol{\\phi}^{\\top}\\big)\\big]\n=\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\,\\mathbb{E}[\\boldsymbol{\\phi}\\boldsymbol{\\phi}^{\\top}]\\big)\n=\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\,\\mathbf{C}\\big).\n$$\n写出谱分解 $\\mathbf{C}=\\mathbf{U}\\boldsymbol{\\Lambda}\\mathbf{U}^{\\top}$ 并定义 $\\tilde{\\mathbf{P}}=\\mathbf{U}^{\\top}\\mathbf{P}\\mathbf{U}$，它也是一个秩为 $k$ 的正交投影算子（合同变换保持幂等性和秩）。那么\n$$\n\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\,\\mathbf{C}\\big)\n=\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\,\\mathbf{U}\\boldsymbol{\\Lambda}\\mathbf{U}^{\\top}\\big)\n=\\operatorname{tr}\\big(\\mathbf{U}^{\\top}(\\mathbf{I}-\\mathbf{P})\\mathbf{U}\\,\\boldsymbol{\\Lambda}\\big)\n=\\operatorname{tr}\\big((\\mathbf{I}-\\tilde{\\mathbf{P}})\\,\\boldsymbol{\\Lambda}\\big).\n$$\n因为 $\\boldsymbol{\\Lambda}$ 是对角元为 $\\lambda_{1},\\dots,\\lambda_{M}$ 的对角矩阵，而 $\\tilde{\\mathbf{P}}$ 是一个秩为 $k$ 的投影算子，所以量 $\\operatorname{tr}((\\mathbf{I}-\\tilde{\\mathbf{P}})\\boldsymbol{\\Lambda})$ 等于那些其下标对应于被投影算子排除的方向的 $\\lambda_{i}$ 的和。在所有秩-$k$ 正交投影算子中，通过选择 $\\tilde{\\mathbf{P}}$ 来选取 $\\boldsymbol{\\Lambda}$ 的 $k$ 个最大对角元，即投影到前 $k$ 个特征向量张成的空间上，可以达到最小值。这是重排不等式或等价的 Ky Fan 最大值原理的结果，该原理指出，对于任何特征值按非增顺序排列的对称矩阵 $\\mathbf{A}$，在所有秩-$k$ 正交投影算子 $\\mathbf{P}$ 上 $\\operatorname{tr}(\\mathbf{P}\\mathbf{A})$ 的最大值是 $\\sum_{i=1}^{k}\\lambda_{i}(\\mathbf{A})$。将此应用于 $\\mathbf{A}=\\mathbf{C}$ 可得\n$$\n\\min_{\\substack{\\mathbf{P}^{\\top}=\\mathbf{P}=\\mathbf{P}^{2}\\\\ \\operatorname{rank}(\\mathbf{P})=k}}\\operatorname{tr}\\big((\\mathbf{I}-\\mathbf{P})\\,\\mathbf{C}\\big)\n=\\operatorname{tr}(\\mathbf{C})-\\max_{\\mathbf{P}}\\operatorname{tr}(\\mathbf{P}\\mathbf{C})\n=\\Big(\\sum_{i=1}^{M}\\lambda_{i}\\Big)-\\Big(\\sum_{i=1}^{k}\\lambda_{i}\\Big)\n=\\sum_{i=k+1}^{M}\\lambda_{i}.\n$$\n因此，在所有秩-$k$ 线性代理模型中，可实现的最小期望平方重构误差为\n$$\n\\mathbb{E}\\big[\\|\\boldsymbol{\\phi}-\\hat{\\boldsymbol{\\phi}}\\|_{2}^{2}\\big]_{\\min}=\\sum_{i=k+1}^{M}\\lambda_{i},\n$$\n而投影到前 $k$ 个特征向量张成的空间上的主成分分析 (PCA) 代理模型达到了这个最小值。这个量也作为一个误差界，因为任何其他秩-$k$ 线性重构都不可能有更小的期望平方误差。\n\n对电解质电势场的物理解释：特征值 $\\{\\lambda_{i}\\}$ 是随机场 $\\boldsymbol{\\phi}$ 沿着正交空间模态（特征向量）的方差，这些模态捕获了在不同操作条件下电解质电势波动的相干模式。总和 $\\sum_{i=k+1}^{M}\\lambda_{i}$ 等于存在于被忽略模态中的总方差。因此，该界限量化了任何秩-$k$ 线性代理模型必须舍弃的平均未解析的平方电解质电势波动。在实际应用中，它衡量了所选的 $k$ 维表示未能捕获的电解质电势特征（例如微尺度欧姆压降和由曲折度引起的非均匀性）的均方大小（单位为平方伏特）。\n\n现在，当使用 $k=2$ 时，为给定的谱计算该界限。已知\n$$\n\\lambda_{1}=3.2\\times 10^{-4},\\quad\n\\lambda_{2}=1.6\\times 10^{-4},\\quad\n\\lambda_{3}=8.0\\times 10^{-5},\\quad\n\\lambda_{4}=4.0\\times 10^{-5},\\quad\n\\lambda_{5}=2.0\\times 10^{-5},\n$$\n且所有后续特征值均可忽略不计，我们有\n$$\n\\sum_{i=k+1}^{M}\\lambda_{i}=\\lambda_{3}+\\lambda_{4}+\\lambda_{5}\n=\\big(8.0\\times 10^{-5}\\big)+\\big(4.0\\times 10^{-5}\\big)+\\big(2.0\\times 10^{-5}\\big)\n=1.4\\times 10^{-4}.\n$$\n四舍五入到四位有效数字并以平方伏特表示，最小期望平方重构误差界为 $1.400\\times 10^{-4}$。",
            "answer": "$$\\boxed{1.400 \\times 10^{-4}}$$"
        },
        {
            "introduction": "一个优秀的代理模型不仅应提供点预测，还应能评估自身预测的置信度。本练习  深入探讨了高斯过程（Gaussian Processes, GP），它是一种强大的概率性机器学习工具，能够自然地量化不确定性。我们将学习如何将模型在主要输出（电压 $V$ 和电流 $I$）上的不确定性，传播到我们关心的派生量（功率 $P = VI$）上，这是在工程设计和控制中进行风险评估的一项关键技能。",
            "id": "3926913",
            "problem": "一个锂离子电池通过一个多输出高斯过程回归 (GPR) 代理模型进行建模，该模型用于预测在由温度、荷电状态 (SOC) 和电流设定点定义的工作条件 $x^{\\star}$ 下的端电压 $V$ 和放电电流 $I$。根据高斯过程 (GP) 的定义，对于任何输出集，在 $x^{\\star}$ 处的有限维后验预测分布是多变量正态的；特别地，在 $x^{\\star}$ 处 $(V,I)$ 的联合预测分布是高斯分布，其均值向量和协方差矩阵由核函数和训练数据确定。高斯随机变量的置信区间 (CI) 构建使用标准正态分位数。\n\n在特定工作条件 $x^{\\star}$ 下，训练好的代理模型得出关于 $(V,I)$ 的以下后验预测摘要：\n- 平均电压 $\\mu_{V} = 3.7$ 和平均电流 $\\mu_{I} = 2.0$，\n- 电压方差 $\\sigma_{V}^{2} = (0.05)^{2}$，\n- 电流方差 $\\sigma_{I}^{2} = (0.2)^{2}$，\n- 协方差 $\\sigma_{VI} = -0.006$。\n\n假设 $(V,I)$ 的联合预测分布是具有这些参数的高斯分布，并且模型噪声和观测噪声已由 GPR 后验适当地整合到 $\\sigma_{V}^{2}$、$\\sigma_{I}^{2}$ 和 $\\sigma_{VI}$ 中。导出的目标量是功率 $P = V I$。从高斯过程定义和多元正态矩的性质出发，通过以下步骤推导 $P$ 的近似双侧 $95\\%$ 置信区间：\n1. 从 $(V,I)$ 的联合高斯预测分布推导 $P$ 的前两阶矩，\n2. 用具有这些矩的正态分布近似 $P$ 的分布，\n3. 使用标准正态分位数 $z_{0.975} \\approx 1.96$ 来构建一个对称的双侧置信区间。\n\n在此近似下，计算 $P$ 的双侧 $95\\%$ 置信区间半宽，并以瓦特 (W) 为单位表示您的最终数值答案。将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述了在特定工作条件 $x^{\\star}$ 下，端电压 $V$ 和放电电流 $I$ 的联合后验预测分布是一个二元高斯分布。我们可以将随机向量 $\\mathbf{X} = \\begin{pmatrix} V \\\\ I \\end{pmatrix}$ 表示如下：\n$$\n\\mathbf{X} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})\n$$\n其中均值向量 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$ 由问题陈述给出：\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_V \\\\ \\mu_I \\end{pmatrix} = \\begin{pmatrix} 3.7 \\\\ 2.0 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix} \\sigma_V^2 & \\sigma_{VI} \\\\ \\sigma_{VI} & \\sigma_I^2 \\end{pmatrix} = \\begin{pmatrix} (0.05)^2 & -0.006 \\\\ -0.006 & (0.2)^2 \\end{pmatrix} = \\begin{pmatrix} 0.0025 & -0.006 \\\\ -0.006 & 0.04 \\end{pmatrix}\n$$\n导出的目标量是功率，$P = VI$。我们的任务是找到 $P$ 的近似 $95\\%$ 置信区间 (CI)。这将通过首先推导 $P$ 的精确前两阶矩（均值和方差），然后将 $P$ 的分布近似为正态分布来完成。\n\n**1. 功率 ($P$) 矩的推导**\n\n**$P$ 的均值：**\n两个随机变量乘积的期望值由它们的均值之积加上它们的协方差给出。\n$$\n\\mu_P = E[P] = E[VI] = E[V]E[I] + \\text{Cov}(V, I) = \\mu_V \\mu_I + \\sigma_{VI}\n$$\n代入给定值：\n$$\n\\mu_P = (3.7)(2.0) + (-0.006) = 7.4 - 0.006 = 7.394\n$$\n平均功率为 $7.394$ W。\n\n**$P$ 的方差：**\n$P$ 的方差是 $\\sigma_P^2 = \\text{Var}(P) = E[P^2] - (E[P])^2$。我们需要计算 $E[P^2] = E[V^2 I^2]$。为此，我们使用两个相关正态随机变量乘积的方差的精确公式：\n$$\n\\sigma_P^2 = \\mu_V^2 \\sigma_I^2 + \\mu_I^2 \\sigma_V^2 + 2\\mu_V \\mu_I \\sigma_{VI} + \\sigma_V^2 \\sigma_I^2 + \\sigma_{VI}^2\n$$\n现在我们可以代入数值：\n$\\mu_V = 3.7$，$\\mu_I = 2.0$，$\\sigma_V^2 = 0.0025$，$\\sigma_I^2 = 0.04$，$\\sigma_{VI} = -0.006$。\n$$\n\\sigma_P^2 = (3.7)^2(0.04) + (2.0)^2(0.0025) + 2(3.7)(2.0)(-0.006) + (0.0025)(0.04) + (-0.006)^2\n$$\n$$\n\\sigma_P^2 = (13.69)(0.04) + (4)(0.0025) - (14.8)(0.006) + 0.0001 + 0.000036\n$$\n$$\n\\sigma_P^2 = 0.5476 + 0.01 - 0.0888 + 0.0001 + 0.000036\n$$\n$$\n\\sigma_P^2 = 0.468936\n$$\n$P$ 的标准差是：\n$$\n\\sigma_P = \\sqrt{0.468936} \\approx 0.684789 \\text{ W}\n$$\n\n**2. $P$ 分布的正态近似**\n\n两个高斯随机变量乘积的分布并非严格的高斯分布。然而，为了构建一个近似置信区间，我们用我们刚刚推导出的矩将 $P$ 的分布近似为一个正态分布：\n$$\nP \\approx \\mathcal{N}(\\mu_P, \\sigma_P^2) \\quad \\text{其中} \\quad \\mu_P = 7.394, \\quad \\sigma_P^2 = 0.468936\n$$\n\n**3. $95\\%$ 置信区间的构建**\n\n对于一个正态分布的变量，其双侧 $95\\%$ 置信区间是使用均值和标准差，以及来自标准正态分布的相应分位数来构建的。对于 $95\\%$ CI，尾部的总概率是 $\\alpha = 1 - 0.95 = 0.05$，所以我们使用分位数 $z_{1-\\alpha/2} = z_{0.975}$。问题提供了值 $z_{0.975} \\approx 1.96$。\n\n置信区间由 $\\mu_P \\pm z_{0.975} \\sigma_P$ 给出。该区间的半宽 (HW) 是：\n$$\nHW = z_{0.975} \\sigma_P\n$$\n使用我们计算出的值：\n$$\nHW = 1.96 \\times \\sqrt{0.468936} \\approx 1.96 \\times 0.684789 \\approx 1.3421864 \\text{ W}\n$$\n问题要求将数值答案四舍五入到四位有效数字。\n$$\nHW \\approx 1.342 \\text{ W}\n$$\n因此，功率的近似 $95\\%$ 置信区间是 $7.394 \\pm 1.342$ W。计算出的半宽是 $1.342$ W。",
            "answer": "$$\n\\boxed{1.342}\n$$"
        },
        {
            "introduction": "为了提高数据驱动模型的泛化能力和物理真实性，可以将已知的物理定律直接嵌入到模型结构中。本练习  探讨了物理信息神经网络（Physics-Informed Neural Networks, PINN）及其设计中的一个核心方面：如何强制施加全局守恒定律，如电池系统中的锂离子总质量守恒。我们将分析施加这种物理约束如何改变模型的误差特性，并最终提高其对下游任务预测的准确性。",
            "id": "3926983",
            "problem": "一个物理信息神经网络 (PINN) 被训练为多孔电极锂离子电池的代理模型，该网络有两个输出：定义在固相域 $\\Omega_{s}$ (体积 $V_{s}$) 上的固相锂浓度 $c_{s}(\\mathbf{x}, t; \\boldsymbol{\\theta}_{s})$，以及定义在电解质域 $\\Omega_{e}$ (体积 $V_{e}$) 上的电解质相锂浓度 $c_{e}(\\mathbf{y}, t; \\boldsymbol{\\theta}_{e})$。假设电池是封闭的，没有副反应，且可循环锂的损失可以忽略不计。根据质量守恒定律，总锂量在所有时间 $t$ 内都是守恒的：\n$$\n\\int_{\\Omega_{s}} c_{s}(\\mathbf{x}, t)\\, dV + \\int_{\\Omega_{e}} c_{e}(\\mathbf{y}, t)\\, dV = M_{\\text{tot}} \\quad \\text{for all } t,\n$$\n其中 $M_{\\text{tot}}$ 是一个常数。PINN 的训练损失函数包含数据失配项、偏微分方程 (PDE) 残差项以及边界和界面项。要求您在 PINN 中强制执行全局积分守恒定律，并量化其对下游电压预测器泛化能力的影响。\n\n考虑一个由下式定义的下游线性电压代理模型\n$$\nV(t) = \\alpha\\, I_{s}(t) + \\beta\\, I_{e}(t) + \\gamma,\n$$\n其中 $I_{s}(t) = \\int_{\\Omega_{s}} c_{s}(\\mathbf{x}, t)\\, dV$ 且 $I_{e}(t) = \\int_{\\Omega_{e}} c_{e}(\\mathbf{y}, t)\\, dV$，$\\alpha$、$\\beta$ 和 $\\gamma$ 为常数。假设训练后，PINN 的积分守恒残差 $r(t) \\equiv I_{s}(t) + I_{e}(t) - M_{\\text{tot}}$ 满足 $\\sup_{t} |r(t)| \\le \\varepsilon$（对于某个小的 $\\varepsilon > 0$），并且 PINN 在未见过的电流剖面上的积分预测误差 $e_{s}(t) \\equiv \\widehat{I}_{s}(t) - I_{s}(t)$ 和 $e_{e}(t) \\equiv \\widehat{I}_{e}(t) - I_{e}(t)$ 是零均值的，方差分别为 $\\sigma_{s}^{2}$ 和 $\\sigma_{e}^{2}$。假设在无约束情况下，$e_{s}(t)$ 和 $e_{e}(t)$ 是独立的，并且守恒强制执行使这些误差耦合，从而 $e_{e}(t) \\approx -e_{s}(t) + \\delta(t)$，其中 $|\\delta(t)| \\le \\varepsilon$。\n\n在所述假设下，哪个选项正确地指定了一个用于强制执行积分锂守恒的全局 PINN 约束，并给出了下游预测器在测试时的期望平方电压误差的所得上界？\n\nA. 向 PINN 损失函数中添加一个软全局约束项\n$$\n\\mathcal{L}_{\\text{cons}} = \\frac{1}{T}\\int_{0}^{T} \\left(I_{s}(t) + I_{e}(t) - M_{\\text{tot}}\\right)^{2}\\, dt,\n$$\n其中 $I_{s}(t) = \\int_{\\Omega_{s}} c_{s}(\\mathbf{x}, t)\\, dV$ 且 $I_{e}(t) = \\int_{\\Omega_{e}} c_{e}(\\mathbf{y}, t)\\, dV$，其关于 $c_{s}$ 和 $c_{e}$ 的泛函梯度通过标量残差 $I_{s}(t) + I_{e}(t) - M_{\\text{tot}}$ 耦合了两个输出。在给定假设下，测试时的期望平方电压误差满足\n$$\n\\mathbb{E}\\big[(\\Delta V(t))^{2}\\big] \\le (\\alpha - \\beta)^{2}\\,\\sigma_{s}^{2} + \\beta^{2}\\,\\varepsilon^{2},\n$$\n而在无约束情况下\n$$\n\\mathbb{E}\\big[(\\Delta V(t))^{2}\\big] = \\alpha^{2}\\,\\sigma_{s}^{2} + \\beta^{2}\\,\\sigma_{e}^{2}.\n$$\n\nB. 添加一个局部逐点约束\n$$\n\\mathcal{L}_{\\text{local}} = \\int_{\\Omega_{s}\\cup \\Omega_{e}} \\left(c_{s}(\\mathbf{z}, t) + c_{e}(\\mathbf{z}, t) - \\frac{M_{\\text{tot}}}{V_{s}+V_{e}}\\right)^{2}\\, dV,\n$$\n并假设下游期望平方电压误差界变为\n$$\n\\mathbb{E}\\big[(\\Delta V(t))^{2}\\big] \\le (\\alpha + \\beta)^{2}\\,\\sigma_{s}^{2}.\n$$\n\nC. 引入一个硬拉格朗日乘子 $\\lambda(t)$，通过以下方式精确强制执行守恒\n$$\n\\mathcal{L}_{\\text{aug}} = \\mathcal{L}_{\\text{PDE}} + \\mathcal{L}_{\\text{BC}} + \\mathcal{L}_{\\text{data}} + \\int_{0}^{T}\\lambda(t)\\,\\big(I_{s}(t) + I_{e}(t) - M_{\\text{tot}}\\big)\\, dt,\n$$\n并声称下游期望平方电压误差不受该约束的影响：\n$$\n\\mathbb{E}\\big[(\\Delta V(t))^{2}\\big] = \\alpha^{2}\\,\\sigma_{s}^{2} + \\beta^{2}\\,\\sigma_{e}^{2}.\n$$\n\nD. 仅在端点处惩罚守恒\n$$\n\\mathcal{L}_{\\text{end}} = \\big(I_{s}(0) + I_{e}(0) - M_{\\text{tot}}\\big)^{2} + \\big(I_{s}(T) + I_{e}(T) - M_{\\text{tot}}\\big)^{2},\n$$\n并得出结论，该约束并未改善下游期望平方电压误差：\n$$\n\\mathbb{E}\\big[(\\Delta V(t))^{2}\\big] = \\alpha^{2}\\,\\sigma_{s}^{2} + \\beta^{2}\\,\\sigma_{e}^{2}.\n$$",
            "solution": "本题旨在分析如何在 PINN 中施加全局守恒定律，并推导其对下游电压预测器误差的影响。\n\n首先，定义下游电压预测器的预测误差 $\\Delta V(t)$。它由积分浓度预测误差 $e_s(t) = \\widehat{I}_s(t) - I_s(t)$ 和 $e_e(t) = \\widehat{I}_e(t) - I_e(t)$ 决定：\n$$ \\Delta V(t) = \\widehat{V}(t) - V(t) = (\\alpha \\widehat{I}_s(t) + \\beta \\widehat{I}_e(t) + \\gamma) - (\\alpha I_s(t) + \\beta I_e(t) + \\gamma) $$\n$$ \\Delta V(t) = \\alpha e_s(t) + \\beta e_e(t) $$\n\n#### 无约束情况分析\n在无约束的情况下，问题假设 $e_s(t)$ 和 $e_e(t)$ 是独立的零均值随机变量。因此，期望平方误差为：\n$$ \\mathbb{E}[(\\Delta V(t))^2] = \\mathbb{E}[(\\alpha e_s(t) + \\beta e_e(t))^2] $$\n由于独立性，交叉项 $\\mathbb{E}[e_s(t)e_e(t)]$ 为零，我们得到：\n$$ \\mathbb{E}[(\\Delta V(t))^2] = \\alpha^2 \\mathbb{E}[e_s(t)^2] + \\beta^2 \\mathbb{E}[e_e(t)^2] = \\alpha^2\\sigma_s^2 + \\beta^2\\sigma_e^2 $$\n这与选项 A 中给出的无约束情况下的误差表达式一致。\n\n#### 约束情况分析\n施加全局守恒约束后，PINN 的预测 $\\widehat{I}_s(t)$ 和 $\\widehat{I}_e(t)$ 将近似满足 $\\widehat{I}_s(t) + \\widehat{I}_e(t) = M_{\\text{tot}}$。这会在预测误差之间引入强烈的耦合关系。根据题设，该关系为 $e_e(t) \\approx -e_s(t) + \\delta(t)$，其中 $\\delta(t)$ 是网络的守恒残差，且其绝对值以 $\\varepsilon$ 为界，$|\\delta(t)| \\le \\varepsilon$。\n将此关系代入电压误差表达式中：\n$$ \\Delta V(t) \\approx \\alpha e_s(t) + \\beta(-e_s(t) + \\delta(t)) = (\\alpha - \\beta)e_s(t) + \\beta\\delta(t) $$\n计算期望平方误差。假设 $e_s(t)$ 与残差 $\\delta(t)$ 不相关（这是一个合理的简化），交叉项的期望为零：\n$$ \\mathbb{E}[(\\Delta V(t))^2] \\approx \\mathbb{E}[((\\alpha - \\beta)e_s(t) + \\beta\\delta(t))^2] = (\\alpha - \\beta)^2 \\mathbb{E}[e_s(t)^2] + \\beta^2 \\mathbb{E}[\\delta(t)^2] $$\n利用已知条件 $\\mathbb{E}[e_s(t)^2] = \\sigma_s^2$ 和 $\\mathbb{E}[\\delta(t)^2] \\le \\varepsilon^2$，我们得到误差的上界：\n$$ \\mathbb{E}[(\\Delta V(t))^2] \\le (\\alpha - \\beta)^2\\sigma_s^2 + \\beta^2\\varepsilon^2 $$\n这个推导出的上界与选项 A 中给出的表达式完全匹配。\n\n#### 选项评估\n- **选项 A**: 提出的软约束项是在 PINN 中实现全局约束的正确标准方法。其误差分析（包括无约束和有约束情况）与我们的推导一致。因此，该选项是正确的。\n- **选项 B**: 提出的局部约束在物理上是不合理的，因为守恒是一个积分性质。\n- **选项 C**: 错误地声称硬约束不改变下游误差。约束通过耦合误差从根本上改变了误差的结构。\n- **选项 D**: 提出的端点约束不足以保证在整个时间域上的守恒。\n\n综上所述，选项 A 提供了正确的约束方法和随之而来的误差分析。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}