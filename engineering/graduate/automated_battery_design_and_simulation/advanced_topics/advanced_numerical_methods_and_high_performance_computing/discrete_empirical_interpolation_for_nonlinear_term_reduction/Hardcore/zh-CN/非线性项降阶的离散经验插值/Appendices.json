{
    "hands_on_practices": [
        {
            "introduction": "离散经验插值方法的第一步是捕捉非线性项的关键模式。这通常通过对高保真模拟产生的“快照”集合应用降维技术来完成，其中奇异值分解（SVD）是提取最优低维基的标准工具。本练习 () 将引导您完成从一个简单的快照矩阵中提取本征正交分解（POD）基的核心线性代数计算，为理解DEIM的离线构建阶段奠定基础。",
            "id": "3907533",
            "problem": "在自动化电池设计和仿真中，离散经验插值法（DEIM）被用来减少非线性源项的计算负担，例如锂离子电池中由 Butler–Volmer 动力学产生的非线性源项。一种标准方法是使用奇异值分解（SVD）从快照矩阵中为非线性项构建一个低维基。考虑一个训练快照矩阵，该矩阵由一个非线性矢量场在不同参数和状态样本下的空间离散化评估值组装而成，\n$$\nS=\\begin{bmatrix}\n2  0 \\\\\n0  1 \\\\\n1  1\n\\end{bmatrix},\n$$\n其中每一列对应于不同操作条件下的一个采样非线性快照。从任何实矩阵都存在奇异值分解（SVD）以及左奇异向量是与非零奇异值相关联的 $S S^{\\top}$ 的标准正交特征向量这一基本线性代数原理出发，确定前两个左奇异向量以构建 DEIM 基\n$$\nU \\in \\mathbb{R}^{3 \\times 2}.\n$$\n将 $U$ 表示为包含根式的封闭形式解析表达式。最终答案必须是矩阵 $U$；无需单位。",
            "solution": "目标是计算矩阵 $S \\in \\mathbb{R}^{3 \\times 2}$ 的前两个左奇异向量。根据奇异值分解（SVD）的基本性质，对于任何实矩阵 $S$，都存在一个 SVD 分解 $S = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 的列是标准正交的（左奇异向量），$\\Sigma \\in \\mathbb{R}^{3 \\times 2}$ 是一个具有非负奇异值的对角矩阵，并且 $V \\in \\mathbb{R}^{2 \\times 2}$ 的列是标准正交的（右奇异向量）。此外，$U$ 的列是对称半正定矩阵 $S S^{\\top}$ 的标准正交特征向量，其特征值等于奇异值的平方。\n\n我们从这些基本事实出发进行计算。\n\n1. 计算 $S S^{\\top}$：\n$$\nS S^{\\top}\n=\n\\begin{bmatrix}\n2  0 \\\\\n0  1 \\\\\n1  1\n\\end{bmatrix}\n\\begin{bmatrix}\n2  0  1 \\\\\n0  1  1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n4  0  2 \\\\\n0  1  1 \\\\\n2  1  2\n\\end{bmatrix}.\n$$\n\n2. 通过求解 $\\det(S S^{\\top} - \\lambda I) = 0$ 来计算 $S S^{\\top}$ 的特征值。令\n$$\nA = S S^{\\top} = \\begin{bmatrix}\n4  0  2 \\\\\n0  1  1 \\\\\n2  1  2\n\\end{bmatrix}.\n$$\n特征多项式是\n$$\n\\det(A - \\lambda I)\n=\n\\begin{vmatrix}\n4 - \\lambda   0  2 \\\\\n0  1 - \\lambda  1 \\\\\n2  1  2 - \\lambda\n\\end{vmatrix}\n=\n-\\lambda \\left(\\lambda^{2} - 7\\lambda + 9\\right).\n$$\n因此，特征值为\n$$\n\\lambda_{1} = \\frac{7 + \\sqrt{13}}{2}, \\quad\n\\lambda_{2} = \\frac{7 - \\sqrt{13}}{2}, \\quad\n\\lambda_{3} = 0.\n$$\n奇异值为 $\\sigma_{i} = \\sqrt{\\lambda_{i}}$，并且相关的左奇异向量是 $A$ 对于 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的归一化特征向量。\n\n3. 通过求解 $(A - \\lambda_{1} I)\\mathbf{v}_{1} = \\mathbf{0}$ 来计算 $\\lambda_{1} = \\frac{7 + \\sqrt{13}}{2}$ 的一个特征向量。方程组\n$$\n\\begin{cases}\n\\left(4 - \\lambda_{1}\\right) x + 2 z = 0, \\\\\n\\left(1 - \\lambda_{1}\\right) y + z = 0, \\\\\n2 x + y + \\left(2 - \\lambda_{1}\\right) z = 0,\n\\end{cases}\n$$\n的解与\n$$\n\\mathbf{v}_{1} = \\begin{bmatrix}\n1 \\\\\n\\frac{\\sqrt{13} - 3}{4} \\\\\n\\frac{\\sqrt{13} - 1}{4}\n\\end{bmatrix}\n$$\n成比例。对 $\\mathbf{v}_{1}$ 进行归一化：\n$$\n\\|\\mathbf{v}_{1}\\|^{2}\n=\n1^{2}\n+\n\\left(\\frac{\\sqrt{13} - 3}{4}\\right)^{2}\n+\n\\left(\\frac{\\sqrt{13} - 1}{4}\\right)^{2}\n=\n\\frac{13 - 2\\sqrt{13}}{4},\n$$\n所以\n$$\n\\|\\mathbf{v}_{1}\\|\n=\n\\sqrt{\\frac{13 - 2\\sqrt{13}}{4}}\n=\n\\frac{\\sqrt{13 - 2\\sqrt{13}}}{2}.\n$$\n因此，归一化的特征向量（第一个左奇异向量）是\n$$\n\\mathbf{u}_{1}\n=\n\\frac{\\mathbf{v}_{1}}{\\|\\mathbf{v}_{1}\\|}\n=\n\\begin{bmatrix}\n\\frac{2}{\\sqrt{13 - 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 3}{2\\sqrt{13 - 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 1}{2\\sqrt{13 - 2\\sqrt{13}}}\n\\end{bmatrix}.\n$$\n\n4. 通过求解 $(A - \\lambda_{2} I)\\mathbf{v}_{2} = \\mathbf{0}$ 来计算 $\\lambda_{2} = \\frac{7 - \\sqrt{13}}{2}$ 的一个特征向量。方程组\n$$\n\\begin{cases}\n\\left(4 - \\lambda_{2}\\right) x + 2 z = 0, \\\\\n\\left(1 - \\lambda_{2}\\right) y + z = 0, \\\\\n2 x + y + \\left(2 - \\lambda_{2}\\right) z = 0,\n\\end{cases}\n$$\n的解与\n$$\n\\mathbf{v}_{2} = \\begin{bmatrix}\n1 \\\\\n-\\frac{\\sqrt{13} + 3}{4} \\\\\n-\\frac{\\sqrt{13} + 1}{4}\n\\end{bmatrix}\n$$\n成比例。对 $\\mathbf{v}_{2}$ 进行归一化：\n$$\n\\|\\mathbf{v}_{2}\\|^{2}\n=\n1^{2}\n+\n\\left(\\frac{\\sqrt{13} + 3}{4}\\right)^{2}\n+\n\\left(\\frac{\\sqrt{13} + 1}{4}\\right)^{2}\n=\n\\frac{13 + 2\\sqrt{13}}{4},\n$$\n所以\n$$\n\\|\\mathbf{v}_{2}\\|\n=\n\\sqrt{\\frac{13 + 2\\sqrt{13}}{4}}\n=\n\\frac{\\sqrt{13 + 2\\sqrt{13}}}{2}.\n$$\n因此，归一化的特征向量（第二个左奇异向量）是\n$$\n\\mathbf{u}_{2}\n=\n\\frac{\\mathbf{v}_{2}}{\\|\\mathbf{v}_{2}\\|}\n=\n\\begin{bmatrix}\n\\frac{2}{\\sqrt{13 + 2\\sqrt{13}}} \\\\\n-\\frac{\\sqrt{13} + 3}{2\\sqrt{13 + 2\\sqrt{13}}} \\\\\n-\\frac{\\sqrt{13} + 1}{2\\sqrt{13 + 2\\sqrt{13}}}\n\\end{bmatrix}.\n$$\n\n5. 从前两个左奇异向量组装 DEIM 基矩阵 $U \\in \\mathbb{R}^{3 \\times 2}$：\n$$\nU\n=\n\\begin{bmatrix}\n\\frac{2}{\\sqrt{13 - 2\\sqrt{13}}}  \\frac{2}{\\sqrt{13 + 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 3}{2\\sqrt{13 - 2\\sqrt{13}}}  -\\frac{\\sqrt{13} + 3}{2\\sqrt{13 + 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 1}{2\\sqrt{13 - 2\\sqrt{13}}}  -\\frac{\\sqrt{13} + 1}{2\\sqrt{13 + 2\\sqrt{13}}}\n\\end{bmatrix}.\n$$\n根据构造，这些列是与两个正特征值相关联的 $S S^{\\top}$ 的标准正交特征向量，因此它们是 $S$ 的前两个左奇异向量，构成了用于非线性项降维的 DEIM 基。",
            "answer": "$$\\boxed{\n\\begin{pmatrix}\n\\frac{2}{\\sqrt{13 - 2\\sqrt{13}}}  \\frac{2}{\\sqrt{13 + 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 3}{2\\sqrt{13 - 2\\sqrt{13}}}  -\\frac{\\sqrt{13} + 3}{2\\sqrt{13 + 2\\sqrt{13}}} \\\\\n\\frac{\\sqrt{13} - 1}{2\\sqrt{13 - 2\\sqrt{13}}}  -\\frac{\\sqrt{13} + 1}{2\\sqrt{13 + 2\\sqrt{13}}}\n\\end{pmatrix}\n}$$"
        },
        {
            "introduction": "在获得了表示非线性项的低维基 $U$ 之后，我们面临的下一个挑战是如何在不评估整个非线性向量的情况下，高效地计算其投影系数。DEIM的精髓在于通过一个贪心算法，从 $N$ 个空间点中挑选出少数几个（$m$ 个）“经验插值点”。本练习 () 旨在让您亲手实践这个贪心选择过程，这是确保DEIM在线阶段计算效率的关键所在。",
            "id": "3907604",
            "problem": "在自动化电池设计与仿真的非线性源项降阶建模中，考虑一个由电化学动力学和输运产生的非线性映射，例如在与电解质输运耦合的 Butler–Volmer 反应项中。在获得非线性快照的降阶基后，应用离散经验插值法 (DEIM) 来选择插值指数，以实现高效的在线评估。设降阶基矩阵由下式给出\n$$\nU \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{bmatrix}\n1  0\\\\\n1  1\\\\\n0  1\n\\end{bmatrix},\n$$\n其中 $U$ 的列张成了非线性项的二维近似子空间。使用标准的贪婪 DEIM 选择过程，并约定当出现平局时选择最小的索引，计算 DEIM 插值指数 $p_1$ 和 $p_2$。定义采样矩阵 $P \\in \\mathbb{R}^{3\\times 2}$ 为 $P = \\begin{bmatrix} e_{p_1}  e_{p_2} \\end{bmatrix}$，其中 $e_i$ 是 $\\mathbb{R}^{3\\times 3}$ 中单位矩阵的第 $i$ 列。通过计算其行列式来验证 $P^{T}U$ 是可逆的。将有序对 $(p_1,p_2)$ 作为您的最终答案。无需四舍五入，也无需单位。",
            "solution": "该问题要求对于给定的降阶基矩阵 $U$，计算前两个离散经验插值法 (DEIM) 指数 $p_1$ 和 $p_2$。DEIM 算法是用于选择一组插值点的贪婪过程。设降阶基矩阵 $U \\in \\mathbb{R}^{n \\times m}$ 的列表示为 $u_1, u_2, \\dots, u_m$。在这个问题中，$n=3$ 且 $m=2$。\n\n给定的降阶基矩阵为：\n$$\nU \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{bmatrix}\n1  0\\\\\n1  1\\\\\n0  1\n\\end{bmatrix}\n$$\n$U$ 的列是基向量 $u_1$ 和 $u_2$：\n$$\nu_1 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\quad u_2 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}\n$$\n\nDEIM 算法的步骤如下：\n\n**第 1 步：计算第一个插值指数 $p_1$。**\n第一个指数 $p_1$ 被选为第一个基向量 $u_1$ 中具有最大绝对值的分量的索引。\n$$\np_1 = \\arg\\max_{i \\in \\{1, 2, 3\\}} |(u_1)_i|\n$$\n$u_1$ 的分量为 $(u_1)_1 = \\frac{1}{\\sqrt{2}}$，$(u_1)_2 = \\frac{1}{\\sqrt{2}}$，以及 $(u_1)_3 = 0$。绝对值为 $|\\frac{1}{\\sqrt{2}}|$、 $|\\frac{1}{\\sqrt{2}}|$ 以及 $|0|$。最大绝对值为 $\\frac{1}{\\sqrt{2}}$，出现在索引 $i=1$ 和 $i=2$ 处。根据题目说明，通过选择最小的索引来打破平局。因此，我们选择：\n$$\np_1 = 1\n$$\n\n**第 2 步：计算第二个插值指数 $p_2$。**\n第二个指数 $p_2$ 是通过首先计算残差向量 $r_2$ 来找到的。这个残差是第二个基向量 $u_2$ 与其在由第一个基向量 $u_1$ 张成的子空间上的投影之间的误差。该投影是使用第一个插值点 $p_1$ 构造的。\n\n$u_2$ 的近似形式为 $c_1 u_1$。系数 $c_1$ 是通过强制该近似在第一个插值点 $p_1=1$ 处与 $u_2$ 匹配来确定的：\n$$\n(u_2)_{p_1} = c_1 (u_1)_{p_1}\n$$\n代入 $p_1=1$ 的值：\n$$\n(u_2)_1 = c_1 (u_1)_1 \\implies \\frac{1}{\\sqrt{2}}(0) = c_1 \\frac{1}{\\sqrt{2}}(1) \\implies 0 = c_1\n$$\n系数为 $c_1 = 0$。\n\n然后计算残差向量 $r_2$ 如下：\n$$\nr_2 = u_2 - c_1 u_1 = u_2 - 0 \\cdot u_1 = u_2\n$$\n所以，残差向量就是 $r_2 = u_2 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$。\n\n第二个指数 $p_2$ 是残差向量 $r_2$ 中具有最大绝对值的分量的索引：\n$$\np_2 = \\arg\\max_{i \\in \\{1, 2, 3\\}} |(r_2)_i|\n$$\n$r_2$ 的分量是 $(r_2)_1 = 0$，$(r_2)_2 = \\frac{1}{\\sqrt{2}}$，以及 $(r_2)_3 = \\frac{1}{\\sqrt{2}}$。绝对值是 $|0|$、 $|\\frac{1}{\\sqrt{2}}|$ 以及 $|\\frac{1}{\\sqrt{2}}|$。最大绝对值是 $\\frac{1}{\\sqrt{2}}$，出现在索引 $i=2$ 和 $i=3$ 处。同样，通过选择最小的索引来打破平局，我们得到：\n$$\np_2 = 2\n$$\n因此，DEIM 插值指数为有序对 $(p_1, p_2) = (1, 2)$。\n\n**第 3 步：验证 $P^T U$ 的可逆性。**\n问题要求验证矩阵 $P^T U$ 是可逆的。采样矩阵 $P$ 是由与计算出的索引相对应的标准基向量 $e_i \\in \\mathbb{R}^3$ 构造的：\n$$\nP = \\begin{bmatrix} e_{p_1}  e_{p_2} \\end{bmatrix} = \\begin{bmatrix} e_1  e_2 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix}\n$$\n$P$ 的转置是：\n$$\nP^T = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\end{bmatrix}\n$$\n现在，我们计算乘积 $P^T U$：\n$$\nP^T U = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  0\\\\ 1  1\\\\ 0  1 \\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\cdot 1 + 0 \\cdot 1 + 0 \\cdot 0   1 \\cdot 0 + 0 \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0   0 \\cdot 0 + 1 \\cdot 1 + 0 \\cdot 1 \\end{bmatrix}\n$$\n$$\nP^T U = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}\n$$\n为了验证可逆性，我们计算这个 $2 \\times 2$ 矩阵的行列式：\n$$\n\\det(P^T U) = \\det\\left(\\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}\\right) = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 \\det\\left(\\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}\\right)\n$$\n$$\n\\det(P^T U) = \\frac{1}{2} \\left( (1)(1) - (0)(1) \\right) = \\frac{1}{2}(1) = \\frac{1}{2}\n$$\n由于 $\\det(P^T U) = \\frac{1}{2} \\neq 0$，矩阵 $P^T U$ 是可逆的。这样就完成了验证。\n\n最终答案是 DEIM 插值指数的有序对 $(p_1, p_2)$。",
            "answer": "$$\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}$$"
        },
        {
            "introduction": "我们为什么要费力构建基并挑选插值点呢？答案在于DEIM能够带来的显著计算加速，尤其是在需要大量重复评估非线性模型的场景中，例如电池设计优化。本练习 () 将引导您从第一性原理出发，通过详细的运算成本分析，推导出DEIM相对于全阶模型评估的理论加速比，从而量化该方法的实际价值。",
            "id": "3907597",
            "problem": "考虑一个用于自动化电池设计和仿真的降阶电化学模型。该模型通过一个基矩阵为 $V \\in \\mathbb{R}^{n \\times r}$ 和降阶坐标为 $a \\in \\mathbb{R}^{r}$ 的线性子空间来近似 $n$ 个控制体积上的过电位场，使得过电位向量为 $\\eta = V a$。非线性电流密度映射 $f:\\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 是分量形式的 Butler–Volmer 动力学，其第 $i$ 个分量由下式给出\n$$\nf_i(\\eta_i) = i_{0,i} \\left( \\exp\\!\\left( \\frac{\\alpha_a F}{R T} \\eta_i \\right) - \\exp\\!\\left( -\\frac{\\alpha_c F}{R T} \\eta_i \\right) \\right),\n$$\n其中 $i_{0,i}$ 是第 $i$ 个控制体积处的交换电流密度，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\alpha_a$、$\\alpha_c$ 分别是阳极和阴极电荷转移系数。假设 $V$ 是稠密矩阵。成本模型将一次乘法或加法计为 $1$ 次操作，将一次指数函数 $\\exp(\\cdot)$ 的评估计为 $\\gamma$ 次操作，其中 $\\gamma  1$。诸如 $\\frac{\\alpha_a F}{R T}$ 和 $\\frac{\\alpha_c F}{R T}$ 之类的预计算常数是可用的，并且不会产生运行时成本。\n\n您需要比较评估完整非线性向量 $f(V a)$ 的计算复杂度与使用离散经验插值法 (DEIM) 进行超降阶评估的计算复杂度。在 DEIM 中，有一个基 $U \\in \\mathbb{R}^{n \\times m}$，一个选择 $m$ 个分量索引的采样矩阵 $P \\in \\mathbb{R}^{n \\times m}$，并假设 $(P^{\\top} U)$ 是可逆的，且其逆矩阵已离线预计算。DEIM 近似计算 $P^{\\top} \\eta = (P^{\\top} V) a$，在这 $m$ 个采样分量上评估 $P^{\\top} f(\\eta)$，并通过 $U (P^{\\top} U)^{-1} (P^{\\top} f(\\eta))$ 重构对 $f(\\eta)$ 的近似。\n\n从第一性原理以及上述物理和代数定义出发，推导加速比 $S$ 的精确符号表达式，$S$ 定义为在所有 $n$ 个控制体积上完整评估 $f(V a)$ 的总操作计数与上述 DEIM 超降阶评估的总操作计数之比。用 $n$、$m$、$r$ 和 $\\gamma$ 表示 $S$。最终答案必须是单一的闭式解析表达式。不需要四舍五入，最终答案中不应包含任何单位。",
            "solution": "该问题要求推导加速比 $S$，$S$ 定义为一个非线性函数的完整评估的计算成本与使用离散经验插值法 (DEIM) 进行超降阶评估的成本之比。成本以浮点运算次数 (flops) 衡量，其中一次加法或乘法计为 $1$ flop，一次指数函数评估 $\\exp(\\cdot)$ 计为 $\\gamma$ flops，其中 $\\gamma  1$。\n\n设 $C_{full}$ 为完整评估的总操作计数，$C_{DEIM}$ 为基于 DEIM 的评估的总操作计数。则加速比定义为 $S = \\frac{C_{full}}{C_{DEIM}}$。\n\n首先，我们推导完整评估的成本 $C_{full}$。此过程涉及两个主要步骤：\n1.  计算完整的过电位向量 $\\eta = V a$。\n2.  使用计算出的向量 $\\eta$ 评估非线性电流密度向量 $f(\\eta)$。\n\n步骤 1：计算 $\\eta = V a$ 的成本。\n基矩阵 $V$ 的大小为 $n \\times r$，降阶坐标向量 $a$ 的大小为 $r \\times 1$。得到的过电位向量 $\\eta$ 的大小为 $n \\times 1$。每个分量 $\\eta_i$ 的计算由点积 $\\eta_i = \\sum_{j=1}^{r} V_{ij} a_j$ 给出。两个长度为 $r$ 的向量的点积需要 $r$ 次乘法和 $r-1$ 次加法。根据指定的成本模型，这总共需要 $r + (r-1) = 2r - 1$ 次操作。由于 $\\eta$ 中有 $n$ 个分量，并且问题说明 $V$ 是一个稠密矩阵，因此该矩阵-向量乘法的总成本为：\n$$C_1 = n(2r-1)$$\n\n步骤 2：评估 $f(\\eta)$ 的成本。\n非线性函数 $f$ 对 $n$ 个控制体积中的每一个进行分量评估。对于每个分量 $i$，评估由 Butler-Volmer 方程给出：\n$$f_i(\\eta_i) = i_{0,i} \\left( \\exp\\left( c_a \\eta_i \\right) - \\exp\\left( -c_c \\eta_i \\right) \\right)$$\n其中复合常数 $c_a = \\frac{\\alpha_a F}{R T}$ 和 $c_c = \\frac{\\alpha_c F}{R T}$ 是预先计算好的。评估一个分量 $f_i(\\eta_i)$ 的成本确定如下：\n-   项 $c_a \\eta_i$ 需要 $1$ 次乘法。\n-   项 $-c_c \\eta_i$ 需要 $1$ 次乘法（与负常数 $-c_c$ 相乘）。\n-   评估 $\\exp(c_a \\eta_i)$ 的成本为 $\\gamma$ 次操作。\n-   评估 $\\exp(-c_c \\eta_i)$ 的成本为 $\\gamma$ 次操作。\n-   两个指数项之间的减法需要 $1$ 次加/减法操作。\n-   最后与交换电流密度 $i_{0,i}$ 的乘法需要 $1$ 次乘法。\n因此，每个分量的总成本为 $1 + 1 + \\gamma + \\gamma + 1 + 1 = 4 + 2\\gamma$ 次操作。由于有 $n$ 个分量需要评估，此步骤的总成本为：\n$$C_2 = n(4 + 2\\gamma)$$\n\n完整评估的总成本是这两个步骤的成本之和：\n$$C_{full} = C_1 + C_2 = n(2r-1) + n(4+2\\gamma) = n(2r - 1 + 4 + 2\\gamma) = n(2r + 3 + 2\\gamma)$$\n\n接下来，我们推导 DEIM 超降阶评估的成本 $C_{DEIM}$。问题将其描述为重构近似 $\\tilde{f}(\\eta) = U (P^{\\top} U)^{-1} (P^{\\top} f(\\eta))$。为了计算效率，此在线评估分四个步骤进行：\n\n步骤 1：计算 $m$ 个插值点上的过电位值 $\\eta_p$。\n这是通过计算 $\\eta_p = (P^{\\top}V)a$ 来实现的。矩阵 $P^{\\top}$ 是一个采样矩阵，它从 $V$ 中选择 $m$ 行。得到的矩阵 $P^{\\top}V$ 的维度是 $m \\times r$。这个 $m \\times r$ 矩阵与 $r \\times 1$ 向量 $a$ 的乘积是一个矩阵-向量乘法，需要 $m(2r-1)$ 次操作。\n$$C_{DEIM,1} = m(2r-1)$$\n\n步骤 2：在 $m$ 个插值点上评估非线性函数 $f$。\n使用向量 $\\eta_p$ 中的 $m$ 个值，我们评估非线性函数的相应分量。如前所述，每个分量的成本是 $4 + 2\\gamma$。对于 $m$ 个分量，总成本为：\n$$C_{DEIM,2} = m(4+2\\gamma)$$\n此步骤产生一个向量 $f_p \\in \\mathbb{R}^m$。\n\n步骤 3：计算 DEIM 近似的降阶系数。\n这是通过计算 $c = (P^{\\top} U)^{-1} f_p$ 来执行的。问题说明逆矩阵 $(P^{\\top} U)^{-1} \\in \\mathbb{R}^{m \\times m}$ 是预先计算好的。因此，该计算是这个 $m \\times m$ 矩阵与 $m \\times 1$ 向量 $f_p$ 的乘积。这个矩阵-向量乘法的成本是 $m(2m-1)$ 次操作。\n$$C_{DEIM,3} = m(2m-1)$$\n\n步骤 4：重构非线性向量的全维近似。\n近似由 $\\tilde{f} = U c$ 给出。基矩阵 $U$ 的维度是 $n \\times m$，系数向量 $c$ 的维度是 $m \\times 1$。这个矩阵-向量乘积的成本是 $n(2m-1)$ 次操作。\n$$C_{DEIM,4} = n(2m-1)$$\n\nDEIM 评估的总成本是这四个步骤的成本之和：\n$$C_{DEIM} = C_{DEIM,1} + C_{DEIM,2} + C_{DEIM,3} + C_{DEIM,4}$$\n$$C_{DEIM} = m(2r-1) + m(4+2\\gamma) + m(2m-1) + n(2m-1)$$\n通过对带有因子 $m$ 的项进行分组来简化 $C_{DEIM}$ 的表达式：\n$$C_{DEIM} = m((2r-1) + (4+2\\gamma) + (2m-1)) + n(2m-1)$$\n$$C_{DEIM} = m(2r - 1 + 4 + 2\\gamma + 2m - 1) + n(2m-1)$$\n$$C_{DEIM} = m(2m + 2r + 2\\gamma + 2) + n(2m-1)$$\n$$C_{DEIM} = 2m(m + r + \\gamma + 1) + n(2m-1)$$\n\n最后，我们计算加速比 $S$ 作为 $C_{full}$ 与 $C_{DEIM}$ 的比率：\n$$S = \\frac{C_{full}}{C_{DEIM}} = \\frac{n(2r + 3 + 2\\gamma)}{n(2m-1) + 2m(m + r + \\gamma + 1)}$$\n这就是加速比的最终精确符号表达式。",
            "answer": "$$\\boxed{\\frac{n(2r + 2\\gamma + 3)}{n(2m - 1) + 2m(m + r + \\gamma + 1)}}$$"
        }
    ]
}