{
    "hands_on_practices": [
        {
            "introduction": "将连续的物理定律转化为离散的代数方程组，是数值求解偏微分方程（PDEs）的第一步。本练习将引导我们为电极中的固相电势构建“残差”向量，该向量用于衡量当前猜测解与真实解之间的差距。我们将重点实践如何处理应用于集流体和隔膜界面的不同类型的边界条件，这是建立精确电池模型的关键技能。",
            "id": "3932742",
            "problem": "考虑锂离子电池 (LIB) 负极多孔固相基体的一维穿透平面模型，其空间域为 $x \\in [0, L_{n}]$。固相电势 $ \\phi_{s}(x) $ 满足稳态电荷守恒定律，该定律由固相基体中的欧姆定律和界面电荷转移导出，表示为\n$$\n\\nabla \\cdot \\left( \\sigma_{s} \\nabla \\phi_{s} \\right) - a_{s} j = 0,\n$$\n其中 $ \\sigma_{s} $ 是（恒定的）有效固相电导率，$ a_{s} $ 是比界面面积，$ j $ 是单位界面面积的界面反应电流密度。界面反应电流密度由 Butler–Volmer (BV) 关系式建模\n$$\nj = 2 j_{0} \\, \\sinh\\!\\left( \\frac{\\alpha F}{R T} \\, \\eta \\right),\n$$\n其中过电势为\n$$\n\\eta = \\phi_{s} - \\phi_{e} - U(c_{s}),\n$$\n其中 $ j_{0} $ 是交换电流密度，$ \\alpha $ 是电荷转移系数，$ F $ 是法拉第常数，$ R $ 是普适气体常数，$ T $ 是绝对温度，$ \\phi_{e} $ 是电解质电势，$ U(c_{s}) $ 是作为局部固相浓度 $ c_{s} $ 函数的开路电势。假设在一个耦合非线性求解器中，$ j_{0}$、$ \\phi_{e} $ 和 $ U(c_{s}) $ 在离散节点上的值已通过上一次迭代获得。\n\n边界条件施加如下：在集流体界面 $x = 0$ 处，\n$$\n- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=0} = i_{\\mathrm{app}},\n$$\n其中 $ i_{\\mathrm{app}} $ 是外加电流密度（放电时为正），在隔膜界面 $ x = L_{n} $ 处，\n$$\n- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=L_{n}} = 0.\n$$\n\n使用包含 $ N $ 个单元中心未知量 $ \\{ \\phi_{s, i} \\}_{i=1}^{N} $ 的均匀网格对区域进行离散化，节点位置为 $ x_{i} = (i-1) \\Delta x $，其中 $ \\Delta x = L_{n}/(N-1) $。采用二阶有限体积离散方法，对内部面使用中心通量，对边界使用鬼点消除法，构建与集流体相邻的节点 $ i = 1 $ 和与隔膜相邻的节点 $ i = N $ 处固相电势的非线性残差。节点 $ i $ 处的控制体残差定义为流出控制体的净传导通量减去体界面源，即，\n$$\nR_{i}(\\boldsymbol{\\phi}_{s}) \\equiv \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i+1/2}} - \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i-1/2}} \\right] - a_{s} \\, j_{i},\n$$\n其中\n$$\nj_{i} = 2 j_{0,i} \\, \\sinh\\!\\left( \\frac{\\alpha F}{R T} \\left[ \\phi_{s,i} - \\phi_{e,i} - U_{i} \\right] \\right).\n$$\n\n使用边界条件消除鬼点值，将 $ R_{1} $ 和 $ R_{N} $ 明确地用 $ \\phi_{s,1} $, $ \\phi_{s,2} $, $ \\phi_{s,N-1} $, $ \\phi_{s,N} $, $ \\sigma_{s} $, $ \\Delta x $, $ a_{s} $, $ i_{\\mathrm{app}} $, $ j_{0,i} $, $ \\alpha $, $ F $, $ R $, $ T $, $ \\phi_{e,i} $ 和 $ U_{i} $ 表示。你的最终答案必须是单个闭式解析表达式；将数对 $ \\left( R_{1}, R_{N} \\right) $ 以单行矩阵的形式报告。在你的最终方框答案中不要包含单位。",
            "solution": "该问题要求推导电池电极一维离散域边界节点上固相电势 $\\phi_{s}$ 的非线性残差。控制方程是一个带有混合边界条件的非线性二阶常微分方程。\n\n首先，我们验证该问题。\n**步骤 1：提取已知条件**\n- 控制方程：$\\nabla \\cdot \\left( \\sigma_{s} \\nabla \\phi_{s} \\right) - a_{s} j = 0$，对于 $x \\in [0, L_{n}]$。在一维情况下，这表示为 $\\frac{d}{dx} \\left( \\sigma_{s} \\frac{d \\phi_{s}}{d x} \\right) - a_{s} j = 0$。\n- 界面电流密度 (Butler-Volmer)：$j = 2 j_{0} \\, \\sinh\\!\\left( \\frac{\\alpha F}{R T} \\, \\eta \\right)$。\n- 过电势：$\\eta = \\phi_{s} - \\phi_{e} - U(c_{s})$。\n- 在 $x=0$ 处的边界条件：$- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=0} = i_{\\mathrm{app}}$。\n- 在 $x=L_{n}$ 处的边界条件：$- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=L_{n}} = 0$。\n- 离散化：均匀网格上的 $N$ 个未知量 $\\{\\phi_{s,i}\\}_{i=1}^{N}$。\n- 节点坐标：$x_{i} = (i-1) \\Delta x$，其中 $i=1, \\dots, N$。\n- 网格间距：$\\Delta x = L_{n}/(N-1)$。这将节点 $1$ 置于 $x_1=0$ 处，节点 $N$ 置于 $x_N=L_n$ 处。\n- 残差定义：$R_{i}(\\boldsymbol{\\phi}_{s}) \\equiv \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i+1/2}} - \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i-1/2}} \\right] - a_{s} \\, j_{i}$。\n- 离散电流密度：$j_{i} = 2 j_{0,i} \\, \\sinh\\!\\left( \\frac{\\alpha F}{R T} \\left[ \\phi_{s,i} - \\phi_{e,i} - U_{i} \\right] \\right)$。\n- 已知量：$\\sigma_{s}$, $a_{s}$, $i_{\\mathrm{app}}$, $j_{0,i}$, $\\alpha$, $F$, $R$, $T$, $\\phi_{e,i}$, $U_{i}$。\n- 任务：求出残差 $R_{1}$ 和 $R_{N}$ 的显式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了电化学领域的标准模型（Newman 模型框架）。作为一个非线性边值问题，它在数学上是适定的。所有项都已定义，并提供了离散化所需的信息。关于数值方法（“采用中心通量和鬼点消除法的二阶有限体积离散”）的说明是清晰的，尽管术语“单元中心”被不严格地用于实际上是节点中心的网格。这种模糊性不妨碍得出一致的解释和解。该问题是计算科学中的一个标准练习，并且是完全有效的。\n\n**步骤 3：求解**\n我们将应用指定的“鬼点消除法”，该方法涉及在域外引入鬼点以施加边界条件，同时使用标准的中心差分格式。所提供的残差公式与有限体积法一致，其中每个控制体的宽度为 $\\Delta x$。\n\n**在集流体界面处的残差，$R_{1}$ (对于 $i=1$)**\n\n节点 $i$ 处残差的一般公式为：\n$$\nR_{i} = \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i+1/2}} - \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{i-1/2}} \\right] - a_{s} j_{i}\n$$\n对于位于 $x_1=0$ 处的节点 $i=1$，其残差为：\n$$\nR_{1} = \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{3/2}} - \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{1/2}} \\right] - a_{s} j_{1}\n$$\n在面 $x_{3/2}$（$x_1$ 和 $x_2$ 之间的中点）处的梯度由二阶中心差分近似：\n$$\n\\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{3/2}} \\approx \\frac{\\phi_{s,2} - \\phi_{s,1}}{\\Delta x}\n$$\n在面 $x_{1/2}$（$x_1$ 和鬼点 $x_0 = -\\Delta x$ 之间的中点）处的梯度为：\n$$\n\\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{1/2}} \\approx \\frac{\\phi_{s,1} - \\phi_{s,0}}{\\Delta x}\n$$\n将这些代入 $R_1$ 的表达式中，得到：\n$$\nR_{1} = \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\frac{\\phi_{s,2} - \\phi_{s,1}}{\\Delta x} - \\frac{\\phi_{s,1} - \\phi_{s,0}}{\\Delta x} \\right] - a_{s} j_{1} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,2} - 2\\phi_{s,1} + \\phi_{s,0}) - a_{s} j_{1}\n$$\n为了消除鬼点值 $\\phi_{s,0}$，我们使用在 $x=0$ 处的边界条件：\n$$\n- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=0} = i_{\\mathrm{app}} \\implies \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x_1} = -\\frac{i_{\\mathrm{app}}}{\\sigma_s}\n$$\n我们使用涉及鬼点 $x_0$ 和节点 $x_2$ 的二阶中心差分来近似 $x_1$ 处的导数：\n$$\n\\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x_1} \\approx \\frac{\\phi_{s,2} - \\phi_{s,0}}{2\\Delta x}\n$$\n将其与边界条件相等，得到：\n$$\n\\frac{\\phi_{s,2} - \\phi_{s,0}}{2\\Delta x} = -\\frac{i_{\\mathrm{app}}}{\\sigma_s} \\implies \\phi_{s,0} = \\phi_{s,2} + \\frac{2\\Delta x \\, i_{\\mathrm{app}}}{\\sigma_s}\n$$\n将 $\\phi_{s,0}$ 的这个表达式代回 $R_1$ 的方程中：\n$$\nR_{1} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} \\left( \\phi_{s,2} - 2\\phi_{s,1} + \\left( \\phi_{s,2} + \\frac{2\\Delta x \\, i_{\\mathrm{app}}}{\\sigma_s} \\right) \\right) - a_{s} j_{1}\n$$\n$$\nR_{1} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} \\left( 2\\phi_{s,2} - 2\\phi_{s,1} + \\frac{2\\Delta x \\, i_{\\mathrm{app}}}{\\sigma_s} \\right) - a_{s} j_{1}\n$$\n$$\nR_{1} = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,2} - \\phi_{s,1}) + \\frac{2 i_{\\mathrm{app}}}{\\Delta x} - a_{s} j_{1}\n$$\n最后，代入 $j_1$ 的表达式：\n$$\nR_{1} = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,2} - \\phi_{s,1}) + \\frac{2 i_{\\mathrm{app}}}{\\Delta x} - 2 a_{s} j_{0,1} \\sinh\\!\\left( \\frac{\\alpha F}{R T} (\\phi_{s,1} - \\phi_{e,1} - U_{1}) \\right)\n$$\n\n**在隔膜界面处的残差，$R_{N}$ (对于 $i=N$)**\n\n对于位于 $x_N=L_n$ 处的节点 $i=N$，其残差为：\n$$\nR_{N} = \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{N+1/2}} - \\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{N-1/2}} \\right] - a_{s} j_{N}\n$$\n在面 $x_{N-1/2}$（$x_{N-1}$ 和 $x_N$ 之间的中点）处的梯度为：\n$$\n\\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{N-1/2}} \\approx \\frac{\\phi_{s,N} - \\phi_{s,N-1}}{\\Delta x}\n$$\n在面 $x_{N+1/2}$（$x_N$ 和鬼点 $x_{N+1} = L_n + \\Delta x$ 之间的中点）处的梯度为：\n$$\n\\left. \\frac{\\partial \\phi_{s}}{\\partial x} \\right|_{x_{N+1/2}} \\approx \\frac{\\phi_{s,N+1} - \\phi_{s,N}}{\\Delta x}\n$$\n将这些代入 $R_N$ 的表达式中，得到：\n$$\nR_{N} = \\frac{\\sigma_{s}}{\\Delta x} \\left[ \\frac{\\phi_{s,N+1} - \\phi_{s,N}}{\\Delta x} - \\frac{\\phi_{s,N} - \\phi_{s,N-1}}{\\Delta x} \\right] - a_{s} j_{N} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N+1} - 2\\phi_{s,N} + \\phi_{s,N-1}) - a_{s} j_{N}\n$$\n为了消除鬼点值 $\\phi_{s,N+1}$，我们使用在 $x=L_n$ 处的零通量边界条件：\n$$\n- \\sigma_{s} \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x=L_n} = 0 \\implies \\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x_N} = 0\n$$\n使用二阶中心差分计算 $x_N$ 处的导数：\n$$\n\\frac{\\partial \\phi_{s}}{\\partial x}\\Big|_{x_N} \\approx \\frac{\\phi_{s,N+1} - \\phi_{s,N-1}}{2\\Delta x} = 0 \\implies \\phi_{s,N+1} = \\phi_{s,N-1}\n$$\n将此代入 $R_N$ 的方程中：\n$$\nR_{N} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N-1} - 2\\phi_{s,N} + \\phi_{s,N-1}) - a_{s} j_{N}\n$$\n$$\nR_{N} = \\frac{\\sigma_{s}}{(\\Delta x)^{2}} (2\\phi_{s,N-1} - 2\\phi_{s,N}) - a_{s} j_{N}\n$$\n$$\nR_{N} = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N-1} - \\phi_{s,N}) - a_{s} j_{N}\n$$\n最后，代入 $j_N$ 的表达式：\n$$\nR_{N} = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N-1} - \\phi_{s,N}) - 2 a_{s} j_{0,N} \\sinh\\!\\left( \\frac{\\alpha F}{R T} (\\phi_{s,N} - \\phi_{e,N} - U_{N}) \\right)\n$$\n\n数对 $(R_1, R_N)$ 构成最终答案。\n为清晰起见，令 sinh 项中的常数组为 $\\beta = \\frac{\\alpha F}{R T}$。\n$R_1 = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,2} - \\phi_{s,1}) + \\frac{2 i_{\\mathrm{app}}}{\\Delta x} - 2 a_{s} j_{0,1} \\sinh\\!\\left( \\beta (\\phi_{s,1} - \\phi_{e,1} - U_{1}) \\right)$。\n$R_N = \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N-1} - \\phi_{s,N}) - 2 a_{s} j_{0,N} \\sinh\\!\\left( \\beta (\\phi_{s,N} - \\phi_{e,N} - U_{N}) \\right)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,2} - \\phi_{s,1}) + \\frac{2 i_{\\mathrm{app}}}{\\Delta x} - 2 a_{s} j_{0,1} \\sinh\\!\\left( \\frac{\\alpha F}{R T} (\\phi_{s,1} - \\phi_{e,1} - U_{1}) \\right) & \\frac{2\\sigma_{s}}{(\\Delta x)^{2}} (\\phi_{s,N-1} - \\phi_{s,N}) - 2 a_{s} j_{0,N} \\sinh\\!\\left( \\frac{\\alpha F}{R T} (\\phi_{s,N} - \\phi_{e,N} - U_{N}) \\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在建立了残差方程之后，为了使用牛顿法等高效的求解器，下一步便是计算雅可比矩阵。雅可比矩阵描述了残差对各个未知变量的敏感度，从而为求解器指明了迭代优化的方向。本练习将聚焦于电解质电势方程，推导其雅可比矩阵的各个分量，展示输运现象和反应动力学如何共同构成系统的线性化形式。",
            "id": "3932723",
            "problem": "在锂离子电池的多孔电极中，考虑写成一维空间的电解质电荷守恒，即离子电流密度的散度加上界面源等于零。控制定律如下。\n\n基本平衡：$\\nabla \\cdot \\mathbf{i}_e + a\\, j = 0$，其中 $\\mathbf{i}_e$ 是电解质离子电流密度，$a$ 是单位体积的界面面积，$j$ 是界面反应电流密度。\n\n电解质电流的本构关系 (Stefan–Maxwell 形式)：$\\mathbf{i}_e = -\\kappa(c,T)\\, \\nabla \\phi_e - \\dfrac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa(c,T)\\, \\nabla \\ln c$，其中 $\\kappa$ 是电解质电导率，$c$ 是电解质盐浓度，$T$ 是温度，$R$ 是普适气体常数，$F$ 是法拉第常数，$t_+^0$ 是迁移数，$\\phi_e$ 是电解质电势。\n\n动力学：$j = j(\\eta,c)$，其中过电势为 $\\eta = \\phi_s - \\phi_e - U(c)$，$\\phi_s$ 是固相电势，$U(c)$ 是开路电势。\n\n在宽度为 $\\Delta x$ 的均匀一维有限体积网格上离散化电解质电荷守恒方程。对于索引为 $i$ 的内部控制体积，在面 $i \\pm \\tfrac{1}{2}$ 处使用两点通量近似，其中面电导率 $\\kappa_{i \\pm \\tfrac{1}{2}}$ 被视为上一次迭代的已知量。节点 $i$ 处电解质电势方程的离散残差为\n$$\nR_i = \\frac{i_{e,i+\\tfrac{1}{2}} - i_{e,i-\\tfrac{1}{2}}}{\\Delta x} + a_i\\, j_i(\\eta_i,c_i),\n$$\n其中\n$$\ni_{e,i+\\tfrac{1}{2}} = -\\kappa_{i+\\tfrac{1}{2}} \\frac{\\phi_{e,i+1} - \\phi_{e,i}}{\\Delta x} - \\frac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa_{i+\\tfrac{1}{2}} \\frac{\\ln c_{i+1} - \\ln c_i}{\\Delta x},\n$$\n$i_{e,i-\\tfrac{1}{2}}$ 有一个类似的表达式。假设，为了组装关于电解质电势未知数的雅可比矩阵行，$c$，$T$，$t_+^0$，$\\phi_s$，$U(c)$，$a_i$ 和 $\\kappa_{i \\pm \\tfrac{1}{2}}$ 保持不变，并将 $\\partial j_i/\\partial \\eta_i$ 表示为在当前迭代步计算的动力学灵敏度。\n\n哪个选项正确给出了残差 $R_i$ 相对于电解质电势未知数的局部模板的三个非零雅可比项，即偏导数 $\\partial R_i/\\partial \\phi_{e,i-1}$，$\\partial R_i/\\partial \\phi_{e,i}$ 和 $\\partial R_i/\\partial \\phi_{e,i+1}$？\n\nA. \n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$\n\nB. \n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} + a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$\n\nC.\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{2\\,\\kappa_{i}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i}}{\\Delta x^2}.$\n\nD.\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = \\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = \\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$",
            "solution": "### 问题验证\n\n#### 步骤 1：提取已知条件\n\n问题陈述提供了以下信息：\n- **控制方程（电荷守恒）**：$\\nabla \\cdot \\mathbf{i}_e + a\\, j = 0$，其中 $\\mathbf{i}_e$ 是电解质离子电流密度，$a$ 是单位体积的界面面积，$j$ 是界面反应电流密度。\n- **本构关系（离子电流）**：$\\mathbf{i}_e = -\\kappa(c,T)\\, \\nabla \\phi_e - \\dfrac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa(c,T)\\, \\nabla \\ln c$，变量为 $\\kappa$ (电导率)，$c$ (浓度)，$T$ (温度)，$R$ (气体常数)，$F$ (法拉第常数)，$t_+^0$ (迁移数) 和 $\\phi_e$ (电解质电势)。\n- **动力学**：$j = j(\\eta,c)$，其中过电势为 $\\eta = \\phi_s - \\phi_e - U(c)$，$\\phi_s$ 是固相电势，$U(c)$ 是开路电势。\n- **离散残差**：对于宽度为 $\\Delta x$ 的均匀一维网格上的内部控制体积 $i$，残差为 $R_i = \\frac{i_{e,i+\\tfrac{1}{2}} - i_{e,i-\\tfrac{1}{2}}}{\\Delta x} + a_i\\, j_i(\\eta_i,c_i)$。\n- **在面 $i+\\tfrac{1}{2}$ 处的离散通量**：$i_{e,i+\\tfrac{1}{2}} = -\\kappa_{i+\\tfrac{1}{2}} \\frac{\\phi_{e,i+1} - \\phi_{e,i}}{\\Delta x} - \\frac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa_{i+\\tfrac{1}{2}} \\frac{\\ln c_{i+1} - \\ln c_i}{\\Delta x}$。\n- **在面 $i-\\tfrac{1}{2}$ 处的离散通量**：适用类似的表达式。\n- **雅可比矩阵计算的假设**：为对 $\\phi_e$ 未知数求导，以下量保持不变：$c$, $T$, $t_+^0$, $\\phi_s$, $U(c)$, $a_i$ 和 $\\kappa_{i \\pm \\tfrac{1}{2}}$。\n- **符号表示**：动力学灵敏度表示为 $\\partial j_i/\\partial \\eta_i$。\n- **问题**：确定偏导数 $\\partial R_i/\\partial \\phi_{e,i-1}$，$\\partial R_i/\\partial \\phi_{e,i}$ 和 $\\partial R_i/\\partial \\phi_{e,i+1}$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n- **科学依据**：该问题基于 Doyle-Fuller-Newman (DFN) 模型，这是一个用于模拟锂离子电池的基本且被广泛接受的框架。电荷守恒、离子传输（Stefan-Maxwell）和反应动力学的方程在此背景下是标准的。该问题是已建立的电化学工程原理的直接应用。\n- **适定性**：该问题要求计算一个明确定义的代数表达式（离散残差）的特定偏导数。有限体积法和两点通量近似是标准的数值技术。任务清晰，并能导出一个唯一、可推导的结果。\n- **客观性**：该问题使用精确的数学和技术语言陈述，没有主观或模棱两可的术语。\n\n问题陈述没有任何科学或事实上的不健全之处，是形式化且相关的，是完整且一致的，是物理上合理的，是适定的，并且是一项不简单但标准的计算建模练习。\n\n#### 步骤 3：结论和行动\n\n问题陈述是有效的。我将继续进行推导和求解。\n\n### 雅可比项的推导\n\n任务是计算残差 $R_i$ 相对于局部电解质电势 $\\phi_{e,i-1}$，$\\phi_{e,i}$ 和 $\\phi_{e,i+1}$ 的偏导数。\n\n节点 $i$ 处的残差由下式给出：\n$$\nR_i = \\frac{i_{e,i+\\tfrac{1}{2}} - i_{e,i-\\tfrac{1}{2}}}{\\Delta x} + a_i\\, j_i(\\eta_i,c_i)\n$$\n\n首先，我们通过代入通量项来写出 $R_i$ 的完整表达式。面 $i+\\tfrac{1}{2}$ 处的通量为：\n$$\ni_{e,i+\\tfrac{1}{2}} = -\\kappa_{i+\\tfrac{1}{2}} \\frac{\\phi_{e,i+1} - \\phi_{e,i}}{\\Delta x} - \\frac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa_{i+\\tfrac{1}{2}} \\frac{\\ln c_{i+1} - \\ln c_i}{\\Delta x}\n$$\n以此类推，面 $i-\\tfrac{1}{2}$ 处的通量为：\n$$\ni_{e,i-\\tfrac{1}{2}} = -\\kappa_{i-\\tfrac{1}{2}} \\frac{\\phi_{e,i} - \\phi_{e,i-1}}{\\Delta x} - \\frac{2 R T}{F}\\left(1 - t_+^0\\right) \\kappa_{i-\\tfrac{1}{2}} \\frac{\\ln c_i - \\ln c_{i-1}}{\\Delta x}\n$$\n反应项 $j_i$ 通过过电势 $\\eta_i = \\phi_{s,i} - \\phi_{e,i} - U(c_i)$ 依赖于 $\\phi_{e,i}$。\n\n我们现在将计算三个所需的偏导数。根据问题陈述，除了模板电势 $\\phi_{e,i-1}, \\phi_{e,i}, \\phi_{e,i+1}$ 之外的所有变量都被视为常数。因此，涉及 $\\ln c$ 的项相对于这些电势是常数。\n\n1.  **关于 $\\phi_{e,i-1}$ 的偏导数**：\n    电势 $\\phi_{e,i-1}$ 仅出现在通量 $i_{e,i-\\tfrac{1}{2}}$ 的表达式中。项 $i_{e,i+\\tfrac{1}{2}}$ 和 $j_i$ 独立于 $\\phi_{e,i-1}$。\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = \\frac{1}{\\Delta x} \\frac{\\partial}{\\partial \\phi_{e,i-1}} (-i_{e,i-\\tfrac{1}{2}})\n    $$\n    我们计算通量的导数：\n    $$\n    \\frac{\\partial i_{e,i-\\tfrac{1}{2}}}{\\partial \\phi_{e,i-1}} = \\frac{\\partial}{\\partial \\phi_{e,i-1}} \\left( -\\kappa_{i-\\tfrac{1}{2}} \\frac{\\phi_{e,i} - \\phi_{e,i-1}}{\\Delta x} \\right) = -\\kappa_{i-\\tfrac{1}{2}} \\left( \\frac{-1}{\\Delta x} \\right) = \\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x}\n    $$\n    将其代回 $\\partial R_i/\\partial \\phi_{e,i-1}$ 的表达式中：\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = \\frac{1}{\\Delta x} \\left( - \\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x} \\right) = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}\n    $$\n\n2.  **关于 $\\phi_{e,i+1}$ 的偏导数**：\n    类似地，电势 $\\phi_{e,i+1}$ 仅出现在通量 $i_{e,i+\\tfrac{1}{2}}$ 的表达式中。\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = \\frac{1}{\\Delta x} \\frac{\\partial}{\\partial \\phi_{e,i+1}} (i_{e,i+\\tfrac{1}{2}})\n    $$\n    通量的导数为：\n    $$\n    \\frac{\\partial i_{e,i+\\tfrac{1}{2}}}{\\partial \\phi_{e,i+1}} = \\frac{\\partial}{\\partial \\phi_{e,i+1}} \\left( -\\kappa_{i+\\tfrac{1}{2}} \\frac{\\phi_{e,i+1} - \\phi_{e,i}}{\\Delta x} \\right) = -\\kappa_{i+\\tfrac{1}{2}} \\left( \\frac{1}{\\Delta x} \\right) = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x}\n    $$\n    将其代回：\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = \\frac{1}{\\Delta x} \\left( - \\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x} \\right) = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}\n    $$\n\n3.  **关于 $\\phi_{e,i}$ 的偏导数**：\n    电势 $\\phi_{e,i}$ 出现在通量项 $i_{e,i-\\tfrac{1}{2}}$ 和 $i_{e,i+\\tfrac{1}{2}}$ 中，以及通过 $\\eta_i$ 出现在反应项 $j_i$ 中。\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{1}{\\Delta x} \\left( \\frac{\\partial i_{e,i+\\tfrac{1}{2}}}{\\partial \\phi_{e,i}} - \\frac{\\partial i_{e,i-\\tfrac{1}{2}}}{\\partial \\phi_{e,i}} \\right) + a_i \\frac{\\partial j_i}{\\partial \\phi_{e,i}}\n    $$\n    我们评估每个分量：\n    - $i_{e,i+\\tfrac{1}{2}}$ 的导数：\n      $$\n      \\frac{\\partial i_{e,i+\\tfrac{1}{2}}}{\\partial \\phi_{e,i}} = \\frac{\\partial}{\\partial \\phi_{e,i}} \\left( -\\kappa_{i+\\tfrac{1}{2}} \\frac{\\phi_{e,i+1} - \\phi_{e,i}}{\\Delta x} \\right) = -\\kappa_{i+\\tfrac{1}{2}} \\left( \\frac{-1}{\\Delta x} \\right) = \\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x}\n      $$\n    - $i_{e,i-\\tfrac{1}{2}}$ 的导数：\n      $$\n      \\frac{\\partial i_{e,i-\\tfrac{1}{2}}}{\\partial \\phi_{e,i}} = \\frac{\\partial}{\\partial \\phi_{e,i}} \\left( -\\kappa_{i-\\tfrac{1}{2}} \\frac{\\phi_{e,i} - \\phi_{e,i-1}}{\\Delta x} \\right) = -\\kappa_{i-\\tfrac{1}{2}} \\left( \\frac{1}{\\Delta x} \\right) = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x}\n      $$\n    - 使用链式法则求 $j_i$ 的导数：\n      $$\n      \\frac{\\partial j_i}{\\partial \\phi_{e,i}} = \\frac{\\partial j_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\phi_{e,i}}\n      $$\n      对于 $\\eta_i = \\phi_{s,i} - \\phi_{e,i} - U(c_i)$，并注意到 $\\phi_{s,i}$ 和 $U(c_i)$ 保持不变：\n      $$\n      \\frac{\\partial \\eta_i}{\\partial \\phi_{e,i}} = -1\n      $$\n      因此：\n      $$\n      \\frac{\\partial j_i}{\\partial \\phi_{e,i}} = -\\frac{\\partial j_i}{\\partial \\eta_i}\n      $$\n    现在，我们组装完整的偏导数 $\\partial R_i/\\partial \\phi_{e,i}$：\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{1}{\\Delta x} \\left[ \\left( \\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x} \\right) - \\left( -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x} \\right) \\right] + a_i \\left( -\\frac{\\partial j_i}{\\partial \\eta_i} \\right)\n    $$\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i+\\tfrac{1}{2}} + \\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}\n    $$\n    重新排列分子中的项以匹配选项的惯例：\n    $$\n    \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}\n    $$\n\n### 结果摘要和选项评估\n推导出的雅可比项为：\n- $\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}$\n- $\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}$\n- $\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}$\n\n现在我们评估每个选项：\n\n**A.**\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$\n这组表达式与我们推导出的所有三个偏导数的结果完全匹配。\n**结论：正确**\n\n**B.**\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} + a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$\n此选项在 $\\partial R_i/\\partial \\phi_{e,i}$ 的表达式中，反应动力学项的符号不正确。该符号应为负，这是从链式法则 $\\partial j_i / \\partial \\phi_{e,i} = (\\partial j_i / \\partial \\eta_i) \\cdot (-1)$ 推导出来的。\n**结论：不正确**\n\n**C.**\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = -\\frac{\\kappa_{i}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = \\frac{2\\,\\kappa_{i}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = -\\frac{\\kappa_{i}}{\\Delta x^2}.$\n此选项错误地使用了网格中心电导率 $\\kappa_i$ 而不是问题陈述中为通量近似指定的面电导率 $\\kappa_{i \\pm \\tfrac{1}{2}}$。这与所提供的离散化方案不一致。\n**结论：不正确**\n\n**D.**\n$\\displaystyle \\frac{\\partial R_i}{\\partial \\phi_{e,i-1}} = \\frac{\\kappa_{i-\\tfrac{1}{2}}}{\\Delta x^2}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i}} = -\\frac{\\kappa_{i-\\tfrac{1}{2}} + \\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2} - a_i \\frac{\\partial j_i}{\\partial \\eta_i}, \\quad \\frac{\\partial R_i}{\\partial \\phi_{e,i+1}} = \\frac{\\kappa_{i+\\tfrac{1}{2}}}{\\Delta x^2}.$\n此选项将所有由通量产生的项的符号都反了。例如，$\\partial R_i/\\partial \\phi_{e,i-1}$ 应为 $-\\kappa_{i-\\tfrac{1}{2}}/\\Delta x^2$，而不是正数。同样的错误也影响了其他由通量导出的项。\n**结论：不正确**",
            "answer": "$$\n\\boxed{A}\n$$"
        },
        {
            "introduction": "实际的数值模拟常常会遇到各种挑战，其中一个常见问题是当离子浓度趋近于零时，求解过程会变得病态，甚至导致求解器失败。本节高级实践将探讨一种强大的变量变换技术——对数变换，用以解决此问题，从而确保求解器在极限条件下的稳定性和结果的物理真实性。我们将学习如何通过这种变换重新构建残差和雅可比矩阵，以改善模型的数值性能。",
            "id": "3932811",
            "problem": "在一个多孔电极锂离子电池模型中，考虑一个具有均匀属性的一维域，以及一个索引为 $i$ 的内部控制体，其相邻节点为 $i-1$ 和 $i+1$。设 $x$ 为空间坐标，$\\Delta x$ 为均匀单元间距，$\\Delta t$ 为时间步长，$c_e$ 为电解质盐浓度，$\\phi_e$ 为电解质电势，$\\varepsilon$ 为电解质孔隙率，$D_{\\mathrm{eff}}$ 为有效电解质扩散系数，$\\kappa_{\\mathrm{eff}}$ 为有效电解质离子电导率，$t_+^0$ 为阳离子迁移数（相对于溶剂），$a_s$ 为比界面面积，$R$ 为普适气体常数，$T$ 为绝对温度，$F$ 为法拉第常数。假设在所考虑的计算模板中，条件为等温，且系数 $\\varepsilon$、$D_{\\mathrm{eff}}$ 和 $\\kappa_{\\mathrm{eff}}$ 为常数。用 $j_i$ 表示在节点 $i$ 处计算的界面电流密度，并为了单个牛顿步的目的将其视为已知。\n\n从浓溶液理论中的物质守恒和电解质电荷守恒出发，在节点 $i$ 处进行标准的完全隐式有限体积离散化，得到耦合的代数残差\n$$\nR_i^{(c)}(c_e) \\;=\\; \\varepsilon\\,\\frac{c_{e,i} - c_{e,i}^{\\,n}}{\\Delta t} \\;-\\; \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\left(c_{e,i+1} - 2\\,c_{e,i} + c_{e,i-1}\\right) \\;-\\; \\frac{1 - t_+^0}{F}\\,a_s\\,j_i \\,=\\, 0,\n$$\n$$\nR_i^{(e)}(\\phi_e,c_e) \\;=\\; \\frac{\\kappa_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\phi_{e,i+1} - 2\\,\\phi_{e,i} + \\phi_{e,i-1}\\right) \\;+\\; \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\\left(\\ln c_{e,i+1} - 2\\,\\ln c_{e,i} + \\ln c_{e,i-1}\\right) \\;-\\; a_s\\,j_i \\,=\\, 0,\n$$\n其中 $c_{e,i}^{\\,n}$ 是前一时间步的已知浓度。第二个残差来自于电解质电荷守恒，使用了浓溶液通量本构关系，其中出现了 $\\ln c_e$ 的梯度。牛顿法应用于未知向量 $u = [\\,\\ldots, c_{e,i-1}, c_{e,i}, c_{e,i+1}, \\ldots, \\phi_{e,i-1}, \\phi_{e,i}, \\phi_{e,i+1}, \\ldots ]^\\top$，需要雅可比矩阵项 $\\partial R/\\partial u$。\n\n在实践中观察到，当接近电解质耗尽时，即 $c_{e,i} \\to 0^+$ 时，如果直接使用 $c_e$ 作为主变量，牛顿步可能会变得病态，并产生非物理的负浓度。一个常见的解决方法是引入对数变量替换 $\\psi_i = \\ln c_{e,i}$，并通过在适当位置代入 $c_{e,j} = \\exp(\\psi_j)$ 来定义变换后的残差，从而保证 $c_e$ 的正性并改善雅可比矩阵的标度。\n\n哪个选项正确地指出了原始公式中的病态机制，并为给定的计算模板提供了数学上一致的变换后残差系统 $\\tilde R(\\phi_e,\\psi)$ 以及关于 $\\psi$ 的正确雅可比块？\n\nA. 病态的产生是因为 $\\partial R_i^{(e)}/\\partial c_{e,i}$ 在对 $\\ln c_{e,i}$ 求导时包含了与 $1/c_{e,i}$ 成正比的因子，当 $c_{e,i}\\to 0^+$ 时，该因子会发散。变换后的残差通过代入 $c_{e,j}=\\exp(\\psi_j)$ 得到：\n$$\n\\tilde R_i^{(c)}(\\psi) \\;=\\; \\varepsilon\\,\\frac{e^{\\psi_i} - c_{e,i}^{\\,n}}{\\Delta t} \\;-\\; \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\left(e^{\\psi_{i+1}} - 2\\,e^{\\psi_i} + e^{\\psi_{i-1}}\\right) \\;-\\; \\frac{1 - t_+^0}{F}\\,a_s\\,j_i,\n$$\n$$\n\\tilde R_i^{(e)}(\\phi_e,\\psi) \\;=\\; \\frac{\\kappa_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\phi_{e,i+1} - 2\\,\\phi_{e,i} + \\phi_{e,i-1}\\right) \\;+\\; \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\\left(\\psi_{i+1} - 2\\,\\psi_i + \\psi_{i-1}\\right) \\;-\\; a_s\\,j_i.\n$$\n相应的关于 $\\psi$ 的雅可比矩阵项是\n$$\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_i} \\;=\\; \\varepsilon\\,\\frac{e^{\\psi_i}}{\\Delta t} \\;+\\; 2\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_i},\\quad\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i\\pm 1}} \\;=\\; -\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i\\pm 1}},\n$$\n$$\n\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_i} \\;=\\; -\\,2\\,\\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2},\\quad\n\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_{i\\pm 1}} \\;=\\; +\\,\\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}.\n$$\n这消除了 $1/c_{e,i}$ 的发散问题，因为 $\\ln c_e$ 项变成了关于 $\\psi$ 的线性项，而正性则由对于所有实数 $\\psi_i$ 都有 $c_{e,i}=\\exp(\\psi_i)>0$ 来保证。\n\nB. 病态是由于 $R_i^{(c)}$ 中的扩散项在 $c_{e,i}\\to 0^+$ 时变小，因此用 $\\psi$ 替换 $c_e$ 也应该用 $\\psi$ 的扩散替换浓度的扩散。因此，变换后的残差应为\n$$\n\\tilde R_i^{(c)}(\\psi) \\;=\\; \\varepsilon\\,\\frac{\\psi_i - \\ln c_{e,i}^{\\,n}}{\\Delta t} \\;-\\; \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\psi_{i+1} - 2\\,\\psi_i + \\psi_{i-1}\\right) \\;-\\; \\frac{1 - t_+^0}{F}\\,a_s\\,j_i,\n$$\n$$\n\\tilde R_i^{(e)}(\\phi_e,\\psi) \\;=\\; \\frac{\\kappa_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\phi_{e,i+1} - 2\\,\\phi_{e,i} + \\phi_{e,i-1}\\right) \\;+\\; \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\\left(\\psi_{i+1} - 2\\,\\psi_i + \\psi_{i-1}\\right) \\;-\\; a_s\\,j_i,\n$$\n其雅可比矩阵项与 $c_e$ 公式中的相同，因为 $\\psi$ 只是一个重新标记。\n\nC. 病态是由反应源项引起的，因此 $\\ln c_e$ 项不需要变换。仅在物质守恒方程中使用 $c_{e,j}=\\exp(\\psi_j)$，并在 $R_i^{(e)}$ 中保留 $\\ln c_e$。$\\tilde R_i^{(c)}$ 关于 $\\psi$ 的雅可比矩阵为\n$$\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_i} \\;=\\; \\varepsilon\\,\\frac{1}{\\Delta t} \\;+\\; 2\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2},\\quad\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i\\pm 1}} \\;=\\; -\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2},\n$$\n因为在使用 $\\psi$ 时，链式法则的因子被抵消了。\n\nD. 病态根本上是由于离散化模板所致；通过在残差中增加一个障碍项 $+\\mu/\\!c_{e,i}$ 就足以确保正定性和条件数，而无需改变变量。其雅可比矩阵是原始雅可比矩阵加上 $\\partial(\\mu/\\!c_{e,i})/\\partial c_{e,i} = -\\mu/c_{e,i}^2$，如果 $\\mu$ 很小，对于小的 $c_{e,i}$ 该项仍然有界。因此，对于稳健的牛顿步来说，变量变换是不必要的。\n\n选择在病态机制的识别、变换后的残差和雅可比表达式方面对给定离散化完全正确，同时保证在耗尽附近的正性和改善的条件数的选项。",
            "solution": "用户希望我扮演一位严谨的STEM教授，验证所提供的问题陈述，然后通过分析给定的选项来解决它。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n\n问题提供了以下信息：\n- **模型：** 一维多孔电极锂离子电池模型。\n- **离散化：** 一个索引为 $i$ 的内部控制体，其相邻节点为 $i-1$ 和 $i+1$，均匀单元间距 $\\Delta x$，时间步长 $\\Delta t$。\n- **变量：** 电解质盐浓度 $c_e$，电解质电势 $\\phi_e$。\n- **常数和参数：** 电解质孔隙率 $\\varepsilon$，有效电解质扩散系数 $D_{\\mathrm{eff}}$，有效电解质离子电导率 $\\kappa_{\\mathrm{eff}}$，阳离子迁移数 $t_+^0$，比界面面积 $a_s$，普适气体常数 $R$，绝对温度 $T$，法拉第常数 $F$。\n- **假设：** 等温条件；在所考虑的计算模板中 $\\varepsilon$，$D_{\\mathrm{eff}}$ 和 $\\kappa_{\\mathrm{eff}}$ 为常数；界面电流密度 $j_i$ 在单个牛顿步中被视为已知。\n- **原始残差方程：**\n  $$\n  R_i^{(c)}(c_e) \\;=\\; \\varepsilon\\,\\frac{c_{e,i} - c_{e,i}^{\\,n}}{\\Delta t} \\;-\\; \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\left(c_{e,i+1} - 2\\,c_{e,i} + c_{e,i-1}\\right) \\;-\\; \\frac{1 - t_+^0}{F}\\,a_s\\,j_i \\,=\\, 0\n  $$\n  $$\n  R_i^{(e)}(\\phi_e,c_e) \\;=\\; \\frac{\\kappa_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\phi_{e,i+1} - 2\\,\\phi_{e,i} + \\phi_{e,i-1}\\right) \\;+\\; \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\\left(\\ln c_{e,i+1} - 2\\,\\ln c_{e,i} + \\ln c_{e,i-1}\\right) \\;-\\; a_s\\,j_i \\,=\\, 0\n  $$\n  其中 $c_{e,i}^{\\,n}$ 是上一时间层级的浓度。\n- **数值背景：** 该系统使用牛顿法求解未知向量 $u = [\\,\\ldots, c_{e,i-1}, c_{e,i}, c_{e,i+1}, \\ldots, \\phi_{e,i-1}, \\phi_{e,i}, \\phi_{e,i+1}, \\ldots ]^\\top$。\n- **问题陈述：** 据观察，当 $c_{e,i} \\to 0^+$ 时，牛顿步会变得病态。一种建议的补救方法是变量替换 $\\psi_i = \\ln c_{e,i}$，从而得到变换后的残差 $\\tilde R(\\phi_e,\\psi)$。\n- **问题：** 识别正确的病态机制、正确的变换后残差系统以及关于 $\\psi$ 的正确雅可比块。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学依据：** 该问题坚实地基于Doyle-Fuller-Newman (DFN) 模型，这是电化学工程领域用于模拟锂离子电池的一个标准且被广泛接受的框架。这些方程代表了源于浓溶液理论的电解质中物质和电荷守恒的离散形式。所有方面在科学上都是合理的。\n2.  **适定性：** 该问题是适定的。它要求验证一个应用于一组标准离散化偏微分方程的标准数值技术（变量替换）。这项任务涉及直接但详细的微积分应用（代入和微分/链式法则），以推导变换后的系统及其雅可比矩阵。存在唯一正确的答案。\n3.  **客观性：** 语言技术性强，精确，没有任何主观或基于意见的陈述。\n4.  **完整性与一致性：** 问题是自洽的。所有必要的方程、变量定义以及原始问题和建议变换的背景都已提供。没有矛盾之处。\n5.  **现实性与可行性：** 在电解质耗尽（$c_e \\to 0$）附近出现病态问题是电池模拟中一个众所周知的实际挑战。对浓度变量进行对数变换是计算电化学中一种常用且有效的技术，用以确保正性并改善数值问题的条件数。这个场景是完全现实的。\n6.  **其他缺陷：** 该问题并非微不足道、结构不良或基于错误推理。它代表了科学计算应用于电池建模领域中一个有效且相关的问题。\n\n#### 步骤 3：结论与行动\n\n问题陈述是**有效**的。其设定在科学上合理，数学上一致，内容完整且具有相关性。我现在开始求解。\n\n### 推导与求解\n\n问题的核心是分析原始系统的雅可比矩阵，执行指定的变量替换，并计算变换后系统的雅可比矩阵。\n\n**1. 原始系统中的病态分析**\n\n牛顿法的雅可比矩阵 $J$ 包含残差对未知变量的偏导数块。问题出现在电解质耗尽附近，即当 $c_{e,i} \\to 0^+$ 时。让我们检查残差对浓度变量 $c_{e,j}$ 的导数。\n\n物质守恒残差为 $R_i^{(c)}$。其对 $c_{e,j}$ 的导数为：\n$$\n\\frac{\\partial R_i^{(c)}}{\\partial c_{e,i}} = \\frac{\\varepsilon}{\\Delta t} + 2\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\n$$\n$$\n\\frac{\\partial R_i^{(c)}}{\\partial c_{e,i \\pm 1}} = -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\n$$\n这些项都是常数且表现良好。它们不会在 $c_{e,i} \\to 0^+$ 时导致病态。\n\n电荷守恒残差为 $R_i^{(e)}$。其对 $c_{e,j}$ 的导数为：\n$$\n\\frac{\\partial R_i^{(e)}}{\\partial c_{e,i}} = \\frac{\\partial}{\\partial c_{e,i}} \\left[ \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}(-2\\,\\ln c_{e,i}) \\right] = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2} \\left( -\\frac{2}{c_{e,i}} \\right)\n$$\n$$\n\\frac{\\partial R_i^{(e)}}{\\partial c_{e,i \\pm 1}} = \\frac{\\partial}{\\partial c_{e,i \\pm 1}} \\left[ \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}(\\ln c_{e,i \\pm 1}) \\right] = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2} \\left( \\frac{1}{c_{e,i \\pm 1}} \\right)\n$$\n当 $c_{e,i} \\to 0^+$ 时，项 $\\partial R_i^{(e)} / \\partial c_{e,i}$ 会发散，因为它与 $1/c_{e,i}$ 成正比。这导致雅可比矩阵中出现极大的项，使其变得病态。牛顿求解器试图计算步长 $\\Delta u = -J^{-1}R$，一个病态的 $J$ 可能导致一个巨大的、非物理的更新 $\\Delta c_{e,i}$，从而使得 $c_{e,i} + \\Delta c_{e,i}  0$。这证实了病态机制。\n\n**2. 变换后残差的推导**\n\n变量替换为 $\\psi_j = \\ln c_{e,j}$，这意味着 $c_{e,j} = \\exp(\\psi_j)$。我们将此代入原始残差方程以获得变换后的残差 $\\tilde{R}$。\n\n对于物质守恒 $R_i^{(c)}$，我们代入 $c_{e,j} = \\exp(\\psi_j)$：\n$$\n\\tilde R_i^{(c)}(\\psi) = \\varepsilon\\,\\frac{\\exp(\\psi_i) - c_{e,i}^{\\,n}}{\\Delta t} \\;-\\; \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\exp(\\psi_{i+1}) - 2\\,\\exp(\\psi_i) + \\exp(\\psi_{i-1})\\right) \\;-\\; \\frac{1 - t_+^0}{F}\\,a_s\\,j_i\n$$\n对于电荷守恒 $R_i^{(e)}$，我们代入 $\\ln c_{e,j} = \\psi_j$：\n$$\n\\tilde R_i^{(e)}(\\phi_e,\\psi) = \\frac{\\kappa_{\\mathrm{eff}}}{\\Delta x^2}\\left(\\phi_{e,i+1} - 2\\,\\phi_{e,i} + \\phi_{e,i-1}\\right) \\;+\\; \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\\left(\\psi_{i+1} - 2\\,\\psi_i + \\psi_{i-1}\\right) \\;-\\; a_s\\,j_i\n$$\n这些 $\\tilde R_i^{(c)}$ 和 $\\tilde R_i^{(e)}$ 的表达式是正确的变换后残差。\n\n**3. 变换后雅可比块的推导**\n\n我们现在计算变换后的残差 $\\tilde R_i$ 对新变量 $\\psi_j$（其中 $j \\in \\{i-1, i, i+1\\}$）的偏导数。\n\n$\\tilde R_i^{(c)}$ 对 $\\psi_j$ 的导数：\n$$\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_i} = \\frac{\\partial}{\\partial \\psi_i} \\left[ \\varepsilon\\,\\frac{e^{\\psi_i}}{\\Delta t} - \\frac{D_{\\mathrm{eff}}}{\\Delta x^2}(-2\\,e^{\\psi_i}) \\right] = \\varepsilon\\,\\frac{e^{\\psi_i}}{\\Delta t} + 2\\,\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_i}\n$$\n$$\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i+1}} = \\frac{\\partial}{\\partial \\psi_{i+1}} \\left[ -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i+1}} \\right] = -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i+1}}\n$$\n$$\n\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i-1}} = \\frac{\\partial}{\\partial \\psi_{i-1}} \\left[ -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i-1}} \\right] = -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i-1}}\n$$\n这些可以紧凑地写成 $\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i\\pm 1}} = -\\frac{D_{\\mathrm{eff}}}{\\Delta x^2}\\,e^{\\psi_{i\\pm 1}}$。\n\n$\\tilde R_i^{(e)}$ 对 $\\psi_j$ 的导数：\n变换后的残差 $\\tilde R_i^{(e)}$ 现在是 $\\psi_j$ 的线性函数。设 $K = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}$。相关部分是 $K(\\psi_{i+1} - 2\\,\\psi_i + \\psi_{i-1})$。\n$$\n\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_i} = \\frac{\\partial}{\\partial \\psi_i} \\left[ K(-2\\,\\psi_i) \\right] = -2\\,K = -2\\,\\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\n$$\n$$\n\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_{i+1}} = \\frac{\\partial}{\\partial \\psi_{i+1}} \\left[ K(\\psi_{i+1}) \\right] = K = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\n$$\n$$\n\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_{i-1}} = \\frac{\\partial}{\\partial \\psi_{i-1}} \\left[ K(\\psi_{i-1}) \\right] = K = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}\n$$\n这些可以紧凑地写成 $\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_{i\\pm 1}} = \\frac{2\\,R\\,T\\,(1 - t_+^0)\\,\\kappa_{\\mathrm{eff}}}{F\\,\\Delta x^2}$。\n\n与 $1/c_{e,i}$ 成正比的奇异项已被消除。新的雅可比矩阵项 $\\partial \\tilde R_i^{(e)}/\\partial \\psi_j$ 是常数。项 $\\partial \\tilde R_i^{(c)}/\\partial \\psi_j$ 与 $e^{\\psi_j} = c_{e,j}$ 成正比，当 $c_{e,j} \\to 0$ 时趋于零，这在数值上是良性的。此外，由于 $c_{e,j} = \\exp(\\psi_j)$，对于任何实数值 $\\psi_j$，浓度都保证为正。\n\n### 逐项分析选项\n\n**A. 病态的产生是因为 $\\partial R_i^{(e)}/\\partial c_{e,i}$ 在对 $\\ln c_{e,i}$ 求导时包含了与 $1/c_{e,i}$ 成正比的因子，当 $c_{e,i}\\to 0^+$ 时，该因子会发散。变换后的残差是... 相应的雅可比矩阵项...**\n-   **病态机制：** 我的分析证实这是正确的原因。\n-   **变换后的残差：** $\\tilde R_i^{(c)}(\\psi)$ 和 $\\tilde R_i^{(e)}(\\phi_e,\\psi)$ 的表达式与我的推导完全匹配。\n-   **雅可比矩阵项：** $\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_i}$、$\\frac{\\partial \\tilde R_i^{(c)}}{\\partial \\psi_{i\\pm 1}}$、$\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_i}$ 和 $\\frac{\\partial \\tilde R_i^{(e)}}{\\partial \\psi_{i\\pm 1}}$ 的表达式都与我的推导相匹配。\n-   **推理：** 关于问题项变为 $\\psi$ 的线性项以及通过 $c_{e,i}=\\exp(\\psi_i)$ 保证正性的解释是正确的。\n-   **结论：** **正确**。\n\n**B. 病态是由于 $R_i^{(c)}$ 中的扩散项... 变换后的残差应因此为...**\n-   **病态机制：** 这是不正确的。如前所示，问题项在 $R_i^{(e)}$ 中，而不是 $R_i^{(c)}$。\n-   **变换后的残差：** 提议的残差 $\\tilde R_i^{(c)}$ 将瞬态项和扩散项在 $\\psi$ 中线性化。这不对应于原始守恒定律中的变量替换，而是离散化一个不同的、物理上不一致的偏微分方程，例如 $\\varepsilon \\frac{\\partial \\psi}{\\partial t} = D_{\\mathrm{eff}} \\nabla^2 \\psi + \\dots$。这是一个根本性错误。\n-   **结论：** **不正确**。\n\n**C. 病态是由反应源项引起的... $\\tilde R_i^{(c)}$ 关于 $\\psi$ 的雅可比矩阵为...**\n-   **病态机制：** 不正确。源项 $j_i$ 在当前雅可比矩阵计算中被视为已知常数。病态来自于电解质通量中的热力学因子，这导致了 $R_i^{(e)}$ 中的 $\\ln c_e$ 项。\n-   **变换后的残差：** 提议在将变量更改为 $\\psi = \\ln c_e$ 的同时“在 $R_i^{(e)}$ 中保留 $\\ln c_e$”，这在数学上是不一致的。用于求解 $\\psi$ 的变换后方程组不能同时包含旧变量 $c_e$ 和新变量 $\\psi$。\n-   **雅可比矩阵：** $\\partial \\tilde R_i^{(c)}/\\partial \\psi_i$ 的计算是错误的。它省略了链式法则因子 $\\partial(e^{\\psi_i})/\\partial \\psi_i = e^{\\psi_i}$。\n-   **结论：** **不正确**。\n\n**D. 病态根本上是由于离散化模板所致；通过在残差中增加一个障碍项 $+\\mu/\\!c_{e,i}$ 就足以... 雅可比矩阵是... $-\\mu/c_{e,i}^2$，对于小的 $c_{e,i}$ 该项仍然有界...**\n-   **病态机制：** 模糊地归因于“离散化模板”，这是不正确的。根本原因在于连续方程中编码的物理学。\n-   **建议方案分析：** 虽然添加障碍项是一种有效的数值策略（内点法），但其分析是有缺陷的。障碍项的导数是 $\\partial(\\mu/c_{e,i})/\\partial c_{e,i} = -\\mu/c_{e,i}^2$。声称“对于小的 $c_{e,i}$ 该项仍然有界”是错误的。当 $c_{e,i} \\to 0$ 时，$c_{e,i}^2 \\to 0$，项 $-\\mu/c_{e,i}^2$ 发散到 $-\\infty$。这种有意的发散创造了“障碍”，但所提供的理由在数学上是不正确的。\n-   **结论：** **不正确**。\n\n基于此综合分析，只有选项 A 在所有方面都是正确的：问题的识别、解的数学推导以及最终的雅可比矩阵。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}