{
    "hands_on_practices": [
        {
            "introduction": "为降阶模型选择合适的阶数 $r$ 是在模型精度和计算成本之间进行权衡的关键一步。本练习将引导您实践一种基于多准则的系统性方法来选择阶数，它不仅考虑了通用指标（如累积能量和谱间隙），还融入了特定于任务的性能要求（如电压误差），这对于电池管理系统等工程应用至关重要。",
            "id": "3943530",
            "problem": "一个用于自动化电池设计和仿真的锂离子电池模型，在 $N=500$ 个不同的负载轨迹下进行采样，以构建一个快照矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times N}$，其列为状态向量。本征正交分解（POD）通过奇异值分解 $\\mathbf{X} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{\\top}$ 构建，其中奇异值在 $\\mathbf{\\Sigma}$ 的对角线上按 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\dots \\ge \\sigma_{m} > 0$ 的顺序排列，$m=\\min\\{n,N\\}$。在一个秩为 $r$ 的降阶模型中，状态被投影到前 $r$ 个 POD 模态所张成的空间上。此处，电池管理系统（BMS）的合规性被定义为相对于高保真模型，满足均方根端电压误差的要求。\n\n从 POD 和奇异值分解的基本定义出发，并利用端电压 $V$ 在一条工作轨迹周围的线性化（使得增量电压映射由一个谱范数为 $\\|\\mathbf{H}\\|_{2}$ 的线性算子 $\\mathbf{H}$ 表示），推导出一个有原则的准则来选择最小的秩 $r$，该秩需要同时满足以下三个要求：\n- 累积能量捕获超过一个阈值 $0  \\alpha  1$，\n- 一个用于稳健性的谱隙阈值，以及\n- 一个关于均方根端电压误差的特定任务界限。\n\n假设以下数据是科学合理且自洽的：\n- 奇异值共 $m=12$ 个，由下式给出\n  $\\sigma_{1}=3.50$, $\\sigma_{2}=1.85$, $\\sigma_{3}=1.02$, $\\sigma_{4}=0.58$, $\\sigma_{5}=0.33$, $\\sigma_{6}=0.18$, $\\sigma_{7}=0.11$, $\\sigma_{8}=0.07$, $\\sigma_{9}=0.045$, $\\sigma_{10}=0.028$, $\\sigma_{11}=0.017$, $\\sigma_{12}=0.010$；\n- 电压线性化的算子范数为 $\\|\\mathbf{H}\\|_{2} = 0.20$，单位为伏特/单位状态范数；\n- BMS 合规允许的最大均方根端电压误差为 $\\epsilon_{V} = 0.0025$ 伏特；所有与电压相关的量均以伏特表示和计算；\n- 累积能量捕获阈值为 $\\alpha = 0.995$；\n- 谱隙阈值为一个差值准则 $\\delta = 0.10$，其中秩为 $r$ 时的谱隙定义为 $\\Delta_{r} = \\sigma_{r} - \\sigma_{r+1}$。\n\n仅使用关于 POD/SVD 误差表示和线性算子范数的核心定义和经过充分检验的定理，来推导组合的秩选择准则，然后将其应用于给定数据，以计算满足所有三个要求的最小整数秩 $r$。将最终答案表示为一个整数。除了精确的整数求值外，不需要进行任何四舍五入。",
            "solution": "问题要求为一个基于本征正交分解（POD）的锂离子电池降阶模型确定最小的整数模型秩 $r$。秩 $r$ 必须同时满足三个不同的要求：一个累积能量捕获阈值，一个谱隙稳健性准则，以及一个关于均方根（RMS）端电压误差的特定任务界限。我们首先从基本原理出发，为每个准则推导数学表达式。\n\nPOD 基是通过快照矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times N}$ 的奇异值分解（SVD）构建的，即 $\\mathbf{X} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{\\top}$。$\\mathbf{U}$ 的列是 POD 模态，$\\mathbf{\\Sigma}$ 的对角线元素是奇异值 $\\sigma_k$，按 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_m  0$ 的顺序排列，其中 $m=\\min\\{n,N\\}$。\n\n快照的总“能量”由 $\\mathbf{X}$ 的弗罗贝尼乌斯范数的平方来量化，它与奇异值的关系由恒等式 $\\|\\mathbf{X}\\|_F^2 = \\sum_{k=1}^{m} \\sigma_k^2$ 给出。一个秩为 $r$ 的降阶模型捕获了这部分能量。\n\n**准则1：累积能量捕获**\n\n前 $r$ 个 POD 模态捕获的能量是相应奇异值平方的和，即 $E_r = \\sum_{k=1}^{r} \\sigma_k^2$。累积能量捕获分数是捕获能量与总能量的比率。第一个准则要求该分数超过一个阈值 $\\alpha \\in (0,1)$。\n\n$$ C_1(r): \\quad \\frac{\\sum_{k=1}^{r} \\sigma_k^2}{\\sum_{k=1}^{m} \\sigma_k^2} \\ge \\alpha $$\n\n**准则2：谱隙阈值**\n\n连续奇异值 $\\sigma_r$ 和 $\\sigma_{r+1}$ 之间的较大差距，表明保留和截断的模态谱部分之间存在自然的分离，为秩 $r$ 的选择提供了稳健性。谱隙定义为 $\\Delta_r = \\sigma_r - \\sigma_{r+1}$。第二个准则要求该差距大于一个指定的阈值 $\\delta  0$。\n\n$$ C_2(r): \\quad \\sigma_r - \\sigma_{r+1} \\ge \\delta $$\n这个准则对 $r=m$ 没有定义，因为 $\\sigma_{m+1}$ 未给出（它将是 $0$）。因此，我们考虑 $r \\in \\{1, 2, \\dots, m-1\\}$。\n\n**准则3：均方根端电压误差**\n\n状态向量 $\\mathbf{s}$（$\\mathbf{X}$ 的一列）的秩 $r$ 截断是其在前 $r$ 个 POD 模态上的投影，$\\mathbf{s}_r = \\mathbf{U}_r\\mathbf{U}_r^{\\top}\\mathbf{s}$，其中 $\\mathbf{U}_r$ 包含 $\\mathbf{U}$ 的前 $r$ 列。状态截断误差为 $\\mathbf{e}_s = \\mathbf{s} - \\mathbf{s}_r$。\n\n端电压 $V$ 被给出为状态的线性化函数，因此由状态截断引起的电压误差 $\\epsilon_{V, \\text{inst}}$ 为 $\\epsilon_{V, \\text{inst}} = V(\\mathbf{s}) - V(\\mathbf{s}_r) \\approx \\mathbf{H}(\\mathbf{s} - \\mathbf{s}_r)$，其中 $\\mathbf{H}$ 是表示增量电压映射的线性算子。\n\n均方根端电压误差 $\\epsilon_{V, \\text{RMS}}$ 是在矩阵 $\\mathbf{X}$ 中的 $N$ 个快照 $\\mathbf{x}_j$ 上计算的。\n$$ \\epsilon_{V, \\text{RMS}} = \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left(V(\\mathbf{x}_j) - V(\\mathbf{x}_{j,r})\\right)^2} \\approx \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left(\\mathbf{H}(\\mathbf{x}_j - \\mathbf{x}_{j,r})\\right)^2} $$\n利用诱导2-范数（谱范数）的性质 $|\\mathbf{H} \\mathbf{v}| \\le \\|\\mathbf{H}\\|_2 \\|\\mathbf{v}\\|_2$，我们可以界定 RMS 误差：\n$$ \\epsilon_{V, \\text{RMS}} \\le \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left(\\|\\mathbf{H}\\|_2 \\|\\mathbf{x}_j - \\mathbf{x}_{j,r}\\|_2\\right)^2} = \\|\\mathbf{H}\\|_2 \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\|\\mathbf{x}_j - \\mathbf{x}_{j,r}\\|_2^2} $$\n所有快照上的误差平方和是误差矩阵的弗罗贝尼乌斯范数的平方，即 $\\|\\mathbf{X} - \\mathbf{X}_r\\|_F^2$。根据 Eckart-Young-Mirsky 定理，这个误差是截断的奇异值的平方和：$\\|\\mathbf{X} - \\mathbf{X}_r\\|_F^2 = \\sum_{k=r+1}^{m} \\sigma_k^2$。\n将此代入误差界限可得：\n$$ \\epsilon_{V, \\text{RMS}} \\le \\frac{\\|\\mathbf{H}\\|_2}{\\sqrt{N}} \\sqrt{\\sum_{k=r+1}^{m} \\sigma_k^2} $$\n第三个准则要求这个误差上界小于或等于允许的最大均方根电压误差 $\\epsilon_V$。\n$$ \\frac{\\|\\mathbf{H}\\|_2}{\\sqrt{N}} \\sqrt{\\sum_{k=r+1}^{m} \\sigma_k^2} \\le \\epsilon_V $$\n对奇异值平方和进行重新整理，我们得到第三个准则的最终形式：\n$$ C_3(r): \\quad \\sum_{k=r+1}^{m} \\sigma_k^2 \\le \\left(\\frac{\\epsilon_V \\sqrt{N}}{\\|\\mathbf{H}\\|_2}\\right)^2 $$\n\n现在我们将这三个准则应用于给定数据，以找到满足所有这些准则的最小整数 $r$。\n\n**数据：**\n- 快照数量: $N=500$\n- 奇异值数量: $m=12$\n- 奇异值 $\\sigma_k$: $\\sigma_1=3.50$, $\\sigma_2=1.85$, $\\sigma_3=1.02$, $\\sigma_4=0.58$, $\\sigma_5=0.33$, $\\sigma_6=0.18$, $\\sigma_7=0.11$, $\\sigma_8=0.07$, $\\sigma_9=0.045$, $\\sigma_{10}=0.028$, $\\sigma_{11}=0.017$, $\\sigma_{12}=0.010$\n- 算子范数: $\\|\\mathbf{H}\\|_2 = 0.20$\n- 最大电压误差: $\\epsilon_V = 0.0025$\n- 能量阈值: $\\alpha = 0.995$\n- 谱隙阈值: $\\delta = 0.10$\n\n首先，我们计算奇异值的平方 $\\sigma_k^2$：\n$\\sigma_1^2=12.25$, $\\sigma_2^2=3.4225$, $\\sigma_3^2=1.0404$, $\\sigma_4^2=0.3364$, $\\sigma_5^2=0.1089$, $\\sigma_6^2=0.0324$, $\\sigma_7^2=0.0121$, $\\sigma_8^2=0.0049$, $\\sigma_9^2=0.002025$, $\\sigma_{10}^2=0.000784$, $\\sigma_{11}^2=0.000289$, $\\sigma_{12}^2=0.0001$。\n\n总能量是 $E_{\\text{total}} = \\sum_{k=1}^{12} \\sigma_k^2 = 17.210798$。\n\n**准则1的评估：**\n我们需要 $\\sum_{k=1}^{r} \\sigma_k^2 \\ge \\alpha E_{\\text{total}} = 0.995 \\times 17.210798 = 17.124744$。\n- 对于 $r=4$，$\\sum_{k=1}^{4} \\sigma_k^2 = 12.25+3.4225+1.0404+0.3364 = 17.0493  17.124744$ (不满足)\n- 对于 $r=5$，$\\sum_{k=1}^{5} \\sigma_k^2 = 17.0493 + 0.1089 = 17.1582 \\ge 17.124744$ (满足)\n因此，准则1要求 $r \\ge 5$。\n\n**准则2的评估：**\n我们需要 $\\sigma_r - \\sigma_{r+1} \\ge \\delta = 0.10$。\n- 对于 $r=1$，$\\sigma_1-\\sigma_2 = 3.50-1.85 = 1.65 \\ge 0.10$ (满足)\n- 对于 $r=2$，$\\sigma_2-\\sigma_3 = 1.85-1.02 = 0.83 \\ge 0.10$ (满足)\n- 对于 $r=3$，$\\sigma_3-\\sigma_4 = 1.02-0.58 = 0.44 \\ge 0.10$ (满足)\n- 对于 $r=4$，$\\sigma_4-\\sigma_5 = 0.58-0.33 = 0.25 \\ge 0.10$ (满足)\n- 对于 $r=5$，$\\sigma_5-\\sigma_6 = 0.33-0.18 = 0.15 \\ge 0.10$ (满足)\n- 对于 $r=6$，$\\sigma_6-\\sigma_7 = 0.18-0.11 = 0.07  0.10$ (不满足)\n因此，准则2要求 $r \\in \\{1, 2, 3, 4, 5\\}$。\n\n**准则3的评估：**\n我们需要 $\\sum_{k=r+1}^{12} \\sigma_k^2 \\le \\left(\\frac{\\epsilon_V \\sqrt{N}}{\\|\\mathbf{H}\\|_2}\\right)^2$。\n阈值为 $\\left(\\frac{0.0025 \\sqrt{500}}{0.20}\\right)^2 = \\left(\\frac{0.0025 \\times 10\\sqrt{5}}{0.2}\\right)^2 = (0.125\\sqrt{5})^2 = 0.078125$。\n我们检查截断误差能量 $E_{\\text{err}}(r) = \\sum_{k=r+1}^{12} \\sigma_k^2 = E_{\\text{total}} - \\sum_{k=1}^{r} \\sigma_k^2$。\n- 对于 $r=4$，$E_{\\text{err}}(4) = E_{\\text{total}} - 17.0493 = 17.210798 - 17.0493 = 0.161498  0.078125$ (不满足)\n- 对于 $r=5$，$E_{\\text{err}}(5) = E_{\\text{total}} - 17.1582 = 17.210798 - 17.1582 = 0.052598 \\le 0.078125$ (满足)\n因此，准则3要求 $r \\ge 5$。\n\n**结论：**\n为了同时满足所有三个要求，秩 $r$ 必须位于每个准则的有效秩集合的交集中。\n- 准则1: $r \\in \\{5, 6, 7, 8, 9, 10, 11\\}$\n- 准则2: $r \\in \\{1, 2, 3, 4, 5\\}$\n- 准则3: $r \\in \\{5, 6, 7, 8, 9, 10, 11\\}$\n这三个集合的交集是 $\\{5\\}$。因此，唯一满足所有条件的秩是 $r=5$。由于这是唯一的元素，它也是最小的。",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "尽管本征正交分解功能强大，但它并非万能的。本练习探讨了电池物理模型中的一个典型场景——急剧移动的浓度锋面，在这种情况下，标准的“全局”POD方法往往表现不佳。通过分析该方法失效的根本数学原因并评估如区域分解等高级策略，您将从简单地应用一种技术，进阶到能批判性地评估其适用范围和局限性。",
            "id": "3943763",
            "problem": "考虑锂离子电池电极中电解质盐浓度的一维穿透厚度模型，其空间坐标 $x \\in [0,L]$ 从集流体延伸至隔膜。电解质盐浓度 $c_e(x,t)$ 在多孔电解质中满足物种守恒和菲克扩散，并包含一个由界面反应产生的源项：\n\n$$\\varepsilon_e \\frac{\\partial c_e}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( D_e \\frac{\\partial c_e}{\\partial x} \\right) + \\Gamma j_n(x,t),$$\n\n其中 $\\varepsilon_e$ 是电解质体积分数，$D_e$ 是有效电解质扩散系数，$\\Gamma = \\frac{(1-t_+^0) a_s}{F}$，其中 $t_+^0$ 是阳离子迁移数，$a_s$ 是比界面面积，$F$ 是法拉第常数。界面摩尔通量 $j_n(x,t)$ 源于电极动力学（例如，通过 Butler–Volmer 方程），在高倍率充电期间，$j_n(x,t)$ 在隔膜附近变得急剧局部化，导致陡峭的浓度前沿。假设边界条件在物理上与集流体处的零通量和隔膜处的连续性相一致。考虑高倍率工况，其中扩散长度 $\\ell_D(t) \\sim \\sqrt{D_e t}$ 相对于 $L$ 很小，因此浓度场会形成一个特征宽度 $w \\ll L$ 的局部化“凸起”，该凸起随着前沿的移动而传播。对于一系列时间实例 $\\{t_k\\}_{k=1}^m$，快照可以理想化为\n\n$$c_e(x,t_k) \\approx c_b + A h\\!\\left(x - \\xi(t_k)\\right),$$\n\n其中 $c_b$ 是一个缓慢变化的背景，$A$ 是由施加电流和动力学设定的振幅，$h(\\cdot)$ 是一个宽度为 $w$ 的局部化剖面，$\\xi(t)$ 是前沿位置。基于这些在全域 $[0,L]$ 上的快照，构建了一个全局本征正交分解 (POD) 基。\n\n运用物种守恒、扩散标度的第一性原理，以及快照集作为局部化函数平移的结构，分析为什么全局POD难以用少量模态捕捉尖锐、移动的浓度前沿。然后，评估在电池模拟中解决此困难同时保持子域间守恒性的策略。选择所有正确的陈述。\n\nA. 在此场景中，全局POD基表现不佳主要是由于快照系综中的“能量”不足，这可以通过在相同空间分辨率下增加更多时间上的快照来简单地纠正。\n\nB. 当快照主要由局部化剖面 $h(x-\\xi)$ 在 $[0,L]$ 上的平移构成时，协方差算子近似为与 $h$ 的自相关进行的卷积，其特征函数是类傅里叶函数；表示宽度为 $w$ 的窄前沿需要 $\\mathcal{O}(L/w)$ 个全局模态，导致奇异值衰减缓慢和压缩效果差。\n\nC. 仅减小时间采样间隔（即，在不改变空间基构造的情况下更频繁地进行快照）可确保全局POD基的奇异值快速衰减，因为它充分地解析了前沿的运动。\n\nD. 采用在界面处进行通量连续性耦合的非重叠区域分解，并结合在包含并追踪前沿的子域上的局部化POD基，可以得到一个降阶模型，其所需维度与 $\\mathcal{O}\\!\\left(\\max_i L_i / w\\right)$ 成正比，其中 $L_i$ 是子域的大小；强制施加界面条件可以在高效捕捉局部化动力学的同时保持质量守恒。\n\nE. 仅将离散经验插值方法 (DEIM) 应用于非线性动力学源项 $j_n(x,t)$ 就能解决全局POD中尖锐前沿的难题，因为前沿局部化主要是非线性的结果，而非输运和扩散标度的结果。\n\n选择所有正确的选项。",
            "solution": "该问题陈述描述了一个用于锂离子电池中电解质浓度的一维扩散-反应方程，这是 Doyle-Fuller-Newman (DFN) 型模型的常见组成部分。在高倍率条件下出现尖锐、移动的浓度前沿的情景在物理上是现实的，对应于显著的浓度极化。问题要求分析全局本征正交分解 (POD) 方法在这种背景下的性能，并评估潜在的解决方案。所呈现的物理和数学是标准的且自洽的。该问题是有效的。\n\n问题的核心在于理解为什么在能量意义上对给定快照集最优的POD方法，在处理平移特征时会遇到困难。POD构建了一个标准正交基 $\\{\\phi_j(x)\\}_{j=1}^N$，该基对于表示快照系综 $\\{c_e(x,t_k)\\}_{k=1}^m$ 是最优的。基函数是空间两点相关算子 $K(x,x')$ 的特征函数，定义为：\n$$ K(x,x') = \\frac{1}{m} \\sum_{k=1}^m (c_e(x,t_k) - \\bar{c}_e(x))(c_e(x',t_k) - \\bar{c}_e(x')), $$\n其中 $\\bar{c}_e(x)$ 是时间平均浓度。POD基的效率由 $K$ 的特征值 $\\lambda_j$（对应于快照矩阵的奇异值的平方）的衰减率决定。快速衰减意味着系统的大部分能量（方差）可以被少数几个模态捕获，从而得到一个低维模型。\n\n问题指出，快照可以理想化为 $c_e(x,t_k) \\approx c_b + A h(x - \\xi(t_k))$，其中 $h$ 是一个宽度为 $w$ 的局部化函数，$\\xi(t_k)$ 是其移动位置。为简单起见，我们分析其波动部分 $u_k(x) = A h(x - \\xi(t_k))$。如果前沿位置 $\\xi(t_k)$ 采样了域 $[0,L]$ 的一大部分，则相关算子中的求和就变成了对空间位移变量 $\\xi$ 的积分近似：\n$$ K(x,x') \\propto \\int h(x-\\xi) h(x'-\\xi) \\,d\\xi. $$\n这是一个卷积运算。作用在远大于特征尺寸的域上的这种形式的算子是一个托普利茨算子（或者，如果假设周期性边界条件，则为循环算子）。众所周知，这类算子的特征函数是全局的、振荡的函数，与傅里叶模态（例如，正弦/余弦函数）密切相关。\n\n根据傅里叶分析，要表示宽度为 $w$ 的局部化特征，需要波长低至 $w$ 数量级的基函数做出显著贡献。在长度为 $L$ 的域上，这对应于指数高达 $n \\approx L/w$ 的模态。因此，信号的能量分布在大约 $\\mathcal{O}(L/w)$ 个类傅里叶模态上。由于在这种情况下POD模态本身就是类傅里叶的，能量也将分布在许多POD模态中。这意味着奇异值将缓慢衰减，需要大量模态（数量级为 $\\mathcal{O}(L/w)$）才能准确捕捉平移的前沿。这种差的压缩效率是全局POD基对此类问题效率低下的根本原因。\n\n现在，我们基于此分析评估每个选项。\n\n**A. 在此场景中，全局POD基表现不佳主要是由于快照系综中的“能量”不足，这可以通过在相同空间分辨率下增加更多时间上的快照来简单地纠正。**\n\n此陈述**不正确**。“系统能量”是快照的 $L_2$ 范数平方和。问题不在于能量或数据不足，而在于解快照所在流形的维度很高。局部化函数的所有平移集合构成一个高维空间，无法被一个低维线性子空间有效近似。增加显示前沿在新位置的快照，通常会使固定模态数的POD表示效果*更差*，因为基必须能够表示在更大空间范围内的特征。奇异值的缓慢衰减是平移特征的内在属性，而不是时间采样不足造成的人为结果。\n\n**B. 当快照主要由局部化剖面 $h(x-\\xi)$ 在 $[0,L]$ 上的平移构成时，协方差算子近似为与 $h$ 的自相关进行的卷积，其特征函数是类傅里叶函数；表示宽度为 $w$ 的窄前沿需要 $\\mathcal{O}(L/w)$ 个全局模态，导致奇异值衰减缓慢和压缩效果差。**\n\n此陈述**正确**。如上所述，一组平移函数的两点相关（或协方差）算子具有卷积算子的形式。卷积（托普利茨）算子的特征函数是全局的、振荡的、类傅里叶的函数。要使用全局类傅里叶模态在长度为 $L$ 的域上表示宽度为 $w$ 的局部化特征，需要空间频率高达约 $1/w$ 的模态，这意味着所需模态数量与 $\\mathcal{O}(L/w)$ 成正比。能量在大量模态上的这种分布与奇异值缓慢衰减是同义的，因此导致POD方法的压缩效率低下。\n\n**C. 仅减小时间采样间隔（即，在不改变空间基构造的情况下更频繁地进行快照）可确保全局POD基的奇异值快速衰减，因为它充分地解析了前沿的运动。**\n\n此陈述**不正确**。减小时间采样间隔 $(\\Delta t \\to 0)$ 会引入更多与其相邻快照非常相似的快照。这增加了快照矩阵内部的线性相关性，虽然可能使一些尾部的奇异值变小，但并不会改变解流形的基本几何结构。POD基仍然必须能够表示前沿在整个时间间隔内访问过的所有位置。实现这一点所需的模态数量仍然与前沿移动的总距离与其宽度的比率成正比。更精细的时间采样并不能改变这样一个事实，即基必须足够丰富才能在许多不同位置构造局部化形状，这正是奇异值缓慢衰减的根本原因。\n\n**D. 采用在界面处进行通量连续性耦合的非重叠区域分解，并结合在包含并追踪前沿的子域上的局部化POD基，可以得到一个降阶模型，其所需维度与 $\\mathcal{O}\\!\\left(\\max_i L_i / w\\right)$ 成正比，其中 $L_i$ 是子域的大小；强制施加界面条件可以在高效捕捉局部化动力学的同时保持质量守恒。**\n\n此陈述**正确**。这描述了一种克服全局POD局限性的标准且有效的策略。通过将域 $[0,L]$ 分解为大小为 $L_i \\ll L$ 的较小子域，问题被局部化了。对于前沿穿过的子域，构建一个局部的POD基。在该较小子域内表示平移所需的模态数量现在与 $\\mathcal{O}(L_i/w)$ 成正比，这是一个显著的改进，因为 $L_i \\ll L$。对于解平滑的子域（即远离前沿的区域），只需要极少数POD模态。降阶模型的总维度是局部模型维度之和，将远小于全局基所需的 $\\mathcal{O}(L/w)$。关键在于，在子域界面强制施加通量连续性（例如，$D_e \\frac{\\partial c_e}{\\partial x}|_{x_{i}^-} = D_e \\frac{\\partial c_e}{\\partial x}|_{x_{i}^+}$）是耦合局部模型并确保整个降阶模型遵循物种 $c_e$ 的潜在守恒定律的正确方法。\n\n**E. 仅将离散经验插值方法 (DEIM) 应用于非线性动力学源项 $j_n(x,t)$ 就能解决全局POD中尖锐前沿的难题，因为前沿局部化主要是非线性的结果，而非输运和扩散标度的结果。**\n\n此陈述**不正确**。DEIM是一种超降阶技术，用于近似计算降阶模型中非线性项的求值，从而降低计算成本。它的工作原理是将非线性函数投影到一个基上，并在少数几个“魔术”点上进行求值。虽然非线性源项 $j_n$ 是前沿形成的*原因*，但POD-Galerkin方法的*挑战*在于*表示*所得的状态向量 $c_e(x,t)$，该向量表现出平移的尖锐特征。将DEIM应用于 $j_n$ 不会改变用于近似 $c_e$ 的全局POD基。用于 $c_e$ 的基仍然效率低下，遭受选项B中所述的奇异值缓慢衰减问题。DEIM解决的是评估非线性右侧项的计算瓶颈，而不是状态表示问题。",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "在自动化设计领域，终极目标之一是创建能在一定参数范围内（例如，不同的电极设计）都保持高精度的模型。本项高级练习将指导您实现一种强大的贪婪算法，以自适应方式构建POD基。该方法通过一个误差估计器 $\\eta(\\theta)$ 来智能地选择新的“快照”样本，从而高效地构建一个紧凑且功能强大的参数化降阶模型，这是实现快速设计优化的关键技术。",
            "id": "3943535",
            "problem": "给定一个参数化的对称正定线性系统，该系统代表了在一个电池电极上，于 $N$ 个节点上离散化的稳态一维扩散反应模型。对于参数 $u \\in \\mathbb{R}$，该系统为\n$$\nA(u) x(u) = f(u),\n$$\n其中 $A(u) \\in \\mathbb{R}^{N \\times N}$ 和 $f(u) \\in \\mathbb{R}^{N}$ 由以下具有科学依据的构造定义：\n\n- 一维网格上的离散狄利克雷拉普拉斯算子 $L \\in \\mathbb{R}^{N \\times N}$ 为\n$$\nL_{i,i} = 2,\\quad L_{i,i+1} = L_{i+1,i} = -1\\quad \\text{for } i=1,\\dots,N-1,\\quad \\text{and } L_{i,j}=0 \\text{ otherwise}.\n$$\n- 反应速率对角阵 $D(u) = \\mathrm{diag}\\big(d_0 + u\\, d_1\\big)$ 由两个正向量 $d_0, d_1 \\in \\mathbb{R}^N$ 定义，其元素为\n$$\n(d_0)_i = 0.5 + 0.5 \\sin\\left(\\frac{\\pi i}{N+1}\\right), \\quad (d_1)_i = 0.2 + 0.1 \\cos\\left(\\frac{\\pi i}{N+1}\\right),\n$$\n对于 $i=1,\\dots,N$。对于所有 $i$，$(d_0)_i$ 和 $(d_1)_i$ 均为非负值。\n- 载荷向量 $f(u)$ 为\n$$\nf(u) = s + u\\, t,\n$$\n其中 $s \\in \\mathbb{R}^N$ 的元素为 $s_i = 1.0$，$t \\in \\mathbb{R}^N$ 的元素为\n$$\nt_i = \\exp\\left(-\\left(\\frac{i - (N+1)/2}{N/10}\\right)^2\\right),\n$$\n对于 $i=1,\\dots,N$。\n\n设 $A(u) = L + D(u)$。因为 $L$ 是对称半正定的，且对于任意 $u \\ge 0$，$D(u)$ 是对角元严格为正的对角阵，所以对于下面指定的候选集中的所有 $u$，$A(u)$ 都是对称正定的。\n\n您的任务是实现一个由误差估计器驱动的贪心自适应快照增量算法，用于在电极设计的前瞻性优化过程中提炼正常正交分解 (POD) 基。正常正交分解 (POD) 旨在寻找一个标准正交基 $V \\in \\mathbb{R}^{N \\times r}$，该基能够近似由 $\\{x(u_k)\\}$ 张成的快照子空间，从而最小化在所有收集的快照上的投影误差。给定快照矩阵 $X = [x(u_1), x(u_2), \\dots, x(u_m)] \\in \\mathbb{R}^{N \\times m}$，POD 基由 $X$ 的左奇异向量获得。\n\n对于一个候选参数 $\\theta$，给定一个 POD 基 $V$，定义降阶解 $x_r(\\theta) = V y(\\theta)$，其中 $y(\\theta) \\in \\mathbb{R}^r$ 是降阶伽辽金系统的解\n$$\n\\left(V^\\top A(\\theta) V\\right) y(\\theta) = V^\\top f(\\theta).\n$$\n定义残差 $r(\\theta) = f(\\theta) - A(\\theta) x_r(\\theta)$。误差估计器是误差的能量范数，对于对称正定矩阵 $A(\\theta)$，它可以通过以下公式精确计算：\n$$\n\\eta(\\theta) = \\sqrt{r(\\theta)^\\top A(\\theta)^{-1} r(\\theta)}.\n$$\n\n您必须实现以下贪心算法：\n\n1. 使用初始快照集 $\\mathcal{S}_0 = \\{u^{(1)}, u^{(2)}\\}$ 进行初始化，并从相应的全阶解构造初始 POD 基 $V$。在本问题中，取 $u^{(1)} = 0.0$ 和 $u^{(2)} = 1.0$。\n2. 给定一个候选参数集 $\\Theta$，在每次贪心迭代中，对所有不在快照集中的 $\\theta \\in \\Theta$ 计算 $\\eta(\\theta)$。选择使 $\\eta(\\theta)$ 最大化的 $\\theta^\\star$。\n3. 如果 $\\eta(\\theta^\\star) \\le \\varepsilon$（容差），则终止；否则，计算全阶解 $x(\\theta^\\star)$，扩充快照集，并从所有收集到的快照中重新计算 POD 基 $V$。\n4. 重复此过程，直到满足容差或达到快照预算 $m_{\\max}$（总快照的最大数量）。\n\n为了验证，终止后计算：\n- 最终基维度 $r$。\n- 所有候选参数上的最大误差估计器 $\\max_{\\theta \\in \\Theta} \\eta(\\theta)$。\n- 所有候选参数上的最大实际能量范数误差\n$$\nE_{\\max} = \\max_{\\theta \\in \\Theta} \\sqrt{\\big(x(\\theta) - x_r(\\theta)\\big)^\\top A(\\theta) \\big(x(\\theta) - x_r(\\theta)\\big)}.\n$$\n- 一个布尔值，指示 $E_{\\max} \\le \\varepsilon$ 是否成立。\n\n为 $N=50$ 和以下测试套件实现程序。所有量均为无量纲；无需报告物理单位。\n\n测试套件：\n- 案例1（通用案例）：$\\Theta = \\{0.0, 0.1, 0.2, \\dots, 1.0\\}$，容差 $\\varepsilon = 10^{-6}$，预算 $m_{\\max} = 11$。\n- 案例2（预算限制案例）：$\\Theta = \\{0.0, 0.25, 0.5, 0.75, 1.0\\}$，容差 $\\varepsilon = 10^{-3}$，预算 $m_{\\max} = 3$。\n- 案例3（重复候选参数边界案例）：$\\Theta = \\{0.0, 0.0, 0.5, 0.5, 1.0\\}$，容差 $\\varepsilon = 10^{-2}$，预算 $m_{\\max} = 5$。\n\n您的程序应生成单行输出，其中包含所有案例的结果，格式为逗号分隔的列表，并用方括号括起来。每个案例的结果必须是 $[r, \\eta_{\\max}, E_{\\max}, \\text{satisfied}]$ 形式的列表，其中 $r$ 是整数，$\\eta_{\\max}$ 和 $E_{\\max}$ 是浮点数，$\\text{satisfied}$ 是布尔值。因此，最终输出必须是以下形式的单行\n$$\n[\\,[r_1, \\eta_{\\max,1}, E_{\\max,1}, \\text{satisfied}_1], [r_2, \\eta_{\\max,2}, E_{\\max,2}, \\text{satisfied}_2], [r_3, \\eta_{\\max,3}, E_{\\max,3}, \\text{satisfied}_3]\\,].\n$$",
            "solution": "我们从控制方程——稳态扩散反应模型开始，该模型源于物种守恒和菲克定律。使用狄利克雷拉普拉斯算子和空间变化的反应项进行离散化，得到一个对称正定线性系统\n$$\nA(u) x(u) = f(u),\n$$\n其中 $A(u) = L + \\mathrm{diag}(d_0 + u d_1)$，而 $L$ 是标准的三对角矩阵，主对角线上元素为 $2$，第一副对角线上元素为 $-1$。因为 $L$ 是对称半正定的，并且在指定的参数范围内，对角部分的贡献是严格为正的，所以对于 $u \\ge 0$，$A(u)$ 是对称正定的，因此对每个参数值都存在唯一解 $x(u)$。\n\n正常正交分解 (POD) 的目标是构造一个标准正交基 $V \\in \\mathbb{R}^{N \\times r}$，该基能够最佳地近似由收集的全阶解 $\\{x(u_k)\\}$ 生成的快照子空间。POD 基的典型特征是变分问题的解，该问题旨在最小化快照集上投影误差的平方和。这表明 $V$ 由快照矩阵 $X = [x(u_1), \\dots, x(u_m)]$ 的前导左奇异向量构成，这些向量通过奇异值分解 $X = U \\Sigma W^\\top$ 得到，其中 $U$ 包含标准正交列，$\\Sigma$ 包含奇异值。选择 $U$ 中与非零奇异值对应的前 $r$ 列作为 $V$，可以最小化投影误差的弗罗贝尼乌斯范数。\n\n通过在 POD 基 $V$ 上进行伽辽金投影，可以获得一个降阶模型。对于参数 $\\theta$，将降阶坐标 $y(\\theta) \\in \\mathbb{R}^r$ 定义为以下方程的解\n$$\n\\left(V^\\top A(\\theta) V\\right) y(\\theta) = V^\\top f(\\theta),\n$$\n并将降阶状态定义为 $x_r(\\theta) = V y(\\theta)$。因为 $A(\\theta)$ 是对称正定的，且 $V$ 具有标准正交列，所以降阶算子 $V^\\top A(\\theta) V$ 也是对称正定的，因此 $y(\\theta)$ 唯一存在。\n\n为了指导贪心快照增量，我们使用基于残差的能量范数误差估计器。定义残差\n$$\nr(\\theta) = f(\\theta) - A(\\theta) x_r(\\theta).\n$$\n全阶解满足 $A(\\theta) x(\\theta) = f(\\theta)$，因此误差 $e(\\theta) = x(\\theta) - x_r(\\theta)$ 服从\n$$\nA(\\theta) e(\\theta) = r(\\theta).\n$$\n对于对称正定的 $A(\\theta)$，误差的能量范数为\n$$\n\\|e(\\theta)\\|_{A(\\theta)} = \\sqrt{e(\\theta)^\\top A(\\theta) e(\\theta)}.\n$$\n利用 $A(\\theta) e(\\theta) = r(\\theta)$ 和对称性，\n$$\n\\|e(\\theta)\\|_{A(\\theta)}^2 = e(\\theta)^\\top A(\\theta) e(\\theta) = e(\\theta)^\\top r(\\theta) = r(\\theta)^\\top A(\\theta)^{-1} r(\\theta),\n$$\n这意味着\n$$\n\\|e(\\theta)\\|_{A(\\theta)} = \\sqrt{r(\\theta)^\\top A(\\theta)^{-1} r(\\theta)}.\n$$\n因此，估计器\n$$\n\\eta(\\theta) = \\sqrt{r(\\theta)^\\top A(\\theta)^{-1} r(\\theta)}\n$$\n等于降阶伽辽金解的真实能量范数误差。在计算上，这可以通过求解 $A(\\theta) z(\\theta) = r(\\theta)$ 并计算 $\\eta(\\theta) = \\sqrt{r(\\theta)^\\top z(\\theta)}$ 来评估。\n\n贪心算法按以下步骤进行：\n- 从一个初始快照集 $\\mathcal{S}_0 = \\{u^{(1)}, u^{(2)}\\}$ 开始，计算全阶解 $x(u^{(1)})$ 和 $x(u^{(2)})$，并通过奇异值分解构建初始 POD 基 $V$。\n- 对于 $\\Theta$ 中每个未采样的候选参数 $\\theta$，通过求解降阶系统计算降阶解 $x_r(\\theta)$，形成残差 $r(\\theta)$，并通过能量范数恒等式计算估计器 $\\eta(\\theta)$。选择具有最大 $\\eta(\\theta)$ 的参数以最大化信息增益。\n- 如果最大估计器不超过容差 $\\varepsilon$，则终止。否则，用选定参数处的全阶解扩充快照集，从所有快照中重新计算 POD 基 $V$，并重复此过程，直到满足容差标准或达到快照预算 $m_{\\max}$。\n\n由于每次迭代都从一个扩展的快照矩阵重新计算 POD 基，降阶子空间只能增加（或者如果新快照与现有张成空间共线，则保持不变），并且伽辽金投影在当前子空间上最小化能量范数误差。因此，在有限候选集 $\\Theta$ 上的最大能量范数误差在迭代过程中是非递增的，而使用最大估计误差的贪心选择会优先考虑那些对当前降阶模型构成最大挑战的参数。\n\n最后，在终止后，我们通过计算以下指标来验证性能：\n- 最终基维度 $r$，等于用于构建 POD 基的快照矩阵的秩。\n- 最大估计器 $\\eta_{\\max} = \\max_{\\theta \\in \\Theta} \\eta(\\theta)$。\n- 最大实际能量范数误差 $E_{\\max} = \\max_{\\theta \\in \\Theta} \\|x(\\theta) - x_r(\\theta)\\|_{A(\\theta)}$。\n- 布尔条件 $\\text{satisfied} = (E_{\\max} \\le \\varepsilon)$。\n\n该实现使用线性代数运算来构造 $L$、$A(u)$ 和 $f(u)$；求解全阶和降阶系统；为 POD 计算奇异值分解；并根据误差估计器迭代地增量快照集。测试套件涵盖了一个通用案例、一个用于检验在未满足容差时终止的预算限制案例，以及一个带有重复候选参数的边界案例，以确保在冗余参数条目下的鲁棒性。最终输出遵循指定的单行嵌套列表格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_dirichlet_laplacian(n: int) - np.ndarray:\n    \"\"\"Build 1D Dirichlet Laplacian matrix L of size n x n.\"\"\"\n    L = np.zeros((n, n), dtype=float)\n    # Tridiagonal: 2 on diagonal, -1 on off-diagonals\n    for i in range(n):\n        L[i, i] = 2.0\n        if i - 1 = 0:\n            L[i, i - 1] = -1.0\n        if i + 1  n:\n            L[i, i + 1] = -1.0\n    return L\n\ndef build_reaction_vectors(n: int) - tuple[np.ndarray, np.ndarray]:\n    \"\"\"Build d0 and d1 reaction-rate vectors.\"\"\"\n    idx = np.arange(1, n + 1, dtype=float)\n    d0 = 0.5 + 0.5 * np.sin(np.pi * idx / (n + 1))\n    d1 = 0.2 + 0.1 * np.cos(np.pi * idx / (n + 1))\n    return d0, d1\n\ndef build_load_vectors(n: int) - tuple[np.ndarray, np.ndarray]:\n    \"\"\"Build s and t load vectors.\"\"\"\n    s = np.ones(n, dtype=float)\n    center = (n + 1) / 2.0\n    sigma = n / 10.0\n    idx = np.arange(1, n + 1, dtype=float)\n    t = np.exp(-((idx - center) / sigma) ** 2)\n    return s, t\n\ndef assemble_system(u: float, L: np.ndarray, d0: np.ndarray, d1: np.ndarray, s: np.ndarray, t: np.ndarray) - tuple[np.ndarray, np.ndarray]:\n    \"\"\"Assemble A(u) and f(u).\"\"\"\n    diag = d0 + u * d1\n    A = L + np.diag(diag)\n    f = s + u * t\n    return A, f\n\ndef full_solution(u: float, L: np.ndarray, d0: np.ndarray, d1: np.ndarray, s: np.ndarray, t: np.ndarray) - np.ndarray:\n    \"\"\"Compute the full-order solution x(u).\"\"\"\n    A, f = assemble_system(u, L, d0, d1, s, t)\n    x = np.linalg.solve(A, f)\n    return x\n\ndef pod_basis_from_snapshots(snapshots: list[np.ndarray], tol: float = 1e-12) - np.ndarray:\n    \"\"\"Compute POD basis V from snapshot list using SVD.\n    Returns V with orthonormal columns. Rank determined by singular values above tol.\n    \"\"\"\n    if len(snapshots) == 0:\n        raise ValueError(\"No snapshots provided for POD basis.\")\n    X = np.column_stack(snapshots)  # N x m\n    U, S, VT = np.linalg.svd(X, full_matrices=False)\n    rank = int(np.sum(S  tol))\n    if rank == 0:\n        # If all singular values are tiny, keep at least one vector to avoid empty basis\n        rank = 1\n    V = U[:, :rank]\n    return V\n\ndef reduced_solution(u: float, V: np.ndarray, L: np.ndarray, d0: np.ndarray, d1: np.ndarray, s: np.ndarray, t: np.ndarray) - tuple[np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"Compute reduced-order solution x_r(u) = V y, residual r, and A, f.\"\"\"\n    A, f = assemble_system(u, L, d0, d1, s, t)\n    # Reduced Galerkin system\n    Ar = V.T @ A @ V\n    fr = V.T @ f\n    y = np.linalg.solve(Ar, fr)\n    x_r = V @ y\n    r_vec = f - A @ x_r\n    return x_r, r_vec, A\n\ndef energy_norm_error_estimator(r_vec: np.ndarray, A: np.ndarray) - float:\n    \"\"\"Compute the exact energy-norm error estimator sqrt(r^T A^{-1} r).\"\"\"\n    z = np.linalg.solve(A, r_vec)\n    eta = float(np.sqrt(r_vec.T @ z))\n    return eta\n\ndef energy_norm_error(x_full: np.ndarray, x_red: np.ndarray, A: np.ndarray) - float:\n    \"\"\"Compute energy-norm error sqrt((x - x_r)^T A (x - x_r)).\"\"\"\n    e = x_full - x_red\n    val = float(np.sqrt(e.T @ (A @ e)))\n    return val\n\ndef greedy_adaptive_pod(theta_candidates: list[float], epsilon: float, m_max: int, initial_params: list[float], n: int) - list:\n    \"\"\"Run the greedy adaptive snapshot enrichment algorithm.\n    Returns [final_basis_dim, max_estimator, max_actual_error, satisfied_boolean].\n    \"\"\"\n    # Build global components\n    L = build_dirichlet_laplacian(n)\n    d0, d1 = build_reaction_vectors(n)\n    s, t = build_load_vectors(n)\n\n    # Make candidate set unique and sorted for determinism\n    theta_unique = sorted(set(theta_candidates))\n    # Initialize snapshot set with unique initial params (ensure they are considered sampled)\n    sampled_params = []\n    snapshots = []\n    for u0 in initial_params:\n        if u0 not in sampled_params:\n            x0 = full_solution(u0, L, d0, d1, s, t)\n            sampled_params.append(u0)\n            snapshots.append(x0)\n\n    # Enforce budget: if initial exceeds budget, truncate (edge safeguard)\n    if len(sampled_params)  m_max:\n        sampled_params = sampled_params[:m_max]\n        snapshots = snapshots[:m_max]\n\n    # Build initial POD basis\n    V = pod_basis_from_snapshots(snapshots)\n\n    # Greedy loop\n    # If budget allows adding more snapshots\n    while len(sampled_params)  m_max:\n        # Evaluate estimator over unsampled candidates\n        best_theta = None\n        best_eta = -np.inf\n        for theta in theta_unique:\n            if theta in sampled_params:\n                continue\n            x_r, r_vec, A = reduced_solution(theta, V, L, d0, d1, s, t)\n            eta = energy_norm_error_estimator(r_vec, A)\n            if eta  best_eta:\n                best_eta = eta\n                best_theta = theta\n        # If no unsampled candidates remain, break\n        if best_theta is None:\n            break\n        # Check tolerance\n        if best_eta = epsilon:\n            break\n        # Enrich snapshot set with full solution at best_theta\n        x_best = full_solution(best_theta, L, d0, d1, s, t)\n        sampled_params.append(best_theta)\n        snapshots.append(x_best)\n        # Recompute POD basis\n        V = pod_basis_from_snapshots(snapshots)\n\n    # After termination, compute final metrics over all candidates\n    max_eta = -np.inf\n    max_actual_err = -np.inf\n    for theta in theta_unique:\n        # Reduced solution and residual\n        x_r, r_vec, A = reduced_solution(theta, V, L, d0, d1, s, t)\n        eta = energy_norm_error_estimator(r_vec, A)\n        if eta  max_eta:\n            max_eta = eta\n        # Actual energy-norm error\n        x_full = np.linalg.solve(A, s + theta * t)\n        e = energy_norm_error(x_full, x_r, A)\n        if e  max_actual_err:\n            max_actual_err = e\n\n    final_basis_dim = V.shape[1]\n    satisfied = max_actual_err = epsilon\n    return [final_basis_dim, max_eta, max_actual_err, satisfied]\n\ndef solve():\n    # Define problem size\n    N = 50\n\n    # Test cases as specified\n    test_cases = [\n        # Case 1: General case\n        {\n            \"theta\": [0.1 * k for k in range(11)],  # 0.0 to 1.0 inclusive\n            \"epsilon\": 1e-6,\n            \"m_max\": 11,\n            \"initial\": [0.0, 1.0],\n        },\n        # Case 2: Budget-limited\n        {\n            \"theta\": [0.0, 0.25, 0.5, 0.75, 1.0],\n            \"epsilon\": 1e-3,\n            \"m_max\": 3,\n            \"initial\": [0.0, 1.0],\n        },\n        # Case 3: Duplicate candidates edge case\n        {\n            \"theta\": [0.0, 0.0, 0.5, 0.5, 1.0],\n            \"epsilon\": 1e-2,\n            \"m_max\": 5,\n            \"initial\": [0.0, 1.0],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        res = greedy_adaptive_pod(\n            theta_candidates=case[\"theta\"],\n            epsilon=case[\"epsilon\"],\n            m_max=case[\"m_max\"],\n            initial_params=case[\"initial\"],\n            n=N,\n        )\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Nested list of [int, float, float, bool] per case\n    def format_item(item):\n        # Ensure Python booleans print as True/False\n        return f\"[{item[0]},{item[1]},{item[2]},{item[3]}]\"\n    print(f\"[[{','.join(format_item(r) for r in results)}]]\")\n\nsolve()\n```"
        }
    ]
}