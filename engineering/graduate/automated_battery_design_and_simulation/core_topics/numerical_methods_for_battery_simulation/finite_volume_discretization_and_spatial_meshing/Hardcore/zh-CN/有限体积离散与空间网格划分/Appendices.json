{
    "hands_on_practices": [
        {
            "introduction": "此练习旨在巩固您对有限体积法核心原理的理解。通过对一维扩散问题进行离散化并对所有控制体积的方程求和，您将直接证明每个控制体积上的局部守恒如何确保整个区域的全局守恒。这一关键特性使得有限体积法在模拟电池等物理系统时表现稳健。",
            "id": "3914775",
            "problem": "考虑一个一维锂离子电池半电池电解质区域，其厚度为 $L$，横截面积均匀为 $A$，空间坐标为 $x \\in [0, L]$。电解质的体积分数（孔隙率）在空间上是恒定的，等于 $\\varepsilon$。在宏观尺度上，电解质浓度 $c(x,t)$ 的演化遵循质量守恒和菲克扩散，其通量服从菲克定律。具体而言，其控制偏微分方程（PDE）和本构关系为\n$$\n\\frac{\\partial}{\\partial t}\\left(\\varepsilon\\,c(x,t)\\right) + \\frac{\\partial}{\\partial x} J(x,t) \\;=\\; 0,\n\\qquad\nJ(x,t) \\;=\\; -D\\,\\frac{\\partial c}{\\partial x}(x,t),\n$$\n其中 $D$ 是一个恒定的有效扩散系数，并且没有体积源或汇。该半电池是一个更大的自动化电池设计和仿真工作流程的一部分，其空间离散化必须在网格细化下保持守恒性。\n\n使用有限体积法（FVM）将该区域离散为 $N$ 个非均匀控制体，其单元中心为 $\\{x_i\\}_{i=1}^N$，宽度为 $\\{\\Delta x_i\\}_{i=1}^N$，使得 $\\sum_{i=1}^N \\Delta x_i = L$。将单元 $i$ 中的单元平均浓度记为 $c_i(t)$，并设单元 $i$ 和 $i+1$ 之间的界面位于 $x_{i+1/2}$，其几何半间距为 $\\delta_{i+1/2} = \\frac{\\Delta x_i}{2} + \\frac{\\Delta x_{i+1}}{2}$。在内部界面处采用标准的二点通量近似，\n$$\nJ_{i+1/2}(t) \\;=\\; -D\\,\\frac{c_{i+1}(t) - c_i(t)}{\\delta_{i+1/2}},\n$$\n并假设在 $x=0$ 处的边界通量为 $J_{1/2}(t)$，在 $x=L$ 处的边界通量为 $J_{N+1/2}(t)$（在 $+x$ 方向上为正）。从每个控制体上的守恒积分形式出发，并利用散度定理，推导出单元 $i$ 中 $c_i(t)$ 的半离散常微分方程（ODE），用相邻的数值通量表示。然后，将所有 $i \\in \\{1,\\dots,N\\}$ 的半离散方程求和，以表明该离散格式在边界通量范围内保持全局守恒性，并获得仅用边界通量表示的半电池中所含电解质总摩尔数净变化率的紧凑表达式。\n\n您最终报告的量必须是半电池中所含电解质总摩尔数净变化率的紧凑表达式，单位为 $\\mathrm{mol}\\,\\mathrm{s}^{-1}$。不需要进行数值计算。在最终答案中不要提供任何中间等式；只报告最终的表达式。",
            "solution": "该问题经过验证，被认为是有效的，因为它具有科学依据、良态的且客观。它代表了偏微分方程数值方法领域的一个标准推导，特别是用于证明有限体积格式的守恒性质。\n\n推导过程如下。\n\n首先，我们建立守恒定律的积分形式。电解质浓度 $c(x,t)$ 的控制偏微分方程（PDE）如下所示：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\varepsilon\\,c(x,t)\\right) + \\frac{\\partial}{\\partial x} J(x,t) = 0\n$$\n其中 $\\varepsilon$ 是恒定的孔隙率，$c$ 是浓度，$J$ 是摩尔通量。有限体积法（FVM）的基础是在每个控制体上以积分形式满足该守恒定律。我们将 PDE 在任意一个控制体 $i$ 上积分，该控制体由区间 $[x_{i-1/2}, x_{i+1/2}]$ 定义，宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$。\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\frac{\\partial}{\\partial t}(\\varepsilon c) \\right) dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\frac{\\partial J}{\\partial x} \\right) dx = 0\n$$\n在控制体上对一个量进行积分是 FVM 的一个基本步骤。\n\n接下来，我们计算这两个积分项。对于时间导数项，由于积分限在时间上是固定的，我们可以交换微分和积分算子（莱布尼茨积分法则）。此外，由于 $\\varepsilon$ 是一个常数，可以将其提取出来。\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial}{\\partial t}(\\varepsilon c) \\, dx = \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\varepsilon c \\, dx = \\varepsilon \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} c \\, dx\n$$\n问题将单元 $i$ 中的单元平均浓度定义为 $c_i(t)$。该量表示连续浓度 $c(x,t)$ 在控制体 $i$ 上的平均值：\n$$\nc_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) \\, dx\n$$\n代入该定义，时间导数项变为：\n$$\n\\varepsilon \\frac{d}{dt} \\left( \\Delta x_i c_i(t) \\right) = \\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt}\n$$\n这里我们利用了单元宽度 $\\Delta x_i$ 不随时间变化的事实。\n\n对于空间导数项，我们应用微积分基本定理，这是一维形式的散度定理：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial J}{\\partial x} \\, dx = J(x_{i+1/2}, t) - J(x_{i-1/2}, t)\n$$\n该项表示通过控制体 $i$ 在其边界 $x_{i-1/2}$ 和 $x_{i+1/2}$ 处的净流出通量。\n\n结合这些结果，我们得到单元平均浓度的精确积分平衡式：\n$$\n\\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} + J(x_{i+1/2}, t) - J(x_{i-1/2}, t) = 0\n$$\n为了得到半离散 FVM 方程，我们将界面处的精确连续通量 $J(x_{i\\pm1/2}, t)$ 替换为其数值近似值，记为 $J_{i\\pm1/2}(t)$。这就得到了 $c_i(t)$ 演化的半离散常微分方程（ODE）：\n$$\n\\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} = J_{i-1/2}(t) - J_{i+1/2}(t)\n$$\n该方程是第一个要求的结果。它表示控制体 $i$ 中物质量的变化率是进出该体积的数值通量的平衡。通量的具体形式 $J_{i+1/2} = -D(c_{i+1} - c_i)/\\delta_{i+1/2}$ 确保了离开单元 $i$ 的通量与进入单元 $i+1$ 的通量相同，这是局部守恒的基本性质。\n\n下一个任务是证明全局守恒性。整个区域内电解质物质的总摩尔数 $M_{total}(t)$ 是 $N$ 个控制体中每个控制体摩尔数的总和。单元 $i$ 中电解质的体积是 $\\varepsilon A \\Delta x_i$。因此，总摩尔数为：\n$$\nM_{total}(t) = \\sum_{i=1}^{N} c_i(t) (\\varepsilon A \\Delta x_i)\n$$\n为了求出总摩尔数的净变化率，我们将此表达式对时间求导。由于 $\\varepsilon$、$A$ 和 $\\Delta x_i$ 是常数：\n$$\n\\frac{d M_{total}}{dt} = \\frac{d}{dt} \\left( \\sum_{i=1}^{N} \\varepsilon A \\Delta x_i c_i(t) \\right) = A \\sum_{i=1}^{N} \\left( \\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} \\right)\n$$\n现在我们将前面推导的半离散 ODE 代入此求和式中：\n$$\n\\frac{d M_{total}}{dt} = A \\sum_{i=1}^{N} \\left( J_{i-1/2}(t) - J_{i+1/2}(t) \\right)\n$$\n右侧的求和是一个伸缩级数：\n$$\n\\sum_{i=1}^{N} (J_{i-1/2} - J_{i+1/2}) = (J_{1/2} - J_{3/2}) + (J_{3/2} - J_{5/2}) + \\dots + (J_{N-1/2} - J_{N+1/2})\n$$\n在这个级数中，所有内部通量都相互抵消。例如，离开单元 $i$ 的通量 $-J_{i+1/2}$ 与进入单元 $i+1$ 的通量 $+J_{(i+1)-1/2} = +J_{i+1/2}$ 相抵消。唯一剩下的项是区域外部边界上的通量：第一个单元（$i=1$）左边界的通量 $J_{1/2}$ 和最后一个单元（$i=N$）右边界的通量 $J_{N+1/2}$。\n$$\n\\sum_{i=1}^{N} (J_{i-1/2} - J_{i+1/2}) = J_{1/2}(t) - J_{N+1/2}(t)\n$$\n这个结果表明，整个区域内守恒量的总变化量仅由穿过区域外部边界的通量决定。这是离散守恒格式的定义。\n\n最后，我们写出半电池中所含电解质总摩尔数净变化率的紧凑表达式。这是求和的最终结果：\n$$\n\\frac{d M_{total}}{dt} = A \\left( J_{1/2}(t) - J_{N+1/2}(t) \\right)\n$$\n通量 $J$ 的单位是 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，面积 $A$ 的单位是 $\\mathrm{m}^2$。因此，表达式 $A(J_{1/2} - J_{N+1/2})$ 的单位是 $\\mathrm{mol}\\,\\mathrm{s}^{-1}$，这是摩尔数变化率的正确单位。该表达式表示在 $x=0$ 处流入区域的总摩尔流率减去在 $x=L$ 处流出区域的总摩尔流率。",
            "answer": "$$\n\\boxed{A \\left( J_{1/2} - J_{N+1/2} \\right)}\n$$"
        },
        {
            "introduction": "在构建了数值格式之后，我们必须验证其代码实现的正确性。本练习将介绍强大的“人造解方法”（Method of Manufactured Solutions, MMS），这是代码验证的基石。通过预先设定一个精确的解析解，您将推导出相应的源项，从而为求解器在任意网格上处理耦合物理和复杂源项的能力提供一个严格的测试。",
            "id": "3914764",
            "problem": "在自动化电池设计与仿真中，多孔电极子域中的耦合扩散-输运与电荷守恒系统通常使用有限体积法（FVM）求解。为了在不依赖于几何形状和网格偏斜度的情况下，验证代码的空间网格划分和FVM实现，可以采用制造解方法，即指定光滑场，并通过适当选择源项使其精确满足控制方程。考虑在单位正方形域 $\\Omega = [0,1] \\times [0,1]$ 上定义的以下无量纲耦合偏微分方程：\n$$\n-\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c = S_{\\phi}(x,y), \\quad (x,y) \\in \\Omega,\n$$\n$$\n-\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\, \\phi = S_{c}(x,y), \\quad (x,y) \\in \\Omega,\n$$\n其中 $\\phi(x,y)$ 是无量纲电解质电势，$c(x,y)$ 是无量纲溶质浓度，$\\kappa>0$ 和 $D>0$ 是恒定的无量纲输运系数，$\\beta$ 和 $\\gamma$ 是体现了线性化反应项的恒定耦合参数。在有限体积法（FVM）中，通量在控制体表面上积分，源项在单元体积上积分；因此，已知的体积源项 $S_{\\phi}$ 和 $S_{c}$ 支持通过制造解方法在任意空间网格上进行严格的代码验证。\n\n选择在 $\\Omega$ 上二阶连续可微的光滑制造场，\n$$\n\\phi(x,y) = \\sin(\\pi x)\\,\\cos(\\pi y), \\qquad c(x,y) = \\cos(\\pi x)\\,\\sin(\\pi y),\n$$\n并通过将这些场限制在 $\\partial \\Omega$ 上来定义边界条件，使得该制造场为精确解。仅使用电荷和质量的基本守恒定律以及 Fick 定律和 Ohm 定律的无量纲线性形式（即扩散通量与梯度成正比，源项代表体积生成/消耗），推导源项 $S_{\\phi}(x,y)$ 和 $S_{c}(x,y)$，使得上述方程对所有 $(x,y) \\in \\Omega$ 恒成立。\n\n为获得一个适用于在任意空间网格上进行FVM代码验证的、与网格无关的标量诊断量，定义泛函\n$$\nJ \\;=\\; \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n以 $\\kappa$、$D$、$\\beta$ 和 $\\gamma$ 的函数形式，给出 $J$ 的闭合形式。您的最终答案必须是这个单一的、闭合形式的解析表达式。最终答案中不应包含单位。",
            "solution": "用户希望我解决一个基于计算物理学中制造解方法的问题。\n\n### 第 1 步：提取已知条件\n-   **定义域**：$\\Omega = [0,1] \\times [0,1]$。\n-   **控制方程**：\n    -   $-\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c = S_{\\phi}(x,y)$\n    -   $-\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\, \\phi = S_{c}(x,y)$\n-   **变量和场**：\n    -   $\\phi(x,y)$：无量纲电解质电势。\n    -   $c(x,y)$：无量纲溶质浓度。\n    -   $S_{\\phi}(x,y), S_{c}(x,y)$：体积源项。\n-   **常数**：\n    -   $\\kappa>0$：恒定的无量纲输运系数。\n    -   $D>0$：恒定的无量纲输运系数。\n    -   $\\beta, \\gamma$：恒定的耦合参数。\n-   **制造解**：\n    -   $\\phi(x,y) = \\sin(\\pi x)\\,\\cos(\\pi y)$\n    -   $c(x,y) = \\cos(\\pi x)\\,\\sin(\\pi y)$\n-   **待计算的泛函**：\n    -   $J = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题经过了严格的验证过程。\n\n-   **科学依据**：该问题很好地基于连续介质力学和数值分析的原理。控制方程代表了一个线性化的稳态反应-扩散系统，这是电化学等领域中耦合输运现象的常用模型。制造解方法是验证数值代码实现正确性的一种标准且受推崇的技术。该设置在科学上和数学上都是合理的。\n-   **适定性**：该问题是适定的。它不要求求解未知场的偏微分方程，而是要求推导源项，以使方程对于给定的指定场成立。这是一个涉及微分和代入的直接计算。后续计算这些推导出的源项的定积分也是一个明确定义的数学问题。所提供的场在定义域上是二阶连续可微的（$C^{\\infty}$），确保所有需要的导数都存在且连续。\n-   **客观性**：该问题以精确、客观的数学语言陈述。没有主观或模糊的术语。\n-   **一致性与完整性**：该问题是自洽的。所有推导源项和计算泛函 $J$ 所必需的方程、场和常数都已提供。将边界条件定义为制造解的限制，在MMS（制造解方法）的背景下是一种标准且完整的规范。\n\n### 第 3 步：结论与行动\n该问题是有效的。这是一个应用于验证偏微分方程数值方法的矢量微积分标准练习。现在开始求解过程。\n\n### 源项的推导\n\n主要任务是找到源项 $S_{\\phi}(x,y)$ 和 $S_{c}(x,y)$，使之对于给定的制造解 $\\phi(x,y)$ 和 $c(x,y)$ 恒满足控制方程。\n\n对于第一个关于电势 $\\phi$ 的方程：\n$$\nS_{\\phi}(x,y) = -\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c\n$$\n因为 $\\kappa$ 是一个常数，散度项简化为 $-\\kappa \\nabla \\cdot (\\nabla \\phi) = -\\kappa \\nabla^2 \\phi$，其中 $\\nabla^2$ 是拉普拉斯算子。\n$$\nS_{\\phi}(x,y) = -\\kappa \\nabla^2 \\phi + \\beta \\, c\n$$\n我们计算制造解 $\\phi(x,y) = \\sin(\\pi x)\\cos(\\pi y)$ 的拉普拉斯算子。\n首先，我们求关于 $x$ 的偏导数：\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sin(\\pi x)\\cos(\\pi y) \\right) = \\pi \\cos(\\pi x)\\cos(\\pi y)\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\pi \\cos(\\pi x)\\cos(\\pi y) \\right) = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\n接下来，是关于 $y$ 的偏导数：\n$$\n\\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sin(\\pi x)\\cos(\\pi y) \\right) = -\\pi \\sin(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left( -\\pi \\sin(\\pi x)\\sin(\\pi y) \\right) = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\n拉普拉斯算子是二阶偏导数之和：\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y) - \\pi^2 \\sin(\\pi x)\\cos(\\pi y) = -2\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\n注意到 $\\phi(x,y) = \\sin(\\pi x)\\cos(\\pi y)$，我们有 $\\nabla^2 \\phi = -2\\pi^2 \\phi$。\n将其代回 $S_{\\phi}$ 的表达式中：\n$$\nS_{\\phi}(x,y) = -\\kappa (-2\\pi^2 \\phi) + \\beta c = 2\\pi^2 \\kappa \\phi + \\beta c\n$$\n用 $x$ 和 $y$ 表示：\n$$\nS_{\\phi}(x,y) = 2\\pi^2 \\kappa \\sin(\\pi x)\\cos(\\pi y) + \\beta \\cos(\\pi x)\\sin(\\pi y)\n$$\n\n类似地，对于第二个关于浓度 $c$ 的方程：\n$$\nS_{c}(x,y) = -\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\phi\n$$\n因为 $D$ 是一个常数，该式简化为：\n$$\nS_{c}(x,y) = -D \\nabla^2 c - \\gamma \\phi\n$$\n我们计算制造解 $c(x,y) = \\cos(\\pi x)\\sin(\\pi y)$ 的拉普拉斯算子。\n关于 $x$ 的偏导数：\n$$\n\\frac{\\partial c}{\\partial x} = -\\pi \\sin(\\pi x)\\sin(\\pi y), \\qquad \\frac{\\partial^2 c}{\\partial x^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\n关于 $y$ 的偏导数：\n$$\n\\frac{\\partial c}{\\partial y} = \\pi \\cos(\\pi x)\\cos(\\pi y), \\qquad \\frac{\\partial^2 c}{\\partial y^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\n$c$ 的拉普拉斯算子是：\n$$\n\\nabla^2 c = \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial y^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y) - \\pi^2 \\cos(\\pi x)\\sin(\\pi y) = -2\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\n注意到 $c(x,y) = \\cos(\\pi x)\\sin(\\pi y)$，我们有 $\\nabla^2 c = -2\\pi^2 c$。\n将其代回 $S_{c}$ 的表达式中：\n$$\nS_{c}(x,y) = -D (-2\\pi^2 c) - \\gamma \\phi = 2\\pi^2 D c - \\gamma \\phi\n$$\n用 $x$ 和 $y$ 表示：\n$$\nS_{c}(x,y) = 2\\pi^2 D \\cos(\\pi x)\\sin(\\pi y) - \\gamma \\sin(\\pi x)\\cos(\\pi y)\n$$\n\n### 泛函 $J$ 的计算\n\n现在我们必须计算积分 $J$：\n$$\nJ = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n我们来分析被积函数 $S_{\\phi}^{2} + S_{c}^{2}$。\n$$\nS_{\\phi}^{2} = \\left( 2\\pi^2 \\kappa \\phi + \\beta c \\right)^2 = (2\\pi^2 \\kappa)^2 \\phi^2 + \\beta^2 c^2 + 2(2\\pi^2 \\kappa)\\beta \\phi c\n$$\n$$\nS_{c}^{2} = \\left( 2\\pi^2 D c - \\gamma \\phi \\right)^2 = (2\\pi^2 D)^2 c^2 + \\gamma^2 \\phi^2 - 2(2\\pi^2 D)\\gamma \\phi c\n$$\n将它们相加得到：\n$$\nS_{\\phi}^{2} + S_{c}^{2} = \\left( (2\\pi^2\\kappa)^2 + \\gamma^2 \\right)\\phi^2 + \\left( \\beta^2 + (2\\pi^2 D)^2 \\right)c^2 + \\left( 4\\pi^2\\kappa\\beta - 4\\pi^2 D\\gamma \\right)\\phi c\n$$\n积分 $J$ 变为：\n$$\nJ = \\left( 4\\pi^4\\kappa^2 + \\gamma^2 \\right) \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y + \\left( \\beta^2 + 4\\pi^4 D^2 \\right) \\int_{0}^{1}\\!\\!\\int_{0}^{1} c^2 \\,\\mathrm{d}x\\mathrm{d}y + 4\\pi^2(\\kappa\\beta - D\\gamma) \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y\n$$\n我们需要计算三个二重积分。\n1. $\\phi^2$ 的积分：\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\sin^2(\\pi x)\\cos^2(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\int_{0}^{1} \\sin^2(\\pi x) \\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\cos^2(\\pi y) \\,\\mathrm{d}y\\right)\n$$\n使用恒等式 $\\int_0^1 \\sin^2(\\pi u)\\,\\mathrm{d}u = \\int_0^1 \\frac{1-\\cos(2\\pi u)}{2}\\,\\mathrm{d}u = \\left[\\frac{u}{2} - \\frac{\\sin(2\\pi u)}{4\\pi}\\right]_0^1 = \\frac{1}{2}$，以及类似地 $\\int_0^1 \\cos^2(\\pi u)\\,\\mathrm{d}u = \\frac{1}{2}$。\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n2. $c^2$ 的积分：\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} c^2 \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\cos^2(\\pi x)\\sin^2(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\int_{0}^{1} \\cos^2(\\pi x) \\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\sin^2(\\pi y) \\,\\mathrm{d}y\\right) = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n3. 交叉项 $\\phi c$ 的积分：\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\sin(\\pi x)\\cos(\\pi y) \\cos(\\pi x)\\sin(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y\n$$\n$$\n= \\left(\\int_{0}^{1} \\sin(\\pi x)\\cos(\\pi x)\\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\cos(\\pi y)\\sin(\\pi y)\\,\\mathrm{d}y\\right)\n$$\n使用恒等式 $\\int_0^1 \\sin(\\pi u)\\cos(\\pi u)\\,\\mathrm{d}u = \\int_0^1 \\frac{1}{2}\\sin(2\\pi u)\\,\\mathrm{d}u = \\left[-\\frac{\\cos(2\\pi u)}{4\\pi}\\right]_0^1 = -\\frac{1}{4\\pi}(\\cos(2\\pi)-\\cos(0)) = 0$。\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y = (0)(0) = 0\n$$\n函数 $\\phi$ 和 $c$ 在定义域 $\\Omega$ 上的正交性大大简化了计算。将这些积分值代回 $J$ 的表达式中：\n$$\nJ = \\left( 4\\pi^4\\kappa^2 + \\gamma^2 \\right) \\left(\\frac{1}{4}\\right) + \\left( \\beta^2 + 4\\pi^4 D^2 \\right) \\left(\\frac{1}{4}\\right) + 4\\pi^2(\\kappa\\beta - D\\gamma) (0)\n$$\n$$\nJ = \\frac{1}{4} \\left( 4\\pi^4\\kappa^2 + \\gamma^2 + \\beta^2 + 4\\pi^4 D^2 \\right)\n$$\n重新排列各项以组合公因子：\n$$\nJ = \\frac{1}{4} \\left( 4\\pi^4(\\kappa^2 + D^2) + (\\beta^2 + \\gamma^2) \\right) = \\pi^4(\\kappa^2 + D^2) + \\frac{1}{4}(\\beta^2 + \\gamma^2)\n$$\n这就是泛函 $J$ 的最终闭合形式表达式。",
            "answer": "$$\n\\boxed{\\pi^{4}(\\kappa^{2} + D^{2}) + \\frac{1}{4}(\\beta^{2} + \\gamma^{2})}\n$$"
        },
        {
            "introduction": "一个经过验证的代码是可靠模拟的必要条件，但还不足够；我们还必须量化数值误差。本练习将指导您完成“网格收敛指数”（Grid Convergence Index, GCI）方法的计算，这是一种通过在系列加密网格上进行模拟来估计离散误差的标准流程。掌握这项技术对于充满信心地报告模拟结果以及判断解是否已充分收敛至关重要。",
            "id": "3914785",
            "problem": "使用有限体积法 (FVM) 在一维域中计算锂离子电池 (LIB) 的电解质浓度场。物质的控制基础是一条守恒原理，即守恒量的变化率等于通量散度加上源项，其微分形式是一个偏微分方程 (PDE)。对于固定探头位置的稳态操作，假定在渐近范围内，一致的 FVM 格式的数值离散误差表现为特征网格间距的主阶幂次关系。具体来说，设细、中、粗三套网格的网格间距分别为 $h_1$、$h_2$ 和 $h_3$，它们具有一个共同的加密比 $r$，定义为 $r = h_2 / h_1 = h_3 / h_2$ 且 $r > 1$。假设在固定探头位置，电解质浓度 $c$ 的数值解满足渐近误差模型 $c(h) = c^\\ast + C h^p + \\mathcal{O}(h^{p+1})$，其中 $c^\\ast$ 是连续极限解，$C$ 是一个与 $h$ 无关的常数，$p$ 是观测到的精度阶。\n\n你的任务是基于这些假设，推导出如何使用理查森外推法和三套连续加密的网格来确定观测到的精度阶 $p$，计算探头位置的连续外插浓度 $c^\\ast$，并计算细网格的网格收敛指数 (GCI)。网格收敛指数 (GCI) 必须以小数形式报告（而非百分比）。对所有测试用例，使用安全系数 $F_s = 1.25$。\n\n程序必须以适用于任何现代编程语言的方式实现该推导，并且必须为给定的测试套件生成数值答案。将以下输入数据视为在相同探头位置，针对三套网格和加密比 $r$ 计算得到的电解质浓度值：\n\n- 测试用例 $1$（理想情况，清晰的二阶行为）：$c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_2 = 995.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_3 = 975.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$r = 2.0$。\n- 测试用例 $2$（边界情况，$r$ 接近 $1$）：$c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_2 = 990.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_3 = 977.9$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$r = 1.1$。\n- 测试用例 $3$（边缘情况，非单调序列）：$c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_2 = 1002.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_3 = 998.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$r = 2.0$。\n- 测试用例 $4$（高加密比）：$c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_2 = 997.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_3 = 988.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$r = 3.0$。\n- 测试用例 $5$（非整数加密比，分数阶）：$c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_2 = 992.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_3 = 977.304$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$r = 1.5$。\n\n对于每个测试用例，计算：\n- 观测到的精度阶 $p$。\n- 连续外插的探头浓度 $c^\\ast$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 细网格的网格收敛指数 $\\mathrm{GCI}_{21}$，以小数形式表示（无单位）。\n- 一个布尔标志，指示序列是否为渐近且单调的。其定义条件为 $r > 1$，$\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$，以及 $(c_1 - c_2)$ 和 $(c_2 - c_3)$ 符号相同。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身也是一个列表，形式为 $[p, c^\\ast, \\mathrm{GCI}_{21,1}, \\mathrm{is\\_asymptotic}_1],[p_2, c^\\ast_2, \\mathrm{GCI}_{21,2}, \\mathrm{is\\_asymptotic}_2],\\ldots]$。所有报告的 $c^\\ast$ 都必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 为单位。所有 GCI 值都必须是小数。此问题不涉及角度。",
            "solution": "该问题要求基于理查森外推法的原理，推导并应用网格收敛性分析的公式。分析将在锂离子电池模拟的电解质浓度数值解上进行。\n\n**问题验证**\n\n首先，我将验证问题陈述。\n\n**步骤 1：提取已知条件**\n- **物理背景：** 针对锂离子电池 (LIB) 电解质浓度场的一维有限体积法 (FVM) 模拟。\n- **误差模型：** 假定在固定点，浓度 $c$ 的数值解遵循渐近误差模型：$c(h) = c^\\ast + C h^p + \\mathcal{O}(h^{p+1})$，其中 $c^\\ast$ 是连续极限解，$C$ 是常数，$h$ 是特征网格间距，$p$ 是观测到的精度阶。\n- **网格层次结构：** 使用三套连续加密的网格：细网格（间距 $h_1$，解 $c_1$）、中等网格（间距 $h_2$，解 $c_2$）和粗网格（间距 $h_3$，解 $c_3$）。\n- **加密比：** 使用恒定的加密比 $r$，定义为 $r = h_2 / h_1 = h_3 / h_2$ 且 $r > 1$。这意味着 $h_2 = r h_1$ 和 $h_3 = r^2 h_1$。\n- **GCI 安全系数：** 为网格收敛指数 (GCI) 的计算指定了安全系数 $F_s = 1.25$。\n- **渐近/单调性检查：** 如果 $r > 1$，$\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$，并且 $(c_1 - c_2)$ 和 $(c_2 - c_3)$ 符号相同，则认为序列处于渐近单调收敛范围内。\n- **输入数据：** 提供了五个测试用例，每个用例都包含 $c_1$、$c_2$、$c_3$ 和 $r$ 的值。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及标准且被广泛接受的网格收敛指数 (GCI) 方法，这是计算科学中验证和确认的基石。问题定义明确，提供了所有必要的数据和一个清晰、明确的理论模型 ($c(h) = c^\\ast + C h^p$)，从中可以唯一地推导出所需量。语言客观且正式。该问题未违反任何指定的无效性标准；这是一个数值方法的标准练习。\n\n**步骤 3：结论与行动**\n该问题被认定为有效。下面是一个完整的、有理有据的解答。\n\n**网格收敛量推导**\n\n让我们从渐近误差模型开始，忽略三套网格的高阶项：\n$c_1 \\approx c^\\ast + C h_1^p$  (1)\n$c_2 \\approx c^\\ast + C h_2^p = c^\\ast + C (r h_1)^p = c^\\ast + C r^p h_1^p$  (2)\n$c_3 \\approx c^\\ast + C h_3^p = c^\\ast + C (r^2 h_1)^p = c^\\ast + C r^{2p} h_1^p$  (3)\n\n**1. 观测精度阶 ($p$) 的推导**\n为了求出 $p$，我们必须消去未知常数 $c^\\ast$ 和 $C$。这可以通过考察连续网格上解的差异来实现。\n令 $\\epsilon_{21} = c_2 - c_1$ 和 $\\epsilon_{32} = c_3 - c_2$。\n由方程 (1) 和 (2) 可得：\n$\\epsilon_{21} = c_2 - c_1 \\approx (c^\\ast + C r^p h_1^p) - (c^\\ast + C h_1^p) = C h_1^p (r^p - 1)$  (4)\n由方程 (2) 和 (3) 可得：\n$\\epsilon_{32} = c_3 - c_2 \\approx (c^\\ast + C r^{2p} h_1^p) - (c^\\ast + C r^p h_1^p) = C h_1^p (r^{2p} - r^p) = C r^p h_1^p (r^p - 1)$  (5)\n现在，我们将这两个差值相除，以消去 $C$、$h_1$ 和项 $(r^p - 1)$：\n$$ \\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{c_3 - c_2}{c_2 - c_1} \\approx \\frac{C r^p h_1^p (r^p - 1)}{C h_1^p (r^p - 1)} = r^p $$\n如果收敛是单调的，则此关系成立。为了处理振荡收敛的情况（此时比率可能为负），我们使用绝对值。求解 $p$：\n$$ r^p = \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| $$\n对两边取自然对数，得到：\n$$ p \\ln(r) = \\ln\\left( \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| \\right) $$\n因此，观测到的精度阶为：\n$$ p = \\frac{\\ln\\left( \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| \\right)}{\\ln(r)} $$\n\n**2. 连续外插解 ($c^\\ast$) 的推导**\n这个过程被称为理查森外推法，它使用两套网格的解和已确定的精度阶 $p$ 来估计零网格间距 ($h=0$) 时的解。使用方程 (1) 和 (2)：\n$c_1 = c^\\ast + C h_1^p$\n$c_2 = c^\\ast + C r^p h_1^p$\n为了消去误差项 $C h_1^p$，我们可以将第一个方程乘以 $r^p$，然后减去第二个方程：\n$r^p c_1 = r^p c^\\ast + r^p C h_1^p$\n$c_2 = c^\\ast + C r^p h_1^p$\n用第一个方程减去第二个方程得到：\n$r^p c_1 - c_2 = (r^p - 1) c^\\ast$\n求解连续外插浓度 $c^\\ast$：\n$$ c^\\ast = \\frac{r^p c_1 - c_2}{r^p - 1} $$\n另一个常用但等价的形式是：\n$$ c^\\ast = c_1 + \\frac{c_1 - c_2}{r^p - 1} $$\n\n**3. 细网格收敛指数 ($\\mathrm{GCI}_{21}$) 的推导**\n网格收敛指数 (GCI) 为给定网格上数值解的离散误差提供了一个保守估计。对于细网格（使用网格 1 和 2 的解），$\\mathrm{GCI}_{21}$ 是基于相对误差的估计值，并按安全系数 $F_s$进行缩放来定义的。\n细网格解的真实误差为 $E_1 = c_1 - c^\\ast$。使用我们关于 $c^\\ast$ 的表达式：\n$E_1 = c_1 - \\left( c_1 + \\frac{c_1 - c_2}{r^p - 1} \\right) = - \\frac{c_1 - c_2}{r^p - 1} = \\frac{c_2 - c_1}{r^p - 1}$\nGCI 方法论对该误差进行近似。细网格和中等网格之间的近似相对误差 $e_a$ 定义为：\n$$ e_a^{21} = \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\n然后，通过缩放这个相对差异来计算细网格 GCI，即 $\\mathrm{GCI}_{21}$：\n$$ \\mathrm{GCI}_{21} = F_s \\frac{|(c_1 - c^\\ast)/c_1|}{|c_1 - c^\\ast|} \\approx F_s \\frac{|E_1|}{|c_1|} $$\n代入误差 $E_1$ 的估计值，我们得到細网格 GCI 的标准公式：\n$$ \\mathrm{GCI}_{21} = \\frac{F_s}{r^p - 1} \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\n给定安全系数 $F_s = 1.25$，公式变为：\n$$ \\mathrm{GCI}_{21} = \\frac{1.25}{r^p - 1} \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\n该值以小数形式报告，代表细网格解的一个误差带。\n\n**4. 渐近与单调收敛性检查**\n问题指定了三个条件来确定解是否处于渐近且单调的收敛范围内：\n1. 加密比必须大于 1：$r > 1$。\n2. 随着网格加密，解的变化必须减小：$\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$。这表明解正在趋于稳定。\n3. 收敛必须是单調的，意味着解从同一侧逼近连续值。这可以通过确保差值 $(c_1 - c_2)$ 和 $(c_2 - c_3)$ 具有相同符号来检查。在数学上，这等价于它们的乘积为正：$(c_1 - c_2)(c_2 - c_3) > 0$。\n\n仅当所有三个条件都满足时，布尔标志 `is_asymptotic` 才会被设置为真。这些推导为实现所需程序提供了完整的理论基础。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for grid convergence metrics based on Richardson extrapolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c1, c2, c3, r)\n    # c1, c2, c3 are solutions on fine, medium, and coarse meshes.\n    # r is the constant refinement ratio.\n    test_cases = [\n        (1000.0, 995.0, 975.0, 2.0),\n        (1000.0, 990.0, 977.9, 1.1),\n        (1000.0, 1002.0, 998.0, 2.0),\n        (1000.0, 997.0, 988.0, 3.0),\n        (1000.0, 992.0, 977.304, 1.5),\n    ]\n\n    results = []\n    Fs = 1.25  # Safety factor for GCI\n\n    for case in test_cases:\n        c1, c2, c3, r = case\n\n        # Calculate differences between solutions\n        e21 = c2 - c1\n        e32 = c3 - c2\n\n        # --- 1. Observed Order of Accuracy (p) ---\n        # p = ln(|(c3 - c2) / (c2 - c1)|) / ln(r)\n        if e21 == 0.0:\n            # If the fine and medium solutions are the same, the ratio is undefined.\n            # This indicates the method is not applicable or has converged to machine precision.\n            p = np.nan\n        else:\n            ratio = e32 / e21\n            # Use abs() to handle both monotonic (ratio > 0) and \n            # oscillatory (ratio  0) convergence, as per the GCI methodology.\n            # np.log(0) correctly returns -inf, and log of a negative number is avoided.\n            p = np.log(abs(ratio)) / np.log(r) if ratio != 0 else -np.inf\n        \n        # --- 2. Continuum-Extrapolated Solution (c_star) ---\n        # c_star = (r^p * c1 - c2) / (r^p - 1)\n        # also expressed as c_star = c1 + (c1 - c2)/(r^p - 1)\n        rp = r**p\n        if np.isnan(p) or rp == 1.0:\n            # Avoid division by zero if r^p = 1 (e.g., if p=0).\n            c_star = np.nan\n        else:\n            c_star = c1 + (c1 - c2) / (rp - 1)\n        \n        # --- 3. Fine-Grid Convergence Index (GCI_21) ---\n        # GCI_21 = Fs * |(c1 - c2) / c1| / (r^p - 1)\n        if np.isnan(p) or rp == 1.0 or c1 == 0.0:\n            gci_21 = np.nan # Avoid division by zero\n        else:\n            relative_error_approx = abs((c1 - c2) / c1)\n            gci_21 = Fs * relative_error_approx / (rp - 1)\n            \n        # --- 4. Asymptotic and Monotonic Convergence Check ---\n        # Conditions:\n        # 1. r > 1 (given for all cases)\n        # 2. |c1 - c2|  |c2 - c3|\n        # 3. (c1 - c2) and (c2 - c3) have the same sign, i.e., their product is positive.\n        diff12 = c1 - c2\n        diff23 = c2 - c3\n        \n        # The product (diff12 * diff23 > 0) checks if signs are the same.\n        is_asymptotic = (r > 1) and (abs(diff12)  abs(diff23)) and (diff12 * diff23 > 0)\n        \n        # Assemble the results for the current test case.\n        results.append([p, c_star, gci_21, is_asymptotic])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}