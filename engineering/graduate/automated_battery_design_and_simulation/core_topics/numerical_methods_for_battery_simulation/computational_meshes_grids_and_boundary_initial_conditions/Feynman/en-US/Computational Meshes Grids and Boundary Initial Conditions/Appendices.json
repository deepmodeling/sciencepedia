{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a battery simulation is intrinsically linked to the fineness of the computational mesh. However, for explicit time-stepping schemes, refining the spatial grid is not a cost-free endeavor. This practice explores the fundamental Courant–Friedrichs–Lewy (CFL) stability condition, a critical concept that governs the relationship between the spatial grid size $\\Delta x$ and the maximum permissible time step $\\Delta t$ . By deriving and applying this condition, you will gain a concrete understanding of why finer meshes demand drastically smaller time steps, a key consideration that directly impacts the computational cost and feasibility of simulations.",
            "id": "3901447",
            "problem": "Consider one-dimensional isothermal electrolyte transport in a lithium-ion battery separator of thickness $L$ governed by Fick’s second law, $\\partial c_{e}/\\partial t = D_{e} \\, \\partial^{2} c_{e}/\\partial x^{2}$, where $c_{e}(x,t)$ is the electrolyte concentration and $D_{e}$ is the constant electrolyte diffusion coefficient. The separator spans $x \\in [0, L]$ with physically realistic boundary conditions: fixed electrolyte concentrations at the electrode-separator interfaces, $c_{e}(0,t) = c_{0}$ and $c_{e}(L,t) = c_{L}$, and a smooth, bounded initial profile $c_{e}(x,0) = c_{e,0}(x)$. The spatial domain is discretized by a uniform computational grid of $N$ control volumes (cells) of width $\\Delta x = L/N$, and time advancement is performed by a forward Euler explicit method coupled with a second-order central difference approximation of the diffusion operator.\n\nStarting from the partial differential equation and these discretization choices, perform a Fourier (von Neumann) mode stability analysis to derive the stability condition for the explicit scheme. Identify the constant $\\alpha$ in the Courant–Friedrichs–Lewy (CFL)-like condition in terms of the discretization and physics, and show how the maximum stable time step $\\Delta t_{\\max}$ depends on $\\Delta x$ and $D_{e}$. Then, for a refined mesh with $N = 240$ over a separator thickness $L = 30 \\times 10^{-6}$ m and electrolyte diffusion coefficient $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s, compute the maximum allowable explicit time step for stability. Express your final numerical answer in seconds and round your answer to four significant figures.\n\nFinally, explain qualitatively how mesh refinement (increasing $N$ at fixed $L$) affects the allowable time step for explicit diffusion updates, making clear the scaling relationship and its implications for automated battery design and simulation workflows that employ mesh refinement strategies.",
            "solution": "The problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: One-dimensional isothermal electrolyte transport is governed by Fick’s second law, $\\partial c_{e}/\\partial t = D_{e} \\, \\partial^{2} c_{e}/\\partial x^{2}$.\n-   **Variables and Constants**: $c_{e}(x,t)$ is the electrolyte concentration, $D_{e}$ is the constant electrolyte diffusion coefficient, $L$ is the separator thickness.\n-   **Domain**: The spatial domain is $x \\in [0, L]$.\n-   **Boundary Conditions (BCs)**: Fixed concentrations at the interfaces, $c_{e}(0,t) = c_{0}$ and $c_{e}(L,t) = c_{L}$.\n-   **Initial Condition (IC)**: A smooth, bounded initial profile $c_{e}(x,0) = c_{e,0}(x)$.\n-   **Spatial Discretization**: Uniform computational grid with $N$ control volumes of width $\\Delta x = L/N$.\n-   **Temporal Discretization**: Forward Euler explicit method.\n-   **Spatial Operator Discretization**: Second-order central difference approximation for the diffusion operator.\n-   **Numerical Parameters**: For a specific case, $N = 240$, $L = 30 \\times 10^{-6}$ m, and $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s.\n-   **Required Tasks**:\n    1.  Derive the stability condition for the scheme using Fourier (von Neumann) analysis.\n    2.  Identify the constant $\\alpha$ in the Courant–Friedrichs–Lewy (CFL)-like condition.\n    3.  Show the dependence of the maximum stable time step $\\Delta t_{\\max}$ on $\\Delta x$ and $D_{e}$.\n    4.  Compute the numerical value of $\\Delta t_{\\max}$ for the given parameters, rounded to four significant figures.\n    5.  Explain qualitatively how mesh refinement affects the allowable time step.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the diffusion equation (Fick's second law), a cornerstone of transport phenomena, and applies it to a realistic scenario in battery modeling. The discretization methods (Forward Euler, central differences) are standard techniques in computational physics and engineering. The given physical parameters for $L$ and $D_e$ are appropriate for a lithium-ion battery. The problem is scientifically sound.\n-   **Well-Posed**: The problem is a standard initial-boundary value problem for a parabolic partial differential equation. The tasks are specific, computationally tractable, and lead to a unique, meaningful result.\n-   **Objective**: The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n-   **Completeness and Consistency**: The problem provides all necessary information—the PDE, domain, boundary and initial conditions, discretization schemes, and numerical values—to perform the analysis and calculations. There are no internal contradictions.\n-   **Realism**: The context of automated battery design and the challenge of numerical stability with explicit schemes is highly realistic and relevant in computational science.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and complete. A full solution will be provided.\n\nThe governing partial differential equation (PDE) is Fick's second law for one-dimensional diffusion:\n$$\n\\frac{\\partial c_{e}}{\\partial t} = D_{e} \\frac{\\partial^{2} c_{e}}{\\partial x^{2}}\n$$\nWe discretize this equation on a uniform grid. Let $c_{j}^{n}$ represent the numerical approximation of the concentration $c_{e}(x,t)$ at spatial node $x_j = j\\Delta x$ and time $t_n = n\\Delta t$.\n\nThe time derivative $\\partial c_{e}/\\partial t$ is approximated using the forward Euler method:\n$$\n\\frac{\\partial c_{e}}{\\partial t} \\bigg|_{j,n} \\approx \\frac{c_{j}^{n+1} - c_{j}^{n}}{\\Delta t}\n$$\nThe spatial second derivative $\\partial^{2} c_{e}/\\partial x^{2}$ is approximated using a second-order central difference scheme:\n$$\n\\frac{\\partial^{2} c_{e}}{\\partial x^{2}} \\bigg|_{j,n} \\approx \\frac{c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}}{(\\Delta x)^{2}}\n$$\nSubstituting these approximations into the PDE gives the fully discretized explicit scheme:\n$$\n\\frac{c_{j}^{n+1} - c_{j}^{n}}{\\Delta t} = D_{e} \\frac{c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}}{(\\Delta x)^{2}}\n$$\nSolving for the concentration at the next time step, $c_{j}^{n+1}$, we get:\n$$\nc_{j}^{n+1} = c_{j}^{n} + \\frac{D_{e} \\Delta t}{(\\Delta x)^{2}} (c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n})\n$$\nLet's define the dimensionless diffusion number, $s$, as:\n$$\ns = \\frac{D_{e} \\Delta t}{(\\Delta x)^{2}}\n$$\nThe update equation simplifies to:\n$$\nc_{j}^{n+1} = c_{j}^{n} + s(c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}) = s c_{j-1}^{n} + (1 - 2s) c_{j}^{n} + s c_{j+1}^{n}\n$$\nTo perform the von Neumann stability analysis, we investigate the growth or decay of a single Fourier mode of the solution (or error). Although the problem has fixed Dirichlet boundary conditions, this analysis provides the stability limit for the interior nodes, which is standard practice and generally sufficient. We assume a solution of the form:\n$$\nc_{j}^{n} = G^{n} e^{i k x_j} = G^{n} e^{i k j \\Delta x}\n$$\nwhere $k$ is the wavenumber and $G$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any possible wavenumber, i.e., $|G| \\le 1$.\n\nSubstituting the Fourier mode into the discrete equation:\n$$\nG^{n+1} e^{i k j \\Delta x} = s (G^{n} e^{i k (j-1) \\Delta x}) + (1 - 2s) (G^{n} e^{i k j \\Delta x}) + s (G^{n} e^{i k (j+1) \\Delta x})\n$$\nDividing by $G^{n} e^{i k j \\Delta x}$ gives the amplification factor $G$:\n$$\nG = s e^{-i k \\Delta x} + (1 - 2s) + s e^{i k \\Delta x}\n$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we can simplify the expression for $G$:\n$$\nG = 1 - 2s + s(e^{i k \\Delta x} + e^{-i k \\Delta x}) = 1 - 2s + 2s\\cos(k \\Delta x) = 1 - 2s(1 - \\cos(k \\Delta x))\n$$\nUsing the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$:\n$$\nG = 1 - 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThe stability condition $|G| \\le 1$ translates to $-1 \\le G \\le 1$.\nThe upper bound, $G \\le 1$, is always satisfied because $s = D_{e} \\Delta t/(\\Delta x)^2 \\ge 0$ and $\\sin^{2}(k \\Delta x / 2) \\ge 0$, so $G$ is always less than or equal to $1$.\nThe critical constraint comes from the lower bound, $G \\ge -1$:\n$$\n1 - 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\ns \\le \\frac{1}{2 \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)}\n$$\nThis condition must hold for all wavenumbers $k$. The most restrictive case (the \"worst case\" for stability) occurs when the denominator is minimized, which corresponds to the term $\\sin^{2}(k \\Delta x / 2)$ being maximized. The maximum value of $\\sin^{2}(\\cdot)$ is $1$, which occurs for the highest frequency mode the grid can represent, where $k \\Delta x = \\pi$.\nSetting $\\sin^{2}(k \\Delta x / 2) = 1$, the stability condition becomes:\n$$\ns \\le \\frac{1}{2}\n$$\nThis is the stability condition for the explicit scheme. The CFL-like condition for this parabolic problem is stated as $\\frac{D_e \\Delta t}{(\\Delta x)^2} \\le \\alpha$. By comparison, we identify the constant $\\alpha = 1/2$.\n\nFrom this condition, we can determine the maximum allowable time step, $\\Delta t_{\\max}$.\n$$\n\\frac{D_{e} \\Delta t}{(\\Delta x)^{2}} \\le \\frac{1}{2} \\implies \\Delta t \\le \\frac{(\\Delta x)^{2}}{2D_{e}}\n$$\nThus, the maximum stable time step is:\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2D_{e}}\n$$\nThis shows that $\\Delta t_{\\max}$ is directly proportional to the square of the cell width ($\\Delta x^2$) and inversely proportional to the diffusion coefficient ($D_e$).\n\nNow, we compute the numerical value for $\\Delta t_{\\max}$ using the given parameters: $N = 240$, $L = 30 \\times 10^{-6}$ m, and $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s.\nFirst, calculate the grid spacing $\\Delta x$:\n$$\n\\Delta x = \\frac{L}{N} = \\frac{30 \\times 10^{-6} \\, \\text{m}}{240} = 0.125 \\times 10^{-6} \\, \\text{m} = 1.25 \\times 10^{-7} \\, \\text{m}\n$$\nNext, substitute $\\Delta x$ and $D_{e}$ into the expression for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{(1.25 \\times 10^{-7} \\, \\text{m})^{2}}{2(2.8 \\times 10^{-10} \\, \\text{m}^{2}/\\text{s})} = \\frac{1.5625 \\times 10^{-14} \\, \\text{m}^{2}}{5.6 \\times 10^{-10} \\, \\text{m}^{2}/\\text{s}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.5625}{5.6} \\times 10^{-4} \\, \\text{s} \\approx 0.279017857... \\times 10^{-4} \\, \\text{s}\n$$\nIn scientific notation, this is approximately $2.79017857... \\times 10^{-5}$ s. Rounding to four significant figures gives:\n$$\n\\Delta t_{\\max} \\approx 2.790 \\times 10^{-5} \\, \\text{s}\n$$\n\nFinally, we explain the effect of mesh refinement on the allowable time step. The relationship is $\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2D_{e}}$. Since $\\Delta x = L/N$, we can express $\\Delta t_{\\max}$ in terms of $N$ (for a fixed domain size $L$):\n$$\n\\Delta t_{\\max} = \\frac{(L/N)^{2}}{2D_{e}} = \\left(\\frac{L^{2}}{2D_{e}}\\right) \\frac{1}{N^{2}}\n$$\nThis shows that $\\Delta t_{\\max}$ is inversely proportional to the square of the number of grid cells: $\\Delta t_{\\max} \\propto N^{-2}$.\nThis quadratic scaling relationship has severe implications for automated battery design and simulation. When an automated workflow refines the mesh to improve accuracy (i.e., increases $N$), the maximum stable time step for an explicit method decreases quadratically. For example, doubling the mesh resolution ($N \\to 2N$) forces a four-fold reduction in the time step ($\\Delta t_{\\max} \\to \\Delta t_{\\max}/4$). This drastically increases the total number of time steps needed to simulate a given physical time duration, leading to a substantial increase in computational cost. This stability constraint is a major drawback of explicit schemes for diffusion problems and often necessitates the use of more computationally complex but unconditionally stable implicit methods in scenarios requiring fine meshes or long time simulations.",
            "answer": "$$\\boxed{2.790 \\times 10^{-5}}$$"
        },
        {
            "introduction": "While the previous practice focused on the interplay between grid spacing and time steps, the geometric validity of the mesh elements themselves is equally paramount, especially when modeling complex battery component shapes. This exercise delves into the Finite Element Method (FEM) and introduces the concept of the Jacobian determinant, a mathematical tool that acts as a quality metric for each element in your mesh . Calculating the Jacobian for a mapped element will reveal why a positive, non-zero value is essential for preserving physical area and orientation, ensuring that numerical integrals and boundary fluxes are computed correctly.",
            "id": "3901526",
            "problem": "A two-dimensional porous electrode patch in a lithium-ion battery is discretized for the Finite Element Method (FEM) solution of the coupled electrochemical transport Partial Differential Equations (PDEs). To guarantee accurate numerical integration of element-level residuals and boundary fluxes under manufacturing shape variations used in automated battery design workflows, consider a single four-node isoparametric bilinear quadrilateral element that maps the reference square in the parent coordinate system $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ to a physical quadrilateral in $(x,y)$-space. The physical nodes are ordered counter-clockwise and located at\n$$\n(x_1,y_1)=\\left(0,\\,0\\right),\\quad (x_2,y_2)=\\left(1.5\\times 10^{-3},\\,0\\right),\\quad (x_3,y_3)=\\left(1.6\\times 10^{-3},\\,1.0\\times 10^{-3}\\right),\\quad (x_4,y_4)=\\left(0.1\\times 10^{-3},\\,1.0\\times 10^{-3}\\right).\n$$\nAssume standard bilinear isoparametric mapping with four-node shape functions from the reference square to the physical element. Using first principles of the change-of-variables theorem in multidimensional integration and the definition of the Jacobian matrix of a mapping, derive the Jacobian determinant $J(\\xi,\\eta) = \\det(\\partial(x,y)/\\partial(\\xi,\\eta))$ for this element as a function of $(\\xi,\\eta)$, and then compute its value.\n\nExplain, from the perspective of correct transformation of area measures in the weak form and consistent outward normal orientation for Neumann-type flux boundary conditions on mapped edges, why $J(\\xi,\\eta)$ must remain positive everywhere over the reference square to avoid inverted elements and ensure correct integration in automated battery design and simulation.\n\nExpress the final determinant in square meters and round your numerical answer to four significant figures.",
            "solution": "The problem requires the derivation and computation of the Jacobian determinant for a specific four-node isoparametric bilinear quadrilateral element, and an explanation of the significance of its sign in the context of the Finite Element Method (FEM) for automated battery simulation.\n\nFirst, we must validate the problem statement.\nThe givens are:\n- A four-node isoparametric bilinear quadrilateral element.\n- The reference element is a square in parent coordinates $(\\xi, \\eta)$ where $\\xi \\in [-1, 1]$ and $\\eta \\in [-1, 1]$.\n- The physical nodes are $(x_1, y_1) = (0, 0)$, $(x_2, y_2) = (1.5 \\times 10^{-3}, 0)$, $(x_3, y_3) = (1.6 \\times 10^{-3}, 1.0 \\times 10^{-3})$, and $(x_4, y_4) = (0.1 \\times 10^{-3}, 1.0 \\times 10^{-3})$. The units are implicitly meters, as the final answer is requested in square meters.\n- The mapping is a standard bilinear isoparametric transformation.\n\nThe problem is scientifically grounded in the principles of numerical methods (FEM) and continuum mechanics. The setup is self-contained, consistent, and well-posed. The nodal coordinates describe a valid, convex quadrilateral. The tasks are clearly defined and objective. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe mapping from the reference coordinates $(\\xi, \\eta)$ to the physical coordinates $(x, y)$ is defined using the four-node bilinear shape functions $N_i(\\xi, \\eta)$:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad \\text{and} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nThe shape functions for the nodes ordered counter-clockwise starting from $(\\xi, \\eta) = (-1, -1)$ are:\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\nThe Jacobian matrix of the transformation $\\partial(x,y)/\\partial(\\xi,\\eta)$ is given by:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nThe components of this matrix are found by differentiating the mapping equations:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i \\quad, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i\n$$\nand similarly for $y$. The derivatives of the shape functions are:\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)\n$$\n$$\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\nLet us organize the calculation of the Jacobian matrix entries. It is convenient to express them as:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ (x_2-x_1)(1-\\eta) + (x_3-x_4)(1+\\eta) \\right]\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ (x_4-x_1)(1-\\xi) + (x_3-x_2)(1+\\xi) \\right]\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ (y_2-y_1)(1-\\eta) + (y_3-y_4)(1+\\eta) \\right]\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ (y_4-y_1)(1-\\xi) + (y_3-y_2)(1+\\xi) \\right]\n$$\nNow, we substitute the given nodal coordinates, with all values in meters:\n$x_1=0$, $x_2=1.5 \\times 10^{-3}$, $x_3=1.6 \\times 10^{-3}$, $x_4=0.1 \\times 10^{-3}$\n$y_1=0$, $y_2=0$, $y_3=1.0 \\times 10^{-3}$, $y_4=1.0 \\times 10^{-3}$\n\nLet's compute the coordinate differences:\n$x_2-x_1 = 1.5 \\times 10^{-3}$\n$x_3-x_4 = 1.6 \\times 10^{-3} - 0.1 \\times 10^{-3} = 1.5 \\times 10^{-3}$\n$x_4-x_1 = 0.1 \\times 10^{-3}$\n$x_3-x_2 = 1.6 \\times 10^{-3} - 1.5 \\times 10^{-3} = 0.1 \\times 10^{-3}$\n\n$y_2-y_1 = 0$\n$y_3-y_4 = 1.0 \\times 10^{-3} - 1.0 \\times 10^{-3} = 0$\n$y_4-y_1 = 1.0 \\times 10^{-3}$\n$y_3-y_2 = 1.0 \\times 10^{-3} - 0 = 1.0 \\times 10^{-3}$\n\nSince $x_2-x_1 = x_3-x_4$ and $x_4-x_1 = x_3-x_2$, the physical element is a parallelogram. This simplifies the partial derivatives, as the terms dependent on $\\xi$ and $\\eta$ will vanish.\n\nSubstituting these differences into the expressions for the partial derivatives:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ (1.5 \\times 10^{-3})(1-\\eta) + (1.5 \\times 10^{-3})(1+\\eta) \\right] = \\frac{1.5 \\times 10^{-3}}{4} (1-\\eta+1+\\eta) = \\frac{3.0 \\times 10^{-3}}{4} = 0.75 \\times 10^{-3}\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ (0.1 \\times 10^{-3})(1-\\xi) + (0.1 \\times 10^{-3})(1+\\xi) \\right] = \\frac{0.1 \\times 10^{-3}}{4} (1-\\xi+1+\\xi) = \\frac{0.2 \\times 10^{-3}}{4} = 0.05 \\times 10^{-3}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ (0)(1-\\eta) + (0)(1+\\eta) \\right] = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ (1.0 \\times 10^{-3})(1-\\xi) + (1.0 \\times 10^{-3})(1+\\xi) \\right] = \\frac{1.0 \\times 10^{-3}}{4} (1-\\xi+1+\\xi) = \\frac{2.0 \\times 10^{-3}}{4} = 0.5 \\times 10^{-3}\n$$\nThe Jacobian matrix is constant over the element:\n$$\n\\mathbf{J} = \\begin{pmatrix} 0.75 \\times 10^{-3} & 0.05 \\times 10^{-3} \\\\ 0 & 0.5 \\times 10^{-3} \\end{pmatrix}\n$$\nThe Jacobian determinant, $J(\\xi, \\eta)$, is therefore also constant:\n$$\nJ = \\det(\\mathbf{J}) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\nJ = (0.75 \\times 10^{-3})(0.5 \\times 10^{-3}) - (0.05 \\times 10^{-3})(0) = 0.375 \\times 10^{-6}\n$$\nThe unit is meters squared (m$^2$). In standard scientific notation, this is $3.75 \\times 10^{-7} \\text{ m}^2$. Rounding to four significant figures as requested, the value is $3.750 \\times 10^{-7} \\text{ m}^2$.\n\nThe Jacobian determinant must remain positive everywhere over the reference domain, i.e., $J(\\xi, \\eta) > 0$ for all $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$. This condition is fundamental for several reasons:\n\n1.  **Geometric Interpretation and Area Transformation:** The Jacobian determinant relates the differential area element $dA_{xy} = dx dy$ in the physical coordinate system to the differential area element $dA_{\\xi\\eta} = d\\xi d\\eta$ in the reference coordinate system via the change of variables theorem: $dA_{xy} = J(\\xi, \\eta) dA_{\\xi\\eta}$. A positive Jacobian indicates that the mapping is orientation-preserving. A counter-clockwise traversal of the boundary of $dA_{\\xi\\eta}$ maps to a counter-clockwise traversal in the physical space. If $J(\\xi, \\eta)  0$, the mapping locally reverses orientation, corresponding to an \"inverted\" or \"tangled\" element where the mapping has folded back on itself. This is a non-physical configuration for a finite volume of material. If $J(\\xi, \\eta) = 0$, the element has degenerated locally to a line or point, possessing zero area.\n\n2.  **Correct Numerical Integration:** In FEM, element-level integrals (e.g., for the stiffness matrix or residual vector) are evaluated over the physical element $\\Omega_e$. These integrals are transformed to the reference square for easier computation, typically using numerical quadrature (e.g., Gaussian quadrature):\n    $$\n    \\int_{\\Omega_e} f(x, y) \\,dx\\,dy = \\int_{-1}^{1} \\int_{-1}^{1} f(x(\\xi,\\eta), y(\\xi,\\eta)) J(\\xi, \\eta) \\,d\\xi\\,d\\eta\n    $$\n    If $J(\\xi, \\eta)$ becomes negative in a portion of the domain, the contribution to the integral from that region will have its sign flipped. This leads to an incorrect assembly of the global system of equations and will produce a meaningless solution. Numerical quadrature schemes require $J(\\xi,\\eta)$ to be positive at all quadrature points.\n\n3.  **Consistent Boundary Conditions:** For Neumann-type boundary conditions, which specify fluxes (e.g., heat flux, species flux) across an element edge, the outward normal vector $\\vec{n}$ to the boundary is essential. The normal vector is computed from the tangent vector along the edge. An inverted element ($J0$) implies that the local ordering of nodes is reversed relative to a consistent counter-clockwise convention. This reversal flips the direction of the computed tangent vector along the boundary, causing the calculated \"outward\" normal to actually point into the element. Consequently, a specified outward flux would be incorrectly applied as an inward source, violating the physical conservation laws the simulation is meant to solve.\n\nIn automated battery design workflows, where the geometry of components like electrodes is parametrically varied to optimize performance, the nodes of the computational mesh are frequently moved. It is a critical validity check to ensure that for any new geometric configuration, the Jacobian determinant remains positive throughout every element in the mesh. Any design that produces a mesh with non-positive Jacobians must be rejected as it is physically and mathematically invalid for simulation.",
            "answer": "$$\\boxed{3.750 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Building upon the concept of the Jacobian for static elements, we now address a more dynamic challenge common in battery simulation: the physical deformation of components like electrodes due to lithium intercalation. This hands-on practice introduces the Arbitrary Lagrangian–Eulerian (ALE) framework, a powerful technique for handling moving and deforming meshes . By deriving and implementing the Jacobian correction for integrals on a changing control volume, you will see how fundamental conservation laws are maintained numerically, a critical step for building robust and physically accurate models of battery aging and performance.",
            "id": "3901448",
            "problem": "Consider a two-dimensional electrode domain in automated battery design and simulation undergoing finite swelling due to intercalation. The spatial mesh is transformed with an Arbitrary Lagrangian–Eulerian (ALE) mapping. Let the reference coordinates be $\\mathbf{X} = (X, Y)$ on a fixed domain $\\Omega_0 = [0,1] \\times [0,1]$, and the current coordinates be $\\mathbf{x} = (x, y)$ on the deformed domain $\\Omega(t) = \\chi(\\Omega_0, t)$. The ALE mapping $\\chi : \\Omega_0 \\to \\Omega(t)$ is smooth, bijective, and orientation-preserving (so its Jacobian determinant is positive). The mass of a scalar field (e.g., dimensionless electrolyte concentration) $\\rho(\\mathbf{x}, t)$ in the moving control volume is defined by the integral\n$$\nM(t) = \\int_{\\Omega(t)} \\rho(\\mathbf{x}, t)\\, d\\mathbf{x}.\n$$\nStarting only from fundamental definitions and the change-of-variables principle for integrals, you must derive the Jacobian correction needed for the control volume integral under the ALE transformation that ensures conservation of mass in the sense that evaluating $M(t)$ in current coordinates yields the same value as evaluating it in reference coordinates.\n\nUsing the derived principle, implement a numerical verification on a deformed mesh. The ALE mapping is prescribed by\n$$\n\\chi(\\mathbf{X}) = \\begin{bmatrix}\nx \\\\ y\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nX + a \\sin(\\pi X)\\sin(\\pi Y) \\\\\nY + b \\sin(\\pi X)\\sin(\\pi Y)\n\\end{bmatrix},\n$$\nwhere $a$ and $b$ are deformation parameters. The deformation gradient is $\\mathbf{F}(\\mathbf{X}) = \\nabla_{\\mathbf{X}} \\chi(\\mathbf{X})$ and the Jacobian determinant is $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$. The scalar field is specified in current coordinates by\n$$\n\\rho(\\mathbf{x}) = e^{-x} + y^2 + x y,\n$$\nwhere $\\rho$ is dimensionless, $x$ and $y$ are dimensionless, and no physical units are required for outputs in this problem.\n\nTasks:\n- Derive from first principles the correction factor $J(\\mathbf{X})$ that must multiply the integrand when evaluating the mass integral over $\\Omega_0$ to be equal to the integral over $\\Omega(t)$.\n- Implement a program that, for each test case, computes two numerical approximations of $M$:\n    $1.$ A direct current-space approximation $M_{\\mathrm{cur}}$ by tessellating the deformed mesh into two triangles per reference cell, using the triangle centroid rule (midpoint quadrature) to approximate the integral $\\int_{\\Omega(t)} \\rho(\\mathbf{x})\\, d\\mathbf{x}$.\n    $2.$ An ALE-corrected reference-space approximation $M_{\\mathrm{ref}}$ by midpoint quadrature at each reference cell center, evaluating $\\rho(\\chi(\\mathbf{X}))\\, J(\\mathbf{X})$ and multiplying by the reference cell area.\n- For each test case, compute the absolute difference\n$$\nE = \\left| M_{\\mathrm{cur}} - M_{\\mathrm{ref}} \\right|,\n$$\nwhich is dimensionless.\n- Use a structured reference grid with $N_x \\times N_y$ cells covering $\\Omega_0$. You must ensure the mapping remains orientation-preserving by choosing $(a,b)$ such that $J(\\mathbf{X})  0$ for all $\\mathbf{X} \\in \\Omega_0$, which is satisfied for the given test suite.\n\nTest suite:\n- Case $1$: $N_x = 80$, $N_y = 80$, $a = 0$, $b = 0$.\n- Case $2$: $N_x = 80$, $N_y = 80$, $a = 0.2$, $b = 0.1$.\n- Case $3$: $N_x = 120$, $N_y = 120$, $a = 0.30$, $b = 0$.\n\nAlgorithmic details:\n- Use the midpoint quadrature for both current-space triangle integrals and reference-space cell integrals.\n- The direct current-space integral $M_{\\mathrm{cur}}$ is computed by mapping the reference grid nodes by $\\chi$ to form a deformed mesh and then summing triangle areas times $\\rho$ evaluated at triangle centroids.\n- The ALE-corrected integral $M_{\\mathrm{ref}}$ is computed at reference cell centers by summing $\\rho(\\chi(\\mathbf{X}_{c}))\\, J(\\mathbf{X}_{c})$ times the reference cell area $\\Delta X \\Delta Y$, where $\\mathbf{X}_{c}$ is the center of a reference cell.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the absolute difference $E$ for the corresponding test case as a floating-point number. No other text should be printed. The outputs are unitless floats.",
            "solution": "The problem requires the derivation of the Jacobian correction for an integral over a moving control volume under an Arbitrary Lagrangian-Eulerian (ALE) transformation, followed by a numerical verification of this principle. The validation of the problem statement precedes any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Reference Domain:** $\\Omega_0 = [0,1] \\times [0,1]$ with coordinates $\\mathbf{X} = (X, Y)$.\n- **Current Domain:** $\\Omega(t) = \\chi(\\Omega_0, t)$ with coordinates $\\mathbf{x} = (x, y)$.\n- **ALE Mapping:** $\\chi(\\mathbf{X}) = \\begin{bmatrix} x \\\\ y \\end{bmatrix} = \\begin{bmatrix} X + a \\sin(\\pi X)\\sin(\\pi Y) \\\\ Y + b \\sin(\\pi X)\\sin(\\pi Y) \\end{bmatrix}$. The map $\\chi$ is smooth, bijective, and orientation-preserving.\n- **Mass Integral:** $M(t) = \\int_{\\Omega(t)} \\rho(\\mathbf{x}, t)\\, d\\mathbf{x}$.\n- **Scalar Field:** $\\rho(\\mathbf{x}) = e^{-x} + y^2 + x y$. For this problem, $\\rho$ is not explicitly dependent on time $t$.\n- **Deformation Gradient:** $\\mathbf{F}(\\mathbf{X}) = \\nabla_{\\mathbf{X}} \\chi(\\mathbf{X})$.\n- **Jacobian Determinant:** $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$.\n- **Tasks:**\n    1. Derive the correction factor $J(\\mathbf{X})$ for evaluating the integral over $\\Omega_0$.\n    2. Compute a direct current-space integral approximation $M_{\\mathrm{cur}}$.\n    3. Compute an ALE-corrected reference-space integral approximation $M_{\\mathrm{ref}}$.\n    4. Calculate the absolute difference $E = \\left| M_{\\mathrm{cur}} - M_{\\mathrm{ref}} \\right|$.\n- **Numerical Method:**\n    - Reference grid: $N_x \\times N_y$ cells.\n    - $M_{\\mathrm{cur}}$: Tessellate each deformed quadrilateral cell into two triangles and use the triangle centroid rule.\n    - $M_{\\mathrm{ref}}$: Use the midpoint rule on each reference cell.\n- **Test Suite:**\n    - Case 1: $N_x = 80$, $N_y = 80$, $a = 0$, $b = 0$.\n    - Case 2: $N_x = 80$, $N_y = 80$, $a = 0.2$, $b = 0.1$.\n    - Case 3: $N_x = 120$, $N_y = 120$, $a = 0.30$, $b = 0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It deals with standard concepts from continuum mechanics and numerical analysis, namely the change of variables theorem for multiple integrals and its application in the ALE framework. The specified functions are smooth and well-defined. The problem is well-posed, providing all necessary definitions, constants, and parameters to perform the required derivation and computations. The tasks are objective and lead to a unique, verifiable numerical result. The premises are not contradictory, factually incorrect, or based on pseudoscience. The problem is a standard exercise in computational methods for partial differential equations on moving domains.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete solution will be provided.\n\n### Principle-Based Solution\n\n#### Derivation of the Jacobian Correction\nThe central task is to relate the integral of a scalar field $\\rho(\\mathbf{x})$ over the deformed domain $\\Omega(t)$ to an integral over the fixed reference domain $\\Omega_0$. The starting point is the definition of the total mass $M$:\n$$\nM = \\int_{\\Omega(t)} \\rho(\\mathbf{x})\\, d\\mathbf{x}\n$$\nWe use the change of variables theorem for multiple integrals. The transformation from reference coordinates $\\mathbf{X}$ to current coordinates $\\mathbf{x}$ is given by the ALE mapping $\\mathbf{x} = \\chi(\\mathbf{X})$. The differential area element in the current domain, $d\\mathbf{x} = dx\\,dy$, is related to the differential area element in the reference domain, $d\\mathbf{X} = dX\\,dY$, by the determinant of the deformation gradient tensor $\\mathbf{F}$.\n$$\nd\\mathbf{x} = |\\det(\\mathbf{F}(\\mathbf{X}))| \\, d\\mathbf{X}\n$$\nThe deformation gradient $\\mathbf{F}$ is the Jacobian matrix of the transformation $\\chi$:\n$$\n\\mathbf{F}(\\mathbf{X}) = \\nabla_{\\mathbf{X}} \\chi(\\mathbf{X}) = \\begin{bmatrix} \\frac{\\partial x}{\\partial X}  \\frac{\\partial x}{\\partial Y} \\\\ \\frac{\\partial y}{\\partial X}  \\frac{\\partial y}{\\partial Y} \\end{bmatrix}\n$$\nThe problem states the transformation is orientation-preserving, which implies that the Jacobian determinant $J(\\mathbf{X}) = \\det(\\mathbf{F}(\\mathbf{X}))$ is strictly positive. Therefore, the absolute value is redundant, and we have $d\\mathbf{x} = J(\\mathbf{X}) \\,d\\mathbf{X}$.\n\nSubstituting the change of variables for the integrand argument $\\rho(\\mathbf{x}) = \\rho(\\chi(\\mathbf{X}))$ and the area element $d\\mathbf{x} = J(\\mathbf{X}) \\,d\\mathbf{X}$ into the mass integral, we transform the integration domain from $\\Omega(t)$ to $\\Omega_0$:\n$$\nM = \\int_{\\Omega_0} \\rho(\\chi(\\mathbf{X})) J(\\mathbf{X}) \\,d\\mathbf{X}\n$$\nThis derivation shows that to ensure conservation—i.e., for the integral evaluated over the reference space to equal the integral over the current space—the integrand must be multiplied by the correction factor $J(\\mathbf{X})$, the Jacobian determinant of the ALE mapping.\n\nFor the given mapping $\\chi$:\n$x(X, Y) = X + a \\sin(\\pi X)\\sin(\\pi Y)$\n$y(X, Y) = Y + b \\sin(\\pi X)\\sin(\\pi Y)$\n\nThe components of the deformation gradient $\\mathbf{F}$ are:\n$\\frac{\\partial x}{\\partial X} = 1 + a \\pi \\cos(\\pi X)\\sin(\\pi Y)$\n$\\frac{\\partial x}{\\partial Y} = a \\pi \\sin(\\pi X)\\cos(\\pi Y)$\n$\\frac{\\partial y}{\\partial X} = b \\pi \\cos(\\pi X)\\sin(\\pi Y)$\n$\\frac{\\partial y}{\\partial Y} = 1 + b \\pi \\sin(\\pi X)\\cos(\\pi Y)$\n\nThe Jacobian determinant $J(\\mathbf{X}) = \\det(\\mathbf{F})$ is:\n$$\nJ(\\mathbf{X}) = \\left(1 + a \\pi \\cos(\\pi X)\\sin(\\pi Y)\\right)\\left(1 + b \\pi \\sin(\\pi X)\\cos(\\pi Y)\\right) - \\left(a \\pi \\sin(\\pi X)\\cos(\\pi Y)\\right)\\left(b \\pi \\cos(\\pi X)\\sin(\\pi Y)\\right)\n$$\nExpanding this expression yields:\n$$\nJ(\\mathbf{X}) = 1 + a \\pi \\cos(\\pi X)\\sin(\\pi Y) + b \\pi \\sin(\\pi X)\\cos(\\pi Y) + ab \\pi^2 \\cos(\\pi X)\\sin(\\pi Y)\\sin(\\pi X)\\cos(\\pi Y) - ab \\pi^2 \\sin(\\pi X)\\cos(\\pi Y)\\cos(\\pi X)\\sin(\\pi Y)\n$$\nThe last two terms cancel, simplifying the Jacobian to:\n$$\nJ(\\mathbf{X}) = 1 + a \\pi \\cos(\\pi X)\\sin(\\pi Y) + b \\pi \\sin(\\pi X)\\cos(\\pi Y)\n$$\n\n### Numerical Algorithm Design\n\nWe will implement two numerical schemes to approximate the mass integral $M$.\n\n1.  **ALE-Corrected Reference-Space Integral ($M_{\\mathrm{ref}}$)**\n    This method directly approximates the transformed integral $M = \\int_{\\Omega_0} \\rho(\\chi(\\mathbf{X})) J(\\mathbf{X}) \\,d\\mathbf{X}$. The reference domain $\\Omega_0 = [0,1] \\times [0,1]$ is discretized into a uniform grid of $N_x \\times N_y$ cells, each with area $\\Delta X \\Delta Y = (1/N_x) \\times (1/N_y)$. We use midpoint quadrature, evaluating the integrand at the center of each cell $\\mathbf{X}_c$.\n    The integral is approximated by the sum:\n    $$\n    M_{\\mathrm{ref}} \\approx \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\rho\\left(\\chi\\left(\\mathbf{X}_{c,ij}\\right)\\right) J\\left(\\mathbf{X}_{c,ij}\\right) \\Delta X \\Delta Y\n    $$\n    where $\\mathbf{X}_{c,ij}$ is the center of the $(i,j)$-th cell.\n\n2.  **Direct Current-Space Integral ($M_{\\mathrm{cur}}$)**\n    This method approximates the original integral $M = \\int_{\\Omega(t)} \\rho(\\mathbf{x})\\, d\\mathbf{x}$ directly on the deformed mesh.\n    First, the $ (N_x+1) \\times (N_y+1)$ grid of nodes in $\\Omega_0$ is mapped via $\\chi$ to obtain the vertices of the deformed cells in $\\Omega(t)$. Each quadrilateral cell in the deformed mesh is then tessellated into two triangles. For a quadrilateral with vertices $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_4$, we can form triangles $(\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3)$ and $(\\mathbf{x}_1, \\mathbf{x}_3, \\mathbf{x}_4)$.\n    For each triangle, we apply the centroid rule. The integral over a single triangle $T$ is approximated as $\\rho(\\mathbf{x}_{\\text{centroid}}) \\times \\text{Area}(T)$.\n    The centroid of a triangle with vertices $\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3$ is $\\mathbf{x}_{\\text{centroid}} = (\\mathbf{v}_1 + \\mathbf{v}_2 + \\mathbf{v}_3)/3$. The area can be computed using the Shoelace formula:\n    $$\n    \\text{Area}(T) = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|\n    $$\n    $M_{\\mathrm{cur}}$ is the sum of these contributions over all triangles in the mesh.\n    $$\n    M_{\\mathrm{cur}} = \\sum_{k \\in \\text{All Triangles}} \\rho(\\mathbf{x}_{\\text{centroid}, k}) \\text{Area}(T_k)\n    $$\nThe absolute difference $E = |M_{\\mathrm{cur}} - M_{\\mathrm{ref}}|$ quantifies the discrepancy between the two numerical schemes. This difference is expected to be non-zero, even for the undeformed case ($a=b=0$), because the two methods use different quadrature points. $M_{\\mathrm{ref}}$ uses one evaluation at the cell center, while $M_{\\mathrm{cur}}$ splits the cell and uses two evaluations at the centroids of the sub-triangles. Both methods should converge to the true integral value as $N_x, N_y \\to \\infty$, and thus their difference $E$ should decrease with mesh refinement. The problem serves as a verification that both numerical approaches, derived from the same conservation principle, yield consistent results within the bounds of their respective numerical errors.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically verifies the Jacobian correction for an ALE transformation.\n    \"\"\"\n    test_cases = [\n        (80, 80, 0.0, 0.0),\n        (80, 80, 0.2, 0.1),\n        (120, 120, 0.3, 0.0),\n    ]\n\n    results = []\n\n    for Nx, Ny, a, b in test_cases:\n        # Define the scalar field rho\n        def rho(x, y):\n            return np.exp(-x) + y**2 + x * y\n\n        # Define the ALE mapping chi\n        def chi(X, Y, a, b):\n            common_term = np.sin(np.pi * X) * np.sin(np.pi * Y)\n            x = X + a * common_term\n            y = Y + b * common_term\n            return x, y\n\n        # Define the analytical Jacobian determinant J\n        def jacobian(X, Y, a, b):\n            term1 = a * np.pi * np.cos(np.pi * X) * np.sin(np.pi * Y)\n            term2 = b * np.pi * np.sin(np.pi * X) * np.cos(np.pi * Y)\n            return 1.0 + term1 + term2\n\n        # --- Calculate M_ref (ALE-corrected reference-space integral) ---\n        dx_ref = 1.0 / Nx\n        dy_ref = 1.0 / Ny\n        cell_area_ref = dx_ref * dy_ref\n\n        # Create grid of cell centers in the reference domain\n        X_centers = np.linspace(dx_ref / 2, 1.0 - dx_ref / 2, Nx)\n        Y_centers = np.linspace(dy_ref / 2, 1.0 - dy_ref / 2, Ny)\n        Xc_grid, Yc_grid = np.meshgrid(X_centers, Y_centers)\n\n        # Map cell centers to the current domain\n        xc_mapped, yc_mapped = chi(Xc_grid, Yc_grid, a, b)\n\n        # Evaluate rho at mapped cell centers\n        rho_vals_ref = rho(xc_mapped, yc_mapped)\n\n        # Evaluate Jacobian at cell centers\n        J_vals = jacobian(Xc_grid, Yc_grid, a, b)\n\n        # Calculate M_ref\n        M_ref = np.sum(rho_vals_ref * J_vals) * cell_area_ref\n\n        # --- Calculate M_cur (Direct current-space integral) ---\n        # Create grid of nodes in the reference domain\n        X_nodes = np.linspace(0.0, 1.0, Nx + 1)\n        Y_nodes = np.linspace(0.0, 1.0, Ny + 1)\n        Xn_grid, Yn_grid = np.meshgrid(X_nodes, Y_nodes)\n\n        # Map nodes to the current domain\n        xn_mapped, yn_mapped = chi(Xn_grid, Yn_grid, a, b)\n\n        # Get the four corner points for each quadrilateral cell\n        p00 = (xn_mapped[:-1, :-1], yn_mapped[:-1, :-1])\n        p10 = (xn_mapped[:-1, 1:], yn_mapped[:-1, 1:])\n        p01 = (xn_mapped[1:, :-1], yn_mapped[1:, :-1])\n        p11 = (xn_mapped[1:, 1:], yn_mapped[1:, 1:])\n        \n        # Tessellate each quad into two triangles and apply centroid rule\n        # Triangle 1: p00, p10, p11\n        centroid_x1 = (p00[0] + p10[0] + p11[0]) / 3.0\n        centroid_y1 = (p00[1] + p10[1] + p11[1]) / 3.0\n        rho_vals1 = rho(centroid_x1, centroid_y1)\n        # Area using Shoelace formula (vectorized)\n        area1 = 0.5 * np.abs(p00[0] * (p10[1] - p11[1]) + \n                              p10[0] * (p11[1] - p00[1]) + \n                              p11[0] * (p00[1] - p10[1]))\n        integral1 = np.sum(rho_vals1 * area1)\n\n        # Triangle 2: p00, p11, p01\n        centroid_x2 = (p00[0] + p11[0] + p01[0]) / 3.0\n        centroid_y2 = (p00[1] + p11[1] + p01[1]) / 3.0\n        rho_vals2 = rho(centroid_x2, centroid_y2)\n        # Area using Shoelace formula (vectorized)\n        area2 = 0.5 * np.abs(p00[0] * (p11[1] - p01[1]) + \n                              p11[0] * (p01[1] - p00[1]) + \n                              p01[0] * (p00[1] - p11[1]))\n        integral2 = np.sum(rho_vals2 * area2)\n\n        M_cur = integral1 + integral2\n        \n        # Calculate the absolute difference\n        E = np.abs(M_cur - M_ref)\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}