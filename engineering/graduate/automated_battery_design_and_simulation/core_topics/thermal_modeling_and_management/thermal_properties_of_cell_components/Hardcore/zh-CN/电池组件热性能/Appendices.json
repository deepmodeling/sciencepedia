{
    "hands_on_practices": [
        {
            "introduction": "任何强大的电池仿真都必须精确地表示其组件的热物性。由于电极是固相活性材料和液相电解质构成的复杂多孔复合材料，我们首先必须学习如何推导出一个单一的“有效”性质，以便在连续介质模型中代表这种体材料。这项基础练习将引导您从热力学第一定律出发，推导有效体积热容，这是均质化多相体系的一项关键技能 。",
            "id": "3955826",
            "problem": "一个多孔电池电极由一个连续的固体基质构成，该基质被液体电解质浸润饱和。设孔隙度为电解质填充的体积分数 $\\varepsilon \\in (0,1)$，固体占据的体积分数为 $1-\\varepsilon$。假设固相和液相各自均匀，具有恒定的密度和等压比热，固相为 $(\\rho_{s}, c_{p,s})$，液相为 $(\\rho_{\\ell}, c_{p,\\ell})$。考虑一个总容积为 $V$ 的微小代表性单元体积（REV），在该体积内局部热平衡成立，因此两相的温度场是单值的，即 $T(\\mathbf{x},t)$。忽略可压缩性和相变，只考虑显热。\n\n从控制体积的热力学第一定律以及根据凝聚相的比焓定义的显能出发，推导有效体积热容 $(\\rho c_{p})_{\\mathrm{eff}}$ 的形式，使得储存在REV中单位体积内的总显能可以写为 $(\\rho c_{p})_{\\mathrm{eff}} T$（相对于一个共同的参考温度）。在你的推导中，明确论证在所述假设下，对于 $(\\rho c_{p})_{\\mathrm{eff}}$，使用关于 $\\varepsilon$ 的算术混合法则还是调和混合法则是合适的。\n\n以包含 $\\varepsilon$、$\\rho_{s}$、$c_{p,s}$、$\\rho_{\\ell}$ 和 $c_{p,\\ell}$ 的单一闭合形式符号表达式给出你的最终结果。不要在最终的方框答案中包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 多孔介质：由液体电解质浸润饱和的连续固体基质。\n- 孔隙度：$\\varepsilon \\in (0,1)$，电解质填充的体积分数。\n- 固体体积分数：$1-\\varepsilon$。\n- 固相性质：均匀，恒定密度 $\\rho_{s}$，恒定等压比热 $c_{p,s}$。\n- 液相性质：均匀，恒定密度 $\\rho_{\\ell}$，恒定等压比热 $c_{p,\\ell}$。\n- 一个总容积为 $V$ 的代表性单元体积（REV）。\n- 假设：局部热平衡成立，使得两相具有单值的温度场 $T(\\mathbf{x},t)$。\n- 假设：忽略可压缩性和相变；只考虑显热。\n- 目标：推导有效体积热容 $(\\rho c_{p})_{\\mathrm{eff}}$ 的形式。\n- 条件：单位体积内储存的总显能为 $(\\rho c_{p})_{\\mathrm{eff}} T$（相对于一个共同的参考温度）。\n- 任务：论证使用算术混合法则与调和混合法则的合理性。\n- 最终结果：用 $\\varepsilon$、$\\rho_{s}$、$c_{p,s}$、$\\rho_{\\ell}$ 和 $c_{p,\\ell}$ 表示的 $(\\rho c_{p})_{\\mathrm{eff}}$ 的闭合形式符号表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，借鉴了热力学的基本原理和成熟的多孔介质输运理论。代表性单元体积（REV）、体积分数、局部热平衡和有效性质等概念是多相系统连续介质模型中的标准概念。该问题是适定的，提供了推导唯一解所需的所有必要信息和假设（$\\varepsilon$、恒定性质、局部热平衡）。语言客观、精确。不存在科学缺陷、矛盾或模糊之处。该问题是传热学中的一个标准推导，既不简单也非不适定。\n\n**步骤3：结论与行动**\n问题有效。将提供完整的推导过程。\n\n**推导**\n\n推导从应用于代表性单元体积（REV）的热力学第一定律开始。储存在总容积为 $V$ 的REV内的总显能 $U_{total}$ 是固相显能 $U_s$ 和液相显能 $U_{\\ell}$ 的总和。\n$$\nU_{total} = U_s + U_{\\ell}\n$$\nREV内固相所占的体积为 $V_s = (1-\\varepsilon)V$，液相所占的体积为 $V_{\\ell} = \\varepsilon V$。\n\n各相的质量可以用其密度和体积表示：\n固相的质量为 $m_s = \\rho_s V_s = \\rho_s (1-\\varepsilon)V$。\n液相的质量为 $m_{\\ell} = \\rho_{\\ell} V_{\\ell} = \\rho_{\\ell} \\varepsilon V$。\n\n对于在指定假设下（恒定压力、可忽略的压缩性）的凝聚相（固相或液相），显能与比焓 $h$ 直接相关。问题将能量定义为相对于一个共同的参考温度 $T_{ref}$。比焓由 $h = \\int_{T_{ref}}^{T} c_p \\,dT'$ 给出。由于比热 $c_{p,s}$ 和 $c_{p,\\ell}$ 是常数，积分结果为 $h = c_p (T-T_{ref})$。问题陈述暗示了 $(\\rho c_p)_{\\mathrm{eff}} T$ 的最终形式，为记法方便，这等同于选择 $T_{ref}=0$。因此，各相的比焓为 $h_s = c_{p,s}T$ 和 $h_{\\ell} = c_{p,\\ell}T$。局部热平衡的关键假设保证了在REV内的任何一点，两相都具有相同的温度 $T$。\n\n各相的显能是其质量和比焓的乘积：\n$$\nU_s = m_s h_s = (\\rho_s (1-\\varepsilon)V)(c_{p,s}T)\n$$\n$$\nU_{\\ell} = m_{\\ell} h_{\\ell} = (\\rho_{\\ell} \\varepsilon V)(c_{p,\\ell}T)\n$$\n因此，REV中的总显能为：\n$$\nU_{total} = \\rho_s (1-\\varepsilon)V c_{p,s}T + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}T\n$$\n问题要求的是有效体积热容 $(\\rho c_{p})_{\\mathrm{eff}}$，它根据单位体积内储存的总显能 $u_{total} = U_{total}/V$ 来定义。\n$$\nu_{total} = \\frac{U_{total}}{V} = \\frac{\\rho_s (1-\\varepsilon)V c_{p,s}T + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}T}{V}\n$$\n总体积 $V$ 被消去：\n$$\nu_{total} = \\rho_s (1-\\varepsilon) c_{p,s}T + \\rho_{\\ell} \\varepsilon c_{p,\\ell}T\n$$\n将温度 $T$ 提出来：\n$$\nu_{total} = \\left[ (1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell} \\right] T\n$$\n通过将此推导表达式与问题中给出的定义关系 $u_{total} = (\\rho c_{p})_{\\mathrm{eff}} T$ 进行比较，我们可以直接确定有效体积热容：\n$$\n(\\rho c_{p})_{\\mathrm{eff}} = (1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell}\n$$\n\n**混合法则的论证**\n\n$(\\rho c_{p})_{\\mathrm{eff}}$ 的推导表达式是各单相体积热容 $(\\rho c_p)_s = \\rho_s c_{p,s}$ 和 $(\\rho c_p)_{\\ell} = \\rho_{\\ell} c_{p,\\ell}$ 的体积加权算术平均值。\n$$\n(\\rho c_{p})_{\\mathrm{eff}} = (1-\\varepsilon)(\\rho c_p)_s + \\varepsilon (\\rho c_p)_{\\ell}\n$$\n这种算术混合法则是合适的，因为热容是一个广延性质。对于一个复合系统，其总热容是其各组分热容的直接加和。设 $C_{total}$ 为REV的总热容。\n$$\nC_{total} = \\frac{dU_{total}}{dT}\n$$\n考虑到 $U_{total}$ 对 $T$ 的线性依赖关系，这变为：\n$$\nC_{total} = \\frac{d}{dT} \\left( (\\rho_s (1-\\varepsilon)V c_{p,s} + \\rho_{\\ell} \\varepsilon V c_{p,\\ell})T \\right) = \\rho_s (1-\\varepsilon)V c_{p,s} + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}\n$$\n这表明总热容 $C_{total}$ 是固体组分热容 $C_s = m_s c_{p,s}$ 和液体组分热容 $C_{\\ell} = m_{\\ell} c_{p,\\ell}$ 的总和。有效体积热容是单位总体积内的总热容，即 $(\\rho c_p)_{\\mathrm{eff}} = C_{total}/V$，这直接得出了推导出的算术平均值。\n\n形式为 $(\\rho c_p)_{\\mathrm{eff}}^{-1} = (1-\\varepsilon)(\\rho c_p)_s^{-1} + \\varepsilon (\\rho c_p)_{\\ell}^{-1}$ 的调和混合法则在这里是不合适的。这种法则通常适用于串联排列组分的输运性质（如热导率或电导率），其中阻力是相加的。储热不是一个输运过程。局部热平衡的假设意味着两相在热学上是并联的，即它们共同响应温度变化，并且它们的储热能力是简单相加的。从能量守恒和能量可加性的第一性原理出发的推导证实了算术混合法则是正确的选择。",
            "answer": "$$\n\\boxed{(1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell}}\n$$"
        },
        {
            "introduction": "一个不包含热量生成来源的热模型是不完整的。在锂离子电池中，不可逆热的主要来源是当电子和离子在各自相中移动时产生的欧姆热。这项实践练习要求您将焦耳热的理论原理转化为计算脚本，根据电芯堆叠内给定的电流分布计算总欧姆热率 。",
            "id": "3955800",
            "problem": "一个平面的锂离子电池堆栈在使用伪二维（P2D）框架下，沿厚度方向进行一维空间建模。考虑三个连续的区域：占据 $x\\in[0,L_n]$ 的多孔负极，占据 $x\\in[L_n,L_n+L_s]$ 的多孔隔膜，以及占据 $x\\in[L_n+L_s,L_n+L_s+L_p]$ 的多孔正极。横截面积为 $A$，施加了一个均匀的面电流密度 $I_{\\mathrm{app}}$（单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$），方向从负极集流体指向正极集流体。伪二维（P2D）解提供了电子导电固相中的局部相电流密度 $i_s(x)$（仅在电极中定义且非零）和离子导电电解质中的局部相电流密度 $i_e(x)$（在所有多孔区域中定义且非零）。一维电荷守恒意味着在两相同时存在的任何地方都有 $i_s(x)+i_e(x)=I_{\\mathrm{app}}$，并且隔膜中不发生法拉第反应。\n\n从能量守恒和电荷守恒以及本构输运定律出发，使用适用于多孔介质的有效输运系数，推导由电子导电固相和离子导电电解质中的欧姆传导引起的相应的局部不可逆体积热源项。然后，利用这些热源，通过在每个区域上积分并对贡献求和，计算总的不可逆欧姆热率，单位为 $\\mathrm{W}$。\n\n数值评估的假设：\n- 负极和正极中的有效电子电导率是常数，分别表示为 $\\sigma_n$ 和 $\\sigma_p$（单位为 $\\mathrm{S}\\,\\mathrm{m}^{-1}$）。负极、隔膜和正极内电解质的有效离子电导率是常数，分别表示为 $\\kappa_n$、$\\kappa_s$ 和 $\\kappa_p$（单位为 $\\mathrm{S}\\,\\mathrm{m}^{-1}$）。\n- 在隔膜中，不存在电子导电相，因此对于 $x\\in[L_n,L_n+L_s]$，$i_s(x)=0$，且在此区域 $i_e(x)=I_{\\mathrm{app}}$。\n- 在电极中，使用以下与伪二维（P2D）模型一致的一维电流分布来表示不同的情况。令 $\\xi_n=x/L_n\\in[0,1]$ 为负极中的归一化坐标，令 $\\xi_p=(x-(L_n+L_s))/L_p\\in[0,1]$ 为正极中的归一化坐标：\n  - 线性分布：在负极中 $i_s(x)=I_{\\mathrm{app}}\\,(1-\\xi_n)$，在正极中 $i_s(x)=I_{\\mathrm{app}}\\,\\xi_p$。在每个电极中，强制执行 $i_e(x)=I_{\\mathrm{app}}-i_s(x)$。\n  - 二次分布：在负极中 $i_s(x)=I_{\\mathrm{app}}\\,(1-\\xi_n^2)$，在正极中 $i_s(x)=I_{\\mathrm{app}}\\,\\xi_p^2$。在每个电极中，强制执行 $i_e(x)=I_{\\mathrm{app}}-i_s(x)$。\n\n你的任务是实现一个程序，对下面的每个测试用例，通过在 $x\\in[0,L_n+L_s+L_p]$ 上积分相应的局部体积热源并乘以 $A$ 来评估总的不可逆欧姆热率。你必须将每个结果以 $\\mathrm{W}$ 为单位表示，并四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1（基准，线性分布）：\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=6.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.0\\times 10^{-5}\\ \\mathrm{m}$, $L_p=7.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=8.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=9.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n- 案例 2（电解质受限，线性分布）：\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=6.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.0\\times 10^{-5}\\ \\mathrm{m}$, $L_p=7.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=1.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=5.0\\times 10^{-2}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=1.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n- 案例 3（高导电性固相，二次分布）：\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=4.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.5\\times 10^{-5}\\ \\mathrm{m}$, $L_p=4.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=1.0\\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=1.0\\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n\n最终输出格式：\n- 你的程序应该生成一行输出，其中按顺序包含案例 1、2 和 3 的结果，形式为方括号内以逗号分隔的列表，例如：“[r1,r2,r3]”。每个条目必须是相应案例的总不可逆欧姆热率，单位为 $\\mathrm{W}$，并四舍五入到 $6$ 位小数。",
            "solution": "该问题要求推导和计算锂离子电池堆栈一维模型中的总不可逆欧姆热率。推导从能量守恒和电传导的基本原理开始。\n\n由欧姆电阻引起的不可逆热生成的局部体积速率 $\\dot{q}_{\\mathrm{Ohm}}$（单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}$）由电场和电流密度的乘积给出。在遵循欧姆定律的材料中，电流密度 $\\vec{J}$ 通过 $\\vec{J} = \\sigma \\vec{E}$（其中 $\\sigma$ 是电导率）与电场 $\\vec{E}$ 相关，体积热源由下式给出：\n$$\n\\dot{q}_{\\mathrm{Ohm}} = \\vec{J} \\cdot \\vec{E} = \\vec{J} \\cdot (\\sigma^{-1} \\vec{J}) = \\frac{|\\vec{J}|^2}{\\sigma}\n$$\n在伪二维（P2D）模型的背景下，多孔电极包含两个导电相：固相基体（电子导体）和填充孔隙的电解质（离子导体）。总欧姆热生成是两相贡献的总和。设 $i_s(x)$ 和 $i_e(x)$ 分别为固相和电解质相中的局部面电流密度（$\\mathrm{A}\\,\\mathrm{m}^{-2}$）。设 $\\sigma_{\\mathrm{eff}}(x)$ 和 $\\kappa_{\\mathrm{eff}}(x)$ 分别为有效电子电导率和有效离子电导率（$\\mathrm{S}\\,\\mathrm{m}^{-1}$）。总的局部体积欧姆热源为：\n$$\n\\dot{q}_{\\mathrm{Ohm}}(x) = \\frac{i_s(x)^2}{\\sigma_{\\mathrm{eff}}(x)} + \\frac{i_e(x)^2}{\\kappa_{\\mathrm{eff}}(x)}\n$$\n总欧姆热率 $Q_{\\mathrm{Ohm}}$（单位 $\\mathrm{W}$）是通过在整个电池体积上对该体积热源进行积分得到的。对于具有均匀横截面积 $A$ 的平面电池，体积元为 $dV = A \\, dx$，总热率为：\n$$\nQ_{\\mathrm{Ohm}} = \\int_{V} \\dot{q}_{\\mathrm{Ohm}} \\, dV = A \\int_{0}^{L_n+L_s+L_p} \\dot{q}_{\\mathrm{Ohm}}(x) \\, dx\n$$\n该积分被划分为三个区域：负极（$n$）、隔膜（$s$）和正极（$p$）。\n$$\nQ_{\\mathrm{Ohm}} = Q_n + Q_s + Q_p\n$$\n其中\n$$\nQ_n = A \\int_{0}^{L_n} \\left( \\frac{i_s(x)^2}{\\sigma_n} + \\frac{i_e(x)^2}{\\kappa_n} \\right) dx\n$$\n$$\nQ_s = A \\int_{L_n}^{L_n+L_s} \\left( \\frac{i_s(x)^2}{\\sigma_s} + \\frac{i_e(x)^2}{\\kappa_s} \\right) dx\n$$\n$$\nQ_p = A \\int_{L_n+L_s}^{L_n+L_s+L_p} \\left( \\frac{i_s(x)^2}{\\sigma_p} + \\frac{i_e(x)^2}{\\kappa_p} \\right) dx\n$$\n根据问题陈述，隔膜不导电，因此对于 $x \\in [L_n, L_n+L_s]$，$i_s(x) = 0$。电荷守恒决定了在该区域内 $i_e(x) = I_{\\mathrm{app}}$。因此，来自隔膜的热贡献为：\n$$\nQ_s = A \\int_{L_n}^{L_n+L_s} \\frac{I_{\\mathrm{app}}^2}{\\kappa_s} dx = A \\frac{I_{\\mathrm{app}}^2 L_s}{\\kappa_s}\n$$\n对于电极，我们分析两种指定的电流分布函数形式。对于这两种情况，我们对负极使用归一化坐标 $\\xi_n = x/L_n$，对正极使用归一化坐标 $\\xi_p = (x-(L_n+L_s))/L_p$。微分分别为 $dx = L_n d\\xi_n$ 和 $dx = L_p d\\xi_p$。\n\n**线性电流分布**\n\n在负极中：$i_s(x) = I_{\\mathrm{app}}(1-\\xi_n)$ 和 $i_e(x) = I_{\\mathrm{app}} - i_s(x) = I_{\\mathrm{app}}\\xi_n$。\n$$\nQ_n^{\\mathrm{lin}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}(1-\\xi_n))^2}{\\sigma_n} + \\frac{(I_{\\mathrm{app}}\\xi_n)^2}{\\kappa_n} \\right) L_n d\\xi_n\n$$\n$$\nQ_n^{\\mathrm{lin}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_n} \\int_{0}^{1}(1-\\xi_n)^2 d\\xi_n + \\frac{1}{\\kappa_n} \\int_{0}^{1}\\xi_n^2 d\\xi_n \\right)\n$$\n定积分为 $\\int_0^1 (1-\\xi_n)^2 d\\xi_n = 1/3$ 和 $\\int_0^1 \\xi_n^2 d\\xi_n = 1/3$。\n$$\nQ_n^{\\mathrm{lin}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{3\\sigma_n} + \\frac{1}{3\\kappa_n} \\right) = \\frac{A L_n I_{\\mathrm{app}}^2}{3} \\left( \\frac{1}{\\sigma_n} + \\frac{1}{\\kappa_n} \\right)\n$$\n在正极中：$i_s(x) = I_{\\mathrm{app}}\\xi_p$ 和 $i_e(x) = I_{\\mathrm{app}}(1-\\xi_p)$。通过对称性，计算是类似的：\n$$\nQ_p^{\\mathrm{lin}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}\\xi_p)^2}{\\sigma_p} + \\frac{(I_{\\mathrm{app}}(1-\\xi_p))^2}{\\kappa_p} \\right) L_p d\\xi_p = \\frac{A L_p I_{\\mathrm{app}}^2}{3} \\left( \\frac{1}{\\sigma_p} + \\frac{1}{\\kappa_p} \\right)\n$$\n线性分布的总欧姆热率为：\n$$\nQ_{\\mathrm{Ohm}}^{\\mathrm{lin}} = A I_{\\mathrm{app}}^2 \\left[ \\frac{L_n}{3} \\left( \\frac{1}{\\sigma_n} + \\frac{1}{\\kappa_n} \\right) + \\frac{L_s}{\\kappa_s} + \\frac{L_p}{3} \\left( \\frac{1}{\\sigma_p} + \\frac{1}{\\kappa_p} \\right) \\right]\n$$\n\n**二次电流分布**\n\n在负极中：$i_s(x) = I_{\\mathrm{app}}(1-\\xi_n^2)$ 和 $i_e(x) = I_{\\mathrm{app}}\\xi_n^2$。\n$$\nQ_n^{\\mathrm{quad}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}(1-\\xi_n^2))^2}{\\sigma_n} + \\frac{(I_{\\mathrm{app}}\\xi_n^2)^2}{\\kappa_n} \\right) L_n d\\xi_n\n$$\n$$\nQ_n^{\\mathrm{quad}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_n} \\int_{0}^{1}(1-\\xi_n^2)^2 d\\xi_n + \\frac{1}{\\kappa_n} \\int_{0}^{1}\\xi_n^4 d\\xi_n \\right)\n$$\n定积分为 $\\int_0^1 (1-\\xi_n^2)^2 d\\xi_n = \\int_0^1 (1-2\\xi_n^2+\\xi_n^4)d\\xi_n = [ \\xi_n - \\frac{2}{3}\\xi_n^3 + \\frac{1}{5}\\xi_n^5 ]_0^1 = 1 - 2/3 + 1/5 = 8/15$，以及 $\\int_0^1 \\xi_n^4 d\\xi_n = [\\xi_n^5/5]_0^1 = 1/5$。\n$$\nQ_n^{\\mathrm{quad}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{8}{15\\sigma_n} + \\frac{1}{5\\kappa_n} \\right)\n$$\n在正极中：$i_s(x) = I_{\\mathrm{app}}\\xi_p^2$ 和 $i_e(x) = I_{\\mathrm{app}}(1-\\xi_p^2)$。通过对称性：\n$$\nQ_p^{\\mathrm{quad}} = A L_p I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_p} \\int_{0}^{1}\\xi_p^4 d\\xi_p + \\frac{1}{\\kappa_p} \\int_{0}^{1}(1-\\xi_p^2)^2 d\\xi_p \\right) = A L_p I_{\\mathrm{app}}^2 \\left( \\frac{1}{5\\sigma_p} + \\frac{8}{15\\kappa_p} \\right)\n$$\n二次分布的总欧姆热率为：\n$$\nQ_{\\mathrm{Ohm}}^{\\mathrm{quad}} = A I_{\\mathrm{app}}^2 \\left[ L_n \\left( \\frac{8}{15\\sigma_n} + \\frac{1}{5\\kappa_n} \\right) + \\frac{L_s}{\\kappa_s} + L_p \\left( \\frac{1}{5\\sigma_p} + \\frac{8}{15\\kappa_p} \\right) \\right]\n$$\n这些推导出的闭合形式表达式允许直接计算每个测试用例的总不可逆欧姆热率。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_ohmic_heat(params, distribution_type):\n    \"\"\"\n    Calculates the total irreversible Ohmic heat rate for a Li-ion cell stack.\n\n    Args:\n        params (dict): A dictionary containing all the cell parameters.\n        distribution_type (str): The type of current distribution ('linear' or 'quadratic').\n\n    Returns:\n        float: The total Ohmic heat rate in Watts.\n    \"\"\"\n    A = params['A']\n    I_app = params['I_app']\n    L_n, L_s, L_p = params['L_n'], params['L_s'], params['L_p']\n    sigma_n, sigma_p = params['sigma_n'], params['sigma_p']\n    kappa_n, kappa_s, kappa_p = params['kappa_n'], params['kappa_s'], params['kappa_p']\n\n    # Common factor A * I_app^2\n    common_factor = A * I_app**2\n\n    # Separator contribution (same for both distributions)\n    q_s = L_s / kappa_s\n\n    # Electrode contributions depend on the distribution type\n    if distribution_type == 'linear':\n        # Negative electrode contribution\n        q_n = (L_n / 3.0) * (1.0 / sigma_n + 1.0 / kappa_n)\n        # Positive electrode contribution\n        q_p = (L_p / 3.0) * (1.0 / sigma_p + 1.0 / kappa_p)\n    elif distribution_type == 'quadratic':\n        # Negative electrode contribution\n        q_n = L_n * (8.0 / (15.0 * sigma_n) + 1.0 / (5.0 * kappa_n))\n        # Positive electrode contribution\n        q_p = L_p * (1.0 / (5.0 * sigma_p) + 8.0 / (15.0 * kappa_p))\n    else:\n        raise ValueError(\"Invalid distribution type specified.\")\n\n    total_heat_rate = common_factor * (q_n + q_s + q_p)\n    \n    return total_heat_rate\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (baseline, linear distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 6.0e-5, 'L_s': 2.0e-5, 'L_p': 7.0e-5,\n                'sigma_n': 5.0e4, 'sigma_p': 5.0e4, 'kappa_n': 8.0e-1, 'kappa_s': 6.0e-1, 'kappa_p': 9.0e-1\n            },\n            'dist_type': 'linear'\n        },\n        # Case 2 (electrolyte-limited, linear distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 6.0e-5, 'L_s': 2.0e-5, 'L_p': 7.0e-5,\n                'sigma_n': 5.0e4, 'sigma_p': 5.0e4, 'kappa_n': 1.0e-1, 'kappa_s': 5.0e-2, 'kappa_p': 1.0e-1\n            },\n            'dist_type': 'linear'\n        },\n        # Case 3 (highly conductive solid, quadratic distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 4.0e-5, 'L_s': 2.5e-5, 'L_p': 4.0e-5,\n                'sigma_n': 1.0e6, 'sigma_p': 1.0e6, 'kappa_n': 6.0e-1, 'kappa_s': 6.0e-1, 'kappa_p': 6.0e-1\n            },\n            'dist_type': 'quadratic'\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_ohmic_heat(case['params'], case['dist_type'])\n        # Round to 6 decimal places as required\n        rounded_result = round(result, 6)\n        results.append(str(rounded_result))\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在定义了有效性质并量化了热源之后，最后一步是求解热传导控制方程。这项综合性练习将指导您使用有限体积法——工程仿真的基石——来构建一个一维热传导求解器。至关重要的是，您将实现层间的接触热阻（Thermal Contact Resistance, TCR），这是一个具有巨大实际重要性的非理想效应，并通过与精确的解析解进行对比来验证您的代码 。",
            "id": "3955778",
            "problem": "您的任务是实现一个一维稳态热传导求解器，用于处理一个层间存在界面热阻的双层复合电池组件。目标是使用虚拟单元或显式界面单元构建一个离散模型，使得界面能产生与传递的热通量成比例的有限温度跳跃，同时保持热通量的连续性。您的实现必须通过与一个解析推导出的双层平板基准解进行对比验证。该问题应在一个模拟电芯组件热学属性的自动化电池设计和仿真工作流程框架内进行构建和求解。\n\n从基本物理原理出发：\n- 一维傅里叶热传导定律：局部热通量密度为 $q^{\\prime\\prime} = -k\\,\\frac{dT}{dx}$，其中 $k$ 是热导率，$T$ 是温度场。\n- 在没有内部热源的情况下，一维稳态能量守恒意味着在每个均匀层内 $\\frac{d}{dx}\\left(k\\,\\frac{dT}{dx}\\right)=0$。\n- 界面热阻（首次提及时称为热接触电阻 (Thermal Contact Resistance, TCR)）会在界面处引起一个与传递的热通量成正比的温度不连续性，而热通量在穿过界面时保持连续。\n\n待实现的模型描述：\n- 考虑一个由两个沿 $x$ 轴串联排列的均匀层组成的平板。左层占据 $x\\in[0,L_1]$，具有恒定的热导率 $k_1$；右层占据 $x\\in[L_1,L_1+L_2]$，具有恒定的热导率 $k_2$。位于 $x=L_1$ 处的界面具有一个界面热阻 $R_\\text{int}$，使得跨界面的温度跳跃与穿过界面的共同热通量成正比。\n- 在两端施加狄利克雷边界条件：$T(0)=T_\\text{left}$ 和 $T(L_1+L_2)=T_\\text{right}$。\n- 假设单位横截面积 $A=1$ m$^2$。\n\n离散化要求：\n- 在单元中心上建立一个有限体积或有限差分离散化，使得每个内表面贡献的热导等于相应面电阻总和的倒数。\n- 对于均匀层内部的面，面电阻是相邻单元的半单元电阻之和。\n- 在材料界面处，面电阻除了两个半单元电阻外，还必须包括界面热阻 $R_\\text{int}$。这确保了离散模型能在界面处捕捉到有限的温度跳跃，同时保持热通量的连续性。\n- 狄利克雷边界条件必须使用半单元边界电阻进行一致性施加。\n\n解析基准要求：\n- 仅使用所列的基本物理原理，推导此配置的封闭形式解析温度场。该温度场在每一层内是分段线性的，并在界面处有一个与界面热通量成正比的温度跳跃。共同热通量和温度分布必须用 $L_1$、$L_2$、$k_1$、$k_2$、$R_\\text{int}$、$T_\\text{left}$ 和 $T_\\text{right}$ 来表示。\n\n验证要求：\n- 实现您的离散化方法，并计算所有单元中心的数值温度。\n- 在相同的单元中心位置计算解析温度。\n- 对于每个测试用例，报告数值温度与解析温度之间的最大绝对差值，以开尔文为单位，并四舍五入到小数点后六位。\n\n测试套件：\n使用以下四个测试用例来验证您的实现。对于每个用例，$L_1$、$L_2$ 的单位是米 (m)，$k_1$、$k_2$ 的单位是瓦特每米开尔文 (W m$^{-1}$ K$^{-1}$)，$R_\\text{int}$ 的单位是平方米开尔文每瓦特 (m$^2$ K W$^{-1}$)，$T_\\text{left}$、$T_\\text{right}$ 的单位是开尔文 (K)。层 $i$ 中的单元数为 $N_i$。\n\n- 用例1（热导率存在差异，中等界面热阻）：\n  - $L_1 = 80\\times 10^{-6}$ m, $L_2 = 16\\times 10^{-6}$ m, $k_1 = 0.3$ W m$^{-1}$ K$^{-1}$, $k_2 = 200$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 1.0\\times 10^{-5}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 320$ K, $T_\\text{right} = 300$ K, $N_1 = 40$, $N_2 = 40$.\n- 用例2（无界面热阻，层相同）：\n  - $L_1 = 0.01$ m, $L_2 = 0.01$ m, $k_1 = 1.0$ W m$^{-1}$ K$^{-1}$, $k_2 = 1.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 0$ m$^2$ K W$^{-1}$, $T_\\text{left} = 400$ K, $T_\\text{right} = 350$ K, $N_1 = 10$, $N_2 = 10$.\n- 用例3（界面热阻占主导）：\n  - $L_1 = 1.0\\times 10^{-3}$ m, $L_2 = 1.0\\times 10^{-3}$ m, $k_1 = 10.0$ W m$^{-1}$ K$^{-1}$, $k_2 = 10.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 1.0\\times 10^{-2}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 310$ K, $T_\\text{right} = 300$ K, $N_1 = 50$, $N_2 = 50$.\n- 用例4（端到端无温差）：\n  - $L_1 = 5.0\\times 10^{-4}$ m, $L_2 = 7.0\\times 10^{-4}$ m, $k_1 = 2.5$ W m$^{-1}$ K$^{-1}$, $k_2 = 5.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 3.0\\times 10^{-5}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 300$ K, $T_\\text{right} = 300$ K, $N_1 = 25$, $N_2 = 25$.\n\n您的程序必须做什么：\n- 对每个测试用例，组装并求解离散系统，以获得数值温度场。\n- 在相同的单元中心位置评估解析温度场。\n- 对于每个用例，计算最大绝对误差（以开尔文为单位），并四舍五入到小数点后六位。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含四个测试用例的最大绝对误差（单位为开尔文），每个误差都四舍五-入到小数点后六位（例如，“[0.000001,0.000002,0.123457,0.000000]”）。",
            "solution": "用户提供的问题是一个适定的、一维稳态热传导问题，研究对象是带有界面热阻的复合平板。该问题具有科学依据、自成体系，并且所有参数都已明确定义。未发现不一致或无效的前提。因此，该问题是有效的，并且可以被求解。\n\n解决方案分三部分展开：首先，推导解析温度分布；其次，构建有限体积数值模型；第三，实现这两种方法，用解析基准来验证数值模型。\n\n### 1. 解析解\n\n该问题由稳态、一维、无内部热源的热传导方程控制。对于热导率 $k$ 恒定的均匀材料，该方程为：\n$$\n\\frac{d}{dx}\\left(-k\\frac{dT}{dx}\\right) = 0\n$$\n这意味着热通量 $q^{\\prime\\prime} = -k\\frac{dT}{dx}$ 在整个平板中是恒定的。对该方程进行两次积分表明，温度分布 $T(x)$ 在每一层内是分段线性的。\n\n我们可以将该系统建模为一系列串联的热阻。对于单位横截面积（$A=1 \\, \\text{m}^2$），总热阻 $R_\\text{total}$ 是两个层的电阻和界面电阻之和：\n$$\nR_\\text{total} = R_1 + R_\\text{int} + R_2\n$$\n其中 $R_1 = L_1/k_1$ 是第一层的电阻，$R_2 = L_2/k_2$ 是第二层的电阻，$R_\\text{int}$ 是界面热阻（单位为 $\\text{m}^2\\cdot\\text{K}/\\text{W}$，对应单位面积的电阻）。\n总电阻为：\n$$\nR_\\text{total} = \\frac{L_1}{k_1} + R_\\text{int} + \\frac{L_2}{k_2}\n$$\n从左边界（$x=0$）流向右边界（$x=L_1+L_2$）的恒定热通量 $q^{\\prime\\prime}$ 由总温差 $\\Delta T = T_\\text{left} - T_\\text{right}$ 驱动，并与总电阻成反比：\n$$\nq^{\\prime\\prime} = \\frac{T_\\text{left} - T_\\text{right}}{R_\\text{total}} = \\frac{T_\\text{left} - T_\\text{right}}{\\frac{L_1}{k_1} + R_\\text{int} + \\frac{L_2}{k_2}}\n$$\n如果 $T_\\text{left} = T_\\text{right}$，则 $q^{\\prime\\prime} = 0$。\n\n知道热通量后，就可以确定温度分布 $T(x)$。\n对于第一层，$x \\in [0, L_1]$：\n温度从 $x=0$ 处的 $T_\\text{left}$ 开始线性下降。\n$$\nT(x) = T_\\text{left} - q^{\\prime\\prime} \\frac{x}{k_1}\n$$\n在界面 $x=L_1$ 处，左侧的温度为 $T(L_1^-) = T_\\text{left} - q^{\\prime\\prime} \\frac{L_1}{k_1}$。\n\n穿过界面时，存在一个与热通量成正比的温降，$\\Delta T_\\text{int} = q^{\\prime\\prime} R_\\text{int}$。界面右侧的温度 $T(L_1^+)$ 为：\n$$\nT(L_1^+) = T(L_1^-) - q^{\\prime\\prime} R_\\text{int} = T_\\text{left} - q^{\\prime\\prime} \\left( \\frac{L_1}{k_1} + R_\\text{int} \\right)\n$$\n对于第二层，$x \\in (L_1, L_1+L_2]$：\n温度从 $T(L_1^+)$ 开始线性下降。在 $x$ 点的温度为：\n$$\nT(x) = T(L_1^+) - q^{\\prime\\prime} \\frac{x-L_1}{k_2} = T_\\text{left} - q^{\\prime\\prime} \\left( \\frac{L_1}{k_1} + R_\\text{int} + \\frac{x-L_1}{k_2} \\right)\n$$\n至此，解析解推导完毕。\n\n### 2. 数值模型（有限体积法）\n\n将区域离散为 $N = N_1 + N_2$ 个控制体积（单元）。第1层包含 $N_1$ 个宽度为 $\\Delta x_1 = L_1/N_1$ 的单元，第2层包含 $N_2$ 个宽度为 $\\Delta x_2 = L_2/N_2$ 的单元。设 $T_i$ 为单元 $i$ 中心的温度。\n\n每个单元 $i$ 的稳态能量平衡表明，流入该单元的热通量之和为零。\n$$\n\\sum_j q_{j \\to i} = 0\n$$\n其中 $q_{j \\to i}$ 是从相邻单元 $j$（或边界）到单元 $i$ 的热流率。假设单位面积，这等同于平衡热通量 $q^{\\prime\\prime}$。两个单元中心 $i$ 和 $i+1$ 之间的通量为 $q^{\\prime\\prime}_{i+1/2} = C_{i+1/2}(T_i - T_{i+1})$，其中 $C_{i+1/2}$ 是单元中心之间的热导。\n\n热导是单元中心之间总热阻的倒数。\n- **在均匀层内部**（例如，在第1层中单元 $i$ 和 $i+1$ 之间）：热阻是两个半单元电阻之和。\n$$\nR_{i, i+1} = \\frac{\\Delta x_1/2}{k_1} + \\frac{\\Delta x_1/2}{k_1} = \\frac{\\Delta x_1}{k_1} \\quad \\implies \\quad C_{i, i+1} = \\frac{k_1}{\\Delta x_1}\n$$\n- **在材料界面处**（在单元 $N_1$ 和 $N_1+1$ 之间）：热阻包括两个半单元电阻和界面热阻。\n$$\nR_{N_1, N_1+1} = \\frac{\\Delta x_1/2}{k_1} + R_\\text{int} + \\frac{\\Delta x_2/2}{k_2} \\quad \\implies \\quad C_{N_1, N_1+1} = \\frac{1}{\\frac{\\Delta x_1}{2k_1} + R_\\text{int} + \\frac{\\Delta x_2}{2k_2}}\n$$\n- **在边界处**：边界与第一个/最后一个单元中心之间的热阻是一个半单元电阻。\n  - 左边界：$R_{L,1} = \\frac{\\Delta x_1/2}{k_1} \\implies C_{L,1} = \\frac{k_1}{\\Delta x_1/2} = \\frac{2k_1}{\\Delta x_1}$\n  - 右边界：$R_{N,R} = \\frac{\\Delta x_2/2}{k_2} \\implies C_{N,R} = \\frac{k_2}{\\Delta x_2/2} = \\frac{2k_2}{\\Delta x_2}$\n\n对每个单元应用能量平衡，可生成关于未知单元温度 $\\vec{T} = [T_1, T_2, \\dots, T_N]^T$ 的线性方程组 $A\\vec{T} = \\vec{b}$。该系统是三对角的。\n\n- **单元1（左边界）：** $C_{L,1}(T_\\text{left} - T_1) + C_{1,2}(T_2 - T_1) = 0$\n  $$ -(C_{L,1} + C_{1,2})T_1 + C_{1,2}T_2 = -C_{L,1}T_\\text{left} $$\n- **第1层内部单元 $i$ ($1  i  N_1$)：** $C_{i-1,i}(T_{i-1} - T_i) + C_{i,i+1}(T_{i+1} - T_i) = 0$\n  $$ C_{i-1,i}T_{i-1} - (C_{i-1,i} + C_{i,i+1})T_i + C_{i,i+1}T_{i+1} = 0 $$\n- **单元 $N_1$（界面）：** $C_{N_1-1,N_1}(T_{N_1-1} - T_{N_1}) + C_{N_1,N_1+1}(T_{N_1+1} - T_{N_1}) = 0$\n  $$ C_{N_1-1,N_1}T_{N_1-1} - (C_{N_1-1,N_1} + C_{N_1,N_1+1})T_{N_1} + C_{N_1,N_1+1}T_{N_1+1} = 0 $$\n- **单元 $N_1+1$（界面）：** $C_{N_1,N_1+1}(T_{N_1} - T_{N_1+1}) + C_{N_1+1,N_1+2}(T_{N_1+2} - T_{N_1+1}) = 0$\n  $$ C_{N_1,N_1+1}T_{N_1} - (C_{N_1,N_1+1} + C_{N_1+1,N_1+2})T_{N_1+1} + C_{N_1+1,N_1+2}T_{N_1+2} = 0 $$\n- **第2层内部单元 $i$ ($N_1+1  i  N$)：** 类似于第1层内部单元，使用相应的热导。\n- **单元 $N$（右边界）：** $C_{N-1,N}(T_{N-1} - T_N) + C_{N,R}(T_\\text{right} - T_N) = 0$\n  $$ C_{N-1,N}T_{N-1} - (C_{N-1,N} + C_{N,R})T_N = -C_{N,R}T_\\text{right} $$\n\n组装并求解这个三对角系统，即可得到 $\\vec{T}$。\n\n### 3. 验证\n\n将单元中心的数值解温度 $T_i$ 与在相同单元中心坐标 $x_i$ 处计算的解析解进行比较。计算每个测试用例的最大绝对差 $\\max_i |T_{i, \\text{numerical}} - T_{i, \\text{analytical}}|$，作为验证指标。实现证实，对于给定的测试用例，有限体积模型能准确地再现解析解，误差接近机器精度。这验证了界面条件的离散化是正确的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state heat conduction problem for a two-layer slab\n    with interfacial resistance for a given set of test cases.\n    It calculates both numerical and analytical solutions and finds the\n    maximum absolute error between them.\n    \"\"\"\n    test_cases = [\n        # Case 1: Contrast in conductivities\n        {\n            \"L1\": 80e-6, \"L2\": 16e-6, \"k1\": 0.3, \"k2\": 200,\n            \"R_int\": 1.0e-5, \"T_left\": 320, \"T_right\": 300,\n            \"N1\": 40, \"N2\": 40\n        },\n        # Case 2: No interfacial resistance, identical layers\n        {\n            \"L1\": 0.01, \"L2\": 0.01, \"k1\": 1.0, \"k2\": 1.0,\n            \"R_int\": 0, \"T_left\": 400, \"T_right\": 350,\n            \"N1\": 10, \"N2\": 10\n        },\n        # Case 3: Dominant interfacial resistance\n        {\n            \"L1\": 1.0e-3, \"L2\": 1.0e-3, \"k1\": 10.0, \"k2\": 10.0,\n            \"R_int\": 1.0e-2, \"T_left\": 310, \"T_right\": 300,\n            \"N1\": 50, \"N2\": 50\n        },\n        # Case 4: Zero end-to-end temperature difference\n        {\n            \"L1\": 5.0e-4, \"L2\": 7.0e-4, \"k1\": 2.5, \"k2\": 5.0,\n            \"R_int\": 3.0e-5, \"T_left\": 300, \"T_right\": 300,\n            \"N1\": 25, \"N2\": 25\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        max_error = solve_one_case(**params)\n        results.append(f\"{max_error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_one_case(L1, L2, k1, k2, R_int, T_left, T_right, N1, N2):\n    \"\"\"\n    Solves a single case of the heat conduction problem.\n\n    Returns:\n        float: The maximum absolute error between numerical and analytical solutions.\n    \"\"\"\n    N = N1 + N2\n    dx1 = L1 / N1\n    dx2 = L2 / N2\n\n    # --- Analytical Solution ---\n    R1 = L1 / k1 if k1 > 0 else float('inf')\n    R2 = L2 / k2 if k2 > 0 else float('inf')\n    R_total = R1 + R_int + R2\n\n    if abs(R_total)  1e-15: # Avoid division by zero if all resistances are zero\n        q_flux = 0.0\n    else:\n        q_flux = (T_left - T_right) / R_total\n\n    x_centers = np.concatenate([\n        np.linspace(dx1 / 2, L1 - dx1 / 2, N1),\n        np.linspace(L1 + dx2 / 2, L1 + L2 - dx2 / 2, N2)\n    ])\n\n    T_analytical = np.zeros(N)\n    for i, x in enumerate(x_centers):\n        if x = L1:\n            T_analytical[i] = T_left - q_flux * (x / k1)\n        else:\n            T_analytical[i] = T_left - q_flux * (R1 + R_int + (x - L1) / k2)\n\n    # --- Numerical Solution (Finite Volume Method) ---\n    # The system is A*T = b, where A is tridiagonal. We build the three diagonals.\n    # We use scipy.linalg.solve_banded which takes a matrix `ab` where\n    # ab[0,:] is the upper diagonal, ab[1,:] is the main, ab[2,:] is the lower.\n    ab = np.zeros((3, N))\n    b = np.zeros(N)\n\n    # Conductance definitions\n    C_layer1 = k1 / dx1\n    C_layer2 = k2 / dx2\n    C_interface = 1 / (dx1 / (2 * k1) + R_int + dx2 / (2 * k2))\n    C_left_bnd = 2 * k1 / dx1\n    C_right_bnd = 2 * k2 / dx2\n\n    # Assemble the matrix diagonals and the rhs vector b\n    # Loop over cell indices (0-based)\n    for i in range(N):\n        if i == 0:  # Left boundary cell\n            C_W = C_left_bnd\n            C_E = C_layer1\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n            b[i] = -C_W * T_left\n        elif i  N1 - 1:  # Interior cell in layer 1\n            C_W = C_layer1\n            C_E = C_layer1\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N1 - 1:  # Cell before interface\n            C_W = C_layer1\n            C_E = C_interface\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N1:  # Cell after interface\n            C_W = C_interface\n            C_E = C_layer2\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i  N - 1: # Interior cell in layer 2\n            C_W = C_layer2\n            C_E = C_layer2\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N - 1: # Right boundary cell\n            C_W = C_layer2\n            C_E = C_right_bnd\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            b[i] = -C_E * T_right\n\n    # Solve the tridiagonal system\n    T_numerical = solve_banded((1, 1), ab, b)\n    \n    # --- Verification ---\n    max_error = np.max(np.abs(T_numerical - T_analytical))\n    return max_error\n    \n# Execute the solver\nsolve()\n```"
        }
    ]
}