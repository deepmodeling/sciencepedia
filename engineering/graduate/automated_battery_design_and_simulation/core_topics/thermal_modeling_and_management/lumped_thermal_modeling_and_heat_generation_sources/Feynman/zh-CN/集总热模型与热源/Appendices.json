{
    "hands_on_practices": [
        {
            "introduction": "在应用任何模型之前，理解其局限性是至关重要的。第一个实践将挑战你评估集总热模型的核心假设：内部温度均匀。通过推导和计算毕渥数（Biot number），你将掌握一个量化工具来判断这种简化何时是合理的，这是任何严谨工程分析中的关键第一步 。",
            "id": "3925693",
            "problem": "在一个自动化的设计与仿真工作流程中，需要使用单一热节点（集总热容模型）对一个棱柱形锂离子电池单元进行建模，该模型假设内部温度均匀。该电池单元是均匀且各向同性的，其热导率为 $k$，密度为 $\\rho$，比热容为 $c$。在运行过程中，由电化学损耗会产生均匀的体积生热 $\\dot{q}^{\\prime\\prime\\prime}$。该电池单元通过其外表面积 $A$ 与温度为 $T_{\\infty}$ 的环境进行对流换热，传热系数为 $h$。设电池单元体积为 $V$，并将特征长度定义为 $L_{c}=V/A$。\n\n从固体中的瞬态能量守恒和对流边界条件出发，并且不预先假设空间均匀性，使用量级分析来确定一个无量纲群，该无量纲群量化了表面对流效应与内部传导平滑温度梯度能力之比。在固体内部传导中，使用 $L_{c}$作为特征几何长度尺度。然后，根据以下物理上一致的参数，对此无量纲群进行数值计算：$k=1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$h=25\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，以及 $L_{c}=V/A=8\\,\\mathrm{mm}$。在您的推理中，说明在这些条件下，单一节点的集总热容模型是否适用，并解释原因。\n\n将最终答案表示为该无量纲群的数值，并四舍五入至$3$位有效数字。报告一个无量纲数（无单位）。",
            "solution": "该问题要求识别并评估一个无量纲群，用以确定集总热容模型对棱柱形电池单元的有效性。该模型假设内部温度均匀，而这一近似仅在内部导热热阻远小于外部对流换热热阻时才有效。\n\n我们从瞬态能量守恒方程（也称为热扩散方程）在有内部生热的固体中的一般形式开始：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + \\dot{q}^{\\prime\\prime\\prime}\n$$\n其中 $\\rho$ 是密度，$c$ 是比热容，$T$ 是温度，$t$ 是时间，$k$ 是热导率，$\\dot{q}^{\\prime\\prime\\prime}$ 是体积生热率。\n\n在面积为 $A$ 的电池单元外表面，其边界条件是Newton冷却定律：\n$$\n-k \\frac{\\partial T}{\\partial n} \\bigg|_{s} = h (T_s - T_{\\infty})\n$$\n其中 $\\frac{\\partial T}{\\partial n}|_{s}$ 是垂直于表面的温度梯度，$T_s$ 是表面温度，$T_{\\infty}$ 是环境温度，$h$ 是对流传热系数。\n\n如果固体内部的温度在任何时刻都空间均匀，即 $T(x,y,z,t) \\approx T(t)$，那么集总热容模型是适用的。这意味着固体内部的温差与固体表面和周围流体之间的温差相比可以忽略不计。\n\n为了将此条件形式化，我们进行量级分析。设 $\\Delta T_{internal}$ 为固体内部的特征温差，例如其中心与表面之间的温差。根据Fourier定律，与该内部温度梯度在特征长度 $L_c$ 上相关的热通量可近似为：\n$$\nq''_{conduction} \\sim k \\frac{\\Delta T_{internal}}{L_c}\n$$\n问题指定特征长度为 $L_c = V/A$，其中 $V$ 是电池单元的体积，$A$ 是其表面积。\n\n设 $\\Delta T_{external}$ 为表面与环境流体之间的温差，因此 $\\Delta T_{external} = T_s - T_{\\infty}$。通过对流离开表面的热通量为：\n$$\nq''_{convection} = h (T_s - T_{\\infty}) = h \\Delta T_{external}\n$$\n为了使热量从内部传递到环境中，传导的热量最终必须在表面通过对流散发掉。因此，在空间温度分布的准稳态条件下，这些通量的大小处于同一数量级：\n$$\nq''_{conduction} \\sim q''_{convection}\n$$\n$$\nk \\frac{\\Delta T_{internal}}{L_c} \\sim h \\Delta T_{external}\n$$\n重排此关系式可得到内部温差与外部温差之比：\n$$\n\\frac{\\Delta T_{internal}}{\\Delta T_{external}} \\sim \\frac{h L_c}{k}\n$$\n这个无量纲群被称为Biot数，记为 $Bi$。\n$$\nBi = \\frac{h L_c}{k}\n$$\nBiot数具有明确的物理意义。它代表内部导热热阻与外部对流换热热阻之比：\n$$\nBi = \\frac{L_c/k}{1/h} = \\frac{R_{conduction}}{R_{convection}}\n$$\n其中热阻是基于单位面积的。因此，该无量纲群量化了表面对流效应与内部传导能力之比。\n\n空间温度均匀的假设是集总电容模型的基础，该假设仅在内部温差远小于外部温差时有效，即 $\\Delta T_{internal} \\ll \\Delta T_{external}$。这对应于一个很小的Biot数。一个广泛接受的工程准则是，当 $Bi < 0.1$ 时，集总电容模型是适用的。对于 $Bi < 0.1$，假设温度均匀所带来的误差通常小于 $5\\%$。\n\n现在，我们根据给定的参数计算Biot数：\n- 传热系数, $h = 25\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n- 热导率, $k = 1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- 特征长度, $L_c = 8\\,\\mathrm{mm} = 8 \\times 10^{-3}\\,\\mathrm{m}$\n\n将这些值代入Biot数的表达式中：\n$$\nBi = \\frac{h L_c}{k} = \\frac{(25\\,\\mathrm{W\\,m^{-2}\\,K^{-1}})(8 \\times 10^{-3}\\,\\mathrm{m})}{1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}}\n$$\n单位被消去，证实了Biot数是无量纲的：\n$$\n\\frac{(\\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{K}^{-1})(\\mathrm{m})}{(\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1})} = \\frac{\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}}{\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}} = 1\n$$\n数值计算如下：\n$$\nBi = \\frac{25 \\times 8 \\times 10^{-3}}{1.5} = \\frac{200 \\times 10^{-3}}{1.5} = \\frac{0.2}{1.5} = \\frac{2}{15} \\approx 0.1333...\n$$\n四舍五入到$3$位有效数字，我们得到 $Bi = 0.133$。\n\n根据这个结果，我们必须评估单一节点集总热容模型的适用性。计算出的Biot数 $Bi \\approx 0.133$，大于常规阈值 $0.1$。这表明内部导热热阻与外部对流换热热阻相比是不可忽略的。具体来说，电池内部的温差约占电池表面与环境温差的 $13.3\\%$。因此，对于这些条件，单一节点的集总热容模型并非严格适用，因为内部温度均匀的假设理由不充分。一个更精确的模型将需要多个节点或对热扩散方程进行完整求解，以考虑电池内部的空间温度梯度。",
            "answer": "$$\n\\boxed{0.133}\n$$"
        },
        {
            "introduction": "一旦确定集总模型是适用的，下一步便是分析系统的动态行为。本练习将指导你求解电池温度对突加热负载响应的控制微分方程。你将推导出热时间常数——一个决定系统达到热平衡速度的关键参数，并预测完整的温度随时间变化的轨迹 。",
            "id": "3925723",
            "problem": "一个圆柱形锂离子电池被表示为一个集总热节点，其总热容为 $C$，并通过一条与环境的对流散热路径进行散热，该路径的特征由乘积 $hA$ 描述，其中 $h$ 是对流传热系数，$A$ 是暴露的表面积。环境温度是均匀且恒定的，为 $T_{\\infty}$。在时间 $t=0$ 时，电池从开路状态转为恒流放电，这会产生一个均匀的体积产热率，积分后得到净产热功率 $Q_{\\mathrm{gen}}$，此后该功率保持不变。假设内部温度场在空间上是均匀的，因此集总模型是合理的。\n\n从集总控制体的热力学第一定律出发，并将与环境的对流视为唯一的外部散热机制，推导电池温度 $T(t)$ 的控制常微分方程，并在初始条件 $T(0)=T_{\\infty}$ 下求解 $t \\ge 0$ 时的解。使用以下参数：$C=150\\,\\mathrm{J\\,K^{-1}}$，$hA=12\\,\\mathrm{W\\,K^{-1}}$，$Q_{\\mathrm{gen}}=18\\,\\mathrm{W}$ 和 $T_{\\infty}=298\\,\\mathrm{K}$。计算热时间常数 $\\tau$，并针对 $Q_{\\mathrm{gen}}$ 的阶跃输入，预测显式的解析温度轨迹 $T(t)$。\n\n时间常数以秒为单位，温度轨迹以开尔文为单位表示。将最终答案以包含 $\\tau$ 和 $T(t)$ 的单行矩阵形式提供，并保留 $T(t)$ 为 $t$ 的函数。无需四舍五入；请给出精确值。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 总热容：$C=150\\,\\mathrm{J\\,K^{-1}}$\n- 对流散热乘积：$hA=12\\,\\mathrm{W\\,K^{-1}}$\n- 净产热功率：$Q_{\\mathrm{gen}}=18\\,\\mathrm{W}$ (对于 $t \\ge 0$)\n- 环境温度：$T_{\\infty}=298\\,\\mathrm{K}$\n- 初始条件：$T(0)=T_{\\infty}$\n- 模型：具有单条对流散热路径的集总热节点。\n- 控制原理：集总控制体的热力学第一定律。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **有科学依据：** 该问题基于热力学第一定律和牛顿冷却定律，这些是传热学和热力学的基本原理。当物体内部的空间温度梯度可忽略不计时（即毕渥数较低时），集总热容模型是一种标准且有效的工程近似方法，而题目明确假设此条件已满足。\n- **适定性：** 该问题描述了一个具有常系数和指定初始条件的一阶线性常微分方程。这构成了一个适定的初值问题，保证了唯一且稳定解的存在。\n- **客观性：** 该问题使用精确、无歧义的科学语言和定量数据进行陈述。没有主观或基于观点的陈述。\n- **完整性与一致性：** 求解温度轨迹 $T(t)$ 所需的所有必要参数（$C$、$hA$、$Q_{\\mathrm{gen}}$、$T_{\\infty}$）和初始条件（$T(0)$）均已提供。数据在量纲上是一致的。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它有科学依据、适定、客观且自洽。将推导出一个完整的解。\n\n### 求解推导\n\n分析始于将热力学第一定律应用于代表电池单元的集总控制体。能量平衡方程为：\n$$\n\\frac{dE}{dt} = \\dot{E}_{\\text{in}} - \\dot{E}_{\\text{out}} + \\dot{E}_{\\text{gen}}\n$$\n其中 $\\frac{dE}{dt}$ 是系统内能的变化率，$\\dot{E}_{\\text{in}}$ 是能量传入系统的速率，$\\dot{E}_{\\text{out}}$ 是能量传出系统的速率，$\\dot{E}_{\\text{gen}}$ 是系统内部能量生成的速率。\n\n对于本问题：\n1.  内能的变化率通过热容 $C$ 与温度变化相关联：$\\frac{dE}{dt} = C\\frac{dT}{dt}$。\n2.  没有能量传入系统，因此 $\\dot{E}_{\\text{in}}=0$。\n3.  能量传出系统仅通过与周围环境的对流发生。此热损失由牛顿冷却定律描述：$\\dot{E}_{\\text{out}} = hA(T(t) - T_{\\infty})$。\n4.  内部产热率以恒定功率 $Q_{\\mathrm{gen}}$ 给出，因此 $\\dot{E}_{\\text{gen}} = Q_{\\mathrm{gen}}$。\n\n将这些项代入能量平衡方程，得到电池温度 $T(t)$ 的控制常微分方程 (ODE)：\n$$\nC\\frac{dT}{dt} = 0 - hA(T(t) - T_{\\infty}) + Q_{\\mathrm{gen}}\n$$\n整理各项，我们得到：\n$$\nC\\frac{dT}{dt} + hA \\cdot T(t) = hA \\cdot T_{\\infty} + Q_{\\mathrm{gen}}\n$$\n这是一个一阶线性非齐次常微分方程。为了确定热时间常数，我们可以两边同除以 $hA$，将方程化为标准形式：\n$$\n\\frac{C}{hA}\\frac{dT}{dt} + T(t) = T_{\\infty} + \\frac{Q_{\\mathrm{gen}}}{hA}\n$$\n该方程的形式为 $\\tau \\frac{dy}{dt} + y = K$，其中微分项的系数是系统的时间常数 $\\tau$。因此，热时间常数为：\n$$\n\\tau = \\frac{C}{hA}\n$$\n代入给定值：\n$$\n\\tau = \\frac{150\\,\\mathrm{J\\,K^{-1}}}{12\\,\\mathrm{W\\,K^{-1}}} = 12.5\\,\\mathrm{s}\n$$\n单位是正确的，因为 $\\mathrm{J}/\\mathrm{W} = \\mathrm{J}/(\\mathrm{J/s}) = \\mathrm{s}$。\n\n为求解该常微分方程，我们定义一个新变量表示温差，$\\theta(t) = T(t) - T_{\\infty}$。其导数为 $\\frac{d\\theta}{dt} = \\frac{dT}{dt}$。将此代入常微分方程的第一个形式：\n$$\nC\\frac{d\\theta}{dt} = -hA \\cdot \\theta(t) + Q_{\\mathrm{gen}}\n$$\n整理得：\n$$\nC\\frac{d\\theta}{dt} + hA \\cdot \\theta(t) = Q_{\\mathrm{gen}}\n$$\n该常微分方程的解是齐次解 ($\\theta_h$) 和特解 ($\\theta_p$) 的和。齐次方程为 $C\\frac{d\\theta_h}{dt} + hA \\cdot \\theta_h = 0$，其解为 $\\theta_h(t) = K_1 \\exp\\left(-\\frac{hA}{C}t\\right) = K_1 \\exp\\left(-\\frac{t}{\\tau}\\right)$，其中 $K_1$ 是一个常数。对于常数强迫项 $Q_{\\mathrm{gen}}$，我们假设一个常数特解 $\\theta_p = K_2$。代入方程得 $C(0) + hA \\cdot K_2 = Q_{\\mathrm{gen}}$，所以 $K_2 = \\frac{Q_{\\mathrm{gen}}}{hA}$。\n\n$\\theta(t)$ 的通解为：\n$$\n\\theta(t) = \\theta_h(t) + \\theta_p(t) = K_1 \\exp\\left(-\\frac{t}{\\tau}\\right) + \\frac{Q_{\\mathrm{gen}}}{hA}\n$$\n代回 $T(t) = \\theta(t) + T_{\\infty}$：\n$$\nT(t) = T_{\\infty} + \\frac{Q_{\\mathrm{gen}}}{hA} + K_1 \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n我们使用初始条件 $T(0) = T_{\\infty}$ 来求解常数 $K_1$。在 $t=0$ 时：\n$$\nT(0) = T_{\\infty} = T_{\\infty} + \\frac{Q_{\\mathrm{gen}}}{hA} + K_1 \\exp(0)\n$$\n$$\n0 = \\frac{Q_{\\mathrm{gen}}}{hA} + K_1 \\implies K_1 = -\\frac{Q_{\\mathrm{gen}}}{hA}\n$$\n将 $K_1$ 代回 $T(t)$ 的通解：\n$$\nT(t) = T_{\\infty} + \\frac{Q_{\\mathrm{gen}}}{hA} - \\frac{Q_{\\mathrm{gen}}}{hA} \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n这可以进行因式分解，得到温度轨迹的最终解析表达式：\n$$\nT(t) = T_{\\infty} + \\frac{Q_{\\mathrm{gen}}}{hA} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)\n$$\n现在，我们将给定的数值代入此表达式：\n- $T_{\\infty} = 298\\,\\mathrm{K}$\n- $\\frac{Q_{\\mathrm{gen}}}{hA} = \\frac{18\\,\\mathrm{W}}{12\\,\\mathrm{W\\,K^{-1}}} = 1.5\\,\\mathrm{K}$\n- $\\tau = 12.5\\,\\mathrm{s}$\n\n显式温度轨迹为：\n$$\nT(t) = 298 + 1.5 \\left(1 - \\exp\\left(-\\frac{t}{12.5}\\right)\\right)\n$$\n\n要求解的两个量是热时间常数 $\\tau$ 和温度轨迹 $T(t)$。\n$\\tau = 12.5\\,\\mathrm{s}$\n$T(t) = 298 + 1.5(1 - \\exp(-t/12.5))\\,\\mathrm{K}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 12.5 & 298 + 1.5(1 - \\exp(-t/12.5)) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的电池系统包含复杂的、依赖于温度的特性，这使得解析解变得不切实际。最后一个实践旨在连接简化理论与计算模拟之间的鸿沟，要求你为一个非线性热模型实现一个数值求解器。通过应用后向欧拉法和牛顿-拉夫逊迭代，你将处理热生成和热对流随温度变化的实际情景，这是自动化电池设计与分析的一项核心技能 。",
            "id": "3925686",
            "problem": "考虑一个单体电池的集总热容模型，其中热状态由一个标量温度 $T(t)$ 描述，该模型遵循控制质量的热力学第一定律所蕴含的能量平衡。其控制常微分方程为\n$$\nC_{\\mathrm{th}} \\,\\frac{dT}{dt} \\;=\\; Q_{\\mathrm{gen}}(T) \\;-\\; hA(T)\\,\\big(T - T_{\\infty}\\big),\n$$\n其中 $C_{\\mathrm{th}}$ 是集总热容，$Q_{\\mathrm{gen}}(T)$ 是内部生热率，$hA(T)$ 是与环境进行对流的有效传热系数乘以面积，$T_{\\infty}$ 是环境温度。所有量都通过其对 $T(t)$ 和系统参数的依赖性而是时间的函数。你将使用大小为 $\\Delta t$ 的时间步长，通过后向欧拉法从时间 $t^n$ 的 $T^n$推进到时间 $t^{n+1} = t^n + \\Delta t$ 的 $T^{n+1}$。后向欧拉法在 $T^{n+1}$ 处计算右侧项，从而得到关于 $T^{n+1}$ 的隐式更新。\n\n任务：\n- 从给定的能量平衡方程出发，推导关于 $T^{n+1}$ 的隐式后向欧拉更新方程，该方程用 $T^n$、$C_{\\mathrm{th}}$、$\\Delta t$、$Q_{\\mathrm{gen}}(T^{n+1})$、$hA(T^{n+1})$ 和 $T_{\\infty}$ 表示。\n- 构建标量残差函数 $F(T^{n+1})$，使得后向欧拉更新可通过求解 $F(T^{n+1}) = 0$ 获得。\n- 推导求解 $F(T^{n+1}) = 0$ 的 Newton–Raphson 迭代法，包括导数 $F'(T^{n+1})$ 用 $Q_{\\mathrm{gen}}'(T^{n+1})$ 和 $hA'(T^{n+1})$ 表示的表达式。\n- 实现一个程序，对于下述每个测试用例，根据指定的 $Q_{\\mathrm{gen}}(T)$ 和 $hA(T)$ 构建 $F(T^{n+1})$ 和 $F'(T^{n+1})$，使用 Newton–Raphson 方法求解 $T^{n+1}$，并输出收敛后的 $T^{n+1}$。\n\n物理单位：\n- 所有温度以 $\\mathrm{K}$ (开尔文) 报告。\n- 时间步长 $\\Delta t$ 的单位为 $\\mathrm{s}$ (秒)。\n- 热容 $C_{\\mathrm{th}}$ 的单位为 $\\mathrm{J}/\\mathrm{K}$ (焦耳/开尔文)。\n- 生热量 $Q_{\\mathrm{gen}}$ 的单位为 $\\mathrm{W}$ (瓦特)。\n- 对流项 $hA$ 的单位为 $\\mathrm{W}/\\mathrm{K}$ (瓦特/开尔文)。\n\nNewton–Raphson 实现细节：\n- 使用 $T^n$ 作为 $T^{n+1}$ 的初始猜测值。\n- 当绝对残差 $|F(T^{n+1})|$ 低于 $10^{-12}$ 或迭代变化量 $|T^{(k+1)} - T^{(k)}|$ 低于 $10^{-12}$ 时停止，或在 $50$ 次迭代后停止（如果未提前收敛，则将最新的迭代值声明为结果）。\n- 对于每个测试用例，根据给定的定义计算 $Q_{\\mathrm{gen}}'(T)$ 和 $hA'(T)$ 的解析表达式。\n\n测试套件：\n对于每种情况，使用指定的参数定义 $Q_{\\mathrm{gen}}(T)$ 和 $hA(T)$ 并求解 $T^{n+1}$。\n\n- 情况1（非线性生热和轻度温度依赖性对流）：\n  - $C_{\\mathrm{th}} = 1000\\,\\mathrm{J}/\\mathrm{K}$，$\\Delta t = 1\\,\\mathrm{s}$，$T^n = 298\\,\\mathrm{K}$，$T_{\\infty} = 298\\,\\mathrm{K}$。\n  - 电流 $I = 10\\,\\mathrm{A}$，参考温度 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$，欧姆电阻 $R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$，其中 $R_0 = 0.01\\,\\Omega$，$\\alpha = 0.002\\,\\mathrm{K}^{-1}$。\n  - 开路电压（OCV）熵项 $Q_{\\mathrm{entropic}}(T) = I\\,T\\,\\gamma$，其中 $\\gamma = 0.0002\\,\\mathrm{V}/\\mathrm{K}$。\n  - $Q_{\\mathrm{gen}}(T) = I^2\\,R(T) + Q_{\\mathrm{entropic}}(T)$。\n  - $hA(T) = hA_0\\big(1 + \\beta\\,(T - T_{\\mathrm{ref}})\\big)$，其中 $hA_0 = 4\\,\\mathrm{W}/\\mathrm{K}$，$\\beta = 0.001\\,\\mathrm{K}^{-1}$。\n\n- 情况2（纯冷却，恒定对流）：\n  - $C_{\\mathrm{th}} = 1500\\,\\mathrm{J}/\\mathrm{K}$，$\\Delta t = 5\\,\\mathrm{s}$，$T^n = 320\\,\\mathrm{K}$，$T_{\\infty} = 298\\,\\mathrm{K}$。\n  - $Q_{\\mathrm{gen}}(T) = 0$。\n  - $hA(T) = 8\\,\\mathrm{W}/\\mathrm{K}$ (常数)。\n\n- 情况3（大时间步长，强欧姆加热，恒定对流）：\n  - $C_{\\mathrm{th}} = 1200\\,\\mathrm{J}/\\mathrm{K}$，$\\Delta t = 30\\,\\mathrm{s}$，$T^n = 298\\,\\mathrm{K}$，$T_{\\infty} = 298\\,\\mathrm{K}$。\n  - 电流 $I = 50\\,\\mathrm{A}$，$T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$，电阻 $R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$，其中 $R_0 = 0.01\\,\\Omega$，$\\alpha = 0.005\\,\\mathrm{K}^{-1}$。\n  - $Q_{\\mathrm{gen}}(T) = I^2\\,R(T)$。\n  - $hA(T) = 3\\,\\mathrm{W}/\\mathrm{K}$ (常数)。\n\n- 情况4（极小时间步长，物理模型与情况1相同）：\n  - $C_{\\mathrm{th}} = 1000\\,\\mathrm{J}/\\mathrm{K}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$T^n = 298\\,\\mathrm{K}$，$T_{\\infty} = 298\\,\\mathrm{K}$。\n  - $Q_{\\mathrm{gen}}(T)$ 和 $hA(T)$ 的定义和参数与情况1相同。\n\n- 情况5（类似自然对流标度的非线性对流，混合生热）：\n  - $C_{\\mathrm{th}} = 900\\,\\mathrm{J}/\\mathrm{K}$，$\\Delta t = 10\\,\\mathrm{s}$，$T^n = 305\\,\\mathrm{K}$，$T_{\\infty} = 295\\,\\mathrm{K}$。\n  - 电流 $I = 20\\,\\mathrm{A}$，$T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$，电阻 $R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$，其中 $R_0 = 0.012\\,\\Omega$，$\\alpha = 0.0015\\,\\mathrm{K}^{-1}$。\n  - 熵项 $Q_{\\mathrm{entropic}}(T) = I\\,T\\,\\gamma$，其中 $\\gamma = 0.00015\\,\\mathrm{V}/\\mathrm{K}$。\n  - $Q_{\\mathrm{gen}}(T) = I^2\\,R(T) + Q_{\\mathrm{entropic}}(T)$。\n  - $hA(T) = hA_0\\,\\big(\\frac{T}{298}\\big)^{0.25}$，其中 $hA_0 = 5\\,\\mathrm{W}/\\mathrm{K}$。\n\n最终输出规范：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $\\big[$$result_1$$,$$result_2$$,$$result_3$$\\big]$。\n- 每个 $result_i$ 是对应测试用例收敛后的 $T^{n+1}$，以 $\\mathrm{K}$ 为单位表示，并四舍五入到六位小数。",
            "solution": "用户要求我为一个集总参数电池模型求解一个瞬态传热问题。\n\n以下是我的计划：\n1.  **验证问题：**\n    -   提取所有给定信息：控制常微分方程、离散化方法（后向欧拉法）、求解方法（Newton-Raphson法）、参数定义以及五个具体的测试用例。\n    -   检查科学合理性、一致性和完整性。该模型是一个标准的集总热容模型，是工程中常见且有效的简化方法。所描述的物理现象（焦耳热、熵热、对流）是电池建模中的标准内容。用于求解刚性常微分方程的数值方法（后向欧拉法、Newton-Raphson法）也是标准方法。问题设定良好且科学上合理。测试用例中给出的参数在物理上是合理的。单位是一致的。没有明显的矛盾或歧义。\n    -   结论：问题有效。\n\n2.  **推导方程：**\n    -   **步骤1：后向欧拉离散化：**\n        -   常微分方程为：$C_{\\mathrm{th}} \\frac{dT}{dt} = Q_{\\mathrm{gen}}(T) - hA(T)(T - T_{\\infty})$。\n        -   近似时间导数：$\\frac{dT}{dt} \\approx \\frac{T^{n+1} - T^n}{\\Delta t}$。\n        -   应用后向欧拉法，在时间 $t^{n+1}$（即温度 $T^{n+1}$）处计算右侧项(RHS)。\n        -   代入常微分方程：$C_{\\mathrm{th}} \\frac{T^{n+1} - T^n}{\\Delta t} = Q_{\\mathrm{gen}}(T^{n+1}) - hA(T^{n+1})(T^{n+1} - T_{\\infty})$。\n        -   这是隐式更新方程。\n\n    -   **步骤2：构建残差函数：**\n        -   目标是找到一个函数 $F(T^{n+1})$，使得 $F(T^{n+1}) = 0$ 等价于后向欧拉方程。\n        -   将步骤1中的方程所有项移到一边：\n            $C_{\\mathrm{th}} \\frac{T^{n+1} - T^n}{\\Delta t} - Q_{\\mathrm{gen}}(T^{n+1}) + hA(T^{n+1})(T^{n+1} - T_{\\infty}) = 0$。\n        -   令 $T$ 代表未知数 $T^{n+1}$。残差函数是：\n            $F(T) = \\frac{C_{\\mathrm{th}}}{\\Delta t}(T - T^n) - Q_{\\mathrm{gen}}(T) + hA(T)(T - T_{\\infty})$。\n\n    -   **步骤3：推导 Newton-Raphson 迭代法：**\n        -   求解 $F(x) = 0$ 的 Newton-Raphson 更新法则是 $x^{(k+1)} = x^{(k)} - \\frac{F(x^{(k)})}{F'(x^{(k)})}$。\n        -   在我们的问题中，未知数是 $T$（代表 $T^{n+1}$），所以更新是：\n            $T^{(k+1)} = T^{(k)} - \\frac{F(T^{(k)})}{F'(T^{(k)})}$。\n        -   我们需要求 $F(T)$ 对 $T$ 的导数。\n        -   $F'(T) = \\frac{d}{dT} \\left[ \\frac{C_{\\mathrm{th}}}{\\Delta t}(T - T^n) - Q_{\\mathrm{gen}}(T) + hA(T)(T - T_{\\infty}) \\right]$。\n        -   逐项求导：\n            -   $\\frac{d}{dT} \\left( \\frac{C_{\\mathrm{th}}}{\\Delta t} T \\right) = \\frac{C_{\\mathrm{th}}}{\\Delta t}$。\n            -   $\\frac{d}{dT} \\left( -\\frac{C_{\\mathrm{th}}}{\\Delta t} T^n \\right) = 0$（因为 $T^n$ 相对于未知数 $T$ 是一个常数）。\n            -   $\\frac{d}{dT} \\left( -Q_{\\mathrm{gen}}(T) \\right) = -Q_{\\mathrm{gen}}'(T)$。\n            -   $\\frac{d}{dT} \\left( hA(T)(T - T_{\\infty}) \\right)$ 需要使用乘法法则：$u = hA(T)$，$v = (T - T_{\\infty})$。\n                -   $u'v + uv' = hA'(T)(T - T_{\\infty}) + hA(T)(1)$。\n        -   合并各项：\n            $F'(T) = \\frac{C_{\\mathrm{th}}}{\\Delta t} - Q_{\\mathrm{gen}}'(T) + hA'(T)(T - T_{\\infty}) + hA(T)$。\n\n3.  **为每个测试用例实现解决方案：**\n    -   创建一个通用的 Newton-Raphson 求解器函数，该函数接受初始猜测值、残差函数 `F` 及其导数 `F_prime` 作为参数。此求解器将实现停止标准：$|F(T)| < 10^{-12}$、 $|\\Delta T| < 10^{-12}$ 或最多50次迭代。\n    -   对于每个用例，定义 $Q_{\\mathrm{gen}}(T)$、$hA(T)$、$Q_{\\mathrm{gen}}'(T)$ 和 $hA'(T)$ 的具体函数。\n\n这些步骤将在下面的解决方案中详细说明，然后是完整的代码实现。\n在进行求解之前，对问题进行了验证。\n\n### 步骤1：提取给定信息\n- **控制方程：** $C_{\\mathrm{th}} \\,\\frac{dT}{dt} \\;=\\; Q_{\\mathrm{gen}}(T) \\;-\\; hA(T)\\,\\big(T - T_{\\infty}\\big)$\n- **变量和参数：** 温度 $T(t)$、时间 $t$、时间步长 $\\Delta t$、集总热容 $C_{\\mathrm{th}}$、生热率 $Q_{\\mathrm{gen}}(T)$、有效传热系数-面积乘积 $hA(T)$、环境温度 $T_{\\infty}$、时间 $t^n$ 的温度为 $T^n$、时间 $t^{n+1}$ 的温度为 $T^{n+1}$。\n- **数值方法：** 用于时间积分的后向欧拉法。用于求解所得非线性代数方程的Newton-Raphson法。\n- **Newton-Raphson 规范：** $T^{n+1}$ 的初始猜测值为 $T^n$。收敛标准：绝对残差 $|F(T^{n+1})| < 10^{-12}$ 或更新步长 $|T^{(k+1)} - T^{(k)}| < 10^{-12}$。最大迭代次数：$50$。\n- **测试用例：**\n  - **情况1：** $C_{\\mathrm{th}} = 1000\\,\\mathrm{J}/\\mathrm{K}$, $\\Delta t = 1\\,\\mathrm{s}$, $T^n = 298\\,\\mathrm{K}$, $T_{\\infty} = 298\\,\\mathrm{K}$。$I = 10\\,\\mathrm{A}$, $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。$R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$ 其中 $R_0 = 0.01\\,\\Omega$, $\\alpha = 0.002\\,\\mathrm{K}^{-1}$。$Q_{\\mathrm{entropic}}(T) = I\\,T\\,\\gamma$ 其中 $\\gamma = 0.0002\\,\\mathrm{V}/\\mathrm{K}$。$Q_{\\mathrm{gen}}(T) = I^2\\,R(T) + Q_{\\mathrm{entropic}}(T)$。$hA(T) = hA_0\\big(1 + \\beta\\,(T - T_{\\mathrm{ref}})\\big)$ 其中 $hA_0 = 4\\,\\mathrm{W}/\\mathrm{K}$, $\\beta = 0.001\\,\\mathrm{K}^{-1}$。\n  - **情况2：** $C_{\\mathrm{th}} = 1500\\,\\mathrm{J}/\\mathrm{K}$, $\\Delta t = 5\\,\\mathrm{s}$, $T^n = 320\\,\\mathrm{K}$, $T_{\\infty} = 298\\,\\mathrm{K}$。$Q_{\\mathrm{gen}}(T) = 0$。$hA(T) = 8\\,\\mathrm{W}/\\mathrm{K}$。\n  - **情况3：** $C_{\\mathrm{th}} = 1200\\,\\mathrm{J}/\\mathrm{K}$, $\\Delta t = 30\\,\\mathrm{s}$, $T^n = 298\\,\\mathrm{K}$, $T_{\\infty} = 298\\,\\mathrm{K}$。$I = 50\\,\\mathrm{A}$, $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。$R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$ 其中 $R_0 = 0.01\\,\\Omega$, $\\alpha = 0.005\\,\\mathrm{K}^{-1}$。$Q_{\\mathrm{gen}}(T) = I^2\\,R(T)$。$hA(T) = 3\\,\\mathrm{W}/\\mathrm{K}$。\n  - **情况4：** $C_{\\mathrm{th}} = 1000\\,\\mathrm{J}/\\mathrm{K}$, $\\Delta t = 0.001\\,\\mathrm{s}$, $T^n = 298\\,\\mathrm{K}$, $T_{\\infty} = 298\\,\\mathrm{K}$。$Q_{\\mathrm{gen}}(T)$ 和 $hA(T)$ 与情况1相同。\n  - **情况5：** $C_{\\mathrm{th}} = 900\\,\\mathrm{J}/\\mathrm{K}$, $\\Delta t = 10\\,\\mathrm{s}$, $T^n = 305\\,\\mathrm{K}$, $T_{\\infty} = 295\\,\\mathrm{K}$。$I = 20\\,\\mathrm{A}$, $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。$R(T) = R_0\\big(1 + \\alpha\\,(T - T_{\\mathrm{ref}})\\big)$ 其中 $R_0 = 0.012\\,\\Omega$, $\\alpha = 0.0015\\,\\mathrm{K}^{-1}$。$Q_{\\mathrm{entropic}}(T) = I\\,T\\,\\gamma$ 其中 $\\gamma = 0.00015\\,\\mathrm{V}/\\mathrm{K}$。$Q_{\\mathrm{gen}}(T) = I^2\\,R(T) + Q_{\\mathrm{entropic}}(T)$。$hA(T) = hA_0\\,\\big(\\frac{T}{298}\\big)^{0.25}$ 其中 $hA_0 = 5\\,\\mathrm{W}/\\mathrm{K}$。\n\n### 步骤2：使用提取的信息进行验证\n该问题在科学上是合理的、设定良好的、客观的。\n- **科学合理性：** 控制方程是热力学第一定律在集总热容系统上的直接应用，是传热分析中的标准有效模型。生热项（$I^2R$ 焦耳热和熵热）以及对流冷却项是电池热模型中的基本概念。\n- **设定良好：** 问题提供了一个定义明确的常微分方程和一个初始条件（$T^n$ 可视为该时间步长的初始条件）。它指定了一种标准的、稳定的数值方法（隐式后向欧拉法）来寻找唯一解 $T^{n+1}$。使用 Newton-Raphson 法求解所得的代数方程也是一种标准技术。所有参数和函数都为每个案例明确定义。\n- **客观性：** 问题以精确的数学和物理术语陈述，没有歧义或主观论断。所提供的参数对于电池单元而言是物理上现实的。\n\n### 步骤3：结论与行动\n问题有效，可以按所述方法求解。\n\n### 推导与求解方法\n求解过程包括问题中要求的三个主要理论步骤：使用后向欧拉法离散化控制常微分方程，为所得代数方程构建残差函数，以及推导 Newton-Raphson 更新方案以求解下一个时间步的温度 $T^{n+1}$。\n\n**1. 后向欧拉离散化**\n集总热模型的控制常微分方程（ODE）是：\n$$\nC_{\\mathrm{th}} \\frac{dT}{dt} = Q_{\\mathrm{gen}}(T) - hA(T)\\,\\big(T - T_{\\infty}\\big)\n$$\n为了将解从时间 $t^n$ 推进到 $t^{n+1} = t^n + \\Delta t$，我们使用一阶有限差分来近似时间导数。后向欧拉法在未知的未来时间 $t^{n+1}$（对应于未知温度 $T^{n+1}$）处计算 ODE 的整个右侧项（RHS）。时间导数项近似为：\n$$\n\\frac{dT}{dt} \\bigg|_{t^{n+1}} \\approx \\frac{T(t^{n+1}) - T(t^n)}{t^{n+1} - t^n} = \\frac{T^{n+1} - T^n}{\\Delta t}\n$$\n将此近似代入并以 $T^{n+1}$ 计算 RHS，得到隐式后向欧拉更新方程：\n$$\nC_{\\mathrm{th}} \\frac{T^{n+1} - T^n}{\\Delta t} = Q_{\\mathrm{gen}}(T^{n+1}) - hA(T^{n+1})\\,\\big(T^{n+1} - T_{\\infty}\\big)\n$$\n这是一个关于未知温度 $T^{n+1}$ 的非线性代数方程。\n\n**2. 残差函数构建**\n为了使用像 Newton-Raphson 这样的求根算法来解这个方程，我们必须首先将其表示为 $F(x) = 0$ 的形式。设未知变量为 $T \\equiv T^{n+1}$。通过将离散化方程的各项移到一边，我们定义标量残差函数 $F(T)$：\n$$\nF(T) = \\frac{C_{\\mathrm{th}}}{\\Delta t}(T - T^n) - Q_{\\mathrm{gen}}(T) + hA(T)\\,\\big(T - T_{\\infty}\\big)\n$$\n解 $T^{n+1}$ 就是方程 $F(T) = 0$ 的根。\n\n**3. Newton–Raphson 迭代**\nNewton-Raphson 方法是寻找 $F(T) = 0$ 根的迭代过程。给定一个迭代值 $T^{(k)}$，下一个迭代值 $T^{(k+1)}$ 通过以下公式找到：\n$$\nT^{(k+1)} = T^{(k)} - \\frac{F(T^{(k)})}{F'(T^{(k)})}\n$$\n其中 $F'(T)$ 是残差函数相对于 $T$ 的导数。我们通过对 $F(T)$ 的每一项求导来计算 $F'(T)$：\n$$\nF'(T) = \\frac{d}{dT} \\left[ \\frac{C_{\\mathrm{th}}}{\\Delta t}(T - T^n) - Q_{\\mathrm{gen}}(T) + hA(T)\\,(T - T_{\\infty}) \\right]\n$$\n第一项对 $T$ 的导数是 $\\frac{C_{\\mathrm{th}}}{\\Delta t}$，因为 $T^n$ 在当前时间步长内是常数。第二项的导数是 $-Q_{\\mathrm{gen}}'(T)$。对于第三项，我们使用乘法法则，其中 $u(T) = hA(T)$ 和 $v(T) = T - T_{\\infty}$：\n$$\n\\frac{d}{dT} \\left[ hA(T)\\,(T - T_{\\infty}) \\right] = \\left(\\frac{d}{dT} hA(T)\\right)(T - T_{\\infty}) + hA(T)\\left(\\frac{d}{dT}(T - T_{\\infty})\\right)\n$$\n$$\n= hA'(T)(T - T_{\\infty}) + hA(T)(1)\n$$\n将所有求导项组合起来，得到 $F'(T)$ 的表达式：\n$$\nF'(T) = \\frac{C_{\\mathrm{th}}}{\\Delta t} - Q_{\\mathrm{gen}}'(T) + hA'(T)(T - T_{\\infty}) + hA(T)\n$$\n对于每个测试用例，必须将 $Q_{\\mathrm{gen}}(T)$、$hA(T)$ 及其导数 $Q_{\\mathrm{gen}}'(T)$ 和 $hA'(T)$ 的具体函数形式代入 $F(T)$ 和 $F'(T)$ 的表达式中。Newton-Raphson 迭代以初始猜测值 $T^{(0)} = T^n$ 开始，并持续进行直到满足指定的收敛标准。\n\n**算法实现**\n实现了一个 Python 程序来为所有五个测试用例求解 $T^{n+1}$。程序的核心是一个通用的 Newton-Raphson 求解器，它接受残差函数、其导数和初始猜测值。对于每个测试用例，使用特定于问题的参数来定义 $Q_{\\mathrm{gen}}(T)$、$hA(T)$、$Q_{\\mathrm{gen}}'(T)$ 和 $hA'(T)$ 的 Python `lambda` 函数。然后，这些函数用于构建该案例特定的 $F(T)$ 和 $F'(T)$，并传递给求解器。求解器迭代直到收敛并返回最终温度，然后收集该温度用于最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef newton_raphson_solver(F, F_prime, T_n):\n    \"\"\"\n    Solves F(T) = 0 for T using the Newton-Raphson method.\n\n    Args:\n        F (callable): The residual function F(T).\n        F_prime (callable): The derivative of the residual function, F'(T).\n        T_n (float): The temperature at the previous time step, used as the initial guess.\n\n    Returns:\n        float: The converged temperature T^{n+1}.\n    \"\"\"\n    tol = 1e-12\n    max_iter = 50\n    T_k = float(T_n)  # Initial guess for T^{n+1}\n\n    for _ in range(max_iter):\n        F_val = F(T_k)\n\n        if abs(F_val) < tol:\n            return T_k\n\n        F_prime_val = F_prime(T_k)\n        # Avoid division by zero, although unlikely in these well-behaved problems.\n        if abs(F_prime_val) < 1e-15:\n            return T_k\n\n        # Newton-Raphson update\n        T_next = T_k - F_val / F_prime_val\n\n        # Check for convergence on the step size\n        if abs(T_next - T_k) < tol:\n            return T_next\n\n        T_k = T_next\n\n    # Return the last iterate if max_iter is reached\n    return T_k\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solution for all test cases.\n    \"\"\"\n    # Each dictionary in the list represents a test case.\n    test_cases = [\n        # Case 1\n        {\n            'C_th': 1000.0, 'dt': 1.0, 'T_n': 298.0, 'T_inf': 298.0, 'case_type': 'case1',\n            'I': 10.0, 'R0': 0.01, 'alpha': 0.002, 'T_ref': 298.0, 'gamma': 0.0002,\n            'hA0': 4.0, 'beta': 0.001\n        },\n        # Case 2\n        {\n            'C_th': 1500.0, 'dt': 5.0, 'T_n': 320.0, 'T_inf': 298.0, 'case_type': 'case2',\n            'hA_const': 8.0\n        },\n        # Case 3\n        {\n            'C_th': 1200.0, 'dt': 30.0, 'T_n': 298.0, 'T_inf': 298.0, 'case_type': 'case3',\n            'I': 50.0, 'R0': 0.01, 'alpha': 0.005, 'T_ref': 298.0,\n            'hA_const': 3.0\n        },\n        # Case 4 (same physics as Case 1, different dt)\n        {\n            'C_th': 1000.0, 'dt': 0.001, 'T_n': 298.0, 'T_inf': 298.0, 'case_type': 'case1',\n            'I': 10.0, 'R0': 0.01, 'alpha': 0.002, 'T_ref': 298.0, 'gamma': 0.0002,\n            'hA0': 4.0, 'beta': 0.001\n        },\n        # Case 5\n        {\n            'C_th': 900.0, 'dt': 10.0, 'T_n': 305.0, 'T_inf': 295.0, 'case_type': 'case5',\n            'I': 20.0, 'R0': 0.012, 'alpha': 0.0015, 'T_ref': 298.0, 'gamma': 0.00015,\n            'hA0': 5.0\n        }\n    ]\n\n    results = []\n\n    for params in test_cases:\n        C_th = params['C_th']\n        dt = params['dt']\n        T_n = params['T_n']\n        T_inf = params['T_inf']\n        case_type = params['case_type']\n\n        # Define Q_gen, hA, and their derivatives based on the case\n        if case_type == 'case1':\n            I, R0, alpha, T_ref, gamma = params['I'], params['R0'], params['alpha'], params['T_ref'], params['gamma']\n            hA0, beta = params['hA0'], params['beta']\n            Q_gen = lambda T: I**2 * R0 * (1.0 + alpha * (T - T_ref)) + I * T * gamma\n            Q_gen_prime = lambda T: I**2 * R0 * alpha + I * gamma\n            hA = lambda T: hA0 * (1.0 + beta * (T - T_ref))\n            hA_prime = lambda T: hA0 * beta\n        elif case_type == 'case2':\n            hA_const = params['hA_const']\n            Q_gen = lambda T: 0.0\n            Q_gen_prime = lambda T: 0.0\n            hA = lambda T: hA_const\n            hA_prime = lambda T: 0.0\n        elif case_type == 'case3':\n            I, R0, alpha, T_ref = params['I'], params['R0'], params['alpha'], params['T_ref']\n            hA_const = params['hA_const']\n            Q_gen = lambda T: I**2 * R0 * (1.0 + alpha * (T - T_ref))\n            Q_gen_prime = lambda T: I**2 * R0 * alpha\n            hA = lambda T: hA_const\n            hA_prime = lambda T: 0.0\n        elif case_type == 'case5':\n            I, R0, alpha, T_ref, gamma = params['I'], params['R0'], params['alpha'], params['T_ref'], params['gamma']\n            hA0 = params['hA0']\n            Q_gen = lambda T: I**2 * R0 * (1.0 + alpha * (T - T_ref)) + I * T * gamma\n            Q_gen_prime = lambda T: I**2 * R0 * alpha + I * gamma\n            hA = lambda T: hA0 * (T / 298.0)**0.25\n            hA_prime = lambda T: 0.25 * hA0 * (1.0/298.0)**0.25 * T**(-0.75) if T > 0 else 0.0\n\n        # Define the residual function F(T)\n        F = lambda T: (C_th / dt) * (T - T_n) - Q_gen(T) + hA(T) * (T - T_inf)\n\n        # Define the derivative of the residual function F'(T)\n        F_prime = lambda T: (C_th / dt) - Q_gen_prime(T) + hA_prime(T) * (T - T_inf) + hA(T)\n\n        # Solve for T^{n+1}\n        T_np1 = newton_raphson_solver(F, F_prime, T_n)\n        results.append(T_np1)\n\n    # Format the results to 6 decimal places and print in the specified format\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}