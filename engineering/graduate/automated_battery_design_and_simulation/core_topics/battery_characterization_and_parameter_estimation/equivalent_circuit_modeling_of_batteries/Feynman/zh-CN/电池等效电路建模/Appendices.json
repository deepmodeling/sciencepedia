{
    "hands_on_practices": [
        {
            "introduction": "要掌握等效电路模型，第一步是深刻理解其对基本输入的动态响应。本练习将引导您从第一性原理出发，为一阶 RC 模型在恒定电流激励下的电压响应推导出解析解。通过这个过程，您将清晰地看到欧姆压降、极化效应和荷电状态（SOC）的变化如何共同决定电池的端电压$V(t)$，为更复杂的仿真和分析打下坚实基础。",
            "id": "3912122",
            "problem": "考虑一个锂离子电池的等效电路模型(ECM)，该模型由一个依赖于荷电状态(SOC) $x(t)$（无量纲，$x \\in [0,1]$）的开路电压源 $v_{\\mathrm{oc}}(x)$、一个串联欧姆电阻 $R_{s}$ 和一个由电阻 $R_{1}$ 与电容 $C_{1}$ 并联建模的单一阶极化支路组成。符号约定为正电流 $I(t)$ 对应于放电，因此在正电流下，端电压 $V(t)$ 相对于 $v_{\\mathrm{oc}}(x(t))$ 下降。假设电池在 $t=0$ 时处于静止状态，$I(t)=0$，极化电压初始松弛，且SOC为 $x(0)=x_{0}$。在 $t=0$ 时，施加一个阶跃放电电流，\n$$\nI(t)=I_{0}\\,\\mathbf{1}_{t\\ge 0},\n$$\n其中 $\\mathbf{1}_{t\\ge 0}$ 表示指示函数。\n\n仅从以下基本关系出发：\n- 集总电路的基尔霍夫电压定律和基尔霍夫电流定律，\n- 电容本构关系 $i_{C}(t)=C\\,\\frac{dv_{C}}{dt}$，\n- 标称容量为 $Q$（单位：库仑）的电池的SOC动态特性，$\\frac{dx}{dt}=-\\frac{I(t)}{Q}$，\n- 开路电压在 $x_{0}$ 附近的一阶线性化，$v_{\\mathrm{oc}}(x)\\approx v_{\\mathrm{oc}}(x_{0})+k\\,(x-x_{0})$，其中 $k=\\left.\\frac{dv_{\\mathrm{oc}}}{dx}\\right|_{x_{0}}$，\n\n在所述假设下，忽略磁滞和温度依赖性，推导 $t\\ge 0$ 时端电压 $V(t)$ 的闭式表达式。端电压公式以伏特为单位表示。最终表达式必须是关于 $t$ 和给定参数 $\\{v_{\\mathrm{oc}}(x_{0}),k,x_{0},Q,I_{0},R_{s},R_{1},C_{1}\\}$ 的单一闭式解析函数，并在推导过程中明确引用所有必要的初始条件。不需要进行数值代入，也不需要四舍五入。请以 $V(t)$ 的单一解析表达式形式提供最终答案。",
            "solution": "该问题提供了一套完整且一致的定义、初始条件和控制物理定律，用于确定由一阶等效电路建模的锂离子电池在阶跃放电电流响应下的端电压。该问题具有科学依据，提法明确且客观。因此，该问题被认为是有效的，并且可以推导出解。\n\n该等效电路模型由一个开路电压(OCV)源 $v_{\\mathrm{oc}}(x)$、一个串联电阻 $R_{s}$ 和一个由 $R_{1}$ 和 $C_{1}$ 组成的并联RC支路构成。端电压 $V(t)$ 是在这些元件的串联组合上测量的。从电池流出的总电流用 $I(t)$ 表示。正电流对应于放电。\n\n设 $v_{1}(t)$ 为并联RC支路两端的电压，其极性在放电期间与端电压相反。对电路应用基尔霍夫电压定律(KVL)，可得端电压 $V(t)$ 的表达式：\n$$\nV(t) = v_{\\mathrm{oc}}(x(t)) - I(t)R_{s} - v_{1}(t)\n$$\n问题中给出的符号约定（正放电电流下电压下降）证实了电阻和极化元件上电压降的负号。\n\n推导过程分三部分进行：\n1.  推导极化电压 $v_{1}(t)$ 的表达式。\n2.  推导荷电状态 $x(t)$ 的表达式，并随后推导OCV $v_{\\mathrm{oc}}(x(t))$ 的表达式。\n3.  结合这些结果，得到端电压 $V(t)$ 的最终表达式。\n\n**1. 极化电压动态特性**\n\n流过电池的总电流 $I(t)$ 在RC支路内分成两条路径：流过电阻 $R_{1}$ 的电流，记为 $i_{R1}(t)$，和流过电容 $C_{1}$ 的电流，记为 $i_{C1}(t)$。根据基尔霍夫电流定律(KCL)：\n$$\nI(t) = i_{R1}(t) + i_{C1}(t)\n$$\n两个并联元件两端的电压均为 $v_{1}(t)$。根据电阻的欧姆定律和电容的本构关系：\n$$\ni_{R1}(t) = \\frac{v_{1}(t)}{R_{1}}\n$$\n$$\ni_{C1}(t) = C_{1}\\frac{dv_{1}(t)}{dt}\n$$\n将这些代入KCL方程，得到关于 $v_{1}(t)$ 的一阶线性常微分方程(ODE)：\n$$\nI(t) = \\frac{v_{1}(t)}{R_{1}} + C_{1}\\frac{dv_{1}(t)}{dt}\n$$\n对于 $t \\ge 0$，施加阶跃电流 $I(t) = I_{0}$。ODE变为：\n$$\nI_{0} = \\frac{v_{1}(t)}{R_{1}} + C_{1}\\frac{dv_{1}(t)}{dt}\n$$\n整理成标准形式：\n$$\n\\frac{dv_{1}}{dt} + \\frac{1}{R_{1}C_{1}}v_{1}(t) = \\frac{I_{0}}{C_{1}}\n$$\n这是一个非齐次ODE。其解是齐次解 $v_{1,h}(t)$ 和一个特解 $v_{1,p}(t)$ 的和。齐次方程为 $\\frac{dv_{1,h}}{dt} + \\frac{1}{R_{1}C_{1}}v_{1,h} = 0$，其解为 $v_{1,h}(t) = A\\exp(-t/\\tau_{1})$，其中 $\\tau_{1} = R_{1}C_{1}$ 是RC支路的时间常数，A是一个常数。对于一个恒定的输入 $I_{0}$，特解是一个常数，$v_{1,p}(t) = K$。代入ODE，我们得到 $0 + \\frac{K}{R_{1}C_{1}} = \\frac{I_{0}}{C_{1}}$，解得 $K = I_{0}R_{1}$。\n通解为：\n$$\nv_{1}(t) = A\\exp(-t/\\tau_{1}) + I_{0}R_{1}\n$$\n问题指出极化电压初始松弛，这意味着 $v_{1}(0) = 0$。在 $t=0$ 时应用这个初始条件：\n$$\nv_{1}(0) = 0 = A\\exp(0) + I_{0}R_{1} \\implies A = -I_{0}R_{1}\n$$\n因此，对于 $t \\ge 0$，极化电压的表达式为：\n$$\nv_{1}(t) = I_{0}R_{1}\\left(1 - \\exp\\left(-\\frac{t}{R_{1}C_{1}}\\right)\\right)\n$$\n\n**2. 荷电状态和开路电压动态特性**\n\n荷电状态 $x(t)$ 由以下关系决定：\n$$\n\\frac{dx}{dt} = -\\frac{I(t)}{Q}\n$$\n对于 $t \\ge 0$，$I(t)=I_{0}$，该式变为：\n$$\n\\frac{dx}{dt} = -\\frac{I_{0}}{Q}\n$$\n在初始条件 $x(0) = x_{0}$ 下，对时间从 $0$ 到 $t$ 进行积分：\n$$\n\\int_{x_{0}}^{x(t)} dx' = \\int_{0}^{t} -\\frac{I_{0}}{Q} dt'\n$$\n$$\nx(t) - x_{0} = -\\frac{I_{0}}{Q}t\n$$\n$$\nx(t) = x_{0} - \\frac{I_{0}}{Q}t\n$$\n接下来，我们使用所提供的OCV $v_{\\mathrm{oc}}(x)$ 在初始SOC $x_{0}$ 附近的一阶线性化：\n$$\nv_{\\mathrm{oc}}(x) \\approx v_{\\mathrm{oc}}(x_{0}) + k(x-x_{0})\n$$\n其中 $k=\\left.\\frac{dv_{\\mathrm{oc}}}{dx}\\right|_{x_{0}}$。将 $x(t)$ 的表达式代入此近似式，得到 $t \\ge 0$ 时随时间变化的OCV：\n$$\nv_{\\mathrm{oc}}(x(t)) = v_{\\mathrm{oc}}(x_{0}) + k\\left(\\left(x_{0} - \\frac{I_{0}}{Q}t\\right) - x_{0}\\right)\n$$\n$$\nv_{\\mathrm{oc}}(x(t)) = v_{\\mathrm{oc}}(x_{0}) - \\frac{k I_{0}}{Q}t\n$$\n\n**3. 组合端电压表达式**\n\n最后，我们将 $v_{\\mathrm{oc}}(x(t))$ 和 $v_{1}(t)$ 的表达式代回到端电压 $V(t)$ 的KVL方程中。对于 $t \\ge 0$，我们有 $I(t) = I_{0}$。\n$$\nV(t) = v_{\\mathrm{oc}}(x(t)) - I(t)R_{s} - v_{1}(t)\n$$\n$$\nV(t) = \\left(v_{\\mathrm{oc}}(x_{0}) - \\frac{k I_{0}}{Q}t\\right) - I_{0}R_{s} - I_{0}R_{1}\\left(1 - \\exp\\left(-\\frac{t}{R_{1}C_{1}}\\right)\\right)\n$$\n展开并重新整理各项，得到端电压的最终闭式表达式：\n$$\nV(t) = v_{\\mathrm{oc}}(x_{0}) - I_{0}R_{s} - I_{0}R_{1} + I_{0}R_{1}\\exp\\left(-\\frac{t}{R_{1}C_{1}}\\right) - \\frac{k I_{0}}{Q}t\n$$\n为了清晰起见，可以对各项进行分组，以显示初始电压、线性漂移和指数松弛：\n$$\nV(t) = v_{\\mathrm{oc}}(x_{0}) - I_{0}(R_{s} + R_{1}) - \\frac{k I_{0}}{Q}t + I_{0}R_{1}\\exp\\left(-\\frac{t}{R_{1}C_{1}}\\right)\n$$\n该表达式表示 $t \\ge 0$ 时的完整电压响应，包含了初始OCV、瞬时欧姆压降、瞬态极化效应以及因荷电状态变化引起的OCV缓慢变化。",
            "answer": "$$\\boxed{V(t) = v_{\\mathrm{oc}}(x_{0}) - I_{0}(R_{s} + R_{1}) - \\frac{k I_{0}}{Q}t + I_{0}R_{1}\\exp\\left(-\\frac{t}{R_{1}C_{1}}\\right)}$$"
        },
        {
            "introduction": "建立模型后，一个关键应用是评估电池在实际工况下的性能，尤其是能量效率。这个练习将模型应用于一个分段的电流剖面，模拟一个简化的驱动循环。您的任务是计算并区分不同来源的能量损失——即时的欧姆损失$E_{\\text{ohmic}}$和随时间演化的极化损失$E_{\\text{polarization}}$，这对于电池的热管理和系统优化至关重要。",
            "id": "3912118",
            "problem": "考虑一个可充电电池的等效电路模型（ECM），该模型由一个串联欧姆电阻 $R_{s}$ 和 $K$ 个极化支路组成。每个极化支路 $k \\in \\{1,\\dots,K\\}$ 是一个由电阻 $R_{k}$ 和电容 $C_{k}$ 并联组成的电阻-电容（RC）网络；支路电压记为 $v_{k}(t)$。端子电流 $I(t)$ 流过 $R_{s}$ 并进入每个极化支路，其中应用基尔霍夫电流定律（KCL）。负载循环由指定时间段内的分段恒定电流曲线 $I(t)$ 描述。\n\n使用的基本定律：\n- 焦耳定律的电阻功率：对于任何瞬时电流为 $i(t)$、电阻为 $R$ 的电阻器，瞬时功耗为 $p(t) = i(t)^{2} R$，等效地，用电阻器电压 $v(t)$ 表示为 $p(t) = \\dfrac{v(t)^{2}}{R}$。\n- 电容器本构关系：对于任何电压为 $v(t)$、电容为 $C$ 的电容器，瞬时电流为 $i_{C}(t) = C \\dfrac{dv(t)}{dt}$。\n- 基尔霍夫电流定律（KCL）：进入一个节点的电流代数和为零。\n\n从这些基本定律和定义出发，推导在持续时间为 $\\Delta t$、电流为 $I(t) = I_{0}$ 的分段恒定电流段作用下，每个极化支路电压 $v_{k}(t)$ 的控制动力学方程，并从第一性原理推导以下部分的能量耗散表达式：\n- 循环中欧姆电阻 $R_{s}$ 的能量耗散，以及\n- 循环中极化电阻 $R_{k}$ 的能量耗散，\n通过对适当的瞬时功率表达式进行时间积分。明确地将总能量损失分为欧姆分量和极化分量。\n\n您必须实现一个程序，为下面的每个测试用例计算三个量：\n- $E_{\\text{ohmic}}$，单位为 $\\mathrm{J}$（焦耳），\n- $E_{\\text{polarization}}$，单位为 $\\mathrm{J}$（焦耳），\n- $E_{\\text{total}} = E_{\\text{ohmic}} + E_{\\text{polarization}}$，单位为 $\\mathrm{J}$（焦耳）。\n\n所有测试用例的假设：\n- 初始极化支路电压满足对所有 $k$ 都有 $v_{k}(0) = 0$。\n- 电阻 $R_{s}$ 和 $R_{k}$ 严格为正，单位为 $\\Omega$（欧姆）。\n- 电容 $C_{k}$ 严格为正，单位为 $\\mathrm{F}$（法拉）。\n- 持续时间严格为正，单位为 $\\mathrm{s}$（秒）。\n- 电流单位为 $\\mathrm{A}$（安培），可以为正（放电）、负（充电）或零。\n\n测试套件：\n- 测试用例 1：\n  - $R_{s} = 0.015$ $\\Omega$\n  - 极化支路：$K = 2$ 个，分别为 $(R_{1}, C_{1}) = (0.020$ $\\Omega$, $3000$ $\\mathrm{F})$，$(R_{2}, C_{2}) = (0.060$ $\\Omega$, $800$ $\\mathrm{F})$\n  - 电流段：$\\big(120$ $\\mathrm{A}, 30$ $\\mathrm{s}\\big)$，$\\big(-80$ $\\mathrm{A}, 15$ $\\mathrm{s}\\big)$，$\\big(0$ $\\mathrm{A}, 10$ $\\mathrm{s}\\big)$\n- 测试用例 2：\n  - $R_{s} = 0.005$ $\\Omega$\n  - 极化支路：$K = 1$ 个，为 $(R_{1}, C_{1}) = (0.030$ $\\Omega$, $500$ $\\mathrm{F})$\n  - 电流段：$\\big(0$ $\\mathrm{A}, 20$ $\\mathrm{s}\\big)$\n- 测试用例 3：\n  - $R_{s} = 0.020$ $\\Omega$\n  - 极化支路：$K = 3$ 个，分别为 $(R_{1}, C_{1}) = (0.010$ $\\Omega$, $1000$ $\\mathrm{F})$，$(R_{2}, C_{2}) = (0.030$ $\\Omega$, $600$ $\\mathrm{F})$，$(R_{3}, C_{3}) = (0.050$ $\\Omega$, $400$ $\\mathrm{F})$\n  - 电流段：$\\big(200$ $\\mathrm{A}, 0.1$ $\\mathrm{s}\\big)$，$\\big(-200$ $\\mathrm{A}, 0.1$ $\\mathrm{s}\\big)$，$\\big(50$ $\\mathrm{A}, 0.05$ $\\mathrm{s}\\big)$\n- 测试用例 4：\n  - $R_{s} = 0.010$ $\\Omega$\n  - 极化支路：$K = 1$ 个，为 $(R_{1}, C_{1}) = (0.050$ $\\Omega$, $2000$ $\\mathrm{F})$\n  - 电流段：$\\big(-150$ $\\mathrm{A}, 40$ $\\mathrm{s}\\big)$\n\n您的程序必须基于上述原理执行与物理一致的计算，并为每个测试用例生成以 $\\mathrm{J}$（焦耳）为单位的能量值。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔的结果列表，其中每个结果是一个包含三个浮点数的列表 $[E_{\\text{ohmic}}, E_{\\text{polarization}}, E_{\\text{total}}]$，四舍五入到六位小数。例如，生成形如 $[[e_{1,o}, e_{1,p}, e_{1,t}], [e_{2,o}, e_{2,p}, e_{2,t}], \\dots]$ 的输出，其中每个 $e_{\\cdot,\\cdot}$ 是一个以 $\\mathrm{J}$ 为单位、四舍五入到六位小数的十进制数。",
            "solution": "经评估，用户提供的问题是**有效的**。它在科学上基于标准电路理论，内部一致，问题定义明确，并包含推导唯一且有意义解所需的所有必要信息。\n\n### 基于原理的解决方案设计\n\n问题要求推导并实现一个解决方案，用于计算电池等效电路模型（ECM）中的能量损失。该模型由一个串联欧姆电阻 $R_s$ 和 $K$ 个极化支路组成。问题陈述中提到“端子电流 $I(t)$ 流过 $R_s$ 并进入每个极化支路”。这一措辞，结合推导“每个极化支路电压 $v_k(t)$”的动力学方程的要求，意味着这 $K$ 个极化支路是串联的。在这种配置下，相同的电流 $I(t)$ 流过每个支路，使得每个支路电压 $v_k(t)$ 能够根据其特定参数（$R_k, C_k$）独立演化。所有支路上的总极化电压是各个支路电压之和，即 $\\sum_{k=1}^K v_k(t)$。\n\n#### 1. 控制动力学方程的推导\n让我们考虑单个极化支路 $k$，它由一个电阻 $R_k$ 和一个电容 $C_k$ 并联组成。流入该支路的总电流为 $I(t)$。根据支路内节点的基尔霍夫电流定律（KCL），该电流分为电阻分量 $I_{R_k}(t)$ 和电容分量 $I_{C_k}(t)$：\n$$I(t) = I_{R_k}(t) + I_{C_k}(t)$$\n根据欧姆定律，通过电阻的电流为 $I_{R_k}(t) = v_k(t)/R_k$。根据电容器的本构关系，通过电容器的电流为 $I_{C_k}(t) = C_k \\frac{dv_k(t)}{dt}$。将这些代入KCL方程，得到支路 $k$ 电压 $v_k(t)$ 的一阶线性常微分方程（ODE）：\n$$I(t) = \\frac{v_k(t)}{R_k} + C_k \\frac{dv_k(t)}{dt}$$\n将此方程重排为标准形式，我们得到：\n$$\\frac{dv_k(t)}{dt} + \\frac{1}{R_k C_k} v_k(t) = \\frac{I(t)}{C_k}$$\n将支路的时间常数定义为 $\\tau_k = R_k C_k$，ODE变为：\n$$\\frac{dv_k(t)}{dt} + \\frac{1}{\\tau_k} v_k(t) = \\frac{I(t)}{C_k}$$\n问题指定了一个分段恒定电流曲线。对于一个持续时间为 $\\Delta t$ 且电流恒定为 $I(t) = I_0$ 的给定时间段，该ODE是一个带有恒定强迫项的非齐次方程。其通解是齐次解与特解之和。\n特解是稳态电压，$v_{k,ss} = I_0 R_k$。\n通解的形式为 $v_k(t) = A e^{-t/\\tau_k} + I_0 R_k$。\n给定段开始时（$t=0$时）的初始电压 $v_{k,init}$，我们可以解出常数 $A$：\n$v_{k,init} = A e^0 + I_0 R_k \\implies A = v_{k,init} - I_0 R_k$。\n因此，该段内的电压演化为：\n$$v_k(t) = (v_{k,init} - I_0 R_k) e^{-t/\\tau_k} + I_0 R_k$$\n持续时间为 $\\Delta t$ 的段结束时的电压可通过计算 $v_k(\\Delta t)$ 得到：\n$$v_{k,final} = (v_{k,init} - I_0 R_k) e^{-\\Delta t/\\tau_k} + I_0 R_k$$\n这个最终电压作为下一段的初始条件。问题陈述了所有支路的初始电压为 $v_k(0) = 0$。\n\n#### 2. 能量耗散的推导\n总能量损失 $E_{\\text{total}}$ 是 $R_s$ 中的欧姆损失 $E_{\\text{ohmic}}$ 和所有电阻 $R_k$ 上的极化损失 $E_{\\text{polarization}}$ 之和。\n\n**欧姆能量损失 ($E_{\\text{ohmic}}$)**\n串联电阻 $R_s$ 中耗散的瞬时功率由焦耳定律给出：$p_s(t) = I(t)^2 R_s$。在一个由 $M$ 个段组成的循环中，其中第 $j$ 段的电流为 $I_j$，持续时间为 $\\Delta t_j$，总耗散能量是功率的时间积分：\n$$E_{\\text{ohmic}} = \\int_{cycle} I(t)^2 R_s dt = \\sum_{j=1}^{M} \\int_{t_{j-1}}^{t_j} I_j^2 R_s dt$$\n由于在每个段内 $I_j$ 是恒定的，积分很简单：\n$$E_{\\text{ohmic}} = \\sum_{j=1}^{M} I_j^2 R_s \\Delta t_j$$\n\n**极化能量损失 ($E_{\\text{polarization}}$)**\n总极化损失是每个极化电阻 $R_k$ 中耗散能量的总和：$E_{\\text{polarization}} = \\sum_{k=1}^{K} E_{R_k}$。在整个循环中，单个电阻 $R_k$ 中耗散的能量是其瞬时功耗 $p_{R_k}(t) = v_k(t)^2 / R_k$ 的时间积分。\n$$E_{R_k} = \\int_{cycle} \\frac{v_k(t)^2}{R_k} dt = \\sum_{j=1}^{M} \\int_{0}^{\\Delta t_j} \\frac{v_{k,j}(t)^2}{R_k} dt$$\n其中 $v_{k,j}(t)$ 是第 $j$ 段期间支路 $k$ 的电压函数。让我们将单个段（电流为 $I_j$，持续时间为 $\\Delta t_j$，初始电压为 $v_{k,j,init}$）的 $v_k(t)$ 推导表达式代入积分：\n$$E_{R_k, j} = \\frac{1}{R_k} \\int_0^{\\Delta t_j} \\left[ (v_{k,j,init} - I_j R_k) e^{-t/\\tau_k} + I_j R_k \\right]^2 dt$$\n令 $A = v_{k,j,init} - I_j R_k$ 且 $B = I_j R_k$。积分变为：\n$$E_{R_k, j} = \\frac{1}{R_k} \\int_0^{\\Delta t_j} \\left( A^2 e^{-2t/\\tau_k} + 2AB e^{-t/\\tau_k} + B^2 \\right) dt$$\n逐项计算积分得到：\n$$E_{R_k, j} = \\frac{1}{R_k} \\left[ A^2 \\frac{\\tau_k}{2} (1 - e^{-2\\Delta t_j/\\tau_k}) + 2AB\\tau_k (1 - e^{-\\Delta t_j/\\tau_k}) + B^2 \\Delta t_j \\right]$$\n通过对所有支路 $k$ 和所有段 $j$ 的 $E_{R_k,j}$求和，可以找到总极化能量。\n\n#### 3. 算法实现\n程序将为一组给定的测试用例实现推导出的公式。对于每个测试用例：\n1. 初始化 $E_{\\text{ohmic}} = 0$，$E_{\\text{polarization}} = 0$，以及每个支路的初始电压 $v_{k,init} = 0$。\n2. 对于曲线中的每个电流段 $(I_j, \\Delta t_j)$：\n    a. 计算该段的欧姆能量损失 $\\Delta E_{\\text{ohmic}} = I_j^2 R_s \\Delta t_j$，并将其加到 $E_{\\text{ohmic}}$。\n    b. 对于每个极化支路 $k \\in \\{1,\\dots,K\\}$：\n        i. 使用当前段的参数（$I_j, \\Delta t_j$）和支路的当前状态（$v_{k,init}, R_k, C_k$），使用上述积分公式计算耗散的能量 $E_{R_k,j}$。将其加到 $E_{\\text{polarization}}$。\n        ii. 使用电压演化方程计算段结束时的支路电压 $v_{k,final}$。这成为下一段的初始电压：$v_{k,init} \\leftarrow v_{k,final}$。\n3. 处理完所有段后，计算总能量损失 $E_{\\text{total}} = E_{\\text{ohmic}} + E_{\\text{polarization}}$。\n4. 存储当前测试用例的三元组 $[E_{\\text{ohmic}}, E_{\\text{polarization}}, E_{\\text{total}}]$，确保最终值四舍五入到六位小数。\n5. 处理完所有测试用例后，将结果格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the battery ECM energy loss problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"Rs\": 0.015,\n            \"branches\": [(0.020, 3000), (0.060, 800)],\n            \"profile\": [(120, 30), (-80, 15), (0, 10)],\n        },\n        {\n            \"Rs\": 0.005,\n            \"branches\": [(0.030, 500)],\n            \"profile\": [(0, 20)],\n        },\n        {\n            \"Rs\": 0.020,\n            \"branches\": [(0.010, 1000), (0.030, 600), (0.050, 400)],\n            \"profile\": [(200, 0.1), (-200, 0.1), (50, 0.05)],\n        },\n        {\n            \"Rs\": 0.010,\n            \"branches\": [(0.050, 2000)],\n            \"profile\": [(-150, 40)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e_ohmic, e_polarization = calculate_energy(\n            case[\"Rs\"], case[\"branches\"], case[\"profile\"]\n        )\n        e_total = e_ohmic + e_polarization\n        results.append([\n            round(e_ohmic, 6),\n            round(e_polarization, 6),\n            round(e_total, 6),\n        ])\n\n    # Format the final output string as specified\n    result_str = \"[\" + \",\".join([str(res) for res in results]) + \"]\"\n    print(result_str.replace(\" \", \"\"))\n\ndef calculate_energy(Rs, branches, profile):\n    \"\"\"\n    Calculates ohmic and polarization energy losses for a single test case.\n\n    Args:\n        Rs (float): Ohmic series resistance in Ohms.\n        branches (list of tuples): List of (Rk, Ck) tuples for each polarization branch.\n        profile (list of tuples): List of (I, dt) tuples for each current segment.\n\n    Returns:\n        tuple: A tuple containing (E_ohmic, E_polarization) in Joules.\n    \"\"\"\n    num_branches = len(branches)\n    v_initials = np.zeros(num_branches)\n    Rk_vals = np.array([b[0] for b in branches])\n    Ck_vals = np.array([b[1] for b in branches])\n    tau_vals = Rk_vals * Ck_vals\n\n    total_e_ohmic = 0.0\n    total_e_polarization = 0.0\n\n    for I_seg, dt_seg in profile:\n        # 1. Ohmic Loss Calculation\n        e_ohmic_seg = (I_seg**2) * Rs * dt_seg\n        total_e_ohmic += e_ohmic_seg\n\n        # 2. Polarization Loss Calculation for each branch\n        v_finals = np.zeros(num_branches)\n        for k in range(num_branches):\n            Rk, Ck, tau_k = Rk_vals[k], Ck_vals[k], tau_vals[k]\n            v_init = v_initials[k]\n\n            # Calculate energy dissipated in Rk during the segment\n            # Using the direct integral of v_k(t)^2 / Rk\n            A = v_init - I_seg * Rk\n            B = I_seg * Rk\n\n            # Handle tau_k -> 0 or dt_seg/tau_k being very large/small for stability\n            # np.exp handles large negative exponents by returning 0.\n            exp_term1 = np.exp(-dt_seg / tau_k) if tau_k > 0 else 0.0\n            exp_term2 = np.exp(-2 * dt_seg / tau_k) if tau_k > 0 else 0.0\n            \n            if tau_k > 0:\n                term1 = (A**2) * (tau_k / 2.0) * (1.0 - exp_term2)\n                term2 = 2.0 * A * B * tau_k * (1.0 - exp_term1)\n                term3 = (B**2) * dt_seg\n                e_pol_seg_k = (1.0 / Rk) * (term1 + term2 + term3) if Rk > 0 else 0.0\n            else: # Pure capacitor branch (Rk -> inf) or invalid tau\n                e_pol_seg_k = 0.0\n\n            total_e_polarization += e_pol_seg_k\n\n            # Calculate final voltage for the branch at the end of the segment\n            v_final = A * exp_term1 + B\n            v_finals[k] = v_final\n        \n        v_initials = v_finals\n    \n    return total_e_ohmic, total_e_polarization\n\nsolve()\n```"
        },
        {
            "introduction": "等效电路模型不仅限于整数阶元件，高级模型常需包含描述扩散等复杂过程的 Warburg 阻抗$Z_{\\mathrm{W}}(j\\omega)$。然而，Warburg 阻抗是一个分数阶元件，无法直接在标准时域仿真器中实现。本练习将带您挑战一个高级建模课题：利用数学变换和数值近似，将一个理想的 Warburg 阻抗合成为一个有限的 RC 梯形网络，从而将频域中的复杂现象转化为可在时域中进行仿真的等效电路。",
            "id": "3912073",
            "problem": "您的任务是构建一个有限阻容 (RC) 梯形网络，用以逼近在电池的电化学阻抗建模中使用的瓦堡扩散阻抗。瓦堡阻抗用于模拟半无限扩散，是自动化电池设计和仿真中使用的等效电路模型 (ECM) 的一个标准元件。目标阻抗是频域中的瓦堡阻抗，对于角频率 $\\omega$，其复阻抗定义为 $$Z_{\\mathrm{W}}(j\\omega) = \\frac{W}{\\sqrt{j\\omega}},$$ 其中 $W$ 是瓦堡系数，单位为 $\\Omega \\cdot \\mathrm{s}^{1/2}$，$j$ 表示虚数单位。相应的导纳为 $$Y_{\\mathrm{W}}(j\\omega) = \\frac{1}{Z_{\\mathrm{W}}(j\\omega)} = \\frac{1}{W}\\sqrt{j\\omega}.$$ 您的网络必须在指定的频带 $[\\omega_{\\min}, \\omega_{\\max}]$（其中 $\\omega$ 的单位为 $\\mathrm{rad/s}$）内逼近 $Y_{\\mathrm{W}}(j\\omega)$。\n\n从一个基本出发点开始，使用适用于 $0 < \\alpha < 1$ 的分数幂的拉普拉斯域恒等式，\n$$s^{\\alpha} = \\frac{\\sin(\\alpha \\pi)}{\\pi} \\int_{0}^{\\infty} \\frac{s}{t + s}\\, t^{\\alpha - 1}\\, dt,$$\n并将其特化为 $\\alpha = \\tfrac{1}{2}$ 以获得 $s = j\\omega$ 时 $Y_{\\mathrm{W}}(s)$ 的积分表示。然后，通过对数变量代换 $t = e^{x}$，将无限积分截断到有限区间 $[x_{\\min}, x_{\\max}]$，并使用步长为 $h = (x_{\\max} - x_{\\min})/N$ 的 $N$ 个点的均匀网格上的中点法则来逼近该积分。这将产生一个形式如下的有理逼近：\n$$Y_{N}(s) = \\sum_{k=1}^{N} a_k \\frac{s}{s + p_k},$$\n其中系数 $a_k$ 和极点 $p_k > 0$ 均为严格正实数。将每一项解释为一个与其他支路并联的串联 RC 支路的导纳，对于第 $k$ 个支路，\n$$y_k(s) = \\frac{s C_k}{1 + s R_k C_k} = \\frac{1}{R_k}\\frac{s}{s + \\frac{1}{R_k C_k}},$$\n从而映射关系 $a_k = \\frac{1}{R_k}$ 和 $p_k = \\frac{1}{R_k C_k}$ 成立。利用这一点来为所有 $k \\in \\{1,\\dots,N\\}$ 合成物理元件值 $(R_k, C_k)$。\n\n您还必须推导并实现一个针对频带内绝对逼近误差的误差界，该误差界基于：\n- 积分域的截断，以及\n- 在对数变量下通过中点（梯形）法则进行的离散化。\n\n具体来说，请使用以下设计选择和界限：\n- 在原始 $t$ 变量中选择截断区间为 $t \\in [t_{\\min}, t_{\\max}]$，其中\n$$t_{\\min} = \\omega_{\\min}\\,\\varepsilon^{2}, \\qquad t_{\\max} = \\frac{\\omega_{\\max}}{\\varepsilon^{2/3}},$$\n其中 $\\varepsilon \\in (0,1)$ 是一个固定的无量纲参数。\n- 设置 $x_{\\min} = \\ln t_{\\min}$，$x_{\\max} = \\ln t_{\\max}$，以及 $h = (x_{\\max} - x_{\\min})/N$。\n- 使用中点求积节点 $x_k = x_{\\min} + \\left(k - \\tfrac{1}{2}\\right) h$，$t_k = e^{x_k}$，以及权重\n$$a_k = \\frac{h}{\\pi W}\\, t_k^{1/2}, \\qquad p_k = t_k,$$\n这将产生物理元件值\n$$R_k = \\frac{1}{a_k}, \\qquad C_k = \\frac{a_k}{p_k}.$$\n\n提供一个形式如下的绝对误差界（对 $\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]$ 一致）：\n$$\\sup_{\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]} \\left| Y_{\\mathrm{W}}(j\\omega) - Y_N(j\\omega) \\right| \\;\\le\\; \\frac{1}{\\pi W}\\left[ 2 t_{\\min}^{1/2} + \\frac{2}{3}\\,\\omega_{\\max}^{2}\\, t_{\\max}^{-3/2} \\right] \\;+\\; \\frac{C_{\\mathrm{band}}}{\\pi W}\\, e^{-\\pi^{2}/h},$$\n其中，一个与频带相关的常数的保守选择是\n$$C_{\\mathrm{band}} = 4\\, e^{x_{\\max}/2}.$$\n通过除以 $\\min_{\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]} |Y_{\\mathrm{W}}(j\\omega)| = \\frac{1}{W}\\sqrt{\\omega_{\\min}}$ 将其转换为相对误差界，得到\n$$\\mathcal{E}_{\\mathrm{rel}}(N) \\;\\le\\; \\frac{1}{\\pi \\sqrt{\\omega_{\\min}}}\\left[ 2 t_{\\min}^{1/2} + \\frac{2}{3}\\,\\omega_{\\max}^{2}\\, t_{\\max}^{-3/2} \\right] \\;+\\; \\frac{C_{\\mathrm{band}}}{\\pi \\sqrt{\\omega_{\\min}}}\\, e^{-\\pi^{2}/h}.$$\n\n实现要求：\n- 通过上述步骤，以 Foster 形式（$N$ 个串联 RC 支路的并联和）构建 $N$ 元件 RC 梯形网络。\n- 对于下方的每个测试用例，计算：\n  1. 在 $\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]$ 上的最大相对幅值误差，\n  2. 上文给出的解析相对误差界 $\\mathcal{E}_{\\mathrm{rel}}(N)$。\n- 频率 $\\omega$ 必须在具有 $M$ 个点的对数网格上进行采样，其中 $M = 512$。\n- 角频率单位使用 $\\mathrm{rad/s}$。电阻单位使用 $\\Omega$，电容单位使用法拉 (Farad)。瓦堡参数 $W$ 的单位是 $\\Omega \\cdot \\mathrm{s}^{1/2}$。输出是无量纲的相对误差。\n- 在所有计算中固定 $\\varepsilon = 10^{-2}$。\n- 所有返回的浮点数必须精确格式化到 $6$ 位小数。\n\n测试套件：\n- 用例 1：$N = 8$, $W = 1.0$, $\\omega_{\\min} = 10^{-1}$, $\\omega_{\\max} = 10^{3}$。\n- 用例 2：$N = 3$, $W = 0.5$, $\\omega_{\\min} = 1$, $\\omega_{\\max} = 10$。\n- 用例 3：$N = 16$, $W = 2.0$, $\\omega_{\\min} = 10^{-2}$, $\\omega_{\\max} = 10^{4}$。\n- 用例 4：$N = 1$, $W = 1.0$, $\\omega_{\\min} = 10$, $\\omega_{\\max} = 10^{2}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。每个测试用例的结果必须是一个双元素列表 $[e_{\\mathrm{rel}}, b_{\\mathrm{rel}}]$，其中 $e_{\\mathrm{rel}}$ 是计算出的最大相对幅值误差，$b_{\\mathrm{rel}}$ 是相对误差界 $\\mathcal{E}_{\\mathrm{rel}}(N)$。对于按顺序排列的四个测试用例，输出必须采用\n$$\\big[ [e_1,b_1], [e_2,b_2], [e_3,b_3], [e_4,b_4] \\big],$$\n的形式，所有数字都需四舍五入到恰好六位小数。",
            "solution": "问题陈述经评估有效。其科学基础在于电化学阻抗谱和数值逼近理论的原理，问题设定良好，对于给定参数有唯一且可计算的解，表述客观明确，并且信息自洽，没有缺失或矛盾之处。逼近瓦堡阻抗的程序是网络合成中的一种标准技术。因此，我们可以着手求解。\n\n目标是合成一个有限阻容 (RC) 梯形网络，其导纳 $Y_N(j\\omega)$ 在指定的角频率范围 $[\\omega_{\\min}, \\omega_{\\max}]$ 内逼近理想的瓦堡导纳 $Y_{\\mathrm{W}}(j\\omega)$。瓦堡导纳是半无限扩散的模型，由下式给出\n$$Y_{\\mathrm{W}}(j\\omega) = \\frac{1}{Z_{\\mathrm{W}}(j\\omega)} = \\frac{1}{W}\\sqrt{j\\omega}$$\n其中 $W$ 是瓦堡系数，$j$ 是虚数单位。\n\n求解过程始于所提供的、对 $0 < \\alpha < 1$ 有效的分数幂的拉普拉斯域恒等式：\n$$s^{\\alpha} = \\frac{\\sin(\\alpha \\pi)}{\\pi} \\int_{0}^{\\infty} \\frac{s}{t + s}\\, t^{\\alpha - 1}\\, dt$$\n通过设定 $\\alpha = 1/2$ 并注意到 $\\sin(\\pi/2) = 1$，我们得到 $s^{1/2}$ 的积分表示：\n$$s^{1/2} = \\frac{1}{\\pi} \\int_{0}^{\\infty} \\frac{s}{t + s} t^{-1/2} dt$$\n将此代入瓦堡导纳的表达式中，并令 $s = j\\omega$，我们得到：\n$$Y_{\\mathrm{W}}(s) = \\frac{s^{1/2}}{W} = \\frac{1}{\\pi W} \\int_{0}^{\\infty} \\frac{s}{s+t} t^{-1/2} dt$$\n这表示导纳是一系列基本阻抗项的连续并联组合。为了获得一个有限网络，需要对该积分进行逼近。\n\n首先，应用对数变量代换 $t = e^{x}$（这意味着 $dt = e^x dx$）。这将积分域从 $t$ 的 $(0, \\infty)$ 变换为 $x$ 的 $(-\\infty, \\infty)$：\n$$Y_{\\mathrm{W}}(s) = \\frac{1}{\\pi W} \\int_{-\\infty}^{\\infty} \\frac{s}{s + e^x} (e^x)^{-1/2} e^x dx = \\frac{1}{\\pi W} \\int_{-\\infty}^{\\infty} \\frac{s}{s + e^x} e^{x/2} dx$$\n其次，将无限积分截断到有限区间 $[x_{\\min}, x_{\\max}]$。截断边界由指定的频带 $[\\omega_{\\min}, \\omega_{\\max}]$ 和一个固定参数 $\\varepsilon = 10^{-2}$ 确定：\n$$t_{\\min} = \\omega_{\\min}\\,\\varepsilon^{2}, \\qquad t_{\\max} = \\frac{\\omega_{\\max}}{\\varepsilon^{2/3}}$$\n$$x_{\\min} = \\ln t_{\\min}, \\qquad x_{\\max} = \\ln t_{\\max}$$\n第三，使用中点求积法则在 $N$ 个点的均匀网格上逼近所得的定积分。网格间距为 $h = (x_{\\max} - x_{\\min})/N$，中点节点为 $x_k = x_{\\min} + (k - 1/2)h$，其中 $k \\in \\{1, 2, \\dots, N\\}$。积分逼近变为一个有限和：\n$$Y_{N}(s) \\approx \\frac{1}{\\pi W} \\sum_{k=1}^{N} h \\cdot \\left( \\frac{s}{s + e^{x_k}} e^{x_k/2} \\right)$$\n该表达式可以重排为 Foster 范式，它表示 $N$ 个电路支路的并联：\n$$Y_{N}(s) = \\sum_{k=1}^{N} \\left( \\frac{h e^{x_k/2}}{\\pi W} \\right) \\frac{s}{s + e^{x_k}}$$\n和中的每一项都具有 $y_k(s) = a_k \\frac{s}{s+p_k}$ 的形式，这是一个串联 RC 电路的导纳，即 $y_k(s) = \\frac{1}{R_k}\\frac{s}{s + 1/(R_kC_k)}$。通过直接比较，我们可以确定系数 $a_k$ 和极点 $p_k$：\n$$a_k = \\frac{h e^{x_k/2}}{\\pi W} = \\frac{h \\sqrt{t_k}}{\\pi W}, \\qquad p_k = e^{x_k} = t_k$$\n其中 $t_k = e^{x_k}$。然后，通过以下映射确定每个并联支路的物理电阻 $R_k$ 和电容 $C_k$：\n$$R_k = \\frac{1}{a_k} = \\frac{\\pi W}{h \\sqrt{t_k}}, \\qquad C_k = \\frac{a_k}{p_k} = \\frac{h \\sqrt{t_k}}{\\pi W t_k} = \\frac{h}{\\pi W \\sqrt{t_k}}$$\n指定的任务涉及为每个测试用例计算两个误差度量：一个数值计算的最大相对误差和一个解析推导的相对误差界。\n\n1. 最大相对幅值误差 $e_{\\mathrm{rel}}$ 通过对频带进行采样来找到。从 $\\omega_{\\min}$ 到 $\\omega_{\\max}$ 创建一个包含 $M=512$ 个频率 $\\omega_i$ 的对数网格。在每个频率点，计算精确的复导纳 $Y_{\\mathrm{W}}(j\\omega_i)$ 和近似的复导纳 $Y_N(j\\omega_i)$。每个频率的相对误差为 $\\left| (Y_N(j\\omega_i) - Y_{\\mathrm{W}}(j\\omega_i)) / Y_{\\mathrm{W}}(j\\omega_i) \\right|$。这些值在整个网格上的最大值即为 $e_{\\mathrm{rel}}$。\n\n2. 解析相对误差界 $b_{\\mathrm{rel}}$ 使用提供的公式 $\\mathcal{E}_{\\mathrm{rel}}(N)$ 计算，该公式通过将绝对误差界除以频带上精确导纳的最小幅值 $|Y_{\\mathrm{W,min}}| = |\\frac{1}{W}\\sqrt{j\\omega_{\\min}}| = \\frac{\\sqrt{\\omega_{\\min}}}{W}$ 来进行归一化：\n$$\\mathcal{E}_{\\mathrm{rel}}(N) \\le \\frac{1}{\\pi \\sqrt{\\omega_{\\min}}}\\left[ 2 \\sqrt{t_{\\min}} + \\frac{2}{3}\\,\\omega_{\\max}^{2}\\, t_{\\max}^{-3/2} \\right] + \\frac{C_{\\mathrm{band}}}{\\pi \\sqrt{\\omega_{\\min}}}\\, e^{-\\pi^{2}/h}$$\n与频带相关的常数由 $C_{\\mathrm{band}} = 4e^{x_{\\max}/2}$ 给出。这个界限结合了截断积分产生的误差和数值求积产生的误差。\n\n对于给定的测试用例 $(N, W, \\omega_{\\min}, \\omega_{\\max})$，总体算法如下：\n1. 定义常数 $\\varepsilon = 10^{-2}$ 和 $M=512$。\n2. 计算截断限 $t_{\\min}$ 和 $t_{\\max}$，以及它们的对数 $x_{\\min}$ 和 $x_{\\max}$。\n3. 计算网格间距 $h = (x_{\\max} - x_{\\min})/N$。\n4. 确定极点 $p_k=t_k$ 和系数 $a_k$，其中 $k=1, \\dots, N$。\n5. 生成频率向量 $\\omega$（大小为 $M$）和相应的复频率向量 $s=j\\omega$。\n6. 计算精确导纳向量 $Y_{\\mathrm{W}}(s) = s^{1/2}/W$。\n7. 计算近似导纳向量 $Y_N(s) = \\sum_{k=1}^N a_k \\frac{s}{s+p_k}$。\n8. 计算 $e_{\\mathrm{rel}}$ 作为 $Y_N(s)$ 和 $Y_{\\mathrm{W}}(s)$ 之间元素级相对误差的幅值的最大值。\n9. 通过评估 $\\mathcal{E}_{\\mathrm{rel}}(N)$ 的公式计算 $b_{\\mathrm{rel}}$。\n10. 将得到的结果对 $[e_{\\mathrm{rel}}, b_{\\mathrm{rel}}]$ 格式化为 6 位小数。\n对所有测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs an RC ladder approximation for the Warburg impedance and computes\n    its numerical error and analytical error bound for a set of test cases.\n    \"\"\"\n    \n    # --- Test suite as specified in the problem ---\n    test_cases = [\n        # (N, W, w_min, w_max)\n        (8, 1.0, 1e-1, 1e3),\n        (3, 0.5, 1.0, 10.0),\n        (16, 2.0, 1e-2, 1e4),\n        (1, 1.0, 10.0, 1e2),\n    ]\n\n    # --- Fixed parameters ---\n    EPSILON = 1e-2  # Dimensionless parameter for truncation\n    M = 512         # Number of frequency points for error calculation\n\n    results = []\n    \n    for case in test_cases:\n        N, W, w_min, w_max = case\n\n        # --- Step 1: Compute truncation and grid parameters ---\n        t_min = w_min * EPSILON**2\n        t_max = w_max / EPSILON**(2/3)\n        \n        x_min = np.log(t_min)\n        x_max = np.log(t_max)\n        \n        # Handle the case N=0 to avoid division by zero, although not in tests.\n        if N > 0:\n            h = (x_max - x_min) / N\n        else:\n            h = np.inf # To make discretization error zero if N=0\n\n        # --- Step 2: Compute coefficients a_k and poles p_k ---\n        k_vals = np.arange(1, N + 1)\n        x_k = x_min + (k_vals - 0.5) * h\n        t_k = np.exp(x_k)\n        \n        poles_p_k = t_k\n        coeffs_a_k = (h * np.sqrt(poles_p_k)) / (np.pi * W)\n        \n        # --- Step 3: Compute maximum relative magnitude error numerically ---\n        # Create a logarithmic frequency grid\n        omega_vec = np.logspace(np.log10(w_min), np.log10(w_max), M)\n        s_vec = 1j * omega_vec\n        \n        # Calculate exact Warburg admittance Y_W\n        Y_W = np.sqrt(s_vec) / W\n        \n        # Calculate approximate admittance Y_N using NumPy broadcasting\n        if N > 0:\n            s_col = s_vec[:, np.newaxis]          # Shape (M, 1)\n            a_k_row = coeffs_a_k[np.newaxis, :]   # Shape (1, N)\n            p_k_row = poles_p_k[np.newaxis, :]    # Shape (1, N)\n            \n            # Each term is y_k(s) evaluated for all s and all k\n            Y_N_terms = a_k_row * s_col / (s_col + p_k_row)\n            # Sum over the k branches (axis=1)\n            Y_N = np.sum(Y_N_terms, axis=1)\n        else:\n            Y_N = np.zeros_like(Y_W)\n\n        # Calculate relative error and find the maximum\n        # Add a small number to the denominator to avoid division by zero if Y_W is zero\n        relative_error_vec = np.abs((Y_N - Y_W) / (Y_W + 1e-18))\n        e_rel = np.max(relative_error_vec) if N > 0 else np.max(np.abs(Y_W)/ (np.abs(Y_W) + 1e-18))\n        \n        # --- Step 4: Compute the analytical relative error bound ---\n        C_band = 4.0 * np.exp(x_max / 2.0)\n\n        # Truncation error component\n        term_trunc_abs = (1.0 / (np.pi * W)) * (2.0 * np.sqrt(t_min) + (2.0 / 3.0) * w_max**2 * t_max**(-1.5))\n        \n        # Discretization error component\n        if N > 0:\n            term_disc_abs = (C_band / (np.pi * W)) * np.exp(-np.pi**2 / h)\n        else:\n            term_disc_abs = 0.0\n\n        abs_error_bound = term_trunc_abs + term_disc_abs\n        \n        # Normalize to get relative error bound\n        min_Y_W_mag = (1.0 / W) * np.sqrt(w_min)\n        b_rel = abs_error_bound / min_Y_W_mag\n        \n        results.append((e_rel, b_rel))\n\n    # --- Final Output Formatting ---\n    # Format each result pair as \"[e_rel,b_rel]\" with 6 decimal places\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    \n    # Join the formatted pairs with commas and enclose in brackets\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}