{
    "hands_on_practices": [
        {
            "introduction": "Understanding structural identifiability begins with analyzing the model's mathematical structure itself. This foundational exercise guides you through an analytical derivation for a common two-RC-branch equivalent circuit model used in electrochemical impedance spectroscopy. By exploring the relationship between the model parameters and the observable impedance spectrum, you will uncover inherent ambiguities and prove that distinct parameter sets can yield identical model outputs, a key hallmark of structural non-identifiability .",
            "id": "3936955",
            "problem": "A lithium-ion cell is modeled for electrochemical impedance spectroscopy using a linear equivalent circuit composed of a series ohmic resistance and two parallel resistor-capacitor branches in series. The series element has resistance $R_0$. The two branches are $(R_1 \\parallel C_1)$ and $(R_2 \\parallel C_2)$, where $\\parallel$ denotes a parallel connection. Let the complex frequency be $s$ with $s = \\mathrm{j} \\omega$ and $\\mathrm{j}^2 = -1$, and define the branch time constants $\\tau_1 = R_1 C_1$ and $\\tau_2 = R_2 C_2$. The impedance of an ideal resistor is $Z_R(s) = R$, and the impedance of an ideal capacitor is $Z_C(s) = 1/(s C)$. Using Kirchhoff’s laws and linear time-invariant network composition rules, the overall impedance $Z(s)$ is determined by $(R_0, R_1, C_1, R_2, C_2)$ for all real $\\omega$.\n\nYou are given that the impedance is measured perfectly over all real angular frequencies, so that $Z(s)$ is known exactly as a complex analytic function on the imaginary axis. Starting only from the above fundamental laws and definitions, do the following:\n\n1. Derive $Z(s)$ in rational form with real coefficients in $s$ expressed in terms of $(R_0, R_1, \\tau_1, R_2, \\tau_2)$.\n2. Prove that there exist distinct parameter tuples $(R_0, R_1, \\tau_1, R_2, \\tau_2)$ and $(R_0, \\tilde{R}_1, \\tilde{\\tau}_1, \\tilde{R}_2, \\tilde{\\tau}_2)$ that produce identical $Z(s)$ for all real $\\omega$ by identifying algebraic invariants of the mapping from parameters to $Z(s)$.\n3. Show that when $\\tau_1 \\neq \\tau_2$, the only nontrivial indistinguishability is permutation of the two branches, whereas when $\\tau_1 = \\tau_2$ there is a nontrivial continuum of indistinguishable parameterizations with the same spectrum. Explicitly characterize, in terms of algebraic equalities, the set of all parameter tuples that produce a given $Z(s)$.\n\nAnswer specification: Provide, as your final answer, a single row vector giving a complete set of algebraic invariants of the parameter-to-impedance map that classify the equivalence classes under the relation “produce identical $Z(s)$ for all real $\\omega$.” Express your answer symbolically in terms of $(R_0, R_1, \\tau_1, R_2, \\tau_2)$. Do not include units. If you choose an equivalent but different invariant generating set, it must be algebraically complete and minimal with respect to recovering $Z(s)$ as a rational function up to identical spectra, and it must be expressed as a single closed-form expression.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It presents a standard problem in system identification applied to a common electrochemical model. All necessary information is provided, and the questions are specific and mathematically rigorous. Therefore, the problem is deemed valid and a full solution is provided below.\n\n### 1. Derivation of the Impedance Function $Z(s)$\nThe electrochemical impedance model consists of a series resistor with resistance $R_0$ and two series-connected parallel resistor-capacitor (RC) branches, $(R_1 \\parallel C_1)$ and $(R_2 \\parallel C_2)$.\n\nThe impedance of a resistor $R$ is $Z_R(s) = R$.\nThe impedance of a capacitor $C$ is $Z_C(s) = \\frac{1}{sC}$.\nThe complex frequency is $s = \\mathrm{j} \\omega$.\n\nThe impedance of the first parallel RC branch, $Z_1(s)$, is given by:\n$$Z_1(s) = \\frac{1}{\\frac{1}{Z_{R_1}(s)} + \\frac{1}{Z_{C_1}(s)}} = \\frac{1}{\\frac{1}{R_1} + sC_1} = \\frac{R_1}{1 + sR_1C_1}$$\nUsing the definition of the time constant $\\tau_1 = R_1 C_1$, this becomes:\n$$Z_1(s) = \\frac{R_1}{1 + s\\tau_1}$$\nSimilarly, the impedance of the second parallel RC branch, $Z_2(s)$, is:\n$$Z_2(s) = \\frac{R_2}{1 + s\\tau_2}$$\nwhere $\\tau_2 = R_2 C_2$.\n\nThe total impedance $Z(s)$ is the sum of the impedances of the components in series:\n$$Z(s) = Z_{R_0}(s) + Z_1(s) + Z_2(s) = R_0 + \\frac{R_1}{1 + s\\tau_1} + \\frac{R_2}{1 + s\\tau_2}$$\nTo express $Z(s)$ as a rational function, we combine the terms over a common denominator:\n$$Z(s) = R_0 \\frac{(1 + s\\tau_1)(1 + s\\tau_2)}{(1 + s\\tau_1)(1 + s\\tau_2)} + \\frac{R_1(1 + s\\tau_2)}{(1 + s\\tau_1)(1 + s\\tau_2)} + \\frac{R_2(1 + s\\tau_1)}{(1 + s\\tau_1)(1 + s\\tau_2)}$$\n$$Z(s) = \\frac{R_0(1 + s\\tau_1)(1 + s\\tau_2) + R_1(1 + s\\tau_2) + R_2(1 + s\\tau_1)}{(1 + s\\tau_1)(1 + s\\tau_2)}$$\nExpanding the numerator and the denominator polynomials in powers of $s$:\nThe denominator is:\n$$Q(s) = (1 + s\\tau_1)(1 + s\\tau_2) = 1 + s(\\tau_1 + \\tau_2) + s^2(\\tau_1\\tau_2)$$\nThe numerator is:\n$$P(s) = R_0(1 + s(\\tau_1 + \\tau_2) + s^2\\tau_1\\tau_2) + R_1 + sR_1\\tau_2 + R_2 + sR_2\\tau_1$$\n$$P(s) = (R_0 + R_1 + R_2) + s(R_0(\\tau_1 + \\tau_2) + R_1\\tau_2 + R_2\\tau_1) + s^2(R_0\\tau_1\\tau_2)$$\nThus, the rational form of $Z(s)$ is:\n$$Z(s) = \\frac{(R_0\\tau_1\\tau_2)s^2 + (R_0(\\tau_1 + \\tau_2) + R_1\\tau_2 + R_2\\tau_1)s + (R_0 + R_1 + R_2)}{(\\tau_1\\tau_2)s^2 + (\\tau_1 + \\tau_2)s + 1}$$\nThe coefficients of the polynomials are real and expressed in terms of the parameter set $(R_0, R_1, \\tau_1, R_2, \\tau_2)$.\n\n### 2. Parameter Indistinguishability and Algebraic Invariants\nWe assume that $Z(s)$ is known exactly, which means the coefficients of the rational function are known. Let us write $Z(s) = \\frac{a_2 s^2 + a_1 s + a_0}{b_2 s^2 + b_1 s + 1}$. By comparing with the derived expression, we identify the following relationships between the five model parameters $(R_0, R_1, R_2, \\tau_1, \\tau_2)$ and the five observable coefficients $(a_0, a_1, a_2, b_1, b_2)$:\n\\begin{align*}\nb_1 &= \\tau_1 + \\tau_2 \\\\\nb_2 &= \\tau_1\\tau_2 \\\\\na_0 &= R_0 + R_1 + R_2 \\\\\na_1 &= R_0(\\tau_1 + \\tau_2) + R_1\\tau_2 + R_2\\tau_1 \\\\\na_2 &= R_0\\tau_1\\tau_2\n\\end{align*}\nFrom these equations, we can attempt to solve for the model parameters.\nFrom the coefficients of the denominator, $b_1$ and $b_2$ are the elementary symmetric polynomials in $\\tau_1$ and $\\tau_2$. This means $\\tau_1$ and $\\tau_2$ are the two roots of the quadratic equation $x^2 - b_1 x + b_2 = 0$. The set of time constants $\\{\\tau_1, \\tau_2\\}$ is uniquely determined, but we cannot distinguish $\\tau_1$ from $\\tau_2$.\nFrom the coefficients $a_2$ and $b_2$, we can uniquely determine $R_0$:\n$$R_0 = \\frac{a_2}{b_2} = \\frac{R_0\\tau_1\\tau_2}{\\tau_1\\tau_2}$$\nThis identification is unique, assuming $\\tau_1, \\tau_2 \\neq 0$, which is physically required for the model to be second-order.\n\nNow, consider the remaining equations for $R_1$ and $R_2$:\n$$R_1 + R_2 = a_0 - R_0$$\n$$R_1\\tau_2 + R_2\\tau_1 = a_1 - R_0(\\tau_1+\\tau_2) = a_1 - R_0 b_1$$\nThis is a linear system for $(R_1, R_2)$. The determinant of the coefficient matrix is $\\tau_1 - \\tau_2$.\n\nThe indistinguishability arises from the permutation symmetry of the two RC branches. The expression $Z(s) = R_0 + \\frac{R_1}{1 + s\\tau_1} + \\frac{R_2}{1 + s\\tau_2}$ is invariant under the simultaneous exchange of the pair $(R_1, \\tau_1)$ with $(R_2, \\tau_2)$.\nThis means the parameter tuple $(R_0, R_1, \\tau_1, R_2, \\tau_2)$ is empirically indistinguishable from the tuple $(R_0, R_2, \\tau_2, R_1, \\tau_1)$. If $(R_1, \\tau_1) \\neq (R_2, \\tau_2)$, these two tuples are distinct, proving that there exist distinct parameter sets that produce an identical impedance function $Z(s)$.\n\n### 3. Characterization of Equivalence Classes\n\n**Case 1: $\\tau_1 \\neq \\tau_2$ (Distinct Time Constants)**\nWhen $\\tau_1 \\neq \\tau_2$, the poles of the impedance function at $s = -1/\\tau_1$ and $s = -1/\\tau_2$ are distinct. The determinant of the linear system for $(R_1, R_2)$ is non-zero, yielding a unique solution for $(R_1, R_2)$ for a given choice of which time constant is $\\tau_1$ and which is $\\tau_2$.\nLet's choose an assignment, say $(\\tau_a, \\tau_b)$, for the two roots of $x^2 - b_1 x + b_2 = 0$.\nThe system becomes:\n$$R_1 + R_2 = S_R \\equiv a_0 - R_0$$\n$$R_1\\tau_b + R_2\\tau_a = P_R \\equiv a_1 - R_0 b_1$$\nSolving this gives a unique pair $(R_1, R_2)$.\nIf we then swap our assignment to $(\\tau_b, \\tau_a)$, the second equation becomes $R_1\\tau_a + R_2\\tau_b = P_R$. This new system yields a solution where the values of $R_1$ and $R_2$ are swapped.\nTherefore, if $\\tau_1 \\neq \\tau_2$, there are exactly two parameter tuples that produce the same $Z(s)$:\n$$(R_0, R_1, \\tau_1, R_2, \\tau_2) \\quad \\text{and} \\quad (R_0, R_2, \\tau_2, R_1, \\tau_1)$$\nThe only nontrivial indistinguishability is the permutation of the two distinct branches.\n\n**Case 2: $\\tau_1 = \\tau_2 = \\tau$ (Identical Time Constants)**\nIf $\\tau_1 = \\tau_2 = \\tau$, the model degenerates. The impedance function becomes:\n$$Z(s) = R_0 + \\frac{R_1}{1 + s\\tau} + \\frac{R_2}{1 + s\\tau} = R_0 + \\frac{R_1 + R_2}{1 + s\\tau}$$\nIn this form, the observable parameters from the impedance spectrum are $R_0$, the time constant $\\tau$, and the sum of the branch resistances $R_{sum} = R_1 + R_2$. The individual values of $R_1$ and $R_2$ are not identifiable.\nAny pair of parameters $(R_1, R_2)$ such that $R_1 + R_2 = R_{sum}$ (and $R_1 > 0, R_2 > 0$) will produce the same impedance function, assuming they share the same time constant $\\tau$. This defines a continuous one-parameter family of equivalent models, forming a continuum of indistinguishable parameterizations. For a given total resistance $R_{sum}$, we can choose any $R_1 \\in (0, R_{sum})$, and set $R_2 = R_{sum} - R_1$. This gives a valid parameter set $(R_0, R_1, \\tau, R_{sum}-R_1, \\tau)$ that is indistinguishable from any other such choice.\n\n### Complete Set of Algebraic Invariants\nTwo parameter tuples are equivalent if and only if they generate the same impedance function $Z(s)$. This is equivalent to them generating the same set of coefficients $(a_0, a_1, a_2, b_1, b_2)$. We seek a minimal and complete set of functions of the original parameters $(R_0, R_1, \\tau_1, R_2, \\tau_2)$ that uniquely determine these coefficients. These functions form a basis for the invariants of the parameter-to-impedance map.\nAs shown in section 2, the coefficients themselves can be expressed as functions of five key combinations of the original parameters. These combinations are invariant under the permutation of the branches, and they are sufficient to reconstruct $Z(s)$.\nA complete and minimal set of such algebraic invariants is:\n1.  $I_1 = R_0$: Identifies the high-frequency resistance.\n2.  $I_2 = \\tau_1 + \\tau_2$: The sum of the time constants.\n3.  $I_3 = \\tau_1\\tau_2$: The product of the time constants.\n4.  $I_4 = R_1 + R_2$: The sum of the branch resistances.\n5.  $I_5 = R_1\\tau_2 + R_2\\tau_1$: A weighted sum coupling resistances and time constants.\n\nThese five quantities are uniquely determined from the impedance spectrum. Any two parameter sets $(R_0, R_1, \\tau_1, R_2, \\tau_2)$ and $(R'_0, R'_1, \\tau'_1, R'_2, \\tau'_2)$ produce the same impedance function if and only if these five invariants have the same value for both sets. This set of five functions of the parameters, therefore, completely classifies the equivalence classes. The final answer is the row vector composed of these five expressions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nR_0 & \\tau_1 + \\tau_2 & \\tau_1 \\tau_2 & R_1 + R_2 & R_1 \\tau_2 + R_2 \\tau_1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After performing a parameter estimation, the resulting parameter covariance matrix is a rich source of diagnostic information. This computational practice focuses on post-estimation analysis, teaching you how to translate covariance into the more intuitive correlation matrix to identify pairs of parameters that are difficult to estimate independently. You will also use the rank of the covariance matrix as a numerical check for structural identifiability, connecting the theoretical properties of a model to the practical outcomes of an experiment .",
            "id": "3936947",
            "problem": "You are given an Equivalent Circuit Model (ECM) of a battery with two Resistor–Capacitor (RC) branches and an ohmic resistance. The parameter vector is ordered as $\\boldsymbol{\\theta} = [R_0, R_1, C_1, R_2, C_2]^\\top$, where $R_0$ is the ohmic resistance, $(R_1,C_1)$ are the resistance and capacitance of the first RC branch, and $(R_2,C_2)$ are the resistance and capacitance of the second RC branch. Assume that a system identification procedure has produced an unbiased estimate of the parameter covariance matrix $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{5 \\times 5}$ under additive, zero-mean, Gaussian measurement noise. Your task is to implement a program that, for each provided test covariance matrix:\n- constructs the parameter correlation matrix through a mathematically principled normalization,\n- identifies all parameter index pairs that are \"near-dependent\" according to a threshold on absolute correlation,\n- and assesses structural identifiability at the linearized level by a rank test on the information contained in $\\boldsymbol{\\Sigma}$.\n\nYou must begin from fundamental definitions of covariance and correlation, not from a shortcut formula. Treat any zero-variance diagonal elements carefully: if $[\\boldsymbol{\\Sigma}]_{ii} = 0$ or $[\\boldsymbol{\\Sigma}]_{jj} = 0$, then the corresponding correlation entries involving indices $i$ or $j$ are undefined by normalization; in your implementation, set such undefined correlation values to $0$ and do not flag pairs that involve undefined correlations.\n\nNear-dependence threshold: Let the correlation threshold be $\\tau = 0.95$. A parameter pair $(i,j)$ with $i<j$ is deemed near-dependent if the absolute value of its correlation exceeds or equals $\\tau$. Structural identifiability for this problem should be assessed by a numerical rank test: if the covariance $\\boldsymbol{\\Sigma}$ is full rank (equal to the parameter dimension), declare the parameterization structurally identifiable; otherwise declare it structurally non-identifiable.\n\nTest suite:\n- Case $1$ (happy path): covariance matrix\n$$\n\\boldsymbol{\\Sigma}^{(1)} =\n\\begin{bmatrix}\n0.0001 & 0.00002 & -0.1 & 0.000003 & 0.0 \\\\\n0.00002 & 0.0004 & 3.88 & 0.000015 & -0.072 \\\\\n-0.1 & 3.88 & 40000.0 & 0.0 & 360.0 \\\\\n0.000003 & 0.000015 & 0.0 & 0.000225 & -2.16 \\\\\n0.0 & -0.072 & 360.0 & -2.16 & 32400.0\n\\end{bmatrix}.\n$$\n- Case $2$ (boundary with zero variance): covariance matrix\n$$\n\\boldsymbol{\\Sigma}^{(2)} =\n\\begin{bmatrix}\n0.000064 & 0.000006 & -0.024 & 0.0 & 0.0 \\\\\n0.000006 & 0.000225 & 2.025 & 0.0 & -0.18 \\\\\n-0.024 & 2.025 & 22500.0 & 0.0 & -12600.0 \\\\\n0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\\\\n0.0 & -0.18 & -12600.0 & 0.0 & 14400.0\n\\end{bmatrix}.\n$$\n- Case $3$ (edge with near-perfect correlations): covariance matrix\n$$\n\\boldsymbol{\\Sigma}^{(3)} =\n\\begin{bmatrix}\n0.000144 & 0.00003 & 0.264 & 0.0 & 0.0 \\\\\n0.00003 & 0.000625 & 5.4725 & -0.000025 & 0.0 \\\\\n0.264 & 5.4725 & 48400.0 & -0.44 & 2200.0 \\\\\n0.0 & -0.000025 & -0.44 & 0.0004 & -3.98 \\\\\n0.0 & 0.0 & 2200.0 & -3.98 & 40000.0\n\\end{bmatrix}.\n$$\n\nParameter index convention: $0 \\mapsto R_0$, $1 \\mapsto R_1$, $2 \\mapsto C_1$, $3 \\mapsto R_2$, $4 \\mapsto C_2$.\n\nProgram requirements:\n- For each test case $\\boldsymbol{\\Sigma}^{(k)}$, compute the correlation matrix, then list all index pairs $[i,j]$ with $i<j$ that satisfy $\\lvert \\text{corr}(i,j) \\rvert \\ge \\tau$, using the zero-based parameter indices above.\n- Assess structural identifiability by checking whether $\\boldsymbol{\\Sigma}^{(k)}$ has full numerical rank equal to $5$.\n- The output for each test case must be a list of the identified index pairs (each pair represented as a two-element list of integers) and a boolean indicating structural identifiability. Therefore, each test case result must have the form $[\\,[i_1,j_1],\\,[i_2,j_2],\\dotsc\\,],\\,\\text{boolean}$.\n- Final output format: Your program should produce a single line containing the results for the three cases as a comma-separated list enclosed in square brackets, i.e., $[\\,\\text{result}_1,\\,\\text{result}_2,\\,\\text{result}_3\\,]$.\n\nAll numerical computations are dimensionless for correlation and boolean checks, so no physical units need to be reported in the output. Use $i<j$ ordering for pairs and do not repeat symmetric pairs.\n\nYour solution must strictly adhere to the execution environment and output format constraints and must not read any input.",
            "solution": "The problem requires an analysis of parameter identifiability for a 5-parameter Equivalent Circuit Model (ECM) of a battery, based on a given parameter covariance matrix $\\boldsymbol{\\Sigma}$. The analysis involves three main steps for each provided matrix: (1) calculating the parameter correlation matrix, (2) identifying pairs of parameters that are nearly linearly dependent, and (3) assessing structural identifiability through a rank test of the covariance matrix.\n\nLet the parameter vector be $\\boldsymbol{\\theta} = [\\theta_0, \\theta_1, \\theta_2, \\theta_3, \\theta_4]^\\top$, corresponding to $[R_0, R_1, C_1, R_2, C_2]^\\top$. The covariance matrix $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{5 \\times 5}$ provides information about the uncertainty and interdependence of the estimated parameters. The element $\\Sigma_{ij}$ represents the covariance between parameters $\\theta_i$ and $\\theta_j$. The diagonal elements $\\Sigma_{ii}$ represent the variance of each parameter $\\theta_i$, denoted $\\sigma_i^2$.\n\n**1. Correlation Matrix Calculation**\n\nThe Pearson correlation coefficient $\\rho_{ij}$ between two parameters $\\theta_i$ and $\\theta_j$ is a normalized measure of their linear relationship. It is derived from the covariance $\\Sigma_{ij}$ by normalizing with the standard deviations of the respective parameters. The standard deviation of parameter $\\theta_i$ is $\\sigma_i = \\sqrt{\\Sigma_{ii}}$.\n\nThe correlation $\\rho_{ij}$ is defined as:\n$$\n\\rho_{ij} = \\frac{\\text{cov}(\\theta_i, \\theta_j)}{\\sigma_i \\sigma_j} = \\frac{\\Sigma_{ij}}{\\sqrt{\\Sigma_{ii}} \\sqrt{\\Sigma_{jj}}}\n$$\nThe resulting correlation matrix $\\mathbf{P}$ is a symmetric matrix with elements $\\rho_{ij}$, where $\\rho_{ii} = 1$.\n\nA critical consideration arises when a parameter has zero variance, i.e., $\\Sigma_{ii} = 0$. This implies the parameter was perfectly determined or fixed, and its standard deviation $\\sigma_i$ is $0$. In this case, the denominator in the correlation formula becomes zero, rendering the correlation coefficient mathematically undefined. The problem specifies a practical handling for this case: if either $\\Sigma_{ii}=0$ or $\\Sigma_{jj}=0$, the corresponding correlation $\\rho_{ij}$ should be set to $0$. This ensures that such pairs are not flagged for near-dependence.\n\nIn matrix notation, the correlation matrix $\\mathbf{P}$ can be computed from the covariance matrix $\\boldsymbol{\\Sigma}$ using a diagonal scaling matrix. Let $\\mathbf{S}$ be a diagonal matrix whose entries are the inverse of the standard deviations:\n$$\nS_{ii} = \\begin{cases} 1/\\sigma_i = 1/\\sqrt{\\Sigma_{ii}} & \\text{if } \\Sigma_{ii} > 0 \\\\ 0 & \\text{if } \\Sigma_{ii} = 0 \\end{cases}\n$$\nThe correlation matrix is then given by:\n$$\n\\mathbf{P} = \\mathbf{S} \\boldsymbol{\\Sigma} \\mathbf{S}\n$$\nThis operation correctly populates the correlation matrix, setting to zero any rows and columns corresponding to parameters with zero variance.\n\n**2. Near-Dependence Identification**\n\nHigh correlation between two parameters (i.e., $|\\rho_{ij}|$ close to $1$) indicates a strong linear relationship. This is a common issue in system identification, known as multicollinearity or practical non-identifiability. It suggests that the parameters cannot be estimated independently; a change in one can be compensated by a linear change in the other, without significantly affecting the model output. This makes the parameter estimates sensitive and unreliable.\n\nThe problem defines a \"near-dependent\" pair $(i,j)$ as one whose absolute correlation $|\\rho_{ij}|$ exceeds a given threshold $\\tau$. The specified threshold is $\\tau = 0.95$. The analysis involves iterating through all unique parameter pairs $(i,j)$ with $i<j$ (to avoid duplicate and diagonal entries) and checking if:\n$$\n|\\rho_{ij}| \\ge 0.95\n$$\nAll pairs satisfying this condition are collected.\n\n**3. Structural Identifiability Assessment**\n\nStructural identifiability is a property of the model structure and the experimental design, determining whether it is theoretically possible to uniquely determine the model parameters from noise-free data. A lack of structural identifiability means that different parameter sets yield the exact same model output.\n\nIn the context of parameter estimation and the resulting covariance matrix, we can assess a related concept at the linearized level. The parameter covariance matrix $\\boldsymbol{\\Sigma}$ is asymptotically related to the inverse of the Fisher Information Matrix (FIM), i.e., $\\boldsymbol{\\Sigma} \\propto (\\text{FIM})^{-1}$. A structurally non-identifiable model leads to a singular FIM. Consequently, the covariance matrix would be singular or \"infinite\" in certain directions in the parameter space.\n\nA finite, rank-deficient covariance matrix $\\boldsymbol{\\Sigma}$ obtained from an estimation procedure is a strong indicator of non-identifiability. A rank deficiency, $\\text{rank}(\\boldsymbol{\\Sigma}) < n$ where $n=5$ is the number of parameters, implies that some linear combination of parameters has zero variance. This means the data provide no information to resolve that combination, which is a manifestation of non-identifiability. Therefore, the problem specifies a numerical rank test on $\\boldsymbol{\\Sigma}$:\n- If $\\text{rank}(\\boldsymbol{\\Sigma}) = 5$, the parameterization is declared structurally identifiable.\n- If $\\text{rank}(\\boldsymbol{\\Sigma}) < 5$, the parameterization is declared structurally non-identifiable.\n\nThe numerical rank of a matrix is typically determined by counting its singular values that are significantly greater than zero, a task well-suited for standard linear algebra libraries.\n\nThe algorithm to be implemented will perform these three steps for each test case covariance matrix $\\boldsymbol{\\Sigma}^{(k)}$ and format the results as a list containing the identified near-dependent pairs and a boolean for the identifiability assessment.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the battery parameter identifiability problem for the given test cases.\n    \"\"\"\n\n    # --- Problem Givens ---\n    \n    # Near-dependence threshold\n    tau = 0.95\n    \n    # Parameter dimension\n    n_params = 5\n\n    # Test cases for the covariance matrix Sigma\n    test_cases = [\n        # Case 1 (happy path)\n        np.array([\n            [0.0001, 0.00002, -0.1, 0.000003, 0.0],\n            [0.00002, 0.0004, 3.88, 0.000015, -0.072],\n            [-0.1, 3.88, 40000.0, 0.0, 360.0],\n            [0.000003, 0.000015, 0.0, 0.000225, -2.16],\n            [0.0, -0.072, 360.0, -2.16, 32400.0]\n        ]),\n        # Case 2 (boundary with zero variance)\n        np.array([\n            [0.000064, 0.000006, -0.024, 0.0, 0.0],\n            [0.000006, 0.000225, 2.025, 0.0, -0.18],\n            [-0.024, 2.025, 22500.0, 0.0, -12600.0],\n            [0.0, 0.0, 0.0, 0.0, 0.0],\n            [0.0, -0.18, -12600.0, 0.0, 14400.0]\n        ]),\n        # Case 3 (edge with near-perfect correlations)\n        np.array([\n            [0.000144, 0.00003, 0.264, 0.0, 0.0],\n            [0.00003, 0.000625, 5.4725, -0.000025, 0.0],\n            [0.264, 5.4725, 48400.0, -0.44, 2200.0],\n            [0.0, -0.000025, -0.44, 0.0004, -3.98],\n            [0.0, 0.0, 2200.0, -3.98, 40000.0]\n        ])\n    ]\n\n    all_results = []\n    for sigma in test_cases:\n        # --- 1. Correlation Matrix Calculation ---\n        \n        # Extract variances (diagonal elements)\n        variances = np.diag(sigma)\n        \n        # Calculate standard deviations, handling potential sqrt(0)\n        std_devs = np.sqrt(np.maximum(variances, 0))\n        \n        # Initialize correlation matrix\n        corr_matrix = np.zeros_like(sigma)\n        \n        # Calculate correlation coefficients element-wise\n        for i in range(n_params):\n            for j in range(n_params):\n                denominator = std_devs[i] * std_devs[j]\n                if denominator > 0:\n                    corr_matrix[i, j] = sigma[i, j] / denominator\n                # If denominator is 0, correlation remains 0 as per initialization\n                # and problem specification.\n\n        # --- 2. Near-Dependence Identification ---\n        \n        near_dependent_pairs = []\n        # Iterate over the upper triangle of the correlation matrix (i < j)\n        for i in range(n_params):\n            for j in range(i + 1, n_params):\n                if abs(corr_matrix[i, j]) >= tau:\n                    near_dependent_pairs.append([i, j])\n\n        # --- 3. Structural Identifiability Assessment ---\n        \n        # Use numerical rank test on the covariance matrix\n        rank = np.linalg.matrix_rank(sigma)\n        is_identifiable = (rank == n_params)\n        \n        # --- Format Output for Current Case ---\n        \n        case_result = [near_dependent_pairs, is_identifiable]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation for lists in Python includes spaces,\n    # which aligns with the use of '\\,' in the problem's LaTeX example.\n    # The provided snippet is followed literally.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "When a parameter estimate has high uncertainty, it can be difficult to tell if the problem is a fundamental flaw in the model (structural non-identifiability) or simply a lack of informative data (practical non-identifiability). This exercise introduces the profile likelihood, a powerful statistical tool that provides a visual and quantitative way to distinguish between these two scenarios. By implementing this technique, you will learn to characterize how the likelihood function behaves for truly unidentifiable parameters versus those that are merely 'practically' unidentifiable under specific experimental conditions .",
            "id": "3937072",
            "problem": "You are given a small-signal, linearized voltage model appropriate for calibration of the Single Particle Model (SPM) of lithium-ion batteries. The terminal voltage response to an applied current is modeled as the sum of an instantaneous ohmic drop and a diffusion overpotential that is approximated by a causal exponential kernel. The model assumes additive, independent Gaussian measurement noise. The goal is to use profile likelihoods to distinguish between true structural non-identifiability and flat but bounded likelihood regions for the diffusion time constant parameter.\n\nFundamental base:\n- Let $I(t)$ denote the applied current in amperes (A).\n- Let $R_s$ denote the series resistance in ohms ($\\Omega$).\n- Let $a$ denote the diffusion amplitude in volts per ampere-second ($\\mathrm{V}\\cdot\\mathrm{A}^{-1}\\cdot\\mathrm{s}^{-1}$).\n- Let $\\tau$ denote the diffusion time constant in seconds (s).\n- Let $V(t)$ denote the modeled voltage in volts (V).\n- For small signals, we approximate the diffusion overpotential as the convolution of $I(t)$ with the exponential kernel $k_\\tau(t) = \\exp(-t/\\tau)$.\n- Continuous-time convolution is approximated by a discrete-time convolution with uniform sampling interval $\\Delta t$ seconds:\n$$\ns_\\tau[n] = \\Delta t \\sum_{m=0}^{n} I[m] \\exp\\left(-\\frac{(t_n - t_m)}{\\tau}\\right),\n$$\nwhere $t_n = n \\Delta t$.\n- The model voltage is $V[n] = -R_s I[n] - a\\, s_\\tau[n]$.\n- Measurements are $Y[n] = V[n] + \\varepsilon[n]$ with $\\varepsilon[n] \\sim \\mathcal{N}(0,\\sigma^2)$ independent and identically distributed.\n\nParameter identifiability and profile likelihood:\n- For a parameter of interest $\\tau$, the profile likelihood fixes $\\tau$ and optimizes all other parameters $(R_s, a)$ to maximize the likelihood (equivalently, minimize the residual sum of squares).\n- Under Gaussian noise, $-2\\log L(\\tau) = \\frac{\\mathrm{RSS}(\\tau)}{\\sigma^2} + C$, where $L(\\tau)$ is the likelihood profiled over $(R_s, a)$ and $C$ is a constant independent of $\\tau$.\n- The $95\\%$ confidence cutoff for a single profiled parameter corresponds to an increase $\\Delta(-2\\log L)$ of $\\chi^2_{0.95,1} = 3.841458820694124$ above the minimum.\n\nTask:\n- Implement a program that, for each test case described below, constructs $Y[n]$ from the specified true parameters and current input, computes the profile likelihood over $\\tau$ by minimizing $\\mathrm{RSS}(\\tau)$ with respect to $(R_s, a)$ at each $\\tau$, and classifies whether $\\tau$ is truly non-identifiable (unbounded profile) versus flat but bounded.\n- Classification rule: Let $\\Delta(\\tau) = \\frac{\\mathrm{RSS}(\\tau) - \\min_{\\tilde{\\tau}} \\mathrm{RSS}(\\tilde{\\tau})}{\\sigma^2}$. If $\\Delta(\\tau)$ exceeds $3.841458820694124$ at both ends of the tested $\\tau$ grid, then the flat region is bounded (return the boolean value $False$ for \"true non-identifiability\"). If $\\Delta(\\tau)$ does not exceed the threshold at one or both ends, then the profile is unbounded in the tested range, indicating true structural non-identifiability (return the boolean value $True$).\n\nUnits:\n- Time $\\tau$ must be treated in seconds (s).\n- Current $I$ in amperes (A).\n- Voltage $V$ and $Y$ in volts (V).\n- Series resistance $R_s$ in ohms ($\\Omega$).\n- Diffusion amplitude $a$ in $\\mathrm{V}\\cdot\\mathrm{A}^{-1}\\cdot\\mathrm{s}^{-1}$.\n- Express the final decision as booleans per test case; no physical unit is required for the final outputs.\n\nTest suite:\n- The program must evaluate the following three cases. In all cases, use a uniform sampling grid and discrete-time convolution as defined above. Use a fixed random seed for reproducible Gaussian noise.\n\n1. Case $1$ (structural non-identifiability due to steady-state-only sampling):\n    - Sampling: $\\Delta t = 1.0$ s, times $t_n$ from $0$ s to $100$ s inclusive.\n    - Current: $I[n] = 1.0$ A for all $n$.\n    - True parameters: $R_s^\\star = 0.05$ $\\Omega$, $a^\\star = 2 \\times 10^{-2}$ $\\mathrm{V}\\cdot\\mathrm{A}^{-1}\\cdot\\mathrm{s}^{-1}$, $\\tau^\\star = 5.0$ s.\n    - Noise standard deviation: $\\sigma = 1 \\times 10^{-4}$ V.\n    - Measurement window: Use only indices with $t_n \\ge 60$ s to emulate steady-state-only observations.\n    - $\\tau$ grid: $N_\\tau = 60$ points logarithmically spaced from $10^{-1}$ s to $10^{3}$ s inclusive.\n\n2. Case $2$ (flat but bounded likelihood region under limited excitation and moderate noise):\n    - Sampling: $\\Delta t = 0.5$ s, times $t_n$ from $0$ s to $200$ s inclusive.\n    - Current: piecewise constant,\n        - $I[n] = 1.0$ A for $0 \\le t_n < 50$ s,\n        - $I[n] = 0.0$ A for $50 \\le t_n < 100$ s,\n        - $I[n] = -0.5$ A for $100 \\le t_n < 150$ s,\n        - $I[n] = 0.0$ A for $150 \\le t_n \\le 200$ s.\n    - True parameters: $R_s^\\star = 0.03$ $\\Omega$, $a^\\star = 1 \\times 10^{-3}$ $\\mathrm{V}\\cdot\\mathrm{A}^{-1}\\cdot\\mathrm{s}^{-1}$, $\\tau^\\star = 20.0$ s.\n    - Noise standard deviation: $\\sigma = 2 \\times 10^{-3}$ V.\n    - Measurement window: use all indices.\n    - $\\tau$ grid: $N_\\tau = 60$ points logarithmically spaced from $10^{-1}$ s to $10^{3}$ s inclusive.\n\n3. Case $3$ (well-identified under rich excitation and low noise):\n    - Sampling: $\\Delta t = 0.2$ s, times $t_n$ from $0$ s to $200$ s inclusive.\n    - Current: pseudo-random binary sequence (PRBS)-like piecewise constant with segment length $5.0$ s and amplitudes $\\pm 1.0$ A, zero mean over the horizon.\n    - True parameters: $R_s^\\star = 0.05$ $\\Omega$, $a^\\star = 5 \\times 10^{-3}$ $\\mathrm{V}\\cdot\\mathrm{A}^{-1}\\cdot\\mathrm{s}^{-1}$, $\\tau^\\star = 10.0$ s.\n    - Noise standard deviation: $\\sigma = 5 \\times 10^{-4}$ V.\n    - Measurement window: use all indices.\n    - $\\tau$ grid: $N_\\tau = 60$ points logarithmically spaced from $10^{-1}$ s to $10^{3}$ s inclusive.\n\nAlgorithmic requirements:\n- For each fixed $\\tau$ in the grid, minimize $\\mathrm{RSS}(\\tau) = \\sum_{n \\in \\mathcal{W}} \\left(Y[n] - \\left(-R_s I[n] - a\\, s_\\tau[n]\\right)\\right)^2$ over $(R_s, a)$ with $\\mathcal{W}$ the measurement window. This is a linear least squares problem in $(R_s, a)$.\n- Compute the profile $\\Delta(\\tau)$, find whether it exceeds the cutoff at both ends of the grid, and classify each case accordingly.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[True, False, False]`). Each entry must be a boolean indicating \"true non-identifiability\" for the corresponding test case, in the order Case $1$, Case $2$, Case $3$.",
            "solution": "The problem requires an analysis of parameter identifiability for a simplified electrochemical model of a lithium-ion battery. This analysis will distinguish between structural non-identifiability, where the model's mathematical form prevents unique parameter determination regardless of data quality, and practical non-identifiability, where the parameter is theoretically identifiable but the experimental data is not sufficiently informative, leading to a very flat likelihood function. The tool for this analysis is the profile likelihood.\n\nThe system is described by a discrete-time model for the battery's terminal voltage $Y[n]$ at time $t_n = n \\Delta t$:\n$$\nY[n] = -R_s I[n] - a s_\\tau[n] + \\varepsilon[n]\n$$\nwhere $I[n]$ is the applied current, $R_s$ is the series resistance, $a$ is the diffusion amplitude, and $\\varepsilon[n]$ is additive white Gaussian noise with mean $0$ and variance $\\sigma^2$. The term $s_\\tau[n]$ represents the history-dependent diffusion overpotential, calculated as a discrete-time convolution:\n$$\ns_\\tau[n] = \\Delta t \\sum_{m=0}^{n} I[m] \\exp\\left(-\\frac{(t_n - t_m)}{\\tau}\\right)\n$$\nHere, $\\tau$ is the diffusion time constant, which is the parameter of interest for our identifiability analysis. This convolution can be computed efficiently using the recursive formula:\n$$\ns_\\tau[n] = \\exp(-\\Delta t/\\tau) s_\\tau[n-1] + \\Delta t I[n], \\quad s_\\tau[-1] = 0\n$$\nThis is equivalent to applying a first-order infinite impulse response (IIR) filter to the input current signal $I[n]$.\n\nThe core of the task is to compute the profile likelihood for the parameter $\\tau$. For a fixed value of $\\tau$, the model is linear with respect to the parameters $R_s$ and $a$. The measurements $Y[n]$ can be expressed as:\n$$\nY[n] = R_s (-I[n]) + a (-s_\\tau[n]) + \\varepsilon[n]\n$$\nGiven that the noise $\\varepsilon[n]$ is Gaussian, maximizing the likelihood of observing the data $Y[n]$ is equivalent to minimizing the Residual Sum of Squares (RSS):\n$$\n\\mathrm{RSS}(R_s, a | \\tau) = \\sum_{n \\in \\mathcal{W}} \\left( Y[n] - (-R_s I[n] - a s_\\tau[n]) \\right)^2\n$$\nwhere $\\mathcal{W}$ is the set of indices corresponding to the measurement window. For each fixed $\\tau$, this is a standard linear least squares problem. We can define a design matrix $\\mathbf{X}(\\tau)$ and a parameter vector $\\boldsymbol{\\theta}$:\n$$\n\\mathbf{X}(\\tau) = \\begin{pmatrix} -I[n_1] & -s_\\tau[n_1] \\\\ -I[n_2] & -s_tau[n_2] \\\\ \\vdots & \\vdots \\\\ -I[n_N] & -s_\\tau[n_N] \\end{pmatrix}, \\quad \\boldsymbol{\\theta} = \\begin{pmatrix} R_s \\\\ a \\end{pmatrix}\n$$\nThe RSS is minimized by the least squares solution $\\hat{\\boldsymbol{\\theta}}(\\tau) = (\\mathbf{X}(\\tau)^T \\mathbf{X}(\\tau))^{-1} \\mathbf{X}(\\tau)^T \\mathbf{Y}$. The resulting minimum RSS for a given $\\tau$ is the profiled RSS, denoted $\\mathrm{RSS}(\\tau) = \\min_{R_s, a} \\mathrm{RSS}(R_s, a | \\tau)$.\n\nThe identifiability of $\\tau$ is assessed by examining the shape of the function $\\mathrm{RSS}(\\tau)$. A sharp, well-defined minimum indicates that the data strongly supports a specific value of $\\tau$. A flat minimum suggests practical non-identifiability. Structural non-identifiability manifests as a profile that remains flat indefinitely in one or both directions ($\\tau \\to 0$ or $\\tau \\to \\infty$), implying that multiple, disparate values of $\\tau$ explain the data equally well.\n\nTo formalize this, we analyze the normalized log-likelihood profile change, $\\Delta(\\tau)$:\n$$\n\\Delta(\\tau) = \\frac{\\mathrm{RSS}(\\tau) - \\min_{\\tilde{\\tau}} \\mathrm{RSS}(\\tilde{\\tau})}{\\sigma^2}\n$$\nAccording to Wilks' theorem, under the null hypothesis, this statistic follows a $\\chi^2$ distribution with one degree of freedom (since we are profiling one parameter, $\\tau$). A $95\\%$ confidence interval for $\\tau$ is the set of all $\\tau$ values for which $\\Delta(\\tau) \\le \\chi^2_{0.95, 1} \\approx 3.841$.\n\nThe problem defines a practical criterion for distinguishing bounded from unbounded profiles based on a specific grid of $\\tau$ values. If $\\Delta(\\tau)$ exceeds this threshold at both the minimum and maximum values of $\\tau$ in the grid, we conclude the profile is bounded within this range, and thus $\\tau$ is structurally identifiable (returning `False` for \"true non-identifiability\"). If the profile remains below the threshold at either end of the grid, we classify it as unbounded, indicating structural non-identifiability (returning `True`).\n\nThe three test cases are designed to illustrate this principle:\n1.  **Case 1:** A constant current input, observed only in steady-state. Here, the diffusion term $s_\\tau[n]$ becomes approximately proportional to $\\tau$ (for $\\tau$ much smaller than the observation start time), and the regressors for $R_s$ and $a$ (which are $-I[n]$ and $-s_\\tau[n]$) become linearly dependent. This leads to a structural non-identifiability where only the sum $R_s + a\\tau$ can be identified. The profile likelihood for $\\tau$ is expected to be flat.\n2.  **Case 2:** A piecewise-constant current input. The steps in the current provide excitation that, in principle, allows for the unique determination of all parameters. However, with limited excitation and relatively high noise, the likelihood profile may be very flat near its minimum, a case of practical non-identifiability. The profile should, however, be bounded at the extremes of the $\\tau$ grid.\n3.  **Case 3:** A pseudo-random binary sequence (PRBS) input. This signal is rich in frequencies and provides persistent excitation, which is ideal for system identification. Combined with low noise, this should result in a sharply defined, bounded likelihood profile, and $\\tau$ should be well-identified.",
            "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the analysis for each test case.\n    \"\"\"\n    \n    # Define the confidence cutoff threshold based on chi-squared distribution\n    CHI2_THRESHOLD = 3.841458820694124\n\n    def run_case(case_params: dict) -> bool:\n        \"\"\"\n        Executes a single test case for identifiability analysis.\n        \n        Args:\n            case_params: A dictionary containing all parameters for the test case.\n            \n        Returns:\n            A boolean, True if the parameter is structurally non-identifiable, False otherwise.\n        \"\"\"\n        \n        # Unpack case parameters\n        delta_t = case_params[\"delta_t\"]\n        t_end = case_params[\"t_end\"]\n        current_profile = case_params[\"current_profile\"]\n        true_params = case_params[\"true_params\"]\n        sigma = case_params[\"sigma\"]\n        window_start_t = case_params[\"window_start_t\"]\n        tau_grid_spec = case_params[\"tau_grid\"]\n        prbs_seed = case_params.get(\"prbs_seed\", None)\n\n        # 1. Setup time and current vectors\n        t = np.arange(0, t_end + delta_t / 2, delta_t)\n        num_points = len(t)\n        I = np.zeros(num_points)\n\n        if current_profile == \"constant\":\n            I.fill(1.0)\n        elif current_profile == \"piecewise\":\n            I[(t >= 0) & (t < 50)] = 1.0\n            I[(t >= 50) & (t < 100)] = 0.0\n            I[(t >= 100) & (t < 150)] = -0.5\n            I[(t >= 150) & (t <= t_end)] = 0.0\n        elif current_profile == \"prbs\":\n            seg_len_s = 5.0\n            num_segments = int(t_end / seg_len_s)\n            samples_per_seg = int(seg_len_s / delta_t)\n            \n            # Create a zero-mean sequence of +1 and -1\n            base_seq = np.array([1.0] * (num_segments // 2) + [-1.0] * (num_segments // 2))\n            rng = np.random.default_rng(prbs_seed)\n            rng.shuffle(base_seq)\n            \n            # Construct the full current signal\n            I_segments = np.repeat(base_seq, samples_per_seg)\n            I[:len(I_segments)] = I_segments\n            if len(I) > len(I_segments):\n                I[len(I_segments):] = I_segments[-1] # Pad last value if needed\n\n        # 2. Generate true measurement data with noise\n        R_s_star, a_star, tau_star = true_params[\"R_s\"], true_params[\"a\"], true_params[\"tau\"]\n        \n        # Calculate convolution using a recursive IIR filter implementation\n        b = [delta_t]\n        a_filt = [1, -np.exp(-delta_t / tau_star)]\n        s_tau_star = signal.lfilter(b, a_filt, I)\n\n        V_true = -R_s_star * I - a_star * s_tau_star\n        \n        # Add reproducible Gaussian noise\n        rng_noise = np.random.default_rng(seed=0)\n        noise = rng_noise.normal(0, sigma, num_points)\n        Y_data = V_true + noise\n\n        # 3. Perform Profile Likelihood Analysis\n        tau_grid = np.logspace(np.log10(tau_grid_spec[\"min\"]), np.log10(tau_grid_spec[\"max\"]), tau_grid_spec[\"N\"])\n        rss_profile = np.zeros_like(tau_grid)\n        \n        window_indices = np.where(t >= window_start_t)[0]\n        \n        Y_win = Y_data[window_indices]\n        I_win = I[window_indices]\n\n        for i, tau_val in enumerate(tau_grid):\n            # For each tau, calculate the corresponding diffusion signal\n            a_filt_i = [1, -np.exp(-delta_t / tau_val)]\n            s_tau_i = signal.lfilter(b, a_filt_i, I)\n            s_tau_win = s_tau_i[window_indices]\n            \n            # Set up and solve the linear least squares problem\n            # Y_win = Rs*(-I_win) + a*(-s_tau_win)\n            X = np.c_[-I_win, -s_tau_win]\n            \n            # lstsq returns: params, residuals, rank, singular_values\n            # residuals is the RSS if the problem is overdetermined.\n            _, rss, _, _ = np.linalg.lstsq(X, Y_win, rcond=None)\n            \n            # If system is underdetermined, residuals array is empty.\n            # This happens with rank deficient X. In this case, RSS is 0.\n            if rss.size == 0:\n                # In a perfectly rank-deficient case, the fit is perfect.\n                # This indicates non-identifiability. We can use a small value\n                # for RSS to reflect the flat profile. Here, we calculate RSS manually.\n                # A robust lstsq would indicate this. Let's recalculate RSS.\n                p, _, _, _ = np.linalg.lstsq(X, Y_win, rcond=None)\n                Y_fit = X @ p\n                rss_profile[i] = np.sum((Y_win - Y_fit)**2)\n            else:\n                rss_profile[i] = rss[0]\n\n        # 4. Classify the result based on the profile shape\n        min_rss = np.min(rss_profile)\n        delta_profile = (rss_profile - min_rss) / (sigma ** 2)\n\n        # Check if profile is unbounded at either end of the grid\n        is_unbounded_at_low_tau = delta_profile[0] <= CHI2_THRESHOLD\n        is_unbounded_at_high_tau = delta_profile[-1] <= CHI2_THRESHOLD\n\n        # \"True non-identifiability\" is True if profile is unbounded\n        is_non_identifiable = is_unbounded_at_low_tau or is_unbounded_at_high_tau\n        \n        return is_non_identifiable\n\n    # --- Define Test Cases ---\n\n    test_cases = [\n        # Case 1: Structural non-identifiability\n        {\n            \"delta_t\": 1.0, \"t_end\": 100.0, \"current_profile\": \"constant\",\n            \"true_params\": {\"R_s\": 0.05, \"a\": 2e-2, \"tau\": 5.0},\n            \"sigma\": 1e-4, \"window_start_t\": 60.0,\n            \"tau_grid\": {\"min\": 1e-1, \"max\": 1e3, \"N\": 60}\n        },\n        # Case 2: Flat but bounded likelihood\n        {\n            \"delta_t\": 0.5, \"t_end\": 200.0, \"current_profile\": \"piecewise\",\n            \"true_params\": {\"R_s\": 0.03, \"a\": 1e-3, \"tau\": 20.0},\n            \"sigma\": 2e-3, \"window_start_t\": 0.0,\n            \"tau_grid\": {\"min\": 1e-1, \"max\": 1e3, \"N\": 60}\n        },\n        # Case 3: Well-identified\n        {\n            \"delta_t\": 0.2, \"t_end\": 200.0, \"current_profile\": \"prbs\",\n            \"true_params\": {\"R_s\": 0.05, \"a\": 5e-3, \"tau\": 10.0},\n            \"sigma\": 5e-4, \"window_start_t\": 0.0,\n            \"tau_grid\": {\"min\": 1e-1, \"max\": 1e3, \"N\": 60},\n            \"prbs_seed\": 42\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(case)\n        results.append(result)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}