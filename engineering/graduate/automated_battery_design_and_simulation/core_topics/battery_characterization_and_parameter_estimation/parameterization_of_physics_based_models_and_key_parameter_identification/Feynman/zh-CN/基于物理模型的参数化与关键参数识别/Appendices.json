{
    "hands_on_practices": [
        {
            "introduction": "固相扩散系数 $D_s$ 是决定锂离子电池倍率性能的关键参数之一。本练习将指导您完成一个核心的参数辨识任务：从恒电流间歇滴定技术（GITT）的实验数据中提取 $D_s$。通过应用菲克定律并在线性化假设下分析电压弛豫过程，您将推导出弛豫电压与时间平方根的斜率之间的关系，从而能够定量计算扩散系数 。这个实践旨在锻炼您将基础物理化学原理应用于解释瞬态电化学数据的能力。",
            "id": "3937359",
            "problem": "给定由单分散球形活性材料颗粒组成的锂嵌入电极的恒电流间歇滴定技术（GITT）弛豫数据，您的目标是使用第一性原理建模和参数化逻辑来确定固相扩散系数。弛豫阶段在恒流脉冲关闭后立即开始。对于足够短的弛豫时间，假设颗粒表面附近的扩散可以近似为半无限和一维的，并且开路电压的变化与颗粒表面浓度的变化局部成正比。从以下基本原理出发：\n\n- 固相中锂浓度 $c_s(r,t)$ 的菲克第二定律，\n- 将摩尔通量密度 $J$ 与颗粒表面浓度梯度相关联的菲克第一定律，\n- 使用已知斜率 $dU/dc_s$ 对平衡电位相对于表面浓度进行线性化，\n\n推导一个表达式，将电压弛豫对 $\\sqrt{t}$ 的斜率与固相扩散系数 $D_s$ 和施加的电流历史联系起来。该推导必须从固相中的扩散方程、由恒流脉冲和随后的零通量弛豫所隐含的边界和初始条件，以及电压和表面浓度之间的局部线性关系开始。您可以将在极早期弛豫时间内的球形几何结构视为局部平面，并以此为基础证明使用半无限近似的合理性。\n\n定义和给定数量：\n\n- 设颗粒为半径为 $R_p$ 的球体，总数为 $N_p$，每个球体的表面积为 $A_p = 4\\pi R_p^2$，总颗粒表面积为 $A_{\\text{tot}} = N_p \\cdot 4\\pi R_p^2$。\n- 设脉冲期间施加的恒定电流大小为 $I_{\\text{tot}}$（单位：安培），每个嵌入锂离子的电子数为 $n$，法拉第常数为 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$。\n- 脉冲期间颗粒表面的摩尔通量密度为 $J = I_{\\text{tot}}/(n F A_{\\text{tot}})$，单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。\n- 电流中断后，在短时弛豫区间内，测得的电压 $U(t)$ 表现出对 $\\sqrt{t}$ 的线性依赖性，斜率为 $S = dU/d(\\sqrt{t})$，单位为 $\\text{V}\\,\\text{s}^{-1/2}$。\n- 平衡电位灵敏度已知为 $dU/dc_s$，单位为 $\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$，电压的微小变化与颗粒表面浓度的微小变化之间的关系为 $\\Delta U(t) \\approx (dU/dc_s)\\,\\Delta c_s(R_p,t)$。\n\n假设：\n\n- 使用电流中断后的早期弛豫，使得半无限扩散近似有效；即 $t \\ll R_p^2/D_s$。\n- 空间变化是径向的；在表面附近和早期，曲率可以忽略不计，并可近似为一个半无限笛卡尔域。\n- 电压响应主要由颗粒表面浓度的变化决定，双电层电容和接触电阻等非理想因素在所选时间窗口内可以忽略不计。\n\n任务：\n\n1. 基于上述定义和假设，推导一个将测量斜率 $S$ 与 $D_s$、$J$ 和 $dU/dc_s$ 联系起来的关系式。推导必须从菲克第二定律和边界条件开始，然后通过线性化的平衡电位将浓度弛豫与电压弛豫联系起来。\n2. 使用推导出的关系式，计算下面描述的每个测试用例的 $D_s$。每个 $D_s$ 以 $\\text{m}^2/\\text{s}$ 表示。\n3. 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个数字均采用科学记数法，保留六位有效数字（例如 $[1.234567\\text{e-}08,9.876543\\text{e-}12]$）。\n\n在所有情况下均使用 $n = 1$。测试套件包含四个不同的案例，用于探测典型、较高扩散率和较低扩散率的情况，以及对几何形状和电流的敏感性：\n\n- 案例 1（一般情况）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 1.5\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 案例 2（较小斜率意味着较大 $D_s$）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 5.0\\times 10^{-4}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 案例 3（较大斜率意味着较小 $D_s$）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 4.0\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 案例 4（不同的几何形状和电流；测试敏感性）：\n  - $R_p = 2.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 2.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 0.5\\,\\text{A}$\n  - $dU/dc_s = 6.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 1.0\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n您的程序必须为每个案例计算 $A_{\\text{tot}}$、摩尔通量密度 $J$，然后计算 $D_s$，并以指定的单行输出格式打印四个 $D_s$ 值。",
            "solution": "该问题要求从恒电流间歇滴定技术（GITT）弛豫数据中推导固相扩散系数 $D_s$ 的表达式，并随后为一组测试用例计算其值。推导将从扩散和电化学的基本原理开始，并遵循指定的假设。\n\n**第一部分：$D_s$ 关系式的推导**\n\n推导过程分为三个主要阶段：(1) 在 GITT 条件下求解扩散方程以获得浓度分布，(2) 将浓度变化与电压变化相关联，以及 (3) 提取实验测量的斜率 $S$ 与扩散系数 $D_s$ 之间的关系。\n\n**1. 从扩散方程得到的浓度分布**\n\n我们从菲克第二扩散定律开始。问题指出，对于较短的弛豫时间，球形颗粒表面附近的扩散可以近似为半无限和一维的。设 $x$ 是从颗粒表面 ($x=0$) 指向颗粒内部 ($x>0$) 的空间坐标，$c_s(x,t)$ 是固相中的锂浓度。控制偏微分方程为：\n$$\n\\frac{\\partial c_s(x,t)}{\\partial t} = D_s \\frac{\\partial^2 c_s(x,t)}{\\partial x^2}\n$$\n其中 $D_s$ 是固相扩散系数，假定为常数。\n\nGITT 实验涉及施加一个持续时间为 $\\tau$ 的恒流脉冲，然后是一个电流为零的弛豫期。这个过程可以使用线性扩散方程的叠加原理来建模。电流脉冲对应于颗粒表面的恒定摩尔通量密度 $J$。关闭电流等效于在脉冲结束的瞬间叠加一个 $-J$ 的通量。\n\n设实验在时间 $t_p=0$ 开始。在 $0 \\le t_p \\le \\tau$ 期间，在边界 $x=0$ 处施加一个恒定的通量 $J$。边界条件由菲克第一定律给出：\n$$\n-D_s \\frac{\\partial c_s}{\\partial x}\\bigg|_{x=0} = J\n$$\n在具有初始均匀浓度 $c_0$ 和恒定通量边界条件的半无限介质中，扩散方程的解是众所周知的。表面 ($x=0$) 浓度随时间 $t_p$ 的变化为：\n$$\n\\Delta c_s(0, t_p) = c_s(0, t_p) - c_0 = \\frac{2J\\sqrt{t_p}}{\\sqrt{\\pi D_s}}\n$$\n在时间 $t_p = \\tau$ 时，电流关闭。我们可以通过在所有时间 $t_p > \\tau$ 添加一个 $-J$ 的通量来对此建模。对于 $t_p > \\tau$，表面浓度的总变化是始于 $t_p=0$ 的通量 $+J$ 的响应与始于 $t_p=\\tau$ 的通量 $-J$ 的响应之和。\n$$\n\\Delta c_{s, \\text{total}}(0, t_p) = \\frac{2J\\sqrt{t_p}}{\\sqrt{\\pi D_s}} - \\frac{2J\\sqrt{t_p - \\tau}}{\\sqrt{\\pi D_s}} = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{t_p} - \\sqrt{t_p - \\tau} \\right)\n$$\n这个方程描述了在弛豫阶段表面浓度相对于初始浓度 $c_0$ 的演变。\n\n让我们将弛豫时间定义为 $t = t_p - \\tau$。弛豫从 $t=0$ 开始。将 $t_p = t + \\tau$ 代入上述方程，得到总浓度变化作为弛豫时间 $t$ 的函数：\n$$\n\\Delta c_{s, \\text{total}}(0, \\tau+t) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{\\tau+t} - \\sqrt{t} \\right)\n$$\n我们关心的是弛豫期间的浓度变化，即相对于脉冲结束时 ($t_p=\\tau$ 或 $t=0$) 的浓度。脉冲结束时的浓度变化为 $\\Delta c_s(0, \\tau) = \\frac{2J\\sqrt{\\tau}}{\\sqrt{\\pi D_s}}$。因此，弛豫期间的浓度变化是：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) = \\Delta c_{s, \\text{total}}(0, \\tau+t) - \\Delta c_s(0, \\tau) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{\\tau+t} - \\sqrt{t} - \\sqrt{\\tau} \\right)\n$$\n问题明确指出，分析是针对“足够短的弛豫时间”。这意味着弛豫时间 $t$ 远小于脉冲持续时间 $\\tau$ (即 $t \\ll \\tau$)。在此条件下，我们可以对 $\\sqrt{\\tau+t}$ 项使用泰勒展开：\n$$\n\\sqrt{\\tau+t} = \\sqrt{\\tau(1+t/\\tau)} \\approx \\sqrt{\\tau}\\left(1 + \\frac{1}{2}\\frac{t}{\\tau}\\right)\n$$\n将此近似值代入 $\\Delta c_{s, \\text{relax}}(0, t)$ 的表达式中：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) \\approx \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\left(\\sqrt{\\tau} + \\frac{t}{2\\sqrt{\\tau}}\\right) - \\sqrt{t} - \\sqrt{\\tau} \\right) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\frac{t}{2\\sqrt{\\tau}} - \\sqrt{t} \\right)\n$$\n对于非常短的时间 ($t \\to 0$)，$\\sqrt{t}$ 项相比于 $t$ 项占主导地位。因此，表达式简化为：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) \\approx -\\frac{2J}{\\sqrt{\\pi D_s}}\\sqrt{t}\n$$\n这个方程表明，对于短弛豫时间，表面浓度的变化与弛豫时间的平方根成线性比例。\n\n**2. 电压响应**\n\n问题指出，开路电压的变化 $\\Delta U(t)$ 通过已知的灵敏度 $dU/dc_s$ 与表面浓度的变化 $\\Delta c_s(R_p, t)$ 局部成正比：\n$$\n\\Delta U(t) \\approx \\left(\\frac{dU}{dc_s}\\right) \\Delta c_s(R_p, t)\n$$\n将此应用于弛豫期间的变化 $\\Delta U_{\\text{relax}}(t)$：\n$$\n\\Delta U_{\\text{relax}}(t) \\approx \\left(\\frac{dU}{dc_s}\\right) \\Delta c_{s, \\text{relax}}(0, t) \\approx -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\\sqrt{t}\n$$\n这个推导出的关系证实了问题中陈述的实验观察：弛豫期间的电压 $U(t)$ 表现出对 $\\sqrt{t}$ 的线性依赖性。\n\n**3. 斜率 $S$ 与 $D_s$ 之间的关系**\n\n斜率 $S$ 定义为 $S = dU/d(\\sqrt{t})$。从我们推导出的弛豫期间电压变化的表达式中，我们可以计算这个斜率：\n$$\nS = \\frac{d(\\Delta U_{\\text{relax}}(t))}{d(\\sqrt{t})} = -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\n$$\n问题提供了 $S$ 和 $dU/dc_s$ 的正值。由于在弛豫期间表面浓度降低，电压（随 $c_s$ 增加而增加）也随之降低，使得真实斜率为负。因此，给定的 $S$ 必须解释为斜率的绝对值：\n$$\nS = \\left| -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}} \\right| = \\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\n$$\n我们的目标是找到 $D_s$ 的表达式。重新整理方程：\n$$\n\\sqrt{\\pi D_s} = \\frac{2J}{S} \\left(\\frac{dU}{dc_s}\\right)\n$$\n两边平方得到：\n$$\n\\pi D_s = \\left( \\frac{2J}{S} \\left(\\frac{dU}{dc_s}\\right) \\right)^2 = \\frac{4J^2}{S^2} \\left(\\frac{dU}{dc_s}\\right)^2\n$$\n最后，分离出 $D_s$，我们得到所需的关系式：\n$$\nD_s = \\frac{4}{\\pi} \\left( \\frac{J}{S} \\frac{dU}{dc_s} \\right)^2\n$$\n此表达式将固相扩散系数 $D_s$ 与测量的斜率 $S$、施加的通量密度 $J$ 以及热力学因子 $dU/dc_s$ 联系起来。通量 $J$ 是根据总施加电流 $I_{\\text{tot}}$ 和总活性表面积 $A_{\\text{tot}}$ 计算的：\n$$\nJ = \\frac{I_{\\text{tot}}}{nF A_{\\text{tot}}}, \\quad \\text{where} \\quad A_{\\text{tot}} = N_p \\cdot 4\\pi R_p^2\n$$\n\n**第二部分：测试用例的 $D_s$ 计算**\n\n使用推导出的公式，我们现在将为提供的四个测试用例计算 $D_s$。在整个计算过程中使用 $n=1$ 和 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$。每个案例的计算首先涉及计算 $A_{\\text{tot}}$ 和 $J$，然后将这些值代入 $D_s$ 的表达式中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the solid-phase diffusion coefficient (D_s) for a series of\n    GITT experiment test cases based on a derived first-principles model.\n    \"\"\"\n    \n    # Define physical constants\n    F = 96485  # Faraday constant in C/mol\n    n = 1      # Number of electrons transferred per Li ion\n\n    # Test cases from the problem statement\n    # Each tuple contains: (R_p, N_p, I_tot, dU_dcs, S)\n    test_cases = [\n        # Case 1 (general case)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 1.5e-3),\n        # Case 2 (smaller slope implies larger D_s)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 5.0e-4),\n        # Case 3 (larger slope implies smaller D_s)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 4.0e-3),\n        # Case 4 (different geometry and current)\n        (2.0e-6, 2.0e8, 0.5, 6.0e-5, 1.0e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        Rp, Np, Itot, dU_dcs, S = case\n\n        # Step 1: Calculate the total particle surface area (A_tot)\n        # A_p = 4 * pi * R_p^2 for a single spherical particle\n        # A_tot = N_p * A_p\n        A_tot = Np * 4.0 * np.pi * (Rp**2)\n\n        # Step 2: Calculate the molar flux density (J) at the particle surface\n        # J = I_tot / (n * F * A_tot)\n        J = Itot / (n * F * A_tot)\n\n        # Step 3: Calculate the solid-phase diffusion coefficient (D_s)\n        # The derived formula is D_s = (4/pi) * (J * dU/dc_s / S)^2\n        term_in_paren = (J * dU_dcs) / S\n        D_s = (4.0 / np.pi) * (term_in_paren**2)\n        \n        results.append(D_s)\n\n    # Format the results into a single string as specified:\n    # Comma-separated list in scientific notation with six significant digits.\n    # The format specifier {:.5e} provides 1 digit before the decimal and 5 after,\n    # totaling 6 significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "物理模型中的参数不仅需要被确定，其不确定性也必须被量化，这对于评估模型的预测能力至关重要。本练习关注多孔电极中电解质的有效电导率，这是一个由孔隙率和电极微观结构共同决定的宏观属性。您将使用经典的 Bruggeman 关系式，通过对模型进行线性化变换，并应用加权最小二乘法来拟合一组实验数据，从而辨识出关键的结构指数 $\\beta$ 并评估其估计的不确定性 。这项练习将使您掌握从多组测量中进行统计参数化并进行严谨不确定性分析的基本方法。",
            "id": "3937395",
            "problem": "你的任务是为多孔介质中电解质有效电导率的基于物理的标度关系进行参数化，并确定一个关键的结构参数。考虑一个充满具有本征电导率的液体电解质的多孔电极。在多孔介质的均质化和欧姆定律下，有效的体相离子传导可以通过一个无量纲的孔隙度指数来建模。具体来说，假设在多孔介质中存在以下被广泛使用并有实验支持的标度律：有效电解质电导率 $\\kappa_{\\mathrm{eff}}$ 作为孔隙度 $\\varepsilon$ 的函数，遵循幂律关系 $\\kappa_{\\mathrm{eff}}(\\varepsilon) = \\kappa_{0}\\,\\varepsilon^{\\beta}$，其中 $\\kappa_{0} > 0$ 是一个恒定的参考电导率（对于在非曲折几何结构中的相同电解质），而 $\\beta$ 是一个无量纲的孔隙度-曲折度指数，它编码了形态和传输阻碍信息。\n\n在不同的孔隙度 $\\varepsilon_{i}$ 下测量 $\\kappa_{\\mathrm{eff}}$，你应将这些测量值视为对数空间中随机测量模型的实现。定义 $x_{i} = \\ln(\\varepsilon_{i})$ 和 $y_{i}^{\\mathrm{obs}} = \\ln(\\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$，并假设在对数空间中存在加性高斯噪声 $y_{i}^{\\mathrm{obs}} = \\alpha + \\beta x_{i} + e_{i}$，其中 $\\alpha = \\ln(\\kappa_{0})$，$e_{i} \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ 是独立的，并且所有 $\\sigma_{i} > 0$ 都是已知的。在这些假设下，估计 $\\beta$ 及其不确定性可简化为对变换后变量的加权线性回归。\n\n从多孔介质中通过欧姆定律得到的有效电导率的基本物理定义出发，并将对数测量模型视为电导率测量中乘性误差的结果，构建一个参数估计算法，该算法：\n- 使用列为 $[1, x_{i}]$ 的设计矩阵和对角权重矩阵 $W = \\mathrm{diag}(w_{i})$（其中 $w_{i} = 1/\\sigma_{i}^{2}$）建立 $(\\alpha,\\beta)$ 的加权最小二乘估计器。\n- 在对数空间的高斯噪声模型下，计算 $\\beta$ 的最大似然估计。\n- 使用 Fisher 信息的逆矩阵计算 $\\beta$ 的标准不确定度（一个标准差），在所述假设下，该逆矩阵等于参数协方差矩阵 $(X^{\\mathsf{T}} W X)^{-1}$。需要报告的不确定度是 $\\sqrt{\\left[(X^{\\mathsf{T}} W X)^{-1}\\right]_{22}}$，即对应于 $\\beta$ 的协方差矩阵的 $(2,2)$ 元素的平方根。\n\n所有 $\\kappa_{\\mathrm{eff}}$ 测量的单位均为西门子/米，缩写为 S/m。孔隙度是无量纲的，且严格介于 $0$ 和 $1$ 之间。全程使用自然对数（以 $e$ 为底）。\n\n你的程序必须实现上述要求，并处理以下包含三个测试用例的测试套件，每个用例包含三次测量：\n- 测试用例1（孔隙度分离良好且不确定度适中的一般情况）：\n  - 孔隙度 $\\varepsilon$: $[0.30,\\,0.60,\\,0.75]$\n  - 测得的有效电导率 $\\kappa_{\\mathrm{eff}}$ (单位: S/m): $[0.42,\\,1.15,\\,1.60]$\n  - 对数空间标准差 $\\sigma$: $[0.05,\\,0.05,\\,0.05]$\n- 测试用例2（孔隙度密集聚集导致较大几何参数不确定度的边界情况）：\n  - 孔隙度 $\\varepsilon$: $[0.58,\\,0.60,\\,0.62]$\n  - 测得的有效电导率 $\\kappa_{\\mathrm{eff}}$ (单位: S/m): $[1.10,\\,1.16,\\,1.22]$\n  - 对数空间标准差 $\\sigma$: $[0.02,\\,0.02,\\,0.02]$\n- 测试用例3（孔隙度分离广泛且存在异方差不确定度的边缘情况）：\n  - 孔隙度 $\\varepsilon$: $[0.20,\\,0.50,\\,0.90]$\n  - 测得的有效电导率 $\\kappa_{\\mathrm{eff}}$ (单位: S/m): $[0.27,\\,1.05,\\,2.60]$\n  - 对数空间标准差 $\\sigma$: $[0.10,\\,0.05,\\,0.20]$\n\n对于每个测试用例，估计 $\\beta$ 及其标准不确定度。最终输出必须是无量纲的浮点数。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是对应测试用例的一个双元素列表 $[\\hat{\\beta},\\,u_{\\beta}]$，每个浮点数四舍五入到六位小数，例如：$[[\\hat{\\beta}_{1},u_{\\beta,1}],\\,[\\hat{\\beta}_{2},u_{\\beta,2}],\\,[\\hat{\\beta}_{3},u_{\\beta,3}]]$.",
            "solution": "从实验数据中估计孔隙度-曲折度指数 $\\beta$ 是材料科学和电化学中的一个经典参数识别任务。该问题是适定的，并有充分的科学依据。我将着手提供一个完整的解决方案。\n\n提供的物理模型是多孔介质中有效电导率 $\\kappa_{\\mathrm{eff}}$ 的幂律关系：\n$$\n\\kappa_{\\mathrm{eff}}(\\varepsilon) = \\kappa_{0} \\, \\varepsilon^{\\beta}\n$$\n其中 $\\varepsilon$ 是孔隙度，$\\kappa_{0}$ 是参考电导率，而 $\\beta$ 是待确定的无量纲指数。该模型是 Bruggeman 相关式或 Archie 定律的一种形式，广泛用于描述复合介质中的传输特性。\n\n为了便于从实验数据 $(\\varepsilon_i, \\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$ 中进行参数估计，我们通过对模型两边取自然对数来将其线性化：\n$$\n\\ln(\\kappa_{\\mathrm{eff}}) = \\ln(\\kappa_{0}) + \\beta \\ln(\\varepsilon)\n$$\n这将幂律关系转换为线性关系。我们定义变换后的变量 $y = \\ln(\\kappa_{\\mathrm{eff}})$，$x = \\ln(\\varepsilon)$，以及常数 $\\alpha = \\ln(\\kappa_{0})$。模型变为：\n$$\ny = \\alpha + \\beta x\n$$\n问题指定了一个随机测量模型，其中观测值 $y_{i}^{\\mathrm{obs}} = \\ln(\\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$ 包含加性高斯噪声 $e_i$，其方差 $\\sigma_i^2$ 是已知的、独立的：\n$$\ny_{i}^{\\mathrm{obs}} = \\alpha + \\beta x_{i} + e_{i}, \\quad \\text{where } e_{i} \\sim \\mathcal{N}(0, \\sigma_{i}^{2})\n$$\n我们的目标是找到参数 $\\alpha$ 和 $\\beta$ 的最佳估计值，特别是 $\\hat{\\beta}$，并量化该估计的不确定度 $u_{\\beta}$。\n\n在独立高斯误差的假设下，参数 $(\\alpha, \\beta)$ 的最大似然估计 (MLE) 是使加权残差平方和（通常表示为 $\\chi^2$）最小化的估计：\n$$\n\\chi^2(\\alpha, \\beta) = \\sum_{i=1}^{n} \\left( \\frac{y_{i}^{\\mathrm{obs}} - (\\alpha + \\beta x_i)}{\\sigma_i} \\right)^2 = \\sum_{i=1}^{n} w_i (y_{i}^{\\mathrm{obs}} - (\\alpha + \\beta x_i))^2\n$$\n其中 $n$ 是测量次数，$w_i = 1/\\sigma_i^2$ 是权重。这就是加权最小二乘法 (WLS) 的原理。\n\n为高效解决此最小化问题，我们采用矩阵形式。设参数向量为 $\\boldsymbol{\\theta}$，观测向量为 $\\mathbf{y}$，设计矩阵为 $X$：\n$$\n\\boldsymbol{\\theta} = \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} y_1^{\\mathrm{obs}} \\\\ y_2^{\\mathrm{obs}} \\\\ \\vdots \\\\ y_n^{\\mathrm{obs}} \\end{pmatrix}, \\quad X = \\begin{pmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_n \\end{pmatrix}\n$$\n设 $W$ 为权重对角矩阵：\n$$\nW = \\mathrm{diag}(w_1, w_2, \\dots, w_n) = \\begin{pmatrix} 1/\\sigma_1^2 & 0 & \\dots & 0 \\\\ 0 & 1/\\sigma_2^2 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\dots & 1/\\sigma_n^2 \\end{pmatrix}\n$$\n$\\chi^2$ 目标函数可以写成矩阵形式：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = (\\mathbf{y} - X\\boldsymbol{\\theta})^{\\mathsf{T}} W (\\mathbf{y} - X\\boldsymbol{\\theta})\n$$\n使该表达式最小化的解可以通过将其关于 $\\boldsymbol{\\theta}$ 的梯度设为零来找到，这会得到 WLS 的正规方程：\n$$\n(X^{\\mathsf{T}} W X) \\hat{\\boldsymbol{\\theta}} = X^{\\mathsf{T}} W \\mathbf{y}\n$$\n因此，参数向量 $\\hat{\\boldsymbol{\\theta}}$ 的 WLS 估计为：\n$$\n\\hat{\\boldsymbol{\\theta}} = (X^{\\mathsf{T}} W X)^{-1} X^{\\mathsf{T}} W \\mathbf{y}\n$$\n孔隙度指数的估计值 $\\hat{\\beta}$ 是向量 $\\hat{\\boldsymbol{\\theta}}$ 的第二个元素。\n\n统计理论的一个关键结果是，估计参数的协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 由 Fisher 信息矩阵的逆给出。对于这个带有高斯噪声的线性模型，它就是：\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) = (X^{\\mathsf{T}} W X)^{-1}\n$$\n矩阵 $X^{\\mathsf{T}} W X$ 是一个 $2 \\times 2$ 矩阵：\n$$\nX^{\\mathsf{T}} W X = \\begin{pmatrix} \\sum_{i=1}^{n} w_i & \\sum_{i=1}^{n} w_i x_i \\\\ \\sum_{i=1}^{n} w_i x_i & \\sum_{i=1}^{n} w_i x_i^2 \\end{pmatrix}\n$$\n$\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 的对角元素是各个参数估计值的方差。我们关心的是 $\\hat{\\beta}$ 的方差，即第二个对角元素，记作 $(\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}))_{22}$。标准不确定度 $u_{\\beta}$ 是该方差的平方根：\n$$\nu_{\\beta} = \\sqrt{ \\left[ (X^{\\mathsf{T}} W X)^{-1} \\right]_{22} }\n$$\n该算法将实现这些矩阵方程。对于每个测试用例，我们将：\n1.  对给定的孔隙度 $\\varepsilon_i$ 和电导率 $\\kappa_{\\mathrm{eff},i}$ 数据取自然对数，以获得 $x_i$ 和 $y_i^{\\mathrm{obs}}$。\n2.  根据 $\\sigma_i$ 值构建设计矩阵 $X$、观测向量 $\\mathbf{y}$ 和权重矩阵 $W$。\n3.  计算矩阵乘积 $C = X^{\\mathsf{T}} W X$。\n4.  对该矩阵求逆以获得协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) = C^{-1}$。\n5.  计算参数向量估计值 $\\hat{\\boldsymbol{\\theta}} = C^{-1} X^{\\mathsf{T}} W \\mathbf{y}$。\n6.  估计值 $\\hat{\\beta}$ 是 $\\hat{\\boldsymbol{\\theta}}$ 的第二个元素。\n7.  标准不确定度 $u_{\\beta}$ 是 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 对角线上第二个元素的平方根。\n此过程将应用于所提供的三个测试用例中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the porosity-tortuosity exponent and its uncertainty for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"epsilons\": np.array([0.30, 0.60, 0.75]),\n            \"kappas_eff\": np.array([0.42, 1.15, 1.60]),\n            \"sigmas\": np.array([0.05, 0.05, 0.05]),\n        },\n        # Test case 2\n        {\n            \"epsilons\": np.array([0.58, 0.60, 0.62]),\n            \"kappas_eff\": np.array([1.10, 1.16, 1.22]),\n            \"sigmas\": np.array([0.02, 0.02, 0.02]),\n        },\n        # Test case 3\n        {\n            \"epsilons\": np.array([0.20, 0.50, 0.90]),\n            \"kappas_eff\": np.array([0.27, 1.05, 2.60]),\n            \"sigmas\": np.array([0.10, 0.05, 0.20]),\n        },\n    ]\n\n    def estimate_beta_and_uncertainty(epsilons, kappas_eff, sigmas):\n        \"\"\"\n        Performs weighted linear regression to estimate beta and its uncertainty.\n        \n        Args:\n            epsilons (np.ndarray): Array of porosity values.\n            kappas_eff (np.ndarray): Array of measured effective conductivities.\n            sigmas (np.ndarray): Array of standard deviations in log-space.\n            \n        Returns:\n            tuple: A tuple containing the estimated beta (float) and its standard\n                   uncertainty (float).\n        \"\"\"\n        # Step 1: Transform variables to linear space (y = alpha + beta*x)\n        x = np.log(epsilons)\n        y_obs = np.log(kappas_eff)\n        \n        # Step 2: Set up the components for Weighted Least Squares (WLS)\n        # Design matrix X\n        X = np.vstack((np.ones_like(x), x)).T\n        \n        # Weights w_i = 1/sigma_i^2\n        weights = 1.0 / (sigmas**2)\n        \n        # Weight matrix W (diagonal matrix of weights)\n        W = np.diag(weights)\n        \n        # Step 3: Compute the WLS solution for the parameters [alpha, beta]\n        # Calculate the matrix (X^T * W * X)\n        XT_W_X = X.T @ W @ X\n        \n        # Calculate its inverse, which is the covariance matrix of parameters\n        try:\n            cov_matrix = np.linalg.inv(XT_W_X)\n        except np.linalg.LinAlgError:\n            # This case occurs if the matrix is singular (e.g., all x values are the same)\n            return (np.nan, np.nan)\n            \n        # Calculate the vector (X^T * W * y)\n        XT_W_y = X.T @ W @ y_obs\n        \n        # The parameter vector estimate theta_hat = [alpha_hat, beta_hat]\n        theta_hat = cov_matrix @ XT_W_y\n        \n        # Step 4: Extract the results for beta\n        # The estimate for beta is the second element of theta_hat\n        beta_hat = theta_hat[1]\n        \n        # The standard uncertainty for beta is the square root of the (2,2) element\n        # of the covariance matrix.\n        uncertainty_beta = np.sqrt(cov_matrix[1, 1])\n        \n        return beta_hat, uncertainty_beta\n\n    results = []\n    for case in test_cases:\n        beta, u_beta = estimate_beta_and_uncertainty(\n            case[\"epsilons\"], case[\"kappas_eff\"], case[\"sigmas\"]\n        )\n        results.append([beta, u_beta])\n    \n    # Format the final output string as specified in the problem\n    formatted_results = [f\"[{beta:.6f},{u_beta:.6f}]\" for beta, u_beta in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "高效的参数化不仅依赖于精巧的算法，更依赖于信息丰富的实验设计。本练习将引导您进入一个更高级的主题：如何定量评估和组合不同类型的实验数据以最大程度地降低参数不确定性。通过分析一个经典的 Randles 等效电路模型，您将使用费雪信息矩阵（Fisher Information Matrix）这一强大工具，来比较时域（恒电流阶跃）和频域（电化学阻抗谱）测量对模型参数 $R_s$、 $R_{ct}$ 和 $C_{dl}$ 的辨识能力 。这个实践旨在让您理解如何从理论上优化实验方案，以获得最可靠的参数估计。",
            "id": "3937437",
            "problem": "考虑一个常用于自动化电池设计和模拟的锂离子电池的物理等效电路：一个串联的欧姆电阻（单位为欧姆），记为 $R_s$，其后跟一个电荷转移电阻（单位为欧姆，记为 $R_{ct}$）和一个双电层电容（单位为法拉，记为 $C_{dl}$）的并联组合。假设一个振幅为 $I_0$（单位为安培）的恒电流输入。对于时域实验，在时间 $t=0$ 时施加一个大小为 $I_0$ 的电流阶跃，并在指定的一组时间 $t_k$（单位为秒）测量端电压。对于使用电化学阻抗谱 (EIS) 的频域实验，施加一个角频率为 $\\omega$（单位为弧度/秒）的小信号正弦电流扰动，并测量复阻抗 $Z(\\mathrm{j}\\omega)$（单位为欧姆）；阻抗的实部和虚部作为独立的标量观测值被记录下来。假设在两个域中都存在加性、独立、零均值的高斯测量噪声：对于时域，电压噪声的标准差为 $\\sigma_V$（单位为伏特）；对于频域，阻抗的实部和虚部各自的标准差为 $\\sigma_Z$（单位为欧姆）。\n\n您的任务是通过评估和组合来自两个域的费雪信息矩阵，计算在时域数据集中增加 EIS 测量后，边际参数不确定性的预期减少量。使用以下基本原理：\n- 对于一个参数化测量模型 $y = h(\\boldsymbol{\\theta}) + \\varepsilon$，其参数向量为 $\\boldsymbol{\\theta}$，噪声 $\\varepsilon$ 为独立、零均值的高斯噪声且协方差矩阵为 $\\Sigma$，费雪信息矩阵为 $J = \\sum_i \\left(\\nabla_{\\boldsymbol{\\theta}} h_i\\right)^\\top \\Sigma_i^{-1} \\left(\\nabla_{\\boldsymbol{\\theta}} h_i\\right)$，其中求和是对独立观测值 $i$ 进行的，而 $h_i$ 是观测值 $i$ 的模型输出。\n- 对于独立的数据集，总费雪信息是可加的：$J_{\\text{total}} = J_1 + J_2$。\n- 克拉默-拉奥下界 (CRLB) 将任何无偏估计量的可达协方差近似为 $P \\approx J^{-1}$；当 $J$ 不可逆时，使用摩尔-彭若斯伪逆。\n\n仅从基尔霍夫定律和电容器的本构关系 $i_C(t) = C \\,\\mathrm{d}v_C(t)/\\mathrm{d}t$ 出发，推导给定电路对阶跃电流输入的时域端电压响应和频域阻抗函数。然后，计算这些响应相对于参数 $\\boldsymbol{\\theta} = [R_s, R_{ct}, C_{dl}]^\\top$ 的雅可比矩阵。使用这些雅可比矩阵，构建时域费雪信息矩阵 $J_{\\text{time}}$ 和 EIS 费雪信息矩阵 $J_{\\text{eis}}$。计算仅有时域数据的协方差 $P_{\\text{time}} \\approx J_{\\text{time}}^{-1}$ 和组合协方差 $P_{\\text{comb}} \\approx \\left(J_{\\text{time}} + J_{\\text{eis}}\\right)^{-1}$，在需要时使用摩尔-彭若斯伪逆。最后，报告对角线上边际方差的逐元素比率 $\\operatorname{diag}(P_{\\text{comb}}) \\oslash \\operatorname{diag}(P_{\\text{time}})$，按顺序对应三个参数 $R_s$、$R_{ct}$ 和 $C_{dl}$。这些比率是无单位的小数；小于 $1$ 的值表示增加 EIS 数据后不确定性有所降低。\n\n为以下测试套件计算上述值。对于每种情况，使用 $I_0 = 1.0 \\, \\text{A}$。对于时域数据集，使用指定的测量时间（单位为秒）。对于 EIS 数据集，使用指定的角频率（单位为弧度/秒）。每个域的噪声水平已给出。所有电阻必须以欧姆为单位，电容以法拉为单位，电压以伏特为单位，时间以秒为单位，角频率以弧度/秒为单位。将最终比率表示为四舍五入到六位小数的小数。\n\n测试套件（每种情况都是一个指定参数和数据的元组）：\n- 情况 A（一般情况，在两个域中都提供信息）：\n  - 参数：$R_s = 0.01, R_{ct} = 0.05, C_{dl} = 5.0$\n  - 时间样本 $t_k$：$[0.02, 0.1, 0.5, 1.0, 2.0]$\n  - EIS 角频率 $\\omega_k$：$[0.5, 1.0, 5.0, 10.0, 50.0]$\n  - 噪声：$\\sigma_V = 1.0 \\times 10^{-4} \\, \\text{V}, \\; \\sigma_Z = 1.0 \\times 10^{-3} \\, \\Omega$\n- 情况 B（EIS 受噪声主导）：\n  - 参数：$R_s = 0.01, R_{ct} = 0.05, C_{dl} = 5.0$\n  - 时间样本 $t_k$：$[0.02, 0.1, 0.5, 1.0, 2.0]$\n  - EIS 角频率 $\\omega_k$：$[0.5, 1.0, 5.0, 10.0, 50.0]$\n  - 噪声：$\\sigma_V = 1.0 \\times 10^{-4} \\, \\text{V}, \\; \\sigma_Z = 5.0 \\times 10^{-2} \\, \\Omega$\n- 情况 C（时间窗口短；EIS 增加关键信息）：\n  - 参数：$R_s = 0.01, R_{ct} = 0.05, C_{dl} = 5.0$\n  - 时间样本 $t_k$：$[0.001, 0.002, 0.005, 0.01]$\n  - EIS 角频率 $\\omega_k$：$[0.1, 1.0, 10.0, 100.0]$\n  - 噪声：$\\sigma_V = 1.0 \\times 10^{-4} \\, \\text{V}, \\; \\sigma_Z = 1.0 \\times 10^{-3} \\, \\Omega$\n- 情况 D（仅高频 EIS；增加的信息有限）：\n  - 参数：$R_s = 0.01, R_{ct} = 0.05, C_{dl} = 5.0$\n  - 时间样本 $t_k$：$[0.02, 0.1, 0.5, 1.0, 2.0]$\n  - EIS 角频率 $\\omega_k$：$[500.0, 1000.0]$\n  - 噪声：$\\sigma_V = 1.0 \\times 10^{-4} \\, \\text{V}, \\; \\sigma_Z = 1.0 \\times 10^{-3} \\, \\Omega$\n\n程序要求：\n- 实现上述基于推导的模型和雅可比矩阵，以计算两个域及其组合的费雪信息矩阵。\n- 当矩阵求逆不稳定或不可能时，使用摩尔-彭若斯伪逆计算协方差近似值。\n- 对于每种情况，输出三个方差比率 $\\left[\\frac{P_{\\text{comb},11}}{P_{\\text{time},11}},\\,\\frac{P_{\\text{comb},22}}{P_{\\text{time},22}},\\,\\frac{P_{\\text{comb},33}}{P_{\\text{time},33}}\\right]$，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，并用方括号括起来，其中每个元素是对应一种情况的三个比率列表，顺序为 A、B、C、D。例如，一个有效的输出格式是 $[\\,[r_{A,1},r_{A,2},r_{A,3}],\\,[r_{B,1},r_{B,2},r_{B,3}],\\,[r_{C,1},r_{C,2},r_{C,3}],\\,[r_{D,1},r_{D,2},r_{D,3}]\\,]$。",
            "solution": "用户的请求是一个有效的科学问题。该结论是在经过严格验证过程后得出的。\n\n### 步骤 1：提取给定信息\n- **电路模型**：一个欧姆电阻 $R_s$ 与一个电荷转移电阻 $R_{ct}$ 和一个双电层电容 $C_{dl}$ 的并联组合相串联。\n- **参数向量**：$\\boldsymbol{\\theta} = [R_s, R_{ct}, C_{dl}]^\\top$。\n- **时域实验**：\n    - **输入**：在 $t=0$ 时施加振幅为 $I_0$ 的恒电流阶跃。\n    - **测量**：在指定的一组时间 $t_k$ 测量端电压 $V(t)$。\n    - **噪声**：电压上存在加性、独立、零均值的高斯噪声，标准差为 $\\sigma_V$。\n- **频域 (EIS) 实验**：\n    - **输入**：角频率为 $\\omega$ 的小信号正弦电流扰动。\n    - **测量**：复阻抗 $Z(\\mathrm{j}\\omega)$ 的实部和虚部作为独立的标量观测值记录。\n    - **噪声**：阻抗实部和虚部上存在加性、独立、零均值的高斯噪声，各自的标准差为 $\\sigma_Z$。\n- **费雪信息矩阵 (FIM)**：对于模型 $y = h(\\boldsymbol{\\theta}) + \\varepsilon$，噪声协方差为 $\\Sigma$，FIM 为 $J = \\sum_i \\left(\\nabla_{\\boldsymbol{\\theta}} h_i\\right)^\\top \\Sigma_i^{-1} \\left(\\nabla_{\\boldsymbol{\\theta}} h_i\\right)$。\n- **FIM 可加性**：对于独立的数据集，$J_{\\text{total}} = J_{\\text{time}} + J_{\\text{eis}}$。\n- **克拉默-拉奥下界 (CRLB)**：无偏估计量的协方差矩阵近似为 $P \\approx J^{-1}$。如果 $J$ 不可逆，则使用摩尔-彭若斯伪逆 ($J^\\dagger$)。\n- **任务**：对于每个测试用例，计算组合协方差矩阵与仅时域协方差矩阵对角线元素的逐元素比率：$\\operatorname{diag}(P_{\\text{comb}}) \\oslash \\operatorname{diag}(P_{\\text{time}})$，其中 $P_{\\text{comb}} = (J_{\\text{time}} + J_{\\text{eis}})^\\dagger$ 且 $P_{\\text{time}} = J_{\\text{time}}^\\dagger$。\n- **常数和测试数据**：\n    - 所有情况下，$I_0 = 1.0 \\, \\mathrm{A}$。\n    - **情况 A**：$\\boldsymbol{\\theta}=[0.01, 0.05, 5.0]$, $t_k=[0.02, 0.1, 0.5, 1.0, 2.0]$, $\\omega_k=[0.5, 1.0, 5.0, 10.0, 50.0]$, $\\sigma_V=10^{-4}$, $\\sigma_Z=10^{-3}$。\n    - **情况 B**：$\\boldsymbol{\\theta}=[0.01, 0.05, 5.0]$, $t_k=[0.02, 0.1, 0.5, 1.0, 2.0]$, $\\omega_k=[0.5, 1.0, 5.0, 10.0, 50.0]$, $\\sigma_V=10^{-4}$, $\\sigma_Z=5 \\times 10^{-2}$。\n    - **情况 C**：$\\boldsymbol{\\theta}=[0.01, 0.05, 5.0]$, $t_k=[0.001, 0.002, 0.005, 0.01]$, $\\omega_k=[0.1, 1.0, 10.0, 100.0]$, $\\sigma_V=10^{-4}$, $\\sigma_Z=10^{-3}$。\n    - **情况 D**：$\\boldsymbol{\\theta}=[0.01, 0.05, 5.0]$, $t_k=[0.02, 0.1, 0.5, 1.0, 2.0]$, $\\omega_k=[500.0, 1000.0]$, $\\sigma_V=10^{-4}$, $\\sigma_Z=10^{-3}$。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据验证标准对问题进行评估：\n- **科学性**：问题基于电化学电池的标准兰德尔斯等效电路、基尔霍夫电路定律、一阶线性常微分方程和复阻抗分析。统计框架使用费雪信息矩阵和克拉默-拉奥下界，这些是估计理论和系统辨识中的基本概念。该问题在科学上和数学上是合理的。\n- **良态性**：问题定义清晰，具有明确的计算目标。所有必要的参数、模型定义、激励和统计假设都已提供。使用摩尔-彭若斯伪逆确保了即使 FIM 是奇异的，也存在稳定且唯一的解，这在参数估计问题中是现实的可能性。\n- **客观性**：问题陈述是形式化和定量的，没有任何主观或模糊的语言。\n\n该问题没有任何无效性缺陷。它是自洽的、一致的且可解的。\n\n### 步骤 3：结论与行动\n问题是**有效的**。开始进行求解。\n\n### 推导与计算策略\n\n解决方案需要推导出电池在时域和频域中响应的解析模型，计算它们关于参数 $\\boldsymbol{\\theta} = [R_s, R_{ct}, C_{dl}]^\\top$ 的雅可比矩阵，然后构建费雪信息矩阵。\n\n#### 1. 时域分析\n总端电压 $V(t)$ 是串联电阻上的电压 $V_{R_s}(t)$ 和并联 RC 模块上的电压 $V_{RC}(t)$ 之和。\n$V(t) = V_{R_s}(t) + V_{RC}(t)$\n对于在 $t=0$ 时的电流阶跃 $I(t) = I_0$， $R_s$ 上的电压就是 $V_{R_s}(t) = I_0 R_s$。\n根据基尔霍夫电流定律，对于并联模块，总电流 $I_0$ 分流到 $R_{ct}$ 和 $C_{dl}$ 中：\n$$ I_0 = i_{R_{ct}}(t) + i_{C_{dl}}(t) = \\frac{V_{RC}(t)}{R_{ct}} + C_{dl} \\frac{\\mathrm{d}V_{RC}(t)}{\\mathrm{d}t} $$\n这是一个一阶线性非齐次微分方程。整理后得到：\n$$ \\frac{\\mathrm{d}V_{RC}(t)}{\\mathrm{d}t} + \\frac{1}{R_{ct}C_{dl}}V_{RC}(t) = \\frac{I_0}{C_{dl}} $$\n在电容器未充电的初始条件下，$V_{RC}(0)=0$，解为：\n$$ V_{RC}(t) = I_0 R_{ct} \\left(1 - e^{-t/(R_{ct}C_{dl})}\\right) $$\n总端电压响应，即我们的测量模型 $h_{\\text{time}}(t, \\boldsymbol{\\theta})$，是：\n$$ V(t) = I_0 R_s + I_0 R_{ct} \\left(1 - e^{-t/(R_{ct}C_{dl})}\\right) $$\n雅可比矩阵是偏导数向量，$\\nabla_{\\boldsymbol{\\theta}} V(t) = [\\frac{\\partial V}{\\partial R_s}, \\frac{\\partial V}{\\partial R_{ct}}, \\frac{\\partial V}{\\partial C_{dl}}]$：\n$$ \\frac{\\partial V}{\\partial R_s} = I_0 $$\n$$ \\frac{\\partial V}{\\partial R_{ct}} = I_0 \\left(1 - e^{-t/(R_{ct}C_{dl})} \\left(1 + \\frac{t}{R_{ct}C_{dl}}\\right)\\right) $$\n$$ \\frac{\\partial V}{\\partial C_{dl}} = -I_0 \\frac{t}{C_{dl}^2} e^{-t/(R_{ct}C_{dl})} $$\n时域 FIM，$J_{\\text{time}}$，通过对每次测量时间 $t_k$ 的贡献求和来构建。由于噪声是独立同分布的，方差为 $\\sigma_V^2$：\n$$ J_{\\text{time}} = \\frac{1}{\\sigma_V^2} \\sum_{k} \\left(\\nabla_{\\boldsymbol{\\theta}} V(t_k)\\right)^\\top \\left(\\nabla_{\\boldsymbol{\\theta}} V(t_k)\\right) $$\n\n#### 2. 频域分析 (EIS)\n在频域中，电阻的阻抗为 $R$，电容的阻抗为 $1/(\\mathrm{j}\\omega C)$，其中 $\\mathrm{j}$ 是虚数单位。\n并联 RC 模块的阻抗为：\n$$ Z_{RC}(\\mathrm{j}\\omega) = \\left(\\frac{1}{R_{ct}} + \\frac{1}{1/(\\mathrm{j}\\omega C_{dl})}\\right)^{-1} = \\left(\\frac{1}{R_{ct}} + \\mathrm{j}\\omega C_{dl}\\right)^{-1} = \\frac{R_{ct}}{1 + \\mathrm{j}\\omega R_{ct}C_{dl}} $$\n总复阻抗 $Z(\\mathrm{j}\\omega)$ 是 $R_s$ 和 $Z_{RC}(\\mathrm{j}\\omega)$ 的和：\n$$ Z(\\mathrm{j}\\omega) = R_s + \\frac{R_{ct}}{1 + \\mathrm{j}\\omega R_{ct}C_{dl}} $$\n为了求出实部和虚部，我们将第二项的分子和分母乘以其分母的复共轭：\n$$ Z(\\mathrm{j}\\omega) = R_s + \\frac{R_{ct}(1 - \\mathrm{j}\\omega R_{ct}C_{dl})}{1 + (\\omega R_{ct}C_{dl})^2} $$\n阻抗的实部和虚部是我们的测量模型 $h_{\\text{eis,Re}}(\\omega, \\boldsymbol{\\theta})$ 和 $h_{\\text{eis,Im}}(\\omega, \\boldsymbol{\\theta})$：\n$$ Z_{\\text{Re}}(\\omega) = \\operatorname{Re}[Z(\\mathrm{j}\\omega)] = R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct}C_{dl})^2} $$\n$$ Z_{\\text{Im}}(\\omega) = \\operatorname{Im}[Z(\\mathrm{j}\\omega)] = -\\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct}C_{dl})^2} $$\n对于每个频率 $\\omega_k$，我们计算 $2 \\times 3$ 的雅可比矩阵 $H_k = \\nabla_{\\boldsymbol{\\theta}} [Z_{\\text{Re}}(\\omega_k), Z_{\\text{Im}}(\\omega_k)]^\\top$。令 $\\tau = R_{ct}C_{dl}$。偏导数为：\n$$ \\frac{\\partial Z_{\\text{Re}}}{\\partial R_s} = 1, \\quad \\frac{\\partial Z_{\\text{Re}}}{\\partial R_{ct}} = \\frac{1 - (\\omega\\tau)^2}{(1+(\\omega\\tau)^2)^2}, \\quad \\frac{\\partial Z_{\\text{Re}}}{\\partial C_{dl}} = \\frac{-2\\omega^2 R_{ct}^3 C_{dl}}{(1+(\\omega\\tau)^2)^2} $$\n$$ \\frac{\\partial Z_{\\text{Im}}}{\\partial R_s} = 0, \\quad \\frac{\\partial Z_{\\text{Im}}}{\\partial R_{ct}} = \\frac{-2\\omega\\tau}{(1+(\\omega\\tau)^2)^2}, \\quad \\frac{\\partial Z_{\\text{Im}}}{\\partial C_{dl}} = \\frac{-\\omega R_{ct}^2(1 - (\\omega\\tau)^2)}{(1+(\\omega\\tau)^2)^2} $$\n实部和虚部的噪声独立，方差为 $\\sigma_Z^2$。EIS FIM，$J_{\\text{eis}}$，是来自每个频率 $\\omega_k$ 的贡献之和：\n$$ J_{\\text{eis}} = \\frac{1}{\\sigma_Z^2} \\sum_{k} H_k^\\top H_k $$\n其中 $H_k$ 是在 $\\omega_k$ 处评估的 $2 \\times 3$ 雅可比矩阵。\n\n#### 3. 最终计算\n对于每个测试用例，执行以下步骤：\n1.  使用时域雅可比矩阵和测量时间 $t_k$ 计算 $J_{\\text{time}}$。\n2.  使用频域雅可比矩阵和角频率 $\\omega_k$ 计算 $J_{\\text{eis}}$。\n3.  计算仅时域的协方差矩阵：$P_{\\text{time}} = J_{\\text{time}}^\\dagger$。\n4.  计算组合 FIM：$J_{\\text{comb}} = J_{\\text{time}} + J_{\\text{eis}}$。\n5.  计算组合协方差矩阵：$P_{\\text{comb}} = J_{\\text{comb}}^\\dagger$。\n6.  从两个协方差矩阵中提取对角线元素（边际方差）：$\\operatorname{diag}(P_{\\text{time}})$ 和 $\\operatorname{diag}(P_{\\text{comb}})$。\n7.  计算逐元素比率：$\\operatorname{diag}(P_{\\text{comb}}) \\oslash \\operatorname{diag}(P_{\\text{time}})$。\n8.  对于每个用例，收集参数 [$R_s, R_{ct}, C_{dl}$] 的三个结果比率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reduction in parameter uncertainty by augmenting a time-domain\n    dataset with EIS measurements for a Randles circuit model.\n    \"\"\"\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case A: General case\n        {\n            \"params\": {\"Rs\": 0.01, \"Rct\": 0.05, \"Cdl\": 5.0},\n            \"t_samples\": [0.02, 0.1, 0.5, 1.0, 2.0],\n            \"w_samples\": [0.5, 1.0, 5.0, 10.0, 50.0],\n            \"noise\": {\"sigma_V\": 1.0e-4, \"sigma_Z\": 1.0e-3}\n        },\n        # Case B: EIS dominated by noise\n        {\n            \"params\": {\"Rs\": 0.01, \"Rct\": 0.05, \"Cdl\": 5.0},\n            \"t_samples\": [0.02, 0.1, 0.5, 1.0, 2.0],\n            \"w_samples\": [0.5, 1.0, 5.0, 10.0, 50.0],\n            \"noise\": {\"sigma_V\": 1.0e-4, \"sigma_Z\": 5.0e-2}\n        },\n        # Case C: Short time window\n        {\n            \"params\": {\"Rs\": 0.01, \"Rct\": 0.05, \"Cdl\": 5.0},\n            \"t_samples\": [0.001, 0.002, 0.005, 0.01],\n            \"w_samples\": [0.1, 1.0, 10.0, 100.0],\n            \"noise\": {\"sigma_V\": 1.0e-4, \"sigma_Z\": 1.0e-3}\n        },\n        # Case D: High-frequency EIS only\n        {\n            \"params\": {\"Rs\": 0.01, \"Rct\": 0.05, \"Cdl\": 5.0},\n            \"t_samples\": [0.02, 0.1, 0.5, 1.0, 2.0],\n            \"w_samples\": [500.0, 1000.0],\n            \"noise\": {\"sigma_V\": 1.0e-4, \"sigma_Z\": 1.0e-3}\n        },\n    ]\n\n    I0 = 1.0  # Current amplitude in Amperes\n    all_results = []\n\n    for case in test_cases:\n        Rs, Rct, Cdl = case[\"params\"][\"Rs\"], case[\"params\"][\"Rct\"], case[\"params\"][\"Cdl\"]\n        t_samples = np.array(case[\"t_samples\"])\n        w_samples = np.array(case[\"w_samples\"])\n        sigma_V = case[\"noise\"][\"sigma_V\"]\n        sigma_Z = case[\"noise\"][\"sigma_Z\"]\n\n        # 1. Compute Time-Domain FIM\n        J_time = np.zeros((3, 3))\n        tau = Rct * Cdl\n        for t in t_samples:\n            if t == 0: continue\n            exp_term = np.exp(-t / tau)\n            \n            # Jacobian of V(t) w.r.t. [Rs, Rct, Cdl]\n            j_v = np.zeros(3)\n            j_v[0] = I0  # dV/dRs\n            j_v[1] = I0 * (1 - (1 + t / tau) * exp_term)  # dV/dRct\n            j_v[2] = -I0 * Rct * (t / (Rct * Cdl**2)) * exp_term # dV/dCdl\n            \n            J_time += np.outer(j_v, j_v)\n        \n        J_time /= (sigma_V**2)\n\n        # 2. Compute EIS FIM\n        J_eis = np.zeros((3, 3))\n        for w in w_samples:\n            tau = Rct * Cdl\n            w_tau = w * tau\n            denom = 1 + w_tau**2\n            \n            # Jacobian of [Z_re, Z_im] w.r.t. [Rs, Rct, Cdl]\n            H_k = np.zeros((2, 3))\n            \n            # Row 1: Derivatives of Z_re\n            H_k[0, 0] = 1.0 # dZ_re/dRs\n            H_k[0, 1] = (1 - w_tau**2) / (denom**2) # dZ_re/dRct\n            H_k[0, 2] = (-2 * w**2 * Rct**3 * Cdl) / (denom**2) # dZ_re/dCdl\n\n            # Row 2: Derivatives of Z_im\n            H_k[1, 0] = 0.0 # dZ_im/dRs\n            H_k[1, 1] = (-2 * w * Rct * Cdl) / (denom**2) # dZ_im/dRct\n            H_k[1, 2] = (-w * Rct**2 * (1 - w_tau**2)) / (denom**2) # dZ_im/dCdl\n\n            J_eis += H_k.T @ H_k\n            \n        J_eis /= (sigma_Z**2)\n\n        # 3. Compute Covariances and Ratios\n        P_time = np.linalg.pinv(J_time)\n        \n        J_comb = J_time + J_eis\n        P_comb = np.linalg.pinv(J_comb)\n        \n        var_time = np.diag(P_time)\n        var_comb = np.diag(P_comb)\n        \n        # Element-wise division, handle division by zero if a variance is zero\n        ratios = np.divide(var_comb, var_time, out=np.ones_like(var_comb), where=var_time!=0)\n        \n        # Round to six decimal places\n        rounded_ratios = [round(r, 6) for r in ratios]\n        all_results.append(rounded_ratios)\n\n    # Print results in the specified single-line format for a list of lists.\n    # The str() representation of a list of lists matches the required visual format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}