{
    "hands_on_practices": [
        {
            "introduction": "Butler-Volmer 方程是描述 DFN 模型中反应动力学的基石，但其完整形式可能较为复杂。本练习将引导您推导在较大过电势下的重要简化形式——Tafel 近似，并量化其误差。通过这个过程，您将对这一重要近似的适用范围建立起一个切实的认识 。",
            "id": "3906571",
            "problem": "在多孔电极的 Doyle–Fuller–Newman (DFN) 模型中，固-电解质界面的电化学反应动力学由 Butler–Volmer 关系式描述，该关系式将过电势与界面电流密度耦合起来。考虑在恒定温度 $T$ 下，一个单电子转移反应（$n=1$），其电荷转移系数对称，即 $\\alpha_{a}=\\alpha_{c}=0.5$。从电子转移动力学的第一性原理和 Butler–Volmer 关系式出发，在大正过电势的假设下，推导阳极分支的 Tafel 近似。然后，在指定的过电势下，量化此 Tafel 近似相对于完整 Butler–Volmer 表达式的无量纲相对误差。\n\n设过电势为 $\\eta=100\\ \\text{mV}>0$，温度为 $T=298\\ \\text{K}$，普适气体常数为 $R=8.314462618\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}$，法拉第常数为 $F=96485.33212\\ \\text{C mol}^{-1}$。将无量纲相对误差定义为\n$$\nE(\\eta) \\equiv \\frac{\\left|i_{\\text{Tafel}}(\\eta)-i_{\\text{BV}}(\\eta)\\right|}{i_{\\text{BV}}(\\eta)},\n$$\n其中 $i_{\\text{BV}}(\\eta)$ 是由完整的 Butler–Volmer 关系式预测的界面电流密度，$i_{\\text{Tafel}}(\\eta)$ 是在大正过电势假设下得到的阳极 Tafel 近似。\n\n假设交换电流密度 $i_{0}$ 是有限且为正的，并注意它在 $E(\\eta)$ 的定义中被消去。将 $E(100\\ \\text{mV})$ 的最终答案表示为小数。将答案四舍五入到四位有效数字。最终答案中不应包含单位。",
            "solution": "该问题要求从 Butler-Volmer 方程推导阳极 Tafel 近似，并随后计算该近似在指定过电势下的相对误差。此问题具有科学依据，是适定的，并包含了获得唯一解所需的所有信息。\n\n分析从 Butler-Volmer 方程的通用形式开始，该方程描述了固-电解质界面处的电流密度 $i_{\\text{BV}}$ 作为过电势 $\\eta$ 的函数：\n$$\ni_{\\text{BV}}(\\eta) = i_{0} \\left( \\exp\\left(\\frac{\\alpha_{a} n F \\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_{c} n F \\eta}{RT}\\right) \\right)\n$$\n此处，$i_{0}$ 是交换电流密度，$\\alpha_{a}$ 和 $\\alpha_{c}$ 分别是阳极和阴极的电荷转移系数，$n$ 是基元反应步骤中转移的电子数，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n问题为参数提供了具体值：单电子转移反应，因此 $n=1$，以及对称的电荷转移系数，$\\alpha_{a} = \\alpha_{c} = 0.5$。将这些值代入通用方程，得到该体系的具体形式：\n$$\ni_{\\text{BV}}(\\eta) = i_{0} \\left( \\exp\\left(\\frac{0.5 F \\eta}{RT}\\right) - \\exp\\left(-\\frac{0.5 F \\eta}{RT}\\right) \\right)\n$$\n\nTafel 近似是在大过电势的假设下推导出来的。对于阳极分支，这对应于大的正过电势，$\\eta \\gg 0$。在这种情况下，第一个指数项的参数 $\\frac{0.5 F \\eta}{RT}$ 是一个大的正数，而第二个指数项的参数 $-\\frac{0.5 F \\eta}{RT}$ 是一个大的负数。因此，第二项与第一项相比变得可以忽略不计：\n$$\n\\exp\\left(\\frac{0.5 F \\eta}{RT}\\right) \\gg \\exp\\left(-\\frac{0.5 F \\eta}{RT}\\right)\n$$\n通过忽略第二项（阴极项），我们得到了电流密度的阳极 Tafel 近似，$i_{\\text{Tafel}}(\\eta)$：\n$$\ni_{\\text{Tafel}}(\\eta) = i_{0} \\exp\\left(\\frac{0.5 F \\eta}{RT}\\right)\n$$\n\n下一步是量化该近似的无量纲相对误差 $E(\\eta)$。误差定义为：\n$$\nE(\\eta) \\equiv \\frac{\\left|i_{\\text{Tafel}}(\\eta)-i_{\\text{BV}}(\\eta)\\right|}{i_{\\text{BV}}(\\eta)}\n$$\n对于正过电势 $\\eta > 0$，阳极电流大于阴极电流，因此 $i_{\\text{BV}}(\\eta) > 0$。Tafel 近似 $i_{\\text{Tafel}}(\\eta)$ 是通过忽略一个正项（阴极电流的绝对值）得到的，所以 $i_{\\text{Tafel}}(\\eta)$ 总是大于 $i_{\\text{BV}}(\\eta)$。因此，可以去掉绝对值符号：\n$$\nE(\\eta) = \\frac{i_{\\text{Tafel}}(\\eta)-i_{\\text{BV}}(\\eta)}{i_{\\text{BV}}(\\eta)} = \\frac{i_{\\text{Tafel}}(\\eta)}{i_{\\text{BV}}(\\eta)} - 1\n$$\n我们代入推导出的 $i_{\\text{Tafel}}(\\eta)$ 和 $i_{\\text{BV}}(\\eta)$ 的表达式：\n$$\nE(\\eta) = \\frac{i_{0} \\exp\\left(\\frac{0.5 F \\eta}{RT}\\right)}{i_{0} \\left( \\exp\\left(\\frac{0.5 F \\eta}{RT}\\right) - \\exp\\left(-\\frac{0.5 F \\eta}{RT}\\right) \\right)} - 1\n$$\n正如问题中所述，交换电流密度 $i_{0}$ 被消去：\n$$\nE(\\eta) = \\frac{\\exp\\left(\\frac{0.5 F \\eta}{RT}\\right)}{\\exp\\left(\\frac{0.5 F \\eta}{RT}\\right) - \\exp\\left(-\\frac{0.5 F \\eta}{RT}\\right)} - 1\n$$\n为简化此表达式，我们可以将分数的分子和分母同乘以 $\\exp\\left(-\\frac{0.5 F \\eta}{RT}\\right)$：\n$$\nE(\\eta) = \\frac{1}{1 - \\exp\\left(-\\frac{F \\eta}{RT}\\right)} - 1\n$$\n将各项通分，得到相对误差的最终解析表达式：\n$$\nE(\\eta) = \\frac{1 - \\left(1 - \\exp\\left(-\\frac{F \\eta}{RT}\\right)\\right)}{1 - \\exp\\left(-\\frac{F \\eta}{RT}\\right)} = \\frac{\\exp\\left(-\\frac{F \\eta}{RT}\\right)}{1 - \\exp\\left(-\\frac{F \\eta}{RT}\\right)}\n$$\n现在，我们必须在给定条件下对此表达式进行数值计算：\n$\\eta = 100\\ \\text{mV} = 0.1\\ \\text{V}$\n$T = 298\\ \\text{K}$\n$R = 8.314462618\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}$\n$F = 96485.33212\\ \\text{C mol}^{-1}$\n\n首先，我们计算无量纲指数 $\\frac{F \\eta}{RT}$：\n$$\n\\frac{F \\eta}{RT} = \\frac{(96485.33212\\ \\text{C mol}^{-1}) \\times (0.1\\ \\text{V})}{(8.314462618\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}) \\times (298\\ \\text{K})} \\approx \\frac{9648.533212}{2477.57086} \\approx 3.894376\n$$\n令 $x = \\frac{F \\eta}{RT}$。则误差为 $E = \\frac{\\exp(-x)}{1 - \\exp(-x)}$。\n使用计算出的 $x$ 值：\n$$\n\\exp(-x) \\approx \\exp(-3.894376) \\approx 0.0203565\n$$\n现在，我们将此值代入误差表达式：\n$$\nE \\approx \\frac{0.0203565}{1 - 0.0203565} = \\frac{0.0203565}{0.9796435} \\approx 0.02077958\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $2$、$0$、$7$、$7$。第五位有效数字是 $9$，大于或等于 $5$，因此我们将第四位有效数字向上取整。\n$$\nE \\approx 0.02078\n$$",
            "answer": "$$\n\\boxed{0.02078}\n$$"
        },
        {
            "introduction": "除了反应动力学，电池的性能常常受到离子在多孔部件（如隔膜）中传输的限制。本实践将探讨孔隙率这一关键微观结构参数如何决定有效传输系数，并最终影响电池的整体倍率性能。通过分析浓差极化和欧姆压降如何共同制约最大电流，您将对传输限制下的性能有一个定量的理解 。",
            "id": "3906608",
            "problem": "您的任务是基于Doyle–Fuller–Newman (DFN)模型的假设，设计并实现一个计算评估方法，以量化锂离子电池中隔膜孔隙率从$0.4$变为$0.3$对电解质传输和倍率性能的影响。您的程序必须从基本传输定律和广为接受的多孔介质标度关系出发推导并计算相关量，并且必须严格避免依赖未经解释的启发式捷径。\n\n假设隔膜为一维、等温，并遵循以下DFN模型假设：电中性成立，电解质为二元稀溶液且阳离子迁移数恒定，多孔隔膜是均匀且各向同性的。在质量守恒、电解质盐的菲克扩散以及多孔介质中离子欧姆定律的数学框架内进行分析。孔隙率对有效性质的影响必须从多孔介质理论中推导得出，并通过一个物理上合理的本构关系来表达，该关系将孔隙空间分数与曲折度联系起来，进而联系到有效传输系数。\n\n基于此，您必须：\n\n- 推导隔膜中有效电解质盐扩散系数$D_{\\mathrm{eff}}$和有效离子电导率$\\kappa_{\\mathrm{eff}}$的表达式，使其作为体相值$D$和$\\kappa$、孔隙率$\\varepsilon$以及表征多孔介质的曲折度/结构指数$b$的函数。\n- 在稳态下，当恒定的面电流密度$i$流过隔膜时，利用盐守恒定律，推导在电中性和恒定迁移数$t_+^0$的条件下，由于扩散和迁移引起的穿过隔膜厚度$L_s$的电解质浓度变化。将由此产生的浓差极化表示为相对于体相浓度$c_0$的无量纲分数。\n- 利用多孔介质中的离子欧姆定律和推导出的有效电导率，确定在电流密度为$i$时穿过隔膜的欧姆电位降。定义一个倍率性能指标$i_{\\max}$，其为允许的最大面电流密度，使得电解质浓差极化分数不超过给定极限$f_{\\lim}$，且穿过隔膜的离子欧姆降不超过给定电压极限$V_{\\lim}$。\n- 在保持所有其他量固定的情况下，量化当孔隙率从$0.4$降低到$0.3$时这些指标的变化。\n\n您必须实现一个程序，为每个提供的测试用例计算：\n1. $D_{\\mathrm{eff}}(0.3)/D_{\\mathrm{eff}}(0.4)$的比值。\n2. $\\kappa_{\\mathrm{eff}}(0.3)/\\kappa_{\\mathrm{eff}}(0.4)$的比值。\n3. 在指定电流密度下，孔隙率为$0.4$时穿过隔膜的浓差极化分数。\n4. 在指定电流密度下，孔隙率为$0.3$时穿过隔膜的浓差极化分数。\n5. 孔隙率为$0.4$时的倍率性能$i_{\\max}$（单位为$\\mathrm{A}/\\mathrm{m}^2$）。\n6. 孔隙率为$0.3$时的倍率性能$i_{\\max}$（单位为$\\mathrm{A}/\\mathrm{m}^2$）。\n7. $i_{\\max}(0.3)/i_{\\max}(0.4)$的比值。\n\n使用法拉第常数$F = 96485\\, \\mathrm{C}/\\mathrm{mol}$。所有物理单位必须严格遵守如下规定：$D$的单位为$\\mathrm{m}^2/\\mathrm{s}$，$\\kappa$的单位为$\\mathrm{S}/\\mathrm{m}$，$L_s$的单位为$\\mathrm{m}$，$i$的单位为$\\mathrm{A}/\\mathrm{m}^2$，$c_0$的单位为$\\mathrm{mol}/\\mathrm{m}^3$，$V_{\\lim}$的单位为$\\mathrm{V}$，$f_{\\lim}$为纯数（无量纲分数）。输出的浮点数必须表示为六位小数。\n\n测试套件：\n为以下三个参数集中的每一个计算输出：\n- 案例A（基准）：$D = 2.5\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\kappa = 1.0\\,\\mathrm{S}/\\mathrm{m}$, $L_s = 25\\times 10^{-6}\\,\\mathrm{m}$, $t_+^0 = 0.38$, $c_0 = 1000\\,\\mathrm{mol}/\\mathrm{m}^3$, $i = 20\\,\\mathrm{A}/\\mathrm{m}^2$, $V_{\\lim} = 0.10\\,\\mathrm{V}$, $f_{\\lim} = 0.20$, $b = 1.5$。\n- 案例B（迁移限制）：$D = 1.8\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\kappa = 0.8\\,\\mathrm{S}/\\mathrm{m}$, $L_s = 20\\times 10^{-6}\\,\\mathrm{m}$, $t_+^0 = 0.38$, $c_0 = 1200\\,\\mathrm{mol}/\\mathrm{m}^3$, $i = 60\\,\\mathrm{A}/\\mathrm{m}^2$, $V_{\\lim} = 0.05\\,\\mathrm{V}$, $f_{\\lim} = 0.10$, $b = 1.5$。\n- 案例C（高曲折度）：$D = 3.0\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\kappa = 1.5\\,\\mathrm{S}/\\mathrm{m}$, $L_s = 35\\times 10^{-6}\\,\\mathrm{m}$, $t_+^0 = 0.38$, $c_0 = 900\\,\\mathrm{mol}/\\mathrm{m}^3$, $i = 100\\,\\mathrm{A}/\\mathrm{m}^2$, $V_{\\lim} = 0.08\\,\\mathrm{V}$, $f_{\\lim} = 0.15$, $b = 2.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的结果，形式为由方括号括起来的子列表的逗号分隔列表。每个子列表必须包含七个浮点数，顺序与上文完全一致，每个浮点数格式化为六位小数，无空格。例如：\n\"[[x1,x2,x3,x4,x5,x6,x7],[y1,y2,y3,y4,y5,y6,y7],[z1,z2,z3,z4,z5,z6,z7]]\"",
            "solution": "该问题陈述经评估为有效，因为它科学地基于已建立的电化学传输和多孔介质理论原理，问题设定完备并提供了所有必要参数，并且是客观和可形式化的。我们继续进行推导和求解。\n\n分析的重点是量化锂离子电池隔膜中的传输限制，特别是改变孔隙率$\\varepsilon$的影响。隔膜被视为厚度为$L_s$的一维、均匀多孔介质。所有计算均在Doyle-Fuller-Newman (DFN)模型的稀二元电解质假设下进行。\n\n**1. 有效传输性质的推导**\n\n在多孔介质中，由于可用于传输的体积分数减少以及离子和分子必须行进的路径长度增加（曲折度），有效传输性质相较于其体相值有所降低。一个常见且物理上合理的模型是Bruggeman关系式，它将有效性质$X_{\\mathrm{eff}}$与其体相值$X$和孔隙率$\\varepsilon$联系起来，形式为幂律：\n$$X_{\\mathrm{eff}} = X \\varepsilon^b$$\n其中$b$是结构或曲折度指数。该指数是一个经验参数，取决于多孔结构的几何形状，对于均匀球体的堆积，经典值为$b=1.5$。\n\n将此关系应用于电解质盐扩散系数$D$和离子电导率$\\kappa$：\n$$D_{\\mathrm{eff}} = D \\varepsilon^b$$\n$$\\kappa_{\\mathrm{eff}} = \\kappa \\varepsilon^b$$\n\n因此，孔隙率为$\\varepsilon_2 = 0.3$时的有效性质与孔隙率为$\\varepsilon_1 = 0.4$时的有效性质之比为：\n$$\\frac{D_{\\mathrm{eff}}(\\varepsilon_2)}{D_{\\mathrm{eff}}(\\varepsilon_1)} = \\frac{D \\varepsilon_2^b}{D \\varepsilon_1^b} = \\left(\\frac{\\varepsilon_2}{\\varepsilon_1}\\right)^b = \\left(\\frac{0.3}{0.4}\\right)^b = 0.75^b$$\n$$\\frac{\\kappa_{\\mathrm{eff}}(\\varepsilon_2)}{\\kappa_{\\mathrm{eff}}(\\varepsilon_1)} = \\frac{\\kappa \\varepsilon_2^b}{\\kappa \\varepsilon_1^b} = \\left(\\frac{\\varepsilon_2}{\\varepsilon_1}\\right)^b = \\left(\\frac{0.3}{0.4}\\right)^b = 0.75^b$$\n这些表达式将用于计算前两个要求的输出。\n\n**2. 浓差极化的推导**\n\n在稳态操作下，恒定的电流密度$i$流过电池。在隔膜中，此电流完全由电解质中的离子承载。对于二元1:1电解质（例如，LiPF$_6 \\rightarrow \\mathrm{Li}^+ + \\mathrm{PF}_6^-$），在一维情况下，盐的通量$N_s$由浓溶液理论给出，对于稀溶液，该理论简化为：\n$$N_s(x) = -D_{\\mathrm{eff}} \\frac{dc}{dx} + \\frac{i t_+^0}{F}$$\n其中$c$是盐浓度，$t_+^0$是阳离子迁移数（假设为常数），$F$是法拉第常数。\n\n在稳态下，隔膜中不发生化学反应，盐的质量守恒定律为$\\frac{dN_s}{dx} = 0$。这意味着盐通量$N_s$在整个隔膜上是恒定的。然而，隔膜的两侧是电极，阴离子在电极处被阻断。因此，阴离子通量在整个隔膜中必须为零。这一条件意味着为了维持电中性，盐通量也必须为零（即$N_s=0$）。\n在通量方程中设置$N_s=0$得到：\n$$0 = -D_{\\mathrm{eff}} \\frac{dc}{dx} + \\frac{i t_+^0}{F}$$\n这是不正确的。正确的方法考虑了阳离子和阴离子的通量。净盐通量为零的条件是不正确的。稀溶液理论对于稳态电流的正确陈述是，浓度梯度是恒定的，并由下式给出：\n$$\\frac{dc}{dx} = -\\frac{i(1-t_+^0)}{F D_{\\mathrm{eff}}}$$\n将此表达式从阳极侧（$x=0$）到阴极侧（$x=L_s$）对隔膜厚度$L_s$进行积分，得到总浓度变化$\\Delta c$：\n$$\\Delta c = c(L_s) - c(0) = \\int_0^{L_s} \\left( -\\frac{i(1-t_+^0)}{F D_{\\mathrm{eff}}} \\right) dx = -\\frac{i(1-t_+^0)L_s}{F D_{\\mathrm{eff}}}$$\n这个浓度变化的绝对值，即浓差极化，除以体相浓度$c_0$得到所要求的无量纲分数$f_c$：\n$$f_c = \\frac{|\\Delta c|}{c_0} = \\frac{i(1-t_+^0)L_s}{c_0 F D_{\\mathrm{eff}}}$$\n代入$D_{\\mathrm{eff}}$的表达式：\n$$f_c(\\varepsilon) = \\frac{i(1-t_+^0)L_s}{c_0 F D \\varepsilon^b}$$\n此方程用于计算第三和第四个要求的输出。\n\n**3. 欧姆电位降的推导**\n\n多孔介质中的离子欧姆定律将离子电流密度$i$与电解质电位$\\phi_e$的梯度联系起来。在定义“欧姆降”时忽略扩散电位，我们有：\n$$i = -\\kappa_{\\mathrm{eff}} \\frac{d\\phi_e}{dx}$$\n穿过隔膜的电位降$V_{\\mathrm{ohmic}}$是$\\phi_e$穿过厚度$L_s$的变化的绝对值：\n$$V_{\\mathrm{ohmic}} = |\\Delta \\phi_e| = \\left| \\int_0^{L_s} d\\phi_e \\right| = \\left| \\int_0^{L_s} \\left(-\\frac{i}{\\kappa_{\\mathrm{eff}}}\\right) dx \\right| = \\frac{i L_s}{\\kappa_{\\mathrm{eff}}}$$\n代入$\\kappa_{\\mathrm{eff}}$的表达式：\n$$V_{\\mathrm{ohmic}}(\\varepsilon) = \\frac{i L_s}{\\kappa \\varepsilon^b}$$\n\n**4. 倍率性能指标$i_{\\max}$的推导**\n\n最大允许电流密度$i_{\\max}$由两个约束条件定义：\n1. 浓差极化分数$f_c$不得超过极限$f_{\\lim}$：\n$$f_c = \\frac{i(1-t_+^0)L_s}{c_0 F D \\varepsilon^b} \\le f_{\\lim} \\implies i \\le \\frac{f_{\\lim} c_0 F D \\varepsilon^b}{(1-t_+^0)L_s} \\equiv i_{c, \\mathrm{lim}}$$\n2. 欧姆电位降$V_{\\mathrm{ohmic}}$不得超过极限$V_{\\lim}$：\n$$V_{\\mathrm{ohmic}} = \\frac{i L_s}{\\kappa \\varepsilon^b} \\le V_{\\lim} \\implies i \\le \\frac{V_{\\lim} \\kappa \\varepsilon^b}{L_s} \\equiv i_{V, \\mathrm{lim}}$$\n倍率性能$i_{\\max}$是满足这两个条件的最大电流密度，即两个单独极限中的最小值：\n$$i_{\\max}(\\varepsilon) = \\min(i_{c, \\mathrm{lim}}, i_{V, \\mathrm{lim}}) = \\min\\left( \\frac{f_{\\lim} c_0 F D \\varepsilon^b}{(1-t_+^0)L_s}, \\frac{V_{\\lim} \\kappa \\varepsilon^b}{L_s} \\right)$$\n这可以重写为：\n$$i_{\\max}(\\varepsilon) = \\varepsilon^b \\cdot \\min\\left( \\frac{f_{\\lim} c_0 F D}{(1-t_+^0)L_s}, \\frac{V_{\\lim} \\kappa}{L_s} \\right)$$\n这些表达式将用于计算第五和第六个输出。第七个输出，$i_{\\max}(0.3)/i_{\\max}(0.4)$的比值，则为：\n$$\\frac{i_{\\max}(0.3)}{i_{\\max}(0.4)} = \\frac{0.3^b}{0.4^b} = 0.75^b$$\n\n这些推导出的公式为所需的计算提供了完整的基础。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes transport and rate performance metrics for a Li-ion battery separator\n    based on DFN model assumptions for three test cases.\n    \"\"\"\n    \n    # Faraday constant in C/mol\n    F = 96485.0\n\n    # Porosities under consideration\n    eps_1 = 0.4\n    eps_2 = 0.3\n\n    test_cases = [\n        # Case A (baseline)\n        {'D': 2.5e-10, 'kappa': 1.0, 'L_s': 25e-6, 't_plus_0': 0.38, 'c_0': 1000, \n         'i': 20, 'V_lim': 0.10, 'f_lim': 0.20, 'b': 1.5},\n        # Case B (migration-limited)\n        {'D': 1.8e-10, 'kappa': 0.8, 'L_s': 20e-6, 't_plus_0': 0.38, 'c_0': 1200, \n         'i': 60, 'V_lim': 0.05, 'f_lim': 0.10, 'b': 1.5},\n        # Case C (high tortuosity)\n        {'D': 3.0e-10, 'kappa': 1.5, 'L_s': 35e-6, 't_plus_0': 0.38, 'c_0': 900, \n         'i': 100, 'V_lim': 0.08, 'f_lim': 0.15, 'b': 2.0}\n    ]\n\n    all_results_str = []\n\n    for params in test_cases:\n        D = params['D']\n        kappa = params['kappa']\n        L_s = params['L_s']\n        t_plus_0 = params['t_plus_0']\n        c_0 = params['c_0']\n        i = params['i']\n        V_lim = params['V_lim']\n        f_lim = params['f_lim']\n        b = params['b']\n\n        # 1. Ratio D_eff(0.3)/D_eff(0.4)\n        ratio_D_eff = (eps_2 / eps_1)**b\n\n        # 2. Ratio kappa_eff(0.3)/kappa_eff(0.4)\n        ratio_kappa_eff = (eps_2 / eps_1)**b\n\n        # Helper function for concentration polarization fraction\n        def calculate_f_c(eps):\n            D_eff = D * (eps**b)\n            return (i * (1 - t_plus_0) * L_s) / (c_0 * F * D_eff)\n\n        # 3. Concentration polarization fraction at porosity 0.4\n        f_c_1 = calculate_f_c(eps_1)\n\n        # 4. Concentration polarization fraction at porosity 0.3\n        f_c_2 = calculate_f_c(eps_2)\n\n        # Helper function for rate capability\n        def calculate_i_max(eps):\n            # Limit from concentration polarization\n            i_c_lim = (f_lim * c_0 * F * D * (eps**b)) / ((1 - t_plus_0) * L_s)\n            \n            # Limit from ohmic drop\n            i_V_lim = (V_lim * kappa * (eps**b)) / L_s\n            \n            return min(i_c_lim, i_V_lim)\n\n        # 5. Rate capability i_max at porosity 0.4\n        i_max_1 = calculate_i_max(eps_1)\n\n        # 6. Rate capability i_max at porosity 0.3\n        i_max_2 = calculate_i_max(eps_2)\n\n        # 7. Ratio i_max(0.3)/i_max(0.4)\n        ratio_i_max = (eps_2 / eps_1)**b\n        \n        case_results = [\n            ratio_D_eff,\n            ratio_kappa_eff,\n            f_c_1,\n            f_c_2,\n            i_max_1,\n            i_max_2,\n            ratio_i_max,\n        ]\n        \n        # Format each result to six decimal places and create the sublist string\n        formatted_case_results = [f\"{val:.6f}\" for val in case_results]\n        all_results_str.append(f\"[{','.join(formatted_case_results)}]\")\n\n    # Join the sublist strings and enclose in the final brackets\n    final_output = f\"[{','.join(all_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "DFN 模型的真正威力在于其耦合多种物理现象的能力。这个高级练习通过探究电解质浓度梯度（一种传输效应）如何直接影响驱动反应动力学的局部界面过电势，来展示这种耦合作用。通过剖析欧姆压降和扩散电势降的变化，您将理解传输限制是如何体现为反应界面上动力学壁垒的增加 。",
            "id": "3906561",
            "problem": "考虑一个使用 Doyle–Fuller–Newman (DFN) 多孔电极框架建模的锂离子电池。局部界面过电势定义为 $\\eta = \\phi_s - \\phi_e - U$，其中 $\\phi_s$ 是固相电势，$\\phi_e$ 是电解液相电势，而 $U$ 是活性物质的开路电势。在 DFN 模型中，一维电解液电流密度 $i_e$ 可通过浓溶液理论与电解液电势梯度和浓度梯度相关联。使用以下基本原理，不引用任何简化公式：\n- 电解液中的电荷中性、恒定化合价输运、多孔介质中离子传导的一维欧姆定律，以及 Nernst–Planck 方程的迁移贡献，这些共同表明电解液电流密度 $i_e$ 依赖于 $\\partial \\phi_e / \\partial x$ 和 $\\partial \\ln c_e / \\partial x$。\n- 过电势的定义 $\\eta = \\phi_s - \\phi_e - U$ 以及当 $\\phi_s$ 和 $U$ 保持固定时，反应界面处 $\\phi_e$ 的变化会直接改变 $\\eta$ 的原理。\n- 有效电解液电导率的 Bruggeman 型标度关系 $\\kappa_{\\mathrm{eff}} = \\kappa(c_e)\\,\\varepsilon^{b}$，其中 $\\kappa(c_e)$ 是依赖于浓度的体电导率。\n\n假设以下情景和建模假定，与高倍率操作下的 DFN 模型实践一致：\n- 电池以等于 $3$ C 的恒定 C 倍率驱动，因此施加的面电流密度完全由电极面积容量决定。\n- 在隔膜-正极界面附近，电解液经历一个厚度为 $\\delta_{\\mathrm{bl}}$ 的薄贫化边界层，在该层上，电解液浓度从隔膜侧的 $c_0$ 单调下降到正极入口处的 $c_0 - \\Delta c$。在该层之外，电解液浓度均匀且等于 $c_0$。\n- 在此边界层内，假设电解液电流密度 $i_e$ 近似恒定，并等于施加的面电流密度。\n- 体电解液电导率的标度关系为 $\\kappa(c_e) = \\kappa_0 \\left( \\dfrac{c_e}{c_0} \\right)^s$，其中指数 $s$ 反映了非理想的浓度依赖性，多孔介质中的有效电导率为 $\\kappa_{\\mathrm{eff}}(x) = \\kappa(c_e(x))\\,\\varepsilon^b$。\n- 迁移贡献使用等于 1 的热力学因子（忽略活度系数的变化），电解液中的阳离子迁移数为 $t_+$。\n- 电解液贫化对界面处电池过电势的贡献定义为：与在相同厚度 $\\delta_{\\mathrm{bl}}$ 上具有均匀浓度 $c_e(x) = c_0$ 的基准情况相比，仅由边界层贫化引起的 $\\phi_e$ 变化所导致的反应表面 $\\eta$ 的增量。\n\n从上述基本原理出发，推导一个用参数 $(\\delta_{\\mathrm{bl}}, c_0, \\Delta c, \\varepsilon, b, \\kappa_0, s, t_+, T)$ 和由面积容量确定的施加面电流密度表示的，在 $3$ C 倍率下电解液贫化对界面过电势的增量贡献的可计算表达式。将此表达式实现为一个程序，并对以下测试套件进行评估。所有物理量必须以连贯的国际单位制 (SI) 表示，输出必须以伏特 (V) 表示，并四舍五入到 $6$ 位小数。\n\n设在 $3$ C 倍率下的施加面电流密度由面积容量 $Q_{\\mathrm{areal}}$ (单位 $\\mathrm{mAh}/\\mathrm{cm}^2$) 通过以下公式计算\n$$\ni_{\\mathrm{app}} = 30\\,Q_{\\mathrm{areal}} \\quad \\text{in} \\quad \\mathrm{A}/\\mathrm{m}^2,\n$$\n使用转换关系 $1\\,\\mathrm{mA}/\\mathrm{cm}^2 = 10\\,\\mathrm{A}/\\mathrm{m}^2$ 和 $3$ C 倍率的因子 $3$。\n\n使用普适常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n\n测试套件参数：\n- 案例 A (理想情况)：$Q_{\\mathrm{areal}} = 4.0\\,\\mathrm{mAh}/\\mathrm{cm}^2$, $c_0 = 1000.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\Delta c = 200.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\delta_{\\mathrm{bl}} = 2.0\\times 10^{-5}\\,\\mathrm{m}$, $\\varepsilon = 0.40$, $b = 1.5$, $\\kappa_0 = 1.2\\,\\mathrm{S}/\\mathrm{m}$, $s = 1.0$, $t_+ = 0.38$, $T = 298.15\\,\\mathrm{K}$。\n- 案例 B (近似均匀浓度边界)：$Q_{\\mathrm{areal}} = 4.0\\,\\mathrm{mAh}/\\mathrm{cm}^2$, $c_0 = 1000.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\Delta c = 20.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\delta_{\\mathrm{bl}} = 2.0\\times 10^{-5}\\,\\mathrm{m}$, $\\varepsilon = 0.40$, $b = 1.5$, $\\kappa_0 = 1.2\\,\\mathrm{S}/\\mathrm{m}$, $s = 1.0$, $t_+ = 0.38$, $T = 298.15\\,\\mathrm{K}$。\n- 案例 C (严重贫化和较低电导率)：$Q_{\\mathrm{areal}} = 5.0\\,\\mathrm{mAh}/\\mathrm{cm}^2$, $c_0 = 1000.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\Delta c = 400.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\delta_{\\mathrm{bl}} = 5.0\\times 10^{-5}\\,\\mathrm{m}$, $\\varepsilon = 0.35$, $b = 1.5$, $\\kappa_0 = 0.9\\,\\mathrm{S}/\\mathrm{m}$, $s = 1.0$, $t_+ = 0.38$, $T = 298.15\\,\\mathrm{K}$。\n- 案例 D (非线性电导率指数和较高迁移数)：$Q_{\\mathrm{areal}} = 3.0\\,\\mathrm{mAh}/\\mathrm{cm}^2$, $c_0 = 1200.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\Delta c = 300.0\\,\\mathrm{mol}/\\mathrm{m}^3$, $\\delta_{\\mathrm{bl}} = 1.0\\times 10^{-5}\\,\\mathrm{m}$, $\\varepsilon = 0.45$, $b = 1.5$, $\\kappa_0 = 1.1\\,\\mathrm{S}/\\mathrm{m}$, $s = 0.8$, $t_+ = 0.50$, $T = 308.15\\,\\mathrm{K}$。\n\n您的程序应生成单行输出，其中包含四个案例的由贫化引起的增量过电势，以逗号分隔的列表形式包含在方括号内，单位为伏特，四舍五入到 $6$ 位小数，例如，$\\left[\\eta_A,\\eta_B,\\eta_C,\\eta_D\\right]$ 打印为 $\\left[\\text{value}_A,\\text{value}_B,\\text{value}_C,\\text{value}_D\\right]$。",
            "solution": "该问题是有效的，因为它在科学上基于电化学输运现象的原理，特别是 Doyle-Fuller-Newman (DFN) 模型，并且是良态、客观和完整的，假设线性浓度分布是对薄边界层上单调下降的最合理解释。\n\n目标是推导电解液贫化对界面过电势的增量贡献的表达式，记为 $\\Delta\\eta_{\\mathrm{dep}}$。该量被定义为，与具有均匀浓度 $c_e(x) = c_0$ 的基准情况相比，由于电解液浓度贫化而在反应表面（正极入口，$x=\\delta_{\\mathrm{bl}}$）处过电势 $\\eta$ 的增加量。\n\n过电势由 $\\eta = \\phi_s - \\phi_e - U$ 给出。由于固相电势 $\\phi_s$ 和开路电势 $U$ 被认为是固定的，过电势的变化仅由反应表面（$x=\\delta_{\\mathrm{bl}}$）处电解液电势 $\\phi_e$ 的变化引起：\n$$\n\\Delta\\eta_{\\mathrm{dep}} = \\eta_{\\mathrm{dep}} - \\eta_{\\mathrm{base}} = (\\phi_s - \\phi_{e, \\mathrm{dep}}(\\delta_{\\mathrm{bl}}) - U) - (\\phi_s - \\phi_{e, \\mathrm{base}}(\\delta_{\\mathrm{bl}}) - U) = -(\\phi_{e, \\mathrm{dep}}(\\delta_{\\mathrm{bl}}) - \\phi_{e, \\mathrm{base}}(\\delta_{\\mathrm{bl}}))\n$$\n对于这两种情况，我们可以在边界层的隔膜侧设置一个参考电势 $\\phi_e(0) = 0$。然后通过对厚度为 $\\delta_{\\mathrm{bl}}$ 的边界层上的电势梯度进行积分，来求得电极界面处的电势。\n\n根据所提供的基本原理（热力学因子为 1 的简化浓溶液理论），浓二元电解质中电解液电流密度 $i_e$ 的控制方程为：\n$$\ni_e = -\\kappa_{\\mathrm{eff}}(x) \\frac{\\partial \\phi_e}{\\partial x} + \\frac{2 R T \\kappa_{\\mathrm{eff}}(x)}{F}(1 - t_+) \\frac{\\partial \\ln c_e}{\\partial x}\n$$\n其中 $R$ 是普适气体常数，$T$ 是温度，$F$ 是法拉第常数，$t_+$ 是阳离子迁移数。我们重排此式以求解电解液电势梯度：\n$$\n\\frac{\\partial \\phi_e}{\\partial x} = -\\frac{i_e}{\\kappa_{\\mathrm{eff}}(x)} + \\frac{2 R T}{F}(1 - t_+) \\frac{\\partial \\ln c_e}{\\partial x}\n$$\n在边界层内，我们假设 $i_e$ 是恒定的，并且等于施加的面电流密度，即 $i_e = i_{\\mathrm{app}}$。从 $x=0$ 到 $x=\\delta_{\\mathrm{bl}}$ 积分，得到跨越该层的电势降：\n$$\n\\phi_e(\\delta_{\\mathrm{bl}}) = \\int_0^{\\delta_{\\mathrm{bl}}} \\frac{\\partial \\phi_e}{\\partial x} dx = \\int_0^{\\delta_{\\mathrm{bl}}} \\left( -\\frac{i_{\\mathrm{app}}}{\\kappa_{\\mathrm{eff}}(x)} \\right) dx + \\int_0^{\\delta_{\\mathrm{bl}}} \\left( \\frac{2 R T}{F}(1 - t_+) \\frac{\\partial \\ln c_e}{\\partial x} \\right) dx\n$$\n第一项是欧姆电势降 $\\Delta\\phi_{\\mathrm{ohm}}$，第二项是扩散电势降 $\\Delta\\phi_{\\mathrm{diff}}$。\n$$\n\\Delta\\phi_{\\mathrm{diff}} = \\frac{2 R T}{F}(1 - t_+) \\int_{c_e(0)}^{c_e(\\delta_{\\mathrm{bl}})} d(\\ln c_e) = \\frac{2 R T}{F}(1 - t_+) \\ln\\left(\\frac{c_e(\\delta_{\\mathrm{bl}})}{c_e(0)}\\right)\n$$\n在贫化情况下，$c_e(0) = c_0$ 且 $c_e(\\delta_{\\mathrm{bl}}) = c_0 - \\Delta c$。\n在基准情况下，$c_e(x)=c_0$，因此 $\\frac{\\partial \\ln c_e}{\\partial x} = 0$，且 $\\Delta\\phi_{\\mathrm{diff, base}} = 0$。\n\n增量过电势可以分解为：\n$$\n\\Delta\\eta_{\\mathrm{dep}} = -[(\\Delta\\phi_{\\mathrm{ohm, dep}} + \\Delta\\phi_{\\mathrm{diff, dep}}) - (\\Delta\\phi_{\\mathrm{ohm, base}} + \\Delta\\phi_{\\mathrm{diff, base}})] = -(\\Delta\\phi_{\\mathrm{ohm, dep}} - \\Delta\\phi_{\\mathrm{ohm, base}}) - \\Delta\\phi_{\\mathrm{diff, dep}}\n$$\n我们来定义对增量过电势的欧姆贡献和扩散贡献：\n$\\Delta\\eta_{\\mathrm{ohm}} = -(\\Delta\\phi_{\\mathrm{ohm, dep}} - \\Delta\\phi_{\\mathrm{ohm, base}})$\n$\\Delta\\eta_{\\mathrm{diff}} = - \\Delta\\phi_{\\mathrm{diff, dep}}$\n因此，$\\Delta\\eta_{\\mathrm{dep}} = \\Delta\\eta_{\\mathrm{ohm}} + \\Delta\\eta_{\\mathrm{diff}}$。\n\n首先，我们计算扩散贡献：\n$$\n\\Delta\\eta_{\\mathrm{diff}} = - \\frac{2 R T}{F}(1 - t_+) \\ln\\left(\\frac{c_0 - \\Delta c}{c_0}\\right) = - \\frac{2 R T}{F}(1 - t_+) \\ln\\left(1 - \\frac{\\Delta c}{c_0}\\right)\n$$\n由于 $\\Delta c > 0$，导致对数项为负，因此该项为正。\n\n接下来，我们计算欧姆贡献。我们假设边界层上存在线性浓度分布，$c_e(x) = c_0 - \\frac{\\Delta c}{\\delta_{\\mathrm{bl}}}x$。有效电导率为 $\\kappa_{\\mathrm{eff}}(x) = \\kappa_0 \\varepsilon^b \\left(\\frac{c_e(x)}{c_0}\\right)^s = \\kappa_0 \\varepsilon^b \\left(1 - \\frac{\\Delta c}{c_0} \\frac{x}{\\delta_{\\mathrm{bl}}}\\right)^s$。\n贫化情况下的欧姆电势降为：\n$$\n\\Delta\\phi_{\\mathrm{ohm, dep}} = -i_{\\mathrm{app}} \\int_0^{\\delta_{\\mathrm{bl}}} \\frac{dx}{\\kappa_{\\mathrm{eff}}(x)} = -\\frac{i_{\\mathrm{app}}}{\\kappa_0 \\varepsilon^b} \\int_0^{\\delta_{\\mathrm{bl}}} \\left(1 - \\frac{\\Delta c}{c_0} \\frac{x}{\\delta_{\\mathrm{bl}}}\\right)^{-s} dx\n$$\n在基准情况下，$c_e(x) = c_0$，因此 $\\kappa_{\\mathrm{eff, base}} = \\kappa_0 \\varepsilon^b$。\n$$\n\\Delta\\phi_{\\mathrm{ohm, base}} = -i_{\\mathrm{app}} \\int_0^{\\delta_{\\mathrm{bl}}} \\frac{dx}{\\kappa_0 \\varepsilon^b} = -\\frac{i_{\\mathrm{app}} \\delta_{\\mathrm{bl}}}{\\kappa_0 \\varepsilon^b}\n$$\n对增量过电势的欧姆贡献是：\n$$\n\\Delta\\eta_{\\mathrm{ohm}} = -(\\Delta\\phi_{\\mathrm{ohm, dep}} - \\Delta\\phi_{\\mathrm{ohm, base}}) = i_{\\mathrm{app}} \\left( \\int_0^{\\delta_{\\mathrm{bl}}} \\frac{dx}{\\kappa_{\\mathrm{eff}}(x)} - \\frac{\\delta_{\\mathrm{bl}}}{\\kappa_0 \\varepsilon^b} \\right) = \\frac{i_{\\mathrm{app}}}{\\kappa_0 \\varepsilon^b} \\left( \\int_0^{\\delta_{\\mathrm{bl}}} \\left(1 - \\frac{\\Delta c}{c_0} \\frac{x}{\\delta_{\\mathrm{bl}}}\\right)^{-s} dx - \\delta_{\\mathrm{bl}} \\right)\n$$\n我们计算这个积分。设 $A = \\frac{\\Delta c}{c_0}$ 且 $y = \\frac{x}{\\delta_{\\mathrm{bl}}}$，则 $dx = \\delta_{\\mathrm{bl}} dy$。\n$$\n\\int_0^{\\delta_{\\mathrm{bl}}} (1 - A \\frac{x}{\\delta_{\\mathrm{bl}}})^{-s} dx = \\delta_{\\mathrm{bl}} \\int_0^1 (1 - Ay)^{-s} dy\n$$\n对于 $s=1$ 的情况：\n$$\n\\int_0^1 (1 - Ay)^{-1} dy = \\left[ \\frac{\\ln(1 - Ay)}{-A} \\right]_0^1 = -\\frac{\\ln(1 - A)}{A}\n$$\n注意，这里的积分结果是 `delta_bl * (-ln(1-A)/A)`。代入 `Delta_eta_ohm` 表达式中，`delta_bl` 因子在外面。\n所以，`int_0^delta_bl ... dx` = `delta_bl * (-ln(1-A)/A)`.\n\n对于 $s \\neq 1$ 的情况：\n$$\n\\int_0^1 (1 - Ay)^{-s} dy = \\left[ \\frac{(1 - Ay)^{-s+1}}{(-s+1)(-A)} \\right]_0^1 = \\frac{(1-A)^{1-s} - 1}{A(s-1)}\n$$\n将这些代回到 $\\Delta\\eta_{\\mathrm{ohm}}$ 的表达式中：\n对于 $s=1$，设 $A = \\Delta c / c_0$：\n$$\n\\Delta\\eta_{\\mathrm{ohm}} = \\frac{i_{\\mathrm{app}} \\delta_{\\mathrm{bl}}}{\\kappa_0 \\varepsilon^b} \\left( -\\frac{1}{A} \\ln(1 - A) - 1 \\right)\n$$\n对于 $s \\neq 1$：\n$$\n\\Delta\\eta_{\\mathrm{ohm}} = \\frac{i_{\\mathrm{app}} \\delta_{\\mathrm{bl}}}{\\kappa_0 \\varepsilon^b} \\left( \\frac{(1 - A)^{1-s} - 1}{A(s-1)} - 1 \\right)\n$$\n总增量过电势 $\\Delta\\eta_{\\mathrm{dep}}$ 是 $\\Delta\\eta_{\\mathrm{ohm}} + \\Delta\\eta_{\\mathrm{diff}}$ 的和。这就提供了一个完整、可计算的表达式。\n\n施加的电流密度计算为 $i_{\\mathrm{app}} = 30\\,Q_{\\mathrm{areal}}$。\n\n我们现在将实现这些推导出的表达式，以计算给定测试套件的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the incremental contribution of electrolyte depletion\n    to the interfacial overpotential in a Li-ion cell based on the DFN model.\n    \"\"\"\n\n    # Universal constants\n    R = 8.314  # J mol^-1 K^-1\n    F = 96485  # C mol^-1\n\n    # Test suite parameters\n    test_cases = [\n        # Case A: happy path\n        {'Q_areal': 4.0, 'c0': 1000.0, 'dc': 200.0, 'd_bl': 2.0e-5, 'eps': 0.40, 'b': 1.5, 'k0': 1.2, 's': 1.0, 't_plus': 0.38, 'T': 298.15},\n        # Case B: near-uniform concentration boundary\n        {'Q_areal': 4.0, 'c0': 1000.0, 'dc': 20.0, 'd_bl': 2.0e-5, 'eps': 0.40, 'b': 1.5, 'k0': 1.2, 's': 1.0, 't_plus': 0.38, 'T': 298.15},\n        # Case C: severe depletion and lower conductivity\n        {'Q_areal': 5.0, 'c0': 1000.0, 'dc': 400.0, 'd_bl': 5.0e-5, 'eps': 0.35, 'b': 1.5, 'k0': 0.9, 's': 1.0, 't_plus': 0.38, 'T': 298.15},\n        # Case D: nonlinear conductivity and higher transference number\n        {'Q_areal': 3.0, 'c0': 1200.0, 'dc': 300.0, 'd_bl': 1.0e-5, 'eps': 0.45, 'b': 1.5, 'k0': 1.1, 's': 0.8, 't_plus': 0.50, 'T': 308.15},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        Q_areal = params['Q_areal']    # mAh/cm^2\n        c0 = params['c0']              # mol/m^3\n        dc = params['dc']              # mol/m^3\n        d_bl = params['d_bl']          # m\n        eps = params['eps']            # dimensionless\n        b = params['b']                # dimensionless\n        k0 = params['k0']              # S/m\n        s = params['s']                # dimensionless\n        t_plus = params['t_plus']      # dimensionless\n        T = params['T']                # K\n\n        # Calculate applied current density in A/m^2\n        i_app = 30 * Q_areal\n\n        # Handle trivial case of no depletion\n        if dc == 0:\n            results.append(0.0)\n            continue\n\n        # Relative concentration drop\n        rel_dc = dc / c0\n\n        # --- 1. Calculate diffusional contribution to overpotential (eta_diff) ---\n        # This term is positive as ln(1-rel_dc) is negative.\n        eta_diff = - (2 * R * T / F) * (1 - t_plus) * np.log(1 - rel_dc)\n\n        # --- 2. Calculate ohmic contribution to overpotential (eta_ohm) ---\n        # Effective conductivity in the baseline case (uniform concentration)\n        kappa_eff_base = k0 * (eps ** b)\n        \n        # Prefactor for the ohmic overpotential term\n        ohmic_prefactor = (i_app * d_bl) / kappa_eff_base\n        \n        # The core term depends on the conductivity exponent 's'\n        if np.isclose(s, 1.0):\n            # Special case for s = 1\n            if np.isclose(rel_dc, 0.0):\n                 ohmic_term_multiplier = 0.0\n            else:\n                 ohmic_term_multiplier = - (1 / rel_dc) * np.log(1 - rel_dc) - 1\n        else:\n            # General case for s != 1\n            if np.isclose(rel_dc, 0.0):\n                ohmic_term_multiplier = 0.0\n            else:\n                 ohmic_term_multiplier = ((1 - rel_dc)**(1 - s) - 1) / (rel_dc * (s - 1)) - 1\n        \n        eta_ohm = ohmic_prefactor * ohmic_term_multiplier\n\n        # --- 3. Total incremental overpotential ---\n        eta_depletion = eta_ohm + eta_diff\n\n        results.append(round(eta_depletion, 6))\n\n    # Format output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}