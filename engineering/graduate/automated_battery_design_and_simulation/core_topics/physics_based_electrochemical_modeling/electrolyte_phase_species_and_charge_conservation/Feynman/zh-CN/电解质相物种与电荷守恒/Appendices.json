{
    "hands_on_practices": [
        {
            "introduction": "在开发稳健的电池模型时，为了保证计算的可行性，简化假设是必不可少的。其中最强大的假设之一是电中性假设。本练习将深入探讨该假设的物理解释，要求您推导德拜长度$ \\lambda_D $，并将其与电池的宏观尺度进行比较，从而定量理解为何电解质本体可以被视为不带净电荷。",
            "id": "3911508",
            "problem": "在自动化电池设计与仿真中，通常通过援引宏观电中性来简化电解质相的物质守恒。请通过将电解质相的电荷密度与离子浓度相关联来定义电中性条件，然后通过推导和估算一种代表性的非水系锂离子电池电解质的德拜屏蔽长度，来证明该条件使用的合理性。\n\n从适用于电解质建模的第一性原理出发，使用以下基本原理：\n- 电介质中的静电场遵循泊松方程 $ \\nabla \\cdot \\left( \\varepsilon \\nabla \\phi \\right) = -\\rho_{e} $，其中 $ \\varepsilon $ 是介质的绝对介电常数，$ \\rho_{e} $ 是自由电荷密度。\n- 对于离子价态为 $ \\pm z $ 的对称二元电解质，在静电势 $ \\phi $ 存在的情况下，处于热平衡状态的局部物种数密度 $ n_{+} $ 和 $ n_{-} $ 遵循玻尔兹曼分布。\n- 热能标度由 $ k_{B} T $ 给出，其中 $ k_{B} $ 是玻尔兹曼常数，$ T $ 是绝对温度。\n- 电荷密度为 $ \\rho_{e} = e \\sum_{k} z_{k} n_{k} $，其中 $ e $ 是元电荷，$ z_{k} $ 是物种 $ k $ 的价态，$ n_{k} $ 是其数密度。\n\n执行以下任务：\n1. 通过用物种摩尔浓度 $ c_{k} $ 表示 $ \\rho_{e} $ 来定义宏观电中性，并用适用于多孔电极理论中电解质相物质和电荷守恒的语言解释条件 $ \\sum_{k} z_{k} c_{k} \\approx 0 $。\n2. 通过对小 $ \\phi $ 时的玻尔兹曼分布进行线性化，并与泊松方程结合，推导出对称二元电解质的德拜屏蔽长度 $ \\lambda_{D} $。用 $ \\varepsilon $、$ k_{B} T $、$ e $、阿伏伽德罗常数 $ N_{A} $ 以及单个物种的摩尔浓度 $ c_{k} $ 或离子强度 $ I $ 来表示 $ \\lambda_{D} $。\n3. 估算一种典型锂离子电池电解质的 $ \\lambda_{D} $：单价盐（因此 $ z = 1 $），每种离子的宏观摩尔浓度为 $ 1 \\ \\mathrm{mol/L} $，温度 $ T = 298 \\ \\mathrm{K} $，以及相对介电常数 $ \\varepsilon_{r} = 40 $ 的碳酸酯混合溶剂。使用真空介电常数 $ \\varepsilon_{0} $ 写出 $ \\varepsilon = \\varepsilon_{r} \\varepsilon_{0} $。为屏蔽计算目的，将该电解质视为理想电解质。\n4. 通过将 $ \\lambda_{D} $ 与典型的孔隙或隔膜特征尺寸（例如 $ 10 \\ \\mu \\mathrm{m} $）进行比较，简要证明在宏观电解质相物质和电荷守恒模型中使用宏观电中性假设的合理性，并指出 $ \\sum_{k} z_{k} c_{k} \\approx 0 $ 成立以及可能失效的适用范围。\n\n将德拜长度的最终数值四舍五入至三位有效数字，并以纳米为单位表示。",
            "solution": "该问题是有效的。其科学基础在于静电学和统计力学的原理，问题设置合理，任务明确，信息充分，并使用了客观、正式的语言。所提供的物理参数对于锂离子电池电解质体系是符合实际的。该问题要求对Debye-Hückel理论进行标准推导和应用，这与电解质建模直接相关。\n\n解题过程按顺序处理四个任务。\n\n1. 宏观电中性的定义\n\n电解质中的局部自由电荷密度 $\\rho_{e}$ 由所有离子物种 $k$ 的电荷总和给出：\n$$\n\\rho_{e} = \\sum_{k} q_{k} n_{k}\n$$\n其中 $q_k$ 是物种 $k$ 的单个离子的电荷，$n_k$ 是其局部数密度（单位体积内的离子数）。电荷由 $q_k = z_k e$ 给出，其中 $z_k$ 是离子的整数价态，$e$ 是元电荷。因此，表达式变为：\n$$\n\\rho_{e} = e \\sum_{k} z_{k} n_{k}\n$$\n数密度 $n_k$ 通过阿伏伽德罗常数 $N_A$ 与摩尔浓度 $c_k$（单位体积的摩尔数）相关，关系为 $n_k = N_A c_k$。将此代入电荷密度表达式，得到：\n$$\n\\rho_{e} = e N_A \\sum_{k} z_{k} c_{k}\n$$\n项 $F = e N_A$ 是法拉第常数，所以 $\\rho_e$ 也可以简写为 $\\rho_e = F \\sum_k z_k c_k$。\n\n宏观电中性原理是指，在远大于电解质特征屏蔽长度的尺度上，净局部电荷密度实际上为零。对于远离界面（在界面处，电荷分离会形成双电层）的电解质“体相”区域，这是一个极好的近似。在数学上，该条件表示为 $\\rho_e \\approx 0$。鉴于 $e$ 和 $N_A$ 是非零的基本常数，此近似等价于：\n$$\n\\sum_{k} z_{k} c_{k} \\approx 0\n$$\n在电池的多孔电极理论背景下，该条件意味着电解质相在电极孔隙或隔膜结构（通常为微米级）的尺度上观察时，不维持净的体电荷。任何局部的电荷不平衡都被假定为几乎瞬时地被移动离子所屏蔽。援引这一约束简化了离子输运的控制方程，用一个关联离子浓度的代数约束，取代了在整个电解质区域求解计算成本高昂的、用以获得电势的泊松方程。\n\n2. 德拜屏蔽长度的推导\n\n我们从均匀电介质中静电势 $\\phi$ 的泊松方程开始，其绝对介电常数为 $\\varepsilon$：\n$$\n\\nabla^2 \\phi = -\\frac{\\rho_{e}}{\\varepsilon}\n$$\n对于一个离子价态为 $+z$ 和 $-z$ 的对称二元电解质，在温度为 $T$ 的热平衡状态下，其数密度 $n_{+}$ 和 $n_{-}$ 遵循玻尔兹曼分布。如果在没有电场时（即 $\\phi=0$），每种物种的体相数密度为 $n_0$，那么在存在电势 $\\phi(\\mathbf{r})$ 的情况下，局部密度为：\n$$\nn_{+}(\\mathbf{r}) = n_0 \\exp\\left(-\\frac{ze\\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n$$\nn_{-}(\\mathbf{r}) = n_0 \\exp\\left(+\\frac{ze\\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数。局部电荷密度 $\\rho_e$ 是：\n$$\n\\rho_e = e(z n_{+} - z n_{-}) = ze n_0 \\left[ \\exp\\left(-\\frac{ze\\phi}{k_B T}\\right) - \\exp\\left(\\frac{ze\\phi}{k_B T}\\right) \\right]\n$$\n该问题要求在小电势下对该表达式进行线性化，即静电能远小于热能时， $|ze\\phi| \\ll k_B T$。对小 $x$ 使用一阶泰勒展开 $\\exp(x) \\approx 1 + x$：\n$$\n\\rho_e \\approx ze n_0 \\left[ \\left(1 - \\frac{ze\\phi}{k_B T}\\right) - \\left(1 + \\frac{ze\\phi}{k_B T}\\right) \\right] = ze n_0 \\left( -2 \\frac{ze\\phi}{k_B T} \\right) = -\\frac{2 z^2 e^2 n_0}{k_B T} \\phi\n$$\n将这个线性化的电荷密度代入泊松方程，得到线性化的泊松-玻尔兹曼方程：\n$$\n\\nabla^2 \\phi = -\\frac{1}{\\varepsilon} \\left( -\\frac{2 z^2 e^2 n_0}{k_B T} \\phi \\right) = \\left( \\frac{2 z^2 e^2 n_0}{\\varepsilon k_B T} \\right) \\phi\n$$\n这是一个形式为 $\\nabla^2 \\phi = \\kappa^2 \\phi$ 的亥姆霍兹型方程。电势衰减的特征长度尺度是 $\\lambda_D = 1/\\kappa$。通过比较形式，我们将德拜屏蔽长度的平方反比确定为：\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{2 z^2 e^2 n_0}{\\varepsilon k_B T}\n$$\n解出 $\\lambda_D$ 得到：\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{2 z^2 e^2 n_0}}\n$$\n为了用摩尔浓度表示，我们使用 $n_0 = N_A c_0$，其中 $c_0$ 是对称盐中每种离子物种的体相摩尔浓度。\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{2 z^2 e^2 N_A c_0}}\n$$\n对于一般电解质，推导过程通过线性化 $\\rho_e = e \\sum_k z_k n_{k,0} \\exp(-z_k e \\phi / k_B T)$ 进行，得到 $\\rho_e \\approx -(e^2 \\phi / k_B T) \\sum_k z_k^2 n_{k,0}$。由此得到的德拜长度为：\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{e^2 \\sum_k z_k^2 n_{k,0}}} = \\sqrt{\\frac{\\varepsilon k_B T}{e^2 N_A \\sum_k z_k^2 c_{k,0}}}\n$$\n离子强度定义为 $I = \\frac{1}{2}\\sum_k z_k^2 c_{k,0}$。代入此定义可得到另一种形式：\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{2 e^2 N_A I}}\n$$\n\n3. 德拜长度的估算\n\n给定一种典型锂离子电池电解质的以下参数：\n- 单价盐: $z_+ = 1$, $z_- = -1$。\n- 每种物种的体相摩尔浓度: $c_+ = c_- = 1 \\ \\mathrm{mol/L}$。\n- 温度: $T = 298 \\ \\mathrm{K}$。\n- 相对介电常数: $\\varepsilon_r = 40$。\n绝对介电常数为 $\\varepsilon = \\varepsilon_r \\varepsilon_0$。\n\n我们必须使用国际单位制（SI）进行计算。浓度为 $c_0 = 1 \\ \\mathrm{mol/L} = 1000 \\ \\mathrm{mol/m^3}$。\n对于我们的对称1:1型电解质，求和项为 $\\sum_k z_k^2 c_{k,0} = z_+^2 c_+ + z_-^2 c_- = (1)^2 c_0 + (-1)^2 c_0 = 2c_0 = 2000 \\ \\mathrm{mol/m^3}$。\n\n我们使用推导出的 $\\lambda_D$ 表达式：\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon_r \\varepsilon_0 k_B T}{e^2 N_A (2 c_0)}}\n$$\n使用基本常数的值：\n- $\\varepsilon_0 \\approx 8.854 \\times 10^{-12} \\ \\mathrm{F/m}$\n- $k_B \\approx 1.3806 \\times 10^{-23} \\ \\mathrm{J/K}$\n- $e \\approx 1.6022 \\times 10^{-19} \\ \\mathrm{C}$\n- $N_A \\approx 6.022 \\times 10^{23} \\ \\mathrm{mol^{-1}}$\n\n分子 = $\\varepsilon_r \\varepsilon_0 k_B T = (40) \\times (8.854 \\times 10^{-12}) \\times (1.3806 \\times 10^{-23}) \\times (298) \\approx 1.4583 \\times 10^{-30} \\ \\mathrm{C^2 \\cdot m^{-1}}$\n分母 = $e^2 N_A (2 c_0) = (1.6022 \\times 10^{-19})^2 \\times (6.022 \\times 10^{23}) \\times (2000) \\approx 3.0908 \\times 10^{-11} \\ \\mathrm{C^2 \\cdot m^{-3}}$\n\n$$\n\\lambda_D^2 = \\frac{1.4583 \\times 10^{-30} \\ \\mathrm{C^2 \\cdot m^{-1}}}{3.0908 \\times 10^{-11} \\ \\mathrm{C^2 \\cdot m^{-3}}} \\approx 4.718 \\times 10^{-20} \\ \\mathrm{m}^2\n$$\n$$\n\\lambda_D = \\sqrt{4.718 \\times 10^{-20} \\ \\mathrm{m}^2} \\approx 2.172 \\times 10^{-10} \\ \\mathrm{m}\n$$\n为了以纳米（$1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$）为单位表示结果，我们有：\n$$\n\\lambda_D = 0.2172 \\ \\mathrm{nm}\n$$\n四舍五入到三位有效数字，德拜长度为 $0.217 \\ \\mathrm{nm}$。\n\n4. 宏观电中性假设的合理性证明\n\n计算出的德拜屏蔽长度为 $\\lambda_D \\approx 0.217 \\ \\mathrm{nm}$。该值代表了电荷分离持续存在且静电效应显著的特征长度尺度。我们将其与电池多孔电极或隔膜的典型长度尺度 $L$（给定为 $L = 10 \\ \\mu \\mathrm{m}$）进行比较。\n$$\nL = 10 \\ \\mu\\mathrm{m} = 10 \\times 10^{-6} \\ \\mathrm{m} = 10000 \\ \\mathrm{nm}\n$$\n这些长度尺度的比值为：\n$$\n\\frac{L}{\\lambda_D} = \\frac{10000 \\ \\mathrm{nm}}{0.217 \\ \\mathrm{nm}} \\approx 46000\n$$\n由于特征宏观尺寸 $L$ 比德拜长度 $\\lambda_D$ 大四个数量级以上，因此宏观电中性的假设是极其合理的。任何局部的电荷不平衡都会在与所建模的特征尺寸相比可以忽略不计的距离内被屏蔽掉。显著的净电荷密度被限制在电极-电解质界面的无限薄区域内，这些区域被称为双电层，其厚度约为 $\\lambda_D$ 的量级。绝大部分电解质体积——即“体相”——可以被视为局部电中性，即 $\\sum_k z_k c_k \\approx 0$。\n\n仅当系统的特征尺寸与德拜长度相当时，此近似才会失效。例如，在孔径仅为几纳米的纳米多孔材料中，来自相对孔壁的双电层会发生重叠。在这种“双电层重叠”的情况下，孔内的整个电解质都是非中性的，宏观电中性假设无效。然而，对于典型的电池微观结构，它对于宏观输运模型来说是一个稳健且必要的简化。",
            "answer": "$$\\boxed{0.217}$$"
        },
        {
            "introduction": "一旦我们接受了电中性假设，就可以简化对离子输运的描述。在没有净电流的情况下（例如开路电池），正负离子的耦合运动可以被建模为单一中性“盐”的扩散。本练习将引导您推导双极性扩散系数$D_{\\mathrm{amb}}(c)$，这是一个关键参数，它概括了这种集体行为，并将其与离子迁移率及电解质的热力学非理想性联系起来。",
            "id": "3911509",
            "problem": "考虑一个与自动化电池设计和仿真相关的二元$1{:}1$电解质，其阳离子价态为 $z_{+} = +1$，阴离子价态为 $z_{-} = -1$，处于等温、静止的电解质相中，无对流并满足电中性条件。设阳离子和阴离子浓度相等，即 $c_{+} = c_{-} = c$，电解质相电势为 $\\phi_{e}$。物质通量由基于化学势梯度的能斯特-普朗克定律的热力学形式决定，并使用了能斯特-爱因斯坦关系，因此对于物种 $i \\in \\{+, -\\}$,\n$$\n\\mathbf{N}_{i} = -\\frac{D_{i} c_{i}}{R T} \\nabla \\mu_{i},\n$$\n其中 $D_{i}$ 是物种 $i$ 的示踪扩散系数，$R$ 是通用气体常数，$T$ 是绝对温度，并且\n$$\n\\mu_{i} = \\mu_{i}^{0} + R T \\ln a_{\\pm}(c) + z_{i} F \\phi_{e}\n$$\n是电化学势，其中 $F$ 是法拉第常数，$a_{\\pm}(c)$ 是二元电解质的平均摩尔活度。定义热力学因子\n$$\n\\chi(c) \\equiv 1 + \\frac{d \\ln \\gamma_{\\pm}(c)}{d \\ln c},\n$$\n其中 $a_{\\pm}(c) = \\gamma_{\\pm}(c)\\, c$ 且 $\\gamma_{\\pm}(c)$ 是平均摩尔活度系数。假设盐的扩散在净电流为零的条件下发生，即 $i = F \\left(z_{+} \\mathbf{N}_{+} + z_{-} \\mathbf{N}_{-}\\right) = \\mathbf{0}$。\n\n- 从上述基本定律和定义出发，消去 $\\nabla \\phi_{e}$，推导化学计量盐通量 $\\mathbf{N}_{s}$ 的菲克盐通量定律 $\\mathbf{N}_{s} = - D_{\\mathrm{amb}}(c) \\nabla c$，确定双极扩散系数 $D_{\\mathrm{amb}}(c)$，并明确展示其如何依赖于热力学因子 $\\chi(c)$ 和离子扩散系数 $D_{+}$ 与 $D_{-}$。\n\n- 然后，对于一个用于电解质设计自动化的特定活度模型，取\n$$\n\\ln \\gamma_{\\pm}(c) = \\lambda\\, \\tilde{c}\\, \\big/ \\left(1 + \\kappa\\, \\tilde{c}\\right), \\quad \\text{其中} \\quad \\tilde{c} \\equiv \\frac{c}{c_{0}},\n$$\n其中 $c_{0}$ 是一个参考浓度。使用 $D_{+} = 1.4 \\times 10^{-10}$ m$^{2}$/s、$D_{-} = 0.9 \\times 10^{-10}$ m$^{2}$/s、$c_{0} = 1000$ mol/m$^{3}$、$\\lambda = 0.25$、$\\kappa = 0.4$ 和 $c = 1200$ mol/m$^{3}$，在这些条件下数值计算 $D_{\\mathrm{amb}}(c)$。\n\n以 m$^{2}$/s 为单位表示最终的扩散系数，并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题需要一个分两部分的解答。首先，在零电流条件下，推导二元$1{:}1$电解质中盐扩散的菲克定律，确定双极扩散系数 $D_{\\mathrm{amb}}(c)$。其次，根据给定的活度系数模型和具体参数值，对此系数进行数值计算。\n\n**第一部分：双极扩散系数 $D_{\\mathrm{amb}}(c)$ 的推导**\n\n起点是物种 $i$ 的通量的能斯特-普朗克方程，$\\mathbf{N}_{i}$：\n$$\n\\mathbf{N}_{i} = -\\frac{D_{i} c_{i}}{R T} \\nabla \\mu_{i}\n$$\n电化学势 $\\mu_{i}$ 由下式给出：\n$$\n\\mu_{i} = \\mu_{i}^{0} + R T \\ln a_{\\pm}(c) + z_{i} F \\phi_{e}\n$$\n首先，我们求电化学势的梯度 $\\nabla\\mu_{i}$。由于 $\\mu_{i}^{0}$ 是一个常数，其梯度为零。\n$$\n\\nabla\\mu_{i} = R T \\nabla(\\ln a_{\\pm}(c)) + z_{i} F \\nabla\\phi_{e}\n$$\n项 $\\nabla(\\ln a_{\\pm}(c))$ 可以与浓度梯度 $\\nabla c$ 和热力学因子 $\\chi(c)$ 联系起来。根据定义，$a_{\\pm}(c) = \\gamma_{\\pm}(c) c$，所以 $\\ln a_{\\pm}(c) = \\ln \\gamma_{\\pm}(c) + \\ln c$。热力学因子是 $\\chi(c) = 1 + \\frac{d \\ln \\gamma_{\\pm}(c)}{d \\ln c}$。我们可以将其写为 $\\chi(c) = \\frac{d \\ln c}{d \\ln c} + \\frac{d \\ln \\gamma_{\\pm}(c)}{d \\ln c} = \\frac{d(\\ln c + \\ln \\gamma_{\\pm}(c))}{d \\ln c} = \\frac{d \\ln a_{\\pm}(c)}{d \\ln c}$。\n使用链式法则，$\\nabla(\\ln a_{\\pm}(c)) = \\frac{d \\ln a_{\\pm}(c)}{dc} \\nabla c$。并且，$\\frac{d \\ln a_{\\pm}(c)}{dc} = \\frac{d \\ln a_{\\pm}(c)}{d \\ln c} \\frac{d \\ln c}{dc} = \\chi(c) \\frac{1}{c}$。\n因此，我们有：\n$$\n\\nabla(\\ln a_{\\pm}(c)) = \\frac{\\chi(c)}{c} \\nabla c\n$$\n将此代回 $\\nabla\\mu_{i}$ 的表达式中：\n$$\n\\nabla\\mu_{i} = R T \\frac{\\chi(c)}{c} \\nabla c + z_{i} F \\nabla\\phi_{e}\n$$\n现在，将此代入能斯特-普朗克通量方程。对于本问题，$c_{+} = c_{-} = c$。\n$$\n\\mathbf{N}_{i} = -\\frac{D_{i} c}{R T} \\left( R T \\frac{\\chi(c)}{c} \\nabla c + z_{i} F \\nabla\\phi_{e} \\right) = -D_{i} \\chi(c) \\nabla c - \\frac{z_{i} D_{i} c F}{R T} \\nabla\\phi_{e}\n$$\n我们可以写出阳离子 ($+$) 和阴离子 ($-$) 的具体通量：\n$$\n\\mathbf{N}_{+} = -D_{+} \\chi(c) \\nabla c - \\frac{z_{+} D_{+} c F}{R T} \\nabla\\phi_{e}\n$$\n$$\n\\mathbf{N}_{-} = -D_{-} \\chi(c) \\nabla c - \\frac{z_{-} D_{-} c F}{R T} \\nabla\\phi_{e}\n$$\n问题陈述净电流为零：$\\mathbf{i} = F(z_{+}\\mathbf{N}_{+} + z_{-}\\mathbf{N}_{-}) = \\mathbf{0}$。这意味着 $z_{+}\\mathbf{N}_{+} + z_{-}\\mathbf{N}_{-} = \\mathbf{0}$。对于二元$1{:}1$电解质，$z_{+} = +1$ 且 $z_{-} = -1$。因此，零电流条件变为 $\\mathbf{N}_{+} - \\mathbf{N}_{-} = \\mathbf{0}$，即 $\\mathbf{N}_{+} = \\mathbf{N}_{-}$。我们可以将化学计量盐通量定义为 $\\mathbf{N}_{s} \\equiv \\mathbf{N}_{+} = \\mathbf{N}_{-}$。\n\n通过令 $\\mathbf{N}_{+}$ 和 $\\mathbf{N}_{-}$ 的表达式相等：\n$$\n-D_{+} \\chi(c) \\nabla c - \\frac{D_{+} c F}{R T} \\nabla\\phi_{e} = -D_{-} \\chi(c) \\nabla c + \\frac{D_{-} c F}{R T} \\nabla\\phi_{e}\n$$\n我们可以解出电势梯度项 $\\nabla\\phi_{e}$。重新整理各项：\n$$\n(D_{-} - D_{+}) \\chi(c) \\nabla c = \\left( \\frac{D_{+} c F}{R T} + \\frac{D_{-} c F}{R T} \\right) \\nabla\\phi_{e} = \\frac{(D_{+} + D_{-}) c F}{R T} \\nabla\\phi_{e}\n$$\n$$\n\\frac{c F}{R T} \\nabla\\phi_{e} = \\frac{D_{-} - D_{+}}{D_{+} + D_{-}} \\chi(c) \\nabla c\n$$\n现在，我们将此表达式代回盐通量方程 $\\mathbf{N}_{s} = \\mathbf{N}_{+}$，以消去 $\\nabla\\phi_{e}$：\n$$\n\\mathbf{N}_{s} = -D_{+} \\chi(c) \\nabla c - D_{+} \\left(\\frac{c F}{R T} \\nabla\\phi_{e}\\right)\n$$\n$$\n\\mathbf{N}_{s} = -D_{+} \\chi(c) \\nabla c - D_{+} \\left( \\frac{D_{-} - D_{+}}{D_{+} + D_{-}} \\chi(c) \\nabla c \\right)\n$$\n提出公因式：\n$$\n\\mathbf{N}_{s} = - \\left[ D_{+} + D_{+} \\frac{D_{-} - D_{+}}{D_{+} + D_{-}} \\right] \\chi(c) \\nabla c\n$$\n简化括号中的项：\n$$\nD_{+} + D_{+} \\frac{D_{-} - D_{+}}{D_{+} + D_{-}} = \\frac{D_{+}(D_{+} + D_{-}) + D_{+}(D_{-} - D_{+})}{D_{+} + D_{-}} = \\frac{D_{+}^{2} + D_{+}D_{-} + D_{+}D_{-} - D_{+}^{2}}{D_{+} + D_{-}} = \\frac{2 D_{+} D_{-}}{D_{+} + D_{-}}\n$$\n这给出了盐通量的最终菲克形式：\n$$\n\\mathbf{N}_{s} = - \\left( \\frac{2 D_{+} D_{-}}{D_{+} + D_{-}} \\right) \\chi(c) \\nabla c\n$$\n将其与所需形式 $\\mathbf{N}_{s} = -D_{\\mathrm{amb}}(c) \\nabla c$ 进行比较，我们确定双极扩散系数为：\n$$\nD_{\\mathrm{amb}}(c) = \\frac{2 D_{+} D_{-}}{D_{+} + D_{-}} \\chi(c)\n$$\n\n**第二部分：$D_{\\mathrm{amb}}(c)$ 的数值计算**\n\n首先，我们必须根据给定的活度系数模型，找到热力学因子 $\\chi(c)$ 的显式表达式：\n$$\n\\ln \\gamma_{\\pm}(c) = \\frac{\\lambda \\tilde{c}}{1 + \\kappa \\tilde{c}}, \\quad \\text{其中} \\quad \\tilde{c} = \\frac{c}{c_{0}}\n$$\n热力学因子为 $\\chi(c) = 1 + \\frac{d \\ln \\gamma_{\\pm}(c)}{d \\ln c}$。使用链式法则，$\\frac{d \\ln \\gamma_{\\pm}}{d \\ln c} = \\frac{d \\ln \\gamma_{\\pm}}{d \\tilde{c}} \\frac{d \\tilde{c}}{d \\ln c}$。由于 $\\tilde{c} = c/c_{0}$，所以 $d\\tilde{c} = dc/c_{0}$。并且，$d(\\ln c) = dc/c$。因此，$d\\tilde{c} = \\frac{c}{c_0} \\frac{dc}{c} = \\tilde{c} \\,d(\\ln c)$，这意味着 $\\frac{d\\tilde{c}}{d\\ln c} = \\tilde{c}$。\n所以，$\\frac{d \\ln \\gamma_{\\pm}}{d \\ln c} = \\tilde{c} \\frac{d \\ln \\gamma_{\\pm}}{d \\tilde{c}}$。\n我们使用商法则对 $\\ln \\gamma_{\\pm}$ 关于 $\\tilde{c}$ 求导：\n$$\n\\frac{d \\ln \\gamma_{\\pm}}{d \\tilde{c}} = \\frac{d}{d\\tilde{c}}\\left(\\frac{\\lambda \\tilde{c}}{1 + \\kappa \\tilde{c}}\\right) = \\frac{\\lambda(1 + \\kappa \\tilde{c}) - (\\lambda \\tilde{c})(\\kappa)}{(1 + \\kappa \\tilde{c})^2} = \\frac{\\lambda}{(1 + \\kappa \\tilde{c})^2}\n$$\n因此，$\\frac{d \\ln \\gamma_{\\pm}}{d \\ln c} = \\tilde{c} \\frac{\\lambda}{(1 + \\kappa \\tilde{c})^2} = \\frac{\\lambda \\tilde{c}}{(1 + \\kappa \\tilde{c})^2}$。\n热力学因子是：\n$$\n\\chi(c) = 1 + \\frac{\\lambda \\tilde{c}}{(1 + \\kappa \\tilde{c})^2}\n$$\n现在我们代入给定的数值：$D_{+} = 1.4 \\times 10^{-10}$ m$^{2}$/s、$D_{-} = 0.9 \\times 10^{-10}$ m$^{2}$/s、$c_{0} = 1000$ mol/m$^{3}$、$\\lambda = 0.25$、$\\kappa = 0.4$ 和 $c = 1200$ mol/m$^{3}$。\n\n首先，计算无量纲浓度 $\\tilde{c}$：\n$$\n\\tilde{c} = \\frac{c}{c_{0}} = \\frac{1200 \\, \\text{mol/m}^3}{1000 \\, \\text{mol/m}^3} = 1.2\n$$\n接下来，计算热力学因子 $\\chi(c)$：\n$$\n\\chi(c) = 1 + \\frac{(0.25)(1.2)}{(1 + (0.4)(1.2))^2} = 1 + \\frac{0.3}{(1 + 0.48)^2} = 1 + \\frac{0.3}{2.1904} \\approx 1 + 0.13696... \\approx 1.13696\n$$\n接下来，计算扩散系数的动力学前因子：\n$$\n\\frac{2 D_{+} D_{-}}{D_{+} + D_{-}} = \\frac{2 (1.4 \\times 10^{-10}) (0.9 \\times 10^{-10})}{1.4 \\times 10^{-10} + 0.9 \\times 10^{-10}} = \\frac{2.52 \\times 10^{-20}}{2.3 \\times 10^{-10}} \\, \\frac{\\text{m}^4/\\text{s}^2}{\\text{m}^2/\\text{s}} \\approx 1.09565 \\times 10^{-10} \\, \\text{m}^2/\\text{s}\n$$\n最后，计算双极扩散系数 $D_{\\mathrm{amb}}(c)$：\n$$\nD_{\\mathrm{amb}}(c) = \\left( \\frac{2 D_{+} D_{-}}{D_{+} + D_{-}} \\right) \\chi(c) \\approx (1.09565 \\times 10^{-10} \\, \\text{m}^2/\\text{s}) \\times (1.13696) \\approx 1.24569 \\times 10^{-10} \\, \\text{m}^2/\\text{s}\n$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\nD_{\\mathrm{amb}}(c) \\approx 1.25 \\times 10^{-10} \\, \\text{m}^2/\\text{s}\n$$",
            "answer": "$$\n\\boxed{1.25 \\times 10^{-10}}\n$$"
        },
        {
            "introduction": "从连续方程到计算模拟的跨越需要严谨的数值实现。一个稳健的模拟必须在离散层面保持物理系统的基本守恒定律。这个动手编程练习要求您实现一种有限体积法，以保证精确的电荷守恒，这是防止电荷被人为产生或湮灭、确保电池模拟物理保真度的关键特性。",
            "id": "3911575",
            "problem": "要求您设计并实现一种电解质相物质和电荷守恒的有限体积离散化方法，当离子电流由相同的界面解析物质通量构建时，该方法能保证精确的离散电荷守恒。物理背景是一个等温、一维的电解质区域，具有恒定的横截面积和规则的控制体网格。对于每种离子物质 $k$，其控制方程为电解质相物质守恒方程和以物质通量表示的离子电流密度定义：\n- 物质守恒：$\\frac{\\partial (\\epsilon c_k)}{\\partial t} + \\nabla \\cdot N_k = R_k$。\n- 离子电流定义：$i_e = F \\sum_k z_k N_k$。\n您的离散化方案必须被构造成能确保离散电荷守恒恒等式精确成立：\n- 离散电荷守恒：$\\nabla_h \\cdot i_e = F \\sum_k z_k R_k$。\n\n从控制体上的积分守恒基本原理出发，应用有限体积法 (FVM)，并开发一个满足以下条件的算法：\n- 使用面向界面的通量 $N_{k,f}$ 作为物质传输的原始数据。\n- 从这些物质通量定义面向界面的离子电流 $i_{e,f}$。\n- 通过界面通量的有向和除以单元体积，为一维网格构建离散散度算子 $\\nabla_h \\cdot$。\n\n您的程序必须在一个长度为 $L$、包含 $N$ 个尺寸均匀的控制体的一维区域上实现该方案。控制体横截面积为 $A$，单元体积为 $V_i = A \\Delta x$，其中 $\\Delta x = L/N$。对于一个控制体 $i$，其左界面通量索引为 $j=i$，右界面通量索引为 $j=i+1$，任意界面量 $q_f$ 的离散散度为\n$$\n\\left(\\nabla_h \\cdot q\\right)_i = \\frac{A}{V_i}\\left(q_{i+1/2} - q_{i-1/2}\\right) = \\frac{1}{\\Delta x}\\left(q_{j=i+1} - q_{j=i}\\right).\n$$\n您必须使用此公式计算 $\\left(\\nabla_h \\cdot i_e\\right)_i$，并独立计算 $F \\sum_k z_k R_{k,i}$，然后验证恒等式 $\\left(\\nabla_h \\cdot i_e\\right)_i = F \\sum_k z_k R_{k,i}$ 在每个单元中都成立。在瞬态情况下，物质更新必须使用后向欧拉步\n$$\n\\epsilon_i c_{k,i}^{n+1} = \\epsilon_i c_{k,i}^n + \\Delta t \\left(R_{k,i}^{n+1} - \\frac{A}{V_i}\\left(N_{k,i+1/2}^{n+1} - N_{k,i-1/2}^{n+1}\\right)\\right),\n$$\n并且您必须通过构造 $R_{k,i}$ 来确保电中性约束 $\\sum_k z_k c_{k,i}^{n+1} = \\sum_k z_k c_{k,i}^{n} = 0$ 成立。\n\n物理单位和角度规定：\n- $F$ 是法拉第常数，单位为 $\\mathrm{C/mol}$。\n- $N_{k,f}$ 的单位为 $\\mathrm{mol/(m^2\\,s)}$，$i_{e,f}$ 的单位为 $\\mathrm{A/m^2}$。\n- $\\nabla_h \\cdot i_e$ 和 $F \\sum_k z_k R_k$ 的单位为 $\\mathrm{A/m^3}$。\n- 当使用三角函数时，其参数以弧度为单位。\n\n请实现以下参数集测试套件，以检验该离散化方案的不同方面。在每种情况下，计算每个单元的差异\n$$\n\\delta_i = \\left(\\nabla_h \\cdot i_e\\right)_i - F \\sum_k z_k R_{k,i},\n$$\n并以 $\\mathrm{A/m^3}$ 为单位，将所有单元中的最大绝对差异报告为单个浮点数。要求的最终输出格式为单行，包含由逗号分隔并用方括号括起来的三个结果，例如 $[r_1,r_2,r_3]$。\n\n所有测试的通用常数：\n- 法拉第常数 $F = 96485\\ \\mathrm{C/mol}$。\n- 三种物质的电荷 $z_k$：阳离子 $z_+ = +1$，阴离子 $z_- = -1$，中性溶剂 $z_0 = 0$。\n\n测试用例 1 (稳态，均匀孔隙度)：\n- 单元数 $N = 5$。\n- 长度 $L = 1 \\times 10^{-3}\\ \\mathrm{m}$。\n- 面积 $A = 1 \\times 10^{-4}\\ \\mathrm{m^2}$。\n- 所有 $i$ 的孔隙度 $\\epsilon_i = 0.4$。\n- 界面索引 $j = 0,1,\\dots,N$。\n- 界面通量 $N_{+,j} = 2.0 \\times 10^{-5}\\ \\left(1 + 0.2 j\\right)$，$N_{-,j} = -1.3 \\times 10^{-5}\\ \\left(1 - 0.1 j\\right)$，$N_{0,j} = 5.0 \\times 10^{-6}$，单位均为 $\\mathrm{mol/(m^2\\,s)}$。\n- 为满足稳态物质守恒而选择的源项：$R_{k,i} = \\frac{1}{\\Delta x}\\left(N_{k,j=i+1} - N_{k,j=i}\\right)$，单位为 $\\mathrm{mol/(m^3\\,s)}$。\n\n测试用例 2 (稳态，非均匀孔隙度，包括一个零孔隙度单元)：\n- 单元数 $N = 5$。\n- 长度 $L = 1 \\times 10^{-3}\\ \\mathrm{m}$。\n- 面积 $A = 1 \\times 10^{-4}\\ \\mathrm{m^2}$。\n- 孔隙度向量 $\\epsilon = [0.4, 0.4, 0.0, 0.5, 0.5]$。\n- 界面索引 $j = 0,1,\\dots,N$。\n- 界面通量：\n  - $N_{+,j} = 1.0 \\times 10^{-5}\\ \\left(1 + 0.5 \\sin\\left(\\pi j / N\\right)\\right)$,\n  - $N_{-,j} = -8.0 \\times 10^{-6}\\ \\left(1 + 0.3 \\cos\\left(\\pi j / N\\right)\\right)$,\n  - $N_{0,j} = 0$,\n  单位均为 $\\mathrm{mol/(m^2\\,s)}$，角度以弧度为单位。\n- 为满足稳态物质守恒而选择的源项：$R_{k,i} = \\frac{1}{\\Delta x}\\left(N_{k,j=i+1} - N_{k,j=i}\\right)$，单位为 $\\mathrm{mol/(m^3\\,s)}$。\n\n测试用例 3 (瞬态，均匀孔隙度，满足电中性)：\n- 单元数 $N = 5$。\n- 长度 $L = 1 \\times 10^{-3}\\ \\mathrm{m}$。\n- 面积 $A = 1 \\times 10^{-4}\\ \\mathrm{m^2}$。\n- 所有 $i$ 的孔隙度 $\\epsilon_i = 0.35$。\n- 时间步长 $\\Delta t = 0.1\\ \\mathrm{s}$。\n- 初始浓度：对于所有 $i$，$c_{+,i}^0 = 1000\\ \\mathrm{mol/m^3}$，$c_{-,i}^0 = 1000\\ \\mathrm{mol/m^3}$，$c_{0,i}^0 = 2000\\ \\mathrm{mol/m^3}$，确保 $\\sum_k z_k c_{k,i}^0 = 0$。\n- 界面索引 $j = 0,1,\\dots,N$。\n- 界面通量：\n  - $N_{+,j} = 1.0 \\times 10^{-6}\\ (j+1)\\ (N-j)$,\n  - $N_{-,j} = -1.2 \\times 10^{-6}\\ (j+1)\\ (N-j)$,\n  - $N_{0,j} = 0$,\n  单位均为 $\\mathrm{mol/(m^2\\,s)}$。\n- 定义界面离子电流 $i_{e,j} = F \\sum_k z_k N_{k,j}$；计算其离散散度 $s_i = \\frac{1}{\\Delta x}\\left(i_{e,j=i+1} - i_{e,j=i}\\right)$，单位为 $\\mathrm{A/m^3}$。\n- 为在后向欧拉更新中强制实现电中性而选择的源项：$R_{+,i} = \\frac{1}{2}\\frac{s_i}{F}$，$R_{-,i} = -\\frac{1}{2}\\frac{s_i}{F}$，$R_{0,i} = 0$，单位均为 $\\mathrm{mol/(m^3\\,s)}$。\n- 使用后向欧拉法更新 $c_{k,i}^{1}$，并确认恒等式 $\\left(\\nabla_h \\cdot i_e\\right)_i = F \\sum_k z_k R_{k,i}$ 在离散层面成立 (由于源项的构造方式和使用了一致的界面通量，该恒等式必须成立)。\n\n您的程序应生成单行输出，其中包含一个由逗号分隔并用方括号括起来的结果列表，格式完全如下：$[r_1,r_2,r_3]$，其中 $r_1$、$r_2$ 和 $r_3$ 分别是测试用例 1、测试用例 2 和测试用例 3 的最大绝对差异 $\\max_i |\\delta_i|$，每个都表示为以 $\\mathrm{A/m^3}$ 为单位的浮点数。",
            "solution": "该问题要求对电解质输运方程的有限体积离散化，验证其离散电荷守恒定律。待验证的恒等式为 $\\left(\\nabla_h \\cdot i_e\\right)_i = F \\sum_k z_k R_{k,i}$，适用于每个控制体 $i$。此恒等式并非一个待检验的物理定律，而是离散化方案本身的一种数学属性。一个构造良好的方案会因其设计而满足此恒等式，从而确保数值解不会人为地产生或消灭电荷。任务是实现给定的离散化方案，并数值计算差异 $\\delta_i = \\left(\\nabla_h \\cdot i_e\\right)_i - F \\sum_k z_k R_{k,i}$，在浮点运算精度的限制内，该值应为零。\n\n这里展示的基本原理是，对离散场变量应用一致的线性运算会保持它们之间的代数关系。在此，离子电流 $i_e$ 是物质通量 $N_k$ 的线性组合，而电荷生成速率是物质生成速率 $R_k$ 的线性组合。如果散度算子 $\\nabla_h \\cdot$也是线性的，那么该关系在离散层面也将成立。\n\n让我们来正式推导该恒等式。问题将定义在控制体界面上的量 $q$ 的离散散度算子定义为：\n$$\n\\left(\\nabla_h \\cdot q\\right)_i = \\frac{1}{\\Delta x}\\left(q_{j=i+1} - q_{j=i}\\right)\n$$\n其中 $i$ 是单元索引，$j$ 是界面索引，界面 $j=i$ 和 $j=i+1$ 界定了单元 $i$。一个均匀控制体的长度为 $\\Delta x = L/N$。\n\n恒等式的左侧 (LHS) 是离子电流的离散散度 $\\left(\\nabla_h \\cdot i_e\\right)_i$。界面离子电流 $i_{e,j}$ 被定义为该界面上物质通量 $N_{k,j}$ 的线性组合：\n$$\ni_{e,j} = F \\sum_k z_k N_{k,j}\n$$\n将此定义代入离散散度算子可得：\n$$\n\\text{LHS}_i = \\left(\\nabla_h \\cdot i_e\\right)_i = \\frac{1}{\\Delta x}\\left( i_{e,j=i+1} - i_{e,j=i} \\right)\n$$\n$$\n\\text{LHS}_i = \\frac{1}{\\Delta x}\\left( \\left( F \\sum_k z_k N_{k,j=i+1} \\right) - \\left( F \\sum_k z_k N_{k,j=i} \\right) \\right)\n$$\n由于求和算子的线性特性，我们可以重新排列此表达式：\n$$\n\\text{LHS}_i = \\frac{F}{\\Delta x} \\sum_k z_k \\left( N_{k,j=i+1} - N_{k,j=i} \\right)\n$$\n$$\n\\text{LHS}_i = F \\sum_k z_k \\left( \\frac{N_{k,j=i+1} - N_{k,j=i}}{\\Delta x} \\right)\n$$\n\n恒等式的右侧 (RHS) 给出为：\n$$\n\\text{RHS}_i = F \\sum_k z_k R_{k,i}\n$$\n\n现在我们来研究这些测试用例。\n\n对于测试用例 1 和 2，每个单元 $i$ 中每种物质 $k$ 的体积源项 $R_{k,i}$ 被定义为满足稳态物质守恒方程 $\\nabla \\cdot N_k = R_k$。其离散形式为：\n$$\nR_{k,i} = \\frac{1}{\\Delta x}\\left(N_{k,j=i+1} - N_{k,j=i}\\right)\n$$\n将 $R_{k,i}$ 的这个定义代入 RHS 的表达式中可得：\n$$\n\\text{RHS}_i = F \\sum_k z_k \\left( \\frac{N_{k,j=i+1} - N_{k,j=i}}{\\Delta x} \\right)\n$$\n这在代数上与为 LHS 推导出的表达式完全相同。因此，对于测试用例 1 和 2，恒等式 $\\text{LHS}_i = \\text{RHS}_i$ 因其构造而成立。\n\n对于测试用例 3，源项 $R_{k,i}$ 的定义方式不同，旨在瞬态模拟中强制实现电中性。总电荷源首先被定义为 $s_i = (\\nabla_h \\cdot i_e)_i$，这恰好就是我们的 LHS。然后，这个总电荷源被分配给各种物质。当 $z_+ = +1$，$z_- = -1$ 且 $z_0=0$ 时，源项定义为 $R_{+,i} = \\frac{1}{2}\\frac{s_i}{F}$，$R_{-,i} = -\\frac{1}{2}\\frac{s_i}{F}$ 和 $R_{0,i}=0$。让我们用这些定义来计算 RHS：\n$$\n\\text{RHS}_i = F \\sum_k z_k R_{k,i} = F \\left( z_+ R_{+,i} + z_- R_{-,i} + z_0 R_{0,i} \\right)\n$$\n$$\n\\text{RHS}_i = F \\left( (+1) \\left(\\frac{1}{2}\\frac{s_i}{F}\\right) + (-1) \\left(-\\frac{1}{2}\\frac{s_i}{F}\\right) + (0)(0) \\right)\n$$\n$$\n\\text{RHS}_i = F \\left( \\frac{s_i}{2F} + \\frac{s_i}{2F} \\right) = F \\left( \\frac{s_i}{F} \\right) = s_i\n$$\n由于 $s_i$ 被定义为 LHS，我们再次发现 $\\text{LHS}_i = \\text{RHS}_i$ 是一个代数恒等式。\n\n将要实现的算法会使用浮点数来执行这些计算。它将根据每个测试用例给定的参数和通量/源项定义，分别计算 LHS 和 RHS。差异的最大绝对值 $\\max_i |\\delta_i|$ 将量化计算过程中浮点舍入误差累积的程度。该值预计在机器精度的数量级上。\n\n虽然问题提供了关于孔隙度 $\\epsilon$、浓度 $c_k$ 和时间步长 $\\Delta t$ 的背景信息，但离散电荷守恒恒等式 $\\left(\\nabla_h \\cdot i_e\\right)_i = F \\sum_k z_k R_{k,i}$ 的验证仅取决于界面离子电流 $i_{e,f}$、离散散度 $\\nabla_h \\cdot$ 和反应源项 $R_{k,i}$ 的一致性定义。因此，实现过程侧重于这些核心量来执行所需的验证。提供的 Python 代码遵循这一逻辑，使用 `NumPy` 在网格上进行高效的矢量化运算。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_discrepancy(N, L, F, z_k, N_k_j, R_k_i):\n    \"\"\"\n    Calculates the maximum absolute discrepancy between the two sides of the\n    discrete charge conservation identity.\n\n    Args:\n        N (int): Number of control volumes.\n        L (float): Length of the domain in meters.\n        F (float): Faraday constant in C/mol.\n        z_k (np.ndarray): Array of charges for each species. Shape (num_species,).\n        N_k_j (np.ndarray): Array of species fluxes at faces. Shape (num_species, N+1).\n        R_k_i (np.ndarray): Array of species source terms in cells. Shape (num_species, N).\n\n    Returns:\n        float: The maximum absolute discrepancy in A/m^3.\n    \"\"\"\n    num_species = len(z_k)\n    delta_x = L / N\n\n    # Reshape z_k for broadcasting\n    z_k = z_k.reshape(num_species, 1)\n\n    # 1. Calculate face ionic current i_e,j\n    # i_e,j = F * sum_k(z_k * N_k,j)\n    i_e_j = F * np.sum(z_k * N_k_j, axis=0)\n\n    # 2. Calculate LHS: discrete divergence of i_e\n    # (nabla_h . i_e)_i = (i_e,j=i+1 - i_e,j=i) / delta_x\n    lhs = (i_e_j[1:] - i_e_j[:-1]) / delta_x\n\n    # 3. Calculate RHS: F * sum_k(z_k * R_k,i)\n    rhs = F * np.sum(z_k * R_k_i, axis=0)\n    \n    # 4. Calculate discrepancy\n    delta_i = lhs - rhs\n    \n    # 5. Return max absolute discrepancy\n    return np.max(np.abs(delta_i))\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    F = 96485.0  # Faraday constant in C/mol\n    z_k = np.array([1.0, -1.0, 0.0]) # Charges for cation, anion, solvent\n    num_species = len(z_k)\n\n    # --- Test Case 1 ---\n    N1 = 5\n    L1 = 1.0e-3\n    delta_x1 = L1 / N1\n    j1 = np.arange(N1 + 1)\n    \n    N_k_j_1 = np.zeros((num_species, N1 + 1))\n    N_k_j_1[0, :] = 2.0e-5 * (1.0 + 0.2 * j1)\n    N_k_j_1[1, :] = -1.3e-5 * (1.0 - 0.1 * j1)\n    N_k_j_1[2, :] = 5.0e-6\n    \n    R_k_i_1 = (N_k_j_1[:, 1:] - N_k_j_1[:, :-1]) / delta_x1\n    \n    result1 = calculate_discrepancy(N1, L1, F, z_k, N_k_j_1, R_k_i_1)\n\n    # --- Test Case 2 ---\n    N2 = 5\n    L2 = 1.0e-3\n    delta_x2 = L2 / N2\n    j2 = np.arange(N2 + 1)\n\n    N_k_j_2 = np.zeros((num_species, N2 + 1))\n    N_k_j_2[0, :] = 1.0e-5 * (1.0 + 0.5 * np.sin(np.pi * j2 / N2))\n    N_k_j_2[1, :] = -8.0e-6 * (1.0 + 0.3 * np.cos(np.pi * j2 / N2))\n    N_k_j_2[2, :] = 0.0\n\n    R_k_i_2 = (N_k_j_2[:, 1:] - N_k_j_2[:, :-1]) / delta_x2\n\n    result2 = calculate_discrepancy(N2, L2, F, z_k, N_k_j_2, R_k_i_2)\n    \n    # --- Test Case 3 ---\n    N3 = 5\n    L3 = 1.0e-3\n    delta_x3 = L3 / N3\n    j3 = np.arange(N3 + 1)\n\n    N_k_j_3 = np.zeros((num_species, N3 + 1))\n    N_k_j_3[0, :] = 1.0e-6 * (j3 + 1.0) * (N3 - j3)\n    N_k_j_3[1, :] = -1.2e-6 * (j3 + 1.0) * (N3 - j3)\n    N_k_j_3[2, :] = 0.0\n\n    # Calculate temporary quantities to define R_k,i\n    i_e_j_3 = F * np.sum(z_k.reshape(num_species, 1) * N_k_j_3, axis=0)\n    s_i_3 = (i_e_j_3[1:] - i_e_j_3[:-1]) / delta_x3\n    \n    R_k_i_3 = np.zeros((num_species, N3))\n    R_k_i_3[0, :] = 0.5 * s_i_3 / F\n    R_k_i_3[1, :] = -0.5 * s_i_3 / F\n    R_k_i_3[2, :] = 0.0\n\n    result3 = calculate_discrepancy(N3, L3, F, z_k, N_k_j_3, R_k_i_3)\n\n    results = [result1, result2, result3]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}