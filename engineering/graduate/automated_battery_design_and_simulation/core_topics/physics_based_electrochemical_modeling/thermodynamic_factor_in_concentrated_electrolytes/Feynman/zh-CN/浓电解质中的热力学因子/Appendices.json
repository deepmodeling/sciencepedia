{
    "hands_on_practices": [
        {
            "introduction": "热力学因子不仅仅是一个经验参数，它深植于体系的亥姆霍兹自由能及其对浓度波动的稳定性。本练习将通过一个简洁而深刻的自由能模型，引导您推导热力学因子和相稳定性边界，从而巩固您对这一基本联系的理解。通过这个过程，您将清晰地看到宏观热力学函数如何决定电解质的关键输运性质 。",
            "id": "3957442",
            "problem": "在用于浓电解质的自动化电池设计和仿真框架中，自由能模型被整合到传输和稳定性分析中。考虑一个处于固定温度 $T$ 下的均匀等温电解质，由无量纲浓度变量 $c$ 描述，定义为 $c \\equiv \\tilde{c}/c_{\\mathrm{ref}}$，因此 $\\ln c$ 是良定义的。设单位体积的亥姆霍兹自由能密度由以下模型表示\n$$\nG(c) = R T\\, c \\left[\\ln c + \\alpha\\, c\\right],\n$$\n其中 $R$ 是通用气体常数，$\\alpha$ 是一个捕获非理想混合效应的实数、无量纲相互作用参数。仅使用均匀混合物的标准热力学定义，特别是化学势由 $\\mu(c) = \\partial G/\\partial c$ 给出，且活度 $a(c)$ 满足 $\\mu(c) = \\mu^{\\circ} + R T \\ln a(c)$，推导热力学因子\n$$\n\\Theta(c) \\equiv \\frac{d \\ln a}{d \\ln c}\n$$\n用 $c$ 和 $\\alpha$ 表示。然后，根据基于二阶导数 $\\partial^{2} G/\\partial c^{2}$ 的凸性判据，确定系统相对于成分涨落处于临界稳定状态的浓度。将最终答案表示为关于 $c$ 和 $\\alpha$ 的闭式解析表达式。将您的最终结果以行向量的形式给出，其中包含两个条目：$\\Theta(c)$ 和临界稳定浓度 $c^{\\ast}$。不需要数值近似或四舍五入。",
            "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n-   系统描述：一个处于固定温度 $T$ 下的均匀等温电解质。\n-   浓度变量：$c \\equiv \\tilde{c}/c_{\\mathrm{ref}}$，无量纲。\n-   单位体积的亥姆霍兹自由能密度：$G(c) = R T\\, c \\left[\\ln c + \\alpha\\, c\\right]$，其中 $R$ 是通用气体常数，$\\alpha$ 是一个实数、无量纲相互作用参数。\n-   化学势的定义：$\\mu(c) = \\partial G/\\partial c$。\n-   活度 $a(c)$ 的定义：$\\mu(c) = \\mu^{\\circ} + R T \\ln a(c)$，其中 $\\mu^{\\circ}$ 是标准化学势。\n-   热力学因子的定义：$\\Theta(c) \\equiv \\frac{d \\ln a}{d \\ln c}$。\n-   临界稳定性判据：系统处于临界稳定状态的浓度由凸性判据 $\\partial^{2} G/\\partial c^{2} = 0$ 确定。\n-   要求输出：$\\Theta(c)$ 的表达式和临界稳定浓度 $c^{\\ast}$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题基于化学热力学原理。自由能的形式 $G(c)$ 是一个简化的正规溶液模型（也称为Bragg-Williams或平均场模型），这是物理化学和材料科学中用于描述非理想混合物的标准教学和研究工具。化学势、活度和稳定性判据的定义都是标准和基本的。\n-   **适定性**：该问题是适定的。它提供了推导所要求量所需的所有函数形式和定义。任务是具体的，通过直接应用微积分可以得到唯一的数学解。\n-   **客观性**：问题以精确、客观、明确的语言陈述，不含主观内容。\n-   **结论**：该问题不违反任何指定的无效标准。它在科学上是合理的，自洽的，并且可以形式化。\n\n**步骤3：判定和行动**\n-   **判定**：问题有效。\n-   **行动**：继续推导解答。\n\n根据要求，解答的推导分为两部分。\n\n首先，我们推导热力学因子 $\\Theta(c)$。\n起点是给定的亥姆霍兹自由能密度：\n$$\nG(c) = R T c (\\ln c + \\alpha c) = R T (c \\ln c + \\alpha c^2)\n$$\n化学势 $\\mu(c)$ 定义为 $G$ 对 $c$ 的偏导数：\n$$\n\\mu(c) = \\frac{\\partial G}{\\partial c} = \\frac{\\partial}{\\partial c} \\left[ R T (c \\ln c + \\alpha c^2) \\right]\n$$\n保持 $R$ 和 $T$ 恒定，并应用乘法法则和幂法则进行微分，我们得到：\n$$\n\\mu(c) = R T \\left[ \\left(1 \\cdot \\ln c + c \\cdot \\frac{1}{c}\\right) + 2 \\alpha c \\right] = R T (\\ln c + 1 + 2 \\alpha c)\n$$\n活度 $a(c)$ 由关系式 $\\mu(c) = \\mu^{\\circ} + R T \\ln a(c)$ 定义，其中 $\\mu^{\\circ}$ 是标准态下的化学势，是一个常数。我们将 $\\mu(c)$ 的两个表达式相等：\n$$\n\\mu^{\\circ} + R T \\ln a(c) = R T (\\ln c + 1 + 2 \\alpha c)\n$$\n求解 $\\ln a(c)$ 得：\n$$\n\\ln a(c) = \\frac{R T (\\ln c + 1 + 2 \\alpha c) - \\mu^{\\circ}}{R T} = \\ln c + 1 + 2 \\alpha c - \\frac{\\mu^{\\circ}}{R T}\n$$\n热力学因子 $\\Theta(c)$ 定义为 $\\Theta(c) = \\frac{d \\ln a}{d \\ln c}$。为了计算这个导数，我们使用链式法则：$\\frac{d f}{d \\ln c} = c \\frac{d f}{d c}$。将此应用于我们的 $\\ln a(c)$ 表达式：\n$$\n\\Theta(c) = c \\frac{d}{dc} \\left( \\ln c + 1 + 2 \\alpha c - \\frac{\\mu^{\\circ}}{R T} \\right)\n$$\n常数项（$1$ 和 $\\frac{\\mu^{\\circ}}{RT}$）的导数为零。剩余项的导数为：\n$$\n\\frac{d}{dc} (\\ln c + 2 \\alpha c) = \\frac{1}{c} + 2 \\alpha\n$$\n将此代回 $\\Theta(c)$ 的表达式中：\n$$\n\\Theta(c) = c \\left( \\frac{1}{c} + 2 \\alpha \\right) = 1 + 2 \\alpha c\n$$\n这是第一个要求的表达式。\n\n其次，我们确定临界稳定浓度 $c^{\\ast}$。\n均匀混合物相对于小的成分涨落的稳定性由自由能的二阶导数 $\\frac{\\partial^{2} G}{\\partial c^{2}}$ 的符号决定。如果该导数为正，系统稳定；如果为负，则不稳定；如果为零，则处于临界稳定状态。因此，我们必须找到满足以下条件的浓度 $c^{\\ast}$：\n$$\n\\left. \\frac{\\partial^{2} G}{\\partial c^{2}} \\right|_{c=c^{\\ast}} = 0\n$$\n我们已经计算出一阶导数，$\\frac{\\partial G}{\\partial c} = \\mu(c) = R T (\\ln c + 1 + 2 \\alpha c)$。现在我们对这个表达式关于 $c$ 求导：\n$$\n\\frac{\\partial^{2} G}{\\partial c^{2}} = \\frac{\\partial}{\\partial c} \\left[ R T (\\ln c + 1 + 2 \\alpha c) \\right] = R T \\left( \\frac{1}{c} + 2 \\alpha \\right)\n$$\n将此表达式设为零以求 $c^{\\ast}$：\n$$\nR T \\left( \\frac{1}{c^{\\ast}} + 2 \\alpha \\right) = 0\n$$\n由于 $R$ 是一个正常数且温度 $T$ 假定为正，括号中的项必须为零：\n$$\n\\frac{1}{c^{\\ast}} + 2 \\alpha = 0\n$$\n求解 $c^{\\ast}$ 得：\n$$\n\\frac{1}{c^{\\ast}} = -2 \\alpha \\implies c^{\\ast} = -\\frac{1}{2 \\alpha}\n$$\n这是第二个要求的表达式。为了使 $c^{\\ast}$ 成为一个有物理意义的正浓度，相互作用参数 $\\alpha$ 必须为负。\n\n最终结果是一个包含两个推导量 $\\Theta(c)$ 和 $c^{\\ast}$ 的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + 2 \\alpha c  -\\frac{1}{2\\alpha}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了热力学因子的理论基础之后，下一个关键步骤是如何从实验中获取它。本练习将指导您处理浓差电池的电动势（EMF）数据，通过应用能斯特方程的微分形式来计算热力学因子。这个实践不仅能让您掌握从原始实验数据中提取模型参数的核心技能，还强调了在实际分析中区分和转换不同浓度标度（质量摩尔浓度与物质的量浓度）的重要性 。",
            "id": "3957469",
            "problem": "给定盐六氟磷酸锂 ($\\mathrm{LiPF}_6$) 在混合溶剂碳酸乙烯酯 (EC) 和碳酸二乙酯 (DEC) 中，于固定温度下，电动势 (EMF) 作为质量摩尔浓度的自然对数的函数数据。目标是计算质量摩尔浓度标度下的热力学因子，并量化在体积摩尔浓度标度下进行分析所产生的影响。热力学因子是一个无量纲量，定义为活度对所选浓度度量的对数灵敏度，在自动化电池设计和模拟的输运建模中至关重要。\n\n基本原理：\n- 离子物种的电化学势由化学势的定义给出，其中活度在电势中以对数形式出现。\n- 能斯特方程将两种溶液之间测得的电动势与活度之比联系起来。\n- 应用了二元电解质中的电中性原理和一致的活度定义。\n- 质量摩尔浓度 $m$（单位：$\\mathrm{mol/kg}$ 溶剂）和体积摩尔浓度 $c$（单位：$\\mathrm{mol/L}$ 溶液）是不同的浓度标度，它们通过溶液密度和盐的摩尔质量以科学上一致的方式相关联。\n\n您的程序必须：\n1. 从上述基本原理出发，构建一个算法。该算法在给定固定温度 $T$ 下，根据与 $\\ln m$ 对应的电动势 $E$ 的表格数据，通过对电动势关于 $\\ln m$ 求导并用热力学常数进行归一化，来估计质量摩尔浓度标度下的热力学因子，记为 $\\Theta_m(m)$。\n2. 使用一个针对 EC:DEC 与 $\\mathrm{LiPF}_6$ 的显式、物理上合理的密度模型，通过在 $m$ 和 $c$ 之间应用数学上严格的变量替换，将结果转换为体积摩尔浓度标度 $\\Theta_c(c)$。\n3. 在非均匀网格上使用数值稳定的微分方法，并将导数插值到指定的评估点。\n\n本问题的定义和模型假设：\n- 令 $R$ 表示普适气体常数，$F$ 表示法拉第常数。令 $T$ 为绝对温度，单位为 $\\mathrm{K}$。\n- 令 $\\rho(m)$ 表示溶液密度，单位为 $\\mathrm{kg/L}$，模型为一个关于 $m$ 的平滑函数，在测试范围内严格为正。\n- 令 $M_s$ 表示盐的摩尔质量，单位为 $\\mathrm{kg/mol}$。\n- 质量摩尔浓度标度上的热力学因子定义为无量纲导数 $\\Theta_m(m)$，通过电动势对 $\\ln m$ 在固定 $T$ 下的灵敏度获得。\n- 体积摩尔浓度 $c$ 和质量摩尔浓度 $m$ 的关系如下\n$$\nc(m) = \\frac{m \\, \\rho(m)}{1 + m M_s},\n$$\n并且，将导数从 $\\ln m$ 转换为 $\\ln c$ 所需的变量替换因子必须通过对 $\\ln c(m)$ 关于 $\\ln m$ 求导得出。\n- 您必须使用以下针对含 $\\mathrm{LiPF}_6$ 的 EC:DEC 的物理上合理的密度模型：\n$$\n\\rho(m) = 1.25 + 0.04 m - 0.002 m^2 \\quad \\text{单位：} \\mathrm{kg/L},\n$$\n该模型在 $m \\in [0.1, 2.0]$ 范围内有效。其关于 $m$ 的导数为\n$$\n\\frac{d\\rho}{dm} = 0.04 - 0.004 m.\n$$\n- 使用 $\\mathrm{LiPF}_6$ 的 $M_s = 0.1519 \\, \\mathrm{kg/mol}$ 和 $T = 298.15 \\, \\mathrm{K}$。\n- 电动势值单位为 $\\mathrm{V}$，并且必须与能斯特关系一致地处理。所有 $\\Theta$ 的输出均为无量纲。\n\n测试套件（三种情况）：\n- 情况 1（近理想行为，理想路径）：质量摩尔浓度网格 $m = [0.1, 0.2, 0.5, 1.0, 1.5]$。电动势数据由下式构建\n$$\nE(m) = E_0 + \\frac{R T}{F} \\ln m,\n$$\n其中 $E_0 = 0.15 \\, \\mathrm{V}$。在 $m^\\star = 1.0$ 处评估 $\\Theta_m$ 和 $\\Theta_c$。\n- 情况 2（中等非理想性，中心区域）：质量摩尔浓度网格 $m = [0.2, 0.5, 1.0, 1.3, 1.6]$。电动势数据由下式构建\n$$\nE(m) = E_0 + \\frac{R T}{F} \\left(\\ln m + \\ln \\gamma_1(m)\\right), \\quad \\ln \\gamma_1(m) = -\\frac{0.5 \\sqrt{m}}{1 + 0.8 m},\n$$\n其中 $E_0 = 0.05 \\, \\mathrm{V}$。在 $m^\\star = 1.0$ 处评估 $\\Theta_m$ 和 $\\Theta_c$。\n- 情况 3（较高浓度下的更强非理想性，边界情况）：质量摩尔浓度网格 $m = [0.5, 1.0, 1.5, 2.0]$。电动势数据由下式构建\n$$\nE(m) = E_0 + \\frac{R T}{F} \\left(\\ln m + \\ln \\gamma_2(m)\\right), \\quad \\ln \\gamma_2(m) = \\frac{0.2 m}{1 + 0.5 m},\n$$\n其中 $E_0 = 0.03 \\, \\mathrm{V}$。在 $m^\\star = 1.5$ 处评估 $\\Theta_m$ 和 $\\Theta_c$。\n\n算法要求：\n- 通过在给定的非均匀网格上使用有限差分，实现对导数 $\\frac{dE}{d \\ln m}$ 的数值稳定估计。为此，使用中心差分（如果可能）和在边界处使用单侧差分来计算 $E$ 相对于 $x = \\ln m$ 的导数。如果 $m^\\star$ 不恰好是网格点，则在 $m$ 域上将导数插值到 $m^\\star$。\n- 通过用常数 $R$、$T$ 和 $F$ 适当地归一化导数来计算质量摩尔浓度热力学因子。\n- 通过链式法则，将 $\\frac{d \\ln a}{d \\ln c}$ 与 $\\frac{d \\ln a}{d \\ln m}$ 解析关联起来，即通过 $\\ln c(m)$ 对 $\\ln m$ 的导数来计算体积摩尔浓度热力学因子。明确使用所提供的 $\\rho(m)$ 和 $\\frac{d\\rho}{dm}$。\n\n答案规格：\n- 对于每种情况，返回一个浮点数对 $[\\Theta_m(m^\\star), \\Theta_c(c(m^\\star))]$。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目对应一种情况，并且本身是一个双元素列表。例如，一个包含三种情况的输出必须如下所示：\n$$\n\\texttt{[[\\theta\\_m^1,\\theta\\_c^1],[\\theta\\_m^2,\\theta\\_c^2],[\\theta\\_m^3,\\theta\\_c^3]]}\n$$\n- 所有 $\\Theta$ 值必须是无量纲的十进制浮点数。将每个报告的浮点数四舍五入到六位小数。",
            "solution": "该问题陈述经确认为科学上合理、定义明确、客观且完整。它基于热力学和电化学的基本原理，提供了所有必要的常数、模型和数据，并且表述精确。未发现任何缺陷。\n\n解决方案分三步进行：首先，建立电动势（$E$）与质量摩尔浓度热力学因子（$\\Theta_m$）之间的理论关系；其次，推导用于关联质量摩尔浓度热力学因子（$\\Theta_m$）与体积摩尔浓度热力学因子（$\\Theta_c$）的转换因子；第三，概述实现这些计算的数值算法。\n\n**1. 从电动势数据推导质量摩尔浓度热力学因子 ($\\Theta_m$)**\n\n该问题涉及一个浓差电池，其中电动势（$E$）是盐 $\\text{LiPF}_6$ 的质量摩尔浓度（$m$）的函数。盐的化学势 $\\mu$ 决定了电池电势。盐的活度 $a$ 与其质量摩尔浓度 $m$ 和平均质量摩尔活度系数 $\\gamma_\\pm$ 通过 $a = (m \\gamma_\\pm)^\\nu$ 相关联，其中 $\\nu$ 是每个化学式单位盐产生的离子数。对于 $\\text{LiPF}_6$，$\\nu=2$。\n\n能斯特方程将电动势与活度联系起来。问题为所讨论的电池提供了这种关系的简化形式：\n$$E(m) = E_0 + \\frac{R T}{F} (\\ln m + \\ln \\gamma(m))$$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$\\gamma(m)$ 代表所测量过程的有效活度系数。项 $\\ln m + \\ln \\gamma(m)$ 等价于 $\\ln a_s$，其中 $a_s$ 是电活性物质在质量摩尔浓度标度下的活度。前置因子 $\\frac{RT}{F}$ 表明这是一个单电子过程，这与测量像 $\\text{Li}^+$ 这样的单个离子的活度是一致的。\n\n质量摩尔浓度标度上的热力学因子 $\\Theta_m(m)$ 定义为盐的活度相对于质量摩尔浓度的对数导数。虽然正式定义涉及平均离子活度系数，但问题的结构意味着 $\\Theta_m$ 应从测量的电动势灵敏度中推导出来。我们以一种与所提供的电动势表达式一致的方式定义 $\\Theta_m$。让我们对 $E$ 关于质量摩尔浓度的自然对数 $x = \\ln m$ 进行微分：\n$$\\frac{dE}{d \\ln m} = \\frac{d}{d \\ln m} \\left[ E_0 + \\frac{R T}{F} \\ln a_s \\right] = \\frac{R T}{F} \\frac{d \\ln a_s}{d \\ln m}$$\n问题要求通过归一化该导数来获得无量纲的热力学因子 $\\Theta_m(m)$。这种归一化通过乘以 $\\frac{F}{RT}$ 实现：\n$$\\Theta_m(m) = \\frac{F}{RT} \\frac{dE}{d \\ln m}$$\n代入测试案例中 EMF 的形式，其中 $a_s = m\\gamma(m)$：\n$$\\Theta_m(m) = \\frac{d \\ln(m\\gamma(m))}{d \\ln m} = \\frac{d(\\ln m + \\ln \\gamma(m))}{d \\ln m} = 1 + \\frac{d \\ln \\gamma(m)}{d \\ln m}$$\n这证实了我们的方法与标准定义是一致的。因此，第一个计算步骤的核心是数值计算 $\\frac{dE}{d \\ln m}$ 并对其进行适当的缩放。\n\n**2. 转换为体积摩尔浓度热力学因子 ($\\Theta_c$)**\n\n第二个任务是将 $\\Theta_m$ 转换为其在体积摩尔浓度标度下的等效值 $\\Theta_c$。体积摩尔浓度 $c$（单位：$\\mathrm{mol/L}$）和质量摩尔浓度 $m$（单位：$\\mathrm{mol/kg}$）通过溶液密度 $\\rho$（单位：$\\mathrm{kg/L}$）和盐的摩尔质量 $M_s$（单位：$\\mathrm{kg/mol}$）相关联：\n$$c(m) = \\frac{m \\, \\rho(m)}{1 + m M_s}$$\n基本活度 $a_s$ 是溶液状态的一个属性，与浓度标度的选择无关。因此，定义为活度相对于浓度的对数导数的热力学因子，通过链式法则相关联：\n$$\\Theta_c(c) \\equiv \\frac{d \\ln a_s}{d \\ln c} = \\frac{d \\ln a_s}{d \\ln m} \\cdot \\frac{d \\ln m}{d \\ln c} = \\Theta_m(m) \\left( \\frac{d \\ln c}{d \\ln m} \\right)^{-1}$$\n为了找到转换因子，我们计算导数 $\\frac{d \\ln c}{d \\ln m}$。最方便的方法是先对 $c(m)$ 的表达式取对数：\n$$\\ln c = \\ln m + \\ln \\rho(m) - \\ln(1 + m M_s)$$\n现在，我们对 $\\ln m$ 进行微分。使用关系式 $d(\\ln m) = \\frac{1}{m} dm$：\n$$\\frac{d \\ln c}{d \\ln m} = m \\frac{d(\\ln c)}{dm} = m \\frac{d}{dm} \\left[ \\ln m + \\ln \\rho(m) - \\ln(1 + m M_s) \\right]$$\n$$ = m \\left[ \\frac{1}{m} + \\frac{1}{\\rho(m)} \\frac{d\\rho}{dm} - \\frac{M_s}{1 + m M_s} \\right] $$\n$$ = 1 + \\frac{m}{\\rho(m)} \\frac{d\\rho}{dm} - \\frac{m M_s}{1 + m M_s} $$\n这个表达式使用提供的密度模型 $\\rho(m)$ 及其导数 $\\frac{d\\rho}{dm}$ 提供了所需的转换因子。体积摩尔浓度热力学因子则为：\n$$\\Theta_c(c(m)) = \\Theta_m(m) \\left( 1 + \\frac{m}{\\rho(m)} \\frac{d\\rho}{dm} - \\frac{m M_s}{1 + m M_s} \\right)^{-1}$$\n\n**3. 数值算法设计**\n\n完整的算法如下：\n对于每个具有质量摩尔浓度网格 $\\{m_i\\}$、相应电动势数据 $\\{E_i\\}$ 和评估质量摩尔浓度 $m^\\star$ 的测试案例：\n1.  **准备数据**：为每个网格点计算 $x_i = \\ln m_i$。数据点为 $(x_i, E_i)$。\n2.  **数值微分**：在每个网格点 $m_i$ 处计算导数 $\\frac{dE}{d \\ln m}$。令结果为 $D_i$。\n    - 对于内部点（$0  i  N-1$）：使用二阶中心差分公式：\n      $$D_i = \\frac{E_{i+1} - E_{i-1}}{x_{i+1} - x_{i-1}}$$\n    - 对于第一个点（$i=0$）：使用一阶向前差分公式：\n      $$D_0 = \\frac{E_1 - E_0}{x_1 - x_0}$$\n    - 对于最后一个点（$i=N-1$）：使用一阶向后差分公式：\n      $$D_{N-1} = \\frac{E_{N-1} - E_{N-2}}{x_{N-1} - x_{N-2}}$$\n3.  **插值**：如果 $m^\\star$ 不是网格点，则在质量摩尔浓度网格 $\\{m_i\\}$ 上对计算出的导数值 $\\{D_i\\}$ 进行线性插值，以找到 $m^\\star$ 处的导数 $D^\\star$。如果 $m^\\star$ 是一个网格点，则直接使用相应的 $D_i$。\n4.  **计算 $\\Theta_m(m^\\star)$**：应用第 1 节中推导的归一化公式：\n    $$\\Theta_m(m^\\star) = D^\\star \\cdot \\frac{F}{R T}$$\n    使用给定的常数 $T = 298.15 \\, \\mathrm{K}$、$R = 8.314462618 \\, \\mathrm{J/(mol \\cdot K)}$ 和 $F = 96485.33212 \\, \\mathrm{C/mol}$。\n5.  **计算 $\\Theta_c(c(m^\\star))$**：\n    a. 使用提供的模型在 $m^\\star$ 处评估密度 $\\rho(m^\\star)$ 及其导数 $\\frac{d\\rho}{dm}(m^\\star)$：\n       $$\\rho(m^\\star) = 1.25 + 0.04 m^\\star - 0.002 (m^\\star)^2$$\n       $$\\frac{d\\rho}{dm}(m^\\star) = 0.04 - 0.004 m^\\star$$\n    b. 使用第 2 节的公式在 $m^\\star$ 处计算转换因子：\n       $$ \\text{factor} = 1 + \\frac{m^\\star}{\\rho(m^\\star)} \\frac{d\\rho}{dm}(m^\\star) - \\frac{m^\\star M_s}{1 + m^\\star M_s} $$\n       其中 $M_s = 0.1519 \\, \\mathrm{kg/mol}$。\n    c. 计算体积摩尔浓度热力学因子：\n       $$ \\Theta_c(c(m^\\star)) = \\frac{\\Theta_m(m^\\star)}{\\text{factor}} $$\n6.  **存储和格式化输出**：存储数值对 $[\\Theta_m(m^\\star), \\Theta_c(c(m^\\star))]$，四舍五入到六位小数，并对所有案例重复此过程。最终输出是这些数值对的列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the thermodynamic factor in molal and molar scales\n    from EMF data for concentrated electrolytes.\n    \"\"\"\n    # Define physical constants\n    R = 8.314462618  # J/(mol.K)\n    F = 96485.33212   # C/mol\n    T = 298.15         # K\n    M_s = 0.1519       # kg/mol for LiPF6\n\n    # Pre-calculate a constant group\n    RT_F = R * T / F  # Volts\n\n    # --- Model Definitions ---\n    def rho(m):\n        \"\"\"Solution density model in kg/L.\"\"\"\n        return 1.25 + 0.04 * m - 0.002 * m**2\n\n    def d_rho_dm(m):\n        \"\"\"Derivative of the density model w.r.t. molality.\"\"\"\n        return 0.04 - 0.004 * m\n\n    # --- Test Case Definitions ---\n    # Case 1: Ideal behavior\n    def E1(m, E0=0.15):\n        return E0 + RT_F * np.log(m)\n\n    # Case 2: Moderate nonideality\n    def E2(m, E0=0.05):\n        ln_gamma = -0.5 * np.sqrt(m) / (1.0 + 0.8 * m)\n        return E0 + RT_F * (np.log(m) + ln_gamma)\n\n    # Case 3: Stronger nonideality\n    def E3(m, E0=0.03):\n        ln_gamma = 0.2 * m / (1.0 + 0.5 * m)\n        return E0 + RT_F * (np.log(m) + ln_gamma)\n\n    test_cases = [\n        {\n            \"m_grid\": np.array([0.1, 0.2, 0.5, 1.0, 1.5]),\n            \"m_star\": 1.0,\n            \"E_func\": E1\n        },\n        {\n            \"m_grid\": np.array([0.2, 0.5, 1.0, 1.3, 1.6]),\n            \"m_star\": 1.0,\n            \"E_func\": E2\n        },\n        {\n            \"m_grid\": np.array([0.5, 1.0, 1.5, 2.0]),\n            \"m_star\": 1.5,\n            \"E_func\": E3\n        }\n    ]\n\n    # --- Main Calculation Loop ---\n    final_results = []\n    for case in test_cases:\n        m_grid = case[\"m_grid\"]\n        m_star = case[\"m_star\"]\n        E_func = case[\"E_func\"]\n\n        # Step 1: Prepare data\n        x_grid = np.log(m_grid)\n        E_grid = E_func(m_grid)\n\n        # Step 2: Numerical Differentiation of E w.r.t. ln(m)\n        dE_dlnm_grid = np.zeros_like(m_grid)\n        n_points = len(m_grid)\n\n        # First point (forward difference)\n        dE_dlnm_grid[0] = (E_grid[1] - E_grid[0]) / (x_grid[1] - x_grid[0])\n\n        # Last point (backward difference)\n        dE_dlnm_grid[-1] = (E_grid[-1] - E_grid[-2]) / (x_grid[-1] - x_grid[-2])\n\n        # Interior points (central difference)\n        for i in range(1, n_points - 1):\n            dE_dlnm_grid[i] = (E_grid[i+1] - E_grid[i-1]) / (x_grid[i+1] - x_grid[i-1])\n\n        # Step 3: Interpolate for the derivative at m_star\n        dE_dlnm_star = np.interp(m_star, m_grid, dE_dlnm_grid)\n\n        # Step 4: Calculate molal thermodynamic factor\n        theta_m = dE_dlnm_star / RT_F\n\n        # Step 5: Calculate molar thermodynamic factor\n        # Evaluate density and its derivative at m_star\n        rho_star = rho(m_star)\n        d_rho_dm_star = d_rho_dm(m_star)\n\n        # Calculate the conversion factor from ln(m) to ln(c) derivative\n        conversion_factor = (\n            1 + (m_star / rho_star) * d_rho_dm_star - (m_star * M_s) / (1 + m_star * M_s)\n        )\n\n        # Calculate theta_c\n        theta_c = theta_m / conversion_factor\n\n        # Round results\n        result_pair = [round(theta_m, 6), round(theta_c, 6)]\n        final_results.append(result_pair)\n\n    # Format final output string\n    output_str_parts = []\n    for pair in final_results:\n        output_str_parts.append(f\"[{pair[0]},{pair[1]}]\")\n    \n    print(f\"[{','.join(output_str_parts)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "在从实验数据中获得离散的热力学因子数据点后，为了在连续的仿真模型中使用，我们需要构建一个平滑的函数模型。本练习将引导您使用样条插值等数值方法，根据离散数据点建立一个连续、稳健的热力学因子模型。随后，您将应用该模型通过数值积分来预测电动势，并将预测结果与测量值进行比较，从而完成从数据处理到模型验证的完整工作流程 。",
            "id": "3957443",
            "problem": "您正在构建一个小型、独立的评估器，用于在自动化电池设计与仿真的背景下，评估浓电解质，特别是六氟磷酸锂（$\\mathrm{LiPF}_6$）中的热力学因子。该评估器必须根据给定的热力学因子数据拟合一个平滑函数，然后预测不同浓度下电解质储库之间的电动势（EMF），并将预测结果与提供的测量值进行比较。\n\n从基本原理出发。使用热力学因子的定义以及浓溶液理论中关于开路、零电流条件下电解质电势的关系式。对于二元电解质，热力学因子定义为无量纲量 $\\Theta(c)$，它调节平均离子活度系数对浓度的响应。在具有相同可逆电极的浓差电池中，电解质电势差由 $\\Theta(c)$ 沿 $\\ln c$ 的积分给出。从浓度 $c_1$到 $c_2$ 的所需电动势（EMF）是通过对由离子 Nernst 关系式和浓溶液框架共同推导出的电势梯度进行积分得到的。您不得假设任何简化的稀溶液行为或理想性；其响应必须由拟合的平滑函数 $\\hat{\\Theta}(c)$ 驱动。\n\n您的程序必须：\n- 在温度 $T=298.15$ K 下，针对目标溶剂中的 LiPF$_6$，将平滑函数 $\\hat{\\Theta}(c)$ 拟合到给定的 $\\Theta(c)$ 测量值。必须严格使用 $\\ln \\Theta$ 作为 $\\ln c$ 的三次样条函数的平滑表示，以确保正值性和平滑性。\n- 使用拟合的 $\\hat{\\Theta}(c)$，通过对零电流条件下的控制积分进行数值积分，来预测指定浓度对的 EMF 值。\n- 将预测的 EMF 值与提供的测量 EMF 值进行比较，并报告每种情况下的绝对偏差，以及整个数据集上的最大偏差。\n\n您必须使用的基本关系式是：\n- 将热力学因子定义为 $\\Theta(c)$，并将其代入浓溶液理论中关于零电流下电解质电势梯度的表达式，其中梯度与 $\\Theta(c)\\nabla \\ln c$ 成正比。\n- 对于开路条件下的二元 $1{:}1$ 型电解质，浓度分别为 $c_1$ 和 $c_2$ 的两个储库之间的电动势（EMF）为\n$$\nE(c_1,c_2) \\;=\\; \\frac{2RT}{F}\\,(1 - t_+)\\,\\int_{\\ln c_1}^{\\ln c_2} \\Theta\\!\\big(c(s)\\big)\\,ds,\n$$\n其中 $R$ 是通用气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$t_+$ 是阳离子迁移数，并且 $s=\\ln c$，$c(s)=e^s$。$E$ 以伏特为单位表示。\n\n使用以下数值常数和数据：\n- $R = 8.314$ J mol$^{-1}$ K$^{-1}$，$T = 298.15$ K，$F = 96485$ C mol$^{-1}$，$t_+ = 0.38$ (无量纲)。\n- 浓度单位：mol m$^{-3}$。\n- 电动势单位：伏特 (V)。\n- 在 $T=298.15$ K 下提供的 $\\Theta(c)$ 测量值：\n    - $c=200$ mol m$^{-3}$，$\\Theta=1.16706$；\n    - $c=400$ mol m$^{-3}$，$\\Theta=1.41778$；\n    - $c=600$ mol m$^{-3}$，$\\Theta=1.72610$；\n    - $c=800$ mol m$^{-3}$，$\\Theta=2.06182$；\n    - $c=1000$ mol m$^{-3}$，$\\Theta=2.40000$；\n    - $c=1200$ mol m$^{-3}$，$\\Theta=2.72500$；\n    - $c=1400$ mol m$^{-3}$，$\\Theta=3.02800$；\n    - $c=1600$ mol m$^{-3}$，$\\Theta=3.30800$；\n    - $c=1800$ mol m$^{-3}$，$\\Theta=3.56600$。\n- 测试组浓度对及其测量的 EMF（在 $T=298.15$ K 下独立计算）：\n    1. $(c_1,c_2)=(400,1200)$，测量的 $E=0.068429$ V。\n    2. $(c_1,c_2)=(600,1000)$，测量的 $E=0.033229$ V。\n    3. $(c_1,c_2)=(200,1800)$，测量的 $E=0.137479$ V。\n    4. $(c_1,c_2)=(800,1400)$，测量的 $E=0.044887$ V。\n    5. $(c_1,c_2)=(1000,1000)$，测量的 $E=0.000000$ V。\n    6. $(c_1,c_2)=(1600,600)$，测量的 $E=-0.075728$ V。\n\n您的算法规范：\n- 对给定的数据点进行变换，令 $x=\\ln c$ 和 $y=\\ln \\Theta$，拟合一个平滑参数为零的三次平滑样条 $y=\\hat{y}(x)$（即精确插值所提供的点），以生成一个平滑、二阶连续可微的表示。然后构造 $\\hat{\\Theta}(c)=\\exp\\!\\big(\\hat{y}(\\ln c)\\big)$，该函数严格为正且平滑。\n- 对于每对 $(c_1,c_2)$，通过对 $s$ 使用稳健的一维数值积分，数值计算 \n$$\n\\hat{E}(c_1,c_2) \\;=\\; \\frac{2RT}{F}\\,(1 - t_+)\\,\\int_{\\ln c_1}^{\\ln c_2} \\hat{\\Theta}\\!\\big(e^s\\big)\\,ds,\n$$\n来计算预测的 EMF。\n- 计算每个测试用例的绝对偏差 $|\\,\\hat{E}(c_1,c_2) - E_{\\mathrm{meas}}(c_1,c_2)\\,|$。\n- 报告所有测试用例中的最大绝对偏差。\n\n角度单位不适用。不存在百分比。所有输出必须是浮点数，单位为伏特。最终偏差以伏特表示，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表包含七个条目，分别对应六个测试用例的绝对偏差，以及这些偏差中的最大值，每个值都四舍五入到六位小数。例如，输出格式必须类似于 $[\\mathrm{d}_1,\\mathrm{d}_2,\\mathrm{d}_3,\\mathrm{d}_4,\\mathrm{d}_5,\\mathrm{d}_6,\\max(\\mathrm{d}_i)]$，单位为伏特。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于已建立的电化学理论，在数学和算法上是适定的，是客观的，并为获得唯一解提供了完整且一致的数据和约束集。\n\n该问题要求评估含有二元 $1{:}1$ 型电解质 LiPF$_6$ 的浓差电池中的电动势（EMF）。解决方案基于浓溶液理论，该理论区别于理想化的稀溶液假设。该模型的核心是热力学因子 $\\Theta(c)$，这是一个无量纲量，通过关联平均离子活度系数与浓度变化来解释非理想相互作用。\n\n对于具有对阳离子可逆电极的电池，在开路（零电流）条件下，两个浓度分别为 $c_1$ 和 $c_2$ 的储库之间的电动势（EMF）$E$ 的基本关系式由下式给出：\n$$\nE(c_1, c_2) = \\frac{2RT}{F}(1 - t_+) \\int_{\\ln c_1}^{\\ln c_2} \\Theta(c(s)) \\, ds\n$$\n其中 $s = \\ln c$。各常量为：\n- 通用气体常数, $R = 8.314 \\, \\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$\n- 绝对温度, $T = 298.15 \\, \\text{K}$\n- 法拉第常数, $F = 96485 \\, \\text{C} \\, \\text{mol}^{-1}$\n- 阳离子迁移数, $t_+ = 0.38$\n\n前置因子 $\\frac{2RT}{F}(1 - t_+)$ 结合了热力学常数与电解质的传输性质。\n\n求解方法分为三个步骤：\n\n1.  **构建热力学因子函数 $\\hat{\\Theta}(c)$**\n    必须将提供的 $\\Theta(c)$ 的离散测量值转换为在目标浓度范围内有效的连续平滑函数 $\\hat{\\Theta}(c)$。问题指定了一个稳健的方法来确保拟合函数保持严格为正且平滑。我们首先对给定的数据点 $(c_i, \\Theta_i)$ 进行变量替换：\n    $$\n    x_i = \\ln c_i \\\\\n    y_i = \\ln \\Theta_i\n    $$\n    然后，将一个三次样条 $\\hat{y}(x)$ 拟合到这些变换后的点 $(x_i, y_i)$。具体来说，使用的是一个插值三次样条，它对应于平滑参数为零的平滑样条。这确保了样条函数精确地穿过每个变换后的数据点，并且是二阶连续可微的（$C^2$）。最终的热力学因子连续函数 $\\hat{\\Theta}(c)$ 通过逆变换得到：\n    $$\n    \\hat{\\Theta}(c) = \\exp(\\hat{y}(\\ln c))\n    $$\n    这种方法保证了对于所有 $c  0$，都有 $\\hat{\\Theta}(c)  0$。\n\n2.  **预测电动势 $\\hat{E}(c_1, c_2)$**\n    在建立了连续函数 $\\hat{\\Theta}(c)$ 后，通过数值计算控制积分，来计算每个给定浓度对 $(c_1, c_2)$ 的预测电动势 $\\hat{E}(c_1, c_2)$。将 $\\hat{\\Theta}(c)$ 代入 EMF 方程，并使用积分变量 $s = \\ln c$，我们得到：\n    $$\n    \\hat{E}(c_1, c_2) = \\frac{2RT}{F}(1 - t_+) \\int_{\\ln c_1}^{\\ln c_2} \\exp(\\hat{y}(s)) \\, ds\n    $$\n    这个定积分使用标准的数值积分算法计算，该算法能为平滑的被积函数（例如从我们的样条模型派生的函数）提供高精度的近似。如果 $c_1 = c_2$，积分上下限相同，无需数值积分即可正确预测 EMF 为 $0 \\, \\text{V}$。如果 $c_1  c_2$，积分将产生一个负值，从而正确预测出负的 EMF。\n\n3.  **计算偏差**\n    对于每个测试用例，计算预测的 EMF $\\hat{E}_i$ 与提供的测量 EMF $E_{\\text{meas},i}$ 之间的绝对偏差 $d_i$：\n    $$\n    d_i = |\\hat{E}(c_{1,i}, c_{2,i}) - E_{\\text{meas},i}|\n    $$\n    最后，找出所有测试用例中的最大绝对偏差 $\\max(d_i)$。最终输出包括单个偏差列表和最大偏差，所有值均四舍五入到指定的精度。\n\n该实现将利用 `numpy` 库进行数值数据处理，使用 `scipy.interpolate.CubicSpline` 执行精确的插值样条拟合，并使用 `scipy.integrate.quad` 进行稳健的数值积分。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import CubicSpline\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Fits a thermodynamic factor model and predicts EMF for LiPF6 electrolyte.\n    \"\"\"\n    # 1. Define constants and provided data\n    R = 8.314  # J mol^-1 K^-1\n    T = 298.15  # K\n    F = 96485  # C mol^-1\n    t_plus = 0.38  # Cation transference number (dimensionless)\n\n    # Provided thermodynamic factor data (c in mol m^-3)\n    theta_data = np.array([\n        [200, 1.16706],\n        [400, 1.41778],\n        [600, 1.72610],\n        [800, 2.06182],\n        [1000, 2.40000],\n        [1200, 2.72500],\n        [1400, 3.02800],\n        [1600, 3.30800],\n        [1800, 3.56600],\n    ])\n\n    # Test suite: (c1, c2, measured_EMF in V)\n    test_cases = [\n        (400, 1200, 0.068429),\n        (600, 1000, 0.033229),\n        (200, 1800, 0.137479),\n        (800, 1400, 0.044887),\n        (1000, 1000, 0.000000),\n        (1600, 600, -0.075728),\n    ]\n\n    # 2. Construct the thermodynamic factor function using spline interpolation\n    c_values = theta_data[:, 0]\n    theta_values = theta_data[:, 1]\n\n    # Transform data to x = ln(c) and y = ln(Theta)\n    x_data = np.log(c_values)\n    y_data = np.log(theta_values)\n\n    # Create the interpolating cubic spline for y(x) = ln(Theta(ln(c)))\n    # This is equivalent to a smoothing spline with smoothing factor s=0.\n    ln_theta_spline = CubicSpline(x_data, y_data)\n\n    # Define the integrand function for EMF calculation.\n    # The integration variable is s = ln(c).\n    # The integrand is Theta(c(s)) = exp(y(s)).\n    integrand = lambda s: np.exp(ln_theta_spline(s))\n\n    # 3. Predict EMF for each test case and calculate deviations\n    deviations = []\n    prefactor = (2 * R * T / F) * (1 - t_plus)\n\n    for c1, c2, e_meas in test_cases:\n        # Handle the trivial case to avoid unnecessary integration\n        if c1 == c2:\n            integral_val = 0.0\n        else:\n            # Numerically integrate using scipy.integrate.quad\n            # The limits are ln(c1) and ln(c2)\n            integral_val, _ = quad(integrand, np.log(c1), np.log(c2))\n\n        # Calculate predicted EMF\n        e_pred = prefactor * integral_val\n\n        # Calculate absolute deviation\n        deviation = abs(e_pred - e_meas)\n        deviations.append(deviation)\n\n    # 4. Determine the maximum deviation\n    max_deviation = max(deviations) if deviations else 0.0\n\n    # 5. Format and print the final results\n    # The final list contains the 6 deviations plus the max deviation.\n    final_results = deviations + [max_deviation]\n\n    # Format output to six decimal places as required\n    formatted_results = [f\"{res:.6f}\" for res in final_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}