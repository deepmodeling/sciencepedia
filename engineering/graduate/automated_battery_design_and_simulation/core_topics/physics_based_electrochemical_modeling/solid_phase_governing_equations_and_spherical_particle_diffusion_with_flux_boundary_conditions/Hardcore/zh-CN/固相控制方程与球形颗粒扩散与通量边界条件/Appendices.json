{
    "hands_on_practices": [
        {
            "introduction": "直接求解球坐标系下的扩散偏微分方程（PDE）可能相当复杂。一个强大的数学技巧是通过变量代换将其转换为一个我们更熟悉的形式——一维热传导方程。本练习将指导您完成这一推导，并帮助您正确地转换边界条件，这是解决问题时一个至关重要且时常被忽视的步骤 。",
            "id": "3950538",
            "problem": "考虑锂离子电池多孔电极中的一个半径为 $R$ 的球形嵌入颗粒，该模型基于径向对称和固相扩散系数 $D_{s}$ 恒定的假设。令 $c_{s}(r,t)$ 表示固相锂浓度，它是径向位置 $r \\in [0,R]$ 和时间 $t \\geq 0$ 的函数。其控制关系基于球坐标系中的质量守恒和 Fick 扩散定律。假设颗粒中心保持对称性，并且其表面通过一个给定的摩尔界面通量 $j_{s}(t)$ 与周围的电解质交换锂，该通量朝外（从固相到电解质）为正。因此，$r=R$ 处的边界遵循与 Fick 第一定律一致的通量边界条件。\n\n从球体中径向对称扩散物质的质量守恒和径向通量的 Fick 第一定律出发，推导 $c_{s}(r,t)$ 的径向对称球形扩散方程，然后进行变量替换 $u(r,t) = r \\, c_{s}(r,t)$。证明该变换可在径向坐标上得到关于 $u(r,t)$ 的一维热传导方程。从第一性原理出发，且不使用任何未声明的简化公式，推导由中心处的物理正则性要求和表面处的通量边界条件所隐含的 $u(r,t)$ 在 $r=0$ 和 $r=R$ 处的相应边界条件。\n\n将以下三个解析表达式以单行矩阵的形式报告：\n- 以 $c_{s}(r,t)$ 和 $r$ 表示的变换后变量 $u(r,t)$，\n- 在中心处 $u(0,t)$ 的值，\n- 在表面处 $\\dfrac{\\partial u}{\\partial r}(R,t) - \\dfrac{1}{R} \\, u(R,t)$ 以 $j_{s}(t)$、$R$ 和 $D_{s}$ 表示的值。\n\n所有量均为符号量；无需进行数值计算。所有物理量均使用国际单位制 (SI)：长度单位为米，时间单位为秒，扩散系数单位为 $\\mathrm{m^{2} \\, s^{-1}}$，浓度单位为 $\\mathrm{mol \\, m^{-3}}$，通量单位为 $\\mathrm{mol \\, m^{-2} \\, s^{-1}}$。在最终的方框答案中不要附加单位。如果需要任何数值计算，舍入说明会指定有效数字；但此处不适用舍入。",
            "solution": "本题要求推导球形颗粒中锂扩散的变换后的偏微分方程及其相应的边界条件。推导过程如前所述，从第一性原理出发。\n\n首先，我们建立球形颗粒内固相锂浓度 $c_{s}(r,t)$ 的控制方程。在没有化学反应的情况下，物质的质量守恒由连续性方程给出：\n$$\n\\frac{\\partial c_{s}}{\\partial t} + \\nabla \\cdot \\vec{J}_{s} = 0\n$$\n其中 $\\vec{J}_{s}$ 是锂的摩尔通量矢量。根据 Fick 扩散第一定律，该通量与浓度梯度成正比：\n$$\n\\vec{J}_{s} = -D_{s} \\nabla c_{s}\n$$\n这里，$D_{s}$ 是恒定的固相扩散系数。将 Fick 第一定律代入连续性方程，得到 Fick 扩散第二定律：\n$$\n\\frac{\\partial c_{s}}{\\partial t} - \\nabla \\cdot (D_{s} \\nabla c_{s}) = 0\n$$\n由于假设 $D_{s}$ 是常数，可以将其移到散度算子之外：\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{s} \\nabla^2 c_{s}\n$$\n题目指定了球坐标系中的径向对称性。因此，浓度 $c_{s}$ 仅是径向位置 $r$ 和时间 $t$ 的函数，即 $c_{s} = c_{s}(r,t)$。在此假设下，球坐标系中的拉普拉斯算子 $\\nabla^2$ 简化为：\n$$\n\\nabla^2 = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial}{\\partial r} \\right)\n$$\n将此式代入 Fick 第二定律，得到 $c_{s}(r,t)$ 的控制偏微分方程：\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{s} \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial c_{s}}{\\partial r} \\right)\n$$\n\n接下来，我们按要求进行变量替换：$u(r,t) = r \\, c_{s}(r,t)$。根据此定义，我们可以写出 $c_{s}(r,t) = \\frac{u(r,t)}{r}$。现在我们将 $c_{s}$ 的导数转换为 $u$ 的导数。时间导数为：\n$$\n\\frac{\\partial c_{s}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left( \\frac{u}{r} \\right) = \\frac{1}{r} \\frac{\\partial u}{\\partial t}\n$$\n一阶径向导数使用商法则求得：\n$$\n\\frac{\\partial c_{s}}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( \\frac{u}{r} \\right) = \\frac{r \\frac{\\partial u}{\\partial r} - u \\frac{\\partial r}{\\partial r}}{r^2} = \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2}\n$$\n现在，我们将这些代入 $c_{s}(r,t)$ 的扩散方程。左侧变为 $\\frac{1}{r} \\frac{\\partial u}{\\partial t}$。对于右侧，我们首先计算最外层导数内的项：\n$$\nr^2 \\frac{\\partial c_{s}}{\\partial r} = r^2 \\left( \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2} \\right) = r \\frac{\\partial u}{\\partial r} - u\n$$\n现在，我们对该表达式关于 $r$ 求导：\n$$\n\\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial c_{s}}{\\partial r} \\right) = \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} - u \\right) = \\left( 1 \\cdot \\frac{\\partial u}{\\partial r} + r \\frac{\\partial^2 u}{\\partial r^2} \\right) - \\frac{\\partial u}{\\partial r} = r \\frac{\\partial^2 u}{\\partial r^2}\n$$\n将这些变换后的表达式代回 $c_{s}$ 的控制方程：\n$$\n\\frac{1}{r} \\frac{\\partial u}{\\partial t} = D_{s} \\frac{1}{r^2} \\left( r \\frac{\\partial^2 u}{\\partial r^2} \\right)\n$$\n简化右侧可得：\n$$\n\\frac{1}{r} \\frac{\\partial u}{\\partial t} = \\frac{D_{s}}{r} \\frac{\\partial^2 u}{\\partial r^2}\n$$\n两边同乘以 $r$（对于 $r \\neq 0$），得到关于 $u(r,t)$ 的一维热传导方程：\n$$\n\\frac{\\partial u}{\\partial t} = D_{s} \\frac{\\partial^2 u}{\\partial r^2}\n$$\n\n最后，我们推导 $u(r,t)$ 在 $r=0$ 和 $r=R$ 处的边界条件。\n\n在球心处，$r=0$，“物理正则性”原则要求浓度 $c_{s}(r,t)$ 保持有限。设 $c_{s}(0,t)$ 为此有限值。变换后的变量为 $u(r,t) = r \\, c_{s}(r,t)$。取 $r \\to 0$ 的极限：\n$$\nu(0,t) = \\lim_{r \\to 0} \\left( r \\, c_{s}(r,t) \\right) = 0 \\cdot c_{s}(0,t) = 0\n$$\n因此，中心处的边界条件是 $u(0,t) = 0$。\n\n在球体表面，$r=R$，存在一个给定的摩尔界面通量 $j_s(t)$，其定义为径向向外为正。该通量必须与通量矢量 $J_{r}$ 的径向分量的 Fick 第一定律一致。\n$$\nJ_{r}(R,t) = j_{s}(t)\n$$\n根据 Fick 定律，$J_{r}(r,t) = -D_{s} \\frac{\\partial c_{s}}{\\partial r}$。在边界 $r=R$ 处，可得：\n$$\n-D_{s} \\frac{\\partial c_{s}}{\\partial r} \\bigg|_{r=R} = j_{s}(t)\n$$\n我们之前已经推导了用 $u$ 表示的 $\\frac{\\partial c_{s}}{\\partial r}$ 的表达式：\n$$\n\\frac{\\partial c_{s}}{\\partial r} = \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2}\n$$\n在 $r=R$ 处计算此式：\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\bigg|_{r=R} = \\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2}\n$$\n将此式代入通量边界条件方程：\n$$\n-D_{s} \\left( \\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2} \\right) = j_{s}(t)\n$$\n为了得到题目所要求的表达式，我们重新整理此方程。首先，两边同除以 $-D_{s}$：\n$$\n\\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2} = -\\frac{j_{s}(t)}{D_{s}}\n$$\n然后，两边同乘以 $R$：\n$$\n\\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R} = -\\frac{R \\, j_{s}(t)}{D_{s}}\n$$\n这就给出了表达式 $\\frac{\\partial u}{\\partial r}(R,t) - \\frac{1}{R} u(R,t)$ 的值。\n\n所需的三个解析表达式是：\n1. 变换后变量的定义：$u(r,t) = r \\, c_{s}(r,t)$。\n2. 中心处的边界条件：$u(0,t) = 0$。\n3. 从表面边界条件推导出的表达式：$\\frac{\\partial u}{\\partial r}(R,t) - \\frac{1}{R} \\, u(R,t) = -\\frac{R \\, j_{s}(t)}{D_{s}}$。\n\n这三个结果需要以单行矩阵的形式报告。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} r \\, c_{s}(r,t) & 0 & -\\frac{R \\, j_{s}(t)}{D_{s}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在多尺度建模中，高保真度的模型（如完整的PDE）对于系统级仿真而言往往计算成本过高。通过分析极限情况（例如无穷快的扩散速率），我们可以推导出更简单且具有明确物理意义的降阶模型。本练习将展示如何将复杂的扩散PDE简化为描述平均浓度的常微分方程（ODE），这是许多简化电池模型的核心思想 。",
            "id": "3950482",
            "problem": "考虑一个锂离子电池电极中半径为 $R$ 的单个球形活性材料颗粒。设固相锂浓度为 $c_{s}(r,t)$，它依赖于径向坐标 $r \\in [0,R]$ 和时间 $t \\ge 0$。假设为球形对称且化学扩散系数 $D_{\\text{chem}}$ 是一个常数。固相扩散由质量守恒和菲克定律建模，其中质量守恒定律表述为 $\\partial c_{s}/\\partial t + \\nabla \\cdot \\boldsymbol{J}_{s} = 0$，菲克定律表述为 $\\boldsymbol{J}_{s} = - D_{\\text{chem}} \\nabla c_{s}$。在球形对称的球坐标系下，控制性偏微分方程（PDE）在 $0  r  R$ 上构成一个初边值问题，包含中心处的对称性条件和外边界上给定的摩尔表面通量：\n- 控制方程：$\\displaystyle \\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)$。\n- 中心对称性：$\\displaystyle \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0} = 0$。\n- 表面通量边界条件：$\\displaystyle \\left.\\boldsymbol{J}_{s}\\cdot \\boldsymbol{n}\\right|_{r=R} = J_{s}(t)$，即 $\\displaystyle -D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = J_{s}(t)$，其中 $\\boldsymbol{n}$ 是向外的单位法向量。这里，$J_{s}(t)$ 是施加在表面的摩尔通量，规定向外为正（单位为 mol m$^{-2}$ s$^{-1}$）。\n\n定义颗粒平均浓度 $\\displaystyle \\bar{c}_{s}(t) = \\frac{1}{V}\\int_{V} c_{s}(\\boldsymbol{x},t)\\, \\mathrm{d}V$，其中 $\\displaystyle V = \\frac{4}{3}\\pi R^{3}$ 和 $A = 4\\pi R^{2}$ 分别是颗粒的体积和表面积。假设初始固相浓度是均匀的，$\\displaystyle c_{s}(r,0) = \\bar{c}_{s}(0)$ 对于 $0 \\le r \\le R$ 成立。\n\n仅从已陈述的质量守恒定律、菲克定律以及对称性和通量边界条件出发，分析 $D_{\\text{chem}} \\to \\infty$ 的渐进行为，并从第一性原理证明，对于任何有限的 $t$，$c_{s}(r,t)$ 在 $r$ 的主导阶上为何会变得空间均匀。然后，利用颗粒上的全局质量守恒，推导在这个无限扩散系数极限下 $\\bar{c}_{s}(t)$ 的简化动力学。以 $\\bar{c}_{s}(0)$、$R$ 和 $J_{s}(t)$ 表示的 $\\bar{c}_{s}(t)$ 的单个闭式解析表达式的形式给出最终答案，该表达式对任意给定的 $J_{s}(t)$ 均有效。\n\n最终浓度 $\\bar{c}_{s}(t)$ 以 mol m$^{-3}$ 为单位表示。无需进行数值计算。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是适定的且客观的。所给问题描述了球形颗粒内的菲克扩散，这是输运现象中的一个典型问题。控制性偏微分方程（PDE）、初始条件和边界条件构成了一个标准的初边值问题。所有术语都有明确定义，前提条件在物理上和数学上都是一致的。因此，该问题被认为是有效的。\n\n按照要求，解答过程分为两部分：首先，进行渐近分析，以证明在无限扩散系数极限下浓度的空间均匀性；其次，利用全局质量守恒推导颗粒平均浓度的简化动力学。\n\n第一部分：$D_{\\text{chem}} \\to \\infty$ 的渐近分析\n\n固相扩散的控制方程如下：\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)\n$$\n在化学扩散系数趋于无穷大 $D_{\\text{chem}} \\to \\infty$ 的渐近极限下，为了使时间导数 $\\frac{\\partial c_{s}}{\\partial t}$ 保持有限（这是浓度具有物理意义演化的要求），空间项必须趋近于零。\n$$\n\\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\to 0\n$$\n这意味着括号内的项必须仅为时间的函数。对径向坐标 $r$ 积分：\n$$\n\\int \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r \\to \\int 0 \\, \\mathrm{d}r\n$$\n$$\nr^{2} \\frac{\\partial c_{s}}{\\partial r} \\to C_{1}(t)\n$$\n其中 $C_{1}(t)$ 是一个可能依赖于时间 $t$ 的积分常数。整理得到浓度梯度：\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\to \\frac{C_{1}(t)}{r^{2}}\n$$\n我们应用颗粒中心 $r=0$ 处的对称性边界条件：\n$$\n\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0} = 0\n$$\n为了使表达式 $\\frac{C_{1}(t)}{r^{2}}$ 在 $r=0$ 处为零，函数 $C_{1}(t)$ 对于所有 $t \\ge 0$ 必须恒为零。如果 $C_{1}(t)$ 非零，则梯度将在原点发散，这在物理上是不现实的，并且违反了边界条件。因此，我们必须有 $C_{1}(t) = 0$。\n\n这导出了一个结论，在 $D_{\\text{chem}} \\to \\infty$ 的极限下，颗粒内部的浓度梯度处处为零：\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\to 0 \\quad \\text{for } r \\in [0, R]\n$$\n如果浓度的空间导数为零，则浓度 $c_{s}(r,t)$ 必须是空间均匀的，即它只是时间的函数。我们可以写为 $c_{s}(r,t) \\to c_{s}(t)$。\n\n根据定义，颗粒平均浓度 $\\bar{c}_{s}(t)$ 为：\n$$\n\\bar{c}_{s}(t) = \\frac{1}{V}\\int_{V} c_{s}(\\boldsymbol{x},t)\\, \\mathrm{d}V = \\frac{\\int_{0}^{R} c_{s}(r,t) 4\\pi r^{2} \\mathrm{d}r}{\\frac{4}{3}\\pi R^{3}}\n$$\n由于在此极限下 $c_{s}(r,t)$ 是空间均匀的且等于 $c_{s}(t)$，我们可以将其从积分中提出：\n$$\n\\bar{c}_{s}(t) = \\frac{c_{s}(t) \\int_{0}^{R} 4\\pi r^{2} \\mathrm{d}r}{\\frac{4}{3}\\pi R^{3}} = \\frac{c_{s}(t) \\left(\\frac{4}{3}\\pi R^{3}\\right)}{\\frac{4}{3}\\pi R^{3}} = c_{s}(t)\n$$\n因此，在无限扩散系数极限下，颗粒内任意位置的局部浓度都等于颗粒平均浓度。\n\n第二部分：$\\bar{c}_{s}(t)$ 的简化动力学推导\n\n我们通过对PDE进行体积平均来推导 $\\bar{c}_{s}(t)$ 的控制方程。平均浓度的时间导数为：\n$$\n\\frac{d\\bar{c}_{s}(t)}{dt} = \\frac{d}{dt} \\left( \\frac{1}{V} \\int_{0}^{R} c_{s}(r,t) 4\\pi r^{2} \\mathrm{d}r \\right)\n$$\n由于体积 $V$ 和积分限是常数，我们可以将时间导数移到积分号内（莱布尼茨积分法则）：\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi}{V} \\int_{0}^{R} \\frac{\\partial c_{s}}{\\partial t} r^{2} \\mathrm{d}r\n$$\n将控制性PDE $\\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)$ 代入此表达式：\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi}{V} \\int_{0}^{R} \\left( D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\right) r^{2} \\mathrm{d}r\n$$\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi D_{\\text{chem}}}{V} \\int_{0}^{R} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r\n$$\n我们使用微积分基本定理计算该积分：\n$$\n\\int_{0}^{R} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r = \\left[ r^{2} \\frac{\\partial c_{s}}{\\partial r} \\right]_{0}^{R} = R^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} - 0^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0}\n$$\n$r=0$ 处的项为零。平均浓度的时间导数变为：\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi D_{\\text{chem}}}{V} \\left( R^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} \\right) = \\frac{4\\pi R^{2}}{V} \\left( D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} \\right)\n$$\n现在，我们使用表面通量边界条件：\n$$\n-D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = J_{s}(t) \\implies D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = -J_{s}(t)\n$$\n将此代入我们关于 $\\frac{d\\bar{c}_{s}}{dt}$ 的表达式中：\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi R^{2}}{V} (-J_{s}(t))\n$$\n颗粒的表面积是 $A = 4\\pi R^{2}$，体积是 $V = \\frac{4}{3}\\pi R^{3}$。比值 $\\frac{A}{V} = \\frac{4\\pi R^{2}}{\\frac{4}{3}\\pi R^{3}} = \\frac{3}{R}$。因此，平均浓度的常微分方程（ODE）为：\n$$\n\\frac{d\\bar{c}_{s}}{dt} = -\\frac{3}{R} J_{s}(t)\n$$\n为了求得 $\\bar{c}_{s}(t)$，我们将此ODE从时间 $t=0$ 积分到任意时间 $t$：\n$$\n\\int_{\\bar{c}_{s}(0)}^{\\bar{c}_{s}(t)} \\mathrm{d}\\bar{c}_{s} = \\int_{0}^{t} \\left(-\\frac{3}{R} J_{s}(\\tau)\\right) \\mathrm{d}\\tau\n$$\n$$\n\\bar{c}_{s}(t) - \\bar{c}_{s}(0) = -\\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau\n$$\n求解 $\\bar{c}_{s}(t)$ 得到最终表达式：\n$$\n\\bar{c}_{s}(t) = \\bar{c}_{s}(0) - \\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau\n$$\n该表达式根据初始平均浓度 $\\bar{c}_{s}(0)$、颗粒半径 $R$ 以及施加的表面通量 $J_{s}(t)$ 的历史，给出了颗粒平均浓度随时间的演化。",
            "answer": "$$\n\\boxed{\\bar{c}_{s}(0) - \\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau}\n$$"
        },
        {
            "introduction": "本练习旨在连接理论与实践。在数值模拟（如有限体积法或有限差分法）中，浓度值通常在网格单元的中心点上是已知的，而非精确地在边界上。然而，由 Butler-Volmer 方程控制的电化学反应通量却恰恰依赖于颗粒的表面浓度。本练习将探索不同的数值外推技术来估算这一表面浓度值，并量化这些技术对计算精度的影响，从而揭示在耦合扩散物理与电化学动力学时所面临的一个关键挑战 。",
            "id": "3950493",
            "problem": "考虑锂离子电池中一个半径为 $R$ 的球形活性材料单颗粒。固相浓度 $c_s(r,t)$ 满足球坐标系下的菲克扩散，由质量守恒定律和菲克第二定律给出：\n$$\\frac{\\partial c_s}{\\partial t} = \\frac{D_s}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c_s}{\\partial r}\\right), \\quad 0 \\le r \\le R$$\n其中，中心 $r=0$ 处的对称性由下式保证\n$$\\left.\\frac{\\partial c_s}{\\partial r}\\right|_{r=0}=0$$\n表面 $r=R$ 处的通量边界条件由下式保证\n$$\\left.-D_s \\frac{\\partial c_s}{\\partial r}\\right|_{r=R}=J_s$$\n\n在自动化电池设计和仿真中，表面的界面摩尔通量 $J_s$ 通过表面浓度 $c_{s,\\mathrm{surf}} = c_s(R,t)$ 依赖于巴特勒-沃尔默（Butler–Volmer）动力学。电流密度 $j$ (单位 A/m$^2$) 遵循以下方程\n$$j = i_0(c_{s,\\mathrm{surf}}, c_e)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right],$$\n其中交换电流密度 $i_0(c_{s,\\mathrm{surf}}, c_e)$ 由下式给出：\n$$i_0 = k_0 \\, c_e^{\\alpha_e} \\, \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\, \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a}.$$\n摩尔通量为 $$J_s = \\frac{j}{F}.$$\n此处，$F$ 是法拉第常数，$R_g$ 是通用气体常数，$T$ 是温度，$\\eta$ 是过电势，$k_0$ 是动力学指前因子，$c_e$ 是电解质浓度，$c_{s,\\max}$ 是最大固相浓度，而 $\\alpha_a$, $\\alpha_c$, $\\alpha_e$ 是电荷转移系数。\n\n在球形颗粒的有限体积或有限差分法离散化中，表面浓度 $c_{s,\\mathrm{surf}}$ 并不直接存储在节点上，必须根据近表面节点进行近似，以便计算巴特勒-沃尔默关系式。您的任务是定义并实现数值方法，利用最后几个近表面节点来近似 $c_{s,\\mathrm{surf}}$，并量化这种近似对 $J_s$ 计算准确性的影响。\n\n假设近表面浓度分布是平滑的，在局部可以用一个关于向内距离 $x = R - r$ 的三阶类泰勒多项式表示，\n$$c_s(r) = c_0 + A x + B x^2 + C x^3,$$\n其中 $c_0 = c_{s,\\mathrm{surf}}$ 是真实的表面浓度，$A$, $B$, $C$ 是编码局部梯度和曲率的平滑系数。对于给定的网格间距 $h0$，近表面节点位于 $r_1 = R - h$、$r_2 = R - 2h$ 和 $r_3 = R - 3h$ 处，因此对应的浓度为 $c_1 = c_s(r_1)$、$c_2 = c_s(r_2)$ 和 $c_3 = c_s(r_3)$。\n\n请实现以下三种方法，从 $\\{c_1,c_2,c_3\\}$ 近似 $c_{s,\\mathrm{surf}}$：\n- 方法 $P_0$ (最近节点法): $$\\widehat{c}_{s,\\mathrm{surf}}^{(0)} = c_1.$$\n- 方法 $P_1$ (使用两个节点的单边线性外插法): $$\\widehat{c}_{s,\\mathrm{surf}}^{(1)} = 2 c_1 - c_2.$$\n- 方法 $P_2$ (对三个节点进行二次拟合并外插至 $x=0$): 确定一个关于 $x$ 的二次多项式，该多项式插值于点集 $\\{(h,c_1),(2h,c_2),(3h,c_3)\\}$，然后计算其在 $x=0$ 处的值以得到 $$\\widehat{c}_{s,\\mathrm{surf}}^{(2)}.$$\n\n对于每种方法，使用近似的 $\\widehat{c}_{s,\\mathrm{surf}}$ 计算巴特勒-沃尔默电流密度 $j$ 和相应的摩尔通量 $J_s$。通过计算 $J_s$ 相对于用真实值 $c_{s,\\mathrm{surf}}=c_0$ 计算所得结果的相对误差来量化其影响：\n$$\\varepsilon = \\frac{\\left|J_s\\left(\\widehat{c}_{s,\\mathrm{surf}}\\right) - J_s\\left(c_0\\right)\\right|}{\\left|J_s\\left(c_0\\right)\\right|}.$$\n\n使用以下物理上合理的参数集作为测试套件。除非另有说明，所有测试用例共享以下常数：$F = 96485.33212$ C/mol，$R_g = 8.314462618$ J/(mol K)，$T = 298.15$ K，$\\alpha_a = 0.5$，$\\alpha_c = 0.5$，$\\alpha_e = 0.5$，$k_0 = 2.0$ A m$^{-2}$ (单位已整理，以使此任务的数值计算保持自洽)，$c_{s,\\max} = 3.1\\times 10^4$ mol/m$^3$，$c_e = 1.0\\times 10^3$ mol/m$^3$。\n\n测试用例（每行为 $(R,h,\\eta,c_0,A,B,C)$，其中 $R$ 和 $h$ 的单位为米，$\\eta$ 的单位为伏特，浓度的单位为 mol/m$^3$；系数 $A$ 的单位为 mol m$^{-4}$，$B$ 的单位为 mol m$^{-5}$，$C$ 的单位为 mol m$^{-6}$）：\n1. $\\left(5.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,5.0\\times 10^{-2},\\,2.5\\times 10^4,\\, -2.0\\times 10^{6},\\, 5.0\\times 10^{12},\\, -2.0\\times 10^{18}\\right)$\n2. $\\left(5.0\\times 10^{-6},\\,1.5\\times 10^{-6},\\,5.0\\times 10^{-2},\\,2.5\\times 10^4,\\, -2.0\\times 10^{6},\\, 5.0\\times 10^{12},\\, -2.0\\times 10^{18}\\right)$\n3. $\\left(5.0\\times 10^{-6},\\,1.0\\times 10^{-6},\\,2.0\\times 10^{-1},\\,0.95\\times 3.1\\times 10^4,\\, -1.0\\times 10^{6},\\, 3.0\\times 10^{12},\\, -1.0\\times 10^{18}\\right)$\n4. $\\left(5.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,5.0\\times 10^{-2},\\,1.5\\times 10^4,\\, -1.0\\times 10^{5},\\, 0,\\, 0\\right)$\n\n您的程序必须：\n- 对于每个测试用例，根据给定的 $c_0$, $A$, $B$, $C$, $R$ 和 $h$ 从多项式分布构建 $c_1$, $c_2$, $c_3$。\n- 计算 $\\widehat{c}_{s,\\mathrm{surf}}^{(0)}$, $\\widehat{c}_{s,\\mathrm{surf}}^{(1)}$ 和 $\\widehat{c}_{s,\\mathrm{surf}}^{(2)}$。\n- 使用巴特勒-沃尔默方程，为每个近似值和真实值 $c_0$ 计算 $J_s$。\n- 按 $P_0$, $P_1$, $P_2$ 的顺序返回三种方法的相对误差 $\\varepsilon^{(0)}$, $\\varepsilon^{(1)}$ 和 $\\varepsilon^{(2)}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的列表的列表，每个内部列表对应一个测试用例，并按 $[\\varepsilon^{(0)}, \\varepsilon^{(1)}, \\varepsilon^{(2)}]$ 的顺序列出结果。例如，两个测试用例的有效输出应类似于 $[[0.001,0.0001,1.0\\times 10^{-5}],[0.01,0.001,1.0\\times 10^{-4}]]$.\n- 相对误差 $\\varepsilon$ 是无量纲的；以十进制数值报告，不带任何单位。\n\n请确保科学真实性，并从第一性原理推导您的设计。实现必须是通用的，除了上述定义所要求的公式外，不得硬编码任何中间公式。程序必须是自包含的，不需要任何输入。计算在指定的参数范围内应是数值适定的，并且代码必须遵守其他地方描述的运行时环境约束。",
            "solution": "该问题要求实现并评估三种数值方法，用于近似锂离子电池中球形活性材料颗粒的表面浓度。这些近似的准确性将通过它们在计算界面摩尔通量时引入的相对误差来量化，而该通量由巴特勒-沃尔默动力学控制。解决方案通过系统地推导所需公式和概述计算算法来进行。\n\n首先，我们分析摩尔通量 $J_s$ 作为固相表面浓度 $c_{s,\\mathrm{surf}}$ 的函数的计算方法。问题给出了电流密度 $j$ 的巴特勒-沃尔默方程：\n$$ j = i_0(c_{s,\\mathrm{surf}}, c_e)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right] $$\n交换电流密度 $i_0$ 由下式给出：\n$$ i_0 = k_0 \\, c_e^{\\alpha_e} \\, \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\, \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a} $$\n摩尔通量 $J_s$ 通过法拉第常数 $F$ 与电流密度 $j$ 相关：\n$$ J_s = \\frac{j}{F} $$\n对于给定的测试用例，参数 $F$, $R_g$, $T$, $\\eta$, $\\alpha_a$, $\\alpha_c$, $\\alpha_e$, $k_0$, $c_e$ 和 $c_{s,\\max}$ 均为常数。因此，通量 $J_s$ 可以表示为单一变量 $c_{s,\\mathrm{surf}}$ 的函数：\n$$ J_s(c_{s,\\mathrm{surf}}) = \\frac{k_0 \\, c_e^{\\alpha_e}}{F} \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a} \\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right] $$\n此函数将用于计算使用精确表面浓度 $c_0$ 的“真实”通量，以及使用数值估算的表面浓度的近似通量。\n\n接下来，我们确定近表面节点的浓度值。问题将局部浓度分布定义为一个关于向内径向坐标 $x = R - r$ 的三阶多项式：\n$$ c_s(x) = c_0 + A x + B x^2 + C x^3 $$\n此处，$c_0$ 是真实的表面浓度 $c_{s,\\mathrm{surf}}$，$A$, $B$ 和 $C$ 是给定的系数。数值网格在 $r_1 = R - h$, $r_2 = R - 2h$ 和 $r_3 = R - 3h$ 处有节点，分别对应向内距离 $x_1=h$, $x_2=2h$ 和 $x_3=3h$。将这些 $x$ 值代入多项式，即可得到这些节点上的浓度，记为 $c_1$, $c_2$ 和 $c_3$：\n$$ c_1 = c_s(h) = c_0 + A h + B h^2 + C h^3 $$\n$$ c_2 = c_s(2h) = c_0 + A(2h) + B(2h)^2 + C(2h)^3 = c_0 + 2Ah + 4Bh^2 + 8Ch^3 $$\n$$ c_3 = c_s(3h) = c_0 + A(3h) + B(3h)^2 + C(3h)^3 = c_0 + 3Ah + 9Bh^2 + 27Ch^3 $$\n对于每个测试用例，都提供了参数 $c_0, A, B, C$ 和 $h$，从而可以直接计算出 $c_1, c_2$ 和 $c_3$。\n\n知道了节点浓度后，我们就可以实现三种指定的方法来近似表面浓度 $\\widehat{c}_{s,\\mathrm{surf}}$。真实值为 $c_{s,\\mathrm{surf}} = c_s(x=0) = c_0$。\n\n方法 $P_0$ (最近节点近似法)：这是最简单的近似，使用最近节点的值。\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(0)} = c_1 $$\n\n方法 $P_1$ (线性外插法)：此方法使用单边两点公式外插到表面。它等效于作一条通过点 $(2h, c_2)$ 和 $(h, c_1)$ 的直线，并求其在 $x=0$ 处的截距。给出的公式为：\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(1)} = 2 c_1 - c_2 $$\n这可以看作是消去了围绕表面的泰勒展开中的一阶项。\n\n方法 $P_2$ (二次外插法)：此方法包括将一个二次多项式 $p(x) = \\gamma + \\beta x + \\alpha x^2$ 拟合到三个点 $(h, c_1)$、$(2h, c_2)$ 和 $(3h, c_3)$，并通过计算其在 $x=0$ 处的值来得到近似值 $\\widehat{c}_{s,\\mathrm{surf}}^{(2)} = p(0) = \\gamma$。这会得到关于系数 $\\gamma, \\beta, \\alpha$ 的以下线性方程组：\n$$ c_1 = \\gamma + \\beta h + \\alpha h^2 $$\n$$ c_2 = \\gamma + \\beta (2h) + \\alpha (2h)^2 $$\n$$ c_3 = \\gamma + \\beta (3h) + \\alpha (3h)^2 $$\n我们只需要求解 $\\gamma$。使用初等行变换或克莱姆法则，可以推导出 $\\gamma$ 关于 $c_1$, $c_2$ 和 $c_3$ 的直接表达式。对于均匀网格，数值分析中的一个标准结果给出了在 $x=0$ 处外插值的解，即函数值的线性组合：\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(2)} = 3c_1 - 3c_2 + c_3 $$\n该公式将用于计算。\n\n最后，我们通过计算所得摩尔通量中的相对误差 $\\varepsilon$ 来量化每种近似方法的影响。对于每种方法 $k \\in \\{0, 1, 2\\}$，我们首先计算近似通量 $J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)})$ 和真实通量 $J_s(c_0)$。然后，相对误差为：\n$$ \\varepsilon^{(k)} = \\frac{\\left|J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)}) - J_s(c_0)\\right|}{\\left|J_s(c_0)\\right|} $$\n由于测试用例的过电势 $\\eta$ 非零，且浓度在其物理界限内 ($0  c_0  c_{s,\\max}$)，分母 $J_s(c_0)$ 不会为零，从而确保相对误差是良定义的。\n\n最终程序中实现的算法将对每个测试用例遵循以下步骤：\n1. 接收参数 $(R, h, \\eta, c_0, A, B, C)$。\n2. 使用多项式分布计算节点浓度 $c_1, c_2, c_3$。\n3. 计算三种表面浓度近似值：$\\widehat{c}_{s,\\mathrm{surf}}^{(0)}$, $\\widehat{c}_{s,\\mathrm{surf}}^{(1)}$ 和 $\\widehat{c}_{s,\\mathrm{surf}}^{(2)}$。\n4. 计算真实摩尔通量 $J_s(c_0)$。\n5. 对于每个近似值 $\\widehat{c}_{s,\\mathrm{surf}}^{(k)}$，计算近似通量 $J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)})$ 和相应的相对误差 $\\varepsilon^{(k)}$。\n6. 收集当前测试用例的三个误差 $[\\varepsilon^{(0)}, \\varepsilon^{(1)}, \\varepsilon^{(2)}]$。\n7. 处理完所有测试用例后，将收集到的结果格式化为问题陈述中指定的单个字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating surface concentration approximation errors\n    in a battery particle model.\n    \"\"\"\n    # Define physical and electrochemical constants\n    F = 96485.33212  # Faraday constant in C/mol\n    R_GAS = 8.314462618  # Universal gas constant in J/(mol K)\n    T = 298.15  # Temperature in K\n    ALPHA_A = 0.5  # Anodic charge-transfer coefficient\n    ALPHA_C = 0.5  # Cathodic charge-transfer coefficient\n    ALPHA_E = 0.5  # Electrolyte concentration order\n    K0 = 2.0  # Kinetic prefactor (units consistent with A m^-2)\n    C_S_MAX = 3.1e4  # Maximum solid concentration in mol/m^3\n    C_E = 1.0e3  # Electrolyte concentration in mol/m^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (R, h, eta, c0, A, B, C)\n        # R [m], h [m], eta [V], c0 [mol/m^3], A [mol/m^4], B [mol/m^5], C [mol/m^6]\n        (5.0e-6, 5.0e-7, 5.0e-2, 2.5e4, -2.0e6, 5.0e12, -2.0e18),\n        (5.0e-6, 1.5e-6, 5.0e-2, 2.5e4, -2.0e6, 5.0e12, -2.0e18),\n        (5.0e-6, 1.0e-6, 2.0e-1, 0.95 * 3.1e4, -1.0e6, 3.0e12, -1.0e18),\n        (5.0e-6, 5.0e-7, 5.0e-2, 1.5e4, -1.0e5, 0.0, 0.0),\n    ]\n\n    def calculate_Js(c_surf, eta):\n        \"\"\"\n        Calculates the molar flux Js based on surface concentration and overpotential.\n        \n        Args:\n            c_surf (float): The surface concentration in mol/m^3.\n            eta (float): The overpotential in V.\n\n        Returns:\n            float: The molar flux Js in mol/(m^2 s).\n        \"\"\"\n        # Ensure concentration is within physical bounds to avoid math domain errors.\n        # This is a precaution; the given test cases should not violate these bounds.\n        if c_surf = 0 or c_surf = C_S_MAX:\n             # Use a small epsilon to avoid log(0) or power of negative number issues.\n             c_surf = np.clip(c_surf, 1e-9, C_S_MAX - 1e-9)\n\n        # Exchange current density i0\n        i0 = K0 * (C_E**ALPHA_E) * ((C_S_MAX - c_surf)**ALPHA_C) * (c_surf**ALPHA_A)\n        \n        # Overpotential-dependent term from Butler-Volmer equation\n        exp_arg_base = F / (R_GAS * T)\n        exp_term_a = np.exp(ALPHA_A * exp_arg_base * eta)\n        exp_term_c = np.exp(-ALPHA_C * exp_arg_base * eta)\n        overpotential_term = exp_term_a - exp_term_c\n        \n        # Current density j\n        j = i0 * overpotential_term\n        \n        # Molar flux Js\n        Js = j / F\n        \n        return Js\n\n    all_results = []\n    for R, h, eta, c0, A, B, C in test_cases:\n        # Step 1: Construct concentrations at near-surface nodes c1, c2, c3\n        h_sq = h * h\n        h_cb = h_sq * h\n        c1 = c0 + A * h + B * h_sq + C * h_cb\n        \n        h2, h2_sq, h2_cb = 2*h, (2*h)**2, (2*h)**3\n        c2 = c0 + A * h2 + B * h2_sq + C * h2_cb\n        \n        h3, h3_sq, h3_cb = 3*h, (3*h)**2, (3*h)**3\n        c3 = c0 + A * h3 + B * h3_sq + C * h3_cb\n\n        # Step 2: Compute approximated surface concentrations\n        # P0: Nearest-node\n        c_surf_approx_0 = c1\n        # P1: Linear extrapolation\n        c_surf_approx_1 = 2 * c1 - c2\n        # P2: Quadratic extrapolation\n        c_surf_approx_2 = 3 * c1 - 3 * c2 + c3\n        \n        approximations = [c_surf_approx_0, c_surf_approx_1, c_surf_approx_2]\n        \n        # Step 3: Compute true molar flux\n        Js_true = calculate_Js(c0, eta)\n        \n        case_errors = []\n        for c_surf_approx in approximations:\n            # Step 4: Compute approximate molar flux\n            Js_approx = calculate_Js(c_surf_approx, eta)\n            \n            # Step 5: Compute relative error\n            # Denominator will not be zero for the given test cases.\n            error = np.abs(Js_approx - Js_true) / np.abs(Js_true)\n            case_errors.append(error)\n            \n        all_results.append(case_errors)\n\n    # Final print statement in the exact required format.\n    inner_lists = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(inner_lists)}]\")\n\nsolve()\n```"
        }
    ]
}