{
    "hands_on_practices": [
        {
            "introduction": "The governing partial differential equation for diffusion in a sphere can appear daunting due to its terms involving radial coordinates. However, a common and elegant mathematical technique can transform this equation into the well-known one-dimensional Cartesian heat equation. This practice  guides you through this transformation, $u(r,t) = r c_s(r,t)$, and the crucial step of deriving the corresponding boundary conditions for the new variable $u$, which is essential for solving the problem.",
            "id": "3950538",
            "problem": "Consider a single spherical intercalation particle of radius $R$ within a porous electrode of a lithium-ion battery, modeled under the assumptions of radial symmetry and constant solid-phase diffusion coefficient $D_{s}$. Let $c_{s}(r,t)$ denote the solid-phase lithium concentration as a function of radial position $r \\in [0,R]$ and time $t \\geq 0$. The governing relation is based on conservation of mass and Fick’s laws of diffusion in spherical coordinates. Assume that the particle center is symmetry-preserving and the surface exchanges lithium with the surrounding electrolyte through a prescribed molar interfacial flux $j_{s}(t)$, taken positive in the outward direction (from the solid into the electrolyte). The boundary at $r=R$ is therefore subjected to a flux boundary condition consistent with Fick’s first law.\n\nStarting from the conservation of mass for a radially symmetric diffusing species in a sphere and Fick’s first law for the radial flux, derive a radially symmetric spherical diffusion equation for $c_{s}(r,t)$ and then perform the change of variables $u(r,t) = r \\, c_{s}(r,t)$. Show that this transformation yields a one-dimensional heat equation for $u(r,t)$ in the radial coordinate. Derive, from first principles and without invoking unstated shortcut formulas, the corresponding boundary conditions for $u(r,t)$ at $r=0$ and $r=R$ implied by physical regularity at the center and the flux boundary condition at the surface.\n\nReport, as a single row matrix, the three analytic expressions consisting of:\n- the transformed variable $u(r,t)$ in terms of $c_{s}(r,t)$ and $r$,\n- the value of $u(0,t)$ at the center,\n- the value of $\\dfrac{\\partial u}{\\partial r}(R,t) - \\dfrac{1}{R} \\, u(R,t)$ at the surface in terms of $j_{s}(t)$, $R$, and $D_{s}$.\n\nAll quantities are symbolic; no numerical evaluation is required. Express all physical quantities in the International System of Units (SI): length in meters, time in seconds, diffusion coefficient in $\\mathrm{m^{2} \\, s^{-1}}$, concentration in $\\mathrm{mol \\, m^{-3}}$, and flux in $\\mathrm{mol \\, m^{-2} \\, s^{-1}}$. Do not attach units in the final boxed answer. If any numerical evaluation were required, the rounding instruction would specify significant figures; however, no rounding is applicable here.",
            "solution": "The problem requires the derivation of a transformed partial differential equation and its corresponding boundary conditions for lithium diffusion in a spherical particle. The derivation proceeds from first principles as outlined.\n\nFirst, we establish the governing equation for the solid-phase lithium concentration, $c_{s}(r,t)$, within the spherical particle. The conservation of mass for a chemical species in the absence of reactions is given by the continuity equation:\n$$\n\\frac{\\partial c_{s}}{\\partial t} + \\nabla \\cdot \\vec{J}_{s} = 0\n$$\nwhere $\\vec{J}_{s}$ is the molar flux vector of lithium. According to Fick's first law of diffusion, this flux is proportional to the concentration gradient:\n$$\n\\vec{J}_{s} = -D_{s} \\nabla c_{s}\n$$\nHere, $D_{s}$ is the constant solid-phase diffusion coefficient. Substituting Fick's first law into the continuity equation yields Fick's second law of diffusion:\n$$\n\\frac{\\partial c_{s}}{\\partial t} - \\nabla \\cdot (D_{s} \\nabla c_{s}) = 0\n$$\nSince $D_{s}$ is assumed to be constant, it can be moved outside the divergence operator:\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{s} \\nabla^2 c_{s}\n$$\nThe problem specifies radial symmetry in a spherical coordinate system. Therefore, the concentration $c_{s}$ is a function only of the radial position $r$ and time $t$, i.e., $c_{s} = c_{s}(r,t)$. The Laplacian operator, $\\nabla^2$, in spherical coordinates simplifies under this assumption to:\n$$\n\\nabla^2 = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial}{\\partial r} \\right)\n$$\nSubstituting this into Fick's second law gives the governing partial differential equation for $c_{s}(r,t)$:\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{s} \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial c_{s}}{\\partial r} \\right)\n$$\n\nNext, we perform the change of variables as specified: $u(r,t) = r \\, c_{s}(r,t)$. From this definition, we can write $c_{s}(r,t) = \\frac{u(r,t)}{r}$. We now transform the derivatives of $c_{s}$ into derivatives of $u$. The time derivative is:\n$$\n\\frac{\\partial c_{s}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left( \\frac{u}{r} \\right) = \\frac{1}{r} \\frac{\\partial u}{\\partial t}\n$$\nThe first radial derivative is found using the quotient rule:\n$$\n\\frac{\\partial c_{s}}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( \\frac{u}{r} \\right) = \\frac{r \\frac{\\partial u}{\\partial r} - u \\frac{\\partial r}{\\partial r}}{r^2} = \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2}\n$$\nNow, we substitute these into the diffusion equation for $c_{s}(r,t)$. The left-hand side becomes $\\frac{1}{r} \\frac{\\partial u}{\\partial t}$. For the right-hand side, we first evaluate the term inside the outer derivative:\n$$\nr^2 \\frac{\\partial c_{s}}{\\partial r} = r^2 \\left( \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2} \\right) = r \\frac{\\partial u}{\\partial r} - u\n$$\nNow, we take the derivative of this expression with respect to $r$:\n$$\n\\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial c_{s}}{\\partial r} \\right) = \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} - u \\right) = \\left( 1 \\cdot \\frac{\\partial u}{\\partial r} + r \\frac{\\partial^2 u}{\\partial r^2} \\right) - \\frac{\\partial u}{\\partial r} = r \\frac{\\partial^2 u}{\\partial r^2}\n$$\nSubstituting these transformed expressions back into the governing equation for $c_{s}$:\n$$\n\\frac{1}{r} \\frac{\\partial u}{\\partial t} = D_{s} \\frac{1}{r^2} \\left( r \\frac{\\partial^2 u}{\\partial r^2} \\right)\n$$\nSimplifying the right-hand side gives:\n$$\n\\frac{1}{r} \\frac{\\partial u}{\\partial t} = \\frac{D_{s}}{r} \\frac{\\partial^2 u}{\\partial r^2}\n$$\nMultiplying both sides by $r$ (for $r \\neq 0$) yields the one-dimensional heat equation for $u(r,t)$:\n$$\n\\frac{\\partial u}{\\partial t} = D_{s} \\frac{\\partial^2 u}{\\partial r^2}\n$$\n\nFinally, we derive the boundary conditions for $u(r,t)$ at $r=0$ and $r=R$.\n\nAt the center of the sphere, $r=0$, the principle of \"physical regularity\" requires that the concentration $c_{s}(r,t)$ remains finite. Let $c_{s}(0,t)$ be this finite value. The transformed variable is $u(r,t) = r \\, c_{s}(r,t)$. Taking the limit as $r \\to 0$:\n$$\nu(0,t) = \\lim_{r \\to 0} \\left( r \\, c_{s}(r,t) \\right) = 0 \\cdot c_{s}(0,t) = 0\n$$\nThus, the boundary condition at the center is $u(0,t) = 0$.\n\nAt the surface of the sphere, $r=R$, there is a prescribed molar interfacial flux, $j_s(t)$, which is defined as positive in the outward radial direction. This flux must be consistent with Fick's first law for the radial component of the flux vector, $J_{r}$.\n$$\nJ_{r}(R,t) = j_{s}(t)\n$$\nFrom Fick's Law, $J_{r}(r,t) = -D_{s} \\frac{\\partial c_{s}}{\\partial r}$. At the boundary $r=R$, this gives:\n$$\n-D_{s} \\frac{\\partial c_{s}}{\\partial r} \\bigg|_{r=R} = j_{s}(t)\n$$\nWe previously derived the expression for $\\frac{\\partial c_{s}}{\\partial r}$ in terms of $u$:\n$$\n\\frac{\\partial c_{s}}{\\partial r} = \\frac{1}{r} \\frac{\\partial u}{\\partial r} - \\frac{u}{r^2}\n$$\nEvaluating this at $r=R$:\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\bigg|_{r=R} = \\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2}\n$$\nSubstituting this into the flux boundary condition equation:\n$$\n-D_{s} \\left( \\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2} \\right) = j_{s}(t)\n$$\nTo find the expression required by the problem, we rearrange this equation. First, divide by $-D_{s}$:\n$$\n\\frac{1}{R} \\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R^2} = -\\frac{j_{s}(t)}{D_{s}}\n$$\nThen, multiply by $R$:\n$$\n\\frac{\\partial u}{\\partial r} \\bigg|_{r=R} - \\frac{u(R,t)}{R} = -\\frac{R \\, j_{s}(t)}{D_{s}}\n$$\nThis gives the value of the expression $\\frac{\\partial u}{\\partial r}(R,t) - \\frac{1}{R} u(R,t)$.\n\nThe three required analytic expressions are:\n1. The definition of the transformed variable: $u(r,t) = r \\, c_{s}(r,t)$.\n2. The boundary condition at the center: $u(0,t) = 0$.\n3. The derived expression from the surface boundary condition: $\\frac{\\partial u}{\\partial r}(R,t) - \\frac{1}{R} \\, u(R,t) = -\\frac{R \\, j_{s}(t)}{D_{s}}$.\n\nThese three results are to be reported in a single row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} r \\, c_{s}(r,t) & 0 & -\\frac{R \\, j_{s}(t)}{D_{s}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the full PDE model provides a complete description of concentration gradients, in many battery operating regimes, diffusion within the solid particle is extremely rapid. In such cases, the particle's concentration can be considered spatially uniform, simplifying the model significantly. This exercise  challenges you to rigorously explore this infinite-diffusivity limit, demonstrating how the complex PDE collapses into a simple yet powerful Ordinary Differential Equation (ODE) for the particle-average concentration, a cornerstone of many equivalent circuit and reduced-order battery models.",
            "id": "3950482",
            "problem": "Consider a single spherical active-material particle of radius $R$ in a lithium-ion battery electrode. Let the solid-phase lithium concentration be $c_{s}(r,t)$, depending on the radial coordinate $r \\in [0,R]$ and time $t \\ge 0$. Assume spherical symmetry and a constant chemical diffusivity $D_{\\text{chem}}$. The solid-phase diffusion is modeled by mass conservation and Fick’s law, where the mass conservation law states $\\partial c_{s}/\\partial t + \\nabla \\cdot \\boldsymbol{J}_{s} = 0$ and Fick’s law states $\\boldsymbol{J}_{s} = - D_{\\text{chem}} \\nabla c_{s}$. In spherical coordinates under spherical symmetry, the governing Partial Differential Equation (PDE) becomes an initial-boundary value problem on $0 < r < R$, with a symmetry condition at the center and a prescribed molar surface flux at the outer boundary:\n- Governing equation: $\\displaystyle \\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)$.\n- Center symmetry: $\\displaystyle \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0} = 0$.\n- Surface flux boundary condition: $\\displaystyle \\left.\\boldsymbol{J}_{s}\\cdot \\boldsymbol{n}\\right|_{r=R} = J_{s}(t)$, i.e., $\\displaystyle -D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = J_{s}(t)$, where $\\boldsymbol{n}$ is the outward unit normal. Here $J_{s}(t)$ is the imposed molar flux at the surface, taken positive in the outward direction (units mol m$^{-2}$ s$^{-1}$).\n\nDefine the particle-average concentration $\\displaystyle \\bar{c}_{s}(t) = \\frac{1}{V}\\int_{V} c_{s}(\\boldsymbol{x},t)\\, \\mathrm{d}V$, where $\\displaystyle V = \\frac{4}{3}\\pi R^{3}$ and $A = 4\\pi R^{2}$ are the particle volume and surface area, respectively. Assume an initially uniform solid concentration $\\displaystyle c_{s}(r,0) = \\bar{c}_{s}(0)$ for $0 \\le r \\le R$.\n\nStarting only from the stated mass conservation law, Fick’s law, and the symmetry and flux boundary conditions, analyze the asymptotic regime $D_{\\text{chem}} \\to \\infty$ and justify, from first principles, why $c_{s}(r,t)$ becomes spatially uniform to leading order in $r$ for any finite $t$. Then, use global mass conservation over the particle to deduce the reduced dynamics for $\\bar{c}_{s}(t)$ in this infinite-diffusivity limit. Provide the final answer as a single closed-form analytical expression for $\\bar{c}_{s}(t)$ in terms of $\\bar{c}_{s}(0)$, $R$, and $J_{s}(t)$, valid for arbitrary prescribed $J_{s}(t)$.\n\nExpress the final concentration $\\bar{c}_{s}(t)$ in mol m$^{-3}$. No numerical evaluation is required.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided problem describes Fickian diffusion within a spherical particle, a canonical problem in transport phenomena. The governing partial differential equation (PDE), initial condition, and boundary conditions constitute a standard initial-boundary value problem. All terms are clearly defined, and the premises are physically and mathematically consistent. The problem is therefore deemed valid.\n\nThe solution is developed in two parts as requested: first, an asymptotic analysis to justify the spatial uniformity of the concentration in the limit of infinite diffusivity, and second, a derivation of the reduced dynamics for the particle-average concentration using global mass conservation.\n\nPart 1: Asymptotic Analysis for $D_{\\text{chem}} \\to \\infty$\n\nThe governing equation for solid-phase diffusion is given as:\n$$\n\\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)\n$$\nIn the asymptotic limit where the chemical diffusivity approaches infinity, $D_{\\text{chem}} \\to \\infty$, for the time derivative $\\frac{\\partial c_{s}}{\\partial t}$ to remain finite (which is required for a physically meaningful evolution of concentration), the spatial term must approach zero.\n$$\n\\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\to 0\n$$\nThis implies that the term inside the parentheses must be a function of time only. Integrating with respect to the radial coordinate $r$:\n$$\n\\int \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r \\to \\int 0 \\, \\mathrm{d}r\n$$\n$$\nr^{2} \\frac{\\partial c_{s}}{\\partial r} \\to C_{1}(t)\n$$\nwhere $C_{1}(t)$ is an integration constant that may depend on time $t$. Rearranging for the concentration gradient gives:\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\to \\frac{C_{1}(t)}{r^{2}}\n$$\nWe apply the symmetry boundary condition at the center of the particle, $r=0$:\n$$\n\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0} = 0\n$$\nFor the expression $\\frac{C_{1}(t)}{r^{2}}$ to be zero at $r=0$, the function $C_{1}(t)$ must be identically zero for all $t \\ge 0$. If $C_{1}(t)$ were non-zero, the gradient would diverge at the origin, which is physically unrealistic and violates the boundary condition. Therefore, we must have $C_{1}(t) = 0$.\n\nThis leads to the conclusion that in the limit $D_{\\text{chem}} \\to \\infty$, the concentration gradient vanishes everywhere within the particle:\n$$\n\\frac{\\partial c_{s}}{\\partial r} \\to 0 \\quad \\text{for } r \\in [0, R]\n$$\nIf the spatial derivative of the concentration is zero, the concentration $c_{s}(r,t)$ must be spatially uniform, i.e., it is a function of time only. We can write $c_{s}(r,t) \\to c_{s}(t)$.\n\nBy definition, the particle-average concentration $\\bar{c}_{s}(t)$ is:\n$$\n\\bar{c}_{s}(t) = \\frac{1}{V}\\int_{V} c_{s}(\\boldsymbol{x},t)\\, \\mathrm{d}V = \\frac{\\int_{0}^{R} c_{s}(r,t) 4\\pi r^{2} \\mathrm{d}r}{\\frac{4}{3}\\pi R^{3}}\n$$\nSince $c_{s}(r,t)$ is spatially uniform and equal to $c_{s}(t)$ in this limit, we can take it out of the integral:\n$$\n\\bar{c}_{s}(t) = \\frac{c_{s}(t) \\int_{0}^{R} 4\\pi r^{2} \\mathrm{d}r}{\\frac{4}{3}\\pi R^{3}} = \\frac{c_{s}(t) \\left(\\frac{4}{3}\\pi R^{3}\\right)}{\\frac{4}{3}\\pi R^{3}} = c_{s}(t)\n$$\nThus, in the infinite-diffusivity limit, the local concentration anywhere in the particle is equal to the particle-average concentration.\n\nPart 2: Derivation of the Reduced Dynamics for $\\bar{c}_{s}(t)$\n\nWe derive the governing equation for $\\bar{c}_{s}(t)$ by volume-averaging the PDE. The time derivative of the average concentration is:\n$$\n\\frac{d\\bar{c}_{s}(t)}{dt} = \\frac{d}{dt} \\left( \\frac{1}{V} \\int_{0}^{R} c_{s}(r,t) 4\\pi r^{2} \\mathrm{d}r \\right)\n$$\nSince the volume $V$ and integration limits are constant, we can move the time derivative inside the integral (Leibniz integral rule):\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi}{V} \\int_{0}^{R} \\frac{\\partial c_{s}}{\\partial t} r^{2} \\mathrm{d}r\n$$\nSubstitute the governing PDE, $\\frac{\\partial c_{s}}{\\partial t} = D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right)$, into this expression:\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi}{V} \\int_{0}^{R} \\left( D_{\\text{chem}} \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\right) r^{2} \\mathrm{d}r\n$$\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi D_{\\text{chem}}}{V} \\int_{0}^{R} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r\n$$\nWe evaluate the integral using the Fundamental Theorem of Calculus:\n$$\n\\int_{0}^{R} \\frac{\\partial}{\\partial r}\\!\\left(r^{2} \\frac{\\partial c_{s}}{\\partial r}\\right) \\mathrm{d}r = \\left[ r^{2} \\frac{\\partial c_{s}}{\\partial r} \\right]_{0}^{R} = R^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} - 0^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0}\n$$\nThe term at $r=0$ is zero. The time derivative of the average concentration becomes:\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi D_{\\text{chem}}}{V} \\left( R^{2} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} \\right) = \\frac{4\\pi R^{2}}{V} \\left( D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} \\right)\n$$\nNow, we use the surface flux boundary condition:\n$$\n-D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = J_{s}(t) \\implies D_{\\text{chem}} \\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} = -J_{s}(t)\n$$\nSubstituting this into our expression for $\\frac{d\\bar{c}_{s}}{dt}$:\n$$\n\\frac{d\\bar{c}_{s}}{dt} = \\frac{4\\pi R^{2}}{V} (-J_{s}(t))\n$$\nThe particle surface area is $A = 4\\pi R^{2}$ and its volume is $V = \\frac{4}{3}\\pi R^{3}$. The ratio $\\frac{A}{V} = \\frac{4\\pi R^{2}}{\\frac{4}{3}\\pi R^{3}} = \\frac{3}{R}$. Thus, the ordinary differential equation (ODE) for the average concentration is:\n$$\n\\frac{d\\bar{c}_{s}}{dt} = -\\frac{3}{R} J_{s}(t)\n$$\nTo find $\\bar{c}_{s}(t)$, we integrate this ODE from time $t=0$ to a general time $t$:\n$$\n\\int_{\\bar{c}_{s}(0)}^{\\bar{c}_{s}(t)} \\mathrm{d}\\bar{c}_{s} = \\int_{0}^{t} \\left(-\\frac{3}{R} J_{s}(\\tau)\\right) \\mathrm{d}\\tau\n$$\n$$\n\\bar{c}_{s}(t) - \\bar{c}_{s}(0) = -\\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau\n$$\nSolving for $\\bar{c}_{s}(t)$ yields the final expression:\n$$\n\\bar{c}_{s}(t) = \\bar{c}_{s}(0) - \\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau\n$$\nThis expression gives the evolution of the particle-average concentration over time, based on the initial average concentration $\\bar{c}_{s}(0)$, the particle radius $R$, and the history of the applied surface flux $J_{s}(t)$.",
            "answer": "$$\n\\boxed{\\bar{c}_{s}(0) - \\frac{3}{R} \\int_{0}^{t} J_{s}(\\tau) \\, \\mathrm{d}\\tau}\n$$"
        },
        {
            "introduction": "In realistic battery simulations, the flux at the particle surface is not a given; it's determined by the Butler-Volmer equation, which non-linearly couples the flux to the surface concentration itself. This creates a challenge for numerical methods like FVM or FDM where concentration is typically known at cell centers, not at the boundary. This practical exercise  delves into this crucial implementation detail, asking you to evaluate and compare different numerical schemes for approximating the surface concentration and to quantify their impact on the accuracy of the computed electrochemical flux.",
            "id": "3950493",
            "problem": "Consider a single spherical active material particle of radius $R$ in a lithium-ion battery. The solid-phase concentration $c_s(r,t)$ satisfies Fickian diffusion in spherical coordinates, given by the conservation law and Fick's second law: \n$$\\frac{\\partial c_s}{\\partial t} = \\frac{D_s}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c_s}{\\partial r}\\right), \\quad 0 \\le r \\le R,$$\nwith symmetry at the center $r=0$ enforced by $$\\left.\\frac{\\partial c_s}{\\partial r}\\right|_{r=0}=0$$ and a flux boundary condition at the surface $r=R$ enforced by $$\\left.-D_s \\frac{\\partial c_s}{\\partial r}\\right|_{r=R}=J_s.$$\n\nIn automated battery design and simulation, the interfacial molar flux $J_s$ at the surface depends on the Butler–Volmer kinetics through the surface concentration $c_{s,\\mathrm{surf}} = c_s(R,t)$. The current density $j$ (in A/m$^2$) obeys\n$$j = i_0(c_{s,\\mathrm{surf}}, c_e)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right],$$\nwhere the exchange current density $i_0(c_{s,\\mathrm{surf}}, c_e)$ is given by\n$$i_0 = k_0 \\, c_e^{\\alpha_e} \\, \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\, \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a}.$$\nThe molar flux is $$J_s = \\frac{j}{F}.$$\nHere, $F$ is the Faraday constant, $R_g$ is the universal gas constant, $T$ is temperature, $\\eta$ is overpotential, $k_0$ is a kinetic prefactor, $c_e$ is electrolyte concentration, $c_{s,\\max}$ is the maximum solid concentration, and $\\alpha_a$, $\\alpha_c$, $\\alpha_e$ are charge-transfer coefficients.\n\nIn finite-volume or finite-difference discretizations for spherical particles, the surface concentration $c_{s,\\mathrm{surf}}$ is not directly stored at a node, and must be approximated from near-surface nodes to evaluate the Butler–Volmer relation. Your task is to define and implement numerical procedures to approximate $c_{s,\\mathrm{surf}}$ from the last few near-surface nodes and quantify the impact on the accuracy of $J_s$ evaluation.\n\nAssume a smooth near-surface profile represented locally by a third-order Taylor-like polynomial in the inward distance $x = R - r$,\n$$c_s(r) = c_0 + A x + B x^2 + C x^3,$$\nwhere $c_0 = c_{s,\\mathrm{surf}}$ is the true surface concentration, and $A$, $B$, $C$ are smooth coefficients encoding local gradient and curvature. The near-surface nodes are located at $r_1 = R - h$, $r_2 = R - 2h$, and $r_3 = R - 3h$ for a given grid spacing $h>0$, so the corresponding concentrations are $c_1 = c_s(r_1)$, $c_2 = c_s(r_2)$, and $c_3 = c_s(r_3)$.\n\nImplement the following three procedures to approximate $c_{s,\\mathrm{surf}}$ from $\\{c_1,c_2,c_3\\}$:\n- Procedure $P_0$ (nearest-node): $$\\widehat{c}_{s,\\mathrm{surf}}^{(0)} = c_1.$$\n- Procedure $P_1$ (one-sided linear extrapolation using two nodes): $$\\widehat{c}_{s,\\mathrm{surf}}^{(1)} = 2 c_1 - c_2.$$\n- Procedure $P_2$ (quadratic fit to three nodes, extrapolated to $x=0$): determine the quadratic polynomial in $x$ that interpolates $\\{(h,c_1),(2h,c_2),(3h,c_3)\\}$ and evaluate it at $x=0$ to obtain $$\\widehat{c}_{s,\\mathrm{surf}}^{(2)}.$$\n\nFor each procedure, compute the Butler–Volmer current density $j$ and the corresponding molar flux $J_s$ using the approximated $\\widehat{c}_{s,\\mathrm{surf}}$. Quantify its impact by computing the relative error in $J_s$ compared to the true value computed with $c_{s,\\mathrm{surf}}=c_0$:\n$$\\varepsilon = \\frac{\\left|J_s\\left(\\widehat{c}_{s,\\mathrm{surf}}\\right) - J_s\\left(c_0\\right)\\right|}{\\left|J_s\\left(c_0\\right)\\right|}.$$\n\nUse the following test suite of parameter sets, all physically plausible. Unless otherwise stated, constants are shared across the cases: $F = 96485.33212$ C/mol, $R_g = 8.314462618$ J/(mol K), $T = 298.15$ K, $\\alpha_a = 0.5$, $\\alpha_c = 0.5$, $\\alpha_e = 0.5$, $k_0 = 2.0$ A m$^{-2}$ (units arranged such that numerical evaluation is self-consistent for this task), $c_{s,\\max} = 3.1\\times 10^4$ mol/m$^3$, and $c_e = 1.0\\times 10^3$ mol/m$^3$.\n\nTest cases (each line is $(R,h,\\eta,c_0,A,B,C)$, with $R$ and $h$ in meters, $\\eta$ in volts, and concentrations in mol/m$^3$; coefficients $A$ in mol m$^{-4}$, $B$ in mol m$^{-5}$, $C$ in mol m$^{-6}$):\n1. $\\left(5.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,5.0\\times 10^{-2},\\,2.5\\times 10^4,\\, -2.0\\times 10^{6},\\, 5.0\\times 10^{12},\\, -2.0\\times 10^{18}\\right)$\n2. $\\left(5.0\\times 10^{-6},\\,1.5\\times 10^{-6},\\,5.0\\times 10^{-2},\\,2.5\\times 10^4,\\, -2.0\\times 10^{6},\\, 5.0\\times 10^{12},\\, -2.0\\times 10^{18}\\right)$\n3. $\\left(5.0\\times 10^{-6},\\,1.0\\times 10^{-6},\\,2.0\\times 10^{-1},\\,0.95\\times 3.1\\times 10^4,\\, -1.0\\times 10^{6},\\, 3.0\\times 10^{12},\\, -1.0\\times 10^{18}\\right)$\n4. $\\left(5.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,5.0\\times 10^{-2},\\,1.5\\times 10^4,\\, -1.0\\times 10^{5},\\, 0,\\, 0\\right)$\n\nYour program must:\n- For each test case, construct $c_1$, $c_2$, $c_3$ from the polynomial profile with the given $c_0$, $A$, $B$, $C$, $R$, and $h$.\n- Compute $\\widehat{c}_{s,\\mathrm{surf}}^{(0)}$, $\\widehat{c}_{s,\\mathrm{surf}}^{(1)}$, and $\\widehat{c}_{s,\\mathrm{surf}}^{(2)}$.\n- Compute $J_s$ using Butler–Volmer for each approximation and the true $c_0$.\n- Return the relative errors $\\varepsilon^{(0)}$, $\\varepsilon^{(1)}$, and $\\varepsilon^{(2)}$ for the three procedures in the order $P_0$, $P_1$, $P_2$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, one inner list per test case, each inner list ordered as $[\\varepsilon^{(0)}, \\varepsilon^{(1)}, \\varepsilon^{(2)}]$. For example, a valid output for two test cases would look like $[[0.001,0.0001,1.0\\times 10^{-5}],[0.01,0.001,1.0\\times 10^{-4}]]$.\n- The relative errors $\\varepsilon$ are dimensionless; report them as decimal values without any unit.\n\nEnsure scientific realism and derive your design from first principles. The implementation must be general and not hard-code any intermediate formula other than what is required by the definitions given above. The program must be self-contained and require no input. The computations should be numerically well-posed across the specified parameter ranges, and the code must adhere to the runtime environment constraints described elsewhere.",
            "solution": "The problem requires the implementation and evaluation of three numerical procedures for approximating the surface concentration of a spherical active material particle in a lithium-ion battery. The accuracy of these approximations is to be quantified by the relative error they introduce in the calculation of the interfacial molar flux, which is governed by Butler-Volmer kinetics. The solution proceeds through a systematic derivation of the required formulas and an outline of the computational algorithm.\n\nFirst, we analyze the calculation of the molar flux $J_s$ as a function of the solid-phase surface concentration, $c_{s,\\mathrm{surf}}$. The problem provides the Butler-Volmer equation for the current density $j$:\n$$ j = i_0(c_{s,\\mathrm{surf}}, c_e)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right] $$\nThe exchange current density, $i_0$, is given by:\n$$ i_0 = k_0 \\, c_e^{\\alpha_e} \\, \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\, \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a} $$\nThe molar flux $J_s$ is related to the current density $j$ by the Faraday constant $F$:\n$$ J_s = \\frac{j}{F} $$\nFor a given test case, the parameters $F$, $R_g$, $T$, $\\eta$, $\\alpha_a$, $\\alpha_c$, $\\alpha_e$, $k_0$, $c_e$, and $c_{s,\\max}$ are all constants. Therefore, the flux $J_s$ can be expressed as a function of a single variable, $c_{s,\\mathrm{surf}}$:\n$$ J_s(c_{s,\\mathrm{surf}}) = \\frac{k_0 \\, c_e^{\\alpha_e}}{F} \\left(c_{s,\\max} - c_{s,\\mathrm{surf}}\\right)^{\\alpha_c} \\left(c_{s,\\mathrm{surf}}\\right)^{\\alpha_a} \\left[\\exp\\left(\\frac{\\alpha_a F \\eta}{R_g T}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{R_g T}\\right)\\right] $$\nThis function will be used to calculate both the \"true\" flux using the exact surface concentration $c_0$, and the approximate fluxes using the numerically estimated surface concentrations.\n\nNext, we establish the values of the concentration at the near-surface nodes. The problem defines a local concentration profile as a third-order polynomial in the inward radial coordinate $x = R - r$:\n$$ c_s(x) = c_0 + A x + B x^2 + C x^3 $$\nHere, $c_0$ is the true surface concentration $c_{s,\\mathrm{surf}}$, and $A$, $B$, and $C$ are given coefficients. The numerical grid has nodes at $r_1 = R - h$, $r_2 = R - 2h$, and $r_3 = R - 3h$, which correspond to inward distances of $x_1=h$, $x_2=2h$, and $x_3=3h$, respectively. The concentrations at these nodes, denoted $c_1$, $c_2$, and $c_3$, are found by substituting these values of $x$ into the polynomial:\n$$ c_1 = c_s(h) = c_0 + A h + B h^2 + C h^3 $$\n$$ c_2 = c_s(2h) = c_0 + A(2h) + B(2h)^2 + C(2h)^3 = c_0 + 2Ah + 4Bh^2 + 8Ch^3 $$\n$$ c_3 = c_s(3h) = c_0 + A(3h) + B(3h)^2 + C(3h)^3 = c_0 + 3Ah + 9Bh^2 + 27Ch^3 $$\nFor each test case, the parameters $c_0, A, B, C$, and $h$ are provided, allowing for the direct calculation of $c_1$, $c_2$, and $c_3$.\n\nWith the nodal concentrations known, we can implement the three specified procedures to approximate the surface concentration, $\\widehat{c}_{s,\\mathrm{surf}}$. The true value is $c_{s,\\mathrm{surf}} = c_s(x=0) = c_0$.\n\nProcedure $P_0$ (nearest-node approximation): This is the simplest approximation, using the value at the nearest node.\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(0)} = c_1 $$\n\nProcedure $P_1$ (linear extrapolation): This procedure uses a one-sided, two-point formula to extrapolate to the surface. It is equivalent to passing a line through the points $(2h, c_2)$ and $(h, c_1)$ and finding its intercept at $x=0$. The formula is given as:\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(1)} = 2 c_1 - c_2 $$\nThis can be seen as canceling the first-order term in a Taylor expansion around the surface.\n\nProcedure $P_2$ (quadratic extrapolation): This procedure involves fitting a quadratic polynomial $p(x) = \\gamma + \\beta x + \\alpha x^2$ to the three points $(h, c_1)$, $(2h, c_2)$, and $(3h, c_3)$, and evaluating it at $x=0$ to find the approximation $\\widehat{c}_{s,\\mathrm{surf}}^{(2)} = p(0) = \\gamma$. This leads to the following system of linear equations for the coefficients $\\gamma, \\beta, \\alpha$:\n$$ c_1 = \\gamma + \\beta h + \\alpha h^2 $$\n$$ c_2 = \\gamma + \\beta (2h) + \\alpha (2h)^2 $$\n$$ c_3 = \\gamma + \\beta (3h) + \\alpha (3h)^2 $$\nWe only need to solve for $\\gamma$. Using elementary row operations or Cramer's rule, one can derive a direct expression for $\\gamma$ in terms of $c_1$, $c_2$, and $c_3$. A standard result from numerical analysis for a uniform grid gives the solution for the extrapolated value at $x=0$ as a linear combination of the function values:\n$$ \\widehat{c}_{s,\\mathrm{surf}}^{(2)} = 3c_1 - 3c_2 + c_3 $$\nThis formula will be used for computation.\n\nFinally, we quantify the impact of each approximation by computing the relative error, $\\varepsilon$, in the resulting molar flux. For each procedure $k \\in \\{0, 1, 2\\}$, we first compute the approximate flux $J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)})$ and the true flux $J_s(c_0)$. The relative error is then:\n$$ \\varepsilon^{(k)} = \\frac{\\left|J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)}) - J_s(c_0)\\right|}{\\left|J_s(c_0)\\right|} $$\nSince the test cases have non-zero overpotential $\\eta$ and the concentrations are within their physical bounds ($0 < c_0 < c_{s,\\max}$), the denominator $J_s(c_0)$ will be non-zero, ensuring the relative error is well-defined.\n\nThe algorithm implemented in the final program will follow these steps for each test case:\n1.  Receive the parameters $(R, h, \\eta, c_0, A, B, C)$.\n2.  Calculate the nodal concentrations $c_1, c_2, c_3$ using the polynomial profile.\n3.  Calculate the three surface concentration approximations: $\\widehat{c}_{s,\\mathrm{surf}}^{(0)}$, $\\widehat{c}_{s,\\mathrm{surf}}^{(1)}$, and $\\widehat{c}_{s,\\mathrm{surf}}^{(2)}$.\n4.  Calculate the true molar flux $J_s(c_0)$.\n5.  For each approximation $\\widehat{c}_{s,\\mathrm{surf}}^{(k)}$, calculate the approximate flux $J_s(\\widehat{c}_{s,\\mathrm{surf}}^{(k)})$ and the corresponding relative error $\\varepsilon^{(k)}$.\n6.  Collect the three errors $[\\varepsilon^{(0)}, \\varepsilon^{(1)}, \\varepsilon^{(2)}]$ for the current test case.\n7.  After processing all test cases, format the collected results into a single string as specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating surface concentration approximation errors\n    in a battery particle model.\n    \"\"\"\n    # Define physical and electrochemical constants\n    F = 96485.33212  # Faraday constant in C/mol\n    R_GAS = 8.314462618  # Universal gas constant in J/(mol K)\n    T = 298.15  # Temperature in K\n    ALPHA_A = 0.5  # Anodic charge-transfer coefficient\n    ALPHA_C = 0.5  # Cathodic charge-transfer coefficient\n    ALPHA_E = 0.5  # Electrolyte concentration order\n    K0 = 2.0  # Kinetic prefactor (units consistent with A m^-2)\n    C_S_MAX = 3.1e4  # Maximum solid concentration in mol/m^3\n    C_E = 1.0e3  # Electrolyte concentration in mol/m^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (R, h, eta, c0, A, B, C)\n        # R [m], h [m], eta [V], c0 [mol/m^3], A [mol/m^4], B [mol/m^5], C [mol/m^6]\n        (5.0e-6, 5.0e-7, 5.0e-2, 2.5e4, -2.0e6, 5.0e12, -2.0e18),\n        (5.0e-6, 1.5e-6, 5.0e-2, 2.5e4, -2.0e6, 5.0e12, -2.0e18),\n        (5.0e-6, 1.0e-6, 2.0e-1, 0.95 * 3.1e4, -1.0e6, 3.0e12, -1.0e18),\n        (5.0e-6, 5.0e-7, 5.0e-2, 1.5e4, -1.0e5, 0.0, 0.0),\n    ]\n\n    def calculate_Js(c_surf, eta):\n        \"\"\"\n        Calculates the molar flux Js based on surface concentration and overpotential.\n        \n        Args:\n            c_surf (float): The surface concentration in mol/m^3.\n            eta (float): The overpotential in V.\n\n        Returns:\n            float: The molar flux Js in mol/(m^2 s).\n        \"\"\"\n        # Ensure concentration is within physical bounds to avoid math domain errors.\n        # This is a precaution; the given test cases should not violate these bounds.\n        if c_surf <= 0 or c_surf >= C_S_MAX:\n             # Use a small epsilon to avoid log(0) or power of negative number issues.\n             c_surf = np.clip(c_surf, 1e-9, C_S_MAX - 1e-9)\n\n        # Exchange current density i0\n        i0 = K0 * (C_E**ALPHA_E) * ((C_S_MAX - c_surf)**ALPHA_C) * (c_surf**ALPHA_A)\n        \n        # Overpotential-dependent term from Butler-Volmer equation\n        exp_arg_base = F / (R_GAS * T)\n        exp_term_a = np.exp(ALPHA_A * exp_arg_base * eta)\n        exp_term_c = np.exp(-ALPHA_C * exp_arg_base * eta)\n        overpotential_term = exp_term_a - exp_term_c\n        \n        # Current density j\n        j = i0 * overpotential_term\n        \n        # Molar flux Js\n        Js = j / F\n        \n        return Js\n\n    all_results = []\n    for R, h, eta, c0, A, B, C in test_cases:\n        # Step 1: Construct concentrations at near-surface nodes c1, c2, c3\n        h_sq = h * h\n        h_cb = h_sq * h\n        c1 = c0 + A * h + B * h_sq + C * h_cb\n        \n        h2, h2_sq, h2_cb = 2*h, (2*h)**2, (2*h)**3\n        c2 = c0 + A * h2 + B * h2_sq + C * h2_cb\n        \n        h3, h3_sq, h3_cb = 3*h, (3*h)**2, (3*h)**3\n        c3 = c0 + A * h3 + B * h3_sq + C * h3_cb\n\n        # Step 2: Compute approximated surface concentrations\n        # P0: Nearest-node\n        c_surf_approx_0 = c1\n        # P1: Linear extrapolation\n        c_surf_approx_1 = 2 * c1 - c2\n        # P2: Quadratic extrapolation\n        c_surf_approx_2 = 3 * c1 - 3 * c2 + c3\n        \n        approximations = [c_surf_approx_0, c_surf_approx_1, c_surf_approx_2]\n        \n        # Step 3: Compute true molar flux\n        Js_true = calculate_Js(c0, eta)\n        \n        case_errors = []\n        for c_surf_approx in approximations:\n            # Step 4: Compute approximate molar flux\n            Js_approx = calculate_Js(c_surf_approx, eta)\n            \n            # Step 5: Compute relative error\n            # Denominator will not be zero for the given test cases.\n            error = np.abs(Js_approx - Js_true) / np.abs(Js_true)\n            case_errors.append(error)\n            \n        all_results.append(case_errors)\n\n    # Final print statement in the exact required format.\n    inner_lists = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(inner_lists)}]\")\n\nsolve()\n```"
        }
    ]
}