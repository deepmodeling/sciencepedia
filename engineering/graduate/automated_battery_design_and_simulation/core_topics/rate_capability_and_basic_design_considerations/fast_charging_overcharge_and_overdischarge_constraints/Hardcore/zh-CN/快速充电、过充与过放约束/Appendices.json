{
    "hands_on_practices": [
        {
            "introduction": "掌握电池的热行为是实现快速充电的第一步。本练习将引导您应用热力学第一定律，为简化的电池模型建立能量平衡。通过求解这个模型，您将能够计算出在给定散热条件下允许的最大恒定充电电流，这是所有高级充电策略的基础。",
            "id": "3914033",
            "problem": "将一个商用圆柱形锂离子电池（镍锰钴化学体系）置于带强制对流的环境箱中，以恒定电流进行快速充电。该电池被建模为一个集总热容体，受到对流冷却和内部产热的影响，内部产热来自不可逆的焦耳热和可逆的反应熵热。目标是计算允许的最大恒定充电电流 $I_{\\text{max}}$，使得稳态电池温度 $T$ 严格低于指定的上限阈值 $T_{\\text{max}}$。\n\n假设以下科学上真实且自洽的条件和参数：\n- 内阻与温度相关，通过实验确定为 $R(T) = R_{0} \\exp\\!\\left(-\\alpha \\left(T - T_{\\text{ref}}\\right)\\right)$，其中 $R_{0} = 0.018 \\ \\Omega$，$\\alpha = 0.004 \\ \\text{K}^{-1}$，且 $T_{\\text{ref}} = 298.15 \\ \\text{K}$。\n- 在相关的荷电状态（SOC）窗口内，可逆熵系数（开路电压的温度系数）近似恒定，为 $\\frac{\\partial U}{\\partial T} = -3.5 \\times 10^{-4} \\ \\text{V} \\ \\text{K}^{-1}$，代表了在中间SOC范围内充电时的吸热行为。\n- 与环境的对流传热由传热系数 $h = 15 \\ \\text{W} \\ \\text{m}^{-2} \\ \\text{K}^{-1}$ 和有效外表面积 $A = 4.2 \\times 10^{-3} \\ \\text{m}^{2}$ 表征，得到净对流热导 $hA$。\n- 环境温度为 $T_{\\text{amb}} = 298.15 \\ \\text{K}$。\n- 快速充电下允许的最高电池温度为 $T_{\\text{max}} = 328.15 \\ \\text{K}$，对应于 $55 ^{\\circ}\\text{C}$。\n- 忽略辐射和与固定装置的任何传导，并假设电池温度在空间上均匀（集总电容近似）。\n- 电池管理系统（BMS）会执行过充电压截止，但在所考虑的SOC窗口内，有足够的电压裕量，因此电压限制不会在达到热限制 $T_{\\text{max}}$ 之前被激活。\n\n从适当的第一性原理出发，推导出一个表达式来计算 $I_{\\text{max}}$，该表达式强制执行在 $T = T_{\\text{max}}$ 时的热稳态约束。然后，使用给定参数计算其数值。将 $I_{\\text{max}}$ 的最终数值结果四舍五入到四位有效数字。以安培（A）为单位表示最终电流。",
            "solution": "首先验证问题，确保其具有科学依据、内容完整且提法得当。提取所有给定条件并检查其一致性。该问题使用传热学和电化学的标准原理描述了锂离子电池在快速充电下的热行为。所提供的参数在物理上是现实的，并且为获得唯一解提供了所有必要信息。因此，该问题被认为是有效的。\n\n求解过程首先为被建模为集总电容系统的电池建立热能平衡。描述电池温度 $T$ 随时间 $t$ 变化的控制常微分方程为：\n$$m c_p \\frac{dT}{dt} = \\dot{Q}_{\\text{gen}} - \\dot{Q}_{\\text{cool}}$$\n其中 $m c_p$ 是电池的热容，$\\dot{Q}_{\\text{gen}}$ 是内部产热率，$\\dot{Q}_{\\text{cool}}$ 是向环境的散热率。\n\n问题要求找到导致稳态电池温度等于最大允许温度 $T_{\\text{max}}$ 的最大恒定充电电流 $I_{\\text{max}}$。在稳态下，温度是恒定的，因此 $\\frac{dT}{dt} = 0$。能量平衡方程简化为：\n$$\\dot{Q}_{\\text{gen}} = \\dot{Q}_{\\text{cool}}$$\n\n总产热率 $\\dot{Q}_{\\text{gen}}$ 是不可逆焦耳热和可逆熵热之和：\n$$\\dot{Q}_{\\text{gen}} = I^2 R(T) + I T \\frac{\\partial U}{\\partial T}$$\n其中 $I$ 是充电电流，$R(T)$ 是与温度相关的内阻，$\\frac{\\partial U}{\\partial T}$ 是电池开路电压 $U$ 的熵系数。\n\n散热率 $\\dot{Q}_{\\text{cool}}$ 是由于与周围环境的对流，由牛顿冷却定律描述：\n$$\\dot{Q}_{\\text{cool}} = hA(T - T_{\\text{amb}})$$\n其中 $h$ 是对流传热系数，$A$ 是电池的有效表面积，$T_{\\text{amb}}$ 是环境温度。\n\n将稳态下的产热率和散热率相等，可得：\n$$I^2 R(T) + I T \\frac{\\partial U}{\\partial T} = hA(T - T_{\\text{amb}})$$\n\n内阻是温度的函数，给出如下：\n$$R(T) = R_{0} \\exp\\!\\left(-\\alpha (T - T_{\\text{ref}})\\right)$$\n将此代入能量平衡方程，得到：\n$$I^2 \\left(R_{0} \\exp\\!\\left(-\\alpha (T - T_{\\text{ref}})\\right)\\right) + I T \\frac{\\partial U}{\\partial T} - hA(T - T_{\\text{amb}}) = 0$$\n\n为了找到最大允许电流 $I_{\\text{max}}$，我们强制施加稳态温度恰好为最大允许温度的条件，即 $T = T_{\\text{max}}$。代入 $T = T_{\\text{max}}$ 和 $I = I_{\\text{max}}$：\n$$I_{\\text{max}}^2 \\left(R_{0} \\exp\\!\\left(-\\alpha (T_{\\text{max}} - T_{\\text{ref}})\\right)\\right) + I_{\\text{max}} \\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right) - hA(T_{\\text{max}} - T_{\\text{amb}}) = 0$$\n\n这是一个关于 $I_{\\text{max}}$ 的二次方程，形式为 $a x^2 + b x + c = 0$，其中 $x = I_{\\text{max}}$。系数为：\n$$a = R_{0} \\exp\\!\\left(-\\alpha (T_{\\text{max}} - T_{\\text{ref}})\\right)$$\n$$b = T_{\\text{max}} \\frac{\\partial U}{\\partial T}$$\n$$c = -hA(T_{\\text{max}} - T_{\\text{amb}})$$\n\n使用二次方程求根公式 $I_{\\text{max}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，我们得到：\n$$I_{\\text{max}} = \\frac{-T_{\\text{max}} \\frac{\\partial U}{\\partial T} \\pm \\sqrt{\\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right)^2 - 4\\left(R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)\\right)\\left(-hA(T_{\\text{max}} - T_{\\text{amb}})\\right)}}{2R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}$$\n简化平方根下的表达式：\n$$I_{\\text{max}} = \\frac{-T_{\\text{max}} \\frac{\\partial U}{\\partial T} \\pm \\sqrt{\\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right)^2 + 4 hA (T_{\\text{max}} - T_{\\text{amb}}) R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}}{2R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}$$\n由于充电电流 $I_{\\text{max}}$ 必须是一个正的物理量，我们选择正根。\n\n现在，我们代入所提供的数值：\n- $R_{0} = 0.018 \\ \\Omega$\n- $\\alpha = 0.004 \\ \\text{K}^{-1}$\n- $T_{\\text{ref}} = 298.15 \\ \\text{K}$\n- $\\frac{\\partial U}{\\partial T} = -3.5 \\times 10^{-4} \\ \\text{V K}^{-1}$\n- $h = 15 \\ \\text{W m}^{-2} \\text{K}^{-1}$\n- $A = 4.2 \\times 10^{-3} \\ \\text{m}^{2}$\n- $T_{\\text{amb}} = 298.15 \\ \\text{K}$\n- $T_{\\text{max}} = 328.15 \\ \\text{K}$\n\n首先，我们计算系数 $a$、$b$ 和 $c$ 的值。温差为 $T_{\\text{max}} - T_{\\text{ref}} = 30 \\ \\text{K}$ 和 $T_{\\text{max}} - T_{\\text{amb}} = 30 \\ \\text{K}$。\n\n系数 $a$：这是在 $T_{\\text{max}}$ 时的电阻。\n$$a = R(T_{\\text{max}}) = 0.018 \\times \\exp(-0.004 \\times 30) = 0.018 \\times \\exp(-0.12) \\approx 0.01596456 \\ \\Omega$$\n\n系数 $b$：\n$$b = 328.15 \\times (-3.5 \\times 10^{-4}) \\approx -0.114853 \\ \\text{V}$$\n\n系数 $c$：\n$$c = -(15 \\times 4.2 \\times 10^{-3}) \\times (328.15 - 298.15) = -0.063 \\times 30 = -1.89 \\ \\text{W}$$\n\n现在，我们计算二次公式的各个组成部分：\n判别式 $\\Delta = b^2 - 4ac$：\n$$\\Delta \\approx (-0.114853)^2 - 4(0.01596456)(-1.89) \\approx 0.013191 + 0.120693 = 0.133884$$\n判别式的平方根：\n$$\\sqrt{\\Delta} \\approx \\sqrt{0.133884} \\approx 0.365899$$\n现在，我们计算 $I_{\\text{max}}$：\n$$I_{\\text{max}} = \\frac{-b + \\sqrt{b^2 - 4ac}}{2a} \\approx \\frac{-(-0.114853) + 0.365899}{2 \\times 0.01596456}$$\n$$I_{\\text{max}} \\approx \\frac{0.114853 + 0.365899}{0.03192912} = \\frac{0.480752}{0.03192912} \\approx 15.05684 \\ \\text{A}$$\n\n问题要求将结果四舍五入到四位有效数字。\n$$I_{\\text{max}} \\approx 15.06 \\ \\text{A}$$",
            "answer": "$$\\boxed{15.06}$$"
        },
        {
            "introduction": "除了热限制外，电压限制是防止电池过充的另一道关键防线。本练习探讨了一个微妙但至关重要的问题：开路电压（OCV）的迟滞效应。您将量化在使用不准确的OCV模型（例如，在充电时使用放电曲线）时，充电电压的预测偏差，并学会如何调整控制设定点以保证充电安全。",
            "id": "3914057",
            "problem": "一个单电芯锂离子电池包需要在严格的绝对电压上限 $V_{\\text{cap}} = 4.200$ V 下进行快速充电，以避免过充。自动化设计和仿真优化器使用一个集总参数模型来强制执行端电压约束。该模型包含欧姆内阻 $R$、恒定充电电流 $I_{\\text{chg}}$ 以及一个取决于荷电状态 (SOC) $z \\in [0,1]$ 的开路电压 (OCV) 函数。端电压模型是开路电压和欧姆压降之和。由于在给定的 $z$ 下，开路电压在充电和放电之间表现出迟滞现象，如果优化器使用放电开路电压进行预测，它可能会错误估计真实的充电电压。为避免在快速充电期间违反 $V_{\\text{cap}}$，优化器必须向下调整其强制执行的最大电压，以计入迟滞效应。\n\n假设对于固定荷电状态 $z$ 下的电芯，以下科学事实成立：\n- 充电期间的端电压是充电方向开路电压与欧姆压降之和。\n- 充电方向开路电压和放电方向开路电压通过一个迟滞间隙 $\\Delta U_{\\text{hys}}(z)$ 相关联，使得在相同的 $z$ 下，充电方向开路电压比放电方向开路电压高 $\\Delta U_{\\text{hys}}(z)$。\n\n优化器当前使用放电方向的开路电压来预测充电期間的端电压。给定以下条件：\n- 目标荷电状态 $z^{\\star} = 0.700$。\n- 迟滞间隙建模为一个平滑的、依赖于 SOC 的函数，在 $z=0$ 和 $z=1$ 处为零，并在内部有一个唯一的最大值：\n$$\n\\Delta U_{\\text{hys}}(z) = h_{\\max}\\,4 z\\,(1-z),\n$$\n其中 $h_{\\max} = 0.060$ V。\n- 绝对硬件电压上限 $V_{\\text{cap}} = 4.200$ V。\n- 内阻 $R = 0.035$ $\\Omega$ 和快速充电电流 $I_{\\text{chg}} = 7.50$ A。\n\n仅从“端电压等于开路电压加欧姆压降”以及“充电 OCV 比放电 OCV 高 $\\Delta U_{\\text{hys}}(z)$”这两个定律出发，推导当优化器在充电时使用放电 OCV 会如何使其电压预测产生偏差，并计算在 $z^{\\star}$ 时优化器必须强制执行的精确调整后的最大电压，以保证在这些条件下真实端电压绝不会超过 $V_{\\text{cap}}$。将最终调整后的最大电压以 V 为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "该问题要求为一个自动化电池充电优化器推导一个调整后的电压上限。该优化器的端电压模型基于一个不正确的开路电压 (OCV)，导致其电压预测存在系统性误差（或偏差）。为确保真实端电压不超过绝对硬件限制，必须考虑这种偏差。\n\n让我们用符号定义相关的物理量。\n在荷电状态 (SOC) $z$ 下充电时的真实端电压表示为 $V_{\\text{true}, \\text{chg}}(z)$。\n优化器预测的端电压为 $V_{\\text{pred}, \\text{chg}}(z)$。\n充电方向的开路电压为 $U_{\\text{chg}}(z)$，放电方向的开路电压为 $U_{\\text{dchg}}(z)$。\n内阻为 $R$，恒定充电电流为 $I_{\\text{chg}}$。\n绝对硬件电压上限为 $V_{\\text{cap}}$。\n\n问题指出，端电压是开路电压和欧姆压降之和。对于充电过程，电流流入正极，因此欧姆压降会加到开路电压上。\n\n充电期间的真实端电压由充电方向的开路电压 $U_{\\text{chg}}(z)$ 决定。其控制方程为：\n$$\nV_{\\text{true}, \\text{chg}}(z) = U_{\\text{chg}}(z) + I_{\\text{chg}} R\n$$\n\n然而，优化器错误地使用放电方向的开路电压 $U_{\\text{dchg}}(z)$ 来预测充电事件中的端电压。因此，其预测值为：\n$$\nV_{\\text{pred}, \\text{chg}}(z) = U_{\\text{dchg}}(z) + I_{\\text{chg}} R\n$$\n\n问题通过迟滞间隙 $\\Delta U_{\\text{hys}}(z)$ 定义了充电和放电开路电压之间的关系。在相同的 SOC $z$ 下，充电开路电压高于放电开路电压：\n$$\nU_{\\text{chg}}(z) = U_{\\text{dchg}}(z) + \\Delta U_{\\text{hys}}(z)\n$$\n\n现在，我们可以推导优化器预测中的偏差。我们将 $U_{\\text{chg}}(z)$ 的表达式代入真实端电压的方程中：\n$$\nV_{\\text{true}, \\text{chg}}(z) = \\left( U_{\\text{dchg}}(z) + \\Delta U_{\\text{hys}}(z) \\right) + I_{\\text{chg}} R\n$$\n重新整理这些项，我们可以在这个表达式中识别出优化器预测的电压：\n$$\nV_{\\text{true}, \\text{chg}}(z) = \\left( U_{\\text{dchg}}(z) + I_{\\text{chg}} R \\right) + \\Delta U_{\\text{hys}}(z)\n$$\n这可以简化为：\n$$\nV_{\\text{true}, \\text{chg}}(z) = V_{\\text{pred}, \\text{chg}}(z) + \\Delta U_{\\text{hys}}(z)\n$$\n这个方程揭示了偏差：真实端电压总是比优化器预测的电压高出恰好一个迟滞电压间隙 $\\Delta U_{\\text{hys}}(z)$。欧姆压降项 $I_{\\text{chg}} R$ 在两个模型中都存在，并且不对它们之间的偏差产生影响。\n\n为保证安全，真实端电压绝不能超过绝对硬件上限 $V_{\\text{cap}}$：\n$$\nV_{\\text{true}, \\text{chg}}(z) \\le V_{\\text{cap}}\n$$\n将我们推导出的关系代入这个不等式，得到对预测电压的约束：\n$$\nV_{\\text{pred}, \\text{chg}}(z) + \\Delta U_{\\text{hys}}(z) \\le V_{\\text{cap}}\n$$\n优化器必须对其预测值 $V_{\\text{pred}, \\text{chg}}(z)$ 强制执行一个电压限制，以确保满足此条件。设优化器强制执行的调整后最大电压为 $V_{\\text{adj}}$。为确保不等式对所有状态都成立，优化器的限制必须设置为：\n$$\nV_{\\text{pred}, \\text{chg}}(z) \\le V_{\\text{adj}}\n$$\n最严格的条件发生在预测电压达到其允许的最大值 $V_{\\text{adj}}$ 时。此时，我们仍必须满足安全约束：\n$$\nV_{\\text{adj}} + \\Delta U_{\\text{hys}}(z) \\le V_{\\text{cap}}\n$$\n因此，对于给定的 SOC $z$，调整后的电压上限必须满足：\n$$\nV_{\\text{adj}} \\le V_{\\text{cap}} - \\Delta U_{\\text{hys}}(z)\n$$\n问题要求计算在特定 SOC $z^{\\star} = 0.700$ 时的精确调整后最大电压。这对应于在该 SOC 下 $V_{\\text{adj}}$ 的最高可能值，即：\n$$\nV_{\\text{adj}} = V_{\\text{cap}} - \\Delta U_{\\text{hys}}(z^{\\star})\n$$\n我们已知迟滞间隙的模型为：\n$$\n\\Delta U_{\\text{hys}}(z) = h_{\\max}\\,4 z\\,(1-z)\n$$\n给定的参数是 $h_{\\max} = 0.060$ V，$V_{\\text{cap}} = 4.200$ V 和 $z^{\\star} = 0.700$。请注意，$R = 0.035$ $\\Omega$ 和 $I_{\\text{chg}} = 7.50$ A 的值对于定义物理背景是必要的，但对于计算调整后的电压上限则不是必需的，因为它们在偏差计算中被抵消了。\n\n首先，我们计算在 $z^{\\star}$ 处的迟滞间隙：\n$$\n\\Delta U_{\\text{hys}}(0.700) = (0.060) \\times 4 \\times (0.700) \\times (1 - 0.700)\n$$\n$$\n\\Delta U_{\\text{hys}}(0.700) = 0.060 \\times 4 \\times 0.700 \\times 0.300\n$$\n$$\n\\Delta U_{\\text{hys}}(0.700) = 0.240 \\times 0.210\n$$\n$$\n\\Delta U_{\\text{hys}}(0.700) = 0.0504 \\text{ V}\n$$\n接下来，我们计算调整后的最大电压 $V_{\\text{adj}}$：\n$$\nV_{\\text{adj}} = 4.200 - 0.0504\n$$\n$$\nV_{\\text{adj}} = 4.1496 \\text{ V}\n$$\n问题要求将答案四舍五入到四位有效数字。数字 $4.1496$ 有五位有效数字。第五位有效数字是 $6$，所以我们将第四位数字向上取整。\n$$\nV_{\\text{adj}} \\approx 4.150 \\text{ V}\n$$\n这是优化器在 $z^{\\star} = 0.700$ 时必须强制执行的最大电压，以确保真实电芯电压不会超过 $4.200$ V 的绝对上限。",
            "answer": "$$\\boxed{4.150}$$"
        },
        {
            "introduction": "现实世界中的快速充电是一个动态过程，其中热、电压和电流限制相互作用，共同决定了充电速度。这项综合性练习将引导您从静态分析走向动态优化。您将通过编程实现一个仿真模型，以找到在所有约束条件下时间最优的充电策略，从而直观地理解不同限制因素之间的权衡，并量化先进热管理策略所带来的性能提升。",
            "id": "3913997",
            "problem": "您的任务是构建一个完整、可运行的程序，使用集总电热模型并显式强制执行防止过充和过放的安全约束，来确定在为单个锂离子电池快速充电时，允许温度温和升高所能带来的充电时间缩短量。该程序必须通过在每个时间步选择约束所允许的最高充电电流来计算时间最优的充电电流曲线，并且必须量化在更严格的热约束和更宽松的热约束之间充电时间的改善。所有动态和约束都应以适合数值时间步进的集总形式表示。\n\n从以下基本原理开始：\n\n- 应用于温度的集总能量平衡的热力学第一定律：\n  $$C_{\\mathrm{th}} \\frac{dT}{dt} = -hA \\left(T - T_{\\mathrm{amb}}\\right) + I^2 R_{\\mathrm{int}}(T,S),$$\n  其中 $C_{\\mathrm{th}}$ 是热容，单位为焦耳/开尔文；$hA$ 是综合传热系数，单位为瓦特/开尔文；$T$ 是电池温度，单位为开尔文；$T_{\\mathrm{amb}}$ 是环境温度，单位为开尔文；$I$ 是充电电流，单位为安培；$R_{\\mathrm{int}}(T,S)$ 是内阻，单位为欧姆，建模为温度 $T$ 和荷电状态 (SOC) $S$ 的函数。\n\n- SOC 的电荷守恒：\n  $$\\frac{dS}{dt} = \\frac{I}{Q},$$\n  其中 $Q$ 是电池容量，单位为库仑，$S \\in [0,1]$。\n\n- 端电压构成：\n  $$V = V_{\\mathrm{oc}}(S) + I \\, R_{\\mathrm{int}}(T,S),$$\n  其中 $V_{\\mathrm{oc}}(S)$ 是开路电压 (OCV)，作为 SOC 的函数。\n\n充电控制 $I(t)$ 必须在所有时间 $t$ 满足以下约束：\n\n- 热安全：$$T(t) \\leq T_{\\max},$$ 其中 $T_{\\max}$ 是允许的峰值温度，单位为开尔文。\n- 电压安全（防止过充）：$$V(t) \\leq V_{\\max},$$ 其中 $V_{\\max}$ 是允许的最大端电压，单位为伏特。\n- 电流限制（快充硬件限制）：$$0 \\leq I(t) \\leq I_{\\max},$$ 其中 $I_{\\max}$ 单位为安培。\n- SOC 安全（防止过充和过放）：$$0 \\leq S(t) \\leq 1.$$\n\n假设：\n- 忽略可逆熵热和副反应。\n- 对热动态和 SOC 动态使用步长为 $\\Delta t$ 秒的定步长显式欧拉时间离散化。\n- 使用以下科学上合理且平滑的参数形式表示内阻和开路电压：\n  $$R_{\\mathrm{int}}(T,S) = R_0 \\left[1 + a \\left(1 - S\\right)\\right] \\left[1 + b \\frac{T_{\\mathrm{ref}} - T}{T_{\\mathrm{ref}}}\\right],$$\n  $$V_{\\mathrm{oc}}(S) = V_{\\min} + \\Delta V \\, S^{\\alpha},$$\n  其中 $R_0  0$、$a \\geq 0$、$b \\geq 0$、$T_{\\mathrm{ref}}$ (开尔文)、$V_{\\min}$ (伏特)、$\\Delta V$ (伏特) 和 $\\alpha  0$ 是常数。\n\n目标和数值程序：\n- 目标是在上述约束条件下，将 SOC 从初始值 $S_0$ 充到目标值 $S_{\\mathrm{target}}$ 的时间最小化。在每个时间步，选择所有约束所允许的最大电流 $I$，以便在显式欧拉推进下，下一步的状态保持可行。\n- 对于热可行性，强制要求通过步长为 $\\Delta t$ 的显式欧拉方法获得的下一步温度 $T_{k+1}$ 不超过 $T_{\\max}$；对于电压可行性，强制要求瞬时端电压不超过 $V_{\\max}$；对于 SOC，强制要求 $S \\in [0,1]$。\n- 当 SOC 首次满足 $S \\geq S_{\\mathrm{target}}$ 时，充电完成。\n\n您的程序必须为下面的测试套件中的每个测试案例计算在两个热上限下的最小充电时间：一个较严格的上限 $T_{\\max}^{\\mathrm{low}}$ 和一个轻度放宽的上限 $T_{\\max}^{\\mathrm{high}}$。报告以秒为单位的改善量，定义为严格和放宽最小充电时间之间的差值：\n$$\\Delta t_{\\mathrm{improve}} = t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{low}}) - t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{high}}).$$\n\n所有输出均以秒为单位表示为浮点数，四舍五入到三位小数。不涉及角度。不需要百分比。\n\n测试套件：\n对于每个案例，参数以元组形式给出。除非另有说明，所有数字均采用其自然的国际单位制单位；容量单位为库仑，温度单位为开尔文，电压单位为伏特，电流单位为安培。\n\n- 案例 1 (通用快充，混合约束):\n  $$Q = 10800,\\ R_0 = 0.05,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 1.2,\\ C_{\\mathrm{th}} = 600,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 30.0,\\ S_0 = 0.1,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 308.$$\n\n- 案例 2 (充电末期电压受限):\n  $$Q = 10800,\\ R_0 = 0.05,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 1.2,\\ C_{\\mathrm{th}} = 600,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 30.0,\\ S_0 = 0.8,\\ S_{\\mathrm{target}} = 0.95,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 301,\\ T_{\\max}^{\\mathrm{high}} = 305.$$\n\n- 案例 3 (热瓶颈，轻度放宽带来较大增益):\n  $$Q = 10800,\\ R_0 = 0.08,\\ a = 0.6,\\ b = 0.2,\\ T_{\\mathrm{ref}} = 298,\\ hA = 0.5,\\ C_{\\mathrm{th}} = 400,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 20.0,\\ S_0 = 0.2,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 306.$$\n\n- 案例 4 (电流受硬件限制，热放宽影响可忽略不计):\n  $$Q = 10800,\\ R_0 = 0.02,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 3.0,\\ C_{\\mathrm{th}} = 800,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 8.0,\\ S_0 = 0.1,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 308.$$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个案例的改善值，格式为逗号分隔的列表，并用方括号括起来，例如：\n$$[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4],$$\n其中每个 $\\Delta t_i$ 是一个以秒为单位的浮点数，四舍五入到三位小数，没有额外的空格或文本。",
            "solution": "我们从第一性原理出发，在集总电热模型内推导出时间最优的充电策略。荷电状态 (SOC) $S$ 随着施加的电流 $I$ 单调增加，遵循 $\\frac{dS}{dt} = \\frac{I}{Q}$，其中 $Q  0$ 是固定的。根据第一定律能量平衡的温度演化为\n$$C_{\\mathrm{th}} \\frac{dT}{dt} = -hA \\left(T - T_{\\mathrm{amb}}\\right) + I^2 R_{\\mathrm{int}}(T,S),$$\n其中焦耳热项 $I^2 R_{\\mathrm{int}}(T,S)$ 对于 $I \\ge 0$ 和 $R_{\\mathrm{int}}(T,S)  0$ 是非负的。\n\n端电压模型为\n$$V(t) = V_{\\mathrm{oc}}(S(t)) + I(t) R_{\\mathrm{int}}(T(t),S(t)),$$\n其中开路电压 (OCV) $V_{\\mathrm{oc}}(S)$ 和内阻 $R_{\\mathrm{int}}(T,S)$ 由下式给出\n$$V_{\\mathrm{oc}}(S) = V_{\\min} + \\Delta V \\, S^{\\alpha}, \\quad R_{\\mathrm{int}}(T,S) = R_0 \\left[1 + a \\left(1 - S\\right)\\right] \\left[1 + b \\frac{T_{\\mathrm{ref}} - T}{T_{\\mathrm{ref}}}\\right],$$\n其中参数满足 $R_0  0$, $a \\ge 0$, $b \\ge 0$, $T_{\\mathrm{ref}}  0$, $\\Delta V  0$, and $\\alpha  0$。这些形式确保了 $R_{\\mathrm{int}}(T,S)  0$ 以及 $V_{\\mathrm{oc}}(S)$ 随 $S$ 物理上合理地增加。\n\n我们寻求在路径约束\n$$0 \\le I(t) \\le I_{\\max}, \\quad V(t) \\le V_{\\max}, \\quad T(t) \\le T_{\\max}, \\quad 0 \\le S(t) \\le 1$$\n的条件下，将 SOC 从 $S_0$ 充至 $S_{\\mathrm{target}}$ 的充电时间最小化。\n\n最优策略的原理性论证：成本泛函是总时间，$J = \\int_0^{t_f} 1 \\, dt$，其中 $t_f$ 是 $S(t_f) \\ge S_{\\mathrm{target}}$ 的首次时间。对于 $I \\ge 0$，SOC 动态严格随 $I$ 增加，且所有约束在状态空间的每个点都定义了 $I(t)$ 的一个上界。根据庞特里亚金极大值原理 (Pontryagin Maximum Principle)，对于一个时间最小化问题，若控制量在线性动力学中进入，并且路径可行集由不等式约束定义，则最优控制是 bang-bang 型的：在每个时刻，控制量 $I(t)$ 应选择在保持可行性的最高值。在我们的设定中，这转化为设置\n$$I(t) = \\min\\left\\{I_{\\max},\\ I_{\\mathrm{volt}}(T,S),\\ I_{\\mathrm{therm}}(T,S)\\right\\},$$\n其中 $I_{\\mathrm{volt}}(T,S)$ 是与电压约束 $V \\le V_{\\max}$ 一致的最大电流，$I_{\\mathrm{therm}}(T,S)$ 是在所选离散化方法下保持 $T \\le T_{\\max}$ 的最大电流。\n\n电压可行性界限：从 $V = V_{\\mathrm{oc}}(S) + I R_{\\mathrm{int}}(T,S) \\le V_{\\max}$ 和 $R_{\\mathrm{int}}(T,S)  0$ 可得，瞬时界限为\n$$I_{\\mathrm{volt}}(T,S) = \\max\\left\\{0,\\ \\frac{V_{\\max} - V_{\\mathrm{oc}}(S)}{R_{\\mathrm{int}}(T,S)}\\right\\}.$$\n\n显式欧拉法下的热可行性界限：时间步长为 $\\Delta t$ 时，显式欧拉更新为\n$$T_{k+1} = T_k + \\frac{\\Delta t}{C_{\\mathrm{th}}} \\left[-hA \\left(T_k - T_{\\mathrm{amb}}\\right) + I_k^2 R_{\\mathrm{int}}(T_k,S_k)\\right].$$\n为了强制 $T_{k+1} \\le T_{\\max}$，我们需要\n$$I_k^2 R_{\\mathrm{int}}(T_k,S_k) \\le \\frac{C_{\\mathrm{th}}}{\\Delta t} \\left(T_{\\max} - T_k\\right) + hA \\left(T_k - T_{\\mathrm{amb}}\\right).$$\n因此，对于给定的步长，\n$$I_{\\mathrm{therm}}(T_k,S_k) = \\begin{cases}\n\\sqrt{\\dfrac{\\dfrac{C_{\\mathrm{th}}}{\\Delta t} \\left(T_{\\max} - T_k\\right) + hA \\left(T_k - T_{\\mathrm{amb}}\\right)}{R_{\\mathrm{int}}(T_k,S_k)}}  \\text{如果分子非负},\\\\\n0  \\text{否则}.\n\\end{cases}$$\n此界限确保下一步的温度不超过上限。\n\nSOC 可行性通过将 $S$ 钳位在 $[0,1]$ 区间内并在 $S \\ge S_{\\mathrm{target}}$ 时停止来保持。通过从 $S_0 \\ge 0$ 开始并强制 $I \\ge 0$ 来避免过放。\n\n每个测试案例的算法流程：\n\n1. 初始化 $S \\leftarrow S_0$，$T \\leftarrow T_{\\mathrm{amb}}$，以及 $t \\leftarrow 0$。\n2. 当 $S  S_{\\mathrm{target}}$ 时循环：\n   - 计算 $R_{\\mathrm{int}}(T,S)$ 和 $V_{\\text{oc}}(S)$。\n   - 根据 $V \\le V_{\\max}$ 计算 $I_{\\mathrm{volt}}(T,S)$。\n   - 根据 $T_{k+1} \\le T_{\\max}$ 计算 $I_{\\mathrm{therm}}(T,S)$。\n   - 设置 $I \\leftarrow \\min\\left\\{I_{\\max}, I_{\\mathrm{volt}}(T,S), I_{\\mathrm{therm}}(T,S)\\right\\}$。\n   - 通过 $S \\leftarrow S + \\Delta t \\cdot I / Q$ 推进 $S$，并钳位到 $[0,1]$。\n   - 使用当前电流 $I$ 和计算出的 $R_{\\mathrm{int}}(T,S)$ 通过显式欧拉法推进 $T$。\n   - 推进 $t \\leftarrow t + \\Delta t$。\n3. 报告 $t$ 为在指定 $T_{\\max}$ 下的最小充电时间。\n\n由于控制总是选择在最大可行值，并且 SOC 动态相对于 $I$ 是单调的，这种贪心策略在给定的凸路径约束下与时间最优性是一致的。放宽热上限带来的充电时间改善量为\n$$\\Delta t_{\\mathrm{improve}} = t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{low}}) - t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{high}}),$$\n这是非负的，反映了由热限制施加的电流锥削的减少。\n\n该程序为所提供的四个案例实施此策略，为每个案例计算两个最小充电时间（分别对应 $T_{\\max}^{\\mathrm{low}}$ 和 $T_{\\max}^{\\mathrm{high}}$），并以单个方括号括起的逗号分隔列表形式输出以秒为单位、四舍五入到三位小数的改善值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef r_int(T, S, params):\n    # Internal resistance R_int(T,S) = R0 * [1 + a*(1 - S)] * [1 + b*(T_ref - T)/T_ref]\n    R0 = params['R0']\n    a = params['a']\n    b = params['b']\n    T_ref = params['T_ref']\n    return R0 * (1.0 + a * (1.0 - S)) * (1.0 + b * (T_ref - T) / T_ref)\n\ndef voc(S, params):\n    # Open-circuit voltage V_oc(S) = V_min + DeltaV * S^alpha\n    V_min = params['V_min']\n    dV = params['DeltaV']\n    alpha = params['alpha']\n    return V_min + dV * (S ** alpha)\n\ndef simulate_min_time(params, T_max, dt):\n    # Initialize state\n    S = params['S0']\n    T = params['T_amb']\n    t = 0.0\n\n    # Extract constants\n    Q = params['Q']\n    hA = params['hA']\n    C_th = params['C_th']\n    T_amb = params['T_amb']\n    I_max = params['I_max']\n    V_max = params['V_max']\n    S_target = params['S_target']\n\n    # Safety: cap max simulation time to avoid infinite loops in pathological cases\n    max_steps = int(1e7)  # ample cap; dt ensures practical termination\n\n    for _ in range(max_steps):\n        if S >= S_target:\n            break\n\n        R = r_int(T, S, params)\n        V_oc = voc(S, params)\n\n        # Voltage bound: I = (V_max - V_oc)/R, nonnegative\n        I_volt_cap = max(0.0, (V_max - V_oc) / R)\n\n        # Thermal bound via explicit Euler: ensure T_next = T_max\n        numerator = (C_th * (T_max - T) / dt) + hA * (T - T_amb)\n        if numerator = 0.0:\n            I_therm_cap = 0.0\n        else:\n            I_therm_cap = np.sqrt(numerator / R)\n\n        # Choose feasible current\n        I = min(I_max, I_volt_cap, I_therm_cap)\n\n        # Advance SOC and temperature\n        S = min(1.0, max(0.0, S + dt * I / Q))\n        T = T + (dt / C_th) * (-hA * (T - T_amb) + (I ** 2) * R)\n        t += dt\n\n    return t\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            'Q': 10800.0,\n            'R0': 0.05,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 1.2,\n            'C_th': 600.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 30.0,\n            'S0': 0.1,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 308.0,\n        },\n        # Case 2\n        {\n            'Q': 10800.0,\n            'R0': 0.05,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 1.2,\n            'C_th': 600.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 30.0,\n            'S0': 0.8,\n            'S_target': 0.95,\n            'dt': 0.25,\n            'Tmax_low': 301.0,\n            'Tmax_high': 305.0,\n        },\n        # Case 3\n        {\n            'Q': 10800.0,\n            'R0': 0.08,\n            'a': 0.6,\n            'b': 0.2,\n            'T_ref': 298.0,\n            'hA': 0.5,\n            'C_th': 400.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 20.0,\n            'S0': 0.2,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 306.0,\n        },\n        # Case 4\n        {\n            'Q': 10800.0,\n            'R0': 0.02,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 3.0,\n            'C_th': 800.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 8.0,\n            'S0': 0.1,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 308.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Compute minimal times for low and high thermal ceilings\n        t_low = simulate_min_time(case, case['Tmax_low'], case['dt'])\n        t_high = simulate_min_time(case, case['Tmax_high'], case['dt'])\n        improvement = max(0.0, t_low - t_high)  # nonnegative improvement\n        results.append(improvement)\n\n    # Format results to three decimal places without spaces\n    formatted = \"[\" + \",\".join(f\"{x:.3f}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        }
    ]
}