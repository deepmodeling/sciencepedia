{
    "hands_on_practices": [
        {
            "introduction": "Managing heat is a primary challenge in fast-charging battery systems. This first practice establishes the fundamental thermal limits of a lithium-ion cell by applying the first law of thermodynamics. You will calculate the maximum permissible constant charging current by balancing the internal heat generated from electrochemical processes against the heat dissipated to the environment, providing a critical baseline for any safe fast-charging protocol design .",
            "id": "3914033",
            "problem": "A single commercial cylindrical lithium-ion cell (nickel-manganese-cobalt chemistry) is to be fast charged at constant current in an environmental chamber with forced convection. The cell is modeled as a lumped thermal mass subject to convective cooling and internal heat generation from irreversible Joule heating and reversible entropic heat of reaction. The objective is to compute the maximum permissible constant charging current $I_{\\text{max}}$ such that the steady-state cell temperature $T$ remains strictly below a specified upper threshold $T_{\\text{max}}$.\n\nAssume the following scientifically realistic and self-consistent conditions and parameters:\n- The internal resistance is temperature-dependent and experimentally identified as $R(T) = R_{0} \\exp\\!\\left(-\\alpha \\left(T - T_{\\text{ref}}\\right)\\right)$, where $R_{0} = 0.018 \\ \\Omega$, $\\alpha = 0.004 \\ \\text{K}^{-1}$, and $T_{\\text{ref}} = 298.15 \\ \\text{K}$.\n- The reversible entropic coefficient (thermal coefficient of the open-circuit voltage) in the relevant State of Charge (SOC) window is approximately constant, $\\frac{\\partial U}{\\partial T} = -3.5 \\times 10^{-4} \\ \\text{V} \\ \\text{K}^{-1}$, representative of endothermic behavior during charge in an intermediate SOC range.\n- Convective heat transfer to ambient is characterized by a heat transfer coefficient $h = 15 \\ \\text{W} \\ \\text{m}^{-2} \\ \\text{K}^{-1}$ and an effective external area $A = 4.2 \\times 10^{-3} \\ \\text{m}^{2}$, yielding a net convective conductance $hA$.\n- The ambient temperature is $T_{\\text{amb}} = 298.15 \\ \\text{K}$.\n- The maximum allowable cell temperature under fast charge is $T_{\\text{max}} = 328.15 \\ \\text{K}$, corresponding to $55 ^{\\circ}\\text{C}$.\n- Neglect radiation and any conduction to fixtures, and assume spatially uniform cell temperature (lumped-capacitance approximation).\n- A Battery Management System (BMS) enforces an overcharge voltage cutoff, but in the considered SOC window there is sufficient voltage headroom so that the voltage limit is not activated prior to the thermal limit at $T_{\\text{max}}$.\n\nStarting from appropriate first principles, derive an expression for $I_{\\text{max}}$ that enforces the thermal steady-state constraint at $T = T_{\\text{max}}$, and then compute its numerical value using the given parameters. Round your final numerical answer for $I_{\\text{max}}$ to four significant figures. Express the final current in amperes (A).",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed. All givens are extracted and checked for consistency. The problem describes the thermal behavior of a lithium-ion cell under fast charging, using standard principles of heat transfer and electrochemistry. The parameters provided are physically realistic and all necessary information for a unique solution is present. The problem is therefore deemed valid.\n\nThe solution proceeds by establishing a thermal energy balance for the cell, modeled as a lumped-capacitance system. The governing ordinary differential equation for the cell's temperature $T$ as a function of time $t$ is:\n$$m c_p \\frac{dT}{dt} = \\dot{Q}_{\\text{gen}} - \\dot{Q}_{\\text{cool}}$$\nwhere $m c_p$ is the thermal capacitance of the cell, $\\dot{Q}_{\\text{gen}}$ is the rate of internal heat generation, and $\\dot{Q}_{\\text{cool}}$ is the rate of heat rejection to the environment.\n\nThe problem requires finding the maximum constant charging current $I_{\\text{max}}$ that results in a steady-state cell temperature equal to the maximum allowable temperature, $T_{\\text{max}}$. At steady state, the temperature is constant, thus $\\frac{dT}{dt} = 0$. The energy balance equation simplifies to:\n$$\\dot{Q}_{\\text{gen}} = \\dot{Q}_{\\text{cool}}$$\n\nThe total heat generation rate, $\\dot{Q}_{\\text{gen}}$, is the sum of irreversible Joule heating and reversible entropic heat:\n$$\\dot{Q}_{\\text{gen}} = I^2 R(T) + I T \\frac{\\partial U}{\\partial T}$$\nwhere $I$ is the charging current, $R(T)$ is the temperature-dependent internal resistance, and $\\frac{\\partial U}{\\partial T}$ is the entropic coefficient of the cell's open-circuit voltage $U$.\n\nThe heat rejection rate, $\\dot{Q}_{\\text{cool}}$, is due to convection to the ambient environment, as described by Newton's law of cooling:\n$$\\dot{Q}_{\\text{cool}} = hA(T - T_{\\text{amb}})$$\nwhere $h$ is the convective heat transfer coefficient, $A$ is the effective surface area of the cell, and $T_{\\text{amb}}$ is the ambient temperature.\n\nEquating the heat generation and rejection rates at steady state gives:\n$$I^2 R(T) + I T \\frac{\\partial U}{\\partial T} = hA(T - T_{\\text{amb}})$$\n\nThe internal resistance is given as a function of temperature:\n$$R(T) = R_{0} \\exp\\!\\left(-\\alpha (T - T_{\\text{ref}})\\right)$$\nSubstituting this into the energy balance equation yields:\n$$I^2 \\left(R_{0} \\exp\\!\\left(-\\alpha (T - T_{\\text{ref}})\\right)\\right) + I T \\frac{\\partial U}{\\partial T} - hA(T - T_{\\text{amb}}) = 0$$\n\nTo find the maximum permissible current $I_{\\text{max}}$, we enforce the condition that the steady-state temperature is exactly the maximum allowed temperature, $T = T_{\\text{max}}$. Substituting $T = T_{\\text{max}}$ and $I = I_{\\text{max}}$:\n$$I_{\\text{max}}^2 \\left(R_{0} \\exp\\!\\left(-\\alpha (T_{\\text{max}} - T_{\\text{ref}})\\right)\\right) + I_{\\text{max}} \\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right) - hA(T_{\\text{max}} - T_{\\text{amb}}) = 0$$\n\nThis is a quadratic equation for $I_{\\text{max}}$ of the form $a x^2 + b x + c = 0$, where $x = I_{\\text{max}}$. The coefficients are:\n$$a = R_{0} \\exp\\!\\left(-\\alpha (T_{\\text{max}} - T_{\\text{ref}})\\right)$$\n$$b = T_{\\text{max}} \\frac{\\partial U}{\\partial T}$$\n$$c = -hA(T_{\\text{max}} - T_{\\text{amb}})$$\n\nUsing the quadratic formula, $I_{\\text{max}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, we obtain:\n$$I_{\\text{max}} = \\frac{-T_{\\text{max}} \\frac{\\partial U}{\\partial T} \\pm \\sqrt{\\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right)^2 - 4\\left(R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)\\right)\\left(-hA(T_{\\text{max}} - T_{\\text{amb}})\\right)}}{2R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}$$\nSimplifying the expression under the square root:\n$$I_{\\text{max}} = \\frac{-T_{\\text{max}} \\frac{\\partial U}{\\partial T} \\pm \\sqrt{\\left(T_{\\text{max}} \\frac{\\partial U}{\\partial T}\\right)^2 + 4 hA (T_{\\text{max}} - T_{\\text{amb}}) R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}}{2R_{0} \\exp\\!\\left(-\\alpha(T_{\\text{max}} - T_{\\text{ref}})\\right)}$$\nSince the charging current $I_{\\text{max}}$ must be a positive physical quantity, we select the positive root.\n\nNow, we substitute the numerical values provided:\n- $R_{0} = 0.018 \\ \\Omega$\n- $\\alpha = 0.004 \\ \\text{K}^{-1}$\n- $T_{\\text{ref}} = 298.15 \\ \\text{K}$\n- $\\frac{\\partial U}{\\partial T} = -3.5 \\times 10^{-4} \\ \\text{V K}^{-1}$\n- $h = 15 \\ \\text{W m}^{-2} \\text{K}^{-1}$\n- $A = 4.2 \\times 10^{-3} \\ \\text{m}^{2}$\n- $T_{\\text{amb}} = 298.15 \\ \\text{K}$\n- $T_{\\text{max}} = 328.15 \\ \\text{K}$\n\nFirst, we calculate the values of the coefficients $a$, $b$, and $c$. The temperature differences are $T_{\\text{max}} - T_{\\text{ref}} = 30 \\ \\text{K}$ and $T_{\\text{max}} - T_{\\text{amb}} = 30 \\ \\text{K}$.\n\nCoefficient $a$: This is the resistance at $T_{\\text{max}}$.\n$$a = R(T_{\\text{max}}) = 0.018 \\times \\exp(-0.004 \\times 30) = 0.018 \\times \\exp(-0.12) \\approx 0.01596456 \\ \\Omega$$\n\nCoefficient $b$:\n$$b = 328.15 \\times (-3.5 \\times 10^{-4}) \\approx -0.114853 \\ \\text{V}$$\n\nCoefficient $c$:\n$$c = -(15 \\times 4.2 \\times 10^{-3}) \\times (328.15 - 298.15) = -0.063 \\times 30 = -1.89 \\ \\text{W}$$\n\nNow, we compute the components of the quadratic formula:\nThe discriminant $\\Delta = b^2 - 4ac$:\n$$\\Delta \\approx (-0.114853)^2 - 4(0.01596456)(-1.89) \\approx 0.013191 + 0.120693 = 0.133884$$\nThe square root of the discriminant:\n$$\\sqrt{\\Delta} \\approx \\sqrt{0.133884} \\approx 0.365899$$\nNow, we compute $I_{\\text{max}}$:\n$$I_{\\text{max}} = \\frac{-b + \\sqrt{b^2 - 4ac}}{2a} \\approx \\frac{-(-0.114853) + 0.365899}{2 \\times 0.01596456}$$\n$$I_{\\text{max}} \\approx \\frac{0.114853 + 0.365899}{0.03192912} = \\frac{0.480752}{0.03192912} \\approx 15.05684 \\ \\text{A}$$\n\nThe problem asks for the result to be rounded to four significant figures.\n$$I_{\\text{max}} \\approx 15.06 \\ \\text{A}$$",
            "answer": "$$\\boxed{15.06}$$"
        },
        {
            "introduction": "While thermal limits are crucial, preventing overcharge requires strict adherence to voltage constraints. This exercise moves from static thermal analysis to the dynamic challenge of voltage control, revealing how model inaccuracies can jeopardize safety. By analyzing the relationship between Open-Circuit Voltage ($\\text{OCV}$) and State of Charge ($\\text{SOC}$), you will discover how the steepness of the $\\text{OCV}$ curve amplifies small estimation errors into significant voltage deviations, a critical insight for designing robust battery management systems .",
            "id": "3914024",
            "problem": "You are given a constant-current fast-charging scenario for a single lithium-ion cell, whose terminal voltage is modeled as the sum of an open circuit voltage and an ohmic drop. The open circuit voltage is a function of State of Charge (SOC), and may be imperfectly modeled near high SOC. You will analyze the sensitivity of overcharge risk to the slope of the open circuit voltage curve and compute how small open circuit voltage modeling errors near high SOC amplify voltage constraint violations. All quantities follow the specified SI units, and all angle-related units are irrelevant. The fundamental base for this problem is the following set of widely accepted definitions and relations:\n- State of Charge (SOC) is the fraction of charge stored relative to nominal capacity, with $s \\in [0,1]$, and satisfies $dq/dt = -I$ and $s = q/Q$, where $q$ is charge in coulombs, $Q$ is nominal capacity in coulombs, and $I$ is the externally imposed signed current. For fast charging in this problem, $I \\ge 0$ and raises terminal voltage.\n- The steady-state terminal voltage during constant-current charging can be modeled as $V = \\text{OCV}(s) + I R$, where $R$ is the bulk ohmic resistance and $\\text{OCV}(s)$ is the open circuit voltage as a function of SOC. This neglects transient polarization; the focus is strictly on how open circuit voltage modeling errors and SOC estimation bias propagate to the voltage margin.\n\nAssume that the controller estimates SOC as $s_{\\mathrm{est}}$ and uses a modeled open circuit voltage function $\\widehat{\\text{OCV}}(s)$ that deviates from the true function $\\text{OCV}(s)$ near high SOC. Let the high-SOC modeling error be represented by a small constant underestimation $\\epsilon_0  0$ at $s_{\\mathrm{est}}$, so that $\\widehat{\\text{OCV}}(s_{\\mathrm{est}}) = \\text{OCV}(s_{\\mathrm{est}}) - \\epsilon_0$. Additionally, suppose the true SOC is biased by a small estimation error $\\Delta s$ so that $s_{\\mathrm{true}} = s_{\\mathrm{est}} + \\Delta s$, with $|\\Delta s| \\ll 1$. The controller enforces a maximum terminal voltage constraint $V_{\\max}$ (in $\\mathrm{V}$). The modeled voltage margin at the estimated SOC is\n$$\nM_{\\mathrm{pred}} = V_{\\max} - \\left(\\widehat{\\text{OCV}}(s_{\\mathrm{est}}) + I R\\right),\n$$\nand the true terminal voltage at that time is\n$$\nV_{\\mathrm{true}} = \\text{OCV}(s_{\\mathrm{true}}) + I R.\n$$\nDefine the exact open circuit voltage overshoot at the same time as\n$$\n\\Delta V_{\\mathrm{exact}} = \\left(\\text{OCV}(s_{\\mathrm{true}}) - \\widehat{\\text{OCV}}(s_{\\mathrm{est}})\\right),\n$$\nwhich is the quantity that directly challenges the voltage constraint in steady-state because the ohmic term $I R$ cancels when comparing $V_{\\mathrm{true}}$ to the modeled prediction at the same current.\n\nYour tasks:\n1. Starting from the above laws and definitions, derive a first-order Taylor expansion of $\\text{OCV}(s_{\\mathrm{true}})$ about $s_{\\mathrm{est}}$ to express a linearized overshoot $\\Delta V_{\\mathrm{lin}}$ in terms of the open circuit voltage slope and the small errors $\\epsilon_0$ and $\\Delta s$. Justify how the slope $\\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s_{\\mathrm{est}}}$ near high SOC acts as an amplification factor for small SOC errors.\n2. Design an algorithm that, for any given continuously differentiable open circuit voltage function and parameter values $(s_{\\mathrm{est}}, \\Delta s, \\epsilon_0, I, R, V_{\\max})$, computes:\n   - The slope $k = \\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s_{\\mathrm{est}}}$,\n   - The exact overshoot $\\Delta V_{\\mathrm{exact}}$ (in $\\mathrm{V}$),\n   - The linearized amplification ratio $A_{\\mathrm{lin}} = \\frac{\\Delta V_{\\mathrm{lin}}}{\\epsilon_0}$ (dimensionless),\n   - A boolean risk flag $\\text{risk}$ that is true if $\\Delta V_{\\mathrm{exact}}  M_{\\mathrm{pred}}$ and false otherwise.\n   In this setup, a true risk means that the exact overshoot exceeds the modeled margin at the same time and current, implying the true terminal voltage violates $V_{\\max}$ despite the model predicting a non-negative margin.\n3. Implement the algorithm as a complete, runnable program that evaluates the above four quantities over the following test suite of open circuit voltage functions and parameters. Express all voltages in $\\mathrm{V}$, all currents in $\\mathrm{A}$, resistances in $\\Omega$, and SOC as a dimensionless fraction. Angles are not used. The test suite is:\n   - Test 1 (general happy path, moderate slope near high SOC): $\\text{OCV}(s) = 3.0 + 1.1\\,s - 0.2\\,s^2 + 0.3\\,s^3$, $s_{\\mathrm{est}} = 0.95$, $\\Delta s = 0.008$, $\\epsilon_0 = 0.01\\,\\mathrm{V}$, $I = 3.0\\,\\mathrm{A}$, $R = 0.02\\,\\Omega$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n   - Test 2 (steep slope near high SOC, high-risk): $\\text{OCV}(s) = 3.0 + 1.2\\,s^3$, $s_{\\mathrm{est}} = 0.97$, $\\Delta s = 0.01$, $\\epsilon_0 = 0.015\\,\\mathrm{V}$, $I = 5.0\\,\\mathrm{A}$, $R = 0.02\\,\\Omega$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n   - Test 3 (boundary small margin case, linear OCV): $\\text{OCV}(s) = 3.0 + 1.2\\,s$, $s_{\\mathrm{est}} = 0.95$, $\\Delta s = 0.005$, $\\epsilon_0 = 0.005\\,\\mathrm{V}$, $I = 3.0\\,\\mathrm{A}$, $R = 0.02\\,\\Omega$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n   - Test 4 (lower slope near high SOC, safer): $\\text{OCV}(s) = 3.0 + 1.0\\,s + 0.2\\,s^2$, $s_{\\mathrm{est}} = 0.95$, $\\Delta s = 0.005$, $\\epsilon_0 = 0.01\\,\\mathrm{V}$, $I = 3.0\\,\\mathrm{A}$, $R = 0.02\\,\\Omega$, $V_{\\max} = 4.2\\,\\mathrm{V}$.\n4. Your program should produce a single line of output containing, in order for each test case, the open circuit voltage slope $k$ (float), the exact overshoot $\\Delta V_{\\mathrm{exact}}$ (float, in $\\mathrm{V}$), the linearized amplification ratio $A_{\\mathrm{lin}}$ (float, dimensionless), and the boolean risk flag $\\text{risk}$ (boolean). Aggregate all test cases into a single flat list printed as one comma-separated list enclosed in square brackets, for example $[k_1,\\Delta V_{\\mathrm{exact},1},A_{\\mathrm{lin},1},\\text{risk}_1,k_2,\\Delta V_{\\mathrm{exact},2},A_{\\mathrm{lin},2},\\text{risk}_2,\\dots]$.\n\nScientific realism requirements:\n- Treat $\\epsilon_0  0$ as a small underestimation of the open circuit voltage near $s_{\\mathrm{est}}$.\n- Ensure $s_{\\mathrm{true}} = \\min\\left(1,\\max\\left(0,s_{\\mathrm{est}} + \\Delta s\\right)\\right)$ to maintain valid SOC bounds.\n- Currents, resistances, and voltages must be within plausible ranges for a single lithium-ion cell during fast charge.",
            "solution": "The problem has been validated and is determined to be scientifically grounded, well-posed, and objective. It presents a formalizable and relevant scenario in battery management systems engineering. All necessary parameters and functions are provided, and the tasks are clearly defined.\n\n### 1. Derivation and Justification\n\nThe first task is to derive a linearized expression for the open circuit voltage (OCV) overshoot, $\\Delta V_{\\mathrm{lin}}$, and to justify the role of the OCV slope as an amplification factor for State of Charge (SOC) estimation errors.\n\nThe exact OCV overshoot is defined as:\n$$\n\\Delta V_{\\mathrm{exact}} = \\text{OCV}(s_{\\mathrm{true}}) - \\widehat{\\text{OCV}}(s_{\\mathrm{est}})\n$$\nWe are given that the modeled OCV, $\\widehat{\\text{OCV}}(s)$, contains a small constant underestimation error $\\epsilon_0  0$ at the estimated SOC, $s_{\\mathrm{est}}$:\n$$\n\\widehat{\\text{OCV}}(s_{\\mathrm{est}}) = \\text{OCV}(s_{\\mathrm{est}}) - \\epsilon_0\n$$\nSubstituting this into the expression for $\\Delta V_{\\mathrm{exact}}$ yields:\n$$\n\\Delta V_{\\mathrm{exact}} = \\text{OCV}(s_{\\mathrm{true}}) - (\\text{OCV}(s_{\\mathrm{est}}) - \\epsilon_0) = \\left( \\text{OCV}(s_{\\mathrm{true}}) - \\text{OCV}(s_{\\mathrm{est}}) \\right) + \\epsilon_0\n$$\nTo find the linearized overshoot, $\\Delta V_{\\mathrm{lin}}$, we linearize the term $\\text{OCV}(s_{\\mathrm{true}})$ by performing a first-order Taylor series expansion around $s_{\\mathrm{est}}$. The true SOC is given by $s_{\\mathrm{true}} = s_{\\mathrm{est}} + \\Delta s$, where $|\\Delta s| \\ll 1$. The expansion is:\n$$\n\\text{OCV}(s_{\\mathrm{true}}) \\approx \\text{OCV}(s_{\\mathrm{est}}) + \\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s_{\\mathrm{est}}} (s_{\\mathrm{true}} - s_{\\mathrm{est}})\n$$\nLet the slope of the OCV curve at the estimated SOC be denoted by $k$:\n$$\nk = \\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s_{\\mathrm{est}}}\n$$\nSubstituting $k$ and $s_{\\mathrm{true}} - s_{\\mathrm{est}} = \\Delta s$ into the expansion gives:\n$$\n\\text{OCV}(s_{\\mathrm{true}}) \\approx \\text{OCV}(s_{\\mathrm{est}}) + k \\, \\Delta s\n$$\nNow, we substitute this linearized approximation of $\\text{OCV}(s_{\\mathrm{true}})$ back into the expression for $\\Delta V_{\\mathrm{exact}}$ to obtain $\\Delta V_{\\mathrm{lin}}$:\n$$\n\\Delta V_{\\mathrm{lin}} = \\left( (\\text{OCV}(s_{\\mathrm{est}}) + k \\, \\Delta s) - \\text{OCV}(s_{\\mathrm{est}}) \\right) + \\epsilon_0\n$$\nSimplifying this expression yields the final linearized voltage overshoot:\n$$\n\\Delta V_{\\mathrm{lin}} = k \\, \\Delta s + \\epsilon_0\n$$\nThis result shows that the total linearized overshoot is the sum of two components: the OCV model bias $\\epsilon_0$ and the term $k \\, \\Delta s$. The term $k \\, \\Delta s$ represents the voltage error that arises directly from the SOC estimation error $\\Delta s$. The slope $k = \\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s_{\\mathrm{est}}}$ acts as a gain or **amplification factor**. It translates a small error in the SOC domain, $\\Delta s$, into a potentially much larger error in the voltage domain, $k \\, \\Delta s$. For lithium-ion cells, the OCV curve often becomes very steep as the SOC approaches $1$. A high value of $k$ in this region means that even a minuscule error in coulomb counting or SOC estimation can lead to a significant, unpredicted voltage rise, creating a substantial risk of exceeding the maximum voltage limit $V_{\\max}$ and causing overcharge, which can lead to cell degradation and safety hazards.\n\n### 2. Algorithmic Design\n\nThe second task is to design an algorithm to compute four key quantities for a given set of parameters $(s_{\\mathrm{est}}, \\Delta s, \\epsilon_0, I, R, V_{\\max})$ and a continuously differentiable OCV function, $\\text{OCV}(s)$.\n\nThe algorithm proceeds as follows:\n1.  **Define Inputs**: Receive the OCV function $\\text{OCV}(s)$, its derivative $\\frac{d\\,\\text{OCV}}{ds}$, and the scalar parameters $s_{\\mathrm{est}}$, $\\Delta s$, $\\epsilon_0$, $I$, $R$, and $V_{\\max}$.\n2.  **Calculate True SOC**: Compute the true SOC, ensuring it remains within the valid range $[0, 1]$.\n    $$\n    s_{\\mathrm{true}} = \\min(1, \\max(0, s_{\\mathrm{est}} + \\Delta s))\n    $$\n3.  **Compute OCV Slope ($k$)**: Evaluate the derivative of the OCV function at the estimated SOC, $s_{\\mathrm{est}}$.\n    $$\n    k = \\left.\\frac{d\\,\\text{OCV}}{ds}\\right|_{s=s_{\\mathrm{est}}}\n    $$\n4.  **Compute Exact Overshoot ($\\Delta V_{\\mathrm{exact}}$)**:\n    a. Evaluate the true OCV at $s_{\\mathrm{est}}$: $V_{\\text{OCV, est}} = \\text{OCV}(s_{\\mathrm{est}})$.\n    b. Determine the modeled OCV at $s_{\\mathrm{est}}$: $\\widehat{V}_{\\text{OCV, est}} = V_{\\text{OCV, est}} - \\epsilon_0$.\n    c. Evaluate the true OCV at $s_{\\mathrm{true}}$: $V_{\\text{OCV, true}} = \\text{OCV}(s_{\\mathrm{true}})$.\n    d. Compute the exact overshoot: $\\Delta V_{\\mathrm{exact}} = V_{\\text{OCV, true}} - \\widehat{V}_{\\text{OCV, est}}$.\n5.  **Compute Linearized Amplification Ratio ($A_{\\mathrm{lin}}$)**:\n    a. Use the derived formula for the linearized overshoot: $\\Delta V_{\\mathrm{lin}} = k \\, \\Delta s + \\epsilon_0$.\n    b. Compute the ratio: $A_{\\mathrm{lin}} = \\frac{\\Delta V_{\\mathrm{lin}}}{\\epsilon_0} = 1 + \\frac{k \\, \\Delta s}{\\epsilon_0}$.\n6.  **Compute Risk Flag ($\\text{risk}$)**:\n    a. First, calculate the predicted voltage margin, $M_{\\mathrm{pred}}$, which is the buffer the controller believes it has before hitting the voltage limit.\n    $$\n    M_{\\mathrm{pred}} = V_{\\max} - \\left(\\widehat{\\text{OCV}}(s_{\\mathrm{est}}) + I R\\right)\n    $$\n    b. The system is at risk if the actual voltage overshoot exceeds this predicted margin. The condition for risk is therefore:\n    $$\n    \\text{risk} = (\\Delta V_{\\mathrm{exact}}  M_{\\mathrm{pred}})\n    $$\n7.  **Output**: Return the calculated values $(k, \\Delta V_{\\mathrm{exact}}, A_{\\mathrm{lin}}, \\text{risk})$.\n\nThis algorithm will be implemented in the provided Python code to process the specified test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the battery overcharge risk analysis problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case includes OCV and its derivative as lambda functions, and all parameters.\n    test_cases = [\n        {\n            \"name\": \"Test 1 (General)\",\n            \"ocv_func\": lambda s: 3.0 + 1.1*s - 0.2*s**2 + 0.3*s**3,\n            \"ocv_deriv_func\": lambda s: 1.1 - 0.4*s + 0.9*s**2,\n            \"s_est\": 0.95, \"delta_s\": 0.008, \"epsilon_0\": 0.01,\n            \"I\": 3.0, \"R\": 0.02, \"V_max\": 4.2\n        },\n        {\n            \"name\": \"Test 2 (Steep Slope)\",\n            \"ocv_func\": lambda s: 3.0 + 1.2*s**3,\n            \"ocv_deriv_func\": lambda s: 3.6*s**2,\n            \"s_est\": 0.97, \"delta_s\": 0.01, \"epsilon_0\": 0.015,\n            \"I\": 5.0, \"R\": 0.02, \"V_max\": 4.2\n        },\n        {\n            \"name\": \"Test 3 (Linear OCV)\",\n            \"ocv_func\": lambda s: 3.0 + 1.2*s,\n            \"ocv_deriv_func\": lambda s: 1.2,\n            \"s_est\": 0.95, \"delta_s\": 0.005, \"epsilon_0\": 0.005,\n            \"I\": 3.0, \"R\": 0.02, \"V_max\": 4.2\n        },\n        {\n            \"name\": \"Test 4 (Lower Slope)\",\n            \"ocv_func\": lambda s: 3.0 + 1.0*s + 0.2*s**2,\n            \"ocv_deriv_func\": lambda s: 1.0 + 0.4*s,\n            \"s_est\": 0.95, \"delta_s\": 0.005, \"epsilon_0\": 0.01,\n            \"I\": 3.0, \"R\": 0.02, \"V_max\": 4.2\n        },\n    ]\n\n    results_flat_list = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        ocv = case[\"ocv_func\"]\n        ocv_deriv = case[\"ocv_deriv_func\"]\n        s_est = case[\"s_est\"]\n        delta_s = case[\"delta_s\"]\n        epsilon_0 = case[\"epsilon_0\"]\n        I = case[\"I\"]\n        R = case[\"R\"]\n        V_max = case[\"V_max\"]\n\n        # Ensure s_true is within the valid [0, 1] range\n        s_true = min(1.0, max(0.0, s_est + delta_s))\n\n        # 1. Compute the OCV slope k\n        k = ocv_deriv(s_est)\n\n        # 2. Compute the exact overshoot dV_exact\n        ocv_at_s_est = ocv(s_est)\n        ocv_hat_at_s_est = ocv_at_s_est - epsilon_0\n        ocv_at_s_true = ocv(s_true)\n        delta_v_exact = ocv_at_s_true - ocv_hat_at_s_est\n\n        # 3. Compute the linearized amplification ratio A_lin\n        # delta_v_lin = k * delta_s + epsilon_0\n        # a_lin = delta_v_lin / epsilon_0\n        a_lin = 1.0 + (k * delta_s) / epsilon_0\n\n        # 4. Compute the boolean risk flag\n        # First, calculate the predicted voltage margin M_pred\n        m_pred = V_max - (ocv_hat_at_s_est + I * R)\n        risk = delta_v_exact > m_pred\n        \n        # Append the four required results to the list\n        results_flat_list.extend([k, delta_v_exact, a_lin, str(risk).lower()])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results_flat_list))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice synthesizes the concepts of thermal and voltage limits into a holistic, dynamic optimization problem. Here, you will develop a simulation to implement a time-optimal charging algorithm that pushes the battery to its safety boundaries at every moment. By quantifying the trade-off between charging speed and thermal stress, you will gain practical experience in designing intelligent charging protocols that balance performance and safety, a core task in automated battery engineering .",
            "id": "3913997",
            "problem": "You are tasked with constructing a complete, runnable program that determines the reduction in charge time that results from permitting a mild rise in temperature during fast charging of a single lithium-ion cell, using a lumped electro-thermal model and explicit enforcement of safety constraints against overcharge and overdischarge. The program must compute the time-optimal charging current profile by selecting a charging current as high as allowed by the constraints at each time step, and must quantify the improvement in charge time between a stricter thermal constraint and a looser thermal constraint. All dynamics and constraints are to be expressed in a lumped form suitable for numerical time-stepping.\n\nStart from the following fundamental base:\n\n- The First Law of Thermodynamics applied as lumped energy balance for temperature:\n  $$C_{\\mathrm{th}} \\frac{dT}{dt} = -hA \\left(T - T_{\\mathrm{amb}}\\right) + I^2 R_{\\mathrm{int}}(T,S),$$\n  where $C_{\\mathrm{th}}$ is the thermal capacitance in Joules per Kelvin, $hA$ is the combined heat transfer coefficient in Watts per Kelvin, $T$ is the cell temperature in Kelvin, $T_{\\mathrm{amb}}$ is the ambient temperature in Kelvin, $I$ is the charge current in Amperes, and $R_{\\mathrm{int}}(T,S)$ is the internal resistance in Ohms modeled as a function of temperature $T$ and State of Charge (SOC) $S$.\n\n- Conservation of charge for SOC:\n  $$\\frac{dS}{dt} = \\frac{I}{Q},$$\n  where $Q$ is the cell capacity in Coulombs, $S \\in [0,1]$.\n\n- Terminal voltage composition:\n  $$V = V_{\\mathrm{oc}}(S) + I \\, R_{\\mathrm{int}}(T,S),$$\n  where $V_{\\mathrm{oc}}(S)$ is the Open-Circuit Voltage (OCV) as a function of SOC.\n\nThe charging control $I(t)$ must satisfy the following constraints at all times $t$:\n\n- Thermal safety: $$T(t) \\leq T_{\\max},$$ where $T_{\\max}$ is the allowable peak temperature in Kelvin.\n- Voltage safety (to prevent overcharge): $$V(t) \\leq V_{\\max},$$ where $V_{\\max}$ is the maximum allowable terminal voltage in Volts.\n- Current bound (fast charging hardware limit): $$0 \\leq I(t) \\leq I_{\\max},$$ with $I_{\\max}$ in Amperes.\n- SOC safety (to prevent overcharge and overdischarge): $$0 \\leq S(t) \\leq 1.$$\n\nAssume:\n- Neglect reversible entropic heating and side reactions.\n- Use fixed-step explicit Euler time discretization with time step $\\Delta t$ seconds for both thermal and SOC dynamics.\n- Use the following parametric forms for internal resistance and open-circuit voltage, which are scientifically plausible and smooth:\n  $$R_{\\mathrm{int}}(T,S) = R_0 \\left[1 + a \\left(1 - S\\right)\\right] \\left[1 + b \\frac{T_{\\mathrm{ref}} - T}{T_{\\mathrm{ref}}}\\right],$$\n  $$V_{\\mathrm{oc}}(S) = V_{\\min} + \\Delta V \\, S^{\\alpha},$$\n  where $R_0  0$, $a \\geq 0$, $b \\geq 0$, $T_{\\mathrm{ref}}$ (Kelvin), $V_{\\min}$ (Volts), $\\Delta V$ (Volts), and $\\alpha  0$ are constants.\n\nObjective and numerical procedure:\n- The objective is to minimize the time to reach a target SOC $S_{\\mathrm{target}}$ from an initial SOC $S_0$ under the constraints listed above. At each time step, choose $I$ as large as permitted by all constraints so that the next-step states remain feasible under explicit Euler advancement.\n- For thermal feasibility, enforce that the next-step temperature $T_{k+1}$ obtained by explicit Euler with step $\\Delta t$ does not exceed $T_{\\max}$; for voltage feasibility, enforce that the instantaneous terminal voltage does not exceed $V_{\\max}$; for SOC, enforce $S \\in [0,1]$.\n- The charging is complete when the SOC first satisfies $S \\geq S_{\\mathrm{target}}$.\n\nYour program must compute, for each test case in the test suite below, the minimal charge time in seconds under two thermal ceilings: a stricter ceiling $T_{\\max}^{\\mathrm{low}}$ and a mildly relaxed ceiling $T_{\\max}^{\\mathrm{high}}$. Report the improvement in seconds, defined as the difference between the stricter and the relaxed minimal charge times:\n$$\\Delta t_{\\mathrm{improve}} = t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{low}}) - t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{high}}).$$\n\nExpress all outputs in seconds as floats, rounded to three decimal places. Angles do not appear. No percentages are required.\n\nTest suite:\nFor each case, parameters are given as a tuple. All numbers are in their natural SI units unless otherwise stated; capacity is in Coulombs, temperatures in Kelvin, voltages in Volts, currents in Amperes.\n\n- Case $1$ (general fast-charge, mixed constraints):\n  $$Q = 10800,\\ R_0 = 0.05,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 1.2,\\ C_{\\mathrm{th}} = 600,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 30.0,\\ S_0 = 0.1,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 308.$$\n\n- Case $2$ (voltage-limited near end of charge):\n  $$Q = 10800,\\ R_0 = 0.05,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 1.2,\\ C_{\\mathrm{th}} = 600,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 30.0,\\ S_0 = 0.8,\\ S_{\\mathrm{target}} = 0.95,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 301,\\ T_{\\max}^{\\mathrm{high}} = 305.$$\n\n- Case $3$ (thermal bottleneck, mild relaxation yields larger gain):\n  $$Q = 10800,\\ R_0 = 0.08,\\ a = 0.6,\\ b = 0.2,\\ T_{\\mathrm{ref}} = 298,\\ hA = 0.5,\\ C_{\\mathrm{th}} = 400,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 20.0,\\ S_0 = 0.2,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 306.$$\n\n- Case $4$ (current-limited hardware, thermal relaxation has negligible effect):\n  $$Q = 10800,\\ R_0 = 0.02,\\ a = 0.5,\\ b = 0.1,\\ T_{\\mathrm{ref}} = 298,\\ hA = 3.0,\\ C_{\\mathrm{th}} = 800,$$\n  $$T_{\\mathrm{amb}} = 298,\\ V_{\\min} = 3.0,\\ \\Delta V = 1.1,\\ \\alpha = 0.6,\\ V_{\\max} = 4.2,$$\n  $$I_{\\max} = 8.0,\\ S_0 = 0.1,\\ S_{\\mathrm{target}} = 0.9,\\ \\Delta t = 0.25,$$\n  $$T_{\\max}^{\\mathrm{low}} = 303,\\ T_{\\max}^{\\mathrm{high}} = 308.$$\n\nFinal output format:\nYour program should produce a single line of output containing the improvements for the four cases as a comma-separated list enclosed in square brackets, for example:\n$$[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4],$$\nwhere each $\\Delta t_i$ is a float in seconds rounded to three decimal places, with no additional spaces or text.",
            "solution": "We derive the time-optimal charging policy within the lumped electro-thermal model from first principles. The State of Charge (SOC) $S$ increases monotonically with the applied current $I$ according to $\\frac{dS}{dt} = \\frac{I}{Q}$, where $Q  0$ is fixed. The temperature evolution under the First Law energy balance is\n$$C_{\\mathrm{th}} \\frac{dT}{dt} = -hA \\left(T - T_{\\mathrm{amb}}\\right) + I^2 R_{\\mathrm{int}}(T,S),$$\nwhere the Joule heating term $I^2 R_{\\mathrm{int}}(T,S)$ is nonnegative for $I \\ge 0$ and $R_{\\mathrm{int}}(T,S)  0$.\n\nThe terminal voltage is modeled as\n$$V(t) = V_{\\mathrm{oc}}(S(t)) + I(t) R_{\\mathrm{int}}(T(t),S(t)),$$\nwith the Open-Circuit Voltage (OCV) $V_{\\mathrm{oc}}(S)$ and the internal resistance $R_{\\mathrm{int}}(T,S)$ given by\n$$V_{\\mathrm{oc}}(S) = V_{\\min} + \\Delta V \\, S^{\\alpha}, \\quad R_{\\mathrm{int}}(T,S) = R_0 \\left[1 + a \\left(1 - S\\right)\\right] \\left[1 + b \\frac{T_{\\mathrm{ref}} - T}{T_{\\mathrm{ref}}}\\right],$$\nwhere the parameters satisfy $R_0  0$, $a \\ge 0$, $b \\ge 0$, $T_{\\mathrm{ref}}  0$, $\\Delta V  0$, and $\\alpha  0$. These forms ensure $R_{\\mathrm{int}}(T,S)  0$ and a physically reasonable increase of $V_{\\mathrm{oc}}(S)$ with $S$.\n\nWe seek to minimize the charging time to reach $S_{\\mathrm{target}}$ from $S_0$ subject to the path constraints\n$$0 \\le I(t) \\le I_{\\max}, \\quad V(t) \\le V_{\\max}, \\quad T(t) \\le T_{\\max}, \\quad 0 \\le S(t) \\le 1.$$\n\nPrinciple-based argument for the optimal policy: The cost functional is the total time, $J = \\int_0^{t_f} 1 \\, dt$, where $t_f$ is the first time $S(t_f) \\ge S_{\\mathrm{target}}$. The SOC dynamics are strictly increasing in $I$ for $I \\ge 0$, and all constraints define an upper bound on $I(t)$ at each point in state space. By the Pontryagin Maximum Principle, for a time-minimization problem with control entering linearly in the dynamics and pathwise admissible set defined by inequality constraints, the optimal control is of bang-bang type: at each time, the control $I(t)$ should be selected at the highest value that maintains feasibility. In our setting, this translates to setting\n$$I(t) = \\min\\left\\{I_{\\max},\\ I_{\\mathrm{volt}}(T,S),\\ I_{\\mathrm{therm}}(T,S)\\right\\},$$\nwhere $I_{\\mathrm{volt}}(T,S)$ is the largest current consistent with the voltage constraint $V \\le V_{\\max}$ and $I_{\\mathrm{therm}}(T,S)$ is the largest current that preserves $T \\le T_{\\max}$ under the chosen discretization.\n\nVoltage feasibility bound: From $V = V_{\\mathrm{oc}}(S) + I R_{\\mathrm{int}}(T,S) \\le V_{\\max}$ and $R_{\\mathrm{int}}(T,S)  0$, the instantaneous bound is\n$$I_{\\mathrm{volt}}(T,S) = \\max\\left\\{0,\\ \\frac{V_{\\max} - V_{\\mathrm{oc}}(S)}{R_{\\mathrm{int}}(T,S)}\\right\\}.$$\n\nThermal feasibility bound under explicit Euler: With a time step of $\\Delta t$, the explicit Euler update is\n$$T_{k+1} = T_k + \\frac{\\Delta t}{C_{\\mathrm{th}}} \\left[-hA \\left(T_k - T_{\\mathrm{amb}}\\right) + I_k^2 R_{\\mathrm{int}}(T_k,S_k)\\right].$$\nTo enforce $T_{k+1} \\le T_{\\max}$, we require\n$$I_k^2 R_{\\mathrm{int}}(T_k,S_k) \\le \\frac{C_{\\mathrm{th}}}{\\Delta t} \\left(T_{\\max} - T_k\\right) + hA \\left(T_k - T_{\\mathrm{amb}}\\right).$$\nThus, for the given step,\n$$I_{\\mathrm{therm}}(T_k,S_k) = \\begin{cases}\n\\sqrt{\\dfrac{\\dfrac{C_{\\mathrm{th}}}{\\Delta t} \\left(T_{\\max} - T_k\\right) + hA \\left(T_k - T_{\\mathrm{amb}}\\right)}{R_{\\mathrm{int}}(T_k,S_k)}}  \\text{if the numerator is nonnegative},\\\\\n0  \\text{otherwise}.\n\\end{cases}$$\nThis bound ensures the next-step temperature does not exceed the ceiling.\n\nSOC feasibility is preserved by clamping $S$ to $[0,1]$ and stopping when $S \\ge S_{\\mathrm{target}}$. Overdischarge is avoided by starting with $S_0 \\ge 0$ and enforcing $I \\ge 0$.\n\nAlgorithmic procedure per test case:\n\n1. Initialize $S \\leftarrow S_0$, $T \\leftarrow T_{\\mathrm{amb}}$, and $t \\leftarrow 0$.\n2. While $S  S_{\\mathrm{target}}$:\n   - Compute $R_{\\mathrm{int}}(T,S)$ and $V_{\\mathrm{oc}}(S)$.\n   - Compute $I_{\\mathrm{volt}}(T,S)$ from $V \\le V_{\\max}$.\n   - Compute $I_{\\mathrm{therm}}(T,S)$ from $T_{k+1} \\le T_{\\max}$.\n   - Set $I \\leftarrow \\min\\left\\{I_{\\max}, I_{\\mathrm{volt}}(T,S), I_{\\mathrm{therm}}(T,S)\\right\\}$.\n   - Advance $S$ via $S \\leftarrow S + \\Delta t \\cdot I / Q$, clamp to $[0,1]$.\n   - Advance $T$ via explicit Euler using the current $I$ and the computed $R_{\\mathrm{int}}(T,S)$.\n   - Advance $t \\leftarrow t + \\Delta t$.\n3. Report $t$ as the minimal charge time under the specified $T_{\\max}$.\n\nBecause the control is always selected at the largest feasible value and the SOC dynamics are monotone with respect to $I$, this greedy policy is consistent with time-optimality under the given convex path constraints. The improvement in charge time by relaxing the thermal ceiling is then\n$$\\Delta t_{\\mathrm{improve}} = t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{low}}) - t_{\\mathrm{min}}(T_{\\max}^{\\mathrm{high}}),$$\nwhich is nonnegative and reflects the reduction in tapering imposed by thermal limits.\n\nThe program implements this policy for the four cases provided, computes two minimal charge times per case (for $T_{\\max}^{\\mathrm{low}}$ and $T_{\\max}^{\\mathrm{high}}$), and outputs the improvements in seconds rounded to three decimal places as a single bracketed, comma-separated list.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef r_int(T, S, params):\n    # Internal resistance R_int(T,S) = R0 * [1 + a*(1 - S)] * [1 + b*(T_ref - T)/T_ref]\n    R0 = params['R0']\n    a = params['a']\n    b = params['b']\n    T_ref = params['T_ref']\n    return R0 * (1.0 + a * (1.0 - S)) * (1.0 + b * (T_ref - T) / T_ref)\n\ndef voc(S, params):\n    # Open-circuit voltage V_oc(S) = V_min + DeltaV * S^alpha\n    V_min = params['V_min']\n    dV = params['DeltaV']\n    alpha = params['alpha']\n    return V_min + dV * (S ** alpha)\n\ndef simulate_min_time(params, T_max, dt):\n    # Initialize state\n    S = params['S0']\n    T = params['T_amb']\n    t = 0.0\n\n    # Extract constants\n    Q = params['Q']\n    hA = params['hA']\n    C_th = params['C_th']\n    T_amb = params['T_amb']\n    I_max = params['I_max']\n    V_max = params['V_max']\n    S_target = params['S_target']\n\n    # Safety: cap max simulation time to avoid infinite loops in pathological cases\n    max_steps = int(1e7)  # ample cap; dt ensures practical termination\n\n    for _ in range(max_steps):\n        if S = S_target:\n            break\n\n        R = r_int(T, S, params)\n        V_oc = voc(S, params)\n\n        # Voltage bound: I = (V_max - V_oc)/R, nonnegative\n        I_volt_cap = max(0.0, (V_max - V_oc) / R)\n\n        # Thermal bound via explicit Euler: ensure T_next = T_max\n        numerator = (C_th * (T_max - T) / dt) + hA * (T - T_amb)\n        if numerator = 0.0:\n            I_therm_cap = 0.0\n        else:\n            I_therm_cap = np.sqrt(numerator / R)\n\n        # Choose feasible current\n        I = min(I_max, I_volt_cap, I_therm_cap)\n\n        # Advance SOC and temperature\n        S = min(1.0, max(0.0, S + dt * I / Q))\n        T = T + (dt / C_th) * (-hA * (T - T_amb) + (I ** 2) * R)\n        t += dt\n\n    return t\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            'Q': 10800.0,\n            'R0': 0.05,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 1.2,\n            'C_th': 600.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 30.0,\n            'S0': 0.1,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 308.0,\n        },\n        # Case 2\n        {\n            'Q': 10800.0,\n            'R0': 0.05,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 1.2,\n            'C_th': 600.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 30.0,\n            'S0': 0.8,\n            'S_target': 0.95,\n            'dt': 0.25,\n            'Tmax_low': 301.0,\n            'Tmax_high': 305.0,\n        },\n        # Case 3\n        {\n            'Q': 10800.0,\n            'R0': 0.08,\n            'a': 0.6,\n            'b': 0.2,\n            'T_ref': 298.0,\n            'hA': 0.5,\n            'C_th': 400.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 20.0,\n            'S0': 0.2,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 306.0,\n        },\n        # Case 4\n        {\n            'Q': 10800.0,\n            'R0': 0.02,\n            'a': 0.5,\n            'b': 0.1,\n            'T_ref': 298.0,\n            'hA': 3.0,\n            'C_th': 800.0,\n            'T_amb': 298.0,\n            'V_min': 3.0,\n            'DeltaV': 1.1,\n            'alpha': 0.6,\n            'V_max': 4.2,\n            'I_max': 8.0,\n            'S0': 0.1,\n            'S_target': 0.9,\n            'dt': 0.25,\n            'Tmax_low': 303.0,\n            'Tmax_high': 308.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Compute minimal times for low and high thermal ceilings\n        t_low = simulate_min_time(case, case['Tmax_low'], case['dt'])\n        t_high = simulate_min_time(case, case['Tmax_high'], case['dt'])\n        improvement = max(0.0, t_low - t_high)  # nonnegative improvement\n        results.append(improvement)\n\n    # Format results to three decimal places without spaces\n    formatted = \"[\" + \",\".join(f\"{x:.3f}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        }
    ]
}