{
    "hands_on_practices": [
        {
            "introduction": "这项练习提供了脉冲时间依赖可塑性（STDP）的一个基础计算。通过应用标准的“脉冲对”STDP模型，你将为一个特定的因果脉冲配对（突触前脉冲先于突触后脉冲）计算突触权重的变化，这一过程将导致长时程增强（LTP）。掌握这种指数学习窗口的直接应用，是理解和建模神经回路如何学习的关键第一步。",
            "id": "4059871",
            "problem": "在一个基于脉冲配对的脉冲时间依赖性可塑性（STDP）模型中，由时间 $t_{\\text{pre}}$ 的单个突触前脉冲和时间 $t_{\\text{post}}$ 的单个突触后脉冲引起的突触修饰，由一个捕获长时程增强（LTP）的因果学习窗口（对于 $\\Delta t \\equiv t_{\\text{post}} - t_{\\text{pre}} > 0$）和一个捕获长时程抑制（LTD）的反因果学习窗口（对于 $\\Delta t  0$）所控制。假设一个生物物理第一性原理基础，其中每个学习窗口由一个具有特征衰减的一阶突触轨迹生成：对于 $\\Delta t>0$ 的因果窗口 $W_{+}(\\Delta t)$ 满足一阶线性常微分方程 $\\frac{dW_{+}}{d\\Delta t}=-\\frac{1}{\\tau_{+}}W_{+}$，初始条件为 $W_{+}(0^{+})=A_{+}$；对于 $\\Delta t0$ 的反因果窗口 $W_{-}(\\Delta t)$ 是通过考虑一个衰减轨迹的经过时间 $s\\equiv -\\Delta t > 0$ 得到的，该轨迹满足 $\\frac{dW_{-}}{ds}=-\\frac{1}{\\tau_{-}}W_{-}$，初始条件为 $W_{-}(0^{-})=-A_{-}$。对于给定的脉冲对，净突触变化 $\\Delta w$ 是在相应 $\\Delta t$ 处计算的适当窗口 $W_{+}$ 或 $W_{-}$ 的值。\n\n使用此框架，计算在给定 $A_{+}=0.01$、$\\tau_{+}=20\\ \\text{ms}$、$A_{-}=0.012$ 和 $\\tau_{-}=20\\ \\text{ms}$ 的情况下，由 $t_{\\text{pre}}=10\\ \\text{ms}$ 的突触前脉冲和 $t_{\\text{post}}=14\\ \\text{ms}$ 的突触后脉冲引起的净突触权重变化。将净突触变化报告为一个无量纲数，四舍五入到四位有效数字。",
            "solution": "经评估，该问题陈述有效。它科学地基于脉冲时间依赖性可塑性（STDP）建模的既定原则，特别是使用了一个带有指数学习窗口的常见基于配对的模型。该问题定义明确、客观，并提供了一套完整且一致的数据和定义，包括控制微分方程、初始条件以及所有必要的参数值。因此，可以推导出一个唯一且有意义的解。\n\n任务是计算给定一对突触前和突触后脉冲的净突触权重变化 $\\Delta w$。该变化由时间差 $\\Delta t \\equiv t_{\\text{post}} - t_{\\text{pre}}$ 决定，其中 $t_{\\text{pre}}$ 是突触前脉冲时间，$t_{\\text{post}}$ 是突触后脉冲时间。\n\n首先，我们使用给定的脉冲时间计算时间差 $\\Delta t$：\n$t_{\\text{pre}} = 10\\ \\text{ms}$\n$t_{\\text{post}} = 14\\ \\text{ms}$\n\n$$\n\\Delta t = t_{\\text{post}} - t_{\\text{pre}} = 14\\ \\text{ms} - 10\\ \\text{ms} = 4\\ \\text{ms}\n$$\n\n由于 $\\Delta t = 4\\ \\text{ms}$ 大于 $0$，突触修饰由长时程增强（LTP）的因果学习窗口 $W_{+}(\\Delta t)$ 控制。问题陈述此窗口函数是以下一阶线性常微分方程（对于 $\\Delta t > 0$）的解：\n$$\n\\frac{dW_{+}}{d\\Delta t} = -\\frac{1}{\\tau_{+}}W_{+}\n$$\n初始条件为 $W_{+}(0^{+}) = A_{+}$。\n\n这是一个标准的可分离变量微分方程。我们可以将其重新排列为：\n$$\n\\frac{dW_{+}}{W_{+}} = -\\frac{1}{\\tau_{+}} d\\Delta t\n$$\n两边积分得到：\n$$\n\\int \\frac{1}{W_{+}} dW_{+} = \\int -\\frac{1}{\\tau_{+}} d\\Delta t\n$$\n$$\n\\ln|W_{+}| = -\\frac{\\Delta t}{\\tau_{+}} + C\n$$\n其中 $C$ 是积分常数。对两边取指数得到：\n$$\n|W_{+}| = \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}} + C\\right) = \\exp(C) \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)\n$$\n设一个新常数 $K = \\pm \\exp(C)$。通解为：\n$$\nW_{+}(\\Delta t) = K \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)\n$$\n我们使用初始条件 $W_{+}(0^{+}) = A_{+}$ 来确定常数 $K$。在 $\\Delta t \\to 0^{+}$ 的极限下：\n$$\nW_{+}(0^{+}) = K \\exp(0) = K\n$$\n因此，$K = A_{+}$。因果学习窗口的特解是：\n$$\nW_{+}(\\Delta t) = A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right) \\quad \\text{for } \\Delta t > 0\n$$\n\n净突触变化 $\\Delta w$ 是此函数在 $\\Delta t = 4\\ \\text{ms}$ 处的值。给定的参数是 $A_{+} = 0.01$ 和 $\\tau_{+} = 20\\ \\text{ms}$。\n将这些值代入方程中：\n$$\n\\Delta w = W_{+}(4\\ \\text{ms}) = 0.01 \\exp\\left(-\\frac{4\\ \\text{ms}}{20\\ \\text{ms}}\\right)\n$$\n指数中的毫秒单位相互抵消，得到一个无量纲的参数，符合要求：\n$$\n\\Delta w = 0.01 \\exp\\left(-\\frac{4}{20}\\right) = 0.01 \\exp(-0.2)\n$$\n现在，我们计算数值：\n$$\n\\exp(-0.2) \\approx 0.818730753\n$$\n$$\n\\Delta w \\approx 0.01 \\times 0.818730753 = 0.00818730753\n$$\n问题要求最终答案四舍五入到四位有效数字。前四位有效数字是 $8$、$1$、$8$ 和 $7$。第五位有效数字是 $3$，小于 $5$，所以我们向下舍入（即在第四位有效数字处截断）。\n$$\n\\Delta w \\approx 0.008187\n$$\n这就是净突触权重变化。",
            "answer": "$$\\boxed{0.008187}$$"
        },
        {
            "introduction": "在掌握了单个脉冲对事件的计算之后，理解特定STDP规则对突触权重动态的长期影响至关重要。这项练习将引导你分析和对比两种基本的STDP模型：加性模型和乘性模型。通过审视它们对权重稳定性及突触间竞争的影响，你将揭示这些不同数学形式对学习、记忆巩固和网络自组织所具有的深远意义。",
            "id": "2753599",
            "problem": "一个突触后神经元通过强度为 $w_i \\in [0, w_{\\max}]$ 的突触接收来自多个突触前神经元的兴奋性输入。突触变化遵循脉冲时间依赖可塑性（STDP），这意味着当突触前脉冲先于突触后脉冲（因果性）时，近似重合的突触前和突触后脉冲会导致长时程增强，而当顺序相反（反因果性）时，则会导致长时程抑制。假设学习率很小，从而可以通过对脉冲时间统计进行平均来分析预期的漂移，并且权重通过瞬时钳位被限制在 $[0, w_{\\max}]$ 内。考虑基于脉冲对的 STDP 规则的两种权重依赖方案：\n\n- “加性”方案：其中由给定脉冲对产生的增强或抑制的幅度不依赖于当前的突触权重 $w$。\n- “乘性”方案：其中增强与到上界的剩余距离成比例，抑制与当前权重成比例（例如，对于因果脉冲对，与 $(w_{\\max} - w)$ 成比例；对于反因果脉冲对，与 $w$ 成比例）。\n\n假设突触前和突触后脉冲序列是平稳的，具有固定的发放率和互相关结构，因此因果和反因果配对的预期频率可以由依赖于脉冲时间分布但不依赖于 $w$ 的有效正系数（分别用于增强和抑制）来概括。根据这些定义和约束，分析每种方案如何影响（i）在平稳统计下单个突触权重的长期分布，以及（ii）接收异质但平稳的突触前后相关性的多个突触之间的竞争。\n\n下列哪个陈述是正确的？选择所有适用项。\n\nA. 在加性方案中，$w$ 的预期漂移与 $w$ 无关，因此在平稳统计下，权重倾向于在边界 $0$ 或 $w_{\\max}$ 处饱和（当存在随机性时，产生双峰平稳分布）。这会在突触之间产生强烈的“赢者通吃”竞争，因为因果配对率的任何微小优势都会导致正反馈和边界饱和。\n\nB. 在加性方案中，有界动力学通常会产生一个稳定的内部不动点 $w^\\ast$，在平稳统计下所有突触都会收敛到该点，而乘性方案则会导致在 $0$ 和 $w_{\\max}$ 处的双峰饱和。\n\nC. 在有界权重下，无论是加性方案还是乘性方案，对于单个突触，在平稳统计下都必然产生相同的稳定不动点 $w^\\ast = w_{\\max}/2$，而与突触前后的脉冲时间相关性无关。\n\nD. 在乘性方案中，预期漂移的形式为 $\\langle \\Delta w \\rangle \\propto \\alpha\\,(w_{\\max} - w) - \\beta\\, w$，其中 $\\alpha$ 和 $\\beta$ 是由脉冲时间分布决定的因果和反因果贡献的有效率（单位时间内）。这会产生一个稳定的内部不动点 $w^\\ast = \\dfrac{\\alpha}{\\alpha + \\beta}\\, w_{\\max}$，并促进突触间的渐进式竞争，较强的相关性会使 $w^\\ast$ 向 $w_{\\max}$ 移动，而不会出现硬性的赢者通吃饱和。",
            "solution": "问题陈述为分析两种脉冲时间依赖可塑性（STDP）模型（加性模型和乘性模型）提供了一个标准的理论框架。该问题具有科学依据、提法明确、客观且内部一致。它提供了足够的信息来推导在平稳随机条件下突触权重的动力学。因此，该问题是有效的，可以进行严谨的分析。\n\n分析的关键在于构建突触权重 $w$ 的预期漂移的公式，记为 $\\langle \\frac{dw}{dt} \\rangle$。我们假设学习率很小，这使我们能够用一个连续时间微分方程来近似 $w$ 的期望值的动力学。设 $R_+$ 是因果脉冲配对（突触前先于突触后）的平均速率， $R_-$ 是反因果脉冲配对（突触后先于突触前）的平均速率。这些速率由平稳的突触前和突触后统计数据决定。\n\n### 加性方案分析\n\n在加性方案中，每次脉冲对引起的权重变化幅度是恒定的，与当前权重 $w$ 无关。设增强步长为 $\\Delta w_+ = A_+$，抑制步长为 $\\Delta w_- = -A_-$，其中 $A_+$ 和 $A_-$ 是正常数。\n\n突触权重的预期漂移由单位时间内预期的增强和抑制事件的总和给出：\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = R_+ A_+ - R_- A_- $$\n让我们定义常数 $C_{LTP} = R_+ A_+$ 和 $C_{LTD} = R_- A_-$。漂移方程为：\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = C_{LTP} - C_{LTD} $$\n漂移是一个常数，与 $w$ 无关。因此，权重动力学是线性的，但被限制在区间 $[0, w_{\\max}]$ 内。\n- 如果 $C_{LTP} > C_{LTD}$，漂移为正，$w(t)$ 将线性增加，直到达到上界 $w_{\\max}$ 并被钳位。\n- 如果 $C_{LTP}  C_{LTD}$，漂移为负，$w(t)$ 将线性减少，直到达到下界 $0$ 并被钳位。\n- 如果 $C_{LTP} = C_{LTD}$，预期漂移为零。然而，单个脉冲时间的随机性将导致 $w(t)$ 进行随机游走。对于在两个吸收（或反射）边界之间的随机游走，权重最终会扩散到其中一个边界。\n\n在所有情况下，权重的长期稳定状态是边界 $0$ 和 $w_{\\max}$。因此，权重的平稳分布将是双峰的，在这两个极端处有峰值。当多个突触竞争时，那些在因果配对中具有微小优势（$C_{LTP} > C_{LTD}$）的突触将饱和到 $w_{\\max}$，而其他突触则衰减到 $0$。这是一种“赢者通吃”的竞争，其特点是朝向边界的失控动力学。\n\n### 乘性方案分析\n\n在乘性方案中，权重变化取决于当前权重 $w$。增强与 $(w_{\\max} - w)$ 成比例，抑制与 $w$ 成比例。设增强和抑制的学习率分别为 $\\eta_+$ 和 $\\eta_-$。\n- 因果脉冲对的变化：$\\Delta w_+ = \\eta_+ (w_{\\max} - w)$\n- 反因果脉冲对的变化：$\\Delta w_- = -\\eta_- w$\n\n预期漂移为：\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = R_+ \\eta_+ (w_{\\max} - w) - R_- \\eta_- w $$\n让我们按照问题建议定义有效率 $\\alpha = R_+ \\eta_+$ 和 $\\beta = R_- \\eta_-$。这些系数反映了脉冲时间分布的影响。漂移方程为：\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = \\alpha (w_{\\max} - w) - \\beta w $$\n为了找到不动点 $w^\\ast$，我们将漂移设为零：\n$$ \\alpha (w_{\\max} - w^\\ast) - \\beta w^\\ast = 0 $$\n$$ \\alpha w_{\\max} - \\alpha w^\\ast - \\beta w^\\ast = 0 $$\n$$ \\alpha w_{\\max} = (\\alpha + \\beta) w^\\ast $$\n$$ w^\\ast = \\frac{\\alpha}{\\alpha + \\beta} w_{\\max} $$\n为了检查这个不动点的稳定性，我们考察漂移对 $w$ 的导数：\n$$ \\frac{d}{dw} \\left( \\alpha (w_{\\max} - w) - \\beta w \\right) = -\\alpha - \\beta $$\n由于 $\\alpha$ 和 $\\beta$ 是从正常数（$R_\\pm, \\eta_\\pm$）导出的有效率，它们是非负的。对于任何非平凡的可塑性（$\\alpha > 0$ 或 $\\beta > 0$），该导数严格为负。这证实了不动点 $w^\\ast$ 是稳定的。任何偏离 $w^\\ast$ 的扰动都会产生一个将权重恢复到该值的漂移。该不动点位于允许的范围 $[0, w_{\\max}]$ 内，因为 $0 \\leq \\frac{\\alpha}{\\alpha+\\beta} \\leq 1$。\n\n权重的平稳分布将是单峰的，以 $w^\\ast$ 为中心。突触之间的竞争变得渐进式：每个突触 $i$ 收敛到其自身的稳定点 $w_i^\\ast$，该稳定点由其特定的相关性统计数据 $(\\alpha_i, \\beta_i)$ 决定。更强的净因果相关性（更大的 $\\alpha_i / \\beta_i$ 比率）会导致更高的稳定权重，但不一定会饱和。\n\n### 选项评估\n\n**A. 在加性方案中，$w$ 的预期漂移与 $w$ 无关，因此在平稳统计下，权重倾向于在边界 $0$ 或 $w_{\\max}$ 处饱和（当存在随机性时，产生双峰平稳分布）。这会在突触之间产生强烈的“赢者通吃”竞争，因为因果配对率的任何微小优势都会导致正反馈和边界饱和。**\n该陈述是对加性方案分析的精确总结。漂移是恒定的，导致边界饱和和双峰分布。这种机制内在地产生了赢者通吃的竞争。术语“正反馈”在这里通俗地用来描述失控的动力学。\n**结论：正确。**\n\n**B. 在加性方案中，有界动力学通常会产生一个稳定的内部不动点 $w^\\ast$，在平稳统计下所有突触都会收敛到该点，而乘性方案则会导致在 $0$ 和 $w_{\\max}$ 处的双峰饱和。**\n该陈述错误地交换了两种方案的属性。是乘性方案产生稳定的内部不动点，而加性方案导致双峰饱和。\n**结论：错误。**\n\n**C. 在有界权重下，无论是加性方案还是乘性方案，对于单个突触，在平稳统计下都必然产生相同的稳定不动点 $w^\\ast = w_{\\max}/2$，而与突触前后的脉冲时间相关性无关。**\n该陈述因几个原因而错误。首先，加性方案没有稳定的内部不动点。其次，对于乘性方案，不动点 $w^\\ast = \\frac{\\alpha}{\\alpha + \\beta} w_{\\max}$ 仅在 $\\alpha = \\beta$ 的特定情况下才等于 $w_{\\max}/2$。最重要的是，不动点严重依赖于脉冲时间相关性（它决定了 $\\alpha$ 和 $\\beta$），而不是与它们无关。\n**结论：错误。**\n\n**D. 在乘性方案中，预期漂移的形式为 $\\langle \\Delta w \\rangle \\propto \\alpha\\,(w_{\\max} - w) - \\beta\\, w$，其中 $\\alpha$ 和 $\\beta$ 是由脉冲时间分布决定的因果和反因果贡献的有效率（单位时间内）。这会产生一个稳定的内部不动点 $w^\\ast = \\dfrac{\\alpha}{\\alpha + \\beta}\\, w_{\\max}$，并促进突触间的渐进式竞争，较强的相关性会使 $w^\\ast$ 向 $w_{\\max}$ 移动，而不会出现硬性的赢者通吃饱和。**\n该陈述是对乘性方案分析的精确总结。漂移的形式、由此产生的稳定内部不动点以及渐进式竞争的性质都推导正确。\n**结论：正确。**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "为了连接抽象学习规则与其生物学实现之间的鸿沟，这项练习将深入探讨被认为是STDP基础的生物物理机制。你将实现一个计算模型，模拟钙离子（$Ca^{2+}$）通过NMDA受体的流入，这是突触可塑性“钙假说”的核心过程。这个动手编程练习将让你深入了解突触前和突触后活动的精确时间关系如何转化为驱动突触层面学习的分子信号。",
            "id": "2753602",
            "problem": "要求你基于突触电流的基本电导原理和一个具有物理动机的镁离子阻断模型，计算在一次突触前-突触后脉冲配对期间由 N-methyl-D-aspartate (NMDA) 受体承载的钙电流时间进程。你的程序必须实现以下定义，并为一组测试用例计算所要求的输出。\n\n给定突触后电压轨迹 $V(t)$、NMDA 电导时间进程 $g_{\\text{NMDA}}(t)$ 以及镁离子阻断函数 $s(V)$，NMDA 电流定义为\n$$I_{\\text{NMDA}}(t) = g_{\\text{NMDA}}(t)\\, s\\!\\left(V(t)\\right)\\,\\left(V(t)-E_{\\text{NMDA}}\\right).$$\n假设 NMDA 电流的一个恒定比例 $f_{\\text{Ca}}$ 由钙离子承载，从而产生钙电流\n$$I_{\\text{Ca}}(t) = f_{\\text{Ca}}\\, I_{\\text{NMDA}}(t).$$\n\n使用以下经过充分检验的形式和参数值：\n- 突触前-突触后时序：单个突触前事件发生在时间 $t_{\\text{pre}}=0\\,\\text{ms}$；单个突触后反向传播动作电位 (bAP) 发生在时间 $t_{\\text{post}}=\\Delta t\\,\\text{ms}$，其中 $\\Delta t0$。\n- 突触后电压：\n$$V(t) = V_{\\text{rest}} + A_{\\text{EPSP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,EPSP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,EPSP}}}\\right)\\right] H(t-t_{\\text{pre}}) \\\\\n\\quad\\quad + A_{\\text{bAP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{d,bAP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{r,bAP}}}\\right)\\right] H(t-t_{\\text{post}}),$$\n其中 $H(x)$ 是亥维赛函数，定义为当 $x0$ 时 $H(x)=0$，当 $x\\ge 0$ 时 $H(x)=1$。使用 $V_{\\text{rest}}=-70\\,\\text{mV}$，$A_{\\text{EPSP}}=5\\,\\text{mV}$，$\\tau_{\\text{r,EPSP}}=1\\,\\text{ms}$，$\\tau_{\\text{d,EPSP}}=15\\,\\text{ms}$，$A_{\\text{bAP}}=100\\,\\text{mV}$，$\\tau_{\\text{r,bAP}}=0.5\\,\\text{ms}$ 以及 $\\tau_{\\text{d,bAP}}=2\\,\\text{ms}$。\n- NMDA 电导：\n$$g_{\\text{NMDA}}(t) = g_0 \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,NMDA}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,NMDA}}}\\right)\\right] H(t-t_{\\text{pre}}),$$\n其中 $\\tau_{\\text{r,NMDA}}=4\\,\\text{ms}$ 且 $\\tau_{\\text{d,NMDA}}=80\\,\\text{ms}$。标度参数 $g_0$ 的单位是 $\\text{nS}$。\n- 镁离子阻断 (Jahr-Stevens 形式)：\n$$s(V)=\\frac{1}{1+\\left(\\frac{[\\text{Mg}^{2+}]}{3.57}\\right)\\exp\\!\\left(-0.062\\,V\\right)},$$\n其中 $[\\text{Mg}^{2+}]$ 的单位是 $\\text{mM}$，$V$ 的单位是 $\\text{mV}$。\n- 反转电位和钙离子分数：$E_{\\text{NMDA}}=0\\,\\text{mV}$ 且 $f_{\\text{Ca}}=0.1$ (无量纲小数)。\n- 单位：$g_{\\text{NMDA}}$ 的单位是 $\\text{nS}$，$V$ 和 $E_{\\text{NMDA}}$ 的单位是 $\\text{mV}$，因此 $I_{\\text{NMDA}}$ 和 $I_{\\text{Ca}}$ 的单位是 $\\text{pA}$，因为 $1\\,\\text{nS}\\cdot 1\\,\\text{mV} = 1\\,\\text{pA}$。\n\n在以下采样时间（单位为毫秒）计算 $I_{\\text{Ca}}(t)$：$t\\in\\{0,2,5,10,12,20,40,80,160\\}$。以皮安 (pA) 为单位，将数值报告为带符号的十进制浮点数，并四舍五入到6位小数。\n\n测试套件：\n- 情况 1：$\\Delta t=10\\,\\text{ms}$，$[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$，$g_0=1.0\\,\\text{nS}$。\n- 情况 2：$\\Delta t=10\\,\\text{ms}$，$[\\text{Mg}^{2+}]=2.0\\,\\text{mM}$，$g_0=1.0\\,\\text{nS}$。\n- 情况 3：$\\Delta t=2\\,\\text{ms}$，$[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$，$g_0=1.0\\,\\text{nS}$。\n- 情况 4：$\\Delta t=10\\,\\text{ms}$，$[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$，$g_0=0.3\\,\\text{nS}$。\n- 情况 5：$\\Delta t=80\\,\\text{ms}$，$[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$，$g_0=1.0\\,\\text{nS}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个逗号分隔的列表的列表形式的结果。每个测试用例对应一个列表，每个内部列表包含在指定采样时间点计算出的九个四舍五入后的 $I_{\\text{Ca}}(t)$ 值（单位为皮安）。例如，确切的所需格式为\n$$\\texttt{[[v\\_1\\_1,v\\_1\\_2,\\dots,v\\_1\\_9],[v\\_2\\_1,\\dots,v\\_2\\_9],\\dots,[v\\_5\\_1,\\dots,v\\_5\\_9]]}$$\n除逗号和方括号外，不得有其他多余的空白字符。",
            "solution": "问题陈述已经过分析，并被认为是有效的。它具有科学依据、问题适定、客观且内部一致。它提出了一个细胞神经科学中的标准计算问题。我们现在开始解答。\n\n目标是根据一套具有生物物理动机的方程和参数，计算在突触前-突触后脉冲配对协议下，于指定时间点流经 N-methyl-D-aspartate (NMDA) 受体的钙电流 $I_{\\text{Ca}}(t)$。\n\n在任意给定时间 $t$ 确定 $I_{\\text{Ca}}$ 的逻辑步骤如下：\n1. 确定突触后膜电位 $V(t)$。\n2. 确定 NMDA 受体电导 $g_{\\text{NMDA}}(t)$。\n3. 使用 $V(t)$，计算电压依赖的镁离子阻断分数 $s(V(t))$。\n4. 结合这些分量来计算总 NMDA 电流 $I_{\\text{NMDA}}(t)$。\n5. 最后，确定钙电流 $I_{\\text{Ca}}(t)$，其为 $I_{\\text{NMDA}}(t)$ 的一个恒定分数。\n\n我们现在将详细说明每个步骤。所有参数均取自问题陈述。\n\n步骤1：突触后电压 $V(t)$\n突触后电压 $V(t)$ 是静息电位、一个由 $t_{\\text{pre}} = 0\\,\\text{ms}$ 的突触前事件引发的兴奋性突触后电位 (EPSP)，以及一个在 $t_{\\text{post}} = \\Delta t$ 时引发的反向传播动作电位 (bAP) 的线性叠加。方程为：\n$$V(t) = V_{\\text{rest}} + V_{\\text{EPSP}}(t) + V_{\\text{bAP}}(t)$$\n其中各分量由以下公式给出：\n$$V_{\\text{EPSP}}(t) = A_{\\text{EPSP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,EPSP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,EPSP}}}\\right)\\right] H(t-t_{\\text{pre}})$$\n$$V_{\\text{bAP}}(t) = A_{\\text{bAP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{d,bAP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{r,bAP}}}\\right)\\right] H(t-t_{\\text{post}})$$\n函数 $H(x)$ 是亥维赛阶跃函数，当 $x \\ge 0$ 时为 $1$，当 $x  0$ 时为 $0$。它确保了因果性，即电位只在它们各自的触发事件之后出现。参数如下：\n- 静息电位：$V_{\\text{rest}}=-70\\,\\text{mV}$\n- EPSP 幅度：$A_{\\text{EPSP}}=5\\,\\text{mV}$\n- EPSP 上升时间常数：$\\tau_{\\text{r,EPSP}}=1\\,\\text{ms}$\n- EPSP 衰减时间常数：$\\tau_{\\text{d,EPSP}}=15\\,\\text{ms}$\n- bAP 幅度：$A_{\\text{bAP}}=100\\,\\text{mV}$\n- bAP 上升时间常数：$\\tau_{\\text{r,bAP}}=0.5\\,\\text{ms}$\n- bAP 衰减时间常数：$\\tau_{\\text{d,bAP}}=2\\,\\text{ms}$\n- 突触前时间：$t_{\\text{pre}}=0\\,\\text{ms}$\n- 突触后时间：$t_{\\text{post}}=\\Delta t$\n\n步骤2：NMDA 电导 $g_{\\text{NMDA}}(t)$\nNMDA 受体电导由 $t_{\\text{pre}}=0\\,\\text{ms}$ 的突触前事件激活，并遵循双指数时间进程：\n$$g_{\\text{NMDA}}(t) = g_0 \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,NMDA}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,NMDA}}}\\right)\\right] H(t-t_{\\text{pre}})$$\n参数如下：\n- 峰值电导标度因子：$g_0$ (单位 $\\text{nS}$)\n- NMDA 上升时间常数：$\\tau_{\\text{r,NMDA}}=4\\,\\text{ms}$\n- NMDA 衰减时间常数：$\\tau_{\\text{d,NMDA}}=80\\,\\text{ms}$\n\n步骤3：镁离子阻断 $s(V)$\nNMDA 受体通道以电压依赖的方式被镁离子阻断。这由 Jahr-Stevens 模型描述：\n$$s(V)=\\frac{1}{1+\\left(\\frac{[\\text{Mg}^{2+}]}{K_{\\text{Mg}}}\\right)\\exp\\!\\left(-\\gamma\\,V\\right)}$$\n项 $s(V)$ 代表未被阻断的通道的比例。参数如下：\n- 外部镁离子浓度：$[\\text{Mg}^{2+}]$ (单位 $\\text{mM}$)\n- 0 mV 时的镁解离常数：$K_{\\text{Mg}} = 3.57\\,\\text{mM}$\n- 电压依赖因子：$\\gamma = 0.062\\,\\text{mV}^{-1}$\n此表达式中的电压 $V$ 是瞬时膜电位 $V(t)$，单位为毫伏。\n\n步骤4：总 NMDA 电流 $I_{\\text{NMDA}}(t)$\n流经 NMDA 受体的总离子电流由基于电导的模型给出：\n$$I_{\\text{NMDA}}(t) = g_{\\text{NMDA}}(t)\\, s\\!\\left(V(t)\\right)\\,\\left(V(t)-E_{\\text{NMDA}}\\right)$$\n该方程结合了时变电导、电压依赖的去阻断和电化学驱动力 $(V(t)-E_{\\text{NMDA}})$。NMDA 反转电位给定为 $E_{\\text{NMDA}}=0\\,\\text{mV}$。单位是一致的：$I_{\\text{NMDA}} [\\text{pA}] = g_{\\text{NMDA}} [\\text{nS}] \\times V [\\text{mV}]$。\n\n步骤5：钙电流 $I_{\\text{Ca}}(t)$\n总 NMDA 受体电流的一个恒定比例 $f_{\\text{Ca}}$ 是由钙离子承载的。\n$$I_{\\text{Ca}}(t) = f_{\\text{Ca}}\\, I_{\\text{NMDA}}(t)$$\n指定的钙离子分数为 $f_{\\text{Ca}}=0.1$。得到的 $I_{\\text{Ca}}(t)$ 的单位将是皮安 ($\\text{pA}$)。\n\n计算算法将实现这五个步骤。对于每个测试用例，都指定了参数 $\\Delta t$、$[\\text{Mg}^{2+}]$ 和 $g_0$。对于每个所需的采样时间 $t \\in \\{0, 2, 5, 10, 12, 20, 40, 80, 160\\}\\,\\text{ms}$，程序将依次计算 $V(t)$、$g_{\\text{NMDA}}(t)$、$s(V(t))$、$I_{\\text{NMDA}}(t)$，最后计算 $I_{\\text{Ca}}(t)$，并按要求四舍五入到6位小数。电流的符号是正的，表示正电荷的外向流动（阳离子离开细胞），但由于这里的驱动力 $(V(t)-E_{NMDA})$ 通常是负的（只要$V(t)  0$），电流本身通常是负的，表示内向流动。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the NMDA-mediated calcium current time course for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Delta_t [ms], Mg2_conc [mM], g0 [nS])\n        (10.0, 1.0, 1.0),  # Case 1\n        (10.0, 2.0, 1.0),  # Case 2\n        (2.0, 1.0, 1.0),   # Case 3\n        (10.0, 1.0, 0.3),  # Case 4\n        (80.0, 1.0, 1.0),  # Case 5\n    ]\n    \n    # Fixed parameters\n    V_rest = -70.0  # mV\n    A_EPSP = 5.0    # mV\n    tau_r_EPSP = 1.0  # ms\n    tau_d_EPSP = 15.0 # ms\n    A_bAP = 100.0   # mV\n    tau_r_bAP = 0.5   # ms\n    tau_d_bAP = 2.0   # ms\n    \n    tau_r_NMDA = 4.0  # ms\n    tau_d_NMDA = 80.0 # ms\n    \n    E_NMDA = 0.0    # mV\n    f_Ca = 0.1      # dimensionless\n    \n    mg_K = 3.57     # mM\n    mg_gamma = 0.062 # 1/mV\n    \n    t_pre = 0.0     # ms\n    \n    # Sampling times\n    t_samples = [0.0, 2.0, 5.0, 10.0, 12.0, 20.0, 40.0, 80.0, 160.0]\n\n    all_results = []\n    \n    # Heaviside step function\n    def H(x):\n        return 1.0 if x >= 0 else 0.0\n\n    for case in test_cases:\n        delta_t, mg_conc, g0 = case\n        t_post = delta_t\n        \n        results_for_case = []\n        for t in t_samples:\n            # Step 1: Calculate postsynaptic voltage V(t)\n            # EPSP component\n            dt_epsp = t - t_pre\n            V_epsp = A_EPSP * (np.exp(-dt_epsp / tau_d_EPSP) - np.exp(-dt_epsp / tau_r_EPSP)) * H(dt_epsp)\n            \n            # bAP component\n            dt_bap = t - t_post\n            V_bap = A_bAP * (np.exp(-dt_bap / tau_d_bAP) - np.exp(-dt_bap / tau_r_bAP)) * H(dt_bap)\n            \n            V_t = V_rest + V_epsp + V_bap\n            \n            # Step 2: Calculate NMDA conductance g_NMDA(t)\n            dt_nmda = t - t_pre\n            g_nmda_t = g0 * (np.exp(-dt_nmda / tau_d_NMDA) - np.exp(-dt_nmda / tau_r_NMDA)) * H(dt_nmda)\n            \n            # Step 3: Calculate magnesium block s(V)\n            s_V = 1.0 / (1.0 + (mg_conc / mg_K) * np.exp(-mg_gamma * V_t))\n            \n            # Step 4: Calculate total NMDA current I_NMDA(t)\n            I_nmda_t = g_nmda_t * s_V * (V_t - E_NMDA)\n            \n            # Step 5: Calculate calcium current I_Ca(t)\n            I_ca_t = f_Ca * I_nmda_t\n            \n            # Round to 6 decimal places and store\n            results_for_case.append(round(I_ca_t, 6))\n            \n        all_results.append(results_for_case)\n\n    # Format the final output string as specified\n    output_string = str(all_results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n```"
        }
    ]
}