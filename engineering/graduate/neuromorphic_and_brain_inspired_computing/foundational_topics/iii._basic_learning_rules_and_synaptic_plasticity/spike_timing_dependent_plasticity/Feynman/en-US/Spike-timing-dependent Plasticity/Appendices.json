{
    "hands_on_practices": [
        {
            "introduction": "We begin with the foundational model of STDP: the pair-based exponential learning window. This first exercise  provides a direct application of the classic STDP rule, requiring you to calculate the precise synaptic weight change for a single pre-post spike pair. Mastering this fundamental calculation is the essential first step toward modeling and understanding more complex plasticity phenomena in neural circuits.",
            "id": "4059871",
            "problem": "In a pair-based model of spike-timing-dependent plasticity (STDP), the synaptic modification induced by a single presynaptic spike at time $t_{\\text{pre}}$ and a single postsynaptic spike at time $t_{\\text{post}}$ is governed by a causal learning window for $\\Delta t \\equiv t_{\\text{post}} - t_{\\text{pre}}  0$ that captures long-term potentiation (LTP) and an anti-causal learning window for $\\Delta t  0$ that captures long-term depression (LTD). Assume a biophysical first-principles base in which each learning window is generated by a first-order synaptic trace with a characteristic decay: the causal window $W_{+}(\\Delta t)$ for $\\Delta t0$ satisfies the first-order linear ordinary differential equation $\\frac{dW_{+}}{d\\Delta t}=-\\frac{1}{\\tau_{+}}W_{+}$ with initial condition $W_{+}(0^{+})=A_{+}$, and the anti-causal window $W_{-}(\\Delta t)$ for $\\Delta t0$ is obtained by considering the elapsed time $s\\equiv -\\Delta t  0$ of a decaying trace that satisfies $\\frac{dW_{-}}{ds}=-\\frac{1}{\\tau_{-}}W_{-}$ with initial condition $W_{-}(0^{-})=-A_{-}$. The net synaptic change $\\Delta w$ for a given spike pair is the value of the appropriate window $W_{+}$ or $W_{-}$ evaluated at the corresponding $\\Delta t$.\n\nUsing this framework, compute the net synaptic weight change induced by a presynaptic spike at $t_{\\text{pre}}=10\\ \\text{ms}$ and a postsynaptic spike at $t_{\\text{post}}=14\\ \\text{ms}$, given $A_{+}=0.01$, $\\tau_{+}=20\\ \\text{ms}$, $A_{-}=0.012$, and $\\tau_{-}=20\\ \\text{ms}$. Report the net synaptic change as a single dimensionless number, rounded to four significant figures.",
            "solution": "The problem statement is evaluated and determined to be valid. It is scientifically grounded in the established principles of spike-timing-dependent plasticity (STDP) modeling, specifically using a common pair-based model with exponential learning windows. The problem is well-posed, objective, and provides a complete and consistent set of data and definitions, including the governing differential equations, initial conditions, and all necessary parameter values. Therefore, a unique and meaningful solution can be derived.\n\nThe task is to compute the net synaptic weight change, $\\Delta w$, for a given pair of presynaptic and postsynaptic spikes. The change is determined by the time difference $\\Delta t \\equiv t_{\\text{post}} - t_{\\text{pre}}$, where $t_{\\text{pre}}$ is the presynaptic spike time and $t_{\\text{post}}$ is the postsynaptic spike time.\n\nFirst, we calculate the time difference $\\Delta t$ using the provided spike times:\n$t_{\\text{pre}} = 10\\ \\text{ms}$\n$t_{\\text{post}} = 14\\ \\text{ms}$\n\n$$\n\\Delta t = t_{\\text{post}} - t_{\\text{pre}} = 14\\ \\text{ms} - 10\\ \\text{ms} = 4\\ \\text{ms}\n$$\n\nSince $\\Delta t = 4\\ \\text{ms}$ is greater than $0$, the synaptic modification is governed by the causal learning window for long-term potentiation (LTP), denoted as $W_{+}(\\Delta t)$. The problem states that this window function is the solution to the following first-order linear ordinary differential equation for $\\Delta t  0$:\n$$\n\\frac{dW_{+}}{d\\Delta t} = -\\frac{1}{\\tau_{+}}W_{+}\n$$\nwith the initial condition $W_{+}(0^{+}) = A_{+}$.\n\nThis is a standard separable differential equation. We can rearrange it as:\n$$\n\\frac{dW_{+}}{W_{+}} = -\\frac{1}{\\tau_{+}} d\\Delta t\n$$\nIntegrating both sides yields:\n$$\n\\int \\frac{1}{W_{+}} dW_{+} = \\int -\\frac{1}{\\tau_{+}} d\\Delta t\n$$\n$$\n\\ln|W_{+}| = -\\frac{\\Delta t}{\\tau_{+}} + C\n$$\nwhere $C$ is the constant of integration. Exponentiating both sides gives:\n$$\n|W_{+}| = \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}} + C\\right) = \\exp(C) \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)\n$$\nLet a new constant $K = \\pm \\exp(C)$. The general solution is:\n$$\nW_{+}(\\Delta t) = K \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)\n$$\nWe use the initial condition $W_{+}(0^{+}) = A_{+}$ to determine the constant $K$. In the limit as $\\Delta t \\to 0^{+}$:\n$$\nW_{+}(0^{+}) = K \\exp(0) = K\n$$\nTherefore, $K = A_{+}$. The specific solution for the causal learning window is:\n$$\nW_{+}(\\Delta t) = A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right) \\quad \\text{for } \\Delta t  0\n$$\n\nThe net synaptic change $\\Delta w$ is the value of this function evaluated at $\\Delta t = 4\\ \\text{ms}$. The given parameters are $A_{+} = 0.01$ and $\\tau_{+} = 20\\ \\text{ms}$.\nSubstituting these values into the equation:\n$$\n\\Delta w = W_{+}(4\\ \\text{ms}) = 0.01 \\exp\\left(-\\frac{4\\ \\text{ms}}{20\\ \\text{ms}}\\right)\n$$\nThe units of milliseconds in the exponent cancel out, yielding a dimensionless argument as required:\n$$\n\\Delta w = 0.01 \\exp\\left(-\\frac{4}{20}\\right) = 0.01 \\exp(-0.2)\n$$\nNow, we compute the numerical value:\n$$\n\\exp(-0.2) \\approx 0.818730753\n$$\n$$\n\\Delta w \\approx 0.01 \\times 0.818730753 = 0.00818730753\n$$\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures are $8$, $1$, $8$, and $7$. The fifth significant digit is $3$, which is less than $5$, so we round down (i.e., truncate at the fourth significant figure).\n$$\n\\Delta w \\approx 0.008187\n$$\nThis is the net synaptic weight change.",
            "answer": "$$\\boxed{0.008187}$$"
        },
        {
            "introduction": "Moving from a single plasticity event to its long-term consequences, we now explore how the mathematical form of the STDP rule governs synaptic dynamics and competition. This analytical exercise  introduces the critical distinction between additive and multiplicative STDP models. Your task is to deduce how each model influences the stability of synaptic weights and promotes different competitive regimes, a key concept for understanding how learning rules shape network structure and function.",
            "id": "2753599",
            "problem": "A single postsynaptic neuron receives excitatory inputs from several presynaptic neurons through synapses with strengths $w_i \\in [0, w_{\\max}]$. Synaptic changes follow Spike-Timing-Dependent Plasticity (STDP), meaning that near-coincident presynaptic and postsynaptic spikes cause long-term potentiation when presynaptic spikes precede postsynaptic spikes (causal) and long-term depression when the order is reversed (anti-causal). Assume a small learning rate so that expected drifts can be analyzed by averaging over spike-time statistics, and that weights are bounded by instantaneous clamping to $[0, w_{\\max}]$. Consider two weight-dependence schemes for the pair-based STDP rule:\n\n- An “additive” scheme in which the magnitude of potentiation or depression produced by a given spike pair does not depend on the current synaptic weight $w$.\n- A “multiplicative” scheme in which potentiation scales with the remaining distance to the upper bound and depression scales with the current weight (for example, proportional to $(w_{\\max} - w)$ for causal pairs and to $w$ for anti-causal pairs).\n\nAssume stationary pre- and postsynaptic spike trains with fixed rates and cross-correlation structure, so that the expected frequency of causal and anti-causal pairings can be summarized by effective positive coefficients for potentiation and depression that depend on the spike-timing distribution but not on $w$. Analyze, from these definitions and constraints, how each scheme influences (i) the long-term distribution of a single synapse’s weight under stationary statistics and (ii) competition among multiple synapses receiving heterogeneous but stationary pre-post correlations.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. In the additive scheme, the expected drift of $w$ is independent of $w$, so under stationary statistics the weight tends to saturate at the bounds $0$ or $w_{\\max}$ (yielding a bimodal stationary distribution when stochasticity is present). This produces strong “winner-take-all” competition among synapses because any small advantage in causal pairing rates leads to positive feedback and boundary saturation.\n\nB. In the additive scheme, bounded dynamics generically yield a stable interior fixed point $w^\\ast$ that all synapses converge to under stationary statistics, whereas the multiplicative scheme induces bimodal saturation at $0$ and $w_{\\max}$.\n\nC. With bounded weights, both additive and multiplicative schemes necessarily produce the same stable fixed point $w^\\ast = w_{\\max}/2$ for a single synapse under stationary statistics, irrespective of pre-post spike-timing correlations.\n\nD. In the multiplicative scheme, the expected drift has the form $\\langle \\Delta w \\rangle \\propto \\alpha\\,(w_{\\max} - w) - \\beta\\, w$, where $\\alpha$ and $\\beta$ are the effective rates (per unit time) of causal and anti-causal contributions determined by the spike-timing distribution. This yields a stable interior fixed point $w^\\ast = \\dfrac{\\alpha}{\\alpha + \\beta}\\, w_{\\max}$ and promotes graded competition across synapses, with stronger correlations shifting $w^\\ast$ toward $w_{\\max}$ without hard winner-take-all saturation.",
            "solution": "The problem statement presents a standard theoretical framework for analyzing two models of Spike-Timing-Dependent Plasticity (STDP): an additive model and a multiplicative model. The problem is scientifically grounded, well-posed, objective, and internally consistent. It provides sufficient information to derive the dynamics of synaptic weights under stationary stochastic conditions. Thus, the problem is valid, and a rigorous analysis can proceed.\n\nThe analysis hinges on the formulation of the expected drift of the synaptic weight, $w$, denoted as $\\langle \\frac{dw}{dt} \\rangle$. We assume a small learning rate, which allows us to approximate the dynamics of the expectation value of $w$ by a continuous-time differential equation. Let $R_+$ be the average rate of causal spike pairings (pre-before-post) and $R_-$ be the average rate of anti-causal spike pairings (post-before-pre). These rates are determined by the stationary pre- and postsynaptic statistics.\n\n### Analysis of the Additive Scheme\n\nIn the additive scheme, the magnitude of weight change per spike pair is constant, independent of the current weight $w$. Let the potentiation step be $\\Delta w_+ = A_+$ and the depression step be $\\Delta w_- = -A_-$, where $A_+$ and $A_-$ are positive constants.\n\nThe expected drift of the synaptic weight is given by the sum of expected potentiation and depression events per unit time:\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = R_+ A_+ - R_- A_- $$\nLet us define the constants $C_{LTP} = R_+ A_+$ and $C_{LTD} = R_- A_-$. The drift equation is:\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = C_{LTP} - C_{LTD} $$\nThe drift is a constant, independent of $w$. The weight dynamics are therefore linear, but are constrained to the interval $[0, w_{\\max}]$.\n- If $C_{LTP}  C_{LTD}$, the drift is positive, and $w(t)$ will increase linearly until it reaches the upper bound $w_{\\max}$, where it is clamped.\n- If $C_{LTP}  C_{LTD}$, the drift is negative, and $w(t)$ will decrease linearly until it reaches the lower bound $0$, where it is clamped.\n- If $C_{LTP} = C_{LTD}$, the expected drift is zero. However, the stochastic nature of individual spike timings will cause $w(t)$ to undergo a random walk. For a random walk between two absorbing (or reflecting) boundaries, the weight will eventually diffuse to one of the boundaries.\n\nIn all cases, the long-term stable states for the weight are the boundaries $0$ and $w_{\\max}$. The stationary distribution of weights will therefore be bimodal, with peaks at these two extremes. When multiple synapses compete, those with a slight advantage in causal pairings ($C_{LTP}  C_{LTD}$) will saturate at $w_{\\max}$, while others decay to $0$. This is a \"winner-take-all\" competition, characterized by runaway dynamics toward the boundaries.\n\n### Analysis of the Multiplicative Scheme\n\nIn the multiplicative scheme, the weight change depends on the current weight $w$. Potentiation scales with $(w_{\\max} - w)$ and depression scales with $w$. Let the learning rates for potentiation and depression be $\\eta_+$ and $\\eta_-$, respectively.\n- Change for a causal pair: $\\Delta w_+ = \\eta_+ (w_{\\max} - w)$\n- Change for an anti-causal pair: $\\Delta w_- = -\\eta_- w$\n\nThe expected drift is:\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = R_+ \\eta_+ (w_{\\max} - w) - R_- \\eta_- w $$\nLet's define the effective rates $\\alpha = R_+ \\eta_+$ and $\\beta = R_- \\eta_-$, as suggested by the problem. These coefficients reflect the influence of the spike-timing distribution. The drift equation is:\n$$ \\left\\langle \\frac{dw}{dt} \\right\\rangle = \\alpha (w_{\\max} - w) - \\beta w $$\nTo find the fixed point $w^\\ast$, we set the drift to zero:\n$$ \\alpha (w_{\\max} - w^\\ast) - \\beta w^\\ast = 0 $$\n$$ \\alpha w_{\\max} - \\alpha w^\\ast - \\beta w^\\ast = 0 $$\n$$ \\alpha w_{\\max} = (\\alpha + \\beta) w^\\ast $$\n$$ w^\\ast = \\frac{\\alpha}{\\alpha + \\beta} w_{\\max} $$\nTo check the stability of this fixed point, we examine the derivative of the drift with respect to $w$:\n$$ \\frac{d}{dw} \\left( \\alpha (w_{\\max} - w) - \\beta w \\right) = -\\alpha - \\beta $$\nSince $\\alpha$ and $\\beta$ are effective rates derived from positive constants ($R_\\pm, \\eta_\\pm$), they are non-negative. For any non-trivial plasticity ($\\alpha  0$ or $\\beta  0$), the derivative is strictly negative. This confirms that the fixed point $w^\\ast$ is stable. Any perturbation away from $w^\\ast$ will result in a drift that restores the weight to this value. The fixed point lies within the allowed range $[0, w_{\\max}]$ because $0 \\leq \\frac{\\alpha}{\\alpha+\\beta} \\leq 1$.\n\nThe stationary distribution of weights will be unimodal, centered around $w^\\ast$. Competition among synapses becomes graded: each synapse $i$ converges to its own stable point $w_i^\\ast$, which is determined by its specific correlation statistics $(\\alpha_i, \\beta_i)$. A stronger net causal correlation (larger $\\alpha_i / \\beta_i$ ratio) leads to a higher stable weight, but not necessarily saturation.\n\n### Evaluation of Options\n\n**A. In the additive scheme, the expected drift of $w$ is independent of $w$, so under stationary statistics the weight tends to saturate at the bounds $0$ or $w_{\\max}$ (yielding a bimodal stationary distribution when stochasticity is present). This produces strong “winner-take-all” competition among synapses because any small advantage in causal pairing rates leads to positive feedback and boundary saturation.**\nThis statement is a precise summary of the analysis of the additive scheme. The drift is constant, leading to saturation at the boundaries and a bimodal distribution. This mechanism inherently produces winner-take-all competition. The term \"positive feedback\" is used colloquially to describe the runaway dynamics.\n**Verdict: Correct.**\n\n**B. In the additive scheme, bounded dynamics generically yield a stable interior fixed point $w^\\ast$ that all synapses converge to under stationary statistics, whereas the multiplicative scheme induces bimodal saturation at $0$ and $w_{\\max}$.**\nThis statement incorrectly swaps the properties of the two schemes. It is the multiplicative scheme that yields a stable interior fixed point, and the additive scheme that leads to bimodal saturation.\n**Verdict: Incorrect.**\n\n**C. With bounded weights, both additive and multiplicative schemes necessarily produce the same stable fixed point $w^\\ast = w_{\\max}/2$ for a single synapse under stationary statistics, irrespective of pre-post spike-timing correlations.**\nThis statement is incorrect for several reasons. First, the additive scheme does not have a stable interior fixed point. Second, for the multiplicative scheme, the fixed point $w^\\ast = \\frac{\\alpha}{\\alpha + \\beta} w_{\\max}$ is only equal to $w_{\\max}/2$ in the specific case where $\\alpha = \\beta$. Most importantly, the fixed point is critically dependent on the spike-timing correlations (which determine $\\alpha$ and $\\beta$), not irrespective of them.\n**Verdict: Incorrect.**\n\n**D. In the multiplicative scheme, the expected drift has the form $\\langle \\Delta w \\rangle \\propto \\alpha\\,(w_{\\max} - w) - \\beta\\, w$, where $\\alpha$ and $\\beta$ are the effective rates (per unit time) of causal and anti-causal contributions determined by the spike-timing distribution. This yields a stable interior fixed point $w^\\ast = \\dfrac{\\alpha}{\\alpha + \\beta}\\, w_{\\max}$ and promotes graded competition across synapses, with stronger correlations shifting $w^\\ast$ toward $w_{\\max}$ without hard winner-take-all saturation.**\nThis statement is a precise summary of the analysis of the multiplicative scheme. The form of the drift, the resulting stable interior fixed point, and the nature of the graded competition are all derived correctly.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "To bridge the gap between abstract models and cellular biology, our final practice delves into the biophysical mechanisms that underpin STDP. It is widely hypothesized that the timing-dependent calcium influx through NMDA receptors is the critical trigger for synaptic plasticity. This coding exercise  guides you through a simulation of this process, allowing you to compute the precise calcium current resulting from the interaction of synaptic conductances and postsynaptic depolarization.",
            "id": "2753602",
            "problem": "You are asked to compute the calcium current time course carried by N-methyl-D-aspartate (NMDA) receptors during a pre-before-post spike pairing, based on fundamental conductance-based principles of synaptic currents and a physically motivated model of magnesium blocking. Your program must implement the following definitions and compute the requested outputs for a set of test cases.\n\nGiven a postsynaptic voltage trajectory $V(t)$, an NMDA conductance time course $g_{\\text{NMDA}}(t)$, and a magnesium block function $s(V)$, the NMDA current is defined by\n$$I_{\\text{NMDA}}(t) = g_{\\text{NMDA}}(t)\\, s\\!\\left(V(t)\\right)\\,\\left(V(t)-E_{\\text{NMDA}}\\right).$$\nAssume that a constant fraction $f_{\\text{Ca}}$ of the NMDA current is carried by calcium ions, yielding the calcium current\n$$I_{\\text{Ca}}(t) = f_{\\text{Ca}}\\, I_{\\text{NMDA}}(t).$$\n\nUse the following well-tested forms and parameter values:\n- Pre-before-post timing: a single presynaptic event occurs at time $t_{\\text{pre}}=0\\,\\text{ms}$; a single postsynaptic back-propagating action potential (bAP) occurs at time $t_{\\text{post}}=\\Delta t\\,\\text{ms}$ with $\\Delta t0$.\n- Postsynaptic voltage: \n$$V(t) = V_{\\text{rest}} + A_{\\text{EPSP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,EPSP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,EPSP}}}\\right)\\right] H(t-t_{\\text{pre}}) \\\\\n\\quad\\quad + A_{\\text{bAP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{d,bAP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{r,bAP}}}\\right)\\right] H(t-t_{\\text{post}}),$$\nwhere $H(x)$ is the Heaviside function defined as $H(x)=0$ for $x0$ and $H(x)=1$ for $x\\ge 0$. Use $V_{\\text{rest}}=-70\\,\\text{mV}$, $A_{\\text{EPSP}}=5\\,\\text{mV}$, $\\tau_{\\text{r,EPSP}}=1\\,\\text{ms}$, $\\tau_{\\text{d,EPSP}}=15\\,\\text{ms}$, $A_{\\text{bAP}}=100\\,\\text{mV}$, $\\tau_{\\text{r,bAP}}=0.5\\,\\text{ms}$, and $\\tau_{\\text{d,bAP}}=2\\,\\text{ms}$.\n- NMDA conductance:\n$$g_{\\text{NMDA}}(t) = g_0 \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,NMDA}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,NMDA}}}\\right)\\right] H(t-t_{\\text{pre}}),$$\nwith $\\tau_{\\text{r,NMDA}}=4\\,\\text{ms}$ and $\\tau_{\\text{d,NMDA}}=80\\,\\text{ms}$. The scale parameter $g_0$ is in $\\text{nS}$.\n- Magnesium block (Jahr-Stevens form):\n$$s(V)=\\frac{1}{1+\\left(\\frac{[\\text{Mg}^{2+}]}{3.57}\\right)\\exp\\!\\left(-0.062\\,V\\right)},$$\nwhere $[\\text{Mg}^{2+}]$ is in $\\text{mM}$ and $V$ is in $\\text{mV}$.\n- Reversal potential and calcium fraction: $E_{\\text{NMDA}}=0\\,\\text{mV}$ and $f_{\\text{Ca}}=0.1$ (dimensionless decimal fraction).\n- Units: $g_{\\text{NMDA}}$ in $\\text{nS}$, $V$ and $E_{\\text{NMDA}}$ in $\\text{mV}$, so $I_{\\text{NMDA}}$ and $I_{\\text{Ca}}$ are in $\\text{pA}$, since $1\\,\\text{nS}\\cdot 1\\,\\text{mV} = 1\\,\\text{pA}$.\n\nCompute $I_{\\text{Ca}}(t)$ at the following sampling times (in milliseconds): $t\\in\\{0,2,5,10,12,20,40,80,160\\}$. Report the values in picoamperes as signed decimal floats, rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$: $\\Delta t=10\\,\\text{ms}$, $[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$, $g_0=1.0\\,\\text{nS}$.\n- Case $2$: $\\Delta t=10\\,\\text{ms}$, $[\\text{Mg}^{2+}]=2.0\\,\\text{mM}$, $g_0=1.0\\,\\text{nS}$.\n- Case $3$: $\\Delta t=2\\,\\text{ms}$, $[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$, $g_0=1.0\\,\\text{nS}$.\n- Case $4$: $\\Delta t=10\\,\\text{ms}$, $[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$, $g_0=0.3\\,\\text{nS}$.\n- Case $5$: $\\Delta t=80\\,\\text{ms}$, $[\\text{Mg}^{2+}]=1.0\\,\\text{mM}$, $g_0=1.0\\,\\text{nS}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one list per test case, each inner list containing the nine rounded values of $I_{\\text{Ca}}(t)$ at the specified sampling times, in picoamperes. For example, the exact required format is\n$$\\texttt{[[v\\_1\\_1,v\\_1\\_2,\\dots,v\\_1\\_9],[v\\_2\\_1,\\dots,v\\_2\\_9],\\dots,[v\\_5\\_1,\\dots,v\\_5\\_9]]}$$\nwith no additional whitespace beyond commas and brackets.",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard computational problem in cellular neuroscience. We will now proceed with the solution.\n\nThe objective is to compute the calcium current, $I_{\\text{Ca}}(t)$, which flows through N-methyl-D-aspartate (NMDA) receptors at specified time points under a pre-before-post spike pairing protocol. The calculation is based on a set of biophysically motivated equations and parameters.\n\nThe logical procedure to determine $I_{\\text{Ca}}$ at any given time $t$ is as follows:\n$1$. Determine the postsynaptic membrane voltage $V(t)$.\n$2$. Determine the NMDA receptor conductance $g_{\\text{NMDA}}(t)$.\n$3$. Using $V(t)$, calculate the voltage-dependent magnesium block fraction, $s(V(t))$.\n$4$. Combine these components to calculate the total NMDA current, $I_{\\text{NMDA}}(t)$.\n$5$. Finally, determine the calcium current $I_{\\text{Ca}}(t)$ as a constant fraction of $I_{\\text{NMDA}}(t)$.\n\nWe will now detail each step. All parameters are taken from the problem statement.\n\nStep 1: Postsynaptic Voltage, $V(t)$\nThe postsynaptic voltage $V(t)$ is the linear superposition of the resting potential, an excitatory postsynaptic potential (EPSP) initiated by a presynaptic event at $t_{\\text{pre}} = 0\\,\\text{ms}$, and a back-propagating action potential (bAP) initiated at $t_{\\text{post}} = \\Delta t$. The equation is:\n$$V(t) = V_{\\text{rest}} + V_{\\text{EPSP}}(t) + V_{\\text{bAP}}(t)$$\nwhere the components are given by:\n$$V_{\\text{EPSP}}(t) = A_{\\text{EPSP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,EPSP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,EPSP}}}\\right)\\right] H(t-t_{\\text{pre}})$$\n$$V_{\\text{bAP}}(t) = A_{\\text{bAP}} \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{d,bAP}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{post}}}{\\tau_{\\text{r,bAP}}}\\right)\\right] H(t-t_{\\text{post}})$$\nThe function $H(x)$ is the Heaviside step function, which is $1$ for $x \\ge 0$ and $0$ for $x  0$. It ensures causality, meaning the potentials only appear after their respective trigger events. The parameters are:\n- Resting potential: $V_{\\text{rest}}=-70\\,\\text{mV}$\n- EPSP amplitude: $A_{\\text{EPSP}}=5\\,\\text{mV}$\n- EPSP rise time constant: $\\tau_{\\text{r,EPSP}}=1\\,\\text{ms}$\n- EPSP decay time constant: $\\tau_{\\text{d,EPSP}}=15\\,\\text{ms}$\n- bAP amplitude: $A_{\\text{bAP}}=100\\,\\text{mV}$\n- bAP rise time constant: $\\tau_{\\text{r,bAP}}=0.5\\,\\text{ms}$\n- bAP decay time constant: $\\tau_{\\text{d,bAP}}=2\\,\\text{ms}$\n- Presynaptic time: $t_{\\text{pre}}=0\\,\\text{ms}$\n- Postsynaptic time: $t_{\\text{post}}=\\Delta t$\n\nStep 2: NMDA Conductance, $g_{\\text{NMDA}}(t)$\nThe NMDA receptor conductance is activated by the presynaptic event at $t_{\\text{pre}}=0\\,\\text{ms}$ and follows a dual-exponential time course:\n$$g_{\\text{NMDA}}(t) = g_0 \\left[\\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{d,NMDA}}}\\right) - \\exp\\!\\left(-\\frac{t-t_{\\text{pre}}}{\\tau_{\\text{r,NMDA}}}\\right)\\right] H(t-t_{\\text{pre}})$$\nThe parameters are:\n- Peak conductance scaling factor: $g_0$ (in $\\text{nS}$)\n- NMDA rise time constant: $\\tau_{\\text{r,NMDA}}=4\\,\\text{ms}$\n- NMDA decay time constant: $\\tau_{\\text{d,NMDA}}=80\\,\\text{ms}$\n\nStep 3: Magnesium Block, $s(V)$\nThe NMDA receptor channel is blocked by magnesium ions in a voltage-dependent manner. This is described by the Jahr-Stevens model:\n$$s(V)=\\frac{1}{1+\\left(\\frac{[\\text{Mg}^{2+}]}{K_{\\text{Mg}}}\\right)\\exp\\!\\left(-\\gamma\\,V\\right)}$$\nThe term $s(V)$ represents the fraction of channels that are unblocked. The parameters are:\n- External magnesium concentration: $[\\text{Mg}^{2+}]$ (in $\\text{mM}$)\n- Magnesium dissociation constant at $0\\,\\text{mV}$: $K_{\\text{Mg}} = 3.57\\,\\text{mM}$\n- Voltage dependence factor: $\\gamma = 0.062\\,\\text{mV}^{-1}$\nThe voltage $V$ in this expression is the instantaneous membrane potential $V(t)$ in millivolts.\n\nStep 4: Total NMDA Current, $I_{\\text{NMDA}}(t)$\nThe total ionic current flowing through the NMDA receptors is given by the conductance-based model:\n$$I_{\\text{NMDA}}(t) = g_{\\text{NMDA}}(t)\\, s\\!\\left(V(t)\\right)\\,\\left(V(t)-E_{\\text{NMDA}}\\right)$$\nThis equation combines the time-varying conductance, the voltage-dependent unblocking, and the electrochemical driving force $(V(t)-E_{\\text{NMDA}})$. The NMDA reversal potential is given as $E_{\\text{NMDA}}=0\\,\\text{mV}$. The units are consistent: $I_{\\text{NMDA}} [\\text{pA}] = g_{\\text{NMDA}} [\\text{nS}] \\times V [\\text{mV}]$.\n\nStep 5: Calcium Current, $I_{\\text{Ca}}(t)$\nA constant fraction, $f_{\\text{Ca}}$, of the total NMDA receptor current is carried by calcium ions.\n$$I_{\\text{Ca}}(t) = f_{\\text{Ca}}\\, I_{\\text{NMDA}}(t)$$\nThe specified calcium fraction is $f_{\\text{Ca}}=0.1$. The resulting $I_{\\text{Ca}}(t)$ will be in picoamperes ($\\text{pA}$).\n\nThe computational algorithm will implement these five steps. For each test case, the parameters $\\Delta t$, $[\\text{Mg}^{2+}]$, and $g_0$ are specified. For each required sampling time $t \\in \\{0, 2, 5, 10, 12, 20, 40, 80, 160\\}\\,\\text{ms}$, the program will sequentially calculate $V(t)$, $g_{\\text{NMDA}}(t)$, $s(V(t))$, $I_{\\text{NMDA}}(t)$, and finally $I_{\\text{Ca}}(t)$, which is rounded to $6$ decimal places as required. The negative sign for the current indicates an inward flow of positive charge (cations entering the cell).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the NMDA-mediated calcium current time course for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Delta_t [ms], Mg2_conc [mM], g0 [nS])\n        (10.0, 1.0, 1.0),  # Case 1\n        (10.0, 2.0, 1.0),  # Case 2\n        (2.0, 1.0, 1.0),   # Case 3\n        (10.0, 1.0, 0.3),  # Case 4\n        (80.0, 1.0, 1.0),  # Case 5\n    ]\n    \n    # Fixed parameters\n    V_rest = -70.0  # mV\n    A_EPSP = 5.0    # mV\n    tau_r_EPSP = 1.0  # ms\n    tau_d_EPSP = 15.0 # ms\n    A_bAP = 100.0   # mV\n    tau_r_bAP = 0.5   # ms\n    tau_d_bAP = 2.0   # ms\n    \n    tau_r_NMDA = 4.0  # ms\n    tau_d_NMDA = 80.0 # ms\n    \n    E_NMDA = 0.0    # mV\n    f_Ca = 0.1      # dimensionless\n    \n    mg_K = 3.57     # mM\n    mg_gamma = 0.062 # 1/mV\n    \n    t_pre = 0.0     # ms\n    \n    # Sampling times\n    t_samples = [0.0, 2.0, 5.0, 10.0, 12.0, 20.0, 40.0, 80.0, 160.0]\n\n    all_results = []\n    \n    # Heaviside step function\n    def H(x):\n        return 1.0 if x >= 0 else 0.0\n\n    for case in test_cases:\n        delta_t, mg_conc, g0 = case\n        t_post = delta_t\n        \n        results_for_case = []\n        for t in t_samples:\n            # Step 1: Calculate postsynaptic voltage V(t)\n            # EPSP component\n            dt_epsp = t - t_pre\n            V_epsp = A_EPSP * (np.exp(-dt_epsp / tau_d_EPSP) - np.exp(-dt_epsp / tau_r_EPSP)) * H(dt_epsp)\n            \n            # bAP component\n            dt_bap = t - t_post\n            V_bap = A_bAP * (np.exp(-dt_bap / tau_d_bAP) - np.exp(-dt_bap / tau_r_bAP)) * H(dt_bap)\n            \n            V_t = V_rest + V_epsp + V_bap\n            \n            # Step 2: Calculate NMDA conductance g_NMDA(t)\n            dt_nmda = t - t_pre\n            g_nmda_t = g0 * (np.exp(-dt_nmda / tau_d_NMDA) - np.exp(-dt_nmda / tau_r_NMDA)) * H(dt_nmda)\n            \n            # Step 3: Calculate magnesium block s(V)\n            s_V = 1.0 / (1.0 + (mg_conc / mg_K) * np.exp(-mg_gamma * V_t))\n            \n            # Step 4: Calculate total NMDA current I_NMDA(t)\n            I_nmda_t = g_nmda_t * s_V * (V_t - E_NMDA)\n            \n            # Step 5: Calculate calcium current I_Ca(t)\n            I_ca_t = f_Ca * I_nmda_t\n            \n            # Round to 6 decimal places and store\n            results_for_case.append(round(I_ca_t, 6))\n            \n        all_results.append(results_for_case)\n\n    # Format the final output string as specified\n    case_strings = [f\"[{','.join(map(str, case_res))}]\" for case_res in all_results]\n    final_output_string = f\"[{','.join(case_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}