{
    "hands_on_practices": [
        {
            "introduction": "Before exploring complex spiking patterns, we must first understand the fundamental condition for a neuron to fire at all. The minimum constant input current required to elicit a spike, known as the rheobase current, marks a critical transition in the neuron's dynamical landscape. This exercise  will guide you through a stability analysis of the AdEx model's subthreshold dynamics to derive an analytical expression for the rheobase, connecting the mathematical theory of bifurcations to a core physiological property.",
            "id": "4034142",
            "problem": "Consider the Adaptive Exponential Integrate-and-Fire (AdEx) neuron model driven by a constant input current. The state variables are the membrane potential $V$ and the adaptation current $w$. The membrane equation is defined by the capacitance $C$, the leak conductance $g_L$, the leak reversal potential $E_L$, an exponential spike-initiation term characterized by slope factor $\\Delta_T$ and threshold parameter $V_T$, and the input current $I_0$. The adaptation dynamics are linear with subthreshold adaptation parameter $a$ and time constant $\\tau_w$. The reset and spike emission mechanism are not used; instead, focus on fixed points of the continuous dynamics and their stability. For a constant input $I_0$, the system is\n$$\nC \\,\\frac{dV}{dt} \\;=\\; -\\,g_L \\,\\big(V - E_L\\big) \\;+\\; g_L \\,\\Delta_T \\,\\exp\\!\\Big(\\frac{V - V_T}{\\Delta_T}\\Big) \\;-\\; w \\;+\\; I_0,\n$$\n$$\n\\tau_w \\,\\frac{dw}{dt} \\;=\\; a \\,\\big(V - E_L\\big) \\;-\\; w.\n$$\nStarting from first principles of fixed-point existence and linear stability for dynamical systems, derive an analytic expression for the rheobase current $I_{rheo}$, defined as the lowest constant input $I_0$ at which the fixed point of the subthreshold dynamics loses stability or disappears as $I_0$ is increased.\n\nThen, using your derived expression, evaluate $I_{rheo}$ for the parameter set\n- $C = 200\\,\\text{pF}$,\n- $g_L = 10\\,\\text{nS}$,\n- $E_L = -70\\,\\text{mV}$,\n- $V_T = -50\\,\\text{mV}$,\n- $\\Delta_T = 2\\,\\text{mV}$,\n- $a = 2\\,\\text{nS}$,\n- $\\tau_w = 100\\,\\text{ms}$.\n\nExpress the final current in nanoamperes (nA). Round your answer to four significant figures.",
            "solution": "The problem is valid as it is a standard exercise in the stability analysis of neuron models, grounded in the theory of dynamical systems. The provided equations and parameters are consistent and scientifically sound.\n\nThe fixed points $(V^*, w^*)$ of the system are found by setting the time derivatives to zero, $\\frac{dV}{dt} = 0$ and $\\frac{dw}{dt} = 0$.\nThe equation for the adaptation current gives the $w$-nullcline:\n$$ \\tau_w \\frac{dw}{dt} = 0 \\quad\\implies\\quad a(V^* - E_L) - w^* = 0 \\quad\\implies\\quad w^* = a(V^* - E_L) $$\nThe equation for the membrane potential gives the $V$-nullcline:\n$$ C \\frac{dV}{dt} = 0 \\quad\\implies\\quad -g_L(V^* - E_L) + g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) - w^* + I_0 = 0 $$\nSubstituting $w^*$ into the $V$-nullcline equation yields an equation for the fixed-point voltage $V^*$ as a function of the input current $I_0$:\n$$ -g_L(V^* - E_L) + g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) - a(V^* - E_L) + I_0 = 0 $$\nWe can express the current $I_0$ as a function of the fixed-point voltage $V^*$:\n$$ I_0(V^*) = (g_L + a)(V^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) $$\nThe rheobase current $I_{rheo}$ corresponds to the value of $I_0$ at which the stable fixed point disappears. This occurs at a saddle-node bifurcation, where two fixed points (one stable, one unstable) merge and annihilate. This bifurcation point corresponds to a local extremum of the function $I_0(V^*)$. We find this by setting the derivative of $I_0(V^*)$ with respect to $V^*$ to zero. Let $V_c^*$ be the voltage at this critical point.\n$$ \\frac{dI_0}{dV^*} \\bigg|_{V^*=V_c^*} = \\frac{d}{dV^*} \\left[ (g_L + a)(V^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) \\right] = 0 $$\n$$ (g_L + a) - g_L \\Delta_T \\cdot \\frac{1}{\\Delta_T} \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) = 0 $$\n$$ (g_L + a) = g_L \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) $$\nSolving for $V_c^*$:\n$$ \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) = \\frac{g_L + a}{g_L} = 1 + \\frac{a}{g_L} $$\n$$ V_c^* = V_T + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) $$\nThe rheobase current $I_{rheo}$ is the value of $I_0(V^*)$ evaluated at $V_c^*$:\n$$ I_{rheo} = I_0(V_c^*) = (g_L + a)(V_c^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) $$\nUsing the bifurcation condition $g_L \\exp(\\dots) = g_L + a$, we substitute this into the expression for $I_{rheo}$:\n$$ I_{rheo} = (g_L + a)(V_c^* - E_L) - (g_L + a)\\Delta_T = (g_L + a)(V_c^* - E_L - \\Delta_T) $$\nSubstituting the expression for $V_c^*$, we obtain the final analytical formula:\n$$ I_{rheo} = (g_L + a) \\left[ \\left(V_T + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right)\\right) - E_L - \\Delta_T \\right] $$\n$$ I_{rheo} = (g_L + a) \\left[ (V_T - E_L - \\Delta_T) + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) \\right] $$\nNow, we evaluate this expression using the given parameters:\n$g_L = 10 \\times 10^{-9}\\,\\text{S}$\n$a = 2 \\times 10^{-9}\\,\\text{S}$\n$V_T = -50 \\times 10^{-3}\\,\\text{V}$\n$E_L = -70 \\times 10^{-3}\\,\\text{V}$\n$\\Delta_T = 2 \\times 10^{-3}\\,\\text{V}$\n\nFirst, we calculate the components of the formula:\n$$ g_L + a = 10\\,\\text{nS} + 2\\,\\text{nS} = 12\\,\\text{nS} = 12 \\times 10^{-9}\\,\\text{S} $$\n$$ V_T - E_L - \\Delta_T = (-50 \\times 10^{-3}\\,\\text{V}) - (-70 \\times 10^{-3}\\,\\text{V}) - (2 \\times 10^{-3}\\,\\text{V}) = 18 \\times 10^{-3}\\,\\text{V} $$\n$$ 1 + \\frac{a}{g_L} = 1 + \\frac{2\\,\\text{nS}}{10\\,\\text{nS}} = 1.2 $$\n$$ \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) = (2 \\times 10^{-3}\\,\\text{V}) \\ln(1.2) $$\nSubstituting these into the expression for $I_{rheo}$:\n$$ I_{rheo} = (12 \\times 10^{-9}\\,\\text{S}) \\left[ (18 \\times 10^{-3}\\,\\text{V}) + (2 \\times 10^{-3}\\,\\text{V}) \\ln(1.2) \\right] $$\n$$ I_{rheo} = (12 \\times 10^{-9}\\,\\text{S}) \\cdot (10^{-3}\\,\\text{V}) \\cdot \\left[ 18 + 2 \\ln(1.2) \\right] $$\nUsing $\\ln(1.2) \\approx 0.1823215568$:\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot \\left[ 18 + 2 \\times 0.1823215568 \\right] $$\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot \\left[ 18 + 0.3646431136 \\right] $$\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot 18.3646431136 $$\n$$ I_{rheo} \\approx 220.37571736 \\times 10^{-12}\\,\\text{A} = 220.37571736\\,\\text{pA} $$\nTo express the answer in nanoamperes (nA), we divide by $1000$:\n$$ I_{rheo} \\approx 0.22037571736\\,\\text{nA} $$\nRounding to four significant figures, we get:\n$$ I_{rheo} \\approx 0.2204\\,\\text{nA} $$",
            "answer": "$$\n\\boxed{0.2204}\n$$"
        },
        {
            "introduction": "The key feature of the AdEx model is its capacity to replicate spike-frequency adaptation, a common characteristic of biological neurons where the firing rate decreases over time in response to a constant stimulus. This behavior arises from the interaction between the fast membrane potential and the slow, accumulating adaptation current. In this practice , you will build a numerical simulation to bring the AdEx equations to life, allowing you to observe and quantify adaptation directly and gain intuition for how model parameters shape the dynamic output.",
            "id": "4034174",
            "problem": "A single-compartment neuron is modeled by the Adaptive Exponential Integrate-and-Fire (AdEx) dynamics, a standard formulation in neuromorphic and brain-inspired computing. The AdEx model combines an exponential membrane nonlinearity with an adaptation current to capture spike-frequency adaptation. Consider the following governing equations based on Kirchhoff’s current law for a leaky capacitor driven by currents:\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V - E_L) \\;+\\; g_L\\,\\Delta_T\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) \\;-\\; w \\;+\\; I(t),\n$$\n$$\n\\tau_w\\,\\frac{dw}{dt} \\;=\\; a\\,(V - E_L) \\;-\\; w,\n$$\nwith a spike-generation and reset rule: whenever $V$ crosses a spike detection threshold, an output spike is registered, the membrane potential $V$ is reset to $V_r$, the adaptation variable is incremented as $w \\leftarrow w + b$, and a brief absolute refractory period $\\tau_{\\mathrm{ref}}$ holds $V$ fixed at $V_r$ while $w$ continues to evolve. The step input is $I(t) = I_0$ for $t \\ge 0$ and $I(t) = 0$ for $t  0$.\n\nAll quantities must be treated with the following units to ensure dimensional consistency in numerical simulation: membrane potential $V$ in millivolts (mV), time $t$ in milliseconds (ms), capacitance $C$ in nanofarads (nF), leak conductance $g_L$ in nanosiemens (nS), and currents $I$ and $w$ in nanoamperes (nA). These units satisfy that $C\\,dV/dt$ is in nA when $dV/dt$ is in mV/ms, and $g_L(V-E_L)$ is in nA when $V$ is in mV.\n\nYou must design a program that numerically integrates these equations under a constant step input to quantify spike-frequency adaptation as the ratio of the first-interval frequency to the steady-state frequency. The required output is a single line containing this ratio for each test case. Use the following fixed biophysical parameters, chosen to be physiologically plausible and internally consistent:\n- Capacitance $C = 0.2$ nF,\n- Leak conductance $g_L = 10$ nS,\n- Leak reversal $E_L = -70$ mV,\n- Exponential slope $\\Delta_T = 2$ mV,\n- Effective spike detection level $V_{\\mathrm{spike}} = 20$ mV,\n- Spike threshold parameter $V_T = -50$ mV,\n- Reset potential $V_r = -58$ mV,\n- Refractory period $\\tau_{\\mathrm{ref}} = 2$ ms,\n- Step amplitude $I_0 = 1.2$ nA,\n- Simulation time step $\\Delta t = 0.05$ ms,\n- Total simulation duration $T_{\\mathrm{end}} = 2000$ ms.\n\nInitial conditions are $V(0) = E_L$ and $w(0) = 0$.\n\nDefinition of the measured quantities:\n- The spike times are the times at which $V$ crosses $V_{\\mathrm{spike}}$ prior to reset. The inter-spike intervals (ISIs) are the successive differences between spike times expressed in milliseconds.\n- The first-interval frequency is defined as $f_1 = 1000 / \\mathrm{ISI}_1$ in Hertz, where $\\mathrm{ISI}_1$ is the interval between the first and second spike after $t = 0$.\n- The steady-state frequency is defined as $f_{\\mathrm{ss}} = 1000 / \\overline{\\mathrm{ISI}}$ in Hertz, where $\\overline{\\mathrm{ISI}}$ is the arithmetic mean of the last $K$ ISIs whose second spike time falls within the final $W$ milliseconds of the simulation. Use $K = 10$ and $W = 600$ ms. If fewer than $K$ such ISIs exist, average all available ISIs in that window. If none exist but at least $10$ ISIs occurred during the entire run, average the last $10$ ISIs; if fewer than $2$ spikes occurred in total, set the ratio to $\\mathrm{NaN}$.\n- The adaptation ratio to be reported is $R = f_1 / f_{\\mathrm{ss}}$ (dimensionless).\n\nImplement a forward-Euler numerical integrator with the above units to advance the state, enforce the spike/reset rule and refractory period, and record spike times. Your program should produce a single line of output containing the ratios for the provided test suite as a comma-separated list enclosed in square brackets.\n\nTest suite of parameter triples ($a, \\tau_w, b$) to run:\n1. ($a = 2\\ \\mathrm{nS},\\ \\tau_w = 200\\ \\mathrm{ms},\\ b = 0.05\\ \\mathrm{nA}$),\n2. ($a = 0\\ \\mathrm{nS},\\ \\tau_w = 200\\ \\mathrm{ms},\\ b = 0.0\\ \\mathrm{nA}$),\n3. ($a = 4\\ \\mathrm{nS},\\ \\tau_w = 500\\ \\mathrm{ms},\\ b = 0.2\\ \\mathrm{nA}$),\n4. ($a = 1\\ \\mathrm{nS},\\ \\tau_w = 50\\ \\mathrm{ms},\\ b = 0.1\\ \\mathrm{nA})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each $r_i$ is the ratio $R$ for the corresponding test case, expressed as a float. Frequencies must be internally computed in Hertz (Hz), and the final ratios are dimensionless floats; if a ratio is undefined due to insufficient spikes as specified above, output $\\mathrm{NaN}$ for that entry.",
            "solution": "The Adaptive Exponential Integrate-and-Fire (AdEx) model derives from Kirchhoff’s current law applied to a leaky capacitor representing the neuronal membrane. The fundamental base is the conservation of current at the membrane: the capacitive current $C\\,dV/dt$ equals the sum of ionic and input currents. The AdEx membrane equation augments the linear leak with an exponential term to capture the sharp onset of spikes, and an adaptation current $w$ that evolves according to a first-order linear differential equation driven by the membrane potential.\n\nStarting point: the physical law $C\\,\\frac{dV}{dt} = I_{\\mathrm{leak}} + I_{\\mathrm{exp}} - I_{\\mathrm{adapt}} + I_{\\mathrm{ext}}$, where:\n- $I_{\\mathrm{leak}} = -g_L\\,(V - E_L)$ is Ohm’s law for the leak,\n- $I_{\\mathrm{exp}} = g_L\\,\\Delta_T\\,\\exp\\!\\big((V-V_T)/\\Delta_T\\big)$ provides the exponential spike initiation nonlinearity,\n- $I_{\\mathrm{adapt}} = w$ is a dynamic current opposing depolarization,\n- $I_{\\mathrm{ext}} = I(t)$ is the external stimulus.\n\nThe adaptation dynamics follow a linear differential equation consistent with a conductance-like coupling parameter $a$ and time constant $\\tau_w$: $\\tau_w\\,\\frac{dw}{dt} = a\\,(V - E_L) - w$. The term $a\\,(V - E_L)$ couples voltage to adaptation; the negative $w$ term implements relaxation. Empirically, spike emission triggers an increment $b$ in $w$, modeling spike-triggered adaptation, and $V$ is reset to $V_r$ with a refractory interval $\\tau_{\\mathrm{ref}}$ during which $V$ remains clamped at $V_r$. These rules are standard in integrate-and-fire models to produce well-defined spike times.\n\nTo compute spike-frequency adaptation, we quantify the ratio $R = f_1 / f_{\\mathrm{ss}}$, where $f_1$ is the frequency inferred from the first inter-spike interval and $f_{\\mathrm{ss}}$ is the steady-state frequency inferred from late ISIs once transients have decayed.\n\nAlgorithmic design via forward-Euler discretization:\n1. Units and scaling: choose $V$ in millivolts (mV), $t$ in milliseconds (ms), $C$ in nanofarads (nF), $g_L$ in nanosiemens (nS), $I$ and $w$ in nanoamperes (nA). This choice ensures dimensional consistency without additional scaling factors because $1\\ \\mathrm{nF}\\cdot 1\\ \\mathrm{mV}/1\\ \\mathrm{ms} = 1\\ \\mathrm{nA}$ and $1\\ \\mathrm{nS}\\cdot 1\\ \\mathrm{mV} = 1\\ \\mathrm{nA}$.\n2. Numerical integration: approximate time derivatives by forward differences. For a time step $\\Delta t$, update\n$$\nV_{n+1} \\;=\\; V_n \\;+\\; \\frac{\\Delta t}{C}\\,\\Big(\\,-g_L\\,(V_n - E_L) \\;+\\; g_L\\,\\Delta_T\\,\\exp\\!\\big(\\tfrac{V_n - V_T}{\\Delta_T}\\big) \\;-\\; w_n \\;+\\; I_0 \\Big),\n$$\n$$\nw_{n+1} \\;=\\; w_n \\;+\\; \\frac{\\Delta t}{\\tau_w}\\,\\Big(a\\,(V_n - E_L) \\;-\\; w_n\\Big),\n$$\nprovided no spike/reset occurs at step $n$. During the absolute refractory period, enforce $V_{n+1} = V_r$ while continuing to update $w$ using $V_n = V_r$ in the right-hand side of the $w$-update.\n3. Spike detection and reset: after updating $V$, check if $V_{n+1} \\ge V_{\\mathrm{spike}}$. If so, register a spike at time $t_{n+1}$, set $V_{n+1} \\leftarrow V_r$, increment $w_{n+1} \\leftarrow w_{n+1} + b$, and set a refractory counter to $\\tau_{\\mathrm{ref}}$ during which $V$ remains at $V_r$ and only $w$ evolves. With the chosen exponential term, a hard spike detection threshold is a practical surrogate for the rapid upstroke.\n4. Spike time recording: collect the times $\\{t_i\\}$ when threshold crossings occur. Compute inter-spike intervals as $\\mathrm{ISI}_i = t_{i+1} - t_i$ in milliseconds.\n5. Frequency computation: set $f_1 = 1000 / \\mathrm{ISI}_1$ in Hertz if at least two spikes occurred. For steady-state frequency, consider ISIs whose second spike time $t_{i+1}$ falls within the final window of $W$ milliseconds before $T_{\\mathrm{end}}$. Average up to $K$ of the most recent such ISIs; if none are in the final window but there are at least $10$ ISIs overall, average the last $10$ ISIs; if fewer than $2$ spikes occurred, the ratio is undefined and reported as $\\mathrm{NaN}$. Compute $f_{\\mathrm{ss}} = 1000 / \\overline{\\mathrm{ISI}}$ in Hertz. Finally, compute the dimensionless ratio $R = f_1 / f_{\\mathrm{ss}}$.\n6. Edge-case handling: avoid double-counting spikes by enforcing an absolute refractory period; ensure the exponential term is evaluated at each step; handle insufficient spikes as specified.\n\nScientific rationale: The first inter-spike interval reflects the initial responsiveness of the neuron under a step input before adaptation has built up. The steady-state frequency reflects the long-term firing rate once $w$ has equilibrated under constant drive. The ratio $R$ quantifies spike-frequency adaptation: $R  1$ indicates that the neuron fires faster initially than in steady state; $R \\approx 1$ indicates minimal adaptation.\n\nImplementation details for the test suite:\n- Fixed biophysical parameters: $C = 0.2\\ \\mathrm{nF}$, $g_L = 10\\ \\mathrm{nS}$, $E_L = -70\\ \\mathrm{mV}$, $\\Delta_T = 2\\ \\mathrm{mV}$, $V_T = -50\\ \\mathrm{mV}$, $V_{\\mathrm{spike}} = 20\\ \\mathrm{mV}$, $V_r = -58\\ \\mathrm{mV}$, $\\tau_{\\mathrm{ref}} = 2\\ \\mathrm{ms}$, $I_0 = 1.2\\ \\mathrm{nA}$, $\\Delta t = 0.05\\ \\mathrm{ms}$, $T_{\\mathrm{end}} = 2000\\ \\mathrm{ms}$, final window $W = 600\\ \\mathrm{ms}$, and maximum trailing ISIs $K = 10$.\n- Parameter triples ($a, \\tau_w, b$) for the four cases are specified in the problem. The numerical integration produces spike trains robustly with these parameters, enabling the computation of $R$ for each case.\n\nThe program will execute the simulation for each test case, compute the adaptation ratio, and print a single line in the required aggregate format: a bracketed, comma-separated list of floats \"[r1,r2,r3,r4]\".",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_adex_ratio(a_nS, tau_w_ms, b_nA,\n                        C_nF=0.2, gL_nS=10.0, EL_mV=-70.0, DeltaT_mV=2.0,\n                        VT_mV=-50.0, V_spike_mV=20.0, V_reset_mV=-58.0,\n                        tau_ref_ms=2.0, I0_nA=1.2, dt_ms=0.05, T_end_ms=2000.0,\n                        window_ms=600.0, K_tail=10):\n    \"\"\"\n    Simulate the AdEx neuron and compute adaptation ratio R = f1 / f_ss.\n\n    Units:\n      - V in mV, t in ms, C in nF, gL in nS, I and w in nA.\n    \"\"\"\n\n    # Time setup\n    n_steps = int(np.round(T_end_ms / dt_ms))\n    t = 0.0\n\n    # State variables\n    V = EL_mV\n    w = 0.0\n    ref_time_left = 0.0\n\n    spike_times = []\n\n    # Simulation loop\n    for step in range(n_steps):\n        # During refractory: hold V at reset, update w using V_reset\n        if ref_time_left  0.0:\n            # Update w during refractory\n            dw = (dt_ms / tau_w_ms) * (a_nS * (V_reset_mV - EL_mV) - w)\n            w += dw\n            V = V_reset_mV\n            ref_time_left = max(0.0, ref_time_left - dt_ms)\n            t += dt_ms\n            continue\n\n        # Compute membrane equation with forward Euler\n        # Currents (nA): -gL*(V-EL) + gL*DeltaT*exp((V-VT)/DeltaT) - w + I0\n        I_leak = -gL_nS * (V - EL_mV)\n        I_exp = gL_nS * DeltaT_mV * np.exp((V - VT_mV) / DeltaT_mV)\n        I_total = I_leak + I_exp - w + I0_nA\n\n        dV = (dt_ms / C_nF) * I_total\n        V_next = V + dV\n\n        # Update adaptation variable w (forward Euler, using current V)\n        dw = (dt_ms / tau_w_ms) * (a_nS * (V - EL_mV) - w)\n        w_next = w + dw\n\n        # Spike detection after update\n        if V_next = V_spike_mV:\n            # Register spike at time t + dt_ms (end of step)\n            spike_time = t + dt_ms\n            spike_times.append(spike_time)\n            # Reset and refractory\n            V = V_reset_mV\n            w = w_next + b_nA\n            ref_time_left = tau_ref_ms\n            t += dt_ms\n            continue\n        else:\n            V = V_next\n            w = w_next\n            t += dt_ms\n\n    # Compute inter-spike intervals (ISIs) in ms\n    spike_times = np.array(spike_times, dtype=float)\n    if spike_times.size  2:\n        return float('nan')\n    isis = np.diff(spike_times)\n\n    # First-interval frequency f1 in Hz\n    isi1_ms = isis[0]\n    f1_hz = 1000.0 / isi1_ms if isi1_ms  0.0 else float('nan')\n\n    # Steady-state frequency: average of last K_tail ISIs with second spike time in final window\n    # Identify ISIs by their ending spike times t_{i+1}\n    end_times = spike_times[1:]\n    in_window = end_times = (T_end_ms - window_ms)\n    tail_isis = isis[in_window]\n    if tail_isis.size == 0:\n        # If none in window, but at least 10 ISIs total, take last 10 ISIs\n        if isis.size = 10:\n            tail_isis = isis[-10:]\n        else:\n            # If fewer than 10, take all available ISIs beyond the first (to avoid initial transient bias)\n            tail_isis = isis[-min(isis.size, K_tail):]\n    else:\n        # If more than K_tail in window, take the last K_tail\n        if tail_isis.size  K_tail:\n            tail_isis = tail_isis[-K_tail:]\n\n    if tail_isis.size == 0:\n        return float('nan')\n\n    mean_tail_isi_ms = float(np.mean(tail_isis))\n    fss_hz = 1000.0 / mean_tail_isi_ms if mean_tail_isi_ms  0.0 else float('nan')\n\n    if not np.isfinite(f1_hz) or not np.isfinite(fss_hz) or fss_hz == 0.0:\n        return float('nan')\n\n    R = f1_hz / fss_hz\n    return float(R)\n\ndef solve():\n    # Define the test cases from the problem statement: (a (nS), tau_w (ms), b (nA))\n    test_cases = [\n        (2.0, 200.0, 0.05),\n        (0.0, 200.0, 0.0),\n        (4.0, 500.0, 0.2),\n        (1.0, 50.0, 0.1),\n    ]\n\n    results = []\n    for a, tauw, b in test_cases:\n        ratio = simulate_adex_ratio(a_nS=a, tau_w_ms=tauw, b_nA=b)\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    # Convert floats to string, preserving 'nan' if present.\n    def fmt(x):\n        if np.isnan(x):\n            return \"nan\"\n        else:\n            return repr(float(x))\n    print(f\"[{','.join(fmt(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A model's true power lies in its ability to be connected to real-world measurements. The AdEx model includes two distinct forms of adaptation: a continuous, subthreshold coupling ($a$) and a discrete, spike-triggered increment ($b$). This final practice challenges you to think like an experimentalist: how can you design an input protocol to disentangle these two parameters from observable voltage traces? This thought experiment  will solidify your understanding of each parameter's specific role by forcing you to devise a strategy to isolate its effects.",
            "id": "4034117",
            "problem": "Consider a neuron or a neuromorphic element governed by the adaptive exponential integrate-and-fire (AdEx) model, where the adaptive exponential integrate-and-fire (AdEx) model is specified by the membrane equation and the adaptation dynamics. Let the membrane potential be denoted by $V(t)$, the membrane capacitance by $C$, the leak conductance by $g_L$, the leak reversal potential by $E_L$, the effective spike slope factor by $\\Delta_T$, and the threshold voltage parameter by $V_T$. The adaptation current is denoted by $w(t)$, with an adaptation time constant $\\tau_w$, a subthreshold coupling coefficient $a$, and a spike-triggered increment $b$. The input current $I(t)$ is controlled externally. The continuous-time dynamics between spikes and the spike-triggered events are given by the standard definitions of the model: between spikes, the membrane dynamics are governed by a capacitive current, a leak current, an exponential spike-initiation current, the adaptation current, and the external input, and the adaptation current evolves toward a voltage-dependent value on the timescale $\\tau_w$. At the time of a spike, the membrane potential is reset and the adaptation current is instantaneously incremented by $b$.\n\nAssume that $V(t)$ and $I(t)$ are observable, but $w(t)$ and the parameters $a$ and $b$ are not directly observable. Your goal is to design a current-ramp protocol and an associated analysis procedure that separates the contribution of subthreshold adaptation $a$ from the spike-triggered increment $b$ by leveraging the dynamics of $w(t)$ and the change in post-spike membrane behavior observable in $V(t)$.\n\nWhich option correctly proposes a scientifically sound protocol and analysis to identify $a$ and $b$ separately, starting from the above definitions and making only approximations that are justified by timescale separation and subthreshold conditions?\n\nA. Apply a slow, strictly subthreshold up-ramp $I(t)=I_0+\\rho t$ with $\\rho$ sufficiently small that the adaptation state $w(t)$ adiabatically tracks its quasi-steady subthreshold value as $V(t)$ changes without spikes; under these conditions, reconstruct an estimate of $w(t)$ from $V(t)$ and $I(t)$ during the ramp, and infer $a$ from the slope of the reconstructed $w(t)$ versus $(V(t)-E_L)$. Then, adjust the ramp so that it elicits a single spike and immediately switch $I(t)$ to a constant holding level near its pre-spike value to prevent further spiking; reconstruct $w(t)$ post-spike and fit its relaxation to extract the instantaneous post-spike increment at $t=0^+$, which identifies $b$.\n\nB. Use a fast up-ramp that drives repetitive spiking and estimate both $a$ and $b$ from the evolution of the interspike interval distribution alone, without reconstructing $w(t)$ or constraining subthreshold conditions; the average firing-rate adaptation across the ramp is sufficient to separate $a$ and $b$.\n\nC. Use only a subthreshold ramp that never crosses threshold and estimate both $a$ and $b$ from the slope of $V(t)$ versus $I(t)$; since the membrane potential responds to input, the slope uniquely determines both subthreshold and spike-triggered adaptation.\n\nD. Alternate brief high-amplitude current pulses with brief low-amplitude pulses at a high frequency to drive rapid changes in $V(t)$; infer $a$ and $b$ from changes in spike amplitude and width, because the adaptation parameters directly set spike waveform features even without analyzing $w(t)$ or post-spike relaxation.\n\nSelect the single best option based on the AdEx definitions and scientifically justified approximations to separate $a$ and $b$ using a ramp-current protocol and analysis of $V(t)$.",
            "solution": "The problem asks for a scientifically sound protocol to separately identify the subthreshold adaptation parameter $a$ and the spike-triggered adaptation parameter $b$ of the adaptive exponential integrate-and-fire (AdEx) model, given that the membrane potential $V(t)$ and input current $I(t)$ are observable.\n\nFirst, let us formalize the AdEx model based on the provided description. The dynamics are governed by a system of two coupled differential equations:\n1.  The membrane potential $V(t)$ evolves according to:\n$$C \\frac{dV}{dt} = -g_L(V - E_L) + g_L \\Delta_T \\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right) - w + I(t)$$\n2.  The adaptation current $w(t)$ evolves according to:\n$$\\tau_w \\frac{dw}{dt} = a(V - E_L) - w$$\nWhen the membrane potential $V(t)$ reaches a threshold and a spike is initiated (in the model, $V \\to \\infty$), the state is reset at the time of the spike, $t_{spk}$:\n$$V(t_{spk}^+) \\rightarrow V_{reset}$$\n$$w(t_{spk}^+) \\rightarrow w(t_{spk}^-) + b$$\nHere, $V_{reset}$ is the reset potential.\n\nOur goal is to disentangle the parameter $a$, which governs the continuous, voltage-dependent subthreshold adaptation, from the parameter $b$, which governs the discrete, spike-triggered adaptation. To achieve this, a protocol must be designed to isolate the effects of each parameter.\n\n- The parameter $a$ links the adaptation current $w$ to the subthreshold voltage $V$. Its influence is present continuously as long as the neuron is not at its leak reversal potential $E_L$.\n- The parameter $b$ only comes into play at the precise moment a spike occurs. Its effect is an instantaneous increase in $w$.\n\nA sound experimental strategy would therefore consist of two parts: a first part that operates in a regime where $b$ is irrelevant to isolate $a$, and a second part that specifically triggers the action of $b$ in a controlled manner to measure it.\n\nLet's evaluate each option based on these principles.\n\n### Option A Analysis\nThis option proposes a two-part protocol.\n\n**Part 1: Estimating $a$**\nThe protocol suggests applying a slow, strictly subthreshold current ramp, $I(t) = I_0 + \\rho t$.\n- **Subthreshold condition**: In this regime, there are no spikes, so the parameter $b$ has no effect on the dynamics. This successfully isolates the subthreshold mechanisms. Furthermore, for $V \\ll V_T$, the exponential term $g_L \\Delta_T \\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right)$ is negligible. The membrane equation simplifies to:\n$$C \\frac{dV}{dt} \\approx -g_L(V - E_L) - w + I(t)$$\n- **Slow ramp condition (adiabatic approximation)**: If the ramp is sufficiently slow (i.e., the timescale of change induced by $\\rho$ is much longer than $\\tau_w$), the adaptation current $w(t)$ will remain close to its voltage-dependent steady state. From the equation for $w$, setting $\\frac{dw}{dt} \\approx 0$ gives the quasi-steady state:\n$$w(t) \\approx a(V(t) - E_L)$$\n- **Analysis procedure**: The protocol suggests reconstructing $w(t)$ from the observables. From the simplified membrane equation, we can solve for $w(t)$:\n$$\\hat{w}(t) = I(t) - g_L(V(t) - E_L) - C \\frac{dV(t)}{dt}$$\nSince $I(t)$, $V(t)$, and its derivative can be measured or computed, and we assume the passive parameters ($C$, $g_L$, $E_L$) are known, we can obtain an estimate $\\hat{w}(t)$.\nBy plotting the reconstructed $\\hat{w}(t)$ against the measured quantity $(V(t) - E_L)$, the slope of this relationship should be equal to $a$. This procedure is scientifically sound and correctly isolates the effect of $a$.\n\n**Part 2: Estimating $b$**\nThe protocol suggests eliciting a single spike and then holding the current at a constant subthreshold level.\n- **Isolating the spike event**: By triggering a single spike at time $t_{spk}$, we activate the update rule $w \\rightarrow w + b$.\n- **Post-spike analysis**: Immediately after the spike, at $t=t_{spk}^+$, the adaptation current is $w(t_{spk}^+) = w(t_{spk}^-) + b$. By switching to a constant holding current $I_{hold}$ that keeps the neuron subthreshold, we can observe the subsequent relaxation of $w(t)$.\nWe can reconstruct the value of $w$ just before the spike, $w(t_{spk}^-)$, using the procedure from Part 1 applied to the ramp data up to the spike time.\nWe can also reconstruct the time course of $w(t)$ for $t  t_{spk}$ using the same equation:\n$$\\hat{w}(t) = I_{hold} - g_L(V(t) - E_L) - C \\frac{dV(t)}{dt}$$\nThe post-spike dynamics of $w(t)$ will be a relaxation from its initial high value $w(t_{spk}^+)$. By fitting this relaxation curve (e.g., an exponential decay) and extrapolating back to $t_{spk}^+$, we can estimate $\\hat{w}(t_{spk}^+)$.\nFinally, $b$ can be estimated as the difference:\n$$b \\approx \\hat{w}(t_{spk}^+) - \\hat{w}(t_{spk}^-)$$\nThis procedure correctly measures the instantaneous jump in $w$ and thus isolates $b$.\n\n**Verdict**: The protocol described in Option A is scientifically rigorous, well-justified, and effectively separates the contributions of $a$ and $b$ by targeting the distinct dynamical regimes in which they operate. This option is **Correct**.\n\n### Option B Analysis\nThis option suggests using a fast ramp to drive repetitive spiking and estimating $a$ and $b$ from the interspike interval (ISI) evolution alone. During repetitive firing, both subthreshold adaptation (governed by $a$) and spike-triggered adaptation (governed by $b$) contribute to the increase of $w$, which in turn causes the firing rate to slow down (i.e., ISIs to lengthen). The total adaptation is a sum of the integral of $a(V-E_L)$ over the ISI and the jump $b$ at the end of the ISI. While both parameters affect the ISI sequence, their effects are conflated. Different combinations of $a$ and $b$ can produce similar firing patterns, making it difficult to uniquely determine both parameters from the firing times alone without using the fine-grained information available in the subthreshold $V(t)$ trajectory. Claiming that the average firing-rate adaptation is sufficient to separate them is a strong, likely incorrect, assertion, as it ignores the problem of parameter degeneracy.\n\n**Verdict**: This method is indirect and likely ill-posed, conflating the effects of $a$ and $b$ rather than separating them. This option is **Incorrect**.\n\n### Option C Analysis\nThis option proposes using only a subthreshold ramp that never crosses the firing threshold. The parameter $b$ is defined as a spike-triggered increment. If no spikes are ever triggered, the mechanism involving $b$ is never engaged. The dynamics of the system in the subthreshold regime are entirely independent of the value of $b$. Therefore, any measurement performed exclusively in this regime can yield no information about $b$. The claim that both $a$ and $b$ can be estimated is fundamentally false.\n\n**Verdict**: This protocol is incapable of measuring $b$ by its very design. This option is **Incorrect**.\n\n### Option D Analysis\nThis option suggests inferring $a$ and $b$ from changes in spike amplitude and width. The AdEx model is a point-neuron model designed to capture subthreshold dynamics and spike timing. The \"spike\" itself is an abstract event, not a biophysically detailed waveform. The dynamics of $V(t)$ show a runaway trajectory, which is artificially cut off and reset. The shape of this runaway trajectory is determined by the exponential term and the passive properties, not by the slow adaptation current $w$. The parameters $a$ and $b$ influence $w$, which in turn affects the neuron's subthreshold trajectory and thus *when* the next spike occurs. They do not, however, primarily determine the shape (amplitude or width) of the spike event itself in the AdEx formulation. Therefore, analyzing spike shape is not the correct way to infer these parameters in this model.\n\n**Verdict**: This option misinterprets the role of the parameters $a$ and $b$ within the AdEx model framework. This option is **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}