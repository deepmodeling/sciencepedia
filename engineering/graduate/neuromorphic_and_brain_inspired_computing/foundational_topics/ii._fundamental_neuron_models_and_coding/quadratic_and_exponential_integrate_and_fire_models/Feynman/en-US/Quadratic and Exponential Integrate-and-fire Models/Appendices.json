{
    "hands_on_practices": [
        {
            "introduction": "Before diving into the complex dynamics of neuron models, it is essential to master the technique of nondimensionalization. This mathematical procedure strips away the units and scales of physical parameters, revealing the core mathematical structure of a system. This first practice  will guide you through the process of transforming a physically-grounded quadratic model into the canonical Quadratic Integrate-and-Fire (QIF) form, allowing you to identify the essential dimensionless parameter that governs its dynamics.",
            "id": "4056302",
            "problem": "Consider a canonical reduction of a spiking neuron near a saddle-node on invariant circle bifurcation that yields the Quadratic Integrate-and-Fire (QIF) model. In a neuromorphic implementation, the dimensional membrane equation can be approximated by the quadratic form\n$$\nC \\,\\frac{dv}{dt} \\;=\\; g\\, v^{2} \\;+\\; I_{d},\n$$\nwhere $C$ is the membrane capacitance, $g$ is an effective quadratic conductance coefficient, $v$ is the membrane potential relative to a reference value at spike onset, and $I_{d}$ is a constant input current. Introduce a voltage scale $V_{0} > 0$ and a time scale $T_{0} > 0$, and define dimensionless variables by\n$$\n\\tilde{v} \\;=\\; \\frac{v}{V_{0}}, \\qquad \\tilde{t} \\;=\\; \\frac{t}{T_{0}}.\n$$\nRequire that, after nondimensionalization and dropping tildes for notational simplicity, the dynamics take the canonical QIF form\n$$\n\\frac{dv}{dt} \\;=\\; v^{2} \\;+\\; I,\n$$\nwhere $I$ is a dimensionless constant representing the drive.\n\nUsing first principles of dimensional analysis and the definitions above, derive the constraints on the scaling parameters $V_{0}$ and $T_{0}$ that achieve the canonical form and identify the resulting dimensionless drive $I$ in terms of $C$, $g$, $I_{d}$, and $V_{0}$. Your final answer must be a single closed-form analytic expression for $I$. No rounding is required. Do not include units in your final expression; $I$ must be dimensionless by construction.",
            "solution": "The user wants me to validate and solve the following problem.\n\n**Problem Statement:**\nConsider a canonical reduction of a spiking neuron near a saddle-node on invariant circle bifurcation that yields the Quadratic Integrate-and-Fire (QIF) model. In a neuromorphic implementation, the dimensional membrane equation can be approximated by the quadratic form\n$$\nC \\,\\frac{dv}{dt} \\;=\\; g\\, v^{2} \\;+\\; I_{d},\n$$\nwhere $C$ is the membrane capacitance, $g$ is an effective quadratic conductance coefficient, $v$ is the membrane potential relative to a reference value at spike onset, and $I_{d}$ is a constant input current. Introduce a voltage scale $V_{0} > 0$ and a time scale $T_{0} > 0$, and define dimensionless variables by\n$$\n\\tilde{v} \\;=\\; \\frac{v}{V_{0}}, \\qquad \\tilde{t} \\;=\\; \\frac{t}{T_{0}}.\n$$\nRequire that, after nondimensionalization and dropping tildes for notational simplicity, the dynamics take the canonical QIF form\n$$\n\\frac{dv}{dt} \\;=\\; v^{2} \\;+\\; I,\n$$\nwhere $I$ is a dimensionless constant representing the drive.\n\nUsing first principles of dimensional analysis and the definitions above, derive the constraints on the scaling parameters $V_{0}$ and $T_{0}$ that achieve the canonical form and identify the resulting dimensionless drive $I$ in terms of $C$, $g$, $I_{d}$, and $V_{0}$. Your final answer must be a single closed-form analytic expression for $I$. No rounding is required. Do not include units in your final expression; $I$ must be dimensionless by construction.\n\n### Step 1: Extract Givens\n- **Dimensional Equation:** $C \\frac{dv}{dt} = g v^{2} + I_{d}$\n- **Parameter Definitions:**\n    - $C$: membrane capacitance\n    - $g$: effective quadratic conductance coefficient\n    - $v$: membrane potential\n    - $t$: time\n    - $I_{d}$: constant input current\n- **Dimensionless Variable Definitions:**\n    - $\\tilde{v} = \\frac{v}{V_{0}}$, with voltage scale $V_{0} > 0$\n    - $\\tilde{t} = \\frac{t}{T_{0}}$, with time scale $T_{0} > 0$\n- **Target Canonical Form:** $\\frac{dv}{dt} = v^{2} + I$ (after dropping tildes)\n- **Objective:**\n    1. Derive constraints on $V_{0}$ and $T_{0}$.\n    2. Identify the dimensionless drive $I$ in terms of $C$, $g$, $I_{d}$, and $V_{0}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem describes the nondimensionalization of the Quadratic Integrate-and-Fire (QIF) model. The QIF model is a standard and well-established canonical model in computational neuroscience, often derived as the normal form for Type I neuron excitability near a saddle-node on invariant circle (SNIC) bifurcation. The process of nondimensionalization is a fundamental technique in applied mathematics and physics. The problem is scientifically sound.\n2.  **Well-Posed:** The problem provides a clear starting equation and a clear target equation. It asks to find the conditions (constraints and a derived quantity) that link the two. This is a well-defined mathematical derivation task with a unique solution.\n3.  **Objective:** The language is formal, precise, and technical. There are no subjective or opinion-based statements.\n4.  **Completeness:** The problem provides all necessary definitions and equations to proceed with the derivation. It is self-contained.\n5.  **No other flaws detected:** The problem is not metaphorical, is directly relevant to the stated field, is not contradictory, does not contain unrealistic data, is well-structured, is not trivial, and is mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe goal is to transform the dimensional equation into the canonical dimensionless form through a change of variables.\n\nThe given dimensional equation is:\n$$\nC \\frac{dv}{dt} = g v^{2} + I_{d}\n$$\n\nThe dimensionless variables are defined as:\n$$\n\\tilde{v} = \\frac{v}{V_{0}} \\quad \\implies \\quad v = V_{0} \\tilde{v}\n$$\n$$\n\\tilde{t} = \\frac{t}{T_{0}} \\quad \\implies \\quad t = T_{0} \\tilde{t}\n$$\n\nWe must express the derivative $\\frac{dv}{dt}$ in terms of the new variables $\\tilde{v}$ and $\\tilde{t}$. Using the chain rule:\n$$\n\\frac{dv}{dt} = \\frac{dv}{d\\tilde{t}} \\frac{d\\tilde{t}}{dt}\n$$\nFrom the definitions, we have $\\frac{dv}{d\\tilde{v}} = V_{0}$ and $\\frac{dt}{d\\tilde{t}} = T_{0}$, so $\\frac{d\\tilde{t}}{dt} = \\frac{1}{T_{0}}$. Thus, we can write:\n$$\n\\frac{dv}{dt} = \\frac{d}{dt}(V_{0} \\tilde{v}) = V_{0} \\frac{d\\tilde{v}}{dt} = V_{0} \\frac{d\\tilde{v}}{d\\tilde{t}} \\frac{d\\tilde{t}}{dt} = \\frac{V_{0}}{T_{0}} \\frac{d\\tilde{v}}{d\\tilde{t}}\n$$\n\nNow, we substitute the expressions for $v$ and $\\frac{dv}{dt}$ into the original dimensional equation:\n$$\nC \\left( \\frac{V_{0}}{T_{0}} \\frac{d\\tilde{v}}{d\\tilde{t}} \\right) = g (V_{0} \\tilde{v})^{2} + I_{d}\n$$\n$$\n\\frac{C V_{0}}{T_{0}} \\frac{d\\tilde{v}}{d\\tilde{t}} = g V_{0}^{2} \\tilde{v}^{2} + I_{d}\n$$\n\nTo match the target canonical form, we isolate the derivative term $\\frac{d\\tilde{v}}{d\\tilde{t}}$:\n$$\n\\frac{d\\tilde{v}}{d\\tilde{t}} = \\frac{T_{0}}{C V_{0}} \\left( g V_{0}^{2} \\tilde{v}^{2} + I_{d} \\right)\n$$\nDistributing the factor on the right-hand side, we get:\n$$\n\\frac{d\\tilde{v}}{d\\tilde{t}} = \\left( \\frac{g V_{0} T_{0}}{C} \\right) \\tilde{v}^{2} + \\left( \\frac{I_{d} T_{0}}{C V_{0}} \\right)\n$$\n\nThe target canonical form, after dropping the tildes for simplicity, is:\n$$\n\\frac{dv}{dt} = v^{2} + I\n$$\n\nBy comparing the derived dimensionless equation with the target canonical form, we can equate the coefficients of the corresponding terms.\n\nFirst, for the quadratic term $\\tilde{v}^{2}$ (or $v^{2}$ in the simplified notation), the coefficient must be $1$:\n$$\n\\frac{g V_{0} T_{0}}{C} = 1\n$$\nThis equation provides the first part of the answer: the constraint relating the scaling parameters $V_{0}$ and $T_{0}$. We can express $T_{0}$ in terms of $V_{0}$ (or vice versa):\n$$\nT_{0} = \\frac{C}{g V_{0}}\n$$\n\nSecond, the constant term in the dimensionless equation must be equal to the dimensionless drive $I$:\n$$\nI = \\frac{I_{d} T_{0}}{C V_{0}}\n$$\n\nThe problem requires an expression for $I$ in terms of $C$, $g$, $I_{d}$, and $V_{0}$. To achieve this, we must eliminate the time scale $T_{0}$ from the expression for $I$ by substituting the constraint we just derived:\n$$\nI = \\frac{I_{d}}{C V_{0}} \\left( T_{0} \\right) = \\frac{I_{d}}{C V_{0}} \\left( \\frac{C}{g V_{0}} \\right)\n$$\nSimplifying this expression yields the final result for the dimensionless drive $I$:\n$$\nI = \\frac{I_{d} C}{C g V_{0}^{2}} = \\frac{I_{d}}{g V_{0}^{2}}\n$$\nThis expression is the required closed-form analytic expression for $I$, and as demonstrated by a dimensional analysis check, it is dimensionless.",
            "answer": "$$\n\\boxed{\\frac{I_{d}}{g V_{0}^{2}}}\n$$"
        },
        {
            "introduction": "With the canonical QIF model established, we can now analyze its fundamental input-output relationship: the frequency-current (F-I) curve. This practice  involves deriving this curve from first principles by calculating the time it takes for the voltage to travel between reset and spike threshold. This exercise not only provides a closed-form solution for the firing rate but also offers deep insight into the nature of Type I excitability and the bifurcation that marks the onset of spiking.",
            "id": "4056267",
            "problem": "Consider the dimensionless Quadratic Integrate-and-Fire (QIF) neuron driven by a constant input current $I \\in \\mathbb{R}$, defined by the membrane potential dynamics $ \\frac{dv}{dt} = v^{2} + I$. A spike is defined to occur when $v(t)$ diverges to $+\\infty$, after which the membrane potential is reset instantaneously to $-\\infty$ with zero refractory delay. Assume stationarity under constant $I$, so that a steady firing rate exists if and only if the time $T(I)$ it takes for $v(t)$ to evolve monotonically from $-\\infty$ to $+\\infty$ is finite.\n\nStarting from the definitions of the QIF dynamics and the interspike interval as the traversal time between reset and threshold, derive from first principles a closed-form expression for the steady-state frequency–current (F–I) curve $f(I)$, where $f(I) = \\frac{1}{T(I)}$ when $T(I)$ is finite and $f(I) = 0$ otherwise. Your derivation should establish the existence or non-existence of periodic spiking as a function of $I$, and compute $f(I)$ exactly when it exists by evaluating the appropriate time integral implied by the dynamics. Provide the final result as a single analytic expression for $f(I)$ that is valid for all $I \\in \\mathbb{R}$.\n\nState your final expression for $f(I)$ in closed form. No rounding is required and no units are needed, since the model is dimensionless. Additionally, justify in your reasoning why there is an absence of steady firing for $I \\le 0$.",
            "solution": "The problem statement is first validated against the established criteria.\n\n### Step 1: Extract Givens\n-   **Dynamics of Membrane Potential:** The dimensionless voltage $v$ evolves according to the ordinary differential equation (ODE) $\\frac{dv}{dt} = v^{2} + I$.\n-   **Input Current:** The input $I$ is a constant real number, $I \\in \\mathbb{R}$.\n-   **Spike and Reset Mechanism:** A spike occurs when $v(t)$ diverges to $+\\infty$. Immediately following a spike, $v(t)$ is reset to $-\\infty$. The refractory period is zero.\n-   **Interspike Interval (ISI):** The time for one full cycle, denoted $T(I)$, is the time it takes for $v(t)$ to evolve monotonically from $-\\infty$ to $+\\infty$. A steady firing rate exists if and only if $T(I)$ is finite.\n-   **Firing Rate (F-I Curve):** The steady-state frequency $f(I)$ is defined as $f(I) = \\frac{1}{T(I)}$ if $T(I)$ is finite, and $f(I) = 0$ otherwise.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem describes the Quadratic Integrate-and-Fire (QIF) neuron, a canonical and widely studied model in computational neuroscience. It is a normal form for Type I neuron excitability. The dynamics and the task of deriving the F-I curve are standard and scientifically sound.\n-   **Well-Posed:** The problem is well-posed. The ODE is clearly defined, the initial and final conditions for the integration interval ($v \\to -\\infty$ and $v \\to +\\infty$) are specified, and the definition of the firing rate is unambiguous. A unique, stable, and meaningful solution exists.\n-   **Objective:** The language is precise and mathematical, free of subjective or ambiguous terminology.\n-   **Self-Contained and Consistent:** All necessary information to derive the F-I curve is provided within the problem statement. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe derivation of the F-I curve, $f(I)$, proceeds by calculating the interspike interval, $T(I)$. The governing ODE is $\\frac{dv}{dt} = v^{2} + I$. We can separate variables to find the time $dt$ required for an infinitesimal change in voltage $dv$:\n$$\ndt = \\frac{dv}{v^{2} + I}\n$$\nThe total time $T(I)$ for the voltage to travel from the reset value $v = -\\infty$ to the spiking threshold $v = +\\infty$ is obtained by integrating this expression over the entire range of $v$:\n$$\nT(I) = \\int_{-\\infty}^{\\infty} \\frac{dv}{v^{2} + I}\n$$\nThe existence and value of this integral, and thus the existence of a finite firing rate, depend critically on the sign of the input current $I$. We analyze the problem by considering three cases for $I$.\n\n**Case 1: Excitatory Input ($I > 0$)**\nWhen $I$ is positive, the term $v^2 + I$ is strictly positive for all real $v$. This means $\\frac{dv}{dt} > 0$, and the voltage $v(t)$ increases monotonically for all time, ensuring that the trajectory starting from $v \\to -\\infty$ will eventually diverge to $v \\to +\\infty$. A periodic spiking regime exists.\n\nTo evaluate the integral for $T(I)$, we let $I = a^{2}$ where $a = \\sqrt{I}$ is a positive real number. The integral becomes:\n$$\nT(I) = \\int_{-\\infty}^{\\infty} \\frac{dv}{v^{2} + a^{2}}\n$$\nThis is a standard integral. The antiderivative of the integrand is $\\frac{1}{a} \\arctan\\left(\\frac{v}{a}\\right)$. We evaluate this at the limits of integration:\n$$\nT(I) = \\left[ \\frac{1}{a} \\arctan\\left(\\frac{v}{a}\\right) \\right]_{v=-\\infty}^{v=+\\infty} = \\frac{1}{a} \\left( \\lim_{v \\to \\infty} \\arctan\\left(\\frac{v}{a}\\right) - \\lim_{v \\to -\\infty} \\arctan\\left(\\frac{v}{a}\\right) \\right)\n$$\nUsing the known limits of the arctangent function, $\\arctan(x) \\to \\frac{\\pi}{2}$ as $x \\to \\infty$ and $\\arctan(x) \\to -\\frac{\\pi}{2}$ as $x \\to -\\infty$, we find:\n$$\nT(I) = \\frac{1}{a} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{a} (\\pi) = \\frac{\\pi}{a}\n$$\nSubstituting back $a = \\sqrt{I}$, we get the interspike interval for $I > 0$:\n$$\nT(I) = \\frac{\\pi}{\\sqrt{I}}\n$$\nThe firing rate is the reciprocal of the ISI:\n$$\nf(I) = \\frac{1}{T(I)} = \\frac{\\sqrt{I}}{\\pi} \\quad \\text{for } I > 0\n$$\n\n**Case 2: Inhibitory Input ($I  0$)**\nThis case justifies the absence of steady firing for $I \\le 0$. When $I$ is negative, the dynamics change qualitatively. Let $I = -k^2$ for some positive real number $k = \\sqrt{-I}$. The ODE becomes:\n$$\n\\frac{dv}{dt} = v^2 - k^2 = (v-k)(v+k)\n$$\nThe system now has two fixed points, where $\\frac{dv}{dt} = 0$. These are $v_1 = -k = -\\sqrt{-I}$ and $v_2 = +k = +\\sqrt{-I}$.\n\nWe analyze the stability of these fixed points. Let $g(v) = v^2 - k^2$. The stability is determined by the sign of the derivative $g'(v) = 2v$ at the fixed points.\n-   At $v_1 = -k$, $g'(-k) = -2k  0$. This is a **stable** fixed point.\n-   At $v_2 = +k$, $g'(+k) = +2k > 0$. This is an **unstable** fixed point.\n\nThe neuron's voltage is reset to $v \\to -\\infty$. For any $v  -k$, we have $\\frac{dv}{dt} = (v-k)(v+k) > 0$ since both factors are negative. Therefore, the voltage increases from $-\\infty$. However, as $v(t)$ approaches the stable fixed point at $v_1 = -k = -\\sqrt{-I}$, its rate of change $\\frac{dv}{dt}$ approaches $0$. The voltage trajectory is trapped at this stable equilibrium. It can never cross this point to reach the region $v > -k$ and subsequently spike. The time to reach the spiking threshold divergence is infinite.\nTherefore, for $I  0$, a spike is never generated, $T(I) = \\infty$, and the firing rate is, by definition, $f(I) = 0$.\n\n**Case 3: Zero Input ($I = 0$)**\nThis is the borderline case. The ODE is:\n$$\n\\frac{dv}{dt} = v^2\n$$\nThere is a single fixed point at $v=0$. For $v  0$, $\\frac{dv}{dt} = v^2 > 0$, so the voltage increases from its reset value of $-\\infty$. To determine the time it takes to reach $v=0$, we can integrate:\n$$\n\\Delta t = \\int_{v_0}^{v_f} \\frac{dv}{v^2} = \\left[ -\\frac{1}{v} \\right]_{v_0}^{v_f} = \\frac{1}{v_0} - \\frac{1}{v_f}\n$$\nThe time to travel from $v_0 = -\\infty$ to any finite negative value, say $v_f = -1$, is finite: $\\Delta t = \\lim_{v_0 \\to -\\infty} \\left( \\frac{1}{v_0} - \\frac{1}{-1} \\right) = 0+1 = 1$.\nHowever, the time to travel from $v_0 = -1$ to the fixed point at $v_f=0$ is:\n$$\n\\Delta t = \\lim_{v_f \\to 0^{-}} \\left( \\frac{1}{-1} - \\frac{1}{v_f} \\right) = -1 - (-\\infty) = \\infty\n$$\nThe voltage approaches $v=0$ asymptotically but never reaches it in finite time. The neuron gets stuck at $v=0$ and never spikes. Consequently, the interspike interval is infinite, $T(0) = \\infty$, and the firing rate is $f(0) = 0$.\n\n**Summary and Final Expression**\nCombining the results from all three cases:\n-   For $I > 0$, $f(I) = \\frac{\\sqrt{I}}{\\pi}$.\n-   For $I \\le 0$, $f(I) = 0$.\n\nThis piecewise function describes the complete F-I curve. It can be written as a single, continuous, closed-form expression for all $I \\in \\mathbb{R}$ by using the $\\max$ function, which captures the threshold behavior at $I=0$:\n$$\nf(I) = \\frac{\\sqrt{\\max(0, I)}}{\\pi}\n$$\nThis expression correctly yields $\\frac{\\sqrt{I}}{\\pi}$ for $I>0$ and $0$ for $I \\le 0$. The neuron fires only for suprathreshold (excitatory) currents, and its firing rate is proportional to the square root of the input current, a characteristic feature of Type I neuronal excitability.",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{\\max(0, I)}}{\\pi}}\n$$"
        },
        {
            "introduction": "The analytical tractability of the QIF model, which we explored when deriving its F-I curve , enables exceptionally powerful simulation techniques. This final practice  introduces the 'theta-neuron' transformation, a mapping that converts the QIF model's nonlinear dynamics into a simpler phase representation. By solving the dynamics in this phase space, you will develop an event-driven algorithm that computes spike times analytically, completely bypassing the potential errors and computational costs of traditional time-stepping methods.",
            "id": "4056276",
            "problem": "Design an event-driven algorithm for the Quadratic Integrate-and-Fire (QIF) neuron model that leverages the analytical blow-up condition identified via the theta mapping. The QIF model is given by the scalar ordinary differential equation $dv/dt = v^2 + I$, where $v$ is the membrane potential and $I$ is a constant input current. In the QIF model, a spike occurs when $v$ experiences a finite-time blow-up to $+\\infty$, at which instant the state is reset to $v = -\\infty$ to continue the dynamics. The theta mapping defines the transformation $v = \\tan(\\theta/2)$, which maps the blow-up to the phase crossing $\\theta = \\pi$. The task is to derive an event-driven spike scheduler that detects spike times analytically—without small time steps—using this mapping and to quantify the numerical error of the method.\n\nStart from the following fundamental bases:\n\n- Deterministic dynamics are governed by ordinary differential equations and time-to-event is obtained by integrating the reciprocal of the vector field, that is, if $dv/dt = f(v)$ and the event occurs at $v = v_e$, then $t_{\\text{event}} = \\int_{v_0}^{v_e} dv/f(v)$, provided the integral converges.\n- The variable change $v = \\tan(\\theta/2)$ is invertible for $\\theta \\in (-\\pi, \\pi)$ and maps $v \\to +\\infty$ to $\\theta \\to \\pi$ and $v \\to -\\infty$ to $\\theta \\to -\\pi$.\n- The chain rule gives $d\\theta/dt = (dv/dt) / (dv/d\\theta)$.\n\nYour algorithm must:\n\n1. Derive the analytical detection condition for the spike time using the theta mapping $v = \\tan(\\theta/2)$, expressing $d\\theta/dt$ in terms of $\\theta$ and $I$ and identifying the integral for the time-to-spike $t_{\\text{spike}}$ starting from an initial phase $\\theta_0 = 2 \\arctan(v_0)$.\n2. For $I > 0$, compute the first spike time $t_1$ analytically and the interspike interval $T(I)$; then generate all spike times $t_1, t_1 + T(I), t_1 + 2 T(I), \\ldots$ that do not exceed a given horizon $T_{\\text{end}}$.\n3. For $I = 0$, determine the condition under which a spike occurs and derive the corresponding closed-form expression for $t_{\\text{spike}}$ when applicable.\n4. For $I  0$, characterize the excitable regime and derive a closed-form expression for $t_{\\text{spike}}$ when the initial potential $v_0$ is sufficiently large to produce a finite-time blow-up. Also state when no spike occurs in forward time.\n5. Quantify the numerical error of your event-driven schedule by comparing the analytically computed times to a numerical quadrature of the theta integral for cases without singularities. Express error as the maximum absolute difference between the analytical times and the numerical quadrature times.\n\nYour program must implement the event-driven scheduler as follows:\n\n- For $I > 0$, compute the first spike time $t_1$ analytically and the interspike interval $T(I)$; then generate all spike times $t_1, t_1 + T(I), t_1 + 2 T(I), \\ldots$ that do not exceed a given horizon $T_{\\text{end}}$.\n- For $I = 0$, compute the first spike time if it exists; there is no periodic spiking.\n- For $I  0$, compute the first spike time only if it exists; there is no periodic spiking.\n- For error quantification, use numerical quadrature on the theta integral when it is non-singular, and compute the maximum absolute error across available comparisons.\n\nAngle units must be radians. Time units must be seconds. Express all times and errors in seconds as floating-point numbers.\n\nTest Suite:\nUse the following parameter sets, each as a triplet $(I, v_0, T_{\\text{end}})$:\n\n- Case A (positive input): $(0.5, 0.0, 10.0)$\n- Case B (small positive input): $(0.001, 0.1, 1000.0)$\n- Case C (zero input, excitable): $(0.0, 1.0, 3.0)$\n- Case D (negative input, supra-threshold initial condition): $(-0.5, 1.0, 10.0)$\n- Case E (negative input, at threshold): $(-0.5, 0.70710678, 10.0)$\n\nRequired final output format:\n\n- For each test case, return a list arranged as `[N, t_1, t_2, ..., t_N, E]`, where `N` is the integer number of spikes scheduled within `[0, T_end]`, `t_k` are the spike times in seconds in ascending order, and `E` is the maximum absolute error in seconds computed by comparing analytical times to those obtained via numerical quadrature in the theta domain whenever applicable. If no spikes occur, return `[0, E]` with `E = 0.0` if the quadrature is not applicable or yields no comparison.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result_case_A,result_case_B,result_case_C,result_case_D,result_case_E]\").",
            "solution": "The problem requires the design of an event-driven algorithm for the Quadratic Integrate-and-Fire (QIF) neuron model based on an analytical solution derived via the theta mapping.\n\nThe problem is scientifically grounded, well-posed, and objective. The QIF model is a canonical representation in computational neuroscience, and the use of the theta mapping is a standard analytical technique. All constants, variables, and conditions are explicitly defined, creating a self-contained and solvable problem. No violations of scientific principles, factual inaccuracies, or logical inconsistencies are present.\n\nWe proceed with the derivation and implementation.\n\n**1. Derivation of the Theta-Neuron Model**\n\nThe dynamics of the QIF neuron are given by the ordinary differential equation:\n$$\n\\frac{dv}{dt} = v^2 + I\n$$\nwhere $v$ is the membrane potential and $I$ is a constant input current. A spike is defined as the moment $v$ reaches $+\\infty$. The state is then reset to $v = -\\infty$.\n\nWe introduce the theta mapping, a change of variables defined by $v = \\tan(\\theta/2)$. This transformation maps the potential range $v \\in (-\\infty, +\\infty)$ to the phase range $\\theta \\in (-\\pi, \\pi)$. The spike at $v \\to +\\infty$ corresponds to $\\theta \\to \\pi$, and the reset at $v \\to -\\infty$ corresponds to $\\theta \\to -\\pi$. The initial phase $\\theta_0$ is related to the initial potential $v_0$ by $\\theta_0 = 2 \\arctan(v_0)$.\n\nTo find the dynamics in the $\\theta$ variable, we use the chain rule:\n$$\n\\frac{d\\theta}{dt} = \\frac{dv}{dt} \\frac{d\\theta}{dv} = \\frac{dv}{dt} \\left( \\frac{dv}{d\\theta} \\right)^{-1}\n$$\nFirst, we compute $dv/d\\theta$:\n$$\n\\frac{dv}{d\\theta} = \\frac{d}{d\\theta} \\tan\\left(\\frac{\\theta}{2}\\right) = \\frac{1}{2} \\sec^2\\left(\\frac{\\theta}{2}\\right)\n$$\nUsing the trigonometric identity $\\sec^2(x) = 1 + \\tan^2(x)$, and substituting $v = \\tan(\\theta/2)$, we get:\n$$\n\\frac{dv}{d\\theta} = \\frac{1}{2} \\left(1 + \\tan^2\\left(\\frac{\\theta}{2}\\right)\\right) = \\frac{1}{2}(1 + v^2)\n$$\nNow, substituting this and the QIF dynamics into the chain rule expression:\n$$\n\\frac{d\\theta}{dt} = (v^2 + I) \\left( \\frac{1}{2}(1 + v^2) \\right)^{-1} = \\frac{2(v^2 + I)}{1 + v^2}\n$$\nTo express this purely in terms of $\\theta$, we substitute $v = \\tan(\\theta/2)$ and use $1+v^2 = 1+\\tan^2(\\theta/2) = \\sec^2(\\theta/2)$:\n$$\n\\frac{d\\theta}{dt} = \\frac{2(\\tan^2(\\theta/2) + I)}{\\sec^2(\\theta/2)} = 2\\cos^2\\left(\\frac{\\theta}{2}\\right) \\left(\\tan^2\\left(\\frac{\\theta}{2}\\right) + I\\right) = 2\\left(\\sin^2\\left(\\frac{\\theta}{2}\\right) + I\\cos^2\\left(\\frac{\\theta}{2}\\right)\\right)\n$$\nUsing the half-angle identities $\\sin^2(\\theta/2) = (1-\\cos\\theta)/2$ and $\\cos^2(\\theta/2) = (1+\\cos\\theta)/2$:\n$$\n\\frac{d\\theta}{dt} = 2\\left(\\frac{1 - \\cos\\theta}{2} + I\\frac{1 + \\cos\\theta}{2}\\right) = (1 - \\cos\\theta) + I(1 + \\cos\\theta)\n$$\nThis simplifies to the canonical form of the theta-neuron model:\n$$\n\\frac{d\\theta}{dt} = (1+I) - (1-I)\\cos\\theta\n$$\n\n**2. Derivation of the Time-to-Spike**\n\nThe time-to-spike, $t_{\\text{spike}}$, is the time required for the phase to evolve from an initial value $\\theta_0$ to the threshold $\\pi$. We find this by integrating the reciprocal of the vector field:\n$$\nt_{\\text{spike}} = \\int_{t_0}^{t_{\\text{spike}}} dt = \\int_{\\theta_0}^{\\pi} \\frac{d\\theta}{(1+I) - (1-I)\\cos\\theta}\n$$\nWe solve this integral for the three cases of $I$: $I>0$, $I=0$, and $I0$.\n\n**Case 1: Suprathreshold Current ($I > 0$)**\nThe neuron spikes periodically. The integrand is of the form $\\int \\frac{d\\theta}{a+b\\cos\\theta}$ with $a = 1+I$ and $b = -(1-I)$. The condition $a^2 > b^2$ holds, since $a^2 - b^2 = (1+I)^2 - (1-I)^2 = 4I > 0$. The standard solution to this integral is:\n$$\n\\int \\frac{d\\theta}{a+b\\cos\\theta} = \\frac{1}{\\sqrt{I}} \\arctan\\left(\\frac{\\tan(\\theta/2)}{\\sqrt{I}}\\right)\n$$\nThe first spike time $t_1$, starting from $v_0$ (and thus $\\theta_0=2\\arctan(v_0)$), is:\n$$\nt_1 = \\left[ \\frac{1}{\\sqrt{I}} \\arctan\\left(\\frac{\\tan(\\theta/2)}{\\sqrt{I}}\\right) \\right]_{\\theta_0}^{\\pi} = \\frac{1}{\\sqrt{I}} \\left( \\lim_{\\theta\\to\\pi^-} \\arctan\\left(\\frac{\\tan(\\theta/2)}{\\sqrt{I}}\\right) - \\arctan\\left(\\frac{\\tan(\\theta_0/2)}{\\sqrt{I}}\\right) \\right)\n$$\nAs $\\theta \\to \\pi^-$, $\\tan(\\theta/2) \\to +\\infty$, so the arctan term approaches $\\pi/2$. Thus:\n$$\nt_1 = \\frac{1}{\\sqrt{I}} \\left( \\frac{\\pi}{2} - \\arctan\\left(\\frac{v_0}{\\sqrt{I}}\\right) \\right)\n$$\nThe interspike interval, $T(I)$, is the time to go from reset ($v=-\\infty$, $\\theta=-\\pi$) to spike ($v=+\\infty$, $\\theta=\\pi$):\n$$\nT(I) = \\int_{-\\pi}^{\\pi} \\frac{d\\theta}{(1+I) - (1-I)\\cos\\theta} = \\frac{1}{\\sqrt{I}} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{\\sqrt{I}}\n$$\n\n**Case 2: Zero Current ($I = 0$)**\nThe dynamics simplify to $dv/dt = v^2$. A spike occurs only if $v_0 > 0$, as the potential would otherwise decrease or remain at $0$. The theta dynamics become $d\\theta/dt = 1 - \\cos\\theta$. The time-to-spike is:\n$$\nt_1 = \\int_{\\theta_0}^{\\pi} \\frac{d\\theta}{1 - \\cos\\theta} = \\int_{\\theta_0}^{\\pi} \\frac{d\\theta}{2\\sin^2(\\theta/2)} = \\frac{1}{2} \\int_{\\theta_0}^{\\pi} \\csc^2(\\theta/2) d\\theta\n$$\n$$\nt_1 = \\left[ -\\cot\\left(\\frac{\\theta}{2}\\right) \\right]_{\\theta_0}^{\\pi} = -\\cot\\left(\\frac{\\pi}{2}\\right) - \\left(-\\cot\\left(\\frac{\\theta_0}{2}\\right)\\right) = 0 + \\cot\\left(\\frac{\\theta_0}{2}\\right) = \\frac{1}{\\tan(\\theta_0/2)} = \\frac{1}{v_0}\n$$\nThis result is valid for $v_0 > 0$. If $v_0 \\le 0$, no spike occurs. There is no periodic spiking.\n\n**Case 3: Subthreshold Current ($I  0$)**\nThe system is excitable. The equation $v^2+I=0$ has two fixed points at $v = \\pm\\sqrt{-I}$. The point $v_{th} = \\sqrt{-I}$ is an unstable fixed point (threshold), and $v_{st} = -\\sqrt{-I}$ is a stable fixed point. A spike occurs only if the initial potential $v_0$ is greater than the threshold, i.e., $v_0 > \\sqrt{-I}$. If $v_0 \\le \\sqrt{-I}$, the potential decays to the stable fixed point and no spike occurs.\n\nFor $v_0 > \\sqrt{-I}$, we solve the time-to-spike integral. Let $k = \\sqrt{-I}$. The theta dynamics are $d\\theta/dt = (1-k^2) - (1+k^2)\\cos\\theta$. The integral is:\n$$\nt_1 = \\int_{\\theta_0}^{\\pi} \\frac{d\\theta}{(1-k^2) - (1+k^2)\\cos\\theta}\n$$\nThis integral, valid for $v_0 > k$, can be solved using hyperbolic functions, yielding:\n$$\nt_1 = \\frac{1}{k} \\operatorname{arccoth}\\left(\\frac{v_0}{k}\\right) = \\frac{1}{2k} \\ln\\left(\\frac{v_0+k}{v_0-k}\\right)\n$$\nSubstituting $k = \\sqrt{-I}$:\n$$\nt_1 = \\frac{1}{2\\sqrt{-I}} \\ln\\left( \\frac{v_0 + \\sqrt{-I}}{v_0 - \\sqrt{-I}} \\right)\n$$\nThis is valid only if $v_0 > \\sqrt{-I}$. There is no periodic spiking.\n\n**3. Error Quantification**\n\nThe numerical error is quantified by comparing the analytical expressions for spike times with results from numerical quadrature of the theta integral. The integral for the time-to-spike is proper, as the denominator $(1+I)-(1-I)\\cos\\theta$ evaluates to $2$ at $\\theta=\\pi$, thus avoiding a singularity at the integration endpoint. We use `scipy.integrate.quad` to compute the numerical value of the integral for $t_1$ (from $\\theta_0$ to $\\pi$) and, where applicable, for $T(I)$ (from $-\\pi$ to $\\pi$). The error for each test case, $E$, is the maximum absolute difference between the analytically and numerically computed times for that case. If no spikes occur, or if numerical integration is not performed (e.g., at threshold), the error is $0$.\n\n**Algorithm Summary**\nFor a given set of parameters $(I, v_0, T_{\\text{end}})$:\n1.  Determine the case based on the sign of $I$.\n2.  If $I > 0$: Calculate $t_1$ and $T(I)$ using the derived formulas. Generate all spike times $t_1, t_1+T(I), t_1+2T(I), \\dots$ that are less than or equal to $T_{\\text{end}}$.\n3.  If $I = 0$: Check if $v_0 > 0$. If so, calculate $t_1 = 1/v_0$. If $t_1 \\le T_{\\text{end}}$, record it.\n4.  If $I  0$: Check if $v_0 > \\sqrt{-I}$. If so, calculate $t_1$ using the derived formula. If $t_1 \\le T_{\\text{end}}$, record it.\n5.  For each analytically computed time ($t_1$ and/or $T(I)$), also compute its value via numerical quadrature of the corresponding theta integral.\n6.  Calculate the absolute difference for each pair of analytical/numerical times. The error $E$ is the maximum of these differences.\n7.  Return the results in the format $[N, t_1, \\dots, t_N, E]$. If no spikes, return $[0, E]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Designs an event-driven algorithm for the QIF neuron model.\n    \"\"\"\n    # Test cases: (I, v0, T_end)\n    test_cases = [\n        (0.5, 0.0, 10.0),       # Case A: Positive input\n        (0.001, 0.1, 1000.0),    # Case B: Small positive input\n        (0.0, 1.0, 3.0),        # Case C: Zero input, excitable\n        (-0.5, 1.0, 10.0),      # Case D: Negative input, supra-threshold\n        (-0.5, 0.70710678, 10.0) # Case E: Negative input, at threshold\n    ]\n\n    all_results = []\n\n    for I, v0, T_end in test_cases:\n        spikes = []\n        errors = []\n        \n        # Calculate initial phase\n        theta0 = 2 * np.arctan(v0)\n\n        # Case 1: I > 0 (Suprathreshold, periodic spiking)\n        if I > 0:\n            sqrt_I = np.sqrt(I)\n            \n            # Analytical calculation\n            t1_analyt = (0.5 * np.pi - np.arctan(v0 / sqrt_I)) / sqrt_I\n            T_analyt = np.pi / sqrt_I\n            \n            # Numerical calculation for error\n            integrand = lambda theta: 1.0 / ((1 + I) - (1 - I) * np.cos(theta))\n            t1_num, _ = integrate.quad(integrand, theta0, np.pi)\n            T_num, _ = integrate.quad(integrand, -np.pi, np.pi)\n            \n            errors.append(abs(t1_analyt - t1_num))\n            errors.append(abs(T_analyt - T_num))\n            \n            # Generate spike train\n            current_spike_time = t1_analyt\n            while current_spike_time = T_end:\n                spikes.append(current_spike_time)\n                current_spike_time += T_analyt\n\n        # Case 2: I = 0 (Spike if v0 > 0)\n        elif I == 0:\n            if v0 > 0:\n                # Analytical calculation\n                t1_analyt = 1.0 / v0\n                \n                # Numerical calculation for error\n                integrand = lambda theta: 1.0 / (1.0 - np.cos(theta))\n                t1_num, _ = integrate.quad(integrand, theta0, np.pi)\n                \n                errors.append(abs(t1_analyt - t1_num))\n\n                # Generate spike (at most one)\n                if t1_analyt = T_end:\n                    spikes.append(t1_analyt)\n            \n        # Case 3: I  0 (Excitable, spike if v0 > threshold)\n        else: # I  0\n            sqrt_neg_I = np.sqrt(-I)\n            \n            # Spike only if v0 is strictly greater than the threshold\n            # A small tolerance helps with floating point representation issues.\n            if v0 > sqrt_neg_I + 1e-12:\n                # Analytical calculation\n                t1_analyt = (1.0 / (2.0 * sqrt_neg_I)) * np.log((v0 + sqrt_neg_I) / (v0 - sqrt_neg_I))\n                \n                # Numerical calculation for error\n                integrand = lambda theta: 1.0 / ((1 + I) - (1 - I) * np.cos(theta))\n                t1_num, _ = integrate.quad(integrand, theta0, np.pi)\n                \n                errors.append(abs(t1_analyt - t1_num))\n                \n                # Generate spike (at most one)\n                if t1_analyt = T_end:\n                    spikes.append(t1_analyt)\n\n        # Format output for the current case\n        N = len(spikes)\n        E = max(errors) if errors else 0.0\n        \n        result_list = [N] + spikes + [E]\n        all_results.append(str(result_list))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}