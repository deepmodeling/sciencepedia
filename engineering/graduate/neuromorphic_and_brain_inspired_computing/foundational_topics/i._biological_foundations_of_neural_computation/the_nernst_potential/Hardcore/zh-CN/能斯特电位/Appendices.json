{
    "hands_on_practices": [
        {
            "introduction": "掌握能斯特方程的第一步是从基本原理出发，推导出它并应用于具体场景。本练习将指导您完成这一核心过程：通过设定电化学势在膜两侧相等，您将推导出特定离子（本例中为氯离子 $\\mathrm{Cl}^-$）的平衡电位，并计算其在典型生理条件下的数值。这项实践旨在巩固您对能斯特电位热力学基础的理解。",
            "id": "3938291",
            "problem": "一个单室神经元膜主要对氯离子($\\mathrm{Cl}^-$)具有通透性。设 $\\phi_i$ 和 $\\phi_o$ 分别表示细胞内和细胞外的电势，并设 $E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$ 为使氯离子净通量为零的跨膜电势差。对于一种可通透的离子，在平衡状态下，其在膜两侧的电化学势相等。假设为理想稀溶液，因此化学活度等于摩尔浓度。细胞内和细胞外的氯离子浓度分别为 $[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$ 和 $[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$。绝对温度为 $T = 310\\,\\mathrm{K}$，氯离子的化合价为 $z = -1$。使用气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和法拉第常数 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。 \n\n从化学势的定义和电化学平衡的条件出发，推导出用给定物理量表示的 $E_{\\mathrm{Cl}^-}$ 表达式，并根据所提供的数据计算其数值。最终答案以毫伏为单位，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确、客观且完整。它提出了一个生物物理化学中的标准练习，要求推导和计算氯离子的 Nernst 电势。所有必要的数据和常数都已提供，且条件在物理上和生物学上都是现实的。\n\n控制可通透离子跨膜平衡分布的基本原理是其在膜两侧的电化学势相等。溶液中离子种类 $j$ 的电化学势 $\\tilde{\\mu}_j$ 由其化学势和每摩尔的电势能之和给出：\n$$ \\tilde{\\mu}_j = \\mu_j^0 + RT \\ln(a_j) + z_j F \\phi $$\n其中 $\\mu_j^0$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$a_j$ 是离子的化学活度，$z_j$ 是其化合价（电荷数），$F$ 是法拉第常数，$\\phi$ 是局部电势。\n\n问题指明系统对于氯离子（$\\mathrm{Cl}^-$）处于平衡状态。因此，细胞内（$i$）一侧氯离子的电化学势必须等于细胞外（$o$）一侧的电化学势：\n$$ \\tilde{\\mu}_{\\mathrm{Cl}^-, i} = \\tilde{\\mu}_{\\mathrm{Cl}^-, o} $$\n代入两侧的电化学势表达式可得：\n$$ \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n标准化学势 $\\mu_{\\mathrm{Cl}^-}^0$ 是离子在给定溶剂和温度下的内禀属性，因此在两侧是相同的，可以消去：\n$$ RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n问题陈述假设为理想稀溶液，这意味着化学活度 $a_j$ 可以用摩尔浓度 $[\\mathrm{Cl}^-]_j$ 来近似。因此，$a_i = [\\mathrm{Cl}^-]_i$ 且 $a_o = [\\mathrm{Cl}^-]_o$。方程变为：\n$$ RT \\ln([\\mathrm{Cl}^-]_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln([\\mathrm{Cl}^-]_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n我们需要求出氯离子的 Nernst 电势 $E_{\\mathrm{Cl}^-}$，它被定义为平衡时的跨膜电势差，$E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$。重排方程以求解这个差值：\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln([\\mathrm{Cl}^-]_o) - RT \\ln([\\mathrm{Cl}^-]_i) $$\n使用对数性质 $\\ln(x) - \\ln(y) = \\ln(x/y)$：\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\n分离出电势差 $\\phi_i - \\phi_o$ 得到氯离子的 Nernst 方程：\n$$ E_{\\mathrm{Cl}^-} = \\phi_i - \\phi_o = \\frac{RT}{z_{\\mathrm{Cl}^-} F} \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\n现在，我们将给定的数值代入这个推导出的表达式中：\n细胞内氯离子浓度，$[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$。\n细胞外氯离子浓度，$[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$。\n绝对温度，$T = 310\\,\\mathrm{K}$。\n氯离子的化合价，$z = z_{\\mathrm{Cl}^-} = -1$。\n气体常数，$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n法拉第常数，$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。\n\n浓度比是一个无量纲的量：\n$$ \\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i} = \\frac{120\\,\\mathrm{mM}}{5\\,\\mathrm{mM}} = 24 $$\n将所有值代入 Nernst 方程：\n$$ E_{\\mathrm{Cl}^-} = \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(-1) \\times (96485.33212\\,\\mathrm{C\\,mol^{-1}})} \\ln(24) $$\n单位 $\\mathrm{J\\,C^{-1}}$ 等同于伏特（$\\mathrm{V}$）。让我们计算数值：\n$$ E_{\\mathrm{Cl}^-} = -\\frac{2577.48341158}{96485.33212} \\times \\ln(24) \\,\\mathrm{V} $$\n$$ E_{\\mathrm{Cl}^-} \\approx -(0.0267140866\\,\\mathrm{V}) \\times (3.17805383) $$\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386\\,\\mathrm{V} $$\n题目要求答案以毫伏（$\\mathrm{mV}$）为单位，并四舍五入到四位有效数字。要从伏特转换为毫伏，我们乘以 $1000$：\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386 \\times 1000\\,\\mathrm{mV} = -84.918386\\,\\mathrm{mV} $$\n四舍五入到四位有效数字，我们得到：\n$$ E_{\\mathrm{Cl}^-} \\approx -84.92\\,\\mathrm{mV} $$\n这个负值表明，在平衡状态下，细胞内部相对于外部呈电负性，这是为了抵消化学梯度，该梯度有利于氯离子从较高浓度的细胞外流入较低浓度的细胞内。",
            "answer": "$$\n\\boxed{-84.92}\n$$"
        },
        {
            "introduction": "在掌握了基本计算之后，理解不同离子如何对膜电位产生独特影响至关重要。本练习通过比较具有不同电荷（价态 $z$）的离子在相同浓度梯度下的能斯特电位，来检验您对能斯特方程结构性依赖的理解。通过此练习，您将能清晰地看到离子价态如何决定平衡电位的符号和幅度，这是理解细胞兴奋性的关键。",
            "id": "4065545",
            "problem": "一个神经形态膜模拟器设计有三个完美选择性的离子通道，分别用于化合价为 $z=+1$ 的单价阳离子 $X^+$、化合价为 $z=-1$ 的单价阴离子 $Y^-$，以及化合价为 $z=+2$ 的二价阳离子 $Z^{2+}$。该设备在温度 $T$ 下等温运行，其内部和外部溶液均为理想稀溶液。对于所有三种离子，外部浓度与内部浓度之比均相同，由 $\\rho = c_{\\mathrm{out}}/c_{\\mathrm{in}}$ 给出，且 $\\rho > 1$。膜电位定义为 $V_m = V_{\\mathrm{in}} - V_{\\mathrm{out}}$，对于给定的离子种类 $i$，其反转（能斯特）电位 $E_i$ 是指当净离子通量为零时的 $V_m$ 值，此时膜两侧的电化学势相等。\n\n从适用于理想溶液和电化学势平衡的第一性原理出发，确定在给定的共同比率 $\\rho$ 条件下，$E_{X^+}$、$E_{Y^-}$ 和 $E_{Z^{2+}}$ 在符号和大小上如何比较。特别地，选择能够正确描述它们之间关系，并由此解释在固定的 $\\rho$ 和 $T$ 条件下，反转电位与 $1/z$ 成比例的缩放关系的选项。\n\nA. $E_{X^+} = E_{Z^{2+}}$，且 $E_{Y^-} = - E_{X^+}$\n\nB. $E_{X^+} = 2 E_{Z^{2+}}$，且 $E_{Y^-} = - E_{X^+}$\n\nC. $E_{X^+} = \\dfrac{1}{2} E_{Z^{2+}}$，且 $E_{Y^-} = + E_{X^+}$\n\nD. $\\lvert E_{Z^{2+}} \\rvert = 2 \\lvert E_{X^+} \\rvert$，且 $E_{Y^-} = - E_{X^+}$\n\nE. $E_{X^+} = 2 E_{Z^{2+}}$，且 $E_{Y^-} = + E_{X^+}$",
            "solution": "用户希望我验证问题陈述，如果有效，则推导三种不同离子的能斯特电位之间的关系。\n\n### 步骤1：提取已知条件\n- **系统**：一个在温度 $T$ 下等温运行的神经形态膜模拟器。\n- **离子通道**：三种完美选择性通道，分别针对：\n    1.  化合价为 $z_{X^+} = +1$ 的单价阳离子 $X^+$。\n    2.  化合价为 $z_{Y^-} = -1$ 的单价阴离子 $Y^-$。\n    3.  化合价为 $z_{Z^{2+}} = +2$ 的二价阳离子 $Z^{2+}$。\n- **溶液**：内部和外部溶液均为理想稀溶液。\n- **浓度比**：对于所有三种离子，外部浓度与内部浓度之比均相同：$\\rho = \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}$。\n- **约束条件**：$\\rho > 1$。\n- **膜电位定义**：$V_m = V_{\\mathrm{in}} - V_{\\mathrm{out}}$。\n- **反转电位定义**：对于离子种类 $i$，其反转（能斯特）电位 $E_i$ 是指当净离子通量为零时的 $V_m$ 值，此时膜两侧的电化学势相等。\n- **任务**：确定 $E_{X^+}$、$E_{Y^-}$ 和 $E_{Z^{2+}}$ 之间的关系。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于能斯特方程，这是电化学和生物物理学中一个基本且公认的原理。涉及带有选择性离子通道的膜的设置是神经科学和神经形态工程中的标准模型。该问题在科学上是合理的。\n2.  **适定性**：该问题提供了所有必要信息（化合价、共同的浓度比以及能斯特电位的定义），足以唯一确定反转电位之间的关系。问题精确，并能导出一个唯一的答案。\n3.  **客观性**：语言正式、量化，没有主观或含糊的术语。\n4.  **不完整或矛盾的设置**：问题是自洽的，没有矛盾。为了进行比较，使用共同的浓度比 $\\rho$ 是一个有效的简化条件。\n5.  **不切实际或不可行**：“完美选择性”通道是一种理想化处理，但在这种情况下，它是应用基本能斯特方程的标准且必要的假设。条件 $\\rho > 1$ 对于生物系统中的许多离子（例如 $Na^+$、$Ca^{2+}$）在物理上是现实的。\n6.  **病态或结构不良**：该问题结构良好，能导出一个唯一、稳定的解。\n7.  **伪深刻、琐碎或同义反复**：该问题需要正确应用能斯特方程，并理解电位如何随离子化合价变化。这是一个核心概念，而不是一个琐碎的练习或同义反复。\n8.  **超出科学可验证性**：所涉及的原理在实验上和理论上都是可验证的。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。它在科学上是合理的，问题是适定的，并且包含了进行求解所需的所有必要信息。\n\n### 从第一性原理推导\n离子种类 $i$ 的能斯特电位（或反转电位）$E_i$ 是指当该离子没有净跨膜流动时的膜电位 $V_m = V_{\\mathrm{in}} - V_{\\mathrm{out}}$。当内部和外部隔室中的电化学势 $\\tilde{\\mu}_i$ 相同时，达到此平衡条件。\n\n在理想稀溶液中，离子种类 $i$ 的电化学势由下式给出：\n$$ \\tilde{\\mu}_i = \\mu_i^0 + RT \\ln(c_i) + z_i F V $$\n其中 $\\mu_i^0$ 是标准化学势，$R$ 是理想气体常数，$T$ 是绝对温度，$c_i$ 是离子的摩尔浓度，$z_i$ 是其化合价，$F$ 是法拉第常数，$V$ 是隔室的电位。\n\n在平衡状态下，$\\tilde{\\mu}_{i, \\mathrm{in}} = \\tilde{\\mu}_{i, \\mathrm{out}}$：\n$$ \\mu_i^0 + RT \\ln(c_{i, \\mathrm{in}}) + z_i F V_{\\mathrm{in}} = \\mu_i^0 + RT \\ln(c_{i, \\mathrm{out}}) + z_i F V_{\\mathrm{out}} $$\n标准电位 $\\mu_i^0$ 消去。重新排列各项以求解电位差 $V_{\\mathrm{in}} - V_{\\mathrm{out}}$：\n$$ z_i F (V_{\\mathrm{in}} - V_{\\mathrm{out}}) = RT \\ln(c_{i, \\mathrm{out}}) - RT \\ln(c_{i, \\mathrm{in}}) $$\n$$ z_i F (V_{\\mathrm{in}} - V_{\\mathrm{out}}) = RT \\ln\\left(\\frac{c_{i, \\mathrm{out}}}{c_{i, \\mathrm{in}}}\\right) $$\n能斯特电位 $E_i$ 就是这个特定的电位差：\n$$ E_i = V_{\\mathrm{in}} - V_{\\mathrm{out}} = \\frac{RT}{z_i F} \\ln\\left(\\frac{c_{i, \\mathrm{out}}}{c_{i, \\mathrm{in}}}\\right) $$\n该方程表明，反转电位与化合价 $z_i$ 成反比，正如问题描述中提到的。\n\n我们已知对于所有三种离子，浓度比 $\\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}} = \\rho$，且 $\\rho > 1$。让我们定义一个正常数因子 $K = \\frac{RT}{F} \\ln(\\rho)$。由于 $R, T, F$ 是正常数且 $\\rho > 1$，我们有 $\\ln(\\rho) > 0$，因此 $K > 0$。任何离子种类 $i$ 的能斯特方程简化为：\n$$ E_i = \\frac{K}{z_i} $$\n\n现在，我们计算每种离子的具体反转电位：\n\n1.  **对于阳离子 $X^+$**：\n    化合价为 $z_{X^+} = +1$。\n    $$ E_{X^+} = \\frac{RT}{(+1)F} \\ln(\\rho) = \\frac{RT}{F} \\ln(\\rho) = K $$\n\n2.  **对于阴离子 $Y^-$**：\n    化合价为 $z_{Y^-} = -1$。\n    $$ E_{Y^-} = \\frac{RT}{(-1)F} \\ln(\\rho) = -\\frac{RT}{F} \\ln(\\rho) = -K $$\n\n3.  **对于阳离子 $Z^{2+}$**：\n    化合价为 $z_{Z^{2+}} = +2$。\n    $$ E_{Z^{2+}} = \\frac{RT}{(+2)F} \\ln(\\rho) = \\frac{1}{2} \\frac{RT}{F} \\ln(\\rho) = \\frac{K}{2} $$\n\n现在我们可以建立这些电位之间的关系：\n- 比较 $E_{Y^-}$ 和 $E_{X^+}$：我们有 $E_{Y^-} = -K$ 和 $E_{X^+} = K$。因此，$E_{Y^-} = -E_{X^+}$。\n- 比较 $E_{X^+}$ 和 $E_{Z^{2+}}$：我们有 $E_{X^+} = K$ 和 $E_{Z^{2+}} = K/2$。因此，$E_{X^+} = 2 E_{Z^{2+}}$。\n\n这两个关系是：\n- $E_{X^+} = 2 E_{Z^{2+}}$\n- $E_{Y^-} = -E_{X^+}$\n\n### 逐项分析\nA. $E_{X^+} = E_{Z^{2+}}$，且 $E_{Y^-} = - E_{X^+}$\n第一部分，$E_{X^+} = E_{Z^{2+}}$，是错误的。我们的推导表明 $E_{X^+} = 2 E_{Z^{2+}}$，因为能斯特电位与化合价 ($1/z$) 成反比。第二部分是正确的。由于一部分是错误的，该选项**不正确**。\n\nB. $E_{X^+} = 2 E_{Z^{2+}}$，且 $E_{Y^-} = - E_{X^+}$\n第一部分，$E_{X^+} = 2 E_{Z^{2+}}$，根据我们的推导是正确的。第二部分，$E_{Y^-} = - E_{X^+}$，也是正确的，反映了离子的相反化合价。两部分都正确。该选项**正确**。\n\nC. $E_{X^+} = \\dfrac{1}{2} E_{Z^{2+}}$，且 $E_{Y^-} = + E_{X^+}$\n第一部分，$E_{X^+} = \\frac{1}{2} E_{Z^{2+}}$，是错误的。这颠倒了正确的关系。第二部分，$E_{Y^-} = + E_{X^+}$，是错误的。具有相同浓度比的阴离子和阳离子必须具有符号相反的能斯特电位。两部分都错误。该选项**不正确**。\n\nD. $\\lvert E_{Z^{2+}} \\rvert = 2 \\lvert E_{X^+} \\rvert$，且 $E_{Y^-} = - E_{X^+}$\n第一部分，$\\lvert E_{Z^{2+}} \\rvert = 2 \\lvert E_{X^+} \\rvert$，是错误的。由于 $\\rho > 1$，$E_{X^+}$ 和 $E_{Z^{2+}}$ 都是正的。我们发现 $E_{X^+} = 2 E_{Z^{2+}}$。取绝对值得到 $\\lvert E_{X^+} \\rvert = 2 \\lvert E_{Z^{2+}} \\rvert$。这个选项陈述的是相反的关系。第二部分是正确的。由于一部分是错误的，该选项**不正确**。\n\nE. $E_{X^+} = 2 E_{Z^{2+}}$，且 $E_{Y^-} = + E_{X^+}$\n第一部分，$E_{X^+} = 2 E_{Z^{2+}}$，是正确的。第二部分，$E_{Y^-} = + E_{X^+}$，是错误的。它们的电位必须有相反的符号。由于一部分是错误的，该选项**不正确**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "静态的平衡电位是理解神经信号的基础，但在真实生物系统和神经形态电路中，动态变化才是常态。本练习将理论与实践相结合，要求您模拟温度瞬变对离子通道电流的影响。您将探索能斯特电位的动态变化如何改变离子的驱动力，甚至可能导致电流方向的反转，这对于设计和分析对环境变化敏感的神经形态设备至关重要。",
            "id": "4065599",
            "problem": "一个神经形态离子通道被建模为一个被动电导，该电导瞬时跟随电化学驱动力。考虑一个单一离子种类，其化合价为 $z$，细胞内浓度为 $c_{\\mathrm{in}}$，细胞外浓度为 $c_{\\mathrm{out}}$，以及一个恒定的膜电位 $V_m$。设绝对温度随时间变化，为 $T(t)$。离子电流的模型为 $I(t) = g \\left( V_m - E(t) \\right)$，其中 $g$ 是通道电导，$E(t)$ 是该离子种类的反转电位。推导时使用以下基本原理：每摩尔离子的电化学势为 $\\mu = \\mu^0 + RT \\ln c + z F \\phi$，其中 $R$ 是气体常数，$F$ 是法拉第常数，$c$ 是浓度，$\\phi$ 是电势。在平衡状态（无净通量）下，内部和外部的电化学势相等。从这些事实出发，根据第一性原理推导出 $E(t)$ 必须如何用 $T(t)$、$z$、$c_{\\mathrm{in}}$ 和 $c_{\\mathrm{out}}$ 来表示，不得使用任何预先引用的反转电位公式。\n\n温度由一个瞬变过程驱动：\n$$\nT(t) =\n\\begin{cases}\nT_0,  t  t_{\\mathrm{start}}, \\\\\nT_0 + \\Delta T \\, e^{-\\frac{t - t_{\\mathrm{start}}}{\\tau_T}},  t \\ge t_{\\mathrm{start}},\n\\end{cases}\n$$\n其中 $T_0$ 是基线温度，$\\Delta T$ 是在时间 $t_{\\mathrm{start}}$ 时的瞬时增量，$\\tau_T$ 是衰减时间常数。\n\n您的任务是：\n- 从基本原理出发，推导出 $E(t)$。\n- 对于每个测试案例，计算在 $T(t) = T_0$ 时的基线反转电位 $E_0 = E(t  t_{\\mathrm{start}})$（单位：伏特），计算峰值反转电位 $E_{\\mathrm{peak}} = E(t_{\\mathrm{start}}^+)$（单位：伏特）（即在瞬变开始后，$T = T_0 + \\Delta T$ 时），并确定在瞬变期间电流方向是否发生翻转。翻转定义为 $I(t)$ 的符号与其基线符号发生改变；形式上，如果 $\\mathrm{sgn}\\!\\left(I(0^-)\\right)$ 非零，当存在一个时间 $t$ 使得 $\\mathrm{sgn}\\!\\left(I(t)\\right) = -\\mathrm{sgn}\\!\\left(I(0^-)\\right)$ 时，则发生翻转。如果 $\\mathrm{sgn}\\!\\left(I(0^-)\\right) = 0$，则仅当存在时间 $t_1$ 和 $t_2$ 使得 $\\mathrm{sgn}\\!\\left(I(t_1)\\right) = +1$ 且 $\\mathrm{sgn}\\!\\left(I(t_2)\\right) = -1$ 时，才定义为发生翻转。\n- 所有电位以伏特表示，电流以安培表示；时间以秒表示，温度以开尔文表示。在最终输出中，将所有电压四舍五入到六位小数，并将翻转决策报告为布尔值。\n\n使用常数 $R = 8.314462618$（焦耳/摩尔/开尔文）和 $F = 96485.33212$（库仑/摩尔）。浓度 $c_{\\mathrm{in}}$ 和 $c_{\\mathrm{out}}$ 的单位为 $\\mathrm{mol}/\\mathrm{m}^3$。测试套件和参数如下：\n\n- 案例 $1$ (一价阳离子): $z = 1$, $c_{\\mathrm{out}} = 5$, $c_{\\mathrm{in}} = 140$, $V_m = -0.065$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, 在 $[0, 0.2]$ 上以时间步长 $\\Delta t = 0.0001$ 进行模拟。\n- 案例 $2$ (一价阴离子): $z = -1$, $c_{\\mathrm{out}} = 110$, $c_{\\mathrm{in}} = 10$, $V_m = -0.067$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, 在 $[0, 0.2]$ 上以时间步长 $\\Delta t = 0.0001$ 进行模拟。\n- 案例 $3$ (二价阳离子): $z = 2$, $c_{\\mathrm{out}} = 2000$, $c_{\\mathrm{in}} = 0.1$, $V_m = 0.135$, $g = 5\\times 10^{-10}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, 在 $[0, 0.2]$ 上以时间步长 $\\Delta t = 0.0001$ 进行模拟。\n- 案例 $4$ (边界浓度): $z = 1$, $c_{\\mathrm{out}} = 100$, $c_{\\mathrm{in}} = 100$, $V_m = 0$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, 在 $[0, 0.2]$ 上以时间步长 $\\Delta t = 0.0001$ 进行模拟。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个形如 `[E_0, E_peak, flip]` 的子列表，例如 `[[0.001234,0.001567,True],[\\dots]]`。所有电压必须四舍五入到六位小数，布尔值必须为 `True` 或 `False`。",
            "solution": "问题陈述经评估具有科学依据、问题明确且客观。它基于电化学和生物物理学的基本原理，为获得唯一解提供了所有必要的数据和约束条件，并且没有歧义或主观论断。因此，该问题被认定为**有效**。\n\n任务是从第一性原理推导反转电位 $E(t)$，然后用它来分析离子通道在温度瞬变下的行为。\n\n**第一部分：反转电位 $E(t)$ 的推导**\n\n推导从给定的单一离子种类的电化学势 $\\mu$ 的表达式开始：\n$$\n\\mu = \\mu^0 + RT \\ln c + z F \\phi\n$$\n在此，$\\mu^0$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$c$ 是离子的摩尔浓度，$z$ 是离子的化合价，$F$ 是法拉第常数，$\\phi$ 是电势。\n\n反转电位 $E(t)$ 定义为在该膜电位下，没有离子净跨膜流动。这种零净通量状态对应于热力学平衡。平衡的条件是细胞内离子的电化学势 $\\mu_{\\mathrm{in}}$ 等于细胞外离子的电化学势 $\\mu_{\\mathrm{out}}$。\n\n$$\n\\mu_{\\mathrm{in}} = \\mu_{\\mathrm{out}}\n$$\n我们可以用电化学势的完整表达式来写出这个等式。设 $c_{\\mathrm{in}}$ 和 $\\phi_{\\mathrm{in}}$ 为细胞内的浓度和电势，$c_{\\mathrm{out}}$ 和 $\\phi_{\\mathrm{out}}$ 为细胞外的相应量。假设在任何给定时间 $t$，温度 $T(t)$ 在整个膜上是均匀的。\n\n$$\n\\mu^0 + R T(t) \\ln c_{\\mathrm{in}} + z F \\phi_{\\mathrm{in}} = \\mu^0 + R T(t) \\ln c_{\\mathrm{out}} + z F \\phi_{\\mathrm{out}}\n$$\n\n标准化学势项 $\\mu^0$ 在两侧相同，因此可以消去。\n$$\nR T(t) \\ln c_{\\mathrm{in}} + z F \\phi_{\\mathrm{in}} = R T(t) \\ln c_{\\mathrm{out}} + z F \\phi_{\\mathrm{out}}\n$$\n\n我们重排方程以求解跨膜电位差 $\\Delta\\phi = \\phi_{\\mathrm{in}} - \\phi_{\\mathrm{out}}$。根据定义，这个平衡时的电位差就是反转电位 $E(t)$。\n$$\nz F \\phi_{\\mathrm{in}} - z F \\phi_{\\mathrm{out}} = R T(t) \\ln c_{\\mathrm{out}} - R T(t) \\ln c_{\\mathrm{in}}\n$$\n$$\nz F (\\phi_{\\mathrm{in}} - \\phi_{\\mathrm{out}}) = R T(t) (\\ln c_{\\mathrm{out}} - \\ln c_{\\mathrm{in}})\n$$\n使用对数性质 $\\ln a - \\ln b = \\ln(a/b)$，我们得到：\n$$\nz F E(t) = R T(t) \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n$$\n解出 $E(t)$ 得到与时间相关的 Nernst 方程：\n$$\nE(t) = \\frac{R T(t)}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n$$\n这个方程确立了反转电位是随时间变化的温度 $T(t)$、固定的离子浓度 $c_{\\mathrm{in}}$ 和 $c_{\\mathrm{out}}$ 以及化合价 $z$ 的直接函数。\n\n**第二部分：系统动力学分析**\n\n问题要求为每个测试案例计算三个量：\n1.  **基线反转电位 $E_0$**：这是在基线温度 $T_0$ 下的电位，它发生在任何时间 $t  t_{\\mathrm{start}}$。\n    $$\n    E_0 = E(t  t_{\\mathrm{start}}) = \\frac{R T_0}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n    $$\n2.  **峰值反转电位 $E_{\\mathrm{peak}}$**：这是在 $t = t_{\\mathrm{start}}^+$ 时，温度瞬变开始后立即产生的电位。在这一刻，温度为 $T(t_{\\mathrm{start}}^+) = T_0 + \\Delta T e^0 = T_0 + \\Delta T$。\n    $$\n    E_{\\mathrm{peak}} = E(t_{\\mathrm{start}}^+) = \\frac{R (T_0 + \\Delta T)}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n    $$\n3.  **电流翻转判定**：离子电流由 $I(t) = g(V_m - E(t))$ 给出。由于电导 $g$ 是一个正常数，电流的符号 $\\mathrm{sgn}(I(t))$ 完全由驱动力 $V_m - E(t)$ 的符号决定。如果驱动力的符号从其基线值改变，则发生电流翻转。\n    基线驱动力的符号是 $\\mathrm{sgn}(V_m - E_0)$。要发生翻转，必须存在一个时间 $t \\ge t_{\\mathrm{start}}$，使得 $\\mathrm{sgn}(V_m - E(t))$ 与 $\\mathrm{sgn}(V_m - E_0)$ 相反。\n    对于 $t \\ge t_{\\mathrm{start}}$，温度 $T(t)$ 从 $T_0 + \\Delta T$ 开始，单调衰减至 $T_0$。因此，反转电位 $E(t)$ 从 $E_{\\mathrm{peak}}$ 开始，单调移向 $E_0$。在瞬变期间，$E(t)$ 所取的值的集合是 $E_0$ 和 $E_{\\mathrm{peak}}$ 之间的闭区间。\n    驱动力 $V_m - E(t)$ 会改变符号，当且仅当恒定膜电位 $V_m$ 严格位于瞬变期间反转电位的初始值和最终值之间。也就是说，如果 $V_m$ 严格介于 $E_0$ 和 $E_{\\mathrm{peak}}$ 之间，则发生翻转。这个条件可以用数学方式表示为：\n    $$\n    (V_m - E_0)(V_m - E_{\\mathrm{peak}})  0\n    $$\n    这个不等式可作为判断电流翻转是否发生的直接测试，从而无需进行完整时域仿真。\n\n基线电流为零的特殊情况（$V_m = E_0$）也由这个条件处理。在这种情况下，$(V_m - E_0)$ 为零，因此乘积为零，而不是负数。所以不会记录为翻转。这与问题中对从零电流开始的翻转的定义一致，该定义要求电流同时取正值和负值。由于在瞬变期间 $E(t)$ 将完全位于 $E_0=V_m$ 的一侧（假设 $E_0 \\neq E_{peak}$），电流 $I(t)$ 将非零但不会改变其符号。如果 $E_0 = E_{peak}$（如在 $c_{in} = c_{out}$ 的情况下），则电流在整个过程中保持为零。\n\n每个案例的计算将基于这些推导出的公式进行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neuromorphic ion channel problem by deriving and calculating\n    key potential values and determining if a current flip occurs.\n    \"\"\"\n    # Define physical constants\n    R = 8.314462618  # J / (mol * K)\n    F = 96485.33212  # C / mol\n\n    # Define the test cases from the problem statement.\n    # Format: (z, c_out, c_in, V_m, g, T0, delta_T, t_start, tau_T)\n    test_cases = [\n        # Case 1 (monovalent cation)\n        (1, 5.0, 140.0, -0.065, 1e-9, 310.0, 30.0, 0.05, 0.05),\n        # Case 2 (monovalent anion)\n        (-1, 110.0, 10.0, -0.067, 1e-9, 310.0, 30.0, 0.05, 0.05),\n        # Case 3 (divalent cation)\n        (2, 2000.0, 0.1, 0.135, 5e-10, 310.0, 30.0, 0.05, 0.05),\n        # Case 4 (boundary concentrations)\n        (1, 100.0, 100.0, 0.0, 1e-9, 310.0, 30.0, 0.05, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        z, c_out, c_in, V_m, g, T0, delta_T, t_start, tau_T = case\n\n        # The term R/F has units of Volts / K\n        # The term ln(c_out / c_in) is dimensionless\n        \n        # Calculate ln(c_out / c_in)\n        # Check for c_in = c_out to avoid potential floating point issues,\n        # although np.log(1.0) is exactly 0.0.\n        if c_out == c_in:\n            log_c_ratio = 0.0\n        else:\n            log_c_ratio = np.log(c_out / c_in)\n\n        # Prefactor for Nernst potential calculation\n        # E(T) = (RT/zF) * log_c_ratio = (R/F) * (T/z) * log_c_ratio\n        if z == 0:\n            # Handle non-ionic species, though not in test cases\n            # If z=0, the electric potential term in the electrochemical potential\n            # is zero. Equilibrium is only possible if concentrations are equal\n            # (log_c_ratio=0). In this case, E is undefined but the driving force\n            # is independent of V_m, and no current flows unless other forces exist.\n            # For this problem, we can assume z is non-zero.\n            pass\n        \n        # Calculate baseline reversal potential E0 at temperature T0\n        E0 = (R * T0 / (z * F)) * log_c_ratio\n\n        # Calculate peak temperature and peak reversal potential E_peak\n        T_peak = T0 + delta_T\n        E_peak = (R * T_peak / (z * F)) * log_c_ratio\n        \n        # Determine if a current flip occurs.\n        # A flip occurs if V_m lies strictly between E0 and E_peak.\n        # This can be tested by checking if (V_m - E0) and (V_m - E_peak)\n        # have opposite signs, which means their product is negative.\n        # If V_m is equal to E0 or E_peak, the product is 0, no flip.\n        # If V_m is outside the range [E0, E_peak], the product is positive, no flip.\n        flip = (V_m - E0) * (V_m - E_peak)  0\n        \n        results.append([E0, E_peak, flip])\n\n    # Format the final output string exactly as required.\n    # Voltages are rounded to six decimal places, and booleans are 'True' or 'False'.\n    output_parts = []\n    for result in results:\n        e0_val, epeak_val, flip_val = result\n        # Round the numerical values\n        e0_rounded = round(e0_val, 6)\n        epeak_rounded = round(epeak_val, 6)\n        # Format the sublist string\n        output_parts.append(f\"[{e0_rounded:.6f},{epeak_rounded:.6f},{flip_val}]\")\n    \n    # Join all sublist strings into the final output format\n    final_output = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}