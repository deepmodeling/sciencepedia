{
    "hands_on_practices": [
        {
            "introduction": "The foundation of all bioelectricity lies in the electrochemical potential established by ion concentration gradients across the cell membrane. The Nernst equation provides the essential tool to calculate the equilibrium potential for a single ion—the membrane voltage at which the electrical and chemical driving forces are perfectly balanced. This first exercise  will have you apply this fundamental equation to calculate the equilibrium potential for calcium ($Ca^{2+}$), an ion crucial for processes like neurotransmitter release, reinforcing your understanding of how ionic gradients generate voltage.",
            "id": "2320928",
            "problem": "The influx of calcium ions ($Ca^{2+}$) into a neuron's presynaptic terminal is a critical step for triggering neurotransmitter release. The direction and magnitude of this ion flow are governed by the electrochemical gradient, which depends on both the concentration difference across the membrane and the membrane potential. A key parameter for understanding this gradient is the equilibrium potential for the ion, the membrane voltage at which there is no net flow of that particular ion across the membrane.\n\nConsider a typical mammalian neuron at a physiological temperature of $37.0^{\\circ}\\text{C}$. The extracellular concentration of $Ca^{2+}$ is maintained at $2.0 \\text{ mM}$, while the free intracellular concentration of $Ca^{2+}$ in the resting state is kept very low, at $100 \\text{ nM}$. Using the provided physical constants, calculate the equilibrium potential for calcium ions for this neuron.\n\n**Physical Constants:**\n- Gas constant, $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n- Faraday constant, $F = 96485 \\text{ C} \\cdot \\text{mol}^{-1}$\n\nExpress your answer in millivolts (mV), rounded to three significant figures.",
            "solution": "We use the Nernst equation for an ion with valence $z$:\n$$\nE_{ion}=\\frac{R T}{z F}\\ln\\!\\left(\\frac{[\\text{ion}]_{o}}{[\\text{ion}]_{i}}\\right).\n$$\nFor calcium, $z=+2$. Convert temperature to Kelvin:\n$$\nT=37.0+273.15=310.15\\ \\text{K}.\n$$\nConvert concentrations to the same units and form the ratio:\n$$\n[\\text{Ca}^{2+}]_{o}=2.0\\ \\text{mM}=2.0\\times 10^{-3}\\ \\text{M},\\quad [\\text{Ca}^{2+}]_{i}=100\\ \\text{nM}=1.0\\times 10^{-7}\\ \\text{M},\n$$\n$$\n\\frac{[\\text{Ca}^{2+}]_{o}}{[\\text{Ca}^{2+}]_{i}}=\\frac{2.0\\times 10^{-3}}{1.0\\times 10^{-7}}=2.0\\times 10^{4}.\n$$\nSubstitute into the Nernst equation:\n$$\nE_{\\text{Ca}}=\\frac{R T}{2 F}\\ln\\!\\left(2.0\\times 10^{4}\\right).\n$$\nEvaluate the thermal voltage factor using the provided constants:\n$$\n\\frac{R T}{F}=\\frac{(8.314)\\times(310.15)}{96485}\\ \\text{V}\\approx 2.6730\\times 10^{-2}\\ \\text{V},\n$$\nso\n$$\n\\frac{R T}{2 F}\\approx 1.3365\\times 10^{-2}\\ \\text{V}.\n$$\nCompute the logarithm:\n$$\n\\ln\\!\\left(2.0\\times 10^{4}\\right)=\\ln(2.0)+4\\ln(10)\\approx 0.693147+9.210340\\approx 9.903487.\n$$\nThus,\n$$\nE_{\\text{Ca}}\\approx \\left(1.3365\\times 10^{-2}\\ \\text{V}\\right)\\times 9.903487\\approx 1.32360\\times 10^{-1}\\ \\text{V}=132.360\\ \\text{mV}.\n$$\nRounded to three significant figures, the equilibrium potential is $132\\ \\text{mV}$.",
            "answer": "$$\\boxed{132}$$"
        },
        {
            "introduction": "While the Nernst potential describes a single ion's ideal equilibrium, a neuron's resting membrane potential is a steady state determined by the contributions of multiple ion species simultaneously. This practice  moves beyond a single ion to model the integrated resting potential using the chord conductance equation. By calculating the steady-state potential as a weighted average of the Nernst potentials for potassium, sodium, and chloride, you will develop a quantitative intuition for how the relative conductances ($g_i$) of different ions establish the overall voltage of a resting neuron.",
            "id": "2950161",
            "problem": "A small isopotential cell at thermal equilibrium is bathed in fixed extracellular and intracellular ionic solutions such that the Nernst reversal potentials for potassium, sodium, and chloride are constant at $E_{\\text{K}}=-90\\ \\text{mV}$, $E_{\\text{Na}}=+60\\ \\text{mV}$, and $E_{\\text{Cl}}=-65\\ \\text{mV}$, respectively. The membrane expresses ohmic potassium, sodium, and chloride channels whose open-channel conductances are constant in time and voltage independent, with values $g_{\\text{K}}=10\\ \\text{nS}$, $g_{\\text{Na}}=1\\ \\text{nS}$, and $g_{\\text{Cl}}=3\\ \\text{nS}$. Assume the membrane is otherwise passive, that the only transmembrane currents are the ionic currents through these channels, and that the contribution of any electrogenic pumps is negligible on the timescale of interest. The resting potential $V_{\\text{rest}}$ is defined as the steady state at which the membrane potential is time invariant.\n\nStarting from conservation of charge at the membrane and the linear (ohmic) current-voltage relation for each ionic species, derive an expression for the steady-state membrane potential $V_{\\text{rest}}$ in terms of $\\{g_{i}\\}$ and $\\{E_{i}\\}$ and then evaluate it numerically using the given parameters. Round your final numerical result to four significant figures and express it in $\\text{mV}$.",
            "solution": "The problem presented is a standard, well-posed exercise in quantitative membrane biophysics and is therefore valid. We shall proceed with its formal derivation and solution.\n\nThe fundamental principle governing the membrane potential in a steady state is the conservation of charge. For a small isopotential cell, the membrane acts as a capacitor. The rate of change of the membrane potential, $V_m$, is related to the total transmembrane current, $I_{\\text{total}}$, and the membrane capacitance, $C_m$, by the equation:\n$$ C_m \\frac{dV_m}{dt} = -I_{\\text{total}} $$\nThe problem defines the resting potential, $V_{\\text{rest}}$, as the steady state where the membrane potential is time-invariant. This condition, $\\frac{dV_m}{dt} = 0$, implies that the total transmembrane current must be zero:\n$$ I_{\\text{total}} = 0 $$\nThe problem states that the only significant currents are the ionic currents through potassium ($K^+$), sodium ($Na^+$), and chloride ($Cl^-$) channels. Therefore, the total current is the algebraic sum of these individual ionic currents:\n$$ I_{\\text{total}} = I_{\\text{K}} + I_{\\text{Na}} + I_{\\text{Cl}} = 0 $$\nEach ionic current, $I_i$, is described by a linear, ohmic current-voltage relationship. The current for a given ionic species $i$ is the product of its conductance, $g_i$, and its electrochemical driving force, $(V_m - E_i)$, where $E_i$ is the Nernst reversal potential for that ion.\n$$ I_i = g_i (V_m - E_i) $$\nThis relation holds for all ions, irrespective of their charge. The sign of the ionic charge is implicitly accounted for in the value of the Nernst potential, $E_i$.\n\nSubstituting the ohmic relations for $I_{\\text{K}}$, $I_{\\text{Na}}$, and $I_{\\text{Cl}}$ into the zero-current condition, we have:\n$$ g_{\\text{K}}(V_m - E_{\\text{K}}) + g_{\\text{Na}}(V_m - E_{\\text{Na}}) + g_{\\text{Cl}}(V_m - E_{\\text{Cl}}) = 0 $$\nAt steady state, the membrane potential $V_m$ is the resting potential, $V_{\\text{rest}}$. Substituting $V_m = V_{\\text{rest}}$:\n$$ g_{\\text{K}}(V_{\\text{rest}} - E_{\\text{K}}) + g_{\\text{Na}}(V_{\\text{rest}} - E_{\\text{Na}}) + g_{\\text{Cl}}(V_{\\text{rest}} - E_{\\text{Cl}}) = 0 $$\nThis is a linear algebraic equation for $V_{\\text{rest}}$. To solve for $V_{\\text{rest}}$, we expand the equation:\n$$ g_{\\text{K}}V_{\\text{rest}} - g_{\\text{K}}E_{\\text{K}} + g_{\\text{Na}}V_{\\text{rest}} - g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{Cl}}V_{\\text{rest}} - g_{\\text{Cl}}E_{\\text{Cl}} = 0 $$\nNext, we consolidate terms containing $V_{\\text{rest}}$ on one side of the equation and all other terms on the opposite side:\n$$ (g_{\\text{K}} + g_{\\text{Na}} + g_{\\text{Cl}}) V_{\\text{rest}} = g_{\\text{K}}E_{\\text{K}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{Cl}}E_{\\text{Cl}} $$\nIsolating $V_{\\text{rest}}$ yields the general expression for the resting potential as a weighted average of the Nernst potentials, where the conductances serve as the weighting factors. This is a form of the chord conductance equation:\n$$ V_{\\text{rest}} = \\frac{g_{\\text{K}}E_{\\text{K}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{Cl}}E_{\\text{Cl}}}{g_{\\text{K}} + g_{\\text{Na}} + g_{\\text{Cl}}} $$\nThis expression represents the first part of the required answer.\n\nFor the second part, we substitute the given numerical values into this derived expression. The parameters are:\n- $E_{\\text{K}} = -90\\ \\text{mV}$\n- $E_{\\text{Na}} = +60\\ \\text{mV}$\n- $E_{\\text{Cl}} = -65\\ \\text{mV}$\n- $g_{\\text{K}} = 10\\ \\text{nS}$\n- $g_{\\text{Na}} = 1\\ \\text{nS}$\n- $g_{\\text{Cl}} = 3\\ \\text{nS}$\n\nFirst, we calculate the numerator, which is the sum of the products of conductance and Nernst potential for each ion:\n$$ \\text{Numerator} = (10\\ \\text{nS})(-90\\ \\text{mV}) + (1\\ \\text{nS})(60\\ \\text{mV}) + (3\\ \\text{nS})(-65\\ \\text{mV}) $$\n$$ \\text{Numerator} = -900\\ \\text{nS} \\cdot \\text{mV} + 60\\ \\text{nS} \\cdot \\text{mV} - 195\\ \\text{nS} \\cdot \\text{mV} $$\n$$ \\text{Numerator} = -1035\\ \\text{nS} \\cdot \\text{mV} $$\nNext, we calculate the denominator, which is the total membrane conductance:\n$$ \\text{Denominator} = 10\\ \\text{nS} + 1\\ \\text{nS} + 3\\ \\text{nS} $$\n$$ \\text{Denominator} = 14\\ \\text{nS} $$\nNow we compute the value of $V_{\\text{rest}}$:\n$$ V_{\\text{rest}} = \\frac{-1035\\ \\text{nS} \\cdot \\text{mV}}{14\\ \\text{nS}} $$\n$$ V_{\\text{rest}} = -\\frac{1035}{14}\\ \\text{mV} \\approx -73.92857\\ \\text{mV} $$\nThe problem requires the result to be rounded to four significant figures.\n$$ V_{\\text{rest}} \\approx -73.93\\ \\text{mV} $$\nThis value represents the steady-state membrane potential at which the net influx of charge carried by sodium ions is exactly balanced by the net efflux of charge carried by potassium and chloride ions, resulting in zero total current across the membrane.",
            "answer": "$$\n\\boxed{-73.93}\n$$"
        },
        {
            "introduction": "To capture the dynamic essence of neuronal computation—the action potential—we must move from static, steady-state descriptions to models where ion conductances are themselves functions of voltage and time. This advanced computational practice  challenges you to implement the seminal Hodgkin-Huxley model, the first complete mathematical description of the action potential. You will use numerical simulation to determine the rheobase, a key measure of neuronal excitability, and investigate how it changes with underlying biophysical parameters, providing a direct, hands-on bridge between ion channel properties and emergent neuronal function.",
            "id": "2950135",
            "problem": "You are asked to formalize and compute how increasing the maximum sodium conductance by $20\\%$ changes the rheobase current in a single-compartment Hodgkin–Huxley (HH) model. The rheobase is defined here as the minimum constant injected current density $I_{\\text{inj}}$ (in $\\mu\\text{A}/\\text{cm}^2$) that produces at least one action potential when applied for a finite duration to the HH membrane model.\n\nStart from the following fundamental base:\n- Current balance at the membrane capacitance: $$C_{\\text{m}}\\frac{dV}{dt} = - I_{\\text{Na}} - I_{\\text{K}} - I_{\\text{L}} + I_{\\text{inj}},$$ where $C_{\\text{m}}$ is the membrane capacitance per unit area, $V$ is the membrane potential (in $\\text{mV}$), $I_{\\text{inj}}$ is the injected current density (in $\\mu\\text{A}/\\text{cm}^2$), and $I_{\\text{Na}}, I_{\\text{K}}, I_{\\text{L}}$ are the sodium, potassium, and leak currents, respectively.\n- Ionic currents follow Ohm’s law with voltage- and state-dependent conductances: $$I_{\\text{Na}} = \\bar{g}_{\\text{Na}}\\,m^3h\\,(V - E_{\\text{Na}}),\\quad I_{\\text{K}} = \\bar{g}_{\\text{K}}\\,n^4\\,(V - E_{\\text{K}}),\\quad I_{\\text{L}} = \\bar{g}_{\\text{L}}\\,(V - E_{\\text{L}}),$$ where $\\bar{g}_{\\text{Na}}, \\bar{g}_{\\text{K}}, \\bar{g}_{\\text{L}}$ are maximum conductances (in $\\text{mS}/\\text{cm}^2$), $E_{\\text{Na}}, E_{\\text{K}}, E_{\\text{L}}$ are reversal potentials (in $\\text{mV}$), and $m,h,n$ are gating variables with dynamics defined below.\n- Gating variable dynamics at $6.3^{\\circ}\\text{C}$ (standard Hodgkin–Huxley 1952 rate laws): $$\\frac{dm}{dt} = \\alpha_m(V)\\,(1-m) - \\beta_m(V)\\,m,\\quad \\frac{dh}{dt} = \\alpha_h(V)\\,(1-h) - \\beta_h(V)\\,h,\\quad \\frac{dn}{dt} = \\alpha_n(V)\\,(1-n) - \\beta_n(V)\\,n,$$\nwith rate functions\n$$\\alpha_m(V) = \\frac{0.1\\,(V+40)}{1 - e^{-(V+40)/10}},\\quad \\beta_m(V) = 4\\,e^{-(V+65)/18},$$\n$$\\alpha_h(V) = 0.07\\,e^{-(V+65)/20},\\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}},$$\n$$\\alpha_n(V) = \\frac{0.01\\,(V+55)}{1 - e^{-(V+55)/10}},\\quad \\beta_n(V) = 0.125\\,e^{-(V+65)/80}.$$\n\nUse the following fixed parameters unless explicitly varied in the test suite:\n- Membrane capacitance: $C_{\\text{m}} = 1\\ \\mu\\text{F}/\\text{cm}^2$.\n- Reversal potentials: $E_{\\text{Na}} = 50\\ \\text{mV}$, $E_{\\text{K}} = -77\\ \\text{mV}$, $E_{\\text{L}} = -54.4\\ \\text{mV}$.\n- Baseline maximum conductances: $\\bar{g}_{\\text{Na}} = 120\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{L}} = 0.3\\ \\text{mS}/\\text{cm}^2$.\n\nInitial conditions at $t=0$:\n- Membrane potential: $V(0) = -65\\ \\text{mV}$.\n- Gating variables at steady state at $V=-65\\ \\text{mV}$: $$x(0) = \\frac{\\alpha_x(-65)}{\\alpha_x(-65) + \\beta_x(-65)}\\ \\text{for}\\ x \\in \\{m,h,n\\}.$$\n\nDefinition of a spike for this task:\n- A spike is detected if $V(t)$ crosses $0\\ \\text{mV}$ from below (an upward crossing) at any time during the simulation window.\n\nNumerical and algorithmic requirements:\n- Simulate for a finite window of $T = 200\\ \\text{ms}$ with a fixed time step $\\Delta t = 0.01\\ \\text{ms}$ using a numerically stable ordinary differential equation integrator (for example, a fourth-order Runge–Kutta method). Keep $m,h,n$ numerically constrained within $[0,1]$ after each update.\n- Determine the rheobase by a one-dimensional search over constant $I_{\\text{inj}}$ applied over the entire window $[0,T]$. Use a bracketing and binary search strategy: start from a lower bound $I_{\\min} = 0\\ \\mu\\text{A}/\\text{cm}^2$, expand an upper bound $I_{\\max}$ by doubling until a spike is produced or until reaching a hard ceiling of $I_{\\max} = 2000\\ \\mu\\text{A}/\\text{cm}^2$. Then binary search between the current bracket to within a tolerance of $\\varepsilon = 10^{-3}\\ \\mu\\text{A}/\\text{cm}^2$.\n- If no spike is produced even at the hard ceiling, return the ceiling rheobase value $2000.0$ for that test case.\n\nTest suite:\nCompute the rheobase current density for the following four parameter sets, each with a constant $I_{\\text{inj}}$ over $T$:\n- Case $1$ (baseline): $\\bar{g}_{\\text{Na}} = 120\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{L}} = 0.3\\ \\text{mS}/\\text{cm}^2$.\n- Case $2$ (sodium increased by $20\\%$): $\\bar{g}_{\\text{Na}} = 1.2 \\times 120\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{L}} = 0.3\\ \\text{mS}/\\text{cm}^2$.\n- Case $3$ (higher leak): $\\bar{g}_{\\text{Na}} = 120\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{L}} = 0.6\\ \\text{mS}/\\text{cm}^2$.\n- Case $4$ (higher leak and sodium increased by $20\\%$): $\\bar{g}_{\\text{Na}} = 1.2 \\times 120\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\text{mS}/\\text{cm}^2$, $\\bar{g}_{\\text{L}} = 0.6\\ \\text{mS}/\\text{cm}^2$.\n\nAnswer specification and output format:\n- For each case, compute the rheobase current density as a single float in $\\mu\\text{A}/\\text{cm}^2$, rounded to $3$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of cases $1$ through $4$ (e.g., $\"[6.302,5.118,10.441,8.997]\"$), with no additional text.",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and computationally tractable. It presents a standard problem in computational neuroscience, requiring the numerical determination of the rheobase current in the Hodgkin-Huxley model. We will proceed with a complete, reasoned solution.\n\nThe core of the problem is to solve a system of four coupled, nonlinear, first-order ordinary differential equations (ODEs) that constitute the Hodgkin-Huxley model. The state of the system at any time $t$ is described by the vector $Y(t) = [V(t), m(t), h(t), n(t)]^T$, where $V$ is the membrane potential, and $m$, $h$, and $n$ are the gating variables for the sodium and potassium ion channels.\n\nThe system of ODEs is given by $\\frac{dY}{dt} = F(Y, I_{\\text{inj}})$, where the vector function $F$ is defined as follows:\n$$\n\\frac{dV}{dt} = \\frac{1}{C_{\\text{m}}} \\left( I_{\\text{inj}} - \\bar{g}_{\\text{Na}}m^3h(V - E_{\\text{Na}}) - \\bar{g}_{\\text{K}}n^4(V - E_{\\text{K}}) - \\bar{g}_{\\text{L}}(V - E_{\\text{L}}) \\right)\n$$\n$$\n\\frac{dm}{dt} = \\alpha_m(V)(1-m) - \\beta_m(V)m\n$$\n$$\n\\frac{dh}{dt} = \\alpha_h(V)(1-h) - \\beta_h(V)h\n$$\n$$\n\\frac{dn}{dt} = \\alpha_n(V)(1-n) - \\beta_n(V)n\n$$\nThe parameters $C_{\\text{m}}$, $\\bar{g}_{\\text{Na}}$, $\\bar{g}_{\\text{K}}$, $\\bar{g}_{\\text{L}}$, $E_{\\text{Na}}$, $E_{\\text{K}}$, and $E_{\\text{L}}$ are provided constants. The rate functions $\\alpha_x(V)$ and $\\beta_x(V)$ are also given. Note that the functions $\\alpha_m(V)$ and $\\alpha_n(V)$ contain expressions of the form $\\frac{0}{0}$ at specific voltages ($V = -40\\ \\text{mV}$ for $\\alpha_m$ and $V = -55\\ \\text{mV}$ for $\\alpha_n$). These are removable singularities, which must be handled numerically by applying L'Hôpital's rule. For $\\alpha_m(V)$ as $V \\to -40$, the limit is $1.0$. For $\\alpha_n(V)$ as $V \\to -55$, the limit is $0.1$.\n\nTo solve this system of ODEs numerically, the fourth-order Runge-Kutta (RK4) method is employed, as suggested. This method provides a good balance of accuracy and computational stability for this type of problem. For a time step $\\Delta t$, the state vector $Y_{i+1}$ at time $t_{i+1} = t_i + \\Delta t$ is computed from $Y_i$ at time $t_i$ as:\n$$\nk_1 = F(Y_i, I_{\\text{inj}})\n$$\n$$\nk_2 = F(Y_i + \\frac{\\Delta t}{2} k_1, I_{\\text{inj}})\n$$\n$$\nk_3 = F(Y_i + \\frac{\\Delta t}{2} k_2, I_{\\text{inj}})\n$$\n$$\nk_4 = F(Y_i + \\Delta t k_3, I_{\\text{inj}})\n$$\n$$\nY_{i+1} = Y_i + \\frac{\\Delta t}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n$$\nThe simulation is run for a total duration of $T = 200\\ \\text{ms}$ with a time step of $\\Delta t = 0.01\\ \\text{ms}$. After each integration step, the gating variables $m$, $h$, and $n$ must be clamped to the physically meaningful interval $[0, 1]$ to prevent numerical artifacts. A spike is registered if $V(t)$ crosses $0\\ \\text{mV}$ from a negative value.\n\nThe primary objective is to find the rheobase current, which is the minimum constant injected current $I_{\\text{inj}}$ that elicits at least one spike. This is a root-finding problem, which is solved using a specified search algorithm. The algorithm comprises two phases:\n\n1.  **Bracketing**: An interval $[I_{\\text{low}}, I_{\\text{high}}]$ that is guaranteed to contain the rheobase is established. We begin with $I_{\\text{low}} = 0\\ \\mu\\text{A}/\\text{cm}^2$ and an initial $I_{\\text{high}}$ (e.g., $1\\ \\mu\\text{A}/\\text{cm}^2$). If the simulation with $I_{\\text{high}}$ does not produce a spike, $I_{\\text{low}}$ is set to the current $I_{\\text{high}}$ and $I_{\\text{high}}$ is doubled. this process is repeated until a spike is observed at $I_{\\text{high}}$, or $I_{\\text{high}}$ exceeds the ceiling of $2000\\ \\mu\\text{A}/\\text{cm}^2$. If no spike is produced at this ceiling, the rheobase is taken to be $2000.0\\ \\mu\\text{A}/\\text{cm}^2$.\n\n2.  **Binary Search**: Once a valid bracket $[I_{\\text{low}}, I_{\\text{high}}]$ is found (where $I_{\\text{low}}$ produces no spike and $I_{\\text{high}}$ does), a binary search is performed. The midpoint $I_{\\text{mid}} = (I_{\\text{low}} + I_{\\text{high}})/2$ is tested. If $I_{\\text{mid}}$ causes a spike, it becomes the new upper bound: $I_{\\text{high}} = I_{\\text{mid}}$. Otherwise, it becomes the new lower bound: $I_{\\text{low}} = I_{\\text{mid}}$. This process is iterated until the width of the interval $(I_{\\text{high}} - I_{\\text{low}})$ is less than the specified tolerance $\\varepsilon = 10^{-3}\\ \\mu\\text{A}/\\text{cm}^2$. The final value of $I_{\\text{high}}$ is taken as the rheobase.\n\nThis entire procedure is applied to each of the four test cases defined in the problem statement. The results are then rounded to $3$ decimal places and formatted as required. The provided code implements this logic precisely.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the rheobase current for four parameter sets of the Hodgkin-Huxley model.\n    \"\"\"\n\n    # --- Hodgkin-Huxley Model Rate Functions ---\n    def alpha_m(V):\n        \"\"\"Sodium channel activation rate.\"\"\"\n        if np.abs(V + 40.0)  1e-5:\n            # L'Hopital's rule for singularity at V = -40 mV\n            return 1.0\n        return (0.1 * (V + 40.0)) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\n    def beta_m(V):\n        \"\"\"Sodium channel deactivation rate.\"\"\"\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    def alpha_h(V):\n        \"\"\"Sodium channel inactivation rate.\"\"\"\n        return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\n    def beta_h(V):\n        \"\"\"Sodium channel deinactivation rate.\"\"\"\n        return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\n    def alpha_n(V):\n        \"\"\"Potassium channel activation rate.\"\"\"\n        if np.abs(V + 55.0)  1e-5:\n            # L'Hopital's rule for singularity at V = -55 mV\n            return 0.1\n        return (0.01 * (V + 55.0)) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\n    def beta_n(V):\n        \"\"\"Potassium channel deactivation rate.\"\"\"\n        return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\n    # --- System of ODEs ---\n    def hh_derivatives(y, I_inj, g_Na, g_K, g_L):\n        \"\"\"\n        Computes the derivatives for the HH model state vector [V, m, h, n].\n        \"\"\"\n        V, m, h, n = y\n        \n        # Fixed parameters\n        C_m = 1.0  # uF/cm^2\n        E_Na = 50.0  # mV\n        E_K = -77.0  # mV\n        E_L = -54.4  # mV\n        \n        # Ionic currents (uA/cm^2)\n        I_Na = g_Na * (m**3) * h * (V - E_Na)\n        I_K = g_K * (n**4) * (V - E_K)\n        I_L = g_L * (V - E_L)\n        \n        # Time derivatives\n        dVdt = (I_inj - I_Na - I_K - I_L) / C_m\n        dmdt = alpha_m(V) * (1.0 - m) - beta_m(V) * m\n        dhdt = alpha_h(V) * (1.0 - h) - beta_h(V) * h\n        dndt = alpha_n(V) * (1.0 - n) - beta_n(V) * n\n        \n        return np.array([dVdt, dmdt, dhdt, dndt])\n\n    # --- Simulation and Spike Detection ---\n    def simulate_and_check_spike(I_inj, g_Na, g_K, g_L):\n        \"\"\"\n        Simulates the HH model for a given current and parameters, and checks for a spike.\n        \"\"\"\n        # Simulation parameters\n        T = 200.0  # ms\n        dt = 0.01   # ms\n        num_steps = int(T / dt)\n        \n        # Initial conditions at V_rest = -65 mV\n        V0 = -65.0\n        m0 = alpha_m(V0) / (alpha_m(V0) + beta_m(V0))\n        h0 = alpha_h(V0) / (alpha_h(V0) + beta_h(V0))\n        n0 = alpha_n(V0) / (alpha_n(V0) + beta_n(V0))\n        \n        y = np.array([V0, m0, h0, n0])\n        v_prev = y[0]\n        \n        # RK4 integration loop\n        for _ in range(num_steps):\n            k1 = dt * hh_derivatives(y, I_inj, g_Na, g_K, g_L)\n            k2 = dt * hh_derivatives(y + 0.5 * k1, I_inj, g_Na, g_K, g_L)\n            k3 = dt * hh_derivatives(y + 0.5 * k2, I_inj, g_Na, g_K, g_L)\n            k4 = dt * hh_derivatives(y + k3, I_inj, g_Na, g_K, g_L)\n            \n            y = y + (k1 + 2.0*k2 + 2.0*k3 + k4) / 6.0\n            \n            # Clamp gating variables to [0, 1]\n            y[1:] = np.clip(y[1:], 0.0, 1.0)\n            \n            # Spike detection: upward crossing of 0 mV\n            if v_prev  0.0 and y[0] = 0.0:\n                return True\n            v_prev = y[0]\n            \n        return False\n\n    # --- Rheobase Search Algorithm ---\n    def find_rheobase(g_Na, g_K, g_L):\n        \"\"\"\n        Finds the rheobase current using bracketing and binary search.\n        \"\"\"\n        I_low = 0.0\n        I_high = 1.0  # Initial guess for upper bound\n        I_ceil = 2000.0\n        tolerance = 1e-3\n        \n        # Bracketing Phase: Find an interval [I_low, I_high] containing the rheobase\n        is_spiking_at_high = simulate_and_check_spike(I_high, g_Na, g_K, g_L)\n        \n        while not is_spiking_at_high:\n            I_low = I_high\n            I_high *= 2.0\n            if I_high  I_ceil:\n                if not simulate_and_check_spike(I_ceil, g_Na, g_K, g_L):\n                    return I_ceil # No spike even at ceiling\n                else:\n                    I_high = I_ceil # Bracket is [I_low, I_ceil]\n                    break\n            is_spiking_at_high = simulate_and_check_spike(I_high, g_Na, g_K, g_L)\n\n        # Binary Search Phase: Refine the rheobase value\n        while (I_high - I_low)  tolerance:\n            I_mid = (I_low + I_high) / 2.0\n            if I_mid == I_low or I_mid == I_high: # Precision limit reached\n                break\n            if simulate_and_check_spike(I_mid, g_Na, g_K, g_L):\n                I_high = I_mid\n            else:\n                I_low = I_mid\n                \n        return I_high\n\n    # --- Main Execution ---\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (120.0, 36.0, 0.3),                 # Case 1: Baseline\n        (1.2 * 120.0, 36.0, 0.3),           # Case 2: gNa increased by 20%\n        (120.0, 36.0, 0.6),                 # Case 3: Higher leak\n        (1.2 * 120.0, 36.0, 0.6),           # Case 4: Higher leak and gNa increased\n    ]\n\n    results = []\n    for case in test_cases:\n        g_Na, g_K, g_L = case\n        rheobase = find_rheobase(g_Na, g_K, g_L)\n        results.append(rheobase)\n\n    # Format output to 3 decimal places as specified\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}