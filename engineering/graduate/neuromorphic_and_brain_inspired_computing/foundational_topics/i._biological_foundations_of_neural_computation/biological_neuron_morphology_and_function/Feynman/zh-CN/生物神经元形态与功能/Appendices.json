{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于高盛-霍奇金-卡茨 (Goldman-Hodgkin-Katz, GHK) 方程，它是理解静息膜电位的基石。通过推导 GHK 方程并计算电位，您将对离子浓度和膜渗透性如何共同建立神经元的基线电学状态获得定量的理解。此处的灵敏度分析  进一步阐明了钾离子在其中的主导作用，这是神经生理学中的一个关键原则。",
            "id": "4038182",
            "problem": "一个处于生理温度下的神经元被建模为一层薄膜，该薄膜分隔了含有单价离子钾离子($\\mathrm{K}^{+}$)、钠离子($\\mathrm{Na}^{+}$)和氯离子($\\mathrm{Cl}^{-}$)的细胞内液和细胞外液。假设在整个膜上恒定场近似成立，并且在稳态下，净跨膜电流为零。设细胞内浓度为 $[\\mathrm{K}^{+}]_{i} = 140~\\mathrm{mM}$、$[\\mathrm{Na}^{+}]_{i} = 12~\\mathrm{mM}$ 和 $[\\mathrm{Cl}^{-}]_{i} = 5~\\mathrm{mM}$，细胞外浓度为 $[\\mathrm{K}^{+}]_{o} = 4~\\mathrm{mM}$、$[\\mathrm{Na}^{+}]_{o} = 145~\\mathrm{mM}$ 和 $[\\mathrm{Cl}^{-}]_{o} = 120~\\mathrm{mM}$。相对渗透性为 $P_{\\mathrm{K}} = 1.0$、$P_{\\mathrm{Na}} = 0.04$ 和 $P_{\\mathrm{Cl}} = 0.45$。温度为 $T = 310~\\mathrm{K}$。普适气体常数 $R$ 和法拉第常数 $F$ 以符号形式使用。\n\n从恒定场近似和净跨膜电流为零条件下的 Nernst-Planck 离子通量方程出发，推导对 $\\mathrm{K}^{+}$、$\\mathrm{Na}^{+}$ 和 $\\mathrm{Cl}^{-}$ 具有渗透性的膜的 Goldman-Hodgkin-Katz (GHK) 电压关系式，然后：\n\n1. 使用您推导的关系式计算静息膜电位 $V_{m}$。\n2. 通过计算在给定基线浓度下评估的偏导数 $\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}$，分析 $V_{m}$ 对细胞外钾离子浓度 $[\\mathrm{K}^{+}]_{o}$ 微小变化的灵敏度。\n\n将最终报告的灵敏度值以毫伏/毫摩尔 ($\\mathrm{mV}/\\mathrm{mM}$) 为单位表示，并四舍五入到四位有效数字。在所有对数计算中使用自然对数。仅报告灵敏度值作为您的最终答案。",
            "solution": "相关的基本依据是在恒定场近似和净跨膜电流为零的稳态条件下的 Nernst-Planck 方程。对于价态为 $z_{i}$、浓度为 $C_{i}(x)$、扩散系数为 $D_{i}$、穿过厚度为 $L$ 的膜的电势为 $\\phi(x)$ 的离子种类 $i$，其一维 Nernst-Planck 通量为\n$$\nJ_{i} \\;=\\; -D_{i}\\left(\\frac{d C_{i}}{d x} + \\frac{z_{i} F}{R T} C_{i} \\frac{d \\phi}{d x}\\right).\n$$\n在恒定场近似下，$\\frac{d \\phi}{d x}$ 在整个膜上是均匀的，稳态条件意味着总电流为零：\n$$\nI \\;=\\; \\sum_{i} z_{i} F J_{i} \\;=\\; 0.\n$$\n将 Nernst-Planck 方程在边界浓度 $C_{i}(0) = C_{i,o}$ (外部) 和 $C_{i}(L) = C_{i,i}$ (内部) 的条件下对整个膜进行积分，并定义渗透性 $P_{i}$ (其包含了 $D_{i}$ 和分配系数)，可得到针对单价离子 $\\mathrm{K}^{+}$ ($z_{\\mathrm{K}} = +1$)、$\\mathrm{Na}^{+}$ ($z_{\\mathrm{Na}} = +1$) 和 $\\mathrm{Cl}^{-}$ ($z_{\\mathrm{Cl}} = -1$) 的 Goldman-Hodgkin-Katz (GHK) 电压关系式：\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o}}\\right),\n$$\n其中，由于 $z_{\\mathrm{Cl}} = -1$，阴离子的贡献以细胞内浓度出现在分子中，以细胞外浓度出现在分母中。\n\n定义\n$$\nN \\;=\\; P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i},\n\\quad\nD \\;=\\; P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o},\n$$\n使得\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{N}{D}\\right).\n$$\n\n步骤 1：在基线浓度和渗透性下计算静息膜电位 $V_{m}$。其符号表达式为\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o}}\\right).\n$$\n数值上，使用所提供的值：\n- $N = (1.0)\\cdot 4 + (0.04)\\cdot 145 + (0.45)\\cdot 5 = 4 + 5.8 + 2.25 = 12.05$,\n- $D = (1.0)\\cdot 140 + (0.04)\\cdot 12 + (0.45)\\cdot 120 = 140 + 0.48 + 54 = 194.48$,\n并且 \n$$\nV_{m} = \\frac{R T}{F} \\ln\\!\\left(\\frac{12.05}{194.48}\\right).\n$$\n在 $T = 310~\\mathrm{K}$ 时，$\\frac{R T}{F}$ 约等于 $0.0267~\\mathrm{V}$，因此 $V_{m} \\approx 0.0267 \\cdot \\ln(0.06196) \\approx 0.0267 \\cdot (-2.78) \\approx -0.0743~\\mathrm{V}$，即约等于 $-74.3~\\mathrm{mV}$。\n\n步骤 2：$V_{m}$ 对细胞外钾离子的灵敏度。我们计算偏导数\n$$\n\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}} \\;=\\; \\frac{\\partial}{\\partial [\\mathrm{K}^{+}]_{o}} \\left(\\frac{R T}{F} \\ln\\!\\left(\\frac{N}{D}\\right)\\right)\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{1}{N} \\cdot \\frac{\\partial N}{\\partial [\\mathrm{K}^{+}]_{o}},\n$$\n因为 $D$ 不依赖于 $[\\mathrm{K}^{+}]_{o}$。\n由于 $N = P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}$，我们有 $\\frac{\\partial N}{\\partial [\\mathrm{K}^{+}]_{o}} = P_{\\mathrm{K}}$。因此，\n$$\n\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}} \\;=\\; \\frac{R T}{F} \\cdot \\frac{P_{\\mathrm{K}}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}.\n$$\n在基线值处进行评估，\n$$\n\\left.\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}\\right|_{\\text{baseline}}\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{P_{\\mathrm{K}}}{N}\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{1.0}{12.05}.\n$$\n使用 $T = 310~\\mathrm{K}$ 并且在计算前保持 $R$ 和 $F$ 为符号形式，其数值约等于\n$$\n\\left.\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}\\right|_{\\text{baseline}} \\;\\approx\\; \\frac{0.0267~\\mathrm{V}}{12.05~\\mathrm{mM}} \\;\\approx\\; 0.002217~\\mathrm{V}/\\mathrm{mM} \\;=\\; 2.217~\\mathrm{mV}/\\mathrm{mM}.\n$$\n四舍五入到四位有效数字，灵敏度为 $2.217~\\mathrm{mV}/\\mathrm{mM}$。",
            "answer": "$$\\boxed{2.217}$$"
        },
        {
            "introduction": "神经元并非简单的点，其错综复杂的树突树对信息处理至关重要。本练习使用被动电缆理论，探讨形态如何影响电信号。通过推导输入阻抗与树突直径的关系，并探索作为阻抗匹配原则的 Rall 的 3/2 次幂定律 ，您将理解控制电流在树突分支间高效流动和信号整合的设计原则。",
            "id": "4038119",
            "problem": "考虑一个具有均匀圆柱状树突的神经元，该树突在一个节点处分叉成两个子代树突。假设膜处于准静态、被动条件下，并将每个子代树突视为半无限长电缆。一个位于分支节点处的突触注入稳恒电流，并“看到”一个由下游树突负载的轴向和膜特性决定的输入阻抗。设单位膜电阻为 $R_{m}$ (单位为 $\\Omega\\,\\text{m}^{2}$)，轴向电阻率为 $R_{a}$ (单位为 $\\Omega\\,\\text{m}$)。母代树突的直径为 $d_{0}$，两个子代树突的直径分别为 $d_{1}$ 和 $d_{2}$。仅基于以下基本原理进行推导：圆柱体的单位长度轴向电阻的定义，圆柱体的单位长度膜电导的定义，作为电阻性传输线特征阻抗的半无限长被动电缆的输入阻抗，集总电路等效中的串并联组合，以及被称为 Rall 的 3/2次幂定律的形态阻抗匹配条件。\n\n任务：\n1. 从圆柱形电缆单位长度的轴向电阻和单位长度的膜电导的定义出发，推导半无限长树突的稳态输入阻抗如何随其直径变化。然后，利用分支点的串并联等效，推导突触“看到”的进入两个下游半无限长子代树突的输入阻抗的表达式（用 $d_{1}$ 和 $d_{2}$ 表示）。解释 Rall 的 3/2 次幂定律是如何从“分支不改变节点处所见的输入阻抗”这一要求中产生的。\n2. 使用一个数值例子进行验证，取 $R_{m} = 2\\,\\Omega\\,\\text{m}^{2}$，$R_{a} = 1\\,\\Omega\\,\\text{m}$，$d_{0} = 2.4\\,\\mu\\text{m}$，$d_{1} = 1.2\\,\\mu\\text{m}$，以及一个具有 $d_{2} = 1.4\\,\\mu\\text{m}$ 的“失配”分支。计算进入母代树突 ($d_{0}$) 和失配子代树突 ($d_{1}$ 和 $d_{2}$) 的输入阻抗，并以兆欧为单位表示这些阻抗。同时，计算在给定 $d_{0}$ 和 $d_{1}$ 的情况下满足 Rall 3/2 次幂定律的直径 $d_{2}^{\\ast}$，并证明匹配的输入阻抗等于母代树突的输入阻抗。\n3. 最后，报告单一的无量纲比值\n$$\\rho \\equiv \\frac{\\text{mismatched branch input impedance}}{\\text{matched branch (Rall) input impedance}}$$\n对于给定的数值。将最终报告的比值 $\\rho$ 四舍五入到四位有效数字。该比值是无量纲的，因此 $\\rho$ 不需要单位；但在验证数值示例时，请将任何中间阻抗以兆欧为单位表示。",
            "solution": "**任务1：阻抗尺度关系和 Rall 定律的推导**\n\n首先，我们推导直径为 $d$ 的均匀圆柱状树突的单位长度轴向电阻 $r_a$ 和单位长度膜电导 $g_m$ 的表达式。\n\n导体的轴向电阻由 $R = \\rho L / A$ 给出，其中 $\\rho$ 是电阻率（此处为 $R_a$），$L$ 是长度，$A$ 是横截面积。对于圆柱体，$A = \\pi (d/2)^2 = \\frac{\\pi d^2}{4}$。因此，单位长度的轴向电阻 $r_a$ 为：\n$$r_a = \\frac{R_a}{A} = \\frac{R_a}{\\frac{\\pi d^2}{4}} = \\frac{4 R_a}{\\pi d^2}$$\n因此，$r_a$ 与 $d^{-2}$ 成正比。\n\n单位膜电阻 $R_m$ 的单位是电阻乘以面积 ($\\Omega \\cdot \\text{m}^2$)。长度为 $L$ 的一段膜的电阻为 $R_{\\text{mem}} = \\frac{R_m}{\\text{surface area}} = \\frac{R_m}{\\pi d L}$。单位长度的膜电阻 $r_m$ 是一个量，当它除以长度 $\\Delta x$ 时，得到该段的电阻。它由 $r_m = \\frac{R_m}{\\pi d}$ 给出。单位长度的膜电导 $g_m$ 是 $r_m$ 的倒数：\n$$g_m = \\frac{1}{r_m} = \\frac{\\pi d}{R_m}$$\n因此，$g_m$ 与 $d^1$ 成正比。\n\n问题指定在稳态（DC）条件下将树突建模为半无限长被动电缆。这种电缆的输入阻抗 $Z_{in}$ 等于其特征阻抗 $Z_c$。对于被视为电阻性传输线的被动电缆，这由以下公式给出：\n$$Z_{in} = Z_c = \\sqrt{\\frac{r_a}{g_m}}$$\n代入我们关于 $r_a$ 和 $g_m$ 的表达式：\n$$Z_{in} = \\sqrt{\\frac{\\frac{4 R_a}{\\pi d^2}}{\\frac{\\pi d}{R_m}}} = \\sqrt{\\frac{4 R_a R_m}{\\pi^2 d^3}} = \\frac{2 \\sqrt{R_a R_m}}{\\pi} d^{-3/2}$$\n该推导表明，半无限长树突的稳态输入阻抗随其直径的变化关系为 $Z_{in} \\propto d^{-3/2}$。\n\n接下来，我们考虑母代树突分裂成两个直径分别为 $d_1$ 和 $d_2$ 的子代树突的分支节点。从节点处突触的角度看，两个子代树突是并联的。分支的总输入阻抗 $Z_{branch}$ 可通过将子代树突的输入电导相加得到。输入电导 $G_{in}$ 是输入阻抗的倒数：$G_{in} = 1/Z_{in}$。\n根据我们的尺度关系，$G_{in} \\propto d^{3/2}$。设比例常数为 $K = \\frac{\\pi}{2 \\sqrt{R_a R_m}}$，则 $G_{in}(d) = K d^{3/2}$。\n\n分支的总电导是两个子代树突电导之和：\n$$G_{branch} = G_1 + G_2 = K d_1^{3/2} + K d_2^{3/2} = K (d_1^{3/2} + d_2^{3/2})$$\n分支的输入阻抗是该总电导的倒数：\n$$Z_{branch} = \\frac{1}{G_{branch}} = \\frac{1}{K (d_1^{3/2} + d_2^{3/2})} = \\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})}$$\n\nRall 的 3/2 次幂定律源于阻抗匹配条件，该条件要求“看到”的进入母代树突的输入阻抗等于“看到”的进入组合的子代分支的输入阻抗。即 $Z_0 = Z_{branch}$。这等效于匹配输入电导：$G_0 = G_{branch}$。\n$$G_0 = K d_0^{3/2}$$\n$$G_{branch} = K d_1^{3/2} + K d_2^{3/2}$$\n令它们相等得到：\n$$K d_0^{3/2} = K (d_1^{3/2} + d_2^{3/2})$$\n消去常数 $K$ 得到形态学条件：\n$$d_0^{3/2} = d_1^{3/2} + d_2^{3/2}$$\n这就是分叉树突的 Rall 3/2 次幂定律。\n\n**任务2：数值验证**\n\n我们给定以下数值：\n$R_m = 2\\,\\Omega\\,\\text{m}^{2}$\n$R_a = 1\\,\\Omega\\,\\text{m}$\n$d_0 = 2.4\\,\\mu\\text{m} = 2.4 \\times 10^{-6}\\,\\text{m}$\n$d_1 = 1.2\\,\\mu\\text{m} = 1.2 \\times 10^{-6}\\,\\text{m}$\n$d_2 = 1.4\\,\\mu\\text{m} = 1.4 \\times 10^{-6}\\,\\text{m}$\n\n输入阻抗公式为 $Z_{in}(d) = \\frac{2 \\sqrt{R_a R_m}}{\\pi} d^{-3/2}$。\n首先，我们计算母代树突的阻抗 $Z_0$：\n$$Z_0 = Z_{in}(d_0) = \\frac{2 \\sqrt{(1)(2)}}{\\pi} (2.4 \\times 10^{-6})^{-3/2} = \\frac{2\\sqrt{2}}{\\pi (2.4)^{3/2} \\times 10^{-9}}\\,\\Omega$$\n$$Z_0 = \\frac{2.828427...}{(3.14159...)(3.717795...)} \\times 10^9\\,\\Omega = 0.24203 \\times 10^9\\,\\Omega \\approx 242.0\\,\\text{M}\\Omega$$\n\n接下来，我们计算具有子代 $d_1$ 和 $d_2$ 的失配分支的输入阻抗。\n$$Z_{mismatched} = \\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})} = \\frac{2\\sqrt{2}}{\\pi ((1.2 \\times 10^{-6})^{3/2} + (1.4 \\times 10^{-6})^{3/2})}$$\n$$Z_{mismatched} = \\frac{2\\sqrt{2}}{\\pi \\times 10^{-9} ((1.2)^{3/2} + (1.4)^{3/2})} = \\frac{2.828427...}{\\pi (1.314534... + 1.656502...)} \\times 10^9\\,\\Omega$$\n$$Z_{mismatched} = \\frac{2.828427...}{\\pi (2.971036...)} \\times 10^9\\,\\Omega = 0.30289 \\times 10^9\\,\\Omega \\approx 302.9\\,\\text{M}\\Omega$$\n\n现在，我们求出在给定 $d_0$ 和 $d_1$ 的情况下满足 Rall 定律的直径 $d_2^*$：\n$$(d_2^*)^{3/2} = d_0^{3/2} - d_1^{3/2}$$\n$$d_2^* = (d_0^{3/2} - d_1^{3/2})^{2/3} = ((2.4 \\times 10^{-6})^{3/2} - (1.2 \\times 10^{-6})^{3/2})^{2/3}$$\n$$d_2^* = (10^{-9})^{2/3} (2.4^{3/2} - 1.2^{3/2})^{2/3} = 10^{-6} (3.717795... - 1.314534...)^{2/3}$$\n$$d_2^* = 10^{-6} (2.403261...)^{2/3} = 1.7958 \\times 10^{-6}\\,\\text{m}$$\n\n匹配输入阻抗 $Z_{matched}$ 是具有子代 $d_1$ 和 $d_2^*$ 的分支的阻抗。由于这些直径满足 $d_0^{3/2} = d_1^{3/2} + (d_2^*)^{3/2}$，根据定义，阻抗匹配条件已满足。因此，匹配阻抗必须等于母代阻抗：\n$$Z_{matched} = Z_0 \\approx 242.0\\,\\text{M}\\Omega$$\n这验证了当分支几何结构满足 Rall 定律时，输入阻抗在分支点处是守恒的。\n\n**任务3：无量纲比值 $\\rho$**\n\n最后的任务是计算失配分支阻抗与匹配分支阻抗的比值 $\\rho$。\n$$\\rho = \\frac{Z_{mismatched}}{Z_{matched}} = \\frac{Z_{mismatched}}{Z_0}$$\n使用任务2中计算的阻抗：\n$$\\rho = \\frac{302.89\\,\\text{M}\\Omega}{242.03\\,\\text{M}\\Omega} \\approx 1.2514$$\n从解析上讲，该比值为：\n$$\\rho = \\frac{\\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})}}{\\frac{2 \\sqrt{R_a R_m}}{\\pi d_0^{3/2}}} = \\frac{d_0^{3/2}}{d_1^{3/2} + d_2^{3/2}}$$\n代入直径值：\n$$\\rho = \\frac{(2.4)^{3/2}}{(1.2)^{3/2} + (1.4)^{3/2}} = \\frac{3.717795...}{1.314534... + 1.656502...} = \\frac{3.717795...}{2.971036...} = 1.2513437...$$\n将最终值四舍五入到四位有效数字得到 $1.251$。",
            "answer": "$$\\boxed{1.251}$$"
        },
        {
            "introduction": "最后的这项练习将我们从被动特性带入主动和突触电导的动态世界。您将构建并模拟一个双房室模型，以研究神经元如何整合突触输入并产生输出，这是神经系统的核心功能。该练习  特别突出了抑制胞体与抑制树突之间的计算差异，揭示了突触位置如何深刻地改变神经元的计算行为。",
            "id": "4038164",
            "problem": "您将对一个神经元进行建模，该模型为一个双室系统（一个胞体室和一个树突室），具有欧姆耦合、被动漏电和突触电导，以及一个捕捉树突去极化电压激活放大的非线性树突电导。使用电流平衡和电缆方程近似的第一性原理，推导出在稳态兴奋性驱动和施加于胞体或树突的时不变抑制下，控制胞体和树突膜电位的常微分方程。实现一个模拟程序，该程序随时间积分这些方程，并量化在六个指定的参数集（作为测试套件）下非线性树突平台事件的发生和胞体发放速率。您的程序必须将所有测试用例的结果输出到单行中，形式为方括号括起来的逗号分隔列表，每个测试用例按顺序贡献两个数字：首先是表示是否发生树突平台的指示符（用$0$或$1$表示）；其次是胞体发放速率，以赫兹（Hz）为单位，表示为四舍五入到三位小数的浮点数。因此，最终输出应为一个长度为$12$的扁平列表。\n\n从以下基本原理出发：\n- 膜电流平衡：对于每个具有膜电容$C$、膜电位$V$和一组外向跨膜电流$I_k$的室，其动态遵循$C \\, dV/dt = - \\sum_k I_k$。\n- 欧姆（基于电导的）电流：对于一个电导为$g$、反转电位为$E$的电流，其外向电流为$I = g \\, (V - E)$。\n- 室间电耦合：对于耦合电导$g_c$，从电位为$V_1$的室流向电位为$V_2$的室的外向电流为$I_c = g_c \\, (V_1 - V_2)$。\n- 一个非线性树突电导，其稳态激活$m_\\infty(V)$由玻尔兹曼函数$m_\\infty(V) = 1 / (1 + \\exp(-(V - V_{1/2})/k))$捕捉，有效电导为$g_{\\mathrm{NL}} \\, m_\\infty(V)^p$，其中$p$为协同指数。\n\n使用的模型规格：\n- 两个室：胞体电位为$V_s(t)$，树突电位为$V_d(t)$。\n- 胞体和树突分别具有电容$C_s$和$C_d$，以及漏电导$g^{(s)}_L$和$g^{(d)}_L$，均为常数。\n- 胞体和树突通过电导$g_c$耦合。\n- 胞体接收一个抑制性电导$g^{(s)}_{\\mathrm{inh}}$，其反转电位为$E_{\\mathrm{inh}}$。树突接收一个抑制性电导$g^{(d)}_{\\mathrm{inh}}$，具有相同的反转电位。在给定的测试用例中，只有一个可以为非零，以代表靶向胞体或靶向树突的抑制。\n- 树突接收一个恒定的兴奋性电导$g^{(d)}_{\\mathrm{exc}}$，其反转电位为$E_{\\mathrm{exc}}$。\n- 树突包含一个非线性电压激活电导，其最大值为$g_{\\mathrm{NL}}$，反转电位为$E_{\\mathrm{NL}}$，激活函数为$m_\\infty(V_d)$（具有半激活电位$V_{1/2}$和斜率因子$k$），以及指数$p$。\n- 胞体根据漏积分放电（LIF）机制发放动作电位：当$V_s$超过阈值$V_{\\mathrm{th}}$时，记下一个峰电位，$V_s$被重置为$V_{\\mathrm{reset}}$，并在不进行积分的情况下保持该值一个不应期$\\tau_{\\mathrm{ref}}$。\n\n您的任务：\n- 根据上述原理，推导出$V_s(t)$和$V_d(t)$的耦合微分方程，明确指出每个电导如何作为右侧的外向电流项做出贡献。\n- 使用固定时间步长的显式方法实现一个时域模拟，该方法在总时长$T$内以时间步长$\\Delta t$对系统进行积分。通过选择相对于系统时间常数足够小的$\\Delta t$来确保数值稳定性。\n- 定义一个树突平台检测器，如果在任何时候，树突电位$V_d(t)$持续高于平台阈值$V_{\\mathrm{plateau}}$至少达到最小持续时间$t_{\\mathrm{min}}$，则返回$1$，否则返回$0$。\n- 计算胞体发放速率，即总峰电位数除以模拟时长（秒），以赫兹表示，并四舍五入到三位小数。\n\n参数值和物理单位：\n- 使用 $C_s = 200 \\times 10^{-12}$ 法拉, $C_d = 200 \\times 10^{-12}$ 法拉。\n- 使用 $g^{(s)}_L = 10 \\times 10^{-9}$ 西门子, $g^{(d)}_L = 8 \\times 10^{-9}$ 西门子。\n- 使用 $g_c = 5 \\times 10^{-9}$ 西门子。\n- 使用 $E_L = -0.065$ 伏特, $E_{\\mathrm{inh}} = -0.070$ 伏特, $E_{\\mathrm{exc}} = 0.0$ 伏特, $E_{\\mathrm{NL}} = 0.0$ 伏特。\n- 使用 $V_{1/2} = -0.035$ 伏特, $k = 0.002$ 伏特, $p = 2$。\n- 使用LIF参数 $V_{\\mathrm{th}} = -0.050$ 伏特, $V_{\\mathrm{reset}} = -0.065$ 伏特, $\\tau_{\\mathrm{ref}} = 0.002$ 秒。\n- 使用模拟时长 $T = 1.0$ 秒, 时间步长 $\\Delta t = 0.000025$ 秒。\n- 平台检测使用 $V_{\\mathrm{plateau}} = -0.040$ 伏特 和 $t_{\\mathrm{min}} = 0.020$ 秒。\n- 初始条件：$V_s(0) = E_L$，$V_d(0) = E_L$。\n\n测试套件 (每个用例是一个四元组 ($g^{(d)}_{\\mathrm{exc}}, g^{(s)}_{\\mathrm{inh}}, g^{(d)}_{\\mathrm{inh}}, g_{\\mathrm{NL}}$)，单位为西门子):\n- 用例 $1$ (理想路径，无抑制，强非线性): ($25 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}$)。\n- 用例 $2$ (靶向胞体抑制): ($25 \\times 10^{-9}, 10 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}$)。\n- 用例 $3$ (靶向树突抑制): ($25 \\times 10^{-9}, 0 \\times 10^{-9}, 10 \\times 10^{-9}, 20 \\times 10^{-9}$)。\n- 用例 $4$ (强树突抑制，平台抑制的边界): ($25 \\times 10^{-9}, 0 \\times 10^{-9}, 25 \\times 10^{-9}, 20 \\times 10^{-9}$)。\n- 用例 $5$ (接近非线性阈值的低兴奋性驱动): ($12 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}$)。\n- 用例 $6$ (无树突非线性的对照组): ($25 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}$)。\n\n数值输出：\n- 对于每个测试用例，按顺序返回两个数字：平台指示符（$0$或$1$），以及以Hz为单位的胞体发放速率（四舍五入到三位小数）。\n- 您的程序应生成一行输出，包含一个方括号括起来的逗号分隔列表（例如，$\\left[\\right.$$r_1,r_2,\\dots$$\\left.\\right]$），该列表是扁平的，并遵循以下顺序：用例$1$指示符，用例$1$速率，用例$2$指示符，用例$2$速率，依此类推，直到用例$6$。\n\n角度单位不适用。所有物理量必须以上述指定单位处理。不要提示输入；程序必须是自包含的，并直接为给定的测试套件生成指定的输出。",
            "solution": "该问题要求推导和模拟一个双室神经元模型。解决方案分两部分呈现：首先，从第一性原理推导控制微分方程；其次，描述数值模拟方法。\n\n### 控制方程的推导\n\n该模型由两个电耦合的室组成：一个胞体和一个树突。每个室中膜电位的动态由电流平衡原理控制，该原理指出膜电位变化率与流过膜的总电流成正比。控制方程为$C \\frac{dV}{dt} = - \\sum_k I_k$，其中$C$是电容，$V$是膜电位，$I_k$是各种外向电流。一个外向欧姆电流定义为$I = g(V - E)$，其中$g$是电导，$E$是反转电位。\n\n**1. 胞体室电位, $V_s(t)$**\n\n胞体具有电容$C_s$，其电位为$V_s$。流出胞体的电流包括：\n-   **漏电流 ($I_L^{(s)}$)**：一种被动电流，将电位驱动至漏电反转电位$E_L$。电导为$g^{(s)}_L$。\n    $$I_L^{(s)} = g^{(s)}_L (V_s - E_L)$$\n-   **抑制性突触电流 ($I_{\\mathrm{inh}}^{(s)}$)**：一种时不变的抑制性电流，电导为$g^{(s)}_{\\mathrm{inh}}$，反转电位为$E_{\\mathrm{inh}}$。\n    $$I_{\\mathrm{inh}}^{(s)} = g^{(s)}_{\\mathrm{inh}} (V_s - E_{\\mathrm{inh}})$$\n-   **耦合电流 ($I_c^{(s \\to d)}$)**：通过耦合电导$g_c$从胞体流向树突的电流。\n    $$I_c^{(s \\to d)} = g_c (V_s - V_d)$$\n\n将这些外向电流相加，总电流为$\\sum I_k = I_L^{(s)} + I_{\\mathrm{inh}}^{(s)} + I_c^{(s \\to d)}$。对胞体应用电流平衡方程得到：\n$$C_s \\frac{dV_s}{dt} = - \\left[ g^{(s)}_L (V_s - E_L) + g^{(s)}_{\\mathrm{inh}} (V_s - E_{\\mathrm{inh}}) + g_c (V_s - V_d) \\right]$$\n\n**2. 树突室电位, $V_d(t)$**\n\n树突具有电容$C_d$，其电位为$V_d$。流出树突的电流包括：\n-   **漏电流 ($I_L^{(d)}$)**：一种被动电流，电导为$g^{(d)}_L$。\n    $$I_L^{(d)} = g^{(d)}_L (V_d - E_L)$$\n-   **抑制性突触电流 ($I_{\\mathrm{inh}}^{(d)}$)**：一种时不变的抑制性电流，电导为$g^{(d)}_{\\mathrm{inh}}$。\n    $$I_{\\mathrm{inh}}^{(d)} = g^{(d)}_{\\mathrm{inh}} (V_d - E_{\\mathrm{inh}})$$\n-   **兴奋性突触电流 ($I_{\\mathrm{exc}}^{(d)}$)**：一种时不变的兴奋性电流，电导为$g^{(d)}_{\\mathrm{exc}}$，反转电位为$E_{\\mathrm{exc}}$。\n    $$I_{\\mathrm{exc}}^{(d)} = g^{(d)}_{\\mathrm{exc}} (V_d - E_{\\mathrm{exc}})$$\n-   **非线性电压门控电流 ($I_{\\mathrm{NL}}$)**：一种放大树突去极化的内向整流电流。有效电导通过激活函数$m_\\infty(V_d)$依赖于树突电压$V_d$。最大电导为$g_{\\mathrm{NL}}$，反转电位为$E_{\\mathrm{NL}}$，协同性为$p$。\n    $$I_{\\mathrm{NL}} = g_{\\mathrm{NL}} \\left(m_\\infty(V_d)\\right)^p (V_d - E_{\\mathrm{NL}})$$\n    稳态激活函数$m_\\infty(V_d)$是一个S型的玻尔兹曼函数：\n    $$m_\\infty(V_d) = \\frac{1}{1 + \\exp\\left(-\\frac{V_d - V_{1/2}}{k}\\right)}$$\n-   **耦合电流 ($I_c^{(d \\to s)}$)**：从树突流向胞体的电流。按照惯例，这是从树突流出的外向电流。\n    $$I_c^{(d \\to s)} = g_c (V_d - V_s)$$\n\n将这些树突的外向电流相加，$\\sum I_k = I_L^{(d)} + I_{\\mathrm{inh}}^{(d)} + I_{\\mathrm{exc}}^{(d)} + I_{\\mathrm{NL}} + I_c^{(d \\to s)}$。电流平衡方程为：\n$$C_d \\frac{dV_d}{dt} = - \\left[ g^{(d)}_L (V_d - E_L) + g^{(d)}_{\\mathrm{inh}} (V_d - E_{\\mathrm{inh}}) + g^{(d)}_{\\mathrm{exc}} (V_d - E_{\\mathrm{exc}}) + g_{\\mathrm{NL}} \\left(m_\\infty(V_d)\\right)^p (V_d - E_{\\mathrm{NL}}) + g_c (V_d - V_s) \\right]$$\n\n这两个耦合的常微分方程（ODEs），连同胞体的漏积分放电（LIF）机制，完全描述了系统的动力学。\n\n### 数值模拟与分析\n\n该常微分方程系统使用前向欧拉法以固定时间步长$\\Delta t$进行数值积分。对于形式为$\\frac{dy}{dt} = f(y,t)$的常微分方程，更新规则为$y(t+\\Delta t) = y(t) + \\Delta t \\cdot f(y(t),t)$。\n\n模拟过程如下：\n1.  **初始化**：状态变量$V_s$和$V_d$被初始化为漏电反转电位$E_L = -0.065$ V。时间$t$初始化为$0$，峰电位计数为$0$，不应期计数器为$0$。\n2.  **时间步进循环**：模拟从$t=0$到$t=T$以$\\Delta t$为步长运行。在每一步中：\n    a. 检查胞体LIF机制的状态。如果神经元处于其不应期（持续时间$\\tau_{\\mathrm{ref}}$），胞体电位$V_s$被钳制在重置电位$V_{\\mathrm{reset}}$。胞体的积分被绕过。然而，树突室继续演化，其动力学受到钳制的胞体电位的影响。\n    b. 如果神经元不处于不应期，则使用时间步开始时的$V_s$和$V_d$值计算导数$\\frac{dV_s}{dt}$和$\\frac{dV_d}{dt}$。然后使用欧拉规则更新两个电位。\n    c. 更新后，检查胞体电位$V_s$是否达到发放阈值$V_{\\mathrm{th}}$。如果$V_s \\ge V_{\\mathrm{th}}$，则记录一个峰电位，$V_s$立即设置为$V_{\\mathrm{reset}}$，并启动不应期计数器。\n3.  **树突平台检测**：在模拟过程中，存储$V_d(t)$的历史记录。模拟完成后，分析此历史记录。如果$V_d(t)$持续高于阈值$V_{\\mathrm{plateau}}$的时间等于或大于$t_{\\mathrm{min}}$，则记录一个平台事件（指示符= $1$）。否则，指示符为$0$。\n4.  **发放速率计算**：胞体发放速率计算为总峰电位数除以总模拟时长$T$，以Hz表示并四舍五入到三位小数。\n\n此过程应用于问题中指定的六个测试用例中的每一个，为每个用例生成一对结果（平台指示符，发放速率）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-compartment neuron model problem by simulating the dynamics\n    for six test cases and printing the results in the specified format.\n    \"\"\"\n\n    # --- Model and Simulation Parameters ---\n    # Capacitances (F)\n    C_s = 200e-12\n    C_d = 200e-12\n    # Leak Conductances (S)\n    g_leak_s = 10e-9\n    g_leak_d = 8e-9\n    # Coupling Conductance (S)\n    g_c = 5e-9\n    # Reversal Potentials (V)\n    E_leak = -0.065\n    E_inh = -0.070\n    E_exc = 0.0\n    E_nl = 0.0\n    # Nonlinear Conductance Parameters\n    V_half = -0.035  # V\n    k = 0.002        # V\n    p = 2\n    # LIF Parameters (V  s)\n    V_th = -0.050\n    V_reset = -0.065\n    tau_ref = 0.002\n    # Simulation Time Parameters (s)\n    T = 1.0\n    dt = 0.000025\n    # Plateau Detection Parameters (V  s)\n    V_plateau = -0.040\n    t_min_plateau = 0.020\n    \n    # Pre-calculated simulation constants\n    num_steps = int(T / dt)\n    ref_steps_total = int(tau_ref / dt)\n    min_plateau_steps = int(t_min_plateau / dt)\n    \n    # Test Suite (g_exc_d, g_inh_s, g_inh_d, g_nl) in Siemens\n    test_cases = [\n        (25e-9, 0e-9, 0e-9, 20e-9),    # Case 1\n        (25e-9, 10e-9, 0e-9, 20e-9),   # Case 2\n        (25e-9, 0e-9, 10e-9, 20e-9),   # Case 3\n        (25e-9, 0e-9, 25e-9, 20e-9),   # Case 4\n        (12e-9, 0e-9, 0e-9, 20e-9),   # Case 5\n        (25e-9, 0e-9, 0e-9, 0e-9),     # Case 6\n    ]\n\n    def run_simulation(g_exc_d, g_inh_s, g_inh_d, g_nl):\n        \"\"\"\n        Runs a single simulation for a given set of conductances.\n        \"\"\"\n        # State variables\n        Vs = E_leak\n        Vd = E_leak\n        ref_counter = 0\n        spike_count = 0\n        Vd_history = np.zeros(num_steps)\n\n        # Nonlinear activation function\n        def m_inf(v):\n            return 1.0 / (1.0 + np.exp(-(v - V_half) / k))\n\n        # Main simulation loop\n        for i in range(num_steps):\n            Vd_history[i] = Vd\n            \n            # If refractory, soma is clamped at V_reset\n            if ref_counter > 0:\n                Vd_calc_Vs = V_reset\n                ref_counter -= 1\n            else:\n                Vd_calc_Vs = Vs\n\n            # Dendritic integration is always active\n            g_nl_eff = g_nl * (m_inf(Vd)**p)\n            dVd_dt = (\n                g_leak_d * (E_leak - Vd) +\n                g_inh_d * (E_inh - Vd) +\n                g_exc_d * (E_exc - Vd) +\n                g_nl_eff * (E_nl - Vd) +\n                g_c * (Vd_calc_Vs - Vd)\n            ) / C_d\n            Vd += dVd_dt * dt\n\n            # Somatic integration only if not refractory\n            if Vd_calc_Vs == Vs:  # i.e., not refractory\n                dVs_dt = (\n                    g_leak_s * (E_leak - Vs) +\n                    g_inh_s * (E_inh - Vs) +\n                    g_c * (Vd_history[i] - Vs) # Vd at start of time step\n                ) / C_s\n                Vs += dVs_dt * dt\n            else:\n                Vs = V_reset\n            \n            # Check for spike and reset\n            if Vs >= V_th:\n                spike_count += 1\n                Vs = V_reset\n                ref_counter = ref_steps_total\n\n        # --- Post-simulation Analysis ---\n\n        # 1. Plateau Detection\n        plateau_indicator = 0\n        consecutive_high = 0\n        for v_d_val in Vd_history:\n            if v_d_val >= V_plateau:\n                consecutive_high += 1\n            else:\n                consecutive_high = 0\n            \n            if consecutive_high >= min_plateau_steps:\n                plateau_indicator = 1\n                break\n        \n        # 2. Firing Rate Calculation\n        firing_rate = round(spike_count / T, 3)\n\n        return plateau_indicator, firing_rate\n\n    # Run all test cases and collect results\n    all_results = []\n    for case in test_cases:\n        indicator, rate = run_simulation(*case)\n        all_results.append(indicator)\n        all_results.append(rate)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}