{
    "hands_on_practices": [
        {
            "introduction": "The ability of a neuron to signal rests on its membrane potential, a voltage difference established by the careful balancing of ion concentrations and permeabilities. This first practice delves into the biophysical heart of this phenomenon by using the Goldman–Hodgkin–Katz (GHK) equation. By deriving this crucial relationship from the Nernst–Planck equation and applying it to a realistic scenario , you will gain a quantitative understanding of how the resting potential emerges and how sensitive it is to changes in the extracellular environment, particularly to potassium ions.",
            "id": "4038182",
            "problem": "A neuron at physiological temperature is modeled as a thin membrane separating intracellular and extracellular solutions with monovalent ions potassium ($\\mathrm{K}^{+}$), sodium ($\\mathrm{Na}^{+}$), and chloride ($\\mathrm{Cl}^{-}$). Assume the constant-field approximation holds across the membrane and that, at steady state, the net transmembrane current is zero. Let the intracellular concentrations be $[\\mathrm{K}^{+}]_{i} = 140~\\mathrm{mM}$, $[\\mathrm{Na}^{+}]_{i} = 12~\\mathrm{mM}$, and $[\\mathrm{Cl}^{-}]_{i} = 5~\\mathrm{mM}$, and the extracellular concentrations be $[\\mathrm{K}^{+}]_{o} = 4~\\mathrm{mM}$, $[\\mathrm{Na}^{+}]_{o} = 145~\\mathrm{mM}$, and $[\\mathrm{Cl}^{-}]_{o} = 120~\\mathrm{mM}$. The relative permeabilities are $P_{\\mathrm{K}} = 1.0$, $P_{\\mathrm{Na}} = 0.04$, and $P_{\\mathrm{Cl}} = 0.45$. The temperature is $T = 310~\\mathrm{K}$. Use the universal gas constant $R$ and Faraday’s constant $F$ symbolically.\n\nStarting from the Nernst–Planck equation for ionic flux under the constant-field approximation and the condition of zero net transmembrane current, derive the Goldman–Hodgkin–Katz (GHK) voltage relation for a membrane permeable to $\\mathrm{K}^{+}$, $\\mathrm{Na}^{+}$, and $\\mathrm{Cl}^{-}$, and then:\n\n1. Compute the resting membrane potential $V_{m}$ using your derived relation.\n2. Analyze the sensitivity of $V_{m}$ to small changes in the extracellular potassium concentration $[\\mathrm{K}^{+}]_{o}$ by computing the partial derivative $\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}$ evaluated at the given baseline concentrations.\n\nExpress the final reported sensitivity value in millivolts per millimolar ($\\mathrm{mV}/\\mathrm{mM}$) and round it to four significant figures. Use the natural logarithm for any logarithmic calculations. Report only the sensitivity value as your final answer.",
            "solution": "The relevant fundamental base is the Nernst–Planck equation under the constant-field approximation and the steady-state condition of zero net transmembrane current. For an ion species $i$ of valence $z_{i}$, concentration $C_{i}(x)$, diffusion coefficient $D_{i}$, and electric potential $\\phi(x)$ across a membrane of thickness $L$, the one-dimensional Nernst–Planck flux is\n$$\nJ_{i} \\;=\\; -D_{i}\\left(\\frac{d C_{i}}{d x} + \\frac{z_{i} F}{R T} C_{i} \\frac{d \\phi}{d x}\\right).\n$$\nUnder the constant-field approximation, $\\frac{d \\phi}{d x}$ is uniform across the membrane, and the steady-state condition implies that the total current is zero:\n$$\nI \\;=\\; \\sum_{i} z_{i} F J_{i} \\;=\\; 0.\n$$\nIntegrating the Nernst–Planck equation across the membrane with boundary concentrations $C_{i}(0) = C_{i,o}$ (outside) and $C_{i}(L) = C_{i,i}$ (inside), and defining the permeability $P_{i}$ (which subsumes $D_{i}$ and partition factors), yields the Goldman–Hodgkin–Katz (GHK) voltage relation for monovalent ions $\\mathrm{K}^{+}$ ($z_{\\mathrm{K}} = +1$), $\\mathrm{Na}^{+}$ ($z_{\\mathrm{Na}} = +1$), and $\\mathrm{Cl}^{-}$ ($z_{\\mathrm{Cl}} = -1$):\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o}}\\right),\n$$\nwhere the contributions of anions enter with the intracellular concentration in the numerator and the extracellular concentration in the denominator due to $z_{\\mathrm{Cl}} = -1$.\n\nDefine\n$$\nN \\;=\\; P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i},\n\\quad\nD \\;=\\; P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o},\n$$\nso that\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{N}{D}\\right).\n$$\n\nStep 1: Compute the resting membrane potential $V_{m}$ at baseline concentrations and permeabilities. Symbolically, it is\n$$\nV_{m} \\;=\\; \\frac{R T}{F} \\ln\\!\\left(\\frac{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{o}}\\right).\n$$\nNumerically, using the provided values:\n- $N = (1.0)\\cdot 4 + (0.04)\\cdot 145 + (0.45)\\cdot 5 = 4 + 5.8 + 2.25 = 12.05$,\n- $D = (1.0)\\cdot 140 + (0.04)\\cdot 12 + (0.45)\\cdot 120 = 140 + 0.48 + 54 = 194.48$,\nand \n$$\nV_{m} = \\frac{R T}{F} \\ln\\!\\left(\\frac{12.05}{194.48}\\right).\n$$\nAt $T = 310~\\mathrm{K}$, $\\frac{R T}{F}$ is approximately $0.0267~\\mathrm{V}$, hence $V_{m} \\approx 0.0267 \\cdot \\ln(0.06196) \\approx 0.0267 \\cdot (-2.78) \\approx -0.0743~\\mathrm{V}$, that is approximately $-74.3~\\mathrm{mV}$.\n\nStep 2: Sensitivity of $V_{m}$ to extracellular potassium. We compute the partial derivative\n$$\n\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}} \\;=\\; \\frac{\\partial}{\\partial [\\mathrm{K}^{+}]_{o}} \\left(\\frac{R T}{F} \\ln\\!\\left(\\frac{N}{D}\\right)\\right)\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{1}{N} \\cdot \\frac{\\partial N}{\\partial [\\mathrm{K}^{+}]_{o}},\n$$\nbecause $D$ does not depend on $[\\mathrm{K}^{+}]_{o}$. Since $N = P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}$, we have $\\frac{\\partial N}{\\partial [\\mathrm{K}^{+}]_{o}} = P_{\\mathrm{K}}$. Therefore,\n$$\n\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}} \\;=\\; \\frac{R T}{F} \\cdot \\frac{P_{\\mathrm{K}}}{P_{\\mathrm{K}} [\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Na}} [\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}} [\\mathrm{Cl}^{-}]_{i}}.\n$$\nEvaluating at the baseline values,\n$$\n\\left.\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}\\right|_{\\text{baseline}}\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{P_{\\mathrm{K}}}{N}\n\\;=\\; \\frac{R T}{F} \\cdot \\frac{1.0}{12.05}.\n$$\nUsing $T = 310~\\mathrm{K}$ and keeping $R$ and $F$ symbolic until evaluation, the numerical value is approximately\n$$\n\\left.\\frac{\\partial V_{m}}{\\partial [\\mathrm{K}^{+}]_{o}}\\right|_{\\text{baseline}} \\;\\approx\\; \\frac{0.0267~\\mathrm{V}}{12.05~\\mathrm{mM}} \\;\\approx\\; 0.002216~\\mathrm{V}/\\mathrm{mM} \\;=\\; 2.216~\\mathrm{mV}/\\mathrm{mM}.\n$$\nRounded to four significant figures, the sensitivity is $2.216~\\mathrm{mV}/\\mathrm{mM}$.",
            "answer": "$$\\boxed{2.216}$$"
        },
        {
            "introduction": "While the GHK equation describes the potential of a uniform membrane, neurons have intricate and sprawling dendritic trees that are essential for processing synaptic information. This exercise explores how this complex morphology shapes a neuron's electrical properties using the principles of passive cable theory, as pioneered by Wilfrid Rall. You will derive how a dendrite's input impedance scales with its diameter and see how Rall’s celebrated $3/2$ power law  provides a rule for efficient signal transfer across dendritic branches, linking physical structure directly to computational function.",
            "id": "4038119",
            "problem": "Consider a neuron with a uniform cylindrical dendrite that branches at a single node into two daughter dendrites. Assume quasi-static, passive membrane conditions and treat each daughter as a semi-infinite cable. A synapse located exactly at the branch node injects a steady current and “sees” an input impedance determined by the axial and membrane properties of the downstream dendritic load. Let the membrane specific resistance be $R_{m}$ (in $\\Omega\\,\\text{m}^{2}$), and the axial resistivity be $R_{a}$ (in $\\Omega\\,\\text{m}$). The parent dendrite has diameter $d_{0}$, and the two daughters have diameters $d_{1}$ and $d_{2}$. Work from the following foundational bases only: the definition of axial resistance per unit length for a cylinder, the definition of membrane conductance per unit length for a cylinder, the input impedance of a semi-infinite passive cable as the characteristic impedance of a resistive transmission line, series-parallel combinations in lumped circuit equivalence, and the morphological impedance matching condition known as Rall’s $3/2$ power law.\n\nTasks:\n1. Starting from the definitions of axial resistance per unit length and membrane conductance per unit length for a cylindrical cable, derive how the steady-state input impedance of a semi-infinite dendrite scales with its diameter. Then, using series-parallel equivalences at the branch, derive the expression for the input impedance seen by the synapse into two downstream semi-infinite daughters in terms of $d_{1}$ and $d_{2}$. Explain how Rall’s $3/2$ power law emerges from the requirement that branching does not alter the input impedance seen at the node.\n2. Verify with a numerical example by taking $R_{m} = 2\\,\\Omega\\,\\text{m}^{2}$, $R_{a} = 1\\,\\Omega\\,\\text{m}$, $d_{0} = 2.4\\,\\mu\\text{m}$, $d_{1} = 1.2\\,\\mu\\text{m}$, and a “mismatched” branch with $d_{2} = 1.4\\,\\mu\\text{m}$. Compute the input impedance into the parent ($d_{0}$) and into the mismatched daughters ($d_{1}$ and $d_{2}$) and express these impedances in megaohms. Also compute the diameter $d_{2}^{\\ast}$ that satisfies Rall’s $3/2$ power law for the given $d_{0}$ and $d_{1}$ and show that the matched input impedance equals the parent’s value.\n3. Finally, report the single dimensionless ratio\n$$\\rho \\equiv \\frac{\\text{mismatched branch input impedance}}{\\text{matched branch (Rall) input impedance}}$$\nfor the given numerical values. Round your final reported ratio $\\rho$ to four significant figures. The ratio is dimensionless, so no units are required for $\\rho$; however, express any intermediate impedances in megaohms as you verify the numerical example.",
            "solution": "**Task 1: Derivation of Impedance Scaling and Rall's Law**\n\nFirst, we derive the expressions for the axial resistance per unit length, $r_a$, and the membrane conductance per unit length, $g_m$, for a uniform cylindrical dendrite of diameter $d$.\n\nThe axial resistance of a conductor is given by $R = \\rho L / A$, where $\\rho$ is the resistivity (here, $R_a$), $L$ is the length, and $A$ is the cross-sectional area. For a cylinder, $A = \\pi (d/2)^2 = \\frac{\\pi d^2}{4}$. The axial resistance per unit length, $r_a$, is therefore:\n$$r_a = \\frac{R_a}{A} = \\frac{R_a}{\\frac{\\pi d^2}{4}} = \\frac{4 R_a}{\\pi d^2}$$\nThus, $r_a$ is proportional to $d^{-2}$.\n\nThe membrane specific resistance, $R_m$, has units of resistance times area ($\\Omega \\cdot \\text{m}^2$). The membrane resistance of a segment of length $L$ is $R_{\\text{mem}} = \\frac{R_m}{\\text{surface area}} = \\frac{R_m}{\\pi d L}$. The membrane resistance per unit length, $r_m$, is the quantity that, when divided by a length $\\Delta x$, gives the resistance of that segment. It is given by $r_m = \\frac{R_m}{\\pi d}$. The membrane conductance per unit length, $g_m$, is the reciprocal of $r_m$:\n$$g_m = \\frac{1}{r_m} = \\frac{\\pi d}{R_m}$$\nThus, $g_m$ is proportional to $d^1$.\n\nThe problem specifies to model the dendrite as a semi-infinite passive cable under steady-state (DC) conditions. The input impedance, $Z_{in}$, of such a cable is equal to its characteristic impedance, $Z_c$. For a passive cable treated as a resistive transmission line, this is given by:\n$$Z_{in} = Z_c = \\sqrt{\\frac{r_a}{g_m}}$$\nSubstituting our expressions for $r_a$ and $g_m$:\n$$Z_{in} = \\sqrt{\\frac{\\frac{4 R_a}{\\pi d^2}}{\\frac{\\pi d}{R_m}}} = \\sqrt{\\frac{4 R_a R_m}{\\pi^2 d^3}} = \\frac{2 \\sqrt{R_a R_m}}{\\pi} d^{-3/2}$$\nThis derivation shows that the steady-state input impedance of a semi-infinite dendrite scales with its diameter as $Z_{in} \\propto d^{-3/2}$.\n\nNext, we consider the branch node where the parent dendrite splits into two daughter dendrites of diameters $d_1$ and $d_2$. From the perspective of a synapse at the node, the two daughter dendrites are in parallel. The total input impedance of the branch, $Z_{branch}$, is found by summing the input conductances of the daughters. The input conductance $G_{in}$ is the reciprocal of the input impedance: $G_{in} = 1/Z_{in}$.\nFrom our scaling relationship, $G_{in} \\propto d^{3/2}$. Let the constant of proportionality be $K = \\frac{\\pi}{2 \\sqrt{R_a R_m}}$, so $G_{in}(d) = K d^{3/2}$.\n\nThe total conductance of the branch is the sum of the conductances of the two daughters:\n$$G_{branch} = G_1 + G_2 = K d_1^{3/2} + K d_2^{3/2} = K (d_1^{3/2} + d_2^{3/2})$$\nThe input impedance of the branch is the reciprocal of this total conductance:\n$$Z_{branch} = \\frac{1}{G_{branch}} = \\frac{1}{K (d_1^{3/2} + d_2^{3/2})} = \\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})}$$\n\nRall's $3/2$ power law emerges from the condition for impedance matching, which requires that the input impedance \"seen\" looking into the parent dendrite is equal to the input impedance \"seen\" looking into the combined daughter branches. That is, $Z_0 = Z_{branch}$. This is equivalent to matching the input conductances: $G_0 = G_{branch}$.\n$$G_0 = K d_0^{3/2}$$\n$$G_{branch} = K d_1^{3/2} + K d_2^{3/2}$$\nSetting them equal gives:\n$$K d_0^{3/2} = K (d_1^{3/2} + d_2^{3/2})$$\nCanceling the constant $K$ yields the morphological condition:\n$$d_0^{3/2} = d_1^{3/2} + d_2^{3/2}$$\nThis is Rall's $3/2$ power law for a bifurcating dendrite.\n\n**Task 2: Numerical Verification**\n\nWe are given the following values:\n$R_m = 2\\,\\Omega\\,\\text{m}^{2}$\n$R_a = 1\\,\\Omega\\,\\text{m}$\n$d_0 = 2.4\\,\\mu\\text{m} = 2.4 \\times 10^{-6}\\,\\text{m}$\n$d_1 = 1.2\\,\\mu\\text{m} = 1.2 \\times 10^{-6}\\,\\text{m}$\n$d_2 = 1.4\\,\\mu\\text{m} = 1.4 \\times 10^{-6}\\,\\text{m}$\n\nThe input impedance formula is $Z_{in}(d) = \\frac{2 \\sqrt{R_a R_m}}{\\pi} d^{-3/2}$.\nFirst, we compute the impedance of the parent dendrite, $Z_0$:\n$$Z_0 = Z_{in}(d_0) = \\frac{2 \\sqrt{(1)(2)}}{\\pi} (2.4 \\times 10^{-6})^{-3/2} = \\frac{2\\sqrt{2}}{\\pi (2.4)^{3/2} \\times 10^{-9}}\\,\\Omega$$\n$$Z_0 = \\frac{2.828427...}{(3.14159...)(3.717795...)} \\times 10^9\\,\\Omega = 0.24203 \\times 10^9\\,\\Omega = 242.03\\,\\text{M}\\Omega$$\n\nNext, we compute the input impedance of the mismatched branch with daughters $d_1$ and $d_2$.\n$$Z_{mismatched} = \\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})} = \\frac{2\\sqrt{2}}{\\pi ((1.2 \\times 10^{-6})^{3/2} + (1.4 \\times 10^{-6})^{3/2})}$$\n$$Z_{mismatched} = \\frac{2\\sqrt{2}}{\\pi \\times 10^{-9} ((1.2)^{3/2} + (1.4)^{3/2})} = \\frac{2.828427...}{\\pi (1.314534... + 1.656502...)} \\times 10^9\\,\\Omega$$\n$$Z_{mismatched} = \\frac{2.828427...}{\\pi (2.971036...)} \\times 10^9\\,\\Omega = 0.30289 \\times 10^9\\,\\Omega = 302.89\\,\\text{M}\\Omega$$\n\nNow, we find the diameter $d_2^*$ that satisfies Rall's law for the given $d_0$ and $d_1$:\n$$(d_2^*)^{3/2} = d_0^{3/2} - d_1^{3/2}$$\n$$d_2^* = (d_0^{3/2} - d_1^{3/2})^{2/3} = ((2.4 \\times 10^{-6})^{3/2} - (1.2 \\times 10^{-6})^{3/2})^{2/3}$$\n$$d_2^* = (10^{-9})^{2/3} (2.4^{3/2} - 1.2^{3/2})^{2/3} = 10^{-6} (3.717795... - 1.314534...)^{2/3}$$\n$$d_2^* = 10^{-6} (2.403261...)^{2/3} = 1.7958 \\times 10^{-6}\\,\\text{m}$$\n\nThe matched input impedance, $Z_{matched}$, is the impedance of the branch with daughters $d_1$ and $d_2^*$. Since these diameters satisfy $d_0^{3/2} = d_1^{3/2} + (d_2^*)^{3/2}$, the condition for impedance matching is met by definition. Therefore, the matched impedance must equal the parent impedance:\n$$Z_{matched} = Z_0 = 242.03\\,\\text{M}\\Omega$$\nThis verifies that when the branching geometry satisfies Rall's law, the input impedance is conserved across the branch point.\n\n**Task 3: Dimensionless Ratio $\\rho$**\n\nThe final task is to compute the ratio $\\rho$ of the mismatched branch impedance to the matched branch impedance.\n$$\\rho = \\frac{Z_{mismatched}}{Z_{matched}} = \\frac{Z_{mismatched}}{Z_0}$$\nUsing the impedances calculated in Task 2:\n$$\\rho = \\frac{302.89\\,\\text{M}\\Omega}{242.03\\,\\text{M}\\Omega} \\approx 1.25134$$\nAnalytically, the ratio is:\n$$\\rho = \\frac{\\frac{2 \\sqrt{R_a R_m}}{\\pi (d_1^{3/2} + d_2^{3/2})}}{\\frac{2 \\sqrt{R_a R_m}}{\\pi d_0^{3/2}}} = \\frac{d_0^{3/2}}{d_1^{3/2} + d_2^{3/2}}$$\nSubstituting the diameters:\n$$\\rho = \\frac{(2.4)^{3/2}}{(1.2)^{3/2} + (1.4)^{3/2}} = \\frac{3.717795...}{1.314534... + 1.656502...} = \\frac{3.717795...}{2.971036...} = 1.2513437...$$\nRounding the final value to four significant figures gives $1.251$.",
            "answer": "$$\\boxed{1.251}$$"
        },
        {
            "introduction": "Building upon the foundations of membrane potential and passive dendritic properties, this final practice moves into the realm of active, nonlinear dendritic computation. By constructing and simulating a two-compartment model , you will investigate how voltage-gated conductances can generate complex events like dendritic plateau potentials. Furthermore, this hands-on simulation demonstrates the profound functional impact of synapse location, allowing you to directly compare how soma-targeting versus dendrite-targeting inhibition can differentially control a neuron's output firing.",
            "id": "4038164",
            "problem": "You will model a neuron as a two-compartment system (a soma compartment and a dendrite compartment) with ohmic coupling, passive leak, and synaptic conductances, and with a nonlinear dendritic conductance that captures voltage-activated amplification of dendritic depolarization. Using first principles of current balance and the cable equation approximation, derive the ordinary differential equations that govern the somatic and dendritic membrane potentials under steady excitatory drive and time-invariant inhibition applied either to the soma or to the dendrite. Implement a simulation that integrates these equations over time and quantifies both the occurrence of a nonlinear dendritic plateau event and the somatic firing rate under six specified parameter sets that act as a test suite. Your program must output the results for all test cases in a single line as a comma-separated list enclosed in square brackets, with each test case contributing two numbers in order: first an indicator for whether a dendritic plateau occurred, expressed as $0$ or $1$; second the somatic firing rate expressed in Hertz (Hz) as a floating-point number rounded to three decimal places. Thus, the final output should be a flat list of length $12$.\n\nStart from the following fundamental base:\n- Membrane current balance: for each compartment with membrane capacitance $C$, membrane potential $V$, and a set of transmembrane currents $I_k$ flowing outward, the dynamics follow $C \\, dV/dt = - \\sum_k I_k$.\n- Ohmic (conductance-based) current: for a conductance $g$ with reversal potential $E$, the outward current is $I = g \\, (V - E)$.\n- Electrical coupling between compartments: for coupling conductance $g_c$, the outward current from the compartment at potential $V_1$ to the compartment at potential $V_2$ is $I_c = g_c \\, (V_1 - V_2)$.\n- A nonlinear dendritic conductance with steady-state activation $m_\\infty(V)$ captured by a Boltzmann function $m_\\infty(V) = 1 / (1 + \\exp(-(V - V_{1/2})/k))$, and effective conductance $g_{\\mathrm{NL}} \\, m_\\infty(V)^p$ with cooperativity exponent $p$.\n\nModel specifications to be used:\n- Two compartments: soma with potential $V_s(t)$ and dendrite with potential $V_d(t)$.\n- Soma and dendrite have capacitances $C_s$ and $C_d$, and leak conductances $g^{(s)}_L$ and $g^{(d)}_L$, respectively, all constants.\n- The soma and dendrite are coupled by conductance $g_c$.\n- The soma receives an inhibitory conductance $g^{(s)}_{\\mathrm{inh}}$ with reversal $E_{\\mathrm{inh}}$. The dendrite receives an inhibitory conductance $g^{(d)}_{\\mathrm{inh}}$ with the same reversal. Only one of these may be nonzero in a given test case to represent soma-targeting or dendrite-targeting inhibition.\n- The dendrite receives a constant excitatory conductance $g^{(d)}_{\\mathrm{exc}}$ with reversal $E_{\\mathrm{exc}}$.\n- The dendrite contains a nonlinear voltage-activated conductance with maximum $g_{\\mathrm{NL}}$, reversal $E_{\\mathrm{NL}}$, activation $m_\\infty(V_d)$ with half-activation $V_{1/2}$ and slope factor $k$, and exponent $p$.\n- The soma emits action potentials according to a Leaky Integrate-and-Fire (LIF) mechanism: when $V_s$ crosses a threshold $V_{\\mathrm{th}}$, a spike is counted, $V_s$ is reset to $V_{\\mathrm{reset}}$, and held there for a refractory period $\\tau_{\\mathrm{ref}}$ without integration.\n\nYour task:\n- Derive, from the principles above, the coupled differential equations for $V_s(t)$ and $V_d(t)$, explicitly indicating how each conductance contributes to the right-hand side as an outward current term.\n- Implement a time-domain simulation using a fixed time step explicit method that integrates the system over a total duration of $T$ with time step $\\Delta t$. Ensure numerical stability by choosing $\\Delta t$ small enough relative to the system time constants.\n- Define a dendritic plateau detector that returns $1$ if, at any time, the dendritic potential $V_d(t)$ remains continuously above a plateau threshold $V_{\\mathrm{plateau}}$ for at least a minimum duration $t_{\\mathrm{min}}$, and $0$ otherwise.\n- Compute the somatic firing rate as the total number of spikes divided by the simulation duration in seconds, expressed in Hertz, rounded to three decimal places.\n\nParameter values and physical units:\n- Use $C_s = 200 \\times 10^{-12}$ farads, $C_d = 200 \\times 10^{-12}$ farads.\n- Use $g^{(s)}_L = 10 \\times 10^{-9}$ siemens, $g^{(d)}_L = 8 \\times 10^{-9}$ siemens.\n- Use $g_c = 5 \\times 10^{-9}$ siemens.\n- Use $E_L = -0.065$ volts, $E_{\\mathrm{inh}} = -0.070$ volts, $E_{\\mathrm{exc}} = 0.0$ volts, $E_{\\mathrm{NL}} = 0.0$ volts.\n- Use $V_{1/2} = -0.035$ volts, $k = 0.002$ volts, $p = 2$.\n- Use LIF parameters $V_{\\mathrm{th}} = -0.050$ volts, $V_{\\mathrm{reset}} = -0.065$ volts, $\\tau_{\\mathrm{ref}} = 0.002$ seconds.\n- Use simulation duration $T = 1.0$ seconds and time step $\\Delta t = 0.000025$ seconds.\n- Plateau detection uses $V_{\\mathrm{plateau}} = -0.040$ volts and $t_{\\mathrm{min}} = 0.020$ seconds.\n- Initial conditions: $V_s(0) = E_L$, $V_d(0) = E_L$.\n\nTest suite (each case is a quadruple $\\left(g^{(d)}_{\\mathrm{exc}}, g^{(s)}_{\\mathrm{inh}}, g^{(d)}_{\\mathrm{inh}}, g_{\\mathrm{NL}}\\right)$ in siemens):\n- Case $1$ (happy path, no inhibition, strong nonlinearity): $\\left(25 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}\\right)$.\n- Case $2$ (soma-targeting inhibition): $\\left(25 \\times 10^{-9}, 10 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}\\right)$.\n- Case $3$ (dendrite-targeting inhibition): $\\left(25 \\times 10^{-9}, 0 \\times 10^{-9}, 10 \\times 10^{-9}, 20 \\times 10^{-9}\\right)$.\n- Case $4$ (strong dendritic inhibition, boundary for plateau suppression): $\\left(25 \\times 10^{-9}, 0 \\times 10^{-9}, 25 \\times 10^{-9}, 20 \\times 10^{-9}\\right)$.\n- Case $5$ (low excitatory drive near nonlinearity threshold): $\\left(12 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 20 \\times 10^{-9}\\right)$.\n- Case $6$ (control with no dendritic nonlinearity): $\\left(25 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}, 0 \\times 10^{-9}\\right)$.\n\nNumerical outputs:\n- For each test case, return two numbers in order: the plateau indicator as $0$ or $1$, and the somatic firing rate in Hz rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\right.$$r_1,r_2,\\dots$$\\left.\\right]$), where the list is flat and follows the order: Case $1$ indicator, Case $1$ rate, Case $2$ indicator, Case $2$ rate, and so on, through Case $6$.\n\nAngle units are not applicable. All physical quantities must be treated in the units specified above. Do not prompt for input; the program must be self-contained and directly produce the specified output for the given test suite.",
            "solution": "The problem requires the derivation and simulation of a two-compartment neuronal model. The solution is presented in two parts: first, the derivation of the governing differential equations from first principles, and second, the description of the numerical simulation methodology.\n\n### Derivation of the Governing Equations\n\nThe model consists of two electrically coupled compartments: a soma and a dendrite. The dynamics of the membrane potential in each compartment are governed by the principle of current balance, which states that the rate of change of membrane potential is proportional to the net current flowing across the membrane. The governing equation is given as $C \\frac{dV}{dt} = - \\sum_k I_k$, where $C$ is the capacitance, $V$ is the membrane potential, and $I_k$ are the various outward currents. An outward Ohmic current is defined as $I = g(V - E)$, where $g$ is the conductance and $E$ is the reversal potential.\n\n**1. Somatic Compartment Potential, $V_s(t)$**\n\nThe soma has capacitance $C_s$ and its potential is $V_s$. The currents flowing out of the soma are:\n-   **Leak Current ($I_L^{(s)}$)**: A passive current that drives the potential towards the leak reversal potential $E_L$. The conductance is $g^{(s)}_L$.\n    $$I_L^{(s)} = g^{(s)}_L (V_s - E_L)$$\n-   **Inhibitory Synaptic Current ($I_{\\mathrm{inh}}^{(s)}$)**: A time-invariant inhibitory current with conductance $g^{(s)}_{\\mathrm{inh}}$ and reversal potential $E_{\\mathrm{inh}}$.\n    $$I_{\\mathrm{inh}}^{(s)} = g^{(s)}_{\\mathrm{inh}} (V_s - E_{\\mathrm{inh}})$$\n-   **Coupling Current ($I_c^{(s \\to d)}$)**: The current flowing from the soma to the dendrite through the coupling conductance $g_c$.\n    $$I_c^{(s \\to d)} = g_c (V_s - V_d)$$\n\nSumming these outward currents, the total current is $\\sum I_k = I_L^{(s)} + I_{\\mathrm{inh}}^{(s)} + I_c^{(s \\to d)}$. Applying the current balance equation for the soma yields:\n$$C_s \\frac{dV_s}{dt} = - \\left[ g^{(s)}_L (V_s - E_L) + g^{(s)}_{\\mathrm{inh}} (V_s - E_{\\mathrm{inh}}) + g_c (V_s - V_d) \\right]$$\n\n**2. Dendritic Compartment Potential, $V_d(t)$**\n\nThe dendrite has capacitance $C_d$ and its potential is $V_d$. The currents flowing out of the dendrite are:\n-   **Leak Current ($I_L^{(d)}$)**: A passive current with conductance $g^{(d)}_L$.\n    $$I_L^{(d)} = g^{(d)}_L (V_d - E_L)$$\n-   **Inhibitory Synaptic Current ($I_{\\mathrm{inh}}^{(d)}$)**: A time-invariant inhibitory current with conductance $g^{(d)}_{\\mathrm{inh}}$.\n    $$I_{\\mathrm{inh}}^{(d)} = g^{(d)}_{\\mathrm{inh}} (V_d - E_{\\mathrm{inh}})$$\n-   **Excitatory Synaptic Current ($I_{\\mathrm{exc}}^{(d)}$)**: A time-invariant excitatory current with conductance $g^{(d)}_{\\mathrm{exc}}$ and reversal potential $E_{\\mathrm{exc}}$.\n    $$I_{\\mathrm{exc}}^{(d)} = g^{(d)}_{\\mathrm{exc}} (V_d - E_{\\mathrm{exc}})$$\n-   **Nonlinear Voltage-Gated Current ($I_{\\mathrm{NL}}$)**: An inward-rectifying current that amplifies dendritic depolarization. The effective conductance depends on the dendritic voltage $V_d$ through an activation function $m_\\infty(V_d)$. The maximal conductance is $g_{\\mathrm{NL}}$, the reversal potential is $E_{\\mathrm{NL}}$, and the cooperativity is $p$.\n    $$I_{\\mathrm{NL}} = g_{\\mathrm{NL}} \\left(m_\\infty(V_d)\\right)^p (V_d - E_{\\mathrm{NL}})$$\n    The steady-state activation function $m_\\infty(V_d)$ is a sigmoidal Boltzmann function:\n    $$m_\\infty(V_d) = \\frac{1}{1 + \\exp\\left(-\\frac{V_d - V_{1/2}}{k}\\right)}$$\n-   **Coupling Current ($I_c^{(d \\to s)}$)**: The current flowing from the dendrite to the soma. By convention, this is an outward current from the dendrite.\n    $$I_c^{(d \\to s)} = g_c (V_d - V_s)$$\n\nSumming these outward currents for the dendrite, $\\sum I_k = I_L^{(d)} + I_{\\mathrm{inh}}^{(d)} + I_{\\mathrm{exc}}^{(d)} + I_{\\mathrm{NL}} + I_c^{(d \\to s)}$. The current balance equation is:\n$$C_d \\frac{dV_d}{dt} = - \\left[ g^{(d)}_L (V_d - E_L) + g^{(d)}_{\\mathrm{inh}} (V_d - E_{\\mathrm{inh}}) + g^{(d)}_{\\mathrm{exc}} (V_d - E_{\\mathrm{exc}}) + g_{\\mathrm{NL}} \\left(m_\\infty(V_d)\\right)^p (V_d - E_{\\mathrm{NL}}) + g_c (V_d - V_s) \\right]$$\n\nThese two coupled ordinary differential equations (ODEs), along with the Leaky Integrate-and-Fire (LIF) mechanism for the soma, fully describe the system dynamics.\n\n### Numerical Simulation and Analysis\n\nThe system of ODEs is integrated numerically using the forward Euler method with a fixed time step $\\Delta t$. For an ODE of the form $\\frac{dy}{dt} = f(y,t)$, the update rule is $y(t+\\Delta t) = y(t) + \\Delta t \\cdot f(y(t),t)$.\n\nThe simulation proceeds as follows:\n1.  **Initialization**: The state variables $V_s$ and $V_d$ are initialized to the leak reversal potential $E_L = -0.065$ V. Time $t$ is initialized to $0$, spike count to $0$, and a refractory period counter to $0$.\n2.  **Time-Stepping Loop**: The simulation runs from $t=0$ to $t=T$ in steps of $\\Delta t$. In each step:\n    a. The state of the somatic LIF mechanism is checked. If the neuron is in its refractory period (duration $\\tau_{\\mathrm{ref}}$), the somatic potential $V_s$ is clamped to the reset potential $V_{\\mathrm{reset}}$. The somatic integration is bypassed. The dendritic compartment, however, continues to evolve, with its dynamics influenced by the clamped somatic potential.\n    b. If the neuron is not in a refractory period, the derivatives $\\frac{dV_s}{dt}$ and $\\frac{dV_d}{dt}$ are calculated using the values of $V_s$ and $V_d$ from the beginning of the time step. Both potentials are then updated using the Euler rule.\n    c. After the update, the somatic potential $V_s$ is checked against the firing threshold $V_{\\mathrm{th}}$. If $V_s \\ge V_{\\mathrm{th}}$, a spike is recorded, $V_s$ is immediately set to $V_{\\mathrm{reset}}$, and the refractory counter is initiated.\n3.  **Dendritic Plateau Detection**: During the simulation, the history of $V_d(t)$ is stored. After the simulation completes, this history is analyzed. A plateau event is registered (indicator = $1$) if $V_d(t)$ remains continuously above a threshold $V_{\\mathrm{plateau}}$ for a duration equal to or greater than $t_{\\mathrm{min}}$. Otherwise, the indicator is $0$.\n4.  **Firing Rate Calculation**: The somatic firing rate is computed as the total number of spikes divided by the total simulation duration $T$, expressed in Hz and rounded to three decimal places.\n\nThis procedure is applied to each of the six test cases specified in the problem, yielding a pair of results (plateau indicator, firing rate) for each case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-compartment neuron model problem by simulating the dynamics\n    for six test cases and printing the results in the specified format.\n    \"\"\"\n\n    # --- Model and Simulation Parameters ---\n    # Capacitances (F)\n    C_s = 200e-12\n    C_d = 200e-12\n    # Leak Conductances (S)\n    g_leak_s = 10e-9\n    g_leak_d = 8e-9\n    # Coupling Conductance (S)\n    g_c = 5e-9\n    # Reversal Potentials (V)\n    E_leak = -0.065\n    E_inh = -0.070\n    E_exc = 0.0\n    E_nl = 0.0\n    # Nonlinear Conductance Parameters\n    V_half = -0.035  # V\n    k = 0.002        # V\n    p = 2\n    # LIF Parameters (V & s)\n    V_th = -0.050\n    V_reset = -0.065\n    tau_ref = 0.002\n    # Simulation Time Parameters (s)\n    T = 1.0\n    dt = 0.000025\n    # Plateau Detection Parameters (V & s)\n    V_plateau = -0.040\n    t_min_plateau = 0.020\n    \n    # Pre-calculated simulation constants\n    num_steps = int(T / dt)\n    ref_steps_total = int(tau_ref / dt)\n    min_plateau_steps = int(t_min_plateau / dt)\n    \n    # Test Suite (g_exc_d, g_inh_s, g_inh_d, g_nl) in Siemens\n    test_cases = [\n        (25e-9, 0e-9, 0e-9, 20e-9),    # Case 1\n        (25e-9, 10e-9, 0e-9, 20e-9),   # Case 2\n        (25e-9, 0e-9, 10e-9, 20e-9),   # Case 3\n        (25e-9, 0e-9, 25e-9, 20e-9),   # Case 4\n        (12e-9, 0e-9, 0e-9, 20e-9),   # Case 5\n        (25e-9, 0e-9, 0e-9, 0e-9),     # Case 6\n    ]\n\n    def run_simulation(g_exc_d, g_inh_s, g_inh_d, g_nl):\n        \"\"\"\n        Runs a single simulation for a given set of conductances.\n        \"\"\"\n        # State variables\n        Vs = E_leak\n        Vd = E_leak\n        ref_counter = 0\n        spike_count = 0\n        Vd_history = np.zeros(num_steps)\n\n        # Nonlinear activation function\n        def m_inf(v):\n            return 1.0 / (1.0 + np.exp(-(v - V_half) / k))\n\n        # Main simulation loop\n        for i in range(num_steps):\n            Vd_history[i] = Vd\n            \n            # If refractory, soma is clamped at V_reset\n            if ref_counter > 0:\n                Vd_calc_Vs = V_reset\n                ref_counter -= 1\n            else:\n                Vd_calc_Vs = Vs\n\n            # Dendritic integration is always active\n            g_nl_eff = g_nl * (m_inf(Vd)**p)\n            dVd_dt = (\n                g_leak_d * (E_leak - Vd) +\n                g_inh_d * (E_inh - Vd) +\n                g_exc_d * (E_exc - Vd) +\n                g_nl_eff * (E_nl - Vd) +\n                g_c * (Vd_calc_Vs - Vd)\n            ) / C_d\n            Vd += dVd_dt * dt\n\n            # Somatic integration only if not refractory\n            if Vd_calc_Vs == Vs:  # i.e., not refractory\n                dVs_dt = (\n                    g_leak_s * (E_leak - Vs) +\n                    g_inh_s * (E_inh - Vs) +\n                    g_c * (Vd_history[i] - Vs) # Vd at start of time step\n                ) / C_s\n                Vs += dVs_dt * dt\n            else:\n                Vs = V_reset\n            \n            # Check for spike and reset\n            if Vs >= V_th:\n                spike_count += 1\n                Vs = V_reset\n                ref_counter = ref_steps_total\n\n        # --- Post-simulation Analysis ---\n\n        # 1. Plateau Detection\n        plateau_indicator = 0\n        consecutive_high = 0\n        for v_d_val in Vd_history:\n            if v_d_val >= V_plateau:\n                consecutive_high += 1\n            else:\n                consecutive_high = 0\n            \n            if consecutive_high >= min_plateau_steps:\n                plateau_indicator = 1\n                break\n        \n        # 2. Firing Rate Calculation\n        firing_rate = round(spike_count / T, 3)\n\n        return plateau_indicator, firing_rate\n\n    # Run all test cases and collect results\n    all_results = []\n    for case in test_cases:\n        indicator, rate = run_simulation(*case)\n        all_results.append(indicator)\n        all_results.append(rate)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}