{
    "hands_on_practices": [
        {
            "introduction": "事件驱动范式的核心优势之一是其数据效率，尤其是在处理具有稀疏动态的场景时。本练习通过一个简化的模型，引导我们从第一性原理出发，推导并比较事件相机与传统帧相机的预期数据率。通过解决这个问题，我们将量化理解场景的稀疏性（$p$）和活动水平（$\\lambda$）是如何决定事件驱动方法的效率优势的，从而为在特定应用中选择合适的传感技术提供理论依据。",
            "id": "4043693",
            "problem": "考虑一个遵循基于事件处理范式的神经形态视觉传感器。在这种范式中，当局部信号发生足够大的变化时，像素会生成异步事件。假设在观测区间内，以下场景是平稳的：$N_x \\times N_y$个像素中有一部分（比例为$p$）是活动的，每个活动像素根据一个无记忆过程产生事件，平均速率为每秒$\\lambda$个事件。每个事件携带一个$b_a$位的地址和一个$b_t$位的时间戳。忽略所有额外的协议开销，并假设每个事件的地址和时间戳是独立编码的。作为比较，考虑一个具有相同空间分辨率$N_x \\times N_y$的传统基于帧的相机，其运行速率为每秒$f$帧（Frames Per Second (FPS)），每个像素的强度用$b_p$位进行量化，并假设除了像素数据外，开销可以忽略不计。\n\n从第一性原理和关于速率过程与信息表示的公认事实出发，推导事件流数据速率（以比特/秒为单位）的期望值表达式，并在此基础上，推导事件流数据速率与基于帧的数据速率的无量纲比率$\\Gamma$的闭式表达式。请用$p$、$\\lambda$、$f$、$b_a$、$b_t$和$b_p$来表示$\\Gamma$，给出一个单一的解析表达式作为最终答案。",
            "solution": "基于事件的传感器可以被建模为一组独立的点过程，每个像素对应一个。我们假设活动像素具有平稳性和无记忆性，这与泊松过程模型一致。对于一个速率为$\\lambda$（事件/秒）的泊松过程，在长度为$T$的时间间隔内，期望的事件数量是$\\lambda T$。根据期望的线性性质，由$M$个独立的、每个速率为$\\lambda$的过程在持续时间$T$内产生的期望事件数量是$M \\lambda T$。\n\n在给定场景中，$N_x \\times N_y$个像素中有一部分（比例为$p$）是活动的，因此活动像素的期望数量是\n$$\nM = p \\, N_x N_y.\n$$\n因此，传感器每秒生成的期望事件数量是\n$$\n\\text{events per second} = M \\lambda = p \\, N_x N_y \\, \\lambda.\n$$\n每个事件携带一个$b_a$位的地址和一个$b_t$位的时间戳。假设每个事件都包含这两者，并忽略其他开销，则每个事件的比特数是\n$$\nb_{\\text{event}} = b_a + b_t.\n$$\n因此，期望的事件流数据速率$R_{\\text{event}}$（以比特/秒为单位）是\n$$\nR_{\\text{event}} = \\Big(p \\, N_x N_y \\, \\lambda\\Big) \\, \\Big(b_a + b_t\\Big).\n$$\n\n对于基于帧的相机，每一帧编码$N_x N_y$个像素强度，每个像素$b_p$位。每帧的比特数是\n$$\nb_{\\text{frame}} = N_x N_y \\, b_p.\n$$\n在每秒$f$帧的速率下，基于帧的数据速率$R_{\\text{frame}}$是\n$$\nR_{\\text{frame}} = f \\, b_{\\text{frame}} = f \\, N_x N_y \\, b_p.\n$$\n\n我们被要求使用一个无量纲比率$\\Gamma$来比较事件流数据速率和基于帧的数据速率，定义为\n$$\n\\Gamma = \\frac{R_{\\text{event}}}{R_{\\text{frame}}}.\n$$\n代入上面推导出的表达式，\n$$\n\\Gamma = \\frac{\\Big(p \\, N_x N_y \\, \\lambda\\Big)\\, \\Big(b_a + b_t\\Big)}{f \\, N_x N_y \\, b_p}.\n$$\n公共因子$N_x N_y$被消去，得到闭式表达式\n$$\n\\Gamma = \\frac{p \\, \\lambda \\, \\Big(b_a + b_t\\Big)}{f \\, b_p}.\n$$\n该表达式仅依赖于活动像素比例$p$、每个活动像素的事件速率$\\lambda$、帧率$f$以及每个样本的比特分配$b_a$、$b_t$和$b_p$。它概括了所要求的比较，并且是无量纲的，符合要求。",
            "answer": "$$\\boxed{\\frac{p\\,\\lambda\\,(b_a+b_t)}{f\\,b_p}}$$"
        },
        {
            "introduction": "从传感器的数据效率延伸到处理层面，事件驱动的方法同样能显著降低神经网络的计算负载。本练习探讨了如何将稀疏更新的原则应用于前馈网络，通过一个基于激活函数Lipschitz连续性的阈值机制来触发事件。这个实践不仅连接了严谨的数学理论与实用的算法设计，还通过具体的计算展示了在处理过程中节省的乘积累加（MAC）操作数量，揭示了事件驱动计算在实现节能高效的机器学习硬件中的巨大潜力。",
            "id": "4043669",
            "problem": "考虑一个在前馈网络中，采用基于事件的处理范式。该网络有一个大小为 $N_{0}$ 的输入层，一个大小为 $N_{1}$ 的隐藏层，以及一个大小为 $N_{2}$ 的输出层。隐藏层和输出层使用修正线性单元（ReLU）非线性激活函数，已知该函数是 $1$-Lipschitz 的，即对于任意输入 $u$ 和 $v$，有 $|\\mathrm{ReLU}(u) - \\mathrm{ReLU}(v)| \\leq |u - v|$。在密集更新模式下，于每个离散时间步 $t$，每个神经元计算其预激活值 $a_{j}^{(\\ell)}(t) = \\sum_{i} w_{ji}^{(\\ell)} x_{i}^{(\\ell-1)}(t) + b_{j}^{(\\ell)}$，并应用非线性函数得到 $y_{j}^{(\\ell)}(t) = \\phi(a_{j}^{(\\ell)}(t))$，其中 $\\phi(u) = \\max\\{0, u\\}$。在事件驱动模式下，每个神经元会维持一个本地存储的上次传输的预激活值 $\\hat{a}_{j}^{(\\ell)}$，并且仅当其当前预激活值与该存储值的偏差超过阈值 $\\tau_{\\ell}$ 时才传输一个事件。神经元上的一个事件会沿着其每个传出突触触发一次乘法累加（MAC）操作。\n\nA 部分（推导）：从非线性函数的 $L$-Lipschitz 连续性和传输激活偏差的层内误差容限 $\\varepsilon_{\\ell}$ 出发，推导出一个在层 $\\ell$ 中传播事件的充分条件，该条件保证 $|\\phi(a_{j}^{(\\ell)}(t)) - \\phi(\\hat{a}_{j}^{(\\ell)})| \\leq \\varepsilon_{\\ell}$ 仅在超过阈值时才被违反。将你的条件表示为一个包含 $|a_{j}^{(\\ell)}(t) - \\hat{a}_{j}^{(\\ell)}|$ 和 $\\tau_{\\ell}$ 的不等式，并将 $\\tau_{\\ell}$ 与 $\\varepsilon_{\\ell}$ 及 $\\phi$ 的 Lipschitz 常数 $L$ 联系起来。\n\nB 部分（计算）：考虑具体的网络大小 $N_{0} = 4096$，$N_{1} = 1024$，$N_{2} = 256$。假设有 $M = 10000$ 个离散时间步。在密集模式下，每个突触在每个时间步计为一次 MAC 操作（忽略应用非线性函数的成本）。在事件驱动模式下，假设输入层在整个时间窗口内总共产生 $E_{0} = 2.0 \\times 10^{6}$ 个事件，每个输入事件都会沿着所有到隐藏层的传出突触触发 MAC 操作。隐藏层根据异步增量编码模型产生事件：其在整个窗口内所有隐藏神经元的预激活值的聚合总变差为 $V_{1} = 1.024 \\times 10^{9}$，且隐藏层的容限为 $\\varepsilon_{1} = 128$。使用 ReLU 的 $1$-Lipschitz 属性来设置 $\\tau_{1}$，并假设隐藏层事件的数量满足 $E_{1} = V_{1} / \\tau_{1}$，其中每个事件都会沿着所有到输出层的传出突触触发 MAC 操作。计算在整个窗口内，事件驱动模式相对于密集模式所节省的 MAC 操作总数。以单一实数值报告你的最终答案。不要包含单位，不要四舍五入；提供精确值。",
            "solution": "对于 A 部分，我们从 $L$-Lipschitz 连续性的定义开始。如果对于任意的 $u$ 和 $v$，一个函数 $\\phi$ 满足下式，则该函数是 $L$-Lipschitz 的：\n$$\n|\\phi(u) - \\phi(v)| \\leq L |u - v|.\n$$\n对于修正线性单元（ReLU），已知 $L = 1$。在基于事件的模式中，一个神经元存储其上次传输的预激活值 $\\hat{a}_{j}^{(\\ell)}$，并根据其当前预激活值 $a_{j}^{(\\ell)}(t)$ 的偏差来决定是否传输。为了保证传输激活值的偏差 $|\\phi(a_{j}^{(\\ell)}(t)) - \\phi(\\hat{a}_{j}^{(\\ell)})|$ 不超过层内容限 $\\varepsilon_{\\ell}$，只需确保\n$$\n|\\phi(a_{j}^{(\\ell)}(t)) - \\phi(\\hat{a}_{j}^{(\\ell)})| \\leq \\varepsilon_{\\ell}.\n$$\n根据 Lipschitz 连续性，\n$$\n|\\phi(a_{j}^{(\\ell)}(t)) - \\phi(\\hat{a}_{j}^{(\\ell)})| \\leq L |a_{j}^{(\\ell)}(t) - \\hat{a}_{j}^{(\\ell)}|.\n$$\n因此，如果我们强制 $|a_{j}^{(\\ell)}(t) - \\hat{a}_{j}^{(\\ell)}|  \\tau_{\\ell}$ 且 $\\tau_{\\ell} = \\varepsilon_{\\ell} / L$，那么激活偏差就以 $\\varepsilon_{\\ell}$ 为界。因此，一个充分且标准的事件传播条件是当以下不等式成立时触发事件：\n$$\n|a_{j}^{(\\ell)}(t) - \\hat{a}_{j}^{(\\ell)}| \\ge \\tau_{\\ell},\n$$\n其中\n$$\n\\tau_{\\ell} = \\frac{\\varepsilon_{\\ell}}{L}.\n$$\n对于 ReLU，$L = 1$，所以 $\\tau_{\\ell} = \\varepsilon_{\\ell}$。该规则确保仅当存储的预激活值和当前的预激活值之间的差异至少达到与允许的激活偏差相对应的阈值时才传播事件，因此通过仅在需要维持规定精度时才传输更新来遵守稀疏更新原则。\n\n对于 B 部分，我们量化两种模式下的 MAC 操作。\n\n密集模式：每个突触在每个时间步计为一次 MAC 操作。输入层和隐藏层之间的突触数量为 $N_{0} N_{1}$，隐藏层和输出层之间的突触数量为 $N_{1} N_{2}$。因此，在 $M$ 个时间步内，密集模式下的 MAC 总数为\n$$\n\\mathrm{MAC}_{\\mathrm{dense}} = M \\left( N_{0} N_{1} + N_{1} N_{2} \\right).\n$$\n代入给定值 $N_{0} = 4096$，$N_{1} = 1024$，$N_{2} = 256$ 和 $M = 10000$：\n$$\nN_{0} N_{1} = 4096 \\times 1024 = 4194304,\n$$\n$$\nN_{1} N_{2} = 1024 \\times 256 = 262144,\n$$\n$$\nN_{0} N_{1} + N_{1} N_{2} = 4194304 + 262144 = 4456448,\n$$\n$$\n\\mathrm{MAC}_{\\mathrm{dense}} = 10000 \\times 4456448 = 44564480000.\n$$\n\n事件驱动模式：每个事件会沿着所有传出的突触触发 MAC 操作。\n输入事件：有 $E_{0} = 2.0 \\times 10^{6}$ 个输入事件，每个事件扇出到 $N_{1}$ 个突触，所以\n$$\n\\mathrm{MAC}_{0 \\to 1} = E_{0} N_{1} = (2.0 \\times 10^{6}) \\times 1024 = 2048000000.\n$$\n隐藏层事件：隐藏层使用异步增量编码。其总变差为 $V_{1} = 1.024 \\times 10^{9}$，并且由于 ReLU 是 $1$-Lipschitz 的，隐藏层容限为 $\\varepsilon_{1} = 128$，我们设置\n$$\n\\tau_{1} = \\frac{\\varepsilon_{1}}{L} = \\frac{128}{1} = 128.\n$$\n在这种编码下，隐藏事件的数量为\n$$\nE_{1} = \\frac{V_{1}}{\\tau_{1}} = \\frac{1.024 \\times 10^{9}}{128} = 8.0 \\times 10^{6}.\n$$\n每个隐藏层事件扇出到 $N_{2}$ 个突触，因此\n$$\n\\mathrm{MAC}_{1 \\to 2} = E_{1} N_{2} = (8.0 \\times 10^{6}) \\times 256 = 2048000000.\n$$\n事件驱动模式下的 MAC 总数为\n$$\n\\mathrm{MAC}_{\\mathrm{event}} = \\mathrm{MAC}_{0 \\to 1} + \\mathrm{MAC}_{1 \\to 2} = 2048000000 + 2048000000 = 4096000000.\n$$\n\n相对于密集更新所节省的操作数为\n$$\nS = \\mathrm{MAC}_{\\mathrm{dense}} - \\mathrm{MAC}_{\\mathrm{event}} = 44564480000 - 4096000000 = 40468480000.\n$$\n因此，事件传播的充分条件是 $|a_{j}^{(\\ell)}(t) - \\hat{a}_{j}^{(\\ell)}| \\ge \\tau_{\\ell}$ 且 $\\tau_{\\ell} = \\varepsilon_{\\ell} / L$，并且在给定参数下节省的 MAC 操作的确切数量为 $40468480000$。",
            "answer": "$$\\boxed{40468480000}$$"
        },
        {
            "introduction": "在理解了事件驱动处理的效率优势后，我们需深入探究事件本身所携带信息的质量和保真度。本练习构建了一个理想化的整合发放（Integrate-and-Fire）神经元模型，用以将连续的正弦信号编码为离散的脉冲时间序列。它挑战我们从脉冲间隔中解码出原始信号的参数，并进一步分析时间抖动（timing jitter）这种噪声源如何影响编码信息的准确性，从而深刻揭示时间编码的基本原理及其在现实世界中的局限性。",
            "id": "4043563",
            "problem": "考虑一个在事件驱动处理范式下，由正弦信号驱动的理想化积分-发放 (IF) 时间编码机。内部膜状态 $v(t)$ 根据常微分方程 $dv/dt = b + x(t)$ 演化，在每个脉冲时间 $t_k$，$v(t)$ 达到固定阈值 $\\theta$ 时，会瞬时重置为 $v(t^{+}) = 0$。假设输入为 $x(t) = A \\sin(\\omega t)$，其中振幅 $A$ 和角频率 $\\omega$ 未知。偏置 $b$ 和阈值 $\\theta$ 是已知常数，满足 $b  A  0$，这确保了斜率 $dv/dt  0$ 恒为正。脉冲时间 $\\{t_k\\}_{k \\in \\mathbb{Z}}$ 满足电荷守恒（积分）条件\n$$\n\\int_{t_k}^{t_{k+1}} \\left(b + A \\sin(\\omega t)\\right)\\, dt = \\theta \\quad \\text{for all } k.\n$$\n定义脉冲间间隔 $\\Delta t_k \\equiv t_{k+1} - t_k$ 和中点时间 $m_k \\equiv \\frac{t_k + t_{k+1}}{2}$。在小信号机制 $A/b \\ll 1$ 下进行分析，此时关于 $A/b$ 和 $\\omega \\Delta t_k$ 的幂次渐近展开是有效的，并假设脉冲发放足够密集，以至于对所有 $k$ 都有 $\\omega \\Delta t_k \\ll 1$。\n\n任务：\n- 从积分条件出发，仅使用微积分和三角恒等式，推导出 $\\Delta t_k$ 与参数 $A$ 和 $\\omega$ 之间的显式关系，精确到 $A/b$ 的首个非平凡阶。利用此关系，将中点时间 $m_k$ 处的瞬时速率 $r_k \\equiv 1/\\Delta t_k$ 表示到 $A/b$ 的首个非平凡阶，并由此仅基于长观测窗口内的序列 $\\{(\\Delta t_k, m_k)\\}$，给出一致估计量 $\\widehat{A}$ 和 $\\widehat{\\omega}$。你可以假设遍历性成立，并且在 $A/b$ 的一阶近似下，中点时间 $m_k$ 近似均匀地在时间上采样一个正弦波周期。\n- 现在假设每个脉冲时间都受到独立的、均值为零、标准差为 $\\sigma_t$ 的高斯时间抖动干扰，因此测量到的脉冲时间为 $t_k^{\\mathrm{m}} = t_k + \\varepsilon_k$，其中 $\\varepsilon_k \\sim \\mathcal{N}(0, \\sigma_t^2)$ 且在不同 $k$ 之间独立。那么，测量到的脉冲间间隔为 $\\Delta t_k^{\\mathrm{m}} = \\Delta t_k + \\eta_k$，其中 $\\eta_k \\equiv \\varepsilon_{k+1} - \\varepsilon_k$。考虑在中点处的基于事件的瞬时重构\n$$\n\\widehat{x}(m_k) \\equiv \\frac{\\theta}{\\Delta t_k^{\\mathrm{m}}} - b.\n$$\n计算在一个信号周期 $T \\equiv \\frac{2\\pi}{\\omega}$ 内，$\\widehat{x}(m_k)$ 相对于 $x(m_k)$ 的时间平均均方重构误差，同时精确到 $\\sigma_t$ 和 $A/b$ 的首个非平凡阶。也就是说，为下式推导一个闭式解析表达式：\n$$\n\\mathrm{MSE} \\equiv \\frac{\\omega}{2\\pi} \\int_{t_0}^{t_0 + \\frac{2\\pi}{\\omega}} \\mathbb{E}\\!\\left[\\left(\\widehat{x}(t) - x(t)\\right)^2\\right] dt,\n$$\n保留由时间抖动引起的主阶贡献。将你的最终答案表示为关于 $A, \\omega, \\theta, b$ 和 $\\sigma_t$ 的单个符号表达式。不要包含任何数值近似或四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "**第一部分：理想信号编码与参数估计**\n\n我们从积分-发放（IF）动态的积分形式开始：\n$$\n\\int_{t_k}^{t_{k+1}} \\left(b + A \\sin(\\omega t)\\right)\\, dt = \\theta\n$$\n对上式进行积分：\n$$\n\\left[ bt - \\frac{A}{\\omega} \\cos(\\omega t) \\right]_{t_k}^{t_{k+1}} = \\theta\n$$\n$$\nb(t_{k+1} - t_k) - \\frac{A}{\\omega} (\\cos(\\omega t_{k+1}) - \\cos(\\omega t_k)) = \\theta\n$$\n利用三角恒等式 $\\cos(Y) - \\cos(X) = -2\\sin(\\frac{X+Y}{2})\\sin(\\frac{Y-X}{2})$，并将 $\\Delta t_k = t_{k+1} - t_k$ 和 $m_k = (t_k + t_{k+1})/2$ 代入，我们得到：\n$$\n\\cos(\\omega t_{k+1}) - \\cos(\\omega t_k) = -2\\sin(\\omega m_k)\\sin\\left(\\frac{\\omega \\Delta t_k}{2}\\right)\n$$\n将此代入积分方程，得到精确关系：\n$$\nb\\Delta t_k + \\frac{2A}{\\omega} \\sin(\\omega m_k)\\sin\\left(\\frac{\\omega \\Delta t_k}{2}\\right) = \\theta\n$$\n根据密集脉冲发放的假设，$\\omega \\Delta t_k \\ll 1$，我们可以使用小角度近似 $\\sin(z) \\approx z$。应用此近似：\n$$\nb\\Delta t_k + \\frac{2A}{\\omega} \\sin(\\omega m_k)\\left(\\frac{\\omega \\Delta t_k}{2}\\right) \\approx \\theta\n$$\n$$\n\\Delta t_k \\left(b + A \\sin(\\omega m_k)\\right) \\approx \\theta\n$$\n求解 $\\Delta t_k$ 可得：\n$$\n\\Delta t_k \\approx \\frac{\\theta}{b + A \\sin(\\omega m_k)}\n$$\n现在，我们利用小信号假设 $A/b \\ll 1$ 对上式进行泰勒展开。\n$$\n\\Delta t_k \\approx \\frac{\\theta}{b(1 + (A/b)\\sin(\\omega m_k))} = \\frac{\\theta}{b} \\left(1 + \\frac{A}{b}\\sin(\\omega m_k)\\right)^{-1}\n$$\n使用一阶近似 $(1+x)^{-1} \\approx 1 - x$：\n$$\n\\Delta t_k \\approx \\frac{\\theta}{b} \\left(1 - \\frac{A}{b}\\sin(\\omega m_k)\\right)\n$$\n瞬时发放速率 $r_k \\equiv 1/\\Delta t_k$ 为：\n$$\nr_k = \\frac{1}{\\Delta t_k} \\approx \\left[\\frac{\\theta}{b}\\left(1 - \\frac{A}{b}\\sin(\\omega m_k)\\right)\\right]^{-1} = \\frac{b}{\\theta}\\left(1 - \\frac{A}{b}\\sin(\\omega m_k)\\right)^{-1}\n$$\n再次使用一阶近似 $(1-x)^{-1} \\approx 1+x$：\n$$\nr_k \\approx \\frac{b}{\\theta}\\left(1 + \\frac{A}{b}\\sin(\\omega m_k)\\right) = \\frac{b}{\\theta} + \\frac{A}{\\theta}\\sin(\\omega m_k)\n$$\n此方程表明，瞬时发放速率 $r_k$ 是中点时间 $m_k$ 的正弦函数。基于此关系，我们可以从观测到的脉冲序列 $\\{(\\Delta t_k, m_k)\\}$ 中估计 $A$ 和 $\\omega$。\n- **$\\widehat{\\omega}$ 的估计**：$r_k(m_k)$ 的振荡角频率就是输入信号的角频率 $\\omega$。因此，可以通过寻找时间序列 $\\{r_k\\}$ 的傅里叶变换或周期图中的主峰频率来估计 $\\widehat{\\omega}$。\n- **$\\widehat{A}$ 的估计**：$r_k$ 的正弦调制振幅为 $r_{\\text{amp}} = A/\\theta$。该振幅可以从数据中估计为 $(\\max(r_k) - \\min(r_k))/2$。由于 $\\theta$ 已知，因此 $A$ 的一个估计量是 $\\widehat{A} = \\theta \\cdot r_{\\text{amp}}$。\n\n**第二部分：含时间抖动的均方重构误差**\n\n现在我们分析存在时间抖动时的重构误差。重构信号由 $\\widehat{x}(m_k) = \\frac{\\theta}{\\Delta t_k^{\\mathrm{m}}} - b$ 给出，其中 $\\Delta t_k^{\\mathrm{m}} = \\Delta t_k + \\eta_k$。第 $k$ 个事件的重构误差为：\n$$\ne_k = \\widehat{x}(m_k) - x(m_k) = \\left(\\frac{\\theta}{\\Delta t_k + \\eta_k} - b\\right) - A\\sin(\\omega m_k)\n$$\n从第一部分我们知道 $\\Delta t_k \\approx \\frac{\\theta}{b + A\\sin(\\omega m_k)} = \\frac{\\theta}{b+x(m_k)}$。代入上式：\n$$\ne_k \\approx \\frac{\\theta}{\\frac{\\theta}{b+x(m_k)} + \\eta_k} - b - x(m_k) = \\frac{\\theta(b+x(m_k))}{\\theta + \\eta_k(b+x(m_k))} - (b+x(m_k))\n$$\n$$\ne_k \\approx (b+x(m_k))\\left[\\frac{\\theta}{\\theta + \\eta_k(b+x(m_k))} - 1\\right] = (b+x(m_k))\\left[\\frac{-\\eta_k(b+x(m_k))}{\\theta + \\eta_k(b+x(m_k))}\\right]\n$$\n假设噪声 $\\eta_k$ 很小，我们可以将上式展开到 $\\eta_k$ 的一阶：\n$$\ne_k \\approx -\\frac{\\eta_k(b+x(m_k))^2}{\\theta}\n$$\n均方误差需要计算 $\\mathbb{E}[e_k^2]$。在噪声的主阶上，我们有：\n$$\n\\mathbb{E}[e_k^2] \\approx \\mathbb{E}\\left[\\left(-\\frac{(b+x(m_k))^2}{\\theta}\\eta_k\\right)^2\\right] = \\frac{(b+x(m_k))^4}{\\theta^2}\\mathbb{E}[\\eta_k^2]\n$$\n噪声项 $\\eta_k = \\varepsilon_{k+1} - \\varepsilon_k$ 的方差为：\n$$\n\\mathbb{E}[\\eta_k^2] = \\mathrm{Var}(\\eta_k) = \\mathrm{Var}(\\varepsilon_{k+1} - \\varepsilon_k) = \\mathrm{Var}(\\varepsilon_{k+1}) + \\mathrm{Var}(\\varepsilon_k) = \\sigma_t^2 + \\sigma_t^2 = 2\\sigma_t^2\n$$\n代入上式：\n$$\n\\mathbb{E}[e_k^2] \\approx \\frac{2\\sigma_t^2}{\\theta^2}(b+x(m_k))^4\n$$\n为了找到时间平均 MSE，我们将此量在一个信号周期 $T = 2\\pi/\\omega$ 上进行平均：\n$$\n\\mathrm{MSE} = \\left\\langle \\mathbb{E}[e_k^2] \\right\\rangle_t = \\frac{1}{T}\\int_0^T \\frac{2\\sigma_t^2}{\\theta^2}(b+A\\sin(\\omega t))^4 dt\n$$\n令 $\\phi = \\omega t$：\n$$\n\\mathrm{MSE} = \\frac{2\\sigma_t^2}{\\theta^2} \\frac{1}{2\\pi}\\int_0^{2\\pi} (b+A\\sin\\phi)^4 d\\phi\n$$\n利用二项式定理展开四次项并对 $\\sin\\phi$ 的各次幂在一个周期内积分平均，我们有：\n$$\n\\frac{1}{2\\pi}\\int_0^{2\\pi} \\sin^n\\phi \\, d\\phi = \\begin{cases} 0  \\text{for } n=1, 3 \\\\ 1/2  \\text{for } n=2 \\\\ 3/8  \\text{for } n=4 \\end{cases}\n$$\n因此，被积函数的平均值为：\n$$\n\\left\\langle (b+A\\sin\\phi)^4 \\right\\rangle = b^4 + 6b^2A^2(\\frac{1}{2}) + A^4(\\frac{3}{8}) = b^4 + 3b^2A^2 + \\frac{3}{8}A^4\n$$\n最终得到时间平均均方误差：\n$$\n\\mathrm{MSE} = \\frac{2\\sigma_t^2}{\\theta^2}\\left(b^4 + 3b^2A^2 + \\frac{3}{8}A^4\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{2\\sigma_t^2}{\\theta^2}\\left(b^4 + 3b^2 A^2 + \\frac{3}{8}A^4\\right)}\n$$"
        }
    ]
}