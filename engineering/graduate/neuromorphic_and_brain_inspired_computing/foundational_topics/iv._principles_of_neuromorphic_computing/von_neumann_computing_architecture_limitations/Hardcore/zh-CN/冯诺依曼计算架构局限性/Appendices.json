{
    "hands_on_practices": [
        {
            "introduction": "理论上的加速比往往会遇到现实世界中的瓶颈，其中最著名的就是“内存墙”。这个练习将阿姆达尔定律（Amdahl's Law）与屋顶线模型（Roofline Model）相结合，旨在量化内存带宽对多核处理器性能的限制。通过这个练习，你将学会推导一个综合考虑了计算能力和内存数据供给能力的加速比模型，并能识别出在特定工作负载下，系统性能是由计算限制还是由带宽限制主导。",
            "id": "4067202",
            "problem": "在冯·诺依曼架构中，当可用内存带宽不足以满足算术单元的需求时，内存与计算单元之间的数据移动会限制性能，这种现象通常被称为冯·诺依曼瓶颈。考虑一个包含总共 $W$ 次浮点运算的工作负载。这些运算中的一部分（比例为 $\\alpha$）是内在串行的，必须在单个核心上执行，而剩余部分（比例为 $1-\\alpha$）是完全可并行的，可以在 $n$ 个相同的核心上执行。\n\n假设存在一个屋顶线式的性能上限，其中可达性能受限于峰值算术吞吐量和带宽限制吞吐量中的较小者。设 $n$ 核处理器的总峰值计算吞吐量为 $P_{\\text{peak}}$（以归一化操作速率为单位），内存子系统提供一个有效的持续乘积 $BW \\cdot I_{\\text{op}}$（以相同的归一化单位），其中 $BW$ 是持续内存带宽，$I_{\\text{op}}$ 是运算强度（操作/字节）。假设所有 $n$ 个核心共享相同的内存带宽。\n\n设单核峰值吞吐量为 $P_{\\text{core}} = P_{\\text{peak}}/n$。对于在单个核心上执行的任何部分，其可达性能为 $\\min\\!\\big(P_{\\text{core}},\\, BW \\cdot I_{\\text{op}}\\big)$；对于在 $n$ 个核心上执行的完全并行部分，其可达性能为 $\\min\\!\\big(n P_{\\text{core}},\\, BW \\cdot I_{\\text{op}}\\big) = \\min\\!\\big(P_{\\text{peak}},\\, BW \\cdot I_{\\text{op}}\\big)$。\n\n仅使用“执行时间等于工作量除以性能”这一基本关系，从第一性原理出发，推导在共享带宽约束下，在单个核心上执行整个工作负载的时间与在 $n$ 个核心上执行的时间之比所定义的加速比 $S$ 的表达式。然后，对于具体参数 $n=16$，$\\alpha=0.05$，$P_{\\text{peak}}=16$（归一化单位）和 $BW \\cdot I_{\\text{op}}=8$（相同单位），计算加速比的精确值。此外，在您的推理过程中，请指明并行部分的多核执行是受计算限制还是受带宽限制。给出最终的数值加速比的精确值（不进行四舍五入）。加速比是无单位的；只报告数值。",
            "solution": "该问题要求为一个多核处理器推导加速比公式，该处理器的性能同时受其算术吞吐量和内存带宽的限制，遵循屋顶线模型并结合阿姆达尔定律。随后，需要为一组特定参数计算该加速比。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 总工作量：$W$\n- 工作负载的串行部分比例：$\\alpha$\n- 工作负载的可并行部分比例：$1-\\alpha$\n- 核心数：$n$\n- 总峰值计算吞吐量：$P_{\\text{peak}}$\n- 内存带宽限制的吞吐量：$BW \\cdot I_{\\text{op}}$\n- 单核峰值吞吐量：$P_{\\text{core}} = P_{\\text{peak}}/n$\n- 单核性能：$\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})$\n- 并行部分在 $n$ 个核心上的性能：$\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})$\n- 加速比定义：$S = T_1 / T_n$\n- 执行时间定义：时间 = 工作量 / 性能\n- 具体参数：$n=16$，$\\alpha=0.05$，$P_{\\text{peak}}=16$，$BW \\cdot I_{\\text{op}}=8$。\n\n该问题基于已确立的计算机体系结构原理（阿姆达尔定律，屋顶线模型），具有科学依据，其提法恰当，信息充分且一致，陈述客观。因此，该问题被认为是有效的。\n\n我们继续推导加速比 $S$ 的表达式。加速比 $S$ 定义为单核执行时间 $T_1$ 与 $n$ 核执行时间 $T_n$ 之比。\n\n1.  **计算单核执行时间 $T_1$。**\n    当整个工作负载 $W$ 在单个核心上执行时，其可达性能（我们称之为 $P_1$）受限于单核峰值吞吐量和带宽限制吞吐量中的较小者。\n    $$P_1 = \\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})$$\n    执行时间 $T_1$ 是总工作量 $W$ 除以该性能：\n    $$T_1 = \\frac{W}{P_1} = \\frac{W}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})}$$\n\n2.  **计算 $n$ 核执行时间 $T_n$。**\n    在 $n$ 个核心上的执行包含两个部分：串行部分和并行部分。\n    -   工作的串行部分是 $\\alpha W$。它必须在单个核心上运行。这部分的性能与单核性能 $P_1$ 相同。串行部分的时间 $T_{n, \\text{serial}}$ 为：\n        $$T_{n, \\text{serial}} = \\frac{\\alpha W}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})}$$\n    -   工作的并行部分是 $(1-\\alpha)W$。它在所有 $n$ 个核心上运行。此并行执行的可达性能（我们称之为 $P_n$）受限于所有 $n$ 个核心的总峰值吞吐量和共享内存带宽吞吐量中的较小者。\n        $$P_n = \\min(n P_{\\text{core}}, BW \\cdot I_{\\text{op}}) = \\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})$$\n        并行部分的时间 $T_{n, \\text{parallel}}$ 为：\n        $$T_{n, \\text{parallel}} = \\frac{(1-\\alpha)W}{P_n} = \\frac{(1-\\alpha)W}{\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})}$$\n    在 $n$ 个核心上的总执行时间 $T_n$ 是串行部分和并行部分的时间之和：\n    $$T_n = T_{n, \\text{serial}} + T_{n, \\text{parallel}} = \\frac{\\alpha W}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})} + \\frac{(1-\\alpha)W}{\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})}$$\n\n3.  **推导加速比表达式 $S$。**\n    使用定义 $S = T_1 / T_n$，我们得到：\n    $$S = \\frac{\\frac{W}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})}}{\\frac{\\alpha W}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})} + \\frac{(1-\\alpha)W}{\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})}}$$\n    工作负载 $W$ 是一个公共因子，可以消去：\n    $$S = \\frac{\\frac{1}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})}}{\\frac{\\alpha}{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})} + \\frac{1-\\alpha}{\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})}}$$\n    为了化简这个繁分数，我们可以将分子和分母同乘以 $\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})$：\n    $$S = \\frac{1}{\\alpha + (1-\\alpha) \\frac{\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}})}{\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}})}}$$\n    这是给定模型下加速比的通用表达式。它是阿姆达尔定律的一种形式，其中并行加速因子由屋顶线约束决定。\n\n4.  **计算加速比的数值。**\n    给定参数为：$n=16$，$\\alpha=0.05$，$P_{\\text{peak}}=16$ 和 $BW \\cdot I_{\\text{op}}=8$。\n    首先，我们确定单核峰值吞吐量 $P_{\\text{core}}$：\n    $$P_{\\text{core}} = \\frac{P_{\\text{peak}}}{n} = \\frac{16}{16} = 1$$\n    接下来，我们评估串行和并行执行部分的性能。\n    -   串行部分（以及单核执行）的性能：\n        $$\\min(P_{\\text{core}}, BW \\cdot I_{\\text{op}}) = \\min(1, 8) = 1$$\n    -   并行部分的性能：\n        $$\\min(P_{\\text{peak}}, BW \\cdot I_{\\text{op}}) = \\min(16, 8) = 8$$\n    在这里，我们指明了并行部分的性能瓶颈。由于可达性能为 $8$，该值等于 $BW \\cdot I_{\\text{op}}$ 且小于 $P_{\\text{peak}} = 16$，因此并行部分的多核执行受内存带宽限制。\n\n    现在，我们将这些性能值和 $\\alpha$ 代入推导出的加速比公式中：\n    $$S = \\frac{1}{\\alpha + (1-\\alpha) \\frac{1}{8}}$$\n    代入 $\\alpha = 0.05$：\n    $$S = \\frac{1}{0.05 + (1 - 0.05) \\frac{1}{8}} = \\frac{1}{0.05 + (0.95) \\frac{1}{8}}$$\n    为了计算精确值，我们使用分数：$0.05 = \\frac{5}{100} = \\frac{1}{20}$ 以及 $0.95 = \\frac{95}{100} = \\frac{19}{20}$。\n    $$S = \\frac{1}{\\frac{1}{20} + \\frac{19}{20} \\cdot \\frac{1}{8}} = \\frac{1}{\\frac{1}{20} + \\frac{19}{160}}$$\n    我们为分母中的各项找到公分母，即 $160$。\n    $$S = \\frac{1}{\\frac{8}{160} + \\frac{19}{160}} = \\frac{1}{\\frac{8+19}{160}} = \\frac{1}{\\frac{27}{160}}$$\n    因此，加速比为：\n    $$S = \\frac{160}{27}$$",
            "answer": "$$\\boxed{\\frac{160}{27}}$$"
        },
        {
            "introduction": "随着晶体管数量的持续增加，我们面临的不再是“我们能构建多少核心”，而是“我们能同时为多少核心供电”的问题，这引出了“功率墙”和“暗硅”的概念。本练习通过建立一个功耗模型来探讨在给定的热设计功耗（TDP）预算下，芯片上能够同时激活的核心比例。这个练习将进一步揭示内存瓶颈如何加剧功耗问题：即使处理器因等待数据而停顿，泄漏功耗和内存子系统功耗依然存在，从而极大地降低了系统的能源效率。",
            "id": "4067232",
            "problem": "考虑一个通用中央处理器（CPU），它实现了冯·诺依曼架构，在单个硅片上集成了 $M$ 个相同的核心。该封装受限于 $P_{\\text{max}}$ 的热设计功耗（TDP）预算。在给定工作负载下，每个通电并计时的核心（即活动核心）平均消耗的单核功率为 $P_{\\text{core}}$。假设非活动核心被完全功率门控，消耗的功率可以忽略不计。仅使用功率的定义 $P = \\mathrm{d}E/\\mathrm{d}t$ 和资源约束，推导出一个封闭形式的表达式，表示在不超过 $P_{\\text{max}}$ 的情况下，芯片上可同时活动的核心的最大比例 $f^{\\star}$。将您的最终答案表示为一个无量纲的解析表达式，用 $P_{\\text{max}}$、$P_{\\text{core}}$ 和 $M$ 表示。\n\n为了分析冯·诺依曼内存瓶颈的作用，将单核功率模型细化如下。设每个核心的平均功率分解为泄漏分量 $P_{\\text{leak}}$ 和动态分量 $P_{\\text{dyn}}$，动态分量根据利用率 $u \\in [0,1]$ 进行缩放，即 $P_{\\text{core}} = P_{\\text{leak}} + u P_{\\text{dyn}}$，其中动态分量遵循互补金属氧化物半导体（CMOS）的开关功率 $P_{\\text{dyn}} \\propto C V^{2} f_{\\text{clk}}$，其中 $C$ 是有效电容，$V$ 是电源电压，$f_{\\text{clk}}$ 是时钟频率。假设由末级缓存、片上互连和片外动态随机存取存储器（DRAM）接口组成的内存子系统，为每个活动核心贡献一个额外的基线功率 $P_{\\text{mem}}$，该功率在核心停顿时不会消失。使用第一性原理和这个细化模型，解释内存受限型工作负载（由于频繁等待内存而导致的小 $u$）如何影响可实现的活动核心比例 $f^{\\star}$ 和能源效率，并给出 $f^{\\star}$ 的相应表达式，用 $P_{\\text{max}}$、$M$、$P_{\\text{leak}}$、$P_{\\text{dyn}}$、$u$ 和 $P_{\\text{mem}}$ 表示。不需要进行数值舍入。最终答案必须是 $f^{\\star}$ 的单个解析表达式。",
            "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- 相同核心的总数：$M$。\n- CPU封装热设计功耗（TDP）预算：$P_{\\text{max}}$。\n- 每个活动核心的平均功耗（简单模型）：$P_{\\text{core}}$。\n- 非活动核心功耗：可忽略。\n- 功率的定义：$P = \\mathrm{d}E/\\mathrm{d}t$。\n- 目标1：推导活动核心的最大比例 $f^{\\star}$，用 $P_{\\text{max}}$、$P_{\\text{core}}$ 和 $M$ 表示。\n- 细化的单核功率模型：$P_{\\text{core}} = P_{\\text{leak}} + u P_{\\text{dyn}}$。\n- 核心利用率：$u \\in [0,1]$。\n- 动态功率关系：$P_{\\text{dyn}} \\propto C V^{2} f_{\\text{clk}}$。\n- 每个活动核心来自内存子系统的额外功率：$P_{\\text{mem}}$。\n- 工作负载类型：内存受限型，特点是 $u$ 值小。\n- 目标2：解释 a) 小 $u$ 对 $f^{\\star}$ 和能源效率的影响，以及 b) 给出 $f^{\\star}$ 的相应表达式，用 $P_{\\text{max}}$、$M$、$P_{\\text{leak}}$、$P_{\\text{dyn}}$、$u$ 和 $P_{\\text{mem}}$ 表示。\n- 指定最终答案为来自细化模型的 $f^{\\star}$ 的单个解析表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于计算机体系结构和CMOS电子学的原理。TDP、功率门控、静态（泄漏）和动态功率，以及内存停顿（冯·诺依曼瓶颈）对利用率的影响等概念都是标准且定义明确的。问题提取得当，有足够的信息来推导所要求的表达式。语言客观且正式。该问题是一个有效的、可形式化的物理和工程问题。它不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题有效。将构建一个解决方案。\n\n**推导与分析**\n\n分析分两个阶段进行，对应于问题中提出的两个模型。核心原则是所有活动组件耗散的总功率不能超过热设计功耗预算 $P_{\\text{max}}$。\n\n首先，我们考虑简化模型。设 $N$ 为同时活动的核数。由于每个活动核心耗散的功率为 $P_{\\text{core}}$，而非活动核心的功耗可忽略不计，因此CPU耗散的总功率为 $P_{\\text{total}} = N P_{\\text{core}}$。基本约束是 $P_{\\text{total}} \\le P_{\\text{max}}$，即 $N P_{\\text{core}} \\le P_{\\text{max}}$。因此，可以活动的最大核心数受功率预算限制为 $N \\le P_{\\text{max}} / P_{\\text{core}}$。活动核心的数量也受到核心总数 $M$ 的物理限制。因此，最大活动核心数 $N^{\\star}$ 是这两个约束中的最小值。为了建模目的，将 $N$ 视为一个连续变量，我们有 $N^{\\star} = \\min(P_{\\text{max}} / P_{\\text{core}}, M)$。活动核心的最大比例 $f^{\\star}$ 是这个数字除以核心总数 $M$：\n$$f^{\\star} = \\frac{N^{\\star}}{M} = \\frac{1}{M} \\min\\left(\\frac{P_{\\text{max}}}{P_{\\text{core}}}, M\\right) = \\min\\left(\\frac{P_{\\text{max}}}{M P_{\\text{core}}}, 1\\right)$$\n\n接下来，我们转向细化模型，该模型提供了更详细的功耗描述，明确考虑了冯·诺依曼内存瓶颈的影响。在这个模型中，单个活动核心的功率分解为其内部组件 $P_{\\text{core}} = P_{\\text{leak}} + u P_{\\text{dyn}}$，并增加了其所占内存子系统份额耗散的功率 $P_{\\text{mem}}$。每个活动核心耗散的总功率，我们记为 $P_{\\text{active}}$，是这些贡献的总和：\n$$P_{\\text{active}} = (P_{\\text{leak}} + u P_{\\text{dyn}}) + P_{\\text{mem}}$$\n在这里，$P_{\\text{leak}}$ 是静态泄漏功率，只要核心通电，无论其活动与否，都会耗散。项 $u P_{\\text{dyn}}$ 代表动态功率，它与计算活动或利用率 $u$ 成正比。项 $P_{\\text{mem}}$ 代表与内存层次结构（缓存、互连）相关的功率，当核心处于活动状态时，即使在停顿期间，该功率也处于活动状态。\n\n对于 $N$ 个活动核心，现在的总功耗为 $P_{\\text{total}} = N P_{\\text{active}} = N(P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}})$。\n应用TDP约束，$P_{\\text{total}} \\le P_{\\text{max}}$：\n$$N (P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}) \\le P_{\\text{max}}$$\n求解受功率限制的最大核心数，得到 $N \\le \\frac{P_{\\text{max}}}{P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}}$。\n再次，将其与 $M$ 个核心的物理限制相结合，同时活动的最大核心数为：\n$$N^{\\star} = \\min\\left(\\frac{P_{\\text{max}}}{P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}}, M\\right)$$\n相应的活动核心最大比例 $f^{\\star}$ 是 $N^{\\star}/M$：\n$$f^{\\star} = \\frac{1}{M} \\min\\left(\\frac{P_{\\text{max}}}{P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}}, M\\right) = \\min\\left(\\frac{P_{\\text{max}}}{M (P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}})}, 1\\right)$$\n这就是所要求的表达式。\n\n现在，我们分析内存受限型工作负载的影响，其特点是由于处理器在等待内存数据时频繁停顿而导致利用率因子 $u$ 很小。\n\n1.  **对可实现比例 $f^{\\star}$ 的影响**：\n    我们检查 $f^{\\star}$ 的表达式。每个活动核心的功率是 $P_{\\text{active}} = P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}$。在内存受限的情况下，$u$ 很小。假设 $P_{\\text{dyn}} > 0$，随着 $u$ 减小，$P_{\\text{active}}$ 也减小。每个核心较低的功耗意味着，对于固定的总功率预算 $P_{\\text{max}}$，可以同时为更多的核心供电。在数学上，随着 $u$ 的减小，分数 $\\frac{P_{\\text{max}}}{M (P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}})}$ 的分母减小。这导致该分数的值增加，因此 $f^{\\star}$ 增加。实质上，由停顿的核心（不消耗动态功率）释放出的功率预算可以用来激活其他核心。这允许更高程度的并行性，尽管每个核心的进展缓慢。\n\n2.  **对能源效率的影响**：\n    能源效率可以定义为每单位消耗能量所完成的计算工作。核心完成的工作与其利用率直接相关，因此我们可以认为吞吐量与 $u$ 成正比。消耗的功率是 $P_{\\text{active}}$。因此，能源效率 $\\eta$ 可以表示为：\n    $$\\eta \\propto \\frac{\\text{吞吐量}}{\\text{功率}} = \\frac{u}{P_{\\text{active}}} = \\frac{u}{P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}}}$$\n    对于内存受限型工作负载，我们分析 $u \\to 0$ 时的极限。分子趋近于 $0$。分母趋近于一个非零正常数 $P_{\\text{leak}} + P_{\\text{mem}}$，这代表核心空闲但通电时浪费的功率。因此：\n    $$\\lim_{u \\to 0} \\eta \\propto \\lim_{u \\to 0} \\frac{u}{P_{\\text{leak}} + P_{\\text{mem}}} = 0$$\n    能源效率崩溃至零。这是冯·诺依曼瓶颈的一个严重后果：在没有执行任何有用计算的情况下，消耗了大量能量（$P_{\\text{leak}} + P_{\\text{mem}}$）。处理器在等待数据时处于非生产状态，却在消耗功率。尽管可以开启更多的核心（$f^{\\star}$ 增加），但整个系统的效率极差。这凸显了现代计算架构中数据移动的根本挑战。\n\n最终的 $f^{\\star}$ 表达式概括了这些权衡，将系统级功率预算与每个核心的详细功率特性（包括其依赖于工作负载的利用率）联系起来。",
            "answer": "$$\\boxed{\\min\\left(\\frac{P_{\\text{max}}}{M (P_{\\text{leak}} + u P_{\\text{dyn}} + P_{\\text{mem}})}, 1\\right)}$$"
        },
        {
            "introduction": "在并行计算中，为了保证数据一致性，原子操作是不可或缺的工具，但它本身也可能成为性能的瓶颈，这就是所谓的“并行墙”或同步开销。本练习通过一个概率模型来分析在高争用情况下，对共享内存位置的原子操作如何导致系统吞吐量的崩溃。你将推导出一个描述吞吐量如何随请求速率变化的解析表达式，从而深刻理解为何在冯·诺依曼架构下，单纯增加并行任务数量有时反而会降低系统整体性能。",
            "id": "4067177",
            "problem": "一个实现 von Neumann 计算架构的共享内存多核系统，对单个竞争的内存字执行原子读-改-写操作，例如比较并交换（CAS）。在基于目录的缓存一致性协议下，CAS 操作在执行读-改-写之前需要获得缓存行的独占所有权，而内存控制器负责串行化独占所有权的授予。考虑 $N$ 个相同的核心，每个核心都尝试对同一个内存字执行 CAS 操作，其尝试间隔时间独立且服从指数分布。假设聚合的尝试过程可以建模为速率为 $\\lambda$（次尝试/秒）的泊松过程。内存控制器在持续时间为 $\\tau$（秒）的离散仲裁窗口中运行，在此期间它可以授予独占所有权。假设存在以下竞争动态：\n\n- 当且仅当一个仲裁窗口内恰好有一次尝试到达时，CAS 操作才能成功完成；此时控制器授予独占所有权，读-改-写操作发生，缓存行的值改变。\n- 如果一个窗口内没有尝试到达，则没有 CAS 操作完成。\n- 如果一个窗口内有两次或更多次尝试到达，仲裁开销和一致性失效将消耗整个窗口，而没有任何 CAS 操作完成，所有竞争者都会回退并稍后重试。\n\n从泊松过程的基本定义和上述内存一致性串行化描述出发，推导稳态吞吐量 $T(\\lambda)$ 的解析表达式。该吞吐量定义为已完成的 CAS 操作（成功的原子更新）的平均速率（单位：操作/秒），并且是尝试操作速率 $\\lambda$ 和仲裁窗口持续时间 $\\tau$ 的函数。请将您的最终答案表示为单个闭式数学表达式。无需四舍五入。在您的推导和表达式中，使用“操作/秒”作为吞吐量的单位。",
            "solution": "问题要求解稳态吞吐量 $T(\\lambda, \\tau)$，其定义为已完成的比较并交换（CAS）操作的平均速率，是聚合尝试速率 $\\lambda$ 和仲裁窗口持续时间 $\\tau$ 的函数。\n\n问题指出，聚合尝试过程是一个速率恒为 $\\lambda$（次尝试/秒）的泊松过程。我们关心的是在持续时间为 $\\tau$ 的单个离散仲裁窗口内到达的尝试次数。\n\n设随机变量 $K$ 表示在持续时间为 $\\tau$ 的单个仲裁窗口内到达的 CAS 尝试次数。根据泊松过程的性质，在固定时间间隔内发生的事件数量服从泊松分布。该分布的均值（记为 $\\mu$）是速率 $\\lambda$ 和时间间隔 $\\tau$ 的乘积。\n$$ \\mu = \\lambda \\tau $$\n泊松分布的概率质量函数（PMF）给出了在该时间间隔内观测到恰好 $k$ 个事件的概率：\n$$ P(K=k) = \\frac{\\mu^k \\exp(-\\mu)}{k!} $$\n代入 $\\mu = \\lambda\\tau$，在持续时间为 $\\tau$ 的窗口内到达 $k$ 次尝试的概率为：\n$$ P(K=k) = \\frac{(\\lambda\\tau)^k \\exp(-\\lambda\\tau)}{k!} \\quad \\text{for } k=0, 1, 2, \\dots $$\n\n问题定义了 CAS 成功完成的条件。当且仅当一个仲裁窗口内恰好有一次尝试到达时，CAS 操作才能成功完成。这对应于事件 $K=1$。因此，在任何单个窗口内成功完成的概率（我们记为 $P_{\\text{success}}$）就是 $P(K=1)$。\n\n我们可以通过在概率质量函数中令 $k=1$ 来计算这个概率：\n$$ P_{\\text{success}} = P(K=1) = \\frac{(\\lambda\\tau)^1 \\exp(-\\lambda\\tau)}{1!} = \\lambda\\tau \\exp(-\\lambda\\tau) $$\n如果 $K=0$ 或 $K \\ge 2$，则没有 CAS 操作完成。因此，在持续时间为 $\\tau$ 的单个窗口内成功操作的期望数量是：\n$$ E[\\text{successes per window}] = 1 \\times P(K=1) + 0 \\times P(K \\neq 1) = P(K=1) $$\n\n吞吐量 $T(\\lambda, \\tau)$ 定义为已完成操作的平均速率，即单位时间内的预期成功操作次数。由于每个窗口的持续时间为 $\\tau$ 秒，所以每秒的窗口数量为 $1/\\tau$。吞吐量是每个窗口的预期成功次数与每秒窗口数量的乘积。\n$$ T(\\lambda, \\tau) = \\frac{E[\\text{successes per window}]}{\\text{duration of window}} $$\n$$ T(\\lambda, \\tau) = \\frac{P_{\\text{success}}}{\\tau} $$\n代入 $P_{\\text{success}}$ 的表达式：\n$$ T(\\lambda, \\tau) = \\frac{\\lambda\\tau \\exp(-\\lambda\\tau)}{\\tau} $$\n分子和分母中的项 $\\tau$相互抵消，得到吞吐量的最终表达式：\n$$ T(\\lambda, \\tau) = \\lambda \\exp(-\\lambda\\tau) $$\n该表达式表示了稳态吞吐量（单位：成功操作/秒），其是尝试操作速率 $\\lambda$ 和仲裁窗口持续时间 $\\tau$ 的函数。它正确地捕捉了竞争的动态：当尝试速率很低时（$\\lambda \\to 0$），吞吐量接近尝试速率（$T \\approx \\lambda$）；而当尝试速率非常高时（$\\lambda \\to \\infty$），碰撞占主导地位，吞吐量骤降至零（$T \\to 0$）。",
            "answer": "$$\\boxed{\\lambda \\exp(-\\lambda\\tau)}$$"
        }
    ]
}