{
    "hands_on_practices": [
        {
            "introduction": "A core challenge in digital neuromorphic design is the representation of continuous biological variables, like membrane potential, using discrete, finite-precision numbers. This exercise provides hands-on practice in navigating the trade-off between numerical precision and hardware cost, a fundamental aspect of the digital philosophy. By calculating the minimum bit width required to implement a Leaky Integrate-and-Fire neuron, you will learn to manage the risk of numerical overflow while considering the statistical nature of neural inputs .",
            "id": "4035172",
            "problem": "Consider a discrete-time implementation of a Leaky Integrate-and-Fire (LIF) neuron in a digital fixed-point processor using two's complement arithmetic, with the membrane potential update given by the forward Euler step\n$$\nV_{n+1} \\;=\\; V_n \\;+\\; \\Delta t \\left( -\\frac{g_L}{C}\\big(V_n - E_L\\big) + \\frac{I_n}{C} \\right),\n$$\nwhere $V_n$ is the membrane potential at time step $n$, $\\Delta t$ is the simulation time step, $g_L$ is the leak conductance, $C$ is the membrane capacitance, $E_L$ is the leak reversal potential, and $I_n$ is the input current at time step $n$. A spike is emitted and the potential is reset to $V_r$ whenever $V_n \\geq V_{\\text{th}}$.\n\nAssume the following scientifically realistic parameters:\n- $C = 200 \\times 10^{-12}$ farad,\n- $g_L = 10 \\times 10^{-9}$ siemens,\n- $E_L = -65 \\times 10^{-3}$ volt,\n- $V_{\\text{th}} = -50 \\times 10^{-3}$ volt,\n- $V_r = -65 \\times 10^{-3}$ volt,\n- $\\Delta t = 1 \\times 10^{-4}$ second.\n\nThe input current $I_n$ is independently and identically distributed across time steps as a Gaussian random variable (Normal distribution) with mean $\\mu_I = 50 \\times 10^{-12}$ ampere and standard deviation $\\sigma_I = 150 \\times 10^{-12}$ ampere. The system is designed to operate at a maximum firing rate $f_{\\max} = 200$ hertz, and is required to avoid overflow in representing $V_n$ with probability at least $1 - \\varepsilon$ over any inter-spike interval at $f_{\\max}$, where $\\varepsilon = 10^{-6}$.\n\nDesign the fixed-point format such that the least significant bit (LSB) corresponds to a voltage resolution of $0.1 \\times 10^{-3}$ volt. Using a conservative bound derived from the membrane dynamics and input statistics, compute the minimum total bit width $b$ (including the sign bit) required for the two's complement representation of $V_n$ to avoid overflow under the stated requirement. If your calculation yields a non-integer for $b$, report the smallest integer that satisfies the no-overflow requirement.\n\nExpress your final answer as the integer number of bits, with no units. No rounding by significant figures is needed beyond taking the smallest integer that meets the requirement.",
            "solution": "The problem requires the determination of the minimum total bit width, $b$, for a two's complement fixed-point representation of a Leaky Integrate-and-Fire (LIF) neuron's membrane potential, $V_n$. The design must prevent overflow with a probability of at least $1 - \\varepsilon$ over any inter-spike interval, under specific operating conditions.\n\nFirst, the given parameters and equations are summarized:\nThe membrane potential update rule is given by the forward Euler method:\n$$V_{n+1} = V_n + \\Delta t \\left( -\\frac{g_L}{C}(V_n - E_L) + \\frac{I_n}{C} \\right)$$\nThis can be rewritten as:\n$$V_{n+1} = V_n \\left(1 - \\frac{\\Delta t g_L}{C}\\right) + \\frac{\\Delta t g_L}{C} E_L + \\frac{\\Delta t}{C} I_n$$\nLet $\\alpha = 1 - \\frac{\\Delta t g_L}{C}$. The equation becomes $V_{n+1} = \\alpha V_n + (1-\\alpha)E_L + \\frac{\\Delta t}{C} I_n$.\n\nThe given parameters are:\n- Membrane capacitance, $C = 200 \\times 10^{-12} \\text{ F}$\n- Leak conductance, $g_L = 10 \\times 10^{-9} \\text{ S}$\n- Leak reversal potential, $E_L = -65 \\times 10^{-3} \\text{ V}$\n- Firing threshold, $V_{\\text{th}} = -50 \\times 10^{-3} \\text{ V}$\n- Reset potential, $V_r = -65 \\times 10^{-3} \\text{ V}$\n- Time step, $\\Delta t = 1 \\times 10^{-4} \\text{ s}$\n- Input current mean, $\\mu_I = 50 \\times 10^{-12} \\text{ A}$\n- Input current standard deviation, $\\sigma_I = 150 \\times 10^{-12} \\text{ A}$\n- Maximum firing rate, $f_{\\max} = 200 \\text{ Hz}$\n- Overflow failure probability, $\\varepsilon = 10^{-6}$\n- Voltage resolution (LSB), $V_{\\text{res}} = 0.1 \\times 10^{-3} \\text{ V}$\n\nThe design requires finding the range $[V_{\\min}, V_{\\max}]$ that $V_n$ can occupy, and then determining the number of bits $b$ needed to represent this range. A $b$-bit two's complement number with resolution $V_{\\text{res}}$ can represent values in the range $[-2^{b-1} V_{\\text{res}}, (2^{b-1}-1) V_{\\text{res}}]$. The minimum bit width $b$ must satisfy $V_{\\max} \\le (2^{b-1}-1)V_{\\text{res}}$ and $V_{\\min} \\ge -2^{b-1}V_{\\text{res}}$.\n\nTo find a conservative bound for the voltage range, we first bound the stochastic input current $I_n$. The problem requires avoiding overflow with probability $1 - \\varepsilon$ over an inter-spike interval at $f_{\\max}$. The minimum inter-spike interval is $T = 1/f_{\\max} = 1/200 = 5 \\times 10^{-3} \\text{ s}$. The number of time steps in this interval is $N = T/\\Delta t = (5 \\times 10^{-3}) / (1 \\times 10^{-4}) = 50$.\n\nUsing the union bound (Boole's inequality), we can distribute the total failure probability $\\varepsilon$ over the $N$ steps of the interval. The probability of an overflow at any single step should be less than $p_{\\text{fail}} = \\varepsilon / N = 10^{-6} / 50 = 2 \\times 10^{-8}$.\nThe input current $I_n$ follows a Gaussian distribution $N(\\mu_I, \\sigma_I^2)$. An overflow is primarily caused by extreme values of $I_n$. We find the range $[I_{\\min}, I_{\\max}]$ that contains the current with probability $1 - p_{\\text{fail}}$. For a standard normal variable $Z \\sim N(0, 1)$, we need to find $k_I$ such that $P(|Z| > k_I) = p_{\\text{fail}}$. This implies $2(1 - \\Phi(k_I)) = p_{\\text{fail}}$, where $\\Phi$ is the standard normal CDF.\n$P(Z > k_I) = p_{\\text{fail}} / 2 = 1 \\times 10^{-8}$.\n$\\Phi(k_I) = 1 - 10^{-8} = 0.99999999$.\nThe inverse CDF gives $k_I = \\Phi^{-1}(0.99999999) \\approx 5.6120$.\nThe bounds for the current are:\n$I_{\\max} = \\mu_I + k_I \\sigma_I = 50 \\times 10^{-12} + 5.6120 \\times 150 \\times 10^{-12} = (50 + 841.8) \\times 10^{-12} = 891.8 \\times 10^{-12} \\text{ A}$.\n$I_{\\min} = \\mu_I - k_I \\sigma_I = 50 \\times 10^{-12} - 5.6120 \\times 150 \\times 10^{-12} = (50 - 841.8) \\times 10^{-12} = -791.8 \\times 10^{-12} \\text{ A}$.\n\nNow, we analyze the LIF dynamics with this bounded input current to find the extremal values of $V_n$.\nLet's compute the constants in the update equation:\n$\\alpha = 1 - \\frac{\\Delta t g_L}{C} = 1 - \\frac{(1 \\times 10^{-4})(10 \\times 10^{-9})}{200 \\times 10^{-12}} = 1 - \\frac{10^{-13}}{2 \\times 10^{-10}} = 1 - 0.005 = 0.995$.\n$\\frac{\\Delta t}{C} = \\frac{1 \\times 10^{-4}}{200 \\times 10^{-12}} = 5 \\times 10^5 \\text{ V/A}$.\nThe update equation can be written as $V_{n+1} = \\alpha V_n + B_n$, where $B_n = (1-\\alpha)E_L + \\frac{\\Delta t}{C}I_n$.\n$(1-\\alpha)E_L = 0.005 \\times (-65 \\times 10^{-3}) = -3.25 \\times 10^{-4} \\text{ V}$.\nThe range of $B_n$ is determined by the range of $I_n$:\n$B_{\\max} = -3.25 \\times 10^{-4} + (5 \\times 10^5) \\times (891.8 \\times 10^{-12}) = -3.25 \\times 10^{-4} + 4.459 \\times 10^{-4} = 1.209 \\times 10^{-4} \\text{ V}$.\n$B_{\\min} = -3.25 \\times 10^{-4} + (5 \\times 10^5) \\times (-791.8 \\times 10^{-12}) = -3.25 \\times 10^{-4} - 3.959 \\times 10^{-4} = -7.209 \\times 10^{-4} \\text{ V}$.\n\nTo find the maximum required voltage, $V_{\\max}$, we consider the situation just before a spike. The value to be stored, $V_{n+1}$, is calculated from $V_n$, where $V_n < V_{\\text{th}}$. The maximum value of $V_{n+1}$ occurs when $V_n$ is infinitesimally close to $V_{\\text{th}}$ and the input term $B_n$ is maximal ($B_{\\max}$).\n$V_{\\max} = \\lim_{V_n \\to V_{\\text{th}}^{-}} (\\alpha V_n + B_{\\max}) = \\alpha V_{\\text{th}} + B_{\\max}$.\n$V_{\\max} = 0.995 \\times (-50 \\times 10^{-3}) + 1.209 \\times 10^{-4} = -0.04975 + 0.0001209 = -0.0496291 \\text{ V}$.\n\nTo find the minimum required voltage, $V_{\\min}$, we must consider the most conservative case. An inter-spike interval can be arbitrarily long if the input current is consistently low. The minimum voltage the system can possibly reach is the steady-state voltage under the minimum possible input term, $B_{\\min}$. Let this steady-state minimum be $V_{\\text{ss,min}}$.\n$V_{\\text{ss,min}} = \\alpha V_{\\text{ss,min}} + B_{\\min} \\implies V_{\\text{ss,min}} = \\frac{B_{\\min}}{1-\\alpha}$.\n$V_{\\min} = V_{\\text{ss,min}} = \\frac{-7.209 \\times 10^{-4}}{0.005} = -0.14418 \\text{ V}$.\n\nThe required voltage range is therefore $[-0.14418 \\text{ V}, -0.0496291 \\text{ V}]$.\nWe must choose $b$ such that this range can be represented. The two's complement range is $[-2^{b-1} V_{\\text{res}}, (2^{b-1}-1) V_{\\text{res}}]$.\n$V_{\\text{res}} = 0.1 \\times 10^{-3} \\text{ V}$.\nThe upper bound must satisfy:\n$-0.0496291 \\le (2^{b-1}-1) \\times (0.1 \\times 10^{-3})$.\n$-496.291 \\le 2^{b-1}-1$. This inequality holds for any practical $b \\ge 1$.\nThe lower bound must satisfy:\n$-0.14418 \\ge -2^{b-1} \\times (0.1 \\times 10^{-3})$.\n$0.14418 \\le 2^{b-1} \\times (0.1 \\times 10^{-3})$.\nDividing by $V_{\\text{res}}$:\n$\\frac{0.14418}{0.1 \\times 10^{-3}} \\le 2^{b-1}$.\n$1441.8 \\le 2^{b-1}$.\nTo find the minimum integer $b$, we take the base-$2$ logarithm:\n$\\log_2(1441.8) \\le b-1$.\n$\\frac{\\ln(1441.8)}{\\ln(2)} \\le b-1$.\n$\\frac{7.2736...}{0.6931...} \\le b-1$.\n$10.494... \\le b-1$.\nSince $b-1$ must be an integer, the smallest possible value is $b-1=11$.\nTherefore, the minimum total bit width is $b = 11 + 1 = 12$.\nWith $b=12$, the range is $[-2^{11} \\times V_{\\text{res}}, (2^{11}-1) \\times V_{\\text{res}}] = [-2048 \\times 0.1 \\text{ mV}, 2047 \\times 0.1 \\text{ mV}] = [-204.8 \\text{ mV}, 204.7 \\text{ mV}]$, which safely contains the required range of $[-144.18 \\text{ mV}, -49.63 \\text{ mV}]$.",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "In stark contrast to their digital counterparts, analog neuromorphic circuits emulate neural dynamics by harnessing the natural physics of silicon devices. This practice explores how a simple yet elegant transconductance-capacitor ($g_m-C$) filter, a cornerstone of analog design, intrinsically implements the exponential decay of a synapse. Deriving the synaptic time constant $\\tau$ from fundamental device parameters and tunable bias currents will provide you with deep insight into the efficiency and adaptability inherent in the analog approach .",
            "id": "4035200",
            "problem": "An analog neuromorphic synapse can be implemented using a transconductance-capacitor ($g_m$-$C$) network, where a transconductance element produces a current proportional to a synaptic voltage and a capacitor integrates this current to realize a first-order exponential decay dynamics. In contrast to digital neuromorphic implementations that approximate exponential decay via a discrete-time recurrence (with the decay constant set by the sampling interval and a multiplier), the analog implementation leverages continuous-time device physics to set the decay time constant through bias currents and device parameters.\n\nConsider the following architecture. A symmetric differential pair of Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs) operating in weak inversion (subthreshold regime) is biased by a tail current $I_b$. The differential input is the synaptic voltage $v_s(t)$ applied to one gate while the other gate is held at a reference potential such that the operating point is centered at $v_s(t)=0$. The output node is connected to a capacitor of value $C$ to ground, and the differential pair is arranged so that, for small $|v_s(t)|$, the output current into the capacitor is linearly proportional to $v_s(t)$, i.e., $i_{\\text{out}}(t) \\approx g_m v_s(t)$, thereby implementing a first-order $g_m$-$C$ decay.\n\nUse the following well-tested facts about subthreshold MOSFET operation:\n- The thermal voltage is $U_T = \\frac{k_B T}{q}$, where $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $q$ is the elementary charge.\n- In weak inversion, the drain current of a MOSFET biased in saturation exhibits an exponential dependence on gate-source voltage: $I_d \\propto \\exp\\!\\left(\\frac{\\kappa V_{GS}}{U_T}\\right)$, where $\\kappa \\in (0,1)$ is the gate coupling coefficient (also called the subthreshold slope factor reciprocal), and the small-signal transconductance is $g_{m,\\text{single}} = \\frac{\\partial I_d}{\\partial V_{GS}} = \\frac{\\kappa}{U_T} I_d$.\n- For a symmetric differential pair in weak inversion with a tail bias current $I_b$, the odd-symmetric differential output current satisfies $I_{\\text{diff}}(v_d) = I_b \\tanh\\!\\left(\\frac{\\kappa v_d}{2 U_T}\\right)$, yielding a small-signal transconductance around $v_d=0$ of $g_m = \\left.\\frac{\\partial I_{\\text{diff}}}{\\partial v_d}\\right|_{v_d=0} = \\frac{\\kappa}{2 U_T} I_b$.\n\nStarting from the capacitor constitutive relation and the above device facts, derive the ordinary differential equation governing $v_s(t)$ and show that its solution is an exponential decay. Then, compute the time constant $\\tau$ and express its dependency on the bias current $I_b$, the thermal voltage $U_T$, the gate coupling coefficient $\\kappa$, and the capacitance $C$. Provide the final answer as a single closed-form analytic expression for $\\tau$ in terms of $C$, $\\kappa$, $U_T$, and $I_b$. Do not evaluate numerically. The time constant $\\tau$ is a physical time; if evaluated numerically, express it in seconds. No rounding is required.",
            "solution": "The synaptic voltage $v_s(t)$ is the voltage across the capacitor $C$. The constitutive relation for the capacitor is given by:\n$$i_C(t) = C \\frac{d v_s(t)}{dt}$$\nwhere $i_C(t)$ is the current flowing into the capacitor.\n\nThe problem describes a circuit that implements an exponential decay. This means that if $v_s(t) > 0$, the voltage must decrease over time ($\\frac{d v_s(t)}{dt}  0$). This requires a net current to flow *out* of the capacitor. The transconductance element $g_m$ provides this discharge path.\n\nThe current drawn *from* the capacitor by the transconductance element is given as being proportional to the voltage $v_s(t)$. Let us call this current $i_{gm}(t)$. For small $|v_s(t)|$, this relationship is linear:\n$$i_{gm}(t) = g_m v_s(t)$$\nThis current $i_{gm}(t)$ flows out of the capacitor node. The problem states \"$i_{\\text{out}}(t)$ is the output current into the capacitor\". If we interpret this literally as $i_C(t) = i_{\\text{out}}(t)$, then we would have $C \\frac{d v_s(t)}{dt} = g_m v_s(t)$, which leads to exponential growth, contradicting the stated goal of implementing a \"decay\". The physically correct interpretation, consistent with achieving decay, is that the transconductor acts as a resistor-like load, drawing a current $g_m v_s(t)$ *out* of the node. Thus, the current *into* the capacitor is $i_C(t) = -g_m v_s(t)$.\n\nSubstituting the capacitor's constitutive relation gives:\n$$C \\frac{d v_s(t)}{dt} = - g_m v_s(t)$$\nThis is the ordinary differential equation (ODE) governing $v_s(t)$. We can rearrange it into standard form:\n$$\\frac{d v_s(t)}{dt} + \\frac{g_m}{C} v_s(t) = 0$$\nThis is a first-order linear homogeneous ODE. The general solution to an equation of the form $\\frac{dy}{dt} + \\frac{1}{\\tau} y = 0$ is an exponential decay given by $y(t) = y(0) \\exp(-t/\\tau)$, where $\\tau$ is the time constant.\n\nComparing our derived ODE for $v_s(t)$ with the standard form, we can identify the time constant $\\tau$. We have:\n$$\\frac{1}{\\tau} = \\frac{g_m}{C}$$\nTherefore, the time constant $\\tau$ is:\n$$\\tau = \\frac{C}{g_m}$$\nThe problem provides the expression for the small-signal transconductance $g_m$ for the differential pair operating in the subthreshold regime:\n$$g_m = \\frac{\\kappa I_b}{2 U_T}$$\nNow, we substitute this expression for $g_m$ into our equation for $\\tau$:\n$$\\tau = \\frac{C}{\\frac{\\kappa I_b}{2 U_T}}$$\nSimplifying this expression gives the final dependency of the time constant $\\tau$ on the given parameters:\n$$\\tau = \\frac{2 C U_T}{\\kappa I_b}$$\nThis expression shows that the time constant $\\tau$ is directly proportional to the capacitance $C$ and the thermal voltage $U_T$, and inversely proportional to the gate coupling coefficient $\\kappa$ and the bias current $I_b$. This result is consistent with the principles of analog neuromorphic design, where time constants can be tuned over several orders of magnitude by adjusting bias currents.",
            "answer": "$$\\boxed{\\frac{2 C U_T}{\\kappa I_b}}$$"
        },
        {
            "introduction": "The choice of a biophysical model and its implementation paradigm are deeply intertwined, with significant consequences for system-level performance and stability. This problem investigates how implementing a more biologically realistic conductance-based synapse, as opposed to a simpler current-based one, impacts the stability of a digital simulation. By deriving the maximum stable time step for a Forward Euler discretization in both cases, you will quantify a critical hidden cost of digital implementations: the need for faster, more computationally expensive simulations to accurately capture complex, state-dependent dynamics .",
            "id": "4035164",
            "problem": "Consider a single neuron modeled as a resistive-capacitive membrane with both excitatory and inhibitory synapses. The membrane follows the standard leaky dynamics with capacitance $C$, leak conductance $g_L$, and leak reversal potential $E_L$. Two synapse modeling philosophies are considered: (i) current-based synapses, which inject a current independent of membrane voltage, and (ii) conductance-based synapses, which modulate the total membrane conductance and inject a current proportional to the membrane voltage difference from a synaptic reversal potential. The analog realization implements the dynamics in continuous time, while the digital realization uses the Forward Euler (FE) method to discretize time. Starting from the core definitions of membrane charge conservation and Ohmâ€™s law, derive the update equations for the membrane voltage under current-based and conductance-based synapses in both analog and digital realizations. Linearize the dynamics to obtain the effective dissipation term governing stability, and derive a sufficient condition for the FE discretization step size that guarantees stability (non-divergence) in the scalar case under worst-case instantaneous synaptic activation.\n\nAssume the following experimentally plausible parameters for the neuron and synapses:\n- Capacitance $C = 200$ pF\n- Leak conductance $g_L = 10$ nS\n- Leak reversal potential $E_L = -70$ mV\n- Excitatory reversal potential $E_e = 0$ mV\n- Inhibitory reversal potential $E_i = -80$ mV\n- Worst-case instantaneous sum of excitatory conductances $G_E^{\\max} = 30$ nS\n- Worst-case instantaneous sum of inhibitory conductances $G_I^{\\max} = 40$ nS\n\nIn the current-based case, the total synaptic input is modeled as an additive current that does not alter the membrane conductance. In the conductance-based case, the synaptic input is modeled as conductances with reversal potentials, and the worst-case instantaneous total synaptic conductance is $G_E^{\\max} + G_I^{\\max}$.\n\nUsing the linearized dynamics and the FE stability condition for a scalar linear system, compute the ratio $R$ between the maximum stable FE time step in the current-based case and the maximum stable FE time step in the conductance-based case. Express the final ratio as a pure number (dimensionless). No rounding is required.",
            "solution": "The problem requires the derivation and comparison of stability conditions for the Forward Euler (FE) numerical integration method applied to two different models of a neuron: one with current-based synapses and one with conductance-based synapses.\n\nThe fundamental equation governing the membrane potential, $V$, of a neuron modeled as a single resistive-capacitive compartment is based on charge conservation. The rate of change of charge on the membrane capacitance, $C$, is equal to the sum of all currents flowing across the membrane.\n$$C \\frac{dV(t)}{dt} = I_{\\text{total}}(t)$$\nThe total current is the sum of the leak current, $I_L$, and the synaptic currents. According to Ohm's law, the current through a conductive pathway is $I = g(V - E)$, where $g$ is the conductance and $E$ is the reversal potential. By convention, outward currents are positive, leading to a decrease in membrane potential. Thus, we write the membrane equation as:\n$$C \\frac{dV(t)}{dt} = -I_{\\text{leak}} - I_{\\text{synapses}}$$\n\nWe analyze the two synaptic modeling philosophies separately.\n\n**1. Conductance-Based Synapse Model**\n\nIn this model, synaptic activation opens ion channels, which are modeled as additional conductances, $g_e(t)$ for excitation and $g_i(t)$ for inhibition, each with a respective reversal potential, $E_e$ and $E_i$. The total membrane current is the sum of leak, excitatory, and inhibitory currents.\n$$I_{\\text{total}} = -g_L(V - E_L) - g_e(t)(V - E_e) - g_i(t)(V - E_i)$$\nThe continuous-time (analog) differential equation for the membrane potential is:\n$$C \\frac{dV}{dt} = -g_L(V - E_L) - g_e(t)(V - E_e) - g_i(t)(V - E_i)$$\nTo analyze the stability, we rearrange the equation to isolate the term proportional to $V$.\n$$C \\frac{dV}{dt} = - (g_L + g_e(t) + g_i(t))V + (g_L E_L + g_e(t)E_e + g_i(t)E_i)$$\nDividing by $C$ gives the standard form $\\frac{dV}{dt} = -\\lambda(t) V + f(t)$:\n$$\\frac{dV}{dt} = -\\frac{g_L + g_e(t) + g_i(t)}{C} V + \\frac{g_L E_L + g_e(t)E_e + g_i(t)E_i}{C}$$\nThe term governing the dissipation or stability of the system is the time-varying decay rate, $\\lambda(t) = \\frac{g_L + g_e(t) + g_i(t)}{C}$. This equation is linear in $V$, so no further linearization is necessary. The effective dissipation is determined by the total instantaneous conductance $g_{\\text{total}}(t) = g_L + g_e(t) + g_i(t)$.\n\nFor the digital realization using the Forward Euler (FE) method, we discretize time with a step size $\\Delta t$. The derivative is approximated as $\\frac{dV}{dt} \\approx \\frac{V_{n+1} - V_n}{\\Delta t}$.\n$$V_{n+1} = V_n + \\Delta t \\left( -\\frac{g_L + g_{e,n} + g_{i,n}}{C} V_n + \\frac{g_L E_L + g_{e,n} E_e + g_{i,n} E_i}{C} \\right)$$\nThis is a recursive relation of the form $V_{n+1} = (1 - \\lambda_n \\Delta t)V_n + \\text{input term}$. For the numerical method to be stable (non-divergent), the magnitude of the amplification factor for the homogeneous part must be less than or equal to $1$: $|1 - \\lambda_n \\Delta t| \\le 1$.\nSince $\\lambda_n = \\frac{g_L + g_{e,n} + g_{i,n}}{C}$ is always positive, this inequality expands to $-1 \\le 1 - \\lambda_n \\Delta t \\le 1$. The right side, $1 - \\lambda_n \\Delta t \\le 1$, implies $\\lambda_n \\Delta t \\ge 0$, which is always true for $\\Delta t  0$. The left side imposes the stability constraint:\n$$-1 \\le 1 - \\lambda_n \\Delta t \\implies \\lambda_n \\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{\\lambda_n}$$\nTo ensure stability at all times, this condition must hold for the largest possible value of $\\lambda(t)$, which corresponds to the largest total conductance. The problem specifies the worst-case instantaneous synaptic conductances as $G_E^{\\max}$ and $G_I^{\\max}$.\nThe maximum decay rate is $\\lambda_{\\max} = \\frac{g_L + G_E^{\\max} + G_I^{\\max}}{C}$.\nThus, the sufficient condition for the FE time step in the conductance-based model is:\n$$\\Delta t_{\\text{max, cond}} = \\frac{2C}{g_L + G_E^{\\max} + G_I^{\\max}}$$\n\n**2. Current-Based Synapse Model**\n\nIn this model, the synapses inject a current $I_{\\text{syn}}(t)$ that is independent of the membrane potential $V$. The synaptic input does not alter the membrane's total conductance. The membrane equation is:\n$$C \\frac{dV}{dt} = -I_L + I_{\\text{syn}}(t) = -g_L(V - E_L) + I_{\\text{syn}}(t)$$\nRearranging the equation:\n$$C \\frac{dV}{dt} = -g_L V + g_L E_L + I_{\\text{syn}}(t)$$\n$$\\frac{dV}{dt} = -\\frac{g_L}{C} V + \\frac{g_L E_L + I_{\\text{syn}}(t)}{C}$$\nThis is a linear time-invariant system driven by a time-varying input. The dissipation is governed by a constant decay rate $\\lambda = \\frac{g_L}{C}$, which depends only on the fixed leak properties of the membrane.\n\nThe FE update rule is:\n$$V_{n+1} = V_n + \\Delta t \\left( -\\frac{g_L}{C} V_n + \\frac{g_L E_L + I_{\\text{syn},n}}{C} \\right)$$\nThe stability analysis is identical, but with the constant decay rate $\\lambda = \\frac{g_L}{C}$. The stability condition is $\\Delta t \\le \\frac{2}{\\lambda}$.\nThus, the maximum stable time step for the current-based model is:\n$$\\Delta t_{\\text{max, curr}} = \\frac{2C}{g_L}$$\n\n**3. Ratio Calculation**\n\nThe problem asks for the ratio $R = \\frac{\\Delta t_{\\text{max, curr}}}{\\Delta t_{\\text{max, cond}}}$.\n$$R = \\frac{\\frac{2C}{g_L}}{\\frac{2C}{g_L + G_E^{\\max} + G_I^{\\max}}}$$\nThe term $2C$ cancels out, yielding:\n$$R = \\frac{g_L + G_E^{\\max} + G_I^{\\max}}{g_L}$$\nThis ratio quantifies the factor by which the maximum stable time step must be reduced in the conductance-based model compared to the current-based model, due to the additional fast dynamics introduced by synaptic conductances. Substituting the given numerical values:\n$g_L = 10 \\text{ nS}$\n$G_E^{\\max} = 30 \\text{ nS}$\n$G_I^{\\max} = 40 \\text{ nS}$\n$$R = \\frac{10 \\text{ nS} + 30 \\text{ nS} + 40 \\text{ nS}}{10 \\text{ nS}} = \\frac{80 \\text{ nS}}{10 \\text{ nS}} = 8$$\nThe result is a dimensionless number, as expected for a ratio of two time steps. This indicates that for this set of parameters, the conductance-based simulation requires a time step at least $8$ times smaller than the current-based simulation to guarantee numerical stability under worst-case synaptic bombardment.",
            "answer": "$$\\boxed{8}$$"
        }
    ]
}