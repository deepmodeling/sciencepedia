{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握时间步进模拟与事件驱动模拟的根本区别，我们必须从核心问题入手：这两种方法如何推进神经元状态随时间的演化。本练习  深入探讨了计算神经科学的基石——LIF（Leaky Integrate-and-Fire）神经元的亚阈值动力学。通过直接比较最简单的时间步进方法（前向欧拉法）与事件驱动方案中用于线性系统的精确积分法，您将能够亲手推导并量化时间步进法所固有的离散化误差。",
            "id": "4044438",
            "problem": "考虑一个由漏电积分-发放（LIF）动力学模型描述的单个神经元，该神经元处于亚阈值状态，即在一个数值步长内不会发生脉冲阈值穿越。膜电位用 $V(t)$ 表示，并遵循以下一阶线性常微分方程（ODE）演化\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}\\left(V(t) - R I(t)\\right),\n$$\n其中 $\\tau$ 是膜时间常数，$R$ 是膜电阻，$I(t)$ 是输入电流。在神经形态模拟中常见的事件驱动环境中，假设在两次突触事件之间，输入电流是分段恒定的。在从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个宏观步长内，假设 $I(t) = I_n$ 是恒定的。\n\n从该常微分方程和局部截断误差的定义（即在 $t_n$ 处具有精确初始条件的假设下，精确单步解与数值单步更新之间的差值）出发，完成以下任务：\n\n- 在恒定输入假设下，推导上述常微分方程的精确解 $V(t_{n+1})$，以及事件驱动积分中使用的相应指数欧拉（精确子步积分）更新。\n\n- 推导同一步长的正向欧拉更新。\n\n- 使用这些结果，计算步长为 $\\Delta t$ 的正向欧拉方法的局部截断误差，该误差表示为 $t_{n+1}$ 处的精确解与从 $V(t_n) = V_n$ 和 $I_n$ 计算出的正向欧拉更新之间的差值。将最终误差表示为 $V_n$、$I_n$、$R$、$\\tau$ 和 $\\Delta t$ 的闭合形式函数。\n\n- 使用第一性原理和泰勒展开论证，简要解释为何在事件驱动模拟中，指数欧拉法在分段恒定输入假设下能减少离散化误差。\n\n您的最终答案必须是单个闭合形式的解析表达式。无需四舍五入，最终答案中也不应包含任何物理单位。",
            "solution": "漏电积分-发放（LIF）的亚阈值动力学由以下线性常微分方程给出\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}\\left(V(t) - R I(t)\\right),\n$$\n在区间 $[t_n, t_{n+1}]$ 上，输入 $I(t) = I_n$ 是分段恒定的，其中 $t_{n+1} = t_n + \\Delta t$。定义该步长内恒定输入的稳态（或不动点）电压为\n$$\nV_{\\infty} \\equiv R I_n.\n$$\n在此假设下，该常微分方程在区间上简化为\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}\\left(V(t) - V_{\\infty}\\right),\n$$\n这是一个一阶线性常系数常微分方程。其从 $V(t_n) = V_n$ 开始的精确解可通过标准方法（分离变量法或积分因子法）获得。使用积分因子 $\\exp\\left(\\frac{t}{\\tau}\\right)$，解为\n$$\nV(t) = V_{\\infty} + \\left(V_n - V_{\\infty}\\right)\\exp\\left(-\\frac{t - t_n}{\\tau}\\right), \\quad t \\in [t_n, t_{n+1}].\n$$\n在 $t_{n+1} = t_n + \\Delta t$ 处求值，精确的单步解为\n$$\nV_{\\text{exact}}(t_{n+1}) = V_{\\infty} + \\left(V_n - V_{\\infty}\\right)\\exp\\left(-\\frac{\\Delta t}{\\tau}\\right).\n$$\n在采用精确子步积分（对于线性漂移项，常称为指数欧拉法）的事件驱动模拟中，人们在分段恒定输入假设下使用这个精确的闭合形式更新。因此，指数欧拉单步更新等于 $V_{\\text{exact}}(t_{n+1})$，并且在此类区间上的局部截断误差为零。\n\n作为比较，将正向欧拉法应用于该常微分方程时，使用的是在步长开始时计算的漂移项：\n$$\nV_{\\text{FE}}(t_{n+1}) = V_n + \\Delta t \\cdot \\left[-\\frac{1}{\\tau}\\left(V_n - V_{\\infty}\\right)\\right] = V_n - \\frac{\\Delta t}{\\tau}\\left(V_n - V_{\\infty}\\right).\n$$\n根据定义，正向欧拉法在这一步的局部截断误差（LTE）是 $t_{n+1}$ 处的精确解与正向欧拉更新之间的差值，假设在 $t_n$ 处具有精确的初始值：\n$$\n\\mathrm{LTE}_{\\text{FE}}(\\Delta t) = V_{\\text{exact}}(t_{n+1}) - V_{\\text{FE}}(t_{n+1}).\n$$\n代入上面推导出的表达式，令 $\\delta \\equiv V_n - V_{\\infty}$ 和 $h \\equiv \\frac{\\Delta t}{\\tau}$。则\n$$\nV_{\\text{exact}}(t_{n+1}) = V_{\\infty} + \\delta \\exp(-h),\n$$\n$$\nV_{\\text{FE}}(t_{n+1}) = V_n - h \\delta,\n$$\n因此\n$$\n\\mathrm{LTE}_{\\text{FE}}(\\Delta t) = \\left[V_{\\infty} + \\delta \\exp(-h)\\right] - \\left[V_n - h \\delta\\right] = V_{\\infty} - V_n + \\delta \\exp(-h) + h \\delta.\n$$\n由于 $V_{\\infty} - V_n = -\\delta$，上式可简化为\n$$\n\\mathrm{LTE}_{\\text{FE}}(\\Delta t) = \\delta\\left(h + \\exp(-h) - 1\\right).\n$$\n回到原始符号，\n$$\n\\mathrm{LTE}_{\\text{FE}}(\\Delta t) = \\left(V_n - R I_n\\right)\\left(\\frac{\\Delta t}{\\tau} + \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) - 1\\right).\n$$\n\n为了证明在分段恒定输入假设下，指数欧拉法为何能减少离散化误差，注意到精确子步积分使用了带恒定驱动项的线性常微分方程的闭合形式解，该解与 $V_{\\text{exact}}(t_{n+1})$ 完全匹配，因此在此类区间上的局部截断误差为零。相比之下，正向欧拉法通过一阶泰勒步长来近似指数松弛过程。指数函数的泰勒展开明确地显示了误差结构：\n$$\n\\exp(-h) = 1 - h + \\frac{h^{2}}{2} - \\frac{h^{3}}{6} + \\cdots,\n$$\n将其代入误差表达式，得到\n$$\n\\mathrm{LTE}_{\\text{FE}}(\\Delta t) = \\delta\\left(h + \\left[1 - h + \\frac{h^{2}}{2} - \\frac{h^{3}}{6} + \\cdots\\right] - 1\\right) = \\delta\\left(\\frac{h^{2}}{2} - \\frac{h^{3}}{6} + \\cdots\\right),\n$$\n其阶为 $\\mathcal{O}\\!\\left(h^{2}\\right)$，并且对于 $h > 0$ 严格非零，除非 $\\delta = 0$（已处于不动点）或 $\\Delta t = 0$。因此，在分段恒定输入下（这是事件驱动神经形态模拟中离散突触事件之间的一个自然假设），指数欧拉法消除了局部截断误差，而正向欧拉法则会产生一个量级为 $\\left(\\Delta t / \\tau\\right)^{2}$ 的误差，该误差由初始偏差 $\\delta = V_n - R I_n$ 缩放。这表明在LIF动力学中，相对于采用时间步长的正向欧拉法，精确子步积分如何减少离散化误差。",
            "answer": "$$\\boxed{\\left(V_n - R I_n\\right)\\left(\\frac{\\Delta t}{\\tau} + \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) - 1\\right)}$$"
        },
        {
            "introduction": "前一个练习中分析的数值误差并非仅仅是抽象的数学概念，它对模拟关键的神经元特性有着具体而深远的影响。本练习  聚焦于这样一个核心特性：绝对不应期，它直接决定了神经元的最大放电频率。您将研究固定的时间网格如何扭曲这一至关重要的生物时间尺度，并推导出为保证模拟精度，时间步长 $\\Delta t$ 必须满足的约束条件。",
            "id": "4044467",
            "problem": "一个持续时间为 $\\tau_{\\mathrm{ref}}$ 的绝对不应期的漏电积分发放 (LIF) 神经元，使用两种方法进行模拟：\n- 一个事件驱动的模拟器，在时刻 $t_{\\mathrm{s}}$ 发生脉冲后，将不应期的结束精确地安排在 $t_{\\mathrm{s}}+\\tau_{\\mathrm{ref}}$。\n- 一个时间步进的模拟器，在均匀的时间网格 $t_{n}=n\\,\\Delta t$ 上推进时间。为了强制实现绝对不应期（不提前释放），该模拟器在脉冲后将脉冲发放阻断 $K$ 个完整的时间步，其中 $K$ 是满足 $K\\,\\Delta t \\ge \\tau_{\\mathrm{ref}}$ 的最小整数。\n\n仅从绝对不应期和均匀时间离散化的核心定义出发，推导当 $\\tau_{\\mathrm{ref}}$ 不是 $\\Delta t$ 的整数倍时，由时间步进方法引入的不应期释放的时间误差的表达式。然后，通过界定此误差相对于 $\\tau_{\\mathrm{ref}}$ 的大小，得出一个关于 $\\Delta t$ 的约束条件，该条件保证对于 $\\tau_{\\mathrm{ref}}/\\Delta t$ 小数部分的所有可能值，相对误差都不会超过一个预设的容差 $\\varepsilon \\ll 1$。\n\n最后，取 $\\tau_{\\mathrm{ref}}=3.2\\,\\mathrm{ms}$ 和目标相对误差容差 $\\varepsilon=0.005$。满足您推导出的边界条件的最大时间步长 $\\Delta t_{\\max}$ 是多少（以微秒为单位）？将您的答案四舍五入到四位有效数字。以 $\\mu\\mathrm{s}$ 表示最终的时间步长，并且不要在最终的方框答案中包含单位。",
            "solution": "该问题要求对神经元绝对不应期的时间步进模拟所引入的时间误差进行精确分析，并与理想的事件驱动模拟进行比较。我们将首先推导此误差的一般表达式，然后用它来建立对模拟时间步长 $\\Delta t$ 的约束，以满足指定的相对误差容差 $\\varepsilon$。最后，我们将计算给定参数下的最大允许时间步长。\n\n设在时刻 $t_{\\mathrm{s}}$ 发生一次脉冲。在理想的事件驱动模拟中，持续时间为 $\\tau_{\\mathrm{ref}}$ 的绝对不应期精确地在以下时刻结束：\n$$t_{\\mathrm{release, exact}} = t_{\\mathrm{s}} + \\tau_{\\mathrm{ref}}$$\n\n在具有均匀时间网格 $t_n = n\\,\\Delta t$ 的时间步进模拟中，不应期通过阻断 $K$ 个完整时间步的脉冲来强制执行。问题将 $K$ 定义为满足“阻断的持续时间 $K\\,\\Delta t$ 大于或等于真实的不应期 $\\tau_{\\mathrm{ref}}$”这一条件的最小整数。这个条件由以下不等式表示：\n$$K\\,\\Delta t \\ge \\tau_{\\mathrm{ref}}$$\n因为 $K$ 必须是满足此条件的最小整数，所以它由向上取整函数（ceiling function）给出：\n$$K = \\left\\lceil \\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} \\right\\rceil$$\n在时间步进模拟中，不应期实际上在 $K$ 步之后结束，所以释放时间为：\n$$t_{\\mathrm{release, sim}} = t_{\\mathrm{s}} + K\\,\\Delta t$$\n\n时间误差 $\\Delta t_{\\mathrm{err}}$ 是模拟的释放时间与精确的释放时间之间的差值。由于 $K\\,\\Delta t \\ge \\tau_{\\mathrm{ref}}$，这个误差总是不为负的。\n$$\\Delta t_{\\mathrm{err}} = t_{\\mathrm{release, sim}} - t_{\\mathrm{release, exact}} = (t_{\\mathrm{s}} + K\\,\\Delta t) - (t_{\\mathrm{s}} + \\tau_{\\mathrm{ref}})$$\n$$\\Delta t_{\\mathrm{err}} = K\\,\\Delta t - \\tau_{\\mathrm{ref}}$$\n代入 $K$ 的表达式：\n$$\\Delta t_{\\mathrm{err}} = \\left\\lceil \\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} \\right\\rceil \\Delta t - \\tau_{\\mathrm{ref}}$$\n这就是时间误差的表达式。问题指出，当 $\\tau_{\\mathrm{ref}}$ 不是 $\\Delta t$ 的整数倍时，会产生这个误差。如果对于某个整数 $m$，$\\tau_{\\mathrm{ref}} = m\\,\\Delta t$，那么 $\\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} = m$，所以 $K = \\lceil m \\rceil = m$，并且 $\\Delta t_{\\mathrm{err}} = m\\,\\Delta t - \\tau_{\\mathrm{ref}} = 0$。\n\n接下来，我们必须界定这个误差的范围。向上取整函数 $\\lceil x \\rceil$ 具有基本性质 $x \\le \\lceil x \\rceil  x + 1$。令 $x = \\frac{\\tau_{\\mathrm{ref}}}{\\Delta t}$。应用此性质：\n$$\\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} \\le \\left\\lceil \\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} \\right\\rceil  \\frac{\\tau_{\\mathrm{ref}}}{\\Delta t} + 1$$\n代入 $K$ 并将不等式的各部分都乘以 $\\Delta t$（它是一个正量）：\n$$\\tau_{\\mathrm{ref}} \\le K\\,\\Delta t  \\tau_{\\mathrm{ref}} + \\Delta t$$\n从各部分减去 $\\tau_{\\mathrm{ref}}$，得到绝对误差的界限：\n$$0 \\le K\\,\\Delta t - \\tau_{\\mathrm{ref}}  \\Delta t$$\n$$0 \\le \\Delta t_{\\mathrm{err}}  \\Delta t$$\n这表明时间误差总是不为负的，并且严格小于一个时间步长 $\\Delta t$。\n\n相对误差 $E_{\\mathrm{rel}}$ 是绝对误差用真实的不应期 $\\tau_{\\mathrm{ref}}$ 进行归一化后的结果：\n$$E_{\\mathrm{rel}} = \\frac{\\Delta t_{\\mathrm{err}}}{\\tau_{\\mathrm{ref}}}$$\n使用 $\\Delta t_{\\mathrm{err}}$ 的界限，我们可以界定相对误差的范围：\n$$0 \\le E_{\\mathrm{rel}}  \\frac{\\Delta t}{\\tau_{\\mathrm{ref}}}$$\n为了保证对于所有可能的 $\\tau_{\\mathrm{ref}}$ 和 $\\Delta t$ 值（因此对于 $\\frac{\\tau_{\\mathrm{ref}}}{\\Delta t}$ 小数部分的任何值），相对误差都不超过预设的容差 $\\varepsilon$，我们必须确保相对误差的上限小于或等于 $\\varepsilon$。$E_{\\mathrm{rel}}$ 的最小上界（上确界）是 $\\frac{\\Delta t}{\\tau_{\\mathrm{ref}}}$。当 $\\frac{\\tau_{\\mathrm{ref}}}{\\Delta t}$ 仅比一个整数大一点点时，最坏情况下的误差会接近这个上确界，这使得 $\\Delta t_{\\mathrm{err}}$ 接近 $\\Delta t$。\n\n因此，约束条件是：\n$$\\sup(E_{\\mathrm{rel}}) \\le \\varepsilon$$\n$$\\frac{\\Delta t}{\\tau_{\\mathrm{ref}}} \\le \\varepsilon$$\n这可以重新整理以找到对时间步长 $\\Delta t$ 的约束条件：\n$$\\Delta t \\le \\varepsilon \\tau_{\\mathrm{ref}}$$\n\n最后，我们将这个约束应用于给定的数值。满足此条件的最大时间步长 $\\Delta t_{\\max}$ 是满足以下等式的值：\n$$\\Delta t_{\\max} = \\varepsilon \\tau_{\\mathrm{ref}}$$\n给定 $\\tau_{\\mathrm{ref}} = 3.2\\,\\mathrm{ms}$ 和 $\\varepsilon = 0.005$。\n$$\\tau_{\\mathrm{ref}} = 3.2 \\times 10^{-3}\\,\\mathrm{s}$$\n$$\\varepsilon = 5 \\times 10^{-3}$$\n代入这些值：\n$$\\Delta t_{\\max} = (5 \\times 10^{-3}) \\times (3.2 \\times 10^{-3}\\,\\mathrm{s}) = 16 \\times 10^{-6}\\,\\mathrm{s}$$\n问题要求答案以微秒（$\\mu\\mathrm{s}$）为单位，其中 $1\\,\\mu\\mathrm{s} = 10^{-6}\\,\\mathrm{s}$。\n$$\\Delta t_{\\max} = 16\\,\\mu\\mathrm{s}$$\n最终答案必须四舍五入到四位有效数字。为了用四位有效数字表示 $16$，我们将其写为 $16.00$。\n$$\\Delta t_{\\max} = 16.00\\,\\mu\\mathrm{s}$$",
            "answer": "$$\\boxed{16.00}$$"
        },
        {
            "introduction": "在考察了单个积分步长和单个时间特征层面的误差后，我们现在将分析的尺度提升至网络层面。这些微小的、独立的计时误差将如何累积，并最终影响整个神经元群体的集体行为？本终极练习  旨在挑战您量化尖峰时间的离散化对网络与外部周期性刺激进行同步（即“锁相”）能力的影响。您将运用如环形方差这类强大的统计工具，来衡量这种由离散化导致的时间精度退化。",
            "id": "4044419",
            "problem": "考虑一个由相同的漏放电积分（LIF）神经元组成的网络，该网络由一个共同的周期性电流驱动。每个神经元都遵循膜电位方程 $C \\,\\frac{dV}{dt} = -\\frac{1}{R}\\big(V(t)-V_{L}\\big) + I(t)$，当 $V(t)$ 达到阈值 $V_{\\mathrm{th}}$ 时，会瞬时产生脉冲，然后立即重置为 $V_{r}$。输入为 $I(t) = I_{0} + A \\sin\\!\\big(2\\pi t/T\\big)$，其中 $T$ 是刺激周期。假设所选参数使得在没有离散化的情况下，每个神经元在每个刺激周期内精确发放一次脉冲，并与驱动信号锁相。使用两种模拟方法：\n\n- 事件驱动：在事件之间对亚阈值动力学进行解析积分，以计算精确的阈值穿越时间 $\\{t_{k}^{\\star}\\}$；根据构造，脉冲时间没有数值离散化误差。\n- 时间步进：采用时间步长为 $\\Delta t$ 的前向欧拉法；膜电位 $V_{n}$ 在时间 $t_{n}=n\\Delta t$ 进行更新，当 $V_{n}\\ge V_{\\mathrm{th}}$ 时，在第一个满足该条件的网格时间 $t_{n}$ 记录一个脉冲。不使用插值法；记录的脉冲时间即为网格时间 $t_{n}$。\n\n将第 $k$ 个脉冲相对于刺激的相位（以弧度为单位）定义为 $\\phi_{k}=2\\pi t_{k}/T \\mod 2\\pi$。为了量化锁相程度，对于 $N$ 个脉冲的长序列，使用环形方差 $V = 1 - \\left|\\frac{1}{N}\\sum_{k=1}^{N} \\exp\\!\\big(i \\phi_{k}\\big)\\right|$；为了量化脉冲时间精度，使用均方根（RMS）计时误差 $\\sqrt{\\mathbb{E}\\!\\big[e^{2}\\big]}$，其中 $e = t_{k}^{\\Delta}-t_{k}^{\\star}$，$t_{k}^{\\Delta}$ 是时间步进法得到的脉冲时间。\n\n设计一个实验方案，通过比较在相同周期性驱动下，相同LIF网络的事件驱动和时间步进模拟的这两个指标，来分离离散化效应。假设 $T/\\Delta t$ 是无理数（因此阈值穿越相对于采样网格是均匀分布的），并且 $\\Delta t$ 足够小，以至于主要的时间步进误差源于脉冲时间在网格上的量化（而非亚阈值积分误差）。在这些假设下，从第一性原理出发，推导时间步进模拟中预期环形方差 $V$ 关于小 $\\Delta t$ 的主阶表达式，用 $\\Delta t$ 和 $T$ 表示。\n\n最后，对 $T = 25\\,\\mathrm{ms}$ 和 $\\Delta t = 0.1\\,\\mathrm{ms}$ 的情况，对该表达式进行数值计算，并将答案四舍五入到四位有效数字。在答题框中以无单位的无量纲数形式给出最终结果。",
            "solution": "分离离散化效应的方案包括将一个“完美”的事件驱动模拟与一个时间步进模拟进行比较。\n1.  在事件驱动模拟中，计算出精确的脉冲时间 $t_k^{\\star}$。鉴于神经元每个周期精确发放一次脉冲且是锁相的，脉冲时间是完全周期的，$t_k^{\\star} = t_1^{\\star} + (k-1)T$。相应的相位 $\\phi_k^{\\star} = 2\\pi t_k^{\\star}/T \\pmod{2\\pi}$ 都是相同的。环形方差为 $V^{\\star} = 1 - |\\frac{1}{N}\\sum_{k=1}^{N} \\exp(i \\phi_k^{\\star})| = 1 - |\\exp(i \\phi_1^{\\star})| = 1 - 1 = 0$。这提供了一个零误差的基准。\n2.  在时间步进模拟中，离散化会引入误差。任何非零的环形方差 $V$ 都可归因于这些误差。问题引导我们只考虑脉冲时间量化带来的误差。\n\n推导过程如下。\n设 $t_k^{\\star}$ 为第 $k$ 次阈值穿越的精确时间。在时间步进模拟中，膜电位仅在离散时间点 $t_n = n\\Delta t$ 被检查。当 $V(t_k^{\\Delta}) \\ge V_{\\mathrm{th}}$ 时，在第一个满足该条件的网格时间 $t_k^{\\Delta}$ 登记一个脉冲。由于没有使用插值，这意味着如果 $t_k^{\\star}$ 落在区间 $( (n_k-1)\\Delta t, n_k\\Delta t ]$ 内，脉冲将被记录在时间 $t_k^{\\Delta} = n_k\\Delta t$。这等价于 $t_k^{\\Delta} = \\lceil t_k^{\\star}/\\Delta t \\rceil \\Delta t$。\n\n第 $k$ 个脉冲的计时误差为 $e_k = t_k^{\\Delta} - t_k^{\\star}$。问题陈述中提到比率 $T/\\Delta t$ 是无理数。对于一个周期为 $T$ 的完全周期性底层过程，根据 Weyl 的均匀分布准则，精确脉冲时间序列模时间步长，$t_k^{\\star} \\pmod{\\Delta t}$，在区间 $[0, \\Delta t)$ 上是均匀分布的。这意味着真实脉冲时间在一个模拟时间步内的位置是随机且均匀的。\n\n设 $\\delta_k = t_k^{\\star} \\pmod{\\Delta t}$。$\\delta_k$ 服从 $[0, \\Delta t)$ 上的均匀分布。记录的脉冲时间为 $t_k^{\\Delta} = t_k^{\\star} - \\delta_k + \\Delta t$。误差为 $e_k = t_k^{\\Delta} - t_k^{\\star} = \\Delta t - \\delta_k$。由于 $\\delta_k$ 是一个在 $[0, \\Delta t)$ 上均匀分布的随机变量，误差 $e_k$ 也是一个随机变量，我们称之为 $\\varepsilon$，它在 $(0, \\Delta t]$ 上均匀分布。为了积分的方便，我们可以将其概率密度函数视为在 $\\varepsilon \\in [0, \\Delta t]$ 上 $p(\\varepsilon) = 1/\\Delta t$，其他情况下为 0。\n\n时间步进模拟中第 $k$ 个脉冲的相位是 $\\phi_k^{\\Delta}$。我们可以将其与精确相位 $\\phi_k^{\\star}$ 联系起来。由于底层过程是完全锁相的，所有精确相位都相同，即对所有 $k$ 都有 $\\phi_k^{\\star} = \\phi^{\\star}$。\n$$\n\\phi_k^{\\Delta} = \\frac{2\\pi t_k^{\\Delta}}{T} \\pmod{2\\pi} = \\frac{2\\pi (t_k^{\\star} + e_k)}{T} \\pmod{2\\pi} = \\left(\\phi^{\\star} + \\frac{2\\pi e_k}{T}\\right) \\pmod{2\\pi}\n$$\n相位误差为 $\\Delta\\phi_k = 2\\pi e_k/T$。由于 $e_k$ 从 $[0, \\Delta t]$ 上的均匀分布中抽取，相位误差 $\\Delta\\phi_k$ 从 $[0, \\Phi_{\\max}]$ 上的均匀分布中抽取，其中 $\\Phi_{\\max} = 2\\pi \\Delta t/T$。\n\n环形方差定义为 $V = 1 - |\\frac{1}{N}\\sum_{k=1}^{N} \\exp(i \\phi_k^{\\Delta})|$。对于大量的脉冲 $N$，这个和可以用相对相位分布的期望值来代替：\n$$\nV \\approx 1 - |\\mathbb{E}[\\exp(i \\phi^{\\Delta})]|\n$$\n其中 $\\phi^{\\Delta} = \\phi^{\\star} + \\Delta\\phi$，$\\Delta\\phi$ 是随机相位误差。\n$$\n\\mathbb{E}[\\exp(i \\phi^{\\Delta})] = \\mathbb{E}[\\exp(i (\\phi^{\\star} + \\Delta\\phi))] = \\exp(i\\phi^{\\star}) \\mathbb{E}[\\exp(i \\Delta\\phi)]\n$$\n其模为：\n$$\n|\\mathbb{E}[\\exp(i \\phi^{\\Delta})]| = |\\exp(i\\phi^{\\star})| \\cdot |\\mathbb{E}[\\exp(i \\Delta\\phi)]| = |\\mathbb{E}[\\exp(i \\Delta\\phi)]|\n$$\n我们计算 $\\exp(i\\Delta\\phi)$ 的期望值，其中 $\\Delta\\phi$ 在 $[0, \\Phi_{\\max}]$ 上具有均匀概率密度 $p(\\psi) = 1/\\Phi_{\\max}$：\n$$\n\\mathbb{E}[\\exp(i \\Delta\\phi)] = \\int_{0}^{\\Phi_{\\max}} \\exp(i \\psi) \\frac{1}{\\Phi_{\\max}} d\\psi = \\frac{1}{\\Phi_{\\max}} \\left[ \\frac{\\exp(i \\psi)}{i} \\right]_{0}^{\\Phi_{\\max}} = \\frac{\\exp(i \\Phi_{\\max}) - 1}{i\\Phi_{\\max}}\n$$\n为了求模，我们使用恒等式 $\\exp(i\\theta) - 1 = \\exp(i\\theta/2) (\\exp(i\\theta/2) - \\exp(-i\\theta/2)) = 2i \\exp(i\\theta/2) \\sin(\\theta/2)$。\n$$\n\\mathbb{E}[\\exp(i \\Delta\\phi)] = \\frac{2i \\exp(i\\Phi_{\\max}/2) \\sin(\\Phi_{\\max}/2)}{i\\Phi_{\\max}} = \\exp(i\\Phi_{\\max}/2) \\frac{\\sin(\\Phi_{\\max}/2)}{\\Phi_{\\max}/2}\n$$\n其模为：\n$$\n|\\mathbb{E}[\\exp(i \\Delta\\phi)]| = \\left| \\frac{\\sin(\\Phi_{\\max}/2)}{\\Phi_{\\max}/2} \\right|\n$$\n由于 $\\Delta t$ 很小，$\\Phi_{\\max}$ 是一个小的正数，因此绝对值不是必需的。\n$$\nV \\approx 1 - \\frac{\\sin(\\Phi_{\\max}/2)}{\\Phi_{\\max}/2}\n$$\n问题要求的是关于小 $\\Delta t$ 的主阶表达式。这对应于一个小的 $\\Phi_{\\max}$。我们对小 $x$ 使用 $\\sin(x) \\approx x - x^3/6$ 的泰勒级数展开。设 $x = \\Phi_{\\max}/2$。\n$$\n\\frac{\\sin(\\Phi_{\\max}/2)}{\\Phi_{\\max}/2} \\approx \\frac{(\\Phi_{\\max}/2) - (\\Phi_{\\max}/2)^3/6}{\\Phi_{\\max}/2} = 1 - \\frac{(\\Phi_{\\max}/2)^2}{6} = 1 - \\frac{\\Phi_{\\max}^2}{24}\n$$\n将此代入 $V$ 的表达式中：\n$$\nV \\approx 1 - \\left(1 - \\frac{\\Phi_{\\max}^2}{24}\\right) = \\frac{\\Phi_{\\max}^2}{24}\n$$\n现在，我们将 $\\Phi_{\\max} = 2\\pi \\Delta t/T$ 代回此表达式中：\n$$\nV \\approx \\frac{1}{24} \\left(\\frac{2\\pi \\Delta t}{T}\\right)^2 = \\frac{4\\pi^2}{24} \\left(\\frac{\\Delta t}{T}\\right)^2 = \\frac{\\pi^2}{6} \\left(\\frac{\\Delta t}{T}\\right)^2\n$$\n这就是推导出的环形方差的主阶表达式。\n\n最后，我们使用给定的数值计算这个表达式：$T = 25\\,\\mathrm{ms}$ 和 $\\Delta t = 0.1\\,\\mathrm{ms}$。单位在比率 $\\Delta t / T$ 中消去。\n$$\n\\frac{\\Delta t}{T} = \\frac{0.1\\,\\mathrm{ms}}{25\\,\\mathrm{ms}} = \\frac{1}{250} = 0.004\n$$\n将此代入我们的 $V$ 表达式中：\n$$\nV \\approx \\frac{\\pi^2}{6} \\left(\\frac{1}{250}\\right)^2 = \\frac{\\pi^2}{6 \\times 62500} = \\frac{\\pi^2}{375000}\n$$\n使用 $\\pi \\approx 3.14159265$ 的值：\n$$\nV \\approx \\frac{(3.14159265)^2}{375000} \\approx \\frac{9.8696044}{375000} \\approx 2.6318945 \\times 10^{-5}\n$$\n四舍五入到四位有效数字，我们得到 $2.632 \\times 10^{-5}$。",
            "answer": "$$\\boxed{2.632 \\times 10^{-5}}$$"
        }
    ]
}