{
    "hands_on_practices": [
        {
            "introduction": "To truly understand how a memristor works, we must connect its macroscopic electrical response to the underlying microscopic physics. This first practice challenges you to build that connection from the ground up. By starting with the fundamental principle of ionic drift in an electric field, you will derive an equation for the rate of change of the memristor's internal state variable, which represents the width of the conductive region. This exercise provides a crucial first-principles derivation of the device's dynamic behavior, moving beyond pre-canned formulas to build a solid conceptual foundation .",
            "id": "4051466",
            "problem": "A bipolar resistive switching titanium dioxide memristive device is modeled with a single internal state variable $w(t)$ representing the width of the oxygen-vacancy-doped low-resistance region within a film of total thickness $D$. The device has a measured low-resistance-state resistance $R_{\\mathrm{on}}$ when fully doped (that is, when $w=D$). Assume the ionic drift of oxygen vacancies governs the motion of the $w$-boundary during electrical excitation, and that during a short excitation the ionic diffusion and any field-enhanced nonlinearities are negligible. The device is driven by a rectangular current pulse train with pulse amplitude $I_{0}$, pulse width $\\tau$, and period $T$ such that $T \\gg \\tau$ and the off-time has negligible effect on $w$. The active layer has uniform cross-sectional area $A$, but $A$ is not provided.\n\nStart from the following fundamental relations and definitions only:\n- The drift velocity of charged defects is $v_{\\mathrm{d}}=\\mu_{v} E$, where $\\mu_{v}$ is the ionic mobility and $E$ is the local electric field.\n- The constitutive relation in a uniform conductor is $E=\\rho J$, where $\\rho$ is the resistivity and $J$ is the current density, with $J=i/A$ for terminal current $i$ and cross-sectional area $A$.\n- The macroscopic resistance of a uniform slab of material of length $L$ and cross-sectional area $A$ is $R=\\rho L/A$.\n\nWithout assuming any pre-given state-evolution law, derive from these bases an expression for the change in $w$ over a single current pulse, $\\Delta w$ in meters, in the small-pulse limit where $w$ does not change appreciably during the pulse. Your final expression must be in terms of $I_{0}$, $\\tau$, and the given device parameters only, and should not involve the unknown cross-sectional area $A$.\n\nUse the following parameter values: $\\mu_{v}=10^{-10}\\,\\mathrm{m}^{2}/\\mathrm{V\\,s}$, $D=10\\,\\mathrm{nm}$, and $R_{\\mathrm{on}}=1\\,\\mathrm{k}\\Omega$. Express the final result for $\\Delta w$ in meters as a closed-form analytic expression. No rounding is required.",
            "solution": "The problem asks for the change in the width of the doped region, $\\Delta w$, over a single current pulse of amplitude $I_0$ and duration $\\tau$. The derivation must start from the provided fundamental relations only.\n\nThe state variable $w(t)$ represents the width of the low-resistance (doped) region. Its rate of change is determined by the velocity of the boundary between the doped and undoped regions. This velocity is the drift velocity, $v_{\\mathrm{d}}$, of the oxygen vacancies.\n$$\n\\frac{dw}{dt} = v_{\\mathrm{d}}\n$$\n\nThe problem provides the relation for the drift velocity of charged defects:\n$$\nv_{\\mathrm{d}} = \\mu_{v} E\n$$\nwhere $\\mu_{v}$ is the ionic mobility and $E$ is the local electric field driving the motion. Combining these gives:\n$$\n\\frac{dw}{dt} = \\mu_{v} E\n$$\n\nThe problem is structured such that only parameters related to the doped (low-resistance) region are fully specified. The resistivity of the doped region is $\\rho_{\\mathrm{on}}$. The electric field within this uniform conductor is given by the constitutive relation $E = \\rho J$. We must interpret the \"local electric field\" $E$ driving the boundary motion. Given the provided information, the only field that can be quantified without introducing new unknown parameters (like the resistivity of the undoped region, $\\rho_{\\mathrm{off}}$) is the field within the doped region, $E_{\\mathrm{on}}$. Thus, we proceed assuming $E = E_{\\mathrm{on}}$.\n$$\nE = E_{\\mathrm{on}} = \\rho_{\\mathrm{on}} J\n$$\nwhere $J$ is the current density in the device. The current density is uniform due to the uniform cross-sectional area $A$ and is related to the terminal current $i(t)$ by $J = i(t)/A$. During the pulse, the current is constant at $i(t) = I_0$. Therefore,\n$$\nJ = \\frac{I_0}{A}\n$$\n\nSubstituting these relations into the equation for $dw/dt$, we get:\n$$\n\\frac{dw}{dt} = \\mu_{v} \\left( \\rho_{\\mathrm{on}} \\frac{I_0}{A} \\right) = \\mu_{v} I_0 \\frac{\\rho_{\\mathrm{on}}}{A}\n$$\nThis expression contains the term $\\rho_{\\mathrm{on}}/A$, which involves two unknowns, $\\rho_{\\mathrm{on}}$ and $A$. The problem states that the cross-sectional area $A$ is not provided and must not appear in the final answer. We can eliminate the ratio $\\rho_{\\mathrm{on}}/A$ using the given device parameter $R_{\\mathrm{on}}$.\n\n$R_{\\mathrm{on}}$ is the resistance of the device when it is fully doped, i.e., when the doped region extends across the entire film thickness, $w=D$. Using the formula for macroscopic resistance of a uniform slab, $R = \\rho L/A$, with resistance $R=R_{\\mathrm{on}}$, resistivity $\\rho=\\rho_{\\mathrm{on}}$, and length $L=D$:\n$$\nR_{\\mathrm{on}} = \\frac{\\rho_{\\mathrm{on}} D}{A}\n$$\nFrom this, we can solve for the ratio $\\rho_{\\mathrm{on}}/A$:\n$$\n\\frac{\\rho_{\\mathrm{on}}}{A} = \\frac{R_{\\mathrm{on}}}{D}\n$$\n\nNow, we substitute this back into the expression for $dw/dt$:\n$$\n\\frac{dw}{dt} = \\mu_{v} I_0 \\left( \\frac{R_{\\mathrm{on}}}{D} \\right)\n$$\nThis is the rate of change of the doped region's width. The problem states that we are in the small-pulse limit where $w$ does not change appreciably during the pulse. Our derived expression for $dw/dt$ is independent of $w$ and is constant for the duration of the current pulse, since $\\mu_{v}$, $I_0$, $R_{\\mathrm{on}}$, and $D$ are all constants. This is fully consistent with the small-pulse limit.\n\nTo find the total change in width, $\\Delta w$, over a single pulse of duration $\\tau$, we integrate $dw/dt$ with respect to time from $t=0$ to $t=\\tau$:\n$$\n\\Delta w = \\int_{0}^{\\tau} \\frac{dw}{dt} dt = \\int_{0}^{\\tau} \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 dt\n$$\nSince the integrand is constant, the integral becomes:\n$$\n\\Delta w = \\left( \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 \\right) \\int_{0}^{\\tau} dt = \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 \\tau\n$$\nThis is the symbolic expression for $\\Delta w$ in terms of the given parameters, $I_0$, and $\\tau$, with the unknown area $A$ successfully eliminated.\n\nThe problem requires a closed-form analytic expression using the provided numerical values. The given values are:\n$\\mu_{v} = 10^{-10}\\,\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})$\n$D = 10\\,\\mathrm{nm} = 10 \\times 10^{-9}\\,\\mathrm{m} = 10^{-8}\\,\\mathrm{m}$\n$R_{\\mathrm{on}} = 1\\,\\mathrm{k}\\Omega = 10^{3}\\,\\Omega$\n\nLet's compute the constant coefficient $\\mu_{v} R_{\\mathrm{on}} / D$:\n$$\n\\frac{\\mu_{v} R_{\\mathrm{on}}}{D} = \\frac{(10^{-10}\\,\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})) \\cdot (10^{3}\\,\\Omega)}{10^{-8}\\,\\mathrm{m}}\n$$\nRecalling that $1\\,\\Omega = 1\\,\\mathrm{V}/\\mathrm{A}$, the units become:\n$$\n\\frac{(\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})) \\cdot (\\mathrm{V}/\\mathrm{A})}{\\mathrm{m}} = \\frac{\\mathrm{m}}{\\mathrm{A} \\cdot \\mathrm{s}}\n$$\nThe numerical value is:\n$$\n\\frac{10^{-10} \\cdot 10^{3}}{10^{-8}} = \\frac{10^{-7}}{10^{-8}} = 10^{1} = 10\n$$\nSo, the coefficient is $10\\,\\mathrm{m}/(\\mathrm{A} \\cdot \\mathrm{s})$.\n\nSubstituting this value back into the expression for $\\Delta w$:\n$$\n\\Delta w = 10 \\, I_0 \\tau\n$$\nThis is the final closed-form analytic expression for $\\Delta w$. If the current $I_0$ is given in Amperes and the pulse width $\\tau$ in seconds, the resulting $\\Delta w$ will be in meters, as required.",
            "answer": "$$\n\\boxed{10 I_{0} \\tau}\n$$"
        },
        {
            "introduction": "Once a conductive filament forms, creating the memristor's low-resistance state, its behavior is not simply that of a bulk material. At the nanoscale, geometry dictates properties. This practice delves into the critical impact of device dimensions on electrical conduction. Using the Drude model and Matthiessen's rule, you will explore how electron scattering from the filament's boundaries enhances its resistivity—a vital size effect that highlights the breakdown of bulk properties in nanoscale devices and is essential for accurate modeling of the ON-state resistance .",
            "id": "4051465",
            "problem": "A Resistive Random Access Memory (RRAM) memristive device in its ON state conducts via a metallic filament of cylindrical cross-section embedded in an oxide. Consider a filament of radius $R$ and length $L$ with conduction dominated by electrons near the Fermi level in a disordered metallic phase. In the bulk metal, the resistivity $\\rho_{0}$ is described by the Drude model, where the conductivity is $\\sigma_{0} = n e^{2} \\tau_{0} / m$ and the resistivity is $\\rho_{0} = m / (n e^{2} \\tau_{0})$. The bulk mean free path is $l = v_{F} \\tau_{0}$, where $v_{F}$ is the Fermi velocity, $n$ is the electron density, $e$ is the elementary charge, $m$ is the effective mass, and $\\tau_{0}$ is the bulk momentum relaxation time due to lattice and impurity scattering. In a nanoscale filament, in addition to bulk scattering, electrons scatter off the filament boundary; this boundary scattering is characterized by a specularity parameter $p \\in [0,1]$, where $p = 1$ denotes perfectly specular reflection and $p = 0$ denotes fully diffusive scattering.\n\nStarting only from the Drude model relations for $\\sigma$ and $\\rho$, the definition of mean free path $l = v_{F} \\tau$, and the principle (Matthiessen’s rule) that independent scattering rates add, derive an analytic expression for the resistivity enhancement factor $\\rho / \\rho_{0}$ in terms of $l$, $R$, and $p$, by estimating the additional boundary scattering rate in a cylindrical filament under the assumption of an isotropic distribution of electron velocities and uniformly distributed electron positions in the cross-section. Use the physically motivated estimate of the average radial speed to the boundary appropriate for a three-dimensional isotropic velocity distribution.\n\nThen, for a realistic ON-state filament in a memristive device with parameters $R = 2\\,\\mathrm{nm}$, $L = 50\\,\\mathrm{nm}$, $l = 10\\,\\mathrm{nm}$, and $p = 0$ (fully diffusive boundary scattering), evaluate the resistivity enhancement factor $\\rho / \\rho_{0}$. Express the final answer as a dimensionless number. No rounding is required; provide the exact value.",
            "solution": "According to the Drude model, the resistivity $\\rho$ is inversely proportional to the momentum relaxation time $\\tau$:\n$$ \\rho = \\frac{m}{n e^2 \\tau} $$\nThe total momentum relaxation time $\\tau$ is determined by all contributing scattering mechanisms. Matthiessen's rule states that the total scattering rate, $1/\\tau$, is the sum of the rates from independent scattering processes. In this case, these are bulk scattering (rate $1/\\tau_0$) and boundary scattering (rate $1/\\tau_b$).\n$$ \\frac{1}{\\tau} = \\frac{1}{\\tau_0} + \\frac{1}{\\tau_b} $$\nThe resistivity enhancement factor is the ratio of the total resistivity $\\rho$ to the bulk resistivity $\\rho_0$:\n$$ \\frac{\\rho}{\\rho_0} = \\frac{m / (n e^2 \\tau)}{m / (n e^2 \\tau_0)} = \\frac{\\tau_0}{\\tau} $$\nSubstituting the expression for $1/\\tau$ from Matthiessen's rule:\n$$ \\frac{\\rho}{\\rho_0} = \\tau_0 \\left( \\frac{1}{\\tau_0} + \\frac{1}{\\tau_b} \\right) = 1 + \\frac{\\tau_0}{\\tau_b} $$\nTo proceed, we must estimate the boundary scattering relaxation time, $\\tau_b$. The rate $1/\\tau_b$ is the effective rate of momentum-randomizing scattering events at the filament's boundary. A collision with the boundary is only effective in randomizing momentum if it is diffusive. The parameter $p$ gives the fraction of specular reflections, so $(1-p)$ is the fraction of diffusive scattering events. The effective boundary scattering rate is:\n$$ \\frac{1}{\\tau_b} = (1-p) \\times (\\text{rate of geometric collisions with the boundary}) $$\nThe rate of geometric collisions, which we denote as $1/\\tau_{coll}$, is the average number of times a single electron collides with the boundary per unit time. This can be estimated by considering the total flux of electrons onto the boundary surface, divided by the total number of electrons in the filament.\n\nFor a filament of radius $R$ and length $L$, the volume is $V = \\pi R^2 L$ and the boundary surface area (of the cylinder wall) is $A = 2\\pi R L$. The total number of conduction electrons is $N_{tot} = nV = n \\pi R^2 L$.\n\nFor an isotropic three-dimensional gas of particles moving at a single speed $v_F$ (as is assumed for electrons at the Fermi energy), the flux of particles $J$ (number per unit area per unit time) onto any surface is given by a standard result from kinetic theory:\n$$ J = \\frac{1}{4} n v_F $$\nThe total number of electrons colliding with the boundary per unit time is the flux multiplied by the boundary area:\n$$ \\frac{dN_{coll}}{dt} = J \\cdot A = \\left(\\frac{1}{4} n v_F\\right) (2\\pi R L) = \\frac{1}{2} n v_F \\pi R L $$\nThe average collision rate per electron, $1/\\tau_{coll}$, is this total rate divided by the total number of electrons, $N_{tot}$:\n$$ \\frac{1}{\\tau_{coll}} = \\frac{dN_{coll}/dt}{N_{tot}} = \\frac{\\frac{1}{2} n v_F \\pi R L}{n \\pi R^2 L} = \\frac{v_F}{2R} $$\nThis result has the correct units of inverse time and shows that the collision rate increases for faster electrons and smaller radii, as expected.\n\nNow, we can find the momentum relaxation rate due to the boundary:\n$$ \\frac{1}{\\tau_b} = (1-p) \\frac{1}{\\tau_{coll}} = (1-p) \\frac{v_F}{2R} $$\nWe substitute this back into the expression for the resistivity enhancement factor:\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{\\tau_0}{\\tau_b} = 1 + \\tau_0 \\left( (1-p) \\frac{v_F}{2R} \\right) $$\nUsing the definition of the bulk mean free path, $l = v_F \\tau_0$, we can replace $\\tau_0$ with $l/v_F$:\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{l}{v_F} \\left( (1-p) \\frac{v_F}{2R} \\right) $$\nThe Fermi velocity $v_F$ cancels out, yielding the final analytical expression for the resistivity enhancement factor:\n$$ \\frac{\\rho}{\\rho_0} = 1 + (1-p) \\frac{l}{2R} $$\nThis expression depends only on the ratio of the bulk mean free path to the filament radius, and on the boundary specularity, which is physically correct.\n\nNow, we evaluate this expression for the given parameters: $R = 2\\,\\mathrm{nm}$, $l = 10\\,\\mathrm{nm}$, and $p = 0$ (fully diffusive scattering).\n$$ \\frac{\\rho}{\\rho_0} = 1 + (1 - 0) \\frac{10\\,\\mathrm{nm}}{2 \\times (2\\,\\mathrm{nm})} $$\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{10}{4} $$\n$$ \\frac{\\rho}{\\rho_0} = 1 + 2.5 $$\n$$ \\frac{\\rho}{\\rho_0} = 3.5 $$\nThe resistivity of the filament is $3.5$ times higher than the bulk resistivity due to the dominant effect of diffusive boundary scattering in the narrow filament.",
            "answer": "$$\\boxed{3.5}$$"
        },
        {
            "introduction": "Bridging the gap between physical theory and practical application requires the development of computationally efficient compact models. This final practice synthesizes the concepts of device physics into a functional, simulatable model. You will construct a complete dynamic model that incorporates key physical behaviors like voltage thresholds and boundary-limited switching, and then test its predictive accuracy. By simulating the model's response to voltage pulses and comparing it to synthetic experimental data using quantitative error metrics, you will engage in the essential engineering task of model validation .",
            "id": "4051518",
            "problem": "You are asked to validate a compact model for a resistive switching memristive device by predicting its electrical response to novel voltage pulse sequences and comparing those predictions with a synthetic experimental dataset using quantitative error metrics. The context is neuromorphic and brain-inspired computing focused on memristive devices and resistive switching at an advanced graduate level.\n\nThe device is modeled using a state-dependent resistor that captures the formation and rupture of a conductive filament. Let the internal state variable be $w \\in [0,1]$ representing the normalized fraction of the low-resistance filament formed, where $w=0$ corresponds to a high-resistance state and $w=1$ corresponds to a low-resistance state.\n\nUse the following foundational bases and well-tested facts:\n\n- Ohm’s law: $i = \\frac{v}{R}$, where $i$ is current in amperes, $v$ is voltage in volts, and $R$ is resistance in ohms.\n- In a state-dependent resistor model of a memristive device, the resistance depends on an internal state variable $w$:\n  $$ R(w) = R_{\\mathrm{on}} \\, w + R_{\\mathrm{off}} \\, (1 - w), $$\n  where $R_{\\mathrm{on}}$ and $R_{\\mathrm{off}}$ are positive constants representing the low-resistance and high-resistance limits, respectively.\n- The internal state variable $w$ evolves due to field-driven drift of mobile ionic species (for example, oxygen vacancies) only when the applied voltage magnitude exceeds material-dependent thresholds. Near the boundaries $w=0$ and $w=1$, the evolution slows to zero.\n\nStarting from these bases, derive a compact, physically consistent, piecewise, thresholded drift model for the state evolution $dw/dt$ that:\n- Is proportional to the above-threshold electric drive,\n- Has opposite polarity behavior for positive versus negative voltages,\n- Includes a smooth window function $F(w)$ with $F(0)=F(1)=0$ to suppress unphysical growth at the boundaries,\n- Respects the bounds $w \\in [0,1]$ for all time.\n\nAssume a window function of the form\n$$ F(w) = 1 - \\left(2w - 1\\right)^{4}, $$\nand introduce positive parameters $\\alpha_{\\mathrm{pos}}$ and $\\alpha_{\\mathrm{neg}}$ (with units chosen to make $w$ dimensionless and time in seconds) as the proportionality constants for the drift under positive and negative drive, respectively, along with positive voltage thresholds $V_{\\mathrm{th,pos}}$ and $V_{\\mathrm{th,neg}}$.\n\nAfter deriving the model, implement a numerical time-integration procedure with a fixed time step $\\Delta t$ to simulate responses to specified voltage pulse sequences. The current should be sampled at the end of each pulse. Clamp the state $w$ after every integration step so that $w$ remains within $[0,1]$.\n\nConstruct synthetic “experimental” currents by applying the same pulses to a “true” device parameter set differing from the prediction model and adding deterministic zero-mean Gaussian noise with a specified standard deviation. Use a fixed random seed to make the noise reproducible.\n\nCompute the following error metrics between the predicted and experimental currents sampled at the end of pulses:\n- Root Mean Square Error (RMSE): \n  $$ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right)^2 }, $$\n- Mean Absolute Error (MAE):\n  $$ \\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right|, $$\nwhere $N$ is the number of pulses in the sequence. Express both $\\mathrm{RMSE}$ and $\\mathrm{MAE}$ in amperes (A) as decimal numbers.\n\nSimulation and parameter specification:\n\n- Time step: $\\Delta t = 10^{-4} \\, \\mathrm{s}$.\n- Prediction model parameters:\n  - $R_{\\mathrm{on}} = 1000 \\, \\Omega$,\n  - $R_{\\mathrm{off}} = 100000 \\, \\Omega$,\n  - $\\alpha_{\\mathrm{pos}} = 80 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $\\alpha_{\\mathrm{neg}} = 60 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $V_{\\mathrm{th,pos}} = 0.9 \\, \\mathrm{V}$,\n  - $V_{\\mathrm{th,neg}} = 0.9 \\, \\mathrm{V}$.\n- True (experimental) model parameters:\n  - $R_{\\mathrm{on,true}} = 1200 \\, \\Omega$,\n  - $R_{\\mathrm{off,true}} = 90000 \\, \\Omega$,\n  - $\\alpha_{\\mathrm{pos,true}} = 100 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $\\alpha_{\\mathrm{neg,true}} = 50 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $V_{\\mathrm{th,pos,true}} = 0.85 \\, \\mathrm{V}$,\n  - $V_{\\mathrm{th,neg,true}} = 0.95 \\, \\mathrm{V}$.\n- Window function exponent is embedded in $F(w)$ as given.\n- Noise: additive zero-mean Gaussian noise with standard deviation $\\sigma = 5 \\times 10^{-7} \\, \\mathrm{A}$; use random seed $42$.\n\nTest suite (each test case specifies an initial state $w_0$ and a list of voltage pulses $(A, \\tau)$ where $A$ is amplitude in volts and $\\tau$ is duration in seconds; sample the current at the end of each pulse):\n\n- Case $1$ (mixed-polarity, includes sub-threshold):\n  - $w_0 = 0.3$,\n  - Pulses: $(1.2, 0.010)$, $(-1.1, 0.008)$, $(0.8, 0.020)$, $(1.5, 0.005)$.\n- Case $2$ (strong set, saturation, followed by sub-threshold reset):\n  - $w_0 = 0.1$,\n  - Pulses: $(2.0, 0.020)$, $(2.0, 0.015)$, $(-0.5, 0.050)$.\n- Case $3$ (mostly sub-threshold, one near-threshold negative pulse):\n  - $w_0 = 0.6$,\n  - Pulses: $(0.7, 0.010)$, $(-0.8, 0.010)$, $(0.85, 0.005)$, $(-0.95, 0.004)$.\n\nYour program must:\n- Derive and implement the compact model,\n- Simulate predicted and experimental currents for each case,\n- Compute $\\mathrm{RMSE}$ and $\\mathrm{MAE}$ for each case (in amperes),\n- Produce a single line of output containing the six numbers as a comma-separated list enclosed in square brackets in the order\n  $$ [\\mathrm{RMSE}_1, \\mathrm{MAE}_1, \\mathrm{RMSE}_2, \\mathrm{MAE}_2, \\mathrm{RMSE}_3, \\mathrm{MAE}_3]. $$\n\nAngles are not applicable. All physical quantities must be handled in the specified units. The final outputs must be in amperes, expressed as decimal numbers.",
            "solution": "We begin with the standard state-dependent resistor framework for resistive switching memristive devices. The instantaneous electrical behavior follows Ohm’s law, where the resistance depends on an internal state variable. Specifically,\n$$ i(t) = \\frac{v(t)}{R\\left(w(t)\\right)}, $$\nwith\n$$ R(w) = R_{\\mathrm{on}} \\, w + R_{\\mathrm{off}} \\, (1 - w), $$\nfor $w \\in [0,1]$, $R_{\\mathrm{on}} > 0$, and $R_{\\mathrm{off}} > 0$. This form represents a convex combination of the low-resistance and high-resistance limits weighted by the filament fraction $w$.\n\nTo model the dynamics of $w$, we appeal to drift of mobile species (for example, oxygen vacancies) under an applied electric field. The drift velocity $v_{\\mathrm{drift}}$ is proportional to the effective driving field above a material-dependent threshold. Below the threshold, the field is insufficient to activate drift through barriers, yielding negligible net evolution. Furthermore, as the filament approaches complete formation ($w \\to 1$) or complete rupture ($w \\to 0$), steric and boundary constraints suppress further evolution. This is captured by a window function $F(w)$ that satisfies $F(0) = F(1) = 0$ and is positive in $(0,1)$.\n\nA minimal, physically consistent, piecewise, thresholded drift model can be written by separating positive and negative polarities. Let $v(t)$ be the applied voltage, $V_{\\mathrm{th,pos}} > 0$ and $V_{\\mathrm{th,neg}} > 0$ be the positive and negative thresholds, and let $\\alpha_{\\mathrm{pos}} > 0$ and $\\alpha_{\\mathrm{neg}} > 0$ scale the rates. Using the specified window function\n$$ F(w) = 1 - \\left(2w - 1\\right)^{4}, $$\nwe write\n$$\n\\frac{dw}{dt} =\n\\begin{cases}\n\\alpha_{\\mathrm{pos}} \\, \\left(v - V_{\\mathrm{th,pos}}\\right) \\, F(w), & v \\ge V_{\\mathrm{th,pos}}, \\\\\n-\\alpha_{\\mathrm{neg}} \\, \\left(|v| - V_{\\mathrm{th,neg}}\\right) \\, F(1 - w), & v \\le -V_{\\mathrm{th,neg}}, \\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThis form ensures that:\n- For sufficiently positive voltage ($v \\ge V_{\\mathrm{th,pos}}$), the filament grows ($dw/dt > 0$) and is suppressed near $w=1$ by $F(w)$.\n- For sufficiently negative voltage ($v \\le -V_{\\mathrm{th,neg}}$), the filament ruptures ($dw/dt < 0$) and is suppressed near $w=0$ via $F(1-w)$.\n- For sub-threshold voltages ($|v| < \\min(V_{\\mathrm{th,pos}}, V_{\\mathrm{th,neg}})$), there is negligible evolution ($dw/dt \\approx 0$).\nThe state variable $w$ must be clamped after each update to remain in the physical interval $[0,1]$.\n\nGiven a voltage pulse of constant amplitude $A$ and duration $\\tau$, and a fixed time step $\\Delta t$, we implement explicit Euler integration:\n$$ w_{n+1} = \\mathrm{clip}\\left( w_n + \\Delta t \\cdot \\frac{dw}{dt}\\bigg|_{v=A,\\, w=w_n}, \\, 0, \\, 1 \\right), $$\niterated for $N = \\left\\lfloor \\frac{\\tau}{\\Delta t} \\right\\rfloor$ steps. At the end of the pulse, the current is sampled as\n$$ i_{\\mathrm{end}} = \\frac{A}{R\\left(w_N\\right)}. $$\n\nThe prediction model uses the calibrated parameters:\n- $R_{\\mathrm{on}} = 1000 \\, \\Omega$,\n- $R_{\\mathrm{off}} = 100000 \\, \\Omega$,\n- $\\alpha_{\\mathrm{pos}} = 80 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $\\alpha_{\\mathrm{neg}} = 60 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $V_{\\mathrm{th,pos}} = 0.9 \\, \\mathrm{V}$,\n- $V_{\\mathrm{th,neg}} = 0.9 \\, \\mathrm{V}$.\n\nThe synthetic experimental currents are generated with the true parameters:\n- $R_{\\mathrm{on,true}} = 1200 \\, \\Omega$,\n- $R_{\\mathrm{off,true}} = 90000 \\, \\Omega$,\n- $\\alpha_{\\mathrm{pos,true}} = 100 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $\\alpha_{\\mathrm{neg,true}} = 50 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $V_{\\mathrm{th,pos,true}} = 0.85 \\, \\mathrm{V}$,\n- $V_{\\mathrm{th,neg,true}} = 0.95 \\, \\mathrm{V}$.\nWe add zero-mean Gaussian noise with standard deviation $\\sigma = 5 \\times 10^{-7} \\, \\mathrm{A}$ using a fixed random seed $42$ to ensure reproducibility:\n$$ i_{\\mathrm{exp}}^{(k)} = i_{\\mathrm{true}}^{(k)} + \\epsilon^{(k)}, \\quad \\epsilon^{(k)} \\sim \\mathcal{N}(0, \\sigma^2). $$\n\nFor each test case, we simulate both the prediction model and the true model under the same pulse sequence, starting from the specified initial condition $w_0$. Currents are sampled at the end of each pulse for both models, and the error metrics are computed:\n$$ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right)^2 }, \\quad\n\\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right|. $$\n\nThe algorithmic steps are:\n- Implement the window function $F(w)$ and the piecewise drift rule for $dw/dt$.\n- Integrate $w$ over each pulse using explicit Euler with clamping.\n- Compute current $i$ at the end of each pulse via Ohm’s law and the state-dependent resistance.\n- Generate the experimental currents with the true parameters and add deterministic Gaussian noise using the fixed seed.\n- Compute $\\mathrm{RMSE}$ and $\\mathrm{MAE}$ for each case.\n- Output a single line with the six numbers $[\\mathrm{RMSE}_1, \\mathrm{MAE}_1, \\mathrm{RMSE}_2, \\mathrm{MAE}_2, \\mathrm{RMSE}_3, \\mathrm{MAE}_3]$ in amperes.\n\nThe test suite covers:\n- A mixed-polarity sequence including sub-threshold pulses to validate threshold behavior and reversibility (Case $1$),\n- Strong positive pulses driving saturation to $w \\approx 1$ and a sub-threshold negative pulse to test boundary clamping and window suppression (Case $2$),\n- Mostly sub-threshold pulses with one near-threshold negative pulse to test sensitivity around the threshold (Case $3$).\n\nThis principle-based derivation aligns with the physics of resistive switching devices and yields a compact model suitable for neuromorphic validation via predictive accuracy metrics in amperes.",
            "answer": "```python\nimport numpy as np\n\n# Model and simulation for memristive device validation via error metrics.\n# Python 3.12, numpy 1.23.5; no other external libraries.\n\ndef window_function(w):\n    # F(w) = 1 - (2w - 1)^4\n    return 1.0 - (2.0 * w - 1.0) ** 4\n\ndef dw_dt(v, w, params):\n    # Piecewise thresholded drift model\n    Vth_pos = params[\"V_th_pos\"]\n    Vth_neg = params[\"V_th_neg\"]\n    alpha_pos = params[\"alpha_pos\"]\n    alpha_neg = params[\"alpha_neg\"]\n    if v >= Vth_pos:\n        return alpha_pos * (v - Vth_pos) * window_function(w)\n    elif v <= -Vth_neg:\n        return -alpha_neg * (abs(v) - Vth_neg) * window_function(1.0 - w)\n    else:\n        return 0.0\n\ndef resistance(w, params):\n    # R(w) = R_on * w + R_off * (1 - w)\n    return params[\"R_on\"] * w + params[\"R_off\"] * (1.0 - w)\n\ndef simulate_pulses(pulses, w0, params, dt):\n    # Simulate over sequence of pulses, sampling current at end of each pulse\n    currents = []\n    w = float(w0)\n    for A, tau in pulses:\n        steps = int(round(tau / dt))\n        for _ in range(steps):\n            w += dt * dw_dt(A, w, params)\n            # Clamp w to [0,1]\n            if w < 0.0:\n                w = 0.0\n            elif w > 1.0:\n                w = 1.0\n        # Current sampled at end of pulse\n        Rw = resistance(w, params)\n        i_end = A / Rw\n        currents.append(i_end)\n    return np.array(currents), w\n\ndef compute_errors(pred, exp):\n    # RMSE and MAE\n    diff = pred - exp\n    rmse = float(np.sqrt(np.mean(diff ** 2)))\n    mae = float(np.mean(np.abs(diff)))\n    return rmse, mae\n\ndef solve():\n    # Time step\n    dt = 1e-4  # seconds\n\n    # Prediction (calibrated) model parameters\n    pred_params = {\n        \"R_on\": 1000.0,        # ohms\n        \"R_off\": 100000.0,     # ohms\n        \"alpha_pos\": 80.0,     # s^-1 V^-1\n        \"alpha_neg\": 60.0,     # s^-1 V^-1\n        \"V_th_pos\": 0.9,       # V\n        \"V_th_neg\": 0.9,       # V\n    }\n\n    # True (experimental) model parameters\n    true_params = {\n        \"R_on\": 1200.0,        # ohms\n        \"R_off\": 90000.0,      # ohms\n        \"alpha_pos\": 100.0,    # s^-1 V^-1\n        \"alpha_neg\": 50.0,     # s^-1 V^-1\n        \"V_th_pos\": 0.85,      # V\n        \"V_th_neg\": 0.95,      # V\n    }\n\n    # Noise specifications\n    sigma_noise = 5e-7  # A\n    rng = np.random.default_rng(42)\n\n    # Test suite: pulses and initial states\n    test_cases = [\n        {\n            \"w0\": 0.3,\n            \"pulses\": [(1.2, 0.010), (-1.1, 0.008), (0.8, 0.020), (1.5, 0.005)],\n        },\n        {\n            \"w0\": 0.1,\n            \"pulses\": [(2.0, 0.020), (2.0, 0.015), (-0.5, 0.050)],\n        },\n        {\n            \"w0\": 0.6,\n            \"pulses\": [(0.7, 0.010), (-0.8, 0.010), (0.85, 0.005), (-0.95, 0.004)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        w0 = case[\"w0\"]\n        pulses = case[\"pulses\"]\n\n        # Predicted currents using calibrated model\n        pred_currents, _ = simulate_pulses(pulses, w0, pred_params, dt)\n\n        # Experimental currents using true model + noise\n        exp_currents, _ = simulate_pulses(pulses, w0, true_params, dt)\n        exp_currents_noisy = exp_currents + rng.normal(0.0, sigma_noise, size=exp_currents.shape)\n\n        rmse, mae = compute_errors(pred_currents, exp_currents_noisy)\n        results.extend([rmse, mae])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}