## 引言
在数据驱动的时代，传统的冯·诺依曼计算架构正面临着日益严峻的“内存墙”挑战——处理器与存储器之间的物理分离导致数据搬运的能耗和延迟成为性能的主要瓶颈。作为一种颠覆性的解决方案，交叉阵列架构通过在存储单元内部直接执行计算（即存内计算），为构建高效的神经形态和AI硬件开辟了新路径。其核心思想是利用物理定律，将大规模的向量-[矩阵乘法](@entry_id:156035)操作从数字逻辑单元迁移到高密度的模拟[存储阵列](@entry_id:174803)中，从而有望实现数量级的能效提升。

然而，从理想的物理概念走向可靠的计算系统，其间充满了挑战。真实世界的物理器件远非完美，其固有的[非线性](@entry_id:637147)、随机性、以及随时间变化的不稳定性，都可能严重侵蚀计算的精度和可靠性。本文旨在系统性地弥合这一理论与实践之间的鸿沟。

我们将在第一章“原理与机制”中，从基础电路定律出发，阐明[交叉阵列](@entry_id:202161)实现[模拟计算](@entry_id:273038)的核心原理，并深入剖析器件[非线性](@entry_id:637147)、潜漏路径、随机噪声和电导漂移等一系列关键的非理想效应及其对系统性能的影响。接下来的“应用与跨学科交叉”章节将视野扩展至系统层面，探讨如何将交叉阵列集成为大规模神经网络加速器，并分析其在架构设计、数据[流管](@entry_id:182650)理、可靠性工程等方面所涉及的跨学科挑战与解决方案。最后，“动手实践”部分将提供一系列精心设计的问题，引导读者运用所学知识解决实际的工程问题。通过这一结构化的学习路径，本文将为读者构建一个关于[交叉阵列](@entry_id:202161)架构从物理基础到系统应用的完整知识框架。

## 原理与机制

本章旨在深入剖析交叉阵列架构的核心工作原理及其在物理实现中所面临的关键挑战。我们将从一个理想化的模型出发，阐明交叉阵列如何通过物理定律实现高效的模拟计算。随后，我们将系统地探讨一系列非理想因素——包括器件[非线性](@entry_id:637147)、寄生泄露路径、工艺涨落和时间不稳定性——并分析它们对计算精度和系统性能的影响。最后，我们将介绍为应对这些挑战而发展的关键架构机制。

### 理想交叉阵列：作为向量-矩阵乘法器的物理实现

[交叉阵列](@entry_id:202161)架构最核心的功能是利用物理定律直接在[存储阵列](@entry_id:174803)内部执行**向量-矩阵乘法（Vector-Matrix Multiplication, VMM）**。为了理解其基本原理，我们首先考虑一个由 $M$ 行（字线）和 $N$ 列（位线）组成的理想化电阻[交叉阵列](@entry_id:202161)。

在每一行 $m$ 和列 $n$ 的交叉点，存在一个导电值为 $G_{mn}$ 的无源线性电导器件。所有这些电导值共同构成了电导矩阵 $\mathbf{G} \in \mathbb{R}^{M \times N}$。假设我们向 $M$ 条字线上施加一个输入电压向量 $\mathbf{V} \in \mathbb{R}^{M}$。每一条位线则连接到一个理想的**[跨阻放大器](@entry_id:275441)（Transimpedance Amplifier, TIA）**。理想 TIA 具备两个关键特性：首先，它在其输入端强制施加一个**[虚地](@entry_id:269132)（virtual ground）**，即无论流入多少电流，位线节点的电压始终被钳位在 $0$ 伏；其次，它能精确测量所有流入该位线的总电流。

现在，我们可以运用基本的电路定律来分析这个系统。考虑位于第 $m$ 行和第 $n$ 列的单个电导器件 $G_{mn}$。根据**[基尔霍夫电压定律](@entry_id:276614)（Kirchhoff's Voltage Law, KVL）**，施加在该器件两端的电压 $v_{mn}$ 等于字线电压 $V_m$ 与位线电压之差。由于位线处于[虚地](@entry_id:269132)状态（$0$ 伏），我们得到 $v_{mn} = V_m - 0 = V_m$。

根据**欧姆定律（Ohm's Law）**，$i = gv$，流过该器件的电流 $i_{mn}$ 为：
$$
i_{mn} = G_{mn} V_m
$$
这条电流从字线流向位线。接下来，我们考虑整条位线 $n$。根据**基尔霍夫电流定律（Kirchhoff's Current Law, KCL）**，流入 TIA 的总电流 $I_n$ 等于所有从不同字线通过各自交叉点器件汇入该位线的电流之和。因此，第 $n$ 条位线的输出电流为：
$$
I_n = \sum_{m=1}^{M} i_{mn} = \sum_{m=1}^{M} G_{mn} V_m
$$
这个方程揭示了交叉阵列计算的核心。输出电流向量 $\mathbf{I} \in \mathbb{R}^{N}$ 的每一个分量 $I_n$ 都是输入电压向量 $\mathbf{V}$ 各分量的加权和，权重即为电导矩阵 $\mathbf{G}$ 的对应列向量。

为了将此关系表达为标准的矩阵形式，我们注意到上述求和操作是矩阵乘法的内在定义。如果我们定义输入为 $M \times 1$ 的列向量 $\mathbf{V}$，输出为 $N \times 1$ 的列向量 $\mathbf{I}$，那么能产生上述结果的矩阵运算是 $\mathbf{G}$ 的[转置](@entry_id:142115)矩阵 $\mathbf{G}^\top$（一个 $N \times M$ 矩阵）与 $\mathbf{V}$ 的乘积。具体来说，乘积 $\mathbf{G}^\top \mathbf{V}$ 的第 $n$ 个元素为：
$$
(\mathbf{G}^\top \mathbf{V})_n = \sum_{m=1}^{M} (\mathbf{G}^\top)_{nm} V_m = \sum_{m=1}^{M} G_{mn} V_m
$$
这与我们通过物理定律推导出的 $I_n$ 完全一致。因此，理想交叉阵列的输入-输出关系可以简洁地表示为  ：
$$
\mathbf{I} = \mathbf{G}^\top \mathbf{V}
$$
这个方程是所有基于[交叉阵列](@entry_id:202161)的[存内计算](@entry_id:1122818)（in-memory computing）应用的理论基石。它表明，通过将权重（例如，神经网络的突触权重）编码为器件的电导值，[交叉阵列](@entry_id:202161)能够以极高的并行度和能量效率，在单次操作中完成一次完整的向量-矩阵乘法。需要注意的是，当输入电压施加于行，电流在列上读取时，所实现的[矩阵乘法](@entry_id:156035)对应的是物理电导矩阵的**[转置](@entry_id:142115)**。反之，若电压施加于列，电流在行上读取，则实现的是与原物理电导矩阵的乘法。

### [交叉阵列](@entry_id:202161)中的非理想效应

理想模型为我们提供了理论基础，但在实际物理系统中，一系列非理想效应会显著影响[交叉阵列](@entry_id:202161)的性能、精度和可扩展性。理解这些效应的原理与机制，对于设计稳健、可靠的神经形态计算硬件至关重要。本章后续将系统探讨以下几类关键的非理想效应：

*   **器件[非线性](@entry_id:637147)与失真**：实际器件的电流-电压（I-V）特性并非完美线性。
*   **寄生潜漏路径（Sneak Paths）**：在无源阵列中，电流会通过非选定单元形成不希望的并联通路。
*   **互连线电阻**：导线的有限电阻会导致[电压降](@entry_id:263648)（IR drop），影响施加在器件上的实际电压。
*   **器件间差异性（Device-to-Device Variability）**：制造过程中的随机涨落导致阵列中各器件的特性存在差异。
*   **时间相关的噪声**：热噪声、[散粒噪声](@entry_id:140025)等[随机过程](@entry_id:268487)会污染信号。
*   **电导漂移（Conductance Drift）**：[非易失性存储器](@entry_id:191738)件的电导值会随时间自发变化。

### 器件[非线性](@entry_id:637147)及其后果

理想模型假设器件是完美的线性导体，但真实器件的 I-V 关系通常是复杂的[非线性](@entry_id:637147)函数，记为 $I(V)$。这种[非线性](@entry_id:637147)从根本上破坏了简单的 VMM 关系 。

#### [线性映射](@entry_id:185132)的破坏

当器件具有[非线性](@entry_id:637147) I-V 特性时，第 $n$ 条位线的总电流变为：
$$
I_n = \sum_{m=1}^{M} I_{mn}(V_m)
$$
其中 $I_{mn}$ 是第 $(m,n)$ 个器件的非[线性响应函数](@entry_id:160418)。这个表达式是输入电压 $V_m$ 的[非线性](@entry_id:637147)函数之和，其结果本身通常不再是输入向量 $\mathbf{V}$ 的线性组合。因此，整个系统的映射关系就不再能用一个固定的[矩阵乘法](@entry_id:156035)来描述，导致计算结果失真。

#### 小信号线性化近似

尽[管存](@entry_id:1127299)在[非线性](@entry_id:637147)，但在某些条件下，我们仍然可以恢复近似的线性运算。如果输入信号是围绕一个直流偏置电压 $V_0$ 的小幅值扰动 $\delta V$，即 $V = V_0 + \delta V$，我们可以对器件的 I-V 曲线在 $V_0$ 点进行[泰勒级数展开](@entry_id:138468)：
$$
I(V_0 + \delta V) = I(V_0) + \left.\frac{dI}{dV}\right|_{V_0} \delta V + \frac{1}{2} \left.\frac{d^2I}{dV^2}\right|_{V_0} (\delta V)^2 + \dots
$$
对于小信号部分，输出电流的扰动 $\delta I$ 可以近似为：
$$
\delta I \approx g(V_0) \delta V
$$
其中 $g(V_0) = \left.\frac{dI}{dV}\right|_{V_0}$ 被称为器件在[偏置点](@entry_id:173374) $V_0$ 的**[微分](@entry_id:158422)电导**。在这种小信号工作区，交叉阵列可以近似实现一个由[微分](@entry_id:158422)电导矩阵决定的线性 VMM。然而，这种近似的精度受限于被忽略的高阶项。主要的[线性化误差](@entry_id:751298)来源于二阶项，其大小与 I-V 曲线的二阶导数（即曲率）以及输入信号幅值的平方 $(\delta V)^2$ 成正比 。

#### 谐波与[互调失真](@entry_id:267789)

器件[非线性](@entry_id:637147)带来的一个具体后果是[信号失真](@entry_id:269932)，尤其是在[模拟信号处理](@entry_id:268125)应用中。当输入为多频[正弦信号](@entry_id:196767)时，[非线性](@entry_id:637147)会产生原始频率中不存在的新频率分量，即**谐波失真**和**[互调失真](@entry_id:267789)**。

例如，考虑一个具有弱三次[非线性](@entry_id:637147)的器件模型，其 I-V 关系可近似为 $i(t) = G v(t) + \beta v^3(t)$ 。如果输入电压 $v(t)$ 是一个包含两个频率 $\omega_u$ 和 $\omega_v$ 的双音信号，那么 $v^3(t)$ 项的展开将产生诸如 $2\omega_u \pm \omega_v$ 和 $2\omega_v \pm \omega_u$ 等频率的**三阶互调（Third-order Intermodulation, IMD3）**产物。这些产物会落在信号频带内，形成难以滤除的干扰。

对于一个由 $K$ 个不同频率 $\omega_m$ 构成的多音输入 $v_i(t) = \sum_{m=1}^{K} a_{im} \cos(\omega_m t + \phi_{im})$，可以推导出在互[调频](@entry_id:162932)率 $\Omega_{uvw} = \omega_u + \omega_v - \omega_w$ 处的总输出电流分量的[复振幅](@entry_id:164138)为：
$$
X_{I,j} = \frac{3}{2} \sum_{i=1}^{M} \beta_{ij} a_{iu} a_{iv} a_{iw} \exp\big(\jmath(\phi_{iu} + \phi_{iv} - \phi_{iw})\big)
$$
此表达式明确显示，[互调失真](@entry_id:267789)的幅度与[非线性系数](@entry_id:1122598) $\beta_{ij}$ 和输入信号的振幅三次方成正比。这为评估和抑制[非线性失真](@entry_id:260858)提供了量化依据 。

### 潜漏路径挑战与架构解决方案

在不含独立选通器件（如晶体管）的**无源[交叉阵列](@entry_id:202161)**中，**潜漏路径（sneak paths）**是限制阵列规模和精度的主要障碍。

#### 潜漏路径问题

当试图读取或写入阵列中的一个特定单元（目标单元）时，需要对相应的行和列施加特定的电压。然而，在无源阵列中，电流不仅会流经目标单元，还会通过大量非选定的单元“潜漏”，形成并联的寄生通路。

一种常见的读出方案是**半选偏置（half-select biasing）**。例如，为了读取位于第 $k$ 行和第 $l$ 列的单元，可以向第 $k$ 行施加 $V_{read}$，将第 $l$ 列接地（$0$ 伏），而所有其他未选中的行和列则被施加一个中间电压，如 $V_{read}/2$。在这种情况下：
*   **选定单元**承受的电压为 $V_{read} - 0 = V_{read}$。
*   **半选定单元**（位于选定行但非选定列，或选定列但非选定行）承受的电压约为 $|V_{read} - V_{read}/2| = V_{read}/2$ 或 $|V_{read}/2 - 0| = V_{read}/2$。
*   **未选定单元**（位于非选定行和非选定列）承受的电压约为 $|V_{read}/2 - V_{read}/2| = 0$。

问题在于，所有半选定单元都承受着不可忽略的电压 $V_{read}/2$，它们产生的潜漏电流会汇集到被测量的位线上，严重干扰对选定单元电流的读取。

#### [非线性](@entry_id:637147)选择器的作用

解决潜漏路径问题的关键在于为每个存储单元串联一个**选择器（selector）**。选择器是一种双端器件，其 I-V 特性具有极强的[非线性](@entry_id:637147)：在低电压下呈现极高的电阻（OFF 态），而当电压超过某个阈值 $V_{th}$ 时，其电阻急剧下降（ON 态）。

我们可以通过一个具体的计算来展示[非线性](@entry_id:637147)选择器的优势 。假设一个半选定单元承受的电压为 $V/2 = 0.5 \text{ V}$。
*   如果该单元是一个**线性电阻**（例如，$R = 100 \text{ k}\Omega$），其潜漏电流为 $I = V/R = 0.5 \text{ V} / 100 \text{ k}\Omega = 5.0 \text{ } \mu\text{A}$。
*   如果该单元是一个具有 $I(V) = I_s \sinh(V/V_0)$ 特性的**[非线性](@entry_id:637147)选择器**（例如，$I_s = 10 \text{ nA}, V_0 = 0.2 \text{ V}$），其潜漏电流为 $I = (10 \text{ nA}) \sinh(0.5/0.4) \approx 0.06 \text{ } \mu\text{A}$。

在这个例子中，[非线性](@entry_id:637147)选择器将半选定状态下的潜漏电流抑制了近两个数量级。这种抑制效应源于其在低电压（$V/2$）下所呈现的极高阻抗。

#### 1S1R 架构

将一个选择器（1S）与一个电阻式存储元件（1R）串联构成的单元，被称为 **1S1R** 架构。这是抑制潜漏路径最有效的无源阵列方案之一 。其工作原理依赖于对选择器阈值 $V_{th}$ 和读出电压 $V_{read}$ 的精心设计。

为了有效工作，必须满足条件：
$$
\frac{V_{read}}{2}  V_{th}  V_{read}
$$
*   对于承受电压为 $V_{read}$ 的**选定单元**，总电压大于 $V_{th}$，足以使选择器导通（进入低阻 ON 态），从而允许一个较大的信号电流流过。该电流近似为 $I_{sel} \approx (V_{read} - V_{th}) / (R_{state} + r_s)$，其中 $R_{state}$ 是存储单元的电阻， $r_s$ 是选择器的导通电阻。
*   对于承受电压为 $V_{read}/2$ 的**半选定单元**，总电压小于 $V_{th}$。由于选择器和电阻分压，选择器自身承受的电压必然也小于 $V_{th}$。因此，选择器保持在极高电阻的 OFF 态，只允许极小的漏电流 $I_{half} \approx G_{leak} (V_{read}/2)$ 流过，其中 $G_{leak}$ 是选择器的泄漏电导。

通过这种方式，1S1R 单元实现了巨大的读出选择比（$I_{sel} / I_{half}$），有效地抑制了来自所有半选定单元的总潜漏电流。

#### 1S1R 与 1T1R 的比较

另一种主流架构是 **1T1R**，即每个存储单元串联一个三端**晶体管（Transistor）**。通过字线控制晶体管的栅极，可以将其作为开关使用：选定行的晶体管导通，而非选定行的晶体管则处于高阻抗的截止状态。

1T1R 和 1S1R 架构在面积、隔离度和[可扩展性](@entry_id:636611)方面存在关键的权衡 ：
*   **面积**：晶体管的版图通常比两端选择器要大。例如，一个典型的 1T1R 单元面积可能为 $12F^2$，而 1S1R 单元可以做到 $8F^2$（$F$ 为工艺特征尺寸），因此 1S1R 具有更高的存储密度。
*   **隔离度**：1T1R 提供了近乎完美的隔离，因为截止状态的晶体管电阻极高，潜漏电流非常小。1S1R 的隔离度则完全依赖于选择器的[非线性](@entry_id:637147)程度和 OFF 态电阻，通常不如 1T1R。
*   **可扩展性**：由于隔离度更优，1T1R 架构可以支持非常大的阵列规模（例如，$N > 1024$）。而对于 1S1R 架构，总潜漏电流会随着阵列规模 $N$ 的增大而累积。为了将总潜漏电流控制在可接受的范围内（例如，小于信号电流的 $\eta$ 倍），选择器的[非线性](@entry_id:637147)度必须满足一个与 $N$ 相关的严格标准。对于一个 $I(V) \propto \exp(\alpha V)$ 的指数型选择器，可以推导出其[非线性](@entry_id:637147)参数 $\alpha$ 必须满足：
    $$
    \alpha \ge \frac{2}{V_{read}} \ln\left(\frac{N-1}{\eta}\right)
    $$
    例如，对于一个 $512 \times 512$ 的阵列，要求潜漏电流不超过信号电流的 $5\%$（$\eta=0.05$），在 $V_{read}=1.0 \text{ V}$ 时，$\alpha$ 需要大于 $18.46 \text{ V}^{-1}$。这个条件对器件工程提出了极高的要求，从而限制了 1S1R 阵列的实际最大规模。

### 随机性非理想效应：差异性与噪声

除了上述确定性的非理想效应外，随机涨落也是影响[交叉阵列](@entry_id:202161)性能的关键因素。

#### 器件间差异性

由于制造工艺的固有随机性，即使设计上完全相同的两个器件，其物理特性（如电导值）也会存在微小差异，这被称为**器件间差异性（Device-to-Device Variability）**。我们可以将实际的电导值 $G_{ij}$ 建模为理想值 $G_{ij}^{\text{ideal}}$ 加上一个随机扰动 ：
$$
G_{ij} = G_{ij}^{\text{ideal}} (1 + \delta_{ij})
$$
其中 $\delta_{ij}$ 是一个[随机变量](@entry_id:195330)，通常假设其服从均值为 $0$、方差为 $\sigma^2$ 的正态分布，即 $\delta_{ij} \sim \mathcal{N}(0, \sigma^2)$。

这种差异性会直接导致 VMM 运算的误差。计算误差向量 $\Delta \mathbf{y} = \mathbf{y} - \mathbf{y}^{\text{ideal}}$ 的统计特性，可以得到：
*   **期望误差**：$\mathbb{E}[\Delta \mathbf{y}] = \mathbf{0}$。这意味着从统计平均上看，这种[随机误差](@entry_id:144890)是无偏的，不会系统性地推高或拉低计算结果。
*   **误差的协方差**：$\mathrm{Cov}(\Delta \mathbf{y}) = \sigma^2 \mathrm{diag}\left(((\mathbf{G}^{\text{ideal}})^{\odot 2})^\top (\mathbf{x}^{\odot 2})\right)$。其中 $\odot 2$ 表示逐元素平方，$\mathrm{diag}(\cdot)$ 表示构建一个对角矩阵。这个结果表明，尽管平均误差为零，但任何单次计算的输出都会有方差（即不确定性）。这个方差不是恒定的，它取决于工艺变化的剧烈程度（$\sigma^2$）、所存储的权重值（$\mathbf{G}^{\text{ideal}}$）以及输入数据（$\mathbf{x}$）。权重和输入值越大，计算结果的[绝对误差](@entry_id:139354)方差也越大。

#### 时间相关的噪声

除了静态的差异性，器件和外围电路中还存在随时间快速涨落的**噪声**。主要的噪声源包括器件本身的[热噪声](@entry_id:139193)和读出电路（如 TIA）的噪声。我们可以将这些噪声源建模为注入到列线上的独立、零均值的随机[电流源](@entry_id:275668) 。

假设每个器件贡献的噪声均方根值为 $i_d$，读出电路贡献的等效输入噪声均方根值为 $i_n$，并且所有噪声源相互**不相关**。当 $M$ 个器件并联到一根列线上时，总噪声电流的功率（或方差）等于各个噪声源功率（或方差）之和。流过终端电阻 $R_s$ 的总噪声电流的均方值为：
$$
\langle i_{\text{total}}^2 \rangle = \sum_{k=1}^M \langle i_k^2 \rangle + \langle i_n^2 \rangle = M i_d^2 + i_n^2
$$
因此，在输出端产生的总噪声功率为：
$$
P_{\text{noise}} = \langle i_{\text{total}}^2 \rangle R_s = (M i_d^2 + i_n^2) R_s
$$
这个关系表明，总输出噪声功率会随着并联器件数量 $M$ 的增加而线性增长。这是限制[交叉阵列](@entry_id:202161)[信噪比](@entry_id:271861)和规模的另一个基本因素。

### 时间不稳定性：电导漂移

对于许多新兴的非易失性存储技术（如**相变存储器，Phase-Change Memory, PCM**），器件的电导值在编程后并不会永久保持不变，而是会随时间发生缓慢的、自发的**漂移（drift）**。

PCM 器件的电导漂移通常遵循一个经验性的幂律关系 ：
$$
G(t) = G_0 \left( \frac{t}{t_0} \right)^{-\nu}
$$
其中 $G_0$ 是在编程后参考时间 $t_0$ 测得的初始电导，$\nu > 0$ 是漂移指数，其值取决于材料和器件状态。

这种漂移对于将交叉阵列用作神经网络推理加速器的应用构成了严重挑战。存储在阵列中的网络权重会随时间衰减，导致推理精度逐渐下降。我们可以量化这种影响。定义在时间 $t$ 的计算误差为 $e(t) = y(t) - y_0$，其中 $y(t)$ 是漂移后的输出，$y_0$ 是初始输出。可以推导出，在一段从 $t_0$ 到 $T$ 的推理时间内，归一化的时间平均[均方误差](@entry_id:175403)为：
$$
\mathcal{R} = 1 + \frac{1}{U-1}\left(\frac{U^{1-2\nu}-1}{1-2\nu} - \frac{2(U^{1-\nu}-1)}{1-\nu}\right)
$$
其中 $U = T/t_0$ 是[无量纲化](@entry_id:136704)的时间跨度。这个表达式定量地描述了计算精度如何随着漂移指数 $\nu$ 和使用时间 $T$ 的增加而恶化。它凸显了在实际应用中，必须考虑周期性的权重刷新或采用对漂移鲁棒的算法来维持系统性能。

综上所述，虽然理想[交叉阵列](@entry_id:202161)提供了一个优雅高效的计算范式，但其物理实现充满了挑战。从器件的[非线性](@entry_id:637147)、潜漏路径，到互连线电阻、随机的工艺差异和噪声，再到长时程的电导漂移，每一种非理想效应都从不同层面影响着系统的精度、功耗和规模。理解这些基本原理与机制，是设计和优化下一代神经形态计算系统的关键所在。