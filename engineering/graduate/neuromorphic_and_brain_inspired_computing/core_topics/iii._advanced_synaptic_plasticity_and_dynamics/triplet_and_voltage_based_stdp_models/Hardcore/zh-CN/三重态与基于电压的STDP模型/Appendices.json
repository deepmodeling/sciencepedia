{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在通过分析一个简化的电压依赖STDP模型，揭示不同脉冲三联体（triplet）模式诱导可塑性效率差异的生物物理机制。您将通过计算关键的生物指标——钙离子内流——来定量比较“前-后-后”与“后-前-前”脉冲序列的效果。这有助于深入理解模型如何通过时间常数的相互作用，对特定的脉冲时间模式产生选择性响应。",
            "id": "4066495",
            "problem": "考虑一个谷氨酸能突触，其在基于电压的脉冲时序依赖可塑性（STDP）范式下，通过 N-甲基-D-天冬氨酸（NMDA）受体门控进行建模。假设通过 NMDA 受体的钙电流 $i_{\\mathrm{Ca}}(t)$ 近似为突触前 NMDA 开放概率与由反向传播动作电位（bAPs）引起的突触后去极化的乘积，即 $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$，其中 $\\gamma > 0$ 是一个常数，$s(t)$ 是突触前 NMDA 通道门控变量，$u(t)$ 是突触后电压依赖因子。在时刻 $\\{t_{k}^{\\mathrm{pre}}\\}$ 的突触前脉冲产生 NMDA 门控 $s(t) = \\sum_{k} \\exp\\!\\big(-(t - t_{k}^{\\mathrm{pre}})/\\tau_{s}\\big)\\, H(t - t_{k}^{\\mathrm{pre}})$，而在时刻 $\\{t_{j}^{\\mathrm{post}}\\}$ 的突触后脉冲产生去极化 $u(t) = \\sum_{j} \\exp\\!\\big(-(t - t_{j}^{\\mathrm{post}})/\\tau_{v}\\big)\\, H(t - t_{j}^{\\mathrm{post}})$，其中 $H(\\cdot)$ 是 Heaviside 阶跃函数，$\\tau_{s} > 0$ 是 NMDA 突触门控时间常数，$\\tau_{v} > 0$ 是突触后去极化时间常数。设三联体序列由一个固定的正时间间隔 $\\Delta > 0$ 分隔：\n- 序列 A (前-后-后)：在 $t = 0$ 时有一个突触前脉冲，在 $t = \\Delta$ 和 $t = 2\\Delta$ 时有两个突触后脉冲。\n- 序列 B (后-前-前)：在 $t = 0$ 时有一个突触后脉冲，在 $t = \\Delta$ 和 $t = 2\\Delta$ 时有两个突触前脉冲。\n\n将一个序列的总钙内流定义为 $I = \\int_{-\\infty}^{\\infty} i_{\\mathrm{Ca}}(t)\\, dt$。从这些定义以及指数函数和 Heaviside 函数的标准性质出发，分别为序列 A 和序列 B 推导出总钙内流 $I_{A}$ 和 $I_{B}$ 的闭式表达式，然后构建比率 $R = I_{A}/I_{B}$，使其成为一个仅含 $\\Delta$、$\\tau_{s}$ 和 $\\tau_{v}$ 的单一解析表达式。在长时程增强（LTP）概率 $P_{\\mathrm{LTP}}$ 是积分钙内流 $I$ 的单调递增函数这一广泛使用的假设下，根据 $R$ 预测哪个序列会产生更高的 LTP 概率。\n\n将你的最终答案表示为 $R$ 的闭式解析表达式。不包括单位。不需要进行数值近似或四舍五入。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题适定、客观，并包含得出唯一解所需的所有必要信息。它基于一个标准的、简化的用于脉冲时序依赖可塑性（STDP）的 NMDA 受体依赖性钙内流模型。\n\n总钙内流 $I$ 定义为钙电流 $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$ 的时间积分。我们将为两个指定的脉冲三联体序列计算此积分。\n\n首先，我们定义一个将出现在我们计算中的公共积分。设积分 $K$ 定义为：\n$$\nK(t_0, \\tau_1, \\tau_2) = \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-(t - t_0)/\\tau_2) dt\n$$\n其中 $t_0 > 0$ 和 $\\tau_1, \\tau_2 > 0$。我们可以如下求解该积分：\n$$\nK = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-t/\\tau_2) dt = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp\\left(-t \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) dt\n$$\n让我们定义一个等效时间常数 $\\tau_{\\mathrm{eff}}$，使得 $\\frac{1}{\\tau_{\\mathrm{eff}}} = \\frac{1}{\\tau_1} + \\frac{1}{\\tau_2} = \\frac{\\tau_1 + \\tau_2}{\\tau_1 \\tau_2}$。\n$$\nK = \\exp(t_0/\\tau_2) \\left[ \\frac{-\\exp(-t/\\tau_{\\mathrm{eff}})}{1/\\tau_{\\mathrm{eff}}} \\right]_{t_0}^{\\infty} = \\exp(t_0/\\tau_2) \\left[ 0 - (-\\tau_{\\mathrm{eff}} \\exp(-t_0/\\tau_{\\mathrm{eff}})) \\right] = \\tau_{\\mathrm{eff}} \\exp(t_0/\\tau_2 - t_0/\\tau_{\\mathrm{eff}})\n$$\n指数部分化简为：\n$$\n\\frac{t_0}{\\tau_2} - \\frac{t_0}{\\tau_{\\mathrm{eff}}} = t_0 \\left(\\frac{1}{\\tau_2} - \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) = t_0 \\left(-\\frac{1}{\\tau_1}\\right) = -\\frac{t_0}{\\tau_1}\n$$\n所以，该积分的一般形式是：\n$$\nK(t_0, \\tau_1, \\tau_2) = \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2} \\exp(-t_0/\\tau_1)\n$$\n\n现在，我们计算序列 A（前-后-后）的总钙内流。\n突触前脉冲发生在 $t_1^{\\mathrm{pre}} = 0$。突触后脉冲发生在 $t_1^{\\mathrm{post}} = \\Delta$ 和 $t_2^{\\mathrm{post}} = 2\\Delta$。\n突触前门控变量为：\n$$\ns_A(t) = \\exp(-t/\\tau_s) H(t)\n$$\n突触后电压因子为：\n$$\nu_A(t) = \\exp(-(t-\\Delta)/\\tau_v) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_v) H(t-2\\Delta)\n$$\n总钙内流 $I_A$ 是它们乘积的积分：\n$$\nI_A = \\int_{-\\infty}^{\\infty} \\gamma\\, s_A(t)\\, u_A(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\exp(-t/\\tau_s) H(t) \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_v}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_v}) H(t-2\\Delta) \\right] dt\n$$\n由于 $\\Delta > 0$，Heaviside 函数简化了积分限：$H(t)H(t-\\Delta) = H(t-\\Delta)$ 和 $H(t)H(t-2\\Delta) = H(t-2\\Delta)$。该积分分裂成两部分：\n$$\nI_A = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-\\Delta)/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-2\\Delta)/\\tau_v) dt \\right]\n$$\n第一个积分是 $K(\\Delta, \\tau_s, \\tau_v)$，第二个是 $K(2\\Delta, \\tau_s, \\tau_v)$。使用我们对 $K$ 的通解：\n$$\nI_A = \\gamma \\left[ \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-\\Delta/\\tau_s) + \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-2\\Delta/\\tau_s) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)\n$$\n\n接下来，我们计算序列 B（后-前-前）的总钙内流。\n突触后脉冲发生在 $t_1^{\\mathrm{post}} = 0$。突触前脉冲发生在 $t_1^{\\mathrm{pre}} = \\Delta$ 和 $t_2^{\\mathrm{pre}} = 2\\Delta$。\n突触前门控变量为：\n$$\ns_B(t) = \\exp(-(t-\\Delta)/\\tau_s) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_s) H(t-2\\Delta)\n$$\n突触后电压因子为：\n$$\nu_B(t) = \\exp(-t/\\tau_v) H(t)\n$$\n总钙内流 $I_B$ 是：\n$$\nI_B = \\int_{-\\infty}^{\\infty} \\gamma\\, s_B(t)\\, u_B(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_s}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_s}) H(t-2\\Delta) \\right] \\exp(-t/\\tau_v) H(t) dt\n$$\n同样，我们分裂该积分：\n$$\nI_B = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-(t-\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-(t-2\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt \\right]\n$$\n第一个积分是 $K(\\Delta, \\tau_v, \\tau_s)$，第二个是 $K(2\\Delta, \\tau_v, \\tau_s)$。注意与序列 A 相比，$\\tau_s$ 和 $\\tau_v$ 的顺序是交换的。\n$$\nI_B = \\gamma \\left[ \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-\\Delta/\\tau_v) + \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-2\\Delta/\\tau_v) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)\n$$\n\n最后，我们计算比率 $R = I_A/I_B$：\n$$\nR = \\frac{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)}{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)}\n$$\n前置因子消去，得到比率的最终表达式：\n$$\nR = \\frac{\\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s)}{\\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v)}\n$$\n\n为了预测哪个序列产生更高的 LTP 概率，我们必须比较 $I_A$ 和 $I_B$，这等价于确定 $R$ 是大于、小于还是等于 1。让我们为 $x > 0$ 定义函数 $f(x) = \\exp(-x) + \\exp(-2x)$。该比率为 $R = f(\\Delta/\\tau_s) / f(\\Delta/\\tau_v)$。$f(x)$ 的导数是 $f'(x) = -\\exp(-x) - 2\\exp(-2x)$，对所有 $x$ 恒为负。因此，$f(x)$ 是一个单调递减函数。\n因此，$f(\\Delta/\\tau_s)$ 和 $f(\\Delta/\\tau_v)$ 的比较取决于它们的自变量 $\\Delta/\\tau_s$ 和 $\\Delta/\\tau_v$ 的比较。由于 $\\Delta > 0$，这取决于 $\\tau_s$ 和 $\\tau_v$ 的相对值。\n\n1.  如果 $\\tau_s > \\tau_v$：则 $1/\\tau_s < 1/\\tau_v$，这意味着 $\\Delta/\\tau_s < \\Delta/\\tau_v$。由于 $f(x)$ 是一个递减函数，所以 $f(\\Delta/\\tau_s) > f(\\Delta/\\tau_v)$。这意味着 $I_A > I_B$ 且 $R > 1$。序列 A（前-后-后）产生更高的 LTP 概率。从生理学上讲，NMDA 门控时间常数 $\\tau_s$（几十到几百毫秒）显著长于反向传播动作电位去极化时间常数 $\\tau_v$（几十毫秒），所以这是最相关的情况。\n2.  如果 $\\tau_s < \\tau_v$：则 $1/\\tau_s > 1/\\tau_v$，所以 $\\Delta/\\tau_s > \\Delta/\\tau_v$。这意味着 $f(\\Delta/\\tau_s) < f(\\Delta/\\tau_v)$，所以 $I_A < I_B$ 且 $R < 1$。序列 B（后-前-前）会产生更高的 LTP 概率。\n3.  如果 $\\tau_s = \\tau_v$：则自变量相等，所以 $f(\\Delta/\\tau_s) = f(\\Delta/\\tau_v)$，这得到 $I_A = I_B$ 且 $R = 1$。LTP 概率将相等。\n\n基于典型的生物物理参数（其中 $\\tau_s > \\tau_v$），该模型预测前-后-后三联体（序列 A）在诱导钙内流并因此诱导 LTP 方面比后-前-前三联体（序列 B）更有效。",
            "answer": "$$\n\\boxed{\\frac{\\exp(-\\frac{\\Delta}{\\tau_{s}}) + \\exp(-\\frac{2\\Delta}{\\tau_{s}})}{\\exp(-\\frac{\\Delta}{\\tau_{v}}) + \\exp(-\\frac{2\\Delta}{\\tau_{v}})}}\n$$"
        },
        {
            "introduction": "将连续时间的微分方程转化为计算机可执行的离散算法，是所有神经形态计算的核心步骤。本练习将指导您为突触痕迹（synaptic trace）的动力学推导一个精确且无条件稳定的事件驱动更新方案。此外，您还将通过分析计算一个简化的欧拉方法所产生的平均误差，从而深刻理解为何精确的指数衰减计算对于模型仿真的准确性至关重要。",
            "id": "4066521",
            "problem": "考虑一个用于三联峰时间依赖可塑性 (STDP) 或基于电压的STDP的单一突触效价迹，其模型为一个在脉冲发放时刻具有脉冲输入的线性泄露常微分方程 (ODE)。设该迹由 $x(t)$ 表示，并遵循以下动力学方程\n$$\n\\frac{dx(t)}{dt}=-\\frac{x(t)}{\\tau}+\\alpha \\sum_{k} \\delta\\!\\left(t-t_{k}\\right),\n$$\n其中 $\\tau>0$ 是时间常数，$\\alpha>0$ 是脉冲处瞬时跳变的幅度，$\\{t_{k}\\}$ 是突触前脉冲发放时间。假设突触前脉冲由速率为 $\\lambda>0$ 的齐次泊松过程生成，因此事件间间隔 $\\Delta t_{k}=t_{k+1}-t_{k}$ 是独立同分布的指数随机变量，其概率密度为 $p_{\\Delta t}(t)=\\lambda \\exp(-\\lambda t)$（对于 $t\\geq 0$）。\n\n仅使用线性时不变一阶常微分方程和分布性脉冲的性质，且不假设任何离散时间公式，执行以下操作：\n\n1. 通过预计算衰减因子 $d_{k}=\\exp(-\\Delta t_{k}/\\tau)$ 并在脉冲到达时应用适当的跳变条件，推导出一个事件驱动的、无条件稳定的离散化方法，用于将 $x(t)$ 从 $t_{k}$ 之后更新到 $t_{k+1}$ 之后。明确证明该更新规则对于任意 $\\Delta t_{k}>0$ 的稳定性。\n\n2. 为了量化用一阶显式欧拉衰减步代替精确指数衰减所产生的离散化误差，定义精确事件间衰减因子 $r_{k}=\\exp(-\\Delta t_{k}/\\tau)$ 和欧拉衰减因子 $q_{k}=1-\\Delta t_{k}/\\tau$。考虑每个间隔的平方乘性误差，\n$$\nE_{k}=\\left(r_{k}-q_{k}\\right)^{2}=\\left(\\exp\\!\\left(-\\frac{\\Delta t_{k}}{\\tau}\\right)-\\left(1-\\frac{\\Delta t_{k}}{\\tau}\\right)\\right)^{2}.\n$$\n计算 $\\Delta t_{k}$ 在指数分布下的期望 $\\mathbb{E}[E_{k}]$，并用 $\\lambda$ 和 $\\tau$ 将最终结果表示为一个闭式解析表达式。\n\n你的最终答案必须是 $\\mathbb{E}[E_{k}]$ 的单一闭式表达式，且不得包含任何单位。无需进行数值四舍五入。",
            "solution": "该问题是有效的。它在科学上基于计算神经科学中广泛使用的线性常微分方程和随机过程的标准理论。问题是适定的，提供了所有必要信息且没有矛盾。它要求进行推导和计算，这两者在数学上都是明确定义的。\n\n解答按问题陈述的要求分为两部分。\n\n### 第1部分：事件驱动更新规则的推导与稳定性\n\n突触迹 $x(t)$ 的动力学由以下线性常微分方程 (ODE) 给出：\n$$\n\\frac{dx(t)}{dt}=-\\frac{x(t)}{\\tau}+\\alpha \\sum_{k} \\delta(t-t_{k})\n$$\n其中 $\\tau > 0$, $\\alpha > 0$，$\\{t_k\\}$ 是突触前脉冲发放时间。\n\n首先，考虑在两个连续脉冲之间的区间 $(t_k, t_{k+1})$ 内的动力学。在此区间内，狄拉克δ函数的求和为零。该常微分方程简化为齐次形式：\n$$\n\\frac{dx(t)}{dt} = -\\frac{x(t)}{\\tau}\n$$\n这是一个线性时不变 (LTI) 一阶常微分方程。令 $x(t_k^+)$ 为 $t_k$ 时刻脉冲刚结束时迹的值。对于 $t \\in [t_k, t_{k+1})$ 且初始条件为 $x(t_k) = x(t_k^+)$ 的解是：\n$$\nx(t) = x(t_k^+) \\exp\\left(-\\frac{t-t_k}{\\tau}\\right)\n$$\n为了找到在下一个脉冲 $t_{k+1}$ 之前瞬间的迹的值，我们在 $t = t_{k+1}$ 处对解求值：\n$$\nx(t_{k+1}^-) = x(t_k^+) \\exp\\left(-\\frac{t_{k+1}-t_k}{\\tau}\\right)\n$$\n将事件间间隔定义为 $\\Delta t_k = t_{k+1} - t_k$，上式变为：\n$$\nx(t_{k+1}^-) = x(t_k^+) \\exp\\left(-\\frac{\\Delta t_k}{\\tau}\\right)\n$$\n\n接下来，我们分析在 $t_{k+1}$ 时刻一个脉冲的影响。项 $\\alpha \\delta(t - t_{k+1})$ 导致一个瞬时跳变。为了找到这个跳变的幅度，我们将完整的常微分方程在 $t_{k+1}$ 附近的一个无穷小区间上进行积分，从 $t_{k+1}-\\epsilon$ 到 $t_{k+1}+\\epsilon$，其中 $\\epsilon \\to 0^+$：\n$$\n\\int_{t_{k+1}-\\epsilon}^{t_{k+1}+\\epsilon} \\frac{dx(t)}{dt} dt = \\int_{t_{k+1}-\\epsilon}^{t_{k+1}+\\epsilon} \\left(-\\frac{x(t)}{\\tau} + \\alpha \\delta(t-t_{k+1})\\right) dt\n$$\n根据微积分基本定理，左边是 $x(t_{k+1}+\\epsilon) - x(t_{k+1}-\\epsilon)$，在极限情况下变为 $x(t_{k+1}^+) - x(t_{k+1}^-)$。\n在右边，第一项的积分是 $\\int -\\frac{x(t)}{\\tau} dt$。由于 $x(t)$ 在小区间内是有界的，当 $\\epsilon \\to 0$ 时，这个积分趋于零。第二项的积分，根据狄拉克δ函数的筛选性质，是：\n$$\n\\int_{t_{k+1}-\\epsilon}^{t_{k+1}+\\epsilon} \\alpha \\delta(t-t_{k+1}) dt = \\alpha\n$$\n令两边相等，得到跳变条件：\n$$\nx(t_{k+1}^+) - x(t_{k+1}^-) = \\alpha \\implies x(t_{k+1}^+) = x(t_{k+1}^-) + \\alpha\n$$\n\n结合脉冲之间的衰减和脉冲到达时的跳变，我们推导出事件驱动的更新规则。令 $x_k \\equiv x(t_k^+)$ 为第 $k$ 个脉冲刚结束时迹的状态。将 $x(t_{k+1}^-)$ 的表达式代入跳变条件，我们得到：\n$$\nx_{k+1} = x_k \\exp\\left(-\\frac{\\Delta t_k}{\\tau}\\right) + \\alpha\n$$\n问题将预计算的衰减因子定义为 $d_k = \\exp(-\\Delta t_k / \\tau)$。因此，更新规则为：\n$$\nx_{k+1} = d_k x_k + \\alpha\n$$\n这就是所要求的事件驱动离散化。\n\n为了证明此更新规则的稳定性，我们考察乘性因子 $d_k$。问题陈述 $\\tau > 0$，且时间的物理性质意味着 $\\Delta t_k > 0$。因此，指数 $-\\Delta t_k/\\tau$ 严格为负。这导致 $d_k$ 有以下界：\n$$\n0 < d_k = \\exp\\left(-\\frac{\\Delta t_k}{\\tau}\\right) < 1\n$$\n该更新规则描述了一个具有时变系数 $d_k$ 的离散时间线性系统。由于对于任何可能的事件间间隔 $\\Delta t_k > 0$，该系数的幅值 $|d_k|$ 都严格小于1，因此系统的齐次部分（$x_{k+1} = d_k x_k$）是一个压缩映射。这确保了任何初始状态都会指数衰减，而不会无界增长。加性输入 $\\alpha$ 确保了迹值收敛到一个有界的平稳分布，而不是收敛到零。系统对于任何 $\\Delta t_k > 0$ 都是一个压缩映射这一事实，使其无条件稳定。\n\n### 第2部分：期望平方误差的计算\n\n我们被要求计算精确指数衰减和一阶欧拉近似之间的平方乘性误差 $E_k$ 的期望。该量为：\n$$\nE_{k}=\\left(\\exp\\left(-\\frac{\\Delta t_{k}}{\\tau}\\right)-\\left(1-\\frac{\\Delta t_{k}}{\\tau}\\right)\\right)^{2}\n$$\n期望 $\\mathbb{E}[E_{k}]$ 是对事件间间隔 $\\Delta t_{k}$ 的分布求得的，这些间隔是独立同分布的指数随机变量，其概率密度函数 (PDF) 为 $p_{\\Delta t}(t) = \\lambda \\exp(-\\lambda t)$ (对于 $t \\ge 0$)。\n\n让我们通过变量替换来简化问题。令 $u_k = \\Delta t_k / \\tau$。由于 $\\Delta t_k$ 是一个随机变量，所以 $u_k$ 也是。为了找到 $u_k$ 的概率密度函数，我们使用概率分布的变量替换公式。令 $t = \\Delta t_k$。那么 $u_k = t/\\tau$，所以 $t = u_k\\tau$ 并且 $dt/du_k = \\tau$。$u_k$ 的概率密度函数是：\n$$\np_u(u) = p_{\\Delta t}(u\\tau) \\left|\\frac{dt}{du}\\right| = \\lambda \\exp(-\\lambda u \\tau) \\cdot \\tau = (\\lambda\\tau) \\exp(-(\\lambda\\tau)u)\n$$\n对于 $u \\geq 0$。令 $z = \\lambda\\tau > 0$。变量 $u_k$ 服从速率为 $z$ 的指数分布，即 $u_k \\sim \\text{Exp}(z)$。我们需要计算的期望是：\n$$\n\\mathbb{E}[E_k] = \\mathbb{E}_{u_k}\\left[\\left(\\exp(-u_k) - (1-u_k)\\right)^2\\right]\n$$\n为简化符号，令 $u = u_k$。我们展开平方项并利用期望的线性性质：\n$$\n\\mathbb{E}[(\\exp(-u) - (1-u))^2] = \\mathbb{E}[\\exp(-2u) + (1-u)^2 - 2(1-u)\\exp(-u)]\n$$\n$$\n= \\mathbb{E}[\\exp(-2u)] + \\mathbb{E}[1 - 2u + u^2] - 2\\mathbb{E}[\\exp(-u)] + 2\\mathbb{E}[u\\exp(-u)]\n$$\n我们逐项计算每个期望。服从 Exp(z) 分布的指数随机变量 $u$ 的矩生成函数 (MGF) 为 $M_u(s) = \\mathbb{E}[\\exp(su)] = \\frac{z}{z-s}$ (对于 $s < z$)。$u$ 的矩为 $\\mathbb{E}[u^n] = n!/z^{n}$。这里有个小错误，$E[u^n]=n!/z^n$ 而不是 $n!/z^{n+1}$。$E[u]=1/z$, $E[u^2]=2/z^2$。这是对的。\n\\begin{itemize}\n    \\item $\\mathbb{E}[1 - 2u + u^2] = 1 - 2\\mathbb{E}[u] + \\mathbb{E}[u^2] = 1 - 2\\left(\\frac{1}{z}\\right) + \\frac{2!}{z^2} = 1 - \\frac{2}{z} + \\frac{2}{z^2}$。\n    \\item $\\mathbb{E}[\\exp(-2u)] = M_u(-2) = \\frac{z}{z - (-2)} = \\frac{z}{z+2}$。\n    \\item $\\mathbb{E}[\\exp(-u)] = M_u(-1) = \\frac{z}{z - (-1)} = \\frac{z}{z+1}$。\n    \\item $\\mathbb{E}[u\\exp(-u)] = \\mathbb{E}\\left[\\frac{d}{ds}\\exp(su)\\Big|_{s=-1}\\right] = \\frac{d}{ds}M_u(s)\\Big|_{s=-1}$。矩生成函数的导数是 $\\frac{d}{ds}\\left(\\frac{z}{z-s}\\right) = \\frac{z}{(z-s)^2}$。在 $s=-1$ 处求值得到 $\\frac{z}{(z+1)^2}$。\n\\end{itemize}\n将这些结果代回 $\\mathbb{E}[E_k]$ 的表达式中：\n$$\n\\mathbb{E}[E_k] = \\left(\\frac{z}{z+2}\\right) + \\left(1 - \\frac{2}{z} + \\frac{2}{z^2}\\right) - 2\\left(\\frac{z}{z+1}\\right) + 2\\left(\\frac{z}{(z+1)^2}\\right)\n$$\n我们现在进行代数化简。首先，我们将各项分组如下：\n$$\n\\mathbb{E}[E_k] = \\left(1 + \\frac{z}{z+2} - \\frac{2z}{z+1}\\right) + \\left(\\frac{2z}{(z+1)^2} - \\frac{2}{z} + \\frac{2}{z^2}\\right)\n$$\n让我们化简第一组项：\n$$\n1 + \\frac{z}{z+2} - \\frac{2z}{z+1} = \\frac{(z+1)(z+2) + z(z+1) - 2z(z+2)}{(z+1)(z+2)} = \\frac{z^2+3z+2 + z^2+z - 2z^2-4z}{(z+1)(z+2)} = \\frac{2}{(z+1)(z+2)}\n$$\n所以，表达式变为：\n$$\n\\mathbb{E}[E_k] = \\frac{2}{(z+1)(z+2)} + \\frac{2z}{(z+1)^2} - \\frac{2}{z} + \\frac{2}{z^2}\n$$\n现在，我们将所有项合并到一个公分母 $z^2(z+1)^2(z+2)$ 上：\n$$\n\\mathbb{E}[E_k] = \\frac{2z^2(z+1) + 2z \\cdot z^2(z+2) - 2z(z+1)^2(z+2) + 2(z+1)^2(z+2)}{z^2(z+1)^2(z+2)}\n$$\n让我们逐项展开分子：\n\\begin{itemize}\n    \\item $2z^2(z+1) = 2z^3 + 2z^2$\n    \\item $2z^3(z+2) = 2z^4 + 4z^3$\n    \\item $-2z(z+1)^2(z+2) = -2z(z^2+2z+1)(z+2) = -2z(z^3+4z^2+5z+2) = -2z^4-8z^3-10z^2-4z$\n    \\item $2(z+1)^2(z+2) = 2(z^2+2z+1)(z+2) = 2(z^3+4z^2+5z+2) = 2z^3+8z^2+10z+4$\n\\end{itemize}\n将分子中的各项相加：\n$$\n(2z^3 + 2z^2) + (2z^4 + 4z^3) + (-2z^4-8z^3-10z^2-4z) + (2z^3+8z^2+10z+4)\n$$\n合并 $z$ 的同次幂项：\n\\begin{itemize}\n    \\item $z^4: 2 - 2 = 0$\n    \\item $z^3: 2 + 4 - 8 + 2 = 0$\n    \\item $z^2: 2 - 10 + 8 = 0$\n    \\item $z^1: -4 + 10 = 6$\n    \\item $z^0: 4$\n\\end{itemize}\n分子简化为 $6z+4$。因此，期望为：\n$$\n\\mathbb{E}[E_k] = \\frac{6z+4}{z^2(z+1)^2(z+2)}\n$$\n最后，我们将 $z = \\lambda\\tau$ 代回，用原始参数 $\\lambda$ 和 $\\tau$ 表示结果：\n$$\n\\mathbb{E}[E_k] = \\frac{6\\lambda\\tau+4}{(\\lambda\\tau)^2(\\lambda\\tau+1)^2(\\lambda\\tau+2)}\n$$",
            "answer": "$$\n\\boxed{\\frac{6\\lambda\\tau + 4}{(\\lambda\\tau)^2(\\lambda\\tau+1)^2(\\lambda\\tau+2)}}\n$$"
        },
        {
            "introduction": "一个成功的计算模型，其最终衡量标准在于能否准确复现真实的实验数据。本练习是一个综合性的编码项目，要求您从头开始实现一个完整的三联体STDP模型。您将使用该模型模拟经典的脉冲对和三联体协议，并将其输出与基准实验数据进行比较，最终通过量化误差来验证模型的有效性。",
            "id": "4066560",
            "problem": "您需要实现并验证一个用于神经形态计算和类脑计算的三联体类别脉冲时间依赖可塑性（STDP）模型。验证过程必须证明，与标准实验数据集进行定量比较时，单一一组拟合的三联体参数能够复现基于脉冲对的STDP时间窗口和三联体脉冲簇增强。所有时间量必须以毫秒表示，所有突触权重变化值均为无量纲。最终程序必须输出单行内容，该行包含一个由方括号括起来的逗号分隔列表，其中包含按以下指定顺序计算的每个测试用例的均方根误差。\n\n从以下基本原理开始：\n- 脉冲时间依赖可塑性（STDP）：突触权重的变化取决于突触前和突触后脉冲的精确时间。\n- 指数衰减的脉冲轨迹：脉冲序列会引发随时间指数衰减的短时和长时轨迹。对于突触前神经元，定义一个时间常数为 $\\tau_{+}$ 的短时轨迹和一个时间常数为 $\\tau_{x}$ 的长时轨迹。对于突触后神经元，定义一个时间常数为 $\\tau_{-}$ 的短时轨迹和一个时间常数为 $\\tau_{y}$ 的长时轨迹。这些轨迹在初始化时为零，并在各自的脉冲事件发生时增加 $1$。\n- 基于事件的更新规则：突触权重在每个脉冲事件发生时瞬时更新。在时间 $t$ 发生突触后脉冲时，长时程增强是突触前短时轨迹及其与该时刻突触后长时轨迹相互作用的函数。在时间 $t$ 发生突触前脉冲时，长时程抑制是突触后短时轨迹及其与该时刻突触前长时轨迹相互作用的函数。在事件之间，轨迹始终根据各自的时间常数连续衰减。\n\n您必须通过按时间顺序处理脉冲事件来实现仿真。在持续时间为 $\\Delta t$ 的两个事件之间，每个轨迹 $z$ 都会按照其对应的 $\\tau$ 进行衰减，即 $z \\leftarrow z \\exp\\left(-\\Delta t / \\tau\\right)$。在突触后脉冲发生时，在增加突触后轨迹之前，使用突触前短时轨迹和突触后长时轨迹的瞬时值来施加增强。在突触前脉冲发生时，在增加突触前轨迹之前，使用突触后短时轨迹和突触前长时轨迹的瞬时值来施加抑制。脉冲对和三联体相互作用的幅度由四个参数给出，这些参数缩放各自的更新贡献。\n\n模型参数化和单位：\n- 突触前短时轨迹时间常数 $\\tau_{+} = 16.8$ ms。\n- 突触后短时轨迹时间常数 $\\tau_{-} = 33.7$ ms。\n- 突触前长时轨迹时间常数 $\\tau_{x} = 101.0$ ms。\n- 突触后长时轨迹时间常数 $\\tau_{y} = 125.0$ ms。\n- 基于脉冲对的增强幅度 $A_{2}^{+} = 0.010$ (无量纲)。\n- 基于脉冲对的抑制幅度 $A_{2}^{-} = 0.012$ (无量纲)。\n- 三联体增强幅度 $A_{3}^{+} = 0.006$ (无量纲)。\n- 三联体抑制幅度 $A_{3}^{-} = 0.004$ (无量纲)。\n\n您还需要验证第二组参数，其中移除了三联体幅度以测试边缘情况下的行为：\n- 时间常数与上述相同，但 $A_{3}^{+} = 0.000$ 且 $A_{3}^{-} = 0.000$。\n\n用于比较的标准实验数据集（无量纲 $\\Delta w$ 值）：\n1. 基于脉冲对的STDP时间窗口数据集，$\\Delta t$ 列表为 $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms，标准 $\\Delta w$ 值为 $[-0.00272,-0.00366,-0.00492,-0.00662,-0.00892,-0.01034,0.00742,0.00551,0.00304,0.00168,0.00092,0.00051]$。\n2. 边界条件脉冲对数据集，$\\Delta t$ 列表为 $[-100,100]$ ms，标准 $\\Delta w$ 值为 $[-0.00062,0.000026]$。\n3. 三联体脉冲簇增强数据集，突触前脉冲在 $0$ ms，突触后脉冲在 $10$ ms 和 $10+\\Delta_{2}$ ms，$\\Delta_{2}$ 列表为 $[5,10,20,40]$ ms。标准总 $\\Delta w$ 值为 $[0.01196,0.01023,0.00805,0.00624]$。\n\n对于基于脉冲对的数据集，协议为一个突触前脉冲和一个突触后脉冲，相对时间为 $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$。对于 $\\Delta t > 0$，使用位于 $0$ ms 的突触前脉冲和位于 $\\Delta t$ ms 的突触后脉冲。对于 $\\Delta t < 0$，使用位于 $0$ ms 的突触后脉冲和位于 $|\\Delta t|$ ms 的突触前脉冲。对于三联体数据集，使用位于 $0$ ms 的突触前脉冲、位于 $10$ ms 的突触后脉冲以及位于 $10+\\Delta_{2}$ ms 的突触后脉冲。\n\n您的程序必须：\n- 实现上述基于事件的三联体STDP模型。\n- 使用 $A_{3}^{+} = 0.006$，$A_{3}^{-} = 0.004$ 的拟合参数集，为每个数据集中的每个时间点生成预测的 $\\Delta w$。\n- 为每个数据集计算预测值与标准值之间的均方根误差（RMSE）。\n- 使用第二组参数（$A_{3}^{+} = 0.000$，$A_{3}^{-} = 0.000$）重复三联体数据集的RMSE计算。\n- 输出单行内容，包含按以下顺序排列的四个RMSE值：脉冲对数据集RMSE（拟合三联体参数）、边界脉冲对数据集RMSE（拟合三联体参数）、三联体数据集RMSE（拟合三联体参数）、三联体数据集RMSE（无三联体参数）。最终输出格式必须是单行，形式为方括号括起来的逗号分隔列表，例如 $[r_{1},r_{2},r_{3},r_{4}]$。\n\n测试套件规范：\n- 案例 $1$（正常路径）：在 $\\Delta t$ 值为 $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms 时，使用拟合的三联体参数进行基于脉冲对的STDP时间窗口测试。\n- 案例 $2$（边界条件）：在极端延迟 $\\Delta t = -100$ ms 和 $\\Delta t = 100$ ms 时，使用拟合的三联体参数进行基于脉冲对的STDP测试。\n- 案例 $3$（三联体增强）：突触前脉冲在 $0$ ms，突触后脉冲在 $10$ ms，突触后脉冲在 $10+\\Delta_{2}$ ms，其中 $\\Delta_{2} \\in \\{5,10,20,40\\}$ ms，使用拟合的三联体参数。\n- 案例 $4$（边缘案例，三联体消融）：与案例 $3$ 相同的协议，但三联体幅度设置为零。\n\n所有输出均为无量纲浮点数，代表RMSE值。不涉及角度，也不需要百分比输出。测试套件必须按所列顺序精确处理，程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。",
            "solution": "用户提供的问题是有效的。它在科学上基于计算神经科学的既定原理，特别是脉冲时间依赖可塑性（STDP）的三联体模型。该问题定义明确，提供了一套完整且一致的参数、定义和实验协议。目标清晰，语言精确无歧义。因此，可以构建一个合理的解决方案。\n\n该问题要求实现并验证一个基于三联体的STDP模型。此模型扩展了经典的基于脉冲对的STDP框架，以考虑高阶脉冲相互作用，这对于复现某些实验观察至关重要，例如可塑性对脉冲频率和脉冲簇时间的依赖性。该模型的核心在于其基于事件的性质以及指数衰减脉冲轨迹的使用。\n\n**1. 模型公式**\n\n突触的状态由其权重 $w$ 和四个内部变量（或称轨迹）描述，这些轨迹追踪突触前和突触后活动的近期历史。对于突触前神经元，我们定义一个短期轨迹 $o_1(t)$ 和一个长期轨迹 $r_1(t)$。同样，对于突触后神经元，我们有一个短期轨迹 $o_2(t)$ 和一个长期轨迹 $r_2(t)$。每个轨迹都由一个一阶线性微分方程控制：\n$$ \\tau_z \\frac{dz(t)}{dt} = -z(t) $$\n其中 $z$ 可以是四个轨迹（$o_1$, $r_1$, $o_2$, $r_2$）中的任意一个，$\\tau_z$ 是其对应的时间常数（$\\tau_{+}$, $\\tau_{x}$, $\\tau_{-}$, $\\tau_{y}$）。\n\n在脉冲发生时，轨迹会瞬时增加 $1$。如果突触前脉冲发生在时间 $t_{pre}$，更新规则为 $o_1(t_{pre}) \\to o_1(t_{pre}^{-}) + 1$ 和 $r_1(t_{pre}) \\to r_1(t_{pre}^{-}) + 1$。如果突触后脉冲发生在时间 $t_{post}$，更新规则为 $o_2(t_{post}) \\to o_2(t_{post}^{-}) + 1$ 和 $r_2(t_{post}) \\to r_2(t_{post}^{-}) + 1$。符号 $t^{-}$ 表示脉冲发生前的瞬间。\n\n在脉冲之间，经过一个时间间隔 $\\Delta t$，每个轨迹都会指数衰减：\n$$ z(t + \\Delta t) = z(t) \\exp\\left(-\\frac{\\Delta t}{\\tau_z}\\right) $$\n\n**2. 突触权重更新规则**\n\n突触权重的变化 $\\Delta w$ 在脉冲发生的瞬间发生。更新规则定义如下：\n\n- **在突触后脉冲时（时间 $t_{post}$）：** 诱发长时程增强（LTP）。权重变化是突触前短期轨迹以及与突触后长期轨迹相互作用的函数。这同时捕捉了脉冲对相互作用（前-后）和三联体相互作用（前-后-后）。\n$$ \\Delta w = o_1(t_{post}^{-}) \\left[ A_{2}^{+} + A_{3}^{+} r_2(t_{post}^{-}) \\right] $$\n在这里，$A_{2}^{+}$ 是基于脉冲对的LTP的幅度，$A_{3}^{+}$ 是基于三联体的LTP的幅度。\n\n- **在突触前脉冲时（时间 $t_{pre}$）：** 诱发长时程抑制（LTD）。权重变化是突触后短期轨迹以及与突触前长期轨迹相互作用的函数。这捕捉了脉冲对相互作用（后-前）和三联体相互作用（后-前-后）。\n$$ \\Delta w = -o_2(t_{pre}^{-}) \\left[ A_{2}^{-} + A_{3}^{-} r_1(t_{pre}^{-}) \\right] $$\n在这里，$A_{2}^{-}$ 是基于脉冲对的LTD的幅度，$A_{3}^{-}$ 是基于三联体的LTD的幅度。\n\n**3. 基于事件的仿真算法**\n\n为了确定给定脉冲序列的总权重变化，我们进行基于事件的仿真。脉冲被视为按时间顺序排列的离散事件。\n\n算法流程如下：\n1. 初始化总权重变化 $\\Delta W_{total} = 0$，所有四个轨迹（$o_1, r_1, o_2, r_2$）为 $0$，以及最后事件时间 $t_{last} = 0$。\n2. 按发生时间对所有突触前和突触后脉冲的列表进行排序。\n3. 遍历排序后的脉冲事件列表。对于每个在时间 $t_{event}$ 发生的事件：\n    a. 计算自上一个事件以来经过的时间：$\\Delta t = t_{event} - t_{last}$。\n    b. 如果 $\\Delta t > 0$，使所有四个轨迹指数衰减：$z \\leftarrow z \\cdot \\exp(-\\Delta t / \\tau_z)$。\n    c. 如果事件是突触后脉冲，使用 $o_1$ 和 $r_2$ 的当前值计算LTP贡献 $\\Delta w_{LTP}$。将其加到总权重变化中：$\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTP}$。然后，增加突触后轨迹：$o_2 \\leftarrow o_2 + 1$ 和 $r_2 \\leftarrow r_2 + 1$。\n    d. 如果事件是突触前脉冲，使用 $o_2$ 和 $r_1$ 的当前值计算LTD贡献 $\\Delta w_{LTD}$。将其加到总权重变化中：$\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTD}$。然后，增加突触前轨迹：$o_1 \\leftarrow o_1 + 1$ 和 $r_1 \\leftarrow r_1 + 1$。\n    e. 更新最后事件时间：$t_{last} \\leftarrow t_{event}$。\n4. 处理完所有脉冲后，最终的 $\\Delta W_{total}$ 即为给定脉冲协议的预测突触权重变化。\n\n**4. 验证与误差计算**\n\n通过将其预测与标准实验数据集进行比较来验证模型。对于每个数据集，针对每个指定的脉冲时间配置运行仿真。然后计算均方根误差（RMSE）以量化模型的预测权重变化（$\\hat{y}_i$）与标准实验值（$y_i$）之间的差异：\n$$ \\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\hat{y}_i - y_i)^2} $$\n其中 $N$ 是集合中数据点的数量。对四个指定的测试用例重复此过程，这些测试用例涉及两组不同的参数集和三个不同的实验协议，以生成所需的四个RMSE值。使用第二组将三联体幅度 $A_3^+$ 和 $A_3^-$ 设置为零的参数集作为对照，以证明三联体项对于复现三联体脉冲簇增强数据是必要的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and validates a triplet-based STDP model against canonical datasets.\n    \"\"\"\n\n    # Define the two parameter sets.\n    params_fitted_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.006, 'A3_minus': 0.004\n    }\n\n    params_no_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.000, 'A3_minus': 0.000\n    }\n\n    # Define canonical experimental datasets.\n    canonical_data = {\n        'pair_window': {\n            'dt': np.array([-50, -40, -30, -20, -10, -5, 5, 10, 20, 30, 40, 50]),\n            'dw': np.array([-0.00272, -0.00366, -0.00492, -0.00662, -0.00892, -0.01034, 0.00742, 0.00551, 0.00304, 0.00168, 0.00092, 0.00051])\n        },\n        'boundary_pair': {\n            'dt': np.array([-100, 100]),\n            'dw': np.array([-0.00062, 0.000026])\n        },\n        'triplet': {\n            'd2': np.array([5, 10, 20, 40]),\n            'dw': np.array([0.01196, 0.01023, 0.00805, 0.00624])\n        }\n    }\n\n    def run_simulation(spikes, params):\n        \"\"\"\n        Runs an event-based simulation for a given spike train and model parameters.\n\n        Args:\n            spikes (list of tuples): A list of (time, type) tuples, where type is 'pre' or 'post'.\n            params (dict): A dictionary of model parameters.\n\n        Returns:\n            float: The total synaptic weight change.\n        \"\"\"\n        # Sort spikes by time to ensure chronological processing.\n        spikes.sort(key=lambda x: x[0])\n        \n        # Initialize traces and total weight change\n        o1, r1, o2, r2 = 0.0, 0.0, 0.0, 0.0  # pre_short, pre_long, post_short, post_long\n        total_dw = 0.0\n        last_event_time = 0.0\n\n        p = params\n\n        for time, spike_type in spikes:\n            delta_t = time - last_event_time\n            \n            if delta_t > 0:\n                # Decay all traces exponentially\n                o1 *= np.exp(-delta_t / p['tau_plus'])\n                r1 *= np.exp(-delta_t / p['tau_x'])\n                o2 *= np.exp(-delta_t / p['tau_minus'])\n                r2 *= np.exp(-delta_t / p['tau_y'])\n            \n            if spike_type == 'post':\n                # Potentiation update\n                dw = o1 * (p['A2_plus'] + p['A3_plus'] * r2)\n                total_dw += dw\n                # Increment postsynaptic traces\n                o2 += 1.0\n                r2 += 1.0\n            \n            elif spike_type == 'pre':\n                # Depression update\n                dw = -o2 * (p['A2_minus'] + p['A3_minus'] * r1)\n                total_dw += dw\n                # Increment presynaptic traces\n                o1 += 1.0\n                r1 += 1.0\n            \n            last_event_time = time\n            \n        return total_dw\n\n    def calculate_rmse(predicted, canonical):\n        return np.sqrt(np.mean((predicted - canonical)**2))\n\n    results = []\n\n    # Case 1: Pair-based STDP window (fitted triplet parameters)\n    predicted_dw_case1 = []\n    for dt in canonical_data['pair_window']['dt']:\n        if dt > 0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case1.append(run_simulation(spikes, params_fitted_triplet))\n    \n    rmse1 = calculate_rmse(np.array(predicted_dw_case1), canonical_data['pair_window']['dw'])\n    results.append(rmse1)\n\n    # Case 2: Boundary pair conditions (fitted triplet parameters)\n    predicted_dw_case2 = []\n    for dt in canonical_data['boundary_pair']['dt']:\n        if dt > 0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case2.append(run_simulation(spikes, params_fitted_triplet))\n\n    rmse2 = calculate_rmse(np.array(predicted_dw_case2), canonical_data['boundary_pair']['dw'])\n    results.append(rmse2)\n\n    # Case 3: Triplet burst potentiation (fitted triplet parameters)\n    predicted_dw_case3 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case3.append(run_simulation(spikes, params_fitted_triplet))\n        \n    rmse3 = calculate_rmse(np.array(predicted_dw_case3), canonical_data['triplet']['dw'])\n    results.append(rmse3)\n\n    # Case 4: Triplet burst potentiation (ablated triplet parameters)\n    predicted_dw_case4 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case4.append(run_simulation(spikes, params_no_triplet))\n        \n    rmse4 = calculate_rmse(np.array(predicted_dw_case4), canonical_data['triplet']['dw'])\n    results.append(rmse4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}