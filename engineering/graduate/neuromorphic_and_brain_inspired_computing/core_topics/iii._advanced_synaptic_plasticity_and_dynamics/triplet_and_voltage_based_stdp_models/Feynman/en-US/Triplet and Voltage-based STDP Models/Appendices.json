{
    "hands_on_practices": [
        {
            "introduction": "The foundation of many advanced plasticity models rests on synaptic traces, which act as a short-term memory of presynaptic and postsynaptic activity. To understand how these models capture complex temporal patterns, we must first master the dynamics of these traces. This exercise () provides a direct calculation of trace evolution in response to a simple spike burst, allowing you to see how different time constants, $\\tau_x$ and $\\tau_y$, shape the system's sensitivity to spike timing.",
            "id": "4066540",
            "problem": "Consider the canonical Spike-Timing-Dependent Plasticity (STDP) triplet model, where presynaptic and postsynaptic activity are tracked by two scalar traces, $x(t)$ and $y(t)$, respectively. In the triplet formulation, these traces are used to construct higher-order temporal sensitivities to spike patterns such as bursts. In voltage-based STDP models, similar traces can gate plasticity with the postsynaptic membrane voltage; here, we focus on the trace dynamics themselves to isolate how time constants shape sensitivity.\n\nAssume the following standard dynamical assumptions for the traces: between spikes, each trace relaxes exponentially with its own time constant, and at the arrival of a spike, the corresponding trace jumps by a fixed increment. Specifically, for presynaptic spikes with times $\\{t_{k}^{\\mathrm{pre}}\\}$ and postsynaptic spikes with times $\\{t_{m}^{\\mathrm{post}}\\}$, the traces obey $x(0^{-}) = 0$, $y(0^{-}) = 0$, and for $t \\geq 0$,\n- between spikes, $\\frac{dx}{dt} = -\\frac{x}{\\tau_{x}}$ and $\\frac{dy}{dt} = -\\frac{y}{\\tau_{y}}$,\n- at each presynaptic spike time $t_{k}^{\\mathrm{pre}}$, $x(t_{k}^{\\mathrm{pre},+}) = x(t_{k}^{\\mathrm{pre},-}) + a_{x}$,\n- at each postsynaptic spike time $t_{m}^{\\mathrm{post}}$, $y(t_{m}^{\\mathrm{post},+}) = y(t_{m}^{\\mathrm{post},-}) + a_{y}$,\nwith fixed increments $a_{x} = 1$ and $a_{y} = 1$.\n\nConsider a simple burst train designed to probe the sensitivity of the model to short interspike intervals and longer gaps: presynaptic spikes occur at times $t = 0\\,\\mathrm{ms}$, $t = 4\\,\\mathrm{ms}$, $t = 8\\,\\mathrm{ms}$ (a burst of $3$ spikes), and $t = 40\\,\\mathrm{ms}$ (an isolated spike); postsynaptic spikes occur at times $t = 9\\,\\mathrm{ms}$ and $t = 44\\,\\mathrm{ms}$. Treat the trace amplitudes as dimensionless.\n\nStarting from the above dynamical assumptions, derive closed-form expressions for $x(t)$ and $y(t)$ for $t \\geq 0$. Then, to make the dependence on the time constants explicit, evaluate the ratio $R(t^{*}) = \\frac{y(t^{*})}{x(t^{*})}$ at the specific time $t^{*} = 12\\,\\mathrm{ms}$.\n\nExpress the final ratio $R(t^{*})$ as a single closed-form analytic expression in terms of $\\tau_{x}$ and $\\tau_{y}$. The final answer must be dimensionless. No numerical rounding is required.",
            "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It describes a canonical model of synaptic trace dynamics, a fundamental concept in computational neuroscience. The task is to determine the state of these traces at a specific time given a sequence of events.\n\nThe dynamics of both traces $x(t)$ and $y(t)$ are described by first-order linear ordinary differential equations with constant coefficients, punctuated by instantaneous jumps at specified times. The general solution for a trace $z(t)$ governed by $\\frac{dz}{dt} = -\\frac{z}{\\tau_z}$ with an initial condition $z(t_0) = z_0$ is $z(t) = z_0 \\exp\\left(-\\frac{t-t_0}{\\tau_z}\\right)$ for $t  t_0$.\n\nDue to the linearity of the system, the value of a trace at any time $t$ is the sum of the decaying influences of all past spikes. For a trace $z(t)$ with jump amplitude $a_z$ at spike times $\\{t_i\\}$, starting from $z(0^-)=0$, the solution can be expressed as a superposition:\n$$z(t) = \\sum_{t_i  t} a_z \\exp\\left(-\\frac{t - t_i}{\\tau_z}\\right)$$\n\nWe are asked to evaluate the ratio $R(t^{*}) = \\frac{y(t^{*})}{x(t^{*})}$ at the specific time $t^{*} = 12\\,\\mathrm{ms}$. We will calculate $x(t^{*})$ and $y(t^{*})$ separately.\n\nFirst, we determine the value of the presynaptic trace $x(t)$ at $t^{*} = 12$. The presynaptic spikes $\\{t_{k}^{\\mathrm{pre}}\\}$ occur at times $t = 0\\,\\mathrm{ms}$, $t = 4\\,\\mathrm{ms}$, $t = 8\\,\\mathrm{ms}$, and $t = 40\\,\\mathrm{ms}$. The increment is $a_x = 1$. Only spikes occurring before $t^{*} = 12$ will contribute to $x(12)$. These spikes are at $t=0$, $t=4$, and $t=8$.\n\nUsing the superposition principle, we sum the contributions from each of these three spikes:\n$$x(t^{*}) = x(12) = a_x \\exp\\left(-\\frac{12 - 0}{\\tau_x}\\right) + a_x \\exp\\left(-\\frac{12 - 4}{\\tau_x}\\right) + a_x \\exp\\left(-\\frac{12 - 8}{\\tau_x}\\right)$$\nSubstituting $a_x = 1$ and simplifying the time differences:\n$$x(12) = \\exp\\left(-\\frac{12}{\\tau_x}\\right) + \\exp\\left(-\\frac{8}{\\tau_x}\\right) + \\exp\\left(-\\frac{4}{\\tau_x}\\right)$$\n\nNext, we determine the value of the postsynaptic trace $y(t)$ at $t^{*} = 12$. The postsynaptic spikes $\\{t_{m}^{\\mathrm{post}}\\}$ occur at times $t = 9\\,\\mathrm{ms}$ and $t = 44\\,\\mathrm{ms}$. The increment is $a_y = 1$. Only spikes occurring before $t^{*} = 12$ will contribute to $y(12)$. The only such spike is at $t=9$.\n\nUsing the superposition principle for the $y$ trace:\n$$y(t^{*}) = y(12) = a_y \\exp\\left(-\\frac{12 - 9}{\\tau_y}\\right)$$\nSubstituting $a_y = 1$ and simplifying the time difference:\n$$y(12) = \\exp\\left(-\\frac{3}{\\tau_y}\\right)$$\n\nFinally, we compute the ratio $R(t^{*}) = R(12)$.\n$$R(12) = \\frac{y(12)}{x(12)} = \\frac{\\exp\\left(-\\frac{3}{\\tau_y}\\right)}{\\exp\\left(-\\frac{12}{\\tau_x}\\right) + \\exp\\left(-\\frac{8}{\\tau_x}\\right) + \\exp\\left(-\\frac{4}{\\tau_x}\\right)}$$\nThis is the final closed-form expression for the ratio in terms of the time constants $\\tau_x$ and $\\tau_y$. The expression is dimensionless, as both $x(t)$ and $y(t)$ are dimensionless.",
            "answer": "$$\\boxed{\\frac{\\exp\\left(-\\frac{3}{\\tau_{y}}\\right)}{\\exp\\left(-\\frac{12}{\\tau_{x}}\\right) + \\exp\\left(-\\frac{8}{\\tau_{x}}\\right) + \\exp\\left(-\\frac{4}{\\tau_{x}}\\right)}}$$"
        },
        {
            "introduction": "Moving from abstract dynamics to biophysical mechanisms, voltage-based STDP models provide a compelling link between spike timing and the underlying cellular processes of plasticity. A central hypothesis is that long-term potentiation (LTP) is triggered by calcium influx through NMDA receptors, which are gated by both presynaptic glutamate and postsynaptic depolarization. This practice () challenges you to model this process for different spike triplet sequences, revealing how the asymmetry in synaptic and voltage decay times dictates which patterns are most effective for inducing plasticity.",
            "id": "4066495",
            "problem": "Consider a single glutamatergic synapse modeled with N-methyl-D-aspartate (NMDA) receptor gating under a voltage-based Spike-Timing-Dependent Plasticity (STDP) paradigm. Assume the calcium current $i_{\\mathrm{Ca}}(t)$ through NMDA receptors is approximated as the product of presynaptic NMDA open probability and postsynaptic depolarization caused by backpropagating action potentials (bAPs), namely $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$, where $\\gamma  0$ is a constant, $s(t)$ is the presynaptic NMDA channel gating variable, and $u(t)$ is the postsynaptic voltage-dependent factor. Presynaptic spikes at times $\\{t_{k}^{\\mathrm{pre}}\\}$ produce NMDA gating $s(t) = \\sum_{k} \\exp\\!\\big(-(t - t_{k}^{\\mathrm{pre}})/\\tau_{s}\\big)\\, H(t - t_{k}^{\\mathrm{pre}})$, and postsynaptic spikes at times $\\{t_{j}^{\\mathrm{post}}\\}$ produce depolarization $u(t) = \\sum_{j} \\exp\\!\\big(-(t - t_{j}^{\\mathrm{post}})/\\tau_{v}\\big)\\, H(t - t_{j}^{\\mathrm{post}})$, where $H(\\cdot)$ is the Heaviside step function, $\\tau_{s}  0$ is the NMDA synaptic gating time constant, and $\\tau_{v}  0$ is the postsynaptic depolarization time constant. Let the triplet sequences be separated by a fixed positive interval $\\Delta  0$:\n- Sequence A (pre–post–post): one presynaptic spike at $t = 0$ and two postsynaptic spikes at $t = \\Delta$ and $t = 2\\Delta$.\n- Sequence B (post–pre–pre): one postsynaptic spike at $t = 0$ and two presynaptic spikes at $t = \\Delta$ and $t = 2\\Delta$.\n\nDefine the total calcium influx for a sequence as $I = \\int_{-\\infty}^{\\infty} i_{\\mathrm{Ca}}(t)\\, dt$. Starting from these definitions and standard properties of exponentials and the Heaviside function, derive closed-form expressions for the total calcium influx $I_{A}$ and $I_{B}$ for Sequence A and Sequence B, respectively, and then form the ratio $R = I_{A}/I_{B}$ as a single analytic expression in terms of $\\Delta$, $\\tau_{s}$, and $\\tau_{v}$. Under the widely used assumption that the Long-Term Potentiation (LTP) probability $P_{\\mathrm{LTP}}$ is a monotonically increasing function of the integrated calcium influx $I$, predict which sequence yields higher LTP probability based on $R$.\n\nExpress your final answer as the closed-form analytic expression for $R$. Do not include units. No numerical approximation or rounding is required.",
            "solution": "The problem is evaluated to be valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is based on a standard, simplified model of NMDA receptor-dependent calcium influx for Spike-Timing-Dependent Plasticity (STDP).\n\nThe total calcium influx $I$ is defined as the time integral of the calcium current $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$. We will compute this integral for the two specified spike triplet sequences.\n\nFirst, we define a common integral that will appear in our calculations. Let an integral $K$ be defined as:\n$$\nK(t_0, \\tau_1, \\tau_2) = \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-(t - t_0)/\\tau_2) dt\n$$\nwhere $t_0  0$ and $\\tau_1, \\tau_2  0$. We can solve this integral as follows:\n$$\nK = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-t/\\tau_2) dt = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp\\left(-t \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) dt\n$$\nLet's define an effective time constant $\\tau_{\\mathrm{eff}}$ such that $\\frac{1}{\\tau_{\\mathrm{eff}}} = \\frac{1}{\\tau_1} + \\frac{1}{\\tau_2} = \\frac{\\tau_1 + \\tau_2}{\\tau_1 \\tau_2}$.\n$$\nK = \\exp(t_0/\\tau_2) \\left[ \\frac{-\\exp(-t/\\tau_{\\mathrm{eff}})}{1/\\tau_{\\mathrm{eff}}} \\right]_{t_0}^{\\infty} = \\exp(t_0/\\tau_2) \\left[ 0 - (-\\tau_{\\mathrm{eff}} \\exp(-t_0/\\tau_{\\mathrm{eff}})) \\right] = \\tau_{\\mathrm{eff}} \\exp(t_0/\\tau_2 - t_0/\\tau_{\\mathrm{eff}})\n$$\nThe exponent simplifies to:\n$$\n\\frac{t_0}{\\tau_2} - \\frac{t_0}{\\tau_{\\mathrm{eff}}} = t_0 \\left(\\frac{1}{\\tau_2} - \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) = t_0 \\left(-\\frac{1}{\\tau_1}\\right) = -\\frac{t_0}{\\tau_1}\n$$\nSo, the general form of the integral is:\n$$\nK(t_0, \\tau_1, \\tau_2) = \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2} \\exp(-t_0/\\tau_1)\n$$\n\nNow, we calculate the total calcium influx for Sequence A (pre-post-post).\nThe presynaptic spike occurs at $t_1^{\\mathrm{pre}} = 0$. The postsynaptic spikes occur at $t_1^{\\mathrm{post}} = \\Delta$ and $t_2^{\\mathrm{post}} = 2\\Delta$.\nThe presynaptic gating variable is:\n$$\ns_A(t) = \\exp(-t/\\tau_s) H(t)\n$$\nThe postsynaptic voltage factor is:\n$$\nu_A(t) = \\exp(-(t-\\Delta)/\\tau_v) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_v) H(t-2\\Delta)\n$$\nThe total calcium influx $I_A$ is the integral of their product:\n$$\nI_A = \\int_{-\\infty}^{\\infty} \\gamma\\, s_A(t)\\, u_A(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\exp(-t/\\tau_s) H(t) \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_v}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_v}) H(t-2\\Delta) \\right] dt\n$$\nSince $\\Delta  0$, the Heaviside functions simplify the integration limits: $H(t)H(t-\\Delta) = H(t-\\Delta)$ and $H(t)H(t-2\\Delta) = H(t-2\\Delta)$. The integral splits into two parts:\n$$\nI_A = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-\\Delta)/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-2\\Delta)/\\tau_v) dt \\right]\n$$\nThe first integral is $K(\\Delta, \\tau_s, \\tau_v)$, and the second is $K(2\\Delta, \\tau_s, \\tau_v)$. Using our general solution for $K$:\n$$\nI_A = \\gamma \\left[ \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-\\Delta/\\tau_s) + \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-2\\Delta/\\tau_s) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)\n$$\n\nNext, we calculate the total calcium influx for Sequence B (post-pre-pre).\nThe postsynaptic spike occurs at $t_1^{\\mathrm{post}} = 0$. The presynaptic spikes occur at $t_1^{\\mathrm{pre}} = \\Delta$ and $t_2^{\\mathrm{pre}} = 2\\Delta$.\nThe presynaptic gating variable is:\n$$\ns_B(t) = \\exp(-(t-\\Delta)/\\tau_s) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_s) H(t-2\\Delta)\n$$\nThe postsynaptic voltage factor is:\n$$\nu_B(t) = \\exp(-t/\\tau_v) H(t)\n$$\nThe total calcium influx $I_B$ is:\n$$\nI_B = \\int_{-\\infty}^{\\infty} \\gamma\\, s_B(t)\\, u_B(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_s}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_s}) H(t-2\\Delta) \\right] \\exp(-t/\\tau_v) H(t) dt\n$$\nAgain, we split the integral:\n$$\nI_B = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-(t-\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-(t-2\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt \\right]\n$$\nThe first integral is $K(\\Delta, \\tau_v, \\tau_s)$, and the second is $K(2\\Delta, \\tau_v, \\tau_s)$. Note the swapped order of $\\tau_s$ and $\\tau_v$ compared to Sequence A.\n$$\nI_B = \\gamma \\left[ \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-\\Delta/\\tau_v) + \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-2\\Delta/\\tau_v) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)\n$$\n\nFinally, we compute the ratio $R = I_A/I_B$:\n$$\nR = \\frac{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)}{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)}\n$$\nThe prefactors cancel, yielding the final expression for the ratio:\n$$\nR = \\frac{\\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s)}{\\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v)}\n$$\n\nTo predict which sequence yields a higher LTP probability, we must compare $I_A$ and $I_B$, which is equivalent to determining if $R$ is greater than, less than, or equal to $1$. Let's define the function $f(x) = \\exp(-x) + \\exp(-2x)$ for $x  0$. The ratio is $R = f(\\Delta/\\tau_s) / f(\\Delta/\\tau_v)$. The derivative of $f(x)$ is $f'(x) = -\\exp(-x) - 2\\exp(-2x)$, which is strictly negative for all $x$. Thus, $f(x)$ is a monotonically decreasing function.\nThe comparison of $f(\\Delta/\\tau_s)$ and $f(\\Delta/\\tau_v)$ therefore depends on the comparison of their arguments, $\\Delta/\\tau_s$ and $\\Delta/\\tau_v$. Since $\\Delta  0$, this is determined by the relative values of $\\tau_s$ and $\\tau_v$.\n\n1.  If $\\tau_s  \\tau_v$: Then $1/\\tau_s  1/\\tau_v$, which implies $\\Delta/\\tau_s  \\Delta/\\tau_v$. Since $f(x)$ is a decreasing function, $f(\\Delta/\\tau_s)  f(\\Delta/\\tau_v)$. This means $I_A  I_B$ and $R  1$. Sequence A (pre-post-post) yields a higher LTP probability. Physiologically, the NMDA gating time constant $\\tau_s$ (tens to hundreds of ms) is significantly longer than the backpropagating action potential depolarization time constant $\\tau_v$ (tens of ms), so this is the most relevant case.\n2.  If $\\tau_s  \\tau_v$: Then $1/\\tau_s  1/\\tau_v$, so $\\Delta/\\tau_s  \\Delta/\\tau_v$. This implies $f(\\Delta/\\tau_s)  f(\\Delta/\\tau_v)$, so $I_A  I_B$ and $R  1$. Sequence B (post-pre-pre) would yield a higher LTP probability.\n3.  If $\\tau_s = \\tau_v$: Then the arguments are equal, so $f(\\Delta/\\tau_s) = f(\\Delta/\\tau_v)$, which gives $I_A = I_B$ and $R = 1$. The LTP probabilities would be equal.\n\nBased on the typical biophysical parameters where $\\tau_s  \\tau_v$, the model predicts that the pre-post-post triplet (Sequence A) is more effective at inducing calcium influx and thus LTP than the post-pre-pre triplet (Sequence B).",
            "answer": "$$\n\\boxed{\\frac{\\exp(-\\frac{\\Delta}{\\tau_{s}}) + \\exp(-\\frac{2\\Delta}{\\tau_{s}})}{\\exp(-\\frac{\\Delta}{\\tau_{v}}) + \\exp(-\\frac{2\\Delta}{\\tau_{v}})}}\n$$"
        },
        {
            "introduction": "A computational model's true value is demonstrated by its ability to explain and predict experimental findings. This capstone practice () bridges the gap between theory and application by guiding you through the implementation and validation of a complete triplet STDP model. By simulating the model's response to canonical spike-pairing and triplet protocols, you will quantitatively assess its power to unify diverse experimental results under a single, coherent framework.",
            "id": "4066560",
            "problem": "You are to implement and validate a Spike-Timing-Dependent Plasticity (STDP) model of the triplet class used in neuromorphic and brain-inspired computing. The validation must demonstrate that a single set of fitted triplet parameters reproduces both pair-based STDP timing windows and triplet burst potentiation when compared quantitatively to canonical experimental datasets. All time quantities must be expressed in milliseconds, and all synaptic weight change values are dimensionless. The final program must output a single line containing a comma-separated list enclosed in square brackets of the computed root-mean-square errors for each test case in the order specified below.\n\nBegin from the following fundamental base:\n- Spike-Timing-Dependent Plasticity (STDP): Synaptic weight change depends on the precise timing of pre- and postsynaptic spikes.\n- Exponentially decaying spike traces: A spike trains gates short and long traces that decay exponentially over time. For the presynaptic neuron, define a short trace with time constant $\\tau_{+}$ and a long trace with time constant $\\tau_{x}$. For the postsynaptic neuron, define a short trace with time constant $\\tau_{-}$ and a long trace with time constant $\\tau_{y}$. These traces are zero at initialization and are incremented by $1$ at their respective spike events.\n- Event-based update rule: Synaptic weight updates occur instantaneously at each spike event. At a postsynaptic spike at time $t$, long-term potentiation is a function of the presynaptic short trace and its interaction with the postsynaptic long trace at that moment. At a presynaptic spike at time $t$, long-term depression is a function of the postsynaptic short trace and its interaction with the presynaptic long trace at that moment. Traces always decay continuously between events according to their respective time constants.\n\nYou must implement the simulation by processing spike events in chronological order. Between events separated by a duration $\\Delta t$, each trace $z$ decays as $z \\leftarrow z \\exp\\left(-\\Delta t / \\tau\\right)$ for its corresponding $\\tau$. At a postsynaptic spike, apply potentiation using the instantaneous values of the presynaptic short trace and the postsynaptic long trace before incrementing the postsynaptic traces. At a presynaptic spike, apply depression using the instantaneous values of the postsynaptic short trace and the presynaptic long trace before incrementing the presynaptic traces. The amplitudes for pair and triplet interactions are given by four parameters that scale the respective update contributions.\n\nModel parameterization and units:\n- Presynaptic short trace time constant $\\tau_{+} = 16.8$ ms.\n- Postsynaptic short trace time constant $\\tau_{-} = 33.7$ ms.\n- Presynaptic long trace time constant $\\tau_{x} = 101.0$ ms.\n- Postsynaptic long trace time constant $\\tau_{y} = 125.0$ ms.\n- Pair-based potentiation amplitude $A_{2}^{+} = 0.010$ (dimensionless).\n- Pair-based depression amplitude $A_{2}^{-} = 0.012$ (dimensionless).\n- Triplet potentiation amplitude $A_{3}^{+} = 0.006$ (dimensionless).\n- Triplet depression amplitude $A_{3}^{-} = 0.004$ (dimensionless).\n\nYou will also validate a second parameter set in which triplet amplitudes are removed to test edge-case behavior:\n- Same time constants as above, with $A_{3}^{+} = 0.000$ and $A_{3}^{-} = 0.000$.\n\nCanonical experimental datasets to be used for comparison (dimensionless $\\Delta w$ values):\n1. Pair-based STDP window dataset with $\\Delta t$ list $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms, canonical $\\Delta w$ values $[-0.00272,-0.00366,-0.00492,-0.00662,-0.00892,-0.01034,0.00742,0.00551,0.00304,0.00168,0.00092,0.00051]$.\n2. Boundary-condition pair dataset with $\\Delta t$ list $[-100,100]$ ms, canonical $\\Delta w$ values $[-0.00062,0.000026]$.\n3. Triplet burst potentiation dataset with presynaptic spike at $0$ ms, postsynaptic spikes at $10$ ms and $10+\\Delta_{2}$ ms, and $\\Delta_{2}$ list $[5,10,20,40]$ ms. Canonical total $\\Delta w$ values are $[0.01196,0.01023,0.00805,0.00624]$.\n\nFor pair-based datasets, the protocol is one presynaptic spike and one postsynaptic spike with relative timing $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$. For $\\Delta t > 0$, use presynaptic at $0$ ms and postsynaptic at $\\Delta t$ ms. For $\\Delta t  0$, use postsynaptic at $0$ ms and presynaptic at $|\\Delta t|$ ms. For the triplet dataset, use presynaptic at $0$ ms, postsynaptic at $10$ ms, and postsynaptic at $10+\\Delta_{2}$ ms.\n\nYour program must:\n- Implement the event-based triplet STDP model described above.\n- Produce predicted $\\Delta w$ for each time point in each dataset using the fitted parameter set with $A_{3}^{+} = 0.006$, $A_{3}^{-} = 0.004$.\n- Compute the root-mean-square error (RMSE) between predicted values and canonical values for each dataset.\n- Repeat the triplet dataset RMSE computation using the second parameter set with $A_{3}^{+} = 0.000$, $A_{3}^{-} = 0.000$.\n- Output a single line containing the four RMSE values in the order: pair dataset RMSE (fitted triplet), boundary pair dataset RMSE (fitted triplet), triplet dataset RMSE (fitted triplet), triplet dataset RMSE (no triplet). The final output format must be a single line as a comma-separated list enclosed in square brackets, for example $[r_{1},r_{2},r_{3},r_{4}]$.\n\nTest suite specification:\n- Case $1$ (happy path): Pair-based STDP window at $\\Delta t$ values $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms using the fitted triplet parameters.\n- Case $2$ (boundary conditions): Pair-based STDP at extreme lags $\\Delta t = -100$ ms and $\\Delta t = 100$ ms using the fitted triplet parameters.\n- Case $3$ (triplet potentiation): Pre at $0$ ms, post at $10$ ms, post at $10+\\Delta_{2}$ ms with $\\Delta_{2} \\in \\{5,10,20,40\\}$ ms using the fitted triplet parameters.\n- Case $4$ (edge case, ablated triplet): Same protocol as Case $3$ but with triplet amplitudes set to zero.\n\nAll outputs are dimensionless floats representing RMSE values. Angles are not involved, and no percentage outputs are required. The test suite must be processed in the exact order listed, and the program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.",
            "solution": "The user-provided problem is valid. It is scientifically grounded in the established principles of computational neuroscience, specifically the triplet model of Spike-Timing-Dependent Plasticity (STDP). The problem is well-posed, providing a complete and consistent set of parameters, definitions, and experimental protocols. The objectives are clear, and the language is precise and unambiguous. Therefore, a reasoned solution can be constructed.\n\nThe problem requires the implementation and validation of a triplet-based STDP model. This model extends the classical pair-based STDP framework to account for higher-order spike interactions, which are crucial for reproducing certain experimental observations, such as the dependency of plasticity on spike frequency and burst timing. The core of the model lies in its event-based nature and the use of exponentially decaying spike traces.\n\n**1. Model Formulation**\n\nThe state of the synapse is described by its weight, $w$, and four internal variables, or traces, which track the recent history of presynaptic and postsynaptic activity. For a presynaptic neuron, we define a short-term trace, $o_1(t)$, and a long-term trace, $r_1(t)$. Similarly, for a postsynaptic neuron, we have a short-term trace, $o_2(t)$, and a long-term trace, $r_2(t)$. Each trace is governed by a first-order linear differential equation:\n$$ \\tau_z \\frac{dz(t)}{dt} = -z(t) $$\nwhere $z$ can be any of the four traces ($o_1$, $r_1$, $o_2$, $r_2$) and $\\tau_z$ is its corresponding time constant ($\\tau_{+}$, $\\tau_{x}$, $\\tau_{-}$, $\\tau_{y}$).\n\nAt the time of a spike, a trace is instantaneously incremented by $1$. If a presynaptic spike occurs at time $t_{pre}$, the updates are $o_1(t_{pre}) \\to o_1(t_{pre}^{-}) + 1$ and $r_1(t_{pre}) \\to r_1(t_{pre}^{-}) + 1$. If a postsynaptic spike occurs at time $t_{post}$, the updates are $o_2(t_{post}) \\to o_2(t_{post}^{-}) + 1$ and $r_2(t_{post}) \\to r_2(t_{post}^{-}) + 1$. The notation $t^{-}$ signifies the moment just before the spike.\n\nBetween spikes, over a time interval $\\Delta t$, each trace decays exponentially:\n$$ z(t + \\Delta t) = z(t) \\exp\\left(-\\frac{\\Delta t}{\\tau_z}\\right) $$\n\n**2. Synaptic Weight Update Rules**\n\nThe change in synaptic weight, $\\Delta w$, occurs instantaneously at the moment of a spike. The update rules are defined as follows:\n\n- **At a postsynaptic spike (time $t_{post}$):** Long-Term Potentiation (LTP) is induced. The weight change is a function of the presynaptic short-term trace and an interaction with the postsynaptic long-term trace. This captures both a pair interaction (pre-before-post) and a triplet interaction (pre-post-post).\n$$ \\Delta w = o_1(t_{post}^{-}) \\left[ A_{2}^{+} + A_{3}^{+} r_2(t_{post}^{-}) \\right] $$\nHere, $A_{2}^{+}$ is the amplitude of the pair-based LTP, and $A_{3}^{+}$ is the amplitude of the triplet-based LTP.\n\n- **At a presynaptic spike (time $t_{pre}$):** Long-Term Depression (LTD) is induced. The weight change is a function of the postsynaptic short-term trace and an interaction with the presynaptic long-term trace. This captures a pair interaction (post-before-pre) and a triplet interaction (post-pre-post).\n$$ \\Delta w = -o_2(t_{pre}^{-}) \\left[ A_{2}^{-} + A_{3}^{-} r_1(t_{pre}^{-}) \\right] $$\nHere, $A_{2}^{-}$ is the amplitude of the pair-based LTD, and $A_{3}^{-}$ is the amplitude of the triplet-based LTD.\n\n**3. Event-Based Simulation Algorithm**\n\nTo determine the total weight change for a given sequence of spikes, an event-based simulation is performed. The spikes are treated as discrete events ordered chronologically.\n\nThe algorithm proceeds as follows:\n1. Initialize the total weight change $\\Delta W_{total} = 0$, all four traces ($o_1, r_1, o_2, r_2$) to $0$, and the last event time $t_{last} = 0$.\n2. Sort the list of all presynaptic and postsynaptic spikes by their occurrence time.\n3. Iterate through the sorted list of spike events. For each event at time $t_{event}$:\n    a. Calculate the time elapsed since the last event: $\\Delta t = t_{event} - t_{last}$.\n    b. If $\\Delta t  0$, decay all four traces exponentially: $z \\leftarrow z \\cdot \\exp(-\\Delta t / \\tau_z)$.\n    c. If the event is a postsynaptic spike, calculate the LTP contribution $\\Delta w_{LTP}$ using the current values of $o_1$ and $r_2$. Add this to the total weight change: $\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTP}$. Then, increment the postsynaptic traces: $o_2 \\leftarrow o_2 + 1$ and $r_2 \\leftarrow r_2 + 1$.\n    d. If the event is a presynaptic spike, calculate the LTD contribution $\\Delta w_{LTD}$ using the current values of $o_2$ and $r_1$. Add this to the total weight change: $\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTD}$. Then, increment the presynaptic traces: $o_1 \\leftarrow o_1 + 1$ and $r_1 \\leftarrow r_1 + 1$.\n    e. Update the last event time: $t_{last} \\leftarrow t_{event}$.\n4. After processing all spikes, the final $\\Delta W_{total}$ is the predicted synaptic weight change for the given spike protocol.\n\n**4. Validation and Error Calculation**\n\nThe model is validated by comparing its predictions to canonical experimental datasets. For each dataset, the simulation is run for every specified spike timing configuration. The Root-Mean-Square Error (RMSE) is then calculated to quantify the discrepancy between the model's predicted weight changes ($\\hat{y}_i$) and the canonical experimental values ($y_i$):\n$$ \\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\hat{y}_i - y_i)^2} $$\nwhere $N$ is the number of data points in the set. This process is repeated for the four specified test cases, involving two different parameter sets and three distinct experimental protocols, to generate the required four RMSE values. The use of a second parameter set with triplet amplitudes $A_3^+$ and $A_3^-$ set to zero serves as a control to demonstrate the necessity of the triplet terms for reproducing the triplet burst potentiation data.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and validates a triplet-based STDP model against canonical datasets.\n    \"\"\"\n\n    # Define the two parameter sets.\n    params_fitted_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.006, 'A3_minus': 0.004\n    }\n\n    params_no_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.000, 'A3_minus': 0.000\n    }\n\n    # Define canonical experimental datasets.\n    canonical_data = {\n        'pair_window': {\n            'dt': np.array([-50, -40, -30, -20, -10, -5, 5, 10, 20, 30, 40, 50]),\n            'dw': np.array([-0.00272, -0.00366, -0.00492, -0.00662, -0.00892, -0.01034, 0.00742, 0.00551, 0.00304, 0.00168, 0.00092, 0.00051])\n        },\n        'boundary_pair': {\n            'dt': np.array([-100, 100]),\n            'dw': np.array([-0.00062, 0.000026])\n        },\n        'triplet': {\n            'd2': np.array([5, 10, 20, 40]),\n            'dw': np.array([0.01196, 0.01023, 0.00805, 0.00624])\n        }\n    }\n\n    def run_simulation(spikes, params):\n        \"\"\"\n        Runs an event-based simulation for a given spike train and model parameters.\n\n        Args:\n            spikes (list of tuples): A list of (time, type) tuples, where type is 'pre' or 'post'.\n            params (dict): A dictionary of model parameters.\n\n        Returns:\n            float: The total synaptic weight change.\n        \"\"\"\n        # Sort spikes by time to ensure chronological processing.\n        spikes.sort(key=lambda x: x[0])\n        \n        # Initialize traces and total weight change\n        o1, r1, o2, r2 = 0.0, 0.0, 0.0, 0.0  # pre_short, pre_long, post_short, post_long\n        total_dw = 0.0\n        last_event_time = 0.0\n\n        p = params\n\n        for time, spike_type in spikes:\n            delta_t = time - last_event_time\n            \n            if delta_t  0:\n                # Decay all traces exponentially\n                o1 *= np.exp(-delta_t / p['tau_plus'])\n                r1 *= np.exp(-delta_t / p['tau_x'])\n                o2 *= np.exp(-delta_t / p['tau_minus'])\n                r2 *= np.exp(-delta_t / p['tau_y'])\n            \n            if spike_type == 'post':\n                # Potentiation update\n                dw = o1 * (p['A2_plus'] + p['A3_plus'] * r2)\n                total_dw += dw\n                # Increment postsynaptic traces\n                o2 += 1.0\n                r2 += 1.0\n            \n            elif spike_type == 'pre':\n                # Depression update\n                dw = -o2 * (p['A2_minus'] + p['A3_minus'] * r1)\n                total_dw += dw\n                # Increment presynaptic traces\n                o1 += 1.0\n                r1 += 1.0\n            \n            last_event_time = time\n            \n        return total_dw\n\n    def calculate_rmse(predicted, canonical):\n        return np.sqrt(np.mean((predicted - canonical)**2))\n\n    results = []\n\n    # Case 1: Pair-based STDP window (fitted triplet parameters)\n    predicted_dw_case1 = []\n    for dt in canonical_data['pair_window']['dt']:\n        if dt  0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case1.append(run_simulation(spikes, params_fitted_triplet))\n    \n    rmse1 = calculate_rmse(np.array(predicted_dw_case1), canonical_data['pair_window']['dw'])\n    results.append(rmse1)\n\n    # Case 2: Boundary pair conditions (fitted triplet parameters)\n    predicted_dw_case2 = []\n    for dt in canonical_data['boundary_pair']['dt']:\n        if dt  0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case2.append(run_simulation(spikes, params_fitted_triplet))\n\n    rmse2 = calculate_rmse(np.array(predicted_dw_case2), canonical_data['boundary_pair']['dw'])\n    results.append(rmse2)\n\n    # Case 3: Triplet burst potentiation (fitted triplet parameters)\n    predicted_dw_case3 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case3.append(run_simulation(spikes, params_fitted_triplet))\n        \n    rmse3 = calculate_rmse(np.array(predicted_dw_case3), canonical_data['triplet']['dw'])\n    results.append(rmse3)\n\n    # Case 4: Triplet burst potentiation (ablated triplet parameters)\n    predicted_dw_case4 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case4.append(run_simulation(spikes, params_no_triplet))\n        \n    rmse4 = calculate_rmse(np.array(predicted_dw_case4), canonical_data['triplet']['dw'])\n    results.append(rmse4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}