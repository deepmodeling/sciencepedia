{
    "hands_on_practices": [
        {
            "introduction": "要构建复杂的星形胶质细胞-神经元网络模型，我们首先需要理解其最基本的组成部分。这项练习将引导你量化单次胶质递质释放事件对突触后神经元的直接生物物理影响，这是对星形胶质细胞与神经元通讯进行建模的关键第一步。通过推导由星形胶质细胞释放的谷氨酸脉冲所引起的总突触后电荷，你将深入理解神经调节的动力学过程。",
            "id": "4035731",
            "problem": "星形胶质细胞通过向细胞外空间释放谷氨酸来调节突触和突触外信号传导。考虑一个星形胶质细胞调节可塑性的神经形态模型，其中突触外N-甲基-D-天冬氨酸（NMDA）受体的激活以瞬时细胞外谷氨酸浓度的饱和函数形式对突触后电流做出贡献。假设突触后膜被电压钳制，因此NMDA电导是钳制电压 $V$ 的一个固定函数 $g_{N}(V)$，并假设相对于谷氨酸清除，受体占据处于准稳态。设NMDA电流由标准的Michaelis–Menten形式建模\n$$\nI_{NMDA}(t) \\;=\\; g_{N}(V)\\,\\frac{[G_{e}](t)}{K_{N} + [G_{e}](t)},\n$$\n其中 $[G_{e}](t)$ 是细胞外谷氨酸浓度，$K_{N} > 0$ 是在给定的共激动剂和镁离子条件下，突触外NMDA受体结合的有效半饱和常数，而 $g_{N}(V) > 0$ 在时间上是恒定的。在星形胶质细胞释放之前，基线浓度为 $[G_{e}](t) = G_{0}$，其中 $G_{0} \\ge 0$。在时间 $t=0$ 时，星形胶质细胞向细胞外空间释放一个瞬态谷氨酸脉冲，该脉冲叠加在基线上，并由于摄取和扩散而呈单指数衰减，因此对于 $t \\ge 0$，\n$$\n[G_{e}](t) \\;=\\; G_{0} + A\\,\\exp\\!\\left(-\\frac{t}{\\tau_{g}}\\right),\n$$\n其中 $A > 0$ 是脉冲振幅，$\\tau_{g} > 0$ 是衰减时间常数。\n\n从质量作用受体占据出发，并假设上述动力学和电压钳制条件，推导由脉冲引起的相对于基线的NMDA电流总时间积分增量的封闭形式解析表达式，\n$$\n\\Delta Q \\;=\\; \\int_{0}^{\\infty}\\big(I_{NMDA}(t) - I_{NMDA}^{\\text{base}}\\big)\\,dt,\n$$\n其中\n$$\nI_{NMDA}^{\\text{base}} \\;=\\; g_{N}(V)\\,\\frac{G_{0}}{K_{N} + G_{0}}.\n$$\n请用 $g_{N}(V)$、$K_{N}$、$G_{0}$、$A$ 和 $\\tau_{g}$ 表示你的最终答案，形式为一个单一的封闭形式解析表达式。不需要进行数值计算，最终的方框答案中不应包含单位。",
            "solution": "所述问题需根据既定标准进行验证。\n\n### 步骤 1：提取已知条件\n以下量和关系按原文提供：\n-   NMDA 电流模型：$I_{NMDA}(t) = g_{N}(V)\\,\\frac{[G_{e}](t)}{K_{N} + [G_{e}](t)}$\n-   $t \\ge 0$ 时的细胞外谷氨酸浓度：$[G_{e}](t) = G_{0} + A\\,\\exp(-\\frac{t}{\\tau_{g}})$\n-   基线 NMDA 电流：$I_{NMDA}^{\\text{base}} = g_{N}(V)\\,\\frac{G_{0}}{K_{N} + G_{0}}$\n-   待推导的总时间积分电流增量：$\\Delta Q = \\int_{0}^{\\infty}\\big(I_{NMDA}(t) - I_{NMDA}^{\\text{base}}\\big)\\,dt$\n-   参数约束：$K_{N} > 0$，$g_{N}(V) > 0$，$G_{0} \\ge 0$，$A > 0$，$ \\tau_{g} > 0$。\n-   背景条件：电压钳制的突触后膜，准稳态受体占据。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性：\n-   **科学依据**：该问题对受体动力学采用了标准的Michaelis–Menten公式，对神经递质脉冲采用了单指数衰减。这些是计算神经科学和生物物理建模中常用且广为接受的简化方法。在此建模背景下，该设置在科学上是合理的。\n-   **适定性**：该问题在数学上是明确定义的。它要求计算一个由良态分量构成的函数的定积分。被积函数在 $t \\to \\infty$ 时趋近于零，确保积分收敛。所有必要的参数都已提供，并且预期存在唯一的解析解。\n-   **客观性**：该问题使用精确的数学定义和客观的语言陈述，没有歧义或主观论断。\n\n该问题没有表现出任何列举的无效缺陷。它在科学上是合理的，形式上是严谨的，自成体系的，并且是可解的。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将推导解答。\n\n目标是计算 NMDA 电流相对于其基线值的总时间积分增量 $\\Delta Q$。其定义如下：\n$$\n\\Delta Q = \\int_{0}^{\\infty} \\left( I_{NMDA}(t) - I_{NMDA}^{\\text{base}} \\right) dt\n$$\n首先，我们代入 $I_{NMDA}(t)$ 和 $I_{NMDA}^{\\text{base}}$ 的表达式。项 $g_{N}(V)$ 是一个公因子，可以移到积分号外。\n$$\n\\Delta Q = g_{N}(V) \\int_{0}^{\\infty} \\left( \\frac{[G_{e}](t)}{K_{N} + [G_{e}](t)} - \\frac{G_{0}}{K_{N} + G_{0}} \\right) dt\n$$\n接下来，我们将随时间变化的谷氨酸浓度表达式 $[G_{e}](t) = G_{0} + A\\,\\exp(-t/\\tau_{g})$ 代入 $t \\ge 0$ 时的被积函数中。\n$$\n\\Delta Q = g_{N}(V) \\int_{0}^{\\infty} \\left( \\frac{G_{0} + A\\,\\exp(-t/\\tau_{g})}{K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g})} - \\frac{G_{0}}{K_{N} + G_{0}} \\right) dt\n$$\n为简化积分内的表达式，我们通过寻找公分母 $(K_{N} + G_{0})(K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g}))$ 来合并这两个分数。\n为简洁起见，我们记 $x(t) = A\\,\\exp(-t/\\tau_{g})$。被积函数变为：\n$$\n\\frac{G_{0} + x(t)}{K_{N} + G_{0} + x(t)} - \\frac{G_{0}}{K_{N} + G_{0}} = \\frac{(G_{0} + x(t))(K_{N} + G_{0}) - G_{0}(K_{N} + G_{0} + x(t))}{(K_{N} + G_{0})(K_{N} + G_{0} + x(t))}\n$$\n展开分子：\n$$\n(G_{0}K_{N} + G_{0}^2 + x(t)K_{N} + x(t)G_{0}) - (G_{0}K_{N} + G_{0}^2 + G_{0}x(t))\n$$\n简化分子得到：\n$$\nG_{0}K_{N} + G_{0}^2 + K_{N}x(t) + G_{0}x(t) - G_{0}K_{N} - G_{0}^2 - G_{0}x(t) = K_{N}x(t)\n$$\n将 $x(t) = A\\,\\exp(-t/\\tau_{g})$ 代回，简化的被积函数为：\n$$\n\\frac{K_{N}A\\,\\exp(-t/\\tau_{g})}{(K_{N} + G_{0})(K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g}))}\n$$\n$\\Delta Q$ 的积分现在是：\n$$\n\\Delta Q = g_{N}(V) \\int_{0}^{\\infty} \\frac{K_{N}A\\,\\exp(-t/\\tau_{g})}{(K_{N} + G_{0})(K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g}))} dt\n$$\n我们可以将不依赖于积分变量 $t$ 的项提取出来：\n$$\n\\Delta Q = \\frac{g_{N}(V) K_{N} A}{K_{N} + G_{0}} \\int_{0}^{\\infty} \\frac{\\exp(-t/\\tau_{g})}{K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g})} dt\n$$\n为求解剩余的积分，我们进行变量替换。令 $u = K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g})$。\n则微分 $du$ 为：\n$$\ndu = A \\left(-\\frac{1}{\\tau_{g}}\\right) \\exp(-t/\\tau_{g}) dt\n$$\n这可以重新整理以表示被积函数的分子：\n$$\n\\exp(-t/\\tau_{g}) dt = -\\frac{\\tau_{g}}{A} du\n$$\n我们还必须将积分限从 $t$ 转换为 $u$：\n-   在下限 $t=0$ 处，我们有 $u(0) = K_{N} + G_{0} + A\\,\\exp(0) = K_{N} + G_{0} + A$。\n-   在上限 $t \\to \\infty$ 处，我们有 $u(\\infty) = K_{N} + G_{0} + A\\,\\lim_{t \\to \\infty}\\exp(-t/\\tau_{g}) = K_{N} + G_{0}$。\n将这些代入积分：\n$$\n\\int_{0}^{\\infty} \\frac{\\exp(-t/\\tau_{g})}{K_{N} + G_{0} + A\\,\\exp(-t/\\tau_{g})} dt = \\int_{K_{N} + G_{0} + A}^{K_{N} + G_{0}} \\frac{1}{u} \\left(-\\frac{\\tau_{g}}{A}\\right) du\n$$\n我们可以反转积分限，这会消去负号：\n$$\n= \\frac{\\tau_{g}}{A} \\int_{K_{N} + G_{0}}^{K_{N} + G_{0} + A} \\frac{1}{u} du\n$$\n$1/u$ 的积分是 $\\ln|u|$。由于所有参数（$K_{N}, A, \\tau_{g}$）均为正，且 $G_{0} \\ge 0$，因此在积分区间内，参数 $u$ 始终为正。因此，绝对值是不必要的。\n$$\n= \\frac{\\tau_{g}}{A} \\left[ \\ln(u) \\right]_{K_{N} + G_{0}}^{K_{N} + G_{0} + A}\n$$\n计算定积分：\n$$\n= \\frac{\\tau_{g}}{A} \\left( \\ln(K_{N} + G_{0} + A) - \\ln(K_{N} + G_{0}) \\right)\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到：\n$$\n= \\frac{\\tau_{g}}{A} \\ln\\left(\\frac{K_{N} + G_{0} + A}{K_{N} + G_{0}}\\right)\n$$\n最后，我们将此结果代回 $\\Delta Q$ 的表达式中：\n$$\n\\Delta Q = \\frac{g_{N}(V) K_{N} A}{K_{N} + G_{0}} \\left[ \\frac{\\tau_{g}}{A} \\ln\\left(\\frac{K_{N} + G_{0} + A}{K_{N} + G_{0}}\\right) \\right]\n$$\n前置因子中的项 $A$ 与积分表达式分母中的 $A$ 相抵消：\n$$\n\\Delta Q = \\frac{g_{N}(V) K_{N} \\tau_{g}}{K_{N} + G_{0}} \\ln\\left(\\frac{K_{N} + G_{0} + A}{K_{N} + G_{0}}\\right)\n$$\n这就是NMDA电流总时间积分增量的最终封闭形式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{g_{N}(V) K_{N} \\tau_{g}}{K_{N} + G_{0}} \\ln\\left(\\frac{K_{N} + G_{0} + A}{K_{N} + G_{0}}\\right)}\n$$"
        },
        {
            "introduction": "除了瞬时事件，星形胶质细胞在更长的时间尺度上扮演着至关重要的调节角色，确保突触可塑性的稳定。这项练习探讨了一个核心概念：星形胶质细胞如何通过整合长期突触活动，来动态调整学习规则中的“滑动阈值”，从而实现动态平衡控制。通过分析该耦合系统的稳定性，你将揭示在神经可塑性系统中，不同组件之间的时间尺度匹配对于维持功能稳定的重要性。",
            "id": "4035704",
            "problem": "您将形式化并分析一个单突触可塑性系统，其中星形胶质细胞在有限窗口内充当活动积分器，以在类似 Bienenstock–Cooper–Munro (BCM) 的规则中设置元可塑性滑动阈值。从一个适用于神经形态和脑启发计算以及星形胶质细胞调节可塑性的有效基础开始。使用以下基本依据和核心定义：(i) 基于速率变量的赫布可塑性原理；(ii) 线性突触后响应模型；以及 (iii) 用一阶低通积分器表示有限窗口的星形胶质细胞整合。\n\n定义一个单突触，其突触前放电率为 $x \\ge 0$，突触权重为 $w$，突触后放电率为 $y$，可塑性学习率为 $\\eta > 0$，以及由星形胶质细胞驱动的元可塑性阈值为 $\\theta_m$。将突触后响应建模为 $y = w x$。设类似 BCM 的可塑性遵循\n$$\\dot{w} = \\eta \\, x \\, y \\, (y - \\theta_m),$$\n并设星形胶质细胞在持续时间为 $T > 0$ 的窗口内整合累积活动，通过一阶微分方程设置滑动阈值\n$$\\dot{\\theta}_m = \\frac{-\\theta_m + \\alpha \\, y^2}{T},$$\n其中 $\\alpha > 0$ 是一个比例常数，用于设定活动依赖阈值的尺度。窗口 $T$ 决定了阈值跟踪整合活动的速度。为进行此数学分析，假设所有变量均为无量纲的速率和权重。\n\n任务：\n1. 从第一性原理出发，推导耦合系统的固定点 $(w^\\star,\\theta_m^\\star)$，除了上述基本定义外，不使用任何快捷公式。\n2. 对固定点进行线性稳定性分析，方法是构建系统在固定点处的雅可比矩阵并计算其特征值，从而确定轨迹是渐近稳定（所有特征值的实部均为严格负数）、不稳定还是中性稳定。\n3. 将此分析实现为一个程序，给定 $(\\alpha,\\eta,x,T)$，该程序返回：\n   - 当 $x>0$ 时的非平凡固定点 $(w^\\star,\\theta_m^\\star)$，或按惯例当 $x=0$ 时的 $(0,0)$；\n   - 一个布尔值 $s$，表示该固定点的渐近稳定性，其中当且仅当两个特征值的实部均为严格负数时，$s$ 为真；\n   - 将所有报告的浮点数结果四舍五入到六位小数。\n\n您的程序不得模拟时域动态；它必须通过解析或精确代数表达式以及雅可比矩阵的数值特征值计算来计算固定点和线性化稳定性。最终输出格式必须是一行文本，包含一个方括号括起来的逗号分隔列表，其中每个测试用例贡献一个形如 $[w^\\star,\\theta_m^\\star,s]$ 的子列表。\n\n测试套件：\n为以下参数集 $(\\alpha,\\eta,x,T)$ 提供结果，这些参数集旨在测试正常路径、边界、大窗口不稳定性、零突触前输入和极快速星形胶质细胞跟踪等情况：\n- 案例 A (正常路径): $(\\alpha,\\eta,x,T) = (1.0, 0.05, 1.0, 10.0)$\n- 案例 B (边界条件): $(\\alpha,\\eta,x,T) = (1.0, 0.05, 1.0, 20.0)$\n- 案例 C (慢速星形胶质细胞，不稳定性): $(\\alpha,\\eta,x,T) = (1.0, 0.05, 1.0, 50.0)$\n- 案例 D (边缘情况，无突触前驱动): $(\\alpha,\\eta,x,T) = (1.0, 0.05, 0.0, 10.0)$\n- 案例 E (极快速星形胶质细胞): $(\\alpha,\\eta,x,T) = (1.0, 0.05, 2.0, 4.0)$\n\n答案规格：\n- 对每个案例，计算 $[w^\\star,\\theta_m^\\star,s]$，其中 $w^\\star$ 和 $\\theta_m^\\star$ 是四舍五入到六位小数的浮点数，$s$ 是一个布尔值。\n- 您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表形式的结果 (例如, $[[0.123456,0.654321,True],[\\dots]]$)。",
            "solution": "我们基于神经形态可塑性的基本原理来形式化该系统。赫布可塑性指出，突触的变化是由突触前和突触后活动之间的相关性驱动的。对于基于速率的单元，一个经典的连续时间公式是 Bienenstock–Cooper–Munro (BCM) 类的标量规则。我们指定一个线性突触后响应和一个一阶星形胶质细胞积分器来实现元可塑性。\n\n模型：\n- 突触前放电率: $x \\ge 0$.\n- 突触权重: $w$.\n- 突触后放电率: $y = w x$.\n- 可塑性学习率: $\\eta > 0$.\n- 元可塑性滑动阈值: $\\theta_m$，由窗口为 $T > 0$、尺度为 $\\alpha > 0$ 的星形胶质细胞控制。\n- 动力学方程：\n$$\\dot{w} = \\eta \\, x \\, y \\, (y - \\theta_m) = \\eta \\, x^2 \\, w \\, (w x - \\theta_m),$$\n$$\\dot{\\theta}_m = \\frac{-\\theta_m + \\alpha w^2 x^2}{T}.$$\n\n固定点：\n固定点 $(w^\\star,\\theta_m^\\star)$ 同时满足 $\\dot{w}=0$ 和 $\\dot{\\theta}_m=0$。从 $\\dot{w}=0$ 可得，\n$$\\eta x^2 w^\\star (w^\\star x - \\theta_m^\\star) = 0.$$\n对于 $x \\ge 0$ 和 $\\eta>0$，这产生两种情况：\n- 案例 1: $w^\\star = 0$.\n- 案例 2: $w^\\star x - \\theta_m^\\star = 0 \\Rightarrow \\theta_m^\\star = w^\\star x$.\n\n从 $\\dot{\\theta}_m=0$ 可得，\n$$\\frac{-\\theta_m^\\star + \\alpha w^{\\star 2} x^2}{T} = 0 \\Rightarrow \\theta_m^\\star = \\alpha w^{\\star 2} x^2.$$\n\n与案例 1 结合：$w^\\star=0$ 意味着 $y^\\star=0$，则根据阈值方程可得 $\\theta_m^\\star=0$。因此 $(w^\\star,\\theta_m^\\star)=(0,0)$ 是一个固定点。\n\n对 $x>0$ 的情况与案例 2 结合：\n$$\\theta_m^\\star = w^\\star x = \\alpha w^{\\star 2} x^2.$$\n假设 $w^\\star \\ne 0$ 并将两边同除以 $x$，\n$$w^\\star = \\alpha w^{\\star 2} x \\Rightarrow 1 = \\alpha w^\\star x \\Rightarrow w^\\star = \\frac{1}{\\alpha x}.$$\n然后，\n$$\\theta_m^\\star = w^\\star x = \\frac{1}{\\alpha}.$$\n因此对于 $x>0$，存在一个非平凡固定点 $(w^\\star,\\theta_m^\\star)=\\left(\\frac{1}{\\alpha x}, \\frac{1}{\\alpha}\\right)$。\n\n线性稳定性分析：\n定义向量场 $\\mathbf{f}(w,\\theta_m) = (f_w, f_{\\theta})$，其中\n$$f_w = \\eta x^2 w (w x - \\theta_m) = \\eta x^3 w^2 - \\eta x^2 w \\theta_m,$$\n$$f_{\\theta} = \\frac{-\\theta_m + \\alpha w^2 x^2}{T}.$$\n雅可比矩阵 $J$ 是\n$$J = \\begin{bmatrix}\n\\frac{\\partial f_w}{\\partial w} & \\frac{\\partial f_w}{\\partial \\theta_m} \\\\\n\\frac{\\partial f_{\\theta}}{\\partial w} & \\frac{\\partial f_{\\theta}}{\\partial \\theta_m}\n\\end{bmatrix} = \\begin{bmatrix}\n\\eta x^2 (2 w x - \\theta_m) & -\\eta x^2 w \\\\\n\\frac{2 \\alpha w x^2}{T} & -\\frac{1}{T}\n\\end{bmatrix}.$$\n\n在 $x>0$ 的非平凡固定点 $(w^\\star,\\theta_m^\\star)=\\left(\\frac{1}{\\alpha x}, \\frac{1}{\\alpha}\\right)$ 处计算 $J$：\n计算 $2 w^\\star x - \\theta_m^\\star = 2 \\frac{1}{\\alpha} - \\frac{1}{\\alpha} = \\frac{1}{\\alpha}$，以及 $w^\\star = \\frac{1}{\\alpha x}$。\n因此，\n$$J^\\star = \\begin{bmatrix}\n\\frac{\\eta x^2}{\\alpha} & -\\frac{\\eta x}{\\alpha} \\\\\n\\frac{2 x}{T} & -\\frac{1}{T}\n\\end{bmatrix}.$$\n特征多项式是\n$$\\lambda^2 - \\tau \\lambda + \\Delta = 0,$$\n其迹为\n$$\\tau = \\frac{\\eta x^2}{\\alpha} - \\frac{1}{T},$$\n行列式为\n$$\\Delta = \\frac{\\eta x^2}{\\alpha T}.$$\n二维空间中的渐近稳定性要求两个特征值的实部都严格为负。对于行列式为正的实矩阵，渐近稳定的充分必要条件是 $\\tau < 0$ 和 $\\Delta > 0$。在此，对于 $\\eta>0$, $x\\ge 0$, $\\alpha>0$, 和 $T>0$ 的情况，$\\Delta > 0$ 是保证的。因此，稳定性条件简化为\n$$\\tau < 0 \\quad \\Leftrightarrow \\quad \\frac{\\eta x^2}{\\alpha} - \\frac{1}{T} < 0 \\quad \\Leftrightarrow \\quad T < \\frac{\\alpha}{\\eta x^2}.$$\n这给出了一个清晰的元可塑性稳定性条件：为确保稳定性，星形胶质细胞的整合必须相对于突触驱动 $x$ 和可塑性增益 $\\eta$（由 $\\alpha$ 缩放）足够快（即 $T$ 较小）。在边界 $T = \\frac{\\alpha}{\\eta x^2}$ 处，$\\tau = 0$，特征值为纯虚数（中性稳定），因此不是渐近稳定的。对于 $T > \\frac{\\alpha}{\\eta x^2}$，迹变为正，固定点不稳定。\n\n对于平凡固定点 $(0,0)$，计算 $J$ 可得\n$$J_0 = \\begin{bmatrix}\n0 & 0 \\\\\n0 & -\\frac{1}{T}\n\\end{bmatrix},$$\n其特征值为 $0$ 和 $-\\frac{1}{T}$。零特征值表示沿 $w$ 方向是中性稳定的；该动力学系统在原点不是渐近稳定的。确实，在 $w=0$ 和 $\\theta_m=0$ 附近，对于 $x>0$ 有 $\\dot{w} \\approx \\eta x^3 w^2$，这会导致任何 $w>0$ 的 $w$ 值增加；因此，当 $x>0$ 时原点是不稳定的，仅当 $x=0$ 时才是中性稳定的，因为如果 $x=0$，则对所有 $w$ 都有 $\\dot{w}=0$。\n\n程序的算法设计：\n- 输入：每个测试用例的 $(\\alpha,\\eta,x,T)$。\n- 计算固定点：\n  - 如果 $x>0$，设 $w^\\star = \\frac{1}{\\alpha x}$ 且 $\\theta_m^\\star = \\frac{1}{\\alpha}$。\n  - 如果 $x=0$，按惯例设 $(w^\\star,\\theta_m^\\star)=(0,0)$。\n- 使用精确的偏导数在 $(w^\\star,\\theta_m^\\star)$ 处构建雅可比矩阵。\n- 计算特征值 $\\lambda_1,\\lambda_2$ 并通过检查 $\\Re(\\lambda_1) < 0$ 和 $\\Re(\\lambda_2) < 0$ 来确定渐近稳定性 $s$。\n- 将 $w^\\star$ 和 $\\theta_m^\\star$ 四舍五入到六位小数，并为每个测试用例输出 $[w^\\star,\\theta_m^\\star,s]$。\n- 将所有结果汇总到一行输出中，格式为一个方括号括起来的逗号分隔列表。\n\n测试套件预期：\n- 案例 A: $(\\alpha,\\eta,x,T) = (1.0, 0.05, 1.0, 10.0)$ 得出 $T < \\frac{\\alpha}{\\eta x^2} = \\frac{1.0}{0.05 \\cdot 1.0} = 20.0$，所以在非平凡固定点处是渐近稳定的。\n- 案例 B: $(1.0, 0.05, 1.0, 20.0)$ 得出边界 $T = 20.0$，中性稳定，非渐近稳定。\n- 案例 C: $(1.0, 0.05, 1.0, 50.0)$ 得出 $T > 20.0$，不稳定。\n- 案例 D: $(1.0, 0.05, 0.0, 10.0)$ 得出 $(w^\\star,\\theta_m^\\star)=(0,0)$ 且一个特征值为 $0$，非渐近稳定。\n- 案例 E: $(1.0, 0.05, 2.0, 4.0)$ 得出 $\\frac{\\alpha}{\\eta x^2} = \\frac{1.0}{0.05 \\cdot 4.0} = 5.0$ 且 $T=4.0 < 5.0$，所以是渐近稳定的。\n\n该程序将实现此逻辑，为每个案例计算雅可比矩阵、特征值和最终的稳定性布尔值，并以指定格式打印汇总列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fixed_point(alpha, eta, x, T):\n    \"\"\"\n    Compute the fixed point (w*, theta*) for the given parameters.\n    For x > 0: nontrivial fixed point w* = 1/(alpha*x), theta* = 1/alpha.\n    For x = 0: by convention, return (0.0, 0.0).\n    \"\"\"\n    if x > 0:\n        w_star = 1.0 / (alpha * x)\n        theta_star = 1.0 / alpha\n    else:\n        w_star = 0.0\n        theta_star = 0.0\n    return w_star, theta_star\n\ndef jacobian(alpha, eta, x, T, w, theta):\n    \"\"\"\n    Construct the Jacobian matrix at (w, theta) for given parameters.\n    J = [[ eta*x^2*(2*w*x - theta), -eta*x^2*w ],\n         [ 2*alpha*w*x**2 / T,      -1/T        ]]\n    \"\"\"\n    j11 = eta * x**2 * (2.0 * w * x - theta)\n    j12 = -eta * x**2 * w\n    j21 = (2.0 * alpha * w * x**2) / T if T > 0 else np.inf\n    j22 = -1.0 / T if T > 0 else -np.inf\n    return np.array([[j11, j12],\n                     [j21, j22]], dtype=float)\n\ndef stability_from_jacobian(J):\n    \"\"\"\n    Compute eigenvalues and decide asymptotic stability:\n    stable if and only if both eigenvalues have strictly negative real parts.\n    \"\"\"\n    eigvals = np.linalg.eigvals(J)\n    real_parts = np.real(eigvals)\n    stable = np.all(real_parts < 0.0)\n    return stable, eigvals\n\ndef analyze_case(alpha, eta, x, T):\n    w_star, theta_star = fixed_point(alpha, eta, x, T)\n    J = jacobian(alpha, eta, x, T, w_star, theta_star)\n    stable, _ = stability_from_jacobian(J)\n    # Round floats to 6 decimals as specified\n    return [round(w_star, 6), round(theta_star, 6), bool(stable)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (alpha, eta, x, T)\n    test_cases = [\n        (1.0, 0.05, 1.0, 10.0),  # Case A: happy path, stable\n        (1.0, 0.05, 1.0, 20.0),  # Case B: boundary, neutrally stable (not asymptotically stable)\n        (1.0, 0.05, 1.0, 50.0),  # Case C: unstable due to large T\n        (1.0, 0.05, 0.0, 10.0),  # Case D: x=0, neutral along w (not asymptotically stable)\n        (1.0, 0.05, 2.0, 4.0),   # Case E: fast astrocyte, stable\n    ]\n\n    results = []\n    for (alpha, eta, x, T) in test_cases:\n        result = analyze_case(alpha, eta, x, T)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的最终价值在于其解释和预测实验数据的能力。最后的这项实践将理论与实验联系起来，让你着手解决一个“逆问题”：如何从模拟的实验记录中估计出星形胶质细胞调节模型的未知参数。这项练习不仅训练你应用最大似然估计等统计推断方法，而且强调了在面对共线性和边界条件等实际数据问题时，如何稳健地进行参数估计。",
            "id": "4035724",
            "problem": "给定一个在离散时间上遵循线性响应叠加原理和独立高斯测量噪声的星形胶质细胞调节的突触传递模型。在每个由 $t \\in \\{1,\\dots,T\\}$ 索引的时间窗格中，观测到的突触后电流 $y_t$（单位：皮安）被建模为\n$$\ny_t \\;=\\; \\mu_t \\;+\\; \\varepsilon_t, \\quad \\varepsilon_t \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其均值是两个可从生理学上解释的组分之和\n$$\n\\mu_t \\;=\\; \\alpha\\, x_t \\;+\\; \\beta\\, z_t.\n$$\n这里，$x_t$（单位：皮安秒）是一个已知的有效突触回归量，由突触前活动与突触响应核卷积得出；$z_t$（单位：皮安秒）是一个已知的有效星形胶质细胞回归量，由星形胶质细胞钙活动与胶质传递核卷积得出。参数 $\\alpha$ 和 $\\beta$（单位均为每秒，即 $\\text{s}^{-1}$）是您必须通过最大似然估计的非负释放率尺度参数。假设 $\\sigma^2$ 未知但在所有时间内恒定，并且 $(\\varepsilon_t)$ 在不同的 $t$ 之间是独立的。\n\n您的任务是设计并实现一个在非负性约束 $\\alpha \\ge 0$、$\\beta \\ge 0$ 下的 $\\alpha$ 和 $\\beta$ 的最大似然估计器，使用该模型所隐含的高斯似然。该估计器应能处理 $x_t$ 和 $z_t$ 之间潜在的共线性，并应在某一路线缺失时正确返回边界值。\n\n您将获得四个独立的测试数据集。对于每个数据集 $i \\in \\{1,2,3,4\\}$，您将得到序列 $\\{x_t^{(i)}\\}_{t=1}^{T_i}$、$\\{z_t^{(i)}\\}_{t=1}^{T_i}$ 和观测电流 $\\{y_t^{(i)}\\}_{t=1}^{T_i}$。通过最大化受约束于 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$ 的高斯对数似然，从每个数据集中估计 $(\\alpha^{(i)}, \\beta^{(i)})$。报告每个数据集的 $\\alpha$ 和 $\\beta$ 的估计值（单位为每秒），并四舍五入到四位小数。\n\n基础建模基础：\n- 电流的突触和星形胶质细胞贡献的线性响应叠加：$\\mu_t = \\alpha x_t + \\beta z_t$。\n- 独立同分布的高斯测量噪声：$\\varepsilon_t \\sim \\mathcal{N}(0,\\sigma^2)$，其中 $\\sigma^2$ 恒定且未知。\n\n数据集：\n\n数据集 1（长度 $T_1 = 20$）：\n- $x^{(1)} = [3.0, 2.8, 2.6, 2.5, 2.3, 2.1, 1.9, 1.8, 1.7, 1.6, 1.5, 1.45, 1.4, 1.35, 1.3, 1.25, 1.2, 1.15, 1.1, 1.05]$ (皮安秒)\n- $z^{(1)} = [0.5, 0.7, 0.9, 1.0, 1.1, 1.05, 1.0, 0.95, 0.9, 0.85, 0.8, 0.78, 0.76, 0.74, 0.72, 0.70, 0.68, 0.66, 0.64, 0.62]$ (皮安秒)\n- $y^{(1)} = [39.2, 36.8, 36.8, 33.8, 33.6, 30.05, 28.0, 25.45, 25.5, 22.95, 22.3, 21.1, 21.0, 19.3, 19.4, 18.4, 18.3, 16.8, 16.5, 15.3]$ (皮安)\n\n数据集 2（长度 $T_2 = 15$）：\n- $x^{(2)} = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 2.8, 3.0, 2.6, 2.2, 1.8, 1.4, 1.0, 0.7, 0.5]$ (皮安秒)\n- $z^{(2)} = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$ (皮安秒)\n- $y^{(2)} = [0.2, 3.9, 8.3, 11.5, 16.6, 19.6, 22.5, 23.8, 21.1, 17.3, 14.6, 11.1, 8.1, 5.4, 4.0]$ (皮安)\n\n数据集 3（长度 $T_3 = 10$）：\n- $x^{(3)} = [1.0, 1.1, 1.15, 1.2, 1.18, 1.16, 1.14, 1.12, 1.1, 1.08]$ (皮安秒)\n- $z^{(3)} = [0.91, 0.97, 1.055, 1.07, 1.062, 1.054, 1.016, 1.008, 1.01, 0.952]$ (皮安秒)\n- $y^{(3)} = [6.78, 7.29, 7.805, 7.98, 7.906, 7.822, 7.598, 7.514, 7.41, 7.206]$ (皮安)\n\n数据集 4（长度 $T_4 = 8$）：\n- $x^{(4)} = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$ (皮安秒)\n- $z^{(4)} = [0.2, 0.5, 1.0, 1.2, 1.1, 0.9, 0.6, 0.3]$ (皮安秒)\n- $y^{(4)} = [2.1, 4.8, 10.3, 11.5, 11.4, 8.7, 6.2, 2.9]$ (皮安)\n\n科学真实性与单位：\n- 以每秒 ($\\text{s}^{-1}$) 为单位报告 $\\alpha$ 和 $\\beta$。\n- 观测电流 $y_t$ 的单位是皮安 ($\\text{pA}$)。回归量 $x_t$ 和 $z_t$ 的单位是皮安秒，这样 $\\alpha x_t$ 和 $\\beta z_t$ 的结果就是皮安。\n- 高斯噪声方差 $\\sigma^2$ 未知且恒定；无需报告。\n\n算法要求：\n- 在高斯模型下使用最大似然法，并施加非负性约束 $\\alpha \\ge 0$, $\\beta \\ge 0$。由此产生的估计器等价于求解一个约束最小二乘问题。\n\n角度单位与此问题无关。\n\n您的程序必须不读取任何输入，并且必须为每个数据集计算 $\\alpha$ 和 $\\beta$ 的最大似然估计值（单位：$\\text{s}^{-1}$），四舍五入到四位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应数据集1到4的 $[\\alpha,\\beta]$ 双元素列表。例如，输出格式必须严格如下：\n`[[\\alpha_1,\\beta_1],[\\alpha_2,\\beta_2],[\\alpha_3,\\beta_3],[\\alpha_4,\\beta_4]]`\n所有值都打印为四舍五入到四位小数的十进制数，且没有多余的空格。\n\n测试套件覆盖范围：\n- 数据集 1：两个路径都活跃且噪声适中的一般情况。\n- 数据集 2：星形胶质细胞路径缺失（$z_t \\equiv 0$）的边界情况，应得出 $\\beta$ 在边界值 $0$。\n- 数据集 3：$x_t$ 和 $z_t$ 之间接近共线性，测试估计器的数值稳定性。\n- 数据集 4：突触路径缺失（$x_t \\equiv 0$）的边界情况，应得出 $\\alpha$ 在边界值 $0$。",
            "solution": "问题陈述已经过评估，并被确定为有效。它具有科学依据、问题明确、客观，并包含推导出唯一且有意义解所需的所有信息。\n\n该问题要求对线性模型\n$$\ny_t = \\alpha x_t + \\beta z_t + \\varepsilon_t\n$$\n的参数 $\\alpha$ 和 $\\beta$ 进行估计，其中 $\\varepsilon_t$ 是来自均值为 $0$、方差未知的正态分布的独立同分布随机变量，即 $\\varepsilon_t \\sim \\mathcal{N}(0, \\sigma^2)$。估计需使用最大似然法，并满足非负约束条件 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$。\n\n让我们将一个长度为 $T$ 的数据集的问题用向量表示法来表述。令 $\\mathbf{y} = [y_1, y_2, \\dots, y_T]^T$ 为观测向量，$\\mathbf{x} = [x_1, x_2, \\dots, x_T]^T$ 和 $\\mathbf{z} = [z_1, z_2, \\dots, z_T]^T$ 为回归量向量。我们可以定义一个设计矩阵 $\\mathbf{X} = [\\mathbf{x}, \\mathbf{z}]$，这是一个 $T \\times 2$ 的矩阵，以及一个参数向量 $\\boldsymbol{\\theta} = [\\alpha, \\beta]^T$。整个数据集的模型可以写成：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}\n$$\n其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2\\mathbf{I})$，$\\mathbf{0}$ 是一个 $T \\times 1$ 的零向量，$\\mathbf{I}$ 是 $T \\times T$ 的单位矩阵。\n\n给定 $\\alpha, \\beta,$ 和 $\\sigma^2$ 时，单个观测值 $y_t$ 的概率密度函数为：\n$$\np(y_t | \\alpha, \\beta, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_t - (\\alpha x_t + \\beta z_t))^2}{2\\sigma^2}\\right)\n$$\n由于噪声项 $\\varepsilon_t$ 的独立性，整个观测向量 $\\mathbf{y}$ 的似然函数是各个概率的乘积：\n$$\nL(\\alpha, \\beta, \\sigma^2 | \\mathbf{y}, \\mathbf{X}) = \\prod_{t=1}^T p(y_t | \\alpha, \\beta, \\sigma^2) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{T/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{t=1}^T (y_t - \\alpha x_t - \\beta z_t)^2\\right)\n$$\n对数似然函数 $\\mathcal{L} = \\ln L$ 为：\n$$\n\\mathcal{L}(\\alpha, \\beta, \\sigma^2) = -\\frac{T}{2}\\ln(2\\pi) - \\frac{T}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{t=1}^T (y_t - \\alpha x_t - \\beta z_t)^2\n$$\n为了找到 $\\alpha$ 和 $\\beta$ 的最大似然估计（MLE），我们需要最大化 $\\mathcal{L}$。观察 $\\mathcal{L}$ 的结构，我们可以看到，对于任何给定的 $\\sigma^2 > 0$ 值，最大化关于 $\\alpha$ 和 $\\beta$ 的 $\\mathcal{L}$ 等价于最小化残差平方和（SSE）项：\n$$\n\\text{SSE}(\\alpha, \\beta) = \\sum_{t=1}^T (y_t - \\alpha x_t - \\beta z_t)^2 = ||\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}||_2^2\n$$\n其中 $||\\cdot||_2^2$ 表示欧几里得范数的平方。\n\n这种等价性表明，对于具有加性高斯噪声的线性模型，最大似然估计与普通最小二乘（OLS）估计是相同的。然而，问题施加了约束条件 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$。因此，任务简化为解决以下约束优化问题：\n$$\n\\underset{\\alpha, \\beta}{\\text{minimize}} \\quad ||\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}||_2^2 \\quad \\text{subject to} \\quad \\boldsymbol{\\theta} \\ge \\mathbf{0}\n$$\n这是一个数值优化中的经典问题，称为非负最小二乘法（NNLS）。\n\nNNLS 问题不像无约束的 OLS 那样有简单的闭式解。它通常使用迭代活动集方法来解决，例如 Lawson 和 Hanson 开发的算法。该算法是稳健的，并已在标准科学计算库中实现。我们将使用 `scipy.optimize` 库中的 `nnls` 函数，该函数提供了该算法的高效且数值稳定的实现。\n\n对于四个提供的每一个数据集，程序如下：\n1.  从给定的 $y_t^{(i)}$ 值构造观测向量 $\\mathbf{y}^{(i)}$。\n2.  通过将回归量向量 $\\mathbf{x}^{(i)}$ 和 $\\mathbf{z}^{(i)}$ 作为列来构造 $T_i \\times 2$ 的设计矩阵 $\\mathbf{X}^{(i)}$。\n3.  使用 `scipy.optimize.nnls` 解决 NNLS 问题 $\\min ||\\mathbf{y}^{(i)} - \\mathbf{X}^{(i)}\\boldsymbol{\\theta}^{(i)}||_2^2$ subject to $\\boldsymbol{\\theta}^{(i)} = [\\alpha^{(i)}, \\beta^{(i)}]^T \\ge \\mathbf{0}$。\n4.  解向量提供估计参数 $(\\hat{\\alpha}^{(i)}, \\hat{\\beta}^{(i)})$。\n5.  然后按要求将结果四舍五入到四位小数。\n\n这种方法自然地处理了特定的测试案例：\n- 对于数据集 2，其中 $z_t \\equiv 0$，$\\mathbf{X}^{(2)}$ 的第二列为零。NNLS 算法将正确地发现任何非零的 $\\beta$ 都会增加残差平方和，从而强制 $\\hat{\\beta}=0$。\n- 对于数据集 4，其中 $x_t \\equiv 0$，$\\mathbf{X}^{(4)}$ 的第一列为零，通过对称性，算法将正确地估计 $\\hat{\\alpha}=0$。\n- 对于数据集 3，其中回归量几乎共线性，`nnls` 使用的活动集方法在数值上比通过矩阵逆 $(\\mathbf{X}^T\\mathbf{X})^{-1}$（这将是病态的）计算无约束 OLS 解更稳定。\n\n实现将把此程序应用于所有四个数据集，以获得最终估计值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves for the maximum likelihood estimates of alpha and beta for four datasets\n    under nonnegativity constraints using a Non-Negative Least Squares (NNLS) solver.\n    \"\"\"\n\n    # Define the datasets provided in the problem statement.\n    datasets = [\n        {\n            \"x\": [3.0, 2.8, 2.6, 2.5, 2.3, 2.1, 1.9, 1.8, 1.7, 1.6, 1.5, 1.45, 1.4, 1.35, 1.3, 1.25, 1.2, 1.15, 1.1, 1.05],\n            \"z\": [0.5, 0.7, 0.9, 1.0, 1.1, 1.05, 1.0, 0.95, 0.9, 0.85, 0.8, 0.78, 0.76, 0.74, 0.72, 0.70, 0.68, 0.66, 0.64, 0.62],\n            \"y\": [39.2, 36.8, 36.8, 33.8, 33.6, 30.05, 28.0, 25.45, 25.5, 22.95, 22.3, 21.1, 21.0, 19.3, 19.4, 18.4, 18.3, 16.8, 16.5, 15.3]\n        },\n        {\n            \"x\": [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 2.8, 3.0, 2.6, 2.2, 1.8, 1.4, 1.0, 0.7, 0.5],\n            \"z\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n            \"y\": [0.2, 3.9, 8.3, 11.5, 16.6, 19.6, 22.5, 23.8, 21.1, 17.3, 14.6, 11.1, 8.1, 5.4, 4.0]\n        },\n        {\n            \"x\": [1.0, 1.1, 1.15, 1.2, 1.18, 1.16, 1.14, 1.12, 1.1, 1.08],\n            \"z\": [0.91, 0.97, 1.055, 1.07, 1.062, 1.054, 1.016, 1.008, 1.01, 0.952],\n            \"y\": [6.78, 7.29, 7.805, 7.98, 7.906, 7.822, 7.598, 7.514, 7.41, 7.206]\n        },\n        {\n            \"x\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n            \"z\": [0.2, 0.5, 1.0, 1.2, 1.1, 0.9, 0.6, 0.3],\n            \"y\": [2.1, 4.8, 10.3, 11.5, 11.4, 8.7, 6.2, 2.9]\n        }\n    ]\n\n    results = []\n    for data in datasets:\n        # Convert lists to NumPy arrays\n        x_vec = np.array(data[\"x\"])\n        z_vec = np.array(data[\"z\"])\n        y_vec = np.array(data[\"y\"])\n\n        # Construct the design matrix A (denoted as X in the solution text)\n        A = np.stack([x_vec, z_vec], axis=1)\n        \n        # The vector b is the observation vector y\n        b = y_vec\n\n        # Solve the Non-Negative Least Squares problem: min ||Ax - b||_2 for x >= 0\n        # The solution 'x' corresponds to the parameter vector [alpha, beta]\n        params, _ = nnls(A, b)\n        \n        alpha_est = params[0]\n        beta_est = params[1]\n        \n        # Append the estimated, rounded parameters to the list of results\n        results.append([round(alpha_est, 4), round(beta_est, 4)])\n\n    # Format the final output string exactly as required, with no extra spaces.\n    formatted_results = [f\"[{res[0]:.4f},{res[1]:.4f}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}