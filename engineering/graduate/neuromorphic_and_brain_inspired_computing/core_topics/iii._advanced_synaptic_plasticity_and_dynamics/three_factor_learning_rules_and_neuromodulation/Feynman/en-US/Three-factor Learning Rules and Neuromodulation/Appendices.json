{
    "hands_on_practices": [
        {
            "introduction": "At the heart of three-factor learning rules is the concept of an eligibility trace, a synaptic memory of recent activity. This first exercise provides a concrete walkthrough of how to calculate the evolution of this trace based on the precise timing of presynaptic and postsynaptic spikes. Mastering this calculation is key to understanding how synapses become \"eligible\" for modification by a third, neuromodulatory factor.",
            "id": "4066367",
            "problem": "Consider a synapse from a presynaptic neuron $i$ to a postsynaptic neuron $j$ governed by a three-factor learning rule with an eligibility trace. Let the presynaptic neuron emit spikes at times $\\{10, 30\\}$ ms and the postsynaptic neuron emit spikes at times $\\{20, 40\\}$ ms. The eligibility time constant is $\\tau_{e} = 50$ ms, and the spike-timing coefficients are $A_{+} = 1$ and $A_{-} = -1$. The modulatory signal is fixed at $m(t) \\equiv 1$.\n\nUse the following foundational definitions consistent with spike-timing-dependent plasticity (STDP) to model the three-factor learning rule:\n1. The presynaptic and postsynaptic traces, $x_{i}(t)$ and $y_{j}(t)$, evolve according to\n$$\n\\frac{d x_{i}(t)}{d t} = -\\frac{x_{i}(t)}{\\tau_{e}} + \\sum_{k} \\delta\\big(t - t^{\\text{pre}}_{k}\\big), \\quad\n\\frac{d y_{j}(t)}{d t} = -\\frac{y_{j}(t)}{\\tau_{e}} + \\sum_{\\ell} \\delta\\big(t - t^{\\text{post}}_{\\ell}\\big),\n$$\nwith initial conditions $x_{i}(0) = 0$ and $y_{j}(0) = 0$.\n2. The eligibility trace $e_{ij}(t)$ obeys\n$$\n\\frac{d e_{ij}(t)}{d t} = -\\frac{e_{ij}(t)}{\\tau_{e}} + A_{+} \\sum_{\\ell} \\delta\\big(t - t^{\\text{post}}_{\\ell}\\big)\\, x_{i}\\big(t^{-}\\big) + A_{-} \\sum_{k} \\delta\\big(t - t^{\\text{pre}}_{k}\\big)\\, y_{j}\\big(t^{-}\\big),\n$$\nwith $e_{ij}(0) = 0$, where $t^{-}$ denotes the left-limit immediately before the spike time.\n3. The instantaneous synaptic weight update at a prescribed update time $t^{\\ast}$ is given by\n$$\n\\Delta w\\big(t^{\\ast}\\big) = \\eta\\, m\\big(t^{\\ast}\\big)\\, e_{ij}\\big(t^{\\ast}\\big),\n$$\nwith learning rate $\\eta = 1$.\n\nCompute $e_{ij}(t)$ at $t = 60$ ms and the associated instantaneous weight update $\\Delta w(60\\,\\text{ms})$. Express the final answer as an exact analytic expression. Do not include units in your final answer.",
            "solution": "The goal is to compute the eligibility trace $e_{ij}(t)$ at $t=60$ ms and the weight update $\\Delta w(60\\,\\text{ms})$. The value of the eligibility trace is the sum of all past updates (jumps), each decayed exponentially to the target time. A jump occurs at each spike time.\n\nGiven values:\n- Presynaptic spikes: $\\{10, 30\\}$ ms.\n- Postsynaptic spikes: $\\{20, 40\\}$ ms.\n- Chronological spike order: $10$ (pre), $20$ (post), $30$ (pre), $40$ (post).\n- Parameters: $\\tau_{e} = 50$ ms, $A_{+} = 1$, $A_{-} = -1$, $\\eta = 1$, $m(t)=1$.\n\nLet's calculate the contribution of each spike event to the eligibility trace at $t=60$ ms.\n\n1.  **Event at $t = 10$ ms (presynaptic spike):**\n    - A jump in $e_{ij}$ occurs: $\\Delta e_{ij}(10) = A_{-} y_j(10^{-})$.\n    - Since there have been no postsynaptic spikes, $y_j(10^{-}) = 0$. The jump is $0$.\n\n2.  **Event at $t = 20$ ms (postsynaptic spike):**\n    - A jump in $e_{ij}$ occurs: $\\Delta e_{ij}(20) = A_{+} x_i(20^{-})$.\n    - The presynaptic trace $x_i$ was initiated by the spike at $t=10$. Its value just before $t=20$ is $x_i(20^{-}) = \\exp(-\\frac{20-10}{\\tau_e}) = \\exp(-\\frac{10}{50}) = \\exp(-1/5)$.\n    - The jump is $\\Delta e_{ij}(20) = (1) \\cdot \\exp(-1/5) = \\exp(-1/5)$.\n    - This jump decays for $60 - 20 = 40$ ms. Its contribution to $e_{ij}(60)$ is $\\exp(-1/5) \\cdot \\exp(-40/50) = \\exp(-1/5) \\cdot \\exp(-4/5) = \\exp(-1)$.\n\n3.  **Event at $t = 30$ ms (presynaptic spike):**\n    - A jump in $e_{ij}$ occurs: $\\Delta e_{ij}(30) = A_{-} y_j(30^{-})$.\n    - The postsynaptic trace $y_j$ was initiated by the spike at $t=20$. Its value just before $t=30$ is $y_j(30^{-}) = \\exp(-\\frac{30-20}{\\tau_e}) = \\exp(-\\frac{10}{50}) = \\exp(-1/5)$.\n    - The jump is $\\Delta e_{ij}(30) = (-1) \\cdot \\exp(-1/5) = -\\exp(-1/5)$.\n    - This jump decays for $60 - 30 = 30$ ms. Its contribution to $e_{ij}(60)$ is $-\\exp(-1/5) \\cdot \\exp(-30/50) = -\\exp(-1/5) \\cdot \\exp(-3/5) = -\\exp(-4/5)$.\n\n4.  **Event at $t = 40$ ms (postsynaptic spike):**\n    - A jump in $e_{ij}$ occurs: $\\Delta e_{ij}(40) = A_{+} x_i(40^{-})$.\n    - The presynaptic trace has contributions from spikes at $t=10$ and $t=30$: $x_i(40^{-}) = \\exp(-\\frac{40-10}{\\tau_e}) + \\exp(-\\frac{40-30}{\\tau_e}) = \\exp(-30/50) + \\exp(-10/50) = \\exp(-3/5) + \\exp(-1/5)$.\n    - The jump is $\\Delta e_{ij}(40) = (1) \\cdot \\left(\\exp(-3/5) + \\exp(-1/5)\\right)$.\n    - This jump decays for $60 - 40 = 20$ ms. Its contribution to $e_{ij}(60)$ is $\\left(\\exp(-3/5) + \\exp(-1/5)\\right) \\cdot \\exp(-20/50) = \\exp(-3/5)\\exp(-2/5) + \\exp(-1/5)\\exp(-2/5) = \\exp(-5/5) + \\exp(-3/5) = \\exp(-1) + \\exp(-3/5)$.\n\n5.  **Final value of $e_{ij}(60)$:**\n    Sum all the decayed contributions:\n    $$\n    e_{ij}(60) = (0) + (\\exp(-1)) + (-\\exp(-4/5)) + (\\exp(-1) + \\exp(-3/5))\n    $$\n    $$\n    e_{ij}(60) = 2\\exp(-1) + \\exp\\left(-\\frac{3}{5}\\right) - \\exp\\left(-\\frac{4}{5}\\right)\n    $$\n\n6.  **Weight update $\\Delta w(60)$:**\n    The update is $\\Delta w(60) = \\eta \\cdot m(60) \\cdot e_{ij}(60)$. With $\\eta=1$ and $m(60)=1$:\n    $$\n    \\Delta w(60) = 1 \\cdot 1 \\cdot e_{ij}(60) = e_{ij}(60) = 2\\exp(-1) + \\exp\\left(-\\frac{3}{5}\\right) - \\exp\\left(-\\frac{4}{5}\\right)\n    $$\n    Reordering to match the answer format yields $\\exp\\left(-\\frac{3}{5}\\right) - \\exp\\left(-\\frac{4}{5}\\right) + 2\\exp(-1)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp\\left(-\\frac{3}{5}\\right) - \\exp\\left(-\\frac{4}{5}\\right) + 2\\exp(-1) & \\exp\\left(-\\frac{3}{5}\\right) - \\exp\\left(-\\frac{4}{5}\\right) + 2\\exp(-1) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Three-factor rules provide a powerful bridge between low-level synaptic events and high-level learning algorithms, such as reinforcement learning (RL). This practice problem demonstrates this connection by framing the neuromodulatory signal as a temporal-difference (TD) error, a core concept in RL for evaluating outcomes. You will calculate how this error signal, represented by $\\delta(t)$, interacts with the local eligibility trace to drive purposeful, goal-directed learning at the synapse.",
            "id": "4066380",
            "problem": "Consider a discrete-time episodic reinforcement learning (RL) setting in which a scalar neuromodulatory signal gates synaptic plasticity through a three-factor learning rule. The neuromodulatory signal is the temporal-difference (TD) reward prediction error understood as the single-step Bellman residual for an episodic task whose terminal state has zero value. A postsynaptic neuron receives a reward sequence $r(1)=0$, $r(2)=0$, $r(3)=1$ over time steps $t \\in \\{1,2,3\\}$ within a single episode. The critic provides state value estimates $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$, and the discount factor is $\\gamma=0.9$. The episode terminates after $t=3$, and the terminal value is $V(4)=0$. For a particular synapse $(i,j)$, the synapse-specific eligibility trace values at the same time steps are given by $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$. Assume a constant learning rate $\\eta=0.2$, and that the instantaneous synaptic increment at time $t$ is proportional to the product of the neuromodulatory signal and the eligibility at that time.\n\nUsing only the definitions of the Bellman residual for finite-horizon episodic prediction and the three-factor neuromodulated plasticity principle, compute:\n- the sequence of temporal-difference errors $\\delta(1)$, $\\delta(2)$, $\\delta(3)$, and\n- the corresponding instantaneous synaptic increments $\\Delta w_{ij}(1)$, $\\Delta w_{ij}(2)$, $\\Delta w_{ij}(3)$.\n\nProvide the final answer as a single row matrix in the order $[\\delta(1),\\ \\delta(2),\\ \\delta(3),\\ \\Delta w_{ij}(1),\\ \\Delta w_{ij}(2),\\ \\Delta w_{ij}(3)]$. No rounding is required and no units are to be included in the final answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and complete. All necessary information is provided, and the requested calculations are based on standard principles of reinforcement learning and computational neuroscience.\n\nThe first step is to compute the sequence of temporal-difference (TD) errors, denoted by $\\delta(t)$. The problem defines the TD error as the single-step Bellman residual for an episodic task. The formula for the TD error at time step $t$ is:\n$$\n\\delta(t) = r(t) + \\gamma V(t+1) - V(t)\n$$\nwhere $r(t)$ is the reward received at time $t$, $V(t)$ is the estimated value of the state at time $t$, and $\\gamma$ is the discount factor.\n\nWe are given the following values:\n- Reward sequence: $r(1)=0$, $r(2)=0$, $r(3)=1$.\n- State value estimates: $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$.\n- Terminal state value: $V(4)=0$.\n- Discount factor: $\\gamma=0.9$.\n\nUsing these values, we can calculate $\\delta(t)$ for each time step $t \\in \\{1, 2, 3\\}$.\n\nFor $t=1$:\n$$\n\\delta(1) = r(1) + \\gamma V(2) - V(1) = 0 + (0.9)(0.3) - 0.2 = 0.27 - 0.2 = 0.07\n$$\n\nFor $t=2$:\n$$\n\\delta(2) = r(2) + \\gamma V(3) - V(2) = 0 + (0.9)(0.4) - 0.3 = 0.36 - 0.3 = 0.06\n$$\n\nFor $t=3$:\nThe episode terminates at $t=3$, so the next state is the terminal state with value $V(4)=0$.\n$$\n\\delta(3) = r(3) + \\gamma V(4) - V(3) = 1 + (0.9)(0) - 0.4 = 1 - 0.4 = 0.6\n$$\n\nThe sequence of TD errors is therefore $\\delta(1)=0.07$, $\\delta(2)=0.06$, and $\\delta(3)=0.6$.\n\nThe second step is to compute the corresponding sequence of instantaneous synaptic increments, $\\Delta w_{ij}(t)$. The problem states that this increment follows a three-factor learning rule where it is proportional to the product of the neuromodulatory signal ($\\delta(t)$) and the synapse-specific eligibility trace ($e_{ij}(t)$). The constant of proportionality is the learning rate $\\eta$. The formula is:\n$$\n\\Delta w_{ij}(t) = \\eta \\cdot \\delta(t) \\cdot e_{ij}(t)\n$$\n\nWe are given the additional values:\n- Learning rate: $\\eta=0.2$.\n- Eligibility trace values: $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$.\n\nUsing these values and the previously computed TD errors, we can calculate $\\Delta w_{ij}(t)$ for each time step.\n\nFor $t=1$:\n$$\n\\Delta w_{ij}(1) = \\eta \\cdot \\delta(1) \\cdot e_{ij}(1) = (0.2)(0.07)(0.5) = 0.014 \\cdot 0.5 = 0.007\n$$\n\nFor $t=2$:\n$$\n\\Delta w_{ij}(2) = \\eta \\cdot \\delta(2) \\cdot e_{ij}(2) = (0.2)(0.06)(0.25) = 0.012 \\cdot 0.25 = 0.003\n$$\n\nFor $t=3$:\n$$\n\\Delta w_{ij}(3) = \\eta \\cdot \\delta(3) \\cdot e_{ij}(3) = (0.2)(0.6)(0.1) = 0.12 \\cdot 0.1 = 0.012\n$$\n\nThe sequence of instantaneous synaptic increments is $\\Delta w_{ij}(1)=0.007$, $\\Delta w_{ij}(2)=0.003$, and $\\Delta w_{ij}(3)=0.012$.\n\nThe final answer requires a single row matrix containing both sequences in the order $[\\delta(1), \\delta(2), \\delta(3), \\Delta w_{ij}(1), \\Delta w_{ij}(2), \\Delta w_{ij}(3)]$.\nSubstituting the calculated values, we get:\n$$\n[0.07, 0.06, 0.6, 0.007, 0.003, 0.012]\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.07 & 0.06 & 0.6 & 0.007 & 0.003 & 0.012\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "For a learning rule to be effective, its parameters must be matched to the structure of the task, particularly the delay between an action and its consequences. This final exercise delves into this design principle by asking you to find the optimal time constant $\\tau_e$ for an eligibility trace given a fixed reward delay $\\tau_R$. By deriving the signal-to-noise ratio of the weight update, you will uncover a fundamental relationship between the timescale of synaptic memory and the temporal challenge of credit assignment.",
            "id": "4066352",
            "problem": "Consider a single synapse in a spiking neural network updated by a three-factor learning rule, where the instantaneous synaptic weight change is proportional to the product of an eligibility trace and a neuromodulatory signal. Over a single trial, the weight change is\n$$\n\\Delta w \\propto \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt,\n$$\nwhere $e(t)$ is an eligibility trace and $M(t)$ is a neuromodulatory signal associated with reward. The eligibility trace $e(t)$ is generated by presynaptic spikes and evolves as a linear filter with time constant $\\tau_e$:\n$$\n\\frac{d e(t)}{dt} = -\\frac{1}{\\tau_e} e(t) + \\sum_{k} \\delta(t - t_k),\n$$\nwhere $\\{t_k\\}$ are the presynaptic spike times and $\\delta(\\cdot)$ is the Dirac delta. Assume that:\n- The presynaptic spike train is the superposition of a background homogeneous Poisson process of rate $r$ and, on trials where a cue at time $t=0$ is presented, a single additional presynaptic spike at $t=0$.\n- The neuromodulatory signal for reward is a punctual event at a fixed delay $\\tau_R > 0$ after the cue, modeled as $M(t) = \\delta(t - \\tau_R)$.\n\nDefine the signal contribution to the weight update as the mean incremental weight change due to the cue-evoked spike, that is, the difference between the expected weight change on cue trials and the expected weight change on no-cue trials. Define the noise as the standard deviation of the weight change on cue trials arising from background presynaptic spiking. Using only these assumptions and fundamental properties of linear filtering and homogeneous Poisson shot noise, do the following:\n\n1. Derive an expression for the signal-to-noise ratio (SNR) of the weight update as a function of $\\tau_e$, $\\tau_R$, and $r$.\n2. Determine the value of $\\tau_e$ that maximizes this SNR.\n\nExpress your final answer for the optimal $\\tau_e$ as a closed-form analytic expression in terms of $\\tau_R$ only. No rounding is required, and no units should be provided in the final boxed answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, mathematically well-posed, objective, and contains all necessary information for a unique solution. It is a standard theoretical problem in computational neuroscience.\n\nFirst, we determine the explicit form of the eligibility trace $e(t)$. The dynamics are given by the first-order linear ordinary differential equation:\n$$\n\\frac{d e(t)}{dt} + \\frac{1}{\\tau_e} e(t) = \\sum_{k} \\delta(t - t_k)\n$$\nThis is a linear time-invariant system. The impulse response, which is the solution for a single input spike at $t=0$, is $h(t) = \\exp(-t/\\tau_e)$ for $t \\ge 0$. By linearity, the eligibility trace at time $t$ is the sum of the responses to all preceding presynaptic spikes $\\{t_k\\}$:\n$$\ne(t) = \\sum_{k \\text{ s.t. } t_k \\le t} \\exp\\left(-\\frac{t - t_k}{\\tau_e}\\right)\n$$\nThe total weight change $\\Delta w$ over a trial is proportional to the integral of the product of the eligibility trace $e(t)$ and the neuromodulatory signal $M(t)$. Let the constant of proportionality be $A$.\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt\n$$\nGiven the neuromodulatory signal is $M(t) = \\delta(t - \\tau_R)$, we can use the sifting property of the Dirac delta function to evaluate the integral:\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, \\delta(t - \\tau_R)\\, dt = A \\cdot e(\\tau_R)\n$$\nSubstituting the expression for $e(t)$ at $t=\\tau_R$:\n$$\n\\Delta w = A \\sum_{k \\text{ s.t. } t_k < \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_k}{\\tau_e}\\right)\n$$\nNote we use $t_k < \\tau_R$ because if a spike occurs exactly at $t_k=\\tau_R$, it does not contribute to $e(\\tau_R)$.\n\nThe problem specifies two conditions: cue trials and no-cue trials.\nOn no-cue trials, the presynaptic spikes $\\{t_k\\}$ are generated by a homogeneous Poisson process with rate $r$. Let's denote the set of these spike times as $\\{t_j^{\\text{bg}}\\}$. The weight change is:\n$$\n\\Delta w_{\\text{no-cue}} = A \\sum_{j \\text{ s.t. } t_j^{\\text{bg}} < \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right)\n$$\nOn cue trials, there is an additional presynaptic spike at $t=0$. Since $\\tau_R > 0$ is given, this spike occurs before the neuromodulatory signal. The spike train is the superposition of the background process and the cue spike. The weight change is:\n$$\n\\Delta w_{\\text{cue}} = A \\left( \\exp\\left(-\\frac{\\tau_R - 0}{\\tau_e}\\right) + \\sum_{j \\text{ s.t. } t_j^{\\text{bg}} < \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right) \\right)\n$$\n$$\n\\Delta w_{\\text{cue}} = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\n$$\n\nNow we compute the signal and noise as defined in the problem.\n\n**1. Signal Calculation**\nThe signal is the difference between the expected weight change on cue trials and no-cue trials:\n$$\n\\text{Signal} = \\mathbb{E}[\\Delta w_{\\text{cue}}] - \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\nTaking the expectation of $\\Delta w_{\\text{cue}}$:\n$$\n\\mathbb{E}[\\Delta w_{\\text{cue}}] = \\mathbb{E}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\nThe first term is a deterministic constant. Therefore, the signal is:\n$$\n\\text{Signal} = \\left(A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\\right) - \\mathbb{E}[\\Delta w_{\\text{no-cue}}] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)\n$$\n\n**2. Noise Calculation**\nThe noise is the standard deviation of the weight change on cue trials:\n$$\n\\text{Noise} = \\text{StdDev}[\\Delta w_{\\text{cue}}] = \\sqrt{\\text{Var}[\\Delta w_{\\text{cue}}]}\n$$\nWe compute the variance of $\\Delta w_{\\text{cue}}$:\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right]\n$$\nSince adding a constant does not change the variance of a random variable, we have:\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}[\\Delta w_{\\text{no-cue}}]\n$$\nThe noise is therefore entirely due to the stochasticity of the background Poisson spike train. $\\Delta w_{\\text{no-cue}}$ corresponds to a filtered Poisson process, also known as shot noise, evaluated at time $t=\\tau_R$. The variance of a shot noise process $S(t) = \\sum_i h(t-t_i)$ generated by a homogeneous Poisson process of rate $r$ is given by Campbell's theorem: $\\text{Var}[S(t)] = r \\int_{-\\infty}^{\\infty} h(\\tau)^2 d\\tau$. In our case, filtering is causal, so the integral is over $[0, \\infty)$.\nThe quantity $\\Delta w_{\\text{no-cue}} = A \\cdot e_{\\text{bg}}(\\tau_R)$, where $e_{\\text{bg}}(\\tau_R)$ is the eligibility trace at $\\tau_R$ from the background process. The variance of $e_{\\text{bg}}(t)$ for a stationary input is constant in time.\n$$\n\\text{Var}[e_{\\text{bg}}(t)] = r \\int_0^\\infty \\left[\\exp\\left(-\\frac{\\tau}{\\tau_e}\\right)\\right]^2 d\\tau = r \\int_0^\\infty \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) d\\tau\n$$\n$$\n= r \\left[ -\\frac{\\tau_e}{2} \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) \\right]_0^\\infty = r \\left( 0 - \\left(-\\frac{\\tau_e}{2}\\right) \\right) = \\frac{r \\tau_e}{2}\n$$\nThe variance of the weight change from the background is then:\n$$\n\\text{Var}[\\Delta w_{\\text{no-cue}}] = \\text{Var}[A \\cdot e_{\\text{bg}}(\\tau_R)] = A^2 \\text{Var}[e_{\\text{bg}}(\\tau_R)] = A^2 \\frac{r \\tau_e}{2}\n$$\nThe noise is the standard deviation:\n$$\n\\text{Noise} = \\sqrt{A^2 \\frac{r \\tau_e}{2}} = A \\sqrt{\\frac{r \\tau_e}{2}}\n$$\n\n**3. Signal-to-Noise Ratio (SNR) and its Maximization**\nThe SNR is the ratio of the signal to the noise:\n$$\n\\text{SNR}(\\tau_e) = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{A \\sqrt{\\frac{r \\tau_e}{2}}} = \\sqrt{\\frac{2}{r}} \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}\n$$\nThis completes the first part of the problem. To find the value of $\\tau_e$ that maximizes the SNR, we can equivalently maximize the function $f(\\tau_e) = \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}$, as $\\sqrt{2/r}$ is a positive constant.\nWe find the derivative of $f(\\tau_e)$ with respect to $\\tau_e$ and set it to zero. Let's use the product rule on $f(\\tau_e) = \\exp(-\\tau_R/\\tau_e) \\cdot \\tau_e^{-1/2}$:\n$$\n\\frac{df}{d\\tau_e} = \\left(\\frac{d}{d\\tau_e}\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)\\right) \\tau_e^{-1/2} + \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(\\frac{d}{d\\tau_e}\\tau_e^{-1/2}\\right)\n$$\n$$\n\\frac{df}{d\\tau_e} = \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(\\frac{\\tau_R}{\\tau_e^2}\\right) \\tau_e^{-1/2} + \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(-\\frac{1}{2} \\tau_e^{-3/2}\\right)\n$$\nSetting the derivative to zero, and factoring out the common term $\\exp(-\\tau_R/\\tau_e) \\tau_e^{-3/2}$ (which is non-zero for $\\tau_e > 0$):\n$$\n\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\tau_e^{-3/2} \\left( \\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} \\right) = 0\n$$\nThis requires the term in the parenthesis to be zero:\n$$\n\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} = 0\n$$\n$$\n\\frac{\\tau_R}{\\tau_e} = \\frac{1}{2}\n$$\nSolving for $\\tau_e$ gives the optimal value:\n$$\n\\tau_e = 2 \\tau_R\n$$\nTo confirm this is a maximum, we can check the sign of the first derivative around this point. The sign of $\\frac{df}{d\\tau_e}$ is determined by the sign of $(\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2})$.\n- If $\\tau_e < 2\\tau_R$, then $\\frac{\\tau_R}{\\tau_e} > \\frac{1}{2}$, so $\\frac{df}{d\\tau_e} > 0$ (function is increasing).\n- If $\\tau_e > 2\\tau_R$, then $\\frac{\\tau_R}{\\tau_e} < \\frac{1}{2}$, so $\\frac{df}{d\\tau_e} < 0$ (function is decreasing).\nThis confirms that $\\tau_e = 2 \\tau_R$ is a global maximum.\nThe optimal eligibility trace time constant is twice the reward delay.",
            "answer": "$$\\boxed{2\\tau_R}$$"
        }
    ]
}