{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of balanced network theory is the concept of fluctuation-driven firing. In this regime, the mean synaptic input to a neuron is held just below its firing threshold, while large, canceling excitatory and inhibitory currents generate significant fluctuations. This practice challenges you to derive, from first principles, the average firing rate of a neuron receiving such input, modeled as a Gaussian process. This calculation  is fundamental for understanding how neurons operate in the high-conductance state characteristic of the cortex.",
            "id": "4036607",
            "problem": "Consider a single rate-based neuron embedded in a large, balanced excitatory-inhibitory circuit. Due to the balance of excitation and inhibition, the net mean synaptic input current to the neuron is approximately zero, so that at stationarity the instantaneous input current $I$ can be modeled as a fast Gaussian fluctuation with mean $\\mu \\approx 0$ and variance $\\sigma^{2}$. Assume that the fluctuation timescale is much shorter than the rate readout timescale so that the mean firing rate equals the stationary ensemble average over the input distribution. The neuron's input-output nonlinearity is an idealized threshold-linear function, i.e., a rectified linear function: the instantaneous firing rate is $f(I) = \\gamma [I - \\theta]_{+}$, where $[x]_{+} = \\max(x, 0)$, $\\gamma > 0$ is a gain parameter, and $\\theta > 0$ is the effective threshold. Starting from the definition of expectation under a Gaussian distribution and without assuming any specific form beyond normality of the input distribution, derive the closed-form expression for the stationary mean firing rate $r = \\mathbb{E}[f(I)]$ in the balanced limit $\\mu \\to 0$, expressed in terms of $\\gamma$, $\\theta$, and $\\sigma$. Express your final answer using the standard normal probability density function $\\phi(\\cdot)$ and the standard normal cumulative distribution function $\\Phi(\\cdot)$, and provide a single closed-form analytical expression. No numerical rounding is required.",
            "solution": "The problem asks for the derivation of the stationary mean firing rate $r$ of a neuron with a rectified linear input-output function, a model often used in theoretical neuroscience. The neuron is assumed to receive synaptic input current $I$ that follows a Gaussian distribution.\n\nThe problem is valid as it is scientifically grounded in standard neural modeling, is well-posed with all necessary information provided, and is formulated objectively. We can proceed with the derivation.\n\nThe mean firing rate $r$ is defined as the expectation of the instantaneous firing rate function $f(I)$ over the distribution of the input current $I$.\n$$r = \\mathbb{E}[f(I)] = \\int_{-\\infty}^{\\infty} f(I) p(I) dI$$\nwhere $p(I)$ is the probability density function (PDF) of the input current $I$.\n\nThe problem states that the input current $I$ is modeled as a Gaussian fluctuation with mean $\\mu=0$ (the balanced limit) and variance $\\sigma^2$. The PDF for this distribution, $I \\sim \\mathcal{N}(0, \\sigma^2)$, is given by:\n$$p(I) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right)$$\n\nThe neuron's input-output function is a rectified linear function:\n$$f(I) = \\gamma [I - \\theta]_{+}$$\nwhere $[x]_{+} = \\max(x, 0)$, $\\gamma > 0$ is the gain, and $\\theta > 0$ is the threshold.\nThis function is non-zero only for $I > \\theta$, where it equals $\\gamma(I - \\theta)$.\n\nSubstituting the expressions for $f(I)$ and $p(I)$ into the definition of the expectation, we get:\n$$r = \\int_{-\\infty}^{\\infty} \\gamma [I - \\theta]_{+} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI$$\nDue to the rectifier $[I - \\theta]_{+}$, the integrand is zero for $I \\le \\theta$. We can therefore change the lower limit of integration to $\\theta$:\n$$r = \\gamma \\int_{\\theta}^{\\infty} (I - \\theta) \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI$$\nWe can split this integral into two parts:\n$$r = \\frac{\\gamma}{\\sigma\\sqrt{2\\pi}} \\left[ \\int_{\\theta}^{\\infty} I \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI - \\theta \\int_{\\theta}^{\\infty} \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI \\right]$$\n\nLet's evaluate the first integral, which we denote $J_1$:\n$$J_1 = \\int_{\\theta}^{\\infty} I \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI$$\nWe use the substitution $u = -\\frac{I^2}{2\\sigma^2}$. The differential is $du = -\\frac{2I}{2\\sigma^2} dI = -\\frac{I}{\\sigma^2} dI$, which implies $I dI = -\\sigma^2 du$. The limits of integration change from $I=\\theta$ to $u=-\\frac{\\theta^2}{2\\sigma^2}$, and from $I \\to \\infty$ to $u \\to -\\infty$.\n$$J_1 = \\int_{-\\theta^2/(2\\sigma^2)}^{-\\infty} (-\\sigma^2) \\exp(u) du = \\sigma^2 \\int_{-\\infty}^{-\\theta^2/(2\\sigma^2)} \\exp(u) du = \\sigma^2 [\\exp(u)]_{-\\infty}^{-\\theta^2/(2\\sigma^2)}$$\n$$J_1 = \\sigma^2 \\left( \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) - 0 \\right) = \\sigma^2 \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right)$$\n\nNext, we evaluate the second integral, denoted $J_2$:\n$$J_2 = \\int_{\\theta}^{\\infty} \\exp\\left(-\\frac{I^2}{2\\sigma^2}\\right) dI$$\nThis integral is related to the tail probability of a Gaussian distribution. To make this connection explicit, we perform a change of variables to the standard normal variate $z = I/\\sigma$. This gives $I=z\\sigma$ and $dI=\\sigma dz$. The lower limit of integration becomes $z = \\theta/\\sigma$.\n$$J_2 = \\int_{\\theta/\\sigma}^{\\infty} \\exp\\left(-\\frac{z^2}{2}\\right) \\sigma dz = \\sigma \\int_{\\theta/\\sigma}^{\\infty} \\exp\\left(-\\frac{z^2}{2}\\right) dz$$\nThe problem requires the final answer in terms of the standard normal PDF, $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{z^2}{2})$, and the standard normal CDF, $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(x) dx$.\nThe integral $\\int_{\\theta/\\sigma}^{\\infty} \\phi(z) dz$ represents the probability $P(Z > \\theta/\\sigma)$ for a standard normal variable $Z$, which is $1 - P(Z \\le \\theta/\\sigma) = 1 - \\Phi(\\theta/\\sigma)$.\nWe can write $J_2$ in terms of this probability:\n$$J_2 = \\sigma\\sqrt{2\\pi} \\int_{\\theta/\\sigma}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz = \\sigma\\sqrt{2\\pi} \\left(1 - \\Phi\\left(\\frac{\\theta}{\\sigma}\\right)\\right)$$\n\nNow, we substitute the results for $J_1$ and $J_2$ back into the expression for $r$:\n$$r = \\frac{\\gamma}{\\sigma\\sqrt{2\\pi}} \\left[ \\sigma^2 \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) - \\theta \\cdot \\sigma\\sqrt{2\\pi} \\left(1 - \\Phi\\left(\\frac{\\theta}{\\sigma}\\right)\\right) \\right]$$\nSimplifying this expression by distributing the outer factor:\n$$r = \\gamma \\left[ \\frac{\\sigma}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) - \\theta \\left(1 - \\Phi\\left(\\frac{\\theta}{\\sigma}\\right)\\right) \\right]$$\nTo match the required format, we recognize the first term in the brackets. Let's define the normalized threshold $z_{\\theta} = \\theta/\\sigma$. Then:\n$$\\frac{\\sigma}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{\\theta^2}{2\\sigma^2}\\right) = \\sigma \\left( \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{\\theta}{\\sigma}\\right)^2\\right) \\right) = \\sigma \\phi\\left(\\frac{\\theta}{\\sigma}\\right)$$\nSubstituting this back into the expression for $r$ yields the final closed-form solution:\n$$r = \\gamma \\left( \\sigma \\phi\\left(\\frac{\\theta}{\\sigma}\\right) - \\theta \\left[1 - \\Phi\\left(\\frac{\\theta}{\\sigma}\\right)\\right] \\right)$$\nThis expression gives the mean firing rate in terms of the gain $\\gamma$, threshold $\\theta$, and input standard deviation $\\sigma$, using the standard normal PDF $\\phi(\\cdot)$ and CDF $\\Phi(\\cdot)$ as requested.",
            "answer": "$$\\boxed{\\gamma \\left( \\sigma \\phi\\left(\\frac{\\theta}{\\sigma}\\right) - \\theta \\left(1 - \\Phi\\left(\\frac{\\theta}{\\sigma}\\right)\\right) \\right)}$$"
        },
        {
            "introduction": "Moving from a statistical description of input to the biophysical mechanisms of its integration, we now explore how the implementation of inhibition impacts computation. Specifically, 'shunting' inhibition, where the inhibitory reversal potential $E_I$ is close to the neuron's resting potential $E_L$, acts divisively on excitatory inputs rather than simply subtracting from them. This exercise  guides you through the derivation of divisive normalization from a conductance-based neuron model, revealing a direct link between a specific synaptic mechanism and a canonical neural computation.",
            "id": "4036633",
            "problem": "Consider a single conductance-based point neuron receiving both excitatory and inhibitory synaptic inputs. The subthreshold membrane dynamics obey Kirchhoff's Current Law (KCL): the sum of all currents equals the capacitive current. Let the membrane potential be $V(t)$, membrane capacitance be $C$, leak conductance be $g_{L}$ with leak reversal potential $E_{L}$, total excitatory synaptic conductance be $g_{E}(t)$ with excitatory reversal potential $E_{E}$, and total inhibitory synaptic conductance be $g_{I}(t)$ with inhibitory reversal potential $E_{I}$. The membrane equation is\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big)\\;-\\;g_{I}\\,\\big(V - E_{I}\\big)\\;-\\;g_{E}\\,\\big(V - E_{E}\\big).\n$$\nAssume a quasi-static regime in which synaptic conductances vary slowly compared to the membrane time constant, so that $dV/dt \\approx 0$ and the neuron is at a steady subthreshold operating point $V^{\\ast}$. The excitatory input to neuron $i$ is driven by a stimulus $s_{i} \\ge 0$ such that $g_{E} = \\alpha\\,s_{i}$, where $\\alpha > 0$ is a gain parameter. The inhibitory input arises from a pooled representation of the stimulus vector $\\mathbf{s} = (s_{1}, s_{2}, \\dots, s_{n})$ through weights $w_{ij} \\ge 0$, such that $g_{I} = \\beta \\sum_{j=1}^{n} w_{ij}\\,s_{j}$, with $\\beta > 0$ a gain parameter. Let the neuron’s output rate be a linear readout of its distance to the leak reversal potential, $r_{i} = \\kappa\\,(V^{\\ast} - E_{L})$, where $\\kappa > 0$ is a proportionality constant.\n\nStarting from KCL and the conductance-based membrane equation above, and assuming shunting inhibition in the sense that $E_{I} \\approx E_{L}$, derive the steady-state input-output relation $r_{i}(\\mathbf{s})$ and state the minimal biophysical and computational conditions under which the mapping implements divisive normalization of the form “numerator proportional to an excitatory drive, divided by a sum of a constant plus a pooled drive.” Express the final input-output relation in closed form using only the symbols $\\alpha$, $\\beta$, $\\kappa$, $g_{L}$, $E_{E}$, $E_{L}$, $w_{ij}$, and $s_{j}$.\n\nYour final answer must be a single closed-form analytic expression for $r_{i}(\\mathbf{s})$. No numerical evaluation is required.",
            "solution": "The derivation begins with the conductance-based membrane equation, an application of Kirchhoff's Current Law:\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big)\\;-\\;g_{I}\\,\\big(V - E_{I}\\big)\\;-\\;g_{E}\\,\\big(V - E_{E}\\big)\n$$\nThe first condition is the quasi-static assumption, which posits that the membrane potential $V(t)$ equilibrates much faster than the synaptic conductances $g_E(t)$ and $g_I(t)$ change. This allows us to find the steady-state operating point $V^{\\ast}$ by setting the capacitive current to zero, $C \\frac{dV}{dt} = 0$:\n$$\n0 \\;=\\; -\\,g_{L}\\,\\big(V^{\\ast} - E_{L}\\big)\\;-\\;g_{I}\\,\\big(V^{\\ast} - E_{I}\\big)\\;-\\;g_{E}\\,\\big(V^{\\ast} - E_{E}\\big)\n$$\nWe can solve this algebraic equation for $V^{\\ast}$. Rearranging the terms to group those with $V^{\\ast}$:\n$$\nV^{\\ast}\\big( g_{L} + g_{I} + g_{E} \\big) \\;=\\; g_{L}E_{L} + g_{I}E_{I} + g_{E}E_{E}\n$$\nThis yields the steady-state membrane potential as a weighted average of the reversal potentials, where the weights are the respective conductances:\n$$\nV^{\\ast} \\;=\\; \\frac{g_{L}E_{L} + g_{I}E_{I} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}}\n$$\nThe second crucial condition is that of shunting inhibition, meaning the inhibitory reversal potential is approximately equal to the leak reversal potential, $E_{I} \\approx E_{L}$. This is a key biophysical condition. Applying this condition $E_{I} = E_{L}$ to the expression for $V^{\\ast}$:\n$$\nV^{\\ast} \\;=\\; \\frac{g_{L}E_{L} + g_{I}E_{L} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}} \\;=\\; \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}}\n$$\nThe neuron's output rate $r_i$ is defined as a linear function of the voltage difference from the leak potential, $r_{i} = \\kappa\\,(V^{\\ast} - E_{L})$. We compute this difference:\n$$\nV^{\\ast} - E_{L} \\;=\\; \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E}}{g_{L} + g_{I} + g_{E}} - E_{L}\n$$\n$$\nV^{\\ast} - E_{L} \\;=\\; \\frac{(g_{L} + g_{I})E_{L} + g_{E}E_{E} - E_{L}(g_{L} + g_{I} + g_{E})}{g_{L} + g_{I} + g_{E}}\n$$\n$$\nV^{\\ast} - E_{L} \\;=\\; \\frac{g_{L}E_{L} + g_{I}E_{L} + g_{E}E_{E} - g_{L}E_{L} - g_{I}E_{L} - g_{E}E_{L}}{g_{L} + g_{I} + g_{E}}\n$$\n$$\nV^{\\ast} - E_{L} \\;=\\; \\frac{g_{E}(E_{E} - E_{L})}{g_{L} + g_{I} + g_{E}}\n$$\nThis intermediate result reveals the origin of divisive normalization. The neuron's depolarization above rest, $(V^{\\ast} - E_{L})$, is proportional to the excitatory driving force, $g_{E}(E_{E} - E_{L})$, but is divided by the total membrane conductance, $g_{L} + g_{I} + g_{E}$.\n\nTo obtain the final input-output relation $r_i(\\mathbf{s})$, we substitute the given models for the synaptic conductances and the output rate.\nGiven $g_{E} = \\alpha s_{i}$ and $g_{I} = \\beta \\sum_{j=1}^{n} w_{ij} s_{j}$:\n$$\nV^{\\ast} - E_{L} \\;=\\; \\frac{(\\alpha s_{i})(E_{E} - E_{L})}{g_{L} + (\\beta \\sum_{j=1}^{n} w_{ij} s_{j}) + (\\alpha s_{i})}\n$$\nFinally, the output rate is $r_{i} = \\kappa (V^{\\ast} - E_{L})$:\n$$\nr_{i}(\\mathbf{s}) \\;=\\; \\kappa \\frac{\\alpha s_{i} (E_{E} - E_{L})}{g_{L} + \\alpha s_{i} + \\beta \\sum_{j=1}^{n} w_{ij} s_{j}}\n$$\nThis expression has the precise form of divisive normalization. The numerator, $\\kappa \\alpha (E_{E} - E_{L}) s_{i}$, is proportional to the excitatory drive $s_i$. The denominator is a sum of a constant, $g_L$, and a \"pooled drive,\" which is the total stimulus-dependent conductance $\\alpha s_{i} + \\beta \\sum_{j=1}^{n} w_{ij} s_{j}$.\n\nThe minimal conditions are:\n1. Biophysical: The neuron is described by a conductance-based model, and inhibition is of the \"shunting\" type, where $E_{I} \\approx E_{L}$.\n2. Computational/Modeling: The system operates in a quasi-static regime ($dV/dt \\approx 0$), and the relationships between stimulus and conductance, and between voltage and firing rate are linear.",
            "answer": "$$\n\\boxed{\\frac{\\kappa \\alpha (E_{E} - E_{L}) s_{i}}{g_{L} + \\alpha s_{i} + \\beta \\sum_{j=1}^{n} w_{ij} s_{j}}}\n$$"
        },
        {
            "introduction": "Having examined the behavior of single neurons within a balanced environment, we now scale up to the network level to understand how populations of excitatory and inhibitory neurons interact. A key functional advantage of balanced E/I networks is their ability to respond to inputs in a rapid and controlled manner, avoiding saturation and enabling faithful signal transmission. In this final practice , you will perform a linear analysis to determine how the firing rates of a two-population network shift in response to an external drive, illustrating the stable and linear input-output properties of the balanced state.",
            "id": "4036548",
            "problem": "Consider a two-population, current-based firing-rate network, representative of neuromorphic hardware implementing balanced excitatory-inhibitory circuit motifs. The excitatory population has firing rate $r_{E}$ and the inhibitory population has firing rate $r_{I}$. The stationary input currents to the populations are\n$$\nh_{E} = J_{EE}\\,r_{E} - J_{EI}\\,r_{I} + I_{E} + I_{ext}, \\qquad\nh_{I} = J_{IE}\\,r_{E} - J_{II}\\,r_{I} + I_{I},\n$$\nwhere $J_{pq}$ denotes the effective coupling from population $q \\in \\{E,I\\}$ to population $p \\in \\{E,I\\}$, with $J_{EE} \\ge 0$, $J_{IE} \\ge 0$, $J_{EI} \\ge 0$, and $J_{II} \\ge 0$ denoting the respective excitatory and inhibitory synaptic strengths in a current-based convention, and $I_{E}$, $I_{I}$ are constant baseline input currents. The stationary firing rates satisfy the static input-output relations\n$$\nr_{E} = \\phi_{E}(h_{E}), \\qquad r_{I} = \\phi_{I}(h_{I}),\n$$\nwhere $\\phi_{E}(\\cdot)$ and $\\phi_{I}(\\cdot)$ are smooth, strictly increasing nonlinear transfer functions characterizing the neuromorphic neuron circuits.\n\nAssume there exists a stable balanced fixed point $(r_{E}^{\\ast}, r_{I}^{\\ast})$ for $I_{ext}=0$, with corresponding operating inputs $h_{E}^{\\ast}$ and $h_{I}^{\\ast}$. Define the local gains $g_{E} = \\phi_{E}'(h_{E}^{\\ast})$ and $g_{I} = \\phi_{I}'(h_{I}^{\\ast})$, which are strictly positive real numbers due to the monotonicity of $\\phi_{E}$ and $\\phi_{I}$.\n\nNow apply a small external drive $I_{ext}$ additively to the excitatory input channel only, keeping all other parameters fixed. Working to first order in $I_{ext}$ and starting only from the above definitions and the assumption of smoothness and stability of the fixed point, derive the linear response of the firing rates $(r_{E}, r_{I})$ around the balanced operating point. Concretely, obtain the closed-form expression for the vector of firing rate shifts\n$$\n\\begin{pmatrix}\n\\delta r_{E} \\\\\n\\delta r_{I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nr_{E} - r_{E}^{\\ast} \\\\\nr_{I} - r_{I}^{\\ast}\n\\end{pmatrix}\n$$\nto first order in $I_{ext}$, expressed entirely in terms of $J_{EE}$, $J_{EI}$, $J_{IE}$, $J_{II}$, $g_{E}$, $g_{I}$, and $I_{ext}$.\n\nYour final answer must be a single closed-form analytic expression for the $2 \\times 1$ vector $\\begin{pmatrix}\\delta r_{E} \\\\ \\delta r_{I}\\end{pmatrix}$. Do not include units in your final expression. If any intermediate approximations are made, justify them from the problem setup. No rounding is required.",
            "solution": "The problem asks for the linear response of a two-population firing-rate network to a small external input. We begin by establishing the state of the system at the fixed point and then analyze the perturbations around this point.\n\nThe stationary state of the network is defined by a set of self-consistent equations. At a fixed point $(r_{E}^{\\ast}, r_{I}^{\\ast})$, with no external drive ($I_{ext}=0$), the system satisfies:\n$$h_{E}^{\\ast} = J_{EE}\\,r_{E}^{\\ast} - J_{EI}\\,r_{I}^{\\ast} + I_{E}$$\n$$h_{I}^{\\ast} = J_{IE}\\,r_{E}^{\\ast} - J_{II}\\,r_{I}^{\\ast} + I_{I}$$\n$$r_{E}^{\\ast} = \\phi_{E}(h_{E}^{\\ast})$$\n$$r_{I}^{\\ast} = \\phi_{I}(h_{I}^{\\ast})$$\n\nNow, we introduce a small external current $I_{ext}$ to the excitatory population. This shifts the system to a new fixed point $(r_{E}, r_{I})$. We express the new state variables as perturbations around the original fixed point: $r_{E} = r_{E}^{\\ast} + \\delta r_{E}$, $r_{I} = r_{I}^{\\ast} + \\delta r_{I}$, and the input currents as $h_{E} = h_{E}^{\\ast} + \\delta h_{E}$, $h_{I} = h_{I}^{\\ast} + \\delta h_{I}$.\n\nThe new stationary state equations are:\n$$h_{E} = J_{EE}\\,r_{E} - J_{EI}\\,r_{I} + I_{E} + I_{ext}$$\n$$h_{I} = J_{IE}\\,r_{E} - J_{II}\\,r_{I} + I_{I}$$\nTo find the relationship between the perturbations, we subtract the original fixed-point equations from the new ones. For the input currents, we get:\n$$\\delta h_{E} = h_{E} - h_{E}^{\\ast} = J_{EE}\\,\\delta r_{E} - J_{EI}\\,\\delta r_{I} + I_{ext}$$\n$$\\delta h_{I} = h_{I} - h_{I}^{\\ast} = J_{IE}\\,\\delta r_{E} - J_{II}\\,\\delta r_{I}$$\n\nThe problem asks for a first-order approximation, so we linearize the nonlinear transfer functions $\\phi_{E}$ and $\\phi_{I}$ around their operating points using a first-order Taylor expansion. With the local gains defined as $g_{E} = \\phi_{E}'(h_{E}^{\\ast})$ and $g_{I} = \\phi_{I}'(h_{I}^{\\ast})$:\n$$\\delta r_{E} = r_{E} - r_{E}^{\\ast} = \\phi_{E}(h_{E}^{\\ast} + \\delta h_{E}) - \\phi_{E}(h_{E}^{\\ast}) \\approx \\phi_{E}'(h_{E}^{\\ast})\\,\\delta h_{E} = g_{E}\\,\\delta h_{E}$$\n$$\\delta r_{I} = r_{I} - r_{I}^{\\ast} = \\phi_{I}(h_{I}^{\\ast} + \\delta h_{I}) - \\phi_{I}(h_{I}^{\\ast}) \\approx \\phi_{I}'(h_{I}^{\\ast})\\,\\delta h_{I} = g_{I}\\,\\delta h_{I}$$\n\nWe substitute the expressions for $\\delta h_{E}$ and $\\delta h_{I}$ into the linearized rate equations:\n1) $\\delta r_{E} = g_{E}\\,(J_{EE}\\,\\delta r_{E} - J_{EI}\\,\\delta r_{I} + I_{ext})$\n2) $\\delta r_{I} = g_{I}\\,(J_{IE}\\,\\delta r_{E} - J_{II}\\,\\delta r_{I})$\n\nTo solve for $\\delta r_{E}$ and $\\delta r_{I}$, we rearrange these equations into a standard linear system format $A\\mathbf{x} = \\mathbf{b}$:\n$$(1 - g_{E}J_{EE})\\,\\delta r_{E} + (g_{E}J_{EI})\\,\\delta r_{I} = g_{E}I_{ext}$$\n$$(-g_{I}J_{IE})\\,\\delta r_{E} + (1 + g_{I}J_{II})\\,\\delta r_{I} = 0$$\n\nThis system can be written in matrix form:\n$$\n\\begin{pmatrix}\n1 - g_{E}J_{EE} & g_{E}J_{EI} \\\\\n-g_{I}J_{IE} & 1 + g_{I}J_{II}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\delta r_{E} \\\\\n\\delta r_{I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ng_{E}I_{ext} \\\\\n0\n\\end{pmatrix}\n$$\nThe solution is found by inverting the $2 \\times 2$ matrix, $M$. Its determinant is:\n$$\\det(M) = (1 - g_{E}J_{EE})(1 + g_{I}J_{II}) - (g_{E}J_{EI})(-g_{I}J_{IE})$$\n$$\\det(M) = 1 - g_{E}J_{EE} + g_{I}J_{II} - g_{E}g_{I}(J_{EE}J_{II} - J_{EI}J_{IE})$$\nThe problem states that the fixed point is stable, which ensures that this determinant is non-zero, so the matrix is invertible.\n\nThe inverse of matrix $M$ is:\n$$\nM^{-1} = \\frac{1}{\\det(M)}\n\\begin{pmatrix}\n1 + g_{I}J_{II} & -g_{E}J_{EI} \\\\\ng_{I}J_{IE} & 1 - g_{E}J_{EE}\n\\end{pmatrix}\n$$\nThe solution vector of rate shifts is then:\n$$\n\\begin{pmatrix}\n\\delta r_{E} \\\\\n\\delta r_{I}\n\\end{pmatrix}\n= M^{-1}\n\\begin{pmatrix}\ng_{E}I_{ext} \\\\\n0\n\\end{pmatrix}\n= \\frac{1}{\\det(M)}\n\\begin{pmatrix}\n1 + g_{I}J_{II} & -g_{E}J_{EI} \\\\\ng_{I}J_{IE} & 1 - g_{E}J_{EE}\n\\end{pmatrix}\n\\begin{pmatrix}\ng_{E}I_{ext} \\\\\n0\n\\end{pmatrix}\n$$\nPerforming the matrix-vector multiplication:\n$$\n\\begin{pmatrix}\n\\delta r_{E} \\\\\n\\delta r_{I}\n\\end{pmatrix}\n= \\frac{1}{\\det(M)}\n\\begin{pmatrix}\n(1 + g_{I}J_{II})(g_{E}I_{ext}) \\\\\n(g_{I}J_{IE})(g_{E}I_{ext})\n\\end{pmatrix}\n= \\frac{g_{E}I_{ext}}{\\det(M)}\n\\begin{pmatrix}\n1 + g_{I}J_{II} \\\\\ng_{I}J_{IE}\n\\end{pmatrix}\n$$\nSubstituting the full expression for $\\det(M)$ gives the final closed-form expression:\n$$\n\\begin{pmatrix}\n\\delta r_{E} \\\\\n\\delta r_{I}\n\\end{pmatrix}\n= \\frac{g_{E}I_{ext}}{1 - g_{E}J_{EE} + g_{I}J_{II} - g_{E}g_{I}(J_{EE}J_{II} - J_{EI}J_{IE})}\n\\begin{pmatrix}\n1 + g_{I}J_{II} \\\\\ng_{I}J_{IE}\n\\end{pmatrix}\n$$\nThis vector represents the linear response of the network's firing rates to the small external drive $I_{ext}$.",
            "answer": "$$\n\\boxed{\n\\frac{g_{E} I_{ext}}{1 - g_{E} J_{EE} + g_{I} J_{II} - g_{E} g_{I} (J_{EE} J_{II} - J_{EI} J_{IE})}\n\\begin{pmatrix}\n1 + g_{I} J_{II} \\\\\ng_{I} J_{IE}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}