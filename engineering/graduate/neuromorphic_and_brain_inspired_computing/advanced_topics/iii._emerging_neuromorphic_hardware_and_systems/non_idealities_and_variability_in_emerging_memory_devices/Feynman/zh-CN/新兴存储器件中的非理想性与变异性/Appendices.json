{
    "hands_on_practices": [
        {
            "introduction": "电导漂移是相变存储器（PCM）中的一个关键非理想特性，它会影响存储的模拟状态的稳定性，对神经形态计算的长期可靠性构成挑战。本练习提供了一个动手实践的机会，通过一个基于热激活的物理模型，来量化温度等环境因素对器件可靠性的影响。通过这个练习，您将深入理解如何对漂移现象进行建模，并分析其对系统操作窗口的影响。",
            "id": "4053917",
            "problem": "一个纳米尺度的相变存储器（PCM）单元由于非晶相的结构弛豫而表现出电导漂移。在与局部振动弛豫相比长、但与结晶相比短的中间时间尺度上，根据经验观察到电导遵循一个与温度相关的漂移指数的标度不变幂律，其模型为\n$$\nG(t;T) = G_0 \\left( \\frac{t}{t_0} \\right)^{-\\nu(T)},\n$$\n其中 $G_0$ 和 $t_0$ 是由编程条件和读取协议设定的常数，$t$ 是编程后的经过时间，$\\nu(T)$ 是一个正的漂移指数。假设漂移指数的温度依赖性遵循一个激活限制的尝试率的阿伦尼乌斯定律，\n$$\n\\nu(T) = \\nu_0 \\exp\\!\\left(-\\frac{E_\\nu}{k_B T}\\right),\n$$\n其中 $\\nu_0$ 是一个常数前置因子，$E_\\nu$ 是一个有效激活能，$k_B$ 是玻尔兹曼常数。将单位对数时间十倍程的无量纲漂移率定义为\n$$\nR(T) := -\\frac{d \\ln G(t;T)}{d \\ln t}.\n$$\n从上述定义出发，不假设任何额外的简化公式，推导一个用 $E_\\nu$、$k_B$、$T_1$ 和 $T_2$ 表示的比率 $R(T_2)/R(T_1)$ 的解析表达式。然后对 $T_1 = 300\\,\\mathrm{K}$、$T_2 = 350\\,\\mathrm{K}$、$E_\\nu = 0.25\\,\\mathrm{eV}$ 和 $k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}$ 的情况，数值计算这个比率。将你的最终答案表示为一个无量纲的十进制数，并四舍五入到四位有效数字。",
            "solution": "电导弛豫模型包含了时间上的标度不变性，这是非晶材料中无序弛豫的一个广泛观察到的特征，也是相变存储器中漂移的基础。我们从给定的幂律形式开始\n$$\nG(t;T) = G_0 \\left( \\frac{t}{t_0} \\right)^{-\\nu(T)}.\n$$\n对两边取自然对数，得到\n$$\n\\ln G(t;T) = \\ln G_0 - \\nu(T)\\,\\ln\\!\\left(\\frac{t}{t_0}\\right).\n$$\n根据定义，单位对数时间十倍程的漂移率是关于时间的负对数导数，\n$$\nR(T) := -\\frac{d \\ln G(t;T)}{d \\ln t}.\n$$\n使用链式法则和电导的对数，我们计算\n$$\n\\frac{d \\ln G(t;T)}{d \\ln t} = \\frac{d \\ln G(t;T)}{d t} \\cdot \\frac{d t}{d \\ln t}.\n$$\n然而，更直接的方法是注意到 $\\ln G(t;T)$ 通过项 $-\\nu(T)\\,\\ln(t/t_0)$ 依赖于 $\\ln t$，并且在计算 $R(T)$ 时 $T$是固定的。因此，\n$$\n\\frac{d \\ln G(t;T)}{d \\ln t} = -\\nu(T)\\,\\frac{d \\ln(t/t_0)}{d \\ln t} = -\\nu(T),\n$$\n因为 $d \\ln(t/t_0)/d \\ln t = 1$。代入 $R(T)$ 的定义中，得到\n$$\nR(T) = \\nu(T).\n$$\n因此，单位对数时间十倍程的漂移率等于漂移指数。根据阿伦尼乌斯温度依赖性\n$$\n\\nu(T) = \\nu_0 \\exp\\!\\left(-\\frac{E_\\nu}{k_B T}\\right),\n$$\n在两个温度 $T_1$ 和 $T_2$ 下的漂移率之比为\n$$\n\\frac{R(T_2)}{R(T_1)} = \\frac{\\nu(T_2)}{\\nu(T_1)} = \\frac{\\nu_0 \\exp\\!\\left(-\\frac{E_\\nu}{k_B T_2}\\right)}{\\nu_0 \\exp\\!\\left(-\\frac{E_\\nu}{k_B T_1}\\right)}.\n$$\n前置因子 $\\nu_0$ 被约去，得到\n$$\n\\frac{R(T_2)}{R(T_1)} = \\exp\\!\\left[-\\frac{E_\\nu}{k_B}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right)\\right].\n$$\n这就是所要求的解析表达式。\n\n接下来，我们对 $T_1 = 300\\,\\mathrm{K}$，$T_2 = 350\\,\\mathrm{K}$，$E_\\nu = 0.25\\,\\mathrm{eV}$ 和 $k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}$ 进行数值计算。首先计算倒数温度差，\n$$\n\\frac{1}{T_2} - \\frac{1}{T_1} = \\frac{1}{350\\,\\mathrm{K}} - \\frac{1}{300\\,\\mathrm{K}} = \\frac{300 - 350}{300 \\times 350}\\,\\mathrm{K}^{-1} = -\\frac{50}{105000}\\,\\mathrm{K}^{-1} \\approx -4.7619047619 \\times 10^{-4}\\,\\mathrm{K}^{-1}.\n$$\n计算因子 $E_\\nu/k_B$，\n$$\n\\frac{E_\\nu}{k_B} = \\frac{0.25\\,\\mathrm{eV}}{8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}} \\approx 2.90112953 \\times 10^{3}\\,\\mathrm{K}.\n$$\n因此，指数变为\n$$\n-\\frac{E_\\nu}{k_B}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right) = -\\left(2.90112953 \\times 10^{3}\\,\\mathrm{K}\\right)\\left(-4.7619047619 \\times 10^{-4}\\,\\mathrm{K}^{-1}\\right) \\approx 1.38149025.\n$$\n最后，该比率为\n$$\n\\frac{R(T_2)}{R(T_1)} = \\exp(1.38149025) \\approx 3.981.\n$$\n这个比率是无量纲的。四舍五入到四位有效数字，结果是 $3.981$。",
            "answer": "$$\\boxed{3.981}$$"
        },
        {
            "introduction": "除了缓慢的漂移，新兴存储器件的电导还表现出更快的随机波动，即噪声，这会干扰神经形态系统中的信号处理。本练习侧重于一项重要的任务：区分两种常见的噪声类型——闪烁噪声（$1/f$ 噪声）和随机电报噪声（RTN）。通过设计一个同时满足频域和时域约束的测量协议，您将学习如何解决噪声表征这一实际挑战，并理解理论模型与实验设计之间的联系。",
            "id": "4053935",
            "problem": "一个在神经形态阵列中用作突触元件的阻性随机存取存储器（RRAM）器件，同时表现出闪烁噪声（通常称为 $1/f$ 噪声）和随机电报噪声（RTN）。您希望设计一个测量协议，通过在频域和时域中进行联合分析，在单一静态偏压条件下可靠地分离这两种噪声机制。您的测量将使用采样频率为 $f_{s}$ 的数字转换器，在恒定偏压下采集器件电流 $I(t)$，进行一次持续时间为 $T_{\\text{obs}}$ 的单次连续观测。\n\n在频域中，您将使用一致估计量（例如 Welch 方法）来估计功率谱密度（PSD），并评估该谱是否可以表示为一个闪烁项 $S_{1/f}(f)$ 和一个 RTN 项 $S_{\\text{RTN}}(f)$ 的和。在时域中，您将分析 $I(t)$ 的幅度直方图，以确定两能级 RTN 的双峰性特征，并提取每个状态下的驻留时间统计数据，以检验跃迁是否为无记忆的。\n\n假设 RTN 源于一个两态连续时间马尔可夫过程，其跃迁速率为 $\\lambda_{1}$（状态 1 到 2）和 $\\lambda_{2}$（状态 2 到 1）。平均驻留时间为 $\\tau_{1} = 1/\\lambda_{1}$ 和 $\\tau_{2} = 1/\\lambda_{2}$，该两态过程的相关时间为 $\\tau_{c} = 1/(\\lambda_{1} + \\lambda_{2}) = \\frac{\\tau_{1}\\,\\tau_{2}}{\\tau_{1} + \\tau_{2}}$。众所周知，一个理想两态 RTN 过程的 PSD 是洛伦兹型的，其角频率为 $f_{c} = 1/(2\\pi \\tau_{c})$，而闪烁噪声在相关频带内表现出 $S_{1/f}(f) \\propto 1/f$ 的特性。\n\n为确保可靠分离 $1/f$ 和 RTN 的贡献：\n\n- 在频域中，要求频率分辨率 $\\Delta f \\approx 1/T_{\\text{obs}}$ 为 RTN 角频率的一小部分 $\\eta$，即 $1/T_{\\text{obs}} \\leq \\eta f_{c}$，以便能够相对于 $1/f$ 背景定位洛伦兹角点。\n- 在时域中，要求每个状态下估计的平均驻留时间的相对标准差不大于目标值 $\\varepsilon$。对于平均值为 $\\tau$ 的指数分布驻留时间统计，来自 $N$ 次独立驻留测量的样本均值的标准差为 $\\tau/\\sqrt{N}$，因此相对标准差为 $1/\\sqrt{N}$。对每个状态施加 $1/\\sqrt{N} \\leq \\varepsilon$ 的约束，并利用以下事实：在长时间观测中，每个状态的预期驻留区间数约为 $N \\approx T_{\\text{obs}}/(\\tau_{1} + \\tau_{2})$。\n\n在这些要求下，推导同时满足频域和时域约束的最小观测时间 $T_{\\text{obs}}$。然后，使用器件参数 $\\tau_{1} = 8~\\text{ms}$、$\\tau_{2} = 12~\\text{ms}$、分辨率分数 $\\eta = 0.05$ 和目标相对标准差 $\\varepsilon = 0.10$ 计算其数值。最终答案以秒为单位表示，并四舍五入至四位有效数字。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。它提出了一个表征新兴存储器件中噪声的现实场景，对一个关键实验参数——观测时间 $T_{\\text{obs}}$——建立了两个独立的约束，并要求找出满足这两个约束的最小值。所提供的物理模型和数学关系在电子噪声分析领域是标准的。因此，我们可以进行推导。\n\n目标是找到最小观测时间 $T_{\\text{obs}}$，该时间能同时满足频域约束和时域约束，以便可靠地分离闪烁噪声和随机电报噪声（RTN）。\n\n让我们分别分析每个约束，以建立 $T_{\\text{obs}}$ 的一个下界。\n\n首先，我们考虑频域约束。该约束确保功率谱密度（PSD）估计的频率分辨率 $\\Delta f$ 足够精细，以便分辨 RTN 谱在其角频率 $f_c$ 附近的洛伦兹形状。频率分辨率从根本上受限于总观测时间，即 $\\Delta f \\approx 1/T_{\\text{obs}}$。问题要求该分辨率为角频率的一小部分 $\\eta$：\n$$\n\\frac{1}{T_{\\text{obs}}} \\leq \\eta f_c\n$$\n这个不等式可以重新整理以求得 $T_{\\text{obs}}$ 的一个下界：\n$$\nT_{\\text{obs}} \\geq \\frac{1}{\\eta f_c}\n$$\n角频率 $f_c$ 通过 $f_c = 1/(2\\pi\\tau_c)$ 与两态 RTN 过程的相关时间 $\\tau_c$ 相关。而相关时间又是两个状态的平均驻留时间 $\\tau_1$ 和 $\\tau_2$ 的函数：\n$$\n\\tau_c = \\frac{1}{\\lambda_1 + \\lambda_2} = \\frac{1}{1/\\tau_1 + 1/\\tau_2} = \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}\n$$\n将这些表达式代入 $T_{\\text{obs}}$ 的不等式中，得到第一个约束，我们将其记作 $T_{\\text{obs, freq}}$：\n$$\nT_{\\text{obs}} \\geq \\frac{1}{\\eta \\left( \\frac{1}{2\\pi\\tau_c} \\right)} = \\frac{2\\pi\\tau_c}{\\eta} = \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}\n$$\n因此，频域约束所要求的最小时间是 $T_{\\text{obs, freq}} = \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}$。\n\n其次，我们考虑时域约束。该约束要求每个状态的估计平均驻留时间的相对标准差不超过一个值 $\\varepsilon$。对于一个服从指数分布的随机变量的 $N$ 次独立测量，样本均值的相对标准差为 $1/\\sqrt{N}$。因此，对每个状态 $i$ 的约束是：\n$$\n\\frac{1}{\\sqrt{N_i}} \\leq \\varepsilon\n$$\n其中 $N_i$ 是为状态 $i$ 观测到的驻留区间数。这个不等式必须对 $i=1$ 和 $i=2$ 都成立。\n\n问题给出了一个近似关系：对于较长的观测时间 $T_{\\text{obs}}$，每个状态的驻留次数为 $N \\approx T_{\\text{obs}}/(\\tau_1 + \\tau_2)$。这个关系是正确的。对于一个平稳的两态马尔可夫过程，从状态 $i$ 跃出的速率等于跃入状态 $i$ 的速率。在时间 $T_{\\text{obs}}$ 内从状态 1 跃出的次数约等于 $N_1$。在状态 1 中花费的总时间为 $P_1 T_{\\text{obs}}$，其中 $P_1 = \\tau_1 / (\\tau_1 + \\tau_2)$ 是处于状态 1 的稳态概率。驻留次数是状态中的总时间除以每次驻留的平均时间，即 $N_1 = (P_1 T_{\\text{obs}}) / \\tau_1 = (\\frac{\\tau_1}{\\tau_1+\\tau_2} T_{\\text{obs}}) / \\tau_1 = \\frac{T_{\\text{obs}}}{\\tau_1+\\tau_2}$。通过对称的论证可得 $N_2 = \\frac{T_{\\text{obs}}}{\\tau_1+\\tau_2}$。由于两个状态观测到的驻留次数相同，我们只需要对单个值 $N$ 满足该约束：\n$$\nN = \\frac{T_{\\text{obs}}}{\\tau_1 + \\tau_2}\n$$\n将此代入约束 $1/\\sqrt{N} \\leq \\varepsilon$，我们得到：\n$$\n\\frac{1}{\\sqrt{\\frac{T_{\\text{obs}}}{\\tau_1 + \\tau_2}}} \\leq \\varepsilon\n$$\n两边平方可得：\n$$\n\\frac{\\tau_1 + \\tau_2}{T_{\\text{obs}}} \\leq \\varepsilon^2\n$$\n对 $T_{\\text{obs}}$ 进行整理，得到第二个下界，我们将其记作 $T_{\\text{obs, time}}$：\n$$\nT_{\\text{obs}} \\geq \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2}\n$$\n因此，时域约束所要求的最小时间是 $T_{\\text{obs, time}} = \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2}$。\n\n为了同时满足频域和时域约束，总观测时间 $T_{\\text{obs}}$ 必须大于或等于这两个下界。因此，最小观测时间是两者的最大值：\n$$\nT_{\\text{obs, min}} = \\max\\left( T_{\\text{obs, freq}}, T_{\\text{obs, time}} \\right) = \\max\\left( \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}, \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2} \\right)\n$$\n现在，我们代入给定的数值：\n$\\tau_1 = 8~\\text{ms} = 8 \\times 10^{-3}~\\text{s}$\n$\\tau_2 = 12~\\text{ms} = 12 \\times 10^{-3}~\\text{s}$\n$\\eta = 0.05$\n$\\varepsilon = 0.10$\n\n让我们计算这两个下界。\n\n对于频域界限 $T_{\\text{obs, freq}}$：\n$$\n\\tau_1 + \\tau_2 = (8 + 12) \\times 10^{-3}~\\text{s} = 20 \\times 10^{-3}~\\text{s} = 0.02~\\text{s}\n$$\n$$\n\\tau_1 \\tau_2 = (8 \\times 10^{-3}~\\text{s}) \\times (12 \\times 10^{-3}~\\text{s}) = 96 \\times 10^{-6}~\\text{s}^2\n$$\n$$\nT_{\\text{obs, freq}} = \\frac{2\\pi}{0.05} \\frac{96 \\times 10^{-6}~\\text{s}^2}{20 \\times 10^{-3}~\\text{s}} = 40\\pi \\times (4.8 \\times 10^{-3}~\\text{s}) = 0.192\\pi~\\text{s} \\approx 0.6031857...~\\text{s}\n$$\n对于时域界限 $T_{\\text{obs, time}}$：\n$$\n\\varepsilon^2 = (0.10)^2 = 0.01\n$$\n$$\nT_{\\text{obs, time}} = \\frac{0.02~\\text{s}}{0.01} = 2~\\text{s}\n$$\n我们现在求这两个值的最大值：\n$$\nT_{\\text{obs, min}} = \\max(0.6031857...~\\text{s}, 2~\\text{s}) = 2~\\text{s}\n$$\n所需的最小观测时间由时域约束决定。问题要求答案以秒为单位，并四舍五入到四位有效数字。\n\n$T_{\\text{obs, min}} = 2.000~\\text{s}$。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "对于大规模神经形态阵列而言，器件的可变性是一个主要挑战，它主要源于器件之间的固有差异（device-to-device）以及重复编程操作的随机性（cycle-to-cycle）。本练习将指导您设计一个最优实验，并应用分层统计模型来分离这两种关键的可变性来源。掌握这种区分不同可变性来源的方法，对于工艺表征、器件优化和电路级补偿策略的开发至关重要。",
            "id": "4053973",
            "problem": "新兴存储器件，如相变存储器 (PCM) 和阻变随机存取存储器 (RRAM)，在神经形态和脑启发计算系统中被用作模拟突触。非理想性源于多尺度下的变异性：器件间变异性和周期与周期之间的变异性。考虑在一次标准化的写入操作后，测量以西门子 (S) 为单位的编程电导。一个平衡实验选择一定数量的器件和每个器件的编程周期数，然后在每个周期记录一次电导读出值。假设测量噪声的标准差是已知的，并由仪器控制。\n\n假设对于器件 $d$ 在周期 $c$ 的记录电导 $y_{d,c}$，采用分层高斯模型：\n$$\ny_{d,c} = \\mu + u_d + v_{d,c} + \\epsilon_{d,c},\n$$\n其中 $u_d \\sim \\mathcal{N}(0,\\sigma_D^2)$ 捕捉了器件间的变异性，$v_{d,c} \\sim \\mathcal{N}(0,\\sigma_C^2)$ 捕捉了单个器件内周期与周期之间的变异性，而 $\\epsilon_{d,c} \\sim \\mathcal{N}(0,\\sigma_M^2)$ 模拟了方差已知的测量噪声 $\\sigma_M^2$。所有随机变量都是相互独立的。该实验是平衡的，有 $D$ 个器件和每个器件 $C$ 个周期，总共产生 $N = D \\cdot C$ 次测量。\n\n从正态分布的基本性质以及无偏样本均值和方差的定义出发，完成以下任务：\n1. 为每个器件定义器件内无偏样本方差，并为跨器件的器件均值定义无偏样本方差。基于它们在分层高斯模型下的期望，推导出 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的无偏矩估计量。\n2. 利用“对于独立同分布的高斯样本，无偏样本方差服从一个缩放的卡方分布”以及“样本均值和样本方差是独立的”这些经过充分检验的事实，推导出 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的无偏矩估计量的方差的闭式表达式，该表达式是 $D$、$C$、$\\sigma_D^2$、$\\sigma_C^2$ 和 $\\sigma_M^2$ 的函数。\n3. 对于给定的总测量预算 $N$，在平衡设计约束 $D \\cdot C = N$（其中 $D \\ge 2$ 且 $C \\ge 2$）下，选择整数 $(D,C)$，以最小化方差估计量的相对标准误差平方和，定义为\n$$\nJ(D,C) = \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_D^2}]}{\\sigma_D^2}\\right)^2 + \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_C^2}]}{\\sigma_C^2}\\right)^2,\n$$\n其中 $\\mathrm{SE}[\\cdot]$ 表示标准误差（方差的平方根）。如果 $J(D,C)$ 在数值精度范围内出现相等的情况，则优先选择具有较大 $D$ 的设计。\n4. 指定最终输出格式并实现计算。\n\n所有与电导相关的量必须以西门子 (S) 表示，所有方差和标准误差必须以平方西门子 ($\\mathrm{S}^2$) 表示。角度不属于本问题的一部分。你的程序的最终输出必须是单行，其中包含一个由列表组成的、逗号分隔的列表，每个内部列表的格式为 $[D,C,\\mathrm{SE}[\\widehat{\\sigma_D^2}],\\mathrm{SE}[\\widehat{\\sigma_C^2}]]$，且不含空格。\n\n测试套件和答案规范：\n- 使用以下参数集，每组参数以 $(N,\\sigma_D,\\sigma_C,\\sigma_M)$ 的形式给出，所有 $\\sigma$ 值的单位均为西门子 (S)。\n    1. $(48, 3.0\\times 10^{-7}, 2.0\\times 10^{-7}, 5.0\\times 10^{-8})$.\n    2. $(36, 1.0\\times 10^{-7}, 5.0\\times 10^{-8}, 2.0\\times 10^{-7})$.\n    3. $(8, 5.0\\times 10^{-7}, 1.0\\times 10^{-8}, 1.0\\times 10^{-8})$.\n- 对于每个参数集，搜索 $N$ 分解为 $D \\cdot C$ 的所有整数因式分解（其中 $D \\ge 2$ 且 $C \\ge 2$），以根据上述准则找到最优的 $(D,C)$。\n- 为选定的 $(D,C)$ 计算标准误差 $\\mathrm{SE}[\\widehat{\\sigma_D^2}]$ 和 $\\mathrm{SE}[\\widehat{\\sigma_C^2}]$，并以 $\\mathrm{S}^2$ 为单位将其报告为浮点数。\n- 你的程序应生成单行输出，其中包含一个由内部列表组成的、逗号分隔的列表，且不含空格，例如：$[[D_1,C_1,SE_{D,1},SE_{C,1}],[D_2,C_2,SE_{D,2},SE_{C,2}],[D_3,C_3,SE_{D,3},SE_{C,3}]]$。",
            "solution": "该问题要求在分层高斯模型中推导方差分量的估计量，计算这些估计量的方差，并将这些结果应用于一个最优实验设计问题。解决方案是从基本原理出发，通过逐步推导的方式呈现的。\n\n器件 $d$ 在周期 $c$ 的测量电导 $y_{d,c}$ 的分层模型由下式给出：\n$$\ny_{d,c} = \\mu + u_d + v_{d,c} + \\epsilon_{d,c}\n$$\n其中 $\\mu$ 是全局平均电导，$u_d \\sim \\mathcal{N}(0, \\sigma_D^2)$ 代表器件间的变异性，$v_{d,c} \\sim \\mathcal{N}(0, \\sigma_C^2)$ 代表周期与周期之间的变异性，$\\epsilon_{d,c} \\sim \\mathcal{N}(0, \\sigma_M^2)$ 是测量噪声。所有随机变量都是相互独立的。实验设计是平衡的，有 $D$ 个器件和每个器件 $C$ 个周期。测量噪声方差 $\\sigma_M^2$ 是已知的。\n\n首先，我们定义两个关键的样本统计量。每个器件 $d$ 的样本均值为：\n$$\n\\bar{y}_{d \\cdot} = \\frac{1}{C} \\sum_{c=1}^{C} y_{d,c}\n$$\n而总体样本均值为：\n$$\n\\bar{y}_{\\cdot \\cdot} = \\frac{1}{D} \\sum_{d=1}^{D} \\bar{y}_{d \\cdot} = \\frac{1}{DC} \\sum_{d=1}^{D} \\sum_{c=1}^{C} y_{d,c}\n$$\n\n将模型代入器件均值表达式，我们得到：\n$$\n\\bar{y}_{d \\cdot} = \\frac{1}{C} \\sum_{c=1}^{C} (\\mu + u_d + v_{d,c} + \\epsilon_{d,c}) = \\mu + u_d + \\bar{v}_{d \\cdot} + \\bar{\\epsilon}_{d \\cdot}\n$$\n其中 $\\bar{v}_{d \\cdot} = \\frac{1}{C}\\sum_c v_{d,c}$ 且 $\\bar{\\epsilon}_{d \\cdot} = \\frac{1}{C}\\sum_c \\epsilon_{d,c}$。根据正态分布的性质，$\\bar{v}_{d \\cdot} \\sim \\mathcal{N}(0, \\sigma_C^2/C)$ 且 $\\bar{\\epsilon}_{d \\cdot} \\sim \\mathcal{N}(0, \\sigma_M^2/C)$。对于 $d=1,\\dots,D$，各项 $\\bar{y}_{d \\cdot}$ 是独立同分布 (i.i.d.) 的正态随机变量，其均值为 $\\mathrm{E}[\\bar{y}_{d \\cdot}] = \\mu$，方差为：\n$$\n\\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\mathrm{Var}[u_d] + \\mathrm{Var}[\\bar{v}_{d \\cdot}] + \\mathrm{Var}[\\bar{\\epsilon}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2}{C} + \\frac{\\sigma_M^2}{C} = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\n$$\n\n**矩估计量的推导**\n\n我们接下来推导方差分量 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的估计量。\n\n每个器件 $d$ 的器件内无偏样本方差定义为：\n$$\nS_{W,d}^2 = \\frac{1}{C-1} \\sum_{c=1}^{C} (y_{d,c} - \\bar{y}_{d \\cdot})^2\n$$\n对于一个固定的器件 $d$，$c=1,\\dots,C$ 的随机变量 $y_{d,c}$可以看作是来自正态分布 $\\mathcal{N}(\\mu+u_d, \\sigma_C^2 + \\sigma_M^2)$ 的样本。这是因为，对于给定的 $u_d$，项 $y_{d,c} - (\\mu+u_d) = v_{d,c} + \\epsilon_{d,c}$ 是两个独立的、零均值正态变量之和，因此 $v_{d,c} + \\epsilon_{d,c} \\sim \\mathcal{N}(0, \\sigma_C^2 + \\sigma_M^2)$。无偏样本方差的期望是总体的真实方差。因此：\n$$\n\\mathrm{E}[S_{W,d}^2] = \\sigma_C^2 + \\sigma_M^2\n$$\n我们可以对所有器件的这些方差进行平均，以获得一个更稳定的单一统计量，即器件内均方误差：\n$$\nS_W^2 = \\frac{1}{D} \\sum_{d=1}^{D} S_{W,d}^2 = \\frac{1}{D(C-1)} \\sum_{d=1}^{D} \\sum_{c=1}^{C} (y_{d,c} - \\bar{y}_{d \\cdot})^2\n$$\n根据期望的线性性质，$\\mathrm{E}[S_W^2] = \\sigma_C^2 + \\sigma_M^2$。由于 $\\sigma_M^2$ 已知，我们可以为 $\\sigma_C^2$ 构建一个无偏估计量：\n$$\n\\widehat{\\sigma_C^2} = S_W^2 - \\sigma_M^2\n$$\n它的期望是 $\\mathrm{E}[\\widehat{\\sigma_C^2}] = \\mathrm{E}[S_W^2] - \\sigma_M^2 = (\\sigma_C^2 + \\sigma_M^2) - \\sigma_M^2 = \\sigma_C^2$。\n\n接下来，我们定义器件均值的无偏样本方差：\n$$\nS_B^2 = \\frac{1}{D-1} \\sum_{d=1}^{D} (\\bar{y}_{d \\cdot} - \\bar{y}_{\\cdot \\cdot})^2\n$$\n项 $\\bar{y}_{d \\cdot}$ 是从一个方差为 $\\mathrm{Var}[\\bar{y}_{d \\cdot}]$ 的分布中抽取的 $D$ 个独立同分布样本。$S_B^2$ 的期望就是这个方差：\n$$\n\\mathrm{E}[S_B^2] = \\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\n$$\n使用矩量法，我们将期望值替换为它们的样本对应项。我们用 $S_B^2$ 替换 $\\mathrm{E}[S_B^2]$，用其无偏估计量 $S_W^2$ 替换 $(\\sigma_C^2 + \\sigma_M^2)$。\n$$\nS_B^2 \\approx \\sigma_D^2 + \\frac{S_W^2}{C}\n$$\n这表明 $\\sigma_D^2$ 的无偏估计量如下：\n$$\n\\widehat{\\sigma_D^2} = S_B^2 - \\frac{S_W^2}{C}\n$$\n它的期望是 $\\mathrm{E}[\\widehat{\\sigma_D^2}] = \\mathrm{E}[S_B^2] - \\frac{\\mathrm{E}[S_W^2]}{C} = (\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}) - \\frac{\\sigma_C^2 + \\sigma_M^2}{C} = \\sigma_D^2$。\n\n**估计量方差的推导**\n\n为了推导 $\\widehat{\\sigma_C^2}$ 和 $\\widehat{\\sigma_D^2}$ 的方差，我们使用这样一个性质：对于来自 $\\mathcal{N}(\\mu, \\sigma^2)$ 的 $n$ 个独立同分布样本，无偏样本方差 $s^2$ 的分布与卡方分布有关：$\\frac{(n-1)s^2}{\\sigma^2} \\sim \\chi^2_{n-1}$。一个 $\\chi^2_k$ 分布的方差是 $2k$，所以 $\\mathrm{Var}[s^2] = \\frac{2\\sigma^4}{n-1}$。\n\n对于估计量 $\\widehat{\\sigma_C^2}$：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_C^2}] = \\mathrm{Var}[S_W^2 - \\sigma_M^2] = \\mathrm{Var}[S_W^2]\n$$\n$S_W^2 = \\frac{1}{D}\\sum_{d=1}^D S_{W,d}^2$。各项 $S_{W,d}^2$ 在不同器件 $d$ 之间是独立的。\n$$\n\\mathrm{Var}[S_W^2] = \\frac{1}{D^2} \\sum_{d=1}^D \\mathrm{Var}[S_{W,d}^2]\n$$\n每个 $S_{W,d}^2$ 是来自一个方差为 $\\sigma_C^2 + \\sigma_M^2$ 的总体的 $C$ 个样本的样本方差。因此，使用公式，其中 $n=C$ 且 $\\sigma^2 = \\sigma_C^2 + \\sigma_M^2$：\n$$\n\\mathrm{Var}[S_{W,d}^2] = \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{C-1}\n$$\n将其代回，我们得到：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_C^2}] = \\mathrm{Var}[S_W^2] = \\frac{1}{D^2} \\cdot D \\cdot \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{C-1} = \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{D(C-1)}\n$$\n\n对于估计量 $\\widehat{\\sigma_D^2}$：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\mathrm{Var}\\left[S_B^2 - \\frac{S_W^2}{C}\\right]\n$$\n在平衡单向随机效应模型中，组间平方和（与 $S_B^2$ 相关）和组内平方和（与 $S_W^2$ 相关）是独立的。因此，$S_B^2$ 和 $S_W^2$ 是独立的，它们的协方差为零。\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\mathrm{Var}[S_B^2] + \\mathrm{Var}\\left[\\frac{S_W^2}{C}\\right] = \\mathrm{Var}[S_B^2] + \\frac{1}{C^2}\\mathrm{Var}[S_W^2]\n$$\n$S_B^2$ 是来自一个方差为 $\\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}$ 的总体的 $D$ 个独立同分布样本 $\\bar{y}_{d \\cdot}$ 的样本方差。应用样本方差公式，其中 $n=D$ 且 $\\sigma^2 = \\mathrm{Var}[\\bar{y}_{d \\cdot}]$:\n$$\n\\mathrm{Var}[S_B^2] = \\frac{2(\\mathrm{Var}[\\bar{y}_{d \\cdot}])^2}{D-1} = \\frac{2}{D-1}\\left(\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\\right)^2\n$$\n代入 $\\mathrm{Var}[S_B^2]$ 和 $\\mathrm{Var}[S_W^2]$ 的表达式：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\frac{2}{D-1}\\left(\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\\right)^2 + \\frac{1}{C^2} \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{D(C-1)}\n$$\n\n**最优实验设计**\n\n目标是最小化方差估计量的相对标准误差平方和：\n$$\nJ(D,C) = \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_D^2}]}{\\sigma_D^2}\\right)^2 + \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_C^2}]}{\\sigma_C^2}\\right)^2 = \\frac{\\mathrm{Var}[\\widehat{\\sigma_D^2}]}{(\\sigma_D^2)^2} + \\frac{\\mathrm{Var}[\\widehat{\\sigma_C^2}]}{(\\sigma_C^2)^2}\n$$\n最小化受制于约束条件 $D \\cdot C = N$，且 $D, C$ 是 $\\ge 2$ 的整数。对于每个测试用例 $(N, \\sigma_D, \\sigma_C, \\sigma_M)$，我们枚举 $N$ 的所有有效整数因子对 $(D, C)$。对于每一对，我们使用推导出的方差表达式计算 $J(D,C)$。最优对 $(D^*, C^*)$ 是产生 $J(D,C)$ 最小值的对。如果出现相等的情况，则选择 $D$ 值较大的设计。\n\n最后，对于最优对 $(D^*, C^*)$，计算并报告相应的标准误差 $\\mathrm{SE}[\\widehat{\\sigma_D^2}] = \\sqrt{\\mathrm{Var}[\\widehat{\\sigma_D^2}]}$ 和 $\\mathrm{SE}[\\widehat{\\sigma_C^2}] = \\sqrt{\\mathrm{Var}[\\widehat{\\sigma_C^2}]}$。方差是使用最优的 $(D^*, C^*)$ 和给定的真实方差分量来评估的。",
            "answer": "[[6,8,5.421718023199859e-15,1.8371173070873836e-15],[18,2,9.428090415820635e-15,5.892556509949646e-15],[4,2,3.1274949392738435e-14,1.0000000000000001e-16]]"
        }
    ]
}