{
    "hands_on_practices": [
        {
            "introduction": "The interface between the optical and electronic domains in a photonic neuromorphic system is the photodetector. This conversion of discrete photons into an electrical current is not a noiseless process; it is fundamentally limited by the quantum nature of light. This exercise  guides you through a first-principles derivation of shot noise, the statistical fluctuation in current arising from the random arrival of photons. Mastering this analysis is essential for understanding the ultimate signal-to-noise ratio ($SNR$) and sensitivity achievable by a photonic neuron.",
            "id": "4054827",
            "problem": "A reverse-biased photodiode front-end in a photonic neuromorphic computing receiver converts incident optical spikes into an electron current. Assume unity quantum efficiency and no internal gain so that each detected photon generates a single electron at the diode, and the electron arrival times form a stationary Poisson point process of rate $\\lambda$. Let each arrival contribute an impulse of current with area $q$, where $q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$ is the elementary charge. The average photocurrent is $I = q \\lambda$. The readout is followed by an ideal brick-wall low-pass filter with single-sided equivalent noise bandwidth $B$, and you are to treat the photodiode as shot-noise-limited (neglect all other noise sources).\n\nStarting only from the core definitions of a Poisson process and the Wiener–Khinchin theorem relating the autocorrelation of a stationary process to its power spectral density (PSD), derive the single-sided current noise PSD $S_i(f)$ of the shot noise process in terms of $q$ and $I$. Then, from that result, obtain the root-mean-square (RMS) noise current $i_n$ over bandwidth $B$ as a function of $q$, $I$, and $B$.\n\nFinally, evaluate $i_n$ numerically for $I = 0.50\\,\\mathrm{mA}$ and $B = 10.0\\,\\mathrm{GHz}$, using $q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$. Round your answer to three significant figures. Express the final RMS noise current in microamperes.",
            "solution": "We model the electron arrival process at the photodiode as a stationary Poisson point process of rate $\\lambda$, so that the number of arrivals in any interval of duration $\\Delta t$ is Poisson distributed with mean and variance equal to $\\lambda \\Delta t$. Each arrival contributes an impulse of current with area $q$, so the instantaneous current can be written as\n$$\ni(t) = q \\sum_{k} \\delta\\bigl(t - t_k\\bigr),\n$$\nwhere $\\{t_k\\}$ are the arrival times. The average (dc) photocurrent is\n$$\nI \\equiv \\mathbb{E}[i(t)] = q \\lambda.\n$$\n\nTo obtain the power spectral density (PSD), we start from the autocorrelation function of $i(t)$. For a general Poisson shot-noise process formed by impulses with deterministic waveform $h(t)$ and Poisson rate $\\lambda$, Campbell’s theorem gives the second-order moment\n$$\n\\mathbb{E}\\!\\left[i(t)\\,i(t+\\tau)\\right] = \\lambda \\int_{-\\infty}^{\\infty} h(u)\\,h(u+\\tau)\\,du \\;+\\; \\lambda^{2}\\!\\left(\\int_{-\\infty}^{\\infty} h(u)\\,du\\right)^{2}.\n$$\nHere $h(t) = q\\,\\delta(t)$, so\n$$\n\\int_{-\\infty}^{\\infty} h(u)\\,h(u+\\tau)\\,du \\;=\\; q^{2} \\int_{-\\infty}^{\\infty} \\delta(u)\\,\\delta(u+\\tau)\\,du \\;=\\; q^{2}\\,\\delta(\\tau),\n$$\nand\n$$\n\\int_{-\\infty}^{\\infty} h(u)\\,du \\;=\\; q.\n$$\nTherefore,\n$$\n\\mathbb{E}\\!\\left[i(t)\\,i(t+\\tau)\\right] \\;=\\; \\lambda q^{2}\\,\\delta(\\tau) \\;+\\; \\lambda^{2} q^{2}.\n$$\nThe autocovariance of the current fluctuations about the mean, $c_i(\\tau) \\equiv \\mathbb{E}\\!\\left[(i(t)-I)(i(t+\\tau)-I)\\right]$, is obtained by subtracting $I^{2}$:\n$$\nc_i(\\tau) \\;=\\; \\lambda q^{2}\\,\\delta(\\tau).\n$$\n\nBy the Wiener–Khinchin theorem, the two-sided PSD $S_{i,2}(f)$ of the zero-mean current fluctuations is the Fourier transform of $c_i(\\tau)$. Using $\\mathcal{F}\\{\\delta(\\tau)\\} = 1$, we obtain\n$$\nS_{i,2}(f) \\;=\\; \\lambda q^{2} \\;=\\; q I.\n$$\nEngineers commonly use the single-sided PSD $S_i(f)$ for $f \\geq 0$, which is twice the two-sided PSD:\n$$\nS_i(f) \\;=\\; 2\\,S_{i,2}(f) \\;=\\; 2\\,q\\,I,\n$$\nand this result is independent of $f$ (white noise).\n\nTo compute the root-mean-square (RMS) noise current within a brick-wall low-pass of single-sided noise bandwidth $B$, we integrate the single-sided PSD over $[0,B]$:\n$$\ni_n^{2} \\;=\\; \\int_{0}^{B} S_i(f)\\,df \\;=\\; \\int_{0}^{B} 2\\,q\\,I\\,df \\;=\\; 2\\,q\\,I\\,B,\n$$\nso\n$$\ni_n \\;=\\; \\sqrt{2\\,q\\,I\\,B}.\n$$\n\nNow evaluate numerically for $I = 0.50\\,\\mathrm{mA}$, $B = 10.0\\,\\mathrm{GHz}$, and $q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$. Convert to base units: $I = 0.50 \\times 10^{-3}\\,\\mathrm{A}$ and $B = 10.0 \\times 10^{9}\\,\\mathrm{Hz}$. Then\n$$\ni_n \\;=\\; \\sqrt{2 \\times \\left(1.602176634 \\times 10^{-19}\\right) \\times \\left(0.50 \\times 10^{-3}\\right) \\times \\left(10.0 \\times 10^{9}\\right)}.\n$$\nFirst compute the product inside the square root:\n$$\n2 \\times 1.602176634 \\times 10^{-19} \\times 0.50 \\times 10^{-3} \\times 10.0 \\times 10^{9}\n= 1.602176634 \\times 10^{-12}.\n$$\nTaking the square root,\n$$\ni_n \\;=\\; \\sqrt{1.602176634} \\times 10^{-6}\\,\\mathrm{A} \\;\\approx\\; 1.26594 \\times 10^{-6}\\,\\mathrm{A}.\n$$\nExpressed in microamperes, this is $1.26594\\,\\mathrm{\\mu A}$. Rounding to three significant figures gives $1.27\\,\\mathrm{\\mu A}$.",
            "answer": "$$\\boxed{1.27}$$"
        },
        {
            "introduction": "Implementing adaptable synaptic weights is a cornerstone of neuromorphic hardware, and thermal phase shifters are a mature technology for this in silicon photonics. However, their operation relies on controlled heating, making power consumption and thermal management critical concerns for scalability. This practice  delves into the thermal physics of a photonic device, challenging you to model heat diffusion through a multilayer stack. This analysis connects the abstract concept of a synaptic weight to the concrete engineering trade-offs of power, density, and thermal stability.",
            "id": "4054784",
            "problem": "A thermal phase shifter used to implement a tunable synaptic weight in a photonic neuromorphic circuit is realized on a Silicon-on-Insulator (SOI) waveguide stack. A resistive microheater above the waveguide core deposits heat that diffuses through the multilayer stack into the silicon substrate. Assume the following scientifically realistic stack and operating conditions:\n\n- From the top down: a metal heater lies on a silica cladding of thickness $t_{\\mathrm{clad}}$, beneath which is the silicon device layer containing the waveguide core of thickness $t_{\\mathrm{core}}$, then a buried oxide (silica) of thickness $t_{\\mathrm{BOX}}$, followed by a bulk silicon substrate of thickness $t_{\\mathrm{sub}}$.\n- The heater is a rectangle of width $W$ and length $L$, delivering constant electrical power $P_h$ uniformly over its footprint, so the downward heat flux is $q = P_h / A$ with area $A = W L$.\n- Thermal conductivities are piecewise constant: $k_{\\mathrm{Si}}$ in silicon and $k_{\\mathrm{SiO_2}}$ in silica. Treat each layer as isotropic and homogeneous, neglect lateral heat spreading, convective and radiative losses, and any internal volumetric heat generation outside the heater region.\n- The bottom of the substrate at $z=0$ is held at ambient temperature $T_0$, and the stack is sufficiently thick that this boundary condition is appropriate; the heater imposes the uniform downward heat flux at the top boundary.\n\nStarting only from energy conservation and Fourier’s law of heat conduction as the fundamental base, first derive the governing steady-state heat diffusion equation within each layer and state the appropriate interface conditions. Then, model the vertical conduction as one-dimensional in $z$ and compute the steady-state temperature rise at the center of the silicon waveguide core, $\\Delta T = T_{\\mathrm{core}} - T_0$, for the following parameter set:\n\n- $P_h = 20\\,\\mathrm{mW}$,\n- $W = 5\\,\\mu\\mathrm{m}$, $L = 500\\,\\mu\\mathrm{m}$,\n- $t_{\\mathrm{core}} = 220\\,\\mathrm{nm}$, $t_{\\mathrm{BOX}} = 3\\,\\mu\\mathrm{m}$, $t_{\\mathrm{sub}} = 500\\,\\mu\\mathrm{m}$,\n- $k_{\\mathrm{Si}} = 130\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_{\\mathrm{SiO_2}} = 1.4\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\nAssume the core center is located halfway through the silicon device layer immediately above the buried oxide. Round your final numerical answer to three significant figures and express it in kelvins.",
            "solution": "The governing principle for heat transfer is the conservation of energy. For a steady-state system with no internal heat generation, the divergence of the heat flux vector $\\vec{q}$ is zero:\n$$\n\\nabla \\cdot \\vec{q} = 0\n$$\nThe heat flux is related to the temperature gradient by Fourier's law of heat conduction:\n$$\n\\vec{q} = -k \\nabla T\n$$\nwhere $k$ is the thermal conductivity and $T$ is the temperature. Combining these gives the general steady-state heat diffusion equation:\n$$\n\\nabla \\cdot (-k \\nabla T) = 0\n$$\nThe problem specifies that lateral heat spreading is neglected, which means the heat transfer can be modeled as one-dimensional along the vertical axis, which we'll call the $z$-axis. Let $z=0$ be the bottom of the silicon substrate, with the positive $z$-axis pointing upwards. In one dimension, the equation simplifies to:\n$$\n\\frac{d}{dz} \\left(-k(z) \\frac{dT}{dz}\\right) = 0\n$$\nThis implies that the vertical heat flux, $q_z = -k(z) \\frac{dT}{dz}$, must be constant throughout the entire stack.\n\nThe heater provides a constant downward power $P_h$ over an area $A = WL$, resulting in a downward heat flux of magnitude $q = P_h/A$. In our coordinate system where $z$ increases upwards, this downward flux corresponds to a negative value:\n$$\nq_z = -q = -\\frac{P_h}{WL}\n$$\nTherefore, for any layer $i$ with a constant thermal conductivity $k_i$, the governing equation is:\n$$\n-k_i \\frac{dT}{dz} = -q \\quad \\implies \\quad \\frac{dT}{dz} = \\frac{q}{k_i}\n$$\nThe interface conditions between any two adjacent layers require the temperature to be continuous.\n\nWe want to find the temperature rise at the center of the silicon waveguide core, $\\Delta T = T_{\\mathrm{core}} - T_0$. The temperature at the bottom of the substrate is $T(z=0) = T_0$. The temperature at any height $z$ can be found by integrating the temperature gradient from $z=0$ to the desired height. The position of the core's center is:\n$$\nz_{\\mathrm{core}} = t_{\\mathrm{sub}} + t_{\\mathrm{BOX}} + \\frac{t_{\\mathrm{core}}}{2}\n$$\nThe temperature rise at this point, $\\Delta T = T(z_{\\mathrm{core}}) - T(0)$, is given by the integral:\n$$\n\\Delta T = \\int_{0}^{z_{\\mathrm{core}}} \\frac{dT}{dz'} dz'\n$$\nSince the thermal conductivity $k$ is piecewise constant, we must split the integral over the different layers:\n$$\n\\Delta T = \\int_{0}^{t_{\\mathrm{sub}}} \\frac{q}{k_{\\mathrm{Si}}} dz' + \\int_{t_{\\mathrm{sub}}}^{t_{\\mathrm{sub}} + t_{\\mathrm{BOX}}} \\frac{q}{k_{\\mathrm{SiO_2}}} dz' + \\int_{t_{\\mathrm{sub}} + t_{\\mathrm{BOX}}}^{t_{\\mathrm{sub}} + t_{\\mathrm{BOX}} + t_{\\mathrm{core}}/2} \\frac{q}{k_{\\mathrm{Si}}} dz'\n$$\nEvaluating these simple integrals yields:\n$$\n\\Delta T = q \\left[ \\frac{1}{k_{\\mathrm{Si}}}(t_{\\mathrm{sub}} - 0) + \\frac{1}{k_{\\mathrm{SiO_2}}}((t_{\\mathrm{sub}} + t_{\\mathrm{BOX}}) - t_{\\mathrm{sub}}) + \\frac{1}{k_{\\mathrm{Si}}}((t_{\\mathrm{sub}} + t_{\\mathrm{BOX}} + \\frac{t_{\\mathrm{core}}}{2}) - (t_{\\mathrm{sub}} + t_{\\mathrm{BOX}})) \\right]\n$$\n$$\n\\Delta T = q \\left( \\frac{t_{\\mathrm{sub}}}{k_{\\mathrm{Si}}} + \\frac{t_{\\mathrm{BOX}}}{k_{\\mathrm{SiO_2}}} + \\frac{t_{\\mathrm{core}}/2}{k_{\\mathrm{Si}}} \\right)\n$$\nThis expression represents the sum of temperature drops across the substrate, the buried oxide layer, and the bottom half of the core layer. We can group the terms with the same conductivity:\n$$\n\\Delta T = q \\left( \\frac{t_{\\mathrm{sub}} + t_{\\mathrm{core}}/2}{k_{\\mathrm{Si}}} + \\frac{t_{\\mathrm{BOX}}}{k_{\\mathrm{SiO_2}}} \\right)\n$$\nSubstituting $q = P_h / (WL)$, we get the final symbolic expression for the temperature rise:\n$$\n\\Delta T = \\frac{P_h}{WL} \\left( \\frac{t_{\\mathrm{sub}} + t_{\\mathrm{core}}/2}{k_{\\mathrm{Si}}} + \\frac{t_{\\mathrm{BOX}}}{k_{\\mathrm{SiO_2}}} \\right)\n$$\nNow, we substitute the given numerical values, ensuring all units are in the SI system.\n- $P_h = 20 \\times 10^{-3}\\,\\mathrm{W}$\n- $W = 5 \\times 10^{-6}\\,\\mathrm{m}$\n- $L = 500 \\times 10^{-6}\\,\\mathrm{m}$\n- $A = WL = (5 \\times 10^{-6}\\,\\mathrm{m}) \\times (500 \\times 10^{-6}\\,\\mathrm{m}) = 2.5 \\times 10^{-9}\\,\\mathrm{m}^2$\n- $t_{\\mathrm{core}} = 220 \\times 10^{-9}\\,\\mathrm{m}$\n- $t_{\\mathrm{BOX}} = 3 \\times 10^{-6}\\,\\mathrm{m}$\n- $t_{\\mathrm{sub}} = 500 \\times 10^{-6}\\,\\mathrm{m}$\n- $k_{\\mathrm{Si}} = 130\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n- $k_{\\mathrm{SiO_2}} = 1.4\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n\nFirst, calculate the heat flux $q$:\n$$\nq = \\frac{P_h}{A} = \\frac{20 \\times 10^{-3}\\,\\mathrm{W}}{2.5 \\times 10^{-9}\\,\\mathrm{m}^2} = 8 \\times 10^6\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nNext, calculate the thermal resistance terms (per unit area):\n$$\n\\frac{t_{\\mathrm{sub}} + t_{\\mathrm{core}}/2}{k_{\\mathrm{Si}}} = \\frac{500 \\times 10^{-6}\\,\\mathrm{m} + (220 \\times 10^{-9}\\,\\mathrm{m})/2}{130\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}} = \\frac{500 \\times 10^{-6} + 0.11 \\times 10^{-6}}{130}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}} = \\frac{500.11 \\times 10^{-6}}{130}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}} \\approx 3.847 \\times 10^{-6}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}}\n$$\n$$\n\\frac{t_{\\mathrm{BOX}}}{k_{\\mathrm{SiO_2}}} = \\frac{3 \\times 10^{-6}\\,\\mathrm{m}}{1.4\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}} \\approx 2.143 \\times 10^{-6}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}}\n$$\nNow, calculate $\\Delta T$:\n$$\n\\Delta T = (8 \\times 10^6\\,\\mathrm{W}\\,\\mathrm{m}^{-2}) \\left( 3.847 \\times 10^{-6}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}} + 2.143 \\times 10^{-6}\\,\\frac{\\mathrm{m}^2\\,\\mathrm{K}}{\\mathrm{W}} \\right)\n$$\n$$\n\\Delta T = (8 \\times 10^6) \\left( 5.990 \\times 10^{-6} \\right)\\,\\mathrm{K} = 47.92\\,\\mathrm{K}\n$$\nRounding the result to three significant figures, we get $47.9\\,\\mathrm{K}$.",
            "answer": "$$\n\\boxed{47.9}\n$$"
        },
        {
            "introduction": "An effective neuromorphic processor is more than just a collection of efficient components; it is a system where performance is dictated by the interplay of numerous architectural trade-offs. Speed, accuracy, power consumption, and latency are often in conflict, and a designer must navigate these challenges to meet application-specific constraints. This capstone practice  places you in the role of a system architect, tasked with selecting the optimal photonic architecture based on physical models for key performance metrics. This exercise synthesizes device-level physics into a holistic systems engineering problem, highlighting the crucial balance required in practical neuromorphic design.",
            "id": "4054761",
            "problem": "You are given three candidate architectures for a photonic neuromorphic sequence classification system and a set of task constraints. Your goal is to select, for each constraint set, the architecture that maximizes expected throughput subject to power and latency constraints, and compute the corresponding throughput and accuracy. The problem must be solved from first principles grounded in physical definitions and well-tested formulas.\n\nConsider the following system-level modeling assumptions grounded in physical law and standard communication and detection theory:\n- Tokens are processed via Wavelength Division Multiplexing (WDM) with $M$ parallel optical wavelengths, each operating at a symbol rate $R$ in tokens per second.\n- Throughput is constrained by the input bandwidth $B$ in tokens per second and by the architecture's parallel compute rate $M R$.\n- Latency is the sum of propagation delay $t_{\\text{prop}}$ for an optical path of length $d$ with refractive index $n$, a processing pipeline delay proportional to photon lifetime $\\tau_{\\text{ph}}$ and pipeline depth $D$, and the sequence serialization time for $\\ell$ tokens at the achieved throughput. The speed of light in vacuum is $c$, and $t_{\\text{prop}}$ follows from optical propagation in a medium.\n- Power is the rate of energy consumption from synaptic operations: energy per synaptic operation $E$ times synaptic operations per token $C$, scaled by the token throughput.\n- Accuracy is modeled under shot-noise-limited photodetection. The number of photons per token $N_\\gamma$ is determined by the token energy and photon energy $h \\nu$, where $h$ is Planck's constant and $\\nu$ is the optical frequency determined by the optical wavelength $\\lambda$ via $\\nu = c / \\lambda$. For large $N_\\gamma$, shot noise is approximately Gaussian with variance equal to the mean photon count, yielding signal-to-noise ratio proportional to $\\sqrt{N_\\gamma}$. Classification accuracy for a binary margin $m$ under Gaussian noise is approximated by the standard normal cumulative distribution function evaluated at the product of margin and signal-to-noise ratio.\n\nArchitecture parameters are given below. All variables used in this problem must be treated in the following units:\n- $B$ in tokens per second ($\\mathrm{s}^{-1}$),\n- $P_{\\max}$ in watts ($\\mathrm{W}$),\n- $L_{\\max}$ in seconds ($\\mathrm{s}$),\n- $d$ in meters ($\\mathrm{m}$),\n- $\\tau_{\\text{ph}}$ in seconds ($\\mathrm{s}$),\n- $E$ in joules ($\\mathrm{J}$),\n- $R$ in tokens per second ($\\mathrm{s}^{-1}$),\n- $\\ell$ in tokens (unitless),\n- $M$, $D$, $C$, $m$ are dimensionless.\n\nConstants for all calculations:\n- Speed of light: $c = 299{,}792{,}458 \\ \\mathrm{m/s}$.\n- Refractive index: $n = 1.5$.\n- Planck constant: $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J \\cdot s}$.\n- Optical wavelength: $\\lambda = 1.55 \\times 10^{-6} \\ \\mathrm{m}$, so optical frequency $\\nu = c / \\lambda$.\n\nCandidate architectures (indexed $1,2,3$), each with parameters $(M, R, E, C, D, \\tau_{\\text{ph}}, d, m)$:\n- Architecture $1$: $(8,\\ 5.0 \\times 10^{6},\\ 5.0 \\times 10^{-15},\\ 500,\\ 6,\\ 50.0 \\times 10^{-12},\\ 0.02,\\ 0.9)$.\n- Architecture $2$: $(16,\\ 2.0 \\times 10^{6},\\ 2.0 \\times 10^{-15},\\ 2000,\\ 20,\\ 20.0 \\times 10^{-12},\\ 0.05,\\ 1.3)$.\n- Architecture $3$: $(4,\\ 2.0 \\times 10^{7},\\ 1.0 \\times 10^{-14},\\ 200,\\ 4,\\ 10.0 \\times 10^{-12},\\ 0.01,\\ 0.8)$.\n\nFor each architecture $a$, the following quantities must be computed from first principles:\n- Achieved throughput $T_a$ in tokens per second, based on input bandwidth and parallelism.\n- Sequence latency $L_a$ in seconds, combining propagation, processing, and serialization.\n- Average power $P_a$ in watts, based on energy per synaptic operation and synaptic operations per token at the achieved throughput.\n- Expected accuracy $A_a$ as a decimal fraction in $[0,1]$, modeled via shot-noise-limited detection and Gaussian approximation.\n\nSelection rule for each constraint set $(B, P_{\\max}, L_{\\max}, \\ell)$:\n- Only architectures satisfying $P_a \\leq P_{\\max}$ and $L_a \\leq L_{\\max}$ are admissible.\n- Among admissible architectures, select the one with the largest $T_a$.\n- If there is a tie in $T_a$, select the one with the largest $A_a$.\n- If there is still a tie, select the one with the smallest $L_a$.\n- If there is still a tie, select the one with the smallest average power $P_a$.\n- If a tie remains, select the one with the smallest architecture index.\n- If no architecture is admissible, output the identifier $0$ with throughput $0.0$ tokens per second and accuracy $0.0$.\n\nStarting point for derivations:\n- Use the definition of throughput as the minimum of supply rate and processing capacity.\n- Use optical propagation delay in a dielectric medium and accumulation of pipeline stages to form latency.\n- Use the definition of power as energy per event times events per unit time.\n- Use photon energy $h \\nu$ and shot-noise-limited detection with Gaussian approximation to relate energy to signal-to-noise ratio and accuracy via the standard normal cumulative distribution function.\n\nTest suite (four constraint sets) to be evaluated:\n1. $(B, P_{\\max}, L_{\\max}, \\ell) = (5.0 \\times 10^{6},\\ 1.0 \\times 10^{-3},\\ 2.0 \\times 10^{-3},\\ 1000)$.\n2. $(B, P_{\\max}, L_{\\max}, \\ell) = (1.0 \\times 10^{8},\\ 5.0 \\times 10^{-4},\\ 5.0 \\times 10^{-5},\\ 5000)$.\n3. $(B, P_{\\max}, L_{\\max}, \\ell) = (1.0 \\times 10^{7},\\ 2.0 \\times 10^{-5},\\ 1.0000009005 \\times 10^{-4},\\ 1000)$.\n4. $(B, P_{\\max}, L_{\\max}, \\ell) = (1.0 \\times 10^{9},\\ 1.0 \\times 10^{-2},\\ 1.0 \\times 10^{-2},\\ 10000)$.\n\nRequired outputs:\n- For each test case, produce a list $[id, T, A]$ where $id$ is the selected architecture identifier (an integer), $T$ is the achieved throughput in tokens per second (a float), and $A$ is the expected accuracy as a decimal fraction (a float).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case as its own list, for example: $[[id_1,T_1,A_1],[id_2,T_2,A_2],[id_3,T_3,A_3],[id_4,T_4,A_4]]$.\n\nAll numerical answers must strictly use the specified units; accuracy must be expressed as a decimal fraction and not with a percentage sign.",
            "solution": "The solution proceeds by first deriving the governing equations for the key performance metrics of each candidate architecture from the first principles outlined in the problem statement. Subsequently, each architecture is evaluated against each set of task constraints. Finally, an optimal architecture is selected based on the specified hierarchical criteria.\n\nThe following physical constants are used throughout the analysis:\n- Speed of light in vacuum, $c = 299,792,458 \\, \\mathrm{m/s}$.\n- Refractive index of the optical medium, $n = 1.5$.\n- Planck's constant, $h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J \\cdot s}$.\n- Optical wavelength, $\\lambda = 1.55 \\times 10^{-6} \\, \\mathrm{m}$.\n\nFrom these, the energy of a single photon, $E_\\gamma$, is calculated as:\n$$E_\\gamma = h \\nu = \\frac{h c}{\\lambda}$$\nSubstituting the given values, $E_\\gamma = \\frac{(6.62607015 \\times 10^{-34}) \\cdot (299,792,458)}{1.55 \\times 10^{-6}} \\approx 1.282 \\times 10^{-19} \\, \\mathrm{J}$.\n\nFor each architecture $a$, with parameters $(M_a, R_a, E_a, C_a, D_a, \\tau_{\\text{ph},a}, d_a, m_a)$, and for each task defined by constraints $(B, P_{\\max}, L_{\\max}, \\ell)$, we define and compute the following metrics:\n\n1.  **Achieved Throughput ($T_a$)**: The throughput is limited by both the available input data bandwidth, $B$, and the architecture's maximum processing rate, $M_a R_a$. Thus, the achieved throughput $T_a$ is the minimum of these two values.\n    $$T_a = \\min(B, M_a R_a)$$\n    The unit is tokens per second ($\\mathrm{s}^{-1}$).\n\n2.  **Average Power ($P_a$)**: Power is the rate of energy consumption. The energy to process one token is the energy per synaptic operation, $E_a$, multiplied by the number of synaptic operations per token, $C_a$. The total power is this energy per token scaled by the achieved throughput $T_a$.\n    $$P_a = (E_a \\cdot C_a) \\cdot T_a$$\n    The unit is watts ($\\mathrm{W}$), as $(J) \\cdot (\\mathrm{s}^{-1}) = \\mathrm{W}$.\n\n3.  **Expected Accuracy ($A_a$)**: Accuracy is modeled based on shot-noise-limited photodetection. The total energy per token is $E_{\\text{token},a} = E_a C_a$. The number of photons detected per token, $N_{\\gamma,a}$, is this energy divided by the energy per photon, $E_\\gamma$.\n    $$N_{\\gamma,a} = \\frac{E_{\\text{token},a}}{E_\\gamma} = \\frac{E_a C_a \\lambda}{h c}$$\n    The signal-to-noise ratio (SNR) for the electrical signal is proportional to the square root of the photon count. Assuming a proportionality constant of $1$, we have:\n    $$\\text{SNR}_a = \\sqrt{N_{\\gamma,a}}$$\n    The classification accuracy, $A_a$, is given by the standard normal cumulative distribution function, $\\Phi(z)$, evaluated at the product of the classification margin, $m_a$, and the SNR.\n    $$A_a = \\Phi(m_a \\cdot \\text{SNR}_a)$$\n    $A_a$ is a dimensionless probability.\n\n4.  **Sequence Latency ($L_a$)**: The total latency for a sequence of length $\\ell$ is the sum of a fixed processing latency and a variable serialization time.\n    -   **Propagation Delay ($t_{\\text{prop},a}$)**: The time for light to travel the optical path length $d_a$ in a medium with refractive index $n$.\n        $$t_{\\text{prop},a} = \\frac{n d_a}{c}$$\n    -   **Processing Pipeline Delay ($t_{\\text{proc},a}$)**: The delay proportional to the pipeline depth $D_a$ and the characteristic photon lifetime $\\tau_{\\text{ph},a}$. Assuming a proportionality constant of $1$:\n        $$t_{\\text{proc},a} = D_a \\tau_{\\text{ph},a}$$\n    -   **Serialization Time ($t_{\\text{serial},a}$)**: The time required to process the entire sequence of $\\ell$ tokens at the achieved throughput $T_a$.\n        $$t_{\\text{serial},a} = \\frac{\\ell}{T_a}$$\n    The total latency, $L_a$, is the sum of these components:\n    $$L_a = t_{\\text{prop},a} + t_{\\text{proc},a} + t_{\\text{serial},a} = \\frac{n d_a}{c} + D_a \\tau_{\\text{ph},a} + \\frac{\\ell}{T_a}$$\n    The unit of latency is seconds ($\\mathrm{s}$).\n\nThe evaluation procedure for each test case $(B, P_{\\max}, L_{\\max}, \\ell)$ is as follows:\n- For each architecture $a \\in \\{1, 2, 3\\}$, calculate $T_a, P_a, L_a,$ and $A_a$ using the derived formulas.\n- An architecture is deemed **admissible** if it satisfies both the power and latency constraints: $P_a \\leq P_{\\max}$ and $L_a \\leq L_{\\max}$.\n- From the set of admissible architectures, the optimal choice is selected based on the following prioritized rules:\n    1.  Maximize achieved throughput $T_a$.\n    2.  If a tie exists, maximize expected accuracy $A_a$.\n    3.  If a tie persists, minimize sequence latency $L_a$.\n    4.  If a tie persists, minimize average power $P_a$.\n    5.  If a tie still remains, select the architecture with the lowest index $a$.\n- If no architecture is admissible for a given set of constraints, the result is recorded as index $0$ with throughput $0.0$ and accuracy $0.0$.\n\nThis rigorous, step-by-step process is implemented in the provided Python code to compute the results for all specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the photonic neuromorphic architecture selection problem.\n    \"\"\"\n    \n    # Define physical constants\n    C_LIGHT = 299792458.0  # Speed of light in vacuum, m/s\n    N_REFRACTIVE = 1.5     # Refractive index\n    H_PLANCK = 6.62607015e-34 # Planck's constant, J*s\n    LAMBDA_OPTICAL = 1.55e-6 # Optical wavelength, m\n    \n    # Calculate derived constants\n    NU_OPTICAL = C_LIGHT / LAMBDA_OPTICAL # Optical frequency, Hz\n    E_PHOTON = H_PLANCK * NU_OPTICAL      # Energy per photon, J\n\n    # Candidate architectures: (id, M, R, E, C, D, tau_ph, d, m)\n    # M: WDM channels (dimensionless)\n    # R: Symbol rate (tokens/s)\n    # E: Energy per synaptic op (J)\n    # C: Synaptic ops per token (dimensionless)\n    # D: Pipeline depth (dimensionless)\n    # tau_ph: Photon lifetime (s)\n    # d: Optical path length (m)\n    # m: Classification margin (dimensionless)\n    architectures = [\n        (1, 8, 5.0e6, 5.0e-15, 500, 6, 50.0e-12, 0.02, 0.9),\n        (2, 16, 2.0e6, 2.0e-15, 2000, 20, 20.0e-12, 0.05, 1.3),\n        (3, 4, 2.0e7, 1.0e-14, 200, 4, 10.0e-12, 0.01, 0.8),\n    ]\n\n    # Test suite: (B, P_max, L_max, l)\n    # B: Input bandwidth (tokens/s)\n    # P_max: Max power (W)\n    # L_max: Max latency (s)\n    # l: Sequence length (tokens)\n    test_cases = [\n        (5.0e6, 1.0e-3, 2.0e-3, 1000),\n        (1.0e8, 5.0e-4, 5.0e-5, 5000),\n        (1.0e7, 2.0e-5, 1.0000009005e-4, 1000),\n        (1.0e9, 1.0e-2, 1.0e-2, 10000),\n    ]\n\n    final_results = []\n    \n    for B, P_max, L_max, l_seq in test_cases:\n        admissible_candidates = []\n        \n        for arch_id, M, R, E_op, C_op, D, tau_ph, d, m_margin in architectures:\n            # 1. Calculate Throughput\n            T_achieved = min(B, M * R)\n\n            if T_achieved = 0:\n                continue\n\n            # 2. Calculate Power\n            P_avg = E_op * C_op * T_achieved\n            \n            # 3. Calculate Latency\n            t_prop = (d * N_REFRACTIVE) / C_LIGHT\n            t_proc = D * tau_ph\n            t_serial = l_seq / T_achieved\n            L_total = t_prop + t_proc + t_serial\n            \n            # Check admissibility\n            if P_avg = P_max and L_total = L_max:\n                # 4. Calculate Accuracy (only for admissible candidates)\n                e_token = E_op * C_op\n                n_gamma = e_token / E_PHOTON\n                snr = np.sqrt(n_gamma)\n                accuracy = norm.cdf(m_margin * snr)\n                \n                admissible_candidates.append({\n                    \"id\": arch_id,\n                    \"T\": T_achieved,\n                    \"A\": accuracy,\n                    \"L\": L_total,\n                    \"P\": P_avg\n                })\n\n        if not admissible_candidates:\n            final_results.append([0, 0.0, 0.0])\n        else:\n            # Apply selection rules using a stable sort on a tuple of metrics.\n            # Python's sort is stable, which respects prior ordering for ties.\n            # However, for clarity, we define the full sorting key explicitly.\n            # 1. Max T (sort descending) -> -c['T']\n            # 2. Max A (sort descending) -> -c['A']\n            # 3. Min L (sort ascending)  ->  c['L']\n            # 4. Min P (sort ascending)  ->  c['P']\n            # 5. Min id (sort ascending) ->  c['id']\n            sorted_candidates = sorted(\n                admissible_candidates, \n                key=lambda c: (-c['T'], -c['A'], c['L'], c['P'], c['id'])\n            )\n            \n            best_arch = sorted_candidates[0]\n            final_results.append([best_arch['id'], best_arch['T'], best_arch['A']])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join(f\"[{item[0]},{item[1]},{item[2]}]\" for item in final_results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}