{
    "hands_on_practices": [
        {
            "introduction": "注意力的最基本计算模型之一是增益调制，即大脑如同一个放大器，选择性地增强与当前任务相关的神经信号。这个练习将通过一个简化的神经形态模型，带你从第一性原理出发，定量分析这种增益如何改善信噪比（Signal-to-Noise Ratio, SNR）。通过完成这个计算，你将对注意力如何帮助我们在嘈杂环境中“听得更清”、“看得更明”这一基本功能，建立起坚实的数学理解。",
            "id": "4051873",
            "problem": "一个神经形态注意模块对特定的特征通道施加乘性增益，以优先处理与任务相关的输入。考虑一个单通道线性读出，其模型如下。设潜在的与刺激对齐的信号是一个零均值、二阶平稳过程，其功率为 $P_{s} = \\mathbb{E}[s^{2}(t)]$，且与噪声无关。注意机制仅对信号路径施加一个静态的非负增益 $g \\geq 0$，产生输出\n$$\ny_{g}(t) = g\\,s(t) + n(t),\n$$\n其中 $n(t)$ 是加性高斯白噪声（AWGN），其均值为零，方差为 $\\sigma^{2}$，与 $s(t)$ 无关，且不受增益调制。基线（无注意）条件对应于 $g=1$。\n\n使用信噪比（SNR）的标准定义，即输出端信号功率与噪声功率之比，从第一性原理出发，推导SNR改善因子 $R(g)$ 的精确闭式表达式，其定义为\n$$\nR(g) \\triangleq \\frac{\\mathrm{SNR}_{\\text{with gain } g}}{\\mathrm{SNR}_{\\text{baseline}}},\n$$\n该表达式仅用 $g$ 表示。然后，确定使SNR相对于基线严格改善的最小增益阈值 $g_{\\text{th}}$。\n\n将您的最终答案表示为单行矩阵 $\\begin{pmatrix} R(g) & g_{\\text{th}} \\end{pmatrix}$。最终表达式无需数值近似，也无需单位。",
            "solution": "任务是推导信噪比（SNR）改善因子 $R(g)$ 以及使SNR严格改善的最小增益阈值 $g_{\\text{th}}$。我们从问题陈述中给出的第一性原理开始。\n\n神经形态注意模块的输出由以下线性模型给出：\n$$y_{g}(t) = g\\,s(t) + n(t)$$\n其中 $s(t)$ 是与刺激对齐的信号，$n(t)$ 是加性噪声，$g$ 是仅施加于信号路径的乘性增益。增益是非负的，所以 $g \\geq 0$。\n\n问题指明，SNR定义为输出端信号功率与噪声功率之比。\n首先，我们确定输出端的信号分量和噪声分量。根据模型的结构，信号分量是 $g\\,s(t)$，噪声分量是 $n(t)$。\n\n输出端信号分量的功率，我们记为 $P_{\\text{signal}, g}$，是其平方的期望值。由于 $g$ 是一个确定性常数：\n$$P_{\\text{signal}, g} = \\mathbb{E}\\left[ (g\\,s(t))^{2} \\right] = \\mathbb{E}\\left[ g^{2}s^{2}(t) \\right] = g^{2}\\mathbb{E}\\left[ s^{2}(t) \\right]$$\n问题陈述，潜在信号 $s(t)$ 是一个零均值过程，其功率为 $P_{s} = \\mathbb{E}[s^{2}(t)]$。将此代入我们的表达式，得到：\n$$P_{\\text{signal}, g} = g^{2}P_{s}$$\n\n输出端噪声分量的功率 $P_{\\text{noise}, g}$，是加性噪声过程 $n(t)$ 的功率。问题陈述，$n(t)$ 是加性高斯白噪声（AWGN），其均值为零，方差为 $\\sigma^{2}$。一个零均值过程的功率等于其方差。因此：\n$$P_{\\text{noise}, g} = \\mathbb{E}\\left[ n^{2}(t) \\right] = \\sigma^{2}$$\n如题目所述，噪声功率不受增益 $g$ 的调制。\n\n现在，我们可以将给定增益 $g$ 下的信噪比，记为 $\\mathrm{SNR}_{\\text{with gain } g}$，表示为输出端信号功率与噪声功率之比：\n$$\\mathrm{SNR}_{\\text{with gain } g} = \\frac{P_{\\text{signal}, g}}{P_{\\text{noise}, g}} = \\frac{g^{2}P_{s}}{\\sigma^{2}}$$\n\n接下来，我们确定基线信噪比。基线条件定义为增益 $g=1$ 的情况。将 $g=1$ 代入通用信噪比表达式，得到基线信噪比 $\\mathrm{SNR}_{\\text{baseline}}$：\n$$\\mathrm{SNR}_{\\text{baseline}} = \\frac{1^{2}P_{s}}{\\sigma^{2}} = \\frac{P_{s}}{\\sigma^{2}}$$\n\nSNR改善因子 $R(g)$ 定义为带增益 $g$ 的信噪比与基线信噪比之比：\n$$R(g) \\triangleq \\frac{\\mathrm{SNR}_{\\text{with gain } g}}{\\mathrm{SNR}_{\\text{baseline}}}$$\n代入上面推导出的表达式：\n$$R(g) = \\frac{\\frac{g^{2}P_{s}}{\\sigma^{2}}}{\\frac{P_{s}}{\\sigma^{2}}}$$\n假设信号功率 $P_{s}$ 和噪声功率 $\\sigma^{2}$ 均大于零（这对于有意义的SNR计算是隐含的），我们可以消去项 $\\frac{P_{s}}{\\sigma^{2}}$：\n$$R(g) = g^{2}$$\n这就是所要求的仅用 $g$ 表示的SNR改善因子的闭式表达式。\n\n对于问题的第二部分，我们必须找到使SNR相对于基线严格改善的最小增益阈值 $g_{\\text{th}}$。当带增益 $g$ 的信噪比严格大于基线信噪比时，即出现严格改善，这等价于条件 $R(g) > 1$。\n使用我们推导出的 $R(g)$ 表达式，我们得到不等式：\n$$g^{2} > 1$$\n我们已知增益 $g$ 是一个非负值，即 $g \\geq 0$。在约束条件 $g \\geq 0$ 下，不等式 $g^{2} > 1$ 的解为：\n$$g > 1$$\n问题要求的是最小增益阈值 $g_{\\text{th}}$，即严格改善区域的边界点。对于任何严格大于此阈值的增益 $g$，SNR都必须改善。条件 $g>1$ 意味着该阈值为：\n$$g_{\\text{th}} = 1$$\n当 $g=1$ 时，$R(1)=1$，表示与基线相比没有变化。对于任何 $g>1$，$R(g)>1$，表示严格改善。对于任何 $0 \\leq g < 1$，$R(g)<1$，表示性能下降。因此，阈值为 $g_{\\text{th}}=1$。\n\n最终答案要求将 $R(g)$ 和 $g_{\\text{th}}$ 表示为单行矩阵。\n两个结果是 $R(g) = g^{2}$ 和 $g_{\\text{th}} = 1$。\n该行矩阵为 $\\begin{pmatrix} g^{2} & 1 \\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} g^{2} & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在提升信噪比的基础上，我们可以从贝叶斯推断的视角来更深入地理解注意力的作用，即注意力提高了感官证据的“精度”（precision）。这个练习将注意力机制置于“贝叶斯大脑”假说的框架下，让你推导在一个线性高斯模型中，注意力如何通过调节测量精度来降低对潜在状态估计的后验方差。这个过程揭示了注意力是如何锐化我们对外部世界的内部表征，从而减少不确定性。",
            "id": "4051876",
            "problem": "一个神经形态观测器对一个单一的潜标量状态 $x$ 进行贝叶斯推断，该状态 $x$ 代表了一个假定的全局工作空间模型中注意力和意识的瞬时激活水平。该观测器有一个高斯先验 $p(x) = \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，反映了皮层活动的缓慢动态和稳态约束。一个感官测量值 $y$ 由一个线性高斯观测模型 $y = x + \\eta$ 生成，其中测量噪声 $\\eta \\sim \\mathcal{N}(0, \\sigma_{y}^{2})$ 源于随机脉冲发放和突触传递的可变性。\n\n假设注意力通过一个乘法因子 $k \\geq 1$ 来调节测量精度，这与神经形态电路中的增益控制和随机共振机制相一致，因此在注意力作用下，测量噪声方差变为 $\\sigma_{y}^{2}/k$。定义先验精度 $\\tau_{0} = 1/\\sigma_{0}^{2}$ 和基线（注意力作用前）测量精度 $\\tau_{y} = 1/\\sigma_{y}^{2}$。\n\n仅从贝叶斯定理和高斯分布的概率密度函数出发，推导后验精度作为 $k$ 的函数，并随后推导在注意力作用下给定 $y$ 时 $x$ 的后验方差 $V(k)$。将您的最终答案表示为关于 $\\tau_{0}$、$\\tau_{y}$ 和 $k$ 的单个闭式解析表达式 $V(k)$。不需要进行数值计算，最终表达式也不需要单位。",
            "solution": "问题要求推导在注意力调节因子 $k$ 作用下，给定感官测量值 $y$ 时，潜状态 $x$ 的后验方差，记为 $V(k)$。推导必须从贝叶斯定理和高斯概率密度函数（PDF）的定义开始。\n\n首先，我们来确定先验分布和似然分布。\n\n潜状态 $x$ 的先验分布被给定为一个高斯分布：\n$$p(x) = \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$$\n该分布的概率密度函数正比于：\n$$p(x) \\propto \\exp\\left(-\\frac{(x - \\mu_{0})^{2}}{2\\sigma_{0}^{2}}\\right)$$\n\n感官测量值 $y$ 由线性高斯观测模型 $y = x + \\eta$ 生成。测量噪声 $\\eta$ 是一个高斯随机变量。在注意力调节下，噪声分布为 $\\eta \\sim \\mathcal{N}(0, \\sigma_{y}^{2}/k)$。根据观测模型，对于给定的状态 $x$，测量值 $y$ 服从以 $x$ 为中心、方差为 $\\sigma_{y}^{2}/k$ 的高斯分布。这定义了似然函数 $p(y|x)$:\n$$p(y|x) = \\mathcal{N}(x, \\sigma_{y}^{2}/k)$$\n作为固定测量值 $y$ 的 $x$ 的函数，似然函数为：\n$$p(y|x) \\propto \\exp\\left(-\\frac{(y - x)^{2}}{2(\\sigma_{y}^{2}/k)}\\right) = \\exp\\left(-\\frac{k(x - y)^{2}}{2\\sigma_{y}^{2}}\\right)$$\n\n根据贝叶斯定理，给定 $y$ 时 $x$ 的后验概率分布 $p(x|y)$，正比于似然函数与先验的乘积：\n$$p(x|y) \\propto p(y|x) p(x)$$\n代入先验和似然的表达式：\n$$p(x|y) \\propto \\exp\\left(-\\frac{k(x - y)^{2}}{2\\sigma_{y}^{2}}\\right) \\exp\\left(-\\frac{(x - \\mu_{0})^{2}}{2\\sigma_{0}^{2}}\\right)$$\n我们可以合并指数部分：\n$$p(x|y) \\propto \\exp\\left( -\\left[ \\frac{k(x - y)^{2}}{2\\sigma_{y}^{2}} + \\frac{(x - \\mu_{0})^{2}}{2\\sigma_{0}^{2}} \\right] \\right)$$\n\n问题将精度定义为方差的倒数。先验精度为 $\\tau_{0} = 1/\\sigma_{0}^{2}$，基线测量精度为 $\\tau_{y} = 1/\\sigma_{y}^{2}$。我们可以将在注意力作用下的有效测量精度定义为 $\\tau_{y,k} = 1/(\\sigma_{y}^{2}/k) = k/\\sigma_{y}^{2} = k\\tau_{y}$。\n\n将这些精度项代入后验分布的指数中：\n$$p(x|y) \\propto \\exp\\left( -\\frac{1}{2} \\left[ k\\tau_{y}(x - y)^{2} + \\tau_{0}(x - \\mu_{0})^{2} \\right] \\right)$$\n两个高斯分布的乘积是另一个高斯分布。因此，后验分布 $p(x|y)$ 是一个高斯分布，我们可以将其表示为 $\\mathcal{N}(\\mu_{\\text{post}}, \\sigma_{\\text{post}}^{2})$。该后验分布的概率密度函数正比于：\n$$p(x|y) \\propto \\exp\\left(-\\frac{(x - \\mu_{\\text{post}})^{2}}{2\\sigma_{\\text{post}}^{2}}\\right) = \\exp\\left(-\\frac{1}{2}\\tau_{\\text{post}}(x - \\mu_{\\text{post}})^{2}\\right)$$\n其中 $\\tau_{\\text{post}} = 1/\\sigma_{\\text{post}}^{2}$ 是后验精度。\n\n为了求得后验方差（或精度），我们可以分析我们推导出的后验表达式指数中关于 $x$ 的二次项。让我们展开指数括号内的项：\n$$k\\tau_{y}(x^{2} - 2xy + y^{2}) + \\tau_{0}(x^{2} - 2x\\mu_{0} + \\mu_{0}^{2})$$\n收集含有 $x^{2}$ 的项：\n$$(k\\tau_{y} + \\tau_{0})x^{2} - 2(k\\tau_{y}y + \\tau_{0}\\mu_{0})x + (\\text{与 } x \\text{ 无关的项})$$\n就其精度 $\\tau_{\\text{post}}$ 而言，高斯概率密度函数指数的一般形式为 $-\\frac{1}{2}(\\tau_{\\text{post}}x^2 - 2\\tau_{\\text{post}}\\mu_{\\text{post}}x + \\dots)$。通过将我们推导出的后验分布中 $x^{2}$ 项的系数与此一般形式进行比较，我们可以确定后验精度。\n指数中 $x^2$ 的系数是 $-\\frac{1}{2}(k\\tau_{y} + \\tau_{0})$。\n通过比较，这必须等于 $-\\frac{1}{2}\\tau_{\\text{post}}$。\n因此，作为注意力增益 $k$ 的函数的后验精度为：\n$$\\tau_{\\text{post}}(k) = \\tau_{0} + k\\tau_{y}$$\n这个结果阐释了高斯变量贝叶斯融合的一个基本原则：后验的精度是先验精度与似然精度的和。\n\n问题要求的是后验方差 $V(k)$。方差是精度的倒数：\n$$V(k) = \\sigma_{\\text{post}}^{2}(k) = \\frac{1}{\\tau_{\\text{post}}(k)}$$\n代入 $\\tau_{\\text{post}}(k)$ 的表达式：\n$$V(k) = \\frac{1}{\\tau_{0} + k\\tau_{y}}$$\n这就是以后验精度 $\\tau_{0}$、基线测量精度 $\\tau_{y}$ 和注意力调节因子 $k$ 表示的后验方差 $V(k)$ 的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{1}{\\tau_{0} + k\\tau_{y}}}$$"
        },
        {
            "introduction": "前面的练习探讨了注意力的计算“效果”，但大脑是如何实现这种调制的呢？分裂归一化（divisive normalization）是一种被广泛接受的典型神经计算，它为注意力的实现提供了一个具体的、具有生物合理解释的模型。在这个高级练习中，你将分析一个基于分裂归一化的注意力模型，该模型通过调节神经元群体的归一化池来实现增益控制。通过推导，你将理解这种机制如何在不改变神经元基本调谐特性（如方向选择性）的情况下，实现对刺激响应的增益调制（即对比度增益），这与神经生理学实验中的关键发现高度吻合。",
            "id": "4051897",
            "problem": "考虑一个由朝向调谐单元组成的群体中的神经形态注意模型，该模型使用除法归一化来模拟对比度增益调制，而不改变其偏好的朝向。每个单元都有一个朝向调谐函数 $T(\\theta)$，其中朝向 $\\theta$ 以弧度为单位，由一个 von Mises 函数 $T(\\theta) = \\exp\\!\\big(\\kappa \\cos(\\theta - \\theta_{0})\\big)$ 建模，其中集中参数 $\\kappa \\ge 0$，偏好朝向为 $\\theta_{0}$。基线对比度响应（对比度 $c \\in [0,1]$）遵循 Naka–Rushton 形式 $r_{0}(c) = \\frac{c^{n}}{c^{n} + \\sigma^{n}}$，其中 $n > 0$ 是指数，$\\sigma > 0$ 是半饱和对比度。\n\n在强度为 $A \\ge 0$ 的注意状态下，归一化池在分母上增加一个与池活动成比例的、独立于朝向的项。假设对于朝向为 $\\theta$ 的全场光栅，其除法归一化模型为\n$$\nR_{A}(\\theta,c) \\;=\\; T(\\theta)\\,\\frac{c^{n}}{c^{n} + \\sigma^{n} + \\beta\\,A\\,M(\\theta,c)}\\,,\n$$\n其中 $\\beta \\ge 0$ 用于缩放注意力的贡献，池活动为 $M(\\theta,c) = \\int_{0}^{2\\pi} T(\\phi - \\theta)\\,c^{n}\\,d\\phi$。使用恒等式 $\\int_{0}^{2\\pi} \\exp\\!\\big(\\kappa \\cos(\\phi)\\big)\\,d\\phi = 2\\pi I_{0}(\\kappa)$（其中 $I_{0}$ 是第一类零阶修正贝塞尔函数）来表示 $M(\\theta,c)$，并证明偏好朝向不受注意力的影响。\n\n将注意状态下的半饱和对比度 $c_{50}'$ 定义为 $R_{A}(\\theta,c)$ 达到其自身渐近最大值（当 $c \\to \\infty$ 时）一半时的对比度。推导 $c_{50}'$ 关于 $\\sigma$、$n$、$\\beta$、$A$ 和 $\\kappa$ 的闭式解析表达式。最终答案必须是单一的闭式表达式。无需四舍五入，最终量为无量纲量。",
            "solution": "我们从基线对比度响应 $r_{0}(c) = \\frac{c^{n}}{c^{n} + \\sigma^{n}}$ 和朝向调谐函数 $T(\\theta) = \\exp\\!\\big(\\kappa \\cos(\\theta - \\theta_{0})\\big)$ 开始，其中 $\\theta$ 以弧度为单位。注意模型指定\n$$\nR_{A}(\\theta,c) \\;=\\; T(\\theta)\\,\\frac{c^{n}}{c^{n} + \\sigma^{n} + \\beta\\,A\\,M(\\theta,c)}\\,,\n$$\n其中对于朝向为 $\\theta$ 的全场光栅，其归一化池活动为\n$$\nM(\\theta,c) \\;=\\; \\int_{0}^{2\\pi} T(\\phi - \\theta)\\,c^{n}\\,d\\phi \\;=\\; c^{n}\\int_{0}^{2\\pi} \\exp\\!\\big(\\kappa \\cos((\\phi - \\theta) - \\theta_{0})\\big)\\,d\\phi\\,.\n$$\n通过变量替换并利用 $2\\pi$ 周期性和恒等式 $\\int_{0}^{2\\pi} \\exp\\!\\big(\\kappa \\cos(\\psi)\\big)\\,d\\psi = 2\\pi I_{0}(\\kappa)$，我们得到\n$$\nM(\\theta,c) \\;=\\; c^{n}\\int_{0}^{2\\pi} \\exp\\!\\big(\\kappa \\cos(\\psi)\\big)\\,d\\psi \\;=\\; c^{n}\\,2\\pi I_{0}(\\kappa)\\,.\n$$\n此表达式不依赖于 $\\theta$，这意味着注意归一化项是独立于朝向的。将 $M(\\theta,c)$ 代入 $R_{A}(\\theta,c)$ 得\n$$\nR_{A}(\\theta,c) \\;=\\; T(\\theta)\\,\\frac{c^{n}}{c^{n} + \\sigma^{n} + \\beta\\,A\\,c^{n}\\,2\\pi I_{0}(\\kappa)} \\;=\\; T(\\theta)\\,\\frac{c^{n}}{\\sigma^{n} + c^{n}\\big(1 + \\alpha\\big)}\\,,\n$$\n其中我们定义了无量纲的注意归一化强度\n$$\n\\alpha \\;=\\; \\beta\\,A\\,2\\pi I_{0}(\\kappa)\\,.\n$$\n因为 $\\alpha$ 独立于 $\\theta$，响应可以写成\n$$\nR_{A}(\\theta,c) \\;=\\; T(\\theta)\\,f(c)\\,,\n$$\n其中 $f(c) = \\frac{c^{n}}{\\sigma^{n} + c^{n}(1+\\alpha)}$ 仅依赖于对比度。偏好朝向 $\\theta_{0}$ 是 $T(\\theta)$ 的最大化因子，并且由于 $f(c)$ 不依赖于 $\\theta$，偏好朝向不受注意力的影响。\n\n为了找到注意状态下的半饱和对比度，我们首先计算当 $c \\to \\infty$ 时的渐近最大值：\n$$\n\\lim_{c\\to\\infty} R_{A}(\\theta,c) \\;=\\; T(\\theta)\\,\\lim_{c\\to\\infty} \\frac{c^{n}}{\\sigma^{n} + c^{n}(1+\\alpha)} \\;=\\; T(\\theta)\\,\\frac{1}{1+\\alpha}\\,.\n$$\n根据定义，$c_{50}'$ 满足\n$$\nR_{A}(\\theta,c_{50}') \\;=\\; \\frac{1}{2}\\,\\lim_{c\\to\\infty} R_{A}(\\theta,c) \\;=\\; T(\\theta)\\,\\frac{1}{2(1+\\alpha)}\\,.\n$$\n代入 $R_{A}(\\theta,c_{50}')$ 并消去公因式 $T(\\theta)$ 得到\n$$\n\\frac{c_{50}'^{\\,n}}{\\sigma^{n} + c_{50}'^{\\,n}(1+\\alpha)} \\;=\\; \\frac{1}{2(1+\\alpha)}\\,.\n$$\n交叉相乘得到\n$$\n2(1+\\alpha)\\,c_{50}'^{\\,n} \\;=\\; \\sigma^{n} + c_{50}'^{\\,n}(1+\\alpha)\\,,\n$$\n因此\n$$\n(1+\\alpha)\\,c_{50}'^{\\,n} \\;=\\; \\sigma^{n}\\,,\n$$\n所以\n$$\nc_{50}'^{\\,n} \\;=\\; \\frac{\\sigma^{n}}{1+\\alpha}\\,.\n$$\n取 $n$ 次方根，\n$$\nc_{50}' \\;=\\; \\sigma\\,(1+\\alpha)^{-1/n} \\;=\\; \\sigma\\left(1 + \\beta\\,A\\,2\\pi I_{0}(\\kappa)\\right)^{-1/n}\\,.\n$$\n这个闭式表达式量化了在除法归一化和注意力作用下对比度响应函数的向左水平平移（对比度增益），而由于归一化项与朝向无关，偏好朝向保持不变。",
            "answer": "$$\\boxed{\\sigma\\left(1+\\beta\\,A\\,2\\pi I_{0}(\\kappa)\\right)^{-1/n}}$$"
        }
    ]
}