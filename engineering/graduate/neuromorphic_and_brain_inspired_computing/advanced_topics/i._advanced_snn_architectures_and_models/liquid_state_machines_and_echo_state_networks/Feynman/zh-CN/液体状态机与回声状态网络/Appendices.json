{
    "hands_on_practices": [
        {
            "introduction": "储层计算系统的功能基础是其动态稳定性，这通常被称为回声状态属性（Echo State Property, ESP）。此练习提供了一种实用的方法，通过使用格什戈林圆盘定理（Gershgorin Circle Theorem）来约束其特征值，从而设计一个能够确保满足回声状态属性的循环权重矩阵 $W$。这项实践将一个重要的理论工具与一个核心的工程设计挑战联系起来。",
            "id": "4050223",
            "problem": "考虑一个回声状态网络 (ESN) 线性区域中的离散时间线性化储层，其状态更新由 $x_{t+1} = W x_t + U u_t$ 给出，且输入 $u_t$ 是有界的。回声状态属性 (ESP) 要求对于固定的输入，储层动力学是渐近收缩的，在线性情况下，如果 $W$ 的谱半径严格小于1，则此属性得到保证。您的任务是使用盖尔圆盘定理设计一个能保证线性区域稳定性的循环权重矩阵，然后验证该设计。\n\n设循环权重矩阵参数化为 $W(s) = (1 - \\ell) I + s S$，其中 $\\ell \\in (0, 1)$ 是泄漏率参数，$s \\geq 0$ 是待设计的标量增益，$I$ 是单位矩阵，$S$ 是一个固定的、对角线为零的严格上三角连接模板：\n$$\nS \\;=\\;\n\\begin{pmatrix}\n0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n0  0  0  \\frac{11}{20} \\\\\n0  0  0  0\n\\end{pmatrix},\n\\qquad\n\\ell \\;=\\; \\frac{1}{5}.\n$$\n通过强制 $W(s)$ 的所有盖尔圆盘都位于复平面的单位圆内来设计 $s$，从而保证 $W(s)$ 的所有特征值都位于单位圆内。然后，通过计算在设计出的 $s$ 值下 $W(s)$ 的特征值来验证这一选择，并通过考虑由相同输入驱动的两条轨迹之间的差分动力学，论证在线性区域中对于有界输入，ESP 成立。\n\n请提供满足基于盖尔圆盘的设计要求的最大 $s$ 值，该值应为单个实数或单个闭式解析表达式。无需四舍五入，不涉及单位。最终的方框答案必须仅为此 $s$ 值。",
            "solution": "首先对用户的问题进行验证检查。\n\n### 步骤 1：提取已知条件\n-   状态更新方程：$x_{t+1} = W x_t + U u_t$\n-   循环权重矩阵参数化：$W(s) = (1 - \\ell) I + s S$\n-   泄漏率参数：$\\ell = \\frac{1}{5}$\n-   标量增益：$s \\geq 0$\n-   单位矩阵：$I$\n-   连接模板矩阵：\n    $$\n    S \\;=\\;\n    \\begin{pmatrix}\n    0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n    0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n    0  0  0  \\frac{11}{20} \\\\\n    0  0  0  0\n    \\end{pmatrix}\n    $$\n-   设计约束：$W(s)$ 的所有盖尔圆盘必须位于复平面的单位圆内。\n-   任务：找到满足设计约束的最大 $s$ 值，然后验证该选择并论证回声状态属性 (ESP) 的成立。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题牢固地植根于储层计算理论，特别是回声状态网络 (ESN)。回声状态属性、谱半径、状态空间模型和稳定性等概念是该领域的基础。使用盖尔圆盘定理是界定矩阵特征值的标准且有效的数学技术。该问题在科学上是合理的。\n-   **良构性：** 该问题清晰地定义了矩阵结构，提供了所有必要的参数，并指定了一个明确的目标：找到满足给定稳定性准则的最大增益 $s$。后续的验证步骤也定义明确。存在唯一的 $s$ 解。\n-   **客观性：** 该问题使用精确的数学语言和定义进行陈述，没有任何主观性或模糊性。\n\n### 步骤 3：结论与行动\n该问题具有科学依据、良构且客观。判定为**有效**。现在开始解题过程。\n\n目标是设计标量增益 $s$，使得循环权重矩阵 $W(s)$ 的谱半径严格小于 1，即 $\\rho(W(s))  1$。这保证了线性化系统的回声状态属性 (ESP)。设计将使用盖尔圆盘定理来执行。\n\n首先，我们构建矩阵 $W(s)$。给定泄漏率参数 $\\ell = \\frac{1}{5}$，项 $(1-\\ell)$ 变为 $1 - \\frac{1}{5} = \\frac{4}{5}$。\n矩阵 $W(s)$ 由下式给出：\n$$\nW(s) = (1 - \\ell) I + s S = \\frac{4}{5} I + s S\n$$\n代入矩阵 $I$ 和 $S$：\n$$\nW(s) = \\frac{4}{5}\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n+ s\n\\begin{pmatrix}\n0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n0  0  0  \\frac{11}{20} \\\\\n0  0  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{3s}{10}  -\\frac{s}{5}  0 \\\\\n0  \\frac{4}{5}  \\frac{s}{4}  -\\frac{s}{4} \\\\\n0  0  \\frac{4}{5}  \\frac{11s}{20} \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n$$\n接下来，我们应用盖尔圆盘定理。对于一个方阵 $A = (A_{ij})$，该定理指出，每个特征值都位于复平面中盖尔圆盘 $D(A_{ii}, R_i)$ 的并集内，其中第 $i$ 个圆盘的中心是对角元素 $A_{ii}$，其半径为 $R_i = \\sum_{j \\neq i} |A_{ij}|$。\n\n对于我们的矩阵 $W(s)$，所有对角元素都相同：$W_{ii}(s) = \\frac{4}{5}$（对于 $i=1, 2, 3, 4$）。因此，所有盖尔圆盘都以实数 $\\frac{4}{5}$ 为中心。我们计算每一行的半径 $R_i$。由于 $s \\ge 0$，我们有 $|s|=s$。\n-   $R_1 = |\\frac{3s}{10}| + |-\\frac{s}{5}| + |0| = \\frac{3s}{10} + \\frac{s}{5} = \\frac{3s+2s}{10} = \\frac{5s}{10} = \\frac{s}{2}$。\n-   $R_2 = |0| + |\\frac{s}{4}| + |-\\frac{s}{4}| = \\frac{s}{4} + \\frac{s}{4} = \\frac{2s}{4} = \\frac{s}{2}$。\n-   $R_3 = |0| + |0| + |\\frac{11s}{20}| = \\frac{11s}{20}$。\n-   $R_4 = |0| + |0| + |0| = 0$。\n\n设计要求规定所有盖尔圆盘必须严格位于单位圆 $|z|=1$ 内。对于一个以正实数 $c$ 为中心、半径为 $R$ 的圆盘，此条件为 $c+R  1$。在我们的例子中，中心是 $c = \\frac{4}{5}$。我们必须对 $R_1, R_2, R_3, R_4$ 中的最大半径满足此不等式。\n我们必须对每个半径强制执行该条件：\n1.  对于 $R_1 = \\frac{s}{2}$：$\\frac{4}{5} + \\frac{s}{2}  1 \\implies \\frac{s}{2}  1 - \\frac{4}{5} \\implies \\frac{s}{2}  \\frac{1}{5} \\implies s  \\frac{2}{5}$。\n2.  对于 $R_2 = \\frac{s}{2}$：这给出相同的条件，$s  \\frac{2}{5}$。\n3.  对于 $R_3 = \\frac{11s}{20}$：$\\frac{4}{5} + \\frac{11s}{20}  1 \\implies \\frac{11s}{20}  \\frac{1}{5} \\implies s  \\frac{20}{5 \\times 11} \\implies s  \\frac{4}{11}$。\n4.  对于 $R_4 = 0$：$\\frac{4}{5} + 0  1$，这总是成立的，并且不对 $s$ 施加任何约束。\n\n为确保所有圆盘都在单位圆内，我们必须同时满足对 $s$ 的所有约束。这要求 $s$ 小于所导出上界的最小值。我们比较这些上界：\n$$\n\\frac{2}{5} = \\frac{22}{55} \\quad \\text{和} \\quad \\frac{4}{11} = \\frac{20}{55}\n$$\n最严格的条件是 $s  \\frac{4}{11}$。问题要求满足此要求的最大 $s$ 值。这对应于区间 $[0, \\frac{4}{11})$ 的上确界，即 $s = \\frac{4}{11}$。我们选择这个边界值作为我们的设计。\n\n现在，我们来验证这个选择。我们设置 $s = \\frac{4}{11}$ 并检查矩阵 $W(\\frac{4}{11})$。\n$$\nW(\\frac{4}{11}) =\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{3}{10}(\\frac{4}{11})  -\\frac{1}{5}(\\frac{4}{11})  0 \\\\\n0  \\frac{4}{5}  \\frac{1}{4}(\\frac{4}{11})  -\\frac{1}{4}(\\frac{4}{11}) \\\\\n0  0  \\frac{4}{5}  \\frac{11}{20}(\\frac{4}{11}) \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{6}{55}  -\\frac{4}{55}  0 \\\\\n0  \\frac{4}{5}  \\frac{1}{11}  -\\frac{1}{11} \\\\\n0  0  \\frac{4}{5}  \\frac{1}{5} \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n$$\n这个矩阵是上三角矩阵。三角矩阵的特征值是其对角线元素。因此，$W(\\frac{4}{11})$ 的所有特征值都是 $\\lambda = \\frac{4}{5}$。\n谱半径为 $\\rho(W) = \\max_i |\\lambda_i| = |\\frac{4}{5}| = \\frac{4}{5}$。\n由于 $\\rho(W) = \\frac{4}{5}  1$，ESP 的条件得到满足。因此，基于盖尔圆盘的设计是成功的。\n\n最后，我们通过考虑差分动力学来论证 ESP 对有界输入成立。回声状态属性要求对于给定的输入信号 $u_t$，储层状态 $x_t$ 会渐近地忘记其初始状态 $x_0$。\n考虑两个状态轨迹 $x_t$ 和 $x'_t$，它们分别从不同的初始状态 $x_0$ 和 $x'_0$ 开始，但由相同的输入序列 $u_t$ 驱动。\n$$\nx_{t+1} = W x_t + U u_t\n$$\n$$\nx'_{t+1} = W x'_t + U u_t\n$$\n设 $\\delta_t = x_t - x'_t$ 为两个状态之间的差。该差分的动力学由下式给出：\n$$\n\\delta_{t+1} = x_{t+1} - x'_{t+1} = (W x_t + U u_t) - (W x'_t + U u_t) = W(x_t - x'_t) = W \\delta_t\n$$\n这是一个自治线性离散时间系统。其解为 $\\delta_t = W^t \\delta_0$。对于任何初始差 $\\delta_0$，状态差 $\\delta_t$ 将在 $t \\to \\infty$ 时收敛到零，当且仅当矩阵 $W$ 是稳定的，这意味着其所有特征值的模都严格小于 1。此条件等效于要求谱半径 $\\rho(W)$ 严格小于 1。\n如果 $\\lim_{t \\to \\infty} \\delta_t = 0$，则 $\\lim_{t \\to \\infty} (x_t - x'_t) = 0$，这表示两条轨迹收敛。因此，状态的渐近行为与初始条件无关，仅取决于输入信号 $u_t$ 的历史。这就是回声状态属性的定义。\n我们的设计得出了 $s = \\frac{4}{11}$，对此我们计算出谱半径为 $\\rho(W(\\frac{4}{11})) = \\frac{4}{5}$。由于 $\\frac{4}{5}  1$，差分动力学是渐近稳定的，ESP 得到保证。\n\n$s$ 的最大值为 $\\frac{4}{11}$。",
            "answer": "$$\\boxed{\\frac{4}{11}}$$"
        },
        {
            "introduction": "在确保稳定性之后，下一步是理解储层如何处理时间信息，这直接关系到其“记忆”能力。本练习通过将神经元的响应建模为与指数核的卷积，来探索储层中的记忆概念。通过这种方式，我们可以推导出神经元的时间常数 $\\tau$ 与系统有效记忆范围之间的明确关系。",
            "id": "4050175",
            "problem": "考虑一个液体状态机（LSM）或回声状态网络（ESN）中的储备池节点，该节点接收单变量脉冲序列，并向线性读出端提供一个连续时间滤波后的状态。在此类储备池常用的突触模型中，由单个突触前脉冲引起的突触后电流，通过一个时间常数为$\\,\\tau\\,$的因果指数核进行建模。具体来说，设该核为$\\,k(t)=\\exp(-t/\\tau)\\,H(t)\\,$，其中$\\,H(t)\\,$是亥维赛德阶跃函数。设输入脉冲序列为$\\,s(t)=\\sum_{i=1}^{N}\\delta(t-t_i)\\,$，其中$\\,\\delta(\\cdot)\\,$是狄拉克δ分布，$\\,t_1,\\dots,t_N\\,$是脉冲时间。用作读出特征的滤波后状态是卷积$\\,z(t)=(k*s)(t)\\,$。\n\n仅从线性时不变卷积的定义和狄拉克δ分布的筛选性质出发，不假定任何其他专门结论，完成以下任务：\n\n1) 推导$\\,z(t)\\,$关于$\\,\\{t_i\\}\\,$和$\\,\\tau\\,$的闭式表达式，该表达式对任意$\\,t\\,$均有效。\n\n2) 对于一个有$\\,N=4\\,$个脉冲的特定实现，其脉冲时间为$\\,t_1=2\\,\\mathrm{ms}\\,$, $\\,t_2=7\\,\\mathrm{ms}\\,$, $\\,t_3=9\\,\\mathrm{ms}\\,$和$\\,t_4=15\\,\\mathrm{ms}\\,$，计算在观测时间$\\,T=20\\,\\mathrm{ms}\\,$时的$\\,z(T)\\,$。将其表示为仅含$\\,\\tau\\,$的闭式解析表达式，其中$\\,\\tau\\,$的单位为$\\,\\mathrm{ms}\\,$，从而使指数的参数无量纲。\n\n3) 为精确说明$\\,\\tau\\,$如何调节储备池的有效记忆，定义在过去$\\,L\\,$个时间单位发生的脉冲的相对权重$\\,w(L;\\tau)\\,$，其值为该脉冲在时间$\\,t\\,$对$\\,z(t)\\,$的贡献，与一个在同一时间$\\,t\\,$发生的无穷小近期的脉冲贡献之比。使用相同模型，推导$\\,w(L;\\tau)\\,$，然后推导有效记忆时域$\\,L_{\\epsilon}(\\tau)\\,$，使得比$\\,L_{\\epsilon}(\\tau)\\,$更早的脉冲被衰减到至多为一个近期脉冲贡献的$\\,\\epsilon\\,$倍，其中$\\,0  \\epsilon  1\\,$。\n\n将第$\\,2\\,$部分得到的$\\,z(T)\\,$的闭式解析表达式作为最终答案，该表达式应为仅含$\\,\\tau\\,$的指数和形式。最终答案中不要包含单位。",
            "solution": "该问题被认为是有效的，因为它科学地基于线性时不变系统的既有理论及其在简化神经建模中的应用，问题陈述清晰，信息充分且一致，并以客观、正式的语言表述。我们开始解答。\n\n该问题分为三个部分。首先，我们推导滤波后状态$z(t)$的一般表达式。其次，我们将此表达式应用于一个特定情况。第三，我们分析系统的记忆特性。\n\n第1部分：滤波后状态$z(t)$的推导\n\n滤波后状态$z(t)$由核函数$k(t)$与输入脉冲序列$s(t)$的卷积给出。线性时不变系统的卷积定义为：\n$$z(t) = (k*s)(t) = \\int_{-\\infty}^{\\infty} k(t-\\lambda)s(\\lambda)d\\lambda$$\n已知核函数为$k(t) = \\exp(-t/\\tau)H(t)$，脉冲序列为$s(t) = \\sum_{i=1}^{N}\\delta(t-t_i)$，其中$H(t)$是亥维赛德阶跃函数，$\\delta(t)$是狄拉克δ分布。\n\n将$k(t)$和$s(t)$的表达式代入卷积积分：\n$$z(t) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\left( \\sum_{i=1}^{N}\\delta(\\lambda-t_i) \\right) d\\lambda$$\n根据积分的线性性质，我们可以交换求和与积分算子：\n$$z(t) = \\sum_{i=1}^{N} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\delta(\\lambda-t_i) d\\lambda$$\n题目要求使用狄拉克δ分布的筛选性质，该性质指出，对于一个函数$f(\\lambda)$，有$\\int_{-\\infty}^{\\infty} f(\\lambda)\\delta(\\lambda-a)d\\lambda = f(a)$，前提是$f$在$a$点连续。在我们的例子中，函数是$f(\\lambda) = \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda)$，求值点是$a=t_i$。对和中的每个积分应用筛选性质：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\delta(\\lambda-t_i) d\\lambda = \\exp\\left(-\\frac{t-t_i}{\\tau}\\right)H(t-t_i)$$\n将此结果代回求和式，得到$z(t)$的闭式表达式：\n$$z(t) = \\sum_{i=1}^{N} \\exp\\left(-\\frac{t-t_i}{\\tau}\\right)H(t-t_i)$$\n该表达式表明，状态$z(t)$是每个过去脉冲的指数衰减响应的线性叠加。亥维赛德函数$H(t-t_i)$强制实现了因果性，确保了在时间$t_i$的脉冲仅在时间$t \\ge t_i$时对状态有贡献。\n\n第2部分：针对特定脉冲序列计算$z(T)$\n\n给定$N=4$个脉冲，时间分别为$t_1=2\\,\\mathrm{ms}$、$t_2=7\\,\\mathrm{ms}$、$t_3=9\\,\\mathrm{ms}$和$t_4=15\\,\\mathrm{ms}$。我们需要计算在观测时间$T=20\\,\\mathrm{ms}$时的状态$z(T)$。时间常数$\\tau$的单位也是$\\mathrm{ms}$，这使得指数的参数是无量纲的。\n\n使用第1部分推导的公式，令$t=T=20$：\n$$z(20) = \\sum_{i=1}^{4} \\exp\\left(-\\frac{20-t_i}{\\tau}\\right)H(20-t_i)$$\n我们计算和中的每一项：\n对于$i=1$：$t_1=2$。亥维赛德函数的参数是$20-2=18 > 0$，所以$H(18)=1$。该项为$\\exp\\left(-\\frac{18}{\\tau}\\right)$。\n对于$i=2$：$t_2=7$。亥维赛德函数的参数是$20-7=13 > 0$，所以$H(13)=1$。该项为$\\exp\\left(-\\frac{13}{\\tau}\\right)$。\n对于$i=3$：$t_3=9$。亥维赛德函数的参数是$20-9=11 > 0$，所以$H(11)=1$。该项为$\\exp\\left(-\\frac{11}{\\tau}\\right)$。\n对于$i=4$：$t_4=15$。亥维赛德函数的参数是$20-15=5 > 0$，所以$H(5)=1$。该项为$\\exp\\left(-\\frac{5}{\\tau}\\right)$。\n\n将这些贡献相加，得到$z(20)$的最终表达式：\n$$z(20) = \\exp\\left(-\\frac{18}{\\tau}\\right) + \\exp\\left(-\\frac{13}{\\tau}\\right) + \\exp\\left(-\\frac{11}{\\tau}\\right) + \\exp\\left(-\\frac{5}{\\tau}\\right)$$\n\n第3部分：有效记忆度量的推导\n\n首先，我们推导相对权重$w(L;\\tau)$。它被定义为在时间$t_{past} = t-L$的脉冲对$z(t)$的贡献，与在时间$t$的一个无穷小近期的脉冲的贡献之比。设近期脉冲发生在$t_{recent} = t-\\delta$，其中$\\delta \\to 0^{+}$。\n\n在$t-L$的过去脉冲的贡献可以通过应用第1部分中单个脉冲($N=1$)的结果找到：\n$$C_{past} = \\exp\\left(-\\frac{t-(t-L)}{\\tau}\\right)H(t-(t-L)) = \\exp\\left(-\\frac{L}{\\tau}\\right)H(L)$$\n由于$L$表示过去的一段时间，因此$L>0$，所以$H(L)=1$。于是，$C_{past} = \\exp(-L/\\tau)$。\n\n在$t-\\delta$的无穷小近期脉冲的贡献是：\n$$C_{recent} = \\exp\\left(-\\frac{t-(t-\\delta)}{\\tau}\\right)H(t-(t-\\delta)) = \\exp\\left(-\\frac{\\delta}{\\tau}\\right)H(\\delta)$$\n当$\\delta \\to 0^{+}$（表示一个无穷小的延迟）时，$H(\\delta)=1$且$\\exp(-\\delta/\\tau) \\to \\exp(0) = 1$。所以，$C_{recent} = 1$。\n\n相对权重$w(L;\\tau)$是以下比值：\n$$w(L;\\tau) = \\frac{C_{past}}{C_{recent}} = \\frac{\\exp(-L/\\tau)}{1} = \\exp\\left(-\\frac{L}{\\tau}\\right)$$\n\n接下来，我们推导有效记忆时域$L_{\\epsilon}(\\tau)$。这是指一个时间$L$，任何比$L$更早的脉冲都被衰减到近期脉冲贡献的$\\epsilon$倍或更少。这意味着我们在寻找满足条件$w(L; \\tau) \\le \\epsilon$（对所有$L > L_{\\epsilon}$）的$L_{\\epsilon}$值。由于$w(L;\\tau)$是$L$的单调递减函数（对于$L>0, \\tau>0$），该条件通过找到等式成立的边界值$L_{\\epsilon}$来满足：\n$$w(L_{\\epsilon};\\tau) = \\epsilon$$\n$$\\exp\\left(-\\frac{L_{\\epsilon}}{\\tau}\\right) = \\epsilon$$\n为了解出$L_{\\epsilon}$，我们对两边取自然对数：\n$$-\\frac{L_{\\epsilon}}{\\tau} = \\ln(\\epsilon)$$\n$$L_{\\epsilon}(\\tau) = -\\tau\\ln(\\epsilon)$$\n因为题目说明$0  \\epsilon  1$，我们有$\\ln(\\epsilon)  0$，这确保了$L_{\\epsilon}(\\tau)$是一个正量。这也可以写作$L_{\\epsilon}(\\tau) = \\tau\\ln(1/\\epsilon)$。这个结果量化了时间常数$\\tau$如何调节系统的记忆；对于一个固定的衰减因子$\\epsilon$，更大的$\\tau$会导致更长的记忆时域。\n\n要求的最终答案是第2部分中$z(T)$的表达式。",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{18}{\\tau}\\right) + \\exp\\left(-\\frac{13}{\\tau}\\right) + \\exp\\left(-\\frac{11}{\\tau}\\right) + \\exp\\left(-\\frac{5}{\\tau}\\right)}\n$$"
        },
        {
            "introduction": "有了一个具有理想记忆能力的稳定储层后，我们就可以生成用于训练的状态轨迹。然而，这些状态在初始阶段会受到任意初始条件的影响，这些瞬态响应需要被舍弃。本练习旨在解决“冲刷”（washout）这一实际问题，我们将为冲刷期推导一个理论界限，并结合经验性能选择一个最佳值，从而将理论分析与实际应用相结合。",
            "id": "4050150",
            "problem": "考虑一个用于回声状态网络 (ESN) 和液体状态机 (LSM) 的离散时间储层，该储层被建模为一个泄露积分器，其更新规则为\n$$x_{t+1} = (1 - a)\\,x_{t} + a\\,\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right),$$\n其中 $x_{t} \\in \\mathbb{R}^{n}$ 是在时间 $t$ 的储层状态，$u_{t} \\in \\mathbb{R}^{m}$ 是在时间 $t$ 的输入，$W \\in \\mathbb{R}^{n \\times n}$ 是循环权重矩阵，$W_{\\mathrm{in}} \\in \\mathbb{R}^{n \\times m}$ 是输入权重矩阵，$a \\in (0,1]$ 是泄露率，$\\phi$ 是一个逐元素的非线性函数。假设 $\\phi$ 是双曲正切函数，即 $\\phi = \\tanh$，并且全文使用欧几里得范数 $\\|\\cdot\\|_{2}$。\n\n冲刷（Washout）定义为在拟合读出层之前，丢弃储层状态的前 $T_{w}$ 个步骤，以消除对初始条件的依赖。利用驱动储层动力学的收缩性质，推导出一个关于冲刷长度 $T_{w}$ 的显式界，该界保证在 $T_{w}$ 步之后，初始状态对 $x_{t}$ 的残余影响不超过容差 $\\varepsilon$。\n\n假设以下设计参数是已知的：\n- 泄露率 $a = \\frac{1}{2}$，\n- 算子范数 $\\|W\\|_{2} = 0.6$，\n- $\\phi$ 的 Lipschitz 常数满足 $\\|\\phi'\\|_{\\infty} \\leq 1$（对于 $\\tanh$ 成立），\n- 最坏情况初始条件差异有界，为 $\\|x_{0} - x_{0}'\\|_{2} \\leq D$，其中 $D = 2$，\n- 期望容差为 $\\varepsilon = 10^{-2}$。\n\n然后，评估以下作为冲刷长度 $T_{w}$ 函数的验证误差：\n- 当 $T_{w} = 0$ 时，$E_{\\mathrm{val}} = 0.142$；\n- 当 $T_{w} = 5$ 时，$E_{\\mathrm{val}} = 0.125$；\n- 当 $T_{w} = 10$ 时，$E_{\\mathrm{val}} = 0.118$；\n- 当 $T_{w} = 15$ 时，$E_{\\mathrm{val}} = 0.113$；\n- 当 $T_{w} = 20$ 时，$E_{\\mathrm{val}} = 0.111$；\n- 当 $T_{w} = 24$ 时，$E_{\\mathrm{val}} = 0.110$；\n- 当 $T_{w} = 25$ 时，$E_{\\mathrm{val}} = 0.110$；\n- 当 $T_{w} = 30$ 时，$E_{\\mathrm{val}} = 0.112$。\n\n使用一个原则性选择标准来确定冲刷长度 $T_{w}$，该标准要求所选的 $T_{w}$ (i) 满足推导出的基于收缩的界，并且 (ii) 在所有测试的 $T_{w}$ 值中达到观测到的最小验证误差（若出现相同值，则选择较小的 $T_{w}$）。将选定的冲刷长度 $T_{w}$ 报告为单个整数步数。",
            "solution": "目标是找到冲刷长度 $T_{w}$ 的一个下界，使得储层状态对初始条件的依赖性降低到容差 $\\varepsilon$ 以下。推导过程将使用标准工具：回声状态属性 (ESP)、非线性函数的 Lipschitz 连续性，以及在合适范数界下的驱动递归的收缩性。\n\n我们从更新规则开始\n$$x_{t+1} = (1 - a)\\,x_{t} + a\\,\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right),$$\n并考虑由相同输入序列 $\\{u_{t}\\}$ 驱动但从不同初始状态 $x_{0}$ 和 $x_{0}'$ 开始的两条轨迹 $x_{t}$ 和 $x_{t}'$。令 $\\Delta_{t} = x_{t} - x_{t}'$。那么\n\\begin{align*}\n\\Delta_{t+1} = (1 - a)\\,(x_{t} - x_{t}') + a\\left[\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + W_{\\mathrm{in}}\\,u_{t}\\right)\\right] \\\\\n= (1 - a)\\,\\Delta_{t} + a\\left[\\phi\\!\\left(W\\,x_{t} + b_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + b_{t}\\right)\\right],\n\\end{align*}\n其中 $b_{t} = W_{\\mathrm{in}}\\,u_{t}$ 是在时间 $t$ 的输入驱动。根据中值定理和 $\\phi$ 的 Lipschitz 连续性（常数为 $\\gamma = \\|\\phi'\\|_{\\infty} \\leq 1$），我们有\n$$\\|\\phi(v) - \\phi(w)\\|_{2} \\leq \\gamma\\,\\|v - w\\|_{2} \\quad \\text{对所有 } v, w.$$\n取 $v = W\\,x_{t} + b_{t}$ 和 $w = W\\,x_{t}' + b_{t}$，输入项被消去，我们得到\n$$\\|\\phi\\!\\left(W\\,x_{t} + b_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + b_{t}\\right)\\|_{2} \\leq \\gamma\\,\\|W\\,(x_{t} - x_{t}')\\|_{2} \\leq \\gamma\\,\\|W\\|_{2}\\,\\|\\Delta_{t}\\|_{2}.$$\n因此，\n\\begin{align*}\n\\|\\Delta_{t+1}\\|_{2} \n\\leq (1 - a)\\,\\|\\Delta_{t}\\|_{2} + a\\,\\gamma\\,\\|W\\|_{2}\\,\\|\\Delta_{t}\\|_{2} \\\\\n= \\left[(1 - a) + a\\,\\gamma\\,\\|W\\|_{2}\\right]\\,\\|\\Delta_{t}\\|_{2}.\n\\end{align*}\n定义单步收缩因子\n$$\\alpha \\coloneqq (1 - a) + a\\,\\gamma\\,\\|W\\|_{2}.$$\n在设计约束 $\\alpha  1$ 下，当由相同输入序列驱动时，驱动储层在状态差异上是收缩的。迭代该不等式可得\n$$\\|\\Delta_{t}\\|_{2} \\leq \\alpha^{t}\\,\\|\\Delta_{0}\\|_{2}.$$\n如果最坏情况下的初始差异满足 $\\|\\Delta_{0}\\|_{2} \\leq D$，则\n$$\\|\\Delta_{t}\\|_{2} \\leq \\alpha^{t}\\,D.$$\n为确保在 $T_{w}$ 步之后，对初始条件的残余依赖性不大于 $\\varepsilon$，我们需要\n$$\\alpha^{T_{w}}\\,D \\leq \\varepsilon.$$\n求解 $T_{w}$，\n\\begin{align*}\n\\alpha^{T_{w}} \\leq \\frac{\\varepsilon}{D}\n\\quad\\Longrightarrow\\quad\nT_{w}\\,\\ln(\\alpha) \\leq \\ln\\!\\left(\\frac{\\varepsilon}{D}\\right) \\\\\n\\quad\\Longrightarrow\\quad\nT_{w} \\geq \\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)}.\n\\end{align*}\n因为 $\\alpha \\in (0,1)$，我们有 $\\ln(\\alpha)  0$，并且当 $\\varepsilon  D$ 时，右侧为正。满足该不等式的最小整数是\n$$T_{w}^{\\star} = \\left\\lceil \\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)} \\right\\rceil.$$\n\n现在代入给定的参数：\n- $a = \\frac{1}{2}$，\n- $\\gamma = 1$（对于 $\\tanh$），\n- $\\|W\\|_{2} = 0.6$，\n- $D = 2$，\n- $\\varepsilon = 10^{-2}$。\n\n计算收缩因子 $\\alpha$：\n\\begin{align*}\n\\alpha = (1 - a) + a\\,\\gamma\\,\\|W\\|_{2} \\\\\n= \\left(1 - \\frac{1}{2}\\right) + \\frac{1}{2}\\cdot 1 \\cdot 0.6 \\\\\n= 0.5 + 0.3 \\\\\n= 0.8.\n\\end{align*}\n计算对数比：\n\\begin{align*}\n\\frac{\\varepsilon}{D} = \\frac{10^{-2}}{2} = 5 \\times 10^{-3}, \\\\\n\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right) = \\ln(5 \\times 10^{-3}) = \\ln(5) + \\ln(10^{-3}) \\\\\n= \\ln(5) - 3\\,\\ln(10) \\\\\n\\approx 1.609437912 - 3 \\times 2.302585093 \\\\\n\\approx 1.609437912 - 6.907755279 \\\\\n\\approx -5.298317367, \\\\\n\\ln(\\alpha) = \\ln(0.8) \\approx -0.223143551.\n\\end{align*}\n因此\n\\begin{align*}\n\\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)} \n\\approx \\frac{-5.298317367}{-0.223143551} \\\\\n\\approx 23.74999999,\n\\end{align*}\n所以最小整数是\n$$T_{w}^{\\star} = \\lceil 23.75 \\rceil = 24.$$\n\n接下来，评估所提供的不同 $T_{w}$ 的验证误差：\n- $E_{\\mathrm{val}}(0) = 0.142$，\n- $E_{\\mathrm{val}}(5) = 0.125$，\n- $E_{\\mathrm{val}}(10) = 0.118$，\n- $E_{\\mathrm{val}}(15) = 0.113$，\n- $E_{\\mathrm{val}}(20) = 0.111$，\n- $E_{\\mathrm{val}}(24) = 0.110$，\n- $E_{\\mathrm{val}}(25) = 0.110$，\n- $E_{\\mathrm{val}}(30) = 0.112$。\n\n在测试的冲刷长度中，观测到的最小验证误差为 $0.110$，出现在 $T_{w} = 24$ 和 $T_{w} = 25$ 处。根据原则性选择标准，我们要求 $T_{w} \\geq T_{w}^{\\star} = 24$，并在达到最小误差的值中选择较小的 $T_{w}$。因此，所选的冲刷长度为\n$$T_{w} = 24.$$",
            "answer": "$$\\boxed{24}$$"
        }
    ]
}