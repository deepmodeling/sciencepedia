{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of reservoir computing is the Echo State Property (ESP), which ensures that the reservoir's state is a unique function of the input history, independent of its initial conditions. This property is guaranteed if the reservoir's recurrent weight matrix $W$ has a spectral radius less than one. This first practice provides a constructive approach to this fundamental design challenge, using the Gershgorin Circle Theorem as a powerful tool to engineer a weight matrix $W$ whose eigenvalues are guaranteed to lie within the unit circle, thereby ensuring stability from the ground up .",
            "id": "4050223",
            "problem": "Consider a discrete-time linearized reservoir in the linear regime of an Echo State Network (ESN), where the state update is given by $x_{t+1} = W x_t + U u_t$, and the input $u_t$ is bounded. The Echo State Property (ESP) requires that the reservoir dynamics be asymptotically contractive for fixed input, which in the linear case is guaranteed if the spectral radius of $W$ is strictly less than $1$. You are tasked with designing a recurrent weight matrix that guarantees stability in the linear regime using the Gershgorin Circle Theorem and then validating the design.\n\nLet the recurrent weight matrix be parameterized as $W(s) = (1 - \\ell) I + s S$, where $\\ell \\in (0, 1)$ is the leak parameter, $s \\geq 0$ is a scalar gain to be designed, $I$ is the identity matrix, and $S$ is a fixed, strictly upper-triangular connectivity template with zero diagonal:\n$$\nS \\;=\\;\n\\begin{pmatrix}\n0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n0  0  0  \\frac{11}{20} \\\\\n0  0  0  0\n\\end{pmatrix},\n\\qquad\n\\ell \\;=\\; \\frac{1}{5}.\n$$\nDesign $s$ by enforcing that all Gershgorin disks of $W(s)$ lie within the unit circle in the complex plane, thereby guaranteeing that all eigenvalues of $W(s)$ lie within the unit circle. Then validate the choice by computing the eigenvalues of $W(s)$ at the designed $s$ and argue that the ESP holds in the linear regime for bounded inputs by considering the difference dynamics between two trajectories driven by the same input.\n\nProvide the largest $s$ that satisfies the Gershgorin-based design requirement as a single real number or a single closed-form analytic expression. No rounding is required and no units are involved. The final boxed answer must be this value of $s$ only.",
            "solution": "The user's problem is first subjected to a validation check.\n\n### Step 1: Extract Givens\n-   State update equation: $x_{t+1} = W x_t + U u_t$\n-   Recurrent weight matrix parameterization: $W(s) = (1 - \\ell) I + s S$\n-   Leak parameter: $\\ell = \\frac{1}{5}$\n-   Scalar gain: $s \\geq 0$\n-   Identity matrix: $I$\n-   Connectivity template matrix:\n    $$\n    S \\;=\\;\n    \\begin{pmatrix}\n    0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n    0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n    0  0  0  \\frac{11}{20} \\\\\n    0  0  0  0\n    \\end{pmatrix}\n    $$\n-   Design constraint: All Gershgorin disks of $W(s)$ must lie within the unit circle in the complex plane.\n-   Task: Find the largest $s$ satisfying the design constraint, then validate the choice and argue for the Echo State Property (ESP).\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is firmly rooted in the theory of reservoir computing, specifically Echo State Networks (ESNs). The concepts of the Echo State Property, spectral radius, state-space models, and stability are fundamental to this field. The use of the Gershgorin Circle Theorem is a standard and valid mathematical technique for bounding the eigenvalues of a matrix. The problem is scientifically sound.\n-   **Well-Posed:** The problem clearly defines the matrix structure, provides all necessary parameters, and specifies a clear objective: to find the largest gain $s$ that satisfies a given stability criterion. The subsequent validation step is also well-defined. A unique solution for $s$ exists.\n-   **Objective:** The problem is stated using precise mathematical language and definitions, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It is deemed **valid**. The solution process will now proceed.\n\nThe goal is to design the scalar gain $s$ such that the spectral radius of the recurrent weight matrix $W(s)$ is strictly less than $1$, i.e., $\\rho(W(s))  1$. This guarantees the Echo State Property (ESP) for the linearized system. The design is to be performed using the Gershgorin Circle Theorem.\n\nFirst, we construct the matrix $W(s)$. With the given leak parameter $\\ell = \\frac{1}{5}$, the term $(1-\\ell)$ becomes $1 - \\frac{1}{5} = \\frac{4}{5}$.\nThe matrix $W(s)$ is given by:\n$$\nW(s) = (1 - \\ell) I + s S = \\frac{4}{5} I + s S\n$$\nSubstituting the matrices $I$ and $S$:\n$$\nW(s) = \\frac{4}{5}\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n+ s\n\\begin{pmatrix}\n0  \\frac{3}{10}  -\\frac{1}{5}  0 \\\\\n0  0  \\frac{1}{4}  -\\frac{1}{4} \\\\\n0  0  0  \\frac{11}{20} \\\\\n0  0  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{3s}{10}  -\\frac{s}{5}  0 \\\\\n0  \\frac{4}{5}  \\frac{s}{4}  -\\frac{s}{4} \\\\\n0  0  \\frac{4}{5}  \\frac{11s}{20} \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n$$\nNext, we apply the Gershgorin Circle Theorem. For a square matrix $A = (A_{ij})$, the theorem states that every eigenvalue lies within the union of the Gershgorin disks $D(A_{ii}, R_i)$ in the complex plane, where the center of the $i$-th disk is the diagonal element $A_{ii}$ and its radius is $R_i = \\sum_{j \\neq i} |A_{ij}|$.\n\nFor our matrix $W(s)$, all diagonal elements are identical: $W_{ii}(s) = \\frac{4}{5}$ for $i=1, 2, 3, 4$. Thus, all Gershgorin disks are centered at the real number $\\frac{4}{5}$. We calculate the radii $R_i$ for each row. Since $s \\ge 0$, we have $|s|=s$.\n-   $R_1 = |\\frac{3s}{10}| + |-\\frac{s}{5}| + |0| = \\frac{3s}{10} + \\frac{s}{5} = \\frac{3s+2s}{10} = \\frac{5s}{10} = \\frac{s}{2}$.\n-   $R_2 = |0| + |\\frac{s}{4}| + |-\\frac{s}{4}| = \\frac{s}{4} + \\frac{s}{4} = \\frac{2s}{4} = \\frac{s}{2}$.\n-   $R_3 = |0| + |0| + |\\frac{11s}{20}| = \\frac{11s}{20}$.\n-   $R_4 = |0| + |0| + |0| = 0$.\n\nThe design requirement states that all Gershgorin disks must lie strictly within the unit circle $|z|=1$. For a disk centered at a positive real number $c$ with radius $R$, this condition is $c+R  1$. In our case, the center is $c = \\frac{4}{5}$. We must satisfy this inequality for the largest radius among $R_1, R_2, R_3, R_4$.\nWe must enforce the condition for each radius:\n1.  For $R_1 = \\frac{s}{2}$: $\\frac{4}{5} + \\frac{s}{2}  1 \\implies \\frac{s}{2}  1 - \\frac{4}{5} \\implies \\frac{s}{2}  \\frac{1}{5} \\implies s  \\frac{2}{5}$.\n2.  For $R_2 = \\frac{s}{2}$: This gives the same condition, $s  \\frac{2}{5}$.\n3.  For $R_3 = \\frac{11s}{20}$: $\\frac{4}{5} + \\frac{11s}{20}  1 \\implies \\frac{11s}{20}  \\frac{1}{5} \\implies s  \\frac{20}{5 \\times 11} \\implies s  \\frac{4}{11}$.\n4.  For $R_4 = 0$: $\\frac{4}{5} + 0  1$, which is always true and places no constraint on $s$.\n\nTo ensure all disks are within the unit circle, we must satisfy all constraints on $s$ simultaneously. This requires $s$ to be smaller than the minimum of the derived upper bounds. We compare the bounds:\n$$\n\\frac{2}{5} = \\frac{22}{55} \\quad \\text{and} \\quad \\frac{4}{11} = \\frac{20}{55}\n$$\nThe most restrictive condition is $s  \\frac{4}{11}$. The problem asks for the largest value of $s$ that satisfies this requirement. This corresponds to the supremum of the interval $[0, \\frac{4}{11})$, which is $s = \\frac{4}{11}$. We select this boundary value for our design.\n\nNow, we validate this choice. We set $s = \\frac{4}{11}$ and examine the matrix $W(\\frac{4}{11})$.\n$$\nW(\\frac{4}{11}) =\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{3}{10}(\\frac{4}{11})  -\\frac{1}{5}(\\frac{4}{11})  0 \\\\\n0  \\frac{4}{5}  \\frac{1}{4}(\\frac{4}{11})  -\\frac{1}{4}(\\frac{4}{11}) \\\\\n0  0  \\frac{4}{5}  \\frac{11}{20}(\\frac{4}{11}) \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{6}{55}  -\\frac{4}{55}  0 \\\\\n0  \\frac{4}{5}  \\frac{1}{11}  -\\frac{1}{11} \\\\\n0  0  \\frac{4}{5}  \\frac{1}{5} \\\\\n0  0  0  \\frac{4}{5}\n\\end{pmatrix}\n$$\nThis matrix is upper triangular. The eigenvalues of a triangular matrix are its diagonal entries. Therefore, all eigenvalues of $W(\\frac{4}{11})$ are $\\lambda = \\frac{4}{5}$.\nThe spectral radius is $\\rho(W) = \\max_i |\\lambda_i| = |\\frac{4}{5}| = \\frac{4}{5}$.\nSince $\\rho(W) = \\frac{4}{5}  1$, the condition for the ESP is satisfied. The Gershgorin-based design is thus successful.\n\nFinally, we argue that the ESP holds for bounded inputs by considering the difference dynamics. The Echo State Property requires that for a given input signal $u_t$, the reservoir state $x_t$ asymptotically forgets its initial state $x_0$.\nConsider two state trajectories, $x_t$ and $x'_t$, starting from different initial states $x_0$ and $x'_0$ respectively, but driven by the same input sequence $u_t$.\n$$\nx_{t+1} = W x_t + U u_t\n$$\n$$\nx'_{t+1} = W x'_t + U u_t\n$$\nLet $\\delta_t = x_t - x'_t$ be the difference between the two states. The dynamics of this difference are given by:\n$$\n\\delta_{t+1} = x_{t+1} - x'_{t+1} = (W x_t + U u_t) - (W x'_t + U u_t) = W(x_t - x'_t) = W \\delta_t\n$$\nThis is an autonomous linear discrete-time system. Its solution is $\\delta_t = W^t \\delta_0$. The state difference $\\delta_t$ will converge to zero as $t \\to \\infty$ for any initial difference $\\delta_0$ if and only if the matrix $W$ is stable, which means all of its eigenvalues have a magnitude strictly less than $1$. This condition is equivalent to requiring the spectral radius $\\rho(W)$ to be strictly less than $1$.\nIf $\\lim_{t \\to \\infty} \\delta_t = 0$, then $\\lim_{t \\to \\infty} (x_t - x'_t) = 0$, which signifies that the two trajectories converge. The asymptotic behavior of the state is thus independent of the initial conditions, depending only on the history of the input signal $u_t$. This is the definition of the Echo State Property.\nOur design yielded $s = \\frac{4}{11}$, for which we calculated the spectral radius to be $\\rho(W(\\frac{4}{11})) = \\frac{4}{5}$. Since $\\frac{4}{5}  1$, the difference dynamics are asymptotically stable, and the ESP is guaranteed.\n\nThe largest value for $s$ is $\\frac{4}{11}$.",
            "answer": "$$\\boxed{\\frac{4}{11}}$$"
        },
        {
            "introduction": "With a stable reservoir design in hand, we can now explore how its dynamics create useful computational features. This exercise demystifies the concept of the reservoir's \"memory\" by modeling its state as the output of a synaptic filter, a common approach in Liquid State Machines. By deriving the reservoir state as a convolution of the input spike train with an exponential kernel, you will gain a concrete understanding of how the reservoir transforms input history into a rich, time-varying representation and how the kernel's time constant $\\tau$ directly tunes the system's memory capacity .",
            "id": "4050175",
            "problem": "Consider a reservoir node in a Liquid State Machine (LSM) or an Echo State Network (ESN) that receives a univariate spike train and exposes a continuous-time filtered state to a linear readout. In a commonly used synaptic model for such reservoirs, the post-synaptic current evoked by a single presynaptic spike is modeled by a causal exponential kernel with time constant $\\,\\tau\\,$. Specifically, let the kernel be $\\,k(t)=\\exp(-t/\\tau)\\,H(t)\\,$, where $\\,H(t)\\,$ is the Heaviside step function. Let the input spike train be $\\,s(t)=\\sum_{i=1}^{N}\\delta(t-t_i)\\,$, where $\\,\\delta(\\cdot)\\,$ is the Dirac delta distribution and $\\,t_1,\\dots,t_N\\,$ are spike times. The filtered state used as a readout feature is the convolution $\\,z(t)=(k*s)(t)\\,$.\n\nStarting only from the definitions of linear time-invariant convolution and the sifting property of the Dirac delta distribution, and without assuming any other specialized results, do the following:\n\n1) Derive a closed-form expression for $\\,z(t)\\,$ in terms of $\\,\\{t_i\\}\\,$ and $\\,\\tau\\,$ that is valid for arbitrary $\\,t\\,$.\n\n2) For a particular realization with $\\,N=4\\,$ spikes at times $\\,t_1=2\\,\\mathrm{ms}\\,$, $\\,t_2=7\\,\\mathrm{ms}\\,$, $\\,t_3=9\\,\\mathrm{ms}\\,$, and $\\,t_4=15\\,\\mathrm{ms}\\,$, compute $\\,z(T)\\,$ at observation time $\\,T=20\\,\\mathrm{ms}\\,$ as a closed-form analytic expression in terms of $\\,\\tau\\,$, where $\\,\\tau\\,$ is measured in $\\,\\mathrm{ms}\\,$ so that the argument of the exponential is dimensionless.\n\n3) To make precise how $\\,\\tau\\,$ tunes the reservoirâ€™s effective memory, define the relative weight $\\,w(L;\\tau)\\,$ of a spike that occurred $\\,L\\,$ units of time in the past as the ratio of its contribution to $\\,z(t)\\,$ at time $\\,t\\,$ to that of an infinitesimally recent spike at the same time $\\,t\\,$. Using the same model, derive $\\,w(L;\\tau)\\,$ and then derive the effective memory horizon $\\,L_{\\epsilon}(\\tau)\\,$ such that spikes older than $\\,L_{\\epsilon}(\\tau)\\,$ are attenuated to at most a fraction $\\,\\epsilon\\,$ of a recent spike, where $\\,0\\epsilon1\\,$.\n\nProvide your final answer as the closed-form analytic expression for $\\,z(T)\\,$ from part $\\,2\\,$, expressed as a sum of exponentials in terms of $\\,\\tau\\,$ only. Do not include units in your final answer.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the established theory of linear time-invariant systems and its application to simplified neural modeling, is well-posed with sufficient and consistent information, and is expressed in objective, formal language. We proceed with the solution.\n\nThe problem is divided into three parts. First, we derive a general expression for the filtered state $z(t)$. Second, we apply this expression to a specific case. Third, we analyze the memory properties of the system.\n\nPart 1: Derivation of the filtered state $z(t)$\n\nThe filtered state $z(t)$ is given by the convolution of the kernel $k(t)$ with the input spike train $s(t)$. The definition of convolution for linear time-invariant systems is:\n$$z(t) = (k*s)(t) = \\int_{-\\infty}^{\\infty} k(t-\\lambda)s(\\lambda)d\\lambda$$\nThe givens are the kernel $k(t) = \\exp(-t/\\tau)H(t)$ and the spike train $s(t) = \\sum_{i=1}^{N}\\delta(t-t_i)$, where $H(t)$ is the Heaviside step function and $\\delta(t)$ is the Dirac delta distribution.\n\nSubstituting the expressions for $k(t)$ and $s(t)$ into the convolution integral:\n$$z(t) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\left( \\sum_{i=1}^{N}\\delta(\\lambda-t_i) \\right) d\\lambda$$\nDue to the linearity of the integral, we can interchange the summation and integration operators:\n$$z(t) = \\sum_{i=1}^{N} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\delta(\\lambda-t_i) d\\lambda$$\nThe problem requires using the sifting property of the Dirac delta distribution, which states that for a function $f(\\lambda)$, $\\int_{-\\infty}^{\\infty} f(\\lambda)\\delta(\\lambda-a)d\\lambda = f(a)$, provided $f$ is continuous at $a$. In our case, the function is $f(\\lambda) = \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda)$ and the point of evaluation is $a=t_i$. Applying the sifting property to each integral in the sum:\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-\\lambda}{\\tau}\\right)H(t-\\lambda) \\delta(\\lambda-t_i) d\\lambda = \\exp\\left(-\\frac{t-t_i}{\\tau}\\right)H(t-t_i)$$\nSubstituting this back into the summation gives the closed-form expression for $z(t)$:\n$$z(t) = \\sum_{i=1}^{N} \\exp\\left(-\\frac{t-t_i}{\\tau}\\right)H(t-t_i)$$\nThis expression shows that the state $z(t)$ is a linear superposition of the exponentially decaying responses to each past spike. The Heaviside function $H(t-t_i)$ enforces causality, ensuring that a spike at time $t_i$ contributes to the state only for times $t \\ge t_i$.\n\nPart 2: Computation of $z(T)$ for a specific spike train\n\nWe are given $N=4$ spikes at times $t_1=2\\,\\mathrm{ms}$, $t_2=7\\,\\mathrm{ms}$, $t_3=9\\,\\mathrm{ms}$, and $t_4=15\\,\\mathrm{ms}$. We need to compute the state $z(T)$ at the observation time $T=20\\,\\mathrm{ms}$. The time constant $\\tau$ is also measured in $\\mathrm{ms}$, making the arguments of the exponentials dimensionless.\n\nUsing the formula derived in Part 1 with $t=T=20$:\n$$z(20) = \\sum_{i=1}^{4} \\exp\\left(-\\frac{20-t_i}{\\tau}\\right)H(20-t_i)$$\nWe evaluate each term in the sum:\nFor $i=1$: $t_1=2$. The argument of the Heaviside function is $20-2=18  0$, so $H(18)=1$. The term is $\\exp\\left(-\\frac{18}{\\tau}\\right)$.\nFor $i=2$: $t_2=7$. The argument of the Heaviside function is $20-7=13  0$, so $H(13)=1$. The term is $\\exp\\left(-\\frac{13}{\\tau}\\right)$.\nFor $i=3$: $t_3=9$. The argument of the Heaviside function is $20-9=11  0$, so $H(11)=1$. The term is $\\exp\\left(-\\frac{11}{\\tau}\\right)$.\nFor $i=4$: $t_4=15$. The argument of the Heaviside function is $20-15=5  0$, so $H(5)=1$. The term is $\\exp\\left(-\\frac{5}{\\tau}\\right)$.\n\nSumming these contributions gives the final expression for $z(20)$:\n$$z(20) = \\exp\\left(-\\frac{18}{\\tau}\\right) + \\exp\\left(-\\frac{13}{\\tau}\\right) + \\exp\\left(-\\frac{11}{\\tau}\\right) + \\exp\\left(-\\frac{5}{\\tau}\\right)$$\n\nPart 3: Derivation of effective memory measures\n\nFirst, we derive the relative weight $w(L;\\tau)$. This is defined as the ratio of the contribution to $z(t)$ from a spike at time $t_{past} = t-L$ to that of an infinitesimally recent spike at time $t$. Let the recent spike occur at $t_{recent} = t-\\delta$, where $\\delta \\to 0^{+}$.\n\nThe contribution of the past spike at $t-L$ is found by applying the result from Part 1 for a single spike ($N=1$):\n$$C_{past} = \\exp\\left(-\\frac{t-(t-L)}{\\tau}\\right)H(t-(t-L)) = \\exp\\left(-\\frac{L}{\\tau}\\right)H(L)$$\nSince $L$ represents a duration in the past, $L0$, so $H(L)=1$. Thus, $C_{past} = \\exp(-L/\\tau)$.\n\nThe contribution of the infinitesimally recent spike at $t-\\delta$ is:\n$$C_{recent} = \\exp\\left(-\\frac{t-(t-\\delta)}{\\tau}\\right)H(t-(t-\\delta)) = \\exp\\left(-\\frac{\\delta}{\\tau}\\right)H(\\delta)$$\nAs $\\delta \\to 0^{+}$ (representing an infinitesimally small delay), $H(\\delta)=1$ and $\\exp(-\\delta/\\tau) \\to \\exp(0) = 1$. So, $C_{recent} = 1$.\n\nThe relative weight $w(L;\\tau)$ is the ratio:\n$$w(L;\\tau) = \\frac{C_{past}}{C_{recent}} = \\frac{\\exp(-L/\\tau)}{1} = \\exp\\left(-\\frac{L}{\\tau}\\right)$$\n\nNext, we derive the effective memory horizon $L_{\\epsilon}(\\tau)$. This is the time $L$ such that any spike older than $L$ is attenuated to a fraction $\\epsilon$ or less of a recent spike. This means we are looking for the value $L_{\\epsilon}$ that satisfies the condition $w(L; \\tau) \\le \\epsilon$ for all $L  L_{\\epsilon}$. Since $w(L;\\tau)$ is a monotonically decreasing function of $L$ (for $L0, \\tau0$), this condition is satisfied by finding the boundary value $L_{\\epsilon}$ where the equality holds:\n$$w(L_{\\epsilon};\\tau) = \\epsilon$$\n$$\\exp\\left(-\\frac{L_{\\epsilon}}{\\tau}\\right) = \\epsilon$$\nTo solve for $L_{\\epsilon}$, we take the natural logarithm of both sides:\n$$-\\frac{L_{\\epsilon}}{\\tau} = \\ln(\\epsilon)$$\n$$L_{\\epsilon}(\\tau) = -\\tau\\ln(\\epsilon)$$\nSince the problem states $0  \\epsilon  1$, we have $\\ln(\\epsilon)  0$, which ensures that $L_{\\epsilon}(\\tau)$ is a positive quantity. This can also be written as $L_{\\epsilon}(\\tau) = \\tau\\ln(1/\\epsilon)$. This result quantifies how the time constant $\\tau$ scales the memory of the system; a larger $\\tau$ leads to a longer memory horizon for a fixed attenuation factor $\\epsilon$.\n\nThe final answer requested is the expression for $z(T)$ from Part 2.",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{18}{\\tau}\\right) + \\exp\\left(-\\frac{13}{\\tau}\\right) + \\exp\\left(-\\frac{11}{\\tau}\\right) + \\exp\\left(-\\frac{5}{\\tau}\\right)}\n$$"
        },
        {
            "introduction": "Bridging the gap between theory and application, this final practice addresses a crucial step in any practical implementation of an Echo State Network: the washout period. Although a stable design ensures that the influence of initial conditions will eventually fade, it does not happen instantaneously. This exercise demonstrates how to formally derive a required \"washout\" length $T_w$ to guarantee that the initial state's influence has decayed below a desired tolerance, ensuring that the states used for training the readout are a pure reflection of the input dynamics, thus honoring the Echo State Property in practice .",
            "id": "4050150",
            "problem": "Consider a discrete-time reservoir used in Echo State Networks (ESN) and Liquid State Machines (LSM), modeled as a leaky integrator with the update rule\n$$x_{t+1} = (1 - a)\\,x_{t} + a\\,\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right),$$\nwhere $x_{t} \\in \\mathbb{R}^{n}$ is the reservoir state at time $t$, $u_{t} \\in \\mathbb{R}^{m}$ is the input at time $t$, $W \\in \\mathbb{R}^{n \\times n}$ is the recurrent weight matrix, $W_{\\mathrm{in}} \\in \\mathbb{R}^{n \\times m}$ is the input weight matrix, $a \\in (0,1]$ is the leak rate, and $\\phi$ is an elementwise nonlinearity. Assume $\\phi$ is the hyperbolic tangent, so that $\\phi = \\tanh$, and the Euclidean norm $\\|\\cdot\\|_{2}$ is used throughout.\n\nWashout is defined as discarding the first $T_{w}$ steps of reservoir states before fitting the readout, in order to remove dependence on the initial condition. Using the contraction of the driven reservoir dynamics, derive an explicit bound on the washout length $T_{w}$ that guarantees the residual influence of the initial state on $x_{t}$ is no more than a tolerance $\\varepsilon$ after $T_{w}$ steps.\n\nAssume the following design parameters are known:\n- leak rate $a = \\frac{1}{2}$,\n- operator norm $\\|W\\|_{2} = 0.6$,\n- Lipschitz constant of $\\phi$ satisfies $\\|\\phi'\\|_{\\infty} \\leq 1$ (true for $\\tanh$),\n- worst-case initial condition difference is bounded by $\\|x_{0} - x_{0}'\\|_{2} \\leq D$ with $D = 2$,\n- desired tolerance is $\\varepsilon = 10^{-2}$.\n\nThen, evaluate the following validation errors as a function of washout length $T_{w}$:\n- at $T_{w} = 0$, $E_{\\mathrm{val}} = 0.142$;\n- at $T_{w} = 5$, $E_{\\mathrm{val}} = 0.125$;\n- at $T_{w} = 10$, $E_{\\mathrm{val}} = 0.118$;\n- at $T_{w} = 15$, $E_{\\mathrm{val}} = 0.113$;\n- at $T_{w} = 20$, $E_{\\mathrm{val}} = 0.111$;\n- at $T_{w} = 24$, $E_{\\mathrm{val}} = 0.110$;\n- at $T_{w} = 25$, $E_{\\mathrm{val}} = 0.110$;\n- at $T_{w} = 30$, $E_{\\mathrm{val}} = 0.112$.\n\nUsing a principled selection criterion that requires the chosen $T_{w}$ to (i) satisfy the derived contraction-based bound and (ii) achieve the minimal observed validation error among the tested $T_{w}$ values (break ties by preferring the smaller $T_{w}$), determine the washout length $T_{w}$. Report the chosen washout length $T_{w}$ as a single integer number of steps.",
            "solution": "The goal is to find a lower bound for the washout length $T_{w}$ such that the dependence of the reservoir state on initial conditions is reduced below the tolerance $\\varepsilon$. The derivation will use standard tools: the Echo State Property (ESP), Lipschitz continuity of the nonlinearity, and contraction of driven recursions under suitable norm bounds.\n\nWe start from the update\n$$x_{t+1} = (1 - a)\\,x_{t} + a\\,\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right),$$\nand consider two trajectories $x_{t}$ and $x_{t}'$ driven by the same input sequence $\\{u_{t}\\}$ but started from different initial states $x_{0}$ and $x_{0}'$. Let $\\Delta_{t} = x_{t} - x_{t}'$. Then\n\\begin{align*}\n\\Delta_{t+1} = (1 - a)\\,(x_{t} - x_{t}') + a\\left[\\phi\\!\\left(W\\,x_{t} + W_{\\mathrm{in}}\\,u_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + W_{\\mathrm{in}}\\,u_{t}\\right)\\right] \\\\\n= (1 - a)\\,\\Delta_{t} + a\\left[\\phi\\!\\left(W\\,x_{t} + b_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + b_{t}\\right)\\right],\n\\end{align*}\nwhere $b_{t} = W_{\\mathrm{in}}\\,u_{t}$ is the input drive at time $t$. By the mean value theorem and Lipschitz continuity of $\\phi$ with constant $\\gamma = \\|\\phi'\\|_{\\infty} \\leq 1$, we have\n$$\\|\\phi(v) - \\phi(w)\\|_{2} \\leq \\gamma\\,\\|v - w\\|_{2} \\quad \\text{for all } v, w.$$\nTaking $v = W\\,x_{t} + b_{t}$ and $w = W\\,x_{t}' + b_{t}$, the input term cancels, and we obtain\n$$\\|\\phi\\!\\left(W\\,x_{t} + b_{t}\\right) - \\phi\\!\\left(W\\,x_{t}' + b_{t}\\right)\\|_{2} \\leq \\gamma\\,\\|W\\,(x_{t} - x_{t}')\\|_{2} \\leq \\gamma\\,\\|W\\|_{2}\\,\\|\\Delta_{t}\\|_{2}.$$\nThus,\n\\begin{align*}\n\\|\\Delta_{t+1}\\|_{2} \n\\leq (1 - a)\\,\\|\\Delta_{t}\\|_{2} + a\\,\\gamma\\,\\|W\\|_{2}\\,\\|\\Delta_{t}\\|_{2} \\\\\n= \\left[(1 - a) + a\\,\\gamma\\,\\|W\\|_{2}\\right]\\,\\|\\Delta_{t}\\|_{2}.\n\\end{align*}\nDefine the one-step contraction factor\n$$\\alpha \\coloneqq (1 - a) + a\\,\\gamma\\,\\|W\\|_{2}.$$\nUnder the design constraint $\\alpha  1$, the driven reservoir is contractive in the state difference when driven by the same input sequence. Iterating the inequality yields\n$$\\|\\Delta_{t}\\|_{2} \\leq \\alpha^{t}\\,\\|\\Delta_{0}\\|_{2}.$$\nIf the worst-case initial difference satisfies $\\|\\Delta_{0}\\|_{2} \\leq D$, then\n$$\\|\\Delta_{t}\\|_{2} \\leq \\alpha^{t}\\,D.$$\nTo ensure the residual dependence on initial conditions is no larger than $\\varepsilon$ after $T_{w}$ steps, we require\n$$\\alpha^{T_{w}}\\,D \\leq \\varepsilon.$$\nSolving for $T_{w}$,\n\\begin{align*}\n\\alpha^{T_{w}} \\leq \\frac{\\varepsilon}{D}\n\\quad\\Longrightarrow\\quad\nT_{w}\\,\\ln(\\alpha) \\leq \\ln\\!\\left(\\frac{\\varepsilon}{D}\\right) \\\\\n\\quad\\Longrightarrow\\quad\nT_{w} \\geq \\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)}.\n\\end{align*}\nSince $\\alpha \\in (0,1)$, we have $\\ln(\\alpha)  0$, and the right-hand side is positive when $\\varepsilon  D$. The smallest integer satisfying the inequality is\n$$T_{w}^{\\star} = \\left\\lceil \\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)} \\right\\rceil.$$\n\nNow plug in the given parameters:\n- $a = \\frac{1}{2}$,\n- $\\gamma = 1$ (for $\\tanh$),\n- $\\|W\\|_{2} = 0.6$,\n- $D = 2$,\n- $\\varepsilon = 10^{-2}$.\n\nCompute the contraction factor $\\alpha$:\n\\begin{align*}\n\\alpha = (1 - a) + a\\,\\gamma\\,\\|W\\|_{2} \\\\\n= \\left(1 - \\frac{1}{2}\\right) + \\frac{1}{2}\\cdot 1 \\cdot 0.6 \\\\\n= 0.5 + 0.3 \\\\\n= 0.8.\n\\end{align*}\nCompute the logarithmic ratio:\n\\begin{align*}\n\\frac{\\varepsilon}{D} = \\frac{10^{-2}}{2} = 5 \\times 10^{-3}, \\\\\n\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right) = \\ln(5 \\times 10^{-3}) = \\ln(5) + \\ln(10^{-3}) \\\\\n= \\ln(5) - 3\\,\\ln(10) \\\\\n\\approx 1.609437912 - 3 \\times 2.302585093 \\\\\n\\approx 1.609437912 - 6.907755279 \\\\\n\\approx -5.298317367, \\\\\n\\ln(\\alpha) = \\ln(0.8) \\approx -0.223143551.\n\\end{align*}\nThus\n\\begin{align*}\n\\frac{\\ln\\!\\left(\\frac{\\varepsilon}{D}\\right)}{\\ln(\\alpha)} \n\\approx \\frac{-5.298317367}{-0.223143551} \\\\\n\\approx 23.74999999,\n\\end{align*}\nso the minimal integer is\n$$T_{w}^{\\star} = \\lceil 23.75 \\rceil = 24.$$\n\nNext, evaluate the validation errors provided for different $T_{w}$:\n- $E_{\\mathrm{val}}(0) = 0.142$,\n- $E_{\\mathrm{val}}(5) = 0.125$,\n- $E_{\\mathrm{val}}(10) = 0.118$,\n- $E_{\\mathrm{val}}(15) = 0.113$,\n- $E_{\\mathrm{val}}(20) = 0.111$,\n- $E_{\\mathrm{val}}(24) = 0.110$,\n- $E_{\\mathrm{val}}(25) = 0.110$,\n- $E_{\\mathrm{val}}(30) = 0.112$.\n\nThe minimal observed validation error among the tested washout lengths is $0.110$ at both $T_{w} = 24$ and $T_{w} = 25$. By the principled selection criterion, we require $T_{w} \\geq T_{w}^{\\star} = 24$ and prefer the smaller $T_{w}$ among those achieving the minimal error. Therefore, the selected washout length is\n$$T_{w} = 24.$$",
            "answer": "$$\\boxed{24}$$"
        }
    ]
}