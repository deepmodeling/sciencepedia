{
    "hands_on_practices": [
        {
            "introduction": "HTM空间池化器的首要任务是评估每个微柱与当前输入模式的匹配程度。本练习将带你深入这一基本过程，你将学习如何从第一性原理出发，计算一个微柱的“重叠分数”，并理解“增强”这一关键的稳态调节机制是如何确保所有微柱都能在长期内得到公平利用的。这个计算是HTM形成稀疏表征的第一步。",
            "id": "4047287",
            "problem": "考虑一个遵循分层时间记忆 (HTM) 原理的系统，其中每个微型柱都具有连接到二进制输入空间的近端突触，该输入空间被建模为稀疏分布式表示 (SDR)。对于一个索引为 $i$ 的给定列，设二进制输入为 $x \\in \\{0,1\\}^{N}$，其分量为 $x_{j}$，并设从输入位 $j$ 到列 $i$ 的近端突触的永久性为 $p_{ij} \\in [0,1]$。如果一个突触的永久性达到或超过一个固定的阈值 $p_{\\text{th}}$，则认为该突触是连接的。一列的重叠度在操作上定义为接收到活动输入的已连接突触的数量，并且在应用局部抑制（竞争）之前，使用一个正的乘法增强因子 $b_{i}$ 来缩放重叠度。\n\n从这些核心定义出发，不假设任何预先推导的公式，执行以下操作：\n\n1. 推导列 $i$ 的未增强重叠度的符号表达式，该表达式仅依赖于二进制输入 $x_{j}$ 以及用 $p_{ij}$ 和 $p_{\\text{th}}$ 表示的连接性准则。然后，使用第一性原理，论证乘法增强因子在竞争中如何影响重叠度。\n\n2. 对于一个具体配置，其中 $N=12$，输入 $x$ 指定为当 $j \\in \\{1,3,4,7,9,12\\}$ 时 $x_{j} = 1$，否则 $x_{j} = 0$。永久性阈值为 $p_{\\text{th}} = 0.25$。有三列，索引为 $i \\in \\{1,2,3\\}$，其永久性值如下：\n- 对于列 $i=1$：$p_{1,1} = 0.30$, $p_{1,3} = 0.20$, $p_{1,4} = 0.28$, $p_{1,8} = 0.10$, $p_{1,9} = 0.40$, $p_{1,12} = 0.24$，对于所有其他 $j$，$p_{1,j} = 0$。\n- 对于列 $i=2$：$p_{2,1} = 0.27$, $p_{2,3} = 0.26$, $p_{2,7} = 0.29$, $p_{2,9} = 0.18$, $p_{2,10} = 0.50$, $p_{2,12} = 0.31$，对于所有其他 $j$，$p_{2,j} = 0$。\n- 对于列 $i=3$：$p_{3,2} = 0.90$, $p_{3,4} = 0.26$, $p_{3,5} = 0.22$, $p_{3,7} = 0.23$, $p_{3,9} = 0.27$, $p_{3,11} = 0.30$, $p_{3,12} = 0.26$，对于所有其他 $j$，$p_{3,j} = 0$。\n\n设增强因子为 $b_{1} = 1.2$，$b_{2} = 0.9$ 和 $b_{3} = 1.5$。考虑一个由这三列组成的局部抑制邻域，该邻域通过增强重叠度选择前 $k=1$ 的列。计算该邻域中单个获胜列的增强重叠度。将最终答案表示为一个实数。无需四舍五入。",
            "solution": "用户希望我解决一个关于分层时间记忆的问题。我将首先验证该问题，然后进行求解。\n\n### 步骤 1：提取给定条件\n- **系统模型**：分层时间记忆 (HTM)。\n- **输入**：二进制向量 $x \\in \\{0,1\\}^{N}$，其分量为 $x_{j}$。\n- **突触**：从输入位 $j$ 到列 $i$ 的近端突触具有永久性 $p_{ij} \\in [0,1]$。\n- **连接规则**：如果一个突触的永久性 $p_{ij}$ 大于或等于阈值 $p_{\\text{th}}$，则该突触是连接的。\n- **未增强重叠度**：接收到活动输入（$x_j=1$）的已连接突触的数量。\n- **增强**：一个正的乘法因子 $b_{i}$ 用于缩放列 $i$ 的重叠度。\n- **竞争**：局部抑制根据增强重叠度选择获胜列。\n\n- **第 1 部分任务**：\n  - 推导列 $i$ 的未增强重叠度的符号表达式。\n  - 论证乘法增强因子在竞争中的作用。\n\n- **第 2 部分具体配置**：\n  - 输入空间维度：$N=12$。\n  - 输入向量 $x$：当 $j \\in \\{1,3,4,7,9,12\\}$ 时，$x_{j} = 1$，否则 $x_{j} = 0$。\n  - 永久性阈值：$p_{\\text{th}} = 0.25$。\n  - 列数：$3$，索引为 $i \\in \\{1,2,3\\}$。\n  - 列 $i=1$ 的永久性值：$p_{1,1} = 0.30$, $p_{1,3} = 0.20$, $p_{1,4} = 0.28$, $p_{1,8} = 0.10$, $p_{1,9} = 0.40$, $p_{1,12} = 0.24$。所有其他 $p_{1,j}=0$。\n  - 列 $i=2$ 的永久性值：$p_{2,1} = 0.27$, $p_{2,3} = 0.26$, $p_{2,7} = 0.29$, $p_{2,9} = 0.18$, $p_{2,10} = 0.50$, $p_{2,12} = 0.31$。所有其他 $p_{2,j}=0$。\n  - 列 $i=3$ 的永久性值：$p_{3,2} = 0.90$, $p_{3,4} = 0.26$, $p_{3,5} = 0.22$, $p_{3,7} = 0.23$, $p_{3,9} = 0.27$, $p_{3,11} = 0.30$, $p_{3,12} = 0.26$。所有其他 $p_{3,j}=0$。\n  - 增强因子：$b_{1} = 1.2$, $b_{2} = 0.9$, $b_{3} = 1.5$。\n  - 局部抑制：从集合 $\\{1,2,3\\}$ 中选择前 $k=1$ 的列。\n  - **第 2 部分任务**：计算单个获胜列的增强重叠度。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题科学地基于分层时间记忆的原理，这是计算神经科学中一个公认的模型。术语（SDR、永久性、重叠度、增强、抑制）在该领域是标准的。问题陈述清晰，提供了所有必要的数据和约束，可以得出一个唯一的、可验证的数值答案。它是客观的，没有歧义。基于这些原因，该问题是有效的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供详细的解决方案。\n\n### 第 1 部分：符号推导与论证\n\n列 $i$ 的未增强重叠度，记为 $O_i$，定义为接收到活动输入的已连接突触的数量。让我们将其形式化。\n\n从输入位 $j$ 到列 $i$ 的突触是连接的，如果其永久性 $p_{ij}$ 达到或超过阈值 $p_{\\text{th}}$。我们可以用一个函数来表示这个条件，例如赫维赛德阶跃函数 (Heaviside step function) $H(z)$，其中当 $z \\ge 0$ 时 $H(z)=1$，当 $z  0$ 时 $H(z)=0$。设 $C_{ij}$ 为连接的指示变量：\n$$C_{ij} = H(p_{ij} - p_{\\text{th}})$$\n如果突触是连接的，$C_{ij}$ 为 $1$，否则为 $0$。\n\n输入位 $x_j$ 要么是 $1$（激活）要么是 $0$（非激活）。一个突触 $(i,j)$ 只有在它既是连接的（$C_{ij}=1$）又接收到活动输入（$x_j=1$）时，才对重叠度计数有贡献。单个突触的贡献是乘积 $C_{ij} \\cdot x_j$。由于两项都是二进制的，当且仅当两个条件都满足时，该乘积为 $1$，否则为 $0$。\n\n总的未增强重叠度 $O_i$ 是这些贡献在所有 $N$ 个输入位上的总和：\n$$O_i = \\sum_{j=1}^{N} C_{ij} \\cdot x_j = \\sum_{j=1}^{N} H(p_{ij} - p_{\\text{th}}) x_j$$\n这是未增强重叠度的符号表达式。\n\n将乘法增强因子 $b_i$ 应用于此未增强重叠度，以确定该列在竞争过程中的最终得分。增强重叠度 $O'_{i}$ 由下式给出：\n$$O'_{i} = b_{i} \\cdot O_{i}$$\n局部抑制机制然后根据这些增强得分选择一个或多个列变为活动状态。在“k-胜者全得”方案中，局部邻域中具有最高增强重叠度的 $k$ 个列变为活动状态。\n\n该机制的理由是稳态调节。它确保一个区域中的所有列随时间推移都被利用。如果一个列的激活频率很低（即它最近没有赢得竞争），它的增强因子 $b_i$ 就会增加。这给了该列一个竞争优势，使其在未来更有可能获胜，即使其原始模式匹配（未增强重叠度 $O_i$）不是最高的。相反，一个赢得过于频繁的列，其增强因子会降低，使其不太可能获胜。这可以防止一小部分列主导所有模式的表示，并确保整个列群体的表示能力得到利用，这对于稳健和分布式的学习至关重要。\n\n### 第 2 部分：数值计算\n\n我们已知活动输入位为 $j \\in \\{1,3,4,7,9,12\\}$，永久性阈值为 $p_{\\text{th}} = 0.25$，以及三列的永久性和增强因子。我们将为每列计算未增强重叠度 $O_i$，然后计算增强重叠度 $O'_i$。获胜者是具有最高增强重叠度的列。\n\n**为列 1 ($i=1$) 计算：**\n未增强重叠度 $O_1$ 是活动输入对应的已连接突触的数量。我们只需要检查索引为 $j \\in \\{1,3,4,7,9,12\\}$ 的永久性。\n- $j=1$: $p_{1,1} = 0.30 \\ge 0.25$。已连接。\n- $j=3$: $p_{1,3} = 0.20  0.25$。未连接。\n- $j=4$: $p_{1,4} = 0.28 \\ge 0.25$。已连接。\n- $j=7$: $p_{1,7}=0  0.25$。未连接。\n- $j=9$: $p_{1,9} = 0.40 \\ge 0.25$。已连接。\n- $j=12$: $p_{1,12} = 0.24  0.25$。未连接。\n\n活动输入对应的已连接突触数量为 $3$。\n所以，未增强重叠度为 $O_1 = 3$。\n增强因子为 $b_1 = 1.2$。\n增强重叠度为 $O'_1 = b_1 \\cdot O_1 = 1.2 \\times 3 = 3.6$。\n\n**为列 2 ($i=2$) 计算：**\n我们检查索引为 $j \\in \\{1,3,4,7,9,12\\}$ 的永久性。\n- $j=1$: $p_{2,1} = 0.27 \\ge 0.25$。已连接。\n- $j=3$: $p_{2,3} = 0.26 \\ge 0.25$。已连接。\n- $j=4$: $p_{2,4}=0  0.25$。未连接。\n- $j=7$: $p_{2,7} = 0.29 \\ge 0.25$。已连接。\n- $j=9$: $p_{2,9} = 0.18  0.25$。未连接。\n- $j=12$: $p_{2,12} = 0.31 \\ge 0.25$。已连接。\n\n活动输入对应的已连接突触数量为 $4$。\n所以，未增强重叠度为 $O_2 = 4$。\n增强因子为 $b_2 = 0.9$。\n增强重叠度为 $O'_2 = b_2 \\cdot O_2 = 0.9 \\times 4 = 3.6$。\n\n**为列 3 ($i=3$) 计算：**\n我们检查索引为 $j \\in \\{1,3,4,7,9,12\\}$ 的永久性。\n- $j=1$: $p_{3,1}=0  0.25$。未连接。\n- $j=3$: $p_{3,3}=0  0.25$。未连接。\n- $j=4$: $p_{3,4} = 0.26 \\ge 0.25$。已连接。\n- $j=7$: $p_{3,7} = 0.23  0.25$。未连接。\n- $j=9$: $p_{3,9} = 0.27 \\ge 0.25$。已连接。\n- $j=12$: $p_{3,12} = 0.26 \\ge 0.25$。已连接。\n\n活动输入对应的已连接突触数量为 $3$。\n所以，未增强重叠度为 $O_3 = 3$。\n增强因子为 $b_3 = 1.5$。\n增强重叠度为 $O'_3 = b_3 \\cdot O_3 = 1.5 \\times 3 = 4.5$。\n\n**确定获胜者：**\n我们比较增强重叠度：\n- $O'_1 = 3.6$\n- $O'_2 = 3.6$\n- $O'_3 = 4.5$\n\n最大的增强重叠度是 $4.5$，属于列 $3$。因此，列 $3$ 是获胜列。题目要求计算这个获胜列的增强重叠度。\n\n获胜列的增强重叠度是 $4.5$。",
            "answer": "$$\\boxed{4.5}$$"
        },
        {
            "introduction": "在计算出各个微柱的重叠分数之后，空间池化器通过局部抑制机制来强制实现稀疏性，这是HTM的一个核心特征。本练习要求你实现一个基于网格的局部抑制算法，在重叠的邻域内应用“k-winners-take-all”规则，从而亲身体验系统如何从密集的潜在匹配中筛选出稀疏的活动微柱集合。通过这个练习，你还能观察到边界效应对选择过程的实际影响。",
            "id": "4047281",
            "problem": "考虑一个二维列网格，该网格用于层次时间记忆（HTM）的空间池化器中。每个位于位置 $(i,j)$ 的列都有一个标量重叠度 $o_{i,j} \\in \\mathbb{R}_{\\ge 0}$。局部抑制是根据切比雪夫度量，在由固定半径 $r$ 决定的邻域上定义的。具体来说，对于一个 $N \\times M$ 网格中的给定列 $(i,j)$，其邻域为 $\\mathcal{N}_r(i,j) = \\{(p,q) \\mid \\max(|p - i|, |q - j|) \\le r,\\ 0 \\le p  N,\\ 0 \\le q  M\\}$。期望局部稀疏度由 $\\rho \\in (0,1)$ 指定，邻域中的获胜者数量为 $k(i,j) = \\max(1, \\lceil \\rho \\cdot |\\mathcal{N}_r(i,j)| \\rceil)$。\n\n当邻域内的列按重叠度降序排列，且平局按行主索引 $I(p,q) = p \\cdot M + q$ 升序打破时，如果列 $(i,j)$ 属于其邻域 $\\mathcal{N}_r(i,j)$ 内排名前 $k(i,j)$ 的列，则该列为局部获胜者。定义边界列为满足 $i \\in \\{0, N-1\\}$ 或 $j \\in \\{0, M-1\\}$ 的列，其余为内部列。\n\n给定 $r = 2$ 和 $\\rho = 0.02$，请实现局部抑制规则，并为下面的每个测试用例计算获胜者总数、边界获胜者数量和内部获胜者数量。展示边界效应（即边界附近较小的邻域和指定的平局打破规则）如何影响选择。\n\n使用以下重叠度配置的测试套件：\n\n- 测试用例 A：一个 $6 \\times 6$ 网格，其重叠度为\n$$\n\\begin{bmatrix}\n10  3  2  1  1  1 \\\\\n3  2  2  2  1  1 \\\\\n2  2  4  2  2  1 \\\\\n1  2  2  9  2  2 \\\\\n1  1  2  2  4  2 \\\\\n1  1  1  2  2  8\n\\end{bmatrix}\n$$\n其中每个条目是 $o_{i,j}$，索引 $i$ 和 $j$ 从 0 开始。\n\n- 测试用例 B：一个 $3 \\times 3$ 网格，其重叠度为\n$$\n\\begin{bmatrix}\n1  2  1 \\\\\n2  5  2 \\\\\n1  2  1\n\\end{bmatrix}\n$$\n\n- 测试用例 C：一个 $5 \\times 5$ 网格，其重叠度均匀\n$$\n\\begin{bmatrix}\n1  1  1  1  1 \\\\\n1  1  1  1  1 \\\\\n1  1  1  1  1 \\\\\n1  1  1  1  1 \\\\\n1  1  1  1  1\n\\end{bmatrix}\n$$\n\n您的程序必须为每个测试用例计算元组 $[T,B,I]$，其中 $T$ 是获胜者总数，$B$ 是边界获胜者数量，$I$ 是内部获胜者数量。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素是对应测试用例A、B、C顺序的列表 $[T,B,I]$。例如，要求的输出格式为 $[[T_A,B_A,I_A],[T_B,B_B,I_B],[T_C,B_C,I_C]]$。不涉及物理单位或角度单位；所有输出均为整数。",
            "solution": "该问题要求实现并分析局部抑制算法，这是层次时间记忆（HTM）中空间池化器的一个关键组成部分。我们给定了一个二维列网格、每列的重叠度值、一个邻域定义、一个期望稀疏度以及一个平局打破规则。目标是识别哪些列成为“获胜者”，并根据它们的位置（边界 vs. 内部）对三个特定测试用例中的获胜者进行量化。\n\n首先，我们对给出的定义进行形式化。一个列位于 $N \\times M$ 网格中的位置 $(i,j)$，其中 $0 \\le i  N$ 且 $0 \\le j  M$。每个列都有一个非负实值重叠度 $o_{i,j}$。列 $(i,j)$ 的邻域 $\\mathcal{N}_r(i,j)$ 由半径为 $r$ 的切比雪夫距离定义：\n$$\n\\mathcal{N}_r(i,j) = \\{(p,q) \\mid \\max(|p - i|, |q - j|) \\le r,\\ 0 \\le p  N,\\ 0 \\le q  M\\}\n$$\n这定义了一个以 $(i,j)$ 为中心、边长最大为 $2r+1$ 的正方形区域，并被裁剪到网格边界内。\n\n在此邻域内选出的获胜者数量 $k(i,j)$ 由局部稀疏度 $\\rho$ 决定：\n$$\nk(i,j) = \\max(1, \\lceil \\rho \\cdot |\\mathcal{N}_r(i,j)| \\rceil)\n$$\n其中 $|\\mathcal{N}_r(i,j)|$ 是邻域中的列数。\n问题指定 $r=2$ 和 $\\rho=0.02$。最大的可能邻域出现在远离边界的内部列，其大小为 $(2r+1)^2 = (2 \\cdot 2 + 1)^2 = 25$。对于这个最大尺寸， $k = \\max(1, \\lceil 0.02 \\cdot 25 \\rceil) = \\max(1, \\lceil 0.5 \\rceil) = \\max(1, 1) = 1$。对于任何更小的邻域（即对于边界列或角列），其大小 $|\\mathcal{N}_r(i,j)|$ 将小于 25，因此乘积 $\\rho \\cdot |\\mathcal{N}_r(i,j)|$ 将小于 0.5。其向上取整仍为 1。因此，对于给定的参数 $r=2$ 和 $\\rho=0.02$，对于任何列 $(i,j)$，$k(i,j)$ 始终等于 1。\n\n一个列 $(i,j)$ 被宣布为获胜者，如果它在其自身的邻域 $\\mathcal{N}_r(i,j)$ 中排名前 $k(i,j)$。既然我们已经确定对于所有 $(i,j)$，$k(i,j) = 1$，这简化了条件：一个列 $(i,j)$ 是获胜者，当且仅当它是其邻域 $\\mathcal{N}_r(i,j)$ 中唯一排名最高的列。\n\n排名由一个两级排序确定：\n1.  主键：重叠度值 $o_{p,q}$，降序排列。\n2.  次键（用于重叠度平局）：行主索引 $I(p,q) = p \\cdot M + q$，升序排列。\n\n这意味着一个列 $(i,j)$ 是获胜者，当且仅当对于其邻域 $\\mathcal{N}_r(i,j)$ 中的所有其他列 $(p,q)$（其中 $(p,q) \\ne (i,j)$），以下条件之一为真：\n-   $o_{i,j} > o_{p,q}$\n-   $o_{i,j} = o_{p,q}$ 且 $I(i,j)  I(p,q)$\n\n最后，对获胜者进行分类。如果 $i \\in \\{0, N-1\\}$ 或 $j \\in \\{0, M-1\\}$，则列 $(i,j)$ 是边界列。否则，它是内部列。我们需要为每个测试用例计算获胜者总数（$T$）、边界获胜者数量（$B$）和内部获胜者数量（$I$）。\n\n**测试用例 A：$6 \\times 6$ 网格, $r=2$**\n重叠度矩阵如下：\n$$\nO = \\begin{bmatrix}\n10  3  2  1  1  1 \\\\\n3  2  2  2  1  1 \\\\\n2  2  4  2  2  1 \\\\\n1  2  2  9  2  2 \\\\\n1  1  2  2  4  2 \\\\\n1  1  1  2  2  8\n\\end{bmatrix}\n$$\n我们检查每一列，看它是否是其自身邻域内的获胜者。\n-   列 $(0,0)$，$o_{0,0}=10$：其邻域 $\\mathcal{N}_2(0,0)$ 是 $3 \\times 3$ 的左上角子网格。该区域中的最大重叠度是 $(0,0)$ 本身的 10。没有平局。因此，$(0,0)$ 是一个获胜者。它是一个边界列（$i=0$）。\n-   列 $(3,3)$，$o_{3,3}=9$：其邻域 $\\mathcal{N}_2(3,3)$ 是左上角位于 $(1,1)$ 的 $5 \\times 5$ 子网格。该区域中的最大重叠度是 $(3,3)$ 本身的 9。没有平局。因此，$(3,3)$ 是一个获胜者。它是一个内部列（对于一个 $6 \\times 6$ 网格，$i,j \\in \\{1,2,3,4\\}$）。\n-   列 $(5,5)$，$o_{5,5}=8$：其邻域 $\\mathcal{N}_2(5,5)$ 是 $3 \\times 3$ 的右下角子网格。在此邻域内，列 $(3,3)$ 的重叠度为 $o_{3,3}=9$。由于 $8  9$，$(5,5)$ 不是最大值，因此不是获胜者。\n-   任何其他列 $(i,j)$ 的重叠度值都低于其邻域中存在的某个值。例如，$(2,2)$（重叠度 4）的邻域包含 $(0,0)$（重叠度 10），而 $(4,4)$（重叠度 4）的邻域包含 $(3,3)$（重叠度 9）。\n因此，只有两列获胜。\n获胜者总数 $T=2$。\n边界获胜者数量 $B=1$（来自列 $(0,0)$）。\n内部获胜者数量 $I=1$（来自列 $(3,3)$）。\n结果：$[2, 1, 1]$。\n\n**测试用例 B：$3 \\times 3$ 网格, $r=2$**\n重叠度矩阵为：\n$$\nO = \\begin{bmatrix}\n1  2  1 \\\\\n2  5  2 \\\\\n1  2  1\n\\end{bmatrix}\n$$\n当 $N=3, M=3$ 和 $r=2$ 时，任何列 $(i,j)$ 的邻域都是整个 $3 \\times 3$ 网格，因为对于所有 $i,j,p,q \\in \\{0,1,2\\}$，$\\max(|p-i|,|q-j|) \\le 2$ 都成立。因此，每一列都与同一组全局竞争者进行评估。网格中的最大重叠度是 $o_{1,1}=5$。\n-   列 $(1,1)$，$o_{1,1}=5$：这是唯一的最大重叠度。它是其邻域（整个网格）中的获胜者。\n-   任何其他列 $(i,j)$ 都有 $o_{i,j}  5$，所以它不可能是获胜者。\n只有一个获胜者，即 $(1,1)$。在 $3 \\times 3$ 网格中，边界列的索引在 $\\{0,2\\}$ 中。因此，列 $(1,1)$ 是一个内部列。\n获胜者总数 $T=1$。\n边界获胜者数量 $B=0$。\n内部获胜者数量 $I=1$。\n结果：$[1, 0, 1]$。\n\n**测试用例 C：$5 \\times 5$ 网格, $r=2$, 均匀重叠度**\n重叠度矩阵是一个 $5 \\times 5$ 网格，其中对于所有 $(i,j)$，$o_{i,j}=1$。\n由于所有重叠度都相同，平局打破规则是获胜者选择的唯一决定因素。如果列 $(i,j)$ 在其自身的邻域 $\\mathcal{N}_2(i,j)$ 内具有最小的行主索引 $I(p,q) = p \\cdot M + q$，则该列获胜。\n为了让 $(i,j)$ 获胜，它必须满足对于所有 $(p,q) \\in \\mathcal{N}_2(i,j)$，$I(i,j) \\le I(p,q)$。这等效于要求 $(i,j)$ 是其邻域中字典序最小的坐标对。任何矩形区域中行主索引最小的单元格始终是其左上角。\n邻域 $\\mathcal{N}_r(i,j)$ 的左上角由 $(p_{min}, q_{min}) = (\\max(0, i-r), \\max(0, j-r))$ 给出。\n因此，一个列 $(i,j)$ 是获胜者，当且仅当它是其自身邻域的左上角：\n$(i,j) = (\\max(0, i-r), \\max(0, j-r))$。\n这可以分解为两个条件：\n1.  $i = \\max(0, i-r) \\implies i-r \\le 0 \\implies i \\le r$。\n2.  $j = \\max(0, j-r) \\implies j-r \\le 0 \\implies j \\le r$。\n给定 $r=2$，获胜的列是所有满足 $0 \\le i \\le 2$ 和 $0 \\le j \\le 2$ 的 $(i,j)$。这在 $5 \\times 5$ 网格的左上角形成了一个 $3 \\times 3$ 的获胜者区块。\n获胜者数量为 $T = 3 \\times 3 = 9$。\n我们现在对这 9 个获胜者进行分类。网格大小为 $N=5, M=5$。边界列的 $i \\in \\{0,4\\}$ 或 $j \\in \\{0,4\\}$。\n-   $i=0$ 的获胜者：$(0,0), (0,1), (0,2)$（3 列）。\n-   $j=0$ （且 $i \\ne 0$）的获胜者：$(1,0), (2,0)$（2 列）。\n-   没有 $i=4$ 或 $j=4$ 的获胜者。\n边界获胜者总数 $B = 3 + 2 = 5$。\n剩下的获胜者是内部获胜者：$I = T - B = 9 - 5 = 4$。它们是 $(1,1), (1,2), (2,1), (2,2)$。\n结果：$[9, 5, 4]$。",
            "answer": "[[2,1,1],[1,0,1],[9,5,4]]"
        },
        {
            "introduction": "当空间池化器选定一组活动微柱后，时间记忆器便开始发挥其学习序列和进行预测的作用。本练习将引导你进入时间记忆器的核心逻辑，你需要根据细胞的预测状态来精确确定哪些细胞将被激活。你将处理两种情况：当输入符合预期时，激活预测细胞；当输入出乎意料时，通过“bursting”（簇生）机制来学习新的序列转换。",
            "id": "4047239",
            "problem": "分层时间记忆（HTM）时间记忆的单个区域由 $N$ 个柱组成，每个柱包含 $M$ 个细胞。在每个离散的时间步 $t$，由于前馈输入，一部分柱会变为激活状态。时间记忆为每个细胞维护一组远端树突段，每个树突段包含到其他细胞的潜在突触。如果一个潜在突触的持久性至少达到一个固定的连接阈值 $p_c$，则认为该突触是连接的。如果一个细胞上的某个树突段，其连接的突触中，突触前细胞在时间 $t-1$ 处于激活状态的数量至少达到一个固定的激活阈值 $\\theta$，则该树突段在时间 $t$ 被认为是激活的。如果一个细胞的任何树突段在时间 $t$ 是激活的，则该细胞在时间 $t$ 处于预测状态。\n\n当时间 $t$ 的前馈输入激活一组柱时，时间 $t$ 的下一个激活细胞集按以下方式确定：\n- 对于每个激活的柱，如果该柱中有一个或多个细胞在时间 $t$ 处于预测状态，则该柱中恰好是那些被预测的细胞变为激活状态。\n- 否则（该激活的柱中没有预测细胞），该柱处于突发状态，这里通过选择单个获胜细胞来解决。突发柱中的获胜细胞被认为是其最佳远端树突段与前一个激活细胞集实现最大匹配分数的细胞，其中一个树突段的匹配分数是其连接的突触中，突触前细胞在时间 $t-1$ 处于激活状态的数量。如果匹配分数出现平局，则通过选择在那些匹配的连接突触中具有最大持久性总和的细胞来打破平局；如果仍然平局，则选择柱内细胞索引最小的细胞。在该柱中，只有那个获胜细胞变为激活状态。\n\n考虑一个HTM模块，有 $N = 6$ 个柱，索引为 $j \\in \\{0,1,2,3,4,5\\}$，每个柱有 $M = 4$ 个细胞，索引为 $i \\in \\{0,1,2,3\\}$。一个细胞用有序对 $(j,i)$ 表示。连接阈值为 $p_c = 0.20$，激活阈值为 $\\theta = 2$。在前一个时间步处于激活状态的细胞集合是\n$$S_{t-1} = \\{(0,2),(2,1),(2,3),(4,2),(5,1),(5,3)\\}.$$\n在当前时间 $t$，考虑新的前馈输入之前，预测细胞集合由下式给出\n$$P = \\{(0,1),(0,3),(2,0),(4,2),(5,2)\\}.$$\n时间 $t$ 的前馈输入激活了以下柱\n$$A = \\{0,1,3,5\\}.$$\n\n为了在突发柱中选择获胜细胞，仅为柱1和柱3中的细胞指定了远端树突段结构和突触持久性（所有其他树突段细节可以忽略）。这些细胞中的每一个都有一个单一的远端树突段，具有以下潜在突触和持久性：\n- 柱 $1$：\n  - 细胞 $(1,0)$：到 $(0,2)$ 的潜在突触持久性为 $0.18$，到 $(2,1)$ 的持久性为 $0.25$，到 $(3,2)$ 的持久性为 $0.30$。\n  - 细胞 $(1,1)$：到 $(4,2)$ 的潜在突触持久性为 $0.19$，到 $(5,1)$ 的持久性为 $0.35$。\n  - 细胞 $(1,2)$：到 $(2,3)$ 的潜在突触持久性为 $0.15$，到 $(5,3)$ 的持久性为 $0.21$。\n  - 细胞 $(1,3)$：到 $(0,2)$ 的潜在突触持久性为 $0.22$。\n- 柱 $3$：\n  - 细胞 $(3,0)$：到 $(2,1)$ 的潜在突触持久性为 $0.19$，到 $(4,2)$ 的持久性为 $0.21$。\n  - 细胞 $(3,1)$：到 $(5,3)$ 的潜在突触持久性为 $0.20$。\n  - 细胞 $(3,2)$：到 $(0,2)$ 的潜在突触持久性为 $0.19$。\n  - 细胞 $(3,3)$：到 $(2,3)$ 的潜在突触持久性为 $0.22$，到 $(5,1)$ 的持久性为 $0.18$。\n\n仅使用上述定义和提供的数据，确定在应用所述的HTM时间记忆选择规则后，在时间 $t$ 将处于激活状态的细胞总数。请以整数形式给出答案（无单位）。",
            "solution": "该问题要求计算在一个指定的分层时间记忆（HTM）区域中，在时间步 $t$ 将处于激活状态的细胞总数。解决方案需要应用一系列规则来确定给定激活柱集合内的激活细胞。\n\n首先，我们确定给定的数据：\n- 柱的数量 $N = 6$，索引为 $j \\in \\{0,1,2,3,4,5\\}$。\n- 每个柱的细胞数量 $M = 4$，索引为 $i \\in \\{0,1,2,3\\}$。\n- 连接阈值 $p_c = 0.20$。\n- 激活阈值 $\\theta = 2$。\n- 在前一个时间步 $t-1$ 激活的细胞集合：\n$$S_{t-1} = \\{(0,2),(2,1),(2,3),(4,2),(5,1),(5,3)\\}$$\n- 在当前时间步 $t$ 处于预测状态的细胞集合：\n$$P = \\{(0,1),(0,3),(2,0),(4,2),(5,2)\\}$$\n- 在时间 $t$ 被前馈输入激活的柱集合：\n$$A = \\{0,1,3,5\\}$$\n- 提供了柱 $j=1$ 和 $j=3$ 中细胞的远端树突段突触持久性。\n\n确定在时间 $t$ 激活的细胞集合（表示为 $S_t$）的过程是检查激活集合 $A$ 中的每个柱 $j$。对于每个这样的柱，我们确定其哪些细胞（如果有的话）将变为激活状态。\n\n规则如下：\n1.  如果一个激活的柱 $j \\in A$ 有一个或多个细胞在预测集 $P$ 中，那么这些被预测的细胞就变为激活状态。\n2.  如果一个激活的柱 $j \\in A$ 在预测集 $P$ 中没有细胞，则该柱处于“突发”状态。选择一个“获胜细胞”变为激活状态。获胜者是具有最高“匹配分数”的细胞。\n    - 如果一个突触的持久性大于或等于 $p_c$，则该突触是“连接的”。\n    - 一个树突段的“匹配分数”是其连接的突触中，突触前细胞在 $S_{t-1}$ 中的数量。\n    - 最高匹配分数的平局打破规则：首先，按匹配的连接突触的最大持久性总和；其次，按最小的细胞索引 $i$。\n\n我们现在将这些规则应用于激活集 $A = \\{0,1,3,5\\}$ 中的每个柱。\n\n**柱 $j = 0$：**\n该柱在激活集 $A$ 中。我们通过将柱 $0$ 中的细胞集合（即 $\\{(0,i) \\mid i \\in \\{0,1,2,3\\}\\}$）与预测集 $P$ 求交集来检查该柱中的预测细胞。\n在 $P$ 中属于柱 $0$ 的细胞是 $(0,1)$ 和 $(0,3)$。\n由于该柱中有预测细胞，规则1适用。预测的细胞 $(0,1)$ 和 $(0,3)$ 变为激活状态。\n来自柱 $0$ 的激活细胞数量：$2$。\n\n**柱 $j = 1$：**\n该柱在激活集 $A$ 中。我们检查该柱中的预测细胞。预测集 $P$ 中没有形如 $(1,i)$ 的细胞。\n因此，柱 $1$ 处于突发状态，规则2适用。我们必须通过计算柱 $1$ 中每个细胞的匹配分数来找到获胜细胞。如果一个突触的持久性 $p \\ge p_c = 0.20$，则它是连接的。匹配分数是其连接的突触中，突触前细胞在 $S_{t-1}$ 中的数量。\n- **细胞 (1,0):** 到 $(0,2)$ ($p=0.18$)、$(2,1)$ ($p=0.25$)、$(3,2)$ ($p=0.30$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(2,1)$ 和 $(3,2)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(2,1) \\in S_{t-1}$，但 $(3,2) \\notin S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.25$。\n- **细胞 (1,1):** 到 $(4,2)$ ($p=0.19$)、$(5,1)$ ($p=0.35$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(5,1)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(5,1) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.35$。\n- **细胞 (1,2):** 到 $(2,3)$ ($p=0.15$)、$(5,3)$ ($p=0.21$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(5,3)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(5,3) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.21$。\n- **细胞 (1,3):** 到 $(0,2)$ ($p=0.22$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(0,2)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(0,2) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.22$。\n\n所有四个细胞的匹配分数都为 $1$。我们使用第一个平局打破规则：选择具有最大匹配突触持久性总和的细胞。\n- (1,0): 总和 = $0.25$\n- (1,1): 总和 = $0.35$\n- (1,2): 总和 = $0.21$\n- (1,3): 总和 = $0.22$\n最大总和为 $0.35$，对应于细胞 $(1,1)$。因此，细胞 $(1,1)$ 是获胜者。\n来自柱 $1$ 的激活细胞数量：$1$。\n\n**柱 $j = 3$：**\n该柱在激活集 $A$ 中。我们检查预测细胞。预测集 $P$ 中没有形如 $(3,i)$ 的细胞。\n因此，柱 $3$ 处于突发状态，规则2适用。我们计算柱 $3$ 中每个细胞的匹配分数。\n- **细胞 (3,0):** 到 $(2,1)$ ($p=0.19$)、$(4,2)$ ($p=0.21$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(4,2)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(4,2) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.21$。\n- **细胞 (3,1):** 到 $(5,3)$ ($p=0.20$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(5,3)$，因为 $0.20 \\ge p_c$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(5,3) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.20$。\n- **细胞 (3,2):** 到 $(0,2)$ ($p=0.19$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：无。\n  - 匹配分数 = $0$。\n- **细胞 (3,3):** 到 $(2,3)$ ($p=0.22$)、$(5,1)$ ($p=0.18$) 的潜在突触。\n  - 连接的突触 ($p \\ge 0.20$)：到 $(2,3)$。\n  - 突触前细胞在 $S_{t-1}$ 中：$(2,3) \\in S_{t-1}$。\n  - 匹配分数 = $1$。\n  - 匹配的连接突触的持久性总和 = $0.22$。\n\n细胞 $(3,0)$、$(3,1)$ 和 $(3,3)$ 的最高匹配分数为 $1$。我们使用第一个平局打破规则：\n- (3,0): 总和 = $0.21$\n- (3,1): 总和 = $0.20$\n- (3,3): 总和 = $0.22$\n最大总和为 $0.22$，对应于细胞 $(3,3)$。因此，细胞 $(3,3)$ 是获胜者。\n来自柱 $3$ 的激活细胞数量：$1$。\n\n**柱 $j = 5$：**\n该柱在激活集 $A$ 中。我们检查预测细胞。细胞 $(5,2)$ 在预测集 $P$ 中。\n由于该柱中有预测细胞，规则1适用。预测的细胞 $(5,2)$ 变为激活状态。\n来自柱 $5$ 的激活细胞数量：$1$。\n\n**激活细胞总数：**\n为了找到在时间 $t$ 激活的细胞总数，我们将 $A$ 中每个柱的激活细胞数相加：\n- 来自柱 $0$：$2$ 个细胞 ($(0,1)$ 和 $(0,3)$)\n- 来自柱 $1$：$1$ 个细胞 ($(1,1)$)\n- 来自柱 $3$：$1$ 个细胞 ($(3,3)$)\n- 来自柱 $5$：$1$ 个细胞 ($(5,2)$)\n\n总激活细胞数 = $2 + 1 + 1 + 1 = 5$。\n在时间 $t$ 激活的细胞集合是 $S_t = \\{(0,1), (0,3), (1,1), (3,3), (5,2)\\}$。该集合的大小为 $5$。\n给定了激活阈值 $\\theta=2$，但在计算中并未使用，因为预测细胞集 $P$ 是直接提供的。该信息是HTM一般性描述的一部分，但对于这个特定的计算不是必需的。",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}