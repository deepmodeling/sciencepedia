{
    "hands_on_practices": [
        {
            "introduction": "在探索树突中复杂的非线性计算之前，我们必须首先理解其作为电信号被动导体的基本行为。这项基础练习 () 运用经典的电缆理论，将树突段建模为一个简单的电阻性电缆。通过推导稳态电压分布，你将亲手掌握长度常数（$\\lambda$）和特征阻抗（$Z_0$）等基本概念，它们是控制信号衰减的关键，也是分析任何形式的神经整合所不可或缺的。",
            "id": "4042593",
            "problem": "考虑一个无源树突段，其模型为一个占据 $x \\ge 0$ 区域的一维半无限长电缆，具有恒定的单位长度轴向电阻 $r_i$ 和单位长度膜电阻 $r_m$，二者均为正且有限。该电缆的周向为等势，轴向电流仅沿 $x$ 轴流动。假设在稳态下，膜表现为线性漏电，没有主动电导，并且电缆属性在空间上是均匀的。\n\n在边界 $x=0$ 处，一个恒定的直流电流 $I_0$ 被注入到电缆内部。电缆延伸至无穷远，因此当 $x \\to \\infty$ 时电压保持有界。轴向电流通过欧姆定律与轴向电压梯度相关联，并且电流守恒定律在电缆上局部适用。定义电缆长度常数和特征阻抗为\n$$\\lambda = \\sqrt{\\frac{r_m}{r_i}}, \\qquad Z_0 = \\sqrt{r_m r_i}.$$\n\n仅使用这些定义以及支配电阻电路和电流守恒的基本定律，推导 $x \\ge 0$ 时的稳态电压分布 $V(x)$，并仅用 $I_0$、$\\lambda$ 和 $Z_0$ 表示您的最终答案。您的答案必须是关于 $V(x)$ 的单一闭式解析表达式。无需四舍五入，最终表达式中不应包含单位。",
            "solution": "我们首先建立控制电缆上稳态电压 $V(x)$ 的微分方程。考虑在位置 $x$ 处长度为 $dx$ 的电缆微元段。\n\n设 $V(x)$ 是相对于电缆外部接地电位的细胞内电压。设 $I_{ax}(x)$ 是电缆内部沿 $x$ 正方向流动的轴向电流。\n\n根据欧姆定律，通过该微元段轴向电阻（即 $r_i dx$）的电压降 $dV$ 由下式给出：\n$$dV = -I_{ax}(x) (r_i dx)$$\n用微分形式，这表示了轴向电流和电压梯度之间的关系：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\frac{dV}{dx} \\quad (1)$$\n\n接下来，我们将电流守恒原理应用于该微元段。在长度 $dx$ 上的轴向电流变化量 $dI_{ax} = I_{ax}(x+dx) - I_{ax}(x)$，必须等于从该段膜泄漏出去的电流。膜电流记为 $I_m$。\n流出该段膜的电流由欧姆定律给出，其中膜两端的电压为 $V(x)$，膜段的电阻为 $r_m/dx$。因此流出的电流为 $I_m = \\frac{V(x)}{r_m/dx} = \\frac{V(x)}{r_m} dx$。\n根据电流守恒，在 $x$ 处进入该段的电流必须等于在 $x+dx$ 处流出的电流与通过膜泄漏的电流之和：\n$$I_{ax}(x) = I_{ax}(x+dx) + \\frac{V(x)}{r_m}dx$$\n整理并取 $dx \\to 0$ 的极限，我们得到：\n$$-\\frac{I_{ax}(x+dx) - I_{ax}(x)}{dx} = \\frac{V(x)}{r_m}$$\n这得到了第二个微分关系：\n$$-\\frac{dI_{ax}}{dx} = \\frac{V(x)}{r_m} \\quad (2)$$\n\n为了得到关于 $V(x)$ 的单一方程，我们将方程 (1) 对 $x$ 求导：\n$$\\frac{dI_{ax}}{dx} = -\\frac{1}{r_i}\\frac{d^2V}{dx^2}$$\n将此代入方程 (2) 得到：\n$$- \\left(-\\frac{1}{r_i}\\frac{d^2V}{dx^2}\\right) = \\frac{V(x)}{r_m}$$\n$$\\frac{1}{r_i}\\frac{d^2V}{dx^2} = \\frac{V(x)}{r_m}$$\n整理该方程得到稳态电缆方程：\n$$\\frac{d^2V}{dx^2} - \\frac{r_i}{r_m}V(x) = 0$$\n使用所给的长度常数定义 $\\lambda = \\sqrt{r_m/r_i}$，我们有 $\\frac{1}{\\lambda^2} = \\frac{r_i}{r_m}$。方程变为：\n$$\\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V(x) = 0$$\n这是一个二阶线性齐次常微分方程。其特征方程为 $k^2 - \\frac{1}{\\lambda^2} = 0$，根为 $k = \\pm \\frac{1}{\\lambda}$。因此，通解为：\n$$V(x) = A \\exp\\left(\\frac{x}{\\lambda}\\right) + B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n第一个边界条件是当 $x \\to \\infty$ 时电压保持有界。项 $A \\exp\\left(\\frac{x}{\\lambda}\\right)$ 随着 $x \\to \\infty$ 无界增长（因为 $\\lambda > 0$）。为满足边界条件，其系数必须为零，即 $A=0$。解简化为：\n$$V(x) = B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n\n第二个边界条件是在 $x=0$ 处注入电流 $I_0$。该注入电流必须等于离开注入点的轴向电流，即 $I_{ax}(0) = I_0$。我们使用方程 (1) 将 $I_{ax}$ 与 $V(x)$ 联系起来：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\frac{dV}{dx}$$\n首先，我们计算简化解 $V(x)$ 的导数：\n$$\\frac{dV}{dx} = \\frac{d}{dx}\\left[B \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right] = -\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n将此代入 $I_{ax}(x)$ 的表达式中：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\left(-\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)\\right) = \\frac{B}{r_i \\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n现在我们应用 $x=0$ 处的边界条件：\n$$I_0 = I_{ax}(0) = \\frac{B}{r_i \\lambda}\\exp(0) = \\frac{B}{r_i \\lambda}$$\n现在我们可以解出常数 $B$：\n$$B = I_0 r_i \\lambda$$\n\n将 $B$ 的这个表达式代回 $V(x)$ 的解中：\n$$V(x) = (I_0 r_i \\lambda) \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n最后一步是仅使用给定的参数 $I_0$、$\\lambda$ 和 $Z_0$ 来表示这个结果。我们有定义 $\\lambda = \\sqrt{r_m/r_i}$ 和 $Z_0 = \\sqrt{r_m r_i}$。我们来考察 $r_i \\lambda$ 这一项：\n$$r_i \\lambda = r_i \\sqrt{\\frac{r_m}{r_i}} = \\sqrt{r_i^2 \\frac{r_m}{r_i}} = \\sqrt{r_i r_m}$$\n这与特征阻抗 $Z_0$ 的定义相同。因此，$r_i \\lambda = Z_0$。\n\n在我们的 $V(x)$ 表达式中用 $Z_0$ 替换 $r_i \\lambda$，得到最终答案：\n$$V(x) = I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n这个稳态电压分布 $V(x)$ 的表达式仅用指定的量 $I_0$、$Z_0$ 和 $\\lambda$ 来表示。",
            "answer": "$$\\boxed{I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)}$$"
        },
        {
            "introduction": "正如我们在被动电缆模型 () 中看到的，被动树突的泄露特性会导致信号衰减。然而，电压门控通道（尤其是NMDA受体）的存在赋予了它们丰富的非线性计算能力。此练习 () 将引导你分析一个树突微区的模型，揭示NMDA受体的镁离子解阻所形成的正反馈是如何导致系统出现双稳态的。通过推导这种“全或无”行为的产生条件，你将深入探索树突“开关”的生物物理基础，这是树突计算的核心元件之一。",
            "id": "4042571",
            "problem": "考虑一个接收谷氨酸能输入的单个等电位树突微区，该输入激活 N-甲基-D-天冬氨酸（NMDA）受体。局部膜电压 $V$ 遵循一个电流平衡方程，该方程包含一个被动漏电流和一个 NMDA 介导的电流，后者的电压依赖性源于镁离子阻断的解除。在相关的工作范围内，通过指数函数近似这种电压依赖性，得到以下一维动力学系统：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}},\n$$\n其中 $C$ 是膜电容，$g_{L}$ 是漏电导，$E_{L}$ 是漏电反转电位，$g_{N}$ 是最大 NMDA 电导，$s \\in (0,1]$ 是 NMDA 受体开放概率的谷氨酸门控因子，$\\lambda>0$ 参数化了因镁离子解除阻断而产生的电压依赖性，$E_{N}$ 是 NMDA 反转电位，$I_{\\mathrm{ext}}$ 是外部注入电流。\n\n从不动点及其线性稳定性的定义出发，并且不使用任何快捷公式，执行以下操作：\n\n1. 通过将方程右侧设为零来推导不动点条件，并用方程右侧对 $V$ 的导数来表示稳定性判据。证明双稳态的起始是通过鞍结分岔发生的，此时存在一个电压 $V^{\\star}$，使得不动点条件及其对 $V$ 的导数同时为零。引入 $x \\equiv E_{N} - V$ 和 $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$，并证明鞍结条件可以化简为一个关于 $x$ 的二次方程，其判别式要求 $B \\geq 4/\\lambda$ 作为双稳态存在的条件。\n\n2. 使用鞍结条件，推导出在尖点边界（两个鞍结点合并之处）的临界最大 NMDA 电导 $g_{N}^{\\star}$ 的一个闭式表达式，该表达式仅用生物物理参数 $g_{L}$，$s$，$\\lambda$ 和 $E_{N}$ 表示。\n\n3. 使用以下参数值计算 $g_{N}^{\\star}$ 的表达式：$g_{L} = 0.1\\,\\mu\\mathrm{S}$，$E_{L} = -65\\,\\mathrm{mV}$，$E_{N} = 0\\,\\mathrm{mV}$，$s = 0.3$，以及 $\\lambda = 0.062\\,\\mathrm{mV}^{-1}$。假设外部电流被精确地设置在使双稳态阈值最小化的尖点值上。将你最终的数值答案 $g_{N}^{\\star}$ 四舍五入到四位有效数字。以 $\\mu\\mathrm{S}$ 为单位表示最终的电导。",
            "solution": "该问题要求分析单个等电位树突微区模型的双稳态性，该模型由以下关于膜电压 $V$ 的常微分方程控制：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\n让我们将方程的右侧定义为函数 $f(V)$，它代表跨膜总电流：\n$$\nf(V) = -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\n因此，该动力学系统为 $\\frac{dV}{dt} = \\frac{1}{C}f(V)$。\n\n**1. 不动点、稳定性与鞍结分岔**\n\n系统的一个不动点（或稳态）是一个电压 $V_{fp}$，在该点净电流为零，意味着电压不随时间变化。这由条件 $\\frac{dV}{dt} = 0$ 给出，该条件等价于 $f(V_{fp}) = 0$。\n\n一个不动点 $V_{fp}$ 的线性稳定性由函数 $f(V)$ 在该点的导数 $f'(V_{fp})$ 的符号决定。如果 $f'(V_{fp}) < 0$，不动点是稳定的；如果 $f'(V_{fp}) > 0$，则是不稳定的。$f(V)$ 对 $V$ 的导数是：\n$$\nf'(V) = \\frac{df}{dV} = \\frac{d}{dV} \\left[ -g_{L}V + g_{L}E_{L} + g_{N}s\\exp(\\lambda V)(E_{N} - V) + I_{\\mathrm{ext}} \\right]\n$$\n对 NMDA 电流项使用乘积法则：\n$$\nf'(V) = -g_{L} + g_{N}s \\left[ \\left( \\lambda \\exp(\\lambda V) \\right) (E_{N} - V) + \\exp(\\lambda V) (-1) \\right]\n$$\n$$\nf'(V) = -g_{L} - g_{N}s\\exp(\\lambda V) \\left[ 1 - \\lambda(E_{N} - V) \\right]\n$$\n双稳态的起始通过鞍结分岔发生。在这样的分岔点，一个稳定不动点和一个不稳定不动点合并并消失。在数学上，这对应于 $f(V)$ 的曲线在某个电压 $V^{\\star}$ 处与电压轴相切。这个切点同时满足作为不动点的条件和稳定与不稳定之间转变的条件（$f'(V^{\\star}) = 0$）。因此，鞍结分岔的两个条件是：\n1. $f(V^{\\star}) = 0$\n2. $f'(V^{\\star}) = 0$\n\n我们现在引入指定的变量替换：$x \\equiv E_{N} - V$ 和 $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$。根据第一个定义，我们有 $V = E_{N} - x$。让我们用这些新变量重写这两个鞍结条件。\n\n第一个条件，$f(V^{\\star}) = 0$，是：\n$$\n-g_{L}(V^{\\star} - E_{L}) + g_{N}s\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) + I_{\\mathrm{ext}} = 0\n$$\n重新整理并除以 $g_{L}$ 得到：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) = (V^{\\star} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\n代入 $V^{\\star} = E_{N} - x$ 和 $E_{N} - V^{\\star} = x$：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda (E_{N} - x))x = (E_{N} - x - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = \\left[ (E_{N} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}} \\right] - x\n$$\n使用 $B$ 的定义，我们得到：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = B - x\n$$\n\n第二个条件，$f'(V^{\\star}) = 0$，是：\n$$\n-g_{L} - g_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\n$$\ng_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = -g_{L}\n$$\n代入 $V^{\\star} = E_{N} - x$ 和 $E_{N} - V^{\\star} = x$：\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x))[1 - \\lambda x] = -g_{L}\n$$\n假设 $1 - \\lambda x \\neq 0$，我们可以写成：\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x)) = -\\frac{g_{L}}{1 - \\lambda x}\n$$\n现在，将此表达式代入变换后的第一个条件中：\n$$\n\\left( -\\frac{g_{L}}{g_{L}(1 - \\lambda x)} \\right) x = B - x\n$$\n$$\n-\\frac{x}{1 - \\lambda x} = B - x\n$$\n乘以 $(1 - \\lambda x)$ 以消去分母：\n$$\n-x = (B - x)(1 - \\lambda x)\n$$\n$$\n-x = B - B\\lambda x - x + \\lambda x^2\n$$\n$$\n0 = B - B\\lambda x + \\lambda x^2\n$$\n重新整理后得到所需的关于 $x$ 的二次方程：\n$$\n\\lambda x^2 - B\\lambda x + B = 0\n$$\n为了使这个关于 $x$ 的二次方程有实数解（这些解对应于可能发生鞍结分岔的电压），其判别式 $\\Delta$ 必须为非负数。\n$$\n\\Delta = (-B\\lambda)^2 - 4(\\lambda)(B) = B^2\\lambda^2 - 4\\lambda B \\geq 0\n$$\n由于 $\\lambda > 0$，我们可以除以 $\\lambda$：\n$$\nB^2\\lambda - 4B \\geq 0 \\implies B(B\\lambda - 4) \\geq 0\n$$\n在促进双稳态的生理学背景下，参数 $B = (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$ 通常是正的（$E_{N} > E_{L}$ 且 $I_{\\mathrm{ext}}$ 不是强超极化电流）。假设 $B > 0$，该不等式成立当且仅当：\n$$\nB\\lambda - 4 \\geq 0 \\implies B \\geq \\frac{4}{\\lambda}\n$$\n这个不等式是关于外部驱动和突触驱动组合的条件，以使双稳态成为可能。\n\n**2. 尖点处的临界电导**\n\n尖点边界代表了双稳态所需的最小条件。它是两个不同的鞍结分岔点合并为一个的点。这发生在关于 $x$ 的二次方程的判别式恰好为零时，即 $\\Delta = 0$。\n$$\nB(B\\lambda - 4) = 0\n$$\n由于 $B=0$ 不是一个能导致双稳态且具有生物物理意义的解（它会导致 $x=0$，这意味着 $g_L=0$ 或其他简并情况），我们必须有：\n$$\nB\\lambda - 4 = 0 \\implies B = \\frac{4}{\\lambda}\n$$\n在这个尖点，关于 $x$ 的二次方程有一个由下式给出的单一重根：\n$$\nx^{\\star} = \\frac{-(-B\\lambda)}{2\\lambda} = \\frac{B\\lambda}{2\\lambda} = \\frac{B}{2}\n$$\n代入 $B = 4/\\lambda$，我们找到尖点处的 $x$ 值：\n$$\nx^{\\star} = \\frac{1}{2} \\left( \\frac{4}{\\lambda} \\right) = \\frac{2}{\\lambda}\n$$\n这个 $x$ 值对应于电压 $V^{\\star} = E_N - x^{\\star} = E_N - 2/\\lambda$。为了找到这个尖点处的临界 NMDA 电导 $g_{N}^{\\star}$，我们回到第二个鞍结条件：\n$$\n-g_{L} - g_{N}^{\\star}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\n解出 $g_{N}^{\\star}$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})]}\n$$\n代入 $V^{\\star} = E_N - x^{\\star}$ 和 $E_{N} - V^{\\star} = x^{\\star}$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda (E_N - x^{\\star}))[1 - \\lambda x^{\\star}]}\n$$\n现在，我们代入尖点值 $x^{\\star} = 2/\\lambda$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp\\left(\\lambda \\left(E_N - \\frac{2}{\\lambda}\\right)\\right)\\left[1 - \\lambda \\left(\\frac{2}{\\lambda}\\right)\\right]}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(1 - 2)}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(-1)}\n$$\n$$\ng_{N}^{\\star} = \\frac{g_{L}}{s\\exp(\\lambda E_N - 2)} = \\frac{g_{L}}{s}\\exp(2 - \\lambda E_N)\n$$\n这就是在尖点处临界电导 $g_{N}^{\\star}$ 的闭式表达式。\n\n**3. 数值计算**\n\n我们被给予以下参数值：\n$g_{L} = 0.1\\,\\mu\\mathrm{S}$\n$s = 0.3$\n$\\lambda = 0.062\\,\\mathrm{mV}^{-1}$\n$E_{N} = 0\\,\\mathrm{mV}$\n\n将这些值代入 $g_{N}^{\\star}$ 的表达式中：\n$$\ng_{N}^{\\star} = \\frac{0.1\\,\\mu\\mathrm{S}}{0.3}\\exp(2 - (0.062\\,\\mathrm{mV}^{-1})(0\\,\\mathrm{mV}))\n$$\n$$\ng_{N}^{\\star} = \\frac{0.1}{0.3}\\exp(2)\\,\\mu\\mathrm{S} = \\frac{1}{3}\\exp(2)\\,\\mu\\mathrm{S}\n$$\n现在我们计算数值：\n$$\n\\exp(2) \\approx 7.3890560989...\n$$\n$$\ng_{N}^{\\star} \\approx \\frac{1}{3} \\times 7.3890560989...\\,\\mu\\mathrm{S} \\approx 2.4630186996...\\,\\mu\\mathrm{S}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\ng_{N}^{\\star} \\approx 2.463\\,\\mu\\mathrm{S}\n$$",
            "answer": "$$\\boxed{2.463}$$"
        },
        {
            "introduction": "树突计算通常涉及对来自不同来源信号的精确时空整合，例如局部突触输入（EPSP）和来自胞体的全局信号（bAP）。这项计算练习 () 旨在模拟这些信号在一个具有真实空间非均匀特性的树突分支上的相互作用。通过编写一个数值求解程序，你将计算反向传播动作电位的衰减（这一概念建立在被动电缆理论  之上），并预测它与EPSP的同步到达是否足以触发一个局部的NMDA Spike（其机制已在  中探讨），这被认为是突触可塑性和特征检测的基础机制。",
            "id": "4042533",
            "problem": "一个圆柱状的树突分支支撑着一个从胞体反向传播至远端位点的动作电位（bAP）。考虑一个一维电缆模型，其空间坐标为 $x$（单位：米），沿着总长度为 $L$、直径为 $d$ 的树突。轴向电阻率为 $R_a$（单位：$\\Omega \\cdot \\mathrm{m}$），膜的漏电导密度为 $g_L$（单位：$\\mathrm{S}/\\mathrm{m}^2$）。分支上存在主动电导，并沿分支变化：钠电导密度 $g_{Na}(x)$ 朝着远端减小，而钾电导密度 $g_{K}(x)$ 朝着远端增加。假设电导（单位面积）的梯度参数化如下：\n- $g_{Na}(x) = g_{Na}^0 \\exp(-\\gamma x)$,\n- $g_{K}(x) = g_{K}^0 \\exp(\\kappa x)$,\n其中 $g_{Na}^0$ 和 $g_{K}^0$ 是近端（靠近胞体）的电导密度（单位：$\\mathrm{S}/\\mathrm{m}^2$），$\\gamma$ 和 $\\kappa$ 是空间尺度参数（单位：$\\mathrm{m}^{-1}$）。为了模拟 bAP 是一个主动但短暂的波形这一事实，使用固定比例 $p_{Na}$ 和 $p_{K}$ 来近似这些电导对线性化膜电导的有效小信号贡献，从而总膜电导密度为 $g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x)$。\n\n从电缆方程和均匀圆柱形电缆的单位面积膜电阻和长度常数的标准定义出发，推导并实现一种有原则的方法来计算 bAP 幅度从胞体到远端的衰减。仅使用以下基本原理：\n- 被动、线性化树突的电缆方程，以及均匀圆柱体的长度常数定义，\n- 单位面积膜电阻与电导密度之间的关系，\n- 沿电缆空间变化参数的慢变近似。\n\n将衰减因子 $\\mathcal{A}$ 定义为远端 bAP 幅度与胞体 bAP 幅度之比，假设幅度包络遵循由空间变化的长度常数决定的局部指数衰减。那么，给定胞体 bAP 幅度 $A_{bAP}$（单位：$\\mathrm{mV}$），远端 bAP 幅度为 $A_{bAP}^{dist} = \\mathcal{A}\\,A_{bAP}$。考虑在远端位点有一个幅度为 $A_{EPSP}$（单位：$\\mathrm{mV}$）的局部兴奋性突触后电位（EPSP）。设静息电位为 $V_{rest}$（单位：$\\mathrm{mV}$），启动局部 N-甲基-D-天冬氨酸（NMDA）峰电位的经验阈值为 $V_{th}$（单位：$\\mathrm{mV}$）。假设时间对齐（bAP-EPSP 配对），并定义一个二元预测规则来判断 NMDA 峰电位的启动：如果 $V_{rest} + A_{EPSP} + A_{bAP}^{dist} \\ge V_{th}$，则预测会产生局部 NMDA 峰电位。\n\n实现一个完整的程序，对下面的每个测试案例计算：\n- 衰减因子 $\\mathcal{A}$（浮点数），\n- 一个布尔值，指示在 bAP-EPSP 配对条件下是否预测会产生局部 NMDA 峰电位。\n\n物理单位必须明确处理。直径 $d$ 和长度 $L$ 以微米为单位提供，计算前必须转换为米。电导单位为 $\\mathrm{S}/\\mathrm{m}^2$，电阻率单位为 $\\Omega \\cdot \\mathrm{m}$，电压单位为 $\\mathrm{mV}$。此问题不涉及角度。每个测试案例的结果必须是一个包含两个元素的列表：一个浮点数和一个布尔值。\n\n使用以下测试套件，其中包括一个一般情况、一个边界情况和一些边缘情况：\n- 案例 1：$d = 1\\,\\mu\\mathrm{m}$，$L = 300\\,\\mu\\mathrm{m}$，$R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$，$g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$，$\\gamma = 5000\\,\\mathrm{m}^{-1}$，$\\kappa = 3000\\,\\mathrm{m}^{-1}$，$p_{Na} = 0.02$，$p_{K} = 0.2$，$A_{bAP} = 80\\,\\mathrm{mV}$，$A_{EPSP} = 7\\,\\mathrm{mV}$，$V_{rest} = -65\\,\\mathrm{mV}$，$V_{th} = -30\\,\\mathrm{mV}$。\n- 案例 2（边界长度）：$d = 1\\,\\mu\\mathrm{m}$，$L = 0\\,\\mu\\mathrm{m}$，$R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$，$g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$，$\\gamma = 5000\\,\\mathrm{m}^{-1}$，$\\kappa = 3000\\,\\mathrm{m}^{-1}$，$p_{Na} = 0.02$，$p_{K} = 0.2$，$A_{bAP} = 80\\,\\mathrm{mV}$，$A_{EPSP} = 7\\,\\mathrm{mV}$，$V_{rest} = -65\\,\\mathrm{mV}$，$V_{th} = -30\\,\\mathrm{mV}$。\n- 案例 3（细长、强 g_K 增长）：$d = 0.4\\,\\mu\\mathrm{m}$，$L = 400\\,\\mu\\mathrm{m}$，$R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$，$g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{Na}^0 = 250\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{K}^0 = 200\\,\\mathrm{S}/\\mathrm{m}^2$，$\\gamma = 4000\\,\\mathrm{m}^{-1}$，$\\kappa = 8000\\,\\mathrm{m}^{-1}$，$p_{Na} = 0.015$，$p_{K} = 0.25$，$A_{bAP} = 80\\,\\mathrm{mV}$，$A_{EPSP} = 10\\,\\mathrm{mV}$，$V_{rest} = -65\\,\\mathrm{mV}$，$V_{th} = -35\\,\\mathrm{mV}$。\n- 案例 4（较粗、较短、近端 g_Na 较高且衰减平缓）：$d = 2.0\\,\\mu\\mathrm{m}$，$L = 200\\,\\mu\\mathrm{m}$，$R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$，$g_L = 0.8\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{Na}^0 = 500\\,\\mathrm{S}/\\mathrm{m}^2$，$g_{K}^0 = 120\\,\\mathrm{S}/\\mathrm{m}^2$，$\\gamma = 500\\,\\mathrm{m}^{-1}$，$\\kappa = 2000\\,\\mathrm{m}^{-1}$，$p_{Na} = 0.05$，$p_{K} = 0.15$，$A_{bAP} = 85\\,\\mathrm{mV}$，$A_{EPSP} = 25\\,\\mathrm{mV}$，$V_{rest} = -63\\,\\mathrm{mV}$，$V_{th} = -35\\,\\mathrm{mV}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个元素对应一个测试案例，并且本身必须是一个包含两个元素的列表：浮点数衰减因子 $\\mathcal{A}$ 和布尔值 NMDA 峰电位预测。例如，输出格式必须类似于 $[\\,[\\mathcal{A}_1,\\mathrm{bool}_1],[\\mathcal{A}_2,\\mathrm{bool}_2],\\dots\\,]$，不含其他文本。",
            "solution": "该问题要求推导并实现一种方法，用于计算反向传播动作电位（bAP）沿非均匀树突电缆的衰减，并预测局部 NMDA 峰电位的启动。该解决方案按规定从第一性原理出发进行推导。\n\n### **1. 基础：被动电缆理论**\n\n被动、均匀圆柱形树突中的电压传播由稳态电缆方程描述：\n$$ \\lambda^2 \\frac{d^2V}{dx^2} - V = 0 $$\n其中 $V$ 是相对于静息电位的膜电位，$x$ 是沿电缆的空间坐标，$\\lambda$ 是长度常数。对于无限长电缆，描述电压从源点 $x=0$ 衰减的解为 $V(x) = V_0 \\exp(-x/\\lambda)$。\n\n长度常数 $\\lambda$ 定义为：\n$$ \\lambda = \\sqrt{\\frac{r_m}{r_i}} $$\n其中 $r_m$ 是单位长度的膜电阻（单位：$\\Omega \\cdot \\mathrm{m}$），$r_i$ 是单位长度的轴向电阻（单位：$\\Omega/\\mathrm{m}$）。这些参数与树突的固有属性相关：\n*   单位长度的轴向电阻 $r_i$：\n    $$ r_i = \\frac{R_a}{A_{cross}} = \\frac{R_a}{\\pi (d/2)^2} = \\frac{4 R_a}{\\pi d^2} $$\n    此处，$R_a$ 是轴向电阻率（单位：$\\Omega \\cdot \\mathrm{m}$），$d$ 是圆柱形树突的直径（单位：$\\mathrm{m}$）。\n*   单位长度的膜电阻 $r_m$：\n    $$ r_m = \\frac{R_m}{\\pi d} $$\n    此处，$R_m$ 是单位面积的膜电阻（单位：$\\Omega \\cdot \\mathrm{m}^2$）。$R_m$ 是膜电导密度 $g_m$（单位：$\\mathrm{S}/\\mathrm{m}^2$）的倒数：\n    $$ R_m = \\frac{1}{g_m} $$\n\n综合这些，均匀电缆的长度常数可以表示为：\n$$ \\lambda^2 = \\frac{r_m}{r_i} = \\frac{1/(\\pi d g_m)}{4 R_a/(\\pi d^2)} = \\frac{d}{4 R_a g_m} \\implies \\lambda = \\sqrt{\\frac{d}{4 R_a g_m}} $$\n\n### **2. 推广到非均匀电缆**\n\n问题指出，主动电导随位置 $x$ 变化，使得总有效膜电导密度 $g_m$ 成为 $x$ 的函数：\n$$ g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x) $$\n代入给定的 $g_{Na}(x)$ 和 $g_{K}(x)$ 的指数形式：\n$$ g_m(x) = g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x) $$\n其中 $g_L$、$p_{Na}$、$g_{Na}^0$、$\\gamma$、$p_{K}$、$g_{K}^0$ 和 $\\kappa$ 是给定参数。\n\n由于 $g_m$ 随 $x$ 变化，长度常数也成为一个空间变化函数 $\\lambda(x)$：\n$$ \\lambda(x) = \\sqrt{\\frac{d}{4 R_a g_m(x)}} $$\n\n### **3. 基于慢变近似的衰减因子**\n\n问题指示使用“慢变近似”，其中 bAP 幅度包络 $A(x)$ 被假定遵循由局部长度常数 $\\lambda(x)$ 控制的局部指数衰减。这可以表示为幅度的微分方程：\n$$ \\frac{dA(x)}{dx} = -\\frac{A(x)}{\\lambda(x)} $$\n这是一个一阶可分离常微分方程。我们可以通过积分求解在给定胞体（$x=0$）处的幅度 $A(0)$ 时，远端（$x=L$）的幅度 $A(L)$：\n$$ \\int_{A(0)}^{A(L)} \\frac{dA}{A} = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln(A(L)) - \\ln(A(0)) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln\\left(\\frac{A(L)}{A(0)}\\right) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n衰减因子 $\\mathcal{A}$ 定义为比率 $\\mathcal{A} = A(L)/A(0)$。对两边取指数，得到 $\\mathcal{A}$ 的表达式：\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\frac{dx}{\\lambda(x)}\\right) $$\n\n### **4. 用于计算的最终表达式**\n\n将 $\\lambda(x)$ 的表达式代入 $\\mathcal{A}$ 的公式中：\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\sqrt{\\frac{4 R_a g_m(x)}{d}} \\, dx\\right) $$\n常数项可以从积分中提出：\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_m(x)} \\, dx\\right) $$\n代入 $g_m(x)$ 的完整表达式：\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x)} \\, dx\\right) $$\n该积分没有通用的解析解，必须进行数值计算。提供的长度 $L$ 和直径 $d$ 的参数单位是微米（$\\mu\\mathrm{m}$），必须乘以 $10^{-6}$ 转换为米（$\\mathrm{m}$），以保持国际单位制（SI）的一致性。\n\n对于长度 $L=0$ 的边界情况，从 $0$ 到 $0$ 的积分为 $0$。因此，指数为 $0$，$\\mathcal{A} = \\exp(0) = 1$，表示没有衰减，符合预期。\n\n### **5. NMDA 峰电位预测规则**\n\n在远端位点（$x=L$）预测局部 NMDA 峰电位是基于一个简单的阈值规则。衰减后的 bAP 和局部 EPSP 同时到达所产生的峰值膜电位 $V_{peak}$ 是它们在静息电位之上的幅度的线性叠加：\n$$ A_{bAP}^{dist} = \\mathcal{A} \\cdot A_{bAP} $$\n$$ V_{peak} = V_{rest} + A_{EPSP} + A_{bAP}^{dist} $$\n如果这个峰值电位达到或超过阈值电压 $V_{th}$，则预测会产生 NMDA 峰电位：\n$$ V_{peak} \\ge V_{th} $$\n这为每个测试案例得出一个布尔值（True/False）结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the bAP attenuation factor and predicts NMDA spike initiation.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each tuple contains:\n    # (d, L, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n    #  A_bAP, A_EPSP, V_rest, V_th)\n    test_cases = [\n        # Case 1: General case\n        (1.0, 300.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 2: Boundary length\n        (1.0, 0.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 3: Thin, long, strong g_K growth\n        (0.4, 400.0, 1.5, 1.0, 250.0, 200.0, 4000.0, 8000.0, 0.015, 0.25,\n         80.0, 10.0, -65.0, -35.0),\n        # Case 4: Thicker, shorter, high proximal g_Na\n        (2.0, 200.0, 1.5, 0.8, 500.0, 120.0, 500.0, 2000.0, 0.05, 0.15,\n         85.0, 25.0, -63.0, -35.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_model(*case)\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    # Using str() on a list adds spaces, e.g., '[0.5, True]',\n    # which is then joined by commas.\n    # To match the required output format '[[...],[...]]' without spaces,\n    # we format it manually.\n    formatted_results = [f\"[{res[0]},{str(res[1])}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_model(d_um, L_um, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n                  A_bAP, A_EPSP, V_rest, V_th):\n    \"\"\"\n    Computes the attenuation factor and NMDA spike prediction for a single case.\n\n    Args:\n        d_um (float): Diameter in micrometers.\n        L_um (float): Length in micrometers.\n        R_a (float): Axial resistivity in Ohm*m.\n        g_L (float): Leak conductance density in S/m^2.\n        g_Na0 (float): Proximal Na+ conductance density in S/m^2.\n        g_K0 (float): Proximal K+ conductance density in S/m^2.\n        gamma (float): Spatial scale for Na+ conductance in 1/m.\n        kappa (float): Spatial scale for K+ conductance in 1/m.\n        p_Na (float): Effective fraction for Na+ conductance.\n        p_K (float): Effective fraction for K+ conductance.\n        A_bAP (float): Somatic bAP amplitude in mV.\n        A_EPSP (float): Distal EPSP amplitude in mV.\n        V_rest (float): Resting potential in mV.\n        V_th (float): NMDA spike threshold in mV.\n\n    Returns:\n        list: A list containing [attenuation_factor, spike_prediction_bool].\n    \"\"\"\n    # 1. Unit conversion from micrometers to meters.\n    d = d_um * 1e-6\n    L = L_um * 1e-6\n\n    # 2. Handle the boundary case L=0.\n    if L == 0:\n        attenuation_factor = 1.0\n    else:\n        # 3. Define the integrand for the attenuation calculation.\n        # The integrand is sqrt(g_m(x)).\n        def integrand(x):\n            g_m_x = g_L + p_Na * g_Na0 * np.exp(-gamma * x) + p_K * g_K0 * np.exp(kappa * x)\n            return np.sqrt(g_m_x)\n\n        # 4. Numerically integrate from x=0 to x=L.\n        integral_val, _ = integrate.quad(integrand, 0, L)\n\n        # 5. Calculate the attenuation factor.\n        prefactor = np.sqrt(4 * R_a / d)\n        exponent = -prefactor * integral_val\n        attenuation_factor = np.exp(exponent)\n\n    # 6. Predict NMDA spike initiation.\n    # Calculate distal bAP amplitude.\n    A_bAP_dist = attenuation_factor * A_bAP\n\n    # Calculate peak voltage at distal site.\n    V_peak = V_rest + A_EPSP + A_bAP_dist\n\n    # Apply the threshold rule.\n    spike_predicted = V_peak >= V_th\n    \n    # 7. Return the results as a two-element list.\n    return [attenuation_factor, spike_predicted]\n\n# This block is for direct execution and should be removed or commented out\n# in the final XML output to conform to the single `solve()` function structure.\n# if __name__ == '__main__':\n#    solve()\n```"
        }
    ]
}