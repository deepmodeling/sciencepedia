{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complexities of active dendritic integration, it is crucial to master the fundamentals of passive signal propagation. This foundational exercise guides you through the derivation of the steady-state voltage profile in a passive cable, a cornerstone of computational neuroscience . By applying Ohm's law and current conservation, you will see how the dendritic length constant, $\\lambda$, and characteristic impedance, $Z_0$, dictate the exponential decay of voltage, providing the essential baseline against which all active computations are measured.",
            "id": "4042593",
            "problem": "Consider a passive dendritic segment modeled as a one-dimensional, semi-infinite cable occupying $x \\ge 0$, with constant per-unit-length axial resistance $r_{ax}$ and per-unit-length membrane resistance $r_m$, both positive and finite. The cable is isopotential around its circumference, and axial current flows only along the $x$-axis. Assume the membrane behaves as a linear leak at steady state, with no active conductances, and that the cable properties are spatially homogeneous.\n\nA constant, direct current $I_0$ is injected at the boundary $x=0$ into the cable interior. The cable extends to infinity so that the voltage remains bounded as $x \\to \\infty$. The axial current is related to the axial voltage gradient by Ohm’s law, and conservation of current applies locally along the cable. Define the cable length constant and characteristic impedance by\n$$\\lambda = \\sqrt{\\frac{r_m}{r_{ax}}}, \\qquad Z_0 = \\sqrt{r_m r_{ax}}.$$\n\nUsing only these definitions and the fundamental laws governing resistive circuits and current conservation, derive the steady-state voltage profile $V(x)$ for $x \\ge 0$ and express your final answer solely in terms of $I_0$, $\\lambda$, and $Z_0$. Your answer must be a single, closed-form analytic expression for $V(x)$. No rounding is required, and you should not include units in your final expression.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- **Model**: A passive dendritic segment.\n- **Geometry**: A one-dimensional, semi-infinite cable occupying the domain $x \\ge 0$.\n- **Physical Properties**:\n    - Constant per-unit-length axial resistance: $r_{ax}$.\n    - Constant per-unit-length membrane resistance: $r_m$.\n    - Both $r_{ax}$ and $r_m$ are positive and finite.\n- **Assumptions**:\n    - The cable is isopotential around its circumference.\n    - Axial current flows only along the $x$-axis.\n    - The membrane behaves as a linear leak at steady state.\n    - No active conductances are present.\n    - Cable properties are spatially homogeneous.\n- **Boundary Conditions**:\n    - At $x=0$, a constant, direct current $I_0$ is injected.\n    - As $x \\to \\infty$, the voltage $V(x)$ remains bounded.\n- **Governing Laws**:\n    - Axial current is related to the axial voltage gradient by Ohm’s law.\n    - Conservation of current applies locally along the cable.\n- **Definitions**:\n    - Cable length constant: $\\lambda = \\sqrt{\\frac{r_m}{r_{ax}}}$.\n    - Characteristic impedance: $Z_0 = \\sqrt{r_m r_{ax}}$.\n- **Objective**: Derive the steady-state voltage profile $V(x)$ for $x \\ge 0$ and express it solely in terms of $I_0$, $\\lambda$, and $Z_0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the standard passive cable model, a foundational concept in computational neuroscience and biophysics derived from the principles of electricity (Ohm's law, Kirchhoff's laws). The model is scientifically sound.\n2.  **Well-Posed**: The problem provides a second-order linear ordinary differential equation (as will be derived) with two boundary conditions (a current injection condition at $x=0$ and a boundedness condition at $x \\to \\infty$). This is sufficient to specify a unique and stable solution.\n3.  **Objective**: The problem is stated using precise, unambiguous technical language.\n4.  **Flaw Checklist**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, physically plausible within its modeling assumptions, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\nWe begin by establishing the differential equation governing the steady-state voltage $V(x)$ along the cable. Consider an infinitesimal segment of the cable of length $dx$ at position $x$.\n\nLet $V(x)$ be the intracellular voltage at position $x$ relative to a ground potential outside the cable. Let $I_{ax}(x)$ be the axial current flowing in the positive $x$ direction inside the cable.\n\nAccording to Ohm's law, the voltage drop $dV$ across the axial resistance of the segment, which is $r_{ax} dx$, is given by:\n$$dV = -I_{ax}(x) (r_{ax} dx)$$\nIn differential form, this expresses the relationship between the axial current and the voltage gradient:\n$$I_{ax}(x) = -\\frac{1}{r_{ax}}\\frac{dV}{dx} \\quad (1)$$\n\nNext, we apply the principle of current conservation to the infinitesimal segment. The change in axial current over the length $dx$, which is $dI_{ax} = I_{ax}(x+dx) - I_{ax}(x)$, must be equal to the current that leaks out through the membrane of that segment. The membrane current is denoted by $I_m$.\nThe current leaving through the membrane of the segment is given by Ohm's law, where the voltage across the membrane is $V(x)$ and the resistance of the membrane segment is $r_m/dx$. The current leaving is thus $I_m = \\frac{V(x)}{r_m/dx} = \\frac{V(x)}{r_m} dx$.\nBy conservation of current, the current entering the segment at $x$ must equal the sum of the current leaving at $x+dx$ and the current leaking through the membrane:\n$$I_{ax}(x) = I_{ax}(x+dx) + \\frac{V(x)}{r_m}dx$$\nRearranging and taking the limit as $dx \\to 0$, we get:\n$$-\\frac{I_{ax}(x+dx) - I_{ax}(x)}{dx} = \\frac{V(x)}{r_m}$$\nThis yields the second differential relationship:\n$$-\\frac{dI_{ax}}{dx} = \\frac{V(x)}{r_m} \\quad (2)$$\n\nTo obtain a single equation for $V(x)$, we differentiate equation (1) with respect to $x$:\n$$\\frac{dI_{ax}}{dx} = -\\frac{1}{r_{ax}}\\frac{d^2V}{dx^2}$$\nSubstituting this into equation (2) gives:\n$$- \\left(-\\frac{1}{r_{ax}}\\frac{d^2V}{dx^2}\\right) = \\frac{V(x)}{r_m}$$\n$$\\frac{1}{r_{ax}}\\frac{d^2V}{dx^2} = \\frac{V(x)}{r_m}$$\nRearranging this equation gives the steady-state cable equation:\n$$\\frac{d^2V}{dx^2} - \\frac{r_{ax}}{r_m}V(x) = 0$$\nUsing the provided definition of the length constant, $\\lambda = \\sqrt{r_m/r_{ax}}$, we have $\\frac{1}{\\lambda^2} = \\frac{r_{ax}}{r_m}$. The equation becomes:\n$$\\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V(x) = 0$$\nThis is a second-order linear homogeneous ordinary differential equation. The characteristic equation is $k^2 - \\frac{1}{\\lambda^2} = 0$, which has roots $k = \\pm \\frac{1}{\\lambda}$. The general solution is therefore:\n$$V(x) = A \\exp\\left(\\frac{x}{\\lambda}\\right) + B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nThe first boundary condition is that the voltage remains bounded as $x \\to \\infty$. The term $A \\exp\\left(\\frac{x}{\\lambda}\\right)$ grows without bound as $x \\to \\infty$ (since $\\lambda > 0$). To satisfy the boundary condition, its coefficient must be zero, so $A=0$. The solution simplifies to:\n$$V(x) = B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n\nThe second boundary condition is that a current $I_0$ is injected at $x=0$. This injected current must equal the axial current moving away from the injection site, i.e., $I_{ax}(0) = I_0$. We use equation (1) to relate $I_{ax}$ to $V(x)$:\n$$I_{ax}(x) = -\\frac{1}{r_{ax}}\\frac{dV}{dx}$$\nFirst, we compute the derivative of our simplified solution for $V(x)$:\n$$\\frac{dV}{dx} = \\frac{d}{dx}\\left[B \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right] = -\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nSubstituting this into the expression for $I_{ax}(x)$:\n$$I_{ax}(x) = -\\frac{1}{r_{ax}}\\left(-\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)\\right) = \\frac{B}{r_{ax} \\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nNow we apply the boundary condition at $x=0$:\n$$I_0 = I_{ax}(0) = \\frac{B}{r_{ax} \\lambda}\\exp(0) = \\frac{B}{r_{ax} \\lambda}$$\nWe can now solve for the constant $B$:\n$$B = I_0 r_{ax} \\lambda$$\n\nSubstituting this expression for $B$ back into the solution for $V(x)$:\n$$V(x) = (I_0 r_{ax} \\lambda) \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nThe final step is to express this result using only the given parameters $I_0$, $\\lambda$, and $Z_0$. We have the definitions $\\lambda = \\sqrt{r_m/r_{ax}}$ and $Z_0 = \\sqrt{r_m r_{ax}}$. Let's examine the term $r_{ax} \\lambda$:\n$$r_{ax} \\lambda = r_{ax} \\sqrt{\\frac{r_m}{r_{ax}}} = \\sqrt{r_{ax}^2 \\frac{r_m}{r_{ax}}} = \\sqrt{r_{ax} r_m}$$\nThis is identical to the definition of the characteristic impedance, $Z_0$. Therefore, $r_{ax} \\lambda = Z_0$.\n\nSubstituting $Z_0$ for $r_{ax} \\lambda$ in our expression for $V(x)$ yields the final answer:\n$$V(x) = I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nThis expression for the steady-state voltage profile $V(x)$ is in terms of only the specified quantities $I_0$, $Z_0$, and $\\lambda$.",
            "answer": "$$\\boxed{I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)}$$"
        },
        {
            "introduction": "Dendrites are far more than passive cables; they are active computational devices capable of local, nonlinear operations. This practice explores one of the most significant of these operations: bistability mediated by N-Methyl-D-Aspartate (NMDA) receptors . Through a dynamical systems analysis, you will determine the precise conditions under which a dendritic microdomain can switch between a 'down' state and an 'up' state, effectively acting as a local memory element.",
            "id": "4042571",
            "problem": "Consider a single isopotential dendritic microdomain receiving glutamatergic input that activates N-Methyl-D-Aspartate (NMDA) receptors. The local membrane voltage $V$ obeys a current-balance equation with a passive leak and an NMDA-mediated current whose voltage dependence arises from magnesium block unbinding. Over the relevant operating range, approximate this voltage dependence by an exponential, yielding the following one-dimensional dynamical system:\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}},\n$$\nwhere $C$ is the membrane capacitance, $g_{L}$ is the leak conductance, $E_{L}$ is the leak reversal potential, $g_{N}$ is the maximal NMDA conductance, $s \\in (0,1]$ is the glutamate-gating factor for NMDA receptor open probability, $\\lambda > 0$ parameterizes the voltage dependence due to magnesium unblock, $E_{N}$ is the NMDA reversal potential, and $I_{\\mathrm{ext}}$ is an externally injected current.\n\nStarting from the definitions of fixed points and their linear stability, and without invoking any shortcut formulas, perform the following:\n\n1. Derive the fixed-point condition by setting the right-hand side to zero, and obtain the stability criterion in terms of the derivative of the right-hand side with respect to $V$. Show that the onset of bistability occurs via a saddle-node bifurcation when there exists a voltage $V^{\\star}$ such that both the fixed-point condition and its $V$-derivative vanish simultaneously. Introduce $x \\equiv E_{N} - V$ and $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$, and prove that the saddle-node condition reduces to a quadratic in $x$ whose discriminant enforces the inequality $B \\geq 4/\\lambda$ for bistability.\n\n2. Using the saddle-node conditions, derive a closed-form expression for the critical NMDA maximal conductance $g_{N}^{\\star}$ at the cusp boundary (where the two saddle-node points coalesce), expressed purely in terms of the biophysical parameters $g_{L}$, $s$, $\\lambda$, and $E_{N}$.\n\n3. Evaluate your expression for $g_{N}^{\\star}$ using the following parameter values: $g_{L} = 0.1\\,\\mu\\mathrm{S}$, $E_{L} = -65\\,\\mathrm{mV}$, $E_{N} = 0\\,\\mathrm{mV}$, $s = 0.3$, and $\\lambda = 0.062\\,\\mathrm{mV}^{-1}$. Assume the external current is set precisely at the cusp value that minimizes the threshold for bistability. Round your final numeric answer for $g_{N}^{\\star}$ to four significant figures. Express the final conductance in $\\mu\\mathrm{S}$.",
            "solution": "The problem asks for an analysis of the bistability of a single isopotential dendritic microdomain model, governed by the following ordinary differential equation for the membrane voltage $V$:\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\nLet us define the function $f(V)$ as the right-hand side of the equation, representing the total current across the membrane:\n$$\nf(V) = -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\nThus, the dynamical system is $\\frac{dV}{dt} = \\frac{1}{C}f(V)$.\n\n**1. Fixed Points, Stability, and Saddle-Node Bifurcation**\n\nA fixed point, or steady state, of the system is a voltage $V_{fp}$ where the net current is zero, meaning the voltage does not change over time. This is given by the condition $\\frac{dV}{dt} = 0$, which is equivalent to $f(V_{fp}) = 0$.\n\nThe linear stability of a fixed point $V_{fp}$ is determined by the sign of the derivative of $f(V)$ evaluated at that point, $f'(V_{fp})$. A fixed point is stable if $f'(V_{fp}) < 0$ and unstable if $f'(V_{fp}) > 0$. The derivative of $f(V)$ with respect to $V$ is:\n$$\nf'(V) = \\frac{df}{dV} = \\frac{d}{dV} \\left[ -g_{L}V + g_{L}E_{L} + g_{N}s\\exp(\\lambda V)(E_{N} - V) + I_{\\mathrm{ext}} \\right]\n$$\nUsing the product rule for the NMDA current term:\n$$\nf'(V) = -g_{L} + g_{N}s \\left[ \\left( \\lambda \\exp(\\lambda V) \\right) (E_{N} - V) + \\exp(\\lambda V) (-1) \\right]\n$$\n$$\nf'(V) = -g_{L} - g_{N}s\\exp(\\lambda V) \\left[ 1 - \\lambda(E_{N} - V) \\right]\n$$\nThe onset of bistability occurs via a saddle-node bifurcation. At such a bifurcation point, a stable fixed point and an unstable fixed point coalesce and annihilate. Mathematically, this corresponds to the curve of $f(V)$ being tangent to the voltage axis at some voltage $V^{\\star}$. This tangency point simultaneously satisfies the condition for being a fixed point and the condition for the transition between stability and instability ($f'(V^{\\star}) = 0$). Therefore, the two conditions for a saddle-node bifurcation are:\n1. $f(V^{\\star}) = 0$\n2. $f'(V^{\\star}) = 0$\n\nWe now introduce the change of variables as specified: $x \\equiv E_{N} - V$ and $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$. From the first definition, we have $V = E_{N} - x$. Let's rewrite the two saddle-node conditions using these new variables.\n\nThe first condition, $f(V^{\\star}) = 0$, is:\n$$\n-g_{L}(V^{\\star} - E_{L}) + g_{N}s\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) + I_{\\mathrm{ext}} = 0\n$$\nRearranging and dividing by $g_{L}$ gives:\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) = (V^{\\star} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\nSubstituting $V^{\\star} = E_{N} - x$ and $E_{N} - V^{\\star} = x$:\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda (E_{N} - x))x = (E_{N} - x - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = \\left[ (E_{N} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}} \\right] - x\n$$\nUsing the definition of $B$, we get:\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = B - x\n$$\n\nThe second condition, $f'(V^{\\star}) = 0$, is:\n$$\n-g_{L} - g_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\n$$\ng_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = -g_{L}\n$$\nSubstituting $V^{\\star} = E_{N} - x$ and $E_{N} - V^{\\star} = x$:\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x))[1 - \\lambda x] = -g_{L}\n$$\nAssuming $1 - \\lambda x \\neq 0$, we can write:\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x)) = -\\frac{g_{L}}{1 - \\lambda x}\n$$\nNow, substitute this expression into the transformed first condition:\n$$\n\\left( -\\frac{g_{L}}{g_{L}(1 - \\lambda x)} \\right) x = B - x\n$$\n$$\n-\\frac{x}{1 - \\lambda x} = B - x\n$$\nMultiplying by $(1 - \\lambda x)$ to clear the denominator:\n$$\n-x = (B - x)(1 - \\lambda x)\n$$\n$$\n-x = B - B\\lambda x - x + \\lambda x^2\n$$\n$$\n0 = B - B\\lambda x + \\lambda x^2\n$$\nRearranging this gives the desired quadratic equation in $x$:\n$$\n\\lambda x^2 - B\\lambda x + B = 0\n$$\nFor this quadratic equation to have real solutions for $x$ (which correspond to the voltages at which saddle-node bifurcations can occur), its discriminant $\\Delta$ must be non-negative.\n$$\n\\Delta = (-B\\lambda)^2 - 4(\\lambda)(B) = B^2\\lambda^2 - 4\\lambda B \\geq 0\n$$\nSince $\\lambda > 0$, we can divide by $\\lambda$:\n$$\nB^2\\lambda - 4B \\geq 0 \\implies B(B\\lambda - 4) \\geq 0\n$$\nThe parameter $B = (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$ is typically positive in a physiological context promoting bistability ($E_{N} > E_{L}$ and $I_{\\mathrm{ext}}$ is not a strong hyperpolarizing current). Assuming $B > 0$, the inequality holds if and only if:\n$$\nB\\lambda - 4 \\geq 0 \\implies B \\geq \\frac{4}{\\lambda}\n$$\nThis inequality is the condition on the combined external and synaptic drive for bistability to be possible.\n\n**2. Critical Conductance at the Cusp**\n\nThe cusp boundary represents the minimum condition required for bistability. It is the point where the two distinct saddle-node bifurcation points merge into one. This occurs when the discriminant of the quadratic in $x$ is exactly zero, i.e., $\\Delta = 0$.\n$$\nB(B\\lambda - 4) = 0\n$$\nAs $B=0$ is not a biophysically meaningful solution leading to bistability (it leads to $x=0$, which implies $g_L=0$ or other degeneracies), we must have:\n$$\nB\\lambda - 4 = 0 \\implies B = \\frac{4}{\\lambda}\n$$\nAt this cusp point, the quadratic equation for $x$ has a single, repeated root given by:\n$$\nx^{\\star} = \\frac{-(-B\\lambda)}{2\\lambda} = \\frac{B\\lambda}{2\\lambda} = \\frac{B}{2}\n$$\nSubstituting $B = 4/\\lambda$, we find the value of $x$ at the cusp:\n$$\nx^{\\star} = \\frac{1}{2} \\left( \\frac{4}{\\lambda} \\right) = \\frac{2}{\\lambda}\n$$\nThis value of $x$ corresponds to the voltage $V^{\\star} = E_N - x^{\\star} = E_N - 2/\\lambda$. To find the critical NMDA conductance $g_{N}^{\\star}$ at this cusp point, we return to the second saddle-node condition:\n$$\n-g_{L} - g_{N}^{\\star}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\nSolving for $g_{N}^{\\star}$:\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})]}\n$$\nSubstituting $V^{\\star} = E_N - x^{\\star}$ and $E_{N} - V^{\\star} = x^{\\star}$:\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda (E_N - x^{\\star}))[1 - \\lambda x^{\\star}]}\n$$\nNow, we substitute the cusp value $x^{\\star} = 2/\\lambda$:\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp\\left(\\lambda \\left(E_N - \\frac{2}{\\lambda}\\right)\\right)\\left[1 - \\lambda \\left(\\frac{2}{\\lambda}\\right)\\right]}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(1 - 2)}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(-1)}\n$$\n$$\ng_{N}^{\\star} = \\frac{g_{L}}{s\\exp(\\lambda E_N - 2)} = \\frac{g_{L}}{s}\\exp(2 - \\lambda E_N)\n$$\nThis is the closed-form expression for the critical conductance $g_{N}^{\\star}$ at the cusp.\n\n**3. Numerical Evaluation**\n\nWe are given the following parameter values:\n$g_{L} = 0.1\\,\\mu\\mathrm{S}$\n$s = 0.3$\n$\\lambda = 0.062\\,\\mathrm{mV}^{-1}$\n$E_{N} = 0\\,\\mathrm{mV}$\n\nSubstituting these values into the expression for $g_{N}^{\\star}$:\n$$\ng_{N}^{\\star} = \\frac{0.1\\,\\mu\\mathrm{S}}{0.3}\\exp(2 - (0.062\\,\\mathrm{mV}^{-1})(0\\,\\mathrm{mV}))\n$$\n$$\ng_{N}^{\\star} = \\frac{0.1}{0.3}\\exp(2)\\,\\mu\\mathrm{S} = \\frac{1}{3}\\exp(2)\\,\\mu\\mathrm{S}\n$$\nNow we compute the numerical value:\n$$\n\\exp(2) \\approx 7.3890560989...\n$$\n$$\ng_{N}^{\\star} \\approx \\frac{1}{3} \\times 7.3890560989...\\,\\mu\\mathrm{S} \\approx 2.4630186996...\\,\\mu\\mathrm{S}\n$$\nRounding to four significant figures, we get:\n$$\ng_{N}^{\\star} \\approx 2.463\\,\\mu\\mathrm{S}\n$$",
            "answer": "$$\\boxed{2.463}$$"
        },
        {
            "introduction": "Building on the principles of passive decay and local nonlinearity, this final practice integrates these concepts into a functional simulation of synaptic integration. You will model the interaction between a backpropagating action potential (bAP) and a local excitatory postsynaptic potential (EPSP) to predict the generation of a dendritic NMDA spike . This hands-on coding exercise demonstrates how dendrites act as sophisticated coincidence detectors, a mechanism thought to be fundamental for learning and memory formation in the brain.",
            "id": "4042533",
            "problem": "A cylindrical dendritic branch supports a backpropagating action potential (bAP) from the soma to a distal site. Consider a one-dimensional cable model with spatial coordinate $x$ in meters along a dendrite of total length $L$ and diameter $d$. The axial resistivity is $R_a$ in $\\Omega \\cdot \\mathrm{m}$, and the membrane has a leak conductance density $g_L$ in $\\mathrm{S}/\\mathrm{m}^2$. Active conductances are present and vary along the branch: the sodium conductance density $g_{Na}(x)$ decreases toward the distal end, and the potassium conductance density $g_{K}(x)$ increases toward the distal end. Assume the following gradient parameterization for the conductances per unit area:\n- $g_{Na}(x) = g_{Na}^0 \\exp(-\\gamma x)$\n- $g_{K}(x) = g_K^0 \\exp(\\kappa x)$\nwhere $g_{Na}^0$ and $g_K^0$ are proximal (near-soma) conductance densities in $\\mathrm{S}/\\mathrm{m}^2$, and $\\gamma$ and $\\kappa$ are spatial scale parameters in $\\mathrm{m}^{-1}$. To model the fact that the bAP is an active but short waveform, approximate the effective small-signal contribution of these conductances to the linearized membrane conductance with fixed fractions $p_{Na}$ and $p_{K}$, so that the total membrane conductance density is $g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x)$.\n\nStarting from the cable equation and the standard definition of the membrane resistance per unit area and the space constant for a uniform cylindrical cable, derive and implement a principled method to compute the attenuation of a bAP amplitude from the soma to the distal end. Use only the following foundational bases:\n- The cable equation for a passive, linearized dendrite, and the definition of the space constant for a uniform cylinder,\n- The relation between membrane resistance per unit area and conductance density,\n- The slowly varying approximation for spatially varying parameters along the cable.\n\nDefine the attenuation factor $\\mathcal{A}$ as the ratio of the bAP amplitude at the distal end to its amplitude at the soma, assuming the amplitude envelope obeys a locally exponential decay determined by the spatially varying space constant. Then, given a somatic bAP amplitude $A_{bAP}$ in $\\mathrm{mV}$, the distal bAP amplitude is $A_{bAP}^{dist} = \\mathcal{A}\\,A_{bAP}$. Consider a local excitatory postsynaptic potential (EPSP) of amplitude $A_{EPSP}$ in $\\mathrm{mV}$ at the distal site. Let the resting potential be $V_{rest}$ in $\\mathrm{mV}$ and an empirical threshold for initiating a local N-Methyl-D-Aspartate (NMDA) spike be $V_{th}$ in $\\mathrm{mV}$. Assume time alignment (bAP-EPSP pairing), and define a binary prediction rule for NMDA spike initiation: a local NMDA spike is predicted if $V_{rest} + A_{EPSP} + A_{bAP}^{dist} \\ge V_{th}$.\n\nImplement a complete program that, for each test case below, computes:\n- The attenuation factor $\\mathcal{A}$ as a float,\n- A boolean indicating whether a local NMDA spike is predicted under bAP-EPSP pairing.\n\nPhysical units must be handled explicitly. Diameters $d$ and lengths $L$ are provided in micrometers and must be converted to meters before computation. Conductances are in $\\mathrm{S}/\\mathrm{m}^2$, resistivity in $\\Omega \\cdot \\mathrm{m}$, and voltages in $\\mathrm{mV}$. Each test-case result must be a list of two elements: a float and a boolean.\n\nUse the following test suite, which includes a general case, a boundary case, and edge cases:\n- Case $1$: $d = 1\\,\\mu\\mathrm{m}$, $L = 300\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 5000\\,\\mathrm{m}^{-1}$, $\\kappa = 3000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.02$, $p_{K} = 0.2$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 7\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -30\\,\\mathrm{mV}$.\n- Case $2$ (boundary length): $d = 1\\,\\mu\\mathrm{m}$, $L = 0\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 5000\\,\\mathrm{m}^{-1}$, $\\kappa = 3000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.02$, $p_{K} = 0.2$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 7\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -30\\,\\mathrm{mV}$.\n- Case $3$ (thin, long, strong $g_{K}$ growth): $d = 0.4\\,\\mu\\mathrm{m}$, $L = 400\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 250\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 200\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 4000\\,\\mathrm{m}^{-1}$, $\\kappa = 8000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.015$, $p_{K} = 0.25$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 10\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -35\\,\\mathrm{mV}$.\n- Case $4$ (thicker, shorter, higher proximal $g_{Na}$ and shallow decay): $d = 2.0\\,\\mu\\mathrm{m}$, $L = 200\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 0.8\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 500\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 120\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 500\\,\\mathrm{m}^{-1}$, $\\kappa = 2000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.05$, $p_{K} = 0.15$, $A_{bAP} = 85\\,\\mathrm{mV}$, $A_{EPSP} = 25\\,\\mathrm{mV}$, $V_{rest} = -63\\,\\mathrm{mV}$, $V_{th} = -35\\,\\mathrm{mV}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to a test case and must itself be a two-element list: the float attenuation factor $\\mathcal{A}$ and the boolean NMDA spike prediction. For example, the output format must be like $[\\,[\\mathcal{A}_1,\\mathrm{bool}_1],[\\mathcal{A}_2,\\mathrm{bool}_2],\\dots\\,]$ with no additional text.",
            "solution": "The problem requires the derivation and implementation of a method to compute the attenuation of a backpropagating action potential (bAP) along a non-uniform dendritic cable and to predict the initiation of a local NMDA spike. The solution is developed from first principles as specified.\n\n### **1. Foundations: Passive Cable Theory**\n\nThe voltage propagation in a passive, uniform cylindrical dendrite is described by the steady-state cable equation:\n$$ \\lambda^2 \\frac{d^2V}{dx^2} - V = 0 $$\nwhere $V$ is the membrane potential relative to rest, $x$ is the spatial coordinate along the cable, and $\\lambda$ is the space constant. For an infinitely long cable, the solution describing voltage decay from a source at $x=0$ is $V(x) = V_0 \\exp(-x/\\lambda)$.\n\nThe space constant $\\lambda$ is defined as:\n$$ \\lambda = \\sqrt{\\frac{r_m}{r_i}} $$\nwhere $r_m$ is the membrane resistance per unit length (in $\\Omega \\cdot \\mathrm{m}$) and $r_i$ is the axial resistance per unit length (in $\\Omega/\\mathrm{m}$). These parameters are related to the intrinsic properties of the dendrite:\n*   Axial resistance per unit length, $r_i$:\n    $$ r_i = \\frac{R_a}{A_{cross}} = \\frac{R_a}{\\pi (d/2)^2} = \\frac{4 R_a}{\\pi d^2} $$\n    Here, $R_a$ is the axial resistivity (in $\\Omega \\cdot \\mathrm{m}$) and $d$ is the diameter of the cylindrical dendrite (in $\\mathrm{m}$).\n*   Membrane resistance per unit length, $r_m$:\n    $$ r_m = \\frac{R_m}{\\pi d} $$\n    Here, $R_m$ is the membrane resistance per unit area (in $\\Omega \\cdot \\mathrm{m}^2$). $R_m$ is the reciprocal of the membrane conductance density $g_m$ (in $\\mathrm{S}/\\mathrm{m}^2$):\n    $$ R_m = \\frac{1}{g_m} $$\n\nCombining these, the space constant for a uniform cable can be expressed as:\n$$ \\lambda^2 = \\frac{r_m}{r_i} = \\frac{1/(\\pi d g_m)}{4 R_a/(\\pi d^2)} = \\frac{d}{4 R_a g_m} \\implies \\lambda = \\sqrt{\\frac{d}{4 R_a g_m}} $$\n\n### **2. Generalization to a Non-Uniform Cable**\n\nThe problem states that the active conductances vary with position $x$, making the total effective membrane conductance density $g_m$ a function of $x$:\n$$ g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x) $$\nSubstituting the given exponential forms for $g_{Na}(x)$ and $g_{K}(x)$:\n$$ g_m(x) = g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x) $$\nwhere $g_L$, $p_{Na}$, $g_{Na}^0$, $\\gamma$, $p_{K}$, $g_{K}^0$, and $\\kappa$ are given parameters.\n\nSince $g_m$ varies with $x$, the space constant also becomes a spatially varying function, $\\lambda(x)$:\n$$ \\lambda(x) = \\sqrt{\\frac{d}{4 R_a g_m(x)}} $$\n\n### **3. Attenuation Factor from the Slowly Varying Approximation**\n\nThe problem instructs to use the \"slowly varying approximation,\" where the bAP amplitude envelope, $A(x)$, is assumed to obey a locally exponential decay governed by the local space constant $\\lambda(x)$. This can be expressed as a differential equation for the amplitude:\n$$ \\frac{dA(x)}{dx} = -\\frac{A(x)}{\\lambda(x)} $$\nThis is a first-order, separable ordinary differential equation. We can solve for the amplitude $A(L)$ at the distal end ($x=L$) given the amplitude $A(0)$ at the soma ($x=0$) by integrating:\n$$ \\int_{A(0)}^{A(L)} \\frac{dA}{A} = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln(A(L)) - \\ln(A(0)) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln\\left(\\frac{A(L)}{A(0)}\\right) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\nThe attenuation factor $\\mathcal{A}$ is defined as the ratio $\\mathcal{A} = A(L)/A(0)$. Exponentiating both sides yields the expression for $\\mathcal{A}$:\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\frac{dx}{\\lambda(x)}\\right) $$\n\n### **4. Final Expression for Calculation**\n\nSubstituting the expression for $\\lambda(x)$ into the formula for $\\mathcal{A}$:\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\sqrt{\\frac{4 R_a g_m(x)}{d}} \\, dx\\right) $$\nThe constant terms can be pulled out of the integral:\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_m(x)} \\, dx\\right) $$\nSubstituting the full expression for $g_m(x)$:\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x)} \\, dx\\right) $$\nThis integral does not possess a general analytical solution and must be computed numerically. The provided parameters for length $L$ and diameter $d$ are in micrometers ($\\mu\\mathrm{m}$) and must be converted to meters ($\\mathrm{m}$) by multiplying by $10^{-6}$ to maintain SI unit consistency.\n\nFor the boundary case where the length $L=0$, the integral from $0$ to $0$ is $0$. Thus, the exponent is $0$, and $\\mathcal{A} = \\exp(0) = 1$, indicating no attenuation, as expected.\n\n### **5. NMDA Spike Prediction Rule**\n\nThe prediction of a local NMDA spike at the distal site ($x=L$) is based on a simple thresholding rule. The peak membrane potential, $V_{peak}$, resulting from the coincident arrival of the attenuated bAP and a local EPSP is the linear sum of their amplitudes on top of the resting potential:\n$$ A_{bAP}^{dist} = \\mathcal{A} \\cdot A_{bAP} $$\n$$ V_{peak} = V_{rest} + A_{EPSP} + A_{bAP}^{dist} $$\nAn NMDA spike is predicted if this peak potential reaches or exceeds the threshold voltage $V_{th}$:\n$$ V_{peak} \\ge V_{th} $$\nThis yields a boolean (True/False) result for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nimport json\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the bAP attenuation factor and predicts NMDA spike initiation.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each tuple contains:\n    # (d, L, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n    #  A_bAP, A_EPSP, V_rest, V_th)\n    test_cases = [\n        # Case 1: General case\n        (1.0, 300.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 2: Boundary length\n        (1.0, 0.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 3: Thin, long, strong g_K growth\n        (0.4, 400.0, 1.5, 1.0, 250.0, 200.0, 4000.0, 8000.0, 0.015, 0.25,\n         80.0, 10.0, -65.0, -35.0),\n        # Case 4: Thicker, shorter, high proximal g_Na\n        (2.0, 200.0, 1.5, 0.8, 500.0, 120.0, 500.0, 2000.0, 0.05, 0.15,\n         85.0, 25.0, -63.0, -35.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_model(*case)\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    # Using json.dumps ensures a compact, standard representation.\n    print(json.dumps(results).replace(\" \", \"\"))\n\ndef compute_model(d_um, L_um, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n                  A_bAP, A_EPSP, V_rest, V_th):\n    \"\"\"\n    Computes the attenuation factor and NMDA spike prediction for a single case.\n\n    Args:\n        d_um (float): Diameter in micrometers.\n        L_um (float): Length in micrometers.\n        R_a (float): Axial resistivity in Ohm*m.\n        g_L (float): Leak conductance density in S/m^2.\n        g_Na0 (float): Proximal Na+ conductance density in S/m^2.\n        g_K0 (float): Proximal K+ conductance density in S/m^2.\n        gamma (float): Spatial scale for Na+ conductance in 1/m.\n        kappa (float): Spatial scale for K+ conductance in 1/m.\n        p_Na (float): Effective fraction for Na+ conductance.\n        p_K (float): Effective fraction for K+ conductance.\n        A_bAP (float): Somatic bAP amplitude in mV.\n        A_EPSP (float): Distal EPSP amplitude in mV.\n        V_rest (float): Resting potential in mV.\n        V_th (float): NMDA spike threshold in mV.\n\n    Returns:\n        list: A list containing [attenuation_factor, spike_prediction_bool].\n    \"\"\"\n    # 1. Unit conversion from micrometers to meters.\n    d = d_um * 1e-6\n    L = L_um * 1e-6\n\n    # 2. Handle the boundary case L=0.\n    if L == 0:\n        attenuation_factor = 1.0\n    else:\n        # 3. Define the integrand for the attenuation calculation.\n        # The integrand is sqrt(g_m(x)).\n        def integrand(x):\n            g_m_x = g_L + p_Na * g_Na0 * np.exp(-gamma * x) + p_K * g_K0 * np.exp(kappa * x)\n            return np.sqrt(g_m_x)\n\n        # 4. Numerically integrate from x=0 to x=L.\n        integral_val, _ = integrate.quad(integrand, 0, L)\n\n        # 5. Calculate the attenuation factor.\n        prefactor = np.sqrt(4 * R_a / d)\n        exponent = -prefactor * integral_val\n        attenuation_factor = np.exp(exponent)\n\n    # 6. Predict NMDA spike initiation.\n    # Calculate distal bAP amplitude.\n    A_bAP_dist = attenuation_factor * A_bAP\n\n    # Calculate peak voltage at distal site.\n    V_peak = V_rest + A_EPSP + A_bAP_dist\n\n    # Apply the threshold rule.\n    spike_predicted = V_peak >= V_th\n    \n    # 7. Return the results as a two-element list.\n    return [attenuation_factor, spike_predicted]\n\n# Run the simulation.\nsolve()\n```"
        }
    ]
}