{
    "hands_on_practices": [
        {
            "introduction": "平衡传播中的‘平衡’指的是网络活动稳定在能量函数最小值的状态。第一个练习  为您提供了一个直接接触这一核心概念的机会。您将为一个简单的对称连接网络推导其能量函数，并验证平衡条件，从而将能量景观的抽象概念与具体的网络动力学联系起来。",
            "id": "4043234",
            "problem": "考虑一个双神经元脉冲网络，该网络处于平均场滤波脉冲近似下，其中连续时间发放率向量 $x \\in \\mathbb{R}^{2}$ 遵循渗漏整合发放（LIF）动力学。该动力学由时间常数 $\\tau$、对称突触耦合矩阵 $W \\in \\mathbb{R}^{2 \\times 2}$ 和外部输入 $I \\in \\mathbb{R}^{2}$ 驱动。以LIF神经元的一阶线性发放率动力学作为基本依据：\n$$\n\\tau \\frac{d x}{d t} = - x + W x + I,\n$$\n同时，基于平衡传播（EP）的能量需求，存在一个标量能量函数 $E(x,w)$，使得自主弛豫动力学是一个梯度流：\n$$\n\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w).\n$$\n假设 $W$ 是对称的，即 $W = W^{\\top}$，并且关于 $x$ 是光滑的。仅使用这些基本事实，推导出一个与上述动力学一致的有效能量函数 $E(x,w)$（可相差一个任意的加性常数）。然后，对于具有非对角突触 $w_{12} = w_{21} = 0.4$ 和零自耦合 $w_{11} = w_{22} = 0$、渗漏时间常数 $\\tau = 10\\,\\mathrm{ms}$、滤波脉冲 $x = (0.3,\\,0.6)$ 以及输入 $I = (0.1,\\,0)$ 的特定双神经元网络，在点 $x$ 处求值 $E(x,w)$ 并计算梯度分量 $\\frac{\\partial E}{\\partial x_{1}}$ 和 $\\frac{\\partial E}{\\partial x_{2}}$。最后，根据您计算的梯度，验证 $\\nabla_{x} E$ 在点 $x$ 处是否为零。将您的最终答案表示为一个行矩阵 $\\big(E(x,w),\\,\\frac{\\partial E}{\\partial x_{1}},\\,\\frac{\\partial E}{\\partial x_{2}}\\big)$。数值无需四舍五入，能量值也无需包含物理单位。",
            "solution": "用户希望我解决一个关于脉冲网络中平衡传播的问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   **步骤1：提取已知条件。** 我将列出问题描述中提供的所有方程、变量和数值。\n    *   **步骤2：验证。** 我将根据我的验证标准（科学依据、良置性、客观性等）检查提取的已知条件。\n        *   问题描述了一个简化的神经动力学模型（平均场近似下的LIF神经元）。这是计算神经科学中一个标准且被广泛接受的模型。\n        *   动力学由一个一阶线性常微分方程给出：$\\tau \\frac{d x}{d t} = - x + W x + I$。\n        *   引入了平衡传播（EP）的核心概念：动力学必须是能量函数上的梯度流，$\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w)$。\n        *   问题要求我通过令两种动力学表达式相等来推导这个能量函数 $E(x,w)$。\n        *   突触矩阵 $W$ 被假定为对称的，这是存在这样一个标量能量函数的关键要求。如果 $Wx$ 是一个梯度，它的雅可比矩阵（即 $W$）必须是对称的。这与假设一致。\n        *   推导 $E(x,w)$ 的要求似乎是良置的。我可以令动力学向量的各分量相等，然后积分以找到势函数 $E$。\n        *   然后，问题为参数提供了具体的数值：$W$、$\\tau$、$x$ 和 $I$。\n        *   它要求我在给定的点 $x$ 处计算 $E(x,w)$ 及其梯度。\n        *   最后，它要求我检查在该点梯度是否为零，这是对平衡状态的检验。\n        *   问题似乎是自洽的，在计算神经科学理论中有科学依据，是客观且良置的。没有明显的缺陷。对于矩阵W，“关于x光滑”的表述有点不寻常，因为W通常是参数的常数矩阵，而不是x的函数。然而，在给定动力学的背景下，项是 $Wx$，而需要成为某个函数梯度的项是 $-x+Wx+I$。让我再仔细读一遍：“假设 $W$ 是对称的，$W = W^{\\top}$，并且关于 $x$ 是光滑的。”这似乎是一个轻微的误述。*向量场* $F(x) = -x + Wx + I$ 必须是某个势的梯度。一个向量场 $F$ 是梯度场，当且仅当其雅可比矩阵是对称的。$F(x)$ 的雅可比矩阵是 $J_{ij} = \\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} (-x_i + \\sum_k W_{ik} x_k + I_i) = - \\delta_{ij} + W_{ij}$。因此，要使向量场 $F(x)$ 成为梯度场，其雅可比矩阵 $J = -I_{d} + W$ 必须是对称的。由于单位矩阵 $I_{d}$ 是对称的，这要求 $W$ 是对称的，而这在问题陈述中已给出（$W = W^{\\top}$）。“关于x光滑”的部分可能是一个轻微的冗余，或者是一种措辞不佳的方式，意在说明向量场是光滑的，而它确实是光滑的，因为它是线性的。鉴于问题在数值部分提供了一个常数矩阵 $W$，我将把这解释为措辞上的轻微不精确，而不是一个关键缺陷。核心逻辑成立，因为 $W$ 是对称的。\n    *   **步骤3：结论。** 问题有效。我可以继续解答。\n\n2.  **解决问题。**\n    *   **第1部分：推导能量函数 $E(x,w)$。**\n        *   从两个给定的动力学方程开始：\n            1.  $\\tau \\frac{d x}{d t} = - x + W x + I$\n            2.  $\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w)$\n        *   令右侧相等：\n            $\\nabla_{x} E(x,w) = x - W x - I$。\n        *   这意味着 $\\frac{\\partial E}{\\partial x_i} = x_i - \\sum_j W_{ij} x_j - I_i$。\n        *   为了找到 $E(x,w)$，我需要对这个偏微分方程组进行积分。\n        *   对于一个向量场 $F = \\nabla E$，使用二次势的一般形式是更好的方法。该向量场关于 $x$ 是线性的。\n            我们写出梯度的分量：\n            $\\nabla_x E = (I_d - W)x - I$。\n            这是 $x$ 的一个仿射变换。能量函数 $E$ 必须是一个二次型。\n            让我们尝试一个一般的二次型：\n            $E(x) = \\frac{1}{2} x^\\top A x - b^\\top x + C_0$。\n            其梯度为 $\\nabla_x E = A x - b$。\n            与 $\\nabla_x E = (I_d - W)x - I$ 相比较，我们可以确定：\n            $A = I_d - W$ 和 $b = I$。\n            所以，$E(x,w) = \\frac{1}{2} x^\\top (I_d - W) x - I^\\top x + C_0$。\n            我们来验证一下。对于对称矩阵 $A$，$\\nabla_x (\\frac{1}{2} x^\\top A x) = Ax$。矩阵 $A = I_d - W$ 是对称的，因为 $I_d$ 是对称的，且 $W$ 已知是对称的。所以这个方法可行。\n            我们用索引表示法写出来：\n            $E(x, w) = \\frac{1}{2} \\sum_{i,j} x_i (I_d - W)_{ij} x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} \\sum_{i,j} x_i (\\delta_{ij} - W_{ij}) x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} \\sum_i x_i^2 - \\frac{1}{2} \\sum_{i,j} x_i W_{ij} x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} x^\\top x - \\frac{1}{2} x^\\top W x - I^\\top x + C_0$。\n            问题要求 $E(x,w)$ 可相差一个任意的加性常数，所以我可以设 $C_0=0$。\n            $E(x,w) = \\frac{1}{2} x^\\top x - \\frac{1}{2} x^\\top W x - I^\\top x$。\n            这就是能量函数。\n\n    *   **第2部分：根据给定的数值计算 $E(x,w)$。**\n        *   已知条件：\n            *   $x = \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix}$\n            *   $W = \\begin{pmatrix} 0  0.4 \\\\ 0.4  0 \\end{pmatrix}$\n            *   $I = \\begin{pmatrix} 0.1 \\\\ 0 \\end{pmatrix}$\n            *   $\\tau = 10$（这个值对于静态评估E不是必需的，只对动力学有用）。\n        *   计算 $E(x,w)$ 中的各项：\n            *   $x^\\top x = x_1^2 + x_2^2 = (0.3)^2 + (0.6)^2 = 0.09 + 0.36 = 0.45$。\n            *   $x^\\top W x = \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0  0.4 \\\\ 0.4  0 \\end{pmatrix} \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix}$\n                $= \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0 \\cdot 0.3 + 0.4 \\cdot 0.6 \\\\ 0.4 \\cdot 0.3 + 0 \\cdot 0.6 \\end{pmatrix}$\n                $= \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0.24 \\\\ 0.12 \\end{pmatrix}$\n                $= 0.3 \\cdot 0.24 + 0.6 \\cdot 0.12 = 0.072 + 0.072 = 0.144$。\n                或者，使用索引表示法：$\\sum_{i,j} W_{ij} x_i x_j = W_{11}x_1^2 + W_{12}x_1x_2 + W_{21}x_2x_1 + W_{22}x_2^2 = 0 + 0.4(0.3)(0.6) + 0.4(0.6)(0.3) + 0 = 2 \\cdot 0.4 \\cdot 0.18 = 0.8 \\cdot 0.18 = 0.144$。正确。\n            *   $I^\\top x = I_1 x_1 + I_2 x_2 = 0.1 \\cdot 0.3 + 0 \\cdot 0.6 = 0.03$。\n        *   现在，将这些代入E的表达式：\n            $E(x,w) = \\frac{1}{2} (0.45) - \\frac{1}{2} (0.144) - (0.03)$\n            $E(x,w) = 0.225 - 0.072 - 0.03$\n            $E(x,w) = 0.153 - 0.03 = 0.123$。\n\n    *   **第3部分：计算在点 $x$ 处的梯度分量 $\\frac{\\partial E}{\\partial x_1}$ 和 $\\frac{\\partial E}{\\partial x_2}$。**\n        *   梯度为 $\\nabla_{x} E(x,w) = (I_d - W)x - I$。\n        *   我们来计算 $(I_d - W)$：\n            $I_d - W = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0  0.4 \\\\ 0.4  0 \\end{pmatrix} = \\begin{pmatrix} 1  -0.4 \\\\ -0.4  1 \\end{pmatrix}$。\n        *   现在计算 $(I_d - W)x$：\n            $(I_d - W)x = \\begin{pmatrix} 1  -0.4 \\\\ -0.4  1 \\end{pmatrix} \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 0.3 - 0.4 \\cdot 0.6 \\\\ -0.4 \\cdot 0.3 + 1 \\cdot 0.6 \\end{pmatrix}$\n            $= \\begin{pmatrix} 0.3 - 0.24 \\\\ -0.12 + 0.6 \\end{pmatrix} = \\begin{pmatrix} 0.06 \\\\ 0.48 \\end{pmatrix}$。\n        *   最后，减去 $I$：\n            $\\nabla_{x} E = \\begin{pmatrix} 0.06 \\\\ 0.48 \\end{pmatrix} - \\begin{pmatrix} 0.1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix}$。\n        *   所以，$\\frac{\\partial E}{\\partial x_1} = -0.04$ 且 $\\frac{\\partial E}{\\partial x_2} = 0.48$。\n\n    *   **第4部分：验证 $\\nabla_x E$ 是否为零。**\n        *   计算出的梯度是 $\\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix}$。\n        *   这个向量不是零向量。因此，在给定的点 $x$ 处，梯度不为零。\n        *   这意味着对于给定的动力学和输入 $I$，点 $x = (0.3, 0.6)$ 不是一个平衡点。在该点，系统不是静止的；其状态将根据 $\\tau \\frac{dx}{dt} = - \\nabla_x E = - \\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ -0.48 \\end{pmatrix}$ 发生变化。\n\n    *   **第5部分：整合最终答案。**\n        *   问题要求一个行矩阵 $\\big(E(x,w),\\,\\frac{\\partial E}{\\partial x_{1}},\\,\\frac{\\partial E}{\\partial x_{2}}\\big)$。\n        *   根据我的计算：\n            *   $E(x,w) = 0.123$\n            *   $\\frac{\\partial E}{\\partial x_1} = -0.04$\n            *   $\\frac{\\partial E}{\\partial x_2} = 0.48$\n        *   最终答案是 $(0.123, -0.04, 0.48)$。\n        *   我将把它格式化为 LaTeX 的 `pmatrix`。\n\n3.  **复查与格式化。**\n    *   我需要清晰地、一步步地写出解答过程，并将所有数学实体用LaTeX表示。\n    *   $E(x,w)$ 的推导必须清晰且有理有据。\n    *   必须展示数值计算过程。\n    *   关于梯度是否为零的最终检查只是一个观察，但它是指令的一部分。我应该清楚地陈述这个结论。\n    *   最终答案只需要数值，而不需要这个验证结果。\n    *   最终答案必须采用指定的 `\\boxed{...}` 格式并使用 `pmatrix`。\n\n这看起来完整且正确。我将确保所有数字都用LaTeX格式化，例如，$0.3$、$0.6$、$10$、$\\mathbb{R}^{2}$ 等。关于W的“关于x光滑”的说法是唯一有点奇怪的部分，但正如所分析的，它不会使问题无效，因为所提供的W是常数且对称的，这才是关键属性。这个问题可以解释为向量场是光滑的，而这确实是正确的。推导二次能量函数的逻辑依赖于力场雅可比矩阵的对称性，这一点是满足的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.123  -0.04  0.48 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "建立能量函数只是第一步，要使 EP 可行，网络必须能够动态地收敛到一个稳定的平衡点。接下来的练习  探讨了稳定性的这一关键方面。通过在不动点附近对网络动力学进行线性化，您将学会评估系统是会稳定下来还是会表现出振荡等不稳定行为——这是对 EP 任何物理实现都至关重要的考量。",
            "id": "4043239",
            "problem": "考虑一个由一个兴奋性神经元和一个抑制性神经元组成的双群体脉冲神经网络，在 Equilibrium Propagation (EP) 的自由阶段下，于群体平均发放率的层面上进行分析。设膜电位表示为 $V_{E}(t)$ 和 $V_{I}(t)$，相应的群体发放率表示为 $r_{E}(t)$ 和 $r_{I}(t)$。假设一个标准的 Leaky Integrate-and-Fire (LIF) 平均场率描述，其漏泄时间常数为 $\\tau0$，在自由阶段期间，电压坐标下的动力学由以下方程控制：\n$$\n\\tau \\,\\frac{d}{dt}\\begin{pmatrix}V_{E}\\\\V_{I}\\end{pmatrix} \\;=\\; -\\begin{pmatrix}V_{E}\\\\V_{I}\\end{pmatrix} \\;+\\; W \\begin{pmatrix}r_{E}\\\\r_{I}\\end{pmatrix} \\;+\\; \\begin{pmatrix}b_{E}\\\\b_{I}\\end{pmatrix},\n$$\n其中静态非线性 $r=\\phi(V)$ 逐元素应用。假设兴奋-抑制耦合矩阵 $W$ 由下式给出：\n$$\nW \\;=\\; \\begin{pmatrix} w_{EE}  w_{EI} \\\\ w_{IE}  w_{II} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0.5  -0.3 \\\\ 0.6  -0.2 \\end{pmatrix}.\n$$\n假设一个平滑、饱和、严格递增的率非线性 $\\phi(\\cdot)$，其增益 $g=1$，使得持续性输入 $\\begin{pmatrix}b_{E}\\\\b_{I}\\end{pmatrix}$ 将两个神经元都置于非线性的中点，从而得到 $r_{E}^{*}=r_{I}^{*}=\\phi(V^{*})=\\tfrac{1}{2}$ 以及在工作点处的斜率矩阵：\n$$\nD \\;=\\; \\operatorname{diag}\\!\\big(\\phi'(V_{E}^{*}),\\,\\phi'(V_{I}^{*})\\big) \\;=\\; \\operatorname{diag}\\!\\Big(\\tfrac{1}{4},\\,\\tfrac{1}{4}\\Big),\n$$\n这与 logistic 导数 $\\phi'(x)=\\phi(x)\\big(1-\\phi(x)\\big)$ 在 $\\phi(x)=1/2$ 时达到其最大值 $1/4$ 相一致。从上述 LIF 平均场动力学和 EP 自由阶段不动点概念出发，推导关于该不动点的有效线性化算子，并通过检查线性化耦合的谱半径来判断在这些持续性输入下是否存在稳定平衡。计算该有效线性化算子的谱半径并报告其值。将您的答案四舍五入到四位有效数字。最终答案必须是无量纲的。",
            "solution": "用户提供了一个问题陈述，在尝试解决之前需要对其进行验证。\n\n### 步骤 1：提取已知条件\n- **动力学系统**：膜电位 $\\begin{pmatrix}V_{E}\\\\V_{I}\\end{pmatrix}$ 的平均场动力学由下式给出：\n$$\n\\tau \\,\\frac{d}{dt}\\begin{pmatrix}V_{E}\\\\V_{I}\\end{pmatrix} \\;=\\; -\\begin{pmatrix}V_{E}\\\\V_{I}\\end{pmatrix} \\;+\\; W \\begin{pmatrix}r_{E}\\\\r_{I}\\end{pmatrix} \\;+\\; \\begin{pmatrix}b_{E}\\\\b_{I}\\end{pmatrix}\n$$\n- **时间常数**：$\\tau  0$。\n- **率非线性**：发放率是电位的函数，$r=\\phi(V)$，逐元素应用。$\\phi(\\cdot)$ 是平滑、饱和、严格递增的，增益 $g=1$。\n- **耦合矩阵**：突触权重矩阵 $W$ 为：\n$$\nW \\;=\\; \\begin{pmatrix} w_{EE}  w_{EI} \\\\ w_{IE}  w_{II} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0.5  -0.3 \\\\ 0.6  -0.2 \\end{pmatrix}\n$$\n- **不动点条件**：在持续性输入 $\\begin{pmatrix}b_{E}\\\\b_{I}\\end{pmatrix}$ 下，系统处于一个不动点 $(V^{*}, r^{*})$，其中发放率为 $r_{E}^{*} = r_{I}^{*} = \\frac{1}{2}$。\n- **在不动点处的线性化**：在不动点处，非线性的导数矩阵为：\n$$\nD \\;=\\; \\operatorname{diag}\\!\\big(\\phi'(V_{E}^{*}),\\,\\phi'(V_{I}^{*})\\big) \\;=\\; \\operatorname{diag}\\!\\Big(\\tfrac{1}{4},\\,\\tfrac{1}{4}\\Big)\n$$\n这与 logistic 导数 $\\phi'(x)=\\phi(x)(1-\\phi(x))$ 在点 $\\phi(x)=\\frac{1}{2}$ 处的情况相符。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性**：该问题在科学上是健全的。它使用了一个标准的 Wilson-Cowan 型平均场模型，这是理论神经科学的基石。通过围绕不动点进行线性化来分析稳定性是研究动力学系统的一项基本技术。Equilibrium Propagation 是在此背景下的一个相关学习算法。\n2.  **不可形式化或不相关**：该问题在数学上是明确定义的，并直接关系到与 Equilibrium Propagation 相关的网络动力学分析。\n3.  **不完整或矛盾的设置**：该问题提供了执行所需稳定性分析的所有必要信息（动力学方程、权重矩阵以及在不动点处非线性的性质）。对于围绕指定不动点的线性化，不需要偏置项 $\\begin{pmatrix}b_{E}\\\\b_{I}\\end{pmatrix}$ 的显式值。\n4.  **不切实际或不可行**：所提供的参数对于一个简化的理论模型是合理的。\n5.  **不适定或结构不良**：该问题是适定的且结构清晰，要求从一个标准的分析方法中推导出一个特定的量（谱半径）。\n6.  **伪深刻、琐碎或同义反复**：该问题并非琐碎；它需要正确应用线性化理论和矩阵代数。\n7.  **超出科学可验证性范围**：计算过程在数学上是直接且可验证的。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、是适定的，并包含获得唯一解所需的所有信息。我将继续解决该问题。\n\n### 解答\n问题要求计算一个双神经元网络的有效线性化算子的谱半径，以评估其在 Equilibrium Propagation 自由阶段期间不动点的稳定性。\n\n设膜电位的状态向量为 $\\mathbf{V}(t) = \\begin{pmatrix}V_{E}(t) \\\\ V_{I}(t)\\end{pmatrix}$。系统的动力学由以下向量微分方程描述：\n$$\n\\tau \\frac{d\\mathbf{V}}{dt} = \\mathbf{F}(\\mathbf{V}) = -\\mathbf{V} + W\\phi(\\mathbf{V}) + \\mathbf{b}\n$$\n其中 $\\phi(\\mathbf{V})$ 是逐元素应用的。\n\n系统的一个不动点 $\\mathbf{V}^*$ 是动力学停止的点，即 $\\frac{d\\mathbf{V}}{dt} = \\mathbf{0}$。这得出了不动点方程：\n$$\n\\mathbf{0} = -\\mathbf{V}^* + W\\phi(\\mathbf{V}^*) + \\mathbf{b}\n$$\n这个不动点的稳定性是通过分析系统在 $\\mathbf{V}^*$ 附近小微扰下的行为来确定的。设 $\\delta\\mathbf{V}(t) = \\mathbf{V}(t) - \\mathbf{V}^*$。我们可以在 $\\mathbf{V}^*$ 附近将函数 $\\mathbf{F}(\\mathbf{V})$ 线性化：\n$$\n\\tau \\frac{d(\\mathbf{V}^* + \\delta\\mathbf{V})}{dt} = \\mathbf{F}(\\mathbf{V}^* + \\delta\\mathbf{V}) \\approx \\mathbf{F}(\\mathbf{V}^*) + J \\delta\\mathbf{V}\n$$\n其中 $J$ 是 $\\mathbf{F}$ 在 $\\mathbf{V}^*$ 处计算的雅可比矩阵。由于 $\\frac{d\\mathbf{V}^*}{dt} = \\mathbf{0}$ 和 $\\mathbf{F}(\\mathbf{V}^*) = \\mathbf{0}$，微扰的线性化动力学为：\n$$\n\\tau \\frac{d(\\delta\\mathbf{V})}{dt} = J \\delta\\mathbf{V}\n$$\n雅可比矩阵 $J$ 计算如下：\n$$\nJ = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}}\\bigg|_{\\mathbf{V}=\\mathbf{V}^*} = \\frac{\\partial}{\\partial \\mathbf{V}} \\left( -\\mathbf{V} + W\\phi(\\mathbf{V}) + \\mathbf{b} \\right) \\bigg|_{\\mathbf{V}=\\mathbf{V}^*} = -I + W \\frac{\\partial \\phi(\\mathbf{V})}{\\partial \\mathbf{V}}\\bigg|_{\\mathbf{V}=\\mathbf{V}^*}\n$$\n项 $\\frac{\\partial \\phi(\\mathbf{V})}{\\partial \\mathbf{V}}$ 是一个矩阵，其第 $(i,j)$ 个元素为 $\\frac{\\partial \\phi(V_i)}{\\partial V_j}$。由于 $\\phi$ 是逐元素应用的，该导数仅在 $i=j$ 时非零，从而形成一个对角矩阵。这正是问题陈述中给出的矩阵 $D$：\n$$\nD = \\operatorname{diag}\\!\\big(\\phi'(V_{E}^{*}),\\,\\phi'(V_{I}^{*})\\big)\n$$\n因此，在不动点处的雅可比矩阵为：\n$$\nJ = -I + WD\n$$\n不动点的稳定性要求雅可比矩阵 $J$ 的所有特征值 $\\lambda_J$ 的实部都必须为负，即 $\\operatorname{Re}(\\lambda_J)  0$。$J = -I + WD$ 的特征值与 $WD$ 的特征值（我们记为 $\\lambda_{WD}$）通过关系 $\\lambda_J = -1 + \\lambda_{WD}$ 相关联。因此，稳定性条件变为：\n$$\n\\operatorname{Re}(-1 + \\lambda_{WD})  0 \\quad \\implies \\quad \\operatorname{Re}(\\lambda_{WD})  1\n$$\n问题中提到的“有效线性化算子”或“线性化耦合”对应于矩阵乘积 $M = WD$。我们被要求计算其谱半径 $\\rho(M)$，定义为其特征值的最大绝对值。条件 $\\rho(M)  1$ 是稳定性的一个充分条件，因为 $\\operatorname{Re}(\\lambda_{WD}) \\le |\\lambda_{WD}| \\le \\rho(M)$。\n\n让我们计算矩阵 $M = WD$。给定的矩阵是：\n$$\nW = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.6  -0.2 \\end{pmatrix} \\quad \\text{和} \\quad D = \\begin{pmatrix} 1/4  0 \\\\ 0  1/4 \\end{pmatrix} = 0.25 I\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\nM = WD = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.6  -0.2 \\end{pmatrix} \\times 0.25 = \\begin{pmatrix} 0.125  -0.075 \\\\ 0.15  -0.05 \\end{pmatrix}\n$$\n为了找到 $M$ 的特征值 $\\lambda$，我们求解特征方程 $\\det(M - \\lambda I) = 0$：\n$$\n\\lambda^2 - \\operatorname{tr}(M)\\lambda + \\det(M) = 0\n$$\n$M$ 的迹和行列式是：\n$$\n\\operatorname{tr}(M) = 0.125 + (-0.05) = 0.075\n$$\n$$\n\\det(M) = (0.125)(-0.05) - (-0.075)(0.15) = -0.00625 + 0.01125 = 0.005\n$$\n特征方程为：\n$$\n\\lambda^2 - 0.075\\lambda + 0.005 = 0\n$$\n这个二次方程的判别式是 $\\Delta = b^2 - 4ac = (-0.075)^2 - 4(1)(0.005) = 0.005625 - 0.02 = -0.014375$。由于 $\\Delta  0$，特征值是一对共轭复数。\n\n对于一个具有共轭复数特征值 $\\lambda_{1,2} = a \\pm ib$ 的 $2 \\times 2$ 矩阵，特征值的乘积是 $\\lambda_1 \\lambda_2 = (a+ib)(a-ib) = a^2 + b^2 = |\\lambda_1|^2 = |\\lambda_2|^2$。这个乘积也等于矩阵的行列式。因此，每个特征值的模是 $\\sqrt{\\det(M)}$。\n\n谱半径 $\\rho(M)$ 是特征值模的最大值。由于两个特征值的模相同，我们有：\n$$\n\\rho(M) = |\\lambda| = \\sqrt{\\det(M)} = \\sqrt{0.005}\n$$\n现在，我们计算数值并四舍五入到四位有效数字：\n$$\n\\rho(M) = \\sqrt{0.005} \\approx 0.070710678...\n$$\n四舍五入到四位有效数字，我们得到 $0.07071$。\n\n由于谱半径 $\\rho(M) \\approx 0.07071$ 小于 $1$，稳定性条件 $\\operatorname{Re}(\\lambda_{WD})  1$ 得到满足，不动点是稳定的。所要求的值是谱半径本身。",
            "answer": "$$\\boxed{0.07071}$$"
        },
        {
            "introduction": "EP 学习的奥秘在于比较两个平衡状态：‘自由’阶段和‘微扰’阶段。最后一个练习  聚焦于微扰阶段，展示了如何将一个高层次的性能目标转化为网络中一个具体的扰动。您将从脉冲计数损失函数推导出‘微扰电流’，揭示将网络温和地引导至期望输出的机制。",
            "id": "4043232",
            "problem": "考虑一个脉冲网络中的单输出神经元，在一个由 $t \\in \\{1,2,\\dots,T\\}$ 索引的离散时间窗口内进行观察，其脉冲序列为 $s_k(t) \\in \\{0,1\\}$。定义一个基于速率的线性读出 $y_k$ 为\n$$\ny_k \\;=\\; \\sum_{t=1}^{T} \\kappa(t)\\, s_k(t),\n$$\n其矩形归一化核为 $\\kappa(t) = \\frac{1}{T}$，适用于所有 $t \\in \\{1,\\dots,T\\}$。针对目标脉冲计数 $\\hat{n}_k$ 的脉冲计数损失为\n$$\n\\mathcal{L}_k \\;=\\; \\big(T\\,y_k - \\hat{n}_k\\big)^{2}.\n$$\n在平衡传播（EP）中，第二阶段通过向与损失直接相关的变量添加微小的微推电流来获得，从而使系统探索一个轻微扰动的稳态。仅从“微推作用是一种与损失函数相对于被微推变量的负梯度成正比的微小外部影响”这一EP核心原则出发，推导出施加于输出神经元 k 相关读出变量的微推电流的闭式解析表达式，该表达式应使用 $T$、$y_k$、$\\hat{n}_k$ 以及微小的正微推强度 $\\beta$ 来表示。然后，为以下具体样本计算其值：$(\\hat{n}_k, T) = (10, 100)$，在时刻 $t \\in \\{5, 20, 35, 50, 65, 80, 95\\}$ 观测到脉冲（即在这些索引处 $s_k(t) = 1$，否则 $s_k(t) = 0$），以及 $\\beta = 0.01$。将最终的电流幅值表示为一个不带单位的实数，且不要进行四舍五入。",
            "solution": "该问题要求在平衡传播（EP）的背景下推导微推电流，并随后针对一个特定的数值示例进行计算。\n\n首先，我们建立理论框架。问题陈述，我们记作 $I_k^{\\text{nudge}}$ 的微推电流，是一种与损失函数 $\\mathcal{L}_k$ 相对于被微推变量（即读出变量 $y_k$）的负梯度成正比的微小外部影响。比例常数是给定的微小正微推强度 $\\beta$。该关系形式化为：\n$$\nI_k^{\\text{nudge}} = -\\beta \\frac{\\partial \\mathcal{L}_k}{\\partial y_k}\n$$\n损失函数由下式给出：\n$$\n\\mathcal{L}_k = (T y_k - \\hat{n}_k)^2\n$$\n为了求得微推电流，我们必须计算 $\\mathcal{L}_k$ 相对于 $y_k$ 的偏导数。使用微分链式法则，我们得到：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = \\frac{\\partial}{\\partial y_k} \\left[ (T y_k - \\hat{n}_k)^2 \\right]\n$$\n令 $u = T y_k - \\hat{n}_k$，则表达式变为 $\\mathcal{L}_k = u^2$。链式法则给出：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = \\frac{d\\mathcal{L}_k}{du} \\frac{\\partial u}{\\partial y_k} = 2u \\cdot \\frac{\\partial}{\\partial y_k}(T y_k - \\hat{n}_k)\n$$\n将 $u$ 代回并对 $y_k$ 求导（将 $T$ 和 $\\hat{n}_k$ 视为常数），得到：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = 2(T y_k - \\hat{n}_k) \\cdot T = 2T(T y_k - \\hat{n}_k)\n$$\n现在，我们将此梯度表达式代回微推电流的公式中：\n$$\nI_k^{\\text{nudge}} = -\\beta \\left[ 2T(T y_k - \\hat{n}_k) \\right] = -2\\beta T(T y_k - \\hat{n}_k)\n$$\n这就是用给定变量 $T$、$y_k$、$\\hat{n}_k$ 和 $\\beta$ 表示的微推电流的闭式解析表达式。\n\n为了更深入地理解，我们可以分析 $T y_k$ 这一项。读出 $y_k$ 定义为 $y_k = \\sum_{t=1}^{T} \\kappa(t) s_k(t)$，其中核为 $\\kappa(t) = \\frac{1}{T}$。代入可得：\n$$\nT y_k = T \\left( \\sum_{t=1}^{T} \\frac{1}{T} s_k(t) \\right) = \\sum_{t=1}^{T} s_k(t)\n$$\n由于 $s_k(t)$ 为 0 或 1，因此总和 $\\sum_{t=1}^{T} s_k(t)$ 是在时间窗口 $\\{1, \\dots, T\\}$ 内观测到的总脉冲数。我们将其记为 $n_k$。因此，$T y_k = n_k$。$(T y_k - \\hat{n}_k)$ 这一量就是观测到的脉冲数 $n_k$ 与目标脉冲数 $\\hat{n}_k$ 之间的误差。微推电流也可以写成 $I_k^{\\text{nudge}} = -2\\beta T(n_k - \\hat{n}_k)$。\n\n接下来，我们计算给定样本的数值：\n- 目标脉冲计数：$\\hat{n}_k = 10$。\n- 时间窗口长度：$T = 100$。\n- 微推强度：$\\beta = 0.01$。\n- 脉冲时刻：$t \\in \\{5, 20, 35, 50, 65, 80, 95\\}$。\n\n首先，我们确定观测到的总脉冲数 $n_k$。给定的脉冲时刻集合包含7个元素，因此神经元发放了7次脉冲。\n$$\nn_k = \\sum_{t=1}^{100} s_k(t) = 7\n$$\n现在我们可以计算读出变量 $y_k$ 的值：\n$$\ny_k = \\frac{n_k}{T} = \\frac{7}{100} = 0.07\n$$\n最后，我们将所有数值代入我们推导出的微推电流表达式中：\n$$\nI_k^{\\text{nudge}} = -2\\beta T(T y_k - \\hat{n}_k)\n$$\n$$\nI_k^{\\text{nudge}} = -2(0.01)(100) \\left( (100)(0.07) - 10 \\right)\n$$\n$$\nI_k^{\\text{nudge}} = -2(1) \\left( 7 - 10 \\right)\n$$\n$$\nI_k^{\\text{nudge}} = -2(-3)\n$$\n$$\nI_k^{\\text{nudge}} = 6\n$$\n施加于读出变量的微推电流的值为 $6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        }
    ]
}