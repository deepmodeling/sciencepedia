{
    "hands_on_practices": [
        {
            "introduction": "The emergence of synchrony from the interaction of individual oscillating units is the cornerstone of the binding hypothesis. This exercise delves into the essential dynamics of how two neural assemblies, modeled as oscillators with potentially different intrinsic frequencies, can achieve phase locking through weak coupling. By applying averaging theory, you will derive the critical conditions for synchronization, providing a foundational understanding of how coherent activity can arise in a neural system .",
            "id": "4037645",
            "problem": "Two weakly coupled neuromorphic oscillators represent two feature-coding assemblies whose binding is realized by phase synchrony. Let the phases of the assemblies be $\\,\\theta_{1}(t)\\,$ and $\\,\\theta_{2}(t)\\,$ with intrinsic angular frequencies $\\,\\omega_{1}\\,$ and $\\,\\omega_{2} = \\omega_{1} + \\Delta\\omega\\,$, respectively. Assume the coupling is sufficiently weak that phase reduction and averaging theory apply: each oscillator’s phase obeys\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega_{i} + \\epsilon\\,Z(\\theta_{i})\\,I(\\theta_{j}), \\quad i\\neq j,\n$$\nwhere $\\,\\epsilon0\\,$ is a small coupling parameter, $\\,Z(\\theta)\\,$ is the $2\\pi$-periodic infinitesimal Phase Response Curve (PRC), and $\\,I(\\theta)\\,$ is the $2\\pi$-periodic interaction waveform induced by the other oscillator’s state. Consider a biologically plausible Type-II PRC and an excitatory interaction dominated by the first Fourier harmonic, modeled as\n$$\nZ(\\theta) = \\cos\\theta, \\qquad I(\\theta) = \\sin\\theta.\n$$\nDefine the phase difference $\\,\\phi(t) = \\theta_{2}(t) - \\theta_{1}(t)\\,$. Using averaging theory over one cycle to leading order in $\\,\\epsilon\\,$, derive the slow dynamics of $\\,\\phi(t)\\,$ and obtain the condition under which phase locking occurs as a function of $\\,\\Delta\\omega\\,$ and the effective coupling strength. Then, for $\\,\\Delta\\omega0\\,$ and positive effective coupling $\\,K0\\,$, compute the stable locked phase difference $\\,\\phi^{\\ast}\\,$ in closed form. Express $\\,\\phi^{\\ast}\\,$ in radians. The final answer must be the analytic expression for $\\,\\phi^{\\ast}\\,$ only.",
            "solution": "The problem provides a system of two weakly coupled neuromorphic oscillators, with their phases $\\theta_{1}(t)$ and $\\theta_{2}(t)$ governed by the following differential equations:\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega_{i} + \\epsilon\\,Z(\\theta_{i})\\,I(\\theta_{j}), \\quad i,j \\in \\{1,2\\}, i\\neq j\n$$\nThe intrinsic angular frequencies are given as $\\omega_{1}$ and $\\omega_{2} = \\omega_{1} + \\Delta\\omega$. The coupling strength $\\epsilon$ is a small positive parameter, $\\epsilon  0$. The Phase Response Curve (PRC) is $Z(\\theta) = \\cos\\theta$ and the interaction function is $I(\\theta) = \\sin\\theta$.\n\nFirst, we write out the explicit equations for the two oscillators:\n$$\n\\frac{d\\theta_{1}}{dt} = \\omega_{1} + \\epsilon\\,Z(\\theta_{1})\\,I(\\theta_{2}) = \\omega_{1} + \\epsilon\\,\\cos(\\theta_{1})\\,\\sin(\\theta_{2})\n$$\n$$\n\\frac{d\\theta_{2}}{dt} = \\omega_{2} + \\epsilon\\,Z(\\theta_{2})\\,I(\\theta_{1}) = \\omega_{2} + \\epsilon\\,\\cos(\\theta_{2})\\,\\sin(\\theta_{1})\n$$\n\nWe are interested in the dynamics of the phase difference, defined as $\\phi(t) = \\theta_{2}(t) - \\theta_{1}(t)$. We find the differential equation for $\\phi(t)$ by taking its time derivative:\n$$\n\\frac{d\\phi}{dt} = \\frac{d\\theta_{2}}{dt} - \\frac{d\\theta_{1}}{dt}\n$$\nSubstituting the expressions for $\\frac{d\\theta_{1}}{dt}$ and $\\frac{d\\theta_{2}}{dt}$:\n$$\n\\frac{d\\phi}{dt} = \\left(\\omega_{2} + \\epsilon\\,\\cos(\\theta_{2})\\,\\sin(\\theta_{1})\\right) - \\left(\\omega_{1} + \\epsilon\\,\\cos(\\theta_{1})\\,\\sin(\\theta_{2})\\right)\n$$\nGroup the terms by $\\omega$ and $\\epsilon$:\n$$\n\\frac{d\\phi}{dt} = (\\omega_{2} - \\omega_{1}) + \\epsilon \\left( \\cos(\\theta_{2})\\,\\sin(\\theta_{1}) - \\cos(\\theta_{1})\\,\\sin(\\theta_{2}) \\right)\n$$\nUsing the definition $\\Delta\\omega = \\omega_{2} - \\omega_{1}$ and the trigonometric identity for the sine of a difference, $\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$:\n$$\n\\frac{d\\phi}{dt} = \\Delta\\omega + \\epsilon \\sin(\\theta_{1} - \\theta_{2})\n$$\nSince $\\phi = \\theta_{2} - \\theta_{1}$, we have $\\theta_{1} - \\theta_{2} = -\\phi$. Therefore:\n$$\n\\frac{d\\phi}{dt} = \\Delta\\omega + \\epsilon \\sin(-\\phi) = \\Delta\\omega - \\epsilon \\sin(\\phi)\n$$\n\nThis equation describes the exact dynamics of the phase difference $\\phi(t)$. In this particular case, because the PRC and interaction functions are given as the first Fourier harmonics, the dynamics of the phase difference decouple exactly from the individual phases. The application of averaging theory, as requested by the problem, is formally required for more general $Z(\\theta)$ and $I(\\theta)$ but in this case leads to the same result. To demonstrate this, let the coupling term be $G(\\theta_1, \\theta_2) = Z(\\theta_2)I(\\theta_1) - Z(\\theta_1)I(\\theta_2)$. We express this in terms of one phase, say $\\theta_1$, and the phase difference $\\phi$, by substituting $\\theta_2 = \\theta_1 + \\phi$:\n$$ G(\\theta_1, \\phi) = \\cos(\\theta_1+\\phi)\\sin(\\theta_1) - \\cos(\\theta_1)\\sin(\\theta_1+\\phi) = \\sin(\\theta_1 - (\\theta_1+\\phi)) = -\\sin(\\phi) $$\nAveraging theory dictates that the slow dynamics of $\\phi$ are governed by averaging the coupling term over the fast variable $\\theta_1$ (over a $2\\pi$ interval):\n$$ \\langle G(\\phi) \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} G(\\theta, \\phi) d\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (-\\sin(\\phi)) d\\theta $$\nSince $-\\sin(\\phi)$ is constant with respect to the integration variable $\\theta$, the average is simply:\n$$ \\langle G(\\phi) \\rangle = -\\sin(\\phi) $$\nThe averaged equation for the slow dynamics of $\\phi$ is thus:\n$$\n\\frac{d\\phi}{dt} = \\Delta\\omega + \\epsilon \\langle G(\\phi) \\rangle = \\Delta\\omega - \\epsilon \\sin(\\phi)\n$$\nThis confirms the previously derived equation, known as the Adler equation.\n\nPhase locking occurs when the phase difference reaches a constant value, $\\phi^{\\ast}$, which is a stable fixed point of the dynamics. At a fixed point, $\\frac{d\\phi}{dt} = 0$:\n$$\n\\Delta\\omega - \\epsilon \\sin(\\phi^{\\ast}) = 0 \\implies \\sin(\\phi^{\\ast}) = \\frac{\\Delta\\omega}{\\epsilon}\n$$\nFor a real solution for $\\phi^{\\ast}$ to exist, the value of the sine function must be within its range $[-1, 1]$. This gives the condition for phase locking:\n$$\n\\left| \\frac{\\Delta\\omega}{\\epsilon} \\right| \\le 1 \\implies |\\Delta\\omega| \\le \\epsilon\n$$\nThe quantity $\\epsilon$ represents the magnitude of the coupling's influence on the phase difference dynamics, and is thus identified as the effective coupling strength. The problem asks to denote this by $K$ in the final part. Let $K = \\epsilon$. Since $\\epsilon  0$, we have $K  0$. The phase locking condition is $|\\Delta\\omega| \\le K$.\n\nTo find the stable locked phase difference, we must analyze the stability of the fixed points. A fixed point $\\phi^{\\ast}$ of the equation $\\frac{d\\phi}{dt} = f(\\phi)$ is stable if $f'(\\phi^{\\ast})  0$. Here, $f(\\phi) = \\Delta\\omega - K \\sin(\\phi)$. The derivative is:\n$$\nf'(\\phi) = \\frac{d}{d\\phi} (\\Delta\\omega - K \\sin(\\phi)) = -K \\cos(\\phi)\n$$\nThe stability condition is therefore $-K \\cos(\\phi^{\\ast})  0$.\n\nThe problem specifies the conditions $\\Delta\\omega  0$ and $K  0$. Under these conditions:\n1.  From the fixed-point equation, $\\sin(\\phi^{\\ast}) = \\frac{\\Delta\\omega}{K}  0$. This implies that $\\phi^{\\ast}$ must be in the first or second quadrant, i.e., $0  \\phi^{\\ast}  \\pi$.\n2.  From the stability condition, since $K  0$, we require $-K \\cos(\\phi^{\\ast})  0$, which simplifies to $\\cos(\\phi^{\\ast})  0$. This implies that $\\phi^{\\ast}$ must be in the first or fourth quadrant.\n\nCombining these two requirements, the stable phase-locked state $\\phi^{\\ast}$ must lie in the first quadrant, where both its sine and cosine are positive. The equation $\\sin(\\phi) = \\frac{\\Delta\\omega}{K}$ has two solutions in the interval $[0, 2\\pi)$:\n- $\\phi_{1}^{\\ast} = \\arcsin\\left(\\frac{\\Delta\\omega}{K}\\right)$\n- $\\phi_{2}^{\\ast} = \\pi - \\arcsin\\left(\\frac{\\Delta\\omega}{K}\\right)$\n\nGiven that $|\\frac{\\Delta\\omega}{K}| \\le 1$ and $\\frac{\\Delta\\omega}{K}  0$, the value of $\\arcsin\\left(\\frac{\\Delta\\omega}{K}\\right)$ is in the interval $(0, \\frac{\\pi}{2}]$.\n- For the first solution, $\\phi_{1}^{\\ast}$, we have $0  \\phi_{1}^{\\ast} \\le \\frac{\\pi}{2}$. In this interval, $\\cos(\\phi_{1}^{\\ast}) \\ge 0$. The stability condition $\\cos(\\phi^{\\ast})0$ is met (excluding the boundary case $|\\Delta\\omega|=K$ where stability is neutral). This is the stable fixed point.\n- For the second solution, $\\phi_{2}^{\\ast}$, we have $\\frac{\\pi}{2} \\le \\phi_{2}^{\\ast}  \\pi$. In this interval, $\\cos(\\phi_{2}^{\\ast}) \\le 0$. The stability condition $\\cos(\\phi^{\\ast})0$ is not met. This is the unstable fixed point.\n\nTherefore, the unique stable locked phase difference under the given conditions is $\\phi^{\\ast} = \\arcsin\\left(\\frac{\\Delta\\omega}{K}\\right)$.",
            "answer": "$$\n\\boxed{\\arcsin\\left(\\frac{\\Delta\\omega}{K}\\right)}\n$$"
        },
        {
            "introduction": "Once synchrony is established, how does it translate into meaningful computation and learning? This practice explores the relationship between oscillatory phase relationships and synaptic plasticity, a mechanism related to Spike-Timing-Dependent Plasticity (STDP). You will analytically derive how the relative phase between two oscillating neurons dictates the change in their connecting synaptic weight, revealing how synchronous firing can selectively strengthen functionally related neural pathways .",
            "id": "4037609",
            "problem": "Consider two neurons, a presynaptic neuron and a postsynaptic neuron, whose spike trains are modeled as independent inhomogeneous Poisson processes with instantaneous rates $\\,\\rho_{\\mathrm{pre}}(t)\\,$ and $\\,\\rho_{\\mathrm{post}}(t)\\,$. The presynaptic rate is $\\,\\rho_{\\mathrm{pre}}(t) = r_{0} + r_{1}\\cos(\\omega t)\\,$ and the postsynaptic rate is $\\,\\rho_{\\mathrm{post}}(t) = r_{0} + r_{1}\\cos(\\omega t + \\phi)\\,$, where $\\,r_{0}  0\\,$ and $\\,r_{1} \\ge 0\\,$ are constants, $\\,\\omega  0\\,$ is the oscillation angular frequency, and $\\,\\phi\\,$ is a phase difference measured in radians.\n\nAssume synaptic plasticity follows a pair-based, synchrony-sensitive learning rule: each presynaptic spike at time $\\,t\\,$ paired with a postsynaptic spike at time $\\,t + \\Delta\\,$ contributes $\\,f(\\Delta)\\,$ to the synaptic weight change, where the learning window $\\,f(\\Delta)\\,$ is an even function emphasizing synchrony, specifically $\\,f(\\Delta) = k \\exp\\!\\big(-|\\Delta|/\\tau\\big)\\,$ with $\\,k  0\\,$ and $\\,\\tau  0\\,$. Over a long observation horizon $\\,T\\,$ encompassing many oscillation periods, the expected total synaptic weight change $\\,\\Delta w\\,$ can be derived from first principles of inhomogeneous Poisson processes and pair-count expectation.\n\nStarting from the fundamental definitions of inhomogeneous Poisson processes and pair-based plasticity, derive the closed-form analytical expression for the long-time average synaptic weight change per unit time,\n$$\\frac{\\Delta w}{T},$$\nin terms of $\\,r_{0}, r_{1}, \\omega, \\phi, k,\\,$ and $\\,\\tau\\,$. Your derivation should explicitly show how the phase dependence arises and identify the term proportional to $\\,\\cos(\\phi)\\,$. Provide your final answer as a single analytic expression. No numerical rounding is required. Angles must be treated in radians.",
            "solution": "The user wants to derive the long-time average synaptic weight change per unit time, $\\frac{\\Delta w}{T}$, for two neurons whose spike trains are modeled as independent inhomogeneous Poisson processes.\n\n**Step 1: Formalism for Expected Weight Change**\n\nThe problem states that a presynaptic spike at time $t$ and a postsynaptic spike at time $s$ contribute a change $f(s-t)$ to the synaptic weight. The two spike trains are independent inhomogeneous Poisson processes with instantaneous rates $\\rho_{\\mathrm{pre}}(t)$ and $\\rho_{\\mathrm{post}}(t)$.\n\nThe probability of a presynaptic spike in an infinitesimal interval $[t, t+dt]$ is $\\rho_{\\mathrm{pre}}(t)dt$. Similarly, the probability of a postsynaptic spike in $[s, s+ds]$ is $\\rho_{\\mathrm{post}}(s)ds$. Due to the independence of the processes, the joint probability of a spike in each interval is the product of their individual probabilities: $\\rho_{\\mathrm{pre}}(t)\\rho_{\\mathrm{post}}(s)dt ds$.\n\nThe total expected weight change, $\\Delta w$, over a long observation interval $[0, T]$ is obtained by integrating the contributions from all possible pairs of presynaptic and postsynaptic spikes within this interval:\n$$\n\\Delta w = \\int_0^T dt \\int_0^T ds \\, f(s-t) \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(s)\n$$\nWe introduce a change of variables, letting $\\Delta = s-t$, which implies $s = t+\\Delta$. The Jacobian of this transformation is $1$. The integral becomes:\n$$\n\\Delta w = \\int_0^T dt \\int_{-t}^{T-t} d\\Delta \\, f(\\Delta) \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta)\n$$\nGiven that the learning window $f(\\Delta)$ is assumed to decay rapidly (governed by $\\tau$), for a long time horizon $T \\gg \\tau$, we can extend the integration limits for $\\Delta$ from $(-\\infty, \\infty)$ without significant error.\n$$\n\\Delta w \\approx \\int_0^T dt \\int_{-\\infty}^{\\infty} d\\Delta \\, f(\\Delta) \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta)\n$$\nBy Fubini's theorem, we can swap the order of integration:\n$$\n\\Delta w \\approx \\int_{-\\infty}^{\\infty} d\\Delta \\, f(\\Delta) \\left[ \\int_0^T dt \\, \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) \\right]\n$$\nThe problem asks for the long-time average weight change per unit time, $\\frac{\\Delta w}{T}$. We compute this by dividing the above expression by $T$ and formally taking the limit $T \\to \\infty$.\n$$\n\\frac{\\Delta w}{T} = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{-\\infty}^{\\infty} d\\Delta \\, f(\\Delta) \\left[ \\int_0^T dt \\, \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) \\right]\n$$\n$$\n\\frac{\\Delta w}{T} = \\int_{-\\infty}^{\\infty} f(\\Delta) \\left[ \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) dt \\right] d\\Delta\n$$\nThe term in the square brackets is the time-averaged cross-correlation of the two rate functions, which we denote as $C(\\Delta)$:\n$$\nC(\\Delta) = \\left\\langle \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) \\right\\rangle_t = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T \\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) dt\n$$\nThus, the expression for the average weight change simplifies to:\n$$\n\\frac{\\Delta w}{T} = \\int_{-\\infty}^{\\infty} f(\\Delta) C(\\Delta) d\\Delta\n$$\n\n**Step 2: Calculation of the Cross-Correlation $C(\\Delta)$**\n\nWe are given the rate functions:\n$$\n\\rho_{\\mathrm{pre}}(t) = r_{0} + r_{1}\\cos(\\omega t)\n$$\n$$\n\\rho_{\\mathrm{post}}(t) = r_{0} + r_{1}\\cos(\\omega t + \\phi)\n$$\nThe product $\\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta)$ is:\n$$\n\\rho_{\\mathrm{pre}}(t) \\rho_{\\mathrm{post}}(t+\\Delta) = \\left(r_{0} + r_{1}\\cos(\\omega t)\\right) \\left(r_{0} + r_{1}\\cos(\\omega (t+\\Delta) + \\phi)\\right)\n$$\nExpanding this product gives four terms:\n$$\nr_0^2 + r_0 r_1 \\cos(\\omega t) + r_0 r_1 \\cos(\\omega t + \\omega\\Delta + \\phi) + r_1^2 \\cos(\\omega t) \\cos(\\omega t + \\omega\\Delta + \\phi)\n$$\nTo find $C(\\Delta)$, we time-average each term over one period of oscillation, $T_{osc} = 2\\pi/\\omega$, as this is equivalent to the long-time average for periodic functions.\n\\begin{itemize}\n    \\item $\\left\\langle r_0^2 \\right\\rangle_t = r_0^2$\n    \\item $\\left\\langle r_0 r_1 \\cos(\\omega t) \\right\\rangle_t = 0$, as the average of a cosine over its period is zero.\n    \\item $\\left\\langle r_0 r_1 \\cos(\\omega t + \\omega\\Delta + \\phi) \\right\\rangle_t = 0$, for the same reason.\n    \\item For the last term, we use the trigonometric identity $\\cos(A)\\cos(B) = \\frac{1}{2}[\\cos(A-B) + \\cos(A+B)]$:\n    $$\n    r_1^2 \\left\\langle \\cos(\\omega t) \\cos(\\omega t + \\omega\\Delta + \\phi) \\right\\rangle_t = \\frac{r_1^2}{2} \\left\\langle \\cos(-\\omega\\Delta - \\phi) + \\cos(2\\omega t + \\omega\\Delta + \\phi) \\right\\rangle_t\n    $$\n    The term $\\cos(2\\omega t + \\omega\\Delta + \\phi)$ averages to zero over time. The term $\\cos(-\\omega\\Delta - \\phi) = \\cos(\\omega\\Delta + \\phi)$ is constant with respect to $t$.\n    Therefore, the average of the last term is $\\frac{r_1^2}{2} \\cos(\\omega\\Delta + \\phi)$.\n\\end{itemize}\nCombining these results, the cross-correlation is:\n$$\nC(\\Delta) = r_0^2 + \\frac{r_1^2}{2} \\cos(\\omega\\Delta + \\phi)\n$$\n\n**Step 3: Evaluating the Final Integral**\n\nWe now substitute $f(\\Delta) = k \\exp(-|\\Delta|/\\tau)$ and the derived $C(\\Delta)$ into the integral for $\\frac{\\Delta w}{T}$:\n$$\n\\frac{\\Delta w}{T} = \\int_{-\\infty}^{\\infty} k \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) \\left[ r_0^2 + \\frac{r_1^2}{2} \\cos(\\omega\\Delta + \\phi) \\right] d\\Delta\n$$\nWe can split this into two parts: a phase-independent part and a phase-dependent part.\n\nPart 1 (Phase-independent):\n$$\n\\int_{-\\infty}^{\\infty} k \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) r_0^2 d\\Delta = k r_0^2 \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) d\\Delta\n$$\nThe integrand is an even function, so the integral is:\n$$\nk r_0^2 \\left[ 2 \\int_{0}^{\\infty} \\exp\\left(-\\frac{\\Delta}{\\tau}\\right) d\\Delta \\right] = 2 k r_0^2 \\left[ -\\tau \\exp\\left(-\\frac{\\Delta}{\\tau}\\right) \\right]_0^{\\infty} = 2 k r_0^2 (-\\tau(0-1)) = 2 k r_0^2 \\tau\n$$\n\nPart 2 (Phase-dependent):\n$$\n\\int_{-\\infty}^{\\infty} k \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) \\frac{r_1^2}{2} \\cos(\\omega\\Delta + \\phi) d\\Delta\n$$\nUsing the identity $\\cos(\\omega\\Delta + \\phi) = \\cos(\\omega\\Delta)\\cos(\\phi) - \\sin(\\omega\\Delta)\\sin(\\phi)$, the integral becomes:\n$$\n\\frac{k r_1^2}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) \\left[ \\cos(\\omega\\Delta)\\cos(\\phi) - \\sin(\\omega\\Delta)\\sin(\\phi) \\right] d\\Delta\n$$\nThe function $\\exp(-|\\Delta|/\\tau)$ is even. The function $\\sin(\\omega\\Delta)$ is odd. Their product, $\\exp(-|\\Delta|/\\tau)\\sin(\\omega\\Delta)$, is an odd function. The integral of an odd function over the symmetric interval $(-\\infty, \\infty)$ is zero. Thus, the $\\sin(\\phi)$ term vanishes. We are left with the term proportional to $\\cos(\\phi)$:\n$$\n\\frac{k r_1^2}{2} \\cos(\\phi) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{|\\Delta|}{\\tau}\\right) \\cos(\\omega\\Delta) d\\Delta\n$$\nThe integrand is again an even function, so we have:\n$$\n\\frac{k r_1^2}{2} \\cos(\\phi) \\left[ 2 \\int_{0}^{\\infty} \\exp\\left(-\\frac{\\Delta}{\\tau}\\right) \\cos(\\omega\\Delta) d\\Delta \\right] = k r_1^2 \\cos(\\phi) \\int_{0}^{\\infty} \\exp\\left(-\\frac{\\Delta}{\\tau}\\right) \\cos(\\omega\\Delta) d\\Delta\n$$\nThis is a standard integral, recognizable as the real part of the Fourier transform of a one-sided exponential, or the Laplace transform of $\\cos(\\omega\\Delta)$ evaluated at $s=1/\\tau$. The result is:\n$$\n\\int_{0}^{\\infty} \\exp(-s\\Delta) \\cos(\\omega\\Delta) d\\Delta = \\frac{s}{s^2 + \\omega^2}\n$$\nSubstituting $s = 1/\\tau$:\n$$\n\\frac{1/\\tau}{(1/\\tau)^2 + \\omega^2} = \\frac{1/\\tau}{(1+\\omega^2\\tau^2)/\\tau^2} = \\frac{\\tau}{1+\\omega^2\\tau^2}\n$$\nSo, Part 2 evaluates to:\n$$\nk r_1^2 \\cos(\\phi) \\frac{\\tau}{1+\\omega^2\\tau^2}\n$$\n\n**Step 4: Final Expression**\n\nCombining Part 1 and Part 2 gives the final expression for the long-time average synaptic weight change per unit time:\n$$\n\\frac{\\Delta w}{T} = 2 k r_0^2 \\tau + \\frac{k r_1^2 \\tau}{1+\\omega^2\\tau^2} \\cos(\\phi)\n$$\nThis expression can be factored to give the final closed-form result:\n$$\n\\frac{\\Delta w}{T} = k\\tau \\left( 2 r_0^2 + \\frac{r_1^2}{1+\\omega^2\\tau^2} \\cos(\\phi) \\right)\n$$\nThe derivation explicitly shows that the phase dependence arises from the cross-correlation of the oscillatory components of the firing rates. The term proportional to $\\cos(\\phi)$ is precisely the second term in the sum, originating from the interaction between the oscillatory modulation of the pre- and postsynaptic activities, filtered by the learning window.",
            "answer": "$$\n\\boxed{k\\tau \\left( 2r_0^2 + \\frac{r_1^2}{1 + \\omega^2\\tau^2}\\cos(\\phi) \\right)}\n$$"
        },
        {
            "introduction": "To fully appreciate the binding-by-synchrony hypothesis, we must see it in action at the network level, where multiple objects must be represented simultaneously but separately. This computational practice challenges you to simulate a network of oscillator modules using the Kuramoto model, a canonical framework for studying synchronization. By carefully tuning intra- and inter-module coupling, you will create a state of \"cluster synchronization\" that serves as a powerful model for how the brain can bind features within an object while segregating it from others .",
            "id": "4037690",
            "problem": "You are to design and implement a simulation that demonstrates cluster synchronization in a network of weakly coupled phase oscillators, formalized within the Kuramoto framework, to model binding by synchrony with minimal cross-talk between modules. The core requirement is that modules synchronize internally while avoiding global synchronization across the entire network, thereby representing separate objects that are bound internally but remain distinct from each other. The angles must be treated in radians, time in seconds, and natural frequencies in radians per second. The program must produce a single-line output in the exact format specified at the end.\n\nUse the following fundamental base:\n- The Kuramoto model consists of $N$ phase oscillators with phases $\\theta_i(t)$, natural frequencies $\\omega_i$, and a coupling matrix $K_{ij}$. The dynamics are\n$$\n\\frac{d\\theta_i}{dt} = \\omega_i + \\sum_{j=1}^{N} K_{ij} \\sin\\big(\\theta_j(t) - \\theta_i(t)\\big).\n$$\n- The global Kuramoto order parameter at time $t$ is\n$$\nR_{\\text{global}}(t) = \\left| \\frac{1}{N} \\sum_{i=1}^{N} e^{\\mathrm{i}\\,\\theta_i(t)} \\right|.\n$$\n- For a module $m$ with index set $\\mathcal{M}_m$, the module order parameter at time $t$ is\n$$\nR_m(t) = \\left| \\frac{1}{|\\mathcal{M}_m|} \\sum_{i \\in \\mathcal{M}_m} e^{\\mathrm{i}\\,\\theta_i(t)} \\right|.\n$$\n- The module mean phase is\n$$\n\\phi_m(t) = \\arg\\left( \\frac{1}{|\\mathcal{M}_m|} \\sum_{i \\in \\mathcal{M}_m} e^{\\mathrm{i}\\,\\theta_i(t)} \\right).\n$$\n- The inter-module phase-locking value between modules $a$ and $b$ over a time window with samples at times $\\{t_k\\}$ is defined as\n$$\n\\mathrm{PLV}_{a,b} = \\left| \\frac{1}{K} \\sum_{k=1}^{K} e^{\\mathrm{i}\\,[\\phi_a(t_k) - \\phi_b(t_k)]} \\right|.\n$$\n\nYour task is to:\n- Implement a numerical integrator to simulate the Kuramoto model with Euler forward method using time step $\\Delta t$.\n- Construct coupling matrices with block structure: intra-module couplings are uniform and equal to $K_{\\text{intra}}$ (excluding self-coupling), and inter-module couplings are uniform and equal to $K_{\\text{inter}}$.\n- Initialize phases $\\theta_i(0)$ uniformly at random on $[0,2\\pi)$.\n- Assign natural frequencies $\\omega_i$ per module from a normal distribution with specified mean $\\mu_m$ and standard deviation $\\sigma_m$.\n- After simulating for duration $T$, compute the time-averaged global order parameter $\\overline{R}_{\\text{global}}$, module order parameters $\\overline{R}_m$, and maximum inter-module phase-locking value $\\max_{a \\neq b} \\mathrm{PLV}_{a,b}$ using the last half of the simulation samples (to exclude transients).\n- Define a binary decision per test case indicating successful cluster synchronization with minimal cross-talk if all of the following are satisfied:\n  1. Each module’s time-averaged order parameter satisfies $\\overline{R}_m \\geq r_{\\text{intra}}$,\n  2. The time-averaged global order parameter satisfies $\\overline{R}_{\\text{global}} \\leq r_{\\text{global}}$,\n  3. The maximum inter-module phase-locking value satisfies $\\max_{a \\neq b} \\mathrm{PLV}_{a,b} \\leq p_{\\text{max}}$.\n- Use thresholds $r_{\\text{intra}} = 0.8$, $r_{\\text{global}} = 0.6$, and $p_{\\text{max}} = 0.4$.\n\nAngles are in radians, time in seconds, and natural frequencies in radians per second. The numerical integration must use $\\Delta t$ in seconds. Express all thresholds and coupling constants as unitless scalars. Your implementation must be deterministic; fix the pseudo-random generator seed to ensure reproducibility.\n\nTest suite and parameterization:\nImplement the following $5$ test cases. Each case is specified by the tuple $(\\text{modules}, K_{\\text{intra}}, K_{\\text{inter}}, \\{\\mu_m\\}, \\{\\sigma_m\\}, \\Delta t, T)$ where $\\text{modules}$ is the list of module sizes that sum to $N$.\n\n- Case $1$ (happy path, two distinct modules, small inter-module coupling):\n  - $\\text{modules} = [10, 10]$,\n  - $K_{\\text{intra}} = 0.9$,\n  - $K_{\\text{inter}} = 0.05$,\n  - $\\{\\mu_m\\} = [1.5, 2.0]$,\n  - $\\{\\sigma_m\\} = [0.05, 0.05]$,\n  - $\\Delta t = 0.01$,\n  - $T = 20.0$.\n- Case $2$ (boundary tending to global synchrony due to stronger inter-module coupling):\n  - $\\text{modules} = [10, 10]$,\n  - $K_{\\text{intra}} = 0.9$,\n  - $K_{\\text{inter}} = 0.35$,\n  - $\\{\\mu_m\\} = [1.5, 2.0]$,\n  - $\\{\\sigma_m\\} = [0.05, 0.05]$,\n  - $\\Delta t = 0.01$,\n  - $T = 20.0$.\n- Case $3$ (edge case with zero inter-module coupling):\n  - $\\text{modules} = [10, 10]$,\n  - $K_{\\text{intra}} = 0.9$,\n  - $K_{\\text{inter}} = 0.0$,\n  - $\\{\\mu_m\\} = [1.5, 2.0]$,\n  - $\\{\\sigma_m\\} = [0.05, 0.05]$,\n  - $\\Delta t = 0.01$,\n  - $T = 20.0$.\n- Case $4$ (heterogeneous module sizes and moderate inter-module coupling):\n  - $\\text{modules} = [12, 8]$,\n  - $K_{\\text{intra}} = 0.8$,\n  - $K_{\\text{inter}} = 0.1$,\n  - $\\{\\mu_m\\} = [1.7, 2.2]$,\n  - $\\{\\sigma_m\\} = [0.03, 0.03]$,\n  - $\\Delta t = 0.01$,\n  - $T = 20.0$.\n- Case $5$ (three modules with distinct mean frequencies and small inter-module coupling):\n  - $\\text{modules} = [8, 8, 8]$,\n  - $K_{\\text{intra}} = 0.9$,\n  - $K_{\\text{inter}} = 0.02$,\n  - $\\{\\mu_m\\} = [1.2, 1.6, 2.1]$,\n  - $\\{\\sigma_m\\} = [0.04, 0.04, 0.04]$,\n  - $\\Delta t = 0.01$,\n  - $T = 20.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$), where each $\\text{result}$ is a boolean indicating whether the case achieves cluster synchronization with minimal cross-talk under the above criteria.",
            "solution": "The problem statement is assessed to be valid. It presents a well-defined task in computational neuroscience, grounded in the established Kuramoto model of coupled oscillators. The objectives, parameters, and evaluation criteria are specified with sufficient precision to permit a unique and verifiable solution. The problem requires the simulation of a system of ordinary differential equations and subsequent data analysis, which is a standard procedure in quantitative scientific investigation.\n\nA minor ambiguity exists regarding the units of the coupling constants $K_{\\text{intra}}$ and $K_{\\text{inter}}$. The governing differential equation,\n$$\n\\frac{d\\theta_i}{dt} = \\omega_i + \\sum_{j=1}^{N} K_{ij} \\sin\\big(\\theta_j(t) - \\theta_i(t)\\big)\n$$\nrequires that the coupling constant $K_{ij}$ possess units of frequency (e.g., rad/s) for dimensional consistency, as both $\\frac{d\\theta_i}{dt}$ and the natural frequency $\\omega_i$ are in rad/s, and the sine function is dimensionless. However, the problem describes these constants as \"unitless scalars.\" This is a common convention in the field where coupling strengths are implicitly understood to be in units of frequency or have been non-dimensionalized with respect to a reference frequency. Given the context and specified values for $\\omega_i$, it is appropriate to interpret the values of $K$ as being in rad/s. This slight imprecision does not invalidate the problem, as it is resolvable through standard interpretation. All other aspects of the problem are clear, consistent, and scientifically sound.\n\nThe solution proceeds by first constructing the model, then simulating its dynamics, and finally analyzing the results according to the specified criteria.\n\n**1. Model Construction**\n\nThe system consists of $N$ oscillators, partitioned into distinct modules. The total number of oscillators $N$ is the sum of the sizes of all modules specified in a given test case.\n\n**Natural Frequencies ($\\omega_i$):**\nFor each oscillator $i$ belonging to a module $m$, its natural frequency $\\omega_i$ is drawn from a normal distribution $\\mathcal{N}(\\mu_m, \\sigma_m^2)$, where $\\mu_m$ is the mean frequency and $\\sigma_m$ is the standard deviation for that module. The differences in mean frequencies between modules are critical for establishing distinct synchronized clusters.\n\n**Coupling Matrix ($K_{ij}$):**\nThe interactions between oscillators are defined by the $N \\times N$ coupling matrix $K$. This matrix is constructed with a block structure to reflect the modular organization of the network.\n- For any two distinct oscillators $i$ and $j$ within the same module, the coupling strength is uniform and set to $K_{ij} = K_{\\text{intra}}$.\n- For any two oscillators $i$ and $j$ in different modules, the coupling strength is uniform and set to $K_{ij} = K_{\\text{inter}}$.\n- Self-coupling is excluded, so the diagonal elements are $K_{ii} = 0$.\nThe condition $K_{\\text{intra}} \\gg K_{\\text{inter}}$ is expected to promote strong synchronization within modules while maintaining relative independence between them.\n\n**Initial Conditions ($\\theta_i(0)$):**\nThe initial phase of each oscillator, $\\theta_i(0)$, is drawn independently from a uniform random distribution on the interval $[0, 2\\pi)$. This corresponds to an initially incoherent state for the entire network.\n\n**2. Numerical Simulation**\n\nThe system of coupled ordinary differential equations is solved numerically using the forward Euler method. Given a time step $\\Delta t$, the phase of each oscillator at time $t + \\Delta t$ is approximated from its state at time $t$:\n$$\n\\theta_i(t+\\Delta t) = \\theta_i(t) + \\Delta t \\cdot \\left( \\omega_i + \\sum_{j=1}^{N} K_{ij} \\sin(\\theta_j(t) - \\theta_i(t)) \\right)\n$$\nAfter each update step, the phases are wrapped to stay within the $[0, 2\\pi)$ interval using the modulo operator to handle the periodic nature of angles. The simulation is run for a total duration of $T$.\n\n**3. Analysis and Evaluation**\n\nTo ensure the analysis reflects the steady-state behavior of the system, all metrics are computed using data from the second half of the simulation, from $t = T/2$ to $t = T$, thus discarding initial transients.\n\n**Order Parameters:**\nThe degree of synchronization is quantified using the Kuramoto order parameter. For a set of oscillators with phases $\\{\\psi_k\\}$, the order parameter is $R = |\\frac{1}{L} \\sum_{k=1}^{L} e^{\\mathrm{i}\\psi_k}|$, where $L$ is the number of oscillators in the set. A value of $R \\approx 1$ indicates strong synchrony, while $R \\approx 0$ signifies incoherence. We compute:\n- The **global order parameter**, $R_{\\text{global}}(t)$, calculated over all $N$ oscillators.\n- The **module order parameter**, $R_m(t)$, calculated for each module $m$ over its constituent oscillators.\nThese are then time-averaged over the analysis window to yield $\\overline{R}_{\\text{global}}$ and $\\overline{R}_m$.\n\n**Inter-Module Phase-Locking Value (PLV):**\nTo measure the synchrony *between* modules, we first compute the mean phase of each module $m$ at each time step $t_k$ in the analysis window:\n$$\n\\phi_m(t_k) = \\arg\\left( \\frac{1}{|\\mathcal{M}_m|} \\sum_{i \\in \\mathcal{M}_m} e^{\\mathrm{i}\\,\\theta_i(t_k)} \\right)\n$$\nThe PLV between two modules, $a$ and $b$, is then the magnitude of the time-averaged phase difference vector:\n$$\n\\mathrm{PLV}_{a,b} = \\left| \\frac{1}{K} \\sum_{k=1}^{K} e^{\\mathrm{i}\\,[\\phi_a(t_k) - \\phi_b(t_k)]} \\right|\n$$\nwhere the sum is over all $K$ time samples in the analysis window. We find the maximum PLV across all distinct pairs of modules, $\\max_{a \\neq b} \\mathrm{PLV}_{a,b}$.\n\n**Decision Criteria:**\nA test case is classified as demonstrating successful cluster synchronization if and only if all three of the following conditions are met:\n1.  _High Intra-Module Cohesion_: $\\overline{R}_m \\geq r_{\\text{intra}}$ for all modules $m$, with $r_{\\text{intra}} = 0.8$.\n2.  _Low Global Cohesion_: $\\overline{R}_{\\text{global}} \\leq r_{\\text{global}}$, with $r_{\\text{global}} = 0.6$.\n3.  _Low Inter-Module Cross-Talk_: $\\max_{a \\neq b} \\mathrm{PLV}_{a,b} \\leq p_{\\text{max}}$, with $p_{\\text{max}} = 0.4$.\n\nThe implementation will process each of the five test cases, apply this logic, and return a boolean result for each. A fixed seed for the pseudo-random number generator ensures deterministic and reproducible results.",
            "answer": "```python\nimport numpy as np\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for Kuramoto model cluster synchronization.\n    \"\"\"\n    # Fix the pseudo-random generator seed for reproducibility.\n    # This ensures that initial phases and natural frequencies are the same for each run.\n    np.random.seed(0)\n\n    # Define the test cases as specified in the problem statement.\n    # Each case: (modules, K_intra, K_inter, {mu_m}, {sigma_m}, dt, T)\n    test_cases = [\n        # Case 1: Happy path\n        ([10, 10], 0.9, 0.05, [1.5, 2.0], [0.05, 0.05], 0.01, 20.0),\n        # Case 2: Tending to global sync\n        ([10, 10], 0.9, 0.35, [1.5, 2.0], [0.05, 0.05], 0.01, 20.0),\n        # Case 3: Zero inter-coupling\n        ([10, 10], 0.9, 0.0, [1.5, 2.0], [0.05, 0.05], 0.01, 20.0),\n        # Case 4: Heterogeneous modules\n        ([12, 8], 0.8, 0.1, [1.7, 2.2], [0.03, 0.03], 0.01, 20.0),\n        # Case 5: Three modules\n        ([8, 8, 8], 0.9, 0.02, [1.2, 1.6, 2.1], [0.04, 0.04, 0.04], 0.01, 20.0),\n    ]\n\n    # Thresholds for success criteria\n    r_intra = 0.8\n    r_global = 0.6\n    p_max = 0.4\n    \n    results = []\n    for case_params in test_cases:\n        result = run_kuramoto_simulation(case_params, r_intra, r_global, p_max)\n        results.append(result)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_kuramoto_simulation(params, r_intra, r_global, p_max):\n    \"\"\"\n    Runs a single simulation of the Kuramoto model and evaluates cluster synchronization.\n    \"\"\"\n    module_sizes, K_intra, K_inter, mus, sigmas, dt, T = params\n    \n    # 1. Initialization\n    num_modules = len(module_sizes)\n    N = sum(module_sizes)\n    \n    # Generate module indices for each oscillator\n    module_indices = []\n    start_idx = 0\n    for size in module_sizes:\n        module_indices.append(list(range(start_idx, start_idx + size)))\n        start_idx += size\n\n    # Natural frequencies (omega)\n    omega = np.zeros(N)\n    for i in range(num_modules):\n        omega[module_indices[i]] = np.random.normal(mus[i], sigmas[i], module_sizes[i])\n        \n    # Initial phases (theta)\n    theta = np.random.uniform(0, 2 * np.pi, N)\n    \n    # Coupling matrix (K)\n    K = np.full((N, N), K_inter)\n    for i in range(num_modules):\n        idx = np.ix_(module_indices[i], module_indices[i])\n        K[idx] = K_intra\n    np.fill_diagonal(K, 0)\n\n    # 2. Simulation\n    num_steps = int(T / dt)\n    analysis_start_step = num_steps // 2\n    \n    # History storage for analysis window\n    history_len = num_steps - analysis_start_step\n    R_global_hist = np.zeros(history_len)\n    R_modules_hist = np.zeros((num_modules, history_len))\n    phi_modules_hist = np.zeros((num_modules, history_len))\n\n    for step in range(num_steps):\n        # Calculate phase differences (theta_j - theta_i) efficiently\n        phase_diffs = theta - theta[:, np.newaxis]\n        \n        # Calculate sum term of the ODE\n        interaction_term = np.sum(K * np.sin(phase_diffs), axis=1)\n        \n        # Update phases using Euler forward method\n        theta = (theta + dt * (omega + interaction_term)) % (2 * np.pi)\n        \n        # Store metrics if in analysis window\n        if step >= analysis_start_step:\n            hist_idx = step - analysis_start_step\n            \n            # Global order parameter\n            R_global_hist[hist_idx] = np.abs(np.mean(np.exp(1j * theta)))\n            \n            # Module-specific order parameters and mean phases\n            for m in range(num_modules):\n                module_theta = theta[module_indices[m]]\n                mean_phasor = np.mean(np.exp(1j * module_theta))\n                R_modules_hist[m, hist_idx] = np.abs(mean_phasor)\n                phi_modules_hist[m, hist_idx] = np.angle(mean_phasor)\n\n    # 3. Analysis and Evaluation\n    \n    # Time-averaged global order parameter\n    avg_R_global = np.mean(R_global_hist)\n    \n    # Time-averaged module order parameters\n    avg_R_modules = np.mean(R_modules_hist, axis=1)\n    \n    # Maximum inter-module Phase-Locking Value (PLV)\n    max_plv = 0.0\n    if num_modules > 1:\n        plv_values = []\n        for m1, m2 in combinations(range(num_modules), 2):\n            phase_diff_hist = phi_modules_hist[m1, :] - phi_modules_hist[m2, :]\n            plv = np.abs(np.mean(np.exp(1j * phase_diff_hist)))\n            plv_values.append(plv)\n        if plv_values:\n            max_plv = np.max(plv_values)\n\n    # 4. Decision Logic\n    cond1 = np.all(avg_R_modules >= r_intra)\n    cond2 = avg_R_global = r_global\n    cond3 = max_plv = p_max\n    \n    return cond1 and cond2 and cond3\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}