{
    "hands_on_practices": [
        {
            "introduction": "神经形态计算的一个核心驱动力是其卓越的能量效率，这在移动机器人和边缘设备等功耗受限的应用中至关重要。本练习将这一抽象概念与物理现实联系起来，通过一个假设的理想模型，从第一性原理出发，推导为神经元膜电容充电以产生一次脉冲所需的基本能量。通过完成这项实践，您将对基于脉冲的计算在硬件层面上的低功耗优势有一个更具体的理解。",
            "id": "4052832",
            "problem": "一个腿式机器人使用一个片上神经形态控制器，该控制器由泄漏积分-发放（LIF）类型的脉冲神经元实现。每个神经元的膜被建模为一个理想的线性电容器，其电容为 $C_{\\mathrm{m}}$，连接在膜节点和参考地之间。一个不应期复位电路在脉冲之间将膜完全放电至地，因此在每次新的上升行程之前，膜电压为 $v(0)=0$。导致达到阈值的上升行程由一个理想的高顺应性跨导级产生，该级从能量储存库向膜节点提供电流，因此在上升行程期间没有电阻或泄漏损耗，所有输送的电能都存储在膜电容器的电场中。在膜电压 $v(T)=V_{\\mathrm{p}}$ 时发生阈值穿越，其中 $V_{\\mathrm{p}}$ 是上升行程结束时脉冲的峰值（相对于地）。\n\n仅使用电容器本构定律 $q=C v$、电流定义 $i=\\mathrm{d}q/\\mathrm{d}t$ 以及瞬时功率定义 $p=v\\,i$，从第一性原理推导一个闭式解析表达式，用于计算在从 $v(0)=0$ 到 $v(T)=V_{\\mathrm{p}}$ 的上升行程期间从源端获取的能量。然后，对于一个硬件神经元，其参数为 $C_{\\mathrm{m}}=8\\times 10^{-12}$ 和 $V_{\\mathrm{p}}=0.12$，计算该能量。以焦耳为单位表示最终能量，并将答案四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它科学地基于电路理论的基本原理，问题陈述良好，信息充足，可得到唯一解，并使用客观、明确的语言进行陈述。给定的值对于神经形态硬件实现是物理上现实的。\n\n目标是推导在神经元膜电容 $C_{\\mathrm{m}}$ 从初始电压 $v(0)=0$ 充电到最终峰值电压 $v(T)=V_{\\mathrm{p}}$ 期间，从源端获取的总能量 $E$ 的表达式。我们被要求仅使用电荷、电流和功率的基本关系。问题陈述在上升行程期间，没有电阻或泄漏损耗，所有输送的电能都存储在膜电容器的电场中。这意味着从源端获取的能量等于存储在电容器中的能量。\n\n总能量 $E$ 是瞬时功率 $p(t)$ 在事件持续时间（从 $t=0$ 到 $t=T$）上的时间积分。\n$$\nE = \\int_{0}^{T} p(t) \\, \\mathrm{d}t\n$$\n问题提供了瞬时功率的定义为 $p(t) = v(t) i(t)$，其中 $v(t)$ 是瞬时膜电压，$i(t)$ 是流入膜的瞬时电流。将此代入能量积分中得到：\n$$\nE = \\int_{0}^{T} v(t) i(t) \\, \\mathrm{d}t\n$$\n接下来，我们必须用电压 $v(t)$ 和电容 $C_{\\mathrm{m}}$ 来表示电流 $i(t)$。我们已知电流的定义 $i(t) = \\frac{\\mathrm{d}q}{\\mathrm{d}t}$ 和电容器的本构定律 $q(t) = C_{\\mathrm{m}} v(t)$，其中 $C_{\\mathrm{m}}$ 是一个常数。通过对本构定律关于时间求导，我们得到电流：\n$$\ni(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( C_{m} v(t) \\right) = C_{\\mathrm{m}} \\frac{\\mathrm{d}v}{\\mathrm{d}t}\n$$\n现在，将这个 $i(t)$ 的表达式代回能量积分中：\n$$\nE = \\int_{0}^{T} v(t) \\left( C_{\\mathrm{m}} \\frac{\\mathrm{d}v}{\\mathrm{d}t} \\right) \\, \\mathrm{d}t\n$$\n由于 $C_{\\mathrm{m}}$ 是一个常数，它可以移到积分符号外面。我们也可以重新排列被积函数中的项：\n$$\nE = C_{\\mathrm{m}} \\int_{0}^{T} v(t) \\frac{\\mathrm{d}v}{\\mathrm{d}t} \\, \\mathrm{d}t\n$$\n为了求解这个积分，我们进行变量替换，从时间 $t$ 变为电压 $v$。微分元 $\\mathrm{d}v$ 与 $\\mathrm{d}t$ 的关系为 $\\mathrm{d}v = \\frac{\\mathrm{d}v}{\\mathrm{d}t} \\mathrm{d}t$。我们还必须改变积分的上下限。在下限 $t=0$ 时，电压为 $v(0)=0$。在上限 $t=T$ 时，电压为 $v(T)=V_{\\mathrm{p}}$。积分变换如下：\n$$\nE = C_{\\mathrm{m}} \\int_{v(0)}^{v(T)} v \\, \\mathrm{d}v = C_{\\mathrm{m}} \\int_{0}^{V_{\\mathrm{p}}} v \\, \\mathrm{d}v\n$$\n这是一个标准积分。$v$ 相对于 $v$ 的反导数是 $\\frac{1}{2}v^2$。在新限下计算这个反导数：\n$$\nE = C_{\\mathrm{m}} \\left[ \\frac{1}{2} v^2 \\right]_{0}^{V_{\\mathrm{p}}}\n$$\n$$\nE = C_{\\mathrm{m}} \\left( \\frac{1}{2} V_{\\mathrm{p}}^2 - \\frac{1}{2} (0)^2 \\right)\n$$\n这简化为能量的最终闭式解析表达式：\n$$\nE = \\frac{1}{2} C_{\\mathrm{m}} V_{\\mathrm{p}}^2\n$$\n这是理想线性电容器充电至电压 $V_{\\mathrm{p}}$ 时所储存能量的著名表达式。\n\n问题接着要求计算一个硬件神经元的能量，其电容 $C_{\\mathrm{m}} = 8 \\times 10^{-12}$ 法拉，峰值电压 $V_{\\mathrm{p}} = 0.12$ 伏特。将这些值代入我们推导的表达式中：\n$$\nE = \\frac{1}{2} (8 \\times 10^{-12} \\, \\text{F}) (0.12 \\, \\text{V})^2\n$$\n$$\nE = (4 \\times 10^{-12}) (0.0144) \\, \\text{J}\n$$\n$$\nE = 5.76 \\times 10^{-14} \\, \\text{J}\n$$\n问题要求答案以焦耳表示，并四舍五入到四位有效数字。计算值 $5.76 \\times 10^{-14}$ 有三位有效数字。为了用四位有效数字表示，我们追加一个零。\n$$\nE = 5.760 \\times 10^{-14} \\, \\text{J}\n$$",
            "answer": "$$\n\\boxed{5.760 \\times 10^{-14}}\n$$"
        },
        {
            "introduction": "拥有了高效的脉冲神经元模型后，下一个关键问题是如何训练它们来执行有用的控制任务。脉冲神经网络（SNN）的主要挑战在于其核心的脉冲生成机制（一个阶跃函数）是不可微的，这阻碍了标准梯度下降方法的直接应用。本练习将引导您推导代理梯度，这是一种强大的技术，它通过在反向传播过程中使用一个平滑的、可微的函数来近似脉冲神经元的导数，从而实现在SNN中进行基于梯度的学习。",
            "id": "4052813",
            "problem": "一个神经拟态机器人采用一个实现为漏电积分-发放 (LIF) 单元的单神经元控制器，以根据基于事件的感觉输入来调节电机指令。膜电位 $u[t]$ 根据以下公式在离散时间内演化：\n$$\nu[t+1] = \\lambda\\,u[t] + w\\,x[t] - V_{\\mathrm{th}}\\,z[t],\n$$\n其中 $t \\in \\{1,2,\\dots,T\\}$ 是离散时间索引，$\\lambda \\in (0,1)$ 是泄漏因子，$w \\in \\mathbb{R}$ 是乘以突触前输入 $x[t] \\in \\mathbb{R}$ 的突触权重，$V_{\\mathrm{th}} \\in \\mathbb{R}$ 是发放阈值，而 $z[t] \\in \\{0,1\\}$ 是在时间 $t$ 由阈值非线性 $z[t] = H(u[t] - V_{\\mathrm{th}})$ 生成的脉冲，其中 $H(\\cdot)$ 表示亥维赛阶跃函数。初始条件 $u[1] = u_{0}$ 与 $w$ 无关。控制目标引出一个可微损失 $L(z[1],\\dots,z[T])$，它依赖于脉冲序列 $\\{z[t]\\}_{t=1}^{T}$。\n\n由于阈值非线性 $H(\\cdot)$ 不可微，因此使用代理梯度。假设一个平滑的伪导数\n$$\ng(u) = \\frac{1}{\\delta\\sqrt{\\pi}}\\,\\exp\\!\\left(-\\left(\\frac{u - V_{\\mathrm{th}}}{\\delta}\\right)^{2}\\right),\n$$\n其平滑参数 $\\delta  0$，用于在随时间反向传播 (BPTT) 中近似 $\\frac{d}{du}H(u - V_{\\mathrm{th}})$。为了稳定性，在状态动态中采用分离重置假设：当对 $u[t+1]$ 关于 $w$ 求导时，将 $z[t]$ 视为常数，这样梯度就不会流经重置项 $-V_{\\mathrm{th}}\\,z[t]$。\n\n从这些定义和假设出发，依据第一性原理推导梯度 $\\frac{dL}{dw}$ 的一个闭式解析表达式，该表达式用 $\\lambda$、$x[1],\\dots,x[T]$、$u[1],\\dots,u[T]$、$V_{\\mathrm{th}}$ 和 $\\delta$ 表示。你的最终答案必须是单一的解析表达式。不需要进行数值评估。",
            "solution": "目标是推导损失函数 $L$ 相对于突触权重 $w$ 的梯度的闭式解析表达式，记为 $\\frac{dL}{dw}$。损失 $L$ 是脉冲序列 $\\{z[t]\\}_{t=1}^{T}$ 的函数，其中每个脉冲 $z[t]$ 由膜电位 $u[t]$ 生成。权重 $w$ 影响所有 $t > 1$ 的 $u[t]$。\n\n我们首先应用全导数的链式法则。损失 $L$ 是 $z[1], \\dots, z[T]$ 的显式函数。$w$ 的变化会影响所有的 $u[t]$（对于 $t > 1$）并因此影响所有的 $z[t]$（对于 $t > 1$）。全导数 $\\frac{dL}{dw}$ 是 $w$ 通过每个脉冲 $z[t]$ 对 $L$ 影响的总和：\n$$\n\\frac{dL}{dw} = \\sum_{t=1}^{T} \\frac{\\partial L}{\\partial z[t]} \\frac{dz[t]}{dw}\n$$\n项 $\\frac{\\partial L}{\\partial z[t]}$ 表示从损失函数反向传播到时间 $t$ 的脉冲输出的误差信号。我们将其视为一个已知量。\n\n接下来，我们求脉冲序列的导数 $\\frac{dz[t]}{dw}$。由于 $z[t]$ 是 $u[t]$ 的函数，而 $u[t]$ 又依赖于 $w$，我们再次应用链式法则：\n$$\n\\frac{dz[t]}{dw} = \\frac{dz[t]}{du[t]} \\frac{du[t]}{dw}\n$$\n项 $\\frac{dz[t]}{du[t]}$ 是亥维赛阶跃函数 $z[t] = H(u[t] - V_{\\mathrm{th}})$ 的导数。问题指定使用代理梯度 $g(u[t])$ 来表示这个导数：\n$$\n\\frac{dz[t]}{du[t]} \\approx g(u[t]) = \\frac{1}{\\delta\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{u[t] - V_{\\mathrm{th}}}{\\delta}\\right)^{2}\\right)\n$$\n项 $\\frac{du[t]}{dw}$ 是膜电位在时间 $t$ 相对于 $w$ 的全导数。该项说明了网络动态中的循环依赖性。让我们定义 $h[t] \\equiv \\frac{du[t]}{dw}$。\n\n将这些代入我们关于 $\\frac{dL}{dw}$ 的主表达式中，我们得到：\n$$\n\\frac{dL}{dw} = \\sum_{t=1}^{T} \\frac{\\partial L}{\\partial z[t]} g(u[t]) h[t]\n$$\n为了完成推导，我们必须找到 $h[t]$ 的表达式。我们从膜电位的状态更新方程开始：\n$$\nu[t+1] = \\lambda u[t] + w x[t] - V_{\\mathrm{th}} z[t]\n$$\n我们对整个方程关于 $w$ 求导，以找到 $h[t] = \\frac{du[t]}{dw}$ 的递推关系：\n$$\n\\frac{d}{dw} u[t+1] = \\frac{d}{dw} \\left( \\lambda u[t] + w x[t] - V_{\\mathrm{th}} z[t] \\right)\n$$\n$$\nh[t+1] = \\lambda \\frac{du[t]}{dw} + \\frac{d(w x[t])}{dw} - V_{\\mathrm{th}} \\frac{dz[t]}{dw}\n$$\n问题提供了“分离重置”假设：“当对 $u[t+1]$ 关于 $w$ 求导时，将 $z[t]$ 视为常数。”应用此假设意味着我们将通过重置项的梯度路径设为零，即 $\\frac{d}{dw}(-V_{\\mathrm{th}} z[t]) = 0$。输入项的导数是 $\\frac{d(w x[t])}{dw} = x[t]$，因为 $x[t]$ 与 $w$ 无关。泄漏项的导数是 $\\lambda \\frac{du[t]}{dw} = \\lambda h[t]$。\n这将 $h[t]$ 的递推关系简化为：\n$$\nh[t+1] = \\lambda h[t] + x[t]\n$$\n这是一个线性一阶非齐次递推关系。为了解它，我们需要一个初始条件。问题陈述初始电位 $u[1] = u_0$ 与 $w$ 无关。因此，它关于 $w$ 的导数为零：\n$$\nh[1] = \\frac{du[1]}{dw} = 0\n$$\n我们现在可以展开这个递推关系来找到 $h[t]$ 的闭式解：\n$h[1] = 0$\n$h[2] = \\lambda h[1] + x[1] = x[1]$\n$h[3] = \\lambda h[2] + x[2] = \\lambda x[1] + x[2]$\n$h[4] = \\lambda h[3] + x[3] = \\lambda(\\lambda x[1] + x[2]) + x[3] = \\lambda^2 x[1] + \\lambda x[2] + x[3]$\n\n通过归纳法，对于 $t \\geq 1$ 的通解是：\n$$\nh[t] = \\sum_{k=1}^{t-1} \\lambda^{t-1-k} x[k]\n$$\n注意，当 $t=1$ 时，这是一个空和，其值正确地为 $0$。\n\n最后，我们将 $h[t]$ 和 $g(u[t])$ 的表达式代回到我们关于 $\\frac{dL}{dw}$ 的方程中：\n$$\n\\frac{dL}{dw} = \\sum_{t=1}^{T} \\left( \\frac{\\partial L}{\\partial z[t]} \\cdot g(u[t]) \\cdot h[t] \\right)\n$$\n$$\n\\frac{dL}{dw} = \\sum_{t=1}^{T} \\left( \\frac{\\partial L}{\\partial z[t]} \\cdot \\frac{1}{\\delta\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{u[t] - V_{\\mathrm{th}}}{\\delta}\\right)^{2}\\right) \\cdot \\left( \\sum_{k=1}^{t-1} \\lambda^{t-1-k}x[k] \\right) \\right)\n$$\n这就是梯度 $\\frac{dL}{dw}$ 以指定量表示的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\sum_{t=1}^{T} \\left( \\frac{\\partial L}{\\partial z[t]} \\frac{1}{\\delta\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{u[t] - V_{\\mathrm{th}}}{\\delta}\\right)^{2}\\right) \\sum_{k=1}^{t-1} \\lambda^{t-1-k}x[k] \\right)}$$"
        },
        {
            "introduction": "在理论和仿真中表现良好的控制器，在部署到现实世界时必须面对通信不可靠和信号丢失等挑战。对于依赖异步事件流的神经形态控制器而言，其鲁棒性至关重要。本练习建立了一个分析框架，用于量化当个别脉冲事件在传输过程中以一定概率（在此用一个假设的伯努利模型表示）丢失时，对最终控制输出造成的影响。通过推导控制偏差的上界，您将学会如何评估和设计能够抵御通信错误的、更具弹性的神经形态控制系统。",
            "id": "4052791",
            "problem": "一个用于单自由度机器人关节的神经形态控制器通过对事件流进行线性滤波来产生一个连续时间控制信号，该过程遵循线性时不变（LTI）系统的叠加原理。设突触核是因果且有界的，记为 $h(t)$，并定义 $H_{\\infty} = \\sup_{t \\in \\mathbb{R}} |h(t)|  \\infty$。考虑一个由编码方案编码的单一指令控制更新，该方案将期望的更新幅度映射为一个包含 $L$ 个事件的码字，其权重为 $\\mathbf{w} = (w_{1}, w_{2}, \\ldots, w_{L})$，发射时间为 $\\{t_{m}\\}_{m=1}^{L}$。此更新贡献的标称控制输出为 $u_{0}(t) = \\sum_{m=1}^{L} w_{m} h(t - t_{m})$。\n\n假设每个事件被通信和传感栈以独立的伯努利概率 $p \\in [0,1]$ 丢弃（丢弃发生的概率为 $p$，成功传递的概率为 $1-p$）。令 $D_{m} \\in \\{0,1\\}$ 表示事件 $m$ 的丢弃（$\\mathbb{P}(D_{m} = 1) = p$，且在 $m$ 上独立）。实现的控制输出为 $u(t) = \\sum_{m=1}^{L} (1 - D_{m}) w_{m} h(t - t_{m})$。将由丢包引起的控制偏差定义为 $e(t) = u(t) - u_{0}(t)$。\n\n仅从LTI滤波器的线性性质、伯努利丢弃变量的独立性以及基本范数不等式出发，推导期望最坏情况瞬时控制偏差 $\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right]$ 的一个通用上界，该上界显式地依赖于丢包概率 $p$、核边界 $H_{\\infty}$ 以及通过权重向量 $\\mathbf{w}$ 体现的编码方案。请用一个关于 $p$、$H_{\\infty}$ 和 $\\{w_{m}\\}_{m=1}^{L}$ 的单一闭式解析表达式来表示您的最终答案。不需要进行数值计算或四舍五入。",
            "solution": "此问题旨在推导在随机事件丢包情况下，神经形态控制器输出偏差的期望最坏情况的上界。\n\n首先，我们明确定义控制偏差 $e(t)$，即实际输出 $u(t)$与标称输出 $u_0(t)$ 之差：\n$$e(t) = u(t) - u_{0}(t)$$\n将问题中给出的 $u(t)$ 和 $u_0(t)$ 的表达式代入：\n$$e(t) = \\sum_{m=1}^{L} (1 - D_{m}) w_{m} h(t - t_{m}) - \\sum_{m=1}^{L} w_{m} h(t - t_{m})$$\n利用求和的线性性质，我们可以合并两个求和项：\n$$e(t) = \\sum_{m=1}^{L} \\left((1 - D_{m}) - 1\\right) w_{m} h(t - t_{m}) = - \\sum_{m=1}^{L} D_{m} w_{m} h(t - t_{m})$$\n接下来，我们为该偏差的瞬时绝对值 $|e(t)|$ 寻找一个上界。\n$$|e(t)| = \\left| - \\sum_{m=1}^{L} D_{m} w_{m} h(t - t_{m}) \\right| = \\left| \\sum_{m=1}^{L} D_{m} w_{m} h(t - t_{m}) \\right|$$\n根据三角不等式，一个和的绝对值小于或等于各项绝对值的和：\n$$|e(t)| \\leq \\sum_{m=1}^{L} |D_{m} w_{m} h(t - t_{m})| = \\sum_{m=1}^{L} |D_{m}| |w_{m}| |h(t - t_{m})|$$\n由于丢弃变量 $D_{m}$ 是一个指示变量（取值为0或1），其绝对值等于其自身，即 $|D_{m}| = D_{m}$。此外，问题中给出核函数是有界的，即对于所有时间 $\\tau$，$|h(\\tau)| \\leq H_{\\infty}$。将这两个条件代入不等式：\n$$|e(t)| \\leq \\sum_{m=1}^{L} D_{m} |w_{m}| H_{\\infty}$$\n注意到这个不等式的右侧是一个不依赖于时间 $t$ 的随机变量。因此，这个界也适用于偏差绝对值在所有时间上的上确界（即最坏情况）：\n$$\\sup_{t \\in \\mathbb{R}} |e(t)| \\leq \\sum_{m=1}^{L} D_{m} |w_{m}| H_{\\infty}$$\n我们的目标是求期望的最坏情况偏差，即 $\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right]$。对上述不等式两边取期望，并利用期望算子的单调性：\n$$\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right] \\leq \\mathbb{E}\\left[\\sum_{m=1}^{L} D_{m} |w_{m}| H_{\\infty}\\right]$$\n根据期望的线性性质，我们可以将期望算子移入求和内部：\n$$\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right] \\leq \\sum_{m=1}^{L} \\mathbb{E}[D_{m} |w_{m}| H_{\\infty}]$$\n由于 $|w_m|$ 和 $H_{\\infty}$ 是确定性常数，它们可以从期望中提出：\n$$\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right] \\leq \\sum_{m=1}^{L} |w_{m}| H_{\\infty} \\mathbb{E}[D_{m}]$$\n随机变量 $D_m$ 服从参数为 $p$ 的伯努利分布，其期望 $\\mathbb{E}[D_m] = p$。将此代入，我们得到：\n$$\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right] \\leq \\sum_{m=1}^{L} |w_{m}| H_{\\infty} p$$\n最后，将公因子 $p$ 和 $H_{\\infty}$ 提出求和符号，我们便得到了最终的上界表达式：\n$$\\mathbb{E}\\left[\\sup_{t \\in \\mathbb{R}} |e(t)|\\right] \\leq p H_{\\infty} \\sum_{m=1}^{L} |w_{m}|$$\n这个结果提供了一个简洁的、依赖于丢包概率、核函数峰值和编码方案权重的上界。",
            "answer": "$$\n\\boxed{p H_{\\infty} \\sum_{m=1}^{L} |w_{m}|}\n$$"
        }
    ]
}