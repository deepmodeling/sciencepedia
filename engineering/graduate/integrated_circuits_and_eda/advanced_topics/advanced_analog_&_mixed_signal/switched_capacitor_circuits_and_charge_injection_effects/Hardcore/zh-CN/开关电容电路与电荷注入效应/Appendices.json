{
    "hands_on_practices": [
        {
            "introduction": "开关电容电路的核心思想之一是利用电容器和开关的周期性操作来模拟电阻。这个基础练习将引导你从第一性原理出发，推导一个理想开关电容电路的等效电阻。通过这个过程，你将深入理解电荷如何通过离散的“数据包”形式进行转移，从而在宏观上产生与电阻相似的电流-电压关系，这是理解更复杂开关电容滤波器和数据转换器的关键第一步。",
            "id": "4302943",
            "problem": "在电子设计自动化（EDA）的集成电路中，一个开关电容电阻通过使用两个不重叠的时钟相位来实现，这两个时钟相位交替地将一个电容器连接在具有稳定直流电压差的两个节点之间。考虑一个值为 $C$ 的单个电容器，它通过由理想的、不重叠时钟驱动的互补金属氧化物半导体（CMOS）传输门开关，交替连接在电压为 $V_{\\mathrm{A}}$ 和 $V_{\\mathrm{B}}$ 的节点之间。电压差为 $\\Delta V = V_{\\mathrm{A}} - V_{\\mathrm{B}}$ 且随时间保持恒定。假设时钟是理想的，导线电阻可忽略不计，并且电容器在每个相位都完全稳定，因此瞬时连接的假设是有效的。开关表现出电荷注入和时钟馈通效应，但其布局和时序是对称的，因此任何注入的电荷都会被均等分配，并表现为共模扰动，使得每个完整周期内的净差分电荷转移为零。\n\n仅从基本定义出发——即电容器的电荷-电压关系 $q = C v$、电荷守恒以及平均电流定义为单位时间内的平均电荷转移量——推导在稳定工作状态下两节点之间看到的等效电阻 $R_{\\mathrm{eq}}$ 的表达式，以及从 $V_{\\mathrm{A}}$ 流向 $V_{\\mathrm{B}}$ 的平均电流 $I_{\\mathrm{avg}}$ 的表达式。使用给定值 $C = 1\\,\\mathrm{pF}$，$f = 1\\,\\mathrm{MHz}$ 和 $\\Delta V = 1\\,\\mathrm{V}$，其中 $f$ 是时钟频率（单位：周期/秒）。然后计算其数值。\n\n将 $R_{\\mathrm{eq}}$ 以 $\\mathrm{\\Omega}$ 为单位表示，$I_{\\mathrm{avg}}$ 以 $\\mathrm{A}$ 为单位表示。将两个数值结果均四舍五入至四位有效数字。你最终报告的答案必须只包含这两个计算量，并以行向量的形式呈现为一个有序对，顺序为 $\\left(R_{\\mathrm{eq}}, I_{\\mathrm{avg}}\\right)$。",
            "solution": "首先根据指定程序验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 使用单个值为 $C$ 的电容器实现了一个开关电容电阻。\n- 电容器交替连接在具有稳定直流电压 $V_{\\mathrm{A}}$ 和 $V_{\\mathrm{B}}$ 的节点之间。\n- 连接由理想的、不重叠时钟相位驱动的CMOS传输门开关执行。\n- 电压差为 $\\Delta V = V_{\\mathrm{A}} - V_{\\mathrm{B}}$。\n- 假设：理想时钟，可忽略的导线电阻，电容器在每个相位都完全稳定。\n- 电荷注入和时钟馈通效应对称，导致每个完整周期的净差分电荷转移为零。\n- 推导必须从基本定义开始：$q = C v$、电荷守恒和平均电流定义。\n- 给定数值：\n    - $C = 1\\,\\mathrm{pF}$\n    - $f = 1\\,\\mathrm{MHz}$ (时钟频率)\n    - $\\Delta V = 1\\,\\mathrm{V}$\n- 要求输出：\n    - 等效电阻 $R_{\\mathrm{eq}}$ 的表达式。\n    - 平均电流 $I_{\\mathrm{avg}}$ 的表达式。\n    - $R_{\\mathrm{eq}}$ (单位 $\\mathrm{\\Omega}$) 和 $I_{\\mathrm{avg}}$ (单位 $\\mathrm{A}$) 的数值。\n    - 将数值结果四舍五入至四位有效数字。\n    - 最终答案为行向量形式的有序对 $\\left(R_{\\mathrm{eq}}, I_{\\mathrm{avg}}\\right)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个标准的开关电容电阻，这是模拟集成电路设计中的一个基本构建模块。其工作原理基于电容器的规范电荷-电压关系和电流的定义，这些是电路理论和电磁学的基石。指定的非理想效应（电荷注入）及其抵消是集成电路设计中现实的考虑因素。该问题在科学上是合理的。\n- **适定性**：该问题提供了推导唯一解析解并计算确定数值答案所需的所有必要参数（$C$、$f$、$\\Delta V$）和简化假设（理想时钟、完全稳定、净差分电荷注入为零）。\n- **客观性**：该问题使用集成电路设计领域的精确技术术语进行陈述。它没有歧义和主观论断。\n- **缺陷检查**：该问题未违反任何无效标准。它在科学上是合理的、适定的、客观的、完整的，并且与指定主题相关。所提供的假设是一阶分析的标准假设，并且已明确说明。该问题是基本电路分析中的一个有效练习。\n\n### 步骤 3：结论与行动\n问题被判定为有效。将提供解决方案。\n\n开关电容电阻的核心原理是通过周期性地传输离散电荷包来模拟电阻行为。我们分析一个完整时钟周期内传输的电荷。设时钟周期为 $T$，它是时钟频率 $f$ 的倒数，即 $T = \\frac{1}{f}$。时钟有两个不重叠的相位，我们将其表示为 $\\phi_1$ 和 $\\phi_2$。一个工作周期的总时间为 $T$。\n\n我们将操作建模如下，这是在两个电压节点之间创建电阻的标准拓扑结构。在相位 $\\phi_1$ 中，电容器 $C$ 连接到电压为 $V_{\\mathrm{A}}$ 的节点，在相位 $\\phi_2$ 中，它连接到电压为 $V_{\\mathrm{B}}$ 的节点。为便于电荷转移，我们假设电容器的另一极板在两个相位期间都连接到一个公共参考点，我们可以将其定义为地（$0\\,\\mathrm{V}$）。\n\n让我们分析电路的稳态工作。在一个周期开始时（恰好在相位 $\\phi_1$ 开始之前），电容器已经处于前一个周期的 $\\phi_2$ 相位的电压 $V_{\\mathrm{B}}$ 下。因此，电容器上的初始电荷为 $q_{\\mathrm{init}} = C V_{\\mathrm{B}}$。\n\n在相位 $\\phi_1$ 期间，开关将电容器 $C$ 连接到电势 $V_{\\mathrm{A}}$（和参考点）上。电容器充电至电压 $V_{\\mathrm{A}}$。在相位 $\\phi_1$ 结束时，存储在电容器上的电荷为 $q_{\\phi_1} = C V_{\\mathrm{A}}$。为了实现这一点，必须从节点A的源汲取一定量的电荷。根据电荷守恒定律，从节点A汲取的电荷是电容器电荷的变化量：\n$$ \\Delta q_{\\mathrm{A}} = q_{\\phi_1} - q_{\\mathrm{init}} = C V_{\\mathrm{A}} - C V_{\\mathrm{B}} = C (V_{\\mathrm{A}} - V_{\\mathrm{B}}) $$\n\n在相位 $\\phi_2$ 期间，开关将电容器与节点A断开，并将其连接到节点B。此时电容器带有电荷 $q_{\\phi_1} = C V_{\\mathrm{A}}$，现在它会充电（或放电）至电压 $V_{\\mathrm{B}}$。在相位 $\\phi_2$ 结束时，电容器上的电荷为 $q_{\\phi_2} = C V_{\\mathrm{B}}$。从节点B的源汲取的电荷为：\n$$ \\Delta q_{\\mathrm{B}} = q_{\\phi_2} - q_{\\phi_1} = C V_{\\mathrm{B}} - C V_{\\mathrm{A}} = -C (V_{\\mathrm{A}} - V_{\\mathrm{B}}) $$\n从节点B汲取电荷 $\\Delta q_{\\mathrm{B}}$ 等效于将电荷 $-\\Delta q_{\\mathrm{B}} = C (V_{\\mathrm{A}} - V_{\\mathrm{B}})$ 输送*到*节点B。\n\n总之，在周期为 $T$ 的一个完整时钟周期内，一个大小为 $\\Delta Q = C (V_{\\mathrm{A}} - V_{\\mathrm{B}})$ 的净电荷包从节点A取出，并有效地转移到节点B。\n\n平均电流 $I_{\\mathrm{avg}}$ 定义为单位时间内传输的总净电荷。电荷 $\\Delta Q$ 在一个周期 $T$ 内传输。因此，从节点A流向节点B的平均电流为：\n$$ I_{\\mathrm{avg}} = \\frac{\\Delta Q}{T} $$\n代入 $\\Delta Q = C (V_{\\mathrm{A}} - V_{\\mathrm{B}})$ 和 $T = \\frac{1}{f}$：\n$$ I_{\\mathrm{avg}} = \\frac{C (V_{\\mathrm{A}} - V_{\\mathrm{B}})}{1/f} = C f (V_{\\mathrm{A}} - V_{\\mathrm{B}}) $$\n使用给定的定义 $\\Delta V = V_{\\mathrm{A}} - V_{\\mathrm{B}}$，我们得到平均电流的表达式：\n$$ I_{\\mathrm{avg}} = C f \\Delta V $$\n问题陈述指出，任何电荷注入效应都是对称的，并导致净差分电荷转移为零。这证明了我们的理想化分析是合理的，因为这些非理想效应不会对流经两个节点之间的平均电流 $I_{\\mathrm{avg}}$ 产生影响。\n\n接下来，我们推导等效电阻 $R_{\\mathrm{eq}}$。根据欧姆定律，等效电阻定义为元件两端的稳定电压差与流经它的平均电流之比。电压差为 $\\Delta V = V_{\\mathrm{A}} - V_{\\mathrm{B}}$。\n$$ R_{\\mathrm{eq}} = \\frac{\\Delta V}{I_{\\mathrm{avg}}} $$\n代入 $I_{\\mathrm{avg}}$ 的表达式：\n$$ R_{\\mathrm{eq}} = \\frac{\\Delta V}{C f \\Delta V} $$\n假设 $\\Delta V \\neq 0$（给定值为 $1\\,\\mathrm{V}$），我们可以消去 $\\Delta V$ 项：\n$$ R_{\\mathrm{eq}} = \\frac{1}{C f} $$\n这些就是所要求的解析表达式。\n\n现在我们使用给定的数据计算数值：\n$C = 1\\,\\mathrm{pF} = 1 \\times 10^{-12}\\,\\mathrm{F}$\n$f = 1\\,\\mathrm{MHz} = 1 \\times 10^{6}\\,\\mathrm{Hz}$\n$\\Delta V = 1\\,\\mathrm{V}$\n\n等效电阻为：\n$$ R_{\\mathrm{eq}} = \\frac{1}{(1 \\times 10^{-12}\\,\\mathrm{F}) \\times (1 \\times 10^{6}\\,\\mathrm{s}^{-1})} = \\frac{1}{1 \\times 10^{-6}}\\,\\Omega = 1 \\times 10^{6}\\,\\Omega $$\n四舍五入到四位有效数字，结果是 $1.000 \\times 10^6\\,\\Omega$。\n\n平均电流为：\n$$ I_{\\mathrm{avg}} = (1 \\times 10^{-12}\\,\\mathrm{F}) \\times (1 \\times 10^{6}\\,\\mathrm{s}^{-1}) \\times (1\\,\\mathrm{V}) = 1 \\times 10^{-6}\\,\\mathrm{A} $$\n四舍五入到四位有效数字，结果是 $1.000 \\times 10^{-6}\\,\\mathrm{A}$。\n\n计算出的量为 $R_{\\mathrm{eq}} = 1.000 \\times 10^6\\,\\mathrm{\\Omega}$ 和 $I_{\\mathrm{avg}} = 1.000 \\times 10^{-6}\\,\\mathrm{A}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 \\times 10^6  & 1.000 \\times 10^{-6}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在上一个练习中，我们看到电荷在不同节点间转移。本练习将深入探究此过程的物理核心：两个电容器之间的电荷共享。通过严格应用电荷守恒定律，你将推导出最终的平衡电压，并计算在此过程中不可避免的能量损失。这个练习揭示了一个深刻的观点：即使在理想电路中，电荷的重新分配也会因有限电阻（无论多小）而耗散能量，这对于分析开关电容电路的功耗和精度至关重要。",
            "id": "4302948",
            "problem": "考虑一个通过电子设计自动化 (EDA) 设计的集成电路中使用的开关电容网络中的两个理想集总电容器 $C_{1}$ 和 $C_{2}$。在开关事件发生前，$C_{1}$ 和 $C_{2}$ 的上极板是相互隔离的，并分别保持在电压 $V_{1}$ 和 $V_{2}$（相对于一个共同地）。在时间 $t=0$ 时，一个具有足够低导通电阻的金属-氧化物-半导体场效应晶体管 (MOSFET) 开关闭合，将两个上极板连接在一起，使得电荷重新分配，直到达到一个共同的最终电压 $V_{\\mathrm{f}}$。假设不存在到其他节点的寄生电容，没有漏电路径，并且在重新分配期间唯一的能量耗散机制是开关闭合时的有限电阻。电压均衡后，开关保持持续导通，使得最终状态是两个电容器的上极板永久连接在一起。仅使用基本定律（电容器本构关系和由两个上极板构成的孤立节点上的严格电荷守恒）以及电容器储能的定义，推导最终电压 $V_{\\mathrm{f}}$ 的闭合形式表达式以及在均衡过程中因电荷重新分配而损失的能量的闭合形式表达式。\n\n最终电压以伏特表示，能量以焦耳表示。最终答案必须是一个单一的闭合形式解析表达式，包含这两个量并排列成一行，其中第一个条目等于 $V_{\\mathrm{f}}$，第二个条目等于因重新分配而损失的能量。没有提供数值；您的表达式必须仅用 $C_{1}$、$C_{2}$、$V_{1}$ 和 $V_{2}$ 表示。",
            "solution": "问题陈述经过验证。\n\n**步骤 1：提取已知条件**\n- 两个理想集总电容器：$C_{1}$ 和 $C_{2}$。\n- 电容器 $C_{1}$ 上的初始电压：$V_{1}$。\n- 电容器 $C_{2}$ 上的初始电压：$V_{2}$。\n- 在时间 $t=0$ 时，$C_{1}$ 和 $C_{2}$ 的上极板通过一个开关闭合连接。\n- 系统达到一个共同的最终电压 $V_{\\mathrm{f}}$。\n- 假设：无寄生电容，无漏电路径。\n- 推导必须使用：电容器本构关系、严格的电荷守恒以及电容器储能的定义。\n- $V_{\\mathrm{f}}$ 和能量损失的最终表达式必须用 $C_{1}$、$C_{2}$、$V_{1}$ 和 $V_{2}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它描述了电路理论中一个关于两个电容器之间电荷共享和能量耗散的基本教科书问题。所提供的假设（理想元件、无寄生效应）是用于分离核心物理原理的标准做法。该问题是自洽的，提供了所有必要信息，可以根据指定的基本定律推导出唯一解。它不违反任何物理原理，也不包含任何含糊不清或矛盾之处。在此背景下，能量损失现象与电阻值无关（只要其不为零），是一个公认的概念。\n\n**步骤 3：结论与行动**\n该问题有效。下面提供了完整的解答。\n\n解答源于两个基本原理：孤立系统上的电荷守恒和电容器储能的定义。\n\n首先，我们应用电荷守恒原理来确定最终电压 $V_{\\mathrm{f}}$。在 $t=0$ 开关闭合之前，两个电容器的上极板形成一个孤立节点。该节点上的总电荷是每个电容器上电荷的总和。使用电容器本构关系 $Q=CV$，电容器 $C_{1}$ 和 $C_{2}$ 上的初始电荷为：\n$$Q_{1, \\text{initial}} = C_{1}V_{1}$$\n$$Q_{2, \\text{initial}} = C_{2}V_{2}$$\n孤立节点上的总初始电荷为：\n$$Q_{\\text{initial}} = Q_{1, \\text{initial}} + Q_{2, \\text{initial}} = C_{1}V_{1} + C_{2}V_{2}$$\n\n开关闭合后，电荷在两个电容器之间重新分配，直到它们达到一个共同的最终电压 $V_{\\mathrm{f}}$。此时，电容器等效为并联。并联组合的总电容为：\n$$C_{\\text{total}} = C_{1} + C_{2}$$\n用最终电压 $V_{\\mathrm{f}}$ 表示的节点上的总最终电荷为：\n$$Q_{\\text{final}} = C_{\\text{total}}V_{\\mathrm{f}} = (C_{1} + C_{2})V_{\\mathrm{f}}$$\n\n根据电荷守恒定律，孤立节点上的总电荷在开关事件前后必须相同：\n$$Q_{\\text{initial}} = Q_{\\text{final}}$$\n$$C_{1}V_{1} + C_{2}V_{2} = (C_{1} + C_{2})V_{\\mathrm{f}}$$\n解出最终电压 $V_{\\mathrm{f}}$，得到：\n$$V_{\\mathrm{f}} = \\frac{C_{1}V_{1} + C_{2}V_{2}}{C_{1} + C_{2}}$$\n该表达式给出了最终平衡电压，它是初始电压的加权平均值，其中电容是权重因子。\n\n接下来，我们确定在电荷重新分配过程中损失的能量。能量在 MOSFET 开关的有限导通电阻中以热量的形式耗散掉。损失的能量 $E_{\\text{lost}}$ 是存储在电容器中的总初始能量 $E_{\\text{initial}}$ 与总最终能量 $E_{\\text{final}}$ 之间的差值。\n\n单个电容器中存储的能量由 $E = \\frac{1}{2}CV^{2}$ 给出。\n总初始能量是每个电容器单独存储的能量之和：\n$$E_{\\text{initial}} = \\frac{1}{2}C_{1}V_{1}^{2} + \\frac{1}{2}C_{2}V_{2}^{2}$$\n总最终能量是在最终电压 $V_{\\mathrm{f}}$ 下存储在等效并联电容中的能量：\n$$E_{\\text{final}} = \\frac{1}{2}C_{\\text{total}}V_{\\mathrm{f}}^{2} = \\frac{1}{2}(C_{1} + C_{2})V_{\\mathrm{f}}^{2}$$\n将先前推导的 $V_{\\mathrm{f}}$ 表达式代入 $E_{\\text{final}}$ 的方程中：\n$$E_{\\text{final}} = \\frac{1}{2}(C_{1} + C_{2}) \\left( \\frac{C_{1}V_{1} + C_{2}V_{2}}{C_{1} + C_{2}} \\right)^{2} = \\frac{1}{2} \\frac{(C_{1}V_{1} + C_{2}V_{2})^{2}}{C_{1} + C_{2}}$$\n然后计算损失的能量为 $E_{\\text{lost}} = E_{\\text{initial}} - E_{\\text{final}}$：\n$$E_{\\text{lost}} = \\left(\\frac{1}{2}C_{1}V_{1}^{2} + \\frac{1}{2}C_{2}V_{2}^{2}\\right) - \\frac{1}{2} \\frac{(C_{1}V_{1} + C_{2}V_{2})^{2}}{C_{1} + C_{2}}$$\n我们可以通过将所有项置于一个共同分母 $2(C_{1} + C_{2})$ 上来简化此表达式：\n$$E_{\\text{lost}} = \\frac{ (C_{1} + C_{2})(C_{1}V_{1}^{2} + C_{2}V_{2}^{2}) - (C_{1}V_{1} + C_{2}V_{2})^{2} }{2(C_{1} + C_{2})}$$\n现在，我们展开分子中的各项。\n第一项：\n$$(C_{1} + C_{2})(C_{1}V_{1}^{2} + C_{2}V_{2}^{2}) = C_{1}^{2}V_{1}^{2} + C_{1}C_{2}V_{2}^{2} + C_{1}C_{2}V_{1}^{2} + C_{2}^{2}V_{2}^{2}$$\n第二项：\n$$(C_{1}V_{1} + C_{2}V_{2})^{2} = C_{1}^{2}V_{1}^{2} + 2C_{1}V_{1}C_{2}V_{2} + C_{2}^{2}V_{2}^{2}$$\n从第一项展开式中减去第二项展开式：\n$$C_{1}^{2}V_{1}^{2} + C_{1}C_{2}V_{1}^{2} + C_{1}C_{2}V_{2}^{2} + C_{2}^{2}V_{2}^{2} - (C_{1}^{2}V_{1}^{2} + 2C_{1}C_{2}V_{1}V_{2} + C_{2}^{2}V_{2}^{2})$$\n项 $C_{1}^{2}V_{1}^{2}$ 和 $C_{2}^{2}V_{2}^{2}$ 消掉了，剩下：\n$$C_{1}C_{2}V_{1}^{2} + C_{1}C_{2}V_{2}^{2} - 2C_{1}C_{2}V_{1}V_{2}$$\n提出公因式 $C_{1}C_{2}$：\n$$C_{1}C_{2}(V_{1}^{2} - 2V_{1}V_{2} + V_{2}^{2}) = C_{1}C_{2}(V_{1} - V_{2})^{2}$$\n将这个简化的分子代回 $E_{\\text{lost}}$ 的表达式中：\n$$E_{\\text{lost}} = \\frac{C_{1}C_{2}(V_{1} - V_{2})^{2}}{2(C_{1} + C_{2})} = \\frac{1}{2} \\frac{C_{1}C_{2}}{C_{1} + C_{2}} (V_{1} - V_{2})^{2}$$\n这就是能量损失的闭合形式表达式。值得注意的是，能量损失总是非负的，因为所有项都是正的，并且仅当初始电压相等（$V_{1}=V_{2}$）时才为零，在这种情况下不发生电荷重新分配。量 $\\frac{C_{1}C_{2}}{C_{1} + C_{2}}$ 是 $C_{1}$ 和 $C_{2}$ 串联的等效电容。\n\n总之，最终电压和损失的能量由下式给出：\n最终电压：$V_{\\mathrm{f}} = \\frac{C_{1}V_{1} + C_{2}V_{2}}{C_{1} + C_{2}}$\n损失的能量：$E_{\\text{lost}} = \\frac{1}{2} \\frac{C_{1}C_{2}}{C_{1} + C_{2}}(V_{1} - V_{2})^{2}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{C_{1}V_{1} + C_{2}V_{2}}{C_{1} + C_{2}} & \\frac{1}{2} \\frac{C_{1}C_{2}}{C_{1} + C_{2}}(V_{1} - V_{2})^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从理想模型转向实际应用时，我们必须考虑开关引入的非理想效应。本练习聚焦于一种关键的误差来源——时钟馈通，它由开关晶体管的寄生交叠电容引起。你将学习如何通过电荷守恒原理来精确建模和量化这种效应所导致的“基座误差”，并将理论公式应用于多个实际场景。这项实践为你搭建了一座从理论分析到电路仿真（如 SPICE）和稳健设计的桥梁。",
            "id": "4302934",
            "problem": "给定一个用于时钟馈通的最小但物理上真实的模型，该模型在一个用互补传输门实现的开关电容采样保持电路中。此模型旨在表示当显式重叠电容在每个栅极网络和高阻抗保持节点之间实例化为电容器时，集成电路通用仿真程序（SPICE）网表所做的工作。目标是量化在关断期间栅极控制电压发生阶跃时，仅由时钟馈通引起的基座误差。该问题必须从第一性原理出发，通过应用电荷守恒和电容器本构关系来解决，不使用快捷公式。\n\n考虑一个保持节点，其对地有一个保持电容 $C_H$，以及一组显式栅极到节点的重叠电容 $\\{C_i\\}$，将该保持节点连接到 $k$ 个独立的时钟网络 $\\{g_i\\}$，其中 $i \\in \\{1,\\dots,k\\}$。在给定的时钟边沿，第 $i$ 个时钟网络经历一个已知的从 $V_{g,i}^{-}$ 到 $V_{g,i}^{+}$ 的理想阶跃，其阶跃幅度为 $\\Delta V_{g,i} = V_{g,i}^{+} - V_{g,i}^{-}$。假设开关沟道在边沿之后立即断开，因此除了电容连接外，保持节点是孤立的。忽略所有沟道电荷注入和任何其他未明确列出的寄生效应，并假设电容器是线性时不变的。\n\n您的任务是：\n- 从孤立保持节点的电荷守恒和电容器定律 $Q = C \\, V$ 出发，推导仅由上述时钟阶跃和显式重叠电容引起的保持节点处的瞬时基座误差 $\\Delta V_{\\text{out}}$。将基座误差定义为由时钟转换引起的保持节点电压的瞬时变化，即 $\\Delta V_{\\text{out}} = V_{\\text{out}}^{+} - V_{\\text{out}}^{-}$.\n- 用 $C_H$、集合 $\\{C_i\\}$ 和栅极阶跃集合 $\\{\\Delta V_{g,i}\\}$ 来表示 $\\Delta V_{\\text{out}}$，保持一致的符号约定，并清楚地解释任何假设。\n\n数值测试集：\n对于以下每个测试案例，计算基座误差 $\\Delta V_{\\text{out}}$（单位：伏特）。所有电容单位为法拉，所有电压单位为伏特。您的程序必须实现一个通用解决方案，该方案接受 $C_H$ 和一个由数对 $(C_i, \\Delta V_{g,i})$ 组成的列表，并返回从第一性原理计算出的 $\\Delta V_{\\text{out}}$。\n\n- 测试案例 1（互补传输门，中等保持电容）：\n  - $C_H = 1.0 \\times 10^{-12}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (1.0 \\times 10^{-14}\\ \\text{F}, -1.2\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (8.0 \\times 10^{-15}\\ \\text{F}, +1.2\\ \\text{V})$\n- 测试案例 2（仅单个n沟道金属氧化物半导体器件）：\n  - $C_H = 5.0 \\times 10^{-13}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (5.0 \\times 10^{-15}\\ \\text{F}, -1.0\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (0.0\\ \\text{F}, 0.0\\ \\text{V})$\n- 测试案例 3（具有理想抵消的互补传输门）：\n  - $C_H = 5.0 \\times 10^{-13}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (5.0 \\times 10^{-15}\\ \\text{F}, -1.0\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (5.0 \\times 10^{-15}\\ \\text{F}, +1.0\\ \\text{V})$\n- 测试案例 4（极小保持电容，大基座误差幅度）：\n  - $C_H = 2.0 \\times 10^{-14}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (1.0 \\times 10^{-14}\\ \\text{F}, -1.2\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (8.0 \\times 10^{-15}\\ \\text{F}, +1.2\\ \\text{V})$\n- 测试案例 5（极大保持电容，自举栅极摆幅）：\n  - $C_H = 1.0 \\times 10^{-10}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (2.0 \\times 10^{-14}\\ \\text{F}, -5.0\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (0.0\\ \\text{F}, 0.0\\ \\text{V})$\n- 测试案例 6（非对称重叠电容和时钟摆幅）：\n  - $C_H = 1.0 \\times 10^{-12}\\ \\text{F}$\n  - $(C_{n}, \\Delta V_{g,n}) = (7.0 \\times 10^{-15}\\ \\text{F}, -0.8\\ \\text{V})$\n  - $(C_{p}, \\Delta V_{g,p}) = (9.0 \\times 10^{-15}\\ \\text{F}, +1.2\\ \\text{V})$\n\n解释与SPICE原理图的关系：\n- 在SPICE网表中，上述模型由从每个时钟网络到保持节点的显式电容器建模，例如，在n-栅极网络和保持节点之间有一个值为 $C_{n}$ 的电容 $C\\_\\text{n\\_ov}$，以及在p-栅极网络和保持节点之间有一个值为 $C_{p}$ 的电容 $C\\_\\text{p\\_ov}$。当开关沟道非导通时，基座误差恰好是理想栅极电压阶跃 $\\{\\Delta V_{g,i}\\}$ 通过这些显式电容器在保持节点上产生的电压阶跃 $\\Delta V_{\\text{out}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含六个基座误差的结果，以逗号分隔的列表形式，单位为伏特，并用方括号括起来，例如，$\\left[\\text{结果}_1,\\text{结果}_2,\\dots,\\text{结果}_6\\right]$。输出行中不应包含任何单位或附加文本。数值必须是单位为伏特的浮点数。",
            "solution": "该问题是有效的。其科学基础是电路理论的基本原理，所有必要信息均已提供，问题是适定的，并且以客观、正式的语言表述。因此，我们可以进行推导和求解。\n\n目标是推导由于一组 $k$ 个栅极控制信号的时钟馈通而在孤立保持节点上产生的基座误差 $\\Delta V_{\\text{out}}$。分析基于电荷守恒原理。\n\n设 $V_{\\text{out}}$ 为保持节点处的电压。此节点通过保持电容 $C_H$ 接地，并通过一组重叠电容 $\\{C_i\\}$ 连接到 $k$ 个独立的时钟网络，其中 $i \\in \\{1, \\dots, k\\}$。第 $i$ 个时钟网络的电压表示为 $V_{g,i}$。\n\n连接到保持节点的所有电容器极板上存储的总电荷 $Q_{\\text{node}}$ 是保持电容上的电荷 $Q_{C_H}$ 和重叠电容上的电荷 $\\{Q_{C_i}\\}$ 的总和。使用电容器本构关系 $Q = C \\Delta V$，其中 $\\Delta V$ 是电容器两端的电压，我们可以表示这些电荷：\n- 保持电容 $C_H$ 的上极板（连接到保持节点）上的电荷是：\n$$Q_{C_H} = C_H (V_{\\text{out}} - 0) = C_H V_{\\text{out}}$$\n- 第 $i$ 个重叠电容 $C_i$ 连接到保持节点的极板上的电荷是：\n$$Q_{C_i} = C_i (V_{\\text{out}} - V_{g,i})$$\n\n保持节点处的总电荷是这些单个电荷的总和：\n$$Q_{\\text{out}} = Q_{C_H} + \\sum_{i=1}^{k} Q_{C_i} = C_H V_{\\text{out}} + \\sum_{i=1}^{k} C_i (V_{\\text{out}} - V_{g,i})$$\n这可以因式分解为：\n$$Q_{\\text{out}} = V_{\\text{out}} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - \\sum_{i=1}^{k} C_i V_{g,i}$$\n\n解决此问题的核心原理是电荷守恒。问题陈述，开关沟道在时钟边沿之后立即断开，这意味着保持节点是电学孤立的。因此，在此节点上的总电荷在时钟转换期间必须是守恒的。设 $t^{-}$ 为时钟转换前的瞬间，$t^{+}$ 为转换后的瞬间。电荷守恒定律规定 $Q_{\\text{out}}(t^{-}) = Q_{\\text{out}}(t^{+})$。\n\n在时间 $t^{-}$，电压为 $V_{\\text{out}}^{-}$ 和 $\\{V_{g,i}^{-}\\}$。总电荷为：\n$$Q_{\\text{out}}^{-} = V_{\\text{out}}^{-} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - \\sum_{i=1}^{k} C_i V_{g,i}^{-}$$\n\n在时间 $t^{+}$，电压为 $V_{\\text{out}}^{+}$ 和 $\\{V_{g,i}^{+}\\}$。总电荷为：\n$$Q_{\\text{out}}^{+} = V_{\\text{out}}^{+} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - \\sum_{i=1}^{k} C_i V_{g,i}^{+}$$\n\n令 $Q_{\\text{out}}^{-} = Q_{\\text{out}}^{+}$:\n$$V_{\\text{out}}^{-} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - \\sum_{i=1}^{k} C_i V_{g,i}^{-} = V_{\\text{out}}^{+} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - \\sum_{i=1}^{k} C_i V_{g,i}^{+}$$\n\n我们的目标是求出定义为 $\\Delta V_{\\text{out}} = V_{\\text{out}}^{+} - V_{\\text{out}}^{-}$ 的基座误差。我们重新整理方程以分离涉及 $V_{\\text{out}}$ 和 $V_{g,i}$ 的项：\n$$\\sum_{i=1}^{k} C_i V_{g,i}^{+} - \\sum_{i=1}^{k} C_i V_{g,i}^{-} = V_{\\text{out}}^{+} \\left( C_H + \\sum_{i=1}^{k} C_i \\right) - V_{\\text{out}}^{-} \\left( C_H + \\sum_{i=1}^{k} C_i \\right)$$\n\n对方程两边进行因式分解得到：\n$$\\sum_{i=1}^{k} C_i (V_{g,i}^{+} - V_{g,i}^{-}) = (V_{\\text{out}}^{+} - V_{\\text{out}}^{-}) \\left( C_H + \\sum_{i=1}^{k} C_i \\right)$$\n\n使用问题中的定义 $\\Delta V_{\\text{out}} = V_{\\text{out}}^{+} - V_{\\text{out}}^{-}$ 和 $\\Delta V_{g,i} = V_{g,i}^{+} - V_{g,i}^{-}$：\n$$\\sum_{i=1}^{k} C_i \\Delta V_{g,i} = \\Delta V_{\\text{out}} \\left( C_H + \\sum_{i=1}^{k} C_i \\right)$$\n\n最后，求解基座误差 $\\Delta V_{\\text{out}}$，我们得到通用表达式：\n$$\\Delta V_{\\text{out}} = \\frac{\\sum_{i=1}^{k} C_i \\Delta V_{g,i}}{C_H + \\sum_{i=1}^{k} C_i}$$\n\n这个结果在物理上是直观的。分子 $\\sum_{i=1}^{k} C_i \\Delta V_{g,i}$ 代表了由于栅极电压变化通过电容耦合注入到保持节点的总电荷量。这个注入的电荷随后分布在从保持节点看去的总电容上，该总电容是连接到该节点的所有电容器的并联组合，即 $C_{\\text{total}} = C_H + \\sum_{i=1}^{k} C_i$。因此，产生的电压变化为 $\\Delta V = \\Delta Q / C_{\\text{total}}$，与我们推导的公式一致。\n\n此推导中作出的关键假设是：\n1.  开关事件后，保持节点是完全孤立的（对任何其他节点呈无限阻抗）。\n2.  所有电容器（$C_H$ 和 $\\{C_i\\}$）都是线性和时不变的。\n3.  所有其他寄生效应，特别是沟道电荷注入，都被忽略。\n4.  时钟电压转换是理想的瞬时阶跃。\n\n对于一个带有n沟道和p沟道器件的互补传输门的具体情况，我们有 $k=2$。设n沟道器件的参数为 $(C_n, \\Delta V_{g,n})$，p沟道器件的参数为 $(C_p, \\Delta V_{g,p})$。公式变为：\n$$\\Delta V_{\\text{out}} = \\frac{C_n \\Delta V_{g,n} + C_p \\Delta V_{g,p}}{C_H + C_n + C_p}$$\n此形式将用于计算所提供测试案例的数值结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the pedestal error in a switched-capacitor circuit based on\n    a first-principles derivation.\n    \"\"\"\n\n    def calculate_pedestal_error(C_H, C_dVg_pairs):\n        \"\"\"\n        Calculates the pedestal error V_out(+)-V_out(-) from first principles.\n\n        The derivation is based on charge conservation at the isolated hold node.\n        The change in charge due to gate voltage steps must be balanced by the\n        change in charge stored on the total capacitance at the hold node.\n\n        Let Q_node be the total charge at the hold node.\n        Q_node = C_H * V_out + sum(C_i * (V_out - V_gi)) for all i.\n        Since the node is isolated, d(Q_node)/dt = 0, which implies Q_node is constant.\n        Q_node_before = Q_node_after\n        \n        C_H*V_out(-) + sum(C_i*(V_out(-) - V_gi(-))) = C_H*V_out(+) + sum(C_i*(V_out(+) - V_gi(+)))\n        \n        Rearranging to solve for dV_out = V_out(+) - V_out(-):\n        dV_out * (C_H + sum(C_i)) = sum(C_i * (V_gi(+) - V_gi(-)))\n        dV_out * (C_H + sum(C_i)) = sum(C_i * dV_gi)\n        \n        dV_out = sum(C_i * dV_gi) / (C_H + sum(C_i))\n\n        Args:\n            C_H (float): Hold capacitance in Farads.\n            C_dVg_pairs (list of tuples): A list where each tuple contains\n                                         (C_i, dV_gi), the overlap capacitance\n                                         and gate voltage step for one clock net.\n\n        Returns:\n            float: The pedestal error dV_out in Volts.\n        \"\"\"\n        # Numerator: sum(C_i * dV_gi)\n        # This is the total charge injected onto the hold node.\n        # It's calculated by summing the product of each overlap capacitance\n        # and its corresponding gate voltage step.\n        injected_charge = np.sum([C_i * dV_gi for C_i, dV_gi in C_dVg_pairs])\n\n        # Denominator: C_H + sum(C_i)\n        # This is the total capacitance seen from the isolated hold node.\n        # It's the parallel combination of the hold capacitor and all overlap capacitors.\n        sum_of_overlap_caps = np.sum([C_i for C_i, dV_gi in C_dVg_pairs])\n        total_capacitance = C_H + sum_of_overlap_caps\n\n        # The pedestal error is the injected charge divided by the total capacitance.\n        if total_capacitance == 0:\n            # Avoid division by zero, although physically C_H > 0\n            return 0.0\n        \n        pedestal_error = injected_charge / total_capacitance\n\n        return pedestal_error\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (complementary transmission gate, moderate hold capacitor)\n        (1.0e-12, [(1.0e-14, -1.2), (8.0e-15, 1.2)]),\n        # Test case 2 (single n-channel device only)\n        (5.0e-13, [(5.0e-15, -1.0), (0.0, 0.0)]),\n        # Test case 3 (complementary transmission gate with ideal cancellation)\n        (5.0e-13, [(5.0e-15, -1.0), (5.0e-15, 1.0)]),\n        # Test case 4 (very small hold capacitor, large pedestal magnitude)\n        (2.0e-14, [(1.0e-14, -1.2), (8.0e-15, 1.2)]),\n        # Test case 5 (very large hold capacitor, bootstrapped gate swing)\n        (1.0e-10, [(2.0e-14, -5.0), (0.0, 0.0)]),\n        # Test case 6 (asymmetric overlap and clock swings)\n        (1.0e-12, [(7.0e-15, -0.8), (9.0e-15, 1.2)])\n    ]\n    \n    results = []\n    for C_H, C_dVg_pairs in test_cases:\n        result = calculate_pedestal_error(C_H, C_dVg_pairs)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}