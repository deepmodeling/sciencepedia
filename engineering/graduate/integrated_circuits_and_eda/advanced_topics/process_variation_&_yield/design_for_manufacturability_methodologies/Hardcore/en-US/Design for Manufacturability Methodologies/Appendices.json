{
    "hands_on_practices": [
        {
            "introduction": "A fundamental goal of Design for Manufacturability is to predict and improve circuit yield. This practice delves into critical area analysis, a cornerstone technique that quantifies a layout's susceptibility to random defects. By deriving the critical area from first principles for a parallel interconnect structure, you will gain a deep understanding of how geometric design choices directly interact with defect statistics to determine manufacturing outcomes .",
            "id": "4264311",
            "problem": "An advanced digital integrated circuit employs parallel global interconnects on a single metal layer. In the context of Design for Manufacturability (DFM) within Electronic Design Automation (EDA), the susceptibility of a layout to random particulate defects is quantified by the critical area, defined conceptually as the expected area of defect-center locations that induce a specified failure mechanism when defect sizes vary according to a known distribution. Consider two long, coplanar, parallel metal rectangles of equal width, separated by a uniform edge-to-edge spacing, and assume defect shapes are circular with radius $r$. The center of a defect lies uniformly at random on the plane.\n\nStarting from first principles of geometric probability and the definition of a probability density function for the defect radius, derive the integral expression for the short-circuit critical area between the two lines in terms of a susceptibility function $A(r)$ and a normalized defect radius probability density $f(r)$. Your derivation must be based on the geometric locus of defect centers that concurrently intersect both conductors and the rules of expectation under a continuous distribution; do not assume a target formula and do not invoke any pre-memorized shortcuts.\n\nUse the following scientifically realistic and self-consistent parameters:\n- The two lines have common length $L$ along their long axis, with $L = 5000 \\, \\mathrm{\\mu m}$, and are sufficiently long that end effects are negligible.\n- The uniform edge-to-edge spacing between the inner edges of the two lines is $s = 0.14 \\, \\mathrm{\\mu m}$.\n- The defect radius has a normalized exponential distribution $f(r) = \\frac{1}{r_{0}}\\exp\\!\\left(-\\frac{r}{r_{0}}\\right)$ for $r \\geq 0$, with scale parameter $r_0 = 0.06 \\, \\mathrm{\\mu m}$.\n\nTasks:\n1. Using geometric reasoning, determine the susceptibility function $A(r)$ that gives the area of defect-center locations which produce an electrical short between the two lines for a given defect radius $r$. Carefully specify any conditions on $r$ under which $A(r)$ is nonzero. Then, derive the integral expression for the short-circuit critical area $A_{\\mathrm{crit}}$ as an expectation over $r$ using $f(r)$.\n2. Evaluate the integral exactly to obtain a closed-form analytic expression for $A_{\\mathrm{crit}}$ in terms of $L$, $s$, and $r_{0}$. Then substitute the provided numerical values and compute the numerical value of $A_{\\mathrm{crit}}$. Round your final numerical value to four significant figures. Express the final area in square micrometers.\n3. Briefly outline a scientifically sound numerical procedure to evaluate $A_{\\mathrm{crit}}$ for arbitrary polygonal interconnect layouts and an arbitrary continuous $f(r)$, where a closed form for $A(r)$ may not be available. Your outline should start from the geometric definition and indicate how to approximate the susceptibility function and perform the numerical integration.\n\nYour final answer must be a single real number corresponding to the rounded numerical value specified in Task 2.",
            "solution": "The problem requires the derivation and calculation of the short-circuit critical area between two parallel interconnects, based on first principles of geometric probability. The problem statement is validated to be scientifically grounded, well-posed, and objective. It provides a self-consistent set of parameters and definitions from the field of integrated circuit design for manufacturability (DFM). All necessary data are provided, and the problem is free of contradictions or ambiguities.\n\n### Task 1: Susceptibility Function and Critical Area Integral\n\nThe critical area, $A_{\\mathrm{crit}}$, is defined as the expected value of the susceptibility function, $A(r)$, over the probability distribution of defect radii, $f(r)$. The susceptibility function $A(r)$ is the area of the locus of defect centers that cause a short circuit for a given defect radius $r$.\n\nFirst, we determine the susceptibility function $A(r)$. Consider two parallel lines of length $L$, separated by a uniform edge-to-edge spacing $s$. We can model the inner edges of these lines as being located at $x = -s/2$ and $x = +s/2$. The lines extend along the y-axis. A defect is a circle of radius $r$.\n\nAn electrical short occurs if the defect simultaneously intersects both lines. For a circular defect to span the gap of width $s$, its diameter $2r$ must be at least as large as the spacing $s$. Thus, a short is only possible if $2r \\geq s$, or $r \\geq s/2$.\nIf $r < s/2$, it is geometrically impossible for the defect to touch both lines, so the area of locations for a defect center to cause a short is zero.\n$$A(r) = 0 \\quad \\text{for} \\quad r < \\frac{s}{2}$$\n\nIf $r \\geq s/2$, we need to find the locus of defect centers $(x_c, y_c)$ that cause a short.\nFor the defect to touch the line at $x = -s/2$, its center must be within a distance $r$ from this line. This means the x-coordinate of the center, $x_c$, must satisfy:\n$$-s/2 - r \\leq x_c \\leq -s/2 + r$$\nSimilarly, for the defect to touch the line at $x = +s/2$, $x_c$ must satisfy:\n$$s/2 - r \\leq x_c \\leq s/2 + r$$\nFor a short to occur, the defect must touch both lines, so its center must lie in the intersection of these two regions for the x-coordinate. The intersection of the intervals $[-s/2 - r, -s/2 + r]$ and $[s/2 - r, s/2 + r]$ is:\n$$[s/2 - r, -s/2 + r]$$\nThe width of this region for the defect center x-coordinate is $(-s/2 + r) - (s/2 - r) = 2r - s$. This width is non-negative since we have established $r \\geq s/2$.\n\nThe problem states the lines have length $L$ and end effects are negligible. This implies the locus of the defect center's y-coordinate, $y_c$, extends over the full length $L$.\nThe area of the region of critical defect centers is the product of the width in the x-direction and the length in the y-direction.\nTherefore, the susceptibility function for $r \\geq s/2$ is:\n$$A(r) = L(2r - s)$$\n\nCombining the two cases, the susceptibility function is:\n$$A(r) = \\begin{cases} 0 & \\text{if } r < s/2 \\\\ L(2r-s) & \\text{if } r \\geq s/2 \\end{cases}$$\n\nThe critical area $A_{\\mathrm{crit}}$ is the expectation of $A(r)$ with respect to the defect radius probability density function $f(r)$. The radius $r$ is a non-negative continuous random variable.\n$$ A_{\\mathrm{crit}} = E[A(r)] = \\int_{0}^{\\infty} A(r) f(r) dr $$\nSubstituting the expression for $A(r)$, the integral's lower bound changes from $0$ to $s/2$, since $A(r)=0$ for $r < s/2$.\n$$ A_{\\mathrm{crit}} = \\int_{s/2}^{\\infty} L(2r - s) f(r) dr $$\nSubstituting the given normalized exponential distribution $f(r) = \\frac{1}{r_{0}}\\exp\\left(-\\frac{r}{r_{0}}\\right)$:\n$$ A_{\\mathrm{crit}} = \\int_{s/2}^{\\infty} L(2r - s) \\frac{1}{r_{0}}\\exp\\left(-\\frac{r}{r_{0}}\\right) dr $$\nThis is the integral expression for the short-circuit critical area.\n\n### Task 2: Evaluation of the Critical Area Integral\n\nWe now evaluate the integral derived in Task 1 to find a closed-form analytic expression for $A_{\\mathrm{crit}}$.\n$$ A_{\\mathrm{crit}} = \\frac{L}{r_0} \\int_{s/2}^{\\infty} (2r - s) \\exp\\left(-\\frac{r}{r_{0}}\\right) dr $$\nWe can split the integral into two parts:\n$$ A_{\\mathrm{crit}} = \\frac{L}{r_0} \\left( 2 \\int_{s/2}^{\\infty} r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr - s \\int_{s/2}^{\\infty} \\exp\\left(-\\frac{r}{r_{0}}\\right) dr \\right) $$\nLet's evaluate the second, simpler integral first:\n$$ \\int_{s/2}^{\\infty} \\exp\\left(-\\frac{r}{r_{0}}\\right) dr = \\left[ -r_0 \\exp\\left(-\\frac{r}{r_{0}}\\right) \\right]_{s/2}^{\\infty} = 0 - \\left(-r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\right) = r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right) $$\nThe first integral, $\\int r \\exp(-r/r_0) dr$, requires integration by parts, $\\int u dv = uv - \\int v du$.\nLet $u = r$, so $du = dr$. Let $dv = \\exp(-r/r_0)dr$, so $v = -r_0 \\exp(-r/r_0)$.\n\\begin{align*} \\int r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr &= r(-r_0 \\exp(-r/r_0)) - \\int (-r_0 \\exp(-r/r_0)) dr \\\\ &= -r r_0 \\exp(-r/r_0) + r_0 \\int \\exp(-r/r_0) dr \\\\ &= -r r_0 \\exp(-r/r_0) - r_0^2 \\exp(-r/r_0)\\end{align*}\nApplying the definite integral limits from $s/2$ to $\\infty$:\n\\begin{align*} \\int_{s/2}^{\\infty} r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr &= \\left[ -(r r_0 + r_0^2) \\exp\\left(-\\frac{r}{r_{0}}\\right) \\right]_{s/2}^{\\infty} \\\\ &= 0 - \\left( -\\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\right) \\\\ &= \\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\end{align*}\nNote that $\\lim_{r\\to\\infty} r \\exp(-r/r_0) = 0$ by L'Hôpital's rule.\n\nNow, we substitute both results back into the expression for $A_{\\mathrm{crit}}$:\n\\begin{align*} A_{\\mathrm{crit}} &= \\frac{L}{r_0} \\left( 2 \\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right) - s \\left(r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\right) \\right) \\\\ &= \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\left( 2\\left(\\frac{s}{2}r_0 + r_0^2\\right) - s r_0 \\right) \\\\ &= \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\left( s r_0 + 2r_0^2 - s r_0 \\right) \\\\ &= \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) (2r_0^2) \\\\ &= 2 L r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\end{align*}\nThis is the closed-form analytic expression for $A_{\\mathrm{crit}}$.\n\nNext, we substitute the numerical values: $L = 5000 \\, \\mathrm{\\mu m}$, $s = 0.14 \\, \\mathrm{\\mu m}$, and $r_0 = 0.06 \\, \\mathrm{\\mu m}$.\nThe exponent term is:\n$$ -\\frac{s}{2r_{0}} = -\\frac{0.14}{2 \\times 0.06} = -\\frac{0.14}{0.12} = -\\frac{14}{12} = -\\frac{7}{6} $$\nNow, we calculate $A_{\\mathrm{crit}}$:\n$$ A_{\\mathrm{crit}} = 2 \\times 5000 \\times 0.06 \\times \\exp\\left(-\\frac{7}{6}\\right) = 10000 \\times 0.06 \\times \\exp\\left(-\\frac{7}{6}\\right) = 600 \\exp\\left(-\\frac{7}{6}\\right) $$\nUsing a calculator, $\\exp(-7/6) \\approx 0.3114036$.\n$$ A_{\\mathrm{crit}} \\approx 600 \\times 0.3114036 \\approx 186.84216 \\, \\mathrm{\\mu m}^2 $$\nRounding to four significant figures as requested, the result is $186.8 \\, \\mathrm{\\mu m}^2$.\n\n### Task 3: Numerical Procedure Outline\n\nFor arbitrary polygonal interconnect layouts and an arbitrary continuous defect size distribution $f(r)$, a closed-form expression for the susceptibility function $A(r)$ is generally not available. The critical area $A_{\\mathrm{crit}} = \\int_{0}^{\\infty} A(r) f(r) dr$ must be evaluated numerically. A scientifically sound procedure would be as follows:\n\n1.  **Discretize the Defect Radius Domain**: Define a range of relevant defect radii $[r_{\\min}, r_{\\max}]$. The lower bound $r_{\\min}$ is the smallest radius that can cause a short between any two points of the specified polygon pair. The upper bound $r_{\\max}$ is chosen such that the integral of the PDF, $\\int_{r_{\\max}}^{\\infty} f(r) dr$, is negligible. Discretize this range into a set of $N+1$ sample points $\\{r_0, r_1, \\dots, r_N\\}$.\n\n2.  **Compute the Susceptibility Function at Sample Points**: For each sample radius $r_i$ in the set, compute the susceptibility area $A(r_i)$. This is a computational geometry problem:\n    a.  Let the two interconnect polygons be $P_1$ and $P_2$. A defect of radius $r_i$ centered at a point $c$ causes a short if the defect body (a disk of radius $r_i$) intersects both $P_1$ and $P_2$. This is equivalent to the center $c$ belonging to the intersection of the Minkowski sums of each polygon with a disk of radius $r_i$.\n    b.  Numerically compute the expanded polygons $P'_1(r_i) = P_1 \\oplus D(r_i)$ and $P'_2(r_i) = P_2 \\oplus D(r_i)$, where $D(r_i)$ is a disk of radius $r_i$. This operation is also known as shape inflation or buffering.\n    c.  Compute the geometric intersection of these two expanded polygons: $R(r_i) = P'_1(r_i) \\cap P'_2(r_i)$. This can be done using robust polygon clipping algorithms (e.g., Vatti, Greiner-Hormann).\n    d.  Calculate the area of the resulting intersection polygon $R(r_i)$. This value is $A(r_i)$.\n\n3.  **Perform Numerical Integration (Quadrature)**: With the set of sampled points $(r_i, A(r_i))$ and the known function $f(r)$, approximate the integral for the critical area.\n    $$ A_{\\mathrm{crit}} \\approx \\int_{r_{\\min}}^{r_{\\max}} A(r) f(r) dr $$\n    This can be done using a numerical quadrature rule, such as the trapezoidal rule:\n    $$ A_{\\mathrm{crit}} \\approx \\sum_{i=1}^{N} \\frac{A(r_i)f(r_i) + A(r_{i-1})f(r_{i-1})}{2}(r_i - r_{i-1}) $$\n    More accurate methods like Simpson's rule or adaptive quadrature can be employed for higher precision. An alternative is a Monte Carlo approach where defect radii are randomly sampled from the distribution $f(r)$, $A(r)$ is computed for each sample, and the final critical area is the average of the computed $A(r)$ values.",
            "answer": "$$\\boxed{186.8}$$"
        },
        {
            "introduction": "Beyond random defects, manufacturing processes themselves can introduce reliability risks. This exercise focuses on plasma-induced gate oxide damage, commonly known as the 'antenna effect', which is managed through strict design rules. You will calculate the effective antenna ratio for a multi-layer interconnect net, learning how EDA tools enforce these critical DFM rules by considering process sequence, layer-specific charge collection, and protective structures .",
            "id": "4264269",
            "problem": "A routed interconnect net in an integrated circuit undergoes fabrication in a single-damascene metal stack with a defined etch-deposition sequence. The analysis is in the context of Design for Manufacturability (DFM) within Electronic Design Automation (EDA). The net connects a transistor gate to a remote protection diode located on the highest metal layer. During plasma etch steps, charge arrives at floating conductor surfaces; the ensuing gate-oxide stress derives from fundamental relations $Q = J A t$ for charge delivery to exposed conductor area, gate voltage $V_g = Q / C_g$, and oxide field $E = V_g / t_{\\text{ox}}$, with gate-oxide capacitance $C_g = \\epsilon A_g / t_{\\text{ox}}$. Foundries therefore control risk by bounding an effective area-to-gate-area ratio at each etch step. In practice, this ratio is calibrated per etch step by a layer-specific severity factor and, when applicable, a partial-exposure fraction for multi-pass or partial-connectivity etches.\n\nAssume the following process ordering and physical configuration:\n- Step $S_{1}$: Tungsten contacts to the transistor gate and to the protection diode diffusion are formed. The diode is topologically connected to the net only through a branch on Metal $3$, so the protective path becomes effective only once the Metal $3$ segment is formed and continuous to the diode contact.\n- Step $S_{2}$: Metal $1$ is etched.\n- Step $S_{3}$: Via $1$ (between Metal $1$ and Metal $2$) is etched.\n- Step $S_{4}$: Metal $2$ is etched, in two passes; only a fraction $\\beta_{m2}$ of the metal area is exposed during the first pass before a temporary landing feature reduces subsequent charge collection.\n- Step $S_{5}$: Via $2$ (between Metal $2$ and Metal $3$) is etched.\n- Step $S_{6}$: Metal $3$ is etched; the net’s branch to the diode closes only near the end of the step, so a fraction $\\beta_{m3}$ of the Metal $3$ area contributes to charging before the protective path becomes effective.\n\nThe gate-oxide area is $A_{g} = 0.075 \\,\\mu\\text{m}^{2}$. The net’s geometric areas per layer are:\n- Metal $1$ area $A_{1} = 16.2 \\,\\mu\\text{m}^{2}$,\n- Via $1$ landing area $A_{v1} = 0.012 \\,\\mu\\text{m}^{2}$,\n- Metal $2$ area $A_{2} = 13.4 \\,\\mu\\text{m}^{2}$,\n- Via $2$ landing area $A_{v2} = 0.008 \\,\\mu\\text{m}^{2}$,\n- Metal $3$ area $A_{3} = 20.0 \\,\\mu\\text{m}^{2}$.\n\nFoundry-calibrated plasma charging severity factors (dimensionless, proportional to the product of step-specific current density and duration relative to a baseline) are:\n- $k_{m1} = 0.8$,\n- $k_{v1} = 0.6$,\n- $k_{m2} = 0.95$,\n- $k_{v2} = 0.55$,\n- $k_{m3} = 1.2$.\n\nPartial-exposure fractions are $\\beta_{m2} = 0.5$ and $\\beta_{m3} = 0.85$.\n\nFor each etch step $s \\in \\{S_{2}, S_{3}, S_{4}, S_{5}, S_{6}\\}$, define the per-step effective antenna ratio $r(s)$ as the ratio of the step’s effective charged area connected to the gate (given by the product of the relevant $k$ factor, the applicable partial-exposure fraction for that step, and the corresponding geometric area) to the gate-oxide area $A_{g}$. The foundry specifies maximum allowed ratios per step:\n- $R_{\\max}(m1) = 150$ for Metal $1$ etch at $S_{2}$,\n- $R_{\\max}(v1) = 60$ for Via $1$ etch at $S_{3}$,\n- $R_{\\max}(m2) = 140$ for Metal $2$ etch at $S_{4}$,\n- $R_{\\max}(v2) = 55$ for Via $2$ etch at $S_{5}$,\n- $R_{\\max}(m3) = 160$ for Metal $3$ etch at $S_{6}$.\n\nStarting from the fundamental relations for plasma charging and oxide stress and the process-ordering logic stated above, derive a general expression for $r(s)$ in terms of $k$, $\\beta$, and area parameters, specialized to this single-damascene scenario in which only the currently etched layer’s exposed conductor surfaces contribute during step $s$. Then compute the number of etch steps for which $r(s)$ exceeds the corresponding $R_{\\max}$, i.e., the number of antenna rule violations. Express the final answer as an integer count with no units.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of plasma-induced damage in semiconductor manufacturing, is well-posed with all necessary data provided, and is objectively stated. The task is to first derive a general expression for the per-step effective antenna ratio, $r(s)$, and then to compute the number of manufacturing steps for which this ratio exceeds the foundry-specified maximum.\n\nFirst, we derive the general expression for $r(s)$. The problem establishes that gate-oxide stress is proportional to the electric field $E$ across the oxide. The fundamental relations are provided: collected charge $Q = J A t$, where $J$ is the plasma current density, $A$ is the charge-collecting conductor area, and $t$ is the exposure time. The gate voltage is $V_g = Q / C_g$, and the gate capacitance is $C_g = \\epsilon A_g / t_{\\text{ox}}$, where $A_g$ is the gate-oxide area, $t_{\\text{ox}}$ is the oxide thickness, and $\\epsilon$ is the oxide permittivity. The electric field across the oxide is $E = V_g / t_{\\text{ox}}$.\n\nCombining these relations, we can express the field $E$ as:\n$$E = \\frac{V_g}{t_{\\text{ox}}} = \\frac{Q / C_g}{t_{\\text{ox}}} = \\frac{Q}{C_g t_{\\text{ox}}} = \\frac{J A t}{(\\epsilon A_g / t_{\\text{ox}}) t_{\\text{ox}}} = \\frac{J A t}{\\epsilon A_g}$$\nThis shows that for a given process chemistry (which determines $J$ and $\\epsilon$) and duration ($t$), the damaging field $E$ is directly proportional to the ratio of the charge-collecting area $A$ to the gate area $A_g$.\n\nThe problem defines a practical, calibrated version of this ratio, the effective antenna ratio $r(s)$ for a given etch step $s$. It is defined as the ratio of the step's effective charged area to the gate-oxide area $A_g$. The effective charged area itself is given as the product of a layer-specific severity factor $k(s)$, a partial-exposure fraction $\\beta(s)$ (if applicable), and the geometric area $A(s)$ being etched during that step. The partial-exposure fraction $\\beta(s)$ is $1$ if not explicitly specified otherwise.\n\nTherefore, the general expression for the effective antenna ratio for step $s$ is:\n$$r(s) = \\frac{k(s) \\beta(s) A(s)}{A_g}$$\nThis expression will be used to evaluate the antenna rule compliance at each relevant manufacturing step. The problem states that \"only the currently etched layer’s exposed conductor surfaces contribute during step $s$,\" simplifying the calculation by ignoring cumulative effects from prior layers.\n\nThe given gate-oxide area is $A_g = 0.075 \\,\\mu\\text{m}^{2}$. We now compute $r(s)$ for each of the five etch steps ($S_2$ through $S_6$) and check for violations against the specified maximums.\n\nStep $S_2$: Metal $1$ etch.\nThe relevant parameters are the Metal $1$ area $A_1 = 16.2 \\,\\mu\\text{m}^{2}$ and the severity factor $k_{m1} = 0.8$. No partial exposure is mentioned, so $\\beta=1$.\n$$r(S_2) = \\frac{k_{m1} A_1}{A_g} = \\frac{0.8 \\times 16.2}{0.075} = \\frac{12.96}{0.075} = 172.8$$\nThe maximum allowed ratio is $R_{\\max}(m1) = 150$. Since $r(S_2) = 172.8 > 150$, this step constitutes a violation.\n\nStep $S_3$: Via $1$ etch.\nThe relevant parameters are the Via $1$ landing area $A_{v1} = 0.012 \\,\\mu\\text{m}^{2}$ and the severity factor $k_{v1} = 0.6$. No partial exposure is mentioned, so $\\beta=1$.\n$$r(S_3) = \\frac{k_{v1} A_{v1}}{A_g} = \\frac{0.6 \\times 0.012}{0.075} = \\frac{0.0072}{0.075} = 0.096$$\nThe maximum allowed ratio is $R_{\\max}(v1) = 60$. Since $r(S_3) = 0.096 < 60$, there is no violation.\n\nStep $S_4$: Metal $2$ etch.\nThe relevant parameters are the Metal $2$ area $A_2 = 13.4 \\,\\mu\\text{m}^{2}$, the severity factor $k_{m2} = 0.95$, and the partial-exposure fraction $\\beta_{m2} = 0.5$.\n$$r(S_4) = \\frac{k_{m2} \\beta_{m2} A_2}{A_g} = \\frac{0.95 \\times 0.5 \\times 13.4}{0.075} = \\frac{6.365}{0.075} \\approx 84.867$$\nThe maximum allowed ratio is $R_{\\max}(m2) = 140$. Since $r(S_4) \\approx 84.867 < 140$, there is no violation.\n\nStep $S_5$: Via $2$ etch.\nThe relevant parameters are the Via $2$ landing area $A_{v2} = 0.008 \\,\\mu\\text{m}^{2}$ and the severity factor $k_{v2} = 0.55$. No partial exposure is mentioned, so $\\beta=1$.\n$$r(S_5) = \\frac{k_{v2} A_{v2}}{A_g} = \\frac{0.55 \\times 0.008}{0.075} = \\frac{0.0044}{0.075} \\approx 0.0587$$\nThe maximum allowed ratio is $R_{\\max}(v2) = 55$. Since $r(S_5) \\approx 0.0587 < 55$, there is no violation.\n\nStep $S_6$: Metal $3$ etch.\nThe relevant parameters are the Metal $3$ area $A_3 = 20.0 \\,\\mu\\text{m}^{2}$, the severity factor $k_{m3} = 1.2$, and the partial-exposure fraction $\\beta_{m3} = 0.85$. This fraction accounts for the portion of the etch step before the protective diode is connected.\n$$r(S_6) = \\frac{k_{m3} \\beta_{m3} A_3}{A_g} = \\frac{1.2 \\times 0.85 \\times 20.0}{0.075} = \\frac{20.4}{0.075} = 272$$\nThe maximum allowed ratio is $R_{\\max}(m3) = 160$. Since $r(S_6) = 272 > 160$, this step constitutes a violation.\n\nIn summary, violations were found for step $S_2$ (Metal $1$ etch) and step $S_6$ (Metal $3$ etch). The other steps ($S_3$, $S_4$, $S_5$) are compliant with the specified antenna rules.\n\nThe total number of etch steps for which $r(s)$ exceeds the corresponding $R_{\\max}$ is the sum of the violations found. There are two such steps.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "As technology scales to advanced nodes, manufacturing constraints become too complex for simple rule-based checks, requiring sophisticated algorithmic solutions. This practice tackles the multi-patterning decomposition problem, a critical challenge in modern lithography, by formulating it as an Integer Linear Program (ILP). By constructing and solving this optimization problem, you will explore how modern DFM methodologies balance competing objectives, such as minimizing coloring conflicts and layout modifications, to enable manufacturability .",
            "id": "4264247",
            "problem": "Consider a simplified mathematical model of multi-patterning mask assignment for a single routing layer in integrated circuits, used in Electronic Design Automation (EDA) under Design for Manufacturability (DFM) methodologies. The objective is to minimize feature-coloring conflicts under spacing constraints while minimizing the number of stitches introduced to split a feature across masks. The problem is framed as an Integer Linear Programming (ILP) problem with binary decision variables and linear constraints.\n\nFundamental base:\n- A routing layer consists of a set of segments representing features to be colored by one of a given number of masks (colors). The set of segments is a finite index set with cardinality $P$, denoted by indices $p \\in \\{0,1,\\ldots,P-1\\}$.\n- There are $k$ available masks (colors), indexed $c \\in \\{0,1,\\ldots,k-1\\}$.\n- Spacing constraints are represented by an undirected graph over segments, where each edge $(u,v)$ indicates that segments $u$ and $v$ are too close and therefore must be assigned different colors to avoid a conflict. However, the optimization may tolerate a conflict at a cost if the constraints cannot be satisfied.\n- Some features may be stitchable, represented by pairs of segments $(p_1,p_2)$ belonging to the same feature. A stitch allows the two segments of the pair to be assigned different colors, incurring a penalty. Without a stitch, both segments of the pair must be assigned the same color.\n- Conflicts and stitches carry additive penalties in the objective.\n\nCore definitions to be used for derivation:\n- Binary color assignment variable $x_{p,c} \\in \\{0,1\\}$ indicating whether segment $p$ uses color $c$.\n- Binary conflict indicator $w_{e} \\in \\{0,1\\}$ for each spacing edge $e = (u,v)$ indicating whether $u$ and $v$ have the same color and thus conflict.\n- Binary stitch indicator $s_{i} \\in \\{0,1\\}$ for each stitchable pair $i = (p_1,p_2)$ indicating whether a stitch is inserted, enabling $p_1$ and $p_2$ to have different colors; if $s_i=0$, both must use the same color.\n\nYour task:\n- Derive from the above base a correct ILP formulation that captures the logical requirements:\n    - Each segment selects exactly one color.\n    - A conflict indicator is activated if and only if two adjacent segments share the same color.\n    - A stitch indicator allows color difference between the two segments in the pair; otherwise, both segments must share the same color.\n- Implement a solver using a standard Mixed-Integer Linear Programming (MILP) routine that computes the minimum total penalty, defined as the sum of conflict penalties and stitch penalties. The solver must handle the binary variables described above and the necessary linearization to encode logical conditions.\n- For each test case, return the minimum total penalty, defined as the sum of conflict penalties and stitch penalties.\n\nAngle units are not applicable. No physical units are involved. All outputs must be numeric.\n\nTest suite:\n- Test Case 1 (benefit of stitches on an odd cycle when pairs are constrained): \n    - $k = 2$.\n    - Segments: $P=6$, indices $0,1,2,3,4,5$.\n    - Stitchable pairs: $(0,1)$, $(2,3)$, $(4,5)$.\n    - Spacing edges: $(0,2)$, $(3,4)$, $(5,1)$.\n    - Conflict penalty weight $W_{\\text{conflict}} = 10$.\n    - Stitch penalty weight $W_{\\text{stitch}} = 1$.\n- Test Case 2 (bipartite no-stitch solution, happy path):\n    - $k = 2$.\n    - Segments: $P=4$, indices $0,1,2,3$.\n    - Stitchable pairs: $(0,1)$, $(2,3)$.\n    - Spacing edges: $(0,2)$, $(1,3)$.\n    - Conflict penalty weight $W_{\\text{conflict}} = 10$.\n    - Stitch penalty weight $W_{\\text{stitch}} = 5$.\n- Test Case 3 (non-2-colorable triangle without stitches, edge case):\n    - $k = 2$.\n    - Segments: $P=3$, indices $0,1,2$.\n    - Stitchable pairs: none.\n    - Spacing edges: $(0,1)$, $(1,2)$, $(2,0)$.\n    - Conflict penalty weight $W_{\\text{conflict}} = 3$.\n    - Stitch penalty weight $W_{\\text{stitch}} = 0$.\n\nProgram output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is the minimum total penalty for the corresponding test case, expressed as an integer.\n\nScientific realism and derivation requirements:\n- Start from the above fundamental definitions and standard logical relationships between variables.\n- Derive the ILP constraints systematically and avoid shortcut formulas or prespecified expressions for the target constraints.\n- Ensure the formulation is mathematically sound and solvable by a modern MILP solver.\n- The program must be self-contained and must not read inputs from any external source.",
            "solution": "The problem presented is a valid optimization task rooted in the field of Electronic Design Automation (EDA) for integrated circuits, specifically addressing multi-patterning lithography. It requires the formulation and solution of an Integer Linear Program (ILP) to minimize coloring conflicts and the use of stitches. The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution in terms of the minimum objective value. I will now proceed with a systematic derivation of the ILP formulation, followed by its implementation.\n\nAn Integer Linear Program is defined by an objective function to be minimized or maximized, a set of decision variables, and a system of linear constraints that the variables must satisfy.\n\n**1. Decision Variables**\n\nAs defined in the problem statement, we have three types of binary decision variables:\n-   $x_{p,c} \\in \\{0,1\\}$: This variable is $1$ if segment $p$ is assigned color $c$, and $0$ otherwise. Here, $p \\in \\{0, 1, \\ldots, P-1\\}$ is the segment index and $c \\in \\{0, 1, \\ldots, k-1\\}$ is the color index.\n-   $w_{e} \\in \\{0,1\\}$: For each spacing edge $e = (u,v)$ in the set of all such edges $E$, this variable is $1$ if a conflict occurs (i.e., segments $u$ and $v$ are assigned the same color), and $0$ otherwise.\n-   $s_{i} \\in \\{0,1\\}$: For each stitchable pair of segments $i = (p_1, p_2)$ in the set of all such pairs $S$, this variable is $1$ if a stitch is used (allowing $p_1$ and $p_2$ to have different colors), and $0$ otherwise.\n\n**2. Objective Function**\n\nThe goal is to minimize the total penalty, which is the additive sum of penalties from all conflicts and all stitches. The penalty for a single conflict is given by the weight $W_{\\text{conflict}}$, and for a single stitch by $W_{\\text{stitch}}$. The objective function $Z$ can thus be formulated as a linear combination of the $w_e$ and $s_i$ variables:\n$$ \\text{minimize } Z = W_{\\text{conflict}} \\sum_{e \\in E} w_e + W_{\\text{stitch}} \\sum_{i \\in S} s_i $$\nThis expression is linear, as required for an ILP.\n\n**3. Constraints Derivation**\n\nThe logical requirements of the model must be translated into a set of linear inequalities and equalities.\n\n**3.1. Unique Color Assignment Constraint**\nEach segment must be assigned exactly one color. For any given segment $p$, the sum of its assignment variables $x_{p,c}$ over all possible colors $c$ must equal $1$. This ensures that one, and only one, $x_{p,c}$ is equal to $1$. This gives us a set of $P$ linear equality constraints:\n$$ \\sum_{c=0}^{k-1} x_{p,c} = 1 \\quad \\forall p \\in \\{0, 1, \\ldots, P-1\\} $$\n\n**3.2. Conflict Indicator Constraint**\nA conflict indicator $w_e$ for an edge $e=(u,v)$ must be activated ($w_e=1$) if and only if segments $u$ and $v$ are assigned the same color. This logical condition needs to be linearized.\nThe condition \"u and v have the same color\" is true if there exists a color $c$ for which both $x_{u,c}=1$ and $x_{v,c}=1$. The sum $x_{u,c} + x_{v,c}$ for a specific color $c$ can be $0$, $1$, or $2$. A conflict for that color occurs when the sum is $2$.\n\nTo link this to the binary variable $w_e$, we must enforce that if $x_{u,c} + x_{v,c} = 2$ for any color $c$, then $w_e$ must be $1$. We can establish this with the following inequality for each color $c$:\n$$ x_{u,c} + x_{v,c} - 1 \\le w_e $$\nLet us verify this constraint. If segments $u$ and $v$ are assigned different colors, then for any color $c$, at most one of $x_{u,c}$ and $x_{v,c}$ can be $1$. Thus, $x_{u,c} + x_{v,c} \\le 1$, and the constraint becomes $x_{u,c} + x_{v,c} - 1 \\le 0 \\le w_e$. This does not force $w_e$ to be $0$, but since the objective function minimizes $w_e$, the solver will set $w_e$ to $0$ if there is no conflict. If $u$ and $v$ are assigned the same color $c^*$, then $x_{u,c^*} = 1$ and $x_{v,c^*} = 1$. The constraint for $c^*$ becomes $1+1-1 \\le w_e$, which simplifies to $1 \\le w_e$. Since $w_e$ is a binary variable, it is forced to be $1$.\nThis formulation correctly captures the logic. We therefore introduce $|E| \\times k$ such constraints:\n$$ x_{u,c} + x_{v,c} - 1 \\le w_e \\quad \\forall e=(u,v) \\in E, \\forall c \\in \\{0, 1, \\ldots, k-1\\} $$\n\n**3.3. Stitch Indicator Constraint**\nFor a stitchable pair $i=(p_1, p_2)$, if no stitch is used ($s_i=0$), the segments must have the same color. If a stitch is used ($s_i=1$), they are permitted to have different colors. This conditional logic must be linearized.\n\nThe condition \"must have the same color\" means $x_{p_1,c} = x_{p_2,c}$ for all colors $c$. This is equivalent to $|x_{p_1,c} - x_{p_2,c}| = 0$.\nThe condition \"may have different colors\" imposes no restriction.\n\nWe can model this using the binary variable $s_i$. The constraint should be active when $s_i=0$ and relaxed when $s_i=1$. Consider the inequalities:\n$$ x_{p_1,c} - x_{p_2,c} \\le s_i $$\n$$ x_{p_2,c} - x_{p_1,c} \\le s_i $$\nLet us verify this formulation. If $s_i=0$, the constraints become $x_{p_1,c} - x_{p_2,c} \\le 0$ and $x_{p_2,c} - x_{p_1,c} \\le 0$. Together, these imply $x_{p_1,c} = x_{p_2,c}$ for all $c$, which correctly enforces the same color assignment. If $s_i=1$, the constraints become $x_{p_1,c} - x_{p_2,c} \\le 1$ and $x_{p_2,c} - x_{p_1,c} \\le 1$. Since $x_{p,c}$ variables are binary, their difference can only be $-1$, $0$, or $1$. These inequalities are always satisfied for any valid color assignment, thus correctly relaxing the constraint.\nThis yields $|S| \\times k \\times 2$ linear inequalities:\n$$ x_{p_1, c} - x_{p_2, c} \\le s_i \\quad \\forall i=(p_1, p_2) \\in S, \\forall c \\in \\{0, \\ldots, k-1\\} $$\n$$ x_{p_2, c} - x_{p_1, c} \\le s_i \\quad \\forall i=(p_1, p_2) \\in S, \\forall c \\in \\{0, \\ldots, k-1\\} $$\n\n**4. Complete ILP Formulation Summary**\n\n-   **Variables**:\n    -   $x_{p,c} \\in \\{0,1\\}$ for $p \\in \\{0, \\ldots, P-1\\}$, $c \\in \\{0, \\ldots, k-1\\}$\n    -   $w_e \\in \\{0,1\\}$ for $e \\in E$\n    -   $s_i \\in \\{0,1\\}$ for $i \\in S$\n-   **Objective**:\n    $$ \\text{minimize } Z = W_{\\text{conflict}} \\sum_{e \\in E} w_e + W_{\\text{stitch}} \\sum_{i \\in S} s_i $$\n-   **Constraints**:\n    1.  $\\sum_{c=0}^{k-1} x_{p,c} = 1 \\quad \\forall p \\in \\{0, \\ldots, P-1\\}$\n    2.  $x_{u,c} + x_{v,c} - 1 \\le w_e \\quad \\forall e=(u,v) \\in E, \\forall c \\in \\{0, \\ldots, k-1\\}$\n    3.  $x_{p_1, c} - x_{p_2, c} \\le s_i \\quad \\forall i=(p_1, p_2) \\in S, \\forall c \\in \\{0, \\ldots, k-1\\}$\n    4.  $x_{p_2, c} - x_{p_1, c} \\le s_i \\quad \\forall i=(p_1, p_2) \\in S, \\forall c \\in \\{0, \\ldots, k-1\\}$\n\nThis completes the derivation of the ILP model. The subsequent step is to implement a solver based on this formulation.",
            "answer": "[1,0,3]"
        }
    ]
}