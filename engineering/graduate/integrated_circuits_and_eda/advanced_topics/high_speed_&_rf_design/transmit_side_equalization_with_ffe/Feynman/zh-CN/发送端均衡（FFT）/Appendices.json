{
    "hands_on_practices": [
        {
            "introduction": "设计前馈均衡器（FFE）的一个基本方法是迫零（Zero-Forcing, ZF）法，其目标是在特定的采样点上完全消除码间串扰（ISI）。此练习  要求您通过求解从信道响应推导出的线性方程组来设计一个多抽头 ZF-FFE。随后，您将通过计算残余 ISI 并将其转化为如眼高和时序裕量等关键性能指标，来分析均衡器的有效性，从而获得从设计目标到系统级影响的完整视图。",
            "id": "4306692",
            "problem": "考虑一个基带脉冲幅度调制 (PAM-2) 不归零 (NRZ) 发射机，它在一个线性时不变信道上使用发射端前馈均衡器 (FFE)。设符号字母表为 $\\{\\pm 1\\}$，符号周期为单位间隔 (UI)。以符号速率采样的离散时间信道冲激响应由 $h[0]=0.9$，$h[1]=0.25$，$h[2]=0.12$，$h[3]=0.06$，$h[4]=0.03$ 给出，且对于 $k\\geq 5$，$h[k]=0$。发射机采用一个 $5$ 抽头的因果 FFE，其抽头 $f[0], f[1], f[2], f[3], f[4]$ 的选择使得组合离散时间响应 $g[k]=(f*h)[k]$ 满足 $g[0]=1$ 和 $g[1]=g[2]=g[3]=g[4]=0$（对前四个后随码元进行迫零，主码元为单位值）。假设连续时间波形在其标称采样时刻附近对于孤立跳变具有局部线性过零行为，其斜率大小为 $s=3$（单位为振幅/UI）。（此斜率为仅由主码元产生的标称阈值穿越点处接收波形的时间导数值）。\n\n从卷积定义出发，确定满足所述约束条件的 FFE 抽头，并用它们计算 $k\\geq 5$ 时的残余后随码元项 $g[k]$。使用适用于 $\\{\\pm 1\\}$ NRZ 的最坏情况码间串扰 (ISI) 逻辑，评估：\n- 根据给定的 $h[k]$ 计算均衡前的眼高和眼宽，\n- 根据得到的 $g[k]$ 计算均衡后的眼高和眼宽。\n\n将眼高定义为在采样时刻所有符号序列下的最小垂直张开度（忽略加性噪声），将眼宽定义为在判决阈值处的水平张开度（以 UI 为单位），通过 $\\Delta t = |R|/s$ 来近似最坏情况下的过零时间闭合，其中 $R$ 是被视为在过零点附近局部恒定的最大幅度残余 ISI 贡献，$s$ 是给定的斜率大小。\n\n最后，给定总抖动预算为 $0.2$ UI，计算定时裕度，即均衡后眼宽减去 $0.2$ UI。将最终的定时裕度结果四舍五入到四位有效数字，并以单位间隔 (UI) 表示。",
            "solution": "该问题在科学上是合理的、提法得当、客观，并包含了得出唯一解所需的所有必要信息。FFE、迫零均衡、ISI 和眼图等概念是数字通信领域的标准内容。我将继续进行解答。\n\n总体流程如下：\n1. 通过求解从迫零约束导出的线性方程组，确定 $5$ 个 FFE 抽头 $f[k]$。\n2. 使用计算出的 FFE 抽头，计算 $k \\geq 5$ 时的残余后随码元 ISI 项 $g[k]$。\n3. 通过计算信道响应 $h[k]$ 的眼高和眼宽，分析均衡前的性能。\n4. 通过计算均衡后响应 $g[k]$ 的眼高和眼宽，分析均衡后的性能。\n5. 从均衡后的眼宽中减去给定的抖动预算，计算最终的定时裕度。\n\n步骤 1：FFE 抽头计算\n组合离散时间响应 $g[k]$ 是 FFE 抽头 $f[k]$ 和信道响应 $h[k]$ 的卷积：\n$$g[k] = (f*h)[k] = \\sum_{j=0}^{\\infty} f[j] h[k-j]$$\n给定一个 $5$ 抽头的因果 FFE，对于 $j \\notin \\{0, 1, 2, 3, 4\\}$，$f[j]=0$。约束条件为 $g[0]=1$ 和 $g[1]=g[2]=g[3]=g[4]=0$。我们可以将这些约束写成一个线性方程组：\n$g[0] = f[0]h[0] = 1$\n$g[1] = f[0]h[1] + f[1]h[0] = 0$\n$g[2] = f[0]h[2] + f[1]h[1] + f[2]h[0] = 0$\n$g[3] = f[0]h[3] + f[1]h[2] + f[2]h[1] + f[3]h[0] = 0$\n$g[4] = f[0]h[4] + f[1]h[3] + f[2]h[2] + f[3]h[1] + f[4]h[0] = 0$\n\n我们可以依次求解这个下三角系统以得到 $f[k]$。给定的信道抽头为 $h[0]=0.9$，$h[1]=0.25$，$h[2]=0.12$，$h[3]=0.06$，$h[4]=0.03$。\n\n对于 $f[0]$：\n$f[0] = \\frac{1}{h[0]} = \\frac{1}{0.9} \\approx 1.11111$\n\n对于 $f[1]$：\n$f[1] = -\\frac{f[0]h[1]}{h[0]} = -f[0]\\frac{h[1]}{h[0]} = -(\\frac{1}{0.9})\\frac{0.25}{0.9} = -\\frac{0.25}{0.81} \\approx -0.30864$\n\n对于 $f[2]$：\n$f[2] = -\\frac{f[0]h[2] + f[1]h[1]}{h[0]} = -\\frac{(1.11111)(0.12) + (-0.30864)(0.25)}{0.9} = -\\frac{0.13333 - 0.07716}{0.9} = -\\frac{0.05617}{0.9} \\approx -0.06241$\n\n对于 $f[3]$：\n$f[3] = -\\frac{f[0]h[3] + f[1]h[2] + f[2]h[1]}{h[0]} = -\\frac{(1.11111)(0.06) + (-0.30864)(0.12) + (-0.06241)(0.25)}{0.9}$\n$f[3] = -\\frac{0.06667 - 0.03704 - 0.01560}{0.9} = -\\frac{0.01403}{0.9} \\approx -0.01558$\n\n对于 $f[4]$：\n$f[4] = -\\frac{f[0]h[4] + f[1]h[3] + f[2]h[2] + f[3]h[1]}{h[0]}$\n$f[4] = -\\frac{(1.11111)(0.03) + (-0.30864)(0.06) + (-0.06241)(0.12) + (-0.01558)(0.25)}{0.9}$\n$f[4] = -\\frac{0.03333 - 0.01852 - 0.00749 - 0.00390}{0.9} = -\\frac{0.00342}{0.9} \\approx -0.00381$\n\nFFE 抽头近似为：$f[0] \\approx 1.1111$，$f[1] \\approx -0.3086$，$f[2] \\approx -0.0624$，$f[3] \\approx -0.0156$，$f[4] \\approx -0.0038$。\n\n步骤 2：残余 ISI 计算\n通过继续卷积，可以找到 $k \\geq 5$ 时的残余后随码元 ISI 项 $g[k]$。注意，对于 $k \\geq 5$，$h[k]=0$。\n$g[5] = f[1]h[4] + f[2]h[3] + f[3]h[2] + f[4]h[1]$\n$g[5] \\approx (-0.30864)(0.03) + (-0.06241)(0.06) + (-0.01558)(0.12) + (-0.00381)(0.25)$\n$g[5] \\approx -0.00926 - 0.00374 - 0.00187 - 0.00095 = -0.01582$\n\n$g[6] = f[2]h[4] + f[3]h[3] + f[4]h[2]$\n$g[6] \\approx (-0.06241)(0.03) + (-0.01558)(0.06) + (-0.00381)(0.12)$\n$g[6] \\approx -0.00187 - 0.00093 - 0.00046 = -0.00326$\n\n$g[7] = f[3]h[4] + f[4]h[3]$\n$g[7] \\approx (-0.01558)(0.03) + (-0.00381)(0.06) = -0.00047 - 0.00023 = -0.00070$\n\n$g[8] = f[4]h[4] \\approx (-0.00381)(0.03) = -0.00011$\n对于 $k8$，$g[k]=0$。\n\n步骤 3：均衡前眼图分析\n在采样时刻 $n$ 的接收信号为 $y[n] = \\sum_{k=0}^{4} a_{n-k} h[k] = a_n h[0] + \\sum_{k=1}^{4} a_{n-k} h[k]$。\n码间串扰 (ISI) 项为 $I[n] = \\sum_{k=1}^{4} a_{n-k} h[k]$。对于 PAM-2 字母表 $\\{\\pm 1\\}$，当所有 ISI 项同相相加时，出现最坏情况的 ISI 幅度 $R_{pre}$：\n$R_{pre} = \\sum_{k=1}^{4} |h[k]| = |0.25| + |0.12| + |0.06| + |0.03| = 0.46$。\n眼高是最小的垂直张开度。对于发射的 $+1$，最低电平为 $h[0] - R_{pre}$；对于发射的 $-1$，最高电平为 $-h[0] + R_{pre}$。\n$EH_{pre} = (h[0] - R_{pre}) - (-h[0] + R_{pre}) = 2(h[0] - R_{pre}) = 2(0.9 - 0.46) = 2(0.44) = 0.88$。\n眼宽是判决阈值处的水平张开度。它是 $1$ UI 减去两侧的闭合量。时域闭合量近似为 $\\Delta t = R/s$。总宽度减少量为 $2\\Delta t$。\n$EW_{pre} = 1 - \\frac{2 R_{pre}}{s} = 1 - \\frac{2(0.46)}{3} \\approx 1 - 0.3067 = 0.6933$ UI。\n\n步骤 4：均衡后眼图分析\n均衡后，响应为 $g[k]$。最坏情况下的残余 ISI 幅度 $R_{post}$ 是非中心抽头绝对值之和：\n$R_{post} = \\sum_{k=1}^{\\infty} |g[k]| = |g[1]| + \\dots + |g[4]| + \\sum_{k=5}^{8} |g[k]|$。\n根据设计，$g[1..4]=0$。\n$R_{post} = \\sum_{k=5}^{8} |g[k]| \\approx |-0.01582| + |-0.00326| + |-0.00070| + |-0.00011| = 0.01989$。\n我们使用更精确的值进行求和：$|-0.0158267| + |-0.0032647| + |-0.0006961| + |-0.0001143| \\approx 0.019902$。\n均衡后的眼高为：\n$EH_{post} = 2(g[0] - R_{post}) = 2(1 - R_{post}) \\approx 2(1 - 0.019902) = 2(0.980098) = 1.9602$。\n均衡后的眼宽为：\n$EW_{post} = 1 - \\frac{2 R_{post}}{s} \\approx 1 - \\frac{2(0.019902)}{3} = 1 - \\frac{0.039804}{3} = 1 - 0.013268 = 0.986732$ UI。\n\n步骤 5：定时裕度计算\n定时裕度是均衡后眼宽减去总抖动预算。\n抖动预算 = $0.2$ UI。\n定时裕度 = $EW_{post} - \\text{抖动预算}$\n定时裕度 $\\approx 0.986732 - 0.2 = 0.786732$ UI。\n将结果四舍五入到四位有效数字，得到 $0.7867$ UI。",
            "answer": "$$\n\\boxed{0.7867}\n$$"
        },
        {
            "introduction": "虽然迫零法在概念上很直观，但它可能导致过大的抽头系数，从而放大噪声并增加功耗。此练习  介绍了一种更稳健的解决方案：使用 $\\ell_2$ 范数惩罚的正则化最小二乘法。您将学习如何将均衡器设计构建为一个凸优化问题，该问题在最小化残余 ISI 和抑制抽头系数幅度之间取得平衡，这在实际的高速链路设计中是一个至关重要的权衡。",
            "id": "4306616",
            "problem": "考虑一个在电子设计自动化 (EDA) 中使用前馈均衡 (FFE) 的高速串行发送器，其通过预加重符号，使得总的离散时间基带信道响应更接近一个抑制码间干扰的目标。设离散时间线性时不变 (LTI) 信道脉冲响应为长度为$3$的序列 $h[0]=\\frac{1}{2}$，$h[1]=1$，$h[2]=\\frac{1}{2}$。FFE 是一个长度为$3$的离散时间有限脉冲响应滤波器，其抽头向量为 $w=\\begin{pmatrix}w_{0}  w_{1}  w_{2}\\end{pmatrix}^{\\mathsf{T}}$，并以符号速率应用。\n\n根据标准的离散时间卷积定义，有效信道脉冲响应 $g[n]$ 等于卷积 $g[n]=\\sum_{k=0}^{2}w_{k}\\,h[n-k]$。为了在保留主抽头的同时抑制最近的前向和后向码间干扰，设计目标是在最小二乘意义下，将三个采样点 $\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$ 拟合到期望向量 $d=\\begin{pmatrix}0  1  0\\end{pmatrix}^{\\mathsf{T}}$。为了限制因抽头幅度过大而引起的发送端噪声放大，引入一个带有惩罚参数 $\\lambda=0.1$ 的 $\\ell_{2}$范数正则化项，并定义代价函数\n$$\nJ(w)=\\left\\|H\\,w-d\\right\\|_{2}^{2}+\\lambda\\left\\|w\\right\\|_{2}^{2},\n$$\n其中 $H$ 是由与 $h[n]$ 的离散时间卷积所隐含的、从 $w$到$\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$的线性映射。\n\n从离散时间卷积和带 $\\ell_{2}$ 正则化的最小二乘估计的基本定义出发，推导 $w$ 的最优性条件，并计算在给定的 $h[n]$ 和 $\\lambda=0.1$ 下最小化 $J(w)$ 的 FFE 抽头向量 $w$。将抽头向量的最终答案表示为使用 $\\begin{pmatrix}\\cdot\\end{pmatrix}$ 符号的单行向量，其中包含精确分数。无需四舍五入，且不涉及物理单位。",
            "solution": "题目要求解一个3抽头前馈均衡器 (FFE) 的最优抽头向量 $w = \\begin{pmatrix}w_{0}  w_{1}  w_{2}\\end{pmatrix}^{\\mathsf{T}}$，该向量能最小化一个正则化的最小二乘代价函数。目标是整形总信道响应以抑制码间干扰 (ISI)。\n\n首先，我们必须构建矩阵 $H$，它定义了从 FFE 抽头 $w$ 到均衡后信道响应的相关样本 $\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$ 的线性变换。有效信道响应 $g[n]$ 由 FFE 抽头 $w[k]$ 和信道脉冲响应 $h[n]$ 的离散时间卷积给出。给定 $w[k]$ 仅在 $k \\in \\{0, 1, 2\\}$ 时存在，在其他情况下为零；信道响应为 $h[0]=\\frac{1}{2}$，$h[1]=1$，$h[2]=\\frac{1}{2}$，在其他索引处为零。\n\n卷积定义为 $g[n] = \\sum_{k=-\\infty}^{\\infty} w[k]h[n-k]$。由于 $w[k]$ 仅在 $k \\in \\{0, 1, 2\\}$ 时非零，该求和变为：\n$$g[n] = \\sum_{k=0}^{2} w_k h[n-k] = w_0 h[n] + w_1 h[n-1] + w_2 h[n-2]$$\n我们需要计算该表达式在 $n=1, 2, 3$ 时的值：\n当 $n=1$ 时：\n$g[1] = w_0 h[1] + w_1 h[0] + w_2 h[-1] = w_0(1) + w_1(\\frac{1}{2}) + w_2(0) = w_0 + \\frac{1}{2}w_1$。\n当 $n=2$ 时：\n$g[2] = w_0 h[2] + w_1 h[1] + w_2 h[0] = w_0(\\frac{1}{2}) + w_1(1) + w_2(\\frac{1}{2}) = \\frac{1}{2}w_0 + w_1 + \\frac{1}{2}w_2$。\n当 $n=3$ 时：\n$g[3] = w_0 h[3] + w_1 h[2] + w_2 h[1] = w_0(0) + w_1(\\frac{1}{2}) + w_2(1) = \\frac{1}{2}w_1 + w_2$。\n\n这个线性方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}g[1] \\\\ g[2] \\\\ g[3]\\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix}w_0 \\\\ w_1 \\\\ w_2\\end{pmatrix}\n$$\n因此，矩阵 $H$ 为：\n$$H = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix}$$\n期望响应向量为 $d = \\begin{pmatrix}0  1  0\\end{pmatrix}^{\\mathsf{T}}$。\n\n需要最小化的代价函数是 $J(w) = \\|Hw-d\\|_{2}^{2} + \\lambda\\|w\\|_{2}^{2}$，其中 $\\lambda=0.1$。\n我们可以用向量转置来表示平方范数：\n$$J(w) = (Hw-d)^{\\mathsf{T}}(Hw-d) + \\lambda w^{\\mathsf{T}}w$$\n展开第一项得到：\n$$J(w) = (w^{\\mathsf{T}}H^{\\mathsf{T}} - d^{\\mathsf{T}})(Hw-d) + \\lambda w^{\\mathsf{T}}w = w^{\\mathsf{T}}H^{\\mathsf{T}}Hw - w^{\\mathsf{T}}H^{\\mathsf{T}}d - d^{\\mathsf{T}}Hw + d^{\\mathsf{T}}d + \\lambda w^{\\mathsf{T}}w$$\n由于 $d^{\\mathsf{T}}Hw$ 是一个标量，它等于其转置 $(d^{\\mathsf{T}}Hw)^{\\mathsf{T}} = w^{\\mathsf{T}}H^{\\mathsf{T}}d$。因此：\n$$J(w) = w^{\\mathsf{T}}H^{\\mathsf{T}}Hw - 2d^{\\mathsf{T}}Hw + d^{\\mathsf{T}}d + \\lambda w^{\\mathsf{T}}w$$\n为求最小值，我们计算 $J(w)$ 对 $w$ 的梯度并令其为零。使用标准的矩阵微积分结果 $\\nabla_w(w^{\\mathsf{T}}Aw) = (A+A^{\\mathsf{T}})w$ 和 $\\nabla_w(b^{\\mathsf{T}}w) = b$：\n$$\\nabla_w J(w) = \\nabla_w (w^{\\mathsf{T}}(H^{\\mathsf{T}}H + \\lambda I)w - 2(H^{\\mathsf{T}}d)^{\\mathsf{T}}w + d^{\\mathsf{T}}d) = 0$$\n矩阵 $H^{\\mathsf{T}}H + \\lambda I$ 是对称的。因此，梯度为：\n$$\\nabla_w J(w) = 2(H^{\\mathsf{T}}H + \\lambda I)w - 2H^{\\mathsf{T}}d = 0$$\n这就得到了最优性条件，也称为 Tikhonov 正则化最小二乘的正规方程：\n$$(H^{\\mathsf{T}}H + \\lambda I)w = H^{\\mathsf{T}}d$$\n最优向量 $w$ 是这个线性方程组的解。\n\n现在我们代入给定的值。矩阵 $H$ 是对称的，所以 $H^{\\mathsf{T}}=H$。\n首先，计算 $H^{\\mathsf{T}}H = H^2$：\n$$H^2 = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4} \\\\ \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4}+1+\\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2} \\\\ \\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4}+1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4} \\end{pmatrix}$$\n接下来，我们构建矩阵 $A = H^{\\mathsf{T}}H + \\lambda I$，其中 $\\lambda = 0.1 = \\frac{1}{10}$：\n$$A = \\begin{pmatrix} \\frac{5}{4}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4} \\end{pmatrix} + \\frac{1}{10}\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}+\\frac{1}{10}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}+\\frac{1}{10}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4}+\\frac{1}{10} \\end{pmatrix}$$\n$$A = \\begin{pmatrix} \\frac{25+2}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{15+1}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{25+2}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{27}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{16}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{27}{20} \\end{pmatrix}$$\n最优性条件的右边是 $H^{\\mathsf{T}}d$：\n$$H^{\\mathsf{T}}d = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}$$\n我们必须求解方程组 $Aw = H^{\\mathsf{T}}d$：\n$$\n\\begin{pmatrix} \\frac{27}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{16}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{27}{20} \\end{pmatrix} \\begin{pmatrix}w_0 \\\\ w_1 \\\\ w_2\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\n该方程组表现出对称性。矩阵的第一行和第三行相互映照，且右侧向量的第一和第三个分量相同。这意味着 $w_0 = w_2$。\n利用这种对称性，我们可以简化该系统。第一个方程变为：\n$\\frac{27}{20}w_0 + w_1 + \\frac{5}{20}w_2 = \\frac{1}{2} \\implies \\frac{27}{20}w_0 + w_1 + \\frac{5}{20}w_0 = \\frac{1}{2} \\implies \\frac{32}{20}w_0 + w_1 = \\frac{1}{2} \\implies \\frac{8}{5}w_0 + w_1 = \\frac{1}{2}$\n第二个方程变为：\n$w_0 + \\frac{16}{10}w_1 + w_2 = 1 \\implies w_0 + \\frac{8}{5}w_1 + w_0 = 1 \\implies 2w_0 + \\frac{8}{5}w_1 = 1$\n现在我们得到一个关于 $w_0$ 和 $w_1$ 的 $2 \\times 2$ 方程组：\n1) $\\frac{8}{5}w_0 + w_1 = \\frac{1}{2}$\n2) $2w_0 + \\frac{8}{5}w_1 = 1$\n从方程 (1)，我们将 $w_1$ 用 $w_0$ 表示：$w_1 = \\frac{1}{2} - \\frac{8}{5}w_0$。\n将此代入方程 (2)：\n$2w_0 + \\frac{8}{5}\\left(\\frac{1}{2} - \\frac{8}{5}w_0\\right) = 1$\n$2w_0 + \\frac{4}{5} - \\frac{64}{25}w_0 = 1$\n$w_0\\left(2 - \\frac{64}{25}\\right) = 1 - \\frac{4}{5}$\n$w_0\\left(\\frac{50 - 64}{25}\\right) = \\frac{1}{5}$\n$w_0\\left(-\\frac{14}{25}\\right) = \\frac{1}{5}$\n$w_0 = \\frac{1}{5} \\left(-\\frac{25}{14}\\right) = -\\frac{5}{14}$\n现在我们求解 $w_1$：\n$w_1 = \\frac{1}{2} - \\frac{8}{5}w_0 = \\frac{1}{2} - \\frac{8}{5}\\left(-\\frac{5}{14}\\right) = \\frac{1}{2} + \\frac{8}{14} = \\frac{1}{2} + \\frac{4}{7} = \\frac{7+8}{14} = \\frac{15}{14}$\n并且 $w_2 = w_0$，所以 $w_2 = -\\frac{5}{14}$。\n最小化代价函数的 FFE 抽头向量为 $w = \\begin{pmatrix} -\\frac{5}{14}  \\frac{15}{14}  -\\frac{5}{14} \\end{pmatrix}^{\\mathsf{T}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{14}  \\frac{15}{14}  -\\frac{5}{14} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在正则化概念的基础上，我们可以采用不同的约束来实现特定的设计目标。这个高级练习  探讨了如何使用 $\\ell_1$ 范数约束来管理发射器的输出摆幅，这是一种与 LASSO 回归密切相关的技术。您将通过推导 KKT 条件深入学习凸优化，并发现解的结构会自然地在抽头权重中引入稀疏性和收缩效应，这对于简化硬件实现是一种非常理想的属性。",
            "id": "4306670",
            "problem": "一个串行链路发送器采用一个离散时间长度为$3$的前馈均衡器 (FFE)，其系数向量为 $w \\in \\mathbb{R}^{3}$，用于对一个白化训练序列进行预加重。在长度为$N$的训练区间上，均衡后的输出建模为 $y = X w$，其中回归矩阵 $X \\in \\mathbb{R}^{N \\times 3}$ 具有标准正交列，即 $X^{\\top} X = I_{3}$。目标向量为 $d \\in \\mathbb{R}^{N}$，设计旨在最小化均方误差代价 $J(w) = \\tfrac{1}{2}\\|X w - d\\|_{2}^{2}$，并服从一个限制FFE抽头系数幅度之和的发送摆幅裕度约束：\n$$\n\\|w\\|_{1} \\leq S_{\\max}.\n$$\n这种$\\ell_{1}$型摆幅约束是在电子设计自动化 (EDA) 签核流程中遇到的，对于在后段工艺约束下的电流模式驱动器线性度所施加的峰值和限制的一种凸代理。\n\n从最小二乘的定义和矩阵$X$列向量的标准正交性出发，将此约束设计问题表示为以下形式的等价凸规划问题：\n$$\n\\min_{w \\in \\mathbb{R}^{3}} \\ \\tfrac{1}{2}\\|w - a\\|_{2}^{2} \\quad \\text{以满足} \\quad \\|w\\|_{1} \\leq S_{\\max},\n$$\n其中 $a \\in \\mathbb{R}^{3}$ 是一个适当定义的向量。利用针对不可微约束的凸优化的第一性原理，推导该问题的 Karush–Kuhn–Tucker (KKT) 最优性条件，并求解其闭式解，从而得到以$a$和$S_{\\max}$表示的最优解$w^{\\star}$。然后，对于特定实例\n$$\na = \\begin{pmatrix} \\tfrac{9}{10} \\\\ -\\tfrac{2}{5} \\\\ \\tfrac{1}{5} \\end{pmatrix}, \\qquad S_{\\max} = 1,\n$$\n计算精确最优解$w^{\\star}$。最后，根据摆幅约束引起的稀疏性和收缩来解释$w^{\\star}$的结构。你最终报告的答案必须是精确最优解$w^{\\star}$，表示为单个行向量。不包含单位。不要四舍五入。",
            "solution": "用户要求我解决一个约束优化问题。\n\n### 步骤1：提取已知条件\n-   **模型**：一个串行链路发送器使用一个长度为$3$的前馈均衡器 (FFE)，其系数向量为 $w \\in \\mathbb{R}^{3}$。\n-   **训练数据**：训练区间长度为$N$。均衡后的输出为 $y = Xw$。\n-   **回归矩阵**：$X \\in \\mathbb{R}^{N \\times 3}$ 具有标准正交列，因此 $X^{\\top} X = I_{3}$。\n-   **目标**：目标向量为 $d \\in \\mathbb{R}^{N}$。\n-   **代价函数**：目标是最小化均方误差 $J(w) = \\tfrac{1}{2}\\|X w - d\\|_{2}^{2}$。\n-   **约束**：FFE抽头系数受发送摆幅裕度约束 $\\|w\\|_{1} \\leq S_{\\max}$ 的限制。\n-   **任务1**：将问题重构为 $\\min_{w \\in \\mathbb{R}^{3}} \\ \\tfrac{1}{2}\\|w - a\\|_{2}^{2}$ 且满足 $\\|w\\|_{1} \\leq S_{\\max}$ 的形式，并确定向量 $a$。\n-   **任务2**：推导并求解 Karush–Kuhn–Tucker (KKT) 条件，以找到用 $a$ 和 $S_{\\max}$ 表示的最优解 $w^{\\star}$。\n-   **任务3**：对于特定实例 $a = \\begin{pmatrix} \\tfrac{9}{10} \\\\ -\\tfrac{2}{5} \\\\ \\tfrac{1}{5} \\end{pmatrix}$ 和 $S_{\\max} = 1$，计算精确最优解 $w^{\\star}$。\n-   **任务4**：从稀疏性和收缩方面解释 $w^\\star$ 的结构。\n-   **最终答案格式**：最终答案必须是精确最优解 $w^{\\star}$，表示为单个行向量。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在数字通信、信号处理和凸优化领域具有科学依据。FFE模型是发送端均衡的标准表示。均方误差代价函数是最小二乘估计的基础。$\\ell_1$范数约束是稀疏性诱导约束的一种公认的凸松弛方法，并且在限制电流模式逻辑(CML)发送器中并联驱动支路的总驱动强度方面具有实际意义。该数学公式被称为到$\\ell_1$球上的投影，是一个具有唯一解的良定凸优化问题。语言精确客观。所有必要的数据和条件，特别是$X$的标准正交性，都已提供。问题是自洽且完整的。\n\n### 步骤3：结论和行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n首先，我们重构代价函数 $J(w)$。\n代价函数给定为 $J(w) = \\tfrac{1}{2}\\|X w - d\\|_{2}^{2}$。我们可以展开欧几里得范数的平方：\n$$\nJ(w) = \\frac{1}{2} (Xw - d)^{\\top}(Xw - d) = \\frac{1}{2} (w^{\\top}X^{\\top} - d^{\\top})(Xw - d)\n$$\n$$\nJ(w) = \\frac{1}{2} (w^{\\top}X^{\\top}Xw - w^{\\top}X^{\\top}d - d^{\\top}Xw + d^{\\top}d)\n$$\n利用给定的$X$的列是标准正交的性质，$X^{\\top}X = I_3$，其中$I_3$是$3 \\times 3$的单位矩阵。\n$$\nJ(w) = \\frac{1}{2} (w^{\\top}I_3w - w^{\\top}(X^{\\top}d) - (X^{\\top}d)^{\\top}w + d^{\\top}d)\n$$\n我们定义向量 $a \\in \\mathbb{R}^3$ 为 $a = X^{\\top}d$。$w^{\\top}(X^{\\top}d)$ 是一个标量，等于其转置 $(X^{\\top}d)^{\\top}w$。因此，表达式变为：\n$$\nJ(w) = \\frac{1}{2} (w^{\\top}w - 2w^{\\top}a + d^{\\top}d)\n$$\n我们希望关于 $w$ 最小化这个函数。$\\frac{1}{2}d^{\\top}d$ 是一个关于 $w$ 的常数，不影响最小化器的位置。因此，最小化 $J(w)$ 等价于最小化 $\\tilde{J}(w) = \\frac{1}{2} (w^{\\top}w - 2w^{\\top}a)$。\n为了匹配目标形式 $\\frac{1}{2}\\|w-a\\|_2^2$，我们可以加上和减去常数项 $\\frac{1}{2}a^{\\top}a$：\n$$\n\\tilde{J}(w) = \\frac{1}{2} (w^{\\top}w - 2w^{\\top}a + a^{\\top}a - a^{\\top}a) = \\frac{1}{2} (w^{\\top}w - 2w^{\\top}a + a^{\\top}a) - \\frac{1}{2}a^{\\top}a = \\frac{1}{2}\\|w-a\\|_2^2 - \\frac{1}{2}\\|a\\|_2^2\n$$\n由于 $\\frac{1}{2}\\|a\\|_2^2$ 也是关于 $w$ 的常数，优化问题\n$$\n\\min_{w \\in \\mathbb{R}^{3}} \\ J(w) \\quad \\text{以满足} \\quad \\|w\\|_{1} \\leq S_{\\max}\n$$\n等价于\n$$\n\\min_{w \\in \\mathbb{R}^{3}} \\ \\tfrac{1}{2}\\|w - a\\|_{2}^{2} \\quad \\text{以满足} \\quad \\|w\\|_{1} \\leq S_{\\max}\n$$\n其中 $a = X^{\\top}d$。此问题是将点 $a$ 投影到半径为 $S_{\\max}$ 的 $\\ell_1$ 球上。\n\n接下来，我们推导这个凸优化问题的KKT条件。设目标函数为 $f(w) = \\frac{1}{2}\\|w-a\\|_2^2$，不等式约束为 $g(w) = \\|w\\|_1 - S_{\\max} \\leq 0$。拉格朗日函数为：\n$$\nL(w, \\mu) = f(w) + \\mu g(w) = \\frac{1}{2}\\sum_{i=1}^{3} (w_i - a_i)^2 + \\mu \\left( \\sum_{i=1}^{3} |w_i| - S_{\\max} \\right)\n$$\n其中 $\\mu \\ge 0$ 是拉格朗日乘子。最优解 $w^{\\star}$ 的KKT条件是：\n1.  **平稳性**：$0 \\in \\nabla_w L(w^{\\star}, \\mu^{\\star})$。由于 $\\|w\\|_1$ 在 $w_i=0$ 处不可微，我们使用次梯度。$\\|w\\|_1$ 的次微分是 $\\partial\\|w\\|_1$，其第 $i$ 个分量 $\\partial|w_i| = \\text{sgn}(w_i)$（如果 $w_i \\neq 0$）和 $[-1, 1]$（如果 $w_i=0$）。该条件变为：\n    $0 \\in \\nabla_w f(w^{\\star}) + \\mu^{\\star} \\partial\\|w^{\\star}\\|_1 \\implies 0 \\in (w^{\\star}-a) + \\mu^{\\star} \\partial\\|w^{\\star}\\|_1$。\n    分量形式为 $a_i - w_i^{\\star} \\in \\mu^{\\star} \\partial|w_i^{\\star}|$。\n2.  **原始可行性**：$\\|w^{\\star}\\|_1 - S_{\\max} \\leq 0$。\n3.  **对偶可行性**：$\\mu^{\\star} \\geq 0$。\n4.  **互补松弛性**：$\\mu^{\\star} (\\|w^{\\star}\\|_1 - S_{\\max}) = 0$。\n\n从平稳性条件，我们分析每个分量 $w_i^{\\star}$：\n-   如果 $w_i^{\\star}  0$，则 $\\partial|w_i^{\\star}| = \\{1\\}$，所以 $a_i - w_i^{\\star} = \\mu^{\\star} \\implies w_i^{\\star} = a_i - \\mu^{\\star}$。为保持一致性，$w_i^{\\star}0$ 要求 $a_i  \\mu^{\\star}$。\n-   如果 $w_i^{\\star}  0$，则 $\\partial|w_i^{\\star}| = \\{-1\\}$，所以 $a_i - w_i^{\\star} = -\\mu^{\\star} \\implies w_i^{\\star} = a_i + \\mu^{\\star}$。为保持一致性，$w_i^{\\star}0$ 要求 $a_i  -\\mu^{\\star}$。\n-   如果 $w_i^{\\star} = 0$，则 $\\partial|w_i^{\\star}| = [-1, 1]$，所以 $a_i \\in [-\\mu^{\\star}, \\mu^{\\star}] \\iff |a_i| \\leq \\mu^{\\star}$。\n\n这三种情况可以由软阈值算子 $S_{\\mu^{\\star}}(a_i)$ 总结：\n$$\nw_i^\\star = \\text{sgn}(a_i) \\max(0, |a_i| - \\mu^{\\star})\n$$\n现在我们确定 $\\mu^{\\star}$。\n情况1：无约束解 $w=a$ 是可行的。这发生在 $\\|a\\|_1 \\leq S_{\\max}$ 的情况下。此时，我们可以选择 $\\mu^{\\star}=0$。那么 $w_i^{\\star} = \\text{sgn}(a_i) \\max(0, |a_i|) = a_i$。所以 $w^{\\star}=a$。所有KKT条件都满足。\n情况2：无约束解是不可行的，即 $\\|a\\|_1  S_{\\max}$。约束必须是激活的，所以 $\\|w^{\\star}\\|_1 = S_{\\max}$。根据互补松弛性，这意味着 $\\mu^{\\star}  0$。我们必须找到满足此条件的 $\\mu^{\\star}$ 值：\n$$\n\\sum_{i=1}^{3} |w_i^{\\star}| = \\sum_{i=1}^{3} \\max(0, |a_i| - \\mu^{\\star}) = S_{\\max}\n$$\n必须对这个方程求解唯一的 $\\mu^{\\star}  0$。\n\n现在我们求解特定实例：\n$$\na = \\begin{pmatrix} \\tfrac{9}{10} \\\\ -\\tfrac{2}{5} \\\\ \\tfrac{1}{5} \\end{pmatrix}, \\qquad S_{\\max} = 1\n$$\n首先，计算 $\\|a\\|_1$：\n$$\n\\|a\\|_1 = \\left|\\frac{9}{10}\\right| + \\left|-\\frac{2}{5}\\right| + \\left|\\frac{1}{5}\\right| = \\frac{9}{10} + \\frac{2}{5} + \\frac{1}{5} = \\frac{9}{10} + \\frac{4}{10} + \\frac{2}{10} = \\frac{15}{10} = \\frac{3}{2}\n$$\n由于 $\\|a\\|_1 = 1.5  S_{\\max} = 1$，我们处于情况2。约束是激活的，我们必须找到 $\\mu^{\\star}  0$。$a$ 的各分量的绝对值为 $|a_1|=\\frac{9}{10}$， $|a_2|=\\frac{4}{10}$， $|a_3|=\\frac{2}{10}$。\n$\\mu^\\star$ 的方程是：\n$$\n\\max\\left(0, \\frac{9}{10} - \\mu^{\\star}\\right) + \\max\\left(0, \\frac{4}{10} - \\mu^{\\star}\\right) + \\max\\left(0, \\frac{2}{10} - \\mu^{\\star}\\right) = 1\n$$\n左边的函数是关于 $\\mu^{\\star}$ 的连续单调递减函数。我们来寻找 $\\mu^\\star$。假设 $\\mu^\\star$ 小于所有 $|a_i|$，具体来说 $\\mu^\\star \\le \\min(|a_i|) = \\frac{2}{10}$。在这种情况下，$\\max$ 的所有参数都为正：\n$$\n\\left(\\frac{9}{10} - \\mu^{\\star}\\right) + \\left(\\frac{4}{10} - \\mu^{\\star}\\right) + \\left(\\frac{2}{10} - \\mu^{\\star}\\right) = 1\n$$\n$$\n\\left(\\frac{9}{10} + \\frac{4}{10} + \\frac{2}{10}\\right) - 3\\mu^{\\star} = 1\n$$\n$$\n\\frac{15}{10} - 3\\mu^{\\star} = 1 \\implies \\frac{3}{2} - 1 = 3\\mu^{\\star} \\implies \\frac{1}{2} = 3\\mu^{\\star} \\implies \\mu^{\\star} = \\frac{1}{6}\n$$\n我们检查我们的假设：$\\mu^{\\star} \\leq \\frac{2}{10}$ 是否成立？\n$\\mu^{\\star} = \\frac{1}{6}$ 且 $\\frac{2}{10} = \\frac{1}{5}$。因为 $\\frac{1}{6}  \\frac{1}{5}$，所以我们的假设是正确的。因此，$\\mu^{\\star}=\\frac{1}{6}$。\n\n现在我们计算最优解 $w^{\\star}$ 的分量：\n$$\nw_1^{\\star} = \\text{sgn}\\left(\\frac{9}{10}\\right) \\max\\left(0, \\left|\\frac{9}{10}\\right| - \\frac{1}{6}\\right) = 1 \\cdot \\left(\\frac{9}{10} - \\frac{1}{6}\\right) = \\frac{27-5}{30} = \\frac{22}{30} = \\frac{11}{15}\n$$\n$$\nw_2^{\\star} = \\text{sgn}\\left(-\\frac{2}{5}\\right) \\max\\left(0, \\left|-\\frac{2}{5}\\right| - \\frac{1}{6}\\right) = -1 \\cdot \\left(\\frac{2}{5} - \\frac{1}{6}\\right) = -\\left(\\frac{12-5}{30}\\right) = -\\frac{7}{30}\n$$\n$$\nw_3^{\\star} = \\text{sgn}\\left(\\frac{1}{5}\\right) \\max\\left(0, \\left|\\frac{1}{5}\\right| - \\frac{1}{6}\\right) = 1 \\cdot \\left(\\frac{1}{5} - \\frac{1}{6}\\right) = \\frac{6-5}{30} = \\frac{1}{30}\n$$\n因此，精确最优解是 $w^{\\star} = \\begin{pmatrix} 11/15 \\\\ -7/30 \\\\ 1/30 \\end{pmatrix}$。作为检验，$\\|w^{\\star}\\|_1 = \\frac{11}{15} + \\frac{7}{30} + \\frac{1}{30} = \\frac{22}{30} + \\frac{7}{30} + \\frac{1}{30} = \\frac{30}{30} = 1$，等于 $S_{\\max}$。\n\n最后，进行解释。操作 $w^\\star = S_{\\mu^\\star}(a)$ 执行了两个$\\ell_1$约束优化的关键功能。\n1.  **收缩**：对于任何绝对值大于阈值 $\\mu^\\star$ 的分量 $a_i$，其对应的最优权重 $w_i^\\star$ 的绝对值会减少一个固定的量 $\\mu^\\star$。也就是说， $|w_i^\\star| = |a_i|-\\mu^\\star$。在我们的例子中，$a$ 的所有分量的绝对值都大于 $\\mu^\\star = 1/6$，所以 $w^\\star$ 的所有分量都是其在 $a$ 中对应分量的收缩版本。\n2.  **稀疏性**：对于任何绝对值小于或等于阈值 $\\mu^\\star$ 的分量 $a_i$，其对应的最优权重 $w_i^\\star$ 被精确地设置为零。这促进了稀疏解（有许多零项的解）。在这个具体的数值案例中，没有分量被设置为零。但是，如果 $S_{\\max}$ 更小，$\\mu^\\star$ 将会更大，可能会将分量 $w_3^\\star$（对应于最小的 $|a_i|$）设置为零。这个特性在FFE设计中非常有价值，因为它可以通过消除贡献可忽略的抽头来简化硬件实现。\n因此，$w^\\star$ 的结构是无约束最优解 $a$ 的一个收缩且可能稀疏的版本，其收缩和稀疏的程度由摆幅约束 $S_{\\max}$ 的严格程度控制。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{11}{15}  -\\frac{7}{30}  \\frac{1}{30}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}