{
    "hands_on_practices": [
        {
            "introduction": "在高速链路中，发送端前馈均衡器（FFE）的抽象系数具有直接的物理意义。本练习旨在连接“预加重”（即增强信号跳变）的直观概念与形式化的两抽头FFE模型。通过本练习，你将学习如何计算所需的预加重比率以对抗特定的信道损耗，同时满足现实世界中的约束，如发送器电压摆幅限制，从而将理论与实际设计场景联系起来。",
            "id": "4306657",
            "problem": "一个高速串行发射器采用一个两阶前馈均衡器 (FFE) 来预加重跳变并减轻信道损耗。发射的符号序列是二进制不归零码，由速率为 $R$ 的离散时间序列 $s[n] \\in \\{+1,-1\\}$ 表示。FFE 的输出被建模为线性时不变叠加：\n$$x[n] = a\\,s[n] + b\\,s[n-1],$$\n其中 $a$ 和 $b$ 是实数抽头系数。发射器实现预加重，使得在孤立跳变 $0 \\rightarrow 1$（或 $-1 \\rightarrow +1$）期间，第一个单位间隔内的电压等于 $V_{\\text{high}}$，而在一段连续相同比特期间的电压等于 $V_{\\text{low}}$。将预加重比定义为 $P = V_{\\text{high}}/V_{\\text{low}}$。\n\n信道是线性时不变的，其频率响应为 $H(f)$。假设 $|H(0)|$ 已归一化为1，并将在奈奎斯特频率 $R/2$ 处的信道衰减定义为 $A = |H(R/2)|$，其中 $0  A  1$。接收器在每个单位间隔的中心进行采样，没有额外的均衡，且噪声可忽略不计。发射器输出的最大幅度受限于 $|x[n]| \\leq V_{\\text{max}}$（对所有 $n$）。\n\n从线性系统原理（叠加、卷积和离散时间傅里叶变换）出发，并使用关于最坏情况码型（连续码型和交替码型）的物理上合理的假设，推导出选择 $P$ 所需的关系式，以使低频和奈奎斯特频率的组合幅度在接收器采样时刻相等。然后，施加发射器摆幅限制和以下眼图指标：在接收器采样时刻所需的最小眼高为 $E_{\\min} = 0.30$，单位为 $\\text{V}$。摆幅限制为 $V_{\\text{max}} = 0.60$，单位为 $\\text{V}$，信道衰减为 $A = 0.35$（无量纲）。\n\n计算所需的预加重比 $P$（一个无量纲数），使其在摆幅限制下满足最小眼高要求。如果该指标可以实现，则提供 $P$。否则，使用在摆幅限制下能最大化眼高的 $P$ 值。将 $P$ 的最终数值答案四舍五入到四位有效数字，并将其表示为无量纲量。",
            "solution": "该问题要求计算一个两阶发射前馈均衡器 (FFE) 的预加重比 $P$，该均衡器旨在使低频和奈奎斯特频率处的信道响应相等，同时满足对发射器输出摆幅和接收器眼高的约束。\n\n首先，我们将 FFE 抽头系数 $a$、$b$ 与预加重比 $P$ 之间的关系形式化。FFE 的输出由离散时间卷积给出：\n$$x[n] = a\\,s[n] + b\\,s[n-1]$$\n其中 $s[n] \\in \\{+1,-1\\}$ 是输入符号序列。\n\n连续码型电压 $V_{\\text{low}}$ 对应于一串相同的比特，例如 $s[n] = s[n-1] = +1$。输出电压为：\n$$x[n] = a(+1) + b(+1) = a+b$$\n因此，我们认定 $V_{\\text{low}} = a+b$。为了使预加重相对于连续比特降低信号电平，我们预期 $a$ 是主抽头，而 $b$ 的符号相反，且 $|a| > |b|$。我们假设 $a > 0$ 且 $b  0$，这使得 $a+b > 0$。\n\n高频或跳变电压 $V_{\\text{high}}$ 对应于一个跳变，例如 $s[n-1] = -1$ 和 $s[n] = +1$。在新比特的第一个单位间隔内的输出电压为：\n$$x[n] = a(+1) + b(-1) = a-b$$\n因此，我们认定 $V_{\\text{high}} = a-b$。在 $a>0$ 和 $b0$ 的情况下，$V_{\\text{high}}$ 是可能的最大输出幅度。\n\n预加重比 $P$ 定义为：\n$$P = \\frac{V_{\\text{high}}}{V_{\\text{low}}} = \\frac{a-b}{a+b}$$\n这个方程将描述性参数 $P$ 与滤波器系数 $a$ 和 $b$ 联系起来。\n\n接下来，我们在频域中分析该系统。FFE 是一个线性时不变 (LTI) 滤波器，其脉冲响应为 $h_{\\text{FFE}}[n] = a\\,\\delta[n] + b\\,\\delta[n-1]$。其离散时间傅里叶变换 (DTFT) 或频率响应，定义在频率范围 $-R/2 \\le f \\le R/2$ 内，是：\n$$H_{\\text{FFE}}(f) = a + b\\,\\exp\\left(-j2\\pi f \\frac{1}{R}\\right)$$\n从输入符号 $s[n]$ 到接收器输入的整体系统频率响应是 FFE 响应和信道响应 $H(f)$ 的乘积：\n$$G(f) = H_{\\text{FFE}}(f) H(f) = \\left(a + b\\,\\exp\\left(-j2\\pi f/R\\right)\\right) H(f)$$\n\n问题要求选择 $P$ 来使接收器处的组合低频和奈奎斯特频率幅度相等。这是一种针对奈奎斯特频率的零强迫均衡形式。\n\n在低频 ($f \\rightarrow 0$) 时，系统响应的幅度为：\n$$|G(0)| = \\left|a + b\\,\\exp(0)\\right| |H(0)| = |a+b| \\cdot 1 = a+b$$\n我们使用了给定的归一化条件 $|H(0)|=1$ 以及我们的假设 $a+b > 0$。这对应于直流或稳态信号的接收幅度。\n\n在奈奎斯特频率 $f_{\\text{Nyq}} = R/2$ 时，系统响应的幅度为：\n$$|G(R/2)| = \\left|a + b\\,\\exp\\left(-j2\\pi (R/2)/R\\right)\\right| |H(R/2)| = |a + b\\,\\exp(-j\\pi)| |H(R/2)|$$\n由于 $\\exp(-j\\pi) = -1$ 且给定 $|H(R/2)| = A$，这变为：\n$$|G(R/2)| = |a-b| A$$\n根据我们的假设 $a-b > 0$，这便是 $|G(R/2)| = (a-b)A$。这对应于最坏情况交替码型 ($+1, -1, +1, -1, \\ldots$) 的接收幅度。\n\n均衡条件是 $|G(0)| = |G(R/2)|$：\n$$a+b = (a-b)A$$\n为了找到所需的预加重比 $P$，我们可以重新整理这个方程。将两边同时除以 $a+b$（对于非零信号，该值非零）得到：\n$$1 = \\frac{a-b}{a+b} A$$\n代入 $P = (a-b)/(a+b)$ 的定义，我们得到：\n$$1 = P \\cdot A \\implies P = \\frac{1}{A}$$\n这是实现均衡所需的预加重比。\n\n现在，我们必须验证 $P$ 的这个选择是否与发射器摆幅和接收器眼高约束兼容。\n给定的数值是：\n奈奎斯特频率处的信道衰减：$A = 0.35$\n发射器摆幅限制：$V_{\\text{max}} = 0.60 \\, \\text{V}$\n最小所需眼高：$E_{\\min} = 0.30 \\, \\text{V}$\n\n首先，我们计算所需的 $P$：\n$$P = \\frac{1}{A} = \\frac{1}{0.35}$$\n\n接下来，我们检查约束条件。瞬时发射器输出为 $x[n] = a\\,s[n] + b\\,s[n-1]$。可能的输出幅度为 $|a+b|$ 和 $|a-b|$。由于 $P > 1$，我们有 $|a-b| > |a+b|$。因此，最大发射器摆幅为 $|a-b|$。摆幅限制约束为：\n$$|a-b| \\leq V_{\\text{max}}$$\n接收器处的眼高 $E_H$ 是眼图在采样时刻的垂直张开度。经过均衡后，连续“1”码型和交替码型的“高”电平是相同的，等于 $Y_{\\text{level}} = a+b = (a-b)A$。根据对称性，“低”电平为 $-Y_{\\text{level}}$。眼高是这两个电平之差：\n$$E_H = Y_{\\text{level}} - (-Y_{\\text{level}}) = 2Y_{\\text{level}} = 2(a+b)$$\n眼高指标为 $E_H \\geq E_{\\min}$，这意味着：\n$$2(a+b) \\geq E_{\\min}$$\n为了实现尽可能大的眼高，我们应该将发射器驱动到其最大可能摆幅，因此我们设定 $|a-b| = V_{\\text{max}}$（或某个接近它的值）。如果我们设定 $|a-b|=V_{\\text{max}}$，对应的眼高是：\n$$E_H = 2(a+b) = 2((a-b)A) = 2\\,V_{\\text{max}}\\,A$$\n这是在均衡条件和摆幅限制下可实现的最大眼高 $E_{H, \\text{max}}$。我们必须检查这个最大可能眼高是否满足指标：\n$$E_{H, \\text{max}} \\geq E_{\\min}$$\n$$2\\,V_{\\text{max}}\\,A \\geq E_{\\min}$$\n代入给定的数值：\n$$2 \\cdot (0.60) \\cdot (0.35) \\geq 0.30$$\n$$1.20 \\cdot 0.35 \\geq 0.30$$\n$$0.42 \\geq 0.30$$\n该不等式成立，意味着指标是可以实现的。所需的预加重比确实是 $P=1/A$，这是由均衡目标决定的。题目说明，如果指标无法实现，我们应该使用能够最大化眼高的 $P$ 值。如前所示，最大化眼高需要使用最大摆幅，但关联低频和高频增益的比率 $P$ 已由均衡目标固定为 $1/A$。因此，在这种情况下 $P$ 的值将是相同的。\n\n由于指标可以实现，我们计算 $P$ 的值。\n$$P = \\frac{1}{0.35} = \\frac{1}{35/100} = \\frac{100}{35} = \\frac{20}{7}$$\n$$P \\approx 2.8571428...$$\n四舍五入到四位有效数字，我们得到 $P = 2.857$。",
            "answer": "$$\\boxed{2.857}$$"
        },
        {
            "introduction": "设计好FFE后，关键的下一步是评估其性能。本练习将聚焦于FFE重塑信道响应的基本机制。通过执行离散时间卷积，你将计算出经过均衡的组合脉冲响应，并量化被称为残余码间干扰（ISI）的剩余失真。这个练习为评估均衡器的有效性提供了一个具体的量化指标。",
            "id": "4306663",
            "problem": "在集成电路和电子设计自动化 (EDA) 流程中实现的高速串行链路中，使用带有前馈均衡器 (FFE) 的发送端均衡来减轻信道引起的码间干扰 (ISI)。考虑一个离散时间符号间隔模型，其中符号在整数时间索引处发送，接收端在这些时刻同步采样。发送端 FFE 具有三个符号间隔的抽头，其系数为 $\\{w_{-1}, w_{0}, w_{+1}\\} = \\{0.2, 1.0, -0.2\\}$，它驱动一个线性时不变 (LTI) 信道，该信道的符号间隔脉冲响应由 $h[0] = 1$，$h[1] = 0.3$，$h[2] = 0.1$ 给出，对于所有其他 $n$，有 $h[n] = 0$。均衡器抽头索引 $k$ 表示对在时间索引 $n-k$ 处发送的符号的加权。\n\n从 LTI 系统的离散时间卷积定义以及 FFE 作为发送端的线性时不变预滤波器的定义出发，推导在接收端采样时刻所看到的总有效脉冲响应 $g[n]$。假设判决时刻与索引 $n=0$ 处的主光标对齐。将残余码间干扰功率定义为所有非主光标采样点的平方幅值之和，即\n$$\nP_{\\mathrm{ISI}} \\triangleq \\sum_{n \\neq 0} g[n]^{2}.\n$$\n用主光标功率 $g[0]^{2}$ 对此残余 ISI 功率进行归一化，以获得无量纲比率\n$$\nR \\triangleq \\frac{P_{\\mathrm{ISI}}}{g[0]^{2}}.\n$$\n以小数形式计算 $R$。将最终数值答案四舍五入到四位有效数字。将最终结果表示为无单位的纯数。",
            "solution": "问题要求计算一个离散时间通信系统的归一化残余码间干扰 (ISI) 功率。该系统由一个发送端前馈均衡器 (FFE) 和一个线性时不变 (LTI) 信道级联组成。\n\n首先，我们建立系统的数学模型。FFE 和信道都是 LTI 系统。当两个 LTI 系统级联时，整个系统也是 LTI 系统，其脉冲响应是各个脉冲响应的卷积。设 FFE 的脉冲响应为 $w[n]$，信道的脉冲响应为 $h[n]$。在接收端采样时刻的总有效脉冲响应（记为 $g[n]$）由以下卷积给出：\n$$\ng[n] = (w * h)[n] = \\sum_{k=-\\infty}^{\\infty} w[k] h[n-k]\n$$\n\n根据问题描述，FFE 具有三个抽头，系数为 $\\{w_{-1}, w_{0}, w_{+1}\\} = \\{0.2, 1.0, -0.2\\}$。抽头索引 $k$ 对应于滤波器脉冲响应的时间索引。因此，FFE 的脉冲响应为：\n$w[-1] = 0.2$\n$w[0] = 1.0$\n$w[1] = -0.2$\n对于所有其他整数 $n$ 值，$w[n] = 0$。\n\n信道的符号间隔脉冲响应由下式给出：\n$h[0] = 1$\n$h[1] = 0.3$\n$h[2] = 0.1$\n对于所有其他整数 $n$ 值，$h[n] = 0$。\n\n由于 FFE 脉冲响应 $w[n]$ 仅在 $n \\in \\{-1, 0, 1\\}$ 时非零，卷积和简化为：\n$$\ng[n] = w[-1]h[n-(-1)] + w[0]h[n-0] + w[1]h[n-1]\n$$\n代入给定的 FFE 抽头系数值：\n$$\ng[n] = 0.2 \\cdot h[n+1] + 1.0 \\cdot h[n] - 0.2 \\cdot h[n-1]\n$$\n\n现在，我们可以计算总脉冲响应 $g[n]$ 的值。$w[n]$ 的支撑集是 $[-1, 1]$，$h[n]$ 的支撑集是 $[0, 2]$。它们的卷积 $g[n]$ 的支撑集将从 $(-1)+0 = -1$ 到 $1+2 = 3$。我们计算 $g[n]$ 的非零采样点：\n\n对于 $n=-1$：\n$g[-1] = 0.2 \\cdot h[0] + 1.0 \\cdot h[-1] - 0.2 \\cdot h[-2] = 0.2 \\cdot 1 + 1.0 \\cdot 0 - 0.2 \\cdot 0 = 0.2$\n\n对于 $n=0$ (主光标)：\n$g[0] = 0.2 \\cdot h[1] + 1.0 \\cdot h[0] - 0.2 \\cdot h[-1] = 0.2 \\cdot 0.3 + 1.0 \\cdot 1 - 0.2 \\cdot 0 = 0.06 + 1 = 1.06$\n\n对于 $n=1$：\n$g[1] = 0.2 \\cdot h[2] + 1.0 \\cdot h[1] - 0.2 \\cdot h[0] = 0.2 \\cdot 0.1 + 1.0 \\cdot 0.3 - 0.2 \\cdot 1 = 0.02 + 0.3 - 0.2 = 0.12$\n\n对于 $n=2$：\n$g[2] = 0.2 \\cdot h[3] + 1.0 \\cdot h[2] - 0.2 \\cdot h[1] = 0.2 \\cdot 0 + 1.0 \\cdot 0.1 - 0.2 \\cdot 0.3 = 0.1 - 0.06 = 0.04$\n\n对于 $n=3$：\n$g[3] = 0.2 \\cdot h[4] + 1.0 \\cdot h[3] - 0.2 \\cdot h[2] = 0.2 \\cdot 0 + 1.0 \\cdot 0 - 0.2 \\cdot 0.1 = -0.02$\n\n对于所有其他的 $n$ 值，$g[n] = 0$。完整的总脉冲响应为 $g[n] = \\{ \\dots, 0, 0.2, 1.06, 0.12, 0.04, -0.02, 0, \\dots \\}$，其中索引 $n=0$ 处的采样点是 $1.06$。\n\n残余 ISI 功率 $P_{\\mathrm{ISI}}$ 是所有非主光标采样点的平方幅值之和。主光标在 $n=0$ 处。\n$$\nP_{\\mathrm{ISI}} = \\sum_{n \\neq 0} g[n]^{2} = g[-1]^2 + g[1]^2 + g[2]^2 + g[3]^2\n$$\n代入计算出的值：\n$$\nP_{\\mathrm{ISI}} = (0.2)^2 + (0.12)^2 + (0.04)^2 + (-0.02)^2\n$$\n$$\nP_{\\mathrm{ISI}} = 0.04 + 0.0144 + 0.0016 + 0.0004 = 0.0564\n$$\n\n主光标功率为 $g[0]^2$：\n$$\ng[0]^2 = (1.06)^2 = 1.1236\n$$\n\n归一化的残余 ISI 功率比 $R$ 定义为：\n$$\nR = \\frac{P_{\\mathrm{ISI}}}{g[0]^{2}}\n$$\n代入计算出的功率值：\n$$\nR = \\frac{0.0564}{1.1236} \\approx 0.050195799...\n$$\n\n题目要求答案四舍五入到四位有效数字。第一位有效数字是 $5$。第四位是 $9$。后一位数字是 $5$，所以我们将第四位有效数字向上进位。\n$$\nR \\approx 0.05020\n$$",
            "answer": "$$\\boxed{0.05020}$$"
        },
        {
            "introduction": "简单的FFE设计方法有时会导致抽头系数值过大，这会放大噪声且难以在硬件中实现。这个高级练习将介绍一种强大的优化技术——正则化最小二乘法，用以寻找最佳的FFE系数。该方法在最小化码间干扰和控制抽头幅度之间取得了平衡，从而实现了更稳健、更实用的均衡器设计，展示了如何使用数学框架来解决真实的工程权衡问题。",
            "id": "4306616",
            "problem": "考虑一个在电子设计自动化 (EDA) 中使用前馈均衡 (FFE) 的高速串行发送器，其对符号进行预加重，使得整体离散时间基带信道响应更接近一个抑制码间干扰的目标。设离散时间线性时不变 (LTI) 信道冲激响应为长度为$3$的序列 $h[0]=\\frac{1}{2}$，$h[1]=1$ 以及 $h[2]=\\frac{1}{2}$。FFE 是一个长度为$3$的离散时间有限冲激响应滤波器，其抽头向量为 $w=\\begin{pmatrix}w_{0}  w_{1}  w_{2}\\end{pmatrix}^{\\mathsf{T}}$，在符号速率下应用。\n\n根据标准离散时间卷积定义，等效信道冲激响应 $g[n]$ 等于卷积 $g[n]=\\sum_{k=0}^{2}w_{k}\\,h[n-k]$。为了在保留主瓣的同时抑制最近的前后沿干扰，设计目标是在最小二乘意义下，将三个采样点 $\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$ 拟合到期望向量 $d=\\begin{pmatrix}0  1  0\\end{pmatrix}^{\\mathsf{T}}$。为限制因抽头系数幅度过大而引起的发送端噪声放大，引入一个惩罚参数为 $\\lambda=0.1$ 的$\\ell_{2}$范数正则化项，并定义代价函数\n$$\nJ(w)=\\left\\|H\\,w-d\\right\\|_{2}^{2}+\\lambda\\left\\|w\\right\\|_{2}^{2},\n$$\n其中 $H$ 是由与 $h[n]$ 的离散时间卷积所隐含的、从 $w$ 到 $\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$ 的线性映射。\n\n从离散时间卷积和带$\\ell_{2}$正则化的最小二乘估计的基本定义出发，推导 $w$ 的最优性条件，并计算在给定的 $h[n]$ 和 $\\lambda=0.1$ 下，使 $J(w)$ 最小化的 FFE 抽头向量 $w$。请将抽头向量的最终答案表示为使用 $\\begin{pmatrix}\\cdot\\end{pmatrix}$ 符号的单个行向量，其中包含精确分数。无需四舍五入，且不涉及物理单位。",
            "solution": "问题要求解一个$3$抽头前馈均衡器 (FFE) 的最优抽头向量 $w = \\begin{pmatrix}w_{0}  w_{1}  w_{2}\\end{pmatrix}^{\\mathsf{T}}$，该向量使一个正则化的最小二乘代价函数最小化。目标是整形总信道响应以抑制码间干扰 (ISI)。\n\n首先，我们必须构建矩阵 $H$，它定义了从 FFE 抽头 $w$ 到均衡后信道响应的相关样本 $\\begin{pmatrix}g[1]  g[2]  g[3]\\end{pmatrix}^{\\mathsf{T}}$ 的线性变换。等效信道响应 $g[n]$ 由 FFE 抽头 $w[k]$ 和信道冲激响应 $h[n]$ 的离散时间卷积给出。我们已知 $w[k]$ 仅在 $k \\in \\{0, 1, 2\\}$ 时存在，在其他情况下为零；信道响应为 $h[0]=\\frac{1}{2}$，$h[1]=1$ 和 $h[2]=\\frac{1}{2}$，在其他索引处为零。\n\n卷积定义为 $g[n] = \\sum_{k=-\\infty}^{\\infty} w[k]h[n-k]$。由于 $w[k]$ 仅在 $k \\in \\{0, 1, 2\\}$ 时非零，该求和变为：\n$$g[n] = \\sum_{k=0}^{2} w_k h[n-k] = w_0 h[n] + w_1 h[n-1] + w_2 h[n-2]$$\n我们需要计算 $n=1, 2, 3$ 时此表达式的值：\n对于 $n=1$：\n$g[1] = w_0 h[1] + w_1 h[0] + w_2 h[-1] = w_0(1) + w_1(\\frac{1}{2}) + w_2(0) = w_0 + \\frac{1}{2}w_1$。\n对于 $n=2$：\n$g[2] = w_0 h[2] + w_1 h[1] + w_2 h[0] = w_0(\\frac{1}{2}) + w_1(1) + w_2(\\frac{1}{2}) = \\frac{1}{2}w_0 + w_1 + \\frac{1}{2}w_2$。\n对于 $n=3$：\n$g[3] = w_0 h[3] + w_1 h[2] + w_2 h[1] = w_0(0) + w_1(\\frac{1}{2}) + w_2(1) = \\frac{1}{2}w_1 + w_2$。\n\n该线性方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}g[1] \\\\ g[2] \\\\ g[3]\\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix}w_0 \\\\ w_1 \\\\ w_2\\end{pmatrix}\n$$\n因此，矩阵 $H$ 为：\n$$H = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix}$$\n期望响应向量为 $d = \\begin{pmatrix}0  1  0\\end{pmatrix}^{\\mathsf{T}}$。\n\n需要最小化的代价函数是 $J(w) = \\|Hw-d\\|_{2}^{2} + \\lambda\\|w\\|_{2}^{2}$，其中 $\\lambda=0.1$。\n我们可以使用向量转置来表示平方范数：\n$$J(w) = (Hw-d)^{\\mathsf{T}}(Hw-d) + \\lambda w^{\\mathsf{T}}w$$\n展开第一项得到：\n$$J(w) = (w^{\\mathsf{T}}H^{\\mathsf{T}} - d^{\\mathsf{T}})(Hw-d) + \\lambda w^{\\mathsf{T}}w = w^{\\mathsf{T}}H^{\\mathsf{T}}Hw - w^{\\mathsf{T}}H^{\\mathsf{T}}d - d^{\\mathsf{T}}Hw + d^{\\mathsf{T}}d + \\lambda w^{\\mathsf{T}}w$$\n由于 $d^{\\mathsf{T}}Hw$ 是一个标量，它等于其转置 $(d^{\\mathsf{T}}Hw)^{\\mathsf{T}} = w^{\\mathsf{T}}H^{\\mathsf{T}}d$。因此：\n$$J(w) = w^{\\mathsf{T}}H^{\\mathsf{T}}Hw - 2d^{\\mathsf{T}}Hw + d^{\\mathsf{T}}d + \\lambda w^{\\mathsf{T}}w$$\n为了求最小值，我们计算 $J(w)$ 关于 $w$ 的梯度并将其设为零。使用标准矩阵微积分的结果，$\\nabla_w(w^{\\mathsf{T}}Aw) = (A+A^{\\mathsf{T}})w$ 和 $\\nabla_w(b^{\\mathsf{T}}w) = b$：\n$$\\nabla_w J(w) = \\nabla_w (w^{\\mathsf{T}}(H^{\\mathsf{T}}H + \\lambda I)w - 2(H^{\\mathsf{T}}d)^{\\mathsf{T}}w + d^{\\mathsf{T}}d) = 0$$\n矩阵 $H^{\\mathsf{T}}H + \\lambda I$ 是对称的。因此，梯度为：\n$$\\nabla_w J(w) = 2(H^{\\mathsf{T}}H + \\lambda I)w - 2H^{\\mathsf{T}}d = 0$$\n这就得出了最优性条件，也称为 Tikhonov 正则化最小二乘法的正规方程：\n$$(H^{\\mathsf{T}}H + \\lambda I)w = H^{\\mathsf{T}}d$$\n最优向量 $w$ 是这个线性系统的解。\n\n现在我们代入给定的值。矩阵 $H$ 是对称的，所以 $H^{\\mathsf{T}}=H$。\n首先，计算 $H^{\\mathsf{T}}H = H^2$：\n$$H^2 = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4} \\\\ \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4}+1+\\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2} \\\\ \\frac{1}{4}  \\frac{1}{2}+\\frac{1}{2}  \\frac{1}{4}+1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4} \\end{pmatrix}$$\n接下来，我们构建矩阵 $A = H^{\\mathsf{T}}H + \\lambda I$，其中 $\\lambda = 0.1 = \\frac{1}{10}$：\n$$A = \\begin{pmatrix} \\frac{5}{4}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4} \\end{pmatrix} + \\frac{1}{10}\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}+\\frac{1}{10}  1  \\frac{1}{4} \\\\ 1  \\frac{3}{2}+\\frac{1}{10}  1 \\\\ \\frac{1}{4}  1  \\frac{5}{4}+\\frac{1}{10} \\end{pmatrix}$$\n$$A = \\begin{pmatrix} \\frac{25+2}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{15+1}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{25+2}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{27}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{16}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{27}{20} \\end{pmatrix}$$\n最优性条件的右侧是 $H^{\\mathsf{T}}d$：\n$$H^{\\mathsf{T}}d = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  \\frac{1}{2} \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}$$\n我们必须求解方程组 $Aw = H^{\\mathsf{T}}d$：\n$$\n\\begin{pmatrix} \\frac{27}{20}  1  \\frac{5}{20} \\\\ 1  \\frac{16}{10}  1 \\\\ \\frac{5}{20}  1  \\frac{27}{20} \\end{pmatrix} \\begin{pmatrix}w_0 \\\\ w_1 \\\\ w_2\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\n该方程组表现出对称性。矩阵的第一行和第三行相互反映，右侧向量的第一和第三个分量相同。这意味着 $w_0 = w_2$。\n利用这种对称性，我们可以简化该系统。第一个方程变为：\n$\\frac{27}{20}w_0 + w_1 + \\frac{5}{20}w_2 = \\frac{1}{2} \\implies \\frac{27}{20}w_0 + w_1 + \\frac{5}{20}w_0 = \\frac{1}{2} \\implies \\frac{32}{20}w_0 + w_1 = \\frac{1}{2} \\implies \\frac{8}{5}w_0 + w_1 = \\frac{1}{2}$\n第二个方程变为：\n$w_0 + \\frac{16}{10}w_1 + w_2 = 1 \\implies w_0 + \\frac{8}{5}w_1 + w_0 = 1 \\implies 2w_0 + \\frac{8}{5}w_1 = 1$\n现在我们得到了一个关于 $w_0$ 和 $w_1$ 的 $2 \\times 2$ 方程组：\n1) $\\frac{8}{5}w_0 + w_1 = \\frac{1}{2}$\n2) $2w_0 + \\frac{8}{5}w_1 = 1$\n从方程(1)中，我们将 $w_1$ 表示为 $w_0$ 的函数：$w_1 = \\frac{1}{2} - \\frac{8}{5}w_0$。\n将此代入方程(2)：\n$2w_0 + \\frac{8}{5}\\left(\\frac{1}{2} - \\frac{8}{5}w_0\\right) = 1$\n$2w_0 + \\frac{4}{5} - \\frac{64}{25}w_0 = 1$\n$w_0\\left(2 - \\frac{64}{25}\\right) = 1 - \\frac{4}{5}$\n$w_0\\left(\\frac{50 - 64}{25}\\right) = \\frac{1}{5}$\n$w_0\\left(-\\frac{14}{25}\\right) = \\frac{1}{5}$\n$w_0 = \\frac{1}{5} \\left(-\\frac{25}{14}\\right) = -\\frac{5}{14}$\n现在我们求解 $w_1$：\n$w_1 = \\frac{1}{2} - \\frac{8}{5}w_0 = \\frac{1}{2} - \\frac{8}{5}\\left(-\\frac{5}{14}\\right) = \\frac{1}{2} + \\frac{8}{14} = \\frac{1}{2} + \\frac{4}{7} = \\frac{7+8}{14} = \\frac{15}{14}$\n并且 $w_2 = w_0$，所以 $w_2 = -\\frac{5}{14}$。\n使代价函数最小化的 FFE 抽头向量是 $w = \\begin{pmatrix} -\\frac{5}{14}  \\frac{15}{14}  -\\frac{5}{14} \\end{pmatrix}^{\\mathsf{T}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{14}  \\frac{15}{14}  -\\frac{5}{14} \\end{pmatrix}}\n$$"
        }
    ]
}