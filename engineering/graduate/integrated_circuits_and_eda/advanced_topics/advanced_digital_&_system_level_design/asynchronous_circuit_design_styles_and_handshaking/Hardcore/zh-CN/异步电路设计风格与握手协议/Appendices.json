{
    "hands_on_practices": [
        {
            "introduction": "选择握手协议是异步设计中的一个基本决策，它会带来真实的物理影响。本练习提供了一种基于第一性原理的方法，来量化其中一个最关键的权衡因素：能耗。通过计算两相（NRZ）和四相（RTZ）协议下每次数据传输的能耗 ，我们将能直观地理解为何在功耗敏感的应用中，一种协议可能优于另一种。",
            "id": "4256339",
            "problem": "一个异步流水线级通过发送方和接收方之间的双线控制握手进行通信：一根请求线和一根应答线。通常使用两种典型的设计风格：非归零 (NRZ) 两相握手和归零 (RTZ) 四相握手。在互补金属氧化物半导体 (CMOS) 逻辑中，每次控制节点因其有效电容的充电或放电而发生状态转换时，都会消耗动态能量。在集成电路和电子设计自动化 (EDA) 中，假设对于所考虑的控制路径，每次控制转换所耗散的动态能量是一个已知常数 $E_t$。忽略数据路径能量和泄漏；仅考虑控制路径的动态能量。\n\n从 CMOS 动态开关的第一性原理出发，仅使用每个有效负载令牌的控制转换次数，推导每种设计风格下，每次有效负载传输的能量（用 $E_t$ 和每种协议下每个令牌的控制转换次数表示）。然后，在以下科学上现实的假设下，对能量进行数值评估：\n- 对于两相非归零 (NRZ) 握手，每个有效负载令牌在请求线上有一次转换，在应答线上有一次转换，因此 $n_{\\mathrm{NRZ}} = 2$。\n- 对于四相归零 (RTZ) 握手，每个有效负载令牌在请求线上有两次转换（上升和下降），在应答线上有两次转换（上升和下降），因此 $n_{\\mathrm{RTZ}} = 4$。\n- 每次控制转换的动态能量为 $E_t = 3.6$ 飞焦耳。\n\n计算 NRZ 和 RTZ 每次有效负载传输的能量，以飞焦耳为单位。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题经证实具有科学依据、问题明确、客观且完整。它提出了一个基于数字电路设计既定原则的标准工程分析问题。所有必要的数据和定义都已提供，没有矛盾或含糊之处。\n\n计算互补金属氧化物半导体 (CMOS) 逻辑中动态能耗的基本原理是，能量主要在节点电容的充电和放电过程中耗散。问题指出，单个控制节点每次转换（$0 \\rightarrow 1$ 或 $1 \\rightarrow 0$）所耗散的动态能量是一个常数，记为 $E_t$。\n\n设 $E$ 表示控制逻辑传输一个有效负载令牌所消耗的总动态能量。设 $n$ 为传输该单个令牌所需的所有控制线上信号转换的总次数。根据线性叠加原理，总能量是转换次数与每次转换能量的乘积。这给出了第一性原理关系式：\n$$E = n \\cdot E_t$$\n\n问题要求我们将此模型应用于两种特定的异步握手协议：非归零 (NRZ) 两相和归零 (RTZ) 四相。\n\n首先，我们分析非归零 (NRZ) 两相握手。问题提供信息，对于每次有效负载令牌传输，控制线（请求和应答）上总共有 $n_{\\mathrm{NRZ}}$ 次转换。给定值为：\n$$n_{\\mathrm{NRZ}} = 2$$\n这对应于请求线上的一次转换和应答线上的一次转换。因此，NRZ 风格下每次有效负载传输的能量，记为 $E_{\\mathrm{NRZ}}$，为：\n$$E_{\\mathrm{NRZ}} = n_{\\mathrm{NRZ}} \\cdot E_t = 2 E_t$$\n\n接下来，我们分析归零 (RTZ) 四相握手。问题提供信息，对于每次有效负载令牌传输，总共有 $n_{\\mathrm{RTZ}}$ 次转换。给定值为：\n$$n_{\\mathrm{RTZ}} = 4$$\n这对应于请求线上的一次上升转换和一次下降转换，以及应答线上的一次上升转换和一次下降转换。因此，RTZ 风格下每次有效负载传输的能量，记为 $E_{\\mathrm{RTZ}}$，为：\n$$E_{\\mathrm{RTZ}} = n_{\\mathrm{RTZ}} \\cdot E_t = 4 E_t$$\n\n符号推导完成后，我们现在进行数值评估。问题提供了每次转换的能量常数：\n$$E_t = 3.6 \\text{ femtojoules (fJ)}$$\n\n将此值代入我们推导出的表达式中：\n\n对于 NRZ 两相握手：\n$$E_{\\mathrm{NRZ}} = 2 \\cdot (3.6 \\text{ fJ}) = 7.2 \\text{ fJ}$$\n\n对于 RTZ 四相握手：\n$$E_{\\mathrm{RTZ}} = 4 \\cdot (3.6 \\text{ fJ}) = 14.4 \\text{ fJ}$$\n\n问题要求最终答案四舍五入到四位有效数字。\n$E_{\\mathrm{NRZ}}$ 的计算值为 $7.2$。要用四位有效数字表示，我们写作 $7.200$。\n$E_{\\mathrm{RTZ}}$ 的计算值为 $14.4$。要用四位有效数字表示，我们写作 $14.40$。\n\n最终的数值答案是 $E_{\\mathrm{NRZ}} = 7.200$ fJ 和 $E_{\\mathrm{RTZ}} = 14.40$ fJ。",
            "answer": "$$\\boxed{\\begin{pmatrix} 7.200  14.40 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了协议机制的基础上，本练习将重点从能耗转向性能。我们将分析一个标准的四相握手协议的时序，以推导出最大吞吐量和端到端延迟的表达式 。这项练习对于培养性能建模的技能至关重要，它使设计者能够预测和优化其异步系统可以运行的速度。",
            "id": "4256359",
            "problem": "考虑在两个模块之间的一个点对点捆绑数据异步链接，该链接实现为单个缓冲级，并使用标准的四相归零请求-应答协议。在此协议中，一次完整的事务包含以下因果有序的控制转换：发送方将 $request$ 置为高电平，接收方将 $acknowledge$ 置为高电平，发送方将 $request$ 撤销为低电平，接收方将 $acknowledge$ 撤销为低电平。假设采用以下物理上现实的时序模型：\n- 每次沿任一方向跨互连线的传播都会产生最坏情况下的导线延迟 $t_{w}$。\n- 本地握手控制（在任一端）对输入转换的每次反应都会产生最坏情况下的有效门延迟 $t_{g}$（此 $t_{g}$ 聚合了生成下一个握手转换所需的本地组合控制逻辑的延迟）。\n- 在发送方置位 $request$ 之前，数据已经有效并满足捆绑约束；不存在仲裁和亚稳态；分支（若有）是等时的，因此控制因果关系简化为线性事件链。\n\n将最大可持续吞吐量定义为在稳态饱和（即连续的背靠背事务）下，发送方 $request$ 信号连续上升沿之间平均周期时间的倒数。将单次数据传输的端到端延迟定义为从发送方将 $request$ 置为高电平的时刻到发送方在其输入端观察到接收方的 $acknowledge$ 为高电平的时刻之间的时间。\n\n从协议的因果序列和上述时序模型出发，推导并报告：\n- 最大可持续吞吐量，以 $\\mathrm{s}^{-1}$ 为单位，表示为 $t_{g}$ 和 $t_{w}$ 的解析函数。\n- 端到端延迟，以秒为单位，表示为 $t_{g}$ 和 $t_{w}$ 的解析函数。\n\n无需进行数值代入；请提供闭式表达式。此处无需近似。最终答案必须只包含这两个表达式。",
            "solution": "该问题要求推导点对点异步链接的最大可持续吞吐量和端到端延迟的表达式。该链接采用四相归零（RTZ）请求-应答协议。推导将基于指定的握手事件因果序列以及一个包含最坏情况导线传播延迟 $t_w$ 和最坏情况控制逻辑门延迟 $t_g$ 的时序模型。\n\n首先，我们将确定一次完整事务的总周期时间，并由此推导出吞吐量。我们将发送方的请求信号表示为 $req$，接收方的应答信号表示为 $ack$。我们可以从时间 $t=0$ 处事务的发起开始，追踪事件序列及其相关延迟。\n\n1.  在 $t=0$ 时，发送方将 $req$ 置为高电平（$req\\uparrow$）。该信号跨导线传播到接收方，耗时 $t_w$。接收方在时间 $t_w$ 看到 $req\\uparrow$。\n\n2.  接收方的控制逻辑检测到 $req\\uparrow$ 的到达，并通过将 $ack$ 置为高电平（$ack\\uparrow$）来做出反应。此内部反应产生 $t_g$ 的延迟。因此，接收方在时间 $t_w + t_g$ 发出 $ack\\uparrow$。\n\n3.  $ack\\uparrow$ 信号从接收方传播回发送方。这次跨互连线的通信又需要 $t_w$ 的时间。发送方在时间 $(t_w + t_g) + t_w = 2t_w + t_g$ 看到 $ack\\uparrow$。\n\n4.  接收到 $ack\\uparrow$ 后，发送方的控制逻辑通过撤销其请求信号（$req\\downarrow$）来做出反应，以开始归零阶段。此反应耗时 $t_g$。发送方在时间 $(2t_w + t_g) + t_g = 2t_w + 2t_g$ 发出 $req\\downarrow$。\n\n5.  $req\\downarrow$ 信号传输到接收方，耗时 $t_w$。接收方在时间 $(2t_w + 2t_g) + t_w = 3t_w + 2t_g$ 看到 $req\\downarrow$。\n\n6.  接收方的逻辑对 $req\\downarrow$ 做出反应，撤销其应答信号（$ack\\downarrow$）。此反应耗时 $t_g$。接收方在时间 $(3t_w + 2t_g) + t_g = 3t_w + 3t_g$ 发出 $ack\\downarrow$。\n\n7.  $ack\\downarrow$ 信号传播回发送方，耗时 $t_w$。发送方在时间 $(3t_w + 3t_g) + t_w = 4t_w + 3t_g$ 看到 $ack\\downarrow$。\n\n8.  随着接收到 $ack\\downarrow$，一个数据项的握手序列完成。在稳态饱和（连续背靠背事务）的假设下，发送方的逻辑立即准备开始下一个事务。对观察到的 $ack\\downarrow$ 做出反应以生成下一个 $req\\uparrow$ 需要最后一个门延迟 $t_g$。因此，下一个周期在时间 $(4t_w + 3t_g) + t_g = 4t_w + 4t_g$ 开始。\n\n总周期时间 $T_{cycle}$ 是发送方请求信号连续上升沿之间的时间。根据我们的分析，这是从 $t=0$ 到下一个周期开始所经过的时间。\n$$T_{cycle} = 4t_w + 4t_g = 4(t_g + t_w)$$\n最大可持续吞吐量 $\\theta$ 定义为周期时间的倒数。\n$$\\theta = \\frac{1}{T_{cycle}} = \\frac{1}{4(t_g + t_w)}$$\n\n接下来，我们推导端到端延迟 $T_{lat}$。问题将其定义为从发送方置位 $req\\uparrow$ 的时刻到发送方观察到 $ack\\uparrow$ 的时刻。这对应于我们事件分析中直到步骤3的累积时间。其构成延迟为：$req\\uparrow$ 的正向传播（$t_w$）、接收方的反应（$t_g$）以及 $ack\\uparrow$ 的返回传播（$t_w$）。\n$$T_{lat} = t_w + t_g + t_w = 2t_w + t_g$$\n\n如要求所述，推导出的吞吐量和延迟表达式是给定定时参数 $t_g$ 和 $t_w$ 的函数。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4(t_g + t_w)}  2t_w + t_g \\end{pmatrix}}$$"
        },
        {
            "introduction": "在分析了能耗和性能之后，我们必须确保电路在所有条件下都能正确工作。最后一个练习深入探讨了捆绑数据（bundled-data）设计风格的核心，这是一种实现异步数据通路的常用方法 。我们将推导出保证数据被安全捕获的基本时序不等式，为设计可靠的异步流水线提供严谨的理论基础。",
            "id": "4256336",
            "problem": "考虑一个使用互补金属氧化物半导体 (CMOS) 技术实现的二级异步流水线，该流水线采用捆绑数据方式，并配有四相归零请求/应答握手协议。该流水线使用电子设计自动化 (EDA) 工具在相对时序方法学下进行综合。发送级在其输出通道上生成一个数据字，并同时发出一个请求转换，该转换通过一条控制路径，最终使接收级完成数据捕获，然后向发送级发回一个应答转换。\n\n假设在级接口处定义了以下物理可测量：\n- 从发送方数据发出到接收方采样窗口看到最终正确值的最坏情况组合数据路径稳定时间，记为 $t_{data}$。\n- 沿控制网络触发接收级完成点的请求转换的最早有效到达时间，与数据发出进入数据网络的相应有效到达时间之间的最大相对偏斜，记为 $t_{skew}$。定义 $t_{skew} \\geq 0$ 为控制路径相对于数据路径的最大超前量（即，控制路径可以比数据路径最多提前 $t_{skew}$）。\n- 从发送方的请求转换到接收方应答转换发出的控制路径延迟，记为 $t_{ack}$。该延迟包含了通过接收方控制逻辑的传播以及任何显式匹配延迟元件的延迟。\n\n从基本握手语义（应答必须在接收方安全完成数据捕获后才能生成）和最坏情况时序推理（单调传播和用于冒险的最大延迟界定）出发，推导出 $t_{ack}$ 关于 $t_{data}$ 和 $t_{skew}$ 的最小下界表达式 $L$，使得对于最坏情况定义所涵盖的所有工艺、电压和温度变化，任何严格大于 $L$ 的 $t_{ack}$ 都能保证在数据于接收方采样窗口稳定之前，无法观察到应答转换。\n\n解释您引入的每个术语的含义，以及该界限如何强制应答仅在数据稳定后到达。请以一个不带单位的单一符号表达式给出您的最终答案 $L$。",
            "solution": "问题陈述经评估有效。这是一个在异步数字电路设计领域内具有科学依据、定义明确且客观的问题。它自成体系，其术语定义足够精确，可以进行形式化的解析解。该问题要求推导捆绑数据异步流水线中的一个基本时序约束，这是该领域一项标准且不简单的任务。\n\n为推导应答路径延迟 $t_{ack}$ 的最小下界，我们必须建立数据路径和控制路径之间的时序关系，以确保数据被正确捕获。捆绑数据设计的核心原则是，请求信号必须在相关数据在接收方输入端稳定后才能到达接收方。而应答信号则只能在数据被安全捕获后才能生成。\n\n让我们定义以下事件及其相对于一个通用但任意的参考点发生的时间：\n- $T_{data\\_launch}$: 发送级将新数据字发送到数据路径上的时间。\n- $T_{req\\_launch}$: 发送级将相应的请求转换发送到控制路径上的时间。\n\n根据问题定义，我们在接收级有以下事件时序：\n1.  数据在接收方的采样窗口处变得稳定。从数据发出开始测量，所需时间为最坏情况数据路径延迟 $t_{data}$。因此，数据保证在不早于时间 $T_{data\\_stable}$ 时在接收方稳定：\n    $$T_{data\\_stable} = T_{data\\_launch} + t_{data}$$\n2.  接收方发出一个应答转换。从请求发出开始测量，生成此信号的时间为控制路径延迟 $t_{ack}$。应答在时间 $T_{ack\\_emit}$ 发出：\n    $$T_{ack\\_emit} = T_{req\\_launch} + t_{ack}$$\n\n捆绑数据协议的基本安全约束是，任何依赖于数据稳定的操作（例如生成应答）必须在数据保证稳定*之后*发生。在此问题中，该条件是“在数据于接收方采样窗口稳定之前，无法观察到应答转换”。这可转换为以下严格不等式：\n$$T_{ack\\_emit}  T_{data\\_stable}$$\n\n代入 $T_{ack\\_emit}$ 和 $T_{data\\_stable}$ 的表达式：\n$$T_{req\\_launch} + t_{ack}  T_{data\\_launch} + t_{data}$$\n\n为求得 $t_{ack}$ 所需的下界，我们重排此不等式：\n$$t_{ack}  (T_{data\\_launch} - T_{req\\_launch}) + t_{data}$$\n\n此不等式必须在系统规范允许的所有可能时序变化下都成立。这要求我们在最坏情况条件下分析 $(T_{data\\_launch} - T_{req\\_launch})$ 这一项。最坏情况是指对 $t_{ack}$ 提出最严苛要求的场景，即最大化不等式右侧的场景。\n\n问题将 $t_{skew}$ 定义为“最大相对偏斜……定义为控制路径相对于数据路径的最大超前量”。控制路径的超前意味着请求可以在数据*之前*发出。在数学上，这对应于时间差 $(T_{data\\_launch} - T_{req\\_launch})$。此时间差的最大值即为 $t_{skew}$：\n$$(T_{data\\_launch} - T_{req\\_launch}) \\leq t_{skew}$$\n\n为保证在所有有效的操作可能性下都满足安全条件，我们必须确保即使在 $(T_{data\\_launch} - T_{req\\_launch})$ 取其最大可能值时，不等式也成立。将此最大值代入我们的安全不等式，得到对 $t_{ack}$ 最严格的必要条件：\n$$t_{ack}  \\max(T_{data\\_launch} - T_{req\\_launch}) + t_{data}$$\n$$t_{ack}  t_{skew} + t_{data}$$\n\n这就是保证安全的条件。问题要求的是 $t_{ack}$ 的最小下界表达式 $L$，使得任何严格大于 $L$ 的 $t_{ack}$ 都能保证安全。根据我们推导出的不等式，这个下界是：\n$$L = t_{data} + t_{skew}$$\n\n对该界限的解释：\n- $t_{data}$ 项代表数据通过组合逻辑并稳定下来所需的时间。\n- $t_{skew}$ 项代表请求信号（控制）相对于数据信号的最大“领先优势”。在最坏情况下，请求被发出，迅速传播并到达接收方的控制逻辑，而数据则相对于请求尽可能晚地发出，并沿其最慢的路径传播。\n- 和 $t_{data} + t_{skew}$ 代表了从请求发出那一刻 ($T_{req\\_launch}$) 到相应数据在接收方稳定 ($T_{data\\_stable}$) 的最坏情况持续时间。\n- 约束 $t_{ack}  t_{data} + t_{skew}$ 强制要求应答生成路径的延迟 $t_{ack}$ 大于此最坏情况数据稳定时间。这确保了生成应答信号的逻辑只有在其意图捕获的数据变为有效后，才会完成操作并发出应答，从而防止时序冒险。值 $L = t_{data} + t_{skew}$ 是此延迟的阈值。任何设计中若 $t_{ack}$ 可能小于或等于 $L$，则该设计会面临失效的风险。",
            "answer": "$$\\boxed{t_{data} + t_{skew}}$$"
        }
    ]
}