{
    "hands_on_practices": [
        {
            "introduction": "在感测放大器能够检测到微小的电压差之前，位线必须被可靠地预充电到一个已知的电压。本练习通过使用基本的一阶 $RC$ 电路来模拟此预充电操作，为SRAM时序分析建立了基准。掌握这种分析是理解存储器读取周期中关键时序路径的第一步。",
            "id": "4300273",
            "problem": "一个静态随机存取存储器 (SRAM) 宏使用一对位线，在读操作之前进行预充电，以便读出放大器能快速解析微小的差分电压。在一个电子设计自动化 (EDA) 时序模型中，预充电器件被建模为单个等效线性电阻 $R_{\\mathrm{PC}}$，连接到电压为 $V_{\\mathrm{DD}}$ 的理想电源，而每条位线被建模为到地的集总电容 $C_{\\mathrm{BL}}$。假设位线电压初始为 $V_{\\mathrm{BL}}(0)=0$，并且预充电在时间 $t=0$ 启动，通过 $R_{\\mathrm{PC}}$ 将位线连接到 $V_{\\mathrm{DD}}$。在一阶电阻-电容 (RC) 近似下，并仅使用基本电路关系，推导出一个闭式解析表达式，用于表示最小预充电时间 $t_{\\mathrm{pc}}$，该时间需满足位线电压 $|V_{\\mathrm{DD}}-V_{\\mathrm{BL}}(t_{\\mathrm{pc}})| \\le \\delta$，其中 $\\delta$ 是一个以伏特为单位的指定的微小正容差。最终时间以秒为单位表示。最终答案必须是单个解析表达式。",
            "solution": "问题陈述已经过验证，被确定为电子电路分析领域中一个定义明确、具有科学依据的问题。它是自洽的，没有矛盾。解题过程通过应用电路理论的基本原理进行。\n\n该问题描述了 SRAM 位线的预充电过程，该过程被建模为一个一阶 RC 电路。该电路由一个理想电压源 $V_{\\mathrm{DD}}$、一个电阻 $R_{\\mathrm{PC}}$ 和一个电容 $C_{\\mathrm{BL}}$ 串联组成。位线电压，表示为 $V_{\\mathrm{BL}}(t)$，是电容 $C_{\\mathrm{BL}}$ 两端的电压。预充电操作在时间 $t=0$ 开始。\n\n根据基尔霍夫电压定律 (KVL)，闭合回路周围的电压降之和必须等于电源电压。电阻上的电压降为 $V_R(t)$，电容上的电压为 $V_{\\mathrm{BL}}(t)$。因此，我们可以写出：\n$$V_{\\mathrm{DD}} = V_R(t) + V_{\\mathrm{BL}}(t)$$\n根据欧姆定律，流过电阻的电流 $I(t)$ 为：$V_R(t) = I(t) R_{\\mathrm{PC}}$。同样的电流为电容器充电。电容器的电流-电压关系是 $I(t) = C_{\\mathrm{BL}} \\frac{d V_{\\mathrm{BL}}(t)}{dt}$。\n\n将这些关系代入 KVL 方程，我们得到控制位线电压 $V_{\\mathrm{BL}}(t)$ 的一阶线性常微分方程：\n$$V_{\\mathrm{DD}} = R_{\\mathrm{PC}} \\left( C_{\\mathrm{BL}} \\frac{d V_{\\mathrm{BL}}(t)}{dt} \\right) + V_{\\mathrm{BL}}(t)$$\n将此方程重新整理成标准形式可得：\n$$R_{\\mathrm{PC}} C_{\\mathrm{BL}} \\frac{d V_{\\mathrm{BL}}}{dt} + V_{\\mathrm{BL}} = V_{\\mathrm{DD}}$$\n令电路的时间常数为 $\\tau = R_{\\mathrm{PC}} C_{\\mathrm{BL}}$。方程变为：\n$$\\tau \\frac{d V_{\\mathrm{BL}}}{dt} + V_{\\mathrm{BL}} = V_{\\mathrm{DD}}$$\n该微分方程的通解是齐次解与特解（稳态解）之和。\n齐次方程为 $\\tau \\frac{d V_{\\mathrm{BL},h}}{dt} + V_{\\mathrm{BL},h} = 0$，其解为 $V_{\\mathrm{BL},h}(t) = A \\exp(-t/\\tau)$，其中 $A$ 为某个常数。\n特解是当 $t \\to \\infty$ 时的稳态电压，此时电容器已完全充电，没有电流流过（$\\frac{d V_{\\mathrm{BL}}}{dt} = 0$）。在此状态下，$V_{\\mathrm{BL,p}} = V_{\\mathrm{DD}}$。\n完整的通解是：\n$$V_{\\mathrm{BL}}(t) = V_{\\mathrm{BL},h}(t) + V_{\\mathrm{BL,p}}(t) = A \\exp(-t/\\tau) + V_{\\mathrm{DD}}$$\n为了求出常数 $A$，我们应用问题中给出的初始条件：在 $t=0$ 时，位线电压为 $V_{\\mathrm{BL}}(0)=0$。\n$$V_{\\mathrm{BL}}(0) = A \\exp(0) + V_{\\mathrm{DD}} = A + V_{\\mathrm{DD}} = 0$$\n解出 $A$，我们得到 $A = -V_{\\mathrm{DD}}$。\n将 $A$ 的值代回通解，得到位线电压随时间变化的特解：\n$$V_{\\mathrm{BL}}(t) = V_{\\mathrm{DD}} - V_{\\mathrm{DD}} \\exp(-t/\\tau)$$\n这可以因式分解为：\n$$V_{\\mathrm{BL}}(t) = V_{\\mathrm{DD}} (1 - \\exp(-t/\\tau)) = V_{\\mathrm{DD}} (1 - \\exp(-t/(R_{\\mathrm{PC}} C_{\\mathrm{BL}})))$$\n问题要求找到最小预充电时间 $t_{\\mathrm{pc}}$，使得位线电压与最终电源电压 $V_{\\mathrm{DD}}$ 的差值在微小容差 $\\delta$ 之内。这个条件表示为：\n$$|V_{\\mathrm{DD}} - V_{\\mathrm{BL}}(t_{\\mathrm{pc}})| \\le \\delta$$\n在充电过程中，位线电压 $V_{\\mathrm{BL}}(t)$ 从下方逼近 $V_{\\mathrm{DD}}$，因此对于所有的 $t \\ge 0$，有 $V_{\\mathrm{BL}}(t) \\le V_{\\mathrm{DD}}$。所以，$V_{\\mathrm{DD}} - V_{\\mathrm{BL}}(t)$ 项是非负的，绝对值可以去掉：\n$$V_{\\mathrm{DD}} - V_{\\mathrm{BL}}(t_{\\mathrm{pc}}) \\le \\delta$$\n最小时间 $t_{\\mathrm{pc}}$ 将是等式成立时的时间：\n$$V_{\\mathrm{DD}} - V_{\\mathrm{BL}}(t_{\\mathrm{pc}}) = \\delta$$\n现在，我们代入我们推导出的 $V_{\\mathrm{BL}}(t)$ 表达式：\n$$V_{\\mathrm{DD}} - \\left( V_{\\mathrm{DD}} (1 - \\exp(-t_{\\mathrm{pc}}/(R_{\\mathrm{PC}} C_{\\mathrm{BL}}))) \\right) = \\delta$$\n简化方程左边：\n$$V_{\\mathrm{DD}} - V_{\\mathrm{DD}} + V_{\\mathrm{DD}} \\exp(-t_{\\mathrm{pc}}/(R_{\\mathrm{PC}} C_{\\mathrm{BL}})) = \\delta$$\n$$V_{\\mathrm{DD}} \\exp(-t_{\\mathrm{pc}}/(R_{\\mathrm{PC}} C_{\\mathrm{BL}})) = \\delta$$\n为了解出 $t_{\\mathrm{pc}}$，我们首先分离出指数项：\n$$\\exp(-t_{\\mathrm{pc}}/(R_{\\mathrm{PC}} C_{\\mathrm{BL}})) = \\frac{\\delta}{V_{\\mathrm{DD}}}$$\n接下来，我们对两边取自然对数：\n$$\\ln\\left(\\exp(-t_{\\mathrm{pc}}/(R_{\\mathrm{PC}} C_{\\mathrm{BL}}))\\right) = \\ln\\left(\\frac{\\delta}{V_{\\mathrm{DD}}}\\right)$$\n$$- \\frac{t_{\\mathrm{pc}}}{R_{\\mathrm{PC}} C_{\\mathrm{BL}}} = \\ln\\left(\\frac{\\delta}{V_{\\mathrm{DD}}}\\right)$$\n最后，我们解出 $t_{\\mathrm{pc}}$：\n$$t_{\\mathrm{pc}} = - R_{\\mathrm{PC}} C_{\\mathrm{BL}} \\ln\\left(\\frac{\\delta}{V_{\\mathrm{DD}}}\\right)$$\n使用对数恒等式 $-\\ln(x/y) = \\ln(y/x)$，我们可以将表达式写成更直观的形式。由于 $\\delta$ 是一个微小的正容差，我们有 $V_{\\mathrm{DD}} > \\delta$，这确保了对数的参数大于 $1$，因此 $t_{\\mathrm{pc}} > 0$。\n$$t_{\\mathrm{pc}} = R_{\\mathrm{PC}} C_{\\mathrm{BL}} \\ln\\left(\\frac{V_{\\mathrm{DD}}}{\\delta}\\right)$$\n这就是满足指定容差所需的最小预充电时间的闭式解析表达式。如果 $R_{\\mathrm{PC}}$ 的单位是欧姆，而 $C_{\\mathrm{BL}}$ 的单位是法拉，那么时间 $t_{\\mathrm{pc}}$ 的单位就是秒，符合要求。",
            "answer": "$$\\boxed{R_{\\mathrm{PC}} C_{\\mathrm{BL}} \\ln\\left(\\frac{V_{\\mathrm{DD}}}{\\delta}\\right)}$$"
        },
        {
            "introduction": "实际上，没有哪个感测放大器是完美平衡的。固有的器件失配会产生一个输入参考失调电压，这是一个决定读取操作成败的关键参数。本练习将引导您从确定性思维转向统计性思维，演示如何从模拟实验数据中提取此失调及其随机变化，这是稳健电路表征的一项核心技能。",
            "id": "4300332",
            "problem": "一个锁存型静态随机存取存储器（SRAM）读出放大器在集成电路仿真程序（SPICE）中进行了表征，以提取其输入参考系统失调。在评估阶段开始时，该读出放大器在其两个输入节点之间接收一个小的差分输入 $v_{d}$。由于器件失配和动态噪声，二进制决策在多次运行中表现出可变性。在一个有 $N$ 个独立种子的蒙特卡洛实验中，在固定的评估时间内解析为逻辑高电平的运行次数所占的比例被定义为决策概率 $P_{\\mathrm{H}}(v_{d})$。假设一个平稳随机输入失调模型，其中有效输入失调 $X$ 是一个均值为 $V_{\\mathrm{OS}}$、标准差为 $\\sigma$ 的高斯随机变量，记作 $X \\sim \\mathcal{N}(V_{\\mathrm{OS}}, \\sigma)$。在此模型下，给定 $v_{d}$ 时解析为高电平的概率为 $P_{\\mathrm{H}}(v_{d}) = \\Pr(v_{d} - X > 0)$。\n\n定义一个基于 SPICE 的提取程序，该程序在对称值 $\\pm v_{0}$ 上扫描 $v_{d}$，并通过蒙特卡洛方法估计 $P_{\\mathrm{H}}(+v_{0})$ 和 $P_{\\mathrm{H}}(-v_{0})$。仅从定义 $X \\sim \\mathcal{N}(V_{\\mathrm{OS}}, \\sigma)$ 和标准正态分布的累积分布函数出发，推导出将观测到的输出决策不对称性映射到等效输入参考失调 $V_{\\mathrm{OS}}$ 和有效扩展 $\\sigma$ 的闭式表达式。你的推导必须从概率定义出发，并且不应援引预先推导的比较器失调公式。\n\n一次特定的 SPICE 运行得出 $v_{0} = 0.6\\,\\mathrm{mV}$，$P_{\\mathrm{H}}(+v_{0}) = 0.841344746$ 以及 $P_{\\mathrm{H}}(-v_{0}) = 0.308537543$。使用你推导出的公式，从这些测量值中计算 $V_{\\mathrm{OS}}$ 的值。以毫伏为单位表示你的最终结果，并将你的答案四舍五入到四位有效数字。",
            "solution": "该问题提法明确，具有科学依据，并包含足够的信息以得到唯一解。所有参数和假设在集成电路中读出放大器的分析中都是标准的。因此，我们可以开始求解。\n\n问题从决策概率 $P_{\\mathrm{H}}(v_{d})$ 的定义开始，即在给定差分输入电压 $v_{d}$ 的情况下，读出放大器解析为逻辑高电平的概率。该概率由施加的输入 $v_{d}$ 和一个有效的输入参考随机失调电压 $X$ 之间的关系决定。失调 $X$ 被建模为一个均值为 $V_{\\mathrm{OS}}$、标准差为 $\\sigma$ 的高斯随机变量，记为 $X \\sim \\mathcal{N}(V_{\\mathrm{OS}}, \\sigma)$。均值 $V_{\\mathrm{OS}}$ 代表系统失调，标准差 $\\sigma$ 代表随机变化或噪声。\n\n解析为逻辑高电平的条件为 $v_{d} - X > 0$。此事件的概率为：\n$$\nP_{\\mathrm{H}}(v_{d}) = \\Pr(v_{d} - X > 0) = \\Pr(X  v_{d})\n$$\n根据定义，$\\Pr(X \\le v_{d})$ 是随机变量 $X$ 的累积分布函数（CDF），我们将其记为 $F_X(v_{d})$。\n\n为了处理这个概率，我们将随机变量 $X$ 标准化。一个标准正态随机变量 $Z \\sim \\mathcal{N}(0, 1)$ 通过以下变换与 $X$ 相关：\n$$\nZ = \\frac{X - V_{\\mathrm{OS}}}{\\sigma}\n$$\n标准正态分布的 CDF 用 $\\Phi(z)$ 表示，其中 $\\Phi(z) = \\Pr(Z \\le z)$。我们现在可以用 $\\Phi(z)$ 来表示 $F_X(v_d)$：\n$$\nP_{\\mathrm{H}}(v_{d}) = F_X(v_{d}) = \\Pr(X \\le v_{d}) = \\Pr\\left(\\sigma Z + V_{\\mathrm{OS}} \\le v_{d}\\right)\n$$\n对关于 $Z$ 的不等式进行重排：\n$$\n\\Pr\\left(Z \\le \\frac{v_{d} - V_{\\mathrm{OS}}}{\\sigma}\\right) = \\Phi\\left(\\frac{v_{d} - V_{\\mathrm{OS}}}{\\sigma}\\right)\n$$\n因此，我们在测得的概率 $P_{\\mathrm{H}}(v_{d})$ 和失调分布的参数之间建立了一个直接关系：\n$$\nP_{\\mathrm{H}}(v_{d}) = \\Phi\\left(\\frac{v_{d} - V_{\\mathrm{OS}}}{\\sigma}\\right)\n$$\n问题指明，在两个对称的输入电压 $v_{d} = +v_{0}$ 和 $v_{d} = -v_{0}$ 下进行测量。这给了我们一个由两个方程组成的方程组：\n$$\nP_{\\mathrm{H}}(+v_{0}) = \\Phi\\left(\\frac{v_{0} - V_{\\mathrm{OS}}}{\\sigma}\\right) \\quad \\text{(1)}\n$$\n$$\nP_{\\mathrm{H}}(-v_{0}) = \\Phi\\left(\\frac{-v_{0} - V_{\\mathrm{OS}}}{\\sigma}\\right) \\quad \\text{(2)}\n$$\n为了解出这两个未知数 $V_{\\mathrm{OS}}$ 和 $\\sigma$，我们首先对两个方程应用标准正态分布的逆累积分布函数 $\\Phi^{-1}$。令 $z_{1} = \\Phi^{-1}(P_{\\mathrm{H}}(+v_{0}))$ 和 $z_{2} = \\Phi^{-1}(P_{\\mathrm{H}}(-v_{0}))$。\n$$\nz_{1} = \\frac{v_{0} - V_{\\mathrm{OS}}}{\\sigma} \\implies z_{1}\\sigma = v_{0} - V_{\\mathrm{OS}} \\quad \\text{(1a)}\n$$\n$$\nz_{2} = \\frac{-v_{0} - V_{\\mathrm{OS}}}{\\sigma} \\implies z_{2}\\sigma = -v_{0} - V_{\\mathrm{OS}} \\quad \\text{(2a)}\n$$\n我们现在得到了一个关于 $V_{\\mathrm{OS}}$ 和 $\\sigma$ 的二元一次方程组。为了推导 $\\sigma$ 的表达式，我们用方程（1a）减去方程（2a）：\n$$\n(z_{1} - z_{2})\\sigma = (v_{0} - V_{\\mathrm{OS}}) - (-v_{0} - V_{\\mathrm{OS}}) = 2v_{0}\n$$\n解出 $\\sigma$ 得到第一个闭式表达式：\n$$\n\\sigma = \\frac{2v_{0}}{z_{1} - z_{2}} = \\frac{2v_{0}}{\\Phi^{-1}(P_{\\mathrm{H}}(+v_{0})) - \\Phi^{-1}(P_{\\mathrm{H}}(-v_{0}))}\n$$\n为了推导 $V_{\\mathrm{OS}}$ 的表达式，我们将方程（1a）和（2a）相加：\n$$\n(z_{1} + z_{2})\\sigma = (v_{0} - V_{\\mathrm{OS}}) + (-v_{0} - V_{\\mathrm{OS}}) = -2V_{\\mathrm{OS}}\n$$\n解出 $V_{\\mathrm{OS}}$：\n$$\nV_{\\mathrm{OS}} = -\\frac{(z_{1} + z_{2})\\sigma}{2}\n$$\n代入推导出的 $\\sigma$ 的表达式：\n$$\nV_{\\mathrm{OS}} = -\\frac{(z_{1} + z_{2})}{2} \\left( \\frac{2v_{0}}{z_{1} - z_{2}} \\right) = -v_{0} \\frac{z_{1} + z_{2}}{z_{1} - z_{2}}\n$$\n这就得到了输入参考系统失调的第二个闭式表达式：\n$$\nV_{\\mathrm{OS}} = -v_{0} \\frac{\\Phi^{-1}(P_{\\mathrm{H}}(+v_{0})) + \\Phi^{-1}(P_{\\mathrm{H}}(-v_{0}))}{\\Phi^{-1}(P_{\\mathrm{H}}(+v_{0})) - \\Phi^{-1}(P_{\\mathrm{H}}(-v_{0}))}\n$$\n现在，我们使用提供的数值数据来计算 $V_{\\mathrm{OS}}$。给定的值为：\n$v_{0} = 0.6\\,\\mathrm{mV}$\n$P_{\\mathrm{H}}(+v_{0}) = 0.841344746$\n$P_{\\mathrm{H}}(-v_{0}) = 0.308537543$\n\n我们需要通过计算逆CDF来找到相应的 $z$-分数，$z_{1}$ 和 $z_{2}$。提供的概率对应于标准正态CDF的熟知值。\n对于 $z_{1}$：\n$P_{\\mathrm{H}}(+v_{0}) = 0.841344746 \\approx \\Phi(1)$。一个标准正态变量小于或等于均值以上1个标准差的概率大约是 $0.8413$。\n因此，$z_{1} = \\Phi^{-1}(0.841344746) = 1$。\n\n对于 $z_{2}$：\n$P_{\\mathrm{H}}(-v_{0}) = 0.308537543$。我们可以使用正态分布的对称性质，$\\Phi(-z) = 1 - \\Phi(z)$。我们来测试 $z=-0.5$ 的情况。\n$\\Phi(-0.5) = 1 - \\Phi(0.5) \\approx 1 - 0.69146246 = 0.30853754$。这与给定值非常吻合。\n因此，$z_{2} = \\Phi^{-1}(0.308537543) = -0.5$。\n\n现在我们将这些值代入推导出的 $V_{\\mathrm{OS}}$ 表达式中：\n$$\nV_{\\mathrm{OS}} = -v_{0} \\frac{z_{1} + z_{2}}{z_{1} - z_{2}} = -(0.6\\,\\mathrm{mV}) \\frac{1 + (-0.5)}{1 - (-0.5)}\n$$\n$$\nV_{\\mathrm{OS}} = -(0.6\\,\\mathrm{mV}) \\frac{0.5}{1.5} = -(0.6\\,\\mathrm{mV}) \\frac{1}{3}\n$$\n$$\nV_{\\mathrm{OS}} = -0.2\\,\\mathrm{mV}\n$$\n问题要求答案以毫伏为单位，并四舍五入到四位有效数字。\n计算出的值恰好是 $-0.2\\,\\mathrm{mV}$。用四位有效数字表示，即为 $-0.2000\\,\\mathrm{mV}$。",
            "answer": "$$\n\\boxed{-0.2000}\n$$"
        },
        {
            "introduction": "在我们对随机失调理解的基础上，这最后一个练习将多个变化源整合到一个综合的统计静态时序分析 (SSTA) 模型中。您将学习如何传播器件参数（如感测放大器的时间常数和失调）的统计分布，以预测整体感测延迟的统计分布。这种先进的技术对于在现代高度可变的制造工艺中设计可靠的存储器至关重要。",
            "id": "4300302",
            "problem": "考虑静态随机存取存储器 (SRAM) 中的一次读操作，其决策由一个再生式读出放大器 (SA) 作出。在小信号操作中，由于正反馈，SA 处的差分输入电压近似呈指数增长，这与锁存器的一阶线性化动态模型一致。设瞬时电压模型为 $v(t) = v_0 e^{t / \\tau}$，其中 $v_0$ 是 SA 输入端的初始有效输入差分电压，$\\tau$ 是由锁存器的跨导-电容比决定的有效时间常数。决策时间 $t_{\\mathrm{sense}}$ 是 $v(t)$ 达到一个固定决策阈值 $V_{\\mathrm{th}}$ 所需的时间，对于 $v_0  0$，这产生了关系式 $t_{\\mathrm{sense}} = \\tau \\ln\\!\\left(\\dfrac{V_{\\mathrm{th}}}{v_0}\\right)$。\n\n在采用单端位线读出方案的存储器读取中，有效输入差分 $v_0$ 被建模为 $v_0 = \\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}$，其中 $\\Delta V_{\\mathrm{BL}}$ 是在 SA 启用前累积的位线差分电压，而 $V_{\\mathrm{off}}$ 是 SA 的输入参考失调电压。由于工艺变异，失调电压和时间常数都是随机的。为了将 SA 的变异性传播到统计静态时序分析 (SSTA) 中，将时间常数 $\\tau$ 和失调电压 $V_{\\mathrm{off}}$ 建模为由一组共享的独立标准正态源驱动的相关高斯随机变量。\n\n设 $\\mathbf{Z} = [Z_0, Z_1, Z_2]^\\top$ 为独立的标准正态随机变量，分别代表全局晶体管强度变化、局部失配和电源变化。将 SA 参数建模为 $\\mathbf{Z}$ 的仿射函数：\n$$\n\\tau(\\mathbf{Z}) = \\bar{\\tau} + a_0 Z_0 + a_1 Z_1 + a_2 Z_2 \\quad \\text{(单位：ps)},\n$$\n$$\nV_{\\mathrm{off}}(\\mathbf{Z}) = \\bar{v} + b_0 Z_0 + b_1 Z_1 + b_2 Z_2 \\quad \\text{(单位：mV)}.\n$$\n此处，$\\bar{\\tau}$ 和 $\\bar{v}$ 是标称均值，系数 $a_i$（单位为皮秒）和 $b_i$（单位为毫伏）捕捉了 $\\tau$ 和 $V_{\\mathrm{off}}$ 对每个源 $Z_i$ 的敏感度。SA 决策阈值 $V_{\\mathrm{th}}$ 是一个以毫伏为单位的正常量。位线差分电压 $\\Delta V_{\\mathrm{BL}}$ 是在 SA 启用时刻一个以毫伏为单位的正常量。\n\n定义标称有效输入差分电压为 $\\Delta V_{\\mathrm{eff},0} = \\Delta V_{\\mathrm{BL}} - \\bar{v}$，并假设 $\\Delta V_{\\mathrm{eff},0}  0$。使用围绕均值的一阶多元泰勒展开（delta 方法），将随机的读出延迟近似为规范线性正态形式：\n$$\nt_{\\mathrm{sense}}(\\mathbf{Z}) \\approx \\mu_t + c_0 Z_0 + c_1 Z_1 + c_2 Z_2 \\quad \\text{(单位：ps)},\n$$\n其中系数 $c_i$ 和均值 $\\mu_t$ 需被适当地推导出来。此外，失调电压 $V_{\\mathrm{off}}$ 是高斯分布的，其均值为 $\\bar{v}$，方差为 $\\sigma_v^2 = b_0^2 + b_1^2 + b_2^2$。\n\n你的任务是：\n1. 从基本指数增长定律 $v(t) = v_0 e^{t/\\tau}$ 和定义 $t_{\\mathrm{sense}} = \\tau \\ln\\!\\left(\\dfrac{V_{\\mathrm{th}}}{\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}}\\right)$ 出发，推导出一阶规范线性参数 $\\mu_t$ 和 $c_i$，表示为 $\\bar{\\tau}$、$\\bar{v}$、$\\Delta V_{\\mathrm{BL}}$、$V_{\\mathrm{th}}$ 以及敏感度系数 $a_i$、$b_i$ 的函数。\n2. 根据规范线性近似，计算 $t_{\\mathrm{sense}}$ 的标准差 $\\sigma_t$（单位为皮秒）。\n3. 计算因有效输入差分不足导致的读取失败概率，该事件定义为 $V_{\\mathrm{off}} \\ge \\Delta V_{\\mathrm{BL}}$，即 $\\Delta V_{\\mathrm{eff}} \\le 0$ 的概率。使用 $V_{\\mathrm{off}}$ 的高斯分布将此概率表示为小数。\n4. 假设规范线性近似使 $t_{\\mathrm{sense}}$ 近似为高斯分布，计算 $t_{\\mathrm{sense}}$ 的 $0.99$-分位数（即 $99\\%$ 百分位数），单位为皮秒。\n\n数值单位和输出要求：\n- 所有延迟必须以皮秒（ps）计算和报告。\n- 所有电压必须以毫伏（mV）为单位进行解释；对数使用毫伏为单位的电压之比，是无量纲的。\n- 概率必须以小数（而非百分比）报告。\n- 将所有报告的数值结果四舍五入到六位小数。\n\n测试套件：\n对于以下每一组参数，按顺序计算并报告四个量：平均延迟 $\\mu_t$ (ps)，标准差 $\\sigma_t$ (ps)，读取失败概率（小数），以及延迟的 $0.99$-分位数 (ps)。\n\n- 情况 A（一般情况）：\n  - $\\bar{\\tau} = 18.0$ ps, $V_{\\mathrm{th}} = 50.0$ mV, $\\Delta V_{\\mathrm{BL}} = 30.0$ mV, $\\bar{v} = 5.0$ mV,\n  - $\\mathbf{a} = [3.0, 1.0, 2.0]$ ps, $\\mathbf{b} = [2.0, 3.0, 1.0]$ mV.\n- 情况 B（接近边界的有效输入差分）：\n  - $\\bar{\\tau} = 18.0$ ps, $V_{\\mathrm{th}} = 50.0$ mV, $\\Delta V_{\\mathrm{BL}} = 6.0$ mV, $\\bar{v} = 5.0$ mV,\n  - $\\mathbf{a} = [3.0, 1.0, 2.0]$ ps, $\\mathbf{b} = [2.0, 3.0, 1.0]$ mV.\n- 情况 C（强全局相关性）：\n  - $\\bar{\\tau} = 12.0$ ps, $V_{\\mathrm{th}} = 40.0$ mV, $\\Delta V_{\\mathrm{BL}} = 20.0$ mV, $\\bar{v} = 4.0$ mV,\n  - $\\mathbf{a} = [8.0, 0.5, 0.5]$ ps, $\\mathbf{b} = [4.0, 0.5, 0.5]$ mV.\n- 情况 D（具有不同敏感度的中等裕度）：\n  - $\\bar{\\tau} = 20.0$ ps, $V_{\\mathrm{th}} = 60.0$ mV, $\\Delta V_{\\mathrm{BL}} = 10.0$ mV, $\\bar{v} = 8.0$ mV,\n  - $\\mathbf{a} = [2.5, 1.5, 0.5]$ ps, $\\mathbf{b} = [3.5, 0.8, 0.7]$ mV.\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例的结果本身就是形如 $[\\mu_t,\\sigma_t,P_{\\mathrm{fail}},t_{0.99}]$ 的列表，其中每个数值都四舍五入到六位小数。例如，输出格式应类似于 $[[\\text{caseA\\_values}],[\\text{caseB\\_values}],[\\text{caseC\\_values}],[\\text{caseD\\_values}]]$。",
            "solution": "问题是分析 SRAM 读出放大器中读出延迟的统计特性，将关键参数建模为随机变量，并使用一阶泰勒级数近似（delta 方法）。\n\n该问题被认为是有效的，因为它在科学上基于标准的 VLSI 电路分析技术，问题定义明确，提供了足够的信息以获得唯一解，并以客观的数学术语表达。\n\n读出延迟 $t_{\\mathrm{sense}}$ 是时间常数 $\\tau$ 和 SA 失调电压 $V_{\\mathrm{off}}$ 的函数：\n$$\nt_{\\mathrm{sense}} = \\tau \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}}\\right)\n$$\n参数 $\\tau$ 和 $V_{\\mathrm{off}}$ 被建模为独立标准正态随机变量 $\\mathbf{Z} = [Z_0, Z_1, Z_2]^\\top$ 的仿射函数：\n$$\n\\tau(\\mathbf{Z}) = \\bar{\\tau} + \\sum_{i=0}^{2} a_i Z_i\n$$\n$$\nV_{\\mathrm{off}}(\\mathbf{Z}) = \\bar{v} + \\sum_{i=0}^{2} b_i Z_i\n$$\n我们需要找到 $t_{\\mathrm{sense}}(\\mathbf{Z})$ 在均值点（对应于 $\\mathbf{Z} = \\mathbf{0}$）附近的一阶规范线性近似。该近似具有以下形式：\n$$\nt_{\\mathrm{sense}}(\\mathbf{Z}) \\approx \\mu_t + \\sum_{i=0}^{2} c_i Z_i\n$$\n\n### 任务 1：规范线性参数 $\\mu_t$ 和 $c_i$ 的推导\n\n函数 $f(\\mathbf{Z})$ 在 $\\mathbf{Z}=\\mathbf{0}$ 附近的泰勒展开式为 $f(\\mathbf{Z}) \\approx f(\\mathbf{0}) + \\nabla f(\\mathbf{0}) \\cdot \\mathbf{Z}$。\n将此与所需形式进行比较，我们可以确定 $\\mu_t = t_{\\mathrm{sense}}(\\mathbf{0})$ 和 $c_i = \\left. \\frac{\\partial t_{\\mathrm{sense}}}{\\partial Z_i} \\right|_{\\mathbf{Z}=\\mathbf{0}}$。\n\n平均延迟 $\\mu_t$ 是当所有随机源 $Z_i$ 均为零时 $t_{\\mathrm{sense}}$ 的值。在 $\\mathbf{Z}=\\mathbf{0}$ 时，我们有 $\\tau(\\mathbf{0}) = \\bar{\\tau}$ 和 $V_{\\mathrm{off}}(\\mathbf{0}) = \\bar{v}$。因此，\n$$\n\\mu_t = \\bar{\\tau} \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\mathrm{BL}} - \\bar{v}}\\right)\n$$\n让我们定义标称有效输入差分 $\\Delta V_{\\text{eff},0} = \\Delta V_{\\mathrm{BL}} - \\bar{v}$。问题陈述中说明 $\\Delta V_{\\text{eff},0}  0$，因此对数是良定义的。\n$$\n\\mu_t = \\bar{\\tau} \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\text{eff},0}}\\right)\n$$\n\n敏感度系数 $c_i$ 是 $t_{\\mathrm{sense}}$ 对每个 $Z_i$ 的偏导数，在 $\\mathbf{Z}=\\mathbf{0}$ 处求值。我们使用多元链式法则：\n$$\nc_i = \\left. \\frac{\\partial t_{\\mathrm{sense}}}{\\partial Z_i} \\right|_{\\mathbf{Z}=\\mathbf{0}} = \\left( \\frac{\\partial t_{\\mathrm{sense}}}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial Z_i} + \\frac{\\partial t_{\\mathrm{sense}}}{\\partial V_{\\mathrm{off}}} \\frac{\\partial V_{\\mathrm{off}}}{\\partial Z_i} \\right) \\Bigg|_{\\mathbf{Z}=\\mathbf{0}}\n$$\n首先，我们计算 $\\tau$ 和 $V_{\\mathrm{off}}$ 关于 $Z_i$ 的偏导数：\n$$\n\\frac{\\partial \\tau}{\\partial Z_i} = a_i, \\quad \\frac{\\partial V_{\\mathrm{off}}}{\\partial Z_i} = b_i\n$$\n它们是常数。接下来，我们计算 $t_{\\mathrm{sense}}$ 关于 $\\tau$ 和 $V_{\\mathrm{off}}$ 的偏导数：\n$$\n\\frac{\\partial t_{\\mathrm{sense}}}{\\partial \\tau} = \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}}\\right)\n$$\n为了求关于 $V_{\\mathrm{off}}$ 的导数，我们重写对数：$t_{\\mathrm{sense}} = \\tau (\\ln(V_{\\mathrm{th}}) - \\ln(\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}))$。\n$$\n\\frac{\\partial t_{\\mathrm{sense}}}{\\partial V_{\\mathrm{off}}} = \\tau \\left( - \\frac{1}{\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}} \\cdot (-1) \\right) = \\frac{\\tau}{\\Delta V_{\\mathrm{BL}} - V_{\\mathrm{off}}}\n$$\n现在，我们在均值点（$\\mathbf{Z}=\\mathbf{0}$，此时 $\\tau = \\bar{\\tau}$ 且 $V_{\\mathrm{off}} = \\bar{v}$）处计算这些导数：\n$$\n\\left. \\frac{\\partial t_{\\mathrm{sense}}}{\\partial \\tau} \\right|_{\\mathbf{Z}=\\mathbf{0}} = \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\mathrm{BL}} - \\bar{v}}\\right) = \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\text{eff},0}}\\right)\n$$\n$$\n\\left. \\frac{\\partial t_{\\mathrm{sense}}}{\\partial V_{\\mathrm{off}}} \\right|_{\\mathbf{Z}=\\mathbf{0}} = \\frac{\\bar{\\tau}}{\\Delta V_{\\mathrm{BL}} - \\bar{v}} = \\frac{\\bar{\\tau}}{\\Delta V_{\\text{eff},0}}\n$$\n将这些代入 $c_i$ 的表达式中：\n$$\nc_i = \\ln\\left(\\frac{V_{\\mathrm{th}}}{\\Delta V_{\\text{eff},0}}\\right) a_i + \\left(\\frac{\\bar{\\tau}}{\\Delta V_{\\text{eff},0}}\\right) b_i\n$$\n\n### 任务 2：$t_{\\mathrm{sense}}$ 的标准差 $\\sigma_t$\n\n线性化模型将 $t_{\\mathrm{sense}}$ 表示为一个高斯随机变量，因为它是高斯变量的仿射变换。其均值为 $\\mu_t$。方差由独立标准正态变量 $Z_i$ 的线性组合计算得出。\n$$\n\\mathrm{Var}(t_{\\mathrm{sense}}) \\approx \\mathrm{Var}\\left(\\mu_t + \\sum_{i=0}^{2} c_i Z_i\\right) = \\sum_{i=0}^{2} c_i^2 \\mathrm{Var}(Z_i)\n$$\n由于对于标准正态变量有 $\\mathrm{Var}(Z_i)=1$，延迟的方差为 $\\sigma_t^2 = c_0^2 + c_1^2 + c_2^2$。标准差为：\n$$\n\\sigma_t = \\sqrt{c_0^2 + c_1^2 + c_2^2}\n$$\n\n### 任务 3：读取失败的概率\n\n读取失败定义为事件 $V_{\\mathrm{off}} \\ge \\Delta V_{\\mathrm{BL}}$。失调电压 $V_{\\mathrm{off}}$ 是一个高斯随机变量，其均值为 $E[V_{\\mathrm{off}}] = \\bar{v}$，方差为 $\\sigma_v^2 = \\mathrm{Var}(\\sum b_i Z_i) = \\sum b_i^2 \\mathrm{Var}(Z_i) = b_0^2 + b_1^2 + b_2^2$。\n为了求此概率，我们将该随机变量标准化。设 $\\Phi(x)$ 为标准正态分布的累积分布函数 (CDF)。\n$$\nP_{\\mathrm{fail}} = P(V_{\\mathrm{off}} \\ge \\Delta V_{\\mathrm{BL}}) = P\\left(\\frac{V_{\\mathrm{off}} - \\bar{v}}{\\sigma_v} \\ge \\frac{\\Delta V_{\\mathrm{BL}} - \\bar{v}}{\\sigma_v}\\right)\n$$\n左边的项是一个标准正态变量。\n$$\nP_{\\mathrm{fail}} = 1 - \\Phi\\left(\\frac{\\Delta V_{\\mathrm{BL}} - \\bar{v}}{\\sigma_v}\\right) = \\Phi\\left(-\\frac{\\Delta V_{\\mathrm{BL}} - \\bar{v}}{\\sigma_v}\\right)\n$$\n代入 $\\Delta V_{\\text{eff},0} = \\Delta V_{\\mathrm{BL}} - \\bar{v}$ 和 $\\sigma_v = \\sqrt{b_0^2 + b_1^2 + b_2^2}$：\n$$\nP_{\\mathrm{fail}} = \\Phi\\left(-\\frac{\\Delta V_{\\text{eff},0}}{\\sqrt{b_0^2 + b_1^2 + b_2^2}}\\right)\n$$\n\n### 任务 4：$t_{\\mathrm{sense}}$ 的 0.99-分位数\n\n一个高斯随机变量 $X \\sim N(\\mu, \\sigma^2)$ 的 $p$-分位数由 $\\mu + \\sigma \\Phi^{-1}(p)$ 给出，其中 $\\Phi^{-1}$ 是标准正态分布的反累积分布函数（或百分点函数）。\n对于近似延迟 $t_{\\mathrm{sense}} \\sim N(\\mu_t, \\sigma_t^2)$，其 $0.99$-分位数（记为 $t_{0.99}$）为：\n$$\nt_{0.99} = \\mu_t + \\sigma_t \\Phi^{-1}(0.99)\n$$\n$\\Phi^{-1}(0.99)$ 的值是一个常数，约为 $2.326348$。\n\n现在将这些推导出的公式应用于数值测试用例。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\n# Meticulous and exacting professor's solver.\n\ndef solve():\n    \"\"\"\n    Solves the SRAM sense amplifier timing problem for a suite of test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case A (general case)\n        {\n            \"bar_tau\": 18.0, \"V_th\": 50.0, \"Delta_V_BL\": 30.0, \"bar_v\": 5.0,\n            \"a_coeffs\": [3.0, 1.0, 2.0], \"b_coeffs\": [2.0, 3.0, 1.0]\n        },\n        # Case B (near-boundary effective input differential)\n        {\n            \"bar_tau\": 18.0, \"V_th\": 50.0, \"Delta_V_BL\": 6.0, \"bar_v\": 5.0,\n            \"a_coeffs\": [3.0, 1.0, 2.0], \"b_coeffs\": [2.0, 3.0, 1.0]\n        },\n        # Case C (strong global correlation)\n        {\n            \"bar_tau\": 12.0, \"V_th\": 40.0, \"Delta_V_BL\": 20.0, \"bar_v\": 4.0,\n            \"a_coeffs\": [8.0, 0.5, 0.5], \"b_coeffs\": [4.0, 0.5, 0.5]\n        },\n        # Case D (moderate margin with different sensitivities)\n        {\n            \"bar_tau\": 20.0, \"V_th\": 60.0, \"Delta_V_BL\": 10.0, \"bar_v\": 8.0,\n            \"a_coeffs\": [2.5, 1.5, 0.5], \"b_coeffs\": [3.5, 0.8, 0.7]\n        }\n    ]\n\n    all_results = []\n\n    # Z_0.99 is the 99th percentile of the standard normal distribution\n    z_99 = norm.ppf(0.99)\n\n    for case in test_cases:\n        bar_tau = case[\"bar_tau\"]       # ps\n        V_th = case[\"V_th\"]             # mV\n        Delta_V_BL = case[\"Delta_V_BL\"] # mV\n        bar_v = case[\"bar_v\"]           # mV\n        a = np.array(case[\"a_coeffs\"])  # ps\n        b = np.array(case[\"b_coeffs\"])  # mV\n\n        # --- Task 1: Derive mu_t and c_i ---\n        \n        # Nominal effective input differential (mV)\n        # Assumed to be > 0 by the problem statement.\n        Delta_V_eff_0 = Delta_V_BL - bar_v\n\n        # Mean delay mu_t (ps)\n        mu_t = bar_tau * np.log(V_th / Delta_V_eff_0)\n\n        # Sensitivity coefficients c_i (ps)\n        # Common factors for the c_i calculation\n        ln_factor = np.log(V_th / Delta_V_eff_0)\n        tau_factor = bar_tau / Delta_V_eff_0\n        \n        c_coeffs = ln_factor * a + tau_factor * b\n\n        # --- Task 2: Compute standard deviation sigma_t ---\n        \n        # Variance of t_sense (ps^2)\n        sigma_t_sq = np.sum(c_coeffs**2)\n        # Standard deviation of t_sense (ps)\n        sigma_t = np.sqrt(sigma_t_sq)\n\n        # --- Task 3: Compute read-failure probability ---\n        \n        # Standard deviation of offset voltage V_off (mV)\n        sigma_v = np.sqrt(np.sum(b**2))\n        \n        # Argument for the standard normal CDF\n        # P(V_off >= Delta_V_BL) is equivalent to P(Z >= (Delta_V_BL - bar_v) / sigma_v)\n        # which is 1 - P(Z  (Delta_V_BL - bar_v) / sigma_v) = cdf(-(Delta_V_BL - bar_v) / sigma_v)\n        if sigma_v > 0:\n            P_fail_arg = -Delta_V_eff_0 / sigma_v\n            P_fail = norm.cdf(P_fail_arg)\n        else: # Should not happen with given data\n            P_fail = 1.0 if Delta_V_eff_0 = 0 else 0.0\n\n        # --- Task 4: Compute 0.99-quantile of t_sense ---\n        \n        # t_0.99 (ps)\n        t_99 = mu_t + sigma_t * z_99\n\n        # Store results rounded to six decimal places\n        case_results = [\n            round(mu_t, 6),\n            round(sigma_t, 6),\n            round(P_fail, 6),\n            round(t_99, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as required.\n    # e.g., [[1.2,3.4,0.5,6.7],[8.9, ...]]\n    output_str = \"[\"\n    for i, res in enumerate(all_results):\n        output_str += f\"[{','.join(f'{x:.6f}' for x in res)}]\"\n        if i  len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}