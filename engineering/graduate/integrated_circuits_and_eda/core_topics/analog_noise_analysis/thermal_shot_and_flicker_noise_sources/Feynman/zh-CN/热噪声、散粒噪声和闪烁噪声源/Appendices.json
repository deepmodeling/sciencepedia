{
    "hands_on_practices": [
        {
            "introduction": "热噪声，或称约翰逊-奈奎斯特噪声，是所有导电材料中固有的基本噪声源。本练习将指导您完成一个核心计算，即将电阻器的热噪声功率谱密度在给定带宽上积分，从而得到可测量的均方根（RMS）噪声电压。掌握这项技能对于分析任何电子电路的噪声下限至关重要。",
            "id": "4304678",
            "problem": "一个工作在热平衡状态下的无源电阻器，由于载流子的热骚动，会表现出随机的电压波动。考虑一个阻值为 $R=1\\,\\text{k}\\Omega$ 的电阻器，其温度保持在 $T=300\\,\\text{K}$。其电压通过一个理想的线性时不变砖墙滤波器进行观测，该滤波器的幅频响应在单边频率区间 $0 \\le f \\le B$ 内为1，在其他频率处为0，其中 $B=100\\,\\text{kHz}$ 是平坦测量带宽。假设在感兴趣的频带内处于经典状态，即 $h f \\ll k_B T$，将电阻器的热噪声在该频带内视作白噪声，并使用单边功率谱密度进行描述。\n\n从 Johnson–Nyquist 定理和电压噪声功率谱密度的定义出发，并利用均方噪声与通过线性时不变系统的谱积分之间的关系，推导滤波器输出端的均方根输出噪声电压。使用玻尔兹曼常数的值 $k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$，并忽略任何负载或额外的噪声源。\n\n计算最终的数值，并以微伏为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求计算连接到处于热平衡状态的电阻器上的理想滤波器输出端的均方根（RMS）噪声电压。推导始于 Johnson–Nyquist 定理，该定理描述了由电阻器产生的热噪声。\n\n首先，我们来验证问题的陈述。\n给定条件如下：\n- 电阻值：$R = 1\\,\\text{k}\\Omega = 1000\\,\\Omega$\n- 温度：$T = 300\\,\\text{K}$\n- 滤波器类型：理想线性时不变（LTI）砖墙滤波器\n- 滤波器幅频响应：$|H(f)| = 1$ 当 $0 \\le f \\le B$，$|H(f)| = 0$ 当 $f  B$\n- 测量带宽：$B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n- 物理常数：玻尔兹曼常数，$k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$\n- 假设：系统处于经典状态，即 $hf \\ll k_B T$。\n- 假设：电阻器的热噪声在感兴趣的频带内是白噪声。\n- 假设：使用单边功率谱密度进行描述。\n- 目标：推导并计算均方根输出噪声电压 $v_{\\text{rms}}$ 的数值，以微伏为单位，并四舍五入到四位有效数字。\n\n该问题具有科学依据，提法恰当且客观。物理参数是现实的，对于给定的温度和频率范围，经典近似是有效的。问题陈述是完整的且内部一致的。因此，该问题是有效的，我们可以继续进行求解。\n\n根据 Johnson–Nyquist 定理，一个电阻为 $R$、绝对温度为 $T$ 的电阻器的热噪声可以建模为一个噪声电压源。问题指定使用单边功率谱密度（PSD），它描述了噪声功率在正频率上的分布。对于处于经典状态下的电阻器，其单边电压噪声功率谱密度（记为 $S_v(f)$）是白噪声（即不随频率变化），由下式给出：\n$$ S_v(f) = 4 k_B T R $$\n$S_v(f)$ 的单位是伏特平方每赫兹（$\\text{V}^2/\\text{Hz}$）。\n\n该噪声电压通过一个频率响应为 $H(f)$ 的理想 LTI 滤波器。输出电压的功率谱密度 $S_{out}(f)$ 与输入功率谱密度 $S_v(f)$ 的关系如下式所示：\n$$ S_{out}(f) = |H(f)|^2 S_v(f) $$\n\n输出端的均方电压 $\\langle v_{out}^2 \\rangle$ 是通过对输出功率谱密度在所有频率上积分得到的。由于我们使用的是单边功率谱密度，积分从 $f=0$ 到 $f=\\infty$ 进行：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} S_{out}(f) \\, df = \\int_{0}^{\\infty} |H(f)|^2 S_v(f) \\, df $$\n\n现在，我们代入 $S_v(f)$ 和 $|H(f)|$ 的表达式。噪声功率谱密度为 $S_v(f) = 4 k_B T R$。该滤波器是一个理想的砖墙滤波器，其幅频响应在 $0 \\le f \\le B$ 时为 $|H(f)| = 1$，在 $f  B$ 时为 $|H(f)| = 0$。因此， $|H(f)|^2$ 是一个矩形函数：\n$$\n|H(f)|^2 =\n\\begin{cases}\n1  \\text{当 } 0 \\le f \\le B \\\\\n0  \\text{当 } f  B\n\\end{cases}\n$$\n\n将这些代入均方输出电压的积分中：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} |H(f)|^2 (4 k_B T R) \\, df $$\n由于 $4 k_B T R$ 是一个常数，我们可以将其从积分中提出来：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\int_{0}^{\\infty} |H(f)|^2 \\, df $$\n我们现在使用滤波器响应的定义来计算该积分：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\left( \\int_{0}^{B} 1 \\, df + \\int_{B}^{\\infty} 0 \\, df \\right) $$\n第二个积分为零。第一个积分的计算结果为：\n$$ \\int_{0}^{B} 1 \\, df = [f]_{0}^{B} = B - 0 = B $$\n因此，均方输出噪声电压为：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R B $$\n\n问题要求的是均方根（RMS）输出噪声电压 $v_{\\text{rms}}$，即均方电压的平方根：\n$$ v_{\\text{rms}} = \\sqrt{\\langle v_{out}^2 \\rangle} = \\sqrt{4 k_B T R B} $$\n\n现在，我们将给定的数值代入此表达式：\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}/\\text{K}$\n- $T = 300\\,\\text{K}$\n- $R = 1000\\,\\Omega$\n- $B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n\n$$ v_{\\text{rms}} = \\sqrt{4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5} $$\n我们来计算平方根内的值：\n$$ 4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5 = 4 \\times 1.380649 \\times 3 \\times 10^{-23} \\times 10^2 \\times 10^3 \\times 10^5 $$\n$$ = 12 \\times 1.380649 \\times 10^{-23+2+3+5} = 16.567788 \\times 10^{-13} $$\n这可以写成一种更方便开平方根的形式：\n$$ 1.6567788 \\times 10^{-12} \\,\\text{V}^2 $$\n现在我们取平方根：\n$$ v_{\\text{rms}} = \\sqrt{1.6567788 \\times 10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} = \\sqrt{1.6567788} \\times \\sqrt{10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} \\approx 1.28715919 \\times 10^{-6} \\,\\text{V} $$\n\n问题要求结果以微伏（$\\mu\\text{V}$）表示，其中 $1\\,\\mu\\text{V} = 10^{-6}\\,\\text{V}$。\n$$ v_{\\text{rms}} \\approx 1.28715919 \\,\\mu\\text{V} $$\n最后，我们将结果四舍五入到四位有效数字。第五位有效数字是 1，因此我们向下舍入。\n$$ v_{\\text{rms}} \\approx 1.287 \\,\\mu\\text{V} $$\n这就是最终的数值答案。",
            "answer": "$$\n\\boxed{1.287}\n$$"
        },
        {
            "introduction": "除了热噪声，散粒噪声是另一个源于电荷离散性的基本噪声机制，在有直流电流流过的半导体结中尤为重要。本练习通过分析一个串联电阻的二极管电路，探讨了热噪声和散粒噪声之间的权衡关系。通过推导两种噪声贡献相等的偏置电流点，您将深入理解在不同工作条件下，哪种噪声源会成为主导。",
            "id": "4304701",
            "problem": "一个硅二极管在均匀温度$T$下，通过一个串联电阻$R_{s}$由一个理想电压源进行直流偏置。流过二极管的直流电流为$I$。在电子设计自动化（EDA）和噪声感知电路设计的背景下，考虑与二极管中离散载流子输运相关的内在随机波动以及串联电阻中的平衡热搅动。假设测量是在一个频率带内进行的，在该频带内，由材料或工艺非理想性引起的低频过剩噪声可以忽略不计，因此近直流行为可以由载流子离散性和热搅动贡献的平稳白噪声来表征。从第一性原理出发——具体来说，是针对独立电荷输运事件的泊松统计和针对平衡热搅动的涨落-耗散观点——推导二极管由载流子离散性引起的电流波动超过由串联电阻$R_{s}$的热搅动引起的电流波动的条件。以闭合形式确定精确的偏置电流$I_{\\star}(T,R_{s})$，在该电流下，二极管的离散性引起的电流波动恰好等于串联电阻的热电流波动，从而使得当$II_{\\star}$时，离散性引起的波动超过热波动。将你的最终答案表示为仅包含玻尔兹曼常数$k_B$、基本电荷$q$、绝对温度$T$和串联电阻$R_{s}$的单个解析表达式。",
            "solution": "该问题要求推导偏置电流$I_{\\star}$，在该电流下，正向偏置二极管的电流波动幅度等于温度为$T$的串联电阻$R_s$的电流波动幅度。问题指明，当电流$I  I_{\\star}$时，二极管的波动应占主导地位。我们被要求从两种噪声机制的第一性原理出发。\n\n首先，让我们对噪声源进行形式化描述。由于问题陈述要考虑平稳白噪声的贡献，我们可以比较电流波动的单边功率谱密度（PSD），记为$S_i(f)$。在频率带宽$\\Delta f$内的均方电流波动由$\\langle i_n^2 \\rangle = S_i(f) \\Delta f$给出。\n\n1.  **二极管散粒噪声电流波动**\n\n流过p-n结的直流电流$I$是大量离散载流子（电子和空穴）以随机间隔穿过结势垒的结果，每个载流子带电荷$q$。如问题所述，这个过程可以用独立事件的泊松统计来建模。电流不是平滑的流动，而是一系列电荷脉冲。这种固有的颗粒性导致了围绕平均电流$I$的波动。这种现象被称为散粒噪声。\n\n根据电荷输运的泊松统计第一性原理，散粒噪声电流的单边功率谱密度$S_{i, \\text{shot}}(f)$由Schottky公式给出：\n$$\nS_{i, \\text{shot}}(f) = 2qI\n$$\n该PSD在很宽的频率范围内是恒定的，因此它是一个白噪声源。散粒噪声电流波动的幅度与平均直流电流$I$成正比。\n\n2.  **电阻热噪声电流波动**\n\n在温度$T$下处于热平衡状态的导体内部，载流子的热搅动会在其两端产生随机的电压波动。这被称为热噪声或Johnson-Nyquist噪声。涨落-耗散定理为这一现象提供了严谨的基础。对于一个电阻$R_s$，噪声电压源的单边PSD，$S_{v, \\text{th}}(f)$，由下式给出：\n$$\nS_{v, \\text{th}}(f) = 4k_BTR_{s}\n$$\n该噪声源被建模为一个与无噪声电阻$R_s$串联的理想电压源。\n\n为了将其与本质上是电流源的二极管噪声进行比较，用其诺顿等效电路来表示电阻的热噪声是很方便的。诺顿等效电路由一个与无噪声电阻$R_s$并联的噪声电流源组成。这个等效噪声电流源的PSD，$S_{i, \\text{th}}(f)$，通过将电压PSD除以$R_{s}^2$得到：\n$$\nS_{i, \\text{th}}(f) = \\frac{S_{v, \\text{th}}(f)}{R_{s}^2} = \\frac{4k_BTR_{s}}{R_{s}^2} = \\frac{4k_BT}{R_{s}}\n$$\n与散粒噪声不同，热噪声电流波动的幅度与直流电流$I$无关，但取决于温度$T$和电阻$R_s$。\n\n3.  **波动相等的条件**\n\n问题要求找到特定的偏置电流$I_{\\star}$，在该电流下，二极管的电流波动恰好等于串联电阻的热电流波动。这意味着直接比较基本噪声源的强度，这些强度由它们各自的电流PSD表示。问题陈述，当$I  I_{\\star}$时，散粒噪声应占主导地位，这证实了这种解释，因为$S_{i, \\text{shot}}(f)$与$I$成正比，而$S_{i, \\text{th}}(f)$相对于$I$是恒定的。\n\n我们令两个PSD相等，以找到交叉电流$I_{\\star}$：\n$$\nS_{i, \\text{shot}}(f) \\Big|_{I=I_{\\star}} = S_{i, \\text{th}}(f)\n$$\n代入PSD的表达式：\n$$\n2qI_{\\star} = \\frac{4k_BT}{R_{s}}\n$$\n\n4.  **偏置电流$I_{\\star}$的推导**\n\n求解关于$I_{\\star}$的方程得到：\n$$\nI_{\\star} = \\frac{4k_BT}{2qR_{s}}\n$$\n$$\nI_{\\star} = \\frac{2k_BT}{qR_{s}}\n$$\n该表达式给出了精确的偏置电流，在该电流下，散粒噪声电流源的幅度等于电阻的诺顿等效热噪声电流源的幅度。对于任何电流$I  I_{\\star}$，不等式$2qI  \\frac{4k_BT}{R_{s}}$成立，这意味着来自二极管的散粒噪声波动的确会超过可归因于电阻的热噪声波动，这与问题陈述一致。该表达式如要求所示，是根据基本常数$k_B$、$q$、温度$T$和电阻$R_s$来表示的。",
            "answer": "$$\n\\boxed{\\frac{2k_BT}{qR_{s}}}\n$$"
        },
        {
            "introduction": "在实际的集成电路设计中，多个噪声源（热噪声、散粒噪声和闪烁噪声）会同时存在并共同影响电路性能。本综合练习模拟了在SPICE等电路仿真工具中使用的专业方法，要求您为一个简单的MOS放大器建立一个完整的输入参考噪声模型。通过这个练习，您将学会如何将来自不同物理机理的独立噪声贡献合并，以评估放大器的整体噪声性能。",
            "id": "4304691",
            "problem": "您的任务是，为一个简单的放大器形式化并验证其输入参考噪声的计算，该计算应与在集成电路通用模拟程序（SPICE）中执行的交流（AC）噪声分析保持一致。考虑一个线性时不变共源金属-氧化物-半导体（MOS）放大器，其输出节点由单个电阻器加载。该放大器的小信号跨导为 $g_m$，漏极负载电阻为 $R_D$，并表现出由系数 $\\gamma$ 表征的固有沟道热噪声。一个偏置支路由于直流电流 $I_{\\text{bias}}$ 而产生散粒噪声，并且该器件表现出闪烁噪声，其系数为 $K_f$，与频率成反比。环境温度为 $T$。从中频带输入到输出的小信号电压增益幅值为 $|A_v|$，并且放大器在远离任何极点的位置工作，因此频率依赖性仅由闪烁噪声引起。\n\n基本原理与假设：\n- 放大器是线性和时不变的，输出节点由一个电阻性负载 $R_D$ 主导，因此小信号电压增益幅值为 $|A_v|$，且输出端的电流-电压转换由 $R_D$ 决定。\n- 电阻热噪声由一个等效电压源建模，其单边功率谱密度（PSD）由下式给出：$$S_{v,R} = 4 k_B T R$$ 其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$R$ 是电阻值（单位：欧姆）。\n- MOS 沟道热噪声由一个漏极电流噪声源建模，其单边 PSD 为：$$S_{i,\\mathrm{th}} = 4 k_B T \\gamma g_m$$ 其中 $\\gamma$ 是过剩噪声因子，$g_m$ 是跨导。\n- 散粒噪声由泊松过程建模，其单边电流 PSD 为：$$S_{i,\\mathrm{sh}} = 2 q I_{\\mathrm{bias}}$$ 其中 $q$ 是基本电荷，$I_{\\mathrm{bias}}$ 是引起载流子注入的直流电流。\n- 闪烁噪声（1/f 噪声）在这里由一个漏极电流噪声源建模，其单边 PSD 为：$$S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$$ 其中 $K_f$ 是一个与器件相关的系数，$f$ 是频率（单位：赫兹）。\n\n您的目标：\n1. 在假设电流噪声源通过负载电阻转换为输出电压噪声的前提下，表达如何通过适当组合上述独立噪声源来计算放大器输出端的输出参考电压噪声 PSD。\n2. 根据输出参考电压噪声 PSD 和小信号增益幅值 $|A_v|$，推导出输入参考电压噪声 PSD 及其平方根谱密度（电压噪声密度）。\n3. 提供一个算法，用于在给定参数 $(g_m, R_D, \\gamma, T, I_{\\mathrm{bias}}, K_f)$ 的情况下，在指定频率 $f$ 处数值计算输入参考电压噪声密度。\n4. 通过计算以下测试套件的数值结果，对手动计算的表达式进行验证。对于每种情况，计算输入参考电压噪声密度，并以纳伏每平方根赫兹 (nV/$\\sqrt{\\mathrm{Hz}}$) 为单位表示最终数值答案，四舍五入到六位小数。\n\n在所有计算中使用以下常数：\n- 玻尔兹曼常数：$k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n- 基本电荷：$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n\n测试套件（每个元组为 ($g_m$ [S], $R_D$ [Ω], $\\gamma$, $T$ [K], $I_{\\text{bias}}$ [A], $K_f$ [A²], $f$ [Hz])）：\n- 情况 1 (平衡中频带，非零散粒噪声): ($5.0 \\times 10^{-3}$, 2000, 0.7, 300, $100.0 \\times 10^{-6}$, $1.0 \\times 10^{-22}$, $10.0 \\times 10^{3}$)。\n- 情况 2 (低频，闪烁噪声主导): ($5.0 \\times 10^{-3}$, 2000, 0.7, 300, 0.0, $1.0 \\times 10^{-18}$, 1.0)。\n- 情况 3 (高频，闪烁噪声可忽略，零散粒噪声): ($5.0 \\times 10^{-3}$, 2000, 0.7, 300, 0.0, $1.0 \\times 10^{-22}$, $100.0 \\times 10^{6}$)。\n- 情况 4 (电阻主导边缘，小负载，零散粒和闪爍噪声): ($5.0 \\times 10^{-3}$, 500, 0.7, 300, 0.0, 0.0, $10.0 \\times 10^{3}$)。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含四种情况下的输入参考电压噪声密度，以逗号分隔列表形式包含在方括号中，单位为 nV/$\\sqrt{\\mathrm{Hz}}$，每个值四舍五入到六位小数（例如，$$[x_1,x_2,x_3,x_4]$$ 其中每个 $x_i$ 是一个浮点数）。",
            "solution": "首先，将对所述问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题提供了关于共源 MOS 放大器的以下数据、定义和条件：\n- 小信号跨导：$g_m$\n- 漏极负载电阻：$R_D$\n- MOS 沟道热噪声系数：$\\gamma$\n- 环境温度：$T$\n- 偏置支路直流电流：$I_{\\text{bias}}$\n- 闪烁噪声系数：$K_f$\n- 小信号电压增益幅值：$|A_v|$\n- 关注频率：$f$\n- 玻尔兹曼常数：$k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n- 基本电荷：$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n\n噪声源的单边功率谱密度（PSD）定义如下：\n- 电阻热噪声（电压）：$S_{v,R} = 4 k_B T R$\n- MOS 沟道热噪声（电流）：$S_{i,\\mathrm{th}} = 4 k_B T \\gamma g_m$\n- 散粒噪声（电流）：$S_{i,\\mathrm{sh}} = 2 q I_{\\text{bias}}$\n- 闪烁噪声（电流）：$S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$\n\n测试套件参数 ($g_m$ [S], $R_D$ [Ω], $\\gamma$, $T$ [K], $I_{\\text{bias}}$ [A], $K_f$ [A²], $f$ [Hz]) 为：\n- 情况 1：($5.0 \\times 10^{-3}$ S, 2000 Ω, 0.7, 300 K, $100.0 \\times 10^{-6}$ A, $1.0 \\times 10^{-22}$ A², $10.0 \\times 10^{3}$ Hz)\n- 情况 2：($5.0 \\times 10^{-3}$ S, 2000 Ω, 0.7, 300 K, 0.0 A, $1.0 \\times 10^{-18}$ A², 1.0 Hz)\n- 情况 3：($5.0 \\times 10^{-3}$ S, 2000 Ω, 0.7, 300 K, 0.0 A, $1.0 \\times 10^{-22}$ A², $100.0 \\times 10^{6}$ Hz)\n- 情况 4：($5.0 \\times 10^{-3}$ S, 500 Ω, 0.7, 300 K, 0.0 A, 0.0 A², $10.0 \\times 10^{3}$ Hz)\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n- **科学依据**：问题基于半导体器件中热噪声、散粒噪声和闪烁噪声的标准、普遍接受的模型。所提供的功率谱密度公式是正确的，并构成了像 SPICE 这样的工具中噪声分析的基础。\n- **良态问题**：问题是良态的。它为每个测试用例提供了计算唯一数值答案所需的所有参数和物理常数。提到了小信号增益 $|A_v|$，其对于具有电阻性负载 $R_D$ 的共源放大器的值在上下文中被隐式定义为 $|A_v| = g_m R_D$。这是一个标准的简化，并且与问题陈述中“输出端的电流-电压转换由 $R_D$ 决定”相一致。\n- **客观性**：问题以精确、客观、无歧义的科学语言陈述。\n- **完整性与一致性**：问题是自洽的，没有矛盾。给定的参数和定义足以得出完整解。\n- **真实性**：测试套件中的数值对于各种工作条件下的 MOS 晶体管是物理上现实的。\n- **结论**：问题没有任何使其无效的缺陷。\n\n### 步骤 3：判定与行动\n问题是\n**有效的**。将提供一个完整的、合理的解答。\n\n### 解答推导\n\n放大器的总输入参考噪声是通过计算每个噪声源在输出端的贡献，然后将此总输出噪声参考回输入端来确定的。我们假设所有噪声源在统计上是独立的（不相关），因此它们的功率谱密度可以相加。\n\n**1. 输出参考电压噪声功率谱密度 ($S_{v, \\text{out}}(f)$)**\n\n输出端的总电压噪声 PSD，$S_{v, \\text{out}}(f)$，是每个噪声源 PSD 的线性总和。\n\n- **负载电阻热噪声**：输出端的电阻 $R_D$ 直接贡献电压噪声。其 PSD 给出为：\n$$ S_{v, R_D}(f) = 4 k_B T R_D $$\n- **MOS 沟道热噪声**：MOS 晶体管的沟道热噪声被建模为一个电流源，其 PSD 为 $S_{i,\\mathrm{th}} = 4 k_B T \\gamma g_m$。这个噪声电流流过输出电阻 $R_D$，产生输出电压噪声。其电压 PSD 是：\n$$ S_{v, \\text{out, th}}(f) = S_{i,\\mathrm{th}} \\cdot R_D^2 = (4 k_B T \\gamma g_m) R_D^2 $$\n- **散粒噪声**：偏置电流 $I_{\\text{bias}}$ 贡献散粒噪声，被建模为一个电流源，其 PSD 为 $S_{i,\\mathrm{sh}} = 2 q I_{\\text{bias}}$。这个噪声电流也流过 $R_D$，在输出端贡献一个电压 PSD：\n$$ S_{v, \\text{out, sh}}(f) = S_{i,\\mathrm{sh}} \\cdot R_D^2 = (2 q I_{\\text{bias}}) R_D^2 $$\n- **闪烁噪声**：晶体管的闪烁噪声是一个与频率相关的电流源，其 PSD 为 $S_{i,\\mathrm{f}}(f) = K_f/f$。它对输出电压 PSD 的贡献是：\n$$ S_{v, \\text{out, f}}(f) = S_{i,\\mathrm{f}}(f) \\cdot R_D^2 = \\frac{K_f}{f} R_D^2 $$\n\n总输出参考电压噪声 PSD 是这些分量的总和：\n$$ S_{v, \\text{out}}(f) = S_{v, R_D}(f) + S_{v, \\text{out, th}}(f) + S_{v, \\text{out, sh}}(f) + S_{v, \\text{out, f}}(f) $$\n$$ S_{v, \\text{out}}(f) = 4 k_B T R_D + (4 k_B T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2 $$\n\n**2. 输入参考电压噪声功率谱密度 ($S_{v, \\text{in}}(f)$)**\n\n要将总输出噪声 PSD 参考到输入端，我们将其除以放大器小信号电压增益幅值的平方 $|A_v|^2$。对于一个具有负载电阻 $R_D$ 且晶体管输出电阻可忽略不计的共源放大器，增益由 $|A_v| = g_m R_D$ 给出。因此，$|A_v|^2 = (g_m R_D)^2 = g_m^2 R_D^2$。\n\n输入参考电压噪声 PSD，$S_{v, \\text{in}}(f)$，是：\n$$ S_{v, \\text{in}}(f) = \\frac{S_{v, \\text{out}}(f)}{|A_v|^2} = \\frac{4 k_B T R_D + (4 k_B T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2}{g_m^2 R_D^2} $$\n将分子中的每一项除以分母 $g_m^2 R_D^2$ 得出各自的输入参考贡献：\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_B T R_D}{g_m^2 R_D^2} + \\frac{4 k_B T \\gamma g_m R_D^2}{g_m^2 R_D^2} + \\frac{2 q I_{\\text{bias}} R_D^2}{g_m^2 R_D^2} + \\frac{K_f R_D^2}{f \\cdot g_m^2 R_D^2} $$\n简化此表达式，得到总输入参考电压噪声 PSD 的最终公式：\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_B T \\gamma}{g_m} + \\frac{4 k_B T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2} $$\n这些项分别对应于来自沟道热噪声、负载电阻热噪声、散粒噪声和闪烁噪声的输入参考噪声。\n\n**3. 输入参考电压噪声密度 ($v_{n, \\text{in}}(f)$)**\n\n输入参考电压噪声密度，通常以 $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$ 为单位表示，是 PSD 的平方根：\n$$ v_{n, \\text{in}}(f) = \\sqrt{S_{v, \\text{in}}(f)} = \\sqrt{\\frac{4 k_B T \\gamma}{g_m} + \\frac{4 k_B T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2}} $$\n\n这个最终表达式提供了一个计算所需值的完整算法。以下程序实现了这个公式，以计算所提供的测试套件的数值结果。最终答案通过将以 $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$ 为单位的结果乘以 $10^9$ 转换为纳伏每平方根赫兹（$\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the noise analysis problem for the given test cases.\n    \"\"\"\n\n    # Define physical constants as specified in the problem.\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    Q = 1.602176634e-19  # Elementary charge in C\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (gm [S], RD [Ohm], gamma, T [K], Ibias [A], Kf [A^2], f [Hz])\n    test_cases = [\n        (5.0e-3, 2000, 0.7, 300, 100.0e-6, 1.0e-22, 10.0e3),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-18, 1.0),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-22, 100.0e6),\n        (5.0e-3, 500, 0.7, 300, 0.0, 0.0, 10.0e3),\n    ]\n\n    def calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq):\n        \"\"\"\n        Computes the input-referred voltage noise density.\n\n        The total input-referred voltage noise Power Spectral Density (PSD) is the\n        sum of the individual contributions from each noise source:\n        S_v_in(f) = S_channel_th + S_load_th + S_shot + S_flicker\n\n        where:\n        S_channel_th = (4 * KB * T * gamma) / gm\n        S_load_th    = (4 * KB * T) / (gm^2 * rd)\n        S_shot       = (2 * Q * ibias) / gm^2\n        S_flicker    = Kf / (f * gm^2)\n        \n        The noise density is the square root of the total PSD.\n        \"\"\"\n        gm_sq = gm**2\n        four_kb_t = 4 * KB * temp\n\n        # Calculate each component of the input-referred noise PSD\n        s_channel_th = (four_kb_t * gamma) / gm\n        s_load_th = four_kb_t / (gm_sq * rd)\n        s_shot = (2 * Q * ibias) / gm_sq\n        s_flicker = kf / (freq * gm_sq)\n        \n        # Total input-referred voltage noise PSD (V^2/Hz)\n        s_v_in_total = s_channel_th + s_load_th + s_shot + s_flicker\n\n        # Input-referred voltage noise density (V/sqrt(Hz))\n        v_n_in = np.sqrt(s_v_in_total)\n\n        # Convert to nV/sqrt(Hz)\n        v_n_in_nanovolts = v_n_in * 1e9\n\n        return v_n_in_nanovolts\n\n    results = []\n    for case in test_cases:\n        gm, rd, gamma, temp, ibias, kf, freq = case\n        result = calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}