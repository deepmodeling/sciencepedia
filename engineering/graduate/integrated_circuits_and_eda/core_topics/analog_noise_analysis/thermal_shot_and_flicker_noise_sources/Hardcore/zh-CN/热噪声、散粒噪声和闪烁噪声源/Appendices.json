{
    "hands_on_practices": [
        {
            "introduction": "在噪声分析中，第一步是理解最基本的噪声源：电阻中的热噪声。本练习将指导您从约翰逊-奈奎斯特（Johnson-Nyquist）定理出发，计算一个电阻在特定带宽内的均方根（RMS）噪声电压 。这个实践有助于巩固对温度 $T$、电阻 $R$、带宽 $B$ 和噪声功率之间关系的理解。",
            "id": "4304678",
            "problem": "一个处于热平衡状态的无源电阻器，由于载流子的热骚动，会表现出随机的电压波动。考虑一个阻值为 $R=1\\,\\text{k}\\Omega$ 的电阻器，其温度保持在 $T=300\\,\\text{K}$。其电压通过一个理想的线性时不变砖墙滤波器进行观测，该滤波器的幅频响应在单边频率区间 $0 \\le f \\le B$ 内为1，在其他频率处为0，其中 $B=100\\,\\text{kHz}$ 是平坦测量带宽。假设在感兴趣的频带内处于经典区，即 $h f \\ll k_B T$ 成立，将电阻器的热噪声视为带内白噪声，并使用单边功率谱密度进行描述。\n\n从约翰逊-奈奎斯特定理、电压噪声功率谱密度的定义，以及均方噪声与通过线性时不变系统的谱积分之间的关系出发，推导滤波器输出端的均方根输出噪声电压。使用玻尔兹曼常数的值 $k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$，并忽略任何负载效应或其他噪声源。\n\n计算最终的数值，并以微伏为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算连接到处于热平衡状态的电阻器上的理想滤波器输出端的均方根（RMS）噪声电压。推导从约翰逊-奈奎斯特定理开始，该定理描述了由电阻器产生的热噪声。\n\n首先，我们来验证问题陈述。\n已知条件如下：\n- 电阻值：$R = 1\\,\\text{k}\\Omega = 1000\\,\\Omega$\n- 温度：$T = 300\\,\\text{K}$\n- 滤波器类型：理想线性时不变（LTI）砖墙滤波器\n- 滤波器幅频响应：$|H(f)| = 1$ 对于 $0 \\le f \\le B$，$|H(f)| = 0$ 对于 $f  B$\n- 测量带宽：$B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n- 物理常数：玻尔兹曼常数，$k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$\n- 假设：系统处于经典区，即 $hf \\ll k_B T$。\n- 假设：电阻器的热噪声在感兴趣的频带内是白噪声。\n- 假设：使用单边功率谱密度进行描述。\n- 目标：推导并计算均方根输出噪声电压 $v_{\\text{rms}}$ 的数值，以微伏为单位，并四舍五入到四位有效数字。\n\n该问题具有科学依据，提法恰当且客观。物理参数是现实的，对于给定的温度和频率范围，经典近似是有效的。问题陈述完整且内部一致。因此，该问题是有效的，我们可以继续求解。\n\n根据约翰逊-奈奎斯特定理，一个在绝对温度 $T$ 下的电阻 $R$ 的热噪声可以建模为一个噪声电压源。问题指定使用单边功率谱密度（PSD），它描述了噪声功率在正频率上的分布。对于经典区中的电阻器，其单边电压噪声PSD，记为 $S_v(f)$，是白噪声（即不随频率变化），由下式给出：\n$$ S_v(f) = 4 k_B T R $$\n$S_v(f)$ 的单位是伏特平方每赫兹（$\\text{V}^2/\\text{Hz}$）。\n\n此噪声电压通过一个频率响应为 $H(f)$ 的理想LTI滤波器。输出电压的PSD，$S_{out}(f)$，与输入PSD，$S_v(f)$，通过以下方程相关联：\n$$ S_{out}(f) = |H(f)|^2 S_v(f) $$\n\n输出端的均方电压 $\\langle v_{out}^2 \\rangle$ 是通过对输出PSD在所有频率上积分得到的。由于我们使用的是单边PSD，积分从 $f=0$ 到 $f=\\infty$ 进行：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} S_{out}(f) \\, df = \\int_{0}^{\\infty} |H(f)|^2 S_v(f) \\, df $$\n\n现在，我们代入 $S_v(f)$ 和 $|H(f)|$ 的表达式。噪声PSD为 $S_v(f) = 4 k_B T R$。该滤波器是一个理想的砖墙滤波器，其幅频响应在 $0 \\le f \\le B$ 时为 $|H(f)| = 1$，在 $f  B$ 时为 $|H(f)| = 0$。因此，$|H(f)|^2$ 是一个矩形函数：\n$$\n|H(f)|^2 =\n\\begin{cases}\n1  \\text{对于 } 0 \\le f \\le B \\\\\n0  \\text{对于 } f  B\n\\end{cases}\n$$\n\n将这些代入均方输出电压的积分中：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} |H(f)|^2 (4 k_B T R) \\, df $$\n由于 $4 k_B T R$ 是一个常数，我们可以将其从积分中提出：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\int_{0}^{\\infty} |H(f)|^2 \\, df $$\n现在我们使用滤波器的响应定义来计算该积分：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\left( \\int_{0}^{B} 1 \\, df + \\int_{B}^{\\infty} 0 \\, df \\right) $$\n第二个积分为零。第一个积分的计算结果为：\n$$ \\int_{0}^{B} 1 \\, df = [f]_{0}^{B} = B - 0 = B $$\n因此，均方输出噪声电压为：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R B $$\n\n问题要求的是均方根（RMS）输出噪声电压 $v_{\\text{rms}}$，即均方电压的平方根：\n$$ v_{\\text{rms}} = \\sqrt{\\langle v_{out}^2 \\rangle} = \\sqrt{4 k_B T R B} $$\n\n现在，我们将给定的数值代入此表达式：\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}/\\text{K}$\n- $T = 300\\,\\text{K}$\n- $R = 1000\\,\\Omega$\n- $B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n\n$$ v_{\\text{rms}} = \\sqrt{4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5} $$\n我们来计算平方根内的值：\n$$ 4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5 = 4 \\times 1.380649 \\times 3 \\times 10^{-23} \\times 10^2 \\times 10^3 \\times 10^5 $$\n$$ = 12 \\times 1.380649 \\times 10^{-23+2+3+5} = 16.567788 \\times 10^{-13} $$\n这可以写成一个更方便于开平方根的形式：\n$$ 1.6567788 \\times 10^{-12} \\,\\text{V}^2 $$\n现在我们取平方根：\n$$ v_{\\text{rms}} = \\sqrt{1.6567788 \\times 10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} = \\sqrt{1.6567788} \\times \\sqrt{10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} \\approx 1.28715919 \\times 10^{-6} \\,\\text{V} $$\n\n问题要求结果以微伏（$\\mu\\text{V}$）表示，其中 $1\\,\\mu\\text{V} = 10^{-6}\\,\\text{V}$。\n$$ v_{\\text{rms}} \\approx 1.28715919 \\,\\mu\\text{V} $$\n最后，我们将结果四舍五入到四位有效数字。第五位有效数字是1，所以我们向下舍入。\n$$ v_{\\text{rms}} \\approx 1.287 \\,\\mu\\text{V} $$\n这是最终的数值答案。",
            "answer": "$$\n\\boxed{1.287}\n$$"
        },
        {
            "introduction": "在理解了热噪声的基本原理之后，本练习将探讨其在系统层面的影响。它将演示在一个低噪声放大器（LNA）前端加入一个具有损耗 $L$ 的无源元件（如衰减器）会如何劣化整个系统的噪声性能 。这项练习对于理解在设计高灵敏度接收机时最小化前端损耗这一关键原则至关重要。",
            "id": "4304692",
            "problem": "一个匹配的两端口级联网络由一个损耗为 $1\\,\\text{dB}$ 的无源匹配衰减器和一个低噪声放大器（LNA）串联而成，衰减器在前。信号源是一个在标准参考温度 $T_0 = 290\\,\\text{K}$ 下的匹配电阻源。该无源衰减器的物理温度为 $T = T_0$，仅产生热噪声，其线性功率损耗 $L$ 对应于 $1\\,\\text{dB}$。该LNA是线性和时不变的，其内部噪声源于热噪声、散粒噪声和闪烁噪声机制；其固有噪声系数在参考温度 $T_0$下为 $NF_2 = 0.65\\,\\text{dB}$。假设在感兴趣的频带内所有终端都完美匹配，该频带远高于量子极限，因此 Johnson-Nyquist 热噪声模型适用，且LNA的增益为有限正值。\n\n从两端口网络的噪声因数定义 $F = \\mathrm{SNR}_{\\mathrm{in}} / \\mathrm{SNR}_{\\mathrm{out}}$ 出发，并仅利用无源匹配元件和线性级联的热噪声特性，推导一个级联总噪声因数 $F_{\\mathrm{tot}}$ 的解析表达式。该级联网络由一个温度为 $T$ 的无源第一级和一个噪声因数为 $F_2$、小信号功率增益为 $G_2$ 的任意第二级组成。你的表达式必须明确显示 $F_{\\mathrm{tot}}$ 如何依赖于无源衰减器的线性损耗 $L$、温度比 $T/T_0$ 以及LNA的噪声因数 $F_2$。然后，使用 $T = T_0$、由 $1\\,\\text{dB}$ 衰减器设定的 $L$ 以及 $NF_2 = 0.65\\,\\text{dB}$，计算级联总噪声系数 $NF_{\\mathrm{tot}}$（以分贝为单位）。\n\n将你的最终答案表示为一个代表 $NF_{\\mathrm{tot}}$（以分贝为单位）的实数，并将答案四舍五入到四位有效数字。使用分贝作为噪声系数的单位。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法恰当。\n\n### 步骤 1：提取已知条件\n-   系统：一个由两个两端口网络组成的级联系统。\n-   第一级：一个无源匹配衰减器。\n    -   损耗：$1\\,\\text{dB}$。这对应于线性功率损耗 $L$。\n    -   物理温度：$T = T_0$。\n    -   噪声机制：仅热噪声。\n-   第二级：一个低噪声放大器（LNA）。\n    -   固有噪声系数：$NF_2 = 0.65\\,\\text{dB}$。\n    -   LNA是线性和时不变的。\n-   信号源：一个在标准参考温度 $T_0 = 290\\,\\text{K}$ 下的匹配电阻源。\n-   假设：\n    -   完美匹配的终端。\n    -   Johnson-Nyquist 热噪声模型适用。\n    -   LNA增益为有限正值。\n-   定义：\n    -   噪声因数 $F = \\mathrm{SNR}_{\\mathrm{in}} / \\mathrm{SNR}_{\\mathrm{out}}$。\n-   任务 1：在衰减器温度为 $T$ 的一般情况下，推导级联总噪声因数 $F_{\\mathrm{tot}}$ 的解析表达式，该表达式是衰减器线性损耗 $L$、温度比 $T/T_0$ 和LNA噪声因数 $F_2$ 的函数。\n-   任务 2：在 $T=T_0$、损耗为 $1\\,\\text{dB}$、 $NF_2=0.65\\,\\text{dB}$ 的特定情况下，计算级联总噪声系数 $NF_{\\mathrm{tot}}$（以分贝为单位）。结果应四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，基于线性电子系统中噪声分析的基本原理，例如噪声因数和噪声系数的定义、无源元件中的热噪声（Johnson-Nyquist 噪声）以及级联系统的分析。该问题提法恰当，提供了所有必要的信息和条件（$T_0=290\\,\\text{K}$，$NF_2=0.65\\,\\text{dB}$，损耗=$1\\,\\text{dB}$），以便在要求的解析推导后得出唯一的数值解。语言客观、精确。给定的数值对于射频/微波元件是物理上现实的。问题内容自洽，没有矛盾。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 推导与解答\n\n两端口网络的噪声因数 $F$ 定义为输入端的信噪比与输出端的信噪比之比：\n$$F = \\frac{\\mathrm{SNR}_{\\mathrm{in}}}{\\mathrm{SNR}_{\\mathrm{out}}}$$\n按照惯例，输入噪声功率 $N_{\\mathrm{in}}$ 是在标准参考温度 $T_0 = 290\\,\\text{K}$ 下，来自匹配源电阻的可用热噪声功率。在带宽 $B$ 内，该值为 $N_{\\mathrm{in}} = k_B T_0 B$，其中 $k_B$ 是玻尔兹曼常数。\n一个功率增益为 $G$、噪声因数为 $F$ 的网络，其输出端的总噪声功率是放大的输入噪声与网络自身增加的噪声之和。这可以表示为：\n$$N_{\\mathrm{out}} = G F N_{\\mathrm{in}} = G F k_B T_0 B$$\n由网络增加的噪声，折算到其自身输入端，为 $N_{\\mathrm{added,in}} = (F-1)k_B T_0 B$。\n\n该系统是两个网络的级联：\n第一级：无源衰减器，线性功率损耗为 $L$，意味着其功率增益为 $G_1 = 1/L$。其物理温度为 $T$。\n第二级：LNA，功率增益为 $G_2$，噪声因数为 $F_2$。\n\n我们将通过计算级联输出端的总噪声功率 $N_{\\mathrm{out,tot}}$ 并对其进行归一化来推导总噪声因数 $F_{\\mathrm{tot}}$。级联的总增益为 $G_{\\mathrm{tot}} = G_1 G_2$。\n\n总输出噪声功率 $N_{\\mathrm{out,tot}}$ 是三个分量的总和：\n1.  经过两级放大的源噪声。\n2.  第一级增加的噪声，经过第二级放大。\n3.  第二级增加的噪声。\n\n我们来分析每一级。\n对于第一级（衰减器），输入是源噪声 $N_{\\mathrm{in}} = k_B T_0 B$。作为一个物理温度为 $T$ 的无源元件，其自身产生的噪声功率（折算到其输出端）由涨落-耗散定理给出。一个温度为 $T$、增益为 $G_1$ 的无源两端口网络增加的噪声功率为 $N_{\\mathrm{added,1,out}} = (1-G_1)k_B T B$。由于 $G_1 = 1/L$，这变为：\n$$N_{\\mathrm{added,1,out}} = \\left(1 - \\frac{1}{L}\\right) k_B T B$$\n第一级输出端的总噪声功率 $N_{\\mathrm{out,1}}$ 是衰减后的源噪声和自生噪声之和：\n$$N_{\\mathrm{out,1}} = G_1 N_{\\mathrm{in}} + N_{\\mathrm{added,1,out}} = \\frac{1}{L} k_B T_0 B + \\left(1 - \\frac{1}{L}\\right) k_B T B$$\n\n这个噪声功率 $N_{\\mathrm{out,1}}$ 成为第二级的输入噪声。第二级增加的噪声，折算到其自身输出端，为：\n$$N_{\\mathrm{added,2,out}} = (F_2-1) G_2 k_B T_0 B$$\n\n级联输出端的总噪声功率是来自第一级的噪声经第二级放大后，与第二级增加的噪声之和：\n$$N_{\\mathrm{out,tot}} = G_2 N_{\\mathrm{out,1}} + N_{\\mathrm{added,2,out}}$$\n$$N_{\\mathrm{out,tot}} = G_2 \\left[ \\frac{1}{L} k_B T_0 B + \\left(1 - \\frac{1}{L}\\right) k_B T B \\right] + (F_2-1) G_2 k_B T_0 B$$\n\n总噪声因数 $F_{\\mathrm{tot}}$ 是相对于总增益 $G_{\\mathrm{tot}} = G_1 G_2 = (1/L) G_2$ 和标准输入噪声 $N_{\\mathrm{in}} = k_B T_0 B$ 定义的：\n$$F_{\\mathrm{tot}} = \\frac{N_{\\mathrm{out,tot}}}{G_{\\mathrm{tot}} N_{\\mathrm{in}}} = \\frac{N_{\\mathrm{out,tot}}}{\\frac{1}{L} G_2 k_B T_0 B}$$\n代入 $N_{\\mathrm{out,tot}}$ 的表达式：\n$$F_{\\mathrm{tot}} = \\frac{G_2 k_B B \\left[ \\frac{1}{L} T_0 + (1 - \\frac{1}{L}) T + (F_2-1) T_0 \\right]}{\\frac{1}{L} G_2 k_B T_0 B}$$\n项 $G_2$、$k_B$ 和 $B$ 消去。\n$$F_{\\mathrm{tot}} = L \\left[ \\frac{1}{L} \\frac{T_0}{T_0} + \\left(1 - \\frac{1}{L}\\right) \\frac{T}{T_0} + (F_2-1) \\frac{T_0}{T_0} \\right]$$\n$$F_{\\mathrm{tot}} = 1 + (L - 1)\\frac{T}{T_0} + L(F_2-1)$$\n这就是所要求的级联总噪声因数的解析表达式，显示了它对 $L$、$T/T_0$ 和 $F_2$ 的依赖关系。注意，这也等同于级联的 Friis 公式 $F_{\\mathrm{tot}} = F_1 + (F_2-1)/G_1$，其中衰减器的噪声因数为 $F_1 = 1 + (L-1)T/T_0$，其增益为 $G_1 = 1/L$。\n\n现在，我们计算给定特定情况下的总噪声系数 $NF_{\\mathrm{tot}}$：$T=T_0$，衰减器损耗为 $1\\,\\text{dB}$，以及 $NF_2 = 0.65\\,\\text{dB}$。\n首先，我们将 $T=T_0$ 代入 $F_{\\mathrm{tot}}$ 的通用表达式：\n$$F_{\\mathrm{tot}} = 1 + (L - 1)\\frac{T_0}{T_0} + L(F_2-1) = 1 + L - 1 + L(F_2-1) = L + LF_2 - L = L F_2$$\n这个简化公式 $F_{\\mathrm{tot}} = L F_2$ 专用于无源第一级处于参考温度 $T_0$ 的情况。\n\n总噪声系数 $NF_{\\mathrm{tot}}$ 是总噪声因数 $F_{\\mathrm{tot}}$ 的分贝表示：\n$$NF_{\\mathrm{tot}} = 10 \\log_{10}(F_{\\mathrm{tot}})$$\n代入 $F_{\\mathrm{tot}} = L F_2$：\n$$NF_{\\mathrm{tot}} = 10 \\log_{10}(L F_2) = 10 \\log_{10}(L) + 10 \\log_{10}(F_2)$$\n根据定义，衰减器的损耗（以分贝为单位）是 $L_{\\mathrm{dB}} = 10 \\log_{10}(L)$，LNA的噪声系数是 $NF_2 = 10 \\log_{10}(F_2)$。因此，在这种特定情况下，总噪声系数是各部分分贝值的和：\n$$NF_{\\mathrm{tot}} = L_{\\mathrm{dB}} + NF_2$$\n给定值为：\n$L_{\\mathrm{dB}} = 1\\,\\text{dB}$\n$NF_2 = 0.65\\,\\text{dB}$\n\n代入这些值：\n$$NF_{\\mathrm{tot}} = 1\\,\\text{dB} + 0.65\\,\\text{dB} = 1.65\\,\\text{dB}$$\n问题要求将答案四舍五入到四位有效数字。\n计算值为 $1.65$。为了用四位有效数字表示，我们写作 $1.650$。",
            "answer": "$$\\boxed{1.650}$$"
        },
        {
            "introduction": "最后的这项练习综合了所有核心概念：热噪声、散粒噪声和闪烁噪声。您的任务是通过组合所有贡献源，推导出一个共源放大器的总输入参考噪声 。这个练习将理论分析与电子设计自动化（EDA）工具（如 SPICE）中使用的方法联系起来，为有源电路的噪声特性分析提供了一个全面的框架。",
            "id": "4304691",
            "problem": "您的任务是形式化并验证一个简单放大器的输入参考噪声计算，该计算需与在集成电路仿真程序 (SPICE) 中执行的交流 (AC) 噪声分析保持一致。考虑一个线性时不变的共源金属氧化物半导体 (MOS) 放大器，其输出节点由单个电阻器加载。该放大器的小信号跨导为 $g_m$，漏极负载电阻为 $R_D$，并表现出由系数 $\\gamma$ 表征的固有沟道热噪声。一个偏置支路由于直流电流 $I_{\\text{bias}}$ 而产生散粒噪声，且该器件表现出闪烁噪声，其系数为 $K_f$，与频率成反比。环境温度为 $T$。从中频带输入到输出的小信号电压增益幅度为 $|A_v|$，并且该放大器在远离任何极点的情况下工作，因此频率依赖性仅由闪烁噪声引起。\n\n基本原理和假设：\n- 放大器是线性时不变的，输出节点由电阻性负载 $R_D$ 主导，因此小信号电压增益幅度为 $|A_v|$，输出端的电流-电压转换由 $R_D$ 决定。\n- 电阻热噪声由一个等效电压源建模，其单边功率谱密度 (PSD) 由下式给出：$$S_{v,R} = 4 k_{\\mathrm{B}} T R$$ 其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$R$ 是以欧姆为单位的电阻值。\n- MOS 沟道热噪声由一个漏极电流噪声源建模，其单边 PSD 为：$$S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$$ 其中 $\\gamma$ 是过剩噪声因子，$g_m$ 是跨导。\n- 散粒噪声由一个泊松过程建模，其单边电流 PSD 为：$$S_{i,\\mathrm{sh}} = 2 q I_{\\mathrm{bias}}$$ 其中 $q$ 是基本电荷，$I_{\\mathrm{bias}}$ 是引起载流子注入的直流电流。\n- 闪烁噪声 (1/f 噪声) 在此由一个漏极电流噪声源建模，其单边 PSD 为：$$S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$$ 其中 $K_f$ 是一个与器件相关的系数，$f$ 是以赫兹为单位的频率。\n\n您的目标：\n1. 表达如何通过适当组合上述独立噪声源来计算放大器输出端的输出参考电压噪声 PSD，假设电流噪声源通过负载电阻转换为输出电压噪声。\n2. 根据输出参考电压噪声 PSD 和小信号增益幅度 $|A_v|$，推导出输入参考电压噪声 PSD 及其谱密度的平方根 (电压噪声密度)。\n3. 提供一个算法，用于在给定参数 $(g_m, R_D, \\gamma, T, I_{\\mathrm{bias}}, K_f)$ 的情况下，数值计算指定频率 $f$ 处的输入参考电压噪声密度。\n4. 通过为以下测试套件计算数值结果，来与手动计算进行对比验证。对于每种情况，计算输入参考电压噪声密度，并将最终数值答案以纳伏每根号赫兹 (nV/$\\sqrt{\\mathrm{Hz}}$) 表示，四舍五入到六位小数。\n\n在所有计算中使用以下常量：\n- 玻尔兹曼常数：$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n- 基本电荷：$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n\n测试套件 (每个元组为 $(g_m\\ \\mathrm{[S]}, R_D\\ \\mathrm{[\\Omega]}, \\gamma, T\\ \\mathrm{[K]}, I_{\\mathrm{bias}}\\ \\mathrm{[A]}, K_f\\ \\mathrm{[A^2]}, f\\ \\mathrm{[Hz]})$)：\n- 情况 1 (平衡中频带，非零散粒噪声)：$(5.0\\times 10^{-3}, 2000, 0.7, 300, 100.0\\times 10^{-6}, 1.0\\times 10^{-22}, 10.0\\times 10^{3})$。\n- 情况 2 (低频，闪烁噪声主导)：$(5.0\\times 10^{-3}, 2000, 0.7, 300, 0.0, 1.0\\times 10^{-18}, 1.0)$。\n- 情况 3 (高频，闪烁噪声可忽略，零散粒噪声)：$(5.0\\times 10^{-3}, 2000, 0.7, 300, 0.0, 1.0\\times 10^{-22}, 100.0\\times 10^{6})$。\n- 情况 4 (电阻主导边缘，小负载，零散粒和闪烁噪声)：$(5.0\\times 10^{-3}, 500, 0.7, 300, 0.0, 0.0, 10.0\\times 10^{3})$。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含四个情况下的输入参考电压噪声密度，格式为方括号内以逗号分隔的列表，单位为 nV/$\\sqrt{\\mathrm{Hz}}$，每个值四舍五入到六位小数 (例如，$$[x_1,x_2,x_3,x_4]$$，其中每个 $x_i$ 是一个浮点数)。",
            "solution": "首先，将对所述问题进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n问题为共源 MOS 放大器提供了以下数据、定义和条件：\n- 小信号跨导：$g_m$\n- 漏极负载电阻：$R_D$\n- MOS 沟道热噪声系数：$\\gamma$\n- 环境温度：$T$\n- 偏置支路直流电流：$I_{\\text{bias}}$\n- 闪烁噪声系数：$K_f$\n- 小信号电压增益幅度：$|A_v|$\n- 目标频率：$f$\n- 玻尔兹曼常数：$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n- 基本电荷：$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n\n噪声源的单边功率谱密度 (PSD) 定义如下：\n- 电阻热噪声 (电压)：$S_{v,R} = 4 k_{\\mathrm{B}} T R$\n- MOS 沟道热噪声 (电流)：$S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$\n- 散粒噪声 (电流)：$S_{i,\\mathrm{sh}} = 2 q I_{\\mathrm{bias}}$\n- 闪烁噪声 (电流)：$S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$\n\n$(g_m, R_D, \\gamma, T, I_{\\mathrm{bias}}, K_f, f)$ 的测试套件参数为：\n- 情况 1：$(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 100.0\\times 10^{-6}\\ \\mathrm{A}, 1.0\\times 10^{-22}\\ \\mathrm{A^2}, 10.0\\times 10^{3}\\ \\mathrm{Hz})$\n- 情况 2：$(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 1.0\\times 10^{-18}\\ \\mathrm{A^2}, 1.0\\ \\mathrm{Hz})$\n- 情况 3：$(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 1.0\\times 10^{-22}\\ \\mathrm{A^2}, 100.0\\times 10^{6}\\ \\mathrm{Hz})$\n- 情况 4：$(5.0\\times 10^{-3}\\ \\mathrm{S}, 500\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 0.0\\ \\mathrm{A^2}, 10.0\\times 10^{3}\\ \\mathrm{Hz})$\n\n### 第 2 步：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n- **科学依据**：该问题基于半导体器件中热噪声、散粒噪声和闪烁噪声的标准、普遍接受的模型。所提供的功率谱密度公式是正确的，并构成了 SPICE 等工具中噪声分析的基础。\n- **问题定义良好**：该问题定义良好。它提供了计算每个测试用例唯一数值答案所需的所有必要参数和物理常数。提到了小信号增益 $|A_v|$，其对于带电阻负载 $R_D$ 的共源放大器的值，在上下文中被隐含定义为 $|A_v| = g_m R_D$。这是一种标准简化，与问题陈述中“输出端的电流-电压转换由 $R_D$ 决定”的说法一致。\n- **客观性**：该问题以精确、客观且明确的科学语言陈述。\n- **完整性与一致性**：该问题是自洽的，没有矛盾。给定的参数和定义足以得出一个完整的解。\n- **真实性**：测试套件中的数值对于各种工作条件下的 MOS 晶体管而言是物理上现实的。\n- **结论**：该问题没有任何使其无效的缺陷。\n\n### 第 3 步：结论和行动\n该问题是 **有效的**。将提供一个完整的、有理有据的解决方案。\n\n### 解答推导\n\n放大器的总输入参考噪声是通过计算每个噪声源在输出端的贡献，然后将此总输出噪声折算回输入端来确定的。我们假设所有噪声源在统计上是独立的 (不相关的)，因此它们的功率谱密度可以相加。\n\n**1. 输出参考电压噪声功率谱密度 ($S_{v, \\text{out}}(f)$)**\n\n输出端的总电压噪声 PSD，$S_{v, \\text{out}}(f)$，是来自每个噪声源的 PSD 的线性总和。\n\n- **负载电阻热噪声**：输出端的电阻 $R_D$ 直接贡献电压噪声。其 PSD 如下：\n$$ S_{v, R_D}(f) = 4 k_{\\mathrm{B}} T R_D $$\n- **MOS 沟道热噪声**：MOS 晶体管的沟道热噪声被建模为一个电流源，其 PSD 为 $S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$。这个噪声电流流过输出电阻 $R_D$，产生输出电压噪声。产生的电压 PSD 是：\n$$ S_{v, \\text{out, th}}(f) = S_{i,\\mathrm{th}} \\cdot R_D^2 = (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 $$\n- **散粒噪声**：偏置电流 $I_{\\text{bias}}$ 贡献散粒噪声，建模为一个电流源，其 PSD 为 $S_{i,\\mathrm{sh}} = 2 q I_{\\text{bias}}$。这个噪声电流也流过 $R_D$，在输出端贡献一个电压 PSD：\n$$ S_{v, \\text{out, sh}}(f) = S_{i,\\mathrm{sh}} \\cdot R_D^2 = (2 q I_{\\text{bias}}) R_D^2 $$\n- **闪烁噪声**：晶体管的闪烁噪声是一个频率相关的电流源，其 PSD 为 $S_{i,\\mathrm{f}}(f) = K_f/f$。它对输出电压 PSD 的贡献是：\n$$ S_{v, \\text{out, f}}(f) = S_{i,\\mathrm{f}}(f) \\cdot R_D^2 = \\frac{K_f}{f} R_D^2 $$\n\n总输出参考电压噪声 PSD 是这些分量的总和：\n$$ S_{v, \\text{out}}(f) = S_{v, R_D}(f) + S_{v, \\text{out, th}}(f) + S_{v, \\text{out, sh}}(f) + S_{v, \\text{out, f}}(f) $$\n$$ S_{v, \\text{out}}(f) = 4 k_{\\mathrm{B}} T R_D + (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2 $$\n\n**2. 输入参考电压噪声功率谱密度 ($S_{v, \\text{in}}(f)$)**\n\n为了将总输出噪声 PSD 折算到输入端，我们将其除以放大器小信号电压增益幅度 $|A_v|$ 的平方。对于一个带有负载电阻 $R_D$ 且晶体管输出电阻可忽略的共源放大器，增益由 $|A_v| = g_m R_D$ 给出。因此，$|A_v|^2 = (g_m R_D)^2 = g_m^2 R_D^2$。\n\n输入参考电压噪声 PSD，$S_{v, \\text{in}}(f)$，为：\n$$ S_{v, \\text{in}}(f) = \\frac{S_{v, \\text{out}}(f)}{|A_v|^2} = \\frac{4 k_{\\mathrm{B}} T R_D + (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2}{g_m^2 R_D^2} $$\n将分子中的每一项除以分母 $g_m^2 R_D^2$ 得到各个输入参考贡献：\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_{\\mathrm{B}} T R_D}{g_m^2 R_D^2} + \\frac{4 k_{\\mathrm{B}} T \\gamma g_m R_D^2}{g_m^2 R_D^2} + \\frac{2 q I_{\\text{bias}} R_D^2}{g_m^2 R_D^2} + \\frac{K_f R_D^2}{f \\cdot g_m^2 R_D^2} $$\n简化此表达式可得到总输入参考电压噪声 PSD 的最终公式：\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_{\\mathrm{B}} T \\gamma}{g_m} + \\frac{4 k_{\\mathrm{B}} T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2} $$\n这些项分别对应于：沟道热噪声、负载电阻热噪声、散粒噪声和闪烁噪声的输入参考噪声。\n\n**3. 输入参考电压噪声密度 ($v_{n, \\text{in}}(f)$)**\n\n输入参考电压噪声密度，通常以 $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$ 为单位表示，是 PSD 的平方根：\n$$ v_{n, \\text{in}}(f) = \\sqrt{S_{v, \\text{in}}(f)} = \\sqrt{\\frac{4 k_{\\mathrm{B}} T \\gamma}{g_m} + \\frac{4 k_{\\mathrm{B}} T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2}} $$\n\n这个最终表达式提供了一个用于计算所需值的完整算法。以下程序实现了这个公式，以计算所提供测试套件的数值结果。最终答案通过将以 $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$ 为单位的结果乘以 $10^9$ 转换为纳伏每根号赫兹 ($\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the noise analysis problem for the given test cases.\n    \"\"\"\n\n    # Define physical constants as specified in the problem.\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    Q = 1.602176634e-19  # Elementary charge in C\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (gm [S], RD [Ohm], gamma, T [K], Ibias [A], Kf [A^2], f [Hz])\n    test_cases = [\n        (5.0e-3, 2000, 0.7, 300, 100.0e-6, 1.0e-22, 10.0e3),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-18, 1.0),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-22, 100.0e6),\n        (5.0e-3, 500, 0.7, 300, 0.0, 0.0, 10.0e3),\n    ]\n\n    def calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq):\n        \"\"\"\n        Computes the input-referred voltage noise density.\n\n        The total input-referred voltage noise Power Spectral Density (PSD) is the\n        sum of the individual contributions from each noise source:\n        S_v_in(f) = S_channel_th + S_load_th + S_shot + S_flicker\n\n        where:\n        S_channel_th = (4 * KB * T * gamma) / gm\n        S_load_th    = (4 * KB * T) / (gm^2 * rd)\n        S_shot       = (2 * Q * ibias) / gm^2\n        S_flicker    = Kf / (f * gm^2)\n        \n        The noise density is the square root of the total PSD.\n        \"\"\"\n        gm_sq = gm**2\n        four_kb_t = 4 * KB * temp\n\n        # Calculate each component of the input-referred noise PSD\n        s_channel_th = (four_kb_t * gamma) / gm\n        s_load_th = four_kb_t / (gm_sq * rd)\n        s_shot = (2 * Q * ibias) / gm_sq\n        s_flicker = kf / (freq * gm_sq)\n        \n        # Total input-referred voltage noise PSD (V^2/Hz)\n        s_v_in_total = s_channel_th + s_load_th + s_shot + s_flicker\n\n        # Input-referred voltage noise density (V/sqrt(Hz))\n        v_n_in = np.sqrt(s_v_in_total)\n\n        # Convert to nV/sqrt(Hz)\n        v_n_in_nanovolts = v_n_in * 1e9\n\n        return v_n_in_nanovolts\n\n    results = []\n    for case in test_cases:\n        gm, rd, gamma, temp, ibias, kf, freq = case\n        result = calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}