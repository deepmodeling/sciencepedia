{
    "hands_on_practices": [
        {
            "introduction": "在尝试优化一个系统之前，我们必须首先精确地定义优化的目标。在系统划分中，这表现为选择一个能够量化划分质量的目标函数。这个练习将引导你计算和比较两种主流的超图划分目标函数：经典的“割网”模型和更细致的“连通性”模型 ()。通过亲手计算，你将体会到不同目标函数如何评估同一个划分方案，并理解这种选择对算法行为和最终划分结果的深远影响。",
            "id": "4303677",
            "problem": "考虑在电子设计自动化（EDA）中用于系统划分的超图模型。超图定义为 $H=(V,E)$，其中 $V$ 是顶点（单元或模块）集，$E$ 是超边（网络）集，每个网络 $e \\in E$ 连接一个顶点子集，并被赋予一个正常数代价 $c(e) \\in \\mathbb{R}_{>0}$。一个 $k$ 路划分是一个分配 $\\pi: V \\to \\{1,2,\\dots,k\\}$，它将每个顶点映射到 $k$ 个块中的一个。对于一个网络 $e$，定义其块跨度基数 $\\lambda(e)$ 为在划分 $\\pi$ 下，$e$ 所连接的不同块的数量。超图划分中有两个公认的目标函数：\n- 切割网络目标，计算所有被划分所切割的网络的代价之和，定义为\n$$\n\\Phi_{\\mathrm{cut}}(\\pi) \\triangleq \\sum_{e \\in E} c(e) \\cdot \\mathbf{1}\\{\\lambda(e) > 1\\},\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 连通性目标，计算每个网络超出单个块的额外连通性加权的代价之和，定义为\n$$\n\\Phi_{\\mathrm{conn}}(\\pi) \\triangleq \\sum_{e \\in E} c(e) \\cdot \\big(\\lambda(e) - 1\\big).\n$$\n\n设超图 $H=(V,E)$ 的顶点集为 $V=\\{v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_{10}\\}$，并具有以下带代价的网络：\n- $e_1=\\{v_1,v_2,v_3\\}$，代价为 $c(e_1)=2$，\n- $e_2=\\{v_2,v_4\\}$，代价为 $c(e_2)=1$，\n- $e_3=\\{v_3,v_5,v_6\\}$，代价为 $c(e_3)=3$，\n- $e_4=\\{v_1,v_4,v_7,v_8\\}$，代价为 $c(e_4)=4$，\n- $e_5=\\{v_5,v_7,v_9\\}$，代价为 $c(e_5)=2$，\n- $e_6=\\{v_6,v_8,v_{10}\\}$，代价为 $c(e_6)=5$，\n- $e_7=\\{v_9,v_{10}\\}$，代价为 $c(e_7)=1$。\n\n考虑一个 $k=3$ 个块的 $k$ 路划分，其分配为\n$$\n\\pi(v_1)=1,\\ \\pi(v_2)=2,\\ \\pi(v_3)=3,\\ \\pi(v_4)=3,\\ \\pi(v_5)=1,\\ \\pi(v_6)=2,\\ \\pi(v_7)=3,\\ \\pi(v_8)=3,\\ \\pi(v_9)=1,\\ \\pi(v_{10})=2.\n$$\n\n根据上述定义，计算此划分的切割网络目标 $\\Phi_{\\mathrm{cut}}(\\pi)$ 和连通性目标 $\\Phi_{\\mathrm{conn}}(\\pi)$，并确定对于这个特定的超图和分配，哪个目标函数值更大。将你的最终答案表示为有序数值对 $\\big(\\Phi_{\\mathrm{cut}}(\\pi),\\ \\Phi_{\\mathrm{conn}}(\\pi)\\big)$，不带单位。无需四舍五入；请提供精确值。",
            "solution": "该问题提法明确，具有科学依据，并为完整解答提供了所有必要信息。它是电子设计自动化领域的标准定义在一个给定具体实例上的直接应用。\n\n目标是计算给定超图 $H=(V,E)$ 的一个 $3$路划分 $\\pi$ 的两个度量：切割网络目标 $\\Phi_{\\mathrm{cut}}(\\pi)$ 和连通性目标 $\\Phi_{\\mathrm{conn}}(\\pi)$。\n\n首先，我们根据给定的分配 $\\pi: V \\to \\{1,2,3\\}$ 将顶点集 $V$ 划分成三个块 $B_1$、$B_2$ 和 $B_3$。\n- 块1中的顶点：$B_1 = \\{v \\in V \\mid \\pi(v)=1\\} = \\{v_1, v_5, v_9\\}$\n- 块2中的顶点：$B_2 = \\{v \\in V \\mid \\pi(v)=2\\} = \\{v_2, v_6, v_{10}\\}$\n- 块3中的顶点：$B_3 = \\{v \\in V \\mid \\pi(v)=3\\} = \\{v_3, v_4, v_7, v_8\\}$\n\n接下来，对于每个超边（网络）$e \\in E$，我们必须确定其块跨度基数 $\\lambda(e)$，即其顶点被分配到的不同块的数量。然后我们使用这个值来计算每个网络对两个目标函数的贡献。\n\n让我们分析每个网络：\n\n1.  **网络 $e_1=\\{v_1,v_2,v_3\\}$，代价 $c(e_1)=2$：**\n    这些顶点被分配到块：$\\pi(v_1)=1$，$\\pi(v_2)=2$，$\\pi(v_3)=3$。\n    触及的块集合是 $\\{1, 2, 3\\}$。\n    块跨度基数为 $\\lambda(e_1) = 3$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_1) \\cdot \\mathbf{1}\\{\\lambda(e_1) > 1\\} = 2 \\cdot \\mathbf{1}\\{3 > 1\\} = 2 \\cdot 1 = 2$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_1) \\cdot (\\lambda(e_1) - 1) = 2 \\cdot (3 - 1) = 2 \\cdot 2 = 4$。\n\n2.  **网络 $e_2=\\{v_2,v_4\\}$，代价 $c(e_2)=1$：**\n    这些顶点被分配到块：$\\pi(v_2)=2$，$\\pi(v_4)=3$。\n    触及的块集合是 $\\{2, 3\\}$。\n    块跨度基数为 $\\lambda(e_2) = 2$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_2) \\cdot \\mathbf{1}\\{\\lambda(e_2) > 1\\} = 1 \\cdot \\mathbf{1}\\{2 > 1\\} = 1 \\cdot 1 = 1$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_2) \\cdot (\\lambda(e_2) - 1) = 1 \\cdot (2 - 1) = 1 \\cdot 1 = 1$。\n\n3.  **网络 $e_3=\\{v_3,v_5,v_6\\}$，代价 $c(e_3)=3$：**\n    这些顶点被分配到块：$\\pi(v_3)=3$，$\\pi(v_5)=1$，$\\pi(v_6)=2$。\n    触及的块集合是 $\\{1, 2, 3\\}$。\n    块跨度基数为 $\\lambda(e_3) = 3$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_3) \\cdot \\mathbf{1}\\{\\lambda(e_3) > 1\\} = 3 \\cdot \\mathbf{1}\\{3 > 1\\} = 3 \\cdot 1 = 3$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_3) \\cdot (\\lambda(e_3) - 1) = 3 \\cdot (3 - 1) = 3 \\cdot 2 = 6$。\n\n4.  **网络 $e_4=\\{v_1,v_4,v_7,v_8\\}$，代价 $c(e_4)=4$：**\n    这些顶点被分配到块：$\\pi(v_1)=1$，$\\pi(v_4)=3$，$\\pi(v_7)=3$，$\\pi(v_8)=3$。\n    触及的块集合是 $\\{1, 3\\}$。\n    块跨度基数为 $\\lambda(e_4) = 2$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_4) \\cdot \\mathbf{1}\\{\\lambda(e_4) > 1\\} = 4 \\cdot \\mathbf{1}\\{2 > 1\\} = 4 \\cdot 1 = 4$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_4) \\cdot (\\lambda(e_4) - 1) = 4 \\cdot (2 - 1) = 4 \\cdot 1 = 4$。\n\n5.  **网络 $e_5=\\{v_5,v_7,v_9\\}$，代价 $c(e_5)=2$：**\n    这些顶点被分配到块：$\\pi(v_5)=1$，$\\pi(v_7)=3$，$\\pi(v_9)=1$。\n    触及的块集合是 $\\{1, 3\\}$。\n    块跨度基数为 $\\lambda(e_5) = 2$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_5) \\cdot \\mathbf{1}\\{\\lambda(e_5) > 1\\} = 2 \\cdot \\mathbf{1}\\{2 > 1\\} = 2 \\cdot 1 = 2$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_5) \\cdot (\\lambda(e_5) - 1) = 2 \\cdot (2 - 1) = 2 \\cdot 1 = 2$。\n\n6.  **网络 $e_6=\\{v_6,v_8,v_{10}\\}$，代价 $c(e_6)=5$：**\n    这些顶点被分配到块：$\\pi(v_6)=2$，$\\pi(v_8)=3$，$\\pi(v_{10})=2$。\n    触及的块集合是 $\\{2, 3\\}$。\n    块跨度基数为 $\\lambda(e_6) = 2$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_6) \\cdot \\mathbf{1}\\{\\lambda(e_6) > 1\\} = 5 \\cdot \\mathbf{1}\\{2 > 1\\} = 5 \\cdot 1 = 5$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_6) \\cdot (\\lambda(e_6) - 1) = 5 \\cdot (2 - 1) = 5 \\cdot 1 = 5$。\n\n7.  **网络 $e_7=\\{v_9,v_{10}\\}$，代价 $c(e_7)=1$：**\n    这些顶点被分配到块：$\\pi(v_9)=1$，$\\pi(v_{10})=2$。\n    触及的块集合是 $\\{1, 2\\}$。\n    块跨度基数为 $\\lambda(e_7) = 2$。\n    对 $\\Phi_{\\mathrm{cut}}$ 的贡献：$c(e_7) \\cdot \\mathbf{1}\\{\\lambda(e_7) > 1\\} = 1 \\cdot \\mathbf{1}\\{2 > 1\\} = 1 \\cdot 1 = 1$。\n    对 $\\Phi_{\\mathrm{conn}}$ 的贡献：$c(e_7) \\cdot (\\lambda(e_7) - 1) = 1 \\cdot (2 - 1) = 1 \\cdot 1 = 1$。\n\n现在，我们将各个贡献相加，以求得每个目标函数的总值。\n\n对于切割网络目标 $\\Phi_{\\mathrm{cut}}(\\pi)$：\n$$\n\\Phi_{\\mathrm{cut}}(\\pi) = \\sum_{e \\in E} c(e) \\cdot \\mathbf{1}\\{\\lambda(e) > 1\\} = 2 + 1 + 3 + 4 + 2 + 5 + 1 = 18.\n$$\n\n对于连通性目标 $\\Phi_{\\mathrm{conn}}(\\pi)$：\n$$\n\\Phi_{\\mathrm{conn}}(\\pi) = \\sum_{e \\in E} c(e) \\cdot (\\lambda(e) - 1) = 4 + 1 + 6 + 4 + 2 + 5 + 1 = 23.\n$$\n\n我们计算得出 $\\Phi_{\\mathrm{cut}}(\\pi) = 18$ 和 $\\Phi_{\\mathrm{conn}}(\\pi) = 23$。比较这些值，我们发现对于这个特定的超图和划分，$\\Phi_{\\mathrm{conn}}(\\pi) > \\Phi_{\\mathrm{cut}}(\\pi)$。最终结果是这些值的有序对。",
            "answer": "$$\n\\boxed{(18, 23)}\n$$"
        },
        {
            "introduction": "Fiduccia-Mattheyses (FM) 算法是迭代改进思想的经典实现，也是现代电子设计自动化（EDA）划分工具的基石。这个练习 () 要求你完整地模拟一轮 FM 算法的执行过程，它将考验你对“增益”计算、平衡约束处理以及增益增量更新这些核心机制的理解。完成这个练习能帮助你建立对局部搜索启发式算法工作原理的直观而深刻的认识。",
            "id": "4303636",
            "problem": "考虑一个模拟电子设计自动化（EDA）中网表划分的双向超图划分实例。设超图为 $H = (V, \\mathcal{E})$，其顶点集为 $V = \\{v_1, v_2, v_3, v_4, v_5, v_6\\}$，顶点权重为 $\\omega(v_1) = 2, \\omega(v_2) = 1, \\omega(v_3) = 2, \\omega(v_4) = 1, \\omega(v_5) = 1, \\omega(v_6) = 2$，超边集为 $\\mathcal{E} = \\{e_1, e_2, e_3, e_4\\}$，超边权重为 $w(e_1) = 2, w(e_2) = 1, w(e_3) = 3, w(e_4) = 2$。每个超边的引脚指定如下：$e_1 = \\{v_1, v_3, v_5\\}, e_2 = \\{v_1, v_2, v_3\\}, e_3 = \\{v_2, v_4, v_5\\}, e_4 = \\{v_3, v_6\\}$。初始的双向划分为 $\\mathcal{P}_0 = (A, B)$，其中 $A = \\{v_1, v_2, v_4\\}$，$B = \\{v_3, v_5, v_6\\}$。\n\n采用网表切割目标：对于一个划分 $(A,B)$，切割成本 $C(A,B)$ 是所有在 $A$ 和 $B$ 中都至少有一个引脚的超边 $e \\in \\mathcal{E}$ 的权重 $w(e)$ 的总和。Fiduccia–Mattheyses (FM) 算法的单轮执行过程如下：为每个顶点 $v \\in V$ 计算初始增益 $g(v)$，即如果 $v$ 被移动到另一个块中，$C(A,B)$ 的净减少量；每次选择并移动一个具有最高增益且不违反平衡约束的未锁定顶点；锁定每个已移动的顶点；增量更新相邻未锁定顶点的增益；继续此过程，直到没有合法移动或所有顶点都被锁定；然后选择具有最大累积增益的移动序列前缀，并将该前缀应用于 $\\mathcal{P}_0$ 以产生本轮的结果。\n\n施加标准的权重平衡约束：设 $\\Omega = \\sum_{v \\in V} \\omega(v)$，目标块权重为 $\\Omega/2$。在本轮执行期间，两个块的权重必须始终保持在区间 $\\left[\\frac{\\Omega}{2} - \\epsilon, \\frac{\\Omega}{2} + \\epsilon\\right]$ 内，容差 $\\epsilon = 1$。使用平局打破规则：在具有相同增益的多个顶点中，选择索引最小的顶点。\n\n从 $\\mathcal{P}_0$ 开始，执行一轮如上所述的 FM 算法，严格执行平衡约束，并报告通过应用本轮中最佳增益前缀获得的划分的最终网表切割成本 $C$。请用一个实数值作答，无需四舍五入。",
            "solution": "用户希望在一给定的超图上，经过一轮 Fiduccia-Mattheyses (FM) 算法后，找出最终的网表切割成本。我将首先验证问题陈述，然后逐步执行该算法。\n\n### 问题验证\n\n**第 1 步：提取给定信息**\n- 超图：$H = (V, \\mathcal{E})$\n- 顶点集：$V = \\{v_1, v_2, v_3, v_4, v_5, v_6\\}$\n- 顶点权重：$\\omega(v_1) = 2$, $\\omega(v_2) = 1$, $\\omega(v_3) = 2$, $\\omega(v_4) = 1$, $\\omega(v_5) = 1$, $\\omega(v_6) = 2$。\n- 超边集：$\\mathcal{E} = \\{e_1, e_2, e_3, e_4\\}$\n- 超边权重：$w(e_1) = 2$, $w(e_2) = 1$, $w(e_3) = 3$, $w(e_4) = 2$。\n- 超边连接（引脚）：\n    - $e_1 = \\{v_1, v_3, v_5\\}$\n    - $e_2 = \\{v_1, v_2, v_3\\}$\n    - $e_3 = \\{v_2, v_4, v_5\\}$\n    - $e_4 = \\{v_3, v_6\\}$\n- 初始划分：$\\mathcal{P}_0 = (A, B)$，其中 $A = \\{v_1, v_2, v_4\\}$，$B = \\{v_3, v_5, v_6\\}$。\n- 目标函数：网表切割成本，$C(A,B) = \\sum_{e \\in \\mathcal{E}, |e \\cap A| > 0 \\land |e \\cap B| > 0} w(e)$。\n- 平衡约束：\n    - 总顶点权重 $\\Omega = \\sum_{v \\in V} \\omega(v)$。\n    - 容差 $\\epsilon = 1$。\n    - 任何块 $X$ 的权重 $W(X)$ 必须满足 $W(X) \\in \\left[\\frac{\\Omega}{2} - \\epsilon, \\frac{\\Omega}{2} + \\epsilon\\right]$。\n- 算法：单轮 FM。\n- 平局打破规则：选择索引最小的顶点。\n\n**第 2 步：使用提取的给定信息进行验证**\n该问题描述了 Fiduccia-Mattheyses 算法的一个标准应用，这是电子设计自动化（EDA）领域中用于 VLSI 电路划分的一种成熟的启发式方法。\n- **科学依据**：该问题基于图论和组合优化中已确立的概念，特别是超图划分和 FM 算法。它在科学上是合理的。\n- **问题明确**：问题得到了充分的说明。它提供了超图结构、所有必要的权重、初始状态（划分）、明确的目标函数以及算法执行的精确规则，包括平衡约束和平局打破规则。这确保了一个唯一的、确定性的操作序列。\n- **目标**：语言精确且数学化，没有任何主观或模棱两可的术语。\n- 设置完整且一致。\n\n**第 3 步：结论与行动**\n问题有效。我将继续进行解答。\n\n### 解答\n\n**1. 初始状态分析**\n\n首先，我们计算平衡约束的参数。\n总顶点权重为：\n$$ \\Omega = \\sum_{i=1}^{6} \\omega(v_i) = \\omega(v_1) + \\omega(v_2) + \\omega(v_3) + \\omega(v_4) + \\omega(v_5) + \\omega(v_6) = 2+1+2+1+1+2 = 9 $$\n目标块权重为 $\\frac{\\Omega}{2} = 4.5$。容差 $\\epsilon = 1$，因此每个块允许的权重在区间内：\n$$ \\left[ \\frac{\\Omega}{2} - \\epsilon, \\frac{\\Omega}{2} + \\epsilon \\right] = [4.5 - 1, 4.5 + 1] = [3.5, 5.5] $$\n接下来，我们检查初始划分 $\\mathcal{P}_0 = (A, B)$，其中 $A = \\{v_1, v_2, v_4\\}$，$B = \\{v_3, v_5, v_6\\}$。\n初始块权重为：\n$$ W(A) = \\omega(v_1) + \\omega(v_2) + \\omega(v_4) = 2 + 1 + 1 = 4 $$\n$$ W(B) = \\omega(v_3) + \\omega(v_5) + \\omega(v_6) = 2 + 1 + 2 = 5 $$\n由于 $W(A)=4$ 和 $W(B)=5$ 都在允许的范围 $[3.5, 5.5]$ 内，初始划分是平衡的。\n\n现在，我们计算初始的网表切割成本 $C(\\mathcal{P}_0)$。\n- $e_1 = \\{v_1, v_3, v_5\\}$: $v_1 \\in A$；$v_3, v_5 \\in B$。此超边被切割。\n- $e_2 = \\{v_1, v_2, v_3\\}$: $v_1, v_2 \\in A$；$v_3 \\in B$。此超边被切割。\n- $e_3 = \\{v_2, v_4, v_5\\}$: $v_2, v_4 \\in A$；$v_5 \\in B$。此超边被切割。\n- $e_4 = \\{v_3, v_6\\}$: $v_3, v_6 \\in B$。此超边未被切割。\n初始切割成本是被切割超边的权重之和：\n$$ C(\\mathcal{P}_0) = w(e_1) + w(e_2) + w(e_3) = 2 + 1 + 3 = 6 $$\n\n**2. 初始增益计算**\n\n顶点 $v$ 的增益 $g(v)$ 是如果 $v$ 被移动，成本的减少量。对于从块 $X$ 移动到块 $Y$ 的顶点 $v$，增益为 $g(v) = FS(v) - TE(v)$，其中 $FS(v)$ 是变为未切割的超边的权重总和，而 $TE(v)$ 是变为切割的超边的权重总和。\n包含 $v$ 的超边 $e$ 在 $v$ 是 $e$ 在块 $X$ 中的唯一引脚时，移动后会变为未切割。包含 $v$ 的超边 $e$ 在 $e$ 的所有其他引脚都在块 $X$ 中时，移动后会变为切割。设 $n_e(X)$ 是超边 $e$ 在块 $X$ 中的引脚数。\n初始引脚分布：$n_{e_1}(A)=1, n_{e_1}(B)=2$；$n_{e_2}(A)=2, n_{e_2}(B)=1$；$n_{e_3}(A)=2, n_{e_3}(B)=1$；$n_{e_4}(A)=0, n_{e_4}(B)=2$。\n- $g(v_1)$: $v_1 \\in A$。超边 $e_1$ 有 $n_{e_1}(A)=1$，所以移动 $v_1$ 会使 $e_1$ 未切割。$FS(v_1) = w(e_1) = 2$。没有超边变为切割。$TE(v_1) = 0$。增益 $g(v_1) = 2$。\n- $g(v_2)$: $v_2 \\in A$。其超边 $e_2$ 和 $e_3$ 有 $n_{e_2}(A)=2$ 和 $n_{e_3}(A)=2$。$FS(v_2) = 0, TE(v_2)=0$。增益 $g(v_2) = 0$。\n- $g(v_3)$: $v_3 \\in B$。超边 $e_2$ 有 $n_{e_2}(B)=1$。$FS(v_3) = w(e_2) = 1$。超边 $e_4$ 有 $n_{e_4}(A)=0$，所以移动 $v_3$ 会使 $e_4$ 被切割。$TE(v_3) = w(e_4)=2$。增益 $g(v_3) = 1 - 2 = -1$。\n- $g(v_4)$: $v_4 \\in A$。其超边 $e_3$ 有 $n_{e_3}(A)=2$。$FS(v_4)=0, TE(v_4)=0$。增益 $g(v_4) = 0$。\n- $g(v_5)$: $v_5 \\in B$。超边 $e_3$ 有 $n_{e_3}(B)=1$。$FS(v_5) = w(e_3) = 3$。没有超边变为切割。$TE(v_5) = 0$。增益 $g(v_5) = 3$。\n- $g(v_6)$: $v_6 \\in B$。超边 $e_4$ 有 $n_{e_4}(A)=0$。移动 $v_6$ 会使其被切割。$TE(v_6)=w(e_4)=2$。$FS(v_6)=0$。增益 $g(v_6) = 0 - 2 = -2$。\n\n初始增益：$g(v_1)=2, g(v_2)=0, g(v_3)=-1, g(v_4)=0, g(v_5)=3, g(v_6)=-2$。\n\n**3. FM 轮执行**\n\n我们构建一个移动序列，并跟踪累积增益。所有顶点初始时都未锁定。\n\n**移动 1:**\n- **选择**：增益最高的顶点是 $v_5$，其 $g(v_5)=3$。\n- **平衡检查**：$v_5 \\in B$，权重为 $\\omega(v_5)=1$。如果移动到 $A$，新的权重将是 $W(A') = W(A) + \\omega(v_5) = 4+1=5$ 和 $W(B')=W(B) - \\omega(v_5)=5-1=4$。$4$ 和 $5$ 都在 $[3.5, 5.5]$ 范围内，所以移动是合法的。\n- **行动**：将 $v_5$ 从 $B$ 移动到 $A$。锁定 $v_5$。\n- **状态更新**：移动增益 $G_1=3$。累积增益 $= 3$。新的划分为 $A_1 = \\{v_1, v_2, v_4, v_5\\}, B_1 = \\{v_3, v_6\\}$。\n- **增益更新**：移动 $v_5$ 会影响其在超边 $e_1$ 和 $e_3$ 中的邻居的增益。\n    - 超边 $e_1$ ($n_{e_1}(A)=1, n_{e_1}(B)=2 \\to n'_{e_1}(A)=2, n'_{e_1}(B)=1$):\n        - $g(v_1)$ 减少 $w(e_1)=2$ (因为 $v_1$ 不再是 $e_1$ 在 $A$ 中的唯一引脚)。$g(v_1) \\to 2-2=0$。\n        - $g(v_3)$ 增加 $w(e_1)=2$ (因为 $v_3$ 成为 $e_1$ 在 $B$ 中的唯一引脚)。$g(v_3) \\to -1+2=1$。\n    - 超边 $e_3$ ($n_{e_3}(A)=2, n_{e_3}(B)=1 \\to n'_{e_3}(A)=3, n'_{e_3}(B)=0$):\n        - $e_3$ 变为未切割。对于其在 $A$ 中的邻居 $v_2, v_4$，现在移动它们会使 $e_3$ 被切割。它们的增益减少 $w(e_3)=3$。\n        - $g(v_2) \\to 0-3=-3$。\n        - $g(v_4) \\to 0-3=-3$。\n- 下一步的增益（未锁定的顶点 $\\{v_1, v_2, v_3, v_4, v_6\\}$）：$g(v_1)=0, g(v_2)=-3, g(v_3)=1, g(v_4)=-3, g(v_6)=-2$。\n\n**移动 2:**\n- **选择**：在未锁定的顶点中，$v_3$ 具有最高的增益 $g(v_3)=1$。\n- **平衡检查**：$v_3 \\in B_1$，权重为 $\\omega(v_3)=2$。当前权重为 $W(A_1)=5, W(B_1)=4$。将 $v_3$ 移动到 $A$ 将得到 $W(A') = 5+2=7$，这超出了 $[3.5, 5.5]$ 的范围。移动不合法。\n- **下一个候选**：次高的增益是 $g(v_1)=0$。$v_1 \\in A_1$，$\\omega(v_1)=2$。移动到 $B$ 得到 $W(A') = 5-2=3$，超出了 $[3.5, 5.5]$ 的范围。不合法。\n- **下一个候选**：次高的增益是 $g(v_6)=-2$。$v_6 \\in B_1$，$\\omega(v_6)=2$。移动到 $A$ 得到 $W(A')=5+2=7$，超出了 $[3.5, 5.5]$ 的范围。不合法。\n- **下一个候选**：次高的增益是 $-3$，由 $v_2$ 和 $v_4$ 共享。根据平局打破规则，我们选择 $v_2$（索引较小）。\n- **平衡检查**：$v_2 \\in A_1$，$\\omega(v_2)=1$。移动到 $B$ 得到 $W(A') = 5-1=4$ 和 $W(B')=4+1=5$。两者都在 $[3.5, 5.5]$ 范围内。合法。\n- **行动**：将 $v_2$ 从 $A$ 移动到 $B$。锁定 $v_2$。\n- **状态更新**：移动增益 $G_2=-3$。累积增益 $= 3 + (-3) = 0$。划分为 $A_2 = \\{v_1, v_4, v_5\\}, B_2 = \\{v_2, v_3, v_6\\}$。\n\n**终止**\n此时，我们可以通过更新增益并选择下一步移动来继续这一轮。但是，让我们分析一下从划分 $A_2, B_2$ 进行任何进一步移动的合法性。权重为 $W(A_2) = \\omega(v_1)+\\omega(v_4)+\\omega(v_5) = 2+1+1=4$ 和 $W(B_2)=\\omega(v_2)+\\omega(v_3)+\\omega(v_6) = 1+2+2=5$。\n剩余未锁定的顶点是 $v_1, v_4 \\in A_2$ 和 $v_3, v_6 \\in B_2$。\n- 将 $v_1$（$\\omega=2$）从 $A_2 \\to B_2$ 移动：$W(A_2')=2$（不合法），$W(B_2')=7$（不合法）。\n- 将 $v_4$（$\\omega=1$）从 $A_2 \\to B_2$ 移动：$W(A_2')=3$（不合法），$W(B_2')=6$（不合法）。\n- 将 $v_3$（$\\omega=2$）从 $B_2 \\to A_2$ 移动：$W(A_2')=6$（不合法），$W(B_2')=3$（不合法）。\n- 将 $v_6$（$\\omega=2$）从 $B_2 \\to A_2$ 移动：$W(A_2')=6$（不合法），$W(B_2')=3$（不合法）。\n没有剩余的合法移动。本轮在 2 次移动后终止。\n\n**4. 找到最佳前缀和最终成本**\n累积增益的序列是：\n- 开始：$0$\n- 移动 1 后（$v_5$）：$G_1 = 3$\n- 移动 2 后（$v_2$）：$G_1+G_2 = 3-3=0$\n\n最大累积增益是 $\\max(3, 0) = 3$，它在第一次移动后出现。FM 算法规定我们只应用达到此最大增益的移动序列前缀。在这种情况下，前缀仅包含第一次移动。\n\n最佳划分是通过仅将第一次移动应用于初始划分 $\\mathcal{P}_0$ 得到的。\n- 初始划分：$A_0 = \\{v_1, v_2, v_4\\}, B_0 = \\{v_3, v_5, v_6\\}$。\n- 移动：$v_5$ 从 $B_0$ 移动到 $A_0$。\n- 最终划分 $\\mathcal{P}_f$：$A_f = \\{v_1, v_2, v_4, v_5\\}, B_f = \\{v_3, v_6\\}$。\n\n最终网表切割成本 $C_f$ 是初始成本减去最佳累积增益：\n$$ C_f = C(\\mathcal{P}_0) - \\max_k \\sum_{i=1}^k G_i = 6 - 3 = 3 $$\n\n我们可以通过直接计算 $\\mathcal{P}_f$ 的切割成本来验证这一点：\n- $e_1 = \\{v_1, v_3, v_5\\}$: $\\{v_1, v_5\\} \\subset A_f, \\{v_3\\} \\subset B_f$。被切割。\n- $e_2 = \\{v_1, v_2, v_3\\}$: $\\{v_1, v_2\\} \\subset A_f, \\{v_3\\} \\subset B_f$。被切割。\n- $e_3 = \\{v_2, v_4, v_5\\}$: 所有引脚都在 $A_f$ 中。未被切割。\n- $e_4 = \\{v_3, v_6\\}$: 所有引脚都在 $B_f$ 中。未被切割。\n最终切割成本是 $w(e_1) + w(e_2) = 2 + 1 = 3$。\n结果一致。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "与 FM 算法的局部、贪心特性不同，谱划分方法提供了一种利用图的全局结构信息的强大视角。该方法的核心思想是，图的拉普拉斯矩阵的特征向量揭示了其内在的连通性模式。这个练习 () 将引导你构建图的拉普拉斯矩阵，计算其关键的“Fiedler 向量”，并利用它来生成一个高质量的二分方案。这个过程将展示线性代数的深刻见解如何直接应用于解决复杂的组合优化问题。",
            "id": "4303713",
            "problem": "考虑集成电路电子设计自动化 (EDA) 中的一个网表划分任务，其中一个小系统被抽象为一个无向加权图，节点代表模块，边权重代表共享网络的数量。设该图有节点 $1, 2, 3, 4$，加权边由 $w_{12} = 2$、$w_{23} = 1$、$w_{34} = 2$ 给出，所有其他 $w_{ij} = 0$。使用由 $L = D - A$ 定义的未归一化（组合）图拉普拉斯算子，其中 $A$ 是对称加权邻接矩阵，$D$ 是对角度矩阵，其元素为 $D_{ii} = \\sum_{j} A_{ij}$。\n\n从拉普拉斯算子和谱划分的基本定义出发，计算拉普拉斯算子 $L$，找到其第二小的特征向量（Fiedler 向量），并通过在 0 处设定阈值生成一个二分：将特征向量分量严格大于 0 的每个节点分配给集合 $S$，将分量严格小于 0 的每个节点分配给集合 $T$。在本例中，没有零分量。\n\n最后，计算该划分的比率切割值，其定义为\n$$\\mathrm{RCut}(S,T) = \\frac{\\mathrm{cut}(S,T)}{|S|} + \\frac{\\mathrm{cut}(S,T)}{|T|},$$\n其中 $\\mathrm{cut}(S,T)$ 是一个端点在 $S$ 中而另一个在 $T$ 中的边的权重之和，而 $|S|$ 和 $|T|$ 表示 $S$ 和 $T$ 的基数。将你的最终答案表示为单个实数。无需四舍五入。",
            "solution": "问题陈述被评估为具有科学依据、良定且客观。它为应用于电子设计自动化的谱图论中的一个标准问题提供了一套完整且一致的定义和数据。因此，该问题是有效的，并将提供解答。\n\n该过程包括五个主要步骤：\n1.  从给定的图结构构建加权邻接矩阵 $A$ 和度矩阵 $D$。\n2.  计算未归一化图拉普拉斯算子 $L = D - A$。\n3.  求 $L$ 的特征值，以确定第二小的特征值 $\\lambda_2$。\n4.  计算与 $\\lambda_2$ 对应的特征向量，即 Fiedler 向量。\n5.  基于 Fiedler 向量各分量的符号划分图节点，然后计算此划分的比率切割。\n\n**步骤 1：构建邻接矩阵和度矩阵**\n\n该图有 4 个节点：$\\{1, 2, 3, 4\\}$。非零边权重为 $w_{12} = 2$、$w_{23} = 1$ 和 $w_{34} = 2$。该图是无向的，所以 $w_{ij} = w_{ji}$。\n\n加权邻接矩阵 $A$ 的元素为 $A_{ij} = w_{ij}$。\n$$A = \\begin{pmatrix} 0  2  0  0 \\\\ 2  0  1  0 \\\\ 0  1  0  2 \\\\ 0  0  2  0 \\end{pmatrix}$$\n\n度矩阵 $D$ 是一个对角矩阵，其中每个对角元素 $D_{ii}$ 是节点 $i$ 的度，计算方式为与该节点相连的所有边的权重之和：$D_{ii} = d_i = \\sum_j A_{ij}$。\n$d_1 = A_{12} = 2$\n$d_2 = A_{21} + A_{23} = 2 + 1 = 3$\n$d_3 = A_{31} + A_{32} + A_{34} = 0 + 1 + 2 = 3$\n$d_4 = A_{43} = 2$\n\n所以，度矩阵 $D$ 是：\n$$D = \\begin{pmatrix} 2  0  0  0 \\\\ 0  3  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  2 \\end{pmatrix}$$\n\n**步骤 2：计算拉普拉斯矩阵**\n\n未归一化的拉普拉斯算子 $L$ 定义为 $L = D - A$。\n$$L = \\begin{pmatrix} 2  0  0  0 \\\\ 0  3  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  2 \\end{pmatrix} - \\begin{pmatrix} 0  2  0  0 \\\\ 2  0  1  0 \\\\ 0  1  0  2 \\\\ 0  0  2  0 \\end{pmatrix} = \\begin{pmatrix} 2  -2  0  0 \\\\ -2  3  -1  0 \\\\ 0  -1  3  -2 \\\\ 0  0  -2  2 \\end{pmatrix}$$\n\n**步骤 3：求拉普拉斯算子的特征值**\n\n特征值 $\\lambda$ 是特征方程 $\\det(L - \\lambda I) = 0$ 的根。\n$$\\det \\begin{pmatrix} 2-\\lambda  -2  0  0 \\\\ -2  3-\\lambda  -1  0 \\\\ 0  -1  3-\\lambda  -2 \\\\ 0  0  -2  2-\\lambda \\end{pmatrix} = 0$$\n按第一行展开：\n$$(2-\\lambda) \\det \\begin{pmatrix} 3-\\lambda  -1  0 \\\\ -1  3-\\lambda  -2 \\\\ 0  -2  2-\\lambda \\end{pmatrix} - (-2) \\det \\begin{pmatrix} -2  -1  0 \\\\ 0  3-\\lambda  -2 \\\\ 0  -2  2-\\lambda \\end{pmatrix} = 0$$\n让我们计算这两个 $3 \\times 3$ 行列式：\n$\\det_1 = (3-\\lambda)[(3-\\lambda)(2-\\lambda) - (-2)(-1)] - (-1)[(-1)(2-\\lambda) - 0] = (3-\\lambda)(\\lambda^2 - 5\\lambda + 4) - (2-\\lambda) = -\\lambda^3 + 8\\lambda^2 - 16\\lambda + 4$\n$\\det_2 = -2[(3-\\lambda)(2-\\lambda) - (-2)(-1)] = -2(\\lambda^2 - 5\\lambda + 4)$\n\n特征方程为：\n$(2-\\lambda)(-\\lambda^3 + 8\\lambda^2 - 16\\lambda + 4) + 2(-2(\\lambda^2 - 5\\lambda + 4)) = 0$\n$\\lambda^4 - 10\\lambda^3 + 28\\lambda^2 - 16\\lambda = 0$\n$\\lambda(\\lambda^3 - 10\\lambda^2 + 28\\lambda - 16) = 0$\n一个特征值是 $\\lambda_1 = 0$。我们求三次因子的根。通过观察，$\\lambda=4$ 是一个根，因为 $4^3 - 10(4^2) + 28(4) - 16 = 64 - 160 + 112 - 16 = 0$。将 $(\\lambda^3 - 10\\lambda^2 + 28\\lambda - 16)$ 除以 $(\\lambda - 4)$ 得到 $(\\lambda^2 - 6\\lambda + 4)$。\n$\\lambda^2 - 6\\lambda + 4 = 0$ 的根通过二次公式求得：\n$\\lambda = \\frac{6 \\pm \\sqrt{36 - 4(1)(4)}}{2} = \\frac{6 \\pm \\sqrt{20}}{2} = 3 \\pm \\sqrt{5}$。\n\n$L$ 的四个特征值按升序排列是：\n$\\lambda_1 = 0$\n$\\lambda_2 = 3 - \\sqrt{5} \\approx 0.764$\n$\\lambda_3 = 4$\n$\\lambda_4 = 3 + \\sqrt{5} \\approx 5.236$\n第二小的特征值是 $\\lambda_2 = 3 - \\sqrt{5}$。\n\n**步骤 4：求 Fiedler 向量**\n\nFiedler 向量 $v$ 是对应于 $\\lambda_2 = 3 - \\sqrt{5}$ 的特征向量。我们求解 $(L - \\lambda_2 I)v = 0$。\n设 $v = [v_1, v_2, v_3, v_4]^T$。\n$$(L - (3-\\sqrt{5})I)v = \\begin{pmatrix} 2-(3-\\sqrt{5})  -2  0  0 \\\\ -2  3-(3-\\sqrt{5})  -1  0 \\\\ 0  -1  3-(3-\\sqrt{5})  -2 \\\\ 0  0  -2  2-(3-\\sqrt{5}) \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n这可以简化为：\n$$\\begin{pmatrix} \\sqrt{5}-1  -2  0  0 \\\\ -2  \\sqrt{5}  -1  0 \\\\ 0  -1  \\sqrt{5}  -2 \\\\ 0  0  -2  \\sqrt{5}-1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n这给出了以下线性方程组：\n1) $(\\sqrt{5}-1)v_1 - 2v_2 = 0 \\implies v_1 = \\frac{2}{\\sqrt{5}-1}v_2 = \\frac{1+\\sqrt{5}}{2}v_2$\n2) $-2v_1 + \\sqrt{5}v_2 - v_3 = 0$\n3) $-v_2 + \\sqrt{5}v_3 - 2v_4 = 0$\n4) $-2v_3 + (\\sqrt{5}-1)v_4 = 0 \\implies v_4 = \\frac{2}{\\sqrt{5}-1}v_3 = \\frac{1+\\sqrt{5}}{2}v_3$\n\n将(1)代入(2)：\n$-2\\left(\\frac{1+\\sqrt{5}}{2}v_2\\right) + \\sqrt{5}v_2 - v_3 = 0$\n$-(1+\\sqrt{5})v_2 + \\sqrt{5}v_2 - v_3 = 0$\n$-v_2 - \\sqrt{5}v_2 + \\sqrt{5}v_2 - v_3 = 0 \\implies -v_2 - v_3 = 0 \\implies v_3 = -v_2$。\n\n现在我们得到了所有分量之间的关系。如果我们设 $v_2 = 1$：\n$v_2 = 1$\n$v_3 = -1$\n$v_1 = \\frac{1+\\sqrt{5}}{2}$\n$v_4 = \\frac{1+\\sqrt{5}}{2}v_3 = -\\frac{1+\\sqrt{5}}{2}$\n\nFiedler 向量与 $\\left[ \\frac{1+\\sqrt{5}}{2}, 1, -1, -\\frac{1+\\sqrt{5}}{2} \\right]^T$ 成比例。\n\n**步骤 5：划分图并计算比率切割**\n\n通过在 0 处对 Fiedler 向量进行阈值处理来形成二分。\nFiedler 向量的分量是：\n$v_1 = \\frac{1+\\sqrt{5}}{2} > 0$\n$v_2 = 1 > 0$\n$v_3 = -1 < 0$\n$v_4 = -\\frac{1+\\sqrt{5}}{2} < 0$\n\n分量为正的节点构成集合 $S$，分量为负的节点构成集合 $T$。\n$S = \\{1, 2\\}$\n$T = \\{3, 4\\}$\n\n集合的基数为 $|S|=2$ 和 $|T|=2$。\n切割值 $\\mathrm{cut}(S,T)$ 是连接 $S$ 中节点与 $T$ 中节点的边的权重之和。唯一这样的边是 $(2,3)$。\n$\\mathrm{cut}(S,T) = w_{23} = 1$。\n\n最后，我们计算比率切割值：\n$$\\mathrm{RCut}(S,T) = \\frac{\\mathrm{cut}(S,T)}{|S|} + \\frac{\\mathrm{cut}(S,T)}{|T|}$$\n$$\\mathrm{RCut}(S,T) = \\frac{1}{2} + \\frac{1}{2} = 1$$",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}