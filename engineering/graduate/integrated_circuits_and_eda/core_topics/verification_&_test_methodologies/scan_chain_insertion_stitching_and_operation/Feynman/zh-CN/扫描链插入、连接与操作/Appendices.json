{
    "hands_on_practices": [
        {
            "introduction": "向设计中添加可测性逻辑并非没有代价。最直接的影响是其对电路功能模式下时序性能的冲击。本练习将引导你量化这种影响，通过分析当一个标准触发器被一个扫描触发器替换时，关键路径上的建立时间裕量（setup slack）会如何变化。理解这种性能损失是DFT（可测性设计）工程师进行时序权衡的第一步。",
            "id": "4295557",
            "problem": "考虑一个使用电子设计自动化 (EDA) 方法设计的集成电路中的同步单周期数据通路，该通路带有一个发射寄存器和一个捕获寄存器，两者最初都实现为功能性 D 触发器 (DFF)。时钟周期为 $T$，发射寄存器的时钟到 Q 端传播延迟为 $t_{\\text{clkq}}$，发射寄存器输出和捕获寄存器输入之间的总组合逻辑传播延迟为 $t_{\\text{pd}}$，捕获寄存器的建立时间要求为 $t_{\\text{setup}}$。从发射寄存器时钟引脚到捕获寄存器时钟引脚的时钟偏斜为 $t_{\\text{skew}}$。假设为单时钟域，无重定时，并忽略片上变异、抖动以及任何动态电源噪声效应。所有时序量均针对单一的工艺-电压-温度角，并被视为常量。\n\n在一个可测试性设计 (DFT) 插入步骤中，捕获寄存器被一个多路复用 D 型扫描触发器替换，其中功能性 D 输入在到达存储元件之前会经过一个内部的双输入多路复用器。在功能模式下（扫描使能信号无效），该多路复用器会在捕获寄存器输入端的数据通路上增加一个额外的延迟 $\\Delta t_{\\text{mux}}$。此外，在扫描触发器内部分配和门控扫描使能信号会给捕获寄存器带来建立时间开销，这被建模为相对于原始功能性 DFF 的建立时间要求增加了 $\\Delta t_{\\text{SE}}$。假设此次替换不改变发射寄存器的特性、时钟分配或 $t_{\\text{skew}}$。\n\n从同步建立时序的第一性原理出发，推导建立时间裕量变化量 $\\Delta S$ 的解析表达式，$\\Delta S$ 定义为替换后的建立时间裕量减去替换前的建立时间裕量，并将其表示为 $\\Delta t_{\\text{mux}}$ 和 $\\Delta t_{\\text{SE}}$ 的函数。将你的最终答案表示为一个以秒为单位的闭式符号表达式。不要对任何量进行数值计算或近似。",
            "solution": "单时钟域中同步单周期路径的建立时序条件，是基于比较捕获寄存器所要求的到达时间与数据实际到达其 D 输入的时间。建立时间裕量定义为要求到达时间与实际到达时间之差，其中正裕量表示满足建立时间约束。\n\n设发射时钟沿为参考。在原始的、扫描前的配置中，数据到达捕获寄存器输入端的时间是发射寄存器的时钟到 Q 端延迟与组合逻辑路径延迟之和：\n$$\nt_{\\text{arr,0}} = t_{\\text{clkq}} + t_{\\text{pd}}.\n$$\n考虑到时钟周期 $T$、时钟偏斜 $t_{\\text{skew}}$（定义为捕获时钟到达时间减去发射时钟到达时间）以及捕获寄存器的建立时间要求 $t_{\\text{setup}}$，捕获寄存器输入端所要求的到达时间为\n$$\nt_{\\text{req,0}} = T + t_{\\text{skew}} - t_{\\text{setup}}.\n$$\n因此，原始的建立时间裕量 $S_{0}$ 为\n$$\nS_{0} = t_{\\text{req,0}} - t_{\\text{arr,0}} = \\left(T + t_{\\text{skew}} - t_{\\text{setup}}\\right) - \\left(t_{\\text{clkq}} + t_{\\text{pd}}\\right).\n$$\n\n用多路复用 D 型扫描触发器替换捕获寄存器后，功能性 D 输入在到达存储元件之前，在单元内部会产生一个额外的延迟 $\\Delta t_{\\text{mux}}$。这使得数据到达捕获输入端的时间增加了 $\\Delta t_{\\text{mux}}$，从而得到\n$$\nt_{\\text{arr,1}} = t_{\\text{clkq}} + t_{\\text{pd}} + \\Delta t_{\\text{mux}}.\n$$\n扫描使能门控开销使建立时间要求增加了 $\\Delta t_{\\text{SE}}$，因此新的要求到达时间变为\n$$\nt_{\\text{req,1}} = T + t_{\\text{skew}} - \\left(t_{\\text{setup}} + \\Delta t_{\\text{SE}}\\right).\n$$\n因此，新的建立时间裕量 $S_{1}$ 为\n$$\nS_{1} = t_{\\text{req,1}} - t_{\\text{arr,1}} = \\left(T + t_{\\text{skew}} - t_{\\text{setup}} - \\Delta t_{\\text{SE}}\\right) - \\left(t_{\\text{clkq}} + t_{\\text{pd}} + \\Delta t_{\\text{mux}}\\right).\n$$\n\n建立时间裕量的变化量，定义为替换后裕量减去替换前裕量，即\n$$\n\\Delta S = S_{1} - S_{0}.\n$$\n代入 $S_{1}$ 和 $S_{0}$ 的表达式：\n$$\n\\Delta S = \\Big[\\left(T + t_{\\text{skew}} - t_{\\text{setup}} - \\Delta t_{\\text{SE}}\\right) - \\left(t_{\\text{clkq}} + t_{\\text{pd}} + \\Delta t_{\\text{mux}}\\right)\\Big] - \\Big[\\left(T + t_{\\text{skew}} - t_{\\text{setup}}\\right) - \\left(t_{\\text{clkq}} + t_{\\text{pd}}\\right)\\Big].\n$$\n化简后，公共项 $T$、$t_{\\text{skew}}$、$t_{\\text{setup}}$、$t_{\\text{clkq}}$ 和 $t_{\\text{pd}}$ 被消去：\n$$\n\\Delta S = -\\Delta t_{\\text{SE}} - \\Delta t_{\\text{mux}}.\n$$\n\n该表达式表明，在发射寄存器、时钟分配和偏斜保持不变的前述假设下，建立时间裕量的减少量等于功能性 D 路径上的多路复用器延迟与扫描使能门控开销所引起的建立时间增加量之和。",
            "answer": "$$\\boxed{-\\left(\\Delta t_{\\text{mux}}+\\Delta t_{\\text{SE}}\\right)}$$"
        },
        {
            "introduction": "在插入扫描单元后，下一步是将它们连接成一条可靠的扫描链。在这个“拼接”过程中，一个关键的挑战是避免由时钟偏斜（clock skew）引起的保持时间（hold-time）违例。本练习将从基本原理出发，推导保持时间违例发生的精确条件，从而确定何时需要插入“锁存锁”（lock-up latch）来保证扫描链在移位操作中的数据完整性。",
            "id": "4295616",
            "problem": "考虑两个在扫描链中以移位模式连续连接的正边沿触发扫描触发器 (FF)：$S_L$（发射）和 $S_C$（捕获）。两者由相同的扫描时钟网络驱动，但由于时钟树偏斜，它们经历不同的时钟到达时间。设给定的扫描时钟沿到达 $S_L$ 的时间为 $t_L$，到达 $S_C$ 的时间为 $t_C$，并将（有符号的）偏斜定义为 $s \\triangleq t_C - t_L$。$S_L$ 的最小 clock-to-Q 延迟为 $t_{\\mathrm{cq}}^{\\min}$，从 $S_L$ 的 $Q$ 端到 $S_C$ 的 $D$ 端的最小数据路径污染延迟（包括扫描多路复用器和互连线）为 $d_{\\mathrm{path}}^{\\min}$，$S_C$ 的保持时间为 $t_h$。此外，在 $S_L$ 和 $S_C$ 之间，扫描时钟具有最坏情况下的相对不确定性（包括抖动和建模不确定性）$u$，其定义为在最坏情况下，相对于发射沿，有效捕获沿的到达时间可能比标称值晚 $u$。\n\n仅使用保持时间、clock-to-Q 延迟、污染延迟和时钟偏斜/不确定性的基本时序定义，从第一性原理推导保证在扫描移位期间 $S_C$ 处不发生保持时间违例的最大允许正偏斜 $s_{\\max}$ 的解析表达式（即，超过该阈值则必须使用锁存闩锁）。然后，使用以下参数值对 $s_{\\max}$ 进行数值计算：\n- $t_{\\mathrm{cq}}^{\\min} = 0.037\\ \\mathrm{ns}$，\n- $d_{\\mathrm{path}}^{\\min} = 0.126\\ \\mathrm{ns}$，\n- $t_h = 0.081\\ \\mathrm{ns}$，\n- $u = 0.019\\ \\mathrm{ns}$。\n\n给出 $s_{\\max}$ 的最终数值，四舍五入到四位有效数字。最终结果以纳秒为单位表示。",
            "solution": "为确保捕获触发器 $S_C$ 不发生保持时间违例，从发射触发器 $S_L$ 发出的新数据到达 $S_C$ 输入端的时间，必须晚于或等于 $S_C$ 处当前数据位所需保持的时间窗口的结束点。\n\n1.  **数据最早到达时间 ($T_{\\mathrm{data\\_arrival}}$):**\n    时钟沿在时间 $t_L$ 到达 $S_L$。经过最小 clock-to-Q 延迟 $t_{\\mathrm{cq}}^{\\min}$ 后，新数据出现在 $S_L$ 的 Q 输出端。再经过最小路径污染延迟 $d_{\\mathrm{path}}^{\\min}$，数据到达 $S_C$ 的 D 输入端。因此，新数据最早到达的时间为：\n    $$T_{\\mathrm{data\\_arrival}} = t_L + t_{\\mathrm{cq}}^{\\min} + d_{\\mathrm{path}}^{\\min}$$\n\n2.  **数据保持窗口结束时间 ($T_{\\mathrm{hold\\_end}}$):**\n    同一个时钟沿在时间 $t_C$ 到达 $S_C$。$S_C$ 的保持时间要求 $t_h$ 规定，输入数据必须在时钟沿到达后保持稳定至少 $t_h$ 的时长。因此，旧数据必须保持稳定直至时间：\n    $$T_{\\mathrm{hold\\_end}} = t_C + t_h$$\n\n3.  **建立保持时间约束:**\n    为了防止保持时间违例，数据到达时间必须晚于保持窗口结束时间。考虑到时钟不确定性 $u$ 作为额外的安全裕量，该条件变为：\n    $$T_{\\mathrm{data\\_arrival}} \\ge T_{\\mathrm{hold\\_end}} + u$$\n    代入表达式：\n    $$t_L + t_{\\mathrm{cq}}^{\\min} + d_{\\mathrm{path}}^{\\min} \\ge t_C + t_h + u$$\n\n4.  **推导最大允许偏斜 ($s_{\\max}$):**\n    将不等式重新整理，以时钟偏斜 $s = t_C - t_L$ 来表示：\n    $$t_{\\mathrm{cq}}^{\\min} + d_{\\mathrm{path}}^{\\min} - t_h - u \\ge t_C - t_L$$\n    $$s \\le t_{\\mathrm{cq}}^{\\min} + d_{\\mathrm{path}}^{\\min} - t_h - u$$\n    因此，最大允许的正偏斜 $s_{\\max}$ 的解析表达式为：\n    $$s_{\\max} = t_{\\mathrm{cq}}^{\\min} + d_{\\mathrm{path}}^{\\min} - t_h - u$$\n\n5.  **数值计算:**\n    代入给定参数值：\n    - $t_{\\mathrm{cq}}^{\\min} = 0.037\\ \\mathrm{ns}$\n    - $d_{\\mathrm{path}}^{\\min} = 0.126\\ \\mathrm{ns}$\n    - $t_h = 0.081\\ \\mathrm{ns}$\n    - $u = 0.019\\ \\mathrm{ns}$\n    $$s_{\\max} = 0.037 + 0.126 - 0.081 - 0.019$$\n    $$s_{\\max} = 0.163 - 0.100 = 0.063\\ \\mathrm{ns}$$\n    题目要求四舍五入到四位有效数字，结果为 $0.06300\\ \\mathrm{ns}$，或以科学记数法表示为 $6.300 \\times 10^{-2}\\ \\mathrm{ns}$。",
            "answer": "$$\\boxed{6.300 \\times 10^{-2}}$$"
        },
        {
            "introduction": "除了对数据路径时序的直接影响，DFT逻辑还可能与关键的功能信号发生意想不到的交互，从而引入设计缺陷。本练习展示了一个常见的设计错误：将异步复位信号与扫描使能信号进行逻辑门控。我们将通过一个具体的反例来分析这种做法如何产生一个时序风险，导致在特定操作模式下发生意外的复位，这凸显了遵循DFT设计规则以避免功能性错误的重要性。",
            "id": "4295571",
            "problem": "考虑一个采用电子设计自动化 (EDA) 流程并进行了可测试性设计 (DFT) 扫描链插入的同步设计。在该设计中，每个存储元件都被替换为一个可扫描的触发器单元，该单元具有一个异步低电平有效的复位输入 $RN$、一个数据输入 $D$、一个扫描输入 $SI$ 和一个扫描使能信号 $SE$。一名初级工程师试图通过错误地使用扫描使能信号对异步复位进行门控，来防止在扫描移位期间发生意外复位。他为扫描触发器实现了一个新的复位信号 $RN_{\\mathrm{new}}$，其逻辑如下：\n$$\nRN_{\\mathrm{new}} = RN_{\\mathrm{orig}} \\lor SE,\n$$\n其中 $\\lor$ 表示逻辑或运算，$RN_{\\mathrm{orig}}$ 是来自功能设计的原始低电平有效异步复位网络。\n\n基本事实：\n- 对于一个低电平有效的输入 $RN$，当 $RN \\le V_{\\mathrm{IL}}$ 的状态持续时间至少达到最小脉冲宽度 $t_{\\mathrm{rpw}}^{\\min}$ 时，异步复位会置位；此行为与时钟无关。\n- 一个双输入或门仅在两个输入都为低电平时才输出低电平。\n- 门电路的输出在输入跳变之后经过其传播延迟才会发生跳变；为简化起见，假设该或门的上升和下降传播延迟相等，因此输出的低电平脉冲宽度等于两个输入同时为低电平的时间区间的持续时长。\n\n在从扫描到捕获的转换期间，扫描使能信号 $SE$ 在时间 $t=0$ 时从 1 切换到 0。$SE$ 网络信号在经过 $d_{\\mathrm{SE}}$ 的传播延迟后到达或门输入端；因此，对于所有 $t \\ge d_{\\mathrm{SE}}$，或门的 $SE$ 输入为低电平。同时，由于原始复位网络上的电容串扰，$RN_{\\mathrm{orig}}$ 在其源端经历一个负向毛刺：它在时间区间 $[t=\\Delta,\\, t=\\Delta+g]$ 内降至逻辑低电平，然后恢复为高电平。该复位网络信号在经过 $d_{\\mathrm{RN}}$ 的传播延迟后到达或门输入端，因此或门的 $RN_{\\mathrm{orig}}$ 输入在时间区间 $[t=d_{\\mathrm{RN}}+\\Delta,\\, t=d_{\\mathrm{RN}}+\\Delta+g]$ 内为低电平。\n\n给定以下数值合理的参数：\n- $d_{\\mathrm{SE}} = 80\\ \\mathrm{ps}$，\n- $d_{\\mathrm{RN}} = 110\\ \\mathrm{ps}$，\n- $\\Delta = 0\\ \\mathrm{ps}$，\n- $g = 180\\ \\mathrm{ps}$，\n- $t_{\\mathrm{rpw}}^{\\min} = 120\\ \\mathrm{ps}$，\n\n请确定这种错误插入的门控逻辑是否会在从扫描到捕获的转换期间引起意外的异步复位，并计算到达扫描触发器的 $RN_{\\mathrm{new}}$ 信号上的低电平脉冲宽度。然后选择最准确的结论。\n\n选项：\n\nA. 在或门输出端，$RN_{\\mathrm{new}}$ 呈现出一个 180 ps 的低电平脉冲，超过了 $t_{\\mathrm{rpw}}^{\\min}$，从而导致意外的异步复位；该反例表明，使用 $SE$ 对功能性异步复位进行门控，会在捕获阶段引入一个低电平交集窗口。\n\nB. $RN_{\\mathrm{new}}$ 永远不会变为低电平，因为带有 $SE$ 输入的或门在 $SE$ 下降时无法产生低电平输出；因此，在任何 $RN_{\\mathrm{orig}}$ 的时序下都不可能发生复位。\n\nC. $RN_{\\mathrm{new}}$ 上确实会出现一个低电平脉冲，但由于路径延迟的差异，其宽度为 30 ps，小于 $t_{\\mathrm{rpw}}^{\\min}$；因此，不会触发复位。\n\nD. 在捕获阶段，复位仍然被屏蔽，因为只有当 $SE=1$ 时才允许复位通过或门传播；因此，不正确的扫描链插入无法修改从扫描到捕获转换时的复位行为。",
            "solution": "该问题的核心在于确定或门 ($OR$) 的两个输入信号——来自功能设计的原始复位信号 $RN_{\\mathrm{orig}}$ 和扫描使能信号 $SE$——何时在或门的输入端同时为逻辑低电平。根据或门的逻辑功能 $RN_{\\mathrm{new}} = RN_{\\mathrm{orig}} \\lor SE$，只有当两个输入同时为低电平时，其输出 $RN_{\\mathrm{new}}$ 才会为低电平。\n\n1.  **确定 $SE$ 输入的低电平时间窗口：**\n    $SE$ 信号在 $t=0$ 时从高电平切换到低电平，经过 $d_{\\mathrm{SE}} = 80\\ \\mathrm{ps}$ 的传播延迟后到达或门的输入端。因此，$SE$ 输入为低电平的时间区间为：\n    $$I_{SE} = [80\\ \\mathrm{ps}, \\infty)$$\n\n2.  **确定 $RN_{\\mathrm{orig}}$ 输入的低电平时间窗口：**\n    $RN_{\\mathrm{orig}}$ 信号由于串扰在源端产生了一个从 $t=\\Delta=0$ 开始、持续时间为 $g=180\\ \\mathrm{ps}$ 的低电平毛刺。该毛刺经过 $d_{\\mathrm{RN}} = 110\\ \\mathrm{ps}$ 的传播延迟后到达或门的输入端。因此，$RN_{\\mathrm{orig}}$ 输入为低电平的时间区间为：\n    $$I_{RN} = [d_{\\mathrm{RN}} + \\Delta, d_{\\mathrm{RN}} + \\Delta + g] = [110\\ \\mathrm{ps} + 0\\ \\mathrm{ps}, 110\\ \\mathrm{ps} + 0\\ \\mathrm{ps} + 180\\ \\mathrm{ps}] = [110\\ \\mathrm{ps}, 290\\ \\mathrm{ps}]$$\n\n3.  **计算 $RN_{\\mathrm{new}}$ 的低电平脉冲宽度：**\n    $RN_{\\mathrm{new}}$ 信号为低电平的时间窗口是 $I_{SE}$ 和 $I_{RN}$ 的交集。\n    $$I_{\\mathrm{low}} = I_{SE} \\cap I_{RN} = [80\\ \\mathrm{ps}, \\infty) \\cap [110\\ \\mathrm{ps}, 290\\ \\mathrm{ps}]$$\n    交集的起始时间为 $\\max(80\\ \\mathrm{ps}, 110\\ \\mathrm{ps}) = 110\\ \\mathrm{ps}$。\n    交集的结束时间为 $\\min(\\infty, 290\\ \\mathrm{ps}) = 290\\ \\mathrm{ps}$。\n    因此，$RN_{\\mathrm{new}}$ 在区间 $[110\\ \\mathrm{ps}, 290\\ \\mathrm{ps}]$ 内为低电平。\n    该低电平脉冲的宽度为：\n    $$W_{\\mathrm{low}} = 290\\ \\mathrm{ps} - 110\\ \\mathrm{ps} = 180\\ \\mathrm{ps}$$\n\n4.  **与最小脉冲宽度要求比较：**\n    计算出的脉冲宽度 $W_{\\mathrm{low}} = 180\\ \\mathrm{ps}$。\n    触发器异步复位所需的最小脉冲宽度为 $t_{\\mathrm{rpw}}^{\\min} = 120\\ \\mathrm{ps}$。\n    由于 $180\\ \\mathrm{ps} \\ge 120\\ \\mathrm{ps}$，该脉冲宽度足以触发意外的异步复位。\n\n因此，选项 A 准确地描述了这种情况：产生了一个 180 ps 的低电平脉冲，超过了最小要求，导致了意外复位。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}