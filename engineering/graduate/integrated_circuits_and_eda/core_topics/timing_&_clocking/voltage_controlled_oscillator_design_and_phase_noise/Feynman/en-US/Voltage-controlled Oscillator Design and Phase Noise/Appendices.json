{
    "hands_on_practices": [
        {
            "introduction": "This exercise explores the fundamental principle of sustained oscillation. By analyzing the admittance of a parallel $RLC$ tank with an active transconductance element, you will derive the necessary conditions from first principles, determining the minimum gain required to compensate for tank losses. This analysis, which reveals the need for a negative resistance to cancel passive losses, is the foundational step in understanding how any $LC$ oscillator begins and maintains its periodic motion .",
            "id": "4307959",
            "problem": "Consider a Voltage-Controlled Oscillator (VCO) for integrated circuits in the context of Electronic Design Automation (EDA) whose resonator is a parallel $RLC$ tank. The inductor has inductance $L = 5\\,\\mathrm{nH}$, the capacitor has capacitance $C = 2\\,\\mathrm{pF}$, and all loss mechanisms of the tank are modeled by a single equivalent parallel resistance $R_{p} = 2.5\\,\\mathrm{k}\\Omega$ across the tank nodes. The active device is an ideal transconductance element with transconductance $g_{m}$, configured such that its small-signal current is $i_{g_{m}}(t) = -g_{m}\\,v(t)$, where $v(t)$ is the tank voltage. Assume the active device and tank are otherwise ideal and linear, and neglect all noise sources, including thermal and flicker noise, so that only the small-signal conditions for the existence of a sustained natural oscillation need to be checked.\n\nStarting from Kirchhoff’s Current Law, the admittances of linear time-invariant elements, and the condition that a non-trivial homogeneous solution exists only when the net admittance seen by the tank voltage vanishes at a purely imaginary complex frequency, derive the minimum transconductance $g_{m,\\min}$ required for oscillation and the nominal angular oscillation frequency $\\omega_{0}$ under these ideal conditions.\n\nCompute the numerical values of $g_{m,\\min}$ and $\\omega_{0}$ using the given component values. Express $g_{m,\\min}$ in $\\mathrm{S}$ and $\\omega_{0}$ in $\\mathrm{rad/s}$. Provide both answers in the order $(g_{m,\\min},\\,\\omega_{0})$, and round your results to four significant figures.",
            "solution": "The problem requires the derivation of the minimum transconductance $g_{m,\\min}$ and the angular oscillation frequency $\\omega_0$ for a parallel $RLC$ tank oscillator. The derivation must start from Kirchhoff’s Current Law (KCL).\n\nThe oscillator circuit consists of a capacitor with capacitance $C$, an inductor with inductance $L$, a resistor with resistance $R_p$, and an active transconductance element with transconductance $g_m$, all connected in parallel. Let $v(t)$ be the voltage across this parallel network. According to KCL, the algebraic sum of currents leaving any node must be zero. For the single node of the parallel tank, we have:\n$$\ni_C(t) + i_L(t) + i_R(t) + i_{g_m}(t) = 0\n$$\nwhere $i_C(t)$, $i_L(t)$, $i_R(t)$, and $i_{g_m}(t)$ are the currents through the capacitor, inductor, resistor, and active device, respectively.\n\nTo analyze the conditions for sustained oscillation, we transform the circuit into the frequency domain. We use complex frequency $s = \\sigma + j\\omega$. In the frequency domain, the relationship between voltage $V(s)$ and current $I(s)$ for any component is given by its admittance $Y(s)$ as $I(s) = Y(s)V(s)$. The KCL equation becomes:\n$$\nI_C(s) + I_L(s) + I_R(s) + I_{g_m}(s) = 0\n$$\nThe admittances for the passive LTI components are:\n- Capacitor: $Y_C(s) = sC$\n- Inductor: $Y_L(s) = \\frac{1}{sL}$\n- Resistor: $Y_R(s) = \\frac{1}{R_p}$\n\nThe active device is defined by the relationship $i_{g_m}(t) = -g_m v(t)$. In the frequency domain, this is $I_{g_m}(s) = -g_m V(s)$. This corresponds to an admittance $Y_{g_m}(s) = -g_m$. The negative sign signifies that this element supplies power to the circuit, compensating for the energy dissipated by the resistor.\n\nSubstituting the admittance expressions into the KCL equation:\n$$\nsC V(s) + \\frac{1}{sL} V(s) + \\frac{1}{R_p} V(s) - g_m V(s) = 0\n$$\nFactoring out the common voltage term $V(s)$:\n$$\n\\left( sC + \\frac{1}{sL} + \\frac{1}{R_p} - g_m \\right) V(s) = 0\n$$\nFor a non-trivial solution to exist (i.e., for an oscillation $V(s) \\neq 0$ to occur), the total admittance of the parallel network, $Y_{\\text{total}}(s)$, must be zero:\n$$\nY_{\\text{total}}(s) = sC + \\frac{1}{sL} + \\frac{1}{R_p} - g_m = 0\n$$\nThe problem specifies that a sustained, steady-state oscillation corresponds to a non-trivial homogeneous solution at a purely imaginary complex frequency. This means the system must have poles on the $j\\omega$-axis of the complex plane. We therefore set $s = j\\omega_0$, where $\\omega_0$ is the real angular frequency of oscillation.\n$$\nY_{\\text{total}}(j\\omega_0) = j\\omega_0 C + \\frac{1}{j\\omega_0 L} + \\frac{1}{R_p} - g_m = 0\n$$\nUsing the identity $\\frac{1}{j} = -j$, we can rewrite the equation and separate the real and imaginary parts:\n$$\nj\\omega_0 C - \\frac{j}{\\omega_0 L} + \\frac{1}{R_p} - g_m = 0\n$$\n$$\n\\left( \\frac{1}{R_p} - g_m \\right) + j \\left( \\omega_0 C - \\frac{1}{\\omega_0 L} \\right) = 0\n$$\nFor this complex number to be zero, both its real and imaginary parts must independently be zero.\n\nSetting the real part to zero gives the condition for the amplitude of the oscillation to be sustained (i.e., neither decaying nor growing):\n$$\n\\text{Re}\\{Y_{\\text{total}}(j\\omega_0)\\} = \\frac{1}{R_p} - g_m = 0\n$$\nThis condition is met when the transconductance $g_m$ exactly cancels the parallel resistance's conductance $G_p = \\frac{1}{R_p}$. This defines the minimum transconductance needed to start and sustain the oscillation.\n$$\ng_{m,\\min} = \\frac{1}{R_p}\n$$\nSetting the imaginary part to zero gives the frequency at which the oscillation occurs:\n$$\n\\text{Im}\\{Y_{\\text{total}}(j\\omega_0)\\} = \\omega_0 C - \\frac{1}{\\omega_0 L} = 0\n$$\nThis is the resonance condition, where the susceptances of the inductor and capacitor cancel each other out.\n$$\n\\omega_0 C = \\frac{1}{\\omega_0 L} \\implies \\omega_0^2 = \\frac{1}{LC}\n$$\nThe angular oscillation frequency is therefore:\n$$\n\\omega_0 = \\frac{1}{\\sqrt{LC}}\n$$\nWe now compute the numerical values using the provided data: $L = 5\\,\\mathrm{nH} = 5 \\times 10^{-9}\\,\\mathrm{H}$, $C = 2\\,\\mathrm{pF} = 2 \\times 10^{-12}\\,\\mathrm{F}$, and $R_p = 2.5\\,\\mathrm{k}\\Omega = 2.5 \\times 10^3\\,\\Omega$.\n\nThe minimum transconductance is:\n$$\ng_{m,\\min} = \\frac{1}{2.5 \\times 10^3\\,\\Omega} = 0.0004\\,\\mathrm{S}\n$$\nTo four significant figures, this is $g_{m,\\min} = 4.000 \\times 10^{-4}\\,\\mathrm{S}$.\n\nThe angular oscillation frequency is:\n$$\n\\omega_0 = \\frac{1}{\\sqrt{(5 \\times 10^{-9}\\,\\mathrm{H})(2 \\times 10^{-12}\\,\\mathrm{F})}} = \\frac{1}{\\sqrt{10 \\times 10^{-21}\\,\\mathrm{s}^2}} = \\frac{1}{\\sqrt{1 \\times 10^{-20}\\,\\mathrm{s}^2}}\n$$\n$$\n\\omega_0 = \\frac{1}{1 \\times 10^{-10}\\,\\mathrm{s}} = 1 \\times 10^{10}\\,\\mathrm{rad/s}\n$$\nTo four significant figures, this is $\\omega_0 = 1.000 \\times 10^{10}\\,\\mathrm{rad/s}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.000 \\times 10^{-4} & 1.000 \\times 10^{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on the concept of a resonant tank, this practice focuses on a crucial figure of merit: the Quality Factor, or $Q$. You will derive the loaded $Q$ from its fundamental definition related to energy storage and dissipation, and see how it directly impacts the resonator's bandwidth and voltage swing for a given drive strength . Understanding $Q$ is essential for designing low-loss, high-performance resonators, which are critical for stable, low-noise oscillators.",
            "id": "4308001",
            "problem": "A Voltage-Controlled Oscillator (VCO) used in Electronic Design Automation (EDA) employs an ideal inductor-capacitor ($LC$) tank. The tank is composed of an inductor of value $L = 2\\,\\text{nH}$ and a capacitor of value $C = 1\\,\\text{pF}$. An active device connected to the tank presents a purely resistive load modeled as a parallel resistance $R_{\\text{load}} = 1\\,\\text{k}\\Omega$ across the $LC$. The tank is driven by a sinusoidal current source of root-mean-square (rms) amplitude $I_{\\text{s,rms}} = 0.5\\,\\text{mA}$ applied in parallel to the tank.\n\nStarting from first principles appropriate for resonant circuits—namely, the definition of the Quality Factor (Q) based on energy storage and dissipation, and the behavior of admittance near resonance—derive the loaded Quality Factor ($Q$) of the tank due solely to $R_{\\text{load}}$, the corresponding small-signal $3\\,\\text{dB}$ bandwidth around resonance, and the peak voltage amplitude across the tank at resonance under the given current drive.\n\nAssume ideal $L$ and $C$ (no parasitic resistance in the inductor or capacitor) and that the only dissipation arises from $R_{\\text{load}}$. For the bandwidth, quantify it in hertz as the full width at half maximum around the resonant frequency. For the peak amplitude, report the peak voltage across the tank in volts. Round all reported numerical results to four significant figures. Express the loaded Quality Factor as a dimensionless quantity, the bandwidth in $\\text{Hz}$, and the peak amplitude in $\\text{V}$.",
            "solution": "The problem presents a parallel RLC resonant circuit, which is the core of an LC tank oscillator. The circuit consists of an ideal inductor $L$, an ideal capacitor $C$, and a load resistance $R_{\\text{load}}$, all in parallel. This tank is driven by a sinusoidal parallel current source with an RMS amplitude $I_{\\text{s,rms}}$. We are asked to derive and calculate three key performance metrics: the loaded quality factor $Q$, the $3\\,\\text{dB}$ bandwidth, and the peak voltage at resonance.\n\nFirst, we determine the angular resonant frequency, $\\omega_0$. For a parallel LC tank, resonance occurs when the susceptances of the inductor and capacitor cancel each other. The total admittance $Y(j\\omega)$ of the parallel RLC circuit is given by the sum of the admittances of each component:\n$$Y(j\\omega) = \\frac{1}{R_{\\text{load}}} + j\\omega C + \\frac{1}{j\\omega L} = \\frac{1}{R_{\\text{load}}} + j\\left(\\omega C - \\frac{1}{\\omega L}\\right)$$\nResonance is defined as the frequency $\\omega_0$ where the imaginary part of the admittance is zero.\n$$ \\omega_0 C - \\frac{1}{\\omega_0 L} = 0 \\implies \\omega_0^2 LC = 1 \\implies \\omega_0 = \\frac{1}{\\sqrt{LC}} $$\nUsing the given values $L = 2 \\times 10^{-9}\\,\\text{H}$ and $C = 1 \\times 10^{-12}\\,\\text{F}$:\n$$ \\omega_0 = \\frac{1}{\\sqrt{(2 \\times 10^{-9})(1 \\times 10^{-12})}} = \\frac{1}{\\sqrt{2 \\times 10^{-21}}} = \\frac{1}{\\sqrt{20 \\times 10^{-22}}} = \\frac{10^{11}}{\\sqrt{20}} = \\frac{10^{11}}{2\\sqrt{5}} \\approx 2.236 \\times 10^{10}\\,\\text{rad/s} $$\n\nThe first quantity to derive is the loaded Quality Factor, $Q$, from first principles of energy storage and dissipation. The quality factor is defined as:\n$$ Q = 2\\pi \\frac{\\text{Maximum energy stored in the tank}}{\\text{Energy dissipated per cycle at resonance}} $$\nLet the voltage across the parallel tank be a sinusoid at the resonant frequency: $v(t) = V_p \\cos(\\omega_0 t)$, where $V_p$ is the peak voltage amplitude.\nThe energy stored in the capacitor is $E_C(t) = \\frac{1}{2} C v(t)^2 = \\frac{1}{2} C V_p^2 \\cos^2(\\omega_0 t)$.\nThe current through the inductor is $i_L(t) = \\frac{1}{L} \\int v(t) dt = \\frac{V_p}{\\omega_0 L} \\sin(\\omega_0 t)$.\nThe energy stored in the inductor is $E_L(t) = \\frac{1}{2} L i_L(t)^2 = \\frac{1}{2} L \\left(\\frac{V_p}{\\omega_0 L}\\right)^2 \\sin^2(\\omega_0 t)$.\nSubstituting $\\omega_0^2 = 1/(LC)$, this becomes $E_L(t) = \\frac{1}{2} L \\frac{V_p^2 C}{L} \\sin^2(\\omega_0 t) = \\frac{1}{2} C V_p^2 \\sin^2(\\omega_0 t)$.\nThe total energy stored in the tank is the sum of the energy in the capacitor and the inductor:\n$$ E_{\\text{stored}}(t) = E_C(t) + E_L(t) = \\frac{1}{2} C V_p^2 (\\cos^2(\\omega_0 t) + \\sin^2(\\omega_0 t)) = \\frac{1}{2} C V_p^2 $$\nThis energy is constant over a cycle, so the maximum energy stored is $E_{\\text{max,stored}} = \\frac{1}{2} C V_p^2$.\nThe energy is dissipated only in the resistor $R_{\\text{load}}$. The average power dissipated is $P_{\\text{avg}} = \\frac{V_{\\text{rms}}^2}{R_{\\text{load}}} = \\frac{(V_p/\\sqrt{2})^2}{R_{\\text{load}}} = \\frac{V_p^2}{2R_{\\text{load}}}$.\nThe energy dissipated per cycle is the average power multiplied by the period $T_0 = 1/f_0 = 2\\pi/\\omega_0$.\n$$ E_{\\text{diss,cycle}} = P_{\\text{avg}} T_0 = \\frac{V_p^2}{2R_{\\text{load}}} \\frac{2\\pi}{\\omega_0} = \\frac{\\pi V_p^2}{\\omega_0 R_{\\text{load}}} $$\nNow we can compute $Q$:\n$$ Q = 2\\pi \\frac{E_{\\text{max,stored}}}{E_{\\text{diss,cycle}}} = 2\\pi \\frac{\\frac{1}{2} C V_p^2}{\\frac{\\pi V_p^2}{\\omega_0 R_{\\text{load}}}} = 2\\pi \\left(\\frac{C V_p^2}{2}\\right) \\left(\\frac{\\omega_0 R_{\\text{load}}}{\\pi V_p^2}\\right) = \\omega_0 C R_{\\text{load}} $$\nAs an alternative form, using $\\omega_0 = 1/\\sqrt{LC}$, we have $Q = R_{\\text{load}} \\sqrt{\\frac{C}{L}}$.\nUsing the given values $R_{\\text{load}} = 1 \\times 10^3\\,\\Omega$, $C = 1 \\times 10^{-12}\\,\\text{F}$, and $L = 2 \\times 10^{-9}\\,\\text{H}$:\n$$ Q = (1 \\times 10^3) \\sqrt{\\frac{1 \\times 10^{-12}}{2 \\times 10^{-9}}} = 1000 \\sqrt{0.5 \\times 10^{-3}} = 1000 \\sqrt{5 \\times 10^{-4}} = 1000 \\times 10^{-2} \\sqrt{5} = 10\\sqrt{5} $$\n$$ Q \\approx 22.360679... \\approx 22.36 $$\n\nThe second quantity is the $3\\,\\text{dB}$ bandwidth ($BW$). This is the frequency range over which the circuit's power response is at least half its maximum. For a current-driven RLC circuit, this corresponds to the frequencies where the voltage magnitude across the tank is $1/\\sqrt{2}$ of its peak value at resonance. The magnitude of the impedance is $|Z(j\\omega)| = 1/|Y(j\\omega)|$. At resonance, $Z(j\\omega_0) = R_{\\text{load}}$. The $3\\,\\text{dB}$ points occur when the magnitude of the imaginary part of the admittance equals the real part:\n$$ |\\omega C - \\frac{1}{\\omega L}| = \\frac{1}{R_{\\text{load}}} $$\nThe bandwidth in radians per second, $BW_{\\text{rad/s}}$, is also defined by the relation $Q = \\omega_0 / BW_{\\text{rad/s}}$. Therefore, we can find the bandwidth from $Q$:\n$$ BW_{\\text{rad/s}} = \\frac{\\omega_0}{Q} $$\nUsing our expressions for $\\omega_0$ and $Q$:\n$$ BW_{\\text{rad/s}} = \\frac{\\omega_0}{\\omega_0 C R_{\\text{load}}} = \\frac{1}{R_{\\text{load}} C} $$\nThe bandwidth in Hertz, $BW_{\\text{Hz}}$, is:\n$$ BW_{\\text{Hz}} = \\frac{BW_{\\text{rad/s}}}{2\\pi} = \\frac{1}{2\\pi R_{\\text{load}} C} $$\nSubstituting the numerical values:\n$$ BW_{\\text{Hz}} = \\frac{1}{2\\pi (1 \\times 10^3)(1 \\times 10^{-12})} = \\frac{1}{2\\pi \\times 10^{-9}} = \\frac{10^9}{2\\pi} $$\n$$ BW_{\\text{Hz}} \\approx 159154943.09... \\,\\text{Hz} \\approx 1.592 \\times 10^8 \\,\\text{Hz} $$\n\nThe third quantity is the peak voltage amplitude, $V_p$, across the tank at resonance. The current source is applied in parallel to the tank. At the resonant frequency $\\omega_0$, the impedance of the inductor and capacitor cancel, and the total impedance of the tank is purely resistive and equal to $Z(\\omega_0) = R_{\\text{load}}$.\nThe RMS voltage across the tank is given by Ohm's Law, using the RMS current:\n$$ V_{\\text{rms}} = I_{\\text{s,rms}} \\cdot Z(\\omega_0) = I_{\\text{s,rms}} \\cdot R_{\\text{load}} $$\nThe problem asks for the peak voltage amplitude, $V_p$. For a sinusoidal signal, $V_p = V_{\\text{rms}} \\sqrt{2}$.\n$$ V_p = I_{\\text{s,rms}} \\cdot R_{\\text{load}} \\cdot \\sqrt{2} $$\nSubstituting the given values $I_{\\text{s,rms}} = 0.5 \\times 10^{-3}\\,\\text{A}$ and $R_{\\text{load}} = 1 \\times 10^3\\,\\Omega$:\n$$ V_p = (0.5 \\times 10^{-3}) \\cdot (1 \\times 10^3) \\cdot \\sqrt{2} = 0.5 \\sqrt{2} $$\n$$ V_p \\approx 0.70710678... \\,\\text{V} \\approx 0.7071 \\,\\text{V} $$\n\nThe requested values, rounded to four significant figures, are: $Q = 22.36$, $BW_{\\text{Hz}} = 1.592 \\times 10^8\\,\\text{Hz}$, and $V_p = 0.7071\\,\\text{V}$.",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n22.36 & 1.592 \\times 10^8 & 0.7071\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "This advanced exercise delves into phase noise, the primary performance limiter in modern oscillators. You will derive the Impulse Sensitivity Function (ISF), a powerful concept that explains how noise events are converted into timing jitter depending on when they occur within the oscillation cycle . This provides a deep, intuitive understanding of the origins of phase noise, moving beyond simple energy-loss models to a time-varying perspective on noise sensitivity.",
            "id": "4307933",
            "problem": "Consider a balanced differential Voltage-Controlled Oscillator (VCO) implemented as a symmetric parallel inductor-capacitor (LC) tank with a negative conductance that sustains oscillation. In steady state, the tank voltage is nearly sinusoidal and can be written as $v(t) = \\hat{V}\\cos(\\theta)$ with $\\theta = \\omega_{0} t$, where $\\hat{V}$ is the steady-state amplitude and $\\omega_{0}$ is the oscillation angular frequency. The corresponding inductor current is $i_{L}(t) = \\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta)$, consistent with $L\\frac{di_{L}}{dt} = v(t)$ and $\\omega_{0} = \\frac{1}{\\sqrt{LC}}$.\n\nAn infinitesimal current impulse is injected into the tank capacitor node at time $t_{0}$, corresponding to phase $\\theta_{0} = \\omega_{0} t_{0}$. The total injected charge is $\\Delta q = \\int_{t_{0}^{-}}^{t_{0}^{+}} i_{n}(t)\\,dt$, which instantaneously changes the capacitor voltage by $\\Delta v = \\Delta q/C$ while leaving the inductor current continuous across the impulse. After the oscillator’s amplitude regulation has acted, the long-term effect of the impulse is a small phase shift $\\delta\\phi(\\theta_{0})$ of the limit cycle.\n\nDefine the Impulse Sensitivity Function (ISF) $\\Gamma(\\theta)$ as the dimensionless function that relates the asymptotic phase shift to the injected charge by\n$$\\delta\\phi(\\theta) = -\\,\\Gamma(\\theta)\\,\\frac{\\Delta q}{C\\,\\hat{V}}.$$\nUsing only the following fundamental facts:\n- the constitutive relations $i_{C} = C\\,dv/dt$ and $v = L\\,di_{L}/dt$,\n- conservation of charge and the instantaneous capacitor voltage step $\\Delta v = \\Delta q/C$,\n- continuity of inductor current across the impulse,\n- a first-order amplitude–phase decomposition of the perturbed trajectory,\nderive a closed-form analytic expression for $\\Gamma(\\theta)$ for this symmetric, nearly sinusoidal oscillator. Your answer must be a single analytic expression. Additionally, based on your derivation, explain qualitatively why $|\\Gamma(\\theta)|$ attains its maximum near the zero crossings of $v(t)$, where $dv/dt$ is maximum. Provide the final expression for $\\Gamma(\\theta)$ as your answer. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the Impulse Sensitivity Function (ISF), denoted as $\\Gamma(\\theta)$, for a symmetric LC tank oscillator. The derivation will be based on analyzing the effect of an infinitesimal current impulse on the state of the oscillator.\n\nThe state of the unperturbed oscillator at any time $t$ is described by the tank voltage $v(t)$ and the inductor current $i_L(t)$. The phase is given by $\\theta = \\omega_{0} t$. The state variables are provided as:\n$$v(t) = \\hat{V}\\cos(\\theta)$$\n$$i_{L}(t) = \\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta)$$\nwhere $\\hat{V}$ is the steady-state voltage amplitude and $\\omega_{0} = \\frac{1}{\\sqrt{LC}}$ is the angular frequency of oscillation. The capacitor current is given by the constitutive relation $i_C(t) = C \\frac{dv}{dt}$.\n$$i_{C}(t) = C \\frac{d}{dt}(\\hat{V}\\cos(\\omega_{0} t)) = -C\\hat{V}\\omega_{0}\\sin(\\omega_{0} t)$$\nUsing $\\omega_{0}^2 = \\frac{1}{LC}$, we can write $C\\omega_{0} = \\frac{1}{\\omega_{0}L}$, so $i_{C}(t) = -\\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta)$. For the ideal lossless tank, Kirchhoff's current law requires $i_L(t) + i_C(t) = 0$, which is satisfied by these expressions.\n\nAn infinitesimal current impulse is injected at time $t_{0}$, corresponding to the phase $\\theta_{0} = \\omega_{0} t_{0}$. This impulse injects a total charge $\\Delta q$. We analyze the state of the system immediately before ($t=t_{0}^{-}$) and after ($t=t_{0}^{+}$) the impulse.\n\nAt $t=t_{0}^{-}$, the state is given by the unperturbed trajectory:\n$$v(t_{0}^{-}) = \\hat{V}\\cos(\\theta_0)$$\n$$i_{L}(t_{0}^{-}) = \\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta_0)$$\n\nThe problem states two key effects of the impulse:\n$1$. The inductor current is continuous, as the magnetic flux in an inductor cannot change instantaneously. Thus, $i_{L}(t_{0}^{+}) = i_{L}(t_{0}^{-})$.\n$2$. The injected charge $\\Delta q$ accumulates on the capacitor $C$ instantaneously, causing a voltage step $\\Delta v = \\Delta q/C$. Thus, $v(t_{0}^{+}) = v(t_{0}^{-}) + \\Delta v$.\n\nSo, the new state of the oscillator at $t = t_{0}^{+}$ is:\n$$v(t_{0}^{+}) = \\hat{V}\\cos(\\theta_0) + \\frac{\\Delta q}{C}$$\n$$i_{L}(t_{0}^{+}) = \\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta_0)$$\n\nThis new state corresponds to a new oscillatory trajectory with a perturbed amplitude and phase. We can express this new trajectory for $t \\ge t_{0}$ as $v_{pert}(t) = \\hat{V}'\\cos(\\omega_{0}t + \\delta\\phi)$, where $\\hat{V}'$ is the new amplitude and $\\delta\\phi$ is the asymptotic phase shift we seek. The state of this perturbed trajectory at $t=t_{0}$ must match the state $(v(t_{0}^{+}), i_{L}(t_{0}^{+}))$.\nLetting $\\hat{V}' = \\hat{V} + \\delta \\hat{V}$, the new trajectory at $t_0$ is described by:\n$$v_{pert}(t_0) = (\\hat{V} + \\delta \\hat{V})\\cos(\\theta_{0} + \\delta\\phi)$$\n$$i_{L,pert}(t_0) = \\frac{\\hat{V} + \\delta \\hat{V}}{\\omega_{0} L}\\sin(\\theta_{0} + \\delta\\phi)$$\n\nEquating the states at $t_0^+$:\n$$(1) \\quad (\\hat{V} + \\delta \\hat{V})\\cos(\\theta_{0} + \\delta\\phi) = \\hat{V}\\cos(\\theta_0) + \\frac{\\Delta q}{C}$$\n$$(2) \\quad \\frac{\\hat{V} + \\delta \\hat{V}}{\\omega_{0} L}\\sin(\\theta_{0} + \\delta\\phi) = \\frac{\\hat{V}}{\\omega_{0} L}\\sin(\\theta_0)$$\n\nSince the impulse is infinitesimal, the resulting perturbations $\\delta \\hat{V}$ and $\\delta\\phi$ are also infinitesimal. We can therefore use first-order Taylor series approximations for the trigonometric functions: $\\cos(\\theta_{0} + \\delta\\phi) \\approx \\cos(\\theta_0) - \\delta\\phi\\sin(\\theta_0)$ and $\\sin(\\theta_{0} + \\delta\\phi) \\approx \\sin(\\theta_0) + \\delta\\phi\\cos(\\theta_0)$. Substituting these into the equations and neglecting second-order terms (e.g., $\\delta\\hat{V}\\cdot\\delta\\phi$):\n\nFrom (2), we simplify first:\n$$(\\hat{V} + \\delta \\hat{V})\\sin(\\theta_{0} + \\delta\\phi) = \\hat{V}\\sin(\\theta_0)$$\n$$(\\hat{V} + \\delta \\hat{V})(\\sin(\\theta_0) + \\delta\\phi\\cos(\\theta_0)) \\approx \\hat{V}\\sin(\\theta_0)$$\n$$\\hat{V}\\sin(\\theta_0) + \\hat{V}\\delta\\phi\\cos(\\theta_0) + \\delta\\hat{V}\\sin(\\theta_0) \\approx \\hat{V}\\sin(\\theta_0)$$\n$$\\Rightarrow (2') \\quad \\delta\\hat{V}\\sin(\\theta_0) + \\hat{V}\\delta\\phi\\cos(\\theta_0) = 0$$\n\nNow for (1):\n$$(\\hat{V} + \\delta \\hat{V})(\\cos(\\theta_0) - \\delta\\phi\\sin(\\theta_0)) \\approx \\hat{V}\\cos(\\theta_0) + \\frac{\\Delta q}{C}$$\n$$\\hat{V}\\cos(\\theta_0) - \\hat{V}\\delta\\phi\\sin(\\theta_0) + \\delta\\hat{V}\\cos(\\theta_0) \\approx \\hat{V}\\cos(\\theta_0) + \\frac{\\Delta q}{C}$$\n$$\\Rightarrow (1') \\quad \\delta\\hat{V}\\cos(\\theta_0) - \\hat{V}\\delta\\phi\\sin(\\theta_0) = \\frac{\\Delta q}{C}$$\n\nWe now have a system of two linear equations for $\\delta\\hat{V}$ and $\\delta\\phi$. We are interested in solving for the phase shift $\\delta\\phi$. We can eliminate $\\delta\\hat{V}$. Multiply (1') by $\\sin(\\theta_0)$ and (2') by $\\cos(\\theta_0)$:\n$$\\delta\\hat{V}\\cos(\\theta_0)\\sin(\\theta_0) - \\hat{V}\\delta\\phi\\sin^2(\\theta_0) = \\frac{\\Delta q}{C}\\sin(\\theta_0)$$\n$$\\delta\\hat{V}\\sin(\\theta_0)\\cos(\\theta_0) + \\hat{V}\\delta\\phi\\cos^2(\\theta_0) = 0$$\nSubtracting the first new equation from the second gives:\n$$(\\hat{V}\\delta\\phi\\cos^2(\\theta_0)) - (-\\hat{V}\\delta\\phi\\sin^2(\\theta_0)) = -\\frac{\\Delta q}{C}\\sin(\\theta_0)$$\n$$\\hat{V}\\delta\\phi(\\cos^2(\\theta_0) + \\sin^2(\\theta_0)) = -\\frac{\\Delta q}{C}\\sin(\\theta_0)$$\n$$\\hat{V}\\delta\\phi = -\\frac{\\Delta q}{C}\\sin(\\theta_0)$$\nSolving for the phase shift $\\delta\\phi$ as a function of the injection phase $\\theta_0$:\n$$\\delta\\phi(\\theta_0) = -\\frac{\\sin(\\theta_0)}{\\hat{V}}\\frac{\\Delta q}{C} = -\\sin(\\theta_0)\\frac{\\Delta q}{C\\hat{V}}$$\n\nThe problem defines the Impulse Sensitivity Function $\\Gamma(\\theta)$ through the relation:\n$$\\delta\\phi(\\theta) = -\\Gamma(\\theta)\\frac{\\Delta q}{C\\hat{V}}$$\nComparing our derived expression for $\\delta\\phi(\\theta_0)$ with this definition, we can identify $\\Gamma(\\theta_0)$:\n$$-\\sin(\\theta_0)\\frac{\\Delta q}{C\\hat{V}} = -\\Gamma(\\theta_0)\\frac{\\Delta q}{C\\hat{V}}$$\nThis directly implies that the ISF, as a function of the general phase $\\theta$, is:\n$$\\Gamma(\\theta) = \\sin(\\theta)$$\n\nQualitatively, we are asked to explain why $|\\Gamma(\\theta)|$ is maximum near the zero-crossings of the voltage $v(t)$. Our result is $\\Gamma(\\theta) = \\sin(\\theta)$, so $|\\Gamma(\\theta)|$ is maximum when $|\\sin(\\theta)|=1$. This occurs at $\\theta = \\frac{\\pi}{2} + k\\pi$ for any integer $k$. At these phases, the voltage is $v(t) = \\hat{V}\\cos(\\frac{\\pi}{2} + k\\pi) = 0$. These are precisely the zero-crossings of the voltage waveform.\n\nThe physical reason can be understood by considering the oscillator's state in a phase-plane diagram with axes representing voltage $v$ and a quantity proportional to inductor current, e.g., $\\sqrt{L/C} \\, i_L$. In this normalized state space, the unperturbed trajectory is a circle. A charge impulse $\\Delta q$ perturbs the voltage by $\\Delta v=\\Delta q/C$, but leaves the inductor current unchanged. This corresponds to a perturbation vector parallel to the voltage axis. The resulting phase shift is the projection of this perturbation vector onto the direction tangential to the circular trajectory. The magnitude of this tangential projection is maximized when the perturbation vector is perpendicular to the state vector itself. The state vector is along the voltage axis at the voltage peaks ($\\theta=0, \\pi$), resulting in a purely radial (amplitude) perturbation and zero phase shift. Conversely, the state vector is perpendicular to the voltage axis at the voltage zero-crossings ($\\theta=\\pi/2, 3\\pi/2$), making the perturbation vector purely tangential and maximally effective at changing the phase. These points of maximum phase sensitivity coincide with the points where the voltage slew rate, $|dv/dt| = |-\\hat{V}\\omega_0 \\sin(\\theta)| = \\hat{V}\\omega_0|\\sin(\\theta)|$, is maximum.",
            "answer": "$$\\boxed{\\sin(\\theta)}$$"
        }
    ]
}