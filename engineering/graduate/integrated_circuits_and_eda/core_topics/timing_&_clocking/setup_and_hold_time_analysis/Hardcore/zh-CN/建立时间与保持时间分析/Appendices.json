{
    "hands_on_practices": [
        {
            "introduction": "本练习将探讨工艺偏差对时序路径延迟的核心影响。在集成电路设计中，理解不同工艺角（如最小和最大RC角）对时序的影响对于确保芯片在整个制造容差范围内可靠工作至关重要。通过这个实践 ，你将运用一阶Elmore延迟模型，从物理原理出发，量化这些工艺变化如何直接影响建立时间和保持时间的裕量。",
            "id": "4296854",
            "problem": "在电子设计自动化 (EDA) 时序分析中，一个集成电路 (IC) 内的同步流水线有一条从发送触发器到捕获触发器的单一关键数据路径。该路径的组合逻辑部分由三个逻辑级组成，各级之间由互连段分隔。互连主要表现为阻容 (RC) 特性，并呈现两个工艺角：一个最小电阻/最小电容角 (minRC) 和一个最大电阻/最大电容角 (maxRC)。目标是从物理上合理的第一性原理出发，量化minRC和maxRC之间的差异如何影响路径延迟以及由此产生的建立时间裕量和保持时间裕量。\n\n路径拓扑如下：发送触发器的输出驱动逻辑门 $\\mathrm{G1}$，$\\mathrm{G1}$ 驱动互连段 $\\mathrm{S1}$，$\\mathrm{S1}$ 驱动逻辑门 $\\mathrm{G2}$，$\\mathrm{G2}$ 驱动互连段 $\\mathrm{S2}$，$\\mathrm{S2}$ 驱动逻辑门 $\\mathrm{G3}$，$\\mathrm{G3}$ 驱动互连段 $\\mathrm{S3}$，$\\mathrm{S3}$ 的末端连接到捕获触发器的输入端。每个逻辑门 $i \\in \\{1,2,3\\}$ 都有一个内在延迟 $t_{\\mathrm{int},i}$ 和一个有效输出电阻 $R_{\\mathrm{out},i}$。每个互连段 $j \\in \\{1,2,3\\}$ 都有总电阻 $R_j$ 和总电容 $C_j$，其值取决于工艺角。每个互连段末端的接收端是下一级的输入电容，对于 $\\mathrm{G2}$ 的输入表示为 $C_{\\mathrm{in},2}$，对于 $\\mathrm{G3}$ 的输入表示为 $C_{\\mathrm{in},3}$，对于捕获触发器的输入表示为 $C_{\\mathrm{in,cap}}$。给出以下参数：\n\n- 逻辑级：$R_{\\mathrm{out},1} = 300\\,\\Omega$, $t_{\\mathrm{int},1} = 20\\,\\mathrm{ps}$；$R_{\\mathrm{out},2} = 250\\,\\Omega$, $t_{\\mathrm{int},2} = 18\\,\\mathrm{ps}$；$R_{\\mathrm{out},3} = 200\\,\\Omega$, $t_{\\mathrm{int},3} = 15\\,\\mathrm{ps}$。\n- 互连长度：$\\mathrm{S1}$ 为 $400\\,\\mu\\mathrm{m}$，$\\mathrm{S2}$ 为 $300\\,\\mu\\mathrm{m}$，$\\mathrm{S3}$ 为 $250\\,\\mu\\mathrm{m}$。\n- 互连单位长度参数：\n  - minRC: $R'_{\\min} = 0.08\\,\\Omega/\\mu\\mathrm{m}$, $C'_{\\min} = 0.18\\,\\mathrm{fF}/\\mu\\mathrm{m}$。\n  - maxRC: $R'_{\\max} = 0.12\\,\\Omega/\\mu\\mathrm{m}$, $C'_{\\max} = 0.24\\,\\mathrm{fF}/\\mu\\mathrm{m}$。\n- 由长度和单位数值推算出的段总值：\n  - minRC: $R_1 = 32\\,\\Omega$, $C_1 = 72\\,\\mathrm{fF}$；$R_2 = 24\\,\\Omega$, $C_2 = 54\\,\\mathrm{fF}$；$R_3 = 20\\,\\Omega$, $C_3 = 45\\,\\mathrm{fF}$。\n  - maxRC: $R_1 = 48\\,\\Omega$, $C_1 = 96\\,\\mathrm{fF}$；$R_2 = 36\\,\\Omega$, $C_2 = 72\\,\\mathrm{fF}$；$R_3 = 30\\,\\Omega$, $C_3 = 60\\,\\mathrm{fF}$。\n- 接收端输入电容：$C_{\\mathrm{in},2} = 12\\,\\mathrm{fF}$， $C_{\\mathrm{in},3} = 10\\,\\mathrm{fF}$， $C_{\\mathrm{in,cap}} = 8\\,\\mathrm{fF}$。\n- 时钟参数：时钟周期 $T = 1000\\,\\mathrm{ps}$；发送时钟最早到达时间 $t_{\\mathrm{clk,L}}^{\\mathrm{early}} = 0\\,\\mathrm{ps}$；发送时钟最晚到达时间 $t_{\\mathrm{clk,L}}^{\\mathrm{late}} = 20\\,\\mathrm{ps}$；捕获时钟最早到达时间 $t_{\\mathrm{clk,C}}^{\\mathrm{early}} = 30\\,\\mathrm{ps}$；捕获时钟最晚到达时间 $t_{\\mathrm{clk,C}}^{\\mathrm{late}} = 50\\,\\mathrm{ps}$；捕获触发器建立时间 $t_{\\mathrm{setup}} = 30\\,\\mathrm{ps}$；捕获触发器保持时间 $t_{\\mathrm{hold}} = 20\\,\\mathrm{ps}$；发送触发器时钟到输出时间 $t_{\\mathrm{ckq}}^{\\max} = 60\\,\\mathrm{ps}$ 和 $t_{\\mathrm{ckq}}^{\\min} = 40\\,\\mathrm{ps}$。\n\n假设互连段被建模为分布式RC网络，并使用物理上合理的一阶方法来计算到每个段远端的信号延迟，该延迟为逻辑门内在延迟与从驱动源到接收端节点的RC网络一阶矩之和。使用这些假设和所提供的参数：\n1. 计算minRC和maxRC工艺角下，从发送触发器输出到捕获触发器输入的总组合路径延迟 $t_{\\mathrm{comb},\\minRC}$ 和 $t_{\\mathrm{comb},\\maxRC}$。\n2. 根据建立和保持时序约束的基本定义，计算每个工艺角下的建立时间裕量和保持时间裕量。\n3. 确定建立时间裕量的变化（maxRC减去minRC）和保持时间裕量的变化（maxRC减去minRC）。最后，报告这些变化量绝对值的比率，即 $\\left|\\Delta \\text{setup slack}\\right| / \\left|\\Delta \\text{hold slack}\\right|$。\n\n将最终比率表示为无量纲数。将最终答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于数字电路时序分析的原理，问题提出得当，所有必要参数均已提供，并且其表述是客观的。我们可以进行正式的求解。\n\n该问题要求计算在两种不同工艺角（minRC和maxRC）下的组合路径延迟、相应的建立时间裕量和保持时间裕量，以及最后计算这些裕量在两种工艺角之间的变化比率。\n\n首先，我们建立组合路径延迟的模型。该路径包含三个级，每一级由一个逻辑门和一个分布式RC互连段组成。问题指定使用基于冲激响应一阶矩的一阶方法，这对应于Elmore延迟模型。组合路径的总延迟 $t_{\\mathrm{comb}}$ 是这三个级延迟的总和。\n\n驱动互连段 $j$ 的单个级 $i$ 的延迟，记为 $t_{\\mathrm{stage},i}$，是逻辑门的内在延迟 $t_{\\mathrm{int},i}$ 与互连相关的RC延迟 $t_{\\mathrm{RC},j}$ 之和。\n$t_{\\mathrm{stage},i} = t_{\\mathrm{int},i} + t_{\\mathrm{RC},j}$\n\n一个由输出电阻为 $R_{\\mathrm{out},i}$ 的源驱动、并由电容 $C_{\\mathrm{load}}$ 加载的分布式RC线（总电阻为 $R_j$，总电容为 $C_j$）的Elmore延迟为：\n$$t_{\\mathrm{RC},j} = R_{\\mathrm{out},i}(C_j + C_{\\mathrm{load}}) + \\frac{1}{2}R_j C_j + R_j C_{\\mathrm{load}}$$\n单位必须保持一致。给定电阻单位为 $\\Omega$，电容单位为 $\\mathrm{fF}$，则乘积 $R \\cdot C$ 的单位为 $\\Omega \\cdot \\mathrm{fF}$，其中 $1\\,\\Omega \\cdot 1\\,\\mathrm{fF} = 10^{-15}\\,\\mathrm{s} = 10^{-3}\\,\\mathrm{ps}$。因此，所有的 $R \\cdot C$ 乘积都将除以 $1000$，以得到单位为皮秒 ($\\mathrm{ps}$) 的延迟。\n\n总组合路径延迟为：\n$$t_{\\mathrm{comb}} = t_{\\mathrm{stage},1} + t_{\\mathrm{stage},2} + t_{\\mathrm{stage},3}$$\n- 第1级：逻辑门 G1 驱动互连段 S1 到逻辑门 G2。$i=1$, $j=1$, $C_{\\mathrm{load}} = C_{\\mathrm{in},2}$。\n$$t_{\\mathrm{stage},1} = t_{\\mathrm{int},1} + \\frac{1}{1000} \\left( R_{\\mathrm{out},1}(C_1 + C_{\\mathrm{in},2}) + \\frac{1}{2}R_1C_1 + R_1C_{\\mathrm{in},2} \\right)$$\n- 第2级：逻辑门 G2 驱动互连段 S2 到逻辑门 G3。$i=2$, $j=2$, $C_{\\mathrm{load}} = C_{\\mathrm{in},3}$。\n$$t_{\\mathrm{stage},2} = t_{\\mathrm{int},2} + \\frac{1}{1000} \\left( R_{\\mathrm{out},2}(C_2 + C_{\\mathrm{in},3}) + \\frac{1}{2}R_2C_2 + R_2C_{\\mathrm{in},3} \\right)$$\n- 第3级：逻辑门 G3 驱动互连段 S3 到捕获触发器。$i=3$, $j=3$, $C_{\\mathrm{load}} = C_{\\mathrm{in,cap}}$。\n$$t_{\\mathrm{stage},3} = t_{\\mathrm{int},3} + \\frac{1}{1000} \\left( R_{\\mathrm{out},3}(C_3 + C_{\\mathrm{in,cap}}) + \\frac{1}{2}R_3C_3 + R_3C_{\\mathrm{in,cap}} \\right)$$\n\n**步骤1：计算每个RC工艺角的总组合路径延迟。**\n\n**A. minRC工艺角计算：**\n使用minRC参数：\n- 第1级 ($R_{\\mathrm{out},1}=300\\,\\Omega$, $t_{\\mathrm{int},1}=20\\,\\mathrm{ps}$, $R_1=32\\,\\Omega$, $C_1=72\\,\\mathrm{fF}$, $C_{\\mathrm{in},2}=12\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},1,\\minRC} = 20 + \\frac{1}{1000} \\left( 300(72+12) + \\frac{1}{2}(32)(72) + 32(12) \\right) = 20 + \\frac{25200 + 1152 + 384}{1000} = 20 + 26.736 = 46.736\\,\\mathrm{ps}$。\n- 第2级 ($R_{\\mathrm{out},2}=250\\,\\Omega$, $t_{\\mathrm{int},2}=18\\,\\mathrm{ps}$, $R_2=24\\,\\Omega$, $C_2=54\\,\\mathrm{fF}$, $C_{\\mathrm{in},3}=10\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},2,\\minRC} = 18 + \\frac{1}{1000} \\left( 250(54+10) + \\frac{1}{2}(24)(54) + 24(10) \\right) = 18 + \\frac{16000 + 648 + 240}{1000} = 18 + 16.888 = 34.888\\,\\mathrm{ps}$。\n- 第3级 ($R_{\\mathrm{out},3}=200\\,\\Omega$, $t_{\\mathrm{int},3}=15\\,\\mathrm{ps}$, $R_3=20\\,\\Omega$, $C_3=45\\,\\mathrm{fF}$, $C_{\\mathrm{in,cap}}=8\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},3,\\minRC} = 15 + \\frac{1}{1000} \\left( 200(45+8) + \\frac{1}{2}(20)(45) + 20(8) \\right) = 15 + \\frac{10600 + 450 + 160}{1000} = 15 + 11.210 = 26.210\\,\\mathrm{ps}$。\n\nminRC的总组合延迟：\n$t_{\\mathrm{comb},\\minRC} = 46.736 + 34.888 + 26.210 = 107.834\\,\\mathrm{ps}$。\n\n**B. maxRC工艺角计算：**\n使用maxRC参数：\n- 第1级 ($R_1=48\\,\\Omega$, $C_1=96\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},1,\\maxRC} = 20 + \\frac{1}{1000} \\left( 300(96+12) + \\frac{1}{2}(48)(96) + 48(12) \\right) = 20 + \\frac{32400 + 2304 + 576}{1000} = 20 + 35.280 = 55.280\\,\\mathrm{ps}$。\n- 第2级 ($R_2=36\\,\\Omega$, $C_2=72\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},2,\\maxRC} = 18 + \\frac{1}{1000} \\left( 250(72+10) + \\frac{1}{2}(36)(72) + 36(10) \\right) = 18 + \\frac{20500 + 1296 + 360}{1000} = 18 + 22.156 = 40.156\\,\\mathrm{ps}$。\n- 第3级 ($R_3=30\\,\\Omega$, $C_3=60\\,\\mathrm{fF}$):\n$t_{\\mathrm{stage},3,\\maxRC} = 15 + \\frac{1}{1000} \\left( 200(60+8) + \\frac{1}{2}(30)(60) + 30(8) \\right) = 15 + \\frac{13600 + 900 + 240}{1000} = 15 + 14.740 = 29.740\\,\\mathrm{ps}$。\n\nmaxRC的总组合延迟：\n$t_{\\mathrm{comb},\\maxRC} = 55.280 + 40.156 + 29.740 = 125.176\\,\\mathrm{ps}$。\n\n**步骤2：计算每个工艺角的建立和保持裕量。**\n\n建立和保持裕量方程是同步时序分析的基础。\n建立时间要求确保数据在被捕获需要之前到达：\n$$ \\text{建立时间裕量} = (\\text{捕获时间})_{\\text{要求}} - (\\text{数据到达时间})_{\\text{实际}} $$\n$$ \\text{Setup Slack} = (T + t_{\\mathrm{clk,C}}^{\\mathrm{late}} - t_{\\mathrm{setup}}) - (t_{\\mathrm{clk,L}}^{\\mathrm{late}} + t_{\\mathrm{ckq}}^{\\max} + t_{\\mathrm{comb}}) $$\n保持时间要求确保数据在捕获后不会过早改变：\n$$ \\text{保持时间裕量} = (\\text{数据到达时间})_{\\text{实际}} - (\\text{捕获时间})_{\\text{要求}} $$\n$$ \\text{Hold Slack} = (t_{\\mathrm{clk,L}}^{\\mathrm{early}} + t_{\\mathrm{ckq}}^{\\min} + t_{\\mathrm{comb}}) - (t_{\\mathrm{clk,C}}^{\\mathrm{early}} + t_{\\mathrm{hold}}) $$\n问题要求计算每个工艺角的裕量，我们按以下步骤进行。\n\n**A. 建立时间裕量计算：**\n建立时间裕量方程中的常数部分为：\n$K_{\\mathrm{setup}} = T + t_{\\mathrm{clk,C}}^{\\mathrm{late}} - t_{\\mathrm{setup}} - t_{\\mathrm{clk,L}}^{\\mathrm{late}} - t_{\\mathrm{ckq}}^{\\max} = 1000 + 50 - 30 - 20 - 60 = 940\\,\\mathrm{ps}$。\n所以，$\\text{Setup Slack} = 940 - t_{\\mathrm{comb}}$。\n\n- minRC下的建立时间裕量：\n$\\text{Setup Slack}_{\\minRC} = 940 - t_{\\mathrm{comb},\\minRC} = 940 - 107.834 = 832.166\\,\\mathrm{ps}$。\n- maxRC下的建立时间裕量：\n$\\text{Setup Slack}_{\\maxRC} = 940 - t_{\\mathrm{comb},\\maxRC} = 940 - 125.176 = 814.824\\,\\mathrm{ps}$。\n\n**B. 保持时间裕量计算：**\n保持时间裕量方程中的常数部分为：\n$K_{\\mathrm{hold}} = t_{\\mathrm{clk,C}}^{\\mathrm{early}} + t_{\\mathrm{hold}} - t_{\\mathrm{clk,L}}^{\\mathrm{early}} - t_{\\mathrm{ckq}}^{\\min} = 30 + 20 - 0 - 40 = 10\\,\\mathrm{ps}$。\n所以，$\\text{Hold Slack} = t_{\\mathrm{comb}} - K_{\\mathrm{hold}} = t_{\\mathrm{comb}} - 10$。\n\n- minRC下的保持时间裕量：\n$\\text{Hold Slack}_{\\minRC} = t_{\\mathrm{comb},\\minRC} - 10 = 107.834 - 10 = 97.834\\,\\mathrm{ps}$。\n- maxRC下的保持时间裕量：\n$\\text{Hold Slack}_{\\maxRC} = t_{\\mathrm{comb},\\maxRC} - 10 = 125.176 - 10 = 115.176\\,\\mathrm{ps}$。\n\n**步骤3：确定裕量的变化及其比率。**\n\n裕量的变化定义为maxRC工艺角下的值减去minRC工艺角下的值。\n\n- 建立时间裕量的变化：\n$\\Delta \\text{Setup Slack} = \\text{Setup Slack}_{\\maxRC} - \\text{Setup Slack}_{\\minRC} = 814.824 - 832.166 = -17.342\\,\\mathrm{ps}$。\n从公式来看，这是 $(940 - t_{\\mathrm{comb},\\maxRC}) - (940 - t_{\\mathrm{comb},\\minRC}) = t_{\\mathrm{comb},\\minRC} - t_{\\mathrm{comb},\\maxRC}$。\n$107.834 - 125.176 = -17.342\\,\\mathrm{ps}$。 这是一致的。\n\n- 保持时间裕量的变化：\n$\\Delta \\text{Hold Slack} = \\text{Hold Slack}_{\\maxRC} - \\text{Hold Slack}_{\\minRC} = 115.176 - 97.834 = 17.342\\,\\mathrm{ps}$。\n从公式来看，这是 $(t_{\\mathrm{comb},\\maxRC} - 10) - (t_{\\mathrm{comb},\\minRC} - 10) = t_{\\mathrm{comb},\\maxRC} - t_{\\mathrm{comb},\\minRC}$。\n$125.176 - 107.834 = 17.342\\,\\mathrm{ps}$。 这是一致的。\n\n我们观察到 $\\Delta \\text{Setup Slack} = - \\Delta \\text{Hold Slack}$。这是组合路径延迟 $t_{\\mathrm{comb}}$ 如何影响每个裕量指标的直接结果。路径延迟的增加（从minRC到maxRC）会降低建立时间裕度，但会以完全相同的量改善保持时间裕度，前提是所有其他时序参数都保持不变。\n\n最后，我们计算这些变化量绝对值的比率：\n$$ \\text{Ratio} = \\frac{\\left|\\Delta \\text{Setup Slack}\\right|}{\\left|\\Delta \\text{Hold Slack}\\right|} = \\frac{|-17.342\\,\\mathrm{ps}|}{|17.342\\,\\mathrm{ps}|} = \\frac{17.342}{17.342} = 1 $$\n精确结果是 $1$。问题要求答案四舍五入到四位有效数字，即 $1.000$。",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "在掌握了基本路径分析之后，我们将转向一个更高级的主题：如何处理设计意图与时序分析的结合。并非所有的数据路径都设计为在单个时钟周期内完成传输，此时就需要运用多周期路径（multicycle path）的分析方法。此练习  将指导你处理一个典型的双周期路径场景，要求你正确地修改建立时间约束方程，并理解如何在静态时序分析（STA）工具中设置相应的指令。",
            "id": "4296865",
            "problem": "互补金属氧化物半导体（CMOS）数字集成电路中的一个同步流水线由单一时钟域驱动。发射寄存器 $R_{\\text{L}}$ 和捕获寄存器 $R_{\\text{C}}$ 由同一上升沿时钟驱动。由于一个协议保证数据在 $R_{\\text{C}}$ 处每隔一个周期才被采样一次，从 $R_{\\text{L}}$ 到 $R_{\\text{C}}$ 的路径被设计为双周期路径；这一设计意图必须在静态时序分析（STA）中得到体现。\n\n时钟周期 $T = 1.0\\,\\text{ns}$，用于建立时间分析的源时钟不确定性为 $U_{\\text{setup}} = 0.05\\,\\text{ns}$。传播到寄存器时钟引脚的时钟延迟对于发射寄存器为 $L_{\\text{L}} = 0.35\\,\\text{ns}$，对于捕获寄存器为 $L_{\\text{C}} = 0.42\\,\\text{ns}$。发射寄存器的最大时钟到Q端延迟为 $t_{\\text{cq,max}} = 0.08\\,\\text{ns}$。从 $R_{\\text{L}}$ 到 $R_{\\text{C}}$ 的数据路径包含逻辑和互连，其最大延迟分别为 $D_{\\text{logic,max}} = 1.65\\,\\text{ns}$ 和 $D_{\\text{wire,max}} = 0.22\\,\\text{ns}$。捕获寄存器的建立时间为 $t_{\\text{setup}} = 0.09\\,\\text{ns}$。\n\n假设给定的延迟和延时已经包含了适用于建立时间分析的慢角降额，并且时钟不确定性 $U_{\\text{setup}}$ 作为满足建立时间可用时间预算的减少量（代表了组合抖动和建模不确定性）被应用。忽略任何公共路径悲观度移除效应和任何跨角相关性。\n\n从定义建立时序的基本原理出发——即数据必须在有效捕获沿之前至少 $t_{\\text{setup}}$ 时间在捕获寄存器处保持稳定，并且STA会比较最晚数据到达时间和最晚要求捕获时间——推导在正确的多周期解释下，此双周期路径的建立时间裕量。在您的推导中，请仔细论证双周期意图如何改变相对于发射沿的要求捕获沿时间，以及时钟延迟和不确定性如何进入比较。\n\n然后，陈述为在此点对点路径上反映双周期意图并保持正确的保持分析一致性所必需的STA约束变更。您可以在约束中命名寄存器 $R_{\\text{L}}$ 和 $R_{\\text{C}}$。\n\n计算在双周期解释下此路径的建立时间裕量的数值。以纳秒为单位表示最终的建立时间裕量，并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导和计算同步数字电路中双周期路径的建立时间裕量，并描述必要的静态时序分析（STA）约束。\n\n首先，我们建立建立时间裕量的基本方程，它被定义为数据在捕获寄存器输入端的要求到达时间（RAT）与实际数据到达时间（DAT）之间的差值。\n$$\nS_{\\text{setup}} = \\text{RAT} - \\text{DAT}\n$$\n正裕量表示满足时序约束，而负裕量表示违例。我们将从基本原理出发，考虑所有指定参数，推导RAT和DAT的表达式。假设从寄存器 $R_{\\text{L}}$ 发射数据的源时钟上升沿发生在时间 $t=0$。\n\n数据到达时间（DAT）是信号从发射寄存器 $R_{\\text{L}}$ 的时钟引脚传播到捕获寄存器 $R_{\\text{C}}$ 的数据输入引脚所需的时间。\n源于 $t=0$ 的时钟信号，在经过 $L_{\\text{L}}$ 的延迟后到达发射寄存器 $R_{\\text{L}}$ 的时钟引脚。因此，发射沿在寄存器处发生的时间为 $t_1 = L_{\\text{L}}$。\n在此时钟沿之后，数据在经过最大时钟到Q端延迟 $t_{\\text{cq,max}}$ 后在 $R_{\\text{L}}$ 的输出端（Q引脚）可用。数据从 $R_{\\text{L}}$ 发射的时间是 $t_2 = L_{\\text{L}} + t_{\\text{cq,max}}$。\n该数据随后必须通过组合逻辑路径和互连布线传播，以到达捕获寄存器 $R_{\\text{C}}$ 的输入端（D引脚）。此数据路径的最大延迟是最大逻辑延迟 $D_{\\text{logic,max}}$ 和最大布线延迟 $D_{\\text{wire,max}}$ 的总和。\n因此，数据到达 $R_{\\text{C}}$ 输入端的最晚时间是：\n$$\n\\text{DAT} = L_{\\text{L}} + t_{\\text{cq,max}} + D_{\\text{logic,max}} + D_{\\text{wire,max}}\n$$\n\n要求到达时间（RAT）是数据能够到达 $R_{\\text{C}}$ 输入端并仍能被正确捕获的最晚时间。这由捕获时钟沿的时序决定。\n对于标准的单周期路径，捕获沿将是发射后的下一个时钟上升沿。在时钟源处，这将发生在时间 $T$。然而，问题指定的是一个双周期路径。这意味着在 $t=0$ 发射的数据，其意图不是在下一个时钟周期被捕获，而是在那之后的下一个周期。\n因此，在时钟源处的预期捕获沿发生在时间 $t=2T$。\n此时钟沿传播到捕获寄存器 $R_{\\text{C}}$，在时间 $t_3 = 2T + L_{\\text{C}}$ 到达其时钟引脚。这是寄存器处的有效捕获沿时间。\n为了成功捕获， $R_{\\text{C}}$ 输入端的数据必须在捕获沿到达*之前*稳定至少建立时间 $t_{\\text{setup}}$ 的时长。这意味着数据必须在不晚于 $t_3 - t_{\\text{setup}}$ 到达。\n此外，问题指定了用于建立时间分析的源时钟不确定性 $U_{\\text{setup}}$，这会减少可用的时间预算。这个不确定性项会从可用时间中减去，从而有效地使要求到达时间提前。\n因此，在 $R_{\\text{C}}$ 输入端的要求到达时间是：\n$$\n\\text{RAT} = (2T + L_{\\text{C}}) - t_{\\text{setup}} - U_{\\text{setup}}\n$$\n\n现在，我们可以结合RAT和DAT的表达式来求建立时间裕量 $S_{\\text{setup}}$：\n$$\nS_{\\text{setup}} = \\text{RAT} - \\text{DAT} = (2T + L_{\\text{C}} - t_{\\text{setup}} - U_{\\text{setup}}) - (L_{\\text{L}} + t_{\\text{cq,max}} + D_{\\text{logic,max}} + D_{\\text{wire,max}})\n$$\n重新排列各项可以突出时序路径的各个组成部分：\n$$\nS_{\\text{setup}} = 2T + (L_{\\text{C}} - L_{\\text{L}}) - t_{\\text{cq,max}} - (D_{\\text{logic,max}} + D_{\\text{wire,max}}) - t_{\\text{setup}} - U_{\\text{setup}}\n$$\n这里，项 $(L_{\\text{C}} - L_{\\text{L}})$ 代表捕获和发射寄存器之间的时钟偏斜。\n\n为了在STA工具中正确约束此路径，必须覆盖默认的单周期行为。使用 `set_multicycle_path` 命令（或在特定工具语法中的等效命令）。\n对于建立时间分析，路径被指定为占用 $2$ 个周期。这会指示工具在建立时间检查的所需时间计算中增加一个额外的时钟周期。该命令将是：\n`set_multicycle_path 2 -setup -from R_L -to R_C`\n为建立时间定义多周期路径对保持分析有影响。默认的保持检查发生在与发射相同的时钟沿（一个 $0$ 周期检查）。放宽建立时间要求允许数据更晚到达，这可能导致它干扰下一个数据转换的捕获。然而，对于多周期路径，默认的保持检查通常过于严格。对于一个 $N$ 周期的建立路径，标准做法是将保持检查移动到 $N-1$ 个周期之后。对于这个 $N=2$ 的建立路径，保持检查应该在发射沿之后一个周期执行。这通过以下约束实现：\n`set_multicycle_path 1 -hold -from R_L -to R_C`\n\n最后，我们使用提供的值计算建立时间裕量的数值：\n时钟周期：$T = 1.0\\,\\text{ns}$\n发射时钟延迟：$L_{\\text{L}} = 0.35\\,\\text{ns}$\n捕获时钟延迟：$L_{\\text{C}} = 0.42\\,\\text{ns}$\n最大时钟到Q端延迟：$t_{\\text{cq,max}} = 0.08\\,\\text{ns}$\n最大逻辑延迟：$D_{\\text{logic,max}} = 1.65\\,\\text{ns}$\n最大布线延迟：$D_{\\text{wire,max}} = 0.22\\,\\text{ns}$\n建立时间：$t_{\\text{setup}} = 0.09\\,\\text{ns}$\n建立时间时钟不确定性：$U_{\\text{setup}} = 0.05\\,\\text{ns}$\n\n总数据路径延迟为 $D_{\\text{path,max}} = D_{\\text{logic,max}} + D_{\\text{wire,max}} = 1.65\\,\\text{ns} + 0.22\\,\\text{ns} = 1.87\\,\\text{ns}$。\n数据到达时间是：\n$$\n\\text{DAT} = 0.35\\,\\text{ns} + 0.08\\,\\text{ns} + 1.87\\,\\text{ns} = 2.30\\,\\text{ns}\n$$\n要求到达时间是：\n$$\n\\text{RAT} = (2 \\times 1.0\\,\\text{ns} + 0.42\\,\\text{ns}) - 0.09\\,\\text{ns} - 0.05\\,\\text{ns} = 2.42\\,\\text{ns} - 0.14\\,\\text{ns} = 2.28\\,\\text{ns}\n$$\n建立时间裕量是：\n$$\nS_{\\text{setup}} = \\text{RAT} - \\text{DAT} = 2.28\\,\\text{ns} - 2.30\\,\\text{ns} = -0.02\\,\\text{ns}\n$$\n计算得出一个负裕量，这表示一个建立时序违例。为了按要求用三位有效数字表示，我们将结果写成科学记数法。\n$$\nS_{\\text{setup}} = -2.00 \\times 10^{-2}\\,\\text{ns}\n$$",
            "answer": "$$\n\\boxed{-2.00 \\times 10^{-2}}\n$$"
        },
        {
            "introduction": "本练习旨在深入剖析静态时序分析（STA）工具的内在复杂性，特别是它如何处理具有信号重汇聚（reconvergence）的复杂拓扑结构。对这类路径进行简单的独立分析会导致过度悲观的结果，从而浪费芯片的性能和面积。通过本练习 ，你将通过对比基于图的分析（Graph-Based Analysis）和更精确的基于路径的分析（Path-Based Analysis），亲手计算并量化由共同路径悲观（Common Path Pessimism）所引入的误差。",
            "id": "4296838",
            "problem": "一个同步互补金属氧化物半导体（CMOS）流水线由一个理想时钟源驱动，并在片上变异（OCV）条件下进行分析。发射和捕获时钟树先再汇合，然后分叉到各自的触发器。从发射触发器输出到捕获触发器输入的数据路径仅包含如下所述的组合逻辑和连线。目标是使用两种静态时序分析的解释方法来评估最坏情况下的建立时间时序：一种是基于图的分析，另一种是应用了公共路径悲观度移除（CPPR）的基于路径的分析。仅使用到达时间、需要时间、建立时间约束和用于建立时间检查的OCV极性的定义来推导时序量。\n\n时钟网络拓扑和标称段延迟：\n- 发射和捕获树共享的公共时钟段：\n  - 段 $C_{0}$：$101$ ps。\n  - 段 $C_{1}$：$119$ ps。\n- 仅发射段：\n  - 段 $L_{2}$：$82$ ps。\n- 仅捕获段：\n  - 段 $C_{3}$：$91$ ps。\n\n从发射触发器数据输出到捕获触发器数据输入的数据路径拓扑和标称段延迟：\n- 发射触发器时钟到Q端延迟 $t_{cq}$：$79$ ps。\n- 门 $D_{1}$：$151$ ps。\n- 门 $D_{2}$：$139$ ps。\n- 连线 $N_{12}$：$61$ ps。\n- 门 $D_{3}$：$133$ ps。\n\n操作约束：\n- 时钟周期 $T$：$1000$ ps。\n- 捕获触发器的建立时间 $t_{setup}$：$60$ ps。\n- 时钟不确定度，作为建立时间的减法裕量处理：$30$ ps。\n- 在建立时间检查下，针对最大（晚）数据和发射时钟以及最小（早）捕获时钟的OCV策略：\n  - 对任何时钟段，晚路径使用$+10\\%$，早路径使用$-10\\%$。\n  - 对任何数据段（包括门和连线），晚路径（最大）使用$+10\\%$。\n\n假设：\n- 时钟源是理想的，并定义了时间零点。\n- 逻辑是单周期的：由一个时钟边沿发射的数据必须在下一个时钟边沿被捕获。\n- 转换率和负载依赖性已被包含在给定的标称延迟中。\n- 所述的再汇合是指共享的公共时钟路径 $C_{0}$ 和 $C_{1}$；您必须在基于路径的解释中，通过移除由公共时钟段引起的悲观度来正确地考虑其影响。\n\n任务：\n1. 计算基于图的建立时间裕量，将发射时钟视为晚路径，捕获时钟视为早路径，数据路径视为晚路径，OCV独立应用于所有段，并且不对时钟再汇合应用公共路径悲观度移除。\n2. 通过对共享时钟段 $C_{0}$ 和 $C_{1}$ 应用公共路径悲观度移除，计算基于路径的建立时间裕量。\n3. 将悲观度差距量化为基于路径的建立时间裕量与基于图的建立时间裕量之差。\n\n所有三个结果都以皮秒为单位表示。将您的答案四舍五入到四位有效数字。最终答案必须是一个单行矩阵，按顺序包含基于图的建立时间裕量、基于路径的建立时间裕量和悲观度差距。",
            "solution": "该问题经验证在科学上是合理的、定义明确的、客观且完整的。进行片上变异（OCV）下的建立时间时序分析所需的所有数据均已提供，任务也已明确定义。我将开始解答。\n\n建立时间裕量的基本方程是捕获触发器数据输入端数据信号的需要到达时间（RAT）与实际到达时间（AAT）之差。\n$$\n\\text{裕量} = \\text{RAT} - \\text{AAT}\n$$\n对于建立时间检查，我们必须考虑最坏情况：数据尽可能晚地到达，而捕获时钟边沿尽可能早地到达。这需要应用OCV降额因子来最大化AAT并最小化RAT中的捕获时钟路径延迟分量。\n\n给定的建立时间检查的OCV策略是：\n- 晚路径（数据和发射时钟）：标称延迟增加$+10\\%$。降额因子为 $d_{late} = 1 + 0.10 = 1.1$。\n- 早路径（捕获时钟）：标称延迟减少$-10\\%$。降额因子为 $d_{early} = 1 - 0.10 = 0.9$。\n\n实际数据到达时间（AAT）是发射时钟路径延迟、发射触发器的时钟到Q端延迟（$t_{cq}$）和组合数据路径延迟的总和。对于最坏情况的建立时间检查，所有这些路径都被视为晚路径。\n$$\n\\text{AAT} = (\\text{发射时钟路径延迟})_{\\text{晚}} + (t_{cq})_{\\text{晚}} + (\\text{组合逻辑延迟})_{\\text{晚}}\n$$\n需要数据到达时间（RAT）由捕获时钟边沿决定，并根据触发器的建立时间（$t_{setup}$）和任何时钟不确定度（$t_{uncertainty}$）进行调整。对于最坏情况的建立时间检查，捕获时钟路径被视为早路径。\n$$\n\\text{RAT} = (\\text{捕获时钟路径延迟})_{\\text{早}} + T - t_{setup} - t_{uncertainty}\n$$\n其中 $T$ 是时钟周期。\n\n让我们根据提供的段延迟定义标称路径延迟：\n- 标称发射时钟路径延迟 ($t_{LCP,nom}$): $C_0 \\rightarrow C_1 \\rightarrow L_2$\n$$\nt_{LCP,nom} = C_0 + C_1 + L_2 = 101 \\text{ ps} + 119 \\text{ ps} + 82 \\text{ ps} = 302 \\text{ ps}\n$$\n- 标称数据路径延迟 ($t_{DP,nom}$)，包括触发器的内部延迟 $t_{cq}$ 和外部组合逻辑：\n$$\nt_{DP,nom} = t_{cq} + D_1 + N_{12} + D_2 + D_3 = 79 + 151 + 61 + 139 + 133 = 563 \\text{ ps}\n$$\n- 标称捕获时钟路径延迟 ($t_{CCP,nom}$): $C_0 \\rightarrow C_1 \\rightarrow C_3$\n$$\nt_{CCP,nom} = C_0 + C_1 + C_3 = 101 \\text{ ps} + 119 \\text{ ps} + 91 \\text{ ps} = 311 \\text{ ps}\n$$\n\n### 任务1：基于图的建立时间裕量\n在基于图的分析（GBA）中，OCV降额被独立地应用于整个发射和捕获时钟路径，即使在共享段上也是如此。这引入了一个悲观的假设，即路径的公共部分对于发射事件可以同时是慢的，而对于捕获事件同时是快的。\n\n首先，我们计算最坏情况（晚）的AAT：\n$$\n\\text{AAT}_{\\text{graph}} = (t_{LCP,nom} \\times d_{late}) + (t_{DP,nom} \\times d_{late})\n$$\n$$\n\\text{AAT}_{\\text{graph}} = (302 \\text{ ps} \\times 1.1) + (563 \\text{ ps} \\times 1.1) = 332.2 \\text{ ps} + 619.3 \\text{ ps} = 951.5 \\text{ ps}\n$$\n接下来，我们计算最好情况（早）的RAT：\n$$\n\\text{RAT}_{\\text{graph}} = (t_{CCP,nom} \\times d_{early}) + T - t_{setup} - t_{uncertainty}\n$$\n$$\n\\text{RAT}_{\\text{graph}} = (311 \\text{ ps} \\times 0.9) + 1000 \\text{ ps} - 60 \\text{ ps} - 30 \\text{ ps} = 279.9 \\text{ ps} + 910 \\text{ ps} = 1189.9 \\text{ ps}\n$$\n现在，我们计算基于图的建立时间裕量：\n$$\n\\text{Slack}_{\\text{graph}} = \\text{RAT}_{\\text{graph}} - \\text{AAT}_{\\text{graph}} = 1189.9 \\text{ ps} - 951.5 \\text{ ps} = 238.4 \\text{ ps}\n$$\n\n### 任务2：基于路径的建立时间裕量\n基于路径的分析（PBA）更准确，因为它认识到单个物理路径段在同一时刻不能既快又慢。它通过公共路径悲观度移除（CPPR）消除了在GBA中引入的人为悲观度。这种悲观度源于对发射和捕获触发器共有的时钟路径段应用相反的降额因子（$d_{late}$ 和 $d_{early}$）。\n\n公共时钟路径由段 $C_0$ 和 $C_1$ 组成。其标称延迟为：\n$$\nt_{common,nom} = C_0 + C_1 = 101 \\text{ ps} + 119 \\text{ ps} = 220 \\text{ ps}\n$$\n需要移除的悲观量，称为CPPR裕量（credit），是该公共路径延迟的晚路径计算和早路径计算之间的差值：\n$$\n\\text{CPPR}_{\\text{credit}} = (t_{common,nom} \\times d_{late}) - (t_{common,nom} \\times d_{early}) = t_{common,nom} \\times (d_{late} - d_{early})\n$$\n$$\n\\text{CPPR}_{\\text{credit}} = 220 \\text{ ps} \\times (1.1 - 0.9) = 220 \\text{ ps} \\times 0.2 = 44 \\text{ ps}\n$$\n这个裕量被加到基于图的裕量上，以获得更真实的基于路径的裕量：\n$$\n\\text{Slack}_{\\text{path}} = \\text{Slack}_{\\text{graph}} + \\text{CPPR}_{\\text{credit}}\n$$\n$$\n\\text{Slack}_{\\text{path}} = 238.4 \\text{ ps} + 44 \\text{ ps} = 282.4 \\text{ ps}\n$$\n\n### 任务3：悲观度差距\n悲观度差距定义为基于路径的建立时间裕量与基于图的建立时间裕量之差。这个量恰好是计算并移除的CPPR裕量。\n$$\n\\text{Pessimism Gap} = \\text{Slack}_{\\text{path}} - \\text{Slack}_{\\text{graph}}\n$$\n$$\n\\text{Pessimism Gap} = 282.4 \\text{ ps} - 238.4 \\text{ ps} = 44 \\text{ ps}\n$$\n\n所需的三个量，四舍五入到四位有效数字，分别是：\n- 基于图的建立时间裕量：$238.4$ ps\n- 基于路径的建立时间裕量：$282.4$ ps\n- 悲观度差距：$44.00$ ps（为保持一致性，用四位有效数字表示）",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n238.4  282.4  44.00\n\\end{pmatrix}\n}\n$$"
        }
    ]
}