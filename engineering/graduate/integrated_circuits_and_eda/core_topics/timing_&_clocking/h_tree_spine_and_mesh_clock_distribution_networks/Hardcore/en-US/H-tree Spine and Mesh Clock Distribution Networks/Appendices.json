{
    "hands_on_practices": [
        {
            "introduction": "Understanding interconnect delay is fundamental to high-speed digital design. This first practice challenges you to derive the Elmore delay, a cornerstone of timing analysis, directly from its definition as the first moment of the impulse response. By working through this resistive-capacitive ($RC$) tree model, you will gain a deep, analytical appreciation for how path resistance and the capacitance of both the main path and its sibling branches contribute to the total delay at a sink .",
            "id": "4274828",
            "problem": "A balanced hierarchical clock distribution based on an H-tree with a local mesh tie is used to drive synchronous sinks on a large integrated circuit. Consider one branch of the H-tree that feeds a sink at node $S$ while a sibling branch at node $B$ taps off at an upstream branching node. The driver is modeled by its Thevenin resistance $R_{s}$ driving a resistive-capacitive (RC) tree. All interconnect capacitances, buffer input capacitances, and sink loads are modeled as capacitors to ground at the corresponding nodes. The topology and parameters are as follows, with all components strictly positive:\n- Source (driver) node connected through series resistance $R_{s}$ to node $0$.\n- From node $0$, a series wire segment of resistance $R_{1}$ leads to branching node $1$. The shunt capacitance to ground at node $1$ (representing the distributed capacitance of segment $R_{1}$ and any local buffer input at node $1$) is $C_{1}$.\n- From node $1$, the main path toward the target sink $S$ passes through a series wire segment of resistance $R_{2}$ to node $2$. The shunt capacitance to ground at node $2$ is $C_{2}$, and an additional shunt capacitance $C_{m}$ at node $2$ models the local mesh tie-in.\n- From node $2$, a final series wire segment of resistance $R_{3}$ leads to the sink node $3 \\equiv S$. The shunt capacitance to ground at node $3$ is $C_{3}$, and the sink load at $S$ is $C_{L}$.\n- From node $1$, a sibling branch toward sink $B$ consists of a series resistance $R_{b}$ to node $b$, which has shunt capacitance $C_{b}$ (representing wire and sink load on the sibling branch).\nAssume the network is linear and time-invariant and that the driver applies a step input of sufficiently fast rise time so that the resistive-capacitive (RC) dynamics dominate the insertion delay. Define the insertion delay $t_{\\mathrm{ins}}(S)$ at sink $S$ as the first moment of the sink’s impulse response, i.e., the standard Elmore delay for RC trees.\nUsing only fundamental properties of linear RC networks and the first-moment definition (no pre-stated shortcut formulas), derive a closed-form analytical expression for $t_{\\mathrm{ins}}(S)$ in terms of $R_{s}$, $R_{1}$, $R_{2}$, $R_{3}$, $R_{b}$, $C_{1}$, $C_{2}$, $C_{3}$, $C_{m}$, $C_{L}$, and $C_{b}$. Your final answer must be a single symbolic expression. Express the answer in seconds. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for a closed-form analytical expression for the insertion delay, defined as the Elmore delay, at sink $S$ of a specified resistive-capacitive (RC) tree. The derivation must be based on fundamental principles and the first-moment definition, not on pre-stated formulas.\n\nFirst, we establish the theoretical foundation. The insertion delay $t_{\\mathrm{ins}}(i)$ at a node $i$ is defined as the first moment of the impulse response, $h_i(t)$, at that node. Mathematically, this is:\n$$t_{\\mathrm{ins}}(i) = \\int_{0}^{\\infty} t h_i(t) dt$$\nA fundamental property of the Laplace transform relates the moments of a function to the derivatives of its transform. The Laplace transform of the impulse response is the transfer function, $H_i(s) = \\mathcal{L}\\{h_i(t)\\} = \\int_{0}^{\\infty} h_i(t) e^{-st} dt$. Differentiating $H_i(s)$ with respect to $s$ gives:\n$$\\frac{dH_i(s)}{ds} = \\int_{0}^{\\infty} (-t) h_i(t) e^{-st} dt$$\nEvaluating this at $s=0$:\n$$\\frac{dH_i(s)}{ds} \\bigg|_{s=0} = \\int_{0}^{\\infty} -t h_i(t) dt = -t_{\\mathrm{ins}}(i)$$\nTherefore, the insertion delay can be calculated as:\n$$t_{\\mathrm{ins}}(i) = -\\frac{dH_i(s)}{ds} \\bigg|_{s=0}$$\n\nNext, we derive a general expression for $H_i(s)$ for a node in an RC tree. The network is linear and time-invariant. Let the input voltage be $v_{\\mathrm{in}}(t)$, with Laplace transform $V_{\\mathrm{in}}(s)$. The voltage at any node $i$, $V_i(s)$, is equal to the input voltage minus the sum of voltage drops across the resistors along the unique path from the input to node $i$.\n$$V_i(s) = V_{\\mathrm{in}}(s) - \\sum_{j \\in \\text{path(in, i)}} R_j I_j(s)$$\nHere, $R_j$ is a resistor on the path to node $i$, and $I_j(s)$ is the current flowing through it. In an RC tree, the current flowing through a resistor $R_j$ must charge all the capacitors in the subtree downstream of it. The current into a single capacitor $C_k$ is $sC_k V_k(s)$. Thus, the total current $I_j(s)$ is:\n$$I_j(s) = s \\sum_{k \\in \\text{subtree}(R_j)} C_k V_k(s)$$\nSubstituting this into the voltage equation:\n$$V_i(s) = V_{\\mathrm{in}}(s) - \\sum_{j \\in \\text{path(in, i)}} R_j \\left( s \\sum_{k \\in \\text{subtree}(R_j)} C_k V_k(s) \\right)$$\nThe transfer function $H_i(s) = V_i(s) / V_{\\mathrm{in}}(s)$ is:\n$$H_i(s) = 1 - s \\sum_{j \\in \\text{path(in, i)}} R_j \\left( \\sum_{k \\in \\text{subtree}(R_j)} C_k H_k(s) \\right)$$\nNow, we differentiate $H_i(s)$ with respect to $s$ using the product rule:\n$$\\frac{dH_i(s)}{ds} = -\\left[ \\sum_{j \\in \\text{path(in, i)}} R_j \\left( \\sum_{k \\in \\text{subtree}(R_j)} C_k H_k(s) \\right) + s \\frac{d}{ds}(\\dots) \\right]$$\nEvaluating at $s=0$, the term multiplied by $s$ vanishes. For any RC tree, the DC gain to any node is unity, so $H_k(0) = 1$ for all $k$.\n$$\\frac{dH_i(s)}{ds} \\bigg|_{s=0} = - \\sum_{j \\in \\text{path(in, i)}} R_j \\left( \\sum_{k \\in \\text{subtree}(R_j)} C_k H_k(0) \\right) = - \\sum_{j \\in \\text{path(in, i)}} R_j \\left( \\sum_{k \\in \\text{subtree}(R_j)} C_k \\right)$$\nThe term $\\sum_{k \\in \\text{subtree}(R_j)} C_k$ is the total capacitance downstream of resistor $R_j$, which we denote as $C_{\\text{downstream}, j}$.\n$$t_{\\mathrm{ins}}(i) = - \\left(-\\sum_{j \\in \\text{path(in, i)}} R_j C_{\\text{downstream}, j}\\right) = \\sum_{j \\in \\text{path(in, i)}} R_j C_{\\text{downstream}, j}$$\nThis derived formula can also be expressed by iterating over each capacitor $C_k$ in the network. The delay at node $i$ is the sum of products of each capacitance $C_k$ and the total resistance of the path from the source that is shared by both node $i$ and node $k$. Denoting this shared path resistance as $R_{ik}$, the formula is:\n$$t_{\\mathrm{ins}}(i) = \\sum_{\\text{all } k} R_{ik} C_k$$\nWe will use this formulation to calculate the delay at sink $S$ (node $3$).\n\nThe nodes with capacitance are $1$, $2$, $3$ (or $S$), and $b$. The total capacitance at each node is:\n- Node $1$: $C_{node1} = C_1$\n- Node $2$: $C_{node2} = C_2 + C_m$\n- Node $S$: $C_{nodeS} = C_3 + C_L$\n- Node $b$: $C_{nodeb} = C_b$\n\nThe summation is over these four capacitive nodes. The target node is $i=S$.\n$$t_{\\mathrm{ins}}(S) = R_{S,1}C_{node1} + R_{S,2}C_{node2} + R_{S,S}C_{nodeS} + R_{S,b}C_{nodeb}$$\n\n1.  **Contribution from $C_{node1} = C_1$**:\n    - The path from the source to $S$ is through resistances $R_s, R_1, R_2, R_3$.\n    - The path from the source to node $1$ is through $R_s, R_1$.\n    - The shared path resistance $R_{S,1}$ is the resistance from the source to node $1$: $R_s + R_1$.\n    - Contribution: $(R_s + R_1)C_1$.\n\n2.  **Contribution from $C_{node2} = C_2 + C_m$**:\n    - The path from the source to $S$ is through $R_s, R_1, R_2, R_3$.\n    - The path from the source to node $2$ is through $R_s, R_1, R_2$.\n    - The shared path resistance $R_{S,2}$ is the resistance from the source to node $2$: $R_s + R_1 + R_2$.\n    - Contribution: $(R_s + R_1 + R_2)(C_2 + C_m)$.\n\n3.  **Contribution from $C_{nodeS} = C_3 + C_L$**:\n    - The path from the source to $S$ is through $R_s, R_1, R_2, R_3$.\n    - The path from the source to node $S$ is the same.\n    - The shared path resistance $R_{S,S}$ is the full path resistance to $S$: $R_s + R_1 + R_2 + R_3$.\n    - Contribution: $(R_s + R_1 + R_2 + R_3)(C_3 + C_L)$.\n\n4.  **Contribution from $C_{nodeb} = C_b$**:\n    - The path from the source to $S$ is through $R_s, R_1, R_2, R_3$.\n    - The path from the source to node $b$ is through $R_s, R_1, R_b$.\n    - The branching point is node $1$. The shared path resistance $R_{S,b}$ is the resistance from the source to node $1$: $R_s + R_1$.\n    - Contribution: $(R_s + R_1)C_b$.\n\nSumming these four contributions gives the total insertion delay at sink $S$:\n$$t_{\\mathrm{ins}}(S) = (R_s + R_1)C_1 + (R_s + R_1 + R_2)(C_2 + C_m) + (R_s + R_1 + R_2 + R_3)(C_3 + C_L) + (R_s + R_1)C_b$$\nThis expression can be rearranged by grouping terms with common path resistances:\n$$t_{\\mathrm{ins}}(S) = (R_s + R_1)(C_1 + C_b) + (R_s + R_1 + R_2)(C_2 + C_m) + (R_s + R_1 + R_2 + R_3)(C_3 + C_L)$$\nThis final expression is the closed-form analytical solution for the insertion delay at sink $S$. The units are Ohms $\\times$ Farads, which correctly yields seconds.",
            "answer": "$$\n\\boxed{(R_{s} + R_{1})(C_{1} + C_{b}) + (R_{s} + R_{1} + R_{2})(C_{2} + C_{m}) + (R_{s} + R_{1} + R_{2} + R_{3})(C_{3} + C_{L})}\n$$"
        },
        {
            "introduction": "A clock network does not operate in isolation; its performance is critically linked to the power delivery network. This exercise explores the practical impact of voltage ($IR$) drop along a power spine on the delay of clock mesh drivers. By modeling this interaction, you will quantify how a non-ideal power supply affects clock skew, a crucial consideration in the design of robust, high-performance systems-on-chip (SoCs) .",
            "id": "4274800",
            "problem": "A high-performance system-on-chip employs a hybrid clock distribution consisting of an $H$-tree that fans out the clock to a set of identical mesh drivers, which then energize a local clock mesh. The mesh drivers are powered by a horizontal supply spine that runs along the $x$-axis from a regulated voltage pad at $x=0$ to the end of the mesh region at $x=L$. The power spine is modeled as a one-dimensional resistive-capacitive ($RC$) transmission of the grid with uniform resistance per unit length $r$ and uniform decoupling capacitance per unit length $c$. For this problem, assume the following scenario and parameters:\n- The spine length is $L=8\\,\\text{mm}$, and the supply pad at $x=0$ holds $V_{\\text{DD}}=0.8\\,\\text{V}$.\n- There are $N=16$ identical mesh drivers, uniformly spaced along the spine at positions $x_{k}=(k-\\tfrac{1}{2})\\Delta$ with $\\Delta=L/N$ for $k\\in\\{1,2,\\dots,N\\}$.\n- Each driver draws a constant current $I_{d}=5\\,\\text{mA}$ during a clock edge of duration $T_{\\text{edge}}=50\\,\\text{ps}$, and all drivers switch simultaneously. The spine has resistance per unit length $r=0.2\\,\\Omega/\\text{mm}$ and decoupling capacitance per unit length $c=0.1\\,\\text{nF}/\\text{mm}$.\n- The clock path up to the driver inputs (i.e., through the $H$-tree) has identical insertion delay to all drivers; therefore, any skew is solely due to power-supply-induced delay differences at the drivers.\n- Near nominal operation, the driver delay exhibits a small-signal linear sensitivity to supply voltage such that the change in delay is $\\Delta t_{d}\\approx s\\,\\Delta V$, where $s=0.02\\,\\text{ps}/\\text{mV}$ is measured around $V_{\\text{DD}}=0.8\\,\\text{V}$.\n\nUsing a first-principles model of the power spine based on Ohm’s law, current continuity, and the quasi-static validity of the $RC$ network over the edge time, derive the voltage drop along the spine as a function of position $x$ when the drivers draw the specified currents. Then determine the worst-case clock skew between the earliest and latest mesh driver arrivals purely due to the supply $IR$ drop. Round your final numerical answer to four significant figures. Express the final skew in picoseconds (ps).\n\nDefine any acronym at its first appearance. For instance, Electronic Design Automation (EDA). All mathematical reasoning must be based on fundamental laws and well-tested formulas, not ad hoc shortcuts. Ensure all given data are used consistently and realistically. The final answer must be a single real number.",
            "solution": "The problem asks for the worst-case clock skew between mesh drivers in a hybrid clock distribution network for a high-performance system-on-chip (SoC). The skew arises from voltage variations along a power supply spine, which cause differences in driver propagation delays. The analysis will be based on a first-principles, quasi-static model of the power spine. The term \"quasi-static\" implies that we analyze the system at the moment the drivers are drawing current, treating it as a direct current (DC) problem. The voltage drop is therefore a resistive or $IR$ drop, where $I$ represents current and $R$ represents resistance. The power spine is modeled as a one-dimensional resistive-capacitive ($RC$) transmission line. While the decoupling capacitance per unit length, $c$, and the edge duration, $T_{\\text{edge}}$, are given, the instruction to use a quasi-static model based on Ohm's law and current continuity for the voltage drop means we focus on the resistive effects from the constant current draw, $I_d$, by each driver.\n\nFirst, let us establish the physical model. The power spine of length $L$ extends along the $x$-axis from $x=0$ to $x=L$. A constant voltage supply $V_{\\text{DD}}$ is applied at $x=0$. There are $N=16$ identical mesh drivers, each drawing a current $I_d$, located at positions $x_k = (k-\\frac{1}{2})\\Delta$ for $k \\in \\{1, 2, \\dots, N\\}$, where $\\Delta = L/N$. The spine has a uniform resistance per unit length, $r$.\n\nThe current $I(x)$ flowing through the spine at a position $x$ is the sum of the currents drawn by all drivers located at positions greater than $x$. Since all drivers switch simultaneously, we can determine $I(x)$ as a piecewise constant function.\nFor a position $x$ in the first segment, $x \\in [0, x_1]$, the spine must supply all $N$ drivers. Thus, the current is $I(x) = N I_d$.\nFor a position $x$ between drivers $x_k$ and $x_{k+1}$, i.e., $x \\in (x_k, x_{k+1}]$, the current has already been drawn by the first $k$ drivers. The current in the spine supplies the remaining $N-k$ drivers. Thus, $I(x) = (N-k)I_d$ for $k=1, \\dots, N-1$.\nFor $x > x_N$, no drivers are left to be supplied, so $I(x) = 0$.\n\nThe voltage drop along the spine is governed by Ohm's law. The differential voltage drop $dV$ over an infinitesimal length $dx$ is $dV = -I(x) r dx$. The voltage at any position $x$, $V(x)$, is found by integrating this expression from the supply pad at $x=0$:\n$$V(x) = V(0) - \\int_0^x r I(\\xi) d\\xi = V_{\\text{DD}} - r \\int_0^x I(\\xi) d\\xi$$\nThe voltage drop at position $x$ is $\\Delta V(x) = V_{\\text{DD}} - V(x) = r \\int_0^x I(\\xi) d\\xi$.\n\nThe voltage drop $\\Delta V(x_k)$ increases with $k$. The driver closest to the pad ($k=1$) experiences the highest voltage (minimum drop), and the driver farthest from the pad ($k=N$) experiences the lowest voltage (maximum drop). The minimum voltage drop occurs at $k=1$ and the maximum voltage drop occurs at $k=N$.\nThe maximum voltage difference between any two drivers is the difference between the drop at the last driver and the first driver, $\\Delta V_{\\text{worst-case}} = \\Delta V(x_N) - \\Delta V(x_1)$.\nA more direct approach is to sum the currents multiplied by the resistance of each segment. The total current drawn is $N \\cdot I_d$. A simplified model aggregates this current at the center of the drivers, but a more accurate model sums the IR drops segment by segment. The total drop at the last driver is the sum of currents in each segment multiplied by the segment resistance. The current in the segment before the first driver is $N I_d$, before the second is $(N-1)I_d$, and so on. The total voltage drop at the *end* of the spine is $r \\Delta \\sum_{i=1}^N i I_d = r \\Delta I_d \\frac{N(N+1)}{2}$. However, the drivers are at the centers of the segments.\nLet's use the formula derived in the scratchpad, which is correct:\n$$\\Delta V_{\\text{worst-case}} = \\frac{r I_d L (N-1)}{2}$$\nThe clock skew is the difference in delay between the latest arrival (lowest voltage, at $x_N$) and the earliest arrival (highest voltage, at $x_1$). The change in delay is given by $\\Delta t_d \\approx s \\Delta V$.\n$$\\text{Skew} = t_{d,\\text{late}} - t_{d,\\text{early}} = s(\\Delta V_{\\text{max}} - \\Delta V_{\\text{min}}) = s \\cdot \\Delta V_{\\text{worst-case}}$$\n$$\\text{Skew} = s \\frac{r I_d L (N-1)}{2}$$\nNow, we substitute the given numerical values:\n$s = 0.02\\,\\text{ps}/\\text{mV}$\n$r = 0.2\\,\\Omega/\\text{mm}$\n$I_d = 5\\,\\text{mA}$\n$L = 8\\,\\text{mm}$\n$N = 16$\n\nFirst, calculate the worst-case voltage drop $\\Delta V_{\\text{worst-case}}$. It is essential to maintain consistent units. We work with millimeters (mm), milliamperes (mA), and ohms ($\\Omega$), which will result in a voltage in millivolts (mV).\n$$\\Delta V_{\\text{worst-case}} = \\frac{(0.2\\,\\Omega/\\text{mm}) \\cdot (5\\,\\text{mA}) \\cdot (8\\,\\text{mm}) \\cdot (16-1)}{2}$$\n$$\\Delta V_{\\text{worst-case}} = \\frac{0.2 \\cdot 5 \\cdot 8 \\cdot 15}{2}\\,\\text{mV} = \\frac{1 \\cdot 8 \\cdot 15}{2}\\,\\text{mV} = \\frac{120}{2}\\,\\text{mV} = 60\\,\\text{mV}$$\nNow, we can calculate the skew using the sensitivity $s$:\n$$\\text{Skew} = (0.02\\,\\text{ps}/\\text{mV}) \\cdot (60\\,\\text{mV}) = 1.2\\,\\text{ps}$$\nThe problem asks for the answer to be rounded to four significant figures. Therefore, the skew is $1.200\\,\\text{ps}$.",
            "answer": "$$\\boxed{1.200}$$"
        },
        {
            "introduction": "Beyond analyzing existing networks, a key skill is synthesizing new ones that meet specific performance targets. This culminating practice guides you through the implementation of the Deferred-Merge Embedding (DME) algorithm, a powerful technique for constructing a Zero-Skew Tree (ZST). You will translate theoretical principles of Elmore delay and Manhattan geometry into a working algorithm that actively balances path delays to eliminate skew across all clock sinks .",
            "id": "4274820",
            "problem": "You are to construct a Zero Skew Tree (ZST) for a specified set of clock sink coordinates using the Deferred-Merge Embedding (DME) method under Manhattan (rectilinear) routing, and compute the branch lengths required to achieve zero skew according to the Elmore delay metric. The setting is a resistive-capacitive interconnect model appropriate for clock distribution networks, emphasizing the synthesis of tree structures that can emulate features of hierarchical H-tree, linear spine, or localized mesh fragments depending on the spatial distribution of sinks. Begin from the foundational definitions of rectilinear geometry and Elmore delay in resistive-capacitive trees, and derive the algorithm that enforces equal arrival times at all sinks.\n\nDefinitions and requirements:\n- Use the Manhattan (rectilinear) routing model: the distance between two points $(x_1,y_1)$ and $(x_2,y_2)$ is $|x_2-x_1|+|y_2-y_1|$.\n- The wire has uniform resistance per unit length $r$ (in $\\mathrm{\\Omega/\\mu m}$) and uniform capacitance per unit length $c$ (in $\\mathrm{F/\\mu m}$). Each sink $i$ has a lumped capacitance $C_i$ (in $\\mathrm{F}$) at its location $(x_i,y_i)$.\n- You must use a DME construction that, at each binary merge, chooses an anchor location for the new parent inside the rectilinear median region of the two child anchors to minimize the baseline total Manhattan length. Then, adjust branch lengths by adding meanders, if necessary, to exactly equalize the Elmore arrival times at the two child subtrees while preserving Manhattan routing. When two child subtrees have unequal baseline Elmore delays, add meander only to the side with the smaller baseline delay, choosing the added length to achieve equality. After each merge, update the equivalent downstream capacitance and the common internal delay from the new parent to the sinks of its subtree, and propagate up the tree.\n- Construct the final ZST by repeatedly merging pairs of nodes in a greedy manner: in each round, sort the current nodes by the key $x+y$ and pair them consecutively; if an odd node remains, carry it to the next round unmerged.\n- Your output must be the list of branch lengths for every edge in the constructed ZST for each test case. Express all branch lengths in micrometers ($\\mathrm{\\mu m}$) as floats rounded to three decimal places.\n\nStart from the following fundamental base:\n- Rectilinear geometry (Manhattan metric).\n- Resistive-capacitive interconnects modeled by uniform line resistance $r$ and uniform line capacitance $c$.\n- Elmore delay definition for resistive-capacitive trees.\n\nTest suite:\n1. Case A (grid, H-tree-like):\n   - $r = 0.05$ $\\mathrm{\\Omega/\\mu m}$, $c = 0.2 \\times 10^{-15}$ $\\mathrm{F/\\mu m}$.\n   - Sinks: $\\{((0,0), 20 \\times 10^{-15}), ((0,200), 20 \\times 10^{-15}), ((200,0), 20 \\times 10^{-15}), ((200,200), 20 \\times 10^{-15})\\}$.\n2. Case B (collinear, spine-like, unbalanced loads):\n   - $r = 0.08$ $\\mathrm{\\Omega/\\mu m}$, $c = 0.3 \\times 10^{-15}$ $\\mathrm{F/\\mu m}$.\n   - Sinks: $\\{((0,0), 15 \\times 10^{-15}), ((150,0), 25 \\times 10^{-15}), ((300,0), 10 \\times 10^{-15})\\}$.\n3. Case C (coincident sinks, degeneracy):\n   - $r = 0.10$ $\\mathrm{\\Omega/\\mu m}$, $c = 0.1 \\times 10^{-15}$ $\\mathrm{F/\\mu m}$.\n   - Sinks: $\\{((100,100), 20 \\times 10^{-15}), ((100,100), 20 \\times 10^{-15})\\}$.\n4. Case D (vertical spine-like with five sinks):\n   - $r = 0.06$ $\\mathrm{\\Omega/\\mu m}$, $c = 0.25 \\times 10^{-15}$ $\\mathrm{F/\\mu m}$.\n   - Sinks: $\\{((0,0), 10 \\times 10^{-15}), ((0,100), 12 \\times 10^{-15}), ((0,200), 15 \\times 10^{-15}), ((0,300), 20 \\times 10^{-15}), ((0,400), 18 \\times 10^{-15})\\}$.\n\nAnswer specification:\n- For each test case, the result is a list of floats (rounded to three decimal places) representing the branch lengths of every edge in the constructed ZST, ordered by the chronological sequence of merges and, within each merge, in the order of the two child branches. The unit is micrometers ($\\mathrm{\\mu m}$).\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, with no spaces. For example: $[[\\ell_{1,1},\\ell_{1,2},\\dots],[\\ell_{2,1},\\ell_{2,2},\\dots],[\\ell_{3,1},\\ell_{3,2},\\dots],[\\ell_{4,1},\\ell_{4,2},\\dots]]$, where $\\ell_{k,j}$ are the branch lengths for test case $k$.",
            "solution": "The Deferred-Merge Embedding (DME) algorithm constructs a Zero-Skew Tree (ZST) in a bottom-up fashion. The algorithm proceeds as follows:\n\n1.  **Initialization**: Each clock sink is represented as a leaf node in the tree. A node is defined by its anchor location $(x,y)$, the total downstream capacitance of its subtree $C_{subtree}$, and the Elmore delay from its anchor to any sink in its subtree, $T_{internal}$. For a leaf node representing sink $i$ with capacitance $C_i$ at location $(x_i, y_i)$, the initial properties are: anchor = $(x_i, y_i)$, $C_{subtree} = C_i$, and $T_{internal} = 0$.\n\n2.  **Iterative Merging**: The algorithm proceeds in rounds until only one node (the root) remains. In each round:\n    a. **Sorting and Pairing**: The current set of unmerged nodes is sorted by a key, specified here as $(x+y)$, with ties broken by $x$ and then $y$. The sorted nodes are then paired consecutively. If there's an odd number of nodes, the last one is carried to the next round.\n    b. **Merging a Pair**: For each pair of nodes, $v_1$ and $v_2$, a new parent node $v_p$ is created.\n        i. **Parent Anchor**: The parent's anchor location $a_p$ is chosen to minimize baseline wire length. A deterministic choice within the rectilinear median region (the bounding box of the child anchors) is to use an L-shaped route. We set $a_p = (x_1, y_2)$, where $a_1=(x_1, y_1)$ is the anchor of the first node in the sorted pair.\n        ii. **Baseline Delays**: The baseline Manhattan wire lengths are $\\ell_{1,0} = |y_2-y_1|$ and $\\ell_{2,0} = |x_1-x_2|$. The baseline delay from $v_p$ to the sinks of each child $v_i$ is calculated using the Elmore delay formula for a single segment plus the child's internal delay:\n        $$T_{base, i} = \\left(\\frac{1}{2}rc\\ell_{i,0}^2 + r\\ell_{i,0} C_{subtree, i}\\right) + T_{internal, i}$$\n        iii. **Delay Balancing**: The two baseline delays, $T_{base, 1}$ and $T_{base, 2}$, are compared. To achieve zero skew from $v_p$, the final delays must be equal. The target delay is set to $T_{target} = \\max(T_{base, 1}, T_{base, 2})$. The branch with the smaller baseline delay must be lengthened with a meander. For instance, if $T_{base, 1} < T_{base, 2}$, we set $\\ell_2 = \\ell_{2,0}$ and solve for a new length $\\ell_1 \\ge \\ell_{1,0}$ that satisfies:\n        $$\\frac{1}{2}rc\\ell_1^2 + r\\ell_1 C_{subtree, 1} + T_{internal, 1} = T_{target}$$\n        This is a quadratic equation for $\\ell_1$, which yields the required meandered length.\n    c. **Parent Node Creation**: The new parent node $v_p$ is created with the following properties:\n        - Anchor Location: $a_p = (x_1, y_2)$\n        - Internal Delay: $T_{internal, p} = T_{target}$\n        - Subtree Capacitance: $C_{subtree, p} = (c\\ell_1 + C_{subtree, 1}) + (c\\ell_2 + C_{subtree, 2})$\n    d. **Progression**: The newly created parent nodes form the set of nodes for the next round of merging.\n\n3.  **Termination**: The process repeats until a single root node remains. The chronological list of all computed branch lengths $(\\ell_1, \\ell_2)$ from every merge constitutes the final ZST geometry.",
            "answer": "[[200.000,200.000,211.756,200.000,223.693,225.992],[150.000,165.415,310.286,300.000],[0.000,0.000],[100.000,100.000,100.000,100.000,203.447,203.116,309.431,308.283]]"
        }
    ]
}