{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的时序例外（如伪路径和多周期路径）之前，我们必须首先牢固掌握静态时序分析（STA）的核心计算。本练习将引导你从第一性原理出发，推导并计算建立时间裕量（setup slack），为理解和解决时序违例打下坚实的基础。通过这个计算，你将能清晰地看到数据到达时间与数据需求时间之间的赛跑，以及时序约束为何至关重要。",
            "id": "4270716",
            "problem": "使用静态时序分析 (STA) 分析一个同步数据路径。考虑一个从发起触发器到同一时钟域中捕获触发器的单周期建立时间检查。根据基本原理，建立时间检查将捕获触发器数据引脚上的数据到达时间与一个要求到达时间进行比较，该要求到达时间由下一个有效的捕获时钟沿减去一个建立时间侧的不确定性预算确定。触发器处的时钟沿相对于理想时间参考点因各自的时钟网络延迟而发生偏移，而一个有意的有用偏斜（如果为正）会进一步推迟捕获时钟沿。数据到达时间从理想时间参考点开始测量，包括发起时钟延迟和直到捕获数据引脚的完整数据路径延迟。\n\n给定以下参数：\n- 发起时钟延迟 $L_{\\ell} = 150\\ \\text{ps}$，\n- 捕获时钟延迟 $L_{c} = 290\\ \\text{ps}$，\n- 时钟周期 $T = 1\\ \\text{ns}$，\n- 有用偏斜 $S = +20\\ \\text{ps}$（正值 $S$ 意味着捕获沿相对于发起沿被延迟），\n- 建立时间侧时钟不确定性 $U = 80\\ \\text{ps}$，\n- 通过组合路径的数据到达时间（从发起触发器看到发起沿之后开始测量）$D = 700\\ \\text{ps}$，\n\n假设一个单周期建立时间约束，并假设相对于理想时间参考点，在捕获引脚上报告的数据到达时间为 $A = L_{\\ell} + D$。从建立时间裕量是要求到达时间减去实际数据到达时间的定义出发，推导出建立时间裕量关于 $T$、$L_{\\ell}$、$L_{c}$、$S$、$U$ 和 $D$ 的符号表达式，然后使用以上数值计算其值。\n\n最后，定性地解释（用文字，不作为数值答案的一部分）如果计算出的建立时间裕量为负，这对约束意味着什么，并提及伪路径和多周期路径约束的作用，以及它们如何在原则层面上改变要求时间。\n\n将最终的裕量表示为以皮秒为单位的单个数字。将您的答案四舍五入到三位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于数字电路的静态时序分析（STA）原理，问题设定良好，数据充分且一致，并使用客观、标准的术语表达。\n\n主要任务是推导并计算给定同步数据路径的建立时间裕量。建立时间裕量是建立时间检查的时序余量的度量。它被定义为捕获触发器输入端的要求到达时间与实际数据到达时间之间的差值。\n\n$Slack_{setup} = t_{required} - t_{arrival}$\n\n让我们从基本原理出发，使用一个共同的时间参考点（即时间 $t=0$ 处的理想时钟沿），推导出 $t_{arrival}$ 和 $t_{required}$ 的表达式。\n\n首先，我们确定捕获触发器数据输入端（D引脚）的实际数据到达时间 $t_{arrival}$。在理想参考系中，发起数据的时钟沿发生在 $t=0$。该时钟沿通过时钟网络传播，在等于发起时钟延迟 $L_{\\ell}$ 的时间到达发起触发器。在该时钟沿到达后，数据从触发器的Q引脚发出，并穿过组合逻辑路径，这需要时间 $D$。因此，从理想参考点 $t=0$ 开始直到数据在捕获触发器输入端稳定所需的总时间是发起时钟延迟和组合路径延迟之和。\n$$t_{arrival} = L_{\\ell} + D$$\n这与所提供的数据到达时间定义 $A$ 相匹配。\n\n接下来，我们确定要求到达时间 $t_{required}$。对于单周期路径，在 $t=0$ 时刻发起的数据必须被下一个时钟沿捕获，该时钟沿在理想参考系中发生在 $t=T$ 时刻，其中 $T$ 是时钟周期。这个捕获时钟沿通过其自身的时钟网络部分传播，在时间 $T + L_{c}$ 到达捕获触发器，其中 $L_c$ 是捕获时钟延迟。问题陈述中有一个有意的有用偏斜 $S$，它会进一步延迟捕获时钟沿。由于 $S$ 是正的，捕获时钟沿在触发器处的实际到达时间是 $T + L_c + S$。建立时间检查要求数据在该捕获沿到达*之前*的一段时间内在触发器输入端保持稳定。这个要求以及其他时序不确定性（如时钟抖动）被封装在建立时间侧不确定性预算 $U$ 中。因此，数据允许到达的最晚时间是物理捕获沿之前的 $U$。\n$$t_{required} = (T + L_c + S) - U$$\n\n现在，我们可以将这些表达式代回建立时间裕量方程中：\n$$Slack_{setup} = (T + L_c + S - U) - (L_{\\ell} + D)$$\n这就是建立时间裕量的符号表达式。\n\n我们给定的数值如下：\n- 时钟周期 $T = 1\\ \\text{ns} = 1000\\ \\text{ps}$\n- 发起时钟延迟 $L_{\\ell} = 150\\ \\text{ps}$\n- 捕获时钟延迟 $L_{c} = 290\\ \\text{ps}$\n- 有用偏斜 $S = 20\\ \\text{ps}$\n- 建立时间侧时钟不确定性 $U = 80\\ \\text{ps}$\n- 组合路径延迟 $D = 700\\ \\text{ps}$\n\n将这些值代入裕量表达式中：\n$$Slack_{setup} = (1000 + 290 + 20 - 80) - (150 + 700)$$\n$$Slack_{setup} = (1310 - 80) - (850)$$\n$$Slack_{setup} = 1230 - 850$$\n$$Slack_{setup} = 380\\ \\text{ps}$$\n建立时间裕量为 $380\\ \\text{ps}$。问题要求四舍五入到三位有效数字。数字 $380$ 可以写成 $3.80 \\times 10^2$，已经有三位有效数字，因此无需四舍五入。\n\n负的建立时间裕量意味着时序违规。数据到达时间（$t_{arrival}$）将大于要求到达时间（$t_{required}$），这意味着数据信号到达捕获触发器太晚，无法被指定的时钟沿可靠地捕获。这可能导致触发器捕获一个不正确（旧的）值或进入亚稳态，从而可能导致整个电路的功能故障。\n\n在这种情况下，像伪路径和多周期路径约束这样的时序例外约束就变得相关。在原则层面上，它们改变了每条路径必须在单个时钟周期内成功传播数据的默认假设。\n- **伪路径约束**应用于一条尽管物理上存在但逻辑上不活动的路径。这意味着在正常的电路操作下，信号永远无法从其起点传播到终点。例如，该路径可能是仅用于测试的逻辑结构的一部分，或者它可能被一个选择信号被绑定到常数值的多路复用器所阻塞。通过将路径声明为伪路径，STA工具被指示在时序分析中完全忽略它。这有效地移除了该路径的建立时间检查，使其负裕量变得无关紧要。\n- **多周期路径约束**用于那些被有意设计为需要超过一个时钟周期来传播数据的路径。例如，如果一条路径被指定为 $N$ 周期路径，那么建立时间检查就不再是针对时间 $T$ 处的下一个时钟沿进行，而是针对时间 $N \\times T$ 处的时钟沿。这将要求到达时间更改为 $t'_{required} = (N \\times T + L_c + S) - U$。这为数据路径提供了额外的 $(N-1)T$ 时序预算，如果设计的微架构允许这种更长的延迟，这可以轻易地解决建立时间违规问题。",
            "answer": "$$\\boxed{380}$$"
        },
        {
            "introduction": "多周期路径（multicycle-path）约束是解决长路径建立时间违例的有力工具，但其应用并非没有风险。这个练习揭示了一个常见的陷阱：一个旨在放宽建立时间（setup）的约束，可能会无意中导致保持时间（hold）检查变得更加严苛，甚至产生新的违例。通过计算一个应用了多周期约束的路径的建立和保持时间裕量，你将亲身体会到正确处理这些相互关联的检查的重要性。",
            "id": "4270650",
            "problem": "在电子设计自动化（EDA）的背景下，使用静态时序分析（STA）来分析一个同步单时钟路径。考虑一个寄存器到寄存器的路径，其时钟周期为 $T$，应用于建立时间检查的多周期因子为 $m$，默认的保持时间乘数定义为 $m_{h} = m - 1$。发起时钟延迟为 $t_{L}$，捕获时钟延迟为 $t_{C}$，时钟不确定性为 $U$，残余局部时钟偏斜为 $s$，其中正值 $s$ 表示捕获时钟沿比发起时钟沿晚到达，负值 $s$ 表示捕获时钟沿早到达。假设：\n- 建立时间裕量定义为要求到达时间减去实际数据到达时间。\n- 保持时间裕量定义为实际数据到达时间减去要求到达时间。\n- 时钟不确定性 $U$ 通过从建立时间要求时间中减去 $U$ 来收紧建立时间检查，并通过向保持时间要求时间中加上 $U$ 来收紧保持时间检查。\n- 对于建立时间和保持时间检查，有效的净叶到叶偏斜项均为 $(t_{C} - t_{L} + s)$，并且 $s$ 的相同符号约定适用于两种检查。\n- 捕获寄存器输入端的数据到达时间 $A$ 是相对于时间为 $0$ 的发起寄存器有效时钟沿来测量的，并且已经包含了源寄存器的 clock-to-$Q$ 延迟和组合逻辑延迟。\n\n仅使用上述基本的 STA 定义以及通用的多周期解释（即建立时间多周期 $m$ 将捕获沿移动 $mT$，且默认保持时间乘数为 $m_{h} = m - 1$），计算以下值的建立时间和保持时间裕量：\n- $T = 500\\ \\text{ps}$，\n- $m = 3$，\n- $t_{L} = 100\\ \\text{ps}$，\n- $t_{C} = 200\\ \\text{ps}$，\n- $U = 50\\ \\text{ps}$，\n- $s = -20\\ \\text{ps}$ (捕获提前)，\n- $A = 900\\ \\text{ps}$。\n\n将你的最终答案表示为一个有序对 $[\\text{建立时间裕量}, \\text{保持时间裕量}]$，单位为皮秒。不需要四舍五入。不要在最终的方框答案中包含单位。",
            "solution": "首先将对问题的科学合理性、自洽性和一致性进行验证。\n\n### 步骤 1：提取已知条件\n\n以下数据和定义逐字引自问题陈述：\n- 时钟周期：$T = 500\\ \\text{ps}$\n- 建立时间多周期因子：$m = 3$\n- 默认保持时间乘数：$m_{h} = m - 1$\n- 发起时钟延迟：$t_{L} = 100\\ \\text{ps}$\n- 捕获时钟延迟：$t_{C} = 200\\ \\text{ps}$\n- 时钟不确定性：$U = 50\\ \\text{ps}$\n- 残余局部时钟偏斜：$s = -20\\ \\text{ps}$ (捕获提前)\n- 捕获寄存器的数据到达时间：$A = 900\\ \\text{ps}$\n- 建立时间裕量定义：要求到达时间减去实际数据到达时间。\n- 保持时间裕量定义：实际数据到达时间减去要求到达时间。\n- 建立时间上的时钟不确定性：从建立时间要求时间中减去 $U$。\n- 保持时间上的时钟不确定性：向保持时间要求时间中加上 $U$。\n- 有效的净叶到叶偏斜项：对于建立时间和保持时间均为 $(t_{C} - t_{L} + s)$。\n- 数据到达时间 $A$ 是相对于时间为 0 的发起寄存器有效时钟沿来测量的，并包括 clock-to-Q 延迟和组合逻辑延迟。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n\n- **科学依据**：该问题基于同步数字电路静态时序分析（STA）的标准原理。建立/保持时间裕量、时钟不确定性、时钟延迟、偏斜和多周期路径等概念是电子设计自动化（EDA）领域的基础。这些定义虽然具体，但与常见的行业方法论一致。\n- **问题适定**：计算建立和保持时间裕量所需的所有数值和定义均已提供。问题是自洽的，可以推导出唯一的数值解。关于如何整合不确定性和偏斜的具体定义，尽管表述方式独特，但没有歧义。\n- **客观性**：问题以精确、定量和无偏见的技术语言陈述。\n\n该问题没有表现出验证清单中列出的任何缺陷。虽然它通过为建立时间（取决于最大延迟）和保持时间（取决于最小延迟）提供单个数据到达时间 $A$ 进行了简化，但这是一种常见的教学简化方法。问题本身保持内部一致，并且可以按陈述求解。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。将提供详细的解决方案。\n\n### 解题过程\n\n解决方案要求根据所提供的定义计算建立时间裕量 ($Slack_{setup}$) 和保持时间裕量 ($Slack_{hold}$)。建立一个参考系，其中发起触发器在时间 $t=0$ 时被时钟触发。数据到达时间 $A$ 是数据路径相对于此发起事件的延迟。\n\n**1. 建立时间裕量计算**\n\n建立时间裕量定义为建立时间的要求到达时间（RAT）减去建立时间的实际到达时间（AAT）。\n$Slack_{setup} = RAT_{setup} - AAT_{setup}$\n\n实际到达时间 $AAT_{setup}$ 是数据信号到达捕获寄存器输入端的时间。问题陈述该值为 $A$。\n$AAT_{setup} = A = 900\\ \\text{ps}$\n\n要求到达时间 $RAT_{setup}$ 是数据能够正确被捕获而必须到达捕获寄存器输入端的最晚时间。这由捕获时钟沿的到达时间决定，并根据不确定性进行调整。\n\n对于因子为 $m$ 的多周期路径，建立时间检查发生在第 $m$ 个时钟沿。可用于数据传播的总时间窗口是多周期路径的周期加上时钟偏斜。\n多周期路径的周期是 $m \\times T$。\n问题将有效时钟偏斜 $S_{eff}$ 定义为：\n$S_{eff} = t_{C} - t_{L} + s$\n$S_{eff} = 200\\ \\text{ps} - 100\\ \\text{ps} + (-20\\ \\text{ps}) = 80\\ \\text{ps}$\n\n相对于发起事件，名义上的要求时间是捕获时钟沿的到达时间：\n$RAT_{nominal} = m \\times T + S_{eff}$\n\n问题陈述，时钟不确定性 $U$ 通过从要求时间中减去 $U$ 来收紧建立时间检查。\n$RAT_{setup} = RAT_{nominal} - U = m \\times T + S_{eff} - U$\n$RAT_{setup} = 3 \\times 500\\ \\text{ps} + 80\\ \\text{ps} - 50\\ \\text{ps} = 1500\\ \\text{ps} + 30\\ \\text{ps} = 1530\\ \\text{ps}$\n\n因此，建立时间裕量为：\n$Slack_{setup} = RAT_{setup} - AAT_{setup} = 1530\\ \\text{ps} - 900\\ \\text{ps} = 630\\ \\text{ps}$\n\n**2. 保持时间裕量计算**\n\n保持时间裕量定义为保持时间的实际到达时间（AAT）减去保持时间的要求到达时间（RAT）。\n$Slack_{hold} = AAT_{hold} - RAT_{hold}$\n\n实际到达时间 $AAT_{hold}$ 是新数据可能到达的最早时间。鉴于问题为数据到达时间 $A$ 提供了一个单一值，我们也必须用它来进行此计算。\n$AAT_{hold} = A = 900\\ \\text{ps}$\n\n要求到达时间 $RAT_{hold}$ 是捕获寄存器输入端的数据必须保持稳定的时间点。这由保持时间检查时钟沿的到达时间决定。问题指定了保持时间乘数 $m_h = m - 1$。\n$m_h = 3 - 1 = 2$\n\n保持时间检查是相对于第 $m_h$ 个时钟沿进行的。此沿相对于发起事件的到达时间定义了名义上的保持时间 RAT。\n$RAT_{nominal, hold} = m_h \\times T + S_{eff}$\n\n问题陈述，时钟不确定性 $U$ 通过向要求时间中加上 $U$ 来收紧保持时间检查。\n$RAT_{hold} = RAT_{nominal, hold} + U = m_h \\times T + S_{eff} + U$\n代入数值：\n$RAT_{hold} = 2 \\times 500\\ \\text{ps} + 80\\ \\text{ps} + 50\\ \\text{ps} = 1000\\ \\text{ps} + 130\\ \\text{ps} = 1130\\ \\text{ps}$\n\n因此，保持时间裕量为：\n$Slack_{hold} = AAT_{hold} - RAT_{hold} = 900\\ \\text{ps} - 1130\\ \\text{ps} = -230\\ \\text{ps}$\n\n最终答案是有序对 [建立时间裕量, 保持时间裕量]。\n计算出的值为建立时间裕量 $630\\ \\text{ps}$ 和保持时间裕量 $-230\\ \\text{ps}$。",
            "answer": "$$\\boxed{[630, -230]}$$"
        },
        {
            "introduction": "在真实的芯片设计中，逻辑路径错综复杂，多条路径可能汇集于同一点。因此，精确地定义时序约束的作用域（scope）至关重要。本练习通过一个包含流水线路径和旁路（bypass）路径的典型场景，展示了为何应使用精确定位的约束（例如，通过`-through`选项），以及为何宽泛地对终点（endpoint）应用约束会带来掩盖真实时序违例的风险。",
            "id": "4270715",
            "problem": "在电子设计自动化 (EDA) 领域，给定一个算术逻辑单元 (ALU) 流水线的简化同步数据路径模型。该数据路径有一个源寄存器、一个端点寄存器，以及两条进入端点寄存器的不同组合扇入路径：\n- 一条“流水线”路径，其有意地穿过一个特定的 ALU 流水线阶段模块，以及\n- 一条不穿过该 ALU 流水线阶段模块的“旁路”路径。\n\n目标是评估一个作用域为“穿过”特定 ALU 流水线阶段模块的多周期路径约束，与一个施加于端点寄存器的、作用域更广的多周期约束相比，其正确性和安全性。您必须构建一个程序，该程序：\n- 仅将多周期语义应用于“穿过”ALU 流水线阶段模块的路径，并且\n- 将其与一个施加于端点寄存器的、作用域错误的广范围端点约束进行比较，后者会放宽所有输入路径，包括旁路路径。\n\n此问题的基础是静态时序分析 (STA)。对于周期为 $T$ 的单一同步时钟域，假设存在以下经过充分检验的定义：\n- 组合路径的最大延迟为 $d_{\\max}$。\n- 单周期建立时间要求是数据到达时间必须小于或等于要求到达时间，其中单周期路径的要求到达时间为 $T$，时序裕量定义为 $S = T - d_{\\max}$。\n- 对于建立时间上一个预期的多周期路径因子 $M$，要求到达时间变为 $M \\cdot T$，时序裕量变为 $S = M \\cdot T - d_{\\max}$。\n- 所有延迟和时序裕量都必须以纳秒表示，并且您必须报告以纳秒为单位、四舍五入到3位小数的时序裕量。\n\n在此模型中，从启动寄存器到端点寄存器有两条组合子路径：\n- 预期的流水线路径总最大延迟为 $d_{1} = d_{X} + d_{Y}$，其中 $d_{X}$ 是穿过特定 ALU 流水线阶段模块的最大延迟，而 $d_{Y}$ 是该流水线路径上其余逻辑的最大延迟。\n- 旁路路径的总最大延迟为 $d_{2} = d_{\\mathrm{BP}}$，它不穿过 ALU 流水线阶段模块。\n\n您必须为每个测试用例实现以下评估：\n- 在正确的“穿过”作用域下，仅将多周期因子 $M$ 应用于穿过 ALU 阶段的流水线路径，从而在流水线路径上产生建立时间裕量 $S_{1}^{\\mathrm{through}} = M \\cdot T - d_{1}$，在旁路路径上产生 $S_{2}^{\\mathrm{through}} = T - d_{2}$。\n- 在不正确的广范围端点作用域（不安全）下，将多周期因子 $M$ 应用于所有进入端点寄存器的路径，从而在旁路路径上产生 $S_{2}^{\\mathrm{broad}} = M \\cdot T - d_{2}$。\n- 判断在正确的“穿过”作用域下，设计是否满足时序要求，由布尔值 $B_{\\mathrm{meet}} = \\left(S_{1}^{\\mathrm{through}} \\ge 0\\right) \\land \\left(S_{2}^{\\mathrm{through}} \\ge 0\\right)$ 定义。\n- 判断广范围端点作用域是否不安全，因为它掩盖了旁路路径上的单周期违例，由布尔值 $B_{\\mathrm{unsafe}} = \\left(S_{2}^{\\mathrm{through}}  0\\right) \\land \\left(S_{2}^{\\mathrm{broad}} \\ge 0\\right)$ 定义。\n\n您的程序必须实现此逻辑并评估以下测试套件。每个测试用例都指定为一个元组 $\\left(T, M, d_{X}, d_{Y}, d_{\\mathrm{BP}}\\right)$，其中所有延迟和 $T$ 的单位均为纳秒：\n- 测试用例 1：$\\left(1.0, 2, 1.3, 0.4, 0.8\\right)$。\n- 测试用例 2：$\\left(1.0, 2, 1.0, 0.7, 1.1\\right)$。\n- 测试用例 3：$\\left(1.0, 3, 2.9, 0.1, 1.0\\right)$。\n- 测试用例 4：$\\left(0.5, 2, 0.7, 0.1, 0.49\\right)$。\n\n您的程序必须为每个测试用例计算：\n- 布尔值 $B_{\\mathrm{meet}}$，\n- 布尔值 $B_{\\mathrm{unsafe}}$，\n- 以纳秒为单位、四舍五入到3位小数的时序裕量 $S_{1}^{\\mathrm{through}}$，\n- 以纳秒为单位、四舍五入到3位小数的时序裕量 $S_{2}^{\\mathrm{through}}$，\n- 以纳秒为单位、四舍五入到3位小数的时序裕量 $S_{2}^{\\mathrm{broad}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的元素本身是一个列表，按 $\\left[B_{\\mathrm{meet}}, B_{\\mathrm{unsafe}}, S_{1}^{\\mathrm{through}}, S_{2}^{\\mathrm{through}}, S_{2}^{\\mathrm{broad}}\\right]$ 的顺序排列，并使用上述指定的单位。例如，一个有效的整体输出格式类似于 $\\left[[\\mathrm{True}, \\mathrm{False}, 0.300, 0.200, 1.200],[\\dots]\\right]$。",
            "solution": "我们从静态时序分析 (STA) 的基本定义开始。考虑一个周期为 $T$ 的单一同步时钟域。对于一条从启动寄存器到捕获寄存器的数据路径，其最大组合延迟为 $d_{\\max}$，单周期建立时间要求计算时序裕量为\n$$\nS = T - d_{\\max}.\n$$\n非负时序裕量 $S \\ge 0$ 表示该路径满足建立时间的时序要求。对于一个因子为 $M$ 的多周期建立时间例外，建立时间的要求时间按周期数进行缩放，时序裕量变为\n$$\nS = M \\cdot T - d_{\\max}.\n$$\n这种缩放直接源于定义：数据被允许在启动后的 $M$ 个周期到达，因此要求到达时间是 $M \\cdot T$ 而不是 $T$。\n\n我们为从源寄存器到端点寄存器的两条扇入路径建模：\n- 预期的流水线路径穿过一个特定的算术逻辑单元 (ALU) 流水线阶段模块，其穿过该阶段的最大延迟为 $d_{X}$，之后的最大延迟为 $d_{Y}$，从而产生总最大延迟\n$$\nd_{1} = d_{X} + d_{Y}.\n$$\n- 旁路路径不穿过 ALU 阶段模块，其总最大延迟为\n$$\nd_{2} = d_{\\mathrm{BP}}.\n$$\n\n我们比较两种针对多周期约束的作用域策略：\n\n$1.$ 施加于 ALU 阶段的正确“穿过”作用域：\n- 对于穿过 ALU 阶段模块的路径，使用多周期因子 $M$ 是预期且正确的。建立时间裕量变为\n$$\nS_{1}^{\\mathrm{through}} = M \\cdot T - d_{1}.\n$$\n- 对于不穿过 ALU 阶段的旁路路径，适用单周期要求（无多周期放宽），因此\n$$\nS_{2}^{\\mathrm{through}} = T - d_{2}.\n$$\n当且仅当以下条件成立时，设计在正确作用域下满足时序要求\n$$\nB_{\\mathrm{meet}} = \\left(S_{1}^{\\mathrm{through}} \\ge 0\\right) \\land \\left(S_{2}^{\\mathrm{through}} \\ge 0\\right).\n$$\n\n$2.$ 不正确的广范围端点作用域：\n- 如果将一个因子为 $M$ 的多周期例外应用于所有结束于端点寄存器的路径（广范围作用域），那么预期的流水线路径和旁路路径都会被放宽。在这种不正确的作用域下，旁路路径的时序裕量变为\n$$\nS_{2}^{\\mathrm{broad}} = M \\cdot T - d_{2}.\n$$\n这是不安全的，因为旁路路径上的任何单周期违例都可能被这种人为的放宽所掩盖。我们用以下公式量化这种情况\n$$\nB_{\\mathrm{unsafe}} = \\left(S_{2}^{\\mathrm{through}}  0\\right) \\land \\left(S_{2}^{\\mathrm{broad}} \\ge 0\\right),\n$$\n该公式精确地捕捉了旁路路径作为单周期路径时发生违例，但在广范围端点作用域下却看似满足时序的情况。\n\n算法设计：\n- 对于每个测试用例元组 $\\left(T, M, d_{X}, d_{Y}, d_{\\mathrm{BP}}\\right)$，计算 $d_{1} = d_{X} + d_{Y}$ 和 $d_{2} = d_{\\mathrm{BP}}$。\n- 计算 $S_{1}^{\\mathrm{through}} = M \\cdot T - d_{1}$。\n- 计算 $S_{2}^{\\mathrm{through}} = T - d_{2}$。\n- 计算 $S_{2}^{\\mathrm{broad}} = M \\cdot T - d_{2}$。\n- 根据上述逻辑表达式确定 $B_{\\mathrm{meet}}$ 和 $B_{\\mathrm{unsafe}}$。\n- 将时序裕量 $S_{1}^{\\mathrm{through}}$、$S_{2}^{\\mathrm{through}}$ 和 $S_{2}^{\\mathrm{broad}}$ 四舍五入到3位小数，并以纳秒为单位报告。\n\n安全性论证：\n- “穿过”作用域将多周期放宽绑定到预期的逻辑条件：只有穿过指定的 ALU 流水线阶段模块的路径才会被放宽。这为其他扇入路径（如旁路或反馈路径）保留了单周期约定，从而遵守了功能性时序意图。\n- 广范围端点作用域将 $M \\cdot T$ 应用于所有终止于端点寄存器的路径，包括那些功能上仍需要单周期时序的旁路路径。正如谓词 $B_{\\mathrm{unsafe}}$ 所示，这可能将一个真实的违例 $\\left(S_{2}^{\\mathrm{through}}  0\\right)$ 转换为一个看似通过的条件 $\\left(S_{2}^{\\mathrm{broad}} \\ge 0\\right)$，从而掩盖了会在芯片中实际出现的时序故障。因此，在存在具有不同预期时序约定的多个逻辑扇入时，更广范围的端点作用域是不安全的。\n\n该程序为提供的测试套件实现了这些计算，并为每个测试用例，按照指定的顺序和单位输出布尔值和时序裕量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef evaluate_case(T, M, dX, dY, dBP):\n    # Compute delays for pipeline and bypass paths\n    d1 = dX + dY  # pipeline path total delay\n    d2 = dBP      # bypass path total delay\n\n    # Correct \"through\" scoping slacks\n    S1_through = M * T - d1\n    S2_through = T - d2\n\n    # Incorrect broad endpoint scoping slack for bypass\n    S2_broad = M * T - d2\n\n    # Determine meet-timing under correct scoping\n    B_meet = (S1_through >= 0.0) and (S2_through >= 0.0)\n\n    # Determine unsafe masking under broad endpoint scoping\n    B_unsafe = (S2_through  0.0) and (S2_broad >= 0.0)\n\n    # Round slacks to 3 decimals as per specification\n    S1_through = round(S1_through, 3)\n    S2_through = round(S2_through, 3)\n    S2_broad = round(S2_broad, 3)\n\n    return [B_meet, B_unsafe, S1_through, S2_through, S2_broad]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (T, M, dX, dY, dBP) with all values in nanoseconds\n    test_cases = [\n        (1.0, 2, 1.3, 0.4, 0.8),   # Test case 1\n        (1.0, 2, 1.0, 0.7, 1.1),   # Test case 2\n        (1.0, 3, 2.9, 0.1, 1.0),   # Test case 3\n        (0.5, 2, 0.7, 0.1, 0.49),  # Test case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        T, M, dX, dY, dBP = case\n        result = evaluate_case(T, M, dX, dY, dBP)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}