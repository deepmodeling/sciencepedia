{
    "hands_on_practices": [
        {
            "introduction": "在优化整个逻辑路径之前，我们必须首先理解并量化其基本构建模块——逻辑门的延迟特性。逻辑力（$g$）和寄生延迟（$p$）是逻辑努力模型的基石，而本练习将展示这些抽象参数是如何直接从晶体管的物理属性和一致的尺寸调整策略中推导出来的。通过完成这项推导 ，你将更深刻地体会到逻辑努力模型背后的物理基础。",
            "id": "4279912",
            "problem": "在用于电子设计自动化 (EDA) 的互补金属氧化物半导体 (CMOS) 标准单元库中，考虑由金属氧化物半导体场效应晶体管 (MOSFET) 构成的逻辑门。假设以下经过充分测试的特性：(i) MOSFET 沟道的导通电阻与其有效宽度成反比；(ii) n沟道和p沟道器件的单位宽度栅极电容相同；(iii) 单位宽度的漏极扩散电容与宽度成线性关系，但n沟道和p沟道器件的该值可能不同。设一个参考反相器的n沟道宽度为 $W_{n,\\mathrm{inv}}=1$，p沟道宽度为 $W_{p,\\mathrm{inv}}=\\alpha$，其尺寸的选择使得该反相器的最坏情况下的上拉和下拉电阻相等。采用常见的设计选择 $\\alpha=2$。\n\n根据一致的尺寸调整策略，每个逻辑门的尺寸都被调整，使其最坏情况下的上拉和最坏情况下的下拉电阻与参考反相器的电阻相匹配。对于一个 $k$ 输入与非门和一个 $k$ 输入或非门（其中 $k \\geq 2$），使用基于经典努力延迟模型的逻辑努力 $g$ 和寄生延迟 $p$ 的定义：一个输入的逻辑努力 $g$ 是该输入的栅极电容与提供相同输出驱动能力的参考反相器的输入栅极电容之比；寄生延迟 $p$ 是该逻辑门的固有延迟贡献，并对相同的参考标准进行归一化（等效地，在相同的电阻匹配和波形假设下，它与该逻辑门的固有输出节点扩散电容与参考反相器的该电容之比成正比）。\n\n推导在所述尺寸调整策略和假设下，$k$ 输入与非门和 $k$ 输入或非门的逻辑努力 $g$ 和寄生延迟 $p$ 的闭式表达式。最终答案请表示为仅含 $k$ 的函数，并按 $\\left(g_{\\mathrm{NAND}_k},\\,p_{\\mathrm{NAND}_k},\\,g_{\\mathrm{NOR}_k},\\,p_{\\mathrm{NOR}_k}\\right)$ 的顺序给出。无需进行数值四舍五入，也不涉及物理单位。",
            "solution": "该问题定义明确，并且基于成熟的CMOS数字电路逻辑努力理论。它提供了足够的信息，可以在一套该模型中常见的标准简化假设下，推导出所要求的量。我们将进行正式的推导。\n\n**1. 参考反相器参数**\n\n令 $R_{n,unit}$ 和 $R_{p,unit}$ 分别表示单位宽度的n沟道和p沟道MOSFET的导通电阻。问题指出，MOSFET的导通电阻与其宽度 $W$ 成反比。\n$R_{n}(W) = \\frac{R_{n,unit}}{W}$ 和 $R_{p}(W) = \\frac{R_{p,unit}}{W}$。\n\n参考反相器的尺寸设置为 $W_{n,\\mathrm{inv}}=1$ 和 $W_{p,\\mathrm{inv}}=\\alpha$。问题明确指出其上拉和下拉电阻是匹配的。\n下拉电阻为 $R_{pd,\\mathrm{inv}} = R_{n}(W_{n,\\mathrm{inv}}) = \\frac{R_{n,unit}}{1} = R_{n,unit}$。\n上拉电阻为 $R_{pu,\\mathrm{inv}} = R_{p}(W_{p,\\mathrm{inv}}) = \\frac{R_{p,unit}}{\\alpha}$。\n令二者相等，得到 $R_{n,unit} = \\frac{R_{p,unit}}{\\alpha}$，这建立了固有的电阻关系：$R_{p,unit} = \\alpha R_{n,unit}$。这意味着单位宽度的pMOS的电阻是单位宽度的nMOS电阻的 $\\alpha$ 倍。\n作为所有其他逻辑门参考的参考反相器的驱动电阻是 $R_{\\mathrm{ref}} = R_{n,unit}$。问题说明 $\\alpha=2$。\n\n参考反相器的输入电容 $C_{\\mathrm{inv}}$ 是其栅极电容之和。令 $C_{g,unit}$ 为单位宽度的栅极电容，假设对nMOS和pMOS是相同的。\n$$C_{\\mathrm{inv}} = C_{g,unit} W_{n,\\mathrm{inv}} + C_{g,unit} W_{p,\\mathrm{inv}} = C_{g,unit}(1 + \\alpha)$$\n\n寄生延迟与输出节点的总扩散电容成正比，并用参考反相器的相应值进行归一化。令 $C_{d,n,unit}$ 和 $C_{d,p,unit}$ 分别为nMOS和pMOS单位宽度的扩散电容。问题陈述要求寄生延迟 $p$ 的最终表达式仅依赖于 $k$。这要求nMOS与pMOS单位宽度扩散电容之比为定值。在逻辑努力模型中，我们不得不采纳的标准简化假设是它们相等：$C_{d,n,unit} = C_{d,p,unit} \\equiv C_{d,unit}$。\n因此，参考反相器的寄生电容为：\n$$C_{p,\\mathrm{inv}} = C_{d,n,unit} W_{n,\\mathrm{inv}} + C_{d,p,unit} W_{p,\\mathrm{inv}} = C_{d,unit}(W_{n,\\mathrm{inv}} + W_{p,\\mathrm{inv}}) = C_{d,unit}(1 + \\alpha)$$\n\n**2. $k$ 输入与非门 ($\\mathrm{NAND}_k$) 的分析**\n\n一个 $k$ 输入与非门由一个包含 $k$ 个串联nMOS晶体管的下拉网络和一个包含 $k$ 个并联pMOS晶体管的上拉网络组成。设其宽度分别为 $W_{n,\\mathrm{NAND}}$ 和 $W_{p,\\mathrm{NAND}}$。\n\n*   **为匹配电阻而进行的尺寸调整：**\n    *   下拉电阻是 $k$ 个串联nMOS晶体管的电阻之和：$R_{pd,\\mathrm{NAND}} = k \\cdot R_{n}(W_{n,\\mathrm{NAND}}) = k \\frac{R_{n,unit}}{W_{n,\\mathrm{NAND}}}$。\n    为匹配参考驱动能力，我们设置 $R_{pd,\\mathrm{NAND}} = R_{\\mathrm{ref}} = R_{n,unit}$：\n    $$k \\frac{R_{n,unit}}{W_{n,\\mathrm{NAND}}} = R_{n,unit} \\implies W_{n,\\mathrm{NAND}} = k$$\n    *   最坏情况下的上拉电阻发生在 $k$ 个并联pMOS晶体管中只有一个导通时：$R_{pu,\\mathrm{NAND}} = R_{p}(W_{p,\\mathrm{NAND}}) = \\frac{R_{p,unit}}{W_{p,\\mathrm{NAND}}} = \\frac{\\alpha R_{n,unit}}{W_{p,\\mathrm{NAND}}}$。\n    为匹配参考驱动能力，我们设置 $R_{pu,\\mathrm{NAND}} = R_{\\mathrm{ref}} = R_{n,unit}$：\n    $$\\frac{\\alpha R_{n,unit}}{W_{p,\\mathrm{NAND}}} = R_{n,unit} \\implies W_{p,\\mathrm{NAND}} = \\alpha$$\n\n*   **逻辑努力 ($g_{\\mathrm{NAND}_k}$):**\n    逻辑努力是逻辑门的输入电容与参考反相器输入电容之比。一个输入的电容来自一个nMOS和一个pMOS栅极。\n    $$C_{\\mathrm{in},\\mathrm{NAND}} = C_{g,unit}(W_{n,\\mathrm{NAND}} + W_{p,\\mathrm{NAND}}) = C_{g,unit}(k + \\alpha)$$\n    $$g_{\\mathrm{NAND}_k} = \\frac{C_{\\mathrm{in},\\mathrm{NAND}}}{C_{\\mathrm{inv}}} = \\frac{C_{g,unit}(k + \\alpha)}{C_{g,unit}(1 + \\alpha)} = \\frac{k + \\alpha}{1 + \\alpha}$$\n    代入 $\\alpha=2$，我们得到 $g_{\\mathrm{NAND}_k} = \\frac{k+2}{3}$。\n\n*   **寄生延迟 ($p_{\\mathrm{NAND}_k}$):**\n    输出节点连接到所有 $k$ 个pMOS晶体管的漏极和串联堆叠顶部的单个nMOS的漏极。\n    $$C_{p,\\mathrm{NAND}} = (k \\cdot C_{d,p,unit} \\cdot W_{p,\\mathrm{NAND}}) + (1 \\cdot C_{d,n,unit} \\cdot W_{n,\\mathrm{NAND}})$$\n    使用我们的假设 $C_{d,n,unit}=C_{d,p,unit}=C_{d,unit}$：\n    $$C_{p,\\mathrm{NAND}} = C_{d,unit}(k \\cdot W_{p,\\mathrm{NAND}} + W_{n,\\mathrm{NAND}}) = C_{d,unit}(k \\alpha + k) = C_{d,unit} k(1+\\alpha)$$\n    寄生延迟是寄生电容之比：\n    $$p_{\\mathrm{NAND}_k} = \\frac{C_{p,\\mathrm{NAND}}}{C_{p,\\mathrm{inv}}} = \\frac{C_{d,unit} k(1+\\alpha)}{C_{d,unit}(1+\\alpha)} = k$$\n\n**3. $k$ 输入或非门 ($\\mathrm{NOR}_k$) 的分析**\n\n一个 $k$ 输入或非门由一个包含 $k$ 个并联nMOS晶体管的下拉网络和一个包含 $k$ 个串联pMOS晶体管的上拉网络组成。设其宽度分别为 $W_{n,\\mathrm{NOR}}$ 和 $W_{p,\\mathrm{NOR}}$。\n\n*   **为匹配电阻而进行的尺寸调整：**\n    *   最坏情况下的下拉电阻发生在 $k$ 个并联nMOS晶体管中只有一个导通时：$R_{pd,\\mathrm{NOR}} = R_{n}(W_{n,\\mathrm{NOR}}) = \\frac{R_{n,unit}}{W_{n,\\mathrm{NOR}}}$。\n    为匹配参考驱动能力，我们设置 $R_{pd,\\mathrm{NOR}} = R_{\\mathrm{ref}} = R_{n,unit}$：\n    $$\\frac{R_{n,unit}}{W_{n,\\mathrm{NOR}}} = R_{n,unit} \\implies W_{n,\\mathrm{NOR}} = 1$$\n    *   上拉电阻是 $k$ 个串联pMOS晶体管的电阻之和：$R_{pu,\\mathrm{NOR}} = k \\cdot R_{p}(W_{p,\\mathrm{NOR}}) = k \\frac{R_{p,unit}}{W_{p,\\mathrm{NOR}}} = k \\frac{\\alpha R_{n,unit}}{W_{p,\\mathrm{NOR}}}$。\n    为匹配参考驱动能力，我们设置 $R_{pu,\\mathrm{NOR}} = R_{\\mathrm{ref}} = R_{n,unit}$：\n    $$k \\frac{\\alpha R_{n,unit}}{W_{p,\\mathrm{NOR}}} = R_{n,unit} \\implies W_{p,\\mathrm{NOR}} = k \\alpha$$\n\n*   **逻辑努力 ($g_{\\mathrm{NOR}_k}$):**\n    一个输入的电容来自一个nMOS和一个pMOS栅极。\n    $$C_{\\mathrm{in},\\mathrm{NOR}} = C_{g,unit}(W_{n,\\mathrm{NOR}} + W_{p,\\mathrm{NOR}}) = C_{g,unit}(1 + k\\alpha)$$\n    $$g_{\\mathrm{NOR}_k} = \\frac{C_{\\mathrm{in},\\mathrm{NOR}}}{C_{\\mathrm{inv}}} = \\frac{C_{g,unit}(1 + k\\alpha)}{C_{g,unit}(1 + \\alpha)} = \\frac{1 + k\\alpha}{1 + \\alpha}$$\n    代入 $\\alpha=2$，我们得到 $g_{\\mathrm{NOR}_k} = \\frac{1+2k}{3}$。\n\n*   **寄生延迟 ($p_{\\mathrm{NOR}_k}$):**\n    输出节点连接到所有 $k$ 个nMOS晶体管的漏极和串联堆叠底部的单个pMOS的漏极。\n    $$C_{p,\\mathrm{NOR}} = (k \\cdot C_{d,n,unit} \\cdot W_{n,\\mathrm{NOR}}) + (1 \\cdot C_{d,p,unit} \\cdot W_{p,\\mathrm{NOR}})$$\n    使用我们的假设 $C_{d,n,unit}=C_{d,p,unit}=C_{d,unit}$：\n    $$C_{p,\\mathrm{NOR}} = C_{d,unit}(k \\cdot W_{n,\\mathrm{NOR}} + W_{p,\\mathrm{NOR}}) = C_{d,unit}(k \\cdot 1 + k\\alpha) = C_{d,unit} k(1+\\alpha)$$\n    寄生延迟是寄生电容之比：\n    $$p_{\\mathrm{NOR}_k} = \\frac{C_{p,\\mathrm{NOR}}}{C_{p,\\mathrm{inv}}} = \\frac{C_{d,unit} k(1+\\alpha)}{C_{d,unit}(1+\\alpha)} = k$$\n\n**4. 最终表达式**\n\n我们整理结果并代入给定的值 $\\alpha=2$。\n- $k$ 输入与非门的逻辑努力：$g_{\\mathrm{NAND}_k} = \\frac{k+2}{3}$\n- $k$ 输入与非门的寄生延迟：$p_{\\mathrm{NAND}_k} = k$\n- $k$ 输入或非门的逻辑努力：$g_{\\mathrm{NOR}_k} = \\frac{1+2k}{3}$\n- $k$ 输入或非门的寄生延迟：$p_{\\mathrm{NOR}_k} = k$\n\n最终答案是有序集合 $(g_{\\mathrm{NAND}_k}, p_{\\mathrm{NAND}_k}, g_{\\mathrm{NOR}_k}, p_{\\mathrm{NOR}_k})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k+2}{3}, & k, & \\frac{1+2k}{3}, & k\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了单个逻辑门的参数后，我们现在可以应对核心挑战：为获得最高速度而优化一条完整的逻辑路径。本练习提供了一个具体的多级路径，要求你进行全面分析以找到其最小可能延迟。这个实践是应用逻辑努力核心方法的综合演练，涵盖了从计算路径级的各种“力”到确定最优尺寸和最终延迟的整个过程 ，从而将理论与实际设计计算联系起来。",
            "id": "4279965",
            "problem": "一个专用集成电路（application-specific integrated circuit, ASIC）中的组合逻辑路径，将使用电子设计自动化（Electronic Design Automation, EDA）工具进行综合与尺寸优化，该路径由顺序连接的 $4$ 级构成。对于第 $i \\in \\{1,2,3,4\\}$ 级，其逻辑努力为 $g_i$，分支努力为 $b_i$，寄生延迟为 $p_i$。各级具有以下特性：\n\n- 第 $1$ 级：$g_1 = 1$, $b_1 = 1.5$, $p_1 = 1$。\n- 第 $2$ 级：$g_2 = \\frac{4}{3}$, $b_2 = 1$, $p_2 = 2$。\n- 第 $3$ 级：$g_3 = \\frac{5}{3}$, $b_3 = 2$, $p_3 = 2$。\n- 第 $4$ 级：$g_4 = 1$, $b_4 = 1$, $p_4 = 1$。\n\n路径输入端的输入电容为 $C_{\\text{in}}$，路径输出端的负载为 $C_{\\text{out}} = 21.6\\,C_{\\text{in}}$。假设逻辑努力、电学努力、分支努力、路径努力、级努力和归一化延迟均采用逻辑努力法中的标准定义，并忽略互连寄生参数和速度饱和效应。\n\n仅使用逻辑努力的核心定义以及从第一性原理推导出的等级努力相等最优性条件，确定：\n\n- 使总路径延迟最小化的最优公共级努力 $f$。\n- 分配给每一级的电学努力 $h_i$。\n- 路径的最终最小总归一化延迟。\n\n请用数值表示最优总路径延迟的最终答案，以逻辑努力法中使用的归一化延迟为单位，并四舍五入到四位有效数字。最终答案中不要包含单位。所有中间推理过程必须与基本定义和最小化原理一致；不得在未从这些定义推导的情况下假设任何经验性的“经验法则”值。",
            "solution": "该问题要求使用逻辑努力法对一个4级逻辑路径进行优化设计。一个包含 $N$ 级的路径的总归一化延迟 $D$ 是每一级延迟的总和：\n$$D = \\sum_{i=1}^{N} d_i$$\n单个级 $i$ 的延迟 $d_i$ 由其努力延迟 $f_i$ 和其寄生延迟 $p_i$ 的和给出：\n$$d_i = f_i + p_i$$\n努力延迟，或称级努力，$f_i$ 是该级的逻辑努力 $g_i$ 与其电学努力 $h_i$ 的乘积：\n$$f_i = g_i h_i$$\n逻辑努力 $g_i$ 是逻辑门拓扑的固有属性。寄生延迟 $p_i$ 也是一个固有属性，表示该门驱动零负载时的延迟。电学努力 $h_i$ 定义为该级驱动的总电容 $C_{\\text{out},i}$ 与其输入电容 $C_{\\text{in},i}$ 的比值：\n$$h_i = \\frac{C_{\\text{out},i}}{C_{\\text{in},i}}$$\n题目为每一级指定了分支努力 $b_i$，它说明了到非主路径上的负载的扇出。它定义为第 $i$ 级输出端的总电容与路径上电容（即下一级的输入电容 $C_{\\text{in},i+1}$）的比值：\n$$b_i = \\frac{C_{\\text{out},i}}{C_{\\text{in},i+1}}$$\n因此，$C_{\\text{out},i} = b_i C_{\\text{in},i+1}$。第 $i$ 级的电学努力可以表示为：\n$$h_i = \\frac{b_i C_{\\text{in},i+1}}{C_{\\text{in},i}}$$\n因此，总路径延迟为：\n$$D = \\sum_{i=1}^{N} (g_i h_i + p_i) = \\sum_{i=1}^{N} g_i h_i + \\sum_{i=1}^{N} p_i$$\n为了最小化延迟，我们必须选择门的尺寸，这决定了输入电容 $C_{\\text{in},i}$，从而决定了电学努力 $h_i$。$h_i$ 的值受到整个路径规格的约束。路径上所有电学努力的乘积是：\n$$ \\prod_{i=1}^{N} h_i = \\prod_{i=1}^{N} \\left(\\frac{b_i C_{\\text{in},i+1}}{C_{\\text{in},i}}\\right) = \\left(\\prod_{i=1}^{N} b_i\\right) \\left(\\frac{C_{\\text{in},2}}{C_{\\text{in},1}}\\frac{C_{\\text{in},3}}{C_{\\text{in},2}} \\cdots \\frac{C_{\\text{in},N+1}}{C_{\\text{in},N}}\\right) $$\n令 $C_{\\text{in},1} = C_{\\text{in}}$ 且 $C_{\\text{in},N+1} = C_{\\text{out}}$。该乘积简化为：\n$$ \\prod_{i=1}^{N} h_i = \\left(\\prod_{i=1}^{N} b_i\\right) \\left(\\frac{C_{\\text{out}}}{C_{\\text{in}}}\\right) $$\n我们定义路径分支努力 $B = \\prod_{i=1}^{N} b_i$ 和路径电学努力 $H = C_{\\text{out}} / C_{\\text{in}}$。约束条件变为：\n$$ \\prod_{i=1}^{N} h_i = B H $$\n问题是在此约束下最小化 $D$。设 $P = \\sum_{i=1}^{N} p_i$ 为总寄生延迟，它是一个常数。我们必须最小化 $\\sum_{i=1}^{N} g_i h_i$。使用拉格朗日乘子法，达到最小值的条件是所有级努力 $f_i = g_i h_i$ 都必须等于一个公共值 $f$：\n$$ f_1 = f_2 = \\dots = f_N = f $$\n各级努力的乘积是路径努力 $F$：\n$$ F = \\prod_{i=1}^{N} f_i = \\prod_{i=1}^{N} (g_i h_i) = \\left(\\prod_{i=1}^{N} g_i\\right) \\left(\\prod_{i=1}^{N} h_i\\right) $$\n定义路径逻辑努力 $G = \\prod_{i=1}^{N} g_i$，我们得到：\n$$ F = G (B H) = GBH $$\n由于所有级努力都等于 $f$，它们的乘积为 $F = f^N$。由此可得最优公共级努力：\n$$ f = F^{1/N} = (GBH)^{1/N} $$\n那么最小总路径延迟为：\n$$ D_{\\text{min}} = \\sum_{i=1}^{N} (f + p_i) = N f + P $$\n\n现在，我们将此框架应用于给定问题。\n级数为 $N=4$。给定条件如下：\n- 第 $1$ 级：$g_1 = 1$, $b_1 = 1.5$, $p_1 = 1$。\n- 第 $2$ 级：$g_2 = \\frac{4}{3}$, $b_2 = 1$, $p_2 = 2$。\n- 第 $3$ 级：$g_3 = \\frac{5}{3}$, $b_3 = 2$, $p_3 = 2$。\n- 第 $4$ 级：$g_4 = 1$, $b_4 = 1$, $p_4 = 1$。\n\n首先，我们计算路径级别的参数 $G$、$B$、$H$ 和 $P$。\n路径逻辑努力：\n$$ G = g_1 g_2 g_3 g_4 = 1 \\cdot \\frac{4}{3} \\cdot \\frac{5}{3} \\cdot 1 = \\frac{20}{9} $$\n路径分支努力：\n$$ B = b_1 b_2 b_3 b_4 = 1.5 \\cdot 1 \\cdot 2 \\cdot 1 = 3 $$\n路径电学努力：\n$$ H = \\frac{C_{\\text{out}}}{C_{\\text{in}}} = 21.6 $$\n总寄生延迟：\n$$ P = p_1 + p_2 + p_3 + p_4 = 1 + 2 + 2 + 1 = 6 $$\n接下来，我们计算路径努力 $F$：\n$$ F = GBH = \\frac{20}{9} \\cdot 3 \\cdot 21.6 = \\frac{20}{3} \\cdot 21.6 = 20 \\cdot 7.2 = 144 $$\n\n在确定了路径努力后，我们求出最优公共级努力 $f$：\n$$ f = F^{1/N} = (144)^{1/4} = (12^2)^{1/4} = 12^{1/2} = \\sqrt{12} = \\sqrt{4 \\cdot 3} = 2\\sqrt{3} $$\n最优公共级努力为 $f=2\\sqrt{3}$。\n\n接下来，我们求出分配给每级的电学努力 $h_i$。在最优条件下，$f_i = g_i h_i = f$。因此，$h_i = f/g_i$。\n- 第 $1$ 级：$h_1 = \\frac{f}{g_1} = \\frac{2\\sqrt{3}}{1} = 2\\sqrt{3}$\n- 第 $2$ 级：$h_2 = \\frac{f}{g_2} = \\frac{2\\sqrt{3}}{4/3} = \\frac{6\\sqrt{3}}{4} = \\frac{3\\sqrt{3}}{2}$\n- 第 $3$ 级：$h_3 = \\frac{f}{g_3} = \\frac{2\\sqrt{3}}{5/3} = \\frac{6\\sqrt{3}}{5}$\n- 第 $4$ 级：$h_4 = \\frac{f}{g_4} = \\frac{2\\sqrt{3}}{1} = 2\\sqrt{3}$\n\n最后，我们计算路径的最小总归一化延迟 $D_{\\text{min}}$：\n$$ D_{\\text{min}} = Nf + P = 4(2\\sqrt{3}) + 6 = 8\\sqrt{3} + 6 $$\n为了提供数值答案，我们使用 $\\sqrt{3} \\approx 1.7320508...$ 的值：\n$$ D_{\\text{min}} \\approx 8(1.7320508) + 6 = 13.8564064 + 6 = 19.8564064 $$\n四舍五入到四位有效数字，结果是 $19.86$。",
            "answer": "$$\\boxed{19.86}$$"
        },
        {
            "introduction": "路径优化中一个更微妙但至关重要的方面是，局部的“改进”有时反而会使全局结果恶化。这个思想实验挑战了一种直觉，即让单个逻辑门“更强”总是有益的。通过分析在一个已优化的路径中单方面调整某个逻辑门尺寸所带来的后果 ，你将揭示延迟的系统性本质，并巩固对为何保持整个路径上各级努力均衡对实现真正优化至关重要的理解。",
            "id": "4279983",
            "problem": "在互补金属氧化物半导体（CMOS）组合逻辑网络中，一条路径由 $3$ 个无分支串联的门组成：门 $1$ 是一个反相器，门 $2$ 是一个两输入与非门，门 $3$ 是一个驱动负载电容 $C_{L}$ 的反相器。使用标准的逻辑努力延迟模型，其中级延迟 $d_{i} = g_{i} h_{i} + p_{i}$ 以参考时间常数为单位进行测量，其中 $g_{i}$ 是第 $i$ 级的逻辑努力，$h_{i}$ 是第 $i$ 级的电学努力，定义为其输出负载电容与自身输入电容之比，$p_{i}$ 是第 $i$ 级的寄生延迟。假设 $g_{\\text{inv}} = 1$, $p_{\\text{inv}} = 1$, $g_{\\text{NAND2}} = \\tfrac{4}{3}$ 以及 $p_{\\text{NAND2}} = 2$。没有分支，因此所有级的分支努力均为 $1$。\n\n该路径最初在固定末端负载 $C_{L}$ 和门 $1$ 输入端的固定路径输入电容 $C_{1}$ 条件下，为实现最小延迟而调整了尺寸，并且三个门级被设计为具有相等的级努力。为具体起见，设 $C_{1} = C_{\\text{unit}}$ 且 $C_{L} = 6 C_{\\text{unit}}$，其中 $C_{\\text{unit}}$ 是一个参考反相器的输入电容。\n\n然后，一名工程师单方面将门 $2$（与非门）的尺寸增大了 $2$ 倍，将其晶体管宽度以及输入电容都扩大了 $2$ 倍，同时保持门 $1$ 和门 $3$ 不变。末端负载 $C_{L}$ 和路径输入电容 $C_{1}$ 保持不变。\n\n基于逻辑努力法的基本原理和上述定义，以下哪些陈述是正确的？选择所有适用项。\n\nA. 增大门 $2$ 的尺寸后，总路径延迟严格减小，因为门 $2$ 电学努力的减小总是超过任何上游效应。\n\nB. 在这种情况下，增大门 $2$ 的尺寸后，总路径延迟可能增加，因为门 $2$ 输入电容的增加提高了门 $1$ 的电学努力；如果不重新平衡所有级以恢复相等的级努力，路径就会偏离最小延迟点。\n\nC. 当门 $2$ 的尺寸增大时，路径努力 $F$ 减小，因为 $F$ 取决于出现在级努力乘积中的中间门电容。\n\nD. 仅增大门 $2$ 的尺寸后，相等级努力的条件被破坏；重新平衡整个链以重新建立相等的级努力，将会为给定的 $C_{1}$ 和 $C_{L}$ 恢复最小延迟。\n\nE. 在逻辑努力模型中，增大一个门的尺寸会使其寄生延迟 $p$ 与其尺寸成比例增加，因此门 $2$ 的延迟增加有两个原因：更高的 $p$ 和来自门 $1$ 的更高输入负载。",
            "solution": "我们从逻辑努力延迟模型开始，这是数字集成电路时序分析中一个被广泛接受的基础。对于一个级 $i$，其延迟为 $d_{i} = g_{i} h_{i} + p_{i}$，其中 $h_{i} = C_{\\text{out},i} / C_{\\text{in},i}$。对于一条没有分支的路径，总延迟为 $D = \\sum_{i} (g_{i} h_{i} + p_{i})$。级努力为 $f_{i} = g_{i} h_{i}$。对于一个具有固定输入电容 $C_{1}$ 和固定末端负载 $C_{L}$ 的 $N$ 级链，令 $C_{i}$ 表示第 $i$ 级的输入电容，则电学努力分别为 $h_{1} = C_{2}/C_{1}$，$h_{2} = C_{3}/C_{2}$ 和 $h_{3} = C_{L}/C_{3}$。路径努力 $F$ 是各级努力的乘积，$F = \\prod_{i=1}^{N} f_{i} = \\left(\\prod_{i=1}^{N} g_{i}\\right) \\left(\\prod_{i=1}^{N} h_{i}\\right) = G \\cdot H$，其中 $G = \\prod_{i=1}^{N} g_{i}$ 是路径逻辑努力，$H = C_{L}/C_{1}$ 是路径电学努力。关键在于，$F$ 仅取决于 $G$ 和 $H$，并且与中间门的尺寸无关。在固定 $C_{1}$ 和 $C_{L}$ 的情况下，当各级努力相等时，即 $f_{1} = f_{2} = \\cdots = f_{N}$，可以实现最小延迟的尺寸设计，这源于延迟的凸性，并可通过使用 Lagrange 乘数法，在 $\\prod_{i=1}^{N} f_{i} = F$ 的约束下最小化 $\\sum_{i=1}^{N} f_{i}$ 来推导。\n\n给定 $N = 3$，$g_{1} = 1$（反相器），$g_{2} = \\tfrac{4}{3}$（两输入与非门），$g_{3} = 1$（反相器），以及 $p_{1} = 1$，$p_{2} = 2$，$p_{3} = 1$，无分支，我们有 $G = g_{1} g_{2} g_{3} = \\tfrac{4}{3}$ 和 $H = C_{L}/C_{1} = 6$。因此，路径努力为 $F = G H = \\tfrac{4}{3} \\cdot 6 = 8$。在级努力相等的情况下，$f_{1} = f_{2} = f_{3} = f$，并且由于 $\\prod_{i=1}^{3} f_{i} = f^{3} = F$，我们得到 $f = F^{1/3} = 2$。\n\n从 $f_{i} = g_{i} h_{i}$ 和 $h_{i} = C_{\\text{out},i}/C_{\\text{in},i}$，相等努力条件得出：\n- 对于第 $1$ 级：$g_{1} \\cdot \\frac{C_{2}}{C_{1}} = f \\Rightarrow \\frac{C_{2}}{C_{1}} = \\frac{f}{g_{1}} = \\frac{2}{1} = 2$，所以 $C_{2} = 2 C_{1}$。\n- 对于第 $2$ 级：$g_{2} \\cdot \\frac{C_{3}}{C_{2}} = f \\Rightarrow \\frac{C_{3}}{C_{2}} = \\frac{f}{g_{2}} = \\frac{2}{4/3} = \\frac{3}{2}$，所以 $C_{3} = \\frac{3}{2} C_{2} = 3 C_{1}$。\n- 对于第 $3$ 级：$g_{3} \\cdot \\frac{C_{L}}{C_{3}} = f \\Rightarrow \\frac{C_{L}}{C_{3}} = \\frac{f}{g_{3}} = \\frac{2}{1} = 2$，所以 $C_{L} = 2 C_{3} = 6 C_{1}$，这与给定的 $C_{L}$ 一致。\n\n初始的各级延迟为：\n- 第 $1$ 级：$d_{1} = g_{1} h_{1} + p_{1} = 2 + 1 = 3$。\n- 第 $2$ 级：$d_{2} = g_{2} h_{2} + p_{2} = 2 + 2 = 4$。\n- 第 $3$ 级：$d_{3} = g_{3} h_{3} + p_{3} = 2 + 1 = 3$。\n\n初始总路径延迟为 $D_{\\text{init}} = d_{1} + d_{2} + d_{3} = 10$。\n\n现在，工程师将门 $2$ 的尺寸增大了 $2$ 倍，同时保持门 $1$ 和门 $3$ 不变。这一操作使 $C_{2}$ 翻倍，但 $C_{1}$、$C_{3}$ 和 $C_{L}$ 保持不变。因此，在单方面增大尺寸后：\n- $C_{2}' = 2 \\cdot C_{2} = 4 C_{1}$。\n- $C_{3}' = C_{3} = 3 C_{1}$。\n- $C_{1}' = C_{1}$ 且 $C_{L}' = C_{L}$。\n\n新的电学努力为：\n- $h_{1}' = \\frac{C_{2}'}{C_{1}'} = \\frac{4 C_{1}}{C_{1}} = 4$。\n- $h_{2}' = \\frac{C_{3}'}{C_{2}'} = \\frac{3 C_{1}}{4 C_{1}} = \\frac{3}{4}$。\n- $h_{3}' = \\frac{C_{L}'}{C_{3}'} = \\frac{6 C_{1}}{3 C_{1}} = 2$。\n\n级努力变为：\n- $f_{1}' = g_{1} h_{1}' = 1 \\cdot 4 = 4$。\n- $f_{2}' = g_{2} h_{2}' = \\frac{4}{3} \\cdot \\frac{3}{4} = 1$。\n- $f_{3}' = g_{3} h_{3}' = 1 \\cdot 2 = 2$。\n\n这些值不相等，表明偏离了最小延迟条件。总路径努力保持为 $F' = f_{1}' f_{2}' f_{3}' = 4 \\cdot 1 \\cdot 2 = 8$，与原始的 $F$ 相等，这证实了它不因中间尺寸调整而改变，因为 $F = G H$ 仅取决于 $G$ 和 $H$，而与 $C_{2}$ 或 $C_{3}$ 的具体值无关。\n\n新的各级延迟为：\n- $d_{1}' = g_{1} h_{1}' + p_{1} = 4 + 1 = 5$。\n- $d_{2}' = g_{2} h_{2}' + p_{2} = 1 + 2 = 3$。\n- $d_{3}' = g_{3} h_{3}' + p_{3} = 2 + 1 = 3$。\n\n因此，新的总路径延迟为 $D' = d_{1}' + d_{2}' + d_{3}' = 11$，大于初始延迟 $D_{\\text{init}} = 10$。延迟增加的原因是，增大一个早期门的尺寸会增加其前级的输入负载，从而使其前级的级努力和延迟增加的量超过了尺寸增大的门所实现的延迟减少量，除非重新调整整个链的尺寸以重新建立相等的级努力。\n\n最后，回顾一个关键的建模要点：在归一化的逻辑努力模型中，寄生延迟 $p_{i}$ 是一个门的拓扑参数，不随门尺寸的变化而变化；增大一个门的尺寸不会改变 $p_{i}$。\n\n逐项分析：\n- A. 声称增大门 $2$ 尺寸后延迟严格减小。这与明确的计算结果相矛盾：$D'$ 从 $10$ 增加到 $11$。此外，一般而言，单方面增大早期门的尺寸会增加上游负载和总延迟。结论 — 错误。\n- B. 指出总路径延迟可能增加，原因是上游负载增加和相等级努力的丧失，除非重新平衡所有级。这与数值结果以及最小延迟需要相等级努力的理论都相符。结论 — 正确。\n- C. 声称当门 $2$ 的尺寸增大时，路径努力 $F$ 减小。我们计算出 $F' = F = 8$，并且通常 $F = G H$ 仅取决于 $G$ 和 $H$，而与中间尺寸无关。结论 — 错误。\n- D. 指出仅增大门 $2$ 的尺寸会破坏相等级努力的条件，而重新平衡以恢复相等级努力将为固定的端点恢复最小延迟。我们发现 $f_{1}' \\neq f_{2}' \\neq f_{3}'$，因此该条件被破坏；恢复相等的级努力会为固定的 $C_{1}$ 和 $C_{L}$ 重新达到最小值。结论 — 正确。\n- E. 断言在逻辑努力模型中，寄生延迟 $p$ 随尺寸增加而增加。在该模型中，$p$ 是一个依赖于拓扑的常数，已对工艺参考值进行归一化，并且不随门尺寸变化。因此，所述理由是错误的。结论 — 错误。",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}