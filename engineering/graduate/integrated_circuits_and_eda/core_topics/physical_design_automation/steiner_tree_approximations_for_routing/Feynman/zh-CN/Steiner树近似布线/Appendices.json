{
    "hands_on_practices": [
        {
            "introduction": "斯坦纳树问题的核心难点在于寻找最优的“斯坦纳点”来最小化总线长。一个常见的简化方法是完全忽略斯坦纳点，仅在给定的引脚之间构建一棵最小生成树（MST）。本练习  将通过一个精心设计的具体实例，让您亲手计算并比较MST和真正的直线斯坦纳最小树（RSMT）的成本。通过这个实践，您将直观地理解引入斯坦纳点的价值，并量化MST启发式算法在特定情况下的次优程度。",
            "id": "4302228",
            "problem": "在集成电路的电子设计自动化（EDA）背景下，单个金属层上的直角互连使用曼哈顿度量进行建模，其中导线段的长度是其水平和垂直跨度绝对值之和。直角斯坦纳最小树（RSMT）问题要求找到一棵总直角长度最小的树，以连接一组给定的端点引脚，并允许引入称为斯坦纳点（Steiner points）的非端点连接点。对于最优解，可以假定这些斯坦纳点位于Hanan网格（所有穿过端点的水平线和垂直线的集合）上。相比之下，仅在端点集上应用的最小生成树（MST）启发式算法将树的边限制在以曼哈顿距离测量的端点之间，不允许使用斯坦纳点。\n\n考虑位于平面上一个菱形四个顶点的四个端点，其坐标分别为 $\\left(0,4\\right)$、$\\left(4,0\\right)$、$\\left(8,4\\right)$ 和 $\\left(4,8\\right)$。请仅使用基本原理和核心定义（曼哈顿距离、生成树的无环性以及Hanan网格属性），完成以下任务：\n\n1. 证明任何在端点集上使用曼哈顿度量构建的MST的总长度 $L_{\\mathrm{MST}}$ 必须等于三条长度为$8$的边的总和，并计算 $L_{\\mathrm{MST}}$。\n2. 通过在Hanan网格上的点 $\\left(4,4\\right)$ 引入一个斯坦纳点来构建一个RSMT候选树，计算其总长度 $L_{\\mathrm{RSMT}}$，并通过一个不依赖于快捷公式的有效下界（例如，从跨越水平和垂直范围的必要性进行论证）来证明其对于此实例的最优性。\n3. 计算此实例的精确次优比 $\\rho = L_{\\mathrm{MST}} / L_{\\mathrm{RSMT}}$。\n\n将最终答案表示为单个实数值或单个闭式解析表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "该问题经确认为自洽问题，在计算几何和电子设计自动化领域具有科学依据，且提法明确。我们通过解决三个指定的任务来给出解答。\n\n四个端点的集合由坐标 $\\mathcal{T} = \\{P_1, P_2, P_3, P_4\\}$ 给出，其中 $P_1 = \\left(0,4\\right)$，$P_2 = \\left(4,0\\right)$，$P_3 = \\left(8,4\\right)$，$P_4 = \\left(4,8\\right)$。距离度量为曼哈顿距离或 $L_1$ 距离，对于两个点 $(x_a, y_a)$ 和 $(x_b, y_b)$，定义为 $d_1\\left((x_a, y_a), (x_b, y_b)\\right) = |x_a - x_b| + |y_a - y_b|$。\n\n1.  最小生成树（MST）长度 $L_{\\mathrm{MST}}$ 的计算\n\n首先，我们计算集合 $\\mathcal{T}$ 中每对端点之间的曼哈顿距离。共有 $\\binom{4}{2} = 6$ 对。\n$d_1(P_1, P_2) = |0 - 4| + |4 - 0| = 4 + 4 = 8$。\n$d_1(P_1, P_3) = |0 - 8| + |4 - 4| = 8 + 0 = 8$。\n$d_1(P_1, P_4) = |0 - 4| + |4 - 8| = 4 + 4 = 8$。\n$d_1(P_2, P_3) = |4 - 8| + |0 - 4| = 4 + 4 = 8$。\n$d_1(P_2, P_4) = |4 - 4| + |0 - 8| = 0 + 8 = 8$。\n$d_1(P_3, P_4) = |8 - 4| + |4 - 8| = 4 + 4 = 8$。\n\n这4个端点之间的所有两两配对距离均等于8。在端点图上的最小生成树必须使用恰好 $n-1=3$ 条边连接所有 $n=4$ 个顶点，同时使总边权重最小化。由于所有可能的边的权重都为8，任何形成生成树（即连接所有顶点且不形成环路）的3条边的集合都是一个MST。例如，使用边 $(P_1, P_2)$、$(P_2, P_3)$ 和 $(P_3, P_4)$ 的路径图就是一个MST。任何此类MST的总长度是其三条边长度之和。\n\n因此，MST的长度为：\n$$L_{\\mathrm{MST}} = 8 + 8 + 8 = 3 \\times 8 = 24$$\n\n2.  直角斯坦纳最小树（RSMT）的构建与最优性证明\n\n我们需要通过引入一个斯坦纳点 $S = \\left(4,4\\right)$ 来构建一个候选树。该点位于Hanan网格上，该网格由所有穿过端点的水平线和垂直线构成，具体来说，该点位于垂直线 $x=4$ 和水平线 $y=4$ 的交点上。\n\n该斯坦纳树通过将4个端点中的每一个连接到这个中心斯坦纳点S而形成。这些连接的长度为：\n$d_1(S, P_1) = d_1\\left(\\left(4,4\\right), \\left(0,4\\right)\\right) = |4-0| + |4-4| = 4$。\n$d_1(S, P_2) = d_1\\left(\\left(4,4\\right), \\left(4,0\\right)\\right) = |4-4| + |4-0| = 4$。\n$d_1(S, P_3) = d_1\\left(\\left(4,4\\right), \\left(8,4\\right)\\right) = |4-8| + |4-4| = 4$。\n$d_1(S, P_4) = d_1\\left(\\left(4,4\\right), \\left(4,8\\right)\\right) = |4-4| + |4-8| = 4$。\n\n这个候选斯坦纳树的总长度是这四段长度之和：\n$$L_{\\mathrm{candidate}} = 4 + 4 + 4 + 4 = 16$$\n\n为证明该树的最优性，我们为连接给定端点的任意直角斯坦纳树（RST）的长度建立一个基本下界。任何直角树的总长度L可以分解为其总水平长度$L_x$和总垂直长度$L_y$，使得$L = L_x + L_y$。\n\n对于任何连接该端点集的树，其在x轴上的投影长度必须跨越由端点的最小和最大x坐标定义的区间。x坐标的集合为 $\\{0, 4, 8\\}$。水平跨度为 $\\Delta x = \\max(\\{0, 4, 8\\}) - \\min(\\{0, 4, 8\\}) = 8 - 0 = 8$。因此，对于任何连接树，$L_x \\ge \\Delta x = 8$。\n\n类似地，y坐标的集合为 $\\{0, 4, 8\\}$。垂直跨度为 $\\Delta y = \\max(\\{0, 4, 8\\}) - \\min(\\{0, 4, 8\\}) = 8 - 0 = 8$。因此，对于任何连接树，$L_y \\ge \\Delta y = 8$。\n\n任何RST总长度的一个下界是这些最小跨度之和：\n$$L(\\mathrm{RST}) \\ge \\Delta x + \\Delta y = 8 + 8 = 16$$\n\n使用斯坦纳点 $S=(4,4)$ 构建的候选树包含一个从 $(0,4)$ 到 $(4,4)$ 的水平段和另一个从 $(4,4)$ 到 $(8,4)$ 的水平段，总水平长度为 $4+4=8$。它还包含一个从 $(4,0)$ 到 $(4,4)$ 的垂直段和另一个从 $(4,4)$ 到 $(4,8)$ 的垂直段，总垂直长度为 $4+4=8$。该树的总长度是 $8+8=16$。\n\n由于我们候选树的长度 $16$ 等于已建立的下界，它必定是直角斯坦纳最小树。因此，RSMT的长度为：\n$$L_{\\mathrm{RSMT}} = 16$$\n\n3.  次优比 $\\rho$ 的计算\n\n在此实例中，MST启发式算法的次优比定义为 $\\rho = L_{\\mathrm{MST}} / L_{\\mathrm{RSMT}}$。使用上面推导出的值：\n$$L_{\\mathrm{MST}} = 24$$\n$$L_{\\mathrm{RSMT}} = 16$$\n\n该比率为：\n$$\\rho = \\frac{L_{\\mathrm{MST}}}{L_{\\mathrm{RSMT}}} = \\frac{24}{16}$$\n化简分数得到：\n$$\\rho = \\frac{3}{2}$$",
            "answer": "$$\\boxed{\\frac{3}{2}}$$"
        },
        {
            "introduction": "在掌握了斯坦纳点的基本价值之后，我们进一步探讨现实世界中的布线约束如何影响最优解。在集成电路中，信号路径通常是单向的，并需遵循特定的布线规则，例如“先垂直后水平”（VH）的走线模式。本练习  将引导您分析这些方向性约束如何将一个无向的SMT问题转化为一个有向的斯坦纳树（RSA）问题。通过解决这个问题，您将发现设计规则会如何限制路径共享，从而导致与纯几何最优解不同的拓扑结构和更高的布线成本。",
            "id": "4302251",
            "problem": "考虑在电子设计自动化（EDA）中，在一个具有优选方向的直角网格上进行布线，其中每个互连线段都必须与坐标轴对齐。设源点为 $s=(0,0)$，汇点为 $t_1=(2,3)$、$t_2=(2,-3)$ 和 $t_3=(6,0)$。一棵树的成本定义为其所有边的总直角（曼哈顿）长度，其中共享边只计算一次。考虑两种布线模型：\n- 无向直角斯坦纳最小树（SMT）：一棵连接 $\\{s,t_1,t_2,t_3\\}$ 的无向树，可能在Hanan网格交点处引入斯坦纳点，以最小化总直角长度。\n- 有向直角斯坦纳树状结构（RSA）：一棵以 $s$ 为根的有向树，其中从 $s$ 到任一汇点的每条路径都必须是远离 $s$ 的有向路径，并且必须满足方向约束。在本问题中，方向约束为每条 $s \\to t_i$ 路径都必须由一个垂直段后跟一个水平段组成（严格的“先垂直后水平”或VH路径），这反映了一种单弯曲排序策略。\n\n从直角（曼哈顿）距离的定义和树中共享的组合结构出发，完成以下任务：\n1. 确定 $\\{s,t_1,t_2,t_3\\}$ 的无向SMT拓扑结构，并计算其总长度 $L_{\\mathrm{SMT}}$。\n2. 证明VH方向约束使得SMT拓扑结构作为有向RSA是不可行的，并从第一性原理出发，论证在VH路径下的共享机会，以确定此实例的最优有向RSA拓扑及其总长度 $L_{\\mathrm{dir}}$。\n3. 计算成本差异 $\\Delta=L_{\\mathrm{dir}}-L_{\\mathrm{SMT}}$。\n\n将最终的成本差异表示为单个实数。无需四舍五入；以纯数字形式报告精确值，不带单位。",
            "solution": "该问题要求在电子设计自动化（EDA）的背景下，对给定网络中两种不同的布线树结构进行分析和比较。该网络包含一个源点 $s$ 和三个汇点 $t_1$、$t_2$ 和 $t_3$。任何树的成本度量是其总直角长度。\n\n首先，对问题进行验证。\n给定的数据是：\n- 源点：$s=(0,0)$。\n- 汇点：$t_1=(2,3)$、$t_2=(2,-3)$、$t_3=(6,0)$。\n- 所有端点的集合为 $P = \\{s, t_1, t_2, t_3\\}$。\n- 成本函数：直角（曼哈顿）距离，其中两点 $(x_1, y_1)$ 和 $(x_2, y_2)$ 之间的距离是 $|x_1-x_2| + |y_1-y_2|$。\n- 模型1：无向直角斯坦纳最小树（SMT）。\n- 模型2：有向直角斯坦纳树状结构（RSA），对所有源到汇的路径都有严格的“先垂直后水平”（VH）路径约束。\n\n该问题在超大规模集成电路（VLSI）物理设计这一成熟领域，特别是在布线算法方面，具有科学依据。SMT、RSA、直角距离和VH等布线约束的概念都是标准且定义明确的。该问题提法恰当，提供了所有必要信息，并且其表述是客观的。因此，该问题被认为是有效的，可以构建解决方案。\n\n任务的第一部分是确定端点集 $P$ 的无向直角斯坦纳最小树（SMT）的拓扑和长度。对于一组端点 $P$，SMT是一棵连接 $P$ 中所有端点的、总直角长度最小的树，它可能使用称为斯坦纳点的附加点。对于直角SMT，最优的斯坦纳点必须位于Hanan网格上，该网格由穿过所有端点的所有垂直和水平线形成。\n\n给定的端点是 $s=(0,0)$、$t_1=(2,3)$、$t_2=(2,-3)$ 和 $t_3=(6,0)$。我们观察到端点位置的对称性：$t_1$ 和 $t_2$ 关于x轴对称，而 $s$ 和 $t_3$ 位于此对称轴上。由于这种对称性，最优的SMT可以预期是关于x轴对称的。端点坐标的几何中位数是主要斯坦纳点的一个很好的候选。x坐标为 $\\{0, 2, 2, 6\\}$，中位数为 $2$。y坐标为 $\\{-3, 0, 0, 3\\}$，中位数为 $0$。这表明中心斯坦纳点位于 $(2,0)$。\n\n让我们使用 $(2,0)$ 作为斯坦纳点来构建一棵树。我们可以将所有四个端点连接到此点。\n- 从 $s=(0,0)$ 到 $(2,0)$ 的路径是一条长度为 $2$ 的水平线段。\n- 从 $t_1=(2,3)$ 到 $(2,0)$ 的路径是一条长度为 $3$ 的垂直线段。\n- 从 $t_2=(2,-3)$ 到 $(2,0)$ 的路径是一条长度为 $3$ 的垂直线段。\n- 从 $t_3=(6,0)$ 到 $(2,0)$ 的路径是一条长度为 $4$ 的水平线段。\n\n这四条路径的并集形成了一棵斯坦纳树。\n- 从 $(0,0)$ 到 $(2,0)$ 的水平线段与从 $(2,0)$ 到 $(6,0)$ 的水平线段的并集是从 $(0,0)$到 $(6,0)$ 的一条水平线段。该线段连接 $s$ 和 $t_3$，总长度为 $6$。\n- 从 $(2,-3)$ 到 $(2,0)$ 的垂直线段与从 $(2,0)$ 到 $(2,3)$ 的垂直线段的并集是从 $(2,-3)$ 到 $(2,3)$ 的一条垂直线段。该线段连接 $t_1$ 和 $t_2$，总长度为 $3 - (-3) = 6$。\n\n最终的SMT拓扑是一个以斯坦纳点 $(2,0)$ 为中心的十字形，其水平主干沿x轴从 $x=0$ 延伸到 $x=6$，垂直主干沿直线 $x=2$ 从 $y=-3$ 延伸到 $y=3$。这棵树的总长度 $L_{\\mathrm{SMT}}$ 是这两条主干线段的长度之和：\n$$L_{\\mathrm{SMT}} = (x_{\\max} - x_{\\min}) + (y_{\\max} - y_{\\min}) = (6 - 0) + (3 - (-3)) = 6 + 6 = 12.$$\n这个长度等于端点边界框的半周长，这是一个已知的下界，对于这种对称配置，该下界是可达到的。因此，最小长度确实是 $12$。\n\n任务的第二部分是分析在严格VH路径约束下的有向直角斯坦纳树状结构（RSA）。首先，我们必须证明SMT拓扑对此类RSA是不可行的。RSA必须是一棵以 $s=(0,0)$ 为根的有向树，所有路径都从 $s$ 出发。要从SMT结构形成一棵有向树，我们会将边从 $s$ 指出。\n- 在SMT拓扑中，从 $s$ 到 $t_1$ 的路径为 $s(0,0) \\to (2,0) \\to t_1(2,3)$。该路径由一个水平段后跟一个垂直段组成，这是一条HV路径。\n- 从 $s$ 到 $t_2$ 的路径为 $s(0,0) \\to (2,0) \\to t_2(2,-3)$，这也是一条HV路径。\n问题规定了严格的“先垂直后水平”（VH）约束。由于SMT结构中到 $t_1$ 和 $t_2$ 的路径是HV路径，因此该拓扑在给定的约束下不是一个有效的RSA。\n\n接下来，我们从第一性原理出发，确定最优有向RSA拓扑及其长度 $L_{\\mathrm{dir}}$。从源点 $(x_s, y_s)$ 到汇点 $(x_t, y_t)$ 的VH路径是唯一确定的。它由从 $(x_s, y_s)$ 到 $(x_s, y_t)$ 的垂直段和从 $(x_s, y_t)$ 到 $(x_t, y_t)$ 的水平段组成。对于我们的问题，源点为 $s=(0,0)$：\n- 到 $t_1=(2,3)$ 的路径由从 $(0,0)$ 到 $(0,3)$ 的垂直段和从 $(0,3)$ 到 $(2,3)$ 的水平段组成。其长度为 $3+2=5$。\n- 到 $t_2=(2,-3)$ 的路径由从 $(0,0)$ 到 $(0,-3)$ 的垂直段和从 $(0,-3)$ 到 $(2,-3)$ 的水平段组成。其长度为 $3+2=5$。\n- 到 $t_3=(6,0)$ 的路径由从 $(0,0)$ 到 $(0,0)$ 的垂直段（长度为 $0$）和从 $(0,0)$ 到 $(6,0)$ 的水平段组成。这是一条纯水平路径，长度为 $6$。\n\nRSA是这三条有向路径的并集。我们通过对各段长度求和来计算其总长度，并考虑重叠（共享）部分。\n- 垂直段都始于 $s=(0,0)$ 并位于y轴上（$x=0$）。到 $t_1$ 的路径使用了从 $(0,0)$ 到 $(0,3)$ 的线段。到 $t_2$ 的路径使用了从 $(0,0)$ 到 $(0,-3)$ 的线段。它们的并集是穿过源点、从 $(0,-3)$ 到 $(0,3)$ 的垂直线段。这个共享垂直主干的总长度为 $3 + |-3| = 6$。\n- 水平段位于不同的y坐标上：对于 $t_1$ 是 $y=3$，对于 $t_2$ 是 $y=-3$，对于 $t_3$ 是 $y=0$。由于它们的y坐标不同，这些水平段是不相交的。\n  - 对于 $t_1$ 的水平段长度为 $|2-0|=2$。\n  - 对于 $t_2$ 的水平段长度为 $|2-0|=2$。\n  - 对于 $t_3$ 的水平段长度为 $|6-0|=6$。\n不相交的水平段总长度为 $2+2+6=10$。\n有向树的总长度 $L_{\\mathrm{dir}}$ 是总垂直长度和总水平长度之和：\n$$L_{\\mathrm{dir}} = 6 + 10 = 16.$$\n这种结构，由位于直线 $x=x_s$ 上的单一垂直主干和通往各汇点的独立水平分支组成，是VH布线模型的最优RSA。\n\n任务的第三部分也是最后一部分是计算成本差异 $\\Delta = L_{\\mathrm{dir}} - L_{\\mathrm{SMT}}$。\n使用计算出的值：\n$$L_{\\mathrm{SMT}} = 12$$\n$$L_{\\mathrm{dir}} = 16$$\n成本差异为：\n$$\\Delta = 16 - 12 = 4.$$\n这一差异突显了由于几何路径共享机会的减少，施加严格的方向约束（VH模型）与无约束（无向）最优斯坦纳树相比所产生的成本惩罚。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "理解了斯坦纳树的几何特性和约束之后，一个核心的工程问题随之而来：我们如何高效地找到这些近似最优的解？许多高级启发式算法都依赖于迭代地添加斯坦纳点。本练习  聚焦于这一过程的基本步骤——寻找最优的“单斯坦纳点”（1-Steiner point）。您将首先分析暴力搜索方法的计算复杂度，然后设计一种高效的数据结构来处理动态更新并快速重新计算最优解。这个实践将几何问题与算法设计紧密联系起来，是开发可扩展EDA工具所需的一项关键技能。",
            "id": "4302254",
            "problem": "考虑电子设计自动化 (EDA) 布线中的一个单一网络，该网络采用直线（曼哈顿）度量，其一组端子位于平面上的位置 $\\{(x_{k}, y_{k})\\}_{k=1}^{r}$，其中 $r \\geq 3$，并假设所有坐标都是网格上的整数。由该端子集诱导的 Hanan 网格是所有通过每个不同端子 $x$ 坐标的垂直线和通过每个不同端子 $y$ 坐标的水平线的交点集合。令 $r_{x}$ 表示不同端子 $x$ 坐标的数量，$r_{y}$ 表示不同端子 $y$ 坐标的数量，因此 Hanan 网格包含 $r_{x} r_{y}$ 个候选点。在一个 1-Steiner 步骤中，我们从 Hanan 网格中选择一个 Steiner 点 $s = (x_{i}, y_{j})$ 插入，以减小一个近似树长度的星形布线目标。对于此问题，将候选 Steiner 点 $s = (x_{i}, y_{j})$ 的评估成本定义为总直线星形长度\n$$\nF(x_{i}, y_{j}) = \\sum_{k=1}^{r} \\left( |x_{k} - x_{i}| + |y_{k} - y_{j}| \\right),\n$$\n即从 $s$ 到所有端子的距离之和。\n\n从以下基本依据出发：\n- Hanan 网格的定义及其对于 $r$ 个端子的尺寸 $r_{x} r_{y}$。\n- 直线距离可分离为独立的 $x$ 和 $y$ 分量。\n- 一个经过充分检验的事实是，绝对偏差之和的最小值在一维上由中位数达到，并且对于一个固定的列表 $\\{u_{k}\\}$，若给定已排序 $\\{u_{k}\\}$ 的前缀和，则对于每个查询 $u$，总和 $\\sum_{k=1}^{r} |u_{k} - u|$ 可以在常数时间内计算。\n\n任务：\n1. 假设从头开始评估每个候选点的 $F$ 需要与 $r$ 成正比的时间，推导对所有 Hanan 网格候选点进行朴素扫描并评估 $F(x_{i}, y_{j})$ 的最坏情况复杂度，该复杂度是关于 $r$、$r_{x}$ 和 $r_{y}$ 的函数。\n2. 提出一个动态数据结构，该结构维护两个维度上的端子坐标多重集，并高效支持以下操作：插入或删除一个端子、在任何 Hanan 网格点查询 $F(x_{i}, y_{j})$、以及重新计算成本最低的 1-Steiner 候选点。该数据结构应实现严格次二次方（相对于 $r$）的更新时间。使用目标函数的可分离性和直线度量下中位数的性质，从第一性原理证明其正确性。\n3. 在您提出的数据结构下，给出执行单次更新（插入或删除一个端子）并重新计算成本最低的 1-Steiner 候选点所需的最坏情况时间的渐近主导项（忽略常数因子和低阶项），仅用 $r$ 的函数表示。\n\n您的最终答案必须是关于 $r$ 的单个闭式解析表达式。不需要单位。在最终报告的表达式中不要包含任何大 O 符号。如果引入任何对数，请使用下标指明其底数。不需要四舍五入。",
            "solution": "根据指定标准评估问题陈述的有效性。\n\n### 问题验证\n\n**第 1 步：提取的已知条件**\n- 电子设计自动化 (EDA) 中的一个单一网络，其一组端子位于位置 $\\{(x_{k}, y_{k})\\}_{k=1}^{r}$。\n- 端子数量为 $r \\geq 3$。\n- 度量为直线（曼哈顿）距离。\n- 所有坐标 $(x_k, y_k)$ 均为网格上的整数。\n- Hanan 网格是所有通过每个不同端子 $x$ 坐标的垂直线和通过每个不同端子 $y$ 坐标的水平线的交点集合。\n- $r_x$ 是不同端子 $x$ 坐标的数量。\n- $r_y$ 是不同端子 $y$ 坐标的数量。\n- Hanan 网格的尺寸为 $r_x r_y$。\n- 一个 1-Steiner 步骤涉及从 Hanan 网格中插入一个 Steiner 点 $s = (x_i, y_j)$。\n- 候选 Steiner 点 $s$ 的评估成本为 $F(x_{i}, y_{j}) = \\sum_{k=1}^{r} \\left( |x_{k} - x_{i}| + |y_{k} - y_{j}| \\right)$。\n- 问题提供了三个出发基础：Hanan 网格的定义、直线距离的可分离性，以及中位数作为绝对偏差之和最小化器的性质，包括关于在静态集合下使用前缀和计算其时间的说明。\n- **任务 1：** 假设每次评估时间为 $O(r)$，推导对所有 Hanan 网格候选点朴素扫描评估 $F(x_i, y_j)$ 的最坏情况复杂度。\n- **任务 2：** 提出一个动态数据结构，支持高效的插入/删除和重新计算最低成本候选点，更新时间严格次二次方。\n- **任务 3：** 使用所提出的数据结构，给出一个单次更新和重新计算的最坏情况时间的渐近主导项，作为 $r$ 的函数。\n\n**第 2 步：使用提取的已知条件进行验证**\n依据验证标准对问题进行评估：\n- **科学依据：** 该问题牢固地植根于电子设计自动化 (EDA) 和计算几何领域。直线距离、Hanan 网格和 1-Steiner 问题的概念是标准且定义明确的。目标函数是 $L_1$ 距离和，通过几何中位数对其进行最小化是一个经典结果。前提在事实和数学上都是合理的。\n- **适定性：** 该问题提供了清晰的定义、一个具体的目标函数，以及三个关于算法复杂度的不同且可回答的任务。每个任务都存在唯一且有意义的解。\n- **客观性：** 该问题使用精确、形式化且无偏见的数学语言进行陈述。\n\n该问题没有表现出任何列出的缺陷：它不是科学上不合理、不可形式化、不完整、矛盾、不现实、不适定或微不足道的。它提出了一个标准但并非微不足道的算法设计挑战。\n\n**第 3 步：结论与行动**\n问题是**有效的**。将为这三个任务提供完整的解决方案。\n\n### 解题推导\n\n需要最小化的目标函数是从候选 Steiner 点 $s = (x_i, y_j)$ 到所有 $r$ 个端子的总直线星形长度：\n$$\nF(x_{i}, y_{j}) = \\sum_{k=1}^{r} \\left( |x_{k} - x_{i}| + |y_{k} - y_{j}| \\right)\n$$\n由于绝对值的性质，该函数可以分解为两个独立的分量，每个维度一个：\n$$\nF(x_{i}, y_{j}) = \\left(\\sum_{k=1}^{r} |x_{k} - x_{i}|\\right) + \\left(\\sum_{k=1}^{r} |y_{k} - y_{j}|\\right)\n$$\n令 $F_x(u) = \\sum_{k=1}^{r} |x_{k} - u|$ 且 $F_y(v) = \\sum_{k=1}^{r} |y_{k} - v|$。总成本为 $F(u, v) = F_x(u) + F_y(v)$。为了最小化 $F(u, v)$，我们可以独立地最小化 $F_x(u)$ 和 $F_y(v)$。\n最小化 $\\sum_{k=1}^{r} |z_k - z|$ 的问题是一个经典的一维问题，其解是点集 $\\{z_k\\}_{k=1}^r$ 的中位数。因此，Steiner 点的最优位置是 $(x_{med}, y_{med})$，其中 $x_{med}$ 是多重集 $\\{x_k\\}$ 的中位数，$y_{med}$ 是多重集 $\\{y_k\\}$ 的中位数。由于一组数的中位数是该组数中的一个数（或者如果 $r$ 是偶数，可以选择为其中一个），最优 Steiner 点 $(x_{med}, y_{med})$ 保证在 Hanan 网格上。\n\n**任务 1：朴素评估的复杂度**\n朴素方法包括对 Hanan 网格上的每个候选点详尽地评估成本函数 $F(x_i, y_j)$ 并找到最小值。\n- Hanan 网格上的候选点数量为 $r_x r_y$。\n- 对于每个候选点 $(x_i, y_j)$，评估 $F(x_{i}, y_{j})$ 需要对 $r$ 个距离求和。如问题所述，这需要与 $r$ 成正比的时间，即 $O(r)$。\n- 总时间复杂度是候选点数量与每次评估时间的乘积。\n- 总时间复杂度 $= (\\text{Hanan 网格点数}) \\times (\\text{评估一个点的时间})$。\n- 在渐近表示法中，这是 $O(r_x \\cdot r_y \\cdot r)$。在最坏情况下，所有端子坐标都是不同的，因此 $r_x=r$ 且 $r_y=r$。因此，作为 $r$ 的函数的最坏情况复杂度是 $O(r^3)$。问题要求以 $r$、$r_x$ 和 $r_y$ 表示复杂度，即 $O(r \\cdot r_x \\cdot r_y)$。\n\n**任务 2：提出的动态数据结构**\n为了高效地处理动态更新（插入和删除），我们需要一个能够维护一个已排序的数字集合，并支持快速查找中位数和计算子集和的数据结构。\n$x$ 和 $y$ 分量的独立性允许我们使用两个独立的数据结构，一个用于 $x$ 坐标的多重集，记为 $T_x$，另一个用于 $y$ 坐标的多重集，记为 $T_y$。\n\n平衡二叉搜索树（如红黑树或 AVL 树）是一个理想的选择。为了支持所需的操作，我们在树的每个节点中增加额外的信息：\n1.  `key`：坐标值。\n2.  `count`：以此节点为根的子树中的节点数（包括该节点本身）。这是顺序统计树的标准增强。\n3.  `sum`：以此节点为根的子树中所有键的总和。\n\n这些增强可以在插入和删除过程中维护，在修改路径上的每个节点仅需额外的 $O(1)$ 工作量，而不会改变这些操作的整体对数复杂度。\n\n提出的数据结构是一对这样的增强平衡二叉搜索树，$(T_x, T_y)$。我们来分析所需操作的效率：\n- **插入/删除一个端子 $(x_k, y_k)$：** 这涉及在 $T_x$ 中进行一次插入/删除，在 $T_y$ 中进行一次插入/删除。在具有 $r$ 个元素的平衡二叉搜索树中，每个操作需要 $O(\\log r)$ 的时间。总更新时间为 $O(\\log r)$。这相对于 $r$ 是严格次二次方的。\n- **查询与重新计算：** 为了计算 $F_x(x_i) = \\sum_{k=1}^r |x_k - x_i|$，我们可以将其展开为：\n$$ F_x(x_i) = \\sum_{x_k \\le x_i} (x_i - x_k) + \\sum_{x_k > x_i} (x_k - x_i) $$\n$$ F_x(x_i) = (\\text{count}_{\\le x_i}) \\cdot x_i - \\text{sum}_{\\le x_i} + \\text{sum}_{> x_i} - (\\text{count}_{> x_i}) \\cdot x_i $$\n在增强树中，某个值左侧/右侧的节点数（count）和键值总和（sum）都可以在 $O(\\log r)$ 时间内通过遍历从根到该值的路径来计算。因此，在任何 Hanan 网格点查询 $F(x_i, y_j)$ 都需要 $O(\\log r)$ 时间。\n要重新计算成本最低的 1-Steiner 候选点，我们只需找到新的中位数并计算其成本。最佳的 1-Steiner 点 $(x_{\\text{med}}, y_{\\text{med}})$ 的坐标是端点坐标多重集的中位数。使用增强平衡二叉搜索树（作为顺序统计树），我们可以在 $O(\\log r)$ 时间内找到中位数。随后，使用上述公式，我们同样可以在 $O(\\log r)$ 时间内计算出在两个中位数坐标处的成本 $F_x(x_{\\text{med}})$ 和 $F_y(y_{\\text{med}})$。因此，单次更新后重新计算最优解的总时间为 $O(\\log r)$。\n\n**任务 3：单次更新和重新计算的复杂度**\n根据任务2的分析，使用所提出的数据结构（一对增强平衡二叉搜索树），执行单次更新（插入或删除一个端子）并重新计算成本最低的 1-Steiner 候选点（即找到新的中位数并计算其成本）所需的最坏情况时间由 $O(\\log r)$ 的操作主导。\n因此，渐近主导项为 $\\log r$。问题要求指明底数，计算机科学中通常使用底数2。\n所以，最坏情况时间的渐近主导项是 $\\log_2(r)$。",
            "answer": "$$\n\\boxed{\\log_{2}(r)}\n$$"
        }
    ]
}