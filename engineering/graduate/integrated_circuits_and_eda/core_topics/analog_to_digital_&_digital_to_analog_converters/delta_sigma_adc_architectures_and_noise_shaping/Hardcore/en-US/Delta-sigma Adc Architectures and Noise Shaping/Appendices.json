{
    "hands_on_practices": [
        {
            "introduction": "Our analysis of $\\Delta\\Sigma$ modulators often begins with a simplified linear model where quantization error is treated as additive white noise. This practice challenges that assumption by exploring scenarios where this model breaks down . By diagnosing conditions that cause unwanted spectral tones, you will develop a deeper understanding of the deterministic nature of quantization in a feedback loop and the importance of techniques like dither and dynamic element matching.",
            "id": "4264005",
            "problem": "A discrete-time single-loop delta-sigma analog-to-digital converter (ADC) with a $1$-bit quantizer and an otherwise linear time-invariant loop filter is operated without any intentional dither. Throughout, assume ideal clocks and no thermal or flicker noise so that the only nonlinearity is the quantizer. The standard additive quantization noise model assumes an error sequence $e[n]$ that is independent of the input and uniformly distributed within one quantization step, but this assumption can break in deterministic closed-loop operation. Consider two classes of deterministic inputs: (i) a constant input $x$ whose normalized value with respect to the feedback reference is a rational $x = p/q$ in lowest terms with $0  p  q$, and (ii) a single-tone sinusoid with small amplitude relative to the quantizer step. Also consider a multi-bit delta-sigma ADC in which the feedback digital-to-analog converter (DAC) is implemented by nominally identical unit elements that exhibit static element-to-element mismatch and no dynamic element matching is employed.\n\nWhich of the following statements correctly describe conditions under which the quantization error becomes correlated with the input in a delta-sigma loop and how this correlation leads to idle tones or spurious tones in the output spectrum? Select all that apply.\n\nA. For a $1$-bit modulator without dither, when the input is a constant $x = p/q$ as above, the loop can settle into a deterministic limit cycle of period $q$ samples so that the quantization error $e[n]$ is periodic with period $q$, producing discrete spectral lines at integer multiples of $f_s/q$ in the output spectrum.\n\nB. Injecting white dither with standard deviation on the order of one quantization step at the quantizer input randomizes the decision, making $e[n]$ approximately independent of the loop state and the input on average; idle tones are suppressed at the expense of increased in-band noise power.\n\nC. In a multi-bit modulator with a unit-element feedback DAC that has static element-to-element mismatch and no dynamic element matching, the feedback error is a deterministic, data-dependent nonlinearity. For static or periodic inputs, this error correlates with the bit-pattern and produces spurious tones even if the quantizer has many levels.\n\nD. Increasing the loop order alone eliminates idle tones because higher-order noise shaping pushes the quantization noise out of band, thereby restoring the independence assumption for $e[n]$ even for constant inputs without dither.\n\nE. Deliberately overdriving the loop so that the quantizer frequently saturates ensures a more uniform distribution of $e[n]$ and reduces correlation with the input, thus removing idle tones and spurs.",
            "solution": "The user has provided a problem statement regarding delta-sigma analog-to-digital converters (ADCs), focusing on the conditions that lead to the correlation of quantization error with the input signal, resulting in spectral tones. The task is to validate the problem statement and, if valid, identify all correct statements from the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System 1:** A discrete-time single-loop delta-sigma ADC.\n*   **Quantizer:** $1$-bit.\n*   **Loop Filter:** Otherwise linear time-invariant (LTI).\n*   **Dither:** No intentional dither is used.\n*   **Noise Sources:** Ideal clocks, no thermal or flicker noise. The only nonlinearity is the quantizer.\n*   **Model Context:** The standard additive quantization noise model assumes an error sequence $e[n]$ that is independent of the input and uniformly distributed, but this assumption can fail.\n*   **Input Class (i):** A constant (DC) input $x$ whose normalized value is a rational number $x = p/q$ in lowest terms, with $0  p  q$.\n*   **Input Class (ii):** A single-tone sinusoid with small amplitude relative to the quantizer step.\n*   **System 2:** A multi-bit delta-sigma ADC.\n*   **Feedback DAC:** Implemented by nominally identical unit elements that exhibit static element-to-element mismatch.\n*   **DAC Operation:** No dynamic element matching (DEM) is employed.\n*   **Question:** Identify the correct statements describing conditions for quantization error correlation with the input and the resulting idle/spurious tones.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem is deeply rooted in the established theory of delta-sigma data converters, a cornerstone of modern mixed-signal circuit design. The concepts presented—quantization noise correlation, limit cycles for rational DC inputs (idle tones), the role of dither, higher-order loops, and the impact of DAC nonlinearity in multi-bit architectures—are all standard, well-documented phenomena in this field. There is no pseudoscience or speculation.\n2.  **Well-Posed:** The problem provides a clear context and asks for an evaluation of several statements against this context and general principles of delta-sigma converters. The task is to select all applicable correct statements, which is a well-defined problem format.\n3.  **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology. Terms like \"limit cycle,\" \"spurious tones,\" \"dither,\" and \"dynamic element matching\" have rigorous definitions in signal processing and circuit theory.\n4.  **Incomplete or Contradictory Setup:** The problem statement is self-contained and internally consistent. It appropriately sets up different scenarios (e.g., an ideal $1$-bit modulator vs. a non-ideal multi-bit one) to probe different aspects of the core topic.\n5.  **Unrealistic or Infeasible:** The scenarios described are not only realistic but are the canonical examples used to study and teach the non-ideal behavior of delta-sigma modulators. DC inputs are a standard method to test for idle tones, and DAC element mismatch is a primary concern in the design of multi-bit converters.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, objective, and presents a non-trivial challenge within the specified domain of integrated circuits. The solution process will now proceed.\n\n### Solution Derivation and Option Analysis\n\nThe fundamental principle at issue is the failure of the linear additive white quantization noise model for a delta-sigma modulator under specific deterministic conditions. The quantization error, $e[n]$, is strictly a deterministic function of the quantizer's input, $u[n]$, i.e., $e[n] = Q(u[n]) - u[n]$. In a closed-loop system, $u[n]$ is a function of the system's past states and the external input, $x[n]$. This feedback can cause $e[n]$ to become periodic or otherwise correlated with $x[n]$, especially when $x[n]$ is itself deterministic (like a DC value or a simple sinusoid) and no randomizing signal (dither) is present. Periodic errors in the time domain manifest as discrete tones in the frequency domain.\n\n**A. For a $1$-bit modulator without dither, when the input is a constant $x = p/q$ as above, the loop can settle into a deterministic limit cycle of period $q$ samples so that the quantization error $e[n]$ is periodic with period $q$, producing discrete spectral lines at integer multiples of $f_s/q$ in the output spectrum.**\n\n*   **Analysis:** This statement describes the classic phenomenon of idle tones in a delta-sigma modulator. For a constant input $x=p/q$, the modulator's negative feedback loop attempts to make the long-term average of its output equal to the input. In a $1$-bit modulator with outputs, for instance, $\\{+V_{ref}, -V_{ref}\\}$, a stable state or \"limit cycle\" is often reached where the bitstream $y[n]$ becomes a repeating sequence. For the average to match $p/q$ (when normalized), a simple periodic sequence might contain $p$ occurrences of one output state and $q-p$ of the other over a period of $q$ samples. This periodicity in the output bitstream $y[n]$ forces all internal states of the LTI loop filter to also become periodic with period $q$. Consequently, the quantizer input $u[n]$ and the quantization error $e[n] = y[n] - u[n]$ will also be periodic with period $q$. A time-domain signal that is periodic with period $q$ samples has a frequency spectrum consisting of discrete lines (a Fourier series) at frequencies $k \\cdot (f_s/q)$ for integer $k$, where $f_s$ is the sampling frequency. These are the so-called \"idle tones.\"\n*   **Verdict:** **Correct**.\n\n**B. Injecting white dither with standard deviation on the order of one quantization step at the quantizer input randomizes the decision, making $e[n]$ approximately independent of the loop state and the input on average; idle tones are suppressed at the expense of increased in-band noise power.**\n\n*   **Analysis:** Dither is an intentionally added random signal, typically injected at the quantizer's input. Its purpose is precisely to break the deterministic relationship that leads to limit cycles. By adding noise, the input to the quantizer is randomized, so even for a constant signal input to the modulator, the quantizer's output is no longer a fixed, predictable sequence. This randomization decorrelates the quantization error $e[n]$ from the input signal and the loop's internal states. The result is that the spectral power of the quantization error is spread out into a continuous, noise-like spectrum, effectively eliminating the discrete idle tones. The trade-off is that the total noise power in the loop is increased by the power of the dither signal itself. This whitened and slightly more powerful noise is then shaped by the loop filter. The portion of this noise that falls into the signal band (the in-band noise floor) is typically higher than the theoretical minimum quantization noise power, but this is an acceptable price for the removal of problematic tones. A dither signal with a standard deviation on the order of the quantizer's least significant bit (LSB), or quantization step, is generally sufficient to achieve this effect.\n*   **Verdict:** **Correct**.\n\n**C. In a multi-bit modulator with a unit-element feedback DAC that has static element-to-element mismatch and no dynamic element matching, the feedback error is a deterministic, data-dependent nonlinearity. For static or periodic inputs, this error correlates with the bit-pattern and produces spurious tones even if the quantizer has many levels.**\n\n*   **Analysis:** In a multi-bit delta-sigma ADC, the feedback path requires a digital-to-analog converter (DAC). An ideal DAC is perfectly linear. However, a practical DAC, especially one built from unit elements (e.g., current sources or capacitors), will have manufacturing-induced mismatches between these elements. If there is no mechanism to average out this mismatch, the DAC transfer function becomes nonlinear. The error between the actual analog value produced by the DAC and the ideal linear value is a deterministic function of the digital code being fed back. Since the output digital code is highly correlated with the modulator's input signal, the DAC error will also be correlated with the input signal. This signal-dependent error is injected directly into the loop and is treated like the input signal by the loop filter; it is not noise-shaped in the same way as the quantization error. This results in harmonic distortion and spurious tones related to the input signal's frequency content. This problem exists regardless of the number of quantizer levels and is a dominant source of nonlinearity in many high-resolution multi-bit modulators. Dynamic element matching (DEM) is the technique specifically designed to combat this by randomizing or rotating the selection of unit elements over time, thereby decorrelating the error from the signal and shaping the error power out of the signal band.\n*   **Verdict:** **Correct**.\n\n**D. Increasing the loop order alone eliminates idle tones because higher-order noise shaping pushes the quantization noise out of band, thereby restoring the independence assumption for $e[n]$ even for constant inputs without dither.**\n\n*   **Analysis:** This statement is incorrect. While higher-order loop filters provide more aggressive noise shaping (i.e., the noise transfer function has higher-order zeros at DC), this does not by itself eliminate the fundamental cause of idle tones, which is the deterministic feedback loop. In fact, higher-order modulators can be *more* susceptible to complex and potentially chaotic limit cycles. They do not \"restore\" the statistical independence of the quantization error. The behavior can become very non-ideal and difficult to predict. Tones can still appear, although their structure might be more complex than in a first-order loop. Therefore, increasing the loop order is not a sufficient condition to eliminate idle tones; dither is still the primary tool for this purpose.\n*   **Verdict:** **Incorrect**.\n\n**E. Deliberately overdriving the loop so that the quantizer frequently saturates ensures a more uniform distribution of $e[n]$ and reduces correlation with the input, thus removing idle tones and spurs.**\n\n*   **Analysis:** This statement is dangerously incorrect. Overdriving a delta-sigma modulator, meaning providing an input signal large enough to cause the internal integrator states to exceed their stable operating range, leads to overload instability. When the integrators saturate, the loop dynamics are fundamentally altered, the noise-shaping property is lost, and the output becomes heavily distorted or can even latch to a DC value. This is a catastrophic failure mode that ruins the ADC's performance. It does not lead to a useful \"uniform distribution\" of error or a reduction in tones. Instead, it introduces massive, signal-destroying distortion. Modulators must be designed with input signal scaling that prevents overload under normal operating conditions.\n*   **Verdict:** **Incorrect**.",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "A key task in designing any ADC is to identify the dominant noise source that limits its performance. This exercise provides a hands-on opportunity to derive and compare the signal-to-noise-and-distortion ratio (SNDR) limitations imposed by two fundamental sources: the shaped quantization noise inherent to the $\\Delta\\Sigma$ architecture and the noise from sampling clock jitter . This first-principles analysis will solidify your understanding of how the oversampling ratio (OSR) and input signal frequency impact overall converter precision.",
            "id": "4264038",
            "problem": "Consider a low-pass, discrete-time, second-order delta-sigma analog-to-digital converter (ADC) with oversampling ratio (OSR) = 128 and sampling frequency $f_s = 50~\\text{MHz}$. The input is a single-tone sinusoid at frequency $f_{in} = 100~\\text{kHz}$ and peak amplitude $A = 0.5$ full-scale (FS). The sampling clock has root-mean-square (RMS) timing jitter $\\sigma_t = 1~\\text{ps}$. Assume a single-bit mid-tread quantizer with normalized output levels $\\pm 1$ so that the quantizer step size is $\\Delta = 2$. Assume the loop is ideal, distortion is negligible, quantization noise is white and uncorrelated with the signal, and the noise transfer function (NTF) of the second-order modulator is the $L=2$ low-pass form. Use physically justified small-angle approximations appropriate for the in-band region and derive the jitter-limited signal-to-noise-and-distortion ratio (SNDR) and the quantization-noise-limited SNDR from first principles.\n\nStarting from the definitions of quantization noise power for a uniform quantizer and the spectral shaping imposed by the NTF, derive an analytical expression for the in-band quantization noise power of a second-order delta-sigma modulator in terms of $\\Delta$ and $\\mathrm{OSR}$, then compute the corresponding quantization-noise-limited SNDR for the given $A$ and $\\mathrm{OSR}$. Separately, starting from the sampling time error model for a sinusoidal input, derive the jitter-induced error and compute the jitter-limited SNDR for the given $f_{in}$ and $\\sigma_{t}$.\n\nFinally, report the limiting SNDR, defined as the smaller of the jitter-limited SNDR and the quantization-noise-limited SNDR, as a single numerical value. Round your final answer to four significant figures. Express the final answer in decibels (dB).",
            "solution": "The problem requires the determination of the limiting Signal-to-Noise-and-Distortion Ratio (SNDR) for a second-order delta-sigma Analog-to-Digital Converter (ADC). This is achieved by calculating two primary performance limiters: the in-band quantization noise and the noise introduced by sampling clock jitter. The smaller of the two resulting SNDR values will define the overall performance limit. The entire analysis will be conducted from first principles as requested.\n\nThe given parameters are:\n-   ADC order: $L=2$\n-   Oversampling Ratio: $\\mathrm{OSR} = 128$\n-   Sampling frequency: $f_s = 50 \\times 10^6$ Hz\n-   Input signal frequency: $f_{in} = 100 \\times 10^3$ Hz\n-   Input signal peak amplitude: $A = 0.5$ (normalized to full-scale)\n-   RMS clock jitter: $\\sigma_t = 1 \\times 10^{-12}$ s\n-   Quantizer step size: $\\Delta = 2$\n\nFirst, we calculate the signal power, $P_S$. The input is a single-tone sinusoid, $x(t) = A\\sin(2\\pi f_{in} t)$, with a peak amplitude of $A = 0.5$. The root-mean-square (RMS) value of this signal is $A_{rms} = A/\\sqrt{2}$. The signal power is the square of the RMS value:\n$$P_S = A_{rms}^2 = \\left(\\frac{A}{\\sqrt{2}}\\right)^2 = \\frac{A^2}{2}$$\nSubstituting $A=0.5$:\n$$P_S = \\frac{(0.5)^2}{2} = \\frac{0.25}{2} = 0.125$$\n\n**1. Quantization-Noise-Limited SNDR ($\\mathrm{SNDR}_Q$)**\n\nWe model the quantization error, $e(n)$, as a stationary white noise process, uniformly distributed between $-\\Delta/2$ and $+\\Delta/2$. The probability density function is $p(e) = 1/\\Delta$ for $e \\in [-\\Delta/2, \\Delta/2]$. The total power of this unshaped quantization noise is its variance, $\\sigma_e^2$:\n$$\\sigma_e^2 = \\int_{-\\Delta/2}^{\\Delta/2} e^2 p(e) de = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} e^2 de = \\frac{1}{\\Delta} \\left[ \\frac{e^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{\\Delta^2}{12}$$\nFor the given single-bit quantizer with levels $\\pm 1$, the step size is $\\Delta = 1 - (-1) = 2$. The total noise power is:\n$$\\sigma_e^2 = \\frac{2^2}{12} = \\frac{4}{12} = \\frac{1}{3}$$\nThis noise power is uniformly distributed in frequency over the Nyquist band, $[-f_s/2, f_s/2]$. The two-sided power spectral density (PSD) of the unshaped quantization noise is constant:\n$$S_e(f) = \\frac{\\sigma_e^2}{f_s} = \\frac{\\Delta^2}{12f_s}$$\nIn a delta-sigma modulator, this noise is shaped by the Noise Transfer Function (NTF). For a second-order ($L=2$) modulator, the NTF is $H_{NTF}(z) = (1-z^{-1})^2$. The frequency response is $H_{NTF}(e^{j\\omega}) = (1-e^{-j\\omega})^2$, where $\\omega = 2\\pi f/f_s$ is the normalized angular frequency. The squared magnitude of the NTF is:\n$$|H_{NTF}(e^{j\\omega})|^2 = |(1-e^{-j\\omega})^2|^2 = |1-e^{-j\\omega}|^4 = \\left( (1-\\cos\\omega)^2 + \\sin^2\\omega \\right)^2 = (2 - 2\\cos\\omega)^2 = \\left( 4\\sin^2\\left(\\frac{\\omega}{2}\\right) \\right)^2$$\nThe signal band of interest is from $0$ to the bandwidth $f_b = f_s / (2 \\cdot \\mathrm{OSR})$. For high $\\mathrm{OSR}$, $f_b \\ll f_s/2$, which corresponds to small $\\omega$. We can use the small-angle approximation $\\sin(x) \\approx x$.\n$$|H_{NTF}(e^{j\\omega})|^2 \\approx \\left( 4\\left(\\frac{\\omega}{2}\\right)^2 \\right)^2 = (\\omega^2)^2 = \\omega^4 = \\left(\\frac{2\\pi f}{f_s}\\right)^4$$\nThe PSD of the shaped quantization noise at the output is $S_Q(f) = S_e(f) |H_{NTF}(e^{j2\\pi f/f_s})|^2$. The in-band quantization noise power, $P_Q$, is the integral of this PSD over the signal bandwidth $[-f_b, f_b]$:\n$$P_Q = \\int_{-f_b}^{f_b} S_Q(f) df = \\int_{-f_s/(2\\cdot\\mathrm{OSR})}^{f_s/(2\\cdot\\mathrm{OSR})} \\frac{\\Delta^2}{12 f_s} |H_{NTF}(e^{j2\\pi f/f_s})|^2 df$$\nUsing the approximation for the NTF and noting the integrand is an even function:\n$$P_Q \\approx 2 \\int_{0}^{f_s/(2\\cdot\\mathrm{OSR})} \\frac{\\Delta^2}{12 f_s} \\left(\\frac{2\\pi f}{f_s}\\right)^4 df$$\n$$P_Q = \\frac{2\\Delta^2}{12 f_s} \\left(\\frac{2\\pi}{f_s}\\right)^4 \\int_{0}^{f_s/(2\\cdot\\mathrm{OSR})} f^4 df = \\frac{\\Delta^2}{6 f_s} \\frac{16\\pi^4}{f_s^4} \\left[ \\frac{f^5}{5} \\right]_{0}^{f_s/(2\\cdot\\mathrm{OSR})}$$\n$$P_Q = \\frac{8\\pi^4\\Delta^2}{15 f_s^5} \\left( \\frac{f_s}{2\\cdot\\mathrm{OSR}} \\right)^5 = \\frac{8\\pi^4\\Delta^2}{15 f_s^5} \\frac{f_s^5}{32 \\cdot \\mathrm{OSR}^5} = \\frac{\\pi^4 \\Delta^2}{60 \\cdot \\mathrm{OSR}^5}$$\nNow, we can compute the quantization-noise-limited SNDR, $\\mathrm{SNDR}_Q$:\n$$\\mathrm{SNDR}_Q = \\frac{P_S}{P_Q} = \\frac{A^2/2}{\\frac{\\pi^4 \\Delta^2}{60 \\cdot \\mathrm{OSR}^5}} = \\frac{30 A^2 (\\mathrm{OSR})^5}{\\pi^4 \\Delta^2}$$\nSubstituting the given values: $A = 0.5$, $\\Delta = 2$, and $\\mathrm{OSR}=128$:\n$$\\mathrm{SNDR}_Q = \\frac{30 \\cdot (0.5)^2 \\cdot (128)^5}{\\pi^4 \\cdot (2)^2} = \\frac{30 \\cdot 0.25 \\cdot (128)^5}{4\\pi^4} = \\frac{1.875 \\cdot (128)^5}{\\pi^4} \\approx 6.6206 \\times 10^8$$\nIn decibels (dB), this is:\n$$\\mathrm{SNDR}_Q \\text{ [dB]} = 10\\log_{10}(\\mathrm{SNDR}_Q) = 10\\log_{10}(6.6206 \\times 10^8) \\approx 88.2045 \\text{ dB}$$\n\n**2. Jitter-Limited SNDR ($\\mathrm{SNDR}_J$)**\n\nJitter introduces a sampling time error. For an input signal $x(t) = A\\sin(2\\pi f_{in} t)$, the error in the sampled value due to a timing error $\\delta_t$ can be approximated using a first-order Taylor expansion for small $\\delta_t$:\n$$e_j(t) = x(t+\\delta_t) - x(t) \\approx \\delta_t \\cdot \\frac{dx}{dt}$$\nThe derivative of the input signal is $\\frac{dx}{dt} = 2\\pi f_{in} A \\cos(2\\pi f_{in} t)$. The instantaneous error is:\n$$e_j(t) \\approx \\delta_t \\cdot 2\\pi f_{in} A \\cos(2\\pi f_{in} t)$$\nThe jitter noise power, $P_J$, is the mean-square value of this error. We assume the jitter $\\delta_t$ is a random process with zero mean and variance $\\sigma_t^2$, and that it is uncorrelated with the signal.\n$$P_J = E[e_j(t)^2] \\approx E[(\\delta_t \\cdot 2\\pi f_{in} A \\cos(2\\pi f_{in} t))^2]$$\n$$P_J = E[\\delta_t^2] \\cdot (2\\pi f_{in} A)^2 \\cdot E[\\cos^2(2\\pi f_{in} t)]$$\nThe term $E[\\delta_t^2]$ is the jitter variance, $\\sigma_t^2$. The time-average (or expectation over a random phase) of $\\cos^2(\\theta)$ is $1/2$. Thus:\n$$P_J = \\sigma_t^2 \\cdot (2\\pi f_{in} A)^2 \\cdot \\frac{1}{2} = 2\\pi^2 f_{in}^2 A^2 \\sigma_t^2$$\nThe jitter-limited SNDR, $\\mathrm{SNDR}_J$, is the ratio of signal power to jitter noise power. Noticeably, the amplitude term $A$ cancels out.\n$$\\mathrm{SNDR}_J = \\frac{P_S}{P_J} = \\frac{A^2/2}{2\\pi^2 f_{in}^2 A^2 \\sigma_t^2} = \\frac{1}{4\\pi^2 f_{in}^2 \\sigma_t^2}$$\nSubstituting the given values: $f_{in} = 10^5~\\text{Hz}$ and $\\sigma_t = 10^{-12}~\\text{s}$:\n$$\\mathrm{SNDR}_J = \\frac{1}{4\\pi^2 (10^5)^2 (10^{-12})^2} = \\frac{1}{4\\pi^2 (10^{10}) (10^{-24})} = \\frac{10^{14}}{4\\pi^2} \\approx 2.5330 \\times 10^{12}$$\nIn decibels, this is:\n$$\\mathrm{SNDR}_J \\text{ [dB]} = 10\\log_{10}(\\mathrm{SNDR}_J) = 10\\log_{10}\\left(\\frac{10^{14}}{4\\pi^2}\\right) = 140 - 10\\log_{10}(4\\pi^2) \\approx 124.0364 \\text{ dB}$$\n\n**3. Limiting SNDR**\n\nThe overall performance of the ADC is limited by the dominant noise source. We compare the two calculated SNDR values:\n$$\\mathrm{SNDR}_Q \\approx 88.20 \\text{ dB}$$\n$$\\mathrm{SNDR}_J \\approx 124.04 \\text{ dB}$$\nA lower SNDR value corresponds to a higher noise power relative to the signal. Therefore, the quantization noise is the dominant noise source in this system. The problem asks for the limiting SNDR, which is the smaller of the two values.\n$$\\text{Limiting SNDR} = \\min(\\mathrm{SNDR}_Q, \\mathrm{SNDR}_J) \\approx 88.2045 \\text{ dB}$$\nRounding the result to four significant figures gives $88.20$ dB.",
            "answer": "$$\\boxed{88.20}$$"
        },
        {
            "introduction": "The theoretical design of a Noise Transfer Function (NTF) involves placing poles and zeros to achieve desired noise shaping, but a purely theoretical design can lead to an unstable modulator, especially with a single-bit quantizer. This computational exercise bridges that gap by tasking you with evaluating modulator stability using Lee's criterion, a widely respected empirical guideline, based on the NTF's peak gain . This practice demonstrates how abstract transfer functions translate into concrete design constraints.",
            "id": "4263969",
            "problem": "Consider a single-loop Delta-Sigma (ΔΣ) analog-to-digital converter (ADC) with a prescribed Noise Transfer Function (NTF) given by $NTF(z) = \\dfrac{(1 - z^{-1})^{p}}{(1 - a z^{-1})}$, where $p$ is a positive integer and $a$ is a real scalar with $0  a  1$. The quantity of interest is the infinity norm of the NTF on the unit circle, defined as $|NTF|_{\\infty} = \\sup_{\\omega \\in [0, 2\\pi)} \\left|NTF\\left(e^{j\\omega}\\right)\\right|$. Your task is to compute $|NTF|_{\\infty}$ numerically for the given parameter sets and then assess the likely stability of the corresponding ΔΣ modulator using a $1$-bit quantizer at a $-6$ dBFS sinusoidal input.\n\nFundamental base and definitions:\n- The Z-transform evaluation on the unit circle uses $z = e^{j\\omega}$, where $\\omega$ is the digital angular frequency in radians, and the magnitude response is $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$.\n- The infinity norm $|NTF|_{\\infty}$ is the supremum of the magnitude response over the unit circle, i.e., the largest value of $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$ for $\\omega \\in [0, 2\\pi)$.\n- A widely used empirical design rule (Lee criterion) for single-bit ΔΣ modulators states that the peak NTF gain should satisfy $|NTF|_{\\infty}  1.5$ for robust stability across input amplitudes. While this is a heuristic and not a proof of stability, it is a well-tested guideline in integrated circuit practice.\n\nNumerical computation requirements:\n- Angles must be in radians.\n- Compute $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$ on a uniform grid of $N$ points with $N = 131072$ samples of $\\omega$ over $[0, 2\\pi)$, and use the maximum sampled value to approximate $|NTF|_{\\infty}$.\n- Use the following fixed sinusoidal input amplitude corresponding to $-6$ dBFS: $A_{\\mathrm{in}} = 10^{-6/20}$ (dimensionless). This value must be computed but is only used to contextualize the stability assessment (the Lee criterion threshold itself does not explicitly depend on $A_{\\mathrm{in}}$).\n\nStability assessment rule:\n- Declare the modulator “likely stable” if $|NTF|_{\\infty}  1.5$ and “likely unstable” otherwise. Report this as a boolean where $True$ means likely stable and $False$ means likely unstable.\n\nTest suite:\nEvaluate the following five parameter sets $(p, a)$:\n- Case $1$: $(p, a) = (2, 0.5)$.\n- Case $2$: $(p, a) = (2, 0.9)$.\n- Case $3$: $(p, a) = (2, 0.1)$.\n- Case $4$: $(p, a) = (1, 0.5)$.\n- Case $5$: $(p, a) = (2, 0.99)$.\n\nOutput specification:\n- For each case, produce two results: the float value of $|NTF|_{\\infty}$ rounded to $6$ decimal places, followed by the boolean stability assessment according to the Lee criterion.\n- Your program should produce a single line of output containing the results aggregated in order as a comma-separated list enclosed in square brackets, i.e., $[|NTF|_{\\infty}^{(1)}, \\text{stable}^{(1)}, |NTF|_{\\infty}^{(2)}, \\text{stable}^{(2)}, \\dots, |NTF|_{\\infty}^{(5)}, \\text{stable}^{(5)}]$, where $|NTF|_{\\infty}^{(k)}$ is a float rounded to $6$ decimals and $\\text{stable}^{(k)}$ is a boolean.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of digital signal processing and control theory as applied to Delta-Sigma ($\\Delta\\Sigma$) converters, is well-posed, objective, and contains all necessary information for a unique solution.\n\nThe primary objective is to compute the infinity norm, $|NTF|_{\\infty}$, of the given Noise Transfer Function (NTF) and assess the modulator's stability based on the result. The NTF is defined as:\n$$NTF(z) = \\dfrac{(1 - z^{-1})^{p}}{(1 - a z^{-1})}$$\nwhere $p$ is a positive integer representing the order of the noise shaping, and $a$ is a real scalar pole location, constrained by $0  a  1$.\n\nThe infinity norm, $|NTF|_{\\infty}$, is the peak magnitude of the NTF on the unit circle in the z-plane. It is formally defined as:\n$$|NTF|_{\\infty} = \\sup_{\\omega \\in [0, 2\\pi)} \\left|NTF\\left(e^{j\\omega}\\right)\\right|$$\nwhere $z = e^{j\\omega}$ and $\\omega$ is the normalized digital angular frequency.\n\nThe problem requires a numerical approximation of this supremum. The procedure is as follows:\n1.  Discretize the frequency range $\\omega \\in [0, 2\\pi)$ into a uniform grid of $N = 131072$ points.\n2.  Evaluate the magnitude of the NTF, $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$, at each point on this grid.\n3.  The maximum value obtained from this evaluation serves as the numerical approximation of $|NTF|_{\\infty}$.\n\nThe magnitude of the NTF at a given frequency $\\omega$ is derived by substituting $z = e^{j\\omega}$:\n$$\\left|NTF\\left(e^{j\\omega}\\right)\\right| = \\left|\\dfrac{\\left(1 - e^{-j\\omega}\\right)^{p}}{1 - a e^{-j\\omega}}\\right| = \\dfrac{\\left|\\left(1 - e^{-j\\omega}\\right)^{p}\\right|}{\\left|1 - a e^{-j\\omega}\\right|} = \\dfrac{\\left|1 - e^{-j\\omega}\\right|^{p}}{\\left|1 - a e^{-j\\omega}\\right|}$$\nThis calculation is best performed using complex number arithmetic, as it is both computationally efficient and numerically robust. The denominator $\\left|1 - a e^{-j\\omega}\\right|$ is never zero for $\\omega \\in [0, 2\\pi)$ because the condition $0  a  1$ ensures the pole at $z=a$ is strictly inside the unit circle.\n\nThe numerical algorithm proceeds as follows:\n- A vector of $N=131072$ equally spaced angular frequencies $\\omega_k$ is generated over the interval $[0, 2\\pi)$.\n- A corresponding vector of complex values $z_k^{-1} = e^{-j\\omega_k}$ is constructed.\n- For a given parameter set $(p, a)$, the magnitude response vector is computed element-wise:\n  - The numerator term is calculated as $\\left(\\left|1 - z_k^{-1}\\right|\\right)^p$.\n  - The denominator term is calculated as $\\left|1 - a z_k^{-1}\\right|$.\n  - The NTF magnitude is the ratio of these two terms.\n- The maximum value in the resulting magnitude vector is taken as $|NTF|_{\\infty}$.\n\nFinally, the stability of the $\\Delta\\Sigma$ modulator is assessed using the empirical Lee criterion. This heuristic states that for robust stability with a $1$-bit quantizer, the peak NTF gain should be less than a certain threshold. The problem specifies this threshold as $1.5$.\n- If $|NTF|_{\\infty}  1.5$, the modulator is deemed \"likely stable\", reported as the boolean `True`.\n- If $|NTF|_{\\infty} \\ge 1.5$, the modulator is deemed \"likely unstable\", reported as the boolean `False`.\n\nThis entire process is repeated for each of the five specified $(p, a)$ parameter sets. The final output consists of the calculated $|NTF|_{\\infty}$ (rounded to $6$ decimal places) and the corresponding stability assessment for each case. The sinusoidal input amplitude of $A_{\\mathrm{in}} = 10^{-6/20}$ is provided for context regarding typical operating conditions but does not enter into the calculation of $|NTF|_{\\infty}$ or the stability assessment, which are based solely on the NTF's properties.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the infinity norm of a given NTF for several parameter sets\n    and assesses modulator stability using the Lee criterion.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (p, a)\n        (2, 0.5),\n        (2, 0.9),\n        (2, 0.1),\n        (1, 0.5),\n        (2, 0.99),\n    ]\n\n    # Numerical computation parameters\n    N = 131072\n    \n    # Stability criterion threshold\n    LEE_CRITERION_THRESHOLD = 1.5\n\n    # The problem specifies a -6 dBFS sinusoidal input amplitude for context.\n    # A_in = 10**(-6 / 20)\n    # This value is not used in the NTF norm calculation.\n\n    # Pre-compute the vector of complex exponentials on the unit circle.\n    # This is more efficient than re-computing for each test case.\n    # The range is [0, 2*pi) as specified.\n    omega = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    z_inv = np.exp(-1j * omega)\n\n    results = []\n    \n    for p, a in test_cases:\n        # Calculate the magnitude of the NTF numerator |(1 - z^-1)^p|\n        # This is more numerically stable as |1 - z^-1|^p\n        mag_num_base = np.abs(1.0 - z_inv)\n        numerator_mag = mag_num_base ** p\n        \n        # Calculate the magnitude of the NTF denominator |1 - a*z^-1|\n        denominator_mag = np.abs(1.0 - a * z_inv)\n        \n        # Compute the NTF magnitude response.\n        # The denominator is guaranteed to be non-zero since |a|  1.\n        ntf_mag_response = numerator_mag / denominator_mag\n        \n        # Approximate the infinity norm by finding the maximum on the grid.\n        ntf_inf = np.max(ntf_mag_response)\n        \n        # Assess stability using the Lee criterion.\n        is_stable = ntf_inf  LEE_CRITERION_THRESHOLD\n        \n        # Append the rounded float and boolean to the results list.\n        results.append(round(ntf_inf, 6))\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    # Convert booleans to their string representations ('True', 'False').\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}