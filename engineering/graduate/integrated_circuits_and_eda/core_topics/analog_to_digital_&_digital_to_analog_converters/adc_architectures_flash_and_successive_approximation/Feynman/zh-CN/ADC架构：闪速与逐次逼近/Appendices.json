{
    "hands_on_practices": [
        {
            "introduction": "任何模数转换过程的第一步都是精确地捕获模拟信号，这通常由采样保持电路完成。本实践练习  将引导您进行一项基础分析，将采样电路的物理特性（如其电阻 $R_{\\mathrm{on}}$ 和电容 $C_s$）与达到特定精度（由分辨率 $N$ 定义）所需的采集时间联系起来。通过这个练习，您将对ADC前端的速度与精度之间的权衡有一个具体的理解。",
            "id": "4254989",
            "problem": "一个单端逐次逼近寄存器 (SAR) 模数转换器 (ADC) 使用一个顶板采样网络，该网络包含一个导通电阻为 $R_{\\mathrm{on}}$ 的自举采样开关和一个采样电容 $C_{s}$。在采集期间，输入源的输出电阻可忽略不计，并且除 $C_{s}$ 外的所有寄生参数也都被忽略。在时间 $t=0$ 时，当采样开关闭合时，输入经历一个从 $0$ 到 $V_{\\mathrm{FS}}$ 的满量程阶跃。由于 $R_{\\mathrm{on}}C_{s}$ 的时间常数，采样节点遵循一阶动态特性。将一个在 $[0, V_{\\mathrm{FS}}]$ 范围内的 $N$ 位转换器的最低有效位 (LSB) 定义为 $\\mathrm{LSB} = V_{\\mathrm{FS}}/2^{N}$。\n\n请从一阶线性时不变系统在阶跃输入驱动下的第一性原理出发，并利用上述 LSB 的定义，推导出最小采集时间 $t_{\\mathrm{acq}}$，使得在指定的满量程阶跃下，采集结束时的采样误差的绝对值严格小于 $0.5\\,\\mathrm{LSB}$。然后，使用以下参数对您的表达式进行数值计算：$C_{s} = 3.2\\,\\mathrm{pF}$，$R_{\\mathrm{on}} = 75\\,\\Omega$，$V_{\\mathrm{FS}} = 1.8\\,\\mathrm{V}$，以及 $N=14$。\n\n请用 $\\mathrm{ns}$ (纳秒) 表示 $t_{\\mathrm{acq}}$ 的最终数值答案，并将您的答案四舍五入至四位有效数字。",
            "solution": "用户提供了一个问题陈述，在尝试解决之前需要进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：单端逐次逼近寄存器 (SAR) 模数转换器 (ADC)。\n- **采样网络**：采用自举采样开关的顶板采样网络。\n- **组件和参数**：\n    - 开关导通电阻：$R_{\\mathrm{on}}$\n    - 采样电容：$C_{s}$\n    - 输入源输出电阻：可忽略不计。\n    - 寄生参数：除 $C_s$ 外均忽略。\n- **输入条件**：在时间 $t=0$ 时，输入经历一个从 $0$ 到 $V_{\\mathrm{FS}}$ 的满量程阶跃。采样开关闭合。\n- **系统动态特性**：采样节点遵循时间常数为 $R_{\\mathrm{on}}C_{s}$ 的一阶动态特性。\n- **定义**：\n    - N位转换器的最低有效位 (LSB)：$\\mathrm{LSB} = V_{\\mathrm{FS}}/2^{N}$。\n    - 范围：$[0, V_{\\mathrm{FS}}]$。\n- **目标**：\n    1. 推导最小采集时间 $t_{\\mathrm{acq}}$，使得在指定的满量程阶跃下，采集结束时（$t=t_{\\mathrm{acq}}$）的采样误差绝对值严格小于 $0.5\\,\\mathrm{LSB}$。\n    2. 对 $t_{\\mathrm{acq}}$ 的表达式进行数值计算。\n- **数值**：\n    - $C_{s} = 3.2\\,\\mathrm{pF}$\n    - $R_{\\mathrm{on}} = 75\\,\\Omega$\n    - $V_{\\mathrm{FS}} = 1.8\\,\\mathrm{V}$\n    - $N=14$\n- **输出格式**：以ns为单位表示 $t_{\\mathrm{acq}}$ 的最终数值答案，并四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题具有科学合理性。它将采样保持电路的采集阶段建模为一阶RC电路，这是模拟集成电路设计中一个标准且基本的模型。建立时间条件（误差小于LSB的一小部分）是ADC的核心设计约束。\n2.  **适定性**：该问题是适定的。它提供了明确的目标、所有必要的参数，以及一个具有特定输入和初始条件的明确定义的物理系统（一阶LTI电路）。要求满足不等式的最短时间会导出一个唯一、稳定且有意义的解。\n3.  **客观性**：问题以客观、正式的语言陈述，没有主观性或歧义。\n4.  **不完整或矛盾的设置**：问题是自洽的。忽略源电阻和其他寄生参数的假设是一个明确的简化，而非遗漏，这使得问题可以求解。其中没有矛盾之处。\n5.  **不切实际或不可行**：所提供的数值（$C_{s}=3.2\\,\\mathrm{pF}$、$R_{\\mathrm{on}}=75\\,\\Omega$、$V_{\\mathrm{FS}}=1.8\\,\\mathrm{V}$、$N=14$）对于现代CMOS集成电路是符合实际的。\n6.  **不适定或结构不良**：问题结构良好，并能导出一个唯一的解。\n7.  **伪深刻、琐碎或同义反复**：该问题需要从第一性原理出发进行标准的、但具有实质内容的推导，将RC电路理论与ADC的性能指标联系起来。它并非微不足道。\n8.  **超出科学可验证性**：推导和计算在数学上是可验证的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n### 推导与求解\n\n问题要求从第一性原理进行推导。在采集阶段，当开关闭合时，采样网络被建模为一个简单的串联RC电路。输入电压施加在开关电阻 $R_{\\mathrm{on}}$ 和采样电容 $C_s$ 的串联组合上。电容器两端的电压 $V_s(t)$ 就是被采样的信号。\n\n该电路由以下一阶线性常微分方程描述：\n$$R_{\\mathrm{on}}C_s \\frac{dV_s(t)}{dt} + V_s(t) = V_{\\mathrm{in}}(t)$$\n设系统的时间常数为 $\\tau = R_{\\mathrm{on}}C_s$。方程变为：\n$$\\tau \\frac{dV_s(t)}{dt} + V_s(t) = V_{\\mathrm{in}}(t)$$\n问题指定在 $t=0$ 时有一个满量程阶跃输入，输入电压 $V_{\\mathrm{in}}(t)$ 从 $0$ 变为 $V_{\\mathrm{FS}}$。对于 $t \\ge 0$，输入为 $V_{\\mathrm{in}}(t) = V_{\\mathrm{FS}}$。初始条件，即阶跃前的电压水平，为 $V_s(0) = 0$。\n\n一阶系统响应阶跃输入的电容电压通解为：\n$$V_s(t) = V_{\\mathrm{final}} + (V_{\\mathrm{initial}} - V_{\\mathrm{final}})\\exp(-t/\\tau)$$\n在这种情况下，初始电压为 $V_{\\mathrm{initial}} = V_s(0) = 0$，最终稳态电压为 $V_{\\mathrm{final}} = V_{\\mathrm{FS}}$。将这些值代入通解，得到采样节点的响应：\n$$V_s(t) = V_{\\mathrm{FS}} + (0 - V_{\\mathrm{FS}})\\exp(-t/\\tau)$$\n$$V_s(t) = V_{\\mathrm{FS}} (1 - \\exp(-t/\\tau))$$\n该方程描述了采样电容上的电压随时间变化的函数。\n\n在采集过程中的任意时间 $t$，采样误差 $V_{\\mathrm{err}}(t)$ 是最终目标电压 $V_{\\mathrm{FS}}$ 与实际采样电压 $V_s(t)$ 之间的差值：\n$$V_{\\mathrm{err}}(t) = V_{\\mathrm{FS}} - V_s(t)$$\n代入 $V_s(t)$ 的表达式：\n$$V_{\\mathrm{err}}(t) = V_{\\mathrm{FS}} - V_{\\mathrm{FS}}(1 - \\exp(-t/\\tau)) = V_{\\mathrm{FS}} - V_{\\mathrm{FS}} + V_{\\mathrm{FS}}\\exp(-t/\\tau)$$\n$$V_{\\mathrm{err}}(t) = V_{\\mathrm{FS}}\\exp(-t/\\tau)$$\n由于 $V_{\\mathrm{FS}} > 0$，对于有限的 $t$，误差 $V_{\\mathrm{err}}(t)$ 总是正的，因此其绝对值为 $|V_{\\mathrm{err}}(t)| = V_{\\mathrm{err}}(t)$。\n\n问题要求在采集周期结束时，$t = t_{\\mathrm{acq}}$，采样误差的绝对值必须严格小于半个LSB。该条件为：\n$$|V_{\\mathrm{err}}(t_{\\mathrm{acq}})|  0.5\\,\\mathrm{LSB}$$\n使用定义 $\\mathrm{LSB} = V_{\\mathrm{FS}}/2^N$，条件变为：\n$$V_{\\mathrm{FS}}\\exp(-t_{\\mathrm{acq}}/\\tau)  0.5 \\left(\\frac{V_{\\mathrm{FS}}}{2^N}\\right)$$\n假设 $V_{\\mathrm{FS}} \\neq 0$，我们可以将两边同除以 $V_{\\mathrm{FS}}$：\n$$\\exp(-t_{\\mathrm{acq}}/\\tau)  \\frac{0.5}{2^N} = \\frac{1}{2 \\cdot 2^N} = \\frac{1}{2^{N+1}}$$\n为了求解 $t_{\\mathrm{acq}}$，我们对两边取自然对数。由于自然对数是严格递增函数，不等号方向保持不变：\n$$\\ln(\\exp(-t_{\\mathrm{acq}}/\\tau))  \\ln\\left(\\frac{1}{2^{N+1}}\\right)$$\n$$- \\frac{t_{\\mathrm{acq}}}{\\tau}  -\\ln(2^{N+1})$$\n$$- \\frac{t_{\\mathrm{acq}}}{\\tau}  -(N+1)\\ln(2)$$\n两边同乘以-1，不等号反向：\n$$\\frac{t_{\\mathrm{acq}}}{\\tau}  (N+1)\\ln(2)$$\n$$t_{\\mathrm{acq}}  \\tau(N+1)\\ln(2)$$\n代入 $\\tau = R_{\\mathrm{on}}C_s$，我们得到所需采集时间的解析表达式：\n$$t_{\\mathrm{acq}}  R_{\\mathrm{on}}C_s(N+1)\\ln(2)$$\n最小采集时间 $t_{\\mathrm{acq}}$ 是这个集合的下确界，即边界值。\n$$t_{\\mathrm{acq, min}} = R_{\\mathrm{on}}C_s(N+1)\\ln(2)$$\n\n现在，我们使用给定的参数对该表达式进行数值计算：\n$N = 14$\n$R_{\\mathrm{on}} = 75\\,\\Omega$\n$C_s = 3.2\\,\\mathrm{pF} = 3.2 \\times 10^{-12}\\,\\mathrm{F}$\n\n首先，计算时间常数 $\\tau$：\n$$\\tau = R_{\\mathrm{on}}C_s = (75\\,\\Omega) \\times (3.2 \\times 10^{-12}\\,\\mathrm{F}) = 240 \\times 10^{-12}\\,\\mathrm{s} = 0.24 \\times 10^{-9}\\,\\mathrm{s}$$\n现在，计算最小采集时间 $t_{\\mathrm{acq}}$：\n$$t_{\\mathrm{acq}} = (14+1) \\ln(2) \\times (0.24 \\times 10^{-9}\\,\\mathrm{s})$$\n$$t_{\\mathrm{acq}} = 15 \\ln(2) \\times (0.24 \\times 10^{-9}\\,\\mathrm{s})$$\n使用 $\\ln(2) \\approx 0.69314718$ 的值：\n$$t_{\\mathrm{acq}} \\approx 15 \\times 0.69314718 \\times 0.24 \\times 10^{-9}\\,\\mathrm{s}$$\n$$t_{\\mathrm{acq}} \\approx 10.3972077 \\times 0.24 \\times 10^{-9}\\,\\mathrm{s}$$\n$$t_{\\mathrm{acq}} \\approx 2.4953298 \\times 10^{-9}\\,\\mathrm{s}$$\n结果以纳秒为单位是：\n$$t_{\\mathrm{acq}} \\approx 2.4953298\\,\\mathrm{ns}$$\n问题要求答案四舍五入到四位有效数字。\n$$t_{\\mathrm{acq}} \\approx 2.495\\,\\mathrm{ns}$$",
            "answer": "$$\\boxed{2.495}$$"
        },
        {
            "introduction": "信号转换完成后，我们如何量化转换本身的精度？本练习  深入探讨了ADC的关键静态性能指标：微分非线性（DNL）和积分非线性（INL）。通过编写一个程序来从一组模拟的转换电压中计算这些值，您将学会如何表征ADC的传递函数，并识别由非理想元器件行为引起的失码等问题。",
            "id": "4254992",
            "problem": "您的任务是根据一个单极性、均匀的模数转换器 (ADC) 测得的码转换电压，计算其非线性度指标。考虑一个从模拟输入电压到数字码序列的理想化单调映射，其分辨率为 $N$ 比特，其中 $N = 12$。设总码数为 $M = 2^N$，测得的转换电压为 $\\{T_k\\}_{k=1}^{M-1}$（单位为伏特），其中 $T_k$ 是输出码从 $k-1$ 变为 $k$ 时的模拟输入。假设输入范围为 $[V_\\mathrm{L}, V_\\mathrm{H}]$，其中 $V_\\mathrm{L} = 0.0 \\,\\mathrm{V}$ 且 $V_\\mathrm{H} = 1.2 \\,\\mathrm{V}$，并定义理想最低有效位 (LSB) 大小为 $\\Delta = (V_\\mathrm{H} - V_\\mathrm{L}) / M$（单位为伏特）。\n\n您的目标是，对于下方的每个测试用例，计算相对于根据测量转换点构建的端点拟合线的以下量值：\n1) 所有内部码元区间的最大绝对微分非线性度 (DNL)，以最低有效位 (LSB) 为单位，表示为浮点数，四舍五入到六位小数。DNL 的计算仅使用位于测量转换点之间的码元区间，即索引为 $i \\in \\{1,2,\\dots,M-2\\}$ 且对应宽度为 $T_{i+1} - T_i$ 的区间。\n2) 所有测量转换索引 $k \\in \\{1,2,\\dots,M-1\\}$ 的最大绝对积分非线性度 (INL)，以 LSB 为单位，表示为浮点数，四舍五入到六位小数。\n3) 丢码计数，为整数，定义为宽度为非正值的码元区间数量，即满足 $T_{i+1} - T_i \\le 0$ 的索引 $i \\in \\{1,2,\\dots,M-2\\}$ 的数量。\n4) 一个布尔值，指示测量的转换序列是否严格递增，即对于所有 $k \\in \\{1,2,\\dots,M-2\\}$，是否都满足 $T_{k+1}  T_k$。\n\n端点拟合线是穿过第一个和最后一个测量转换点的唯一仿射函数，其变量为转换索引 $k$。这两个点是 $(k,V) = (1,T_1)$ 和 $(k,V) = (M-1,T_{M-1})$。使用该线的斜率来定义拟合的 LSB 大小，并使用该线来定义用于计算积分非线性度的拟合“理想”转换位置。所有 DNL 和 INL 值都必须以拟合的 LSB 为单位表示。\n\n测试套件中与角度相关的表达式使用弧度。\n\n测试套件（所有情况均使用 $N = 12$，$V_\\mathrm{L} = 0.0 \\,\\mathrm{V}$，$V_\\mathrm{H} = 1.2 \\,\\mathrm{V}$，$\\Delta = (V_\\mathrm{H}-V_\\mathrm{L})/2^{12}$）：\n- 情况 A（理想阶梯）：对于所有 $k \\in \\{1,2,\\dots,M-1\\}$，$T_k = V_\\mathrm{L} + k \\,\\Delta$。\n- 情况 B（仅仿射增益和偏移）：选择 $\\alpha = 0.005 \\,\\mathrm{V}$ 和 $\\beta = 1.01$，并对于所有 $k$，设置 $T_k = \\alpha + \\beta \\,\\big(V_\\mathrm{L} + k \\,\\Delta\\big)$。\n- 情况 C（单个丢码）：从情况 A 的理想 $T_k$ 开始，然后选择 $k^\\ast = 2000$；用 $T_{k^\\ast+1}$ 替换 $T_{k^\\ast}$，所有其他 $T_k$ 保持不变。\n- 情况 D（平滑转换弓形）：选择 $A = 0.25\\,\\Delta$，并对于所有 $k$，设置 $T_k = V_\\mathrm{L} + k \\,\\Delta + A \\,\\sin\\!\\big(2\\pi k / M\\big)$。\n\n对于每个测试用例，计算并报告：\n- 索引为 $i \\in \\{1,\\dots,M-2\\}$ 的码元区间的最大绝对 DNL，以 LSB 为单位，四舍五入到六位小数。\n- 索引为 $k \\in \\{1,\\dots,M-1\\}$ 的转换点的最大绝对 INL，以 LSB 为单位，四舍五入到六位小数。\n- 丢码计数，为整数。\n- 按规定指定的严格递增布尔值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果构成一个子列表，顺序为 $[$情况 A, 情况 B, 情况 C, 情况 D$]$。每个子列表必须为 $[$maxAbsDNL,maxAbsINL,missingCount,strictlyIncreasing$]$ 的形式。输出字符串中不应包含任何空白字符。例如，一个语法上有效的形式是 $[[a,b,c,d],[e,f,g,h],\\dots]$，其中 $a,b,e,f$ 是四舍五入到六位小数的浮点数，$c,g$ 是整数，$d,h$ 是布尔值。",
            "solution": "问题陈述经过严格审查，被认为是有效的。它在科学上基于模数转换器特性表征的原理，问题适定，信息充分且一致，表述客观。所有术语均为电子学和集成电路领域的标准术语。因此，我们可以进行形式化求解。\n\n问题的核心是，在给定一个模数转换器 (ADC) 测得的码转换电压 $\\{T_k\\}_{k=1}^{M-1}$ 的情况下，计算其四项性能指标。分辨率为 $N=12$ 比特，因此总码数为 $M = 2^{12} = 4096$。标称输入电压范围为 $[V_\\mathrm{L}, V_\\mathrm{H}] = [0.0 \\,\\mathrm{V}, 1.2 \\,\\mathrm{V}]$，这定义了理想最低有效位 (LSB) 的大小为 $\\Delta = (V_\\mathrm{H} - V_\\mathrm{L}) / M = 1.2 / 4096 \\,\\mathrm{V}$。\n\n所有指标都将相对于一条端点拟合线进行计算，该线使用第一个和最后一个测量的转换电压 $T_1$ 和 $T_{M-1}$ 构建。\n\n**1. 端点拟合线和拟合的 LSB ($\\Delta_{fit}$)**\n端点拟合线是一个仿射函数 $V_{fit}(k) = m \\cdot k + c$，它穿过点 $(k,V)=(1, T_1)$ 和点 $(k,V)=(M-1, T_{M-1})$。该线的斜率 $m$ 定义了拟合的 LSB 大小，我们将其表示为 $\\Delta_{fit}$。\n$$\n\\Delta_{fit} = \\frac{T_{M-1} - T_1}{(M-1) - 1} = \\frac{T_{M-1} - T_1}{M-2}\n$$\n根据此拟合，理想的转换电压由该线本身给出。使用点 $(1, T_1)$ 的点斜式：\n$$\nV_{fit}(k) = T_1 + (k-1)\\Delta_{fit}\n$$\n\n**2. 微分非线性度 (DNL)**\n第 $i$ 个码元区间的 DNL 衡量其宽度与拟合的 LSB 大小 $\\Delta_{fit}$ 的偏差。第 $i$ 个内部码元区间（对于 $i \\in \\{1, 2, \\dots, M-2\\}$）的宽度为 $W_i = T_{i+1} - T_i$。则 DNL 为：\n$$\n\\mathrm{DNL}_i = \\frac{W_i - \\Delta_{fit}}{\\Delta_{fit}} = \\frac{T_{i+1} - T_i}{\\Delta_{fit}} - 1\n$$\n需要报告的值是所有指定码元区间的最大绝对 DNL：$\\max_{i \\in \\{1,\\dots,M-2\\}} |\\mathrm{DNL}_i|$。\n\n**3. 积分非线性度 (INL)**\n第 $k$ 个转换点的 INL 衡量测量的转换电压 $T_k$ 与其在拟合线上的理想位置 $V_{fit}(k)$ 的偏差。此偏差通过 $\\Delta_{fit}$ 进行归一化。\n$$\n\\mathrm{INL}_k = \\frac{T_k - V_{fit}(k)}{\\Delta_{fit}} = \\frac{T_k - (T_1 + (k-1)\\Delta_{fit})}{\\Delta_{fit}}\n$$\n根据端点拟合的构造，$\\mathrm{INL}_1$ 和 $\\mathrm{INL}_{M-1}$ 恒为零。需要报告的值是所有转换点的最大绝对 INL：$\\max_{k \\in \\{1,\\dots,M-1\\}} |\\mathrm{INL}_k|$。\n\n**4. 丢码和单调性**\n当一个码元区间的宽度为非正值时，就会发生丢码。丢码数是满足 $W_i = T_{i+1} - T_i \\le 0$ 的索引 $i \\in \\{1, \\dots, M-2\\}$ 的数量。\n如果所有码元区间的宽度都严格为正，即对于所有检查的索引 $k \\in \\{1, \\dots, M-2\\}$，都有 $T_{k+1} - T_k  0$，则 ADC 的传递函数是严格递增的（单调的）。这等价于没有丢码。\n\n现在我们将这些定义应用于每个测试用例。\n\n**情况 A：理想阶梯**\n转换点为 $T_k = k\\Delta$。\n-\n$T_1 = \\Delta$ 且 $T_{M-1} = (M-1)\\Delta$。\n-\n$\\Delta_{fit} = \\frac{(M-1)\\Delta - \\Delta}{M-2} = \\frac{(M-2)\\Delta}{M-2} = \\Delta$。拟合的 LSB 就是理想的 LSB。\n-\n$V_{fit}(k) = \\Delta + (k-1)\\Delta = k\\Delta = T_k$。拟合线与理想转换点重合。\n-\nDNL：码元区间宽度为 $W_i = T_{i+1} - T_i = (i+1)\\Delta - i\\Delta = \\Delta$。因此，对于所有 $i$，$\\mathrm{DNL}_i = (\\Delta - \\Delta_{fit})/\\Delta_{fit} = 0$。最大绝对 DNL 为 $0.0$。\n-\nINL：偏差为 $T_k - V_{fit}(k) = k\\Delta - k\\Delta = 0$。因此，对于所有 $k$，$\\mathrm{INL}_k = 0$。最大绝对 INL 为 $0.0$。\n-\n丢码与单调性：由于 $W_i = \\Delta  0$，没有丢码（计数为 $0$），且序列是严格递增的 (True)。\n-\n**结果：** $[0.0, 0.0, 0, \\text{True}]$\n\n**情况 B：仿射增益和偏移**\n转换点为 $T_k = \\alpha + \\beta k\\Delta$，其中 $\\alpha=0.005$ 且 $\\beta=1.01$。\n-\n$T_1 = \\alpha + \\beta\\Delta$ 且 $T_{M-1} = \\alpha + \\beta(M-1)\\Delta$。\n-\n$\\Delta_{fit} = \\frac{(\\alpha + \\beta(M-1)\\Delta) - (\\alpha + \\beta\\Delta)}{M-2} = \\frac{\\beta(M-2)\\Delta}{M-2} = \\beta\\Delta$。\n-\n$V_{fit}(k) = T_1 + (k-1)\\Delta_{fit} = (\\alpha + \\beta\\Delta) + (k-1)\\beta\\Delta = \\alpha + k\\beta\\Delta = T_k$。端点拟合完美地模拟了仿射变换。\n-\nDNL 和 INL：与情况 A 一样，由于 $T_k = V_{fit}(k)$ 且 $W_i = \\beta\\Delta = \\Delta_{fit}$，DNL 和 INL 均恒为零。最大绝对值为 $0.0$。\n-\n丢码与单调性：$W_i = \\beta\\Delta  0$。没有丢码（$0$），严格递增 (True)。\n-\n**结果：** $[0.0, 0.0, 0, \\text{True}]$\n\n**情况 C：单个丢码**\n转换点 $T'_k$ 是理想的（$T_k=k\\Delta$），除了 $k^\\ast=2000$ 处，该点为 $T'_{2000} = T_{2001} = 2001\\Delta$。\n-\n$T'_1 = \\Delta$ 且 $T'_{M-1} = (M-1)\\Delta$。端点不受影响。\n-\n$\\Delta_{fit} = \\Delta$ 且 $V_{fit}(k) = k\\Delta$，与情况 A 相同。\n-\nDNL：我们检查 $i=2000$ 附近的码元区间宽度。\n-\n$W_{1999} = T'_{2000} - T'_{1999} = 2001\\Delta - 1999\\Delta = 2\\Delta$。$\\mathrm{DNL}_{1999} = (2\\Delta - \\Delta)/\\Delta = 1$。\n-\n$W_{2000} = T'_{2001} - T'_{2000} = 2001\\Delta - 2001\\Delta = 0$。$\\mathrm{DNL}_{2000} = (0 - \\Delta)/\\Delta = -1$。\n-\n其他 $W_i = \\Delta$，因此 $\\mathrm{DNL}_i=0$。最大绝对 DNL 为 $1.0$。\n-\nINL：$\\mathrm{INL}_k = (T'_k - k\\Delta)/\\Delta$。这仅在 $k=2000$ 时不为零。\n-\n$\\mathrm{INL}_{2000} = (T'_{2000} - 2000\\Delta)/\\Delta = (2001\\Delta - 2000\\Delta)/\\Delta = 1$。\n-\n最大绝对 INL 为 $1.0$。\n-\n丢码与单调性：$W_{2000} = 0$，这满足丢码的判据。计数为 $1$。这也意味着序列不是严格递增的 (False)。\n-\n**结果：** $[1.0, 1.0, 1, \\text{False}]$\n\n**情况 D：平滑转换弓形**\n转换点为 $T_k = k\\Delta + A\\sin(2\\pi k/M)$，其中 $A=0.25\\Delta$。\n-\n$T_1 = \\Delta + A\\sin(2\\pi/M)$，$T_{M-1} = (M-1)\\Delta + A\\sin(2\\pi(M-1)/M) = (M-1)\\Delta - A\\sin(2\\pi/M)$。\n-\n$\\Delta_{fit} = \\frac{((M-1)\\Delta - A\\sin(2\\pi/M)) - (\\Delta + A\\sin(2\\pi/M))}{M-2} = \\Delta - \\frac{2A}{M-2}\\sin(2\\pi/M)$。$\\Delta_{fit}$ 略小于 $\\Delta$。\n-\n$V_{fit}(k) = T_1 + (k-1)\\Delta_{fit}$。\n-\nDNL：码元区间宽度为 $W_i = T_{i+1} - T_i = \\Delta + A(\\sin(\\frac{2\\pi(i+1)}{M}) - \\sin(\\frac{2\\pi i}{M}))$。使用泰勒展开，此宽度约等于 $W_i \\approx \\Delta + A\\frac{2\\pi}{M}\\cos(\\frac{2\\pi(i+0.5)}{M})$。DNL，即 $\\frac{W_i - \\Delta_{fit}}{\\Delta_{fit}}$，将在余弦项（代表正弦弓形的导数）取极值时达到其最大幅值。\n-\nINL：相对于拟合线的误差是 $T_k - V_{fit}(k)$。函数 $V_{fit}(k)$ 是 $T_k$ 曲线端点之间的线性插值。INL 测量的是正弦误差相对于连接其端点的弦的“弓形”程度。最大值出现在 $k=M/4$ 和 $k=3M/4$ 附近。最大偏差将接近 $A$，使得最大绝对 INL 接近 $A/\\Delta_{fit} \\approx A/\\Delta = 0.25$。\n-\n丢码与单调性：最小码元区间宽度出现在余弦项为 $-1$ 的地方，即 $i \\approx M/2$。最小宽度为 $W_{min} \\approx \\Delta - A\\frac{2\\pi}{M} = \\Delta(1 - 0.25 \\frac{2\\pi}{M})$。由于 $0.5\\pi/M \\ll 1$，所有宽度均为正值。没有丢码（$0$），序列是严格递增的 (True)。\n-\n需要进行数值计算以获得精确的 DNL 和 INL 值。\n\n以下 Python 代码实现了对所有四种情况的这些计算。\n```python\nimport numpy as np\n\ndef compute_metrics(T_k, M):\n    \"\"\"\n    Computes DNL, INL, missing codes, and monotonicity for a given set of ADC transitions.\n\n    Args:\n        T_k (np.ndarray): Array of measured transition voltages {T_k} for k=1 to M-1.\n        M (int): Total number of ADC codes.\n\n    Returns:\n        tuple: (max_abs_dnl, max_abs_inl, missing_count, is_strictly_increasing)\n    \"\"\"\n    # 1. Endpoint Fit and Fitted LSB\n    T_1 = T_k[0]\n    T_M_minus_1 = T_k[M - 2]\n    delta_fit = (T_M_minus_1 - T_1) / (M - 2)\n\n    # 2. DNL Calculation\n    # Bins are indexed i from 1 to M-2, corresponding to widths T_{i+1} - T_i.\n    # In Python array terms, T_k has indices 0 to M-2.\n    # T_k[i] corresponds to T_{i+1}. T_k[i-1] corresponds to T_i.\n    # We calculate widths W_i = T_{i+1} - T_i for i = 1, ..., M-2.\n    # This corresponds to T_k[i] - T_k[i-1] for python index i = 1, ..., M-2.\n    widths = T_k[1:M-1] - T_k[0:M-2] # Correct range for i=1 to M-2\n    dnl = (widths / delta_fit) - 1\n    max_abs_dnl = np.max(np.abs(dnl))\n\n    # 3. INL Calculation\n    # For transitions k from 1 to M-1.\n    k_indices = np.arange(1, M)\n    v_fit = T_1 + (k_indices - 1) * delta_fit\n    inl = (T_k - v_fit) / delta_fit\n    max_abs_inl = np.max(np.abs(inl))\n\n    # 4. Missing Codes and Monotonicity\n    # Based on widths for bins i from 1 to M-2\n    missing_count = np.sum(widths = 0)\n    # Check T_{k+1}  T_k for k=1,...,M-2. This corresponds to widths W_k0.\n    is_strictly_increasing = (missing_count == 0)\n\n    return (max_abs_dnl, max_abs_inl, int(missing_count), is_strictly_increasing)\n\ndef solve():\n    \"\"\"\n    Main function to generate test cases and compute metrics.\n    \"\"\"\n    N = 12\n    M = 2**N\n    V_L = 0.0\n    V_H = 1.2\n    DELTA = (V_H - V_L) / M\n\n    # k is the transition index from 1 to M-1.\n    k_arr = np.arange(1, M, dtype=np.float64)\n\n    # Case A: Ideal ladder\n    T_k_A = V_L + k_arr * DELTA\n    \n    # Case B: Affine gain and offset\n    alpha = 0.005\n    beta = 1.01\n    T_k_B = alpha + beta * (V_L + k_arr * DELTA)\n    \n    # Case C: Single missing code\n    T_k_C = V_L + k_arr * DELTA\n    k_star = 2000\n    # T_k_C index k_star-1 corresponds to T_{k_star}\n    T_k_C[k_star - 1] = V_L + (k_star + 1) * DELTA\n\n    # Case D: Smooth transition bow\n    A = 0.25 * DELTA\n    T_k_D = V_L + k_arr * DELTA + A * np.sin(2 * np.pi * k_arr / M)\n    \n    test_cases = [T_k_A, T_k_B, T_k_C, T_k_D]\n    \n    all_results = []\n    for T_k in test_cases:\n        metrics = compute_metrics(T_k, M)\n        rounded_metrics = [\n            round(metrics[0], 6),\n            round(metrics[1], 6),\n            metrics[2],\n            metrics[3]\n        ]\n        all_results.append(rounded_metrics)\n\n    # Format output string\n    sub_results = []\n    for res in all_results:\n        s = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]},{str(res[3])}]\"\n        sub_results.append(s)\n    \n    final_str = f\"[{','.join(sub_results)}]\"\n    print(final_str)\n\nsolve()\n```",
            "answer": "[[0.000000,0.000000,0,True],[0.000000,0.000000,0,True],[1.000000,1.000000,1,False],[0.000384,0.250000,0,True]]"
        },
        {
            "introduction": "我们已经了解了如何表征像积分非线性（INL）这样的静态误差，但我们最初该如何设计一个ADC来最小化这些误差呢？这个高级实践  通过使用元器件失配的基本模型——Pelgrom定律，将系统级性能与物理器件设计直接联系起来。您将推导出电容式DAC中所需的最小电容单元面积 $A_u$，以确保由失配引起的INL保持在指定目标之内，从而深入了解电路面积与精度之间的关键权衡。",
            "id": "4255018",
            "problem": "一款分段式逐次逼近寄存器模数转换器 (SAR ADC) 使用一个由金属-绝缘体-金属 (MIM) 电容器实现的电容式数模转换器 (DAC)。总分辨率为 $N=10$ 位。最高的 $K=5$ 位由一个包含 $M=2^{K}$ 个相同单位电容的温度计编码阵列实现，该阵列采用共质心布局以抑制系统性梯度；剩余的最低有效 $N-K$ 位由二进制加权电容器实现，在本设计中，其对失配限制的静态非线性的贡献与温度计编码部分相比可以忽略不计。假设每个单位电容的随机失配是独立的、零均值的，并且失配遵循 Pelgrom 定律：相对失配的标准差按如下方式缩放\n$$\n\\frac{\\sigma_{\\Delta C}}{C_{u}}=\\frac{A_{C}}{\\sqrt{A_{u}}},\n$$\n其中 $C_{u}$ 是标称单位电容值，$A_{u}$ 是单位电容的物理面积，$A_{C}$ 是 MIM 电容器与工艺相关的 Pelgrom 系数。积分非线性 (INL) 定义为静态传输函数与理想直线之间偏差的最大幅值，以完整的 $N$ 位转换器的最低有效位 (LSB) 为单位表示。\n\n从第一性原理（器件失配统计和 DAC 输出比率的小信号线性化）出发，推导出一个闭式不等式，用于计算最小单位面积 $A_{u}$，以保证在 99.7% 的良率（即三个标准差）下，完整的 $N$ 位转换器的失配限制峰值 INL 小于指定目标 $\\varepsilon$ LSB。然后，根据以下设计目标和工艺参数计算该最小面积：$N=10$，$K=5$，$\\varepsilon=0.25$，$A_{C}=0.01$ 微米。将最终面积 $A_{u}$ 以 $\\mu\\mathrm{m}^{2}$ 表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在一个分段式逐次逼近寄存器 (SAR) 模数转换器 (ADC) 中，为最小单位电容面积 $A_u$ 推导一个闭式不等式。这是为了确保在 99.7% 的良率下，失配限制的峰值积分非线性 (INL) 保持在指定值 $\\varepsilon$ 以下。推导之后将进行数值计算。\n\n首先，我们建立电容式数模转换器 (DAC) 的模型并分析失配的影响。该 ADC 的总分辨率为 $N=10$ 位。包含 $K=5$ 位的最高有效位 (MSB) 段是一个由 $M=2^{K}$ 个相同单位电容 $C_u$ 构成的温度计编码阵列。最低有效位 (LSB) 段对失配引起的非线性的贡献被假设为可以忽略不计，因此我们的分析将只关注 MSB 温度计阵列。\n\n理想电荷再分配 DAC 的输出是一个与数字输入码成正比的电压 $V_{DAC}$。对于给定的数字码，电容阵列顶板上的电压由切换到参考电压 $V_{ref}$ 的电容与 DAC 总电容 $C_{TOT}$ 的比率决定。对于温度计编码的 MSB 段，一个数字码 $m$（其中 $m$ 的范围从 0 到 $M$）对应于选择 $m$ 个单位电容连接到 $V_{ref}$。\n\n在一个理想的 DAC 中，所有单位电容都相同 ($C_{u,i} = C_u$)，总电容为 $C_{TOT, ideal} = M C_u$，由 MSB 码 $m$ 生成的电压为 $V_{DAC, ideal}(m) = V_{ref} \\frac{m C_u}{M C_u} = V_{ref} \\frac{m}{M}$。\n\n实际上，每个电容器都与标称值有一个小的随机偏差：$C_{u,i} = C_u + \\Delta C_i$。量 $\\Delta C_i$ 是独立同分布的随机变量，其均值为零 ($E[\\Delta C_i] = 0$)，方差为 $Var(\\Delta C_i) = \\sigma_{\\Delta C}^2$。\n\n实际总电容为 $C_{TOT} = \\sum_{i=1}^{M} C_{u,i} = M C_u + \\sum_{i=1}^{M} \\Delta C_i$。对于码 $m$，切换的电容为 $\\sum_{i \\in S_m} C_{u,i} = m C_u + \\sum_{i \\in S_m} \\Delta C_i$，其中 $S_m$ 是 $m$ 个被选电容的集合。实际的 DAC 输出电压为：\n$$V_{DAC}(m) = V_{ref} \\frac{m C_u + \\sum_{i \\in S_m} \\Delta C_i}{M C_u + \\sum_{j=1}^{M} \\Delta C_j}$$\n对于小失配（$\\sum \\Delta C_j \\ll M C_u$），我们可以对该表达式进行线性化：\n$$V_{DAC}(m) \\approx V_{ref} \\frac{m C_u + \\sum_{i \\in S_m} \\Delta C_i}{M C_u} \\left(1 - \\frac{\\sum_{j=1}^{M} \\Delta C_j}{M C_u}\\right) \\approx V_{ref} \\left( \\frac{m}{M} + \\frac{\\sum_{i \\in S_m} \\Delta C_i}{M C_u} - \\frac{m \\sum_{j=1}^{M} \\Delta C_j}{M^2 C_u} \\right)$$\n电压误差 $\\Delta V(m)$ 是实际电压与理想电压之差：\n$$\\Delta V(m) = V_{DAC}(m) - V_{DAC, ideal}(m) = \\frac{V_{ref}}{M C_u} \\left( \\sum_{i \\in S_m} \\Delta C_i - \\frac{m}{M} \\sum_{j=1}^{M} \\Delta C_j \\right)$$\n为了求此误差的方差，我们定义一个随机变量 $Y_m = \\sum_{i \\in S_m} \\Delta C_i - \\frac{m}{M} \\sum_{j=1}^{M} \\Delta C_j$。这可以重写为 $Y_m = \\sum_{j=1}^{M} \\alpha_j \\Delta C_j$，其中对于 $m$ 个被选电容，$\\alpha_j = 1 - \\frac{m}{M}$，对于 $M-m$ 个未被选电容，$\\alpha_j = -\\frac{m}{M}$。\n由于 $\\Delta C_j$ 是不相关的，因此 $Y_m$ 的方差为：\n$$Var(Y_m) = \\sum_{j=1}^{M} \\alpha_j^2 Var(\\Delta C_j) = \\sigma_{\\Delta C}^2 \\left( m\\left(1-\\frac{m}{M}\\right)^2 + (M-m)\\left(-\\frac{m}{M}\\right)^2 \\right)$$\n$$Var(Y_m) = \\sigma_{\\Delta C}^2 \\left( \\frac{m(M-m)^2}{M^2} + \\frac{(M-m)m^2}{M^2} \\right) = \\frac{\\sigma_{\\Delta C}^2}{M^2} [m(M-m)(M-m+m)] = \\sigma_{\\Delta C}^2 \\frac{m(M-m)}{M}$$\n电压误差的方差为 $\\sigma_{\\Delta V}^2(m) = \\left(\\frac{V_{ref}}{M C_u}\\right)^2 Var(Y_m) = \\left(\\frac{V_{ref}}{M C_u}\\right)^2 \\sigma_{\\Delta C}^2 \\frac{m(M-m)}{M}$。\n该方差在中间码值 $m=\\frac{M}{2}$ 处达到最大，这对应于此类误差的峰值 INL 位置。\n$$\\sigma_{\\Delta V, peak}^2 = \\left(\\frac{V_{ref}}{M C_u}\\right)^2 \\sigma_{\\Delta C}^2 \\frac{(M/2)(M/2)}{M} = \\left(\\frac{V_{ref}}{M C_u}\\right)^2 \\sigma_{\\Delta C}^2 \\frac{M}{4}$$\n峰值电压误差的标准差为 $\\sigma_{\\Delta V, peak} = \\frac{V_{ref}}{M C_u} \\sigma_{\\Delta C} \\frac{\\sqrt{M}}{2} = \\frac{V_{ref}}{2\\sqrt{M} C_u} \\sigma_{\\Delta C}$。\n\nINL 以完整的 $N$ 位转换器的最低有效位 (LSB) 为单位定义，其中 $V_{LSB} = \\frac{V_{ref}}{2^N}$。峰值 INL 的标准差为：\n$$\\sigma_{INL, peak} = \\frac{\\sigma_{\\Delta V, peak}}{V_{LSB}} = \\frac{\\frac{V_{ref}}{2\\sqrt{M} C_u} \\sigma_{\\Delta C}}{\\frac{V_{ref}}{2^N}} = \\frac{2^N}{2\\sqrt{M}} \\frac{\\sigma_{\\Delta C}}{C_u}$$\n给定 $M=2^K$，我们有 $\\sqrt{M} = 2^{K/2}$。\n$$\\sigma_{INL, peak} = \\frac{2^N}{2 \\cdot 2^{K/2}} \\frac{\\sigma_{\\Delta C}}{C_u} = 2^{N - K/2 - 1} \\frac{\\sigma_{\\Delta C}}{C_u}$$\n良率要求为 99.7%，对应于 $3\\sigma$ 的设计裕度。峰值 INL 必须小于 $\\varepsilon$：\n$$3 \\cdot \\sigma_{INL, peak}  \\varepsilon$$\n$$3 \\cdot 2^{N - K/2 - 1} \\frac{A_C}{\\sqrt{A_u}}  \\varepsilon$$\n现在我们代入 Pelgrom 定律, $\\frac{\\sigma_{\\Delta C}}{C_{u}}=\\frac{A_{C}}{\\sqrt{A_{u}}}$：\n$$3 \\cdot 2^{N - K/2 - 1} \\frac{A_C}{\\sqrt{A_u}}  \\varepsilon$$\n我们现在可以通过求解 $\\sqrt{A_u}$ 来推导最小单位面积 $A_u$ 的不等式：\n$$\\sqrt{A_u} > \\frac{3 \\cdot A_C \\cdot 2^{N - K/2 - 1}}{\\varepsilon}$$\n两边平方得到最小面积的最终闭式不等式：\n$$A_u > \\left( \\frac{3 \\cdot A_C \\cdot 2^{N - K/2 - 1}}{\\varepsilon} \\right)^2$$\n现在，我们用给定的参数计算这个表达式：$N=10$，$K=5$，$\\varepsilon=0.25$，$A_C = 0.01\\ \\mu\\mathrm{m}$。\n指数为 $N - K/2 - 1 = 10 - \\frac{5}{2} - 1 = 10 - 2.5 - 1 = 6.5$。\n最小所需面积 $A_{u,min}$ 为：\n$$A_{u,min} = \\left( \\frac{3 \\cdot (0.01) \\cdot 2^{6.5}}{0.25} \\right)^2$$\n让我们计算括号中的项：\n$$\\frac{3 \\cdot 0.01 \\cdot 2^6 \\cdot \\sqrt{2}}{0.25} = \\frac{0.03 \\cdot 64 \\cdot \\sqrt{2}}{0.25} = 4 \\cdot 1.92 \\cdot \\sqrt{2} = 7.68 \\sqrt{2}$$\n将该值平方得到面积：\n$$A_{u,min} = (7.68 \\sqrt{2})^2 = (7.68)^2 \\cdot 2 = 58.9824 \\cdot 2 = 117.9648$$\n$A_C$ 的单位是 $\\mu\\mathrm{m}$，所以 $A_u$ 的单位是 $\\mu\\mathrm{m}^2$。\n将结果四舍五入到四位有效数字，我们得到 $118.0$。",
            "answer": "$$\\boxed{118.0}$$"
        }
    ]
}