{
    "hands_on_practices": [
        {
            "introduction": "在分析任何实际的数模转换器（DAC）之前，建立一个理想的基准是至关重要的。这项练习将引导您从第一性原理出发，推导和计算一个理想DAC的两个核心参数：最低有效位（LSB）的大小和理想的量化噪声功率。通过这项基础计算，您将掌握分辨率如何直接决定DAC的精度极限和其固有的噪声基底，为评估真实器件的非理想性表现奠定理论基础。",
            "id": "4262893",
            "problem": "考虑一个理想的 $N$ 位数模转换器 (DAC)，其输出电平在满量程范围 $V_{\\mathrm{FS}} = 1\\ \\mathrm{V}$ 内均匀分布。采用规范的均匀中置式量化器模型，其中 $2^{N}$ 个可表示的输出电平将范围 $V_{\\mathrm{FS}}$ 划分为 $2^{N}$ 个等宽的量化区间。假设量化误差样本随时间在其支撑集上均匀分布，请仅使用第一性原理和量化理论的核心定义，推导该 DAC 输出端的最低有效位 (LSB) 步长和理想量化误差功率。然后，计算：\n- 以 $\\mu\\mathrm{V}$ 表示的 LSB 幅值，以及\n- 以 $\\mathrm{V}^{2}$ 表示的相应理想量化噪声功率，\n两者均表示为 $N$ 的符号函数。请用关于 $N$ 的符号形式表示您的最终答案，不要四舍五入。",
            "solution": "本问题要求推导一个理想 $N$ 位数模转换器 (DAC) 的两个基本指标：最低有效位 (LSB) 的幅值和理想量化噪声的功率。推导将按要求从第一性原理开始。\n\n首先，我们确定 LSB 步长，记为 $\\Delta$。一个 $N$ 位转换器拥有 $2^N$ 个不同的数字输入码，这些输入码映射到 $2^N$ 个离散的模拟输出电压电平。问题规定，这 $2^N$ 个电平将满量程范围 $V_{\\mathrm{FS}}$ 均匀划分为 $2^N$ 个等宽的量化区间。根据定义，这样一个区间的宽度就是 LSB 步长。这引出以下关系：\n$$ \\Delta = \\frac{V_{\\mathrm{FS}}}{2^N} $$\n我们已知满量程范围为 $V_{\\mathrm{FS}} = 1\\ \\mathrm{V}$。代入此值，以伏特为单位的 LSB 步长为：\n$$ \\Delta = \\frac{1}{2^N}\\ \\mathrm{V} $$\n问题的第一部分要求以微伏 ($\\mu\\mathrm{V}$) 表示 LSB 的幅值。从伏特到微伏的换算关系是 $1\\ \\mathrm{V} = 10^6\\ \\mu\\mathrm{V}$。应用此换算因子，我们得到 LSB 幅值作为 $N$ 的符号函数：\n$$ \\Delta_{\\mu\\mathrm{V}} = \\left( \\frac{1}{2^N}\\ \\mathrm{V} \\right) \\times \\left( \\frac{10^6\\ \\mu\\mathrm{V}}{1\\ \\mathrm{V}} \\right) = \\frac{10^6}{2^N} $$\n此表达式表示以微伏为单位的 LSB 幅值。\n\n接下来，我们推导理想量化噪声功率 $P_q$。量化误差 $e_q$ 是被表示的连续值信号与量化器产生的离散输出电平之间的差值。对于指定的均匀中置式量化器模型，离散输出电平位于每个量化区间的中心。因此，量化误差被限制在对称区间 $[-\\frac{\\Delta}{2}, +\\frac{\\Delta}{2}]$ 内。\n\n问题设定了一个标准假设，即量化误差 $e_q$ 是一个在其支撑区间上均匀分布的随机变量。因此，误差的概率密度函数 (PDF)，记为 $f(e_q)$，在此区间上为常数，在其他地方为零：\n$$\nf(e_q) =\n\\begin{cases}\n\\frac{1}{(\\Delta/2) - (-\\Delta/2)} = \\frac{1}{\\Delta}  & \\text{for } -\\frac{\\Delta}{2} \\le e_q \\le \\frac{\\Delta}{2} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n理想量化噪声功率 $P_q$ 定义为量化误差的均方值，即 $E[e_q^2]$。对于像这样的零均值分布，均方值等于其方差。我们通过对 $e_q^2$ 与 PDF 的乘积在所有可能的 $e_q$ 值上进行积分来计算它：\n$$ P_q = E[e_q^2] = \\int_{-\\infty}^{\\infty} e_q^2 f(e_q) \\, de_q $$\n将均匀 PDF 代入积分中得到：\n$$ P_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q^2 \\left( \\frac{1}{\\Delta} \\right) \\, de_q $$\n我们继续计算这个基本积分：\n$$ P_q = \\frac{1}{\\Delta} \\left[ \\frac{e_q^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} $$\n$$ P_q = \\frac{1}{3\\Delta} \\left[ \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right] $$\n$$ P_q = \\frac{1}{3\\Delta} \\left[ \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right] = \\frac{1}{3\\Delta} \\left[ \\frac{\\Delta^3}{8} + \\frac{\\Delta^3}{8} \\right] $$\n$$ P_q = \\frac{1}{3\\Delta} \\left( 2 \\cdot \\frac{\\Delta^3}{8} \\right) = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{4} \\right) $$\n这简化为量化噪声功率的规范结果：\n$$ P_q = \\frac{\\Delta^2}{12} $$\n最后，为了将 $P_q$ 表示为 $N$ 的符号函数，我们将表达式 $\\Delta = \\frac{V_{\\mathrm{FS}}}{2^N}$（其中 $V_{\\mathrm{FS}} = 1\\ \\mathrm{V}$）代入：\n$$ P_q = \\frac{1}{12} \\left( \\frac{1}{2^N} \\right)^2 = \\frac{1}{12 \\cdot (2^N)^2} $$\n$$ P_q = \\frac{1}{12 \\cdot 2^{2N}} $$\n该量的单位是 $\\mathrm{V}^2$，这对于均方电压是合适的，它对应于一个归一化的 $1\\ \\Omega$ 系统中的功率。\n\n总之，所求的两个关于 $N$ 的符号函数是：\n1. 以 $\\mu\\mathrm{V}$ 表示的 LSB 幅值：$\\frac{10^6}{2^N}$\n2. 以 $\\mathrm{V}^2$ 表示的理想量化噪声功率：$\\frac{1}{12 \\cdot 2^{2N}}$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{10^6}{2^N} & \\frac{1}{12 \\cdot 2^{2N}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际应用中，DAC的静态非线性是关键的性能指标，通常通过积分非线性（INL）和微分非线性（DNL）来表征。这项练习提供了一组假设的INL测量数据，要求您利用INL和DNL之间的内在关系来计算DNL值。通过这个实践，您将学会如何从INL数据中诊断出潜在的性能问题，例如非单调性（即DNL低于-1 LSB），这是评估和调试DAC静态性能的一项核心技能。",
            "id": "4262902",
            "problem": "一个分辨率为 $N$ 位的数模转换器 (DAC) 在稳态条件下测量时表现出静态非线性。设 $V_{\\text{actual}}(k)$ 表示在码值 $k \\in \\{0,1,\\dots,2^{N}-1\\}$ 时测得的 DAC 输出，端点拟合参考线定义为 $V_{\\text{fit}}(k) = V_{\\text{actual}}(0) + k \\cdot \\text{LSB}_{e}$，其中 $\\text{LSB}_{e} = \\dfrac{V_{\\text{actual}}(2^{N}-1) - V_{\\text{actual}}(0)}{2^{N}-1}$。定义积分非线性 (INL) 为 $I(k) = \\dfrac{V_{\\text{actual}}(k) - V_{\\text{fit}}(k)}{\\text{LSB}_{e}}$，微分非线性 (DNL) 为 $D(k) = \\dfrac{V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1)}{\\text{LSB}_{e}} - 1$（对于 $k \\geq 1$）。这些量都归一化到端点拟合的最低有效位 (LSB)，因此它们的单位是 $\\mathrm{LSB}$。\n\n考虑一个 $N=12$ 的 DAC，其在一个疑似非单调区域附近测得的积分非线性 (INL) 值（已归一化到 $\\text{LSB}_{e}$）在以下连续码值处给出：\n- $k=2045$: $I(2045)=0.1843$\n- $k=2046$: $I(2046)=0.1402$\n- $k=2047$: $I(2047)=0.0975$\n- $k=2048$: $I(2048)=-1.2389$\n- $k=2049$: $I(2049)=-1.2103$\n- $k=2050$: $I(2050)=-1.1837$\n\n仅从上述 INL 和 DNL 的端点拟合定义出发，通过对测得的 INL 进行离散微分，确定在 $k \\in \\{2046,2047,2048,2049,2050\\}$ 范围内的最小可能微分非线性。然后，评估是否有任何 DNL 值必须低于 $-1$ $\\mathrm{LSB}$，并从第一性原理出发解释其原因。以 $\\mathrm{LSB}$ 为单位报告最小 DNL 的单一数值。将你的最终数值答案四舍五入到四位有效数字，并以 $\\mathrm{LSB}$ 为单位表示最终数字。",
            "solution": "任务是在给定一组积分非线性 $I(k)$ 值的情况下，为指定的数字码值 $k$ 范围找出最小的微分非线性 $D(k)$。$D(k)$ 和 $I(k)$ 之间的关系必须从所提供的定义中推导出来。\n\nINL 的定义如下：\n$$I(k) = \\frac{V_{\\text{actual}}(k) - V_{\\text{fit}}(k)}{\\text{LSB}_{e}}$$\n其中 $V_{\\text{actual}}(k)$ 是在码值 $k$ 时的实测输出电压，$V_{\\text{fit}}(k)$ 是端点拟合线上的理想电压。$\\text{LSB}_{e}$ 是端点拟合线的最低有效位大小。根据这个定义，我们可以将实际输出电压表示为：\n$$V_{\\text{actual}}(k) = I(k) \\cdot \\text{LSB}_{e} + V_{\\text{fit}}(k)$$\n端点拟合线定义为 $V_{\\text{fit}}(k) = V_{\\text{actual}}(0) + k \\cdot \\text{LSB}_{e}$。将此代入 $V_{\\text{actual}}(k)$ 的表达式中，得到：\n$$V_{\\text{actual}}(k) = I(k) \\cdot \\text{LSB}_{e} + V_{\\text{actual}}(0) + k \\cdot \\text{LSB}_{e}$$\n对于码值 $k$ (其中 $k \\ge 1$)，DNL 的定义如下：\n$$D(k) = \\frac{V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1)}{\\text{LSB}_{e}} - 1$$\n为了建立 $D(k)$ 和 $I(k)$ 之间的关系，我们首先使用上面推导出的 $V_{\\text{actual}}(k)$ 表达式来表示电压阶跃 $V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1)$。对于码值 $k$，我们有：\n$$V_{\\text{actual}}(k) = I(k) \\cdot \\text{LSB}_{e} + V_{\\text{actual}}(0) + k \\cdot \\text{LSB}_{e}$$\n对于码值 $k-1$，我们有：\n$$V_{\\text{actual}}(k-1) = I(k-1) \\cdot \\text{LSB}_{e} + V_{\\text{actual}}(0) + (k-1) \\cdot \\text{LSB}_{e}$$\n从第一个方程中减去第二个方程得到电压差，注意到 $V_{\\text{actual}}(0)$ 项相互抵消：\n$$V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1) = (I(k) \\cdot \\text{LSB}_{e} - I(k-1) \\cdot \\text{LSB}_{e}) + (k \\cdot \\text{LSB}_{e} - (k-1) \\cdot \\text{LSB}_{e})$$\n提出因子 $\\text{LSB}_{e}$：\n$$V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1) = (I(k) - I(k-1)) \\cdot \\text{LSB}_{e} + (k - (k-1)) \\cdot \\text{LSB}_{e}$$\n$$V_{\\text{actual}}(k) - V_{\\text{actual}}(k-1) = (I(k) - I(k-1)) \\cdot \\text{LSB}_{e} + 1 \\cdot \\text{LSB}_{e}$$\n现在，我们将此表达式代回 $D(k)$ 的定义中：\n$$D(k) = \\frac{(I(k) - I(k-1)) \\cdot \\text{LSB}_{e} + \\text{LSB}_{e}}{\\text{LSB}_{e}} - 1$$\n将分子除以 $\\text{LSB}_{e}$：\n$$D(k) = (I(k) - I(k-1)) + 1 - 1$$\n这简化为 DNL 和 INL 之间的基本关系，它代表了离散微分：\n$$D(k) = I(k) - I(k-1)$$\n我们现在可以使用这个关系，利用提供的 INL 数据来计算指定码值 $k \\in \\{2046, 2047, 2048, 2049, 2050\\}$ 的 DNL 值。\n\n给定的 INL 数据点（单位为 $\\mathrm{LSB}_{e}$）是：\n$I(2045) = 0.1843$\n$I(2046) = 0.1402$\n$I(2047) = 0.0975$\n$I(2048) = -1.2389$\n$I(2049) = -1.2103$\n$I(2050) = -1.1837$\n\n我们如下计算 DNL 值：\n对于 $k=2046$：\n$D(2046) = I(2046) - I(2045) = 0.1402 - 0.1843 = -0.0441$\n对于 $k=2047$：\n$D(2047) = I(2047) - I(2046) = 0.0975 - 0.1402 = -0.0427$\n对于 $k=2048$：\n$D(2048) = I(2048) - I(2047) = -1.2389 - 0.0975 = -1.3364$\n对于 $k=2049$：\n$D(2049) = I(2049) - I(2048) = -1.2103 - (-1.2389) = -1.2103 + 1.2389 = 0.0286$\n对于 $k=2050$：\n$D(2050) = I(2050) - I(2049) = -1.1837 - (-1.2103) = -1.1837 + 1.2103 = 0.0266$\n\n计算出的 DNL 值（单位为 $\\mathrm{LSB}_{e}$）是：\n$D(2046) = -0.0441$\n$D(2047) = -0.0427$\n$D(2048) = -1.3364$\n$D(2049) = 0.0286$\n$D(2050) = 0.0266$\n\n问题要求找出指定范围内的最小 DNL。通过比较计算出的值，最小值为：\n$$\\min\\{D(k)\\} = D(2048) = -1.3364$$\n问题还要求评估是否有任何 DNL 值必须低于 $-1$ $\\mathrm{LSB}$。如果一个 DAC 的 DNL 对所有码值都始终大于或等于 $-1$ LSB，即 $D(k) \\geq -1$，则保证其是单调的。小于 $-1$ 的 DNL 值表示非单调行为，即随着数字输入码值的增加，模拟输出电压反而减小。在本例中，在码值 $k=2048$ 处，DNL 为 $D(2048) = -1.3364$，该值小于 $-1$。这证实了 DAC 在此转换处是非单调的。从码值 2047 到 2048 的电压阶跃是 $V_{\\text{actual}}(2048) - V_{\\text{actual}}(2047) = (D(2048) + 1) \\cdot \\text{LSB}_e = (-1.3364 + 1) \\cdot \\text{LSB}_e = -0.3364 \\cdot \\text{LSB}_e$，这是一个负变化。\n\n最后的任务是报告最小 DNL 的单一数值，并四舍五入到四位有效数字。最小 DNL 是 $-1.3364$。四舍五入到四位有效数字得到 $-1.336$。",
            "answer": "$$\n\\boxed{-1.336}\n$$"
        },
        {
            "introduction": "DAC的静态非线性（如INL）会直接影响其在处理时变信号时的动态性能，主要表现为谐波失真。这项高级练习将静态误差与动态性能联系起来，要求您基于给定的INL曲线，通过编程模拟来预测DAC输出信号的谐波分量。通过完成这项仿真，您将直观地理解静态非线性是如何在频域中产生谐波的，并掌握一种通过仿真来评估DAC动态特性的重要方法。",
            "id": "4262912",
            "problem": "一个分辨率为 $N$ 位的单极性数模转换器 (DAC) 将数字输入码 $m \\in \\{0,1,\\dots,2^N-1\\}$ 映射到模拟输出。设满量程输出归一化为 $V_{\\mathrm{FS}} = 1$（无量纲单位），因此理想的最低有效位大小为 $V_{\\mathrm{LSB}} = \\dfrac{V_{\\mathrm{FS}}}{2^N-1}$。对于每个码 $m$，提供了一个以最低有效位 (LSB) 为单位的无量纲数组 $E[m]$ 作为测得的最佳拟合积分非线性度 (INL)。实际的静态传输特性建模为\n$$\nv(m) = V_{\\mathrm{LSB}} \\cdot \\big(m + E[m]\\big).\n$$\n考虑一个离散时间周期性激励，它用一个与记录长度相干的、频率为 $f_0$ 的量化数字正弦波来驱动 DAC。设记录每个周期有 $L$ 个样本，并假设在 $L$ 个样本内有 $k$ 个正弦周期。输入码序列 $m[n]$ 是通过量化一个中心化的正弦波形成的，其幅度指定为半量程范围的一部分 $a$（以码为单位）：\n$$\nm_{\\mathrm{mid}} = \\dfrac{2^N - 1}{2}, \\quad A_{\\mathrm{codes}} = a \\cdot \\dfrac{2^N - 1}{2},\n$$\n$$\nm[n] = \\mathrm{clip}\\Big(\\mathrm{round}\\big(m_{\\mathrm{mid}} + A_{\\mathrm{codes}}\\cdot \\sin(2\\pi k n / L)\\big),\\,0,\\,2^N-1\\Big),\n$$\n对于 $n = 0,1,\\dots,L-1$。相应的离散时间 DAC 输出序列是\n$$\nx[n] = V_{\\mathrm{LSB}} \\cdot \\big(m[n] + E[m[n]]\\big).\n$$\n为了近似连续时间零阶保持 (ZOH) 的输出，使用离散时间卷积，首先通过补零将 $x[n]$ 上采样一个整数因子 $U$ 以获得 $x_{\\uparrow}[n]$，然后与一个长度为 $U$ 且系数为单位一的矩形核 $h[n]$ 进行卷积：\n$$\nx_{\\uparrow}[n] = \\begin{cases}\nx[n/U],  & \\text{if } n \\text{ is a multiple of } U,\\\\\n0,  & \\text{otherwise},\n\\end{cases}\n\\quad\nh[n] = \\begin{cases}\n1,  & 0 \\le n \\le U-1,\\\\\n0,  & \\text{otherwise}.\n\\end{cases}\n$$\n使用循环卷积以保持周期性：\n$$\ny[n] = (x_{\\uparrow} \\circledast h)[n],\n$$\n周期为 $L_{\\uparrow} = L\\cdot U$，生成一个长度为 $L_{\\uparrow}$ 的序列 $y[n]$。从 $y[n]$ 中移除均值，并计算一个周期内的离散傅里叶变换 (DFT)。设基波频率仓索引为 $k_0 = k$，第 $i$ 次谐波的频率仓索引为 $i\\cdot k_0$。对于 $i \\in \\{1,2,3,4,5\\}$，通过 DFT 幅度估计第 $i$ 次谐波的线性幅度 $A_i$（作为 $V_{\\mathrm{FS}}$ 的分数）：\n$$\nA_i = \\dfrac{2}{L_{\\uparrow}} \\cdot \\left|Y[i\\cdot k_0]\\right|.\n$$\n您的任务是实现此过程，并返回几组参数下的前五个谐波幅度。所有幅度都表示为 $V_{\\mathrm{FS}}$ 的无量纲线性分数（无单位，非百分比）。\n\n使用以下测试套件。对于每种情况，使用指定的分辨率 $N$、记录长度 $L$、每个记录的周期数 $k$、幅度分数 $a$、上采样因子 $U$ 以及为所有整数码 $m \\in \\{0,1,\\dots,2^N-1\\}$ 定义的最佳拟合 INL $E[m]$：\n\n- 测试用例 A：\n  - $N = 6$, $L = 1024$, $k = 13$, $a = 0.49$, $U = 8$。\n  - $E[m]$ 由以下公式给出\n    $$\n    E_A[m] = 0.35\\cdot \\sin\\!\\Big(\\dfrac{2\\pi m}{64}\\Big) + 0.08\\cdot \\sin\\!\\Big(\\dfrac{2\\pi \\cdot 7 \\, m}{64}\\Big) - 0.02,\n    $$\n    对于 $m = 0,1,\\dots,63$。\n\n- 测试用例 B：\n  - $N = 6$, $L = 1024$, $k = 17$, $a = 0.4375$, $U = 8$。\n  - $E[m]$ 由以下公式给出\n    $$\n    E_B[m] = 0.30\\cdot \\cos\\!\\Big(\\dfrac{2\\pi m}{64}\\Big) + 0.12\\cdot \\sin\\!\\Big(\\dfrac{2\\pi \\cdot 3 \\, m}{64}\\Big) - 0.06\\cdot \\sin\\!\\Big(\\dfrac{2\\pi \\cdot 2 \\, m}{64}\\Big),\n    $$\n    对于 $m = 0,1,\\dots,63$。\n\n- 测试用例 C：\n  - $N = 6$, $L = 1024$, $k = 31$, $a = 0.25$, $U = 8$。\n  - $E[m]$ 由以下公式给出\n    $$\n    E_C[m] = 0,\n    $$\n    对于 $m = 0,1,\\dots,63$。\n\n您的程序应使用上述过程计算每个测试用例的 $[A_1,A_2,A_3,A_4,A_5]$。最终输出必须是单行，包含一个由三个列表组成的列表，每个内部列表包含五个谐波幅度（按 $i=1$ 到 $i=5$ 的顺序），格式为用方括号括起来的逗号分隔列表，例如：\n$$\n\\big[\\,[A^{(A)}_1,A^{(A)}_2,A^{(A)}_3,A^{(A)}_4,A^{(A)}_5],\\,[A^{(B)}_1,A^{(B)}_2,A^{(B)}_3,A^{(B)}_4,A^{(B)}_5],\\,[A^{(C)}_1,A^{(C)}_2,A^{(C)}_3,A^{(C)}_4,A^{(C)}_5]\\,\\big].\n$$",
            "solution": "任务是预测在存在测得的最佳拟合积分非线性度 (INL) 的情况下，数模转换器 (DAC) 输出在受到量化正弦码序列激励时的谐波幅度。解决方案必须从分辨率、最低有效位大小、静态传输以及离散时间傅里叶变换与正弦幅度之间关系的基本定义开始。\n\n1. 基本量。对于一个单极性 $N$ 位 DAC，码范围是 $m \\in \\{0,1,\\dots,2^N-1\\}$。当 $V_{\\mathrm{FS}} = 1$ 时，理想的最低有效位大小为\n$$\nV_{\\mathrm{LSB}} = \\dfrac{V_{\\mathrm{FS}}}{2^N - 1}.\n$$\n以 LSB 为单位给出的最佳拟合积分非线性度 $E[m]$ 会扰动理想传输，使得当施加码 $m$ 时的实际静态输出为\n$$\nv(m) = V_{\\mathrm{LSB}}\\cdot\\big(m + E[m]\\big).\n$$\n\n2. 相干正弦波的输入码序列。一个在 $L$ 个样本内完成 $k$ 个周期的离散时间正弦波，在样本索引 $n$ 处的参数为 $2\\pi k n/L$。为了将码序列中心化在中间刻度附近并避免削波，使用\n$$\nm_{\\mathrm{mid}} = \\dfrac{2^N - 1}{2}, \\quad A_{\\mathrm{codes}} = a \\cdot \\dfrac{2^N - 1}{2},\n$$\n其中 $a$ 是所需幅度，表示为半量程的一部分。量化前的理想实值码为 $m_{\\mathrm{mid}} + A_{\\mathrm{codes}}\\sin(2\\pi k n/L)$。应用的码序列通过四舍五入到最近的整数并削波到有效范围来获得：\n$$\nm[n] = \\mathrm{clip}\\Big(\\mathrm{round}\\big(m_{\\mathrm{mid}} + A_{\\mathrm{codes}}\\sin(2\\pi k n / L)\\big),\\,0,\\,2^N-1\\Big).\n$$\n这种选择确保了相干采样，即在 $L$ 个样本内有整数个周期 $k$，从而使离散谱线精确地落在 DFT 频率仓上。\n\n3. 静态 DAC 输出序列。包含 INL 的实际离散时间输出序列是\n$$\nx[n] = V_{\\mathrm{LSB}} \\cdot \\big(m[n] + E[m[n]]\\big).\n$$\n该表达式直接源于将静态传输特性应用于时变码 $m[n]$。\n\n4. 通过离散时间卷积实现的零阶保持 (ZOH)。通过保持电路的连续时间重建可以在离散时间中通过上采样并与矩形核卷积来近似。首先，通过在样本之间插入 $U-1$ 个零（补零）来进行上采样，定义\n$$\nx_{\\uparrow}[n] = \\begin{cases}\nx[n/U],  & n \\equiv 0 \\ (\\mathrm{mod}\\ U),\\\\\n0,  & \\text{otherwise}.\n\\end{cases}\n$$\n然后与长度为 $U$ 的矩形核卷积\n$$\nh[n] = \\begin{cases}\n1,  & 0 \\le n \\le U-1,\\\\\n0,  & \\text{otherwise}.\n\\end{cases}\n$$\n与 $h[n]$ 的线性卷积会创建一系列长度为 $U$ 个样本的恒定平台，每个平台的值等于原始样本值，这是零阶保持的离散时间模拟。为了保持周期性并避免频谱泄漏，使用周期为 $L_{\\uparrow} = L\\cdot U$ 的循环卷积。实现循环卷积的一种实用方法是计算长度为 $L_{\\uparrow} + U - 1$ 的完整线性卷积 $x_{\\uparrow} * h$，然后通过加法将尾部的 $U - 1$ 个样本折叠回开头：\n$$\ny[n] = \\big((x_{\\uparrow} * h)[n]\\big) + \\big((x_{\\uparrow} * h)[n + L_{\\uparrow}]\\big), \\quad 0 \\le n \\le L_{\\uparrow}-1,\n$$\n因为 $(x_{\\uparrow} * h)[n]$ 在范围 $0 \\le n \\le L_{\\uparrow} + U - 2$ 之外为零。\n\n5. 通过离散傅里叶变换估计谐波幅度。移除均值（直流分量）以分离交流分量：\n$$\n\\tilde{y}[n] = y[n] - \\dfrac{1}{L_{\\uparrow}} \\sum_{n=0}^{L_{\\uparrow}-1} y[n].\n$$\n计算 $\\tilde{y}[n]$ 的离散傅里叶变换 (DFT)，以获得频率仓 $\\ell = 0,1,\\dots,L_{\\uparrow}-1$ 对应的 $Y[\\ell]$。因为激励在上采样前在 $L$ 个样本中完成 $k$ 个周期，所以在上采样 $U$ 倍后，它也在 $L_{\\uparrow}$ 个样本中完成 $k$ 个周期，因此基波频率仓索引为 $k_0 = k$。第 $i$ 次谐波出现在频率仓索引 $i\\cdot k_0$ 处，其中 $i \\in \\{1,2,3,4,5\\}$。对于相干正弦波，以线性单位表示的单音幅度与 DFT 幅度相关，关系式为\n$$\nA_i = \\dfrac{2}{L_{\\uparrow}} \\cdot \\left| Y[i\\cdot k_0] \\right|.\n$$\n这源于一个标准属性：对于一个实数正弦波 $s[n] = A \\sin(2\\pi k_0 n/L_{\\uparrow})$，在没有加窗的情况下，其 DFT 满足 $\\left|S[k_0]\\right| = \\dfrac{A L_{\\uparrow}}{2}$。由于 $x[n]$ 以 $V_{\\mathrm{FS}}$ 为单位表示，且 $V_{\\mathrm{FS}} = 1$，因此幅度 $A_i$ 已经是无量纲的满量程分数。\n\n6. 算法步骤。\n- 对于每个测试用例，根据给定的公式为码范围内的所有 $m$ 构建 $E[m]$。\n- 对于 $n = 0,1,\\dots,L-1$，使用四舍五入和削波中心化正弦波的方法生成 $m[n]$。\n- 使用 $V_{\\mathrm{LSB}} = 1/(2^N - 1)$ 和 INL 查找表 $E[m[n]]$ 计算 $x[n]$。\n- 通过对 $x[n]$ 进行因子为 $U$ 的补零操作创建 $x_{\\uparrow}[n]$，然后与 $h[n]$ 卷积并折叠尾部以实现循环卷积，从而执行离散时间 ZOH，得到长度为 $L_{\\uparrow} = L\\cdot U$ 的 $y[n]$。\n- 减去 $y[n]$ 的均值，计算 DFT（可以使用实值快速傅里叶变换），并在频率仓 $i\\cdot k_0$ 处提取 $A_i$（对于 $i=1,\\dots,5$），使用 $A_i = \\dfrac{2}{L_{\\uparrow}} \\cdot \\left| Y[i\\cdot k_0] \\right|$。\n- 为每个测试用例返回列表 $[A_1,A_2,A_3,A_4,A_5]$。\n\n7. 边界和覆盖范围的考量。使用整数 $k$ 和 $L$ 的相干采样避免了频谱泄漏，从而可以精确地拾取频率仓。当 $E[m] = 0$ 时，该情况隔离了量化引起的失真和 ZOH 效应。非零的 $E[m]$ 引入了额外的静态非线性，通常会产生偶次和奇次谐波。使用 $U > 1$ 通过矩形卷积模拟了 ZOH 的带宽限制，从而对谐波幅度进行整形。\n\n最终程序精确地遵循这些步骤，并打印单行输出，其中包含一个由三个列表组成的列表，每个内部列表包含五个浮点数幅度，每个测试用例一个内部列表，并按要求的顺序和单位排列。",
            "answer": "[[0.489110,0.000100,0.000213,0.000102,0.000129],[0.435884,0.001640,0.001389,0.000236,0.000089],[0.249826,0.000092,0.000175,0.000086,0.000121]]"
        }
    ]
}