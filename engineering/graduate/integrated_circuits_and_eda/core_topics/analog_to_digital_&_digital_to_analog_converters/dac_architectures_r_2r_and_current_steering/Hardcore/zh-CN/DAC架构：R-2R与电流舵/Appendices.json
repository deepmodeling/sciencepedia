{
    "hands_on_practices": [
        {
            "introduction": "数模转换器（DAC）的性能关键取决于其参考电压的稳定性。此练习将探讨两种主流DAC架构——电流舵和R-2R梯形网络——如何给参考电压缓冲器带来截然不同的负载特性。通过分析每种架构的输入特性，我们可以理解在系统稳定性和设计复杂性方面的关键权衡。",
            "id": "4262635",
            "problem": "考虑共享一个公共精密参考缓冲节点的两种数模转换器 (DAC) 架构：(i) 一种分段式电流舵前端和 (ii) 一种理想的R-2R电阻梯形网络。在电流舵前端中，最高有效位段是一个由 $256$ 个相同的单位电流源组成的 $8$ 位温度计编码阵列，每个电流源在开关接通时从参考节点汲取 $I_{u} = 100~\\mu\\text{A}$ 的电流。设随机变量 $M \\in \\{0,1,2,\\dots,255\\}$ 表示接通的单位电流源数量。其编码统计特性使得概率质量函数与占用率的指数成正比：\n$$\np(M=m) = \\kappa \\exp(-\\alpha m), \\quad m=0,1,\\dots,255,\n$$\n其中 $\\alpha = \\ln(2)/64$，归一化常数 $\\kappa$ 确保 $\\sum_{m=0}^{255} p(M=m) = 1$。在不同转换周期之间，接通的电流源数量是独立的，并且单位电流源被假定为理想的，具有无穷大的小信号输出阻抗。利用离散期望和线性电路负载的基本原理，计算该温度计编码段从参考节点汲取的期望输入电流。\n\n另外，分析在相同参考缓冲器下的理想R-2R电阻梯形网络，其中该梯形网络由一个参考电压驱动。从线性电阻网络不变性和戴维南-诺顿等效出发，论证为什么对于任何数字编码配置，参考缓冲器看到的输入电阻都是恒定的且等于 $R$。利用参考缓冲器输出级（输出电阻为 $R_{s}$，对地总有效输出电容为 $C_{\\text{out}}$）的小信号线性化，解释这种恒定负载如何通过产生一个与编码无关的主极点来简化稳定性评估。无需进行数值稳定性分析。\n\n以 $\\text{mA}$ 为单位表示第一部分的期望输入电流。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效。它在科学上基于数模转换器设计和线性电路理论的原理，定义明确，有足够的信息得出唯一解，并以客观、正式的语言表述。\n\n该问题由两个不同部分组成。第一部分要求计算电流舵 DAC 段的期望值。第二部分要求对 R-2R 梯形网络 DAC 进行概念性分析。\n\n**第一部分：温度计编码段的期望电流**\n\n温度计编码段从参考节点汲取的总电流 $I_{\\text{in}}$ 是接通的单位电流源数量 $M$ 与单个单位电流源的电流 $I_u$ 的乘积。\n$$\nI_{\\text{in}} = M \\cdot I_u\n$$\n我们需要计算期望输入电流 $E[I_{\\text{in}}]$。根据期望的线性性质，且由于 $I_u$ 是一个常数，这等于：\n$$\nE[I_{\\text{in}}] = E[M \\cdot I_u] = I_u \\cdot E[M]\n$$\n主要任务是计算离散随机变量 $M$ 的期望值 $E[M]$，它可以取整数值 $m \\in \\{0, 1, 2, \\dots, 255\\}$。其概率质量函数 (PMF) 给出为 $p(M=m) = \\kappa \\exp(-\\alpha m)$。这是一个截断几何分布。\n\n设 $N = 256$ 为 $m$ 的可能状态数（从 $0$ 到 $255$）。PMF 可以写成：\n$$\np(M=m) = \\kappa \\left( \\exp(-\\alpha) \\right)^m, \\quad m = 0, 1, \\dots, N-1\n$$\n设 $r = \\exp(-\\alpha)$。PMF 为 $p(M=m) = \\kappa r^m$。归一化常数 $\\kappa$ 由所有概率之和为 $1$ 的条件确定：\n$$\n\\sum_{m=0}^{N-1} p(M=m) = \\sum_{m=0}^{N-1} \\kappa r^m = \\kappa \\sum_{m=0}^{N-1} r^m = 1\n$$\n这个和是一个有限几何级数：$\\sum_{m=0}^{N-1} r^m = \\frac{1-r^N}{1-r}$。\n因此，$\\kappa = \\frac{1-r}{1-r^N}$。\n\n$M$ 的期望值由下式给出：\n$$\nE[M] = \\sum_{m=0}^{N-1} m \\cdot p(M=m) = \\kappa \\sum_{m=0}^{N-1} m r^m\n$$\n和 $\\sum_{m=0}^{N-1} m r^m$ 可以使用等差-等比级数的标准恒等式求得。一个方便的推导方法是使用微积分：\n$$\n\\sum_{m=0}^{N-1} m r^m = r \\frac{d}{dr} \\left( \\sum_{m=0}^{N-1} r^m \\right) = r \\frac{d}{dr} \\left( \\frac{1-r^N}{1-r} \\right)\n$$\n使用商法则求导：\n$$\n\\frac{d}{dr} \\left( \\frac{1-r^N}{1-r} \\right) = \\frac{(-Nr^{N-1})(1-r) - (1-r^N)(-1)}{(1-r)^2} = \\frac{-Nr^{N-1} + Nr^N + 1 - r^N}{(1-r)^2}\n$$\n所以，和是：\n$$\n\\sum_{m=0}^{N-1} m r^m = r \\left( \\frac{1 - Nr^{N-1} + (N-1)r^N}{(1-r)^2} \\right)\n$$\n将此式和 $\\kappa$ 的表达式代入 $E[M]$ 的公式中：\n$$\nE[M] = \\left(\\frac{1-r}{1-r^N}\\right) \\left( \\frac{r(1 - Nr^{N-1} + (N-1)r^N)}{(1-r)^2} \\right) = \\frac{r(1 - Nr^{N-1} + (N-1)r^N)}{(1-r)(1-r^N)}\n$$\n这个表达式可以被简化。考虑恒等式 $r(1 - Nr^{N-1} + (N-1)r^N) = r(1-r^N) - Nr^N(1-r)$。\n这导致截断几何分布期望的一个更简洁的形式：\n$$\nE[M] = \\frac{r(1-r^N) - Nr^N(1-r)}{(1-r)(1-r^N)} = \\frac{r}{1-r} - \\frac{Nr^N}{1-r^N}\n$$\n第一项 $\\frac{r}{1-r}$ 是相应的非截断几何分布的期望，第二项是对在 $N-1$ 处截断的修正。\n\n现在，我们代入给定的值：\n$I_u = 100~\\mu\\text{A} = 10^{-4}~\\text{A}$\n$N = 256$\n$\\alpha = \\frac{\\ln(2)}{64}$\n$r = \\exp(-\\alpha) = \\exp\\left(-\\frac{\\ln(2)}{64}\\right) = \\left(\\exp(\\ln(2))\\right)^{-1/64} = 2^{-1/64}$\n\n我们还需要 $r^N$：\n$r^N = (2^{-1/64})^{256} = 2^{-256/64} = 2^{-4} = \\frac{1}{16}$\n\n现在我们计算 $E[M]$：\n$$\nE[M] = \\frac{2^{-1/64}}{1-2^{-1/64}} - \\frac{256 \\cdot (1/16)}{1-(1/16)} = \\frac{1}{2^{1/64}-1} - \\frac{16}{15/16} = \\frac{1}{2^{1/64}-1} - \\frac{256}{15}\n$$\n使用计算器计算数值：\n$2^{1/64} \\approx 1.01088911$\n$\\frac{1}{2^{1/64}-1} \\approx \\frac{1}{0.01088911} \\approx 91.83499$\n$\\frac{256}{15} \\approx 17.06667$\n$E[M] \\approx 91.83499 - 17.06667 = 74.76832$\n\n最后，期望输入电流是：\n$$\nE[I_{\\text{in}}] = I_u \\cdot E[M] = (10^{-4}~\\text{A}) \\cdot (74.76832) \\approx 7.476832 \\times 10^{-3}~\\text{A}\n$$\n这个结果是 $7.476832~\\text{mA}$。问题要求四舍五入到四位有效数字，得到 $7.477~\\text{mA}$。\n\n**第二部分：理想 R-2R 梯形网络的分析**\n\n问题要求基于线性电阻网络原理，论证为什么理想 R-2R 梯形网络的输入电阻是恒定的，以及这如何简化驱动缓冲器的稳定性分析。\n\n首先，考虑一个标准 R-2R 梯形网络的输入电阻。其典型拓扑结构是由值为 $R$ 的水平电阻和值为 $2R$ 的垂直分流电阻组成的链。在远端（LSB 端），梯形网络以一个值为 $2R$ 的电阻端接到地。数字输入编码通过每个垂直 $2R$ 电阻底部的开关施加，将其连接到两个理想电压源之一（例如，地和虚拟地），这两个源都具有零内阻。\n\n该网络的一个关键特性是，沿着梯形网络主干线向 LSB 端看去的任何节点的电阻总是 $2R$。这可以通过从 LSB 开始的归纳法证明。\n1.  在 LSB 节点（我们称之为节点 $0$），朝向端接端的电阻就是端接电阻的值，即 $2R$。\n2.  现在，考虑上一个节点，节点 $1$。从节点 $1$ 朝向 LSB 端（向“右”）看去的电阻是水平电阻 $R$ 与节点 $0$ 处网络的并联组合的串联。在节点 $0$ 处，我们有其垂直的 $2R$ 支路与其右侧的电阻（即端接的 $2R$）并联。所以节点 $0$ 处的电阻是 $2R || 2R = R$。\n3.  因此，从节点 $1$ 向右看去的总电阻是 $R + (2R || 2R) = R + R = 2R$。\n4.  通过归纳法，这个特性对任何节点 $i$ 都成立：从节点 $i$ 朝向 LSB 端看去的电阻是 $2R$。\n\n这种结构特性不随数字编码变化，是线性网络理论（特别是替代定理或戴维南定理）的直接结果。在计算网络的等效电阻时，所有独立电压源都被关闭（替换为短路）。R-2R 梯形网络中的开关将每个支路连接到一个理想电压源。由于两个开关位置都连接到一个零阻抗节点（地或虚拟地），因此向下看任何垂直 $2R$ 支路的电阻总是 $2R$，无论数字编码如何。\n\n参考电压 $V_{\\text{ref}}$ 在其 MSB 端驱动梯形网络。假设 $V_{\\text{ref}}$ 直接连接到 MSB 节点（节点 $N-1$）。参考缓冲器看到的输入电阻 $R_{\\text{in}}$ 是看入该节点的电阻。该电阻是 MSB 自身的垂直 $2R$ 支路与其右侧梯形网络其余部分电阻的并联组合。根据我们的归纳论证，梯形网络其余部分的电阻是 $2R$。\n因此，输入电阻是：\n$$\nR_{\\text{in}} = 2R \\parallel 2R = \\frac{(2R)(2R)}{2R+2R} = \\frac{4R^2}{4R} = R\n$$\n这表明理想 R-2R 梯形网络的输入电阻是恒定的且等于 $R$，与数字编码无关。\n\n这种与编码无关的负载对驱动 DAC 的参考缓冲器的稳定性有显著的积极影响。缓冲器被建模为具有输出电阻 $R_s$，并驱动一个总负载电容 $C_{\\text{out}}$（包括寄生电容和缓冲器自身的输出电容）与 DAC 的输入电阻 $R_{\\text{in}}$ 并联。\n该输出级的传递函数有一个极点，其位置由输出节点处的总电阻和电容决定。电容 $C_{\\text{out}}$ 看到的等效电阻是 $R_s \\parallel R_{\\text{in}}$。极点的角频率 $\\omega_p$ 是：\n$$\n\\omega_p = \\frac{1}{(R_s \\parallel R_{\\text{in}})C_{\\text{out}}}\n$$\n对于 R-2R 梯形网络，由于 $R_{\\text{in}} = R$（恒定），极点位置是固定的：\n$$\n\\omega_p = \\frac{1}{(R_s \\parallel R)C_{\\text{out}}}\n$$\n这个极点是缓冲器反馈回路的主极点。一个与编码无关的主极点意味着缓冲器的相位裕度和整体稳定性不会随着 DAC 数字输入编码的变化而改变。缓冲器的设计和补偿被大大简化，因为它只需要针对一个特定的、已知的负载阻抗（$R$）进行稳定设计。相比之下，具有与编码相关的输入阻抗/电容的 DAC 架构呈现一个随输入编码变化的负载，导致环路动态特性和稳定性裕度发生变化，可能对某些编码导致不稳定或性能下降。",
            "answer": "$$\\boxed{7.477}$$"
        },
        {
            "introduction": "在理解了DAC的输入端特性后，我们将目光转向输出端。DAC快速准确地生成模拟信号的能力，受到其输出级动态行为的限制。本练习将演示如何将对速度（带宽）和精度（建立时间）的顶层系统要求，转化为对最大输出信号频率的具体约束，这是高速转换器设计中的一个基本权衡。",
            "id": "4262631",
            "problem": "一个分段式电流舵数模转换器（DAC）驱动一个外部负载。在感兴趣的信号频带内，该负载可被建模为一个等效小信号输出电阻 $R_o$ 和一个并联电容 $C_L$，形成一个一阶线性时不变网络。同样的小信号模型也捕捉了R-2R梯形 DAC 输出端的主极点行为（当从其输出节点的戴维南等效电路来看时）。该 DAC 用于合成频率为 $f_{\\mathrm{out}}$ 的正弦波，通过以均匀速率 $f_u = M f_{\\mathrm{out}}$ 采用非归零切换方式更新其输出码，其中 $M$ 是每个正弦波周期内的码更新次数。\n\n给定条件如下：\n- 分辨率 $N = 12$ 位。\n- 等效输出电阻 $R_o = 50$ 欧姆。\n- 输出负载电容 $C_L = 5$ pF。\n- 每个周期的采样数 $M = 8$。\n- 线性度要求：对于任何不超过满量程阶跃的码转换，在下一次更新前的残余建立误差必须严格小于二分之一个最低有效位。\n- 带内平坦度要求：在 $f_{\\mathrm{out}}$ 处的幅度响应不得小于其直流幅度的 $(1 - \\delta)$ 倍，其中 $\\delta = 0.01$。\n\n从一阶线性时不变系统的阶跃响应和频率响应的基本性质出发，并结合 $N$ 位转换器的最低有效位的定义，请分别推导由建立要求和带内平坦度要求所隐含的关于 $f_{\\mathrm{out}}$ 的两个独立上限的闭式表达式。然后，根据给定的数值，确定同时满足这两个边界条件的单一最大 $f_{\\mathrm{out}}$。将最终的最大频率以 MHz 表示，并将答案四舍五入到三位有效数字。",
            "solution": "该问题要求确定一个数模转换器（DAC）的最大输出信号频率 $f_{\\mathrm{out}}$，该转换器受两个独立约束条件的限制：一个时域建立要求和一个频域平坦度要求。DAC 的输出级被建模为一个具有输出电阻 $R_o$ 和负载电容 $C_L$ 的一阶线性时不变（LTI）系统。\n\n首先，我们定义这个一阶系统的时间常数 $\\tau$，它决定了系统的瞬态响应和频率响应：\n$$\n\\tau = R_o C_L\n$$\n该系统的传递函数 $H(s)$ 为：\n$$\nH(s) = \\frac{1}{1 + s\\tau}\n$$\n\n### 1. 建立要求\n建立要求规定了在输入数字码改变后 DAC 输出的行为。DAC 以速率 $f_u$ 更新其输出，因此可用于建立的时间是更新周期 $T_u = 1/f_u$。题目说明 $f_u = M f_{\\mathrm{out}}$，所以建立时间为 $t_{\\mathrm{settle}} = T_u = \\frac{1}{M f_{\\mathrm{out}}}$。\n\n一阶系统对幅度为 $\\Delta V$ 的阶跃输入（从初始电压 $V_i$ 到最终电压 $V_f = V_i + \\Delta V$）的响应由下式给出：\n$$\nV(t) = V_f - (V_f - V_i) \\exp\\left(-\\frac{t}{\\tau}\\right) = V_f - \\Delta V \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n在时间 $t$ 的建立误差是瞬时电压与最终电压之差：\n$$\nE(t) = |V(t) - V_f| = |\\Delta V| \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n题目要求，对于任何不超过满量程阶跃的码转换，在更新周期结束时（$t_{\\mathrm{settle}} = T_u$），残余建立误差必须小于二分之一个最低有效位（$LSB$）。\n\n对于一个具有满量程电压范围 $V_{FS}$ 的 $N$ 位 DAC，LSB 电压定义为：\n$$\nV_{LSB} = \\frac{V_{FS}}{2^N}\n$$\n建立误差条件为：\n$$\nE(T_u)  \\frac{1}{2} V_{LSB} = \\frac{1}{2} \\frac{V_{FS}}{2^N} = \\frac{V_{FS}}{2^{N+1}}\n$$\n为确保此条件在最坏情况下成立，我们必须考虑可能的最大电压阶跃，即满量程阶跃 $\\Delta V = V_{FS}$。将 $\\Delta V = V_{FS}$ 和 $t = T_u$ 代入误差方程：\n$$\nV_{FS} \\exp\\left(-\\frac{T_u}{\\tau}\\right)  \\frac{V_{FS}}{2^{N+1}}\n$$\n项 $V_{FS}$ 被消掉了，这很幸运，因为它的值没有给出：\n$$\n\\exp\\left(-\\frac{T_u}{\\tau}\\right)  \\frac{1}{2^{N+1}}\n$$\n对两边取自然对数：\n$$\n-\\frac{T_u}{\\tau}  \\ln\\left(\\frac{1}{2^{N+1}}\\right) = -(N+1)\\ln(2)\n$$\n两边乘以 $-1$ 使不等号反向：\n$$\n\\frac{T_u}{\\tau} > (N+1)\\ln(2)\n$$\n现在，我们代入 $T_u = \\frac{1}{M f_{\\mathrm{out}}}$ 来求 $f_{\\mathrm{out}}$ 的边界：\n$$\n\\frac{1}{M f_{\\mathrm{out}} \\tau} > (N+1)\\ln(2)\n$$\n求解 $f_{\\mathrm{out}}$ 得到第一个上限，我们将其记为 $f_{\\mathrm{out,settle}}$：\n$$\nf_{\\mathrm{out}}  \\frac{1}{M \\tau (N+1)\\ln(2)} \\quad \\implies \\quad f_{\\mathrm{out,settle}} = \\frac{1}{M R_o C_L (N+1)\\ln(2)}\n$$\n\n### 2. 带内平坦度要求\n平坦度要求涉及系统频率响应的幅度。频率响应为 $H(j\\omega)$，其中 $\\omega = 2\\pi f$。其幅度为：\n$$\n|H(j\\omega)| = \\left|\\frac{1}{1 + j\\omega\\tau}\\right| = \\frac{1}{\\sqrt{1 + (\\omega\\tau)^2}} = \\frac{1}{\\sqrt{1 + (2\\pi f \\tau)^2}}\n$$\n直流增益（在 $f=0$ 时）为 $|H(j0)| = 1$。平坦度要求规定，在信号频率 $f_{\\mathrm{out}}$ 处的幅度响应不得小于直流增益的 $(1 - \\delta)$ 倍：\n$$\n|H(j2\\pi f_{\\mathrm{out}})| \\ge (1-\\delta) |H(j0)| = 1 - \\delta\n$$\n代入幅度响应的表达式：\n$$\n\\frac{1}{\\sqrt{1 + (2\\pi f_{\\mathrm{out}} \\tau)^2}} \\ge 1 - \\delta\n$$\n由于两边都是正数，我们可以对它们取倒数，这会使不等号反向：\n$$\n\\sqrt{1 + (2\\pi f_{\\mathrm{out}} \\tau)^2} \\le \\frac{1}{1 - \\delta}\n$$\n两边平方：\n$$\n1 + (2\\pi f_{\\mathrm{out}} \\tau)^2 \\le \\frac{1}{(1 - \\delta)^2}\n$$\n$$\n(2\\pi f_{\\mathrm{out}} \\tau)^2 \\le \\frac{1}{(1 - \\delta)^2} - 1 = \\frac{1 - (1 - \\delta)^2}{(1 - \\delta)^2} = \\frac{1 - (1 - 2\\delta + \\delta^2)}{(1 - \\delta)^2} = \\frac{2\\delta - \\delta^2}{(1 - \\delta)^2}\n$$\n对两边取平方根（并注意所有项均为正）：\n$$\n2\\pi f_{\\mathrm{out}} \\tau \\le \\frac{\\sqrt{2\\delta - \\delta^2}}{1 - \\delta}\n$$\n求解 $f_{\\mathrm{out}}$ 得到第二个上限，我们将其记为 $f_{\\mathrm{out,flat}}$：\n$$\nf_{\\mathrm{out}} \\le \\frac{1}{2\\pi \\tau} \\frac{\\sqrt{2\\delta - \\delta^2}}{1 - \\delta} \\quad \\implies \\quad f_{\\mathrm{out,flat}} = \\frac{1}{2\\pi R_o C_L} \\frac{\\sqrt{2\\delta - \\delta^2}}{1 - \\delta}\n$$\n\n### 3. 数值计算\n最大频率 $f_{\\mathrm{out,max}}$ 必须同时满足两个约束条件，因此它是两个导出上限中的较小者：\n$$\nf_{\\mathrm{out,max}} = \\min(f_{\\mathrm{out,settle}}, f_{\\mathrm{out,flat}})\n$$\n给定以下数值：\n- $N = 12$\n- $R_o = 50 \\, \\Omega$\n- $C_L = 5 \\, \\text{pF} = 5 \\times 10^{-12} \\, \\text{F}$\n- $M = 8$\n- $\\delta = 0.01$\n\n首先，计算时间常数 $\\tau$：\n$$\n\\tau = R_o C_L = (50) \\times (5 \\times 10^{-12}) = 250 \\times 10^{-12} \\, \\text{s} = 2.5 \\times 10^{-10} \\, \\text{s}\n$$\n接下来，计算 $f_{\\mathrm{out,settle}}$：\n$$\nf_{\\mathrm{out,settle}} = \\frac{1}{8 \\times (2.5 \\times 10^{-10}) \\times (12+1) \\ln(2)} = \\frac{1}{2 \\times 10^{-9} \\times 13 \\ln(2)} = \\frac{1}{2.6 \\times 10^{-8} \\ln(2)}\n$$\n$$\nf_{\\mathrm{out,settle}} \\approx \\frac{1}{(2.6 \\times 10^{-8}) \\times 0.69315} \\approx \\frac{1}{1.80219 \\times 10^{-8}} \\approx 5.5488 \\times 10^7 \\, \\text{Hz} = 55.488 \\, \\text{MHz}\n$$\n现在，计算 $f_{\\mathrm{out,flat}}$：\n$$\nf_{\\mathrm{out,flat}} = \\frac{1}{2\\pi (2.5 \\times 10^{-10})} \\frac{\\sqrt{2(0.01) - (0.01)^2}}{1 - 0.01} = \\frac{1}{5\\pi \\times 10^{-10}} \\frac{\\sqrt{0.02 - 0.0001}}{0.99}\n$$\n$$\nf_{\\mathrm{out,flat}} = \\frac{1}{5\\pi \\times 10^{-10}} \\frac{\\sqrt{0.0199}}{0.99} \\approx \\frac{1}{1.5708 \\times 10^{-9}} \\frac{0.14107}{0.99} \\approx (6.3662 \\times 10^8) \\times (0.14249) \\approx 9.0705 \\times 10^7 \\, \\text{Hz} = 90.705 \\, \\text{MHz}\n$$\n最后，我们求出总的最大频率：\n$$\nf_{\\mathrm{out,max}} = \\min(55.488 \\, \\text{MHz}, 90.705 \\, \\text{MHz}) = 55.488 \\, \\text{MHz}\n$$\n题目要求结果以 MHz 表示，并四舍五入到三位有效数字。\n$$\nf_{\\mathrm{out,max}} \\approx 55.5 \\, \\text{MHz}\n$$\n建立时间要求是更严格的约束条件，它限制了最大输出频率。",
            "answer": "$$\n\\boxed{55.5}\n$$"
        },
        {
            "introduction": "在真实系统中，理想的电压源并不存在，来自电源的噪声会污染最终的模拟输出。本练习旨在解决这一关键问题，通过量化计算参考缓冲器所需的电源抑制比（PSRR），以确保DAC的精度不受影响。这个练习构建了从系统级误差预算到模拟子电路详细规格之间的桥梁。",
            "id": "4262622",
            "problem": "一个分段式电流舵数模转换器 (DAC)，其分辨率为 $N = 14$，使用一个参考缓冲器为其单位电流源生成一个稳定的参考电压 $V_{\\mathrm{ref}} = 1.2\\,\\mathrm{V}$。每个单位电流与 $V_{\\mathrm{ref}}$ 成正比，输出电压通过对被引导的电流求和，在电阻性负载上产生。为参考缓冲器供电的电源表现出有界的正弦波纹波，其峰值幅度为 $\\Delta V_{\\mathrm{DD}} = 10\\,\\mathrm{mV}$，在 $f \\in [10\\,\\mathrm{kHz}, 10\\,\\mathrm{MHz}]$ 的频带内大致与频率无关。忽略所有非理想因素，除了通过参考缓冲器的电源纹波对参考电压的调制。\n\n从最低有效位 (LSB)、满量程码和微扰灵敏度的定义出发，仅使用第一性原理，推导参考缓冲器所需的最小电源抑制比 (PSRR) 的大小（以分贝表示），使得对于任何 DAC 码，在整个感兴趣的频带内，由纹波引起的输出电压误差的峰值幅度严格小于 $0.1\\,\\mathrm{LSB}$。假设最差情况下的码灵敏度，并且参考缓冲器的 PSRR 大小在指定频带内与频率无关。\n\n将最终答案表示为一个以分贝 (dB) 为单位的实数，四舍五入到三位有效数字。不要在最终的方框答案中包含单位。",
            "solution": "目标是将在所有码和指定频带内，由纹波引起的输出误差限制在最低有效位 (LSB) 的一小部分以下。我们通过将参考电压的微扰与 DAC 输出电压联系起来，然后将其转化为对参考缓冲器的电源抑制比 (PSRR) 的要求。\n\n首先，根据满量程输出来定义 LSB。对于一个具有 $N$ 位分辨率的电流舵数模转换器 (DAC)，满量程码对应的总输出电流 $I_{\\mathrm{FS}}$ 等于所有单位电流之和。如果负载是纯电阻性的，电阻为 $R_{L}$，那么满量程输出电压是\n$$\nV_{\\mathrm{FS}} = I_{\\mathrm{FS}} R_{L}.\n$$\n对于一个理想的 $N$ 位 DAC，有 $2^{N}$ 个码，从 $0$ 到 $2^{N}-1$，理想的电压步长是\n$$\nV_{\\mathrm{LSB}} = \\frac{V_{\\mathrm{FS}}}{2^{N} - 1}.\n$$\n\n在电流舵架构中，每个单位电流 $I_{u}$ 与参考电压 $V_{\\mathrm{ref}}$ 成正比。将此比例关系表示为\n$$\nI_{u} = \\alpha V_{\\mathrm{ref}},\n$$\n其中 $\\alpha$ 是由内部参考-电流转换设定的常数。对于一个码 $k \\in \\{0,1,\\dots,2^{N}-1\\}$，输出电流是\n$$\nI_{\\mathrm{out}}(k) = k\\,I_{u} = k\\,\\alpha V_{\\mathrm{ref}}.\n$$\n相应的在 $R_{L}$ 上的输出电压是\n$$\nV_{\\mathrm{out}}(k) = I_{\\mathrm{out}}(k) R_{L} = k\\,\\alpha V_{\\mathrm{ref}} R_{L}.\n$$\n\n考虑由于电源纹波通过参考缓冲器而在参考输出端产生的一个微扰 $\\delta V_{\\mathrm{ref}}$。$I_{u}$ 的微扰相对变化等于 $V_{\\mathrm{ref}}$ 的相对变化，因此在码 $k$ 时 $V_{\\mathrm{out}}$ 的微扰变化是\n$$\n\\delta V_{\\mathrm{out}}(k) = \\frac{\\partial V_{\\mathrm{out}}}{\\partial V_{\\mathrm{ref}}} \\,\\delta V_{\\mathrm{ref}} = k\\,\\alpha R_{L}\\,\\delta V_{\\mathrm{ref}}.\n$$\n我们可以通过注意以下关系将其与标称输出联系起来\n$$\nV_{\\mathrm{out}}(k) = k\\,\\alpha V_{\\mathrm{ref}} R_{L} \\quad \\Rightarrow \\quad \\delta V_{\\mathrm{out}}(k) = V_{\\mathrm{out}}(k)\\,\\frac{\\delta V_{\\mathrm{ref}}}{V_{\\mathrm{ref}}}.\n$$\n最差情况下的灵敏度发生在最大码 $k = 2^{N}-1$ 时，此时 $V_{\\mathrm{out}}$ 是 $V_{\\mathrm{FS}}$。因此，最差情况下由纹波引起的输出误差幅度是\n$$\n|\\delta V_{\\mathrm{out,pk}}| = V_{\\mathrm{FS}} \\left|\\frac{\\delta V_{\\mathrm{ref}}}{V_{\\mathrm{ref}}}\\right|.\n$$\n为了将此误差限制在 $0.1\\,\\mathrm{LSB}$ 以下，我们要求\n$$\nV_{\\mathrm{FS}} \\left|\\frac{\\delta V_{\\mathrm{ref}}}{V_{\\mathrm{ref}}}\\right|  0.1\\,V_{\\mathrm{LSB}} = 0.1\\,\\frac{V_{\\mathrm{FS}}}{2^{N} - 1}.\n$$\n消去两边的 $V_{\\mathrm{FS}}$，得到允许的参考电压相对纹波的基本限制：\n$$\n\\left|\\frac{\\delta V_{\\mathrm{ref}}}{V_{\\mathrm{ref}}}\\right|  \\frac{0.1}{2^{N} - 1}.\n$$\n\n接下来，通过电源抑制比 (PSRR) 将参考电压的扰动与电源纹波联系起来。将从电源纹波到参考输出纹波的幅度传递函数定义为\n$$\n|H_{\\mathrm{ps}}(f)| \\equiv \\left|\\frac{\\delta V_{\\mathrm{ref}}(f)}{\\delta V_{\\mathrm{DD}}(f)}\\right|.\n$$\n以分贝表示的电源抑制比 (PSRR) 大小为\n$$\n\\mathrm{PSRR}_{\\mathrm{dB}}(f) = 20 \\log_{10}\\!\\left(\\frac{1}{|H_{\\mathrm{ps}}(f)|}\\right) = -20 \\log_{10}\\!\\left(|H_{\\mathrm{ps}}(f)|\\right).\n$$\n对 $|H_{\\mathrm{ps}}(f)|$ 的要求源于允许的参考电压相对纹波：\n$$\n|H_{\\mathrm{ps}}(f)|\\,\\frac{|\\delta V_{\\mathrm{DD}}(f)|}{V_{\\mathrm{ref}}}  \\frac{0.1}{2^{N} - 1} \\quad \\Rightarrow \\quad |H_{\\mathrm{ps}}(f)|  \\frac{0.1\\,V_{\\mathrm{ref}}}{(2^{N} - 1)\\,|\\delta V_{\\mathrm{DD}}(f)|}.\n$$\n等效地，所需的最小 PSRR 大小（以分贝表示）是\n$$\n\\mathrm{PSRR}_{\\mathrm{req,dB}}(f) = 20 \\log_{10}\\!\\left(\\frac{(2^{N} - 1)\\,|\\delta V_{\\mathrm{DD}}(f)|}{0.1\\,V_{\\mathrm{ref}}}\\right).\n$$\n在问题中，纹波峰值幅度在 $f \\in [10\\,\\mathrm{kHz}, 10\\,\\mathrm{MHz}]$ 的频率范围内是恒定的，即 $|\\delta V_{\\mathrm{DD}}(f)| = \\Delta V_{\\mathrm{DD}} = 10\\,\\mathrm{mV} = 0.01\\,\\mathrm{V}$。因此，所需的 PSRR 在整个频带内与频率无关，其数值计算结果为\n$$\n\\mathrm{PSRR}_{\\mathrm{req,dB}} = 20 \\log_{10}\\!\\left(\\frac{(2^{14} - 1)\\times 0.01}{0.1 \\times 1.2}\\right) = 20 \\log_{10}\\!\\left(\\frac{16383 \\times 0.01}{0.12}\\right).\n$$\n计算对数内的比率：\n$$\n\\frac{16383 \\times 0.01}{0.12} = \\frac{163.83}{0.12} \\approx 1365.25.\n$$\n因此\n$$\n\\mathrm{PSRR}_{\\mathrm{req,dB}} \\approx 20 \\log_{10}\\!\\left(1365.25\\right).\n$$\n使用 $\\log_{10}\\!\\left(1365.25\\right) \\approx 3.1351$ 可得\n$$\n\\mathrm{PSRR}_{\\mathrm{req,dB}} \\approx 20 \\times 3.1351 \\approx 62.702.\n$$\n四舍五入到三位有效数字，所需的最小 PSRR 大小是\n$$\n62.7\\,\\mathrm{dB}.\n$$\n因为纹波幅度的界限在指定的频带内是恒定的，并且推导过程没有引入任何额外的频率依赖性，所以这个单一值对所有 $f \\in [10\\,\\mathrm{kHz}, 10\\,\\mathrm{MHz}]$ 都统一适用。",
            "answer": "$$\\boxed{62.7}$$"
        }
    ]
}