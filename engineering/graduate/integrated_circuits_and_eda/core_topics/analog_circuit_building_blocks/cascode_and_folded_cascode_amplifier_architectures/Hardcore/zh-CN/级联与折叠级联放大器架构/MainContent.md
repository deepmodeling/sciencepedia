## 引言
[高增益放大器](@entry_id:274020)是现代模拟与混合信号集成电路的基石，从精密传感器接口到高速数据转换器，其性能直接决定了整个系统的精度与速度。然而，随着CMOS工艺技术不断向深亚微米节点演进，晶体管的沟道长度日益缩短，虽然带来了[数字电路](@entry_id:268512)性能的飞跃，却给模拟设计带来了严峻的挑战。其中最突出的问题便是“增益危机”——单个晶体管的[固有增益](@entry_id:262690)因[短沟道效应](@entry_id:1131595)而急剧下降，使得传统放大器架构难以满足高性能应用的需求。

本文旨在系统性地解决这一知识鸿沟，深入剖析两种为应对此挑战而生的经典而强大的电路架构：共源共栅（cascode）和折叠式共源共栅（folded-cascode）放大器。通过学习本文，您将全面掌握这些高级电路的设计精髓。

- **第一章：原理与机制** 将从最基本的晶体管物理出发，揭示[固有增益](@entry_id:262690)的限制来源，并详细阐述共源共栅架构如何通过阻抗倍增和抑制米勒效应来同时提升增益和带宽。
- **第二章：应用与跨学科连接** 将理论付诸实践，探讨这些架构在真实世界设计中所面临的复杂权衡，涵盖增益、速度、功耗、噪声、线性度以及与EDA和版图的关联。
- **第三章：动手实践** 提供了一系列精选的实践问题，引导您将理论知识应用于具体的[电路分析](@entry_id:261116)与设计挑战中，巩固并深化理解。

现在，让我们首先进入第一章，从根本上理解是什么驱动了共源共栅架构的诞生，以及其精巧的工作机制是如何克服现代[CMOS技术](@entry_id:265278)的内在限制的。

## 原理与机制

在深入探讨共源共栅（cascode）和折叠式共源共栅（folded-cascode）放大器架构的复杂性之前，我们必须首先理解驱动这些高级电路发展的根本动机。现代[CMOS](@entry_id:178661)（互补金属氧化物半导体）技术的不断进步，在带来更高集成度和更快开关速度的同时，也给模拟电路设计，尤其是[高增益放大器](@entry_id:274020)的实现，带来了严峻的挑战。本章将从基本原理出发，系统地阐述共源共栅架构如何应对这些挑战，并剖析其工作机制、性能优势及设计权衡。

### 现代[CMOS技术](@entry_id:265278)中的[固有增益](@entry_id:262690)限制

任何放大器设计的核心目标之一都是实现足够高的[电压增益](@entry_id:266814)。对于单个MOSFET晶体管构成的最简单的共源（common-source, CS）放大器，其所能实现的最大[电压增益](@entry_id:266814)被称为**[固有增益](@entry_id:262690)**（intrinsic gain），记为 $A_0$。这个增益由晶体管的两个关键小信号参数决定：[跨导](@entry_id:274251) $g_m$ 和[输出电阻](@entry_id:276800) $r_o$。

$$
A_0 = -g_m r_o
$$

[跨导](@entry_id:274251) $g_m$ 表征了栅源电压 $V_{GS}$ 对漏极电流 $I_D$ 的控制能力，而输出电阻 $r_o$ 则反映了在饱和区工作时，漏源电压 $V_{DS}$ 变化对漏极电流的影响程度。理想情况下，饱和区晶体管的电流应与 $V_{DS}$ 无关，此时 $r_o$ 为无穷大，[固有增益](@entry_id:262690)也为无穷大。然而，在实际器件中，多种物理效应使得 $r_o$ 成为一个有限值。

为了更深入地理解[固有增益](@entry_id:262690)的限制，我们可以引入一个更具物理洞察力的框架。通过定义**[跨导效率](@entry_id:269674)**（transconductance efficiency）$\eta = g_m / I_D$ 和**[沟道长度调制](@entry_id:264103)系数** $\lambda = (\partial I_D / \partial V_{DS}) / I_D \approx 1/r_o I_D$，我们可以将[固有增益](@entry_id:262690)表示为这两个参数的比值 ：

$$
|A_0| = g_m r_o \approx g_m \left( \frac{1}{\lambda I_D} \right) = \frac{g_m/I_D}{\lambda} = \frac{\eta}{\lambda}
$$

这个表达式揭示了提升[固有增益](@entry_id:262690)的两条路径：提高[跨导效率](@entry_id:269674) $\eta$ 或减小沟道长度调制系数 $\lambda$。然而，随着[CMOS](@entry_id:178661)工艺向深亚微米节点演进，这两条路径都受到了严重制约。

首先，随着晶体管的沟道长度 $L$ 不断缩短，一系列**[短沟道效应](@entry_id:1131595)**（short-channel effects）变得日益显著。其中，**[漏致势垒降低](@entry_id:1123969)**（Drain-Induced Barrier Lowering, DIBL）效应尤为关键。DIBL效应意味着漏源电压 $V_{DS}$ 的增加会显著降低晶体管的阈值电压，从而导致漏极电流 $I_D$ 对 $V_{DS}$ 的敏感度急剧增加。这直接表现为输出电导 $g_{ds} = 1/r_o$ 的增大，即[输出电阻](@entry_id:276800) $r_o$ 的严重恶化。在我们的模型中，这意味着 $\lambda$ 随着沟道长度的缩短而显著增大 。

其次，[跨导效率](@entry_id:269674) $\eta$ 也面临瓶颈。在长沟道器件中，通过将晶体管偏置在弱反型区，可以实现很高的 $\eta$ 值（接近其理论极限 $q/(nkT)$）。但在短沟道器件中，由于载流子速度饱和效应，跨导 $g_m$ 随过驱动电压 $V_{OV}$ 的增加而趋于饱和，这使得 $\eta$ 的可调范围和最大值都受到限制 。

综上所述，现代短沟道[CMOS技术](@entry_id:265278)中，单个晶体管的[固有增益](@entry_id:262690) $A_0$ 因为 $\lambda$ 的增大和 $\eta$ 的受限而大幅降低。这构成了模拟设计中的“增益危机”，迫使设计师寻求超越简单[共源放大器](@entry_id:265648)的、更为精巧的电路架构来重新获得足够高的[电压增益](@entry_id:266814)。[共源共栅结构](@entry_id:273974)正是应对这一挑战的经典而有效的解决方案。

### 共源共栅原理：通过阻抗倍增提升增益

共源共栅（cascode）放大器通过在一个共源（CS）放大管（例如，$M_1$）的漏极上堆叠一个共栅（common-gate, CG）放大管（例如，$M_2$），巧妙地提升了放大器的整体性能。其核心思想并非改变输入管 $M_1$ 的固有属性（$g_{m1}, r_{o1}$），而是极大地提升了放大器级的总输出阻抗。

#### 输出电阻增强机制

[共源共栅结构](@entry_id:273974)增强输出电阻的机制可以被直观地理解为一种“[屏蔽效应](@entry_id:136974)”。共栅管 $M_2$ 的栅极偏置在固定的直流电压，对于小信号而言是接地的。其源极连接到 $M_1$ 的漏极。由于 $M_2$ 的源极是其输入端，而共栅管的[输入阻抗](@entry_id:271561)非常低（约为 $1/g_{m2}$），因此 $M_1$ 的漏极电压（即 $M_2$ 的源极电压 $v_x$）被 $M_2$ 有效地“钳位”在一个相对稳定的水平。当输出节点 $v_o$（即 $M_2$ 的漏极）发生电压波动时，这种波动大部分被 $M_2$ 的漏源两端承受，只有极小一部分会传递到 $v_x$ 上。

我们可以定量地分析这种屏蔽效应。考虑输出电压 $v_o$ 的变化对中间节点 $v_x$ 的影响，可以推导出两者之间的电压关系  ：

$$
\frac{\partial v_{s2}}{\partial v_o} = \frac{v_x}{v_o} \approx \frac{1}{1 + g_{m2}r_{o2}}
$$

其中 $g_{m2}r_{o2}$ 是共栅管 $M_2$ 的[固有增益](@entry_id:262690)，通常远大于1。这意味着输出节点的大幅电压摆动，在中间节点 $v_x$ 上被衰减了约 $g_{m2}r_{o2}$ 倍。例如，在一个典型设计中，若 $g_{m2}=8\,\text{mS}$，$r_{o2}=120\,\text{k}\Omega$，则 $g_{m2}r_{o2} = 960$。当输出端有 $1\,\text{V}$ 的信号摆幅时，中间节点 $v_x$ 的残余摆幅仅为约 $1/(1+960) \approx 1\,\text{mV}$ 。

由于 $M_1$ 的漏极电压 $v_{ds1} = v_x$ 几乎保持恒定，它感受不到远端输出节点 $v_o$ 的电压变化。因此，$M_1$ 的行为非常接近一个理想的、由 $v_{gs1}$ 控制的电流源。从输出节点 $v_o$ 看进去，流出的电流几乎不随 $v_o$ 变化，这意味着极高的输出阻抗。

通过严格的[小信号分析](@entry_id:263462)，可以推导出[共源共栅结构](@entry_id:273974)的总[输出电阻](@entry_id:276800) $R_{out}$ 为：

$$
R_{out} = r_{o1} + r_{o3} + (g_{m3} + g_{mb3}(1-\alpha))r_{o1}r_{o3} \approx g_{m2}r_{o1}r_{o2}
$$
(这里为了与问题  对应，我们暂时使用 $M_3$ 作为共栅管，并考虑了体效应，后续会详细讨论)。在忽略体效应的简化情况下（$g_{mb3}=0$），[输出电阻](@entry_id:276800)约为 $R_{out} \approx g_{m2}r_{o1}r_{o2}$ 。这个结果可以这样理解：从 $M_1$ 漏极看进去的电阻 $r_{o1}$，被共栅管 $M_2$ 的[固有增益](@entry_id:262690) $g_{m2}r_{o2}$ 所“倍增”。对于一个完整的差分望远镜式（telescopic）[共源共栅放大器](@entry_id:273163)，其总输出电阻是NMOS下拉共源共栅堆栈和PMOS上拉共源共栅堆栈的[输出电阻](@entry_id:276800)的并联 。

#### [增益提升](@entry_id:275440)的量化分析

放大器的总[电压增益](@entry_id:266814)为 $A_v = -g_{m1} R_{out}$。由于[共源共栅结构](@entry_id:273974)将输出电阻从 $r_{o1}$ 提升到了数量级大得多的 $g_{m2}r_{o1}r_{o2}$，其[电压增益](@entry_id:266814)也得到了相应的巨大提升。

为了精确地量化这种提升，我们可以直接比较一个[共源放大器](@entry_id:265648)和一个[共源共栅放大器](@entry_id:273163)在驱动相同负载 $R_L$ 时的增益。通过严谨的推导，可以得到增益增强因子 $E$ ：

$$
E \equiv \frac{|A_{v,\mathrm{cascode}}|}{|A_{v,\mathrm{CS}}|} = \frac{(g_m r_o + 1)(r_o + R_L)}{g_m r_o^2 + 2r_o + R_L}
$$

在 $g_m r_o \gg 1$ 的常见情况下，这个因子近似等于 $g_m r_o$（即共栅管的[固有增益](@entry_id:262690)），这与我们之前的直观理解相符。

回到 $\eta/\lambda$ 的框架，如果共源级的增益是 $|A_0|_{CS} \approx \eta_1/\lambda_1$，那么共源共栅级的增益则近似为两级[固有增益](@entry_id:262690)的乘积 ：

$$
|A_v|_{Cascode} \approx (g_{m1} r_{o1}) \times (g_{m2} r_{o2}) \approx \left(\frac{\eta_1}{\lambda_1}\right) \left(\frac{\eta_2}{\lambda_2}\right)
$$

如果两个晶体管相同，则增益近似为单级[固有增益](@entry_id:262690)的平方，即 $|A_v| \approx (\eta/\lambda)^2$。这清晰地表明，[共源共栅结构](@entry_id:273974)将增益从一个线性关系提升到了一个平方关系，从而有效地克服了单管[固有增益](@entry_id:262690)不足的问题。

### 高频性能：克服米勒效应

除了提升[直流增益](@entry_id:267449)，[共源共栅结构](@entry_id:273974)在高频应用中还扮演着另一个至关重要的角色：抑制**米勒效应**（Miller effect）。

在标准的[共源放大器](@entry_id:265648)中，输入晶体管的栅极和漏极之间存在一个[寄生电容](@entry_id:270891) $C_{gd}$。由于放大器的增益作用，漏极电压 $v_d$ 的变化幅度和相位与输入栅极电压 $v_{in}$ 相反且幅度更大，即 $v_d = A_v v_{in}$，其中 $A_v$ 是一个大的负数。这导致跨接在输入和输出之间的电容 $C_{gd}$ 在输入端等效为一个大得多的电容，即**米勒电容** ：

$$
C_{\mathrm{in}} = C_{gs} + C_{gd}(1 - A_v) = C_{gs} + C_{gd}(1 + |A_v|)
$$

这个被放大了的输入电容会与信号源[内阻](@entry_id:268117) $R_S$ 形成一个低频极点 $p_{in} = -1/(R_S C_{in})$，从而严重限制放大器的带宽。

[共源共栅结构](@entry_id:273974)通过其“[屏蔽效应](@entry_id:136974)”完美地解决了这个问题。对于输入管 $M_1$ 而言，其漏极电压 $v_x$ 被共栅管 $M_2$ 钳位，不再随最终的输出电压 $v_o$ 大幅摆动。因此，作用于 $M_1$ 的栅漏电容 $C_{gd1}$ 的增益 $A_v$ 不再是整个放大器的高增益，而只是 $M_1$ 本身的局部低增益。这个局部增益约为 $A_{v,local} \approx -g_{m1} R_{in,M2} \approx -g_{m1} (1/g_{m2})$，其幅值通常接近于1。因此，米勒效应被极大地抑制了。

在[共源共栅结构](@entry_id:273974)中，输入电容近似为 ：

$$
C_{\mathrm{in}, \mathrm{CAS}} \approx C_{gs1} + C_{gd1}(1 - A_{v,local}) \approx C_{gs1} + 2 C_{gd1}
$$

与[共源放大器](@entry_id:265648)的 $C_{\mathrm{in}, \mathrm{CS}} = C_{gs1} + C_{gd1}(1+|A|)$ 相比，[输入电容](@entry_id:272919)显著减小。这使得输入极点被推向更高的频率，从而大幅提升了放大器的带宽。带宽的改善因子 $F$ 可以量化为两种拓扑输入电容的比值：

$$
F = \frac{f_{p, \mathrm{CAS}}}{f_{p, \mathrm{CS}}} = \frac{C_{\mathrm{in}, \mathrm{CS}}}{C_{\mathrm{in}, \mathrm{CAS}}} = \frac{C_{gs1} + C_{gd1} (1 + A)}{C_{gs1} + C_{gd1}}
$$

其中 $A$ 是[共源放大器](@entry_id:265648)的增益幅值。由于 $A$ 通常远大于1，因此 $F$ 值也非常大，这体现了[共源共栅结构](@entry_id:273974)在高频应用中的巨大优势。

### [共源共栅放大器](@entry_id:273163)的设计与优化

#### 偏置以获得最大增益

实现[共源共栅结构](@entry_id:273974)带来的巨大增益潜力，需要对电路进行恰当的偏置。一个关键的设计决策是共栅（cascode）晶体管（$M_2$）的偏置。为了最大化输出电阻 $R_{out} \approx g_{m2}r_{o1}r_{o2}$，在给定偏置电流 $I_D$ 的情况下，我们需要最大化 $g_{m2}$。对于工作在强反型区的MOSFET，其[跨导](@entry_id:274251) $g_m$ 与过驱动电压 $V_{OV} = V_{GS} - V_{TH}$ 的关系为 $g_m = 2I_D / V_{OV}$。因此，为了在固定电流下最大化 $g_{m2}$，必须**最小化**共栅管的过驱动电压 $V_{ov2}$。

然而，这个最小化过程受到一个硬性约束：$M_2$ 必须始终保持在饱和区工作，即 $V_{DS2} \ge V_{ov2}$。因此，最优的设计策略是将 $V_{ov2}$ 设置为在整个[输出电压摆幅](@entry_id:263071)内能保证 $M_2$ 维持饱和的最小可[能值](@entry_id:187992) 。

#### 尺寸选择策略与权衡

晶体管的尺寸（宽度 $W$ 和长度 $L$）是另一个关键的设计自由度。不同的设计目标和约束会导致不同的尺寸选择策略 。

*   **固定过驱动电压 ($V_{OV}$) 约束**：在电压裕度（headroom）受限的设计中（例如堆叠层数较多的望远镜式共源共栅），常需要固定晶体管的 $V_{OV}$。此时，$g_m \propto I_D$，而[固有增益](@entry_id:262690) $A_0 = 2E_AL/V_{OV} \propto L$。这意味着，在这种约束下，增加电流（通过增大 $W$）可以提高带宽（因为 $g_m$ 增加），但并不能提升单管的[固有增益](@entry_id:262690)。要提升[固有增益](@entry_id:262690)，唯一的方法是增加沟道长度 $L$。

*   **固定总电流 ($I_D$) 约束**：在功耗受限的设计中，总电流 $I_D$ 是固定的。此时，$g_m \propto \sqrt{W}$，而 $r_o$ 不变。因此，[固有增益](@entry_id:262690) $A_0 \propto \sqrt{W}$。这意味着增加晶体管宽度 $W$ 可以以其平方根的比例提高[固有增益](@entry_id:262690)。当然，这会带来更大的器件电容，从而牺牲带宽，这是模拟设计中一个经典的[增益-带宽权衡](@entry_id:263010)。

*   **固定电流密度 ($J=I_D/W$) 约束**：在这种情况下，可以推导出 $A_0 \propto \sqrt{L/J}$，且与 $W$ 无关。这意味着增加 $L$ 依然可以提高增益，而改变 $W$（同时按比例改变 $I_D$）则不会影响单管的[固有增益](@entry_id:262690)。

这些缩放关系为设计师在面对具体约束时如何优化晶体管尺寸提供了理论指导。

#### 折叠式共源共栅架构

传统的望远镜式（telescopic）[共源共栅结构](@entry_id:273974)虽然增益高、速度快，但其一个主要缺点是电压裕度非常有限。输入和输出的共模电压范围都受到[堆叠晶体管](@entry_id:261368)饱和条件的严格限制。在电源电压不断降低的现代工艺中，这个问题尤为突出 。

**折叠式共源共栅**（folded-cascode）架构应运而生，旨在解决这一电压裕度问题。其核心思想是，输入差分对（例如NMOS）的输出电流并不直接驱动同类型的（NMOS）共源共栅级，而是被“折叠”到一个恒流源上，再由这个节点驱动一个相反类型的（PMOS）共源共栅级。

这种“折叠”操作将输入级的[直流偏置](@entry_id:271748)点与输出级的直流偏置点[解耦](@entry_id:160890)，从而极大地放宽了对输入[共模电压](@entry_id:267734)范围的要求。同时，它也能提供比望远镜式结构更大的[输出电压摆幅](@entry_id:263071)。然而，这种灵活性是有代价的。折叠路径上引入的额外[电流镜](@entry_id:264819)会增加噪声和[寄生电容](@entry_id:270891)，通常导致其噪声性能和速度略逊于同等功耗下的望远镜式结构 。

### 高级主题与二阶效应

#### 体效应的影响

在标准的CMOS工艺中，N[MOS晶体管](@entry_id:273779)通常制作在同一个P型衬底上，P[MOS晶体管](@entry_id:273779)则在N阱中。对于共源共栅管（如 $M_2$），其源极（节点 $v_x$）电压会随信号变化，而其体（衬底或N阱）通常连接到固定电位（$V_{SS}$ 或 $V_{DD}$）。这导致 $M_2$ 的源-体电压 $V_{SB}$ 不为零且随信号变化，从而引发**体效应**（body effect）。

体效应表现为一个额外的“背栅”对阈值电压的调制，其小信号等效为一个从漏极到源极的、由 $v_{bs}$ 控制的电流源，其[跨导](@entry_id:274251)为 $g_{mb}$。在计算共源共栅的[输出电阻](@entry_id:276800)时，这个额外的跨导通路会参与阻抗倍增。经过推导，包含体效应的输出电阻表达式为 ：

$$
R_{\text{out}}(\alpha) = r_{o1} + r_{o3} + (g_{m3} + g_{mb3}(1-\alpha))r_{o1}r_{o3}
$$

这里 $\alpha$ 是一个表征体偏置跟踪源极电压程度的因子（若体接固定电位，$\alpha=0$；若体与源相连，$\alpha=1$）。通常情况下，由于体效应的存在（$g_{mb3} > 0$ 且 $\alpha  1$），[输出电阻](@entry_id:276800)会比不考虑体效应时略有增加。然而，由于 $g_{mb}$ 通常远小于 $g_m$（约为 $0.1 g_m$ 到 $0.3 g_m$），这个影响属于二阶效应。体效应可以被忽略的条件是 $g_{mb3}(1-\alpha) \ll g_{m3}$。

#### 利用体偏置进行性能增强

虽然体效应通常被视为一个寄生问题，但在先进的设计中，它可以被主动利用来优化电路性能。一个典型的例子就是通过**动态[体偏置](@entry_id:1121730)**（active body biasing）来扩展放大器的[输入共模范围](@entry_id:273151)（Input Common-Mode Range, ICMR）。

在[折叠式共源共栅放大器](@entry_id:1125193)中，ICMR的下限通常由[尾电流源](@entry_id:262705)保持饱和所需电压决定，而上限则由输入[差分对](@entry_id:266000)保持饱和决定。这两个极限都与输入管的阈值电压 $V_{TH}$ 有关。阈值电压 $V_{TH}$ 又受到其源-体电压 $V_{SB}$ 的影响。

通过一个可编程的[背栅偏置](@entry_id:1121303)发生器，我们可以主动控制输入管的 $V_{SB}$。为了获得最低的输入共模电压 $V_{CM,min}$，我们可以施加一个允许范围内的最大正向偏置（例如，$V_{SB} = -0.1\,\text{V}$），这会降低 $V_{TH}$，从而降低对输入管栅极电压的要求。反之，为了达到最高的 $V_{CM,max}$，我们可以施加一个最大反向偏置（例如，$V_{SB} = +0.4\,\text{V}$），这会升高 $V_{TH}$，从而允许输入管的源极电压在更高共模输入下仍能保持饱和 。

通过这种方式，原本作为一个二阶寄生效应的体效应，被巧妙地转化为一个有用的设计“旋钮”，用于在低电源电压下最大化放大器的动态范围。这充分体现了现代[模拟集成电路设计](@entry_id:277019)中，深入理解并驾驭[器件物理](@entry_id:180436)以实现卓越系统性能的精髓。