{
    "hands_on_practices": [
        {
            "introduction": "The performance of a sample-and-hold circuit is fundamentally limited by how quickly and accurately it can acquire the input signal during the track phase. This exercise explores the crucial trade-off between speed and precision by modeling the acquisition process as a first-order $RC$ network . By deriving the settling time requirement from an $N$-bit accuracy specification, you will gain hands-on experience in translating high-level system needs into concrete circuit-level design constraints.",
            "id": "4295134",
            "problem": "A track-and-hold stage of a switched-capacitor front-end in an integrated converter is implemented with a metal-oxide-semiconductor (MOS) transmission gate that charges a sampling capacitor from an input driver having finite source resistance. During the clock high interval, the transmission gate is on and the sampling node tracks the input; during the clock low interval, the transmission gate is off and the sampling capacitor holds the acquired voltage.\n\nAssume the input source and on-resistance of the transmission gate can be lumped into a single effective resistance $R_{\\text{eq}}$, and the sampling capacitor together with any parasitics can be lumped into a single effective capacitance $C_{\\text{eq}}$, so that the tracking dynamics are well-approximated by a first-order resistor-capacitor ($RC$) network with time constant $\\tau = R_{\\text{eq}} C_{\\text{eq}}$. The input undergoes a worst-case full-scale step of amplitude $V_{\\text{FS}}$ at the beginning of the clock high interval $t = 0$, and the sampling node starts from $0$ volts at $t = 0$.\n\nFor an analog-to-digital converter (ADC) of resolution $N = 14$ bits, the acquisition accuracy requirement is that at the end of the available clock high tracking time $T_{\\text{track}} = 3.2 \\,\\text{ns}$, the magnitude of the difference between the sampling capacitor voltage and its final value (which would be reached as $t \\to \\infty$) must be no greater than one-half of one least significant bit ($\\tfrac{1}{2}$ LSB) for a full-scale step. Take one least significant bit to be $V_{\\text{FS}} / 2^{N}$.\n\nUsing only fundamental circuit laws and the differential equation governing a first-order $RC$ network, derive from first principles the constraint on the time constant $\\tau$ required to satisfy the acquisition accuracy at $t = T_{\\text{track}}$, and compute the maximum allowable $\\tau$ for the given $T_{\\text{track}}$ and $N$. Neglect switch charge injection, clock feedthrough, aperture jitter, and any bandwidth limitations beyond the single-pole first-order model.\n\nRound your final numerical answer to four significant figures. Express your final answer in nanoseconds.",
            "solution": "The problem requires the derivation of a constraint on the time constant $\\tau$ of a first-order resistor-capacitor ($RC$) network used as a track-and-hold circuit, and the calculation of the maximum allowable value for this time constant. The derivation must start from first principles.\n\nFirst, we formulate the differential equation governing the voltage across the capacitor, $V_C(t)$. The circuit is modeled as an input voltage source, $V_{\\text{in}}(t)$, connected in series with an effective resistance, $R_{\\text{eq}}$, and an effective capacitance, $C_{\\text{eq}}$. The voltage across the capacitor is $V_C(t)$. According to Kirchhoff's Voltage Law (KVL), the sum of voltages around the loop is zero, which means the source voltage equals the sum of voltage drops across the resistor and capacitor:\n$$V_{\\text{in}}(t) = V_R(t) + V_C(t)$$\nwhere $V_R(t)$ is the voltage across the resistor. The current $i(t)$ flowing through the series circuit is given by the capacitor's constitutive relation, $i(t) = C_{\\text{eq}} \\frac{dV_C(t)}{dt}$. The voltage across the resistor is given by Ohm's law, $V_R(t) = i(t) R_{\\text{eq}}$. Substituting these relations into the KVL equation yields:\n$$V_{\\text{in}}(t) = \\left(C_{\\text{eq}} \\frac{dV_C(t)}{dt}\\right) R_{\\text{eq}} + V_C(t)$$\nBy defining the circuit's time constant as $\\tau = R_{\\text{eq}} C_{\\text{eq}}$, we obtain the first-order linear ordinary differential equation:\n$$\\tau \\frac{dV_C(t)}{dt} + V_C(t) = V_{\\text{in}}(t)$$\nThe problem specifies a worst-case scenario where the input undergoes a full-scale step of amplitude $V_{\\text{FS}}$ at $t=0$, so $V_{\\text{in}}(t) = V_{\\text{FS}}$ for $t \\ge 0$. The initial condition is that the sampling capacitor starts from $0$ volts, so $V_C(0) = 0$. The general solution for the capacitor voltage is the sum of the steady-state (particular) response and the transient (homogeneous) response. For a constant input $V_{\\text{FS}}$, the steady-state voltage is $V_C(\\infty) = V_{\\text{FS}}$. The transient response is of the form $A\\exp(-t/\\tau)$. The complete solution is:\n$$V_C(t) = V_C(\\infty) + \\left(V_C(0) - V_C(\\infty)\\right)\\exp(-t/\\tau)$$\nSubstituting the known values $V_C(0) = 0$ and $V_C(\\infty) = V_{\\text{FS}}$, we get:\n$$V_C(t) = V_{\\text{FS}} + (0 - V_{\\text{FS}})\\exp(-t/\\tau) = V_{\\text{FS}}(1 - \\exp(-t/\\tau))$$\nThis equation describes the voltage on the sampling capacitor as it charges towards the input voltage $V_{\\text{FS}}$.\n\nNext, we must formalize the acquisition accuracy requirement. The requirement states that at the end of the tracking time, $t = T_{\\text{track}}$, the magnitude of the difference between the capacitor voltage $V_C(T_{\\text{track}})$ and its final value $V_C(\\infty)$ must not exceed one-half of one least significant bit ($\\frac{1}{2}$ LSB). The error voltage, $\\varepsilon(t)$, is defined as:\n$$\\varepsilon(t) = |V_C(\\infty) - V_C(t)| = |V_{\\text{FS}} - V_{\\text{FS}}(1 - \\exp(-t/\\tau))| = |V_{\\text{FS}}\\exp(-t/\\tau)|$$\nSince $V_{\\text{FS}}$ is a positive amplitude and the exponential term is always positive, we can remove the absolute value signs:\n$$\\varepsilon(t) = V_{\\text{FS}}\\exp(-t/\\tau)$$\nFor an analog-to-digital converter (ADC) of resolution $N$ bits and a full-scale range of $V_{\\text{FS}}$, one LSB is defined as $V_{\\text{LSB}} = \\frac{V_{\\text{FS}}}{2^N}$. The accuracy requirement at $t = T_{\\text{track}}$ is therefore:\n$$\\varepsilon(T_{\\text{track}}) \\le \\frac{1}{2} V_{\\text{LSB}}$$\nSubstituting the expressions for the error and the LSB:\n$$V_{\\text{FS}}\\exp(-T_{\\text{track}}/\\tau) \\le \\frac{1}{2} \\left(\\frac{V_{\\text{FS}}}{2^N}\\right) = \\frac{V_{\\text{FS}}}{2^{N+1}}$$\nThe term $V_{\\text{FS}}$ is a non-zero positive constant and can be canceled from both sides, illustrating that the required settling accuracy is a relative measure, independent of the actual full-scale voltage:\n$$\\exp(-T_{\\text{track}}/\\tau) \\le \\frac{1}{2^{N+1}}$$\nTo derive the constraint on $\\tau$, we take the natural logarithm of both sides. Since the natural logarithm is a monotonically increasing function, the inequality direction is preserved:\n$$\\ln(\\exp(-T_{\\text{track}}/\\tau)) \\le \\ln\\left(\\frac{1}{2^{N+1}}\\right)$$\n$$-\\frac{T_{\\text{track}}}{\\tau} \\le \\ln(2^{-(N+1)})$$\n$$-\\frac{T_{\\text{track}}}{\\tau} \\le -(N+1)\\ln(2)$$\nMultiplying the inequality by $-1$ reverses its direction:\n$$\\frac{T_{\\text{track}}}{\\tau} \\ge (N+1)\\ln(2)$$\nThis is the formal constraint on the time constant $\\tau$. To ensure the accuracy requirement is met, $\\tau$ must be small enough such that at least $(N+1)\\ln(2)$ time constants elapse within the tracking time $T_{\\text{track}}$.\n\nThe maximum allowable time constant, $\\tau_{\\text{max}}$, corresponds to the case where the inequality becomes an equality:\n$$\\frac{T_{\\text{track}}}{\\tau_{\\text{max}}} = (N+1)\\ln(2)$$\nSolving for $\\tau_{\\text{max}}$ gives the final symbolic expression:\n$$\\tau_{\\text{max}} = \\frac{T_{\\text{track}}}{(N+1)\\ln(2)}$$\nNow, we substitute the given numerical values: $N = 14$ and $T_{\\text{track}} = 3.2 \\,\\text{ns}$.\n$$\\tau_{\\text{max}} = \\frac{3.2 \\,\\text{ns}}{(14+1)\\ln(2)} = \\frac{3.2}{15\\ln(2)} \\,\\text{ns}$$\nWe compute the numerical value:\n$$\\tau_{\\text{max}} \\approx \\frac{3.2}{15 \\times 0.693147} \\,\\text{ns} \\approx \\frac{3.2}{10.3972} \\,\\text{ns} \\approx 0.307776 \\,\\text{ns}$$\nRounding the result to four significant figures as required:\n$$\\tau_{\\text{max}} \\approx 0.3078 \\,\\text{ns}$$",
            "answer": "$$\\boxed{0.3078}$$"
        },
        {
            "introduction": "After a signal is accurately sampled, the challenge shifts to preserving that voltage during the hold phase. In practice, leakage currents from various sources cause the held voltage to \"droop,\" introducing error. This problem focuses on quantifying this droop by modeling leakage from both resistive paths and active device bias currents, a common scenario in integrated circuit design . Solving it will provide insight into how to select the hold capacitance $C_H$ to satisfy a given droop specification over a required hold time.",
            "id": "4295092",
            "problem": "A precision sample-and-hold (S/H) stage for a switched-capacitor data converter is implemented with an ideal buffer Operational Amplifier (op-amp) driving a hold capacitor $C_H$ through a sampling switch. During the hold interval, the switch is open and the hold node is subject to two parasitic paths that remove charge: a direct current (DC) leakage path to ground modeled as a linear resistor $R_{\\mathrm{leak}}$ and the op-amp input bias current $I_b$ flowing out of the hold node into the op-amp input. Neglect thermal $kT/C$ noise, finite op-amp output resistance, and any dynamic effects; assume the op-amp behaves ideally as a high input impedance buffer except for its stated input bias current.\n\nAt the start of hold, the hold voltage is $V_H(0) = 2.5\\,\\mathrm{V}$. The DC leakage path is characterized by $R_{\\mathrm{leak}} = 150\\,\\mathrm{M}\\Omega$ at the operating temperature, and the op-amp input bias current in hold is a constant $I_b = 35\\,\\mathrm{nA}$ directed out of the hold node (i.e., it removes charge from the capacitor). The maximum allowable magnitude of voltage droop over the hold interval is $\\Delta V_{\\max} = 0.5\\,\\mathrm{mV}$, and the required hold time is $T_H = 20\\,\\mu\\mathrm{s}$. You may assume the droop is sufficiently small that the leakage current through $R_{\\mathrm{leak}}$ can be treated as constant and equal to its value at $t=0$, computed from $V_H(0)$.\n\nUsing only fundamental charge conservation and capacitor relations, derive an expression for the minimum $C_H$ that guarantees the droop does not exceed $\\Delta V_{\\max}$ over $T_H$, accounting for both the DC leakage through $R_{\\mathrm{leak}}$ and the op-amp input bias current. Then evaluate this minimum $C_H$ numerically with the given parameters. Round your final numerical answer to four significant figures and express it in nanofarads (nF).",
            "solution": "The hold capacitor $C_H$ is initially charged to $V_H(0)$, and during the hold interval charge leaves the node via two paths: the DC leakage through $R_{\\mathrm{leak}}$ and the op-amp input bias current $I_b$. The total leakage current can be written as\n$$\nI_{\\mathrm{leak}} = I_R + I_b,\n$$\nwhere $I_R$ is the current through $R_{\\mathrm{leak}}$. Because the droop is specified to be small and we are instructed to treat $I_R$ as constant and equal to its value at $t=0$, we have Ohm's law at $t=0$:\n$$\nI_R = \\frac{V_H(0)}{R_{\\mathrm{leak}}}.\n$$\n\nBy charge conservation, the charge removed from the capacitor during the hold interval equals the time integral of the leakage current. Under the assumption of constant $I_{\\mathrm{leak}}$ over $T_H$, the charge lost is\n$$\n\\Delta Q = I_{\\mathrm{leak}}\\,T_H.\n$$\nFor a capacitor, the relation between charge and voltage is $Q = C_H V$, and the small change in voltage associated with the lost charge is\n$$\n\\Delta V = \\frac{\\Delta Q}{C_H} = \\frac{I_{\\mathrm{leak}}\\,T_H}{C_H}.\n$$\nTo ensure the droop does not exceed the specification, we require $\\Delta V \\leq \\Delta V_{\\max}$, which implies the minimum capacitance satisfies\n$$\nC_H \\geq \\frac{I_{\\mathrm{leak}}\\,T_H}{\\Delta V_{\\max}}.\n$$\nThus, the minimum required capacitance is\n$$\nC_{H,\\min} = \\frac{\\left(\\frac{V_H(0)}{R_{\\mathrm{leak}}} + I_b\\right)\\,T_H}{\\Delta V_{\\max}}.\n$$\n\nWe now evaluate this expression numerically. First compute the leakage through $R_{\\mathrm{leak}}$:\n$$\nI_R = \\frac{V_H(0)}{R_{\\mathrm{leak}}} = \\frac{2.5\\,\\mathrm{V}}{150\\,\\mathrm{M}\\Omega} = \\frac{2.5}{150}\\times 10^{-6}\\,\\mathrm{A} = \\frac{1}{60}\\times 10^{-6}\\,\\mathrm{A} \\approx 1.6666667\\times 10^{-8}\\,\\mathrm{A}.\n$$\nThis is $I_R \\approx 16.6666667\\,\\mathrm{nA}$. The total leakage current is\n$$\nI_{\\mathrm{leak}} = I_R + I_b \\approx 16.6666667\\,\\mathrm{nA} + 35\\,\\mathrm{nA} = 51.6666667\\,\\mathrm{nA} = 5.16666667\\times 10^{-8}\\,\\mathrm{A}.\n$$\nThe hold time and maximum droop are\n$$\nT_H = 20\\,\\mu\\mathrm{s} = 2.0\\times 10^{-5}\\,\\mathrm{s}, \\quad \\Delta V_{\\max} = 0.5\\,\\mathrm{mV} = 5.0\\times 10^{-4}\\,\\mathrm{V}.\n$$\nTherefore,\n$$\nC_{H,\\min} = \\frac{I_{\\mathrm{leak}}\\,T_H}{\\Delta V_{\\max}} = \\frac{\\left(5.16666667\\times 10^{-8}\\,\\mathrm{A}\\right)\\left(2.0\\times 10^{-5}\\,\\mathrm{s}\\right)}{5.0\\times 10^{-4}\\,\\mathrm{V}}.\n$$\nCompute the numerator:\n$$\nI_{\\mathrm{leak}}\\,T_H = 5.16666667\\times 10^{-8}\\times 2.0\\times 10^{-5} = 1.033333334\\times 10^{-12}\\,\\mathrm{C}.\n$$\nDivide by $\\Delta V_{\\max}$:\n$$\nC_{H,\\min} = \\frac{1.033333334\\times 10^{-12}\\,\\mathrm{C}}{5.0\\times 10^{-4}\\,\\mathrm{V}} = 2.066666668\\times 10^{-9}\\,\\mathrm{F}.\n$$\nExpressed in nanofarads,\n$$\nC_{H,\\min} = 2.066666668\\,\\mathrm{nF}.\n$$\nRounded to four significant figures as requested,\n$$\nC_{H,\\min} \\approx 2.067\\,\\mathrm{nF}.\n$$",
            "answer": "$$\\boxed{2.067}$$"
        },
        {
            "introduction": "Modern high-performance analog circuits frequently employ fully differential architectures to enhance noise immunity and suppress even-order distortion. However, their effectiveness depends on careful design and matching. This practice delves into the noise analysis of a differential sample-and-hold stage, teaching you to distinguish between uncorrelated thermal noise and correlated noise from upstream circuitry . By calculating the resulting differential and common-mode noise, you will gain a quantitative understanding of how component matching and noise correlation impact overall system performance.",
            "id": "4295111",
            "problem": "Consider a fully differential Sample-and-Hold (S/H) stage implemented in an integrated circuit intended for Electronic Design Automation (EDA) flows. The two branches sample a differential input onto hold capacitors $C_{1}$ and $C_{2}$ through identical track switches. During the track phase, the switches are on long enough that the sampled thermal noise on each capacitor reaches its equilibrium value. In addition to switch thermal noise, both branches are driven by a differential buffer whose output noise processes during track couple identically into the two branches and are correlated. The following modeling assumptions hold:\n\n- Each switch is ideal except for thermal noise, with the track duration sufficiently long that the sampled mean-square noise voltage stored on a capacitor $C$ equals the equilibrium value established by the switch noise in track. The ambient temperature is $T$, and Boltzmannâ€™s constant is $k_{B}$.\n- The sampled noise on branch $i \\in \\{1,2\\}$ after the hold transition is modeled as the sum $n_{i} = n_{s,i} + n_{a,i}$ of an uncorrelated switch-thermal component $n_{s,i}$ and a buffer-induced component $n_{a,i}$.\n- The switch-thermal components satisfy $\\operatorname{var}(n_{s,1}) = \\frac{k_{B} T}{C_{1}}$, $\\operatorname{var}(n_{s,2}) = \\frac{k_{B} T}{C_{2}}$, and $\\operatorname{cov}(n_{s,1}, n_{s,2}) = 0$.\n- The buffer-induced components satisfy $\\operatorname{var}(n_{a,1}) = \\operatorname{var}(n_{a,2}) = \\sigma_{a}^{2}$ and $\\operatorname{corr}(n_{a,1}, n_{a,2}) = \\rho$, so that $\\operatorname{cov}(n_{a,1}, n_{a,2}) = \\rho \\,\\sigma_{a}^{2}$ with $-1 \\leq \\rho \\leq 1$. All switch-thermal components are independent of all buffer-induced components.\n\nLet the differential and common-mode sampled noise be defined by $v_{\\mathrm{diff}} = n_{1} - n_{2}$ and $v_{\\mathrm{cm}} = \\frac{n_{1} + n_{2}}{2}$, respectively, and let $\\sigma_{\\mathrm{diff}} = \\sqrt{\\operatorname{var}(v_{\\mathrm{diff}})}$ and $\\sigma_{\\mathrm{cm}} = \\sqrt{\\operatorname{var}(v_{\\mathrm{cm}})}$ denote their root-mean-square amplitudes.\n\nYou are to compute closed-form analytic expressions for $\\sigma_{\\mathrm{diff}}$ and $\\sigma_{\\mathrm{cm}}$ under the following two capacitor configurations:\n\n- Matched case: $C_{1} = C_{2} = C_{H}$.\n- Mismatched case: $C_{1} = C_{H} (1 + \\Delta)$ and $C_{2} = C_{H} (1 - \\Delta)$ with $|\\Delta| < 1$.\n\nExpress your final results in volts as functions of $k_{B}$, $T$, $C_{H}$, $\\Delta$, $\\sigma_{a}$, and $\\rho$. Report the four answers in the order $\\sigma_{\\mathrm{diff}}$ (matched), $\\sigma_{\\mathrm{cm}}$ (matched), $\\sigma_{\\mathrm{diff}}$ (mismatched), $\\sigma_{\\mathrm{cm}}$ (mismatched) using a single row matrix. No numerical approximation or rounding is required.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. We proceed with the derivation.\n\nThe objective is to compute the root-mean-square (RMS) amplitudes of the differential noise, $\\sigma_{\\mathrm{diff}} = \\sqrt{\\operatorname{var}(v_{\\mathrm{diff}})}$, and the common-mode noise, $\\sigma_{\\mathrm{cm}} = \\sqrt{\\operatorname{var}(v_{\\mathrm{cm}})}$. The differential and common-mode noise voltages are defined as $v_{\\mathrm{diff}} = n_{1} - n_{2}$ and $v_{\\mathrm{cm}} = \\frac{n_{1} + n_{2}}{2}$, where $n_{1}$ and $n_{2}$ are the total sampled noise voltages on the two branches of the circuit.\n\nFirst, we derive general expressions for the variances $\\operatorname{var}(v_{\\mathrm{diff}})$ and $\\operatorname{var}(v_{\\mathrm{cm}})$ using the properties of the variance operator.\nFor the differential noise variance:\n$$ \\operatorname{var}(v_{\\mathrm{diff}}) = \\operatorname{var}(n_{1} - n_{2}) = \\operatorname{var}(n_{1}) + \\operatorname{var}(n_{2}) - 2 \\operatorname{cov}(n_{1}, n_{2}) $$\nFor the common-mode noise variance:\n$$ \\operatorname{var}(v_{\\mathrm{cm}}) = \\operatorname{var}\\left(\\frac{n_{1} + n_{2}}{2}\\right) = \\frac{1}{4} \\operatorname{var}(n_{1} + n_{2}) = \\frac{1}{4} \\left[ \\operatorname{var}(n_{1}) + \\operatorname{var}(n_{2}) + 2 \\operatorname{cov}(n_{1}, n_{2}) \\right] $$\nTo use these formulas, we must first determine the variances $\\operatorname{var}(n_{1})$, $\\operatorname{var}(n_{2})$, and the covariance $\\operatorname{cov}(n_{1}, n_{2})$.\n\nThe total noise on each branch, $n_{i}$, is the sum of a switch-thermal component, $n_{s,i}$, and a buffer-induced component, $n_{a,i}$.\n$$ n_{i} = n_{s,i} + n_{a,i} \\quad \\text{for } i \\in \\{1, 2\\} $$\nThe problem states that the switch-thermal components are independent of the buffer-induced components. This implies $\\operatorname{cov}(n_{s,i}, n_{a,j}) = 0$ for all $i, j \\in \\{1, 2\\}$.\n\nThe variance of the total noise on each branch is:\n$$ \\operatorname{var}(n_{i}) = \\operatorname{var}(n_{s,i} + n_{a,i}) = \\operatorname{var}(n_{s,i}) + \\operatorname{var}(n_{a,i}) + 2 \\operatorname{cov}(n_{s,i}, n_{a,i})$$\nSince $\\operatorname{cov}(n_{s,i}, n_{a,i}) = 0$, this simplifies to:\n$$ \\operatorname{var}(n_{i}) = \\operatorname{var}(n_{s,i}) + \\operatorname{var}(n_{a,i}) $$\nUsing the given values:\n$$ \\operatorname{var}(n_{1}) = \\operatorname{var}(n_{s,1}) + \\operatorname{var}(n_{a,1}) = \\frac{k_{B} T}{C_{1}} + \\sigma_{a}^{2} $$\n$$ \\operatorname{var}(n_{2}) = \\operatorname{var}(n_{s,2}) + \\operatorname{var}(n_{a,2}) = \\frac{k_{B} T}{C_{2}} + \\sigma_{a}^{2} $$\n\nNext, we find the covariance between the total noise on the two branches:\n$$ \\operatorname{cov}(n_{1}, n_{2}) = \\operatorname{cov}(n_{s,1} + n_{a,1}, n_{s,2} + n_{a,2}) $$\nUsing the bilinearity of covariance and the independence between switch and buffer noise components:\n$$ \\operatorname{cov}(n_{1}, n_{2}) = \\operatorname{cov}(n_{s,1}, n_{s,2}) + \\operatorname{cov}(n_{s,1}, n_{a,2}) + \\operatorname{cov}(n_{a,1}, n_{s,2}) + \\operatorname{cov}(n_{a,1}, n_{a,2}) $$\nThe problem states $\\operatorname{cov}(n_{s,1}, n_{s,2}) = 0$, $\\operatorname{cov}(n_{a,1}, n_{a,2}) = \\rho \\sigma_{a}^{2}$, and the independence of switch and buffer noise implies the cross-term covariances are zero. Thus:\n$$ \\operatorname{cov}(n_{1}, n_{2}) = 0 + 0 + 0 + \\rho \\sigma_{a}^{2} = \\rho \\sigma_{a}^{2} $$\n\nNow we substitute these results back into the expressions for $\\operatorname{var}(v_{\\mathrm{diff}})$ and $\\operatorname{var}(v_{\\mathrm{cm}})$ to obtain general formulas dependent on $C_{1}$ and $C_{2}$.\nFor $\\operatorname{var}(v_{\\mathrm{diff}})$:\n$$ \\operatorname{var}(v_{\\mathrm{diff}}) = \\left(\\frac{k_{B} T}{C_{1}} + \\sigma_{a}^{2}\\right) + \\left(\\frac{k_{B} T}{C_{2}} + \\sigma_{a}^{2}\\right) - 2(\\rho \\sigma_{a}^{2}) $$\n$$ \\operatorname{var}(v_{\\mathrm{diff}}) = k_{B} T \\left(\\frac{1}{C_{1}} + \\frac{1}{C_{2}}\\right) + 2\\sigma_{a}^{2} - 2\\rho\\sigma_{a}^{2} = k_{B} T \\left(\\frac{1}{C_{1}} + \\frac{1}{C_{2}}\\right) + 2\\sigma_{a}^{2}(1-\\rho) $$\nFor $\\operatorname{var}(v_{\\mathrm{cm}})$:\n$$ \\operatorname{var}(v_{\\mathrm{cm}}) = \\frac{1}{4} \\left[ \\left(\\frac{k_{B} T}{C_{1}} + \\sigma_{a}^{2}\\right) + \\left(\\frac{k_{B} T}{C_{2}} + \\sigma_{a}^{2}\\right) + 2(\\rho \\sigma_{a}^{2}) \\right] $$\n$$ \\operatorname{var}(v_{\\mathrm{cm}}) = \\frac{k_{B} T}{4} \\left(\\frac{1}{C_{1}} + \\frac{1}{C_{2}}\\right) + \\frac{1}{4}(2\\sigma_{a}^{2} + 2\\rho\\sigma_{a}^{2}) = \\frac{k_{B} T}{4} \\left(\\frac{1}{C_{1}} + \\frac{1}{C_{2}}\\right) + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho) $$\n\nWe now evaluate these general expressions for the two specified capacitor configurations.\n\n1. Matched case: $C_{1} = C_{2} = C_{H}$\nIn this case, the sum of reciprocal capacitances is $\\frac{1}{C_{1}} + \\frac{1}{C_{2}} = \\frac{1}{C_{H}} + \\frac{1}{C_{H}} = \\frac{2}{C_{H}}$.\nThe differential noise variance is:\n$$ \\operatorname{var}(v_{\\mathrm{diff}}) = k_{B} T \\left(\\frac{2}{C_{H}}\\right) + 2\\sigma_{a}^{2}(1-\\rho) = \\frac{2k_{B} T}{C_{H}} + 2\\sigma_{a}^{2}(1-\\rho) $$\nSo, the RMS differential noise is:\n$$ \\sigma_{\\mathrm{diff}}(\\text{matched}) = \\sqrt{\\frac{2k_{B} T}{C_{H}} + 2\\sigma_{a}^{2}(1-\\rho)} $$\nThe common-mode noise variance is:\n$$ \\operatorname{var}(v_{\\mathrm{cm}}) = \\frac{k_{B} T}{4} \\left(\\frac{2}{C_{H}}\\right) + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho) = \\frac{k_{B} T}{2C_{H}} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho) $$\nSo, the RMS common-mode noise is:\n$$ \\sigma_{\\mathrm{cm}}(\\text{matched}) = \\sqrt{\\frac{k_{B} T}{2C_{H}} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho)} $$\n\n2. Mismatched case: $C_{1} = C_{H}(1+\\Delta)$ and $C_{2} = C_{H}(1-\\Delta)$\nFirst, we compute the sum of reciprocal capacitances:\n$$ \\frac{1}{C_{1}} + \\frac{1}{C_{2}} = \\frac{1}{C_{H}(1+\\Delta)} + \\frac{1}{C_{H}(1-\\Delta)} = \\frac{1}{C_{H}} \\left( \\frac{(1-\\Delta) + (1+\\Delta)}{(1+\\Delta)(1-\\Delta)} \\right) = \\frac{2}{C_{H}(1-\\Delta^{2})} $$\nThe differential noise variance is:\n$$ \\operatorname{var}(v_{\\mathrm{diff}}) = k_{B} T \\left(\\frac{2}{C_{H}(1-\\Delta^{2})}\\right) + 2\\sigma_{a}^{2}(1-\\rho) = \\frac{2k_{B} T}{C_{H}(1-\\Delta^{2})} + 2\\sigma_{a}^{2}(1-\\rho) $$\nSo, the RMS differential noise is:\n$$ \\sigma_{\\mathrm{diff}}(\\text{mismatched}) = \\sqrt{\\frac{2k_{B} T}{C_{H}(1-\\Delta^{2})} + 2\\sigma_{a}^{2}(1-\\rho)} $$\nThe common-mode noise variance is:\n$$ \\operatorname{var}(v_{\\mathrm{cm}}) = \\frac{k_{B} T}{4} \\left(\\frac{2}{C_{H}(1-\\Delta^{2})}\\right) + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho) = \\frac{k_{B} T}{2C_{H}(1-\\Delta^{2})} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho) $$\nSo, the RMS common-mode noise is:\n$$ \\sigma_{\\mathrm{cm}}(\\text{mismatched}) = \\sqrt{\\frac{k_{B} T}{2C_{H}(1-\\Delta^{2})} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho)} $$\n\nWe now assemble these four results in the specified order into a single row matrix.\nFirst: $\\sigma_{\\mathrm{diff}}$ (matched)\nSecond: $\\sigma_{\\mathrm{cm}}$ (matched)\nThird: $\\sigma_{\\mathrm{diff}}$ (mismatched)\nFourth: $\\sigma_{\\mathrm{cm}}$ (mismatched)",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\sqrt{\\frac{2k_{B} T}{C_{H}} + 2\\sigma_{a}^{2}(1-\\rho)} & \\sqrt{\\frac{k_{B} T}{2C_{H}} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho)} & \\sqrt{\\frac{2k_{B} T}{C_{H}(1-\\Delta^{2})} + 2\\sigma_{a}^{2}(1-\\rho)} & \\sqrt{\\frac{k_{B} T}{2C_{H}(1-\\Delta^{2})} + \\frac{\\sigma_{a}^{2}}{2}(1+\\rho)} \\end{pmatrix} } $$"
        }
    ]
}