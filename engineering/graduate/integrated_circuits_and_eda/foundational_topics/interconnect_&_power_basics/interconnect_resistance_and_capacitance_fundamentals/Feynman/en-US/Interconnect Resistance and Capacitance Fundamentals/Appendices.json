{
    "hands_on_practices": [
        {
            "introduction": "While the fundamental formula $R = \\rho L/A$ is the cornerstone of resistance calculation, its application in modern integrated circuits requires careful consideration of fabrication realities. This exercise models a dual-damascene copper interconnect, where a non-conductive barrier liner reduces the effective cross-sectional area of the wire. By calculating the resulting resistance increase, you will gain hands-on experience in accounting for practical geometric effects that are critical for accurate parasitic extraction .",
            "id": "4277454",
            "problem": "A dual-damascene copper interconnect in an integrated circuit designed within the framework of Electronic Design Automation (EDA) is patterned with nominal metal width $W$ and thickness $t$, and incorporates a conformal barrier/liner of thickness $t_{\\mathrm{liner}}$ on the sidewalls and bottom of the trench. Assume the liner material is perfectly blocking for direct current (i.e., it does not conduct), and the copper resistivity remains uniform at the given value $\\rho$. The interconnect segment has length $L$ and is uniform along its length.\n\nStarting only from fundamental constitutive relations for steady conduction in a homogeneous medium and geometric reasoning, determine:\n- the resistance of the interconnect without a liner, and\n- the resistance of the interconnect when the liner is present (reducing the effective copper cross-sectional area on the sidewalls and bottom),\nand then quantify the fractional increase in resistance due to the liner as a single decimal (not with a percent sign).\n\nUse the following parameters:\n- copper resistivity $\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$,\n- nominal width $W = 40\\,\\mathrm{nm}$,\n- nominal thickness $t = 80\\,\\mathrm{nm}$,\n- segment length $L = 1.0\\,\\mathrm{mm}$,\n- liner thickness $t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm}$.\n\nFor the lined case, model the effective copper width as $W - 2\\,t_{\\mathrm{liner}}$ and the effective copper thickness as $t - t_{\\mathrm{liner}}$. Express the resistance in $\\Omega$ and the fractional increase as a decimal. Round both quantities to four significant figures. The final answer must contain the resistance with liner and the fractional increase, in that order, as a single composite response.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- **Physical System**: A dual-damascene copper interconnect of length $L$, nominal width $W$, and nominal thickness $t$.\n- **Materials**: Copper with uniform resistivity $\\rho$. A conformal barrier/liner of thickness $t_{\\mathrm{liner}}$ is present on the sidewalls and bottom.\n- **Assumptions**: The liner material is a perfect electrical insulator.\n- **Constitutive Relations**: The problem requires starting from fundamental constitutive relations for steady conduction and geometric reasoning.\n- **Modeling for Lined Case**:\n    - Effective copper width is defined as $W_{\\mathrm{eff}} = W - 2t_{\\mathrm{liner}}$.\n    - Effective copper thickness is defined as $t_{\\mathrm{eff}} = t - t_{\\mathrm{liner}}$.\n- **Parameters**:\n    - Copper resistivity, $\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$.\n    - Nominal width, $W = 40\\,\\mathrm{nm}$.\n    - Nominal thickness, $t = 80\\,\\mathrm{nm}$.\n    - Segment length, $L = 1.0\\,\\mathrm{mm}$.\n    - Liner thickness, $t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm}$.\n- **Required Outputs**:\n    - The resistance of the interconnect with the liner, in $\\Omega$, rounded to four significant figures.\n    - The fractional increase in resistance due to the liner, as a decimal, rounded to four significant figures.\n    - The final answer must be a composite response containing these two values in order.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the principles of electrical conduction. The formula for resistance, $R = \\rho L/A$, is a fundamental constitutive relation. The scenario of a liner reducing the conductive cross-sectional area of an interconnect is a standard and critical concept in modern integrated circuit design and EDA.\n- **Well-Posedness**: The problem is well-posed. It provides a clear physical model, all necessary parameters, and an explicit definition for the geometry of the lined conductor, leading to a unique solution.\n- **Objectivity**: The problem is stated in objective, technical language, free from ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained. All variables required for the calculation are provided. The model for calculating the effective area is explicitly given, preventing ambiguity. There are no contradictions in the provided data or assumptions.\n- **Realism and Feasibility**: The given dimensions ($40\\,\\mathrm{nm}$ width, $5\\,\\mathrm{nm}$ liner) are representative of advanced technology nodes in semiconductor manufacturing. The resistivity value is realistic for thin-film copper, which typically exhibits higher resistivity than its bulk counterpart due to electron scattering effects. The problem setup is a standard, albeit simplified, model used in engineering practice.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and complete. It represents a valid and relevant engineering problem. Therefore, a full solution will be provided.\n\n### Solution Derivation\nThe fundamental constitutive relation for the resistance $R$ of a prismatic conductor of length $L$, uniform cross-sectional area $A$, and uniform resistivity $\\rho$ is:\n$$ R = \\frac{\\rho L}{A} $$\n\nWe will analyze two cases as stipulated: resistance without a liner and resistance with a liner.\n\n**Case 1: Interconnect without a Liner**\nLet $R_0$ be the resistance of the interconnect without the liner. The cross-section is a rectangle with width $W$ and thickness $t$. The cross-sectional area, $A_0$, is:\n$$ A_0 = Wt $$\nThe resistance is therefore:\n$$ R_0 = \\frac{\\rho L}{A_0} = \\frac{\\rho L}{Wt} $$\n\n**Case 2: Interconnect with a Liner**\nLet $R_{\\mathrm{liner}}$ be the resistance of the interconnect with the liner. The problem states that the liner is on the bottom and the two sidewalls of the trench. The conductive copper core is thus reduced in size. The problem provides a specific model for the effective dimensions of the copper:\n- The effective width is reduced by the liner on both sides: $W_{\\mathrm{eff}} = W - 2t_{\\mathrm{liner}}$.\n- The effective thickness is reduced by the liner on the bottom: $t_{\\mathrm{eff}} = t - t_{\\mathrm{liner}}$.\n\nThe effective cross-sectional area of the copper, $A_{\\mathrm{eff}}$, is:\n$$ A_{\\mathrm{eff}} = W_{\\mathrm{eff}} t_{\\mathrm{eff}} = (W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}}) $$\nThe resistance of the lined interconnect is:\n$$ R_{\\mathrm{liner}} = \\frac{\\rho L}{A_{\\mathrm{eff}}} = \\frac{\\rho L}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})} $$\nThis is the first quantity to be calculated.\n\n**Fractional Increase in Resistance**\nThe fractional increase in resistance, $\\Delta_R$, is defined as the change in resistance relative to the original resistance, $R_0$.\n$$ \\Delta_R = \\frac{R_{\\mathrm{liner}} - R_0}{R_0} = \\frac{R_{\\mathrm{liner}}}{R_0} - 1 $$\nSubstituting the expressions for $R_{\\mathrm{liner}}$ and $R_0$:\n$$ \\Delta_R = \\frac{\\frac{\\rho L}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})}}{\\frac{\\rho L}{Wt}} - 1 $$\nThe terms $\\rho$ and $L$ cancel out, yielding a purely geometric ratio:\n$$ \\Delta_R = \\frac{Wt}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})} - 1 $$\nThis is the second quantity to be calculated.\n\n**Numerical Calculation**\nFirst, we convert all given parameters to base SI units (meters).\n- $\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$\n- $L = 1.0\\,\\mathrm{mm} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $W = 40\\,\\mathrm{nm} = 40 \\times 10^{-9}\\,\\mathrm{m}$\n- $t = 80\\,\\mathrm{nm} = 80 \\times 10^{-9}\\,\\mathrm{m}$\n- $t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm} = 5.0 \\times 10^{-9}\\,\\mathrm{m}$\n\nNow, we calculate the effective dimensions and area:\n- $W_{\\mathrm{eff}} = 40 \\times 10^{-9}\\,\\mathrm{m} - 2 \\times (5.0 \\times 10^{-9}\\,\\mathrm{m}) = 30 \\times 10^{-9}\\,\\mathrm{m}$\n- $t_{\\mathrm{eff}} = 80 \\times 10^{-9}\\,\\mathrm{m} - 5.0 \\times 10^{-9}\\,\\mathrm{m} = 75 \\times 10^{-9}\\,\\mathrm{m}$\n- $A_{\\mathrm{eff}} = (30 \\times 10^{-9}\\,\\mathrm{m}) \\times (75 \\times 10^{-9}\\,\\mathrm{m}) = 2250 \\times 10^{-18}\\,\\mathrm{m}^2 = 2.25 \\times 10^{-15}\\,\\mathrm{m}^2$\n\nNext, we calculate $R_{\\mathrm{liner}}$:\n$$ R_{\\mathrm{liner}} = \\frac{(3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}) \\times (1.0 \\times 10^{-3}\\,\\mathrm{m})}{2.25 \\times 10^{-15}\\,\\mathrm{m}^2} = \\frac{3.0 \\times 10^{-11}}{2.25 \\times 10^{-15}}\\,\\Omega $$\n$$ R_{\\mathrm{liner}} = \\frac{3.0}{2.25} \\times 10^4\\,\\Omega = 1.3333... \\times 10^4\\,\\Omega = 13333.3... \\,\\Omega $$\nRounding to four significant figures, we get $R_{\\mathrm{liner}} = 13330\\,\\Omega$.\n\nFinally, we calculate the fractional increase $\\Delta_R$. We can use the simplified symbolic expression.\n- First, calculate the original area $A_0$:\n  $A_0 = Wt = (40 \\times 10^{-9}\\,\\mathrm{m}) \\times (80 \\times 10^{-9}\\,\\mathrm{m}) = 3200 \\times 10^{-18}\\,\\mathrm{m}^2 = 3.2 \\times 10^{-15}\\,\\mathrm{m}^2$.\n$$ \\Delta_R = \\frac{A_0}{A_{\\mathrm{eff}}} - 1 = \\frac{3200 \\times 10^{-18}}{2250 \\times 10^{-18}} - 1 = \\frac{3200}{2250} - 1 = \\frac{320}{225} - 1 $$\n$$ \\Delta_R = \\frac{64}{45} - 1 = 1.4222... - 1 = 0.4222... $$\nRounding to four significant figures, the fractional increase is $\\Delta_R = 0.4222$.\n\nThe two required values are the resistance with the liner, $13330\\,\\Omega$, and the fractional increase in resistance, $0.4222$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n13330 & 0.4222\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The parallel-plate model provides a simple starting point for understanding capacitance, but it often fails to capture the full picture in modern IC design. This practice confronts the limitations of this basic approximation by comparing its prediction to a high-fidelity field solver result for a narrow interconnect . By calculating the significant error and analyzing its physical origins, you will develop a crucial intuition for the dominant role of fringing and sidewall capacitance in today's deep-submicron technologies.",
            "id": "4277425",
            "problem": "An interconnect in silicon dioxide is modeled as a straight, perfectly conducting rectangular strip of width $w = 0.10~\\mu\\mathrm{m}$, thickness $t = 0.05~\\mu\\mathrm{m}$, and length $L = 1.00~\\mathrm{mm}$, separated by a dielectric thickness $d = 0.20~\\mu\\mathrm{m}$ from an infinite ground plane. The dielectric is homogeneous silicon dioxide with relative permittivity $\\varepsilon_r = 3.9$. A high-fidelity electromagnetic field solver predicts the total capacitance to the ground plane to be $C_{\\mathrm{fs}} = 2.87 \\times 10^{-14}~\\mathrm{F}$ for this geometry.\n\nUsing first principles and the assumption of a spatially uniform electric field between the facing surfaces of area $w \\times L$ separated by $d$ (i.e., the parallel-plate approximation that neglects fringing and sidewall effects), compute the parallel-plate capacitance $C_{\\mathrm{pp}}$ and then the relative error\n$$\\delta = \\frac{C_{\\mathrm{pp}} - C_{\\mathrm{fs}}}{C_{\\mathrm{fs}}}.$$\nTake the vacuum permittivity as $\\varepsilon_0 = 8.854 \\times 10^{-12}~\\mathrm{F/m}$. Express your final answer for $\\delta$ as a unitless decimal fraction, rounded to four significant figures.\n\nAdditionally, explain the physical sources of discrepancy between the parallel-plate approximation and the field solver result in the context of narrow-width interconnects.\n\nExpress the final numerical answer with no units.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. All necessary data are provided, and the task is a standard exercise in electromagnetism and semiconductor device physics, centered on the fundamentals of interconnect capacitance. The problem is therefore deemed valid.\n\nThe solution proceeds in two parts: first, the calculation of the relative error, and second, the physical explanation for the discrepancy between the parallel-plate model and the field solver result.\n\nFirst, we compute the capacitance based on the parallel-plate approximation, denoted as $C_{\\mathrm{pp}}$. The formula for a parallel-plate capacitor is:\n$$C_{\\mathrm{pp}} = \\frac{\\varepsilon A}{d_{\\text{sep}}}$$\nwhere $\\varepsilon$ is the permittivity of the dielectric material, $A$ is the area of the plates, and $d_{\\text{sep}}$ is the separation distance between the plates.\n\nFor the given interconnect, the dielectric is silicon dioxide with a relative permittivity $\\varepsilon_r = 3.9$. The absolute permittivity is $\\varepsilon = \\varepsilon_r \\varepsilon_0$. The problem assumes the capacitance is formed between the bottom surface of the interconnect and the ground plane. Therefore, the area $A$ is the product of the interconnect's width $w$ and length $L$, so $A = w L$. The separation distance is the dielectric thickness $d$.\n\nSubstituting these into the formula, we have:\n$$C_{\\mathrm{pp}} = \\frac{\\varepsilon_r \\varepsilon_0 w L}{d}$$\n\nThe given values must be converted to base SI units (meters).\nThe width is $w = 0.10~\\mu\\mathrm{m} = 0.10 \\times 10^{-6}~\\mathrm{m}$.\nThe length is $L = 1.00~\\mathrm{mm} = 1.00 \\times 10^{-3}~\\mathrm{m}$.\nThe dielectric thickness is $d = 0.20~\\mu\\mathrm{m} = 0.20 \\times 10^{-6}~\\mathrm{m}$.\nThe constants are $\\varepsilon_r = 3.9$ and $\\varepsilon_0 = 8.854 \\times 10^{-12}~\\mathrm{F/m}$.\n\nSubstituting these values into the expression for $C_{\\mathrm{pp}}$:\n$$C_{\\mathrm{pp}} = \\frac{(3.9)(8.854 \\times 10^{-12}~\\mathrm{F/m})(0.10 \\times 10^{-6}~\\mathrm{m})(1.00 \\times 10^{-3}~\\mathrm{m})}{0.20 \\times 10^{-6}~\\mathrm{m}}$$\n$$C_{\\mathrm{pp}} = \\frac{3.9 \\times 8.854 \\times 0.10 \\times 1.00}{0.20} \\times \\frac{10^{-12} \\times 10^{-6} \\times 10^{-3}}{10^{-6}}~\\mathrm{F}$$\n$$C_{\\mathrm{pp}} = 17.2653 \\times 10^{-15}~\\mathrm{F} = 1.72653 \\times 10^{-14}~\\mathrm{F}$$\n\nNext, we compute the relative error $\\delta$ using the given formula and the high-fidelity field solver capacitance $C_{\\mathrm{fs}} = 2.87 \\times 10^{-14}~\\mathrm{F}$.\n$$\\delta = \\frac{C_{\\mathrm{pp}} - C_{\\mathrm{fs}}}{C_{\\mathrm{fs}}}$$\n$$\\delta = \\frac{1.72653 \\times 10^{-14}~\\mathrm{F} - 2.87 \\times 10^{-14}~\\mathrm{F}}{2.87 \\times 10^{-14}~\\mathrm{F}}$$\n$$\\delta = \\frac{1.72653 - 2.87}{2.87} = \\frac{-1.14347}{2.87} \\approx -0.3984216$$\n\nRounding the result to four significant figures, we get:\n$$\\delta \\approx -0.3984$$\n\nThe physical discrepancy between the parallel-plate capacitance $C_{\\mathrm{pp}}$ and the field solver capacitance $C_{\\mathrm{fs}}$ arises because the parallel-plate model is an oversimplification. It only accounts for the electric field lines originating from the bottom surface of the conductor and terminating perpendicularly on the ground plane, assuming a perfectly uniform field. In reality, the electric field is more complex. The total capacitance $C_{\\mathrm{fs}}$ includes additional contributions, collectively known as fringing capacitance ($C_{\\text{fringe}}$), such that $C_{\\mathrm{total}} = C_{\\mathrm{pp}} + C_{\\text{fringe}}$.\n\nThe sources of this fringing capacitance are:\n$1$. **Edge Fringing:** The electric field lines at the edges of the conductor's bottom face do not travel straight down but \"fringe\" outwards into the dielectric. This outward bowing effectively increases the area over which the field interacts with the ground plane, thus increasing the capacitance beyond the simple $w \\times L$ area consideration.\n$2$. **Sidewall Capacitance:** The parallel-plate model completely ignores the interconnect's thickness $t = 0.05~\\mu\\mathrm{m}$. The vertical sidewalls of the conductor (with area $t \\times L$ on each side) also hold charge and have electric field lines that terminate on the ground plane. This sidewall-to-ground capacitance is a significant contributor to the total capacitance, especially for narrow interconnects.\n$3$. **Corner/Top-Surface Effects:** Field lines can also originate from the top corners and, to a lesser extent, the top surface of the conductor, wrapping around to terminate on the ground plane.\n\nThe term \"narrow-width interconnect\" is key. The validity of the parallel-plate approximation rests on the assumption that the width $w$ is much larger than the separation $d$ (i.e., $w/d \\gg 1$) and the thickness $t$ (i.e., $w/t \\gg 1$). In this problem, the aspect ratio of width to separation is $w/d = (0.10~\\mu\\mathrm{m}) / (0.20~\\mu\\mathrm{m}) = 0.5$, and the ratio of width to thickness is $w/t = (0.10~\\mu\\mathrm{m}) / (0.05~\\mu\\mathrm{m}) = 2$. Since $w$ is not significantly larger than $d$ or $t$, the fringing and sidewall capacitance components are not negligible; in fact, they are substantial.\n\nThe calculated error $\\delta \\approx -0.3984$ indicates that the parallel-plate value $C_{\\mathrm{pp}}$ is approximately $40\\%$ lower than the more accurate field solver value $C_{\\mathrm{fs}}$. This large negative error quantitatively confirms that the parallel-plate model severely underestimates the total capacitance by neglecting the dominant fringing and sidewall effects present in this narrow-width geometry.",
            "answer": "$$\n\\boxed{-0.3984}\n$$"
        },
        {
            "introduction": "Accurate parasitic models are the bedrock of modern electronic design automation (EDA), directly impacting timing, power, and signal integrity analysis. This accuracy depends on calibrating models to match the real, as-fabricated dimensions of interconnects, which systematically deviate from their drawn layouts due to process biases. This advanced practice challenges you to step into the role of a characterization engineer, using both resistance and capacitance measurements from test structures to extract these critical process biases, thereby connecting fundamental physical models to the practical art of technology calibration .",
            "id": "4277479",
            "problem": "An advanced calibration problem in Integrated Circuits and Electronic Design Automation (EDA): Chemical Mechanical Planarization (CMP) and plasma etch processes introduce systematic biases in interconnect cross-sectional and dielectric dimensions. These biases alter extracted resistance and capacitance values used in parasitic modeling. Starting only from fundamental definitions, derive and implement a calibration strategy to estimate systematic biases using test chip structures.\n\nFundamental base to use:\n- Ohm’s law and the definition of resistance: for a uniform conductor of length $L$, width $w$, thickness $t$, and resistivity $\\rho$, the direct current resistance is $R = \\rho L / A$ with $A = w t$.\n- Capacitance definition for a conductor above a reference plane: for a length $L$, dielectric permittivity $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, and dielectric thickness $d$, the electrostatic capacitance can be modeled as the sum of a parallel-plate term and a systematic fringing term, giving a per-unit-length capacitance $c = \\varepsilon \\left( w / d + k \\right)$, where $k$ is a dimensionless fringing constant. The total capacitance is $C = c L$.\n- Systematic process biases are modeled as additive offsets to drawn or nominal dimensions: $w \\mapsto w + b_w$, $t \\mapsto t_{\\mathrm{nom}} + b_t$, and $d \\mapsto d_{\\mathrm{nom}} + b_d$, where $b_w$, $b_t$, and $b_d$ are the width, thickness, and dielectric thickness biases, respectively.\n\nCalibration objective:\n- Given sets of measured resistance $R_i$ and measured capacitance $C_i$ for straight wires of drawn width $w_i$ and length $L_i$, and known material parameters $\\rho$, $\\varepsilon_0$, $\\varepsilon_r$, nominal thickness $t_{\\mathrm{nom}}$, nominal dielectric thickness $d_{\\mathrm{nom}}$, and fringing constant $k$, estimate the biases $b_w$, $b_t$, and $b_d$.\n- Use a first-order Taylor expansion around zero bias to obtain linearized residual equations that relate deviations between measured and nominal predictions to $b_w$, $b_t$, and $b_d$.\n- Formulate a dimensionless least-squares problem by normalizing residuals appropriately so that resistance and capacitance data contribute comparably, without introducing extraneous weighting.\n\nRequired implementation details:\n- Derive linearized residuals from the stated fundamental base. Construct a single linear system aggregating resistance and capacitance residuals across all structures, and solve for $b_w$, $b_t$, and $b_d$ using least squares.\n- Express the final estimated biases in nanometers, rounded to three decimal places.\n\nUnits:\n- Resistivity $\\rho$ in $\\Omega \\cdot \\mathrm{m}$.\n- Vacuum permittivity $\\varepsilon_0$ in $\\mathrm{F}/\\mathrm{m}$.\n- Relative permittivity $\\varepsilon_r$ is dimensionless.\n- Geometric dimensions $w$, $t_{\\mathrm{nom}}$, $d_{\\mathrm{nom}}$, and $L$ in $\\mathrm{m}$.\n- Resistance $R$ in $\\Omega$.\n- Capacitance $C$ in $\\mathrm{F}$.\n- Output biases $b_w$, $b_t$, $b_d$ in nanometers.\n\nTest suite:\nImplement the calibration for three test cases with synthetic “measured” data generated from the exact expressions using hidden true biases. Each case provides material and geometric parameters, and a set of wire structures $(w_i, L_i)$. The measured data are to be generated in-program using the given true biases and the exact resistance and capacitance formulas stated in the fundamental base.\n\n- Case $1$ (general case, multiple widths and lengths):\n  - $\\rho = 1.68 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$, $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$, $\\varepsilon_r = 2.7$, $t_{\\mathrm{nom}} = 0.9 \\times 10^{-6}\\ \\mathrm{m}$, $d_{\\mathrm{nom}} = 3.2 \\times 10^{-7}\\ \\mathrm{m}$, $k = 0.8$.\n  - Structures $(w_i, L_i)$ in meters: $(2.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$, $(5.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$, $(1.0 \\times 10^{-6}, 2.0 \\times 10^{-4})$, $(2.0 \\times 10^{-6}, 2.0 \\times 10^{-4})$, $(1.0 \\times 10^{-6}, 5.0 \\times 10^{-4})$, $(2.0 \\times 10^{-7}, 5.0 \\times 10^{-4})$, $(5.0 \\times 10^{-7}, 2.0 \\times 10^{-4})$, $(2.0 \\times 10^{-6}, 5.0 \\times 10^{-4})$.\n  - True biases: $b_w = -1.0 \\times 10^{-8}\\ \\mathrm{m}$, $b_t = -2.0 \\times 10^{-8}\\ \\mathrm{m}$, $b_d = +1.5 \\times 10^{-8}\\ \\mathrm{m}$.\n\n- Case $2$ (edge case with very narrow lines):\n  - $\\rho = 2.10 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$, $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$, $\\varepsilon_r = 2.3$, $t_{\\mathrm{nom}} = 0.6 \\times 10^{-6}\\ \\mathrm{m}$, $d_{\\mathrm{nom}} = 2.8 \\times 10^{-7}\\ \\mathrm{m}$, $k = 1.1$.\n  - Structures $(w_i, L_i)$ in meters: $(1.0 \\times 10^{-7}, 5.0 \\times 10^{-5})$, $(1.5 \\times 10^{-7}, 1.0 \\times 10^{-4})$, $(2.0 \\times 10^{-7}, 1.5 \\times 10^{-4})$, $(1.0 \\times 10^{-7}, 1.5 \\times 10^{-4})$, $(2.0 \\times 10^{-7}, 5.0 \\times 10^{-5})$.\n  - True biases: $b_w = -5.0 \\times 10^{-9}\\ \\mathrm{m}$, $b_t = -5.0 \\times 10^{-9}\\ \\mathrm{m}$, $b_d = +5.0 \\times 10^{-9}\\ \\mathrm{m}$.\n\n- Case $3$ (boundary case with zero biases for validation):\n  - $\\rho = 1.72 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$, $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$, $\\varepsilon_r = 2.5$, $t_{\\mathrm{nom}} = 1.3 \\times 10^{-6}\\ \\mathrm{m}$, $d_{\\mathrm{nom}} = 3.0 \\times 10^{-7}\\ \\mathrm{m}$, $k = 0.9$.\n  - Structures $(w_i, L_i)$ in meters: $(5.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$, $(1.0 \\times 10^{-6}, 1.0 \\times 10^{-4})$, $(5.0 \\times 10^{-7}, 3.0 \\times 10^{-4})$, $(1.0 \\times 10^{-6}, 3.0 \\times 10^{-4})$.\n  - True biases: $b_w = 0.0\\ \\mathrm{m}$, $b_t = 0.0\\ \\mathrm{m}$, $b_d = 0.0\\ \\mathrm{m}$.\n\nRequired output:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each test case contributes a sublist of three floating-point numbers $[b_w, b_t, b_d]$ in nanometers, rounded to three decimal places.\n- The final output format must be exactly of the form $[[b_{w,1},b_{t,1},b_{d,1}],[b_{w,2},b_{t,2},b_{d,2}],[b_{w,3},b_{t,3},b_{d,3}]]$.\n\nNo user input is required; all parameters are to be defined within the program. The solution must justify the linearization approach and the fitting method from the fundamental base stated above, and the code must implement that approach to produce the specified outputs.",
            "solution": "The problem is to determine the systematic process biases affecting interconnect dimensions—conductor width ($w$), conductor thickness ($t$), and dielectric thickness ($d$)—by analyzing electrical measurements from test structures. We are given a set of resistance ($R_i$) and capacitance ($C_i$) measurements for $N$ wire structures of varying drawn widths ($w_i$) and lengths ($L_i$). The material properties (resistivity $\\rho$, dielectric permittivity $\\varepsilon$) and nominal dimensions ($t_{\\mathrm{nom}}$, $d_{\\mathrm{nom}}$) are known. The goal is to estimate the width bias ($b_w$), thickness bias ($b_t$), and dielectric thickness bias ($b_d$) by fitting the data to a physical model. The problem specifies a linearized least-squares approach.\n\nFirst, we establish the physical models that relate the electrical measurements to the physical dimensions, including the biases. The true dimensions are modeled as additive offsets from the nominal (drawn) dimensions:\n- Actual width: $w_{\\mathrm{act}} = w_i + b_w$\n- Actual thickness: $t_{\\mathrm{act}} = t_{\\mathrm{nom}} + b_t$\n- Actual dielectric thickness: $d_{\\mathrm{act}} = d_{\\mathrm{nom}} + b_d$\n\nThe exact, nonlinear models for resistance and capacitance of the $i$-th structure are given by the fundamental relations:\n$$ R_i(b_w, b_t) = \\frac{\\rho L_i}{(w_i + b_w)(t_{\\mathrm{nom}} + b_t)} $$\n$$ C_i(b_w, b_d) = \\varepsilon L_i \\left( \\frac{w_i + b_w}{d_{\\mathrm{nom}} + b_d} + k \\right) $$\nwhere $\\varepsilon = \\varepsilon_0 \\varepsilon_r$ is the dielectric permittivity.\n\nThe nominal predictions for resistance ($R_{i, \\mathrm{nom}}$) and capacitance ($C_{i, \\mathrm{nom}}$) are the values calculated with zero bias ($b_w=0$, $b_t=0$, $b_d=0$):\n$$ R_{i, \\mathrm{nom}} = \\frac{\\rho L_i}{w_i t_{\\mathrm{nom}}} $$\n$$ C_{i, \\mathrm{nom}} = \\varepsilon L_i \\left( \\frac{w_i}{d_{\\mathrm{nom}}} + k \\right) $$\n\nThe core of the calibration strategy is to linearize the relationship between the measured values and the biases. We perform a first-order Taylor series expansion of $R_i$ and $C_i$ around the point of zero bias. This assumes the biases are small compared to the nominal dimensions.\n\nFor resistance, the expansion is:\n$$ R_i \\approx R_{i, \\mathrm{nom}} + \\left. \\frac{\\partial R_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} b_w + \\left. \\frac{\\partial R_i}{\\partial b_t} \\right|_{\\mathbf{b}=0} b_t $$\nThe partial derivatives, evaluated at zero bias, are:\n$$ \\left. \\frac{\\partial R_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\rho L_i}{(w_i+b_w)^2(t_{\\mathrm{nom}}+b_t)} \\right|_{\\mathbf{b}=0} = -\\frac{\\rho L_i}{w_i^2 t_{\\mathrm{nom}}} = -R_{i, \\mathrm{nom}} \\frac{1}{w_i} $$\n$$ \\left. \\frac{\\partial R_i}{\\partial b_t} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\rho L_i}{(w_i+b_w)(t_{\\mathrm{nom}}+b_t)^2} \\right|_{\\mathbf{b}=0} = -\\frac{\\rho L_i}{w_i t_{\\mathrm{nom}}^2} = -R_{i, \\mathrm{nom}} \\frac{1}{t_{\\mathrm{nom}}} $$\nThe residual equation is $R_i^{\\mathrm{meas}} - R_{i, \\mathrm{nom}} \\approx -R_{i, \\mathrm{nom}} \\frac{b_w}{w_i} - R_{i, \\mathrm{nom}} \\frac{b_t}{t_{\\mathrm{nom}}}$. To create a dimensionless residual, as required, we divide by $R_{i, \\mathrm{nom}}$:\n$$ y_{R,i} = \\frac{R_i^{\\mathrm{meas}} - R_{i, \\mathrm{nom}}}{R_{i, \\mathrm{nom}}} \\approx -\\frac{1}{w_i} b_w - \\frac{1}{t_{\\mathrm{nom}}} b_t $$\n\nSimilarly, for capacitance, the expansion is:\n$$ C_i \\approx C_{i, \\mathrm{nom}} + \\left. \\frac{\\partial C_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} b_w + \\left. \\frac{\\partial C_i}{\\partial b_d} \\right|_{\\mathbf{b}=0} b_d $$\nThe partial derivatives, evaluated at zero bias, are:\n$$ \\left. \\frac{\\partial C_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} = \\left. \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}+b_d} \\right|_{\\mathbf{b}=0} = \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}} $$\n$$ \\left. \\frac{\\partial C_i}{\\partial b_d} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\varepsilon L_i (w_i+b_w)}{(d_{\\mathrm{nom}}+b_d)^2} \\right|_{\\mathbf{b}=0} = -\\frac{\\varepsilon L_i w_i}{d_{\\mathrm{nom}}^2} $$\nWe form the dimensionless residual by dividing by $C_{i, \\mathrm{nom}} = \\varepsilon L_i (\\frac{w_i}{d_{\\text{nom}}} + k) = \\varepsilon L_i \\frac{w_i + k d_{\\text{nom}}}{d_{\\text{nom}}}$:\n$$ y_{C,i} = \\frac{C_i^{\\mathrm{meas}} - C_{i, \\mathrm{nom}}}{C_{i, \\mathrm{nom}}} \\approx \\frac{1}{C_{i, \\mathrm{nom}}} \\left( \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}} b_w - \\frac{\\varepsilon L_i w_i}{d_{\\mathrm{nom}}^2} b_d \\right) $$\nSubstituting the expression for $C_{i, \\mathrm{nom}}$ and simplifying the coefficients gives:\n$$ y_{C,i} \\approx \\left(\\frac{1}{w_i+k d_{\\mathrm{nom}}}\\right) b_w - \\left(\\frac{w_i}{d_{\\mathrm{nom}}(w_i+k d_{\\mathrm{nom}})}\\right) b_d $$\n\nWith these linearized, dimensionless residuals, we can construct a single linear system for all $N$ structures. Let the vector of unknown biases be $\\mathbf{x} = [b_w, b_t, b_d]^T$. We have $2N$ measurements ($N$ for resistance and $N$ for capacitance), leading to an overdetermined system of linear equations $A\\mathbf{x} \\approx \\mathbf{y}$, where:\n- $\\mathbf{y}$ is a $2N \\times 1$ vector of observed dimensionless residuals:\n$$ \\mathbf{y} = [y_{R,1}, \\dots, y_{R,N}, y_{C,1}, \\dots, y_{C,N}]^T $$\n- $A$ is the $2N \\times 3$ Jacobian matrix containing the sensitivity coefficients:\n$$ A = \\begin{bmatrix}\n-\\frac{1}{w_1} & -\\frac{1}{t_{\\mathrm{nom}}} & 0 \\\\\n\\vdots & \\vdots & \\vdots \\\\\n-\\frac{1}{w_N} & -\\frac{1}{t_{\\mathrm{nom}}} & 0 \\\\\n\\frac{1}{w_1+k d_{\\mathrm{nom}}} & 0 & -\\frac{w_1}{d_{\\mathrm{nom}}(w_1+k d_{\\mathrm{nom}})} \\\\\n\\vdots & \\vdots & \\vdots \\\\\n\\frac{1}{w_N+k d_{\\mathrm{nom}}} & 0 & -\\frac{w_N}{d_{\\mathrm{nom}}(w_N+k d_{\\mathrm{nom}})}\n\\end{bmatrix} $$\nThe least-squares estimate for the bias vector $\\mathbf{x}$ is the one that minimizes the squared Euclidean norm of the error, $\\|A\\mathbf{x} - \\mathbf{y}\\|_2^2$. This solution is formally given by $\\mathbf{x}_{\\mathrm{est}} = (A^T A)^{-1} A^T \\mathbf{y}$.\n\nThe implementation will first generate synthetic \"measured\" data using the exact nonlinear formulas and the provided \"true\" biases. Then, it will construct the matrix $A$ and vector $\\mathbf{y}$ using the nominal parameters and solve the linear least-squares problem to find the estimated biases $\\mathbf{x}_{\\mathrm{est}}$. Finally, the results are converted from meters to nanometers and rounded as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for systematic process biases using a linearized least-squares approach.\n    \"\"\"\n    # Define physical constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        {\n            \"params\": {\n                \"rho\": 1.68e-8, \"eps_r\": 2.7, \"t_nom\": 0.9e-6, \n                \"d_nom\": 3.2e-7, \"k\": 0.8\n            },\n            \"structures\": [\n                (2.0e-7, 1.0e-4), (5.0e-7, 1.0e-4), (1.0e-6, 2.0e-4),\n                (2.0e-6, 2.0e-4), (1.0e-6, 5.0e-4), (2.0e-7, 5.0e-4),\n                (5.0e-7, 2.0e-4), (2.0e-6, 5.0e-4)\n            ],\n            \"true_biases\": {\"bw\": -1.0e-8, \"bt\": -2.0e-8, \"bd\": 1.5e-8}\n        },\n        {\n            \"params\": {\n                \"rho\": 2.10e-8, \"eps_r\": 2.3, \"t_nom\": 0.6e-6, \n                \"d_nom\": 2.8e-7, \"k\": 1.1\n            },\n            \"structures\": [\n                (1.0e-7, 5.0e-5), (1.5e-7, 1.0e-4), (2.0e-7, 1.5e-4),\n                (1.0e-7, 1.5e-4), (2.0e-7, 5.0e-5)\n            ],\n            \"true_biases\": {\"bw\": -5.0e-9, \"bt\": -5.0e-9, \"bd\": 5.0e-9}\n        },\n        {\n            \"params\": {\n                \"rho\": 1.72e-8, \"eps_r\": 2.5, \"t_nom\": 1.3e-6, \n                \"d_nom\": 3.0e-7, \"k\": 0.9},\n            \"structures\": [\n                (5.0e-7, 1.0e-4), (1.0e-6, 1.0e-4), \n                (5.0e-7, 3.0e-4), (1.0e-6, 3.0e-4)\n            ],\n            \"true_biases\": {\"bw\": 0.0, \"bt\": 0.0, \"bd\": 0.0}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        params = case[\"params\"]\n        structures = case[\"structures\"]\n        true_biases = case[\"true_biases\"]\n        \n        rho = params[\"rho\"]\n        eps_r = params[\"eps_r\"]\n        t_nom = params[\"t_nom\"]\n        d_nom = params[\"d_nom\"]\n        k = params[\"k\"]\n        \n        b_w_true = true_biases[\"bw\"]\n        b_t_true = true_biases[\"bt\"]\n        b_d_true = true_biases[\"bd\"]\n        \n        epsilon = EPSILON_0 * eps_r\n        num_structures = len(structures)\n        \n        # A is the Jacobian matrix, y is the observation vector\n        A_matrix = np.zeros((2 * num_structures, 3))\n        y_vector = np.zeros(2 * num_structures)\n\n        for i, (w_i, L_i) in enumerate(structures):\n            # Generate synthetic \"measured\" data using exact models and true biases\n            w_act = w_i + b_w_true\n            t_act = t_nom + b_t_true\n            d_act = d_nom + b_d_true\n            \n            # Avoid division by zero for ill-posed cases\n            if w_act <= 0 or t_act <= 0 or d_act <= 0:\n                raise ValueError(\"Biases result in non-physical dimensions.\")\n\n            R_meas = (rho * L_i) / (w_act * t_act)\n            C_meas = epsilon * L_i * ((w_act / d_act) + k)\n            \n            # Calculate nominal values (zero bias)\n            R_nom = (rho * L_i) / (w_i * t_nom)\n            C_nom = epsilon * L_i * ((w_i / d_nom) + k)\n\n            # Calculate dimensionless residuals\n            y_r = (R_meas - R_nom) / R_nom\n            y_c = (C_meas - C_nom) / C_nom\n            \n            y_vector[i] = y_r\n            y_vector[i + num_structures] = y_c\n            \n            # Populate the Jacobian matrix A based on the derived linearized model\n            # Resistance row\n            A_matrix[i, 0] = -1.0 / w_i\n            A_matrix[i, 1] = -1.0 / t_nom\n            A_matrix[i, 2] = 0.0\n            \n            # Capacitance row\n            cap_denom = w_i + k * d_nom\n            A_matrix[i + num_structures, 0] = 1.0 / cap_denom\n            A_matrix[i + num_structures, 1] = 0.0\n            A_matrix[i + num_structures, 2] = -w_i / (d_nom * cap_denom)\n\n        # Solve the linear least-squares problem Ax = y for x = [bw, bt, bd]\n        # x is the vector of estimated biases in meters\n        x, residuals, rank, s = np.linalg.lstsq(A_matrix, y_vector, rcond=None)\n        \n        # Convert biases from meters to nanometers and round to 3 decimal places\n        b_w_est_nm = np.round(x[0] * 1e9, 3)\n        b_t_est_nm = np.round(x[1] * 1e9, 3)\n        b_d_est_nm = np.round(x[2] * 1e9, 3)\n        \n        all_results.append([b_w_est_nm, b_t_est_nm, b_d_est_nm])\n\n    # Format the final output string exactly as required\n    formatted_sublists = [f\"[{','.join(map(str, sub))}]\" for sub in all_results]\n    final_output = f\"[{','.join(formatted_sublists)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}