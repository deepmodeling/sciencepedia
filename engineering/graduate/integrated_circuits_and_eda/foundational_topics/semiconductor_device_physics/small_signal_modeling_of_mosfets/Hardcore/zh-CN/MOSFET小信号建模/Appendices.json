{
    "hands_on_practices": [
        {
            "introduction": "在应用任何小信号模型之前，首要任务是准确判断晶体管的直流工作区。本练习将引导你基于沟道形成和夹断等基本物理原理，通过编程实践来实现这一关键分类 。这项实践不仅能巩固你对MOSFET不同工作区物理本质的理解，还能培养你处理和分析半导体器件数据的实际能力。",
            "id": "4298875",
            "problem": "给定一组测量得到的元组，每个元组代表一个长沟道N沟道金属氧化物半导体（NMOS）晶体管的单工作点：$\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right)$。$V_{GS}$、$V_{DS}$ 和 $V_{TH}$ 的单位是伏特，$I_D$ 的单位是安培。您的任务是实现一个基于基本原理的分类方法，为每个元组分配三个区域标签之一：截止区、三极管区或饱和区。该分类必须基于以下基本考虑。\n\n从渐变沟道近似下的沟道电荷观点出发，其中沿沟道的局部过驱动电压为 $V_{ov}(x) = V_{GS} - V(x) - V_{TH}$，其中 $V(x)$ 是从源极（$x=0$）到漏极（$x=L$）的沟道电位。导通要求局部满足 $V_{ov}(x) \\ge 0$。漏极端开始夹断对应于 $V_{ov}(L) = 0$，这意味着边界条件为 $V_{GD} = V_{TH}$，因此 $V_{DS} = V_{GS} - V_{TH}$。仅使用这些基本定义和不等式，推导出一个使用 $V_{GS}$、$V_{DS}$ 和 $V_{TH}$ 且不依赖于任何特定电流-电压公式的区域分类器。当等式成立时，明确指定一个确定性的平局打破规则。\n\n将该分类器实现为一个程序，该程序将每个元组 $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right)$ 映射到一个整数代码：\n- 截止区 $\\rightarrow$ $0$\n- 三极管区 $\\rightarrow$ $1$\n- 饱和区 $\\rightarrow$ $2$\n\n使用以下包含九个元组的测试套件。所有电压单位为伏特，电流单位为安培：\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(1.0\\times 10^{-12}, 0.4, 1.0, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(1.0\\times 10^{-5}, 1.0, 0.2, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(2.0\\times 10^{-4}, 1.0, 0.5, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(3.0\\times 10^{-4}, 1.2, 0.7, 0.6\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(5.0\\times 10^{-7}, 0.5, 0.05, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(1.0\\times 10^{-3}, 1.2, 0.0, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(8.0\\times 10^{-5}, 0.6, 1.0, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(6.0\\times 10^{-4}, 1.5, 0.9, 0.5\\right)$\n- $\\left(I_D, V_{GS}, V_{DS}, V_{TH}\\right) = \\left(2.0\\times 10^{-12}, 0.49, 0.8, 0.5\\right)$\n\n科学真实性约束：\n- 假设为长沟道行为，忽略短沟道效应（如速度饱和）；在此假设下，从 $V_{GD}=V_{TH}$ 推导出的边界是适用的。\n- 为了分类目的，将亚阈值导通视为截止，并酌情使用非严格不等式。\n- 假设所有提供的元组中 $V_{DS} \\ge 0$。\n\n平局打破规则要求：\n- 明确定义当 $V_{GS}$ 等于 $V_{TH}$ 以及当 $V_{DS}$ 等于 $V_{GS} - V_{TH}$ 时如何分类。\n\n您的程序应生成单行输出，其中包含九个元组的整数分类代码，形式为方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_9\\right]$）。输出是无量纲整数，因此不应打印任何物理单位。程序不得读取任何输入，并且必须能直接运行。",
            "solution": "对N沟道金属氧化物半导体（NMOS）晶体管的工作区进行分类是模拟和数字电路分析中的一项基本任务。分类必须从第一性原理推导得出，特别是渐变沟道近似，并且只使用提供的电压 $V_{GS}$、$V_{DS}$ 和 $V_{TH}$。电流 $I_D$ 对于状态分类逻辑本身是无关的，尽管其值是工作区的结果。\n\n推导过程分两个层次化的步骤进行：首先，确定是否存在导电沟道；其次，确定该沟道在漏极是否被夹断。\n\n**步骤1：沟道形成（截止区 vs. 导通状态）**\n\n要使NMOS晶体管导通电流，必须在栅极下方形成一个连接源区和漏区的连续的可动电子沟道（反型层）。当栅-源电压 $V_{GS}$ 足够高，能够将大量的少数载流子（电子）吸引到硅-绝缘体界面时，这个反型层就会形成。形成此沟道所需的最小栅-源电压即为阈值电压 $V_{TH}$。\n\n因此，晶体管处于“导通”状态（即在三极管区或饱和区）的主要条件是：\n$$V_{GS} > V_{TH}$$\n\n如果不满足此条件，源极和漏极之间就不存在连续的反型层。器件处于**截止**区。题目要求一个确定性的平局打破规则，并指出亚阈值导通应被视为截止。因此，当 $V_{GS}$ 恰好等于 $V_{TH}$ 的边界情况被分类为截止。这给了我们第一条分类规则：\n\n*   如果 $V_{GS} \\le V_{TH}$，晶体管处于**截止**区，对应整数代码 $0$。\n\n**步骤2：沟道夹断（三极管区 vs. 饱和区）**\n\n如果晶体管处于导通状态（$V_{GS} > V_{TH}$），它可能处于两个区域之一：三极管区（也称线性区）或饱和区。区别取决于沟道在漏极端的状态。\n\n渐变沟道近似将沿沟道从源极（$x=0$）到漏极（$x=L$）的电位建模为一个平滑变化的函数 $V(x)$，其中 $V(0)=0$ 且 $V(L)=V_{DS}$。为使沟道上某一点 $x$ 保持反型，局部的栅-沟道电压 $V_{GC}(x) = V_{GS} - V(x)$ 必须超过阈值电压 $V_{TH}$。这可以用局部过驱动电压 $V_{ov}(x) = V_{GS} - V(x) - V_{TH}$ 来表示，该电压必须为非负才能导通：$V_{ov}(x) \\ge 0$。\n\n我们将源极的过驱动电压定义为 $V_{ov} = V_{GS} - V_{TH}$。在任意点 x 处的反型条件变为 $V(x) \\le V_{ov}$。\n\n**三极管区：**\n在三极管区，从源极到漏极的整个沟道都是反型的。这要求反型条件即使在电位最高的漏极端（$x=L$）也必须成立，即 $V(L) = V_{DS}$。条件是：\n$$V_{DS} < V_{GS} - V_{TH}$$\n如果此不等式成立，沟道是连续的，器件工作在**三极管**区。\n\n**饱和区：**\n三极管区和饱和区之间的边界发生在漏极端的沟道即将消失时，这种情况称为夹断。此时，漏极的局部过驱动电压变为零：\n$$V_{ov}(L) = V_{GS} - V(L) - V_{TH} = 0$$\n代入 $V(L) = V_{DS}$，我们得到：\n$$V_{GS} - V_{DS} - V_{TH} = 0 \\implies V_{DS} = V_{GS} - V_{TH}$$\n如果漏-源电压进一步增加，使得 $V_{DS} > V_{GS} - V_{TH}$，沟道将保持夹断状态，器件就完全进入**饱和**区。题目要求为边界情况制定一个平局打破规则。按照惯例，饱和区的边缘（$V_{DS} = V_{GS} - V_{TH}$）被包含在饱和区内，因为这是电流饱和机制开始的点。\n\n这给了我们第二套分类规则，仅在 $V_{GS} > V_{TH}$ 时适用：\n\n*   如果 $V_{DS} < V_{GS} - V_{TH}$，晶体管处于**三极管**区（代码 $1$）。\n*   如果 $V_{DS} \\ge V_{GS} - V_{TH}$，晶体管处于**饱和**区（代码 $2$）。\n\n**完整分类算法总结：**\n给定一个工作点电压元组 $(V_{GS}, V_{DS}, V_{TH})$：\n1.  检查是否 $V_{GS} \\le V_{TH}$。\n    *   如果为真，则区域为**截止区**（代码 $0$）。\n2.  如果为假（意味着 $V_{GS} > V_{TH}$），则进入下一步。\n    *   计算以源极为参考的过驱动电压：$V_{ov} = V_{GS} - V_{TH}$。\n    *   检查是否 $V_{DS} < V_{ov}$。\n        *   如果为真，则区域为**三极管区**（代码 $1$）。\n    *   否则（意味着 $V_{DS} \\ge V_{ov}$），区域为**饱和区**（代码 $2$）。\n题目还提供了一个约束条件 $V_{DS} \\ge 0$，这个逻辑已经隐式地处理了该条件，因为在导通状态下，$V_{GS} - V_{TH} > 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Classifies the operating region of an NMOS transistor based on its terminal voltages.\n\n    The classification logic is derived from first principles of MOSFET physics:\n    1.  Cutoff: The gate-source voltage is not sufficient to form a channel.\n        Condition: V_GS = V_TH\n        Code: 0\n    2.  Triode (Linear): A channel is formed, and it is continuous from source to drain.\n        Condition: V_GS > V_TH AND V_DS  V_GS - V_TH\n        Code: 1\n    3.  Saturation: A channel is formed but is pinched off at the drain end.\n        Condition: V_GS > V_TH AND V_DS >= V_GS - V_TH\n        Code: 2\n\n    The tie-breaking rules are explicitly defined:\n    - If V_GS = V_TH, the device is in cutoff.\n    - If V_DS == V_GS - V_TH, the device is in saturation.\n    \"\"\"\n    # The test suite of nine tuples is provided in the problem statement.\n    # Each tuple is in the format (I_D, V_GS, V_DS, V_TH).\n    # I_D is not used for classification, as per the problem's requirement\n    # to use only the voltage conditions.\n    test_cases = [\n        (1.0e-12, 0.4, 1.0, 0.5),\n        (1.0e-5,  1.0, 0.2, 0.5),\n        (2.0e-4,  1.0, 0.5, 0.5),\n        (3.0e-4,  1.2, 0.7, 0.6),\n        (5.0e-7,  0.5, 0.05, 0.5),\n        (1.0e-3,  1.2, 0.0, 0.5),\n        (8.0e-5,  0.6, 1.0, 0.5),\n        (6.0e-4,  1.5, 0.9, 0.5),\n        (2.0e-12, 0.49, 0.8, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the tuple. I_D is ignored.\n        _, v_gs, v_ds, v_th = case\n\n        # Classification code: 0 for cutoff, 1 for triode, 2 for saturation.\n        region_code = 0 \n\n        # Step 1: Check for channel formation (Cutoff vs. Active)\n        if v_gs = v_th:\n            region_code = 0  # Cutoff region\n        else:\n            # The device is active (V_GS > V_TH).\n            # Step 2: Check for channel pinch-off (Triode vs. Saturation)\n            overdrive_voltage = v_gs - v_th\n            \n            # The problem assumes V_DS >= 0.\n            if v_ds  overdrive_voltage:\n                region_code = 1  # Triode region\n            else: # v_ds >= overdrive_voltage\n                region_code = 2  # Saturation region\n        \n        results.append(region_code)\n\n    # Final print statement in the exact required format.\n    # Converts the list of integer results into a comma-separated string\n    # enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "确定了工作区之后，我们便可以推导特定区域的小信号参数。本练习聚焦于三极管区，指导你从基本的缓变沟道近似出发，一步步推导出沟道小信号电阻 $r_{sd}$ 的表达式 。通过这个推导过程，你将加深对器件物理行为与其等效电路模型之间内在联系的理解。",
            "id": "4298907",
            "problem": "考虑一个在集成电路的电子设计自动化（EDA）背景下，于三极管区工作的长沟道、n沟道金属-氧化物-半导体场效应晶体管（MOSFET）。此晶体管在渐变沟道近似下进行分析。假设器件在低电场下工作，迁移率恒定，并忽略速度饱和、沟道长度调制和体效应。设单位面积的栅氧化层电容为 $C_{ox}$，电子迁移率为 $\\mu_{n}$，器件宽度为 $W$，器件长度为 $L$，栅源电压为 $V_{GS}$，漏源电压为 $V_{DS}$，阈值电压为 $V_{TH}$。沟道电势 $V(x)$ 从源极（$x=0$）到漏极（$x=L$）测量，边界条件为 $V(0)=0$ 和 $V(L)=V_{DS}$。沿沟道的单位面积反型层电荷由 $q(x)=C_{ox}\\left(V_{GS}-V_{TH}-V(x)\\right)$ 给出（其中 $0 \\leq x \\leq L$），载流子漂移速度为 $v(x)=\\mu_{n}E(x)$，电场为 $E(x)=-\\frac{dV(x)}{dx}$。漏极电流为 $I_{D}=W\\,q(x)\\,v(x)$，在稳态下沿沟道恒定。\n\n仅从这些关系和定义出发，推导在三极管区某一偏置点的小信号源漏电导，其定义为 $g_{sd}=\\left.\\frac{\\partial I_{D}}{\\partial V_{DS}}\\right|_{V_{GS},\\,V_{TH},\\,W,\\,L,\\,\\mu_{n},\\,C_{ox}}$，并由此获得增量源漏电阻 $r_{sd}=g_{sd}^{-1}$，以 $\\mu_{n}$、$C_{ox}$、$W$、$L$、$V_{GS}$、$V_{TH}$ 和 $V_{DS}$ 表示的闭合形式解析表达式。简要讨论 $r_{sd}$ 如何依赖于偏置电压 $V_{GS}$ 和 $V_{DS}$ 以及几何比率 $W/L$。将你的最终答案表示为单个解析表达式；不要包含单位。",
            "solution": "目标是推导在三极管区工作的n沟道MOSFET的漏源电阻 $r_{sd}$。推导首先从构建漏极电流 $I_D$ 的表达式开始。\n\n漏极电流 $I_D$ 是单位时间内流过的总电荷。在沿沟道的位置 $x$ 处，微分电流 $dI_D$ 是由长度为 $dx$ 的沟道段内的可动反型电荷 $dQ_{inv}$ 漂移引起的。单位面积的反型电荷密度大小由 $q(x) = C_{ox}\\left(V_{GS}-V_{TH}-V(x)\\right)$ 给出。在长度为 $dx$、宽度为 $W$ 的段内的总可动电荷为 $dQ_{inv} = q(x) \\, W \\, dx$。\n\n电子的漂移速度为 $v_n = \\mu_n |\\vec{E}|$。电场 $\\vec{E}$ 从高电势（漏极）指向低电势（源极），因此其沿沟道的分量为 $E_x = -\\frac{dV}{dx}$。由于 $V(x)$ 从源极的 $0$ 增加到漏极的 $V_{DS}$，$\\frac{dV}{dx}$ 为正，因此 $E_x$ 为负。漂移速率为 $v_n = \\mu_n |E_x| = \\mu_n \\frac{dV}{dx}$。\n\n电流是单位长度的电荷 $Wq(x)$ 与载流子漂移速率 $v_n$ 的乘积。\n$$I_D = W q(x) v_n$$\n代入 $q(x)$ 和 $v_n$ 的表达式：\n$$I_D = W \\left[ C_{ox}\\left(V_{GS}-V_{TH}-V(x)\\right) \\right] \\left( \\mu_n \\frac{dV(x)}{dx} \\right)$$\n在稳态下，电流 $I_D$ 在沟道沿线的任何点 $x$ 处都必须是恒定的。我们可以重排这个微分方程以分离变量 $x$ 和 $V$。\n$$I_D \\, dx = W \\mu_n C_{ox} \\left(V_{GS}-V_{TH}-V\\right) dV$$\n为了求得总电流，我们将此表达式沿整个沟道长度积分。位置 $x$ 的范围从 $0$ 到 $L$，而沟道电势 $V(x)$ 的范围从 $V(0)=0$ 到 $V(L)=V_{DS}$。\n$$\\int_0^L I_D \\, dx = \\int_0^{V_{DS}} W \\mu_n C_{ox} \\left(V_{GS}-V_{TH}-V\\right) dV$$\n由于 $I_D$、$W$、$\\mu_n$ 和 $C_{ox}$ 相对于积分变量是常数：\n$$I_D \\int_0^L dx = W \\mu_n C_{ox} \\int_0^{V_{DS}} \\left(V_{GS}-V_{TH}-V\\right) dV$$\n执行积分：\n$$I_D [x]_0^L = W \\mu_n C_{ox} \\left[ (V_{GS}-V_{TH})V - \\frac{V^2}{2} \\right]_0^{V_{DS}}$$\n$$I_D (L-0) = W \\mu_n C_{ox} \\left( \\left( (V_{GS}-V_{TH})V_{DS} - \\frac{V_{DS}^2}{2} \\right) - (0) \\right)$$\n求解 $I_D$：\n$$I_D = \\mu_n C_{ox} \\frac{W}{L} \\left[ (V_{GS}-V_{TH})V_{DS} - \\frac{V_{DS}^2}{2} \\right]$$\n这是三极管区漏极电流的标准表达式，适用于 $0 \\le V_{DS} \\le V_{GS}-V_{TH}$。\n\n接下来，我们通过对 $I_D$ 求关于 $V_{DS}$ 的偏导数来找到小信号源漏电导 $g_{sd}$，同时保持所有其他参数恒定。\n$$g_{sd} = \\frac{\\partial I_{D}}{\\partial V_{DS}} = \\frac{\\partial}{\\partial V_{DS}} \\left\\{ \\mu_n C_{ox} \\frac{W}{L} \\left[ (V_{GS}-V_{TH})V_{DS} - \\frac{V_{DS}^2}{2} \\right] \\right\\}$$\n项 $\\mu_n C_{ox} \\frac{W}{L}$ 是一个常数因子。\n$$g_{sd} = \\mu_n C_{ox} \\frac{W}{L} \\frac{\\partial}{\\partial V_{DS}} \\left[ (V_{GS}-V_{TH})V_{DS} - \\frac{V_{DS}^2}{2} \\right]$$\n$$g_{sd} = \\mu_n C_{ox} \\frac{W}{L} \\left[ (V_{GS}-V_{TH}) \\cdot 1 - \\frac{1}{2}(2V_{DS}) \\right]$$\n$$g_{sd} = \\mu_n C_{ox} \\frac{W}{L} \\left( V_{GS}-V_{TH}-V_{DS} \\right)$$\n增量源漏电阻 $r_{sd}$ 是电导 $g_{sd}$ 的倒数。\n$$r_{sd} = \\frac{1}{g_{sd}} = \\frac{1}{\\mu_n C_{ox} \\frac{W}{L} \\left( V_{GS}-V_{TH}-V_{DS} \\right)}$$\n这是小信号电阻的最终闭合形式解析表达式。\n\n依赖关系讨论：\n1.  **对 $V_{GS}$ 的依赖性**：电阻 $r_{sd}$ 与项 $V_{GS}-V_{TH}-V_{DS}$ 成反比。随着栅源电压 $V_{GS}$ 的增加，过驱动电压 $V_{GS}-V_{TH}$ 增加。这会在沟道中感应出更强的反型层（更多的自由载流子），使沟道更具导电性。因此，电阻 $r_{sd}$ 随 $V_{GS}$ 的增加而减小。\n\n2.  **对 $V_{DS}$ 的依赖性**：随着漏源电压 $V_{DS}$ 的增加，项 $V_{GS}-V_{TH}-V_{DS}$ 减小。这导致分母变小，从而电阻 $r_{sd}$ 增加。这是因为较大的 $V_{DS}$ 会减小漏极端附近的栅-沟电压降，使反型层变窄并“夹断”沟道。漏极附近电荷密度的这种减少增加了整体沟道电阻。\n\n3.  **对 $W/L$ 的依赖性**：电阻 $r_{sd}$ 与几何宽高比 $W/L$ 成反比。增加沟道宽度 $W$ 会为电流提供更多的并联路径，从而减小电阻。增加沟道长度 $L$ 会迫使载流子行进更长的距离，从而增加电阻。这种行为类似于经典电阻器，其电阻为 $R = \\rho \\frac{L}{A}$，其中 $W$ 与横截面积 $A$ 相关。",
            "answer": "$$\\boxed{\\frac{1}{\\mu_{n} C_{ox} \\frac{W}{L} \\left(V_{GS} - V_{TH} - V_{DS}\\right)}}$$"
        },
        {
            "introduction": "饱和区是模拟放大电路设计的核心。本练习将带你进入更深入的领域，探讨关键的短沟道效应——漏致势垒降低（DIBL）——如何影响输出电阻 $r_o$ 。通过对比分析包含DIBL效应和不包含该效应的两个模型，你将定量地理解理想模型的局限性，并认识到精确建模对于现代集成电路设计的重要性。",
            "id": "4298849",
            "problem": "给定一个工作在饱和区的金属氧化物半导体场效应晶体管 (MOSFET)，要求您在相同的直流偏置下，比较由传统长沟道模型推导的小信号输出电阻与由包含漏致势垒降低 (DIBL) 效应的短沟道模型推导的小信号输出电阻。您必须从第一性原理出发，推导计算小信号输出电阻所需的表达式，然后编写一个程序来评估一组测试用例。重点是阐明计算的内容、其有效性的原因，以及如何从基本原理推导得出，而不是依赖于小信号参数的简化公式。\n\n基本原理和定义：\n- 在强反型和饱和区，根据电荷片近似和漂移扩散输运模型，长沟道 MOSFET 的漏极电流可以用几何尺寸和偏置电压来表示。过驱动电压定义为 $V_{\\mathrm{ov}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH}}$，其中 $V_{\\mathrm{GS}}$ 是栅源电压，$V_{\\mathrm{TH}}$ 是阈值电压。沟道长度调制由一个系数 $\\lambda$ 表示，该系数解释了有效沟道长度随漏源电压 $V_{\\mathrm{DS}}$ 增加而减小的效应。\n- 短沟道效应通过 DIBL 改变阈值电压，其一阶效应表现为阈值电压随 $V_{\\mathrm{DS}}$ 线性降低，系数为 $\\eta$。有效阈值电压变为 $V_{\\mathrm{TH,eff}} = V_{\\mathrm{TH0}} - \\eta V_{\\mathrm{DS}}$，其中 $V_{\\mathrm{TH0}}$ 是 $V_{\\mathrm{DS}}$ 为零时的阈值电压。这将有效过驱动电压增加到 $V_{\\mathrm{ov,eff}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH,eff}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}}$。\n- 小信号输出电阻定义为 $r_o = \\left( \\frac{\\partial I_D}{\\partial V_{\\mathrm{DS}}} \\big\\rvert_{\\text{bias}} \\right)^{-1}$，其中 $I_D$ 是漏极电流，偏导数在指定的工作点上计算。该定义源于电流-电压特性的一般小信号线性化。\n\n基于这些原理，您编写的程序必须：\n1. 在长沟道假设下（固定阈值电压和沟道长度调制），使用饱和区漏极电流的函数形式，其中包含迁移率 $\\mu$、单位面积氧化层电容 $C_{\\mathrm{ox}}$、器件宽度 $W$ 和器件长度 $L$。在此背景下，令 $K = \\frac{1}{2} \\mu C_{\\mathrm{ox}} \\frac{W}{L}$，并使用 $V_{\\mathrm{ov}}$ 和 $\\lambda$ 构建 $I_D(V_{\\mathrm{DS}})$。\n2. 在短沟道情况下，使用相同的函数形式，但将固定的阈值电压替换为经 DIBL 效应修正的阈值 $V_{\\mathrm{TH,eff}}$，并保持相同的 $\\lambda$ 以分离 DIBL 效应。使用 $V_{\\mathrm{ov,eff}}$ 和 $\\lambda$ 推导出 $I_D(V_{\\mathrm{DS}})$。\n3. 直接从第1项和第2项的函数形式出发，使用乘积法则和链式法则计算 $g_{ds,\\text{long}} = \\frac{\\partial I_{D,\\text{long}}}{\\partial V_{\\mathrm{DS}}}$ 和 $g_{ds,\\text{short}} = \\frac{\\partial I_{D,\\text{short}}}{\\partial V_{\\mathrm{DS}}}$，然后计算 $r_{o,\\text{long}} = \\frac{1}{g_{ds,\\text{long}}}$ 和 $r_{o,\\text{short}} = \\frac{1}{g_{ds,\\text{short}}}$。\n4. 将 DIBL 引起的差异量化为分数差 $\\Delta = \\frac{r_{o,\\text{short}} - r_{o,\\text{long}}}{r_{o,\\text{long}}}$（一个无量纲的小数）。由于两种模型中的沟道长度调制参数 $\\lambda$ 保持不变，该方法分离出了 DIBL 对输出电阻降低的贡献。\n\n您的程序必须为以下测试套件计算这些量，并确保饱和条件成立，即在短沟道情况下 $V_{\\mathrm{DS}} \\ge V_{\\mathrm{ov,eff}}$，在长沟道情况下 $V_{\\mathrm{DS}} \\ge V_{\\mathrm{ov}}$：\n\n- 测试用例1（短沟道，典型强反型）：$\\mu = 0.045 \\ \\mathrm{m^2/(V \\cdot s)}$, $C_{\\mathrm{ox}} = 0.010 \\ \\mathrm{F/m^2}$, $W = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $L = 1.0 \\times 10^{-7} \\ \\mathrm{m}$, $V_{\\mathrm{GS}} = 0.8 \\ \\mathrm{V}$, $V_{\\mathrm{DS}} = 0.6 \\ \\mathrm{V}$, $V_{\\mathrm{TH0}} = 0.35 \\ \\mathrm{V}$, $\\lambda = 0.10 \\ \\mathrm{V^{-1}}$, $\\eta = 0.08 \\ \\mathrm{V/V}$。\n- 测试用例2（近阈值工作）：$\\mu = 0.050 \\ \\mathrm{m^2/(V \\cdot s)}$, $C_{\\mathrm{ox}} = 0.008 \\ \\mathrm{F/m^2}$, $W = 0.5 \\times 10^{-6} \\ \\mathrm{m}$, $L = 0.16 \\times 10^{-6} \\ \\mathrm{m}$, $V_{\\mathrm{GS}} = 0.45 \\ \\mathrm{V}$, $V_{\\mathrm{DS}} = 0.30 \\ \\mathrm{V}$, $V_{\\mathrm{TH0}} = 0.40 \\ \\mathrm{V}$, $\\lambda = 0.06 \\ \\mathrm{V^{-1}}$, $\\eta = 0.05 \\ \\mathrm{V/V}$。\n- 测试用例3（极短沟道，最小沟道长度调制）：$\\mu = 0.045 \\ \\mathrm{m^2/(V \\cdot s)}$, $C_{\\mathrm{ox}} = 0.010 \\ \\mathrm{F/m^2}$, $W = 2.0 \\times 10^{-6} \\ \\mathrm{m}$, $L = 60 \\times 10^{-9} \\ \\mathrm{m}$, $V_{\\mathrm{GS}} = 0.90 \\ \\mathrm{V}$, $V_{\\mathrm{DS}} = 0.70 \\ \\mathrm{V}$, $V_{\\mathrm{TH0}} = 0.35 \\ \\mathrm{V}$, $\\lambda = 1.0 \\times 10^{-4} \\ \\mathrm{V^{-1}}$, $\\eta = 0.12 \\ \\mathrm{V/V}$。\n- 测试用例4（无 DIBL 基线）：$\\mu = 0.050 \\ \\mathrm{m^2/(V \\cdot s)}$, $C_{\\mathrm{ox}} = 0.004 \\ \\mathrm{F/m^2}$, $W = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $L = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $V_{\\mathrm{GS}} = 0.70 \\ \\mathrm{V}$, $V_{\\mathrm{DS}} = 0.50 \\ \\mathrm{V}$, $V_{\\mathrm{TH0}} = 0.40 \\ \\mathrm{V}$, $\\lambda = 0.08 \\ \\mathrm{V^{-1}}$, $\\eta = 0.00 \\ \\mathrm{V/V}$。\n\n物理单位：\n- 在内部以 $\\mathrm{\\Omega}$ 为单位报告 $r_{o,\\text{long}}$ 和 $r_{o,\\text{short}}$。对于最终输出，仅报告分数偏差 $\\Delta$，形式为不带单位的小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的分数偏差，以逗号分隔并用方括号括起来，例如 $[d_1,d_2,d_3,d_4]$，其中每个 $d_i$ 是测试用例 $i$ 的 $\\Delta$ 值，四舍五入到六位小数。\n\n约束和要求：\n- 确保在所有测试用例中 $V_{\\mathrm{DS}} \\ge V_{\\mathrm{ov}}$ 和 $V_{\\mathrm{DS}} \\ge V_{\\mathrm{ov,eff}}$，以便饱和区表达式适用。\n- 最终答案必须是浮点数；不要包含单位或百分号。",
            "solution": "该问题要求对金属氧化物半导体场效应晶体管 (MOSFET) 在两种不同模型下的小信号输出电阻进行比较分析：一种是传统的长沟道模型，另一种是包含了漏致势垒降低 (DIBL) 效应的短沟道模型。目标是从第一性原理出发推导必要的表达式，并为一组给定的测试用例计算由 DIBL 引起的分数输出电阻差异。所有器件都偏置在饱和区。\n\n假设n沟道MOSFET在饱和区具有平方律行为，其漏极电流 $I_D$ 的基本关系式为：\n$$I_D = \\frac{1}{2} \\mu C_{\\mathrm{ox}} \\frac{W}{L} (V_{\\mathrm{GS}} - V_{\\mathrm{TH}})^2$$\n其中 $\\mu$ 是电子迁移率，$C_{\\mathrm{ox}}$ 是单位面积的栅氧化层电容，$W$ 和 $L$ 分别是沟道宽度和长度，$V_{\\mathrm{GS}}$ 是栅源电压，$V_{\\mathrm{TH}}$ 是阈值电压。$\\frac{1}{2} \\mu C_{\\mathrm{ox}} \\frac{W}{L}$ 这一项被组合成单个参数 $K$。为了解释实际器件中观察到的有限输出电阻，该模型增加了一个沟道长度调制 (CLM) 因子 $(1 + \\lambda V_{\\mathrm{DS}})$，其中 $\\lambda$ 是 CLM 参数，$V_{\\mathrm{DS}}$ 是漏源电压。\n\n小信号输出电阻 $r_o$ 定义为输出电导 $g_{ds}$ 的倒数，而输出电导是漏极电流对漏源电压的偏导数，在直流工作点处求值：\n$$r_o = \\frac{1}{g_{ds}} = \\left( \\frac{\\partial I_D}{\\partial V_{\\mathrm{DS}}} \\right)^{-1}$$\n\n现在我们将为指定的两种模型推导输出电导的表达式。\n\n**1. 长沟道模型推导**\n\n在长沟道模型中，阈值电压 $V_{\\mathrm{TH}}$ 被假定为常数，等于其零偏置值 $V_{\\mathrm{TH0}}$。过驱动电压为 $V_{\\mathrm{ov}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH0}}$。包含沟道长度调制的漏极电流为：\n$$I_{D,\\text{long}}(V_{\\mathrm{DS}}) = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}})^2 (1 + \\lambda V_{\\mathrm{DS}})$$\n为了求得输出电导 $g_{ds,\\text{long}}$，我们将 $I_{D,\\text{long}}$ 对 $V_{\\mathrm{DS}}$ 求导：\n$$g_{ds,\\text{long}} = \\frac{\\partial I_{D,\\text{long}}}{\\partial V_{\\mathrm{DS}}} = \\frac{\\partial}{\\partial V_{\\mathrm{DS}}} \\left[ K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}})^2 (1 + \\lambda V_{\\mathrm{DS}}) \\right]$$\n由于 $K$、$V_{\\mathrm{GS}}$ 和 $V_{\\mathrm{TH0}}$ 相对于 $V_{\\mathrm{DS}}$ 是常数，求导过程很简单：\n$$g_{ds,\\text{long}} = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}})^2 \\frac{\\partial}{\\partial V_{\\mathrm{DS}}} (1 + \\lambda V_{\\mathrm{DS}}) = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}})^2 \\lambda$$\n这表明在长沟道模型中，输出电导完全由沟道长度调制引起。输出电阻则为：\n$$r_{o,\\text{long}} = \\frac{1}{g_{ds,\\text{long}}} = \\frac{1}{\\lambda K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}})^2}$$\n\n**2. 短沟道模型推导（含 DIBL）**\n\n在短沟道模型中，由于 DIBL 效应，阈值电压不再是常数，而是随着 $V_{\\mathrm{DS}}$ 的增加而减小。其一阶模型为 $V_{\\mathrm{TH,eff}} = V_{\\mathrm{TH0}} - \\eta V_{\\mathrm{DS}}$，其中 $\\eta$ 是 DIBL 系数。有效过驱动电压成为 $V_{\\mathrm{DS}}$ 的函数：$V_{\\mathrm{ov,eff}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH,eff}} = V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}}$。\n\n漏极电流表达式为：\n$$I_{D,\\text{short}}(V_{\\mathrm{DS}}) = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH,eff}})^2 (1 + \\lambda V_{\\mathrm{DS}}) = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})^2 (1 + \\lambda V_{\\mathrm{DS}})$$\n为了求得输出电导 $g_{ds,\\text{short}}$，我们将 $I_{D,\\text{short}}$ 对 $V_{\\mathrm{DS}}$ 求导。此处，过驱动电压的平方项和 CLM 项都依赖于 $V_{\\mathrm{DS}}$，因此我们必须使用乘积求导法则，$\\frac{d(uv)}{dx} = u\\frac{dv}{dx} + v\\frac{du}{dx}$。\n令 $u(V_{\\mathrm{DS}}) = (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})^2$ 和 $v(V_{\\mathrm{DS}}) = (1 + \\lambda V_{\\mathrm{DS}})$。\n$$g_{ds,\\text{short}} = \\frac{\\partial I_{D,\\text{short}}}{\\partial V_{\\mathrm{DS}}} = K \\left[ \\frac{\\partial u}{\\partial V_{\\mathrm{DS}}} v + u \\frac{\\partial v}{\\partial V_{\\mathrm{DS}}} \\right]$$\n各部分的导数是：\n$$\\frac{\\partial v}{\\partial V_{\\mathrm{DS}}} = \\frac{\\partial}{\\partial V_{\\mathrm{DS}}}(1 + \\lambda V_{\\mathrm{DS}}) = \\lambda$$\n$$\\frac{\\partial u}{\\partial V_{\\mathrm{DS}}} = \\frac{\\partial}{\\partial V_{\\mathrm{DS}}}(V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})^2 = 2(V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}}) \\cdot \\eta$$\n将这些代回乘积法则表达式中：\n$$g_{ds,\\text{short}} = K \\left[ 2\\eta(V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})(1 + \\lambda V_{\\mathrm{DS}}) + (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})^2 \\lambda \\right]$$\n我们可以提出公因子 $(V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}})$：\n$$g_{ds,\\text{short}} = K (V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}}) \\left[ 2\\eta(1 + \\lambda V_{\\mathrm{DS}}) + \\lambda(V_{\\mathrm{GS}} - V_{\\mathrm{TH0}} + \\eta V_{\\mathrm{DS}}) \\right]$$\n该表达式揭示了对输出电导的两个贡献：一个来自 DIBL 效应（$2\\eta$ 项），另一个来自传统的沟道长度调制（$\\lambda$ 项），而后者现在也通过有效过驱动电压受到 DIBL 的调制。输出电阻为 $r_{o,\\text{short}} = 1/g_{ds,\\text{short}}$。\n\n**3. 分数偏差**\n\n分数偏差 $\\Delta$ 量化了因包含 DIBL 效应而引起的输出电阻的相对变化：\n$$\\Delta = \\frac{r_{o,\\text{short}} - r_{o,\\text{long}}}{r_{o,\\text{long}}} = \\frac{r_{o,\\text{short}}}{r_{o,\\text{long}}} - 1 = \\frac{g_{ds,\\text{long}}}{g_{ds,\\text{short}}} - 1$$\n该度量标准分离了 DIBL 的影响，因为在两个模型之间 $\\lambda$ 保持恒定。下面的程序实现了这些推导出的公式，以计算指定测试用例的 $\\Delta$。对于每个用例，都会验证饱和条件 ($V_{\\mathrm{DS}} \\ge V_{\\mathrm{ov}}$)，以确保所用模型的有效性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fractional discrepancy in MOSFET output resistance between\n    a long-channel model and a short-channel model with DIBL.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (short-channel, typical strong inversion)\n        {'mu': 0.045, 'Cox': 0.010, 'W': 1.0e-6, 'L': 1.0e-7, 'Vgs': 0.8, 'Vds': 0.6, 'Vth0': 0.35, 'lambda_': 0.10, 'eta': 0.08, 'label': 'Case 1'},\n        # Test case 2 (near-threshold operation)\n        {'mu': 0.050, 'Cox': 0.008, 'W': 0.5e-6, 'L': 0.16e-6, 'Vgs': 0.45, 'Vds': 0.30, 'Vth0': 0.40, 'lambda_': 0.06, 'eta': 0.05, 'label': 'Case 2'},\n        # Test case 3 (extreme short-channel, minimal channel-length modulation)\n        {'mu': 0.045, 'Cox': 0.010, 'W': 2.0e-6, 'L': 60e-9, 'Vgs': 0.90, 'Vds': 0.70, 'Vth0': 0.35, 'lambda_': 1.0e-4, 'eta': 0.12, 'label': 'Case 3'},\n        # Test case 4 (no DIBL baseline)\n        {'mu': 0.050, 'Cox': 0.004, 'W': 1.0e-6, 'L': 1.0e-6, 'Vgs': 0.70, 'Vds': 0.50, 'Vth0': 0.40, 'lambda_': 0.08, 'eta': 0.00, 'label': 'Case 4'}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        mu = case['mu']\n        Cox = case['Cox']\n        W = case['W']\n        L = case['L']\n        Vgs = case['Vgs']\n        Vds = case['Vds']\n        Vth0 = case['Vth0']\n        lambda_ = case['lambda_']\n        eta = case['eta']\n\n        # 1. Check saturation conditions\n        Vov0 = Vgs - Vth0\n        Vov_eff = Vgs - (Vth0 - eta * Vds)\n        \n        # MOSFET must be on (Vov0 > 0) for saturation models to be meaningful\n        if Vov0 = 0:\n            raise ValueError(f\"Device in {case['label']} is in subthreshold or off. Vgs-Vth0 = {Vov0:.3f} V.\")\n\n        if not (Vds >= Vov0):\n            raise ValueError(f\"Saturation condition Vds >= Vov not met for long-channel model in {case['label']}: Vds={Vds:.3f} V, Vov={Vov0:.3f} V.\")\n        \n        if not (Vds >= Vov_eff):\n            raise ValueError(f\"Saturation condition Vds >= Vov_eff not met for short-channel model in {case['label']}: Vds={Vds:.3f} V, Vov_eff={Vov_eff:.3f} V.\")\n\n        # 2. Calculate technology parameter K\n        K = 0.5 * mu * Cox * (W / L)\n\n        # 3. Calculate long-channel output conductance (g_ds,long)\n        # g_ds,long = lambda * K * (Vgs - Vth0)^2\n        g_ds_long = lambda_ * K * Vov0**2\n        \n        # 4. Calculate short-channel output conductance (g_ds,short)\n        # g_ds,short = K * (Vov0 + eta*Vds) * [2*eta*(1+lambda*Vds) + lambda*(Vov0 + eta*Vds)]\n        term1_short = 2 * eta * (1 + lambda_ * Vds)\n        term2_short = lambda_ * (Vov0 + eta * Vds)\n        g_ds_short = K * (Vov0 + eta * Vds) * (term1_short + term2_short)\n\n        # 5. Calculate fractional discrepancy Delta\n        if g_ds_short == 0:\n            # This would imply infinite resistance. Discrepancy would be ill-defined or infinite.\n            # Given the problem's parameters, this case should not occur.\n            if g_ds_long == 0:\n                delta = 0.0 # Both resistances are infinite, no discrepancy\n            else:\n                delta = float('inf') # Should not happen\n        else:\n            delta = (g_ds_long / g_ds_short) - 1.0\n\n        results.append(round(delta, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(f'{x:.6f}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}