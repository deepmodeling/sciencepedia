{
    "hands_on_practices": [
        {
            "introduction": "Understanding the non-ideal behavior of MOS devices is crucial for practical circuit design. This first practice delves into one of the most significant non-idealities: fixed charge ($Q_{ox}$) at the silicon-oxide interface. By starting from first principles with Gauss's law, you will derive the resulting shift in the flatband voltage ($V_{FB}$), providing a direct link between a microscopic physical feature and a macroscopic, measurable device parameter. ",
            "id": "4283787",
            "problem": "A planar metal–oxide–semiconductor (MOS) capacitor consists of a metal gate, a silicon dioxide oxide of thickness $t_{ox}$, and a crystalline silicon substrate. The oxide occupies $0 < x < t_{ox}$, with the metal at $x < 0$ and the semiconductor at $x > t_{ox}$. Let the $x$-axis point from the metal, through the oxide, into the semiconductor. At the oxide–semiconductor interface at $x = t_{ox}$, there exists a fixed interfacial sheet charge density $Q_{ox}$ (in $\\mathrm{C/m^{2}}$), defined as positive for a sheet of positive charge. The gate-to-bulk voltage is defined as $V_{GB} = V_{G} - V_{B}$, and the electrostatic potential drop across the oxide is $V_{ox} = V(0) - V(t_{ox})$, with the electric field related by $E_{x} = -\\mathrm{d}V/\\mathrm{d}x$ in the oxide. Under flatband, the semiconductor bands are unbent, implying zero space charge in the semiconductor and a vanishing electric field just inside the semiconductor at $x = t_{ox}^{+}$.\n\nStarting from Gauss’s law and the electrostatic boundary condition at a dielectric interface with an interfacial sheet charge, derive from first principles the contribution $\\Delta V_{FB}$ of the interfacial charge $Q_{ox}$ to the flatband voltage. Clearly state the sign of $\\Delta V_{FB}$ for $Q_{ox} > 0$ under the stated conventions, and explain the physical reason for this sign.\n\nThen evaluate the derived expression numerically for $Q_{ox} = +3.20 \\times 10^{-4}\\,\\mathrm{C/m^{2}}$, $t_{ox} = 5.00\\,\\mathrm{nm}$, and $\\varepsilon_{ox} = 3.9\\,\\varepsilon_{0}$, with $\\varepsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$. Ignore any other charges or dipoles and any metal–semiconductor work-function difference not associated with $Q_{ox}$; report only the contribution due to $Q_{ox}$. Round your answer to four significant figures and express the final voltage in volts (V).",
            "solution": "The problem statement is critically validated and is determined to be **valid**. It is scientifically grounded in the principles of solid-state device physics and electrostatics, well-posed, objective, and self-contained with consistent physical parameters. Therefore, a solution will be derived.\n\nThe objective is to find the contribution, $\\Delta V_{FB}$, of a fixed interfacial sheet charge density, $Q_{ox}$, to the flatband voltage of an MOS capacitor. We start from first principles, specifically Gauss's law and electrostatic boundary conditions.\n\nThe structure is a metal gate at $x < 0$, an oxide of thickness $t_{ox}$ for $0 < x < t_{ox}$, and a semiconductor for $x > t_{ox}$. The fixed charge $Q_{ox}$ is located at the oxide-semiconductor interface, $x = t_{ox}$.\n\nFirst, we consider the electric field within the oxide layer. Assuming the oxide is a perfect insulator with no trapped volume charge, Gauss's law in one dimension states that the divergence of the electric displacement field $\\mathbf{D}$ is zero:\n$$ \\frac{\\mathrm{d}D_x}{\\mathrm{d}x} = 0 $$\nThis implies that the displacement field $D_x$ is constant throughout the oxide, for $0 < x < t_{ox}$. Since $D_x = \\varepsilon_{ox} E_x$, where $\\varepsilon_{ox}$ is the permittivity of the oxide, the electric field $E_x$ must also be constant within the oxide. Let us denote this constant field as $E_{ox}$.\n\nNext, we apply the electrostatic boundary condition at the interface $x = t_{ox}$, which contains the fixed sheet charge density $Q_{ox}$. The boundary condition states that the discontinuity in the normal component of the electric displacement field across the interface is equal to the surface charge density. Taking the normal vector to point from the oxide into the semiconductor (the $+x$ direction), the condition is:\n$$ D_x(t_{ox}^{+}) - D_x(t_{ox}^{-}) = Q_{ox} $$\nHere, $D_x(t_{ox}^{+})$ is the displacement field just inside the semiconductor, and $D_x(t_{ox}^{-})$ is the displacement field just inside the oxide.\nWe can write this in terms of electric fields:\n$$ \\varepsilon_{si} E_x(t_{ox}^{+}) - \\varepsilon_{ox} E_x(t_{ox}^{-}) = Q_{ox} $$\nwhere $\\varepsilon_{si}$ is the permittivity of the semiconductor.\n\nThe problem specifies the flatband condition. By definition, at flatband, the semiconductor energy bands are not bent, which implies there is no space-charge region in the semiconductor. Consequently, the electric field just inside the semiconductor must be zero:\n$$ E_x(t_{ox}^{+}) = 0 $$\nSubstituting this into the boundary condition gives:\n$$ \\varepsilon_{si} (0) - \\varepsilon_{ox} E_x(t_{ox}^{-}) = Q_{ox} $$\nSince the electric field is constant in the oxide, $E_x(t_{ox}^{-}) = E_{ox}$. Therefore:\n$$ - \\varepsilon_{ox} E_{ox} = Q_{ox} $$\nSolving for the electric field in the oxide, we get:\n$$ E_{ox} = -\\frac{Q_{ox}}{\\varepsilon_{ox}} $$\n\nThe potential drop across the oxide, $V_{ox}$, is defined as $V_{ox} = V(0) - V(t_{ox})$. Using the relation $E_x = -\\mathrm{d}V/\\mathrm{d}x$, we can find $V_{ox}$ by integrating the electric field from the gate electrode at $x=0$ to the interface at $x=t_{ox}$:\n$$ V_{ox} = V(0) - V(t_{ox}) = - \\int_{t_{ox}}^{0} E_x \\, \\mathrm{d}x = \\int_{0}^{t_{ox}} E_x \\, \\mathrm{d}x $$\nSince $E_x = E_{ox}$ is constant in the oxide:\n$$ V_{ox} = E_{ox} \\int_{0}^{t_{ox}} \\mathrm{d}x = E_{ox} \\cdot t_{ox} $$\nSubstituting our expression for $E_{ox}$:\n$$ V_{ox} = \\left( -\\frac{Q_{ox}}{\\varepsilon_{ox}} \\right) t_{ox} = -\\frac{Q_{ox} t_{ox}}{\\varepsilon_{ox}} $$\n\nThe flatband voltage, $V_{FB}$, is the gate-to-bulk voltage $V_{GB}$ required to achieve the flatband condition. In general, $V_{GB} = V_{ox} + \\psi_s + \\Phi_{ms}$, where $\\psi_s$ is the surface potential (band bending in the semiconductor) and $\\Phi_{ms}$ is the metal-semiconductor work function difference. The problem asks for the contribution to $V_{FB}$ from $Q_{ox}$ only, effectively setting $\\Phi_{ms}=0$. At flatband, $\\psi_s=0$ by definition. Therefore, the flatband voltage contribution from $Q_{ox}$ is equal to the oxide voltage drop under these conditions:\n$$ \\Delta V_{FB} = V_{ox} = -\\frac{Q_{ox} t_{ox}}{\\varepsilon_{ox}} $$\nThis is the derived analytical expression for the contribution of interfacial charge to the flatband voltage.\n\nFor the second part, we analyze the sign of $\\Delta V_{FB}$ for a positive interfacial charge, $Q_{ox} > 0$. From the formula $\\Delta V_{FB} = -Q_{ox} t_{ox} / \\varepsilon_{ox}$, since $t_{ox}$ and $\\varepsilon_{ox}$ are positive physical quantities, if $Q_{ox} > 0$, then $\\Delta V_{FB}$ will be negative.\nThe physical reason is as follows: A positive fixed charge $Q_{ox}$ at the oxide-semiconductor interface will exert an electrostatic force that repels mobile positive charges (holes) and attracts mobile negative charges (electrons) in the semiconductor. This causes the semiconductor energy bands to bend downwards near the interface. To restore the flatband condition (i.e., to make the bands flat), one must apply an external gate voltage that counteracts this effect. A negative voltage applied to the gate, $V_G < 0$, places negative charge on the metal gate plate. This creates an electric field in the oxide that opposes the field generated by $Q_{ox}$. This opposing field acts to restore the flat band condition in the semiconductor. Since a negative gate voltage is required to cancel the effect of the positive charge $Q_{ox}$, the contribution to the flatband voltage, $\\Delta V_{FB}$, is negative.\n\nFinally, we evaluate the expression numerically. The given values are:\n$Q_{ox} = +3.20 \\times 10^{-4}\\,\\mathrm{C/m^{2}}$\n$t_{ox} = 5.00\\,\\mathrm{nm} = 5.00 \\times 10^{-9}\\,\\mathrm{m}$\n$\\varepsilon_{ox} = 3.9\\,\\varepsilon_{0}$, with $\\varepsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$.\n\nFirst, we calculate the permittivity of the oxide:\n$$ \\varepsilon_{ox} = 3.9 \\times (8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}) \\approx 3.453133 \\times 10^{-11}\\,\\mathrm{F/m} $$\nNow, we substitute the values into the derived formula for $\\Delta V_{FB}$:\n$$ \\Delta V_{FB} = -\\frac{Q_{ox} t_{ox}}{\\varepsilon_{ox}} = -\\frac{(3.20 \\times 10^{-4}\\,\\mathrm{C/m^{2}}) \\times (5.00 \\times 10^{-9}\\,\\mathrm{m})}{3.9 \\times (8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m})} $$\n$$ \\Delta V_{FB} = -\\frac{1.60 \\times 10^{-12}\\,\\mathrm{C/m}}{3.453133 \\times 10^{-11}\\,\\mathrm{F/m}} $$\nThe units are $(\\mathrm{C/m}) / (\\mathrm{F/m}) = \\mathrm{C/F} = \\mathrm{V}$, as expected.\n$$ \\Delta V_{FB} \\approx -0.0463346\\,\\mathrm{V} $$\nRounding the result to four significant figures as requested:\n$$ \\Delta V_{FB} = -0.04633\\,\\mathrm{V} $$",
            "answer": "$$\n\\boxed{-0.04633}\n$$"
        },
        {
            "introduction": "The formation of an inversion layer is the cornerstone of MOSFET operation, creating the conductive channel that allows current to flow. This exercise focuses on modeling the inversion charge density ($Q_{inv}$) in the strong inversion regime, using the powerful charge-sheet approximation. You will see how the applied gate voltage ($V_G$) above the threshold ($V_{th}$)—the overdrive voltage ($V_{ov}$)—directly controls the density of mobile carriers in the channel, revealing the fundamental principle behind transistor switching. ",
            "id": "4283718",
            "problem": "A Metal–Oxide–Semiconductor (MOS) capacitor consisting of a metal gate, a silicon dioxide gate dielectric, and a uniformly doped p-type silicon substrate is biased in the quasi-static regime. Assume one-dimensional electrostatics normal to the interface, negligible generation-recombination transients, and negligible gate leakage. Let the oxide thickness be $t_{ox}$ and the oxide permittivity be $\\varepsilon_{ox}$, so the oxide capacitance per unit area is $C_{ox} = \\varepsilon_{ox}/t_{ox}$. The semiconductor relative permittivity is $\\varepsilon_{s}$. Let the metal–semiconductor flatband voltage be $V_{FB}$, the surface potential at inversion onset be $2\\phi_{F}$, where $\\phi_{F} = (k_{B}T/q)\\ln(N_{A}/n_{i})$, and define the threshold voltage $V_{th}$ as the gate voltage at which the surface potential satisfies $\\psi_{s}=2\\phi_{F}$ and the inversion charge is negligible compared to the depletion charge. The gate voltage is $V_{G}$ and the overdrive is $V_{ov} = V_{G} - V_{th}$.\n\nStarting from Gauss’s law in the oxide, Poisson’s equation in the semiconductor, and the charge-sheet approximation that treats the inversion layer as a sheet of charge located at the semiconductor surface when $V_{G} > V_{th}$, derive a closed-form analytic expression for the inversion charge density per unit area $Q_{inv}(V_{G})$ for $V_{G} > V_{th}$. In your derivation, use the constraints that for strong inversion the surface potential is approximately pinned near $2\\phi_{F}$ and that incremental increases in $V_{G}$ above $V_{th}$ primarily drop across the oxide. Clarify the physical role of the overdrive $V_{ov}$ in setting the inversion charge under these approximations.\n\nExpress your final result as a single symbolic analytic expression for $Q_{inv}(V_{G})$ in Coulombs per square meter, with variables written in terms of $C_{ox}$ and $V_{ov}$. Do not include units inside the final boxed answer. No rounding is required.",
            "solution": "The problem statement is a standard, well-posed problem in the field of semiconductor device physics, resting on established principles and models. It is scientifically grounded, objective, and contains sufficient information for a unique, closed-form solution under the specified approximations. Therefore, the problem is valid, and a solution will be derived.\n\nThe analysis begins with the fundamental voltage balance equation for a Metal-Oxide-Semiconductor (MOS) capacitor. The total gate voltage, $V_G$, applied between the metal gate and the grounded p-type silicon substrate, is partitioned across the device structure. This can be expressed as the sum of the flatband voltage, $V_{FB}$, the voltage drop across the oxide layer, $V_{ox}$, and the potential drop within the semiconductor, which at the surface is the surface potential, $\\psi_s$.\n$$V_G = V_{FB} + \\psi_s + V_{ox}$$\nThe flatband voltage, $V_{FB}$, accounts for the work function difference between the metal and the semiconductor and any fixed charges in the oxide or at the oxide-semiconductor interface.\n\nAccording to Gauss's law, the electric field in the oxide, $E_{ox}$, is related to the total charge per unit area in the semiconductor, $Q_s$, by the relation $E_{ox} = -Q_s / \\varepsilon_{ox}$, where $\\varepsilon_{ox}$ is the permittivity of the oxide. The negative sign indicates that a positive semiconductor charge induces an electric field pointing from the semiconductor towards the gate. The voltage drop across the oxide, $V_{ox}$, is the product of the electric field and the oxide thickness, $t_{ox}$, assuming a uniform field:\n$$V_{ox} = E_{ox} t_{ox} = -\\frac{Q_s t_{ox}}{\\varepsilon_{ox}}$$\nUsing the definition of the oxide capacitance per unit area, $C_{ox} = \\varepsilon_{ox}/t_{ox}$, the oxide voltage can be written as:\n$$V_{ox} = -\\frac{Q_s}{C_{ox}}$$\nSubstituting this expression for $V_{ox}$ into the main voltage balance equation yields:\n$$V_G = V_{FB} + \\psi_s - \\frac{Q_s}{C_{ox}}$$\nThe total charge in the semiconductor, $Q_s$, is the sum of the charge from mobile carriers in the inversion layer, $Q_{inv}$, and the charge from the fixed, ionized acceptor atoms in the depletion region, $Q_{dep}$. For a p-type substrate, the inversion layer consists of electrons (negative charge), and the depletion region consists of ionized acceptors, $N_A^-$, which are also negative. Thus, both $Q_{inv}$ and $Q_{dep}$ are negative quantities.\n$$Q_s = Q_{inv} + Q_{dep}$$\nThe complete voltage balance equation is therefore:\n$$V_G = V_{FB} + \\psi_s - \\frac{Q_{inv} + Q_{dep}}{C_{ox}}$$\nWe first analyze this equation at the threshold of strong inversion, where the gate voltage is the threshold voltage, $V_G = V_{th}$. By definition, at this point, the surface potential is $\\psi_s = 2\\phi_F$, and the inversion charge is considered negligible, $Q_{inv} \\approx 0$. Let the depletion charge at this specific bias point be denoted as $Q_{dep,th}$. The voltage equation becomes:\n$$V_{th} = V_{FB} + 2\\phi_F - \\frac{Q_{dep,th}}{C_{ox}}$$\nThis equation serves as the definition of the threshold voltage under this model.\n\nNext, we analyze the device in the strong inversion regime, where $V_G > V_{th}$. The problem states we must use two critical approximations for this regime:\n1.  **Charge-sheet approximation:** The inversion layer is treated as an infinitesimally thin sheet of charge, $Q_{inv}$, located at the Si-SiO$_2$ interface.\n2.  **Surface potential pinning:** The surface potential, $\\psi_s$, is assumed to saturate or \"pin\" at a value very close to its value at threshold. That is, for $V_G > V_{th}$, we assume $\\psi_s \\approx 2\\phi_F$.\n\nThe physical basis for surface potential pinning is that once a strong inversion layer is formed, any further increase in gate voltage is highly effectively screened by the mobile electrons. These electrons form a conductive layer that pins the semiconductor surface potential, causing the additional voltage to drop almost entirely across the oxide.\n\nUnder this pinning approximation, the depletion region width ceases to grow significantly with increasing $V_G > V_{th}$. Consequently, the depletion charge also remains approximately constant at its value at threshold: $Q_{dep} \\approx Q_{dep,th}$.\n\nApplying these strong inversion approximations to the general voltage balance equation gives:\n$$V_G \\approx V_{FB} + 2\\phi_F - \\frac{Q_{inv} + Q_{dep,th}}{C_{ox}} \\quad (\\text{for } V_G > V_{th})$$\nWe now have two equations: one for $V_{th}$ and one for $V_G$ in strong inversion. To find an expression for $Q_{inv}$, we subtract the equation for $V_{th}$ from the equation for $V_G$:\n$$V_G - V_{th} \\approx \\left( V_{FB} + 2\\phi_F - \\frac{Q_{inv} + Q_{dep,th}}{C_{ox}} \\right) - \\left( V_{FB} + 2\\phi_F - \\frac{Q_{dep,th}}{C_{ox}} \\right)$$\nThe terms $V_{FB}$, $2\\phi_F$, and $Q_{dep,th}/C_{ox}$ cancel out, leaving a remarkably simple relationship:\n$$V_G - V_{th} \\approx -\\frac{Q_{inv}}{C_{ox}}$$\nSolving for the inversion charge density, $Q_{inv}$:\n$$Q_{inv} \\approx -C_{ox}(V_G - V_{th})$$\nUsing the definition of the overdrive voltage, $V_{ov} = V_G - V_{th}$, the final expression is:\n$$Q_{inv}(V_G) = -C_{ox}V_{ov}$$\nThis expression is valid for $V_G > V_{th}$ (or $V_{ov} > 0$). The negative sign confirms that the inversion charge is composed of electrons, as expected for a p-type substrate.\n\nThe physical role of the overdrive voltage, $V_{ov}$, is now clear from the derivation. The total gate voltage $V_G$ can be conceptually split into two parts. The first part, equal to the threshold voltage $V_{th}$, is the voltage required to overcome the flatband condition, bend the bands by $2\\phi_F$, and establish the threshold depletion charge. The second part, the overdrive voltage $V_{ov}$, is the \"excess\" voltage beyond the threshold condition. This excess voltage drops almost entirely across the gate oxide and is directly responsible for inducing the mobile inversion charge $Q_{inv}$. The relationship $V_{ov} \\approx -Q_{inv}/C_{ox}$ shows that the overdrive voltage and the inversion charge form a parallel-plate capacitor relationship with the oxide capacitance $C_{ox}$, justifying the initial assumption that incremental voltage above $V_{th}$ primarily drops across the oxide. The overdrive voltage is thus the direct control parameter for the channel charge density in a MOSFET operating in strong inversion.",
            "answer": "$$\n\\boxed{-C_{ox}V_{ov}}\n$$"
        },
        {
            "introduction": "While introductory models often assume uniform substrate doping for analytical simplicity, real-world semiconductor devices employ complex, non-uniform doping profiles to optimize performance. This advanced practice challenges you to step beyond idealized scenarios and develop a robust numerical model for the depletion region. You will first derive the generalized integral equations for depletion width ($W_d$) and charge ($Q_d$), and then implement a numerical solver, a task that closely mirrors the methods used in modern technology computer-aided design (TCAD) tools. ",
            "id": "4283757",
            "problem": "Consider a one-dimensional Metal-Oxide-Semiconductor (MOS) capacitor with a p-type silicon substrate. Let the coordinate $x$ denote the depth into the semiconductor, with $x=0$ at the semiconductor-oxide interface and $x \\ge 0$ extending into the silicon. Under depletion conditions and within the depletion approximation, assume that mobile carrier densities are negligible for $0 \\le x \\le W_d$, where $W_d$ is the depletion width, and that the space charge density in this region is due solely to ionized acceptors described by a non-uniform acceptor density profile $N_A(x)$. Let the electrostatic potential be $\\psi(x)$, the electric field be $E(x)$, the silicon permittivity be $\\varepsilon_s$, and the elementary charge be $q$. The surface potential is $\\psi_s = \\psi(0)$, and the neutral bulk is at $\\psi(W_d)$, which can be taken as the reference $\\psi(W_d)=0$.\n\nStarting only from the one-dimensional Poisson equation, $d^2 \\psi/dx^2 = - \\rho(x)/\\varepsilon_s$, the depletion approximation definition of $\\rho(x)$ in a p-type semiconductor under depletion, and the boundary condition that $E(W_d)=0$, do the following:\n\n1. Derive an integral equation that $W_d$ must satisfy in terms of $N_A(x)$, $\\varepsilon_s$, $q$, and $\\psi_s$.\n2. Derive an expression for the total semiconductor space charge per unit area $Q_d$ in terms of $N_A(x)$ and $W_d$, specifying the sign convention such that $Q_d$ is negative under depletion in a p-type substrate.\n\nThen, design and implement a numerical scheme that, given $N_A(x)$ and a specified $\\psi_s$, computes $W_d$ and $Q_d$. Your numerical method must be based on:\n- Solving the derived nonlinear equation for $W_d$ using a robust root-bracketing and root-finding method that does not assume closed-form solutions for arbitrary $N_A(x)$.\n- Evaluating integrals that involve $N_A(x)$ using numerical quadrature.\n\nUse the following physical constants for silicon:\n- $\\varepsilon_s = 11.7 \\times \\varepsilon_0$, where $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$.\n- $q = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$.\n\nYour program must solve for $W_d$ (in meters) and $Q_d$ (in coulombs per square meter) for each of the test cases specified below. In all cases, assume temperature effects enter only through the prescribed $\\psi_s$ values; do not compute $\\psi_s$ from intrinsic carrier concentrations.\n\nTest Suite (each case provides a specific $N_A(x)$ and $\\psi_s$):\n\n- Case 1 (Uniform doping, moderate depletion):\n  - $N_A(x) = 5.0 \\times 10^{22} \\ \\mathrm{m^{-3}}$ for all $x \\ge 0$.\n  - $\\psi_s = 0.6 \\ \\mathrm{V}$.\n\n- Case 2 (Linearly graded doping):\n  - $N_A(x) = N_0 + a x$ with $N_0 = 1.0 \\times 10^{22} \\ \\mathrm{m^{-3}}$ and $a = 5.0 \\times 10^{28} \\ \\mathrm{m^{-4}}$.\n  - $\\psi_s = 0.4 \\ \\mathrm{V}$.\n\n- Case 3 (Exponential tail plus background):\n  - $N_A(x) = N_0 \\exp(-x/\\lambda) + N_1$ with $N_0 = 4.0 \\times 10^{22} \\ \\mathrm{m^{-3}}$, $N_1 = 1.0 \\times 10^{22} \\ \\mathrm{m^{-3}}$, and $\\lambda = 5.0 \\times 10^{-8} \\ \\mathrm{m}$.\n  - $\\psi_s = 0.8 \\ \\mathrm{V}$.\n\n- Case 4 (Piecewise step profile):\n  - $$N_A(x) = \n    \\begin{cases}\n      N_s,  0 \\le x  x_j \\\\\n      N_b,  x \\ge x_j\n    \\end{cases}$$\n    with $N_s = 1.0 \\times 10^{23} \\ \\mathrm{m^{-3}}$, $N_b = 5.0 \\times 10^{21} \\ \\mathrm{m^{-3}}$, and $x_j = 3.0 \\times 10^{-8} \\ \\mathrm{m}$.\n  - $\\psi_s = 0.3 \\ \\mathrm{V}$.\n\n- Case 5 (Small-signal depletion with uniform doping):\n  - $N_A(x) = 1.0 \\times 10^{22} \\ \\mathrm{m^{-3}}$ for all $x \\ge 0$.\n  - $\\psi_s = 0.01 \\ \\mathrm{V}$.\n\nNumerical and output requirements:\n- For each case, compute $W_d$ in meters and $Q_d$ in coulombs per square meter.\n- Express $W_d$ in $\\mathrm{m}$ and $Q_d$ in $\\mathrm{C/m^2}$.\n- Format each numerical result as a floating-point value in scientific notation with exactly six significant digits (for example, $1.234000 \\times 10^{-03}$ must be output as the string \"1.234000e-03\").\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[W_{d,1},Q_{d,1},W_{d,2},Q_{d,2},W_{d,3},Q_{d,3},W_{d,4},Q_{d,4},W_{d,5},Q_{d,5}]$.\n\nAll computations must be performed using only the specified constants and the given $N_A(x)$ and $\\psi_s$ values. Do not use any pre-derived closed-form formulas for $W_d$ or $Q_d$ beyond what you derive from the fundamental laws described. Ensure numerical robustness by bracketing roots and handling integration accurately.",
            "solution": "The problem requires the derivation of integral equations for the depletion width $W_d$ and total space charge $Q_d$ in a p-type MOS capacitor under the depletion approximation, and a subsequent numerical solution for several acceptor doping profiles $N_A(x)$. The derivation begins with the one-dimensional Poisson's equation.\n\n### 1. Derivation of the Governing Equations\n\nThe analysis starts from the one-dimensional Poisson's equation for the electrostatic potential $\\psi(x)$ in the semiconductor:\n$$\n\\frac{d^2 \\psi}{dx^2} = - \\frac{\\rho(x)}{\\varepsilon_s}\n$$\nwhere $x$ is the depth into the semiconductor from the interface at $x=0$, $\\rho(x)$ is the space charge density, and $\\varepsilon_s$ is the silicon permittivity.\n\nUnder the depletion approximation for a p-type substrate, the space charge in the depletion region ($0 \\le x \\le W_d$) is assumed to consist solely of ionized (negative) acceptor atoms. The mobile hole concentration is considered negligible in this region. The charge of an ionized acceptor is $-q$, where $q$ is the elementary charge. Thus, the space charge density is given by:\n$$\n\\rho(x) =\n\\begin{cases}\n    -q N_A(x),  0 \\le x \\le W_d \\\\\n    0,  x  W_d\n\\end{cases}\n$$\nSubstituting this into Poisson's equation for the depletion region yields:\n$$\n\\frac{d^2 \\psi}{dx^2} = \\frac{q N_A(x)}{\\varepsilon_s} \\quad \\text{for } 0 \\le x \\le W_d\n$$\n\n#### 1.1 Electric Field and Potential\nThe electric field $E(x)$ is related to the potential by $E(x) = -d\\psi/dx$. Differentiating this gives $dE/dx = -d^2\\psi/dx^2$. Using Poisson's equation, we get:\n$$\n\\frac{dE}{dx} = -\\frac{q N_A(x)}{\\varepsilon_s}\n$$\nTo find the electric field $E(x)$, we integrate this equation from a point $x$ within the depletion region to the edge of the depletion region at $x=W_d$:\n$$\n\\int_x^{W_d} \\frac{dE}{dx'} dx' = -\\frac{q}{\\varepsilon_s} \\int_x^{W_d} N_A(x') dx'\n$$\nThis gives $E(W_d) - E(x) = -\\frac{q}{\\varepsilon_s} \\int_x^{W_d} N_A(x') dx'$. A key boundary condition of the depletion approximation is that the electric field vanishes at the edge of the neutral bulk, so $E(W_d)=0$. This simplifies the expression for $E(x)$ to:\n$$\nE(x) = \\frac{q}{\\varepsilon_s} \\int_x^{W_d} N_A(x') dx'\n$$\nTo find the potential $\\psi(x)$, we integrate $d\\psi/dx = -E(x)$ from the surface at $x=0$ to a general point $x'$ in the semiconductor bulk, using the boundary condition $\\psi(W_d)=0$ as the reference potential. It is more direct to integrate from $x=0$ to $x=W_d$:\n$$\n\\int_0^{W_d} \\frac{d\\psi}{dx} dx = \\psi(W_d) - \\psi(0) = -\\int_0^{W_d} E(x) dx\n$$\nSubstituting the expression for $E(x)$ and applying the boundary conditions $\\psi(0)=\\psi_s$ and $\\psi(W_d)=0$:\n$$\n0 - \\psi_s = -\\int_0^{W_d} \\left( \\frac{q}{\\varepsilon_s} \\int_x^{W_d} N_A(x') dx' \\right) dx\n$$\n$$\n\\psi_s = \\frac{q}{\\varepsilon_s} \\int_0^{W_d} \\int_x^{W_d} N_A(x') dx' dx\n$$\nThis double integral can be simplified by changing the order of integration. The integration domain is a triangle in the $(x, x')$ plane defined by $0 \\le x \\le W_d$ and $x \\le x' \\le W_d$. This is equivalent to integrating over $0 \\le x' \\le W_d$ and $0 \\le x \\le x'$.\n$$\n\\psi_s = \\frac{q}{\\varepsilon_s} \\int_0^{W_d} N_A(x') \\left( \\int_0^{x'} dx \\right) dx' = \\frac{q}{\\varepsilon_s} \\int_0^{W_d} x' N_A(x') dx'\n$$\n\n#### 1.2 Integral Equation for Depletion Width $W_d$\nReplacing the dummy integration variable $x'$ with $x$, we arrive at the first required result: an integral equation that relates the surface potential $\\psi_s$ to the depletion width $W_d$.\n$$\n\\psi_s = \\frac{q}{\\varepsilon_s} \\int_0^{W_d} x N_A(x) dx\n$$\nFor a given $\\psi_s$ and $N_A(x)$, this is a nonlinear equation for the unknown $W_d$.\n\n#### 1.3 Total Semiconductor Space Charge $Q_d$\nThe second required result is the total semiconductor space charge per unit area, $Q_d$. This is obtained by integrating the charge density $\\rho(x)$ from the surface to the edge of the depletion region:\n$$\nQ_d = \\int_0^{W_d} \\rho(x) dx = \\int_0^{W_d} -q N_A(x) dx\n$$\nThis gives the expression for $Q_d$ in terms of $N_A(x)$ and the (now determined) depletion width $W_d$:\n$$\nQ_d = -q \\int_0^{W_d} N_A(x) dx\n$$\nThis expression is inherently negative for positive $N_A(x)$, consistent with the charge of ionized acceptors in a p-type substrate.\n\n### 2. Numerical Implementation Strategy\n\nThe problem requires a numerical scheme to solve for $W_d$ and $Q_d$ for arbitrary $N_A(x)$.\n\n#### 2.1 Solving for $W_d$\nThe integral equation for $W_d$ can be written as a root-finding problem for the function $f(W_d)$:\n$$\nf(W_d) = \\left( \\frac{q}{\\varepsilon_s} \\int_0^{W_d} x N_A(x) dx \\right) - \\psi_s = 0\n$$\nSince $q$, $\\varepsilon_s$, $x$, and $N_A(x)$ are all positive, the integral term is a monotonically increasing function of its upper limit $W_d$. Therefore, $f(W_d)$ is a monotonically increasing function of $W_d$. At $W_d=0$, $f(0) = -\\psi_s  0$. For a sufficiently large $W_d$, $f(W_d)$ will become positive. This guarantees the existence of a unique positive root for $W_d$.\n\nA robust numerical method for this problem combines root bracketing with an efficient root-finding algorithm. The `brentq` method from the SciPy library is ideal as it is guaranteed to find a root within a given bracket $[a, b]$ where $f(a)$ and $f(b)$ have opposite signs.\nThe numerical algorithm is as follows:\n1.  Define the function $f(W_d)$ as shown above. The integral within $f(W_d)$ will be computed using a numerical quadrature routine, specifically `scipy.integrate.quad`.\n2.  Establish a search bracket $[a, b]$ for the root $W_d$. A small positive value, e.g., $a = 10^{-12}$ m, can serve as the lower bound. An upper bound $b$ can be found by starting with a reasonable guess (e.g., $10^{-9}$ m) and exponentially increasing it until $f(b)  0$.\n3.  Use `scipy.optimize.brentq` with the function $f(W_d)$ and the bracket $[a, b]$ to solve for the root $W_d$ with high precision.\n\n#### 2.2 Calculating $Q_d$\nOnce the value of $W_d$ is determined, the total space charge $Q_d$ is calculated by numerically evaluating its defining integral:\n$$\nQ_d = -q \\int_0^{W_d} N_A(x) dx\n$$\nAgain, `scipy.integrate.quad` is used for this computation.\n\n#### 2.3 Handling Piecewise $N_A(x)$\nFor cases where $N_A(x)$ is a piecewise function, such as Case 4, it is crucial to inform the numerical integrator about the points of discontinuity to ensure accuracy. The `points` argument of `scipy.integrate.quad` is used for this purpose, with the list of discontinuity points passed to it.\n\nThis overall strategy is general and does not rely on any closed-form analytical solutions for specific choices of $N_A(x)$, fulfilling the problem's requirements. The use of established, high-quality numerical routines from SciPy ensures both robustness and accuracy.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Solves for the depletion width (Wd) and semiconductor space charge (Qd)\n    for a MOS capacitor with various p-type doping profiles using the depletion\n    approximation.\n    \"\"\"\n\n    # Physical Constants\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity (F/m)\n    EPSILON_S = 11.7 * EPSILON_0   # Silicon permittivity (F/m)\n    Q = 1.602176634e-19          # Elementary charge (C)\n\n    # Test Suite Definition\n    # Each case is a tuple: (N_A(x) function, surface potential psi_s, discontinuity points)\n    test_cases = [\n        # Case 1: Uniform doping\n        (lambda x: 5.0e22, 0.6, None),\n\n        # Case 2: Linearly graded doping\n        (lambda x: 1.0e22 + 5.0e28 * x, 0.4, None),\n\n        # Case 3: Exponential tail\n        (lambda x: 4.0e22 * np.exp(-x / 5.0e-8) + 1.0e22, 0.8, None),\n\n        # Case 4: Piecewise step profile\n        ((lambda ns, nb, xj: lambda x: ns if x  xj else nb)(1.0e23, 5.0e21, 3.0e-8),\n         0.3, [3.0e-8]),\n\n        # Case 5: Small-signal uniform doping\n        (lambda x: 1.0e22, 0.01, None)\n    ]\n    \n    results = []\n\n    for N_A_func, psi_s, points in test_cases:\n\n        # --- 1. Solve for Depletion Width (Wd) ---\n\n        # Define the function whose root we need to find: f(Wd) = 0\n        def f_Wd(Wd):\n            if Wd = 0:\n                return -psi_s\n            \n            # Integrand for the potential equation: x * N_A(x)\n            integrand_psi = lambda x: x * N_A_func(x)\n            \n            # Numerical integration using quad\n            integral_val, _ = integrate.quad(\n                integrand_psi, 0, Wd, points=points)\n            \n            return (Q / EPSILON_S) * integral_val - psi_s\n\n        # Find a bracket [a, b] for the root Wd such that f(a)  0 and f(b)  0\n        a = 1e-12  # Lower bound, small positive number\n        b = 1e-9   # Initial guess for upper bound\n\n        # Exponentially increase upper bound until it brackets the root\n        for _ in range(20): # Max 20 steps to prevent infinite loop\n            if f_Wd(b)  0:\n                break\n            b *= 10\n        else:\n            raise RuntimeError(f\"Could not find an upper bracket for Wd for psi_s={psi_s}\")\n\n        # Solve for Wd using Brent's method, a robust root-finding algorithm\n        Wd = optimize.brentq(f_Wd, a, b)\n\n        # --- 2. Calculate Semiconductor Charge (Qd) ---\n        \n        # Integrand for the charge equation: N_A(x)\n        integrand_Qd = N_A_func\n        \n        # Numerical integration\n        integral_val_Qd, _ = integrate.quad(\n            integrand_Qd, 0, Wd, points=points)\n            \n        Qd = -Q * integral_val_Qd\n        \n        # --- 3. Format and store results ---\n        # Format as scientific notation with 6 digits after the decimal point\n        # This matches the example \"1.234000e-03\" (7 significant digits).\n        Wd_str = f\"{Wd:.6e}\"\n        Qd_str = f\"{Qd:.6e}\"\n        \n        results.append(Wd_str)\n        results.append(Qd_str)\n\n    # Print the final comma-separated list of results\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}