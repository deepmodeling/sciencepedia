## 引言
[单级放大器](@entry_id:263914)是[模拟集成电路设计](@entry_id:277019)的原子单元，是构建从[运算放大器](@entry_id:263966)到复杂射频收发机等一切系统的基石。然而，仅仅掌握共源、共栅、共漏拓扑的孤立公式，与能够灵活运用它们解决实际工程问题之间存在着巨大的鸿沟。设计师常常面临着在增益、带宽、功耗、阻抗和噪声等相互冲突的性能指标之间进行艰难权衡的挑战。本文旨在填补这一知识鸿沟，将理论与实践紧密结合。在接下来的章节中，我们将首先在“原理与机制”部分深入剖析这三种基本拓扑的第一性原理，系统地建立起对它们性能特征的深刻理解。随后，在“应用与跨学科连接”部分，我们将展示这些基础模块如何在[高速通信](@entry_id:1126094)、传感器接口等多样化场景中被巧妙运用，并探讨现代IC设计方法学。最后，通过“动手实践”环节，您将有机会将所学知识应用于具体的电路设计问题，从而真正掌握从理论到系统应用的全过程。

## 原理与机制

本章将深入探讨构成几乎所有复杂[模拟集成电路](@entry_id:272824)基础的三种[单级放大器](@entry_id:263914)拓扑：共源极 (CS)、共栅极 (CG) 和共漏极 (CD) 放大器。我们将从第一性原理出发，系统地分析每种拓扑的核心性能指标，包括[电压增益](@entry_id:266814)、输入/输出阻抗、频率响应和[输出摆幅](@entry_id:260991)。此外，我们还将讨论负载选择、晶体管[工作点](@entry_id:173374)等对放大器性能有深远影响的实际设计考量。

### 共源极 (CS) 放大器

[共源极放大器](@entry_id:265648)是三种拓扑中最常用的一种，类似于双极晶体管的[共射极放大器](@entry_id:275826)。其输入信号施加于栅极，输出信号取自漏极，而源极通常连接到固定电位（交流地）。这种配置因其能够提供显著的[电压增益](@entry_id:266814)而成为放大电路的基石。

#### 增益、负载与[输出摆幅](@entry_id:260991)

[共源极放大器](@entry_id:265648)的中频小信号[电压增益](@entry_id:266814) $A_v$ 可表示为：

$A_v = -g_m R_{\text{out}}$

其中，$g_m$ 是晶体管的[跨导](@entry_id:274251)，$R_{\text{out}}$ 是在输出节点（漏极）看到的所有电阻并联后的等效电阻。这个负号表明[共源极放大器](@entry_id:265648)是一个[反相放大器](@entry_id:275864)。$R_{\text{out}}$ 的值由放大晶体管自身的输出电阻 $r_o$ 和连接在漏极的负载阻抗 $R_{load}$ 共同决定，即 $R_{\text{out}} = r_o \parallel R_{load}$。显而易见，为了获得高增益，我们需要一个高阻抗的负载。

在[集成电路设计](@entry_id:1126551)中，负载通常有两种实现方式：无[源电阻](@entry_id:263068)负载和有源[电流源](@entry_id:275668)负载。

1.  **电阻负载 (Resistive Load)**：将一个值为 $R_D$ 的电阻连接在漏极和电源 $V_{DD}$ 之间。此时，$R_{\text{out}} = r_o \parallel R_D$。为了获得高增益，需要较大的 $R_D$。然而，大的片上电阻不仅占用巨大的芯片面积，还会带来显著的静态[电压降](@entry_id:263648) ($I_D R_D$)，从而限制了输出电压的[静态工作点](@entry_id:264648)和动态范围（即[输出摆幅](@entry_id:260991)）。

2.  **[有源负载](@entry_id:262691) (Active Load)**：使用一个 p-MOSFET 构成的[电流源](@entry_id:275668)作为负载。这种负载的理想小信号阻抗是无穷大，而实际上的小信号阻抗是其自身的输出电阻 $r_{o,p}$。此时，$R_{\text{out}} = r_{o,n} \parallel r_{o,p}$（其中 $r_{o,n}$ 是放大 n-MOSFET 的输出电阻）。由于晶体管的[输出电阻](@entry_id:276800)通常远大于实际可行的片上电阻值，[有源负载](@entry_id:262691)能够提供远高于电阻负载的[电压增益](@entry_id:266814)。

尽管[有源负载](@entry_id:262691)在增益方面优势明显，但它也带来了[输出摆幅](@entry_id:260991)上的限制 。放大器的输出电压范围受限于保证放大管和负载管都工作在饱和区的条件。
-   **输出下限 $V_{O,\min}$**：由放大 n-MOSFET 决定，为使其保持饱和，漏源电压 $V_{DS,n}$ 必须不小于其过驱动电压 $V_{OV,n}$。由于源极接地，这意味着 $V_O \ge V_{OV,n}$。因此，$V_{O,\min} = V_{OV,n}$。这个限制对两种负载是相同的。
-   **输出上限 $V_{O,\max}$**：由负载决定。对于电阻负载，理论上的输出上限可以达到电源电压 $V_{DD}$。但对于[有源负载](@entry_id:262691)，p-MOSFET 负载管也必须保持饱和，其源漏电压 $V_{SD,p}$ 必须不小于其[过驱动电压](@entry_id:272139)的绝对值 $|V_{OV,p}|$。这意味着 $V_{DD} - V_O \ge |V_{OV,p}|$，即 $V_O \le V_{DD} - |V_{OV,p}|$。因此，$V_{O,\max} = V_{DD} - |V_{OV,p}|$。

总结而言，与电阻负载相比，[有源负载](@entry_id:262691)以牺牲部分[输出电压摆幅](@entry_id:263071)为代价，换取了极大的[电压增益](@entry_id:266814)和更小的芯片面积。在固定的[静态电流](@entry_id:275067) $I_D$ 下，两者的[静态功耗](@entry_id:174547) $P_{DC} = V_{DD} I_D$ 是相同的。

此外，放大晶体管自身的有限输出电阻 $r_o$ 始终是增益的上限。即使负载阻抗趋于无穷大，最大增益也无法超过 $g_m r_o$，这个值被称为晶体管的 **[本征增益](@entry_id:1133298) (intrinsic gain)**。在实际计算中，有限的 $r_o$ 会使增益低于理想情况（$r_o \to \infty$）。我们可以通过一个偏差因子 $\Delta$ 来量化这种影响 。对于一个带有等效负载 $R'_{L} = R_D \parallel R_L$ 的CS级，其增益偏差为 $\Delta_{\text{CS}} = -\frac{R'_{L}}{r_o + R'_{L}}$，这表明 $r_o$ 越小，增益的衰减越严重。

#### 输出阻抗与[源极负反馈](@entry_id:260703)

在基本共源极结构中，输出阻抗 $R_{\text{out}}$ 就是负载阻抗与晶体管自身输出电阻 $r_o$ 的并联。然而，通过在源极引入一个电阻 $R_S$（即**[源极负反馈](@entry_id:260703)**或**源极简并**），我们可以显著地改变放大器的特性，尤其是其输出阻抗。

当我们从漏极向内看，计算包含源极电阻 $R_S$ 的晶体管的输出阻抗时，我们会发现一个称为“阻抗提升”的现象 。通过施加测试电压进行[小信号分析](@entry_id:263462)，可以推导出从漏极看进去的阻抗为：

$R_{\text{out, M1}} = r_{o1} + R_S + (g_m + g_{mb}) r_{o1} R_S$

这里 $g_{mb}$ 是体跨导，源于体效应。这个表达式清晰地表明，输出阻抗不再仅仅是 $r_{o1}$，而是被一个巨大的因子 $1 + (g_m + g_{mb}) R_S$ 和一个附加项 $R_S$ 所提升。这个因子通常远大于1。这种通过负反馈来提高输出阻抗的技术是 **cascode (共源共栅)** 结构的核心思想，它被广泛用于构建[高增益放大器](@entry_id:274020)和高精度电流镜。

#### 频率响应与米勒效应

在较高频率下，MOSFET 的内部[寄生电容](@entry_id:270891)开始影响放大器的性能。其中最关键的是栅源电容 $C_{gs}$ 和栅漏电容 $C_{gd}$。对于[共源极放大器](@entry_id:265648)，$C_{gd}$ 连接了输入端（栅极）和输出端（漏极）。由于该放大器具有很大的反相增益 $A_v$，这个电容的效应会被显著放大，这种现象被称为 **米勒效应 (Miller effect)** 。

在输入端看到的等效输入电容 $C_{in}$ 可以通过分析流入栅极的电流来推导。流入栅极的总电流是流过 $C_{gs}$ 和 $C_{gd}$ 的电流之和：

$i_{in} = i_{gs} + i_{gd} = j\omega C_{gs} v_g + j\omega C_{gd} (v_g - v_d)$

其中 $v_g$ 和 $v_d$ 分别是栅极和漏极的小信号电压。利用[电压增益](@entry_id:266814)的定义 $A_v = v_d / v_g$，我们可以将上式重写为：

$i_{in} = j\omega [C_{gs} + C_{gd}(1 - A_v)] v_g$

因此，等效输入电容为：

$C_{in} = C_{gs} + C_{gd}(1 - A_v)$

由于[共源极放大器](@entry_id:265648)的增益 $A_v$ 是一个大的负数（例如 -50），$(1 - A_v)$ 因子会变得非常大（例如 51）。这导致原本很小的栅漏电容 $C_{gd}$ 在输入端被放大为数十倍甚至上百倍的[等效电容](@entry_id:274130)。这个巨大的米勒电容与信号源的[输出电阻](@entry_id:276800) $R_{\text{sig}}$ 形成一个低通滤波器，其[极点频率](@entry_id:262343) $\omega_p = 1/(R_{\text{sig}} C_{in})$ 通常很低，从而成为限制整个[放大器带宽](@entry_id:264064)的**主导极点** 。米勒效应是[共源极放大器](@entry_id:265648)高频性能的主要瓶颈。

### 共栅极 (CG) 放大器

在共栅极配置中，输入信号施加于源极，输出取自漏极，而栅极连接到交流地。这种拓扑的特性与[共源极放大器](@entry_id:265648)截然不同，使其在特定应用中非常有用，例如作为[电流缓冲器](@entry_id:264846)或在宽带放大器中。

#### 输入阻抗与[电压增益](@entry_id:266814)

[共栅极放大器](@entry_id:270610)最显著的特点是其**低输入阻抗**。从源极向内看，[输入阻抗](@entry_id:271561) $Z_{in,s}$ 的精确表达式为 ：

$Z_{in,s} = \frac{Z_L + r_o}{1 + (g_m + g_{mb})r_o}$

其中 $Z_L$ 是漏极的总负载阻抗。在一个常见的近似下，当 $g_m r_o \gg 1$ 时，这个表达式可以简化为：

$Z_{in,s} \approx \frac{1}{g_m + g_{mb}}$

这个低输入阻抗（通常在几百欧姆到几千欧姆的范围内）使得[共栅极放大器](@entry_id:270610)非常适合接收一个电流信号，因为它能以很小的输入电压变化“吸收”这个电流。因此，它常被称为**[电流缓冲器](@entry_id:264846)**。

[共栅极放大器](@entry_id:270610)的[电压增益](@entry_id:266814)是**非反相的**，其表达式与[共源极放大器](@entry_id:265648)类似 。当考虑有限的 $r_o$ 时，增益为：

$A_{v, \text{CG}} = \frac{(g_m r_o + 1)(R_D \parallel R_L)}{r_o + (R_D \parallel R_L)}$

在理想情况下 ($r_o \to \infty$)，增益简化为 $A_{v, \text{CG}} \approx g_m (R_D \parallel R_L)$，其大小与[共源极放大器](@entry_id:265648)相同，但符号为正。

#### 输出阻抗

与低输入阻抗形成鲜明对比的是，[共栅极放大器](@entry_id:270610)的**[输出阻抗](@entry_id:265563)非常高**。当我们计算从漏极看进去的输出阻抗，同时源极通过一个电阻 $R_S$ 接地时（这代表了驱动源的[输出电阻](@entry_id:276800)），得到的表达式与前面讨论的带[源极负反馈](@entry_id:260703)的[共源极放大器](@entry_id:265648)完全相同 ：

$R_{\text{out}} = r_o + R_S + (g_m + g_{mb}) r_o R_S$

这种固有的高[输出阻抗](@entry_id:265563)是其作为 cascode 结构中“cascoding”晶体管的理想选择的原因之一。它能有效地隔离负载与驱动级，并显著提高整个放大器的输出阻抗和增益。

#### 频率响应

[共栅极放大器](@entry_id:270610)的另一个关键优势在于其出色的高频性能。在共栅极配置中，栅极处于交流地。因此，关键的[寄生电容](@entry_id:270891) $C_{gd}$ 连接在输出节点（漏极）和地之间，而 $C_{gs}$ 连接在输入节点（源极）和地之间。没有任何电容直接桥接输入和输出节点 。

由于缺乏输入-输出间的[耦合电容](@entry_id:272721)，[共栅极放大器](@entry_id:270610)**不存在米勒效应**。输入和输出极点被有效[解耦](@entry_id:160890)，并且通常位于比[共源极放大器](@entry_id:265648)的主导极点高得多的频率上。这使得[共栅极放大器](@entry_id:270610)成为射频 (RF) 和其他宽带应用中的首选拓扑。

### 共漏极 (CD) 放大器 ([源极跟随器](@entry_id:276896))

[共漏极放大器](@entry_id:270960)，更广为人知的名字是**[源极跟随器](@entry_id:276896)**，其输入施加于栅极，输出取自源极，而漏极则连接到交流地。它的功能类似于双极晶体管的[射极跟随器](@entry_id:272066)，主要用作[电压缓冲器](@entry_id:272622)。

#### [电压增益](@entry_id:266814)与体效应

[源极跟随器](@entry_id:276896)的核心特性是其[电压增益](@entry_id:266814)**约等于 1 且为正**。输出电压（源极电压）几乎精确地“跟随”输入电压（栅极电压）。其精确的增益表达式为 ：

$A_{v, \text{CD}} = \frac{g_m}{g_m + g_{mb} + 1/r_o + 1/R_L}$

这里我们已经包含了体效应 ($g_{mb}$)，因为在[源极跟随器](@entry_id:276896)中，源极电压 $V_S$ 会变化，导致源极-衬底电压 $V_{SB}$ 不为零，体效应不可避免。从表达式可以看出，增益总是小于 1。

体效应是限制[源极跟随器](@entry_id:276896)性能的一个重要因素 。体跨导 $g_{mb}$ 的存在使得分母变大，从而使增益进一步偏离理想值 1。忽略体效应所带来的[增益误差](@entry_id:263104) $\varepsilon = (A_{v,0} - A_v) / A_v$（其中 $A_{v,0}$ 是不考虑 $g_{mb}$ 时的增益）可以表示为 $\varepsilon = \frac{g_{mb}}{g_m + g_L}$ (其中 $g_L = 1/R_L$)。由于 $g_{mb}$ 本身是 $V_{SB}$ 的函数，体效应的影响会随着输出直流电压电平的升高而变化，这对设计精确的缓冲器构成了挑战。

#### 输出与[输入阻抗](@entry_id:271561)

[源极跟随器](@entry_id:276896)的主要用途源于其独特的阻抗特性：**极高的[输入阻抗](@entry_id:271561)和极低的输出阻抗**。

-   **输入阻抗**：由于输入信号施加于栅极，在低频和中频段，输入端近似为开路，因此输入阻抗非常高。这使得它能够连接到高阻抗信号源而不会产生明显的[负载效应](@entry_id:262341)。

-   **输出阻抗**：从源极向内看，[输出阻抗](@entry_id:265563)非常低。精确的推导  给出的结果是：

    $Z_{\text{out}} = \frac{1}{g_{m} + g_{mb} + g_{ds} + 1/R_L} = r_o \parallel R_L \parallel \frac{1}{g_m + g_{mb}}$

    通常，$g_m$ 和 $g_{mb}$ 的值很大，所以输出阻抗可以近似为 $Z_{\text{out}} \approx \frac{1}{g_m + g_{mb}}$。这个值通常很小（几十到几百欧姆），意味着[源极跟随器](@entry_id:276896)可以有效地驱动低阻抗负载，而不会有显著的电压损失。

### 工作点选择与[跨导效率](@entry_id:269674)

到目前为止，我们的分析都基于小信号参数 $g_m$ 和 $r_o$。然而，这些参数的值本身是由晶体管的直流偏置（即工作点）决定的。通过选择不同的偏置电流 $I_D$ 和栅源电压 $V_{GS}$，我们可以让晶体管工作在不同的反型区，这对其性能有着根本性的影响。其中，**[跨导效率](@entry_id:269674) ($g_m/I_D$)** 是衡量在给定功耗下晶体管产生增益能力的黄金指标 。

#### 弱反型与强反型工作区

MOSFET 的工作区可大致分为两个主要区域：

-   **[强反型](@entry_id:276839) (Strong Inversion)**：当 $V_{GS}$ 远大于阈值电压 $V_{TH}$ 时，沟道中形成密集的反型层。其[电流-电压关系](@entry_id:163680)近似为平方律：$I_D \propto (V_{GS} - V_{TH})^2$。
-   **[弱反型](@entry_id:272559) (Weak Inversion)** 或亚阈值区：当 $V_{GS}$ 略低于 $V_{TH}$ 时，沟道中的电流主要是扩散电流。其[电流-电压关系](@entry_id:163680)呈指数形式，类似于双极晶体管：$I_D \propto \exp\left(\frac{V_{GS}}{nU_T}\right)$，其中 $U_T = kT/q$ 是热电压，$n$ 是亚阈值斜率因子。

#### [跨导效率](@entry_id:269674) $g_m/I_D$

通过对不同区域的 $I_D-V_{GS}$ 关系求导，我们可以得到 $g_m$ 并计算[跨导效率](@entry_id:269674)：

-   在**弱反型**区，我们得到：
    $g_m = \frac{\partial I_D}{\partial V_{GS}} = \frac{I_D}{nU_T} \implies \frac{g_m}{I_D} = \frac{1}{nU_T}$
    在这个区域，[跨导效率](@entry_id:269674)是一个不依赖于电流的常数，其值在室温下可达约 $25 \, \text{V}^{-1}$。这是 MOSFET 所能达到的**理论最大[跨导效率](@entry_id:269674)**。

-   在**强反型**区，我们得到：
    $g_m = \frac{\partial I_D}{\partial V_{GS}} = \sqrt{2\beta I_D} = \frac{2I_D}{V_{OV}} \implies \frac{g_m}{I_D} = \frac{2}{V_{OV}}$
    其中 $V_{OV} = V_{GS} - V_{TH}$ 是过驱动电压。在这个区域，[跨导效率](@entry_id:269674)与过驱动电压成反比。由于 $V_{OV}$ 通常在 $100-200 \, \text{mV}$ 或更高，[强反型](@entry_id:276839)下的 $g_m/I_D$ 远低于[弱反型](@entry_id:272559)下的最大值。

#### 对放大器设计的启示

[跨导效率](@entry_id:269674)的差异为模拟电路设计提供了重要的权衡空间：

-   **功耗效率**：为了达到一个特定的 $g_m$ 值（例如，为了实现某个增益或输出阻抗），工作在[弱反型](@entry_id:272559)区的晶体管所需的[偏置电流](@entry_id:260952) $I_D$ 是最小的。因此，对于功耗极其敏感的应用，如医疗植入设备或无线传感器，[弱反型](@entry_id:272559)设计是首选。

-   **增益**：在相同的[偏置电流](@entry_id:260952) $I_D$ 下，工作在[弱反型](@entry_id:272559)的晶体管具有最高的 $g_m$，因此可以提供最高的[电压增益](@entry_id:266814)。

-   **噪声**：晶体管的主要噪声源之一——沟道热噪声——其等效输入电压噪声谱密度 $S_{e_n}$ 与 $1/g_m$ 成正比。因此，在固定电流下，工作在弱反型可以获得更高的 $g_m$，从而实现更低的[输入参考噪声](@entry_id:1126527)。

然而，这种高效率并非没有代价。[弱反型](@entry_id:272559)工作区的主要缺点是**速度**。由于[偏置电流](@entry_id:260952)非常小，晶体管对[寄生电容](@entry_id:270891)的充放电速度很慢，导致放大器的带宽显著降低。这构成了模拟设计中最核心的权衡之一：**增益-带宽-功耗 (Gain-Bandwidth-Power) 权衡**。设计师必须根据应用需求，在强反型（高速、低效率）和[弱反型](@entry_id:272559)（高效率、低速）以及介于两者之间的中等反型区之间，精心选择最优的[工作点](@entry_id:173374)。