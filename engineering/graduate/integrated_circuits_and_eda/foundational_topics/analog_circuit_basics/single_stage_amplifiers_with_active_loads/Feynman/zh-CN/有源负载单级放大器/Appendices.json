{
    "hands_on_practices": [
        {
            "introduction": "放大器的核心性能指标是其电压增益。本实践将引导你从基础的晶体管参数和偏置条件出发，计算一个采用有源负载的共源放大器的关键小信号参数。通过计算驱动管的跨导 $g_m$ 和总输出电阻 $r_o$，你将能够量化放大器的本征增益 $A_v$，并将其与设计目标进行比较 。这是理解放大器性能来源并进行初步设计的关键第一步。",
            "id": "4298294",
            "problem": "一个单级共源放大器采用互补金属氧化物半导体（CMOS）技术实现，并在电子设计自动化（EDA）框架下进行分析。放大器件是一个n沟道金属氧化物半导体场效应晶体管（MOSFET）$M_1$，带有一个p沟道MOSFET $M_2$作为有源负载，通过电流镜偏置来强制相等的漏极电流。两个晶体管都在强反型区工作，并在选定的偏置点下保持在饱和区。体效应可以忽略不计，垂直场引起的迁移率降低效应也被忽略；沟道长度调制通过基于厄利电压的参数化模型来考虑。\n\n给定偏置和工艺参数如下：\n- 漏极电流 $I_D = 100\\,\\mu\\mathrm{A}$ 由偏置网络建立，并流经 $M_1$ 和 $M_2$。\n- 工艺跨导参数为 $k_n' = \\mu_n C_{\\mathrm{ox}} = 350\\,\\mu\\mathrm{A}/\\mathrm{V}^2$ 和 $k_p' = \\mu_p C_{\\mathrm{ox}} = 80\\,\\mu\\mathrm{A}/\\mathrm{V}^2$。\n- 沟道长度调制使用厄利电压 $V_A$ 进行建模，该电压与沟道长度 $L$ 呈线性关系：$V_A = V_{A0}\\,(L/L_0)$，其中 $L_0 = 1\\,\\mu\\mathrm{m}$，对于 $M_1$ 有 $V_{A0,n} = 20\\,\\mathrm{V}$，对于 $M_2$ 有 $V_{A0,p} = 15\\,\\mathrm{V}$。\n- 器件几何尺寸：$M_1$ 的尺寸为 $W_1 = 20\\,\\mu\\mathrm{m}$ 和 $L_1 = 0.18\\,\\mu\\mathrm{m}$；$M_2$ 的尺寸为 $W_2 = 40\\,\\mu\\mathrm{m}$ 和 $L_2 = 0.50\\,\\mu\\mathrm{m}$。\n\n从基于漂移-扩散模型的MOSFET饱和区特性以及小信号定义 $g_m = \\partial I_D/\\partial V_{GS}$ (在 $V_{DS}$ 固定时) 和 $r_o = (\\partial I_D/\\partial V_{DS})^{-1}$ (在 $V_{GS}$ 固定时) 出发，计算：\n1. $M_1$ 的跨导 $g_m$。\n2. 放大器输出节点的小信号输出电阻 $r_o$（即 $M_1$ 的 $r_{o,n}$ 和 $M_2$ 的 $r_{o,p}$ 的并联）。\n3. 本征增益 $A_v = g_m\\,r_o$。\n\n将 $g_m$ 以 $\\mathrm{mS}$ 表示，将 $r_o$ 以 $\\mathrm{k}\\Omega$ 表示，$A_v$ 作为无量纲比率。将所有要求解的量四舍五入到四位有效数字。判断是否达到了至少为 $60$（单位 $\\mathrm{V}/\\mathrm{V}$）的目标本征增益，但最终报告的答案必须仅包含所要求的数值。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于已确立的MOSFET理论，提法明确且所有必要参数均已提供，并且陈述客观。不存在矛盾、歧义或不切实际的条件。因此，我们可以着手求解。\n\n该问题要求计算一个共源放大器的三个小信号参数：输入晶体管 $M_1$ 的跨导 $g_m$，该级的总小信号输出电阻 $r_o$，以及本征电压增益 $A_v$。\n\n1.  **计算 $M_1$ 的跨导 $g_m$**\n\n晶体管 $M_1$ 工作在饱和区。跨导 $g_m$ 可以用几个等效公式计算。在给定漏极电流 $I_D$、工艺跨导参数 $k_n'$ 和器件几何尺寸 $(W/L)$ 的情况下，最直接的公式是：\n$$g_{m1} = \\sqrt{2 k_n' \\left(\\frac{W_1}{L_1}\\right) I_D}$$\n$M_1$ 的给定参数为：\n- 漏极电流: $I_D = 100\\,\\mu\\mathrm{A} = 1 \\times 10^{-4}\\,\\mathrm{A}$\n- 工艺跨导参数: $k_n' = 350\\,\\mu\\mathrm{A}/\\mathrm{V}^2 = 3.5 \\times 10^{-4}\\,\\mathrm{A}/\\mathrm{V}^2$\n- 器件几何尺寸: $W_1 = 20\\,\\mu\\mathrm{m}$，$L_1 = 0.18\\,\\mu\\mathrm{m}$，所以宽高比为 $\\frac{W_1}{L_1} = \\frac{20\\,\\mu\\mathrm{m}}{0.18\\,\\mu\\mathrm{m}} = \\frac{20}{0.18}$。\n\n将这些值代入 $g_{m1}$ 的方程中：\n$$g_{m1} = \\sqrt{2 \\left(3.5 \\times 10^{-4}\\,\\frac{\\mathrm{A}}{\\mathrm{V}^2}\\right) \\left(\\frac{20}{0.18}\\right) \\left(1 \\times 10^{-4}\\,\\mathrm{A}\\right)}$$\n$$g_{m1} = \\sqrt{2 \\times 3.5 \\times \\frac{20}{0.18} \\times 10^{-8}}\\,\\mathrm{S} = \\sqrt{\\frac{140}{0.18} \\times 10^{-8}}\\,\\mathrm{S} \\approx \\sqrt{777.77... \\times 10^{-8}}\\,\\mathrm{S}$$\n$$g_{m1} \\approx 2.788866 \\times 10^{-3}\\,\\mathrm{S}$$\n问题要求以毫西门子（$\\mathrm{mS}$）为单位，并四舍五入到四位有效数字。\n$$g_m \\approx 2.789\\,\\mathrm{mS}$$\n\n2.  **计算小信号输出电阻 $r_o$**\n\n总输出电阻 $r_o$ 是 NMOS 驱动晶体管 $M_1$ 的输出电阻（$r_{o1}$）和 PMOS 有源负载晶体管 $M_2$ 的输出电阻（$r_{o2}$）的并联组合：\n$$r_o = r_{o1} \\parallel r_{o2} = \\frac{r_{o1} r_{o2}}{r_{o1} + r_{o2}}$$\n饱和区 MOSFET 的输出电阻由公式 $r_o = \\frac{V_A}{I_D}$ 给出，其中 $V_A$ 是厄利电压。问题指明 $V_A$ 与沟道长度 $L$ 呈线性关系：$V_A = V_{A0} \\frac{L}{L_0}$。\n\n首先，我们必须计算每个晶体管的厄利电压。\n对于 $M_1$ (NMOS)：\n- $V_{A0,n} = 20\\,\\mathrm{V}$\n- $L_1 = 0.18\\,\\mu\\mathrm{m}$\n- $L_0 = 1\\,\\mu\\mathrm{m}$\n$$V_{A1} = V_{A0,n} \\frac{L_1}{L_0} = (20\\,\\mathrm{V}) \\frac{0.18\\,\\mu\\mathrm{m}}{1\\,\\mu\\mathrm{m}} = 3.6\\,\\mathrm{V}$$\n\n对于 $M_2$ (PMOS)：\n- $V_{A0,p} = 15\\,\\mathrm{V}$\n- $L_2 = 0.50\\,\\mu\\mathrm{m}$\n- $L_0 = 1\\,\\mu\\mathrm{m}$\n$$V_{A2} = V_{A0,p} \\frac{L_2}{L_0} = (15\\,\\mathrm{V}) \\frac{0.50\\,\\mu\\mathrm{m}}{1\\,\\mu\\mathrm{m}} = 7.5\\,\\mathrm{V}$$\n\n现在，我们可以使用 $I_D = 1 \\times 10^{-4}\\,\\mathrm{A}$ 计算每个晶体管的输出电阻：\n$$r_{o1} = \\frac{V_{A1}}{I_D} = \\frac{3.6\\,\\mathrm{V}}{1 \\times 10^{-4}\\,\\mathrm{A}} = 36000\\,\\Omega = 36\\,\\mathrm{k}\\Omega$$\n$$r_{o2} = \\frac{V_{A2}}{I_D} = \\frac{7.5\\,\\mathrm{V}}{1 \\times 10^{-4}\\,\\mathrm{A}} = 75000\\,\\Omega = 75\\,\\mathrm{k}\\Omega$$\n\n最后，我们计算总并联电阻：\n$$r_o = \\frac{(36\\,\\mathrm{k}\\Omega) \\times (75\\,\\mathrm{k}\\Omega)}{36\\,\\mathrm{k}\\Omega + 75\\,\\mathrm{k}\\Omega} = \\frac{2700}{111}\\,\\mathrm{k}\\Omega \\approx 24.324324\\,\\mathrm{k}\\Omega$$\n四舍五入到四位有效数字，我们得到：\n$$r_o \\approx 24.32\\,\\mathrm{k}\\Omega$$\n\n3.  **计算本征增益 $A_v$**\n\n本征电压增益在问题中定义为 $A_v = g_m r_o$。注意，由于共源级的反相特性，实际的电压增益是 $A_v = -g_m r_o$，但问题要求的是其幅值，这是本征增益的一种常见约定。\n在最终四舍五入前，使用未舍入的值以获得更高的精度：\n$$A_v = g_{m1} r_o = (2.788866 \\times 10^{-3}\\,\\mathrm{S}) \\times (24324.324\\,\\Omega)$$\n$$A_v \\approx 67.8422$$\n这是一个无量纲量（V/V）。四舍五入到四位有效数字：\n$$A_v \\approx 67.84$$\n\n问题还要求判断是否达到了至少为 $60$ 的目标本征增益。由于我们计算出的增益为 $67.84$，大于 $60$，因此目标已达到。\n\n最终要求的数值答案是：$g_m$ 以 $\\mathrm{mS}$ 为单位，$r_o$ 以 $\\mathrm{k}\\Omega$ 为单位，$A_v$ 是一个无量纲比率，所有值都四舍五入到四位有效数字。\n- $g_m = 2.789$\n- $r_o = 24.32$\n- $A_v = 67.84$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.789  24.32  67.84\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理想的放大器可以处理任意幅度的信号，但实际电路的输出摆幅受到电源电压和晶体管工作区域的严格限制。本实践将探讨一个核心的大信号性能指标：最大不失真输出摆幅。你将基于给定的静态工作点和过驱动电压，确定输出电压的上下限，从而计算出信号在不导致驱动管或负载管进入三极区（线性区）而产生削波失真的前提下的最大峰值幅度 。这有助于你深刻理解直流偏置点对放大器动态范围的决定性影响。",
            "id": "4298385",
            "problem": "一个单级互补金属氧化物半导体 (CMOS) 共源放大器使用一个n沟道金属氧化物半导体场效应晶体管 (MOSFET) 作为输入器件，并带有一个配置为电流源的p沟道MOSFET有源负载。电源电压为 $V_{DD} = 1.2 \\ \\text{V}$。n沟道MOSFET的源极接地，p沟道MOSFET的源极接至 $V_{DD}$。它们的漏极连接在一起形成输出节点，直流 (DC) 输出电压为 $V_{OQ} = 0.58 \\ \\text{V}$。在此偏置点，建立的偏置电流下，n沟道过驱动电压为 $V_{\\mathrm{OV},n} = 0.22 \\ \\text{V}$，p沟道过驱动电压为 $V_{\\mathrm{OV},p} = 0.27 \\ \\text{V}$。假设经典长沟道MOSFET的工作区定义适用，并忽略沟道长度调制效应、体效应和速度饱和效应。将给定的过驱动电压视为保持在适当工作区所需的固定裕度。施加一个低频正弦信号，使得输出试图围绕 $V_{OQ}$ 对称摆动，动态限制可忽略不计，且失真主要由任一器件的大信号工作区转换引起。\n\n从长沟道MOSFET的基本工作区定义出发，确定以 $V_{OQ}$ 为中心的正弦输出电压的最大允许峰值幅度 $A_{\\max}$，使得任一器件都不会因离开其饱和区而导致削波。以 $\\text{V}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题以确保其科学上合理、内容自洽且适定。给定的条件是：\n- 一个单级CMOS共源放大器，带有一个n沟道驱动管和一个p沟道电流源负载。\n- 电源电压：$V_{DD} = 1.2 \\ \\text{V}$。\n- 静态直流输出电压：$V_{OQ} = 0.58 \\ \\text{V}$。\n- 静态点NMOS过驱动电压：$V_{\\mathrm{OV},n} = 0.22 \\ \\text{V}$。\n- 静态点PMOS过驱动电压：$V_{\\mathrm{OV},p} = 0.27 \\ \\text{V}$。\n- 假设：长沟道MOSFET行为，无沟道长度调制，无体效应。静态过驱动电压被视为固定的裕度要求。\n\n直流工作点与两个晶体管都处于饱和区的情况是一致的。n沟道MOSFET (NMOS) 要求 $V_{DS,n} \\ge V_{\\mathrm{OV},n}$。在偏置点，$V_{DS,n} = V_{OQ} = 0.58 \\ \\text{V}$，大于 $V_{\\mathrm{OV},n} = 0.22 \\ \\text{V}$。p沟道MOSFET (PMOS) 要求 $V_{SD,p} \\ge V_{\\mathrm{OV},p}$。在偏置点，$V_{SD,p} = V_{DD} - V_{OQ} = 1.2 \\ \\text{V} - 0.58 \\ \\text{V} = 0.62 \\ \\text{V}$，大于 $V_{\\mathrm{OV},p} = 0.27 \\ \\text{V}$。该问题是有效的。\n\n目标是求正弦输出电压信号 $v_{out}(t) = V_{OQ} + A \\sin(\\omega t)$ 的最大峰值幅度 $A_{\\max}$，使得NMOS驱动晶体管 ($M_n$) 和PMOS负载晶体管 ($M_p$) 均不离开饱和区。这由最小和最大允许输出电压 $V_{out,min}$ 和 $V_{out,max}$ 决定。\n\n首先，我们确定输出电压摆幅的下限 $V_{out,min}$。这个限制由NMOS驱动晶体管 $M_n$ 决定。为使 $M_n$ 保持在饱和区，其漏源电压 $V_{DS,n}$ 必须大于或等于其过驱动电压。$M_n$ 的源极接地 ($V_{S,n} = 0$)，所以其漏源电压等于输出电压，$V_{DS,n} = v_{out}$。问题陈述使用静态过驱动电压作为固定的裕度要求。因此，$M_n$ 保持在饱和区的条件是：\n$$V_{DS,n} \\ge V_{\\mathrm{OV},n}$$\n$$v_{out} \\ge V_{\\mathrm{OV},n}$$\n这设定了最小允许输出电压：\n$$V_{out,min} = V_{\\mathrm{OV},n} = 0.22 \\ \\text{V}$$\n如果输出电压降到 $0.22 \\ \\text{V}$ 以下，$M_n$ 将进入三极管区，导致信号的负向部分被削波。\n\n接下来，我们确定输出电压摆幅的上限 $V_{out,max}$。这个限制由PMOS负载晶体管 $M_p$ 决定。为使 $M_p$ 保持在饱和区，其源漏电压 $V_{SD,p}$ 必须大于或等于其过驱动电压。$M_p$ 的源极连接到电源电压 ($V_{S,p} = V_{DD}$)，所以其源漏电压为 $V_{SD,p} = V_{DD} - v_{out}$。使用给定的静态过驱动电压作为固定的裕度要求，$M_p$ 保持在饱和区的条件是：\n$$V_{SD,p} \\ge V_{\\mathrm{OV},p}$$\n$$V_{DD} - v_{out} \\ge V_{\\mathrm{OV},p}$$\n整理不等式以求解 $v_{out}$：\n$$v_{out} \\le V_{DD} - V_{\\mathrm{OV},p}$$\n这设定了最大允许输出电压：\n$$V_{out,max} = V_{DD} - V_{\\mathrm{OV},p} = 1.2 \\ \\text{V} - 0.27 \\ \\text{V} = 0.93 \\ \\text{V}$$\n如果输出电压上升到 $0.93 \\ \\text{V}$ 以上，$M_p$ 将进入三极管区，导致信号的正向部分被削波。\n\n输出电压的总允许摆动范围是从 $V_{out,min} = 0.22 \\ \\text{V}$ 到 $V_{out,max} = 0.93 \\ \\text{V}$。输出信号是一个以静态电压 $V_{OQ} = 0.58 \\ \\text{V}$ 为中心的正弦波。为使信号能够对称摆动而不发生削波，其峰值幅度 $A$ 不能超过向上或向下摆动裕度中较小的一个。\n\n从 $V_{OQ}$ 开始的最大向上摆幅为：\n$$\\Delta V^{+} = V_{out,max} - V_{OQ} = 0.93 \\ \\text{V} - 0.58 \\ \\text{V} = 0.35 \\ \\text{V}$$\n从 $V_{OQ}$ 开始的最大向下摆幅为：\n$$\\Delta V^{-} = V_{OQ} - V_{out,min} = 0.58 \\ \\text{V} - 0.22 \\ \\text{V} = 0.36 \\ \\text{V}$$\n对称摆动的最大峰值幅度 $A_{\\max}$ 是这两个值中的最小值：\n$$A_{\\max} = \\min(\\Delta V^{+}, \\Delta V^{-}) = \\min(0.35 \\ \\text{V}, 0.36 \\ \\text{V}) = 0.35 \\ \\text{V}$$\n输出摆幅受到PMOS负载晶体管进入三极管区的限制。问题要求答案四舍五入到四位有效数字。\n\n$$A_{\\max} = 0.3500 \\ \\text{V}$$",
            "answer": "$$\\boxed{0.3500}$$"
        },
        {
            "introduction": "放大器的增益并非在所有频率下都保持不变，它会随着信号频率的升高而下降。这种频率依赖性是由电路中的电容（尤其是寄生电容）引起的，它决定了放大器的带宽。本实践将引导你进行交流（AC）分析，通过构建一个单极点系统模型来表征放大器的频率响应 。你将学会如何从电路参数中确定主极点频率 $f_p$ 和增益带宽积（GBW），这是衡量放大器速度和在高频下工作能力的关键指标。",
            "id": "4298376",
            "problem": "您需要在电子设计自动化（EDA）框架内，对一个采用有源负载的单级反相放大器进行交流（AC）分析的形式化和实现。该放大器是一个采用直流（DC）电流源有源负载的金属氧化物半导体场效应晶体管（MOSFET）共源级。目标是从第一性原理出发，推导出一个小信号传递函数，从而得出复电压增益 $A_v(j\\omega)$、增益带宽积（GBW）和主极点频率。该分析必须完全以数学术语表达和实现，不参考任何特定的电路模拟器。\n\n假设和建模：\n- MOSFET 的小信号视图使用其跨导 $g_{m,n}$ 和输出电阻 $r_{o,n}$ 来表示。有源负载由一个输出电阻 $r_{o,p}$ 表示。沟道长度调制和其他输出电导效应都包含在这些电阻中。体效应和衬底-源极耦合被忽略。\n- 放大器的输出节点由器件寄生电容和显式负载电容的并联组合加载。为了估算主极点，这些电容被建模为 $C_{L}$、$C_{db,n}$、$C_{db,p}$ 和 $C_{gd}$，全部连接到输出节点。此近似假设驱动源的阻抗较低，因此米勒再分配将 $C_{gd}$ 的大部分影响置于输入端，而不是在输出节点包含它之外重塑输出极点。您必须陈述并使用此近似。\n- AC分析的输入激励是在栅极节点施加一个幅度为 $1$ V、源电阻为零的交流电压源。源极和衬底节点处于交流地。输出是在漏极节点相对于交流地测量的。\n- 输出节点的输出电阻是并联组合 $R_{\\text{out}} = \\left(\\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}}\\right)^{-1}$。根据所述近似，总输出电容为 $C_{\\text{out}} = C_{L} + C_{db,n} + C_{db,p} + C_{gd}$。\n- 您必须仅从基尔霍夫电流定律（KCL）、线性时不变（LTI）系统理论和小信号线性化出发，推导出这个单极点级的传递函数可以通过直流（DC）增益 $A_v(0)$ 和极点角频率 $\\omega_p$ 进行参数化，然后用于在指定频率下评估 $A_v(j\\omega)$。角度和角频率必须以弧度处理。\n\n要求的输出和单位：\n- 计算直流增益 $A_v(0)$，作为一个无量纲量。\n- 计算主极点频率 $f_p$，单位为赫兹。\n- 计算增益带宽积 GBW $= \\lvert A_v(0) \\rvert \\cdot f_p$，单位为赫兹。\n- 在指定的评估频率 $f_{\\text{eval}}$（其中 $\\omega_{\\text{eval}} = 2\\pi f_{\\text{eval}}$）下，评估复增益 $A_v(j\\omega_{\\text{eval}})$，并报告其实部和虚部，作为无量纲量。\n\n您的程序必须使用以下从第一性原理推导出的放大器单极点表示：\n- 直流增益为 $A_v(0) = -g_{m,n} R_{\\text{out}}$。\n- 极点为 $\\omega_p = \\dfrac{1}{R_{\\text{out}} C_{\\text{out}}}$ 且 $f_p = \\dfrac{\\omega_p}{2\\pi}$。\n- 频率响应为 $A_v(j\\omega) = \\dfrac{A_v(0)}{1 + j \\dfrac{\\omega}{\\omega_p}}$。\n- 增益带宽积为 $\\text{GBW} = \\lvert A_v(0) \\rvert \\cdot f_p$。\n\n所需的小信号激励和测量节点：\n- 在输入栅极节点施加一个幅度为 $1$ V、源电阻为零的交流电压源。\n- 保持源极和衬底节点处于交流地。\n- 在漏极测量相对于交流地的输出节点电压，以获得 $A_v(j\\omega) = \\dfrac{v_{\\text{out}}(j\\omega)}{v_{\\text{in}}(j\\omega)}$。\n\n测试套件：\n为以下参数集实现计算。每个参数集是一个元组 $(g_{m,n}, r_{o,n}, r_{o,p}, C_L, C_{db,n}, C_{db,p}, C_{gd}, f_{\\text{eval}})$，单位分别为西门子、欧姆、欧姆、法拉、法拉、法拉、法拉和赫兹。所有与频率相关的计算必须使用弧度作为角频率。\n\n- 情况 $1$（具有显著增益和轻负载的通用反相级）：$g_{m,n} = 2\\times 10^{-3}$, $r_{o,n} = 5.0\\times 10^{4}$, $r_{o,p} = 1.0\\times 10^{5}$, $C_{L} = 1.0\\times 10^{-13}$, $C_{db,n} = 2.0\\times 10^{-14}$, $C_{db,p} = 2.0\\times 10^{-14}$, $C_{gd} = 1.0\\times 10^{-14}$, $f_{\\text{eval}} = 1.0\\times 10^{7}$。\n- 情况 $2$（低跨导导致亚单位增益的边界情况）：$g_{m,n} = 2.0\\times 10^{-5}$, $r_{o,n} = 4.0\\times 10^{4}$, $r_{o,p} = 4.0\\times 10^{4}$, $C_{L} = 1.0\\times 10^{-12}$, $C_{db,n} = 5.0\\times 10^{-14}$, $C_{db,p} = 5.0\\times 10^{-14}$, $C_{gd} = 2.0\\times 10^{-14}$, $f_{\\text{eval}} = 5.0\\times 10^{6}$。\n- 情况 $3$（由重负载和近理想电流源负载导致主极点被推低）：$g_{m,n} = 4.0\\times 10^{-3}$, $r_{o,n} = 2.5\\times 10^{4}$, $r_{o,p} = 1.0\\times 10^{9}$, $C_{L} = 1.0\\times 10^{-11}$, $C_{db,n} = 2.0\\times 10^{-13}$, $C_{db,p} = 1.5\\times 10^{-13}$, $C_{gd} = 2.0\\times 10^{-13}$, $f_{\\text{eval}} = 1.0\\times 10^{6}$。\n\n输出规范：\n对于每个测试用例，计算并返回列表 $[A_v(0), \\text{GBW}, f_p, \\Re\\{A_v(j\\omega_{\\text{eval}})\\}, \\Im\\{A_v(j\\omega_{\\text{eval}})\\}]$。您的程序应生成单行输出，其中包含所有测试用例的结果，形式为由逗号分隔的每个用例的列表，并用方括号括起来。例如，一个有效的输出格式是 $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2],[a_3,b_3,c_3,d_3,e_3]]$，其中所有条目都是浮点数。报告 $A_v(0)$ 为无量纲量，GBW 和 $f_p$ 的单位为赫兹，以及 $A_v(j\\omega_{\\text{eval}})$ 的实部和虚部为无量纲量。",
            "solution": "该问题是有效的。它提出了一个模拟集成电路分析中标准的、适定的问题，具有科学依据且内部一致。我们将从第一性原理出发，推导所要求的传递函数及相关参数。\n\n目标是确定带有有源电流源负载的共源MOSFET放大器的小信号交流特性。分析始于根据指定假设构建小信号等效电路。输入n沟道MOSFET（$M_n$）由其跨导 $g_{m,n}$ 和输出电阻 $r_{o,n}$ 建模。p沟道MOSFET有源负载（$M_p$）由其输出电阻 $r_{o,p}$ 建模。输入信号 $v_{in}$ 施加在 $M_n$ 的栅极。其源极和衬底连接到交流地，这意味着栅源电压为 $v_{gs} = v_{in}$。输出电压 $v_{out}$ 在 $M_n$ 和 $M_p$ 的公共漏极节点测量。直流电源电压（$V_{DD}$）是交流地。\n\n总输出电阻 $R_{out}$ 是NMOS输出电阻 $r_{o,n}$ 和PMOS输出电阻 $r_{o,p}$ 的并联组合。\n$$R_{out} = r_{o,n} \\parallel r_{o,p} = \\left(\\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}}\\right)^{-1}$$\n总输出电容 $C_{out}$ 是连接到输出节点的所有电容之和，根据问题的主极点近似指定。\n$$C_{out} = C_{L} + C_{db,n} + C_{db,p} + C_{gd}$$\n\n小信号等效电路由以下连接到输出节点（漏极）的元件组成：\n$1$. NMOS晶体管的受控电流源，从输出节点向地汲取电流 $g_{m,n}v_{gs} = g_{m,n}v_{in}$。\n$2$. 从输出节点到地的NMOS输出电阻 $r_{o,n}$。\n$3$. 从输出节点到地的PMOS输出电阻 $r_{o,p}$（因为PMOS的源极连接到 $V_{DD}$，即交流地）。\n$4$. 从输出节点到地的总输出电容 $C_{out}$。\n\n为了找到传递函数 $A_v(s) = V_{out}(s) / V_{in}(s)$，其中 $s$ 是复频率变量，我们在输出节点应用基尔霍夫电流定律（KCL）。离开节点的电流总和为零。在s域（相量域）中，这表示为：\n$$g_{m,n}V_{in}(s) + \\frac{V_{out}(s)}{r_{o,n}} + \\frac{V_{out}(s)}{r_{o,p}} + s C_{out} V_{out}(s) = 0$$\n我们可以将涉及 $V_{out}(s)$ 的项组合在一起：\n$$V_{out}(s) \\left( \\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}} + s C_{out} \\right) = -g_{m,n}V_{in}(s)$$\n使用 $R_{out}$ 的定义，括号中的表达式变为 $\\frac{1}{R_{out}} + s C_{out}$。\n$$V_{out}(s) \\left( \\frac{1}{R_{out}} + s C_{out} \\right) = -g_{m,n}V_{in}(s)$$\n现在，我们求解电压增益 $A_v(s) = V_{out}(s) / V_{in}(s)$：\n$$A_v(s) = \\frac{-g_{m,n}}{\\frac{1}{R_{out}} + s C_{out}}$$\n为了将其表示为标准单极点传递函数形式 $A_v(s) = \\frac{A_v(0)}{1+s/\\omega_p}$，我们将分子和分母同乘以 $R_{out}$：\n$$A_v(s) = \\frac{-g_{m,n}R_{out}}{1 + s R_{out}C_{out}}$$\n通过将此推导表达式与标准形式进行比较，我们可以识别出直流增益 $A_v(0)$ 和极点角频率 $\\omega_p$。\n\n$1$. 直流增益，在 $s=0$（或 $\\omega=0$）时评估，为：\n$$A_v(0) = -g_{m,n}R_{out}$$\n这表示放大器在低频时的增益。负号表示放大器是反相的，这与共源配置的预期一致。\n\n$2$. 主极点角频率 $\\omega_p$ 从分母项 $1 + sR_{out}C_{out} = 1 + s/\\omega_p$ 中找到。这给出：\n$$\\omega_p = \\frac{1}{R_{out}C_{out}}$$\n以赫兹为单位的极点频率 $f_p$ 与角频率的关系为 $f_p = \\omega_p / (2\\pi)$。\n$$f_p = \\frac{1}{2\\pi R_{out}C_{out}}$$\n\n$3$. 增益带宽积（GBW）定义为直流增益幅值与极点频率的乘积。对于单极点系统，这约等于单位增益频率。\n$$\\text{GBW} = |A_v(0)| \\cdot f_p = |-g_{m,n}R_{out}| \\cdot \\frac{1}{2\\pi R_{out}C_{out}} = \\frac{g_{m,n}}{2\\pi C_{out}}$$\n\n$4$. 在特定评估频率 $f_{\\text{eval}}$ 处的复增益通过将 $s = j\\omega_{\\text{eval}} = j2\\pi f_{\\text{eval}}$ 代入传递函数得到：\n$$A_v(j\\omega_{\\text{eval}}) = \\frac{A_v(0)}{1 + j\\frac{\\omega_{\\text{eval}}}{\\omega_p}}$$\n为了找到实部和虚部，我们对分母进行有理化：\n$$A_v(j\\omega_{\\text{eval}}) = \\frac{A_v(0)}{1 + j\\frac{\\omega_{\\text{eval}}}{\\omega_p}} \\cdot \\frac{1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}}{1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}} = \\frac{A_v(0)\\left(1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n由此，实部和虚部为：\n$$\\Re\\{A_v(j\\omega_{\\text{eval}})\\} = \\frac{A_v(0)}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n$$\\Im\\{A_v(j\\omega_{\\text{eval}})\\} = \\frac{-A_v(0) \\cdot \\frac{\\omega_{\\text{eval}}}{\\omega_p}}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n\n实现将对测试套件中提供的每个参数集计算这些量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the AC analysis characteristics for a single-stage common-source\n    amplifier with an active load for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple:\n    # (g_m_n, r_o_n, r_o_p, C_L, C_db_n, C_db_p, C_gd, f_eval)\n    # Units: (S, Ohm, Ohm, F, F, F, F, Hz)\n    test_cases = [\n        (2e-3, 5e4, 1e5, 1e-13, 2e-14, 2e-14, 1e-14, 1e7),\n        (2e-5, 4e4, 4e4, 1e-12, 5e-14, 5e-14, 2e-14, 5e6),\n        (4e-3, 2.5e4, 1e9, 1e-11, 2e-13, 1.5e-13, 2e-13, 1e6)\n    ]\n\n    results = []\n    for case in test_cases:\n        g_m_n, r_o_n, r_o_p, C_L, C_db_n, C_db_p, C_gd, f_eval = case\n\n        # 1. Calculate total output resistance R_out\n        # R_out = r_o_n || r_o_p\n        if r_o_n + r_o_p == 0:\n            R_out = 0.0\n        else:\n            R_out = (r_o_n * r_o_p) / (r_o_n + r_o_p)\n        \n        # 2. Calculate total output capacitance C_out\n        C_out = C_L + C_db_n + C_db_p + C_gd\n        \n        # 3. Compute DC gain A_v(0)\n        A_v_0 = -g_m_n * R_out\n        \n        # 4. Compute the dominant pole frequency (omega_p and f_p)\n        # Avoid division by zero if R_out or C_out is zero\n        if R_out == 0 or C_out == 0:\n            omega_p = float('inf')\n            f_p = float('inf')\n        else:\n            omega_p = 1 / (R_out * C_out)\n            f_p = omega_p / (2 * np.pi)\n            \n        # 5. Compute the gain-bandwidth product (GBW)\n        # The relationship GBW = g_m_n / (2*pi*C_out) is more numerically stable\n        if C_out == 0:\n            GBW = float('inf')\n        else:\n            GBW = g_m_n / (2 * np.pi * C_out)\n        # Alternatively, using the derived relation GBW = |A_v(0)| * f_p \n        # GBW_alt = abs(A_v_0) * f_p \n        # Both should be equivalent; we use the more stable form.\n        \n        # 6. Evaluate the complex gain at f_eval\n        omega_eval = 2 * np.pi * f_eval\n        \n        # Using complex numbers for straightforward calculation\n        # A_v(jw) = A_v(0) / (1 + j * w / w_p)\n        if omega_p == float('inf'): # Corresponds to zero RC time constant\n             A_v_jw_eval = A_v_0 + 0j\n        else:\n             A_v_jw_eval = A_v_0 / (1 + 1j * (omega_eval / omega_p))\n        \n        real_part = A_v_jw_eval.real\n        imag_part = A_v_jw_eval.imag\n        \n        # Append the list of results for the current case\n        results.append([A_v_0, GBW, f_p, real_part, imag_part])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}