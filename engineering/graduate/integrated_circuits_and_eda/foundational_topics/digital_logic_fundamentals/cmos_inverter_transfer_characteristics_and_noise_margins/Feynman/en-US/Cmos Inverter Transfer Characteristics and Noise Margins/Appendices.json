{
    "hands_on_practices": [
        {
            "introduction": "The switching threshold, $V_M$, is a critical parameter that defines the center of an inverter's transition region and directly influences its noise margins. This first practice focuses on calculating $V_M$ from first principles using the ideal square-law MOSFET model. By equating the currents of the nMOS and pMOS transistors when both are in saturation, you will gain foundational experience with the static analysis of a CMOS inverter's core behavior .",
            "id": "4261104",
            "problem": "A Complementary Metal-Oxide-Semiconductor (CMOS) inverter is designed in the long-channel regime and analyzed within the context of Electronic Design Automation (EDA). The inverter uses an $n$-channel metal-oxide-semiconductor field-effect transistor ($n$-MOSFET) and a $p$-channel metal-oxide-semiconductor field-effect transistor ($p$-MOSFET) with the following parameters: supply voltage $V_{DD}=0.8\\ \\mathrm{V}$, threshold voltages $V_{TN}=0.2\\ \\mathrm{V}$ and $|V_{TP}|=0.2\\ \\mathrm{V}$, and transconductance parameter ratio $k_n/k_p=2.5$, where $k_n=\\mu_n C_{\\mathrm{ox}} (W/L)_n$ and $k_p=\\mu_p C_{\\mathrm{ox}} (W/L)_p$. Assume square-law behavior, negligible body effect, and negligible channel-length modulation. Define the switching threshold $V_M$ as the input voltage at which the inverter’s input equals its output, i.e., $V_{\\mathrm{in}}=V_{\\mathrm{out}}=V_M$. Starting from first principles and well-tested device equations, determine $V_M$ by enforcing current continuity at the output node and by correctly identifying the regions of operation of both transistors at $V_M$. Express your final numerical result for $V_M$ in volts and round your answer to $4$ significant figures. Then, based on your computed $V_M$, state whether $V_M$ is above or below $0.4\\ \\mathrm{V}$, and justify your conclusion in terms of the inverter’s transfer characteristics and the relative strengths of the $n$-MOSFET and $p$-MOSFET. The qualitative comment does not need to be included in the final numerical answer.",
            "solution": "The switching threshold $V_M$ of a Complementary Metal-Oxide-Semiconductor (CMOS) inverter is defined by $V_{\\mathrm{in}}=V_{\\mathrm{out}}=V_M$. At this operating point, the output node is at $V_M$, the input drives both gates to $V_M$, and both transistors conduct such that the current pulled down by the $n$-channel metal-oxide-semiconductor field-effect transistor ($n$-MOSFET) equals the current pulled up by the $p$-channel metal-oxide-semiconductor field-effect transistor ($p$-MOSFET). We assume long-channel devices obeying the square-law current-voltage relation, negligible body effect, and negligible channel-length modulation.\n\nThe fundamental base consists of the well-tested square-law saturation expressions for metal-oxide-semiconductor field-effect transistors (MOSFETs). For the $n$-MOSFET in saturation, the drain current is\n$$\nI_{D,n}=\\frac{1}{2}k_n\\left(V_{GS,n}-V_{TN}\\right)^{2},\n$$\nwhen $V_{DS,n}\\geq V_{GS,n}-V_{TN}$. For the $p$-MOSFET in saturation (using the convention that currents are positive magnitudes and voltages are in terms of source-to-gate and source-to-drain), the drain current magnitude is\n$$\nI_{D,p}=\\frac{1}{2}k_p\\left(V_{SG,p}-|V_{TP}|\\right)^{2},\n$$\nwhen $V_{SD,p}\\geq V_{SG,p}-|V_{TP}|$.\n\nAt the switching threshold $V_M$, we have for the $n$-MOSFET: $V_{G,n}=V_M$, $V_{D,n}=V_M$, $V_{S,n}=0$, so $V_{GS,n}=V_M$ and $V_{DS,n}=V_M$. The saturation condition $V_{DS,n}\\geq V_{GS,n}-V_{TN}$ becomes $V_M\\geq V_M-V_{TN}$, which simplifies to $V_{TN}\\geq 0$. Given $V_{TN}=0.2\\ \\mathrm{V}$, the $n$-MOSFET is in saturation at $V_M$.\n\nFor the $p$-MOSFET: $V_{S,p}=V_{DD}$, $V_{G,p}=V_M$, $V_{D,p}=V_M$, so $V_{SG,p}=V_{DD}-V_M$ and $V_{SD,p}=V_{DD}-V_M$. The saturation condition $V_{SD,p}\\geq V_{SG,p}-|V_{TP}|$ becomes $V_{DD}-V_M\\geq V_{DD}-V_M-|V_{TP}|$, which simplifies to $|V_{TP}|\\geq 0$. Given $|V_{TP}|=0.2\\ \\mathrm{V}$, the $p$-MOSFET is also in saturation at $V_M$.\n\nBy Kirchhoff’s Current Law (KCL) at the output node, the magnitudes of the currents must be equal:\n$$\nI_{D,n}=I_{D,p}.\n$$\nSubstituting the saturation currents,\n$$\n\\frac{1}{2}k_n\\left(V_M-V_{TN}\\right)^{2}=\\frac{1}{2}k_p\\left(V_{DD}-V_M-|V_{TP}|\\right)^{2}.\n$$\nCanceling the factor $\\frac{1}{2}$ and taking positive square roots (the bracketed terms are positive if both transistors are on, which will be verified post-solution),\n$$\n\\sqrt{k_n}\\left(V_M-V_{TN}\\right)=\\sqrt{k_p}\\left(V_{DD}-V_M-|V_{TP}|\\right).\n$$\nSolving for $V_M$,\n$$\n\\sqrt{k_n}\\,V_M-\\sqrt{k_n}\\,V_{TN}=\\sqrt{k_p}\\,V_{DD}-\\sqrt{k_p}\\,V_M-\\sqrt{k_p}\\,|V_{TP}|,\n$$\n$$\nV_M\\left(\\sqrt{k_n}+\\sqrt{k_p}\\right)=\\sqrt{k_p}\\left(V_{DD}-|V_{TP}|\\right)+\\sqrt{k_n}\\,V_{TN},\n$$\n$$\nV_M=\\frac{\\sqrt{k_p}\\left(V_{DD}-|V_{TP}|\\right)+\\sqrt{k_n}\\,V_{TN}}{\\sqrt{k_n}+\\sqrt{k_p}}.\n$$\nIntroduce the ratio $r=\\frac{k_n}{k_p}$. Then $\\sqrt{k_n}=\\sqrt{r}\\,\\sqrt{k_p}$, and the expression simplifies to\n$$\nV_M=\\frac{\\sqrt{r}\\,V_{TN}+V_{DD}-|V_{TP}|}{\\sqrt{r}+1}.\n$$\nWith the given values $V_{DD}=0.8\\ \\mathrm{V}$, $V_{TN}=0.2\\ \\mathrm{V}$, $|V_{TP}|=0.2\\ \\mathrm{V}$, and $r=2.5$, we have $\\sqrt{r}=\\sqrt{2.5}$. Numerically,\n$$\nV_M=\\frac{\\sqrt{2.5}\\cdot 0.2+0.8-0.2}{\\sqrt{2.5}+1}=\\frac{0.2\\sqrt{2.5}+0.6}{\\sqrt{2.5}+1}.\n$$\nCompute $\\sqrt{2.5}$ symbolically and then evaluate:\n$$\nV_M=\\frac{0.2\\sqrt{2.5}+0.6}{\\sqrt{2.5}+1}.\n$$\nEvaluating to $4$ significant figures in volts,\n$$\n\\sqrt{2.5}\\approx 1.581,\\quad 0.2\\sqrt{2.5}\\approx 0.3162,\\quad \\text{numerator}\\approx 0.9162,\\quad \\text{denominator}\\approx 2.581,\n$$\n$$\nV_M\\approx \\frac{0.9162}{2.581}\\approx 0.3550\\ \\mathrm{V}.\n$$\nVerification of positivity of the bracketed terms confirms the validity of the square-root step: $V_M-V_{TN}\\approx 0.3550-0.2=0.1550>0$ and $V_{DD}-V_M-|V_{TP}|\\approx 0.8-0.3550-0.2=0.2450>0$.\n\nFinally, to comment on whether $V_M$ is above or below $0.4\\ \\mathrm{V}$, we note $V_M\\approx 0.3550\\ \\mathrm{V}$, which is below $0.4\\ \\mathrm{V}$. This is physically consistent with $k_n/k_p=2.5>1$, indicating a stronger $n$-MOSFET relative to the $p$-MOSFET, which biases the switching threshold toward the ground rail. In terms of transfer characteristics and noise margins, a lower $V_M$ implies a larger low-level noise margin and a smaller high-level noise margin compared to the symmetric case $V_M=V_{DD}/2=0.4\\ \\mathrm{V}$.",
            "answer": "$$\\boxed{0.3550}$$"
        },
        {
            "introduction": "While ideal inverters exhibit perfect output logic levels of $0$ and $V_{DD}$, real devices suffer from various leakage currents that degrade performance. This exercise explores the impact of Gate-Induced Drain Leakage (GIDL), a significant non-ideal effect in scaled transistors, on the inverter's static characteristics. You will calculate the resulting non-zero low-level output voltage ($V_{OL}$) and quantify the corresponding reduction in the low noise margin ($NM_L$), providing crucial insight into the practical challenges of robust low-power design .",
            "id": "4261164",
            "problem": "A Complementary Metal-Oxide-Semiconductor (CMOS) inverter is powered at a supply voltage of $V_{DD} = 0.8\\ \\mathrm{V}$ and uses a long-channel $n$-channel Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) with threshold voltage $V_{tn} = 0.25\\ \\mathrm{V}$. The $n$-channel device has a transconductance parameter $\\mu_{n} C_{\\text{ox}} (W/L) = 200 \\times 10^{-6}\\ \\mathrm{A/V^2}$, and the $p$-channel device is nominally off when the input is high. When the input is at $V_{in} = V_{DD}$ and the output is nominally low, Gate-Induced Drain Leakage (GIDL) at the off $p$-channel drain injects a constant Direct Current (DC) leakage $I_{\\text{GIDL}} = 5.25 \\times 10^{-6}\\ \\mathrm{A}$ into the output node due to band-to-band tunneling in the high-field drain–gate overlap region.\n\nAssume the following scientifically realistic modeling assumptions:\n- The $n$-channel MOSFET operates in the linear (ohmic) regime for small output voltage when $V_{in} = V_{DD}$.\n- Body effect, channel-length modulation, and velocity saturation are negligible in this operating point.\n- The off-state $p$-channel conduction other than Gate-Induced Drain Leakage (GIDL) is negligible.\n- The maximum input low threshold $V_{IL}$ that enters the static transfer curve definition of the low noise margin is not altered by the small leakage at $V_{in} = V_{DD}$.\n\nStarting from Kirchhoff’s Current Law and physically justified current–voltage relations for the $n$-channel device in the appropriate regime, show how Gate-Induced Drain Leakage (GIDL) raises the static low-level output voltage $V_{OL}$ by forcing equilibrium between the pull-down channel current and the injected leakage current at the output node. Then, using the standard definition of the low noise margin $NM_{L} = V_{IL} - V_{OL}$, quantify the reduction in $NM_{L}$ caused solely by this leakage in the specified operating point.\n\nExpress the final numerical answer in volts and round your answer to four significant figures.",
            "solution": "The static low-level output voltage, $V_{OL}$, is determined when the input voltage is high, i.e., $V_{in} = V_{DD}$. In this state, the n-channel MOSFET (nMOS) is ON, creating a path to ground, while the p-channel MOSFET (pMOS) is OFF. The GIDL current, $I_{\\text{GIDL}}$, is injected from the drain of the OFF pMOS into the output node.\n\nAt the output node, a steady state is reached when the current pulled down by the nMOS, $I_{Dn}$, exactly balances the leakage current injected into the node. Applying Kirchhoff’s Current Law (KCL) at the output node gives:\n$$I_{Dn} - I_{\\text{GIDL}} = 0$$\nwhich implies:\n$$I_{Dn} = I_{\\text{GIDL}}$$\n\nThe nMOS transistor has a gate-source voltage $V_{GSn} = V_{in} - V_S = V_{DD} - 0 = V_{DD}$. The drain-source voltage is $V_{DSn} = V_{out} - V_S = V_{OL} - 0 = V_{OL}$. The problem assumes the nMOS operates in the linear (ohmic) region. The condition for this is $V_{DSn} < V_{GSn} - V_{tn}$, or $V_{OL} < V_{DD} - V_{tn}$. We must verify this condition after determining a value for $V_{OL}$.\n\nThe drain current for a long-channel nMOS in the linear region, neglecting channel-length modulation, is given by:\n$$I_{Dn} = \\mu_{n} C_{\\text{ox}} \\left(\\frac{W}{L}\\right)_n \\left[ (V_{GSn} - V_{tn})V_{DSn} - \\frac{1}{2}V_{DSn}^2 \\right]$$\nLet's define the transconductance parameter as $k_n = \\mu_{n} C_{\\text{ox}} (W/L)_n = 200 \\times 10^{-6} \\text{ A/V}^2$. Substituting the voltage terms for our specific case:\n$$I_{Dn} = k_n \\left[ (V_{DD} - V_{tn})V_{OL} - \\frac{1}{2}V_{OL}^2 \\right]$$\n\nNow, equating the nMOS current to the leakage current:\n$$I_{\\text{GIDL}} = k_n \\left[ (V_{DD} - V_{tn})V_{OL} - \\frac{1}{2}V_{OL}^2 \\right]$$\nThis is a quadratic equation in terms of $V_{OL}$. Rearranging it into the standard form $ax^2+bx+c=0$:\n$$\\frac{k_n}{2}V_{OL}^2 - k_n(V_{DD} - V_{tn})V_{OL} + I_{\\text{GIDL}} = 0$$\n\nWe substitute the given numerical values:\n- $k_n = 200 \\times 10^{-6} \\text{ A/V}^2$\n- $V_{DD} = 0.8$ V\n- $V_{tn} = 0.25$ V\n- $I_{\\text{GIDL}} = 5.25 \\times 10^{-6}$ A\n\nThe term $(V_{DD} - V_{tn})$ is $0.8 - 0.25 = 0.55$ V.\nThe equation becomes:\n$$\\frac{200 \\times 10^{-6}}{2}V_{OL}^2 - (200 \\times 10^{-6})(0.55)V_{OL} + 5.25 \\times 10^{-6} = 0$$\n$$(100 \\times 10^{-6})V_{OL}^2 - (110 \\times 10^{-6})V_{OL} + 5.25 \\times 10^{-6} = 0$$\nTo simplify, we can divide the entire equation by $1 \\times 10^{-6}$:\n$$100V_{OL}^2 - 110V_{OL} + 5.25 = 0$$\n\nWe solve for $V_{OL}$ using the quadratic formula, $V_{OL} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=100$, $b=-110$, and $c=5.25$.\n$$V_{OL} = \\frac{-(-110) \\pm \\sqrt{(-110)^2 - 4(100)(5.25)}}{2(100)}$$\n$$V_{OL} = \\frac{110 \\pm \\sqrt{12100 - 2100}}{200}$$\n$$V_{OL} = \\frac{110 \\pm \\sqrt{10000}}{200}$$\n$$V_{OL} = \\frac{110 \\pm 100}{200}$$\nThis yields two possible solutions for $V_{OL}$:\n$$V_{OL,1} = \\frac{110 + 100}{200} = \\frac{210}{200} = 1.05 \\text{ V}$$\n$$V_{OL,2} = \\frac{110 - 100}{200} = \\frac{10}{200} = 0.05 \\text{ V}$$\n\nWe must select the physically correct solution. The voltage $V_{OL}$ represents the low output level and should be a small positive voltage. The first solution, $V_{OL,1} = 1.05$ V, is not physically meaningful as it is greater than the supply voltage $V_{DD} = 0.8$ V. The second solution, $V_{OL,2} = 0.05$ V, is the correct one.\nLet's verify our initial assumption that the nMOS is in the linear region:\n$V_{OL} < V_{DD} - V_{tn}$\n$0.05 \\text{ V} < 0.8 \\text{ V} - 0.25 \\text{ V}$\n$0.05 \\text{ V} < 0.55 \\text{ V}$\nThe condition is satisfied, confirming the validity of our model. Thus, the static low output voltage in the presence of leakage is $V_{OL, \\text{leakage}} = 0.05$ V.\n\nThe low noise margin is defined as $NM_L = V_{IL} - V_{OL}$. The problem asks for the reduction in $NM_L$ caused by the leakage.\nIn an ideal inverter with no leakage ($I_{\\text{GIDL}} = 0$), the nMOS would pull the output node completely to ground, so $V_{OL, \\text{ideal}} = 0$ V.\nThe noise margin in the ideal case would be $NM_{L, \\text{ideal}} = V_{IL} - V_{OL, \\text{ideal}} = V_{IL} - 0$.\nThe noise margin with leakage is $NM_{L, \\text{leakage}} = V_{IL} - V_{OL, \\text{leakage}}$.\n\nThe problem states that $V_{IL}$ is unchanged. The reduction in the low noise margin, $\\Delta NM_L$, is therefore:\n$$\\Delta NM_L = NM_{L, \\text{ideal}} - NM_{L, \\text{leakage}}$$\n$$\\Delta NM_L = (V_{IL} - V_{OL, \\text{ideal}}) - (V_{IL} - V_{OL, \\text{leakage}})$$\n$$\\Delta NM_L = V_{OL, \\text{leakage}} - V_{OL, \\text{ideal}}$$\n$$\\Delta NM_L = 0.05 \\text{ V} - 0 \\text{ V} = 0.05 \\text{ V}$$\n\nThe reduction in $NM_L$ is equal to the increase in $V_{OL}$ from its ideal value of $0$. The calculated value is exactly $0.05$ V. To express this with four significant figures as requested, we write $0.05000$.",
            "answer": "$$\\boxed{0.05000}$$"
        },
        {
            "introduction": "Analytical models, while insightful, quickly become intractable for capturing the full complexity of modern deep-submicron transistors. This advanced practice bridges theory and computational engineering by tasking you with building a simple SPICE-like simulation testbench to characterize an inverter. By implementing a numerical solver for the voltage transfer characteristic, including convergence aids like $g_{\\min}$, you will develop a deeper understanding of how industry-standard EDA tools analyze circuit performance and extract key metrics .",
            "id": "4261132",
            "problem": "You are tasked with constructing a computational analog of a quasi-direct current sweep for a complementary metal-oxide-semiconductor (CMOS) inverter, emulating a robust Simulation Program with Integrated Circuit Emphasis (SPICE) testbench to extract the direct current transfer characteristic curve $V_{out}(V_{in})$ and noise margins while ensuring convergence in the steep transition region. Your program must solve the nonlinear node equation at the inverter output for each input point using physically grounded equations and emulate convergence-assisting options analogous to SPICE controls. The final output must be a single line as specified at the end of this problem.\n\nThe inverter comprises an n-channel metal-oxide-semiconductor (nMOS) transistor with gate at $V_{in}$, drain at the output node $V_{out}$, source at ground $0\\,\\mathrm{V}$, and a p-channel metal-oxide-semiconductor (pMOS) transistor with gate at $V_{in}$, drain at the same output node $V_{out}$, and source at the supply $V_{DD}$. Your program must compute the quasi-direct current transfer curve by sweeping $V_{in}$ from $0$ to $V_{DD}$ and solving for $V_{out}$ at each step using Kirchhoff’s Current Law (KCL) and a well-established drain current model for each transistor. To ensure convergence across the steep region, you must incorporate a small conductance to each rail at the output node, denoted $g_{\\min}$, analogous to SPICE’s $g_{\\min}$ stepping. You must also implement a bracketing root solver that is guaranteed to converge for each $V_{in}$ by checking the current balance at $V_{out}=0$ and $V_{out}=V_{DD}$, and then using a bisection method with a voltage absolute tolerance $\\varepsilon_V$.\n\nYou must base your derivation and implementation on the following fundamental principles and definitions:\n- Kirchhoff’s Current Law at the output node: the algebraic sum of currents leaving the node is zero at steady state.\n- The long-channel Shichman–Hodges square-law model with channel-length modulation for metal-oxide-semiconductor drain current, using region-appropriate expressions for the triode and saturation regimes. For the nMOS device with gate-source voltage $V_{GS,n}$, drain-source voltage $V_{DS,n}$, threshold voltage $V_{Tn}$, transconductance parameter $\\beta_n$ in $\\mathrm{A/V^2}$, and channel-length modulation $\\lambda_n$ in $\\mathrm{V^{-1}}$, you must use:\n  - Cutoff: if $V_{GS,n} \\le V_{Tn}$, then $I_{D,n} = 0$.\n  - Triode: if $0 \\le V_{DS,n} < V_{GS,n} - V_{Tn}$,\n    $$ I_{D,n} = \\beta_n \\left((V_{GS,n} - V_{Tn})V_{DS,n} - \\frac{1}{2} V_{DS,n}^2 \\right)\\left(1+\\lambda_n V_{DS,n}\\right). $$\n  - Saturation: if $V_{DS,n} \\ge V_{GS,n} - V_{Tn}$,\n    $$ I_{D,n} = \\frac{1}{2}\\beta_n (V_{GS,n} - V_{Tn})^2 \\left(1+\\lambda_n V_{DS,n}\\right). $$\n- For the pMOS device, you must compute the source-referenced magnitudes using $V_{SG,p} = V_{DD} - V_{in}$, $V_{SD,p} = V_{DD} - V_{out}$, threshold magnitude $V_{Tp} > 0$, transconductance parameter $\\beta_p$ in $\\mathrm{A/V^2}$, and channel-length modulation $\\lambda_p$ in $\\mathrm{V^{-1}}$, with identical regional expressions applied to the magnitudes. The physical current leaving the output node through the pMOS must be treated with the correct sign when forming the KCL equation.\n- To emulate SPICE-style convergence aids, include a linear leakage path to each rail at the output, contributing a current $I_{g\\min} = g_{\\min}(V_{out}-0) + g_{\\min}(V_{out}-V_{DD})$ to the KCL equation.\n\nDefinitions of the required computed quantities:\n- The direct current transfer characteristic $V_{out}(V_{in})$ is obtained by solving the KCL equation at the output node for each $V_{in} \\in [0,V_{DD}]$.\n- The direct current noise margins must be computed from the transfer curve and its slope. Let $V_{OH} = V_{out}(0)$ and $V_{OL} = V_{out}(V_{DD})$. Define $V_{IL}$ and $V_{IH}$ as the input voltages where the slope satisfies $\\frac{dV_{out}}{dV_{in}} = -1$ on the left and right sides of the steep transition, respectively. Then the low and high noise margins are $NM_L = V_{IL} - V_{OL}$ and $NM_H = V_{OH} - V_{IH}$.\n- The inverter switching threshold $V_M$ is defined as the solution to $V_{out}(V_{in}) = V_{in}$.\n\nAlgorithmic and numerical requirements:\n- Use a uniform grid of $N$ samples for $V_{in}$ between $0$ and $V_{DD}$, inclusive. For each $V_{in}$, solve the scalar KCL equation for $V_{out}$ using a bracketing method on $[0,V_{DD}]$ with bisection and stopping criterion $|V_{out}^{(k+1)} - V_{out}^{(k)}| \\le \\varepsilon_V$ or until a preset maximum number of iterations is reached. You must define $f(V_{out}; V_{in})$ as the net current leaving the node, and you must ensure $f(0; V_{in})$ and $f(V_{DD}; V_{in})$ have opposite signs for all $V_{in}$ because of $g_{\\min}$.\n- Estimate $\\frac{dV_{out}}{dV_{in}}$ by finite differences along the computed curve and locate $V_{IL}$ and $V_{IH}$ via linear interpolation around the crossings of $\\frac{dV_{out}}{dV_{in}} = -1$.\n- Locate $V_M$ by identifying the crossing of $V_{out}(V_{in}) - V_{in} = 0$ and linearly interpolating between adjacent samples with opposite signs. If no sign change occurs because of discretization, use the sample with minimum absolute difference as a fallback.\n- Report all requested quantities in $\\mathrm{V}$ and round each reported value to six decimal places.\n\nTest suite:\nUse the following five parameter sets, each a tuple $\\left(V_{DD}, V_{Tn}, V_{Tp}, \\beta_n, \\beta_p, \\lambda_n, \\lambda_p, g_{\\min}, N, \\varepsilon_V\\right)$, with $N$ and $\\varepsilon_V$ common across all cases as specified below.\n- Case A (balanced inverter, moderate channel-length modulation): $\\left(1.0, 0.4, 0.4, 2\\times 10^{-4}, 2\\times 10^{-4}, 0.02, 0.02, 10^{-12}, 2001, 10^{-9}\\right)$.\n- Case B (pMOS stronger than nMOS): $\\left(1.0, 0.4, 0.4, 2\\times 10^{-4}, 3\\times 10^{-4}, 0.02, 0.02, 10^{-12}, 2001, 10^{-9}\\right)$.\n- Case C (near-threshold supply): $\\left(0.9, 0.45, 0.45, 2\\times 10^{-4}, 2\\times 10^{-4}, 0.01, 0.01, 10^{-12}, 2001, 10^{-9}\\right)$.\n- Case D (strong skew, zero channel-length modulation): $\\left(1.2, 0.35, 0.4, 1\\times 10^{-4}, 4\\times 10^{-4}, 0.0, 0.0, 10^{-12}, 2001, 10^{-9}\\right)$.\n- Case E (threshold mismatch, finite channel-length modulation): $\\left(1.2, 0.35, 0.5, 2.5\\times 10^{-4}, 1.5\\times 10^{-4}, 0.05, 0.05, 10^{-12}, 2001, 10^{-9}\\right)$.\n\nRequired outputs per case:\n- For each test case, compute and return a list of three values $\\left[V_M, NM_L, NM_H\\right]$, each in $\\mathrm{V}$ and rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the bracketed triple for one case in the order A, B, C, D, E. For example, a syntactically valid output shape is $\\left[ [a_1,a_2,a_3], [b_1,b_2,b_3], \\dots \\right]$ with numbers inserted and no additional text.\n\nAll physical parameter units must be observed: $V_{DD}$, $V_{Tn}$, $V_{Tp}$, $V_{in}$, $V_{out}$, $V_M$, $NM_L$, $NM_H$, $V_{OH}$, and $V_{OL}$ in $\\mathrm{V}$; $\\beta_n$ and $\\beta_p$ in $\\mathrm{A/V^2}$; $\\lambda_n$ and $\\lambda_p$ in $\\mathrm{V^{-1}}$; and $g_{\\min}$ in $\\mathrm{S}$. Angles are not applicable. Percentages, if any, must be expressed as decimals.",
            "solution": "The objective is to perform a quasi-direct current (DC) analysis of a complementary metal-oxide-semiconductor (CMOS) inverter. This involves computing its voltage transfer characteristic (VTC), denoted as $V_{out}(V_{in})$, and subsequently extracting key performance metrics: the switching threshold ($V_M$), the low noise margin ($NM_L$), and the high noise margin ($NM_H$). The analysis is based on the Shichman-Hodges transistor model and is executed numerically by solving the node equation at the inverter's output for a sweep of input voltages.\n\n**1. Circuit Model and Governing Equations**\n\nThe CMOS inverter consists of an n-channel MOS (nMOS) transistor and a p-channel MOS (pMOS) transistor. The nMOS source is connected to ground ($0\\,\\mathrm{V}$), and its drain is connected to the output node, $V_{out}$. The pMOS source is connected to the supply voltage, $V_{DD}$, and its drain is also connected to $V_{out}$. The gates of both transistors are connected to the input, $V_{in}$.\n\nAt any steady-state operating point, Kirchhoff's Current Law (KCL) must be satisfied at the output node. The algebraic sum of currents leaving the node must be zero. The currents involved are the nMOS drain current, $I_{D,n}$, leaving the node; the pMOS drain current, $I_{D,p}$, entering the node (thus contributing $-I_{D,p}$ to the sum of leaving currents); and a numerically stabilizing leakage current, $I_{g\\min}$, added to model non-ideal leakage paths and ensure convergence.\n\nThe KCL equation is:\n$$ I_{D,n}(V_{in}, V_{out}) - I_{D,p}(V_{in}, V_{out}) + I_{g\\min}(V_{out}) = 0 $$\n\nThe leakage current $I_{g\\min}$ is modeled by two linear conductances, $g_{\\min}$, one from the output node to ground and one to $V_{DD}$:\n$$ I_{g\\min}(V_{out}) = g_{\\min}(V_{out} - 0) + g_{\\min}(V_{out} - V_{DD}) = g_{\\min}(2V_{out} - V_{DD}) $$\nThus, for each value of $V_{in}$, we must solve the following nonlinear equation for $V_{out}$:\n$$ f(V_{out}; V_{in}) = I_{D,n}(V_{in}, V_{out}) - I_{D,p}(V_{in}, V_{out}) + g_{\\min}(2V_{out} - V_{DD}) = 0 $$\n\n**2. Transistor Current Model**\n\nThe drain currents $I_{D,n}$ and $I_{D,p}$ are described by the long-channel Shichman-Hodges model, including channel-length modulation.\n\nFor the nMOS transistor:\nThe relevant voltages are the gate-source voltage, $V_{GS,n} = V_{in}$, and the drain-source voltage, $V_{DS,n} = V_{out}$. Given the nMOS threshold voltage $V_{Tn}$, transconductance parameter $\\beta_n$, and channel-length modulation parameter $\\lambda_n$, the current $I_{D,n}$ is defined by:\n- **Cutoff region** ($V_{GS,n} \\le V_{Tn}$):\n  $$ I_{D,n} = 0 $$\n- **Triode (linear) region** ($0 \\le V_{DS,n} < V_{GS,n} - V_{Tn}$):\n  $$ I_{D,n} = \\beta_n \\left((V_{GS,n} - V_{Tn})V_{DS,n} - \\frac{1}{2} V_{DS,n}^2 \\right)\\left(1+\\lambda_n V_{DS,n}\\right) $$\n- **Saturation region** ($V_{DS,n} \\ge V_{GS,n} - V_{Tn} > 0$):\n  $$ I_{D,n} = \\frac{1}{2}\\beta_n (V_{GS,n} - V_{Tn})^2 \\left(1+\\lambda_n V_{DS,n}\\right) $$\n\nFor the pMOS transistor:\nThe model is analogous but uses source-referenced voltage magnitudes. The relevant voltages are the source-gate voltage, $V_{SG,p} = V_{DD} - V_{in}$, and the source-drain voltage, $V_{SD,p} = V_{DD} - V_{out}$. Given the pMOS threshold voltage magnitude $V_{Tp} > 0$, transconductance parameter $\\beta_p$, and channel-length modulation parameter $\\lambda_p$, the current magnitude $I_{D,p}$ is:\n- **Cutoff region** ($V_{SG,p} \\le V_{Tp}$):\n  $$ I_{D,p} = 0 $$\n- **Triode (linear) region** ($0 \\le V_{SD,p} < V_{SG,p} - V_{Tp}$):\n  $$ I_{D,p} = \\beta_p \\left((V_{SG,p} - V_{Tp})V_{SD,p} - \\frac{1}{2} V_{SD,p}^2 \\right)\\left(1+\\lambda_p V_{SD,p}\\right) $$\n- **Saturation region** ($V_{SD,p} \\ge V_{SG,p} - V_{Tp} > 0$):\n  $$ I_{D,p} = \\frac{1}{2}\\beta_p (V_{SG,p} - V_{Tp})^2 \\left(1+\\lambda_p V_{SD,p}\\right) $$\n\n**3. Numerical Solution and Parameter Extraction**\n\nThe DC transfer curve $V_{out}(V_{in})$ is generated by performing a DC sweep. The input voltage $V_{in}$ is swept over a uniform grid of $N$ points from $0$ to $V_{DD}$. At each point $V_{in_i}$, the nonlinear KCL equation $f(V_{out}; V_{in_i}) = 0$ is solved for $V_{out_i}$.\n\nA bisection method is employed to find the root $V_{out_i}$ in the interval $[0, V_{DD}]$. This method is guaranteed to converge because the function $f(V_{out}; V_{in})$ is continuous and monotonic with respect to $V_{out}$, and the inclusion of the $g_{\\min}$ term ensures that $f(0; V_{in}) < 0$ and $f(V_{DD}; V_{in}) > 0$ for any valid $V_{in} \\in [0, V_{DD}]$, thus bracketing a unique root. The iteration stops when the absolute difference between successive approximations of $V_{out}$ is less than a specified tolerance $\\varepsilon_V$.\n\nOnce the discrete VTC, $\\{ (V_{in_i}, V_{out_i}) \\}$, is computed, the required metrics are extracted:\n- **Output High/Low Voltages**: $V_{OH} = V_{out}(0)$ and $V_{OL} = V_{out}(V_{DD})$, which correspond to the first and last points of the computed VTC, respectively.\n- **Unity-Gain Points ($V_{IL}, V_{IH}$)**: The derivative of the VTC, $\\frac{dV_{out}}{dV_{in}}$, is first estimated using a central finite difference method across the computed points. The input voltages $V_{IL}$ and $V_{IH}$ are the points where this derivative equals $-1$. They are found by searching for segments $[V_{in_i}, V_{in_{i+1}}]$ where the derivative crosses $-1$ and then applying linear interpolation.\n- **Noise Margins**: The noise margins are then calculated as $NM_L = V_{IL} - V_{OL}$ and $NM_H = V_{OH} - V_{IH}$.\n- **Switching Threshold ($V_M$)**: This is the input voltage where $V_{out} = V_{in}$. It is found by locating the segment where the function $g(V_{in}) = V_{out}(V_{in}) - V_{in}$ changes sign and then using linear interpolation to find the root.\n\nThe final computed values, $[V_M, NM_L, NM_H]$, for each parameter set are rounded to six decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print the results.\n    \"\"\"\n    # Test cases: (V_DD, V_Tn, V_Tp, beta_n, beta_p, lambda_n, lambda_p, g_min)\n    # Common parameters N and eps_V are handled inside the solver function.\n    test_cases = [\n        # Case A\n        (1.0, 0.4, 0.4, 2e-4, 2e-4, 0.02, 0.02, 1e-12),\n        # Case B\n        (1.0, 0.4, 0.4, 2e-4, 3e-4, 0.02, 0.02, 1e-12),\n        # Case C\n        (0.9, 0.45, 0.45, 2e-4, 2e-4, 0.01, 0.01, 1e-12),\n        # Case D\n        (1.2, 0.35, 0.4, 1e-4, 4e-4, 0.0, 0.0, 1e-12),\n        # Case E\n        (1.2, 0.35, 0.5, 2.5e-4, 1.5e-4, 0.05, 0.05, 1e-12),\n    ]\n\n    N = 2001\n    eps_V = 1e-9\n\n    results = []\n    for params in test_cases:\n        metrics = calculate_metrics(params, N, eps_V)\n        results.append(metrics)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef get_nmos_current(v_out, v_in, v_tn, beta_n, lambda_n):\n    \"\"\"\n    Computes the nMOS drain current using the Shichman-Hodges model.\n    \"\"\"\n    v_gs = v_in\n    v_ds = v_out\n\n    if v_gs <= v_tn:  # Cutoff\n        return 0.0\n    \n    v_ov = v_gs - v_tn\n    \n    if v_ds < v_ov:  # Triode\n        return beta_n * (v_ov * v_ds - 0.5 * v_ds**2) * (1 + lambda_n * v_ds)\n    else:  # Saturation\n        return 0.5 * beta_n * v_ov**2 * (1 + lambda_n * v_ds)\n\ndef get_pmos_current(v_out, v_in, v_dd, v_tp, beta_p, lambda_p):\n    \"\"\"\n    Computes the pMOS drain current magnitude using the Shichman-Hodges model.\n    Note: V_Tp is a positive value.\n    \"\"\"\n    v_sg = v_dd - v_in\n    v_sd = v_dd - v_out\n\n    if v_sg <= v_tp:  # Cutoff\n        return 0.0\n    \n    v_ov = v_sg - v_tp\n    \n    if v_sd < v_ov:  # Triode\n        return beta_p * (v_ov * v_sd - 0.5 * v_sd**2) * (1 + lambda_p * v_sd)\n    else:  # Saturation\n        return 0.5 * beta_p * v_ov**2 * (1 + lambda_p * v_sd)\n\ndef bisection_solver(kcl_func, v_low, v_high, v_tol, max_iter=100):\n    \"\"\"\n    Solves kcl_func(v_out) = 0 for v_out using the bisection method.\n    \"\"\"\n    low, high = v_low, v_high\n    f_low = kcl_func(low)\n    \n    for _ in range(max_iter):\n        mid = (low + high) / 2.0\n        if high - low < v_tol:\n            return mid\n        \n        f_mid = kcl_func(mid)\n        \n        if np.sign(f_mid) == np.sign(f_low):\n            low = mid\n            f_low = f_mid\n        else:\n            high = mid\n            \n    return (low + high) / 2.0\n\ndef calculate_metrics(params, N, eps_V):\n    \"\"\"\n    Calculates V_M, NM_L, and NM_H for a given set of inverter parameters.\n    \"\"\"\n    V_DD, V_Tn, V_Tp, beta_n, beta_p, lambda_n, lambda_p, g_min = params\n    \n    v_in_sweep = np.linspace(0, V_DD, N)\n    v_out_curve = np.zeros(N)\n\n    for i, v_in in enumerate(v_in_sweep):\n        kcl_eq = lambda v_out: (\n            get_nmos_current(v_out, v_in, V_Tn, beta_n, lambda_n) -\n            get_pmos_current(v_out, v_in, V_DD, V_Tp, beta_p, lambda_p) +\n            g_min * (2 * v_out - V_DD)\n        )\n        v_out_curve[i] = bisection_solver(kcl_eq, 0.0, V_DD, eps_V)\n\n    # --- Parameter Extraction ---\n\n    # VOH, VOL\n    V_OH = v_out_curve[0]\n    V_OL = v_out_curve[-1]\n\n    # VIL, VIH\n    dv_out_dv_in = np.gradient(v_out_curve, v_in_sweep)\n    \n    # Find VIL (first crossing of -1 from above)\n    V_IL = -1.0\n    for i in range(len(dv_out_dv_in) - 1):\n        if dv_out_dv_in[i] > -1.0 and dv_out_dv_in[i+1] <= -1.0:\n            # Linear interpolation\n            v1, v2 = v_in_sweep[i], v_in_sweep[i+1]\n            d1, d2 = dv_out_dv_in[i], dv_out_dv_in[i+1]\n            V_IL = v1 + (v2 - v1) * (-1.0 - d1) / (d2 - d1)\n            break\n            \n    # Find VIH (second crossing of -1 from below)\n    V_IH = -1.0\n    for i in range(len(dv_out_dv_in) - 1, 0, -1):\n        if dv_out_dv_in[i] > -1.0 and dv_out_dv_in[i-1] <= -1.0:\n            # Linear interpolation\n            v1, v2 = v_in_sweep[i-1], v_in_sweep[i]\n            d1, d2 = dv_out_dv_in[i-1], dv_out_dv_in[i]\n            V_IH = v1 + (v2 - v1) * (-1.0 - d1) / (d2 - d1)\n            break\n            \n    # NM_L, NM_H\n    NM_L = V_IL - V_OL\n    NM_H = V_OH - V_IH\n\n    # VM\n    diff = v_out_curve - v_in_sweep\n    V_M = -1.0\n    found_vm_crossover = False\n    for i in range(len(diff) - 1):\n        if np.sign(diff[i]) != np.sign(diff[i+1]):\n            # Linear interpolation for V_out - V_in = 0\n            v1, v2 = v_in_sweep[i], v_in_sweep[i+1]\n            d1, d2 = diff[i], diff[i+1]\n            V_M = v1 - d1 * (v2 - v1) / (d2 - d1)\n            found_vm_crossover = True\n            break\n    \n    if not found_vm_crossover:\n        # Fallback if no sign change is detected due to discretization\n        idx = np.argmin(np.abs(diff))\n        V_M = v_in_sweep[idx]\n\n    return [round(V_M, 6), round(NM_L, 6), round(NM_H, 6)]\n\n# Run the solver\nsolve()\n```"
        }
    ]
}