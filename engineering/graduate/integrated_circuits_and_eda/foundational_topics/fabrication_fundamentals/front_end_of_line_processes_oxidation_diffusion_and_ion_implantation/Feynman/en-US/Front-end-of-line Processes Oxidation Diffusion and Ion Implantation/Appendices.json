{
    "hands_on_practices": [
        {
            "introduction": "The Deal-Grove model is the cornerstone for understanding silicon oxidation, but its common textbook form applies only to isothermal conditions. This practice challenges you to work with the model's more fundamental differential form to simulate oxidation during a realistic, non-isothermal process, such as a temperature ramp . By numerically solving the governing ordinary differential equation, you will gain a deeper appreciation for how rate parameters evolve with temperature and develop skills essential for modern Technology Computer-Aided Design (TCAD) tools.",
            "id": "4273892",
            "problem": "Consider thermal oxidation of crystalline silicon in a dry oxygen ambient in the Front-End-Of-Line (FEOL) of complementary metal-oxide-semiconductor integrated circuit fabrication. The oxide thickness $x_{ox}(t)$ evolves due to oxidant diffusion through silicon dioxide and reaction at the silicon interface. Assume a non-isothermal process where the temperature is a prescribed function $T(t)$ and both the parabolic rate parameter $B(T)$ and the linear rate parameter $B/A(T)$ depend on $T$ via Arrhenius relations. Beginning from the fundamental base consisting of Fick's first law of diffusion, interfacial reaction kinetics, and mass conservation at the moving silicon/silicon-dioxide interface, derive a well-posed ordinary differential equation for $x_{ox}(t)$ under the quasi-steady approximation for the oxidant profile in the oxide film. Explicitly define how $B(T)$ and $B/A(T)$ enter the governing equation through their dependence on $T(t)$.\n\nUse the following physically grounded definitions and data:\n- Let the parabolic rate parameter be modeled as $B(T) = B_0 \\exp\\!\\left(-\\dfrac{E_B}{k_B T}\\right)$ and the linear rate parameter be modeled as $K(T) = \\dfrac{B(T)}{A(T)} = K_0 \\exp\\!\\left(-\\dfrac{E_K}{k_B T}\\right)$, where $K(T)$ denotes $B/A(T)$. Here $k_B$ is the Boltzmann constant expressed as $k_B = 8.617333262145 \\times 10^{-5}$ $\\mathrm{eV/K}$.\n- Choose the activation energies $E_B = 1.23$ $\\mathrm{eV}$ and $E_K = 2.00$ $\\mathrm{eV}$.\n- Calibrate the pre-exponential factors $B_0$ and $K_0$ by enforcing $B(T_{ref}) = B_{ref}$ and $K(T_{ref}) = K_{ref}$ at the reference temperature $T_{ref} = 1273$ $\\mathrm{K}$. Use $B_{ref} = 3.25 \\times 10^{-18}$ $\\mathrm{m^2/s}$ and $K_{ref} = 3.89 \\times 10^{-12}$ $\\mathrm{m/s}$. This implies $B_0 = B_{ref} \\exp\\!\\left(\\dfrac{E_B}{k_B T_{ref}}\\right)$ and $K_0 = K_{ref} \\exp\\!\\left(\\dfrac{E_K}{k_B T_{ref}}\\right)$.\n- The initial oxide thickness at time $t=0$ is $x_{ox}(0) = x_0$.\n\nYour derivation must start from the fundamental base and arrive at a first-order differential equation for $x_{ox}(t)$ in which $B(T(t))$ and $A(T(t))$ appear through the instantaneous temperature $T(t)$.\n\nImplement a program that numerically integrates the derived differential equation for the following test suite. For each case, report the oxide thickness at the specified final time in nanometers, rounded to three decimal digits:\n\n- Case $\\#1$ (general ramp, happy path): $x_0 = 2$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, and $T(t) = 1000 + \\left(\\dfrac{200}{3600}\\right) t$ $\\mathrm{K}$ for $t \\in [0, 3600]$.\n- Case $\\#2$ (piecewise constant then ramp): $x_0 = 1$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, and\n  $$\n  T(t) =\n  \\begin{cases}\n  1050 \\ \\mathrm{K}, & 0 \\le t \\le 1800, \\\\\n  1050 + \\left(\\dfrac{100}{1800}\\right) (t - 1800) \\ \\mathrm{K}, & 1800 < t \\le 3600.\n  \\end{cases}\n  $$\n- Case $\\#3$ (boundary edge with zero initial oxide and decreasing ramp): $x_0 = 0$ $\\mathrm{nm}$, $t_{end} = 1200$ $\\mathrm{s}$, and $T(t) = 1300 - \\left(\\dfrac{200}{1200}\\right) t$ $\\mathrm{K}$ for $t \\in [0, 1200]$.\n- Case $\\#4$ (parabolic-limited regime check): $x_0 = 200$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, and $T(t) = 1200$ $\\mathrm{K}$ for $t \\in [0, 3600]$.\n\nPhysical and numerical units:\n- Report $x_{ox}(t_{end})$ in $\\mathrm{nm}$ rounded to three decimal digits.\n- Time is in $\\mathrm{s}$ and temperature is in $\\mathrm{K}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example $[x_1,x_2,x_3,x_4]$, where each $x_i$ is the rounded float in nanometers as specified.",
            "solution": "The user has requested the derivation of a governing ordinary differential equation (ODE) for non-isothermal silicon oxidation based on fundamental principles, followed by a numerical implementation to solve for final oxide thickness in several specified scenarios.\n\n### Step 1: Extract Givens\n- **Physical Process**: Thermal oxidation of crystalline silicon in a dry oxygen ambient.\n- **Governing Physics**: Fick's first law of diffusion, interfacial reaction kinetics, and mass conservation.\n- **Approximation**: Quasi-steady state for the oxidant profile in the oxide.\n- **Time-Varying Temperature**: $T(t)$, a prescribed function of time $t$.\n- **Rate Parameters**:\n    - Parabolic rate parameter: $B(T) = B_0 \\exp\\left(-\\dfrac{E_B}{k_B T}\\right)$.\n    - Linear rate parameter: $K(T) = \\dfrac{B(T)}{A(T)} = K_0 \\exp\\left(-\\dfrac{E_K}{k_B T}\\right)$.\n- **Constants**:\n    - Boltzmann constant: $k_B = 8.617333262145 \\times 10^{-5}$ $\\mathrm{eV/K}$.\n    - Activation energy for $B$: $E_B = 1.23$ $\\mathrm{eV}$.\n    - Activation energy for $K=B/A$: $E_K = 2.00$ $\\mathrm{eV}$.\n- **Calibration Data**:\n    - Reference temperature: $T_{ref} = 1273$ $\\mathrm{K}$.\n    - Reference parabolic rate: $B_{ref} = 3.25 \\times 10^{-18}$ $\\mathrm{m^2/s}$.\n    - Reference linear rate: $K_{ref} = 3.89 \\times 10^{-12}$ $\\mathrm{m/s}$.\n- **Pre-exponential Factors**: Defined by calibration: $B_0 = B_{ref} \\exp\\left(\\dfrac{E_B}{k_B T_{ref}}\\right)$ and $K_0 = K_{ref} \\exp\\left(\\dfrac{E_K}{k_B T_{ref}}\\right)$.\n- **Initial Condition**: Oxide thickness at $t=0$ is $x_{ox}(0) = x_0$.\n- **Task**:\n    1. Derive the first-order ODE for $x_{ox}(t)$.\n    2. Implement a numerical solver for four test cases and report the final oxide thickness $x_{ox}(t_{end})$ in nanometers, rounded to three decimal places.\n- **Test Cases**:\n    - Case 1: $x_0 = 2$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, $T(t) = 1000 + \\left(\\dfrac{200}{3600}\\right) t$ $\\mathrm{K}$ for $t \\in [0, 3600]$.\n    - Case 2: $x_0 = 1$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, $T(t) = 1050 \\ \\mathrm{K}$ for $0 \\le t \\le 1800$ and $T(t) = 1050 + \\left(\\dfrac{100}{1800}\\right) (t - 1800) \\ \\mathrm{K}$ for $1800 < t \\le 3600$.\n    - Case 3: $x_0 = 0$ $\\mathrm{nm}$, $t_{end} = 1200$ $\\mathrm{s}$, $T(t) = 1300 - \\left(\\dfrac{200}{1200}\\right) t$ $\\mathrm{K}$ for $t \\in [0, 1200]$.\n    - Case 4: $x_0 = 200$ $\\mathrm{nm}$, $t_{end} = 3600$ $\\mathrm{s}$, $T(t) = 1200$ $\\mathrm{K}$ for $t \\in [0, 3600]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation before proceeding.\n\n- **Scientifically Grounded**: The problem describes the Deal-Grove model for silicon oxidation, which is a fundamental, experimentally-verified, and widely-used model in semiconductor process engineering. The derivation is based on first principles of mass transport (Fick's law) and reaction kinetics. The Arrhenius-type temperature dependencies are physically sound. The given parameter values are realistic for the dry oxidation of silicon.\n- **Well-Posed**: The task is to derive a first-order initial value problem. The specified ODE form $\\frac{dx_{ox}}{dt} = f(t, x_{ox})$ with a given initial condition $x_{ox}(0) = x_0$ is a well-posed problem, guaranteeing a unique and stable solution for the continuous and well-behaved temperature functions provided. The case with $x_0 = 0$ is a valid initial condition that does not introduce a singularity into the differential equation itself.\n- **Objective**: All terms, constants, and conditions are quantitatively and precisely defined. There is no subjective or ambiguous language.\n- **Completeness and Consistency**: The problem provides all necessary information. The parameters $B_0$ and $K_0$ are unambiguously defined through a calibration procedure, ensuring the model is fully specified. There are no contradictions in the provided data.\n- **Feasibility**: The temperature profiles and time scales are representative of actual thermal processing steps in semiconductor manufacturing.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is a valid problem requiring a rigorous derivation and numerical solution.\n\n### Derivation of the Governing Differential Equation\n\nThe derivation follows the classic framework established by Deal and Grove. We consider a one-dimensional system where the oxide grows in the $x$-direction. Let the gas-oxide interface be at $x=0$ and the moving Si/SiO$_2$ interface be at $x=x_{ox}(t)$.\n\n1.  **Oxidant Fluxes**: We model two principal flux mechanisms for the oxidant species (e.g., O$_2$ molecules). Let $C(x)$ be the concentration of the oxidant within the SiO$_2$ film.\n    - **Flux $F_1$ (Diffusion)**: The transport of oxidant from the gas-oxide interface to the silicon-oxide interface is governed by Fick's first law of diffusion. The quasi-steady state approximation ($\\partial C / \\partial t \\approx 0$) implies that the diffusion flux $F_1$ is constant with respect to position $x$ across the oxide layer. Integrating $F_1 = -D \\frac{dC}{dx}$ from $x=0$ to $x=x_{ox}(t)$, where $D$ is the oxidant diffusivity, yields:\n      $$ F_1 = D \\frac{C_S - C_i}{x_{ox}(t)} $$\n      Here, $C_S$ is the oxidant concentration at the surface ($x=0$), assumed to be in equilibrium with the ambient gas, and $C_i$ is the concentration at the Si-SiO$_2$ interface ($x=x_{ox}$).\n\n    - **Flux $F_2$ (Reaction)**: At the Si-SiO$_2$ interface, the oxidant is consumed by the chemical reaction $\\text{Si} + \\text{O}_2 \\rightarrow \\text{SiO}_2$. We assume first-order reaction kinetics, where the consumption rate is proportional to the local oxidant concentration $C_i$. The flux corresponding to this reaction is:\n      $$ F_2 = k C_i $$\n      where $k$ is the interfacial reaction rate constant.\n\n2.  **Steady-State Flux Condition**: In the quasi-steady state, the flux of oxidants arriving at the interface must equal the flux consumed by the reaction. Thus, $F_1 = F_2 = F$.\n    $$ D \\frac{C_S - C_i}{x_{ox}} = k C_i $$\n    We solve this equation for the unknown interface concentration $C_i$:\n    $$ D C_S - D C_i = k x_{ox} C_i \\implies D C_S = (D + k x_{ox}) C_i \\implies C_i = \\frac{D C_S}{D + k x_{ox}} $$\n    Substituting this expression for $C_i$ back into the formula for the flux $F = k C_i$, we get:\n    $$ F = k \\left( \\frac{D C_S}{D + k x_{ox}} \\right) = \\frac{k D C_S}{D + k x_{ox}} $$\n    This can be rewritten in a more insightful form by dividing the numerator and denominator by $kD$:\n    $$ F = \\frac{C_S}{\\frac{1}{k} + \\frac{x_{ox}}{D}} $$\n\n3.  **Oxide Growth Rate**: Let $N_1$ be the number of oxidant molecules incorporated into a unit volume of silicon dioxide. The growth of the oxide layer is governed by mass conservation: the rate of increase in oxide volume per unit area is proportional to the oxidant flux.\n    $$ N_1 \\frac{dx_{ox}}{dt} = F $$\n    Substituting our expression for $F$ gives the differential equation for oxide growth:\n    $$ \\frac{dx_{ox}}{dt} = \\frac{F}{N_1} = \\frac{C_S/N_1}{\\frac{1}{k} + \\frac{x_{ox}}{D}} $$\n\n4.  **Relating to Standard Deal-Grove Parameters**: The standard Deal-Grove model is expressed in terms of a parabolic rate constant $B$ and a linear rate constant $B/A$. The differential form is:\n    $$ \\frac{dx_{ox}}{dt} = \\frac{B}{A + 2x_{ox}} $$\n    To match our derived equation to this standard form, we identify the parameters. Let's manipulate our derived equation:\n    $$ \\frac{dx_{ox}}{dt} = \\frac{C_S/N_1}{\\frac{1}{k} + \\frac{x_{ox}}{D}} = \\frac{2 D (C_S/N_1)}{\\frac{2D}{k} + 2x_{ox}} $$\n    By comparing $\\frac{dx_{ox}}{dt} = \\frac{2 D (C_S/N_1)}{\\frac{2D}{k} + 2x_{ox}}$ with $\\frac{dx_{ox}}{dt} = \\frac{B}{A + 2x_{ox}}$, we can make the following identifications:\n    - The parabolic rate constant is $B \\equiv 2D \\frac{C_S}{N_1}$. This parameter governs growth when diffusion is the limiting step ($x_{ox}$ is large).\n    - The parameter $A \\equiv \\frac{2D}{k}$.\n    - The linear rate constant is then $K \\equiv \\frac{B}{A} = \\frac{2D (C_S/N_1)}{2D/k} = k \\frac{C_S}{N_1}$. This parameter governs growth when the interfacial reaction is the limiting step ($x_{ox}$ is small).\n\n5.  **Non-Isothermal Formulation**: In a non-isothermal process, the temperature $T$ is a function of time, $T(t)$. The physical parameters $D$, $k$, and $C_S$ are all strongly dependent on temperature, typically following Arrhenius relationships. The problem statement directly provides the Arrhenius forms for the composite parameters $B(T)$ and $K(T) = B/A(T)$.\n    - $B(T(t)) = B_0 \\exp\\left(-\\dfrac{E_B}{k_B T(t)}\\right)$\n    - $K(T(t)) = K_0 \\exp\\left(-\\dfrac{E_K}{k_B T(t)}\\right)$\n\n    From these, the time-dependent parameter $A(t)$ can be found:\n    $$ A(T(t)) = \\frac{B(T(t))}{K(T(t))} $$\n    Substituting these time-dependent parameters into the standard differential form yields the final, well-posed ordinary differential equation for non-isothermal oxidation:\n    $$ \\frac{dx_{ox}}{dt} = \\frac{B(T(t))}{A(T(t)) + 2x_{ox}(t)} $$\n    This is a first-order, nonlinear ODE for $x_{ox}(t)$. It is an initial value problem, fully specified by the initial condition $x_{ox}(0) = x_0$. This equation is to be solved numerically. It correctly captures the transition between the reaction-limited regime (at small $x_{ox}$ or low $T$) and the diffusion-limited regime (at large $x_{ox}$ or high $T$) under time-varying temperature conditions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves the Deal-Grove model for non-isothermal\n    silicon oxidation for a suite of test cases.\n    \"\"\"\n\n    # Physical and model constants in SI units (m, s, K, eV)\n    K_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    E_B = 1.23                 # Activation energy for B in eV\n    E_K = 2.00                 # Activation energy for B/A in eV\n\n    # Reference values for calibration\n    T_REF = 1273.0             # Reference temperature in K\n    B_REF = 3.25e-18           # B at T_REF in m^2/s\n    K_REF = 3.89e-12           # B/A at T_REF in m/s\n\n    # Calculate pre-exponential factors B0 and K0\n    # B0 = B_ref * exp(E_B / (k_B * T_ref))\n    # K0 = K_ref * exp(E_K / (k_B * T_ref))\n    b0 = B_REF * np.exp(E_B / (K_B * T_REF))\n    k0 = K_REF * np.exp(E_K / (K_B * T_REF))\n\n    def B_func(T):\n        \"\"\"Parabolic rate constant B(T) in m^2/s.\"\"\"\n        return b0 * np.exp(-E_B / (K_B * T))\n\n    def K_func(T):\n        \"\"\"Linear rate constant K(T) = B/A(T) in m/s.\"\"\"\n        return k0 * np.exp(-E_K / (K_B * T))\n\n    def ode_rhs(t, x, temp_func):\n        \"\"\"\n        Right-hand side of the ODE for oxide growth, dx_ox/dt.\n        t: current time in s\n        x: state vector [x_ox] in m\n        temp_func: a function T(t) that returns temperature in K\n        \"\"\"\n        x_ox = x[0]\n        T = temp_func(t)\n\n        B_val = B_func(T)\n        K_val = K_func(T)\n        \n        # A = B / (B/A)\n        # Handle the case where K_val might be extremely small, though\n        # with exp form it's always positive.\n        if K_val == 0:\n             # Physically, this implies infinite A, so reaction-limited growth is zero.\n             # This case should not be reached with the given valid parameters.\n             return [0.0]\n        \n        A_val = B_val / K_val\n        \n        # dx_ox/dt = B / (A + 2*x_ox)\n        dxdt = B_val / (A_val + 2 * x_ox)\n        \n        return [dxdt]\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"x0_nm\": 2.0, \"t_end\": 3600.0,\n            \"T_func\": lambda t: 1000.0 + (200.0 / 3600.0) * t,\n            \"label\": \"Case #1 (general ramp)\"\n        },\n        {\n            \"x0_nm\": 1.0, \"t_end\": 3600.0,\n            \"T_func\": lambda t: 1050.0 if t <= 1800.0 else 1050.0 + (100.0 / 1800.0) * (t - 1800.0),\n            \"label\": \"Case #2 (piecewise)\"\n        },\n        {\n            \"x0_nm\": 0.0, \"t_end\": 1200.0,\n            \"T_func\": lambda t: 1300.0 - (200.0 / 1200.0) * t,\n            \"label\": \"Case #3 (zero initial oxide)\"\n        },\n        {\n            \"x0_nm\": 200.0, \"t_end\": 3600.0,\n            \"T_func\": lambda t: 1200.0,\n            \"label\": \"Case #4 (parabolic-limited)\"\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        x0_m = case[\"x0_nm\"] * 1e-9  # Convert initial thickness from nm to m\n        t_span = (0, case[\"t_end\"])\n        \n        # Numerically integrate the ODE\n        sol = solve_ivp(\n            fun=ode_rhs,\n            t_span=t_span,\n            y0=[x0_m],\n            args=(case[\"T_func\"],),\n            method='RK45', # Standard robust solver\n            rtol=1e-8,\n            atol=1e-12\n        )\n        \n        # Extract final thickness, convert from m to nm, and round\n        final_thickness_m = sol.y[0, -1]\n        final_thickness_nm = final_thickness_m * 1e9\n        rounded_result = round(final_thickness_nm, 3)\n        results.append(f\"{rounded_result:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Semiconductor manufacturing processes are rarely performed in isolation; they interact in complex and critical ways. This exercise explores the crucial interplay between thermal oxidation and dopant diffusion following ion implantation . You will model two competing phenomena: Oxidation-Enhanced Diffusion (OED), where the oxidation process accelerates dopant movement, and silicon consumption, where the growing oxide effectively moves the junction. Mastering this integrated model is key to accurately predicting and controlling the final junction depth in a device.",
            "id": "4273844",
            "problem": "You are given a one-dimensional planar silicon substrate undergoing front-end-of-line (FEOL) processing within Integrated Circuits and Electronic Design Automation (EDA). A phosphorus ion implantation produces an initial dopant profile that is well-approximated by a Gaussian distribution in depth. The wafer is then annealed at a fixed temperature of $1000\\,^{\\circ}\\mathrm{C}$ for $30\\ \\mathrm{min}$, either in an inert ambient (no oxidation) or in an oxidizing ambient (simultaneous oxidation). Your task is to compute the change in junction depth caused by oxidation relative to the inert ambient anneal.\n\nFundamental base and modeling assumptions:\n- The phosphorus concentration $C(x,t)$ evolves under isothermal diffusion governed by Fick's second law with constant diffusivity $D$: $\\displaystyle \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2}$.\n- The initial phosphorus profile after ion implantation is Gaussian with total implanted dose $Q$ (sheet density), projected range $R_p$, and straggle $\\Delta R_p$: $$C(x,0) = \\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_p}\\exp\\left(-\\frac{(x-R_p)^2}{2\\Delta R_p^2}\\right).$$\n- For a constant $D$, the solution remains Gaussian with increasing variance: $$C(x,t) = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma(t)}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma(t)^2}\\right),\\quad \\sigma(t) = \\sqrt{\\Delta R_p^2 + 2 D t}.$$\n- The junction depth $x_j(t)$ is defined as the position where the phosphorus concentration equals the background acceptor concentration $N_A$ (i.e., $C(x_j,t) = N_A$), assuming $C(x,t)$ represents electrically active dopant.\n- Under simultaneous oxidation, the oxidized thickness $x_{\\mathrm{ox}}(t)$ obeys the Deal–Grove model (neglecting initial oxide): $x_{\\mathrm{ox}}^2 + A x_{\\mathrm{ox}} = B t,$ where $A$ is the linear rate constant and $B$ is the parabolic rate constant, with $t$ in minutes and $x_{\\mathrm{ox}}$ in micrometers. The oxidation rate at time $t$ is $$v_{\\mathrm{ox}}(t) = \\frac{d x_{\\mathrm{ox}}}{dt} = \\frac{B}{2 x_{\\mathrm{ox}} + A}.$$\n- Oxidation-Enhanced Diffusion (OED) is modeled via an effective diffusivity $D_{\\mathrm{ox}} = D_{\\mathrm{inert}} M$, where $M = 1 + \\gamma v_{\\mathrm{ox}}(t)$ and $\\gamma$ is a proportionality constant capturing the interstitial supersaturation effect induced by oxidation (simplified surrogate model).\n- Silicon consumption by oxidation moves the silicon surface inward. The consumed silicon thickness is $\\eta x_{\\mathrm{ox}}$, where $\\eta = 0.44$ relates silicon consumption to oxide growth. The measured junction depth after oxidation is the chemically diffused junction depth referenced to the original surface minus the consumed silicon thickness.\n- If $C(x,t)$ never equals $N_A$ for $x \\ge 0$, the junction depth does not exist; return a sentinel value of $-1$ for that test case.\n\nConstants and units:\n- Temperature: $T = 1000\\,^{\\circ}\\mathrm{C} = 1273.15\\ \\mathrm{K}$.\n- Anneal duration: $t = 30\\ \\mathrm{min} = 1800\\ \\mathrm{s}$.\n- Boltzmann constant: $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$.\n- Phosphorus intrinsic diffusivity Arrhenius parameters in silicon: $D_0 = 10.5\\ \\mathrm{cm}^2/\\mathrm{s}$, $E_a = 3.69\\ \\mathrm{eV}$, so $D_{\\mathrm{inert}} = D_0 \\exp\\!\\left(-\\frac{E_a}{k_{\\mathrm{B}} T}\\right)$.\n- Deal–Grove constants at $1000\\,^{\\circ}\\mathrm{C}$:\n  - Dry oxidation: $A_{\\mathrm{dry}} = 0.04\\ \\mu\\mathrm{m}$, $B_{\\mathrm{dry}} = 2.0\\times 10^{-4}\\ \\mu\\mathrm{m}^2/\\mathrm{min}$.\n  - Wet oxidation: $A_{\\mathrm{wet}} = 0.02\\ \\mu\\mathrm{m}$, $B_{\\mathrm{wet}} = 1.0\\times 10^{-2}\\ \\mu\\mathrm{m}^2/\\mathrm{min}$.\n- OED proportionality: $\\gamma = 50\\ \\mathrm{min}/\\mu\\mathrm{m}$.\n- Silicon consumption factor: $\\eta = 0.44$.\n- Spatial unit consistency: lengths for diffusion are computed in $\\mathrm{cm}$ internally; output junction depth changes must be in micrometers.\n\nComputation steps for each test case:\n1. Compute $D_{\\mathrm{inert}}$ from the Arrhenius model.\n2. Compute $\\sigma_{\\mathrm{inert}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} t}$ using $\\Delta R_p$ in $\\mathrm{cm}$ and $t$ in $\\mathrm{s}$.\n3. Compute the inert-ambient junction depth $x_{j,\\mathrm{inert}}$ by solving $$\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma_{\\mathrm{inert}}^2}\\right) = N_A.$$ This yields the deeper solution $$x_{j,\\mathrm{inert}} = R_p + \\sigma_{\\mathrm{inert}}\\sqrt{2\\ln\\!\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}\\,N_A}\\right)}$$ when $\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}} > N_A$; otherwise no junction exists.\n4. For oxidation, compute $x_{\\mathrm{ox}}$ by solving $x_{\\mathrm{ox}}^2 + A x_{\\mathrm{ox}} = B t$ with $t$ in $\\mathrm{min}$ to obtain $$x_{\\mathrm{ox}} = \\frac{-A + \\sqrt{A^2 + 4 B t}}{2}.$$ Then compute $v_{\\mathrm{ox}} = B/(2 x_{\\mathrm{ox}} + A)$ and the OED multiplier $M = 1 + \\gamma v_{\\mathrm{ox}}$.\n5. Compute $\\sigma_{\\mathrm{ox}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} M t}$ and $x_{j,\\mathrm{ox,orig}}$ using the same Gaussian crossing formula at $N_A$ as in step 3 but with $\\sigma_{\\mathrm{ox}}$.\n6. Adjust for surface consumption to get the measured junction depth after oxidation: $$x_{j,\\mathrm{ox,meas}} = x_{j,\\mathrm{ox,orig}} - \\eta x_{\\mathrm{ox}},$$ where $x_{\\mathrm{ox}}$ is converted to $\\mathrm{cm}$ before subtraction.\n7. Compute the change in junction depth in micrometers: $$\\Delta x_j = \\left(x_{j,\\mathrm{ox,meas}} - x_{j,\\mathrm{inert}}\\right)\\times 10^{4}.$$ If either inert or oxidation case has no valid junction depth, return $-1$.\n8. Express the final answers in micrometers as floats.\n\nTest suite:\nProvide the following four parameter sets to test coverage including typical conditions, strong oxidation, and edge cases:\n- Case 1 (typical dry oxidation): ambient $=$ dry; $Q = 2.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.08\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.03\\ \\mu\\mathrm{m}$; $N_A = 1.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n- Case 2 (typical wet oxidation): ambient $=$ wet; $Q = 2.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.08\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.03\\ \\mu\\mathrm{m}$; $N_A = 1.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n- Case 3 (edge: no junction due to high background doping and low dose): ambient $=$ dry; $Q = 5.0\\times 10^{12}\\ \\mathrm{cm}^{-2}$; $R_p = 0.05\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.02\\ \\mu\\mathrm{m}$; $N_A = 5.0\\times 10^{18}\\ \\mathrm{cm}^{-3}$.\n- Case 4 (wet oxidation with large straggle): ambient $=$ wet; $Q = 1.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.04\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.08\\ \\mu\\mathrm{m}$; $N_A = 5.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$). Each $result_i$ must be either a float in micrometers (for valid junction depth changes) or the integer $-1$ (for invalid/no-junction cases). No additional text should be printed.",
            "solution": "The problem presents a well-defined, scientifically grounded exercise in modeling front-end-of-line (FEOL) semiconductor processes. It combines models for ion implantation, thermal diffusion, and thermal oxidation to determine the effect of an oxidizing ambient on dopant profiles and junction depths. The models provided, including the Gaussian approximation for dopant profiles, Fick's second law for diffusion, the Deal-Grove model for oxidation, and a simplified model for Oxidation-Enhanced Diffusion (OED), are standard, albeit simplified, representations used in process simulation. All necessary physical constants, material parameters, and process conditions are provided, and the computational steps are explicitly outlined. The problem is self-contained, logically consistent, and free of scientific or factual unsoundness. We may therefore proceed with a formal solution.\n\nThe objective is to calculate the change in junction depth, $\\Delta x_j$, when an anneal is performed in an oxidizing ambient compared to an inert ambient. This requires computing the junction depth for two scenarios and finding their difference. The junction depth, $x_j$, is the location where the dopant concentration, $C(x,t)$, equals the background substrate doping, $N_A$. All length calculations will be performed in units of centimeters ($\\mathrm{cm}$) and converted to micrometers ($\\mu\\mathrm{m}$) for the final output.\n\nThe initial dopant profile after ion implantation is given as a Gaussian function:\n$$C(x,0) = \\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_p}\\exp\\left(-\\frac{(x-R_p)^2}{2\\Delta R_p^2}\\right)$$\nwhere $Q$ is the implanted dose, $R_p$ is the projected range, and $\\Delta R_p$ is the straggle.\n\nDuring a subsequent thermal anneal of duration $t$ at temperature $T$, the dopants diffuse. Assuming constant diffusivity $D$, the concentration profile remains Gaussian, but its standard deviation increases:\n$$C(x,t) = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma(t)}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma(t)^2}\\right)$$\nThe time-dependent standard deviation, $\\sigma(t)$, is given by the convolution of the initial Gaussian profile with the Gaussian Green's function for diffusion, resulting in:\n$$\\sigma(t) = \\sqrt{\\Delta R_p^2 + 2 D t}$$\nThis quantity, $2Dt$, is often referred to as the diffusion length squared.\n\nFirst, we establish a baseline by calculating the junction depth for an anneal in an inert ambient.\n1.  **Compute Inert Diffusivity ($D_{\\mathrm{inert}}$)**: The diffusivity of phosphorus in silicon is temperature-dependent and follows an Arrhenius relationship:\n    $$D_{\\mathrm{inert}} = D_0 \\exp\\left(-\\frac{E_a}{k_{\\mathrm{B}} T}\\right)$$\n    Using the provided constants $D_0 = 10.5\\ \\mathrm{cm}^2/\\mathrm{s}$, $E_a = 3.69\\ \\mathrm{eV}$, $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$, and $T = 1273.15\\ \\mathrm{K}$, we calculate the intrinsic diffusivity a priori.\n\n2.  **Compute Inert Junction Depth ($x_{j,\\mathrm{inert}}$)**: We first determine the diffused profile standard deviation $\\sigma_{\\mathrm{inert}}$ using $D = D_{\\mathrm{inert}}$, the anneal time $t = 1800\\ \\mathrm{s}$, and the initial straggle $\\Delta R_p$ (converted from $\\mu\\mathrm{m}$ to $\\mathrm{cm}$).\n    $$\\sigma_{\\mathrm{inert}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} t}$$\n    The junction depth $x_{j,\\mathrm{inert}}$ is found by setting $C(x,t) = N_A$ and solving for $x$. This requires the peak concentration $C_{peak} = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}}$ to be greater than the background concentration $N_A$. If $C_{peak} \\le N_A$, no junction is formed, and the analysis for that test case terminates with a sentinel value of $-1$. Otherwise, rearranging the concentration equation yields two solutions for $x$; we take the deeper one:\n    $$x_{j,\\mathrm{inert}} = R_p + \\sigma_{\\mathrm{inert}}\\sqrt{2\\ln\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}} N_A}\\right)}$$\n    Both $R_p$ and $\\Delta R_p$ are converted to $\\mathrm{cm}$ for this calculation.\n\nNext, we analyze the case of annealing in an oxidizing ambient, which introduces two competing effects: Oxidation-Enhanced Diffusion (OED) and silicon consumption at the surface.\n\n3.  **Model Oxidation**: The thickness of the grown oxide, $x_{\\mathrm{ox}}$, is calculated using the Deal-Grove model for the full anneal duration $t = 30\\ \\mathrm{min}$. We solve the quadratic equation $x_{\\mathrm{ox}}^2 + A\\,x_{\\mathrm{ox}} - B\\,t = 0$ for $x_{\\mathrm{ox}}$:\n    $$x_{\\mathrm{ox}} = \\frac{-A + \\sqrt{A^2 + 4 B t}}{2}$$\n    The constants $A$ and $B$ depend on the ambient (dry or wet).\n    The OED effect is linked to the oxidation rate. The problem specifies a simplified model where the diffusivity enhancement is proportional to the oxidation rate at the end of the process, $t = 30\\ \\mathrm{min}$.\n    $$v_{\\mathrm{ox}} = \\frac{B}{2 x_{\\mathrm{ox}} + A}$$\n    Using this rate, we compute the OED multiplier $M$:\n    $$M = 1 + \\gamma v_{\\mathrm{ox}}$$\n    where $\\gamma = 50\\ \\mathrm{min}/\\mu\\mathrm{m}$. The enhanced diffusivity is then $D_{\\mathrm{ox}} = D_{\\mathrm{inert}} M$.\n\n4.  **Compute Oxidizing-Ambient Junction Depth ($x_{j,\\mathrm{ox,meas}}$)**: The calculation proceeds similarly to the inert case, but with the enhanced diffusivity. The standard deviation of the profile is now:\n    $$\\sigma_{\\mathrm{ox}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} M t}$$\n    This gives the junction depth relative to the original silicon surface, $x_{j,\\mathrm{ox,orig}}$:\n    $$x_{j,\\mathrm{ox,orig}} = R_p + \\sigma_{\\mathrm{ox}}\\sqrt{2\\ln\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{ox}} N_A}\\right)}$$\n    Again, this calculation is only valid if a junction is formed (i.e., peak concentration exceeds $N_A$). If not, the case is invalid.\n    As silicon is oxidized, the silicon surface recedes. For an oxide thickness of $x_{\\mathrm{ox}}$, a thickness of $\\eta\\,x_{\\mathrm{ox}}$ of silicon is consumed, where $\\eta=0.44$. The measured junction depth is referenced from the *new* silicon surface.\n    $$x_{j,\\mathrm{ox,meas}} = x_{j,\\mathrm{ox,orig}} - \\eta\\,x_{\\mathrm{ox}}$$\n    Here, $x_{\\mathrm{ox}}$ must be converted from $\\mu\\mathrm{m}$ into $\\mathrm{cm}$ before the subtraction.\n\n5.  **Calculate Junction Depth Change ($\\Delta x_j$)**: The final step is to compute the difference between the measured junction depths in the two scenarios and convert the result to micrometers.\n    $$\\Delta x_j = (x_{j,\\mathrm{ox,meas}} - x_{j,\\mathrm{inert}}) \\times 10^4$$\n    If either the inert or oxidizing case failed to produce a junction, the result for that entire test case is $-1$.\n\nBy implementing these steps for each test case provided, we can systematically determine the impact of oxidation on the final dopant profile.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the FEOL processing problem for all test cases.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    T_K = 1273.15  # Temperature in Kelvin (1000 C)\n    t_sec = 1800.0  # Anneal duration in seconds (30 min)\n    t_min = 30.0    # Anneal duration in minutes\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    \n    # Phosphorus intrinsic diffusivity parameters\n    D0 = 10.5  # cm^2/s\n    Ea = 3.69  # eV\n    \n    # Deal-Grove constants at 1000 C\n    A_dry = 0.04  # um\n    B_dry = 2.0e-4 # um^2/min\n    A_wet = 0.02  # um\n    B_wet = 1.0e-2 # um^2/min\n    \n    # OED and Si consumption parameters\n    gamma = 50.0  # min/um\n    eta = 0.44    # Dimensionless Si consumption factor\n\n    # Store constants in a dictionary for easy passing\n    constants = {\n        'T_K': T_K, 't_sec': t_sec, 't_min': t_min, 'k_B': k_B,\n        'D0': D0, 'Ea': Ea, 'A_dry': A_dry, 'B_dry': B_dry,\n        'A_wet': A_wet, 'B_wet': B_wet, 'gamma': gamma, 'eta': eta\n    }\n\n    # --- Test Cases ---\n    test_cases = [\n        # (ambient, Q [cm^-2], Rp [um], dRp [um], NA [cm^-3])\n        ('dry', 2.0e14, 0.08, 0.03, 1.0e15),\n        ('wet', 2.0e14, 0.08, 0.03, 1.0e15),\n        ('dry', 5.0e12, 0.05, 0.02, 5.0e18),\n        ('wet', 1.0e14, 0.04, 0.08, 5.0e15),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_delta_xj(case, constants)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_delta_xj(case_params, constants):\n    \"\"\"\n    Calculates the change in junction depth for a single test case.\n    \"\"\"\n    ambient, Q, Rp_um, dRp_um, NA = case_params\n    c = constants\n\n    # --- Unit Conversions ---\n    Rp_cm = Rp_um * 1e-4\n    dRp_cm = dRp_um * 1e-4\n\n    # --- Step 1: Compute Inert Diffusivity (D_inert) ---\n    D_inert = c['D0'] * np.exp(-c['Ea'] / (c['k_B'] * c['T_K']))\n\n    # --- Steps 2 & 3: Inert Anneal Case ---\n    sigma_inert_sq = dRp_cm**2 + 2 * D_inert * c['t_sec']\n    sigma_inert_cm = np.sqrt(sigma_inert_sq)\n    \n    peak_conc_inert = Q / (np.sqrt(2 * np.pi) * sigma_inert_cm)\n    \n    xj_inert_cm = -1.0\n    if peak_conc_inert > NA:\n        log_arg = peak_conc_inert / NA\n        xj_inert_cm = Rp_cm + sigma_inert_cm * np.sqrt(2 * np.log(log_arg))\n\n    # If no inert junction, the difference is invalid.\n    if xj_inert_cm == -1.0:\n        return -1\n\n    # --- Steps 4, 5, & 6: Oxidizing Anneal Case ---\n    # Select Deal-Grove parameters\n    A = c['A_dry'] if ambient == 'dry' else c['A_wet']\n    B = c['B_dry'] if ambient == 'dry' else c['B_wet']\n\n    # Compute oxide thickness x_ox\n    x_ox_um = (-A + np.sqrt(A**2 + 4 * B * c['t_min'])) / 2\n    \n    # Compute final oxidation rate v_ox\n    v_ox_um_per_min = B / (2 * x_ox_um + A)\n    \n    # Compute OED multiplier M\n    M = 1 + c['gamma'] * v_ox_um_per_min\n\n    # Compute diffused profile standard deviation with OED\n    sigma_ox_sq = dRp_cm**2 + 2 * D_inert * M * c['t_sec']\n    sigma_ox_cm = np.sqrt(sigma_ox_sq)\n    \n    peak_conc_ox = Q / (np.sqrt(2 * np.pi) * sigma_ox_cm)\n\n    xj_ox_orig_cm = -1.0\n    if peak_conc_ox > NA:\n        log_arg = peak_conc_ox / NA\n        xj_ox_orig_cm = Rp_cm + sigma_ox_cm * np.sqrt(2 * np.log(log_arg))\n        \n    # If no oxidized junction, the difference is invalid.\n    if xj_ox_orig_cm == -1.0:\n        return -1\n\n    # Adjust for silicon consumption\n    x_ox_cm = x_ox_um * 1e-4\n    xj_ox_meas_cm = xj_ox_orig_cm - c['eta'] * x_ox_cm\n\n    # --- Step 7: Compute final delta_xj ---\n    delta_xj_cm = xj_ox_meas_cm - xj_inert_cm\n    delta_xj_um = delta_xj_cm * 1e4\n    \n    return delta_xj_um\n\nsolve()\n```"
        },
        {
            "introduction": "While one-dimensional models are excellent for understanding fundamental physics, modern transistors are inherently multi-dimensional devices. This practice extends the concept of diffusion into two dimensions to analyze the lateral spread of dopants under a mask edge, a phenomenon known as encroachment . By solving the 2D diffusion equation for an implanted line source, you will learn to quantify this lateral movement, which is critical for defining a transistor's effective channel length and controlling short-channel effects.",
            "id": "4273895",
            "problem": "You are tasked with computing the lateral diffusion of dopant under a lithographic mask edge by solving two-dimensional diffusion from a line source and estimating the encroachment length for a Lightly Doped Drain (LDD) profile. The problem is grounded in the physics of Front-End-Of-Line processes—specifically diffusion after ion implantation—and must be approached from first principles.\n\nAssume a crystalline silicon substrate occupies a spatially uniform medium with isotropic and constant diffusivity $D$ during an isothermal anneal of duration $t$. The dopant concentration $C(x,z,t)$ evolves according to Fick's second law of diffusion, expressed by the diffusion equation\n$$\n\\frac{\\partial C}{\\partial t} = D \\nabla^2 C,\n$$\nin a two-dimensional cross-section $(x,z)$, where $x$ denotes the lateral coordinate and $z$ denotes the depth. The mask edge at $x = 0$ defines the lateral reference. You may neglect boundary effects and treat the substrate as effectively infinite in both $x$ and $z$ over the time scales given.\n\nThe initial dopant distribution after ion implantation is modeled as a line source at $x = 0$ with total dose per unit length $Q$ and a Gaussian depth profile,\n$$\nC(x,z,0) = Q\\,\\delta(x)\\, f(z),\n$$\nwith\n$$\nf(z) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_z}\\,\\exp\\!\\left(-\\frac{(z - R_p)^2}{2\\sigma_z^2}\\right),\n$$\nwhere $R_p$ is the projected range and $\\sigma_z$ is the longitudinal straggle. The function $f(z)$ is normalized so that $\\int_{-\\infty}^{\\infty} f(z)\\,dz = 1$, implying the total dopant per unit length along the mask edge is $Q$.\n\nDefine the lateral encroachment length $L_e$ under the mask as the smallest nonnegative $L$ such that the diffused concentration at the depth of peak implantation, $z=R_p$, equals a prescribed threshold $C_{\\mathrm{th}}$,\n$$\nC(-L, R_p, t) = C_{\\mathrm{th}},\n$$\ninterpreting the case of no solution (if the concentration at $x=0$ and $z=R_p$ is already below $C_{\\mathrm{th}}$) as $L_e = 0$.\n\nYour task is to write a complete, runnable program that:\n- Derives from the diffusion equation the concentration $C(x,z,t)$ at arbitrary $(x,z)$ and uses this to compute $L_e$ for provided parameter sets.\n- Uses physically consistent units: lengths in micrometers ($\\mu\\mathrm{m}$), time in seconds ($\\mathrm{s}$), diffusivity in square micrometers per second ($\\mu\\mathrm{m}^2/\\mathrm{s}$), dose per unit length $Q$ in atoms per micrometer ($\\mathrm{atoms}/\\mu\\mathrm{m}$), and concentration in atoms per cubic micrometer ($\\mathrm{atoms}/\\mu\\mathrm{m}^3$).\n- Expresses the encroachment length $L_e$ in micrometers, rounded to six decimal places.\n\nImplement the computation for the following test suite of parameter sets, each given as $(D, t, Q, R_p, \\sigma_z, C_{\\mathrm{th}})$ in the specified units:\n- Test $1$: $(D = 1.0\\times 10^{-6},\\; t = 300,\\; Q = 1.0\\times 10^{6},\\; R_p = 0.03,\\; \\sigma_z = 0.02,\\; C_{\\mathrm{th}} = 1.0\\times 10^{4})$.\n- Test $2$: $(D = 1.0\\times 10^{-6},\\; t = 60,\\; Q = 1.0\\times 10^{6},\\; R_p = 0.03,\\; \\sigma_z = 0.02,\\; C_{\\mathrm{th}} = 1.0\\times 10^{4})$.\n- Test $3$: $(D = 1.0\\times 10^{-6},\\; t = 1800,\\; Q = 1.0\\times 10^{2},\\; R_p = 0.03,\\; \\sigma_z = 0.02,\\; C_{\\mathrm{th}} = 1.0\\times 10^{4})$.\n- Test $4$: $(D = 1.0\\times 10^{-7},\\; t = 3600,\\; Q = 5.0\\times 10^{5},\\; R_p = 0.04,\\; \\sigma_z = 0.05,\\; C_{\\mathrm{th}} = 5.0\\times 10^{3})$.\n\nYour program should produce a single line of output containing the encroachment lengths for the four test cases, formatted as a comma-separated list enclosed in square brackets, for example,\n$$\n[\\ell_1,\\ell_2,\\ell_3,\\ell_4],\n$$\nwhere each $\\ell_i$ is the computed $L_e$ for the corresponding test set, in $\\mu\\mathrm{m}$, rounded to six decimal places.",
            "solution": "The user wants to solve a 2D diffusion problem and compute the lateral encroachment length.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Fick's second law of diffusion in two dimensions $(x, z)$:\n$$\n\\frac{\\partial C}{\\partial t} = D \\nabla^2 C = D \\left(\\frac{\\partial^2 C}{\\partial x^2} + \\frac{\\partial^2 C}{\\partial z^2}\\right)\n$$\n- **Medium**: A crystalline silicon substrate with isotropic and constant diffusivity $D$.\n- **Annealing Time**: Isothermal anneal of duration $t$.\n- **Domain**: An effectively infinite domain in both $x$ and $z$.\n- **Initial Condition**: A line source at $x=0$ with a Gaussian depth profile:\n$$\nC(x,z,0) = Q\\,\\delta(x)\\, f(z)\n$$\nwhere $Q$ is the total dose per unit length and $f(z)$ is given by:\n$$\nf(z) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_z}\\,\\exp\\!\\left(-\\frac{(z - R_p)^2}{2\\sigma_z^2}\\right)\n$$\nwith $R_p$ being the projected range and $\\sigma_z$ the longitudinal straggle. The normalization is $\\int_{-\\infty}^{\\infty} f(z)\\,dz = 1$.\n- **Definition of Lateral Encroachment Length ($L_e$)**: The smallest non-negative value $L$ satisfying:\n$$\nC(-L, R_p, t) = C_{\\mathrm{th}}\n$$\nwhere $C_{\\mathrm{th}}$ is a prescribed threshold concentration. If $C(0, R_p, t) \\le C_{\\mathrm{th}}$, then $L_e = 0$.\n- **Units**:\n    - Lengths ($x, z, R_p, \\sigma_z, L_e$): micrometers ($\\mu\\mathrm{m}$)\n    - Time ($t$): seconds ($\\mathrm{s}$)\n    - Diffusivity ($D$): square micrometers per second ($\\mu\\mathrm{m}^2/\\mathrm{s}$)\n    - Dose per unit length ($Q$): atoms per micrometer ($\\mathrm{atoms}/\\mu\\mathrm{m}$)\n    - Concentration ($C, C_{\\mathrm{th}}$): atoms per cubic micrometer ($\\mathrm{atoms}/\\mu\\mathrm{m}^3$)\n- **Test Cases**: $(D, t, Q, R_p, \\sigma_z, C_{\\mathrm{th}})$\n    - Test 1: $(1.0\\times 10^{-6}, 300, 1.0\\times 10^{6}, 0.03, 0.02, 1.0\\times 10^{4})$\n    - Test 2: $(1.0\\times 10^{-6}, 60, 1.0\\times 10^{6}, 0.03, 0.02, 1.0\\times 10^{4})$\n    - Test 3: $(1.0\\times 10^{-6}, 1800, 1.0\\times 10^{2}, 0.03, 0.02, 1.0\\times 10^{4})$\n    - Test 4: $(1.0\\times 10^{-7}, 3600, 5.0\\times 10^{5}, 0.04, 0.05, 5.0\\times 10^{3})$\n- **Output Format**: A comma-separated list of $L_e$ values in $\\mu\\mathrm{m}$, rounded to six decimal places, enclosed in square brackets.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on Fick's second law of diffusion, a fundamental principle in physics and materials science. The initial condition, a Gaussian distribution resulting from ion implantation, is a standard and physically realistic model in semiconductor fabrication. Thus, the problem is scientifically sound.\n- **Well-Posed**: The diffusion equation is a linear partial differential equation with a well-defined initial condition over an infinite domain. This setup guarantees the existence of a unique and stable solution. The definition for the encroachment length $L_e$ is precise and includes a clear condition for the edge case ($L_e=0$), making the problem well-posed.\n- **Objective**: The problem is stated using precise, unambiguous scientific language. All parameters and constraints are defined quantitatively.\n- **Completeness and Consistency**: All necessary parameters for solving the problem ($D, t, Q, R_p, \\sigma_z, C_{\\mathrm{th}}$) are provided for each test case. The specified units are dimensionally consistent. For example, the units of the initial condition $C(x,z,0) = Q \\delta(x) f(z)$ are $[Q] \\times [\\delta(x)] \\times [f(z)] = (\\mathrm{atoms}/\\mu\\mathrm{m}) \\times (1/\\mu\\mathrm{m}) \\times (1/\\mu\\mathrm{m}) = \\mathrm{atoms}/\\mu\\mathrm{m}^3$, which is consistent with the unit of concentration. The problem is self-contained and consistent.\n\nNone of the invalidity criteria are met.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A step-by-step solution will be developed.\n\n### Solution Derivation\nThe objective is to find the dopant concentration $C(x,z,t)$ by solving the 2D diffusion equation with the given initial condition. The diffusion equation is linear, allowing the use of the superposition principle via convolution with the fundamental solution (Green's function).\n\nThe fundamental solution to the 2D diffusion equation for a unit point source at the origin is:\n$$\nG(x,z,t) = \\frac{1}{4\\pi D t} \\exp\\left(-\\frac{x^2+z^2}{4Dt}\\right)\n$$\nThe solution $C(x,z,t)$ is the convolution of the initial condition $C(x',z',0)$ with the fundamental solution:\n$$\nC(x,z,t) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} C(x',z',0) \\, G(x-x', z-z', t) \\, dx' dz'\n$$\nSubstituting the initial condition $C(x',z',0) = Q\\,\\delta(x')\\,f(z')$:\n$$\nC(x,z,t) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} Q\\,\\delta(x')\\,f(z') \\, \\frac{1}{4\\pi D t} \\exp\\left(-\\frac{(x-x')^2+(z-z')^2}{4Dt}\\right) \\, dx' dz'\n$$\nFirst, we integrate with respect to $x'$, utilizing the sifting property of the Dirac delta function $\\delta(x')$:\n$$\nC(x,z,t) = Q \\int_{-\\infty}^{\\infty} f(z') \\, \\frac{1}{4\\pi D t} \\exp\\left(-\\frac{x^2+(z-z')^2}{4Dt}\\right) \\, dz'\n$$\nWe can separate the terms dependent on $x$ from the integral:\n$$\nC(x,z,t) = \\frac{Q}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{x^2}{4Dt}\\right) \\int_{-\\infty}^{\\infty} f(z') \\, \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(z-z')^2}{4Dt}\\right) \\, dz'\n$$\nThe integral represents the convolution in the $z$-direction. The initial profile $f(z')$ is a Gaussian distribution $\\mathcal{N}(z' | R_p, \\sigma_z^2)$. The diffusion kernel $\\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(z-z')^2}{4Dt}\\right)$ corresponds to a Gaussian distribution in $z'$ with mean $z$ and variance $2Dt$. The convolution of two Gaussian probability density functions, $\\mathcal{N}(\\mu_1, \\sigma_1^2)$ and $\\mathcal{N}(\\mu_2, \\sigma_2^2)$, results in another Gaussian, $\\mathcal{N}(\\mu_1+\\mu_2, \\sigma_1^2+\\sigma_2^2)$.\nIn our case, we are convolving $f(z') = \\mathcal{N}(z' | R_p, \\sigma_z^2)$ with the kernel corresponding to a random variable with distribution $\\mathcal{N}(0, 2Dt)$. The resulting distribution is a Gaussian with mean $R_p+0 = R_p$ and variance $\\sigma_z^2+2Dt$. The integral evaluates to this new probability density function at point $z$:\n$$\n\\int_{-\\infty}^{\\infty} f(z') \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(z-z')^2}{4Dt}\\right) \\, dz' = \\frac{1}{\\sqrt{2\\pi(\\sigma_z^2 + 2Dt)}} \\exp\\left(-\\frac{(z-R_p)^2}{2(\\sigma_z^2 + 2Dt)}\\right)\n$$\nSubstituting this back into the expression for $C(x,z,t)$, we obtain the final concentration profile. Note that the original line source problem $C_0(x,z) = Q\\delta(x)f(z)$ can be thought of as a distribution of point sources along the y-axis, each with strength $Q f(z) dz$. The diffusion in $x$ and $z$ are then independent. The solution is the product of the 1D diffusion solution for a line source of strength $Q$, and the 1D diffusion solution for an initial Gaussian profile $f(z)$.\n$$\nC(x,z,t) = \\underbrace{Q}_{\\text{Dose}} \\cdot \\underbrace{\\left[ \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{x^2}{4Dt}\\right) \\right]}_{\\text{Lateral Diffusion}} \\cdot \\underbrace{\\left[ \\frac{1}{\\sqrt{2\\pi(\\sigma_z^2 + 2Dt)}} \\exp\\left(-\\frac{(z-R_p)^2}{2(\\sigma_z^2 + 2Dt)}\\right) \\right]}_{\\text{Vertical Diffusion}}\n$$\nThis expression provides the dopant concentration at any point $(x,z)$ at time $t$.\n\n### Calculation of an Encroachment Length, $L_e$\nThe encroachment length $L_e$ is defined by the condition $C(-L_e, R_p, t) = C_{\\mathrm{th}}$. Due to the symmetry of the concentration profile with respect to $x$ (i.e., $C(x,z,t) = C(-x,z,t)$), we can use $x=L_e$. We substitute $x=L_e$ and $z=R_p$ into the concentration formula:\n$$\nC(L_e, R_p, t) = \\frac{Q}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{L_e^2}{4Dt}\\right) \\frac{1}{\\sqrt{2\\pi(\\sigma_z^2 + 2Dt)}} \\exp\\left(-\\frac{(R_p-R_p)^2}{2(\\sigma_z^2 + 2Dt)}\\right)\n$$\nThe second exponential term simplifies to $\\exp(0) = 1$. Let's define the peak concentration at the center of the profile, $C_{\\mathrm{peak}}(t) = C(0, R_p, t)$:\n$$\nC_{\\mathrm{peak}}(t) = \\frac{Q}{\\sqrt{4\\pi D t} \\sqrt{2\\pi(\\sigma_z^2 + 2Dt)}}\n$$\nThe condition for $L_e$ can then be written as:\n$$\nC_{\\mathrm{th}} = C(L_e, R_p, t) = C_{\\mathrm{peak}}(t) \\exp\\left(-\\frac{L_e^2}{4Dt}\\right)\n$$\nAs per the problem statement, if $C_{\\mathrm{peak}}(t) \\le C_{\\mathrm{th}}$, there is no non-trivial solution for $L_e > 0$, so we set $L_e = 0$.\nIf $C_{\\mathrm{peak}}(t) > C_{\\mathrm{th}}$, we can solve for $L_e$:\n$$\n\\frac{C_{\\mathrm{th}}}{C_{\\mathrm{peak}}(t)} = \\exp\\left(-\\frac{L_e^2}{4Dt}\\right)\n$$\n$$\n\\ln\\left(\\frac{C_{\\mathrm{th}}}{C_{\\mathrm{peak}}(t)}\\right) = -\\frac{L_e^2}{4Dt}\n$$\n$$\nL_e^2 = -4Dt \\ln\\left(\\frac{C_{\\mathrm{th}}}{C_{\\mathrm{peak}}(t)}\\right) = 4Dt \\ln\\left(\\frac{C_{\\mathrm{peak}}(t)}{C_{\\mathrm{th}}}\\right)\n$$\nSolving for $L_e$ (which must be non-negative):\n$$\nL_e = \\sqrt{4Dt \\ln\\left(\\frac{C_{\\mathrm{peak}}(t)}{C_{\\mathrm{th}}}\\right)}\n$$\nThis formula, combined with the condition for $L_e=0$, provides the complete algorithm for calculating the lateral encroachment length for each set of parameters.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the lateral encroachment length for LDD profiles based on a 2D diffusion model.\n    \"\"\"\n\n    # Test cases are provided as tuples of (D, t, Q, Rp, sigma_z, C_th).\n    # Units: D [um^2/s], t [s], Q [atoms/um], Rp [um], sigma_z [um], C_th [atoms/um^3]\n    test_cases = [\n        (1.0E-6, 300, 1.0E6, 0.03, 0.02, 1.0E4),    # Test 1\n        (1.0E-6, 60, 1.0E6, 0.03, 0.02, 1.0E4),     # Test 2\n        (1.0E-6, 1800, 1.0E2, 0.03, 0.02, 1.0E4),  # Test 3\n        (1.0E-7, 3600, 5.0E5, 0.04, 0.05, 5.0E3),   # Test 4\n    ]\n\n    results = []\n\n    for case in test_cases:\n        D, t, Q, Rp, sigma_z, C_th = case\n\n        # Calculate intermediate terms for the concentration formula\n        four_Dt = 4 * D * t\n        two_Dt = 2 * D * t\n        \n        # Effective variance in the z-direction after diffusion\n        sigma_eff_sq = sigma_z**2 + two_Dt\n        \n        # Denominator for the peak concentration formula\n        # It's derived from sqrt(4*pi*D*t) * sqrt(2*pi*sigma_eff_sq)\n        denominator = np.sqrt(4 * np.pi * D * t) * np.sqrt(2 * np.pi * sigma_eff_sq)\n        \n        # Check for division by zero if t=0 or D=0. In this problem, t > 0 and D > 0.\n        if denominator == 0:\n            # Physically, this represents infinite concentration, which is unphysical after any finite time.\n            # In a simulation, if t=0, C_peak would be infinite. We can handle it, but inputs guarantee t>0.\n            # For robustness, let's treat it as a case where L_e would be calculated from a very large C_peak.\n            # But based on problem constraints, this path won't be taken.\n            C_peak = float('inf')\n        else:\n            C_peak = Q / denominator\n\n        # Determine the encroachment length Le\n        if C_peak <= C_th:\n            # If the peak concentration is already at or below the threshold,\n            # the encroachment under the mask is zero by definition.\n            Le = 0.0\n        else:\n            # Solve for Le > 0.\n            # Le = sqrt(4*D*t * ln(C_peak / C_th))\n            log_arg = C_peak / C_th\n            Le = np.sqrt(four_Dt * np.log(log_arg))\n        \n        results.append(Le)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each number rounded to six decimal places, enclosed in brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Run the solver\nsolve()\n```"
        }
    ]
}