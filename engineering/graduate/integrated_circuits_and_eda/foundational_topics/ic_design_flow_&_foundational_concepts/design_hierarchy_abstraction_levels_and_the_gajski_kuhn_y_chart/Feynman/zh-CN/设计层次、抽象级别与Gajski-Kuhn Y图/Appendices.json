{
    "hands_on_practices": [
        {
            "introduction": "现代电子设计自动化（EDA）流程的第一步通常是将抽象的算法行为映射到具体的硬件结构和时间线上，这个过程被称为高级综合（High-Level Synthesis, HLS）。这个练习将指导你完成一个核心的HLS任务：列表调度。通过为一个由有向无环图（DAG）表示的计算任务分配具体的时间和资源，你将亲身体验如何将Gajski-Kuhn Y型图行为域的设计规范转化为结构域和几何域的实现蓝图。",
            "id": "4264767",
            "problem": "本着电子设计自动化（EDA）的精神，并在Gajski-Kuhn Y型图视图的框架内，行为域的调度必须在算法层面遵循优先关系，同时映射到单一的结构资源和几何时间轴上。考虑一个在行为域中由操作的有向无环图（DAG）$\\{O_1,\\dots,O_9\\}$描述的计算，每个操作都有一个以周期为单位的整数操作延迟 $L_i$。结构域提供了一个启动间隔为1个周期的完全流水线化功能单元，它强制执行单发射约束：每个整数周期最多只能启动一个操作。几何域是一个从周期0开始的整数周期的离散时间网格。\n\n操作延迟如下：$L_1=2$, $L_2=3$, $L_3=1$, $L_4=2$, $L_5=3$, $L_6=2$, $L_7=1$, $L_8=4$, $L_9=2$。优先约束由边 $O_1 \\to O_3$, $O_1 \\to O_4$, $O_2 \\to O_4$, $O_3 \\to O_5$, $O_3 \\to O_6$, $O_4 \\to O_7$, $O_5 \\to O_7$, $O_6 \\to O_8$, $O_7 \\to O_9$, $O_8 \\to O_9$ 给出。\n\n您必须从基本原则出发，推导出行为域中最早的无约束开始时间，然后在单发射资源约束下，通过列表调度得到结构/几何域中的开始时间分配，并使用与延迟加权的行为到结构映射一致的关键路径优先级来解决资源冲突。\n\n从核心定义开始：一个操作 $O_i$ 只有当其所有直接前驱在周期 $t$ 之前都已完成时，才能在周期 $t$ 开始。其中，在 $s_i$ 开始的操作 $O_i$ 在 $s_i+L_i$ 完成。首先，仅根据优先关系和延迟计算最早的无约束开始时间 $e_i$（忽略单发射约束）。然后，在单发射约束下计算列表调度，如下所示：在每个整数周期 $t$，从所有就绪且尚未开始的操作中，选择一个操作来启动；通过选择具有最大延迟加权关键路径优先级 $W_i$ 的操作来打破平局和解决冲突。$W_i$ 的递归定义如下：\n$$\nW_i=\n\\begin{cases}\nL_i,  \\text{如果 $O_i$ 没有后继（汇点）}\\\\\nL_i+\\max\\limits_{O_j \\in \\mathrm{succ}(i)} W_j,  \\text{其他情况}\n\\end{cases}\n$$\n其中 $\\mathrm{succ}(i)$ 表示 $O_i$ 的直接后继集合。\n\n将您的最终调度结果表示为开始时间向量 $s=[s_1,\\dots,s_9]$（以周期为单位，按 $(O_1,\\dots,O_9)$ 排序），并附上总延迟 $T=\\max_i(s_i+L_i)$（以周期为单位）。所有周期均表示为整数，无需四舍五入。将最终答案表示为包含 $s_1,\\dots,s_9,T$（按此顺序）的单行矩阵。.",
            "solution": "问题陈述已经过严格审查，并被认定为有效。它提出了一个定义明确、自成一体的资源受限调度问题，该问题基于高层次综合和电子设计自动化的标准原则。有向无环图（DAG）用于行为规范、操作延迟、优先约束、单发射资源约束以及使用基于关键路径的优先级函数的列表调度等概念，都是标准的且有正式定义。该问题是客观的，需要一个确定性的、可验证的计算。\n\n任务是将行为规范映射到结构和几何实现上，这一过程由Gajski-Kuhn Y型图建模。我们给定一组操作 $\\{O_1, \\dots, O_9\\}$ 及其指定的整数延迟 $L_i$ 和一个定义了优先约束的DAG。结构域提供了一个单发射资源，意味着每个周期最多只能启动一个操作。几何域是一个离散的整数时间线。\n\n求解过程分三个阶段进行：\n1.  确定在无约束（纯行为）情境下的最早可能开始时间 $e_i$。\n2.  为每个操作计算延迟加权的关键路径优先级 $W_i$。该优先级度量将指导调度决策。\n3.  执行列表调度算法，以确定资源受限的开始时间 $s_i$ 和总调度延迟 $T$。\n\n首先，我们计算最早的无约束开始时间 $e_i$。这些时间也被称为“尽快”（As-Soon-As-Possible, ASAP）时间。一个操作只有在其所有前驱都完成后才能开始。操作 $O_i$ 的开始时间 $e_i$ 由下式给出：\n$$e_i = \\max_{O_j \\in \\mathrm{pred}(i)} \\{e_j + L_j\\}$$\n其中 $\\mathrm{pred}(i)$ 是 $O_i$ 的直接前驱集合。对于没有前驱的源节点，$e_i=0$。计算遵循DAG的拓扑排序。\n给定的延迟为 $L=[2, 3, 1, 2, 3, 2, 1, 4, 2]$。\n前驱集合为：\n$\\mathrm{pred}(1) = \\emptyset, \\mathrm{pred}(2) = \\emptyset, \\mathrm{pred}(3) = \\{O_1\\}, \\mathrm{pred}(4) = \\{O_1, O_2\\}, \\mathrm{pred}(5) = \\{O_3\\}, \\mathrm{pred}(6) = \\{O_3\\}, \\mathrm{pred}(7) = \\{O_4, O_5\\}, \\mathrm{pred}(8) = \\{O_6\\}, \\mathrm{pred}(9) = \\{O_7, O_8\\}$。\n\n$e_1 = 0$\n$e_2 = 0$\n$e_3 = e_1 + L_1 = 0 + 2 = 2$\n$e_4 = \\max(e_1 + L_1, e_2 + L_2) = \\max(0 + 2, 0 + 3) = 3$\n$e_5 = e_3 + L_3 = 2 + 1 = 3$\n$e_6 = e_3 + L_3 = 2 + 1 = 3$\n$e_7 = \\max(e_4 + L_4, e_5 + L_5) = \\max(3 + 2, 3 + 3) = \\max(5, 6) = 6$\n$e_8 = e_6 + L_6 = 3 + 2 = 5$\n$e_9 = \\max(e_7 + L_7, e_8 + L_8) = \\max(6 + 1, 5 + 4) = \\max(7, 9) = 9$\n\n其次，我们为列表调度算法计算优先级权重 $W_i$。权重 $W_i$ 表示从操作 $O_i$ 开始到图的任一汇点的最长路径长度，其中路径长度是路径上操作延迟的总和。其递归定义为：\n$$W_i = L_i + \\max_{O_j \\in \\mathrm{succ}(i)} \\{W_j\\}$$\n其中 $\\mathrm{succ}(i)$ 是 $O_i$ 的直接后继集合。对于没有后继的汇点节点，$W_i = L_i$。此计算通过以逆拓扑顺序遍历DAG来执行。\n后继集合为：\n$\\mathrm{succ}(1) = \\{O_3, O_4\\}, \\mathrm{succ}(2) = \\{O_4\\}, \\mathrm{succ}(3) = \\{O_5, O_6\\}, \\mathrm{succ}(4) = \\{O_7\\}, \\mathrm{succ}(5) = \\{O_7\\}, \\mathrm{succ}(6) = \\{O_8\\}, \\mathrm{succ}(7) = \\{O_9\\}, \\mathrm{succ}(8) = \\{O_9\\}, \\mathrm{succ}(9) = \\emptyset$。\n\n$W_9 = L_9 = 2$\n$W_8 = L_8 + W_9 = 4 + 2 = 6$\n$W_7 = L_7 + W_9 = 1 + 2 = 3$\n$W_6 = L_6 + W_8 = 2 + 6 = 8$\n$W_5 = L_5 + W_7 = 3 + 3 = 6$\n$W_4 = L_4 + W_7 = 2 + 3 = 5$\n$W_3 = L_3 + \\max(W_5, W_6) = 1 + \\max(6, 8) = 1 + 8 = 9$\n$W_2 = L_2 + W_4 = 3 + 5 = 8$\n$W_1 = L_1 + \\max(W_3, W_4) = 2 + \\max(9, 5) = 2 + 9 = 11$\n操作的优先级列表（从最高到最低的 $W_i$）是：$O_1(11), O_3(9), O_2(8), O_6(8), O_5(6), O_8(6), O_4(5), O_7(3), O_9(2)$。当 $W_i$ 出现平局时（例如，$W_2=W_6=8$ 和 $W_5=W_8=6$），我们采用确定性的打破平局规则，即选择索引较小的操作。排序后的优先级列表是：$O_1, O_3, O_2, O_6, O_5, O_8, O_4, O_7, O_9$。\n\n第三，我们执行列表调度。我们按时间周期 $t=0, 1, 2, \\dots$ 迭代。在每个周期，我们构建一个包含所有前驱已完成的未调度操作的“就绪列表”。如果“就绪列表”不为空，我们选择优先级最高的操作并在当前周期 $t$ 调度它。\n- **周期 $t=0$**：就绪列表 = $\\{O_1, O_2\\}$。$O_1$ 的优先级更高 ($W_1=11 > W_2=8$)。调度 $O_1$。$s_1=0$。\n- **周期 $t=1$**：就绪列表 = $\\{O_2\\}$。调度 $O_2$。$s_2=1$。\n- **周期 $t=2$**：$O_1$ 完成 ($0+2=2$)。$O_3$ 变为就绪。就绪列表 = $\\{O_3\\}$。调度 $O_3$。$s_3=2$。\n- **周期 $t=3$**：$O_3$ 完成 ($2+1=3$)。$O_5$ 和 $O_6$ 变为就绪。就绪列表 = $\\{O_5, O_6\\}$。$O_6$ 的优先级更高 ($W_6=8 > W_5=6$)。调度 $O_6$。$s_6=3$。\n- **周期 $t=4$**：$O_2$ 完成 ($1+3=4$)。$O_4$ 变为就绪。按优先级排序的就绪列表为 $\\{O_5, O_4\\}$ ($W_5=6 > W_4=5$)。调度 $O_5$。$s_5=4$。\n- **周期 $t=5$**：$O_6$ 完成 ($3+2=5$)。$O_8$ 变为就绪。按优先级排序的就绪列表为 $\\{O_8, O_4\\}$ ($W_8=6 > W_4=5$)。调度 $O_8$。$s_8=5$。\n- **周期 $t=6$**：就绪列表 = $\\{O_4\\}$。调度 $O_4$。$s_4=6$。\n- **周期 $t=7$**：$O_5$ 完成 ($4+3=7$)。$O_7$ 尚未就绪，因为它等待 $O_4$（将在 $6+2=8$ 完成）。就绪列表为空。这是一个空闲周期。\n- **周期 $t=8$**：$O_4$ 完成 ($6+2=8$)。$O_7$ 变为就绪（前驱 $O_4, O_5$ 均已完成）。就绪列表 = $\\{O_7\\}$。调度 $O_7$。$s_7=8$。\n- **周期 $t=9$**：$O_7$ 和 $O_8$ 均完成（分别在 $8+1=9$ 和 $5+4=9$）。$O_9$ 变为就绪。就绪列表 = $\\{O_9\\}$。调度 $O_9$。$s_9=9$。\n\n最终调度的开始时间为 $s=[s_1, s_2, s_3, s_4, s_5, s_6, s_7, s_8, s_9] = [0, 1, 2, 6, 4, 3, 8, 5, 9]$。\n\n总延迟 $T$ 是最后一个操作的完成时间。操作 $O_i$ 的完成时间是 $c_i = s_i + L_i$。\n$c_1 = 0+2=2$\n$c_2 = 1+3=4$\n$c_3 = 2+1=3$\n$c_4 = 6+2=8$\n$c_5 = 4+3=7$\n$c_6 = 3+2=5$\n$c_7 = 8+1=9$\n$c_8 = 5+4=9$\n$c_9 = 9+2=11$\n总延迟为 $T = \\max_i(c_i) = 11$ 个周期。\n最终结果包括开始时间向量 $s$ 和总延迟 $T$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  1  2  6  4  3  8  5  9  11 \\end{pmatrix} } $$"
        },
        {
            "introduction": "一旦操作被调度，就需要一个控制器来协调数据在硬件资源中的流动并管理与外部世界的通信。本练习要求你为一个带有握手协议的有限脉冲响应（FIR）滤波器设计一个控制器有限状态机（Finite State Machine, FSM）。这个任务完美地展示了行为域（算法和I/O协议）如何驱动结构域（FSM的状态和转换逻辑）的设计，以确保数据在每个时钟周期都得到正确处理。",
            "id": "4264779",
            "problem": "一位设计者正在使用电子设计自动化（EDA）工具，在集成电路（IC）中为一个带有饱和功能的 $16$ 阶有限脉冲响应（FIR）滤波器合成一个控制器。该滤波器必须在 Gajski-Kuhn Y型图的行为、结构和几何三个域中进行一致的建模和实现。在行为层级，该滤波器计算饱和输出 $$y[n] = S\\!\\left(\\sum_{k=0}^{15} h[k]\\,x[n-k]\\right)$$, 其中 $x[n]$ 是输入采样流，$h[k]$ 是固定系数，$S(\\cdot)$ 是一个饱和函数，它将结果限制在一个由固定字宽决定的可表示范围内。结构上的选择是：一个单乘法累加数据通路，每个时钟周期处理一个阶；一个用于存储最近 $16$ 个输入样本的循环缓冲区；以及一个组合逻辑饱和器。控制器必须是一个 Mealy 型有限状态机（FSM），其输出是当前状态和输入的函数。\n\n系统在输入和输出端均使用同步双相“就绪/有效”（ready/valid）握手协议：对于输入，上游断言 $x_{\\text{valid}}$，滤波器断言 $x_{\\text{ready}}$，当 $x_{\\text{valid}}=1$ 和 $x_{\\text{ready}}=1$ 时，在时钟上升沿捕获一个样本。对于输出，当结果可用时，滤波器断言 $y_{\\text{valid}}$，下游断言 $y_{\\text{ready}}$，当 $y_{\\text{valid}}=1$ 和 $y_{\\text{ready}}=1$ 时，在时钟上升沿传输结果。滤波器不能丢弃输入；如果当滤波器正忙时有新的输入样本到达，它必须撤销 $x_{\\text{ready}}$ 的断言，以向上游施加反压，直到它能够接受下一个样本。饱和操作是组合逻辑的，可以在与最终累加相同的时钟周期内产生。\n\n从 Mealy 型有限状态机的形式化定义和所述的握手语义出发，并遵守 Gajski-Kuhn Y型图所蕴含的关注点分离原则（将行为算法映射到结构数据通路，控制器位于同一时钟下的几何域中），推导正确协调以下操作所需的最小控制器状态数：\n- 在双相握手协议下接受输入，\n- 使用单个乘法累加资源顺序处理所有 $16$ 个阶，\n- 在双相握手协议下产生和交付饱和输出，\n- 以及在繁忙时正确地暂停输入。\n\n假设每个时钟周期处理一个阶，并且新接受的输入样本的循环缓冲区更新与接受操作在同一个时钟周期内完成。请用一个整数表示所需的最小控制器状态数作为最终答案。无需四舍五入。",
            "solution": "用户要求我确定一个控制 $16$ 阶 FIR 滤波器的 Mealy 型有限状态机（FSM）所需的最小状态数。\n\n### 步骤 1：提取已知条件\n- **滤波器类型**：带有饱和功能的 $16$ 阶有限脉冲响应（FIR）滤波器。\n- **行为方程**：$y[n] = S(\\sum_{k=0}^{15} h[k]\\,x[n-k])$，其中 $S(\\cdot)$ 是一个饱和函数。\n- **结构数据通路**：\n    - 一个单乘法累加（MAC）单元。\n    - 一个用于存储 $16$ 个输入样本的循环缓冲区。\n    - 一个组合逻辑饱和器。\n- **时序**：\n    - 每个时钟周期处理一个阶。\n    - 循环缓冲区更新和输入接受发生在同一周期。\n    - 饱和操作与最终累加是组合逻辑的。\n- **控制器**：\n    - 必须是一个 Mealy 型 FSM。\n- **输入握手**：\n    - 同步双相“就绪/有效”协议。\n    - 上游提供 $x_{\\text{valid}}$。控制器提供 $x_{\\text{ready}}$。\n    - 当 $x_{\\text{valid}}=1$ 且 $x_{\\text{ready}}=1$ 时，在时钟上升沿进行传输。\n- **输出握手**：\n    - 同步双相“就绪/有效”协议。\n    - 控制器提供 $y_{\\text{valid}}$。下游提供 $y_{\\text{ready}}$。\n    - 当 $y_{\\text{valid}}=1$ 且 $y_{\\text{ready}}=1$ 时，在时钟上升沿进行传输。\n- **约束**：\n    - 不得丢弃任何输入。\n    - 当繁忙时，控制器必须通过撤销 $x_{\\text{ready}}$ 的断言来施加反压。\n- **目标**：找到最小的控制器状态数。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述描述了一个标准的、定义明确的数字设计任务。\n- **科学依据**：FIR 滤波器、FSM 控制器、乘法累加数据通路以及“就绪/有效”握手协议等概念是数字逻辑设计和信号处理的基本原理。该问题在科学上和事实上都是合理的。\n- **良态问题**：该问题是自包含的，提供了所有必要的约束和一个明确的目标（找到最小状态数）。这些约束足以定义 FSM 的行为，从而得出一个唯一的、最小化的解决方案。\n- **目标性**：该问题使用电子工程中常见的精确、明确的技术语言进行陈述。\n- **缺陷检查表**：该问题没有违反任何无效性标准。它是一个可形式化的、相关的、完整的、现实的、结构良好的非平凡问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将推导解决方案。\n\n### 求解推导\n\n控制器的主要功能是协调数据流通过指定的数据通路，同时遵守输入和输出握手协议。滤波器的操作可以分解为三个不同的顺序阶段。我们必须确定表示这些阶段所需的最小状态数。一个最小 FSM 的状态必须是可区分的。如果两个状态对于相同的输入产生不同的输出，或者转移到可区分的后继状态，则这两个状态是可区分的。一个简单的可区分性条件是，无论输入如何，两个状态都必须产生不同的输出。\n\n设控制器的输出为对 $(x_{\\text{ready}}, y_{\\text{valid}})$。我们分析每个操作阶段所需的输出：\n\n1.  **阶段 1：空闲 (IDLE)**\n    在此阶段，滤波器已完成所有先前的计算，并准备好接受一个新的输入样本 $x[n]$。为了满足输入握手协议，控制器必须向上游源发出其就绪信号。同时，它必须指示没有有效的输出可用。\n    - 所需输出向量：$(x_{\\text{ready}}, y_{\\text{valid}}) = (1, 0)$。\n    FSM 保持在此阶段，直到提供输入样本，即直到 $x_{\\text{valid}} = 1$。在一个 $x_{\\text{valid}}=1$ 和 $x_{\\text{ready}}=1$ 的时钟沿，一次传输发生，控制器必须转换到下一个阶段。\n\n2.  **阶段 2：计算 (COMPUTE)**\n    一旦接受了一个新样本，滤波器开始计算总和 $\\sum_{k=0}^{15} h[k]\\,x[n-k]$。数据通路有一个单一的 MAC 单元，每个时钟周期处理一个阶。由于有 $16$ 个阶（从 $k=0$ 到 $k=15$），此阶段将持续 $16$ 个连续的时钟周期。在此整个期间，滤波器处于繁忙状态。它不能接受新的输入样本，并且最终结果也尚未准备好。因此，它必须同时撤销 $x_{\\text{ready}}$ 的断言以向上游源施加反压，并撤销 $y_{\\text{valid}}$ 的断言因为输出尚未就绪。\n    - 所需输出向量：$(x_{\\text{ready}}, y_{\\text{valid}}) = (0, 0)$。\n    FSM 必须确保此阶段精确持续 $16$ 个周期。这通常通过让 FSM 保持在单个“计算”（COMPUTE）状态，同时由 FSM 控制一个辅助计数器来跟踪从 $0$ 到 $15$ 的周期来实现。使用外部计数器来处理循环是一种标准的状态简化技术，并且对于最小 FSM 设计是必要的。在第 $16$ 个周期之后，计算完成，组合逻辑饱和器产生最终输出 $y[n]$，控制器必须转换到下一个阶段。\n\n3.  **阶段 3：输出 (OUTPUT)**\n    经过 $16$ 个计算周期后，饱和结果 $y[n]$ 已准备就绪。控制器现在必须管理输出握手。它必须发出信号，表示有有效输出可用。此时它仍然没有准备好接受新输入，因为在当前结果成功传输之前，它不能开始新的计算。\n    - 所需输出向量：$(x_{\\text{ready}}, y_{\\text{valid}}) = (0, 1)$。\n    FSM 保持在此阶段，断言 $y_{\\text{valid}}=1$，直到下游系统通过断言 $y_{\\text{ready}}=1$ 来表示其已准备好。在一个两者都断言的时钟沿，输出被传输，控制器对于样本 $x[n]$ 的任务完成。然后它必须转换回空闲（IDLE）阶段以等待下一个输入。\n\n我们已经确定了三个操作阶段，每个阶段都需要一个独特且恒定的握手信号输出向量 $(x_{\\text{ready}}, y_{\\text{valid}})$：\n- 阶段 1 (IDLE): $(1, 0)$\n- 阶段 2 (COMPUTE): $(0, 0)$\n- 阶段 3 (OUTPUT): $(0, 1)$\n\n根据 FSM 最小化的原则，任何产生不同输出的两个状态都是可区分的，不能合并为单个状态。由于这三个所需的输出向量是唯一的，一个最小状态机必须至少有三个状态，每个状态对应这些阶段之一。\n\n我们将这些状态称为 $S_{\\text{IDLE}}$、$S_{\\text{COMPUTE}}$ 和 $S_{\\text{OUTPUT}}$。\n- $S_{\\text{IDLE}}$: 设置输出为 $(1, 0)$。当 $x_{\\text{valid}}=1$ 时，转换到 $S_{\\text{COMPUTE}}$。\n- $S_{\\text{COMPUTE}}$: 设置输出为 $(0, 0)$。使用一个计数器进行 $16$ 个周期的计数。当计数器指示计算完成时，转换到 $S_{\\text{OUTPUT}}$。\n- $S_{\\text{OUTPUT}}$: 设置输出为 $(0, 1)$。当 $y_{\\text{ready}}=1$ 时，转换到 $S_{\\text{IDLE}}$。\n\n一个具有这三个状态的控制器，实现为 Mealy（或 Moore，因为这里的输出是依赖于状态的）机，满足了问题的所有要求，同时使用了最少可能的状态数。少于三个状态是不可能的，因为无法仅从一个或两个状态生成三个不同的、依赖于状态的输出向量。\n\n因此，所需的最小控制器状态数为 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在Y型图的结构域内，设计决策在不同抽象层次上都会产生深远影响。本练习探讨了一个关键的权衡：使用单个定制逻辑门与使用标准化单元库进行分层实现。通过计算实现一个 $k$ 输入与非门在两种不同路径下所需的晶体管数量，你将量化地理解结构选择（逻辑综合策略）如何直接影响最终的物理实现（面积或晶体管数量），这是连接逻辑级和电路级抽象的关键一步。",
            "id": "4264793",
            "problem": "一个高级设计团队正在 Gajski-Kuhn Y型图的框架内优化一个门级网表，在不同的抽象层次和域之间进行转换。考虑网表中的一个节点，它是一个 $k$ 输入逻辑与非门，其中 $k \\geq 2$。考虑从结构域的逻辑层次描述到互补金属氧化物半导体（CMOS）技术下的结构域电路层次描述的两条优化路径。\n\n路径A：直接优化为单个静态互补金属氧化物半导体（CMOS）门。晶体管级电路图使用互补的下拉网络和上拉网络方法构建：下拉网络通过n沟道金属氧化物半导体场效应晶体管（NMOS）的串并联网络实现，对应于输出必须为逻辑低的条件；上拉网络是p沟道金属氧化物半导体场效应晶体管（PMOS）的对偶网络，对应于那些条件的逻辑补。假设采用最小化的、串并联的静态CMOS，不使用传输门，不进行因子分解，且没有任何重复或冗余。忽略阱偏置、体连接、布线器件以及为性能提升而进行的任何尺寸放大；只计算功能性晶体管。\n\n路径B：在电路映射之前，在逻辑层次受标准单元组合规则约束的分层优化：在门级只有2输入与非门单元可用。这 $k$ 个输入必须通过一个二叉树组合，其内部节点计算逻辑与，但根节点产生逻辑与非，以使整体功能为 $k$ 输入与非。每个非根内部节点的逻辑与必须仅使用2输入与非门和反相器来构建。反相器必须通过将其两个输入连接在一起的2输入与非门来实现。在进行此逻辑级分解后，每个2输入与非门都像路径A中那样被优化为其静态CMOS实现。同上，忽略阱偏置、体连接、布线器件和尺寸放大，只计算功能性晶体管。\n\n从基本布尔代数和标准静态CMOS互补上拉/下拉构建规则出发，推导出通过路径A和路径B获得的晶体管总数的闭式表达式，作为 $k$ 的函数。最后，定义 $D(k)$ 为路径B的晶体管数量与路径A的晶体管数量之差，并以 $k$ 的单个简化符号表达式形式给出 $D(k)$。不需要进行数值代入。你的最终答案必须是 $D(k)$ 的单个表达式。",
            "solution": "在尝试求解之前，将首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- **功能**：一个 $k$ 输入逻辑与非门，其中整数 $k \\geq 2$。\n- **背景**：在 Gajski-Kuhn Y型图上，从结构域的逻辑层次到结构域的电路层次的优化。\n- **技术**：互补金属氧化物半导体（CMOS）。\n- **路径 A（直接优化）**：\n    - $k$ 输入与非门实现为单个静态CMOS门。\n    - 通过由n沟道金属氧化物半导体场效应晶体管（NMOS）构成的互补下拉网络（PDN）和由p沟道金属氧化物半导体场效应晶体管（PMOS）构成的上拉网络（PUN）进行构建。\n    - 实现为最小化的、串并联的静态CMOS。\n    - 计数排除项：传输门、因子分解、重复、冗余、阱偏置、体连接、布线器件和晶体管尺寸放大。只计算功能性晶体管。\n- **路径 B（分层优化）**：\n    - 逻辑级约束：只有2输入与非门单元可用。\n    - 分解：$k$ 输入与非门实现为一棵二叉树。内部节点计算逻辑与，根节点计算逻辑与非。\n    - 与门的实现：一个2输入逻辑与门仅使用2输入与非门和反相器构建。\n    - 反相器的实现：一个反相器由一个输入端连接在一起的2输入与非门构建。\n    - 电路级映射：每个2输入与非门单元被优化为其静态CMOS实现，如路径A所述。\n    - 计数排除项：与路径A相同。\n- **目标**：\n    - 推导路径A的总晶体管数 $T_A(k)$ 的闭式表达式。\n    - 推导路径B的总晶体管数 $T_B(k)$ 的闭式表达式。\n    - 定义 $D(k) = T_B(k) - T_A(k)$。\n    - 提供 $D(k)$ 的单个简化符号表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据**：该问题植根于数字逻辑设计（布尔代数、逻辑门分解）和VLSI电路设计（静态CMOS门拓扑）的基本原理。这些是电气工程和计算机科学中标准的、成熟的概念。该问题在科学上是合理的。\n- **适定性**：该问题为构建和分析两种路径中的电路提供了一套清晰完整的规则。路径B中实现与门和反相器的定义是明确的。目标是找到一个特定的数学表达式，可以从给定的约束中推导出唯一解。该问题是适定的。\n- **客观性**：问题陈述使用了精确的技术语言，没有主观性、观点或偏见。\n- **其他缺陷**：该问题没有违反任何其他标准。它不基于错误的前提，是可形式化的，是自包含的，其假设是教科书分析中的标准简化，并且并非微不足道。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供一个完整的、有理有据的解决方案。\n\n### 解题推导\n\n解决方案需要推导一个 $k$ 输入与非门的两种不同实现路径的晶体管数量，然后求出它们的差值。\n\n**1. 路径 A 的晶体管数量：$T_A(k)$**\n\n在路径A中，$k$ 输入与非门被实现为单个静态CMOS逻辑门。其布尔函数为 $Y = \\overline{I_1 \\cdot I_2 \\cdot \\ldots \\cdot I_k}$，其中 $I_1, \\ldots, I_k$ 是输入。\n\n根据静态互补CMOS设计规则：\n- 下拉网络（PDN）将输出连接到地（$V_{SS}$），并且当输出为逻辑低时必须导通。输出 $Y$ 为低当且仅当所有输入都为高，即 $I_1 \\cdot I_2 \\cdot \\ldots \\cdot I_k = 1$。PDN中的与功能通过串联NMOS晶体管实现。因此，PDN由 $k$ 个串联的NMOS晶体管组成，每个输入对应一个。\n- 上拉网络（PUN）将输出连接到电源（$V_{DD}$），并且当输出为逻辑高时必须导通。这发生在PDN的条件为假时，即 $\\overline{I_1 \\cdot I_2 \\cdot \\ldots \\cdot I_k} = 1$。PUN是PDN的逻辑和拓扑对偶。PDN中NMOS晶体管的串联连接对应于PUN中PMOS晶体管的并联连接。因此，PUN由 $k$ 个并联的PMOS晶体管组成，每个输入对应一个。\n\n功能性晶体管的总数是PDN和PUN中晶体管数量之和。\n$$T_A(k) = (\\text{NMOS数量}) + (\\text{PMOS数量}) = k + k = 2k$$\n\n**2. 路径 B 的晶体管数量：$T_B(k)$**\n\n在路径B中，$k$ 输入与非函数首先被分解为一个由2输入与非门组成的网络。问题指定了一个二叉树结构。一个有 $k$ 个叶节点（输入）的二叉树有 $k-1$ 个内部节点（门）。问题指出，根节点是一个2输入与非门，其余的 $k-2$ 个内部节点是2输入与门。\n\n首先，我们确定构建此结构所需的原始2输入与非门单元的数量。\n- 一个2输入与门必须由2输入与非门和反相器构成。标准构造基于德摩根定律：$A \\cdot B = \\overline{\\overline{A \\cdot B}}$。这需要一个2输入与非门后跟一个反相器。\n- 反过来，反相器被指定使用一个输入端连接在一起的2输入与非门来实现。这被认为是一个原始的2输入与非门单元。\n- 因此，一个2输入与门需要1个与非门单元用于初始的与非操作，以及1个与非门单元用于随后的反相，总共需要2个原始的2输入与非门单元。\n\n路径B中 $k$ 输入函数所需的原始2输入与非门单元总数是所有组成门的单元数之和：\n- 2输入与门的数量：$k-2$\n- 2输入与非门（根节点）的数量：$1$\n\n总单元数 = (与门数量 $\\times$ 每个与门的单元数) + (与非门数量 $\\times$ 每个与非门的单元数)\n总单元数 = $(k-2) \\times 2 + 1 \\times 1 = 2k - 4 + 1 = 2k - 3$\n\n接下来，我们计算每个原始2输入与非门单元的晶体管数量。使用与路径A中相同的静态CMOS设计原则，但对于 $k=2$ 的情况，一个2输入与非门具有：\n- 一个具有2个串联NMOS晶体管的PDN。\n- 一个具有2个并联PMOS晶体管的PUN。\n这使得每个2输入与非门单元总共有 $2+2=4$ 个晶体管。\n\n路径B的总晶体管数 $T_B(k)$ 是原始单元总数乘以每个单元的晶体管数。\n$$T_B(k) = (2k-3) \\times 4 = 8k - 12$$\n\n**3. 差值 $D(k)$ 的计算**\n\n问题将 $D(k)$ 定义为路径B和路径A的晶体管数量之差。\n$$D(k) = T_B(k) - T_A(k)$$\n代入上面推导出的表达式：\n$$D(k) = (8k - 12) - (2k)$$\n简化表达式得到：\n$$D(k) = 6k - 12$$\n该表达式对 $k \\geq 2$ 有效。当 $k=2$ 时，$T_A(2) = 2(2) = 4$ 且 $T_B(2) = 8(2)-12 = 4$，所以 $D(2)=0$。这是正确的，因为当 $k=2$ 时，两条路径都描述了一个简单的2输入与非门。对于 $k > 2$，路径B在晶体管数量方面效率较低。",
            "answer": "$$\\boxed{6k-12}$$"
        }
    ]
}