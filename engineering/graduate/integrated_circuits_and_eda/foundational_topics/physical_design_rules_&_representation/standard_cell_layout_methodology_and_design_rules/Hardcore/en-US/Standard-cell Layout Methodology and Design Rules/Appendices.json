{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any standard-cell library is the correct construction of its most basic geometric elements. This first practice focuses on creating a DRC-clean pin layout, a critical access point for signals. You will apply fundamental design rules, such as minimum width and via enclosure, to determine the smallest possible pin dimensions, illustrating how these constraints combine to define legal, manufacturable shapes .",
            "id": "4300658",
            "problem": "A standard-cell library in Integrated Circuits and Electronic Design Automation (EDA) is being developed for a single-height row architecture. Pin shapes are required on three drawing layers: polysilicon gate (Poly), Metal-1 (M1), and Metal-2 (M2). Each pin must be a single Manhattan rectangle aligned to the routing grid and must allow a center-placed cut (via/contact) to legally connect to the adjacent routing layer without Design Rule Checking (DRC) violations.\n\nThe foundational base is the set of DRC definitions:\n- Minimum width: for any polygon, the smallest orthogonal dimension must be at least a technology-specified minimum width.\n- Minimum spacing: the minimum distance between edges of two distinct polygons on the same layer must satisfy a technology-specified minimum spacing; spacing does not constrain a single isolated polygon’s internal dimensions.\n- Cut enclosure: for any cut (via/contact) placed inside a metal or poly polygon, the polygon must extend beyond the cut edge by at least the technology-specified enclosure on every side.\n\nThe following technology rules are provided:\n- For Poly: minimum width $w_{\\mathrm{poly}} = 20\\,\\mathrm{nm}$ and minimum spacing $s_{\\mathrm{poly}} = 56\\,\\mathrm{nm}$. The Poly-to-M1 contact (denote the cut layer as CA) is a square of edge length $a_{\\mathrm{CA}} = 20\\,\\mathrm{nm}$ that requires a Poly enclosure $e_{\\mathrm{poly,CA}} = 10\\,\\mathrm{nm}$ on all sides.\n- For M1: minimum width $w_{\\mathrm{M1}} = 40\\,\\mathrm{nm}$ and minimum spacing $s_{\\mathrm{M1}} = 40\\,\\mathrm{nm}$. The M1-to-M2 via (denote the cut layer as V1) is a square of edge length $a_{\\mathrm{V1}} = 28\\,\\mathrm{nm}$ that requires an M1 enclosure $e_{\\mathrm{M1,V1}} = 12\\,\\mathrm{nm}$ on all sides.\n- For M2: minimum width $w_{\\mathrm{M2}} = 36\\,\\mathrm{nm}$ and minimum spacing $s_{\\mathrm{M2}} = 36\\,\\mathrm{nm}$. The same M1-to-M2 via V1 requires an M2 enclosure $e_{\\mathrm{M2,V1}} = 12\\,\\mathrm{nm}$ on all sides.\n\nAssume the pin rectangle on each layer must fully contain the corresponding cut centered within the rectangle, and no other shapes are present nearby on the same layer (so minimum spacing does not constrain the rectangle’s internal dimensions). No minimum area rules apply. Using only the above DRC definitions and numbers, derive from first principles the minimum width and height of the pin rectangle on each layer that both avoids DRC violations and accommodates the cut, and report them in the order: Poly width, Poly height, M1 width, M1 height, M2 width, M2 height.\n\nExpress your final numerical answers in nanometers (nm). No rounding is required beyond exact arithmetic.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution based on standard principles of integrated circuit physical design.\n\nThe objective is to determine the minimum width and height of a rectangular pin on three different layers: Polysilicon (Poly), Metal-1 (M1), and Metal-2 (M2). The dimensions of this rectangle must satisfy two sets of design rule checks (DRCs) simultaneously for each layer: the minimum width rule and the cut enclosure rule.\n\nLet $W$ be the width and $H$ be the height of the pin rectangle on a given layer. Since the problem specifies a single Manhattan rectangle and the constraints are isotropic (the cut is a square and enclosure is uniform on all sides), the minimum required width and height will be identical. Let's denote this minimum dimension as $D_{\\mathrm{min}}$.\n\nFor any given layer, the minimum dimension $D_{\\mathrm{min}}$ is determined by the more restrictive of two constraints:\n1.  The minimum width rule for that layer, denoted $w_{\\mathrm{layer}}$. The pin dimension must be at least this value: $D \\ge w_{\\mathrm{layer}}$.\n2.  The cut enclosure rule. The pin rectangle must be large enough to contain the centered cut and extend beyond it by the required enclosure distance on all sides. If the cut has a dimension $a_{\\mathrm{cut}}$ along the axis of interest and the required enclosure is $e_{\\mathrm{layer,cut}}$, the total dimension required by this rule is $D_{\\mathrm{enclosure}} = a_{\\mathrm{cut}} + 2 \\times e_{\\mathrm{layer,cut}}$.\n\nTo satisfy both rules, the minimum legal dimension for the pin must be the maximum of the values required by each rule:\n$$D_{\\mathrm{min}} = \\max(w_{\\mathrm{layer}}, D_{\\mathrm{enclosure}})$$\n\nWe apply this principle to each layer specified.\n\n**1. Polysilicon (Poly) Layer Pin**\n\nThe pin on the Poly layer must accommodate the Poly-to-M1 contact (CA).\nThe given parameters are:\n-   Poly minimum width: $w_{\\mathrm{poly}} = 20\\,\\mathrm{nm}$.\n-   CA contact is a square with side length: $a_{\\mathrm{CA}} = 20\\,\\mathrm{nm}$.\n-   Poly enclosure of CA: $e_{\\mathrm{poly,CA}} = 10\\,\\mathrm{nm}$.\n\nFirst, we calculate the dimension required by the enclosure rule. The pin must extend by $e_{\\mathrm{poly,CA}}$ on two opposite sides of the contact.\nThe total dimension required for enclosure is:\n$$D_{\\mathrm{enclosure, poly}} = a_{\\mathrm{CA}} + 2 \\times e_{\\mathrm{poly,CA}} = 20\\,\\mathrm{nm} + 2 \\times 10\\,\\mathrm{nm} = 40\\,\\mathrm{nm}$$\nNext, we compare this with the minimum width rule for Poly:\n$$D_{\\mathrm{min, poly}} = \\max(w_{\\mathrm{poly}}, D_{\\mathrm{enclosure, poly}}) = \\max(20\\,\\mathrm{nm}, 40\\,\\mathrm{nm}) = 40\\,\\mathrm{nm}$$\nTherefore, the minimum width and minimum height of the Poly pin rectangle are both $40\\,\\mathrm{nm}$.\n\n**2. Metal-1 (M1) Layer Pin**\n\nThe pin on the M1 layer must accommodate the M1-to-M2 via (V1).\nThe given parameters are:\n-   M1 minimum width: $w_{\\mathrm{M1}} = 40\\,\\mathrm{nm}$.\n-   V1 via is a square with side length: $a_{\\mathrm{V1}} = 28\\,\\mathrm{nm}$.\n-   M1 enclosure of V1: $e_{\\mathrm{M1,V1}} = 12\\,\\mathrm{nm}$.\n\nWe calculate the dimension required by the enclosure rule for M1:\n$$D_{\\mathrm{enclosure, M1}} = a_{\\mathrm{V1}} + 2 \\times e_{\\mathrm{M1,V1}} = 28\\,\\mathrm{nm} + 2 \\times 12\\,\\mathrm{nm} = 28\\,\\mathrm{nm} + 24\\,\\mathrm{nm} = 52\\,\\mathrm{nm}$$\nNext, we compare this with the minimum width rule for M1:\n$$D_{\\mathrm{min, M1}} = \\max(w_{\\mathrm{M1}}, D_{\\mathrm{enclosure, M1}}) = \\max(40\\,\\mathrm{nm}, 52\\,\\mathrm{nm}) = 52\\,\\mathrm{nm}$$\nTherefore, the minimum width and minimum height of the M1 pin rectangle are both $52\\,\\mathrm{nm}$.\n\n**3. Metal-2 (M2) Layer Pin**\n\nThe pin on the M2 layer must also accommodate the M1-to-M2 via (V1).\nThe given parameters are:\n-   M2 minimum width: $w_{\\mathrm{M2}} = 36\\,\\mathrm{nm}$.\n-   V1 via is a square with side length: $a_{\\mathrm{V1}} = 28\\,\\mathrm{nm}$.\n-   M2 enclosure of V1: $e_{\\mathrm{M2,V1}} = 12\\,\\mathrm{nm}$.\n\nWe calculate the dimension required by the enclosure rule for M2:\n$$D_{\\mathrm{enclosure, M2}} = a_{\\mathrm{V1}} + 2 \\times e_{\\mathrm{M2,V1}} = 28\\,\\mathrm{nm} + 2 \\times 12\\,\\mathrm{nm} = 28\\,\\mathrm{nm} + 24\\,\\mathrm{nm} = 52\\,\\mathrm{nm}$$\nNext, we compare this with the minimum width rule for M2:\n$$D_{\\mathrm{min, M2}} = \\max(w_{\\mathrm{M2}}, D_{\\mathrm{enclosure, M2}}) = \\max(36\\,\\mathrm{nm}, 52\\,\\mathrm{nm}) = 52\\,\\mathrm{nm}$$\nTherefore, the minimum width and minimum height of the M2 pin rectangle are both $52\\,\\mathrm{nm}$.\n\nThe problem asks for the six values in the order: Poly width, Poly height, M1 width, M1 height, M2 width, M2 height.\nBased on our derivations, the values are:\n-   Poly width: $40\\,\\mathrm{nm}$\n-   Poly height: $40\\,\\mathrm{nm}$\n-   M1 width: $52\\,\\mathrm{nm}$\n-   M1 height: $52\\,\\mathrm{nm}$\n-   M2 width: $52\\,\\mathrm{nm}$\n-   M2 height: $52\\,\\mathrm{nm}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40 & 40 & 52 & 52 & 52 & 52\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once individual cells are designed, they must be placed side-by-side to form functional rows. This practice explores the critical interface between adjacent cells, where design rules must be respected across boundaries. By calculating the necessary spacer width based on layer-specific obstructions, you will learn how EDA tools ensure DRC correctness during abutment and why spacer cells are sometimes required .",
            "id": "4300630",
            "problem": "Consider two one-row-height standard cells $\\mathcal{C}_1$ and $\\mathcal{C}_2$ to be placed adjacent along a row in an Electronic Design Automation (EDA) flow. The cells are in the same orientation and power rail alignment, and they are intended to abut horizontally (i.e., their adjacent vertical boundaries meet). To prevent violations of Design Rule Check (DRC), each cell carries boundary obstructions on specific layers. A boundary obstruction encodes a conservative horizontal keep-out distance measured from the cell boundary to the nearest internal feature of that layer, such that when two cells are separated by a spacer of width $w$, the effective clearance between their nearest facing features on that layer is increased by $w$. The relevant layers and their minimum spacing rules are active diffusion (OD), polysilicon gate (PO), and first metal (M1). The foundry-specified minimum spacings across a cell boundary for the three layers are:\n- $s_{\\mathrm{OD}} = 20$ nm,\n- $s_{\\mathrm{PO}} = 50$ nm,\n- $s_{\\mathrm{M1}} = 36$ nm.\n\nCell $\\mathcal{C}_1$ has right-edge boundary obstruction extents:\n- $o_{1,\\mathrm{OD}} = 12$ nm,\n- $o_{1,\\mathrm{PO}} = 23$ nm,\n- $o_{1,\\mathrm{M1}} = 22$ nm.\n\nCell $\\mathcal{C}_2$ has left-edge boundary obstruction extents:\n- $o_{2,\\mathrm{OD}} = 5$ nm,\n- $o_{2,\\mathrm{PO}} = 18$ nm,\n- $o_{2,\\mathrm{M1}} = 10$ nm.\n\nStarting from the core definitions of layer-specific minimum spacing and boundary obstruction semantics, determine whether the two cells can legally abut with zero spacer (i.e., $w = 0$), and compute the minimal spacer width $w^{\\star}$ required to make the abutment DRC-clean across all three layers simultaneously. Express your final spacer width in nanometers (nm). Round your answer to three significant figures.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of Very Large Scale Integration (VLSI) physical design, specifically concerning standard cell layout and Design Rule Checking (DRC). The problem is well-posed, providing all necessary definitions, data, and constraints to arrive at a unique, meaningful solution. The language is objective and formal.\n\nThe fundamental principle governing the legal placement of two adjacent standard cells, $\\mathcal{C}_1$ and $\\mathcal{C}_2$, separated by a spacer of width $w$, is that for any given manufacturing layer $\\ell$, the total clearance between the cells' internal features must meet or exceed the foundry-specified minimum spacing for that layer, $s_{\\ell}$.\n\nThe problem defines boundary obstructions, $o_{1,\\ell}$ for the right edge of $\\mathcal{C}_1$ and $o_{2,\\ell}$ for the left edge of $\\mathcal{C}_2$, which represent the distance from a cell's boundary to its nearest internal feature on layer $\\ell$. When these cells are placed adjacent to each other with a spacer of width $w$, the total effective clearance, $d_{\\ell}(w)$, between the features on layer $\\ell$ across the boundary is the sum of the two obstructions and the spacer width:\n$$d_{\\ell}(w) = o_{1,\\ell} + o_{2,\\ell} + w$$\nThe DRC-clean condition for layer $\\ell$ is thus expressed as:\n$$d_{\\ell}(w) \\ge s_{\\ell}$$\nSubstituting the expression for $d_{\\ell}(w)$, we get:\n$$o_{1,\\ell} + o_{2,\\ell} + w \\ge s_{\\ell}$$\n\nFirst, we determine if the cells can be legally abutted with a zero-width spacer, which corresponds to the case where $w=0$. For this to be valid, the sum of the boundary obstructions for each layer must be greater than or equal to the minimum spacing for that layer:\n$$o_{1,\\ell} + o_{2,\\ell} \\ge s_{\\ell}$$\nWe must check this condition for the three specified layers: active diffusion ($\\mathrm{OD}$), polysilicon gate ($\\mathrm{PO}$), and first metal ($\\mathrm{M1}$).\n\nFor the active diffusion layer ($\\mathrm{OD}$):\nThe given values are $o_{1,\\mathrm{OD}} = 12$ nm, $o_{2,\\mathrm{OD}} = 5$ nm, and $s_{\\mathrm{OD}} = 20$ nm.\nThe total built-in clearance from obstructions is $o_{1,\\mathrm{OD}} + o_{2,\\mathrm{OD}} = 12 + 5 = 17$ nm.\nComparing with the minimum spacing rule: $17 < 20$. The condition is not met.\n\nFor the polysilicon gate layer ($\\mathrm{PO}$):\nThe given values are $o_{1,\\mathrm{PO}} = 23$ nm, $o_{2,\\mathrm{PO}} = 18$ nm, and $s_{\\mathrm{PO}} = 50$ nm.\nThe total built-in clearance from obstructions is $o_{1,\\mathrm{PO}} + o_{2,\\mathrm{PO}} = 23 + 18 = 41$ nm.\nComparing with the minimum spacing rule: $41 < 50$. The condition is not met.\n\nFor the first metal layer ($\\mathrm{M1}$):\nThe given values are $o_{1,\\mathrm{M1}} = 22$ nm, $o_{2,\\mathrm{M1}} = 10$ nm, and $s_{\\mathrm{M1}} = 36$ nm.\nThe total built-in clearance from obstructions is $o_{1,\\mathrm{M1}} + o_{2,\\mathrm{M1}} = 22 + 10 = 32$ nm.\nComparing with the minimum spacing rule: $32 < 36$. The condition is not met.\n\nSince the condition fails for one or more layers (in this case, all three), the conclusion is that the two cells cannot legally abut with a zero spacer ($w=0$).\n\nNext, we compute the minimal spacer width, $w^{\\star}$, required to make the abutment DRC-clean. For any single layer $\\ell$, the spacer width $w$ must satisfy:\n$$w \\ge s_{\\ell} - (o_{1,\\ell} + o_{2,\\ell})$$\nThe expression $s_{\\ell} - (o_{1,\\ell} + o_{2,\\ell})$ represents the clearance shortfall that must be provided by the spacer. Since a spacer cannot have a negative width, the minimum required spacer width for layer $\\ell$, denoted $w_{\\ell}$, is the greater of zero and the clearance shortfall:\n$$w_{\\ell} = \\max\\left(0, s_{\\ell} - (o_{1,\\ell} + o_{2,\\ell})\\right)$$\n\nWe now calculate this minimum width for each layer:\n\nFor $\\mathrm{OD}$:\n$$w_{\\mathrm{OD}} = \\max\\left(0, 20 - (12 + 5)\\right) = \\max(0, 20 - 17) = \\max(0, 3) = 3$$\n\nFor $\\mathrm{PO}$:\n$$w_{\\mathrm{PO}} = \\max\\left(0, 50 - (23 + 18)\\right) = \\max(0, 50 - 41) = \\max(0, 9) = 9$$\n\nFor $\\mathrm{M1}$:\n$$w_{\\mathrm{M1}} = \\max\\left(0, 36 - (22 + 10)\\right) = \\max(0, 36 - 32) = \\max(0, 4) = 4$$\n\nTo ensure the placement is DRC-clean for all layers simultaneously, the chosen spacer width must be at least as large as the maximum of the minimum widths required by each individual layer. Therefore, the overall minimal spacer width, $w^{\\star}$, is:\n$$w^{\\star} = \\max(w_{\\mathrm{OD}}, w_{\\mathrm{PO}}, w_{\\mathrm{M1}})$$\n$$w^{\\star} = \\max(3, 9, 4) = 9$$\nThe minimal required spacer width is exactly $9$ nm. The problem requests the answer to be expressed with three significant figures. Expressing the integer $9$ to three significant figures is $9.00$.",
            "answer": "$$\\boxed{9.00}$$"
        },
        {
            "introduction": "As technology nodes shrink, manufacturing limitations introduce complex new rules that go beyond simple geometry. This final practice delves into the world of double patterning lithography, a critical technique for advanced nodes. You will model spacing requirements as a graph coloring problem, translating physical distances into an abstract conflict graph to find a valid mask assignment, revealing the interplay between layout, manufacturability, and combinatorial optimization .",
            "id": "4300656",
            "problem": "Consider a row of three abutted complementary metal–oxide–semiconductor standard cells laid out on Metal-1 in a two-mask Litho–Etch–Litho–Etch (LELE) double patterning flow. In this flow, any two features closer than the same-mask minimum spacing must be assigned to different masks, while any two features closer than the different-mask minimum spacing constitute a hard design-rule violation regardless of color. The Electronic Design Automation (EDA) objective is to derive the color conflict graph from the given geometry and determine a feasible two-mask coloring consistent with the spacing rules and trim constraints.\n\nAssume the following well-tested Metal-1 rules and facts for the technology node under consideration:\n\n- Metal-1 minimum width is $w_{\\mathrm{min}} = 40\\,\\mathrm{nm}$, and every pin in this problem has width $w = 40\\,\\mathrm{nm}$ and spans the full cell height $H = 270\\,\\mathrm{nm}$.\n- Same-mask minimum spacing is $s_{\\mathrm{SM}} = 80\\,\\mathrm{nm}$.\n- Different-mask minimum spacing is $s_{\\mathrm{DM}} = 40\\,\\mathrm{nm}$.\n- For two vertical parallel Metal-1 rectangles of equal width $w$ whose projections on the vertical axis overlap over their full height, the side-to-side edge spacing along the horizontal axis between their nearest edges is $s_{ij} = |x_i - x_j| - w$.\n- A pair is an unconditional violation if $s_{ij}  s_{\\mathrm{DM}}$. A pair must be assigned to different masks if $s_{\\mathrm{DM}} \\leq s_{ij}  s_{\\mathrm{SM}}$. A pair has no coloring constraint if $s_{ij} \\geq s_{\\mathrm{SM}}$.\n\nThere are five vertical Metal-1 pin rectangles, indexed $R_1, R_2, R_3, R_4, R_5$, each spanning from $y=0\\,\\mathrm{nm}$ to $y=270\\,\\mathrm{nm}$ and centered at the following horizontal coordinates:\n- $R_1$: $x_1 = 0\\,\\mathrm{nm}$,\n- $R_2$: $x_2 = 90\\,\\mathrm{nm}$,\n- $R_3$: $x_3 = 170\\,\\mathrm{nm}$,\n- $R_4$: $x_4 = 250\\,\\mathrm{nm}$,\n- $R_5$: $x_5 = 330\\,\\mathrm{nm}$.\n\nIn addition to the spacing rules, the Self-Aligned Double Patterning (SADP) trim strategy used by the library imposes the following mask assignment constraints:\n\n- A pre-colored mandrel anchor fixes $R_1$ to mask $\\mathcal{A}$.\n- An end-cap continuity trim constraint requires $R_5$ to be on the same mask as $R_1$.\n\nStarting from the definitions and rules above, do the following:\n\n1. Compute all pairwise spacings $s_{ij}$ and derive the color conflict graph on vertices $\\{R_1,R_2,R_3,R_4,R_5\\}$ by placing an edge between $R_i$ and $R_j$ if and only if $s_{\\mathrm{DM}} \\leq s_{ij}  s_{\\mathrm{SM}}$.\n2. Using first principles about two-colorability of graphs and the provided anchor and trim constraints, determine whether a feasible two-mask coloring exists. If it exists, argue its structure and degrees of freedom.\n3. Determine the total number of distinct legal two-mask color assignments for $\\{R_1,R_2,R_3,R_4,R_5\\}$ that satisfy all spacing and trim rules.\n\nExpress your final answer as a plain integer. No rounding is required. No units should appear in the final answer.",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of double patterning lithography, well-posed with a clear objective and sufficient data, and uses objective, formal language. There are no contradictions or ambiguities that would prevent a rigorous solution. We proceed with the solution in three parts as requested.\n\nThe fundamental parameters given are the pin width $w = 40\\,\\mathrm{nm}$, the same-mask minimum spacing $s_{\\mathrm{SM}} = 80\\,\\mathrm{nm}$, and the different-mask minimum spacing $s_{\\mathrm{DM}} = 40\\,\\mathrm{nm}$. The horizontal center coordinates of the five rectangular pins $R_1, R_2, R_3, R_4, R_5$ are $x_1 = 0\\,\\mathrm{nm}$, $x_2 = 90\\,\\mathrm{nm}$, $x_3 = 170\\,\\mathrm{nm}$, $x_4 = 250\\,\\mathrm{nm}$, and $x_5 = 330\\,\\mathrm{nm}$, respectively.\n\nThe side-to-side spacing between two pins $R_i$ and $R_j$ is calculated using the formula $s_{ij} = |x_i - x_j| - w$. A coloring conflict, represented by an edge in the conflict graph, exists between $R_i$ and $R_j$ if and only if $s_{\\mathrm{DM}} \\leq s_{ij}  s_{\\mathrm{SM}}$. A hard violation, which makes any coloring impossible, would occur if $s_{ij}  s_{\\mathrm{DM}}$.\n\nFirst, we compute all unique pairwise spacings $s_{ij}$ for $i  j$:\n- $s_{12} = |x_1 - x_2| - w = |0 - 90| - 40 = 90 - 40 = 50\\,\\mathrm{nm}$.\n- $s_{13} = |x_1 - x_3| - w = |0 - 170| - 40 = 170 - 40 = 130\\,\\mathrm{nm}$.\n- $s_{14} = |x_1 - x_4| - w = |0 - 250| - 40 = 250 - 40 = 210\\,\\mathrm{nm}$.\n- $s_{15} = |x_1 - x_5| - w = |0 - 330| - 40 = 330 - 40 = 290\\,\\mathrm{nm}$.\n- $s_{23} = |x_2 - x_3| - w = |90 - 170| - 40 = 80 - 40 = 40\\,\\mathrm{nm}$.\n- $s_{24} = |x_2 - x_4| - w = |90 - 250| - 40 = 160 - 40 = 120\\,\\mathrm{nm}$.\n- $s_{25} = |x_2 - x_5| - w = |90 - 330| - 40 = 240 - 40 = 200\\,\\mathrm{nm}$.\n- $s_{34} = |x_3 - x_4| - w = |170 - 250| - 40 = 80 - 40 = 40\\,\\mathrm{nm}$.\n- $s_{35} = |x_3 - x_5| - w = |170 - 330| - 40 = 160 - 40 = 120\\,\\mathrm{nm}$.\n- $s_{45} = |x_4 - x_5| - w = |250 - 330| - 40 = 80 - 40 = 40\\,\\mathrm{nm}$.\n\nNow, we check these spacings against the coloring rule thresholds $s_{\\mathrm{DM}} = 40\\,\\mathrm{nm}$ and $s_{\\mathrm{SM}} = 80\\,\\mathrm{nm}$.\n- No spacing is less than $s_{\\mathrm{DM}} = 40\\,\\mathrm{nm}$, so there are no hard violations.\n- We identify conflicts where $40\\,\\mathrm{nm} \\leq s_{ij}  80\\,\\mathrm{nm}$:\n  - $s_{12} = 50\\,\\mathrm{nm}$: $40 \\leq 50  80 \\implies$ Conflict between $R_1$ and $R_2$.\n  - $s_{23} = 40\\,\\mathrm{nm}$: $40 \\leq 40  80 \\implies$ Conflict between $R_2$ and $R_3$.\n  - $s_{34} = 40\\,\\mathrm{nm}$: $40 \\leq 40  80 \\implies$ Conflict between $R_3$ and $R_4$.\n  - $s_{45} = 40\\,\\mathrm{nm}$: $40 \\leq 40  80 \\implies$ Conflict between $R_4$ and $R_5$.\n- All other spacings are greater than or equal to $s_{\\mathrm{SM}}=80\\,\\mathrm{nm}$, so they do not impose a coloring constraint.\n\nThe color conflict graph has vertices $\\{R_1, R_2, R_3, R_4, R_5\\}$ and edges corresponding to the conflicts identified. The edge set is $E = \\{(R_1, R_2), (R_2, R_3), (R_3, R_4), (R_4, R_5)\\}$. This structure forms a path graph of length $4$, which can be written as $R_1 - R_2 - R_3 - R_4 - R_5$.\n\nSecond, we determine if a feasible two-mask coloring exists. A graph is two-colorable if and only if it is bipartite, which is equivalent to stating that it contains no odd-length cycles. The conflict graph we derived is a path graph, which is a type of tree. All trees are bipartite and thus two-colorable. Therefore, a valid coloring with two masks, let's call them $\\mathcal{A}$ and $\\mathcal{B}$, is possible based on spacing rules alone.\n\nWe must now incorporate the additional trim constraints:\n1.  Color($R_1$) = $\\mathcal{A}$.\n2.  Color($R_5$) = Color($R_1$).\n\nWe analyze the consequences of these constraints on the coloring of the path graph. The requirement that adjacent vertices in the graph must have different colors propagates the coloring from $R_1$:\n- Color($R_1$) = $\\mathcal{A}$ (Anchor constraint).\n- Since $(R_1, R_2)$ is an edge, Color($R_2$) must be $\\mathcal{B}$.\n- Since $(R_2, R_3)$ is an edge, Color($R_3$) must be $\\mathcal{A}$.\n- Since $(R_3, R_4)$ is an edge, Color($R_4$) must be $\\mathcal{B}$.\n- Since $(R_4, R_5)$ is an edge, Color($R_5$) must be $\\mathcal{A}$.\n\nThis coloring is uniquely determined by the anchor on $R_1$ and the graph's connectivity. Now we must check for consistency with the second trim constraint, which requires Color($R_5$) = Color($R_1$). Our derived coloring yields Color($R_5$) = $\\mathcal{A}$ and Color($R_1$) = $\\mathcal{A}$. The constraint is satisfied.\nAlternatively, in any $2$-coloring of a bipartite graph, two vertices have the same color if and only if the distance (length of the shortest path) between them is even. The path from $R_1$ to $R_5$ in the conflict graph consists of $4$ edges. Since the distance is even, $R_1$ and $R_5$ must have the same color. The trim constraint is therefore consistent with the spacing-derived graph structure. A feasible coloring exists, and because the anchor fixes the color of one vertex in a connected graph, the coloring is unique. There are no degrees of freedom.\n\nThird, we determine the total number of distinct legal two-mask color assignments. As established in the previous step, the combination of the conflict graph structure and the anchor constraint Color($R_1$) = $\\mathcal{A}$ uniquely determines the color of every pin. The resulting color assignment is:\n- $R_1 \\to \\mathcal{A}$\n- $R_2 \\to \\mathcal{B}$\n- $R_3 \\to \\mathcal{A}$\n- $R_4 \\to \\mathcal{B}$\n- $R_5 \\to \\mathcal{A}$\n\nThis single assignment has been shown to be consistent with all spacing rules and both trim constraints. Since there are no choices to be made at any step, there is exactly one valid coloring scheme.\n\nThe total number of distinct legal two-mask color assignments is therefore $1$.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}