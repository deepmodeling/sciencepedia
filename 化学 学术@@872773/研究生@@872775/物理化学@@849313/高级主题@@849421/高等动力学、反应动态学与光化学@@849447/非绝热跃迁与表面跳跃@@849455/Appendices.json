{"hands_on_practices": [{"introduction": "非绝热跃迁最简洁且富有洞察力的模型是双态体系中的避免交叉。本练习将引导您完成分析此类系统的基本分析步骤，从一个给定的透热哈密顿量出发，推导出绝热势能面以及驱动跃迁的非绝热耦合。掌握这些是理解表面跳跃为何以及在何处发生的基石。[@problem_id:2655278]", "problem": "一个双原子分子在避免交叉附近通过一个依赖于单一核坐标 $R$ 的双态非绝热电子哈密顿量来建模，\n$$\nH_{e}(R)=\\begin{pmatrix}\n\\alpha R  & V\\\\\nV  & -\\alpha R\n\\end{pmatrix},\n$$\n其中 $\\alpha$ 和 $V$ 分别是具有单位长度能量和能量量纲的实常数。在电子与核运动的玻恩-奥本海默 (BO) 分离框架内，绝热势能面被定义为固定 $R$ 时电子哈密顿量的本征值，相应的绝热电子态是其关联的本征向量。从绝热态作为固定 $R$ 时不含时电子薛定谔方程的定态解的定义出发，并利用厄米矩阵及其本征问题的基本性质：\n\n- 通过对角化 $H_{e}(R)$，推导两个绝热势能面 $E_{+}(R)$ 和 $E_{-}(R)$ 的解析形式。\n- 定义绝热能隙 $\\Delta E(R)=E_{+}(R)-E_{-}(R)$，并确定使该能隙最小化的核坐标 $R_{\\min}$。计算相应的最小值 $\\Delta E_{\\min}$。\n- 使用绝热本征向量，引入一个混合角 $\\theta(R)$，用非绝热基来参数化绝热态，并将非绝热导数耦合 $d_{12}(R)=\\langle \\phi_{1}(R)|\\partial/\\partial R|\\phi_{2}(R)\\rangle$ 表示为 $\\theta(R)$ 及其导数的函数。确定 $|d_{12}(R)|$ 在何处达到最大值，并从您的表达式中提取一个 $R$ 中的特征长度标度，该标度量化了避免交叉区域的空间范围。\n- 将 $E_{-}(R)$ 在 $R=R_{\\min}$ 附近展开至二阶，以获得该点的局域曲率，并根据下绝热面的局域形状解释曲率的符号。\n\n作为最终答案，报告最小绝热能隙 $\\Delta E_{\\min}$ 关于 $\\alpha$ 和 $V$ 的闭合形式表达式。不需要进行数值计算，最终答案中也不应报告单位。", "solution": "所述问题具有科学依据、适定、客观且自洽。它使用一个标准的双态模型哈密顿量来探讨非绝热动力学的基本概念。该问题是有效的，可以构建出完整的解答。\n\n非绝热电子哈密顿量由下式给出\n$$\nH_{e}(R)=\\begin{pmatrix}\n\\alpha R  & V\\\\\nV  & -\\alpha R\n\\end{pmatrix}\n$$\n其中 $R$ 是核坐标，$\\alpha$ 和 $V$ 是实常数。\n\n绝热势能面，我记为 $E_{\\pm}(R)$，是 $H_{e}(R)$ 的本征值。为求得这些值，我们求解特征方程 $\\det(H_{e}(R) - E \\cdot I) = 0$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det \\begin{pmatrix}\n\\alpha R - E  & V\\\\\nV  & -\\alpha R - E\n\\end{pmatrix} = 0\n$$\n$$\n(\\alpha R - E)(-\\alpha R - E) - V^2 = 0\n$$\n$$\n-(\\alpha R)^2 - \\alpha R E + \\alpha R E + E^2 - V^2 = 0\n$$\n$$\nE^2 = (\\alpha R)^2 + V^2\n$$\n因此，两个本征值为：\n$$\nE_{\\pm}(R) = \\pm \\sqrt{(\\alpha R)^2 + V^2}\n$$\n这些是两个绝热势能面的解析形式。我们定义 $E_{+}(R) = \\sqrt{(\\alpha R)^2 + V^2}$ 为上势能面，$E_{-}(R) = -\\sqrt{(\\alpha R)^2 + V^2}$ 为下势能面。\n\n接下来，我们定义绝热能隙 $\\Delta E(R)$ 为两个势能面之差：\n$$\n\\Delta E(R) = E_{+}(R) - E_{-}(R) = \\sqrt{(\\alpha R)^2 + V^2} - (-\\sqrt{(\\alpha R)^2 + V^2}) = 2\\sqrt{(\\alpha R)^2 + V^2}\n$$\n为了找到使该能隙最小化的核坐标 $R_{\\min}$，我们必须找到函数 $\\Delta E(R)$ 的最小值。这等价于最小化平方根下的表达式 $f(R) = (\\alpha R)^2 + V^2$。我们通过将关于 $R$ 的一阶导数设为零来找到极值点：\n$$\n\\frac{d f(R)}{dR} = \\frac{d}{dR}((\\alpha R)^2 + V^2) = 2\\alpha^2 R = 0\n$$\n此条件仅在 $R = 0$ 时满足。二阶导数 $\\frac{d^2 f(R)}{dR^2} = 2\\alpha^2$ 为正（假设 $\\alpha \\neq 0$），这证实了 $R_{\\min} = 0$ 是一个极小值点。\n将 $R_{\\min} = 0$ 代入 $\\Delta E(R)$ 的表达式中，可得到绝热能隙的最小值：\n$$\n\\Delta E_{\\min} = \\Delta E(0) = 2\\sqrt{(\\alpha \\cdot 0)^2 + V^2} = 2\\sqrt{V^2} = 2|V|\n$$\n由于 $V$ 是一个实常数，为保证数学上的完全严谨性，需要使用绝对值。\n\n现在，我们引入一个混合角 $\\theta(R)$ 来参数化绝热态。绝热态是 $H_e(R)$ 的本征向量。它们通过一个旋转与非绝热基矢 $|d_1\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $|d_2\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 相关联。我们将绝热态定义为：\n$$\n|\\phi_1(R)\\rangle = |\\phi_-(R)\\rangle = \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix}\n$$\n$$\n|\\phi_2(R)\\rangle = |\\phi_+(R)\\rangle = \\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix}\n$$\n这个选择确保了这些态是标准正交的。要使它们成为本征向量，哈密顿量在该基下的表示必须是对角的。对角化的条件是变换后的哈密顿量 $U^{\\dagger} H_e U$ 的非对角元素为零，其中 $U(R)$ 是列为本征向量的旋转矩阵。这导致了以下关系：\n$$\n\\tan(2\\theta(R)) = \\frac{V}{\\alpha R}\n$$\n非绝热导数耦合为 $d_{12}(R)=\\langle \\phi_{1}(R)|\\partial/\\partial R|\\phi_{2}(R)\\rangle$。我们计算 $|\\phi_2(R)\\rangle$ 的导数：\n$$\n\\frac{\\partial}{\\partial R}|\\phi_2(R)\\rangle = \\frac{\\partial}{\\partial R}\\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix} = \\frac{d\\theta}{dR} \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix} = \\frac{d\\theta}{dR}|\\phi_1(R)\\rangle\n$$\n将此代入耦合的定义中：\n$$\nd_{12}(R) = \\left\\langle \\phi_1(R) \\middle| \\frac{d\\theta}{dR} \\middle| \\phi_1(R) \\right\\rangle = \\frac{d\\theta}{dR} \\langle \\phi_1(R) | \\phi_1(R) \\rangle = \\frac{d\\theta}{dR}\n$$\n为了求出 $\\frac{d\\theta}{dR}$，我们将 $\\tan(2\\theta) = V/(\\alpha R)$ 对 $R$ 求导：\n$$\n\\sec^2(2\\theta) \\cdot 2\\frac{d\\theta}{dR} = -\\frac{V}{\\alpha R^2}\n$$\n$$\n\\frac{d\\theta}{dR} = -\\frac{V}{2\\alpha R^2 \\sec^2(2\\theta)} = -\\frac{V \\cos^2(2\\theta)}{2\\alpha R^2}\n$$\n根据关系式 $\\tan(2\\theta) = V/(\\alpha R)$，我们得到 $\\cos^2(2\\theta) = \\frac{(\\alpha R)^2}{(\\alpha R)^2+V^2}$。代入后可得：\n$$\nd_{12}(R) = -\\frac{V}{2\\alpha R^2} \\frac{(\\alpha R)^2}{(\\alpha R)^2+V^2} = -\\frac{V\\alpha}{2((\\alpha R)^2+V^2)}\n$$\n耦合的幅度为 $|d_{12}(R)| = \\frac{|V\\alpha|}{2((\\alpha R)^2+V^2)}$。该函数是一个以 $R=0$ 为中心的洛伦兹函数。其最大值出现在分母最小处，即 $R=0$。此耦合区域的空间范围由其宽度来表征。当 $(\\alpha R)^2 = V^2$ 或 $|R| = |V/\\alpha|$ 时，该函数值降至其最大值的一半。因此，避免交叉区域的一个特征长度标度是\n$$\nL = \\frac{|V|}{|\\alpha|}\n$$\n这个具有长度量纲的长度标度，量化了绝热态的特性从一个非绝热态转变为另一个非绝热态的速度。\n\n最后，我们将 $E_{-}(R) = -\\sqrt{(\\alpha R)^2 + V^2}$ 在 $R_{\\min}=0$ 附近展开到二阶。这是一个泰勒展开。\n$$\nE_{-}(R) \\approx E_{-}(0) + \\left.\\frac{dE_{-}}{dR}\\right|_{R=0} R + \\frac{1}{2} \\left.\\frac{d^2E_{-}}{dR^2}\\right|_{R=0} R^2\n$$\n我们有 $E_{-}(0) = -|V|$。一阶导数为：\n$$\n\\frac{dE_{-}}{dR} = -\\frac{1}{2}((\\alpha R)^2 + V^2)^{-1/2}(2\\alpha^2 R) = -\\frac{\\alpha^2 R}{\\sqrt{(\\alpha R)^2 + V^2}}\n$$\n在 $R=0$ 处，$\\left.\\frac{dE_{-}}{dR}\\right|_{R=0} = 0$，这与极值点的预期相符。二阶导数为：\n$$\n\\frac{d^2E_{-}}{dR^2} = -\\alpha^2 \\frac{d}{dR} \\left( R ((\\alpha R)^2 + V^2)^{-1/2} \\right) = -\\alpha^2 \\left( \\frac{1}{\\sqrt{(\\alpha R)^2+V^2}} - \\frac{\\alpha^2 R^2}{((\\alpha R)^2+V^2)^{3/2}} \\right)\n$$\n$$\n\\frac{d^2E_{-}}{dR^2} = -\\alpha^2 \\frac{((\\alpha R)^2+V^2) - \\alpha^2 R^2}{((\\alpha R)^2+V^2)^{3/2}} = -\\frac{\\alpha^2 V^2}{((\\alpha R)^2+V^2)^{3/2}}\n$$\n在 $R=0$ 处的局域曲率是这个二阶导数在 $R=0$ 处的值：\n$$\n\\left.\\frac{d^2E_{-}}{dR^2}\\right|_{R=0} = -\\frac{\\alpha^2 V^2}{(V^2)^{3/2}} = -\\frac{\\alpha^2 V^2}{|V|^3} = -\\frac{\\alpha^2}{|V|}\n$$\n曲率的符号为负（因为 $\\alpha^2 \\ge 0$ 且 $|V|>0$）。在一阶导数为零的点，负曲率表示一个局域极大值。因此，下绝热面 $E_{-}(R)$ 在避免交叉点 $R=0$ 处存在一个势垒。这是该模型的一个特征，其中两个能级之间的排斥在交叉点处对下能级的推斥作用弱于远离交叉点处，从而形成一个局域极大值。", "answer": "$$\n\\boxed{2|V|}\n$$", "id": "2655278"}, {"introduction": "当一个轨迹被选定进行“跳跃”时，这一事件究竟是如何执行的？本练习深入探讨了最少开关表面跳跃（FSSH）算法的核心机制，重点关注调整核动量以保持总能量守恒的关键步骤。理解这一过程对于掌握FSSH模拟如何维持物理一致性，以及是什么导致了跃迁被禁止的“受挫跳跃”（frustrated hop）至关重要。[@problem_id:2655257]", "problem": "考虑一个包含 $N$ 个耦合核自由度的体系，在原子单位下，其具有对称正定质量矩阵 $M \\in \\mathbb{R}^{N \\times N}$ 和核动量 $p \\in \\mathbb{R}^{N}$，并在绝热电子态 $i$ 上演化。在几何构型 $R$ 处，该体系试图向态 $j$ 进行非绝热跃迁（hop），能量差为 $\\Delta E = E_{j}(R) - E_{i}(R)$，其中 $E_{i}(R)$ 和 $E_{j}(R)$ 是绝热电子能量。令 $d_{ij}(R) \\in \\mathbb{R}^{N}$ 表示跃迁点处的非绝热耦合矢量。\n\n假设遵循最少切换面跳算法的以下建模原则：(i) 跃迁时总能量守恒，(ii) 只有核动量沿非绝热耦合方向的分量被调整，以及 (iii) 在所有满足能量守恒的此类调整中，选择动量大小变化最小的那一个。这些原则意味着一个形式为 $p' = p + \\alpha\\, M d_{ij}(R)$ 的容许更新，其中 $\\alpha \\in \\mathbb{R}$ 为某个标量，$p'$ 是跃迁后的动量。\n\n仅从动能的二次型 $T(p) = \\tfrac{1}{2} p^{\\mathsf{T}} M^{-1} p$ 和能量守恒要求 $T(p') + E_{j}(R) = T(p) + E_{i}(R)$ 出发，推导 $p'$ 的闭式表达式以及一个标量判别式，该判别式的符号决定了是否存在实值 $\\alpha$。如果在所述的容许条件下没有实值 $\\alpha$ 满足能量守恒，则称该跃迁为受挫跃迁。\n\n将你的最终答案表示为一个数对，包含更新后的动量 $p'$ 和判别式 $D$，并用 $M$、$p$、$d_{ij}(R)$ 和 $\\Delta E$ 来表示。你可以使用符号函数 $\\operatorname{sgn}(\\cdot)$ 来编码最小变化的选择。无需进行数值计算。请以单个符号表达式的形式提供你的结果。", "solution": "该问题要求在最少切换面跳算法的原则下，推导更新后的核动量 $p'$ 及相关的判别式 $D$。推导始于总能量守恒的基本原理。\n\n跃迁前的总能量为 $E_{total} = T(p) + E_{i}(R)$，跃迁后的总能量为 $E'_{total} = T(p') + E_{j}(R)$。动能由二次型 $T(p) = \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p$ 给出。\n原则(i)，即总能量守恒，要求 $E_{total} = E'_{total}$：\n$$T(p) + E_{i}(R) = T(p') + E_{j}(R)$$\n重新整理此方程可得到动能的变化：\n$$T(p') - T(p) = E_{i}(R) - E_{j}(R) = -\\Delta E$$\n代入动能函数的定义：\n$$\\frac{1}{2} (p')^{\\mathsf{T}} M^{-1} p' - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n原则(ii)指出，更新后的动量 $p'$ 的形式为 $p' = p + \\alpha M d_{ij}$，其中 $\\alpha \\in \\mathbb{R}$ 为某个标量，$d_{ij}$ 是 $d_{ij}(R)$ 的简写。我们将此 $p'$ 的表达式代入能量守恒方程：\n$$\\frac{1}{2} (p + \\alpha M d_{ij})^{\\mathsf{T}} M^{-1} (p + \\alpha M d_{ij}) - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n我们展开第一项。由于质量矩阵 $M$ 是对称的 ($M^{\\mathsf{T}} = M$)，我们有：\n$$(p + \\alpha M d_{ij})^{\\mathsf{T}} M^{-1} (p + \\alpha M d_{ij}) = (p^{\\mathsf{T}} + \\alpha d_{ij}^{\\mathsf{T}} M^{\\mathsf{T}}) M^{-1} (p + \\alpha M d_{ij})$$\n$$= (p^{\\mathsf{T}} + \\alpha d_{ij}^{\\mathsf{T}} M) (M^{-1}p + \\alpha d_{ij})$$\n$$= p^{\\mathsf{T}} M^{-1} p + \\alpha p^{\\mathsf{T}} d_{ij} + \\alpha d_{ij}^{\\mathsf{T}} M M^{-1} p + \\alpha^2 d_{ij}^{\\mathsf{T}} M d_{ij}$$\n中间的两项是相等的，因为 $d_{ij}^{\\mathsf{T}} p = (p^{\\mathsf{T}} d_{ij})^{\\mathsf{T}}$，并且由于这是一个标量，它等于其转置 $p^{\\mathsf{T}} d_{ij}$。展开式简化为：\n$$p^{\\mathsf{T}} M^{-1} p + 2\\alpha (p^{\\mathsf{T}} d_{ij}) + \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij})$$\n将此代回能量方程：\n$$\\frac{1}{2} \\left[ p^{\\mathsf{T}} M^{-1} p + 2\\alpha (p^{\\mathsf{T}} d_{ij}) + \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij}) \\right] - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n$p^{\\mathsf{T}} M^{-1} p$ 项相互抵消：\n$$\\alpha (p^{\\mathsf{T}} d_{ij}) + \\frac{1}{2} \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij}) = -\\Delta E$$\n这可以被重新整理成关于 $\\alpha$ 的标准二次方程形式 $A_q \\alpha^2 + B_q \\alpha + C_q = 0$：\n$$\\left( \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij} \\right) \\alpha^2 + \\left( p^{\\mathsf{T}} d_{ij} \\right) \\alpha + \\Delta E = 0$$\n系数为：\n$A_q = \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij}$\n$B_q = p^{\\mathsf{T}} d_{ij}$\n$C_q = \\Delta E$\n\n当且仅当此二次方程的判别式为非负时，$\\alpha$ 存在实值解。这就是问题所要求的判别式。我们称之为 $D$。\n$$D = B_q^2 - 4 A_q C_q = (p^{\\mathsf{T}} d_{ij})^2 - 4 \\left( \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij} \\right) (\\Delta E)$$\n$$D = (p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})$$\n如果 $D  0$，则跃迁是受挫的，因为没有实数 $\\alpha$ 能满足能量守恒。\n如果 $D \\ge 0$，$\\alpha$ 的解由二次方程求根公式给出：\n$$\\alpha = \\frac{-B_q \\pm \\sqrt{D}}{2 A_q} = \\frac{-(p^{\\mathsf{T}} d_{ij}) \\pm \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}}$$\n原则(iii)要求选择对应动量大小变化最小的解。动量的变化是 $\\Delta p = p' - p = \\alpha M d_{ij}$。其大小由 $|\\alpha|$ 决定，因为 $\\| \\Delta p \\| = \\| \\alpha M d_{ij} \\| = |\\alpha| \\cdot \\| M d_{ij} \\|$。为了最小化变化，我们必须选择绝对值较小的根 $\\alpha$。\n\n设两个根为 $\\alpha_1 = \\frac{-B_q + \\sqrt{D}}{2A_q}$ 和 $\\alpha_2 = \\frac{-B_q - \\sqrt{D}}{2A_q}$。\n我们通过考虑 $B_q = p^{\\mathsf{T}} d_{ij}$ 的符号来分析哪个根的量值更小。\n系数 $A_q = \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij}$ 是严格为正的，因为 $M$ 是正定的且 $d_{ij}$ 非零。\n- 若 $B_q > 0$，则 $-B_q$ 为负。$\\alpha_2$ 的分子为 $-B_q - \\sqrt{D}$，是两个负数之和（因为 $\\sqrt{D} \\ge 0$）。$\\alpha_1$ 的分子为 $-B_q + \\sqrt{D}$，表示一个差值。因此， $|-B_q + \\sqrt{D}|  |-B_q - \\sqrt{D}|$，这意味着 $|\\alpha_1|  |\\alpha_2|$。正确的选择是 $\\alpha_1$。\n- 若 $B_q  0$，则 $-B_q$ 为正。$\\alpha_1$ 的分子为 $-B_q + \\sqrt{D}$，是两个正数之和。$\\alpha_2$ 的分子为 $-B_q - \\sqrt{D}$，是一个差值。因此， $|-B_q - \\sqrt{D}|  |-B_q + \\sqrt{D}|$，且 $|\\alpha_2|  |\\alpha_1|$。正确的选择是 $\\alpha_2$。\n- 若 $B_q = 0$，两个根为 $\\alpha = \\pm \\frac{\\sqrt{D}}{2A_q}$，其量值相等。最小变化原则不足以产生唯一的选择。然而，问题允许使用 $\\operatorname{sgn}(\\cdot)$ 函数，这表明可以采用一个约定。\n\n根的选择可以用符号函数 $\\operatorname{sgn}(B_q)$ 简洁地表示。\n所选的根具有形式 $\\frac{-B_q - \\operatorname{sgn}(B_q) \\sqrt{D}}{2 A_q}$。这是在数值计算中为避免两个相近数相减而导致精度损失的稳定形式，但这里最小化$|\\alpha|$的逻辑是关键。\n- 若 $B_q > 0$ (sgn=1), 我们选 $\\alpha_1 = \\frac{-B_q + \\sqrt{D}}{2 A_q}$.\n- 若 $B_q  0$ (sgn=-1), 我们选 $\\alpha_2 = \\frac{-B_q - \\sqrt{D}}{2 A_q}$.\n- 若 $B_q = 0$ (sgn=0 or 1 by convention), 我们选 $\\alpha = \\frac{\\sqrt{D}}{2A_q}$ (假设 $\\operatorname{sgn}(0)=1$)。\n\n因此，所选的 $\\alpha$ 值统一为：\n$$\\alpha = \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}}$$\n此处的sgn(0)约定为+1。最后，我们将这个 $\\alpha$ 的表达式代入 $p'$ 的形式中，以获得跃迁后动量的最终闭式表达式：\n$$p' = p + \\left( \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}} \\right) M d_{ij}$$\n所要求的两个量是这个 $p'$ 的表达式和判别式 $D$。", "answer": "$$ \\boxed{ \\left( p' = p + \\left( \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^{2} - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}} \\right) M d_{ij} \\, , \\, D = (p^{\\mathsf{T}} d_{ij})^{2} - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij}) \\right) } $$", "id": "2655257"}, {"introduction": "最后的这个练习将从解析推导转向完整的数值模拟。您将为经典的 Landau-Zener 模型实现一个求解含时薛定谔方程的程序，该模型描述了系统以恒定速率通过避免交叉区域。通过将您的数值结果与精确的解析公式进行比较，您将验证非绝热跃迁的基础理论，并获得使用该领域计算工具的宝贵经验。[@problem_id:2655262]", "problem": "考虑一个透热表象中的双能级 Landau–Zener 模型，其含时电子哈密顿量由下式给出\n$$\nH(t) = \\begin{pmatrix}\n\\frac{v\\,t}{2}   \\Delta\\\\\n\\Delta   -\\frac{v\\,t}{2}\n\\end{pmatrix},\n$$\n其中 $t$ 是时间，$\\Delta  0$ 是一个恒定的透热耦合，而 $v  0$ 是透热能量差的扫描速率。假设约化普朗克常数为 $ \\hbar = 1 $。绝热本征能量为 $ \\pm \\varepsilon(t) $，其中 $ \\varepsilon(t) = \\sqrt{\\Delta^2 + \\left(\\frac{v\\,t}{2}\\right)^2} $。对于足够大的 $|t|$，绝热基与透热基在一个相位因子内重合，瞬时绝热态是 $H(t)$ 的本征矢量。\n\n从第一性原理出发，使用含时薛定谔方程 (TDSE)，\n$$\ni \\frac{d}{dt} \\Psi(t) = H(t)\\, \\Psi(t),\n$$\n来计算渐近电子布居数，其定义如下：在大的负时间 $t_0 \\ll 0$ 处将电子态初始化为绝热基态，演化至大的正时间 $t_f \\gg 0$，然后投影到 $t_f$ 处的绝热激发态上。该投影的模方即为渐近激发态绝热布居数。在混合量子经典方法的背景下，对于给定的对应于上述线性时间依赖关系的经典轨道 $x(t)$，Ehrenfest 动力学预测的电子演化与 TDSE 对此双能级模型预测的相同，因为电子振幅沿着给定路径在相同的哈密顿量下演化。对于最少切换表面跳跃 (Fewest Switches Surface Hopping, FSSH) 方法，在单次通过无反射的避让交叉点且扫描速率 $v$ 恒定的情况下，绝热态之间的渐近非绝热跃迁概率是（作为此标准模型的一个经过充分检验的事实）：\n$$\nP_{\\mathrm{FSSH}} = \\exp\\left( -\\frac{2\\pi \\Delta^2}{v} \\right).\n$$\n您必须为每组参数 $(\\Delta, v)$ 计算三个量：\n- $P_{\\mathrm{EH}}$：由 Ehrenfest 动力学预测的渐近激发态绝热布居数，通过从 $t_0$ 到 $t_f$ 数值积分 TDSE 获得，其初始条件为 $t_0$ 处的瞬时绝热基态，然后将最终波函数投影到 $t_f$ 处的瞬时绝热激发态上。\n- $P_{\\mathrm{FSSH}}$：使用上述公式的最少切换表面跳跃预测值。\n- $P_{\\mathrm{exact}}$：通过如 $P_{\\mathrm{EH}}$ 所述的数值积分 TDSE 得到的精确量子结果。\n\n请采用以下有原则的数值方案，以确保渐近条件和准确性，而不在传播过程本身依赖快捷公式：\n- 选择 $t_0 = -T$ 和 $t_f = +T$，其中 $T$ 足够大以至于 $|v T| \\gg \\Delta$。一个稳健的选择是 $T = \\max(20, 40\\,\\Delta/v)$。\n- 在透热基下，使用高精度时间积分器积分 TDSE，其绝对和相对容差分别不劣于 $10^{-10}$ 和 $10^{-8}$，确保波函数范数与 1 的偏差在 $10^{-8}$ 以内。\n- 将初始条件 $\\Psi(t_0)$ 定义为 $H(t_0)$ 的绝热基态本征矢量，并计算到 $H(t_f)$ 的绝热激发态本征矢量的最终投影，取内积的模方作为布居数。\n\n角度没有出现，除了采用的约定 $ \\hbar = 1 $ 外没有物理单位，因此不需要单位转换。将所有概率表示为四舍五入到六位小数的小数。\n\n测试套件：\n为以下每组参数 $(\\Delta, v)$ 计算三元组 $\\left(P_{\\mathrm{EH}}, P_{\\mathrm{FSSH}}, P_{\\mathrm{exact}}\\right)$：\n1. $(\\Delta, v) = (0.1, 1.0)$\n2. $(\\Delta, v) = (0.5, 1.0)$\n3. $(\\Delta, v) = (0.5, 0.2)$\n4. $(\\Delta, v) = (1.0, 5.0)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序 $[P_{\\mathrm{EH}}, P_{\\mathrm{FSSH}}, P_{\\mathrm{exact}}]$ 输出三个四舍五入的概率，并将所有用例按上述顺序连接成一个扁平列表。例如，输出必须如下所示\n\"[EH1,FSSH1,EXACT1,EH2,FSSH2,EXACT2,EH3,FSSH3,EXACT3,EH4,FSSH4,EXACT4]\"\n其中每个条目都四舍五入到六位小数。", "solution": "该问题要求计算双能级 Landau-Zener 系统的非绝热跃迁概率。首先评估问题陈述的有效性。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n-   **哈密顿量**：含时透热哈密顿量为 $H(t) = \\begin{pmatrix} \\frac{v\\,t}{2}   \\Delta\\\\ \\Delta   -\\frac{v\\,t}{2} \\end{pmatrix}$。\n-   **参数**：透热耦合 $\\Delta  0$，扫描速率 $v  0$。\n-   **常数**：约化普朗克常数 $\\hbar = 1$。\n-   **绝热能量**：$\\pm \\varepsilon(t)$，其中 $\\varepsilon(t) = \\sqrt{\\Delta^2 + \\left(\\frac{v\\,t}{2}\\right)^2}$。\n-   **运动方程**：含时薛定谔方程 (TDSE)，$i \\frac{d}{dt} \\Psi(t) = H(t)\\, \\Psi(t)$。\n-   **过程**：系统在 $t_0 \\ll 0$ 时初始化于绝热基态，演化至 $t_f \\gg 0$，最终态投影到 $t_f$ 处的绝热激发态。该投影的模方即为所求的布居数。\n-   **待计算量**：\n    1.  $P_{\\mathrm{EH}}$：来自 Ehrenfest 动力学的渐近激发态绝热布居数，对于该模型，这等效于 TDSE 的直接数值解。\n    2.  $P_{\\mathrm{FSSH}}$：最少切换表面跳跃的非绝热跃迁概率，由解析公式 $P_{\\mathrm{FSSH}} = \\exp\\left( -\\frac{2\\pi \\Delta^2}{v} \\right)$ 给出。\n    3.  $P_{\\mathrm{exact}}$：精确量子结果，定义为通过与 $P_{\\mathrm{EH}}$ 相同的数值 TDSE 积分获得。\n-   **数值方案**：\n    -   积分时间：$t_0 = -T$, $t_f = +T$，其中 $T = \\max(20, 40\\,\\Delta/v)$。\n    -   积分器容差：`atol` $\\le 10^{-10}$，`rtol` $\\le 10^{-8}$。\n    -   初始条件：$\\Psi(t_0)$ 是 $H(t_0)$ 的瞬时绝热基态本征矢量。\n    -   最终可观测量：在 $H(t_f)$ 的瞬时绝热激发态本征矢量中的布居数。\n-   **测试套件**：$(\\Delta, v)$ 对：$(0.1, 1.0)$, $(0.5, 1.0)$, $(0.5, 0.2)$, $(1.0, 5.0)$。\n\n**步骤2：使用提取的给定条件进行验证**\n-   **科学基础**：该问题在根本上是合理的。它基于 Landau-Zener 模型（非绝热动力学的基石）和 TDSE（量子力学的基本方程）。$P_{\\mathrm{FSSH}}$ 的公式是众所周知的 Landau-Zener 跃迁概率解析式，已知 FSSH 对此模型能重现此结果。关于在预设路径下，Ehrenfest 动力学与电子子系统的 TDSE 等效的陈述是正确的。\n-   **适定性**：该问题是适定的。它提供了清晰的初始状态、确定性的演化方程以及待测量量的精确定义。数值方案指定了获得唯一且稳定解所需的所有参数。\n-   **客观性**：该问题以精确、客观和标准的科学语言陈述。\n-   **缺陷分析**：\n    -   问题陈述 $P_{\\mathrm{EH}}$ 和 $P_{\\mathrm{exact}}$ 要 a) 通过 TDSE 积分计算，并且 b) 分别与 Ehrenfest 动力学和精确量子动力学相关。鉴于预设的经典路径，这两者确实是相同的。这不是一个逻辑缺陷，而是一种检验对“对于此模型，Ehrenfest 的电子运动方程就是 TDSE”这一点的理解方式。\n    -   问题正确地将非绝热跃迁概率（从绝热基态到绝热激发态）与标记为 $P_{\\mathrm{FSSH}}$ 的 Landau-Zener 解析公式等同起来。这是一致的。\n    -   不存在其他缺陷，如不完整、矛盾或不可行。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供一个解决方案。\n\n### 求解推导\n\n核心任务是求解状态矢量 $\\Psi(t) = \\begin{pmatrix} c_1(t) \\\\ c_2(t) \\end{pmatrix}$ 的 TDSE, $i \\frac{d\\Psi}{dt} = H(t)\\Psi$。通过将复系数 $c_k(t)$ 分解为实部和虚部, $c_k(t) = c_{k,R}(t) + i c_{k,I}(t)$，这可以被表述为一个由四个实值一阶常微分方程 (ODEs) 组成的系统。待积分的系统是：\n$$\n\\frac{d}{dt} \\begin{pmatrix} c_{1,R} \\\\ c_{1,I} \\\\ c_{2,R} \\\\ c_{2,I} \\end{pmatrix} = \\begin{pmatrix} 0   \\frac{vt}{2}   0   \\Delta \\\\ -\\frac{vt}{2}   0   -\\Delta   0 \\\\ 0   \\Delta   0   -\\frac{vt}{2} \\\\ -\\Delta   0   \\frac{vt}{2}   0 \\end{pmatrix} \\begin{pmatrix} c_{1,R} \\\\ c_{1,I} \\\\ c_{2,R} \\\\ c_{2,I} \\end{pmatrix}\n$$\n该系统从 $t_0 = -T$ 积分到 $t_f = T$。\n\n**初始态和最终态**：初始态 $\\Psi(t_0)$ 和最终投影态必须是 $H(t)$ 的瞬时绝热本征矢量。使用混合角形式推导了这些本征矢量的一种数值稳定表示。哈密顿量可以写成 $H(t) = \\varepsilon(t) (\\cos\\alpha(t)\\sigma_z + \\sin\\alpha(t)\\sigma_x)$，其中 $\\sigma_i$ 是泡利矩阵，$\\cos\\alpha(t) = (vt/2)/\\varepsilon(t)$ 且 $\\sin\\alpha(t) = \\Delta/\\varepsilon(t)$。对应于本征值 $\\mp\\varepsilon(t)$（基态/激发态）的归一化本征矢量是：\n$$\n\\Psi_{GS}(t) = \\begin{pmatrix} -\\sin(\\alpha(t)/2) \\\\ \\cos(\\alpha(t)/2) \\end{pmatrix} \\quad , \\quad \\Psi_{ES}(t) = \\begin{pmatrix} \\cos(\\alpha(t)/2) \\\\ \\sin(\\alpha(t)/2) \\end{pmatrix}\n$$\n其中 $\\alpha(t) = \\arctan_2(\\Delta, vt/2)$ 确保了正确的相位。分量 $\\cos(\\alpha/2)$ 和 $\\sin(\\alpha/2)$ 使用半角恒等式进行稳健计算。\n\n-   **初始条件**：系统在 $t_0 = -T$ 时从绝热基态开始。初始状态矢量为 $\\Psi(t_0) = \\Psi_{GS}(-T)$。\n-   **数值积分**：我们使用一个高阶自适应步长积分器（DOP853，一个8阶 Dormand-Prince 方法），采用严格的容差（`rtol=1e-8`，`atol=1e-10`）来求解 ODE 系统，得到最终状态矢量 $\\Psi(t_f)$。\n-   **最终投影**：问题要求计算在 $t_f=T$ 时绝热激发态的布居数。这通过将最终状态 $\\Psi(t_f)$ 投影到目标本征矢量 $\\Psi_{ES}(T)$ 上来计算。概率是此投影的模方：\n    $$\n    P = \\left| \\langle \\Psi_{ES}(T) | \\Psi(T) \\rangle \\right|^2 = \\left| (\\Psi_{ES}(T))^\\dagger \\Psi(T) \\right|^2\n    $$\n根据问题定义，这个数值上得到的概率同时给出了 $P_{\\mathrm{EH}}$ 和 $P_{\\mathrm{exact}}$。$P_{\\mathrm{FSSH}}$ 则由其解析公式独立计算。数值结果与解析结果的紧密一致性可作为对该实现的一种验证。", "answer": "[0.939113,0.939113,0.939113,0.207880,0.207880,0.207880,0.000388,0.000388,0.000388,0.284617,0.284617,0.284617]", "id": "2655262"}]}