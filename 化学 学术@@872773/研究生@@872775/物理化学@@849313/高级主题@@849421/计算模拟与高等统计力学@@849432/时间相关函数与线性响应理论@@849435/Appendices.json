{"hands_on_practices": [{"introduction": "这个练习探讨周期性外场与系统稳态响应之间的基本关系。通过该练习，您将理解响应函数 $\\chi(\\omega)$ 如何决定响应的振幅和相位。更关键的是，您将把响应函数的虚部 $\\chi''(\\omega)$ 与能量耗散的物理过程联系起来，这是线性响应理论的基石之一 [@problem_id:2682777]。", "problem": "一个处于热平衡状态的宏观系统受到一个弱的、随时间变化的外部场的作用，该场与系统的某个可观测量线性耦合。设未受扰动的哈密顿量增加了一个形式为 $H'(t)=-F(t)\\,B$ 的微扰，其中 $B$ 是系统的一个可观测量，$F(t)$ 是由实验者控制的标量场。考虑系统的另一个可观测量 $A$，并假设在线性响应区域内，其期望值的变化通过一个因果响应函数与所施加的场相关联。将频域极化率 $\\chi_{AB}(\\omega)=\\chi'_{AB}(\\omega)+i\\,\\chi''_{AB}(\\omega)$ 定义为连接 $\\langle A(t)\\rangle$ 变化与 $F(t)$ 的因果响应函数的傅里叶变换，并约定对单色驱动的稳态响应是通过将极化率乘以场在相同频率下的傅里叶分量得到的。\n\n现在施加一个正弦场 $F(t)=F_{0}\\cos(\\omega t)$，其角频率 $\\omega$ 和振幅 $F_{0}$ 固定，作用时间足够长，以至于瞬态响应已经消失，并建立了稳态周期性响应。在此稳态下，可观测量 $A$ 以相同的频率振荡，可以写成形式 $\\langle A(t)\\rangle_{\\text{ss}}=A_{0}\\cos(\\omega t-\\delta)$，其中 $A_{0}$ 是响应振幅，$\\delta$ 是相对于场的相位延迟。\n\n任务：\n- 仅使用上述定义以及线性响应和傅里叶分析的基本原理，推导出用 $\\chi'_{AB}(\\omega)$、$\\chi''_{AB}(\\omega)$ 和 $F_{0}$ 表示的 $A_{0}$ 和 $\\delta$。\n- 然后，特别地考虑在微扰 $H'(t)$ 中与场相乘的共轭可观测量 $B$，利用能量守恒来表示每个周期耗散的平均能量 $W_{\\text{diss}}$，用 $F_{0}$ 和相应极化率的虚部 $\\chi''_{BB}(\\omega)$ 表示。假设输入系统的周期平均功率是在一个周期内对 $\\langle \\partial H'(t)/\\partial t\\rangle$ 的时间平均，且一个周期的持续时间为 $2\\pi/\\omega$。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含 $A_{0}$、$ \\delta$ 和 $W_{\\text{diss}}$ 的表达式。能量以焦耳为单位表示。不需要进行数值计算，也不需要四舍五入。", "solution": "该问题提法清晰，基于统计力学中线性响应理论的基本原理。因此，该问题是有效的。我们将着手进行推导。\n\n问题的核心在于外部微扰与系统响应之间的关系。在线性响应区域内，由含时场 $F(t)$引起的可观测量 $A$ 的期望值的变化由以下卷积积分给出：\n$$\n\\Delta\\langle A(t) \\rangle = \\int_{-\\infty}^{t} \\chi_{AB}(t-t') F(t') dt'\n$$\n其中 $\\chi_{AB}(t-t')$ 是因果响应函数。因果性要求当 $\\tau  0$ 时，$\\chi_{AB}(\\tau) = 0$。在频域中，如此问题所述，该卷积变为乘积：\n$$\n\\Delta\\langle A(\\omega) \\rangle = \\chi_{AB}(\\omega) F(\\omega)\n$$\n其中 $\\Delta\\langle A(\\omega) \\rangle$、$\\chi_{AB}(\\omega)$ 和 $F(\\omega)$ 是相应时域函数的傅里叶变换。我们使用约定 $G(\\omega) = \\int_{-\\infty}^{\\infty} g(t) e^{i\\omega t} dt$ 和 $g(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} G(\\omega) e^{-i\\omega t} d\\omega$。\n\n第1部分：$A_0$ 和 $\\delta$ 的推导。\n\n施加的外部场为 $F(t) = F_0 \\cos(\\omega t)$。我们可以用复指数表示为：\n$$\nF(t) = F_0 \\frac{e^{i\\omega t} + e^{-i\\omega t}}{2}\n$$\n场 $F(\\omega')$ 的傅里叶变换为：\n$$\nF(\\omega') = \\int_{-\\infty}^{\\infty} F_0 \\frac{e^{i\\omega t} + e^{-i\\omega t}}{2} e^{i\\omega' t} dt = \\frac{F_0}{2} \\int_{-\\infty}^{\\infty} (e^{i(\\omega+\\omega')t} + e^{i(-\\omega+\\omega')t}) dt\n$$\n使用狄拉克δ函数的积分表示 $\\int_{-\\infty}^{\\infty} e^{ikx} dx = 2\\pi \\delta(k)$，我们得到：\n$$\nF(\\omega') = \\frac{F_0}{2} [2\\pi \\delta(\\omega+\\omega') + 2\\pi \\delta(-\\omega+\\omega')] = \\pi F_0 [\\delta(\\omega'+\\omega) + \\delta(\\omega'-\\omega)]\n$$\n频域中的响应为 $\\Delta\\langle A(\\omega') \\rangle = \\chi_{AB}(\\omega') F(\\omega')$。代入 $F(\\omega')$, 我们得到：\n$$\n\\Delta\\langle A(\\omega') \\rangle = \\pi F_0 [\\chi_{AB}(\\omega')\\delta(\\omega'+\\omega) + \\chi_{AB}(\\omega')\\delta(\\omega'-\\omega)] = \\pi F_0 [\\chi_{AB}(-\\omega)\\delta(\\omega'+\\omega) + \\chi_{AB}(\\omega)\\delta(\\omega'-\\omega)]\n$$\n为了找到时变响应 $\\Delta\\langle A(t) \\rangle$（对应于稳态响应 $\\langle A(t) \\rangle_{\\text{ss}}$），我们进行傅里叶逆变换：\n$$\n\\Delta\\langle A(t) \\rangle = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\Delta\\langle A(\\omega') \\rangle e^{-i\\omega' t} d\\omega' = \\frac{F_0}{2} \\int_{-\\infty}^{\\infty} [\\chi_{AB}(-\\omega)\\delta(\\omega'+\\omega) + \\chi_{AB}(\\omega)\\delta(\\omega'-\\omega)] e^{-i\\omega' t} d\\omega'\n$$\n$$\n\\Delta\\langle A(t) \\rangle = \\frac{F_0}{2} [\\chi_{AB}(-\\omega)e^{i\\omega t} + \\chi_{AB}(\\omega)e^{-i\\omega t}]\n$$\n由于响应函数 $\\chi_{AB}(t)$ 是一个实值函数，其傅里叶变换满足性质 $\\chi_{AB}(-\\omega) = \\chi_{AB}^*(\\omega)$。将此代入表达式中得到：\n$$\n\\Delta\\langle A(t) \\rangle = \\frac{F_0}{2} [\\chi_{AB}^*(\\omega)e^{i\\omega t} + \\chi_{AB}(\\omega)e^{-i\\omega t}]\n$$\n这个表达式是第二项实部的两倍：\n$$\n\\Delta\\langle A(t) \\rangle = F_0 \\text{Re}[\\chi_{AB}(\\omega)e^{-i\\omega t}]\n$$\n让我们使用极化率的复数形式 $\\chi_{AB}(\\omega) = \\chi'_{AB}(\\omega) + i\\chi''_{AB}(\\omega)$ 来展开这个表达式：\n$$\n\\Delta\\langle A(t) \\rangle = F_0 \\text{Re}[(\\chi'_{AB}(\\omega) + i\\chi''_{AB}(\\omega))(\\cos(\\omega t) - i\\sin(\\omega t))]\n$$\n$$\n\\Delta\\langle A(t) \\rangle = F_0 [\\chi'_{AB}(\\omega)\\cos(\\omega t) + \\chi''_{AB}(\\omega)\\sin(\\omega t)]\n$$\n问题陈述该稳态响应的形式为 $\\langle A(t)\\rangle_{\\text{ss}} = A_0 \\cos(\\omega t - \\delta)$。使用余弦差的三角恒等式，我们展开此形式：\n$$\n\\langle A(t)\\rangle_{\\text{ss}} = A_0 (\\cos(\\omega t)\\cos(\\delta) + \\sin(\\omega t)\\sin(\\delta))\n$$\n通过比较我们两个响应表达式中 $\\cos(\\omega t)$ 和 $\\sin(\\omega t)$ 的系数，我们得到一个包含两个方程的方程组：\n$$\nA_0 \\cos(\\delta) = F_0 \\chi'_{AB}(\\omega)\n$$\n$$\nA_0 \\sin(\\delta) = F_0 \\chi''_{AB}(\\omega)\n$$\n为了求 $A_0$，我们将两个方程平方后相加：\n$$\nA_0^2 (\\cos^2(\\delta) + \\sin^2(\\delta)) = F_0^2 [(\\chi'_{AB}(\\omega))^2 + (\\chi''_{AB}(\\omega))^2]\n$$\n$$\nA_0^2 = F_0^2 |\\chi_{AB}(\\omega)|^2 \\implies A_0 = F_0 \\sqrt{(\\chi'_{AB}(\\omega))^2 + (\\chi''_{AB}(\\omega))^2}\n$$\n为了求相位延迟 $\\delta$，我们将第二个方程除以第一个方程：\n$$\n\\tan(\\delta) = \\frac{\\chi''_{AB}(\\omega)}{\\chi'_{AB}(\\omega)} \\implies \\delta = \\arctan\\left(\\frac{\\chi''_{AB}(\\omega)}{\\chi'_{AB}(\\omega)}\\right)\n$$\n\n第2部分：每个周期耗散的平均能量 $W_{\\text{diss}}$ 的计算。\n\n由外场传递给系统的瞬时功率 $P(t)$ 由完整哈密顿量 $H(t) = H_0 + H'(t)$ 对时间偏导数的期望值给出。由于 $H_0$ 不随时间变化，因此：\n$$\nP(t) = \\left\\langle \\frac{\\partial H(t)}{\\partial t} \\right\\rangle = \\left\\langle \\frac{\\partial H'(t)}{\\partial t} \\right\\rangle\n$$\n微扰为 $H'(t) = -F(t) B$。其时间导数为：\n$$\n\\frac{\\partial H'(t)}{\\partial t} = -\\frac{dF(t)}{dt} B\n$$\n给定 $F(t) = F_0 \\cos(\\omega t)$，我们有 $\\frac{dF(t)}{dt} = -F_0 \\omega \\sin(\\omega t)$。因此，功率为：\n$$\nP(t) = \\langle (F_0 \\omega \\sin(\\omega t)) B \\rangle = F_0 \\omega \\sin(\\omega t) \\langle B(t) \\rangle_{\\text{ss}}\n$$\n我们将第1部分的结果应用于可观测量 $B$（即 $A=B$）：\n$$\n\\langle B(t) \\rangle_{\\text{ss}} = F_0 [\\chi'_{BB}(\\omega)\\cos(\\omega t) + \\chi''_{BB}(\\omega)\\sin(\\omega t)]\n$$\n将此代入功率的表达式中：\n$$\nP(t) = F_0 \\omega \\sin(\\omega t) \\left( F_0 [\\chi'_{BB}(\\omega)\\cos(\\omega t) + \\chi''_{BB}(\\omega)\\sin(\\omega t)] \\right)\n$$\n$$\nP(t) = F_0^2 \\omega [\\chi'_{BB}(\\omega)\\sin(\\omega t)\\cos(\\omega t) + \\chi''_{BB}(\\omega)\\sin^2(\\omega t)]\n$$\n耗散的平均功率 $P_{\\text{avg}}$ 是 $P(t)$ 在一个持续时间为 $T = 2\\pi/\\omega$ 的周期内的时间平均值：\n$$\nP_{\\text{avg}} = \\frac{1}{T} \\int_0^T P(t) dt\n$$\n我们需要三角函数项在一个周期内的时间平均值。$\\sin(\\omega t)\\cos(\\omega t) = \\frac{1}{2}\\sin(2\\omega t)$ 的平均值为 $0$。$\\sin^2(\\omega t) = \\frac{1}{2}(1-\\cos(2\\omega t))$ 的平均值为 $\\frac{1}{2}$。\n因此，平均功率为：\n$$\nP_{\\text{avg}} = F_0^2 \\omega \\left[\\chi'_{BB}(\\omega) \\cdot 0 + \\chi''_{BB}(\\omega) \\cdot \\frac{1}{2}\\right] = \\frac{1}{2} F_0^2 \\omega \\chi''_{BB}(\\omega)\n$$\n每个周期耗散的总能量 $W_{\\text{diss}}$ 是平均功率乘以一个周期的持续时间：\n$$\nW_{\\text{diss}} = P_{\\text{avg}} \\cdot T = \\left(\\frac{1}{2} F_0^2 \\omega \\chi''_{BB}(\\omega)\\right) \\left(\\frac{2\\pi}{\\omega}\\right) = \\pi F_0^2 \\chi''_{BB}(\\omega)\n$$\n这个结果表明，能量耗散与极化率的虚部 $\\chi''_{BB}(\\omega)$ 成正比，这是涨落-耗散定理的一个核心结果。\n\n$A_0$、$ \\delta$ 和 $W_{\\text{diss}}$ 的最终结果汇总如下。", "answer": "$$\\boxed{\\begin{pmatrix} F_{0} \\sqrt{(\\chi'_{AB}(\\omega))^{2} + (\\chi''_{AB}(\\omega))^{2}}  \\arctan\\left(\\frac{\\chi''_{AB}(\\omega)}{\\chi'_{AB}(\\omega)}\\right)  \\pi F_{0}^{2} \\chi''_{BB}(\\omega) \\end{pmatrix}}$$", "id": "2682777"}, {"introduction": "在线性响应的一般性原理之上，本练习将该理论形式应用于阻尼谐振子——一个在物理学和化学中无处不在的模型。通过推导位置自相关函数及其谱密度，我们将明确地看到像阻尼系数 $\\gamma$ 这样的微观参数是如何决定宏观谱线形状的。这个练习在微观运动方程和可观测光谱之间建立了具体的联系，展示了涨落-耗散定理的威力 [@problem_id:2682778]。", "problem": "一个质量为 $m$ 的经典粒子在一维谐振势中运动，其固有角频率为 $\\,\\omega_{0}\\,$，并在温度为 $\\,T\\,$ 时处于正则系综平衡。哈密顿量为 $\\,H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}\\,$。定义位置自相关函数 $\\,C_{xx}(t)=\\langle x(t)\\,x(0)\\rangle_{\\mathrm{eq}}\\,$ 及其对应的谱密度为傅里叶变换 (FT) $\\,S_{xx}(\\omega)=\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t)\\,$。\n\n仅使用基本动力学方程和正则系综平衡平均，完成以下任务：\n\n1) 推导无阻尼振子的 $\\,C_{xx}(t)\\,$，并用 $\\,\\langle x^{2}\\rangle_{\\mathrm{eq}}\\,$ 和 $\\,\\omega_{0}\\,$ 表示。然后，利用能量均分定理，将 $\\,\\langle x^{2}\\rangle_{\\mathrm{eq}}\\,$ 用 $\\,k_{B}\\,,\\,T\\,,\\,m\\,$ 和 $\\,\\omega_{0}\\,$ 表示。\n\n2) 使用上述傅里叶变换约定计算无阻尼振子的 $\\,S_{xx}(\\omega)\\,$，并评论其在频率上的支撑集。\n\n3) 现在将该振子线性耦合到一个在经典极限下产生粘性阻尼和涨落的热浴中。从受驱方程 $\\,m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)\\,$ 出发，其中 $\\,\\gamma0\\,$ 是摩擦系数，$\\,f(t)\\,$ 是一个弱的外部广义力。在线性响应理论框架内，确定由 $\\,x(\\omega)=\\chi(\\omega)\\,f(\\omega)\\,$ 定义的动力学磁化率 $\\,\\chi(\\omega)\\,$。然后，援引一个连接 $\\,S_{xx}(\\omega)\\,$ 和 $\\,\\chi(\\omega)\\,$ 的合适的经典涨落-耗散关系，根据所述的傅里叶变换约定，推导阻尼谱密度 $\\,S_{xx}(\\omega)\\,$ 的一个闭合形式表达式，用 $\\,m\\,,\\,\\gamma\\,,\\,\\omega_{0}\\,,\\,\\omega\\,,\\,k_{B}\\,$ 和 $\\,T\\,$ 表示。\n\n4) 根据推导出的 $\\,S_{xx}(\\omega)\\,$, 简要解释增加 $\\,\\gamma\\,$ 如何改变 $\\,\\pm\\omega_{0}\\,$ 附近的线形。\n\n答案规格：将第3部分中获得的阻尼谱密度 $\\,S_{xx}(\\omega)\\,$ 作为单个闭合形式的解析表达式提供，用 $\\,m\\,,\\,\\gamma\\,,\\,\\omega_{0}\\,,\\,\\omega\\,,\\,k_{B}\\,$ 和 $\\,T\\,$ 表示。最终的方框表达式中不要包含任何单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 系统：一维空间中一个质量为 $m$ 的经典粒子。\n- 势：固有角频率为 $\\omega_{0}$ 的谐振势。\n- 平衡：温度为 $T$ 的正则系综平衡。\n- 哈密顿量：$H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}$。\n- 位置自相关函数：$C_{xx}(t)=\\langle x(t)\\,x(0)\\rangle_{\\mathrm{eq}}$。\n- 谱密度：$S_{xx}(\\omega)=\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t)$。\n- 阻尼动力学：$m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)$，其中 $\\gamma>0$ 是摩擦系数，而 $f(t)$ 是一个弱的外部广义力。\n- 动力学磁化率：由 $x(\\omega)=\\chi(\\omega)\\,f(\\omega)$ 定义的 $\\chi(\\omega)$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础**：该问题描述了经典谐振子，包括无阻尼和阻尼（如朗之万方程所述）两种情况，这是物理学和物理化学中的一个基本模型。时间相关函数、谱密度、线性响应理论和涨落-耗散定理等概念都是统计力学中标准的、成熟的原理。该问题在科学上是合理的。\n- **适定性**：该问题被构造为一系列逻辑上相互关联的任务，为所有量提供了清晰的定义，并指明了所需的方法（例如，使用基本方程、能量均分定理、线性响应理论）。上下文定义清晰。\n- **客观性**：该问题以精确、客观、技术性的语言陈述，没有任何主观性或歧义。\n\n**第3步：结论与行动**\n该问题在科学上是合理的、适定的、客观的且自洽的。这是统计力学中的一个标准练习。因此，该问题是**有效的**。将提供解答。\n\n根据问题陈述的要求，解答分四部分推导。\n\n**第1部分：无阻尼振子的自相关函数**\n\n对于无阻尼振子，哈密顿量为 $H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}$。哈密顿运动方程为：\n$\\dot{x} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}$\n$\\dot{p} = -\\frac{\\partial H}{\\partial x} = -m\\omega_{0}^{2}x$\n\n结合这些方程，得到关于位置的二阶微分方程：\n$\\ddot{x} = \\frac{\\dot{p}}{m} = -\\omega_{0}^{2}x \\implies \\ddot{x}(t) + \\omega_{0}^{2}x(t) = 0$\n位置 $x(t)$ 的通解通过指定初始条件 $x(0)$ 和 $p(0)$ 给出：\n$x(t) = x(0)\\cos(\\omega_{0}t) + \\frac{p(0)}{m\\omega_{0}}\\sin(\\omega_{0}t)$\n\n位置自相关函数 $C_{xx}(t)$ 定义为正则系综平衡平均 $C_{xx}(t) = \\langle x(t)x(0) \\rangle_{\\mathrm{eq}}$。代入 $x(t)$ 的表达式：\n$C_{xx}(t) = \\left\\langle \\left(x(0)\\cos(\\omega_{0}t) + \\frac{p(0)}{m\\omega_{0}}\\sin(\\omega_{0}t)\\right) x(0) \\right\\rangle_{\\mathrm{eq}}$\n$C_{xx}(t) = \\cos(\\omega_{0}t)\\langle x(0)^{2} \\rangle_{\\mathrm{eq}} + \\frac{\\sin(\\omega_{0}t)}{m\\omega_{0}}\\langle x(0)p(0) \\rangle_{\\mathrm{eq}}$\n\n任何可观测量 $A$ 的正则系综平均由 $\\langle A \\rangle = \\frac{\\int \\!dx \\int \\!dp \\, A(x,p) \\exp(-\\beta H(x,p))}{\\int \\!dx \\int \\!dp \\, \\exp(-\\beta H(x,p))}$ 给出，其中 $\\beta = (k_{B}T)^{-1}$。\n平均值 $\\langle x(0)p(0) \\rangle_{\\mathrm{eq}}$ 为零，因为被积函数 $xp\\exp(-\\beta H)$ 是关于 $p$（和 $x$）的奇函数，且积分在对称区间 $(-\\infty, \\infty)$ 上进行。\n因此，自相关函数简化为：\n$C_{xx}(t) = \\langle x^{2} \\rangle_{\\mathrm{eq}} \\cos(\\omega_{0}t)$\n\n接下来，我们应用经典能量均分定理。对于哈密顿量中任何以二次方形式出现的自由度，与该自由度相关的平均能量为 $\\frac{1}{2}k_{B}T$。势能项是 $\\frac{1}{2}m\\omega_{0}^{2}x^{2}$。因此：\n$\\left\\langle \\frac{1}{2}m\\omega_{0}^{2}x^{2} \\right\\rangle_{\\mathrm{eq}} = \\frac{1}{2}k_{B}T$\n这意味着 $\\frac{1}{2}m\\omega_{0}^{2}\\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{1}{2}k_{B}T$，从而得到：\n$\\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{k_{B}T}{m\\omega_{0}^{2}}$\n\n**第2部分：无阻尼振子的谱密度**\n\n谱密度 $S_{xx}(\\omega)$ 是 $C_{xx}(t)$ 的傅里叶变换：\n$S_{xx}(\\omega) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\left(\\frac{k_{B}T}{m\\omega_{0}^{2}}\\cos(\\omega_{0}t)\\right)$\n\n使用余弦的欧拉恒等式 $\\cos(\\theta) = \\frac{1}{2}(\\exp(i\\theta) + \\exp(-i\\theta))$：\n$S_{xx}(\\omega) = \\frac{k_{B}T}{m\\omega_{0}^{2}} \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\left(\\frac{\\exp(i\\omega_{0}t) + \\exp(-i\\omega_{0}t)}{2}\\right)$\n$S_{xx}(\\omega) = \\frac{k_{B}T}{2m\\omega_{0}^{2}} \\left( \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i(\\omega+\\omega_{0})t) + \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i(\\omega-\\omega_{0})t) \\right)$\n\n使用狄拉克δ函数的积分表示 $\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(iky) = 2\\pi\\delta(k)$：\n$S_{xx}(\\omega) = \\frac{k_{B}T}{2m\\omega_{0}^{2}} \\left( 2\\pi\\delta(\\omega+\\omega_{0}) + 2\\pi\\delta(\\omega-\\omega_{0}) \\right)$\n$S_{xx}(\\omega) = \\frac{\\pi k_{B}T}{m\\omega_{0}^{2}} \\left( \\delta(\\omega-\\omega_{0}) + \\delta(\\omega+\\omega_{0}) \\right)$\n\n无阻尼振子谱密度的支撑集精确地集中在两个频率上，即 $\\omega = \\pm \\omega_{0}$。这表明系统的涨落只包含其固有的振荡频率。\n\n**第3部分：阻尼振子的谱密度**\n\n我们从阻尼振子的受驱运动方程开始：\n$m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)$\n\n为确定磁化率 $\\chi(\\omega)$，我们对该方程进行傅里叶变换。使用约定 $g(\\omega) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,g(t)$，导数的变换为 $\\mathcal{F}[\\dot{g}(t)] = -i\\omega g(\\omega)$ 和 $\\mathcal{F}[\\ddot{g}(t)] = (-i\\omega)^{2} g(\\omega) = -\\omega^{2}g(\\omega)$。将此应用于运动方程：\n$m(-\\omega^{2})x(\\omega) + m\\gamma(-i\\omega)x(\\omega) + m\\omega_{0}^{2}x(\\omega) = f(\\omega)$\n\n提出因子 $x(\\omega)$：\n$x(\\omega)\\left[ m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega \\right] = f(\\omega)$\n\n因此，动力学磁化率 $\\chi(\\omega) = x(\\omega)/f(\\omega)$ 为：\n$\\chi(\\omega) = \\frac{1}{m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega}$\n\n经典涨落-耗散定理 (FDT) 将平衡涨落的谱密度 $S_{xx}(\\omega)$ 与动力学磁化率 $\\chi(\\omega)$ 的虚部联系起来。对于指定的傅里叶变换约定，该关系为：\n$S_{xx}(\\omega) = -\\frac{2k_{B}T}{\\omega}\\operatorname{Im}[\\chi(\\omega)]$\n\n我们必须计算 $\\chi(\\omega)$ 的虚部：\n$\\chi(\\omega) = \\frac{1}{m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega} \\times \\frac{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}$\n$\\chi(\\omega) = \\frac{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}{[m(\\omega_{0}^{2}-\\omega^{2})]^{2} + (m\\gamma\\omega)^{2}}$\n$\\operatorname{Im}[\\chi(\\omega)] = \\frac{m\\gamma\\omega}{m^{2}[(\\omega_{0}^{2}-\\omega^{2})^{2} + (\\gamma\\omega)^{2}]} = \\frac{\\gamma\\omega}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]}$\n\n将此代入 FDT：\n$S_{xx}(\\omega) = -\\frac{2k_{B}T}{\\omega} \\left( \\frac{-\\gamma\\omega}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]} \\right)$\n$S_{xx}(\\omega) = \\frac{2k_{B}T\\gamma}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]}$\n这就是阻尼谱密度的闭合形式表达式。\n\n**第4部分：阻尼对线形的影响**\n\n推导出的谱密度 $S_{xx}(\\omega)$ 是一个关于 $\\omega$ 的类洛伦兹函数。分母 $(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}$ 决定了其形状。在弱阻尼情况下（$\\gamma \\ll \\omega_{0}$），该函数在 $\\omega = \\pm\\omega_{0}$ 附近有尖锐的峰。\n在共振点附近，$\\omega \\approx \\omega_{0}$，我们可以近似为 $\\omega_{0}^{2}-\\omega^{2} = (\\omega_{0}-\\omega)(\\omega_{0}+\\omega) \\approx 2\\omega_{0}(\\omega_{0}-\\omega)$。谱密度变为：\n$S_{xx}(\\omega) \\approx \\frac{2k_{B}T\\gamma}{m[4\\omega_{0}^{2}(\\omega_{0}-\\omega)^{2} + \\gamma^{2}\\omega_{0}^{2}]}$\n\n这个洛伦兹峰的半高全宽 (FWHM) 近似为 $\\gamma$。因此，增加摩擦系数 $\\gamma$ 会导致 $\\pm\\omega_{0}$ 附近谱线的展宽。这被称为阻尼展宽或碰撞展宽。同时，峰高 $S_{xx}(\\omega_{0}) = \\frac{2k_{B}T}{m\\gamma\\omega_{0}^{2}}$ 与 $\\gamma$ 成反比。因此，随着 $\\gamma$ 的增加，谱线变得更宽更矮，而总积分强度 $2\\pi C_{xx}(0) = \\frac{2\\pi k_{B}T}{m\\omega_{0}^{2}}$ 保持不变，且与 $\\gamma$ 无关。", "answer": "$$\\boxed{\\frac{2k_{B}T\\gamma}{m\\left[(\\omega_{0}^{2}-\\omega^{2})^{2} + (\\gamma\\omega)^{2}\\right]}}$$", "id": "2682778"}, {"introduction": "理论推导至关重要，但我们如何从真实或模拟数据中获得相关函数呢？这个计算练习旨在弥合理论与实践之间的鸿沟。您将实现一个算法，从有限的时间序列（例如分子动力学模拟的输出）中计算离散时间相关函数，并探讨实际问题，如统计噪声和减去平均值的影响 [@problem_id:2682797]。", "problem": "要求您设计并实现一个程序，用于从均匀采样序列中计算离散时间相关函数，并适用于线性响应计算。请从可观测量 $A$ 和 $B$ 之间的稳态双时相关函数的基本系综定义出发，即系综平均 $\\langle A(0) B(t) \\rangle$，并利用各态历经假设，该假设为使用单条足够长的轨迹上的时间平均来近似系综平均提供了理论依据。在构建估计量和进行分析时，请遵循以下原则，不要在问题陈述中写下任何简化的最终公式：使用均匀采样间隔 $\\Delta t$，使用由延迟 $k$ 分隔的重叠对来形成时间平均，并除以重叠对的数量。讨论减去样本均值如何影响估计结果，以及重叠乘积的数量如何影响估计量随延迟变化的变异性。通过涨落-耗散定理（FDT）将自相关函数的积分与线性响应联系起来，并指出输运系数或响应系数可以通过对自相关函数进行时间积分得到。\n\n您的程序必须精确执行以下任务。\n\n1) 实现一个函数，该函数接收两个实数序列 $A_0,\\dots,A_{N-1}$ 和 $B_0,\\dots,B_{N-1}$、一个满足 $0 \\le k \\le N-1$ 的非负整数延迟 $k$ 以及一个指示是否减去样本均值的布尔标志，返回在所有重叠索引对上计算的延迟 $k$ 处的离散时间平均相关。如果要求中心化，则在形成乘积之前减去完整序列的样本均值。使用等于重叠对数量的除数，即 $N-k$。\n\n2) 实现一个函数，该函数针对单个实数序列 $A_0,\\dots,A_{N-1}$，使用上述估计量计算延迟 $k=0,1,\\dots,N-1$ 的完整自相关序列（不减去均值），并返回离散时间积分 $\\Delta t \\sum_{k=0}^{N-1} C_{AA}(k \\Delta t)$。\n\n3) 所有角度均使用弧度。输出不需要物理单位；所有数值输出均报告为标准十进制浮点数。\n\n测试套件。对于下面的每个参数集，按指定顺序计算指定的输出，并按照最终输出格式的描述将所有结果聚合到一个列表中。\n\n- 案例 $1$ (正常路径；几何衰减与 Green-Kubo 型离散积分):\n  - 参数: $N=10$, $\\Delta t=0.1$, 定义 $r=0.8$, 并设置 $A_n = r^n$ 和 $B_n = A_n$ 对于 $n=0,\\dots,9$。\n  - 要求输出，按顺序:\n    - 不减去均值计算的延迟 $k=0$、$k=1$ 和 $k=3$ 时的相关性。\n    - 不减去均值计算的离散时间积分 $\\Delta t \\sum_{k=0}^{N-1} C_{AA}(k \\Delta t)$。\n\n- 案例 $2$ (振荡信号；包含一个边界延迟以说明高方差区域):\n  - 参数: $N=12$, $\\Delta t=0.1$, 定义频率 $f=1.25$、角频率 $\\omega = 2\\pi f$, 并设置 $A_n = \\cos(\\omega n \\Delta t)$ 和 $B_n = A_n$ 对于 $n=0,\\dots,11$；角度单位为弧度。\n  - 要求输出，按顺序:\n    - 不减去均值计算的延迟 $k=0$ 时的相关性。\n    - 不减去均值计算的延迟 $k=11$ 时的相关性。\n\n- 案例 $3$ (带均值偏移的交替信号；比较朴素估计和均值中心化估计):\n  - 参数: $N=9$, 定义 $A_n = (-1)^n + 0.5$ 和 $B_n = (-1)^{n+1} + 0.5$ 对于 $n=0,\\dots,8$。\n  - 要求输出，按顺序:\n    - 不减去均值计算的延迟 $k=0$ 时的相关性。\n    - 减去样本均值计算的延迟 $k=0$ 时的相关性。\n    - 不减去均值计算的延迟 $k=1$ 时的相关性。\n    - 减去样本均值计算的延迟 $k=1$ 时的相关性。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，并严格按照以下聚合所有案例的顺序：\n- 案例 1: $C_{AA}(0)$、$C_{AA}(1)$、$C_{AA}(3)$，然后是离散积分。\n- 案例 2: $C_{AA}(0)$、$C_{AA}(11)$。\n- 案例 3: $C_{AB}(0)$ 朴素值、$C_{AB}(0)$ 中心化值、$C_{AB}(1)$ 朴素值、$C_{AB}(1)$ 中心化值。\n\n不应打印任何其他文本。", "solution": "问题陈述具有科学依据、形式适定且客观。它基于统计力学的既定原理，提出了一个计算物理化学领域的明确任务。构建数值解所需的所有必要参数和定义均已提供。因此，该问题是有效的，并将提供一个解决方案。\n\n该问题的基础是时间相关函数理论，它是统计力学中描述热平衡系统中涨落动力学的核心工具。对于由涨落变量 $A(t)$ 和 $B(t)$ 表示的两个宏观可观测量，它们的双时相关函数定义为系综平均，用尖括号 $\\langle \\dots \\rangle$ 表示。假设系统处于稳态，则相关函数仅取决于时间差 $t$ 而非绝对时间 $t'$。因此，我们可以将其写为：\n$$\nC_{AB}(t) = \\langle A(0) B(t) \\rangle\n$$\n各态历经假说假定，对于一个处于平衡态的系统，对全同系统系综的平均可以由单个系统的一条足够长的轨迹上的时间平均所取代。这是一个实用而强大的假设，它允许我们（例如）从分子动力学模拟轨迹中计算这些函数。时间平均表示为一个积分：\n$$\n\\langle A(0) B(t) \\rangle = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T A(t') B(t' + t) dt'\n$$\n在实践中，我们处理的是以均匀间隔 $\\Delta t$ 采样的离散数据。我们得到有限的观测序列 $A_n = A(n\\Delta t)$ 和 $B_n = B(n\\Delta t)$，其中 $n = 0, 1, \\dots, N-1$。在时间延迟 $t = k\\Delta t$（其中 $k$ 是非负整数）处的相关函数 $C_{AB}(t)$ 的离散估计量可以通过用求和代替积分来构建。根据问题规范，我们对所有由 $k$ 步延迟隔开的可用重叠数据点对进行求和：\n$$\n\\hat{C}_{AB}(k) = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} A_n B_{n+k}\n$$\n这个公式定义了延迟 $k$ 处相关的估计量。求和中的项数恰好是 $N-k$，它被用作归一化因子。选择这个依赖于延迟的除数 $N-k$，在 $A$ 和 $B$ 的均值为零的情况下，可以提供协方差的无偏估计，但其后果是估计量的统计方差会随着延迟 $k$ 的增加而增加。对于小延迟，$k \\ll N$，我们对许多乘积进行平均，从而得到一个统计上稳健的估计。然而，当 $k$ 接近 $N-1$ 时，乘积的数量会减少。在极端延迟 $k=N-1$ 时，求和中只包含一项 $A_0 B_{N-1}$，此时的估计 $\\hat{C}_{AB}(N-1) = A_0 B_{N-1}$ 噪声极大，它反映的是两个特定点的行为，而不是统计平均。\n\n可观测量的均值起着关键作用。如果可观测量具有非零的真实均值 $\\langle A \\rangle$ 和 $\\langle B \\rangle$，则相关函数会包含一个恒定偏移：$\\langle A(0) B(t) \\rangle = \\langle \\delta A(0) \\delta B(t) \\rangle + \\langle A \\rangle \\langle B \\rangle$，其中 $\\delta A(t) = A(t) - \\langle A \\rangle$ 是围绕均值的涨落。许多物理性质，特别是输运系数，都与这些涨落的相关性有关。为了从有限序列中估计涨落相关函数 $\\langle \\delta A(0) \\delta B(t) \\rangle$，我们首先移除样本均值。样本均值计算如下：$\\bar{A} = \\frac{1}{N}\\sum_{n=0}^{N-1} A_n$ 和 $\\bar{B} = \\frac{1}{N}\\sum_{n=0}^{N-1} B_n$。然后，均值中心化相关估计量为：\n$$\n\\hat{C}'_{AB}(k) = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} (A_n - \\bar{A})(B_{n+k} - \\bar{B})\n$$\n减去样本均值可以将涨落的动力学从数据中任何静态的、非零的偏移中分离出来，这在问题的案例3中得到了展示。\n\n与线性响应理论和输运系数的联系由涨落-耗散定理（FDT）正式确立。其中的一个关键实例是 Green-Kubo 关系，它指出输运系数（如扩散系数、粘度或热导率）与某个适当的平衡自相关函数的时间积分成正比。例如，一个 $d$ 维系统中的自扩散系数 $D$ 由速度自相关函数的积分给出：\n$$\nD = \\frac{1}{d} \\int_0^\\infty \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle dt\n$$\n问题要求计算一个通用自相关函数 $C_{AA}(k\\Delta t) = \\hat{C}_{AA}(k)$ 的该积分的离散时间近似。使用简单的矩形法则进行数值积分，这个“Green-Kubo 型”积分计算如下：\n$$\nI_{GK} \\approx \\Delta t \\sum_{k=0}^{N-1} C_{AA}(k\\Delta t)\n$$\n这个求和捕捉了涨落的总记忆或持续性。一个快速衰减到零的函数将有一个小的积分值，对应于相关的快速喪失和快速的弛豫过程。\n\n具体实现将包括一个用于计算特定延迟 $k$ 处相关性的主函数，并带有均值中心化的选项。第二个函数将利用第一个函数来计算 $k \\in [0, N-1]$ 的整个自相关序列，然后计算其离散时间积分。这些函数将被应用于指定的测试用例。", "answer": "[0.2745751939433398,0.24246594911197762,0.1939828453472288,0.4998784300393284,0.5,-0.7071067811865475,-0.75,-0.9876543209876543,1.25,0.9876543209876543]", "id": "2682797"}]}