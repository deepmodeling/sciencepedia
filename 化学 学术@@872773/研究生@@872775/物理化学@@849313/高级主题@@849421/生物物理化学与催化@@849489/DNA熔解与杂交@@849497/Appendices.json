{"hands_on_practices": [{"introduction": "范特霍夫（van't Hoff）分析是根据平衡常数随温度的变化来确定解离反应（如DNA熔解）的标准焓变（$\\Delta H^\\circ$）和熵变（$\\Delta S^\\circ$）的核心方法。然而，真实的实验数据总是带有不确定性，且这些不确定性在不同温度下往往并不相同。本练习将指导您实现一个加权线性回归方案，这是从有噪声的异方差实验数据中精确提取热力学参数的统计学标准方法。[@problem_id:2634890]", "problem": "一种脱氧核糖核酸（DNA）寡核苷酸溶液在恒定压力下经历双链到单链的两态解离过程，该解离反应的平衡常数定义为 $K(T)$。假设标准焓变 $\\Delta H^\\circ$ 和标准熵变 $\\Delta S^\\circ$ 在实验温度范围内不随温度变化，则 van’t Hoff 关系将平衡常数与温度联系起来。从标准吉布斯自由能 $\\Delta G^\\circ(T)$ 和平衡常数 $K(T)$ 的基本定义出发，即 $\\Delta G^\\circ(T) = \\Delta H^\\circ - T \\Delta S^\\circ$ 和 $\\Delta G^\\circ(T) = - R T \\ln K(T)$，其中 $R$ 是通用气体常数。推导 $\\ln K(T)$ 与 $1/T$ 之间的线性关系，该关系可用于从平衡数据中估计 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$。然后，在给定 $\\ln K(T)$ 存在异方差实验不确定度的情况下，设计一个基于统计学原理的加权线性回归，以得出参数估计值及其 $95\\%$ 置信区间。\n\n您的程序必须实现以下内容：\n\n1) 模型。使用线性模型 $y_i = a x_i + b + \\varepsilon_i$，其中 $y_i = \\ln K_i$，$x_i = 1/T_i$，权重 $w_i = 1/\\sigma_{y,i}^2$，而 $\\sigma_{y,i}$ 是报告的 $y_i$ 的标准差。用拟合的斜率 $a$、截距 $b$ 以及通用气体常数 $R$ 来表示 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$。使用 $R = 8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n2) 估计。通过最小化 $\\sum_i w_i (y_i - a x_i - b)^2$ 来计算加权最小二乘估计值 $\\hat{\\boldsymbol{\\beta}} = (\\hat{a}, \\hat{b})^\\top$。使用对角权重矩阵 $W = \\mathrm{diag}(w_i)$ 和设计矩阵 $X = [x_i\\ \\ 1]$，通过正规方程组 $(X^\\top W X)\\hat{\\boldsymbol{\\beta}} = X^\\top W \\mathbf{y}$ 求解。\n\n3) 不确定性量化。设 $n$ 为数据点数，$p=2$ 为模型参数个数。计算加权残差平方和 $\\mathrm{WRSS} = \\sum_i w_i r_i^2$，其中 $r_i = y_i - \\hat{a} x_i - \\hat{b}$。将残差方差尺度估计为 $s^2 = \\mathrm{WRSS}/(n - p)$。计算 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵为 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = s^2 (X^\\top W X)^{-1}$。使用 $\\Delta H^\\circ = - R \\hat{a}$ 和 $\\Delta S^\\circ = R \\hat{b}$ 将不确定性传播到 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$，因此有 $\\mathrm{Var}(\\Delta H^\\circ) = R^2 \\mathrm{Var}(\\hat{a})$ 和 $\\mathrm{Var}(\\Delta S^\\circ) = R^2 \\mathrm{Var}(\\hat{b})$。使用自由度为 $\\nu = n - p$ 的 Student t分布分位数 $t_{0.975,\\ \\nu}$ 构建双侧 $95\\%$ 置信区间。\n\n4) 单位和输出。报告 $\\Delta H^\\circ$ 的单位为 $\\mathrm{kJ\\ mol^{-1}}$，$\\Delta S^\\circ$ 的单位为 $\\mathrm{J\\ mol^{-1}\\ K^{-1}}$。将所有报告的数字四舍五入到恰好三位小数。\n\n测试套件。您的程序必须在以下三个独立的数据集上运行。每个数据集提供以 $\\mathrm{K}$ 为单位的绝对温度 $T$、平衡常数 $K$ 和 $\\ln K$ 的标准差（即 $\\sigma_{y} = \\sigma_{\\ln K}$）。对每个数据集执行上述分析。\n\n- 数据集 A：\n  - $T\\ \\mathrm{(K)}$: $[300.0,\\ 310.0,\\ 320.0,\\ 330.0,\\ 340.0]$\n  - $K$: $[0.000363,\\ 0.00417,\\ 0.0522,\\ 0.470,\\ 4.264]$\n  - $\\sigma_{\\ln K}$: $[0.05,\\ 0.04,\\ 0.03,\\ 0.04,\\ 0.05]$\n\n- 数据集 B：\n  - $T\\ \\mathrm{(K)}$: $[315.0,\\ 320.0,\\ 325.0,\\ 330.0,\\ 335.0]$\n  - $K$: $[0.0316,\\ 0.0957,\\ 0.2326,\\ 0.526,\\ 1.507]$\n  - $\\sigma_{\\ln K}$: $[0.08,\\ 0.06,\\ 0.04,\\ 0.06,\\ 0.08]$\n\n- 数据集 C：\n  - $T\\ \\mathrm{(K)}$: $[320.0,\\ 330.0,\\ 340.0]$\n  - $K$: $[0.0640,\\ 0.5355,\\ 3.762]$\n  - $\\sigma_{\\ln K}$: $[0.12,\\ 0.08,\\ 0.12]$\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素按 A、B、C 的顺序对应一个数据集，其本身是一个六个浮点数的列表，格式为 $[\\Delta H^\\circ_{\\mathrm{est}}\\ \\mathrm{(kJ/mol)},\\ \\Delta H^\\circ_{\\mathrm{low}}\\ \\mathrm{(kJ/mol)},\\ \\Delta H^\\circ_{\\mathrm{high}}\\ \\mathrm{(kJ/mol)},\\ \\Delta S^\\circ_{\\mathrm{est}}\\ \\mathrm{(J/mol/K)},\\ \\Delta S^\\circ_{\\mathrm{low}}\\ \\mathrm{(J/mol/K)},\\ \\Delta S^\\circ_{\\mathrm{high}}\\ \\mathrm{(J/mol/K)}]$。所有数字必须四舍五入到恰好三位小数。例如，一个包含三个数据集的有效总输出格式为 $[[h_1,\\ \\ell_1,\\ u_1,\\ s_1,\\ L_1,\\ U_1],[h_2,\\ \\ell_2,\\ u_2,\\ s_2,\\ L_2,\\ U_2],[h_3,\\ \\ell_3,\\ u_3,\\ s_3,\\ L_3,\\ U_3]]$，其中每个符号表示一个按指定单位和舍入规则的浮点数。此问题不涉及角度。百分比（若有）必须表示为小数，但此处不需要。", "solution": "所提出的问题具有科学依据，提法明确且客观。它概述了物理化学中一个标准流程，即使用 van't Hoff 方程和加权线性回归来分析 DNA 解链实验的热力学数据。所有必需的物理原理、数学公式、统计方法和数据都已提供，使得该问题能够得到完整解决。\n\n分析分两个阶段进行：热力学模型的构建及其统计估计。\n\n首先，我们推导 van't Hoff 分析的核心线性关系。对于一个反应，其标准吉布斯自由能变 $\\Delta G^\\circ(T)$ 与标准焓变 $\\Delta H^\\circ$ 和标准熵变 $\\Delta S^\\circ$ 通过以下基本热力学方程相关联：\n$$\n\\Delta G^\\circ(T) = \\Delta H^\\circ - T \\Delta S^\\circ\n$$\n其中 $T$ 是绝对温度。问题假设 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$ 在实验温度范围内是常数。标准吉布斯自由能还通过以下公式与反应的平衡常数 $K(T)$ 相关：\n$$\n\\Delta G^\\circ(T) = -R T \\ln K(T)\n$$\n其中 $R$ 是通用气体常数，给定值为 $8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n通过令这两个 $\\Delta G^\\circ(T)$ 的表达式相等，我们得到：\n$$\n-R T \\ln K(T) = \\Delta H^\\circ - T \\Delta S^\\circ\n$$\n为建立线性关系，我们将整个方程除以 $-R T$：\n$$\n\\ln K(T) = -\\frac{\\Delta H^\\circ}{R T} + \\frac{\\Delta S^\\circ}{R}\n$$\n该方程是直线形式 $y = ax + b$，其中：\n- 因变量为 $y = \\ln K(T)$。\n- 自变量为 $x = 1/T$。\n- 斜率为 $a = -\\frac{\\Delta H^\\circ}{R}$。\n- 截距为 $b = \\frac{\\Delta S^\\circ}{R}$。\n\n根据这些关系，可以从线性回归的估计斜率 $\\hat{a}$ 和截距 $\\hat{b}$ 确定热力学参数：\n$$\n\\Delta H^\\circ = -R \\hat{a}\n$$\n$$\n\\Delta S^\\circ = R \\hat{b}\n$$\n\n其次，我们使用加权最小二乘法 (WLS) 来解决参数 $\\hat{a}$ 和 $\\hat{b}$ 的统计估计问题，该方法适用于具有异方差不确定性的数据。对于一组 $n$ 个数据点 $(x_i, y_i)$，其中 $x_i = 1/T_i$，$y_i = \\ln K_i$，且 $y_i$ 值具有相应的不确定度 $\\sigma_{y,i}$，线性模型为：\n$$\ny_i = a x_i + b + \\varepsilon_i\n$$\n其中 $\\varepsilon_i$ 是误差项。在 WLS 中，我们最小化加权残差平方和 $\\chi^2 = \\sum_{i=1}^{n} w_i(y_i - (ax_i + b))^2$，其中权重为 $w_i = 1/\\sigma_{y,i}^2$。\n\n这个最小化问题可以使用矩阵代数高效求解。我们定义设计矩阵 $X$、观测向量 $\\mathbf{y}$、参数向量 $\\boldsymbol{\\beta}$ 和对角权重矩阵 $W$：\n$$\nX = \\begin{pmatrix} x_1  1 \\\\ x_2  1 \\\\ \\vdots  \\vdots \\\\ x_n  1 \\end{pmatrix}, \\quad\n\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}, \\quad\nW = \\begin{pmatrix} w_1  0  \\cdots  0 \\\\ 0  w_2  \\cdots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\cdots  w_n \\end{pmatrix}\n$$\nWLS 估计值 $\\hat{\\boldsymbol{\\beta}} = (\\hat{a}, \\hat{b})^\\top$ 通过求解正规方程组得到：\n$$\n(X^\\top W X)\\hat{\\boldsymbol{\\beta}} = X^\\top W \\mathbf{y}\n$$\n解为 $\\hat{\\boldsymbol{\\beta}} = (X^\\top W X)^{-1} X^\\top W \\mathbf{y}$。\n\n为了量化估计参数中的不确定性，我们首先计算加权残差平方和 (WRSS)：\n$$\n\\mathrm{WRSS} = \\sum_{i=1}^{n} w_i (y_i - (\\hat{a} x_i + \\hat{b}))^2\n$$\n残差方差尺度 $s^2$ 估计为 $s^2 = \\mathrm{WRSS} / (n - p)$，其中 $p=2$ 是模型中的参数数量。参数估计值 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵则由下式给出：\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = s^2 (X^\\top W X)^{-1} = \\begin{pmatrix} \\mathrm{Var}(\\hat{a})  \\mathrm{Cov}(\\hat{a}, \\hat{b}) \\\\ \\mathrm{Cov}(\\hat{a}, \\hat{b})  \\mathrm{Var}(\\hat{b}) \\end{pmatrix}\n$$\n热力学参数的方差通过误差传播获得：\n$$\n\\mathrm{Var}(\\Delta H^\\circ) = (-R)^2 \\mathrm{Var}(\\hat{a}) = R^2 \\mathrm{Var}(\\hat{a})\n$$\n$$\n\\mathrm{Var}(\\Delta S^\\circ) = R^2 \\mathrm{Var}(\\hat{b})\n$$\n标准误差是这些方差的平方根，例如 $\\mathrm{SE}(\\Delta H^\\circ) = \\sqrt{\\mathrm{Var}(\\Delta H^\\circ)}$。\n\n最后，使用 Student t分布构建双侧 $95\\%$ 置信区间 (CI)。估计值 $\\theta$ 的 CI 由 $\\hat{\\theta} \\pm t_{1-\\alpha/2, \\nu} \\cdot \\mathrm{SE}(\\hat{\\theta})$ 给出，其中 $\\alpha = 0.05$，自由度为 $\\nu = n-p$。因此，临界 t值为 $t_{0.975, n-2}$。置信区间为：\n$$\n\\mathrm{CI}(\\Delta H^\\circ) = \\Delta H^\\circ \\pm t_{0.975, n-2} \\cdot \\mathrm{SE}(\\Delta H^\\circ)\n$$\n$$\n\\mathrm{CI}(\\Delta S^\\circ) = \\Delta S^\\circ \\pm t_{0.975, n-2} \\cdot \\mathrm{SE}(\\Delta S^\\circ)\n$$\n$\\Delta H^\\circ$ 的估计值及其置信界限必须通过除以 1000 从 $\\mathrm{J\\ mol^{-1}}$ 转换为 $\\mathrm{kJ\\ mol^{-1}}$。所有最终结果将按要求四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print results.\n    \"\"\"\n    R_GAS_CONSTANT = 8.314  # J mol^-1 K^-1\n\n    test_cases = [\n        {\n            \"T_K\": np.array([300.0, 310.0, 320.0, 330.0, 340.0]),\n            \"K_eq\": np.array([0.000363, 0.00417, 0.0522, 0.470, 4.264]),\n            \"sigma_lnK\": np.array([0.05, 0.04, 0.03, 0.04, 0.05]),\n        },\n        {\n            \"T_K\": np.array([315.0, 320.0, 325.0, 330.0, 335.0]),\n            \"K_eq\": np.array([0.0316, 0.0957, 0.2326, 0.526, 1.507]),\n            \"sigma_lnK\": np.array([0.08, 0.06, 0.04, 0.06, 0.08]),\n        },\n        {\n            \"T_K\": np.array([320.0, 330.0, 340.0]),\n            \"K_eq\": np.array([0.0640, 0.5355, 3.762]),\n            \"sigma_lnK\": np.array([0.12, 0.08, 0.12]),\n        },\n    ]\n\n    def analyze_dataset(data):\n        \"\"\"\n        Performs weighted linear regression and uncertainty analysis for a single dataset.\n        \n        Args:\n            data (dict): A dictionary containing T, K, and sigma_lnK arrays.\n\n        Returns:\n            list: A list of 6 floats representing the estimated values and confidence intervals for\n                  Delta H and Delta S, rounded to three decimal places.\n        \"\"\"\n        T = data[\"T_K\"]\n        K = data[\"K_eq\"]\n        sigma_y = data[\"sigma_lnK\"]\n        \n        n = len(T)\n        p = 2  # Number of parameters (slope, intercept)\n        dof = n - p\n\n        # 1. Prepare variables for linear regression y = a*x + b\n        # y = ln(K), x = 1/T\n        y = np.log(K)\n        x = 1.0 / T\n        \n        # Weights for WLS\n        w = 1.0 / sigma_y**2\n        \n        # 2. Set up and solve the normal equations (X^T W X) beta = X^T W y\n        # Design matrix X\n        X = np.vstack((x, np.ones(n))).T\n        \n        # We can implement X^T W X directly using broadcasting\n        # W is diagonal, so (X^T W) is (X.T * w)\n        XtW = X.T * w\n        XtWX = XtW @ X\n        XtWy = XtW @ y\n        \n        # Solve for beta = [a, b]\n        beta_hat = np.linalg.solve(XtWX, XtWy)\n        a_hat, b_hat = beta_hat\n        \n        # 3. Calculate thermodynamic parameters\n        delta_H_est = -R_GAS_CONSTANT * a_hat  # in J/mol\n        delta_S_est = R_GAS_CONSTANT * b_hat   # in J/mol/K\n        \n        # 4. Uncertainty Quantification\n        # Residuals\n        residuals = y - (X @ beta_hat)\n        \n        # Weighted residual sum of squares (WRSS)\n        wrss = np.sum(w * residuals**2)\n        \n        # Residual variance scale factor\n        s_squared = wrss / dof\n        \n        # Covariance matrix of parameters beta\n        cov_beta = s_squared * np.linalg.inv(XtWX)\n        var_a = cov_beta[0, 0]\n        var_b = cov_beta[1, 1]\n        \n        # Standard errors for thermodynamic parameters\n        se_delta_H = R_GAS_CONSTANT * np.sqrt(var_a)\n        se_delta_S = R_GAS_CONSTANT * np.sqrt(var_b)\n        \n        # 5. Confidence Intervals\n        # Critical t-value for 95% CI\n        t_crit = t.ppf(0.975, df=dof)\n        \n        # Margin of error\n        margin_H = t_crit * se_delta_H\n        margin_S = t_crit * se_delta_S\n        \n        # Confidence interval bounds\n        delta_H_low = delta_H_est - margin_H\n        delta_H_high = delta_H_est + margin_H\n        delta_S_low = delta_S_est - margin_S\n        delta_S_high = delta_S_est + margin_S\n        \n        # 6. Convert units and format output\n        # Convert delta H to kJ/mol\n        delta_H_est_kJ = delta_H_est / 1000.0\n        delta_H_low_kJ = delta_H_low / 1000.0\n        delta_H_high_kJ = delta_H_high / 1000.0\n        \n        return [\n            delta_H_est_kJ, delta_H_low_kJ, delta_H_high_kJ,\n            delta_S_est, delta_S_low, delta_S_high\n        ]\n\n    results_str_list = []\n    for case in test_cases:\n        result_values = analyze_dataset(case)\n        # Format each number to exactly three decimal places\n        formatted_str = \", \".join(f\"{v:.3f}\" for v in result_values)\n        results_str_list.append(f\"[{formatted_str}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```", "id": "2634890"}, {"introduction": "在更精确的热力学模型中，我们必须考虑反应物和产物之间热容的差异，即非零的标准热容变化（$\\Delta C_p$）。这使得$\\Delta H^\\circ$和$\\Delta S^\\circ$本身也依赖于温度，从而导致用于预测熔解温度（$T_m$）的方程变得更加复杂。本练习要求您推导并数值求解一个包含$\\Delta C_p$效应的隐式方程，以精确计算双分子DNA杂交的浓度依赖性$T_m$，这体现了从基础参数构建精确预测模型的过程。[@problem_id:2634863]", "problem": "一个双分子脱氧核糖核酸（DNA）双链体会根据可逆的解离反应解链，分解成两条互补的单链。考虑一个非自互补双链体的标准态解离反应 $AB \\rightarrow A + B$，并将解链温度 $T_m$ 定义为总链物质中有一半以双链体形式存在时的温度。假设产物和反应物之间的标准热容变 $\\Delta C_p$ 为一个与温度无关的常数。请从 (i) 标准吉布斯自由能恒等式 $\\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T \\Delta S^\\circ(T)$，(ii) 平衡常数的定义和质量作用定律，以及 (iii) 根据总链浓度 $C_T$ 和适用于半解离条件的化学计量因子定义的双分子反应解链条件出发，使用基本化学热力学，推导出一个隐式标量方程，该方程以温度为变量的根即为 $T_m$。使用参考温度 $T_{\\mathrm{ref}}$ 和温度无关的 $\\Delta C_p$ 的假设来表示结果，不要引入任何额外的近似。\n\n然后，开发一个稳健的数值求根方案，从推导出的隐式方程计算 $T_m$。您的数值设计必须具有通用性和可靠性：指定要归零的未知温度函数，包括以 $\\Delta H^\\circ(T_{\\mathrm{ref}})$、$\\Delta S^\\circ(T_{\\mathrm{ref}})$ 和 $\\Delta C_p$ 表示的、依赖于温度的 $\\Delta H^\\circ(T)$ 和 $\\Delta S^\\circ(T)$ 的表达式，并概述一个带有后备方法的区间法策略，该策略对于物理上合理的输入将可靠地收敛。请仔细说明所有单位并保持单位一致性。\n\n最后，实现一个完整、可运行的程序，为以下测试组评估以开尔文为单位的 $T_m$。在每个测试中，将 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$ 解释为解离反应 $AB \\rightarrow A + B$ 的标准变化量，$C_T$ 为总链摩尔浓度，并使用国际单位制中的普适气体常数 $R$。使用化学计量因子 $s$ 来编码 $T_m$ 时的半解离条件，使得平衡条件取决于 $\\ln(C_T/s)$，其中对于非自互补双分子双链体 $s = 4$，对于完全自互补双链体 $s = 1$。\n\n- 测试用例 1（非自互补，非零热容变）：\n  - $\\Delta H^\\circ(T_{\\mathrm{ref}}) = 418000\\ \\mathrm{J\\,mol^{-1}}$\n  - $\\Delta S^\\circ(T_{\\mathrm{ref}}) = 1255\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $\\Delta C_p = 1500\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $C_T = 1.0\\times 10^{-6}\\ \\mathrm{mol\\,L^{-1}}$\n  - $s = 4$\n  - $T_{\\mathrm{ref}} = 310.15\\ \\mathrm{K}$\n- 测试用例 2（与 1 相同，但热容变为零）：\n  - $\\Delta H^\\circ(T_{\\mathrm{ref}}) = 418000\\ \\mathrm{J\\,mol^{-1}}$\n  - $\\Delta S^\\circ(T_{\\mathrm{ref}}) = 1255\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $\\Delta C_p = 0\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $C_T = 1.0\\times 10^{-6}\\ \\mathrm{mol\\,L^{-1}}$\n  - $s = 4$\n  - $T_{\\mathrm{ref}} = 310.15\\ \\mathrm{K}$\n- 测试用例 3（非自互补，非常稀，非零热容变）：\n  - $\\Delta H^\\circ(T_{\\mathrm{ref}}) = 418000\\ \\mathrm{J\\,mol^{-1}}$\n  - $\\Delta S^\\circ(T_{\\mathrm{ref}}) = 1255\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $\\Delta C_p = 1500\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $C_T = 1.0\\times 10^{-9}\\ \\mathrm{mol\\,L^{-1}}$\n  - $s = 4$\n  - $T_{\\mathrm{ref}} = 310.15\\ \\mathrm{K}$\n- 测试用例 4（自互补双链体，非零热容变）：\n  - $\\Delta H^\\circ(T_{\\mathrm{ref}}) = 250000\\ \\mathrm{J\\,mol^{-1}}$\n  - $\\Delta S^\\circ(T_{\\mathrm{ref}}) = 800\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $\\Delta C_p = 1000\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $C_T = 1.0\\times 10^{-5}\\ \\mathrm{mol\\,L^{-1}}$\n  - $s = 1$\n  - $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$\n\n物理和数值单位：\n- 使用 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 所有温度必须以 $\\mathrm{K}$ 为单位。\n- 所有能量必须以 $\\mathrm{J\\,mol^{-1}}$ 为单位，熵必须以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位。\n- 浓度必须以 $\\mathrm{mol\\,L^{-1}}$ 为单位。\n\n您的程序必须计算每个测试用例的 $T_m$（以 $\\mathrm{K}$ 为单位），并将它们打印为单行，其中包含一个小数点后六位的十进制数列表，格式为：$[t_1,t_2,t_3,t_4]$，其中每个 $t_i$ 是测试用例 $i$ 的 $T_m$（以 $\\mathrm{K}$ 为单位）。\n\n最终输出格式必须严格为单行，包含如上所述的方括号和逗号分隔的列表（例如，$[300.000000,301.234567, \\ldots]$），不得有任何附加文本。", "solution": "所述问题在科学上是合理的、提法得当的，并以客观的方式呈现。这是一个生物分子物理化学领域的标准问题，牢固地建立在化学热力学原理之上。它包含了进行严谨求解所需的所有信息。因此，该问题是有效的，我们将着手进行推导和实现。\n\n主要任务是推导DNA双链体解链温度 $T_m$ 的隐式方程，该温度定义为总链物质中有一半以双链体形式存在时的温度。推导将从基本热力学原理开始。\n\n1.  **基本热力学关系**\n反应的标准吉布斯自由能变 $\\Delta G^\\circ$ 与给定绝对温度 $T$ 下的平衡常数 $K$ 通过以下方程相关联：\n$$ \\Delta G^\\circ(T) = -RT \\ln K(T) $$\n这里，$R$ 是普适气体常数。对于解离反应 $AB \\rightleftharpoons A + B$，平衡常数由质量作用定律定义为 $K = \\frac{[A][B]}{[AB]}$，其中方括号表示摩尔浓度。\n\n2.  **热力学函数的温度依赖性**\n问题指定了反应的标准热容变 $\\Delta C_p$ 是一个非零常数。标准焓变 $\\Delta H^\\circ(T)$ 和标准熵变 $\\Delta S^\\circ(T)$ 的温度依赖性可以通过将基尔霍夫关系式从参考温度 $T_{\\mathrm{ref}}$ 积分到温度 $T$ 来确定：\n$$ \\Delta H^\\circ(T) = \\Delta H^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^T \\Delta C_p \\,dT' = \\Delta H^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p (T - T_{\\mathrm{ref}}) $$\n$$ \\Delta S^\\circ(T) = \\Delta S^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^T \\frac{\\Delta C_p}{T'} \\,dT' = \\Delta S^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p \\ln\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) $$\n将这些代入基本恒等式 $\\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T \\Delta S^\\circ(T)$，得到标准吉布斯自由能变作为温度的函数的完整表达式：\n$$ \\Delta G^\\circ(T) = \\left[\\Delta H^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p (T - T_{\\mathrm{ref}})\\right] - T\\left[\\Delta S^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p \\ln\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)\\right] $$\n\n3.  **解链温度 $T_m$ 时的平衡条件**\n在解链温度 $T_m$ 时，总链物质的一半以双链体形式存在。设 $C_T$ 为单链的总摩尔浓度。我们必须推导出 $T_m$ 时的平衡常数 $K$ 的值。\n-   对于**非自互补双链体** ($AB \\rightleftharpoons A + B$)，我们假设链 $A$ 和 $B$ 的初始浓度等摩尔，使得每种链的总浓度为 $C_T/2$。总链浓度由质量平衡给出：$C_T = [A] + [B] + 2[AB]$。化学计量关系决定了 $[A]=[B]$。在 $T_m$ 时，结合在双链体中的链浓度 $2[AB]_{T_m}$ 等于总链浓度的一半 $C_T/2$。因此，$[AB]_{T_m} = C_T/4$。游离链的浓度为 $[A]_{T_m} = [B]_{T_m} = C_T/2 - 2[AB]_{T_m} = C_T/2 - C_T/4 = C_T/4$。那么，$T_m$ 时的平衡常数为：\n    $$ K(T_m) = \\frac{[A]_{T_m}[B]_{T_m}}{[AB]_{T_m}} = \\frac{(C_T/4)(C_T/4)}{C_T/4} = \\frac{C_T}{4} $$\n-   对于**自互补双链体** ($A_2 \\rightleftharpoons 2A$)，质量平衡为 $C_T = [A] + 2[A_2]$。在 $T_m$ 时，$2[A_2]_{T_m} = C_T/2$，所以 $[A_2]_{T_m} = C_T/4$。单体浓度为 $[A]_{T_m} = C_T - 2[A_2]_{T_m} = C_T - C_T/2 = C_T/2$。$T_m$ 时的平衡常数为：\n    $$ K(T_m) = \\frac{[A]_{T_m}^2}{[A_2]_{T_m}} = \\frac{(C_T/2)^2}{C_T/4} = C_T $$\n两种情况都可以用通用关系 $K(T_m) = C_T/s$ 来表示，其中化学计量因子 $s$ 对于非自互补系统等于 $4$，对于自互补系统等于 $1$。\n\n4.  **$T_m$ 隐式方程的推导**\n通过结合 $T = T_m$ 时的热力学和化学计量表达式，我们建立最终方程。我们有：\n$$ \\Delta G^\\circ(T_m) = -RT_m \\ln K(T_m) = -RT_m \\ln(C_T/s) $$\n现在，我们代入 $\\Delta G^\\circ(T)|_{T=T_m}$ 的完整表达式：\n$$ \\left[\\Delta H^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p (T_m - T_{\\mathrm{ref}})\\right] - T_m\\left[\\Delta S^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p \\ln\\left(\\frac{T_m}{T_{\\mathrm{ref}}}\\right)\\right] = -RT_m \\ln(C_T/s) $$\n这就是所要求的隐式标量方程，其根为 $T_m$。\n\n5.  **数值求解策略**\n为了数值求解 $T_m$，我们定义一个在 $T=T_m$ 时为零的函数 $f(T)$：\n$$ f(T) = \\left[\\Delta H^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p (T - T_{\\mathrm{ref}})\\right] - T\\left[\\Delta S^\\circ(T_{\\mathrm{ref}}) + \\Delta C_p \\ln\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)\\right] + RT \\ln(C_T/s) $$\n对于物理上现实的参数（$\\Delta H^\\circ>0$，$\\Delta S^\\circ>0$），该函数是单调的，从低温下的正值（有利于双链体）递减到高温下的负值（有利于单链）。这一性质保证了根的唯一性，并使系统适用于稳健的区间法求根算法。我们将采用 Brent 方法，它兼具速度和稳健性，在一个物理上合理的温度区间内，如 $[270\\ \\mathrm{K}, 400\\ \\mathrm{K}]$。所有计算将使用国际单位制（焦耳、开尔文、摩尔），浓度单位为 $\\mathrm{mol\\,L^{-1}}$，气体常数 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。在对数中，浓度 $C_T$ 被视为无量纲量，这隐含地关联到一个 $1\\ \\mathrm{mol\\,L^{-1}}$ 的标准态。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for the DNA melting temperature (Tm) based on thermodynamic parameters.\n    \"\"\"\n    # Universal gas constant in SI units\n    R = 8.31446261815324  # J mol^-1 K^-1\n\n    # Define the test cases from the problem statement.\n    # Format: (dH_ref (J/mol), dS_ref (J/mol/K), dCp (J/mol/K), CT (mol/L), s, T_ref (K))\n    test_cases = [\n        (418000.0, 1255.0, 1500.0, 1.0e-6, 4.0, 310.15),\n        (418000.0, 1255.0, 0.0, 1.0e-6, 4.0, 310.15),\n        (418000.0, 1255.0, 1500.0, 1.0e-9, 4.0, 310.15),\n        (250000.0, 800.0, 1000.0, 1.0e-5, 1.0, 298.15),\n    ]\n\n    def calculate_tm(dH_ref, dS_ref, dCp, CT, s, T_ref):\n        \"\"\"\n        Calculates the melting temperature (Tm) by finding the root of the\n        thermodynamic equation.\n\n        Args:\n            dH_ref (float): Standard enthalpy change at T_ref (J/mol).\n            dS_ref (float): Standard entropy change at T_ref (J/mol/K).\n            dCp (float): Standard heat capacity change (J/mol/K).\n            CT (float): Total strand concentration (mol/L).\n            s (float): Stoichiometric factor (4 for non-self-complementary, 1 for self-complementary).\n            T_ref (float): Reference temperature (K).\n\n        Returns:\n            float: The calculated melting temperature, Tm (K).\n        \"\"\"\n        \n        # Define the implicit function f(T) = 0 whose root is Tm.\n        # f(T) can be written as Delta_G_standard(T) + R*T*ln(CT/s)\n        def f(T, dH_ref, dS_ref, dCp, CT, s, T_ref, R):\n            # Calculate temperature-dependent enthalpy and entropy\n            dH_T = dH_ref + dCp * (T - T_ref)\n            dS_T = dS_ref + dCp * np.log(T / T_ref)\n            \n            # Calculate standard Gibbs free energy change at temperature T\n            dG_T = dH_T - T * dS_T\n            \n            # The standard concentration C^o = 1 M is implicitly used to make the \n            # argument of ln dimensionless. For CT in mol/L, this is numerically correct.\n            return dG_T + R * T * np.log(CT / s)\n\n        # Define a robust bracket for root finding. For DNA melting in aqueous\n        # solution, this range is physically very safe.\n        low_T_bound = 270.0  # K, approx -3 C\n        high_T_bound = 400.0 # K, approx 127 C\n\n        # Use Brent's method (brentq) for efficient and reliable root-finding within the bracket.\n        # This method is guaranteed to converge if the function values at the\n        # endpoints of the interval have opposite signs.\n        try:\n            tm = optimize.brentq(\n                f, \n                low_T_bound, \n                high_T_bound, \n                args=(dH_ref, dS_ref, dCp, CT, s, T_ref, R)\n            )\n        except ValueError:\n            # This would occur if f(low_T_bound) and f(high_T_bound) have the same sign,\n            # indicating the root is not in the bracket. For the given problem\n            # parameters, this is not expected.\n            return np.nan\n\n        return tm\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        dH_ref, dS_ref, dCp, CT, s, T_ref = case\n        \n        # Calculate Tm and append to results list\n        tm_val = calculate_tm(dH_ref, dS_ref, dCp, CT, s, T_ref)\n        results.append(f\"{tm_val:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2634863"}, {"introduction": "我们之前使用的热力学模型大多基于一个核心简化：DNA熔解是一个“双态”过程，只涉及完全折叠和完全解开两种宏观状态。但从微观角度看，存在着大量部分熔解的中间构象。本练习将带您深入到统计力学的层面，使用简化的Poland-Scheraga模型来估算这些中间态（如末端磨损和内部环）在熔解过程中的真实占比，从而从第一性原理上检验双态近似的有效性及其物理基础——协同性。[@problem_id:2634911]", "problem": "一个长度为 $N=10$ 个碱基对的自我互补脱氧核糖核酸 (DNA) 十聚体，在含盐水溶液中发生热解链。其碱基配对过程可以用一个带单成核罚分的一维协同螺旋-线团转变模型来模拟。考虑一种 Poland–Scheraga 类型的统计力学描述，其中一个长度为 $k$ 的连续螺旋片段的统计权重为 $\\sigma_0 s^{k}$，其中 $s=\\exp\\!\\left(-\\beta\\,\\Delta g_{\\mathrm{bp}}(T)\\right)$，$β=1/(k_{\\mathrm{B}}T)$，$\\Delta g_{\\mathrm{bp}}(T)$ 是在温度 $T$ 下每个碱基对的有效自由能。一个长度为 $l$ 的内部变性泡（即，由螺旋片段包围的 $l$ 个连续打开的碱基对）带有一个额外的熵罚分因子 $f(l)=A\\,l^{-c}$，其中 $A\\approx 1$ 且 $c\\approx 1.8$。假设序列均一，中间态最多只包含一个变性泡，并忽略多泡状态和错配。取完全解旋的宏观状态为参考态，其统计权重为 $Z_{\\mathrm{U}}=1$。完全折叠的宏观状态的统计权重为 $Z_{\\mathrm{F}}=\\sigma_0 s^{N}$。定义“解链”温度 $T^\\ast$ 满足条件 $Z_{\\mathrm{F}}=Z_{\\mathrm{U}}$，即在 $T^\\ast$ 时 $\\sigma_0 s^{N}=1$。\n\n使用正则配分函数 $Z=\\sum_i w_i$ 的定义（即对所有符合模型的微观状态的玻尔兹曼权重 $w_i$ 求和），在 $T^\\ast$ 温度下，比较所有部分解链中间态（包括末端磨损态和单泡态）的总贡献与两种宏观状态的贡献。参数为 $\\sigma_0=10^{-5}$，$N=10$，$A=1$，以及 $c=1.8$。基于第一性原理，判断对于这个十聚体在 $T^\\ast$ 温度下，两态近似 $Z\\approx Z_{\\mathrm{F}}+Z_{\\mathrm{U}}$ 是否有效，并通过估算中间态权重相对于 $Z_{\\mathrm{F}}+Z_{\\mathrm{U}}$ 的量级来证明你的选择。\n\n哪个选项是正确的？\n\nA. 所有中间态权重的总和小于 $\\left(Z_{\\mathrm{F}}+Z_{\\mathrm{U}}\\right)$ 的 $10\\%$，因此两态近似在定量上是有效的。\n\nB. 在 $T^\\ast$ 时，末端磨损中间态的贡献约为 $Z_{\\mathrm{end}}\\approx \\dfrac{2}{s-1}\\approx 0.92$，与两种宏观状态的总和相当，而内部变性泡中间态的贡献可以忽略（因其有一个额外的因子 $\\sigma_0$）；因此，在这些参数下，两态近似在定量上是无效的。\n\nC. 内部变性泡中间态占主导地位，因为对于短寡核苷酸来说，环熵罚分很小；在 $T^\\ast$ 时，$\\sum_{\\text{bubbles}}\\gg \\sum_{\\text{end-fraying}}$。\n\nD. 在固定的 $\\sigma_0$ 下，中间态权重的分数总是随 $N$ 的增加而减小，因此对于 $N=10$ 的情况，该分数必定低于 $N=6$ 的情况，两态近似至少同样准确。", "solution": "用户需要对一个关于DNA十聚体热解链过程中两态近似有效性的问题进行批判性分析。\n\n### 第1步：提取已知条件\n- 系统：自我互补DNA十聚体。\n- 长度：$N=10$ 个碱基对。\n- 模型：一维协同螺旋-线团转变（Poland-Scheraga类型）。\n- 长度为 $k$ 的螺旋片段的统计权重：$w_{\\mathrm{helix}}(k) = \\sigma_0 s^{k}$。\n- 成核参数：$\\sigma_0=10^{-5}$。\n- 增长参数：$s=\\exp(-\\beta\\,\\Delta g_{\\mathrm{bp}}(T))$，其中 $\\beta=1/(k_{\\mathrm{B}}T)$。\n- 长度为 $l$ 的内部变性泡的统计权重罚分：$f(l)=A\\,l^{-c}$。\n- 变性泡罚分参数：$A\\approx 1$，$c\\approx 1.8$。\n- 假设：序列均一性，最多一个变性泡，忽略多泡状态。\n- 完全解旋宏观状态的权重：$Z_{\\mathrm{U}}=1$。\n- 完全折叠宏观状态的权重：$Z_{\\mathrm{F}}=\\sigma_0 s^{N}$。\n- 解链温度 $T^\\ast$ 的定义：$Z_{\\mathrm{F}}=Z_{\\mathrm{U}}$ 时的温度，即 $\\sigma_0 s^{N}=1$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题描述了Poland-Scheraga模型的一个简化但标准的应用，该模型是生物聚合物解链理论的基石。所有参数和定义均已提供，并且它们在科学上是合理且一致的。该问题定义明确，要求进行定量计算以评估一个常用近似的有效性。\n- **科学依据：** 该模型牢固地建立在应用于聚合物物理的统计力学既定原理之上。参数 $\\sigma_0$ 和 $c$ 在DNA的物理可接受范围内。\n- **适定性：** 该问题给出了明确的目标、所有必要的数据（$N$, $\\sigma_0$, $A$, $c$）和明确的定义（$T^\\ast$ 的条件，统计权重的形式），确保存在唯一且有意义的解。\n- **客观性：** 该问题以精确、定量的术语陈述，没有歧义或主观内容。\n\n### 第3步：结论与行动\n问题陈述有效。我将继续推导解决方案。\n\n### 推导\n总正则配分函数 $Z$ 是所有可能状态的统计权重之和：完全解旋态（线团）、完全折叠态（螺旋）以及所有部分解链的中间态。\n$$Z = Z_{\\mathrm{U}} + Z_{\\mathrm{F}} + Z_{\\mathrm{int}}$$\n问题定义了 $Z_{\\mathrm{U}}=1$ 和 $Z_{\\mathrm{F}}=\\sigma_0 s^N$。两态近似为 $Z \\approx Z_{\\mathrm{U}} + Z_{\\mathrm{F}}$。其有效性取决于 $Z_{\\mathrm{int}}$ 相对于 $Z_{\\mathrm{U}} + Z_{\\mathrm{F}}$ 的大小。我们必须在由条件 $Z_{\\mathrm{F}} = Z_{\\mathrm{U}}$ 定义的温度 $T^\\ast$ 下评估这一点。\n在 $T=T^\\ast$ 时：\n$$Z_{\\mathrm{F}} = \\sigma_0 s^{N} = 1 = Z_{\\mathrm{U}}$$\n因此，在 $T^\\ast$ 时，两种宏观状态的权重之和为 $Z_{\\mathrm{F}} + Z_{\\mathrm{U}} = 1 + 1 = 2$。我们需要计算 $Z_{\\mathrm{int}}$ 并将其与 $2$进行比较。\n\n根据 $T^\\ast$ 时的条件，我们可以确定增长参数 $s$ 的值。给定 $N=10$ 和 $\\sigma_0=10^{-5}$：\n$$10^{-5} s^{10} = 1 \\implies s^{10} = 10^5 \\implies s = (10^5)^{1/10} = 10^{0.5} = \\sqrt{10}$$\n数值上，$s \\approx 3.162$。\n\n中间态 $Z_{\\mathrm{int}}$ 由末端磨损态 ($Z_{\\mathrm{end}}$) 和单泡态 ($Z_{\\mathrm{bubble}}$) 组成。\n$$Z_{\\mathrm{int}} = Z_{\\mathrm{end}} + Z_{\\mathrm{bubble}}$$\n\n**1. 末端磨损态的贡献 ($Z_{\\mathrm{end}}$)**\n末端磨损态是指双螺旋的一端有一个或多个碱基对打开，留下一个单一的连续螺旋片段。一端有 $k$ 个碱基对磨损的状态，其螺旋片段长度为 $N-k$。根据模型，其统计权重为 $\\sigma_0 s^{N-k}$。磨损的碱基对数 $k$ 的范围可以从 $1$ 到 $N-1$。（如果 $k=0$，则为完全折叠态 $Z_{\\mathrm{F}}$；如果 $k=N$，则为完全解旋态 $Z_{\\mathrm{U}}$，这两者都已单独计算）。\n磨损可以从两端发生。假设两端是可区分的，总权重为：\n$$Z_{\\mathrm{end}} = 2 \\sum_{k=1}^{N-1} \\sigma_0 s^{N-k}$$\n让我们将求和指数改为 $j = N-k$。当 $k$ 从 $1$ 变化到 $N-1$ 时，$j$ 从 $N-1$ 变化到 $1$。\n$$Z_{\\mathrm{end}} = 2 \\sigma_0 \\sum_{j=1}^{N-1} s^j$$\n这是一个几何级数。其和为 $\\sum_{j=1}^{N-1} s^j = s \\frac{s^{N-1}-1}{s-1}$。\n$$Z_{\\mathrm{end}} = 2 \\sigma_0 s \\frac{s^{N-1}-1}{s-1} = 2 \\frac{\\sigma_0 s^N - \\sigma_0 s}{s-1}$$\n在 $T^\\ast$ 时，我们知道 $\\sigma_0 s^N = 1$。代入此式：\n$$Z_{\\mathrm{end}} = 2 \\frac{1 - \\sigma_0 s}{s-1}$$\n由于 $s = \\sqrt{10} \\approx 3.162$ 远大于 $1$，且 $\\sigma_0=10^{-5}$ 非常小，项 $\\sigma_0 s$ 与 $1$ 相比可以忽略不计。因此，我们可以将 $Z_{\\mathrm{end}}$ 近似为：\n$$Z_{\\mathrm{end}} \\approx \\frac{2}{s-1}$$\n代入 $s$ 的值：\n$$Z_{\\mathrm{end}} \\approx \\frac{2}{\\sqrt{10}-1} \\approx \\frac{2}{3.162 - 1} = \\frac{2}{2.162} \\approx 0.925$$\n\n**2. 单泡态的贡献 ($Z_{\\mathrm{bubble}}$)**\n单泡态具有一个由 $l$ 个打开的碱基对组成的内部环，两侧各有一个螺旋片段。这种状态的权重是其各组分权重的乘积。一个变性泡状态包含两个独立的螺旋片段，因此根据问题规则（“长度为 $k$ 的连续螺旋片段的权重是 $\\sigma_0 s^k$”），我们必须施加两次成核罚分 $\\sigma_0$。配对的碱基总数为 $N-l$。变性泡本身带有一个罚分 $f(l) = A l^{-c}$。\n长度为 $l$ 的单个变性泡构象的权重为 $w_{\\mathrm{bubble}} = \\sigma_0^2 s^{N-l} f(l)$。\n长度为 $l$ 的变性泡每侧必须至少有一个碱基对，所以 $1 \\le l \\le N-2$。长度为 $l$ 的变性泡可能的起始位置有 $N-l-1$ 个。\n总统计权重是对所有可能的变性泡长度和位置求和：\n$$Z_{\\mathrm{bubble}} = \\sum_{l=1}^{N-2} (N-l-1) \\left[ \\sigma_0^2 s^{N-l} A l^{-c} \\right]$$\n我们可以使用 $T^\\ast$ 时的条件重写权重项：$\\sigma_0^2 s^{N-l} = \\sigma_0 (\\sigma_0 s^N) s^{-l} = \\sigma_0 (1) s^{-l} = \\sigma_0 s^{-l}$。\n$$Z_{\\mathrm{bubble}} = A \\sigma_0 \\sum_{l=1}^{N-2} (N-l-1) s^{-l} l^{-c}$$\n当 $A=1$, $\\sigma_0=10^{-5}$, $s=\\sqrt{10}$, $N=10$, $c=1.8$ 时：\n$$Z_{\\mathrm{bubble}} = 10^{-5} \\sum_{l=1}^{8} (9-l) (\\sqrt{10})^{-l} l^{-1.8}$$\n求和项是正数之和，所以是正的。我们用它的第一项（$l=1$），也就是最大的一项来估计其数量级：\n$l=1$ 时的项为：$(9-1)(\\sqrt{10})^{-1}(1)^{-1.8} = 8/\\sqrt{10} \\approx 2.53$。\n整个和将是一个数量级为1的数。然而，它乘以了小的成核因子 $\\sigma_0=10^{-5}$。\n$$Z_{\\mathrm{bubble}} \\sim O(\\sigma_0) \\approx O(10^{-5})$$\n与 $Z_{\\mathrm{end}} \\approx 0.925$ 和 $Z_{\\mathrm{F}}+Z_{\\mathrm{U}}=2$ 相比，这一贡献可以忽略不计。形成第二个螺旋区所需的额外因子 $\\sigma_0$ 严重抑制了内部环的形成。\n\n**3. 关于两态近似的结论**\n中间态的总权重为 $Z_{\\mathrm{int}} = Z_{\\mathrm{end}} + Z_{\\mathrm{bubble}} \\approx 0.925 + O(10^{-5}) \\approx 0.925$。\n中间态权重与宏观状态权重之比为：\n$$\\frac{Z_{\\mathrm{int}}}{Z_{\\mathrm{F}}+Z_{\\mathrm{U}}} \\approx \\frac{0.925}{2} = 0.4625$$\n这意味着在解链温度 $T^\\ast$ 时，中间态的布居数约占完全折叠态和完全解旋态总布居数的 $46\\%$。这是一个非常显著的贡献。因此，在给定参数下，对于该系统，两态近似 $Z \\approx Z_{\\mathrm{F}}+Z_{\\mathrm{U}}$ 在定量上是无效的。\n\n### 逐项分析\n**A. 所有中间态权重的总和小于 $\\left(Z_{\\mathrm{F}}+Z_{\\mathrm{U}}\\right)$ 的 $10\\%$，因此两态近似在定量上是有效的。**\n我的计算表明，这个总和约为 $46.25\\%$。此陈述与事实不符。\n结论：**错误**。\n\n**B. 在 $T^\\ast$ 时，末端磨损中间态的贡献约为 $Z_{\\mathrm{end}}\\approx \\dfrac{2}{s-1}\\approx 0.92$，与两种宏观状态的总和相当，而内部变性泡中间态的贡献可以忽略（因其有一个额外的因子 $\\sigma_0$）；因此，在这些参数下，两态近似在定量上是无效的。**\n我的计算得出 $Z_{\\mathrm{end}} \\approx 0.925$，这与近似值 $\\frac{2}{s-1}$ 相符。这个值与 $Z_{\\mathrm{F}}+Z_{\\mathrm{U}} = 2$ 相当。我的分析表明，相对于末端磨损态，内部变性泡的权重被一个因子 $\\sigma_0$ 抑制，使其可以忽略不计。最终结论，即两态近似无效，也是正确的。该陈述的每一部分都与从第一性原理出发的推导相符。\n结论：**正确**。\n\n**C. 内部变性泡中间态占主导地位，因为对于短寡核苷酸来说，环熵罚分很小；在 $T^\\ast$ 时，$\\sum_{\\text{bubbles}}\\gg \\sum_{\\text{end-fraying}}$。**\n我的计算显示了相反的结果：$Z_{\\mathrm{end}} \\approx 0.925 \\gg Z_{\\mathrm{bubble}} \\approx O(10^{-5})$。变性泡的主要罚分是第二个螺旋的成核成本 $\\sigma_0$，而不是环熵因子 $f(l)$。\n结论：**错误**。\n\n**D. 在固定的 $\\sigma_0$ 下，中间态权重的分数总是随 $N$ 的增加而减小，因此对于 $N=10$ 的情况，该分数必定低于 $N=6$ 的情况，两态近似至少同样准确。**\n在 $T^\\ast$ 时，$s = (1/\\sigma_0)^{1/N}$。随着链长 $N$ 增加，$s$ 减小并趋近于 $1$。对中间态的主要贡献来自 $Z_{\\mathrm{end}} \\approx \\frac{2}{s-1}$。当 $s$ 趋近于 $1$ 时，$s-1$ 趋近于 $0$，$Z_{\\mathrm{end}}$ 增加。因此，中间态的比例随 $N$ 的增加而*增加*，使得转变更加宽泛，两态近似对于更长的链（在固定的 $\\sigma_0$ 下）*更不*有效。该选项的前提在事实上是错误的。\n结论：**错误**。", "answer": "$$\\boxed{B}$$", "id": "2634911"}]}