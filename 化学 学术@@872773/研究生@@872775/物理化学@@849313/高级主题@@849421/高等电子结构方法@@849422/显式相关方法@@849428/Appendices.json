{"hands_on_practices": [{"introduction": "显式相关方法的理论基石在于它们能正确描述电子-电子瞬间接触（$r_{12} \\to 0$）时的波函数行为。本练习旨在通过第一性原理计算，揭示传统波函数在电子-电子尖点（electron-electron cusp）处的缺陷，并展示最简单的显式相关项如何修正这一问题。通过亲手推导并应用Kato尖点条件 [@problem_id:2891520]，您将深刻理解为何在波函数中直接引入电子间距离$r_{12}$是提高计算精度的关键。", "problem": "考虑一个核电荷为 $Z=2$ 的类氦双电子原子，处于非相对论 Born–Oppenheimer 近似下。使用原子单位。其哈密顿量为\n$$\n\\hat{H} = -\\frac{1}{2}\\left(\\nabla_{1}^{2} + \\nabla_{2}^{2}\\right) - Z\\left(\\frac{1}{r_{1}} + \\frac{1}{r_{2}}\\right) + \\frac{1}{r_{12}},\n$$\n其中 $r_{12} = |\\mathbf{r}_{1} - \\mathbf{r}_{2}|$。使用以下两种空间波函数模型，每种都与一个自旋单态配对：\n\n- 不含显式相关：非相关乘积\n$$\n\\Phi_{0}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad \\varphi(\\mathbf{r}) = \\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{1/2} \\exp(-\\zeta r),\n$$\n其中 $\\zeta$ 是一个正的变分指数。\n\n- 在显式相关 F12 (F12) 方法精神下包含显式相关：孪函数增强拟设\n$$\n\\Phi_{F12}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\mathcal{N}\\,g(r_{12})\\,\\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad g(r_{12}) = 1 + c\\, r_{12},\n$$\n其中 $\\mathcal{N}$ 是归一化常数，标量 $c$ 由电子-电子尖点条件确定。\n\n任务：\n1. 从相对坐标 $u = r_{12}$ 下的多电子薛定谔方程出发，进行局域并合分析，推导自旋单态基态的电子-电子 Kato 尖点条件，\n$$\n\\left.\\frac{\\partial \\Psi}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\,\\Psi\\big|_{u=0}.\n$$\n利用此条件确定所选 $g(u)$ 的参数 $c$。\n\n2. 对于非相关乘积密度 $|\\Phi_{0}|^{2}$，使用 Hylleraas 坐标 $s=r_{1}+r_{2}$、$t=r_{1}-r_{2}$ 和 $u=r_{12}$ 精确计算以下组态空间平均值：\n   - $\\langle u^{-1} \\rangle_{0}$,\n   - $\\langle u \\rangle_{0}$,\n   - $\\langle u^{2} \\rangle_{0}$,\n   其中 $\\langle \\cdot \\rangle_{0}$ 表示使用权重 $|\\Phi_{0}|^{2}$ 的归一化平均。你必须从 Hylleraas 体积元和指数因子 $\\exp(-2\\zeta s)$ 的第一性原理出发推导这些积分；不要使用任何预先制表的值。\n\n3. 利用第 2 项的结果，推导 F12 增强拟设下电子-电子排斥期望值的闭合形式表达式，\n$$\nJ(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}},\n$$\n表达式仅用 $\\zeta$ 和 $c$ 表示。\n\n4. 对于非相关模型，计算变分能量泛函\n$$\nE_{0}(\\zeta) = \\langle \\Phi_{0} | \\hat{H} | \\Phi_{0} \\rangle\n$$\n并对 $\\zeta$ 进行最小化。仅使用定义和标准的单电子类氢原子期望值，获得作为 $Z$ 函数的闭合形式最小化值 $\\zeta^{\\star}$。\n\n5. 设 $Z=2$ 且 $\\zeta = \\zeta^{\\star}$。使用第 1 项中由尖点条件确定的 $c$，计算 F12 模型和非相关模型之间电子-电子排斥能的差值，\n$$\n\\Delta J \\equiv J(c) - \\langle u^{-1} \\rangle_{0}.\n$$\n将你的最终答案四舍五入到四位有效数字。最终能量差以哈特里 (hartree) 为单位表示。", "solution": "该问题经核实具有科学依据、良定且客观。它提出了一个理论量子化学中标准的、尽管计算量较大的问题。我们着手进行解答。所有计算均在原子单位下进行。\n\n**任务 1：电子-电子尖点条件**\n\n双电子原子的非相对论薛定谔方程为 $\\hat{H}\\Psi = E\\Psi$，其中哈密顿量由下式给出\n$$\n\\hat{H} = -\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} - \\frac{Z}{r_{1}} - \\frac{Z}{r_{2}} + \\frac{1}{r_{12}}.\n$$\n我们分析当两个电子相互靠近时，即电子间距 $u = r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2| \\to 0$ 时，波函数 $\\Psi(\\mathbf{r}_1, \\mathbf{r}_2)$ 的行为。在此极限下，电子-电子排斥项 $1/u$ 变为奇异项。为使总能量 $E$ 保持有限，该奇异性必须被动能算符中相应的奇异性所抵消。在小 $u$ 处，薛定谔方程中的主导项为\n$$\n\\left(-\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\left(E + \\frac{Z}{r_1} + \\frac{Z}{r_2}\\right)\\Psi.\n$$\n当 $u \\to 0$ 时（因为 $\\mathbf{r}_1 \\to \\mathbf{r}_2$），右侧是有限的。我们变换到质心坐标 $\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$ 和相对坐标 $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$。动能算符变为 $-\\frac{1}{4}\\nabla_R^2 - \\nabla_u^2$。局域薛定谔方程由相对坐标项主导：\n$$\n\\left(-\\nabla_{u}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\text{有限}.\n$$\n对于自旋单态基态，空间波函数对电子交换是对称的，并且由相对坐标中的 s 波 ($l=0$) 分量主导。因此，我们可以考虑仅依赖于 $u$ 大小的球面平均波函数 $\\bar{\\Psi}(u) = \\frac{1}{4\\pi}\\int \\Psi d\\Omega_u$。s 波的拉普拉斯算符 $\\nabla_u^2$ 的径向部分为 $\\frac{1}{u^2}\\frac{\\partial}{\\partial u}(u^2 \\frac{\\partial}{\\partial u})$。$\\bar{\\Psi}(u)$ 的局域方程变为\n$$\n-\\frac{1}{u^2}\\frac{d}{d u}\\left(u^2 \\frac{d\\bar{\\Psi}}{d u}\\right) + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{有限}.\n$$\n展开此式得到 $-\\frac{d^2\\bar{\\Psi}}{du^2} - \\frac{2}{u}\\frac{d\\bar{\\Psi}}{du} + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{有限}$。\n我们假设 $\\bar{\\Psi}(u)$ 在 $u=0$ 附近有泰勒级数展开：$\\bar{\\Psi}(u) = a_0 + a_1 u + a_2 u^2 + \\dots$，其中 $a_0 = \\bar{\\Psi}(0)$ 且 $a_1 = \\left.\\frac{d\\bar{\\Psi}}{du}\\right|_{u=0}$。将此代入方程：\n$$\n-(2a_2 + \\dots) - \\frac{2}{u}(a_1 + 2a_2 u + \\dots) + \\frac{1}{u}(a_0 + a_1 u + \\dots) \\approx \\text{有限}.\n$$\n合并 $u^{-1}$ 阶的项：\n$$\n\\frac{-2a_1 + a_0}{u} = 0 \\implies -2a_1 + a_0 = 0 \\implies a_1 = \\frac{1}{2}a_0.\n$$\n这就得到了自旋单态的 Kato 尖点条件：\n$$\n\\left.\\frac{\\partial \\bar{\\Psi}}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Psi}\\big|_{u=0}.\n$$\n问题要求的是 $\\Psi$ 的这个条件，它对其 s 波分量成立。\n对于 F12 拟设，$\\Phi_{F12} = \\mathcal{N} g(u) \\Phi_0$，其中 $g(u)=1+cu$ 且 $\\Phi_0 = \\varphi(\\mathbf{r}_1)\\varphi(\\mathbf{r}_2)$ 是 1s 轨道的乘积。函数 $\\Phi_0$ 在 $u=0$ 处是光滑的，其球面平均形式 $\\bar{\\Phi}_0(u)$ 的泰勒展开以偶次幂项开始，即 $\\bar{\\Phi}_0(u) = A + B u^2 + \\dots$。因此，$\\left.\\frac{d\\bar{\\Phi}_0}{du}\\right|_{u=0}=0$。\n球面平均的 F12 波函数为 $\\bar{\\Phi}_{F12}(u) \\approx \\mathcal{N}(1+cu)\\bar{\\Phi}_0(u)$。\n应用尖点条件：\n$\\bar{\\Phi}_{F12}(0) = \\mathcal{N}\\bar{\\Phi}_0(0)$。\n$\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\mathcal{N}\\left[c\\bar{\\Phi}_0(u) + (1+cu)\\frac{d\\bar{\\Phi}_0}{du}\\right]_{u=0} = \\mathcal{N}c\\bar{\\Phi}_0(0)$。\n条件 $\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Phi}_{F12}(0)$ 变为 $\\mathcal{N}c\\bar{\\Phi}_0(0) = \\frac{1}{2}\\mathcal{N}\\bar{\\Phi}_0(0)$。\n由于 $\\bar{\\Phi}_0(0) \\neq 0$，我们得到 $c = 1/2$。\n\n**任务 2：非相关波函数的期望值**\n\n波函数 $\\Phi_0$ 是归一化的。我们计算形式为 $\\langle u^k \\rangle_0 = \\int u^k |\\Phi_0|^2 d\\tau_1 d\\tau_2$ 的期望值。\n密度为 $|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta(r_1+r_2))$。在 Hylleraas 坐标 ($s=r_1+r_2$, $t=r_1-r_2$, $u=r_{12}$) 中，体积元为 $d\\tau_1 d\\tau_2 = \\pi^2 u(s^2-t^2)ds\\,dt\\,du$。积分限为 $0 \\le u \\le s$ 和 $-u \\le t \\le u$。\n$|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta s)$。\n$$\n\\langle u^k \\rangle_0 = \\frac{\\zeta^6}{\\pi^2} \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+1} \\int_{-u}^u dt \\, \\pi^2 (s^2-t^2).\n$$\n对 $t$ 的积分为 $\\int_{-u}^u (s^2-t^2)dt = [s^2 t - t^3/3]_{-u}^u = 2s^2u - 2u^3/3 = 2u(s^2 - u^2/3)$。\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+2} (s^2 - u^2/3).\n$$\n对 $u$ 的积分为 $\\int_0^s (s^2 u^{k+2} - \\frac{1}{3}u^{k+4})du = \\left[ \\frac{s^2 u^{k+3}}{k+3} - \\frac{u^{k+5}}{3(k+5)} \\right]_0^s = s^{k+5}\\left(\\frac{1}{k+3} - \\frac{1}{3(k+5)}\\right) = s^{k+5}\\frac{2k+12}{3(k+3)(k+5)}$。\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\frac{2(k+6)}{3(k+3)(k+5)} \\int_0^\\infty s^{k+5} \\exp(-2\\zeta s) ds.\n$$\n使用标准积分 $\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$，我们得到\n$$\n\\langle u^k \\rangle_0 = \\frac{4\\zeta^6(k+6)}{3(k+3)(k+5)} \\frac{(k+5)!}{(2\\zeta)^{k+6}} = \\frac{4\\zeta^6(k+6)(k+5)(k+4)!}{3(k+3)(k+5) 2^{k+6}\\zeta^{k+6}} = \\frac{4(k+6)(k+4)!}{3(k+3)2^{k+6}\\zeta^k}.\n$$\n我们对 $k=-1, 1, 2$ 计算此式：\n对于 $k=-1$： $\\langle u^{-1} \\rangle_0 = \\frac{4(5)(3!)}{3(2)2^5\\zeta^{-1}} = \\frac{120\\zeta}{192} = \\frac{5}{8}\\zeta$。\n对于 $k=1$： $\\langle u \\rangle_0 = \\frac{4(7)(5!)}{3(4)2^7\\zeta} = \\frac{28 \\cdot 120}{12 \\cdot 128\\zeta} = \\frac{3360}{1536\\zeta} = \\frac{35}{16\\zeta}$。\n对于 $k=2$： $\\langle u^2 \\rangle_0 = \\frac{4(8)(6!)}{3(5)2^8\\zeta^2} = \\frac{32 \\cdot 720}{15 \\cdot 256\\zeta^2} = \\frac{23040}{3840\\zeta^2} = \\frac{6}{\\zeta^2}$。\n\n**任务 3：F12 拟设的排斥能**\n\n排斥能为 $J(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}}$。对于 $g(u) = 1+cu$，我们有 $g(u)^2 = 1 + 2cu + c^2u^2$。\n分子是 $\\langle (1+2cu+c^2u^2)u^{-1} \\rangle_0 = \\langle u^{-1} + 2c + c^2u \\rangle_0 = \\langle u^{-1} \\rangle_0 + 2c\\langle 1 \\rangle_0 + c^2\\langle u \\rangle_0$。\n分母是 $\\langle 1+2cu+c^2u^2 \\rangle_0 = \\langle 1 \\rangle_0 + 2c\\langle u \\rangle_0 + c^2\\langle u^2 \\rangle_0$。\n使用 $\\langle 1 \\rangle_0 = 1$ 和任务 2 的结果：\n$$\nJ(c) = \\frac{\\frac{5}{8}\\zeta + 2c + c^2\\frac{35}{16\\zeta}}{1 + 2c\\frac{35}{16\\zeta} + c^2\\frac{6}{\\zeta^2}} = \\frac{\\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta}}{1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2}}.\n$$\n\n**任务 4：非相关模型的能量变分最小化**\n\n$\\Phi_0$ 的变分能量为 $E_0(\\zeta) = \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle$。\n$E_0(\\zeta) = 2\\langle \\varphi |-\\frac{1}{2}\\nabla^2| \\varphi \\rangle - 2Z\\langle \\varphi |\\frac{1}{r}| \\varphi \\rangle + \\langle \\Phi_0 |\\frac{1}{r_{12}}| \\Phi_0 \\rangle$。\n对于指数为 $\\zeta$ 的类氢 1s 轨道，期望值为 $\\langle T \\rangle = \\frac{\\zeta^2}{2}$ 和 $\\langle 1/r \\rangle = \\zeta$。\n电子排斥项为 $\\langle 1/r_{12} \\rangle_0 = \\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta$。\n因此，能量泛函为\n$$\nE_0(\\zeta) = 2\\left(\\frac{\\zeta^2}{2}\\right) - 2Z(\\zeta) + \\frac{5}{8}\\zeta = \\zeta^2 - \\left(2Z - \\frac{5}{8}\\right)\\zeta.\n$$\n为了找到最优指数 $\\zeta^\\star$，我们对 $\\zeta$ 最小化 $E_0(\\zeta)$：\n$\\frac{dE_0}{d\\zeta} = 2\\zeta - \\left(2Z - \\frac{5}{8}\\right) = 0$。\n这给出了最小化值 $\\zeta^\\star = Z - \\frac{5}{16}$。\n\n**任务 5：排斥能差的数值计算**\n\n给定 $Z=2$。\n根据任务 4，最优指数为 $\\zeta = \\zeta^\\star = 2 - \\frac{5}{16} = \\frac{27}{16}$。\n根据任务 1，尖点条件确定 $c = 1/2$。\n我们需要计算 $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0$。\n首先，非相关排斥能为 $\\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta = \\frac{5}{8} \\cdot \\frac{27}{16} = \\frac{135}{128}$。\n现在我们用 $c=1/2$ 和 $\\zeta=27/16$ 计算 $J(c)$。\n$J(c)$ 的分子是 $N = \\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta} = \\frac{135}{128} + 1 + \\frac{35(1/4)}{16(27/16)} = \\frac{135+128}{128} + \\frac{35/4}{27} = \\frac{263}{128} + \\frac{35}{108}$。\n$128=2^7$ 和 $108=2^2 \\cdot 3^3$ 的最小公倍数是 $2^7 \\cdot 3^3 = 3456$。\n$N = \\frac{263 \\cdot 27 + 35 \\cdot 32}{3456} = \\frac{7101 + 1120}{3456} = \\frac{8221}{3456}$。\n$J(c)$ 的分母是 $D = 1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2} = 1 + \\frac{35(1/2)}{8(27/16)} + \\frac{6(1/4)}{(27/16)^2} = 1 + \\frac{35/2}{27/2} + \\frac{3/2}{729/256} = 1 + \\frac{35}{27} + \\frac{128}{243}$。\n$27=3^3$ 和 $243=3^5$ 的最小公倍数是 243。\n$D = \\frac{243 + 35 \\cdot 9 + 128}{243} = \\frac{243 + 315 + 128}{243} = \\frac{686}{243}$。\n所以，$J(c) = \\frac{N}{D} = \\frac{8221/3456}{686/243} = \\frac{8221}{3456} \\cdot \\frac{243}{686}$。\n由于 $3456 = 128 \\times 27$ 且 $243 = 9 \\times 27$，该项变为 $\\frac{8221 \\cdot 9}{128 \\cdot 686} = \\frac{73989}{87808}$。\n差值为 $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0 = \\frac{73989}{87808} - \\frac{135}{128}$。\n为了相减，我们使用公分母 $87808 = 128 \\times 686$。\n$\\Delta J = \\frac{73989 - 135 \\cdot 686}{87808} = \\frac{73989 - 92610}{87808} = -\\frac{18621}{87808}$。\n现在我们计算数值：\n$\\Delta J \\approx -0.21206927$。\n四舍五入到四位有效数字得到 $-0.2121$。显式相关因子 $g(u)$ 平均而言使电子更靠近，但排斥积分 $J(c)$ 中的 $1/u$ 权重对分布更为敏感。$J(c)$ 分母中的归一化考虑了总体波函数形状的变化。负号表示这种特定的类 F12 排斥能定义导致的值比简单的非相关值要低。", "answer": "$$\\boxed{-0.2121}$$", "id": "2891520"}, {"introduction": "F12方法最主要的实践优势在于其能极大地加速相关能向完备基组（CBS）极限的收敛。本练习将使用一个公认的理论模型来量化这种加速效应，通过对比传统方法（收敛速度约为$L^{-3}$）与F12方法（收敛速度约为$L^{-7}$）的基组不完备误差 [@problem_id:2891613]，您将清晰地看到F12方法为何能用相对较小的基组就达到高精度，这是其在现代量子化学中广泛应用的基础。", "problem": "要求您在一个受控的数学模型中，使用常规相关一致基组与显式相关F12变体，在带有F12的二阶Møller–Plesset微扰理论 (MP2-F12) 和带有F12的单双激发耦合簇理论 (CCSD-F12)下，实现并分析相关能对原子化能贡献的收敛性。您的程序必须通过模拟由电子-电子尖点所蕴含的渐近基组收敛性以及由显式相关项引入的分解，生成可在不同基组族和方法之间直接比较的数值结果。\n\n起点和基本依据：\n- 精确电子波函数的Kato尖点条件规定了在电子-电子汇合点处的非解析行为，而常规高斯轨道展开若无非常大的基组则无法描述此尖点。因此，对于基数为 $n$、有效角动量跨度为 $L(n)=n+\\frac{1}{2}$ 的相关一致基组，常规方法的相关能基组不完备性误差被建模为近似按 $L(n)^{-p}$ 衰减，其中 $p \\approx 3$。在关于相关一致基组序列的文献中，对于接近完备基组 (CBS) 极限的相关能，这是一个经过充分检验、被广泛接受的经验标度关系。\n- 显式相关方法包含依赖于电子间距 $r_{12}$ 的基函数，从而更直接地满足尖点条件，加速了收敛。在本问题中，对于F12方法，我们将基组不完备性误差建模为近似按 $L(n)^{-p}$ 衰减，其中 $p \\approx 7$。\n\n模型定义：\n- 对于一个物种 $X \\in \\{\\text{mol}, A, B\\}$ 和一个固定的电子结构方法 $M \\in \\{\\text{MP2}, \\text{CCSD}\\}$，给定基组族 $B \\in \\{\\text{conv}, \\text{F12}\\}$ 在基数 $n$ 时的相关能被建模为\n$$\nE_{\\mathrm{corr}}^{(M,B)}(X;n) \\;=\\; E_{\\mathrm{corr,CBS}}^{(M)}(X) \\;+\\; \\dfrac{A_X^{(M,B)}}{\\bigl(L(n)\\bigr)^{p_B}}, \\quad L(n)=n+\\frac{1}{2},\n$$\n其中 $E_{\\mathrm{corr,CBS}}^{(M)}(X)$ 是真实的完备基组相关能，$A_X^{(M,B)}$ 是一个依赖于体系和基组族的振幅，$p_B$ 是收敛指数，其中 $p_{\\mathrm{conv}}=3$ 且 $p_{\\mathrm{F12}}=7$。\n- 在基数 $n$ 时对原子化能的相关能贡献为\n$$\n\\Delta E_{\\mathrm{corr}}^{(M,B)}(n) \\;=\\; E_{\\mathrm{corr}}^{(M,B)}(\\text{mol};n)\\;-\\;\\Bigl(E_{\\mathrm{corr}}^{(M,B)}(A;n)+E_{\\mathrm{corr}}^{(M,B)}(B;n)\\Bigr),\n$$\n其CBS极限为\n$$\n\\Delta E_{\\mathrm{corr,CBS}}^{(M)} \\;=\\; E_{\\mathrm{corr,CBS}}^{(M)}(\\text{mol}) \\;-\\; \\Bigl(E_{\\mathrm{corr,CBS}}^{(M)}(A)+E_{\\mathrm{corr,CBS}}^{(M)}(B)\\Bigr).\n$$\n- 对于使用相同基组族 $B$ 和固定指数 $p_B$ 的两个连续基数 $n$ 和 $m$，通过从上述模型的两个实例中代数消去 $A$，可以得到消除未知振幅的两点外推法，从而从 $\\Delta E_{\\mathrm{corr}}^{(M,B)}(n)$ 和 $\\Delta E_{\\mathrm{corr}}^{(M,B)}(m)$ 获得CBS估计值。\n\n您的任务：\n- 使用指定的参数集，为 MP2-F12 和 CCSD-F12 实现上述模型。使用 $p_{\\mathrm{conv}}=3$ 和 $p_{\\mathrm{F12}}=7$。使用有效基数函数 $L(n)=n+\\frac{1}{2}$。\n- 对于下面提供的每个测试用例以及每种方法 $M \\in \\{\\text{MP2},\\text{CCSD}\\}$：\n  1. 对于常规基组 ($\\mathrm{cc\\text{-}pV}n\\mathrm{Z}$) 和F12基组 ($\\mathrm{cc\\text{-}pV}n\\mathrm{Z}\\text{-}\\mathrm{F12}$)，计算在三zeta点 $n=3$ 处的绝对误差，定义为 $\\bigl|\\Delta E_{\\mathrm{corr}}^{(M,B)}(3)-\\Delta E_{\\mathrm{corr,CBS}}^{(M)}\\bigr|$。\n  2. 对于每个基组族，计算使用 $n=3$ 和 $n=4$ 的两点CBS外推的绝对误差，同样定义为外推值与 $\\Delta E_{\\mathrm{corr,CBS}}^{(M)}$ 之间的绝对差。\n- 所有绝对误差均以毫哈特里（millihartree）表示，即单位为 $\\mathrm{mH}$，其中 $1\\,\\mathrm{mH}=10^{-3}\\,\\mathrm{E_h}$。将每个报告值四舍五入到六位小数。\n\n测试套件：\n- 使用基数 $n\\in\\{2,3,4\\}$ 生成输入，并使用 $n=3$ 和 $n=4$ 进行两点外推。\n- 对于每个测试用例 $t\\in\\{1,2,3\\}$ 和方法 $M\\in\\{\\text{MP2},\\text{CCSD}\\}$，给定物种 $X\\in\\{\\text{mol},A,B\\}$ 的完备基组相关能 $E_{\\mathrm{corr,CBS}}^{(M)}(X)$ 和基组族 $B\\in\\{\\text{conv},\\text{F12}\\}$ 的振幅 $A_X^{(M,B)}$。\n\n测试用例 1：\n- MP2:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(\\text{mol})=-0.300000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(A)=-0.120000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(B)=-0.170000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{conv})}=-0.0500\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{conv})}=-0.0180\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{conv})}=-0.0300\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{F12})}=-0.00500\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{F12})}=-0.00200\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{F12})}=-0.00250\\,\\mathrm{E_h}$。\n- CCSD:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(\\text{mol})=-0.325000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(A)=-0.130000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(B)=-0.185000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{conv})}=-0.0600\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{conv})}=-0.0220\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{conv})}=-0.0360\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{F12})}=-0.00600\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{F12})}=-0.00240\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{F12})}=-0.00320\\,\\mathrm{E_h}$。\n\n测试用例 2：\n- MP2:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(\\text{mol})=-0.520000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(A)=-0.250000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(B)=-0.250000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{conv})}=-0.0400\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{conv})}=-0.0150\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{conv})}=-0.0200\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{F12})}=-0.00400\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{F12})}=-0.00120\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{F12})}=-0.00260\\,\\mathrm{E_h}$。\n- CCSD:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(\\text{mol})=-0.560000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(A)=-0.270000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(B)=-0.270000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{conv})}=-0.0500\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{conv})}=-0.0170\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{conv})}=-0.0280\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{F12})}=-0.00500\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{F12})}=-0.00160\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{F12})}=-0.00310\\,\\mathrm{E_h}$。\n\n测试用例 3：\n- MP2:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(\\text{mol})=-0.210000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(A)=-0.100000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{MP2})}(B)=-0.109000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{conv})}=-0.0200\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{conv})}=-0.0090\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{conv})}=-0.0100\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{MP2},\\mathrm{F12})}=-0.00200\\,\\mathrm{E_h}$, $A_{A}^{(\\text{MP2},\\mathrm{F12})}=-0.00090\\,\\mathrm{E_h}$, $A_{B}^{(\\text{MP2},\\mathrm{F12})}=-0.00100\\,\\mathrm{E_h}$。\n- CCSD:\n  - $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(\\text{mol})=-0.240000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(A)=-0.120000\\,\\mathrm{E_h}$, $E_{\\mathrm{corr,CBS}}^{(\\text{CCSD})}(B)=-0.121000\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{conv})}=-0.0250\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{conv})}=-0.0110\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{conv})}=-0.0130\\,\\mathrm{E_h}$。\n  - $A_{\\text{mol}}^{(\\text{CCSD},\\mathrm{F12})}=-0.00250\\,\\mathrm{E_h}$, $A_{A}^{(\\text{CCSD},\\mathrm{F12})}=-0.00110\\,\\mathrm{E_h}$, $A_{B}^{(\\text{CCSD},\\mathrm{F12})}=-0.00130\\,\\mathrm{E_h}$。\n\n要求输出：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。\n- 对于每个测试用例，按 $t=1,2,3$ 的顺序，依次附加以下八个值，顺序必须完全一致：\n  1. MP2常规方法在 $n=3$ 时的绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  2. MP2 F12方法在 $n=3$ 时的绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  3. MP2常规方法使用 $n=3$ 和 $n=4$ 的两点外推绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  4. MP2 F12方法使用 $n=3$ 和 $n=4$ 的两点外推绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  5. CCSD常规方法在 $n=3$ 时的绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  6. CCSD F12方法在 $n=3$ 时的绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  7. CCSD常规方法使用 $n=3$ 和 $n=4$ 的两点外推绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n  8. CCSD F12方法使用 $n=3$ 和 $n=4$ 的两点外推绝对误差，单位为 $\\mathrm{mH}$，四舍五入到六位小数。\n- 因此，对于三个测试用例，最终输出将总共包含 $24$ 个值，例如格式为 $[\\dots]$。\n\n角度单位和百分比不适用。所有能量值必须按规定以 $\\mathrm{mH}$ 表示，并四舍五入到六位小数。", "solution": "问题陈述已经过严格评估，并被确定为 **有效**。这是一个适定的、有科学依据的计算练习，基于一个已建立但简化的量子化学基组收敛模型。该问题为获得唯一且有意义的解提供了所有必要的数据和定义。我们现在将进行形式推导和求解。\n\n该问题要求在指定模型的框架内分析相关能的基组收敛性。物种 $X$ (其中 $X \\in \\{\\text{mol}, A, B\\}$) 使用电子结构方法 $M$ ($M \\in \\{\\text{MP2}, \\text{CCSD}\\}$) 和基数为 $n$ 的基组族 $B$ ($B \\in \\{\\text{conv}, \\text{F12}\\}$) 计算的相关能 $E_{\\mathrm{corr}}^{(M,B)}(X;n)$ 的模型由下式给出：\n$$\nE_{\\mathrm{corr}}^{(M,B)}(X;n) \\;=\\; E_{\\mathrm{corr,CBS}}^{(M)}(X) \\;+\\; \\dfrac{A_X^{(M,B)}}{\\bigl(L(n)\\bigr)^{p_B}}\n$$\n此处，$E_{\\mathrm{corr,CBS}}^{(M)}(X)$ 是完备基组 (CBS) 极限下的精确相关能。$A_X^{(M,B)}$ 是一个依赖于体系和基组的振幅。函数 $L(n) = n+\\frac{1}{2}$ 定义了一个有效基数。指数 $p_B$ 决定了收敛速率，对于常规相关一致基组（例如 $\\mathrm{cc\\text{-}pV}n\\mathrm{Z}$）$p_{\\mathrm{conv}}=3$，而对于其显式相关的F12对应项（例如 $\\mathrm{cc\\text{-}pV}n\\mathrm{Z}\\text{-}\\mathrm{F12}$）$p_{\\mathrm{F12}}=7$。\n\n我们的主要研究对象是分子 $\\text{mol} \\rightarrow A+B$ 的原子化能的相关能贡献，其定义为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(M,B)}(n) \\;=\\; E_{\\mathrm{corr}}^{(M,B)}(\\text{mol};n)\\;-\\;\\Bigl(E_{\\mathrm{corr}}^{(M,B)}(A;n)+E_{\\mathrm{corr}}^{(M,B)}(B;n)\\Bigr)\n$$\n通过代入每一项的模型表达式，我们可以将 $\\Delta E_{\\mathrm{corr}}^{(M,B)}(n)$ 表示为其自身CBS极限和一个相应的基组不完备性误差项的函数。\n令 $\\Delta E_{\\mathrm{corr,CBS}}^{(M)}$ 为原子化能贡献的CBS极限：\n$$\n\\Delta E_{\\mathrm{corr,CBS}}^{(M)} \\;=\\; E_{\\mathrm{corr,CBS}}^{(M)}(\\text{mol}) \\;-\\; \\Bigl(E_{\\mathrm{corr,CBS}}^{(M)}(A)+E_{\\mathrm{corr,CBS}}^{(M)}(B)\\Bigr)\n$$\n将模型代入 $\\Delta E_{\\mathrm{corr}}^{(M,B)}(n)$ 的表达式中可得：\n$$\n\\Delta E_{\\mathrm{corr}}^{(M,B)}(n) \\;=\\; \\left( E_{\\mathrm{corr,CBS}}^{(M)}(\\text{mol}) + \\frac{A_{\\text{mol}}^{(M,B)}}{(L(n))^{p_B}} \\right) - \\left[ \\left( E_{\\mathrm{corr,CBS}}^{(M)}(A) + \\frac{A_A^{(M,B)}}{(L(n))^{p_B}} \\right) + \\left( E_{\\mathrm{corr,CBS}}^{(M)}(B) + \\frac{A_B^{(M,B)}}{(L(n))^{p_B}} \\right) \\right]\n$$\n通过将CBS项和依赖于基组的项分组，该表达式可简化为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(M,B)}(n) \\;=\\; \\Delta E_{\\mathrm{corr,CBS}}^{(M)} + \\frac{A_{\\text{mol}}^{(M,B)} - \\left(A_A^{(M,B)} + A_B^{(M,B)}\\right)}{\\left(L(n)\\right)^{p_B}}\n$$\n我们为原子化能定义一个有效振幅 $\\Delta A^{(M,B)} = A_{\\text{mol}}^{(M,B)} - A_A^{(M,B)} - A_B^{(M,B)}$。因此，原子化能贡献的模型为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(M,B)}(n) \\;=\\; \\Delta E_{\\mathrm{corr,CBS}}^{(M)} + \\frac{\\Delta A^{(M,B)}}{\\left(L(n)\\right)^{p_B}}\n$$\n\n第一个任务是对于常规和F12两种基组族，计算此量在三zeta水平 ($n=3$) 时相对于真实CBS极限的绝对误差。误差 $\\mathcal{E}_1(n)$ 定义为 $\\bigl|\\Delta E_{\\mathrm{corr}}^{(M,B)}(n)-\\Delta E_{\\mathrm{corr,CBS}}^{(M)}\\bigr|$。根据我们为 $\\Delta E_{\\mathrm{corr}}^{(M,B)}(n)$ 推导出的模型，此误差即为：\n$$\n\\mathcal{E}_1(n=3) = \\left| \\left( \\Delta E_{\\mathrm{corr,CBS}}^{(M)} + \\frac{\\Delta A^{(M,B)}}{(L(3))^{p_B}} \\right) - \\Delta E_{\\mathrm{corr,CBS}}^{(M)} \\right| = \\left| \\frac{\\Delta A^{(M,B)}}{(L(3))^{p_B}} \\right|\n$$\n给定 $L(3) = 3+\\frac{1}{2} = 3.5$，我们使用提供的振幅，为 $p_B=3$（常规）和 $p_B=7$（F12）计算此误差。\n\n第二个任务是确定基于基数 $n$ 和 $m$ 的计算所进行的两点CBS外推的误差。我们记 $E_k = \\Delta E_{\\mathrm{corr}}^{(M,B)}(k)$ 且 $E_{CBS} = \\Delta E_{\\mathrm{corr,CBS}}^{(M)}$。我们得到关于两个未知数 $E_{CBS}$ 和 $\\Delta A^{(M,B)}$ 的两个方程：\n$$\nE_n = E_{CBS} + \\frac{\\Delta A^{(M,B)}}{(L(n))^{p_B}} \\quad (1)\n$$\n$$\nE_m = E_{CBS} + \\frac{\\Delta A^{(M,B)}}{(L(m))^{p_B}} \\quad (2)\n$$\n为了找到外推的CBS能量 $E_{CBS}^{\\text{extrap}}$，我们消去 $\\Delta A^{(M,B)}$。从(1)式，我们有 $\\Delta A^{(M,B)} = (E_n - E_{CBS})(L(n))^{p_B}$。将其代入(2)式：\n$$\nE_m = E_{CBS} + (E_n - E_{CBS}) \\frac{(L(n))^{p_B}}{(L(m))^{p_B}}\n$$\n求解 $E_{CBS}$ (即我们的 $E_{CBS}^{\\text{extrap}}$):\n$$\nE_m (L(m))^{p_B} = E_{CBS}(L(m))^{p_B} + E_n (L(n))^{p_B} - E_{CBS}(L(n))^{p_B}\n$$\n$$\nE_{CBS}^{\\text{extrap}} = \\frac{E_m (L(m))^{p_B} - E_n(L(n))^{p_B}}{(L(m))^{p_B} - (L(n))^{p_B}}\n$$\n此处必须指出一个关键点。问题陈述指出，基础能量值 $E_n$ 和 $E_m$ 本身是使用“真实”参数 $\\Delta E_{\\mathrm{corr,CBS}}^{(M)}$ 和 $\\Delta A^{(M,B)}$ 从模型方程(1)和(2)生成的。如果我们将 $E_n$ 和 $E_m$ 的模型表达式代回到外推公式中，我们发现：\n$$\n\\text{Numerator} = \\left(\\Delta E_{\\mathrm{corr,CBS}}^{(M)} + \\frac{\\Delta A^{(M,B)}}{(L(m))^{p_B}}\\right)(L(m))^{p_B} - \\left(\\Delta E_{\\mathrm{corr,CBS}}^{(M)} + \\frac{\\Delta A^{(M,B)}}{(L(n))^{p_B}}\\right)(L(n))^{p_B}\n$$\n$$\n= \\left(\\Delta E_{\\mathrm{corr,CBS}}^{(M)}(L(m))^{p_B} + \\Delta A^{(M,B)}\\right) - \\left(\\Delta E_{\\mathrm{corr,CBS}}^{(M)}(L(n))^{p_B} + \\Delta A^{(M,B)}\\right)\n$$\n$$\n= \\Delta E_{\\mathrm{corr,CBS}}^{(M)} \\left( (L(m))^{p_B} - (L(n))^{p_B} \\right)\n$$\n将此分子除以分母 $(L(m))^{p_B} - (L(n))^{p_B}$，恰好得到 $\\Delta E_{\\mathrm{corr,CBS}}^{(M)}$。\n因此，外推的CBS能量与问题中给出的真实CBS极限完全相同。外推的绝对误差 $\\mathcal{E}_2 = |E_{CBS}^{\\text{extrap}} - \\Delta E_{\\mathrm{corr,CBS}}^{(M)}|$ 在解析上为零。\n这是问题构造的一个逻辑结果：对完全服从双参数模型的数据进行双参数拟合，必然会精确地恢复模型参数。除非存在数值浮点误差，否则误差为 $0$，而这种误差在要求的精度下可以忽略不计。\n\n因此，实现将为每种方法和基组族计算 $\\mathcal{E}_1(n=3)$，并对所有外推情况报告 $\\mathcal{E}_2=0$。所有结果将乘以 $1000$ 以毫哈特里 ($\\mathrm{mH}$) 为单位表示。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum chemistry basis set convergence problem.\n    \"\"\"\n    p_conv = 3\n    p_f12 = 7\n    m_to_h = 1000.0\n\n    test_cases = [\n        # Test Case 1\n        {\n            \"mp2\": {\n                \"cbs_energies\": {\"mol\": -0.300000, \"A\": -0.120000, \"B\": -0.170000},\n                \"conv_amps\": {\"mol\": -0.0500, \"A\": -0.0180, \"B\": -0.0300},\n                \"f12_amps\": {\"mol\": -0.00500, \"A\": -0.00200, \"B\": -0.00250}\n            },\n            \"ccsd\": {\n                \"cbs_energies\": {\"mol\": -0.325000, \"A\": -0.130000, \"B\": -0.185000},\n                \"conv_amps\": {\"mol\": -0.0600, \"A\": -0.0220, \"B\": -0.0360},\n                \"f12_amps\": {\"mol\": -0.00600, \"A\": -0.00240, \"B\": -0.00320}\n            }\n        },\n        # Test Case 2\n        {\n            \"mp2\": {\n                \"cbs_energies\": {\"mol\": -0.520000, \"A\": -0.250000, \"B\": -0.250000},\n                \"conv_amps\": {\"mol\": -0.0400, \"A\": -0.0150, \"B\": -0.0200},\n                \"f12_amps\": {\"mol\": -0.00400, \"A\": -0.00120, \"B\": -0.00260}\n            },\n            \"ccsd\": {\n                \"cbs_energies\": {\"mol\": -0.560000, \"A\": -0.270000, \"B\": -0.270000},\n                \"conv_amps\": {\"mol\": -0.0500, \"A\": -0.0170, \"B\": -0.0280},\n                \"f12_amps\": {\"mol\": -0.00500, \"A\": -0.00160, \"B\": -0.00310}\n            }\n        },\n        # Test Case 3\n        {\n            \"mp2\": {\n                \"cbs_energies\": {\"mol\": -0.210000, \"A\": -0.100000, \"B\": -0.109000},\n                \"conv_amps\": {\"mol\": -0.0200, \"A\": -0.0090, \"B\": -0.0100},\n                \"f12_amps\": {\"mol\": -0.00200, \"A\": -0.00090, \"B\": -0.00100}\n            },\n            \"ccsd\": {\n                \"cbs_energies\": {\"mol\": -0.240000, \"A\": -0.120000, \"B\": -0.121000},\n                \"conv_amps\": {\"mol\": -0.0250, \"A\": -0.0110, \"B\": -0.0130},\n                \"f12_amps\": {\"mol\": -0.00250, \"A\": -0.00110, \"B\": -0.00130}\n            }\n        }\n    ]\n\n    def L(n):\n        return n + 0.5\n\n    def calculate_errors_for_method(params):\n        \"\"\"\n        Calculates the four required error values for a given method (MP2 or CCSD).\n        \"\"\"\n        # Unpack parameters\n        cbs_energies = params[\"cbs_energies\"]\n        conv_amps = params[\"conv_amps\"]\n        f12_amps = params[\"f12_amps\"]\n        \n        # Calculate CBS atomization energy contribution\n        delta_e_cbs = cbs_energies[\"mol\"] - (cbs_energies[\"A\"] + cbs_energies[\"B\"])\n\n        # Calculations for conventional basis\n        delta_a_conv = conv_amps[\"mol\"] - (conv_amps[\"A\"] + conv_amps[\"B\"])\n        error_conv_n3 = abs(delta_a_conv / (L(3)**p_conv)) * m_to_h\n\n        # Calculations for F12 basis\n        delta_a_f12 = f12_amps[\"mol\"] - (f12_amps[\"A\"] + f12_amps[\"B\"])\n        error_f12_n3 = abs(delta_a_f12 / (L(3)**p_f12)) * m_to_h\n\n        # The extrapolation error is analytically zero as the data is generated from the model.\n        # However, we can compute it to demonstrate this.\n        def extrapolate(n, m, p, delta_e, delta_a):\n            e_n = delta_e + delta_a / (L(n)**p)\n            e_m = delta_e + delta_a / (L(m)**p)\n            Ln_p = L(n)**p\n            Lm_p = L(m)**p\n            e_cbs_extrap = (e_m * Lm_p - e_n * Ln_p) / (Lm_p - Ln_p)\n            return abs(e_cbs_extrap - delta_e) * m_to_h\n        \n        error_conv_xtrap = extrapolate(3, 4, p_conv, delta_e_cbs, delta_a_conv)\n        error_f12_xtrap = extrapolate(3, 4, p_f12, delta_e_cbs, delta_a_f12)\n        \n        return [\n            error_conv_n3, \n            error_f12_n3, \n            error_conv_xtrap, \n            error_f12_xtrap\n        ]\n\n    all_results = []\n    for case in test_cases:\n        mp2_results = calculate_errors_for_method(case[\"mp2\"])\n        ccsd_results = calculate_errors_for_method(case[\"ccsd\"])\n        all_results.extend(mp2_results)\n        all_results.extend(ccsd_results)\n    \n    # Format output as specified, rounding to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2891613"}, {"introduction": "尽管功能强大，但诸如CCSD(T)及其F12变体等高级量子化学方法并非严格变分，这意味着它们计算得到的能量不保证是真实基态能量的上限。本练习提供了一个极具说服力的反例：使用较小的F12优化基组的计算，反而得到了比使用较大传统基组的计算更低（且更准确）的能量。分析这个看似矛盾的结果 [@problem_id:2891519]，对于深入理解这些方法的理论特性、避免对计算结果的误读至关重要。", "problem": "考虑非相对论性 Born–Oppenheimer 近似下的氦原子。进行了两次相关能计算，它们仅在处理电子-电子尖点和轨道基组方面有所不同：\n\n- 传统的耦合簇单、双激发和微扰三激发 (CCSD(T)) 方法，使用相关一致性极化价层三泽塔轨道基组，记为 cc-pVTZ。\n- 使用显式相关 F12b 拟设（即，在波函数展开中包含一个 $f_{12}$ Slater 型联电子函数）的 CCSD(T) 方法，使用优化的 cc-pVDZ-F12 轨道基组，并结合一个足够大的互补辅助基组 (CABS) 用于恒等式分解步骤。\n\n两次计算均采用相同的冻芯设置，并将总电子能量评估为 Hartree–Fock 参考能量与后 Hartree–Fock 相关能分量之和。Rayleigh–Ritz 变分原理保证了在厄米哈密顿量的子空间中通过变分获得的定态解的上界，但截断的耦合簇方法和典型的显式相关实现都不是严格变分的，因为它们依赖于非厄米投影方程和其他近似。\n\n得到以下分量能量（单位为 Hartree）：\n- CCSD(T)/cc-pVTZ：$E_{\\mathrm{HF}} = -2.861679995$， $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.040454321$， $E_{(T)} = -0.000566812$。\n- CCSD(T)-F12b/cc-pVDZ-F12：$E_{\\mathrm{HF}} = -2.861594227$， $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.041002631$， $E_{(T)} = -0.000632955$。\n\n设常规情况和 F12 增强情况的总能量分别为 $E_{\\mathrm{conv}}(\\mathrm{VTZ})$ 和 $E_{\\mathrm{F12}}(\\mathrm{VDZ\\mbox{-}F12})$，定义为各分量之和。定义差值\n$$\\Delta E \\equiv E_{\\mathrm{F12}}(\\mathrm{VDZ\\mbox{-}F12}) - E_{\\mathrm{conv}}(\\mathrm{VTZ}).$$\n\n任务：\n1. 计算 $\\Delta E$（单位为毫哈特里），其中 $1$ 毫哈特里 $=$ $10^{-3}$ Hartree。\n2. 基于 Rayleigh–Ritz 变分原理和这些方法的形式结构，从（非）变分性的角度解释 $\\Delta E$ 的符号。\n\n将 $\\Delta E$ 的数值答案四舍五入到四位有效数字，并以毫哈特里为单位报告。用文字陈述你的解释，但最终答案必须仅为所要求的数值。", "solution": "我们从 Rayleigh–Ritz 变分原理开始，该原理指出，对于一个厄米哈密顿量 $\\hat{H}$ 和任意归一化的试探函数 $\\Psi$，其期望值 $E[\\Psi] = \\langle \\Psi | \\hat{H} | \\Psi \\rangle$ 满足 $E[\\Psi] \\ge E_{0}$，其中 $E_{0}$ 是精确的基态能量。截断的耦合簇单、双激发和微扰三激发 (CCSD(T)) 方法不提供严格的上界，因为它求解的是投影的、非厄米的振幅方程，而不是在线性子空间内最小化一个厄米算符的期望值。显式相关 F12 方法通过包含一个依赖于电子间距离 $r_{12}$ 的联电子函数 $f_{12}$（通常为 $\\exp(-\\gamma r_{12})$），并采用恒等式分解和互补辅助基组 (CABS) 近似，来改善基组收敛性。这些近似以及耦合簇方法的投影性质破坏了严格的变分上界特性。因此，即使两种方法都不能保证是精确能量的上界，使用 F12 的较小轨道基组也可能产生比不使用 F12 的较大轨道基组更低的总能量。\n\n我们得到了氦原子两次计算的分量能量：\n\n- 常规 CCSD(T)/cc-pVTZ：\n  - $E_{\\mathrm{HF}} = -2.861679995$，\n  - $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.040454321$，\n  - $E_{(T)} = -0.000566812$。\n\n- CCSD(T)-F12b/cc-pVDZ-F12：\n  - $E_{\\mathrm{HF}} = -2.861594227$，\n  - $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.041002631$，\n  - $E_{(T)} = -0.000632955$。\n\n首先，计算常规方法的总能量：\n\n$$\nE_{\\mathrm{conv}}(\\mathrm{VTZ}) \\;=\\; E_{\\mathrm{HF}} + E_{\\mathrm{corr}}^{\\mathrm{CCSD}} + E_{(T)}\n\\;=\\; (-2.861679995) + (-0.040454321) + (-0.000566812).\n$$\n\n合并两个相关能贡献：\n\n$$\n-0.040454321 + (-0.000566812) \\;=\\; -0.041021133.\n$$\n\n加到 Hartree–Fock 能量上：\n\n$$\nE_{\\mathrm{conv}}(\\mathrm{VTZ}) \\;=\\; -2.861679995 + (-0.041021133) \\;=\\; -2.902701128.\n$$\n\n\n接下来，计算 F12 方法的总能量：\n\n$$\nE_{\\mathrm{F12}}(\\mathrm{VDZ\\mbox{-}F12}) \\;=\\; (-2.861594227) + (-0.041002631) + (-0.000632955).\n$$\n\n合并两个相关能贡献：\n\n$$\n-0.041002631 + (-0.000632955) \\;=\\; -0.041635586.\n$$\n\n加到 Hartree–Fock 能量上：\n\n$$\nE_{\\mathrm{F12}}(\\mathrm{VDZ\\mbox{-}F12}) \\;=\\; -2.861594227 + (-0.041635586) \\;=\\; -2.903229813.\n$$\n\n\n现在计算差值：\n\n$$\n\\Delta E \\equiv E_{\\mathrm{F12}}(\\mathrm{VDZ\\mbox{-}F12}) - E_{\\mathrm{conv}}(\\mathrm{VTZ})\n\\;=\\; (-2.903229813) - (-2.902701128) \\;=\\; -0.000528685 \\;\\text{Hartree}.\n$$\n\n使用 $1$ 毫哈特里 $= 10^{-3}$ Hartree 转换为毫哈特里：\n\n$$\n\\Delta E \\;=\\; -0.000528685 \\times 10^{3} \\;=\\; -0.528685 \\;\\text{毫哈特里}.\n$$\n\n四舍五入到四位有效数字：\n\n$$\n\\Delta E \\approx -0.5287 \\;\\text{毫哈特里}.\n$$\n\n\n解释：负号，即 $\\Delta E  0$，表明使用较小基组的显式相关计算得出的总能量比使用较大基组的常规计算更低（更负）。这并不与 Rayleigh–Ritz 变分原理相矛盾，因为无论是截断的 CCSD(T) 还是带有恒等式分解和 CABS 近似的 F12 增强方法都不是严格变分的；其投影、非厄米的特性以及额外的近似允许得到的能量在给定轨道基组内不保证是上界。显式相关拟设加速了基组收敛，在实践中可以超越更大的常规基组，这为随着基组增大而单调变分收敛的朴素期望提供了一个具体的反例。", "answer": "$$\\boxed{-0.5287}$$", "id": "2891519"}]}