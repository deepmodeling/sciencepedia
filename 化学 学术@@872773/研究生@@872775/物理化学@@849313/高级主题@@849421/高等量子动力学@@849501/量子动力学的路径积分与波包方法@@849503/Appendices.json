{"hands_on_practices": [{"introduction": "为在路径积分形式论方面打下坚实基础，第一个实践将引导您完成一项必要的解析推导。通过计算量子谐振子的精确虚时密度矩阵，您将看到离散化的路径积分在取连续极限后，如何重现基于算符的量子力学中的一个著名结果。这项练习 [@problem_id:2658894] 不仅展示了路径积分方法的威力，也为验证数值算法提供了一个关键的基准。", "problem": "考虑一个质量为 $m$、角频率为 $\\omega$、处于逆温度 $\\beta$ 下的一维量子谐振子。其虚时（$\\tau$）密度矩阵 $\\rho(x,x';\\beta)$ 可由路径积分表示，该积分遍及满足 $x(0)=x$ 和 $x(\\beta \\hbar)=x'$ 的轨迹 $x(\\tau)$。使用 Feynman–Kac 表示，并结合将时间剖分为 $N$ 个宽度为 $\\Delta \\tau = \\beta \\hbar / N$ 的时间片的 Trotter 分解，写出在谐振子势 $V(x)=\\frac{1}{2} m \\omega^{2} x^{2}$ 下 $\\rho(x,x';\\beta)$ 的 $N$-珠离散化路径积分。然后，通过将珠坐标中的二次型变换为经典环状聚合物的简正模（即离散傅里叶模），显式地计算得到的高斯积分，从而获得 $N$-时间片近似 $\\rho_{N}(x,x';\\beta)$ 的闭合形式。最后，取极限 $N \\to \\infty$ 得到精确的虚时谐振子密度矩阵 $\\rho(x,x';\\beta)$，并验证其与算符理论的精确结果一致。将您的最终答案表示为包含 $m$、$\\omega$、$\\hbar$、$\\beta$、$x$ 和 $x'$ 的单个闭合形式解析表达式。最终表达式中不需要进行数值取整，也无需报告单位。", "solution": "本问题要求使用离散化路径积分形式推导一维量子谐振子的虚时密度矩阵。推导过程必须经过 Trotter 分解、变换到简正模、计算得到的高斯积分以及取连续极限。\n\n设系统为一个质量为 $m$ 的粒子，处在谐振子势 $V(x) = \\frac{1}{2}m\\omega^2x^2$ 中。在逆温度 $\\beta$ 下，虚时密度矩阵由虚时 $\\tau = it$ 中的演化算符的矩阵元给出：\n$$\n\\rho(x, x'; \\beta) = \\langle x' | \\exp(-\\beta \\hat{H}) | x \\rangle\n$$\n其中 $\\hat{H} = \\frac{\\hat{p}^2}{2m} + V(\\hat{x})$ 是哈密顿量。为简化符号，我们在中间步骤中设 $\\hbar=1$，并将在最终结果中恢复它。总的虚时长度为 $\\beta$。\n\n我们将虚时区间 $[0, \\beta]$ 离散化为 $N$ 个时间片，每个时间片时长为 $\\Delta\\tau = \\beta/N$。使用 Trotter-Suzuki 公式，我们可以写出：\n$$\n\\exp(-\\beta \\hat{H}) = \\left( e^{-\\frac{\\Delta\\tau}{2} V(\\hat{x})} e^{-\\Delta\\tau \\frac{\\hat{p}^2}{2m}} e^{-\\frac{\\Delta\\tau}{2} V(\\hat{x})} \\right)^N + \\mathcal{O}((\\Delta\\tau)^3)\n$$\n在每个因子之间插入恒等算符的分解式 $\\int dx_k |x_k\\rangle\\langle x_k| = 1$，我们得到密度矩阵的离散化路径积分表示：\n$$\n\\rho_N(x, x'; \\beta) = \\int dx_1 \\dots \\int dx_{N-1} \\prod_{k=1}^N \\langle x_k | e^{-\\frac{\\Delta\\tau}{2} V} e^{-\\Delta\\tau \\frac{\\hat{p}^2}{2m}} e^{-\\frac{\\Delta\\tau}{2} V} | x_{k-1} \\rangle\n$$\n边界条件为 $x_0 = x$ 和 $x_N = x'$。单个时间步的核函数为：\n$$\n\\langle x_k | e^{-\\frac{\\Delta\\tau}{2} V} e^{-\\Delta\\tau \\frac{\\hat{p}^2}{2m}} e^{-\\frac{\\Delta\\tau}{2} V} | x_{k-1} \\rangle = \\exp\\left(-\\frac{\\Delta\\tau}{2}(V(x_k)+V(x_{k-1}))\\right) \\langle x_k | e^{-\\Delta\\tau \\frac{\\hat{p}^2}{2m}} | x_{k-1} \\rangle\n$$\n自由粒子核函数是一个高斯函数：\n$$\n\\langle x_k | e^{-\\Delta\\tau \\frac{\\hat{p}^2}{2m}} | x_{k-1} \\rangle = \\sqrt{\\frac{m}{2\\pi\\Delta\\tau}} \\exp\\left(-\\frac{m}{2\\Delta\\tau}(x_k-x_{k-1})^2\\right)\n$$\n结合这些结果，$N$-时间片近似的密度矩阵为：\n$$\n\\rho_N(x, x'; \\beta) = \\left(\\frac{m}{2\\pi\\Delta\\tau}\\right)^{N/2} \\int dx_1 \\dots dx_{N-1} \\exp(-S_N[x_0, \\dots, x_N])\n$$\n其中 $S_N$ 是离散化的欧几里得作用量。采用对称势能分裂（中点规则），作用量为：\n$$\nS_N = \\sum_{k=1}^N \\left[ \\frac{m}{2\\Delta\\tau}(x_k-x_{k-1})^2 + \\frac{\\Delta\\tau}{2} \\frac{m\\omega^2}{2} (x_k^2+x_{k-1}^2) \\right]\n$$\n对于势能项，这可以更对称地重写为 $\\Delta\\tau (\\frac{1}{2}V(x_0) + \\sum_{k=1}^{N-1}V(x_k) + \\frac{1}{2}V(x_N))$。我们将作用量写成积分变量 $y_k = x_k$（其中 $k=1, \\dots, N-1$）的二次型。\n指数的宗量为：\n$$\n-S_N = -\\frac{1}{2}\\mathbf{y}^T \\mathbf{A} \\mathbf{y} + \\mathbf{b}^T \\mathbf{y} - C\n$$\n其中 $\\mathbf{y} = (x_1, \\dots, x_{N-1})^T$。矩阵 $\\mathbf{A}$ 是一个 $(N-1) \\times (N-1)$ 的对称三对角矩阵，其元素为：\n$$\nA_{jj} = \\frac{2m}{\\Delta\\tau} + m\\omega^2\\Delta\\tau\n$$\n$$\nA_{j, j\\pm 1} = -\\frac{m}{\\Delta\\tau}\n$$\n向量 $\\mathbf{b}$ 来自与固定端点 $x_0=x$ 和 $x_N=x'$ 耦合的项：\n$$\n\\mathbf{b} = \\left(\\frac{m}{\\Delta\\tau}x, 0, \\dots, 0, \\frac{m}{\\Delta\\tau}x'\\right)^T\n$$\n常数项 $C$ 包含仅依赖于端点的项：\n$$\nC = \\frac{m}{2\\Delta\\tau}(x^2+x'^2) + \\frac{m\\omega^2\\Delta\\tau}{4}(x^2+x'^2)\n$$\n该积分为标准的多维高斯积分：\n$$\n\\int d^{N-1}\\mathbf{y} \\exp\\left(-\\frac{1}{2}\\mathbf{y}^T \\mathbf{A} \\mathbf{y} + \\mathbf{b}^T \\mathbf{y}\\right) = (2\\pi)^{(N-1)/2}(\\det \\mathbf{A})^{-1/2} \\exp\\left(\\frac{1}{2}\\mathbf{b}^T \\mathbf{A}^{-1} \\mathbf{b}\\right)\n$$\n问题现在简化为求 $\\mathbf{A}$ 的行列式和逆。最好的方法是对角化 $\\mathbf{A}$。该矩阵的归一化特征向量由离散正弦变换给出：\n$$\nv_p(k) = \\sqrt{\\frac{2}{N}} \\sin\\left(\\frac{pk\\pi}{N}\\right), \\quad p, k \\in \\{1, \\dots, N-1\\}\n$$\n相应的特征值 $\\lambda_p$ 为：\n$$\n\\lambda_p = \\frac{2m}{\\Delta\\tau} + m\\omega^2\\Delta\\tau - 2\\frac{m}{\\Delta\\tau}\\cos\\left(\\frac{p\\pi}{N}\\right) = \\frac{4m}{\\Delta\\tau}\\sin^2\\left(\\frac{p\\pi}{2N}\\right) + m\\omega^2\\Delta\\tau\n$$\n积分分解为关于简正模振幅的一维积分的乘积。结果由一个涨落前因子 $F_N$ 和一个依赖于边界条件的指数项组成。\n\n前因子由涨落行列式给出：\n$$\nF_N(\\beta) = \\left(\\frac{m}{2\\pi\\Delta\\tau}\\right)^{N/2} (2\\pi)^{(N-1)/2} (\\det \\mathbf{A})^{-1/2} = \\left(\\frac{m}{2\\pi\\Delta\\tau}\\right)^{1/2} \\left( \\prod_{p=1}^{N-1} \\lambda_p \\right)^{-1/2} \\left(\\frac{m}{\\Delta\\tau}\\right)^{(N-1)/2}\n$$\n行列式可以通过递推关系法求得，结果为 $\\det \\mathbf{A} = (\\frac{m}{\\Delta\\tau})^{N-1} \\frac{\\sinh(N\\alpha_{ho})}{\\sinh(\\alpha_{ho})}$，其中 $\\cosh(\\alpha_{ho}) = 1 + \\frac{(\\omega\\Delta\\tau)^2}{2}$。\n在极限 $N\\to\\infty$ 下，$\\Delta\\tau=\\beta/N\\to 0$，我们有 $\\alpha_{ho} \\approx \\omega\\Delta\\tau$。\n前因子变为：\n$$\n\\lim_{N\\to\\infty} F_N(\\beta) = \\sqrt{\\frac{m}{2\\pi\\beta}} \\left( \\frac{\\omega\\beta}{\\sinh(\\omega\\beta)} \\right)^{1/2} = \\sqrt{\\frac{m\\omega}{2\\pi\\sinh(\\omega\\beta)}}\n$$\n重新引入 $\\hbar$ 后：\n$$\nF(\\beta) = \\sqrt{\\frac{m\\omega}{2\\pi\\hbar\\sinh(\\omega\\beta\\hbar)}}\n$$\n指数部分 $\\exp(-C + \\frac{1}{2}\\mathbf{b}^T \\mathbf{A}^{-1} \\mathbf{b})$ 可以被计算，但从概念上更清晰、计算上更简单的方法是认识到，对于二次型作用量，路径积分恰好由经典作用量的贡献和涨落因子给出。\n$$\n\\rho(x, x'; \\beta) = F(\\beta) \\exp(-S_{cl}/\\hbar)\n$$\n其中 $S_{cl}$ 是沿作用量极值路径（满足边界条件）计算的经典欧几里得作用量。欧几里得运动方程为 $m\\frac{d^2x}{d\\tau^2} = m\\omega^2 x$。满足 $x(0)=x$ 和 $x(\\beta\\hbar)=x'$ 的解是：\n$$\nx_{cl}(\\tau) = \\frac{x\\sinh(\\omega(\\beta\\hbar-\\tau)) + x'\\sinh(\\omega\\tau)}{\\sinh(\\omega\\beta\\hbar)}\n$$\n经典作用量为 $$S_{cl} = \\int_0^{\\beta\\hbar} d\\tau \\left[ \\frac{1}{2}m\\dot{x}_{cl}^2 + \\frac{1}{2}m\\omega^2x_{cl}^2 \\right]$$。使用分部积分和运动方程，这可以简化为：\n$$\nS_{cl} = \\frac{1}{2}m \\left[ x_{cl}(\\tau)\\dot{x}_{cl}(\\tau) \\right]_0^{\\beta\\hbar}\n$$\n计算导数 $\\dot{x}_{cl}(0)$ 和 $\\dot{x}_{cl}(\\beta\\hbar)$：\n$$\n\\dot{x}_{cl}(0) = \\frac{-x\\omega\\cosh(\\omega\\beta\\hbar) + x'\\omega}{\\sinh(\\omega\\beta\\hbar)}\n$$\n$$\n\\dot{x}_{cl}(\\beta\\hbar) = \\frac{-x\\omega + x'\\omega\\cosh(\\omega\\beta\\hbar)}{\\sinh(\\omega\\beta\\hbar)}\n$$\n将这些代入 $S_{cl}$ 的表达式：\n$$\nS_{cl} = \\frac{m}{2} \\left[ x' \\dot{x}_{cl}(\\beta\\hbar) - x \\dot{x}_{cl}(0) \\right] = \\frac{m\\omega}{2\\sinh(\\omega\\beta\\hbar)} \\left[ (x^2+x'^2)\\cosh(\\omega\\beta\\hbar) - 2xx' \\right]\n$$\n结合前因子 $F(\\beta)$ 和经典作用量项 $\\exp(-S_{cl}/\\hbar)$，得到密度矩阵的最终表达式：\n$$\n\\rho(x,x';\\beta) = \\sqrt{\\frac{m\\omega}{2\\pi\\hbar\\sinh(\\omega\\beta\\hbar)}} \\exp\\left\\{ -\\frac{m\\omega}{2\\hbar\\sinh(\\omega\\beta\\hbar)} \\left[ (x^2+x'^2)\\cosh(\\omega\\beta\\hbar) - 2xx' \\right] \\right\\}\n$$\n这个结果被称为谐振子热核的 Mehler 公式。可以通过将实时传播子 $K(x', t; x, 0)$ 解析延拓到虚时 $t = -i\\beta\\hbar$，与算符力学中的著名结果进行比对验证。两者完全一致，这证实了我们路径积分计算的有效性。", "answer": "$$\n\\boxed{\\sqrt{\\frac{m\\omega}{2\\pi\\hbar\\sinh(\\omega\\beta\\hbar)}} \\exp\\left(-\\frac{m\\omega}{2\\hbar\\sinh(\\omega\\beta\\hbar)} \\left[ (x^2+x'^2)\\cosh(\\omega\\beta\\hbar) - 2xx' \\right]\\right)}\n$$", "id": "2658894"}, {"introduction": "虽然解析解非常宝贵，但路径积分在现实世界中的大多数应用都依赖于会引入离散化误差的数值模拟。本实践聚焦于路径积分蒙特卡洛（PIMC）模拟中的主要误差来源：由近似玻尔兹曼算符而产生的Trotter误差。您将分析该误差如何随路径积分“珠子”数量（$P$）的变化而缩放，并学习如何利用这种缩放行为通过系统性外推得到精确的量子极限 [@problem_id:2658892]，这是获得高精度结果的一项关键技术。", "problem": "考虑一个质量为 $m$ 的一维量子粒子，在逆温度 $\\beta$ 下处于非谐势 $V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}+\\alpha x^{4}$ 中。势能的精确量子热平均为 $\\langle V\\rangle=\\operatorname{Tr}\\left(\\hat{\\rho}_{\\beta}\\,\\hat{V}\\right)$，其中 $\\hat{\\rho}_{\\beta}=e^{-\\beta \\hat{H}}/Z$ 且 $\\hat{H}=\\hat{T}+\\hat{V}$。在标准的虚时路径积分表示中，使用二阶 Trotter 分解，通过具有 $P$ 个复制品（“珠子”）的环状聚合物离散化来近似 $e^{-\\beta \\hat{H}}$，并通过从环状聚合物分布中采样的 $V$ 的珠子平均来估计 $\\langle V\\rangle$；将此估计量记为 $\\langle V\\rangle_{P}$。假设 $V(x)$ 足够光滑，使得 Baker–Campbell–Hausdorff 展开所需的所有对易子都存在且有界，并考虑在固定 $\\beta$ 的情况下 $P\\to\\infty$。\n\n关于 $\\langle V\\rangle_{P}$ 中的有限珠子偏差和一个实用的 $P\\to\\infty$ 外推策略，以下哪项陈述是正确的？\n\nA. 对于原始的二阶 Trotter 分解，在固定 $\\beta$ 时，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-1}\\right)$。因此，一个关于 $1/P$ 线性的两点 Richardson 外推 $\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\left(\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}\\right)$ 是渐近无偏的。\n\nB. 对于原始的二阶 Trotter 分解，在固定 $\\beta$ 时，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-2}\\right)$。因此，一个关于 $1/P^{2}$ 线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{2}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{3}$ 是渐近无偏的。\n\nC. 对于任何凸非谐势 $V(x)$，$\\langle V\\rangle_{P}$ 中领头偏差项的系数普遍为正，这意味着对于所有 $P$，$\\langle V\\rangle_{P}\\ge \\langle V\\rangle$，所以 $\\langle V\\rangle_{P}$ 是一个关于 $P$ 的单调递减序列，不需要进行外推。\n\nD. 如果采用 Takahashi–Imada (TI) 高阶分解，即使用一个包含基于 $[V,[T,V]]$ 的对易子修正的有效势进行采样，并对 $V$ 使用一致的对角估计量，那么在固定 $\\beta$ 时，$\\langle V\\rangle_{P}$ 中的领头偏差标度为 $O\\!\\left(P^{-4}\\right)$。因此，一个关于 $1/P^{4}$ 线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{4}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{15}$ 是渐近无偏且更有效率的。\n\nE. 对于任何非谐势，使用势能的质心维里估计量可以消除所有 Trotter 离散化偏差，使得对于任何有限的 $P$，都有 $\\langle V\\rangle_{P}=\\langle V\\rangle$。\n\n选择所有适用项。", "solution": "问题陈述描述了使用具有有限数量珠子 $P$ 的虚时路径积分形式，为一个处于非谐势中的一维粒子计算势能的热期望值 $\\langle V \\rangle$。问题的核心在于分析由玻尔兹曼算符 $e^{-\\beta \\hat{H}}$ 的二阶 Trotter 分解所产生的离散化误差或偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$。\n\n首先，我们建立理论基础。精确的量子统计配分函数为 $Z = \\operatorname{Tr}(e^{-\\beta \\hat{H}})$，其中哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V}$，$\\hat{T}=\\hat{p}^2/(2m)$ 且 $\\hat{V}=V(\\hat{x})$。势能的期望值为 $\\langle V \\rangle = \\operatorname{Tr}(\\hat{V} e^{-\\beta \\hat{H}}) / Z$。\n\n在路径积分表述中，玻尔兹曼算符 $e^{-\\beta \\hat{H}}$ 被离散化为 $P$ 个虚时小步长 $\\tau = \\beta/P$。问题指定了二阶 Trotter 分解，它是对称的：\n$$e^{-\\tau \\hat{H}} \\approx e^{-\\tau \\hat{V}/2} e^{-\\tau \\hat{T}} e^{-\\tau \\hat{V}/2}$$\n完整算符的近似为 $(e^{-\\tau \\hat{V}/2} e^{-\\tau \\hat{T}} e^{-\\tau \\hat{V}/2})^P$。这为离散化系统定义了一个有效哈密顿量，其性质在 $P \\to \\infty$ 时收敛于精确的量子系统。\n\n问题陈述指出 $\\langle V \\rangle$ 是通过 $V$ 的珠子平均来估计的，这是一种原始或对角估计量：\n$$\\langle V \\rangle_P = \\left\\langle \\frac{1}{P} \\sum_{j=1}^P V(x_j) \\right\\rangle_P$$\n其中平均 $\\langle \\dots \\rangle_P$ 是对与从二阶 Trotter 公式导出的离散化环状聚合物作用量相对应的玻尔兹曼分布进行的。\n\n对于使用有限数量珠子 $P$ 计算的算符期望值，其误差或偏差 $\\delta_P = \\langle V \\rangle_P - \\langle V \\rangle$ 可以使用 Baker-Campbell-Hausdorff 展开或路径积分误差分析来导出。对于一个仅依赖于位置的一般算符 $\\hat{A} = A(\\hat{x})$，其使用原始估计量和二阶 Trotter 方案计算的期望值，其领头阶误差由下式给出：\n$$\\langle A \\rangle_P - \\langle A \\rangle = -\\frac{\\beta^2 \\hbar^2}{24 m P^2} \\left\\langle \\frac{dA}{dx} \\frac{dV}{dx} \\right\\rangle + O(P^{-4})$$\n在我们的具体案例中，我们感兴趣的算符是势能本身，所以 $\\hat{A} = \\hat{V}$。因此，我们有 $A(x) = V(x)$ 和 $dA/dx = V'(x)$。势能估计量的偏差为：\n$$\\delta_P = \\langle V \\rangle_P - \\langle V \\rangle = -\\frac{\\beta^2 \\hbar^2}{24 m P^2} \\langle (V'(x))^2 \\rangle + O(P^{-4})$$\n这个基本结果展示了两个关键性质：\n1.  领头误差项随 $P$ 的标度为 $O(P^{-2})$。\n2.  $P^{-2}$ 项的系数为负，因为 $\\beta$、$\\hbar$、$m$ 是正常数，且期望值 $\\langle (V'(x))^2 \\rangle$ 必须为非负（对于任何非平庸势和物理态，它都是严格为正的）。\n\n这种误差标度意味着对于大的 $P$，期望值可以写成 $1/P^2$ 的展开式：\n$$\\langle V \\rangle_P = \\langle V \\rangle_\\infty + \\frac{c_2}{P^2} + \\frac{c_4}{P^4} + \\dots$$\n其中 $\\langle V \\rangle_\\infty$ 是精确的量子值 $\\langle V \\rangle$。这种正则误差展开允许使用 Richardson 外推来加速向 $P \\to \\infty$ 极限的收敛。对于一个以 $P^{-2}$ 的幂次表示的误差级数，使用 $P$ 和 $2P$ 个珠子的模拟结果进行的两点外推由下式给出：\n$$A_\\infty \\approx A_{2P} + \\frac{A_{2P}-A_P}{2^n-1}$$\n其中 $n=2$ 是领头误差项的阶数。\n\n在此基础上，我们评估每个陈述。\n\n**A. 对于原始的二阶 Trotter 分解，在固定 $\\beta$ 时，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-1}\\right)$。因此，一个关于 $1/P$ 线性的两点 Richardson 外推 $\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\left(\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}\\right)$ 是渐近无偏的。**\n这个陈述是 **不正确的**。正如所导出的，二阶 Trotter 分解的偏差标度为 $O(P^{-2})$，而不是 $O(P^{-1})$。$O(P^{-1})$ 的标度是一阶（原始）Trotter 分解 $e^{-\\tau\\hat{H}} \\approx e^{-\\tau\\hat{T}}e^{-\\tau\\hat{V}}$ 的特征。虽然给定的外推公式对于 $O(P^{-1})$ 误差是正确的，但对于指定的方法，其标度的前提是错误的。\n\n**B. 对于原始的二阶 Trotter 分解，在固定 $\\beta$ 时，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-2}\\right)$。因此，一个关于 $1/P^{2}$ 线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{2}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{3}$ 是渐近无偏的。**\n这个陈述是 **正确的**。我们已经证明，偏差的标度确实是 $O(P^{-2})$。对于阶数 $n=2$ 的误差，Richardson 外推公式为 $\\langle V \\rangle_\\infty \\approx \\langle V \\rangle_{2P} + (\\langle V \\rangle_{2P} - \\langle V \\rangle_{P})/(2^2-1)$，这可以简化为给定的表达式。误差标度和外推公式都是正确的。\n\n**C. 对于任何凸非谐势 $V(x)$，$\\langle V\\rangle_{P}$ 中领头偏差项的系数普遍为正，这意味着对于所有 $P$，$\\langle V\\rangle_{P}\\ge \\langle V\\rangle$，所以 $\\langle V\\rangle_{P}$ 是一个关于 $P$ 的单调递减序列，不需要进行外推。**\n这个陈述是 **不正确的**。领头偏差项的系数与 $-\\langle (V'(x))^2 \\rangle$ 成正比。由于 $\\langle (V'(x))^2 \\rangle  0$，该系数普遍为*负*。这意味着对于大的 $P$，$\\langle V \\rangle_P \\le \\langle V \\rangle$，并且序列 $\\langle V\\rangle_P$ 从下方趋近精确结果，即它是一个关于 $P$ 的单调*递增*序列。此外，即使它是一个单调序列，外推仍然是一种非常有价值的标准技术，可以从有限 $P$ 的计算中获得更准确的 $P\\to\\infty$ 极限估计。\n\n**D. 如果采用 Takahashi–Imada (TI) 高阶分解，即使用一个包含基于 $[V,[T,V]]$ 的对易子修正的有效势进行采样，并对 $V$ 使用一致的对角估计量，那么在固定 $\\beta$ 时，$\\langle V\\rangle_{P}$ 中的领头偏差标度为 $O\\!\\left(P^{-4}\\right)$。因此，一个关于 $1/P^{4}$ 线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{4}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{15}$ 是渐近无偏且更有效率的。**\n这个陈述是 **正确的**。Takahashi-Imada 分解是一种著名的高阶方法，专门用于消除路径积分中的 $O(P^{-2})$ 误差项。它通过引入一个修正势来实现这一点，该修正势包含与 $(V'(x))^2$ 成比例的修正项。当从由该修正势生成的分布中采样，并对原始势能使用一致的估计量时，期望值的误差确实标度为 $O(P^{-4})$。对应的阶数 $n=4$ 误差的 Richardson 外推公式需要一个分母 $2^4-1=15$，这与提供的公式相符。这种更快的收敛速度使得计算效率显著提高，因为可以用较小的 $P$ 达到更高的精度。\n\n**E. 对于任何非谐势，使用势能的质心维里估计量可以消除所有 Trotter 离散化偏差，使得对于任何有限的 $P$，都有 $\\langle V\\rangle_{P}=\\langle V\\rangle$。**\n这个陈述是 **不正确的**。这个说法太过绝对了。虽然在*谐*势中，某些可观测量（observable）的特定估计量可能没有离散化误差（因为谐振子的路径积分可以精确求解），但这对于一般的*非谐*势（如此处给出的势）是不成立的。Trotter 离散化是一种近似，对于一般势，有限 $P$ 的计算总会存在残余误差，该误差仅在 $P \\to \\infty$ 的极限下才消失。对于任何有限的 $P$，没有已知的势能估计量可以消除*任何*非谐势的这种误差。质心维里估计量是一个强大的工具，尤其对于动能而言，但对于一般非谐系统中的势能，它并不具备如此神奇的性质。", "answer": "$$\\boxed{BD}$$", "id": "2658892"}, {"introduction": "从用于平衡性质的虚时路径积分转向实时量子动力学，本实践将介绍波包传播的核心方法：分裂算符FFT法。您将实现并比较两种不同的二阶格式，用以求解具有显式含时哈密顿量的时间相关薛定谔方程。这项计算练习 [@problem_id:2658913] 提供了处理由外场驱动的量子系统模拟中所面临的挑战和细微之处的直接经验。", "problem": "考虑一个质量为 $m$ 的一维粒子在含时势 $V(x,t)$ 中的含时薛定谔方程，该方程以 $\\hbar = 1$ 和 $m = 1$ 的无量纲单位表示：\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x,t)\\right] \\psi(x,t).\n$$\n您的任务是构建一个程序，使用两种适用于含时势的二阶时间演化算符分解方法（分裂算符法），在均匀空间网格上将初始波包传播一个时间步长 $\\Delta t$，并量化每种格式相对于高保真度参考的单步误差。需要实现的两种格式是：\n\n- 在中点时刻 $t + \\Delta t/2$ 对势进行采样的对称中点分裂格式。\n\n- 在初始时刻 $t$ 和最终时刻 $t + \\Delta t$ 对势进行采样的对称踢-漂移-踢（KDK）格式。\n\n请使用以下具有物理动机且数值稳定的要素，所有要素均采用相同的无量纲单位：\n\n- 空间网格：一个长度为 $L$ 的周期性区域，用 $N$ 个点进行离散化。使用 $N = 512$ 和 $L = 50$。\n\n- 波矢网格：定义与所选 $L$ 和 $N$ 一致的离散傅里叶模式 $k$，并在谱空间中实现动能演化。\n\n- 势：\n$$\nV(x,t) \\;=\\; \\frac{1}{2}\\,\\omega^2\\,x^2 \\;+\\; A\\,x\\,\\cos(\\Omega\\,t),\n$$\n其中 $\\omega$ 是静态谐振频率，$A$ 是驱动振幅，$\\Omega$ 是驱动频率。\n\n- $t_0$ 时刻的初始波包：\n$$\n\\psi(x,t_0) \\;=\\; \\left(\\pi \\sigma^2\\right)^{-1/4} \\exp\\!\\left[-\\frac{(x-x_0)^2}{2\\sigma^2} + \\mathrm{i}\\,p_0\\,(x - x_0)\\right],\n$$\n其中 $x_0 = 0$，$p_0 = 0$，$\\sigma = 1$。确保在网格上数值归一化 $\\int |\\psi(x,t_0)|^2\\,dx = 1$ 成立。\n\n需要实现的两种单步二阶传播子是：\n\n- 中点分裂（对势使用中点时刻 $t+\\Delta t/2$）：\n  1. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t/2)\\right]$。\n  2. 在傅里叶空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\Delta t\\,\\frac{k^2}{2}\\right]$（动能步）。\n  3. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t/2)\\right]$。\n\n- 踢-漂移-踢（对势使用端点时刻 $t$ 和 $t+\\Delta t$）：\n  1. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t)\\right]$。\n  2. 在傅里叶空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\Delta t\\,\\frac{k^2}{2}\\right]$（动能步）。\n  3. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t)\\right]$。\n\n作为高保真度的单步参考，通过将时间间隔 $\\Delta t$ 细分为 $n$ 个大小为 $\\delta t = \\Delta t/n$ 的相等子步，并在每个子步应用踢-漂移-踢格式来近似时间排序指数。为减小残余的二阶子步误差，应用理查森外推法 (Richardson extrapolation)：用 $n$ 和 $2n$ 个子步计算两个参考末态，并将其组合为\n$$\n\\psi_{\\mathrm{ref}} \\;\\approx\\; \\frac{4\\,\\psi_{2n} - \\psi_{n}}{3}.\n$$\n在计算误差之前，将 $\\psi_{\\mathrm{ref}}$ 和每个测试格式的输出归一化为单位范数，并通过内积 $\\langle \\psi_{\\mathrm{ref}}\\mid \\psi\\rangle$ 的相位将每个传播后的态 $\\psi$ 与 $\\psi_{\\mathrm{ref}}$ 对齐，以消除任何全局相位。\n\n将传播后状态 $\\psi_\\star$ 的单步误差定义为与参考态之差的离散 $L^2$ 范数：\n$$\n\\varepsilon_{\\star} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_\\star(x_j) - \\psi_{\\mathrm{ref}}(x_j)\\right|^2 \\,\\Delta x\\right)^{1/2}.\n$$\n对于每个测试用例，报告 $\\varepsilon_{\\mathrm{mid}}$、$\\varepsilon_{\\mathrm{KDK}}$ 以及比率 $\\varepsilon_{\\mathrm{mid}}/\\varepsilon_{\\mathrm{KDK}}$。\n\n所有计算均在指定的无量纲单位下进行。角度应以弧度处理。\n\n测试套件：\n使用以下五组参数 $\\{\\Delta t, \\omega, A, \\Omega, t_0\\}$ 来探测典型、静态、快速驱动、大步长和小步长等情况：\n- 情况 1：$\\Delta t = 0.2$, $\\omega = 0.2$, $A = 0.2$, $\\Omega = 1.5$, $t_0 = 0$。\n- 情况 2：$\\Delta t = 0.2$, $\\omega = 0.3$, $A = 0.0$, $\\Omega = 1.0$, $t_0 = 0$。\n- 情况 3：$\\Delta t = 0.2$, $\\omega = 0.2$, $A = 0.5$, $\\Omega = 15.0$, $t_0 = 0$。\n- 情况 4：$\\Delta t = 0.4$, $\\omega = 0.2$, $A = 0.2$, $\\Omega = 2.5$, $t_0 = 0$。\n- 情况 5：$\\Delta t = 0.05$, $\\omega = 0.2$, $A = 1.0$, $\\Omega = 5.0$, $t_0 = 0$。\n\n答案规格与输出格式：\n- 对于每种情况，计算列表 $[\\varepsilon_{\\mathrm{mid}}, \\varepsilon_{\\mathrm{KDK}}, \\varepsilon_{\\mathrm{mid}}/\\varepsilon_{\\mathrm{KDK}}]$。\n- 您的程序应生成单行输出，其中包含所有五种情况的结果，形式为这些列表的逗号分隔列表，并包含在一对单独的方括号中。所有数字必须以科学记数法打印，并保留 $10$ 位有效数字。例如：\n\"[ [1.2345678900e-03,2.3456789000e-04,5.2631578947e+00], [ ... ], ... ]\".", "solution": "所提出的问题是计算量子动力学中的一个标准练习，要求为一个具有含时哈密顿量的一维系统实现并比较两种二阶分裂算符方法。该问题在科学上是合理的、良定的，并且所有参数和步骤都已明确指定，足以得到一个唯一、可验证的数值解。关于高保真度参考计算的子步数 $n$ 可能存在的模糊性，可以通过将任务解释为实现者必须做出合理选择以确保收敛来解决；选择 $n=100$ 是合适的。因此，该问题被认为是有效的，并将构建一个正确的解。\n\n量子态 $\\psi(x,t)$ 的时间演化由含时薛定谔方程（TDSE）控制。在 $\\hbar=1$ 和粒子质量 $m=1$ 的无量纲单位中，方程为：\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}(t)\\,\\psi(x,t) \\;=\\; \\left[\\hat{T} + \\hat{V}(x,t)\\right] \\psi(x,t)\n$$\n其中 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 是动能算符，$\\hat{V}(x,t)$ 是含时势能算符。\n\n从 $t$ 到 $t+\\Delta t$ 的单个时间步长的形式解由时间演化算符 $\\hat{U}(t+\\Delta t, t)$ 作用于初始态给出：\n$$\n\\psi(x, t+\\Delta t) = \\hat{U}(t+\\Delta t, t) \\, \\psi(x, t)\n$$\n其中 $\\hat{U}$ 是一个时间排序指数：\n$$\n\\hat{U}(t+\\Delta t, t) = \\mathcal{T} \\exp\\left(-\\mathrm{i} \\int_t^{t+\\Delta t} \\hat{H}(t') dt'\\right)\n$$\n时间排序算符 $\\mathcal{T}$ 是必需的，因为不同时刻的哈密顿量 $\\hat{H}(t')$ 可能不对易，即 $[\\hat{H}(t_1), \\hat{H}(t_2)] \\neq 0$。\n\n对于数值实现，我们采用分裂算符法。此方法依赖于这样一个事实：虽然 $\\hat{H}(t)$ 很复杂，但其组成部分 $\\hat{T}$ 和 $\\hat{V}(t)$ 更简单。动能算符 $\\hat{T}$ 在动量（倒易）空间中是对角的，而势能算符 $\\hat{V}(x,t)$ 在位置（实）空间中是对角的。通过快速傅里叶变换（FFT）在这两种表示之间进行转换，可以高效地应用与 $\\hat{T}$ 和 $\\hat{V}(t)$ 对应的演化算符。\n\n$\\hat{T}$ 和 $\\hat{V}(t)$ 的不对易性意味着 $\\exp(-\\mathrm{i}\\Delta t(\\hat{T} + \\hat{V})) \\neq \\exp(-\\mathrm{i}\\Delta t\\hat{T})\\exp(-\\mathrm{i}\\Delta t\\hat{V})$。Baker-Campbell-Hausdorff (BCH) 公式提供了一种近似组合演化的方法。一种常用的对称二阶分解，称为 Strang 分裂，其形式如下：\n$$\n\\exp(-\\mathrm{i}\\Delta t (\\hat{A} + \\hat{B})) = \\exp(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{A}) \\exp(-\\mathrm{i}\\Delta t \\hat{B}) \\exp(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{A}) + \\mathcal{O}(\\Delta t^3)\n$$\n对于含时势，我们还必须近似时间积分。两种常见的二阶格式源于不同的近似方法。\n\n**1. 中点分裂格式：**\n此格式使用中点法则来近似积分后的哈密顿量：$\\int_t^{t+\\Delta t} \\hat{H}(t') dt' \\approx \\Delta t \\hat{H}(t+\\Delta t/2)$。将 Strang 分裂应用于这个有效哈密顿量，得到传播子：\n$$\n\\hat{U}_{\\mathrm{mid}}(t+\\Delta t, t) \\approx \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\frac{\\Delta t}{2})\\right) \\exp\\left(-\\mathrm{i}\\Delta t\\hat{T}\\right) \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\frac{\\Delta t}{2})\\right)\n$$\n该方法是对称的，并且通常具有鲁棒性。其单步精度为 $\\mathcal{O}(\\Delta t^3)$。\n\n**2. 踢-漂移-踢（KDK）格式：**\n此格式可以看作是对演化的势能部分应用梯形法则。它是速度 Verlet 算法的一种变体，其结构为：在开始时刻进行半步势能踢，然后是整步动能漂移，最后在结束时刻进行另一次半步势能踢：\n$$\n\\hat{U}_{\\mathrm{KDK}}(t+\\Delta t, t) \\approx \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\Delta t)\\right) \\exp\\left(-\\mathrm{i}\\Delta t\\hat{T}\\right) \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t)\\right)\n$$\n尽管其势能项不对称，但该方法也是二阶精度的。这两种格式的主要误差项不同，特别是在包含势的时间二阶导数 $\\partial_t^2 \\hat{V}$ 的项的系数上。这导致了不同的性能特征，尤其是在势快速变化的情况下。\n\n**数值实现：**\n模拟在一个周期性空间网格上进行，该网格在长度为 $L=50$ 的域上有 $N=512$ 个点。网格点为 $x_j = j\\Delta x - L/2$，其中 $j \\in \\{0, \\dots, N-1\\}$，步长为 $\\Delta x = L/N$。用于 FFT 的相应波矢网格为 $k_m = 2\\pi m/L$，其中 $m \\in \\{-N/2, \\dots, N/2-1\\}$，这可以方便地由 `numpy.fft.fftfreq` 生成。\n\n初始态是一个高斯波包，必须在网格上进行数值归一化：$\\psi' = \\psi / \\sqrt{\\sum_j |\\psi(x_j)|^2 \\Delta x}$。\n\n传播步骤如下，对于一个通用的对称传播子 $\\hat{U} \\approx e^{-\\mathrm{i}\\tau \\hat{V}_B}e^{-\\mathrm{i}\\Delta t \\hat{T}}e^{-\\mathrm{i}\\tau \\hat{V}_A}$：\n1. 在位置空间中应用第一个势算符：$\\psi'(x) = \\exp(-\\mathrm{i}\\tau V_A(x)) \\psi(x)$。\n2. 使用 FFT 转换到动量空间：$\\tilde{\\psi}'(k) = \\mathcal{F}[\\psi'(x)]$。\n3. 在动量空间中应用动能算符：$\\tilde{\\psi}''(k) = \\exp(-\\mathrm{i}\\Delta t k^2/2) \\tilde{\\psi}'(k)$。\n4. 使用逆 FFT 转换回位置空间：$\\psi''(x) = \\mathcal{F}^{-1}[\\tilde{\\psi}''(k)]$。\n5. 应用第二个势算符：$\\psi_{\\text{final}}(x) = \\exp(-\\mathrm{i}\\tau V_B(x)) \\psi''(x)$。\n\n**高保真度参考和误差计算：**\n使用理查森外推法 (Richardson extrapolation) 生成单个步长 $\\Delta t$ 的高精度参考解。由于 KDK 格式的单步误差为 $\\mathcal{O}(\\delta t^3)$，在固定区间上的全局误差为 $\\mathcal{O}(\\delta t^2)$，我们可以消除主导误差项。我们通过取 $n$ 个大小为 $\\delta t_n = \\Delta t/n$ 的小步得到 $\\psi_n$，并通过取 $2n$ 个大小为 $\\delta t_{2n} = \\Delta t/(2n)$ 的步得到 $\\psi_{2n}$ 来计算最终状态。外推得到的高阶结果是：\n$$\n\\psi_{\\mathrm{ref}} = \\frac{4\\psi_{2n} - \\psi_n}{3}\n$$\n此结果的全局误差为 $\\mathcal{O}(\\delta t^4)$。我们将使用 $n=100$。\n\n在计算误差之前，所有传播后的波函数（$\\psi_{\\mathrm{mid}}$、$\\psi_{\\mathrm{KDK}}$）和参考波函数（$\\psi_{\\mathrm{ref}}$）都进行数值重新归一化为1。为了在不依赖任意全局相位的情况下比较它们，每个测试态 $\\psi_\\star$ 都通过乘以一个相位因子 $e^{-\\mathrm{i}\\phi}$ 与参考态对齐，其中 $\\phi = \\arg(\\langle \\psi_{\\mathrm{ref}} | \\psi_\\star \\rangle)$。这使得它们的重叠最大化。\n\n然后，误差是差值的离散 $L^2$ 范数：\n$$\n\\varepsilon_{\\star} = \\sqrt{ \\sum_{j=0}^{N-1} |\\psi'_\\star(x_j) - \\psi_{\\mathrm{ref}}(x_j)|^2 \\Delta x }\n$$\n其中 $\\psi'_\\star$ 是归一化和相位对齐后的状态。\n\n对于静态情况（$A=0$），势是与时间无关的。中点格式和 KDK 格式都等效于标准的不含时哈密顿量的 Strang 分裂，因为 $V(x,t) = V(x,t+\\Delta t/2) = V(x, t+\\Delta t)$。因此，它们的单步误差应该是相同的，其比率应为 $1$。这是对实现的一个关键验证。对于含时势，特别是对于高驱动频率 $\\Omega$，涉及 $V$ 的时间导数的误差项变得显著，预计这两种格式的性能会发散。", "answer": "[[1.2599299496e-05, 1.2597799516e-05, 1.0001190692e+00], [1.3283257816e-06, 1.3283257816e-06, 1.0000000000e+00], [2.1469503463e-03, 1.2619478479e-03, 1.7013000624e+00], [1.9961314619e-04, 1.9950558197e-04, 1.0005391515e+00], [2.4746618583e-04, 1.0069351052e-04, 2.4576307775e+00]]", "id": "2658913"}]}