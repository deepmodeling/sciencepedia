{"hands_on_practices": [{"introduction": "掌握勒让德变换的威力始于对其核心机制的熟练运用。第一个练习将引导你完成一个基础但至关重要的推导：从内能 $U(S,V,N)$ 出发，构建焓 $H(S,P,N)$。这个过程是热力学势函数之间相互转换的典型范例，它展示了如何系统地将一个自变量（体积 $V$）替换为其共轭变量（压力 $P$），这在控制压力而非体积的实验条件下尤其有用 [@problem_id:2647354]。", "problem": "考虑一个简单的、单组分的、可压缩系统，其内能是一个基本关系，写作其广延变量的齐次函数，$U = U(S,V,N)$，其中 $S$ 是熵，$V$ 是体积，$N$ 是粒子数。通过标准热力学定义来定义共轭强度变量\n\n$$\nT \\equiv \\left(\\frac{\\partial U}{\\partial S}\\right)_{V,N}, \\quad P \\equiv -\\left(\\frac{\\partial U}{\\partial V}\\right)_{S,N}, \\quad \\mu \\equiv \\left(\\frac{\\partial U}{\\partial N}\\right)_{S,V}.\n$$\n\n仅使用这些定义和全微分的性质，对 $U(S,V,N)$ 就变量 $V$ 进行勒让德变换，以构建一个新的、使用 $P$ 而非 $V$ 作为自变量的热力学势。然后计算其全微分，并将其纯粹表示为 $dS$、$dP$ 和 $dN$ 的线性组合。\n\n您的最终答案必须是此全微分的线性形式，写成一个系数为标准热力学符号的单一解析表达式。最终答案中不要包含等号，也不要包含单位。", "solution": "该问题要求通过对内能 $U(S,V,N)$ 进行勒让德变换，用其共轭强度变量压力 $P$ 替换广延变量体积 $V$，从而构建一个新的热力学势。然后，我们将确定这个新势的全微分。\n\n首先，我们验证问题陈述的有效性。\n\n**第1步：提取已知条件**\n- 系统是简单的、单组分的、可压缩系统。\n- 基本关系是内能 $U = U(S,V,N)$，它是其广延变量（熵 $S$、体积 $V$ 和粒子数 $N$）的齐次函数。\n- 强度变量定义为：\n  $$ T \\equiv \\left(\\frac{\\partial U}{\\partial S}\\right)_{V,N}, \\quad P \\equiv -\\left(\\frac{\\partial U}{\\partial V}\\right)_{S,N}, \\quad \\mu \\equiv \\left(\\frac{\\partial U}{\\partial N}\\right)_{S,V} $$\n- 任务是：对 $U$ 就 $V$ 进行勒让德变换，然后求出所生成势的全微分，并用微分量 $dS$、$dP$ 和 $dN$ 表示。\n\n**第2步：使用已知条件进行验证**\n这个问题是有科学依据的。所提供的定义是化学热力学中针对单组分系统的标准定义。内能 $U(S,V,N)$ 确实是一个基本热力学势，而要求执行勒让德变换以从一个坐标（$V$）切换到其共轭力（$P$）是生成其他基本势（在本例中是焓）的标准且良构的过程。这个问题是自洽的、客观的，并且没有任何科学或逻辑上的矛盾。\n\n**第3步：结论和行动**\n问题是有效的。我们继续进行求解。\n\n出发点是内能 $U(S,V,N)$ 的全微分。根据多元函数的链式法则，我们写出：\n$$ dU = \\left(\\frac{\\partial U}{\\partial S}\\right)_{V,N} dS + \\left(\\frac{\\partial U}{\\partial V}\\right)_{S,N} dV + \\left(\\frac{\\partial U}{\\partial N}\\right)_{S,V} dN $$\n代入给定的温度 $T$、压力 $P$ 和化学势 $\\mu$ 的定义：\n$$ dU = T dS - P dV + \\mu dN $$\n这个方程是热力学基本方程，它结合了可逆过程的第一和第二定律。\n\n我们被要求对 $U$ 进行勒让德变换，以用其共轭变量 $P$ 替换自变量 $V$。共轭对是 $(V, -P)$，因为 $(\\partial U / \\partial V) = -P$。对于一个函数 $f(x,y)$，就 $x$ 进行勒让德变换得到新函数 $g(p_x, y)$ 的一般形式是 $g = f - x p_x$，其中 $p_x = \\partial f / \\partial x$。\n\n将此应用于我们的函数 $U(S,V,N)$ 并对变量 $V$ 进行变换，我们定义新的势（我们称之为 $H$）为：\n$$ H \\equiv U - V \\left(\\frac{\\partial U}{\\partial V}\\right)_{S,N} $$\n代入压力的定义 $P = -(\\partial U / \\partial V)_{S,N}$：\n$$ H = U - V(-P) $$\n$$ H = U + PV $$\n这个新的热力学势 $H$ 就是焓。根据其构造，它是剩余的“被动”变量 $S$ 和 $N$ 以及新的“主动”变量 $P$ 的函数。因此，它的自然变量是 $S$、$P$ 和 $N$，即 $H = H(S,P,N)$。\n\n为了求 $H$ 的全微分，我们对其定义式 $H = U + PV$ 进行微分：\n$$ dH = d(U + PV) $$\n使用微分的求和法则和 $d(PV)$ 的乘积法则：\n$$ dH = dU + d(PV) = dU + P dV + V dP $$\n现在，我们代入之前建立的 $dU$ 的表达式：\n$$ dH = (T dS - P dV + \\mu dN) + P dV + V dP $$\n项 $-P dV$ 和 $+P dV$ 相互抵消。这种抵消是勒让德变换的本质特征，它确保了在全微分表达式中自变量从 $V$ 变为 $P$。\n化简表达式得到焓的全微分：\n$$ dH = T dS + V dP + \\mu dN $$\n这个表达式是 $H$ 的全微分，表示为其自然变量的微分 $dS$、$dP$ 和 $dN$ 的线性组合。其系数是共轭变量 $T = (\\partial H / \\partial S)_{P,N}$、$V = (\\partial H / \\partial P)_{S,N}$ 和 $\\mu = (\\partial H / \\partial N)_{S,P}$。\n\n问题要求将此全微分的线性形式作为最终答案。", "answer": "$$\\boxed{T dS + V dP + \\mu dN}$$", "id": "2647354"}, {"introduction": "勒让德变换不仅仅是数学上的变量替换，它更深刻地揭示了系统的物理稳定性。本练习将探讨一个内能 $U$ 作为其体积 $V$ 的非凸函数时的情形，这种情况暗示了系统存在内在不稳定性。通过求解这个问题，你将亲身体会到勒让德变换如何自然地引出“公切线”构造，并最终量化一级相变过程中的体积变化，这是理解气液共存等相变现象的基石 [@problem_id:1873656]。", "problem": "我们研究一个熵恒定的假设热力学系统。其内能 $U$ 作为其体积 $V$ 的函数，可以很好地由以下模型描述：\n$$U(V) = \\frac{k}{4}(V - V_0)^4 - \\frac{J}{2}(V - V_0)^2$$\n其中常数分别为 $k = 8.00 \\times 10^{11} \\, \\text{J/m}^{12}$，$J = 2.00 \\times 10^5 \\, \\text{J/m}^6$ 和 $V_0 = 1.50 \\times 10^{-2} \\, \\text{m}^3$。\n\n该系统在低体积相（液相）和高体积相（气相）之间经历一级相变。在相变点，两相在特定压强下共存并处于平衡。根据热力学稳定性原理，在给定压强下两相之间的平衡要求它们各自的焓相等。\n\n计算在此相变过程中发生的体积变化 $\\Delta V = V_{gas} - V_{liquid}$。请以立方米（$\\text{m}^3$）为单位表示您的答案，并四舍五入至三位有效数字。", "solution": "在熵固定的情况下，给定压强 $P$ 时需要最小化的合适热力学势是焓 $H(S,P)=U+PV$。令 $x \\equiv V - V_{0}$，则内能为\n$$\nU(x)=\\frac{k}{4}x^{4}-\\frac{J}{2}x^{2},\n$$\n在固定的 $S$ 和 $P$ 下，焓为\n$$\nH(x)=U(x)+P(V_{0}+x)=\\frac{k}{4}x^{4}-\\frac{J}{2}x^{2}+P x + P V_{0}.\n$$\n在固定的 $S$ 和 $P$ 下，机械平衡要求 $H$ 相对于 $V$ 取驻值；等价于 $dH/dV=0$。使用 $dU/dV=k x^{3}-J x$，可得到平衡条件\n$$\n\\frac{dH}{dV}=k x^{3}-J x+P=0.\n$$\n在相同压强 $P$ 下，具有两相共存的一级相变要求存在两个不同的局部极小值点 $x_{1}0$ 和 $x_{2}0$，使得它们都满足 $k x^{3}-J x+P=0$ 并且具有相等的焓：\n$$\nH(x_{2})-H(x_{1})=\\left[\\frac{k}{4}\\left(x_{2}^{4}-x_{1}^{4}\\right)-\\frac{J}{2}\\left(x_{2}^{2}-x_{1}^{2}\\right)+P(x_{2}-x_{1})\\right]=0.\n$$\n对差值进行因式分解，\n$$\n0=(x_{2}-x_{1})\\left[\\frac{k}{4}(x_{2}+x_{1})(x_{2}^{2}+x_{1}^{2})-\\frac{J}{2}(x_{2}+x_{1})+P\\right].\n$$\n因为 $x_{2}\\neq x_{1}$，所以方括号内的表达式必须为零：\n$$\nP=(x_{2}+x_{1})\\left[\\frac{J}{2}-\\frac{k}{4}(x_{2}^{2}+x_{1}^{2})\\right].\n$$\n根据在 $x_{1}$ 和 $x_{2}$ 处的驻点条件，\n$$\nk x_{1}^{3}-J x_{1}+P=0,\\qquad k x_{2}^{3}-J x_{2}+P=0,\n$$\n两式相减得到\n$$\nJ=k\\left(x_{2}^{2}+x_{1}x_{2}+x_{1}^{2}\\right).\n$$\n使用此式在 $P$ 的表达式中消去 $J$，得到\n$$\nP=(x_{2}+x_{1})\\left[\\frac{k}{2}\\left(x_{2}^{2}+x_{1}x_{2}+x_{1}^{2}\\right)-\\frac{k}{4}(x_{2}^{2}+x_{1}^{2})\\right]=\\frac{k}{4}(x_{2}+x_{1})^{3}.\n$$\n另外，从驻点条件可得，\n$$\nP=J x_{i}-k x_{i}^{3}=k x_{1}x_{2}(x_{1}+x_{2}).\n$$\n令这两个表达式相等，得到\n$$\n\\frac{k}{4}(x_{1}+x_{2})^{3}=k x_{1}x_{2}(x_{1}+x_{2}).\n$$\n要么 $x_{1}+x_{2}=0$，这意味着 $P=0$；要么，如果 $x_{1}+x_{2}\\neq 0$，则 $x_{1}x_{2}=\\frac{1}{4}(x_{1}+x_{2})^{2}$，这意味着判别式为零，因此 $x_{1}=x_{2}$，这与相共存的假设相矛盾。因此，要实现两个不同体积的共存，唯一可能的条件是\n$$\nP=0,\\qquad x_{2}=-x_{1}.\n$$\n在 $P=0$ 时，平衡体积由 $dU/dV=0$ 给出：\n$$\nk x^{3}-J x=0\\quad\\Rightarrow\\quad x\\in\\left\\{0,\\ \\pm\\sqrt{\\frac{J}{k}}\\right\\}.\n$$\n两个极小值点位于 $x=\\pm\\sqrt{J/k}$。因此\n$$\nV_{\\text{gas}}=V_{0}+\\sqrt{\\frac{J}{k}},\\qquad V_{\\text{liquid}}=V_{0}-\\sqrt{\\frac{J}{k}},\n$$\n体积变化为\n$$\n\\Delta V=V_{\\text{gas}}-V_{\\text{liquid}}=2\\sqrt{\\frac{J}{k}}.\n$$\n现在代入给定的数值 $J=2.00\\times 10^{5}\\ \\text{J/m}^{6}$ 和 $k=8.00\\times 10^{11}\\ \\text{J/m}^{12}$：\n$$\n\\sqrt{\\frac{J}{k}}=\\sqrt{\\frac{2.00\\times 10^{5}}{8.00\\times 10^{11}}}\\ \\text{m}^{3}\n=\\sqrt{2.50\\times 10^{-7}}\\ \\text{m}^{3}=5.00\\times 10^{-4}\\ \\text{m}^{3}.\n$$\n因此，\n$$\n\\Delta V=2\\left(5.00\\times 10^{-4}\\right)=1.00\\times 10^{-3}.\n$$\n结果的单位已经是立方米；四舍五入到三位有效数字后，数值保持不变。", "answer": "$$\\boxed{1.00 \\times 10^{-3}}$$", "id": "1873656"}, {"introduction": "理论的价值最终体现在其解决实际问题的能力上，尤其是在现代计算科学的背景下。这个高级练习将理论与实践相结合，要求你从勒让德变换的几何解释——即寻找函数的凸包络（convex envelope）——出发，设计一个算法。你的任务是处理带有噪声的模拟或实验数据，并自动识别出标志着相共存的线性区域，这在材料设计和药物发现等前沿研究中是一项至关重要的计算任务 [@problem_id:2647328]。", "problem": "考虑一个以约化单位表示的、每个粒子（或每摩尔）的标量热力学势，记为 $f(x)$，其中 $x$ 是一个限制在闭区间 $[x_{\\min}, x_{\\max}]$ 上的一维类组分强度变量。在恒定温度和体积下的稳定性意味着，物理上实现的 $f(x)$ 必须是关于 $x$ 的凸函数。在实践中，人们通常只有带噪声的样本 $\\{(x_i, y_i)\\}_{i=1}^N$，其中 $x_1  x_2  \\cdots  x_N$ 且 $y_i \\approx f(x_i)$，这些样本受到了测量或模拟噪声的污染。$f$ 的 Legendre-Fenchel 变换为 $f^\\star(m) = \\sup_{x \\in [x_{\\min}, x_{\\max}]} \\{ m x - f(x) \\}$，其双共轭 $f^{\\star\\star}(x) = \\sup_{m \\in \\mathbb{R}} \\{ m x - f^\\star(m) \\}$ 是不超过 $f$ 的最大下半连续凸函数，即强制实现热力学稳定性的凸包。在平衡热力学中，$f^{\\star\\star}(x)$ 的线性段对应于两相（或多相）共存，其公共斜率等于共轭强度变量（例如，化学势）。\n\n你的任务是设计并实现一个算法，该算法在给定带噪声的样本 $\\{(x_i, y_i)\\}$ 的情况下，计算与 $f^{\\star\\star}$ 对应的离散凸包值，并识别出标志着相共存的线性段。该算法必须基于第一性原理：通过援引稳定性所蕴含的凸性以及 Legendre-Fenchel 变换的观点（支撑线）来构建算法，然后通过计算已排序点集 $(x_i, y_i)$ 的下凸包在计算上实现它。\n\n算法与输出要求：\n- 根据有序的横坐标 $x_1, \\dots, x_N$ 和纵坐标 $y_i$，使用一种在 $x_i$ 已排序时最坏情况复杂度为 $\\mathcal{O}(N \\log N)$ 或更优的方法，构建平面上点集 $\\{(x_i, y_i)\\}$ 的下凸包。将下凸包上的连续顶点 $(x_i, y_i)$ 和 $(x_j, y_j)$ 解释为在 $[x_i, x_j]$ 上定义了凸包的一个仿射段。\n- 将“共存连接线”定义为下凸包上任何跳过至少一个内部样本索引的仿射段，即连接 $(x_i, y_i)$ 和 $(x_j, y_j)$ 且满足 $j - i > 1$ 的线段。对于每条连接线，报告三元组 $[x_i, x_j, m]$，其中 $m = (y_j - y_i)/(x_j - x_i)$ 是公共斜率（共存区间内的恒定共轭变量）。\n- 对 $x$ 和 $f$ 均使用约化的无量纲单位，因此不需要进行物理单位转换。\n- 数值输出必须四舍五入到 $6$ 位小数。\n\n测试套件：\n在以下三个数据集上实现您的方法。在所有情况下，通过 $y_i = f(x_i) + \\sigma \\,\\varepsilon_i$ 生成带噪声的纵坐标，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, 1)$ 是独立标准正态偏差。在开始时使用固定的伪随机种子 $s = 123456789$ 初始化一个标准正态生成器，以确保结果是可复现的。\n1. 理想情况，严格凸基线：$x \\in [0, 1]$，有 $N = 51$ 个等距点，$x_i = \\frac{i-1}{N-1}$ for $i = 1, \\dots, N$。底层自由能为 $f(x) = x^2$。噪声水平 $\\sigma = 10^{-6}$。预期行为：无连接线（单相凸性）。\n2. 经典双阱（预期有一条连接线）：$x \\in [-2, 2]$，有 $N = 101$ 个等距点。底层函数为 $f(x) = (x^2 - 1)^2$。噪声水平 $\\sigma = 5 \\times 10^{-3}$。预期行为：一个线性段，跨越 $x \\approx -1$ 到 $x \\approx 1$ 附近，斜率近似为零，通过公切线标志着两相共存。\n3. 多阱边界情况（可能存在多个线性段）：$x \\in [-3, 3]$，有 $N = 121$ 个等距点。底层函数为 $f(x) = (x+2)^2 \\, x^2 \\, (x-2)^2$。噪声水平 $\\sigma = 0$。预期行为：连接极小值点的扩展线性段；您的检测规则应至少识别出一条共存连接线。\n\n程序 I/O 和最终输出格式：\n- 您的程序必须是自包含的，并且不得读取输入。它必须在内部构建测试套件，运行凸包算法，如上所述在每个数据集中检测共存连接线，并将每个报告的数字四舍五入到 $6$ 位小数。\n- 对于每个数据集，生成一个检测到的连接线列表，其中每条连接线是按顺序排列的列表 $[x_{\\text{left}}, x_{\\text{right}}, m]$。\n- 将三个数据集的列表按照测试套件的顺序（$1$ 然后 $2$ 然后 $3$）聚合到一个外部列表中。\n- 您的程序应只产生一行输出，包含这个嵌套列表，采用逗号分隔、无空格的格式，例如：`[[\\cdots],[\\cdots],[\\cdots]]`。\n\n您的实现和解释中应反映的科学现实性和基本原理：\n- 从平衡热力学势在适当变量下是凸的这一稳定性要求以及 Legendre-Fenchel 变换的定义出发。解释为什么凸包 $f^{\\star\\star}$ 是通过采样点的下凸包实现的，以及线性段如何对应于公共支撑线（恒定斜率），从而对应于在相等共轭变量下的相共存。不要使用任何未经证明的快捷公式；从这些第一性原理推导出解释。\n\n您为测试套件提供的最终输出必须是约化的无量纲数字，按规定进行四舍五入，并聚合成上述的单行格式。此问题不涉及角度或百分比。程序必须通过使用上面指定的固定种子来确定性地运行。", "solution": "所提出的问题是开发一个计算程序，用于从含噪声的数据中识别一维热力学系统中的相共存。这需要通过构建采样热力学势的凸包来实现。该方法必须基于热力学稳定性和 Legendre-Fenchel 变换的基本原理。\n\n首先，我们对问题陈述进行验证。\n\n步骤 1：提取给定信息。\n- 每个粒子的标量热力学势 $f(x)$，其中 $x$ 是在 $[x_{\\min}, x_{\\max}]$ 内的强度变量。\n- 一组含噪声的样本 $\\{(x_i, y_i)\\}_{i=1}^N$，其中 $x_1  x_2  \\cdots  x_N$ 且 $y_i \\approx f(x_i)$。\n- 稳定性要求物理上实现的势是凸的。\n- Legendre-Fenchel 变换：$f^\\star(m) = \\sup_{x \\in [x_{\\min}, x_{\\max}]} \\{ m x - f(x) \\}$。\n- 双共轭（凸包）：$f^{\\star\\star}(x) = \\sup_{m \\in \\mathbb{R}} \\{ m x - f^\\star(m) \\}$。$f^{\\star\\star}$ 是不超过 $f$ 的最大凸函数。\n- $f^{\\star\\star}(x)$ 的线性段对应于相共存。\n- 任务：从 $\\{(x_i, y_i)\\}$ 计算 $f^{\\star\\star}$ 的离散值并识别线性段。\n- 算法要求：对已排序的点使用复杂度为 $\\mathcal{O}(N \\log N)$ 或更优的下凸包算法。\n- 共存连接线的定义：连接原始样本中点 $(x_i, y_i)$ 和 $(x_j, y_j)$ 的下凸包仿射段，其中索引满足 $j - i > 1$。\n- 连接线的输出：一个三元组 $[x_i, x_j, m]$，其中 $m = (y_j - y_i)/(x_j - x_i)$。\n- 单位：约化的、无量纲的。\n- 数值精度：输出四舍五入到 6 位小数。\n- 测试套件：由函数 $f(x)$、定义域、样本数 $N$ 和噪声水平 $\\sigma$ 定义的三个特定数据集。必须使用固定的伪随机种子 $s = 123456789$ 进行噪声生成。\n- 程序输出：一个单行嵌套列表，按顺序包含三个数据集检测到的连接线。\n\n步骤 2：使用提取的给定信息进行验证。\n根据验证标准对问题进行评估。\n- **科学上合理**：该问题基于热力学稳定性的基本原理，该原理规定了在恒定温度和体积下，系统的平衡态会使亥姆霍兹自由能最小化。自由能作为广延变量的函数（或自由能密度作为强度变量的函数）必须是凸的，这一推论是统计力学和化学热力学的基石。使用 Legendre-Fenchel 变换及其双共轭来形式化凸包的概念在数学上是严谨的，并且是该领域的标准做法。因此，该问题在科学上是合理的。\n- **适定性**：问题定义清晰。为三个测试用例精确指定了输入。指定了所需的算法（下凸包），识别“连接线”的标准是明确的（$j-i  1$）。输出格式有明确规定。给定固定的随机种子，存在一条通往唯一、确定性解的清晰路径。\n- **客观性**：问题以精确、客观和定量的术语陈述。它不包含任何主观或基于意见的主张。\n\n步骤 3：结论与行动。\n问题陈述是有效的。它在科学上是合理的，具有适定性和客观性。没有矛盾、信息缺失或伪科学元素。我们将继续提供完整的解决方案。\n\n基本原理是热力学第二定律，它意味着一个在恒定温度 $T$、体积 $V$ 和粒子数 $N$ 下的系统将演化到一个使亥姆霍兹自由能 $A$ 最小化的状态。我们考虑一个可以用类组分强度变量 $x$ 描述的系统。自由能密度是函数 $f(x)$。如果该函数在某个 $x$ 范围内是非凸的，系统可以通过相分离成两个（或更多）具有不同组分（例如 $x_a$ 和 $x_b$）的相来获得更低的总自由能。对于某个摩尔分数 $\\lambda \\in (0, 1)$，混合物的平均组分为 $x = \\lambda x_a + (1-\\lambda) x_b$，其自由能密度由线性组合 $f_{mix} = \\lambda f(x_a) + (1-\\lambda) f(x_b)$ 给出。这意味着相分离系统的能量位于连接自由能图像上点 $(x_a, f(x_a))$ 和 $(x_b, f(x_b))$ 的直线上。\n\n为了在 $[x_a, x_b]$ 区间内的任何平均组分 $x$ 下达到绝对最低能量，系统会选择相 $x_a$ 和 $x_b$，使得连接 $(x_a, f(x_a))$ 和 $(x_b, f(x_b))$ 的线段在其他任何地方都位于 $f(x)$ 图像的下方。这条线被称为“公切线”。所有这些点和公切线段的集合构成了原始函数 $f(x)$ 的凸包。这个凸包，记为 $f^{\\star\\star}(x)$，代表了真实的、可观测的宏观平衡自由能密度。\n\nLegendre-Fenchel 变换提供了严谨的数学框架。变换 $f^\\star(m) = \\sup_{x} \\{mx - f(x)\\}$ 可以从几何上解释。量 $mx - f(x)$ 是通过点 $(x, f(x))$、斜率为 $m$ 的直线的 $y$ 轴截距的相反数。最大化这个量等价于找到一条斜率为 $m$ 的直线，它在 $-f(x)$ 图像的“最上方”，或者等价地，找到一条在 $f(x)$ 图像“最下方”的支撑线。逆变换，即双共轭 $f^{\\star\\star}(x) = \\sup_{m} \\{mx - f^\\star(m)\\}$，从其所有支撑线重构了函数。这种取所有仿射下界函数的上确界的几何构造精确地定义了凸包。$f^\\star(m)$ 中的一个不可微点对应一个斜率 $m$，对于该斜率，多个 $x$ 值在 $f^\\star(m)$ 的定义中达到上确界。这对应于公切线构造，其中单个斜率 $m$（恒定的共轭场，例如化学势）表征了整个组分区间 $[x_i, x_j]$，标志着相共存。\n\n我们的任务是从一个离散的、含噪声的点集 $\\{(x_i, y_i)\\}$ 来近似这个过程。寻找凸包 $f^{\\star\\star}$ 的最直接计算模拟方法是计算这个点集的下凸包。下凸包的顶点是原始点的一个子集，它们在所有其他点的下方形成一个凸多边形。\n\n对于已经按 $x$ 坐标排序的点集，寻找其下凸包的算法是 Monotone Chain 算法，它具有线性时间复杂度 $\\mathcal{O}(N)$，因此满足问题的要求。该算法过程如下：\n1. 初始化一个空列表 `hull`，用于存储下凸包的顶点。\n2. 遍历已排序的点 $(x_i, y_i)$，其中 $i=1, \\dots, N$。\n3. 对于每个点 $P_i$，考虑 `hull` 中最后加入的两个点，记为 $P_{k-1}$ 和 $P_k$。我们必须确定序列 $P_{k-1} \\rightarrow P_k \\rightarrow P_i$ 是否构成一个“左转”。对于下凸包，我们必须维持一个总是左转的点序列。\n4. 转向方向由向量 $\\vec{P_{k-1}P_k}$ 和 $\\vec{P_{k-1}P_i}$ 的二维叉积的符号确定。设 $P_{k-1}=(x_{k-1}, y_{k-1})$，$P_k=(x_k, y_k)$ 和 $P_i=(x_i, y_i)$。叉积为 $C = (x_k - x_{k-1})(y_i - y_{k-1}) - (y_k - y_{k-1})(x_i - x_{k-1})$。\n   - $C  0$：左转。序列是凸的。\n   - $C  0$：右转。点 $P_k$ 位于由 $P_{k-1}$ 和 $P_i$ 形成的凸包内部，必须被移除。\n   - $C = 0$：共线。点 $P_k$ 是多余的，可以移除以找到最小顶点集。\n5. 当 `hull` 包含至少两个点，且新点 $P_i$ 与 `hull` 中最后两个点不构成左转时（即构成右转或共线），从 `hull` 中弹出最后一个点。\n6. 弹出循环结束后，将当前点 $P_i$ 追加到 `hull` 中。\n7. 遍历所有点后，`hull` 将包含下凸包的有序顶点。\n\n一旦下凸包的顶点被确定，我们必须检测共存连接线。根据问题定义，连接线是凸包的一条边，连接来自原始数据的点 $(x_i, y_i)$ 和 $(x_j, y_j)$，其中原始索引满足 $j-i  1$。这个条件意味着凸包“跳过”了中间的数据点，这些点现在位于凸包边的“上方”。这条边代表了凸包的一个线性段，对应一个相共存区域。\n为了实现这一点，我们首先需要将每个点映射回其原始索引。然后，对于计算出的凸包上的每一对相邻顶点，例如 $(x_a, y_a)$ 和 $(x_b, y_b)$，我们找到它们的原始索引 $i$ 和 $j$。如果 $j - i  1$，我们就找到了一条连接线。然后我们计算斜率 $m = (y_b - y_a)/(x_b - x_a)$ 并记录三元组 $[x_a, x_b, m]$。\n实现将针对指定的三个测试用例遵循此逻辑。", "answer": "[[],[[-1.000000,1.000000,-0.000305]],[[-2.000000,0.000000,0.000000],[0.000000,2.000000,0.000000]]]", "id": "2647328"}]}