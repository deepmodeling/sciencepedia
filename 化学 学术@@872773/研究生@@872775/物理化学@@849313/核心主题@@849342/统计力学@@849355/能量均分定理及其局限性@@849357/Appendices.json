{"hands_on_practices": [{"introduction": "我们从经典统计力学的一个基石——一维谐振子开始。这个练习将指导您通过第一性原理推导，证明在热平衡状态下，谐振子的平均动能和平均势能是相等的，各自对总能量的贡献为 $\\frac{1}{2}k_{B}T$。掌握这一计算将巩固您对哈密顿量中的二次型自由度如何直接导出能量均分原理的理解。[@problem_id:2673992]", "problem": "单个经典一维谐振子的哈密顿量为 $H(x,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega^{2}x^{2}$，其中 $x$ 是坐标，$p$ 是共轭动量，$m$ 是质量，$\\omega$ 是角频率。当与绝对温度为 $T$ 的热浴接触时，该振子由正则系综描述。从正则玻尔兹曼分布和标准的相空间积分出发，计算动能 $K=\\frac{p^{2}}{2m}$ 和势能 $U=\\frac{1}{2}m\\omega^{2}x^{2}$ 的正则平均值，并通过显式计算验证它们之间的能量均分。您必须从系综平均的正则定义开始，并进行必要的相空间积分，而不是直接引用能量均分定理。以焦耳为单位，用玻尔兹曼常数 $k_{B}$ 和温度 $T$ 来表示您的最终答案。将这两个平均值以单个有序对的形式给出。不需要进行数值取整；给出精确的符号表达式。", "solution": "该问题已经过验证，并且是有效的。这是一个经典统计力学中的标准、适定问题，没有任何科学或逻辑上的缺陷。我们开始求解。\n\n系统是一个单个一维经典谐振子，与绝对温度为 $T$ 的热浴处于热平衡状态。适用的统计系综是正则系综。系统的哈密顿量由下式给出：\n$$H(x,p) = \\frac{p^{2}}{2m} + \\frac{1}{2}m\\omega^{2}x^{2}$$\n其中 $x$ 是位置，$p$ 是动量，$m$ 是质量，$\\omega$ 是角频率。\n\n任何可观测量 $A(x,p)$ 的正则平均值定义为：\n$$\\langle A \\rangle = \\frac{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A(x,p) \\exp(-\\beta H(x,p)) \\,dp\\,dx}{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\exp(-\\beta H(x,p)) \\,dp\\,dx}$$\n其中 $\\beta = \\frac{1}{k_{B}T}$，$k_{B}$ 是玻尔兹曼常数。分母是正则配分函数 $Z$。\n\n首先，我们计算配分函数 $Z$：\n$$Z = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left(\\frac{p^{2}}{2m} + \\frac{1}{2}m\\omega^{2}x^{2}\\right)\\right) \\,dp\\,dx$$\n哈密顿量是一个与动量相关的项和一个与位置相关的项之和，这使得指数函数可以被因式分解。因此，该二重积分可以分离为两个单积分的乘积：\n$$Z = \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^{2}}{2m}\\right) \\,dp\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^{2}x^{2}}{2}\\right) \\,dx\\right)$$\n这两个积分都是标准的高斯积分形式 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2}) \\,dx = \\sqrt{\\frac{\\pi}{a}}$。\n\n对于动量积分，系数是 $a_{p} = \\frac{\\beta}{2m}$。因此：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^{2}}{2m}\\right) \\,dp = \\sqrt{\\frac{\\pi}{(\\beta/2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\n对于位置积分，系数是 $a_{x} = \\frac{\\beta m\\omega^{2}}{2}$。因此：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^{2}x^{2}}{2}\\right) \\,dx = \\sqrt{\\frac{\\pi}{(\\beta m\\omega^{2}/2)}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}$$\n配分函数 $Z$ 是这两个结果的乘积：\n$$Z = \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}} = \\sqrt{\\frac{4\\pi^{2}m}{\\beta^{2}m\\omega^{2}}} = \\frac{2\\pi}{\\beta\\omega}$$\n\n接下来，我们计算平均动能 $\\langle K \\rangle = \\langle \\frac{p^{2}}{2m} \\rangle$。\n$$\\langle K \\rangle = \\frac{1}{Z} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\left(\\frac{p^{2}}{2m}\\right) \\exp\\left(-\\beta H(x,p)\\right) \\,dp\\,dx$$\n像之前一样分离积分：\n$$\\langle K \\rangle = \\frac{1}{Z} \\left(\\int_{-\\infty}^{\\infty} \\frac{p^{2}}{2m} \\exp\\left(-\\frac{\\beta p^{2}}{2m}\\right) \\,dp\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^{2}x^{2}}{2}\\right) \\,dx\\right)$$\n第二个积分是 $Z$ 中与位置相关的部分，我们已算出其值为 $\\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}$。\n第一个积分需要计算一个形式为 $\\int_{-\\infty}^{\\infty} x^{2}\\exp(-ax^{2}) \\,dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$ 的积分。\n令 $x \\rightarrow p$ 和 $a \\rightarrow a_{p} = \\frac{\\beta}{2m}$：\n$$\\int_{-\\infty}^{\\infty} p^{2}\\exp\\left(-\\frac{\\beta p^{2}}{2m}\\right) \\,dp = \\frac{1}{2(\\beta/2m)}\\sqrt{\\frac{\\pi}{(\\beta/2m)}} = \\frac{m}{\\beta}\\sqrt{\\frac{2\\pi m}{\\beta}}$$\n所以，$\\langle K \\rangle$ 表达式的整个分子是：\n$$\\text{Numerator} = \\left(\\frac{1}{2m} \\cdot \\frac{m}{\\beta}\\sqrt{\\frac{2\\pi m}{\\beta}}\\right) \\left(\\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}\\right) = \\frac{1}{2\\beta} \\left(\\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}\\right) = \\frac{1}{2\\beta} Z$$\n因此，平均动能是：\n$$\\langle K \\rangle = \\frac{\\frac{1}{2\\beta}Z}{Z} = \\frac{1}{2\\beta} = \\frac{1}{2}k_{B}T$$\n\n现在，我们计算平均势能 $\\langle U \\rangle = \\langle \\frac{1}{2}m\\omega^{2}x^{2} \\rangle$。\n$$\\langle U \\rangle = \\frac{1}{Z} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\left(\\frac{1}{2}m\\omega^{2}x^{2}\\right) \\exp\\left(-\\beta H(x,p)\\right) \\,dp\\,dx$$\n分离积分：\n$$\\langle U \\rangle = \\frac{1}{Z} \\left(\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^{2}}{2m}\\right) \\,dp\\right) \\left(\\int_{-\\infty}^{\\infty} \\frac{1}{2}m\\omega^{2}x^{2} \\exp\\left(-\\frac{\\beta m\\omega^{2}x^{2}}{2}\\right) \\,dx\\right)$$\n第一个积分是 $Z$ 中与动量相关的部分，其值为 $\\sqrt{\\frac{2\\pi m}{\\beta}}$。\n第二个积分同样使用 $\\int_{-\\infty}^{\\infty} y^{2}\\exp(-by^{2}) \\,dy = \\frac{1}{2b}\\sqrt{\\frac{\\pi}{b}}$ 来计算。\n令 $y \\rightarrow x$ 和 $b \\rightarrow a_{x} = \\frac{\\beta m\\omega^{2}}{2}$：\n$$\\int_{-\\infty}^{\\infty} x^{2}\\exp\\left(-\\frac{\\beta m\\omega^{2}x^{2}}{2}\\right) \\,dx = \\frac{1}{2(\\beta m\\omega^{2}/2)}\\sqrt{\\frac{\\pi}{(\\beta m\\omega^{2}/2)}} = \\frac{1}{\\beta m\\omega^{2}}\\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}$$\n$\\langle U \\rangle$ 表达式的整个分子是：\n$$\\text{Numerator} = \\left(\\sqrt{\\frac{2\\pi m}{\\beta}}\\right) \\left(\\frac{1}{2}m\\omega^{2} \\cdot \\frac{1}{\\beta m\\omega^{2}}\\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}\\right) = \\frac{1}{2\\beta} \\left(\\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}}\\right) = \\frac{1}{2\\beta} Z$$\n因此，平均势能是：\n$$\\langle U \\rangle = \\frac{\\frac{1}{2\\beta}Z}{Z} = \\frac{1}{2\\beta} = \\frac{1}{2}k_{B}T$$\n\n从第一性原理出发的显式计算表明，平均动能 $\\langle K \\rangle = \\frac{1}{2}k_{B}T$ 且平均势能 $\\langle U \\rangle = \\frac{1}{2}k_{B}T$。我们因此验证了 $\\langle K \\rangle = \\langle U \\rangle$，这就是能量均分原理应用于该一维谐振子的两个二次自由度（一个动量自由度，一个位置自由度）的结果。问题要求将这两个平均值以单个有序对 $(\\langle K \\rangle, \\langle U \\rangle)$ 的形式给出。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}k_{B}T  \\frac{1}{2}k_{B}T \\end{pmatrix}}$$", "id": "2673992"}, {"introduction": "真实的分子振动并非完全简谐。本练习通过在势能中引入非谐项来挑战理想情景，迫使我们直面能量均分定理的局限性。通过应用微扰理论，您将计算出平均势能的主导修正项，从而揭示偏离纯二次型势将如何导致能量分配变得与温度相关。[@problem_id:2674007]", "problem": "一个质量为 $m$ 的单个经典粒子在一维空间中运动，其哈密顿量为 $H(p,x)=\\frac{p^{2}}{2m}+V(x)$，其中势能是非谐的，\n$$\nV(x)=\\frac{1}{2}k\\,x^{2}+\\alpha\\,x^{3}+\\beta\\,x^{4},\n$$\n其中 $k0$ 且系数 $\\alpha$ 和 $\\beta$ 为实数。系统在绝对温度 $T$ 下处于正则平衡状态。令 $\\beta_{\\mathrm{th}}\\equiv 1/(k_{B}T)$ 表示热力学逆温（为避免与上述四次项系数 $\\beta$ 混淆）。在经典统计力学的框架下，从正则相空间表述出发，并将 $\\alpha$ 和 $\\beta$ 视为小参数。使用围绕谐振子参考系综的受控微扰展开，确定平均势能相对于谐振子能量均分值的主导偏差。具体而言，计算物理量\n$$\n\\Delta\\langle V\\rangle \\equiv \\langle V\\rangle-\\frac{1}{2}k_{B}T\n$$\n计算到非谐系数的第一个非零阶，保留至 $\\mathcal{O}(\\alpha^{2})$ 和 $\\mathcal{O}(\\beta)$ 阶的项，同时忽略 $\\mathcal{O}(\\alpha^{3})$、$\\mathcal{O}(\\alpha\\beta)$ 和 $\\mathcal{O}(\\beta^{2})$ 阶的项。将最终答案表示为以 $k$、$\\alpha$、$\\beta$、$k_{B}$ 和 $T$ 表示的闭合形式解析表达式。最终答案必须是单个表达式，并且在方框内的结果中不得包含任何单位。", "solution": "所述问题具有科学依据且定义明确，是经典统计力学中的一个标准问题。它涉及使用微扰理论计算具有非谐势的系统的热力学平均值。正则配分函数定义良好的一个必要条件是，当 $x \\to \\pm\\infty$ 时，势能 $V(x)$ 必须有下界。给定势能 $V(x)=\\frac{1}{2}k\\,x^{2}+\\alpha\\,x^{3}+\\beta\\,x^{4}$ 且 $k0$，当 $|x|$ 很大时，$\\beta x^4$ 项占主导地位。为使积分 $\\int_{-\\infty}^{\\infty} \\exp(-\\beta_{\\mathrm{th}}V(x))dx$ 收敛，我们必须有 $\\beta  0$。问题假定系统处于正则平衡状态，这意味着其具有热力学稳定性。因此，条件 $\\beta0$ 是问题在物理上和数学上成立的隐含且必要的条件。我们将在此条件下进行计算。\n\n在正则系综中，平均势能 $\\langle V \\rangle$ 由下式给出：\n$$ \\langle V \\rangle = \\frac{\\int dp \\int dx \\, V(x) \\, \\exp(-\\beta_{\\mathrm{th}} H(p,x))}{\\int dp \\int dx \\, \\exp(-\\beta_{\\mathrm{th}} H(p,x))} $$\n其中 $\\beta_{\\mathrm{th}} = 1/(k_B T)$ 是逆温，且 $H(p,x) = \\frac{p^2}{2m} + V(x)$。动量和位置变量是可分离的。分子和分母中的动量积分相同，因此相互抵消。问题简化为计算位形平均值：\n$$ \\langle V \\rangle = \\frac{\\int_{-\\infty}^{\\infty} V(x) \\exp(-\\beta_{\\mathrm{th}} V(x)) dx}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta_{\\mathrm{th}} V(x)) dx} $$\n我们将势能 $V(x)$ 分解为谐振部分 $V_0(x) = \\frac{1}{2}kx^2$ 和非谐微扰 $V_1(x) = \\alpha x^3 + \\beta x^4$。\n$\\langle V \\rangle$ 的表达式可以用对未受微扰的谐振子系综的平均来书写，记为 $\\langle \\dots \\rangle_0$：\n$$ \\langle V \\rangle = \\frac{\\langle (V_0+V_1)\\exp(-\\beta_{\\mathrm{th}}V_1) \\rangle_0}{\\langle \\exp(-\\beta_{\\mathrm{th}}V_1) \\rangle_0} $$\n未受微扰的平均值 $\\langle A(x) \\rangle_0$ 定义为\n$$ \\langle A(x) \\rangle_0 = \\frac{\\int_{-\\infty}^{\\infty} A(x) \\exp(-\\frac{1}{2}\\beta_{\\mathrm{th}}kx^2) dx}{\\int_{-\\infty}^{\\infty} \\exp(-\\frac{1}{2}\\beta_{\\mathrm{th}}kx^2) dx} $$\n由于 $\\alpha$ 和 $\\beta$ 很小，我们将 $\\exp(-\\beta_{\\mathrm{th}}V_1)$ 展开为幂级数，保留到 $\\mathcal{O}(\\alpha^2)$ 和 $\\mathcal{O}(\\beta)$ 阶的项：\n$$ \\exp(-\\beta_{\\mathrm{th}}V_1) \\approx 1 - \\beta_{\\mathrm{th}}V_1 + \\frac{1}{2} \\beta_{\\mathrm{th}}^2 V_1^2 = 1 - \\beta_{\\mathrm{th}}(\\alpha x^3 + \\beta x^4) + \\frac{1}{2}\\beta_{\\mathrm{th}}^2(\\alpha x^3 + \\beta x^4)^2 $$\n$$ \\exp(-\\beta_{\\mathrm{th}}V_1) \\approx 1 - \\beta_{\\mathrm{th}}\\alpha x^3 - \\beta_{\\mathrm{th}}\\beta x^4 + \\frac{1}{2}\\beta_{\\mathrm{th}}^2 \\alpha^2 x^6 + \\mathcal{O}(\\alpha\\beta, \\beta^2, \\alpha^3) $$\n分母为 $D = \\langle \\exp(-\\beta_{\\mathrm{th}}V_1) \\rangle_0$。取未受微扰的平均值，并注意到对于对称的高斯权重，当 $n$ 为奇数时 $\\langle x^n \\rangle_0 = 0$：\n$$ D \\approx 1 - \\beta_{\\mathrm{th}}\\beta \\langle x^4 \\rangle_0 + \\frac{1}{2}\\beta_{\\mathrm{th}}^2 \\alpha^2 \\langle x^6 \\rangle_0 $$\n高斯分布的矩由 $\\langle x^{2n} \\rangle_0 = \\frac{(2n-1)!!}{(\\beta_{\\mathrm{th}}k)^n}$ 给出。\n$$ \\langle x^2 \\rangle_0 = \\frac{1}{\\beta_{\\mathrm{th}}k}, \\quad \\langle x^4 \\rangle_0 = \\frac{3}{(\\beta_{\\mathrm{th}}k)^2}, \\quad \\langle x^6 \\rangle_0 = \\frac{15}{(\\beta_{\\mathrm{th}}k)^3}, \\quad \\langle x^8 \\rangle_0 = \\frac{105}{(\\beta_{\\mathrm{th}}k)^4} $$\n因此，分母变为：\n$$ D \\approx 1 - \\beta_{\\mathrm{th}}\\beta \\frac{3}{(\\beta_{\\mathrm{th}}k)^2} + \\frac{1}{2}\\beta_{\\mathrm{th}}^2 \\alpha^2 \\frac{15}{(\\beta_{\\mathrm{th}}k)^3} = 1 - \\frac{3\\beta}{\\beta_{\\mathrm{th}}k^2} + \\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}k^3} $$\n分子为 $N = \\langle (V_0+V_1)\\exp(-\\beta_{\\mathrm{th}}V_1) \\rangle_0$。将其展开：\n$$ N \\approx \\langle (V_0+V_1)(1-\\beta_{\\mathrm{th}}V_1+\\frac{1}{2}\\beta_{\\mathrm{th}}^2 V_1^2) \\rangle_0 $$\n$$ N \\approx \\langle V_0 \\rangle_0 + \\langle V_1 \\rangle_0 - \\beta_{\\mathrm{th}}\\langle V_0 V_1 \\rangle_0 - \\beta_{\\mathrm{th}}\\langle V_1^2 \\rangle_0 + \\frac{1}{2}\\beta_{\\mathrm{th}}^2 \\langle V_0 V_1^2 \\rangle_0 $$\n我们计算每一项：\n$\\langle V_0 \\rangle_0 = \\langle \\frac{1}{2}kx^2 \\rangle_0 = \\frac{1}{2}k\\langle x^2 \\rangle_0 = \\frac{1}{2}k\\frac{1}{\\beta_{\\mathrm{th}}k} = \\frac{1}{2\\beta_{\\mathrm{th}}} = \\frac{1}{2}k_B T$。这是谐振子的能量均分值。\n$\\langle V_1 \\rangle_0 = \\langle \\alpha x^3+\\beta x^4 \\rangle_0 = \\beta\\langle x^4 \\rangle_0 = \\frac{3\\beta}{(\\beta_{\\mathrm{th}}k)^2}.$\n$\\langle V_0 V_1 \\rangle_0 = \\langle \\frac{1}{2}kx^2(\\alpha x^3+\\beta x^4) \\rangle_0 = \\frac{1}{2}k\\beta\\langle x^6 \\rangle_0 = \\frac{1}{2}k\\beta\\frac{15}{(\\beta_{\\mathrm{th}}k)^3} = \\frac{15\\beta}{2\\beta_{\\mathrm{th}}^3k^2}.$\n$\\langle V_1^2 \\rangle_0 = \\langle(\\alpha x^3+\\beta x^4)^2\\rangle_0 \\approx \\alpha^2\\langle x^6 \\rangle_0 = \\frac{15\\alpha^2}{(\\beta_{\\mathrm{th}}k)^3}.$\n$\\langle V_0 V_1^2 \\rangle_0 = \\langle\\frac{1}{2}kx^2(\\alpha x^3+\\beta x^4)^2\\rangle_0 \\approx \\frac{1}{2}k\\alpha^2\\langle x^8 \\rangle_0 = \\frac{1}{2}k\\alpha^2\\frac{105}{(\\beta_{\\mathrm{th}}k)^4} = \\frac{105\\alpha^2}{2\\beta_{\\mathrm{th}}^4k^3}.$\n\n将这些代入 $N$ 的表达式中：\n$N \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} + \\frac{3\\beta}{(\\beta_{\\mathrm{th}}k)^2} - \\beta_{\\mathrm{th}}\\frac{15\\beta}{2\\beta_{\\mathrm{th}}^3k^2} - \\beta_{\\mathrm{th}}\\frac{15\\alpha^2}{(\\beta_{\\mathrm{th}}k)^3} + \\frac{1}{2}\\beta_{\\mathrm{th}}^2\\frac{105\\alpha^2}{2\\beta_{\\mathrm{th}}^4k^3}$\n$N \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} + \\left(\\frac{3\\beta}{\\beta_{\\mathrm{th}}^2k^2} - \\frac{15\\beta}{2\\beta_{\\mathrm{th}}^2k^2}\\right) + \\left(-\\frac{15\\alpha^2}{\\beta_{\\mathrm{th}}^2k^3} + \\frac{105\\alpha^2}{4\\beta_{\\mathrm{th}}^2k^3}\\right)$\n$N \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} - \\frac{9\\beta}{2\\beta_{\\mathrm{th}}^2k^2} + \\frac{45\\alpha^2}{4\\beta_{\\mathrm{th}}^2k^3}$\n\n现在，我们计算 $\\langle V \\rangle = N/D$。我们使用展开式 $1/D \\approx 1 - (- \\frac{3\\beta}{\\beta_{\\mathrm{th}}k^2} + \\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}k^3})$。\n$$ \\langle V \\rangle \\approx \\left(\\frac{1}{2\\beta_{\\mathrm{th}}} - \\frac{9\\beta}{2\\beta_{\\mathrm{th}}^2k^2} + \\frac{45\\alpha^2}{4\\beta_{\\mathrm{th}}^2k^3}\\right) \\left(1 + \\frac{3\\beta}{\\beta_{\\mathrm{th}}k^2} - \\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}k^3}\\right) $$\n相乘并仅保留至 $\\mathcal{O}(\\beta)$ 和 $\\mathcal{O}(\\alpha^2)$ 阶的项：\n$$ \\langle V \\rangle \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} + \\left(\\frac{1}{2\\beta_{\\mathrm{th}}}\\right)\\left(\\frac{3\\beta}{\\beta_{\\mathrm{th}}k^2}\\right) - \\frac{9\\beta}{2\\beta_{\\mathrm{th}}^2k^2} + \\left(\\frac{1}{2\\beta_{\\mathrm{th}}}\\right)\\left(-\\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}k^3}\\right) + \\frac{45\\alpha^2}{4\\beta_{\\mathrm{th}}^2k^3} $$\n$$ \\langle V \\rangle \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} + \\beta\\left(\\frac{3}{2\\beta_{\\mathrm{th}}^2k^2} - \\frac{9}{2\\beta_{\\mathrm{th}}^2k^2}\\right) + \\alpha^2\\left(-\\frac{15}{4\\beta_{\\mathrm{th}}^2k^3} + \\frac{45}{4\\beta_{\\mathrm{th}}^2k^3}\\right) $$\n$$ \\langle V \\rangle \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} - \\frac{6\\beta}{2\\beta_{\\mathrm{th}}^2k^2} + \\frac{30\\alpha^2}{4\\beta_{\\mathrm{th}}^2k^3} $$\n$$ \\langle V \\rangle \\approx \\frac{1}{2\\beta_{\\mathrm{th}}} - \\frac{3\\beta}{\\beta_{\\mathrm{th}}^2k^2} + \\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}^2k^3} $$\n需要计算的量是 $\\Delta\\langle V\\rangle = \\langle V\\rangle-\\frac{1}{2}k_{B}T$。由于 $\\frac{1}{2}k_{B}T = \\frac{1}{2\\beta_{\\mathrm{th}}}$，我们有：\n$$ \\Delta\\langle V\\rangle = -\\frac{3\\beta}{\\beta_{\\mathrm{th}}^2k^2} + \\frac{15\\alpha^2}{2\\beta_{\\mathrm{th}}^2k^3} $$\n代入 $\\beta_{\\mathrm{th}} = 1/(k_B T)$：\n$$ \\Delta\\langle V\\rangle = - \\frac{3\\beta(k_B T)^2}{k^2} + \\frac{15\\alpha^2(k_B T)^2}{2k^3} $$\n这可以写成更紧凑的形式：\n$$ \\Delta\\langle V\\rangle = \\left(\\frac{15\\alpha^2}{2k^3} - \\frac{3\\beta}{k^2}\\right)(k_B T)^2 $$\n这是平均势能相对于纯谐振子能量均分定理预测值的主导偏差。该偏差是温度的二阶项，并取决于非谐系数 $\\alpha$ 和 $\\beta$。", "answer": "$$\\boxed{\\left(\\frac{15\\alpha^{2}}{2k^{3}}-\\frac{3\\beta}{k^{2}}\\right)(k_{B}T)^{2}}$$", "id": "2674007"}, {"introduction": "超越简单的能量平均，这项高级实践将统计理论与现代计算方法联系起来。您将推导并实现一个“组态温度”估计器，它完全基于势能面及其导数来定义温度。这个练习不仅展示了正则系综的一个深刻结论，还提供了对分子模拟中用于验证热平衡的常用工具的动手实践经验。[@problem_id:2673950]", "problem": "考虑一个经典一维系统，其哈密顿量为 $H(q,p) = \\dfrac{p^2}{2m} + V(q)$，该系统处于温度为 $T$ 的正则系综中，其中 $q$ 是坐标，$p$ 是动量，$m$ 是质量，$V(q)$ 是一个光滑的束缚势。在约化单位制下进行计算，其中玻尔兹曼常数设为 $k_\\mathrm{B} = 1$，因此温度与能量具有相同的单位。从正则概率密度 $\\rho(q,p) \\propto \\exp\\!\\big(-\\beta H(q,p)\\big)$（其中 $\\beta = 1/T$）以及系综平均定义为相空间积分出发。仅使用这些基本原理来推导温度估计量。\n\n任务 A（推导要求）：从正则密度出发，推导两个独立的温度估计量：\n- 一个基于动量和动能结构的动能定义。\n- 一个基于坐标空间平均的位形定义，该定义涉及势 $V(q)$ 的导数。\n您的推导必须明确指出在何种正则性条件下，每个估计量在正则系综中等于热力学温度 $T$，并且必须指明使边界项消失所需的任何假设。\n\n任务 B（计算要求）：实现一个程序，对于给定的势 $V(q)$ 和参数选择，将位形估计量计算为定义在 $q \\in (-\\infty,\\infty)$ 上的非归一化正则积分之比，并将其与动能估计量进行比较。在所有计算中，使用 $k_\\mathrm{B}=1$（约化单位），并以相同的约化单位报告温度。\n\n对于下面的每个测试用例，程序必须：\n- 定义 $V(q)$ 及其一阶和二阶导数 $V'(q)$ 和 $V''(q)$。\n- 使用数值收敛的求积法计算分子积分 $\\int_{-\\infty}^{\\infty} \\big[V'(q)\\big]^2 \\, e^{-\\beta V(q)} \\, dq$ 和分母积分 $\\int_{-\\infty}^{\\infty} V''(q) \\, e^{-\\beta V(q)} \\, dq$。\n- 将这两个积分的比值作为位形温度的估计值。\n- 仅使用正则密度的动量部分和哈密顿量 $H(q,p)$ 的二次型来设定动能温度估计值。\n- 对于每种情况，返回一个浮点数，其值为位形温度估计和动能温度估计之间的绝对差。将每个差值表示为一个无量纲数（约化单位），并四舍五入到六位小数。\n\n测试套件（所有符号代表实数；所有温度均在 $k_\\mathrm{B}=1$ 的约化单位下）：\n1. 谐振子势：$V(q) = \\dfrac{k}{2} q^2$，参数为 $(m,k,T) = (1.0,\\, 3.0,\\, 0.8)$。\n2. 非谐单阱势：$V(q) = \\dfrac{k}{2} q^2 + \\dfrac{a}{4} q^4$，参数为 $(m,k,a,T) = (1.0,\\, 0.5,\\, 1.0,\\, 0.8)$。\n3. 纯四次势：$V(q) = \\dfrac{a}{4} q^4$，参数为 $(m,a,T) = (2.0,\\, 1.5,\\, 0.5)$。\n4. 对称双阱势：$V(q) = \\dfrac{a}{4} (q^2 - b^2)^2$，参数为 $(m,a,b,T) = (1.0,\\, 2.0,\\, 1.2,\\, 0.6)$。\n5. 对称双阱势，较高温度：$V(q) = \\dfrac{a}{4} (q^2 - b^2)^2$，参数为 $(m,a,b,T) = (1.0,\\, 2.0,\\, 1.2,\\, 2.0)$。\n\n设计考虑和覆盖范围：\n- 谐振子情况测试了一个精确可解的二次型系统，已知在该系统中，两种估计量在正则系综中是一致的。\n- 非谐和纯四次势的情况测试了非二次型的坐标势，其中能量均分定理仍然约束动能部分，但位形估计量需要计算非平凡的积分。\n- 双阱势的情况测试了多模态和越垒物理；这些情况探测了位形估计量对曲率 $V''(q)$ 的敏感性，包括 $V''(q)$ 可能为负的区域，并要求正确处理积分中的抵消项。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，即 $[x_1,x_2,x_3,x_4,x_5]$，其中 $x_i$ 是测试用例 $i$ 的位形温度估计和动能温度估计之间的绝对差，四舍五入到六位小数。\n\n角度单位不适用。除了 $k_\\mathrm{B}=1$ 的约化单位外，没有出现其他物理单位；因此，在此约定下，所有报告的量都是无量纲的，并且必须按规定以浮点数形式给出。程序必须完全自包含且具有确定性，不需要用户输入，也不需要外部文件。", "solution": "我们从经典一维哈密顿量 $H(q,p) = \\dfrac{p^2}{2m} + V(q)$ 的正则系综出发。相空间上的正则概率密度为\n$$\n\\rho(q,p) = \\dfrac{1}{Z} \\exp\\!\\big(-\\beta H(q,p)\\big), \\quad \\beta = \\dfrac{1}{T}, \\quad Z = \\iint \\exp\\!\\big(-\\beta H(q,p)\\big)\\,dq\\,dp,\n$$\n所有量都在约化单位制下，其中玻尔兹曼常数 $k_\\mathrm{B} = 1$。\n\n系综平均定义为\n$$\n\\langle A \\rangle = \\iint A(q,p) \\, \\rho(q,p)\\, dq\\, dp = \\dfrac{1}{Z} \\iint A(q,p) \\, e^{-\\beta H(q,p)}\\, dq\\, dp.\n$$\n\n$H(q,p) = K(p) + V(q)$（其中 $K(p) = \\dfrac{p^2}{2m}$）的可分离形式意味着正则权重的因子分解：\n$$\ne^{-\\beta H(q,p)} = e^{-\\beta K(p)} \\, e^{-\\beta V(q)}.\n$$\n\n从第一性原理推导动能温度估计量：\n考虑一维动能的平均值，\n$$\n\\langle K \\rangle = \\left\\langle \\dfrac{p^2}{2m} \\right\\rangle = \\dfrac{1}{Z} \\int_{-\\infty}^{\\infty} e^{-\\beta V(q)} dq \\int_{-\\infty}^{\\infty} \\dfrac{p^2}{2m} e^{-\\beta \\frac{p^2}{2m}} dp.\n$$\n动量积分是标准的高斯积分。令 $I_0 = \\int_{-\\infty}^{\\infty} e^{-\\beta \\frac{p^2}{2m}} dp = \\sqrt{\\dfrac{2\\pi m}{\\beta}}$ 且 $I_2 = \\int_{-\\infty}^{\\infty} p^2 e^{-\\beta \\frac{p^2}{2m}} dp = \\sqrt{\\dfrac{2\\pi m}{\\beta}} \\dfrac{m}{\\beta}$。因此，\n$$\n\\left\\langle \\dfrac{p^2}{2m} \\right\\rangle = \\dfrac{1}{2m} \\dfrac{I_2}{I_0} = \\dfrac{1}{2m} \\cdot \\dfrac{m}{\\beta} = \\dfrac{1}{2\\beta} = \\dfrac{T}{2}.\n$$\n这是一维情况下二次自由度的能量均分定理的表述。它导出了动能温度估计量\n$$\nT_{\\mathrm{k}} = \\dfrac{2\\langle K \\rangle}{1} = \\dfrac{\\langle p^2 \\rangle}{m} = T,\n$$\n其中分母 $1$ 是一维下二次动量自由度的数量。在经典正则系综中，对于任何势 $V(q)$，等式 $T_{\\mathrm{k}} = T$ 都精确成立，只要高斯矩积分收敛（对于所有 $m0$ 和 $T0$ 都是如此）。\n\n从第一性原理推导位形温度估计量：\n定义关于位形权重 $w(q) \\propto e^{-\\beta V(q)}$ 的坐标空间平均：\n$$\n\\langle A \\rangle_q = \\dfrac{\\int_{-\\infty}^{\\infty} A(q) e^{-\\beta V(q)} \\, dq}{\\int_{-\\infty}^{\\infty} e^{-\\beta V(q)} \\, dq}.\n$$\n假设 $V(q)$ 是二阶连续可微的，当 $|q| \\to \\infty$ 时增长得足够快以至于 $e^{-\\beta V(q)} \\to 0$ 迅速收敛，并且在边界处 $V'(q) e^{-\\beta V(q)} \\to 0$。考虑积分\n$$\n\\int_{-\\infty}^{\\infty} V''(q) \\, e^{-\\beta V(q)} \\, dq.\n$$\n使用分部积分法，令 $u = V'(q)$ 和 $dv = e^{-\\beta V(q)} dq$，则 $du = V''(q) dq$ 和 $v = -\\dfrac{1}{\\beta} e^{-\\beta V(q)}$。利用边界条件将边界项设为零，我们得到\n$$\n\\int_{-\\infty}^{\\infty} V''(q) \\, e^{-\\beta V(q)} \\, dq = \\beta \\int_{-\\infty}^{\\infty} \\big[V'(q)\\big]^2 \\, e^{-\\beta V(q)} \\, dq.\n$$\n两边同除以 $\\int e^{-\\beta V(q)} dq$ 得到位形平均的恒等式：\n$$\n\\langle V''(q) \\rangle_q = \\beta \\, \\langle \\big[V'(q)\\big]^2 \\rangle_q.\n$$\n等价地，\n$$\nT_{\\mathrm{conf}} = \\dfrac{\\langle \\big[V'(q)\\big]^2 \\rangle_q}{\\langle V''(q) \\rangle_q} = T.\n$$\n这是一维形式的位形温度恒等式（是多位作者使用分部积分和几何公式推导出的恒等式的一个特例）。等式 $T_{\\mathrm{conf}} = T$ 成立的前提是所述的正则性和边界条件得到满足，且分母 $\\langle V''(q) \\rangle_q$ 不为零。\n\n数值评估的算法设计：\n- 对于每个测试势，明确定义 $V(q)$、$V'(q)$ 和 $V''(q)$。\n- 对于给定的温度 $T$，设置 $\\beta = 1/T$。\n- 计算两个非归一化积分\n$$\nN = \\int_{-\\infty}^{\\infty} \\big[V'(q)\\big]^2 \\, e^{-\\beta V(q)} \\, dq, \\quad D = \\int_{-\\infty}^{\\infty} V''(q) \\, e^{-\\beta V(q)} \\, dq.\n$$\n- 构建 $T_{\\mathrm{conf}} = N/D$。由于 $N$ 和 $D$ 都被相同的因子 $e^{-\\beta V(q)}$ 加权，因此无需计算配分函数或其归一化。\n- 根据精确的动能均分结果设定 $T_{\\mathrm{k}} = T$。\n- 对每种情况返回 $|T_{\\mathrm{conf}} - T_{\\mathrm{k}}|$，并四舍五入到六位小数。\n\n测试套件中使用的势及其导数：\n1. 谐振子势：$V(q) = \\dfrac{k}{2} q^2$，$V'(q) = k q$，$V''(q) = k$。\n2. 非谐势：$V(q) = \\dfrac{k}{2} q^2 + \\dfrac{a}{4} q^4$，$V'(q) = k q + a q^3$，$V''(q) = k + 3 a q^2$。\n3. 纯四次势：$V(q) = \\dfrac{a}{4} q^4$，$V'(q) = a q^3$，$V''(q) = 3 a q^2$。\n4–5. 双阱势：$V(q) = \\dfrac{a}{4}(q^2 - b^2)^2$，$V'(q) = a q (q^2 - b^2)$，$V''(q) = a(3 q^2 - b^2)$。\n\n数值考虑和限制：\n- 在具有二次型动能的经典正则系综中，动能估计量 $T_{\\mathrm{k}}$ 精确等于 $T$，且与 $V(q)$ 无关，因此在所述条件下，预期它会与 $T_{\\mathrm{conf}}$ 一致。\n- 计算值的差异可能源于数值求积误差，尤其是在较高温度（较小的 $\\beta$）下，此时积分在较大的 $|q|$ 处有显著贡献，或者由于当 $V''(q)$ 变号时 $D$ 中的抵消效应。\n- 在具有奇异或不可微势的系统中，位形估计量可能会失效；我们的测试套件通过使用光滑的束缚多项式来避免此类病态问题。\n- 在足够精确的求积容差下，返回的差异应非常小（接近于零），这反映了在数值精度范围内的理论相等性。\n\n所实现的程序对五个指定的测试用例执行这些步骤，并打印单行结果 $[x_1,x_2,x_3,x_4,x_5]$，其中包含四舍五入到六位小数的绝对差值。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\n# We work in reduced units with k_B = 1\n\ndef make_potential(pot_type, params):\n    \"\"\"\n    Return V(q), V'(q), V''(q) callables for the given potential type and parameters.\n    \"\"\"\n    if pot_type == \"harmonic\":\n        k = params[\"k\"]\n        def V(q): return 0.5 * k * q**2\n        def dV(q): return k * q\n        def d2V(q): return k + 0.0*q\n        return V, dV, d2V\n    elif pot_type == \"anharmonic\":\n        k = params[\"k\"]; a = params[\"a\"]\n        def V(q): return 0.5 * k * q**2 + 0.25 * a * q**4\n        def dV(q): return k * q + a * q**3\n        def d2V(q): return k + 3.0 * a * q**2\n        return V, dV, d2V\n    elif pot_type == \"quartic\":\n        a = params[\"a\"]\n        def V(q): return 0.25 * a * q**4\n        def dV(q): return a * q**3\n        def d2V(q): return 3.0 * a * q**2\n        return V, dV, d2V\n    elif pot_type == \"double_well\":\n        a = params[\"a\"]; b = params[\"b\"]\n        def V(q): return 0.25 * a * (q*q - b*b)**2\n        def dV(q): return a * q * (q*q - b*b)\n        def d2V(q): return a * (3.0 * q*q - b*b)\n        return V, dV, d2V\n    else:\n        raise ValueError(\"Unknown potential type\")\n\ndef configurational_temperature(beta, V, dV, d2V):\n    \"\"\"\n    Compute T_conf = N / D where\n      N = ∫ (dV)^2 e^{-beta V} dq\n      D = ∫ (d2V) e^{-beta V} dq\n    over q in (-inf, inf).\n    \"\"\"\n    # Define weighted integrands\n    def N_integrand(q):\n        dv = dV(q)\n        val = dv * dv\n        try:\n            w = np.exp(-beta * V(q))\n        except OverflowError:\n            # In rare overflow, weight is effectively zero\n            w = 0.0\n        return val * w\n\n    def D_integrand(q):\n        val = d2V(q)\n        try:\n            w = np.exp(-beta * V(q))\n        except OverflowError:\n            w = 0.0\n        return val * w\n\n    # Perform numerical quadrature with infinite bounds\n    # Tight tolerances to reduce numerical discrepancy\n    N_val, N_err = integrate.quad(N_integrand, -np.inf, np.inf, epsabs=1e-11, epsrel=1e-11, limit=200)\n    D_val, D_err = integrate.quad(D_integrand, -np.inf, np.inf, epsabs=1e-11, epsrel=1e-11, limit=200)\n\n    if D_val == 0.0:\n        # Avoid division by zero; return NaN to indicate estimator failure\n        return np.nan\n    return N_val / D_val\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a dict with: pot_type, params, m, T\n    test_cases = [\n        {\"pot_type\": \"harmonic\", \"params\": {\"k\": 3.0}, \"m\": 1.0, \"T\": 0.8},\n        {\"pot_type\": \"anharmonic\", \"params\": {\"k\": 0.5, \"a\": 1.0}, \"m\": 1.0, \"T\": 0.8},\n        {\"pot_type\": \"quartic\", \"params\": {\"a\": 1.5}, \"m\": 2.0, \"T\": 0.5},\n        {\"pot_type\": \"double_well\", \"params\": {\"a\": 2.0, \"b\": 1.2}, \"m\": 1.0, \"T\": 0.6},\n        {\"pot_type\": \"double_well\", \"params\": {\"a\": 2.0, \"b\": 1.2}, \"m\": 1.0, \"T\": 2.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        pot_type = case[\"pot_type\"]\n        params = case[\"params\"]\n        T_true = case[\"T\"]\n        beta = 1.0 / T_true\n\n        # Build potential and derivatives\n        V, dV, d2V = make_potential(pot_type, params)\n\n        # Kinetic temperature estimator equals T_true in canonical classical ensemble\n        T_kin = T_true\n\n        # Configurational temperature via numerical quadrature\n        T_conf = configurational_temperature(beta, V, dV, d2V)\n\n        # Absolute difference\n        diff = abs(T_conf - T_kin)\n        # Round to six decimal places in the output format\n        results.append(f\"{diff:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# solve() # The code should not be executed here but is provided for clarity.\n```", "answer": "[0.000000,0.000000,0.000000,0.000000,0.000000]", "id": "2673950"}]}