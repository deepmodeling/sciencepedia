{"hands_on_practices": [{"introduction": "过渡态理论 (TST) 的一个核心优势在于它将宏观可测的反应速率与过渡态的微观热力学性质联系起来。本练习提供了艾林方程最直接的应用，展示了如何将实验动力学数据转化为活化吉布斯自由能（$\\Delta G^{\\ddagger}$）。这个计算是掌握 TST 热力学表述的基石，因为它直接将实验观察与理论的核心量联系起来 [@problem_id:1526830]。", "problem": "羟基自由基（$\\cdot\\text{OH}$）与甲烷（$\\text{CH}_4$）之间的反应是决定甲烷在地球大气中寿命的关键过程。这个基元气相反应过程如下：\n$$ \\cdot\\text{OH}(\\text{g}) + \\text{CH}_4(\\text{g}) \\rightarrow \\text{H}_2\\text{O}(\\text{g}) + \\cdot\\text{CH}_3(\\text{g}) $$\n在 $300.0$ K 的温度下，实验测得该反应的二级反应速率常数为 $k_{exp} = 6.40 \\times 10^{-15}$ cm$^3$ molecule$^{-1}$ s$^{-1}$。\n\n根据这些信息，计算该反应的活化吉布斯自由能 $\\Delta G^{\\ddagger}$。活化吉布斯自由能是相对于 $C^{\\circ} = 1.00$ mol/L 的标准态浓度定义的。假设透射系数为 1。\n\n已知以下常数：\n玻尔兹曼常数，$k_B = 1.381 \\times 10^{-23}$ J K$^{-1}$\n普朗克常数，$h = 6.626 \\times 10^{-34}$ J s\n阿伏伽德罗常数，$N_A = 6.022 \\times 10^{23}$ mol$^{-1}$\n\n结果以千焦/摩尔（kJ/mol）为单位表示，并保留三位有效数字。", "solution": "我们使用带有标准态浓度校正的过渡态理论来处理双分子基元反应。在透射系数等于 1 的情况下，二级反应速率常数的艾林方程为\n$$\nk = \\frac{k_{B}T}{h}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right)\\,\\frac{1}{C^{\\circ}} \\,,\n$$\n重新整理得到\n$$\n\\Delta G^{\\ddagger} = - R T \\,\\ln\\!\\left(\\frac{k\\,h\\,C^{\\circ}}{k_{B}T}\\right).\n$$\n首先，使用 $1\\,\\text{cm}^{3} = 10^{-3}\\,\\text{L}$ 和 $1\\,\\text{mol} = N_{A}$ 个分子，将实验速率常数的单位从 $\\text{cm}^{3}\\,\\text{molecule}^{-1}\\,\\text{s}^{-1}$ 转换为 $\\text{L}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$：\n$$\nk = k_{\\text{exp}}\\times N_{A}\\times 10^{-3}\n= \\left(6.40\\times 10^{-15}\\right)\\left(6.022\\times 10^{23}\\right)\\left(10^{-3}\\right)\\,\\text{L}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}\n= 3.85408\\times 10^{6}\\,\\text{L}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}.\n$$\n根据给定的常数 $R = N_{A}k_{B}$ 计算气体常数：\n$$\nR = \\left(6.022\\times 10^{23}\\right)\\left(1.381\\times 10^{-23}\\right)\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} = 8.316382\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}.\n$$\n在 $T=300.0\\,\\text{K}$ 和 $C^{\\circ}=1.00\\,\\text{mol}\\,\\text{L}^{-1}$ 的条件下，计算对数项：\n$$\n\\frac{k\\,h\\,C^{\\circ}}{k_{B}T}\n= \\frac{\\left(3.85408\\times 10^{6}\\right)\\left(6.626\\times 10^{-34}\\right)}{\\left(1.381\\times 10^{-23}\\right)\\left(300.0\\right)}\n= 6.1639\\times 10^{-7}.\n$$\n因此，\n$$\n\\Delta G^{\\ddagger} = -\\left(8.316382\\times 300.0\\right)\\,\\ln\\!\\left(6.1639\\times 10^{-7}\\right)\\,\\text{J}\\,\\text{mol}^{-1}\n= 3.5676\\times 10^{4}\\,\\text{J}\\,\\text{mol}^{-1}\n= 35.7\\,\\text{kJ}\\,\\text{mol}^{-1},\n$$\n其中最终值按要求保留了三位有效数字。", "answer": "$$\\boxed{35.7}$$", "id": "1526830"}, {"introduction": "在理解了如何确定活化能垒后，我们进一步探索整个反应能量剖面。本练习探讨了正向和逆向反应的活化参数与总反应热力学（$\\Delta H^\\circ, \\Delta S^\\circ$）之间的关系 [@problem_id:1526820]。它强化了这样一个观点：过渡态是势能面上的单一瓶颈，理解其性质有助于我们表征双向的动力学过程，从而阐明微观可逆性原理。", "problem": "分子异构化是化学中许多领域（从材料科学到生物学）的一个基本过程。考虑一个分子在标准温度和压力下，在溶剂中发生的两种构象异构体（记为 A 和 B）之间的可逆异构化反应：\n$$\n\\text{A} \\rightleftharpoons \\text{B}\n$$\n根据过渡态理论的热力学表述，正反应（A $\\rightarrow$ B）的活化参数已通过实验确定。标准活化焓为 $\\Delta H_f^\\ddagger = +78.6 \\text{ kJ/mol}$，标准活化熵为 $\\Delta S_f^\\ddagger = -21.4 \\text{ J/(mol·K)}$。\n\n此外，该反应的整体热力学性质也已被表征。标准反应焓为 $\\Delta H^\\circ = -15.2 \\text{ kJ/mol}$，标准反应熵为 $\\Delta S^\\circ = +8.9 \\text{ J/(mol·K)}$。\n\n您的任务是计算逆反应（B $\\rightarrow$ A）的标准活化焓 $\\Delta H_r^\\ddagger$ 和标准活化熵 $\\Delta S_r^\\ddagger$。\n\n请将活化焓以 kJ/mol 为单位，活化熵以 J/(mol·K) 为单位表示。按此顺序给出您的两个答案，并保留三位有效数字。", "solution": "本题要求在给定正反应的活化参数和该过程的整体热力学性质的条件下，计算逆反应的活化参数。我们将使用从过渡态理论的热力学表述中导出的关系式。\n\n设 $H_A$ 和 $S_A$ 分别为反应物 A 的标准摩尔焓和熵，$H_B$ 和 $S_B$ 分别为产物 B 的标准摩尔焓和熵，$H_{TS}$ 和 $S_{TS}$ 分别为过渡态的标准摩尔焓和熵。\n\n总的标准反应焓 $\\Delta H^\\circ$ 和标准反应熵 $\\Delta S^\\circ$ 定义为产物与反应物之间的差值：\n$$\n\\Delta H^\\circ = H_B - H_A\n$$\n$$\n\\Delta S^\\circ = S_B - S_A\n$$\n\n正反应 A $\\rightarrow$ B 的标准活化焓和活化熵定义为过渡态与反应物 A 之间的差值：\n$$\n\\Delta H_f^\\ddagger = H_{TS} - H_A\n$$\n$$\n\\Delta S_f^\\ddagger = S_{TS} - S_A\n$$\n\n类似地，逆反应 B $\\rightarrow$ A 的标准活化焓和活化熵定义为过渡态与反应物 B（即正反应的产物）之间的差值：\n$$\n\\Delta H_r^\\ddagger = H_{TS} - H_B\n$$\n$$\n\\Delta S_r^\\ddagger = S_{TS} - S_B\n$$\n\n我们的目标是求出 $\\Delta H_r^\\ddagger$ 和 $\\Delta S_r^\\ddagger$。我们可以用给定的参数推导出这些量的表达式。\n\n对于逆反应的活化焓 $\\Delta H_r^\\ddagger$：\n我们可以将 $H_B$ 用 $H_A$ 和 $\\Delta H^\\circ$ 表示为 $H_B = H_A + \\Delta H^\\circ$。将此式代入 $\\Delta H_r^\\ddagger$ 的表达式中：\n$$\n\\Delta H_r^\\ddagger = H_{TS} - (H_A + \\Delta H^\\circ) = (H_{TS} - H_A) - \\Delta H^\\circ\n$$\n注意到 $(H_{TS} - H_A)$ 是 $\\Delta H_f^\\ddagger$ 的定义，我们得到关系式：\n$$\n\\Delta H_r^\\ddagger = \\Delta H_f^\\ddagger - \\Delta H^\\circ\n$$\n\n现在，我们代入给定的数值：\n$\\Delta H_f^\\ddagger = +78.6 \\text{ kJ/mol}$\n$\\Delta H^\\circ = -15.2 \\text{ kJ/mol}$\n$$\n\\Delta H_r^\\ddagger = (+78.6 \\text{ kJ/mol}) - (-15.2 \\text{ kJ/mol}) = 78.6 + 15.2 = 93.8 \\text{ kJ/mol}\n$$\n保留三位有效数字，则 $\\Delta H_r^\\ddagger = 93.8 \\text{ kJ/mol}$。\n\n接下来，对于逆反应的活化熵 $\\Delta S_r^\\ddagger$：\n根据同样的逻辑，我们将 $S_B$ 用 $S_A$ 和 $\\Delta S^\\circ$ 表示为 $S_B = S_A + \\Delta S^\\circ$。将此式代入 $\\Delta S_r^\\ddagger$ 的表达式中：\n$$\n\\Delta S_r^\\ddagger = S_{TS} - (S_A + \\Delta S^\\circ) = (S_{TS} - S_A) - \\Delta S^\\circ\n$$\n注意到 $(S_{TS} - S_A)$ 是 $\\Delta S_f^\\ddagger$ 的定义，我们得到关系式：\n$$\n\\Delta S_r^\\ddagger = \\Delta S_f^\\ddagger - \\Delta S^\\circ\n$$\n\n现在，我们代入给定的数值：\n$\\Delta S_f^\\ddagger = -21.4 \\text{ J/(mol·K)}$\n$\\Delta S^\\circ = +8.9 \\text{ J/(mol·K)}$\n$$\n\\Delta S_r^\\ddagger = (-21.4 \\text{ J/(mol·K)}) - (+8.9 \\text{ J/(mol·K)}) = -21.4 - 8.9 = -30.3 \\text{ J/(mol·K)}\n$$\n保留三位有效数字，则 $\\Delta S_r^\\ddagger = -30.3 \\text{ J/(mol·K)}$。\n\n因此，计算得出的逆反应活化焓为 93.8 kJ/mol，活化熵为 -30.3 J/(mol·K)。", "answer": "$$\\boxed{\\begin{pmatrix} 93.8 & -30.3 \\end{pmatrix}}$$", "id": "1526820"}, {"introduction": "从简单的解析计算过渡到更贴近现代研究的场景，本练习将介绍正则变分过渡态理论 (CVT)。CVT 是对 TST 的一种改进，它通过最小化沿反应坐标的速率来寻找“最佳”过渡态 [@problem_id:2682419]。本题演示了如何将 TST 的热力学公式应用于计算模拟（如平均力势）产生的数据，甚至包含了统计不确定性的处理，从而将理论与现代计算实践联系起来。", "problem": "给定一个由伞形采样沿标量反应坐标 $\\xi$ 得到的离散化的平均力势，表示为摩尔吉布斯自由能剖面 $G(\\xi)$。你的任务是推导、实现并评估一个数值程序，以使用过渡态理论 (TST) 的热力学表述在温度 $T$ 下计算典则变分过渡态理论 (CVT) 的单分子反应速率常数 $k_{\\mathrm{CVT}}(T)$，并根据已知的 $G(\\xi)$ 不确定度来估计其统计不确定度。\n\n推导起点：仅使用平衡统计力学和热力学的基本原理，包括（但不限于）典则系综、配分函数、自由能定义，以及沿反应坐标的约束配分函数与概率之间的关系。你可以做出以下假设：\n- 反应坐标 $\\xi$ 参数化了一系列候选分离面，当在 TST 近似中使用时，这些分离面通过构造禁止了重渡。\n- 摩尔吉布斯自由能 $G(\\xi)$ 是沿 $\\xi$ 的可逆功（平均力势），相差一个加法常数，并且与典则系综中沿 $\\xi$ 的边际概率密度相关。\n- 动力学重渡修正和隧穿修正被忽略（即，假设透射系数等于 $1$ 且没有量子隧穿）。\n\n数值评估的定义和约束：\n- 设离散网格为 $\\{\\xi_i\\}_{i=1}^{N}$，对应的 $G_i \\equiv G(\\xi_i)$ 以及每个 $G_i$ 的标准差为 $\\sigma_i$，并假设它们是统计独立且服从高斯分布的。\n- 通过一个索引 $i \\in \\{1,\\dots,r\\}$ 来定义一个反应物盆地区间，其中索引 $r$ 是给定的；反应物参考自由能 $G_{\\mathrm{R}}$ 是 $\\{G_i\\}_{i=1}^{r}$ 中的最小值。允许的分离面集合是索引集合 $\\{r+1, r+2, \\dots, N\\}$。\n- 使用一致的单位，以使指数是无量纲的。$G_i$ 的值以 $\\mathrm{kJ \\cdot mol^{-1}}$ 为单位提供。使用摩尔气体常数 $R$，单位为 $\\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$。使用玻尔兹曼常数 $k_{\\mathrm{B}}$，单位为 $\\mathrm{J \\cdot K^{-1}}$，以及普朗克常数 $h$，单位为 $\\mathrm{J \\cdot s}$。\n\n任务：\n1. 从热力学第一性原理出发，推导一个与位于 $\\xi$ 处的分离面相关的 TST 速率表达式，用 $G(\\xi)$、反应物参考自由能以及基本常数来表示。然后，解释 CVT 速率常数 $k_{\\mathrm{CVT}}(T)$ 是如何通过在允许的分离面上进行最小化而得到的。\n2. 给定离散的 $\\{G_i\\}$，提供一个数值稳定的算法来计算 $k_{\\mathrm{CVT}}(T)$，仅使用提供的数组和常数，并确保单位一致性。\n3. 统计不确定度：假设每个 $G_i$ 是一个独立的服从正态分布的随机变量，其均值为 $G_i$，标准差为 $\\sigma_i$。使用包含 $N_{\\mathrm{boot}}$ 个重复样本的参数化自举法来估计 $k_{\\mathrm{CVT}}(T)$ 的均值和标准差。为保证可复现性，请使用固定的随机种子。\n4. 报告：对于每个测试用例，报告两个浮点数：$k_{\\mathrm{CVT}}(T)$ 的自举均值（单位为 $\\mathrm{s^{-1}}$）和自举标准差（单位为 $\\mathrm{s^{-1}}$）。将每个浮点数四舍五入到 $6$ 位有效数字。最终程序输出必须是单行，包含一个逗号分隔的 Python 风格列表，其中包含所有测试用例的扁平化结果，顺序为 $[k_1, u_1, k_2, u_2, \\dots]$，其中 $k_j$ 是测试用例 $j$ 的自举均值，$u_j$ 是其自举标准差。\n\n要使用的常数：\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J \\cdot K^{-1}}$。\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$。\n- 摩尔气体常数 $R = 8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$。\n\n自举法配置：\n- 自举重复次数 $N_{\\mathrm{boot}} = 5000$。\n- 随机种子 $= 12345$。\n\n测试套件：\n为以下三个用例提供结果。在所有情况下，描述中的索引是基于 1 的，但您在代码中将以基于 0 的数组实现它们。\n- 用例 1（理想情况；中等势垒）：\n  - 温度 $T = 300\\ \\mathrm{K}$。\n  - 网格 $\\xi_i$：$N = 11$ 个点，$\\xi = \\{0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0\\}$。\n  - 自由能 $G(\\xi)$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：$\\{0, 8, 20, 35, 47, 50, 47, 35, 20, 8, 0\\}$。\n  - 标准差 $\\sigma$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：所有条目均等于 $0.5$。\n  - 反应物区间上界索引 $r = 1$（即，仅第一个点）。\n- 用例 2（边界情况；带噪声的平坦剖面）：\n  - 温度 $T = 300\\ \\mathrm{K}$。\n  - 网格 $\\xi_i$：与用例 1 相同。\n  - 自由能 $G(\\xi)$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：所有条目均等于 $0$。\n  - 标准差 $\\sigma$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：所有条目均等于 $0.2$。\n  - 反应物区间上界索引 $r = 1$。\n- 用例 3（升温下的稀疏高势垒）：\n  - 温度 $T = 500\\ \\mathrm{K}$。\n  - 网格 $\\xi_i$：$N = 5$ 个点，$\\xi = \\{0.0, 0.25, 0.5, 0.75, 1.0\\}$。\n  - 自由能 $G(\\xi)$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：$\\{0, 20, 40, 20, 0\\}$。\n  - 标准差 $\\sigma$，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$：$\\{0.2, 1.0, 2.0, 1.0, 0.2\\}$。\n  - 反应物区间上界索引 $r = 1$。\n\n数值要求：\n- 确保所有指数计算都使用一致的单位，即在与 $R T$ 形成无量纲比率之前，将 $\\mathrm{kJ \\cdot mol^{-1}}$ 转换为 $\\mathrm{J \\cdot mol^{-1}}$。\n- 最终速率常数必须以 $\\mathrm{s^{-1}}$ 为单位报告，并四舍五入到 $6$ 位有效数字。\n- 你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[k_1,u_1,k_2,u_2,k_3,u_3]$），其中每个 $k_j$ 和 $u_j$ 都是四舍五入到 $6$ 位有效数字的浮点数，单位为 $\\mathrm{s^{-1}}$。", "solution": "该问题要求推导并数值实现一个程序，以从离散的平均力势 $G(\\xi)$ 计算典则变分过渡态理论 (CVT) 的速率常数 $k_{\\mathrm{CVT}}(T)$，并估计其统计不确定度。解决方案首先验证问题陈述，确认其科学上合理且定义明确。然后，我们给出理论推导，接着是数值算法和统计分析方法。\n\n问题验证如下：\n- **给定条件**：离散的吉布斯自由能剖面 $\\{G_i(\\xi_i)\\}_{i=1}^{N}$ 及其相关不确定度 $\\{\\sigma_i\\}_{i=1}^{N}$，温度 $T$，反应物区间定义 $r$，基本常数 $k_{\\mathrm{B}}$、$h$、$R$，以及自举法参数 $N_{\\mathrm{boot}}$ 和随机种子。\n- **验证**：该问题科学上基于已建立的统计力学和化学动力学原理（过渡态理论）。它定义明确，为得到唯一解提供了所有必要的数据和定义。表述客观，没有歧义。未发现验证标准中列出的任何缺陷。因此，该问题是有效的，可以构建解决方案。\n\n**1. 从热力学原理推导 CVT 速率常数**\n\n过渡态理论 (TST) 通过假设反应物与位于分隔反应物和产物的分离面上的“活化络合物”之间存在准平衡，为化学反应速率常数提供了一个表达式。对于典则系综中的单分子反应，TST 速率常数 $k_{\\mathrm{TST}}$ 由下式给出：\n$$\nk_{\\mathrm{TST}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right)\n$$\n在这里，$k_{\\mathrm{B}}$ 是玻尔兹曼常数 ($1.380649 \\times 10^{-23}\\ \\mathrm{J \\cdot K^{-1}}$)，$h$ 是普朗克常数 ($6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$)，$T$ 是绝对温度，$R$ 是摩尔气体常数 ($8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$)，$\\Delta G^{\\ddagger}$ 是摩尔活化吉布斯自由能。\n\n平均力势 $G(\\xi)$ 表示系统摩尔吉布斯自由能随反应坐标 $\\xi$ 变化的函数。对于位于特定坐标 $\\xi$ 处的分离面，其活化吉布斯自由能 $\\Delta G^{\\ddagger}(\\xi)$ 是该分离面上的自由能与反应物参考自由能 $G_{\\mathrm{R}}$ 之间的差值：\n$$\n\\Delta G^{\\ddagger}(\\xi) = G(\\xi) - G_{\\mathrm{R}}\n$$\n因此，TST 速率常数是分离面选择 $\\xi$ 的函数：\n$$\nk(\\xi, T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{G(\\xi) - G_{\\mathrm{R}}}{RT}\\right)\n$$\nTST 的一个关键假设是，任何从反应物侧穿越分离面到产物侧的轨迹都将继续生成产物而不会发生重渡。这一假设通常不严格成立，导致 TST 提供了真实速率常数的上限。\n\n典则变分过渡态理论 (CVT) 通过寻找使计算出的速率常数最小化的最佳分离面来改进 TST。通过最小化速率，可以找到最能满足“无重渡”假设的分离面，从而得到更准确的速率估计。因此，CVT 速率常数 $k_{\\mathrm{CVT}}(T)$ 定义为：\n$$\nk_{\\mathrm{CVT}}(T) = \\min_{\\xi} k(\\xi, T)\n$$\n其中，最小化是在所有允许的分离面上进行的。\n\n由于对于给定的温度 $T$，前因子 $\\frac{k_{\\mathrm{B}}T}{h}$ 和分母 $RT$ 都是正常数，因此最小化 $k(\\xi, T)$ 等价于最大化指数的参数 $-(G(\\xi) - G_{\\mathrm{R}})$，这又等价于最大化自由能垒 $G(\\xi) - G_{\\mathrm{R}}$。这导出了 CVT 速率的核心表达式：\n$$\nk_{\\mathrm{CVT}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\left(\\max_{\\xi \\in \\text{DS}} G(\\xi)\\right) - G_{\\mathrm{R}}}{RT}\\right)\n$$\n其中 $\\text{DS}$ 表示允许的分离面集合。我们将 CVT 活化自由能定义为 $\\Delta G_{\\mathrm{CVT}}^{\\ddagger} = \\left(\\max_{\\xi \\in \\text{DS}} G(\\xi)\\right) - G_{\\mathrm{R}}$。\n\n**2. 离散数据的数值算法**\n\n问题在网格 $\\{\\xi_i\\}_{i=1}^{N}$ 上提供了一个离散的自由能剖面 $\\{G_i\\}_{i=1}^{N}$。给定反应物盆地由索引 $i \\in \\{1, \\dots, r\\}$ 定义，允许的分离面集合对应于索引 $i \\in \\{r+1, \\dots, N\\}$。计算 $k_{\\mathrm{CVT}}(T)$ 的算法如下，实现时使用 Python 标准的 0-基索引：\n\n- **步骤 A：确定反应物自由能 ($G_{\\mathrm{R}}$)**\n  反应物参考自由能 $G_{\\mathrm{R}}$ 是在定义的反应物区域内的最小自由能。\n  $$\n  G_{\\mathrm{R}} = \\min_{i \\in \\{0, \\dots, r-1\\}} G_i\n  $$\n\n- **步骤 B：确定过渡态自由能 ($G_{\\mathrm{CVT}}^{\\ddagger}$)**\n  变分过渡态的自由能是在所有允许的分离面集合上的最大自由能。\n  $$\n  G_{\\mathrm{CVT}}^{\\ddagger} = \\max_{i \\in \\{r, \\dots, N-1\\}} G_i\n  $$\n\n- **步骤 C：计算活化自由能 ($\\Delta G_{\\mathrm{CVT}}^{\\ddagger}$)**\n  活化能垒是过渡态自由能与反应物自由能之差。这里需要进行单位转换，因为输入的 $G_i$ 值单位是 $\\mathrm{kJ \\cdot mol^{-1}}$，而常数 $R$ 的单位是 $\\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$。\n  $$\n  \\Delta G_{\\mathrm{CVT}}^{\\ddagger}\\ [\\mathrm{J \\cdot mol^{-1}}] = (G_{\\mathrm{CVT}}^{\\ddagger} - G_{\\mathrm{R}})\\ [\\mathrm{kJ \\cdot mol^{-1}}] \\times 1000\n  $$\n\n- **步骤 D：计算 CVT 速率常数 ($k_{\\mathrm{CVT}}(T)$)**\n  将计算出的活化自由能代入 CVT 速率方程。得到的速率常数单位为 $\\mathrm{s^{-1}}$。\n  $$\n  k_{\\mathrm{CVT}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G_{\\mathrm{CVT}}^{\\ddagger}}{RT}\\right)\n  $$\n\n**3. 通过参数化自举法估计统计不确定度**\n\n计算出的速率常数 $k_{\\mathrm{CVT}}(T)$ 的不确定度源于输入自由能值 $\\{G_i\\}$ 的统计不确定度。我们已知每个 $G_i$ 是一个独立的随机变量，服从均值为给定值、标准差为 $\\sigma_i$ 的高斯分布，即 $G_i \\sim \\mathcal{N}(G_{i,\\text{mean}}, \\sigma_i^2)$。采用参数化自举法将这些不确定度传播到最终的速率常数上。\n\n该过程使用指定的重复次数 $N_{\\mathrm{boot}} = 5000$ 和一个固定的随机种子以保证可复现性，具体如下：\n\n1.  使用指定的种子 ($12345$) 初始化一个随机数生成器。\n2.  创建一个空列表 `k_samples`，用于存储速率常数的自举估计值。\n3.  对于从 $1$ 到 $N_{\\mathrm{boot}}$ 的每个重复样本 $j$：\n    a. 生成一个新的、合成的自由能剖面 $\\{G_i^{(j)}\\}_{i=0}^{N-1}$。对于每个索引 $i$，从正态分布 $\\mathcal{N}(G_i, \\sigma_i^2)$ 中抽取一个值 $G_i^{(j)}$。\n    b. 使用这个合成的剖面 $\\{G_i^{(j)}\\}$，通过应用上一节描述的四步数值算法，计算相应的速率常数 $k_{\\mathrm{CVT}}^{(j)}$。\n    c. 将计算出的速率 $k_{\\mathrm{CVT}}^{(j)}$ 添加到 `k_samples` 列表中。\n4.  完成所有自举重复后，计算 `k_samples` 分布的均值 ($\\bar{k}_{\\mathrm{CVT}}$) 和样本标准差 ($u_{\\mathrm{CVT}}$)。\n    $$\n    \\bar{k}_{\\mathrm{CVT}} = \\frac{1}{N_{\\mathrm{boot}}} \\sum_{j=1}^{N_{\\mathrm{boot}}} k_{\\mathrm{CVT}}^{(j)}\n    $$\n    $$\n    u_{\\mathrm{CVT}} = \\sqrt{\\frac{1}{N_{\\mathrm{boot}}-1} \\sum_{j=1}^{N_{\\mathrm{boot}}} (k_{\\mathrm{CVT}}^{(j)} - \\bar{k}_{\\mathrm{CVT}})^2}\n    $$\n5.  这两个值 $\\bar{k}_{\\mathrm{CVT}}$ 和 $u_{\\mathrm{CVT}}$ 分别代表速率常数的最佳估计值及其统计不确定度。然后将它们四舍五入到 $6$ 位有效数字进行报告。\n\n这个过程正确地传播了输入自由能的完整不确定度分布，考虑了 $G_i$ 值与 $k_{\\mathrm{CVT}}$ 之间的非线性关系，包括确定反应物最小值和过渡态最大值位置的不确定性。", "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_figures(value, sf):\n    \"\"\"\n    Rounds a floating-point number to a specified number of significant figures.\n    \"\"\"\n    if value == 0:\n        return 0.0\n    # Calculate the position to round to.\n    power = sf - 1 - int(math.floor(math.log10(abs(value))))\n    return round(value, power)\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases, calculating the CVT rate constant\n    and its uncertainty using a parametric bootstrap method.\n    \"\"\"\n\n    # --- Constants ---\n    # As specified in the problem statement\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck constant in J·s\n    R = 8.314462618     # Molar gas constant in J/(mol·K)\n\n    # --- Bootstrap Configuration ---\n    N_BOOT = 5000\n    RANDOM_SEED = 12345\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"T\": 300.0,  # K\n            \"G\": np.array([0., 8., 20., 35., 47., 50., 47., 35., 20., 8., 0.]),  # kJ/mol\n            \"sigma\": np.array([0.5] * 11),  # kJ/mol\n            \"r\": 1,  # 1-based index\n        },\n        {\n            \"T\": 300.0,\n            \"G\": np.array([0.0] * 11),\n            \"sigma\": np.array([0.2] * 11),\n            \"r\": 1,\n        },\n        {\n            \"T\": 500.0,\n            \"G\": np.array([0., 20., 40., 20., 0.]),\n            \"sigma\": np.array([0.2, 1.0, 2.0, 1.0, 0.2]),\n            \"r\": 1,\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        G_mean = case[\"G\"]\n        G_sigma = case[\"sigma\"]\n        # Convert 1-based reactant window index to 0-based slice upper bound\n        r_idx = case[\"r\"]\n\n        rng = np.random.default_rng(RANDOM_SEED)\n        \n        k_boot_samples = []\n\n        for _ in range(N_BOOT):\n            # 1. Generate a bootstrap replicate of the free energy profile\n            # G_sample is drawn from N(G_mean, G_sigma^2)\n            noise = rng.normal(loc=0.0, scale=1.0, size=G_mean.shape)\n            G_sample = G_mean + G_sigma * noise\n\n            # 2. Calculate k_CVT for the sampled profile\n            # Step A: Determine reactant free energy (using 0-based index)\n            G_R = np.min(G_sample[0:r_idx])\n            \n            # Step B: Determine transition state free energy\n            G_TS = np.max(G_sample[r_idx:])\n\n            # Step C: Calculate activation free energy in J/mol\n            delta_G_cvt_J_mol = (G_TS - G_R) * 1000.0\n\n            # Step D: Calculate the CVT rate constant\n            prefactor = (K_B * T) / H\n            exponent = -delta_G_cvt_J_mol / (R * T)\n            k_cvt = prefactor * np.exp(exponent)\n            \n            k_boot_samples.append(k_cvt)\n\n        # Calculate mean and standard deviation of the bootstrap samples\n        k_boot_samples = np.array(k_boot_samples)\n        k_mean = np.mean(k_boot_samples)\n        # Use ddof=1 for sample standard deviation\n        k_std_dev = np.std(k_boot_samples, ddof=1)\n        \n        # Round to 6 significant figures for reporting\n        k_mean_rounded = round_to_significant_figures(k_mean, 6)\n        k_std_dev_rounded = round_to_significant_figures(k_std_dev, 6)\n        \n        all_results.extend([k_mean_rounded, k_std_dev_rounded])\n\n    # Format the final output as a comma-separated list string\n    # Using a format specifier to avoid scientific notation for small numbers where possible\n    # and ensure standard float representation.\n    results_str = ','.join(f'{val:.15g}' for val in all_results)\n    print(f\"[{results_str}]\")\n\nsolve()\n```", "id": "2682419"}]}