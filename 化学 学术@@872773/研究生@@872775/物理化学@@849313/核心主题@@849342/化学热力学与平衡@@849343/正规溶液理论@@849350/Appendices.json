{"hands_on_practices": [{"introduction": "本章的第一个练习是正则溶液模型的一个基本应用。它侧重于从相互作用参数 $\\Omega$ 计算活度系数，活度系数是衡量非理想性的关键指标。掌握这一计算有助于巩固模型核心参数与其主要热力学预测之间的联系。[@problem_id:2002474]", "problem": "一位化学工程师正在研究一种由两种非极性有机化合物henone（组分A）和octol（组分B）组成的二元液体混合物。该混合物的热力学行为可以很好地用规整溶液模型来描述，该模型使用单个相互作用参数 $\\Omega$ 来解释与理想性的偏离。对于这种特定的混合物，在 $298 \\text{ K}$ 的恒定温度下，实验测得的相互作用参数为 $\\Omega = +5.00 \\text{ kJ mol}^{-1}$。计算当henone（组分A）的摩尔分数趋近于零时，其活度系数。使用普适气体常数 $R = 8.314 \\text{ J K}^{-1} \\text{mol}^{-1}$。将您的最终答案四舍五入到三位有效数字。", "solution": "对于具有单个相互作用参数的二元规整溶液，其超额吉布斯自由能由下式给出\n$$G^{E} = n x_{A} x_{B} \\Omega,$$\n其中 $n$ 是总摩尔数，$x_{A}$ 和 $x_{B}$ 是摩尔分数，$\\Omega$ 是相互作用参数。\n\n活度系数由超额化学势得出，\n$$\\mu_{i}^{E} = RT \\ln \\gamma_{i}, \\quad \\mu_{i}^{E} = \\left(\\frac{\\partial G^{E}}{\\partial n_{i}}\\right)_{T,P,n_{j\\neq i}}.$$\n对于 $G^{E} = \\Omega \\frac{n_{A} n_{B}}{n_{A}+n_{B}}$，在固定的 $n_{B}$ 下对 $n_{A}$ 求导：\n$$\\mu_{A}^{E} = \\Omega \\frac{n_{B}^{2}}{(n_{A}+n_{B})^{2}} = \\Omega x_{B}^{2}.$$\n因此，\n$$\\ln \\gamma_{A} = \\frac{\\mu_{A}^{E}}{RT} = \\frac{\\Omega}{RT} x_{B}^{2}.$$\n在 A 在 B 中的无限稀释极限下，$x_{A} \\to 0$ 且 $x_{B} \\to 1$，因此\n$$\\ln \\gamma_{A}^{\\infty} = \\frac{\\Omega}{RT}, \\quad \\gamma_{A}^{\\infty} = \\exp\\!\\left(\\frac{\\Omega}{RT}\\right).$$\n\n代入给定值，并将 $\\Omega$ 转换为一致的单位：\n$$\\Omega = 5.00 \\times 10^{3}\\ \\text{J mol}^{-1}, \\quad R = 8.314\\ \\text{J K}^{-1}\\ \\text{mol}^{-1}, \\quad T = 298\\ \\text{K},$$\n$$\\frac{\\Omega}{RT} = \\frac{5.00 \\times 10^{3}}{8.314 \\times 298} \\approx 2.018,$$\n$$\\gamma_{A}^{\\infty} = \\exp(2.018) \\approx 7.52.$$\n四舍五入到三位有效数字，活度系数为 $7.52$。", "answer": "$$\\boxed{7.52}$$", "id": "2002474"}, {"introduction": "最简单的正则溶液模型假设相互作用参数是一个常数，这意味着混合过程的超额熵为零。本练习挑战您探索一个更贴近现实的场景，即 $\\Omega$ 是温度的函数。通过运用基本的热力学关系，您将推导出这一扩展对其他超额性质（如焓和熵）的影响。[@problem_id:2002536]", "problem": "在非理想混合物（例如某些金属合金或聚合物共混物）的研究中，正规溶液模型提供了一个超越理想行为的有效的初步近似。对于由组分1和2组成的特定二元混合物，大量的实验测量表明，相互作用能参数 $\\Omega$ 不是一个常数，而是表现出对绝对温度 $T$ 的线性依赖关系。这种行为可以用经验关系式 $\\Omega = A + BT$ 来描述，其中 $A$ 和 $B$ 是该特定混合物的特征常数。设 $x_1$ 和 $x_2$ 分别是组分1和2的摩尔分数。该体系的超额摩尔吉布斯能由扩展的正规溶液模型给出，为 $G_m^E = \\Omega x_1 x_2$。\n\n使用基本热力学关系式，推导该体系的超额摩尔焓 $H_m^E$ 和超额摩尔熵 $S_m^E$ 的表达式。将你的最终答案以一对表达式的形式呈现，首先是 $H_m^E$ 的表达式，然后是 $S_m^E$ 的表达式。", "solution": "给定一个由扩展正规溶液模型描述的二元混合物，其超额摩尔吉布斯能为\n$$\nG_{m}^{E}=\\Omega x_{1}x_{2}, \\quad \\Omega=A+BT,\n$$\n其中 $A$ 和 $B$ 是常数，$x_{1},x_{2}$ 是摩尔分数。我们利用基本热力学来求解 $H_{m}^{E}$ 和 $S_{m}^{E}$。\n\n首先，在固定压力 $P$ 和组成下，使用超额摩尔熵的恒等式：\n$$\nS_{m}^{E}=-\\left(\\frac{\\partial G_{m}^{E}}{\\partial T}\\right)_{P,x}.\n$$\n在固定组成下，$x_{1}$ 和 $x_{2}$ 相对于 $T$ 是常数，而 $\\Omega$ 仅依赖于 $T$。因此，\n$$\n\\left(\\frac{\\partial G_{m}^{E}}{\\partial T}\\right)_{P,x}\n=\\left(\\frac{\\partial \\Omega}{\\partial T}\\right)_{P}x_{1}x_{2}.\n$$\n由于 $\\Omega=A+BT$，我们有 $\\left(\\frac{\\partial \\Omega}{\\partial T}\\right)_{P}=B$，因此\n$$\nS_{m}^{E}=-Bx_{1}x_{2}.\n$$\n\n接下来，通过 $G=H-TS$ 关联超额焓和吉布斯能，这意味着 $H=G+TS$。根据超额量的线性关系，\n$$\nH_{m}^{E}=G_{m}^{E}+TS_{m}^{E}.\n$$\n代入 $G_{m}^{E}=\\Omega x_{1}x_{2}$ 和 $S_{m}^{E}=-Bx_{1}x_{2}$ 得\n$$\nH_{m}^{E}=\\Omega x_{1}x_{2}+T\\left(-Bx_{1}x_{2}\\right)\n=\\left(\\Omega-T\\frac{\\partial \\Omega}{\\partial T}\\right)x_{1}x_{2}.\n$$\n由于 $\\Omega=A+BT$ 和 $\\frac{\\partial \\Omega}{\\partial T}=B$，上式变为\n$$\nH_{m}^{E}=Ax_{1}x_{2}.\n$$\n\n因此，所求的表达式为\n$$\nH_{m}^{E}=Ax_{1}x_{2}, \\quad S_{m}^{E}=-Bx_{1}x_{2}.\n$$", "answer": "$$\\boxed{H_m^E = Ax_1 x_2, \\quad S_m^E = -Bx_1 x_2}$$", "id": "2002536"}, {"introduction": "在现代化学工程和材料科学中，模型参数通常使用统计方法从实验数据中推断得出。这个高级计算练习将指导您构建一个贝叶斯框架，从气液平衡 (VLE) 数据中确定随温度变化的溶解度参数。这个问题弥合了理论模型与其实际、数据驱动的研究应用之间的鸿沟。[@problem_id:2665948]", "problem": "要求您在正规溶液理论框架内，仅使用第一性原理关系式作为建模基础，形式化并实现一个基于原理的贝叶斯参数推断方法，用于推断随温度变化的溶解度参数。您将构建一个人工合成且内部一致的汽液平衡数据集，然后对定义 Hildebrand 溶解度参数温度依赖性的参数执行最大后验估计。您的程序必须为一个小型测试套件返回表示通过/失败的布尔值，该测试套件用于检验不同的可辨识性机制。\n\n建模基础和定义，将作为唯一的出发点：\n- 正规溶液理论假定，每摩尔的超额摩尔吉布斯自由能 $g^E$ 由内聚能密度的不匹配决定。在 Scatchard–Hildebrand 模型中，超额自由能密度与溶解度参数之差的平方成正比。采用常见的体积分数线性混合规则，单位体积的超额自由能表示为 $g^{E}/\\bar{V} = \\phi_{1}\\,\\phi_{2}\\,(\\delta_{1}-\\delta_{2})^{2}$，其中 $\\phi_{i}$ 是组分 $i$ 的液相体积分数，$\\bar{V}$ 是混合物的摩尔体积，$\\delta_{i}$ 是组分 $i$ 的 Hildebrand 溶解度参数。\n- 活度系数 $\\gamma_{i}$ 由超额化学势的定义导出，通过 $\\ln \\gamma_{i} = \\mu_{i}^{E}/(R\\,T)$，其中 $\\mu_{i}^{E} = \\left(\\partial (n g^{E})/\\partial n_{i}\\right)_{T,P,n_{j\\neq i}}$，$R$ 是普适气体常数。\n- 在中低压下，修正的拉乌尔定律关联了平衡时的相组成：$y_{i}\\,P = x_{i}\\,\\gamma_{i}\\,P_{i}^{\\mathrm{sat}}(T)$，其中 $x_{i}$ 和 $y_{i}$ 分别是液相和汽相的摩尔分数，$P$ 是系统压力，$P_{i}^{\\mathrm{sat}}(T)$ 是组分 $i$ 在温度 $T$ 下的饱和压力。对于给定温度 $T$ 和液相组成的泡点计算，总压力满足 $P = \\sum_{i} x_{i}\\,\\gamma_{i}\\,P_{i}^{\\mathrm{sat}}(T)$，相应的汽相组成为 $y_{i} = x_{i}\\,\\gamma_{i}\\,P_{i}^{\\mathrm{sat}}(T)\\,\\big/ \\sum_{k} x_{k}\\,\\gamma_{k}\\,P_{k}^{\\mathrm{sat}}(T)$。\n- 一种与内聚能密度论据一致、简单且广泛使用的溶解度参数温度依赖性模型，是将溶解度参数的平方建模为温度 $T$ 的近似线性函数：$\\delta_{i}^{2}(T) = \\alpha_{i} - \\beta_{i}\\,T$，其中 $\\alpha_{i} > 0$ 且 $\\beta_{i} > 0$。这反映了内聚能密度由于热骚动而随温度升高而降低的现象。\n- 饱和压力可以用双参数 Clausius–Clapeyron 型关系式 $\\ln P_{i}^{\\mathrm{sat}}(T) = A_{i} - B_{i}/T$ 来建模。对数的底是自然对数。\n\n您的贝叶斯框架：\n- 参数化：从测量的汽液平衡组成中推断 $\\theta = (\\alpha_{1},\\beta_{1},\\alpha_{2},\\beta_{2})$。\n- 似然函数：假设在组分1的测量汽相组成上存在独立同分布的高斯观测噪声，其标准差 $\\sigma_{y}$ 已知。具体来说，如果模型在温度 $T_{m}$ 预测的值为 $y_{1}^{\\mathrm{model}}(T_{m};\\theta)$，则测量模型为 $y_{1}^{\\mathrm{obs}}(T_{m}) = y_{1}^{\\mathrm{model}}(T_{m};\\theta) + \\varepsilon_{m}$，其中 $\\varepsilon_{m} \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$ 且所有 $\\varepsilon_{m}$ 在不同的 $m$ 之间是独立的。\n- 由汽化能学信息决定的先验：内聚能密度近似满足 $\\delta_{i}^{2}(T)\\,V_{i} \\approx \\Delta E_{\\mathrm{coh},i}(T) \\approx \\Delta H_{\\mathrm{vap},i}(T) - R\\,T$，因此 $\\delta_{i}^{2}(T)$ 相对于 $T$ 的斜率量级约为 $R/V_{i}$。使用截断到物理上有意义的域 $\\alpha_{i} > 0$ 和 $\\beta_{i} > 0$ 的独立高斯先验：\n  - $\\alpha_{i} \\sim \\mathcal{N}(\\mu_{\\alpha},\\sigma_{\\alpha}^{2})$，其中 $\\mu_{\\alpha}$ 是 $\\delta^{2}$ 在环境条件下的一个典型量值，而 $\\sigma_{\\alpha}$ 足够宽以提供弱信息。\n  - $\\beta_{i} \\sim \\mathcal{N}(R/V_{i},\\sigma_{\\beta}^{2})$，其中 $\\sigma_{\\beta}$ 反映了温度导数估计中的不确定性。截断操作强制参数为正，从而保证 $\\delta_{i}^{2}(T)$ 随 $T$ 物理单调递减。\n- 后验：根据贝叶斯定理，$p(\\theta\\mid \\text{data}) \\propto p(\\text{data}\\mid \\theta)\\,p(\\theta)$。通过最小化负对数后验来计算最大后验 (MAP) 估计。使用边界 $\\alpha_{i} \\in [\\alpha_{\\min},\\alpha_{\\max}]$ 和 $\\beta_{i} \\in [\\beta_{\\min},\\beta_{\\max}]$ 来确保物理合理性和数值稳定性。\n\n使用的科学常数、单位和固定建模选择：\n- 普适气体常数：$R = 8.314\\times 10^{-6}\\,\\mathrm{MPa\\,m^{3}\\,mol^{-1}\\,K^{-1}}$。\n- 饱和压力模型参数（自然对数，压力单位为 $\\mathrm{bar}$）：$A_{1} = 10.000$, $B_{1} = 3200.0$, $A_{2} = 9.200$, $B_{2} = 2800.0$。因此 $\\ln P_{i}^{\\mathrm{sat}}(T) = A_{i} - B_{i}/T$，其中 $T$ 的单位是 $\\mathrm{K}$，$P_{i}^{\\mathrm{sat}}$ 的单位是 $\\mathrm{bar}$。\n- 活度系数模型：从上面给出的超额自由能基础和定义 $\\ln \\gamma_{i} = \\mu_{i}^{E}/(R\\,T)$ 导出 $\\ln \\gamma_{i}$。使用液相体积分数 $\\phi_{i} = x_{i} V_{i} / (x_{1} V_{1} + x_{2} V_{2})$，其中 $V_{i}$ 是纯液体摩尔体积，单位为 $\\mathrm{m^{3}\\,mol^{-1}}$。\n- 溶解度参数模型：$\\delta_{i}(T) = \\sqrt{\\max(\\epsilon, \\alpha_{i} - \\beta_{i}\\,T)}$，其中 $\\epsilon = 10^{-9}\\,\\mathrm{MPa}$ 以确保数值安全。报告和推断 $\\alpha_{i}$ 和 $\\beta_{i}$；所有隐含的 $\\delta_{i}$ 值的单位为 $\\mathrm{MPa^{1/2}}$，$\\delta_{i}^{2}$ 的单位为 $\\mathrm{MPa}$。\n- 先验：使用 $\\mu_{\\alpha} = 300.0\\,\\mathrm{MPa}$，$\\sigma_{\\alpha} = 100.0\\,\\mathrm{MPa}$，以及 $\\sigma_{\\beta} = 0.03\\,\\mathrm{MPa\\,K^{-1}}$。截断至 $\\alpha_{i} > 0$ 和 $\\beta_{i} > 0$。优化的边界：$\\alpha_{\\min} = 50.0\\,\\mathrm{MPa}$，$\\alpha_{\\max} = 600.0\\,\\mathrm{MPa}$，$\\beta_{\\min} = 0.01\\,\\mathrm{MPa\\,K^{-1}}$，$\\beta_{\\max} = 0.20\\,\\mathrm{MPa\\,K^{-1}}$。\n- 似然函数中的噪声标准差：$\\sigma_{y}$ 在下面的每个测试用例中指定；汽相组成为 $[0,1]$ 范围内的无量纲摩尔分数。\n\n需严格实现的人工数据生成协议：\n- 给定集合 $\\{T_{m}\\}_{m=1}^{M}$、液相组成 $x_{1}$（其中 $x_{2} = 1 - x_{1}$）、纯液体摩尔体积 $(V_{1},V_{2})$ 和真实的溶解度参数 $(\\alpha_{1}^{\\star},\\beta_{1}^{\\star},\\alpha_{2}^{\\star},\\beta_{2}^{\\star})$，计算：\n  - $\\delta_{i}(T_{m}) = \\sqrt{\\max(\\epsilon, \\alpha_{i}^{\\star} - \\beta_{i}^{\\star} T_{m})}$，\n  - 液相体积分数 $\\phi_{i}(T_{m}) = x_{i}\\,V_{i}/(x_{1} V_{1} + x_{2} V_{2})$，\n  - 由基本假设导出的正规溶液表达式计算的活度系数 $\\gamma_{i}(T_{m})$，\n  - 饱和压力 $P_{i}^{\\mathrm{sat}}(T_{m}) = \\exp(A_{i} - B_{i}/T_{m})$，单位为 $\\mathrm{bar}$，\n  - 泡点压力 $P_{\\mathrm{bub}}(T_{m}) = \\sum_{i=1}^{2} x_{i}\\,\\gamma_{i}(T_{m})\\,P_{i}^{\\mathrm{sat}}(T_{m})$，\n  - 汽相组成 $y_{1}^{\\mathrm{model}}(T_{m}) = x_{1}\\,\\gamma_{1}(T_{m})\\,P_{1}^{\\mathrm{sat}}(T_{m})/P_{\\mathrm{bub}}(T_{m})$，\n  - 观测值 $y_{1}^{\\mathrm{obs}}(T_{m}) = y_{1}^{\\mathrm{model}}(T_{m}) + \\varepsilon_{m}$，其中 $\\varepsilon_{m} \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$ 对于每个 $m$ 独立。\n- 使用固定的随机种子 $s = 1729$ 来抽取高斯噪声以保证可复现性。\n\n测试套件规范：\n提供三个具有不同可辨识性特征的案例。对于每个测试用例 $k \\in \\{1,2,3\\}$，您的程序必须使用指定的参数精确地生成上述人工数据，然后对 $\\theta = (\\alpha_{1},\\beta_{1},\\alpha_{2},\\beta_{2})$ 执行 MAP 估计。最后，使用相对误差标准将估计的参数 $\\hat{\\theta}$ 与真实参数 $\\theta^{\\star}$ 进行比较，并为该案例返回一个表示成功的布尔值。\n\n- 案例1（溶解度参数区分度良好的情况）：\n  - 温度（单位 $\\mathrm{K}$）：$[330.0, 340.0, 350.0, 360.0]$。\n  - 液相组成：$x_{1} = 0.5$。\n  - 摩尔体积（单位 $\\mathrm{m^{3}\\,mol^{-1}}$）：$V_{1} = 1.0\\times 10^{-4}$，$V_{2} = 1.0\\times 10^{-4}$。\n  - 真实参数（单位 $\\mathrm{MPa}$ 和 $\\mathrm{MPa\\,K^{-1}}$）：$(\\alpha_{1}^{\\star},\\beta_{1}^{\\star},\\alpha_{2}^{\\star},\\beta_{2}^{\\star}) = (340.0, 0.080, 260.0, 0.060)$。\n  - 观测噪声：$\\sigma_{y} = 0.005$。\n  - 通过标准：所有四个相对误差 $|\\hat{\\theta}_{j} - \\theta^{\\star}_{j}|/\\theta^{\\star}_{j}$ 小于 $0.20$。\n\n- 案例2（近理想溶液，弱信息数据）：\n  - 温度（单位 $\\mathrm{K}$）：$[330.0, 340.0, 350.0, 360.0]$。\n  - 液相组成：$x_{1} = 0.5$。\n  - 摩尔体积（单位 $\\mathrm{m^{3}\\,mol^{-1}}$）：$V_{1} = 1.0\\times 10^{-4}$，$V_{2} = 1.0\\times 10^{-4}$。\n  - 真实参数（单位 $\\mathrm{MPa}$ 和 $\\mathrm{MPa\\,K^{-1}}$）：$(\\alpha_{1}^{\\star},\\beta_{1}^{\\star},\\alpha_{2}^{\\star},\\beta_{2}^{\\star}) = (300.0, 0.080, 300.0, 0.080)$。\n  - 观测噪声：$\\sigma_{y} = 0.002$。\n  - 通过标准：所有四个相对误差小于 $0.35$。\n\n- 案例3（不对称的摩尔体积和组成）：\n  - 温度（单位 $\\mathrm{K}$）：$[330.0, 345.0, 360.0]$。\n  - 液相组成：$x_{1} = 0.3$。\n  - 摩尔体积（单位 $\\mathrm{m^{3}\\,mol^{-1}}$）：$V_{1} = 1.2\\times 10^{-4}$，$V_{2} = 0.8\\times 10^{-4}$。\n  - 真实参数（单位 $\\mathrm{MPa}$ 和 $\\mathrm{MPa\\,K^{-1}}$）：$(\\alpha_{1}^{\\star},\\beta_{1}^{\\star},\\alpha_{2}^{\\star},\\beta_{2}^{\\star}) = (370.0, 0.090, 240.0, 0.050)$。\n  - 观测噪声：$\\sigma_{y} = 0.005$。\n  - 通过标准：所有四个相对误差小于 $0.25$。\n\n算法要求：\n- 在独立高斯噪声下实现对数似然，在独立截断高斯分布下实现对数先验。将负对数后验构造为一个加权最小二乘项和来自先验的二次惩罚项之和。\n- 通过带边界约束的数值优化器计算 MAP 估计。在先验均值周围使用多次随机重启来减轻局部最小值问题，并返回找到的最佳解。\n- 所有温度单位必须是 $\\mathrm{K}$，压力单位是 $\\mathrm{bar}$，摩尔体积单位是 $\\mathrm{m^{3}\\,mol^{-1}}$，溶解度参数单位是 $\\mathrm{MPa^{1/2}}$，$\\delta_{i}^{2}$ 单位是 $\\mathrm{MPa}$。确保内部单位一致性。\n\n最终输出规范：\n- 对于每个测试用例 $k \\in \\{1,2,3\\}$，计算一个布尔值，指示是否满足通过标准。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_{1},result_{2},result_{3}]$）。每个 $result_{k}$ 必须是字符串 $\\texttt{True}$ 或 $\\texttt{False}$，按顺序 $k = 1,2,3$ 对应于测试用例 $k$ 的布尔值。", "solution": "我们从正规溶液的能量基础出发，通过串联基本热力学定义和贝叶斯估计程序来构建完整的框架。\n\n首先，针对正规混合物的 Scatchard–Hildebrand 假设指出，超额自由能密度由 $g^{E}/\\bar{V} = \\phi_{1}\\,\\phi_{2}\\,(\\delta_{1}-\\delta_{2})^{2}$ 给出，其中 $\\phi_{i}$ 表示组分 $i$ 的液相体积分数，$\\bar{V}$ 是溶液的摩尔体积。对于二元混合物，$\\phi_{i} = x_{i}\\,V_{i} / (x_{1} V_{1} + x_{2} V_{2})$，其中 $x_{i}$ 是液相摩尔分数，$V_{i}$ 是纯液体摩尔体积。\n\n活度系数由超额化学势的定义得出。物种 $i$ 的超额化学势由 $\\mu_{i}^{E} = \\left(\\partial (n\\,g^{E}) / \\partial n_{i}\\right)_{T,P,n_{j\\neq i}}$ 给出，活度系数通过 $\\ln \\gamma_{i} = \\mu_{i}^{E}/(R\\,T)$ 定义。为计算 $\\mu_{i}^{E}$，我们将总超额自由能写为 $n\\,g^{E} = n\\,\\bar{V}\\,\\phi_{1}\\,\\phi_{2}\\,(\\delta_{1}-\\delta_{2})^{2}$，并在恒定 $T$、$P$ 和 $n_{j\\neq i}$ 条件下对 $n_{i}$ 求导。使用 $\\phi_{i} = x_{i}\\,V_{i} / \\bar{V}$ 和 $\\bar{V} = x_{1} V_{1} + x_{2} V_{2}$，并保持 $V_{i}$ 恒定（不可压缩液体近似），经过简单的代数运算后，可以得到标准正规溶液表达式：\n$\\ln \\gamma_{1} = \\dfrac{V_{1}}{R\\,T}\\,\\phi_{2}^{2}\\,(\\delta_{1}-\\delta_{2})^{2}$ 和 $\\ln \\gamma_{2} = \\dfrac{V_{2}}{R\\,T}\\,\\phi_{1}^{2}\\,(\\delta_{1}-\\delta_{2})^{2}$。这些表达式与基本假设一致，并保持了交换标签时的对称性。\n\n接下来，我们关联相组成。在中低压下，忽略 Poynting 校正时，修正的拉乌尔定律适用：$y_{i}\\,P = x_{i}\\,\\gamma_{i}\\,P_{i}^{\\mathrm{sat}}(T)$。对于给定 $T$ 和 $x_{i}$ 的泡点计算，一致的总压力满足 $P = \\sum_{k=1}^{2} x_{k}\\,\\gamma_{k}(T)\\,P_{k}^{\\mathrm{sat}}(T)$，这导出了归一化的汽相组成\n$y_{i}(T) = \\dfrac{x_{i}\\,\\gamma_{i}(T)\\,P_{i}^{\\mathrm{sat}}(T)}{\\sum_{k=1}^{2} x_{k}\\,\\gamma_{k}(T)\\,P_{k}^{\\mathrm{sat}}(T)}$。\n对于饱和压力，我们使用双参数的 Clausius–Clapeyron 型关系式 $\\ln P_{i}^{\\mathrm{sat}}(T) = A_{i} - B_{i}/T$，其中使用自然对数且 $P_{i}^{\\mathrm{sat}}$ 单位为 $\\mathrm{bar}$。\n\n现在我们对溶解度参数的温度依赖性进行参数化，采用溶解度参数平方随温度线性变化的形式：\n$\\delta_{i}^{2}(T) = \\alpha_{i} - \\beta_{i}\\,T$，其中 $\\alpha_{i} > 0$ 和 $\\beta_{i} > 0$。这与内聚能密度的解释 $\\delta_{i}^{2}(T)\\,V_{i} \\approx \\Delta E_{\\mathrm{coh},i}(T) \\approx \\Delta H_{\\mathrm{vap},i}(T) - R\\,T$ 一致，该解释意味着随温度的斜率为负，并启发了斜率的量级约为 $R/V_{i}$。\n\n有了这些组件，对于温度为 $T_{m}$ 和液相组成为 $x_{1}$ 的数据点，其前向模型为：\n- 计算 $\\delta_{i}(T_{m}) = \\sqrt{\\max(\\epsilon,\\alpha_{i} - \\beta_{i}\\,T_{m})}$，其中 $\\epsilon$ 是一个小的正常数以保证数值安全。\n- 计算 $\\phi_{i}(T_{m}) = x_{i}\\,V_{i}/(x_{1} V_{1} + x_{2} V_{2})$。\n- 计算 $\\ln \\gamma_{1} = \\dfrac{V_{1}}{R\\,T_{m}}\\,\\phi_{2}^{2}\\,(\\delta_{1}-\\delta_{2})^{2}$ 和 $\\ln \\gamma_{2} = \\dfrac{V_{2}}{R\\,T_{m}}\\,\\phi_{1}^{2}\\,(\\delta_{1}-\\delta_{2})^{2}$，然后计算 $\\gamma_{i} = \\exp(\\ln \\gamma_{i})$。\n- 计算 $P_{i}^{\\mathrm{sat}}(T_{m}) = \\exp(A_{i} - B_{i}/T_{m})$ 和 $P_{\\mathrm{bub}}(T_{m}) = \\sum_{k} x_{k}\\,\\gamma_{k}(T_{m})\\,P_{k}^{\\mathrm{sat}}(T_{m})$。\n- 返回 $y_{1}^{\\mathrm{model}}(T_{m};\\theta) = x_{1}\\,\\gamma_{1}(T_{m})\\,P_{1}^{\\mathrm{sat}}(T_{m})/P_{\\mathrm{bub}}(T_{m})$。\n\n我们假设 $y_{1}$ 上的测量噪声为独立高斯噪声，其标准差 $\\sigma_{y}$ 已知。对于一个数据集 $\\{(T_{m},y_{1,m}^{\\mathrm{obs}})\\}_{m=1}^{M}$，其对数似然为\n$\\log p(\\{y_{1,m}^{\\mathrm{obs}}\\}\\mid \\theta) = -\\dfrac{1}{2}\\sum_{m=1}^{M}\\left[\\dfrac{\\left(y_{1,m}^{\\mathrm{obs}} - y_{1}^{\\mathrm{model}}(T_{m};\\theta)\\right)^{2}}{\\sigma_{y}^{2}} + \\ln(2\\pi\\sigma_{y}^{2})\\right]$。\n\n选择先验是为了编码来自汽化能学的物理约束：\n- 对于与 $\\delta_{i}^{2}$ 具有相同单位的 $\\alpha_{i}$，我们使用 $\\alpha_{i} \\sim \\mathcal{N}(\\mu_{\\alpha},\\sigma_{\\alpha}^{2})$ 并截断至 $\\alpha_{i} > 0$，这反映了 $\\delta^{2}$ 在中等温度下的典型量值，同时保持弱信息性。\n- 对于单位为 $\\mathrm{MPa\\,K^{-1}}$ 的 $\\beta_{i}$，我们使用 $\\beta_{i} \\sim \\mathcal{N}(R/V_{i},\\sigma_{\\beta}^{2})$ 并截断至 $\\beta_{i} > 0$，其动机来自于近似斜率 $\\partial \\delta_{i}^{2}/\\partial T \\approx -R/V_{i}$，该斜率由 $\\delta_{i}^{2}\\,V_{i} \\approx \\Delta H_{\\mathrm{vap},i} - R\\,T$ 在 $\\Delta H_{\\mathrm{vap},i}$ 变化缓慢的假设下得出。\n我们采用 $\\mu_{\\alpha} = 300.0\\,\\mathrm{MPa}$，$\\sigma_{\\alpha} = 100.0\\,\\mathrm{MPa}$，以及 $\\sigma_{\\beta} = 0.03\\,\\mathrm{MPa\\,K^{-1}}$。在兼容单位下，普适气体常数为 $R = 8.314\\times 10^{-6}\\,\\mathrm{MPa\\,m^{3}\\,mol^{-1}\\,K^{-1}}$，摩尔体积对每个测试用例是固定的。\n\n对数先验是高斯对数密度之和（忽略了对于MAP而言无关的常数偏移量的截断归一化常数），而对数后验是对数似然与对数先验之和。MAP估计是通过最小化负对数后验得到的，其约束条件为 $\\alpha_{i} \\in [\\alpha_{\\min},\\alpha_{\\max}]$ 和 $\\beta_{i} \\in [\\beta_{\\min},\\beta_{\\max}]$，其中 $\\alpha_{\\min} = 50.0\\,\\mathrm{MPa}$，$\\alpha_{\\max} = 600.0\\,\\mathrm{MPa}$，$\\beta_{\\min} = 0.01\\,\\mathrm{MPa\\,K^{-1}}$，以及 $\\beta_{\\max} = 0.20\\,\\mathrm{MPa\\,K^{-1}}$。在先验均值附近进行多次随机重启有助于避免局部最小值；我们保留找到的最佳（目标函数值最低的）解。\n\n人工数据生成使用相同的前向模型，但使用真实参数 $(\\alpha_{i}^{\\star},\\beta_{i}^{\\star})$ 来计算 $y_{1}^{\\mathrm{model}}(T_{m};\\theta^{\\star})$，然后添加独立的、由固定种子生成以确保可复现性的高斯噪声 $\\varepsilon_{m} \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$。Clausius–Clapeyron 参数固定为 $A_{1} = 10.000$，$B_{1} = 3200.0$，$A_{2} = 9.200$ 和 $B_{2} = 2800.0$，其中 $\\ln$ 是自然对数，$P_{i}^{\\mathrm{sat}}$ 的单位是 $\\mathrm{bar}$。尽管压力不直接进入似然函数，但它们通过泡点表达式中的归一化项影响了组成的预测。\n\n对于三个测试用例中的每一个，推断程序会输出一个估计值 $\\hat{\\theta}$，我们通过分量的相对误差 $|\\hat{\\theta}_{j} - \\theta^{\\star}_{j}|/\\theta^{\\star}_{j}$ 将其与真实值 $\\theta^{\\star}$ 进行比较。如果所有四个相对误差都低于该案例指定的阈值，则该案例通过。程序按规定的单行输出格式 $[\\texttt{True},\\texttt{False},\\texttt{True}]$ 汇总布尔值。\n\n该框架将热力学第一原理（正规溶液能量学、由超额化学势导出的活度系数、修正的拉乌尔定律）与贝叶斯推断以及基于能量学动机的先验（通过内聚能密度与汽化热的联系）相结合，提供了一种从汽液平衡数据推断随温度变化的溶解度参数的稳健且物理可解释的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\n# Fixed random seed for reproducibility of synthetic noise\nRNG = np.random.default_rng(1729)\n\n# Physical constants and model constants\nR = 8.314e-6  # MPa*m^3/(mol*K)\n# Clausius–Clapeyron parameters for ln P_sat (natural log), P in bar\nA1, B1 = 10.000, 3200.0\nA2, B2 = 9.200, 2800.0\n\n# Prior hyperparameters\nmu_alpha = 300.0  # MPa\nsigma_alpha = 100.0  # MPa\nsigma_beta = 0.03  # MPa/K\n\n# Bounds for parameters: alpha1, beta1, alpha2, beta2\nalpha_min, alpha_max = 50.0, 600.0\nbeta_min, beta_max = 0.01, 0.20\n\neps_delta2 = 1e-9  # MPa, safeguard for delta^2 positivity\n\n\ndef psat_ln(T, comp):\n    \"\"\"Natural log of saturation pressure in bar.\"\"\"\n    if comp == 1:\n        return A1 - B1 / T\n    else:\n        return A2 - B2 / T\n\n\ndef compute_activity_coeffs(T, x1, V1, V2, alpha1, beta1, alpha2, beta2):\n    \"\"\"\n    Compute gamma1, gamma2 using regular solution expressions:\n    ln γ1 = (V1/(R*T)) * φ2^2 * (δ1 - δ2)^2\n    ln γ2 = (V2/(R*T)) * φ1^2 * (δ1 - δ2)^2\n    \"\"\"\n    x2 = 1.0 - x1\n    # Volume fractions\n    Vm = x1 * V1 + x2 * V2\n    phi1 = (x1 * V1) / Vm\n    phi2 = (x2 * V2) / Vm\n\n    # Temperature-dependent solubility parameters\n    delta1_sq = max(eps_delta2, alpha1 - beta1 * T)\n    delta2_sq = max(eps_delta2, alpha2 - beta2 * T)\n    delta1 = np.sqrt(delta1_sq)\n    delta2 = np.sqrt(delta2_sq)\n    d12_sq = (delta1 - delta2) ** 2\n\n    ln_gamma1 = (V1 / (R * T)) * (phi2 ** 2) * d12_sq\n    ln_gamma2 = (V2 / (R * T)) * (phi1 ** 2) * d12_sq\n    return np.exp(ln_gamma1), np.exp(ln_gamma2)\n\n\ndef y1_model(Ts, x1, V1, V2, theta):\n    \"\"\"Compute y1 predictions for a sequence of temperatures.\"\"\"\n    alpha1, beta1, alpha2, beta2 = theta\n    y1s = []\n    for T in Ts:\n        gamma1, gamma2 = compute_activity_coeffs(T, x1, V1, V2, alpha1, beta1, alpha2, beta2)\n        P1_sat = np.exp(psat_ln(T, 1))\n        P2_sat = np.exp(psat_ln(T, 2))\n        x2 = 1.0 - x1\n        P_bub = x1 * gamma1 * P1_sat + x2 * gamma2 * P2_sat\n        y1 = (x1 * gamma1 * P1_sat) / P_bub\n        y1s.append(y1)\n    return np.array(y1s)\n\n\ndef neg_log_posterior(theta, Ts, y1_obs, x1, V1, V2, sigma_y):\n    \"\"\"Negative log-posterior: - (log-likelihood + log-prior).\"\"\"\n    alpha1, beta1, alpha2, beta2 = theta\n\n    # Enforce positivity via bounds; additional hard check\n    if alpha1 = 0.0 or alpha2 = 0.0 or beta1 = 0.0 or beta2 = 0.0:\n        return 1e300  # effectively infinite\n\n    y_pred = y1_model(Ts, x1, V1, V2, theta)\n    resid = (y1_obs - y_pred)\n    ll = -0.5 * np.sum((resid / sigma_y) ** 2) - 0.5 * len(Ts) * np.log(2.0 * np.pi * sigma_y ** 2)\n\n    # Priors: truncated Gaussians (omit normalization constants)\n    # alpha_i ~ N(mu_alpha, sigma_alpha^2), beta_i ~ N(R/V_i, sigma_beta^2)\n    beta1_mu = R / V1\n    beta2_mu = R / V2\n\n    lp_alpha = -0.5 * (((alpha1 - mu_alpha) / sigma_alpha) ** 2 + ((alpha2 - mu_alpha) / sigma_alpha) ** 2) \\\n               - 2.0 * np.log(sigma_alpha * np.sqrt(2.0 * np.pi))\n    lp_beta = -0.5 * (((beta1 - beta1_mu) / sigma_beta) ** 2 + ((beta2 - beta2_mu) / sigma_beta) ** 2) \\\n              - 2.0 * np.log(sigma_beta * np.sqrt(2.0 * np.pi))\n\n    lp = lp_alpha + lp_beta\n\n    return -(ll + lp)\n\n\ndef map_estimate(Ts, y1_obs, x1, V1, V2, sigma_y, n_restarts=8):\n    \"\"\"Compute MAP estimate with multiple random restarts.\"\"\"\n    bounds = [(alpha_min, alpha_max), (beta_min, beta_max),\n              (alpha_min, alpha_max), (beta_min, beta_max)]\n    best_val = np.inf\n    best_theta = None\n\n    # Prior means as central guesses\n    beta1_mu = R / V1\n    beta2_mu = R / V2\n    mean_guess = np.array([mu_alpha, beta1_mu, mu_alpha, beta2_mu], dtype=float)\n\n    for i in range(n_restarts):\n        # Randomize initial guess around prior means\n        init = mean_guess + RNG.normal(0.0, [30.0, 0.02, 30.0, 0.02])\n        # Project into bounds\n        init = np.array([\n            np.clip(init[0], alpha_min, alpha_max),\n            np.clip(init[1], beta_min, beta_max),\n            np.clip(init[2], alpha_min, alpha_max),\n            np.clip(init[3], beta_min, beta_max),\n        ])\n\n        res = minimize(\n            neg_log_posterior, init,\n            args=(Ts, y1_obs, x1, V1, V2, sigma_y),\n            method=\"L-BFGS-B\",\n            options={\"maxiter\": 1000, \"ftol\": 1e-12}\n        )\n        if res.fun  best_val and res.success:\n            best_val = res.fun\n            best_theta = res.x\n\n    # As a fallback, if optimization didn't succeed in any restart, return the prior means projected\n    if best_theta is None:\n        best_theta = mean_guess\n        best_theta[0] = np.clip(best_theta[0], alpha_min, alpha_max)\n        best_theta[1] = np.clip(best_theta[1], beta_min, beta_max)\n        best_theta[2] = np.clip(best_theta[2], alpha_min, alpha_max)\n        best_theta[3] = np.clip(best_theta[3], beta_min, beta_max)\n\n    return best_theta\n\n\ndef generate_synthetic_data(Ts, x1, V1, V2, true_theta, sigma_y):\n    \"\"\"Generate noisy y1 observations using the forward model and fixed RNG.\"\"\"\n    y_clean = y1_model(Ts, x1, V1, V2, true_theta)\n    noise = RNG.normal(0.0, sigma_y, size=len(Ts))\n    return y_clean + noise\n\n\ndef relative_errors(est, true):\n    \"\"\"Component-wise relative absolute error.\"\"\"\n    return np.abs((est - true) / true)\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict with Ts, x1, V1, V2, true_theta, sigma_y, rel_tol\n    test_cases = [\n        {\n            \"Ts\": np.array([330.0, 340.0, 350.0, 360.0]),\n            \"x1\": 0.5,\n            \"V1\": 1.0e-4,\n            \"V2\": 1.0e-4,\n            \"true_theta\": np.array([340.0, 0.080, 260.0, 0.060]),\n            \"sigma_y\": 0.005,\n            \"rel_tol\": 0.20,\n        },\n        {\n            \"Ts\": np.array([330.0, 340.0, 350.0, 360.0]),\n            \"x1\": 0.5,\n            \"V1\": 1.0e-4,\n            \"V2\": 1.0e-4,\n            \"true_theta\": np.array([300.0, 0.080, 300.0, 0.080]),\n            \"sigma_y\": 0.002,\n            \"rel_tol\": 0.35,\n        },\n        {\n            \"Ts\": np.array([330.0, 345.0, 360.0]),\n            \"x1\": 0.3,\n            \"V1\": 1.2e-4,\n            \"V2\": 0.8e-4,\n            \"true_theta\": np.array([370.0, 0.090, 240.0, 0.050]),\n            \"sigma_y\": 0.005,\n            \"rel_tol\": 0.25,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        Ts = case[\"Ts\"]\n        x1 = case[\"x1\"]\n        V1 = case[\"V1\"]\n        V2 = case[\"V2\"]\n        true_theta = case[\"true_theta\"]\n        sigma_y = case[\"sigma_y\"]\n        rel_tol = case[\"rel_tol\"]\n\n        # Generate synthetic observations\n        y1_obs = generate_synthetic_data(Ts, x1, V1, V2, true_theta, sigma_y)\n\n        # MAP estimation\n        theta_hat = map_estimate(Ts, y1_obs, x1, V1, V2, sigma_y, n_restarts=10)\n\n        # Evaluate relative error pass criterion\n        rel_errs = relative_errors(theta_hat, true_theta)\n        passed = bool(np.all(rel_errs = rel_tol))\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2665948"}]}