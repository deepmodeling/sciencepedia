{"hands_on_practices": [{"introduction": "深入理解理论概念的最佳方式之一是亲手进行推导。高斯型轨道（GTOs）之所以在量子化学计算中占据主导地位，其核心在于一个关键的数学特性：两个高斯函数的乘积是另一个高斯函数。这个“高斯乘积定理”极大地简化了双电子排斥积分的计算。本练习 [@problem_id:2625217] 将引导你从第一性原理出发，推导两个s型GTOs之间的重叠积分。完成这个推导不仅能让你掌握分子积分计算背后的数学机理，更能让你深刻体会到GTOs在计算上的优越性。", "problem": "在分子电子结构的基组背景下，考虑两个原始s型高斯型轨道（GTO），其中GTO是高斯型轨道，分别以正指数$\\alpha$和$\\beta$为中心，位于$\\mathbb{R}^{3}$中固定原子核的位置矢量$\\mathbf{A}$和$\\mathbf{B}$上。未归一化的基函数为\n$$\n\\chi_{A}(\\mathbf{r})=\\exp\\!\\big(-\\alpha|\\mathbf{r}-\\mathbf{A}|^{2}\\big), \\quad \\chi_{B}(\\mathbf{r})=\\exp\\!\\big(-\\beta|\\mathbf{r}-\\mathbf{B}|^{2}\\big).\n$$\n从第一性原理出发，仅使用诸如二次型配方法和标准多维高斯积分等经过充分检验的事实，推导并计算重叠积分\n$$\nS_{AB}=\\int_{\\mathbb{R}^{3}} \\chi_{A}(\\mathbf{r})\\,\\chi_{B}(\\mathbf{r})\\,d\\mathbf{r}=\\int_{\\mathbb{R}^{3}}\\exp\\!\\big(-\\alpha|\\mathbf{r}-\\mathbf{A}|^{2}\\big)\\exp\\!\\big(-\\beta|\\mathbf{r}-\\mathbf{B}|^{2}\\big)\\,d\\mathbf{r},\n$$\n并用$\\alpha$、$\\beta$和$R_{AB}=|\\mathbf{A}-\\mathbf{B}|$以闭合形式表示你的最终结果。你可以在推导中引用高斯乘积定理，但必须从基础代数和标准高斯积分出发，证明所有中间步骤。请以单一的解析表达式提供你的最终答案。最终答案中不包含任何单位。", "solution": "所述问题是有效的。这是理论化学中一个标准的、适定的问题，它具有科学依据、自洽且无歧义。它要求推导两个s型高斯型轨道之间的重叠积分，这是Hartree-Fock方法中的一个基本计算。我们将从第一性原理出发进行推导。\n\n重叠积分 $S_{AB}$ 定义为：\n$$\nS_{AB} = \\int_{\\mathbb{R}^{3}} \\chi_{A}(\\mathbf{r})\\,\\chi_{B}(\\mathbf{r})\\,d\\mathbf{r}\n$$\n代入未归一化的高斯型轨道 $\\chi_{A}(\\mathbf{r})$ 和 $\\chi_{B}(\\mathbf{r})$ 的表达式：\n$$\nS_{AB} = \\int_{\\mathbb{R}^{3}} \\exp\\left(-\\alpha|\\mathbf{r}-\\mathbf{A}|^{2}\\right) \\exp\\left(-\\beta|\\mathbf{r}-\\mathbf{B}|^{2}\\right) d\\mathbf{r}\n$$\n两个指数函数的乘积可以通过将其自变量相加合并为一个指数函数：\n$$\nS_{AB} = \\int_{\\mathbb{R}^{3}} \\exp\\left(-\\alpha|\\mathbf{r}-\\mathbf{A}|^{2} - \\beta|\\mathbf{r}-\\mathbf{B}|^{2}\\right) d\\mathbf{r}\n$$\n指数的自变量，我们记为 $Q(\\mathbf{r})$，是关于电子位置矢量 $\\mathbf{r}$ 的一个二次型。我们展开这个二次型：\n$$\nQ(\\mathbf{r}) = -\\alpha(\\mathbf{r}-\\mathbf{A})\\cdot(\\mathbf{r}-\\mathbf{A}) - \\beta(\\mathbf{r}-\\mathbf{B})\\cdot(\\mathbf{r}-\\mathbf{B})\n$$\n$$\nQ(\\mathbf{r}) = -\\alpha\\left(|\\mathbf{r}|^2 - 2\\mathbf{r}\\cdot\\mathbf{A} + |\\mathbf{A}|^2\\right) - \\beta\\left(|\\mathbf{r}|^2 - 2\\mathbf{r}\\cdot\\mathbf{B} + |\\mathbf{B}|^2\\right)\n$$\n根据对 $\\mathbf{r}$ 的依赖关系收集各项：\n$$\nQ(\\mathbf{r}) = -(\\alpha+\\beta)|\\mathbf{r}|^2 + 2(\\alpha\\mathbf{A}+\\beta\\mathbf{B})\\cdot\\mathbf{r} - (\\alpha|\\mathbf{A}|^2 + \\beta|\\mathbf{B}|^2)\n$$\n这个表达式展示了高斯乘积定理的核心：两个高斯函数的乘积是另一个高斯函数。为了明确这一点，我们必须对包含 $\\mathbf{r}$ 的项进行配方。我们定义一个新的复合指数 $p$ 和一个新的中心 $\\mathbf{P}$：\n$$\np = \\alpha+\\beta\n$$\n$$\n\\mathbf{P} = \\frac{\\alpha\\mathbf{A}+\\beta\\mathbf{B}}{\\alpha+\\beta}\n$$\n现在，我们将 $Q(\\mathbf{r})$ 改写为 $-p|\\mathbf{r}-\\mathbf{P}|^2 + \\text{常数}$ 的形式。让我们展开这个形式：\n$$\n-p|\\mathbf{r}-\\mathbf{P}|^2 = -p(\\mathbf{r}-\\mathbf{P})\\cdot(\\mathbf{r}-\\mathbf{P}) = -p\\left(|\\mathbf{r}|^2 - 2\\mathbf{r}\\cdot\\mathbf{P} + |\\mathbf{P}|^2\\right)\n$$\n代入 $p$ 和 $\\mathbf{P}$ 的表达式：\n$$\n-p|\\mathbf{r}-\\mathbf{P}|^2 = -(\\alpha+\\beta)|\\mathbf{r}|^2 + 2(\\alpha+\\beta)\\mathbf{r}\\cdot\\left(\\frac{\\alpha\\mathbf{A}+\\beta\\mathbf{B}}{\\alpha+\\beta}\\right) - p|\\mathbf{P}|^2\n$$\n$$\n-p|\\mathbf{r}-\\mathbf{P}|^2 = -(\\alpha+\\beta)|\\mathbf{r}|^2 + 2(\\alpha\\mathbf{A}+\\beta\\mathbf{B})\\cdot\\mathbf{r} - p|\\mathbf{P}|^2\n$$\n将其与我们得到的 $Q(\\mathbf{r})$ 表达式进行比较，我们发现：\n$$\nQ(\\mathbf{r}) = -p|\\mathbf{r}-\\mathbf{P}|^2 + p|\\mathbf{P}|^2 - (\\alpha|\\mathbf{A}|^2 + \\beta|\\mathbf{B}|^2)\n$$\n积分 $S_{AB}$ 现在可以改写为：\n$$\nS_{AB} = \\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}-\\mathbf{P}|^2 + p|\\mathbf{P}|^2 - \\alpha|\\mathbf{A}|^2 - \\beta|\\mathbf{B}|^2\\right) d\\mathbf{r}\n$$\n不依赖于 $\\mathbf{r}$ 的项形成一个常数预因子，可以提到积分外面：\n$$\nS_{AB} = \\exp\\left(p|\\mathbf{P}|^2 - \\alpha|\\mathbf{A}|^2 - \\beta|\\mathbf{B}|^2\\right) \\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}-\\mathbf{P}|^2\\right) d\\mathbf{r}\n$$\n首先，我们来化简预因子中的指数。代入 $p$ 和 $\\mathbf{P}$ 的定义：\n$$\np|\\mathbf{P}|^2 - \\alpha|\\mathbf{A}|^2 - \\beta|\\mathbf{B}|^2 = (\\alpha+\\beta)\\left|\\frac{\\alpha\\mathbf{A}+\\beta\\mathbf{B}}{\\alpha+\\beta}\\right|^2 - \\alpha|\\mathbf{A}|^2 - \\beta|\\mathbf{B}|^2\n$$\n$$\n= \\frac{(\\alpha\\mathbf{A}+\\beta\\mathbf{B})\\cdot(\\alpha\\mathbf{A}+\\beta\\mathbf{B})}{\\alpha+\\beta} - \\alpha|\\mathbf{A}|^2 - \\beta|\\mathbf{B}|^2\n$$\n$$\n= \\frac{\\alpha^2|\\mathbf{A}|^2 + 2\\alpha\\beta\\mathbf{A}\\cdot\\mathbf{B} + \\beta^2|\\mathbf{B}|^2}{\\alpha+\\beta} - \\frac{\\alpha(\\alpha+\\beta)|\\mathbf{A}|^2 + \\beta(\\alpha+\\beta)|\\mathbf{B}|^2}{\\alpha+\\beta}\n$$\n$$\n= \\frac{1}{\\alpha+\\beta} \\left[ (\\alpha^2|\\mathbf{A}|^2 + 2\\alpha\\beta\\mathbf{A}\\cdot\\mathbf{B} + \\beta^2|\\mathbf{B}|^2) - (\\alpha^2|\\mathbf{A}|^2 + \\alpha\\beta|\\mathbf{A}|^2 + \\alpha\\beta|\\mathbf{B}|^2 + \\beta^2|\\mathbf{B}|^2) \\right]\n$$\n$$\n= \\frac{1}{\\alpha+\\beta} \\left[ 2\\alpha\\beta\\mathbf{A}\\cdot\\mathbf{B} - \\alpha\\beta|\\mathbf{A}|^2 - \\alpha\\beta|\\mathbf{B}|^2 \\right]\n$$\n$$\n= -\\frac{\\alpha\\beta}{\\alpha+\\beta} \\left( |\\mathbf{A}|^2 - 2\\mathbf{A}\\cdot\\mathbf{B} + |\\mathbf{B}|^2 \\right) = -\\frac{\\alpha\\beta}{\\alpha+\\beta} |\\mathbf{A}-\\mathbf{B}|^2\n$$\n给定 $R_{AB} = |\\mathbf{A}-\\mathbf{B}|$，指数为 $-\\frac{\\alpha\\beta}{\\alpha+\\beta}R_{AB}^2$。因此，预因子为 $\\exp\\left(-\\frac{\\alpha\\beta}{\\alpha+\\beta}R_{AB}^2\\right)$。\n\n接下来，我们计算积分部分。我们进行变量替换 $\\mathbf{r}' = \\mathbf{r}-\\mathbf{P}$，其雅可比行列式为 $1$ 且 $d\\mathbf{r} = d\\mathbf{r}'$。积分区域仍为 $\\mathbb{R}^3$。\n$$\n\\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}-\\mathbf{P}|^2\\right) d\\mathbf{r} = \\int_{\\mathbb{R}^{3}} \\exp\\left(-p|\\mathbf{r}'|^2\\right) d\\mathbf{r}'\n$$\n这是一个标准的多维高斯积分。它在笛卡尔坐标 $\\mathbf{r}'=(x',y',z')$ 中是可分离的。\n$$\n\\int_{\\mathbb{R}^{3}} \\exp\\left(-p(x'^2+y'^2+z'^2)\\right) dx'dy'dz' = \\left(\\int_{-\\infty}^{\\infty} \\exp(-px^2)dx\\right)^3\n$$\n一维高斯积分有著名结果 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$。对于 $a=p0$，积分为 $\\sqrt{\\pi/p}$。\n因此，三维积分的计算结果为：\n$$\n\\left(\\sqrt{\\frac{\\pi}{p}}\\right)^3 = \\left(\\frac{\\pi}{p}\\right)^{3/2} = \\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2}\n$$\n最后，我们将预因子和积分结合起来，得到 $S_{AB}$ 的最终表达式：\n$$\nS_{AB} = \\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha\\beta}{\\alpha+\\beta}R_{AB}^2\\right)\n$$\n这就是两个原始s型高斯型轨道之间重叠积分的闭合形式表达式。推导完成。", "answer": "$$\n\\boxed{\\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha\\beta}{\\alpha+\\beta}R_{AB}^{2}\\right)}\n$$", "id": "2625217"}, {"introduction": "尽管GTOs在计算上十分便捷，但它们并非原子轨道的完美物理描述。相比之下，斯莱特型轨道（STOs）更接近氢原子薛定谔方程的精确解，尤其是在原子核附近。本练习 [@problem_id:2625227] 将通过探究电子-原子核尖点条件（cusp condition）来深入剖析这一关键的物理差异。你将首先从薛定谔方程出发推导出此条件，然后检验STO和GTO满足这一条件的情况，从而揭示GTO的一个根本性缺陷以及STO的一个核心优势。这种分析对于理解基组选择中固有的权衡至关重要。", "problem": "考虑一个质量为 $m_{e}$ 的单电子，在位于原点的电荷为 $Z$ 的固定原子核的库仑场中运动。在哈特里原子单位 (a.u.) 下进行计算，其中 $\\hbar=1$，$m_{e}=1$，且 $e^{2}/(4\\pi\\varepsilon_{0})=1$，因此势为 $V(r)=-Z/r$。从不含时薛定谔方程出发，并限定于s波（球对称）束缚态 $\\psi(r)$，通过平衡 $r\\to 0$ 时的主要奇异贡献，推导连接 $\\psi(r)$ 在 $r=0$ 处的值与其在 $r=0$ 处的一阶径向导数的短距离关系。你可以假设一个物理上可接受的s波解在原点是有限的，并且可以在 $r=0$ 附近进行泰勒级数展开。\n\n然后，考虑量子化学基组中使用的两种常见的s型试探轨道：\n- 高斯型轨道 (GTO)，$\\psi_{G}(r)=\\exp(-\\alpha r^{2})$，其中 $\\alpha0$，\n- 斯莱特型轨道 (STO)，$\\psi_{S}(r)=\\exp(-\\zeta r)$，其中 $\\zeta0$。\n\n对于每种试探函数，计算无量纲比率\n$$\nC \\equiv \\frac{\\left(\\frac{\\partial \\psi}{\\partial r}\\right)_{r=0}}{-Z\\,\\psi(0)}.\n$$\n以参数 $\\alpha$、$\\zeta$ 和 $Z$ 表示你的最终答案，形式为行矩阵 $\\bigl(C_{G},\\,C_{S}\\bigr)$。不需要进行数值取整。", "solution": "该问题需要分为两部分进行分析。首先，我们必须推导在库仑势中球对称波函数的电子-原子核尖点条件。其次，我们必须为两种常见的试探波函数——高斯型轨道 (GTO) 和斯莱特型轨道 (STO)——评估与此条件相关的特定比率。我们将在哈特里原子单位下进行计算，其中 $\\hbar = 1$，电子质量 $m_e = 1$，且元电荷的平方除以 $4\\pi\\varepsilon_0$ 也为 $1$。\n\n首先，我们推导一般关系。对于在势 $V(r) = -Z/r$ 中运动的单电子，其不含时薛定谔方程为：\n$$\n\\left( -\\frac{1}{2} \\nabla^2 + V(r) \\right) \\psi(\\vec{r}) = E \\psi(\\vec{r})\n$$\n对于s波态，波函数 $\\psi$ 是球对称的，因此 $\\psi(\\vec{r}) = \\psi(r)$。在球坐标系中，作用于球对称函数的拉普拉斯算符简化为：\n$$\n\\nabla^2 \\psi(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{d\\psi}{dr} \\right) = \\frac{d^2\\psi}{dr^2} + \\frac{2}{r} \\frac{d\\psi}{dr}\n$$\n将此式与势 $V(r) = -Z/r$ 代入薛定谔方程，我们得到s轨道的径向方程：\n$$\n-\\frac{1}{2} \\left( \\frac{d^2\\psi}{dr^2} + \\frac{2}{r} \\frac{d\\psi}{dr} \\right) - \\frac{Z}{r} \\psi(r) = E \\psi(r)\n$$\n为了分析在原子核附近的行为，即当 $r \\to 0$ 时，我们重新整理方程，根据各项对 $r$ 的依赖性进行分离：\n$$\n\\frac{d^2\\psi}{dr^2} + \\frac{2}{r} \\frac{d\\psi}{dr} + \\frac{2Z}{r} \\psi(r) + 2E \\psi(r) = 0\n$$\n根据题目陈述，我们假设 $\\psi(r)$ 在原点是有限的，并且可以在 $r=0$ 附近进行泰勒级数展开：\n$$\n\\psi(r) = \\psi(0) + \\left(\\frac{d\\psi}{dr}\\right)_{r=0} r + \\frac{1}{2} \\left(\\frac{d^2\\psi}{dr^2}\\right)_{r=0} r^2 + O(r^3)\n$$\n其中我们将 $\\psi(0)$、$(d\\psi/dr)_{r=0}$ 和 $(d^2\\psi/dr^2)_{r=0}$ 记为常数。一个物理上可接受的束缚态波函数必须处处有限，因此 $\\psi(0)$ 是一个有限值。\n为了继续，我们将整个径向薛定谔方程乘以 $r$：\n$$\nr \\frac{d^2\\psi}{dr^2} + 2 \\frac{d\\psi}{dr} + 2Z \\psi(r) + 2Er \\psi(r) = 0\n$$\n现在，我们取该方程在 $r \\to 0$ 时的极限。从泰勒级数展开中，我们观察到每一项的行为：\n- $\\lim_{r\\to 0} \\psi(r) = \\psi(0)$ (一个有限常数)\n- $\\lim_{r\\to 0} \\frac{d\\psi}{dr} = \\left(\\frac{d\\psi}{dr}\\right)_{r=0}$ (一个有限常数)\n- $\\lim_{r\\to 0} \\frac{d^2\\psi}{dr^2} = \\left(\\frac{d^2\\psi}{dr^2}\\right)_{r=0}$ (一个有限常数)\n\n将这些极限应用于我们的方程：\n$$\n\\lim_{r\\to 0} \\left( r \\frac{d^2\\psi}{dr^2} \\right) + \\lim_{r\\to 0} \\left( 2 \\frac{d\\psi}{dr} \\right) + \\lim_{r\\to 0} \\left( 2Z \\psi(r) \\right) + \\lim_{r\\to 0} \\left( 2Er \\psi(r) \\right) = 0\n$$\n各项的计算结果为：\n- $\\lim_{r\\to 0} \\left( r \\frac{d^2\\psi}{dr^2} \\right) = 0 \\cdot \\left(\\frac{d^2\\psi}{dr^2}\\right)_{r=0} = 0$\n- $\\lim_{r\\to 0} \\left( 2 \\frac{d\\psi}{dr} \\right) = 2 \\left(\\frac{d\\psi}{dr}\\right)_{r=0}$\n- $\\lim_{r\\to 0} \\left( 2Z \\psi(r) \\right) = 2Z \\psi(0)$\n- $\\lim_{r\\to 0} \\left( 2Er \\psi(r) \\right) = 2E \\cdot 0 \\cdot \\psi(0) = 0$\n在原方程中，包含 $d\\psi/dr$ 和 $\\psi(r)$ 的项是奇异性最强的项（与 $1/r$ 成正比）。通过平衡这些主要贡献，我们发现在 $r=0$ 处必须满足的关系式：\n$$\n2 \\left(\\frac{d\\psi}{dr}\\right)_{r=0} + 2Z \\psi(0) = 0\n$$\n这可以简化为s轨道的Kato尖点条件：\n$$\n\\left(\\frac{\\partial \\psi}{\\partial r}\\right)_{r=0} = -Z \\psi(0)\n$$\n这个关系是库仑势奇异性的直接结果，任何精确的本征函数都必须满足此条件。\n\n接下来，我们为给定的试探函数计算无量纲比率 $C \\equiv \\frac{(\\partial \\psi / \\partial r)_{r=0}}{-Z \\psi(0)}$。对于精确波函数，此比率应为 $C=1$。\n\n情况1：高斯型轨道 (GTO)\n试探函数为 $\\psi_G(r) = \\exp(-\\alpha r^2)$，其中 $\\alpha  0$。\n首先，我们计算该函数在原点的值：\n$$\n\\psi_G(0) = \\exp(-\\alpha \\cdot 0^2) = \\exp(0) = 1\n$$\n接下来，我们计算它对 $r$ 的一阶导数：\n$$\n\\frac{\\partial \\psi_G}{\\partial r} = \\frac{d}{dr} \\exp(-\\alpha r^2) = -2\\alpha r \\exp(-\\alpha r^2)\n$$\n计算在原点处的导数：\n$$\n\\left(\\frac{\\partial \\psi_G}{\\partial r}\\right)_{r=0} = -2\\alpha (0) \\exp(-\\alpha \\cdot 0^2) = 0\n$$\n现在我们计算比率 $C_G$：\n$$\nC_G = \\frac{\\left(\\frac{\\partial \\psi_G}{\\partial r}\\right)_{r=0}}{-Z \\psi_G(0)} = \\frac{0}{-Z \\cdot 1} = 0\n$$\nGTO未能满足尖点条件，因为它在原点的斜率为零。\n\n情况2：斯莱特型轨道 (STO)\n试探函数为 $\\psi_S(r) = \\exp(-\\zeta r)$，其中 $\\zeta  0$。\n我们计算该函数在原点的值：\n$$\n\\psi_S(0) = \\exp(-\\zeta \\cdot 0) = \\exp(0) = 1\n$$\n接下来，我们计算它对 $r$ 的一阶导数：\n$$\n\\frac{\\partial \\psi_S}{\\partial r} = \\frac{d}{dr} \\exp(-\\zeta r) = -\\zeta \\exp(-\\zeta r)\n$$\n计算在原点处的导数：\n$$\n\\left(\\frac{\\partial \\psi_S}{\\partial r}\\right)_{r=0} = -\\zeta \\exp(-\\zeta \\cdot 0) = -\\zeta\n$$\n现在我们计算比率 $C_S$：\n$$\nC_S = \\frac{\\left(\\frac{\\partial \\psi_S}{\\partial r}\\right)_{r=0}}{-Z \\psi_S(0)} = \\frac{-\\zeta}{-Z \\cdot 1} = \\frac{\\zeta}{Z}\n$$\n如果参数 $\\zeta$ 被选择为等于原子核电荷 $Z$，则STO可以满足尖点条件。对于一般的STO基函数，$\\zeta$ 是一个变分参数，该比率为 $\\zeta/Z$。\n\n因此，行矩阵 $(C_G, C_S)$ 的最终结果为 $(0, \\zeta/Z)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\zeta}{Z}\n\\end{pmatrix}\n}\n$$", "id": "2625227"}, {"introduction": "我们已经看到，GTOs计算高效但在原子核附近物理行为不正确，而STOs则恰恰相反。量子化学中的实用解决方案是集两者之长：用多个GTOs的线性组合来近似一个STO。这就是收缩基组（contracted basis sets）背后的理念，例如广受欢迎的STO-nG系列。这个动手编程练习 [@problem_id:2625171] 将让你亲手量化这种近似的精度。通过计算真实STO与其STO-nG近似的径向概率密度之间的误差，你将对收缩基组的工作原理，以及为何使用更多高斯函数（例如，从STO-1G到STO-3G）能够更好地模拟物理上正确的轨道形状，获得一个具体而深刻的认识。", "problem": "你需要编写一个程序，对于一个用斯莱特型轨道 (STO) 建模的单电子类氢体系，通过计算在有限径向区间上径向概率密度的均方误差，来量化斯莱特型轨道 n-高斯 (STO-nG) 收缩高斯型轨道 (GTOs) 的近似精度。该程序必须从第一性原理出发实现以下定义和原理，并执行数值积分以产生所要求的输出。\n\n需使用的基本定义：\n- 一个基态 s-轨道的斯莱特型轨道 (STO) 由以下形式的归一化波函数给出\n$$\n\\psi_{\\mathrm{STO}}(\\mathbf{r};\\zeta) \\equiv N_{\\mathrm{S}}(\\zeta)\\, e^{-\\zeta r},\n$$\n其中 $r \\equiv \\|\\mathbf{r}\\|$，$\\zeta  0$ 是以玻尔半径倒数为单位的斯莱特指数，$N_{\\mathrm{S}}(\\zeta)$ 是由以下条件决定的归一化常数\n$$\n\\int_{\\mathbb{R}^3} \\left|\\psi_{\\mathrm{STO}}(\\mathbf{r};\\zeta)\\right|^2 \\, d^3\\mathbf{r} \\;=\\; 1.\n$$\n\n- 一个基元 s-型高斯型轨道 (GTO) 定义为\n$$\ng_{\\alpha}(\\mathbf{r}) \\equiv N_{\\mathrm{G}}(\\alpha)\\, e^{-\\alpha r^2}, \\quad \\alpha  0,\n$$\n其归一化常数 $N_{\\mathrm{G}}(\\alpha)$ 由以下条件决定\n$$\n\\int_{\\mathbb{R}^3} \\left|g_{\\alpha}(\\mathbf{r})\\right|^2 \\, d^3\\mathbf{r} \\;=\\; 1.\n$$\n\n- 对 STO s-轨道的 STO-nG 收缩 GTO 近似为\n$$\n\\psi_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(\\mathbf{r};\\zeta) \\equiv \\sum_{i=1}^{n} c_i\\, g_{\\alpha_i(\\zeta)}(\\mathbf{r}),\n$$\n其中 $n \\in \\{1,2,3\\}$，$c_i$ 是收缩系数，$\\alpha_i(\\zeta)$ 是高斯指数，根据具有物理动机的规则从 $\\zeta = 1$ 时的列表值进行缩放\n$$\n\\alpha_i(\\zeta) \\;=\\; \\zeta^2 \\, \\alpha_i(\\zeta{=}1),\n$$\n由于归一化基元的标度不变性，系数 $c_i$ 随 $\\zeta$ 变化而保持不变。\n\n- s-轨道的径向概率密度（也称为径向分布函数）为\n$$\nP(r;\\psi) \\equiv 4\\pi r^2 \\left|\\psi(\\mathbf{r})\\right|^2 \\quad \\text{with } r \\in [0,\\infty).\n$$\n\n- 对于有限径向域 $r \\in [0,R_{\\max}]$（其中 $R_{\\max}  0$），定义 STO-nG 径向概率密度相对于 STO 的均方误差 (MSE) 为\n$$\n\\mathrm{MSE}(\\zeta,R_{\\max},n) \\;\\equiv\\; \\frac{1}{R_{\\max}} \\int_{0}^{R_{\\max}} \\left( P\\!\\left(r;\\psi_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(\\cdot;\\zeta)\\right) - P\\!\\left(r;\\psi_{\\mathrm{STO}}(\\cdot;\\zeta)\\right) \\right)^2 \\, dr.\n$$\n以 $\\mathrm{bohr}^{-2}$ 为单位报告 $\\mathrm{MSE}$。\n\n你的程序必须：\n- 实现上述积分约束所隐含的归一化常数。\n- 使用以下针对 $\\zeta = 1$ 时 $1s$ STO 的标准列表 STO-nG 参数（所有数值均为无量纲）：\n  - STO-1G ($n{=}1$):\n    - $(\\alpha_1,c_1) = (\\, $0.270950$ \\,,\\, $1.000000$ \\,)$\n  - STO-2G ($n{=}2$):\n    - $(\\alpha_1,c_1) = (\\, $0.151623$ \\,,\\, $0.678914$ \\,)$\n    - $(\\alpha_2,c_2) = (\\, $0.851819$ \\,,\\, $0.430129$ \\,)$\n  - STO-3G ($n{=}3$):\n    - $(\\alpha_1,c_1) = (\\, $0.109818$ \\,,\\, $0.444635$ \\,)$\n    - $(\\alpha_2,c_2) = (\\, $0.405771$ \\,,\\, $0.535328$ \\,)$\n    - $(\\alpha_3,c_3) = (\\, $2.227660$ \\,,\\, $0.154329$ \\,)$\n- 对于任意 $\\zeta  0$，通过 $\\alpha_i(\\zeta) = \\zeta^2 \\alpha_i$ 缩放指数，并保持 $c_i$ 不变。\n- 使用在 $[0,R_{\\max}]$ 上的可靠数值求积法，以高精度数值计算 MSE 积分。\n\n测试套件：\n你的程序必须评估并返回以下 5 种情况的 MSE，每种情况由一个元组 $(\\zeta, R_{\\max}, n)$ 定义，其中 $r$ 的单位为 bohr，$R_{\\max}$ 的单位也为 bohr：\n- 情况 1：$(\\, $1.0$ \\,,\\, $10.0$ \\,,\\, 1 \\,)$\n- 情况 2：$(\\, $1.0$ \\,,\\, $10.0$ \\,,\\, 3 \\,)$\n- 情况 3：$(\\, $1.0$ \\,,\\, $2.0$ \\,,\\, 3 \\,)$\n- 情况 4：$(\\, $2.0$ \\,,\\, $10.0$ \\,,\\, 3 \\,)$\n- 情况 5：$(\\, $0.5$ \\,,\\, $20.0$ \\,,\\, 3 \\,)$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。每个数字必须采用科学记数法，并精确到 $12$ 位有效数字。例如：\n$$\n[\\texttt{1.234567890123e-04},\\texttt{9.876543210000e-07},\\dots]\n$$\n\n科学和计算约束：\n- 距离 $r$ 使用 bohr 为单位，$\\mathrm{MSE}$ 以 $\\mathrm{bohr}^{-2}$ 为单位报告。\n- 角度不出现；不需要角度单位。\n- 通过使用函数的良态形式和在 $[0,R_{\\max}]$ 上的稳健数值求积法，确保在 $r{=}$ $0$ 处的数值稳定性。\n- 程序必须完全自包含，且不要求任何输入。", "solution": "我们从斯莱特型轨道 (STO) 和高斯型轨道 (GTO) 的归一化开始，然后构建收缩高斯近似，定义径向概率密度，最后通过数值求积定义并计算均方误差 (MSE)。\n\n1. $1s$ 轨道的归一化 STO。其一般形式为\n$$\n\\psi_{\\mathrm{STO}}(\\mathbf{r};\\zeta) \\equiv N_{\\mathrm{S}}(\\zeta) e^{-\\zeta r}.\n$$\n归一化要求\n$$\n1 = \\int_{\\mathbb{R}^3} |\\psi_{\\mathrm{STO}}(\\mathbf{r};\\zeta)|^2 d^3\\mathbf{r} = |N_{\\mathrm{S}}(\\zeta)|^2 \\int_{\\mathbb{R}^3} e^{-2\\zeta r} d^3\\mathbf{r}.\n$$\n使用球坐标，其中 $d^3\\mathbf{r} = 4\\pi r^2 dr$，\n$$\n\\int_{\\mathbb{R}^3} e^{-2\\zeta r} d^3\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} r^2 e^{-2\\zeta r} dr.\n$$\n对于 $a  0$，积分 $\\int_{0}^{\\infty} r^2 e^{-ar} dr = 2/a^3$。当 $a = 2\\zeta$ 时，其值为 $2/(2\\zeta)^3 = 1/(4\\zeta^3)$。因此\n$$\n4\\pi \\cdot \\frac{1}{4\\zeta^3} = \\frac{\\pi}{\\zeta^3}.\n$$\n于是 $|N_{\\mathrm{S}}(\\zeta)|^2 \\cdot \\pi/\\zeta^3 = 1$，得出\n$$\nN_{\\mathrm{S}}(\\zeta) = \\left(\\frac{\\zeta^3}{\\pi}\\right)^{1/2}.\n$$\n\n2. 归一化基元 s-型 GTO。其形式为\n$$\ng_{\\alpha}(\\mathbf{r}) \\equiv N_{\\mathrm{G}}(\\alpha) e^{-\\alpha r^2}.\n$$\n归一化要求\n$$\n1 = |N_{\\mathrm{G}}(\\alpha)|^2 \\int_{\\mathbb{R}^3} e^{-2\\alpha r^2} d^3\\mathbf{r} = |N_{\\mathrm{G}}(\\alpha)|^2 \\cdot \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}.\n$$\n因此\n$$\nN_{\\mathrm{G}}(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}.\n$$\n\n3. 收缩 STO-nG 近似及随 $\\zeta$ 的标度变换。收缩函数为\n$$\n\\psi_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(\\mathbf{r};\\zeta) \\equiv \\sum_{i=1}^{n} c_i\\, g_{\\alpha_i(\\zeta)}(\\mathbf{r}), \\quad \\alpha_i(\\zeta) \\equiv \\zeta^2 \\alpha_i(\\zeta{=}1).\n$$\n该收缩使用归一化基元 $g_{\\alpha}$ 和 $\\zeta{=}1$ 时的列表系数 $c_i$。标度变换规则源于变换 $\\mathbf{u} \\equiv \\zeta \\mathbf{r}$，在此变换下\n$$\ng_{\\alpha \\zeta^2}(\\mathbf{r}) = \\left(\\frac{2\\alpha\\zeta^2}{\\pi}\\right)^{3/4} e^{-\\alpha \\zeta^2 r^2} = \\zeta^{3/2} \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha u^2} = \\zeta^{3/2} g_{\\alpha}(\\mathbf{u}).\n$$\n因为由归一化基元构成的重叠矩阵在此标度变换下是不变的（雅可比行列式贡献了 $\\zeta^{-3}$，正好抵消了两个归一化因子带来的 $\\zeta^{3}$），所以在 $\\zeta{=}1$ 时产生最佳拟合的系数 $c_i$，在缩放后的指数 $\\alpha_i(\\zeta) = \\zeta^2 \\alpha_i$ 下也能保持最佳拟合形状，而 $c_i$ 本身不变。这是归一化高斯基元的标准标度不变性属性。\n\n4. 径向概率密度。对于任何球对称波函数 $\\psi(\\mathbf{r}) \\equiv \\psi(r)$，其径向概率密度为\n$$\nP(r;\\psi) \\equiv 4\\pi r^2 |\\psi(r)|^2, \\quad r \\in [0,\\infty).\n$$\n我们将使用\n$$\nP_{\\mathrm{STO}}(r;\\zeta) \\equiv 4\\pi r^2 \\left| \\left(\\frac{\\zeta^3}{\\pi}\\right)^{1/2} e^{-\\zeta r}\\right|^2 = 4\\pi r^2 \\left(\\frac{\\zeta^3}{\\pi}\\right) e^{-2\\zeta r} = 4 \\zeta^3 r^2 e^{-2\\zeta r},\n$$\n和\n$$\nP_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(r;\\zeta) \\equiv 4\\pi r^2 \\left|\\sum_{i=1}^n c_i \\left(\\frac{2\\alpha_i(\\zeta)}{\\pi}\\right)^{3/4} e^{-\\alpha_i(\\zeta) r^2}\\right|^2.\n$$\n\n5. 有限域上的均方误差。对于选定的有限径向区间 $[0,R_{\\max}]$（其中 $R_{\\max}  0$），定义\n$$\n\\mathrm{MSE}(\\zeta,R_{\\max},n) \\equiv \\frac{1}{R_{\\max}} \\int_{0}^{R_{\\max}} \\left( P_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(r;\\zeta) - P_{\\mathrm{STO}}(r;\\zeta) \\right)^2 \\, dr.\n$$\n量纲分析表明 $P$ 的单位是 $\\mathrm{bohr}^{-1}$（因为 $4\\pi r^2 |\\psi|^2\\, dr$ 是无量纲的），因此被积函数的单位是 $\\mathrm{bohr}^{-2}$，积分的单位是 $\\mathrm{bohr}^{-1}$。除以 $R_{\\max}$（单位为 bohr）后，得到 $\\mathrm{MSE}$ 的单位为 $\\mathrm{bohr}^{-2}$，符合要求。\n\n6. 数值评估。该积分在 $[0,R_{\\max}]$ 上是良态的，因为在 $r{=}0$ 附近 $P_{\\mathrm{STO}}$ 和 $P_{\\mathrm{STO}\\text{-}n\\mathrm{G}}$ 的行为都如同 $\\mathcal{O}(r^2)$，并且对于大的 $r$，其衰减速度不快于指数或高斯衰减。我们使用稳健的一维数值求积法计算该积分。可以使用诸如自适应 Gauss-Kronrod 数值求积之类的函数，并将绝对和相对容差设置得很小（例如 $\\leq$ $10^{-12}$）以达到高精度。\n\n7. $\\zeta{=}1$ 时的列表 STO-nG 参数。程序使用针对 $1s$ STO 的标准、广泛使用的参数集：\n- STO-1G ($n{=}1$): $(\\alpha_1,c_1) = (\\, $0.270950$ \\,,\\, $1.000000$ \\,)$.\n- STO-2G ($n{=}2$): $(\\alpha_1,c_1) = (\\, $0.151623$ \\,,\\, $0.678914$ \\,)$; $(\\alpha_2,c_2) = (\\, $0.851819$ \\,,\\, $0.430129$ \\,)$.\n- STO-3G ($n{=}3$): $(\\alpha_1,c_1) = (\\, $0.109818$ \\,,\\, $0.444635$ \\,)$; $(\\alpha_2,c_2) = (\\, $0.405771$ \\,,\\, $0.535328$ \\,)$; $(\\alpha_3,c_3) = (\\, $2.227660$ \\,,\\, $0.154329$ \\,)$.\n\n8. 每个测试用例 $(\\zeta,R_{\\max},n)$ 的算法摘要：\n- 计算 $N_{\\mathrm{S}}(\\zeta) = (\\zeta^3/\\pi)^{1/2}$ 并定义 $P_{\\mathrm{STO}}(r;\\zeta) = 4\\pi r^2 |N_{\\mathrm{S}}(\\zeta) e^{-\\zeta r}|^2$。\n- 对于所选 $n$ 中的每个基元，进行标度变换 $\\alpha_i(\\zeta) = \\zeta^2 \\alpha_i$ 并计算 $N_{\\mathrm{G}}(\\alpha_i(\\zeta)) = (2\\alpha_i(\\zeta)/\\pi)^{3/4}$。\n- 构建 $\\psi_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(r;\\zeta) = \\sum_{i=1}^{n} c_i N_{\\mathrm{G}}(\\alpha_i(\\zeta)) e^{-\\alpha_i(\\zeta) r^2}$，然后计算 $P_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(r;\\zeta) = 4\\pi r^2 |\\psi_{\\mathrm{STO}\\text{-}n\\mathrm{G}}(r;\\zeta)|^2$。\n- 在 $[0,R_{\\max}]$ 上对差的平方进行积分，然后除以 $R_{\\max}$ 以获得单位为 $\\mathrm{bohr}^{-2}$ 的 $\\mathrm{MSE}$。\n- 对所有指定的测试用例重复此过程。\n\n9. 输出格式化。将五个 $\\mathrm{MSE}$ 值报告为单行，形式为方括号内包含的逗号分隔列表，每个值都采用科学记数法格式，并精确到 $12$ 位有效数字，例如 $[\\texttt{1.234567890123e-04},\\dots]$。\n\n此过程测试了不同方面：在 $\\zeta{=}$ $1.0$ 和 $R_{\\max}{=}$ $10.0$ 下使用 $n{=}$ $1$ 和 $n{=}$ $3$ 的一般情况（理想路径和改进的拟合），对 $R_{\\max}{=}$ $2.0$ 的域截断的敏感性（边缘情况，强调近核行为），以及对更紧凑（$\\zeta{=}$ $2.0$）和更弥散（$\\zeta{=}$ $0.5$）轨道的行为。所有输出均为单位是 $\\mathrm{bohr}^{-2}$ 的实值浮点数，符合要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import pi, sqrt, exp\nfrom scipy.integrate import quad\n\n# Physical/mathematical primitives\n\ndef norm_sto_1s(zeta: float) - float:\n    # N_S(zeta) = (zeta^3 / pi)^(1/2)\n    return (zeta**3 / pi) ** 0.5\n\ndef norm_gto_s(alpha: float) - float:\n    # N_G(alpha) = (2*alpha / pi)^(3/4)\n    return (2.0 * alpha / pi) ** 0.75\n\ndef psi_sto_1s(r: float, zeta: float) - float:\n    return norm_sto_1s(zeta) * np.exp(-zeta * r)\n\ndef psi_sto_ng(r: float, zeta: float, n: int) - float:\n    # STO-nG parameters at zeta=1 (standard tabulated for 1s)\n    sto_ng_params = {\n        1: {\n            \"alpha\": np.array([0.270950], dtype=float),\n            \"c\":     np.array([1.000000], dtype=float),\n        },\n        2: {\n            \"alpha\": np.array([0.151623, 0.851819], dtype=float),\n            \"c\":     np.array([0.678914, 0.430129], dtype=float),\n        },\n        3: {\n            \"alpha\": np.array([0.109818, 0.405771, 2.227660], dtype=float),\n            \"c\":     np.array([0.444635, 0.535328, 0.154329], dtype=float),\n        },\n    }\n    if n not in sto_ng_params:\n        raise ValueError(\"Unsupported n for STO-nG. Allowed: 1, 2, 3.\")\n    alpha1 = sto_ng_params[n][\"alpha\"]\n    c = sto_ng_params[n][\"c\"]\n    # Scale exponents by zeta^2\n    alpha = (zeta**2) * alpha1\n    # Build contracted wavefunction value\n    # psi = sum_i c_i * N_G(alpha_i(zeta)) * exp(-alpha_i(zeta) * r^2)\n    Ng = (2.0 * alpha / pi) ** 0.75\n    return float(np.dot(c, Ng * np.exp(-alpha * r * r)))\n\ndef radial_density(psi_val: float, r: float) - float:\n    # P(r) = 4*pi*r^2 * |psi|^2\n    return 4.0 * pi * r * r * (psi_val * psi_val)\n\ndef mse_radial_density(zeta: float, rmax: float, n: int) - float:\n    # Define integrand of squared error in radial density\n    def integrand(r):\n        # Evaluate radial densities\n        psi_sto = psi_sto_1s(r, zeta)\n        psi_ng = psi_sto_ng(r, zeta, n)\n        p_sto = radial_density(psi_sto, r)\n        p_ng = radial_density(psi_ng, r)\n        diff = p_ng - p_sto\n        return diff * diff\n    # Integrate from 0 to rmax\n    integral, err = quad(integrand, 0.0, rmax, epsabs=1e-12, epsrel=1e-12, limit=200)\n    return integral / rmax  # units: bohr^-2\n\ndef solve():\n    # Define the test cases from the problem statement: (zeta, R_max, n)\n    test_cases = [\n        (1.0, 10.0, 1),  # Case 1\n        (1.0, 10.0, 3),  # Case 2\n        (1.0,  2.0, 3),  # Case 3\n        (2.0, 10.0, 3),  # Case 4\n        (0.5, 20.0, 3),  # Case 5\n    ]\n\n    results = []\n    for zeta, rmax, n in test_cases:\n        val = mse_radial_density(zeta, rmax, n)\n        results.append(val)\n\n    # Final print statement in the exact required format: scientific notation with 12 significant digits\n    formatted = \",\".join(f\"{x:.12e}\" for x in results)\n    print(f\"[{formatted}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2625171"}]}