{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的一维模型开始，该模型描述了两个电子态之间的相互作用。通过求解一个简化的 $2 \\times 2$ 哈密顿矩阵的本征值，我们可以将非对角的非绝热表象转换为对角的绝热表象。这项练习 [@problem_id:2881916] 将引导你推导出绝热势能面，并确定由于非绝热耦合存在而产生的最小能隙，这是理解避开交叉点（avoided crossing）拓扑结构的基础。", "problem": "考虑一个一维核坐标 $R$，它描述了在线性振动耦合模型中，两个电子非绝热态之间交叉线脊上的运动。在固定的 $R$ 下，非绝热电子哈密顿量是一个 $2\\times 2$ 矩阵\n$$\n\\hat{H}_{\\mathrm{dia}}(R) \\;=\\; \\begin{pmatrix}\nV_{11}(R)  V_{12} \\\\\nV_{12}  V_{22}(R)\n\\end{pmatrix},\n$$\n其中 $V_{11}(R)=\\alpha R$，$V_{22}(R)=-\\alpha R$，以及一个恒定的非绝热耦合 $V_{12}=V$。$\\alpha$ 和 $V$ 是实数参数，且 $V\\neq 0$。在绝热表象中，固定 $R$ 时的绝热电子能量被定义为 $\\hat{H}_{\\mathrm{dia}}(R)$ 的本征值，这与电子和核运动的 Born–Oppenheimer 分离相一致。仅使用不含时电子薛定谔方程以及绝热态是固定 $R$ 时电子哈密顿量的本征态这一定义，推导两个绝热能量作为 $R$ 的函数，然后确定在所有 $R$ 上它们之间的最小能隙。将后者解释为在最近点处的避免交叉能隙。\n\n以有序三元组 $\\big(E_{+}(R),\\,E_{-}(R),\\,\\Delta_{\\min}\\big)$ 的形式提供你的最终结果，其中 $E_{+}(R)$ 和 $E_{-}(R)$ 分别是上、下绝热能量，$\\Delta_{\\min}$ 是最小能隙。最终答案中无需进行数值计算或四舍五入，也无需单位。", "solution": "问题陈述清晰、自洽且科学上合理。它提出了一个量子力学中的标准练习，特别是线性振动耦合模型，这是理解非绝热动力学的基础。该问题提法得当，并为解决该问题提供了所有必要信息。我们将继续进行推导。\n\n绝热电子能量，记作 $E$，被定义为在固定核坐标 $R$ 时，非绝热电子哈密顿矩阵 $\\hat{H}_{\\mathrm{dia}}(R)$ 的本征值。找到这些能量需要解决给定哈密顿量的本征值问题。非绝热哈密顿量由下式给出：\n$$\n\\hat{H}_{\\mathrm{dia}}(R) \\;=\\; \\begin{pmatrix}\nV_{11}(R)  V_{12} \\\\\nV_{12}  V_{22}(R)\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n\\alpha R  V \\\\\nV  -\\alpha R\n\\end{pmatrix}\n$$\n本征值 $E$ 是特征多项式的根，该多项式通过求解久期方程 $\\det(\\hat{H}_{\\mathrm{dia}}(R) - E\\hat{I}) = 0$ 得到，其中 $\\hat{I}$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix}\n\\alpha R - E  V \\\\\nV  -\\alpha R - E\n\\end{pmatrix} = 0\n$$\n展开行列式得到以下方程：\n$$\n(\\alpha R - E)(-\\alpha R - E) - V^2 = 0\n$$\n通过识别第一项的结构，可以简化此表达式。我们可以将其写为 $-(\\alpha R - E)(\\alpha R + E)$，这是一个平方差：\n$$\n-((\\alpha R)^2 - E^2) - V^2 = 0 \\\\\nE^2 - (\\alpha R)^2 - V^2 = 0\n$$\n求解 $E^2$，我们得到：\n$$\nE^2 = (\\alpha R)^2 + V^2 = \\alpha^2 R^2 + V^2\n$$\n这两个本征值代表了绝热势能面，是该表达式的正负平方根：\n$$\nE(R) = \\pm\\sqrt{\\alpha^2 R^2 + V^2}\n$$\n根据定义，上绝热能量 $E_{+}(R)$ 对应正根，下绝热能量 $E_{-}(R)$ 对应负根。\n$$\nE_{+}(R) = \\sqrt{\\alpha^2 R^2 + V^2}\n$$\n$$\nE_{-}(R) = -\\sqrt{\\alpha^2 R^2 + V^2}\n$$\n这两个绝热态之间的能隙 $\\Delta E(R)$ 是它们的差：\n$$\n\\Delta E(R) = E_{+}(R) - E_{-}(R) = \\sqrt{\\alpha^2 R^2 + V^2} - \\left(-\\sqrt{\\alpha^2 R^2 + V^2}\\right) = 2\\sqrt{\\alpha^2 R^2 + V^2}\n$$\n为了确定最小能隙 $\\Delta_{\\min}$，我们必须找到函数 $\\Delta E(R)$ 相对于核坐标 $R$ 的最小值。$\\Delta E(R)$ 的最小值出现在平方根内的参数 $\\alpha^2 R^2 + V^2$ 被最小化的地方。\n\n对于实数参数 $\\alpha$ 和 $R$，项 $\\alpha^2 R^2$ 总是非负的。参数 $V$ 是一个非零实常数，所以 $V^2$ 是一个正常数。因此，当 $\\alpha^2 R^2$ 达到其最小值 $0$ 时，表达式 $\\alpha^2 R^2 + V^2$ 被最小化。这个条件在 $R=0$ 时满足。\n\n坐标 $R=0$ 对应于非绝热势能曲线 $V_{11}(R) = \\alpha R$ 和 $V_{22}(R) = -\\alpha R$ 相交的点。因为非绝热耦合 $V$ 不为零，绝热能量在这一点上不会变得简并，从而导致“避免交叉”。最小能隙 $\\Delta_{\\min}$ 是在 $R=0$ 这点计算出的 $\\Delta E(R)$ 的值。\n$$\n\\Delta_{\\min} = \\Delta E(0) = 2\\sqrt{\\alpha^2 (0)^2 + V^2} = 2\\sqrt{V^2}\n$$\n因为 $V$ 是一个实数参数，所以 $\\sqrt{V^2} = |V|$。能隙必须是一个非负量，因此这个绝对值在物理上是必需的。\n$$\n\\Delta_{\\min} = 2|V|\n$$\n因此，我们已经推导出了上绝热能量 $E_{+}(R)$、下绝热能量 $E_{-}(R)$ 和最小能隙 $\\Delta_{\\min}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\alpha^{2} R^{2} + V^{2}}  -\\sqrt{\\alpha^{2} R^{2} + V^{2}}  2|V| \\end{pmatrix}}\n$$", "id": "2881916"}, {"introduction": "与避开交叉点不同，锥形交叉点（conical intersection）为超快非辐射跃迁提供了更有效的途径，其关键在于非绝热耦合的独特性质。在此练习 [@problem_id:2881937] 中，我们将研究一个二维线性振动耦合模型，该模型是描述锥形交叉点的标准范式。你的任务是推导绝热态之间的导数耦合矢量，并揭示其在交叉点附近表现出的标志性 $1/r$ 奇异性，这是理解其高效动力学后果的数学基础。", "problem": "考虑一个用于描述锥形交叉的双态线性振动耦合 (LVC) 模型，该模型处于质量加权简正坐标 $x$ 和 $y$ 中。在一个与核坐标无关的非绝热电子基 $\\{|1\\rangle, |2\\rangle\\}$ 中，非绝热哈密顿量为\n$$\n\\hat{H}_{\\mathrm{d}}(x,y) \\;=\\; V_{0}\\,\\hat{I} \\;+\\; \n\\begin{pmatrix}\n\\kappa\\,x  \\lambda\\,y \\\\\n\\lambda\\,y  -\\kappa\\,x\n\\end{pmatrix},\n$$\n其中 $\\kappa$ 和 $\\lambda$ 为实正常数，$\\hat{I}$ 是单位算符。点 $x=y=0$ 是绝热势能面的一个锥形交叉点。\n\n设 $\\{|\\psi_{+}(x,y)\\rangle,\\,|\\psi_{-}(x,y)\\rangle\\}$ 表示 $\\hat{H}_{\\mathrm{d}}(x,y)$ 的绝热电子本征态，它们分别与较高和较低的绝热能量相关联，并由以下相位约定定义：\n$$\n|\\psi_{+}(x,y)\\rangle \\;=\\; \\cos\\!\\left(\\tfrac{\\theta(x,y)}{2}\\right)\\,|1\\rangle \\;+\\; \\sin\\!\\left(\\tfrac{\\theta(x,y)}{2}\\right)\\,|2\\rangle,\n$$\n$$\n|\\psi_{-}(x,y)\\rangle \\;=\\; -\\sin\\!\\left(\\tfrac{\\theta(x,y)}{2}\\right)\\,|1\\rangle \\;+\\; \\cos\\!\\left(\\tfrac{\\theta(x,y)}{2}\\right)\\,|2\\rangle,\n$$\n其中混合角 $\\theta(x,y)$ 定义为\n$$\n\\theta(x,y) \\;=\\; \\arctan2\\!\\big(\\lambda\\,y,\\;\\kappa\\,x\\big).\n$$\n\n使用两个绝热电子态之间的非绝热（导数）耦合矢量的定义，\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; \\langle \\psi_{+}(x,y) \\,|\\, \\boldsymbol{\\nabla}_{(x,y)} \\,\\psi_{-}(x,y) \\rangle,\n$$\n推导 $\\mathbf{d}_{+-}(x,y)$ 的一个闭式解析表达式，用 $x$、$y$、$\\kappa$ 和 $\\lambda$ 表示。然后，令 $r=\\sqrt{x^{2}+y^{2}}$ 并写作 $x=r\\cos\\varphi$, $y=r\\sin\\varphi$，从第一性原理出发证明当 $r\\to 0$ 时，其大小 $|\\mathbf{d}_{+-}(x,y)|$ 具有一个主导的 $1/r$ 奇点，并确定角向预因子为 $\\varphi$、$\\kappa$ 和 $\\lambda$ 的显式函数。\n\n将导数耦合矢量 $\\mathbf{d}_{+-}(x,y)$ 的最终答案表示为单一的闭式表达式。无需进行数值计算，最终答案中不应包含单位。最终答案必须写成一个 $1\\times 2$ 的行向量。", "solution": "该问题具有科学依据，提法恰当且客观。它是在量子化学领域中的一个标准练习，涉及一个广泛用于锥形交叉的模型，即线性振动耦合 (LVC) 模型。所有给出的定义和常数都是该领域的标准。目标陈述清晰，并且为完成这些目标提供了所有必要信息。因此，该问题被认为是有效的，并将给出解答。\n\n非绝热耦合矢量 $\\mathbf{d}_{+-}(x,y)$ 定义为核梯度算符 $\\boldsymbol{\\nabla}_{(x,y)} = \\hat{\\mathbf{x}}\\frac{\\partial}{\\partial x} + \\hat{\\mathbf{y}}\\frac{\\partial}{\\partial y}$ 在较高绝热电子态 $|\\psi_{+}(x,y)\\rangle$ 和较低绝热电子态 $|\\psi_{-}(x,y)\\rangle$ 之间的矩阵元：\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; \\langle \\psi_{+}(x,y) \\,|\\, \\boldsymbol{\\nabla}_{(x,y)} \\,\\psi_{-}(x,y) \\rangle\n$$\n绝热态在非绝热基 $\\{|1\\rangle, |2\\rangle\\}$ 中表示为：\n$$\n|\\psi_{+}(x,y)\\rangle \\;=\\; \\cos\\left(\\frac{\\theta(x,y)}{2}\\right)\\,|1\\rangle \\;+\\; \\sin\\left(\\frac{\\theta(x,y)}{2}\\right)\\,|2\\rangle\n$$\n$$\n|\\psi_{-}(x,y)\\rangle \\;=\\; -\\sin\\left(\\frac{\\theta(x,y)}{2}\\right)\\,|1\\rangle \\;+\\; \\cos\\left(\\frac{\\theta(x,y)}{2}\\right)\\,|2\\rangle\n$$\n根据定义，非绝热基矢量 $|1\\rangle$ 和 $|2\\rangle$ 与核坐标 $(x,y)$ 无关。因此，它们的梯度为零：$\\boldsymbol{\\nabla}_{(x,y)}|1\\rangle = \\mathbf{0}$ 且 $\\boldsymbol{\\nabla}_{(x,y)}|2\\rangle = \\mathbf{0}$。绝热态对 $(x,y)$ 的依赖性完全来自于混合角 $\\theta(x,y)$。\n\n我们首先计算较低的绝热态 $|\\psi_{-}(x,y)\\rangle$ 的梯度：\n$$\n\\boldsymbol{\\nabla}_{(x,y)} |\\psi_{-}(x,y)\\rangle \\;=\\; \\boldsymbol{\\nabla}_{(x,y)}\\left( -\\sin\\left(\\frac{\\theta}{2}\\right)\\,|1\\rangle \\;+\\; \\cos\\left(\\frac{\\theta}{2}\\right)\\,|2\\rangle \\right)\n$$\n应用链式法则：\n$$\n\\boldsymbol{\\nabla}_{(x,y)} |\\psi_{-}(x,y)\\rangle \\;=\\; -\\left(\\boldsymbol{\\nabla}_{(x,y)}\\sin\\left(\\frac{\\theta}{2}\\right)\\right)|1\\rangle \\;+\\; \\left(\\boldsymbol{\\nabla}_{(x,y)}\\cos\\left(\\frac{\\theta}{2}\\right)\\right)|2\\rangle\n$$\n$$\n\\;=\\; -\\cos\\left(\\frac{\\theta}{2}\\right)\\frac{\\boldsymbol{\\nabla}_{(x,y)}\\theta}{2}\\,|1\\rangle \\;-\\; \\sin\\left(\\frac{\\theta}{2}\\right)\\frac{\\boldsymbol{\\nabla}_{(x,y)}\\theta}{2}\\,|2\\rangle\n$$\n提出因子 $-\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta$：\n$$\n\\boldsymbol{\\nabla}_{(x,y)} |\\psi_{-}(x,y)\\rangle \\;=\\; -\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta \\left( \\cos\\left(\\frac{\\theta}{2}\\right)|1\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right)|2\\rangle \\right)\n$$\n括号中的表达式是较高的绝热态 $|\\psi_{+}(x,y)\\rangle$ 的定义。因此，我们有如下关系：\n$$\n\\boldsymbol{\\nabla}_{(x,y)} |\\psi_{-}(x,y)\\rangle \\;=\\; -\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta \\, |\\psi_{+}(x,y)\\rangle\n$$\n将此结果代入非绝热耦合矢量的定义中：\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; \\left\\langle \\psi_{+}(x,y) \\,\\left|\\, \\left(-\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta \\right) \\right|\\psi_{+}(x,y)\\right\\rangle\n$$\n由于 $\\boldsymbol{\\nabla}_{(x,y)}\\theta$ 是一个由核坐标的标量函数组成的矢量，它可以从电子内积中提出：\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; -\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta \\;\\langle \\psi_{+}(x,y) \\,|\\, \\psi_{+}(x,y) \\rangle\n$$\n绝热态是正交归一的，所以 $\\langle \\psi_{+}(x,y) \\,|\\, \\psi_{+}(x,y) \\rangle = 1$。这将耦合矢量的表达式简化为：\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; -\\frac{1}{2}\\boldsymbol{\\nabla}_{(x,y)}\\theta(x,y)\n$$\n接下来，我们必须计算混合角 $\\theta(x,y) = \\arctan2(\\lambda y, \\kappa x)$ 的梯度。$f(v,u) = \\arctan2(v,u)$ 关于变量 $q$ 的偏导数的一般公式是 $\\frac{\\partial f}{\\partial q} = \\frac{u \\frac{\\partial v}{\\partial q} - v \\frac{\\partial u}{\\partial q}}{u^2 + v^2}$。\n这里，$u = \\kappa x$ 且 $v = \\lambda y$。\n关于 $x$ 的偏导数是：\n$$\n\\frac{\\partial\\theta}{\\partial x} \\;=\\; \\frac{(\\kappa x)\\frac{\\partial(\\lambda y)}{\\partial x} - (\\lambda y)\\frac{\\partial(\\kappa x)}{\\partial x}}{(\\kappa x)^2 + (\\lambda y)^2} \\;=\\; \\frac{(\\kappa x)(0) - (\\lambda y)(\\kappa)}{\\kappa^2x^2 + \\lambda^2y^2} \\;=\\; \\frac{-\\kappa\\lambda y}{\\kappa^2x^2 + \\lambda^2y^2}\n$$\n关于 $y$ 的偏导数是：\n$$\n\\frac{\\partial\\theta}{\\partial y} \\;=\\; \\frac{(\\kappa x)\\frac{\\partial(\\lambda y)}{\\partial y} - (\\lambda y)\\frac{\\partial(\\kappa x)}{\\partial y}}{(\\kappa x)^2 + (\\lambda y)^2} \\;=\\; \\frac{(\\kappa x)(\\lambda) - (\\lambda y)(0)}{\\kappa^2x^2 + \\lambda^2y^2} \\;=\\; \\frac{\\kappa\\lambda x}{\\kappa^2x^2 + \\lambda^2y^2}\n$$\n因此，$\\theta(x,y)$ 的梯度是：\n$$\n\\boldsymbol{\\nabla}_{(x,y)}\\theta(x,y) \\;=\\; \\frac{\\kappa\\lambda}{\\kappa^2x^2 + \\lambda^2y^2} \\begin{pmatrix} -y \\\\ x \\end{pmatrix}\n$$\n将此代入 $\\mathbf{d}_{+-}(x,y)$ 的表达式中：\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; -\\frac{1}{2} \\left( \\frac{\\kappa\\lambda}{\\kappa^2x^2 + \\lambda^2y^2} \\begin{pmatrix} -y \\\\ x \\end{pmatrix} \\right) \\;=\\; \\frac{\\kappa\\lambda}{2(\\kappa^2x^2 + \\lambda^2y^2)} \\begin{pmatrix} y \\\\ -x \\end{pmatrix}\n$$\n这就是非绝热耦合矢量的闭式解析表达式。\n\n为了分析原点附近的行为，我们切换到极坐标，$x=r\\cos\\varphi$ 和 $y=r\\sin\\varphi$，其中 $r=\\sqrt{x^2+y^2}$。\n分母变为：\n$$\n\\kappa^2x^2 + \\lambda^2y^2 \\;=\\; \\kappa^2(r\\cos\\varphi)^2 + \\lambda^2(r\\sin\\varphi)^2 \\;=\\; r^2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)\n$$\n矢量分量变为：\n$$\n\\begin{pmatrix} y \\\\ -x \\end{pmatrix} \\;=\\; \\begin{pmatrix} r\\sin\\varphi \\\\ -r\\cos\\varphi \\end{pmatrix} \\;=\\; r\\begin{pmatrix} \\sin\\varphi \\\\ -\\cos\\varphi \\end{pmatrix}\n$$\n将这些代入 $\\mathbf{d}_{+-}$ 的表达式中：\n$$\n\\mathbf{d}_{+-}(r,\\varphi) \\;=\\; \\frac{\\kappa\\lambda}{2r^2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)} \\left( r\\begin{pmatrix} \\sin\\varphi \\\\ -\\cos\\varphi \\end{pmatrix} \\right) \\;=\\; \\frac{1}{r} \\left(\\frac{\\kappa\\lambda}{2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)} \\begin{pmatrix} \\sin\\varphi \\\\ -\\cos\\varphi \\end{pmatrix} \\right)\n$$\n这种形式明确地显示了当 $r \\to 0$ 时主导的 $1/r$ 奇点。为了求其大小，我们计算这个矢量的范数。角向矢量部分的范数是 $\\sqrt{\\sin^2\\varphi + (-\\cos\\varphi)^2} = \\sqrt{\\sin^2\\varphi + \\cos^2\\varphi} = 1$。\n因此，耦合矢量的大小是：\n$$\n|\\mathbf{d}_{+-}(r,\\varphi)| \\;=\\; \\frac{1}{r} \\left| \\frac{\\kappa\\lambda}{2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)} \\right|\n$$\n由于 $\\kappa$ 和 $\\lambda$ 是正常数，绝对值内的项总是正的。\n$$\n|\\mathbf{d}_{+-}(r,\\varphi)| \\;=\\; \\frac{1}{r} \\left( \\frac{\\kappa\\lambda}{2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)} \\right)\n$$\n这证实了 $1/r$ 奇点。角向预因子，我们可以将其表示为 $A(\\varphi)$，被确定为：\n$$\nA(\\varphi) \\;=\\; \\frac{\\kappa\\lambda}{2(\\kappa^2\\cos^2\\varphi + \\lambda^2\\sin^2\\varphi)}\n$$\n问题要求将 $\\mathbf{d}_{+-}(x,y)$ 的最终答案表示为单一的闭式表达式。\n$$\n\\mathbf{d}_{+-}(x,y) \\;=\\; \\begin{pmatrix} \\frac{\\kappa\\lambda y}{2(\\kappa^2x^2 + \\lambda^2y^2)}  \\frac{-\\kappa\\lambda x}{2(\\kappa^2x^2 + \\lambda^2y^2)} \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\kappa\\lambda y}{2(\\kappa^{2}x^{2} + \\lambda^{2}y^{2})} & \\frac{-\\kappa\\lambda x}{2(\\kappa^{2}x^{2} + \\lambda^{2}y^{2})}\n\\end{pmatrix}\n}\n$$", "id": "2881937"}, {"introduction": "理论分析为我们提供了静态图像，但要真正理解光化学反应，我们必须模拟分子在势能面上的实时运动。最少切换表面跳跃（FSSH）是一种强大的半经典方法，用于模拟非绝热动力学。这项综合性练习 [@problem_id:2881889] 要求你通过编程实现 FSSH 算法，模拟一个波包如何穿过一个可调的交叉区域。通过改变参数使系统从真实的锥形交叉点过渡到避开交叉点，你将亲眼观察到电子态布居数的变化，并计算出最终的产物分支比，从而将理论与可观测的动力学结果联系起来。", "problem": "给定一个在非绝热表象下的双态耦合二维线性振动耦合模型，单位为原子单位。其非绝热哈密顿量是一个实对称矩阵\n$$\n\\mathbf{H}_{\\mathrm{dia}}(x,y) \\;=\\; \n\\begin{pmatrix}\na\\,x  b\\,y + c_0 \\\\\nb\\,y + c_0  -a\\,x\n\\end{pmatrix},\n$$\n其中 $x$ 和 $y$ 是核坐标，$a$ 和 $b$ 是控制局部斜率和线性耦合的常数参数，$c_0$ 是一个可调常数，用于在真正的锥形交叉（当 $c_0 = 0$ 时）和避免交叉（当 $c_0 \\neq 0$ 时）之间进行插值。绝热能量是 $\\mathbf{H}_{\\mathrm{dia}}(x,y)$ 的本征值，绝热电子态是相应的归一化本征矢量。\n\n考虑一个经典核系综，其核质量为 $m$，在任意时刻于单个活性绝热势面上运动，并与根据绝热表象中的含时电子薛定谔方程进行量子力学演化的电子振幅相耦合。核运动遵循在活性势面上的牛顿第二定律。通过标准的最少切换表面跳跃算法来模拟核-电子动力学，其中：\n- 每条轨迹的核运动方程在当前活性绝热势面 $k$ 上的力 $-\\nabla E_k(x,y)$ 作用下进行传播。\n- 电子振幅在绝热电子哈密顿量的作用下演化，其中由核速度通过非绝热耦合矢量引起的绝热态之间的非绝热耦合。\n- 根据最少切换准则尝试绝热势面之间的随机跳跃，当跳跃发生时，通过沿非绝热耦合方向重新缩放核动量来保持总能量守恒。如果向上跳跃无法满足能量守恒，则拒绝该跳跃（受挫）。\n\n使用以下科学上一致的起点：\n- 在原子单位中，质量为 $m$ 的核的经典运动方程由 $m\\,\\ddot{\\mathbf{R}} = -\\nabla E_k(\\mathbf{R})$ 给出，其中 $E_k$ 是势面 $k$ 的绝热势能，$\\mathbf{R} = (x,y)$。\n- 绝热能量 $E_k(x,y)$ 和绝热本征矢量 $\\lvert \\phi_k(x,y) \\rangle$ 满足 $\\mathbf{H}_{\\mathrm{dia}}(x,y)\\lvert \\phi_k \\rangle = E_k \\lvert \\phi_k \\rangle$ 且 $\\langle \\phi_k \\vert \\phi_j \\rangle = \\delta_{kj}$，并且 Hellmann–Feynman 定理对绝热能量的梯度成立。\n\n实现约束和数据：\n- 所有量均使用原子单位。最终要求的输出是无量纲的分支比，必须报告为四舍五入到三位小数的浮点数。\n- 使用 $a = 0.02$，$b = 0.03$，$m = 2000$。\n- 初始化一个包含 $N$ 条独立经典轨迹的系综，其位置 $x(0) = -3.0$，$y(0)$ 从标准差为 $\\sigma_y = 0.5$ 的零均值高斯分布中抽样；如果 $\\lvert y(0) \\rvert  10^{-3}$，则将 $y(0)$ 移动 $10^{-3}\\,\\mathrm{sign}(y(0) + 10^{-12})$ 以避免精确简并。\n- 初始化动量，其中 $p_x(0)$ 的选择使得动能完全在 $x$ 方向上，即 $E_{\\mathrm{kin},x} = 0.2$，$p_x(0) = \\sqrt{2 m E_{\\mathrm{kin},x}}$；$p_y(0)$ 从标准差为 $\\sigma_{p_y} = 0.1$ 的零均值高斯分布中抽样。\n- 将电子态初始化为初始核几何下的较高绝热态（即，取具有较大本征值的绝热本征态），电子振幅 $c_k(0)$ 使得所有布居都在较高态上。\n- 每条轨迹传播总时间 $T = 75.0$，固定时间步长 $\\Delta t = 0.05$。使用具有固定种子的确定性伪随机数生成器以确保可复现性。\n- 在传播结束时，根据每条轨迹所在的绝热态索引对其结果进行分类。将产物分支比定义为在 $t = T$ 时位于较低绝热态上的轨迹所占的比例。\n\n程序要求：\n- 使用可微性和 Hellmann–Feynman 定理（在适用之处）从 $\\mathbf{H}_{\\mathrm{dia}}(x,y)$ 计算绝热能量、力和非绝热耦合矢量。通过在涉及绝热能隙的分母中引入一个小的正则化参数 $\\epsilon > 0$ 来处理潜在的简并，以避免除以零。\n- 在绝热表象中实现一个标准的最少切换表面跳跃方案，在成功跳跃时沿非绝热耦合矢量方向进行能量守恒的动量重新缩放，并拒绝无法保持能量守恒的跳跃（受挫跳跃）。\n- 对于下面定义的测试套件中的每个参数集，使用 $N = 100$ 条轨迹。\n- 将最终的分支比表示为区间 $[0,1]$ 内的浮点数，四舍五入到三位小数。\n\n测试套件：\n为以下四个独立的参数集计算产物分支比，这些参数集仅在 $c_0$ 的值上有所不同：\n1. $c_0 = 0.0$ (真锥形交叉),\n2. $c_0 = 0.1$ (弱避免交叉),\n3. $c_0 = 0.5$ (中等避免交叉),\n4. $c_0 = 1.0$ (强避免交叉).\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，“[r1,r2,r3,r4]”），其中 $r_k$ 是第 $k$ 个测试用例的分支比，四舍五入到三位小数。不得打印任何其他文本。输出为无量纲浮点数。", "solution": "该问题要求为一个二维、双态的线性振动耦合模型实现一个标准的最少切换表面跳跃 (FSSH) 模拟。目标是计算产物分支比，定义为最终停留在较低绝热势能面上的轨迹比例，该比例随参数 $c_0$ 的不同值而变化，此参数控制着耦合强度和交叉区域的能隙。该问题在科学上是有效的、适定的，并且为确定性模拟提供了所有必要的参数和初始条件。\n\n解决方案首先从给定的非绝热哈密顿量推导出关键的量子化学量，然后概述结合了经典核动力学与量子电子演化的 FSSH 算法，最后详细说明计算实现。\n\n**1. 理论框架**\n\n给定的非绝热哈密顿量是一个依赖于核坐标 $\\mathbf{R} = (x,y)$ 的 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{H}_{\\mathrm{dia}}(x,y) \\;=\\; \n\\begin{pmatrix}\na\\,x  b\\,y + c_0 \\\\\nb\\,y + c_0  -a\\,x\n\\end{pmatrix}\n$$\nFSSH 算法在绝热表象中运行。必须从 $\\mathbf{H}_{\\mathrm{dia}}$ 推导出关键量——绝热能量、核上的力以及非绝热耦合。\n\n**绝热能量：**\n绝热势能面 $E_k(x,y)$ 是 $\\mathbf{H}_{\\mathrm{dia}}(x,y)$ 的本征值。求解特征方程 $\\det(\\mathbf{H}_{\\mathrm{dia}} - E\\mathbf{I}) = 0$ 得到：\n$$\nE^2 - (ax)^2 - (by+c_0)^2 = 0\n$$\n这给出了两个能量面，我们将其标记为较低 ($k=0$) 和较高 ($k=1$) 的态：\n$$\nE_{0,1}(x,y) = \\mp \\sqrt{(ax)^2 + (by+c_0)^2}\n$$\n两个势面之间的能隙为 $\\Delta E = E_1 - E_0 = 2\\sqrt{(ax)^2 + (by+c_0)^2}$。当 $\\Delta E = 0$ 时发生锥形交叉，对于 $c_0=0$ 的情况，这发生在 $(x,y)=(0,0)$。对于 $c_0 \\neq 0$，能隙最小但非零，形成避免交叉。\n\n**核上的力：**\n作用在核上的力是活性绝热势面势能的负梯度，$\\mathbf{F}_k = -\\nabla E_k$。根据 Hellmann-Feynman 定理，该梯度由哈密顿量梯度的期望值给出：\n$$\n\\nabla E_k = \\langle \\phi_k | \\nabla \\mathbf{H}_{\\mathrm{dia}} | \\phi_k \\rangle\n$$\n其中 $|\\phi_k\\rangle$ 是绝热本征矢量。非绝热哈密顿量的梯度为：\n$$\n\\frac{\\partial \\mathbf{H}_{\\mathrm{dia}}}{\\partial x} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix}, \\quad\n\\frac{\\partial \\mathbf{H}_{\\mathrm{dia}}}{\\partial y} = \\begin{pmatrix} 0  b \\\\ b  0 \\end{pmatrix}\n$$\n通过对能量表达式直接求导，这等同于应用 Hellmann-Feynman 定理，我们得到梯度：\n$$\n\\nabla E_1 = -\\nabla E_0 = \\frac{1}{\\sqrt{(ax)^2+(by+c_0)^2}} \\begin{pmatrix} a^2x \\\\ b(by+c_0) \\end{pmatrix}\n$$\n因此，力为 $\\mathbf{F}_{0,1} = -\\nabla E_{0,1}$。\n\n**非绝热耦合矢量 (NACV)：**\n态 $j$ 和 $k$ 之间的非绝热耦合矢量 $\\mathbf{d}_{jk} = \\langle \\phi_j | \\nabla \\phi_k \\rangle$ 介导布居数转移。对于一个双态系统，我们需要计算 $\\mathbf{d}_{01}$。使用非对角 Hellmann-Feynman 公式：\n$$\n\\mathbf{d}_{01} = \\frac{\\langle \\phi_0 | \\nabla \\mathbf{H}_{\\mathrm{dia}} | \\phi_1 \\rangle}{E_1 - E_0}\n$$\n计算矩阵元得到 NACV 的分量：\n$$\nd_{01,x} = \\frac{-a(by+c_0)}{2((ax)^2+(by+c_0)^2)}, \\quad\nd_{01,y} = \\frac{abx}{2((ax)^2+(by+c_0)^2)}\n$$\n注意 $\\mathbf{d}_{10} = -\\mathbf{d}_{01}$。分母 $(ax)^2+(by+c_0)^2$ 在锥形交叉处可能为零，导致 NACV 出现奇点。为避免数值不稳定，在分母上添加一个小的正则化参数 $\\epsilon$（例如 $10^{-16}$）。\n\n**2. 最少切换表面跳跃算法**\n\nFSSH 是一种半经典方法，其中传播一个独立轨迹的系综。每条轨迹包含一个在单一“活性”绝热势面上运动的经典核，而电子波函数则进行量子力学演化。\n\n**运动方程：**\n- **核：** 核的位置 $\\mathbf{R}$ 和动量 $\\mathbf{p}$ 使用 Velocity Verlet 算法，在来自活性势面 $k$ 的力作用下进行传播：\n$$\n\\mathbf{p}(t+\\Delta t/2) = \\mathbf{p}(t) + \\mathbf{F}_k(t) \\frac{\\Delta t}{2}\n$$\n$$\n\\mathbf{R}(t+\\Delta t) = \\mathbf{R}(t) + \\frac{\\mathbf{p}(t+\\Delta t/2)}{m} \\Delta t\n$$\n$$\n\\mathbf{p}(t+\\Delta t) = \\mathbf{p}(t+\\Delta t/2) + \\mathbf{F}_k(t+\\Delta t) \\frac{\\Delta t}{2}\n$$\n- **电子：** 以绝热基下的系数 $c_k$ 表示的电子波函数，根据含时薛定谔方程演化：\n$$\ni\\hbar \\dot{c}_j = c_j E_j - i\\hbar \\sum_k c_k (\\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{jk})\n$$\n在原子单位中（$\\hbar=1$），并使用简单的前向欧拉积分步长，然后进行归一化以保证稳定性：\n$$\nc_j(t+\\Delta t) \\approx c_j(t) + \\left[-i c_j E_j - \\sum_k c_k (\\mathbf{v} \\cdot \\mathbf{d}_{jk})\\right] \\Delta t\n$$\n其中 $\\mathbf{v} = \\dot{\\mathbf{R}} = \\mathbf{p}/m$。\n\n**随机跳跃：**\n在每个时间步，都会做出一个随机决定，判断是否切换活性势面。从活性态 $k$ 跳到态 $j$ 的概率计算如下：\n$$\nP_{k \\to j} = \\max\\left(0, \\frac{-2 \\Delta t}{|c_k|^2} \\mathrm{Re}\\left( \\frac{c_j^*}{c_k} \\dot{\\rho}_{kk} \\right) \\right) = \\max\\left(0, \\frac{2 \\Delta t}{|c_k|^2} \\mathrm{Re}( c_k^* c_j (\\mathbf{v} \\cdot \\mathbf{d}_{jk}) )\\right)\n$$\n抽取一个均匀随机数 $\\zeta \\in [0,1]$。如果 $\\zeta  P_{k \\to j}$，则尝试进行跳跃。\n\n**能量守恒与受挫跳跃：**\n只有在总能量守恒的情况下，跳跃才物理上可能。从态 $k$ 跳到态 $j$ 时，势能的变化是 $\\Delta E = E_j - E_k$。这必须由动能的变化来补偿。\n- 如果是向上跳跃（$\\Delta E > 0$），只有在有足够的动能时才被允许。具体来说，沿 NACV 方向的动能分量必须大于或等于 $\\Delta E$。如果不是，则拒绝跳跃（“受挫”）。\n- 如果跳跃被接受，核动量将被重新缩放以确保总能量守恒。重新缩放是在平行于 NACV 方向（$\\mathbf{d}_{jk}$）的动量分量上进行的：\n$$\nE_{\\mathrm{kin}, ||}' = E_{\\mathrm{kin}, ||} - \\Delta E \\implies (p_{||}')^2 = p_{||}^2 - 2m\\Delta E\n$$\n垂直于 NACV 的动量分量保持不变。\n\n**3. 实现细节**\n\n模拟的结构如下：\n- 一个主循环遍历给定的四个 $c_0$ 值。\n- 对每个 $c_0$，模拟一个包含 $N=100$ 条轨迹的系综。\n- 为伪随机数生成器使用固定种子以确保可复现性。\n- **初始化：** 对于每条轨迹，从指定的分布中抽样初始位置和动量。初始活性势面是较高态 ($k=1$)，因此电子系数初始化为 $c_0(0)=0$，$c_1(0)=1$。\n- **传播：** 每条轨迹传播总时间 $T=75.0$ a.u.，时间步长为 $\\Delta t=0.05$ a.u.。传播步骤遵循与 FSSH 逻辑集成的 Velocity Verlet 方案。在每个时间步内，所有电子性质（能量、力、NACV）都在新位置 $\\mathbf{R}(t+\\Delta t)$ 处计算。\n- **分析：** 在最终时间 $T$，记录每条轨迹的活性态。产物分支比是最终停留在较低态 ($k=0$) 的轨迹总数除以总轨迹数 ($N$)。结果按要求四舍五入到三位小数。\n实现将使用 `numpy` 库进行所有数值计算。", "answer": "```python\nimport numpy as np\n\ndef compute_properties(pos, A, B, c0):\n    \"\"\"\n    Computes adiabatic energies, forces, and nonadiabatic couplings.\n    \"\"\"\n    x, y = pos\n    epsilon = 1e-16\n\n    ax, byc0 = A * x, B * y + c0\n    d2 = ax**2 + byc0**2\n    \n    if d2  epsilon:\n        d2 = epsilon\n        \n    e_gap_half = np.sqrt(d2)\n    e0, e1 = -e_gap_half, e_gap_half\n    energies = np.array([e0, e1])\n\n    grad_e1_x = A * ax / e_gap_half\n    grad_e1_y = B * byc0 / e_gap_half\n    \n    forces = [\n        np.array([grad_e1_x, grad_e1_y]),\n        -np.array([grad_e1_x, grad_e1_y])\n    ]\n\n    nacv_d01_x = -A * byc0 / (2 * d2)\n    nacv_d01_y = A * B * x / (2 * d2)\n    nacv_d01 = np.array([nacv_d01_x, nacv_d01_y])\n    \n    return energies, forces, nacv_d01\n\ndef propagate_step(pos, mom, coeffs, active_state, A, B, c0, M, DT, rng):\n    \"\"\"\n    Performs one time step of the FSSH algorithm.\n    \"\"\"\n    _, forces, _ = compute_properties(pos, A, B, c0)\n    mom += forces[active_state] * DT / 2.0\n    pos += mom / M * DT\n    energies, forces, nacv_d01 = compute_properties(pos, A, B, c0)\n    mom += forces[active_state] * DT / 2.0\n\n    v = mom / M\n    v_dot_d01 = np.dot(v, nacv_d01)\n    \n    c0_old, c1_old = coeffs[0], coeffs[1]\n    dc0_dt = -1j * c0_old * energies[0] - c1_old * v_dot_d01\n    dc1_dt = -1j * c1_old * energies[1] + c0_old * v_dot_d01\n    \n    coeffs[0] += dc0_dt * DT\n    coeffs[1] += dc1_dt * DT\n    coeffs /= np.linalg.norm(coeffs)\n\n    other_state = 1 - active_state\n    v_dot_d_kj = v_dot_d01 if active_state == 1 else -v_dot_d01\n    \n    prob_hop = 2.0 * DT * np.real(np.conj(coeffs[active_state]) * coeffs[other_state] * v_dot_d_kj) / (np.abs(coeffs[active_state])**2 + 1e-12)\n\n    if rng.uniform(0, 1)  prob_hop:\n        dE = energies[other_state] - energies[active_state]\n        kin_energy = 0.5 * np.dot(mom, mom) / M\n        \n        if kin_energy >= dE:\n            active_state = other_state\n            nacv_dir = nacv_d01 / (np.linalg.norm(nacv_d01) + 1e-12)\n            mom_parallel_mag = np.dot(mom, nacv_dir)\n            \n            new_mom_parallel_sq = mom_parallel_mag**2 - 2 * M * dE\n            if new_mom_parallel_sq >= 0:\n                new_mom_parallel_mag = np.sqrt(new_mom_parallel_sq)\n                if mom_parallel_mag  0:\n                    new_mom_parallel_mag *= -1\n                mom += (new_mom_parallel_mag - mom_parallel_mag) * nacv_dir\n            else: # Frustrated hop (not enough parallel momentum, but enough total)\n                active_state = 1 - other_state # Revert hop\n                \n    return pos, mom, coeffs, active_state\n\ndef solve():\n    \"\"\"\n    Main function to run the FSSH simulation suite.\n    \"\"\"\n    A, B, M = 0.02, 0.03, 2000.0\n    E_KIN_X, SIGMA_Y, SIGMA_PY = 0.2, 0.5, 0.1\n    N_TRAJ, T_TOTAL, DT, X0 = 100, 75.0, 0.05, -3.0\n    \n    TEST_CASES = [0.0, 0.1, 0.5, 1.0]\n    results = []\n    \n    for c0 in TEST_CASES:\n        lower_state_count = 0\n        rng = np.random.default_rng(seed=42)\n\n        for _ in range(N_TRAJ):\n            y0 = rng.normal(loc=0.0, scale=SIGMA_Y)\n            if abs(y0)  1e-3:\n                y0 += 1e-3 * np.sign(y0 + 1e-12)\n            pos = np.array([X0, y0], dtype=float)\n\n            px0 = np.sqrt(2 * M * E_KIN_X)\n            py0 = rng.normal(loc=0.0, scale=SIGMA_PY)\n            mom = np.array([px0, py0], dtype=float)\n\n            active_state = 1\n            coeffs = np.array([0.0, 1.0], dtype=complex)\n\n            n_steps = int(T_TOTAL / DT)\n            for _ in range(n_steps):\n                pos, mom, coeffs, active_state = propagate_step(\n                    pos, mom, coeffs, active_state, A, B, c0, M, DT, rng\n                )\n            \n            if active_state == 0:\n                lower_state_count += 1\n        \n        branching_ratio = lower_state_count / N_TRAJ\n        results.append(round(branching_ratio, 3))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n# To adhere to the output format, the main execution call is removed,\n# assuming the solve() function is called by a framework.\n# if __name__ == '__main__':\n#     solve()\n```", "id": "2881889"}]}