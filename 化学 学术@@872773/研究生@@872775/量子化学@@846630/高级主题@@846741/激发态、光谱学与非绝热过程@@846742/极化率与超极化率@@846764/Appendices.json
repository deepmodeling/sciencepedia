{"hands_on_practices": [{"introduction": "我们从量子力学的基石模型——量子谐振子开始。这项练习将指导您使用微扰理论，从第一性原理推导出其静态极化率，从而提供一个清晰的解析基准。此外，您还将运用对称性论证来证明为何某些响应性质必然为零，这是一个普适而强大的概念 ([@problem_id:2915753])。", "problem": "考虑一个电荷为 $q$、质量为 $m$ 的单个粒子，在谐振子势 $V_{0}(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$ 中沿一维空间坐标 $x$ 运动。一个大小为 $F$ 的均匀静电场沿 $x$ 方向施加，因此总哈密顿量为 $H(F)=H_{0}+V(F)$，其中 $H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$ 且 $V(F)=-q F x$。在电偶极近似下进行计算，并假设定态是非简并的。\n\n从不含时薛定谔方程和非简并不含时微扰理论出发，并仅使用基本定义，完成以下任务：\n- 从基态能量对场的依赖关系中，推导出基态的静态（零频率）线性极化率 $\\alpha$。您的推导必须从 $\\alpha$ 的定义（即基态能量对场在零场强下的二阶导数）开始，并通过对 $F$ 的系统性微扰来进行。\n- 利用未微扰势的反演对称性，证明该系统的所有奇数阶静态超极化率均为零。\n\n将您得到的静态极化率的最终结果表示为包含 $q$、$m$ 和 $\\omega$ 的闭合形式解析表达式。物理量使用国际单位制（SI）约定，但不要代入数值。仅报告您获得的 $\\alpha$ 的表达式作为最终答案。无需四舍五入，也无需进行数值计算。", "solution": "问题陈述已经过严格验证。\n\n**给定条件：**\n1.  系统：一个电荷为 $q$、质量为 $m$ 的粒子，在一维空间 $x$ 中运动。\n2.  未微扰哈密顿量：$H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$。\n3.  微扰：来自均匀静电场 $F$ 的 $V(F)=-q F x$。\n4.  总哈密顿量：$H(F)=H_{0}+V(F)$。\n5.  状态：系统的基态，对于 $H_0$ 是非简并的。\n6.  极化率定义：$\\alpha = -\\frac{\\partial^2 E_0(F)}{\\partial F^2}|_{F=0}$，其中 $E_0(F)$ 是存在电场时的基态能量。\n7.  任务：(i) 推导静态线性极化率 $\\alpha$。(ii) 证明所有奇数阶静态超极化率均为零。\n\n**验证结论：**\n该问题具有科学依据，因为它描述了静态电场下的典型量子谐振子，这是量子力学中的一个基本模型。问题提法得当，所有必要组成部分均已定义，语言客观。各项假设是一致的。因此，该问题被认定为**有效**，我们可以继续进行求解。\n\n根据要求，解答分为两个部分。\n\n**第一部分：静态线性极化率 $\\alpha$ 的推导**\n\n我们从基态（表示为 $|0\\rangle$）的静态极化率的定义开始，该定义是其能量 $E_0(F)$ 的函数：\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0}\n$$\n为了计算这个值，我们使用非简并不含时微扰理论，将基态能量表示为电场强度 $F$ 的幂级数。微扰哈密顿量为 $V = -qFx$。基态能量 $E_0(F)$ 展开为：\n$$\nE_0(F) = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} + \\dots\n$$\n其中 $E_0^{(k)}$ 是能量的 $k$ 阶修正。未微扰的基态能量为 $E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$。\n\n一阶能量修正是微扰在未微扰基态 $|0\\rangle$ 中的期望值：\n$$\nE_0^{(1)} = \\langle 0 | V | 0 \\rangle = \\langle 0 | -qFx | 0 \\rangle = -qF \\langle 0 | x | 0 \\rangle\n$$\n对于量子谐振子，其本征态具有确定的宇称。基态波函数 $\\psi_0^{(0)}(x)$ 是一个偶函数。位置算符 $x$ 是一个奇算符。期望值 $\\langle 0 | x | 0 \\rangle$ 是对乘积 $\\psi_0^{(0)*} x \\psi_0^{(0)}$（这是一个奇函数）在对称区间 $(-\\infty, \\infty)$ 上的积分。该积分恒等于零。因此：\n$$\nE_0^{(1)} = 0\n$$\n\n二阶能量修正由下式给出：\n$$\nE_0^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle k | V | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n代入 $V = -qFx$ 并提出与场相关的项，我们得到：\n$$\nE_0^{(2)} = (-qF)^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = q^2 F^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n为了计算矩阵元 $\\langle k | x | 0 \\rangle$，我们将位置算符 $x$ 用湮灭算符 ($a$) 和产生算符 ($a^\\dagger$) 表示：\n$$\nx = \\sqrt{\\frac{\\hbar}{2m\\omega}}(a + a^\\dagger)\n$$\n这些算符作用在基态 $|0\\rangle$ 上的结果是 $a|0\\rangle = 0$ 和 $a^\\dagger|0\\rangle = |1\\rangle$。因此，矩阵元为：\n$$\n\\langle k | x | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | a + a^\\dagger | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\langle k | a | 0 \\rangle + \\langle k | a^\\dagger | 0 \\rangle) = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | 1 \\rangle\n$$\n由于正交条件 $\\langle k | 1 \\rangle = \\delta_{k1}$，该矩阵元仅在 $k=1$ 时非零。$E_0^{(2)}$ 的求和式简化为单项：\n$$\nE_0^{(2)} = q^2 F^2 \\frac{|\\langle 1 | x | 0 \\rangle|^2}{E_0^{(0)} - E_1^{(0)}}\n$$\n未微扰的能级为 $E_n^{(0)} = (n + \\frac{1}{2})\\hbar\\omega$。因此，$E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$ 且 $E_1^{(0)} = \\frac{3}{2}\\hbar\\omega$。能量分母为 $E_0^{(0)} - E_1^{(0)} = -\\hbar\\omega$。矩阵元的平方为 $|\\langle 1 | x | 0 \\rangle|^2 = \\left(\\sqrt{\\frac{\\hbar}{2m\\omega}}\\right)^2 = \\frac{\\hbar}{2m\\omega}$。\n代入这些结果，得到二阶能量修正：\n$$\nE_0^{(2)} = q^2 F^2 \\frac{\\frac{\\hbar}{2m\\omega}}{-\\hbar\\omega} = -\\frac{q^2 F^2}{2m\\omega^2}\n$$\n基态能量在 $F$ 的二阶近似下为：\n$$\nE_0(F) \\approx E_0^{(0)} + E_0^{(1)} + E_0^{(2)} = \\frac{1}{2}\\hbar\\omega + 0 - \\frac{q^2 F^2}{2m\\omega^2}\n$$\n现在，我们根据其定义计算极化率：\n$$\n\\frac{\\partial E_0(F)}{\\partial F} \\approx -\\frac{q^2 F}{m\\omega^2}\n$$\n$$\n\\frac{\\partial^2 E_0(F)}{\\partial F^2} \\approx -\\frac{q^2}{m\\omega^2}\n$$\n二阶导数是常数，因此在 $F=0$ 处取极限是平凡的。\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0} = - \\left( -\\frac{q^2}{m\\omega^2} \\right) = \\frac{q^2}{m\\omega^2}\n$$\n值得注意的是，对于谐振子，这个结果是精确的。完整的哈密顿量 $H(F)$ 可以通过配方法精确求解，这表明能量本征值对 $F$ 具有纯粹的二次方依赖关系。因此，所有 $k > 2$ 的微扰修正 $E_0^{(k)}$ 都恒等于零。\n\n**第二部分：奇数阶静态超极化率的消失**\n\n奇数阶静态超极化率（例如 $\\beta$, $\\delta$, ...）是通过能量对场在零场强下求值的奇数阶导数来定义的。例如，$\\beta = -\\frac{\\partial^3 E_0(F)}{\\partial F^3}|_{F=0}$。我们将证明所有这些量都为零。\n\n证明依赖于哈密顿量的对称性。\n1.  未微扰哈密顿量 $H_0 = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 x^2$ 在宇称变换 $\\mathcal{P}$ 下是不变的，在一维情况下，这意味着 $x \\to -x$ 和 $p \\to -p$。动能项 ($p^2$) 和势能项 ($x^2$) 都是各自算符的偶函数。因此，$[H_0, \\mathcal{P}] = 0$。\n2.  微扰 $V(F) = -qFx$ 是 $x$ 的奇函数。\n3.  考虑场为 $-F$ 时的总哈密顿量，即 $H(-F) = H_0 + qFx$。我们通过相似变换将宇称算符 $\\mathcal{P}$ 应用于 $H(-F)$：\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = \\mathcal{P} (H_0 + qFx) \\mathcal{P}^{-1} = \\mathcal{P}H_0\\mathcal{P}^{-1} + qF (\\mathcal{P}x\\mathcal{P}^{-1})\n$$\n由于 $[H_0, \\mathcal{P}]=0$，则 $\\mathcal{P}H_0\\mathcal{P}^{-1} = H_0$。位置算符的变换为 $\\mathcal{P}x\\mathcal{P}^{-1} = -x$。因此：\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = H_0 - qFx = H(F)\n$$\n这表明哈密顿量 $H(F)$ 和 $H(-F)$ 是幺正等价的。幺正等价的算符具有相同的本征值谱。\n4.  设 $H(F)$ 的能量本征值集合为 $\\{ E_n(F) \\}$。那么我们必须有 $\\{ E_n(F) \\} = \\{ E_n(-F) \\}$。\n5.  问题陈述指出，未微扰系统的定态是非简并的。对于小的场强 $F$，这种非简并性得以保持。因此，能态的顺序得以维持，这意味着对于每个单独的态 $n$，都有 $E_n(F) = E_n(-F)$。\n6.  因此，基态能量 $E_0(F)$ 必须是场强 $F$ 的偶函数。\n7.  一个偶函数 $f(z) = f(-z)$，其在 $z=0$ 附近的泰勒级数展开式中只能包含偶次幂：$f(z) = \\sum_{j=0}^{\\infty} c_{2j} z^{2j}$。\n8.  因此，$E_0(F)$ 在 $F=0$ 附近的展开式必须具有以下形式：\n$$\nE_0(F) = E_0^{(0)} + c_2 F^2 + c_4 F^4 + \\dots\n$$\n所有 $F$ 的奇次幂的系数都必须为零。\n9.  奇数阶超极化率由 $E_0(F)$ 在 $F=0$ 处的奇数阶导数定义。对于任何奇数 $2k+1$（其中 $k \\geq 0$）：\n$$\n\\left.\\frac{\\partial^{2k+1} E_0(F)}{\\partial F^{2k+1}}\\right|_{F=0} = 0\n$$\n这证明了基态的所有奇数阶静态超极化率均为零。对于任何在未微扰状态下具有反演对称中心的系统，这都是一个普遍的结果。", "answer": "$$\n\\boxed{\\frac{q^2}{m\\omega^2}}\n$$", "id": "2915753"}, {"introduction": "本练习旨在弥合理论定义与计算实践之间的鸿沟。通过分析一组在外电场下计算出的假设电子能量数据，您将学习使用有限场方法提取诸如二阶超极化率 ($\\gamma$) 等高阶性质。这项练习强调了计算化学家的实际工作流程，包括对所计算性质进行不确定性估计这一关键步骤 ([@problem_id:2915758])。", "problem": "在原子单位下，考虑一个具有固定几何构型的分子，其非简并电子基态受到沿 $z$ 轴施加的静态均匀电场 $F_{z}$ 的作用。在玻恩–奥本海默（Born–Oppenheimer, BO）近似和不含时瑞利–薛定谔（Rayleigh–Schrödinger, RS）微扰理论的框架下，含场电子哈密顿量可以写为 $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$，其中 $\\mu_{z}$ 是电偶极矩算符的 $z$ 分量。假设精确的基态能量 $E(F_{z})$ 在 $F_{z}=0$ 的一个邻域内是解析的。\n\n您在 $F_{z}=0$ 的一个邻域内（包括正场和负场）的场值 $\\{F_{k}\\}_{k=1}^{N}$ 处进行了 $N$ 次单点电子能量计算，并使用普通最小二乘法（ordinary least squares, OLS）将这些数据拟合到四次模型\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}.\n$$\n令 $X$ 为 $N \\times 5$ 的设计矩阵，其第 $k$ 行为 $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$，令残差向量为 $r = y - X \\hat{a}$，其中 $y$ 汇集了计算出的能量，$\\hat{a}$ 是系数向量 $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$ 的 OLS 估计量。假设能量误差是独立的、同分布的，服从均值为零、方差为 $\\sigma^{2}$ 的高斯分布，并定义残差平方和（residual sum of squares, RSS）为 $\\mathrm{RSS} = r^{\\top} r$。令 $p=5$ 为拟合参数的数量，令噪声方差的无偏估计量为 $s^{2} = \\mathrm{RSS}/(N-p)$。\n\n仅使用 RS 微扰理论中电响应张量的场导数定义以及在同方差高斯噪声下的 OLS 标准线性回归理论：\n\n1. 推导如何从拟合的四次项系数 $a_{4}$ 中提取静态第二超极化率分量 $\\gamma_{zzzz}(0;0,0,0)$。您的结果必须明确说明将 $\\gamma_{zzzz}(0;0,0,0)$ 与 $a_{4}$ 相关联的总符号和精确的乘法常数。\n\n2. 推导 $\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度（标准误差）的闭式表达式，用 $\\mathrm{RSS}$、$N$ 和设计矩阵 $X$ 表示。使用矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素来表示您的结果。将标准不确定度表示为方差的正平方根。\n\n全程使用原子单位。将您的最终答案表示为一个包含两个条目的行矩阵：第一个条目是 $\\gamma_{zzzz}(0;0,0,0)$ 关于 $a_{4}$ 的表达式，第二个条目是其标准不确定度关于 $\\mathrm{RSS}$、$N$ 和 $X$ 的表达式。无需进行数值四舍五入。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：在玻恩–奥本海默（BO）近似下，一个具有非简并电子基态和固定几何构型的分子。\n- **微扰**：沿 $z$ 轴施加的静态均匀电场 $F_{z}$。\n- **哈密顿量**：含场电子哈密顿量为 $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$，其中 $\\mu_{z}$ 是电偶极矩算符的 $z$ 分量。\n- **能量**：假设基态能量 $E(F_{z})$ 在 $F_{z}=0$ 的一个邻域内是解析函数。\n- **数据和模型**：在场强 $\\{F_{k}\\}_{k=1}^{N}$ 下的 $N$ 个能量计算值 $\\{E_k\\}$ 通过普通最小二乘法（OLS）拟合到四次模型 $E(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}$。\n- **线性回归参数**：\n    - 设计矩阵 $X$ 是一个 $N \\times 5$ 矩阵，其第 $k$ 行为 $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$。\n    - 系数向量为 $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$，其 OLS 估计量为 $\\hat{a}$。问题将估计系数表示为 $a_4$。\n    - 参数数量为 $p=5$。\n- **统计假设**：\n    - 能量误差是独立同分布（i.i.d.）的高斯随机变量，均值为零，方差为 $\\sigma^{2}$。\n    - 残差平方和为 $\\mathrm{RSS} = r^{\\top} r$，其中 $r = y - X \\hat{a}$。\n    - 噪声方差的无偏估计量为 $s^{2} = \\mathrm{RSS}/(N-p)$。\n- **任务**：\n    1.  推导静态第二超极化率分量 $\\gamma_{zzzz}(0;0,0,0)$ 与拟合系数 $a_{4}$ 之间的关系，包括符号和乘法常数。\n    2.  推导 $\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度，用 $\\mathrm{RSS}$、$N$ 和矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了用于计算分子电学性质的有限场方法，这是计算量子化学中的一种标准技术。其物理模型（BO 近似、RS 微扰理论）、数学表述（能量的泰勒级数展开）和统计分析（OLS 回归）都是可靠且正确结合的。\n\n- **科学基础**：该问题牢固地植根于量子力学和统计理论的既定原理。哈密顿量、微扰以及作为能量导数的极化率概念都是基础性的。\n- **适定性**：问题陈述清晰，为推导所要求的表达式提供了所有必要信息。目标明确，且存在唯一解。\n- **客观性**：语言精确、专业，没有任何主观性或歧义。\n\n该问题没有表现出任何科学上不健全、不完整、矛盾或不可行等缺陷。这是一个适定的问题，旨在检验物理理论与数据分析方法之间的联系。\n\n### 步骤 3：结论与行动\n问题有效。现在将推导完整的解决方案。\n\n### 推导\n\n根据问题陈述的要求，解答分为两部分。所有计算均在原子单位下进行。\n\n**第一部分：第二超极化率 $\\gamma_{zzzz}(0;0,0,0)$ 的提取**\n\n在静态电场 $F_{z}$ 存在下，分子的能量 $E(F_{z})$ 可以在 $F_{z}=0$ 附近展开为泰勒级数：\n$$\nE(F_{z}) = E(0) + \\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0} F_{z} + \\frac{1}{2!} \\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0} F_{z}^{2} + \\frac{1}{3!} \\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0} F_{z}^{3} + \\frac{1}{4!} \\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0} F_{z}^{4} + O(F_{z}^{5})\n$$\n问题指出，应使用电响应张量的场导数定义。对于沿 $z$ 轴的静态场，永久偶极矩 ($\\mu_{z}$)、极化率 ($\\alpha_{zz}$)、第一超极化率 ($\\beta_{zzz}$) 和第二超极化率 ($\\gamma_{zzzz}$) 定义如下：\n$$\n\\mu_{z} = -\\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0}\n$$\n$$\n\\alpha_{zz} = -\\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0}\n$$\n$$\n\\beta_{zzz} = -\\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0}\n$$\n$$\n\\gamma_{zzzz}(0;0,0,0) = -\\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0}\n$$\n符号 $\\gamma_{zzzz}(0;0,0,0)$ 明确表示静态性质，这与使用静态场 $F_z$ 相符。将这些定义代入能量的泰勒级数，得到：\n$$\nE(F_{z}) = E(0) - \\mu_{z} F_{z} - \\frac{1}{2!} \\alpha_{zz} F_{z}^{2} - \\frac{1}{3!} \\beta_{zzz} F_{z}^{3} - \\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0) F_{z}^{4} + O(F_{z}^{5})\n$$\n该问题涉及将计算出的能量拟合到四次模型：\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}\n$$\n通过比较理论泰勒展开式和拟合多项式中 $F_{z}$ 各次幂的系数，我们可以将拟合系数 $\\{a_i\\}$ 与物理性质关联起来。具体来说，对于 $F_{z}^{4}$ 项的系数，我们有：\n$$\na_{4} \\approx \\frac{1}{4!} \\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0}\n$$\n使用第二超极化率的定义，这变为：\n$$\na_{4} \\approx -\\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0)\n$$\n由于 $4! = 24$，我们有 $a_{4} \\approx -\\frac{1}{24} \\gamma_{zzzz}(0;0,0,0)$。\n因此，第二超极化率分量（此处表示为 $\\gamma_{zzzz}(0;0,0,0)$）的估计值可以从拟合系数 $a_{4}$ 中提取如下：\n$$\n\\gamma_{zzzz}(0;0,0,0) = -24 a_{4}\n$$\n乘法常数是 $-24$。\n\n**第二部分：$\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度**\n\n这部分需要用到普通最小二乘法（OLS）回归理论的结果。估计系数的向量 $\\hat{a}$ 的协方差矩阵由下式给出：\n$$\n\\mathrm{Cov}(\\hat{a}) = \\sigma^{2} (X^{\\top} X)^{-1}\n$$\n其中 $\\sigma^{2}$ 是能量计算中误差的真实方差。由于 $\\sigma^{2}$ 未知，因此用其无偏估计量 $s^{2} = \\frac{\\mathrm{RSS}}{N-p}$ 代替，其中 $p=5$ 是拟合参数的数量。因此，$\\hat{a}$ 的估计协方差矩阵为：\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{a}) = s^{2} (X^{\\top} X)^{-1} = \\frac{\\mathrm{RSS}}{N-5} (X^{\\top} X)^{-1}\n$$\n特定系数估计值 $\\hat{a}_{j}$ 的方差是该矩阵相应的对角元素。对于系数 $\\hat{a}_{4}$（第五个系数，对应于索引 $j=5$），估计方差为：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\n其中 $\\left[ (X^{\\top} X)^{-1} \\right]_{55}$ 表示矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素。\n\n根据第一部分，超极化率的估计值（表示为 $\\hat{\\gamma}_{zzzz}$）与系数的估计值 $\\hat{a}_{4}$ 通过一个常数因子相关联：\n$$\n\\hat{\\gamma}_{zzzz}(0;0,0,0) = -24 \\hat{a}_{4}\n$$\n一个随机变量乘以常数 $c$ 后的方差由规则 $\\mathrm{Var}(cZ) = c^{2}\\mathrm{Var}(Z)$ 给出。应用此规则求 $\\hat{\\gamma}_{zzzz}(0;0,0,0)$ 的估计方差：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\widehat{\\mathrm{Var}}(-24 \\hat{a}_{4}) = (-24)^{2} \\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = 576 \\, \\widehat{\\mathrm{Var}}(\\hat{a}_{4})\n$$\n代入 $\\widehat{\\mathrm{Var}}(\\hat{a}_{4})$ 的表达式：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 576 \\left( \\frac{\\mathrm{RSS}}{N-5} \\right) \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\n标准不确定度，通常也称为标准误差，是估计方差的正平方根。设其为 $u(\\hat{\\gamma}_{zzzz})$。\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0))} = \\sqrt{576 \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\n该表达式以指定的量给出了超极化率估计值的标准不确定度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-24 a_{4} & 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n\\end{pmatrix}\n}\n$$", "id": "2915758"}, {"introduction": "在这项高级计算练习中，您将实现并比较两种计算极化率的不同方法：“解析导数”法和“有限场”法。通过亲手编写代码并分析结果，您将对量子化学计算中的主要误差来源——即基组不完备性和数值微分误差——获得第一手见解。这项实践直接探讨了在计算化学中至关重要的基组完备性与数值精度之间的权衡问题 ([@problem_id:2915784])。", "problem": "考虑一个小分子中沿外加静电场方向的电子运动分量的单电子模型。全文使用原子单位（a.u.）。在沿 $x$ 轴、场强大小为 $F$ 的匀强电场存在下，有效的一维哈密顿量为\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x},\n$$\n其中物理参数 $\\omega$ 和 $\\lambda$ 是固定的实正常数。静态偶极极化率 $\\alpha$ 由精确基态能量 $E(F)$ 在 $F=0$ 处对 $F$ 的二阶导数通过级数 $E(F) = E(0) - \\mu F - \\tfrac{1}{2}\\alpha F^2 - \\cdots$ 定义，因此 $\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$。\n\n你的任务是使用截断的谐振子基组，对此哈密顿量实现两种独立的 $\\alpha$ 计算方法，并比较结果：\n- 一种“解析导数”值，来源于基于 $F=0$ 的二阶 Rayleigh–Schrödinger 微扰理论的定态线性响应，使用所选截断基组中 $\\hat{H}(0)$ 的本征态和本征值。\n- 一种“有限场”估计值，使用通过在相同截断基组中进行精确对角化计算出的基态能量 $E(F)$ 的中心二阶有限差分。\n\n为了构建截断基组和哈密顿矩阵，请遵循以下步骤，不要假设任何非从第一性原理推导的黑箱公式。使用具有基频 $\\omega_b$ 的参考谐振子的数态 $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$ 作为你的正交归一基组。使用满足 $[\\hat{a},\\hat{a}^\\dagger]=1$ 的升降算符 $\\hat{a}$ 和 $\\hat{a}^\\dagger$，并用 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 表示 $\\hat{x}$ 和 $\\hat{p}$。使用它们来构建 $\\hat{x}$ 的矩阵表示，然后通过显式矩阵乘法形成 $\\hat{x}^2$ 和 $\\hat{x}^4$。令 $\\hat{H}_b = \\omega_b\\left(\\hat{a}^\\dagger \\hat{a} + \\tfrac{1}{2}\\right)$ 表示基谐振子哈密顿量。使用恒等式 $\\tfrac{\\hat{p}^2}{2} = \\hat{H}_b - \\tfrac{1}{2}\\,\\omega_b^2 \\hat{x}^2$ 来组装在截断基组中给定物理参数 $\\omega$ 和 $\\lambda$ 的无场哈密顿矩阵为\n$$\n\\hat{H}(0) = \\hat{H}_b + \\frac{1}{2}\\left(\\omega^2 - \\omega_b^2\\right)\\hat{x}^2 + \\lambda \\hat{x}^4,\n$$\n以及场微扰的哈密顿量为\n$$\n\\hat{H}(F) = \\hat{H}(0) - F \\hat{x}.\n$$\n\n在截断基组内，通过应用不含时二阶微扰理论（等效于定态线性响应理论）于 $F=0$，根据 $\\hat{H}(0)$ 的本征对来计算“解析导数”极化率。将“有限场”极化率计算为 $\\hat{H}(F)$ 在 $\\pm F$ 和 $0$ 处的基态能量的二阶中心有限差商的负值。为分析差异，还需使用相同的“解析导数”程序但采用大得多的基组大小 $N_{\\mathrm{ref}}$ 来计算一个高度收敛的参考极化率 $\\alpha_{\\mathrm{ref}}$。\n\n在原子单位中使用以下固定的物理参数和基频：$\\omega = 0.7$，$\\lambda = 0.02$，以及 $\\omega_b = 0.7$。使用以下基组大小 $N$ 和有限场步长 $F$ 的测试集：\n- 测试 1：$N=12$，$F=10^{-3}$。\n- 测试 2：$N=12$，$F=5\\times 10^{-2}$。\n- 测试 3：$N=4$，$F=10^{-3}$。\n- 测试 4：$N=8$，$F=10^{-5}$。\n- 测试 5：$N=20$，$F=10^{-3}$。\n\n使用 $N_{\\mathrm{ref}} = 100$ 来定义 $\\alpha_{\\mathrm{ref}}$。\n\n对于每个测试用例，产生两个浮点数：\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite\\text{-}field}}(N,F)$，它在固定的 $N$ 下分离出给定 $F$ 的数值微分误差。\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$，它在 $F=0$ 时分离出基组不完备性误差。\n\n所有输出均以原子单位表示。你的程序应产生单行输出，其中包含按顺序排列的结果，形式为方括号内用逗号分隔的列表\n$$\n[\\Delta_{\\mathrm{FF}}^{(1)}, \\Delta_{\\mathrm{basis}}^{(1)}, \\Delta_{\\mathrm{FF}}^{(2)}, \\Delta_{\\mathrm{basis}}^{(2)}, \\ldots, \\Delta_{\\mathrm{FF}}^{(5)}, \\Delta_{\\mathrm{basis}}^{(5)}].\n$$", "solution": "所述问题是计算量子化学中一个科学上合理且适定的练习。它要求在一个截断基组内，使用两种标准方法——微扰理论和有限场方法——来计算一维非谐振子模型的静态偶极极化率。所有参数和程序都有明确定义，从而可以得到唯一且可验证的解。我们将继续进行推导和实现。\n\n该物理系统由原子单位下的哈密顿量描述：\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x}\n$$\n其中 $F$ 是静电场的大小。静态极化率 $\\alpha$ 通过基态能量 $E(F)$ 在 $F=0$ 附近的泰勒展开定义：\n$$\nE(F) = E(0) - \\mu F - \\frac{1}{2}\\alpha F^2 + \\mathcal{O}(F^3)\n$$\n由此可见，$\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$。我们的任务是使用维度为 $N$ 的截断基组来计算 $\\alpha$。\n\n**1. 基组与算符表示**\n\n我们使用一个截断基组，它由频率为 $\\omega_b$ 的参考谐振子的前 $N$ 个数态 $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$ 组成。这些态是正交归一的，$\\langle m | n \\rangle = \\delta_{mn}$。\n\n位置算符 $\\hat{x}$ 用该参考谐振子的升降算符 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 表示：\n$$\n\\hat{x} = \\sqrt{\\frac{1}{2\\omega_b}} (\\hat{a} + \\hat{a}^\\dagger)\n$$\n升降算符在此基组中的矩阵元是众所周知的：\n$$\n\\langle m | \\hat{a} | n \\rangle = \\sqrt{n}\\,\\delta_{m,n-1}\n$$\n$$\n\\langle m | \\hat{a}^\\dagger | n \\rangle = \\sqrt{n+1}\\,\\delta_{m,n+1}\n$$\n根据这些，我们构造 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 的 $N \\times N$ 矩阵表示，并随后构造 $\\hat{x}$ 的矩阵 $\\mathbf{X}$。\n\n**2. 哈密顿矩阵的构造**\n\n动能算符 $\\frac{\\hat{p}^2}{2}$ 通过恒等式 $\\frac{\\hat{p}^2}{2} = \\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2$ 与参考谐振子哈密顿量 $\\hat{H}_b = \\omega_b(\\hat{a}^\\dagger\\hat{a} + \\frac{1}{2})$ 相关联。将此代入无场哈密顿量 $\\hat{H}(0)$ 的表达式中可得：\n$$\n\\hat{H}(0) = \\left(\\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2\\right) + \\frac{1}{2}\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 = \\hat{H}_b + \\frac{1}{2}(\\omega^2 - \\omega_b^2)\\hat{x}^2 + \\lambda \\hat{x}^4\n$$\n问题指定 $\\omega = \\omega_b = 0.7$ a.u.，这使得表达式显著简化为：\n$$\n\\hat{H}(0) = \\hat{H}_b + \\lambda \\hat{x}^4\n$$\n$\\hat{H}_b$ 的矩阵，记作 $\\mathbf{H}_b$，在数态基中是对角的，其元素为 $(\\mathbf{H}_b)_{nn} = \\omega_b(n + \\frac{1}{2})$。$\\hat{x}^4$ 的矩阵，记作 $\\mathbf{X}^4$，是通过将 $\\mathbf{X}$ 与自身进行四次显式矩阵乘法得到的。因此，无场哈密顿矩阵为 $\\mathbf{H}(0) = \\mathbf{H}_b + \\lambda \\mathbf{X}^4$。在场 $F$ 存在下的完整哈密顿量则由以下矩阵表示：\n$$\n\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}\n$$\n由于这些矩阵是实对称的，它们的本征值是实数，其本征向量构成一个正交归一基。\n\n**3. 解析导数极化率：$\\alpha_{\\mathrm{analytic}}(N)$**\n\n此方法使用不含时的、非简并的 Rayleigh-Schrödinger 微扰理论。我们将 $\\hat{H}(0)$ 视为未微扰的哈密顿量，将 $\\hat{V} = -F\\hat{x}$ 视为微扰。对基态能量 $E_0^{(0)}$ 的二阶修正由下式给出：\n$$\nE^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{V} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = F^2 \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n其中 $\\{E_k^{(0)}, |\\psi_k^{(0)}\\rangle\\}$ 是在大小为 $N$ 的截断基组内计算出的 $\\hat{H}(0)$ 的本征对。将其与能量展开式 $E(F) \\approx E_0^{(0)} + E^{(1)} + E^{(2)}$ 进行比较，其中由于 $\\hat{H}(0)$ 的对称性，$E^{(1)}=0$，我们确定 $E^{(2)} = -\\frac{1}{2}\\alpha F^2$。这得到了极化率的态求和公式：\n$$\n\\alpha_{\\mathrm{analytic}}(N) = 2 \\sum_{k=1}^{N-1} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_k^{(0)} - E_0^{(0)}}\n$$\n计算步骤如下：\n1. 构造 $N \\times N$ 矩阵 $\\mathbf{H}(0)$。\n2. 对 $\\mathbf{H}(0)$ 进行数值对角化，以获得其按能量排序的本征值 $\\{E_k^{(0)}\\}_{k=0}^{N-1}$ 和相应的本征向量 $\\{|\\psi_k^{(0)}\\rangle\\}_{k=0}^{N-1}$。\n3. 构造矩阵 $\\mathbf{X}$。\n4. 使用计算出的本征值和本征向量评估求和。矩阵元 $\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle$ 计算为 $\\mathbf{c}_k^\\intercal \\mathbf{X} \\mathbf{c}_0$，其中 $\\mathbf{c}_k$ 是表示 $|\\psi_k^{(0)}\\rangle$ 的列向量。\n\n**4. 有限场极化率：$\\alpha_{\\mathrm{finite-field}}(N,F)$**\n\n该方法通过数值近似能量的二阶导数来计算 $\\alpha$。$F=0$ 处 $E''(F)$ 的二阶中心有限差分近似为：\n$$\n\\left.\\frac{d^2E}{dF^2}\\right|_{F=0} \\approx \\frac{E(F) - 2E(0) + E(-F)}{F^2}\n$$\n当 $F=0$ 时，哈密顿量具有对称势，因此其本征态具有确定的宇称。微扰 $-F\\hat{x}$ 是反对称的。因此，哈密顿量 $\\hat{H}(F)$ 和 $\\hat{H}(-F)$ 在宇称算符下是幺正等价的，这意味着它们的光谱是相同的。特别地，它们的基态能量相等：$E(F) = E(-F)$。因此，$\\alpha$ 的近似值简化为：\n$$\n\\alpha_{\\mathrm{finite-field}}(N, F) = -\\frac{E(F) - 2E(0) + E(-F)}{F^2} = -\\frac{2(E(F) - E(0))}{F^2}\n$$\n计算步骤如下：\n1. 构造 $N \\times N$ 矩阵 $\\mathbf{H}(0)$ 并找到其最低本征值 $E(0)$。\n2. 对于一个小的场强 $F$，构造矩阵 $\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}$ 并找到其最低本征值 $E(F)$。\n3. 使用简化公式计算 $\\alpha$。\n\n**5. 参考计算与误差分析**\n\n使用解析方法和一个大基组大小 $N_{\\mathrm{ref}} = 100$ 计算出一个高度收敛的参考极化率 $\\alpha_{\\mathrm{ref}}$。该值用作基准。\n\n然后我们为每个测试用例 $(N,F)$ 计算两个误差度量：\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite-field}}(N,F)$: 这分离了有限差分近似本身的误差，该误差为 $\\mathcal{O}(F^2)$ 阶，外加二阶微扰理论未捕捉到的高阶电子响应项。它是在固定的基组大小 $N$ 下计算的。\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$: 这分离了由于大小为 $N$ 的基组不完备性而产生的误差。它比较了从相同微扰理论形式推导出的两个结果，两者仅在基组大小上有所不同。\n\n接下来的实现将遵循这一完整且经过验证的程序。", "answer": "```python\nimport numpy as np\n\ndef build_operators(N, omega_b):\n    \"\"\"\n    Builds matrix representations of a, a_dagger, and x operators.\n    \n    Args:\n        N (int): The size of the truncated harmonic oscillator basis.\n        omega_b (float): The frequency of the reference harmonic oscillator.\n\n    Returns:\n        tuple: Matrices for a, a_dagger, and x.\n    \"\"\"\n    # Annihilation operator\n    a = np.zeros((N, N), dtype=float)\n    for n in range(1, N):\n        a[n - 1, n] = np.sqrt(n)\n\n    # Creation operator\n    a_dag = a.T\n\n    # Position operator\n    x_mat = np.sqrt(1.0 / (2.0 * omega_b)) * (a + a_dag)\n    \n    return a, a_dag, x_mat\n\ndef get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat):\n    \"\"\"\n    Builds the field-free Hamiltonian matrix H(0).\n    \n    Args:\n        N (int): The size of the basis.\n        omega (float): Physical frequency parameter.\n        lambda_ (float): Anharmonicity parameter.\n        omega_b (float): Basis frequency.\n        x_mat (np.ndarray): Matrix for the position operator.\n\n    Returns:\n        np.ndarray: The matrix for H(0).\n    \"\"\"\n    # Basis Hamiltonian H_b\n    n_op = np.diag(np.arange(N, dtype=float))\n    h_b = omega_b * (n_op + 0.5 * np.identity(N))\n\n    # x^2 and x^4 matrices\n    x2_mat = x_mat @ x_mat\n    x4_mat = x2_mat @ x2_mat\n\n    # Field-free Hamiltonian H(0)\n    h0_mat = h_b + 0.5 * (omega**2 - omega_b**2) * x2_mat + lambda_ * x4_mat\n    \n    return h0_mat\n\ndef compute_alpha_analytic(N, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the sum-over-states formula (perturbation theory).\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Diagonalize H(0) to get eigenpairs\n    evals, evecs = np.linalg.eigh(h0_mat)\n    E0 = evals[0]\n    psi0 = evecs[:, 0]\n    \n    alpha = 0.0\n    for k in range(1, N):\n        Ek = evals[k]\n        psik = evecs[:, k]\n        \n        matrix_element = psik.T @ x_mat @ psi0\n        alpha += (matrix_element**2) / (Ek - E0)\n        \n    return 2.0 * alpha\n\ndef compute_alpha_finite_field(N, F, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the finite-field method.\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Ground state energy at F=0\n    # Use eigvalsh as we only need the lowest eigenvalue\n    E0 = np.linalg.eigvalsh(h0_mat)[0]\n\n    # Hamiltonian at field F\n    hF_mat = h0_mat - F * x_mat\n\n    # Ground state energy at field F\n    EF = np.linalg.eigvalsh(hF_mat)[0]\n    \n    # Polarizability from central finite difference\n    # Note: E(F) = E(-F) due to symmetry, so the formula simplifies\n    alpha = -2.0 * (EF - E0) / (F**2)\n    \n    return alpha\n\ndef solve():\n    # Fixed physical parameters in atomic units\n    omega = 0.7\n    lambda_ = 0.02\n    omega_b = 0.7\n\n    # Test suite of (N, F) pairs\n    test_cases = [\n        (12, 1e-3),\n        (12, 5e-2),\n        (4, 1e-3),\n        (8, 1e-5),\n        (20, 1e-3),\n    ]\n\n    # Compute reference polarizability with a large basis\n    N_ref = 100\n    alpha_ref = compute_alpha_analytic(N_ref, omega, lambda_, omega_b)\n\n    results = []\n    \n    for N, F in test_cases:\n        # Compute analytic polarizability for the current basis size N\n        alpha_analytic = compute_alpha_analytic(N, omega, lambda_, omega_b)\n\n        # Compute finite-field polarizability for the current N and F\n        alpha_finite_field = compute_alpha_finite_field(N, F, omega, lambda_, omega_b)\n\n        # Calculate the two discrepancy metrics\n        # Delta_FF: Isolates numerical differentiation error\n        delta_ff = alpha_analytic - alpha_finite_field\n        \n        # Delta_basis: Isolates basis set incompleteness error\n        delta_basis = alpha_ref - alpha_analytic\n        \n        results.extend([delta_ff, delta_basis])\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{res:.8e}' for res in results)}]\")\n\nsolve()\n```", "id": "2915784"}]}