{"hands_on_practices": [{"introduction": "为了开始我们的动手实践，我们首先在一个 QM/MM 框架中分离出纯粹的机械效应。这个练习 [@problem_id:2904939] 将环境简化为一个谐波浴，以清晰地展示来自 MM 区域的位阻效应如何改变 QM 子系统的平衡几何构型。通过推导键长的变化，您将对构成更复杂模型基础的机械嵌入有一个基本的理解。", "problem": "在 Born–Oppenheimer 近似下，考虑一个嵌入在经典分子力学 (MM) 环境中的双原子量子力学 (QM) 子系统。设该 QM 子系统为一个双原子分子，其在固有平衡键长附近的性质由基态势能面的谐波展开描述。具体而言，设核间距为 $r$，非耦合 QM 体系的能量最低点位于 $r_0$，其曲率（谐振力常数）为 $k_{\\mathrm{QM}}$。因此，对于小位移，QM 对势能的贡献可以写为 $E_{\\mathrm{QM}}(r) \\approx \\tfrac{1}{2} k_{\\mathrm{QM}} (r - r_0)^2 + \\text{常数}$。\n\n假设 MM 环境表示为一组 $N$ 个独立的谐振模式，这些模式以力学方式（且仅以力学方式）与 QM 键长 $r$ 耦合。每个模式贡献一个关于 $(r - R_i)$ 的附加二次项，其耦合刚度为 $k_i$，自身的参考长度为 $R_i$，因此依赖于 $r$ 的总 MM 贡献为 $\\sum_{i=1}^{N} \\tfrac{1}{2} k_i (r - R_i)^2$。不存在静电嵌入：QM 哈密顿量不受 MM 电荷或多极矩的微扰，并且为了找到沿 $r$ 的能量最低点，任何与 $r$ 无关的 MM 项都可以忽略。\n\n仅从上述谐波近似以及平衡构型使总势能相对于 $r$ 最小化这一原理出发，推导由此力学嵌入引起的平衡键长变化的精确闭式表达式。将你的最终结果表示为无量纲分数位移 $\\Delta r / r_0$，其中 $\\Delta r = r_{\\mathrm{eq}} - r_0$，$r_{\\mathrm{eq}}$ 是耦合 QM/MM 系统中的平衡距离。你的最终答案应仅用 $k_{\\mathrm{QM}}$、$\\{k_i\\}_{i=1}^{N}$、$r_0$ 和 $\\{R_i\\}_{i=1}^{N}$ 表示。不要代入数值。无需四舍五入。所要求的输出是无量纲的，因此无需报告单位。", "solution": "对问题陈述进行严格验证。\n\n第 1 步：提取已知条件\n- QM 子系统势能：$E_{\\mathrm{QM}}(r) \\approx \\frac{1}{2} k_{\\mathrm{QM}} (r - r_0)^2 + \\text{常数}$\n- $r$：双原子 QM 子系统中的核间距。\n- $r_0$：非耦合 QM 子系统的平衡键长。\n- $k_{\\mathrm{QM}}$：QM 势的谐振力常数（曲率）。\n- 依赖于 $r$ 的 MM 环境势能贡献：$E_{\\mathrm{MM}}(r) = \\sum_{i=1}^{N} \\frac{1}{2} k_i (r - R_i)^2$。\n- $N$：MM 环境中独立谐振模式的数量。\n- $k_i$：第 $i$ 个 MM 模式的耦合刚度。\n- $R_i$：第 $i$ 个 MM 模式的参考长度。\n- 耦合类型：仅力学耦合；无静电嵌入。\n- 平衡原理：平衡构型使总势能相对于 $r$ 最小化。\n- 要求输出：无量纲分数位移 $\\frac{\\Delta r}{r_0}$，其中 $\\Delta r = r_{\\mathrm{eq}} - r_0$，$r_{\\mathrm{eq}}$ 是耦合 QM/MM 系统中的平衡距离。\n\n第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了混合 QM/MM 方法中力学嵌入的一个简化但标准的模型，这是计算化学中的一种成熟技术。Born-Oppenheimer 近似、谐波势以及能量最小化原理的使用是该领域的基础。该问题是适定的；它提供了一个明确定义的总势能函数，该函数是关于 $r$ 的二次项之和，因此其本身也是一个二次函数，从而有一个可以通过解析方法找到的唯一极小值。该问题是客观的，使用了没有歧义或主观性的精确技术语言。它是自洽的，为其求解提供了所有必要信息。在其陈述的模型框架内，它没有违反任何物理原理，也不包含任何矛盾。\n\n第 3 步：结论与行动\n该问题有效。将推导解答。\n\n耦合 QM/MM 系统的总势能 $E_{\\mathrm{total}}(r)$ 是 QM 和 MM 贡献之和。任何与坐标 $r$ 无关的项都不会影响极小值的位置，因此可以忽略。\n$$E_{\\mathrm{total}}(r) = E_{\\mathrm{QM}}(r) + E_{\\mathrm{MM}}(r) = \\frac{1}{2} k_{\\mathrm{QM}} (r - r_0)^2 + \\sum_{i=1}^{N} \\frac{1}{2} k_i (r - R_i)^2$$\n平衡构型对应于总势能处于极小值时的 $r$ 值，记为 $r_{\\mathrm{eq}}$。此条件通过将势能对 $r$ 的一阶导数设为零来找到。\n$$\\frac{dE_{\\mathrm{total}}}{dr} \\bigg|_{r=r_{\\mathrm{eq}}} = 0$$\n首先，我们计算 $E_{\\mathrm{total}}(r)$ 对 $r$ 的导数：\n$$\\frac{dE_{\\mathrm{total}}}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{2} k_{\\mathrm{QM}} (r - r_0)^2 + \\sum_{i=1}^{N} \\frac{1}{2} k_i (r - R_i)^2 \\right]$$\n使用微分链式法则，我们得到：\n$$\\frac{dE_{\\mathrm{total}}}{dr} = k_{\\mathrm{QM}} (r - r_0) + \\sum_{i=1}^{N} k_i (r - R_i)$$\n在 $r = r_{\\mathrm{eq}}$ 处将此导数设为零，得到平衡键长方程：\n$$k_{\\mathrm{QM}} (r_{\\mathrm{eq}} - r_0) + \\sum_{i=1}^{N} k_i (r_{\\mathrm{eq}} - R_i) = 0$$\n我们现在必须求解这个关于 $r_{\\mathrm{eq}}$ 的线性方程。我们展开各项，并将包含 $r_{\\mathrm{eq}}$ 的项组合在一起：\n$$k_{\\mathrm{QM}} r_{\\mathrm{eq}} - k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i r_{\\mathrm{eq}} - \\sum_{i=1}^{N} k_i R_i = 0$$\n$$k_{\\mathrm{QM}} r_{\\mathrm{eq}} + \\left(\\sum_{i=1}^{N} k_i\\right) r_{\\mathrm{eq}} = k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i$$\n从左侧提出公因子 $r_{\\mathrm{eq}}$：\n$$r_{\\mathrm{eq}} \\left( k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i \\right) = k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i$$\n分离出 $r_{\\mathrm{eq}}$ 得到耦合系统中平衡键长的表达式：\n$$r_{\\mathrm{eq}} = \\frac{k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i}$$\n为确认这对应一个极小值，我们计算势能的二阶导数。\n$$\\frac{d^2E_{\\mathrm{total}}}{dr^2} = k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i$$\n由于力常数 $k_{\\mathrm{QM}}$ 和 $k_i$ 代表稳定的谐波势，它们必须为正。因此，二阶导数严格为正，确认了 $r_{\\mathrm{eq}}$ 确实是一个极小值。\n\n问题要求的是平衡键长的变化量 $\\Delta r = r_{\\mathrm{eq}} - r_0$。我们代入 $r_{\\mathrm{eq}}$ 的表达式：\n$$\\Delta r = \\frac{k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i} - r_0$$\n为了简化，我们将两项通分：\n$$\\Delta r = \\frac{k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i - r_0 \\left( k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i \\right)}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i}$$\n展开分子：\n$$\\Delta r = \\frac{k_{\\mathrm{QM}} r_0 + \\sum_{i=1}^{N} k_i R_i - k_{\\mathrm{QM}} r_0 - r_0 \\sum_{i=1}^{N} k_i}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i}$$\n$k_{\\mathrm{QM}} r_0$ 项消去，剩下：\n$$\\Delta r = \\frac{\\sum_{i=1}^{N} k_i R_i - r_0 \\sum_{i=1}^{N} k_i}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i}$$\n对分子进行因式分解，得到 $\\Delta r$ 的最终表达式：\n$$\\Delta r = \\frac{\\sum_{i=1}^{N} k_i (R_i - r_0)}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i}$$\n最后，我们计算所要求的无量纲分数位移 $\\frac{\\Delta r}{r_0}$：\n$$\\frac{\\Delta r}{r_0} = \\frac{1}{r_0} \\left( \\frac{\\sum_{i=1}^{N} k_i (R_i - r_0)}{k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i} \\right)$$\n这给出了最终表达式为：\n$$\\frac{\\Delta r}{r_0} = \\frac{\\sum_{i=1}^{N} k_i (R_i - r_0)}{r_0 \\left( k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i \\right)}$$\n此表达式仅由给定的参数 $k_{\\mathrm{QM}}$、$\\{k_i\\}_{i=1}^{N}$、$r_0$ 和 $\\{R_i\\}_{i=1}^{N}$ 表示，符合要求。", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} k_i (R_i - r_0)}{r_0 \\left( k_{\\mathrm{QM}} + \\sum_{i=1}^{N} k_i \\right)}}$$", "id": "2904939"}, {"introduction": "在理解了机械耦合之后，我们现在转向更符合物理真实的静电嵌入方案。这个基础练习 [@problem_id:2904928] 将引导您从第一性原理出发，推导 QM-MM 静电相互作用能，这是允许量子波函数被经典环境极化的核心项。掌握这一推导对于深刻理解静电嵌入如何捕捉关键物理现象至关重要。", "problem": "一个分子体系被划分为量子子系统和经典环境，如同在量子力学/分子力学 (QM/MM) 建模中一样。量子子系统包含 $N_{\\mathrm{e}}$ 个电子，其数量密度为 $\\rho(\\mathbf{r})$，以及由索引 $A$ 标记的原子核，其电荷为 $Z_{A}$，位于位置 $\\mathbf{R}_{A}$。经典环境由位于位置 $\\mathbf{R}_{i}$ 的 $M$ 个固定点电荷 $q_{i}$ 表示，并遵循一个不可极化的固定电荷力场。在 Born–Oppenheimer 近似下进行计算，并使用 Hartree 原子单位制，其中基本电荷大小和 $1/(4\\pi\\varepsilon_{0})$ 均取为 $1$。\n\n从静电学的第一性原理以及外场中电子哈密顿量的结构出发，完成以下任务：\n\n- 用文字清晰地区分机械嵌入和静电嵌入这两种方案，说明量子电子哈密顿量是否包含一个源于经典点电荷的项。\n- 仅使用电荷分布之间的基本库仑相互作用以及进入电子哈密顿量的外势能的定义，推导静电嵌入方案中电子-MM 和原子核-MM 的静电相互作用能表达式。\n- 将这两部分贡献组合成一个关于总 QM-MM 静电嵌入能 $E_{\\mathrm{embed}}$ 的单一闭合形式表达式，用 $\\rho(\\mathbf{r})$、$Z_{A}$、$q_{i}$、$\\mathbf{R}_{A}$ 和 $\\mathbf{R}_{i}$ 表示。\n\n将你的最终结果表示为一个解析表达式。不要代入数值，也不要报告中间结果。你的最终答案必须是单一的闭合形式表达式。最终答案中不要包含单位。", "solution": "对问题陈述进行验证。\n\n首先，我将精确地提取所给信息。\n已知条件：\n1.  一个分子体系被划分为量子子系统 (QM) 和经典环境 (MM)。\n2.  QM 子系统包含 $N_{\\mathrm{e}}$ 个电子，其数量密度为 $\\rho(\\mathbf{r})$。\n3.  QM 子系统包含由索引 $A$ 标记的原子核，其电荷为 $Z_{A}$，位于位置 $\\mathbf{R}_{A}$。\n4.  经典环境由位于位置 $\\mathbf{R}_{i}$ 的 $M$ 个固定点电荷 $q_{i}$ 表示。\n5.  经典环境遵循一个不可极化的固定电荷力场。\n6.  使用 Born–Oppenheimer 近似。\n7.  使用 Hartree 原子单位制，其中基本电荷大小和 $1/(4\\pi\\varepsilon_{0})$ 均取为 $1$。\n\n接下来，我将根据所需标准验证该问题。\n该问题具有科学依据。它描述了一个标准的 QM/MM (量子力学/分子力学) 划分方案，这是现代计算化学的基石。机械嵌入和静电嵌入的概念在此框架内是基本且明确定义的。使用 Born-Oppenheimer 近似和原子单位制是该领域的标准惯例。\n该问题是适定的。它提供了所有必要的定义（$\\rho(\\mathbf{r})$、$Z_A$、$q_i$ 等）和物理背景（静电学、量子哈密顿量），以执行所要求的推导。任务是具体的，并能导出一个唯一的解析表达式。\n该问题是客观的。其语言正式、精确，并使用了公认的科学术语。它没有歧义、主观性和非科学性主张。\n该问题是自洽的、一致的，并且在科学上是合理的。未发现任何缺陷。\n\n结论：该问题是有效的。我将继续进行解答。\n\n任务是首先区分机械嵌入和静电嵌入，然后推导总 QM-MM 静电嵌入能 $E_{\\mathrm{embed}}$。\n\n在 QM/MM 方案中，总哈密顿量在概念上可以写为 $\\hat{H}_{\\mathrm{total}} = \\hat{H}_{\\mathrm{QM}} + H_{\\mathrm{MM}} + \\hat{H}_{\\mathrm{QM/MM}}$。不同嵌入方案之间的区别在于耦合项 $\\hat{H}_{\\mathrm{QM/MM}}$ 的定义和处理方式。\n\n**机械嵌入**是最简单、也是最粗略的模型。在此方案中，QM 计算是在*真空*中进行的，这意味着电子哈密顿量 $\\hat{H}_{\\mathrm{el}}$ 不包含任何与 MM 环境相关的项。电子结构（波函数和密度 $\\rho(\\mathbf{r})$）的确定就如同经典子系统不存在一样。然后，QM-MM 相互作用能通过经典静电学*后验*计算得出，通常是在从 QM 波函数派生出的电荷（例如，Mulliken 电荷、ESP 电荷）与固定的 MM 点电荷 $q_i$ 之间计算。关键的是，MM 电荷不会极化 QM 电子密度，因为在自洽场过程中，它们不存在于哈密顿量中。这种耦合纯粹是机械性的，通过力影响几何优化，但不直接影响电子波函数。\n\n**静电嵌入**是一种更复杂、在物理上也更现实的方法。在此方案中，MM 环境的静电影响被直接包含在量子力学的电子哈密顿量中。MM 点电荷 $\\{q_i\\}$ 被视为一个经典外部静电势的来源，该电势同时作用于 QM 电子和原子核。这个势被并入哈密顿量的单电子部分。因此，电子薛定谔方程是在 MM 电荷产生的场存在的情况下求解的，这使得 QM 电子密度 $\\rho(\\mathbf{r})$ 能够响应环境而发生极化。这种极化是静电嵌入所捕捉到的一个关键物理效应。因此，QM-MM 静电相互作用能是 QM 能量计算的一个内在组成部分。\n\n现在，我将在静电嵌入框架内推导总 QM-MM 静电嵌入能 $E_{\\mathrm{embed}}$ 的表达式。总相互作用能是 MM 电荷与 QM 电子之间相互作用，以及 MM 电荷与 QM 原子核之间相互作用的总和。我们在 Hartree 原子单位制下工作，其中基本电荷 $e=1$，库仑常数 $1/(4\\pi\\varepsilon_0)$ 也为 1。因此，一个电子的电荷为 $-1$。\n\n由位于位置 $\\mathbf{R}_i$ 的 $M$ 个经典点电荷 $q_i$ 在空间中任意一点 $\\mathbf{r}$ 产生的静电势由下式给出：\n$$\nV_{\\mathrm{MM}}(\\mathbf{r}) = \\sum_{i=1}^{M} \\frac{q_i}{|\\mathbf{r} - \\mathbf{R}_i|}\n$$\n这是 QM 系统所经历的外势。\n\n首先，考虑 QM 电子与 MM 环境之间的相互作用。电子的电荷分布是连续的，由电荷密度 $-\\rho(\\mathbf{r})$ 描述，其中 $\\rho(\\mathbf{r})$ 是电子的*数量*密度。电荷分布与外势的静电相互作用能是电荷密度与势的乘积在整个空间上的积分。\n因此，电子-MM 相互作用能 $E_{\\mathrm{e-MM}}$ 为：\n$$\nE_{\\mathrm{e-MM}} = \\int (-\\rho(\\mathbf{r})) V_{\\mathrm{MM}}(\\mathbf{r}) d^3\\mathbf{r}\n$$\n代入 $V_{\\mathrm{MM}}(\\mathbf{r})$ 的表达式：\n$$\nE_{\\mathrm{e-MM}} = \\int (-\\rho(\\mathbf{r})) \\left( \\sum_{i=1}^{M} \\frac{q_i}{|\\mathbf{r} - \\mathbf{R}_i|} \\right) d^3\\mathbf{r}\n$$\n我们可以交换积分和求和的顺序：\n$$\nE_{\\mathrm{e-MM}} = - \\sum_{i=1}^{M} q_i \\int \\frac{\\rho(\\mathbf{r})}{|\\mathbf{r} - \\mathbf{R}_i|} d^3\\mathbf{r}\n$$\n此表达式代表了 QM 电子云与经典点电荷之间相互作用的总能量。\n\n其次，考虑 QM 原子核与 MM 环境之间的相互作用。在 Born–Oppenheimer 近似下，QM 原子核被视为位于位置 $\\mathbf{R}_A$ 的固定点电荷 $Z_A$。这种相互作用是两组点电荷之间的纯粹经典库仑相互作用。单个 QM 原子核 $A$ 与单个 MM 电荷 $i$ 之间的相互作用能为 $\\frac{Z_A q_i}{|\\mathbf{R}_A - \\mathbf{R}_i|}$。\n为了获得总的原子核-MM 相互作用能 $E_{\\mathrm{nuc-MM}}$，我们必须对所有 QM 原子核与 MM 电荷对进行求和：\n$$\nE_{\\mathrm{nuc-MM}} = \\sum_{A} \\sum_{i=1}^{M} \\frac{Z_A q_i}{|\\mathbf{R}_A - \\mathbf{R}_i|}\n$$\n\n总 QM-MM 静电嵌入能 $E_{\\mathrm{embed}}$ 是电子-MM 和原子核-MM 贡献的总和：\n$$\nE_{\\mathrm{embed}} = E_{\\mathrm{e-MM}} + E_{\\mathrm{nuc-MM}}\n$$\n$$\nE_{\\mathrm{embed}} = - \\sum_{i=1}^{M} q_i \\int \\frac{\\rho(\\mathbf{r})}{|\\mathbf{r} - \\mathbf{R}_i|} d^3\\mathbf{r} + \\sum_{A} \\sum_{i=1}^{M} \\frac{Z_A q_i}{|\\mathbf{R}_A - \\mathbf{R}_i|}\n$$\n问题要求一个单一的闭合形式表达式。我们可以通过提取对 MM 电荷 $q_i$ 的求和来合并这些项：\n$$\nE_{\\mathrm{embed}} = \\sum_{i=1}^{M} q_i \\left( \\sum_{A} \\frac{Z_A}{|\\mathbf{R}_A - \\mathbf{R}_i|} - \\int \\frac{\\rho(\\mathbf{r})}{|\\mathbf{r} - \\mathbf{R}_i|} d^3\\mathbf{r} \\right)\n$$\n这就是静电嵌入能的最终表达式。括号中的项是由 QM 系统（原子核和电子）产生的、在第 $i$ 个经典电荷的位置 $\\mathbf{R}_i$ 处计算的总静电势。", "answer": "$$\n\\boxed{\\sum_{i=1}^{M} q_{i} \\left( \\sum_{A} \\frac{Z_{A}}{|\\mathbf{R}_{A} - \\mathbf{R}_{i}|} - \\int \\frac{\\rho(\\mathbf{r})}{|\\mathbf{r} - \\mathbf{R}_{i}|} d^3\\mathbf{r} \\right)}\n$$", "id": "2904928"}, {"introduction": "最后，我们将我们的理论知识应用到一个与实验密切相关的实际问题上：预测光谱位移。这个练习 [@problem_id:2904919] 要求您模拟 MM 环境的静电场如何改变 QM 羰基的振动频率，这种效应被称为振动斯塔克效应。通过实现一个考虑 QM/MM 边界位置的模型，您将把静电嵌入的抽象形式与可测量的物理量联系起来。", "problem": "双原子羰基的伸缩振动可以被建模为一个与羰基键轴对齐的一维谐振子坐标 $x$，其中 $x$ 是沿键轴的标量位移，在平衡构型处 $x = 0$。在一个采用静电嵌入的量子力学/分子力学 (QM/MM) 混合描述中，分子力学 (MM) 环境由固定的经典点电荷表示，这些点电荷产生一个作用于量子力学 (QM) 电子的外部静电场。QM/MM 边界的位置决定了哪些 MM 电荷被包含在嵌入中（那些在 QM 区域之外的电荷），哪些不被包含（那些在 QM 区域之内的电荷）。您的任务是推导、实现并评估该边界的位置如何影响羰基的伸缩振动频率。\n\n使用以下基本基础和建模假设：\n- 羰基伸缩振动由谐势 $V_{0}(x) = \\tfrac{1}{2} k_{0} x^{2}$ 建模，其基线力常数 $k_{0}$ 由基线波数 $\\tilde{\\nu}_{0}$ 确定。\n- 该双原子分子的折合质量为 $\\mu = \\dfrac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$。\n- 经典 MM 电荷 $\\{q_{i}\\}$ 固定在相对于羰基键中心（取为原点）的位置 $\\{\\mathbf{R}_{i}\\}$ 上。场点 $\\mathbf{r}$ 处的电场由库仑定律给出：$\\mathbf{E}(\\mathbf{r}) = \\dfrac{1}{4 \\pi \\varepsilon_{0}} \\sum_{i} q_{i} \\dfrac{\\mathbf{r} - \\mathbf{R}_{i}}{\\lVert \\mathbf{r} - \\mathbf{R}_{i} \\rVert^{3}}$。\n- 令 $E_{\\parallel}(x)$ 表示 $\\mathbf{E}(x \\hat{\\mathbf{x}})$ 平行于键轴 $\\hat{\\mathbf{x}}$ 的分量。键偶极矩 $\\mu_{\\mathrm{bond}}(x)$ 在 $x=0$ 附近展开为 $\\mu_{\\mathrm{bond}}(x) \\approx \\mu_{\\mathrm{bond}}(0) + \\left(\\dfrac{d \\mu_{\\mathrm{bond}}}{dx}\\right)_{0} x$，其中 $\\left(\\dfrac{d \\mu_{\\mathrm{bond}}}{dx}\\right)_{0}$ 是一个表征该模式红外强度的恒定参数。外部静电相互作用能为 $U_{\\mathrm{ext}}(x) \\approx - \\mu_{\\mathrm{bond}}(x) E_{\\parallel}(x)$。\n- 通过将 $E_{\\parallel}(x)$ 在 $x=0$ 附近进行泰勒展开，并保留到 $x^{2}$ 阶的项，总势能 $V_{\\mathrm{tot}}(x) = \\tfrac{1}{2} k_{0} x^{2} + U_{\\mathrm{ext}}(x)$ 在二阶近似下定义了一个有效力常数 $k_{\\mathrm{eff}}$，并因此定义了一个有效波数 $\\tilde{\\nu}$。\n\n任务：\n1. 从给定的基本原理出发，并且不引入任何非物理的假设，推导出用 $k_{0}$、$\\left(\\dfrac{d \\mu_{\\mathrm{bond}}}{dx}\\right)_{0}$ 和场梯度 $\\left.\\dfrac{d E_{\\parallel}}{dx}\\right|_{x=0}$ 表示的有效力常数 $k_{\\mathrm{eff}}$ 的表达式。您的推导必须从 $U_{\\mathrm{ext}}(x) = - \\mu_{\\mathrm{bond}}(x) E_{\\parallel}(x)$ 的展开开始，并保留到 $x^{2}$ 阶的项。\n2. 使用库仑定律，为位于原点的键中心的一般点电荷集 $q_{i}$（位置为 $\\mathbf{R}_{i} = (X_{i}, Y_{i}, Z_{i})$），推导一个可计算的 $\\left.\\dfrac{d E_{\\parallel}}{dx}\\right|_{x=0}$ 公式。您的公式应表示为对 $i$ 的求和，并且必须用 $q_{i}$、$X_{i}$、$Y_{i}$、$Z_{i}$ 和基本常数来表示。\n3. 给定 $k_{\\mathrm{eff}}$，计算波数（单位为倒数厘米，$\\mathrm{cm^{-1}}$）：$\\tilde{\\nu} = \\dfrac{1}{2 \\pi c} \\sqrt{\\dfrac{k_{\\mathrm{eff}}}{\\mu}}$，其中 $c$ 是以 $\\mathrm{cm/s}$ 为单位表示的光速。最终答案以 $\\mathrm{cm^{-1}}$ 为单位表示，并四舍五入到三位小数。\n\n要使用的数值数据和单位：\n- 基线波数：$\\tilde{\\nu}_{0} = 1700.0 \\ \\mathrm{cm^{-1}}$。\n- 原子质量：$m_{\\mathrm{C}} = 12.0 \\ \\mathrm{u}$ 和 $m_{\\mathrm{O}} = 16.0 \\ \\mathrm{u}$，其中 $1 \\ \\mathrm{u} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$。\n- 沿简正坐标的键偶极矩导数：$\\left(\\dfrac{d \\mu_{\\mathrm{bond}}}{dx}\\right)_{0} = 0.40 \\ e$，其中 $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$。\n- 真空介电常数：$\\varepsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$。\n- 库仑前置因子：$k_{e} = \\dfrac{1}{4 \\pi \\varepsilon_{0}}$。\n- 光速：$c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm/s}$。\n- MM 环境相对于键中心的几何结构和点电荷（单位：电荷以 $e$ 计，坐标以 $\\mathrm{\\AA}$ 计）：\n  - $q_{1} = +0.30$, $\\mathbf{R}_{1} = (-3.00, \\ 2.00, \\ 0.00)$。\n  - $q_{2} = -0.50$, $\\mathbf{R}_{2} = (+3.00, \\ 0.00, \\ 0.00)$。\n  - $q_{3} = +0.20$, $\\mathbf{R}_{3} = (+5.00, \\ 1.00, \\ 0.00)$。\n  - $q_{4} = -0.10$, $\\mathbf{R}_{4} = ( \\ 0.00, \\ 4.00, \\ 0.00)$。\n- 边界放置规则（围绕键中心的半径为 $R$ 的球形 QM 区域）：任何距离 $r_{i} = \\sqrt{X_{i}^{2} + Y_{i}^{2} + Z_{i}^{2}} \\le R$ 的 MM 电荷被认为在 QM 区域内，因此从静电嵌入中排除；只有 $r_{i} > R$ 的电荷对嵌入场有贡献。\n\n测试套件：\n- 使用以下边界半径 $R$（单位 $\\mathrm{\\AA}$）：$[0.00, \\ 3.05, \\ 3.70, \\ 5.20]$。\n- 对于每个 $R$，在计算场梯度以及 $k_{\\mathrm{eff}}$ 时，只包括 $r_{i} > R$ 的电荷。\n\n程序要求：\n- 实现一个程序，执行上述基于推导的计算，以评估测试套件中每个半径对应的 $\\tilde{\\nu}$。\n- 严格按照提供的单位进行计算。在需要时，使用 $1 \\ \\mathrm{\\AA} = 1.0 \\times 10^{-10} \\ \\mathrm{m}$ 将 $\\mathrm{\\AA}$ 转换为 $\\mathrm{m}$，并使用给定的 $e$ 值将以 $e$ 为单位的电荷转换为库仑。\n- 输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目都是以 $\\mathrm{cm^{-1}}$ 为单位、四舍五入到三位小数的结果（例如，$[\\tilde{\\nu}_{1},\\tilde{\\nu}_{2},\\tilde{\\nu}_{3},\\tilde{\\nu}_{4}]$）。", "solution": "该问题要求在一个量子力学/分子力学 (QM/MM) 框架内，推导并实现一个用于羰基伸缩振动频率的静电斯塔克调谐模型。解决方案按要求分为三个部分：有效力常数的推导、电场梯度的推导以及随后的数值计算。\n\n**第 1 部分：有效力常数 $k_{\\mathrm{eff}}$ 的推导**\n\n该系统是一个双原子羰基伸缩振动，被建模为一个一维谐振子，其坐标 $x$ 代表偏离平衡键长的位移。总势能 $V_{\\mathrm{tot}}(x)$ 是键的内在谐势 $V_{0}(x)$ 与 MM 环境产生的外部静电场相互作用能 $U_{\\mathrm{ext}}(x)$ 的和。\n\n内在势能由下式给出：\n$$\nV_{0}(x) = \\frac{1}{2} k_{0} x^{2}\n$$\n其中 $k_{0}$ 是谐振子未受微扰的力常数。\n\n键偶极矩 $\\mu_{\\mathrm{bond}}(x)$ 与平行于键轴的外部电场分量 $E_{\\parallel}(x)$ 之间的相互作用能为：\n$$\nU_{\\mathrm{ext}}(x) = - \\mu_{\\mathrm{bond}}(x) E_{\\parallel}(x)\n$$\n\n为了确定有效力常数，我们必须求总势能 $V_{\\mathrm{tot}}(x) = V_{0}(x) + U_{\\mathrm{ext}}(x)$ 关于 $x$ 的二阶导数。这需要将 $U_{\\mathrm{ext}}(x)$ 在平衡位置 $x=0$ 附近展开为泰勒级数，并保留到 $x$ 的二次项。\n\n键偶极矩 $\\mu_{\\mathrm{bond}}(x)$ 和平行电场 $E_{\\parallel}(x)$ 在 $x=0$ 附近展开为：\n$$\n\\mu_{\\mathrm{bond}}(x) \\approx \\mu_{\\mathrm{bond}}(0) + \\left.\\frac{d\\mu_{\\mathrm{bond}}}{dx}\\right|_{x=0} x\n$$\n$$\nE_{\\parallel}(x) \\approx E_{\\parallel}(0) + \\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0} x\n$$\n让我们引入简写符号 $\\mu_{0} = \\mu_{\\mathrm{bond}}(0)$、$\\mu_{1} = \\left.\\frac{d\\mu_{\\mathrm{bond}}}{dx}\\right|_{x=0}$、$E_{0} = E_{\\parallel}(0)$ 和 $E_{1} = \\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}$。展开式变为：\n$$\n\\mu_{\\mathrm{bond}}(x) \\approx \\mu_{0} + \\mu_{1} x\n$$\n$$\nE_{\\parallel}(x) \\approx E_{0} + E_{1} x\n$$\n将这些代入 $U_{\\mathrm{ext}}(x)$ 的表达式中：\n$$\nU_{\\mathrm{ext}}(x) \\approx -(\\mu_{0} + \\mu_{1} x)(E_{0} + E_{1} x) = -(\\mu_{0}E_{0} + \\mu_{0}E_{1}x + \\mu_{1}E_{0}x + \\mu_{1}E_{1}x^2)\n$$\n按 $x$ 的幂次合并项：\n$$\nU_{\\mathrm{ext}}(x) \\approx -\\mu_{0}E_{0} - (\\mu_{1}E_{0} + \\mu_{0}E_{1})x - \\mu_{1}E_{1}x^2\n$$\n因此，到二次项为止的总势能为：\n$$\nV_{\\mathrm{tot}}(x) \\approx \\frac{1}{2} k_{0} x^{2} - \\mu_{0}E_{0} - (\\mu_{1}E_{0} + \\mu_{0}E_{1})x - \\mu_{1}E_{1}x^2\n$$\n$$\nV_{\\mathrm{tot}}(x) \\approx -\\mu_{0}E_{0} - (\\mu_{1}E_{0} + \\mu_{0}E_{1})x + \\left(\\frac{1}{2} k_{0} - \\mu_{1}E_{1}\\right)x^2\n$$\n对于小振动，有效势是谐势。谐势 $V(y) = \\frac{1}{2} k y^2$ 的力常数是 $k$。我们的势能 $V_{\\mathrm{tot}}(x)$ 是 $x$ 的二次函数。力常数由势能对位移的二阶导数在势能最小值处的值给出。$V_{\\mathrm{tot}}(x)$ 关于 $x$ 的二阶导数是：\n$$\n\\frac{d^2 V_{\\mathrm{tot}}}{dx^2} = \\frac{d^2}{dx^2} \\left[ \\left(\\frac{1}{2} k_{0} - \\mu_{1}E_{1}\\right)x^2 + \\dots \\right] = 2 \\left(\\frac{1}{2} k_{0} - \\mu_{1}E_{1}\\right) = k_{0} - 2\\mu_{1}E_{1}\n$$\n这个二阶导数是常数，因此它在新平衡位置的值是相同的。所以，有效力常数 $k_{\\mathrm{eff}}$ 是：\n$$\nk_{\\mathrm{eff}} = k_{0} - 2\\mu_{1}E_{1} = k_{0} - 2 \\left(\\frac{d\\mu_{\\mathrm{bond}}}{dx}\\right)_{0} \\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}\n$$\n这就完成了第一个任务。\n\n**第 2 部分：场梯度 $\\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}$ 的推导**\n\n由一组位于位置 $\\{\\mathbf{R}_i\\}$ 的固定点电荷 $\\{q_i\\}$ 在场点 $\\mathbf{r}$ 处产生的电场 $\\mathbf{E}$ 由库仑定律给出：\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4 \\pi \\varepsilon_{0}} \\sum_{i} q_{i} \\frac{\\mathbf{r} - \\mathbf{R}_{i}}{\\lVert \\mathbf{r} - \\mathbf{R}_{i} \\rVert^{3}}\n$$\n设键轴为 $x$ 轴，因此单位矢量为 $\\hat{\\mathbf{x}}$。键上距离中心位移为 $x$ 的一点是 $\\mathbf{r} = x\\hat{\\mathbf{x}} = (x, 0, 0)$。设电荷 $q_i$ 的位置为 $\\mathbf{R}_i = (X_i, Y_i, Z_i)$。矢量 $\\mathbf{r} - \\mathbf{R}_i$ 是 $(x-X_i, -Y_i, -Z_i)$。其模的平方为 $\\lVert \\mathbf{r} - \\mathbf{R}_i \\rVert^2 = (x-X_i)^2 + Y_i^2 + Z_i^2$。\n\n平行于键轴的电场分量是 $E_{\\parallel}(x) = \\mathbf{E}(x\\hat{\\mathbf{x}}) \\cdot \\hat{\\mathbf{x}} = E_x(x)$。\n$$\nE_{\\parallel}(x) = \\frac{1}{4 \\pi \\varepsilon_{0}} \\sum_{i} q_{i} \\frac{x-X_i}{\\left( (x-X_i)^2 + Y_i^2 + Z_i^2 \\right)^{3/2}}\n$$\n为了找到场梯度 $\\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}$，我们将 $E_{\\parallel}(x)$ 对 $x$ 求导，然后令 $x=0$。求导可以对求和中的每一项逐项进行。对于单个电荷 $i$，使用商法则 $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$：\n设 $u = x-X_i$ 且 $v = ((x-X_i)^2 + Y_i^2 + Z_i^2)^{3/2}$。\n$u' = 1$。\n$v' = \\frac{3}{2}((x-X_i)^2 + Y_i^2 + Z_i^2)^{1/2} \\cdot 2(x-X_i) = 3(x-X_i)((x-X_i)^2 + Y_i^2 + Z_i^2)^{1/2}$。\n\n第 $i$ 项的导数是：\n$$\n\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{ ((x-X_i)^2 + Y_i^2 + Z_i^2)^{3/2} - (x-X_i) \\cdot 3(x-X_i)((x-X_i)^2 + Y_i^2 + Z_i^2)^{1/2} }{ \\left( (x-X_i)^2 + Y_i^2 + Z_i^2 \\right)^3 }\n$$\n$$\n= \\frac{ (x-X_i)^2 + Y_i^2 + Z_i^2 - 3(x-X_i)^2 }{ \\left( (x-X_i)^2 + Y_i^2 + Z_i^2 \\right)^{5/2} } = \\frac{ Y_i^2 + Z_i^2 - 2(x-X_i)^2 }{ \\left( (x-X_i)^2 + Y_i^2 + Z_i^2 \\right)^{5/2} }\n$$\n在 $x=0$ 处计算此导数：\n$$\n\\left.\\frac{d}{dx}\\left(\\frac{u}{v}\\right)\\right|_{x=0} = \\frac{ Y_i^2 + Z_i^2 - 2(-X_i)^2 }{ \\left( (-X_i)^2 + Y_i^2 + Z_i^2 \\right)^{5/2} } = \\frac{ Y_i^2 + Z_i^2 - 2X_i^2 }{ \\left( X_i^2 + Y_i^2 + Z_i^2 \\right)^{5/2} }\n$$\n对 MM 环境中包含的所有电荷 $i$ 求和，我们得到场梯度的可计算公式：\n$$\n\\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0} = \\frac{1}{4 \\pi \\varepsilon_{0}} \\sum_{i} q_{i} \\frac{ Y_i^2 + Z_i^2 - 2X_i^2 }{ \\left( X_i^2 + Y_i^2 + Z_i^2 \\right)^{5/2} }\n$$\n这就完成了第二个任务。\n\n**第 3 部分：数值计算策略**\n\n数值计算按以下步骤进行：\n1.  **以 SI 单位计算常数**：所有提供的参数必须转换为一致的单位制，最好是国际单位制 (SI)。\n    -   折合质量 $\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$，其中质量从原子质量单位 ($u$) 转换为千克 ($kg$) 。\n    -   偶极矩导数 $\\left(\\frac{d \\mu_{\\mathrm{bond}}}{dx}\\right)_{0}$ 从 $e$ 单位转换为库仑 ($C$)。\n    -   坐标从埃 ($\\mathrm{\\AA}$) 转换为米 ($m$)。\n    -   电荷从基本电荷单位 ($e$) 转换为库仑 ($C$)。\n2.  **计算基线力常数 $k_{0}$**：波数 $\\tilde{\\nu}$ （单位 $cm^{-1}$）、折合质量 $\\mu$ 和力常数 $k$ 之间的关系是 $\\tilde{\\nu} = \\frac{1}{2 \\pi c} \\sqrt{\\frac{k}{\\mu}}$。此关系被重新整理，以从给定的 $\\tilde{\\nu}_0$ 中求出 $k_0$：\n    $$\n    k_{0} = \\mu (2 \\pi c \\tilde{\\nu}_{0})^2\n    $$\n    光速 $c$ 必须使用 $cm/s$ 单位，以匹配 $\\tilde{\\nu}_0$ 的单位。\n3.  **遍历边界半径**：对于测试套件中的每个半径 $R$：\n    a.  **应用边界条件**：对于每个位于 $\\mathbf{R}_i$ 的点电荷 $q_i$，计算其到原点的距离 $r_i = \\lVert\\mathbf{R}_i\\rVert = \\sqrt{X_i^2 + Y_i^2 + Z_i^2}$。只有当 $r_i > R$ 时，该电荷才被包含在静电嵌入计算中。\n    b.  **计算场梯度**：使用推导的公式，通过对包含的电荷求和来计算 $\\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}$。如果没有包含任何电荷，则此项为零。\n    c.  **计算有效力常数 $k_{\\mathrm{eff}}$**：使用推导的关系式 $k_{\\mathrm{eff}} = k_{0} - 2 \\left(\\frac{d\\mu_{\\mathrm{bond}}}{dx}\\right)_{0} \\left.\\frac{dE_{\\parallel}}{dx}\\right|_{x=0}$。\n    d.  **计算有效波数 $\\tilde{\\nu}$**：将 $k_{\\mathrm{eff}}$ 转换回波数：\n        $$\n        \\tilde{\\nu} = \\frac{1}{2 \\pi c} \\sqrt{\\frac{k_{\\mathrm{eff}}}{\\mu}}\n        $$\n4.  **格式化输出**：每个半径 $R$ 的最终结果四舍五入到三位小数，并以指定格式呈现。以下程序实现了这个过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the shift in carbonyl stretching frequency due to an\n    external electrostatic field from MM point charges in a QM/MM model.\n    \"\"\"\n\n    # --- Fundamental Constants and Parameters ---\n    # Baseline wavenumber in cm^-1\n    NU0_CM = 1700.0\n    # Atomic masses in u\n    M_C_U = 12.0\n    M_O_U = 16.0\n    # Dipole derivative in units of e\n    DMU_DX_E = 0.40\n    # Elementary charge in Coulombs\n    E_CHARGE = 1.602176634e-19  # C\n    # Atomic mass unit in kg\n    U_IN_KG = 1.66053906660e-27  # kg\n    # Vacuum permittivity in F/m\n    EPSILON_0 = 8.8541878128e-12  # F/m\n    # Coulomb's constant in N m^2 / C^2\n    K_E = 1 / (4 * np.pi * EPSILON_0)\n    # Speed of light in cm/s\n    C_IN_CMS = 2.99792458e10\n    # Angstrom to meter conversion\n    A_IN_M = 1.0e-10\n\n    # --- MM Environment Data ---\n    # Charges [q in e, X in Å, Y in Å, Z in Å]\n    charges_data = np.array([\n        [+0.30, -3.00, 2.00, 0.00],\n        [-0.50, +3.00, 0.00, 0.00],\n        [+0.20, +5.00, 1.00, 0.00],\n        [-0.10, 0.00, 4.00, 0.00]\n    ])\n\n    # --- Test Suite ---\n    # Boundary radii in Å\n    boundary_radii_A = [0.00, 3.05, 3.70, 5.20]\n\n    # --- Step 1: Calculate derived constants in SI units ---\n\n    # Reduced mass in kg\n    mu_kg = (M_C_U * M_O_U) / (M_C_U + M_O_U) * U_IN_KG\n\n    # Baseline force constant in N/m\n    # k = mu * (2*pi*nu)^2 = mu * (2*pi*c*nu_tilde)^2\n    # Ensure units are consistent: mu (kg), c (cm/s), nu_tilde (cm^-1)\n    k0 = mu_kg * (2 * np.pi * C_IN_CMS * NU0_CM)**2\n\n    # Dipole derivative in C (Coulombs)\n    dmu_dx_C = DMU_DX_E * E_CHARGE\n\n    # --- Step 2: Iterate through test cases ---\n    results_nu = []\n\n    for boundary_R_A in boundary_radii_A:\n        # Filter charges based on the boundary radius\n        positions_A = charges_data[:, 1:]\n        distances_A = np.linalg.norm(positions_A, axis=1)\n        \n        active_mask = distances_A > boundary_R_A\n        active_charges = charges_data[active_mask]\n\n        if active_charges.shape[0] == 0:\n            # No charges in the MM environment, so no field gradient\n            grad_E_parallel = 0.0\n        else:\n            # Convert active charge data to SI units for calculation\n            q_C = active_charges[:, 0] * E_CHARGE\n            X_m = active_charges[:, 1] * A_IN_M\n            Y_m = active_charges[:, 2] * A_IN_M\n            Z_m = active_charges[:, 3] * A_IN_M\n\n            # Calculate the field gradient using the derived formula\n            # grad_E = sum_i( K_E * q_i * (Y_i^2 + Z_i^2 - 2*X_i^2) / (X_i^2 + Y_i^2 + Z_i^2)^(5/2) )\n            R_sq_m = X_m**2 + Y_m**2 + Z_m**2\n            \n            numerator = Y_m**2 + Z_m**2 - 2 * X_m**2\n            denominator = R_sq_m**(5/2)\n            \n            # Sum over all active charges\n            sum_terms = np.sum(q_C * numerator / denominator)\n            \n            grad_E_parallel = K_E * sum_terms\n\n        # Calculate effective force constant\n        # k_eff = k0 - 2 * (dmu/dx) * (dE/dx)\n        k_eff = k0 - 2 * dmu_dx_C * grad_E_parallel\n\n        # Calculate new wavenumber in cm^-1\n        # nu_tilde = (1 / (2*pi*c)) * sqrt(k_eff / mu)\n        if k_eff  0:\n            # Handle physically unrealistic case of negative force constant\n            nu_eff_cm = np.nan\n        else:\n            nu_eff_cm = (1 / (2 * np.pi * C_IN_CMS)) * np.sqrt(k_eff / mu_kg)\n        \n        results_nu.append(nu_eff_cm)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.3f}\" for res in results_nu]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2904919"}]}