{"hands_on_practices": [{"introduction": "要真正掌握GW近似，我们必须首先理解自能 $\\Sigma$ 与准粒子性质之间的基本联系。本练习剥离了完整GW形式主义的复杂性，专注于其核心结果：自能如何改变电子的行为。通过一个简单而富有启发性的 $\\Sigma$ 模型来求解戴森方程 [@problem_id:2930200]，你将解析地推导出准粒子的能量、寿命和谱权重，从而揭示蕴含在格林函数中的物理意义。", "problem": "考虑一个单一、非简并的分子轨道，其无相互作用能量为 $\\,\\varepsilon_{0}\\,$（相对于化学势测量）。其多体效应在格林函数-屏蔽库仑相互作用 (GW) 框架内通过一个与频率无关的推迟自能 $\\,\\Sigma^{R}(\\omega)=\\Delta-\\mathrm{i}\\gamma\\,$ 来近似，其中 $\\,\\Delta\\in\\mathbb{R}\\,$ 代表能量移动，$\\,\\gamma>0\\,$ 代表有限寿命展宽。在 $\\,\\hbar=1\\,$ 的单位制下进行计算，并使用推迟单粒子格林函数。从推迟格林函数和Dyson方程的基本定义，以及谱函数的定义出发，完成以下任务：\n\n1) 求解Dyson方程，得到该轨道的相互作用推迟格林函数 $\\,G^{R}(\\omega)\\,$。\n\n2) 通过找到 $\\,G^{R}(\\omega)\\,$ 极点的实部，确定准粒子能量。\n\n3) 从极点的虚部，或等价地，从 $\\,G^{R}(\\omega)\\,$ 所隐含的时间衰减中确定准粒子寿命。\n\n4) 使用准粒子谱权重（或称重整化因子）$Z$ 的定义 $Z = \\left(1 - \\frac{\\partial \\mathrm{Re}[\\Sigma^{R}(\\omega)]}{\\partial \\omega}\\right)^{-1}_{\\omega = E_{\\mathrm{qp}}}$，计算该值。\n\n将您的最终答案表示为以 $\\,\\omega\\,$, $\\,\\varepsilon_{0}\\,$, $\\,\\Delta\\,$ 和 $\\,\\gamma\\,$ 表示的闭合形式解析表达式。不要在最终表达式中包含单位。将最终结果以行矩阵的形式按顺序 $\\bigl(G^{R}(\\omega),\\,E_{\\mathrm{qp}},\\,\\tau,\\,Z\\bigr)$ 给出。无需进行数值近似或四舍五入。[@problem_id:442]", "solution": "对问题陈述进行验证。\n\n首先，逐字提取所有给定条件。\n- 系统：一个单一、非简并的分子轨道。\n- 无相互作用能量：$\\varepsilon_{0}$（相对于化学势）。\n- 近似方法：格林函数-屏蔽库仑相互作用 (GW) 框架。\n- 推迟自能：$\\Sigma^{R}(\\omega)=\\Delta-\\mathrm{i}\\gamma$。\n- 自能参数的条件：$\\Delta\\in\\mathbb{R}$ 且 $\\gamma>0$。\n- 单位：$\\hbar=1$。\n- 所需函数：推迟单粒子格林函数 $G^{R}(\\omega)$。\n- 任务：\n    1. 求解Dyson方程以得到相互作用的推迟格林函数 $G^{R}(\\omega)$。\n    2. 确定准粒子能量 $E_{\\mathrm{qp}}$。\n    3. 确定准粒子寿命 $\\tau$。\n    4. 确定准粒子谱权重（重整化因子）$Z$。\n- 最终答案格式：一个行矩阵 $\\bigl(G^{R}(\\omega),\\,E_{\\mathrm{qp}},\\,\\tau,\\,Z\\bigr)$。\n\n接下来，根据所需标准对问题进行验证。\n- **科学基础**：该问题在根本上是合理的。它涉及量子多体物理中的标准概念，特别是用于描述准粒子的格林函数形式主义。Dyson方程、自能以及准粒子能量、寿命和谱权重的定义都是该理论的标准要素。自能的具体形式 $\\Sigma^{R}(\\omega) = \\Delta - \\mathrm{i}\\gamma$ 是一个常用且有用的模型（静态或与频率无关的近似），用于描述一个具有恒定能量移动和有限寿命的系统。\n- **适定性**：该问题是适定的。它提供了所有必要的信息和定义，以唯一地确定所要求的四个量。任务被清晰且按顺序地指定。\n- **客观性**：该问题用客观、精确的科学语言表述。\n\n结论是该问题是**有效的**。这是多体微扰理论应用中一个直接了当但又基础的练习。我们继续进行求解。\n\n求解从Dyson方程开始，该方程将相互作用格林函数 $G^{R}(\\omega)$ 与无相互作用格林函数 $G_{0}^{R}(\\omega)$ 和自能 $\\Sigma^{R}(\\omega)$ 联系起来。该方程的代数形式是：\n$$\n(G^{R}(\\omega))^{-1} = (G_{0}^{R}(\\omega))^{-1} - \\Sigma^{R}(\\omega)\n$$\n对于能量为 $\\varepsilon_{0}$ 的单个无相互作用电子能级，推迟格林函数在 $\\omega = \\varepsilon_{0}$ 处有一个简单极点。其逆由下式给出：\n$$\n(G_{0}^{R}(\\omega))^{-1} = \\omega - \\varepsilon_{0}\n$$\n问题将推迟自能指定为与频率无关的常数：\n$$\n\\Sigma^{R}(\\omega) = \\Delta - \\mathrm{i}\\gamma\n$$\n将这些表达式代入Dyson方程，得到相互作用格林函数的逆：\n$$\n(G^{R}(\\omega))^{-1} = (\\omega - \\varepsilon_{0}) - (\\Delta - \\mathrm{i}\\gamma) = \\omega - (\\varepsilon_{0} + \\Delta) + \\mathrm{i}\\gamma\n$$\n**1) 相互作用的推迟格林函数 $G^{R}(\\omega)$**\n通过对上述表达式求逆，我们得到相互作用的推迟格林函数：\n$$\nG^{R}(\\omega) = \\frac{1}{\\omega - (\\varepsilon_{0} + \\Delta) + \\mathrm{i}\\gamma}\n$$\n这是解的第一部分。这个表达式描述了一个能量发生移动且寿命有限的准粒子态。\n\n**2) 准粒子能量 $E_{\\mathrm{qp}}$**\n准粒子的性质编码在相互作用格林函数的极点 $\\omega_{p}$ 中。极点是使 $G^{R}(\\omega)$ 分母为零的复数 $\\omega$ 值：\n$$\n\\omega_{p} - (\\varepsilon_{0} + \\Delta) + \\mathrm{i}\\gamma = 0\n$$\n求解 $\\omega_{p}$ 得：\n$$\n\\omega_{p} = \\varepsilon_{0} + \\Delta - \\mathrm{i}\\gamma\n$$\n准粒子能量 $E_{\\mathrm{qp}}$ 定义为极点的实部：\n$$\nE_{\\mathrm{qp}} = \\mathrm{Re}(\\omega_{p}) = \\varepsilon_{0} + \\Delta\n$$\n这表明，在此模型中，多体相互作用使原始能量 $\\varepsilon_{0}$ 移动了一个恒定的量 $\\Delta$。\n\n**3) 准粒子寿命 $\\tau$**\n准粒子的寿命由极点的虚部决定。准粒子波函数振幅的时间演化包含一个因子 $\\exp(-\\mathrm{i}\\omega_{p}t) = \\exp(-\\mathrm{i}E_{\\mathrm{qp}}t)\\exp(-\\gamma t)$。在该状态下找到粒子的概率按 $|\\exp(-\\gamma t)|^{2} = \\exp(-2\\gamma t)$ 衰减。寿命 $\\tau$ 是概率衰减率的倒数。衰减率为 $\\Gamma = 2\\gamma$。\n或者，更正式地，我们可以考虑谱函数 $A(\\omega) = -\\frac{1}{\\pi}\\mathrm{Im}(G^{R}(\\omega))$：\n$$\nA(\\omega) = -\\frac{1}{\\pi}\\mathrm{Im}\\left(\\frac{1}{\\omega - E_{\\mathrm{qp}} + \\mathrm{i}\\gamma}\\right) = -\\frac{1}{\\pi}\\mathrm{Im}\\left(\\frac{\\omega - E_{\\mathrm{qp}} - \\mathrm{i}\\gamma}{(\\omega - E_{\\mathrm{qp}})^{2} + \\gamma^{2}}\\right) = \\frac{1}{\\pi}\\frac{\\gamma}{(\\omega - E_{\\mathrm{qp}})^{2} + \\gamma^{2}}\n$$\n这是一个洛伦兹分布，其半峰全宽的一半 (HWHM) 等于 $\\gamma$。代表该状态能量不确定性的半峰全宽 (FWHM) 是 $\\Gamma = 2\\gamma$。寿命 $\\tau$ 与该宽度通过能量-时间不确定性原理 $\\tau = \\hbar/\\Gamma$ 相关。由于我们在 $\\hbar=1$ 的单位制下工作，寿命为：\n$$\n\\tau = \\frac{1}{\\Gamma} = \\frac{1}{2\\gamma}\n$$\n\n**4) 准粒子谱权重 $Z$**\n准粒子谱权重，或重整化因子 $Z$，量化了相干准粒子峰所包含的总谱权重的分数。它由以下关系定义：\n$$\nZ^{-1} = 1 - \\frac{\\partial \\mathrm{Re}[\\Sigma^{R}(\\omega)]}{\\partial \\omega} \\bigg|_{\\omega = E_{\\mathrm{qp}}}\n$$\n给定自能的实部是：\n$$\n\\mathrm{Re}[\\Sigma^{R}(\\omega)] = \\mathrm{Re}[\\Delta - \\mathrm{i}\\gamma] = \\Delta\n$$\n由于 $\\Delta$ 是一个常数，它对频率 $\\omega$ 的导数为零：\n$$\n\\frac{\\partial \\mathrm{Re}[\\Sigma^{R}(\\omega)]}{\\partial \\omega} = \\frac{\\partial \\Delta}{\\partial \\omega} = 0\n$$\n因此，重整化因子的倒数是：\n$$\nZ^{-1} = 1 - 0 = 1\n$$\n这给出了准粒子谱权重为：\n$$\nZ = 1\n$$\n这个结果是符合预期的。一个与频率无关的自能对应于一个模型，在该模型中，准粒子极点是简单的，并包含了全部的谱强度；没有谱权重转移到非相干背景中。\n\n将这四个结果组合成所要求的行矩阵，得出最终答案。\n- $G^{R}(\\omega) = \\frac{1}{\\omega - (\\varepsilon_{0} + \\Delta) + \\mathrm{i}\\gamma}$\n- $E_{\\mathrm{qp}} = \\varepsilon_{0} + \\Delta$\n- $\\tau = \\frac{1}{2\\gamma}$\n- $Z = 1$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\omega - (\\varepsilon_{0} + \\Delta) + \\mathrm{i}\\gamma}  \\varepsilon_{0} + \\Delta  \\frac{1}{2\\gamma}  1 \\end{pmatrix}}\n$$", "id": "2930200"}, {"introduction": "在掌握了基本概念之后，我们现在转向一个在物理相关模型系统中更具实践性的计算。本练习介绍静态库仑洞和屏蔽交换（COHSEX）近似，这是一种计算上高效且功能强大的对全频率依赖GW自能的简化。通过将COHSEX框架应用于二维电子气 [@problem_id:1147575]，你将在动量空间中计算自能修正方面获得实践经验，这是固态物理学中的一个标准程序。", "problem": "在多体格林函数理论的背景下，GW近似提供了一种计算相互作用电子体系准粒子能量的方法。自能 $\\Sigma$ 描述了交换和关联的效应。一种常见的简化是静态COHSEX（库仑空穴和屏蔽交换）近似，其中自能被视为与频率无关。\n\n考虑一个二维电子气（2DEG），其中波矢为 $\\mathbf{k}$ 的电子具有抛物线形的非相互作用色散关系 $\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m}$。在零温下，电子填充了所有低于费米波矢 $k_F$ 的态。该体系的多体效应由静态COHSEX自能 $\\Sigma(\\mathbf{k})$ 描述，它给出了一阶准粒子能量修正 $\\Delta E_\\mathbf{k} = \\Sigma(\\mathbf{k})$。\n\n自能分为两部分：屏蔽交换（SEX）项 $\\Sigma^{SEX}(\\mathbf{k})$ 和库仑空穴（COH）项 $\\Sigma^{COH}$。\n$$\n\\Sigma(\\mathbf{k}) = \\Sigma^{COH} + \\Sigma^{SEX}(\\mathbf{k})\n$$\n与k无关的COH项由静态屏蔽相互作用 $W(\\mathbf{q})$ 和裸库仑相互作用 $v(\\mathbf{q})$ 之差给出：\n$$\n\\Sigma^{COH} = \\frac{1}{2} \\int \\frac{d^2q}{(2\\pi)^2} \\left[ W(\\mathbf{q}) - v(\\mathbf{q}) \\right]\n$$\n与k相关的SEX项由以下公式给出：\n$$\n\\Sigma^{SEX}(\\mathbf{k}) = - \\int_{|\\mathbf{k'}| < k_F} \\frac{d^2k'}{(2\\pi)^2} W(|\\mathbf{k}-\\mathbf{k'}|)\n$$\n其中积分遍及所有被占据态。\n\n对于二维电子气，傅里叶空间中的裸库仑相互作用为 $v(q) = V_0/q$，其中 $q=|\\mathbf{q}|$，$V_0$ 是一个表示相互作用强度的常数。一个简单的静态屏蔽相互作用的正则化模型由下式给出：\n$$\nW(q) = \\frac{V_0}{\\sqrt{q^2 + q_s^2}}\n$$\n其中 $q_s$ 是一个常数屏蔽波矢。该模型在大 $q$ 值时（$W(q) \\approx v(q)$）能捕捉到正确的裸相互作用行为，并在小 $q$ 值时模拟了屏蔽效应。\n\n计算能带底（$\\mathbf{k}=0$）处状态（即最低占据态）的总准粒子能量修正 $\\Delta E_0 = \\Sigma(k=0)$。用 $V_0$、$k_F$ 和 $q_s$ 表示你的答案。", "solution": "我们要计算\n$$\\Delta E_0=\\Sigma(0)=\\Sigma^{COH}+\\Sigma^{SEX}(0)\\,. $$\n\n1.  COH项：\n$$\n\\Sigma^{COH}=\\frac12\\int\\frac{d^2q}{(2\\pi)^2}\\Bigl[W(q)-v(q)\\Bigr]\n=\\frac1{4\\pi}\\int_0^\\infty q\\,dq\\Bigl[\\frac{V_0}{\\sqrt{q^2+q_s^2}}-\\frac{V_0}{q}\\Bigr].\n$$\n定义\n$$I=\\int_0^\\infty\\Bigl(\\frac{q}{\\sqrt{q^2+q_s^2}}-1\\Bigr)dq\n=\\lim_{\\Lambda\\to\\infty}\\bigl[\\sqrt{\\Lambda^2+q_s^2}-q_s-\\Lambda\\bigr]\n=-q_s.\n$$\n因此\n$$\n\\Sigma^{COH}=\\frac{V_0}{4\\pi}\\,I\n=-\\frac{V_0\\,q_s}{4\\pi}.\n$$\n\n2.  k=0处的SEX项：\n$$\n\\Sigma^{SEX}(0)=-\\int_{|\\mathbf k'|<k_F}\\frac{d^2k'}{(2\\pi)^2}W(k')\n=-\\frac{1}{2\\pi}\\int_0^{k_F}k'dk'W(k')\n=-\\frac{V_0}{2\\pi}\\int_0^{k_F}\\frac{k'dk'}{\\sqrt{k'^2+q_s^2}}\n=-\\frac{V_0}{2\\pi}\\bigl[\\sqrt{k'^2+q_s^2}\\bigr]_0^{k_F}\n=-\\frac{V_0}{2\\pi}\\bigl(\\sqrt{k_F^2+q_s^2}-q_s\\bigr).\n$$\n3.  总和：\n$$\n\\Delta E_0=-\\frac{V_0q_s}{4\\pi}-\\frac{V_0}{2\\pi}\\bigl(\\sqrt{k_F^2+q_s^2}-q_s\\bigr)\n=\\frac{V_0}{4\\pi}\\bigl(-q_s-2\\sqrt{k_F^2+q_s^2}+2q_s\\bigr)\n=\\frac{V_0}{4\\pi}\\bigl(q_s-2\\sqrt{k_F^2+q_s^2}\\bigr).\n$$", "answer": "$$\\boxed{\\frac{V_{0}}{4\\pi}\\bigl(q_{s}-2\\sqrt{k_{F}^{2}+q_{s}^{2}}\\bigr)}$$", "id": "1147575"}, {"introduction": "理解的最终检验是付诸实践。这最后一个练习通过指导你构建一个简化的 $G_0W_0$ 模型来计算硅晶体的带隙，从而弥合了理论与实际计算之间的鸿沟 [@problem_id:2930201]。你将实现静态COHSEX近似，利用等离激元-极点模型来描述屏蔽作用，并批判性地评估结果如何随关键数值参数收敛，从而深入了解前沿电子结构计算的实际挑战和细微差别。", "problem": "考虑一种用于计算晶体硅间接带隙的、简化的、球形平均的单次格林函数乘以屏蔽库仑相互作用近似（$G_{0}W_{0}$）实现。目标是使用等离激元-极点模型计算准粒子带隙，并评估其相对于空带数量和介电截断的收敛性。您的程序必须基于第一性原理和物理驱动的近似实现一个自成体系的模型，且不得使用任何外部输入。\n\n请从以下经过充分测试的基础和核心定义开始：\n\n- Hedin方程中的多体自能，其中对角准粒子修正定义为 $E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{KS}} + \\langle \\phi_{n} | \\Sigma(E_{n}^{\\mathrm{KS}}) - V_{\\mathrm{xc}} | \\phi_{n} \\rangle$。其中，$G_{0}W_{0}$ 使用Kohn–Sham（KS）格林函数，以及基于随机相位近似（RPA）构建的屏蔽库仑相互作用。此处，$E_{n}^{\\mathrm{QP}}$ 是准粒子能量，$E_{n}^{\\mathrm{KS}}$ 是Kohn–Sham能量，$\\phi_{n}$ 是KS轨道，$\\Sigma$ 是自能，$V_{\\mathrm{xc}}$ 是来自密度泛函理论（DFT）的交换相关势。\n- 屏蔽库仑相互作用为 $W(\\mathbf{r},\\mathbf{r}';\\omega) = \\int d\\mathbf{r}'' \\,\\epsilon^{-1}(\\mathbf{r},\\mathbf{r}'';\\omega)\\, v(\\mathbf{r}''-\\mathbf{r}')$，其中 $v$ 是裸库仑势，$\\epsilon$ 是RPA中的介电函数。对于均匀参考系，在倒易空间中，裸库仑势在原子单位下为 $v(G) = \\dfrac{4\\pi}{G^{2}}$。\n- 广义等离激元-极点模型（PPM）通过为每个倒格矢 $G$ 设置一个与静态极限匹配的有效极点，来近似介电函数倒数的频率依赖性。特别地，静态极限 $W(G,\\omega=0)$ 与PPM一致，并且足以推导出一个静态屏蔽交换加库仑空穴（COHSEX）形式，该形式能够捕捉 $G_{0}W_{0}$ 修正的主要趋势。\n\n您必须推导并实现一个与 $W$ 的等离激元-极点描述一致的静态、球形平均的COHSEX模型，该模型允许通过两个数值参数系统地改变屏蔽质量：\n\n- 空带数量 $N_{\\mathrm{emp}}$，通过粒子-空穴跃迁的完备性来控制RPA屏蔽的饱和。将其建模为一个有效类Thomas–Fermi屏蔽波矢 $k_{\\mathrm{s}}(N_{\\mathrm{emp}})$ 的单调饱和。\n- 介电平面波截断能 $E_{\\mathrm{cut}}$（单位为电子伏特），通过动能关系 $E_{G} = \\dfrac{G^{2}}{2}$（单位为Hartree）来限制所包含的最大倒格矢 $G$。这意味着最大 $G$ 由 $G_{\\max} = \\sqrt{2 E_{\\mathrm{cut}}^{\\mathrm{Ha}}}$ 给出，其中 $E_{\\mathrm{cut}}^{\\mathrm{Ha}}$ 是将 $E_{\\mathrm{cut}}$ 转换为Hartree单位的值。\n\n假设以下物理驱动且科学上一致的简化，以使问题在计算上易于处理，同时保留第一性原理结构：\n\n1) 对平面波、球形平均表示中的对角矩阵元使用静态COHSEX分解，\n   - 对于最高占据价态 $v$ 的屏蔽交换（SEX）：\n     $$\\Sigma_{\\mathrm{SEX},v} = - \\int \\frac{d^{3}G}{(2\\pi)^{3}} \\, W(G,0)\\, |\\rho_{v}(G)|^{2},$$\n     对于最低未占导态 $c$，设置 $\\Sigma_{\\mathrm{SEX},c} \\approx 0$，以模拟电子添加时交换的变化主要由占据部分主导。\n   - 对于状态 $n \\in \\{v,c\\}$ 的库仑空穴（COH）：\n     $$\\Sigma_{\\mathrm{COH},n} = \\frac{1}{2} \\int \\frac{d^{3}G}{(2\\pi)^{3}} \\, \\big[ W(G,0) - v(G) \\big] \\, |\\rho_{n}(G)|^{2}.$$\n   此处，$|\\rho_{n}(G)|^{2}$ 是状态 $n$ 在倒易空间中对角密度形状因子的平方。\n\n2) 使用与等离激元-极点模型的静态极限一致的类Thomas–Fermi屏蔽来对静态 $W(G,0)$ 进行建模：\n   $$W(G,0) = \\frac{v(G)}{\\epsilon(G,0)}, \\quad \\epsilon(G,0) = 1 + \\frac{k_{\\mathrm{s}}(N_{\\mathrm{emp}})^{2}}{G^{2}}, \\quad v(G)=\\frac{4\\pi}{G^{2}}.$$\n\n3) 将 $k_{\\mathrm{s}}(N_{\\mathrm{emp}})$ 建模为一个单调饱和函数，以反映随着包含更多空态，RPA屏蔽的收敛情况：\n   $$k_{\\mathrm{s}}(N_{\\mathrm{emp}}) = k_{\\mathrm{s}}^{(\\infty)} \\left( 1 - e^{-N_{\\mathrm{emp}}/N_{0}}\\right),$$\n   其中 $k_{\\mathrm{s}}^{(\\infty)}$ 和 $N_{0}$ 是正常数。\n\n4) 将 $|\\rho_{n}(G)|^{2}$ 建模为球形平均的高斯形状因子，其随 $G$ 的衰减速率由一个依赖于状态的参数 $\\gamma_{n}$ 决定：\n   $$|\\rho_{n}(G)|^{2} = \\exp\\left( - \\left(\\frac{G}{\\gamma_{n}}\\right)^{2} \\right).$$\n   使用不同的 $\\gamma_{v}$ 和 $\\gamma_{c}$ 来表示价态和导态不同的实空间局域化。\n\n5) 通过在幅度 $G_{j} = j\\,\\Delta G$（对于整数 $j \\ge 1$ 直至 $G_{\\max}$）的均匀网格上使用球壳积分法来近似倒易空间中的积分，径向壳层权重为\n   $$w(G_{j}) = \\frac{4\\pi\\, G_{j}^{2}\\, \\Delta G}{(2\\pi)^{3}}.$$\n\n6) 使用单一的全局缩放因子 $S_{0}$ 来考虑被忽略的晶体局域场效应和各向异性，并将其乘法应用于 $\\Sigma_{\\mathrm{SEX}}$ 和 $\\Sigma_{\\mathrm{COH}}$。这保持了定性物理，并产生在物理合理范围内的能量。\n\n使用以上模型，准粒子带隙（单位为电子伏特）定义为\n$$E_{g}^{\\mathrm{QP}} = E_{g}^{\\mathrm{KS}} + \\Delta E_{g}^{\\mathrm{GW}}, \\quad \\Delta E_{g}^{\\mathrm{GW}} = \\left[\\Sigma_{\\mathrm{COH},c} - \\Sigma_{\\mathrm{COH},v}\\right] - \\Sigma_{\\mathrm{SEX},v},$$\n其中所有自能项均以Hartree为单位计算，然后转换为电子伏特。Kohn–Sham带隙固定为\n$$E_{g}^{\\mathrm{KS}} = 0.600 \\;\\text{eV}.$$\n\n您的程序中要使用的常量和参数值：\n\n- 原子单位换算：$1$ Hartree $= 27.211386245988$ 电子伏特。\n- 屏蔽参数：$k_{\\mathrm{s}}^{(\\infty)} = 1.000$ (单位 Bohr$^{-1}$)，$N_{0} = 50.0$。\n- 形状因子参数：$\\gamma_{v} = 1.000$ (单位 Bohr$^{-1}$)，$\\gamma_{c} = 0.700$ (单位 Bohr$^{-1}$)。\n- 径向格点步长：$\\Delta G = 0.300$ (单位 Bohr$^{-1}$)。\n- 全局缩放因子：$S_{0} = 0.500$ (无量纲)。\n- 介电截断的动能关系：给定 $E_{\\mathrm{cut}}$（单位为电子伏特），转换为Hartree单位 $E_{\\mathrm{cut}}^{\\mathrm{Ha}} = \\dfrac{E_{\\mathrm{cut}}}{27.211386245988}$，然后设置 $G_{\\max} = \\sqrt{2 E_{\\mathrm{cut}}^{\\mathrm{Ha}}}$，并包含所有满足 $G_{j} \\le G_{\\max}$ 的 $G_{j}$。\n\n必需的计算：\n\n- 对于每个测试用例 $(N_{\\mathrm{emp}}, E_{\\mathrm{cut}})$，使用上述模型计算 $E_{g}^{\\mathrm{QP}}$（单位为电子伏特）。将每个 $E_{g}^{\\mathrm{QP}}$ 表示为四舍五入到三位小数的电子伏特值。\n- 为评估收敛性，使用相同的模型和参数，在 $N_{\\mathrm{emp}}^{\\mathrm{ref}} = 800$ 和 $E_{\\mathrm{cut}}^{\\mathrm{ref}} = 400.0$ 电子伏特下内部计算一个参考准粒子带隙 $E_{g}^{\\mathrm{QP,ref}}$。对于每个测试用例，还需计算绝对偏差 $|E_{g}^{\\mathrm{QP}} - E_{g}^{\\mathrm{QP,ref}}|$（单位为电子伏特），四舍五入到三位小数。\n\n测试套件：\n\n- 使用以下有序的参数对列表 $(N_{\\mathrm{emp}}, E_{\\mathrm{cut}})$：\n  - $(20, 10.0)$\n  - $(200, 100.0)$\n  - $(50, 40.0)$\n  - $(5, 5.0)$\n  - $(500, 200.0)$\n\n角度单位不适用。所有能量必须以电子伏特报告。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。该列表必须包含恰好 $2T$ 个四舍五入到三位小数的浮点数，其中 $T$ 是测试用例的数量。前 $T$ 个条目是按指定顺序为测试用例计算的准粒子带隙 $E_{g}^{\\mathrm{QP}}$。接下来的 $T$ 个条目是按相同顺序对应的与内部参考 $E_{g}^{\\mathrm{QP,ref}}$ 的绝对偏差。例如，一个有 $T=3$ 的输出将看起来像 $[x_{1},x_{2},x_{3},d_{1},d_{2},d_{3}]$，其中每个 $x_{i}$ 和 $d_{i}$ 都是四舍五入到三位小数的浮点数。\n\n您提交的解决方案必须是一个完整的、可运行的程序，该程序执行上述计算，而无需用户输入或外部文件。", "solution": "问题陈述已经过验证。\n\n第1步：提取的已知条件\n- **准粒子能量：** $E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{KS}} + \\langle \\phi_{n} | \\Sigma(E_{n}^{\\mathrm{KS}}) - V_{\\mathrm{xc}} | \\phi_{n} \\rangle$。\n- **裸库仑势：** $v(G) = \\dfrac{4\\pi}{G^{2}}$ (原子单位)。\n- **自能分解 (静态COHSEX)：**\n    - $\\Sigma_{\\mathrm{SEX},v} = - \\int \\frac{d^{3}G}{(2\\pi)^{3}} \\, W(G,0)\\, |\\rho_{v}(G)|^{2}$。\n    - $\\Sigma_{\\mathrm{SEX},c} \\approx 0$。\n    - $\\Sigma_{\\mathrm{COH},n} = \\frac{1}{2} \\int \\frac{d^{3}G}{(2\\pi)^{3}} \\, \\big[ W(G,0) - v(G) \\big] \\, |\\rho_{n}(G)|^{2}$ 对于 $n \\in \\{v,c\\}$。\n- **静态屏蔽相互作用：** $W(G,0) = \\frac{v(G)}{\\epsilon(G,0)}$，其中 $\\epsilon(G,0) = 1 + \\frac{k_{\\mathrm{s}}(N_{\\mathrm{emp}})^{2}}{G^{2}}$。\n- **屏蔽波矢模型：** $k_{\\mathrm{s}}(N_{\\mathrm{emp}}) = k_{\\mathrm{s}}^{(\\infty)} \\left( 1 - e^{-N_{\\mathrm{emp}}/N_{0}}\\right)$。\n- **形状因子模型：** $|\\rho_{n}(G)|^{2} = \\exp\\left( - \\left(\\frac{G}{\\gamma_{n}}\\right)^{2} \\right)$。\n- **数值积分：** 球壳积分法，网格为 $G_{j} = j\\,\\Delta G$，权重为 $w(G_{j}) = \\frac{4\\pi\\, G_{j}^{2}\\, \\Delta G}{(2\\pi)^{3}}$。\n- **全局缩放：** 一个因子 $S_{0}$ 应用于所有自能项。\n- **准粒子带隙：** $E_{g}^{\\mathrm{QP}} = E_{g}^{\\mathrm{KS}} + \\Delta E_{g}^{\\mathrm{GW}}$，其中 $\\Delta E_{g}^{\\mathrm{GW}} = \\left[\\Sigma_{\\mathrm{COH},c} - \\Sigma_{\\mathrm{COH},v}\\right] - \\Sigma_{\\mathrm{SEX},v}$。\n- **常量与参数：**\n    - Hartree到eV转换：$1$ Hartree $= 27.211386245988$ eV。\n    - $E_{g}^{\\mathrm{KS}} = 0.600$ eV。\n    - $k_{\\mathrm{s}}^{(\\infty)} = 1.000$ Bohr$^{-1}$。\n    - $N_{0} = 50.0$。\n    - $\\gamma_{v} = 1.000$ Bohr$^{-1}$。\n    - $\\gamma_{c} = 0.700$ Bohr$^{-1}$。\n    - $\\Delta G = 0.300$ Bohr$^{-1}$。\n    - $S_{0} = 0.500$。\n- **截断：** $G_{\\max} = \\sqrt{2 E_{\\mathrm{cut}}^{\\mathrm{Ha}}}$，其中 $E_{\\mathrm{cut}}^{\\mathrm{Ha}} = E_{\\mathrm{cut}} / 27.211386245988$。求和包含所有 $G_{j} \\le G_{\\max}$。\n- **任务：** 对给定的测试用例，计算 $E_{g}^{\\mathrm{QP}}$ 和 $|E_{g}^{\\mathrm{QP}} - E_{g}^{\\mathrm{QP,ref}}|$，其中参考值在 $N_{\\mathrm{emp}}^{\\mathrm{ref}} = 800$, $E_{\\mathrm{cut}}^{\\mathrm{ref}} = 400.0$ eV 下计算。\n\n第2步：验证\n该问题具有科学依据，它基于完善的$G_{0}W_{0}$近似及其标准简化——静态COHSEX模型。用于屏蔽和形状因子的物理模型是简化的，但在教学或高通量计算环境中是合理且常见的。该问题是良构的：所有方程、参数和数值步骤都明确定义，确保存在唯一且有意义的解。它是客观的，不含非科学论断。没有矛盾或信息缺失。所有指定条件在物理上和计算上都是可行的。该问题是计算凝聚态物理学中一个标准的、尽管是简化的练习。\n\n第3步：结论\n问题有效。将提供解决方案。\n\n目标是使用简化的 $G_0W_0$ 模型计算准粒子带隙 $E_g^{\\mathrm{QP}}$。起点是Kohn-Sham带隙 $E_g^{\\mathrm{KS}}$，通过导带底（c）和价带顶（v）的自能项差异进行修正：\n$$E_{g}^{\\mathrm{QP}} = E_{g}^{\\mathrm{KS}} + \\left[ E_{c}^{\\mathrm{QP}} - E_{v}^{\\mathrm{QP}} \\right] - \\left[ E_{c}^{\\mathrm{KS}} - E_{v}^{\\mathrm{KS}} \\right] = E_{g}^{\\mathrm{KS}} + \\Delta E_g^{\\mathrm{GW}}$$\n对于一个状态 $n$ 的准粒子修正为 $\\Delta_n = \\Sigma_n - V_{\\mathrm{xc},n}$。带隙修正为 $\\Delta E_g^{\\mathrm{GW}} = \\Delta_c - \\Delta_v$。在静态COHSEX近似中，自能 $\\Sigma_n$ 被分解为屏蔽交换部分 $\\Sigma_{\\mathrm{SEX},n}$ 和库仑空穴部分 $\\Sigma_{\\mathrm{COH},n}$。问题指定 $\\Sigma_{\\mathrm{SEX},c} \\approx 0$。因此，总带隙修正变为：\n$$\\Delta E_g^{\\mathrm{GW}} = (\\Sigma_{\\mathrm{COH},c} - V_{\\mathrm{xc},c}) - (\\Sigma_{\\mathrm{COH},v} - V_{\\mathrm{xc},v}) - (\\Sigma_{\\mathrm{SEX},v} - V_{\\mathrm{xc},v})$$\n假设 $V_{\\mathrm{xc},c} \\approx V_{\\mathrm{xc},v}$（一种常见的简化），我们得到所提供的表达式：\n$$\\Delta E_g^{\\mathrm{GW}} = \\Sigma_{\\mathrm{COH},c} - \\Sigma_{\\mathrm{COH},v} - \\Sigma_{\\mathrm{SEX},v}$$\n所有自能项将以Hartree单位计算，并且必须包含全局缩放因子 $S_0$。\n\n首先，我们推导被积函数的解析表达式。静态屏蔽势 $W(G,0)$ 为：\n$$W(G,0) = \\frac{v(G)}{\\epsilon(G,0)} = \\frac{4\\pi/G^2}{1 + (k_s/G)^2} = \\frac{4\\pi}{G^2 + k_s^2}$$\n其中 $k_s$ 是 $k_{\\mathrm{s}}(N_{\\mathrm{emp}})$ 的简写。出现在COH表达式中的差项是：\n$$W(G,0) - v(G) = \\frac{4\\pi}{G^2 + k_s^2} - \\frac{4\\pi}{G^2} = 4\\pi \\frac{G^2 - (G^2 + k_s^2)}{G^2(G^2+k_s^2)} = -\\frac{4\\pi k_s^2}{G^2(G^2+k_s^2)}$$\n\n倒易空间上的积分 $\\int \\frac{d^3 G}{(2\\pi)^3} f(G)$ 通过对球壳的求和来近似：\n$$\\int \\frac{d^3 G}{(2\\pi)^3} f(G) \\approx \\sum_{j=1}^{J_{\\max}} w(G_j) f(G_j) = \\sum_{j=1}^{J_{\\max}} \\frac{4\\pi G_j^2 \\Delta G}{(2\\pi)^3} f(G_j) = \\frac{\\Delta G}{2\\pi^2} \\sum_{j=1}^{J_{\\max}} G_j^2 f(G_j)$$\n其中 $G_j = j \\Delta G$ 且 $J_{\\max} = \\lfloor G_{\\max} / \\Delta G \\rfloor$。\n\n使用这种积分法，我们表达自能分量：\n对于价态的屏蔽交换：\n$$\\Sigma_{\\mathrm{SEX},v} = -S_0 \\frac{\\Delta G}{2\\pi^2} \\sum_{j=1}^{J_{\\max}} G_j^2 \\left( \\frac{4\\pi}{G_j^2 + k_s^2} \\right) \\exp\\left(-\\frac{G_j^2}{\\gamma_v^2}\\right) = -S_0 \\frac{2\\Delta G}{\\pi} \\sum_{j=1}^{J_{\\max}} \\frac{G_j^2}{G_j^2 + k_s^2} \\exp\\left(-\\frac{G_j^2}{\\gamma_v^2}\\right)$$\n对于状态 $n \\in \\{v,c\\}$ 的库仑空穴：\n$$\\Sigma_{\\mathrm{COH},n} = \\frac{S_0}{2} \\frac{\\Delta G}{2\\pi^2} \\sum_{j=1}^{J_{\\max}} G_j^2 \\left( -\\frac{4\\pi k_s^2}{G_j^2(G_j^2+k_s^2)} \\right) \\exp\\left(-\\frac{G_j^2}{\\gamma_n^2}\\right) = -S_0 \\frac{\\Delta G k_s^2}{\\pi} \\sum_{j=1}^{J_{\\max}} \\frac{1}{G_j^2 + k_s^2} \\exp\\left(-\\frac{G_j^2}{\\gamma_n^2}\\right)$$\n将这些项组合起来得到以Hartree为单位的总带隙修正：\n$$\\Delta E_g^{\\mathrm{GW}} = \\Sigma_{\\mathrm{COH},c} - \\Sigma_{\\mathrm{COH},v} - \\Sigma_{\\mathrm{SEX},v}$$\n$$\\Delta E_g^{\\mathrm{GW}} = \\frac{S_0 \\Delta G}{\\pi} \\sum_{j=1}^{J_{\\max}} \\left[ -k_s^2 \\frac{\\exp(-G_j^2/\\gamma_c^2)}{G_j^2+k_s^2} + k_s^2 \\frac{\\exp(-G_j^2/\\gamma_v^2)}{G_j^2+k_s^2} + 2 \\frac{G_j^2 \\exp(-G_j^2/\\gamma_v^2)}{G_j^2+k_s^2} \\right]$$\n对这些项进行因式分解，得到用于实现的最终表达式：\n$$\\Delta E_g^{\\mathrm{GW}} = \\frac{S_0 \\Delta G}{\\pi} \\sum_{j=1}^{J_{\\max}} \\frac{(2G_j^2 + k_s^2)\\exp(-G_j^2/\\gamma_v^2) - k_s^2 \\exp(-G_j^2/\\gamma_c^2)}{G_j^2 + k_s^2}$$\n\n计算步骤如下：\n1.  对于每对 $(N_{\\mathrm{emp}}, E_{\\mathrm{cut}})$，计算派生参数：$k_s = k_{\\mathrm{s}}(N_{\\mathrm{emp}})$ 和 $G_{\\max} = \\sqrt{2 E_{\\mathrm{cut}} / 27.211...}$，这决定了 $J_{\\max}$。\n2.  从 $1$ 到 $J_{\\max}$ 迭代 $j$，为每个 $G_j = j \\Delta G$ 计算被加数，并累加求和。\n3.  将和乘以预因子 $\\frac{S_0 \\Delta G}{\\pi}$ 以获得 $\\Delta E_g^{\\mathrm{GW}}$（单位为Hartree）。\n4.  将修正转换为电子伏特：$\\Delta E_g^{\\mathrm{GW}} [\\text{eV}] = \\Delta E_g^{\\mathrm{GW}} [\\text{Ha}] \\times 27.211386245988$。\n5.  计算最终的准粒子带隙：$E_g^{\\mathrm{QP}}[\\text{eV}] = E_g^{\\mathrm{KS}}[\\text{eV}] + \\Delta E_g^{\\mathrm{GW}}[\\text{eV}]$。\n此过程首先应用于参考参数（$N_{\\mathrm{emp}}^{\\mathrm{ref}} = 800$，$E_{\\mathrm{cut}}^{\\mathrm{ref}} = 400.0$ eV）以找到 $E_{g}^{\\mathrm{QP,ref}}$，然后应用于每个测试用例以找到 $E_{g}^{\\mathrm{QP}}$ 和偏差 $|E_{g}^{\\mathrm{QP}} - E_{g}^{\\mathrm{QP,ref}}|$。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the quasiparticle band gap problem as described.\n    \"\"\"\n\n    # --- Constants and Parameter Definitions ---\n    HARTREE_TO_EV = 27.211386245988\n    E_G_KS_EV = 0.600\n    KS_INF = 1.000\n    N0 = 50.0\n    GAMMA_V = 1.000\n    GAMMA_C = 0.700\n    DELTA_G = 0.300\n    S0 = 0.500\n\n    def compute_qp_gap(n_emp, e_cut):\n        \"\"\"\n        Computes the quasiparticle gap for a given N_emp and E_cut.\n\n        Args:\n            n_emp (int): Number of empty bands.\n            e_cut (float): Dielectric cutoff energy in eV.\n\n        Returns:\n            float: Quasiparticle band gap in eV.\n        \"\"\"\n        # 1. Calculate derived parameters\n        k_s = KS_INF * (1.0 - np.exp(-n_emp / N0))\n        e_cut_ha = e_cut / HARTREE_TO_EV\n        g_max = np.sqrt(2.0 * e_cut_ha)\n        \n        # Determine the maximum integer j for the summation\n        if g_max  DELTA_G:\n            j_max = 0\n        else:\n            j_max = math.floor(g_max / DELTA_G)\n\n        # 2. Perform the summation\n        total_sum = 0.0\n        k_s_sq = k_s**2\n        gamma_v_sq = GAMMA_V**2\n        gamma_c_sq = GAMMA_C**2\n\n        for j in range(1, j_max + 1):\n            g_j = j * DELTA_G\n            g_j_sq = g_j**2\n\n            # Numerator terms\n            term_v = (2.0 * g_j_sq + k_s_sq) * np.exp(-g_j_sq / gamma_v_sq)\n            term_c = k_s_sq * np.exp(-g_j_sq / gamma_c_sq)\n            \n            # Denominator\n            denominator = g_j_sq + k_s_sq\n            \n            summand = (term_v - term_c) / denominator\n            total_sum += summand\n\n        # 3. Calculate the gap correction\n        # The equation for delta_e_g_gw is in Hartrees\n        delta_e_g_gw_ha = (S0 * DELTA_G / np.pi) * total_sum\n        \n        # 4. Convert to eV and add to KS gap\n        delta_e_g_gw_ev = delta_e_g_gw_ha * HARTREE_TO_EV\n        e_g_qp_ev = E_G_KS_EV + delta_e_g_gw_ev\n\n        return e_g_qp_ev\n\n    # --- Main Calculation ---\n    \n    # Test cases as provided in the problem\n    test_cases = [\n        (20, 10.0),\n        (200, 100.0),\n        (50, 40.0),\n        (5, 5.0),\n        (500, 200.0)\n    ]\n    \n    # Reference calculation parameters\n    n_emp_ref = 800\n    e_cut_ref = 400.0\n\n    # Compute reference gap\n    e_g_qp_ref = compute_qp_gap(n_emp_ref, e_cut_ref)\n    \n    qp_gaps = []\n    deviations = []\n    \n    # Process each test case\n    for n_emp, e_cut in test_cases:\n        e_g_qp = compute_qp_gap(n_emp, e_cut)\n        deviation = abs(e_g_qp - e_g_qp_ref)\n        qp_gaps.append(e_g_qp)\n        deviations.append(deviation)\n\n    # Combine results and format for output\n    all_results = qp_gaps + deviations\n    results_str = [f\"{val:.3f}\" for val in all_results]\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n\n```", "id": "2930201"}]}