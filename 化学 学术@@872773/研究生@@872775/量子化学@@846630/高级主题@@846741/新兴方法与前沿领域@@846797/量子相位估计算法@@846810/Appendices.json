{"hands_on_practices": [{"introduction": "量子相位估计算法 (QPE) 并不直接测量能量 $E$，而是测量一个对应的相位 $\\phi$。本练习将演示任何 QPE 实验中关键的最后一步：如何将原始相位数据转化为具有物理意义的能量值。这个过程包括处理相位固有的周期性模糊（即“相位回卷”问题），并最终量化能量估算的不确定性 [@problem_id:2931366]。", "problem": "在一个以分子玻恩–奥本海默哈密顿量的电子本征态为目标的量子相位估计算法 (QPE) 实验中，系统根据该哈密顿量生成的时间演化算符进行演化。在原子单位制下进行计算，其中约化普朗克常数满足 $\\hbar = 1$。时间 $t$ 的幺正时间演化算符为 $U(t) = \\exp(- i H t / \\hbar)$。对于哈密顿量本征值为 $E$ 的本征态 $|\\psi\\rangle$，该态 $|\\psi\\rangle$ 是 $U(t)$ 的一个本征态，其本征值的模为 1。量子相位估计算法返回一个相位 $\\phi \\in [0,1)$，使得测得的 $U(t)$ 本征值为 $e^{2 \\pi i \\phi}$。\n\n你使用一个已知的相干演化时间 $t$ 来实现 QPE，并获得一个在单位圆上近似呈正态分布的相位测量值，其均值为 $\\phi$，环形标准差为 $\\sigma_{\\phi}$。你还有一个关于目标电子态的可信先验能谱窗口（相对于一个固定的参考能量），该窗口确保能量位于一个特定区间内。\n\n仅从上述物理定义和事实出发，推导从测得的相位 $\\phi$（及其 $2 \\pi$ 周期性）到物理能量 $E$ 的映射关系，并明确处理由 $2 \\pi$ 周期性引起的整数模糊性（相位卷绕）。然后，对适当展开的相位应用线性误差传播，以获得相应的不确定度 $\\sigma_{E}$。\n\n使用以下具体数据得出数值结果：\n- 相干演化时间 $t = 20$（原子时间单位）。\n- 测得的相位均值 $\\phi = 0.98$（无量纲）。\n- 相位标准差 $\\sigma_{\\phi} = 0.03$（无量纲）。\n- 目标态的先验能谱窗口：$E \\in [-0.2, 0.2]$ Hartree。\n\n计算能量 $E$ 及其不确定度 $\\sigma_{E}$（单位为 Hartree），并正确处理相位卷绕问题，将 $E$ 和 $\\sigma_{E}$ 均四舍五入至四位有效数字。以 Hartree (Ha) 为单位表示最终的能量和不确定度。最终答案必须是数对 $(E, \\sigma_{E})$。", "solution": "所提出的问题在科学上是合理的、定义明确的，并包含了唯一解所需的所有信息。因此，我们将着手进行推导和计算。\n\n分析始于量子力学的基本原理。对于不含时的哈密顿量 $H$，时间演化算符由 $U(t) = \\exp(-iHt/\\hbar)$ 给出。对于满足 $H|\\psi\\rangle = E|\\psi\\rangle$ 的哈密顿量本征态 $|\\psi\\rangle$，演化算符的作用是 $U(t)|\\psi\\rangle = \\exp(-iEt/\\hbar)|\\psi\\rangle$。在原子单位制下，约化普朗克常数 $\\hbar = 1$，因此 $U(t)$ 的本征值为 $\\exp(-iEt)$。\n\n量子相位估计算法 (QPE) 测量这个本征值，并将其表示为 $e^{2\\pi i \\phi}$ 的形式，其中 $\\phi \\in [0, 1)$ 是估算的相位。通过令两个本征值的表达式相等，我们建立了核心关系：\n$e^{2 \\pi i \\phi} = \\exp(-iEt)$\n这两个复数相等意味着它们的辐角主值必须相差 $2\\pi$ 的整数倍。因此，\n$2 \\pi \\phi = -Et + 2 \\pi k$\n其中 $k$ 是一个任意整数。这个整数 $k$ 源于复指数函数的周期性，代表了所谓的“相位卷绕”模糊性。求解能量 $E$，可以得到从测得的相位 $\\phi$ 到物理能量的映射关系：\n$E(\\phi, k) = \\frac{2\\pi}{t}(k - \\phi)$\n这个方程表明，单个测得的相位 $\\phi$ 对应于一组可能的能量，由整数 $k$ 索引。为了解决这个模糊性并确定 $k$ 的正确值，我们必须使用已知的先验信息，即能量位于特定的能谱窗口 $E \\in [-0.2, 0.2]$ Hartree 内。\n\n我们已知以下数据：\n- 相干演化时间：$t = 20$ 原子单位。\n- 测得的相位均值：$\\phi = 0.98$。\n- 先验能量窗口：$E \\in [-0.2, 0.2]$ Hartree。\n\n将 $t$ 和 $\\phi$ 的值代入能量表达式中，得到：\n$E(k) = \\frac{2\\pi}{20}(k - 0.98) = \\frac{\\pi}{10}(k - 0.98)$\n现在我们施加来自能谱窗口的约束条件：\n$-0.2 \\le E(k) \\le 0.2$\n$-0.2 \\le \\frac{\\pi}{10}(k - 0.98) \\le 0.2$\n为了找到整数 $k$ 的有效范围，我们解这个不等式：\n$-\\frac{2}{\\pi} \\le k - 0.98 \\le \\frac{2}{\\pi}$\n$0.98 - \\frac{2}{\\pi} \\le k \\le 0.98 + \\frac{2}{\\pi}$\n使用近似值 $\\pi \\approx 3.14159$，我们得到 $2/\\pi \\approx 0.63662$。关于 $k$ 的不等式变为：\n$0.34338 \\le k \\le 1.61662$\n满足这个条件的唯一整数值是 $k=1$。因此，模糊性得以解决。\n\n在唯一确定 $k=1$ 后，我们可以计算能量 $E$：\n$E = \\frac{\\pi}{10}(1 - 0.98) = \\frac{\\pi}{10}(0.02) = 0.002\\pi$\n数值上，这等于 $E \\approx 0.006283185...$ Hartree。\n\n接下来，我们根据测得相位的不确定度 $\\sigma_\\phi = 0.03$ 来确定能量的不确定度 $\\sigma_E$。我们将线性误差传播公式应用于展开后的能量表达式 $E(\\phi) = \\frac{2\\pi}{t}(k-\\phi)$。由于 $\\phi$ 的不确定度很小，确定的 $k=1$ 值在相关相位值范围内保持不变，因此我们可以将 $k$ 和 $t$ 视为常数。$E$ 的不确定度由以下公式给出：\n$\\sigma_E = \\left| \\frac{\\partial E}{\\partial \\phi} \\right| \\sigma_\\phi$\n所需的偏导数为：\n$\\frac{\\partial E}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left[ \\frac{2\\pi}{t}(k - \\phi) \\right] = -\\frac{2\\pi}{t}$\n因此，能量的不确定度为：\n$\\sigma_E = \\left| -\\frac{2\\pi}{t} \\right| \\sigma_\\phi = \\frac{2\\pi}{t} \\sigma_\\phi$\n代入给定值 $t=20$ 和 $\\sigma_\\phi=0.03$：\n$\\sigma_E = \\frac{2\\pi}{20} (0.03) = \\frac{\\pi}{10} (0.03) = 0.003\\pi$\n数值上，这等于 $\\sigma_E \\approx 0.009424778...$ Hartree。\n\n题目要求将 $E$ 和 $\\sigma_E$ 均四舍五入至四位有效数字。\n- $E \\approx 0.006283185... \\rightarrow E = 0.006283$ Hartree。\n- $\\sigma_E \\approx 0.009424778... \\rightarrow \\sigma_E = 0.009425$ Hartree。\n\n最终计算出的能量及其不确定度为 $(E, \\sigma_E) = (0.006283, 0.009425)$ Hartree。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.006283  0.009425 \\end{pmatrix}}\n$$", "id": "2931366"}, {"introduction": "在学会解读实验结果之后，我们转向如何设计实验。为了获得高精度的能量估算，必须投入足够的量子资源。本练习将引导你完成资源估算的核心过程，展示如何确定达到目标化学精度所需的量子比特数和总演化时间 [@problem_id:2931361]。", "problem": "考虑一个有限分子系统的电子结构哈密顿量 $H$，以原子单位（哈特里单位）书写，因此 $\\hbar = 1$，能量单位为哈特里，时间单位为哈特里的倒数。设 $H$ 的谱在区间 $[0, W]$ 内，已知界限为 $W = 10$ 哈特里。您在幺正算符 $U = \\exp(-i H t)$ 上实现标准的量子相位估计算法（QPE），使用一个 $n$ 量子比特的控制寄存器和常规的受控 $U$ 的幂次序列 $U^{2^{k}}$（其中 $k = 0, 1, \\dots, n-1$），然后进行逆量子傅里叶变换。为了在已知的能量窗口内避免相位回卷，您选择演化时间 $t = \\pi/W$。\n\n您的任务是估算一个能量本征值 $E$，目标绝对精度为 $\\varepsilon = 1$ mHa，其中 $1$ mHa $= 10^{-3}$ 哈特里。所有角度均使用弧度制。假设采用标准的、教科书式的QPE实现，并采纳常规的资源核算方法，其中：\n- 每次对 $U^{2^{k}}$ 的受控应用计为一次 controlled-$U^{(\\cdot)}$ 门的调用。\n- 总相干演化时间是所有受控演化持续时间的总和，即 $\\sum_{k=0}^{n-1} 2^{k} t$。\n\n仅从谱映射 $U \\lvert E \\rangle = \\exp(-i E t) \\lvert E \\rangle$ 和 $n$ 比特相位寄存器的量化出发，确定所需的最小整数 $n$，使得QPE读出造成的最坏情况能量误差不大于 $\\varepsilon$，然后计算：\n1) 总相干演化时间，以及\n2) controlled-$U^{(\\cdot)}$ 门的调用次数，\n以达到目标精度。将总相干演化时间以原子时间单位（哈特里$^{-1}$）表示。将两个所求数值四舍五入至四位有效数字。您的最终答案必须首先列出总相干演化时间，其次是 controlled-$U^{(\\cdot)}$ 门的调用次数。", "solution": "该问题陈述经核实具有科学依据，定义明确且客观。它提出了一个量子化学领域中量子算法资源估算的典型问题，为获得唯一解提供了所有必要的参数和定义。该问题没有矛盾、歧义和事实错误。\n\n核心任务是确定量子相位估计算法（QPE）为将哈密顿量本征值 $E$ 估算到指定精度 $\\varepsilon$ 所需的资源。\n\n首先，我们将哈密顿量 $H$ 的能量本征值 $E$ 与幺正算符 $U = \\exp(-i H t)$ 的本征值的相位联系起来。设 $\\lvert E \\rangle$ 是 $H$ 的一个本征态，其本征值为 $E$。那么，将 $U$ 作用于 $\\lvert E \\rangle$ 得到：\n$U \\lvert E \\rangle = \\exp(-i H t) \\lvert E \\rangle = \\exp(-i E t) \\lvert E \\rangle$\nQPE算法旨在估算本征值方程 $U \\lvert \\psi \\rangle = \\exp(i \\phi) \\lvert \\psi \\rangle$ 中的相位 $\\phi$。通过比较，对于本征态 $\\lvert E \\rangle$，其相位为 $\\phi = -E t$。\n\n问题陈述指出，$H$ 的谱位于区间 $[0, W]$ 内，其中 $W = 10$ 哈特里。演化时间被选为 $t = \\pi/W$。这个选择将能量范围 $[0, W]$ 映射到一个特定的相位范围。\n对于 $E=0$，相位为 $\\phi = -0 \\cdot t = 0$。\n对于 $E=W$，相位为 $\\phi = -W t = -W (\\pi/W) = -\\pi$。\n因此，对应于任何能量本征值 $E \\in [0, W]$ 的相位 $\\phi$ 位于区间 $[-\\pi, 0]$ 内。该区间的长度为 $\\pi$，小于 $2\\pi$，因此相位没有歧义（没有“相位回卷”）。\n\nQPE算法使用一个 $n$ 量子比特的寄存器来估算相位。该算法输出一个经典整数 $j \\in \\{0, 1, \\dots, 2^n - 1\\}$，通过关系式 $\\tilde{\\phi} = 2\\pi (j/2^n)$ 给出相位 $\\phi$ 的估算值。然而，我们的相位 $\\phi = -Et$ 是负的。QPE算法找到一个值 $\\theta$，使得本征值为 $\\exp(i 2\\pi \\theta)$。在我们的情况下，$2\\pi \\theta = -Et \\pmod{2\\pi}$。如前所述，相位在 $[-\\pi, 0]$ 区间内，所以对于 $E0$，我们有 $\\theta = (2\\pi - Et)/(2\\pi) = 1 - Et/(2\\pi)$。QPE的读出值 $j/2^n$ 是 $\\theta$ 的一个 $n$ 比特近似。\n\n对于量 $\\theta \\in [0, 1)$，一个 $n$ 比特寄存器的基本分辨率是 $1/2^n$。由于寄存器的量化，确定 $\\theta$ 的最坏情况误差是分辨率步长的一半，这发生在真实值恰好位于两个可表示点之间时。此误差为 $\\delta\\theta_{max} = \\frac{1}{2} \\cdot \\frac{1}{2^n} = \\frac{1}{2^{n+1}}$。\n相位 $\\phi=2\\pi\\theta$ 的误差相应地为 $\\delta\\phi_{max} = 2\\pi \\delta\\theta_{max} = 2\\pi \\frac{1}{2^{n+1}} = \\frac{\\pi}{2^n}$。\n\n从关系式 $\\phi = -E t$ 可知，能量误差 $\\delta E$ 与相位误差 $\\delta \\phi$ 的关系为 $|\\delta E| = |\\delta \\phi / t|$。因此，能量估算的最坏情况误差 $\\delta E_{max}$ 为：\n$ \\delta E_{max} = \\frac{\\delta\\phi_{max}}{t} $\n代入 $\\delta\\phi_{max} = \\pi/2^n$ 和 $t = \\pi/W$：\n$ \\delta E_{max} = \\frac{\\pi/2^n}{\\pi/W} = \\frac{W}{2^n} $\n给定目标精度为 $\\varepsilon = 1$ mHa $= 10^{-3}$ 哈特里。我们要求QPE读出的最坏情况误差不大于此精度：\n$ \\frac{W}{2^n} \\le \\varepsilon $\n这意味着：\n$ 2^n \\ge \\frac{W}{\\varepsilon} $\n代入给定值 $W=10$ 和 $\\varepsilon=10^{-3}$：\n$ 2^n \\ge \\frac{10}{10^{-3}} = 10^4 $\n为了找到最小整数 $n$，我们对两边取以2为底的对数：\n$ n \\ge \\log_2(10^4) = 4 \\log_2(10) $\n使用近似值 $\\log_2(10) \\approx 3.3219$：\n$ n \\ge 4 \\times 3.3219 = 13.2876 $\n由于 $n$ 必须是整数，控制寄存器所需的最小量子比特数为 $n = 14$。\n\n当 $n=14$ 时，我们现在可以计算所需的资源计数。\n\n1) 总相干演化时间：\n问题将其定义为 $T_{total} = \\sum_{k=0}^{n-1} 2^{k} t$。该和是一个几何级数：\n$ \\sum_{k=0}^{n-1} 2^{k} = \\frac{2^n - 1}{2-1} = 2^n - 1 $\n因此，$T_{total} = (2^n - 1)t$。\n当 $n=14$ 且 $t = \\pi/W = \\pi/10$ 时：\n$ T_{total} = (2^{14} - 1) \\frac{\\pi}{10} = (16384 - 1) \\frac{\\pi}{10} = \\frac{16383 \\pi}{10} $\n数值上，这是：\n$ T_{total} = 1638.3 \\times \\pi \\approx 5146.933 \\text{ Hartree}^{-1} $\n四舍五入到四位有效数字，总相干演化时间为 $5147$ 原子时间单位。\n\n2) controlled-$U^{(\\cdot)}$ 门的调用次数：\n问题陈述，每次对 $U^{2^k}$ 的受控应用计为一次调用。对于一个 $n$ 量子比特的寄存器，标准的QPE算法对寄存器中的每个量子比特都进行一次这样的应用，其中 $k = 0, 1, \\dots, n-1$。\n因此，总调用次数就是 $n$。\n当 $n=14$ 时，controlled-$U^{(\\cdot)}$ 门的调用次数为 $14$。问题要求将此数字四舍五入至四位有效数字，得到 $14.00$。\n\n最终结果是总相干演化时间为 $5147$ 哈特里$^{-1}$，controlled-$U^{(\\cdot)}$ 门的调用次数为 $14.00$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 5147  14.00 \\end{pmatrix}}\n$$", "id": "2931361"}, {"introduction": "我们的讨论从理想情况进入到嘈杂量子硬件的现实挑战。虽然在理论上更长的演化时间似乎能带来更高的精度，但退相干效应为此策略设定了基本限制。这个高级练习引入了一个简单的噪声模型，旨在探索这一关键权衡，并演示如何找到一个最优的实验方案，以平衡这些相互竞争的效应，从而在有限资源下获得最佳结果 [@problem_id:2931304]。", "problem": "在量子化学中，使用量子相位估计算法（QPE）估算分子基态能量的背景下，考虑一个由电子哈密顿量 $H$ 的受控时间演化幺正算符 $U(t) = \\exp(-\\mathrm{i} H t)$（其中 $\\hbar = 1$）构建的单辅助量子比特拉姆齐型原语。假设所制备的系统状态具有足够的基态交叠，以至于在理想、无噪声的极限情况下，可以实现基态能量 $E_{0}$ 的无偏估计。\n\n假设一个简单的马尔可夫纯退相干噪声模型，其退相干率为 $\\gamma$，它对辅助量子比特测量的干涉条纹的干涉可见度产生衰减，形式为 $V(t) = \\exp(-\\gamma t)$。在每次持续时间为 $t$ 的实验中，通过自适应相位控制，在 Bloch 球的 $x$–$y$ 赤道平面上的一组基中对辅助量子比特进行测量（例如，通过 $X$ 基和 $Y$ 基测量），以确保测量在局部最敏感的工作点进行。在这种自适应操作下，关于 $E_{0}$ 的单次测量经典费希尔信息等于 $V(t)^{2} t^{2}$。\n\n你有一个固定的总相干演化时间预算 $T_{\\mathrm{tot}}$，这意味着你可以进行 $M = T_{\\mathrm{tot}} / t$ 次持续时间为 $t$ 的独立实验。使用克拉默-拉奥下界（CRLB），该下界指出任何无偏估计量的方差至少为总费希尔信息的倒数，确定在此噪声模型和资源限制下，能最小化能量估计方差的 CRLB 的 $t$ 值。\n\n以 $\\gamma$ 的闭式解析表达式给出最终答案。时间以秒为单位表示。无需进行数值取整。", "solution": "目标是最小化基态能量 $E_0$ 的无偏估计量的方差。克拉默-拉奥下界 (CRLB) 确立了该方差 $\\mathrm{Var}(\\hat{E}_0)$ 的下界是总经典费希尔信息 $I_{\\mathrm{tot}}$ 的倒数。\n$\\mathrm{Var}(\\hat{E}_0) \\geq \\frac{1}{I_{\\mathrm{tot}}}$\n因此，最小化 CRLB 等价于最大化总费希尔信息 $I_{\\mathrm{tot}}$。\n\n总费希尔信息是所有 $M$ 次独立实验的累积信息。\n$I_{\\mathrm{tot}} = M \\cdot I_1(t)$\n实验次数 $M$ 由总时间预算 $T_{\\mathrm{tot}}$ 和每次实验的持续时间 $t$ 决定。\n$M = \\frac{T_{\\mathrm{tot}}}{t}$\n单次测量的费希尔信息 $I_1(t)$ 是干涉可见度 $V(t) = \\exp(-\\gamma t)$ 的函数。\n$I_1(t) = V(t)^{2} t^{2} = (\\exp(-\\gamma t))^{2} t^{2} = t^{2} \\exp(-2\\gamma t)$\n通过代入 $M$ 和 $I_1(t)$ 的表达式，总费希尔信息可以写成关于 $t$ 的函数。\n$I_{\\mathrm{tot}}(t) = \\left(\\frac{T_{\\mathrm{tot}}}{t}\\right) \\cdot \\left(t^{2} \\exp(-2\\gamma t)\\right) = T_{\\mathrm{tot}} \\cdot t \\cdot \\exp(-2\\gamma t)$\n为了确定最大化 $I_{\\mathrm{tot}}(t)$ 的最优实验持续时间 $t$，我们必须找到该函数的临界点。由于 $T_{\\mathrm{tot}}$ 是一个正常数，这等价于在 $t  0$ 的条件下最大化函数 $f(t) = t \\cdot \\exp(-2\\gamma t)$。\n\n我们使用乘法法则计算 $f(t)$ 对 $t$ 的一阶导数。\n$\\frac{df}{dt} = \\frac{d}{dt}\\left(t \\cdot \\exp(-2\\gamma t)\\right) = (1) \\cdot \\exp(-2\\gamma t) + t \\cdot (-2\\gamma \\exp(-2\\gamma t))$\n$\\frac{df}{dt} = \\exp(-2\\gamma t) \\cdot (1 - 2\\gamma t)$\n为了找到极值点，我们将导数设为零。\n$\\exp(-2\\gamma t) \\cdot (1 - 2\\gamma t) = 0$\n由于对于任何实数 $t$ 和正数 $\\gamma$，项 $\\exp(-2\\gamma t)$ 恒为正，所以该方程只有在第二个因子为零时才成立。\n$1 - 2\\gamma t = 0$\n解出 $t$ 得到临界点。\n$t = \\frac{1}{2\\gamma}$\n为了验证该临界点对应于一个最大值，我们采用二阶导数检验。我们将 $\\frac{df}{dt}$ 对 $t$ 求导。\n$\\frac{d^{2}f}{dt^{2}} = \\frac{d}{dt} \\left[ \\exp(-2\\gamma t) \\cdot (1 - 2\\gamma t) \\right]$\n$\\frac{d^{2}f}{dt^{2}} = (-2\\gamma \\exp(-2\\gamma t)) \\cdot (1 - 2\\gamma t) + \\exp(-2\\gamma t) \\cdot (-2\\gamma)$\n$\\frac{d^{2}f}{dt^{2}} = -2\\gamma \\exp(-2\\gamma t) [(1 - 2\\gamma t) + 1] = -2\\gamma \\exp(-2\\gamma t) (2 - 2\\gamma t)$\n在临界点 $t = \\frac{1}{2\\gamma}$ 处计算二阶导数：\n$\\left. \\frac{d^{2}f}{dt^{2}} \\right|_{t = \\frac{1}{2\\gamma}} = -2\\gamma \\exp\\left(-2\\gamma \\cdot \\frac{1}{2\\gamma}\\right) \\cdot \\left(2 - 2\\gamma \\cdot \\frac{1}{2\\gamma}\\right)$\n$= -2\\gamma \\exp(-1) \\cdot (2 - 1) = -2\\gamma \\exp(-1) = -\\frac{2\\gamma}{e}$\n退相干率 $\\gamma$ 是一个正的物理量（$\\gamma  0$），因此二阶导数为负。这证实了 $t = \\frac{1}{2\\gamma}$ 使总费希尔信息最大化，从而最小化了 CRLB。$t$ 的时间单位由 $\\gamma$ 的单位决定；如果 $\\gamma$ 的单位是 $\\mathrm{s}^{-1}$，那么 $t$ 的单位是秒。", "answer": "$$\n\\boxed{\\frac{1}{2\\gamma}}\n$$", "id": "2931304"}]}