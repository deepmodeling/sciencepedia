## 引言
在[量子化学](@entry_id:140193)中，精确描述包含多个原子的分子的[电子结构](@entry_id:145158)是核心挑战之一。传统的高精度方法，如[全组态相互作用](@entry_id:172539)（FCI），虽然理论上精确，但其计算成本随系统尺寸呈[指数增长](@entry_id:141869)，遭遇了所谓的“指数墙”，使其仅适用于非常小的体系。特别是对于存在强静态相关的系统，如过渡金属[配合物](@entry_id:156661)、共轭分子或[化学反应](@entry_id:146973)过渡态，单参考方法失效，亟需一种既能准确捕捉复杂电子关联又能保持计算可行性的新[范式](@entry_id:161181)。

近年来，源于凝聚态物理的[张量网络态](@entry_id:139950)（Tensor Network States, TNS）方法，尤其是其一维形式——[矩阵乘积态](@entry_id:143296)（Matrix Product State, MPS），为解决这一难题提供了强有力的理论与计算框架。它通过一种精巧的方式重构量子[多体波函数](@entry_id:203043)，将关注点从庞大的希尔伯特空间转移到对系统内部纠缠结构的物理洞察上，成功地将指数级的复杂度降低到多项式级。

本文旨在为[量子化学](@entry_id:140193)领域的研究生和学者提供一份关于[张量网络态](@entry_id:139950)的全面指南。在第一章**“原理与机制”**中，我们将深入探讨MPS的数学构造、其与纠缠“[面积定律](@entry_id:145931)”的内在联系，并详细拆解其核心[优化算法](@entry_id:147840)——[密度矩阵重整化群](@entry_id:137826)（DMRG）。第二章**“应用与跨学科连接”**将展示该方法在解决实际化学问题中的威力，包括高精度[基态](@entry_id:150928)与[激发态计算](@entry_id:749156)、与传统[量子化学](@entry_id:140193)方法的融合，以及在[量子动力学](@entry_id:138183)和[统计力](@entry_id:194984)学中的应用。最后，在第三章**“动手实践”**中，我们通过一系列精心设计的问题，引导读者将理论知识应用于具体计算挑战，深化对算法细节和数据分析的理解。通过这三个章节的学习，读者将建立起对[张量网络态方法](@entry_id:141496)的坚实理解，并掌握将其应用于前沿[量子化学](@entry_id:140193)研究的关键技能。

## 原理与机制

本章旨在深入阐释[张量网络态](@entry_id:139950)（尤其是[矩阵乘积态](@entry_id:143296)）在[量子化学](@entry_id:140193)领域应用的核心原理与关键机制。我们将从量子[多体波函数](@entry_id:203043)的表示法出发，揭示[矩阵乘积态](@entry_id:143296)如何有效压缩希尔伯特空间；随后，我们将探讨纠缠结构与“[面积定律](@entry_id:145931)”如何决定了此方法的[适用范围](@entry_id:636189)与效率；接着，我们将详细剖析作为其核心优化算法的[密度矩阵重整化群](@entry_id:137826)（DMRG）的变分过程；最后，我们将讨论保证[算法稳定性](@entry_id:147637)与效率的若干高级主题，包括规范自由度、[数值稳定性](@entry_id:146550)以及对称性的利用。

### [量子化学](@entry_id:140193)中的[矩阵乘积态](@entry_id:143296)表示

#### 从[波函数](@entry_id:147440)到[张量网络](@entry_id:142149)

一个包含 $L$ 个[轨道](@entry_id:137151)（或格点）的[量子多体系统](@entry_id:141221)的[波函数](@entry_id:147440) $|\Psi\rangle$ 可以在一组占据数构型基 $\{|i_1 i_2 \dots i_L\rangle\}$ 上展开，其形式如下：

$$
|\Psi\rangle = \sum_{i_1, i_2, \dots, i_L} C_{i_1 i_2 \dots i_L} |i_1 i_2 \dots i_L\rangle
$$

这里，$i_k$ 代表第 $k$ 个[轨道](@entry_id:137151)上的局域[量子态](@entry_id:146142)，而 $C_{i_1 i_2 \dots i_L}$ 是一个秩为 $L$ 的系数张量，包含了描述该[量子态](@entry_id:146142)的全部信息。在[全组态相互作用](@entry_id:172539)（Full Configuration Interaction, FCI）方法中，我们需要直接处理这个张量。若每个[轨道](@entry_id:137151)有 $d$ 个可能的局域态，那么该张量将包含 $d^L$ 个元素，其数量随系统尺寸 $L$ 呈[指数增长](@entry_id:141869)，这便是所谓的“指数墙”问题。

**[矩阵乘积态](@entry_id:143296)（Matrix Product State, MPS）** 提供了一种规避此指数灾难的强大方案。其核心思想是将这个巨大的系数[张量分解](@entry_id:173366)为一系列秩较低（通常为3）的小张量的乘积。通过对系数张量进行一系列连续的[奇异值分解](@entry_id:138057)（Singular Value Decomposition, SVD），可以将其精确地表示为：

$$
C_{i_1 i_2 \dots i_L} = \mathrm{Tr}(A_1^{[i_1]} A_2^{[i_2]} \cdots A_L^{[i_L]})
$$

其中，每个 $A_k^{[i_k]}$ 是一个矩阵（对于链中部的张量）或向量（对于链两端的张量）。这里的上标 $i_k$ 被称为**物理指标（physical index）**，其维度 $d$ 等于局域希尔伯特空间的[基矢](@entry_id:199546)数量；连接相邻张量的指标则被称为**虚拟指标（virtual index）**或**键合指标（bond index）**，其最大维度 $D$ 被定义为该 MPS 的**键合维度（bond dimension）**。

理解物理维度 $d$ 和键合维度 $D$ 的不同角色至关重要。**物理维度 $d$** 决定了每个局域[轨道](@entry_id:137151)（格点）上可以承载的[基态](@entry_id:150928)数量，它由问题的物理模型直接确定。而**键合维度 $D$** 并不描述局域物理，而是量化了不同格点之间量子纠缠的强度。它控制着 MPS 所能表达的[非局域关联](@entry_id:180194)的上限 [@problem_id:2885130]。通过限制键合维度 $D$ 为一个可控的有限值，MPS 将变分自由度从指数级的 $O(d^L)$ 压缩至多项式级的 $O(L d D^2)$，从而极大地降低了计算复杂度 [@problem_id:2631301]。

#### 局域希尔伯特空间与[轨道](@entry_id:137151)映射

要将一个[量子化学](@entry_id:140193)问题用 MPS 描述，首先必须将分子的[轨道](@entry_id:137151)[排列](@entry_id:136432)成一维链，并定义每个格点上的局域希尔伯特空间。对于[电子结构](@entry_id:145158)问题，一个自然的格点选择是空间[轨道](@entry_id:137151)。考虑自旋后，每个空间[轨道](@entry_id:137151)可以有四种占据状态：空[轨道](@entry_id:137151) ($|0\rangle$)、单个自旋向上电子 ($|\uparrow\rangle$)、单个自旋向下电子 ($|\downarrow\rangle$) 或一对自旋相反的电子 ($|\uparrow\downarrow\rangle$)。因此，在这种**空间[轨道](@entry_id:137151)映射（spatial-orbital mapping）**下，每个格点的物理维度为 $d=4$ [@problem_id:2453970]。

另一种选择是**[自旋轨道](@entry_id:274032)映射（spin-orbital mapping）**，即将每个[自旋轨道](@entry_id:274032)（例如 $1\alpha, 1\beta, 2\alpha, 2\beta, \dots$）视为一个独立的格点。由于[泡利不相容原理](@entry_id:141850)，每个自旋轨道只能被占据或不被占据，因此其局域希尔伯特空间维度为 $d=2$。一个包含 $K$ 个空间[轨道](@entry_id:137151)的系统，在此映射下会变成一条长度为 $2K$ 的链 [@problem_id:2929041]。

这两种映射各有优劣。空间[轨道](@entry_id:137151)映射将同一空间[轨道](@entry_id:137151)内的强关联（如电子配对）局域化在格点内部，这通常有助于减少跨越格点间的纠缠，从而可能用较小的键合维度 $D$ 获得高精度。反之，[自旋轨道](@entry_id:274032)映射则提供了更细致的[排列](@entry_id:136432)灵活性。

在特定物理情境下，局域[希尔伯特空间](@entry_id:261193)可以被进一步简化。例如，在** seniority-zero [子空间](@entry_id:150286)**中，所有空间[轨道](@entry_id:137151)要么是空的，要么是双占据的，不允许单占据[轨道](@entry_id:137151)存在。在这种情况下，每个格点的局域[基矢](@entry_id:199546)可以被精确地缩减为 $\{|0\rangle, |\uparrow\downarrow\rangle\}$，使得物理维度降至 $d=2$ [@problem_id:2929041]。

最后，由于电子是[费米子](@entry_id:146235)，其[波函数](@entry_id:147440)在交换任意两个粒子时必须反号。在使用 MPS 这种具有固定[排列](@entry_id:136432)顺序的表示法时，必须引入一种机制来确保正确的[费米子反对称性](@entry_id:749292)。这通常通过**Jordan-Wigner 变换**实现，它将[费米子](@entry_id:146235)产生和[湮灭算符](@entry_id:165390)映射为[自旋算符](@entry_id:155419)，并在算符前面附加一条“宇称弦”（parity string），该弦由一连串泡利 $Z$ 算符构成，其长度取决于算符在链上的位置。这确保了当两个[费米子算符](@entry_id:149120)交换位置时，能够产生正确的 $-1$ 因子 [@problem_id:2929041]。

### 纠缠、[可表示性](@entry_id:635277)与[面积定律](@entry_id:145931)

MPS 的成功并非偶然，其背后深刻的物理原理在于对量子纠缠结构的精妙捕捉。一个[量子态](@entry_id:146142)能否被 MPS 高效表示，完全取决于其内部的纠缠[分布](@entry_id:182848)模式。

#### MPS与[纠缠熵](@entry_id:140818)

对于一个纯态 $|\Psi\rangle$，若将其所在的系统划分为 $A$ 和 $B$ 两部分，可以通过**Schmidt 分解**将其写作：
$$
|\Psi\rangle = \sum_{i=1}^{\chi} s_i |\phi_i^A\rangle \otimes |\phi_i^B\rangle
$$
其中 $\{|\phi_i^A\rangle\}$ 和 $\{|\phi_i^B\rangle\}$ 分别是子系统 $A$ 和 $B$ 的一组[正交基](@entry_id:264024)，$\{s_i\}$ 是非负的 Schmidt 系数且满足 $\sum_i s_i^2 = 1$。非零 Schmidt 系数的数量 $\chi$ 被称为 **Schmidt 秩**，它直接量化了 $A$ 和 $B$ 之间的纠缠。

MPS 的结构与 Schmidt 分解有着内在的联系。对于沿 MPS 链任意一个键合的划分，该键合的维度 $D$ 恰好是该划分下所能表示的 Schmidt 秩 $\chi$ 的上限。换言之，任何一个键合维度为 $D$ 的 MPS，其跨越任意键合的 Schmidt 秩都不会超过 $D$。

**von Neumann [纠缠熵](@entry_id:140818)** $S = -\sum_i s_i^2 \ln(s_i^2)$ 是度量纠缠的常用指标。由于 Schmidt 秩受限于 $D$，纠缠熵也相应地存在一个上限。当所有 $D$ 个 Schmidt 系数均等时，熵达到最大值 $\ln D$。因此，一个键合维度为 $D$ 的 MPS 能够表示的[纠缠熵](@entry_id:140818)满足 $S \le \ln D$ [@problem_id:2885130] [@problem_id:2631301]。这一关系是 MPS 方法的核心，它意味着 MPS 本质上是为那些纠缠“不太多”的[量子态](@entry_id:146142)量身定做的。

#### [面积定律](@entry_id:145931)与DMRG的适用性

幸运的是，自然界中许多重要的物理系统，特别是[局域哈密顿量](@entry_id:141996)的[基态](@entry_id:150928)，其纠缠并非无限增长，而是遵循所谓的**[面积定律](@entry_id:145931)（Area Law）**。这一定律指出，一个子系统的纠缠熵与其边界的“面积”成正比，而非其“体积”。

- **一维有[能隙](@entry_id:191975)系统**：对于一维链状系统，任何连续子系统的边界都只是两个点（左右两端）。因此，如果系统存在一个不随系统尺寸而闭合的[能隙](@entry_id:191975)（gapped），其[基态](@entry_id:150928)的[纠缠熵](@entry_id:140818)将是一个与子系统大小无关的常数，即 $S = O(1)$。这便是一维系统的[面积定律](@entry_id:145931)。根据 $S \le \ln D$ 的关系，这意味着我们只需要一个不随系统总尺寸 $N$ 增长的、有限的键合维度 $D$，就能精确地表示这类[基态](@entry_id:150928)。这使得 DMRG 算法的计算成本仅随 $N$ 呈多项式（通常是低阶多项式）增长，因而极其高效 [@problem_id:2801624] [@problem_id:2929032]。

- **一维[无能](@entry_id:201612)隙（临界）系统**：对于没有[能隙](@entry_id:191975)的临界系统，关联函数呈[幂律衰减](@entry_id:262227)，导致[面积定律](@entry_id:145931)被轻微违背。其[纠缠熵](@entry_id:140818)会随子系统尺寸 $k$ 对数增长，$S \propto \ln k$。此时，要维持固定的近似精度，所需的键合维度 $D$ 必须随系统尺寸呈[多项式增长](@entry_id:177086)，$D \propto k^{\kappa}$。这使得 DMRG 的计算成本虽然高于有[能隙](@entry_id:191975)情况，但仍然是系统尺寸的多项式函数，方法依然有效 [@problem_id:2801624] [@problem_id:2929032]。

- **二维及更高维度系统**：当我们将 MPS 应用于二维系统时（例如通过蛇形路径将二维格点[排列](@entry_id:136432)成一维链），问题就出现了。对系统进行一次横切，其边界长度将与系统的线性宽度 $L$ 成正比。对于一个满足[面积定律](@entry_id:145931)的二维有[能隙](@entry_id:191975)系统，其纠缠熵将是 $S \propto L$。为了表示这样的态，所需的 MPS 键合维度将呈指数增长，$D \ge \exp(cL)$。这使得基于 MPS 的标准 DMRG 算法在处理二维问题时会遭遇与 FCI 类似的指数瓶颈，从而变得不切实际 [@problem_id:2801624]。

#### [轨道](@entry_id:137151)排序与替代[张量网络](@entry_id:142149)

从上述讨论可知，MPS 的效率极其依赖于其一维拓扑结构所承载的纠缠。**[轨道](@entry_id:137151)排序**因此成为一个至关重要的实践问题。将物理上[强相互作用](@entry_id:159198)、因而高度纠缠的[轨道](@entry_id:137151)在 MPS 链上放置得彼此靠近，可以最大限度地将强关联局域化，从而减小跨越长距离的纠缠。一个好的排序能够显著降低近似某一目标态所需的键合维度 $D$ [@problem_id:2885130] [@problem_id:2631301]。相反，一个随机或糟糕的排序可能人为地制造出大量长程纠缠，即使对于一个本来满足一维[面积定律](@entry_id:145931)的系统，也会从 MPS 的视角呈现出“体积定律”的特征，导致所需 $D$ 呈[指数增长](@entry_id:141869) [@problem_id:2929032]。在[图论](@entry_id:140799)语言中，一个好的排序对应于寻找分子相互作用图的最小[路径宽度](@entry_id:273205)（pathwidth）或[树宽](@entry_id:263904)度（treewidth）的近似解 [@problem_id:2801624]。

对于具有[非线性](@entry_id:637147)几何结构（如二维平面或支链结构）的分子，MPS 的一维拓扑存在天然的局限性。为了更自然地匹配系统的几何结构和纠缠模式，人们发展了更高维度的[张量网络](@entry_id:142149)，如**投射[纠缠对](@entry_id:160576)态（Projected Entangled-Pair States, PEPS）**和**[树张量网络](@entry_id:195766)（Tree Tensor Networks, TTNS）**。例如，TTNS 可以构建一个与分子支链结构相匹配的树状网络，而 PEPS 则天然地适用于二维格点。这些高维[张量网络](@entry_id:142149)能够直接满足相应维度下的[面积定律](@entry_id:145931)，而无需指数增长的键合维度，从而为处理二维及更高维度系统提供了理论上更有效的途径 [@problem_id:2929032] [@problem_id:2801624]。

### 变分优化：[密度矩阵重整化群](@entry_id:137826)算法

找到了一个有效的[波函数](@entry_id:147440)拟设（ansatz）——MPS，接下来的问题是如何确定其中的参数（即张量元素）以最佳地逼近[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)。这正是**[密度矩阵重整化群](@entry_id:137826)（Density Matrix Renormalization Group, DMRG）**算法要解决的问题。

#### 矩阵乘积算符

为了在 MPS 的框架下进行计算，[哈密顿量](@entry_id:172864)本身也需要被表示为一种[张量网络](@entry_id:142149)，即**矩阵乘积算符（Matrix Product Operator, MPO）**。一个 MPO 的结构与 MPS 非常相似，但其每个局域张量 $W_k$ 除了拥有连接左右的虚拟指标外，还拥有两个物理指标（一个输入，一个输出），使其可以作为一个算符作用在局域[希尔伯特空间](@entry_id:261193)上。

一个[哈密顿量](@entry_id:172864)能否被高效地表示为具有小键合维度的 MPO，取决于其相互作用的局域性。对于只包含局域项和近邻[相互作用项](@entry_id:637283)的[哈密顿量](@entry_id:172864)，可以精确地构建一个键合维度很小的 MPO。MPO 的最小所需键合维度由[哈密顿量](@entry_id:172864)中独立的相互作用“通道”数量决定。

以一个一维无自旋[费米子](@entry_id:146235)链的[哈密顿量](@entry_id:172864)为例 [@problem_id:2929031]：
$$
\hat{H} = -t \sum_{i=1}^{L-1} ( \hat{a}_{i}^{\dagger} \hat{a}_{i+1} + \hat{a}_{i+1}^{\dagger} \hat{a}_{i} ) + U \sum_{i=1}^{L-1} \hat{n}_{i}\hat{n}_{i+1} + \mu \sum_{i=1}^{L} \hat{n}_{i}
$$
通过 Jordan-Wigner 变换，该[哈密顿量](@entry_id:172864)可以被映射为一个自旋链模型，其[相互作用项](@entry_id:637283)包含 $\hat{X}_{i}\hat{X}_{i+1}$, $\hat{Y}_{i}\hat{Y}_{i+1}$ 和 $\hat{Z}_{i}\hat{Z}_{i+1}$ 三种独立的近邻耦合，以及局域的 $\hat{Z}_i$ 和 $\hat{\mathbb{1}}_i$ 项。为了构建一个 MPO 来表示这个[哈密顿量](@entry_id:172864)，我们需要一个“初始”状态（表示尚未开始构建任何算符项），一个“末态”（表示一个算符项已构建完毕），以及为 $\hat{X}\hat{X}$, $\hat{Y}\hat{Y}$, $\hat{Z}\hat{Z}$ 这三种独立的近邻相互作用分别提供一个“载体”状态。总计需要 $1 (\text{初始}) + 3 (\text{载体}) + 1 (\text{末态}) = 5$ 个状态。因此，该[哈密顿量](@entry_id:172864)的 MPO 的最小键合维度为 $D_{\mathrm{MPO}}=5$ [@problem_id:2929031]。

#### 变分原理与扫描优化

DMRG 算法的本质是基于**Rayleigh-Ritz [变分原理](@entry_id:198028)**，即在 MPS 构成的变分空间中寻找[能量期望值](@entry_id:174035) $E = \frac{\langle\Psi(A)|H|\Psi(A)\rangle}{\langle\Psi(A)|\Psi(A)\rangle}$ 的最小值。由于同时优化所有 MPS 张量 $A_k$ 是一个困难的[非线性](@entry_id:637147)问题，DMRG 采用了一种迭代的、逐个击破的策略，即**扫描优化（sweep optimization）**。

在一个扫描步骤中，算法选择一个或两个相邻的张量作为“活性”部分进行优化，而将链上所有其他张量暂时固定。通过将[哈密顿量](@entry_id:172864)的 MPO 与固定的 MPS 张量（即“环境”）进行缩并，可以构建一个只作用于[活性区](@entry_id:177357)域的**有效哈密顿量（effective Hamiltonian）** $H_{\mathrm{eff}}$。这样，全局的、复杂的[优化问题](@entry_id:266749)就被简化为一个局部的、小尺寸的[本征值问题](@entry_id:142153)：$H_{\mathrm{eff}} \psi_{\mathrm{local}} = E \psi_{\mathrm{local}}$。求解这个本征值问题，找到其[基态](@entry_id:150928)向量 $\psi_{\mathrm{local}}$，就得到了当前环境下最优的活性张量。

算法随后将优化后的张量放回 MPS 链中，并将[活性区](@entry_id:177357)域移动到下一个位置（例如，从 $A_k$ 移到 $A_{k+1}$），重复此过程。整个算法就像一个拉链一样，从左到右扫过整个链，然后再从右到左扫回，如此反复，直到能量不再下降，达到收敛为止 [@problem_id:2812538]。

#### 单点与双点DMRG算法

根据每次优化的[活性区](@entry_id:177357)域大小，DMRG 主要分为两种变体：

- **单点（1-site）DMRG**：每次只优化一个张量 $A_k$。由于是在一个固定的[线性子空间](@entry_id:151815)内进行变分，根据 Rayleigh-Ritz 原理，每一步优化都能保证能量非增。然而，这种方法的缺点在于，它在优化过程中无法改变键合维度 $D$。如果初始的 MPS 陷入了某个需要更大 $D$ 才能“逃出”的局域能量极小值，单点算法就会被困住 [@problem_id:2929036]。

- **双点（2-site）DMRG**：每次同时优化一对相邻的张量 $(A_k, A_{k+1})$。这等价于在一个由左右环境[基矢](@entry_id:199546)和两个物理格点[基矢](@entry_id:199546)张成的、维度为 $D^2 d^2$ 的动态小“[活性空间](@entry_id:263213)”内进行一次精确的 FCI 计算 [@problem_id:2453970]。优化后得到的两点张量 $\Theta_{k,k+1}$ 需要通过 SVD 分解回两个单点张量，以便继续扫描。这个 SVD 步骤是双点算法的精髓：它不仅可以根据奇异值的大小进行截断以控制键合维度，更重要的是，它为连接 $k$ 和 $k+1$ 的键合空间找到了一个更新的、更优的[基矢](@entry_id:199546)。这种动态调整键合空间的能力使得双点算法能够有效跳出局域极小值，通常收敛性更好。其代价是，由于 SVD 截断是一个投影操作，它可能导致能量在某一步略微上升，因此能量不是严格单调下降的。此外，双点算法的计算成本也更高，其每个局部步骤（特指有效哈密顿量与试探波函数的乘积）的标度为 $O(D^3 d^2 w + D^2 d^3 w^2)$，而单点算法为 $O(D^3 d w + D^2 d^2 w^2)$ [@problem_id:2929036]。

### 高级主题与实践考量

#### [规范自由度](@entry_id:160491)与[数值稳定性](@entry_id:146550)

MPS 表示并非唯一的。在任意两个相邻张量 $A_k$ 和 $A_{k+1}$ 之间的键合上，我们可以插入一对互逆的[可逆矩阵](@entry_id:171829) $X$ 和 $X^{-1}$，并分别吸收到左右张量中（$A_k \to A_k X$, $A_{k+1} \to X^{-1} A_{k+1}$），而最终表示的物理态 $|\Psi\rangle$ 保持不变。这种**[规范自由度](@entry_id:160491)（gauge freedom）**虽然在理论上无伤大雅，但在数值计算中却至关重要。

DMRG 算法的数值稳定性严重依赖于对规范的良好控制。在构建[有效哈密顿量](@entry_id:748813) $H_{\mathrm{eff}}$ 时，我们希望其作用的[基矢](@entry_id:199546)是正交的，这样局部问题就是一个标准的厄米本征值问题，而不是一个需要求解 $H_{\mathrm{eff}} \psi = E S \psi$ 的、可能病态的广义[本征值问题](@entry_id:142153)。

为此，我们引入**正则形式（canonical forms）**。一个 MPS 张量 $A_k$ 被称为**左正则的（left-canonical）**，如果它满足 $\sum_i (A_k^{[i]})^\dagger A_k^{[i]} = I$。类似地，如果满足 $\sum_i A_k^{[i]} (A_k^{[i]})^\dagger = I$，则称其为**右正则的（right-canonical）**。在 DMRG 扫描中，通常将 MPS 维持在一种**混合正则形式（mixed-canonical form）**：位于[活性区](@entry_id:177357)域左侧的所有张量均为左正则，右侧的所有张量均为右正则。这样，构成 $H_{\mathrm{eff}}$ 的环境就天然地形成了[正交基](@entry_id:264024)，极大地增强了算法的[数值稳定性](@entry_id:146550) [@problem_id:2929043]。

在实际计算中，[浮点误差](@entry_id:173912)和 SVD 截断会逐渐破坏完美的正则性。因此，必须有机制来恢复它。常用的方法包括：
1.  通过在链上从一端到另一端连续进行 QR 分解或 SVD，系统地重构所有张量以强制满足正则条件。
2.  直接计算某个键合上的度规矩阵（overlap matrix），并通过 Cholesky 分解或[对称正交化](@entry_id:167626)（如 Löwdin [正交化](@entry_id:149208)）找到矫[正矩阵](@entry_id:149490)，然后通过规范变换将其重新对角化为单位阵。
3.  双点 DMRG 算法中使用的 SVD 分解，天然地就会产生一个满足正则条件的酉矩阵，从而在每一步扫描中自动恢复和传播正则形式 [@problem_id:2929043] [@problem_id:2812538]。

#### 对称性利用

如果[哈密顿量](@entry_id:172864)具有对称性（例如，粒子数守恒或自旋[旋转不变性](@entry_id:137644)），那么其[本征态](@entry_id:149904)也应具有确定的对称性量子数。在 MPS/MPO 中利用这些对称性，可以带来巨大的计算优势：不仅能保证得到的解具有正确的物理对称性，还能将张量变为[块对角结构](@entry_id:746869)，从而大幅减少存储和计算成本。

- **阿贝尔对称性（Abelian Symmetries）**：如粒子数守恒（对应 $\mathrm{U}(1)$ 群），其量子数是可加的。在这种情况下，MPS 的每个虚拟指标和物理指标都可以被赋予一个量子数（“[电荷](@entry_id:275494)”）。张量中的一个元素只有在满足电荷守恒定律（例如，流入的[电荷](@entry_id:275494)等于流出的[电荷](@entry_id:275494)）时才非零。这使得原本稠密的张量变成稀疏的块[对角形式](@entry_id:264850) [@problem_id:2929045]。

- **非阿贝尔对称性（Non-Abelian Symmetries）**：如 $\mathrm{SU}(2)$自旋[旋转对称](@entry_id:137077)性，其处理更为复杂但回报也更大。仅仅守恒 $S_z$（一个 $\mathrm{U}(1)$ [子群](@entry_id:146164)）是不够的，完整的 $\mathrm{SU}(2)$ 对称性要求[波函数](@entry_id:147440)是总[自旋算符](@entry_id:155419) $\hat{S}^2$ 的[本征态](@entry_id:149904)。在 MPS 中实现这一点，需要借助群论的表示论知识。
    - 每个指标不再携带单个量子数，而是携带一组不可约表示（irreps），例如 $\mathrm{SU}(2)$ 的自旋量子数 $j$。
    - 张量元素是否为零，取决于所谓的**[融合规则](@entry_id:142240)（fusion rules）**，即指標上的[不可约表示](@entry_id:263310)是否能通过[Clebsch-Gordan分解](@entry_id:139084)耦合。例如，对于一个具有物理指标 $j_p=1/2$ 和两个虚拟指标 $j_L, j_R$ 的张量，它非零的条件是满足[三角不等式](@entry_id:143750) $|j_L - 1/2| \le j_R \le j_L + 1/2$ [@problem_id:2929045]。
    - 根据 **Wigner-Eckart 定理**，对称张量可以被分解为一个普适的、只与群几何有关的部分（Clebsch-Gordan 系数）和一个简化的、包含所有物理信息的“简约张量”（reduced tensor）。计算只在这些尺寸小得多的简约张量上进行，从而实现巨大提速。
    - 例如，在空间[轨道](@entry_id:137151)表象下，$d=4$ 的局域[希尔伯特空间](@entry_id:261193)在 $\mathrm{SU}(2)$ 对称性下可以分解为三个不可约表示：一个自旋为 $S=0$ 的空[轨道](@entry_id:137151)态，一个自旋为 $S=1/2$ 的双重态（单占据的 $|\uparrow\rangle$ 和 $|\downarrow\rangle$），以及一个自旋为 $S=0$ 的双占据态。因此，从对称性的角度看，局域“自由度”的种类从 4 种状态减少为 3 种多重态 [@problem_id:2929041]。

综上所述，从表示论的根本优势到算法的精巧设计，再到对纠缠结构的深刻洞察，[张量网络方法](@entry_id:165192)为处理强关联[量子化学](@entry_id:140193)问题提供了一套强大而优雅的理论与计算框架。