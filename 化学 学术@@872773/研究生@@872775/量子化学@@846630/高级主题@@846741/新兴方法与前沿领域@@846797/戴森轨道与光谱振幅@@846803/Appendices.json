{"hands_on_practices": [{"introduction": "第一个练习将通过一个简化但功能强大的模型，从理论上深入探讨光谱因子的代数起源。通过在运动方程耦合簇 (EOM-CC) 框架内手动推导戴森轨道振幅 [@problem_id:2632902]，您将亲眼见证基态和末态中的电子关联如何导致光谱因子偏离理想值 1。这是理解和解释实验光谱的一个核心概念。", "problem": "考虑一个闭壳层双电子、双空间轨道模型，其中有一个双占据轨道 $o$ 和一个虚轨道 $v$。参考行列式为 $|\\Phi_0\\rangle = |o_\\alpha o_\\beta\\rangle$。使用限制于单个非零双激发振幅及其相应退激发对应物的耦合簇单双激发 (CCSD) 基态：\n- 耦合簇的簇算符为 $T = t\\, a_{v_\\alpha}^\\dagger a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha}$，其中 $t \\in \\mathbb{R}$。\n- 左退激发算符为 $\\Lambda = \\ell\\, a_{o_\\alpha}^\\dagger a_{o_\\beta}^\\dagger a_{v_\\beta} a_{v_\\alpha}$，其中 $\\ell \\in \\mathbb{R}$。\n双正交耦合簇基态左矢为 $\\langle \\tilde{\\Psi}_0^N| = \\langle \\Phi_0|(1+\\Lambda)\\exp(-T)$，右基态右矢为 $|\\Psi_0^N\\rangle = \\exp(T)|\\Phi_0\\rangle$。\n\n对于在 CCSD 水平 (EOM-IP-CCSD) 的运动方程 (EOM) 形式下的电离势，将右电离算符限制在具有单空穴和双空穴-单粒子组分的 $\\alpha$-自旋块上，\n$$\nR^{(k)} \\;=\\; r_o^{(k)}\\, a_{o_\\alpha} \\;+\\; r_{oo}^{v,(k)}\\, a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha},\n$$\n其中 $k$ 索引 $N-1$ 个本征态，且所有振幅均为实数。假设两个最低的 EOM-IP-CCSD 右本征矢为\n$$\n\\big(r_o^{(1)},\\, r_{oo}^{v,(1)}\\big) \\;=\\; \\big(\\sqrt{0.81},\\, \\sqrt{0.19}\\big),\\qquad\n\\big(r_o^{(2)},\\, r_{oo}^{v,(2)}\\big) \\;=\\; \\big(\\sqrt{0.19},\\, \\sqrt{0.81}\\big).\n$$\n\n用于移除自旋轨道 $p$ 中电子的戴森轨道振幅由以下双正交方式定义：\n$$\nd_{p}^{(k)} \\;\\equiv\\; \\langle \\tilde{\\Psi}_0^N|\\, a_{p}^\\dagger \\,|\\Psi_{k}^{N-1}\\rangle \\;=\\; \\langle \\Phi_0|\\,(1+\\Lambda)\\,\\exp(-T)\\, a_{p}^\\dagger \\, R^{(k)} \\,\\exp(T)\\,|\\Phi_0\\rangle,\n$$\n及其对应的戴森范数（光谱因子）\n$$\nS^{(k)} \\;=\\; \\sum_{p \\in \\{o_\\alpha,\\, v_\\alpha\\}} \\big|d_{p}^{(k)}\\big|^2.\n$$\n\n仅使用这些定义和标准的费米子反对易关系，在此模型中推导 $d_{o_\\alpha}^{(k)}$ 和 $d_{v_\\alpha}^{(k)}$，并计算在参数值 $t=0.30$ 和 $\\ell=0.25$ 下的两个戴森范数 $S^{(1)}$ 和 $S^{(2)}$。将您计算的 $S^{(1)}$ 和 $S^{(2)}$ 的最终结果四舍五入到四位有效数字。根据您的推导，简要解释为什么 $S^{(k)}$ 对 1 的偏离表明了 EOM-IP-CCSD 中的电子相关和摇动特征。", "solution": "该问题要求在一个简化的双电子、双轨道模型中，使用双正交运动方程耦合簇 (EOM-CC) 形式，推导戴森轨道振幅并计算相应的戴森范数（也称为光谱因子）。\n\n问题验证：\n所有给定条件均已提取和验证。该问题在科学上基于成熟的量子化学理论（EOM-CCSD），问题表述清晰，信息充分，可得出唯一解，且陈述客观。该模型虽然简化，但是一个标准的教学工具。因此，该问题被认为是有效的，并将提供解答。\n\n戴森轨道振幅的推导：\n\n将电子从自旋轨道 $p$ 移除以达到最终态 $k$ 的戴森轨道振幅定义为\n$$\nd_{p}^{(k)} \\equiv \\langle \\tilde{\\Psi}_0^N|\\, a_{p}^\\dagger \\,|\\Psi_{k}^{N-1}\\rangle\n$$\n其中 $|\\Psi_0^N\\rangle$ 和 $\\langle \\tilde{\\Psi}_0^N|$ 分别是右和左 $N$ 电子基态，而 $|\\Psi_{k}^{N-1}\\rangle$ 是第 $k$ 个 $(N-1)$ 电子态。\n\n首先，我们必须推导出所需状态的显式形式。\n\n右 $N$ 电子基态为 $|\\Psi_0^N\\rangle = \\exp(T)|\\Phi_0\\rangle$。簇算符 $T = t\\, a_{v_\\alpha}^\\dagger a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha}$ 从参考态 $|\\Phi_0\\rangle = |o_\\alpha o_\\beta\\rangle$ 产生双激发。将 $T$ 作用两次，$T^2|\\Phi_0\\rangle$，需要从一个只包含两个占据自旋轨道的体系中湮灭四个占据自旋轨道，结果为零。因此，$\\exp(T)$ 的展开式会截断：\n$$\n|\\Psi_0^N\\rangle = (1+T)|\\Phi_0\\rangle = |\\Phi_0\\rangle + t\\, a_{v_\\alpha}^\\dagger a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha} |o_\\alpha o_\\beta\\rangle = |\\Phi_0\\rangle + t |v_\\alpha v_\\beta\\rangle\n$$\n\n$(N-1)$ 电子态 $|\\Psi_k^{N-1}\\rangle$ 是通过将电离算符 $R^{(k)}$ 作用于基态来构建的：\n$$\n|\\Psi_{k}^{N-1}\\rangle = R^{(k)} |\\Psi_0^N\\rangle = R^{(k)} (1+T)|\\Phi_0\\rangle = R^{(k)}|\\Phi_0\\rangle + R^{(k)}T|\\Phi_0\\rangle\n$$\n算符 $R^{(k)} = r_o^{(k)}\\, a_{o_\\alpha} + r_{oo}^{v,(k)}\\, a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha}$ 包含占据轨道 ($a_{o_\\alpha}$, $a_{o_\\beta}$) 的湮灭算符。态 $T|\\Phi_0\\rangle = t|v_\\alpha v_\\beta\\rangle$ 没有占据轨道。因此，$R^{(k)}$ 中的任何项作用于 $t|v_\\alpha v_\\beta\\rangle$ 都会得到零。这简化了 $|\\Psi_{k}^{N-1}\\rangle$ 的表达式：\n$$\n|\\Psi_{k}^{N-1}\\rangle = R^{(k)}|\\Phi_0\\rangle = (r_o^{(k)}\\, a_{o_\\alpha} + r_{oo}^{v,(k)}\\, a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha})|\\Phi_0\\rangle\n$$\n作用于参考态 $|\\Phi_0\\rangle = |o_\\alpha o_\\beta\\rangle$：\n$a_{o_\\alpha}|\\Phi_0\\rangle = |o_\\beta\\rangle$\n$a_{o_\\beta}a_{o_\\alpha}|\\Phi_0\\rangle = |vac\\rangle$，所以 $a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha}|\\Phi_0\\rangle = a_{v_\\beta}^\\dagger|vac\\rangle = |v_\\beta\\rangle$。\n因此，最终态是单空穴 ($1h$) 态和双空穴-单粒子 ($2h1p$) 态的叠加：\n$$\n|\\Psi_{k}^{N-1}\\rangle = r_o^{(k)}|o_\\beta\\rangle + r_{oo}^{v,(k)}|v_\\beta\\rangle\n$$\n\n接下来，我们推导左 $N$ 电子基态左矢 $\\langle \\tilde{\\Psi}_0^N| = \\langle \\Phi_0|(1+\\Lambda)\\exp(-T)$。\n我们展开 $\\exp(-T)$ 并计算它在左矢态 $\\langle\\Phi_0|$ 和 $\\langle\\Phi_0|\\Lambda$ 上的作用。\n$T^n$ 在 $\\langle\\Phi_0|$ 上的作用由 $\\langle\\Phi_0|T^n = ((T^\\dagger)^n|\\Phi_0\\rangle)^\\dagger$ 给出。由于 $T^\\dagger$ 包含虚轨道 ($a_v$) 的湮灭算符，而虚轨道在 $|\\Phi_0\\rangle$ 中是空的，所以我们有 $T^\\dagger|\\Phi_0\\rangle=0$。因此，对于 $n \\ge 1$，有 $\\langle\\Phi_0|T^n=0$，这意味着 $\\langle\\Phi_0|\\exp(-T) = \\langle\\Phi_0|$。\n对于项 $\\langle\\Phi_0|\\Lambda\\exp(-T)$，我们首先计算 $\\langle\\Phi_0|\\Lambda = (\\Lambda^\\dagger|\\Phi_0\\rangle)^\\dagger$。\n$\\Lambda^\\dagger = \\ell (a_{o_\\alpha}^\\dagger a_{o_\\beta}^\\dagger a_{v_\\beta} a_{v_\\alpha})^\\dagger = \\ell a_{v_\\alpha}^\\dagger a_{v_\\beta}^\\dagger a_{o_\\beta} a_{o_\\alpha} = (\\ell/t)T$。\n因此，$\\langle\\Phi_0|\\Lambda = (\\frac{\\ell}{t}T|\\Phi_0\\rangle)^\\dagger = (\\ell |v_\\alpha v_\\beta\\rangle)^\\dagger = \\ell \\langle v_\\alpha v_\\beta|$。\n现在我们计算 $\\langle v_\\alpha v_\\beta|\\exp(-T) = \\langle v_\\alpha v_\\beta|(1-T+\\frac{1}{2}T^2 - \\dots)$。\n项 $\\langle v_\\alpha v_\\beta|T^n$ 对应于 $( (T^\\dagger)^n |v_\\alpha v_\\beta\\rangle )^\\dagger$。\n$(T^\\dagger)^1 |v_\\alpha v_\\beta\\rangle = t a_{o_\\alpha}^\\dagger a_{o_\\beta}^\\dagger a_{v_\\beta} a_{v_\\alpha} |v_\\alpha v_\\beta\\rangle = t a_{o_\\alpha}^\\dagger a_{o_\\beta}^\\dagger |vac\\rangle = t|\\Phi_0\\rangle$。\n$(T^\\dagger)^2 |v_\\alpha v_\\beta\\rangle = T^\\dagger(t|\\Phi_0\\rangle) = 0$。所以对于 $n \\ge 2$，有 $\\langle v_\\alpha v_\\beta|T^n = 0$。\n所以，$\\langle v_\\alpha v_\\beta|\\exp(-T) = \\langle v_\\alpha v_\\beta|(1-T) = \\langle v_\\alpha v_\\beta| - t\\langle\\Phi_0|$。\n结合这些结果：\n$$\n\\langle \\tilde{\\Psi}_0^N| = \\langle\\Phi_0|\\exp(-T) + \\langle\\Phi_0|\\Lambda\\exp(-T) = \\langle\\Phi_0| + \\ell \\langle v_\\alpha v_\\beta|\\exp(-T)\n$$\n$$\n\\langle \\tilde{\\Psi}_0^N| = \\langle\\Phi_0| + \\ell(\\langle v_\\alpha v_\\beta| - t\\langle\\Phi_0|) = (1-\\ell t)\\langle\\Phi_0| + \\ell\\langle v_\\alpha v_\\beta|\n$$\n\n现在我们可以计算戴森振幅 $d_{p}^{(k)} = \\langle\\tilde{\\Psi}_0^N| a_{p}^\\dagger |\\Psi_{k}^{N-1}\\rangle$。\n\n对于 $p=o_\\alpha$：\n态 $a_{o_\\alpha}^\\dagger|\\Psi_k^{N-1}\\rangle = a_{o_\\alpha}^\\dagger(r_o^{(k)}|o_\\beta\\rangle + r_{oo}^{v,(k)}|v_\\beta\\rangle) = r_o^{(k)}|o_\\alpha o_\\beta\\rangle + r_{oo}^{v,(k)}|o_\\alpha v_\\beta\\rangle = r_o^{(k)}|\\Phi_0\\rangle + r_{oo}^{v,(k)}|o_\\alpha v_\\beta\\rangle$。\n与 $\\langle\\tilde{\\Psi}_0^N|$ 做内积：\n$$\nd_{o_\\alpha}^{(k)} = \\left((1-\\ell t)\\langle\\Phi_0| + \\ell\\langle v_\\alpha v_\\beta|\\right) \\left(r_o^{(k)}|\\Phi_0\\rangle + r_{oo}^{v,(k)}|o_\\alpha v_\\beta\\rangle\\right)\n$$\n$$\nd_{o_\\alpha}^{(k)} = (1-\\ell t)r_o^{(k)}\\langle\\Phi_0|\\Phi_0\\rangle + (1-\\ell t)r_{oo}^{v,(k)}\\langle\\Phi_0|o_\\alpha v_\\beta\\rangle + \\ell r_o^{(k)}\\langle v_\\alpha v_\\beta|\\Phi_0\\rangle + \\ell r_{oo}^{v,(k)}\\langle v_\\alpha v_\\beta|o_\\alpha v_\\beta\\rangle\n$$\n唯一的非零内积是 $\\langle\\Phi_0|\\Phi_0\\rangle=1$。所有其他行列式都是正交的。\n$$\nd_{o_\\alpha}^{(k)} = (1-\\ell t)r_o^{(k)}\n$$\n\n对于 $p=v_\\alpha$：\n态 $a_{v_\\alpha}^\\dagger|\\Psi_k^{N-1}\\rangle = a_{v_\\alpha}^\\dagger(r_o^{(k)}|o_\\beta\\rangle + r_{oo}^{v,(k)}|v_\\beta\\rangle) = r_o^{(k)}|v_\\alpha o_\\beta\\rangle + r_{oo}^{v,(k)}|v_\\alpha v_\\beta\\rangle$。\n与 $\\langle\\tilde{\\Psi}_0^N|$ 做内积：\n$$\nd_{v_\\alpha}^{(k)} = \\left((1-\\ell t)\\langle\\Phi_0| + \\ell\\langle v_\\alpha v_\\beta|\\right) \\left(r_o^{(k)}|v_\\alpha o_\\beta\\rangle + r_{oo}^{v,(k)}|v_\\alpha v_\\beta\\rangle\\right)\n$$\n$$\nd_{v_\\alpha}^{(k)} = (1-\\ell t)r_o^{(k)}\\langle\\Phi_0|v_\\alpha o_\\beta\\rangle + (1-\\ell t)r_{oo}^{v,(k)}\\langle\\Phi_0|v_\\alpha v_\\beta\\rangle + \\ell r_o^{(k)}\\langle v_\\alpha v_\\beta|v_\\alpha o_\\beta\\rangle + \\ell r_{oo}^{v,(k)}\\langle v_\\alpha v_\\beta|v_\\alpha v_\\beta\\rangle\n$$\n唯一的非零内积是 $\\langle v_\\alpha v_\\beta|v_\\alpha v_\\beta\\rangle=1$。\n$$\nd_{v_\\alpha}^{(k)} = \\ell r_{oo}^{v,(k)}\n$$\n\n戴森范数的计算：\n\n戴森范数为 $S^{(k)} = \\sum_{p \\in \\{o_\\alpha,\\, v_\\alpha\\}} |d_{p}^{(k)}|^2 = |d_{o_\\alpha}^{(k)}|^2 + |d_{v_\\alpha}^{(k)}|^2$。\n代入推导出的表达式：\n$$\nS^{(k)} = \\left((1-\\ell t)r_o^{(k)}\\right)^2 + \\left(\\ell r_{oo}^{v,(k)}\\right)^2\n$$\n给定参数：$t=0.30$，$\\ell=0.25$。\n项 $(1-\\ell t) = 1 - (0.25)(0.30) = 1 - 0.075 = 0.925$。\n\n对于态 $k=1$：$(r_o^{(1)})^2 = 0.81$ 且 $(r_{oo}^{v,(1)})^2 = 0.19$。\n$$\nS^{(1)} = (0.925)^2 (r_o^{(1)})^2 + (0.25)^2 (r_{oo}^{v,(1)})^2 = (0.855625)(0.81) + (0.0625)(0.19)\n$$\n$$\nS^{(1)} = 0.69305625 + 0.011875 = 0.70493125 \\approx 0.7049\n$$\n\n对于态 $k=2$：$(r_o^{(2)})^2 = 0.19$ 且 $(r_{oo}^{v,(2)})^2 = 0.81$。\n$$\nS^{(2)} = (0.925)^2 (r_o^{(2)})^2 + (0.25)^2 (r_{oo}^{v,(2)})^2 = (0.855625)(0.19) + (0.0625)(0.81)\n$$\n$$\nS^{(2)} = 0.16256875 + 0.050625 = 0.21319375 \\approx 0.2132\n$$\n\n解释：\n\n在没有电子相关（即纯粹的 Hartree-Fock 描述）的情况下，基态是单一行列式，电离态是纯单空穴态，初级电离的戴森范数 $S^{(k)}$ 将恰好为 $1$。这表明电离产生的空穴完全对应于单个自旋轨道。\n\n$S^{(k)}$ 对 1 的偏离是电子相关以及这种简单单粒子图像失效的直接体现。\n1.  **基态相关 ($t \\ne 0$) 和双正交性 ($\\ell \\ne 0$)：** 因子 $(1-\\ell t)$ 出现在 $d_{o_\\alpha}^{(k)}$ 中，表明基态的多组态特征（通过 $t$）以及左右 CC 态之间的不对称性（通过 $\\ell$）都减小了与简单单空穴图像的重叠。\n2.  **电离态中的摇动特征 ($r_{oo}^{v,(k)} \\ne 0$)：** 在一个相关体系中，从一个轨道电离可以同时引起另一个电子的激发（一个“摇动”过程）。这由 $r_{oo}^{v,(k)}$ 振幅捕捉，它描述了电离态的 $2h1p$ 组分。因此，初级单空穴移除的总强度被分配到多个最终态中。态 $k=1$ 主要是一个单空穴态（$(r_o^{(1)})^2=0.81$），但由于相关效应以及与其他态共享强度，其范数 $S^{(1)} \\approx 0.70$ 小于 $1$。态 $k=2$ 是一个“卫星”峰，主要具有摇动特征（$(r_{oo}^{v,(2)})^2=0.81$），它“借用”了剩余的强度，其范数 $S^{(2)} \\approx 0.21$。因此，$S^{(k)}<1$ 这个事实是电离过程偏离从单个平均场轨道移除电子的简单图像程度的定量度量。", "answer": "$$\\boxed{\\begin{pmatrix} 0.7049  & 0.2132 \\end{pmatrix}}$$", "id": "2632902"}, {"introduction": "从理论转向计算，这个练习将挑战您实现一种算法，用于从普遍的关联波函数中计算特定轨道的光谱因子 [@problem_id:2794748]。这项编程实践任务将巩固您对如何将抽象的组态相互作用 (CI) 展开式与光电子能谱中观测到的特定电离通道强度联系起来的理解，其中也包括了费米子符号规则的关键作用。", "problem": "构建一个程序，用于计算从相关波函数中移除一个电子到最低能量阳离子态（第一次电离）的光谱因子，并量化其与实验光电子能谱（PES）强度的符合程度。推导必须从单电子移除格林函数和戴森轨道的定义开始。请使用以下基本原理和定义，不要假设任何简化公式。\n\n基本原理和定义：\n- 在 Lehmann 表示中，用于电子移除的单粒子格林函数将一个 $N$-电子体系的相关基态（表示为 $|\\Psi_{N} \\rangle$）与相关的 $(N-1)$-电子本征态 $|\\Psi_{N-1}^{k} \\rangle$ 联系起来，其跃迁振幅与湮灭算符 $\\hat{a}_{r}$ 的矩阵元成正比，该算符从自旋轨道 $r$ 中移除一个电子。从自旋轨道 $r$ 移除电子进入态 $k$ 的光谱因子为 $Z_{k}(r) = |\\langle \\Psi_{N-1}^{k} | \\hat{a}_{r} | \\Psi_{N} \\rangle|^{2}$。\n- 跃迁 $k$ 的戴森轨道定义为 $\\psi^{\\text{Dyson}}_{k}(\\mathbf{x}) = \\sqrt{N}\\int d\\mathbf{x}_{2}\\cdots d\\mathbf{x}_{N}\\, \\Psi_{N}(\\mathbf{x},\\mathbf{x}_{2},\\ldots,\\mathbf{x}_{N})\\,\\Psi^{*}_{N-1,k}(\\mathbf{x}_{2},\\ldots,\\mathbf{x}_{N})$，光谱因子等于戴森轨道的平方范数，即 $Z_{k} = \\int d\\mathbf{x}\\,|\\psi^{\\text{Dyson}}_{k}(\\mathbf{x})|^{2}$。在正交归一的自旋轨道基中，这等于相应湮灭算符矩阵元的模的平方。\n- 在一个长度为 $L$ 的公共正交归一自旋轨道基 $\\{\\phi_{0},\\ldots,\\phi_{L-1}\\}$ 中，用长度为 $L$ 的比特串表示斯莱特行列式，其中最左边的比特是轨道索引 $0$，最右边的比特是轨道索引 $L-1$。比特值为 $1$ 表示占据，为 $0$ 表示空缺。相关的 $N$-电子基态和相关的 $(N-1)$-电子阳离子态 $k$ 展开为：\n$$\n|\\Psi_{N} \\rangle = \\sum_{I} C^{(N)}_{I} |\\Phi_{I} \\rangle, \n\\qquad\n|\\Psi_{N-1}^{k} \\rangle = \\sum_{J} C^{(N-1,k)}_{J} |\\Phi_{J} \\rangle,\n$$\n其中 $|\\Phi_{I} \\rangle$ 和 $|\\Phi_{J} \\rangle$ 是编码为比特串的斯莱特行列式，系数集已归一化，使得 $\\sum_{I} |C^{(N)}_{I}|^{2} = 1$ 和 $\\sum_{J} |C^{(N-1,k)}_{J}|^{2} = 1$。\n- 从行列式 $|\\Phi_{I} \\rangle$ 中移除自旋轨道 $r$ 上的一个电子所产生的费米子符号，由索引小于 $r$ 的已占据自旋轨道的数量的宇称决定。如果 $p$ 是比特串 $I$ 在位置 $r$ 之前的前缀中 $1$ 的数量，那么\n$$\n\\langle \\Phi_{J} | \\hat{a}_{r} | \\Phi_{I} \\rangle = \n\\begin{cases}\n(-1)^{p},  \\text{如果 } J \\text{ 是 } I \\text{ 在位置 } r \\text{ 的比特从 } 1 \\text{ 变为 } 0 \\text{ 后的结果}, \\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n- 相关态之间的湮灭算符矩阵元简化为：\n$$\nA_{k}(r) \\equiv \\langle \\Psi_{N-1}^{k} | \\hat{a}_{r} | \\Psi_{N} \\rangle\n= \\sum_{I:\\, I_{r}=1} C^{(N)}_{I}\\, (-1)^{p(I,r)}\\, C^{(N-1,k)}_{I\\setminus r},\n$$\n其中 $I_{r}$ 是位置 $r$ 处的比特，$p(I,r)$ 是 $I$ 中索引小于 $r$ 的 $1$ 的数量，$I\\setminus r$ 是将 $I$ 中位置 $r$ 的比特设为零得到的比特串。光谱因子是 $Z_{k}(r) = |A_{k}(r)|^{2}$。\n- 与实验的比较通过理论光谱因子 $Z_{k}(r)$ 和测量的第一能带 PES 强度 $I_{\\text{exp}}$ 之间的绝对偏差来进行。强度是无量纲的，您必须以非负实数的形式报告偏差。\n\n您的任务：\n- 基于以上基础，为下述每个测试案例，实现针对第一次电离通道的 $Z_{k=0}(r)$ 的计算。对于每个测试案例，计算绝对偏差 $\\Delta = |Z_{k=0}(r) - I_{\\text{exp}}|$。\n- 所有强度都是无量纲的，必须照此处理。\n- 这个问题不涉及角度。\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个测试案例的值对 $[Z_{k=0}(r), \\Delta]$，并将其平铺成一个单一列表。每个浮点值必须四舍五入到六位小数。例如，对于两个测试案例，这将作为单行打印：$[Z_{1},\\Delta_{1},Z_{2},\\Delta_{2}]$。\n\n测试套件：\n- 案例1（典型的相关效应降低强度）：\n    - $L = 6$, $r = 2$\n    - $|\\Psi_{N} \\rangle$: $\\{(\"111000\", \\sqrt{0.85}),\\, (\"110100\", \\sqrt{0.15})\\}$\n    - $|\\Psi_{N-1}^{0} \\rangle$: $\\{(\"110000\", \\sqrt{0.90}),\\, (\"100100\", \\sqrt{0.10})\\}$\n    - $I_{\\text{exp}} = 0.76$\n- 案例2（类 Hartree–Fock 的首次电离，单位重叠）：\n    - $L = 4$, $r = 1$\n    - $|\\Psi_{N} \\rangle$: $\\{(\"1100\", 1.0)\\}$\n    - $|\\Psi_{N-1}^{0} \\rangle$: $\\{(\"1000\", 1.0)\\}$\n    - $I_{\\text{exp}} = 1.0$\n- 案例3（卫星峰主导的第一能带，主线权重小）：\n    - $L = 6$, $r = 2$\n    - $|\\Psi_{N} \\rangle$: $\\{(\"111000\", \\sqrt{0.20}),\\, (\"110100\", \\sqrt{0.50}),\\, (\"100110\", \\sqrt{0.30})\\}$\n    - $|\\Psi_{N-1}^{0} \\rangle$: $\\{(\"110000\", \\sqrt{0.10}),\\, (\"100100\", \\sqrt{0.60}),\\, (\"000110\", \\sqrt{0.30})\\}$\n    - $I_{\\text{exp}} = 0.05$\n- 案例4（边界情况：从未占据轨道移除电子得到零强度）：\n    - $L = 5$, $r = 1$\n    - $|\\Psi_{N} \\rangle$: $\\{(\"10010\", 1.0)\\}$\n    - $|\\Psi_{N-1}^{0} \\rangle$: $\\{(\"10000\", 0.8),\\, (\"00010\", 0.6)\\}$，注意 $0.8^{2} + 0.6^{2} = 1$\n    - $I_{\\text{exp}} = 0.0$\n\n最终输出格式：\n- 您的程序应精确产生一行输出：\n- 该行必须是单个列表：$[Z_{1}, \\Delta_{1}, Z_{2}, \\Delta_{2}, Z_{3}, \\Delta_{3}, Z_{4}, \\Delta_{4}]$，每个值四舍五入到六位小数，无额外文本。", "solution": "所述问题具有科学依据，提法明确且客观。它基于多体量子化学的标准原理，特别是一粒子格林函数理论和相关波函数的组态相互作用展开，提供了一套完整的定义和数据。任务是计算一个物理可观测量，即光谱因子，这是解释光电子能谱实验的基石。该问题是有效的，并且允许一个直接、明确的解决方案。\n\n中心任务是计算从相关的 $N$-电子基态 $|\\Psi_{N} \\rangle$ 移除自旋轨道 $r$ 上的一个电子，跃迁到 $(N-1)$-电子体系的第 $k$ 个末态 $|\\Psi_{N-1}^{k} \\rangle$ 的跃迁振幅 $A_k(r)$。对于本问题，我们关心的是第一次电离，因此我们考虑 $k=0$ 的末态，即 $|\\Psi_{N-1}^{0} \\rangle$。跃迁振幅定义为湮灭算符 $\\hat{a}_{r}$ 的矩阵元：\n$$\nA_{0}(r) = \\langle \\Psi_{N-1}^{0} | \\hat{a}_{r} | \\Psi_{N} \\rangle\n$$\n问题提供了初始和末尾相关态在斯莱特行列式 $|\\Phi_I \\rangle$ 基上的展开，这些行列式由比特串表示：\n$$\n|\\Psi_{N} \\rangle = \\sum_{I} C^{(N)}_{I} |\\Phi_{I} \\rangle\n\\qquad\n|\\Psi_{N-1}^{0} \\rangle = \\sum_{J} C^{(N-1,0)}_{J} |\\Phi_{J} \\rangle\n$$\n将这些展开代入 $A_{0}(r)$ 的表达式，并利用内积的线性性质，我们得到：\n$$\nA_{0}(r) = \\left\\langle \\sum_{J} C^{(N-1,0)}_{J} |\\Phi_{J} \\rangle \\middle| \\hat{a}_{r} \\middle| \\sum_{I} C^{(N)}_{I} |\\Phi_{I} \\rangle \\right\\rangle\n= \\sum_{I, J} (C^{(N-1,0)}_{J})^{*} C^{(N)}_{I} \\langle \\Phi_{J} | \\hat{a}_{r} | \\Phi_{I} \\rangle\n$$\n系数 $C$ 以实数形式给出，因此复共轭 $(C^{(N-1,0)}_{J})^{*}$ 就是 $C^{(N-1,0)}_{J}$。矩阵元 $\\langle \\Phi_{J} | \\hat{a}_{r} | \\Phi_{I} \\rangle$ 仅在特定条件下非零，这些条件由费米子反对易关系决定。电子必须存在于行列式 $|\\Phi_{I} \\rangle$ 的自旋轨道 $r$ 中（即比特 $I_r$ 必须为 $1$），并且末态行列式 $|\\Phi_{J} \\rangle$ 必须与从 $|\\Phi_{I} \\rangle$ 中移除自旋轨道 $r$ 上的电子后得到的行列式相同。这意味着比特串 $J$ 是通过将 $I$ 在位置 $r$ 处的比特从 $1$ 翻转为 $0$ 得到的。我们将这个结果比特串表示为 $I\\setminus r$。这个非零矩阵元的值是费米子符号 $(-1)^{p(I,r)}$，其中 $p(I,r)$ 是行列式 $|\\Phi_{I} \\rangle$ 中索引小于 $r$ 的已占据自旋轨道的数量。\n\n这些条件将对 $I$ 和 $J$ 的双重求和简化为对构成 $|\\Psi_N \\rangle$ 展开且自旋轨道 $r$ 被占据的行列式 $I$ 的单重求和。这得到了问题陈述中提供的公式：\n$$\nA_{0}(r) = \\sum_{I:\\, I_{r}=1} C^{(N)}_{I}\\, C^{(N-1,0)}_{I\\setminus r}\\, (-1)^{p(I,r)}\n$$\n请注意，如果在 $|\\Psi_{N-1}^{0} \\rangle$ 的展开中未明确列出所需的行列式 $I\\setminus r$，则其系数 $C^{(N-1,0)}_{I\\setminus r}$ 被视为零，该项对总和没有贡献。\n\n一旦计算出 $A_{0}(r)$，光谱因子 $Z_{k=0}(r)$ 就是其模的平方：\n$$\nZ_{0}(r) = |A_{0}(r)|^{2}\n$$\n最后，与实验强度 $I_{\\text{exp}}$ 的绝对偏差 $\\Delta$ 计算如下：\n$$\n\\Delta = |Z_{0}(r) - I_{\\text{exp}}|\n$$\n此过程系统地应用于每个测试案例。作为示例，我们详细说明案例1的计算过程：\n- 给定：$L = 6$, $r = 2$。\n- $|\\Psi_{N} \\rangle$ 展开：$\\{(\"111000\", \\sqrt{0.85}),\\, (\"110100\", \\sqrt{0.15})\\}$\n- $|\\Psi_{N-1}^{0} \\rangle$ 展开：$\\{(\"110000\", \\sqrt{0.90}),\\, (\"100100\", \\sqrt{0.10})\\}$\n- $I_{\\text{exp}} = 0.76$\n\n我们对 $|\\Psi_{N} \\rangle$ 的分量求和：\n1. 考虑第一个行列式 $I_1 = \"111000\"$，系数为 $C^{(N)}_{I_1} = \\sqrt{0.85}$。索引 $r=2$ 处的比特是 '1'，所以此项有贡献。\n- 前缀是 \"11\"，所以在索引 $2$ 之前被占据的轨道数为 $p(I_1, 2) = 2$。符号为 $(-1)^{2} = +1$。\n- $(N-1)$-电子空间中的目标行列式是 $I_1\\setminus 2 = \"110000\"$。我们在 $|\\Psi_{N-1}^{0} \\rangle$ 的展开中查找此行列式。它存在，系数为 $C^{(N-1,0)}_{\"110000\"} = \\sqrt{0.90}$。\n- 此项的贡献是 $(\\sqrt{0.85}) \\times (\\sqrt{0.90}) \\times (+1) = \\sqrt{0.765}$。\n\n2. 考虑第二个行列式 $I_2 = \"110100\"$。索引 $r=2$ 处的比特是 '0'，所以此项对求和没有贡献。\n\n总振幅是所有贡献的总和：$A_{0}(2) = \\sqrt{0.765}$。\n光谱因子是 $Z_{0}(2) = (\\sqrt{0.765})^{2} = 0.765$。\n偏差是 $\\Delta = |0.765 - 0.76| = 0.005$。\n\n此精确算法被应用于所有测试案例。每个案例的结果被计算并按要求格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectroscopic factors and deviations for a set of test cases\n    based on correlated wavefunction expansions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"r\": 2,\n            \"psi_n\": {\n                \"111000\": np.sqrt(0.85),\n                \"110100\": np.sqrt(0.15),\n            },\n            \"psi_n_minus_1\": {\n                \"110000\": np.sqrt(0.90),\n                \"100100\": np.sqrt(0.10),\n            },\n            \"i_exp\": 0.76,\n        },\n        # Case 2\n        {\n            \"r\": 1,\n            \"psi_n\": {\"1100\": 1.0},\n            \"psi_n_minus_1\": {\"1000\": 1.0},\n            \"i_exp\": 1.0,\n        },\n        # Case 3\n        {\n            \"r\": 2,\n            \"psi_n\": {\n                \"111000\": np.sqrt(0.20),\n                \"110100\": np.sqrt(0.50),\n                \"100110\": np.sqrt(0.30),\n            },\n            \"psi_n_minus_1\": {\n                \"110000\": np.sqrt(0.10),\n                \"100100\": np.sqrt(0.60),\n                \"000110\": np.sqrt(0.30),\n            },\n            \"i_exp\": 0.05,\n        },\n        # Case 4\n        {\n            \"r\": 1,\n            \"psi_n\": {\"10010\": 1.0},\n            \"psi_n_minus_1\": {\"10000\": 0.8, \"00010\": 0.6},\n            \"i_exp\": 0.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        r = case[\"r\"]\n        psi_n_coeffs = case[\"psi_n\"]\n        psi_n_minus_1_coeffs = case[\"psi_n_minus_1\"]\n        i_exp = case[\"i_exp\"]\n\n        # Calculate the transition amplitude A_k(r)\n        A_k_r = 0.0\n        # Sum over determinants I in the N-electron state expansion\n        for I_str, C_I in psi_n_coeffs.items():\n            # Check if the orbital at position r is occupied\n            if I_str[r] == '1':\n                # Calculate the parity p(I,r) for the fermionic sign\n                p = I_str[:r].count('1')\n                sign = (-1)**p\n\n                # Construct the (N-1)-electron determinant J = I \\ r\n                J_str = I_str[:r] + '0' + I_str[r+1:]\n\n                # Get the coefficient for J, which is 0 if not in the expansion\n                C_J = psi_n_minus_1_coeffs.get(J_str, 0.0)\n\n                # Add the contribution to the total amplitude\n                A_k_r += C_I * C_J * sign\n\n        # Calculate the spectroscopic factor Z = |A_k(r)|^2\n        Z = A_k_r**2\n\n        # Calculate the absolute deviation Delta = |Z - I_exp|\n        Delta = abs(Z - i_exp)\n\n        # Append the flattened pair of results for this case\n        results.append(Z)\n        results.append(Delta)\n\n    # Print the final list in the specified format with 6 decimal places.\n    print(f\"[{','.join(f'{val:.6f}' for val in results)}]\")\n\nsolve()\n```", "id": "2794748"}, {"introduction": "在前一个练习的基础上，本练习将重点放在计算总极点强度上，即完整戴森轨道的模方 [@problem_id:2887479]。通过构建光谱振幅的完整向量，您将更深刻地体会到戴森轨道作为一个统一的整体，其范数可以量化单电子跃迁的总强度。这个任务突出了量子干涉等现象如何影响整体光谱信号。", "problem": "一个电子体系在大小为 $M$ 的正交自旋轨道基中被描述，该基由整数 $p \\in \\{0,1,\\dots,M-1\\}$ 索引。多电子态在由 Slater 行列式构成的有限组态相互作用 (Configuration Interaction, CI) 基中展开，这些 Slater 行列式是通过以固定的正则顺序将产生算符作用于真空态来构建的。产生和湮灭算符满足正则反对易关系 $\\{ \\hat{a}_p, \\hat{a}_q^\\dagger \\} = \\delta_{pq}$ 和 $\\{ \\hat{a}_p, \\hat{a}_q \\} = \\{ \\hat{a}_p^\\dagger, \\hat{a}_q^\\dagger \\} = 0$。当 Slater 行列式由按升序索引的产生算符作用于真空态来定义时，它们是正交的，并且符号约定遵循费米子反对易关系。Dyson 轨道编码了从一个 $N$ 电子态中移出一个电子，从而产生一个 $(N-1)$ 电子离子化态的光谱振幅，其模方（通常称为极点强度）在突变近似下量化了相应单电子电离通道的强度。你的任务是实现一个计算工作流，从上述算符代数和行列式的正交性出发，为在 CI 中展开的 $N$ 和 $(N-1)$ 电子态，在给定的自旋轨道基中构建光谱振幅，并返回 Dyson 轨道的模方。\n\n程序要求：\n- 使用一种表示方法，其中每个 Slater 行列式被编码为一个关于 $M$ 个自旋轨道的整数位串，如果自旋轨道 $p$ 被占据，则位 $p$ 等于 $1$，否则为 $0$；自旋轨道的正则排序为 $0 < 1 < \\dots < M-1$。\n- 每个多电子态以一对（位串，系数）的列表形式给出，其中系数为复数，并已归一化，使得总概率振幅的模方和为 $1$。\n- 对于每个测试用例，计算光谱振幅向量（在给定自旋轨道基中的 Dyson 轨道系数），然后计算该向量的模方（极点强度）。极点强度是 $[0,1]$ 区间内的一个实标量。\n- 不涉及物理单位。\n- 你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3]$），其中每个 $x_i$ 是测试用例 $i$ 的极点强度，四舍五入到恰好 $6$ 位小数。\n\n使用的基本原理：\n- 费米子产生和湮灭算符的正则反对易关系：$\\{ \\hat{a}_p, \\hat{a}_q^\\dagger \\} = \\delta_{pq}$，$\\{ \\hat{a}_p, \\hat{a}_q \\} = 0$，$\\{ \\hat{a}_p^\\dagger, \\hat{a}_q^\\dagger \\} = 0$。\n- 由正交自旋轨道基按正则顺序构建的 Slater 行列式的正交性。\n- Dyson 轨道定义为在移出一个电子后，$N$ 电子态和 $(N-1)$ 电子态之间的单电子重叠；光谱振幅是它在所选自旋轨道基中的展开系数。\n\n测试套件：\n- 测试用例 $1$（基准闭壳层移除）：\n  - $M = 4$。\n  - $N$ 电子态：一个行列式，占据集为 $\\{0,1\\}$，系数为 $1$。\n  - $(N-1)$ 电子态：一个行列式，占据集为 $\\{1\\}$，系数为 $1$。\n  - 预期定性行为：对应于从自旋轨道 $0$ 移除电子的单个非零光谱振幅，极点强度接近 $1$。\n- 测试用例 $2$（相关中性态，单离子通道）：\n  - $M = 4$。\n  - $N$ 电子态：两个行列式，占据集分别为 $\\{0,1\\}$ 和 $\\{0,2\\}$，系数分别为 $\\sqrt{0.6}$ 和 $\\sqrt{0.4}$。\n  - $(N-1)$ 电子态：一个行列式，占据集为 $\\{1\\}$，系数为 $1$。\n  - 预期定性行为：光谱振幅主要由 $\\{0,1\\}$ 分量贡献，极点强度接近 $0.6$。\n- 测试用例 $3$（相关的中性态和离子态，多通道和来自费米子宇称的符号）：\n  - $M = 4$。\n  - $N$ 电子态：两个行列式，占据集分别为 $\\{0,2\\}$ 和 $\\{1,2\\}$，每个系数均为 $1/\\sqrt{2}$。\n  - $(N-1)$ 电子态：两个行列式，占据集分别为 $\\{2\\}$ 和 $\\{0\\}$，每个系数均为 $1/\\sqrt{2}$。\n  - 预期定性行为：多个具有非平凡费米子符号的非零光谱振幅，极点强度严格介于 $0$ 和 $1$ 之间。\n- 测试用例 $4$（相位引起的相消干涉）：\n  - $M = 4$。\n  - $N$ 电子态：两个行列式，占据集分别为 $\\{0,1\\}$ 和 $\\{0,2\\}$，每个系数均为 $1/\\sqrt{2}$。\n  - $(N-1)$ 电子态：两个行列式，占据集分别为 $\\{1\\}$ 和 $\\{2\\}$，系数分别为 $1/\\sqrt{2}$ 和 $-1/\\sqrt{2}$。\n  - 预期定性行为：从自旋轨道 $0$ 移除时发生相消干涉，极点强度可能为零。\n\n输出规格：\n- 程序必须输出单行，包含一个 Python 风格的列表，其中有 4 个浮点数，按顺序对应于测试用例 1 到 4 的极点强度，每个数都四舍五入到恰好 6 位小数，例如 $[x_1,x_2,x_3,x_4]$。", "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于量子力学和多体理论的原理，特别是关于组态相互作用 (CI) 波函数和单电子传播子理论。该问题定义良好，为计算指定物理量（光谱极点强度）提供了所有必要的数据和定义。语言客观而精确。因此，有必要提供一个解决方案。\n\n中心任务是计算光谱振幅，即 Dyson 轨道在给定自旋轨道基中的系数。Dyson 轨道描述了因湮灭单个电子而产生的 $N$ 电子态 $|\\Psi_N\\rangle$ 和 $(N-1)$ 电子态 $|\\Psi_{N-1}\\rangle$ 之间的重叠。对应于从自旋轨道 $p$ 湮灭一个电子的光谱振幅 $\\gamma_p$ 定义为矩阵元：\n$$\n\\gamma_p = \\langle \\Psi_{N-1} | \\hat{a}_p | \\Psi_N \\rangle\n$$\n其中 $\\hat{a}_p$ 是自旋轨道 $p$ 的湮灭算符。\n\n态 $|\\Psi_N\\rangle$ 和 $|\\Psi_{N-1}\\rangle$ 以 Slater 行列式 $\\{|\\Phi_I\\rangle\\}$ 为基，通过 CI 展开给出：\n$$\n|\\Psi_N\\rangle = \\sum_I C_I |\\Phi_I^N\\rangle\n$$\n$$\n|\\Psi_{N-1}\\rangle = \\sum_J D_J |\\Phi_J^{N-1}\\rangle\n$$\n此处，$C_I$ 和 $D_J$ 是复系数，而 $|\\Phi_I^N\\rangle$ 和 $|\\Phi_J^{N-1}\\rangle$ 分别是 $N$ 和 $N-1$ 电子的 Slater 行列式。\n\n将这些展开式代入 $\\gamma_p$ 的定义并利用线性性质，得到：\n$$\n\\gamma_p = \\left\\langle \\sum_J D_J \\Phi_J^{N-1} \\right| \\hat{a}_p \\left| \\sum_I C_I \\Phi_I^N \\right\\rangle = \\sum_{I,J} D_J^* C_I \\langle \\Phi_J^{N-1} | \\hat{a}_p | \\Phi_I^N \\rangle\n$$\n因此，问题简化为计算湮灭算符在 Slater 行列式对之间的矩阵元。\n\n一个 Slater 行列式 $|\\Phi_I^N\\rangle$，由占据自旋轨道集 $I = \\{i_1, i_2, \\dots, i_N\\}$（其中 $i_1  i_2  \\dots  i_N$）定义，是通过将产生算符按正则升序作用于真空态 $|0\\rangle$ 来构建的：$|\\Phi_I^N\\rangle = \\hat{a}_{i_N}^\\dagger \\dots \\hat{a}_{i_2}^\\dagger \\hat{a}_{i_1}^\\dagger |0\\rangle$。$\\hat{a}_p$ 对 $|\\Phi_I^N\\rangle$ 的作用仅当自旋轨道 $p$ 在 $|\\Phi_I^N\\rangle$ 中被占据时（即 $p \\in I$）才非零。如果 $p \\notin I$，$\\hat{a}_p$ 与所有产生算符 $\\hat{a}_{i_k}^\\dagger$ 反对易，并作用于真空态，得到 $\\hat{a}_p|0\\rangle=0$。\n\n如果 $p \\in I$，设 $p = i_k$，我们必须将 $\\hat{a}_p$ 穿过产生算符序列，移至其对应的伴随算符 $\\hat{a}_p^\\dagger$ 旁。它与 $k-1$ 个算符 $\\hat{a}_{i_1}^\\dagger, \\dots, \\hat{a}_{i_{k-1}}^\\dagger$ 反对易，获得一个 $(-1)^{k-1}$ 的符号。利用反对易关系 $\\{\\hat{a}_p, \\hat{a}_p^\\dagger\\}=1$，我们发现：\n$$\n\\hat{a}_p |\\Phi_I^N\\rangle = (-1)^{S(I,p)} |\\Phi_{I \\setminus \\{p\\}}^{N-1}\\rangle\n$$\n其中 $S(I, p)$ 是 $I$ 中索引小于 $p$ 的占据自旋轨道的数量。所得态 $|\\Phi_{I \\setminus \\{p\\}}^{N-1}\\rangle$ 是对应于轨道集 $I$ 除去 $p$ 后的 $(N-1)$ 电子行列式。\n\n矩阵元变为：\n$$\n\\langle \\Phi_J^{N-1} | \\hat{a}_p | \\Phi_I^N \\rangle = (-1)^{S(I,p)} \\langle \\Phi_J^{N-1} | \\Phi_{I \\setminus \\{p\\}}^{N-1} \\rangle\n$$\n由于 Slater 行列式基的正交性，$\\langle \\Phi_J^{N-1} | \\Phi_{K}^{N-1} \\rangle = \\delta_{JK}$。因此，矩阵元非零的充要条件是 $p \\in I$ 且 $J = I \\setminus \\{p\\}$，此时其值为 $(-1)^{S(I,p)}$。\n\n这一物理形式通过使用指定的整数位串表示法来计算实现。对于由整数 `det_I` 表示的行列式，以下对应关系成立：\n1.  条件 $p \\in I$ 等价于检查第 $p$ 位是否被设置：`(det_I  p)  1 == 1`。\n2.  所得行列式 $|\\Phi_{I \\setminus \\{p\\}}^{N-1}\\rangle$ 由整数 `det_I ^ (1  p)` 表示，其中 `^` 是按位异或运算符。\n3.  符号指数 $S(I, p)$ 是 `det_I` 中位置小于 $p$ 的位的种群计数（置位比特数）。这可以计算为 `det_I  ((1  p) - 1)` 的种群计数。\n\n计算算法如下：\n1.  对每个测试用例，提供 $|\\Psi_N\\rangle$ 和 $|\\Psi_{N-1}\\rangle$ 的 CI 展开。将 $(N-1)$ 电子态转换为哈希映射（字典）以实现高效查找，将每个行列式的位串映射到其复系数。\n2.  初始化一个大小为 $M$ 的向量 $\\gamma$ 为零，用于存储 Dyson 轨道系数。\n3.  遍历每个自旋轨道索引 $p$，从 $0$ 到 $M-1$。\n4.  对于每个 $p$，遍历 $|\\Psi_N\\rangle$ 展开中的每一对行列式-系数 $(C_I, |\\Phi_I^N\\rangle)$。\n5.  如果自旋轨道 $p$ 在 $|\\Phi_I^N\\rangle$ 中被占据，则计算目标 $(N-1)$ 电子行列式的位串和费米子符号。\n6.  在 $|\\Psi_{N-1}\\rangle$ 的哈希映射中查找目标行列式。如果找到，则检索其系数 $D_J$。\n7.  将贡献 $D_J^* C_I (-1)^{S(I,p)}$ 加到 $\\gamma_p$ 上。\n8.  遍历完所有贡献后，向量 $\\gamma = (\\gamma_0, \\gamma_1, ..., \\gamma_{M-1})$ 就是自旋轨道基中完整的 Dyson 轨道。\n\n最后，计算极点强度 $P$，即 Dyson 轨道的模方：\n$$\nP = \\sum_{p=0}^{M-1} |\\gamma_p|^2 = \\gamma^\\dagger \\gamma\n$$\n将此过程应用于每个测试用例，以产生所需的极点强度。实现将使用 `numpy` 进行复数算术和向量运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the pole strength for the four test cases.\n    \"\"\"\n\n    def get_bitstring_from_occupied_set(occ_set):\n        \"\"\"Converts a set of occupied orbital indices to a bitstring integer.\"\"\"\n        bs = 0\n        for p in occ_set:\n            bs |= (1  p)\n        return bs\n\n    def calculate_pole_strength(M, psi_N_tuples, psi_N_minus_1_tuples):\n        \"\"\"\n        Calculates the pole strength for given N- and (N-1)-electron states.\n\n        Args:\n            M (int): The size of the spin-orbital basis.\n            psi_N_tuples (list): CI expansion for the N-electron state. A list of\n                                 tuples (bitstring, coefficient).\n            psi_N_minus_1_tuples (list): CI expansion for the (N-1)-electron state.\n                                         A list of tuples (bitstring, coefficient).\n\n        Returns:\n            float: The calculated pole strength.\n        \"\"\"\n        psi_N_minus_1_map = {det: coeff for det, coeff in psi_N_minus_1_tuples}\n        dyson_orbital = np.zeros(M, dtype=np.complex128)\n\n        for p in range(M):\n            gamma_p = 0.0 + 0.0j\n            for det_I, C_I in psi_N_tuples:\n                if (det_I >> p)  1:\n                    det_target = det_I ^ (1  p)\n                    if det_target in psi_N_minus_1_map:\n                        D_J = psi_N_minus_1_map[det_target]\n                        mask = (1  p) - 1\n                        lower_bits = det_I  mask\n                        popcount = bin(lower_bits).count('1')\n                        sign = 1.0 if popcount % 2 == 0 else -1.0\n                        gamma_p += np.conj(D_J) * C_I * sign\n            dyson_orbital[p] = gamma_p\n        \n        pole_strength = np.sum(np.abs(dyson_orbital)**2)\n        return pole_strength\n\n    # Test Case 1\n    M1 = 4\n    psi_N1 = [(get_bitstring_from_occupied_set({0, 1}), 1.0 + 0.0j)]\n    psi_N_minus_1_1 = [(get_bitstring_from_occupied_set({1}), 1.0 + 0.0j)]\n    \n    # Test Case 2\n    M2 = 4\n    psi_N2 = [\n        (get_bitstring_from_occupied_set({0, 1}), np.sqrt(0.6) + 0.0j),\n        (get_bitstring_from_occupied_set({0, 2}), np.sqrt(0.4) + 0.0j)\n    ]\n    psi_N_minus_1_2 = [(get_bitstring_from_occupied_set({1}), 1.0 + 0.0j)]\n    \n    # Test Case 3\n    M3 = 4\n    psi_N3 = [\n        (get_bitstring_from_occupied_set({0, 2}), 1/np.sqrt(2) + 0.0j),\n        (get_bitstring_from_occupied_set({1, 2}), 1/np.sqrt(2) + 0.0j)\n    ]\n    psi_N_minus_1_3 = [\n        (get_bitstring_from_occupied_set({2}), 1/np.sqrt(2) + 0.0j),\n        (get_bitstring_from_occupied_set({0}), 1/np.sqrt(2) + 0.0j)\n    ]\n    \n    # Test Case 4\n    M4 = 4\n    psi_N4 = [\n        (get_bitstring_from_occupied_set({0, 1}), 1/np.sqrt(2) + 0.0j),\n        (get_bitstring_from_occupied_set({0, 2}), 1/np.sqrt(2) + 0.0j)\n    ]\n    psi_N_minus_1_4 = [\n        (get_bitstring_from_occupied_set({1}), 1/np.sqrt(2) + 0.0j),\n        (get_bitstring_from_occupied_set({2}), -1/np.sqrt(2) + 0.0j)\n    ]\n\n    results = [\n        calculate_pole_strength(M1, psi_N1, psi_N_minus_1_1),\n        calculate_pole_strength(M2, psi_N2, psi_N_minus_1_2),\n        calculate_pole_strength(M3, psi_N3, psi_N_minus_1_3),\n        calculate_pole_strength(M4, psi_N4, psi_N_minus_1_4)\n    ]\n    \n    print(f\"[{','.join(f'{val:.6f}' for val in results)}]\")\n\nsolve()\n```", "id": "2887479"}]}