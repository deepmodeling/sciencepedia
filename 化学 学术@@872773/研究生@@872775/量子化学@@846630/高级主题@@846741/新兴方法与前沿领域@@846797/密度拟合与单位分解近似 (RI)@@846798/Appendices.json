{"hands_on_practices": [{"introduction": "密度拟合的一个核心思想是，轨道函数对的乘积所张成的空间远大于原始轨道函数本身所张成的空间。因此，一个精确的密度拟合需要一个规模更大、更灵活的辅助基组。这项练习将通过对一个具体分子（水分子，$\\mathrm{H_2O}$）使用标准基组进行函数计数，让你亲手验证并量化这一原理 [@problem_id:2916446]。", "problem": "考虑水分子 $\\mathrm{H_2O}$，使用 Karlsruhe def2 三$\\zeta$价层双极化 (def2-TZVPP) 轨道基组及其相关的库仑和交换拟合辅助基组 (def2/JK) 进行描述。在球谐函数表示下进行计算，每个角动量壳层贡献以下数量的函数：$s \\rightarrow 1$，$p \\rightarrow 3$，$d \\rightarrow 5$，$f \\rightarrow 7$，$g \\rightarrow 9$。一个收缩壳层贡献其角简并度一次，而一个非收缩辅助壳层贡献其角简并度乘以该壳层中原函数的数量。\n\n使用以下数据，这些数据反映了这些基组族的已发表构成，并为本问题的目的确保科学真实性：\n\n- 每个原子的轨道 (def2-TZVPP) 收缩壳层：\n  - 氧原子：$5\\,s$，$4\\,p$，$2\\,d$，$1\\,f$。\n  - 氢原子：$3\\,s$，$2\\,p$，$1\\,d$。\n- 每个原子的辅助 (def2/JK) 非收缩原函数：\n  - 氧原子：$12\\,s$，$9\\,p$，$6\\,d$，$3\\,f$，$1\\,g$。\n  - 氢原子：$6\\,s$，$3\\,p$，$1\\,d$。\n\n任务：\n- 使用球谐简并度，通过对所有原子和壳层求和，计算 $\\mathrm{H_2O}$ 的轨道基函数总数 $N_{\\text{orb}}$。\n- 将相同的简并度应用于所列的辅助原函数，计算 $\\mathrm{H_2O}$ 的辅助基函数总数 $N_{\\text{aux}}$。\n- 仅使用“密度拟合（也称为单位分解）在库仑度规下，在一个更大的辅助空间中近似轨道函数乘积”这一基本思想，简要地定性论证为何 $N_{\\text{aux}}$ 预期会超过 $N_{\\text{orb}}$。\n\n报告单一比率 $R = N_{\\text{aux}}/N_{\\text{orb}}$ 作为最终答案。将答案四舍五入到四位有效数字。不要包含单位。", "solution": "所述问题在科学上是合理的、自洽的且提法恰当。它为使用指定基组计算水分子 $\\mathrm{H_2O}$ 的轨道基函数和辅助基函数数量提供了清晰的定义和数据。在量子化学基组构建的背景下，计算函数数量的规则是明确的。因此，我们直接进行求解。\n\n任务是计算轨道基函数的总数 $N_{\\text{orb}}$、辅助基函数的总数 $N_{\\text{aux}}$，以及它们的比率 $R = N_{\\text{aux}}/N_{\\text{orb}}$。该体系包含一个氧原子和两个氢原子。将对每种原子类型进行计数，然后求和。\n\n首先，我们计算轨道基函数的数量 $N_{\\text{orb}}$。轨道基组是 def2-TZVPP 基组。该基组中的函数是收缩壳层。根据问题的规则，给定角动量 $l$ 的一个收缩壳层对总数贡献其球谐简并度 $2l+1$。\n\n相关角动量壳层的简并度如下：\n- $s$ 壳层 ($l=0$): $2(0)+1 = 1$ 个函数。\n- $p$ 壳层 ($l=1$): $2(1)+1 = 3$ 个函数。\n- $d$ 壳层 ($l=2$): $2(2)+1 = 5$ 个函数。\n- $f$ 壳层 ($l=3$): $2(3)+1 = 7$ 个函数。\n\n对于一个氧原子 (O)，其构成由 $5\\,s$、$4\\,p$、$2\\,d$ 和 $1\\,f$ 收缩壳层给出。氧原子上的轨道函数数量 $N_{\\text{orb}}(\\text{O})$ 为：\n$$N_{\\text{orb}}(\\text{O}) = (5 \\times 1) + (4 \\times 3) + (2 \\times 5) + (1 \\times 7) = 5 + 12 + 10 + 7 = 34$$\n\n对于一个氢原子 (H)，其构成为 $3\\,s$、$2\\,p$ 和 $1\\,d$ 收缩壳层。氢原子上的轨道函数数量 $N_{\\text{orb}}(\\text{H})$ 为：\n$$N_{\\text{orb}}(\\text{H}) = (3 \\times 1) + (2 \\times 3) + (1 \\times 5) = 3 + 6 + 5 = 14$$\n\n$\\mathrm{H_2O}$ 分子的轨道函数总数是一个氧原子和两个氢原子贡献之和：\n$$N_{\\text{orb}} = N_{\\text{orb}}(\\text{O}) + 2 \\times N_{\\text{orb}}(\\text{H}) = 34 + 2 \\times 14 = 34 + 28 = 62$$\n\n接下来，我们计算辅助基函数的数量 $N_{\\text{aux}}$。辅助基组是 def2/JK 拟合基组。这些以非收缩原函数的形式给出。规则规定每个原函数贡献其完整的角简并度。\n\n相关角动量壳层（包括 $g$ 壳层）的简并度如下：\n- $s$ 壳层 ($l=0$): $1$ 个函数。\n- $p$ 壳层 ($l=1$): $3$ 个函数。\n- $d$ 壳层 ($l=2$): $5$ 个函数。\n- $f$ 壳层 ($l=3$): $7$ 个函数。\n- $g$ 壳层 ($l=4$): $2(4)+1 = 9$ 个函数。\n\n对于一个氧原子 (O)，其辅助原函数构成为 $12\\,s$、$9\\,p$、$6\\,d$、$3\\,f$ 和 $1\\,g$。氧原子上的辅助函数数量 $N_{\\text{aux}}(\\text{O})$ 为：\n$$N_{\\text{aux}}(\\text{O}) = (12 \\times 1) + (9 \\times 3) + (6 \\times 5) + (3 \\times 7) + (1 \\times 9) = 12 + 27 + 30 + 21 + 9 = 99$$\n\n对于一个氢原子 (H)，其辅助原函数构成为 $6\\,s$、$3\\,p$ 和 $1\\,d$。氢原子上的辅助函数数量 $N_{\\text{aux}}(\\text{H})$ 为：\n$$N_{\\text{aux}}(\\text{H}) = (6 \\times 1) + (3 \\times 3) + (1 \\times 5) = 6 + 9 + 5 = 20$$\n\n$\\mathrm{H_2O}$ 分子的辅助函数总数是一个氧原子和两个氢原子贡献之和：\n$$N_{\\text{aux}} = N_{\\text{aux}}(\\text{O}) + 2 \\times N_{\\text{aux}}(\\text{H}) = 99 + 2 \\times 20 = 99 + 40 = 139$$\n\n问题要求对 $N_{\\text{aux}}$ 预期会超过 $N_{\\text{orb}}$ 这一事实进行定性论证。在密度拟合中，通过用辅助函数 $\\chi_{K}(\\mathbf{r})$ 的线性组合来近似轨道基函数的乘积 $\\phi_{\\mu}(\\mathbf{r})\\phi_{\\nu}(\\mathbf{r})$，从而简化了电子排斥积分。所有这些成对乘积的集合 $\\{\\phi_{\\mu}\\phi_{\\nu}\\}$ 张成一个比原始轨道基函数空间 $\\{\\phi_{\\mu}\\}$ 大得多的空间。唯一乘积的数量大致按 $\\frac{1}{2}N_{\\text{orb}}^2$ 的比例增长。为了给这个大得多的乘积空间提供一个稳健而准确的表示，辅助基组必须比轨道基组大得多且更灵活（即，收缩程度更低并包含更高角动量的函数）。因此，$N_{\\text{aux}} > N_{\\text{orb}}$ 是一项基本的设计原则，通常会发现 $N_{\\text{aux}}$ 比 $N_{\\text{orb}}$ 大 3 到 5 倍。\n\n最后，我们计算比率 $R = N_{\\text{aux}}/N_{\\text{orb}}$：\n$$R = \\frac{N_{\\text{aux}}}{N_{\\text{orb}}} = \\frac{139}{62} \\approx 2.241935...$$\n\n按要求将此结果四舍五入到四位有效数字，得到 $R = 2.242$。", "answer": "$$\\boxed{2.242}$$", "id": "2916446"}, {"introduction": "理解了辅助基组需要比轨道基组更大之后，一个自然的问题是：这些辅助基组是如何被系统地构建出来的？本练习将引导你从第一性原理出发，亲手设计一个均匀节拍（even-tempered）高斯辅助基组 [@problem_id:2884646]。你将学习如何根据轨道基组的特性（例如指数范围和角动量），通过高斯乘积定理来确定辅助基组所需满足的条件。", "problem": "在量子化学中，对于电子排斥能的单位分解（RI）密度拟合（DF）近似，我们需要在每个原子上寻找一个辅助高斯基组，该基组能够张成原子轨道（AOs）乘积的空间。考虑一个分子，其以原子为中心的轨道基组由收缩高斯型轨道（GTOs）构成，其原初指数范围从最小值为 $\\alpha_{\\min} = 0.15$ 到最大值为 $\\alpha_{\\max} = 400$（原子单位）。轨道基组中存在的最大角动量为 $\\ell_{\\text{orb}} = 2$（即包含d函数）。\n\n你的任务是在每个原子上构建一个用于库仑度规下RI-DF的均匀回火高斯辅助集。每个角动量通道 $\\ell$ 的均匀回火集由一个正指数的几何级数 $\\{\\beta_{k}^{(\\ell)}\\}_{k=1}^{M}$ 指定，其形式为 $\\beta_{k}^{(\\ell)} = \\beta_{\\min}^{(\\ell)}\\, r^{k-1}$，其中 $M$ 是每个角动量通道的指数数量，$r>1$ 是公比。GTOs的乘积空间意味着原初乘积指数是轨道指数之和，因此辅助基组必须表示的相关指数范围由区间 $[2\\alpha_{\\min},\\,2\\alpha_{\\max}]$ 指导。为了确保在库仑度规中的数值稳健性，你决定通过一个下边际因子 $\\lambda_{\\ell}$ 和一个上边际因子 $\\lambda_{u}$ 来扩展这个目标区间，定义辅助指数覆盖区间为 $[\\beta_{\\min},\\,\\beta_{\\max}] = [\\lambda_{\\ell}\\,(2\\alpha_{\\min}),\\,\\lambda_{u}\\,(2\\alpha_{\\max})]$。你采用保守选择 $\\lambda_{\\ell} = 0.5$ 和 $\\lambda_{u} = 2$。为了在不同角动量间实现乘积空间的平衡分辨率，你选择包含直到 $\\ell_{\\text{aux}} = 2\\,\\ell_{\\text{orb}}$ 的辅助角动量，并为每个通道取相同数量的指数 $M=16$，且每个 $\\ell$ 使用相同的公比 $r$。\n\n基于这些原则和选择，确定几何公比 $r$，以确保均匀回火序列用 $M$ 个指数为每个 $\\ell$ 最小化地覆盖区间 $[\\beta_{\\min},\\,\\beta_{\\max}]$。请明确说明你所针对的指数覆盖区间，证明角动量截断 $\\ell_{\\text{aux}}$ 的合理性，并解释基于用几何级数覆盖该区间的需求而导出 $r$ 的公式的推理过程。\n\n将你的最终答案 $r$ 表示为一个纯数，并四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，提法恰当，并包含足够信息以得到唯一解。这是计算量子化学中为单位分解（RI）方法构建辅助基组的一个标准练习。因此，我们将着手进行推导。\n\n该问题要求确定一个均匀回火辅助高斯基组的几何公比 $r$。我们已知以下参数：\n- 最小原初轨道指数: $\\alpha_{\\min} = 0.15$\n- 最大原初轨道指数: $\\alpha_{\\max} = 400$\n- 最大轨道角动量: $\\ell_{\\text{orb}} = 2$\n- 每个角动量通道的辅助指数数量: $M = 16$\n- 下边际因子: $\\lambda_{\\ell} = 0.5$\n- 上边际因子: $\\lambda_{u} = 2$\n\n首先，我们必须证明辅助基组中最大角动量选择 $\\ell_{\\text{aux}}$ 的合理性。在RI近似中，辅助基组用于展开原子轨道的乘积，这些乘积构成了电子密度。角动量为 $\\ell_1$ 和 $\\ell_2$ 的两个高斯型轨道（GTOs）的乘积可以表示为一系列位于连接原始两个中心的线上的GTOs的有限和。这些乘积GTOs的角动量（记为 $L$）范围从 $|\\ell_1 - \\ell_2|$ 到 $\\ell_1 + \\ell_2$。为了精确表示主基组中轨道所有可能的乘积，辅助基组必须包含能够张成与这些乘积相同角动量空间的函数。在给定基组中，两个轨道乘积产生的最高角动量发生在两个函数均为 $\\ell_1 = \\ell_2 = \\ell_{\\text{orb}}$ 的情况。这给出的最大乘积角动量为 $\\ell_{\\text{orb}} + \\ell_{\\text{orb}} = 2\\ell_{\\text{orb}}$。因此，选择 $\\ell_{\\text{aux}} = 2\\ell_{\\text{orb}}$ 是辅助基组在轨道乘积空间的角动量方面完备的必要条件。给定 $\\ell_{\\text{orb}} = 2$，辅助基组必须包含直到 $\\ell_{\\text{aux}} = 2 \\times 2 = 4$ 的函数（即 $s, p, d, f, g$ 函数）。\n\n接下来，我们确定辅助基组必须覆盖的目标指数范围 $[\\beta_{\\min}, \\beta_{\\max}]$。根据高斯乘积定理，两个指数为 $\\alpha_i$ 和 $\\alpha_j$ 的原初GTOs的乘积产生一个新的原初GTO，其指数等于它们的和 $\\alpha_i + \\alpha_j$。主轨道基组中原初GTOs的指数范围为 $[\\alpha_{\\min}, \\alpha_{\\max}]$。因此，原初乘积GTOs的指数将覆盖区间 $[\\alpha_{\\min} + \\alpha_{\\min}, \\alpha_{\\max} + \\alpha_{\\max}]$，即 $[2\\alpha_{\\min}, 2\\alpha_{\\max}]$。\n问题指定用边际因子 $\\lambda_{\\ell}$ 和 $\\lambda_{u}$ 来扩展这个基本区间，以确保数值稳定性和稳健拟合。因此，辅助指数的最终目标区间为：\n$$ [\\beta_{\\min}, \\beta_{\\max}] = [\\lambda_{\\ell}\\,(2\\alpha_{\\min}),\\,\\lambda_{u}\\,(2\\alpha_{\\max})] $$\n代入给定值：\n$$ \\beta_{\\min} = 0.5 \\times (2 \\times 0.15) = 0.5 \\times 0.3 = 0.15 $$\n$$ \\beta_{\\max} = 2 \\times (2 \\times 400) = 2 \\times 800 = 1600 $$\n所以，目标指数覆盖区间是 $[0.15, 1600]$。\n\n每个角动量通道的辅助基组指数形成一个均匀回火几何级数：\n$$ \\beta_{k} = \\beta_{1} r^{k-1} \\quad \\text{for} \\quad k \\in \\{1, 2, \\dots, M\\} $$\n其中 $M=16$ 是指数的数量，$r$ 是待确定的公比。该序列“最小化地覆盖”区间 $[\\beta_{\\min}, \\beta_{\\max}]$ 的条件意味着序列的第一个指数必须是 $\\beta_{\\min}$，最后一个指数必须是 $\\beta_{\\max}$。\n因此，我们设定：\n$$ \\beta_{1} = \\beta_{\\min} $$\n$$ \\beta_{M} = \\beta_{\\max} $$\n代入序列第 $M$ 项的公式，我们得到：\n$$ \\beta_{M} = \\beta_{1} r^{M-1} $$\n用目标值替换 $\\beta_{1}$ 和 $\\beta_{M}$ 得到：\n$$ \\beta_{\\max} = \\beta_{\\min} r^{M-1} $$\n我们现在可以解出公比 $r$：\n$$ \\frac{\\beta_{\\max}}{\\beta_{\\min}} = r^{M-1} $$\n$$ r = \\left( \\frac{\\beta_{\\max}}{\\beta_{\\min}} \\right)^{\\frac{1}{M-1}} $$\n这是公比 $r$ 的通用公式。我们现在代入我们已经确定的数值：$\\beta_{\\min} = 0.15$，$\\beta_{\\max} = 1600$ 和 $M = 16$。\n$$ M - 1 = 16 - 1 = 15 $$\n$$ r = \\left( \\frac{1600}{0.15} \\right)^{\\frac{1}{15}} $$\n计算数值：\n$$ r = \\left( \\frac{160000}{15} \\right)^{\\frac{1}{15}} = \\left( \\frac{32000}{3} \\right)^{\\frac{1}{15}} \\approx (10666.666\\dots)^{\\frac{1}{15}} $$\n$$ r \\approx 1.8558362 $$\n问题要求答案四舍五入到四位有效数字。\n$$ r \\approx 1.856 $$\n这个 $r$ 值定义了用 $M=16$ 个函数跨越所需范围 $[0.15, 1600]$ 的均匀回火指数序列，确保了RI-DF计算中轨道乘积空间的平衡表示。", "answer": "$$\\boxed{1.856}$$", "id": "2884646"}, {"introduction": "理论上的精确性和实际计算中的数值稳定性之间往往存在权衡。当处理包含弥散函数的基组时，轨道基和辅助基中都可能出现近线性依赖，导致数值计算失败。这项高级练习将挑战你诊断密度拟合中常见的失效模式，并从给定的第一性原理出发，选择正确的数值稳定化策略 [@problem_id:2884603]。", "problem": "在量子化学电子排斥积分的密度拟合（也称为单位分解）中，对于轨道基 $\\{\\chi_\\mu\\}$ 上的四中心积分 $(\\mu\\nu|\\lambda\\sigma)$，通过在选定的度规下求解最小二乘问题，利用辅助基 $\\{P\\}$ 进行近似。一种标准的构建方法使用库仑度规，借助辅助库仑矩阵 $J_{PQ} \\equiv (P|Q)$ 和三中心积分 $B_{\\mu\\nu}^P \\equiv (\\mu\\nu|P)$ 来形成近似：\n$$\n(\\mu\\nu|\\lambda\\sigma) \\approx \\sum_{P,Q} B_{\\mu\\nu}^P \\left(J^{-1}\\right)_{PQ} B_{\\lambda\\sigma}^Q,\n$$\n这等价于在库仑内积下将轨道对密度 $\\chi_\\mu\\chi_\\nu$ 投影到由 $\\{P\\}$ 张成的空间上。设 $S_{\\mu\\nu} \\equiv \\langle \\chi_\\mu | \\chi_\\nu \\rangle$ 表示轨道重叠矩阵。在实践中，对于富含弥散函数的轨道基和大型辅助基组，轨道基和辅助基中都可能出现近线性相关性，并且算术运算是在有限的机器精度 $\\varepsilon$ 下进行的。\n\n从以下基本原理和定义出发：\n- 在对称半正定度规矩阵 $J$ 中，最小二乘法向方程的形式为 $J \\mathbf{c} = \\mathbf{b}$，其中 $\\mathbf{c}$ 是系数，$\\mathbf{b}$ 是右端项；$\\mathbf{c}$ 中的相对前向误差由条件数 $\\kappa(J)$ 界定：\n$$\n\\frac{\\|\\delta \\mathbf{c}\\|}{\\|\\mathbf{c}\\|} \\lesssim \\kappa(J)\\,\\frac{\\|\\delta \\mathbf{b}\\|}{\\|\\mathbf{b}\\|},\n$$\n其中 $\\kappa(J) \\equiv \\|J\\|\\,\\|J^{-1}\\|$，$\\delta(\\cdot)$ 表示微扰。\n- 内积空间中的正交投影使残差范数最小化。对于电荷密度 $\\rho$ 的库仑度规拟合，如果 $\\tilde\\rho$ 是 $\\rho$ 在辅助基张成空间上的库仑正交投影，且 $\\Delta \\equiv \\rho - \\tilde\\rho$，则\n$$\n\\langle \\tilde\\rho | \\Delta \\rangle = 0,\\quad \\|\\rho\\|^2 = \\|\\tilde\\rho\\|^2 + \\|\\Delta\\|^2.\n$$\n- 哈特里（库仑）能量可以写为 $E_J[\\rho] = \\frac{1}{2}\\langle \\rho | \\rho \\rangle$，这是在库仑内积下的形式，该内积是半正定的。\n- 轨道的正则正交化使用 $S$ 的谱分解，并舍弃特征值低于阈值 $\\tau$ 的特征向量，以消除近线性相关性。\n\n考虑这样一种情况：轨道基包含非常弥散的高斯函数，辅助基也包含弥散函数，因此 $S$ 和 $J$ 都可能是病态的。以下哪些陈述正确地指出了在这种情况下可能出现的一种失效模式，并提出了一个基于上述原理的合理缓解策略？选择所有适用项。\n\nA. 在一个包含许多弥散函数的辅助基中，$J$ 的小特征值使得法向方程 $J\\mathbf{c}=\\mathbf{b}$ 变得病态。这会放大 $B_{\\mu\\nu}^P$ 中的数值噪声，并且在有限精度算术（$\\varepsilon>0$）下，可能会破坏精确算术下残差的正交性，从而破坏库仑度规拟合的变分特性。缓解策略：对 $J$ 进行带主元的 Cholesky 分解，并设置一个舍弃容差 $\\tau$ 来丢弃近零方向，或者应用一个正的 Tikhonov 正则化子 $J \\leftarrow J + \\alpha I$（其中 $\\alpha>0$），以在保持正定性的同时稳定求逆过程。\n\nB. 轨道重叠矩阵 $S$ 中的近线性相关性只影响 Hartree-Fock 的精确交换部分，对密度拟合没有影响，因为密度拟合只使用辅助基。因此，为了稳定的密度拟合，无需对轨道基采取缓解措施。\n\nC. 将库仑度规 $J$ 替换为辅助基的重叠度规，可以自动保证哈特里能量的误差为非负，并解决与弥散函数相关的不稳定性，因为对于长程函数，重叠度规比库仑度规的条件更好。\n\nD. 对于带有非常弥散函数的增广轨道基，辅助基必须能够张成轨道对密度的长程分量；如果辅助基缺乏足够的弥散函数，$B_{\\mu\\nu}^P$ 的拟合效果会很差，导致密度拟合的二阶 Møller-Plesset (MP2) 和耦合簇相关能出现较大误差。缓解策略：使用专门为母轨道基优化的辅助基组（例如，与 aug-cc-pV$n$Z 匹配的 JK-fit 基组），或添加额外的弥散辅助函数。\n\nE. 当 $J$ 是病态的时，通过增加更多函数来扩大辅助基总是能改善条件数 $\\kappa(J)$，因此总能修复密度拟合中的不稳定性。\n\nF. 如果由于弥散轨道的近线性相关性，$S$ 的特征值 $\\sigma_i$ 满足 $\\sigma_i \\ll 1$，那么三中心积分 $B_{\\mu\\nu}^P$ 会通过病态的对密度 $\\chi_\\mu\\chi_\\nu$ 受到影响。缓解策略：对轨道基进行正则正交化，舍弃满足 $\\sigma_i  \\tau$ 的特征向量（其中 $\\tau0$），这会降低对空间（pair space）的秩，并稳定后续的密度拟合。\n\nG. 为了消除病态 $J$ 的影响，应该放弃库仑度规，并始终使用辅助重叠度规；这样，对于任何辅助基和数值精度，通过构造，库仑能量误差都满足 $E_J^{\\text{DF}} \\le E_J^{\\text{exact}}$。\n\nH. 交换拟合 (RI-K) 对辅助基不完备性和病态性比库仑拟合 (RI-J) 更敏感。在富含弥散函数的情况下，缓解策略是：仅对库仑部分使用密度拟合，而不进行拟合地计算精确交换，同时对哈特里项保留一个稳定的库仑度规 DF，并对 $J$ 进行稳健的分解。", "solution": "问题陈述提出了一个关于在量子化学中密度拟合（DF，也称单位分解，RI）近似背景下的数值失效模式问题。该背景特定于涉及弥散基函数的情况，已知弥散基函数会导致数值不稳定性。\n\n### **问题验证**\n\n**第一步：提取已知条件**\n\n-   四中心电子排斥积分 $(\\mu\\nu|\\lambda\\sigma)$ 被近似为：\n    $$(\\mu\\nu|\\lambda\\sigma) \\approx \\sum_{P,Q} B_{\\mu\\nu}^P \\left(J^{-1}\\right)_{PQ} B_{\\lambda\\sigma}^Q$$\n-   定义：\n    -   轨道基：$\\{\\chi_\\mu\\}$\n    -   辅助基：$\\{P\\}$\n    -   辅助库仑矩阵：$J_{PQ} \\equiv (P|Q) = \\iint P(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} Q(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2$\n    -   三中心积分：$B_{\\mu\\nu}^P \\equiv (\\mu\\nu|P) = \\iint \\chi_\\mu(\\mathbf{r}_1)\\chi_\\nu(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} P(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2$\n    -   轨道重叠矩阵：$S_{\\mu\\nu} \\equiv \\langle \\chi_\\mu | \\chi_\\nu \\rangle$\n-   背景：轨道基和辅助基都可能包含弥散函数，导致 $S$ 和 $J$ 矩阵病态。算术运算在有限机器精度 $\\varepsilon  0$ 下执行。\n-   基本原理和定义：\n    1.  最小二乘法向方程：对于对称半正定度规 $J$，方程为 $J \\mathbf{c} = \\mathbf{b}$。相对前向误差由以下公式界定：\n        $$\\frac{\\|\\delta \\mathbf{c}\\|}{\\|\\mathbf{c}\\|} \\lesssim \\kappa(J)\\,\\frac{\\|\\delta \\mathbf{b}\\|}{\\|\\mathbf{b}\\|}$$\n        其中 $\\kappa(J) \\equiv \\|J\\|\\,\\|J^{-1}\\|$ 是条件数。\n    2.  正交投影：对于库仑度规拟合，若 $\\tilde\\rho$ 是 $\\rho$ 的投影，且 $\\Delta \\equiv \\rho - \\tilde\\rho$，则 $\\langle \\tilde\\rho | \\Delta \\rangle = 0$ 且 $\\|\\rho\\|^2 = \\|\\tilde\\rho\\|^2 + \\|\\Delta\\|^2$。\n    3.  哈特里能量：$E_J[\\rho] = \\frac{1}{2}\\langle \\rho | \\rho \\rangle$，在库仑内积下。\n    4.  正则正交化：采用 $S$ 的谱分解，并舍弃特征值低于阈值 $\\tau$ 的特征向量。\n\n**第二步：使用提取的已知条件进行验证**\n\n问题陈述具有科学依据，是良定的，并且是客观的。\n-   **科学依据**：对密度拟合的描述、矩阵（$J$, $B$, $S$）的定义，以及由弥散基函数引起的数值不稳定性的背景，在计算量子化学领域都是标准和符合事实的。所引用的失效模式和缓解技术是这些方法开发和应用中的核心议题。\n-   **良定性**：问题要求根据一组给定的正确物理和数值原理来评估几个陈述。任务清晰，并且可以通过基于所提供框架的逻辑推导来确定一组唯一的正确陈述。\n-   **客观性**：语言精确且技术性强。它描述了既定的数学和计算概念，没有主观性或偏见。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。我将继续进行解答。\n\n### **解答推导**\n\n我现在将根据提供的原理评估每个陈述。\n\n**A. 在一个包含许多弥散函数的辅助基中，$J$ 的小特征值使得法向方程 $J\\mathbf{c}=\\mathbf{b}$ 变得病态。这会放大 $B_{\\mu\\nu}^P$ 中的数值噪声，并且在有限精度算术（$\\varepsilon0$）下，可能会破坏精确算术下残差的正交性，从而破坏库仑度规拟合的变分特性。缓解策略：对 $J$ 进行带主元的 Cholesky 分解，并设置一个舍弃容差 $\\tau$ 来丢弃近零方向，或者应用一个正的 Tikhonov 正则化子 $J \\leftarrow J + \\alpha I$（其中 $\\alpha0$），以在保持正定性的同时稳定求逆过程。**\n\n该陈述是正确的。弥散辅助函数间的近线性相关性导致辅助库仑矩阵 $J$ 具有非常小的特征值。条件数 $\\kappa(J)$ 是最大与最小特征值之比，会变得极大。给定的误差界限 $\\frac{\\|\\delta \\mathbf{c}\\|}{\\|\\mathbf{c}\\|} \\lesssim \\kappa(J)\\frac{\\|\\delta \\mathbf{b}\\|}{\\|\\mathbf{b}\\|}$ 表明，大的 $\\kappa(J)$ 会将右端向量 $\\mathbf{b}$（由 $B_{\\mu\\nu}^P$ 积分构成）中的小误差（机器精度 $\\varepsilon$ 的量级）灾难性地放大为系数向量 $\\mathbf{c}$ 中的大误差。关于破坏正交性的说法也是正确的。拟合的变分性质，即能量误差非负，依赖于正交性条件 $\\langle \\tilde\\rho | \\Delta \\rangle = 0$。$\\tilde\\rho = \\sum_P c_P P$ 系数中的巨大数值误差会违反这个条件，可能导致非物理的负能量误差。两种提议的缓解策略都是标准且有效的。带主元的 Cholesky 分解系统地识别并从基中移除线性相关的向量，有效地将问题投影到一个条件良好的子空间上。Tikhonov 正则化，$J \\rightarrow J + \\alpha I$，将 $J$ 的所有特征值移动 $+\\alpha$，这使得最小特征值有界地远离零，从而降低了条件数。\n结论：**正确**。\n\n**B. 轨道重叠矩阵 $S$ 中的近线性相关性只影响 Hartree-Fock 的精确交换部分，对密度拟合没有影响，因为密度拟合只使用辅助基。因此，为了稳定的密度拟合，无需对轨道基采取缓解措施。**\n\n这个陈述是根本错误的。密度拟合近似的是积分 $(\\mu\\nu|\\lambda\\sigma)$，它是由量 $B_{\\mu\\nu}^P = (\\mu\\nu|P)$ 构建的。这些三中心积分直接依赖于轨道对乘积 $\\chi_\\mu\\chi_\\nu$。如果主轨道基 $\\{\\chi_\\mu\\}$ 存在近线性相关性（如近奇异的重叠矩阵 $S$ 所示），那么对乘积空间 $\\{\\chi_\\mu\\chi_\\nu\\}$ 也是病态的。被拟合的对象本身在数值上就是不稳定的。任何依赖于这些量的过程，包括构建密度拟合方程的右端项，都将继承这种不稳定性。声称这“没有影响”是一个严重的错误。\n结论：**不正确**。\n\n**C. 将库仑度规 $J$ 替换为辅助基的重叠度规，可以自动保证哈特里能量的误差为非负，并解决与弥散函数相关的不稳定性，因为对于长程函数，重叠度规比库仑度规的条件更好。**\n\n这个陈述是不正确的。近似的哈特里能量不超过精确值（$E_J^{\\text{DF}} \\le E_J^{\\text{exact}}$）的变分性质，是这样一个事实的直接结果：近似是在定义能量的*同一个*内积中的正交投影。哈特里能量由库仑内积定义，$E_J[\\rho] = \\frac{1}{2}\\langle \\rho | \\rho \\rangle$。因此，只有在库仑范数 $\\|\\rho - \\tilde{\\rho}\\|_J$ 中最小化残差的最小二乘拟合，才能保证这个变分性质。将拟合度规更改为重叠度规 $\\langle P | Q \\rangle$ 构成了不同的投影。由此产生的近似密度不保证在库仑度规下满足正交性条件，因此能量的变分特性丧失。能量误差可正可负。\n结论：**不正确**。\n\n**D. 对于带有非常弥散函数的增广轨道基，辅助基必须能够张成轨道对密度的长程分量；如果辅助基缺乏足够的弥散函数，$B_{\\mu\\nu}^P$ 的拟合效果会很差，导致密度拟合的二阶 Møller-Plesset (MP2) 和耦合簇相关能出现较大误差。缓解策略：使用专门为母轨道基优化的辅助基组（例如，与 aug-cc-pV$n$Z 匹配的 JK-fit 基组），或添加额外的弥散辅助函数。**\n\n这个陈述是正确的。它解决了基组不完备性问题，这与数值病态是不同的。任何基组展开的准确性取决于展开基表示目标函数的能力。弥散轨道基函数 $\\{\\chi_\\mu\\}$ 生成的对密度 $\\chi_\\mu\\chi_\\nu$ 具有显著的空间延展性。为了精确地近似这些密度，辅助基 $\\{P\\}$ 也必须包含具有类似空间延展性的函数，即弥散函数。如果辅助基不够弥散，拟合残差 $\\Delta$ 将会很大，这不是由于数值误差，而是由于基的根本性不足。这会导致近似积分中存在较大的内在误差，并因此在任何计算的性质（如相关能）中产生较大误差。提议的缓解措施——使用精心匹配的辅助基组或用适当的函数对其进行增广——是确保拟合质量的标准和正确做法。\n结论：**正确**。\n\n**E. 当 $J$ 是病态的时，通过增加更多函数来扩大辅助基总是能改善条件数 $\\kappa(J)$，因此总能修复密度拟合中的不稳定性。**\n\n这个陈述是幼稚且明显错误的。向基组中添加函数，远非“总是”改善条件数，反而是导致病态的主要原因之一。如果添加一个已经可以被现有基函数很好地近似的函数，就会引入一个近线性相关性。这必然会在度规矩阵 $J$ 中产生一个非常接近零的新特征值，从而急剧*增加*条件数 $\\kappa(J) = \\lambda_{\\max}/\\lambda_{\\min}$ 并恶化数值不稳定性。\n结论：**不正确**。\n\n**F. 如果由于弥散轨道的近线性相关性，$S$ 的特征值 $\\sigma_i$ 满足 $\\sigma_i \\ll 1$，那么三中心积分 $B_{\\mu\\nu}^P$ 会通过病态的对密度 $\\chi_\\mu\\chi_\\nu$ 受到影响。缓解策略：对轨道基进行正则正交化，舍弃满足 $\\sigma_i  \\tau$ 的特征向量（其中 $\\tau0$），这会降低对空间（pair space）的秩，并稳定后续的密度拟合。**\n\n这个陈述是正确的，并为陈述 B 中错误提出的问题提供了正确的分析。重叠矩阵 $S$ 的小特征值是轨道基 $\\{\\chi_\\mu\\}$ 中近线性相关性的数学标志。这种不稳定性会传播到从该基导出的所有量，包括作为密度拟合过程输入的对密度 $\\chi_\\mu\\chi_\\nu$。指定的缓解措施，即带有阈值的正则正交化以舍弃与小特征值相关的 $S$ 的特征向量，是消除这种冗余的标准和严谨程序。它定义了一个向更小的、数值稳定的、正交归一基的转换。所有后续计算，包括密度拟合，都在这个稳定基中进行，从而从源头上解决了不稳定性。\n结论：**正确**。\n\n**G. 为了消除病态 $J$ 的影响，应该放弃库仑度规，并始终使用辅助重叠度规；这样，对于任何辅助基和数值精度，通过构造，库仑能量误差都满足 $E_J^{\\text{DF}} \\le E_J^{\\text{exact}}$。**\n\n这个陈述是不正确的，原因与陈述 C 相同。它重复了将拟合度规与能量度规混淆的根本错误。不等式 $E_J^{\\text{DF}} \\le E_J^{\\text{exact}}$ 是库仑能量的库仑度规拟合的一个性质。使用重叠度规进行拟合会破坏这个变分上界。该主张是错误的。\n结论：**不正确**。\n\n**H. 交换拟合 (RI-K) 对辅助基不完备性和病态性比库仑拟合 (RI-J) 更敏感。在富含弥散函数的情况下，缓解策略是：仅对库仑部分使用密度拟合，而不进行拟合地计算精确交换，同时对哈特里项保留一个稳定的库仑度规 DF，并对 $J$ 进行稳健的分解。**\n\n这个陈述是正确的。拟合库仑算符 (RI-J) 涉及近似总电子密度 $\\rho = \\sum_k^{\\text{occ}} \\phi_k \\phi_k$，这是一个相对平滑的单一函数。相比之下，拟合交换算符 (RI-K) 需要近似大量单独的轨道对乘积 $\\{\\phi_i \\phi_k\\}$。这些单独的乘积比总密度表现出更复杂的结构（包括节点），并且数量也多得多。因此，RI-K 对辅助基提出了更高的要求，并且更容易受到不完备性和病态性问题的影响。提议的缓解措施是一种合理且被广泛使用的实用策略。它通过精确计算交换积分来避免更困难的 RI-K 问题。对于更简单的库仑项，它主张保留密度拟合，但通过稳健的数值技术（“对 $J$ 进行稳健的分解”）来确保其稳定性，这直接与问题中提到的原理以及陈述 A 中概述的正确缓解策略相联系。\n结论：**正确**。", "answer": "$$\\boxed{ADFH}$$", "id": "2884603"}]}