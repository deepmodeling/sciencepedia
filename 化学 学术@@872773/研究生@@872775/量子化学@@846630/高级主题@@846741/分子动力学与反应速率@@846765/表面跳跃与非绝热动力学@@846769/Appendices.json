{"hands_on_practices": [{"introduction": "在最少切换面跳跃（FSSH）方法的核心，在于其决定何时在不同绝热态之间进行切换的随机准则。本练习将引导您从含时薛定谔方程出发，推导决定这一切换概率的关键公式。通过解决这个问题 ([@problem_id:2928383])，您将深入理解量子相干性（即电子波函数系数的相位）如何影响跃迁概率，并掌握FSSH算法中最基本的计算步骤。", "problem": "考虑一个在最少切换表面跳跃（FSSH）框架下处理的双态非绝热动力学问题。设电子波函数在绝热基中展开为 $\\Psi(\\mathbf{r},\\mathbf{R},t)=\\sum_{k} c_k(t)\\,\\phi_k(\\mathbf{r};\\mathbf{R}(t))$，其中核轨迹 $\\mathbf{R}(t)$ 进行经典演化。在绝热表象中，含时薛定谔方程意味着振幅 $\\{c_k(t)\\}$ 之间通过核速度 $\\mathbf{v}(t)=\\dot{\\mathbf{R}}(t)$ 和非绝热导数耦合 $d_{ij}(\\mathbf{R})=\\langle \\phi_i(\\mathbf{R})|\\nabla_{\\mathbf{R}}\\phi_j(\\mathbf{R})\\rangle$ 发生耦合。假设绝热态是正交归一的，并且在 $\\mathbf{R}$ 中足够光滑，以使导数耦合有良好定义。\n\n从这些基本原理出发，并要求由跳跃引起的绝热态之间的系综平均布居数转移，在时间步长 $\\Delta t$ 的领头阶上，与含时薛定谔方程所决定的布居数流相匹配，推导出在单个时间步长 $\\Delta t$ 内从态 $i$ 跳跃到态 $j$ 的概率的领头阶表达式，用 $c_i$、$c_j$、$\\mathbf{v}$ 和 $d_{ij}$ 表示。\n\n然后，根据给定瞬间的以下数据，计算该跳跃概率：\n- $c_i = 0.8\\,\\exp(i\\theta_i)$ 和 $c_j = 0.6\\,\\exp(i\\theta_j)$，其中 $\\theta_j-\\theta_i=\\pi/3$ （弧度），\n- $\\Delta t = 5.0\\times 10^{-16}\\ \\mathrm{s}$，\n- $\\mathbf{v}=(1500\\ \\mathrm{m\\,s^{-1}})\\,\\hat{\\mathbf{x}}+(1000\\ \\mathrm{m\\,s^{-1}})\\,\\hat{\\mathbf{y}}+0\\,\\hat{\\mathbf{z}}$，\n- $d_{ij}=(1.0\\times 10^{10}\\ \\mathrm{m^{-1}})\\,\\hat{\\mathbf{x}}+(1.0\\times 10^{10}\\ \\mathrm{m^{-1}})\\,\\hat{\\mathbf{y}}+0\\,\\hat{\\mathbf{z}}$。\n\n假设在此几何构型下，绝热电子态被选为实数，因此 $d_{ij}$ 是实数。定性地讨论跳跃概率如何依赖于 $c_i$ 和 $c_j$ 之间的相对相位，以及绝热态的相位选择（规范）的作用。\n\n将最终的跳跃概率表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于非绝热量子动力学的原理，特别是最少切换表面跳跃（FSSH）方法。该问题提法恰当、客观、自洽，并且所有提供的数据在物理上和量纲上都是一致的。两个态的布居数之和为1，$|c_i|^2+|c_j|^2 = (0.8)^2+(0.6)^2 = 0.64+0.36 = 1.0$，符合要求。因此，我们可以着手求解。\n\n解答分为三个部分：首先，从基本原理推导跳跃概率公式；其次，对给定数据进行数值计算；第三，讨论相位和规范的作用。\n\n**1. 跳跃概率的推导**\n\n电子波函数 $\\Psi(\\mathbf{r},\\mathbf{R},t)=\\sum_{k} c_k(t)\\,\\phi_k(\\mathbf{r};\\mathbf{R}(t))$ 的演化由含时薛定谔方程（TDSE）控制。在绝热表象中，复振幅 $c_k(t)$ 的运动方程由下式给出：\n$$ i\\hbar\\frac{d c_k(t)}{dt} = E_k(\\mathbf{R}) c_k(t) - i\\hbar \\sum_j \\mathbf{v}(t) \\cdot d_{kj}(\\mathbf{R}) c_j(t) $$\n其中 $E_k$ 是绝热势能面，$\\mathbf{v}(t) = \\dot{\\mathbf{R}}(t)$ 是经典核速度，$d_{kj} = \\langle \\phi_k | \\nabla_{\\mathbf{R}} \\phi_j \\rangle$ 是非绝热导数耦合。为简便起见，我们将使用原子单位，其中 $\\hbar=1$。\n$$ \\frac{d c_k}{dt} = -i E_k c_k - \\sum_j (\\mathbf{v} \\cdot d_{kj}) c_j $$\n我们关心的是给定态 $j$ 的布居数 $\\rho_j(t) = |c_j(t)|^2 = c_j^*(t)c_j(t)$ 的变化率。根据乘积法则，其时间导数为：\n$$ \\frac{d\\rho_j}{dt} = \\frac{dc_j^*}{dt}c_j + c_j^*\\frac{dc_j}{dt} $$\n关于 $c_j$ 的方程的复共轭是：\n$$ \\frac{dc_j^*}{dt} = i E_j c_j^* - \\sum_k (\\mathbf{v} \\cdot d_{jk})^* c_k^* $$\n根据导数耦合的定义，可以证明 $d_{jk}^* = -d_{kj}$。对于问题中假设的实绝热波函数的特殊情况，这简化为 $d_{jk}$ 是实数且反对称的，即 $d_{jk}=-d_{kj}$。我们使用更普适的关系 $d_{jk}^* = -d_{kj}$。\n$$ \\frac{dc_j^*}{dt} = i E_j c_j^* + \\sum_k (\\mathbf{v} \\cdot d_{kj}) c_k^* $$\n将 $\\dot{c}_j$ 和 $\\dot{c}_j^*$ 的表达式代入 $\\rho_j$ 的导数中：\n$$ \\frac{d\\rho_j}{dt} = \\left( i E_j c_j^* + \\sum_k (\\mathbf{v} \\cdot d_{kj}) c_k^* \\right) c_j + c_j^* \\left( -i E_j c_j - \\sum_k (\\mathbf{v} \\cdot d_{jk}) c_k \\right) $$\n包含能量 $E_j$ 的项相互抵消：\n$$ \\frac{d\\rho_j}{dt} = \\sum_k \\left[ (\\mathbf{v} \\cdot d_{kj}) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right] $$\n重新整理求和项，并使用恒等式 $Z - Z^* = 2i\\mathrm{Im}(Z)$：\n$$ \\frac{d\\rho_j}{dt} = \\sum_{k \\neq j} \\left( (\\mathbf{v} \\cdot d_{kj}) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right) $$\n使用 $d_{kj} = -d_{jk}^*$，表达式变为：\n$$ \\frac{d\\rho_j}{dt} = \\sum_{k \\neq j} \\left( -(\\mathbf{v} \\cdot d_{jk}^*) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right) = -2 \\sum_{k \\neq j} \\mathrm{Re}[(\\mathbf{v} \\cdot d_{jk}) c_j^* c_k] $$\n这个方程描述了由于与所有其他态 $k$ 的耦合，态 $j$ 的总布居数变化率。求和中针对特定态 $i$ 的项，$-2 \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ji}) c_j^* c_i]$，代表了态 $i$ 和态 $j$ 之间的布居数流速率。在一个小的时间步长 $\\Delta t$ 内，从态 $i$ 流向态 $j$ 的布居数是：\n$$ \\Delta \\rho_{i \\to j} = 2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*] $$\n这里我们使用了 $d_{ji} = -d_{ij}^*$ 以及性质 $\\mathrm{Re}(-Z^*) = -\\mathrm{Re}(Z)$。\n\nFSSH算法的核心公理是，对于当前处于态 $i$ 的一条轨迹，其随机跳跃的概率 $P_{i \\to j}$ 的定义必须使得系综平均的布居数转移与TDSE预测的量子力学布居数流相匹配。在一个系综中，由从态 $i$ 到 $j$ 的跳跃引起的布居数转移，是处于态 $i$ 的轨迹分数 $|c_i|^2$ 乘以跳跃概率 $P_{i \\to j}$。将其等同于量子流：\n$$ |c_i|^2 P_{i \\to j} = \\Delta \\rho_{i \\to j} = 2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*] $$\n解出 $P_{i \\to j}$ 得到跳跃概率的领头阶表达式：\n$$ P_{i \\to j} = \\frac{2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]}{|c_i|^2} $$\n由于概率不能为负，右侧的负值意味着布居数从 $j$ 流向 $i$，因此从 $i$ 跳到 $j$ 的概率为零。操作公式为 $P_{i \\to j} = \\max\\left(0, \\frac{2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]}{|c_i|^2}\\right)$。\n\n**2. 相位与规范的讨论**\n\n跳跃概率依赖于项 $\\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]$。设 $c_k = |c_k|\\exp(i\\theta_k)$。我们假设在一个 $d_{ij}$ 为实数的规范下。\n$$ P_{i \\to j} \\propto (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*] = (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[|c_j|\\exp(i\\theta_j) |c_i|\\exp(-i\\theta_i)] $$\n$$ P_{i \\to j} \\propto (\\mathbf{v} \\cdot d_{ij}) |c_i| |c_j| \\cos(\\theta_j - \\theta_i) $$\n概率与复系数之间相对相位的余弦值成正比。相长干涉（$\\cos(\\Delta\\theta) > 0$）会增强跳跃概率，而相消干涉（$\\cos(\\Delta\\theta)  0$）会抑制它，这对应于布居数流动方向的反转。\n\n绝热波函数相位的选择，$\\phi'_k = \\exp(i\\gamma_k(\\mathbf{R})) \\phi_k$，是一种规范自由度。这种变换会引起系数 $c'_k = c_k \\exp(-i\\gamma_k)$ 和非对角导数耦合 $d'_{ij} = d_{ij} \\exp(i(\\gamma_j-\\gamma_i))$ 的变化。像跳跃概率这样的物理可观测量必须是规范不变的。我们检查关键项的不变性：\n$$ (\\mathbf{v} \\cdot d'_{ij}) c'_j (c'_i)^* = (\\mathbf{v} \\cdot (d_{ij} e^{i(\\gamma_j-\\gamma_i)})) (c_j e^{-i\\gamma_j}) (c_i e^{-i\\gamma_i})^* $$\n$$ = (\\mathbf{v} \\cdot d_{ij}) e^{i(\\gamma_j-\\gamma_i)} c_j e^{-i\\gamma_j} c_i^* e^{i\\gamma_i} = (\\mathbf{v} \\cdot d_{ij}) c_j c_i^* e^{i(\\gamma_j-\\gamma_i-\\gamma_j+\\gamma_i)} = (\\mathbf{v} \\cdot d_{ij}) c_j c_i^* $$\n该项确实在规范变换下是不变的。问题中假设态是实数（一种使 $d_{ij}$ 为实数的特定规范选择）是为了方便，而非物理上的必然要求。\n\n**3. 数值计算**\n\n我们现在使用提供的数据计算跳跃概率 $P_{i \\to j}$。\n所需的量为：\ni. 分母 $|c_i|^2$:\n$$ |c_i|^2 = |0.8 \\exp(i\\theta_i)|^2 = (0.8)^2 = 0.64 $$\nii. 点积 $\\mathbf{v} \\cdot d_{ij}$:\n$$ \\mathbf{v} = (1500\\,\\hat{\\mathbf{x}} + 1000\\,\\hat{\\mathbf{y}}) \\ \\mathrm{m\\,s^{-1}} $$\n$$ d_{ij} = (1.0 \\times 10^{10}\\,\\hat{\\mathbf{x}} + 1.0 \\times 10^{10}\\,\\hat{\\mathbf{y}}) \\ \\mathrm{m^{-1}} $$\n$$ \\mathbf{v} \\cdot d_{ij} = (1500)(1.0 \\times 10^{10}) + (1000)(1.0 \\times 10^{10}) $$\n$$ \\mathbf{v} \\cdot d_{ij} = 1.5 \\times 10^{13} + 1.0 \\times 10^{13} = 2.5 \\times 10^{13} \\ \\mathrm{s^{-1}} $$\niii. 实部项 $\\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]$。由于 $d_{ij}$ 是实数，这等于 $(\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*]$。\n$$ c_j c_i^* = (0.6 \\exp(i\\theta_j)) (0.8 \\exp(-i\\theta_i)) = 0.48 \\exp(i(\\theta_j - \\theta_i)) $$\n给定 $\\theta_j - \\theta_i = \\pi/3$，\n$$ c_j c_i^* = 0.48 \\exp(i\\pi/3) = 0.48 \\left(\\cos(\\frac{\\pi}{3}) + i\\sin(\\frac{\\pi}{3})\\right) $$\n$$ \\mathrm{Re}[c_j c_i^*] = 0.48 \\cos(\\frac{\\pi}{3}) = 0.48 \\times \\frac{1}{2} = 0.24 $$\n该项为正，因此允许从 $i \\to j$ 的跳跃。\n\n将这些值代入推导出的公式，其中 $\\Delta t = 5.0 \\times 10^{-16} \\ \\mathrm{s}$：\n$$ P_{i \\to j} = \\frac{2 \\Delta t (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*]}{|c_i|^2} $$\n$$ P_{i \\to j} = \\frac{2 \\times (5.0 \\times 10^{-16} \\ \\mathrm{s}) \\times (2.5 \\times 10^{13} \\ \\mathrm{s^{-1}}) \\times (0.24)}{0.64} $$\n$$ P_{i \\to j} = \\frac{(1.0 \\times 10^{-15}) \\times (2.5 \\times 10^{13}) \\times 0.24}{0.64} = \\frac{(2.5 \\times 10^{-2}) \\times 0.24}{0.64} $$\n$$ P_{i \\to j} = \\frac{0.025 \\times 0.24}{0.64} = \\frac{0.006}{0.64} = 0.009375 $$\n结果要求保留四位有效数字。计算值为 $0.009375$，已经满足此形式。", "answer": "$$\\boxed{0.009375}$$", "id": "2928383"}, {"introduction": "当一次成功的“面跳跃”发生后，系统的势能会瞬间改变，因此必须调整原子核的动能以保证总能量守恒。本练习聚焦于FSSH算法中这一确定性步骤，要求您推导在给定能量差和非绝热耦合矢量方向下，如何精确地重新标度原子核的动量 ([@problem_id:2809709])。完成此练习将使您掌握能量守恒在非绝热动力学模拟中的具体实现方式，并熟悉其中涉及的关键矢量运算。", "problem": "考虑一个分子系统的双态绝热表象，其核坐标汇集于向量 $\\mathbf{R}$ 中，对角质量矩阵为 $\\mathbf{M} = \\mathrm{diag}(m_{1},\\dots,m_{3N})$。设在瞬时几何构型 $\\mathbf{R}$ 下的绝热势能为 $E_{i}(\\mathbf{R})$ 和 $E_{j}(\\mathbf{R})$。跃迁前瞬间的核动量向量为 $\\mathbf{p}$，核速度为 $\\mathbf{v} = \\mathbf{M}^{-1}\\mathbf{p}$。从态 $i$ 到态 $j$ 的跃迁发生在固定的 $\\mathbf{R}$ 处，需调整核动量以保持总能量守恒。\n\n态 $i$ 和 $j$ 之间的非绝热耦合矢量（Nonadiabatic Coupling (NAC)）为 $\\mathbf{d}_{ij}(\\mathbf{R}) = \\langle \\phi_{i}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{j}(\\mathbf{R})\\rangle$。假设动量调整被限制在由 NAC 张成的一维子空间内：定义沿 NAC 方向的动能度规单位矢量为\n$$\n\\hat{\\mathbf{n}} \\;=\\; \\frac{\\mathbf{d}_{ij}}{\\|\\mathbf{M}^{-1/2}\\mathbf{d}_{ij}\\|},\n$$\n使得 $\\hat{\\mathbf{n}}^{\\mathsf{T}} \\mathbf{M}^{-1}\\hat{\\mathbf{n}}=1$ 且 $\\hat{\\mathbf{n}} \\propto \\mathbf{d}_{ij}$。跃迁后的动量取为 $\\mathbf{p}' = \\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}}$，其中标量缩放因子 $\\alpha$ 待定。\n\n仅从以下条件出发：(i) 跃迁前总能量 $E_{\\mathrm{tot}} = \\tfrac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R})$ 与跃迁后总能量 $E'_{\\mathrm{tot}} = \\tfrac{1}{2}\\mathbf{p}'^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}' + E_{j}(\\mathbf{R})$ 守恒，(ii) 以 $\\mathbf{M}$ 定义的动能，以及 (iii) 上述给定的基于 NAC 的重缩放方向，推导动量重缩放规则。具体而言：\n\n- 当 $\\mathbf{p}' = \\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}}$ 时，推导能量守恒所蕴含的关于缩放因子 $\\alpha$ 的二次方程。\n- 求解此二次方程，得到 $\\alpha$ 关于 $\\mathbf{p}$、$\\mathbf{M}$、$E_{i}(\\mathbf{R})$、$E_{j}(\\mathbf{R})$ 和 $\\mathbf{d}_{ij}(\\mathbf{R})$ 的闭式表达式。\n- 选择能使动量沿 $\\hat{\\mathbf{n}}$ 的分量变化最小的根（即，保持跃迁前沿 $\\hat{\\mathbf{n}}$ 分量的符号不变），并用标量 $\\Delta E \\equiv E_{i}(\\mathbf{R}) - E_{j}(\\mathbf{R})$ 和 $b \\equiv \\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}$（或等价地，$b = \\dfrac{\\mathbf{v}\\cdot \\mathbf{d}_{ij}}{\\|\\mathbf{M}^{-1/2}\\mathbf{d}_{ij}\\|}$）明确表示你的最终答案。\n\n请以 $\\alpha$ 的单个闭式解析表达式的形式给出最终答案。如果使用任何符号函数，请明确写出。无需数值近似。", "solution": "所述问题在科学上是合理的、自洽的且提法恰当。它描述了在最少切换表面跳跃（一种非绝热分子动力学中的基石方法）背景下动量调整的标准程序。因此，我们可以进行推导。\n\n出发点是在固定的核几何构型 $\\mathbf{R}$ 下，从绝热态 $i$ 到绝热态 $j$ 的瞬时跃迁过程中总能量守恒的原理。跃迁前的总能量是核动能与态 $i$ 的势能之和：\n$$\nE_{\\mathrm{tot}} = \\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R})\n$$\n跃迁后的总能量，对应于调整后的核动量 $\\mathbf{p}'$ 和态 $j$ 的势能，为：\n$$\nE'_{\\mathrm{tot}} = \\frac{1}{2}\\mathbf{p}'^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}' + E_{j}(\\mathbf{R})\n$$\n能量守恒要求 $E_{\\mathrm{tot}} = E'_{\\mathrm{tot}}$：\n$$\n\\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R}) = \\frac{1}{2}\\mathbf{p}'^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}' + E_{j}(\\mathbf{R})\n$$\n我们已知跃迁后动量与跃迁前动量通过 $\\mathbf{p}' = \\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}}$ 相关联，其中 $\\alpha$ 是一个待定的标量。将此式代入能量守恒方程，得到：\n$$\n\\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R}) = \\frac{1}{2}(\\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}})^{\\mathsf{T}}\\mathbf{M}^{-1}(\\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}}) + E_{j}(\\mathbf{R})\n$$\n我们现在展开右侧的动能项。项 $(\\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}})^{\\mathsf{T}}\\mathbf{M}^{-1}(\\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}})$ 展开如下：\n$$\n(\\mathbf{p}^{\\mathsf{T}} + \\alpha\\,\\hat{\\mathbf{n}}^{\\mathsf{T}})\\mathbf{M}^{-1}(\\mathbf{p} + \\alpha\\,\\hat{\\mathbf{n}}) = \\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + \\alpha\\,\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\hat{\\mathbf{n}} + \\alpha\\,\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + \\alpha^{2}\\,\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\hat{\\mathbf{n}}\n$$\n由于质量矩阵 $\\mathbf{M}$ 是对称的，其逆矩阵 $\\mathbf{M}^{-1}$ 也是对称的。因此，标量积 $\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\hat{\\mathbf{n}}$ 等于其转置 $\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}$。展开式简化为：\n$$\n\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + 2\\alpha\\,\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + \\alpha^{2}\\,\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\hat{\\mathbf{n}}\n$$\n问题给出了以下定义：$b \\equiv \\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}$ 和 $\\Delta E \\equiv E_{i}(\\mathbf{R}) - E_{j}(\\mathbf{R})$。我们还已知矢量 $\\hat{\\mathbf{n}}$ 在动能度规下是归一化的，使得 $\\hat{\\mathbf{n}}^{\\mathsf{T}} \\mathbf{M}^{-1}\\hat{\\mathbf{n}}=1$。使用这些关系，能量守恒方程变为：\n$$\n\\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R}) = \\frac{1}{2}(\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + 2\\alpha\\,b + \\alpha^{2}) + E_{j}(\\mathbf{R})\n$$\n$$\n\\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + E_{i}(\\mathbf{R}) = \\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + \\alpha\\,b + \\frac{1}{2}\\alpha^{2} + E_{j}(\\mathbf{R})\n$$\n跃迁前的动能项 $\\frac{1}{2}\\mathbf{p}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}$ 从两侧消去，剩下：\n$$\nE_{i}(\\mathbf{R}) = \\alpha\\,b + \\frac{1}{2}\\alpha^{2} + E_{j}(\\mathbf{R})\n$$\n整理各项，得到关于 $\\alpha$ 的二次方程：\n$$\n\\frac{1}{2}\\alpha^{2} + b\\,\\alpha - (E_{i}(\\mathbf{R}) - E_{j}(\\mathbf{R})) = 0\n$$\n$$\n\\frac{1}{2}\\alpha^{2} + b\\,\\alpha - \\Delta E = 0\n$$\n为求解此二次方程，我们使用 $Ax^2+Bx+C=0$ 的标准求根公式：$x = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$。在此，$A=\\frac{1}{2}$，$B=b$，$C=-\\Delta E$。\n$$\n\\alpha = \\frac{-b \\pm \\sqrt{b^{2} - 4(\\frac{1}{2})(-\\Delta E)}}{2(\\frac{1}{2})}\n$$\n$$\n\\alpha = -b \\pm \\sqrt{b^{2} + 2\\Delta E}\n$$\n这给出了缩放因子 $\\alpha$ 的两个可能解。只有当平方根下的项为非负时，即 $b^{2} + 2\\Delta E \\ge 0$ 时，跃迁才是物理上可能的，这确保了跃迁后的动能不为负。\n\n问题要求选择“保持跃迁前沿 $\\hat{\\mathbf{n}}$ 分量的符号不变”的那个根。在质量加权度规下，跃迁前的分量是 $b = \\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}$。相应的跃迁后分量是：\n$$\n\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p}' = \\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}(\\mathbf{p} + \\alpha\\hat{\\mathbf{n}}) = \\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\mathbf{p} + \\alpha(\\hat{\\mathbf{n}}^{\\mathsf{T}}\\mathbf{M}^{-1}\\hat{\\mathbf{n}}) = b + \\alpha\n$$\n我们必须选择 $\\alpha$ 的根，使得 $\\mathrm{sgn}(b+\\alpha) = \\mathrm{sgn}(b)$。我们来检验这两个根：\n1.  对于根 $\\alpha_{+} = -b + \\sqrt{b^{2} + 2\\Delta E}$，跃迁后的分量是 $b + \\alpha_{+} = \\sqrt{b^{2} + 2\\Delta E}$。该值总是非负的。只有当 $b \\ge 0$ 时，此选择才能保持 $b$ 的符号。\n2.  对于根 $\\alpha_{-} = -b - \\sqrt{b^{2} + 2\\Delta E}$，跃迁后的分量是 $b + \\alpha_{-} = -\\sqrt{b^{2} + 2\\Delta E}$。该值总是不为正。只有当 $b \\le 0$ 时，此选择才能保持 $b$ 的符号。\n\n因此，正确的选择取决于 $b$ 的符号：\n$$\n\\alpha = \\begin{cases} -b + \\sqrt{b^{2} + 2\\Delta E}  \\text{if } b \\ge 0 \\\\ -b - \\sqrt{b^{2} + 2\\Delta E}  \\text{if } b  0 \\end{cases}\n$$\n这个分段定义可以使用符号函数 $\\mathrm{sgn}(x)$ 写成单个解析表达式。我们必须定义 $x=0$ 时的行为。为了得到一个能覆盖 $b \\ge 0$ 情况的单一表达式，我们采用约定 $\\mathrm{sgn}(0)=1$。因此，符号函数定义为：\n$$\n\\mathrm{sgn}(x) = \\begin{cases} 1  \\text{if } x \\ge 0 \\\\ -1  \\text{if } x  0 \\end{cases}\n$$\n根据此定义，$\\alpha$ 的解可以表示为单一的闭式形式：\n$$\n\\alpha = -b + \\mathrm{sgn}(b)\\sqrt{b^{2} + 2\\Delta E}\n$$\n这个根的选择也导致了动量的最小变化，即对应于绝对值较小的 $\\alpha$ 的根，除了在 $b=0$ 的模糊情况下，两个根的绝对值相等。所述的约定解决了这种模糊性。", "answer": "$$\\boxed{-b + \\mathrm{sgn}(b) \\sqrt{b^{2} + 2\\Delta E}}$$", "id": "2809709"}, {"introduction": "面跳跃模拟的最终目标之一是从微观的轨道数据中提取宏观的物理量，例如反应速率常数。本练习提供了一组模拟产生的统计数据，要求您计算不同电子态之间的有效跃迁速率，并检验其比率是否符合热力学平衡下的细致平衡原理 ([@problem_id:2928309])。通过这个实践，您将学会如何处理和分析模拟输出，并理解如何将模拟结果与基本的统计力学定律联系起来，同时对有限采样带来的统计误差有更深刻的认识。", "problem": "对一个双原子分子在两个标记为 $1$ 和 $2$ 的耦合绝热电子态上进行了一次基于轨道的“最少切换”表面跳跃模拟。经过一个初始瞬态后，模拟在恒定的核温度 $T$ 下达到一个稳态，在该状态下时间平均等于系综平均。在采样区域内，两个绝热势能面近似平行，并由一个恒定的能隙 $\\Delta E = E_{2} - E_{1}$ 分隔。在一个长观测窗口内，记录了以下统计数据：\n- 态 $1$ 上的总驻留时间：$T_{1} = 9.95\\,\\mu\\mathrm{s}$。\n- 态 $2$ 上的总驻留时间：$T_{2} = 2.04\\,\\mu\\mathrm{s}$。\n- 从 $1 \\to 2$ 的跳跃次数：$N_{1\\to 2} = 50{,}112$。\n- 从 $2 \\to 1$ 的跳跃次数：$N_{2\\to 1} = 49{,}888$。\n\n假设：\n- 两个绝热态之间的长时间动力学可以为电子态建模为一个连续时间、时齐的两态马尔可夫过程，该过程与一个温度为 $T = 300\\,\\mathrm{K}$ 的正则核热浴耦合。\n- 理想气体常数为 $R_{\\mathrm{g}} = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，能隙为 $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 在长观测窗口内，跳跃次数可被视为以有效速率常数为条件的独立泊松随机变量，并且记录的驻留时间 $T_{1}$ 和 $T_{2}$ 被视为精确值。\n\n仅从连续时间马尔可夫过程的基本定义、两态主方程的稳态性以及核自由度的正则平衡出发，推导有效速率常数 $k_{12}$ 和 $k_{21}$ 关于 $(N_{1\\to 2}, T_{1})$ 和 $(N_{2\\to 1}, T_{2})$ 的表达式，以及将 $k_{12}/k_{21}$ 与能隙和温度联系起来的预期平衡约束。然后，计算无量纲量\n$$\nQ \\equiv \\frac{k_{12}/k_{21}}{\\exp\\!\\big(-\\Delta E/(R_{\\mathrm{g}} T)\\big)}.\n$$\n将您计算的 $Q$ 值四舍五入到四位有效数字。以纯数（无量纲）形式表示您的最终答案。在您的推导中，评论采样不确定性以及在泊松假设下，观测到的 $Q$ 值与1的偏差是否具有统计学意义，但除了 $Q$ 之外，不要在最终答案中报告任何其他数值。", "solution": "该问题已经过验证，被认为是具有科学依据、提法得当且客观的。它包含了严谨求解所需的所有必要信息。我们开始解答。\n\n任务是推导动力学速率常数的表达式，建立它们在热平衡下的关系，然后计算一个无量纲量 $Q$，该量用于衡量模拟数据与细致平衡理论预期的一致性。\n\n**1. 有效速率常数的推导**\n\n问题陈述，电子态的长时间动力学可以建模为一个连续时间、时齐的两态马尔可夫过程。设这两个态标记为 $1$ 和 $2$。从态 $1$ 到态 $2$ 的跃迁是一个随机事件，其速率常数为 $k_{12}$。该速率常数的定义是：对于处于态 $1$ 的系统，在无穷小时间间隔 $dt$ 内跃迁到态 $2$ 的概率为 $k_{12} dt$。\n\n在有限的观测时间内，跃迁次数与在初始态上花费的总时间成正比。模拟提供了态 $1$ 上的总驻留时间 $T_{1}$ 和离开该态的总跳跃次数 $N_{1\\to 2}$。有效速率常数 $k_{12}$ 的最直接估计量是观测到的跃迁频率，即事件总数除以总暴露时间。\n因此，对于 $1 \\to 2$ 过程的有效速率常数由下式给出：\n$$\nk_{12} = \\frac{N_{1\\to 2}}{T_{1}}\n$$\n类似地，对于逆过程，即从态 $2$ 到态 $1$ 的跃迁，有效速率常数 $k_{21}$ 由下式给出：\n$$\nk_{21} = \\frac{N_{2\\to 1}}{T_{2}}\n$$\n其中 $N_{2\\to 1}$ 是从态 $2$ 到态 $1$ 的跳跃次数，$T_{2}$ 是在态 $2$ 上的总驻留时间。\n\n**2. 平衡约束（细致平衡）的推导**\n\n设 $P_1(t)$ 和 $P_2(t)$ 分别为时刻 $t$ 态 $1$ 和态 $2$ 的布居数。对于一个两态马尔可夫过程，这些布居数的时间演化由主方程描述：\n$$\n\\frac{dP_1(t)}{dt} = -k_{12} P_1(t) + k_{21} P_2(t)\n$$\n$$\n\\frac{dP_2(t)}{dt} = +k_{12} P_1(t) - k_{21} P_2(t)\n$$\n问题陈述模拟已达到一个稳态。在稳态下，布居数是恒定的，即 $\\frac{dP_1}{dt} = \\frac{dP_2}{dt} = 0$。这导出了细致平衡条件：\n$$\nk_{12} P_{1}^{\\text{st}} = k_{21} P_{2}^{\\text{st}}\n$$\n其中 $P_{1}^{\\text{st}}$ 和 $P_{2}^{\\text{st}}$ 分别是态 $1$ 和态 $2$ 的稳态布居数。\n\n问题明确指出核自由度构成一个温度为 $T = 300\\,\\mathrm{K}$ 的正则热浴，并且时间平均等于系综平均。这个遍历假设意味着在模拟中观测到的稳态布居数对应于统计力学预测的在该温度下系统的平衡布居数。对于能量分别为 $E_1$ 和 $E_2$ 的两个电子态，它们的平衡布居数之比由玻尔兹曼因子给出：\n$$\n\\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = Z_2/Z_1 \\exp\\left(-\\frac{E_2 - E_1}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数，$Z_i$ 是每个态内任何内禀自由度的配分函数。对于这里所暗示的简单电子态，我们可以取 $Z_1=Z_2=1$。问题以摩尔量的形式给出了能隙 $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 和理想气体常数 $R_{\\mathrm{g}}$。我们使用恒等式 $R_{\\mathrm{g}} = N_A k_B$（其中 $N_A$ 是阿伏伽德罗常数），将指数项的自变量写成摩尔形式：\n$$\n\\frac{E_2 - E_1}{k_B T} = \\frac{N_A (E_2 - E_1)}{N_A k_B T} = \\frac{\\Delta E}{R_{\\mathrm{g}} T}\n$$\n因此，平衡布居数比为：\n$$\n\\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = \\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right)\n$$\n令稳态布居数与平衡布居数相等（$P_i^{\\text{st}} = P_i^{\\text{eq}}$），并将其代入细致平衡条件，我们得到平衡状态下速率常数之间的预期关系：\n$$\n\\frac{k_{12}}{k_{21}} = \\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = \\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right)\n$$\n这就是所要求的平衡约束。\n\n**3. Q 值的计算**\n\n我们被要求计算无量纲量 $Q$，其定义为实验观测到的速率常数比与理论预期的速率常数比之比：\n$$\nQ \\equiv \\frac{(k_{12}/k_{21})_{\\text{observed}}}{(k_{12}/k_{21})_{\\text{theory}}} = \\frac{(k_{12}/k_{21})_{\\text{observed}}}{\\exp(-\\Delta E/(R_{\\mathrm{g}} T))}\n$$\n首先，我们使用推导出的表达式和提供的模拟数据计算观测到的速率常数比：\n$T_{1} = 9.95 \\times 10^{-6}\\,\\mathrm{s}$，$T_{2} = 2.04 \\times 10^{-6}\\,\\mathrm{s}$，$N_{1\\to 2} = 50{,}112$ 和 $N_{2\\to 1} = 49{,}888$。\n$$\n\\left(\\frac{k_{12}}{k_{21}}\\right)_{\\text{observed}} = \\frac{N_{1\\to 2}/T_{1}}{N_{2\\to 1}/T_{2}} = \\frac{N_{1\\to 2} T_{2}}{N_{2\\to 1} T_{1}} = \\frac{50112 \\times (2.04 \\times 10^{-6})}{49888 \\times (9.95 \\times 10^{-6})} = \\frac{102228.48}{496385.6} \\approx 0.205946\n$$\n接下来，我们根据细致平衡原理计算理论比率。给定值为 $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 3950\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$T = 300\\,\\mathrm{K}$ 和 $R_{\\mathrm{g}} = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n$$\n\\frac{\\Delta E}{R_{\\mathrm{g}} T} = \\frac{3950}{8.314462618 \\times 300} \\approx 1.58359\n$$\n理论比率为：\n$$\n\\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right) \\approx \\exp(-1.58359) \\approx 0.205234\n$$\n最后，我们计算 $Q$：\n$$\nQ = \\frac{0.205946}{0.205234} \\approx 1.003471\n$$\n按要求将此结果四舍五入到四位有效数字，得到 $Q = 1.003$。\n\n**4. 关于采样不确定性的评述**\n\n$Q$ 的值非常接近 $1$，这表明模拟结果与细致平衡的理论预期非常吻合。问题在于，这个与 $1$ 的偏差在统计上是否有意义，或者仅仅是有限采样的结果。我们假设跳跃次数 $N_{1\\to 2}$ 和 $N_{2\\to 1}$ 是独立的泊松随机变量，因此它们的标准差为 $\\sigma_{N_{1\\to 2}} = \\sqrt{N_{1\\to 2}}$ 和 $\\sigma_{N_{2\\to 1}} = \\sqrt{N_{2\\to 1}}$。驻留时间 $T_1$ 和 $T_2$ 被视为精确值。\n令 $R_{\\text{obs}} = (N_{1\\to 2} T_2) / (N_{2\\to 1} T_1)$。$R_{\\text{obs}}$ 的相对不确定度由标准误差传播公式给出：\n$$\n\\frac{\\sigma_{R_{\\text{obs}}}}{R_{\\text{obs}}} = \\sqrt{\\left(\\frac{\\sigma_{N_{1\\to 2}}}{N_{1\\to 2}}\\right)^2 + \\left(\\frac{\\sigma_{N_{2\\to 1}}}{N_{2\\to 1}}\\right)^2} = \\sqrt{\\frac{1}{N_{1\\to 2}} + \\frac{1}{N_{2\\to 1}}}\n$$\n代入数值：\n$$\n\\frac{\\sigma_{R_{\\text{obs}}}}{R_{\\text{obs}}} = \\sqrt{\\frac{1}{50112} + \\frac{1}{49888}} \\approx \\sqrt{1.9955 \\times 10^{-5} + 2.0045 \\times 10^{-5}} \\approx 0.006324\n$$\n观测比率的绝对不确定度为 $\\sigma_{R_{\\text{obs}}} = R_{\\text{obs}} \\times 0.006324 \\approx 0.205946 \\times 0.006324 \\approx 0.001302$。\n观测比率与理论比率之间的偏差为 $|R_{\\text{obs}} - R_{\\text{theory}}| = |0.205946 - 0.205234| = 0.000712$。\n这个偏差小于计算出的测量标准差（$0.000712  0.001302$）。该偏差的 Z 分数约为 $0.000712 / 0.001302 \\approx 0.55$。由于这小于一个标准差，观测到的差异在统计上是不显著的。在有限长度轨道的预期统计噪声范围内，模拟结果与细致平衡原理完全一致。$Q$ 与 1 的偏差没有意义。", "answer": "$$\\boxed{1.003}$$", "id": "2928309"}]}