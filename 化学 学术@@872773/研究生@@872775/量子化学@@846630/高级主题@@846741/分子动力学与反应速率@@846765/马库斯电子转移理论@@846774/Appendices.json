{"hands_on_practices": [{"introduction": "马库斯理论的威力在于它能为电子转移反应的速率提供定量估算。第一个练习 [@problem_id:2904068] 是一个基础计算，旨在将理论直接付诸实践。通过使用经典的非绝热速率表达式，您将根据一组给定的关键参数计算速率常数，从而在应用核心方程和处理关键的单位换算方面获得必要经验。", "problem": "在非绝热（黄金法则）极限下，一个施主-受主电子转移发生在两个谐振自由能面之间，其特征在于重组能 $\\lambda = 0.8\\,\\mathrm{eV}$ 和标准反应自由能 $\\Delta G^\\circ = -0.6\\,\\mathrm{eV}$，温度为 $T = 298\\,\\mathrm{K}$。电子耦合（假设为Condon近似且各向同性）由光谱学给出，为 $V = 10\\,\\mathrm{cm}^{-1}$。从费米黄金法则和经典谐振溶剂具有线性响应（因此能隙涨落是高斯的）的假设出发，推导非绝热速率表达式，然后根据这些参数数值计算速率常数。将最终数值结果以 $\\mathrm{s}^{-1}$ 为单位表示，并将答案四舍五入到三位有效数字。\n\n使用以下常数（能量单位与电子伏特一致）：\n- 玻尔兹曼常数 $k_{B} = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV\\,K}^{-1}$，\n- 约化普朗克常数 $\\hbar = 6.582119569 \\times 10^{-16}\\,\\mathrm{eV\\,s}$，\n- 普朗克常数与光速的乘积 $hc = 1.239841984 \\times 10^{-4}\\,\\mathrm{eV\\,cm}$。\n\n您可以假设核模式处于经典高温极限，并且反应物和产物态的自由能面是抛物线形的。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 重组能：$\\lambda = 0.8\\,\\mathrm{eV}$\n- 标准反应自由能：$\\Delta G^\\circ = -0.6\\,\\mathrm{eV}$\n- 温度：$T = 298\\,\\mathrm{K}$\n- 电子耦合：$V = 10\\,\\mathrm{cm}^{-1}$\n- 玻尔兹曼常数：$k_{B} = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV\\,K}^{-1}$\n- 约化普朗克常数：$\\hbar = 6.582119569 \\times 10^{-16}\\,\\mathrm{eV\\,s}$\n- 普朗克常数与光速的乘积：$hc = 1.239841984 \\times 10^{-4}\\,\\mathrm{eV\\,cm}$\n- 假设：非绝热（黄金法则）极限，两个谐振自由能面，Condon近似且各向同性的电子耦合，具有线性响应的经典谐振溶剂（高斯能隙涨落），核模式的经典高温极限，以及抛物线自由能面。\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是Marcus理论的一个标准应用，Marcus理论是化学物理学中描述电子转移反应的一个公认的基础模型。所有假设都是该理论经典处理中的标准假设。\n- **提法明确：** 该问题提供了推导速率表达式和计算速率常数唯一数值所需的所有必要参数和物理常数。\n- **客观性：** 问题以精确、定量的术语表述，没有任何主观性或歧义。\n\n步骤3：结论与行动\n该问题在科学上是合理的、自洽的且提法明确。因此，它被认为是**有效的**。我们继续进行推导和求解。\n\n非绝热电子转移过程的速率常数 $k_{ET}$ 由适用于热平衡系统的费米黄金法则给出：\n$$ k_{ET} = \\frac{2\\pi}{\\hbar} |V|^2 (\\text{FCWD}) $$\n其中 $|V|$ 是施主和受主态之间的电子耦合的大小（在Condon近似下假定为常数），$(\\text{FCWD})$ 是Franck-Condon加权态密度。对于与热浴接触的系统，$(\\text{FCWD})$可以表示为时间相关函数的傅里叶变换：\n$$ k_{ET} = \\frac{|V|^2}{\\hbar^2} \\int_{-\\infty}^{\\infty} dt \\, \\langle \\exp\\left(\\frac{i}{\\hbar} H_i t\\right) \\exp\\left(-\\frac{i}{\\hbar} H_f t\\right) \\rangle $$\n这里，$H_i$ 和 $H_f$ 分别是初始（反应物）态和最终（产物）态的核哈密顿量，尖括号表示对初始态振动系综的热平均。这可以根据能隙 $U(t) = H_f(t) - H_i(t)$ 重写为：\n$$ k_{ET} = \\frac{|V|^2}{\\hbar^2} \\int_{-\\infty}^{\\infty} dt \\, \\exp\\left(\\frac{i\\Delta G^\\circ t}{\\hbar}\\right) \\left\\langle T \\exp\\left(-\\frac{i}{\\hbar} \\int_0^t d\\tau \\, \\delta U(\\tau) \\right) \\right\\rangle $$\n其中 $T$ 是时间排序算符，$\\delta U(\\tau)$ 表示能隙在其平均值附近的涨落。问题陈述我们假设一个具有线性响应的经典谐振溶剂，这意味着能隙涨落是高斯的。根据二阶累积量展开定理，热平均得到显著简化。在高温经典极限下，线型函数由下式给出：\n$$ G(t) = \\exp\\left(-\\frac{i\\lambda t}{\\hbar} - \\frac{\\lambda k_B T t^2}{\\hbar^2}\\right) $$\n将此代入速率表达式得到：\n$$ k_{ET} = \\frac{|V|^2}{\\hbar^2} \\int_{-\\infty}^{\\infty} dt \\, \\exp\\left(\\frac{i\\Delta G^\\circ t}{\\hbar}\\right) \\exp\\left(-\\frac{i\\lambda t}{\\hbar} - \\frac{\\lambda k_B T t^2}{\\hbar^2}\\right) $$\n$$ k_{ET} = \\frac{|V|^2}{\\hbar^2} \\int_{-\\infty}^{\\infty} dt \\, \\exp\\left(-\\frac{\\lambda k_B T}{\\hbar^2} t^2 + \\frac{i(\\Delta G^\\circ - \\lambda)t}{\\hbar} \\right) $$\n在使用此线型函数的标准推导中似乎存在一个相位误差。典范的推导方法是沿着一个集体溶剂坐标 $q$ 考虑反应物和产物的自由能面 $G_R(q)$ 和 $G_P(q)$。\n$$ G_R(q) = \\frac{1}{2}cq^2 $$\n$$ G_P(q) = \\frac{1}{2}c(q-q_0)^2 + \\Delta G^\\circ $$\n重组能为 $\\lambda = \\frac{1}{2}cq_0^2$。速率与达到交叉点构型的概率成正比，该构型的活化能为 $\\Delta G^\\ddagger$。通过设 $G_R(q^\\ddagger) = G_P(q^\\ddagger)$ 可以找到该活化能，从而得出表达式：\n$$ \\Delta G^\\ddagger = \\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda} $$\n从费米法则出发，通过更仔细的分析推导出的正确半经典表达式是：\n$$ k_{ET} = \\frac{|V|^2}{\\hbar} \\sqrt{\\frac{\\pi}{\\lambda k_B T}} \\exp\\left(-\\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda k_B T}\\right) $$\n这就是经典的非绝热极限下著名的Marcus电子转移速率方程。我们将计算这个表达式。\n\n首先，我们必须确保所有参数的单位一致，我们选择电子伏特 ($\\mathrm{eV}$) 和秒 ($\\mathrm{s}$)。\n电子耦合 $V$ 以波数 ($\\mathrm{cm}^{-1}$) 给出，必须使用关系式 $E = hc\\tilde{\\nu}$ 将其转换为 $\\mathrm{eV}$：\n$$ V = (10\\,\\mathrm{cm}^{-1}) \\times (1.239841984 \\times 10^{-4}\\,\\mathrm{eV\\,cm}) = 1.239841984 \\times 10^{-3}\\,\\mathrm{eV} $$\n现在我们计算速率方程的各个组成部分。\n电子耦合的平方为：\n$$ |V|^2 = (1.239841984 \\times 10^{-3}\\,\\mathrm{eV})^2 \\approx 1.5372097 \\times 10^{-6}\\,\\mathrm{eV}^2 $$\n热能为：\n$$ k_B T = (8.617333262 \\times 10^{-5}\\,\\mathrm{eV\\,K}^{-1}) \\times (298\\,\\mathrm{K}) \\approx 0.025679653\\,\\mathrm{eV} $$\n平方根分母中的项 $\\lambda k_B T$ 为：\n$$ \\lambda k_B T = (0.8\\,\\mathrm{eV}) \\times (0.025679653\\,\\mathrm{eV}) \\approx 0.020543722\\,\\mathrm{eV}^2 $$\n平方根项为：\n$$ \\sqrt{\\frac{\\pi}{\\lambda k_B T}} = \\sqrt{\\frac{\\pi}{0.020543722\\,\\mathrm{eV}^2}} \\approx 12.365327\\,\\mathrm{eV}^{-1} $$\n指数函数的自变量是 $-\\Delta G^\\ddagger / k_B T$：\n$$ \\frac{\\Delta G^\\ddagger}{k_B T} = \\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda k_B T} $$\n首先，计算分子：\n$$ (\\lambda + \\Delta G^\\circ)^2 = (0.8\\,\\mathrm{eV} - 0.6\\,\\mathrm{eV})^2 = (0.2\\,\\mathrm{eV})^2 = 0.04\\,\\mathrm{eV}^2 $$\n接下来，计算分母：\n$$ 4\\lambda k_B T = 4 \\times (0.020543722\\,\\mathrm{eV}^2) \\approx 0.082174888\\,\\mathrm{eV}^2 $$\n指数的值为：\n$$ -\\frac{0.04\\,\\mathrm{eV}^2}{0.082174888\\,\\mathrm{eV}^2} \\approx -0.486763 $$\n指数因子为：\n$$ \\exp(-0.486763) \\approx 0.614631 $$\n最后，我们将所有部分组合起来计算速率常数 $k_{ET}$：\n$$ k_{ET} = \\frac{|V|^2}{\\hbar} \\sqrt{\\frac{\\pi}{\\lambda k_B T}} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{k_B T}\\right) $$\n$$ k_{ET} = \\left(\\frac{1.5372097 \\times 10^{-6}\\,\\mathrm{eV}^2}{6.582119569 \\times 10^{-16}\\,\\mathrm{eV\\,s}}\\right) \\times (12.365327\\,\\mathrm{eV}^{-1}) \\times (0.614631) $$\n计算各项：\n$$ \\frac{|V|^2}{\\hbar} \\approx 2.335334 \\times 10^9\\,\\mathrm{eV\\,s^{-1}} $$\n$$ k_{ET} \\approx (2.335334 \\times 10^9\\,\\mathrm{eV\\,s^{-1}}) \\times (12.365327\\,\\mathrm{eV}^{-1}) \\times (0.614631) $$\n$$ k_{ET} \\approx 1.77615 \\times 10^{10}\\,\\mathrm{s}^{-1} $$\n按照题目要求，四舍五入到三位有效数字：\n$$ k_{ET} \\approx 1.78 \\times 10^{10}\\,\\mathrm{s}^{-1} $$\n这个结果表示在Marcus正常区内的电子转移速率，在该区域，速率随着驱动力 $-\\Delta G^\\circ$ 的增加而增加。给定的参数使得系统处于给定重组能下的最佳速率附近。", "answer": "$$\n\\boxed{1.78 \\times 10^{10}}\n$$", "id": "2904068"}, {"introduction": "在前面的练习中，重组能 $\\lambda$ 是一个给定值。但对于一个真实的分子体系，这个关键参数实际上是如何确定的呢？本实践 [@problem_id:2904117] 深入探讨了现代计算方法，指导您从第一性原理出发，计算内层 ($\\lambda_{\\text{in}}$) 和外层 ($\\lambda_{\\text{out}}$) 的贡献。通过分析模拟的能隙波动和量子振动数据，您将看到马库斯理论如何将宏观可观测量与分子及其环境的微观动力学联系起来。", "problem": "要求您形式化一个结合了分子动力学（MD）和量子化学（QC）的热力学循环，以计算总的 Marcus 重组能。该总能量是溶剂涨落产生的外层重组能与分子内振动产生的内层重组能之和。您的任务是实现一个完整的程序，该程序基于此循环和第一性原理推导，为提供的测试套件计算外层和内层贡献及其总和的数值。\n\n推导必须从适用于凝聚相电子转移的基本基础出发：透热态的谐波自由能面、温度 $T$ 下的玻尔兹曼分布、线性响应和涨落-耗散定理（FDT），以及分子内简正模式的谐振子描述。您必须从这些原理出发，得出一个算法，该算法能够：\n- 利用固定温度 $T$ 下经典 MD 模拟得到的垂直能隙涨落的统计数据来确定外层重组能。\n- 利用 QC 提供的简正模式图像（针对给体和受体平衡结构之间的小位移）直接从模式分辨的性质确定内层重组能。\n\n在您的推导中，请勿使用或引用任何现成的电子转移公式作为起点。相反，您应从上述基本基础出发，论证每一步，然后加以实现。\n\n需要遵守的数学和物理要求：\n- 在线性响应下，将溶剂坐标视为高斯分布，并通过平衡涨落理论将谐波自由能面的曲率与温度 $T$ 下垂直能隙的方差联系起来。\n- 将分子内模式视为独立的谐振子，并用模式能量和位移来表示重组能。您可以使用光子能量关系 $\\Delta E = h c \\tilde{\\nu}$ 将波数 $\\tilde{\\nu}$（单位为 $\\mathrm{cm}^{-1}$）与振动能量子联系起来，并使用在位移谐波势上 Huang–Rhys 因子的标准定义。\n\n实现细节和单位：\n- 玻尔兹曼常数 $k_{\\mathrm{B}}$ 必须使用电子伏特每开尔文（eV/K）作为单位，其值为 $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}$ $\\mathrm{eV/K}$。\n- 普朗克常数 $h$ 和光速 $c$ 应以 $h c$ 的组合形式使用，使得 $h c \\, \\tilde{\\nu}$ 能将波数 $\\tilde{\\nu}$（单位为 $\\mathrm{cm}^{-1}$）转换为以电子伏特为单位的能量。请使用精确转换关系 $1\\,\\mathrm{cm}^{-1} \\mapsto 1.239841984 \\times 10^{-4}$ $\\mathrm{eV}$。\n- 能量必须以电子伏特报告，并四舍五入到六位小数。\n- 温度单位必须是开尔文。\n- 不使用角度单位。\n- 能隙的系综方差必须取为给定样本中各值与算术平均值之差的平方的算术平均值（即，除数为 $N$ 的总体方差，而非无偏估计量）。\n\n您的程序不应接受任何输入，并且必须在内部计算以下四个测试案例。\n\n测试套件（每个测试案例提供温度 $T$（单位K）、垂直能隙 $\\Delta E$ 的MD时间序列（单位eV），以及QC振动数据，形式为 $(\\tilde{\\nu}_i, S_i)$ 对，其中 $\\tilde{\\nu}_i$ 的单位为 $\\mathrm{cm}^{-1}$，$S_i$ 为 Huang–Rhys 因子）：\n- 案例A（典型条件）：\n  - $T = 300$\n  - $\\Delta E$ 样本：$[0.10, 0.12, 0.08, 0.11, 0.09]$\n  - 模式：$(\\tilde{\\nu}, S) = [(1500, 0.5), (300, 0.2)]$\n- 案例B（零涨落和零耦合的边界情况）：\n  - $T = 298$\n  - $\\Delta E$ 样本：$[0.20, 0.20, 0.20, 0.20]$\n  - 模式：$(\\tilde{\\nu}, S) = [(1000, 0.0), (500, 0.0)]$\n- 案例C（大溶剂涨落和强单模耦合）：\n  - $T = 310$\n  - $\\Delta E$ 样本：$[-0.05, 0.05, -0.15, 0.15, 0.00]$\n  - 模式：$(\\tilde{\\nu}, S) = [(1800, 1.2)]$\n- 案例D（非零平均能隙，多个弱耦合模式）：\n  - $T = 350$\n  - $\\Delta E$ 样本：$[0.30, 0.25, 0.35, 0.20]$\n  - 模式：$(\\tilde{\\nu}, S) = [(1000, 0.3), (1200, 0.1), (500, 0.05)]$\n\n对于每个测试案例，您的程序必须计算并返回包含三个数字的列表：\n- 外层重组能 $\\lambda_{\\mathrm{out}}$，单位为 eV。\n- 内层重组能 $\\lambda_{\\mathrm{in}}$，单位为 eV。\n- 总重组能 $\\lambda = \\lambda_{\\mathrm{out}} + \\lambda_{\\mathrm{in}}$，单位为 eV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的结果，格式为逗号分隔的列表的列表，每个内部列表包含上述三个数字，均四舍五入到六位小数，例如：$[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]$。", "solution": "必须首先验证问题陈述的正确性和可解性。\n\n步骤 1：提取给定信息。\n- 物理背景是凝聚相中的 Marcus 电子转移理论。\n- 使用的基本原理：透热态的谐波自由能面、玻尔兹曼分布、线性响应理论、涨落-耗散定理（FDT），以及分子内简正模式的谐振子描述。\n- 任务是计算外层重组能（$\\lambda_{\\mathrm{out}}$）、内层重组能（$\\lambda_{\\mathrm{in}}$）和总重组能（$\\lambda = \\lambda_{\\mathrm{out}} + \\lambda_{\\mathrm{in}}$）。\n- **常数**：\n  - 玻尔兹曼常数：$k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}$ $\\mathrm{eV/K}$。\n  - 波数到能量的转换：$1\\,\\mathrm{cm}^{-1} \\mapsto 1.239841984 \\times 10^{-4}$ $\\mathrm{eV}$。\n- **方法论约束**：\n  - $\\lambda_{\\mathrm{out}}$ 通过经典分子动力学（MD）模拟得到的垂直能隙涨落的统计数据确定。\n  - $\\lambda_{\\mathrm{in}}$ 通过量子化学（QC）计算得到的模式分辨性质确定。\n  - 能隙的系综方差是总体方差（除数为 $N$）。\n- **测试案例**：\n  - 案例A：$T = 300$ K, $\\Delta E$ 样本 = $[0.10, 0.12, 0.08, 0.11, 0.09]$ eV, 模式 $(\\tilde{\\nu}, S)$ = $[(1500, 0.5), (300, 0.2)]$。\n  - 案例B：$T = 298$ K, $\\Delta E$ 样本 = $[0.20, 0.20, 0.20, 0.20]$ eV, 模式 $(\\tilde{\\nu}, S)$ = $[(1000, 0.0), (500, 0.0)]$。\n  - 案例C：$T = 310$ K, $\\Delta E$ 样本 = $[-0.05, 0.05, -0.15, 0.15, 0.00]$ eV, 模式 $(\\tilde{\\nu}, S)$ = $[(1800, 1.2)]$。\n  - 案例D：$T = 350$ K, $\\Delta E$ 样本 = $[0.30, 0.25, 0.35, 0.20]$ eV, 模式 $(\\tilde{\\nu}, S)$ = $[(1000, 0.3), (1200, 0.1), (500, 0.05)]$。\n\n步骤 2：使用提取的信息进行验证。\n- **科学依据**：该问题基于 Marcus 电子转移理论，这是化学和物理学中一个获得诺贝尔奖的基础理论。指定的第一性原理方法（线性响应、FDT、谐波近似）是标准的、科学上合理的。\n- **适定性**：该问题提供了计算所需量的所有必要数据和常数。推导路径清晰，可以为每个测试案例得出唯一且有意义的解。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性或歧义。\n该问题并非科学上不合理、不可形式化、不完整、不切实际、不适定或微不足道。它要求从基本原理进行正确的推导，并将其应用于数值数据。\n\n步骤 3：结论与行动。\n问题有效。我们继续进行推导和求解。\n\n**从第一性原理推导**\n\n电子转移过程被描述为两个透热电子态之间的跃迁，即反应物态 $R$（例如，电荷定域于给体）和产物态 $P$（例如，电荷定域于受体）。这些态的能量取决于周围溶剂的构型和分子的内部几何结构。我们将原子核坐标分为两组：溶剂的集体坐标 $X$，以及一组内部分子振动简正模式坐标 $\\{q_j\\}$。我们假设这两者是可分离的。\n\n**1. 外层重组能 ($\\lambda_{\\mathrm{out}}$)**\n\n我们通过单个集体坐标 $X$ 来模拟溶剂效应。在线性响应近似下，反应物态（$G_R$）和产物态（$G_P$）的自由能面随 $X$ 的变化呈抛物线形：\n$$ G_R(X) = \\frac{1}{2} k X^2 $$\n$$ G_P(X) = \\frac{1}{2} k (X - X_0)^2 + \\Delta G^0_{\\mathrm{el}} $$\n为方便起见，我们将反应物能面的最小值设置在 $X=0$ 处。产物能面具有相同的曲率（力常数 $k$），其最小值平移至 $X=X_0$。$\\Delta G^0_{\\mathrm{el}}$ 是在产物平衡几何构型下反应的自由能变化。\n\n外层重组能 $\\lambda_{\\mathrm{out}}$ 定义为系统保持在反应物自由能面上，从反应物的平衡构型（$X=0$）移动到产物的平衡构型（$X=X_0$）所需的能量。\n$$ \\lambda_{\\mathrm{out}} = G_R(X_0) - G_R(0) = \\frac{1}{2} k X_0^2 $$\n\n问题要求我们将其与垂直能隙 $\\Delta E(X) = G_P(X) - G_R(X)$ 的涨落联系起来。\n$$ \\Delta E(X) = \\left( \\frac{1}{2} k (X - X_0)^2 + \\Delta G^0_{\\mathrm{el}} \\right) - \\left( \\frac{1}{2} k X^2 \\right) = -k X_0 X + \\frac{1}{2} k X_0^2 + \\Delta G^0_{\\mathrm{el}} $$\n认识到 $\\lambda_{\\mathrm{out}} = \\frac{1}{2} k X_0^2$，我们可以写出：\n$$ \\Delta E(X) = -k X_0 X + \\lambda_{\\mathrm{out}} + \\Delta G^0_{\\mathrm{el}} $$\n\n在反应物态的经典 MD 模拟中，系统根据玻尔兹曼分布 $P(X) \\propto \\exp(-G_R(X) / (k_{\\mathrm{B}} T))$ 对构型 $X$ 进行采样。由于 $G_R(X)$ 是二次的， $X$ 的分布是高斯分布，其均值为 $\\langle X \\rangle = 0$，方差为 $\\sigma_X^2 = \\langle X^2 \\rangle - \\langle X \\rangle^2 = \\langle X^2 \\rangle$。根据谐波势的平衡统计力学，该方差由 $\\sigma_X^2 = k_{\\mathrm{B}} T / k$ 给出。\n\n我们现在计算在反应物态的平衡涨落上能隙的方差 $\\sigma_{\\Delta E}^2$。平均能隙为 $\\langle \\Delta E \\rangle = \\langle -k X_0 X + \\lambda_{\\mathrm{out}} + \\Delta G^0_{\\mathrm{el}} \\rangle = \\lambda_{\\mathrm{out}} + \\Delta G^0_{\\mathrm{el}}$，因为 $\\langle X \\rangle = 0$。\n方差为：\n$$ \\sigma_{\\Delta E}^2 = \\langle (\\Delta E - \\langle \\Delta E \\rangle)^2 \\rangle = \\langle (-k X_0 X)^2 \\rangle = (k X_0)^2 \\langle X^2 \\rangle $$\n代入 $\\langle X^2 \\rangle = k_{\\mathrm{B}} T / k$：\n$$ \\sigma_{\\Delta E}^2 = (k X_0)^2 \\frac{k_{\\mathrm{B}} T}{k} = k X_0^2 k_{\\mathrm{B}} T $$\n我们有两个关系式：$\\lambda_{\\mathrm{out}} = \\frac{1}{2} k X_0^2$ 和 $\\sigma_{\\Delta E}^2 = k X_0^2 k_{\\mathrm{B}} T$。我们可以通过注意到 $k X_0^2 = \\sigma_{\\Delta E}^2 / (k_{\\mathrm{B}} T)$ 来消去微观参数 $k$ 和 $X_0$。将此代入 $\\lambda_{\\mathrm{out}}$ 的表达式中，即可得到期望的结果，这是涨落-耗散定理的一个实例：\n$$ \\lambda_{\\mathrm{out}} = \\frac{1}{2} \\left( \\frac{\\sigma_{\\Delta E}^2}{k_{\\mathrm{B}} T} \\right) = \\frac{\\sigma_{\\Delta E}^2}{2 k_{\\mathrm{B}} T} $$\n方差 $\\sigma_{\\Delta E}^2$ 是从提供的 $\\Delta E$ 值的 MD 时间序列计算得出的。对于大小为 $N$ 的样本，总体方差为 $\\sigma_{\\Delta E}^2 = \\frac{1}{N} \\sum_{i=1}^N (\\Delta E_i - \\mu_{\\Delta E})^2$，其中 $\\mu_{\\Delta E} = \\frac{1}{N} \\sum_{i=1}^N \\Delta E_i$。\n\n**2. 内层重组能 ($\\lambda_{\\mathrm{in}}$)**\n\n分子内振动被视为一组独立的谐振子。对于具有坐标 $q_j$ 和角频率 $\\omega_j$ 的单个简正模式 $j$，反应物和产物电子态的势能面为：\n$$ V_R(q_j) = \\frac{1}{2} m_j \\omega_j^2 q_j^2 $$\n$$ V_P(q_j) = \\frac{1}{2} m_j \\omega_j^2 (q_j - d_j)^2 $$\n其中 $d_j$ 是电子转移时沿模式 $j$ 的平衡几何构型的位移。\n\n该模式的内层重组能 $\\lambda_{j, \\mathrm{in}}$ 是将反应物从其平衡构型（$q_j=0$）扭曲到产物的平衡几何构型（$q_j=d_j$）所需的能量：\n$$ \\lambda_{j, \\mathrm{in}} = V_R(d_j) - V_R(0) = \\frac{1}{2} m_j \\omega_j^2 d_j^2 $$\n问题提供了无量纲的 Huang-Rhys 因子 $S_j$，其定义为以振动能量子 $\\hbar \\omega_j$ 为单位的重组能：\n$$ S_j = \\frac{\\lambda_{j, \\mathrm{in}}}{\\hbar \\omega_j} $$\n因此，$\\lambda_{j, \\mathrm{in}} = S_j \\hbar \\omega_j$。振动能量子可以使用波数 $\\tilde{\\nu}_j$（单位为 $\\mathrm{cm}^{-1}$）通过关系式 $\\Delta E_j = h c \\tilde{\\nu}_j$ 来表示，其中 $h$ 是普朗克常数，$c$ 是光速。请注意 $\\hbar \\omega_j = h c \\tilde{\\nu}_j$。\n所以，模式 $j$ 的贡献是：\n$$ \\lambda_{j, \\mathrm{in}} = S_j (h c \\tilde{\\nu}_j) $$\n由于模式是独立的，总内层重组能是所有模式贡献的总和：\n$$ \\lambda_{\\mathrm{in}} = \\sum_j \\lambda_{j, \\mathrm{in}} = \\sum_j S_j (h c \\tilde{\\nu}_j) $$\n能量项 $h c \\tilde{\\nu}_j$ 使用提供的从 $\\mathrm{cm}^{-1}$ 到 $\\mathrm{eV}$ 的转换因子计算。\n\n**3. 总重组能 ($\\lambda$)**\n\n在溶剂坐标和分子内坐标可分离的假设下，总重组能是外层和内层贡献的总和：\n$$ \\lambda = \\lambda_{\\mathrm{out}} + \\lambda_{\\mathrm{in}} $$\n\n这就完成了实现解决方案所需的推导。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes outer-sphere, inner-sphere, and total Marcus reorganization energies\n    for a suite of test cases based on first-principles derivations.\n    \"\"\"\n    # Define physical constants as specified in the problem.\n    # Boltzmann constant in eV/K.\n    K_B = 8.617333262e-5\n    # Conversion factor from cm^-1 to eV.\n    CM_TO_EV = 1.239841984e-4\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 300,  # Kelvin\n            \"delta_E_samples\": [0.10, 0.12, 0.08, 0.11, 0.09],  # eV\n            \"modes\": [(1500, 0.5), (300, 0.2)]  # (wavenumber cm^-1, Huang-Rhys factor S)\n        },\n        {\n            \"T\": 298,\n            \"delta_E_samples\": [0.20, 0.20, 0.20, 0.20],\n            \"modes\": [(1000, 0.0), (500, 0.0)]\n        },\n        {\n            \"T\": 310,\n            \"delta_E_samples\": [-0.05, 0.05, -0.15, 0.15, 0.00],\n            \"modes\": [(1800, 1.2)]\n        },\n        {\n            \"T\": 350,\n            \"delta_E_samples\": [0.30, 0.25, 0.35, 0.20],\n            \"modes\": [(1000, 0.3), (1200, 0.1), (500, 0.05)]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        T = case[\"T\"]\n        delta_E_samples = np.array(case[\"delta_E_samples\"])\n        modes = case[\"modes\"]\n\n        # --- Calculate Outer-Sphere Reorganization Energy (lambda_out) ---\n        # The derivation yields lambda_out = sigma_E^2 / (2 * k_B * T), where\n        # sigma_E^2 is the variance of the vertical energy gap fluctuations.\n        # The problem specifies to use the population variance (ddof=0), which is numpy's default.\n        if len(delta_E_samples)  0:\n            variance_delta_E = np.var(delta_E_samples)\n        else:\n            variance_delta_E = 0.0\n            \n        # Thermal energy term\n        k_B_T = K_B * T\n        \n        # Avoid division by zero if T=0, though not in test cases\n        if k_B_T  0:\n            lambda_out = variance_delta_E / (2 * k_B_T)\n        else:\n            lambda_out = 0.0\n\n        # --- Calculate Inner-Sphere Reorganization Energy (lambda_in) ---\n        # The derivation yields lambda_in = sum_j(S_j * h * c * nu_j), where\n        # S_j is the Huang-Rhys factor and (h*c*nu_j) is the vibrational energy quantum for mode j.\n        lambda_in = 0.0\n        for wavenumber, S_factor in modes:\n            # Convert wavenumber (cm^-1) to vibrational energy quantum (eV)\n            vibrational_energy = wavenumber * CM_TO_EV\n            # Add the mode's contribution to the total inner-sphere energy\n            lambda_in += S_factor * vibrational_energy\n\n        # --- Calculate Total Reorganization Energy (lambda) ---\n        lambda_total = lambda_out + lambda_in\n\n        # Round results to six decimal places as required\n        results_for_case = [\n            round(lambda_out, 6),\n            round(lambda_in, 6),\n            round(lambda_total, 6)\n        ]\n        all_results.append(results_for_case)\n\n    # Format the final output string exactly as specified.\n    # Example format: [[a,b,c],[d,e,f],[g,h,i],[j,k,l]]\n    result_str = str(all_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```", "id": "2904117"}, {"introduction": "除了计算单一速率，马库斯理论还提供了一个框架，用以理解反应速率如何响应变化的条件。最后一个实践 [@problem_id:1991067] 挑战您像理论家一样思考，分析速率方程本身的函数形式。您将推导出一个使电子转移速率最大化的最佳温度表达式，揭示该理论一个引人入胜且并非显而易见的预测，这对分子器件的设计具有重要意义。", "problem": "一个研究团队正在为一种人工光合作用装置设计一种分子二元体。该装置的效率取决于一个关键的非绝热电子转移步骤，即电子从一个光激发供体转移到一个受体。这一过程的速率常数 $k_{ET}$ 由半经典的 Marcus 理论方程描述：\n\n$$k_{ET} = \\frac{2\\pi}{\\hbar} |H_{ab}|^2 \\frac{1}{\\sqrt{4\\pi \\lambda k_B T}} \\exp\\left(-\\frac{(\\lambda + \\Delta G^\\circ)^2}{4 \\lambda k_B T}\\right)$$\n\n在此方程中，$\\hbar$ 是约化普朗克常数， $|H_{ab}|$ 是供体和受体态之间的电子耦合，$\\lambda$ 是重组能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，而 $\\Delta G^\\circ$ 是电子转移反应的标准吉布斯自由能变。\n\n所研究的特定分子系统已知在 Marcus 倒转区深处运行，在该区域中，随着驱动力的增加，反应变得更不利，其特征是满足条件 $-\\Delta G^\\circ  \\lambda$。为最大化电荷分离的效率，研究人员需要使装置在最佳温度下运行。\n\n推导使电子转移速率常数 $k_{ET}$ 最大化的最佳温度 $T_{opt}$ 的闭式解析表达式。你的最终表达式应以重组能 $\\lambda$、标准吉布斯自由能变 $\\Delta G^\\circ$ 和玻尔兹曼常数 $k_B$ 来表示。", "solution": "我们从给定的非绝热电子转移的半经典 Marcus 速率表达式开始，\n$$\nk_{ET}(T) = \\frac{2\\pi}{\\hbar} |H_{ab}|^{2} \\frac{1}{\\sqrt{4\\pi \\lambda k_{B} T}} \\exp\\left(-\\frac{(\\lambda + \\Delta G^{\\circ})^{2}}{4 \\lambda k_{B} T}\\right).\n$$\n为了分离出对温度的依赖关系，我们将 $K_{0}$ 和 $A$ 定义为不依赖于 $T$ 的常数：\n$$\nK_{0} \\equiv \\frac{2\\pi}{\\hbar} |H_{ab}|^{2} \\frac{1}{\\sqrt{4\\pi \\lambda k_{B}}}, \\quad A \\equiv \\frac{(\\lambda + \\Delta G^{\\circ})^{2}}{4 \\lambda k_{B}}.\n$$\n由此得到\n$$\nk_{ET}(T) = K_{0}\\, T^{-1/2} \\exp\\left(-\\frac{A}{T}\\right).\n$$\n为了找到使 $k_{ET}(T)$ 最大化的最佳温度 $T_{opt}$，我们对 $\\ln k_{ET}(T)$ 求极大值，这是一个单调变换：\n$$\n\\ln k_{ET}(T) = \\ln K_{0} - \\frac{1}{2} \\ln T - \\frac{A}{T}.\n$$\n对 $T$ 求导，并令其导数为零：\n$$\n\\frac{d}{dT}\\ln k_{ET}(T) = -\\frac{1}{2T} + \\frac{A}{T^{2}} = 0.\n$$\n两边乘以 $T^{2}$ 得到\n$$\n-\\frac{T}{2} + A = 0 \\quad \\Rightarrow \\quad T = 2A.\n$$\n为确认该驻点是一个极大值点，计算二阶导数：\n$$\n\\frac{d^{2}}{dT^{2}}\\ln k_{ET}(T) = \\frac{1}{2T^{2}} - \\frac{2A}{T^{3}},\n$$\n并在 $T = 2A$ 处求值：\n$$\n\\left.\\frac{d^{2}}{dT^{2}}\\ln k_{ET}(T)\\right|_{T=2A} = \\frac{1}{8A^{2}} - \\frac{1}{4A^{2}} = -\\frac{1}{8A^{2}}  0,\n$$\n这证实了该点为极大值点。将 $A$ 代回，得到\n$$\nT_{opt} = 2A = \\frac{(\\lambda + \\Delta G^{\\circ})^{2}}{2 \\lambda k_{B}}.\n$$\n在 Marcus 倒转区，$-\\Delta G^{\\circ}  \\lambda$ 意味着 $\\lambda + \\Delta G^{\\circ}  0$，但平方项确保了 $T_{opt}  0$，因此该表达式在此区域内是有效的。", "answer": "$$\\boxed{\\frac{(\\lambda + \\Delta G^{\\circ})^{2}}{2 \\lambda k_{B}}}$$", "id": "1991067"}]}