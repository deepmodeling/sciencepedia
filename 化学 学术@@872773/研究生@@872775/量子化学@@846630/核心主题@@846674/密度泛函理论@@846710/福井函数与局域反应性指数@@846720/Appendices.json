{"hands_on_practices": [{"introduction": "要将福井函数等概念密度泛函理论（Conceptual DFT）中的抽象概念付诸实践，关键的第一步是理解如何将其与量子化学计算的输出结果联系起来。本练习旨在建立这种联系。我们将通过一个思想实验，推导出亲电攻击的凝聚福井函数 $f_k^-$ 与原子电荷变化之间的直接关系，而原子电荷是各种布局分析方案中的标准输出。这个练习将阐明理论定义与实际计算之间的桥梁。", "problem": "在概念密度泛函理论 (CDFT) 中，福井函数 $f(\\mathbf{r}) = \\left(\\frac{\\partial \\rho(\\mathbf{r})}{\\partial N}\\right)_{v(\\mathbf{r})}$（其中 $\\rho(\\mathbf{r})$ 是电子密度，$N$ 是电子数）作为一个局域反应性指标。为了获得每个原子的量，通过在原子盆内积分将其进行凝聚。对于原子 $k$，亲电攻击的凝聚福井函数 $f_k^-$ 表示该原子被亲电（接受电子）物种攻击的倾向。它可以通过对电子数使用有限差分格式来近似，即从体系中移除一个电子后原子 $k$ 的电子布居数 $q_k$ 的变化量：$f_k^- \\approx q_k(N) - q_k(N-1)$。\n\n考虑对水分子 (H₂O) 及其对应的阳离子 (H₂O⁺) 进行的一系列量子化学计算。所有计算都使用相同且固定的原子核几何构型，该构型对应于中性 H₂O 分子的优化平衡结构。通过 Mulliken 布居分析获得了以下性质：\n\n*   对于中性分子（H₂O，有 $N$ 个电子）：\n    *   总电子能量：$E^{(0)}$\n    *   氧原子上的 Mulliken 电荷：$Q_{O}^{(0)}$\n    *   每个氢原子上的 Mulliken 电荷：$Q_{H}^{(0)}$\n\n*   对于分子阳离子（H₂O⁺，有 $N-1$ 个电子）：\n    *   总电子能量：$E^{(+1)}$\n    *   氧原子上的 Mulliken 电荷：$Q_{O}^{(+1)}$\n    *   每个氢原子上的 Mulliken 电荷：$Q_{H}^{(+1)}$\n\n对于核电荷为 $Z_k$ 的原子 $k$，其 Mulliken 电荷 ($Q_k$) 和 Mulliken 电子布居数 ($q_k$) 之间的关系由 $Q_k = Z_k - q_k$ 给出。同时给定氧原子的核电荷 $Z_O$。\n\n利用所提供的信息，推导氧原子上亲电攻击的凝聚福井函数 $f_O^-$ 的符号表达式。", "solution": "1. 原子 $k$ 上亲电攻击的凝聚福井函数可以通过其 Mulliken 布居数的有限差分来近似：\n$$\nf_k^- \\approx q_k(N) - q_k(N-1)\\,.\n$$\n2. 对于氧原子 ($k=O$)，该式变为\n$$\nf_O^- \\approx q_O(N) - q_O(N-1)\\,.\n$$\n3. Mulliken 电荷 $Q_O$ 和 Mulliken 布居数 $q_O$ 之间的关系为\n$$\nQ_O = Z_O - q_O\n\\quad\\Longrightarrow\\quad\nq_O = Z_O - Q_O\\,.\n$$\n4. 代入有限差分表达式中：\n$$\nf_O^- \n\\approx \\bigl(Z_O - Q_O^{(0)}\\bigr)\n- \\bigl(Z_O - Q_O^{(+1)}\\bigr)\n= -Q_O^{(0)} + Q_O^{(+1)}\n= Q_O^{(+1)} - Q_O^{(0)}\\,.\n$$", "answer": "$$\\boxed{Q_O^{(+1)} - Q_O^{(0)}}$$", "id": "180140"}, {"introduction": "掌握了基本关系后，我们便可以将这一过程系统化，用于预测不同分子中的反应位点。本练习将理论付诸于算法实践。您将处理一系列假设分子的原子布居数据，计算出亲核攻击指数 $f_k^+$ 和亲电攻击指数 $f_k^-$，并编写程序来自动识别最可能的反应位点。这模拟了计算化学家在评估分子反应性时的典型工作流程。", "problem": "对于几种模型体系，在固定的核几何构型和外势下，通过指定的布居分析方案，为您提供了原子凝聚电子布居。从概念密度泛函理论（DFT）的角度出发，从核心定义开始：电子化学势 $\\mu$ 是偏导数 $\\mu = \\left(\\partial E / \\partial N\\right)_{v(\\mathbf{r})}$，全局硬度 $\\eta$ 是二阶导数 $\\eta = \\left(\\partial^2 E / \\partial N^2\\right)_{v(\\mathbf{r})}$。使用经过充分检验的有限差分近似，结合电离势 $I$ 和电子亲和能 $A$，公式如下：$\\mu \\approx -\\left(I + A\\right)/2$ 以及 $\\eta \\approx I - A$。全局软度为 $S = 1/\\eta$。原子凝聚福井函数定义为，在固定几何构型和外势下，当总电子数改变 $\\pm 1$ 时，原子凝聚电子布居的变化。对于原子 $k$，将其在 $N$ 电子体系中的电子布居记为 $P_k(N)$，在 $(N+1)$ 电子体系中记为 $P_k(N+1)$，在 $(N-1)$ 电子体系中记为 $P_k(N-1)$，所有这些布居都是在相同几何构型下通过相同的布居分析方案获得的。然后使用有限差分来构建 $f_k^{+}$（用于电子加成）和 $f_k^{-}$（用于电子移除）。在理想计算中，$\\sum_k f_k^{+}$ 和 $\\sum_k f_k^{-}$ 的总和应各自等于 $1$。反应活性的解释如下：最易发生亲核攻击的位点（即亲核试剂会攻击分子的位点）对应于具有最大 $f_k^{+}$ 值的原子 $k$，而最易发生亲电攻击的位点则对应于具有最大 $f_k^{-}$ 值的原子 $k$。如果出现平局，选择最小的原子索引。\n\n您的任务是实现一个程序，该程序对每个测试用例，根据提供的布居数据计算数组 $\\{f_k^{+}\\}$ 和 $\\{f_k^{-}\\}$，在容差范围内验证归一化条件 $\\sum_k f_k^{+} = 1$ 和 $\\sum_k f_k^{-} = 1$，并返回具有最大 $f_k^{+}$ 和最大 $f_k^{-}$ 的原子的基于 1 的索引，以及一个布尔值，该布尔值指示两个总和是否都在容差范围内。您无需输出 $\\mu$、$\\eta$ 或 $S$，但如果计算它们，请对 $I$ 和 $A$ 使用电子伏特 (eV) 单位，这样 $\\mu$ 和 $\\eta$ 的单位也将是 eV，而 $S$ 的单位是 $\\mathrm{eV}^{-1}$。\n\n请使用以下测试套件。在每个案例中，数组都按原子索引排序，并且所有值都遵循指定的相同布居分析方案。对于每个案例，$P_k(N+1)$ 与 $P_k(N)$ 之间以及 $P_k(N)$ 与 $P_k(N-1)$ 之间的总电子布居恰好相差 $1$。\n\n- 测试用例 1 (分子 $\\mathsf{M1}$，Mulliken 方案)：\n  - $P(N) = [4.20, 3.80, 1.00, 1.00]$\n  - $P(N+1) = [4.50, 4.10, 1.10, 1.30]$\n  - $P(N-1) = [3.90, 3.40, 0.90, 0.80]$\n  - $I = 10.5~\\mathrm{eV}$，$A = 1.5~\\mathrm{eV}$\n- 测试用例 2 (原子 $\\mathsf{A}$，自然布居分析)：\n  - $P(N) = [1.00]$\n  - $P(N+1) = [2.00]$\n  - $P(N-1) = [0.00]$\n  - $I = 13.6~\\mathrm{eV}$，$A = 0.754~\\mathrm{eV}$\n- 测试用例 3 (分子 $\\mathsf{M2}$，Hirshfeld 方案)：\n  - $P(N) = [6.00, 2.00, 1.00, 1.00, 0.00]$\n  - $P(N+1) = [5.80, 2.40, 1.20, 1.30, 0.30]$\n  - $P(N-1) = [5.70, 1.60, 0.80, 0.70, 0.20]$\n  - $I = 9.2~\\mathrm{eV}$，$A = 2.0~\\mathrm{eV}$\n- 测试用例 4 (分子 $\\mathsf{M3}$，Becke 方案)：\n  - $P(N) = [2.50, 2.50, 5.00]$\n  - $P(N+1) = [2.60, 2.50, 5.90]$\n  - $P(N-1) = [2.10, 2.10, 4.80]$\n  - $I = 8.0~\\mathrm{eV}$，$A = 0.5~\\mathrm{eV}$\n\n计算要求与评估：\n- 对于每个测试用例，为所有原子 $k$ 计算 $f_k^{+} = P_k(N+1) - P_k(N)$ 和 $f_k^{-} = P_k(N) - P_k(N-1)$。\n- 确定具有最大 $f_k^{+}$ 值的原子的基于 1 的索引 $i_{+}$，以及具有最大 $f_k^{-}$ 值的原子的基于 1 的索引 $i_{-}$。如果出现平局，选择最小的索引。\n- 验证 $\\left|\\sum_k f_k^{+} - 1\\right| \\leq 10^{-6}$ 和 $\\left|\\sum_k f_k^{-} - 1\\right| \\leq 10^{-6}$。如果两个条件都满足，则布尔值 $b$ 为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果以 $[i_{+}, i_{-}, b]$ 的子列表形式呈现。例如，整体输出应类似于 $[[i_{+}^{(1)}, i_{-}^{(1)}, b^{(1)}],[i_{+}^{(2)}, i_{-}^{(2)}, b^{(2)}],\\dots]$，不含空格。", "solution": "所提出的问题是概念密度泛函理论（DFT）中的一个计算练习。它要求根据所提供的几种分子体系和电荷态下的原子凝聚电子布居，计算原子凝聚福井函数。该问题在化学和数学上都是合理的，并且解决问题所需的所有数据均已提供。因此，它被认为是一个有效的问题。\n\n其理论基础是电子能量 $E$、电子数 $N$ 以及由原子核产生的外势 $v(\\mathbf{r})$ 之间的关系。电子化学势 $\\mu$ 和全局硬度 $\\eta$ 定义为在固定外势下，能量对电子数的一阶和二阶导数：\n$$ \\mu = \\left(\\frac{\\partial E}{\\partial N}\\right)_{v(\\mathbf{r})} $$\n$$ \\eta = \\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_{v(\\mathbf{r})} $$\n在实际计算中，这些导数是使用基于体系电离势 $I$ 和电子亲和能 $A$ 的有限差分方案来近似的。电离势是能量差 $I = E(N-1) - E(N)$，电子亲和能是 $A = E(N) - E(N+1)$。其近似公式为：\n$$ \\mu \\approx -\\frac{I+A}{2} $$\n$$ \\eta \\approx I - A $$\n尽管问题提供了 $I$ 和 $A$ 的值，但它们只是背景信息，并非主要任务所必需。问题的核心在于福井函数 $f(\\mathbf{r})$ 的概念，它描述了当总电子数变化时电子密度 $\\rho(\\mathbf{r})$ 的变化：\n$$ f(\\mathbf{r}) = \\left(\\frac{\\partial \\rho(\\mathbf{r})}{\\partial N}\\right)_{v(\\mathbf{r})} $$\n该问题要求计算*原子凝聚*福井函数 $f_k$。这些函数是通过在分子中原子 $k$ 的盆（basin）上对福井函数 $f(\\mathbf{r})$ 进行积分得到的。一种更简单、更直接的方法，也是问题中指定的方法，是将有限差分近似直接应用于原子凝聚电子布居 $P_k$。\n\n我们定义两种类型的凝聚福井函数：\n1. $f_k^{+}$ 用于亲核攻击（电子的加成）。这是当一个电子添加到体系中时，原子 $k$ 上的布居变化。\n2. $f_k^{-}$ 用于亲电攻击（电子的移除）。这是当一个电子从体系中移除时，原子 $k$ 上的布居变化。\n\n对电子加成使用前向差分，对电子移除使用后向差分，我们得到所需的计算公式：\n$$ f_k^{+} = P_k(N+1) - P_k(N) $$\n$$ f_k^{-} = P_k(N) - P_k(N-1) $$\n此处，$P_k(N)$、$P_k(N+1)$ 和 $P_k(N-1)$ 分别是 $N$ 电子、$(N+1)$ 电子和 $(N-1)$ 电子体系中原子 $k$ 上的电子布居。\n\n福井函数的一个基本性质是它们的积分（或在凝聚情况下为求和）为 1。这源于电子数的守恒。原子布居的总和必须等于总电子数，即对于任何具有 $M$ 个电子的体系，$\\sum_k P_k(M) = M$。因此：\n$$ \\sum_k f_k^{+} = \\sum_k \\left(P_k(N+1) - P_k(N)\\right) = \\sum_k P_k(N+1) - \\sum_k P_k(N) = (N+1) - N = 1 $$\n$$ \\sum_k f_k^{-} = \\sum_k \\left(P_k(N) - P_k(N-1)\\right) = \\sum_k P_k(N) - \\sum_k P_k(N-1) = N - (N-1) = 1 $$\n问题正确地要求在 $10^{-6}$ 的数值容差内验证此归一化条件。\n\n每个测试用例的计算步骤如下：\n1. 给定布居数组 $P(N+1)$、$P(N)$ 和 $P(N-1)$。\n2. 使用有限差分公式计算凝聚福井函数数组 $\\{f_k^{+}\\}$ 和 $\\{f_k^{-}\\}$。\n3. 验证 $|\\sum_k f_k^{+} - 1| \\leq 10^{-6}$ 和 $|\\sum_k f_k^{-} - 1| \\leq 10^{-6}$ 是否都满足。此检查的结果存储在布尔变量 $b$ 中。\n4. 通过在 $\\{f_k^{+}\\}$ 数组中找到最大值，来确定最易受亲核攻击的原子。该原子的基于 1 的索引记为 $i_{+}$。\n5. 通过在 $\\{f_k^{-}\\}$ 数组中找到最大值，来确定最易受亲电攻击的原子。该原子的基于 1 的索引记为 $i_{-}$。\n6. 如遇最大值出现平局，按规定选择索引最小的原子。\n7. 该测试用例的最终结果是三元组 $[i_{+}, i_{-}, b]$。\n\n让我们以测试用例 1 进行演示：\n- $P(N) = [4.20, 3.80, 1.00, 1.00]$\n- $P(N+1) = [4.50, 4.10, 1.10, 1.30]$\n- $P(N-1) = [3.90, 3.40, 0.90, 0.80]$\n\n首先，我们计算 $\\{f_k^{+}\\}$：\n$f^{+} = [4.50-4.20, 4.10-3.80, 1.10-1.00, 1.30-1.00] = [0.30, 0.30, 0.10, 0.30]$\n以及 $\\{f_k^{-}\\}$：\n$f^{-} = [4.20-3.90, 3.80-3.40, 1.00-0.90, 1.00-0.80] = [0.30, 0.40, 0.10, 0.20]$\n\n接下来，我们检查归一化：\n$\\sum_k f_k^{+} = 0.30 + 0.30 + 0.10 + 0.30 = 1.00$。$|\\,1.00 - 1\\,| \\leq 10^{-6}$。条件满足。\n$\\sum_k f_k^{-} = 0.30 + 0.40 + 0.10 + 0.20 = 1.00$。$|\\,1.00 - 1\\,| \\leq 10^{-6}$。条件满足。\n因此，$b = \\mathrm{True}$。\n\n现在，我们寻找反应位点：\n对于 $f^{+}$，最大值为 $0.30$，出现在索引 $1$、$2$ 和 $4$ 处。最小的索引是 $1$，所以 $i_{+} = 1$。\n对于 $f^{-}$，最大值为 $0.40$，唯一地出现在索引 $2$ 处，所以 $i_{-} = 2$。\n\n测试用例 1 的结果是 $[1, 2, \\mathrm{True}]$。对所有提供的测试用例重复此过程。实现将使用 `numpy` 进行高效的数组操作，特别是用于逐元素相减和使用 `np.argmax` 查找最大值的索引，`np.argmax` 符合选择最小索引的平局决胜规则。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes condensed Fukui functions and identifies most reactive sites\n    based on conceptual Density Functional Theory definitions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"p_n\": np.array([4.20, 3.80, 1.00, 1.00]),\n            \"p_nplus1\": np.array([4.50, 4.10, 1.10, 1.30]),\n            \"p_nminus1\": np.array([3.90, 3.40, 0.90, 0.80]),\n        },\n        {\n            \"p_n\": np.array([1.00]),\n            \"p_nplus1\": np.array([2.00]),\n            \"p_nminus1\": np.array([0.00]),\n        },\n        {\n            \"p_n\": np.array([6.00, 2.00, 1.00, 1.00, 0.00]),\n            \"p_nplus1\": np.array([5.80, 2.40, 1.20, 1.30, 0.30]),\n            \"p_nminus1\": np.array([5.70, 1.60, 0.80, 0.70, 0.20]),\n        },\n        {\n            \"p_n\": np.array([2.50, 2.50, 5.00]),\n            \"p_nplus1\": np.array([2.60, 2.50, 5.90]),\n            \"p_nminus1\": np.array([2.10, 2.10, 4.80]),\n        },\n    ]\n\n    all_results = []\n    tolerance = 1e-6\n\n    for case in test_cases:\n        p_n = case[\"p_n\"]\n        p_nplus1 = case[\"p_nplus1\"]\n        p_nminus1 = case[\"p_nminus1\"]\n\n        # Compute condensed Fukui functions\n        # f_k^+ = P_k(N+1) - P_k(N)\n        f_plus = p_nplus1 - p_n\n        \n        # f_k^- = P_k(N) - P_k(N-1)\n        f_minus = p_n - p_nminus1\n\n        # Verify normalization\n        sum_f_plus = np.sum(f_plus)\n        sum_f_minus = np.sum(f_minus)\n        \n        is_normalized = (np.abs(sum_f_plus - 1.0) = tolerance and \n                         np.abs(sum_f_minus - 1.0) = tolerance)\n\n        # Determine indices of maximum f_k^+ and f_k^-\n        # np.argmax returns the index of the first occurrence of the maximum value,\n        # which satisfies the tie-breaking rule of choosing the smallest index.\n        # Add 1 to convert from 0-based to 1-based indexing.\n        i_plus = np.argmax(f_plus) + 1\n        i_minus = np.argmax(f_minus) + 1\n        \n        # Assemble the result for the current case\n        all_results.append([i_plus, i_minus, is_normalized])\n\n    # Format the final output string as specified, without any spaces.\n    # e.g., [[1,2,True],[1,1,True],...]\n    result_strings = [f\"[{res[0]},{res[1]},{str(res[2])}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2879277"}, {"introduction": "除了识别最活跃的单个位点，我们还可以使用更精细的指标来描绘一个分子上不同区域的反应性特征。本练习引入了一个更强大的工具——对偶描述符 $\\Delta f_k$。我们将以丙烯醛为例，这是一个经典的极性不饱和分子，通过计算其关键原子的 $\\Delta f_k$ 值，您将看到该指标的正负号如何出色地解释其复杂的区域选择性：为何某些位点易受亲核试剂攻击，而另一些位点则易受亲电试剂攻击。这展示了概念密度泛函理论在解释真实化学反应模式方面的强大预测能力。", "problem": "一个孤立的平面分子是典型的极性不饱和亲电体：丙烯醛（propenal, $\\text{CH}_2\\text{=CH–CHO}$），它是一种 $\\alpha,\\beta$-不饱和醛。在概念密度泛函理论（conceptual DFT）的框架内，位置 $\\mathbf{r}$ 处的Fukui函数定义为在恒定外势下，电子密度对电子数的导数，即 $f(\\mathbf{r})=\\left(\\partial \\rho(\\mathbf{r})/\\partial N\\right)_{v(\\mathbf{r})}$。在实际应用中，通常采用原子凝聚近似法，利用总原子电子布居数来构建有限差分估计，以评估对亲核和亲电攻击的反应性。\n\n考虑丙烯醛共轭片段中的四个重原子：羰基氧O、羰基碳$\\mathrm{C_{C=O}}$、$\\alpha$-碳$\\mathrm{C_{\\alpha}}$（与$\\mathrm{C_{C=O}}$直接相连的乙烯基碳）以及$\\beta$-碳$\\mathrm{C_{\\beta}}$（末端乙烯基碳）。布居分析得出了具有$N$个电子的中性物种、具有$N+1$个电子的阴离子以及具有$N-1$个电子的阳离子的以下总原子电子布居数：\n- O: $P_{\\mathrm{O}}(N-1)=7.00$, $P_{\\mathrm{O}}(N)=7.50$, $P_{\\mathrm{O}}(N+1)=7.60$。\n- $\\mathrm{C_{C=O}}$: $P_{\\mathrm{C_{C=O}}}(N-1)=3.65$, $P_{\\mathrm{C_{C=O}}}(N)=3.70$, $P_{\\mathrm{C_{C=O}}}(N+1)=3.90$。\n- $\\mathrm{C_{\\alpha}}$: $P_{\\mathrm{C_{\\alpha}}}(N-1)=3.00$, $P_{\\mathrm{C_{\\alpha}}}(N)=3.30$, $P_{\\mathrm{C_{\\alpha}}}(N+1)=3.50$。\n- $\\mathrm{C_{\\beta}}$: $P_{\\mathrm{C_{\\beta}}}(N-1)=2.85$, $P_{\\mathrm{C_{\\beta}}}(N)=3.00$, $P_{\\mathrm{C_{\\beta}}}(N+1)=3.50$。\n\n仅使用基本定义 $f(\\mathbf{r})=\\left(\\partial \\rho(\\mathbf{r})/\\partial N\\right)_{v(\\mathbf{r})}$ 和基于这些总布居数的标准原子凝聚有限差分框架，推导出每个原子上相应的凝聚亲核和亲电反应性指数，然后计算这四个原子中每个原子的双描述符 $\\Delta f_k$，其中 $k\\in\\{\\mathrm{O},\\mathrm{C_{C=O}},\\mathrm{C_{\\alpha}},\\mathrm{C_{\\beta}}\\}$。最后，利用 $\\Delta f_k$ 的符号，将您的结果与已知的$\\alpha,\\beta$-不饱和羰基化合物的亲核加成与亲电加成的区域选择性关联起来。\n\n以单行矩阵的形式，按 $\\left(\\mathrm{O},\\,\\mathrm{C_{C=O}},\\,\\mathrm{C_{\\alpha}},\\,\\mathrm{C_{\\beta}}\\right)$ 的顺序报告您计算出的 $\\Delta f_k$ 的最终数值结果。无需四舍五入，$\\Delta f_k$ 无需单位。", "solution": "该问题需进行验证。\n\n**步骤1：提取已知信息**\n- **体系**：一个孤立的平面丙烯醛分子（$\\mathrm{CH_2=CH–CHO}$）。\n- **目标原子**：共轭片段中的四个重原子：羰基氧（$\\mathrm{O}$）、羰基碳（$\\mathrm{C_{C=O}}$）、α-碳（$\\mathrm{C_{\\alpha}}$）和β-碳（$\\mathrm{C_{\\beta}}$）。\n- **基本定义**：Fukui函数为 $f(\\mathbf{r})=\\left(\\frac{\\partial \\rho(\\mathbf{r})}{\\partial N}\\right)_{v(\\mathbf{r})}$。\n- **近似**：将使用原子凝聚的有限差分框架。\n- **数据**：阳离子（$N-1$个电子）、中性物种（$N$个电子）和阴离子（$N+1$个电子）的总原子电子布居数 $P_k$。\n  - 对于原子 $\\mathrm{O}$：$P_{\\mathrm{O}}(N-1)=7.00$, $P_{\\mathrm{O}}(N)=7.50$, $P_{\\mathrm{O}}(N+1)=7.60$。\n  - 对于原子 $\\mathrm{C_{C=O}}$：$P_{\\mathrm{C_{C=O}}}(N-1)=3.65$, $P_{\\mathrm{C_{C=O}}}(N)=3.70$, $P_{\\mathrm{C_{C=O}}}(N+1)=3.90$。\n  - 对于原子 $\\mathrm{C_{\\alpha}}$：$P_{\\mathrm{C_{\\alpha}}}(N-1)=3.00$, $P_{\\mathrm{C_{\\alpha}}}(N)=3.30$, $P_{\\mathrm{C_{\\alpha}}}(N+1)=3.50$。\n  - 对于原子 $\\mathrm{C_{\\beta}}$：$P_{\\mathrm{C_{\\beta}}}(N-1)=2.85$, $P_{\\mathrm{C_{\\beta}}}(N)=3.00$, $P_{\\mathrm{C_{\\beta}}}(N+1)=3.50$。\n- **任务**：\n  1. 推导凝聚的亲核和亲电反应性指数。\n  2. 计算每个原子 $k\\in\\{\\mathrm{O},\\mathrm{C_{C=O}},\\mathrm{C_{\\alpha}},\\mathrm{C_{\\beta}}\\}$ 的双描述符 $\\Delta f_k$。\n  3. 将 $\\Delta f_k$ 的符号与已知的丙烯醛区域选择性相关联。\n  4. 以行矩阵的形式，按 $(\\mathrm{O}, \\mathrm{C_{C=O}}, \\mathrm{C_{\\alpha}}, \\mathrm{C_{\\beta}})$ 的顺序报告 $\\Delta f_k$ 的最终值。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题在科学上基于概念密度泛函理论（DFT），这是量子化学的一个标准且严谨的分支。Fukui函数、凝聚反应性指数和双描述符等定义和概念都是公认的。该问题提法明确，为所需计算提供了所有必要的数值数据。为检查内部一致性，我们验证了总电子布居数的变化。\n- 对于增加一个电子（$N \\to N+1$）：布居数变化之和为 $\\Delta P_{total}^+ = (P_{\\mathrm{O}}(N+1) - P_{\\mathrm{O}}(N)) + (P_{\\mathrm{C_{C=O}}}(N+1) - P_{\\mathrm{C_{C=O}}}(N)) + (P_{\\mathrm{C_{\\alpha}}}(N+1) - P_{\\mathrm{C_{\\alpha}}}(N)) + (P_{\\mathrm{C_{\\beta}}}(N+1) - P_{\\mathrm{C_{\\beta}}}(N)) = (7.60-7.50) + (3.90-3.70) + (3.50-3.30) + (3.50-3.00) = 0.10 + 0.20 + 0.20 + 0.50 = 1.00$。这与获得一个电子的情况相符。\n- 对于减少一个电子（$N \\to N-1$）：布居数变化之和为 $\\Delta P_{total}^- = (P_{\\mathrm{O}}(N) - P_{\\mathrm{O}}(N-1)) + (P_{\\mathrm{C_{C=O}}}(N) - P_{\\mathrm{C_{C=O}}}(N-1)) + (P_{\\mathrm{C_{\\alpha}}}(N) - P_{\\mathrm{C_{\\alpha}}}(N-1)) + (P_{\\mathrm{C_{\\beta}}}(N) - P_{\\mathrm{C_{\\beta}}}(N-1)) = (7.50-7.00) + (3.70-3.65) + (3.30-3.00) + (3.00-2.85) = 0.50 + 0.05 + 0.30 + 0.15 = 1.00$。这与失去一个电子的情况相符。\n该问题客观、完整，不含任何科学谬误或歧义。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n**解题推导**\n\nFukui函数 $f(\\mathbf{r}) = \\left(\\frac{\\partial \\rho(\\mathbf{r})}{\\partial N}\\right)_{v(\\mathbf{r})}$ 量化了在总电子数 $N$ 发生无穷小变化时，某点 $\\mathbf{r}$ 处电子密度 $\\rho(\\mathbf{r})$ 的变化。在原子凝聚近似中，这被简化为原子 $k$ 上电子布居数 $P_k$ 的变化：\n$$\nf_k = \\left(\\frac{\\partial P_k}{\\partial N}\\right)_v\n$$\n该导数在 $N$ 为整数值时不连续。因此，我们必须考虑左导数和右导数，并使用有限差分法进行近似。\n\n用于描述亲核攻击的凝聚Fukui函数 $f_k^+$，描述了体系对增加一个电子（受亲核体攻击）的响应。它使用前向差分计算：\n$$\nf_k^+ = \\frac{P_k(N+1) - P_k(N)}{(N+1) - N} = P_k(N+1) - P_k(N)\n$$\n该指数表示位点 $k$ 接受电子的倾向，即其亲电性。\n\n用于描述亲电攻击的凝聚Fukui函数 $f_k^-$，描述了体系对减少一个电子（受亲电体攻击）的响应。它使用后向差分计算：\n$$\nf_k^- = \\frac{P_k(N) - P_k(N-1)}{N - (N-1)} = P_k(N) - P_k(N-1)\n$$\n该指数表示位点 $k$ 给出电子的倾向，即其亲核性。\n\n双描述符 $\\Delta f_k$ 定义为这两个指数之差：\n$$\n\\Delta f_k = f_k^+ - f_k^-\n$$\n代入有限差分表达式可得：\n$$\n\\Delta f_k = (P_k(N+1) - P_k(N)) - (P_k(N) - P_k(N-1)) = P_k(N+1) - 2P_k(N) + P_k(N-1)\n$$\n$\\Delta f_k$ 的符号揭示了位点 $k$ 的主要反应类型。如果 $\\Delta f_k  0$，该位点更容易受到亲核攻击（即具有亲电性）。如果 $\\Delta f_k  0$，该位点更容易受到亲电攻击（即具有亲核性）。\n\n现在我们使用提供的布居数据计算四个指定原子中每个原子的 $\\Delta f_k$。\n\n**1. 羰基氧（$\\mathrm{O}$）**\n- $P_{\\mathrm{O}}(N-1)=7.00$, $P_{\\mathrm{O}}(N)=7.50$, $P_{\\mathrm{O}}(N+1)=7.60$。\n- $f_{\\mathrm{O}}^+ = P_{\\mathrm{O}}(N+1) - P_{\\mathrm{O}}(N) = 7.60 - 7.50 = 0.10$。\n- $f_{\\mathrm{O}}^- = P_{\\mathrm{O}}(N) - P_{\\mathrm{O}}(N-1) = 7.50 - 7.00 = 0.50$。\n- $\\Delta f_{\\mathrm{O}} = f_{\\mathrm{O}}^+ - f_{\\mathrm{O}}^- = 0.10 - 0.50 = -0.40$。\n\n**2. 羰基碳（$\\mathrm{C_{C=O}}$）**\n- $P_{\\mathrm{C_{C=O}}}(N-1)=3.65$, $P_{\\mathrm{C_{C=O}}}(N)=3.70$, $P_{\\mathrm{C_{C=O}}}(N+1)=3.90$。\n- $f_{\\mathrm{C_{C=O}}}^+ = P_{\\mathrm{C_{C=O}}}(N+1) - P_{\\mathrm{C_{C=O}}}(N) = 3.90 - 3.70 = 0.20$。\n- $f_{\\mathrm{C_{C=O}}}^- = P_{\\mathrm{C_{C=O}}}(N) - P_{\\mathrm{C_{C=O}}}(N-1) = 3.70 - 3.65 = 0.05$。\n- $\\Delta f_{\\mathrm{C_{C=O}}} = f_{\\mathrm{C_{C=O}}}^+ - f_{\\mathrm{C_{C=O}}}^- = 0.20 - 0.05 = 0.15$。\n\n**3. α-碳（$\\mathrm{C_{\\alpha}}$）**\n- $P_{\\mathrm{C_{\\alpha}}}(N-1)=3.00$, $P_{\\mathrm{C_{\\alpha}}}(N)=3.30$, $P_{\\mathrm{C_{\\alpha}}}(N+1)=3.50$。\n- $f_{\\mathrm{C_{\\alpha}}}^+ = P_{\\mathrm{C_{\\alpha}}}(N+1) - P_{\\mathrm{C_{\\alpha}}}(N) = 3.50 - 3.30 = 0.20$。\n- $f_{\\mathrm{C_{\\alpha}}}^- = P_{\\mathrm{C_{\\alpha}}}(N) - P_{\\mathrm{C_{\\alpha}}}(N-1) = 3.30 - 3.00 = 0.30$。\n- $\\Delta f_{\\mathrm{C_{\\alpha}}} = f_{\\mathrm{C_{\\alpha}}}^+ - f_{\\mathrm{C_{\\alpha}}}^- = 0.20 - 0.30 = -0.10$。\n\n**4. β-碳（$\\mathrm{C_{\\beta}}$）**\n- $P_{\\mathrm{C_{\\beta}}}(N-1)=2.85$, $P_{\\mathrm{C_{\\beta}}}(N)=3.00$, $P_{\\mathrm{C_{\\beta}}}(N+1)=3.50$。\n- $f_{\\mathrm{C_{\\beta}}}^+ = P_{\\mathrm{C_{\\beta}}}(N+1) - P_{\\mathrm{C_{\\beta}}}(N) = 3.50 - 3.00 = 0.50$。\n- $f_{\\mathrm{C_{\\beta}}}^- = P_{\\mathrm{C_{\\beta}}}(N) - P_{\\mathrm{C_{\\beta}}}(N-1) = 3.00 - 2.85 = 0.15$。\n- $\\Delta f_{\\mathrm{C_{\\beta}}} = f_{\\mathrm{C_{\\beta}}}^+ - f_{\\mathrm{C_{\\beta}}}^- = 0.50 - 0.15 = 0.35$。\n\n**与区域选择性的关联**\n计算得到的双描述符值为：\n- $\\Delta f_{\\mathrm{O}} = -0.40$ (亲核性)\n- $\\Delta f_{\\mathrm{C_{C=O}}} = 0.15$ (亲电性)\n- $\\Delta f_{\\mathrm{C_{\\alpha}}} = -0.10$ (亲核性)\n- $\\Delta f_{\\mathrm{C_{\\beta}}} = 0.35$ (亲电性)\n\n正的 $\\Delta f_k$ 表示一个亲电位点，易受亲核体攻击。负的 $\\Delta f_k$ 表示一个亲核位点，易受亲电体攻击。$\\Delta f_k$ 的绝对值大小对应于这种性质的强弱。\n\n- **亲核攻击**：理论预测亲核体将攻击 $\\Delta f_k  0$ 的位点。因此，亲电位点是 $\\mathrm{C_{C=O}}$ ($\\Delta f = 0.15$) 和 $\\mathrm{C_{\\beta}}$ ($\\Delta f = 0.35$)。$\\mathrm{C_{\\beta}}$ 处较大的正值表明它是最具亲电性的中心。这与已知的 $\\alpha,\\beta$-不饱和羰基化合物的化学性质非常吻合，其中 $\\beta$-碳是共轭（Michael）加成的位点，特别是对于软亲核体。羰基碳是直接（$1,2$-）加成的位点，通常对于硬亲核体。双描述符正确地识别出这两个位点都易受亲核攻击，并正确地将 $\\beta$-碳排为总体上更具亲电性的位点。\n\n- **亲电攻击**：理论预测亲电体将攻击 $\\Delta f_k  0$ 的位点。因此，亲核位点是羰基氧 $\\mathrm{O}$ ($\\Delta f = -0.40$) 和 $\\alpha$-碳 $\\mathrm{C_{\\alpha}}$ ($\\Delta f = -0.10$)。氧原子处的大负值表明它是最具亲核性的位点。这与实验观察结果一致，即由于羰基氧具有高电子密度和碱性，质子化或路易斯酸的配位优先发生在该处。\n\n双描述符分析的结果为观察到的丙烯醛的区域选择性提供了化学上正确的解释。\n\n最终结果是 $(\\mathrm{O}, \\mathrm{C_{C=O}}, \\mathrm{C_{\\alpha}}, \\mathrm{C_{\\beta}})$ 的 $\\Delta f_k$ 值的行矩阵。\n$$\n(\\Delta f_{\\mathrm{O}}, \\Delta f_{\\mathrm{C_{C=O}}}, \\Delta f_{\\mathrm{C_{\\alpha}}}, \\Delta f_{\\mathrm{C_{\\beta}}}) = (-0.40, 0.15, -0.10, 0.35)\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -0.40  0.15  -0.10  0.35 \\end{pmatrix}}\n$$", "id": "2929845"}]}