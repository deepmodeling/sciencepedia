{"hands_on_practices": [{"introduction": "化学硬度的概念虽然根植于能量对电子数的二阶导数这一形式化定义，但在实际计算中，我们需要一个更具操作性的表达式。本练习将指导你通过有限差分法，从基本定义出发，推导出化学硬度的实用计算公式 $\\eta \\approx (I-A)/2$，从而在理论与实践之间架起一座桥梁。这个推导不仅是概念密度泛函理论中的一个基本练习[@problem_id:2879233]，也为理解化学反应性奠定了重要的数学基础。", "problem": "考虑在固定外势 $v(\\mathbf{r})$（即固定的核几何构型和电荷）下，基态电子能量作为电子数 $N$ 的函数 $E(N)$。在概念密度泛函理论 (DFT) 中，化学势定义为 $\\mu = \\left(\\frac{\\partial E}{\\partial N}\\right)_{v}$，全局化学硬度定义为 $\\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$。一个经过充分验证的事实是，在固定的 $v(\\mathbf{r})$下，$E(N)$ 在整数之间是分段线性的，并在整数 $N$ 处表现出导数不连续性。垂直电离势和电子亲和能分别通过能量差关联：$I = E(N-1) - E(N)$ 和 $A = E(N) - E(N+1)$，其中所有能量都在相同的几何构型（垂直过程）下计算。\n\n任务：\n1) 在整数 $N$ 处，使用对称三点有限差分近似计算 $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$，推导出一个用 $I$ 和 $A$ 表示 $\\eta$ 的表达式，该表达式需与上述定义以及固定 $v(\\mathbf{r})$ 的条件相一致。\n2) 对于一个特定分子，在单个固定几何构型下进行的高水平电子结构计算得出垂直电离势 $I = 9.47~\\text{eV}$ 和垂直电子亲和能 $A = 1.82~\\text{eV}$。计算全局硬度 $\\eta$，单位为电子伏特。将最终数值结果四舍五入至四位有效数字，并以 $\\text{eV}$ 为单位表示答案。", "solution": "问题陈述已经过严格验证，被认为是科学上可靠、自洽且表述清晰的。它提出了一个概念密度泛函理论 (DFT) 中的标准练习，没有事实错误、矛盾或含糊之处。因此，我们将着手解决此问题。\n\n问题分为两部分。首先，我们必须推导全局化学硬度 $\\eta$ 的表达式，用垂直电离势 $I$ 和垂直电子亲和能 $A$ 来表示。其次，我们必须使用所提供的数据计算 $\\eta$ 的数值。\n\n第一部分：推导 $\\eta$ 的表达式。\n\n全局化学硬度的定义为：\n$$ \\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} $$\n其中 $E(N)$ 是在固定外势 $v(\\mathbf{r})$ 下，基态电子能量作为电子数 $N$ 的函数。\n\n问题要求使用对称三点有限差分近似来计算在整数电子数 $N$ 处的二阶偏导数 $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$。对于函数 $f(x)$ 在点 $x$ 处的二阶导数，对称三点有限差分近似的一般公式为：\n$$ f''(x) \\approx \\frac{f(x+h) - 2f(x) + f(x-h)}{h^2} $$\n在我们的具体情况中，函数是 $E(N)$，计算点是整数 $N$，步长 $h$ 对应于增加或减少一个电子，因此 $h=1$。将此近似应用于能量函数 $E(N)$ 可得：\n$$ \\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} \\approx \\frac{E(N+1) - 2E(N) + E(N-1)}{1^2} = E(N-1) - 2E(N) + E(N+1) $$\n将此结果代入硬度 $\\eta$ 的定义中，我们得到：\n$$ \\eta \\approx \\frac{1}{2} \\left[ E(N-1) - 2E(N) + E(N+1) \\right] $$\n为了用电离势 $I$ 和电子亲和能 $A$ 来表示，我们回顾它们的定义：\n$$ I = E(N-1) - E(N) $$\n$$ A = E(N) - E(N+1) $$\n这些定义是针对垂直过程的，意味着所有能量都在相同的固定核几何构型下计算，这与固定外势条件 $(\\dots)_{v}$ 是一致的。\n\n我们可以通过重新组合能量项来整理 $\\eta$ 的表达式：\n$$ \\eta \\approx \\frac{1}{2} \\left[ (E(N-1) - E(N)) + (E(N+1) - E(N)) \\right] $$\n第一项 $(E(N-1) - E(N))$ 正是电离势 $I$ 的定义。第二项 $(E(N+1) - E(N))$ 是电子亲和能 $A$ 的负值，因为 $A = E(N) - E(N+1)$，这意味着 $-(E(N) - E(N+1)) = E(N+1) - E(N) = -A$。\n\n将这些代入 $\\eta$ 的表达式中，得到所需的关系式：\n$$ \\eta = \\frac{1}{2} (I - A) $$\n这个表达式，被称为硬度的 Parr-Pearson 近似，是任务第一部分的结果。使用等号是合理的，因为在这种概念框架下，这种有限差分形式构成了硬度的一种操作性定义。\n\n第二部分：$\\eta$ 的数值计算。\n\n对于第二部分，我们被给予了一个特定分子的以下数值：\n- 垂直电离势：$I = 9.47~\\text{eV}$\n- 垂直电子亲和能：$A = 1.82~\\text{eV}$\n\n使用上面推导的公式，我们现在可以计算全局硬度 $\\eta$：\n$$ \\eta = \\frac{1}{2} (9.47~\\text{eV} - 1.82~\\text{eV}) $$\n执行括号内的减法：\n$$ \\eta = \\frac{1}{2} (7.65~\\text{eV}) $$\n最后，完成计算：\n$$ \\eta = 3.825~\\text{eV} $$\n问题要求结果保留四位有效数字。计算出的值 $3.825$ 恰好包含四位有效数字。因此，无需进一步四舍五入。最终答案是 $3.825~\\text{eV}$。", "answer": "$$\n\\boxed{3.825}\n$$", "id": "2879233"}, {"introduction": "在计算了基于总能量差的化学硬度之后，一个自然的问题是：我们是否能找到更简便的近似方法？本练习探讨了一种常见的“捷径”——使用前线轨道（HOMO-LUMO）能级差来估算硬度。通过具体的计算案例[@problem_id:2879242]，你将量化这种近似可能导致的显著误差，并深入理解为何对于大多数近似密度泛函，严格的总能量差（$\\Delta E$方法）是获得可靠化学硬度值的首选。", "problem": "给定一系列基态总能量和前线轨道本征值，它们都是通过使用不同交换相关泛函的密度泛函理论 (DFT) 计算，对同一中性体系分别得到的。您的任务是形式化并量化使用总能量差与使用前线轨道本征值这两种选择对计算出的全局化学硬度的影响。\n\n从概念密度泛函理论 (DFT) 中的以下基本基础开始：\n- 在固定外势 $v(\\mathbf{r})$ 下，零温基态能量（记为 $E(N)$）是电子数 $N$（可能为分数）的分段线性函数，在整数 $N$ 处存在拐点。\n- 化学势 $\\mu$ 是一阶导数 $\\mu = \\left(\\partial E / \\partial N\\right)_{v}$，在整数 $N$ 处理解为单边导数。\n- 全局化学硬度 $\\eta$ 是二阶导数 $\\eta = \\frac{1}{2}\\left(\\partial^{2} E / \\partial N^{2}\\right)_{v}$，在整数 $N$ 处通过有限差分进行解释。\n- 电离能 $I$ 和电子亲和能 $A$ 由固定原子核几何构型和外势下的基态能量差定义：移除或增加一个电子会使能量发生明确的变化。\n\n仅使用这些基础，完成以下任务：\n1. 推导电离能 $I$ 和电子亲和能 $A$ 的表达式，将其表示为整数电子数 $N$、$N-1$ 和 $N+1$ 处总能量的差值。\n2. 在整数 $N$ 处使用步长 $\\Delta N = 1$ 的对称有限差分构造，推导全局化学硬度 $\\eta$ 关于 $I$ 和 $A$ 的表达式。\n3. 使用 Kohn–Sham 密度泛函理论 (KS-DFT)、前线轨道理论和 Janak 定理，根据中性体系的最高已占分子轨道 (HOMO) 和最低未占分子轨道 (LUMO) 的 Kohn–Sham 本征值，获得 $I$ 和 $A$ 的近似表达式。清楚地说明您需要对近似泛函的交换相关导数不连续性做出的任何假设。\n4. 定义以下诊断量，以量化使用前线本征值近似替代总能量差对全局硬度的影响：\n   - 硬度的绝对偏差，$\\Delta \\eta_{\\mathrm{abs}} = \\left|\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}\\right|$。\n   - 硬度的相对偏差，$\\Delta \\eta_{\\mathrm{rel}} = \\Delta \\eta_{\\mathrm{abs}} / \\eta_{\\Delta E}$。\n   此处，$\\eta_{\\Delta E}$ 是由总能量差计算出的硬度，$\\eta_{\\mathrm{orb}}$ 是由前线轨道近似计算出的硬度。\n5. 实现一个程序，对于下述每个测试用例，计算 $I$、$A$、$\\eta_{\\Delta E}$、$I$ 和 $A$ 的前线轨道近似值、相应的 $\\eta_{\\mathrm{orb}}$，以及最终的两个诊断量 $\\Delta \\eta_{\\mathrm{abs}}$ 和 $\\Delta \\eta_{\\mathrm{rel}}$。\n\n所有能量均以电子伏特为单位，所有涉及能量的请求输出也必须以电子伏特报告。相对偏差是无量纲的。使用以下参数值测试套件（每个对应一个独立的“泛函”标签，但所有都应被视为独立的测试用例）：\n\n- 测试用例 1 (类 GGA)：\n  - $E(N-1) = -90.800\\,\\mathrm{eV}$, $E(N) = -100.000\\,\\mathrm{eV}$, $E(N+1) = -100.800\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.700\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = +0.800\\,\\mathrm{eV}$\n\n- 测试用例 2 (类杂化)：\n  - $E(N-1) = -93.300\\,\\mathrm{eV}$, $E(N) = -102.000\\,\\mathrm{eV}$, $E(N+1) = -103.300\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -7.200\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = -0.300\\,\\mathrm{eV}$\n\n- 测试用例 3 (类范围分离杂化)：\n  - $E(N-1) = -91.900\\,\\mathrm{eV}$, $E(N) = -101.000\\,\\mathrm{eV}$, $E(N+1) = -102.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -9.000\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = -1.200\\,\\mathrm{eV}$\n\n- 测试用例 4 (类 LDA，具有负电子亲和能)：\n  - $E(N-1) = -91.000\\,\\mathrm{eV}$, $E(N) = -99.000\\,\\mathrm{eV}$, $E(N+1) = -98.500\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -3.500\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = +1.000\\,\\mathrm{eV}$\n\n- 测试用例 5 (类 meta-GGA，具有近零电子亲和能)：\n  - $E(N-1) = -113.000\\,\\mathrm{eV}$, $E(N) = -120.000\\,\\mathrm{eV}$, $E(N+1) = -120.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.000\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = 0.000\\,\\mathrm{eV}$\n\n您的程序必须为每个测试用例计算列表 $[\\eta_{\\Delta E}, \\eta_{\\mathrm{orb}}, \\Delta \\eta_{\\mathrm{abs}}, \\Delta \\eta_{\\mathrm{rel}}]$，并按此顺序排列，其中：\n- $\\eta_{\\Delta E}$ 和 $\\eta_{\\mathrm{orb}}$ 的单位为 $\\mathrm{eV}$，且必须四舍五入到 $6$ 位小数。\n- $\\Delta \\eta_{\\mathrm{abs}}$ 的单位为 $\\mathrm{eV}$，且必须四舍五入到 $6$ 位小数。\n- $\\Delta \\eta_{\\mathrm{rel}}$ 是无量纲的，且必须四舍五入到 $6$ 位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表对应一个测试用例，例如 $[[\\cdots],[\\cdots],\\ldots]$。输出行中不允许有多余的空格或文本。", "solution": "问题陈述已经过分析，被认为是具有科学依据、问题明确、客观且内部一致的。它在概念密度泛函理论 (DFT) 领域提出了一个有效的任务。我们开始进行解答。\n\n该问题要求系统地比较计算全局化学硬度 $\\eta$ 的两种方法。第一种方法依赖于总能量差 ($\\Delta E$)，而第二种方法依赖于前线 Kohn-Sham 轨道本征值。此分析通过从第一性原理推导相关表达式，然后将其应用于所提供的数据集来执行。\n\n### 1. 从总能量计算电离能 ($I$) 和电子亲和能 ($A$)\n\n根据定义，垂直电离能 $I$ 是在固定原子核几何构型下，从一个含有 $N$ 个电子的体系中移除一个电子所需的能量。它是 $(N-1)$ 电子体系和 $N$ 电子体系基态之间的能量差。\n\n$$I = E(N-1) - E(N)$$\n\n类似地，垂直电子亲和能 $A$ 是向 $N$ 电子体系中添加一个电子时释放的能量。它是 $N$ 电子体系和 $(N+1)$ 电子体系基态之间的能量差。$A$ 的正值表示阴离子相对于中性物种是稳定的。\n\n$$A = E(N) - E(N+1)$$\n\n在给定框架内，$I$ 和 $A$ 的这些表达式是精确的，前提是所提供的能量 $E(N-1)$、$E(N)$ 和 $E(N+1)$ 分别是相应电子数的真实基态能量。\n\n### 2. 从 $I$ 和 $A$ 计算全局硬度 ($\\eta$)\n\n全局化学硬度 $\\eta$ 定义为在恒定外势 $v(\\mathbf{r})$ 下，能量 $E$ 相对于电子数 $N$ 的二阶导数的一半。\n\n$$\\eta = \\frac{1}{2} \\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v$$\n\n为了对整数电子数 $N$ 计算此值，我们必须使用有限差分近似，因为函数 $E(N)$ 是分段线性的，在整数 $N$ 处导数不连续。我们使用步长 $\\Delta N = 1$ 构建一个对称的二阶有限差分。\n\n一阶导数 $\\left(\\partial E / \\partial N\\right)_v$ 是化学势 $\\mu$。在整数 $N$ 处，存在两个单边导数：\n- 从右侧的导数 $(N \\to N+1)$：$\\mu^+ = \\frac{E(N+1)-E(N)}{(N+1)-N} = E(N+1)-E(N) = -A$。\n- 从左侧的导数 $(N \\to N-1)$：$\\mu^- = \\frac{E(N)-E(N-1)}{N-(N-1)} = E(N)-E(N-1) = -I$。\n\n二阶导数是一阶导数的变化率。使用以 $N$ 为中心的中心差分：\n\n$$\\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v \\approx \\frac{\\mu^+ - \\mu^-}{1} = (-A) - (-I) = I - A$$\n\n将此代入硬度的定义，得到基于总能量差的硬度表达式，我们记为 $\\eta_{\\Delta E}$：\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}(I - A)$$\n\n结合 $I$ 和 $A$ 的表达式，我们得到：\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}([E(N-1) - E(N)] - [E(N) - E(N+1)]) = \\frac{E(N-1) + E(N+1) - 2E(N)}{2}$$\n\n这个表达式代表歧化反应（$2M \\rightarrow M^+ + M^-$）能隙的一半。\n\n### 3. 从前线轨道对 $I$ 和 $A$ 进行近似\n\n在 Kohn-Sham (KS) DFT 框架内，Janak 定理指出，总能量关于第 $i$ 个 KS 轨道占据数 $n_i$ 的导数等于该轨道的本征值 $\\epsilon_i$。\n\n$$\\frac{\\partial E}{\\partial n_i} = \\epsilon_i$$\n\n对于精确的交换相关 (XC) 泛函，可以证明电离能恰好是最高已占分子轨道 (HOMO) 能量的负值：$I = -\\epsilon_{\\mathrm{HOMO}}$。然而，电子亲和能的关系因 XC 势的导数不连续性 $\\Delta_{xc}$ 而变得复杂，这导致最低未占分子轨道 (LUMO) 的能量 $\\epsilon_{\\mathrm{LUMO}}$ 在其占据数从 $0$ 变为非零值时发生不连续的移动。\n\n对于近似的 XC 泛函，例如局域密度近似 (LDA) 和广义梯度近似 (GGA)，这种导数不连续性几乎为零。这导致通过 KS 轨道能隙 ($\\epsilon_{\\mathrm{LUMO}}-\\epsilon_{\\mathrm{HOMO}}$) 严重低估了基本能隙 ($I-A$)。尽管存在这个已知的缺陷，一个常见的做法是采用类 Koopmans 近似来处理 $I$ 和 $A$。\n\n**假设：** 我们假设所使用的 XC 泛函具有可忽略的导数不连续性。这允许直接从中性 $N$ 电子体系的 HOMO 和 LUMO 本征值近似计算电离能和电子亲和能。\n\n在此假设下，我们有：\n\n$$I_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{HOMO}}$$\n$$A_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{LUMO}}$$\n\n使用这些基于轨道的 $I$ 和 $A$ 近似值，我们可以定义一个基于轨道的硬度 $\\eta_{\\mathrm{orb}}$：\n\n$$\\eta_{\\mathrm{orb}} = \\frac{1}{2}(I_{\\mathrm{orb}} - A_{\\mathrm{orb}}) = \\frac{1}{2}((-\\epsilon_{\\mathrm{HOMO}}) - (-\\epsilon_{\\mathrm{LUMO}}))$$\n\n$$\\eta_{\\mathrm{orb}} = \\frac{\\epsilon_{\\mathrm{LUMO}} - \\epsilon_{\\mathrm{HOMO}}}{2}$$\n\n这表明，在这些近似下，硬度就是 HOMO-LUMO 能隙的一半。$\\eta_{\\Delta E}$ 和 $\\eta_{\\mathrm{orb}}$ 之间的差异是近似 XC 泛函缺陷的直接后果，特别是其自相互作用误差和缺乏导数不连续性。\n\n### 4. 诊断偏差\n\n为了量化两种硬度计算方法之间的差异，我们使用问题陈述中定义的诊断度量。\n\n- 硬度的绝对偏差：\n  $$\\Delta \\eta_{\\mathrm{abs}} = |\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}|$$\n\n- 硬度的相对偏差：\n  $$\\Delta \\eta_{\\mathrm{rel}} = \\frac{\\Delta \\eta_{\\mathrm{abs}}}{\\eta_{\\Delta E}}$$\n这假设 $\\eta_{\\Delta E} \\neq 0$，对于所有提供的测试用例都成立，因为能量 $E(N)$ 是凸的。\n\n现在将使用推导出的公式为每个测试用例计算这些指标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hardness problem by calculating and comparing hardness values\n    derived from total energy differences and frontier orbital energies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (E(N-1), E(N), E(N+1), e_homo, e_lumo) in eV.\n    test_cases = [\n        # Test case 1 (GGA-like)\n        (-90.800, -100.000, -100.800, -4.700, 0.800),\n        # Test case 2 (hybrid-like)\n        (-93.300, -102.000, -103.300, -7.200, -0.300),\n        # Test case 3 (range-separated hybrid-like)\n        (-91.900, -101.000, -102.000, -9.000, -1.200),\n        # Test case 4 (LDA-like with negative electron affinity)\n        (-91.000, -99.000, -98.500, -3.500, 1.000),\n        # Test case 5 (meta-GGA-like with near-zero electron affinity)\n        (-113.000, -120.000, -120.000, -4.000, 0.000),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_n_minus_1, e_n, e_n_plus_1, eps_homo, eps_lumo = case\n\n        # 1. Calculate properties from total energy differences (Delta E method).\n        # Ionization energy I = E(N-1) - E(N)\n        i_delta_e = e_n_minus_1 - e_n\n        # Electron affinity A = E(N) - E(N+1)\n        a_delta_e = e_n - e_n_plus_1\n        # Hardness eta_delta_e = (I - A) / 2\n        eta_delta_e = (i_delta_e - a_delta_e) / 2.0\n\n        # 2. Calculate properties from frontier orbital eigenvalues (Orbital method).\n        # Hardness eta_orb = (epsilon_LUMO - epsilon_HOMO) / 2\n        eta_orb = (eps_lumo - eps_homo) / 2.0\n\n        # 3. Calculate the diagnostic deviations.\n        # Absolute deviation\n        delta_eta_abs = abs(eta_delta_e - eta_orb)\n        # Relative deviation\n        # The problem setup ensures eta_delta_e is non-zero.\n        delta_eta_rel = delta_eta_abs / eta_delta_e if eta_delta_e != 0 else 0.0\n\n        # 4. Format results to 6 decimal places as strings.\n        case_results = [\n            f\"{eta_delta_e:.6f}\",\n            f\"{eta_orb:.6f}\",\n            f\"{delta_eta_abs:.6f}\",\n            f\"{delta_eta_rel:.6f}\",\n        ]\n        all_results.append(case_results)\n\n    # 5. Format the final output string as a comma-separated list of lists.\n    # e.g., [[val1,val2,...],[val1,val2,...]]\n    inner_lists_str = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```", "id": "2879242"}, {"introduction": "掌握了如何计算和理解单个分子的化学势和硬度后，我们现在将这些概念应用于预测分子间的相互作用。这个练习模拟了两个化学实体接触时发生的过程，演示了电负性差异如何驱动电荷转移，而化学硬度又如何量化体系对这种变化的“阻力”。通过最小化体系的总能量，你将推导出电荷转移量的表达式，这直接体现了电负性均衡原理，并展示了这些概念在预测化学反应方向和程度方面的强大能力[@problem_id:2879209]。", "problem": "两个孤立的片段，标记为 $A$ 和 $B$，其基态电子数分别为 $N_A^{0}$ 和 $N_B^{0}$。它们被置于弱接触状态，使得少量电荷可以在它们之间转移，而外势保持不变。定义 $\\Delta N$ 为从片段 $B$ 转移到片段 $A$ 的电子数，因此新的电子数为 $N_A = N_A^{0} + \\Delta N$ 和 $N_B = N_B^{0} - \\Delta N$。在小电荷转移范围内进行计算，在该范围内，每个片段的能量关于电子数的二阶展开是准确的。\n\n使用概念密度泛函理论（density functional theory (DFT)）中的以下基本定义：\n- 片段 $X \\in \\{A,B\\}$ 的化学势 $\\mu_{X}$ 为 $\\mu_{X} = \\left(\\frac{\\partial E_{X}}{\\partial N_{X}}\\right)_{v}$。\n- 片段 $X$ 的化学硬度 $\\eta_{X}$ 为 $\\eta_{X} = \\left(\\frac{\\partial^{2} E_{X}}{\\partial N_{X}^{2}}\\right)_{v}$。\n- Mulliken–Parr 电负性 $\\chi_{X}$ 与化学势的关系为 $\\chi_{X} = -\\mu_{X}$。\n\n假设能量展开中高于二次的项可以忽略不计，并且每个片段的硬度为正。构建该片段对的总能量 $E_{\\text{tot}}(\\Delta N)$ 至 $\\Delta N$ 的二次项，并确定使 $E_{\\text{tot}}(\\Delta N)$ 最小化的 $\\Delta N$ 的值。最终答案仅用 $\\chi_A$、$\\chi_B$、$\\eta_A$ 和 $\\eta_B$ 表示，形式为一个单一的闭式解析表达式。无需单位。无需数值取整。", "solution": "本任务是从化学势、硬度和电负性的定义出发，在电子数的二次近似下，求得使总能量最小化的电荷转移量 $\\Delta N$。\n\n根据定义，对于每个片段 $X \\in \\{A,B\\}$，在固定外势下，我们将其能量作为电子数 $N_X$ 的函数，在孤立整数 $N_X^{0}$ 附近展开：\n$$\nE_X(N_X^{0} + \\delta N_X) \\approx E_X(N_X^{0}) + \\mu_X\\, \\delta N_X + \\frac{1}{2}\\,\\eta_X\\, (\\delta N_X)^{2},\n$$\n其中 $\\mu_X = \\left(\\frac{\\partial E_X}{\\partial N_X}\\right)_{v}$ 且 $\\eta_X = \\left(\\frac{\\partial^{2} E_X}{\\partial N_X^{2}}\\right)_{v}$。孤立片段的稳定性意味着 $\\eta_X  0$。\n\n根据题目中的约定，$\\Delta N$ 是从 $B$ 转移到 $A$ 的电子数，因此\n$$\nN_A = N_A^{0} + \\Delta N, \\quad N_B = N_B^{0} - \\Delta N,\n$$\n从而 $\\delta N_A = \\Delta N$ 且 $\\delta N_B = -\\Delta N$。\n\n使用两个片段的二次展开，总能量为\n$$\nE_{\\text{tot}}(\\Delta N) = E_A(N_A^{0} + \\Delta N) + E_B(N_B^{0} - \\Delta N).\n$$\n展开每一项，\n$$\nE_A(N_A^{0} + \\Delta N) \\approx E_A(N_A^{0}) + \\mu_A\\, \\Delta N + \\frac{1}{2}\\,\\eta_A\\, (\\Delta N)^{2},\n$$\n$$\nE_B(N_B^{0} - \\Delta N) \\approx E_B(N_B^{0}) - \\mu_B\\, \\Delta N + \\frac{1}{2}\\,\\eta_B\\, (\\Delta N)^{2}.\n$$\n将它们相加，\n$$\nE_{\\text{tot}}(\\Delta N) \\approx \\left[E_A(N_A^{0}) + E_B(N_B^{0})\\right] + (\\mu_A - \\mu_B)\\, \\Delta N + \\frac{1}{2}\\,(\\eta_A + \\eta_B)\\, (\\Delta N)^{2}.\n$$\n\n为了找到最小化 $\\Delta N$，对 $\\Delta N$ 求导并令导数为零：\n$$\n\\frac{dE_{\\text{tot}}}{d\\Delta N} = (\\mu_A - \\mu_B) + (\\eta_A + \\eta_B)\\, \\Delta N = 0.\n$$\n解出 $\\Delta N$ 得\n$$\n\\Delta N^{*} = \\frac{\\mu_B - \\mu_A}{\\eta_A + \\eta_B}.\n$$\n\n现在使用电负性与化学势之间的关系 $\\chi_X = -\\mu_X$，因此 $\\mu_B - \\mu_A = -\\chi_B + \\chi_A = \\chi_A - \\chi_B$。所以，\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{\\eta_A + \\eta_B}.\n$$\n\n我们可以验证这个驻点是一个极小值点，因为二阶导数为\n$$\n\\frac{d^{2}E_{\\text{tot}}}{d(\\Delta N)^{2}} = \\eta_A + \\eta_B,\n$$\n在题目所述的 $\\eta_A  0$ 和 $\\eta_B  0$ 的假设下，该值为正。因此，上述表达式确实是在二次近似下使能量最小化的电荷转移量。\n\n所需的结果，仅用 $\\chi_A$、$\\chi_B$、$\\eta_A$ 和 $\\eta_B$ 表示为\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{\\eta_A + \\eta_B}.\n$$", "answer": "$$\\boxed{\\frac{\\chi_A-\\chi_B}{\\eta_A+\\eta_B}}$$", "id": "2879209"}]}