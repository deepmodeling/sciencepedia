{"hands_on_practices": [{"introduction": "我们从一个基本概念开始：单斯莱特行列式是多电子体系最简单的波函数形式。我们将探讨当用单行列式描述一个开壳层体系时，自旋对称性会发生什么。这项练习将通过对一个简单的双电子体系分析计算其 $\\langle \\hat{S}^2 \\rangle$ 期望值，揭示“自旋污染”的来源，为理解更高级的方法提供关键的理论基础。[@problem_id:2911701]", "problem": "考虑一个双电子体系，该体系由自旋轨道 $\\chi_{a} = \\phi_{a}(\\mathbf{r}) \\alpha(\\omega)$ 和 $\\chi_{b} = \\phi_{b}(\\mathbf{r}) \\beta(\\omega)$ 构建的单个斯莱特行列式描述，其中 $\\phi_{a}$ 和 $\\phi_{b}$ 是归一化（但不一定正交）的空间轨道，而 $\\alpha$、$\\beta$ 是通常的自旋函数。设该行列式为\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{a}(1)\\alpha(1)  \\phi_{b}(1)\\beta(1) \\\\\n\\phi_{a}(2)\\alpha(2)  \\phi_{b}(2)\\beta(2)\n\\end{vmatrix}.\n$$\n从双电子自旋的基本定义出发，即总自旋算符 $\\hat{S}^{2} = \\hat{\\mathbf{s}}_{1}^{2} + \\hat{\\mathbf{s}}_{2}^{2} + 2\\,\\hat{\\mathbf{s}}_{1}\\cdot\\hat{\\mathbf{s}}_{2}$（其单电子本征值为 $\\hat{\\mathbf{s}}_{i}^{2}\\alpha = \\frac{3}{4}\\alpha$、$\\hat{\\mathbf{s}}_{i}^{2}\\beta = \\frac{3}{4}\\beta$）以及正交归一的单重态-三重态自旋基，推导出行列式期望值 $\\langle \\hat{S}^{2} \\rangle$ 的解析表达式，并用空间轨道交叠\n$$\nS_{ab} \\equiv \\langle \\phi_{a} | \\phi_{b} \\rangle = \\int \\phi_{a}^{*}(\\mathbf{r})\\,\\phi_{b}(\\mathbf{r})\\,d\\mathbf{r}\n$$\n来表示。然后，仅使用第一性原理和你推导出的表达式，确定使该行列式成为 $\\hat{S}^{2}$ 的本征函数（即自旋纯）时 $|S_{ab}|$ 的值。将你的最终答案表示为一个双分量行向量 $(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}})$。不需要数值近似，也不需要单位。", "solution": "我们从占据自旋轨道 $\\chi_{a} = \\phi_{a}\\alpha$ 和 $\\chi_{b} = \\phi_{b}\\beta$ 的两个电子的斯莱特行列式定义开始：\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\alpha(1)\\,\\phi_{b}(2)\\beta(2) - \\phi_{a}(2)\\alpha(2)\\,\\phi_{b}(1)\\beta(1)\\right].\n$$\n引入标准的单重态和三重态 ($M_{S}=0$) 自旋函数，\n$$\n\\Omega \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) - \\beta(1)\\alpha(2)\\right], \\qquad\n\\Sigma \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) + \\beta(1)\\alpha(2)\\right],\n$$\n它们是正交归一的，并且满足\n$$\n\\hat{S}^{2}\\Omega = 0\\cdot \\Omega, \\qquad \\hat{S}^{2}\\Sigma = 2\\cdot \\Sigma,\n$$\n因为对于双电子体系，单重态的总自旋为 $S=0$，三重态的总自旋为 $S=1$，其 $S(S+1)$ 本征值分别为 $0$ 和 $2$。\n\n通过将自旋乘积用 $\\Omega$ 和 $\\Sigma$ 表示来重写该行列式：\n\\begin{align*}\n\\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma + \\Omega\\right), \\\\\n\\beta(1)\\alpha(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma - \\Omega\\right).\n\\end{align*}\n代入 $\\Psi$ 并整理对称和反对称的空间组合，我们得到\n\\begin{align*}\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2)\\,\\frac{\\Sigma+\\Omega}{\\sqrt{2}} - \\phi_{b}(1)\\phi_{a}(2)\\,\\frac{\\Sigma-\\Omega}{\\sqrt{2}}\\right] \\\\\n= \\frac{1}{2}\\left[\\left(\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right)\\Sigma + \\left(\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right)\\Omega\\right].\n\\end{align*}\n定义反对称和对称的空间因子\n$$\n\\Phi_{A} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right], \\qquad\n\\Phi_{S} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right],\n$$\n这样\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\Phi_{A}\\,\\Sigma + \\Phi_{S}\\,\\Omega\\right].\n$$\n因为 $\\Sigma$ 和 $\\Omega$ 是正交归一的并且具有相反的置换对称性，所以混合内积为零：\n$$\n\\langle \\Phi_{A}\\Sigma | \\Phi_{S}\\Omega \\rangle = 0.\n$$\n$\\Psi$ 的模方为\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left(\\langle \\Phi_{A}|\\Phi_{A}\\rangle + \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right).\n$$\n使用归一化的空间轨道和定义 $S_{ab} \\equiv \\langle \\phi_{a}|\\phi_{b}\\rangle$，可以计算出\n\\begin{align*}\n\\langle \\Phi_{A}|\\Phi_{A}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle - \\langle ab|ba\\rangle - \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 - |S_{ab}|^{2}, \\\\\n\\langle \\Phi_{S}|\\Phi_{S}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle + \\langle ab|ba\\rangle + \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 + |S_{ab}|^{2},\n\\end{align*}\n其中 $\\langle ab|ba\\rangle = \\langle \\phi_{a}(1)\\phi_{b}(2)|\\phi_{b}(1)\\phi_{a}(2)\\rangle = S_{ab}S_{ba} = |S_{ab}|^{2}$，并且由于归一化，$\\langle ab|ab\\rangle = \\langle ba|ba\\rangle = 1$。因此，\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left[(1 - |S_{ab}|^{2}) + (1 + |S_{ab}|^{2})\\right] = 1,\n$$\n正如对由正交归一自旋轨道构建的归一化斯莱特行列式所预期的那样。\n\n那么 $\\hat{S}^{2}$ 的期望值为\n\\begin{align*}\n\\langle \\hat{S}^{2} \\rangle = \\langle \\Psi | \\hat{S}^{2} | \\Psi \\rangle \\\\\n= \\frac{1}{2}\\left[\\langle \\Phi_{A}\\Sigma | \\hat{S}^{2} | \\Phi_{A}\\Sigma \\rangle + \\langle \\Phi_{S}\\Omega | \\hat{S}^{2} | \\Phi_{S}\\Omega \\rangle\\right] \\\\\n= \\frac{1}{2}\\left[2\\,\\langle \\Phi_{A}|\\Phi_{A}\\rangle + 0\\cdot \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right] \\\\\n= \\langle \\Phi_{A}|\\Phi_{A}\\rangle \\\\\n= 1 - |S_{ab}|^{2}.\n\\end{align*}\n因此，\n$$\n\\langle \\hat{S}^{2} \\rangle = 1 - |\\langle \\phi_{a}|\\phi_{b}\\rangle|^{2}.\n$$\n\n为了确定行列式何时是自旋纯的（$\\hat{S}^{2}$ 的一个本征函数），我们注意到一个本征态必须是本征值为 $0$ 的纯单重态，或者是本征值为 $2$ 的纯三重态。从推导出的表达式来看，$\\langle \\hat{S}^{2} \\rangle$ 位于区间 $[0,1]$ 内，因为根据柯西-施瓦茨不等式有 $0 \\le |S_{ab}| \\le 1$。因此，该行列式永远无法实现三重态值 $2$；一个纯的 $M_{S}=0$ 三重态需要行列式的自旋匹配线性组合。实现自旋纯的唯一可能性是单重态情况，这要求\n$$\n\\langle \\hat{S}^{2} \\rangle = 0 \\quad \\Longleftrightarrow \\quad 1 - |S_{ab}|^{2} = 0 \\quad \\Longleftrightarrow \\quad |S_{ab}| = 1.\n$$\n对于归一化的轨道，当且仅当 $\\phi_{b} = \\exp(i\\theta)\\,\\phi_{a}$（对于某个实数 $\\theta$）时，才有 $|S_{ab}| = 1$。即，两个空间轨道在相差一个全局相位因子的情况下是相同的。这对应于闭壳层单重态，而不是一个真正的开壳层行列式。因此，除了平凡的闭壳层极限情况，一个含有一个 $\\alpha$ 电子和一个 $\\beta$ 电子的单个开壳层行列式不是自旋纯的。\n\n所要求的双分量最终答案是 $\\langle \\hat{S}^{2} \\rangle$ 的解析表达式以及产生自旋纯行列式的 $|S_{ab}|$ 的值：\n$$\n\\left(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}}\\right) = \\left(1 - |S_{ab}|^{2},\\; 1\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 - |S_{ab}|^{2}  1\\end{pmatrix}}$$", "id": "2911701"}, {"introduction": "在认识到简单的开壳层行列式通常不是纯自旋态之后，我们现在来考察一种旨在强制保持自旋对称性的方法。我们将研究具有单个未配对电子的体系（双重态）的限制性开壳层哈特里-福克 (ROHF) 波函数。这项实践通过使用自旋角动量代数的严格证明，表明 ROHF 方法在某些重要情况下可以通过构造产生一个纯自旋波函数，突显了限制性与非限制性方法之间的关键区别。[@problem_id:2911616]", "problem": "考虑一个包含 $N$ 个电子的限制性开壳层哈特里-福克 (ROHF) 参考态，其具有 $N_{\\mathrm{c}}$ 个双占据空间轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$ 和一个单占据空间轨道 $\\phi_u$。其自旋轨道占据情况为 $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\alpha\\}$，因此正好有一个自旋为 $\\alpha$ 的未配对电子。令 $\\lvert \\Phi \\rangle$ 表示相应的斯莱特行列式。总自旋算符为 $\\hat{S}_x$、$\\hat{S}_y$、$\\hat{S}_z$ 以及 $\\hat{S}^2 = \\hat{S}_x^2 + \\hat{S}_y^2 + \\hat{S}_z^2$，它们由单电子自旋算符构成，升降算符为 $\\hat{S}_{\\pm} = \\hat{S}_x \\pm i \\hat{S}_y$。从标准的自旋角动量代数和斯莱特行列式的反对称性出发。\n\n(a) 证明 $\\lvert \\Phi \\rangle$ 是 $\\hat{S}_z$ 的精确本征函数，其本征值为 $M_S = \\tfrac{1}{2}$，并且它被总自旋升算符湮灭，即 $\\hat{S}_+ \\lvert \\Phi \\rangle = 0$。\n\n(b) 仅使用角动量代数和 (a) 部分中建立的性质，证明 $\\lvert \\Phi \\rangle$ 是 $\\hat{S}^2$ 的精确本征函数，其总自旋为 $S = \\tfrac{1}{2}$。\n\n(c) 显式计算期望值 $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$ 以确认自旋纯度。将最终答案表示为无量纲数 $\\langle \\hat{S}^2 \\rangle / \\hbar^2$。无需四舍五入；以单个数字形式提供精确值。", "solution": "电子总数为 $N=2N_{\\mathrm{c}}+1$。自旋为 $\\alpha$ 的电子数为 $N_{\\alpha} = N_{\\mathrm{c}}+1$，自旋为 $\\beta$ 的电子数为 $N_{\\beta} = N_{\\mathrm{c}}$。总自旋算符是单电子算符的和：$\\hat{S}_z = \\sum_{j=1}^{N} \\hat{s}_{z,j}$ 和 $\\hat{S}_{\\pm} = \\sum_{j=1}^{N} \\hat{s}_{\\pm,j}$。\n\n(a) 证明 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}_z$ 的本征函数且被 $\\hat{S}_+$ 湮灭。\n\n斯莱特行列式是任何可以写成单电子算符之和的算符（例如 $\\hat{S}_z$）的本征函数。总本征值是每个被占据自旋轨道的单电子本征值之和。对于自旋为 $\\alpha$ 的电子，单电子自旋算符 $\\hat{s}_z$ 的本征值为 $+\\frac{1}{2}\\hbar$；对于自旋为 $\\beta$ 的电子，其本征值为 $-\\frac{1}{2}\\hbar$。对于行列式 $\\lvert\\Phi\\rangle$，总的 $\\hat{S}_z$ 本征值为：\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( \\sum_{j=1}^{N} m_{s,j} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( N_{\\alpha} \\cdot \\left(+\\frac{1}{2}\\right) + N_{\\beta} \\cdot \\left(-\\frac{1}{2}\\right) \\right) \\hbar \\lvert\\Phi\\rangle $$\n代入 $N_{\\alpha}$ 和 $N_{\\beta}$ 的值：\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( (N_{\\mathrm{c}}+1) \\cdot \\frac{1}{2} - N_{\\mathrm{c}} \\cdot \\frac{1}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( \\frac{N_{\\mathrm{c}}}{2} + \\frac{1}{2} - \\frac{N_{\\mathrm{c}}}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle $$\n这证明了 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}_z$ 的本征函数，其量子数为 $M_S = \\frac{1}{2}$。\n\n接下来，我们分析自旋升算符 $\\hat{S}_+ = \\sum_{j=1}^{N} \\hat{s}_{+,j}$ 的作用。单电子算符 $\\hat{s}_+$ 作用于自旋函数的结果是 $\\hat{s}_+ \\alpha = 0$ 和 $\\hat{s}_+ \\beta = \\hbar \\alpha$。当 $\\hat{S}_+$ 作用于斯莱特行列式 $\\lvert\\Phi\\rangle$ 时，会产生一系列行列式的和，其中每一项都是一个电子的自旋被 $\\hat{s}_+$ 作用后的结果。\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = \\sum_{j=1}^{N} \\hat{s}_{+,j} \\lvert\\Phi\\rangle $$\n如果电子 $j$ 处于一个具有 $\\alpha$ 自旋的自旋轨道中（例如 $\\phi_k\\alpha$），$\\hat{s}_{+,j}$ 对其作用的结果为零。\n如果电子 $j$ 处于一个具有 $\\beta$ 自旋的自旋轨道中（例如 $\\phi_i\\beta$），算符会尝试将其自旋翻转为 $\\alpha$：$\\hat{s}_{+,j}(\\phi_i\\beta) = \\hbar(\\phi_i\\alpha)$。然而，对于所有双占据轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$，自旋轨道 $\\phi_i\\alpha$ 在行列式 $\\lvert\\Phi\\rangle$ 中已经被占据。将算符 $\\hat{s}_{+,j}$ 应用于自旋轨道 $\\phi_i\\beta$ 将会生成一个新的行列式，其中自旋轨道 $\\phi_i\\alpha$ 出现两次。根据泡利不相容原理，具有两个相同列（或行）的行列式恒为零。由于所有的 $\\beta$ 自旋都属于双占据空间轨道，因此和中的每一项都为零。\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = 0 $$\n至此完成了 (a) 部分的证明。\n\n(b) 证明 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}^2$ 的本征函数。\n\n我们使用角动量算符的基本对易关系，这导出了恒等式 $\\hat{S}^2 = \\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z$。我们将此算符应用于态 $\\lvert\\Phi\\rangle$：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = (\\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z) \\lvert\\Phi\\rangle $$\n使用在 (a) 部分中建立的结果，即 $\\hat{S}_+ \\lvert\\Phi\\rangle = 0$ 和 $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (\\hat{S}_+ \\lvert\\Phi\\rangle) + \\hat{S}_z (\\hat{S}_z \\lvert\\Phi\\rangle) + \\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (0) + \\hat{S}_z \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = 0 + \\frac{1}{2}\\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle $$\n再次代入 $\\hat{S}_z$ 的作用：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle = \\left(\\frac{1}{4}\\hbar^2 + \\frac{1}{2}\\hbar^2\\right) \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle $$\n$\\hat{S}^2$ 的本征值为 $\\frac{3}{4}\\hbar^2$。对于一个自旋本征函数，其本征值的形式为 $S(S+1)\\hbar^2$。令 $S(S+1) = \\frac{3}{4}$，并求解 $S \\ge 0$，我们得到 $S = \\frac{1}{2}$。因此，$\\lvert\\Phi\\rangle$ 是一个总自旋为 $S = \\frac{1}{2}$ 的纯自旋态。\n\n(c) 显式计算期望值 $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$。\n\n从 (b) 部分我们已知 $\\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle$。因此期望值为：\n$$ \\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle = \\langle \\Phi \\rvert \\left( \\frac{3}{4}\\hbar^2 \\lvert \\Phi \\rangle \\right) = \\frac{3}{4}\\hbar^2 \\langle \\Phi \\rvert \\Phi \\rangle $$\n由于 $\\lvert \\Phi \\rangle$ 是一个归一化的斯莱特行列式，所以 $\\langle \\Phi \\rvert \\Phi \\rangle = 1$。因此，$\\langle \\hat{S}^2 \\rangle = \\frac{3}{4}\\hbar^2$。\n为了不依赖 (b) 部分的结果，通过显式计算来证实这一点，我们可以使用另一个恒等式 $\\hat{S}^2 = \\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z$。期望值为：\n$$ \\langle \\hat{S}^2 \\rangle = \\langle \\Phi | (\\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z) | \\Phi \\rangle = \\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle + \\langle \\Phi | \\hat{S}_z^2 | \\Phi \\rangle - \\hbar \\langle \\Phi | \\hat{S}_z | \\Phi \\rangle $$\n使用 $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$，最后两项为：\n$$ \\langle \\hat{S}_z^2 \\rangle - \\hbar \\langle \\hat{S}_z \\rangle = \\left(\\frac{1}{2}\\hbar\\right)^2 - \\hbar\\left(\\frac{1}{2}\\hbar\\right) = \\frac{1}{4}\\hbar^2 - \\frac{1}{2}\\hbar^2 = -\\frac{1}{4}\\hbar^2 $$\n现在我们计算第一项 $\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle$。我们必须计算 $\\hat{S}_- = \\sum_{j=1}^{N} \\hat{s}_{-,j}$ 对 $\\lvert\\Phi\\rangle$ 的作用。单电子算符 $\\hat{s}_-$ 的作用是 $\\hat{s}_- \\alpha = \\hbar \\beta$ 和 $\\hat{s}_- \\beta = 0$。\n算符 $\\hat{s}_{-,j}$ 只有在作用于 $\\alpha$ 自旋轨道时才会产生非零结果。\n- 如果它作用于一个双占据的核心轨道，$\\hat{s}_{-,j}(\\phi_i\\alpha) = \\hbar(\\phi_i\\beta)$，会创建一个包含两个 $\\phi_i\\beta$ 自旋轨道的行列式，其值为零。\n- 如果它作用于单占据轨道，$\\hat{s}_{-,j}(\\phi_u\\alpha) = \\hbar(\\phi_u\\beta)$。这将创建一个新的、非零的斯莱特行列式，我们称之为 $\\lvert\\Phi'\\rangle$，其自旋轨道集为 $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\beta\\}$。\n所以，对所有电子的求和简化为一项：\n$$ \\hat{S}_- \\lvert\\Phi\\rangle = \\hbar \\lvert\\Phi'\\rangle $$\n现在我们计算其范数：\n$$ \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle = \\langle \\hbar \\Phi' | \\hbar \\Phi' \\rangle = \\hbar^2 \\langle \\Phi' | \\Phi' \\rangle $$\n因为 $\\lvert\\Phi'\\rangle$ 也是由一组标准正交的自旋轨道构建的归一化斯莱特行列式，所以 $\\langle \\Phi' | \\Phi' \\rangle = 1$。因此，$\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\hbar^2$。\n合并所有部分：\n$$ \\langle \\hat{S}^2 \\rangle = \\hbar^2 - \\frac{1}{4}\\hbar^2 = \\frac{3}{4}\\hbar^2 $$\n这个显式计算证实了 ROHF 行列式的自旋纯度。所求的无量纲值为：\n$$ \\frac{\\langle \\hat{S}^2 \\rangle}{\\hbar^2} = \\frac{3}{4} $$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2911616"}, {"introduction": "理论与应用的结合。我们现在从解析证明转向在一个化学相关的分子——以其三重态基态而闻名的氧分子 ($\\mathrm{O}_2$)——上进行实际的计算实验。本练习比较了三种基于哈特里-福克的方法——非限制性 (UHF)、限制性开壳层 (ROHF) 和自旋投影 UHF (PUHF)——用于描述一个开壳层体系。通过实施和运行这些计算，您将获得关于变分能量最小化与自旋对称性保持之间权衡的第一手经验，并观察自旋污染及其校正对能量和自旋密度的影响。[@problem_id:2911621]", "problem": "考虑一个为氧分子设计的、受第一性原理启发的最小开壳层模型。该模型旨在提炼出 $\\pi$ 轨道流形中自旋对称性的关键物理，同时在计算上保持可行。使用一个由 $M=7$ 个正交归一的空间轨道构成的基组，标记如下：两个深层芯轨道 $\\{c_1,c_2\\}$，两个 $\\pi$ 成键轨道 $\\{\\pi_x,\\pi_y\\}$，两个 $\\pi^\\ast$ 反键轨道 $\\{\\pi^\\ast_x,\\pi^\\ast_y\\}$，以及一个额外的高能量虚轨道 $v$。将单电子哈密顿量（以原子单位，哈特里计）指定为一个实对称矩阵 $h \\in \\mathbb{R}^{M\\times M}$，其对角元为\n$c_1:\\,E_{c_1}=-5.0$，$c_2:\\,E_{c_2}=-3.0$，$\\pi_x:\\,E_{\\pi}=-\\Delta$，$\\pi_y:\\,E_{\\pi}=-\\Delta$，$\\pi^\\ast_x:\\,E_{\\pi^\\ast}=+\\Delta$，$\\pi^\\ast_y:\\,E_{\\pi^\\ast}=+\\Delta$，$v:\\,E_v=+3.0$，且非对角耦合仅存在于对称性匹配的 $\\pi$ 轨道对之间，\n$h_{\\pi_x,\\pi^\\ast_x}=h_{\\pi^\\ast_x,\\pi_x}=-\\beta$，$h_{\\pi_y,\\pi^\\ast_y}=h_{\\pi^\\ast_y,\\pi_y}=-\\beta$，所有其他非对角元均为零。这个 $h$ 矩阵模拟了 $\\pi$ 成键/反键轨道的分裂和最小程度的混合。\n\n使用一个密度-密度库仑矩阵 $J\\in\\mathbb{R}^{M\\times M}$ 和一个简化的交换矩阵 $K\\in\\mathbb{R}^{M\\times M}$，在平均场水平上对电子排斥进行建模。它们定义为 $J_{ii}=U$，$i\\neq j$ 时 $J_{ij}=J$；以及 $K_{ii}=U$，$i\\neq j$ 时 $K_{ij}=K$。考虑总共有 $N_\\alpha=6$ 个和 $N_\\beta=4$ 个电子（$N_{\\text{tot}}=10$），这定性地对应于 $\\mathrm{O}_2$ 的三重态基态特征，即在 $\\pi^\\ast$ 轨道流形中有两个未配对的 $\\alpha$ 电子。\n\n对于给定的自旋 $\\sigma\\in\\{\\alpha,\\beta\\}$，令 $P^\\sigma\\in\\mathbb{R}^{M\\times M}$ 为由已占据分子轨道构建的自旋密度矩阵，总密度为 $P=P^\\alpha+P^\\beta$。定义对角占据数向量 $n^\\sigma\\in\\mathbb{R}^M$ 为 $n^\\sigma_i=(P^\\sigma)_{ii}$，且 $n=n^\\alpha+n^\\beta$。通过下式构建依赖于自旋的福克矩阵：\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big),\n$$\n其中对角算符将向量应用于一个零矩阵的对角线上。对于给定的密度矩阵对 $(P^\\alpha,P^\\beta)$，总哈特里-福克能量泛函（以哈特里计）为：\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big).\n$$\n\n任务 A (非限制性哈特里-福克, UHF)：从一个初始猜测开始，该猜测通过对角化 $h$ 并为每个自旋占据能量最低的 $N_\\alpha$ 和 $N_\\beta$ 个轨道得到。然后执行自洽场 (SCF) 过程。在每次迭代中，构建 $F^\\alpha$ 和 $F^\\beta$，将其对角化以获得分子轨道，填充能量最低的 $N_\\alpha$ 和 $N_\\beta$ 个轨道以构建更新后的 $P^\\alpha$ 和 $P^\\beta$，并使用线性混合进行迭代，直到总能量的变化低于 $10^{-10}$ 哈特里。收敛后，计算：\n- 总能量 $E_{\\text{UHF}}$ (以哈特里计)，\n- 对于单个斯莱特行列式的自旋平方期望值 $\\langle S^2 \\rangle_{\\text{UHF}}$，使用在正交归一基下的著名公式\n$$\n\\langle S^2 \\rangle \\;=\\; S_z\\,(S_z+1) \\;+\\; N_\\beta \\;-\\; \\operatorname{Tr}\\!\\big(S\\,S^\\mathsf{T}\\big), \\quad S_z=\\tfrac{1}{2}(N_\\alpha-N_\\beta),\n$$\n其中 $S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}$ 是已占据的 $\\alpha$ 和 $\\beta$ 自旋分子轨道之间的重叠矩阵，而 $C^\\sigma_{\\text{occ}}$ 收集了 $F^\\sigma$ 的特征向量矩阵中的已占据列，\n- 两个反键轨道上的自旋密度，定义为 $P^\\alpha-P^\\beta$ 在 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 基函数上的对角元。\n\n任务 B (限制性开壳层哈特里-福克, ROHF)：通过迭代一个单一的“平均”福克矩阵，对两个自旋强制使用一套共同的空间轨道集 $C$：\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big),\n$$\n其中 $n$ 是根据当前的共同轨道和 ROHF 占据模式构建的：将能量最低的 $N_\\beta$ 个轨道作为双占据轨道（每个轨道一个 $\\alpha$ 电子和一个 $\\beta$ 电子），并将接下来的 $(N_\\alpha - N_\\beta)$ 个轨道作为由 $\\alpha$ 电子单占据的轨道。像 UHF 一样迭代直至收敛。然后计算：\n- 使用收敛的 ROHF 密度，通过 $E[P^\\alpha,P^\\beta]$ 计算总能量 $E_{\\text{ROHF}}$ (以哈特里计)，\n- 自旋平方值 $\\langle S^2 \\rangle_{\\text{ROHF}}$，对于一个自旋纯的三重态，该值应等于 $S(S+1)$，其中 $S=1$，即 $\\langle S^2 \\rangle_{\\text{ROHF}}=2$，\n- $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。\n\n任务 C (通过子空间投影的自旋投影哈特里-福克, “PUHF”)：从收敛的 UHF 已占据子空间出发，定义 $\\alpha$-占据投影算符 $P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$。将 $\\beta$-占据轨道投影到这个子空间中以“消除”自旋污染：\n$$\n\\widetilde{C}^\\beta_{\\text{occ}} \\;=\\; P_A\\, C^\\beta_{\\text{occ}}, \\quad C^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2},\n$$\n其中逆平方根是对称正交归一化。定义 $P^\\alpha_{\\text{PUHF}} = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$ 和 $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$。计算：\n- 投影能量 $E_{\\text{PUHF}}=E[P^\\alpha_{\\text{PUHF}},P^\\beta_{\\text{PUHF}}]$ (以哈特里计)，\n- 通过相同公式计算的投影 $\\langle S^2 \\rangle_{\\text{PUHF}}$，对于所构造的态，该值必须精确等于 $2$，\n- 从 $P^\\alpha_{\\text{PUHF}}-P^\\beta_{\\text{PUHF}}$ 计算得到的 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。\n\n使用以下三组参数集 $(\\Delta,\\beta,U,J,K)$ 作为测试套件，以评估对称性破缺和恢复：\n- 情况 1：$(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.3)$，\n- 情况 2：$(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.0)$，\n- 情况 3：$(\\Delta,\\beta,U,J,K)=(1.2,\\,0.5,\\,1.5,\\,0.6,\\,0.6)$。\n\n对每种情况，运行任务 A–C 并收集一个包含八个数字的列表：\n$[E_{\\text{UHF}},\\langle S^2\\rangle_{\\text{UHF}},E_{\\text{ROHF}},\\langle S^2\\rangle_{\\text{ROHF}},E_{\\text{PUHF}},\\langle S^2\\rangle_{\\text{PUHF}},m_{\\pi^\\ast_x},m_{\\pi^\\ast_y}]$，\n其中 $m_{\\pi^\\ast_x}$ 和 $m_{\\pi^\\ast_y}$ 分别是 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。所有能量必须以哈特里表示，所有其他量均为无量纲。您的程序应生成单行输出，包含结果，格式为三个此类列表的逗号分隔列表，并用方括号括起来（例如，$[[…],[…],[…]]$）。", "solution": "该问题的核心在于求解一个体系的自洽场 (SCF) 方程，该体系在 $M=7$ 个正交归一的轨道基组中包含 $N_\\alpha=6$ 个自旋向上和 $N_\\beta=4$ 个自旋向下的电子。总自旋投影为 $S_z = \\frac{1}{2}(N_\\alpha - N_\\beta) = 1$，对应于一个三重态。该模型由一个单电子哈密顿量 $h$ 和简化的双电子相互作用矩阵 $J$ 和 $K$ 定义。\n\n基轨道的索引如下：$c_1 \\to 0$，$c_2 \\to 1$，$\\pi_x \\to 2$，$\\pi_y \\to 3$，$\\pi^\\ast_x \\to 4$，$\\pi^\\ast_y \\to 5$，$v \\to 6$。\n\n单电子哈密顿矩阵 $h \\in \\mathbb{R}^{7 \\times 7}$ 由其给定的对角能量和非对角耦合构建而成：\n$$\nh = \\begin{pmatrix}\n-5.0  0  0  0  0  0  0 \\\\\n0  -3.0  0  0  0  0  0 \\\\\n0  0  -\\Delta  0  -\\beta  0  0 \\\\\n0  0  0  -\\Delta  0  -\\beta  0 \\\\\n0  0  -\\beta  0  \\Delta  0  0 \\\\\n0  0  0  -\\beta  0  \\Delta  0 \\\\\n0  0  0  0  0  0  3.0\n\\end{pmatrix}\n$$\n双电子相互作用矩阵 $J, K \\in \\mathbb{R}^{7 \\times 7}$ 定义为 $J_{ii}=U$，$i \\neq j$ 时 $J_{ij}=J$，对 $K$ 也类似。它们可以构建为 $J_{\\text{matrix}} = J \\cdot \\mathbf{1} + (U-J) \\cdot I$，其中 $\\mathbf{1}$ 是全一矩阵，$I$ 是单位矩阵。\n\n对于由自旋密度矩阵 $P^\\alpha$ 和 $P^\\beta$ 定义的态，其总能量由下式给出：\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big)\n$$\n其中 $n^\\sigma$ 是 $P^\\sigma$ 的对角元组成的向量。\n\n**任务 A：非限制性哈特里-福克 (UHF)**\n在 UHF 方法中，$\\alpha$ 和 $\\beta$ 电子的空间轨道允许不同。SCF 过程对两个独立的福克矩阵执行：\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big)\n$$\n过程如下：\n1.  **初始化**：对角化 $h$ 以获得初始分子轨道 (MOs)，$C_0$。构建初始密度矩阵 $P^\\alpha_0 = \\sum_{i=0}^{N_\\alpha-1} (C_0)_i (C_0)_i^\\mathsf{T}$ 和 $P^\\beta_0 = \\sum_{i=0}^{N_\\beta-1} (C_0)_i (C_0)_i^\\mathsf{T}$。\n2.  **SCF 迭代**：\n    a.  根据当前的密度矩阵 $P^\\alpha$ 和 $P^\\beta$，计算占据数向量 $n^\\alpha$ 和 $n^\\beta$。\n    b.  构建福克矩阵 $F^\\alpha$ 和 $F^\\beta$。\n    c.  对角化每个福克矩阵：$F^\\sigma C^\\sigma = C^\\sigma \\varepsilon^\\sigma$。\n    d.  通过占据能量最低的 $N_\\sigma$ 个轨道，形成新的密度矩阵 $P^\\sigma_{\\text{calc}}$。\n    e.  对密度矩阵应用线性混合以确保平滑收敛：$P^\\sigma_{\\text{new}} = (1-\\lambda)P^\\sigma_{\\text{old}} + \\lambda P^\\sigma_{\\text{calc}}$，其中混合参数 $\\lambda \\in (0,1]$。\n    f.  计算新的总能量 $E_{\\text{new}}$。\n3.  **收敛**：重复 SCF 循环，直到总能量的变化 $|E_{\\text{new}} - E_{\\text{old}}|$ 小于 $10^{-10}$ 哈特里。\n4.  **SCF 后计算**：收敛后，使用以下公式计算总能量 $E_{\\text{UHF}}$ 和自旋平方期望值 $\\langle S^2 \\rangle_{\\text{UHF}}$：\n$$\n\\langle S^2 \\rangle = S_z(S_z+1) + N_\\beta - \\operatorname{Tr}(S S^\\mathsf{T}), \\quad \\text{where } S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}\n$$\n$\\langle S^2 \\rangle_{\\text{UHF}}  S(S+1)=2$ 的值表示存在自旋污染。\n\n**任务 B：限制性开壳层哈特里-福克 (ROHF)**\nROHF 方法强制所有电子使用一套共同的空间轨道。该问题定义了一个特定的简化类 ROHF 过程，使用一个单一的平均福克矩阵：\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big)\n$$\n过程是：\n1.  **初始化**：从对角化 $h$ 得到的 MOs 开始。\n2.  **SCF 迭代**：\n    a.  从当前的共同 MOs $C$ 出发，确定已占据子空间：$N_\\beta=4$ 个双占据轨道和 $(N_\\alpha-N_\\beta)=2$ 个单占据（$\\alpha$-自旋）轨道。\n    b.  构建相应的密度矩阵 $P^\\alpha$ 和 $P^\\beta$ 及其占据数向量 $n^\\alpha, n^\\beta$。\n    c.  构建平均福克矩阵 $F_R$。\n    d.  对角化 $F_R$ 以获得一组新的共同 MOs，$C_{\\text{new}}$。\n    e.  对 MOs 或密度矩阵应用混合并重复。\n3.  **收敛**：迭代直到能量变化低于阈值。\n4.  **SCF 后计算**：使用通用能量泛函和收敛的 ROHF 密度计算总能量 $E_{\\text{ROHF}}$。由于使用了共同的轨道集，自旋平方值 $\\langle S^2 \\rangle_{\\text{ROHF}}$ 将精确等于 $2$。\n\n**任务 C：自旋投影哈特里-福克 (PUHF)**\n此任务涉及对收敛的 UHF 解进行后处理步骤，以消除自旋污染。该过程是自旋投影的一个简化版本，如下所示：\n1.  从收敛的 UHF MOs，$C^\\alpha_{\\text{occ}}$ ($M \\times N_\\alpha$) 和 $C^\\beta_{\\text{occ}}$ ($M \\times N_\\beta$) 开始。\n2.  定义到 $\\alpha$-占据子空间的投影算符：$P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$。\n3.  将 $\\beta$-占据轨道投影到 $\\alpha$-占据空间中（问题描述是投影到此子空间，而不是其补空间）。$\\widetilde{C}^\\beta_{\\text{occ}} = P_A\\, C^\\beta_{\\text{occ}}$。\n4.  对得到的投影 $\\beta$-轨道集进行对称正交归一化：\n$$\nC^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2}\n$$\n格拉姆矩阵 $G = (\\widetilde{C}^\\beta_{\\text{occ}})^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}$ 的逆平方根通过其特征分解稳健地计算：$G=W\\Lambda W^\\mathsf{T}$，因此 $G^{-1/2} = W\\Lambda^{-1/2}W^\\mathsf{T}$。\n5.  构建投影密度矩阵：$P^\\alpha_{\\text{PUHF}} = P^\\alpha_{\\text{UHF}}$ 和 $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$。\n6.  **计算**：计算能量 $E_{\\text{PUHF}} = E[P^\\alpha_{\\text{PUHF}}, P^\\beta_{\\text{PUHF}}]$。对于此态，自旋平方期望值 $\\langle S^2 \\rangle_{\\text{PUHF}}$ 必须精确得到 $2$，这可由投影的代数性质证明。\n\n最后，计算 $\\pi^\\ast_x$ (索引 4) 和 $\\pi^\\ast_y$ (索引 5) 轨道上的自旋密度 $m_i = (P^\\alpha - P^\\beta)_{ii}$。问题要求在最终输出列表中提供一对自旋密度。根据其在列表中 PUHF 结果之后的位置，最合乎逻辑的解释是报告来自最终的自旋投影态 $(P^\\alpha_{\\text{PUHF}} - P^\\beta_{\\text{PUHF}})$ 的密度。\n\n实现将通过为每个任务定义 Python 函数、设置所需的矩阵，并遍历所提供的三种参数情况来进行。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef matrix_inv_sqrt(A):\n    \"\"\"Computes the inverse square root of a symmetric matrix A using eigendecomposition.\"\"\"\n    eigvals, eigvecs = eigh(A)\n    # Check for near-zero eigenvalues to avoid division by zero\n    inv_sqrt_eigvals = np.array([1.0 / np.sqrt(v) if v > 1e-15 else 0.0 for v in eigvals])\n    return eigvecs @ np.diag(inv_sqrt_eigvals) @ eigvecs.T\n\ndef calculate_s2(C_alpha_occ, C_beta_occ, N_alpha, N_beta):\n    \"\"\"Calculates the S^2 value.\"\"\"\n```", "id": "2911621"}]}