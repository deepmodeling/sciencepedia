{"hands_on_practices": [{"introduction": "在使用任何量子化学方法进行计算之前，最基本的一步是确定所用基组的大小。本练习 [@problem_id:2916487] 提供了一个亲手实践的机会，让你解构一个简单的分子——甲烷所使用的 `6-31G(d)` 基组。通过遵循给定的定义，你将练习计算笛卡尔基函数的总数，从而加深对 `sp` 壳层和极化函数等概念的理解。", "problem": "考虑在电子结构方法的原子轨道线性组合框架中使用收缩高斯型轨道 (GTO)。在 Pople 型基组中，一个 $\\text{sp}$ 壳层表示一对 $s$ 型和 $p$ 型收缩函数，它们共享相同的高斯指数，但 $s$ 和 $p$ 部分的收缩系数是独立的。$\\text{6-31G(d)}$ 基组的规定如下：对于像碳这样的第二周期主族原子，有三个由尺寸为 $6$、$3$ 和 $1$ 的原函数集构成的收缩 $\\text{sp}$ 壳层；对于氢，有两个由尺寸为 $3$ 和 $1$ 的原函数集构成的收缩 $s$ 型壳层。$(d)$ 极化增强表示仅在重原子上添加一个 $d$ 型极化壳层。本题中假设 $d$ 型极化函数是笛卡尔型（而非球谐型），并且极化仅添加到碳原子上。\n\n仅使用上述定义，结合角动量为 $l$ 的笛卡尔 GTO 的组合结构以及 $\\text{sp}$ 壳层的含义，确定在这些假设下，用 $\\text{6-31G(d)}$ 描述的甲烷 $\\text{CH}_{4}$ 的笛卡尔基函数总数。答案以不带单位的整数表示。", "solution": "该问题要求确定甲烷分子 $\\text{CH}_{4}$ 在使用记为 $\\text{6-31G(d)}$ 的特定基组时的笛卡尔基函数总数。问题为碳原子和氢原子的该基组构建提供了明确的定义，这些定义必须被精确遵守，并优先于任何与该基组名称相关的标准外部惯例。\n\n基函数的总数是分子中每个原子贡献的基函数之和。甲烷由一个碳原子（$\\text{C}$）和四个氢原子（$\\text{H}$）组成。因此，我们必须计算一个碳原子和四个氢原子的基函数数量并将它们相加。\n\n对于给定的角动量量子数 $l$，笛卡尔高斯型轨道 (GTO) 的数量由公式 $\\frac{(l+1)(l+2)}{2}$ 给出。\n对于 $s$ 型壳层，$l=0$，对应 $\\frac{(0+1)(0+2)}{2} = 1$ 个基函数。\n对于 $p$ 型壳层，$l=1$，对应 $\\frac{(1+1)(1+2)}{2} = 3$ 个基函数（即 $p_x$、$p_y$ 和 $p_z$ 轨道）。\n对于 $d$ 型壳层，$l=2$，对应 $\\frac{(2+1)(2+2)}{2} = 6$ 个基函数，题目中规定其为笛卡尔型。\n\n首先，我们分析碳原子的基组。问题陈述：“对于像碳这样的第二周期主族原子，有三个由尺寸为 $6$、$3$ 和 $1$ 的原函数集构成的收缩 $\\text{sp}$ 壳层”。一个 $\\text{sp}$ 壳层被定义为“一对 $s$ 型和 $p$ 型收缩函数”。这意味着对于每个这样的壳层，有一个 $s$ 型函数和一组 $p$ 型函数。\n因此，一个 $\\text{sp}$ 壳层贡献 $1$（$s$ 函数）$+ 3$（$p$ 函数）$= 4$ 个基函数。\n由于碳原子由三个这样的 $\\text{sp}$ 壳层描述，来自这些壳层的基函数总数为 $3 \\times 4 = 12$。\n\n接下来，我们考虑极化函数。符号“$(d)$”表示“仅在重原子上添加一个 $d$ 型极化壳层”。碳是重原子。问题指明这些是笛卡尔 $d$ 函数。一个笛卡尔 $d$ 函数壳层（$l=2$）包含 $6$ 个基函数。\n因此，单个碳原子的基函数总数是来自 $\\text{sp}$ 壳层和极化壳层的函数之和：$12 + 6 = 18$。\n\n其次，我们分析氢原子的基组。问题陈述：“对于氢，有两个由尺寸为 $3$ 和 $1$ 的原函数集构成的收缩 $s$ 型壳层”。\n每个 $s$ 型壳层贡献 $1$ 个基函数。\n由于氢有两个这样的壳层，每个氢原子的基函数总数为 $2 \\times 1 = 2$。\n在此基组中，不为氢原子添加极化函数。\n\n最后，我们计算 $\\text{CH}_{4}$ 分子的基函数总数。该分子包含 $1$ 个碳原子和 $4$ 个氢原子。\n函数总数是所有原子贡献的总和：\n总函数数 = (C 上的函数数) + $4 \\times$ (H 上的函数数)\n总函数数 = $18 + 4 \\times 2 = 18 + 8 = 26$。\n\n该计算严格基于问题陈述本身提供的定义，这是唯一正确的方法。", "answer": "$$\\boxed{26}$$", "id": "2916487"}, {"introduction": "选择基组不仅是大小的问题，更要切合待研究的化学问题。本实践 [@problem_id:2916573] 探究了一个关键应用：电子亲和能的计算，该性质对基组描述空间广延电子分布的灵活性高度敏感。你将使用一个基于微扰理论的模型，来量化添加弥散函数（例如 `6-31+G(d)` 中的 `+` 或 `def2-SVPD` 中的 `D`）对于准确描述阴离子的重要性，从而将抽象的基组构造与具体的化学洞见联系起来。", "problem": "你的任务是形式化、推导并实现一个有原则的算法，用以比较氯原子（形成氯阴离子）在使用和不使用弥散增广函数时的电子亲和能。该比较针对量子化学中两种广泛使用的高斯轨道基组族：Pople风格基组和Karlsruhe def2基组。你的目标是设计一个仅使用关于基组增广及其对附加电子能量的变分效应的第一性原理推断的计算方法，而不涉及任何经验校正。\n\n从以下经过充分检验的基础出发。\n\n- 变分原理和Rayleigh–Ritz方法：对于一个厄米算符，扩展试探子空间不会增加其最低本征值。如果一个哈密顿（或福克）算符在一个分块划分的基中表示为一个参考子空间与一个外部子空间的耦合，那么参考子空间内的能量会因与外部空间的虚耦合而降低。\n- 正交投影（Löwdin）划分和二阶能量降低：考虑一个未扰动能量为 $\\varepsilon_0$ 的单一参考轨道，它通过非对角耦合 $\\{v_k\\}$ 与一组轨道能量为 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$ 的外部正交函数耦合。在假设 $|\\varepsilon_k^{\\mathrm{ext}}-\\varepsilon_0| \\gg |v_k|$ 并忽略高阶项的情况下，参考态的有效能量会降低一个量，该量可以通过对组合空间中算符的块对角化推导得出。\n- Hartree-Fock Koopmans定理：在冻结轨道近似下，电子亲和能（EA）近似为中性物种相对于真空能级的最低未占分子轨道（LUMO）能量的负值，即 $\\mathrm{EA} \\approx -\\varepsilon_{\\mathrm{LUMO}}$。\n\n你的任务是：\n\n1) 严格从上述原理出发，当基组通过存在于外部空间的弥散函数进行增广时，推导中性氯原子LUMO能量移动 $\\Delta \\varepsilon$ 的最低阶表达式。用 $\\varepsilon_0$、耦合 $\\{v_k\\}$ 以及外部空间轨道能量 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$ 来表示校正后的LUMO能量 $\\varepsilon$。然后使用 $\\mathrm{EA} \\approx -\\varepsilon$ 得到电子亲和能。\n\n2) 将推导出的表达式实现为一个程序，用于计算以下四个测试案例的电子亲和能。这些案例代表了Pople风格和Karlsruhe def2基组在有和没有弥散增广的情况。下面提供的所有能量单位均为哈特里（Hartree）。使用物理换算关系 $1\\,\\mathrm{Hartree} = 27.211386245988\\,\\mathrm{eV}$，并以电子伏特（eV）为单位报告电子亲和能，结果四舍五入到三位小数。\n\n- 案例A (Pople 6-31G(d)，无弥散增广)：未扰动的中性LUMO能量 $\\varepsilon_0 = 0.065$。不存在外部空间态，因此没有耦合。\n- 案例B (Pople 6-31+G(d)，有弥散增广)：未扰动的中性LUMO能量 $\\varepsilon_0 = 0.065$。外部空间轨道能量 $\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.335, 0.265, 0.245\\}$。耦合 $\\{v_k\\} = \\{0.17, 0.12, 0.07\\}$。\n- 案例C (Karlsruhe def2-SVP，无弥散增广)：未扰动的中性LUMO能量 $\\varepsilon_0 = 0.050$。不存在外部空间态。\n- 案例D (Karlsruhe def2-SVPD，有弥散增广)：未扰动的中性LUMO能量 $\\varepsilon_0 = 0.050$。外部空间轨道能量 $\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.32, 0.27, 0.25, 0.23\\}$。耦合 $\\{v_k\\} = \\{0.15, 0.11, 0.08, 0.05\\}$。\n\n你必须遵守的假设和约束：\n\n- 将中性LUMO视为参考态，将添加的弥散函数视为构成外部空间。假设所有分母 $\\varepsilon_k^{\\mathrm{ext}}-\\varepsilon_0$ 均为严格正值，并且与 $|v_k|$ 相比足够大，以证明在最低非平凡阶进行截断是合理的。\n- 忽略超出上述最低阶变分/划分校正以及Hartree-Fock冻结轨道对电子附着解释之外的弛豫和相关效应。\n- 以 $\\mathrm{eV}$ 为单位计算 $\\mathrm{EA}$，四舍五入到三位小数。\n\n你的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表（例如，“[x1,x2,x3,x4]”）。该列表必须按[案例A, 案例B, 案例C, 案例D]的顺序排列。每个案例的结果必须是 $\\mathrm{eV}$ 单位的浮点数。\n\n供你的程序逐字使用的测试套件摘要：\n\n- 案例A: $\\varepsilon_0 = 0.065$, 无 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$, 无 $\\{v_k\\}$。\n- 案例B: $\\varepsilon_0 = 0.065$, $\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.335, 0.265, 0.245\\}$, $\\{v_k\\} = \\{0.17, 0.12, 0.07\\}$。\n- 案例C: $\\varepsilon_0 = 0.050$, 无 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$, 无 $\\{v_k\\}$。\n- 案例D: $\\varepsilon_0 = 0.050$, $\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.32, 0.27, 0.25, 0.23\\}$, $\\{v_k\\} = \\{0.15, 0.11, 0.08, 0.05\\}$。\n\n角度单位不适用。不使用百分比。所有物理量均使用上述单位。最终输出必须是严格遵循指定格式的单行文本。", "solution": "所述问题在科学上是合理的、提法明确且自洽的。它代表了量子化学中的一个标准教学练习，要求应用二阶微扰理论来模拟基组增广对轨道能量的影响，并进而通过Koopmans定理计算电子亲和能。所有必要的数据和简化假设都已明确提供。因此，该问题被认为是**有效的**，我们继续进行推导和求解。\n\n任务是确定氯原子的电子亲和能（$\\mathrm{EA}$），在冻结轨道Hartree-Fock近似（Koopmans定理）下，它由最低未占分子轨道（LUMO）能量 $\\varepsilon_{\\mathrm{LUMO}}$ 的负值给出。\n$$\n\\mathrm{EA} \\approx -\\varepsilon_{\\mathrm{LUMO}}\n$$\n我们需要模拟向基组中添加弥散函数的效果。这对应于扩展单电子希尔伯特空间。原始的、未增广的基组定义了一个参考子空间，而添加的弥散函数构成了一个外部子空间。从未增广计算中得到的LUMO是我们的参考态，记为 $|\\phi_0\\rangle$，其未扰动能量为 $\\varepsilon_0$。假设外部空间的基函数与参考空间正交，它们产生了一组外部轨道 $\\{|\\phi_k^{\\mathrm{ext}}\\rangle\\}$，其能量为 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$。\n\n在这个组合基中，福克算符 $\\hat{F}$ 可以用一个块矩阵表示。问题是找到与受扰动的参考态相对应的新最低本征值 $\\varepsilon$。该本征值问题由下式给出：\n$$\n\\begin{pmatrix} \\varepsilon_0  \\mathbf{v}^T \\\\ \\mathbf{v}  \\mathbf{E}^{\\mathrm{ext}} \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ \\mathbf{c}_{\\mathrm{ext}} \\end{pmatrix} = \\varepsilon \\begin{pmatrix} c_0 \\\\ \\mathbf{c}_{\\mathrm{ext}} \\end{pmatrix}\n$$\n此处，$\\varepsilon_0$ 是未扰动的LUMO能量，$\\mathbf{v}$ 是耦合矩阵元 $v_k = \\langle \\phi_0 | \\hat{F} | \\phi_k^{\\mathrm{ext}} \\rangle$ 的向量，$\\mathbf{E}^{\\mathrm{ext}}$ 是外部轨道能量 $\\{\\varepsilon_k^{\\mathrm{ext}}\\}$ 的对角矩阵。该线性方程组为：\n$$\n\\varepsilon_0 c_0 + \\sum_k v_k c_k = \\varepsilon c_0 \\quad (1)\n$$\n$$\nv_k c_0 + \\varepsilon_k^{\\mathrm{ext}} c_k = \\varepsilon c_k \\quad (2)\n$$\n从方程 $(2)$，我们求解外部态的系数 $c_k$：\n$$\n(\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon) c_k = -v_k c_0 \\implies c_k = -\\frac{v_k}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon} c_0\n$$\n将 $c_k$ 的这个表达式代回方程 $(1)$：\n$$\n\\varepsilon_0 c_0 + \\sum_k v_k \\left( -\\frac{v_k}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon} \\right) c_0 = \\varepsilon c_0\n$$\n两边除以 $c_0$（对于一个主要由原始LUMO构成的态，$c_0$ 必须非零），我们得到一个关于校正后能量 $\\varepsilon$ 的精确但隐式的方程：\n$$\n\\varepsilon = \\varepsilon_0 - \\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon}\n$$\n问题指明能量差 $|\\varepsilon_k^{\\mathrm{ext}}-\\varepsilon_0|$ 与耦合 $|v_k|$ 相比很大，这为采用微扰方法提供了理由。我们寻求最低阶的非平凡校正。这可以通过在分母中用未扰动值 $\\varepsilon_0$ 来近似未知能量 $\\varepsilon$ 来实现。这是二阶Rayleigh-Schrödinger微扰理论的标准步骤。\n$$\n\\varepsilon \\approx \\varepsilon_0 - \\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0}\n$$\n因此，能量移动 $\\Delta \\varepsilon = \\varepsilon - \\varepsilon_0$ 为：\n$$\n\\Delta \\varepsilon \\approx - \\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0}\n$$\n新的、校正后的LUMO能量是 $\\varepsilon = \\varepsilon_0 + \\Delta \\varepsilon$。然后电子亲和能计算为 $\\mathrm{EA} \\approx -\\varepsilon$。\n$$\n\\mathrm{EA} \\approx - \\left( \\varepsilon_0 - \\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0} \\right) = -\\varepsilon_0 + \\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0}\n$$\n所有能量均以哈特里（Hartree）为单位给出，最终结果必须使用换算因子 $1\\,\\mathrm{Hartree} = 27.211386245988\\,\\mathrm{eV}$ 转换为电子伏特（$\\mathrm{eV}$）。\n\n我们现在将此公式应用于四个指定的案例。\n\n**案例A: Pople 6-31G(d)**\n基组未增广。外部空间为空，因此求和项为零。\n$\\varepsilon_0 = 0.065\\,\\mathrm{Hartree}$。\n$\\varepsilon = \\varepsilon_0 = 0.065\\,\\mathrm{Hartree}$。\n$\\mathrm{EA} = -0.065\\,\\mathrm{Hartree} \\times 27.211386245988\\,\\mathrm{eV/Hartree} \\approx -1.76874\\,\\mathrm{eV}$。\n四舍五入到三位小数，$\\mathrm{EA} = -1.769\\,\\mathrm{eV}$。\n\n**案例B: Pople 6-31+G(d)**\n基组已增广。我们计算校正值。\n$\\varepsilon_0 = 0.065\\,\\mathrm{Hartree}$。\n$\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.335, 0.265, 0.245\\}\\,\\mathrm{Hartree}$。\n$\\{v_k\\} = \\{0.17, 0.12, 0.07\\}\\,\\mathrm{Hartree}$。\n校正项为：\n$\\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0} = \\frac{0.17^2}{0.335 - 0.065} + \\frac{0.12^2}{0.265 - 0.065} + \\frac{0.07^2}{0.245 - 0.065}$\n$= \\frac{0.0289}{0.27} + \\frac{0.0144}{0.20} + \\frac{0.0049}{0.18} \\approx 0.107037 + 0.072 + 0.027222 = 0.206259\\,\\mathrm{Hartree}$。\n校正后的LUMO能量为 $\\varepsilon \\approx 0.065 - 0.206259 = -0.141259\\,\\mathrm{Hartree}$。\n$\\mathrm{EA} \\approx 0.141259\\,\\mathrm{Hartree} \\times 27.211386245988\\,\\mathrm{eV/Hartree} \\approx 3.84409\\,\\mathrm{eV}$。\n四舍五入到三位小数，$\\mathrm{EA} = 3.844\\,\\mathrm{eV}$。\n\n**案例C: Karlsruhe def2-SVP**\n基组未增广。求和项为零。\n$\\varepsilon_0 = 0.050\\,\\mathrm{Hartree}$。\n$\\varepsilon = \\varepsilon_0 = 0.050\\,\\mathrm{Hartree}$。\n$\\mathrm{EA} = -0.050\\,\\mathrm{Hartree} \\times 27.211386245988\\,\\mathrm{eV/Hartree} \\approx -1.36057\\,\\mathrm{eV}$。\n四舍五入到三位小数，$\\mathrm{EA} = -1.361\\,\\mathrm{eV}$。\n\n**案例D: Karlsruhe def2-SVPD**\n基组通过弥散函数进行了增广。\n$\\varepsilon_0 = 0.050\\,\\mathrm{Hartree}$。\n$\\{\\varepsilon_k^{\\mathrm{ext}}\\} = \\{0.32, 0.27, 0.25, 0.23\\}\\,\\mathrm{Hartree}$。\n$\\{v_k\\} = \\{0.15, 0.11, 0.08, 0.05\\}\\,\\mathrm{Hartree}$。\n校正项为：\n$\\sum_k \\frac{v_k^2}{\\varepsilon_k^{\\mathrm{ext}} - \\varepsilon_0} = \\frac{0.15^2}{0.32 - 0.05} + \\frac{0.11^2}{0.27 - 0.05} + \\frac{0.08^2}{0.25 - 0.05} + \\frac{0.05^2}{0.23 - 0.05}$\n$= \\frac{0.0225}{0.27} + \\frac{0.0121}{0.22} + \\frac{0.0064}{0.20} + \\frac{0.0025}{0.18} \\approx 0.083333 + 0.055 + 0.032 + 0.013889 = 0.184222\\,\\mathrm{Hartree}$。\n校正后的LUMO能量为 $\\varepsilon \\approx 0.050 - 0.184222 = -0.134222\\,\\mathrm{Hartree}$。\n$\\mathrm{EA} \\approx 0.134222\\,\\mathrm{Hartree} \\times 27.211386245988\\,\\mathrm{eV/Hartree} \\approx 3.65287\\,\\mathrm{eV}$。\n四舍五入到三位小数，$\\mathrm{EA} = 3.653\\,\\mathrm{eV}$。\n\n结果表明，正如预期的那样，用弥散函数增广基组会显著降低LUMO能量，从而得到一个数值更正（且物理上更真实）的电子亲和能。这是因为弥散函数为轨道提供了必要的空间灵活性，以便在束缚更松的阴离子中容纳额外的电子。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electron affinity for chlorine using a second-order perturbation\n    model for the effect of diffuse basis functions.\n    \"\"\"\n\n    # Physical constant for energy conversion from Hartree to electron-volts.\n    HARTREE_TO_EV = 27.211386245988\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary with unperturbed LUMO energy (e0),\n    # external-space orbital energies (e_ext), and couplings (v_k).\n    test_cases = [\n        {\n            \"name\": \"Case A: Pople 6-31G(d)\",\n            \"e0\": 0.065, # in Hartree\n            \"e_ext\": np.array([]),\n            \"v_k\": np.array([])\n        },\n        {\n            \"name\": \"Case B: Pople 6-31+G(d)\",\n            \"e0\": 0.065, # in Hartree\n            \"e_ext\": np.array([0.335, 0.265, 0.245]), # in Hartree\n            \"v_k\": np.array([0.17, 0.12, 0.07]) # in Hartree\n        },\n        {\n            \"name\": \"Case C: Karlsruhe def2-SVP\",\n            \"e0\": 0.050, # in Hartree\n            \"e_ext\": np.array([]),\n            \"v_k\": np.array([])\n        },\n        {\n            \"name\": \"Case D: Karlsruhe def2-SVPD\",\n            \"e0\": 0.050, # in Hartree\n            \"e_ext\": np.array([0.32, 0.27, 0.25, 0.23]), # in Hartree\n            \"v_k\": np.array([0.15, 0.11, 0.08, 0.05]) # in Hartree\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e0 = case[\"e0\"]\n        e_ext = case[\"e_ext\"]\n        v_k = case[\"v_k\"]\n\n        # Calculate the second-order energy correction, which is zero for non-augmented bases.\n        energy_shift = 0.0\n        if e_ext.size > 0:\n            # The derived formula for the energy correction is sum(v_k^2 / (e_k_ext - e0))\n            denominators = e_ext - e0\n            terms = np.square(v_k) / denominators\n            energy_shift = np.sum(terms)\n        \n        # The corrected LUMO energy is lowered by the energy shift.\n        e_lumo_corrected_hartree = e0 - energy_shift\n\n        # Per Koopmans' theorem, EA is the negative of the LUMO energy.\n        ea_hartree = -e_lumo_corrected_hartree\n\n        # Convert the final electron affinity from Hartrees to eV.\n        ea_ev = ea_hartree * HARTREE_TO_EV\n\n        # Round the result to three decimal places as required.\n        results.append(round(ea_ev, 3))\n\n    # Final print statement in the exact required format: [x1,x2,x3,x4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2916573"}, {"introduction": "在追求高精度计算时，使用无限大的基组在计算上是不可行的。一种强大而通用的策略是使用一系列系统性的基组进行计算，然后将结果外推到完备基组（CBS）极限。本练习 [@problem_id:2916458] 以 Karlsruhe def2 系列基组为例，介绍了该技术背后的数学模型。你将推导并应用一个两点外推公式来估算苯的极化率的 CBS 极限，这是现代计算化学研究中一项至关重要的实用技能。", "problem": "要求您对使用 Karlsruhe def2 高斯型轨道（GTO）基组计算的苯的各向同性静态偶极极化率，进行形式化并实现一个简单的、有原则的收敛性和外推分析。完全基组（CBS）极限，记为 $\\,\\alpha_{\\infty}\\,$，假定其通过以下逆幂基数模型逼近\n$$\n\\alpha(X) \\;=\\; \\alpha_{\\infty} \\;+\\; A\\,X^{-p},\n$$\n其中 $\\,X\\,$ 是与基组相关的基数，$\\,A\\,$ 是一个不依赖于 $\\,X\\,$ 的振幅，$\\,p>0\\,$ 是一个选定的指数，它表征了目标性质的渐近收敛速率。对于 Karlsruhe def2 族系，请使用映射关系 $\\{\\text{def2-SVP},\\text{def2-TZVP},\\text{def2-QZVP}\\}\\mapsto \\{X{=}2,X{=}3,X{=}4\\}$。相比之下，Pople 型基组（例如 $\\,6\\text{-}31\\mathrm{G}^{\\ast}\\,$）并不构成严格的基数序列；在本任务中，您绝不能对 Pople 型基组假定基数模型。\n\n从上述模型出发，并仅利用实数的代数性质，推导一个使用 def2-TZVP 和 def2-QZVP 值（即 $\\,X{=}3\\,$ 和 $\\,X{=}4\\,$）来消去未知振幅 $\\,A\\,$ 的双点外推公式。您的程序必须实现这个推导出的双点公式，以根据数据对 $\\left(\\alpha(3),\\alpha(4)\\right)$ 和一个给定的指数 $\\,p\\,$ 来估算 $\\,\\alpha_{\\infty}\\,$。此外，为了表征在 $\\{X{=}2,3,4\\}$ 上的有限基组收敛行为，您的程序必须计算一个单调性指标，该指标为真的条件是当且仅当序列 $\\alpha(2),\\alpha(3),\\alpha(4)$ 是单调非减或单调非增的。\n\n对于每个测试用例，您的程序必须计算并报告以下三个量：\n- 双点 CBS 估算值 $\\,\\alpha_{\\infty}\\,$（仅使用 $\\,X{=}3\\,$ 和 $\\,X{=}4\\,$），单位为原子单位体积（$\\,a_0^3\\,$），四舍五入到 $\\,6\\,$ 位小数。\n- 从 def2-QZVP 到 CBS 的相对修正，定义为 $\\,\\delta \\equiv \\dfrac{\\alpha_{\\infty}-\\alpha(4)}{\\alpha_{\\infty}}\\,$，以小数形式报告（无单位），四舍五入到 $\\,6\\,$ 位小数。\n- 一个布尔型单调性标志，指示序列 $\\alpha(2),\\alpha(3),\\alpha(4)$ 是否为单调非减或单调非增。\n\n使用以下测试套件，其中每个用例是一个四元组 $\\big(\\alpha(2),\\alpha(3),\\alpha(4),p\\big)$，并且所有极化率的单位都是 $\\,a_0^3$：\n- 用例 $\\,1$: $\\;(66.7,\\,68.3,\\,69.0,\\,3.0)$\n- 用例 $\\,2$: $\\;(69.0,\\,69.2,\\,69.25,\\,4.0)$\n- 用例 $\\,3$: $\\;(68.5,\\,69.1,\\,68.95,\\,3.0)$\n- 用例 $\\,4$: $\\;(64.5,\\,67.5,\\,68.7,\\,3.0)$\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，每个测试用例的结果本身也是一个用方括号括起来的、以逗号分隔的列表，顺序为 $\\left[\\alpha_{\\infty},\\delta,\\text{monotone}\\right]$。例如，形式如下的一行：\n$[\\,[\\alpha_{\\infty}^{(1)},\\delta^{(1)},\\text{True}],\\,[\\alpha_{\\infty}^{(2)},\\delta^{(2)},\\text{False}],\\dots]$\n所有浮点值都四舍五入到 $\\,6\\,$ 位小数。所有 $\\alpha$ 值都必须理解为以 $\\,a_0^3$ 为单位，所有 $\\delta$ 值都必须是小数（而不是百分比）。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上植根于计算量子化学的原理，特别是基组外推法。该问题是适定的，提供了清晰的数学模型和足够的数据以获得唯一解。其语言客观明确。这是一个可形式化且相关的任务。\n\n我们首先从所提供的逆幂模型推导完全基组（CBS）极限 $\\alpha_{\\infty}$ 的双点外推公式：\n$$\n\\alpha(X) = \\alpha_{\\infty} + A X^{-p}\n$$\n在此，$\\alpha(X)$ 是基数为 $X$ 的基组所计算的性质，$A$ 是一个振幅，而 $p$ 是一个固定的指数。我们获得了 Karlsruhe def2 系列的数据，其中 def2-TZVP 和 def2-QZVP 分别对应于基数 $X=3$ 和 $X=4$。\n\n我们使用数据点 $(\\alpha(3), 3)$ 和 $(\\alpha(4), 4)$，为两个未知数 $\\alpha_{\\infty}$ 和 $A$ 构建一个二元线性方程组：\n$$\n\\alpha(3) = \\alpha_{\\infty} + A \\cdot 3^{-p} \\quad (\\text{式 1})\n$$\n$$\n\\alpha(4) = \\alpha_{\\infty} + A \\cdot 4^{-p} \\quad (\\text{式 2})\n$$\n我们的目标是通过消去未知振幅 $A$ 来求解 $\\alpha_{\\infty}$。我们可以从两个方程中分别表示出 $A$：\n从式 1 得：\n$$\nA = (\\alpha(3) - \\alpha_{\\infty}) \\cdot 3^p\n$$\n从式 2 得：\n$$\nA = (\\alpha(4) - \\alpha_{\\infty}) \\cdot 4^p\n$$\n令这两个关于 $A$ 的表达式相等，我们就消去了振幅：\n$$\n(\\alpha(3) - \\alpha_{\\infty}) \\cdot 3^p = (\\alpha(4) - \\alpha_{\\infty}) \\cdot 4^p\n$$\n现在我们求解这个方程以得到 $\\alpha_{\\infty}$。展开两边可得：\n$$\n\\alpha(3) \\cdot 3^p - \\alpha_{\\infty} \\cdot 3^p = \\alpha(4) \\cdot 4^p - \\alpha_{\\infty} \\cdot 4^p\n$$\n重新整理各项以分离出 $\\alpha_{\\infty}$：\n$$\n\\alpha_{\\infty} \\cdot 4^p - \\alpha_{\\infty} \\cdot 3^p = \\alpha(4) \\cdot 4^p - \\alpha(3) \\cdot 3^p\n$$\n提取公因式 $\\alpha_{\\infty}$：\n$$\n\\alpha_{\\infty} (4^p - 3^p) = 4^p \\alpha(4) - 3^p \\alpha(3)\n$$\n鉴于 $p \\neq 0$（题目中说明 $p>0$），$(4^p - 3^p)$ 项不为零，我们可以用它来除，从而得到 CBS 外推值的最终表达式：\n$$\n\\alpha_{\\infty} = \\frac{4^p \\alpha(4) - 3^p \\alpha(3)}{4^p - 3^p}\n$$\n这就是所要求的双点外推公式。它将用于计算每个测试用例的 CBS 极限。\n\n接下来，从 def2-QZVP 值到 CBS 极限的相对修正定义为：\n$$\n\\delta = \\frac{\\alpha_{\\infty} - \\alpha(4)}{\\alpha_{\\infty}}\n$$\n这个量是无量纲的，并且将使用计算出的 $\\alpha_{\\infty}$ 和给定的 $\\alpha(4)$ 来计算。\n\n最后，我们必须确定有限基组值序列 $(\\alpha(2), \\alpha(3), \\alpha(4))$ 是否是单调的。如果一个序列是单调非减或单调非增的，那么它就是单调的。\n- 如果 $a_1 \\le a_2 \\le a_3$，则序列 $(a_1, a_2, a_3)$ 是单调非减的。\n- 如果 $a_1 \\ge a_2 \\ge a_3$，则序列 $(a_1, a_2, a_3)$ 是单调非增的。\n如果序列 $(\\alpha(2), \\alpha(3), \\alpha(4))$ 满足这两个条件中的任意一个，一个布尔标志将被设置为真，否则为假。这为计算的收敛行为提供了一个简单的检查。非单调序列可能表示基组族系中存在不规则性，或者尚未达到渐近收敛区域。\n\n现在将通过把这些推导出的公式和逻辑应用于所提供的测试用例来开始实现。所有浮点结果必须按要求四舍五入到 $6$ 位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the basis set convergence and extrapolation problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: (alpha(2), alpha(3), alpha(4), p) in a_0^3\n        (66.7, 68.3, 69.0, 3.0),\n        # Case 2\n        (69.0, 69.2, 69.25, 4.0),\n        # Case 3\n        (68.5, 69.1, 68.95, 3.0),\n        # Case 4\n        (64.5, 67.5, 68.7, 3.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        a2, a3, a4, p = case\n        \n        # 1. Compute the two-point CBS estimate alpha_infinity\n        # Formula: alpha_inf = (4^p * a4 - 3^p * a3) / (4^p - 3^p)\n        try:\n            x3_p = np.power(3.0, p)\n            x4_p = np.power(4.0, p)\n            \n            numerator = x4_p * a4 - x3_p * a3\n            denominator = x4_p - x3_p\n            \n            # Avoid division by zero, although p > 0 ensures denominator != 0\n            if denominator == 0:\n                # This case is not expected with p > 0\n                raise ValueError(\"Denominator is zero, p must be non-zero.\")\n\n            alpha_inf = numerator / denominator\n        except (ValueError, ZeroDivisionError) as e:\n            # In a real scenario, handle this error properly.\n            # For this problem, we assume valid inputs where this does not occur.\n            alpha_inf = float('nan')\n\n        # 2. Compute the relative correction delta\n        # Formula: delta = (alpha_inf - a4) / alpha_inf\n        try:\n            # Avoid division by zero if alpha_inf is zero\n            if alpha_inf == 0:\n                delta = float('inf') if a4 != 0 else 0.0\n            else:\n                 delta = (alpha_inf - a4) / alpha_inf\n        except ZeroDivisionError:\n            delta = float('nan')\n\n        # 3. Compute the boolean monotonicity flag\n        # True if the sequence (a2, a3, a4) is monotone nondecreasing or nonincreasing.\n        is_nondecreasing = (a2 <= a3) and (a3 <= a4)\n        is_nonincreasing = (a2 >= a3) and (a3 >= a4)\n        is_monotone = is_nondecreasing or is_nonincreasing\n        \n        # We round the floating point numbers here before appending.\n        # However, the final formatting string will enforce 6 decimal places.\n        all_results.append([alpha_inf, delta, is_monotone])\n\n    # Format the final output string exactly as required.\n    # The format specifier \":.6f\" handles rounding and ensures 6 decimal places.\n    result_strings = []\n    for r in all_results:\n        alpha_inf_str = f\"{r[0]:.6f}\"\n        delta_str = f\"{r[1]:.6f}\"\n        monotone_str = str(r[2])\n        result_strings.append(f\"[{alpha_inf_str},{delta_str},{monotone_str}]\")\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2916458"}]}