{"hands_on_practices": [{"introduction": "掌握衡态校正法的第一步是理解其基本数学形式和物理意义。这个练习将指导你从基本定义出发，推导出未校正相互作用能、基组叠加误差（BSSE）和衡态校正后相互作用能之间的关系 [@problem_id:2875570]。通过计算并解释各项的正负号，你将能深刻理解为何BSSE是一种非物理的人为稳定化效应，以及衡态校正如何修正这一误差。", "problem": "一个由单体 $A$ 和 $B$ 组成的非共价二聚体，在固定几何构型下进行研究，所有计算均使用相同的原子轨道基组。原始相互作用能（计算为二聚体与孤立单体（各自在其单体基组中优化）之间的超分子能量差）据报道为 $-4.5$ kcal/mol。使用 Boys–Bernardi 衡态校正原理，在相同几何构型下，该二聚体的基组叠加误差（BSSE）校正值经评估为 $+1.2$ kcal/mol。\n\n仅从超分子相互作用能的基本定义（二聚体能量与单体能量之和的差值）以及衡态校正的概念性定义（通过“鬼函数”移除因基组共享导致的人为稳定性）出发，推导衡态校正后的相互作用能与未校正的相互作用能及BSSE校正值之间的关系。然后根据上述数据计算衡态校正后的相互作用能。最后，根据结合强度和BSSE，解释校正值和校正后相互作用能的符号。以 kcal/mol 为单位表示最终能量，不要四舍五入。", "solution": "任务是从基本定义出发，推导校正后相互作用能、未校正相互作用能和BSSE校正值之间的关系。\n\n让我们定义能量项。用于给定计算的基组用上标表示。设 $\\chi_A$ 是以单体 $A$ 为中心的基组，$\\chi_B$ 是以单体 $B$ 为中心的基组。超分子基组是它们的并集，即 $\\chi_{AB} = \\chi_A \\cup \\chi_B$。\n\n*   用其自身基组 $\\chi_A$ 计算的孤立单体 $A$ 的能量是 $E_{A}^{\\chi_A}$。\n*   用其自身基组 $\\chi_B$ 计算的孤立单体 $B$ 的能量是 $E_{B}^{\\chi_B}$。\n*   用完整的超分子基组 $\\chi_{AB}$ 计算的二聚体 $AB$ 的能量是 $E_{AB}^{\\chi_{AB}}$。\n\n根据定义，未校正（或原始）的相互作用能 $\\Delta E_{\\text{uncorr}}$ 为：\n$$\n\\Delta E_{\\text{uncorr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B})\n$$\n根据题目，该值为 $-4.5 \\, \\text{kcal/mol}$。\n\n基组叠加误差（BSSE）的产生，是因为在计算二聚体能量 $E_{AB}^{\\chi_{AB}}$ 时，单体 $A$ 可以“借用”$\\chi_B$ 的基函数，反之亦然。这使得二聚体内的每个单体片段能被一个比其孤立时（仅使用各自的基组 $\\chi_A$ 或 $\\chi_B$）更大、更灵活的基组（$\\chi_{AB}$）所描述。根据变分原理，使用更大的基组会得到一个更低（更负）的计算能量。这就导致了二聚体的人为的、非物理的稳定化。\n\nBoys和Bernardi的衡态校正方法旨在估计并消除这种人为的稳定化。该方法通过使用完整的超分子基组 $\\chi_{AB}$ 来计算单个单体的能量。具体来说，我们计算单体 $A$ 在单体 $B$ 的基函数（被称为“鬼函数”）存在下的能量（但不包含 $B$ 的原子核或电子）。该能量记为 $E_{A}^{\\chi_{AB}}$。类似地，带有 $A$ 的鬼函数的单体 $B$ 的能量是 $E_{B}^{\\chi_{AB}}$。\n\n衡态校正值 $\\delta_{\\text{BSSE}}$ 被定义为每个单体所经历的人为稳定化作用的总和：\n$$\n\\delta_{\\text{BSSE}} = (E_{A}^{\\chi_A} - E_{A}^{\\chi_{AB}}) + (E_{B}^{\\chi_B} - E_{B}^{\\chi_{AB}})\n$$\n根据变分原理，$E_{A}^{\\chi_{AB}} \\le E_{A}^{\\chi_A}$ 且 $E_{B}^{\\chi_{AB}} \\le E_{B}^{\\chi_B}$，因此 $\\delta_{\\text{BSSE}}$ 的值是非负的。它代表了非物理稳定化作用的量值。根据题目，该校正值为 $+1.2 \\, \\text{kcal/mol}$。\n\n衡态校正后的相互作用能 $\\Delta E_{\\text{corr}}$ 的定义是，二聚体及其组分单体的能量是在“同等基础”上计算的，即它们都使用相同的超分子基组 $\\chi_{AB}$：\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}})\n$$\n为了推导 $\\Delta E_{\\text{corr}}$、$\\Delta E_{\\text{uncorr}}$ 和 $\\delta_{\\text{BSSE}}$ 之间的关系，我们可以重新排列 $\\Delta E_{\\text{corr}}$ 的表达式，通过加上和减去项 $(E_{A}^{\\chi_A} + E_{B}^{\\chi_B})$：\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}}) + (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B})\n$$\n重新组合各项：\n$$\n\\Delta E_{\\text{corr}} = \\left[ E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) \\right] + \\left[ (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}}) \\right]\n$$\n第一个方括号中的项是未校正的相互作用能 $\\Delta E_{\\text{uncorr}}$。第二个方括号中的项可以重新整理为：\n$$\n(E_{A}^{\\chi_A} - E_{A}^{\\chi_{AB}}) + (E_{B}^{\\chi_B} - E_{B}^{\\chi_{AB}})\n$$\n这正是衡态校正值 $\\delta_{\\text{BSSE}}$ 的定义。\n因此，推导出的关系是：\n$$\n\\Delta E_{\\text{corr}} = \\Delta E_{\\text{uncorr}} + \\delta_{\\text{BSSE}}\n$$\n推导完成。\n\n现在，我们使用所给数据计算校正后相互作用能的数值：\n$\\Delta E_{\\text{uncorr}} = -4.5 \\, \\text{kcal/mol}$\n$\\delta_{\\text{BSSE}} = +1.2 \\, \\text{kcal/mol}$\n\n$$\n\\Delta E_{\\text{corr}} = -4.5 \\, \\text{kcal/mol} + 1.2 \\, \\text{kcal/mol} = -3.3 \\, \\text{kcal/mol}\n$$\n\n最后，我们解释这些符号和数值。\n1.  **BSSE校正值的符号 ($\\delta_{\\text{BSSE}} = +1.2 \\, \\text{kcal/mol}$)**：校正值为正，表明未校正的计算高估了二聚体的结合能 $1.2 \\, \\text{kcal/mol}$。由于单体间基函数的非物理性“借用”，$-4.5 \\, \\text{kcal/mol}$ 的原始相互作用能被人为地压低了（即过度稳定）。正号表示此误差是一种稳定化效应，而校正的作用是减小结合能的绝对值，从而使计算出的相互作用变弱。这是对BSSE物理上预期的结果。\n\n2.  **校正后相互作用能的符号 ($\\Delta E_{\\text{corr}} = -3.3 \\, \\text{kcal/mol}$)**：校正后的相互作用能为负值。在化学热力学中，负的相互作用能表示一个稳定的束缚相互作用。因此，在移除了基组叠加的赝象后，$-3.3 \\, \\text{kcal/mol}$ 这个值代表了在给定几何构型下二聚体 $AB$ 更真实的物理结合能。它证实了该二聚体是一个束缚复合物，相对于解离成其组分单体而言是稳定的，稳定化能为 $3.3 \\, \\text{kcal/mol}$。未校正的结果（$-4.5 \\, \\text{kcal/mol}$）中，大约 $27\\%$（$1.2/4.5 \\approx 0.267$）的表观稳定性是计算赝象。衡态校正提供了一个对相互作用强度更有物理意义的估计。", "answer": "$$\\boxed{-3.3}$$", "id": "2875570"}, {"introduction": "在理论推导之后，下一步是将其应用于真实的计算化学数据中。本练习提供了一系列为水二聚体计算的原始能量值，你需要从中提取信息，计算未校正和衡态校正后的相互作用能 [@problem_id:2875497]。通过比较两种不同理论方法（$MP2$ 和 $CCSD(T)$）的结果，你将学会如何量化BSSE对计算结果的影响，并体会到误差大小与所用电子结构方法的相关性。", "problem": "使用相关一致性极化价双ζ基组 (cc-pVDZ)，在两个电子结构理论水平上计算了水二聚体的相互作用：二阶Møller–Plesset微扰理论 (MP2) 和包含单、双和微扰三激发的耦合簇理论 (CCSD(T))。超分子相互作用能定义为二聚体的总电子能量与孤立单体总电子能量之和的差，单位均为哈特里 (Hartree)。基组重叠误差的产生是由于在有限基组中，二聚体中的每个单体可以通过借用伙伴单体的基函数来变分地降低其能量。Boys–Bernardi衡态校正用在二聚体基组中的单体能量（即伙伴单体的基函数作为未占据的“鬼”函数被包含在内）替换了单体能量。\n\n给定以下总电子能量，均在指定水平上使用cc-pVDZ基组计算得出：\n\n- 在MP2水平下：\n  - 二聚体在二聚体基组中的能量：$E_{AB}^{AB} = -152.064220$。\n  - 单体在各自单体基组中的能量：$E_{A}^{A} = -76.026760$，$E_{B}^{B} = -76.026760$。\n  - 单体在二聚体基组中的能量（鬼函数计算）：$E_{A}^{AB} = -76.028600$，$E_{B}^{AB} = -76.028320$。\n\n- 在CCSD(T)水平下：\n  - 二聚体在二聚体基组中的能量：$E_{AB}^{AB} = -152.226100$。\n  - 单体在各自单体基组中的能量：$E_{A}^{A} = -76.108150$，$E_{B}^{B} = -76.108150$。\n  - 单体在二聚体基组中的能量（鬼函数计算）：$E_{A}^{AB} = -76.109300$，$E_{B}^{AB} = -76.108900$。\n\n仅使用超分子相互作用能的定义、鬼基函数的概念以及衡态校正的思想，在每个水平（MP2 和 CCSD(T)）上执行以下操作：\n\n1. 计算未校正的相互作用能（无衡态校正）。\n2. 计算经过衡态校正的相互作用能。\n3. 将由基组重叠误差引起的过结合定义为未校正相互作用能的绝对值相对于经过衡态校正的相互作用能的绝对值的超出部分。然后，计算通过衡态校正消除的过结合分数，即该超出部分与未校正相互作用能的绝对值之比。\n\n将每个过结合消除分数的结果表示为无单位的十进制小数。将您的两个结果四舍五入至四位有效数字。按 $(\\text{MP2}, \\text{CCSD(T)})$ 的顺序提供您的最终答案。", "solution": "基本量是未校正和经过衡态校正的相互作用能。让能量项 $E$ 上的上标表示计算所用的基组，下标表示分子体系。单体 $A$ 的基组表示为 $A$，二聚体 $AB$ 的基组是单体基组的并集，也表示为 $AB$。\n\n未校正的超分子相互作用能 $\\Delta E_{\\text{uncorr}}$ 定义为二聚体 $AB$ 在完整二聚体基组中计算的总能量 $E_{AB}^{AB}$ 与孤立单体 $A$ 和 $B$ 各自在其自身基组中计算的能量之和（分别为 $E_{A}^{A}$ 和 $E_{B}^{B}$）的差。\n$$\n\\Delta E_{\\text{uncorr}} = E_{AB}^{AB} - (E_{A}^{A} + E_{B}^{B})\n$$\n\n基组重叠误差 (BSSE) 的产生是由于在二聚体计算中，单体 $A$ 可以“借用”单体 $B$ 的基函数来降低其能量，反之亦然。这是使用不完备、有限基组所产生的赝象。Boys–Bernardi衡态校正试图校正这个问题。经过衡态校正的相互作用能 $\\Delta E_{\\text{corr}}$ 是使用在完整二聚体基组中计算的单体能量来计算的。这是通过在伙伴单体的“鬼”基函数存在但没有其原子核或电子的情况下，对每个单体进行计算来实现的。这些能量表示为 $E_{A}^{AB}$ 和 $E_{B}^{AB}$。\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{AB} - (E_{A}^{AB} + E_{B}^{AB})\n$$\n\n由BSSE引起的过结合定义为未校正和校正后相互作用能的绝对值之差。由于束缚复合物的相互作用能为负，其绝对值为 $|\\Delta E|$。\n$$\n\\text{过结合} = |\\Delta E_{\\text{uncorr}}| - |\\Delta E_{\\text{corr}}|\n$$\n被消除的过结合分数，我们记为 $F$，是这个过结合量与未校正相互作用能绝对值的比率。\n$$\nF = \\frac{|\\Delta E_{\\text{uncorr}}| - |\\Delta E_{\\text{corr}}|}{|\\Delta E_{\\text{uncorr}}|} = 1 - \\frac{|\\Delta E_{\\text{corr}}|}{|\\Delta E_{\\text{uncorr}}|}\n$$\n我们现在将为指定的两个理论水平计算这个分数。\n\n首先，对于MP2/cc-pVDZ理论水平：\n给定的能量是：\n$E_{AB}^{AB} = -152.064220$\n$E_{A}^{A} = -76.026760$\n$E_{B}^{B} = -76.026760$\n$E_{A}^{AB} = -76.028600$\n$E_{B}^{AB} = -76.028320$\n\n未校正的相互作用能为：\n$$\n\\Delta E_{\\text{uncorr}}(\\text{MP2}) = -152.064220 - (-76.026760 - 76.026760) = -152.064220 + 152.053520 = -0.010700 \\, \\text{Hartree}\n$$\n校正后的相互作用能为：\n$$\n\\Delta E_{\\text{corr}}(\\text{MP2}) = -152.064220 - (-76.028600 - 76.028320) = -152.064220 + 152.056920 = -0.007300 \\, \\text{Hartree}\n$$\n现在，我们计算被消除的过结合分数：\n$$\nF(\\text{MP2}) = \\frac{|-0.010700| - |-0.007300|}{|-0.010700|} = \\frac{0.010700 - 0.007300}{0.010700} = \\frac{0.003400}{0.010700} \\approx 0.317757\n$$\n四舍五入到四位有效数字，我们得到 $F(\\text{MP2}) = 0.3178$。\n\n其次，对于CCSD(T)/cc-pVDZ理论水平：\n给定的能量是：\n$E_{AB}^{AB} = -152.226100$\n$E_{A}^{A} = -76.108150$\n$E_{B}^{B} = -76.108150$\n$E_{A}^{AB} = -76.109300$\n$E_{B}^{AB} = -76.108900$\n\n未校正的相互作用能为：\n$$\n\\Delta E_{\\text{uncorr}}(\\text{CCSD(T)}) = -152.226100 - (-76.108150 - 76.108150) = -152.226100 + 152.216300 = -0.009800 \\, \\text{Hartree}\n$$\n校正后的相互作用能为：\n$$\n\\Delta E_{\\text{corr}}(\\text{CCSD(T)}) = -152.226100 - (-76.109300 - 76.108900) = -152.226100 + 152.218200 = -0.007900 \\, \\text{Hartree}\n$$\n现在，我们计算被消除的过结合分数：\n$$\nF(\\text{CCSD(T)}) = \\frac{|-0.009800| - |-0.007900|}{|-0.009800|} = \\frac{0.009800 - 0.007900}{0.009800} = \\frac{0.001900}{0.009800} \\approx 0.193877\n$$\n四舍五入到四位有效数字，我们得到 $F(\\text{CCSD(T)}) = 0.1939$。\n\n过结合消除分数的最终结果是，MP2为 $0.3178$，CCSD(T)为 $0.1939$。问题要求按 $(\\text{MP2}, \\text{CCSD(T)})$ 的顺序给出最终答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3178  0.1939\n\\end{pmatrix}\n}\n$$", "id": "2875497"}, {"introduction": "理论联系实际的最高境界是能够将计算流程自动化，以确保结果的可重复性。这个综合性练习要求你编写一个程序，该程序能根据给定的单体坐标和变换，自动生成计算衡态校正所需的所有输入文件，包括含“鬼原子”的单体计算 [@problem_id:2762232]。通过将衡态校正的整个过程程序化，你不仅能加深对该方法操作细节的理解，还能掌握在计算化学研究中建立稳健工作流程的关键技能。", "problem": "编写一个完整的程序，构建一个可复现的自动化工作流，用于计算使用鬼基函数的双体复合物的衡态校正相互作用能。程序必须：(i) 从给定的单体坐标和一个单体的刚性平移中，组装出可复现的单体和二聚体几何结构；(ii) 以明确定义的伪量子化学格式，为每种情况生成三个文本输入（完整的二聚体，单体A与鬼原子化的单体B，单体B与鬼原子化的单体A）；(iii) 从提供的总能量计算衡态校正的相互作用能。您的实现必须遵循原则，并基于电子结构理论的第一性原理。\n\n使用以下基本原理来启发和设计算法：\n- 在 Born–Oppenheimer 近似下，电子基态能量是通过在有限基表示上最小化 Rayleigh–Ritz 泛函得到的，这意味着由于变分原理，增加基组会单调地降低变分能量。\n- 当两个子系统结合在一起时，复合物的有限基组允许每个单体变分地“借用”以另一个单体为中心的函数，这被称为基组重叠误差（Basis Set Superposition Error, BSSE）。\n- 使用鬼基函数的衡态校正程序通过将基函数放置在不贡献电子和核吸引力的原子核（鬼原子）上，并在与二聚体几何结构中相同的核坐标处进行评估，从而形式化了“单体在二聚体基组中”的能量。\n\n您的程序应因此：\n- 为每个测试用例接受以埃（angstrom）为单位的单体 A 和单体 B 的笛卡尔坐标，以及应用于单体 B 以形成二聚体几何结构的刚性平移向量（无旋转）。所有原子坐标均为三维元组。还给出了每种物质的电荷和自旋多重度。\n- 生成三个文本输入（不写入磁盘；在内存中构造字符串即可）：\n    1. 完整的二聚体输入，包含在指定位置组合的两个单体的几何结构。\n    2. 在二聚体基组中的单体 A 输入，其中单体 B 作为鬼原子出现。\n    3. 在二聚体基组中的单体 B 输入，其中单体 A 作为鬼原子出现。\n  对每个生成的输入使用以下明确的伪格式：\n    - 第一行：文字文本 “molecule <name>”\n    - 第二行：“charge <q> mult <{m}> basis <label>”，其中基组标签是任意字符串。\n    - 后续行：每行一个原子，格式为“<symbol> <x> <y> <z>”，坐标单位为埃。鬼原子必须通过在其符号前加上文字“Gh:”来表示（例如，“Gh:O”）。\n- 对每个测试用例，使用每个案例提供的以下数据计算衡态校正的相互作用能：\n    - 完整二聚体基组中二聚体的总能量（单位：hartree）。\n    - 在二聚体基组中计算的单体 A 的总能量，其中单体 B 为鬼原子（单位：hartree）。\n    - 在二聚体基组中计算的单体 B 的总能量，其中单体 A 为鬼原子（单位：hartree）。\n- 使用精确因子 $2625.49962\\,\\mathrm{kJ\\,mol^{-1}\\,E_h^{-1}}$ 将最终的衡态校正相互作用能转换为千焦/摩尔，并四舍五入到三位小数。仅报告每个测试用例的衡态校正相互作用能。\n\n要实现的测试套件和参数：\n- 情况1（正常路径，氢键二聚体）：\n  - 单体 A（水）：原子坐标，单位为埃\n    - $\\mathrm{O}\\ (0.000000,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (0.957200,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (-0.239987,\\,0.927297,\\,0.000000)$\n  - 单体 B（水）：与上述坐标相同，B 的平移向量为 $(0.000000,\\,0.000000,\\,2.900000)$。\n  - 所有分子的电荷和多重度：$q=0$, $m=1$。\n  - 能量（单位：hartree）：\n    - 二聚体在二聚体基组中：$-152.792000$\n    - 单体 A 在二聚体基组中（B为鬼原子）：$-76.392345$\n    - 单体 B 在二聚体基组中（A为鬼原子）：$-76.391500$\n- 情况2（边界：大间距，极弱相互作用）：\n  - 单体 A（氖原子）：$\\mathrm{Ne}\\ (0.000000,\\,0.000000,\\,0.000000)$\n  - 单体 B（氖原子）：相同，B 的平移向量为 $(0.000000,\\,0.000000,\\,8.000000)$。\n  - 电荷和多重度：所有均为 $q=0$, $m=1$。\n  - 能量（单位：hartree）：\n    - 二聚体在二聚体基组中：$-257.094250$\n    - 单体 A 在二聚体基组中（B为鬼原子）：$-128.547100$\n    - 单体 B 在二聚体基组中（A为鬼原子）：$-128.547100$\n- 情况3（边缘：类似最小基组的强 BSSE 场景）：\n  - 单体 A（氨）：原子坐标，单位为埃\n    - $\\mathrm{N}\\ (0.000000,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (0.000000,\\,0.937700,\\,-0.381600)$\n    - $\\mathrm{H}\\ (-0.812100,\\,-0.468900,\\,-0.381600)$\n    - $\\mathrm{H}\\ (0.812100,\\,-0.468900,\\,-0.381600)$\n  - 单体 B（氨）：与上述坐标相同，B 的平移向量为 $(0.000000,\\,0.000000,\\,3.000000)$。\n  - 电荷和多重度：所有均为 $q=0$, $m=1$。\n  - 能量（单位：hartree）：\n    - 二聚体在二聚体基组中：$-112.485500$\n    - 单体 A 在二聚体基组中（B为鬼原子）：$-56.234000$\n    - 单体 B 在二聚体基组中（A为鬼原子）：$-56.233500$\n\n程序规范和输出格式：\n- 将上述测试套件硬编码在程序中；不要读取外部输入或写入文件。\n- 遵循上述伪格式和鬼原子化规则，实现确定性的几何结构组装和输入字符串生成，以确保可复现性。\n- 对每个测试用例，计算以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的衡态校正相互作用能，并保留三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如：“[$x_1,x_2,x_3$]”，其中每个 $x_i$ 是一个测试用例的四舍五入后的浮点数，单位为 $\\mathrm{kJ\\,mol^{-1}}$。", "solution": "设计思路从变分原理和基组受限能量的定义出发。在 Born–Oppenheimer 近似下，对于固定的核坐标，非相对论电子哈密顿算符 $\\hat{H}$ 的基态能量是 Rayleigh–Ritz 泛函 $E[\\Psi]=\\langle \\Psi \\vert \\hat{H} \\vert \\Psi \\rangle/\\langle \\Psi \\vert \\Psi \\rangle$ 在允许的波函数 $\\Psi$ 上的最小值。在有限基组表示中，随着基组 $\\mathcal{B}$ 的扩大，近似基态能量 $E^{\\mathcal{B}}$ 单调递减。对于两个子系统 A 和 B，基组叠加误差（BSSE）的产生是因为，在组合基组 $\\mathcal{B}_{AB}=\\mathcal{B}_A \\cup \\mathcal{B}_B$ 中计算二聚体能量时，可用于变分降低能量的空间比每个单体在其自身基组中的空间更大。如果通过减去在各自单体基组中获得的单体能量来形成相互作用能，结果会偏向于过度结合，因为二聚体得到了两个单体上基函数的“帮助”，而单体则没有。\n\n衡态校正的思想是用在二聚体几何结构下的“单体在二聚体基组中”的计算来取代单体计算：计算 $E_A^{AB}$，即仅包含 A 的电子和原子核的单体 A 的能量，但使用的是包含以 B 为中心的“鬼”函数的基组 $\\mathcal{B}_{AB}$，这些鬼函数不贡献电子，也没有核吸引力。类似地，计算 $E_B^{AB}$。这两者都在与二聚体几何结构中相同的核坐标处进行评估，以确保同类比较。将二聚体基组中的完整二聚体能量表示为 $E_{AB}^{AB}$，通过从二聚体能量中减去“单体在二聚体基组中”的能量，即可获得衡态校正的相互作用能。这源于相互作用能的定义，即在固定几何结构和相同变分空间内将 A 和 B 结合在一起时的能量变化；后一个要求通过对所有三种能量使用相同的基组 $\\mathcal{B}_{AB}$ 来强制执行。\n\n算法流程：\n1. 几何结构组装。我们得到单体 A 的笛卡尔坐标（埃）列表 $\\{(\\mathrm{sym}_i, x_i, y_i, z_i)\\}$ 和单体 B 的列表 $\\{(\\mathrm{sym}_j, x'_j, y'_j, z'_j)\\}$。为 B 提供了一个刚性平移向量 $\\mathbf{t}=(t_x,t_y,t_z)$。二聚体的几何结构是单体 A 的坐标与平移后的单体 B 的坐标 $\\{(\\mathrm{sym}_j, x'_j+t_x, y'_j+t_y, z'_j+t_z)\\}$ 的串联。该过程是确定性的，因此是可复现的。此问题不应用旋转，因此不需要角度。\n2. 输入生成。对于给定的基组标签（任意字符串）以及电荷 $q$ 和多重度 $m$，我们生成三个字符串：\n   - 二聚体 AB：标题行“molecule AB”、“charge $q$ mult $m$ basis <label>”，然后是所有二聚体原子，每个原子格式为“symbol x y z”。\n   - 二聚体基组中的单体 A：标题“molecule A_in_AB_basis”，相同的“charge $q$ mult $m$ basis <label>”，然后是 A 的原子作为真实原子，B 的原子前缀为“Gh:”表示鬼原子，使用与二聚体几何结构中相同的坐标。\n   - 二聚体基组中的单体 B：标题“molecule B_in_AB_basis”，反之亦然，B 是真实的，A 是鬼原子化的。\n   这复现了概念上的衡态校正输入：鬼原子提供基函数，但不提供电子或核吸引力。\n3. 能量计算。对于每种情况，我们都得到了三个以 hartree 为单位的标量能量：$E_{AB}^{AB}$、$E_{A}^{AB}$ 和 $E_{B}^{AB}$。以 hartree 为单位的衡态校正相互作用能为\n   $$\\Delta E_{\\mathrm{CP}} = E_{AB}^{AB} - (E_{A}^{AB} + E_{B}^{AB})$$\n   转换为千焦/摩尔使用因子 $f=2625.49962\\,\\mathrm{kJ\\,mol^{-1}\\,E_h^{-1}}$，得出\n   $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = f \\times \\Delta E_{\\mathrm{CP}}$$\n   然后我们四舍五入到三位小数。\n4. 确定性。由于组装是带有固定平移的纯粹串联，并且输入格式被明确指定（包括用于鬼原子的“Gh:”前缀），因此工作流是可复现的。不存在随机选择。\n\n将此应用于测试套件：\n- 情况 1（水二聚体）：\n  $$\\Delta E_{\\mathrm{CP}} = (-152.792000) - (-76.392345) - (-76.391500) = -0.008155\\ \\mathrm{E_h}$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.008155) \\approx -21.410949 \\ \\Rightarrow\\ \\text{四舍五入为 } -21.411$$\n- 情况 2（氖二聚体，大间距）：\n  $$\\Delta E_{\\mathrm{CP}} = (-257.094250) - (-128.547100) - (-128.547100) = -0.000050\\ \\mathrm{E_h}$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.000050) \\approx -0.131275 \\ \\Rightarrow\\ \\text{四舍五入为 } -0.131$$\n- 情况 3（氨二聚体，强 BSSE 类）：\n  $$\\Delta E_{\\mathrm{CP}} = (-112.485500) - (-56.234000) - (-56.233500) = -0.018000\\ \\mathrm{E_h}$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.018000) \\approx -47.258993 \\ \\Rightarrow\\ \\text{四舍五入为 } -47.259$$\n\n因此，程序应输出单行：\n$$[-21.411,-0.131,-47.259]$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Execution environment: Python 3.12, standard library only (numpy/scipy optional but not required).\n# This script constructs ghosted inputs and computes CP-corrected interaction energies for given test cases.\n\nHARTREE_TO_KJ_MOL = 2625.49962  # kJ/mol per Eh\n\nfrom dataclasses import dataclass\nfrom typing import List, Tuple\n\n@dataclass(frozen=True)\nclass Atom:\n    symbol: str\n    x: float\n    y: float\n    z: float\n\n@dataclass(frozen=True)\nclass Monomer:\n    label: str\n    charge: int\n    multiplicity: int\n    atoms: List[Atom]\n\n@dataclass(frozen=True)\nclass TestCase:\n    name: str\n    basis_label: str\n    monomer_A: Monomer\n    monomer_B: Monomer\n    translation_B: Tuple[float, float, float]  # translation applied to monomer B\n    E_AB_AB: float  # Hartree\n    E_A_AB: float   # Hartree (monomer A in dimer basis, B ghosted)\n    E_B_AB: float   # Hartree (monomer B in dimer basis, A ghosted)\n\ndef translate_atoms(atoms: List[Atom], t: Tuple[float, float, float]) -> List[Atom]:\n    tx, ty, tz = t\n    return [Atom(a.symbol, a.x + tx, a.y + ty, a.z + tz) for a in atoms]\n\ndef build_dimer_geometry(mA: Monomer, mB: Monomer, tB: Tuple[float, float, float]) -> List[Atom]:\n    # Deterministic concatenation: A atoms first, then translated B atoms\n    b_translated = translate_atoms(mB.atoms, tB)\n    return list(mA.atoms) + b_translated\n\ndef generate_input_string(name: str, charge: int, mult: int, basis: str, real_atoms: List[Atom], ghost_atoms: List[Atom]) -> str:\n    # Pseudo-format as specified\n    lines = []\n    lines.append(f\"molecule {name}\")\n    lines.append(f\"charge {charge} mult {mult} basis {basis}\")\n    for a in real_atoms:\n        lines.append(f\"{a.symbol} {a.x:.6f} {a.y:.6f} {a.z:.6f}\")\n    for g in ghost_atoms:\n        lines.append(f\"Gh:{g.symbol} {g.x:.6f} {g.y:.6f} {g.z:.6f}\")\n    return \"\\n\".join(lines)\n\ndef build_counterpoise_inputs(case: TestCase) -> Tuple[str, str, str]:\n    # Dimer geometry\n    dimer_atoms = build_dimer_geometry(case.monomer_A, case.monomer_B, case.translation_B)\n    # Split back to A (real) and B (translated) for ghost constructions\n    nA = len(case.monomer_A.atoms)\n    atoms_A_real = dimer_atoms[:nA]\n    atoms_B_real = dimer_atoms[nA:]\n    # Build three inputs\n    input_AB = generate_input_string(\n        name=\"AB\",\n        charge=case.monomer_A.charge + case.monomer_B.charge,\n        mult=case.monomer_A.multiplicity,  # both are singlets in test suite\n        basis=case.basis_label,\n        real_atoms=dimer_atoms,\n        ghost_atoms=[]\n    )\n    input_A_in_AB = generate_input_string(\n        name=\"A_in_AB_basis\",\n        charge=case.monomer_A.charge,\n        mult=case.monomer_A.multiplicity,\n        basis=case.basis_label,\n        real_atoms=atoms_A_real,\n        ghost_atoms=atoms_B_real\n    )\n    input_B_in_AB = generate_input_string(\n        name=\"B_in_AB_basis\",\n        charge=case.monomer_B.charge,\n        mult=case.monomer_B.multiplicity,\n        basis=case.basis_label,\n        real_atoms=atoms_B_real,\n        ghost_atoms=atoms_A_real\n    )\n    return input_AB, input_A_in_AB, input_B_in_AB\n\ndef delta_E_cp_kjmol(E_AB_AB: float, E_A_AB: float, E_B_AB: float) -> float:\n    delta_E_hartree = E_AB_AB - E_A_AB - E_B_AB\n    return delta_E_hartree * HARTREE_TO_KJ_MOL\n\ndef solve():\n    # Define monomer coordinates and test cases as specified\n    water_atoms = [\n        Atom(\"O\", 0.000000, 0.000000, 0.000000),\n        Atom(\"H\", 0.957200, 0.000000, 0.000000),\n        Atom(\"H\", -0.239987, 0.927297, 0.000000),\n    ]\n    neon_atoms = [Atom(\"Ne\", 0.000000, 0.000000, 0.000000)]\n    ammonia_atoms = [\n        Atom(\"N\", 0.000000, 0.000000, 0.000000),\n        Atom(\"H\", 0.000000, 0.937700, -0.381600),\n        Atom(\"H\", -0.812100, -0.468900, -0.381600),\n        Atom(\"H\", 0.812100, -0.468900, -0.381600),\n    ]\n\n    monomer_water = Monomer(\"H2O\", 0, 1, water_atoms)\n    monomer_neon = Monomer(\"Ne\", 0, 1, neon_atoms)\n    monomer_ammonia = Monomer(\"NH3\", 0, 1, ammonia_atoms)\n\n    test_cases = [\n        TestCase(\n            name=\"Water_dimer\",\n            basis_label=\"def2-SVP\",\n            monomer_A=monomer_water,\n            monomer_B=monomer_water,\n            translation_B=(0.000000, 0.000000, 2.900000),\n            E_AB_AB=-152.792000,\n            E_A_AB=-76.392345,\n            E_B_AB=-76.391500\n        ),\n        TestCase(\n            name=\"Neon_dimer_far\",\n            basis_label=\"def2-SVP\",\n            monomer_A=monomer_neon,\n            monomer_B=monomer_neon,\n            translation_B=(0.000000, 0.000000, 8.000000),\n            E_AB_AB=-257.094250,\n            E_A_AB=-128.547100,\n            E_B_AB=-128.547100\n        ),\n        TestCase(\n            name=\"Ammonia_dimer\",\n            basis_label=\"MIN\",\n            monomer_A=monomer_ammonia,\n            monomer_B=monomer_ammonia,\n            translation_B=(0.000000, 0.000000, 3.000000),\n            E_AB_AB=-112.485500,\n            E_A_AB=-56.234000,\n            E_B_AB=-56.233500\n        ),\n    ]\n\n    results = []\n    # Also build the ghosted inputs (not printed) to satisfy the workflow requirement\n    for case in test_cases:\n        _ab, _a_in_ab, _b_in_ab = build_counterpoise_inputs(case)\n        # In a real workflow, these strings would be written to files and submitted to a QC engine.\n        # Here, we only compute the CP-corrected interaction energy from provided totals.\n        value_kjmol = delta_E_cp_kjmol(case.E_AB_AB, case.E_A_AB, case.E_B_AB)\n        # Round to three decimals for output\n        results.append(f\"{value_kjmol:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2762232"}]}