{"hands_on_practices": [{"introduction": "本练习是一个基础性实践。我们将使用双中心哈伯德模型——理解电子关联的基石——来观察自旋投影的实际作用。通过显式计算并比较限制性哈特里-福克（RHF）、投影哈特里-福克（PHF）以及精确的完全组态相互作用（FCI）的能量，我们可以直接量化投影如何修正破缺对称性波函数中的自旋污染，并改善对键解离过程的描述 ([@problem_id:2925681])。", "problem": "考虑一个具有两个电子和两个正交归一的、位点定域空间轨道的对称双位点、半填充Hubbard模型。其电子哈密顿量为\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left( \\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta},\n$$\n其中 $t > 0$ 是最近邻跃迁积分，$U > 0$ 是在位库仑排斥，$\\hat{a}_{i\\sigma}^{\\dagger}$ 在位点 $i$ 上产生一个自旋为 $\\sigma$ 的电子，而 $\\hat{n}_{i\\sigma}=\\hat{a}_{i\\sigma}^{\\dagger}\\hat{a}_{i\\sigma}$。取 $t = 1.0 \\text{ eV}$ 和 $U = 6.0 \\text{ eV}$。\n\n仅从哈密顿量、Slater行列式、总自旋算符以及投影到总自旋 $S=0$ 上的自旋投影算符的基本定义出发，完成以下任务：\n\n1) 推导通过双占据由两个位点形成的成键分子轨道得到的顺磁性闭壳层限制性Hartree-Fock (RHF) 态的能量。将结果表示为 $t$ 和 $U$ 的函数，然后根据给定的数值进行计算。\n\n2) 考虑破缺对称性的非限制性Hartree-Fock (UHF) 行列式，其中一个自旋为 $\\alpha$ 的电子占据位点1，一个自旋为 $\\beta$ 的电子占据位点2，即行列式 $|\\Phi_{\\text{BS}}\\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}|0\\rangle$。使用自旋投影算符 $\\hat{\\mathcal{P}}_{S=0}$ 的定义，显式构造自旋投影的单重态波函数 $|\\Psi_{S=0}\\rangle \\propto \\hat{\\mathcal{P}}_{S=0}\\,|\\Phi_{\\text{BS}}\\rangle$，并计算其归一化的投影Hartree-Fock (PHF) 能量 $E_{\\text{PHF}} = \\langle \\Psi_{S=0} | \\hat{H} | \\Psi_{S=0} \\rangle$。对给定的 $t$ 和 $U$ 计算其值。\n\n3) 将哈密顿量写在最小单重态基组中，并解析地对角化该基组中的哈密顿矩阵，从而获取精确的单重态全组态相互作用 (FCI) 基态能量。将精确的单重态能量以 $t$ 和 $U$ 的函数形式写出闭合表达式，然后根据给定参数进行数值计算。\n\n最后，计算单值\n$$\n\\Delta \\;=\\; E_{\\text{PHF}} \\;-\\; E_{\\text{FCI}}\n$$\n，单位为电子伏特 (electronvolts)，并将您的答案四舍五入到四位有效数字。最终能量以 eV 表示。", "solution": "所述问题具有科学依据，提法恰当，并包含获得唯一解所需的所有信息。我们直接进行推导。双位点、双电子 Hubbard 模型的哈密顿量由下式给出\n$$ \\hat{H} = -t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left( \\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma} \\right) + U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta} $$\n其中 $t = 1.0 \\text{ eV}$ 且 $U = 6.0 \\text{ eV}$。\n\n第1部分：限制性Hartree-Fock (RHF) 能量\n\n首先，我们从位点定域轨道 $|1\\rangle$ 和 $|2\\rangle$ 定义分子轨道 (MO)。成键 ($|\\phi_b\\rangle$) 和反键 ($|\\phi_a\\rangle$) MO 分别是：\n$$ |\\phi_b\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle + |2\\rangle) $$\n$$ |\\phi_a\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |2\\rangle) $$\n哈密顿量的单电子部分，即跃迁项 $\\hat{T} = -t \\sum_{\\sigma} (\\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma})$，在位点基组中的矩阵元为 $h_{ij} = \\langle i | \\hat{h}_{core} | j \\rangle$，其中 $h_{11}=h_{22}=0$ 且 $h_{12}=h_{21}=-t$。成键MO的能量为 $h_{bb} = \\langle \\phi_b | \\hat{h}_{core} | \\phi_b \\rangle = \\frac{1}{2}(\\langle 1 | + \\langle 2 |) \\hat{h}_{core} (|1\\rangle + |2\\rangle) = \\frac{1}{2}(h_{11}+h_{12}+h_{21}+h_{22}) = \\frac{1}{2}(0 - t - t + 0) = -t$。\nRHF态 $|\\Phi_{\\text{RHF}}\\rangle$ 是通过双占据成键轨道 $|\\phi_b\\rangle$ 形成的。两个电子的单电子能量为 $2h_{bb} = -2t$。\n\n双电子能量是库仑排斥项 $\\hat{U}_{term} = U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta}$ 的期望值。\n在RHF近似中，在位点 $i$ 上找到一个自旋为 $\\alpha$ 的电子的概率与在同一位点上找到一个自旋为 $\\beta$ 的电子的概率是独立的。该概率由占据的MO $|\\phi_b\\rangle$ 中位点轨道 $|i\\rangle$ 的系数的平方给出。\n$$ \\langle \\hat{n}_{i\\alpha} \\rangle = |\\langle i | \\phi_b \\rangle|^2 = \\left|\\frac{1}{\\sqrt{2}}\\right|^2 = \\frac{1}{2} $$\n$$ \\langle \\hat{n}_{i\\beta} \\rangle = |\\langle i | \\phi_b \\rangle|^2 = \\frac{1}{2} $$\n在平均场近似下，双占据算符的期望值为 $\\langle \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta} \\rangle \\approx \\langle \\hat{n}_{i\\alpha} \\rangle \\langle \\hat{n}_{i\\beta} \\rangle = (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{4}$。\n那么总的双电子能量是 $U (\\langle \\hat{n}_{1\\alpha}\\hat{n}_{1\\beta} \\rangle + \\langle \\hat{n}_{2\\alpha}\\hat{n}_{2\\beta} \\rangle) = U (\\frac{1}{4} + \\frac{1}{4}) = \\frac{U}{2}$。\n总的RHF能量是单电子和双电子贡献之和：\n$$ E_{\\text{RHF}} = -2t + \\frac{U}{2} $$\n对于 $t=1.0 \\text{ eV}$ 和 $U=6.0 \\text{ eV}$，计算结果为 $E_{\\text{RHF}} = -2(1.0) + \\frac{6.0}{2} = -2.0 + 3.0 = 1.0 \\text{ eV}$。\n\n第2部分：投影Hartree-Fock (PHF) 能量\n\n破缺对称性的UHF行列式为 $|\\Phi_{\\text{BS}}\\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}|0\\rangle$。该状态具有 $M_S=0$，但它是单重态 ($S=0$) 和三重态 ($S=1$) 分量的混合态。我们必须投影掉三重态分量。在双电子体系中（其他可能性是 $S=1$），用于单重态 ($S=0$) 的自旋投影算符是：\n$$ \\hat{\\mathcal{P}}_{S=0} = \\prod_{K=1} \\frac{\\hat{S}^2 - K(K+1)}{0(0+1) - K(K+1)} = \\frac{\\hat{S}^2 - 1(2)}{0 - 2} = 1 - \\frac{1}{2}\\hat{S}^2 $$\n需要计算总自旋平方算符 $\\hat{S}^2$ 作用于 $|\\Phi_{\\text{BS}}\\rangle \\equiv |1\\alpha, 2\\beta\\rangle$ 的结果。\n$$ \\hat{S}^2 |1\\alpha, 2\\beta\\rangle = (\\hat{s}_1^2 + \\hat{s}_2^2 + 2\\hat{s}_1 \\cdot \\hat{s}_2)|1\\alpha, 2\\beta\\rangle = (\\frac{3}{4} + \\frac{3}{4} + 2\\hat{s}_{z1}\\hat{s}_{z2} + \\hat{s}_{1+}\\hat{s}_{2-} + \\hat{s}_{1-}\\hat{s}_{2+})|1\\alpha, 2\\beta\\rangle $$\n$$ \\hat{S}^2 |1\\alpha, 2\\beta\\rangle = (\\frac{3}{2} + 2(\\frac{1}{2})(-\\frac{1}{2}) + 0 + \\hat{s}_{1-}\\hat{s}_{2+}) |1\\alpha, 2\\beta\\rangle = |1\\alpha, 2\\beta\\rangle + |1\\beta, 2\\alpha\\rangle $$\n应用投影算符：\n$$ \\hat{\\mathcal{P}}_{S=0}|\\Phi_{\\text{BS}}\\rangle = \\left(1 - \\frac{1}{2}\\hat{S}^2\\right)|1\\alpha, 2\\beta\\rangle = |1\\alpha, 2\\beta\\rangle - \\frac{1}{2}(|1\\alpha, 2\\beta\\rangle + |1\\beta, 2\\alpha\\rangle) = \\frac{1}{2}(|1\\alpha, 2\\beta\\rangle - |1\\beta, 2\\alpha\\rangle) $$\n这个未归一化的状态的模方为 $\\langle \\dots | \\dots \\rangle = (\\frac{1}{2})^2 (1+1) = \\frac{1}{2}$。归一化后得到投影波函数：\n$$ |\\Psi_{S=0}\\rangle = \\frac{1}{\\sqrt{2}}(|1\\alpha, 2\\beta\\rangle - |1\\beta, 2\\alpha\\rangle) = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})|0\\rangle $$\n这就是纯共价的Heitler-London单重态。它的能量为 $E_{\\text{PHF}} = \\langle \\Psi_{S=0} | \\hat{H} | \\Psi_{S=0} \\rangle$。\n库仑项 $\\hat{U}_{term}$ 的期望值为零，因为该状态不包含两个电子在同一位点上的组态（没有双占据）：\n$$ \\langle \\Psi_{S=0} | \\hat{U}_{term} | \\Psi_{S=0} \\rangle = 0 $$\n跃迁项 $\\hat{T}$ 的期望值也为零。算符 $\\hat{T}$ 使一个电子跃迁，将一个共价组态（例如 $|1\\alpha, 2\\beta\\rangle$）变为一个离子组态（例如 $|2\\alpha, 2\\beta\\rangle$）。这些离子组态与共价态 $|\\Psi_{S=0}\\rangle$ 正交。形式上，$\\langle \\Psi_{S=0} | \\hat{T} | \\Psi_{S=0} \\rangle = 0$ 是因为 $\\hat{T}$ 只将共价子空间内的态与离子子空间内的态连接起来，使得矩阵元为零。\n因此，PHF能量为：\n$$ E_{\\text{PHF}} = 0 + 0 = 0 \\text{ eV} $$\n\n第3部分：全组态相互作用 (FCI) 能量\n\n对于最小单重态基组，我们考虑在哈密顿量作用下可以混合的两个态：共价单重态和对称离子单重态。\n$$ |\\Psi_1\\rangle = |\\Psi_{cov}\\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})|0 \\rangle $$\n$$ |\\Psi_2\\rangle = |\\Psi_{ion}\\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{1\\beta}^{\\dagger} + \\hat{a}_{2\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger})|0 \\rangle $$\n我们在此基组中构造 $2 \\times 2$ 的哈密顿矩阵 $\\mathbf{H}$。\n对角元 $H_{11} = \\langle \\Psi_{cov} | \\hat{H} | \\Psi_{cov} \\rangle$ 正是上面计算的PHF能量。因此，$H_{11} = 0$。\n对角元 $H_{22} = \\langle \\Psi_{ion} | \\hat{H} | \\Psi_{ion} \\rangle$。跃迁项 $\\hat{T}$ 对于 $|\\Psi_{ion}\\rangle$ 的期望值为零。库仑项对 $|\\Psi_{ion}\\rangle$ 的每个分量贡献 $U$，所以 $H_{22} = \\frac{1}{2}(U+U) = U$。\n非对角元 $H_{12} = \\langle \\Psi_{cov} | \\hat{H} | \\Psi_{ion} \\rangle$。$\\hat{U}_{term}$ 项没有贡献。我们需要计算 $\\langle \\Psi_{cov} | \\hat{T} | \\Psi_{ion} \\rangle$。\n$\\hat{T}$ 对离子分量的作用：\n$$ \\hat{T} \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{1\\beta}^{\\dagger}|0\\rangle = -t\\sqrt{2} |\\Psi_{cov}\\rangle $$\n$$ \\hat{T} \\hat{a}_{2\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}|0\\rangle = -t\\sqrt{2} |\\Psi_{cov}\\rangle $$\n所以，$\\hat{T} |\\Psi_{ion}\\rangle = \\frac{1}{\\sqrt{2}} (-t\\sqrt{2} |\\Psi_{cov}\\rangle -t\\sqrt{2} |\\Psi_{cov}\\rangle) = -2t |\\Psi_{cov}\\rangle$。\n因此，$H_{12} = \\langle \\Psi_{cov} | (-2t |\\Psi_{cov}\\rangle) = -2t$。由于 $\\hat{H}$ 是厄米算符，所以 $H_{21} = -2t$。\n哈密顿矩阵为：\n$$ \\mathbf{H} = \\begin{pmatrix} 0  -2t \\\\ -2t  U \\end{pmatrix} $$\n通过求解特征方程 $\\det(\\mathbf{H} - E\\mathbf{I})=0$ 来找到本征值：\n$$ (-E)(U-E) - (-2t)^2 = 0 \\implies E^2 - UE - 4t^2 = 0 $$\n解为 $E = \\frac{U \\pm \\sqrt{U^2 + 16t^2}}{2}$。\nFCI基态能量是较小的那个本征值：\n$$ E_{\\text{FCI}} = \\frac{U - \\sqrt{U^2 + 16t^2}}{2} $$\n对于 $t=1.0 \\text{ eV}$ 和 $U=6.0 \\text{ eV}$：\n$$ E_{\\text{FCI}} = \\frac{6.0 - \\sqrt{6.0^2 + 16(1.0)^2}}{2} = \\frac{6.0 - \\sqrt{52}}{2} = 3.0 - \\sqrt{13} \\approx -0.60555 \\text{ eV} $$\n\n最终计算\n\n所求的量是 $\\Delta = E_{\\text{PHF}} - E_{\\text{FCI}}$。\n$$ \\Delta = 0 - \\left(\\frac{U - \\sqrt{U^2 + 16t^2}}{2}\\right) = \\frac{\\sqrt{U^2 + 16t^2} - U}{2} $$\n代入数值：\n$$ \\Delta = \\frac{\\sqrt{52} - 6.0}{2} = \\sqrt{13} - 3.0 \\approx 3.605551275 - 3.0 = 0.605551275 \\text{ eV} $$\n四舍五入到四位有效数字得到 $\\Delta = 0.6056 \\text{ eV}$。", "answer": "$$\\boxed{0.6056}$$", "id": "2925681"}, {"introduction": "尽管自旋投影可以恢复一个关键的对称性，但它并非一个变分过程。本思想实验利用一个简单的 $2 \\times 2$ 矩阵模型，揭示了一个深刻的结论：消除自旋污染实际上可能会*增加*体系的总能量。这个练习阐明了在破缺对称性框架下最小化能量与强制实施正确自旋量子数之间的内在矛盾，这是量子化学中的一个核心概念挑战 ([@problem_id:2925724])。", "problem": "考虑一个最小双组态模型，旨在在近似的、对称性破缺的变分处理中捕捉自旋污染的本质及其通过自旋湮灭的消除过程。使用原子单位（哈特里）进行计算。设工作正交归一基为两个实组态，用列向量表示，其分量为在此基下的系数。\n\n1. 限制在该二维变分空间内的电子哈密顿量表示为\n$$\n\\mathbf{H} \\;=\\;\n\\begin{pmatrix}\n0  -v \\\\\n-v  \\Delta\n\\end{pmatrix},\n$$\n其中固定参数满足 $v > 0$ 和 $\\Delta > 0$。\n\n2. 限制在同一子空间内的总自旋平方算符表示为\n$$\n\\mathbf{S}^2 \\;=\\;\n\\begin{pmatrix}\n1  1 \\\\\n1  1\n\\end{pmatrix},\n$$\n在此子空间中，该算符的本征值为 $0$ 和 $2$，分别对应于类单重态和类三重态方向。\n\n一个不强制要求自旋纯度的对称性破缺变分过程，会选择与 $\\mathbf{H}$ 的最低本征值相关联的归一化本征向量 $|\\psi_{\\mathrm{var}}\\rangle$。对单重态的事后自旋湮灭通过应用作用于此子空间上的精确单重态投影算符 $\\mathbf{P}_0$ 来建模，得到（重新归一化的）态 $|\\psi_{\\mathrm{ann}}\\rangle \\propto \\mathbf{P}_0 |\\psi_{\\mathrm{var}}\\rangle$。湮灭态的能量则为瑞利商 $E_{\\mathrm{ann}}=\\langle \\psi_{\\mathrm{ann}}|\\mathbf{H}|\\psi_{\\mathrm{ann}}\\rangle$。\n\n任务：\n- 仅使用变分原理以及将投影算符定义为具有已知本征值的算符的多项式这一定义，从 $\\mathbf{S}^2$ 构建单重态投影算符 $\\mathbf{P}_0$，并确定此子空间中唯一的单重态方向。\n- 通过对角化 $\\mathbf{H}$ 确定最低变分能 $E_{\\mathrm{var}}$ 及其对应的归一化本征向量 $|\\psi_{\\mathrm{var}}\\rangle$。\n- 计算期望值 $\\langle \\psi_{\\mathrm{var}}|\\mathbf{S}^2|\\psi_{\\mathrm{var}}\\rangle$ 以量化对称性破缺变分态中的自旋污染程度，并在此模型内根据单重态/三重态权重对其进行解释。\n- 通过投影到单重态子空间并进行归一化，评估湮灭后的单重态能量 $E_{\\mathrm{ann}}$。\n- 最后，推导因湮灭导致的能量增加的闭式表达式，\n$$\n\\Delta E \\;=\\; E_{\\mathrm{ann}} - E_{\\mathrm{var}},\n$$\n作为 $v$ 和 $\\Delta$ 的函数。\n\n请以原子单位给出单一解析表达式 $\\Delta E(v,\\Delta)$ 作为您的最终答案。在最终的方框答案中请勿包含任何单位。无需四舍五入，请给出精确的闭式。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 一个由两个实组态构成的二维正交归一基。\n- 哈密顿量矩阵为 $\\mathbf{H} = \\begin{pmatrix} 0  -v \\\\ -v  \\Delta \\end{pmatrix}$，其中 $v > 0$ 且 $\\Delta > 0$。\n- 自旋平方算符矩阵为 $\\mathbf{S}^2 = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，其本征值为 $0$ 和 $2$。\n- 变分态 $|\\psi_{\\mathrm{var}}\\rangle$ 是 $\\mathbf{H}$ 最低本征值对应的归一化本征向量。\n- 湮灭态为 $|\\psi_{\\mathrm{ann}}\\rangle \\propto \\mathbf{P}_0 |\\psi_{\\mathrm{var}}\\rangle$，其中 $\\mathbf{P}_0$ 是单重态投影算符。\n- 湮灭能为 $E_{\\mathrm{ann}} = \\langle \\psi_{\\mathrm{ann}}|\\mathbf{H}|\\psi_{\\mathrm{ann}}\\rangle$。\n- 最终目标是求出 $\\Delta E = E_{\\mathrm{ann}} - E_{\\mathrm{var}}$。\n\n验证结论：\n该问题是量子力学中一个自洽的、数学上适定的练习，具体模拟了量子化学中的概念。该物理模型虽然经过简化，但具有科学依据，使用了量子算符的标准线性代数表示和变分原理。给定的矩阵和参数是一致的。给定的 $\\mathbf{S}^2$ 矩阵的本征值确实如陈述所述为 $0$ 和 $2$。各项任务定义清晰，能够导出一个唯一、可推导的解。因此，该问题被认定为 **有效**。\n\n解题过程遵循所列出的任务顺序。\n\n首先，我们构建单重态投影算符 $\\mathbf{P}_0$。作用于算符 $\\mathbf{A}$ 的本征值为 $\\lambda_k$ 的本征空间上的投影算符，可以构建为 $\\mathbf{A}$ 的一个多项式。对于具有本征值 $\\lambda_S=0$ 和 $\\lambda_T=2$ 的算符 $\\mathbf{S}^2$，到单重态空间（本征值为 $0$）上的投影算符为：\n$$\n\\mathbf{P}_0 = \\frac{\\mathbf{S}^2 - \\lambda_T \\mathbf{I}}{\\lambda_S - \\lambda_T} = \\frac{\\mathbf{S}^2 - 2\\mathbf{I}}{0 - 2} = \\mathbf{I} - \\frac{1}{2}\\mathbf{S}^2\n$$\n代入 $\\mathbf{S}^2$ 的矩阵：\n$$\n\\mathbf{P}_0 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1/2  -1/2 \\\\ -1/2  1/2 \\end{pmatrix}\n$$\n单重态方向是 $\\mathbf{S}^2$ 的零空间。设 $|S\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。则 $\\mathbf{S}^2 |S\\rangle = 0$ 意味着 $c_1+c_2=0$。归一化的单重态是 $|S\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。该投影算符确实是 $\\mathbf{P}_0 = |S\\rangle\\langle S|$。\n\n接下来，我们求解变分能 $E_{\\mathrm{var}}$ 和变分态 $|\\psi_{\\mathrm{var}}\\rangle$。这需要对角化哈密顿量 $\\mathbf{H}$。特征方程为 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$。\n$$\n\\det\\begin{pmatrix} -E  -v \\\\ -v  \\Delta - E \\end{pmatrix} = (-E)(\\Delta - E) - v^2 = E^2 - \\Delta E - v^2 = 0\n$$\nE 的解由求根公式给出：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n最低的本征值即为变分能 $E_{\\mathrm{var}}$：\n$$\nE_{\\mathrm{var}} = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n为了求出对应的本征向量 $|\\psi_{\\mathrm{var}}\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$，我们求解 $(\\mathbf{H} - E_{\\mathrm{var}}\\mathbf{I})|\\psi_{\\mathrm{var}}\\rangle = 0$。该矩阵方程的第一个分量是 $-E_{\\mathrm{var}}c_1 - vc_2 = 0$，这意味着比率 $c_2/c_1 = -E_{\\mathrm{var}}/v$。归一化的本征向量可以写作：\n$$\n|\\psi_{\\mathrm{var}}\\rangle = \\frac{1}{\\sqrt{v^2 + E_{\\mathrm{var}}^2}} \\begin{pmatrix} v \\\\ -E_{\\mathrm{var}} \\end{pmatrix}\n$$\n\n接下来，我们计算自旋污染，即 $\\langle \\mathbf{S}^2 \\rangle = \\langle \\psi_{\\mathrm{var}}|\\mathbf{S}^2|\\psi_{\\mathrm{var}}\\rangle$。\n$$\n\\langle \\mathbf{S}^2 \\rangle = \\frac{1}{v^2 + E_{\\mathrm{var}}^2} \\begin{pmatrix} v  -E_{\\mathrm{var}} \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} v \\\\ -E_{\\mathrm{var}} \\end{pmatrix} = \\frac{1}{v^2 + E_{\\mathrm{var}}^2} (v-E_{\\mathrm{var}})^2\n$$\n根据特征方程，有 $E_{\\mathrm{var}}^2 = \\Delta E_{\\mathrm{var}} + v^2$。设 $R = \\sqrt{\\Delta^2+4v^2}$，则 $E_{\\mathrm{var}} = (\\Delta - R)/2$。分母变为 $v^2+E_{\\mathrm{var}}^2 = v^2 + \\Delta E_{\\mathrm{var}} + v^2 = 2v^2 + \\Delta E_{\\mathrm{var}}$。分子为 $(v-E_{\\mathrm{var}})^2=v^2-2vE_{\\mathrm{var}}+E_{\\mathrm{var}}^2 = v^2-2vE_{\\mathrm{var}} + \\Delta E_{\\mathrm{var}} + v^2 = 2v^2 + (\\Delta-2v)E_{\\mathrm{var}}$。表达式变得很繁琐。\n一个更简洁的方法是将态参数化为 $|\\psi_{\\mathrm{var}}\\rangle = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$。最小化能量泛函 $E(\\theta) = \\langle \\psi_{\\mathrm{var}}|\\mathbf{H}|\\psi_{\\mathrm{var}}\\rangle = -2v\\cos\\theta\\sin\\theta + \\Delta\\sin^2\\theta$ 可得 $\\tan(2\\theta) = 2v/\\Delta$。由于 $v > 0, \\Delta > 0$，我们有 $0  2\\theta  \\pi/2$，这意味着 $\\cos\\theta  \\sin\\theta  0$。由此我们得到 $\\sin(2\\theta) = \\frac{2v}{\\sqrt{\\Delta^2+4v^2}}$。\n那么自旋污染为：\n$$\n\\langle \\mathbf{S}^2 \\rangle = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = (\\cos\\theta+\\sin\\theta)^2 = 1+2\\sin\\theta\\cos\\theta = 1+\\sin(2\\theta)\n$$\n$$\n\\langle \\mathbf{S}^2 \\rangle = 1 + \\frac{2v}{\\sqrt{\\Delta^2+4v^2}}\n$$\n由于 $\\mathbf{S}^2$ 的本征值为 $0$ 和 $2$，我们可以将其解释为 $\\langle \\mathbf{S}^2 \\rangle = W_S \\cdot 0 + W_T \\cdot 2 = 2W_T$，其中 $W_T$ 是三重态权重。因此 $W_T = \\frac{1}{2} + \\frac{v}{\\sqrt{\\Delta^2+4v^2}}$。由于 $v0$，所以 $W_T1/2$，因此该态具有显著的三重态特征（污染）。\n\n接下来，我们计算湮灭能 $E_{\\mathrm{ann}}$。自旋湮灭态 $|\\psi_{\\mathrm{ann}}\\rangle$ 通过将 $|\\psi_{\\mathrm{var}}\\rangle$ 投影到单重态空间并重新归一化得到：$|\\psi_{\\mathrm{ann}}\\rangle \\propto \\mathbf{P}_0|\\psi_{\\mathrm{var}}\\rangle$。\n$$\n\\mathbf{P}_0|\\psi_{\\mathrm{var}}\\rangle = \\frac{1}{2}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\frac{\\cos\\theta-\\sin\\theta}{2}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n由于 $0  \\theta  \\pi/4$，有 $\\cos\\theta  \\sin\\theta$，所以前置因子为正。其方向就是纯单重态 $|S\\rangle$ 的方向。归一化后，湮灭态正是单重态：\n$$\n|\\psi_{\\mathrm{ann}}\\rangle = |S\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n这是良定的，因为对于 $\\Delta  0$，$|\\psi_{\\mathrm{var}}\\rangle$ 的单重态权重 $W_S = 1-W_T = \\frac{1}{2} - \\frac{v}{\\sqrt{\\Delta^2+4v^2}}$ 非零。\n这个湮灭态的能量是 $E_{\\mathrm{ann}} = \\langle \\psi_{\\mathrm{ann}}|\\mathbf{H}|\\psi_{\\mathrm{ann}}\\rangle = \\langle S|\\mathbf{H}|S\\rangle$。\n$$\nE_{\\mathrm{ann}} = \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  -1 \\end{pmatrix}\\right) \\begin{pmatrix} 0  -v \\\\ -v  \\Delta \\end{pmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) = \\frac{1}{2}\\begin{pmatrix} 1  -1 \\end{pmatrix}\\begin{pmatrix} v \\\\ -v-\\Delta \\end{pmatrix} = \\frac{1}{2}(v - (-v-\\Delta)) = \\frac{2v+\\Delta}{2}\n$$\n$$\nE_{\\mathrm{ann}} = v + \\frac{\\Delta}{2}\n$$\n\n最后，我们计算因湮灭导致的能量增加，$\\Delta E = E_{\\mathrm{ann}} - E_{\\mathrm{var}}$。\n$$\n\\Delta E = \\left(v + \\frac{\\Delta}{2}\\right) - \\left(\\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\\right) = v + \\frac{\\Delta}{2} - \\frac{\\Delta}{2} + \\frac{\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\Delta E = v + \\frac{\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n这就得到了能量变化作为 $v$ 和 $\\Delta$ 函数的闭式表达式。正如变分原理所预期的，$\\Delta E \\ge 0$。", "answer": "$$\n\\boxed{v + \\frac{\\sqrt{\\Delta^2 + 4v^2}}{2}}\n$$", "id": "2925724"}, {"introduction": "任何可靠的电子结构方法都应具备一个理想特性——尺度延展性，即$N$个无相互作用体系的总能量应等于单个体系能量的$N$倍。这项高级实践旨在探究投影哈特里-福克方法是否满足此标准。通过模拟一个由无相互作用的氢分子组成的链条，你将通过解析推导和编程计算来证明PHF存在尺度延展性误差，这是该方法应用于更大体系时的一个关键限制 ([@problem_id:2925756])。", "problem": "考虑一个由$n$个无相互作用的氢分子$\\mathrm{H}_2$组成的线性链，每个分子由一个单独的形变共线非限制行列式$\\lvert \\Phi \\rangle$描述，该行列式在长键长下会破坏自旋对称性。我们使用投影Hartree–Fock (PHF) 方法研究乘积态的自旋单重态投影，此处PHF指变分后进行自旋投影。目标是通过分析投影能量如何随$n$标度，来量化PHF方法对于$n$-片段乘积的尺度广延性误差。\n\n使用以下第一性原理基础和定义：\n\n- 投影到自旋$S=0$的总自旋投影算符为\n$$\n\\hat{P}^{S=0} = \\frac{1}{8\\pi^2} \\int d\\Omega \\, \\hat{R}(\\Omega),\n$$\n其中$\\hat{R}(\\Omega)$是由欧拉角$\\Omega$参数化的自旋旋转算符，$d\\Omega$是$\\mathrm{SU}(2)$上的哈尔测度。对于共线行列式和单重态投影，该积分简化为单个极角$\\beta \\in [0,\\pi]$上的积分，其测度为$w(\\beta)\\,d\\beta = \\tfrac{1}{2}\\sin\\beta\\,d\\beta$。\n\n- 对于单个形变片段，定义重叠核\n$$\nk(\\beta) = \\langle \\Phi \\lvert \\hat{R}(\\beta) \\rvert \\Phi \\rangle,\n$$\n以及对于一个无自旋的单体和双体哈密顿量$\\hat{h}$的哈密顿核，\n$$\n\\varepsilon(\\beta) = \\langle \\Phi \\lvert \\hat{h}\\, \\hat{R}(\\beta) \\rvert \\Phi \\rangle.\n$$\n为方便起见，通过$\\varepsilon(\\beta) = e(\\beta)\\,k(\\beta)$引入约化能量核$e(\\beta)$。\n\n- 对于$n$个无相互作用的相同片段，哈密顿量为$\\hat{H} = \\sum_{i=1}^{n} \\hat{h}^{(i)}$，乘积态为$\\lvert \\Phi^{(n)} \\rangle = \\bigotimes_{i=1}^{n} \\lvert \\Phi \\rangle$。总自旋$S=0$的投影能量为\n$$\nE_n = \\frac{ \\langle \\Phi^{(n)} \\lvert \\hat{H}\\, \\hat{P}^{S=0} \\rvert \\Phi^{(n)} \\rangle }{ \\langle \\Phi^{(n)} \\lvert \\hat{P}^{S=0} \\rvert \\Phi^{(n)} \\rangle }.\n$$\n利用无相互作用片段的核的因子分解特性以及$\\hat{H}$与自旋旋转的对易关系，可以得到积分表示\n$$\nE_n = \\frac{ n \\int_{0}^{\\pi} w(\\beta)\\, e(\\beta)\\, k(\\beta)^n \\, d\\beta }{ \\int_{0}^{\\pi} w(\\beta)\\, k(\\beta)^n \\, d\\beta }.\n$$\n\n为了在保持物理不变性的同时使问题具体化，考虑最小的旋转不变参数化\n$$\nt \\equiv \\sin^2\\left(\\frac{\\beta}{2}\\right) \\in [0,1], \\quad w(\\beta)\\,d\\beta = dt,\n$$\n并选择\n$$\nk(t; p) = 1 - p\\, t, \\qquad e(t; E_0, a) = E_0 + a\\, t,\n$$\n其中$p \\in [0,1)$量化了形变行列式的自旋极化程度（$p=0$对应于自旋纯的参考态），$(E_0,a)$是实数参数（单位为哈特里），描述了约化能量核到旋转不变量$t$的一阶项。在此模型中，对于每个片段，投影能量简化为在单位区间上以$k(t)^m$为权重的平均值，其中$m$为非负整数。\n\n将尺度广延性误差定义为\n$$\n\\Delta_n \\equiv E_n - n E_1.\n$$\n\n任务：\n\n1) 从上述定义和无相互作用片段的假设出发，推导$E_n$和$E_1$的表达式，使其只包含关于$t \\in [0,1]$且涉及$k(t)$和$e(t)$的积分。\n\n2) 证明在使用给定的参数化$\\varepsilon(t) = e(t) k(t)$时，可以写出\n$$\nE_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right],\n$$\n并因此得到\n$$\n\\Delta_n = n a \\left( \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } - \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right).\n$$\n\n3) 对\n$$\nk(t) = 1 - p t, \\quad p \\in [0,1),\n$$\n解析地计算积分，即推导对整数$m \\ge 0$有效的闭式表达式\n$$\nD_m(p) \\equiv \\int_{0}^{1} (1 - p t)^m \\, dt, \\qquad T_m(p) \\equiv \\int_{0}^{1} t (1 - p t)^m \\, dt,\n$$\n然后将误差表示为\n$$\n\\Delta_n = n a \\left( \\frac{T_n(p)}{D_n(p)} - \\frac{T_1(p)}{D_1(p)} \\right).\n$$\n所有能量单位均为哈特里。通过对你的闭式表达式取适当的极限来处理$p=0$的极限情况。\n\n4) 实现一个程序，仅使用本问题中推导出的公式，为以下参数集$(n,p,E_0,a)$的测试套件计算$\\Delta_n$：\n- $(1,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(5,\\, 0.0,\\, -1.0,\\, 0.2)$,\n- $(4,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(50,\\, 0.6,\\, -1.0,\\, 0.2)$,\n- $(10,\\, 0.95,\\, -1.0,\\, 0.5)$。\n以浮点数列表的形式返回$\\Delta_n$的值。所有能量必须以哈特里为单位计算，因此你的输出值代表哈特里。不要打印输出单位；只返回数值。\n\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[x1,x2,x3,x4,x5]\"）。", "solution": "所述问题是有效的。这是一个在量子化学领域中定义明确的理论练习，它使用一个简化的、但有物理动机的模型，在投影Hartree-Fock理论的背景下探讨了尺度广延性误差的概念。所有定义、参数和目标都以足够的清晰度和严谨性进行了规定，从而能够得出一个唯一的解析解和计算解。我们按要求进行推导。\n\n推导过程根据问题陈述中列出的任务分段进行。\n\n**任务1：$E_n$和$E_1$的表达式**\n\n问题给出了$n$个无相互作用片段的投影能量的一般积分表示：\n$$\nE_n = \\frac{ n \\int_{0}^{\\pi} w(\\beta)\\, e(\\beta)\\, k(\\beta)^n \\, d\\beta }{ \\int_{0}^{\\pi} w(\\beta)\\, k(\\beta)^n \\, d\\beta }\n$$\n给定坐标变换$t = \\sin^2(\\beta/2)$，这意味着$dt = \\frac{1}{2} (2\\sin(\\beta/2)\\cos(\\beta/2)) d\\beta = \\frac{1}{2}\\sin\\beta d\\beta$。这恰好是给定的积分测度$w(\\beta)d\\beta$。积分限$\\beta \\in [0, \\pi]$对应于$t \\in [0, 1]$。\n\n通过将变量变换直接代入$E_n$的表达式，我们得到了以$t$的积分为形式的表达式：\n$$\nE_n = \\frac{ n \\int_{0}^{1} e(t) k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\n$E_1$的表达式通过在上述公式中令$n=1$得到：\n$$\nE_1 = \\frac{ 1 \\int_{0}^{1} e(t) k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt }\n$$\n至此完成第一个任务。\n\n**任务2：$E_n$和$\\Delta_n$表达式的推导**\n\n我们已知参数化$e(t) = E_0 + a t$以及$\\varepsilon(t) = e(t)k(t)$。出发点是任务1中推导出的$E_n$表达式。我们代入$e(t)$的线性模型：\n$$\nE_n = \\frac{ n \\int_{0}^{1} (E_0 + a t) k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\n根据积分的线性性质，我们可以分离分子：\n$$\nE_n = \\frac{ n \\left( \\int_{0}^{1} E_0 k(t)^n \\, dt + \\int_{0}^{1} a t k(t)^n \\, dt \\right) }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\n由于$E_0$和$a$是常数，它们可以从积分中提出：\n$$\nE_n = \\frac{ n \\left( E_0 \\int_{0}^{1} k(t)^n \\, dt + a \\int_{0}^{1} t k(t)^n \\, dt \\right) }{ \\int_{0}^{1} k(t)^n \\, dt }\n$$\n将分母分配给分子中的每一项，得到：\n$$\nE_n = n \\left( E_0 \\frac{ \\int_{0}^{1} k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } + a \\frac{ \\int_{0}^{1} t k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right)\n$$\n这简化为所要求的表达式：\n$$\nE_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right]\n$$\n现在，我们推导尺度广延性误差的表达式，$\\Delta_n \\equiv E_n - n E_1$。使用上述关于$E_n$和$E_1$（通过令$n=1$）的结果：\n$$\nE_1 = 1 \\cdot \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right]\n$$\n那么，误差$\\Delta_n$为：\n$$\n\\Delta_n = n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } \\right] - n \\left[ E_0 + a \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right]\n$$\n包含$nE_0$的项相互抵消：\n$$\n\\Delta_n = n a \\left( \\frac{ \\int_{0}^{1} t \\, k(t)^n \\, dt }{ \\int_{0}^{1} k(t)^n \\, dt } - \\frac{ \\int_{0}^{1} t \\, k(t)^1 \\, dt }{ \\int_{0}^{1} k(t)^1 \\, dt } \\right)\n$$\n这证实了第二个所要求的表达式。\n\n**任务3：积分的解析计算与$\\Delta_n$的最终表达式**\n\n我们必须为$k(t) = 1 - p t$（其中$p \\in [0, 1)$且$m \\ge 0$为整数）计算积分$D_m(p)$和$T_m(p)$。\n\n首先，考虑积分$D_m(p)$：\n$$\nD_m(p) = \\int_{0}^{1} (1 - p t)^m \\, dt\n$$\n如果$p=0$，被积函数为$1^m=1$，所以$D_m(0) = \\int_{0}^{1} 1 \\, dt = 1$。\n如果$p \\neq 0$，我们使用换元法，令$u = 1 - p t$，得到$du = -p \\, dt$。积分限从$t=0,1$变为$u=1, 1-p$。\n$$\nD_m(p) = \\int_{1}^{1-p} u^m \\left(-\\frac{du}{p}\\right) = \\frac{1}{p} \\int_{1-p}^{1} u^m \\, du = \\frac{1}{p} \\left[ \\frac{u^{m+1}}{m+1} \\right]_{1-p}^{1}\n$$\n$$\nD_m(p) = \\frac{1}{p(m+1)} \\left( 1^{m+1} - (1-p)^{m+1} \\right) = \\frac{1 - (1-p)^{m+1}}{p(m+1)}\n$$\n对于$p \\neq 0$的这个闭式表达式，当$p \\to 0$时正确地趋近于$1$，这可以通过使用L'Hôpital法则来验证。\n\n接下来，我们计算积分$T_m(p)$：\n$$\nT_m(p) = \\int_{0}^{1} t (1 - p t)^m \\, dt\n$$\n如果$p=0$，积分变为$T_m(0) = \\int_{0}^{1} t \\, dt = 1/2$。\n如果$p \\neq 0$，我们使用换元法，令$u = 1 - pt$，这意味着$t = (1-u)/p$且$dt = -du/p$。\n$$\nT_m(p) = \\int_{1}^{1-p} \\frac{1-u}{p} u^m \\left(-\\frac{du}{p}\\right) = \\frac{1}{p^2} \\int_{1-p}^{1} (u^m - u^{m+1}) \\, du\n$$\n$$\nT_m(p) = \\frac{1}{p^2} \\left[ \\frac{u^{m+1}}{m+1} - \\frac{u^{m+2}}{m+2} \\right]_{1-p}^{1}\n$$\n$$\nT_m(p) = \\frac{1}{p^2} \\left[ \\left(\\frac{1}{m+1} - \\frac{1}{m+2}\\right) - \\left(\\frac{(1-p)^{m+1}}{m+1} - \\frac{(1-p)^{m+2}}{m+2}\\right) \\right]\n$$\n通过通分公分母$(m+1)(m+2)$来简化表达式：\n$$\nT_m(p) = \\frac{1}{p^2(m+1)(m+2)} \\left[ 1 - \\left( (m+2)(1-p)^{m+1} - (m+1)(1-p)^{m+2} \\right) \\right]\n$$\n提出因子$(1-p)^{m+1}$：\n$$\nT_m(p) = \\frac{1 - (1-p)^{m+1} (1 + p(m+1))}{p^2(m+1)(m+2)}\n$$\n当$p \\to 0$时，此形式正确地得到极限$1/2$，与我们的直接计算一致。\n\n使用这些定义，尺度广延性误差$\\Delta_n$表示为：\n$$\n\\Delta_n = n a \\left( \\frac{T_n(p)}{D_n(p)} - \\frac{T_1(p)}{D_1(p)} \\right)\n$$\n至此解析推导完成。接下来的任务是数值实现。", "answer": "```python\nimport numpy as np\n\ndef D_m(m: int, p: float) -> float:\n    \"\"\"\n    Computes the integral D_m(p) = integral from 0 to 1 of (1 - p*t)^m dt.\n    \"\"\"\n    if abs(p)  1e-12:\n        return 1.0\n    \n    m_plus_1 = float(m + 1)\n    return (1.0 - (1.0 - p)**m_plus_1) / (p * m_plus_1)\n\ndef T_m(m: int, p: float) -> float:\n    \"\"\"\n    Computes the integral T_m(p) = integral from 0 to 1 of t*(1 - p*t)^m dt.\n    \"\"\"\n    if abs(p)  1e-12:\n        return 0.5\n    \n    m_plus_1 = float(m + 1)\n    m_plus_2 = float(m + 2)\n    \n    numerator = 1.0 - (1.0 - p)**m_plus_1 * (1.0 + p * m_plus_1)\n    denominator = p**2 * m_plus_1 * m_plus_2\n    \n    return numerator / denominator\n\ndef calculate_delta_n(n: int, p: float, a: float) -> float:\n    \"\"\"\n    Calculates the size-extensivity error Delta_n based on the derived formulas.\n    The error is defined as Delta_n = E_n - n * E_1.\n    \"\"\"\n    if n == 1 or abs(p)  1e-12:\n        return 0.0\n\n    term_n = T_m(n, p) / D_m(n, p)\n    term_1 = T_m(1, p) / D_m(1, p)\n    \n    delta_n = float(n) * a * (term_n - term_1)\n    return delta_n\n\ndef solve_and_get_results_string():\n    \"\"\"\n    Solves the problem for the given test suite and returns the formatted output string.\n    \"\"\"\n    test_cases = [\n        (1, 0.6, -1.0, 0.2),\n        (5, 0.0, -1.0, 0.2),\n        (4, 0.6, -1.0, 0.2),\n        (50, 0.6, -1.0, 0.2),\n        (10, 0.95, -1.0, 0.5)\n    ]\n    \n    results = []\n    for n, p, E0, a in test_cases:\n        error = calculate_delta_n(n, p, a)\n        results.append(error)\n\n    # Format the output as a string list of floats.\n    return \"[\" + \",\".join(map(str, results)) + \"]\"\n\n# This block will not be executed when the platform grades the code,\n# but it is included for completeness and to demonstrate how to produce the final string.\nif __name__ == '__main__':\n    # The problem asks for the program to generate the output, so we print the result.\n    print(solve_and_get_results_string())\n\n```", "id": "2925756"}]}