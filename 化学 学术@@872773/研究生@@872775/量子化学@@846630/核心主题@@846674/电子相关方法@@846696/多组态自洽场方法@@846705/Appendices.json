{"hands_on_practices": [{"introduction": "MCSCF 波函数是由组态态函数 (Configuration State Functions, CSFs) 的线性组合所构建的，这些函数是具有明确自旋性质的基函数。在进行 MCSCF 计算之前，理解这些基本构造单元的构成至关重要。这项基础练习 ([@problem_id:2906845]) 将引导您从第一性原理出发，为最小但至关重要的双电子、双轨道 (2e, 2o) 活性空间构建完整的自旋匹配 CSFs 集合。", "problem": "在多组态自洽场框架中，一个自旋匹配的组态态函数（CSF）是一个多电子基函数，它既是总自旋平方算符 $\\hat{S}^{2}$ 的本征函数，也是其 $z$-分量 $\\hat{S}_{z}$ 的本征函数。考虑一个包含 $2$ 个空间轨道（标记为 $\\phi_{1}$ 和 $\\phi_{2}$）并被 $2$ 个电子占据的活性空间。设相关的自旋轨道表示为 $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$，其中 $1$ 和 $2$ 标记空间部分 $\\phi_{1}$ 和 $\\phi_{2}$，而 $\\alpha, \\beta$ 分别表示自旋向上和自旋向下的旋量。\n\n在由占据 $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$ 中任意两个不同自旋轨道构成的 $2$ 电子 Slater 行列式基中进行计算。采用以下特定的有序行列式基：\n$$\n\\big\\{|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\big\\}.\n$$\n仅使用费米子反对称性的基本要求、Slater 行列式的定义以及两个自旋-$\\tfrac{1}{2}$ 粒子的角动量耦合（通过标准的 Clebsch–Gordan 系数），为此活性空间构建完整的归一化自旋匹配 CSF 集合。识别哪些 CSF 是单重态（$S=0$；具体给出 $M_{S}=0$ 的形式），哪些是三重态（$S=1$；给出 $M_{S}=+1,0,-1$ 的形式），并将每个 CSF 明确地表示为上述有序基中行列式的线性组合，具有精确的归一化和相位。\n\n答案规格：\n- 将您的最终结果表示为单个 $6\\times 6$ 的系数矩阵，该矩阵将上述有序行列式基（列）映射到您构建的有序 CSF 基（行）。\n- CSF 行的排序如下：首先是双占据 $\\phi_{1}$ 和 $\\phi_{2}$ 的两个闭壳层单重态（按此顺序），然后是每个空间轨道中有一个电子的开壳层单重态（$M_{S}=0$），接着是 $M_{S}=+1$ 的三重态、$M_{S}=0$ 的三重态和 $M_{S}=-1$ 的三重态。\n- 不要四舍五入；所有系数均保持精确形式。\n- 仅提供该矩阵作为您的最终答案，使用标准的线性代数表示法。", "solution": "目标是为一个 $2$ 电子、$2$ 轨道的活性空间构建自旋匹配的组态态函数（CSF），这些函数同时是 $\\hat{S}^{2}$ 和 $\\hat{S}_{z}$ 的本征函数，并遵守费米子反对称性。我们从以下基本事实开始：\n- 由标准正交自旋轨道构成的 Slater 行列式是一个反对称的 $N$ 电子波函数。\n- 两个电子的总自旋算符为 $\\hat{\\boldsymbol{S}}=\\hat{\\boldsymbol{s}}_{1}+\\hat{\\boldsymbol{s}}_{2}$，其中 $\\hat{S}^{2}=\\hat{s}_{1}^{2}+\\hat{s}_{2}^{2}+2\\,\\hat{\\boldsymbol{s}}_{1}\\cdot\\hat{\\boldsymbol{s}}_{2}$。\n- 对于两个自旋-$\\tfrac{1}{2}$ 粒子，耦合的自旋本征态为一个 $S=1$ 的三重态（三个 $M_{S}$ 值）和一个 $S=0$ 的单重态（一个 $M_{S}=0$ 态）。Clebsch–Gordan 系数得出\n$$\n\\begin{aligned}\n\\text{三重态 }(S=1):\\quad\n\\big|1,1\\big\\rangle=\\big|\\alpha\\alpha\\big\\rangle,\\quad\n\\big|1,0\\big\\rangle=\\frac{1}{\\sqrt{2}}\\big(\\big|\\alpha\\beta\\big\\rangle+\\big|\\beta\\alpha\\big\\rangle\\big),\\quad\n\\big|1,-1\\big\\rangle=\\big|\\beta\\beta\\big\\rangle,\\\\\n\\text{单重态 }(S=0):\\quad\n\\big|0,0\\big\\rangle=\\frac{1}{\\sqrt{2}}\\big(\\big|\\alpha\\beta\\big\\rangle-\\big|\\beta\\alpha\\big\\rangle\\big).\n\\end{aligned}\n$$\n\n我们使用空间轨道 $\\phi_{1}$ 和 $\\phi_{2}$ 及相关的自旋轨道 $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$。由此集合构建的 $2$ 电子 Slater 行列式是通过选择任意两个不同自旋轨道得到的 $6$ 个行列式。我们采用以下有序行列式基：\n$$\n\\big\\{|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\big\\}.\n$$\n\n现在我们构建 CSF。一个 CSF 是行列式的线性组合，它具有确定的 $S$ 值，是 $\\hat{S}^{2}$ 的本征函数；同时具有确定的 $M_{S}$ 值，是 $\\hat{S}_{z}$ 的本征函数。自旋的耦合完全由自旋部分决定，而空间占据则决定了哪些行列式可以对给定的 CSF 有贡献。\n\n$1.$ 双占据的闭壳层单重态：\n- 当两个电子以相反自旋占据同一个空间轨道时，该行列式具有的自旋函数本质上是该轨道的反对称对，并且它是 $\\hat{S}^{2}$ 的本征函数，其 $S=0$。因此，行列式\n$$\n|1\\alpha\\,1\\beta\\rangle,\\qquad |2\\alpha\\,2\\beta\\rangle\n$$\n已经是归一化的单重态 CSF，具有 $S=0, M_{S}=0$。它们与开壳层组态之间没有混合，因为它们占据了不同的自旋轨道集。\n\n因此我们有两个归一化的单重态 CSF：\n$$\n\\big|(1)^{2};\\,S=0,M_{S}=0\\big\\rangle=|1\\alpha\\,1\\beta\\rangle,\\qquad\n\\big|(2)^{2};\\,S=0,M_{S}=0\\big\\rangle=|2\\alpha\\,2\\beta\\rangle.\n$$\n\n$2.$ 每个空间轨道中有一个电子的开壳层单重态：\n- 对于 $\\phi_{1}$ 和 $\\phi_{2}$ 中各有一个电子的情况， $M_{S}=0$ 的行列式是 $|1\\alpha\\,2\\beta\\rangle$ 和 $|1\\beta\\,2\\alpha\\rangle$。单重态自旋耦合是反对称组合：\n$$\n\\big|S=0,M_{S}=0\\big\\rangle_{\\text{open}}=\\frac{1}{\\sqrt{2}}\\Big(|1\\alpha\\,2\\beta\\rangle-\\,|1\\beta\\,2\\alpha\\rangle\\Big).\n$$\n根据构造，此状态是归一化的，并且其 $\\hat{S}^{2}$ 本征值为 $S(S+1)=0$。\n\n$3.$ 每个空间轨道中有一个电子的三重态：\n- 三重态流形有三个 $M_{S}$ 分量。使用 Clebsch–Gordan 系数以及两个电子占据不同空间轨道这一事实，三重态 CSF 为\n$$\n\\begin{aligned}\n\\big|S=1,M_{S}=+1\\big\\rangle=|1\\alpha\\,2\\alpha\\rangle,\\\\\n\\big|S=1,M_{S}=0\\big\\rangle=\\frac{1}{\\sqrt{2}}\\Big(|1\\alpha\\,2\\beta\\rangle+\\,|1\\beta\\,2\\alpha\\rangle\\Big),\\\\\n\\big|S=1,M_{S}=-1\\big\\rangle=|1\\beta\\,2\\beta\\rangle,\n\\end{aligned}\n$$\n全部是归一化的。\n\n这六个 CSF 构成一个标准正交集，因为：\n- 不同的 $S$ 或 $M_{S}$ 量子数意味着作为对易厄米算符的本征函数，它们是正交的。\n- 在开壳层扇区的相同 $M_{S}$ 子空间内，由于相对相位和行列式的标准正交性，单重态和三重态组合是正交的。\n- 由于占据模式不同，闭壳层行列式与开壳层行列式是正交的。\n\n现在我们将每个 CSF 表示为有序行列式基的线性组合。定义行列式列序为\n$$\n\\Big[\\,|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\,\\Big].\n$$\n定义 CSF 行序为\n$$\n\\Big[\\,\\big|(1)^{2};S=0,0\\big\\rangle,\\ \\big|(2)^{2};S=0,0\\big\\rangle,\\ \\big|S=0,0\\big\\rangle_{\\text{open}},\\ \\big|1,+1\\big\\rangle,\\ \\big|1,0\\big\\rangle,\\ \\big|1,-1\\big\\rangle\\,\\Big].\n$$\n从上述显式形式中读出系数，得到 $6\\times 6$ 的系数矩阵 $C$，其 $(i,j)$ 元是行列式 $j$ 在 CSF $i$ 中的系数：\n- 对于 $\\big|(1)^{2};S=0,0\\big\\rangle$：系数为 $[1,\\,0,\\,0,\\,0,\\,0,\\,0]$。\n- 对于 $\\big|(2)^{2};S=0,0\\big\\rangle$：系数为 $[0,\\,1,\\,0,\\,0,\\,0,\\,0]$。\n- 对于 $\\big|S=0,0\\big\\rangle_{\\text{open}}$：系数为 $[0,\\,0,\\,0,\\,0,\\,\\tfrac{1}{\\sqrt{2}},\\,-\\tfrac{1}{\\sqrt{2}}]$。\n- 对于 $\\big|1,+1\\big\\rangle$：系数为 $[0,\\,0,\\,1,\\,0,\\,0,\\,0]$。\n- 对于 $\\big|1,0\\big\\rangle$：系数为 $[0,\\,0,\\,0,\\,0,\\,\\tfrac{1}{\\sqrt{2}},\\,\\tfrac{1}{\\sqrt{2}}]$。\n- 对于 $\\big|1,-1\\big\\rangle$：系数为 $[0,\\,0,\\,0,\\,1,\\,0,\\,0]$。\n\n因此\n$$\nC=\n\\begin{pmatrix}\n1  0  0  0  0  0\\\\\n0  1  0  0  0  0\\\\\n0  0  0  0  \\tfrac{1}{\\sqrt{2}}  -\\tfrac{1}{\\sqrt{2}}\\\\\n0  0  1  0  0  0\\\\\n0  0  0  0  \\tfrac{1}{\\sqrt{2}}  \\tfrac{1}{\\sqrt{2}}\\\\\n0  0  0  1  0  0\n\\end{pmatrix}.\n$$\n每一行都是归一化的并且相互正交，所以 $C$ 是一个正交矩阵。这个 $C$ 就是所求的、将行列式基按指定顺序变换为自旋匹配 CSF 基的变换矩阵。", "answer": "$$\\boxed{\\begin{pmatrix}\n1  0  0  0  0  0\\\\\n0  1  0  0  0  0\\\\\n0  0  0  0  \\tfrac{1}{\\sqrt{2}}  -\\tfrac{1}{\\sqrt{2}}\\\\\n0  0  1  0  0  0\\\\\n0  0  0  0  \\tfrac{1}{\\sqrt{2}}  \\tfrac{1}{\\sqrt{2}}\\\\\n0  0  0  1  0  0\n\\end{pmatrix}}$$", "id": "2906845"}, {"introduction": "在实际的量子化学计算中，分子对称性不仅仅是一个美学概念，更是一个简化问题的强大工具。通过根据分子点群的不可约表示对轨道和组态进行分类，哈密顿矩阵会呈现块对角化形式，这使得计算更加高效，并能够对电子态进行严格分类。这个实践问题 ([@problem_id:2906791]) 提供了将群论应用于乙烯分子的 CAS(2,2) 模型的动手经验，这是一个典型的例子，展示了如何在 MCSCF 理论中利用对称性。", "problem": "乙烯是平面分子，属于 $D_{2h}$ 点群。采用标准的 $D_{2h}$ 轴约定：分子平面为 $xy$ 平面，碳-碳双键沿 $x$ 轴，而 $z$ 轴垂直于分子平面。在一个包含两个电子和两个空间轨道的最小完备活性空间（记作 $\\mathrm{CAS}(2,2)$）中，选择由两个碳原子的 $p_{z}$ 原子轨道形成的 $\\pi$ 和 $\\pi^{\\ast}$ 轨道作为活性轨道。\n\n从对称匹配线性组合和不可约表示的定义出发，并仅使用 $D_{2h}$ 操作 $C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和反演 $i$ 的特征标性质，完成以下任务：\n\n1. 构建两个 $p_{z}$ 原子轨道的两个对称匹配线性组合，并确定它们在 $C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和 $i$ 操作下的变换性质。将相应的 $D_{2h}$ 不可约表示指认给成键 $\\pi$ 和反键 $\\pi^{\\ast}$ 分子轨道。\n\n2. 构建在 $\\mathrm{CAS}(2,2)$ 空间内可以建立的自旋匹配单重态组态态函数，并使用不可约表示的直积来指认每个单重态组态的空间对称性。\n\n相应的完备活性空间组态相互作用 (CAS-CI) 问题中，自旋匹配单重态 $\\mathrm{A}_{g}$ 子空间的维度是多少？请以单个整数形式提供最终答案，不带单位。如果得到数值，请勿四舍五入。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 分子：乙烯 ($C_2H_4$)\n- 点群：$D_{2h}$\n- 轴约定：分子平面为 $xy$ 平面，碳-碳双键沿 $x$ 轴，而 $z$ 轴垂直于分子平面。\n- 活性空间：$\\mathrm{CAS}(2,2)$，两个电子在两个空间轨道中。\n- 活性轨道：由两个碳原子的 $p_{z}$ 原子轨道导出的 $\\pi$ 和 $\\pi^{\\ast}$ 轨道。\n- 用于分析的操作：$C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和反演 $i$。\n- 任务1：构建两个 $p_{z}$ 原子轨道的对称匹配线性组合（SALC），确定它们在指定操作下的变换性质，并指认相应的 $D_{2h}$ 不可约表示（irrep）。\n- 任务2：在 $\\mathrm{CAS}(2,2)$ 空间内构建自旋匹配单重态组态态函数（CSF）并指认其空间对称性。\n- 最终问题：确定 CAS-CI 问题的自旋匹配单重态 $\\mathrm{A}_{g}$ 子空间的维度。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是群论在分子轨道理论和组态相互作用中的标准应用，这是量子化学的一个基本课题。它在科学上是合理的。\n- **良态性**：该问题是良态的，提供了一个清晰的问题和足够的信息来推导出一个唯一的整数值答案。\n- **客观性**：问题以精确、客观和技术性的语言陈述。\n\n**第3步：结论与行动**\n问题有效。将构建一个严谨的解答。\n\n按照问题陈述的要求，解答分为两部分进行。\n\n**第1部分：分子轨道的对称性**\n\n我们首先定义基组。设两个碳原子表示为 $C_A$ 和 $C_B$。根据指定的轴约定，我们将它们放置在坐标 $C_A = (-d, 0, 0)$ 和 $C_B = (d, 0, 0)$ 处，其中距离 $d > 0$。基组由两个 $p_z$ 原子轨道组成，$\\phi_A$ 以 $C_A$ 为中心，$\\phi_B$ 以 $C_B$ 为中心。一个 $p_z$ 轨道的函数形式为 $f(r)z$，它相对于 $xy$ 平面是反对称的。\n\n我们分析基轨道 $\\phi_A$ 和 $\\phi_B$ 在 $D_{2h}$ 群的指定对称操作下的变换。\n1.  **$C_{2}(x)$ 旋转**：绕 $x$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (x, -y, -z)$。原子 $C_A$ 和 $C_B$ 位于轴上，不发生交换。$z$ 坐标反转，因此 $p_z$ 轨道符号反转。\n    $$\n    C_{2}(x)\\phi_A = -\\phi_A \\quad ; \\quad C_{2}(x)\\phi_B = -\\phi_B\n    $$\n2.  **$C_{2}(y)$ 旋转**：绕 $y$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (-x, y, -z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$。$z$ 坐标也反转。\n    $$\n    C_{2}(y)\\phi_A = -\\phi_B \\quad ; \\quad C_{2}(y)\\phi_B = -\\phi_A\n    $$\n3.  **$C_{2}(z)$ 旋转**：绕 $z$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (-x, -y, z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$。$z$ 坐标不变，因此 $p_z$ 轨道的符号保持不变。\n    $$\n    C_{2}(z)\\phi_A = \\phi_B \\quad ; \\quad C_{2}(z)\\phi_B = \\phi_A\n    $$\n4.  **反演 $i$**：通过原点 $(0, 0, 0)$ 的反演。坐标变换为 $(x, y, z) \\rightarrow (-x, -y, -z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$，并反转 $z$ 坐标。\n    $$\n    i\\phi_A = -\\phi_B \\quad ; \\quad i\\phi_B = -\\phi_A\n    $$\n\n接下来，我们构建对称匹配线性组合（SALC）。这些是成键（$\\pi$）和反键（$\\pi^{\\ast}$）分子轨道（MO）。设 $\\psi_1$ 为成键 $\\pi$ 分子轨道，$\\psi_2$ 为反键 $\\pi^{\\ast}$ 分子轨道，忽略归一化常数。\n$$\n\\psi_1 = \\phi_A + \\phi_B \\quad (\\text{成键 } \\pi \\text{ 轨道})\n$$\n$$\n\\psi_2 = \\phi_A - \\phi_B \\quad (\\text{反键 } \\pi^{\\ast} \\text{ 轨道})\n$$\n我们通过找出每个 MO 在指定操作下的特征标来确定其不可约表示。\n\n对于成键 $\\pi$ 轨道 $\\psi_1$：\n- $C_{2}(x)\\psi_1 = C_{2}(x)(\\phi_A + \\phi_B) = -\\phi_A - \\phi_B = -1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(x)) = -1$。\n- $C_{2}(y)\\psi_1 = C_{2}(y)(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(y)) = -1$。\n- $C_{2}(z)\\psi_1 = C_{2}(z)(\\phi_A + \\phi_B) = \\phi_B + \\phi_A = +1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(z)) = +1$。\n- $i\\psi_1 = i(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$。特征标为 $\\chi(i) = -1$。\n对于 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ 的特征标为 $(+1, -1, -1)$。反演操作下的特征标为 $-1$ (ungerade, 奇宇称, $u$)。查阅 $D_{2h}$ 特征标表，具有这些特征标的不可约表示是 $B_{1u}$。因此，$\\pi$ 轨道具有 $b_{1u}$ 对称性。\n\n对于反键 $\\pi^{\\ast}$ 轨道 $\\psi_2$：\n- $C_{2}(x)\\psi_2 = C_{2}(x)(\\phi_A - \\phi_B) = -\\phi_A - (-\\phi_B) = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(x)) = -1$。\n- $C_{2}(y)\\psi_2 = C_{2}(y)(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(y)) = +1$。\n- $C_{2}(z)\\psi_2 = C_{2}(z)(\\phi_A - \\phi_B) = \\phi_B - \\phi_A = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(z)) = -1$。\n- $i\\psi_2 = i(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$。特征标为 $\\chi(i) = +1$。\n对于 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ 的特征标为 $(-1, +1, -1)$。反演操作下的特征标为 $+1$ (gerade, 偶宇称, $g$)。查阅 $D_{2h}$ 特征标表，具有这些特征标的不可约表示是 $B_{2g}$。因此，$\\pi^{\\ast}$ 轨道具有 $b_{2g}$ 对称性。\n\n**第2部分：组态态函数的对称性与最终维度**\n\n活性空间是 $\\mathrm{CAS}(2,2)$，其中两个电子分布在两个活性轨道中：$\\psi_{b_{1u}}$ ($\\pi$) 和 $\\psi_{b_{2g}}$ ($\\pi^{\\ast}$)。可能的电子组态有：\n1.  $(\\psi_{b_{1u}})^2 (\\psi_{b_{2g}})^0$\n2.  $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$\n3.  $(\\psi_{b_{1u}})^0 (\\psi_{b_{2g}})^2$\n\n我们关注的是自旋匹配单重态 CSF。一个 CSF 的空间对称性由所占据的单电子轨道的不可约表示的直积决定。\n\n1.  **组态 $(\\psi_{b_{1u}})^2$**：该组态有一个双占据轨道，它唯一地形成一个单重态。其空间对称性 $\\Gamma_1$ 由直积给出：\n    $$\n    \\Gamma_1 = B_{1u} \\otimes B_{1u} = A_g\n    $$\n    任何不可约表示与其自身的直积总是全对称不可约表示 $A_g$。该组态为单重态流形贡献了一个具有 $A_g$ 对称性的 CSF。\n\n2.  **组态 $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$**：这种两个电子处于两个不同轨道的组态会产生一个单重态和一个三重态。单重态和三重态 CSF 的空间对称性 $\\Gamma_2$ 均由直积给出：\n    $$\n    \\Gamma_2 = B_{1u} \\otimes B_{2g}\n    $$\n    我们通过将 $B_{1u}$ 和 $B_{2g}$ 的特征标相乘来找到结果的不可约表示：\n    - $\\chi(C_{2}(z)) = (+1) \\times (-1) = -1$\n    - $\\chi(C_{2}(y)) = (-1) \\times (+1) = -1$\n    - $\\chi(C_{2}(x)) = (-1) \\times (-1) = +1$\n    - $\\chi(i) = (-1) \\times (+1) = -1$ (ungerade, 奇宇称, $u$)\n    特征标集 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x))) = (-1,-1,+1)$ 对应于 $B_3$ 表示。结合奇宇称性，对称性为 $B_{3u}$。该组态贡献了一个 $B_{3u}$ 对称性的单重态 CSF。它对 $A_g$ 子空间没有贡献。\n\n3.  **组态 $(\\psi_{b_{2g}})^2$**：这是另一个双占据组态，形成一个单重态。其空间对称性 $\\Gamma_3$ 是：\n    $$\n    \\Gamma_3 = B_{2g} \\otimes B_{2g} = A_g\n    $$\n    该组态为单重态流形贡献了第二个具有 $A_g$ 对称性的 CSF。\n\nCAS-CI 问题的自旋匹配单重态 $A_g$ 子空间由根据 $A_g$ 不可约表示变换的单重态 CSF 张成。我们找到了两个这样的 CSF：一个来自 $(\\psi_{b_{1u}})^2$ 组态，另一个来自 $(\\psi_{b_{2g}})^2$ 组态。这两个 CSF 构成了 CI 矩阵的 $A_g$ 单重态块的基。\n\n因此，自旋匹配单重态 $A_g$ 子空间的维度是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2906791"}, {"introduction": "在构建了波函数之后，我们将面对 MCSCF 优化过程中的实际数值挑战。态特定 (state-specific) 计算，特别是对于激发态或远离平衡构型的体系，可能会遇到收敛问题，例如“根翻转 (root flipping)”，即优化过程意外地跳转到另一个电子态。这个高级问题 ([@problem_id:2654005]) 挑战您像量子化学软件开发者一样思考，批判性地评估各种旨在确保计算在近简并区域能够稳定地追踪目标态的算法策略。", "problem": "一个态特定多组态自洽场 (MCSCF) 优化，其目标是双原子分子中某个给定对称性的激发态根，该根与同一对称性的另一个根处于避免交叉附近。MCSCF 波函数参数化为 $|\\Psi(\\mathbf{c},\\boldsymbol{\\kappa})\\rangle = \\exp(\\hat{\\kappa}) \\sum_I c_I |I\\rangle$，其中 $\\mathbf{c}$ 是组态相互作用 (CI) 系数向量，$\\hat{\\kappa}$ 是一个通过反厄米单电子算符生成轨道幺正变换的算符，$\\{|I\\rangle\\}$ 是由当前轨道构建的组态基。根据 Rayleigh–Ritz 变分原理，在固定的 $\\boldsymbol{\\kappa}$下，$E(\\mathbf{c},\\boldsymbol{\\kappa})=\\langle \\Psi|\\hat{H}|\\Psi\\rangle$ 在归一化约束下对 $\\mathbf{c}$ 是驻定的，这为目标根导出了一个 CI 本征值问题；而在固定的 $\\mathbf{c}$ 下，对 $\\boldsymbol{\\kappa}$ 的驻定性则导出了类广义 Brillouin 条件。在实践中，人们交替进行 CI 对角化和使用轨道 Hessian 矩阵（可能包含响应耦合）的 Newton–Raphson 轨道更新。在避免交叉附近，CI 步骤在一次轨道更新后可能会返回一个不同的本征向量作为目标对称性下的最低能量根，这种现象被称为根翻转。\n\n基于这些第一性原理，请考虑以下旨在在整个优化过程中保持目标根、同时在收敛极限下保留精确的态特定驻点并维持 Newton 步的局域二次收敛性的修改提议。哪些提议满足这些要求？选择所有适用的选项。\n\nA. 引入一个态跟踪罚函数，将目标函数扩充为 $E_{\\mathrm{track}}(\\mathbf{c},\\boldsymbol{\\kappa}) = E(\\mathbf{c},\\boldsymbol{\\kappa}) + \\dfrac{\\kappa_k}{2}\\, \\min_{\\phi\\in[0,2\\pi)} \\|\\mathbf{c} - e^{i\\phi}\\mathbf{c}^{\\mathrm{ref}}\\|^2$，其中 $\\mathbf{c}^{\\mathrm{ref}}$ 是一个固定的参考 CI 向量，仅当重叠 $|\\langle \\mathbf{c}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ 超过一个阈值时才更新，而 $\\kappa_k>0$ 是一个序列，满足当 MCSCF 梯度范数 $\\|\\nabla E\\| \\to 0$ 时 $\\kappa_k \\to 0$。\n\nB. 在每次迭代中向轨道 Hessian 矩阵添加一个均匀的正能级移动：用 $\\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$ 替换 $\\mathbf{H}_{\\kappa\\kappa}$，其中 $\\sigma>0$ 是一个与迭代无关的固定常数，CI 选择规则保持不变。\n\nC. 用最大重叠方法 (MOM) 替换态的 CI 选择规则：在每次 CI 对角化时，选择与前一次迭代传来的参考向量 $\\mathbf{c}^{\\mathrm{ref}}$ 具有最大绝对重叠 $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ 的本征向量，而不是选择具有目标对称性下最低本征值的本征向量；使用所选的本征向量执行轨道 Newton 步，且不修改目标函数。\n\nD. 将态特定目标替换为对两个近简并根进行的等权重态平均 MCSCF，为平均能量优化轨道，最后通过在优化后的轨道中对角化 CI 问题来报告目标态的能量。\n\nE. 仅修改轨道 Hessian 矩阵，方法是添加一个基于投影算符的半正定能级移动，该移动仅限于将目标根与其最接近的竞争根混合的方向：定义一个投影算符 $\\mathbf{P}$，投影到在轨道旋转下将目标根与竞争根耦合的一阶 CI 响应方向所张成的空间上，并使用 $\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}=\\mathbf{H}_{\\kappa\\kappa}+\\sigma_k \\mathbf{P}$，其中 $\\sigma_k>0$ 是自适应选择的，并且在态重叠 $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|\\to 1$ 时趋于 $0$；目标函数和 CI 选择规则在其他方面保持不变。", "solution": "该问题要求评估对态特定多组态自洽场 (MCSCF) 优化算法的五种提议修改，特别是在避免交叉的困难情况下，该算法是一种使用 Newton–Raphson 步的二阶方法。一项修改是否成功由三个标准来判断：(1) 它必须确保优化过程跟踪期望的电子态（态跟踪）并避免“根翻转”；(2) 它必须收敛到态特定能量的真实驻点，这意味着修改不能改变解点；(3) 它必须保留未修改的 Newton–Raphson 方法所特有的局域二次收敛速率。我们将以不折不扣的严谨性，根据这三个要求分析每个提议。\n\nMCSCF 能量为 $E(\\mathbf{c},\\boldsymbol{\\kappa})$，其中 $\\mathbf{c}$ 是组态相互作用 (CI) 系数向量，$\\boldsymbol{\\kappa}$ 参数化了轨道旋转幺正变换 $\\exp(\\hat{\\kappa})$。轨道参数的 Newton 步由 $\\Delta\\boldsymbol{\\kappa} = -(\\mathbf{H}_{\\kappa\\kappa})^{-1} \\mathbf{g}_{\\kappa}$ 给出，其中 $\\mathbf{g}_{\\kappa}$ 是轨道梯度，$\\mathbf{H}_{\\kappa\\kappa}$ 是轨道 Hessian 矩阵。\n\n**提议 A 的分析**\n\n该提议将能量泛函扩充为 $E_{\\mathrm{track}}(\\mathbf{c},\\boldsymbol{\\kappa}) = E(\\mathbf{c},\\boldsymbol{\\kappa}) + P_A$，其中罚项为 $P_A = \\dfrac{\\kappa_k}{2}\\, \\min_{\\phi\\in[0,2\\pi)} \\|\\mathbf{c} - e^{i\\phi}\\mathbf{c}^{\\mathrm{ref}}\\|^2$。罚函数参数 $\\kappa_k$ 是一个正序列，使得当物理 MCSCF 梯度范数 $\\|\\nabla E\\| \\to 0$ 时，$\\kappa_k \\to 0$。\n\n1.  **态跟踪**：当当前 CI 向量 $\\mathbf{c}$ 与参考向量 $\\mathbf{c}^{\\mathrm{ref}}$（通常来自前一次迭代）的重叠最大时，罚项 $P_A$ 最小。最小化总泛函 $E_{\\mathrm{track}}$ 的 CI 对角化步骤因此会偏向于选择与由 $\\mathbf{c}^{\\mathrm{ref}}$ 定义的目标态最相似的根。这直接对抗了根翻转。此要求得到满足。\n\n2.  **正确的驻点**：优化的驻点是目标函数梯度为零的点。扩充泛函的梯度为 $\\nabla E_{\\mathrm{track}} = \\nabla E + \\nabla P_A$。条件“当 $\\|\\nabla E\\| \\to 0$ 时 $\\kappa_k \\to 0$”确保了在原始能量 $E$ 的驻点（其中 $\\|\\nabla E\\| = 0$），罚函数参数 $\\kappa_k$ 变为 $0$。因此，罚项 $P_A$ 及其梯度 $\\nabla P_A$ 均消失。条件 $\\nabla E_{\\mathrm{track}} = 0$ 因此等价于 $\\nabla E = 0$。驻点未被改变。此要求得到满足。\n\n3.  **二次收敛**：对 $E_{\\mathrm{track}}$ 进行 Newton–Raphson 步会使用 Hessian 矩阵 $\\mathbf{H}_{\\mathrm{track}} = \\mathbf{H}_{E} + \\mathbf{H}_{P_A}$，其中 $\\mathbf{H}_{E}$ 是 $E$ 的 Hessian 矩阵，$\\mathbf{H}_{P_A}$ 是罚项的 Hessian 矩阵。当接近收敛时，$\\|\\nabla E\\| \\to 0$，因此 $\\kappa_k \\to 0$。整个罚项，包括构成 $\\mathbf{H}_{P_A}$ 的其二阶导数，都将消失。因此，在解的邻域内，$\\mathbf{H}_{\\mathrm{track}} \\to \\mathbf{H}_{E}$。使用一个收敛于目标函数真实 Hessian 矩阵的 Hessian 矩阵是保持局域二次收敛性的关键条件。此要求得到满足。\n\n**对 A 的裁定**：**正确**。\n\n**提议 B 的分析**\n\n该提议为了计算轨道更新步，将轨道 Hessian 矩阵修改为 $\\mathbf{H}_{\\kappa\\kappa}^{\\mathrm{mod}} = \\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$，其中 $\\sigma>0$ 是一个固定常数。CI 选择规则保持不变。\n\n1.  **态跟踪**：此修改不影响 CI 对角化步骤。根的选择仍然基于从 CI 问题的解中选择指定对称性下的最低能量根。如果轨道更新步导致两个根的特性互换，该方法将选择新的、能量更低的根，从而无法跟踪目标态。能级移动可以正则化 Newton 步，从而提高稳定性，但它不构成直接的态跟踪机制。此要求未得到满足。\n\n2.  **正确的驻点**：该修改仅影响 Newton 步 $\\Delta\\boldsymbol{\\kappa} = -(\\mathbf{H}_{\\kappa\\kappa} + \\sigma\\mathbf{I})^{-1}\\mathbf{g}_{\\kappa}$ 的计算。收敛条件是能量梯度 $\\mathbf{g}_{\\kappa}$ 必须为零。如果 $\\mathbf{g}_{\\kappa} = 0$，那么无论使用何种非奇异矩阵计算该步，$\\Delta\\boldsymbol{\\kappa} = 0$。因此，能量泛函的驻点保持不变。此要求得到满足。\n\n3.  **二次收敛**：Newton 步使用了一个修改后的 Hessian 矩阵 $\\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$。为了实现二次收敛，在接近解时，步计算中使用的 Hessian 矩阵必须收敛到被优化函数的真实 Hessian 矩阵 $\\mathbf{H}_{\\kappa\\kappa}$。由于 $\\sigma$ 是一个固定的正常数，项 $\\sigma \\mathbf{I}$ 在解点处不会消失。这一步不是真正的 Newton 步，而是一个 Levenberg–Marquardt 类型的步。这类方法表现为线性收敛，而非二次收敛。此要求未得到满足。\n\n**对 B 的裁定**：**不正确**。\n\n**提议 C 的分析**\n\n该提议用最大重叠方法 (MOM) 替代了基于能量的 CI 根选择。当前迭代 $k$ 的 CI 本征向量 $\\mathbf{c}^{(k)}$ 的选择标准是使其与前一次迭代的参考向量 $\\mathbf{c}^{\\mathrm{ref}}$ 的重叠 $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ 最大化。所选态的目标函数和 Newton 步计算保持不变。\n\n1.  **态跟踪**：这正是一个态跟踪算法的定义。通过根据与前一次迭代向量的相似性明确选择 CI 向量，该方法旨在跟踪一个具有一致电子特性的态，从而防止根翻转。此要求得到满足。\n\n2.  **正确的驻点**：该方法旨在找到一个点，使得被跟踪的态（比如态 $j$）的 MCSCF 梯度为零，即 $\\mathbf{g}_{\\kappa,j} = 0$。这正是态 $j$ 的态特定驻点的定义。MOM 过程是在每次迭代中识别哪个是态 $j$ 的一种规定。它不改变定义驻点本身的条件。此要求得到满足。\n\n3.  **二次收敛**：在解的附近，预期目标根是明确定义的，并且在每次迭代中都能被 MOM 一致地选中。在这种情况下，该算法等同于针对单个固定态的标准二阶 MCSCF 优化。Newton 步是使用该态的能量面的正确梯度和 Hessian 矩阵执行的。适用于 Newton 方法的标准分析预测了局域二次收敛性。虽然当态的选择发生切换时，全局收敛可能会因不连续性而变得复杂，但局域收敛性质得以保留。此要求得到满足。\n\n**对 C 的裁定**：**正确**。\n\n**提议 D 的分析**\n\n该提议用态平均 (SA-MCSCF) 优化替换了态特定优化，使用的是两个近简并根的等权重平均。最终能量通过在收敛的 SA-MCSCF 轨道中进行 CI 计算得到。\n\n1.  **态跟踪**：该方法通过同时为两个根优化一组折衷轨道来避免在它们之间进行选择。从这个意义上说，它在存在近简并性的情况下提供了一个稳定的优化过程，并避免了根翻转问题。此要求得到满足。\n\n2.  **正确的驻点**：轨道被优化以使平均能量 $E_{\\mathrm{avg}} = \\frac{1}{2}(E_1 + E_2)$ 驻定。得到的轨道通常与使目标态（比如 $E_1$）能量驻定的轨道不同。问题明确要求保留*精确的态特定驻点*。SA-MCSCF 计算收敛到一个态平均驻点，这在根本上是不同的。此要求未得到满足。\n\n3.  **二次收敛**：通过为态平均能量泛函构建适当的 Newton 步，可以构想出一种表现出二次收敛性的 SA-MCSCF 优化。因此，这个条件原则上可以满足。然而，由于未能满足第二个更关键的要求，这一点变得没有实际意义。\n\n**对 D 的裁定**：**不正确**。\n\n**提议 E 的分析**\n\n该提议向轨道 Hessian 矩阵添加一个有向的能级移动，$\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}=\\mathbf{H}_{\\kappa\\kappa}+\\sigma_k \\mathbf{P}$。投影算符 $\\mathbf{P}$ 针对的是将目标态与其竞争态耦合的轨道旋转方向。移动的幅度 $\\sigma_k$ 随着态跟踪的改善（即当重叠 $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|\\to 1$ 时）而趋于 $0$。\n\n1.  **态跟踪**：通过在与有问题的态混合轨道旋转相对应的方向上向 Hessian 矩阵添加一个大的正项，Newton 步在这些方向上的移动会受到惩罚。这抑制了导致根翻转的轨道变化，并稳定了对目标态的跟踪。这是一种以定向方式实现简单能级移动无法完成任务的复杂方法。此要求得到满足。\n\n2.  **正确的驻点**：与提议 B 一样，修改仅针对用于计算轨道步的 Hessian 矩阵。梯度 $\\mathbf{g}_{\\kappa}$ 未被修改。驻定条件仍然是 $\\mathbf{g}_{\\kappa}=0$。驻点的位置不受影响。此要求得到满足。\n\n3.  **二次收敛**：Hessian 矩阵的修改是 $\\sigma_k \\mathbf{P}$。条件是当接近收敛时 $\\sigma_k \\to 0$。这意味着修改后的 Hessian 矩阵 $\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}$ 在解点处收敛到真实的 Hessian 矩阵 $\\mathbf{H}_{\\kappa\\kappa}$。这正是恢复局域二次收敛性所需的条件。这种修改有助于在远离解时提高稳定性，但在会损害收敛速率的地方消失。此要求得到满足。\n\n**对 E 的裁定**：**正确**。\n\n总而言之，提议 A、C 和 E 均满足在避免交叉附近进行稳健的态特定 MCSCF 优化的三个既定要求。提议 B 和 D 至少在一个关键要求上失败。", "answer": "$$\\boxed{ACE}$$", "id": "2654005"}]}