{"hands_on_practices": [{"introduction": "掌握一种理论的最好方法之一是检验其在简单极限下的行为。本练习将耦合簇理论应用于量子化学中最简单的系统：单电子氢原子。通过分析这个没有电子相关的基准情况，你将验证CCSD方法的基本自洽性，并加深对电子相关能物理本质的理解。", "problem": "考虑一个在玻恩-奥本海默近似下，核电荷为 $Z=1$ 的非相对论氢原子。您使用哈特里-福克 (HF) 参考行列式和一个（在其他方面）完备的单电子基组，进行了一次耦合簇单双激发 (CCSD) 计算。电子相关能定义为精确的非相对论电子能量与哈特里-福克能量之差，即 $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$。对于这个单电子体系，哪个陈述最能描述 CCSD 相关能及其根本原因？\n\nA. $E_{\\mathrm{corr}}=0$，因为在单电子体系中没有电子-电子相互作用，所以 HF 方法是精确的，并且 CCSD 簇振幅为零。\n\nB. $E_{\\mathrm{corr}}0$，因为 CCSD 通过双激发捕获动态相关，即使只有一个电子也能降低能量。\n\nC. $E_{\\mathrm{corr}}=0$，因为对于单电子体系，基组不完备性抵消了 CCSD 中的相关能误差。\n\nD. $E_{\\mathrm{corr}}0$，因为 CCSD 中的截断导致对相关的过高估计，从而使单电子体系的能量高于 HF 能量。", "solution": "必须首先确定问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 体系：一个非相对论氢原子。\n- 核电荷：$Z=1$。\n- 近似：假定玻恩-奥本海默近似。\n- 计算方法：耦合簇单双激发 (CCSD)。\n- 参考波函数：哈特里-福克 (HF) 行列式。\n- 基组：一个完备的单电子基组。\n- 给出的定义：电子相关能为 $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$。\n- 问题：描述这个单电子体系的 CCSD 相关能及其结果的根本原因。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。氢原子是量子力学中的一个基本体系。哈特里-福克方法、耦合簇理论以及电子相关的概念是现代计算化学的核心支柱。该问题陈述清晰，提供了所有必要信息（体系、方法、基组极限、定义），以得出一个唯一的逻辑结论。语言客观而精确。“完备的单电子基组”的理想化是一个标准的理论构造，用于将方法误差与基组误差分离开来。该问题不违反任何基本原理，没有歧义，并且与指定的科学领域直接相关。\n\n### 步骤 3：结论与行动\n问题陈述被宣布为**有效**。将推导解答。\n\n### 正确答案的推导\n\n该问题涉及将哈特里-福克 (HF) 和耦合簇单双激发 (CCSD) 方法应用于单电子体系，具体来说是氢原子 ($Z=1$)。\n\n$1$. **哈密顿量和精确解：**\n在玻恩-奥本海默近似中，原子核是静止的。对于一个核电荷为 $Z$ 的单电子体系，其非相对论电子哈密顿量纯粹是一个单电子算符：\n$$ \\hat{H} = \\hat{h}(1) = -\\frac{1}{2}\\nabla_1^2 - \\frac{Z}{r_1} $$\n对于氢原子，$Z=1$。这个哈密顿量不包含任何双电子项 ($1/r_{ij}$)，因为只有一个电子。对于这个体系，薛定谔方程 $\\hat{H}\\Psi = E\\Psi$ 是可以精确求解的。所得到的能量 $E_{\\mathrm{exact}}$ 是精确的非相对论电子能量。\n\n$2$. **针对单电子体系的哈特里-福克 (HF) 方法：**\nHF 方法将多电子波函数近似为单个斯莱特行列式。对于单电子体系，这个行列式就是单电子轨道本身，即 $|\\Phi_0\\rangle = |\\psi_1\\rangle$。HF 能量是通过最小化哈密顿量的期望值来找到的，$E_{\\mathrm{HF}} = \\langle\\Phi_0|\\hat{H}|\\Phi_0\\rangle$。最小化过程导出了正则 HF 方程，$\\hat{f}|\\psi_i\\rangle = \\epsilon_i|\\psi_i\\rangle$，其中 $\\hat{f}$ 是福克算符。\n\n电子 $1$ 的福克算符的一般形式是：\n$$ \\hat{f}(1) = \\hat{h}(1) + \\sum_{j=1}^{N} \\left( \\hat{J}_j(1) - \\hat{K}_j(1) \\right) $$\n其中 $\\hat{J}_j$ 是库仑算符，$\\hat{K}_j$ 是交换算符，它们都描述了与其他电子的相互作用。对于单电子体系 ($N=1$)，求和项描述了电子与自身的相互作用。这种自相互作用已知是完全抵消的，即 $\\hat{J}_1(1) - \\hat{K}_1(1) = 0$。因此，福克算符简化为核心哈密顿量：\n$$ \\hat{f}(1) = \\hat{h}(1) $$\n所以，单个电子的 HF 方程变为 $\\hat{h}(1)|\\psi_1\\rangle = \\epsilon_1|\\psi_1\\rangle$。这与该体系的精确薛定谔方程完全相同。\n\n鉴于使用了“完备的单电子基组”，HF 计算能够找到精确的轨道 $|\\psi_1\\rangle$，从而得到精确的能量。这意味着对于任何单电子体系，HF 方法不是一个近似，而是精确的。\n$$ E_{\\mathrm{HF}} = E_{\\mathrm{exact}} $$\n\n$3$. **电子相关能：**\n问题将相关能定义为 $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$。根据我们发现的 $E_{\\mathrm{HF}} = E_{\\mathrm{exact}}$，单电子体系的精确相关能恒等于零。\n$$ E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} = 0 $$\n电子相关本质上是一种多电子现象，源于平均场 (HF) 近似不足以描述电子之间的瞬时相互作用。只有一个电子时，这种相互作用不存在，因此没有相关性。\n\n$4$. **针对单电子体系的耦合簇 (CCSD) 方法：**\nCCSD 波函数构造为 $|\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}}|\\Phi_0\\rangle$，其中 $|\\Phi_0\\rangle$ 是 HF 参考态，簇算符 $\\hat{T}$ 在单激发和双激发处被截断：$\\hat{T} = \\hat{T}_1 + \\hat{T}_2$。\n- 单激发算符 $\\hat{T}_1 = \\sum_{i,a} t_i^a \\hat{a}_a^\\dagger \\hat{a}_i$，将一个电子从占据轨道 $i$ 激发到虚拟轨道 $a$。\n- 双激发算符 $\\hat{T}_2 = \\frac{1}{4} \\sum_{i,j,a,b} t_{ij}^{ab} \\hat{a}_a^\\dagger \\hat{a}_b^\\dagger \\hat{a}_j \\hat{a}_i$，将两个电子从占据轨道 $i,j$ 激发到虚拟轨道 $a,b$。\n\n对于单电子体系，占据空间只包含一个轨道。因此，不可能选择两个占据轨道进行双激发。算符 $\\hat{T}_2$ 作用于单电子行列式上不能产生非零结果。因此，所有双激发振幅必须为零：$t_{ij}^{ab} = 0$。\n\nCCSD 的振幅方程是通过将 CC 薛定谔方程投影到激发态行列式空间上导出的。这些方程由哈密顿量的双电子部分驱动。由于单电子体系的哈密顿量没有双电子项，所有双电子积分都为零。\n双激发振幅方程的一般形式为：\n$$ (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j) t_{ij}^{ab} = \\langle ij || ab \\rangle + \\dots $$\n其中 $\\langle ij || ab \\rangle$ 是一个反对称化的双电子积分。由于所有这类积分都为零，并且其余项也依赖于双电子相互作用，唯一的解是 $t_{ij}^{ab}=0$。\n当 $t_{ij}^{ab}=0$ 时，单激发振幅方程简化为：\n$$ (\\epsilon_a - \\epsilon_i) t_i^a = \\dots $$\n右边的项也因为涉及耦合单双激发振幅的双电子积分而消失。这使得 $(\\epsilon_a - \\epsilon_i) t_i^a = 0$。由于对于激发而言 $\\epsilon_a  \\epsilon_i$，能量差不为零，这要求单激发振幅也必须为零：$t_i^a=0$。\n\n因此，对于单电子体系，所有簇振幅都为零，$\\hat{T} = \\hat{T}_1 + \\hat{T}_2 = 0$。CCSD 波函数变得与 HF 参考态完全相同：\n$$ |\\Psi_{\\text{CCSD}}\\rangle = e^0 |\\Phi_0\\rangle = |\\Phi_0\\rangle = |\\Psi_{\\text{HF}}\\rangle $$\n因此，CCSD 能量等于 HF 能量：\n$$ E_{\\text{CCSD}} = E_{\\text{HF}} $$\nCCSD 预测的相关能是 $E_{\\text{CCSD}} - E_{\\text{HF}}$。对于这个体系，其值为 $0$。\n所以，CCSD 正确地发现单电子体系的相关能为零。\n\n### 选项评估\n\n**A. $E_{\\mathrm{corr}}=0$，因为在单电子体系中没有电子-电子相互作用，所以 HF 方法是精确的，并且 CCSD 簇振幅为零。**\n这个陈述声称相关能为 $0$。这是**正确**的。它提供了三部分的理由：\n$1$. “在单电子体系中没有电子-电子相互作用”：这是基本的物理现实。**正确**。\n$2$. “所以 HF 方法是精确的”：如上所述，电子-电子相互作用的缺失使得 HF 方程与薛定谔方程相同，从而使 HF 解是精确的（在完备基组中）。**正确**。\n$3$. “并且 CCSD 簇振幅为零”：如上所述，驱动激发的双电子相互作用的缺失，迫使所有单激发和双激发振幅都为零。**正确**。\n整个陈述是对该情况的完整而准确的描述。\n\n**B. $E_{\\mathrm{corr}}0$，因为 CCSD 通过双激发捕获动态相关，即使只有一个电子也能降低能量。**\n这个陈述声称 $E_{\\mathrm{corr}}0$。这是**错误**的。相关能恰好为 $0$。其推理也是有缺陷的：“双激发……即使只有一个电子”在物理上是不可能的。当只有一个电子存在时，不能激发两个电子。\n\n**C. $E_{\\mathrm{corr}}=0$，因为对于单电子体系，基组不完备性抵消了 CCSD 中的相关能误差。**\n这个陈述声称 $E_{\\mathrm{corr}}=0$，这是正确的值。然而，其推理完全是错误的。首先，问题明确假设了一个“完备的单电子基组”，因此“基组不完备性”不是一个因素。其次，对于这个体系，CCSD 中没有“相关能误差”；CCSD 在这里是精确的。第三，两种不相关误差类型之间偶然抵消的想法不是一个有效的基本原理。这个推理是无稽之谈。**错误**。\n\n**D. $E_{\\mathrm{corr}}0$，因为 CCSD 中的截断导致对相关的过高估计，从而使单电子体系的能量高于 HF 能量。**\n这个陈述声称 $E_{\\mathrm{corr}}0$。根据定义，对于精确的基态，$E_{\\mathrm{exact}} \\le E_{\\mathrm{HF}}$（由于 HF 的变分原理），这意味着 $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} \\le 0$。正的相关能是物理上不可能的。此外，推理也是错误的。对于单电子体系，CCSD 没有被截断；它是精确的。因此，该陈述是**错误**的。\n\n### 结论\n选项 A 提供了相关能的正确值，并给出了一个完全合理且根本的解释。", "answer": "$$\\boxed{A}$$", "id": "2453766"}, {"introduction": "在确认了CCSD在单电子系统中的正确行为后 ([@problem_id:2453766])，我们自然转向最简单的多电子系统：双电子体系。这个问题将引导你证明，对于任何双电子体系，CCSD方法都能在该基组下得到精确解。这项练习不仅展示了指数 ansatz 的强大威力，也阐明了为何双激发在描述电子相关中占据核心地位。", "problem": "在量子化学中，耦合簇 (CC) 方法是计算原子和分子电子结构的有力工具。CC 波函数由拟设 $|\\Psi_{CC}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle$ 给出，其中 $|\\Phi_0\\rangle$ 是一个参考单行列式波函数（通常是 Hartree-Fock 基态），而 $\\hat{T}$ 是簇算符。簇算符是激发算符之和，$\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots + \\hat{T}_N$，其中 $\\hat{T}_k$ 从参考态产生所有 $k$ 重激发，$N$ 是电子总数。\n\n耦合簇单双激发 (CCSD) 方法是一种常见的近似，其中簇算符被截断为仅包含单激发和双激发：$\\hat{T} \\approx \\hat{T}_{CCSD} = \\hat{T}_1 + \\hat{T}_2$。定义激发算符的能量和振幅通过求解 CC 方程得到：\n$$\nE_{CCSD} = \\langle \\Phi_0 | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle\n$$\n$$\n\\langle \\Phi_{\\mu} | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle = 0\n$$\n其中 $\\hat{H}$ 是电子哈密顿量，而 $|\\Phi_{\\mu}\\rangle$ 代表单激发和双激发行列式的空间。\n\n对于任何给定的体系，全组态相互作用 (FCI) 方法在所选的单粒子基组内提供了精确的基态能量 $E_{FCI}$。FCI 波函数包含了所有可能的激发行列式的贡献。对于一个双电子体系，FCI 展开最多包含双激发。\n\n考虑一个普遍的双电子体系。通过分析精确 (FCI) 波函数的结构及其与 CCSD 波函数拟设的关系，推导能量差 $\\Delta E = E_{FCI} - E_{CCSD}$ 的最终简单表达式。", "solution": "### 步骤 1：分析双电子体系的精确 (FCI) 波函数\n全组态相互作用 (FCI) 方法通过在给定基组中包含所有可能的激发态行列式来提供精确解。对于一个拥有两个电子的体系，我们最多只能将这两个电子同时激发。因此，不可能产生三重或更高阶的激发。这意味着 FCI 波函数 $|\\Psi_{\\text{FCI}}\\rangle$ 是参考行列式 $|\\Phi_0\\rangle$、所有单激发行列式 $\\{|\\Phi_i^a\\rangle\\}$ 和所有双激发行列式 $\\{|\\Phi_{ij}^{ab}\\rangle\\}$ 的精确线性组合。我们可以将其写作：\n$$\n|\\Psi_{\\text{FCI}}\\rangle = (1 + \\hat{C}_1 + \\hat{C}_2) |\\Phi_0\\rangle\n$$\n其中 $\\hat{C}_1$ 和 $\\hat{C}_2$ 是分别产生所有单激发和双激发的线性算符，其系数由 FCI 方程确定。这个波函数所处的空间是完备的（对于双电子体系）。\n\n### 步骤 2：分析双电子体系的 CCSD 波函数\nCCSD 波函数采用指数拟设：\n$$\n|\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle = e^{\\hat{T}_1 + \\hat{T}_2} |\\Phi_0\\rangle\n$$\n我们将指数算符进行泰勒展开：\n$$\ne^{\\hat{T}_1 + \\hat{T}_2} = 1 + (\\hat{T}_1 + \\hat{T}_2) + \\frac{1}{2!}(\\hat{T}_1 + \\hat{T}_2)^2 + \\frac{1}{3!}(\\hat{T}_1 + \\hat{T}_2)^3 + \\dots\n$$\n现在，我们分析这些项作用在双电子参考态 $|\\Phi_0\\rangle$ 上的结果：\n- $1|\\Phi_0\\rangle$ 产生参考态。\n- $\\hat{T}_1|\\Phi_0\\rangle$ 产生所有单激发态的线性组合。\n- $\\hat{T}_2|\\Phi_0\\rangle$ 产生所有双激发态的线性组合。\n- $\\frac{1}{2}\\hat{T}_1^2|\\Phi_0\\rangle$ (来自 $(\\hat{T}_1 + \\hat{T}_2)^2$) 同样产生双激发态的线性组合（非关联双激发）。\n- $\\hat{T}_1\\hat{T}_2|\\Phi_0\\rangle$ (来自 $(\\hat{T}_1 + \\hat{T}_2)^2$) 会产生三重激发。然而，对于双电子体系，这是不可能的，因此该项作用结果为零。\n- $\\frac{1}{2}\\hat{T}_2^2|\\Phi_0\\rangle$ (来自 $(\\hat{T}_1 + \\hat{T}_2)^2$) 会产生四重激发，同样作用结果为零。\n- 所有更高阶的展开项（如 $(\\hat{T}_1 + \\hat{T}_2)^3$）都将产生三重或更高阶的激发，因此它们作用于双电子体系的结果也全部为零。\n\n因此，对于任何双电子体系，CCSD 波函数的指数展开**精确地**终止，其形式为：\n$$\n|\\Psi_{\\text{CCSD}}\\rangle = (1 + \\hat{T}_1 + \\hat{T}_2 + \\frac{1}{2}\\hat{T}_1^2) |\\Phi_0\\rangle\n$$\n\n### 步骤 3：比较两种波函数并得出结论\nCCSD 波函数 $|\\Psi_{\\text{CCSD}}\\rangle$ 是由参考态、单激发态和双激发态构成的线性组合。这表明，CCSD 波函数与 FCI 波函数处于完全相同的希尔伯特空间中。\n\nCCSD 的振幅和能量是通过将薛定谔方程投影到单激发和双激发空间上求解的。由于 CCSD 波函数形式的灵活性足以精确表示双电子体系的任何波函数（即 FCI 波函数），因此求解 CCSD 方程将得到一组振幅 $T_1$ 和 $T_2$，使得 $|\\Psi_{\\text{CCSD}}\\rangle$ 等同于 $|\\Psi_{\\text{FCI}}\\rangle$。\n\n既然两种方法在给定的基组下能得到相同的波函数，那么它们计算出的能量也必然相等：\n$$\nE_{\\text{CCSD}} = E_{\\text{FCI}}\n$$\n因此，能量差为零。\n$$\n\\Delta E = E_{\\text{FCI}} - E_{\\text{CCSD}} = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "237876"}, {"introduction": "前面的练习 ([@problem_id:2453766] [@problem_id:237876]) 揭示了CCSD理论的准确性和优雅性，但它的计算成本和实现细节是其实用性的关键。本练习将带你从抽象的理论方程走向具体的算法实现。通过为CCSD振幅方程编写第一次迭代更新的程序，你将亲身体验这些复杂非线性方程的求解过程，并发现它与Møller–Plesset微扰理论之间的深刻联系。", "problem": "你的任务是为耦合簇单双激发 (CCSD) 中的振幅实现单次 Jacobi 迭代，其中 CCSD 代表耦合簇单双激发 (Coupled Cluster Singles and Doubles)。从二次量子化中的基本耦合簇拟设出发，其中关联基态波函数写作 $|\\Psi\\rangle = e^{T}|\\Phi_0\\rangle$，参考态 $|\\Phi_0\\rangle$ 是一个 Slater 行列式（例如，Hartree–Fock (HF) 参考态），簇算符在单激发和双激发处截断为 $T = T_1 + T_2$，其中 $T_1 = \\sum_{i,a} t_i^a a_a^\\dagger a_i$ 且 $T_2 = \\tfrac{1}{4} \\sum_{i,j,a,b} t_{ij}^{ab} a_a^\\dagger a_b^\\dagger a_j a_i$。振幅方程是通过将相似变换后的薛定谔方程 $\\bar{H}|\\Phi_0\\rangle = E|\\Phi_0\\rangle$（其中 $\\bar{H} = e^{-T} H e^{T}$）分别投影到单激发和双激发行列式 $|\\Phi_i^a\\rangle$ 和 $|\\Phi_{ij}^{ab}\\rangle$ 上得到的，从而产生关于残差 $R$ 的耦合非线性方程组 $R_i^a = 0$ 和 $R_{ij}^{ab} = 0$。假设使用正则轨道，从而零阶哈密顿量的单电子部分在分子轨道基下是对角的，轨道能为 $\\{\\varepsilon_p\\}$。\n\n仅根据这些原理推断，如果将振幅初始化为 $t_i^a = 0$ 和 $t_{ij}^{ab} = 0$，那么在第一次 Jacobi 更新中，残差中唯一的非零驱动项是来自于非对角 Fock 元 $f_{ai}$ 和反对称化双电子积分 $g_{ijab} \\equiv \\langle ij||ab\\rangle$ 的常数（与振幅无关的）贡献。通过分离这些常数项并除以零阶哈密顿量的相应对角元素（Møller–Plesset 分母），确定从零开始的 $t_i^a$ 和 $t_{ij}^{ab}$ 的唯一单次迭代更新。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n- 在自旋轨道表象中，使用上述原理实现从 $t=0$ 开始的 $t_i^a$ 和 $t_{ij}^{ab}$ 的恰好一次迭代更新。\n- 将占据轨道指数 $i,j$ 视为 $p \\in \\{0,\\dots,n_{\\text{occ}}-1\\}$，虚轨道指数 $a,b$ 视为 $p \\in \\{n_{\\text{occ}},\\dots,n_{\\text{orb}}-1\\}$，其中 $n_{\\text{orb}} = n_{\\text{occ}} + n_{\\text{virt}}$。\n- 接受程序中嵌入的输入，包括轨道能 $\\{\\varepsilon_p\\}$、分子轨道基下的 Fock 矩阵元 $f_{pq}$，以及反对称化双电子积分 $g_{pqrs} = \\langle pq||rs\\rangle = \\langle pq|rs\\rangle - \\langle pq|sr\\rangle$。\n- 从零初始化计算第一次迭代后的更新振幅。\n- 对每个测试用例，报告单激发张量和双激发张量的 Frobenius 范数，定义为 $\\|T_1\\|_F = \\sqrt{\\sum_{i,a} (t_i^a)^2}$ 和 $\\|T_2\\|_F = \\sqrt{\\sum_{i,j,a,b} (t_{ij}^{ab})^2}$。\n\n必须使用的假设和约定：\n- 使用正则轨道，因此 Fock 矩阵的对角线等于轨道能，即 $f_{pp} = \\varepsilon_p$；非对角元素可以非零。分母必须取自轨道能，即 $\\Delta_{i}^{a} = \\varepsilon_i - \\varepsilon_a$ 和 $\\Delta_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b$。\n- 初始振幅为 $t_i^a = 0$ 和 $t_{ij}^{ab} = 0$。\n- 每个测试用例中提供的反对称化双电子积分 $g_{pqrs}$，对于任何未明确指定的元素均为零。\n\n测试套件：\n实现程序以运行以下三个测试用例，每个用例都提供 $n_{\\text{occ}}$、$\\{\\varepsilon_p\\}$、$f_{pq}$ 和 $g_{pqrs}$。\n\n- 测试用例 1（非平凡的单激发和双激发，$n_{\\text{occ}} = 2$，$n_{\\text{virt}} = 2$，总 $n_{\\text{orb}} = 4$）：\n  - 轨道能：$\\varepsilon = [-1.0,\\,-0.5,\\,0.3,\\,0.7]$。\n  - Fock 矩阵元 $f_{pq}$：对所有 $p$，$f_{pp} = \\varepsilon_p$。非对角的非零元素：$f_{2,0} = 0.05$，$f_{3,1} = -0.02$，$f_{2,1} = 0.01$。所有其他非对角元素均为 $0$。\n  - 反对称化双电子积分 $g_{pqrs}$ 的非零元素（所有其他均为 $0$）：\n    - $g_{0,1,2,3} = 0.15$，\n    - $g_{1,0,2,3} = -0.15$，\n    - $g_{0,1,3,2} = -0.15$，\n    - $g_{1,0,3,2} = 0.15$。\n- 测试用例 2（零驱动项，$n_{\\text{occ}} = 2$，$n_{\\text{virt}} = 2$，总 $n_{\\text{orb}} = 4$）：\n  - 轨道能：$\\varepsilon = [-1.0,\\,-0.8,\\,0.5,\\,0.9]$。\n  - Fock 矩阵元 $f_{pq}$：对所有 $p$，$f_{pp} = \\varepsilon_p$，且当 $p \\neq q$ 时，$f_{pq} = 0$。\n  - 反对称化双电子积分 $g_{pqrs}$：所有元素均为 $0$。\n- 测试用例 3（近简并分母，$n_{\\text{occ}} = 2$，$n_{\\text{virt}} = 2$，总 $n_{\\text{orb}} = 4$）：\n  - 轨道能：$\\varepsilon = [-0.03,\\,-0.02,\\,0.00,\\,0.01]$。\n  - Fock 矩阵元 $f_{pq}$：对所有 $p$，$f_{pp} = \\varepsilon_p$。非对角的非零元素：$f_{2,0} = 0.002$，$f_{3,1} = -0.001$。所有其他非对角元素均为 $0$。\n  - 反对称化双电子积分 $g_{pqrs}$ 的非零元素（所有其他均为 $0$）：\n    - $g_{0,1,2,3} = 0.02$,\n    - $g_{1,0,2,3} = -0.02$,\n    - $g_{0,1,3,2} = -0.02$,\n    - $g_{1,0,3,2} = 0.02$。\n\n计算和输出要求：\n- 对于每个测试用例，使用基于残差常数项和 Møller–Plesset 分母逻辑推导出的 Jacobi 更新，从零开始计算一次迭代更新后的振幅 $t_i^a$ 和 $t_{ij}^{ab}$。\n- 对于每个测试用例，计算两个浮点数：$\\|T_1\\|_F$ 和 $\\|T_2\\|_F$。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序为 $[\\|T_1\\|_F^{(1)},\\|T_2\\|_F^{(1)},\\|T_1\\|_F^{(2)},\\|T_2\\|_F^{(2)},\\|T_1\\|_F^{(3)},\\|T_2\\|_F^{(3)}]$，其中上标 $(k)$ 表示测试用例 $k$。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于量子化学原理，特别是耦合簇 (CC) 理论，问题设定良好，具有唯一且有意义的解，并以客观、正式的语言表述。提供了完整解答所需的所有必要数据和条件。因此，我们可以进行正式的推导和求解。\n\n耦合簇理论的核心是电子波函数的指数拟设 $|\\Psi\\rangle = e^T |\\Phi_0\\rangle$，其中 $|\\Phi_0\\rangle$ 是一个单 Slater 行列式参考态，通常来自 Hartree-Fock 计算，而 $T$ 是簇算符。对于耦合簇单双激发 (CCSD)，簇算符被截断为仅包含单激发和双激发：$T = T_1 + T_2$。在二次量子化中，使用自旋轨道，这些算符定义为：\n$$\nT_1 = \\sum_{i,a} t_i^a a_a^\\dagger a_i\n$$\n$$\nT_2 = \\frac{1}{4} \\sum_{i,j,a,b} t_{ij}^{ab} a_a^\\dagger a_b^\\dagger a_j a_i\n$$\n此处，指数 $i, j, k, \\dots$ 表示占据轨道，而 $a, b, c, \\dots$ 表示虚（未占据）轨道。未知系数 $t_i^a$ 和 $t_{ij}^{ab}$ 分别是单激发和双激发振幅，必须被确定。\n\n振幅通过求解 CC 能量方程得到，该方程是将薛定谔方程投影到参考态上得出的：$E = \\langle \\Phi_0 | H | \\Psi \\rangle = \\langle \\Phi_0 | H e^T | \\Phi_0 \\rangle$。这可以利用相似变换后的哈密顿量 $\\bar{H} = e^{-T} H e^T$ 重写为 $\\bar{H} |\\Phi_0\\rangle = E |\\Phi_0\\rangle$。将此方程投影到单激发行列式 $|\\Phi_i^a\\rangle = a_a^\\dagger a_i |\\Phi_0\\rangle$ 和双激发行列式 $|\\Phi_{ij}^{ab}\\rangle = a_a^\\dagger a_b^\\dagger a_j a_i |\\Phi_0\\rangle$ 的空间上，即可得到振幅方程：\n$$\nR_i^a = \\langle \\Phi_i^a | \\bar{H} | \\Phi_0 \\rangle = 0\n$$\n$$\nR_{ij}^{ab} = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle = 0\n$$\n这些是单激发和双激发振幅的残差方程。它们构成一组耦合的非线性代数方程组，通常通过迭代方式求解。\n\n一种常见的迭代方案是类 Jacobi 更新。完整的残差方程可以结构化为：\n$$\nR_i^a = (\\varepsilon_a - \\varepsilon_i) t_i^a - \\text{terms independent of } t_i^a = 0\n$$\n$$\nR_{ij}^{ab} = (\\varepsilon_a + \\varepsilon_b - \\varepsilon_i - \\varepsilon_j) t_{ij}^{ab} - \\text{terms independent of } t_{ij}^{ab} = 0\n$$\n通过重排这些方程，可以定义一个迭代更新。一种简化的方法，常用于开始迭代，是基于当前残差计算一个校正量 $\\delta t$，然后除以雅可比矩阵的对角近似，即 Møller-Plesset 分母。\n第 $k+1$ 次迭代的振幅由第 $k$ 次迭代更新而来：\n$$ t_\\mu^{(k+1)} = t_\\mu^{(k)} + \\frac{R_\\mu(t^{(k)})}{D_\\mu} $$\n其中 $\\mu$ 是一个激发的通用索引（例如 $i \\to a$ 或 $ij \\to ab$），$R_\\mu$ 是对应的残差，$D_\\mu$ 是能量分母。问题要求从零振幅开始进行单次 Jacobi 迭代，即 $t_i^{a,(0)} = 0$ 和 $t_{ij}^{ab,(0)} = 0$。\n\n对于这第一次迭代 ($k=0$)，新的振幅为：\n$$\nt_i^{a,(1)} = \\frac{R_i^a(t=0)}{\\varepsilon_i - \\varepsilon_a}\n$$\n$$\nt_{ij}^{ab,(1)} = \\frac{R_{ij}^{ab}(t=0)}{\\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b}\n$$\n因此，问题简化为在零振幅下计算残差。当所有振幅均为零时，$T=0$，簇算符 $e^T$ 是单位算符 $e^0 = 1$。因此，相似变换后的哈密顿量变回原始哈密顿量，$\\bar{H} = e^{-0} H e^0 = H$。\n\n二次量子化中的哈密顿量为 $H = \\sum_{p,q} f_{pq} a_p^\\dagger a_q + \\frac{1}{4} \\sum_{p,q,r,s} g_{pqrs} a_p^\\dagger a_q^\\dagger a_s a_r$，其中 $f_{pq}$ 是 Fock 矩阵的元素，$g_{pqrs} = \\langle pq||rs \\rangle$ 是反对称化的双电子积分。\n因此，$t=0$ 时的残差为：\n$$\nR_i^a(t=0) = \\langle \\Phi_i^a | H | \\Phi_0 \\rangle\n$$\n$$\nR_{ij}^{ab}(t=0) = \\langle \\Phi_{ij}^{ab} | H | \\Phi_0 \\rangle\n$$\n根据 Slater-Condon 规则计算行列式之间的矩阵元：\n1.  单电子算符 $\\sum_{p,q} f_{pq} a_p^\\dagger a_q$ 连接最多相差一个轨道的行列式。$|\\Phi_0\\rangle$ 和 $|\\Phi_i^a\\rangle$ 之间的矩阵元是 $f_{ai}$。双电子算符不连接它们。\n2.  双电子算符 $\\frac{1}{4} \\sum_{p,q,r,s} g_{pqrs} a_p^\\dagger a_q^\\dagger a_s a_r$ 连接最多相差两个轨道的行列式。$|\\Phi_0\\rangle$ 和 $|\\Phi_{ij}^{ab}\\rangle$ 之间的矩阵元是 $g_{ijab}$。单电子算符不连接它们。\n\n因此，$t=0$ 时的残差简化为问题中提到的常数驱动项：\n$$\nR_i^a(t=0) = f_{ai}\n$$\n$$\nR_{ij}^{ab}(t=0) = g_{ijab}\n$$\n其中 $f_{ai}$ 是虚轨道 $a$ 和占据轨道 $i$ 之间的 Fock 矩阵元，$g_{ijab}$ 是反对称化的双电子积分。\n\n将这些代入更新方程，得到第一次迭代振幅的最终表达式：\n$$\nt_i^{a,(1)} = \\frac{f_{ai}}{\\varepsilon_i - \\varepsilon_a}\n$$\n$$\nt_{ij}^{ab,(1)} = \\frac{g_{ijab}}{\\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b}\n$$\n这些恰好是 Møller-Plesset 微扰理论 (MP2) 中一阶单激发和二阶双激发振幅的表达式。\n\n计算步骤如下：\n1.  对每个测试用例，解析提供的数据：占据轨道数 $n_{\\text{occ}}$、轨道能 $\\{\\varepsilon_p\\}$、非对角 Fock 矩阵元 $f_{pq}$ 和非零双电子积分 $g_{pqrs}$。总轨道数为 $n_{\\text{orb}}$，虚轨道数为 $n_{\\text{virt}} = n_{\\text{orb}} - n_{\\text{occ}}$。\n2.  将大小为 $(n_{\\text{occ}}, n_{\\text{virt}})$ 的单激发振幅张量 $T_1$ 和大小为 $(n_{\\text{occ}}, n_{\\text{occ}}, n_{\\text{virt}}, n_{\\text{virt}})$ 的双激发振幅张量 $T_2$ 初始化为零。\n3.  计算单激发振幅 $t_i^a$。遍历占据指数 $i \\in \\{0, \\dots, n_{\\text{occ}}-1\\}$ 和虚指数 $a \\in \\{n_{\\text{occ}}, \\dots, n_{\\text{orb}}-1\\}$。对每对 $(i, a)$，使用上述公式计算 $t_i^a$。Fock 矩阵元 $f_{ai}$ 从输入数据中检索；如果未指定，则为零。\n4.  计算双激发振幅 $t_{ij}^{ab}$。遍历所有占据指数对 $i,j$ 和虚指数对 $a,b$。对每个四元组 $(i,j,a,b)$，使用公式计算 $t_{ij}^{ab}$。积分 $g_{ijab}$ 从输入数据中检索；如果未指定，则为零。\n5.  填充张量 $T_1$ 和 $T_2$ 后，计算它们的 Frobenius 范数：$\\|T_1\\|_F = \\sqrt{\\sum_{i,a} (t_i^a)^2}$ 和 $\\|T_2\\|_F = \\sqrt{\\sum_{i,j,a,b} (t_{ij}^{ab})^2}$。\n6.  收集每个测试用例的两个范数，并将输出格式化为单个逗号分隔的列表。\n此过程直接实现了所推导的第一次迭代更新。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a single Jacobi iteration for CCSD amplitudes starting from zero,\n    and reports the Frobenius norms of the resulting T1 and T2 tensors.\n    \"\"\"\n    test_cases = [\n        # Test case 1: Nontrivial singles and doubles\n        {\n            \"n_occ\": 2,\n            \"eps\": np.array([-1.0, -0.5, 0.3, 0.7]),\n            \"f_offdiag\": {(2, 0): 0.05, (3, 1): -0.02, (2, 1): 0.01},\n            \"g_nonzero\": {\n                (0, 1, 2, 3): 0.15,\n                (1, 0, 2, 3): -0.15,\n                (0, 1, 3, 2): -0.15,\n                (1, 0, 3, 2): 0.15,\n            },\n        },\n        # Test case 2: Zero driving terms\n        {\n            \"n_occ\": 2,\n            \"eps\": np.array([-1.0, -0.8, 0.5, 0.9]),\n            \"f_offdiag\": {},\n            \"g_nonzero\": {},\n        },\n        # Test case 3: Near-degenerate denominators\n        {\n            \"n_occ\": 2,\n            \"eps\": np.array([-0.03, -0.02, 0.00, 0.01]),\n            \"f_offdiag\": {(2, 0): 0.002, (3, 1): -0.001},\n            \"g_nonzero\": {\n                (0, 1, 2, 3): 0.02,\n                (1, 0, 2, 3): -0.02,\n                (0, 1, 3, 2): -0.02,\n                (1, 0, 3, 2): 0.02,\n            },\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        n_occ = case[\"n_occ\"]\n        eps = case[\"eps\"]\n        n_orb = len(eps)\n        n_virt = n_orb - n_occ\n\n        # --- Singles Amplitudes T1 ---\n        # The T1 tensor has dimensions (n_occ, n_virt).\n        t1 = np.zeros((n_occ, n_virt))\n        f_offdiag = case[\"f_offdiag\"]\n        \n        # Iterate over occupied indices (i) and virtual indices (a).\n        # We use relative indices for the tensor (0..n_virt-1 for a)\n        # and absolute orbital indices for lookups in eps, f, g.\n        for i in range(n_occ):\n            for a_rel in range(n_virt):\n                a_abs = a_rel + n_occ\n                \n                # Numerator is the off-diagonal Fock element f_ai\n                f_val = f_offdiag.get((a_abs, i), 0.0)\n\n                if f_val != 0.0:\n                    denominator = eps[i] - eps[a_abs]\n                    # The problem setup ensures denominators are non-zero.\n                    if denominator != 0.0:\n                        t1[i, a_rel] = f_val / denominator\n                        \n        norm_t1 = np.linalg.norm(t1)\n\n        # --- Doubles Amplitudes T2 ---\n        # The T2 tensor has dimensions (n_occ, n_occ, n_virt, n_virt).\n        t2 = np.zeros((n_occ, n_occ, n_virt, n_virt))\n        g_nonzero = case[\"g_nonzero\"]\n        \n        # Iterate over all pairs of occupied (i,j) and virtual (a,b) indices.\n        for i in range(n_occ):\n            for j in range(n_occ):\n                for a_rel in range(n_virt):\n                    a_abs = a_rel + n_occ\n                    for b_rel in range(n_virt):\n                        b_abs = b_rel + n_occ\n                        \n                        # Numerator is the antisymmetrized integral g_ijab\n                        key = (i, j, a_abs, b_abs)\n                        g_val = g_nonzero.get(key, 0.0)\n\n                        if g_val != 0.0:\n                            denominator = eps[i] + eps[j] - eps[a_abs] - eps[b_abs]\n                            if denominator != 0.0:\n                                t2[i, j, a_rel, b_rel] = g_val / denominator\n\n        norm_t2 = np.linalg.norm(t2)\n        \n        results.extend([norm_t1, norm_t2])\n\n    # Format the final output string as specified.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2453734"}]}