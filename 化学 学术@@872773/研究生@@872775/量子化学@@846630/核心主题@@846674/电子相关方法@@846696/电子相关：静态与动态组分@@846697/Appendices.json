{"hands_on_practices": [{"introduction": "我们从最简单的化学键——氢分子中的化学键——开始。本练习使用一个最小模型和 Rayleigh-Schrödinger 微扰理论，为我们提供了一个基础性的、解析性的视角，来观察电子相关是如何产生的。通过计算二级能量校正，您将具体理解激发电子态的混合如何稳定共价键，以及为何这种图像在键断裂过程中会失效，从而引入静态相关的概念。[@problem_id:2962803]", "problem": "一个处于平衡核间距的氢分子 $\\mathrm{H}_{2}$ 在最小基组下建模，该模型包含一个单电子能量为 $\\varepsilon_{g}$、被双电子占据的成键分子轨道 $\\sigma_{g}$，以及一个相应的单电子能量为 $\\varepsilon_{u}$ 的反键虚分子轨道 $\\sigma_{u}$。将 Hartree-Fock (HF) 行列式作为零阶参考态，并根据 Rayleigh-Schrödinger 微扰理论，将超出 HF 理论的剩余电子-电子相互作用视为微扰。在此最小描述中，对于闭壳层参考态，单激发对二阶能量没有贡献，主要的关联修正来自于唯一的双激发 $\\sigma_{g}^{2} \\rightarrow \\sigma_{u}^{2}$。\n\n在平衡分离距离处，您将获得以下光谱级精度的数据：\n- 轨道能隙为 $\\Delta \\equiv \\varepsilon_{u} - \\varepsilon_{g} = 0.50\\,E_{h}$，其中 $E_{h}$ 是 Hartree 能量。\n- 驱动 $\\sigma_{g}^{2} \\rightarrow \\sigma_{u}^{2}$ 混合的反对称化双电子积分的大小为 $M \\equiv |\\langle gg \\Vert uu \\rangle| = 0.198\\,E_{h}$。\n- 对于分离的氢原子，关联能为零。\n\n仅使用所述基础（以 Hartree-Fock 作为零阶态和 Rayleigh-Schrödinger 微扰理论），估算在平衡状态下，二阶电子关联对 $\\mathrm{H}_{2}$ 共价键解离能的贡献。以正数形式报告结果，单位为 $\\mathrm{kJ\\,mol^{-1}}$。使用换算关系 $1\\,E_{h} = 2625.5\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n此外，基于双组态推理，论证当化学键被拉伸至解离时，哪种电子关联组分——静态（近简并）关联还是动态（短程库仑）关联——预计将占主导地位。你的论证应该是概念性的，并源于相同的微扰起点，但你最终报告的答案必须仅为所要求的数值估算。\n\n将你报告的数值答案四舍五入到四位有效数字。", "solution": "问题陈述已经过评估并被确定为有效。这是一个在量子化学领域科学上合理、提法恰当且客观的问题。它提供了一套自洽的数据和原理，以得出一个唯一且有意义的解。\n\n问题要求在最小基组模型内，计算二阶电子关联能对氢分子 $\\mathrm{H}_{2}$ 键解离能的贡献。理论框架被指定为 Rayleigh-Schrödinger 微扰理论，以 Hartree-Fock (HF) 基态作为零阶参考。\n\n零阶参考态是对应于电子构型 $\\sigma_{g}^{2}$ 的 HF 行列式 $|\\Phi_{0}\\rangle$。零阶能量是已占据轨道的轨道能量之和，$E_{0}^{(0)} = 2\\varepsilon_{g}$。微扰 $\\hat{V}$ 是真实电子哈密顿算符与虚构的 HF 算符之间的差值。\n\n能量的二阶修正 $E^{(2)}$ 由微扰理论的通用公式给出：\n$$ E^{(2)} = \\sum_{I \\neq 0} \\frac{|\\langle \\Phi_{I} | \\hat{V} | \\Phi_{0} \\rangle|^{2}}{E_{0}^{(0)} - E_{I}^{(0)}} $$\n其中 $|\\Phi_{I}\\rangle$ 是激发行列式，其相应的零阶能量为 $E_{I}^{(0)}$。\n\n对于给定的 $\\mathrm{H}_{2}$ 最小基组模型，该模型由一个已占据的成键分子轨道（$\\sigma_{g}$）和一个虚反键分子轨道（$\\sigma_{u}$）组成，从闭壳层基态 $|\\Phi_0\\rangle = |\\sigma_{g}\\alpha \\, \\sigma_{g}\\beta \\rangle$ 到双激发行列式的唯一可能激发是到 $|\\Phi_{D}\\rangle = |\\sigma_{u}\\alpha \\, \\sigma_{u}\\beta \\rangle$。问题陈述正确地指出，根据 Brillouin 定理，单激发对二阶能量没有贡献。\n\n激发态 $|\\Phi_{D}\\rangle$ 的零阶能量为 $E_{D}^{(0)} = 2\\varepsilon_{u}$。因此，微扰公式中的能量分母为：\n$$ E_{0}^{(0)} - E_{D}^{(0)} = 2\\varepsilon_{g} - 2\\varepsilon_{u} = -2(\\varepsilon_{u} - \\varepsilon_{g}) = -2\\Delta $$\n其中 $\\Delta$ 是给定的轨道能隙，$\\Delta = \\varepsilon_{u} - \\varepsilon_{g} = 0.50\\,E_{h}$。\n\n分子需要矩阵元 $\\langle \\Phi_{D} | \\hat{V} | \\Phi_{0} \\rangle$。对于双激发，这等价于 $\\langle \\Phi_{D} | \\hat{H} | \\Phi_{0} \\rangle$，其中 $\\hat{H}$ 是完整的电子哈密顿算符。根据处理相差两个自旋轨道（$\\sigma_{g}\\alpha \\rightarrow \\sigma_{u}\\alpha$ 和 $\\sigma_{g}\\beta \\rightarrow \\sigma_{u}\\beta$）的行列式之间矩阵元的 Slater-Condon 规则，该矩阵元在化学家标记法中简化为单个双电子积分：\n$$ \\langle \\Phi_{D} | \\hat{H} | \\Phi_{0} \\rangle = (\\sigma_{g}\\sigma_{u}|\\sigma_{g}\\sigma_{u}) = \\iint \\sigma_{g}^{*}(1)\\sigma_{u}(1) \\frac{1}{r_{12}} \\sigma_{g}^{*}(2)\\sigma_{u}(2) \\, d\\mathbf{r}_{1}d\\mathbf{r}_{2} $$\n这个积分通常表示为交换型积分 $K_{gu}$。问题提供了驱动混合的积分大小为 $M \\equiv |\\langle gg \\Vert uu \\rangle| = 0.198\\,E_{h}$。在混合 $|\\sigma_{g}^{2}\\rangle$ 和 $|\\sigma_{u}^{2}\\rangle$ 构型的微扰背景下，这个量 $M$ 必须被认同为非对角哈密顿矩阵元的大小，即 $|K_{gu}|$。\n\n将这些组分代入二阶能量公式，得到 $\\mathrm{H}_{2}$ 分子在平衡分离距离处的关联能：\n$$ E_{\\text{corr, eq}}^{(2)} = \\frac{|K_{gu}|^{2}}{-2\\Delta} = -\\frac{M^{2}}{2\\Delta} $$\n使用所提供的数据：\n$$ E_{\\text{corr, eq}}^{(2)} = -\\frac{(0.198\\,E_{h})^{2}}{2(0.50\\,E_{h})} = -0.039204\\,E_{h} $$\n\n问题要求计算电子关联对键解离能 $D_{e}$ 的贡献。键解离能定义为分离原子的能量减去分子的能量：$D_{e} = E(\\text{atoms}) - E(\\text{molecule})$。总能量可以分解为 HF 组分和关联组分：\n$$ D_{e} = [E_{\\text{HF}}(\\text{atoms}) + E_{\\text{corr}}(\\text{atoms})] - [E_{\\text{HF}}(\\mathrm{H}_{2}) + E_{\\text{corr}}(\\mathrm{H}_{2})] $$\n$$ D_{e} = [E_{\\text{HF}}(\\text{atoms}) - E_{\\text{HF}}(\\mathrm{H}_{2})] + [E_{\\text{corr}}(\\text{atoms}) - E_{\\text{corr}}(\\mathrm{H}_{2})] $$\n$[E_{\\text{corr}}(\\text{atoms}) - E_{\\text{corr}}(\\mathrm{H}_{2})]$ 项是关联能对键解离能的贡献。问题正确地指出，对于分离的氢原子（它们是单电子体系），关联能为零：$E_{\\text{corr}}(\\text{atoms}) = 0$。使用我们对分子关联能的二阶估计 $E_{\\text{corr}}(\\mathrm{H}_{2}) \\approx E_{\\text{corr, eq}}^{(2)}$，其贡献为：\n$$ \\Delta D_{e, \\text{corr}} = 0 - E_{\\text{corr, eq}}^{(2)} = -(-0.039204\\,E_{h}) = 0.039204\\,E_{h} $$\n正号表示电子关联降低了分子的能量，从而增加了其稳定性以及解离它所需的能量。\n\n为了以所要求的单位 $\\mathrm{kJ\\,mol^{-1}}$ 报告结果，我们使用换算因子 $1\\,E_{h} = 2625.5\\,\\mathrm{kJ\\,mol^{-1}}$：\n$$ \\Delta D_{e, \\text{corr}} = 0.039204 \\times 2625.5\\,\\mathrm{kJ\\,mol^{-1}} \\approx 102.923\\,\\mathrm{kJ\\,mol^{-1}} $$\n四舍五入到四位有效数字，结果为 $102.9\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n对于问题的第二部分，即关于键拉伸过程中占主导地位的电子关联类型，我们分析双组态模型的行为。在平衡位置，能隙 $\\Delta$ 很大，使得 HF 构型 $|\\sigma_{g}^{2}\\rangle$ 成为一个很好的零阶描述。与 $|\\sigma_{u}^{2}\\rangle$ 混合产生的修正很小，它解释了电子的动态回避行为，这被称为**动态关联**。\n\n随着核间距 $R$ 增大并趋于解离（$R \\rightarrow \\infty$），形成分子轨道的原子轨道（$1s_{A}$ 和 $1s_{B}$）不再重叠。这导致成键（$\\sigma_{g}$）和反键（$\\sigma_{u}$）轨道的能量变得简并：$\\varepsilon_{g} \\rightarrow \\varepsilon_{u}$，这意味着 $\\Delta \\rightarrow 0$。\n微扰理论能量表达式中的分母 $-2\\Delta$ 趋近于零。这导致了发散，标志着单参考微扰理论的失效。这种失效的物理原因是，这两个构型 $|\\sigma_{g}^{2}\\rangle$ 和 $|\\sigma_{u}^{2}\\rangle$ 在能量上不再是良好分离的；它们变得简并。在这种情况下，对电子结构的定性正确描述需要一个多组态波函数，即简并或近简并行列式的线性组合。为了获得定性正确的描述（尤其是在断键时），需要在零阶波函数中包含多个行列式，由此产生的关联效应被称为**静态关联**（或近简并关联）。因此，当键被拉伸时，静态关联成为必须解决的主导效应。Hartree-Fock 方法本身在这个极限下会灾难性地失败，错误地将解离描述为中性原子和离子物种（$\\mathrm{H}^{+}\\mathrm{H}^{-}$）的混合物。", "answer": "$$\n\\boxed{102.9}\n$$", "id": "2962803"}, {"introduction": "虽然基础模型富有洞察力，但真实的计算化学研究需要强大的工具来分析复杂的势能面。本练习将静态和动态相关的概念付诸实践，为您提供了一系列综合的计算数据。您将实现一种通用的方案来分解总相关能，并应用标准诊断方法，如 $T_1$ 诊断和自然轨道占据数分析，来定量评估一个体系的多参考特性。[@problem_id:2888416]", "problem": "您将获得三个小型的、合成的势能面（PES）数据集，旨在探讨电子相关，重点关注其静态和动态组分。您的任务是，在代码中实现一个基于标准定义的、有原则的能量分解和 PES 误差分析，并评估用于标记多参考特征的实用诊断方法。所有能量均以 Hartree（原子单位）处理。您的程序必须为每个数据集计算所要求的指标，并将所有数据集的结果汇总为文末指定的单一必需输出格式。所有浮点数答案必须四舍五入到六位小数，并在适用的情况下以 Hartree 表示。\n\n基本依据和核心定义：\n- Born-Oppenheimer 势能面是由电子薛定谔方程的电子基态解产生的、关于核几何构型 $R$ 的函数 $E(R)$。对于给定的电子哈密顿量和基组，令 $E_{\\mathrm{ref}}(R)$ 表示高精度参考能量（例如，完全组态相互作用 (FCI)），$E_{\\mathrm{HF}}(R)$ 表示 Hartree-Fock (HF) 能量，$E_{\\mathrm{MP2}}(R)$ 表示 Møller-Plesset 二阶微扰理论 (MP2) 能量。\n- 在几何构型 $R$ 处，相对于 Hartree-Fock 的相关能定义为 $E_{\\mathrm{corr}}(R) = E_{\\mathrm{ref}}(R) - E_{\\mathrm{HF}}(R)$。\n- 为了获得一个分解为动态组分和静态组分的实用方法，假定如下：\n  1. 当单参考假设成立时，MP2 相关能的大小近似于动态组分。定义 $E_{\\mathrm{corr}}^{(2)}(R) = E_{\\mathrm{MP2}}(R) - E_{\\mathrm{HF}}(R)$。\n  2. 动态相关能的估计值被约束，其绝对值不能超过参考相关能的绝对值。定义\n     $$E_{\\mathrm{dyn}}(R) = \\operatorname{sign}\\!\\big(E_{\\mathrm{corr}}(R)\\big)\\,\\min\\!\\left(\\left|E_{\\mathrm{corr}}(R)\\right|,\\;\\max\\!\\left(0,\\left|E_{\\mathrm{corr}}^{(2)}(R)\\right|\\right)\\right).$$\n  3. 静态相关能的估计值是剩余部分：\n     $$E_{\\mathrm{stat}}(R) = E_{\\mathrm{corr}}(R) - E_{\\mathrm{dyn}}(R).$$\n- 对于方法 $X$，在一组离散的几何构型 $\\{R_i\\}_{i=1}^N$ 上，相对于一个固定的参考，其势能面非平行性误差（NPE）定义为\n  $$\\mathrm{NPE}_X = \\max_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right| \\;-\\; \\min_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right|.$$\n- 一种基于自然轨道占据数（NOONs）的实用多参考诊断方法：给定满足 $\\sum_j n_j(R) = N_e$ 电子的自旋加和占据数 $\\{n_j(R)\\}$，定义\n  $$M(R) = \\frac{1}{N_e}\\sum_j \\min\\!\\left(n_j(R),\\,2 - n_j(R)\\right).$$\n  更大的 $M(R)$ 表示更强的近简并性（静态相关）。\n- 一个补充的单参考稳定性诊断是来自耦合簇理论的 $T_1$ 诊断，此处按每个几何构型作为数据提供。通常的做法是，当闭壳层分子的 $\\max_R T_1(R) \\gtrsim 0.02$ 时发出警示；这里采用此阈值。\n\n每个数据集所需的计算：\n- 计算 $\\mathrm{NPE}_{\\mathrm{HF}}$ 和 $\\mathrm{NPE}_{\\mathrm{MP2}}$，单位为 Hartree。\n- 计算在所有几何构型上的平均绝对静态和动态相关能大小，即\n  $$\\overline{|E_{\\mathrm{stat}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{stat}}(R_i)\\right|,\\qquad \\overline{|E_{\\mathrm{dyn}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{dyn}}(R_i)\\right|,$$\n  以 Hartree 报告。\n- 计算一个布尔标志 `needs_multireference`，如果 $\\max_i T_1(R_i) > 0.02$ 或 $\\max_i M(R_i) > 0.15$，则其为 true，否则为 false。\n\n测试套件：\n实现您的程序，以精确处理以下三个数据集。每个数据集包含：\n- 一组标记为 $R_1,\\dots,R_N$ 的几何构型（仅为标签；实际距离无需使用）。\n- 参考能量 $E_{\\mathrm{ref}}(R_i)$、HF 能量 $E_{\\mathrm{HF}}(R_i)$ 和 MP2 能量 $E_{\\mathrm{MP2}}(R_i)$，单位为 Hartree。\n- 每个几何构型的自然轨道占据数，形式为自旋加和的 NOONs 列表，其和为 $N_e$。\n- 每个几何构型的 $T_1$ 诊断值（无量纲）。\n- 电子总数 $N_e$（一个整数）。\n\n数据集 A（类双原子扫描，含两个电子）：\n- $E_{\\mathrm{ref}}$: $[-0.90,\\,-1.1746,\\,-1.1400,\\,-1.0300,\\,-1.0000]$。\n- $E_{\\mathrm{HF}}$: $[-0.88,\\,-1.1167,\\,-1.0900,\\,-0.9850,\\,-0.9500]$。\n- $E_{\\mathrm{MP2}}$: $[-0.8980,\\,-1.1697,\\,-1.1380,\\,-0.9950,\\,-0.9510]$。\n- 每个几何构型的 NOONs：\n  - $[1.99,\\,0.01]$,\n  - $[1.90,\\,0.10]$,\n  - $[1.80,\\,0.20]$,\n  - $[1.20,\\,0.80]$,\n  - $[1.00,\\,1.00]$.\n- $T_1$: $[0.005,\\,0.010,\\,0.015,\\,0.030,\\,0.040]$。\n- $N_e = 2$.\n\n数据集 B（弱相关扫描，含两个电子）：\n- $E_{\\mathrm{ref}}$: $[-1.05,\\,-1.10,\\,-1.08]$。\n- $E_{\\mathrm{HF}}$: $[-1.03,\\,-1.08,\\,-1.06]$。\n- $E_{\\mathrm{MP2}}$: $[-1.049,\\,-1.099,\\,-1.079]$。\n- 每个几何构型的 NOONs：\n  - $[1.98,\\,0.02]$,\n  - $[1.98,\\,0.02]$,\n  - $[1.98,\\,0.02]$.\n- $T_1$: $[0.005,\\,0.006,\\,0.005]$。\n- $N_e = 2$.\n\n数据集 C（小相关且 MP2 过冲的边缘案例，含两个电子）：\n- $E_{\\mathrm{ref}}$: $[-0.700,\\,-0.720,\\,-0.710,\\,-0.705]$。\n- $E_{\\mathrm{HF}}$: $[-0.698,\\,-0.718,\\,-0.708,\\,-0.703]$。\n- $E_{\\mathrm{MP2}}$: $[-0.701,\\,-0.724,\\,-0.713,\\,-0.707]$。\n- 每个几何构型的 NOONs：\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$.\n- $T_1$: $[0.004,\\,0.005,\\,0.004,\\,0.005]$。\n- $N_e = 2$.\n\n输出规格：\n- 对于每个数据集，按以下顺序生成一个包含五个元素的列表：\n  1. $\\mathrm{NPE}_{\\mathrm{HF}}$ (浮点数, Hartree, 四舍五入到六位小数)。\n  2. $\\mathrm{NPE}_{\\mathrm{MP2}}$ (浮点数, Hartree, 四舍五入到六位小数)。\n  3. $\\overline{|E_{\\mathrm{stat}}|}$ (浮点数, Hartree, 四舍五入到六位小数)。\n  4. $\\overline{|E_{\\mathrm{dyn}}|}$ (浮点数, Hartree, 四舍五入到六位小数)。\n  5. needs_multireference (布尔值)。\n- 您的程序应生成单行输出，其中包含结果，形式为由逗号分隔的三个数据集列表，并用方括号括起来（例如，\"[[...],[...],[...]]\"）。所有浮点输出必须以 Hartree 表示并四舍五入到六位小数。角度未使用。不要打印任何附加文本。", "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个在计算量子化学领域中提法明确、有科学依据的问题。它为一系列计算提供了明确的数学定义和完整的数据集。任务是实现这些计算并以指定格式生成结果。未发现逻辑矛盾、信息缺失或科学不准确之处。\n\n该解决方案要求实现一个计算协议，以分析三个合成的势能面（PES）数据集。分析的核心是量化电子相关效应、方法性能以及多参考特征的诊断。该过程将对每个数据集执行，并且结果将被汇总。\n\n计算步骤如下，严格遵守所提供的定义。对于一个包含 $N$ 个几何构型 $\\{R_i\\}_{i=1}^N$ 的给定数据集，我们已知参考能量 $E_{\\mathrm{ref}}(R_i)$、Hartree-Fock 能量 $E_{\\mathrm{HF}}(R_i)$、Møller-Plesset 二阶 (MP2) 能量 $E_{\\mathrm{MP2}}(R_i)$、自然轨道占据数 (NOONs) $\\{n_j(R_i)\\}$ 和 $T_1$ 诊断值 $T_1(R_i)$。\n\n首先，我们为每个点 $R_i$ 计算几个基于几何构型的量：\n1.  总相关能，定义为精确参考能量与平均场 Hartree-Fock 能量之间的差值：\n    $$E_{\\mathrm{corr}}(R_i) = E_{\\mathrm{ref}}(R_i) - E_{\\mathrm{HF}}(R_i)$$\n2.  MP2 相关能，它作为动态相关的一个实用估计：\n    $$E_{\\mathrm{corr}}^{(2)}(R_i) = E_{\\mathrm{MP2}}(R_i) - E_{\\mathrm{HF}}(R_i)$$\n3.  动态相关能 $E_{\\mathrm{dyn}}(R_i)$，由一个约束公式定义，该公式防止 MP2 估计值的量级非物理地超过真实相关能的量级：\n    $$E_{\\mathrm{dyn}}(R_i) = \\operatorname{sign}\\!\\big(E_{\\mathrm{corr}}(R_i)\\big)\\,\\min\\!\\left(\\left|E_{\\mathrm{corr}}(R_i)\\right|,\\;\\max\\!\\left(0,\\left|E_{\\mathrm{corr}}^{(2)}(R_i)\\right|\\right)\\right)$$\n    $\\max(0, \\dots)$ 项确保动态相关估计值的量级为非负，这符合物理要求。$\\min(\\dots)$ 项正确处理了 MP2 高估相关能的情况。\n4.  静态相关能 $E_{\\mathrm{stat}}(R_i)$，定义为总相关能减去动态组分后的剩余部分：\n    $$E_{\\mathrm{stat}}(R_i) = E_{\\mathrm{corr}}(R_i) - E_{\\mathrm{dyn}}(R_i)$$\n    该组分捕捉了由电子态近简并引起的效应，而像 Hartree-Fock 和 MP2 这样的单参考方法很难描述这些效应。\n5.  多参考诊断 $M(R_i)$，它通过自然轨道占据数（NOONs）与整数值（$0$ 或 $2$）的偏差来量化静态相关特征的程度：\n    $$M(R_i) = \\frac{1}{N_e}\\sum_j \\min\\!\\left(n_j(R_i),\\,2 - n_j(R_i)\\right)$$\n    其中 $N_e$ 是电子总数。\n\n接下来，我们计算表征整个 PES 的所需指标，用于给定的方法或属性：\n1.  方法 $X \\in \\{\\mathrm{HF}, \\mathrm{MP2}\\}$ 的非平行性误差（NPE）。该指标衡量了方法误差在整个 PES 上的不均匀性，这通常比平均误差本身更为关键。其定义为：\n    $$\\mathrm{NPE}_X = \\max_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right| \\;-\\; \\min_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right|$$\n    我们将计算 $\\mathrm{NPE}_{\\mathrm{HF}}$ 和 $\\mathrm{NPE}_{\\mathrm{MP2}}$。\n2.  平均绝对静态和动态相关能，它们提供了这些效应在整个 PES 上重要性的总体度量：\n    $$\\overline{|E_{\\mathrm{stat}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{stat}}(R_i)\\right|$$\n    $$\\overline{|E_{\\mathrm{dyn}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{dyn}}(R_i)\\right|$$\n3.  一个布尔标志 `needs_multireference`，用于指示显著的多参考特征。如果最大 $T_1$ 诊断超过其典型阈值，或者最大 $M(R)$ 诊断超过其阈值，则此标志设置为 true：\n    $$\\text{needs\\_multireference} = (\\max_i T_1(R_i) > 0.02) \\lor (\\max_i M(R_i) > 0.15)$$\n\n该实现将在 Python 中进行，利用 `numpy` 库对能量数组进行高效的矢量化操作。一个单一的函数将通过顺序应用上述公式来处理每个数据集。所得的浮点值将四舍五入到六位小数，最终输出将按规定格式化为单个字符串。这种对既定原则的严谨、分步应用确保了解决方案的正确性和可复现性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all datasets and print the final result.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {\n            \"name\": \"A\",\n            \"E_ref\": np.array([-0.90, -1.1746, -1.1400, -1.0300, -1.0000]),\n            \"E_HF\":  np.array([-0.88, -1.1167, -1.0900, -0.9850, -0.9500]),\n            \"E_MP2\": np.array([-0.8980, -1.1697, -1.1380, -0.9950, -0.9510]),\n            \"noons\": [\n                [1.99, 0.01], [1.90, 0.10], [1.80, 0.20], \n                [1.20, 0.80], [1.00, 1.00]\n            ],\n            \"T1\": np.array([0.005, 0.010, 0.015, 0.030, 0.040]),\n            \"Ne\": 2\n        },\n        # Dataset B\n        {\n            \"name\": \"B\",\n            \"E_ref\": np.array([-1.05, -1.10, -1.08]),\n            \"E_HF\":  np.array([-1.03, -1.08, -1.06]),\n            \"E_MP2\": np.array([-1.049, -1.099, -1.079]),\n            \"noons\": [\n                [1.98, 0.02], [1.98, 0.02], [1.98, 0.02]\n            ],\n            \"T1\": np.array([0.005, 0.006, 0.005]),\n            \"Ne\": 2\n        },\n        # Dataset C\n        {\n            \"name\": \"C\",\n            \"E_ref\": np.array([-0.700, -0.720, -0.710, -0.705]),\n            \"E_HF\":  np.array([-0.698, -0.718, -0.708, -0.703]),\n            \"E_MP2\": np.array([-0.701, -0.724, -0.713, -0.707]),\n            \"noons\": [\n                [1.99, 0.01], [1.99, 0.01], [1.99, 0.01], [1.99, 0.01]\n            ],\n            \"T1\": np.array([0.004, 0.005, 0.004, 0.005]),\n            \"Ne\": 2\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_dataset(case)\n        results.append(result)\n\n    # Format each individual result list into a string '[e1,e2,...]'\n    # This is done to ensure correct rounding and no spaces.\n    formatted_results = []\n    for res_list in results:\n        str_elements = [\n            f\"{res_list[0]:.6f}\",\n            f\"{res_list[1]:.6f}\",\n            f\"{res_list[2]:.6f}\",\n            f\"{res_list[3]:.6f}\",\n            \"true\" if res_list[4] else \"false\"\n        ]\n        formatted_results.append(f\"[{','.join(str_elements)}]\")\n    \n    # Final print statement in the exact required format '[[...],[...]]'\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef process_dataset(data: dict) -> list:\n    \"\"\"\n    Computes all required metrics for a single dataset.\n    \n    Args:\n        data: A dictionary containing all data for one PES scan.\n\n    Returns:\n        A list of the 5 computed metrics in the specified order.\n    \"\"\"\n    E_ref = data[\"E_ref\"]\n    E_HF = data[\"E_HF\"]\n    E_MP2 = data[\"E_MP2\"]\n    noons_list = data[\"noons\"]\n    T1 = data[\"T1\"]\n    Ne = data[\"Ne\"]\n\n    # --- Per-geometry calculations ---\n    \n    # Correlation energies\n    E_corr = E_ref - E_HF\n    E_corr_2 = E_MP2 - E_HF\n\n    # Dynamic and static correlation with constraints\n    E_dyn_abs = np.minimum(np.abs(E_corr), np.maximum(0, np.abs(E_corr_2)))\n    E_dyn = np.sign(E_corr) * E_dyn_abs\n    E_stat = E_corr - E_dyn\n\n    # M diagnostic\n    M_values = []\n    for noons in noons_list:\n        m_sum = sum(min(n, 2 - n) for n in noons)\n        M_values.append(m_sum / Ne)\n    M = np.array(M_values)\n\n    # --- Dataset-wide metrics ---\n    \n    # Non-Parallelity Error (NPE)\n    abs_err_HF = np.abs(E_HF - E_ref)\n    npe_hf = np.max(abs_err_HF) - np.min(abs_err_HF)\n    \n    abs_err_MP2 = np.abs(E_MP2 - E_ref)\n    npe_mp2 = np.max(abs_err_MP2) - np.min(abs_err_MP2)\n\n    # Average absolute static and dynamic correlation\n    avg_abs_E_stat = np.mean(np.abs(E_stat))\n    avg_abs_E_dyn = np.mean(np.abs(E_dyn))\n\n    # Multi-reference flag\n    needs_multireference = (np.max(T1) > 0.02) or (np.max(M) > 0.15)\n    \n    return [\n        npe_hf,\n        npe_mp2,\n        avg_abs_E_stat,\n        avg_abs_E_dyn,\n        needs_multireference\n    ]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2888416"}, {"introduction": "对这些概念的真正考验在于将它们应用于电子相关效应显著的、具有化学挑战性的体系中。本练习聚焦于一个典型的双自由基体，在这种体系中，强的静态相关使得对其单重态的描述变得异常困难。通过计算并比较不同量子化学方法得出的垂直单重态-三重态能隙，您将批判性地评估这些方法处理电子相关的不同策略如何影响它们在此类多参考问题上的准确性。[@problem_id:2770423]", "problem": "考虑一个在玻恩-奥本海默近似下，处于优化的单重态参考结构所对应的固定核几何下的原型双自由基体。给定使用多种电子结构方法计算的最低单重态和三重态的单点电子能量（单位为哈特里），以及非限制性哈特里-福克（UHF）态的自旋期望值。所有能量都对应于相同的核几何，因此适用于垂直能隙分析。\n\n定义和数据：\n- 垂直单重态-三重态能隙定义为 $\\Delta E_{ST} = E_{T}(R_{S}) - E_{S}(R_{S})$，其中 $E_{S}(R_{S})$ 和 $E_{T}(R_{S})$ 是在单重态几何 $R_{S}$ 处计算的单重态和三重态电子能量。\n- 非限制性哈特里-福克（UHF）：\n  - 破缺对称性单重态解：$E_{\\mathrm{BS}}^{\\mathrm{UHF}} = -152.497800$，$\\langle \\hat{S}^{2} \\rangle_{\\mathrm{BS}} = 0.92$。\n  - 高自旋三重态解：$E_{T}^{\\mathrm{UHF}} = -152.497300$，$\\langle \\hat{S}^{2} \\rangle_{T} = 2.02$。\n  - 使用基于 $\\langle \\hat{S}^{2} \\rangle$ 值的近似自旋投影，从破缺对称性UHF解和UHF三重态来估计一个纯自旋单重态能量。\n- 基于高自旋三重态参考态的自旋翻转运动方程耦合簇单双激发（EOM-SF-CCSD）：\n  - $E_{S}^{\\mathrm{SF\\text{-}CCSD}} = -152.500000$， $E_{T}^{\\mathrm{SF\\text{-}CCSD}} = -152.498092$。\n- 完全活性空间自洽场（CASSCF）与(2,2)活性空间，后接二阶微扰理论（CASPT2）：\n  - $E_{S}^{\\mathrm{CASPT2}} = -152.521300$， $E_{T}^{\\mathrm{CASPT2}} = -152.518700$。\n- 换算因子：$1$ 哈特里 $= 627.5095$ 千卡/摩尔。\n\n任务：\n1. 从自旋对称性和 $\\hat{S}^{2}$ 期望值的第一性原理出发，推导一个近似表达式，用给定的 $\\langle \\hat{S}^{2} \\rangle$ 值和UHF三重态能量，从破缺对称性UHF解中获得纯自旋 $S=0$ 的能量。用此计算基于UHF的垂直单重态-三重态能隙 $\\Delta E_{ST}^{\\mathrm{UHF}}$。\n2. 计算来自EOM-SF-CCSD的垂直单重态-三重态能隙 $\\Delta E_{ST}^{\\mathrm{SF\\text{-}CCSD}}$。\n3. 计算来自CASPT2的垂直单重态-三重态能隙 $\\Delta E_{ST}^{\\mathrm{CASPT2}}$。\n\n请使用静态与动态电子相关以及变分原理的基本定义，解释为什么这三个 $\\Delta E_{ST}$ 值对于一个双自由基体可能在大小和符号上有所不同。在你的推理中，将每种方法对电子相关的处理方式与预测的 $\\Delta E_{ST}$ 中的预期偏差联系起来。\n\n将你最终计算出的三个能隙的数值答案（单位为千卡/摩尔）以一个单行矩阵的形式表示，顺序为 $\\left(\\Delta E_{ST}^{\\mathrm{UHF}}, \\Delta E_{ST}^{\\mathrm{SF\\text{-}CCSD}}, \\Delta E_{ST}^{\\mathrm{CASPT2}}\\right)$，并将每个条目四舍五入到四位有效数字。", "solution": "所提出的问题具有科学依据、提法明确且客观。它利用了理论化学中的标准概念和方法，并且所提供的数据是一致且足以进行完整分析的。因此，该问题是有效的，我将着手解决。\n\n该问题要求分三部分计算垂直单重态-三重态能隙 $\\Delta E_{ST} = E_T - E_S$，并为不同方法间观察到的差异提供理论解释。\n\n首先，我们处理非限制性哈特里-福克（UHF）的情况。破缺对称性（BS）单重态波函数 $|\\Psi_{\\mathrm{BS}}\\rangle$ 不是总自旋平方算符 $\\hat{S}^2$ 的本征函数。它是纯自旋态的混合，对于双自由基体，主要为单重态（$S=0$）和三重态（$S=1$）。这种混合态的能量是纯态能量的加权平均。一个常用的近似方法是通过假设能量与一系列自旋污染态的期望值 $\\langle \\hat{S}^2 \\rangle$ 之间存在线性关系，来投影出单重态能量。\n让我们将纯自旋单重态能量记为 $E_S$，纯自旋三重态能量记为 $E_T$，破缺对称性UHF能量记为 $E_{\\mathrm{BS}}^{\\mathrm{UHF}}$，高自旋三重态UHF能量记为 $E_T^{\\mathrm{UHF}}$。相应的 $\\langle \\hat{S}^2 \\rangle$ 值分别为 $0$、$2$、$\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}$ 和 $\\langle \\hat{S}^2 \\rangle_T$。假设存在线性依赖关系 $E(\\langle \\hat{S}^2 \\rangle) = a + b \\langle \\hat{S}^2 \\rangle$，我们可以外推到 $\\langle \\hat{S}^2 \\rangle = 0$ 来找到投影后的单重态能量，我们称之为 $E_S^{\\mathrm{AP-UHF}}$。使用提供的两个数据点 $(E_{\\mathrm{BS}}^{\\mathrm{UHF}}, \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}})$ 和 $(E_T^{\\mathrm{UHF}}, \\langle \\hat{S}^2 \\rangle_T)$，斜率 $b$ 为：\n$$ b = \\frac{E_T^{\\mathrm{UHF}} - E_{\\mathrm{BS}}^{\\mathrm{UHF}}}{\\langle \\hat{S}^2 \\rangle_T - \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}} $$\n纯单重态（$S=0$, $\\langle \\hat{S}^2 \\rangle = 0$）的外推能量则由山口（Yamaguchi）自旋投影公式给出：\n$$ E_S^{\\mathrm{AP-UHF}} = E_{\\mathrm{BS}}^{\\mathrm{UHF}} - b \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} = E_{\\mathrm{BS}}^{\\mathrm{UHF}} - \\left( \\frac{E_T^{\\mathrm{UHF}} - E_{\\mathrm{BS}}^{\\mathrm{UHF}}}{\\langle \\hat{S}^2 \\rangle_T - \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}} \\right) \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} $$\n使用给定值：\n$E_{\\mathrm{BS}}^{\\mathrm{UHF}} = -152.497800$ Hartree, $\\langle \\hat{S}^{2} \\rangle_{\\mathrm{BS}} = 0.92$\n$E_{T}^{\\mathrm{UHF}} = -152.497300$ Hartree, $\\langle \\hat{S}^{2} \\rangle_{T} = 2.02$\n$$ E_S^{\\mathrm{AP-UHF}} = -152.497800 - \\left( \\frac{-152.497300 - (-152.497800)}{2.02 - 0.92} \\right) \\cdot 0.92 $$\n$$ E_S^{\\mathrm{AP-UHF}} = -152.497800 - \\left( \\frac{0.000500}{1.10} \\right) \\cdot 0.92 \\approx -152.498218 \\text{ Hartree} $$\n基于UHF的单重态-三重态能隙是：\n$$ \\Delta E_{ST}^{\\mathrm{UHF}} = E_T^{\\mathrm{UHF}} - E_S^{\\mathrm{AP-UHF}} = -152.497300 - (-152.498218) \\approx 0.000918 \\text{ Hartree} $$\n\n其次，我们根据EOM-SF-CCSD结果计算能隙。这只需直接减去提供的能量：\n$E_{S}^{\\mathrm{SF\\text{-}CCSD}} = -152.500000$ Hartree, $E_{T}^{\\mathrm{SF\\text{-}CCSD}} = -152.498092$ Hartree\n$$ \\Delta E_{ST}^{\\mathrm{SF\\text{-}CCSD}} = E_{T}^{\\mathrm{SF\\text{-}CCSD}} - E_{S}^{\\mathrm{SF\\text{-}CCSD}} = -152.498092 - (-152.500000) = 0.001908 \\text{ Hartree} $$\n\n第三，我们根据CASPT2结果计算能隙。这也只需直接相减：\n$E_{S}^{\\mathrm{CASPT2}} = -152.521300$ Hartree, $E_{T}^{\\mathrm{CASPT2}} = -152.518700$ Hartree\n$$ \\Delta E_{ST}^{\\mathrm{CASPT2}} = E_{T}^{\\mathrm{CASPT2}} - E_{S}^{\\mathrm{CASPT2}} = -152.518700 - (-152.521300) = 0.002600 \\text{ Hartree} $$\n\n为了将这些能隙转换为千卡/摩尔（kcal/mol），我们使用换算因子 $1 \\text{ Hartree} = 627.5095 \\text{ kcal/mol}$。\n$$ \\Delta E_{ST}^{\\mathrm{UHF}} \\approx 0.000918 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 0.5762 \\text{ kcal/mol} $$\n$$ \\Delta E_{ST}^{\\mathrm{SF\\text{-}CCSD}} = 0.001908 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 1.197 \\text{ kcal/mol} $$\n$$ \\Delta E_{ST}^{\\mathrm{CASPT2}} = 0.002600 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 1.632 \\text{ kcal/mol} $$\n\n现在，我们必须解释这些差异。差异源于每种方法处理电子相关的方式不同，电子相关可分为静态相关和动态相关。\n**静态相关**源于多种电子组态的近简并性，这是双自由基体单重态的决定性特征。对静态相关的处理对于定性正确的描述至关重要。\n**动态相关**是由于电子间相互的库仑排斥而产生的电子运动的短程相关。\n\n1.  **带近似投影的UHF（AP-UHF）**：UHF方法基于单个斯莱特行列式。对于闭壳层单重态，这种形式主义对双自由基体完全失效，导致变分不稳定的解。破缺对称性UHF方法允许不同自旋使用不同轨道，通过混入低洼三重态的特征来人为地降低能量。这导致了严重的自旋污染（$\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} = 0.92$，远非纯单重态值$0$）。该方法没有以严格的方式明确考虑静态或动态相关。自旋投影公式是一种*后验*校正，试图纠正自旋污染缺陷，但它不是一个自洽、变分过程的一部分。得到的能隙虽然为正，但最不可靠，仅能作为粗略估计。\n\n2.  **CASPT2**：这是一个两步的多参考方法。首先，进行完全活性空间自洽场（CASSCF）计算。对于双自由基体，一个(2,2)活性空间（两个电子在两个轨道中）是合适的。CASSCF变分优化一个多组态波函数，明确包含了所有关键的电子组态。这正确地捕捉了活性空间内的静态相关，为多参考的单重态和单参考的三重态提供了平衡且自旋纯净的描述。变分原理适用于CASSCF能量，确保它们是*在所选活性空间内*对精确能量的上限。第二步，二阶微扰理论（PT2）通过考虑从CASSCF参考态出发的激发，增加了对动态相关的校正。这个校正是非变分的。CASPT2是一种强大的方法，因为它系统地处理了静态和动态相关，在本问题中得到了最低的绝对能量，并且通常能提供可靠的能隙。\n\n3.  **EOM-SF-CCSD**：运动方程自旋翻转耦合簇单双激发是一种建立在单参考基础上的、具备多参考能力的方法。它从一个行为良好的高自旋三重态参考态（$M_S=1$）开始，该参考态可由单个行列式精确描述。通过CCSD形式主义，动态相关被高精度地处理。然后，自旋翻转（SF）算符生成具有不同自旋多重度的目标态，包括三重态的$M_S=0$分量和多参考的$M_S=0$单重态。这种方法为两个目标态提供了平衡的描述，因为它们都从相同的参考态生成，并在相同的理论水平上处理。它有效地捕捉了静态相关（通过自旋翻转的组态混合）和动态相关（通过底层的CCSD）。EOM-CCSD能量不是变分的。\n\n**比较**：\nUHF的结果很小，因为BS-UHF态被三重态严重污染，使得 $E_{\\mathrm{BS}}^{\\mathrm{UHF}}$ 和 $E_T^{\\mathrm{UHF}}$ 的能量非常接近；投影是一个显著的校正。CASPT2和EOM-SF-CCSD方法都远为复杂。两者都正确地预测了单重态为基态（$\\Delta E_{ST} > 0$）。CASPT2方法得出的能隙最大。这表明，与EOM-SF-CCSD方法相比，PT2校正为单重态提供了相对于三重态更大的稳定化。这在物理上是合理的，因为单重态的电子成对，其密度分布通常比三重态具有更大的动态相关能，因为在三重态中，泡利原理使得两个电子相互远离。CASPT2和EOM-SF-CCSD之间的差异反映了它们各自处理动态相关时固有的近似。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.5762 & 1.197 & 1.632 \\end{pmatrix} } $$", "id": "2770423"}]}