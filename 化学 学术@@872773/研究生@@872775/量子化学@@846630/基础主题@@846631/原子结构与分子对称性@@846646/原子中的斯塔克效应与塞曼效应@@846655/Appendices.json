{"hands_on_practices": [{"introduction": "本次练习是理解外场如何微扰量子系统的基石。我们将超越标准的微扰理论“态求和”公式，通过直接求解氢原子的一阶微扰方程，从第一性原理推导其基态极化率。这个练习不仅能磨练高等数学物理技巧，还能让你对电子响应产生深刻而具体的理解。[@problem_id:2927333]", "problem": "一个处于基态的氢原子被置于一个沿 $z$ 轴方向、大小为 $E$ 的均匀静电场中。在原子单位 (a.u.) 下，未微扰的哈密顿量为 $H_{0}=-\\frac{1}{2}\\nabla^{2}-\\frac{1}{r}$，其基态能量为 $E_{1s}=-\\frac{1}{2}$，归一化的基态波函数为 $\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\exp(-r)$。由电场引起的微扰为 $V=-E z$。在弱场极限下，静态偶极极化率 $\\alpha_{1s}$ 由二次斯塔克位移 $\\Delta E^{(2)}=-\\frac{1}{2}\\alpha_{1s} E^{2}$ 定义。\n\n请使用非简并定态微扰理论，从第一性原理出发，完全在坐标空间中进行计算，不引入任何显式的激发态基组，通过求解关于一阶波函数修正的相应非齐次方程，推导并计算基态静态偶极极化率 $\\alpha_{1s}$ 的精确值。将您的最终结果表示为一个以原子单位计的精确数字。不要使用任何查表得到的“快捷”公式。无需四舍五入。", "solution": "出发点是非简并定态微扰理论。对于微扰 $V=-E z$ 和 $H_{0}$ 的一个能量为 $E_{0}$ 的未微扰归一化本征态 $\\lvert 0\\rangle$，其一阶修正 $\\lvert \\psi^{(1)}\\rangle$ 满足\n$$(H_{0}-E_{0})\\lvert \\psi^{(1)}\\rangle=-V\\lvert 0\\rangle.$$\n令 $\\lvert \\psi^{(1)}\\rangle=E\\,\\lvert f\\rangle$ 定义了一个不依赖于 $E$ 的辅助态 $\\lvert f\\rangle$，它满足非齐次方程\n$$(H_{0}-E_{0})\\lvert f\\rangle = z \\lvert 0\\rangle,$$\n以及用于确定解的标准正交条件 $\\langle 0\\lvert f\\rangle=0$。二阶能量为\n$$\\Delta E^{(2)}=\\langle 0\\lvert V\\rvert \\psi^{(1)}\\rangle=-E\\,\\langle 0\\lvert z\\rvert \\psi^{(1)}\\rangle=-E^{2}\\,\\langle 0\\lvert z\\rvert f\\rangle.$$\n根据静态偶极极化率 $\\alpha_{1s}$ 的定义 $\\Delta E^{(2)}=-\\frac{1}{2}\\alpha_{1s} E^{2}$，可得\n$$\\alpha_{1s}=2\\,\\langle 0\\lvert z\\rvert f\\rangle.$$\n\n现在我们在坐标空间中求解氢原子基态的 $\\lvert f\\rangle$。在原子单位下（即 $m_{e}=1$, $e=1$, $\\hbar=1$, $a_{0}=1$），未微扰的哈密顿量为 $H_{0}=-\\frac{1}{2}\\nabla^{2}-\\frac{1}{r}$，基态能量为 $E_{0}=-\\frac{1}{2}$，基态波函数为\n$$\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\exp(-r).$$\n在坐标表象下的非齐次方程为\n$$\\left(-\\frac{1}{2}\\nabla^{2}-\\frac{1}{r}+ \\frac{1}{2}\\right) f(\\mathbf{r}) = z\\,\\psi_{1s}(\\mathbf{r}).$$\n因为 $z=r\\cos\\theta$，源项正比于 $Y_{10}(\\theta,\\phi)$，根据转动对称性，解的角向形式为 $f(\\mathbf{r})=F(r)\\cos\\theta$。将 $f(\\mathbf{r})=F(r)\\cos\\theta$ 代入，并对一个轨道角动量为 $\\ell=1$ 的函数使用球坐标下的拉普拉斯算子，\n$$\\nabla^{2}\\!\\left[F(r)\\cos\\theta\\right]=\\left[\\frac{1}{r^{2}}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\!\\left(r^{2}F'(r)\\right)-\\frac{2}{r^{2}}F(r)\\right]\\cos\\theta,$$\n我们得到径向非齐次方程\n$$-\\frac{1}{2}\\left[\\frac{1}{r^{2}}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\!\\left(r^{2}F'(r)\\right)-\\frac{2}{r^{2}}F(r)\\right]-\\frac{1}{r}F(r)+\\frac{1}{2}F(r)=r\\,\\psi_{1s}(r).$$\n已知 $\\psi_{1s}(r)=\\frac{1}{\\sqrt{\\pi}}\\exp(-r)$，方便起见，我们通过令下式来提出指数因子\n$$F(r)=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r)\\,u(r).$$\n代入此试探解并化简，得到一个关于 $u(r)$ 的二阶常微分方程，\n$$u''(r)+\\left(-2+\\frac{2}{r}\\right)u'(r)-\\frac{2}{r^{2}}\\,u(r)=-2r.$$\n我们寻找在原点处正则的多项式解。试探解 $u(r)=a r^{2}+b r + c$ 导致\n$$-4 a\\,r + (4 a - 2 b) - \\frac{2 c}{r^{2}} = -2 r,$$\n通过匹配 $r$ 的同次幂。在 $r=0$ 处正则要求 $c=0$，匹配系数可得 $a=\\frac{1}{2}$ 和 $b=1$。因此\n$$u(r)=\\frac{1}{2}r^{2}+r,$$\n于是\n$$F(r)=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r)\\left(r+\\frac{r^{2}}{2}\\right), \\qquad f(\\mathbf{r})=F(r)\\cos\\theta.$$\n\n现在我们计算 $\\langle 0\\lvert z\\rvert f\\rangle$：\n\\begin{align*}\n\\langle 0\\lvert z\\rvert f\\rangle\n=\\int \\psi_{1s}(\\mathbf{r})\\, z\\, f(\\mathbf{r})\\, \\mathrm{d}^{3}\\mathbf{r}\n=\\int \\left(\\frac{1}{\\sqrt{\\pi}}e^{-r}\\right)\\, (r\\cos\\theta)\\, \\left[\\frac{1}{\\sqrt{\\pi}}e^{-r}\\left(r+\\frac{r^{2}}{2}\\right)\\cos\\theta\\right] \\mathrm{d}^{3}\\mathbf{r}\\\\\n=\\frac{1}{\\pi}\\int_{0}^{\\infty}\\!\\! \\mathrm{d}r\\, e^{-2r}\\, r^{2}\\, r\\left(r+\\frac{r^{2}}{2}\\right)\\int \\cos^{2}\\theta\\, \\mathrm{d}\\Omega\\\\\n=\\frac{1}{\\pi}\\left(\\frac{4\\pi}{3}\\right)\\int_{0}^{\\infty}\\!\\! \\mathrm{d}r\\, e^{-2r}\\,\\left(r^{4}+\\frac{1}{2}r^{5}\\right)\n=\\frac{4}{3}\\left[\\int_{0}^{\\infty} r^{4}e^{-2r}\\,\\mathrm{d}r + \\frac{1}{2}\\int_{0}^{\\infty} r^{5}e^{-2r}\\,\\mathrm{d}r\\right].\n\\end{align*}\n使用公式 $\\int_{0}^{\\infty} r^{n} e^{-\\alpha r}\\,\\mathrm{d}r = \\frac{n!}{\\alpha^{n+1}}$（对于 $\\alpha>0$ 和整数 $n\\geq 0$），我们发现\n$$\\int_{0}^{\\infty} r^{4}e^{-2r}\\,\\mathrm{d}r=\\frac{4!}{2^{5}}=\\frac{24}{32}=\\frac{3}{4}, \\qquad\n\\int_{0}^{\\infty} r^{5}e^{-2r}\\,\\mathrm{d}r=\\frac{5!}{2^{6}}=\\frac{120}{64}=\\frac{15}{8}.$$\n因此，\n$$\\langle 0\\lvert z\\rvert f\\rangle=\\frac{4}{3}\\left(\\frac{3}{4}+\\frac{1}{2}\\cdot \\frac{15}{8}\\right)\n=\\frac{4}{3}\\left(\\frac{3}{4}+\\frac{15}{16}\\right)\n=\\frac{4}{3}\\cdot \\frac{27}{16}=\\frac{9}{4}.$$\n最后，\n$$\\alpha_{1s}=2\\,\\langle 0\\lvert z\\rvert f\\rangle = 2\\cdot \\frac{9}{4}=\\frac{9}{2}.$$\n此结果以原子单位表示并且是精确的。", "answer": "$$\\boxed{\\frac{9}{2}}$$", "id": "2927333"}, {"introduction": "真实原子同时拥有轨道和自旋角动量，它们通过自旋-轨道相互作用耦合在一起。本练习旨在探究对于一个 $\\,^{2}P\\,$ 原子实，这种内禀耦合与外部磁场之间的有趣竞争。通过构建并对角化哈密顿量矩阵，你将亲眼见证从弱场塞曼区域到强场帕邢-巴克区域的平滑过渡，并深入了解能级如何随着外场强度压倒内禀原子结构而演化和交叉。[@problem_id:2927312]", "problem": "一个轨道角动量为 $L=1$、自旋为 $S=\\tfrac{1}{2}$ 的单电子原子谱项（一个光谱上的 $\\,^{2}P\\,$ 项）处于一个均匀静磁场 $\\mathbf{B}=B\\,\\hat{\\mathbf{z}}$ 中。忽略超精细结构和任何其他邻近的电子谱项，并在 Russell–Saunders (LS) 耦合框架内处理该系统。设自旋-轨道相互作用为 $H_{\\mathrm{SO}}=A\\,\\mathbf{L}\\cdot\\mathbf{S}$（其中 $A>0$），塞曼相互作用为 $H_{B}=\\mu_{B}B\\,(L_{z}+g_{S}S_{z})$，其中 $\\mu_{B}$ 是玻尔磁子，$g_{S}$ 是电子自旋 g 因子，轨道 g 因子为 $g_{L}=1$。\n\n任务：\n- 在非耦合表象 $\\{|L=1,m_{L};\\,S=\\tfrac{1}{2},m_{S}\\rangle\\}$（其中 $m_{L}\\in\\{-1,0,+1\\}$ 且 $m_{S}\\in\\{-\\tfrac{1}{2},+\\tfrac{1}{2}\\}$）中进行计算。仅使用基本角动量代数和给定的哈密顿量，通过守恒的投影 $M=m_{L}+m_{S}$ 将总哈密顿量 $H=H_{\\mathrm{SO}}+H_{B}$ 块对角化，并精确对角化每个块，以获得六个能量本征值 $E_{i}(B)$，作为 $B$、$A$、$\\mu_{B}$ 和 $g_{S}$ 的闭式解析函数。为避免单位问题，引入无量纲场参数 $\\beta=\\mu_{B}B/A$，并将能量报告为 $E_{i}(B)/A$。\n- 在强场 Paschen–Back 区 $\\beta\\gg 1$，确定每个分支相对于 $B$ 的渐近斜率，并指出哪些亚能级保持非耦合。从物理上解释为什么这些渐近行为源于 $\\mathbf{L}$ 和 $\\mathbf{S}$ 的解耦。\n- 在弱场区（Russell–Saunders 耦合中的线性塞曼效应），通过角动量代数计算 Landé g 因子 $g_{J}$，来确定 $J=\\tfrac{1}{2}$ 和 $J=\\tfrac{3}{2}$ 能级的一阶塞曼斜率，并将其模式与你找到的 Paschen–Back 渐近线进行对比。\n- 最后，考虑 $M=-\\tfrac{1}{2}$ 子空间。如果忽略 $H_{\\mathrm{SO}}$ 的非对角项（非绝热近似），该子空间中的两个基态能级会随着 $B$ 的变化而交叉。确定发生这种非绝热交叉的精确磁场值 $B_{c}$，并将其表示为关于 $A$、$\\mu_{B}$ 和 $g_{S}$ 的单一闭式解析表达式。\n\n将你的最终答案表示为 $B_{c}$ 的那个单一解析表达式。", "solution": "首先对问题进行严格的验证程序。\n\n步骤1：提取已知条件。\n- 系统：一个轨道角动量为 $L=1$、自旋为 $S=\\frac{1}{2}$ 的单电子原子谱项（一个光谱上的 $\\,^{2}P\\,$ 项）。\n- 外场：一个均匀静磁场 $\\mathbf{B}=B\\,\\hat{\\mathbf{z}}$。\n- 近似：忽略超精细结构和其他电子谱项；假定为 Russell–Saunders (LS) 耦合。\n- 哈密顿量：\n  - 自旋-轨道相互作用：$H_{\\mathrm{SO}}=A\\,\\mathbf{L}\\cdot\\mathbf{S}$，其中 $A>0$。\n  - 塞曼相互作用：$H_{B}=\\mu_{B}B\\,(L_{z}+g_{S}S_{z})$，其中轨道 g 因子 $g_{L}=1$。\n- 基组：非耦合表象 $\\{|L=1,m_{L};\\,S=\\tfrac{1}{2},m_{S}\\rangle\\}$，其中 $m_{L}\\in\\{-1,0,+1\\}$ 且 $m_{S}\\in\\{-\\tfrac{1}{2},+\\tfrac{1}{2}\\}$。\n- 任务：\n  1. 通过守恒量 $M=m_{L}+m_{S}$ 将总哈密顿量 $H=H_{\\mathrm{SO}}+H_{B}$ 块对角化，并求出六个能量本征值 $E_{i}(B)$，作为 $B$、$A$、$\\mu_{B}$ 和 $g_{S}$ 的解析函数。\n  2. 分析强场 (Paschen–Back) 区。\n  3. 分析弱场 (Zeeman) 区。\n  4. 在 $M=-\\frac{1}{2}$ 子空间中，求出非绝热能级（哈密顿量在非耦合表象中的对角元）交叉时的磁场 $B_{c}$。\n- 最终答案要求：$B_{c}$ 的一个单一闭式解析表达式。\n\n步骤2：问题陈述的验证。\n该问题是量子力学中的一个标准练习，具体涉及原子物理学，内容是关于自旋-轨道耦合与外部磁场之间的竞争（对于具有非零轨道角动量的态，这就是 Breit-Rabi 问题）。\n- **科学上成立：** 该问题基于量子力学的基本原理，包括角动量代数、自旋-轨道相互作用和塞曼效应。所有概念都已完善确立。它与指定的主题和领域完全相关。\n- **适定性：** 该问题定义了一个有限维（维度为 $(2L+1)(2S+1) = (2(1)+1)(2(\\frac{1}{2})+1) = 3 \\times 2 = 6$）的希尔伯特空间和一个厄米哈密顿算符。任务是具体的，并能导出一个关于能量本征值和交叉场 $B_{c}$ 的唯一的、有意义的解。\n- **客观性：** 该问题使用精确、无歧义的科学语言进行陈述。\n- **缺陷检查清单：**\n  1. 不存在科学或事实上的不健全之处。\n  2. 问题是可形式化的并且直接相关。\n  3. 问题设置是完整且自洽的。\n  4. 物理条件对于原子系统是现实的。\n  5. 结构清晰，问题适定。\n  6. 结果是数学上可验证的。\n\n步骤3：结论与行动。\n问题陈述被认为是有效的。将提供一个解答。\n\n总哈密顿量为 $H = H_{\\mathrm{SO}} + H_{B}$。我们在非耦合表象 $|m_{L}, m_{S}\\rangle$ 中进行计算。\n塞曼哈密顿量 $H_{B}$ 在此表象中是对角的，其本征值为 $\\mu_{B}B(m_{L} + g_{S}m_{S})$。\n自旋-轨道哈密顿量 $H_{\\mathrm{SO}}$ 表示为 $H_{\\mathrm{SO}} = A\\,\\mathbf{L}\\cdot\\mathbf{S} = A(L_{z}S_{z} + \\frac{1}{2}(L_{+}S_{-} + L_{-}S_{+}))$。$L_{z}S_{z}$ 项是对角的，而升降算符项 $L_{\\pm}S_{\\mp}$ 是非对角的。\n\n角动量的总 z 投影 $M=m_{L}+m_{S}$ 是一个守恒量，因为 $[L_{z}+S_{z}, H] = 0$。这使得 $6 \\times 6$ 的哈密顿矩阵可以根据 $M$ 的值进行块对角化。\n$M$ 的可能取值为 $M \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, +\\frac{1}{2}, +\\frac{3}{2}\\}$。这些块的维度分别为 $1$、$2$、$2$ 和 $1$。\n\n最后的任务要求我们关注 $M=-\\frac{1}{2}$ 子空间。张成这个子空间的基矢是 $|m_{L}=0, m_{S}=-\\frac{1}{2}\\rangle$ 和 $|m_{L}=-1, m_{S}=+\\frac{1}{2}\\rangle$。让我们将它们记为 $\\psi_{a} = |0, -\\frac{1}{2}\\rangle$ 和 $\\psi_{b} = |-1, +\\frac{1}{2}\\rangle$。\n\n这个 $2 \\times 2$ 块的哈密顿矩阵是 $H^{(M=-1/2)}$。我们必须计算其矩阵元。\n对角元为：\n$H_{aa} = \\langle 0, -\\tfrac{1}{2} | H | 0, -\\tfrac{1}{2} \\rangle = \\langle 0, -\\tfrac{1}{2} | A L_{z}S_{z} + \\mu_{B}B(L_{z}+g_{S}S_{z}) | 0, -\\tfrac{1}{2} \\rangle$\n$H_{aa} = A(0)(-\\tfrac{1}{2}) + \\mu_{B}B(0 + g_{S}(-\\tfrac{1}{2})) = -\\frac{g_{S}}{2} \\mu_{B} B$。\n\n$H_{bb} = \\langle -1, +\\tfrac{1}{2} | H | -1, +\\tfrac{1}{2} \\rangle = \\langle -1, +\\tfrac{1}{2} | A L_{z}S_{z} + \\mu_{B}B(L_{z}+g_{S}S_{z}) | -1, +\\tfrac{1}{2} \\rangle$\n$H_{bb} = A(-1)(+\\tfrac{1}{2}) + \\mu_{B}B(-1 + g_{S}(+\\tfrac{1}{2})) = -\\frac{A}{2} + \\mu_{B}B(-1 + \\frac{g_{S}}{2})$。\n\n非对角元仅由 $H_{\\mathrm{SO}}$ 的 $L_{\\pm}S_{\\mp}$ 部分产生。\n$H_{ab} = \\langle 0, -\\tfrac{1}{2} | H | -1, +\\tfrac{1}{2} \\rangle = \\frac{A}{2} \\langle 0, -\\tfrac{1}{2} | L_{+}S_{-} | -1, +\\tfrac{1}{2} \\rangle$。\n使用升降算符的标准关系式 $L_{+}|l,m_{l}\\rangle=\\sqrt{l(l+1)-m_{l}(m_{l}+1)}|l,m_{l}+1\\rangle$ 和 $S_{-}|s,m_{s}\\rangle=\\sqrt{s(s+1)-m_{s}(m_{s}-1)}|s,m_{s}-1\\rangle$：\n$S_{-}|-1, +\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{1}{2}(\\frac{3}{2}) - \\frac{1}{2}(-\\frac{1}{2})}|-1, -\\tfrac{1}{2}\\rangle = |-1, -\\tfrac{1}{2}\\rangle$。\n$L_{+}|-1, -\\tfrac{1}{2}\\rangle = \\sqrt{1(2)-(-1)(0)}|0, -\\tfrac{1}{2}\\rangle = \\sqrt{2}|0, -\\tfrac{1}{2}\\rangle$。\n因此，$H_{ab} = \\frac{A}{2} \\langle 0, -\\tfrac{1}{2} | \\sqrt{2}|0, -\\tfrac{1}{2}\\rangle = \\frac{A\\sqrt{2}}{2} = \\frac{A}{\\sqrt{2}}$。\n哈密顿量是厄米的，所以 $H_{ba} = H_{ab}^{*} = \\frac{A}{\\sqrt{2}}$。\n\n对于 $M=-\\frac{1}{2}$ 块，完整的哈密顿矩阵为：\n$$ H^{(M=-1/2)} = \\begin{pmatrix} -\\frac{g_{S}}{2} \\mu_{B} B  \\frac{A}{\\sqrt{2}} \\\\ \\frac{A}{\\sqrt{2}}  -\\frac{A}{2} + \\mu_{B} B (-1 + \\frac{g_{S}}{2}) \\end{pmatrix} $$\n\n题目要求的是发生“非绝热交叉”时的磁场 $B_{c}$。这指的是忽略非对角耦合项计算出的能级的交点。这些“非绝热”能量就是哈密顿矩阵的对角元，它们对应于强场（Paschen-Back）极限下基态的能量。\n设非绝热能量为 $E_{a}(B) = H_{aa}$ 和 $E_{b}(B) = H_{bb}$。交叉发生在 $E_{a}(B_{c}) = E_{b}(B_{c})$ 时。\n$$ -\\frac{g_{S}}{2} \\mu_{B} B_{c} = -\\frac{A}{2} + \\mu_{B} B_{c} \\left(-1 + \\frac{g_{S}}{2}\\right) $$\n为了求解 $B_{c}$，我们重排方程，将包含 $B_c$ 的项移到一边，常数项移到另一边：\n$$ \\frac{A}{2} = \\mu_{B} B_{c} \\left(-1 + \\frac{g_{S}}{2}\\right) + \\frac{g_{S}}{2} \\mu_{B} B_{c} $$\n$$ \\frac{A}{2} = \\mu_{B} B_{c} \\left(-1 + \\frac{g_{S}}{2} + \\frac{g_{S}}{2}\\right) $$\n$$ \\frac{A}{2} = \\mu_{B} B_{c} (g_{S} - 1) $$\n求解 $B_{c}$：\n$$ B_{c} = \\frac{A}{2 \\mu_{B} (g_{S} - 1)} $$\n已知 $A0$，$\\mu_{B}0$，且电子自旋 g 因子 $g_{S} \\approx 2.0023  1$，因此得到的磁场 $B_{c}$ 是一个正的物理量。这就是所要求的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{A}{2 \\mu_{B} (g_{S} - 1)}}\n$$", "id": "2927312"}, {"introduction": "尽管解析解具有不可估量的价值，但现代量子化学依赖于计算方法来研究复杂体系。本练习通过让你为一个模型原子实现自洽场（$SCF$）计算，从而在理论与计算之间架起一座桥梁。你将使用两种不同但相关的技术——直接的有限场方法和优雅的线性响应理论——来计算静态极化率，从而对响应性质的“在计算机中”的计算方式获得实践性的理解。[@problem_id:2927319]", "problem": "要求您针对一个极简闭壳层原子模型，在 Hartree 近似（无交换作用）下，实现、验证并比较两种计算沿 $z$ 轴的静态电偶极极化率（斯塔克响应）的独立方法。该系统是一个双电子闭壳层原子，在正交归一的原子中心基组 $\\{\\chi_1,\\chi_2\\}$ 中表示，其物理詮釋为 $\\chi_1 \\sim 1s$ 和 $\\chi_2 \\sim 2p_z$。所有量均采用原子单位。外部均匀电场沿 $z$ 轴施加，对电子哈密顿量的微扰为 $-\\mathcal{F}\\,\\hat{\\mu}_z$，其中 $\\mathcal{F}$ 是场强，$\\hat{\\mu}_z$ 是偶极算符的 $z$ 分量。\n\n从以下基本依据出发：\n- 在固定基组中，存在沿 $z$ 轴的外部静态电场时，不含时的电子哈密顿量为 $\\hat{H}(\\mathcal{F})=\\hat{H}_0 - \\mathcal{F}\\,\\hat{\\mu}_z$。\n- 对于给定的单粒子密度矩阵 $P$，限制性闭壳层 Hartree 能量泛函（忽略交换作用）为\n  $$E[P;\\mathcal{F}] = \\mathrm{Tr}[P h] + \\tfrac{1}{2}\\sum_{\\mu\\nu\\lambda\\sigma} P_{\\mu\\nu} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma) - \\mathcal{F}\\,\\mathrm{Tr}[P d],$$\n  其中 $h$ 是核心哈密顿矩阵，$d$ 是 $\\hat{\\mu}_z$ 的偶极矩阵，$(\\mu\\nu|\\lambda\\sigma)$ 是库仑双电子积分。\n- Hartree（无交换作用）Fock 矩阵为\n  $$F_{\\mu\\nu}[P;\\mathcal{F}] = h_{\\mu\\nu} - \\mathcal{F}\\,d_{\\mu\\nu} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma).$$\n- 定态条件要求占据分子轨道求解每个 $\\mathcal{F}$ 下的自洽场 (SCF) 方程，其中能量最低的空间轨道被双重占据，且 $P = 2\\sum_{i\\in \\text{occ}} C_{\\mu i}C_{\\nu i}$。\n\n任务 A（响应理论/独立粒子近似下的 CPHF）：\n- 不使用有限场方法，通过在 $\\mathcal{F}=0$ 处对定态 SCF 方程进行微分，从第一性原理推导闭壳层基态对沿 $z$ 轴的无穷小静态场的线性响应。在独立粒子极限（Fock 本征值能隙之外没有电子-空穴耦合核）下进行计算，使用零场下的正则分子轨道和本征值。将静态纵向极化率 $\\alpha_{zz}$ 表示为零场下占据轨道与虚拟轨道之间的轨道能隙和跃迁偶极矩的函数。您必须仅使用零场 SCF 解来数值实现此公式。\n\n任务 B（有限场参考）：\n- 通过在 $\\mathcal{F}=+\\Delta$、$\\mathcal{F}=0$ 和 $\\mathcal{F}=-\\Delta$ 时进行三次 SCF 计算，并通过中心差分法计算总电子能量相对于场的二阶导数，来实现有限场方法。使用此二阶导数获得静态纵向极化率。必须使用中心差分表达式，以使数值二阶导数近似于零场下的精确导数。\n\n模型规格与数据（正交归一基组，所有量均采用原子单位）：\n- 基组维度为 $2$ ($\\chi_1,\\chi_2$)。重叠矩阵是单位矩阵。\n- 核心哈密顿量 $h$ 是对角矩阵：$h_{11}=\\text{given}$, $h_{22}=\\text{given}$, $h_{12}=h_{21}=0$。\n- 非零的双电子库仑积分（所有其他积分均为零）：\n  - $(11|11)=U_1$,\n  - $(22|22)=U_2$,\n  - $(22|11)=(11|22)=J_{12}$。\n- 偶极矩阵（由于宇称性，只有一个非零的非对角元）：$d_{12}=d_{21}=\\text{given}$, $d_{11}=d_{22}=0$。\n\n算法要求：\n- 为每个场 $\\mathcal{F}$ 实现一个稳健的 SCF 过程，使用 Fock 矩阵的对角化来获得占据分子轨道，并构建密度 $P$ 直至自洽。将密度收敛到 Frobenius 范数变化小于 $10^{-12}$ 或更好。\n- 对于任务 A，使用收敛的零场 SCF 解来获得用于独立粒子线性响应的正则分子轨道和本征值。\n- 对于任务 B，使用基于 $E(+\\Delta)$、$E(0)$ 和 $E(-\\Delta)$ 的对称中心差分来近似关于 $\\mathcal{F}$ 的二阶导数。\n\n单位与输出：\n- 以体积的原子单位（玻尔半径的立方，$a_0^3$）报告静态纵向极化率，作为原始浮点数，不进行舍入。\n- 您的程序必须生成单行输出，其中包含所有结果，形式为方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出三个浮点数：响应理论极化率、有限场极化率以及它们之间的绝对差。按照测试用例的顺序连接这些三元组。\n\n测试套件：\n- 使用以下三个测试用例。在每个用例中，使用相同的有限场步长 $\\Delta = 10^{-4}$。\n  1. 用例 A：\n     - $h_{11} = -1.0$, $h_{22} = 0.2$,\n     - $(11|11)=U_1 = 0.5$, $(22|22)=U_2 = 0.2$, $(22|11)=J_{12}=0.1$,\n     - $d_{12}=0.5$。\n  2. 用例 B（近简并能隙）：\n     - $h_{11} = -0.8$, $h_{22} = -0.17$,\n     - $(11|11)=U_1 = 0.3$, $(22|22)=U_2 = 0.2$, $(22|11)=J_{12}=0.005$,\n     - $d_{12}=0.2$。\n  3. 用例 C（对称性禁戒跃迁）：\n     - $h_{11} = -0.9$, $h_{22} = 0.0$,\n     - $(11|11)=U_1 = 0.35$, $(22|22)=U_2 = 0.25$, $(22|11)=J_{12}=0.2$,\n     - $d_{12}=0.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含按 $[\\alpha_{\\mathrm{resp}}^{(A)}, \\alpha_{\\mathrm{ff}}^{(A)}, |\\Delta|^{(A)}, \\alpha_{\\mathrm{resp}}^{(B)}, \\alpha_{\\mathrm{ff}}^{(B)}, |\\Delta|^{(B)}, \\alpha_{\\mathrm{resp}}^{(C)}, \\alpha_{\\mathrm{ff}}^{(C)}, |\\Delta|^{(C)}]$ 顺序排列的九个浮点数，其中 $|\\Delta|$ 表示指定用例下两种极化率之间的绝对差。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它科学地植根于量子化学原理，特别是 Hartree 理论和微扰理论。该问题提法得当、客观，并提供了推导唯一且有意义解所需的所有数据和约束。该模型虽然简化，却是阐述电子结构和响应性质概念的标准教学工具。因此，我们可以着手进行推导和计算求解。\n\n核心任务是计算双电子闭壳层原子模型的静态电偶极极化率 $\\alpha_{zz}$。极化率定义为总电子能量 $E$ 相对于沿 $z$ 轴施加的外部电场强度 $\\mathcal{F}$ 的二阶导数，并在零场下求值：\n$$ \\alpha_{zz} = - \\left. \\frac{\\partial^2 E}{\\partial \\mathcal{F}^2} \\right|_{\\mathcal{F}=0} $$\n对哈密顿量的微扰由 $\\hat{H}' = -\\mathcal{F}\\hat{\\mu}_z$ 给出，其中 $\\hat{\\mu}_z$ 是偶极矩算符。\n\n电子结构是在限制性 Hartree 近似（无交换作用）下，于二维正交归一基组 $\\{\\chi_1, \\chi_2\\}$ 中确定的。基态由一个双重占据的单一空间轨道描述。解决此问题的关键是采用自洽场 (SCF) 过程来确定给定场强 $\\mathcal{F}$ 下的基态。\n\n在此基组中，Fock 矩阵 $F$ 是一个 $2 \\times 2$ 矩阵，其矩阵元由下式给出：\n$$ F_{\\mu\\nu}[P;\\mathcal{F}] = h_{\\mu\\nu} - \\mathcal{F}\\,d_{\\mu\\nu} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma) $$\n其中 $h$ 是核心哈密顿量，$d$ 是偶极矩阵，$P$ 是单粒子密度矩阵。对于给定模型，电子排斥积分 (ERI) 项得到简化，因为只有形式为 $(\\mu\\mu|\\nu\\nu)$ 的积分非零。库仑项 $J_{\\mu\\nu}[P] = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma)$ 是对角的：\n$$ J_{11}[P] = P_{11}U_1 + P_{22}J_{12} $$\n$$ J_{22}[P] = P_{11}J_{12} + P_{22}U_2 $$\n$$ J_{12}[P] = J_{21}[P] = 0 $$\n鉴于 $h$ 和 $d$ 也被指定为分别仅具有对角元和非对角元，完整的 Fock 矩阵为：\n$$ F[P; \\mathcal{F}] = \\begin{pmatrix} h_{11} + P_{11}U_1 + P_{22}J_{12}  -\\mathcal{F}\\,d_{12} \\\\ -\\mathcal{F}\\,d_{12}  h_{22} + P_{11}J_{12} + P_{22}U_2 \\end{pmatrix} $$\nSCF 过程涉及找到一个与其生成的 Fock 矩阵自洽的密度矩阵 $P$。这通过迭代以下步骤实现：\n1. 从一个猜测的密度矩阵 $P$ 构建 Fock 矩阵 $F$。\n2. 求解本征值问题 $FC = C\\epsilon$ 以找到轨道系数 $C$ 和能量 $\\epsilon$。\n3. 从能量最低的（占据）轨道 $C_1$ 的系数构建新的密度矩阵：$P_{new} = 2 C_1 C_1^T$。\n4. 检查收敛性，例如，通过监控 $P$ 的变化。如果未收敛，则更新 $P$ 并从步骤 1 重复。\n\n一旦 SCF 过程对给定的 $\\mathcal{F}$ 收敛，总电子能量使用提供的泛函计算：\n$$ E[P;\\mathcal{F}] = \\mathrm{Tr}[P h] + \\tfrac{1}{2}\\sum_{\\mu\\nu\\lambda\\sigma} P_{\\mu\\nu} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma) - \\mathcal{F}\\,\\mathrm{Tr}[P d] $$\n代入给定的非零 ERI，此式变为：\n$$ E[P;\\mathcal{F}] = (P_{11}h_{11} + P_{22}h_{22}) + \\frac{1}{2}(P_{11}^2 U_1 + P_{22}^2 U_2 + 2P_{11}P_{22}J_{12}) - \\mathcal{F}(2P_{12}d_{12}) $$\n\n在此框架下，我们处理两个具体任务。\n\n**任务 A：独立粒子近似下的响应理论**\n此任务要求推导并实现一个计算 $\\alpha_{zz}$ 的公式，而不依赖于有限场计算。我们使用线性响应理论。问题指定了“独立粒子近似”，该近似忽略了双电子积分对微扰的响应（即电子-空穴耦合核）。在此近似下，极化率可以从双电子体系的不含时微扰理论推导出来。\n\n与场相关的微扰算符是 $V = -\\mathcal{F} (\\hat{\\mu}_{z,1} + \\hat{\\mu}_{z,2})$。算符 $(\\hat{\\mu}_{z,1} + \\hat{\\mu}_{z,2})$ 是单电子算符，因此它只将基态 $|\\Psi_0\\rangle = |\\psi_1\\bar{\\psi}_1\\rangle$ 与单重激发单线态相连接。对于我们的两能级系统，只存在一个这样的状态，$|\\Psi_{1\\to2}^{\\text{singlet}}\\rangle$。其矩阵元为 $\\langle \\Psi_0 | \\hat{\\mu}_{z,1} + \\hat{\\mu}_{z,2} | \\Psi_{1\\to2}^{\\text{singlet}} \\rangle = \\sqrt{2} \\langle \\psi_1 | \\hat{\\mu}_z | \\psi_2 \\rangle$。令 $d_{12}^{\\text{MO}} = \\langle \\psi_1 | \\hat{\\mu}_z | \\psi_2 \\rangle$。\n\n能量的二阶校正是 $E^{(2)} = \\frac{|\\langle\\Psi_{1\\to2}^{\\text{singlet}}|V|\\Psi_0\\rangle|^2}{E_0 - E_{1\\to2}}$。在独立粒子近似中，能量差 $\\Delta E = E_{1\\to2} - E_0$ 就是轨道能量之差 $\\epsilon_2 - \\epsilon_1$。\n因此，二阶能量为：\n$$ E(\\mathcal{F}) = E(0) + \\mathcal{F}^2 \\frac{|\\sqrt{2} d_{12}^{\\text{MO}}|^2}{E_0 - (E_0 + \\epsilon_2 - \\epsilon_1)} = E(0) - \\mathcal{F}^2 \\frac{2 (d_{12}^{\\text{MO}})^2}{\\epsilon_2 - \\epsilon_1} $$\n根据定义 $\\alpha_{zz} = - \\left. \\frac{\\partial^2 E}{\\partial \\mathcal{F}^2} \\right|_{\\mathcal{F}=0}$，我们通过对 $\\mathcal{F}$ 求两次导数得到极化率，得出 $\\frac{\\partial^2 E}{\\partial \\mathcal{F}^2} = - \\frac{4 (d_{12}^{\\text{MO}})^2}{\\epsilon_2 - \\epsilon_1}$。\n因此，响应理论极化率为：\n$$ \\alpha_{zz} = \\frac{4 (d_{12}^{\\text{MO}})^2}{\\epsilon_2^{(0)} - \\epsilon_1^{(0)}} $$\n这里，$\\epsilon_1^{(0)}$ 和 $\\epsilon_2^{(0)}$ 分别是在零场（$\\mathcal{F}=0$）下 SCF 计算得到的最低（占据）和最高（虚拟）轨道能量。分子轨道（MO）基下的跃迁偶极矩 $d_{12}^{\\text{MO}}$ 按如下方式计算：\n$$ d_{12}^{\\text{MO}} = (C_1^{(0)})^T d C_2^{(0)} $$\n其中 $C_1^{(0)}$ 和 $C_2^{(0)}$ 是分别对应于 $\\epsilon_1^{(0)}$ 和 $\\epsilon_2^{(0)}$ 的本征矢量（轨道系数）。\n\n为实现这一点，我们对 $\\mathcal{F}=0$ 进行一次 SCF 计算。从收敛解中，我们提取轨道能量和系数，计算 $d_{12}^{\\text{MO}}$，并应用上述公式。\n\n**任务 B：有限场参考**\n此任务使用数值方法来求解能量的二阶导数。我们采用三点中心差分公式，对于给定的步长 $\\Delta$，该公式比前向或后向差分具有更高的精度。\n$$ \\left. \\frac{\\partial^2 E}{\\partial \\mathcal{F}^2} \\right|_{\\mathcal{F}=0} \\approx \\frac{E(+\\Delta) - 2E(0) + E(-\\Delta)}{\\Delta^2} $$\n因此，极化率近似为：\n$$ \\alpha_{zz} \\approx - \\frac{E(+\\Delta) - 2E(0) + E(-\\Delta)}{\\Delta^2} $$\n这需要进行三次独立的 SCF 计算，以找到收敛的总电子能量 $E(+\\Delta)$、$E(0)$ 和 $E(-\\Delta)$，其中 $\\Delta$ 是一个小的有限场强。在本问题中，使用 $\\Delta = 10^{-4}$ 原子单位。对于这三种场强中的每一种，都使用先前描述的 SCF 算法和能量表达式。该方法可作为任务 A 中解析结果的数值基准。两种方法之间的微小差异源于有限差分公式中的截断误差以及响应理论推導中所做的近似。\n\n最终程序的计算流程如下：\n1. 对每个测试用例，定义模型参数 $h$、$U_1$、$U_2$、$J_{12}$ 和 $d_{12}$。\n2. 在 $\\mathcal{F}=0$ 时执行 SCF 计算。从收敛的轨道和能量中，为任务 A 计算 $\\alpha_{zz}$。收敛的能量 $E(0)$ 也被存储起来。\n3. 在 $\\mathcal{F}=+\\Delta$ 时执行 SCF 计算以获得 $E(+\\Delta)$。\n4. 在 $\\mathcal{F}=-\\Delta$ 时执行 SCF 计算以获得 $E(-\\Delta)$。\n5. 使用 $E(0)$、$E(+\\Delta)$ 和 $E(-\\Delta)$，通过中心差分公式为任务 B 计算 $\\alpha_{zz}$。\n6. 计算任务 A 和任务 B 所得极化率之间的绝对差。\n7. 按规定报告每个测试用例的三个值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_scf(field_strength, params):\n    \"\"\"\n    Performs a Restricted Hartree (no-exchange) SCF calculation for a 2-level system.\n\n    Args:\n        field_strength (float): The strength of the external electric field, F.\n        params (dict): A dictionary containing model parameters:\n                       h11, h22, u1, u2, j12, d12.\n\n    Returns:\n        dict: A dictionary containing the converged results:\n              'energy': Total electronic energy.\n              'orbitals': 2x2 matrix of orbital coefficients.\n              'orbital_energies': Array of the two orbital energies.\n              'density_matrix': Converged 2x2 density matrix.\n    \"\"\"\n    h11, h22 = params['h11'], params['h22']\n    u1, u2, j12 = params['u1'], params['u2'], params['j12']\n    d12 = params['d12']\n\n    # Core Hamiltonian and dipole matrices\n    h_core = np.array([[h11, 0.0], [0.0, h22]])\n    d_dipole = np.array([[0.0, d12], [d12, 0.0]])\n\n    # Initial guess for the density matrix (occupy the 1s-like orbital)\n    p_matrix = np.array([[2.0, 0.0], [0.0, 0.0]])\n\n    max_iter = 100\n    conv_thresh = 1e-12\n\n    for i in range(max_iter):\n        p_old = p_matrix\n\n        # Build the Fock matrix\n        # J[P] is the Coulomb part\n        j11 = p_matrix[0, 0] * u1 + p_matrix[1, 1] * j12\n        j22 = p_matrix[0, 0] * j12 + p_matrix[1, 1] * u2\n        j_matrix = np.array([[j11, 0.0], [0.0, j22]])\n        \n        fock_matrix = h_core + j_matrix - field_strength * d_dipole\n\n        # Diagonalize the Fock matrix\n        orbital_energies, orbitals = np.linalg.eigh(fock_matrix)\n        \n        # The occupied orbital is the one with the lowest energy\n        # (np.linalg.eigh returns sorted eigenvalues and corresponding eigenvectors)\n        occupied_orbital = orbitals[:, 0].reshape(2, 1)\n\n        # Build new density matrix\n        p_matrix = 2.0 * (occupied_orbital @ occupied_orbital.T)\n\n        # Check for convergence\n        error = np.linalg.norm(p_matrix - p_old)\n        if error  conv_thresh:\n            break\n    \n    # Calculate final energy using the converged density matrix\n    # E[P] = Tr(P h) + 1/2 * Tr(P J[P]) - F * Tr(P d)\n    # The Tr(P J[P]) form is convenient for implementation\n    j11 = p_matrix[0, 0] * u1 + p_matrix[1, 1] * j12\n    j22 = p_matrix[0, 0] * j12 + p_matrix[1, 1] * u2\n    j_matrix = np.array([[j11, 0.0], [0.0, j22]])\n    \n    energy_one_electron = np.trace(p_matrix @ h_core)\n    energy_two_electron = 0.5 * np.trace(p_matrix @ j_matrix)\n    energy_field = -field_strength * np.trace(p_matrix @ d_dipole)\n\n    total_energy = energy_one_electron + energy_two_electron + energy_field\n\n    return {\n        'energy': total_energy,\n        'orbitals': orbitals,\n        'orbital_energies': orbital_energies,\n        'density_matrix': p_matrix\n    }\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'h11': -1.0, 'h22': 0.2, 'u1': 0.5, 'u2': 0.2, 'j12': 0.1, 'd12': 0.5},\n        # Case B (near-degenerate gap)\n        {'h11': -0.8, 'h22': -0.17, 'u1': 0.3, 'u2': 0.2, 'j12': 0.005, 'd12': 0.2},\n        # Case C (symmetry-forbidden transition)\n        {'h11': -0.9, 'h22': 0.0, 'u1': 0.35, 'u2': 0.25, 'j12': 0.2, 'd12': 0.0},\n    ]\n\n    delta = 1e-4\n    results = []\n\n    for params in test_cases:\n        # --- Task A: Response Theory ---\n        scf_zero_field = run_scf(0.0, params)\n        eps = scf_zero_field['orbital_energies']\n        coeffs = scf_zero_field['orbitals']\n        \n        c1, c2 = coeffs[:, 0], coeffs[:, 1]\n        \n        d12 = params['d12']\n        d_dipole = np.array([[0.0, d12], [d12, 0.0]])\n        \n        d12_mo = c1.T @ d_dipole @ c2\n        \n        # Orbital energy gap\n        energy_gap = eps[1] - eps[0]\n        \n        alpha_resp = 0.0\n        if abs(energy_gap) > 1e-9: # Avoid division by zero\n            alpha_resp = 4.0 * (d12_mo**2) / energy_gap\n\n        # --- Task B: Finite Field ---\n        e_zero = scf_zero_field['energy']\n        e_plus_delta = run_scf(+delta, params)['energy']\n        e_minus_delta = run_scf(-delta, params)['energy']\n\n        alpha_ff = - (e_plus_delta - 2.0 * e_zero + e_minus_delta) / (delta**2)\n        \n        # --- Collect results ---\n        diff = abs(alpha_resp - alpha_ff)\n        results.extend([alpha_resp, alpha_ff, diff])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2927319"}]}