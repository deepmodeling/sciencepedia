{"hands_on_practices": [{"introduction": "分子间力的核心是静电相互作用。这项练习将引导你从经典静电学的第一性原理出发，推导两个点偶极子之间的相互作用能，这是理解极性分子行为的基础。通过该练习，你将深入理解静电相互作用能量如何依赖于分子的相对取向，并为更复杂的相互作用模型打下坚实的理论基础。[@problem_id:2942380]", "problem": "两个刚性线性转子，分子 A 和分子 B，分别具有大小为 $\\mu_1$ 和 $\\mu_2$ 的永久电偶极矩 $\\boldsymbol{\\mu}_1$ 和 $\\boldsymbol{\\mu}_2$。它们的中心在真空中固定，相距为 $R$。将每个分子视为位于其中心的点偶极子（点偶极子近似），忽略感应和色散效应。仅使用经典静电学，从点偶极子的静电势定义以及偶极子与外电场之间相互作用能的定义出发，推导在固定距离和任意取向下的两个永久偶极子之间的相互作用能的通用表达式。\n\n然后，计算以下两种静态排列的相互作用能：\n\n1. 共线且平行：两个偶极子都沿着分子间轴（中心连线）排列，并指向同一方向。\n2. 正交：分子 A 的偶极子 $\\boldsymbol{\\mu}_1$ 沿着分子间轴排列，而分子 B 的偶极子 $\\boldsymbol{\\mu}_2$ 垂直于分子间轴，且垂直于 $\\boldsymbol{\\mu}_1$。\n\n最后，以一个包含 $\\mu_1$、$\\mu_2$、$R$ 和真空介电常数 $\\varepsilon_0$ 的单一闭式解析表达式的形式，报告能量差 $\\Delta U = U_{\\text{parallel}} - U_{\\text{orthogonal}}$。以焦耳为单位表示最终的能量差。不要进行近似或四舍五入。", "solution": "所述问题在科学上是合理的、自洽的且是良定的。它要求推导经典静电学中的一个标准结果。我们将着手进行解答。\n\n问题要求推导两个相距为固定距离 $R$ 的点偶极子 $\\boldsymbol{\\mu}_1$ 和 $\\boldsymbol{\\mu}_2$ 之间的相互作用能。设从偶极子 $\\boldsymbol{\\mu}_1$ 中心到偶极子 $\\boldsymbol{\\mu}_2$ 中心的位置矢量为 $\\mathbf{R}$，使得 $|\\mathbf{R}| = R$。我们首先将偶极子 $\\boldsymbol{\\mu}_1$ 置于坐标系的原点。\n\n根据经典静电学，由点偶极子 $\\boldsymbol{\\mu}_1$ 在位置 $\\mathbf{r}$ 处产生的静电势 $\\phi_1(\\mathbf{r})$ 由下式给出：\n$$ \\phi_1(\\mathbf{r}) = \\frac{1}{4\\pi\\varepsilon_0} \\frac{\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}}{r^3} $$\n其中 $r = |\\mathbf{r}|$ 是位置矢量的模，$\\varepsilon_0$ 是真空介电常数。\n\n电场 $\\mathbf{E}_1(\\mathbf{r})$ 是静电势的负梯度，即 $\\mathbf{E}_1 = -\\nabla \\phi_1$。我们使用矢量微积分的乘积法则 $\\nabla(fg) = f\\nabla g + g\\nabla f$ 来计算梯度：\n$$ \\mathbf{E}_1(\\mathbf{r}) = -\\nabla \\left( \\frac{1}{4\\pi\\varepsilon_0} \\frac{\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}}{r^3} \\right) = -\\frac{1}{4\\pi\\varepsilon_0} \\left[ (\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}) \\nabla\\left(\\frac{1}{r^3}\\right) + \\frac{1}{r^3} \\nabla(\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}) \\right] $$\n所需的梯度项为 $\\nabla(r^{-n}) = -nr^{-n-1}\\nabla(r) = -nr^{-n-2}\\mathbf{r}$，当 $n=3$ 时，得到 $\\nabla(r^{-3}) = -3r^{-5}\\mathbf{r}$；对于恒定矢量 $\\mathbf{A}$，有 $\\nabla(\\mathbf{A} \\cdot \\mathbf{r}) = \\mathbf{A}$，因此 $\\nabla(\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}) = \\boldsymbol{\\mu}_1$。将这些结果代入电场表达式中：\n$$ \\mathbf{E}_1(\\mathbf{r}) = -\\frac{1}{4\\pi\\varepsilon_0} \\left[ (\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r}) \\left( -\\frac{3\\mathbf{r}}{r^5} \\right) + \\frac{\\boldsymbol{\\mu}_1}{r^3} \\right] = \\frac{1}{4\\pi\\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu}_1 \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\boldsymbol{\\mu}_1}{r^3} \\right] $$\n位于电场 $\\mathbf{E}_1$ 中的第二个偶极子 $\\boldsymbol{\\mu}_2$ 的相互作用能 $U$ 由 $U = -\\boldsymbol{\\mu}_2 \\cdot \\mathbf{E}_1$ 给出。为了求得我们两个偶极子之间的相互作用能，我们在第二个偶极子的位置 $\\mathbf{r} = \\mathbf{R}$ 处计算电场 $\\mathbf{E}_1$：\n$$ U = -\\boldsymbol{\\mu}_2 \\cdot \\mathbf{E}_1(\\mathbf{R}) = -\\boldsymbol{\\mu}_2 \\cdot \\left( \\frac{1}{4\\pi\\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu}_1 \\cdot \\mathbf{R})\\mathbf{R}}{R^5} - \\frac{\\boldsymbol{\\mu}_1}{R^3} \\right] \\right) $$\n将点积展开，我们得到：\n$$ U = -\\frac{1}{4\\pi\\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu}_1 \\cdot \\mathbf{R})(\\boldsymbol{\\mu}_2 \\cdot \\mathbf{R})}{R^5} - \\frac{\\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2}{R^3} \\right] $$\n这可以通提出因子 $R^{-3}$ 并引入沿中心连线的单位矢量 $\\hat{\\mathbf{R}} = \\mathbf{R}/R$ 来重写：\n$$ U = \\frac{1}{4\\pi\\varepsilon_0 R^3} \\left[ (\\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2) - 3(\\boldsymbol{\\mu}_1 \\cdot \\hat{\\mathbf{R}})(\\boldsymbol{\\mu}_2 \\cdot \\hat{\\mathbf{R}}) \\right] $$\n这是两个固定点偶极子之间相互作用能的通用表达式。\n\n现在，我们计算两种指定的静态排列下的能量。我们建立一个坐标系，其中分子间轴与 z 轴对齐，因此 $\\hat{\\mathbf{R}} = \\hat{\\mathbf{z}}$。\n\n情况 1：共线且平行排列。\n在此构型中，两个偶极子都与分子间轴对齐并指向同一方向。因此，$\\boldsymbol{\\mu}_1 = \\mu_1 \\hat{\\mathbf{z}}$ 且 $\\boldsymbol{\\mu}_2 = \\mu_2 \\hat{\\mathbf{z}}$。所需的标量积为：\n$\\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2 = (\\mu_1 \\hat{\\mathbf{z}}) \\cdot (\\mu_2 \\hat{\\mathbf{z}}) = \\mu_1 \\mu_2$\n$\\boldsymbol{\\mu}_1 \\cdot \\hat{\\mathbf{R}} = (\\mu_1 \\hat{\\mathbf{z}}) \\cdot \\hat{\\mathbf{z}} = \\mu_1$\n$\\boldsymbol{\\mu}_2 \\cdot \\hat{\\mathbf{R}} = (\\mu_2 \\hat{\\mathbf{z}}) \\cdot \\hat{\\mathbf{z}} = \\mu_2$\n将这些代入通用能量公式，得到平行情况下的能量 $U_{\\text{parallel}}$：\n$$ U_{\\text{parallel}} = \\frac{1}{4\\pi\\varepsilon_0 R^3} \\left[ \\mu_1 \\mu_2 - 3(\\mu_1)(\\mu_2) \\right] = \\frac{-2\\mu_1 \\mu_2}{4\\pi\\varepsilon_0 R^3} = -\\frac{\\mu_1 \\mu_2}{2\\pi\\varepsilon_0 R^3} $$\n\n情况 2：正交排列。\n在此构型中，$\\boldsymbol{\\mu}_1$ 与分子间轴对齐，所以 $\\boldsymbol{\\mu}_1 = \\mu_1 \\hat{\\mathbf{z}}$。偶极子 $\\boldsymbol{\\mu}_2$ 垂直于分子间轴。不失一般性，我们可以使其与 x 轴对齐，所以 $\\boldsymbol{\\mu}_2 = \\mu_2 \\hat{\\mathbf{x}}$。标量积为：\n$\\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2 = (\\mu_1 \\hat{\\mathbf{z}}) \\cdot (\\mu_2 \\hat{\\mathbf{x}}) = 0$\n$\\boldsymbol{\\mu}_1 \\cdot \\hat{\\mathbf{R}} = (\\mu_1 \\hat{\\mathbf{z}}) \\cdot \\hat{\\mathbf{z}} = \\mu_1$\n$\\boldsymbol{\\mu}_2 \\cdot \\hat{\\mathbf{R}} = (\\mu_2 \\hat{\\mathbf{x}}) \\cdot \\hat{\\mathbf{z}} = 0$\n因此，正交情况下的能量 $U_{\\text{orthogonal}}$ 为：\n$$ U_{\\text{orthogonal}} = \\frac{1}{4\\pi\\varepsilon_0 R^3} \\left[ 0 - 3(\\mu_1)(0) \\right] = 0 $$\n\n最后，我们计算能量差 $\\Delta U = U_{\\text{parallel}} - U_{\\text{orthogonal}}$：\n$$ \\Delta U = \\left( -\\frac{\\mu_1 \\mu_2}{2\\pi\\varepsilon_0 R^3} \\right) - 0 = -\\frac{\\mu_1 \\mu_2}{2\\pi\\varepsilon_0 R^3} $$\n如果偶极矩 $\\mu_1$ 和 $\\mu_2$ 的单位是库仑-米，距离 $R$ 的单位是米，真空介电常数 $\\varepsilon_0$ 的单位是法拉每米，则此表达式代表以焦耳为单位的能量差。", "answer": "$$\n\\boxed{-\\frac{\\mu_1 \\mu_2}{2\\pi\\varepsilon_0 R^3}}\n$$", "id": "2942380"}, {"introduction": "真实的分子相互作用是静电、色散、诱导和交换排斥等多种效应复杂平衡的结果。本练习使用简化的解析模型来模拟常用量子化学方法（如 MP2 和 DFT-D）如何捕捉这些效应，这是一个极具启发性的思想实验。通过编程实现这些“替代模型”并与基准进行比较，你将对这些计算方法的性能和典型误差来源获得直观的认识。[@problem_id:2942360]", "problem": "您需要编写一个完整、可运行的程序，使用解析定义且具有物理动机的替代模型，来模拟氢键连接的水二聚体沿着分子间分离坐标的相互作用能曲线。这些替代模型模拟了三种广泛使用的电子结构方法。您的目标是基于基本物理贡献构建一个高级基准参考能量模型，然后在一组指定的分子间距测试集上，评估这些替代方法相对于该基准的性能。\n\n基本假设和建模假设：\n- 将每个水单体表示为其大小为 $\\mu$ 的永久偶极矩，沿分子间轴共线排列（头尾相接），这近似于氢键供体-受体的排列方式。在这种排列下，两个共线偶极子之间的偶极-偶极相互作用能为 $U_{\\mathrm{dd}}(R) = -\\dfrac{2}{4 \\pi \\varepsilon_0} \\dfrac{\\mu^2}{R^3}$。在下面使用的单位体系中，这实现为 $U_{\\mathrm{dd}}(R) = -2 k_e \\dfrac{\\mu^2}{R^3}$，其中 $k_e$ 是使用便利化学单位的库仑常数，$\\mu$ 以基本电荷-埃（$e \\cdot \\text{\\AA}$）表示。\n- 长程吸引贡献使用经过充分检验的渐近形式进行建模：\n  - 伦敦色散能 $E_{\\mathrm{disp}}(R) = - \\dfrac{C_6}{R^6}$，其中 $C_6$ 是色散系数。\n  - 感应（极化）能 $E_{\\mathrm{ind}}(R) = - \\dfrac{C_8}{R^8}$，作为极性分子与感应偶极子之间主导阶感应贡献的紧凑替代模型。\n- 短程泡利（交换）排斥通过一个陡峭的逆幂律 $E_{\\mathrm{rep}}(R) = \\dfrac{A}{R^{12}}$ 进行建模。\n\n将基准参考能量模型定义为以下各项之和\n$$\nE_{\\mathrm{bench}}(R) \\;=\\; U_{\\mathrm{dd}}(R) \\;+\\; E_{\\mathrm{disp}}(R) \\;+\\; E_{\\mathrm{ind}}(R) \\;+\\; E_{\\mathrm{rep}}(R).\n$$\n\n定义三种模拟常见电子结构方法特征行为的替代模型：\n- Møller–Plesset二阶微扰理论（MP2）：通过一个固定的比例因子 $\\delta$ 来模拟色散的过结合，\n$$\nE_{\\mathrm{MP2}}(R) \\;=\\; U_{\\mathrm{dd}}(R) \\;+\\; E_{\\mathrm{rep}}(R) \\;+\\; E_{\\mathrm{ind}}(R) \\;+\\; (1+\\delta)\\,E_{\\mathrm{disp}}(R).\n$$\n- 包含单、双和微扰三激发的耦合簇理论 [CCSD(T)]：通过一个小的基组不完备性偏移量 $\\Delta$ 来模拟接近基准的质量，\n$$\nE_{\\mathrm{CCSD(T)}}(R) \\;=\\; E_{\\mathrm{bench}}(R) \\;+\\; \\Delta.\n$$\n- 色散校正的密度泛函理论（DFT-D）：建模为用于永久静电和感应的半局域基线，并带有一个阻尼的经验色散项，其中 $s_6$ 和 $s_{\\mathrm{ind}}$ 是比例因子，$R_d$ 是阻尼长度，\n$$\nE_{\\mathrm{DFT\\!-\\!D}}(R) \\;=\\; U_{\\mathrm{dd}}(R) \\;+\\; E_{\\mathrm{rep}}(R) \\;+\\; s_{\\mathrm{ind}}\\,E_{\\mathrm{ind}}(R) \\;-\\; \\frac{s_6 \\, C_6}{R^6 + R_d^6}.\n$$\n\n所有能量必须以千焦耳每摩尔（kJ/mol）报告。所有距离必须以埃（$\\text{\\AA}$）报告和解释。下面提供了所有常数和参数，并且必须严格按照规定使用：\n\n- 化学单位中的库仑常数：$k_e = 1389.35458 \\,\\text{kJ mol}^{-1}\\,\\text{\\AA}\\,e^{-2}$。\n- 水的气相偶极矩：$\\mu = 1.85 \\,\\text{D}$。\n- 德拜转换：$1 \\,\\text{D} = 0.20819434 \\, e \\cdot \\text{\\AA}$。\n- 色散系数：$C_6 = 2588 \\,\\text{kJ}\\,\\text{\\AA}^6 \\,\\text{mol}^{-1}$。\n- 感应系数：$C_8 = 20000 \\,\\text{kJ}\\,\\text{\\AA}^8 \\,\\text{mol}^{-1}$。\n- 排斥系数：$A = 2.0 \\times 10^6 \\,\\text{kJ}\\,\\text{\\AA}^{12}\\,\\text{mol}^{-1}$。\n- MP2色散比例：$\\delta = 0.25$。\n- CCSD(T)偏移量：$\\Delta = +0.5 \\,\\text{kJ/mol}$。\n- DFT-D色散比例：$s_6 = 0.75$。\n- DFT-D感应比例：$s_{\\mathrm{ind}} = 0.90$。\n- DFT-D阻尼长度：$R_d = 2.0 \\,\\text{\\AA}$。\n\n计算要求：\n1. 通过 $\\mu_{e\\text{\\AA}} = \\mu \\times 0.20819434$ 将偶极矩转换为 $e \\cdot \\text{\\AA}$ 单位，并将其用于 $U_{\\mathrm{dd}}(R) = -2 k_e \\mu_{e\\text{\\AA}}^2 / R^3$。\n2. 对于测试集（见下文）中的每个距离 $R$，计算 $E_{\\mathrm{bench}}(R)$、$E_{\\mathrm{MP2}}(R)$、$E_{\\mathrm{CCSD(T)}}(R)$ 和 $E_{\\mathrm{DFT\\!-\\!D}}(R)$。\n3. 对于每种相对于基准的替代方法，计算在每个 $R$ 处的误差，即 $E_{\\mathrm{method}}(R) - E_{\\mathrm{bench}}(R)$，然后计算整个测试集的三个汇总统计数据：\n   - 均方根误差 (RMSE)：$\\sqrt{\\dfrac{1}{N}\\sum_{i=1}^N \\left( \\Delta E_i \\right)^2}$。\n   - 平均符号误差 (MSE)：$\\dfrac{1}{N}\\sum_{i=1}^N \\Delta E_i$。\n   - 最大绝对误差 (MaxAE)：$\\max_i \\left| \\Delta E_i \\right|$。\n   此处 $\\Delta E_i$ 表示在第 $i$ 个距离处的误差，$N$ 是距离的数量。\n\n测试集：\n- 使用以下距离（单位为埃）：$R \\in \\{\\, 2.5,\\, 2.8,\\, 3.0,\\, 3.5,\\, 4.5,\\, 8.0 \\,\\}$。\n\n答案规格：\n- 您的程序必须生成单行输出，其中包含一个用逗号分隔的9个浮点数列表，四舍五入到三位小数，并用方括号括起来，顺序如下：\n  - $[\\mathrm{RMSE}_{\\mathrm{MP2}}, \\mathrm{MSE}_{\\mathrm{MP2}}, \\mathrm{MaxAE}_{\\mathrm{MP2}}, \\mathrm{RMSE}_{\\mathrm{CCSD(T)}}, \\mathrm{MSE}_{\\mathrm{CCSD(T)}}, \\mathrm{MaxAE}_{\\mathrm{CCSD(T)}}, \\mathrm{RMSE}_{\\mathrm{DFT\\!-\\!D}}, \\mathrm{MSE}_{\\mathrm{DFT\\!-\\!D}}, \\mathrm{MaxAE}_{\\mathrm{DFT\\!-\\!D}}]$。\n- 单位：输出中所有能量的隐含单位均为 $\\text{kJ/mol}$。不应打印任何单位。\n- 四舍五入：每个报告的数字都必须四舍五入到三位小数。\n\n您的程序必须完全自包含，不需要任何输入，并且只能使用 Python 标准库和指定的数值库。结果必须能根据上述常数和定义精确复现。", "solution": "问题陈述已经过分析，并被认为是有效的。它构成了一个物理化学中明确定义的计算练习，要求实现解析势能模型并对其相对于基准的性能进行统计评估。这些模型虽然经过简化，但均基于已确立的分子间作用力物理原理。所有常数、参数和函数形式都已明确提供，没有歧义，使得该问题是自包含且易于处理的。\n\n解题过程如下。首先，我们定义所有指定的物理常数和模型参数。其次，我们为总相互作用能的各个能量贡献项建立函数。第三，我们为基准和三种替代方法构建总能量函数。第四，我们在给定的分子间距集合上计算每种替代方法相对于基准的建模误差。最后，我们计算所需的汇总误差统计数据：均方根误差（RMSE）、平均符号误差（MSE）和最大绝对误差（MaxAE）。\n\n所有能量单位为 $\\text{kJ/mol}$，距离单位为 $\\text{\\AA}$。\n\n所需的物理常数和模型参数如下：\n- 库仑常数：$k_e = 1389.35458 \\,\\text{kJ mol}^{-1}\\,\\text{\\AA}\\,e^{-2}$\n- 水的偶极矩：$\\mu = 1.85 \\,\\text{D}$\n- 德拜转换因子：$1 \\,\\text{D} = 0.20819434 \\, e \\cdot \\text{\\AA}$\n- 排斥系数：$A = 2.0 \\times 10^6 \\,\\text{kJ}\\,\\text{\\AA}^{12}\\,\\text{mol}^{-1}$\n- 色散系数：$C_6 = 2588 \\,\\text{kJ}\\,\\text{\\AA}^6 \\,\\text{mol}^{-1}$\n- 感应系数：$C_8 = 20000 \\,\\text{kJ}\\,\\text{\\AA}^8 \\,\\text{mol}^{-1}$\n- MP2色散比例：$\\delta = 0.25$\n- CCSD(T)偏移量：$\\Delta = +0.5 \\,\\text{kJ/mol}$\n- DFT-D色散比例：$s_6 = 0.75$\n- DFT-D感应比例：$s_{\\mathrm{ind}} = 0.90$\n- DFT-D阻尼长度：$R_d = 2.0 \\,\\text{\\AA}$\n\n偶极矩必须首先转换为所需的单位 $e \\cdot \\text{\\AA}$：\n$$ \\mu_{e\\text{\\AA}} = \\mu \\times 0.20819434 = 1.85 \\times 0.20819434 \\approx 0.3851595 \\, e \\cdot \\text{\\AA} $$\n\n四个基本能量分量定义为分子间距 $R$ 的函数：\n1.  偶极-偶极相互作用：$U_{\\mathrm{dd}}(R) = -2 k_e \\dfrac{\\mu_{e\\text{\\AA}}^2}{R^3}$\n2.  交换-排斥：$E_{\\mathrm{rep}}(R) = \\dfrac{A}{R^{12}}$\n3.  伦敦色散：$E_{\\mathrm{disp}}(R) = - \\dfrac{C_6}{R^6}$\n4.  感应：$E_{\\mathrm{ind}}(R) = - \\dfrac{C_8}{R^8}$\n\n基准模型是这些分量的总和：\n$$ E_{\\mathrm{bench}}(R) = U_{\\mathrm{dd}}(R) + E_{\\mathrm{rep}}(R) + E_{\\mathrm{disp}}(R) + E_{\\mathrm{ind}}(R) $$\n\n三种替代模型定义如下：\n$$ E_{\\mathrm{MP2}}(R) = U_{\\mathrm{dd}}(R) + E_{\\mathrm{rep}}(R) + E_{\\mathrm{ind}}(R) + (1+\\delta) E_{\\mathrm{disp}}(R) $$\n$$ E_{\\mathrm{CCSD(T)}}(R) = E_{\\mathrm{bench}}(R) + \\Delta $$\n$$ E_{\\mathrm{DFT-D}}(R) = U_{\\mathrm{dd}}(R) + E_{\\mathrm{rep}}(R) + s_{\\mathrm{ind}} E_{\\mathrm{ind}}(R) - \\frac{s_6 C_6}{R^6 + R_d^6} $$\n\n每种方法的误差 $\\Delta E_{\\mathrm{method}}(R) = E_{\\mathrm{method}}(R) - E_{\\mathrm{bench}}(R)$，可以通过代入上述表达式进行简化：\n- 对于 MP2：\n$$ \\Delta E_{\\mathrm{MP2}}(R) = \\left(U_{\\mathrm{dd}} + E_{\\mathrm{rep}} + E_{\\mathrm{ind}} + (1+\\delta)E_{\\mathrm{disp}}\\right) - \\left(U_{\\mathrm{dd}} + E_{\\mathrm{rep}} + E_{\\mathrm{disp}} + E_{\\mathrm{ind}}\\right) = \\delta E_{\\mathrm{disp}}(R) = -\\frac{\\delta C_6}{R^6} $$\n- 对于 CCSD(T)：\n$$ \\Delta E_{\\mathrm{CCSD(T)}}(R) = (E_{\\mathrm{bench}}(R) + \\Delta) - E_{\\mathrm{bench}}(R) = \\Delta $$\n- 对于 DFT-D：\n$$ \\Delta E_{\\mathrm{DFT-D}}(R) = \\left(U_{\\mathrm{dd}} + E_{\\mathrm{rep}} + s_{\\mathrm{ind}}E_{\\mathrm{ind}} - \\frac{s_6 C_6}{R^6+R_d^6}\\right) - \\left(U_{\\mathrm{dd}} + E_{\\mathrm{rep}} + E_{\\mathrm{disp}} + E_{\\mathrm{ind}}\\right) $$\n$$ \\Delta E_{\\mathrm{DFT-D}}(R) = (s_{\\mathrm{ind}}-1)E_{\\mathrm{ind}}(R) - E_{\\mathrm{disp}}(R) - \\frac{s_6 C_6}{R^6+R_d^6} $$\n$$ \\Delta E_{\\mathrm{DFT-D}}(R) = -(s_{\\mathrm{ind}}-1)\\frac{C_8}{R^8} + \\frac{C_6}{R^6} - \\frac{s_6 C_6}{R^6+R_d^6} $$\n\n这些误差函数针对测试集 $R \\in \\{2.5, 2.8, 3.0, 3.5, 4.5, 8.0\\}$ 中的每个距离 $R_i$ 进行评估，为每种方法产生一组 $N=6$ 个误差值 $\\{\\Delta E_i\\}$。然后按如下方式计算汇总统计数据：\n- 均方根误差 (RMSE)：$\\sqrt{\\dfrac{1}{N}\\sum_{i=1}^N (\\Delta E_i)^2}$\n- 平均符号误差 (MSE)：$\\dfrac{1}{N}\\sum_{i=1}^N \\Delta E_i$\n- 最大绝对误差 (MaxAE)：$\\max_i |\\Delta E_i|$\n\n对于 CCSD(T) 模型，误差是恒定的，$\\Delta E_i = \\Delta = 0.5$。因此，其统计数据是显而易见的：\n- $\\mathrm{RMSE}_{\\mathrm{CCSD(T)}} = \\sqrt{\\frac{1}{N}\\sum \\Delta^2} = |\\Delta| = 0.5$\n- $\\mathrm{MSE}_{\\mathrm{CCSD(T)}} = \\frac{1}{N}\\sum \\Delta = \\Delta = 0.5$\n- $\\mathrm{MaxAE}_{\\mathrm{CCSD(T)}} = \\max |\\Delta| = |\\Delta| = 0.5$\n\nMP2 和 DFT-D 模型的统计数据需要在指定的距离测试集上进行数值计算。最终答案中的程序精确地实现了这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and assesses surrogate models for water dimer interaction energy.\n    \"\"\"\n    \n    # Define constants and parameters\n    KE = 1389.35458  # Coulomb constant (kJ/mol * A * e^-2)\n    MU_D = 1.85  # Water dipole moment (Debye)\n    D_TO_EA = 0.20819434  # Debye to e*A conversion\n    C6 = 2588.0  # Dispersion coefficient (kJ*A^6/mol)\n    C8 = 20000.0  # Induction coefficient (kJ*A^8/mol)\n    A = 2.0e6  # Repulsion coefficient (kJ*A^12/mol)\n    \n    # Model parameters\n    DELTA_MP2 = 0.25      # MP2 dispersion scaling\n    DELTA_CCSDT = 0.5     # CCSD(T) offset (kJ/mol)\n    S6_DFTD = 0.75        # DFT-D dispersion scale factor\n    S_IND_DFTD = 0.90     # DFT-D induction scale factor\n    RD_DFTD = 2.0         # DFT-D damping length (A)\n    \n    # Test suite of separations (in Angstrom)\n    R_values = np.array([2.5, 2.8, 3.0, 3.5, 4.5, 8.0])\n    \n    # Convert dipole moment to e*A\n    mu_eA = MU_D * D_TO_EA\n    \n    # --- Define energy component functions ---\n    def u_dd(R):\n        return -2 * KE * mu_eA**2 / R**3\n    \n    def e_rep(R):\n        return A / R**12\n    \n    def e_disp(R):\n        return -C6 / R**6\n        \n    def e_ind(R):\n        return -C8 / R**8\n        \n    # --- Define total energy models ---\n    def e_bench(R):\n        return u_dd(R) + e_rep(R) + e_disp(R) + e_ind(R)\n        \n    def e_mp2(R):\n        return u_dd(R) + e_rep(R) + e_ind(R) + (1 + DELTA_MP2) * e_disp(R)\n        \n    def e_ccsdt(R):\n        return e_bench(R) + DELTA_CCSDT\n        \n    def e_dftd(R):\n        damped_disp = - (S6_DFTD * C6) / (R**6 + RD_DFTD**6)\n        return u_dd(R) + e_rep(R) + S_IND_DFTD * e_ind(R) + damped_disp\n\n    # --- Calculate errors for each model relative to the benchmark ---\n    bench_energies = e_bench(R_values)\n    \n    mp2_errors = e_mp2(R_values) - bench_energies\n    ccsdt_errors = e_ccsdt(R_values) - bench_energies\n    dftd_errors = e_dftd(R_values) - bench_energies\n    \n    # --- Helper function to compute error statistics ---\n    def calculate_stats(errors):\n        \"\"\"Calculates RMSE, MSE, and MaxAE for a given array of errors.\"\"\"\n        rmse = np.sqrt(np.mean(np.square(errors)))\n        mse = np.mean(errors)\n        max_ae = np.max(np.abs(errors))\n        return rmse, mse, max_ae\n\n    # --- Compute and collect all statistics ---\n    stats_mp2 = calculate_stats(mp2_errors)\n    stats_ccsdt = calculate_stats(ccsdt_errors)\n    stats_dftd = calculate_stats(dftd_errors)\n    \n    all_stats = list(stats_mp2) + list(stats_ccsdt) + list(stats_dftd)\n    \n    # Format the results for printing\n    # Each number is rounded to three decimal places.\n    formatted_results = [f\"{s:.3f}\" for s in all_stats]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2942360"}, {"introduction": "建立微观相互作用与宏观物质性质之间的桥梁是物理化学的核心任务之一。这项练习将带领你完成这一过程，即使用统计力学的工具，从一个经典的 Lennard-Jones 微观对势出发，计算流体的宏观博伊尔温度。该过程要求你应用数值积分和求根等关键计算科学技能，从而将理论概念转化为可预测的物理量。[@problem_id:2942370]", "problem": "对于具有成对可加相互作用的单原子气体，在低密度区域可通过物态方程的维里展开来描述，其中第二维里系数 $B_2(T)$ 表征了对理想气体行为的主导修正。对于球对称相互作用，一个基本且经过充分检验的出发点是第二维里系数的 Mayer $f$-函数表示法：\n$$\nB_2(T) \\;=\\; -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\!\\left( -\\beta\\,U(r) \\right) - 1 \\right] r^2 \\, dr \\,,\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$U(r)$ 是作为分离距离 $r$ 的函数的对势。考虑一个 Lennard–Jones (LJ) 流体，其势函数定义为\n$$\nU(r) \\;=\\; 4\\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} \\;-\\; \\left( \\frac{\\sigma}{r} \\right)^6 \\right],\n$$\n其中 $\\epsilon$ 是能量尺度，$\\sigma$ 是长度尺度。玻义耳温度 $T_{\\mathrm{B}}$ 由条件 $B_2(T_{\\mathrm{B}})=0$ 定义。\n\n您的任务是编写一个完整、可运行的程序，仅从上述定义出发，以数值稳健的方式完成以下所有操作：\n\n- 通过对定义积分进行数值积分，计算任意 $(\\epsilon,\\sigma,T)$ 的 $B_2(T)$。\n- 执行数学上合理的无量纲化，将积分简化为约化温度 $T^\\star = k_{\\mathrm{B}}T/\\epsilon$ 的单参数函数，并利用此简化来定位满足 $B_2(T^\\star_{\\mathrm{B}})=0$ 的 $T^\\star_{\\mathrm{B}}$。\n- 将 $T^\\star_{\\mathrm{B}}$ 转换为以开尔文为单位的玻义耳温度，使用一种约定，其中 $\\epsilon/k_{\\mathrm{B}}$ 以开尔文为单位指定。也就是说，如果 $\\epsilon/k_{\\mathrm{B}}$ 以开尔文为单位给出，则 $T_{\\mathrm{B}} = T^\\star_{\\mathrm{B}} \\, (\\epsilon/k_{\\mathrm{B}})$（单位为开尔文）。\n- 使用具有明确区间限定和容差控制的数值稳定求根方法来找到 $T^\\star_{\\mathrm{B}}$，并使用具有明确绝对和相对误差容差的数值积分方法来评估积分。\n\n科学和算法要求：\n\n- 通过变量替换 $r = \\sigma \\rho$ 推导出 $B_2(T)$ 的无量纲积分表示，并从定义出发，确定 $\\sigma$ 和 $\\epsilon$ 如何进入结果。请勿使用任何预先制表的约化维里系数数据。\n- 以准确和收敛的方式实现半无限区间 $\\rho \\in [0,\\infty)$ 上的数值积分。对于每次积分评估，将绝对误差控制在 $\\leq 10^{-8}$，相对误差控制在 $\\leq 10^{-8}$。\n- 在搜索域 $T^\\star \\in [10^{-2}, 10^{2}]$ 上为根 $T^\\star_{\\mathrm{B}}$ 实现一个稳健的符号区间限定策略，然后使用一个区间限定求根器，将 $T^\\star$ 的容差控制在 $\\leq 10^{-6}$ 以内。\n- 函数 $B_2(T)$ 应从上述基本积分定义计算得出；您可以使用 $B_2(T) = -2\\pi \\int [\\exp(-\\beta U)-1] r^2 dr$ 或等价的 $B_2(T) = 2\\pi \\int [1-\\exp(-\\beta U)] r^2 dr$ 恒等式，但必须保持一致。\n\n物理单位和输出规范：\n\n- 将 $\\epsilon/k_{\\mathrm{B}}$ 视为以开尔文为单位，将 $\\sigma$ 视为以米为单位。您必须报告以开尔文为单位的玻义耳温度 $T_{\\mathrm{B}}$，并精确到三位小数。\n- 输出中不需要其他经过单位转换的量。任何用于数值计算的中间 $B_2$ 值都可以用约化的无量纲形式进行。如果您计算任何有量纲的 $B_2$，其自然单位是 $\\sigma^3$；但是，您不需要输出 $B_2$。\n- 不涉及角度；不需要角度单位。\n\n测试套件和覆盖范围：\n\n实现您的程序以处理以下参数集，每个参数集指定为 $(\\epsilon/k_{\\mathrm{B}} \\text{ 单位为开尔文}, \\sigma \\text{ 单位为米})$：\n\n- 情况 1: $(120.0,\\; 3.40\\times 10^{-10})$\n- 情况 2: $(200.0,\\; 3.40\\times 10^{-10})$\n- 情况 3: $(120.0,\\; 4.00\\times 10^{-10})$\n- 情况 4: $(60.0,\\; 3.00\\times 10^{-10})$\n- 情况 5: $(500.0,\\; 3.40\\times 10^{-10})$\n\n对于每种情况，计算以开尔文为单位的玻义耳温度 $T_{\\mathrm{B}}$。您的程序应生成单行输出，其中包含五个结果，形式为方括号内由逗号分隔的列表，按上述顺序排列，每个值精确到三位小数，例如 $[\\dots]$。\n\n设计思路：\n\n- 您的实现必须直接反映上述第一性原理定义。数值算法应明确地编码来自定义的无量纲化、在 $\\rho \\in [0,\\infty)$ 上的数值积分以及对 $T^\\star_{\\mathrm{B}}$ 的区间限定求根。\n- 您的代码应自成一体，在运行时无需任何输入。所有常量和参数必须在程序内部定义。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于统计力学原理，问题定义明确、客观，并包含了获得唯一解所需的所有必要信息。任务是计算Lennard-Jones流体的玻义耳温度 $T_{\\mathrm{B}}$，这是物理化学中一个标准的、可解的问题。\n\n解决方案分两个主要阶段进行：首先是简化问题的理论推导，其次是计算所需值的数值实现。\n\n**1. 第二维里系数的无量纲化**\n\n分析从第二维里系数 $B_2(T)$ 和Lennard-Jones (LJ) 势 $U(r)$ 的给定定义开始。\n\n第二维里系数由下式给出：\n$$\nB_2(T) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\beta U(r) \\right) - 1 \\right] r^2 \\, dr\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}} T)$。LJ 势为：\n$$\nU(r) = 4\\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right]\n$$\n指数函数的自变量 $-\\beta U(r)$ 可以使用约化温度 $T^\\star = k_{\\mathrm{B}}T/\\epsilon$ 重写为：\n$$\n-\\beta U(r) = -\\frac{U(r)}{k_{\\mathrm{B}}T} = -\\frac{4\\epsilon}{k_{\\mathrm{B}}T} \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] = -\\frac{4}{T^\\star} \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right]\n$$\n为了创建一个无量纲积分，我们引入约化距离 $\\rho = r/\\sigma$，这意味着 $r = \\sigma\\rho$ 且 $dr = \\sigma d\\rho$。$\\rho$ 的积分极限从 $0$ 到 $\\infty$ 不变。将这些代入 $B_2(T)$ 的表达式中：\n$$\nB_2(T) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star} \\left[ \\left( \\frac{\\sigma}{\\sigma\\rho} \\right)^{12} - \\left( \\frac{\\sigma}{\\sigma\\rho} \\right)^6 \\right] \\right) - 1 \\right] (\\sigma\\rho)^2 (\\sigma d\\rho)\n$$\n简化积分内的项：\n$$\nB_2(T) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star} \\left( \\rho^{-12} - \\rho^{-6} \\right) \\right) - 1 \\right] \\sigma^2 \\rho^2 \\sigma d\\rho\n$$\n有量纲的常数 $\\sigma^3$ 可以从积分中提出来：\n$$\nB_2(T) = -2\\pi \\sigma^3 \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star} \\left( \\rho^{-12} - \\rho^{-6} \\right) \\right) - 1 \\right] \\rho^2 d\\rho\n$$\n这个方程表明，$B_2(T)$ 与 $\\sigma^3$ 成正比，并且与一个仅依赖于约化温度 $T^\\star$ 的无量纲积分成正比。让我们将约化第二维里系数定义为 $B_2^\\star(T^\\star) = B_2(T)/\\sigma^3$。\n\n玻义耳温度 $T_{\\mathrm{B}}$ 由条件 $B_2(T_{\\mathrm{B}}) = 0$ 定义。用我们的约化量表示，这变为：\n$$\n-2\\pi \\sigma^3 \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star_{\\mathrm{B}}} \\left( \\rho^{-12} - \\rho^{-6} \\right) \\right) - 1 \\right] \\rho^2 d\\rho = 0\n$$\n其中 $T^\\star_{\\mathrm{B}} = k_{\\mathrm{B}}T_{\\mathrm{B}}/\\epsilon$。由于 $\\sigma \\neq 0$ 且 $-2\\pi \\neq 0$，该条件简化为找到积分本身的根：\n$$\nI(T^\\star) = \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star} \\left( \\rho^{-12} - \\rho^{-6} \\right) \\right) - 1 \\right] \\rho^2 d\\rho = 0\n$$\n满足此方程的 $T^\\star_{\\mathrm{B}}$ 值对于任何由 LJ 势描述的物质来说都是一个普适常数。特定物质的参数 $\\epsilon$ 和 $\\sigma$ 仅通过关系式 $T_{\\mathrm{B}} = (\\epsilon/k_{\\mathrm{B}}) T^\\star_{\\mathrm{B}}$ 将结果缩放到物理温度 $T_{\\mathrm{B}}$。请注意，$\\sigma$ 的值与确定 $T_{\\mathrm{B}}$ 完全无关。\n\n**2. 数值策略**\n\n数值任务的核心是找到函数 $I(T^\\star)$ 的根。\n\n**数值积分：** 半无限区间 $[0, \\infty)$ 上的积分 $I(T^\\star)$ 使用数值积分进行评估。`scipy.integrate.quad` 函数非常适合此目的，因为它是一个自适应例程，可以处理无限积分限和用户指定的误差容差。根据要求，积分的绝对和相对误差容差将设置为 $10^{-8}$。\n\n**求根：** 问题要求使用一个区间限定求根器。将使用 `scipy.optimize.brentq` 算法，该算法需要一个区间 $[a, b]$，其中 $I(a)$ 和 $I(b)$ 的符号相反。$B_2(T)$ 的物理行为指导了这个区间的选择。\n- 在低温下（小的 $T^\\star$），势的吸引部分（$U  0$）主导分子间相互作用。这使得 $\\exp(-\\beta U) \\gg 1$，导致对于 $\\rho > 1$ 的被积函数为正。总积分 $I(T^\\star)$ 为正，因此 $B_2(T)$ 为负。\n- 在高温下（大的 $T^\\star$），势的排斥核心（$U  0$）占主导地位，因为粒子有足够的动能探测短距离。这导致了有效的排除体积，类似于硬球，从而产生正的 $B_2(T)$。为了使 $B_2(T)$ 为正，积分 $I(T^\\star)$ 必须为负。\n\n因此，随着 $T^\\star$ 的增加，函数 $I(T^\\star)$ 从正值过渡到负值，这保证了根 $T^\\star_{\\mathrm{B}}$ 的存在。在指定范围 $[10^{-2}, 10^{2}]$ 内的搜索确认，像 $[1, 5]$ 这样的区间提供了一个有效的括号（$I(1)  0$ 且 $I(5)  0$）。然后使用 `brentq` 算法找到 $T^\\star_{\\mathrm{B}}$，容差为 $10^{-6}$。\n\n**最终计算：** 一旦通过数值计算得到普适常数 $T^\\star_{\\mathrm{B}}$，就可以为每个测试用例使用其特定的 $\\epsilon/k_{\\mathrm{B}}$ 值计算其玻义耳温度 $T_{\\mathrm{B}}$：\n$$\nT_{\\mathrm{B}} = T^\\star_{\\mathrm{B}} \\times \\left( \\frac{\\epsilon}{k_{\\mathrm{B}}} \\right)\n$$\n最终结果按要求四舍五入到三位小数。\n\n所提供的 Python 代码从第一性原理实现了这一策略。它定义了一个用于无量纲积分 $I(T^\\star)$ 的函数，通过数值方法找到其根以获得 $T^\\star_{\\mathrm{B}}$，然后为给定的测试套件计算并格式化 $T_{\\mathrm{B}}$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Computes the Boyle temperature for a Lennard-Jones fluid for several parameter sets.\n\n    The solution is based on the first-principles definition of the second virial coefficient B2(T).\n    1. The integral for B2(T) is non-dimensionalized, showing that the Boyle condition B2(T_B) = 0\n       is equivalent to finding a universal reduced Boyle temperature T_star_B where a dimensionless\n       integral is zero.\n    2. The dimensionless integral is defined as a function of the reduced temperature T_star.\n    3. The root of this integral function, T_star_B, is found using a robust numerical root-finder\n       (Brent's method) after establishing a valid bracket.\n    4. The numerical quadrature for the integral is performed using SciPy's `quad` function with\n       specified high precision.\n    5. The universal T_star_B is then used to calculate the Boyle temperature T_B for each\n       test case using its specific energy parameter epsilon.\n    \"\"\"\n\n    def get_reduced_b2_integral(t_star):\n        \"\"\"\n        Calculates the dimensionless integral part of the second virial coefficient B2.\n        The Boyle temperature occurs when this integral is zero.\n        \n        The integral is: integral_{0 to inf} [exp(-U*(rho)/T_star) - 1] * rho^2 drho\n        where U*(rho) = 4 * (rho^-12 - rho^-6).\n\n        Args:\n            t_star (float): The reduced temperature, T* = k_B*T / epsilon.\n\n        Returns:\n            float: The value of the dimensionless integral.\n        \"\"\"\n        # The Lennard-Jones potential in reduced units U*(rho) = U(r/sigma)/epsilon\n        # is U* = 4 * (rho**-12 - rho**-6).\n        # The argument of the exponential is -U*/T_star.\n        integrand = lambda rho: (np.exp(-4.0 / t_star * (rho**-12 - rho**-6)) - 1.0) * rho**2\n\n        # Perform numerical quadrature over the semi-infinite interval [0, inf).\n        # The tolerances are set as specified in the problem statement.\n        integral_val, _ = integrate.quad(\n            integrand,\n            0,\n            np.inf,\n            epsabs=1e-8,\n            epsrel=1e-8\n        )\n        return integral_val\n\n    # Find the universal reduced Boyle temperature, T_star_B.\n    # This is done by finding the root of the get_reduced_b2_integral function.\n    \n    # First, establish a bracketing interval [a, b] where the function values have opposite signs.\n    # Based on physical principles, at low T*, attractions dominate, B2  0, so integral > 0.\n    # At high T*, repulsions dominate, B2 > 0, so integral  0.\n    # We will search for a root in the specified domain T* in [0.01, 100].\n    # Let's test a reasonable bracket, e.g., [1.0, 5.0].\n    bracket_a, bracket_b = 1.0, 5.0\n    \n    val_a = get_reduced_b2_integral(bracket_a)\n    val_b = get_reduced_b2_integral(bracket_b)\n\n    # Sanity check for the bracket\n    if np.sign(val_a) == np.sign(val_b):\n        raise ValueError(\n            f\"The chosen interval [{bracket_a}, {bracket_b}] does not bracket the root. \"\n            f\"Function values are {val_a} and {val_b}.\"\n        )\n\n    # Use a robust bracketing root-finder (Brent's method) to find T_star_B with the required tolerance.\n    reduced_boyle_temp = optimize.brentq(\n        get_reduced_b2_integral,\n        bracket_a,\n        bracket_b,\n        xtol=1e-6\n    )\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (epsilon/k_B in Kelvin, sigma in meters).\n    test_cases = [\n        (120.0, 3.40e-10),  # Case 1\n        (200.0, 3.40e-10),  # Case 2\n        (120.0, 4.00e-10),  # Case 3\n        (60.0, 3.00e-10),   # Case 4\n        (500.0, 3.40e-10),  # Case 5\n    ]\n\n    results = []\n    for eps_k_val, sigma_val in test_cases:\n        # The Boyle temperature T_B = T_star_B * (epsilon / k_B).\n        # The length scale sigma is not needed for this calculation, as shown by non-dimensionalization.\n        boyle_temp_kelvin = reduced_boyle_temp * eps_k_val\n        results.append(boyle_temp_kelvin)\n\n    # Format the results into a single string as required.\n    # Each value must be rounded to exactly three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2942370"}]}