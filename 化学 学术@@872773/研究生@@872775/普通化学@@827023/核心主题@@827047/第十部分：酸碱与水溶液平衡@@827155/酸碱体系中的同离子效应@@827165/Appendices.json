{"hands_on_practices": [{"introduction": "虽然亨德森-哈塞尔巴赫方程等简化公式非常有用，但研究生水平的理解要求我们能够从质量平衡、电荷平衡和化学平衡等基本定律出发进行推导。这项练习 ([@problem_id:2958738]) 训练我们为一种常见的缓冲体系建立并求解完整的平衡方程组，并明确考虑水的自偶电离效应，这是精确计算的基础。通过这种方式，我们可以深刻理解同离子效应对弱电解质电离的抑制作用。", "problem": "一个在$25^{\\circ}\\mathrm{C}$下的水溶液含有氨 $\\mathrm{NH_3}$ 和氯化铵 $\\mathrm{NH_4Cl}$，其分析浓度分别为 $0.20\\,\\mathrm{M}$ 和 $0.10\\,\\mathrm{M}$。将该溶液视为理想稀溶液（活度系数等于$1$）。在$25^{\\circ}\\mathrm{C}$时，氨的碱解离常数 $K_{b} = 1.8 \\times 10^{-5}$。在$25^{\\circ}\\mathrm{C}$时，水的自偶电离常数 $K_{w} = 1.0 \\times 10^{-14}$。\n\n仅从质量守恒、电荷中性的基本陈述以及平衡常数的定义出发，为$\\mathrm{NH_4^+}/\\mathrm{NH_3}$和水的平衡体系建立并求解耦合非线性平衡问题。不要假设水的自偶电离是可忽略的；通过$K_{w}$明确地将其包含在内。计算溶液的氢离子浓度并报告pH值。将最终的pH值四舍五入到四位有效数字。以pH（无单位）的形式表达最终答案。", "solution": "该问题提法恰当且科学上合理，符合化学平衡的基本原理。所有必要的数据都已提供，且约束条件一致。这是一个有效的问题。\n\n水溶液中包含以下物种：$\\mathrm{NH_3}$、$\\mathrm{NH_4^+}$、$\\mathrm{Cl^-}$、$\\mathrm{H^+}$（等同于$\\mathrm{H_3O^+}$）和$\\mathrm{OH^-}$。溶剂是水，$\\mathrm{H_2O}$。\n\n该系统由两个同时存在的平衡控制：\n$1$. 氨的碱解离：\n$$\\mathrm{NH_3} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{NH_4^+} + \\mathrm{OH^-}$$\n其平衡常数为 $K_b = \\frac{[\\mathrm{NH_4^+}][\\mathrm{OH^-}]}{[\\mathrm{NH_3}]} = 1.8 \\times 10^{-5}$。\n\n$2$. 水的自偶电离：\n$$\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-}$$\n其平衡常数为 $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.0 \\times 10^{-14}$。\n\n为严谨起见，使用铵离子$\\mathrm{NH_4^+}$的酸解离$\\mathrm{NH_4^+} \\rightleftharpoons \\mathrm{NH_3} + \\mathrm{H^+}$会很方便，其常数$K_a$与$K_b$和$K_w$通过表达式 $K_a K_b = K_w$ 相关联。\n$$K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]} = \\frac{K_w}{K_b} = \\frac{1.0 \\times 10^{-14}}{1.8 \\times 10^{-5}}$$\n$$K_a = \\frac{5}{9} \\times 10^{-9} \\approx 5.556 \\times 10^{-10}$$\n\n为了确定平衡浓度，我们基于基本守恒定律建立一个方程组。\n\n首先，是质量平衡方程。\n氯化铵 $\\mathrm{NH_4Cl}$ 是一种强电解质，会完全解离。氯离子 $\\mathrm{Cl^-}$ 是一个旁观离子，其浓度由$\\mathrm{NH_4Cl}$的初始分析浓度决定：\n$$[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}} = 0.10\\,\\mathrm{M}$$\n含氮物种（“氨族”）的总浓度是守恒的。它是加入溶液中的氨和氯化铵的分析浓度之和：\n$$C_{T} = [\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}} = 0.20\\,\\mathrm{M} + 0.10\\,\\mathrm{M} = 0.30\\,\\mathrm{M}$$\n\n其次，是电荷平衡方程（电中性原理）。总正电荷浓度必须等于总负电荷浓度：\n$$[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$$\n\n我们得到了一个包含五个独立方程的方程组，用于求解五个未知浓度（$[\\mathrm{NH_3}]$、$[\\mathrm{NH_4^+}]$、$[\\mathrm{H^+}]$、$[\\mathrm{OH^-}]$、$[\\mathrm{Cl^-}]$）：\n$1$. $K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]}$\n$2$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$3$. $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$\n$4$. $[\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{T}$\n$5$. $[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$\n\n为了求解该方程组，我们将所有未知浓度用一个单一的主变量来表示，我们选择 $h=[\\mathrm{H^+}]$。\n\n根据$K_a$的定义和总氮质量平衡，我们将$[\\mathrm{NH_3}]$和$[\\mathrm{NH_4^+}]$表示为$C_T$的分数形式：\n从 $K_a = \\frac{(C_T - [\\mathrm{NH_4^+}]) h}{[\\mathrm{NH_4^+}]}$，我们求解$[\\mathrm{NH_4^+}]$：\n$$[\\mathrm{NH_4^+}] = C_T \\frac{h}{K_a + h}$$\n以及$[\\mathrm{NH_3}]$：\n$$[\\mathrm{NH_3}] = C_T - [\\mathrm{NH_4^+}] = C_T \\left(1 - \\frac{h}{K_a + h}\\right) = C_T \\frac{K_a}{K_a + h}$$\n\n从水的自偶电离常数，我们有：\n$$[\\mathrm{OH^-}] = \\frac{K_w}{h}$$\n\n现在，我们将这些表达式以及$[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$代入电荷平衡方程：\n$$C_T \\frac{h}{K_a + h} + h = C_{\\mathrm{NH_4Cl}} + \\frac{K_w}{h}$$\n这是关于$h = [\\mathrm{H^+}]$的精确方程。为了求解它，我们将其整理成多项式形式。所有项乘以$h(K_a + h)$:\n$$C_T h^2 + h^2(K_a + h) = C_{\\mathrm{NH_4Cl}} h(K_a + h) + K_w(K_a + h)$$\n$$C_T h^2 + K_a h^2 + h^3 = C_{\\mathrm{NH_4Cl}} K_a h + C_{\\mathrm{NH_4Cl}} h^2 + K_w K_a + K_w h$$\n按$h$的幂次合并同类项：\n$$h^3 + (C_T + K_a - C_{\\mathrm{NH_4Cl}}) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\n将$C_T = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}}$代入$h^2$项的系数中：\n$$h^3 + (C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\n这是关于氢离子浓度$h$的精确三次多项式。\n\n虽然这个三次方程可以数值求解，但通过分析各项的量级，可以得到一个高精度的解析解。对于这个缓冲体系，我们预期pH值接近$\\mathrm{p}K_a \\approx 9.26$，因此$h$将是一个小数（约为$10^{-10}\\,\\mathrm{M}$量级）。\n让我们使用$C_{\\mathrm{NH_3}} = 0.20$、$C_{\\mathrm{NH_4Cl}} = 0.10$、$K_a = \\frac{5}{9} \\times 10^{-9}$和$K_w = 1.0 \\times 10^{-14}$来考察这些系数。\n$h^2$的系数是$C_{\\mathrm{NH_3}} + K_a \\approx 0.20$。\n$h$的系数是$-(C_{\\mathrm{NH_4Cl}} K_a + K_w) \\approx -(0.10 \\times 5.56 \\times 10^{-10}) = -5.56 \\times 10^{-11}$。\n常数项是$-K_w K_a \\approx -5.56 \\times 10^{-24}$。\n$h^3$项和常数项比$h^2$项和$h$项小好几个数量级。例如，如果$h \\approx 10^{-10}$，那么$h^3 \\approx 10^{-30}$，常数项约为$-5.56 \\times 10^{-24}$。$h^2$项约为$0.2 \\times 10^{-20}$，$h$项约为$-5.56 \\times 10^{-11} \\times 10^{-10} = -5.56 \\times 10^{-21}$。\n忽略$h^3$和$-K_w K_a$项可以提供一个极好的近似。三次方程简化为关于$h$的线性方程：\n$$(C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h \\approx 0$$\n因为$h \\neq 0$，我们可以除以$h$：\n$$(C_{\\mathrm{NH_3}} + K_a) h \\approx C_{\\mathrm{NH_4Cl}} K_a + K_w$$\n$$h \\approx \\frac{C_{\\mathrm{NH_4Cl}} K_a + K_w}{C_{\\mathrm{NH_3}} + K_a}$$\n这个近似等价于将电荷平衡方程简化为$[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] \\approx [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$，并在溶液为碱性的情况下忽略$[\\mathrm{H^+}]$项，即$[\\mathrm{NH_4^+}] \\approx [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$，但正确地保留所有其他物种。\n\n现在，我们计算$h$的数值：\n$$h = \\frac{(0.10) \\left(\\frac{5}{9} \\times 10^{-9}\\right) + (1.0 \\times 10^{-14})}{0.20 + \\left(\\frac{5}{9} \\times 10^{-9}\\right)}$$\n$$h = \\frac{5.5555... \\times 10^{-11} + 1.0 \\times 10^{-14}}{0.20000000055...}$$\n$$h = \\frac{5.556555... \\times 10^{-11}}{0.20000000055...} \\approx 2.778277... \\times 10^{-10}\\,\\mathrm{M}$$\n最后，我们计算pH值：\n$$\\mathrm{pH} = -\\log_{10}(h) = -\\log_{10}(2.778277... \\times 10^{-10})$$\n$$\\mathrm{pH} \\approx 9.55622...$$\n按要求将结果四舍五入至四位有效数字：\n$$\\mathrm{pH} = 9.556$$\n这个结果证实了溶液是碱性的，且$\\mathrm{H^+}$的浓度确实非常小，这验证了为简化三次方程所做的近似。", "answer": "$$\\boxed{9.556}$$", "id": "2958738"}, {"introduction": "真实的化学体系并非理想溶液，离子间的相互作用会使其有效浓度（活度）偏离其分析浓度。这项练习 ([@problem_id:2958720]) 是一个思想实验，旨在检验你对活度模型的理解，特别是活度如何依赖于离子强度，而（在特定模型假设下）不依赖于背景电解质的具体种类。这是在真实高浓度环境中应用平衡概念的关键一步，有助于我们辨别模型的适用范围和局限性。", "problem": "在 $37^{\\circ}\\mathrm{C}$ 下，于水中以质量摩尔浓度标度制备了一种由单质子弱酸 $\\mathrm{HA}$ 及其共轭碱 $\\mathrm{A^-}$ 组成的水性缓冲液。分析质量摩尔浓度为 $m_{\\mathrm{HA}}=m_{\\mathrm{A^-}}=0.010\\ \\mathrm{mol\\ kg^{-1}}$，在 $37^{\\circ}\\mathrm{C}$ 时，标准（无限稀释）酸度常数为 $pK_a^{\\circ}=4.750$。添加一种惰性支持电解质以将总离子强度调节至 $I=0.200\\ \\mathrm{mol\\ kg^{-1}}$。考虑两种支持电解质的情况：$\\mathrm{NaCl}$ 或 $\\mathrm{MgCl_2}$。假设缓冲液组分对 $I$ 的贡献相对于支持电解质可以忽略不计，不存在特定的离子缔合或络合，且氯离子不是该缓冲酸碱对的共同离子。使用适用于中等离子强度下单离子活度系数的平均活度模型（例如，从 Debye–Hückel (DH) 理论推导出的 Davies 形式）来估计在给定 $I$ 下 $\\mathrm{H^+}$ 和 $\\mathrm{A^-}$ 的活度系数。\n\n从基于活度的酸度常数定义出发，并注意将所有量用活度表示，确定两种情况下缓冲液 $\\mathrm{pH}$ 值的差值，\n$$\n\\Delta \\mathrm{pH}=\\mathrm{pH}_{\\mathrm{NaCl}}-\\mathrm{pH}_{\\mathrm{MgCl_2}}.\n$$\n将您的答案四舍五入到 $4$ 位有效数字。以纯数字（无量纲）形式给出最终结果。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件：\n1.  系统：由单质子弱酸 $\\mathrm{HA}$ 及其共轭碱 $\\mathrm{A^-}$ 组成的水性缓冲液。\n2.  温度：$T = 37^{\\circ}\\mathrm{C}$。\n3.  浓度标度：质量摩尔浓度 ($m$, $\\mathrm{mol\\ kg^{-1}}$)。\n4.  分析质量摩尔浓度：$m_{\\mathrm{HA}} = 0.010\\ \\mathrm{mol\\ kg^{-1}}$ 和 $m_{\\mathrm{A^-}} = 0.010\\ \\mathrm{mol\\ kg^{-1}}$。\n5.  标准酸度常数：在 $37^{\\circ}\\mathrm{C}$ 时 $pK_a^{\\circ} = 4.750$。\n6.  总离子强度：$I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$。\n7.  支持电解质：情况1：$\\mathrm{NaCl}$，情况2：$\\mathrm{MgCl_2}$。\n8.  假设：缓冲液组分对 $I$ 的贡献可以忽略不计；不存在特定的离子缔合或络合；氯离子不是共同离子。\n9.  模型：使用像 Davies 形式这样的平均活度模型计算单离子活度系数。\n10. 目标：确定 $\\Delta \\mathrm{pH} = \\mathrm{pH}_{\\mathrm{NaCl}} - \\mathrm{pH}_{\\mathrm{MgCl_2}}$ 的数值，并四舍五入到 $4$ 位有效数字。\n\n验证结论：\n该问题是有效的。它在科学上基于酸碱平衡和电解质溶液理论的原理。问题陈述清晰、客观且内部一致。参数在物理上是现实的。该问题要求在明确的约束条件下（固定的离子强度，无特定相互作用）仔细应用指定的理论模型（例如，Davies方程）。涉及不同电解质的表面复杂性，旨在严格测试对模型依赖关系的理解，而不是使问题变得微不足道。\n\n下面是完整且附有推理的解法。\n\n控制该缓冲体系的基本平衡是弱酸 $\\mathrm{HA}$ 的解离：\n$$\n\\mathrm{HA}(aq) \\rightleftharpoons \\mathrm{H^+}(aq) + \\mathrm{A^-}(aq)\n$$\n热力学酸度常数 $K_a^{\\circ}$ 是用平衡时各物种的活度 ($a_i$) 定义的：\n$$\nK_a^{\\circ} = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^-}}}{a_{\\mathrm{HA}}}\n$$\n溶质物种 $i$ 的活度 $a_i$ 与其质量摩尔浓度 ($m_i$) 和其质量摩尔活度系数 ($\\gamma_i$) 通过关系式 $a_i = m_i \\gamma_i$ 相关联。在稀溶液中，溶剂（水）的活度取为1。将此代入平衡表达式中得到：\n$$\nK_a^{\\circ} = \\frac{(m_{\\mathrm{H^+}} \\gamma_{\\mathrm{H^+}}) (m_{\\mathrm{A^-}} \\gamma_{\\mathrm{A^-}})}{m_{\\mathrm{HA}} \\gamma_{\\mathrm{HA}}}\n$$\n$\\mathrm{pH}$ 的操作定义是基于氢离子的活度：\n$$\n\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H^+}}) = -\\log_{10}(m_{\\mathrm{H^+}} \\gamma_{\\mathrm{H^+}})\n$$\n设分析质量摩尔浓度（即初始加入量）为 $m_{\\mathrm{HA}}^0 = 0.010\\ \\mathrm{mol\\ kg^{-1}}$ 和 $m_{\\mathrm{A^-}}^0 = 0.010\\ \\mathrm{mol\\ kg^{-1}}$。平衡质量摩尔浓度通过反应程度与分析质量摩尔浓度相关。设 $h = m_{\\mathrm{H^+}}$ 为氢离子的平衡质量摩尔浓度。根据解离的化学计量关系，酸及其碱的平衡质量摩尔浓度为：\n$$\nm_{\\mathrm{HA}} = m_{\\mathrm{HA}}^0 - h + m_{\\mathrm{OH^-}} \\approx m_{\\mathrm{HA}}^0 - h\n$$\n$$\nm_{\\mathrm{A^-}} = m_{\\mathrm{A^-}}^0 + h - m_{\\mathrm{OH^-}} \\approx m_{\\mathrm{A^-}}^0 + h\n$$\n由于溶液呈酸性，因此 $h \\gg m_{\\mathrm{OH^-}}$，所以这些近似是合理的。将这些代入 $K_a^{\\circ}$ 的表达式中：\n$$\nK_a^{\\circ} = \\frac{h (m_{\\mathrm{A^-}}^0 + h)}{(m_{\\mathrm{HA}}^0 - h)} \\frac{\\gamma_{\\mathrm{H^+}} \\gamma_{\\mathrm{A^-}}}{\\gamma_{\\mathrm{HA}}}\n$$\n这个方程可以重排以求解平衡氢离子质量摩尔浓度 $h$：\n$$\nh^2 + (m_{\\mathrm{A^-}}^0 + K_a')h - K_a' m_{\\mathrm{HA}}^0 = 0\n$$\n其中 $K_a'$ 是一个表观平衡常数，定义为：\n$$\nK_a' = K_a^{\\circ} \\frac{\\gamma_{\\mathrm{HA}}}{\\gamma_{\\mathrm{H^+}} \\gamma_{\\mathrm{A^-}}}\n$$\n$h$ 的解取决于初始质量摩尔浓度 $m_{\\mathrm{HA}}^0$、$m_{\\mathrm{A^-}}^0$ 以及表观常数 $K_a'$。\n\n关键步骤是分析决定活度系数 $\\gamma_i$ 的因素。问题指定使用诸如 Davies 方程之类的平均活度模型，该方程由 Debye-Hückel 理论推导而来。在这类模型中，离子 $i$ 的活度系数 $\\gamma_i$ 是其电荷数 $z_i$ 和溶液总离子强度 $I$ 的函数。例如，Davies 方程的形式为：\n$$\n\\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - bI \\right)\n$$\n其中 $A$ 是一个取决于溶剂和温度的常数，$b$ 是一个经验参数（在典型形式中为 $0.3$）。对于中性物种 $\\mathrm{HA}$，其活度系数 $\\gamma_{\\mathrm{HA}}$ 也主要取决于离子强度 $I$（一种称为盐析效应的现象），通常近似为 $\\gamma_{\\mathrm{HA}} \\approx 1$ 或 $\\log_{10}(\\gamma_{\\mathrm{HA}}) \\approx k_S I$。\n\n问题陈述指出，在两种溶液情况下（即分别使用 $\\mathrm{NaCl}$ 或 $\\mathrm{MgCl_2}$ 作为支持电解质），总离子强度都被调节到*相同*的值，$I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$。“无特定离子缔合或络合”的假设明确指示我们使用像 Davies 这样的模型，在这种模型中，构成离子强度的离子的具体性质不起作用，只有 $I$ 的总值才重要。\n\n因此，对于每个物种 $i \\in \\{\\mathrm{H^+}, \\mathrm{A^-}, \\mathrm{HA}\\}$，其活度系数 $\\gamma_i$ 仅取决于在两种情况下都相同的量（$z_i$, $I$）。\n1.  在 $\\mathrm{NaCl}$ 的情况下，$I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$。$\\gamma_{\\mathrm{H^+}}$、$\\gamma_{\\mathrm{A^-}}$ 和 $\\gamma_{\\mathrm{HA}}$ 的值由此离子强度决定。\n2.  在 $\\mathrm{MgCl_2}$ 的情况下，$I = 0.200\\ \\mathrm{mol\\ kg^{-1}}$。$\\gamma_{\\mathrm{H^+}}$、$\\gamma_{\\mathrm{A^-}}$ 和 $\\gamma_{\\mathrm{HA}}$ 的值同样由此相同的离子强度决定。\n\n因此，参与平衡的所有物种的活度系数在两种溶液中都是相同的：\n$$\n(\\gamma_i)_{\\mathrm{NaCl}} = (\\gamma_i)_{\\mathrm{MgCl_2}}\n$$\n这意味着表观平衡常数 $K_a'$ 在两种情况下也是相同的。\n$$\n(K_a')_{\\mathrm{NaCl}} = (K_a')_{\\mathrm{MgCl_2}}\n$$\n由于两个系统的分析质量摩尔浓度（$m_{\\mathrm{HA}}^0$, $m_{\\mathrm{A^-}}^0$）和表观常数（$K_a'$）都相同，因此求解平衡氢离子质量摩尔浓度 $h$ 的二次方程在两种情况下是完全相同的。这导致 $h$ 的值在两种溶液中相同的结论。\n$$\nh_{\\mathrm{NaCl}} = h_{\\mathrm{MgCl_2}}\n$$\n最后，我们考察 $\\mathrm{pH}$。每种情况下的 $\\mathrm{pH}$ 由以下公式给出：\n$$\n\\mathrm{pH}_{\\mathrm{NaCl}} = -\\log_{10}(h_{\\mathrm{NaCl}} \\cdot (\\gamma_{\\mathrm{H^+}})_{\\mathrm{NaCl}})\n$$\n$$\n\\mathrm{pH}_{\\mathrm{MgCl_2}} = -\\log_{10}(h_{\\mathrm{MgCl_2}} \\cdot (\\gamma_{\\mathrm{H^+}})_{\\mathrm{MgCl_2}})\n$$\n既然我们已经确定 $h_{\\mathrm{NaCl}} = h_{\\mathrm{MgCl_2}}$ 且 $(\\gamma_{\\mathrm{H^+}})_{\\mathrm{NaCl}} = (\\gamma_{\\mathrm{H^+}})_{\\mathrm{MgCl_2}}$，那么氢离子的活度必然相等，$a_{\\mathrm{H^+, NaCl}} = a_{\\mathrm{H^+, MgCl_2}}$。对这个等式取以10为底的负对数，我们发现 $\\mathrm{pH}$ 值是相同的。\n$$\n\\mathrm{pH}_{\\mathrm{NaCl}} = \\mathrm{pH}_{\\mathrm{MgCl_2}}\n$$\n因此，所求的差值为零。\n$$\n\\Delta \\mathrm{pH} = \\mathrm{pH}_{\\mathrm{NaCl}} - \\mathrm{pH}_{\\mathrm{MgCl_2}} = 0\n$$\n问题要求答案四舍五入到4位有效数字。一个恰好为零的结果可以表示为 $0.0000$。", "answer": "$$\\boxed{0.0000}$$", "id": "2958720"}, {"introduction": "本章的最终练习旨在连接理论计算与实验科学。在科研实践中，我们常常利用滴定过程中的$pH$等测量数据来确定未知的物理常数（如 $K_a$）。这项高级练习 ([@problem_id:2958712]) 模拟了这一过程，指导你构建正向模型，并通过非线性最小二乘法拟合数据，最终量化估计参数的不确定性，展示了同离子效应模型在真实数据分析中的强大应用价值。", "problem": "一种单质子弱酸溶液在温度 $25\\,^{\\circ}\\mathrm{C}$ 下制备，其分析酸浓度固定。然后通过加入已知分析量的、提供其共轭碱（共同离子）的钠盐来进行滴定。假设为理想行为（活度系数等于$1$）并且纯水发生自电离，其离子积为 $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$。酸解离反应为 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^-}$，其待估算的热力学酸解离常数 $K_{\\mathrm{a}}$ 未知。\n\n使用的基本原理：\n- 酸家族的质量平衡：携带酸原子平衡的所有物种的总浓度是分析酸和添加的共轭碱之和。如果 $C_{\\mathrm{HA}}$ 是初始存在的弱酸的分析浓度，$C_{\\mathrm{salt}}$ 是添加的共轭碱钠盐的分析浓度，那么总的酸家族浓度为 $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$，且物种浓度满足 $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$。\n- 电荷平衡（电中性）：正电荷的总和等于负电荷的总和，包括来自 $\\mathrm{H^+}$、$\\mathrm{OH^-}$、共轭碱 $\\mathrm{A^-}$ 以及盐添加的钠抗衡离子的贡献。\n- 解离的质量作用定律：$K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$。\n- 水的自电离：$K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n\n测量数据由 $N$ 对 $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$ 组成，其中 $C_{\\mathrm{HA}}$ 固定。每个 $\\mathrm{pH}_i^{\\mathrm{(meas)}}$ 是通过向真实模型 $\\mathrm{pH}_i^{\\mathrm{(true)}} = -\\log_{10}([\\mathrm{H^+}]_i)$ 添加独立同分布的零均值高斯噪声（以 $\\mathrm{pH}$ 为单位）得到的。该真实模型由上述原理根据给定的 $K_{\\mathrm{a}}$、$C_{\\mathrm{HA}}$ 和 $C_{\\mathrm{salt},i}$ 预测得出，噪声的标准差已知。\n\n任务：\n1) 仅从上述基本定律和定义出发，构建一个正向模型。对于任意给定的 $K_{\\mathrm{a}}$、$C_{\\mathrm{HA}}$、$C_{\\mathrm{salt}}$ 和 $K_{\\mathrm{w}}$，该模型计算 $[\\mathrm{H^+}]$ 的物理有效正根，并返回 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$。\n2) 给定从已知真实参数生成的带噪声的 $\\mathrm{pH}$ 数据，通过最小化非线性最小二乘目标函数\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}})\\right)^2,\n$$\n来估计 $K_{\\mathrm{a}}$，约束条件为 $K_{\\mathrm{a}} > 0$。使用一种能保证正定性且具有有界一维搜索域的参数化方法。\n3) 对于 $\\mathrm{pH}$ 中独立同分布且方差为 $\\sigma^2$ 的高斯误差，使用 Fisher 信息方法，计算对数参数化 $\\theta = \\ln K_{\\mathrm{a}}$ 中单个参数的 Fisher 信息：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2,\n$$\n在估计量 $\\hat{\\theta}$ 处对其求值，并报告相应的 $K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间。该区间通过将 $\\theta$ 的正态近似变换回原始尺度得到。使用数值稳定的方法计算 $\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$。\n4) 对每个测试用例，按顺序输出一个包含三个浮点数的列表，格式为科学记数法：估计的 $K_{\\mathrm{a}}$、$K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间的下限，以及 $K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间的上限。\n\n数据生成协议（必须严格遵守以确保可测试性）：\n- 在所有情况下，使用 $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$ 和固定的随机种子 $2025$。\n- 通过向无噪声的模型 $\\mathrm{pH}$ 中添加均值为零、标准差为指定值 $\\sigma_{\\mathrm{pH}}$（以 $\\mathrm{pH}$ 为单位）的独立高斯噪声来生成带噪声的 $\\mathrm{pH}$ 测量值。\n- 对于每个测试用例，使用基准真相 $K_{\\mathrm{a}}^{(\\mathrm{true})}$、指定的 $C_{\\mathrm{HA}}$ 和 $C_{\\mathrm{salt}}$ 值列表计算“真实”$\\mathrm{pH}$ 值，然后添加噪声。\n\n要实现的测试套件：\n- 情况 A（理想路径）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.8\\times 10^{-5}$，$C_{\\mathrm{HA}} = 1.0\\times 10^{-2}$，$C_{\\mathrm{salt}} \\in \\{0.0, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}, 1.0\\times 10^{-2}, 3.0\\times 10^{-2}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n- 情况 B（极弱酸体系，水的电离重要）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-8}$，$C_{\\mathrm{HA}} = 1.0\\times 10^{-3}$，$C_{\\mathrm{salt}} \\in \\{0.0, 3.0\\times 10^{-4}, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n- 情况 C（强共同离子负载）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-6}$，$C_{\\mathrm{HA}} = 5.0\\times 10^{-3}$，$C_{\\mathrm{salt}} \\in \\{0.0, 5.0\\times 10^{-2}, 1.0\\times 10^{-1}, 2.0\\times 10^{-1}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n\n计算和报告细节：\n- 对于每种情况，使用 $N$ 等于所列出的 $C_{\\mathrm{salt}}$ 值的数量。\n- 对于最小二乘拟合，通过 $\\theta = \\ln K_{\\mathrm{a}}$ 进行参数化，并在有界区间 $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$ 内搜索。\n- 通过无偏残差方差 $\\hat{\\sigma}^2 = \\dfrac{\\mathrm{RSS}}{N - 1}$ 估计 $\\sigma^2$，其中 $\\mathrm{RSS}$ 是在最小值点处的残差平方和，且只有一个拟合参数。\n- 使用对 $\\theta$ 的小步长的数值稳定的中心差分近似来计算灵敏度 $\\dfrac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$，从而计算 $\\theta$ 中的 Fisher 信息 $\\mathcal{I}(\\hat{\\theta})$。\n- 首先获得基于正态分布的 $\\theta$ 区间，\n$$\n\\hat{\\theta} \\pm 1.96 \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}},\n$$\n然后通过指数函数将其端点映射回 $K_{\\mathrm{a}}$，从而构建 $K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含三个值的子列表，这些值采用科学记数法，精确到六位有效数字，顺序为 $[K_{\\mathrm{a}}^{(\\mathrm{est})}, K_{\\mathrm{a}}^{(\\mathrm{lo95})}, K_{\\mathrm{a}}^{(\\mathrm{hi95})}]$。例如：[[1.234567e-05,1.111111e-05,1.358024e-05],[...],[...]]。", "solution": "所提出的问题是化学平衡建模、参数估计和统计不确定性量化方面的一个综合性练习。它在科学上是合理的，问题定义清晰，并且需要严格应用基本原理。我们将着手进行推导和求解。\n\n解决方案分为三个部分：\n1.  推导正向模型，用于计算氢离子浓度 $[\\mathrm{H^+}]$ 并随后计算 $\\mathrm{pH}$。\n2.  阐述通过非线性最小二乘法估计酸解离常数 $K_{\\mathrm{a}}$ 的反演问题。\n3.  建立使用 Fisher 信息矩阵确定估计值 $K_{\\mathrm{a}}$ 置信区间的统计框架。\n\n首先，我们必须构建正向模型，该模型为给定的参数集 $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$ 预测 $\\mathrm{pH}$。我们从提供的四个基本平衡关系开始：\n1.  酸/碱共轭对的质量平衡：$[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$，其中 $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$。\n2.  电荷平衡（电中性）：$[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{A^-}] + [\\mathrm{OH^-}]$。由于钠盐是共同离子 $\\mathrm{A^-}$ 和抗衡离子 $\\mathrm{Na^+}$ 的来源，我们有 $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$。\n3.  酸解离平衡：$K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$。\n4.  水的自电离平衡：$K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n\n让我们将氢离子浓度表示为 $h \\equiv [\\mathrm{H^+}]$。我们的目标是推导出一个关于 $h$ 的单一方程。根据水的自电离平衡(4)，我们将氢氧根离子浓度表示为 $[\\mathrm{OH^-}] = K_{\\mathrm{w}}/h$。将此式和 $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$ 代入电荷平衡方程(2)，可以让我们用 $h$ 表示共轭碱浓度 $[\\mathrm{A^-}]$：\n$$\nC_{\\mathrm{salt}} + h = [\\mathrm{A^-}] + \\frac{K_{\\mathrm{w}}}{h} \\implies [\\mathrm{A^-}] = C_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h}\n$$\n接下来，我们使用酸解离(3)和质量平衡(1)关系来找到 $[\\mathrm{A^-}]$ 的另一个表达式。从(3)式可知，$[\\mathrm{HA}] = \\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}}$。将此代入(1)式：\n$$\n\\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}} + [\\mathrm{A^-}] = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}]\\left(\\frac{h}{K_{\\mathrm{a}}}+1\\right) = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}] = C_{\\mathrm{T}}\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\n令两个关于 $[\\mathrm{A^-}]$ 的表达式相等，得到 $h$ 的控制方程：\n$$\nC_{\\mathrmsalt}} + h - \\frac{K_{\\mathrm{w}}}{h} = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\n为了求解 $h$，我们通过将所有项乘以 $h(h+K_{\\mathrm{a}})$ 将其重新排列成多项式形式：\n$$\n(C_{\\mathrm{salt}} + h)h(h+K_{\\mathrm{a}}) - K_{\\mathrm{w}}(h+K_{\\mathrm{a}}) = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})K_{\\mathrm{a}}h\n$$\n展开并合并 $h$ 的同次幂项：\n$$\nh^3 + (K_{\\mathrm{a}} + C_{\\mathrm{salt}})h^2 - (K_{\\mathrm{a}}C_{\\mathrm{HA}} + K_{\\mathrm{w}})h - K_{\\mathrm{a}}K_{\\mathrm{w}} = 0\n$$\n这是一个关于 $h=[\\mathrm{H^+}]$ 的三次方程。对于任何物理上现实的正参数集 $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$，该多项式恰好有一个正实根。这可以通过对系数 $(1, K_{\\mathrm{a}}+C_{\\mathrm{salt}}, -(K_{\\mathrm{a}}C_{\\mathrm{HA}}+K_{\\mathrm{w}}), -K_{\\mathrm{a}}K_{\\mathrm{w}})$ 应用笛卡尔符号法则来证实。这些系数的符号模式为 $(+, +, -, -)$，表明只有一个符号变化，因此只有一个正根。这个唯一的正根就是物理上有效的浓度 $[\\mathrm{H^+}]$。通过计算 $\\mathrm{pH} = -\\log_{10}(h)$ 完成正向模型。\n\n第二，我们解决估计 $K_{\\mathrm{a}}$ 的反演问题。我们给定 $N$ 对数据 $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$。通过最小化测量 $\\mathrm{pH}$ 与模型预测 $\\mathrm{pH}$ 之间的残差平方和 (RSS) 来进行估计：\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\n为了强制执行物理约束 $K_{\\mathrm{a}} > 0$ 并提高优化的数值稳定性，我们进行变量替换，令 $\\theta = \\ln K_{\\mathrm{a}}$，因此 $K_{\\mathrm{a}} = e^{\\theta}$。优化问题变为找到最小化以下函数的 $\\hat{\\theta}$：\n$$\nS(\\theta) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\theta}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\n这是一个在指定的有界域 $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$上的一维优化问题，可以使用诸如 Brent 方法等数值方法高效求解。然后，$K_{\\mathrm{a}}$ 的估计值为 $\\hat{K}_{\\mathrm{a}} = e^{\\hat{\\theta}}$。\n\n第三，我们为估计值 $\\hat{K}_{\\mathrm{a}}$ 构建置信区间。对于测量变量（$\\mathrm{pH}$）中独立同分布的高斯误差，参数估计量 $\\hat{\\theta}$ 的方差可以通过 Cramer-Rao下界来近似，该下界是 Fisher 信息 $\\mathcal{I}(\\theta)$ 的倒数。单个参数 $\\theta$ 的 Fisher 信息由下式给出：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2\n$$\n此处，$\\sigma^2$ 是以 $\\mathrm{pH}$ 单位计量的测量噪声的方差。由于 $\\sigma^2$ 未知，它通过拟合的残差来估计：$\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}_{\\min}}{N-p}$，其中 $\\mathrm{RSS}_{\\min} = S(\\hat{\\theta})$ 是最小残差平方和，$p=1$ 是拟合参数的数量。灵敏度导数 $\\frac{\\partial \\mathrm{pH}}{\\partial \\theta}$ 在最优值 $\\hat{\\theta}$ 处使用对称中心差分公式进行数值计算以保证稳定性：\n$$\n\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta} \\approx \\frac{\\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}+\\delta}) - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}-\\delta})}{2\\delta}\n$$\n其中 $\\delta$ 是一个小步长。然后，在估计值处评估 Fisher 信息：$\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\hat{\\sigma}^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i}{\\partial \\theta}\\right)^2_{\\theta=\\hat{\\theta}}$。估计量 $\\hat{\\theta}$ 的标准误差为 $\\mathrm{se}(\\hat{\\theta}) = \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}}$。$\\theta$ 的近似 $95\\%$ 置信区间为 $[\\theta_{\\mathrm{lo}}, \\theta_{\\mathrm{hi}}] = [\\hat{\\theta} - 1.96 \\cdot \\mathrm{se}(\\hat{\\theta}), \\hat{\\theta} + 1.96 \\cdot \\mathrm{se}(\\hat{\\theta})]$。通过将此区间的端点变换回原始参数空间，我们得到 $K_{\\mathrm{a}}$ 的 $95\\%$ 置信区间：\n$$\n[K_{\\mathrm{a},\\mathrm{lo95}}, K_{\\mathrm{a},\\mathrm{hi95}}] = [e^{\\theta_{\\mathrm{lo}}}, e^{\\theta_{\\mathrm{hi}}}]\n$$\n至此，理论框架完成。实施过程将为每个测试用例精确地遵循这些步骤。", "answer": "[[1.805561e-05,1.764495e-05,1.847522e-05],[1.002621e-08,9.458022e-09,1.062835e-08],[9.982260e-07,9.755490e-07,1.021404e-06]]", "id": "2958712"}]}