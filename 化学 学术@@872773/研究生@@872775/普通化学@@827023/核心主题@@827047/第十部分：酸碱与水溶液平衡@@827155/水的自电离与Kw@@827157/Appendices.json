{"hands_on_practices": [{"introduction": "虽然近似在化学计算中很方便，但真正的理解来自于知道它们何时失效以及如何进行精确计算。这项练习将挑战你通过显式地包含水的自电离来求解稀弱酸溶液的pH值，这是分析敏感化学体系时的一项关键技能。[@problem_id:2919979]", "problem": "乙酸水溶液通过自身的电离和水的自偶电离发生质子转移反应。考虑一个在 $25\\,^{\\circ}\\mathrm{C}$ 下通过溶解乙酸制备的溶液，其总分析浓度为 $C = 1.0 \\times 10^{-3}\\ \\mathrm{M}$。在此温度下，乙酸的酸解离常数为 $K_{a} = 1.74 \\times 10^{-5}$。假设为理想稀溶液，其中活度可近似为浓度。使用 $25\\,^{\\circ}\\mathrm{C}$ 时水的标准离子积常数 $K_{w} = 1.0 \\times 10^{-14}$。\n\n仅从每个平衡的质量作用定律、乙酸的质量守恒以及电中性条件出发，建立明确包含水自偶电离贡献的氢离子浓度 $[\\mathrm{H}^{+}]$ 的控制方程，并对其进行数值求解以获得溶液的 $pH$ 值。将 $pH$ 表示为一个纯数（无单位），并将最终结果四舍五入至四位有效数字。", "solution": "所述问题具有科学依据、提法明确、客观，并包含得出唯一且有意义解所需的所有信息。这是一个化学平衡中的标准问题。因此，我将进行完整的推导和计算。\n\n该问题要求计算弱酸溶液的 $\\mathrm{pH}$ 值，并明确考虑水的自偶电离的贡献。这需要对所有相关平衡进行系统处理。设乙酸 $\\mathrm{CH}_{3}\\mathrm{COOH}$ 以通用化学式 $\\mathrm{HA}$ 表示。\n\n水溶液中存在的物种有：未电离的酸 $\\mathrm{HA}$、其共轭碱乙酸根 $\\mathrm{A}^{-}$、氢离子 $\\mathrm{H}^{+}$（代表水合氢离子 $\\mathrm{H}_{3}\\mathrm{O}^{+}$）、氢氧根离子 $\\mathrm{OH}^{-}$以及溶剂水 $\\mathrm{H}_{2}\\mathrm{O}$。处于平衡状态的系统可以通过将质量作用定律应用于两个同时发生的电离反应、将质量守恒原理应用于乙酸根物种以及应用溶液的电中性条件来描述。\n\n$1$. 质量作用定律：\n乙酸的电离由以下平衡描述：\n$$ \\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-} $$\n酸解离常数 $K_{a}$ 由下式给出：\n$$ K_{a} = \\frac{[\\mathrm{H}^{+}] [\\mathrm{A}^{-}]}{[\\mathrm{HA}]} $$\n水的自偶电离由以下平衡描述：\n$$ \\mathrm{H}_{2}\\mathrm{O} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{OH}^{-} $$\n水的离子积常数 $K_{w}$ 由下式给出：\n$$ K_{w} = [\\mathrm{H}^{+}] [\\mathrm{OH}^{-}] $$\n\n$2$. 质量守恒：\n乙酸的总分析浓度 $C$（给定值为 $1.0 \\times 10^{-3}\\ \\mathrm{M}$）必须等于所有含乙酸根基团物种的浓度之和。\n$$ C = [\\mathrm{HA}] + [\\mathrm{A}^{-}] $$\n\n$3$. 电中性条件（电荷平衡）：\n整个溶液必须是电中性的。所有阳离子的摩尔浓度之和必须等于所有阴离子的摩尔浓度之和。\n$$ [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}] $$\n\n我们的任务是建立一个关于氢离子浓度 $[\\mathrm{H}^{+}]$ 的单一控制方程。我们用变量 $x$ 表示 $[\\mathrm{H}^{+}]$。我们可以用 $x$ 和已知常数 $K_a$、$K_w$ 和 $C$ 来表示所有其他带电物种的浓度，即 $[\\mathrm{A}^{-}]$ 和 $[\\mathrm{OH}^{-}]$，以及未电离的酸 $[\\mathrm{HA}]$ 的浓度。\n\n根据 $K_w$ 的表达式，我们可以将氢氧根离子浓度写为：\n$$ [\\mathrm{OH}^{-}] = \\frac{K_w}{[\\mathrm{H}^{+}]} = \\frac{K_w}{x} $$\n将此式代入电荷平衡方程，我们可以解出乙酸根离子浓度 $[\\mathrm{A}^{-}]$：\n$$ [\\mathrm{A}^{-}] = [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}] = x - \\frac{K_w}{x} $$\n接下来，利用质量守恒方程，我们表示出未电离酸 $[\\mathrm{HA}]$ 的浓度：\n$$ [\\mathrm{HA}] = C - [\\mathrm{A}^{-}] = C - \\left( x - \\frac{K_w}{x} \\right) $$\n现在，我们将 $[\\mathrm{H}^{+}]$、$[\\mathrm{A}^{-}]$ 和 $[\\mathrm{HA}]$ 的表达式代入酸解离常数 $K_a$ 的方程中：\n$$ K_a = \\frac{x \\left( x - \\frac{K_w}{x} \\right)}{C - \\left( x - \\frac{K_w}{x} \\right)} $$\n这就是关于 $x = [\\mathrm{H}^{+}]$ 的精确控制方程。为了求解它，我们首先将其整理成标准的多项式形式。\n$$ K_a \\left( C - x + \\frac{K_w}{x} \\right) = x^2 - K_w $$\n$$ K_a C - K_a x + \\frac{K_a K_w}{x} = x^2 - K_w $$\n整个方程乘以 $x$ 以消去分母，得到：\n$$ K_a C x - K_a x^2 + K_a K_w = x^3 - K_w x $$\n将所有项移到一边，得到关于 $x$ 的最终三次多项式方程：\n$$ x^3 + K_a x^2 - (K_a C + K_w) x - K_a K_w = 0 $$\n现在我们将给定的数值代入此方程：\n$C = 1.0 \\times 10^{-3}$\n$K_{a} = 1.74 \\times 10^{-5}$\n$K_{w} = 1.0 \\times 10^{-14}$\n\n多项式的系数为：\n$x^3$ 的系数：$1$\n$x^2$ 的系数：$K_a = 1.74 \\times 10^{-5}$\n$x$ 的系数：$-(K_a C + K_w) = -((1.74 \\times 10^{-5})(1.0 \\times 10^{-3}) + 1.0 \\times 10^{-14}) = -(1.74 \\times 10^{-8} + 1.0 \\times 10^{-14}) = -1.740001 \\times 10^{-8}$\n常数项：$-K_a K_w = -(1.74 \\times 10^{-5})(1.0 \\times 10^{-14}) = -1.74 \\times 10^{-19}$\n\n需求解的关于 $x = [\\mathrm{H}^{+}]$ 的方程是：\n$$ x^3 + (1.74 \\times 10^{-5})x^2 - (1.740001 \\times 10^{-8})x - (1.74 \\times 10^{-19}) = 0 $$\n这个三次方程有一个具有物理意义的正实根。该方程的数值解为：\n$$ x = [\\mathrm{H}^{+}] \\approx 1.234913 \\times 10^{-4}\\ \\mathrm{M} $$\n$\\mathrm{pH}$ 定义为氢离子浓度的以10为底的负对数：\n$$ \\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}]) $$\n代入计算出的 $[\\mathrm{H}^{+}]$ 值：\n$$ \\mathrm{pH} = -\\log_{10}(1.234913 \\times 10^{-4}) $$\n$$ \\mathrm{pH} \\approx 3.90837 $$\n问题要求将 $\\mathrm{pH}$ 的最终结果四舍五入至四位有效数字。\n$$ \\mathrm{pH} \\approx 3.908 $$", "answer": "$$\\boxed{3.908}$$", "id": "2919979"}, {"introduction": "水的离子积常数 $K_w$ 对温度高度敏感。这项练习将超越单点计算，深入探讨这种依赖性的热力学建模，要求你基于真实数据推导并比较不同模型，并使用赤池信息准则 (Akaike Information Criterion, AIC) 等统计标准来确定反应热容效应的重要性。[@problem_id:2920022]", "problem": "水的自电离由平衡常数 $K_{\\mathrm{w}}(T)$ 及其常用对数表达式 $pK_{\\mathrm{w}}(T) = -\\log_{10} K_{\\mathrm{w}}(T)$ 控制。仅从标准热力学关系式 $\\Delta G^{\\circ}(T) = \\Delta H^{\\circ}(T) - T \\Delta S^{\\circ}(T)$、$\\Delta G^{\\circ}(T) = - R T \\ln K(T)$ 和定义 $\\Delta C_{p}^{\\circ}(T) = \\left(\\frac{\\partial \\Delta H^{\\circ}}{\\partial T}\\right)_{p} = T \\left(\\frac{\\partial \\Delta S^{\\circ}}{\\partial T}\\right)_{p}$ 出发，在以下两种模型下推导 $pK_{\\mathrm{w}}(T)$ 的可用于回归的显式表达式：\n- 模型 A：标准反应焓与温度无关（等效于 $\\Delta C_{p}^{\\circ} = 0$）。\n- 模型 B：非零且与温度无关的标准热容变 $\\Delta C_{p}^{\\circ} \\neq 0$。\n\n在推导过程中，使用国际单位制（SI）中的气体常数 $R$，并仔细追踪单位，以确保所有热力学参数都使用一致的国际单位制单位。您可以选择一个固定的参考温度 $T_{0}$，但必须指明其值并确保一致性。\n\n对以下四个在 $T \\in [0, 100]\\,^{\\circ}\\mathrm{C}$ 范围内的 $pK_{\\mathrm{w}}(T)$ 数据集，使用普通最小二乘法拟合这两种模型，其中温度以摄氏度给出，并且在所有计算中都必须转换为开尔文。观测到的 $pK_{\\mathrm{w}}$ 值为无量纲。\n\n- 测试用例 $1$（宽范围，密集）：温度（摄氏度）：$0, 25, 50, 75, 100$，对应的 $pK_{\\mathrm{w}}$ 值为 $14.94, 14.00, 13.26, 12.64, 12.26$。\n- 测试用例 $2$（宽范围，稀疏）：温度（摄氏度）：$0, 25, 50, 100$，对应的 $pK_{\\mathrm{w}}$ 值为 $14.94, 14.00, 13.26, 12.26$。\n- 测试用例 $3$（中等范围）：温度（摄氏度）：$15, 25, 40, 60$，对应的 $pK_{\\mathrm{w}}$ 值为 $14.35, 14.00, 13.54, 12.99$。\n- 测试用例 $4$（偏移网格）：温度（摄氏度）：$5, 35, 65, 95$，对应的 $pK_{\\mathrm{w}}$ 值为 $14.73, 13.68, 12.87, 12.24$。\n\n对于每个测试用例：\n1. 在从所述热力学关系推导出的数学上等价的线性回归形式中，通过最小二乘法估计模型参数。\n2. 计算模型 A 和模型 B 的均方根误差 (RMSE)，其定义为 $\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_{i} - \\hat{y}_{i})^{2}}$，其中 $y_{i}$ 是观测到的 $pK_{\\mathrm{w}}$ 值，$\\hat{y}_{i}$ 是模型预测值。\n3. 计算 Akaike 信息准则 (AIC)，其定义为 $\\mathrm{AIC} = n \\ln\\!\\left(\\frac{\\mathrm{RSS}}{n}\\right) + 2 k$，其中 $\\mathrm{RSS} = \\sum_{i=1}^{n} (y_{i} - \\hat{y}_{i})^{2}$，$k$ 是拟合参数的数量（模型 A 为 $k = 2$，模型 B 为 $k = 3$）。\n4. 使用 Akaike 信息准则 (AIC) 差异法则来判断恒定焓模型（模型 A）是否足够：如果 $\\mathrm{AIC}_{A} \\le \\mathrm{AIC}_{B} + 2$，则声明模型 A 足够，否则为不足够。\n\n您的程序必须：\n- 在模型方程中，所有温度 $T$ 均使用开尔文单位。\n- 使用单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 的 $R$。\n- 将 $pK_{\\mathrm{w}}$ 视为无量纲。\n- 生成单行输出，包含一个由方括号括起来的逗号分隔列表。对于顺序为 1、2、3、4 的每个测试用例，将五元组 $[\\mathrm{RMSE}_{A}, \\mathrm{RMSE}_{B}, \\mathrm{AIC}_{A}, \\mathrm{AIC}_{B}, \\text{adequate}]$ 附加到输出中，展平为单个列表。浮点数必须四舍五入到恰好6位小数，适应性指标必须是布尔字面量。例如，两个用例的输出应如下所示：$[\\dots, 0.012345, 0.006789, 1.234567, -0.123456, True, \\dots]$。\n\n此任务不涉及角度或百分比。所有请求的输出都是无量纲标量或布尔值。程序必须是完全确定性的，并且不需要用户输入。", "solution": "该问题要求推导水自电离常数 $K_{\\mathrm{w}}(T)$（表示为 $pK_{\\mathrm{w}}(T)$）对温度依赖性的两种热力学模型。然后，需要将这些模型拟合到实验数据，并使用标准统计准则比较其适应性。\n\n提供的基本热力学关系如下：\n1. 标准吉布斯自由能变的定义：$\\Delta G^{\\circ}(T) = \\Delta H^{\\circ}(T) - T \\Delta S^{\\circ}(T)$。\n2. 吉布斯自由能与平衡常数 $K(T)$ 之间的关系：$\\Delta G^{\\circ}(T) = - R T \\ln K(T)$。\n3. 恒压下标准热容变的定义，它关联了标准焓变和熵变对温度的依赖性：$\\Delta C_{p}^{\\circ}(T) = \\left(\\frac{\\partial \\Delta H^{\\circ}}{\\partial T}\\right)_{p} = T \\left(\\frac{\\partial \\Delta S^{\\circ}}{\\partial T}\\right)_{p}$。\n\n需要建模的量是 $pK_{\\mathrm{w}}(T)$，定义为 $pK_{\\mathrm{w}}(T) = -\\log_{10} K_{\\mathrm{w}}(T)$。这可以通过 $pK_{\\mathrm{w}}(T) = -\\frac{\\ln K_{\\mathrm{w}}(T)}{\\ln 10}$ 与自然对数相关联。\n\n将 $\\Delta G^{\\circ}(T)$ 的两个表达式相等，得到 van 't Hoff 方程：\n$$-R T \\ln K_{\\mathrm{w}}(T) = \\Delta H^{\\circ}(T) - T \\Delta S^{\\circ}(T) \\implies \\ln K_{\\mathrm{w}}(T) = -\\frac{\\Delta H^{\\circ}(T)}{RT} + \\frac{\\Delta S^{\\circ}(T)}{R}$$\n\n现在我们将为指定的两种模型推导 $pK_{\\mathrm{w}}(T)$ 的具体形式。\n\n**模型 A：标准反应焓与温度无关（$\\Delta C_{p}^{\\circ} = 0$）**\n\n条件 $\\Delta C_{p}^{\\circ} = 0$ 意味着标准反应焓和熵都与温度无关。\n由 $\\left(\\frac{\\partial \\Delta H^{\\circ}}{\\partial T}\\right)_{p} = 0$ 可得 $\\Delta H^{\\circ}(T) = \\Delta H^{\\circ}$，为一个常数。\n由 $T \\left(\\frac{\\partial \\Delta S^{\\circ}}{\\partial T}\\right)_{p} = 0$ 可得 $\\Delta S^{\\circ}(T) = \\Delta S^{\\circ}$，也为一个常数。\n\n将这些代入 van 't Hoff 方程得到：\n$$\\ln K_{\\mathrm{w}}(T) = -\\frac{\\Delta H^{\\circ}}{RT} + \\frac{\\Delta S^{\\circ}}{R}$$\n为了获得 $pK_{\\mathrm{w}}(T)$ 的表达式，我们乘以 $-\\frac{1}{\\ln 10}$：\n$$pK_{\\mathrm{w}}(T) = -\\frac{1}{\\ln 10} \\left( -\\frac{\\Delta H^{\\circ}}{RT} + \\frac{\\Delta S^{\\circ}}{R} \\right) = \\frac{\\Delta H^{\\circ}}{R \\ln 10} \\frac{1}{T} - \\frac{\\Delta S^{\\circ}}{R \\ln 10}$$\n该表达式是 $1/T$ 的线性函数。为了进行线性回归，我们可以将其写为：\n$$pK_{\\mathrm{w}}(T) = \\beta_0 + \\beta_1 \\left(\\frac{1}{T}\\right)$$\n需要估计的两个参数是截距 $\\beta_0 = -\\frac{\\Delta S^{\\circ}}{R \\ln 10}$ 和斜率 $\\beta_1 = \\frac{\\Delta H^{\\circ}}{R \\ln 10}$。因此，模型 A 是一个双参数模型（$k=2$）。\n\n**模型 B：非零且与温度无关的标准热容变（$\\Delta C_{p}^{\\circ} \\neq 0$）**\n\n这里，$\\Delta C_{p}^{\\circ}$ 是一个非零常数。我们必须对 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$ 的关系式进行积分。我们选择一个参考温度 $T_0$，并将其指定为 $T_0 = 298.15 \\, \\mathrm{K}$。\n\n对 $\\left(\\frac{\\partial \\Delta H^{\\circ}}{\\partial T}\\right)_{p} = \\Delta C_{p}^{\\circ}$ 从 $T_0$ 到 $T$ 积分：\n$$\\int_{\\Delta H^{\\circ}(T_0)}^{\\Delta H^{\\circ}(T)} d(\\Delta H^{\\circ}) = \\int_{T_0}^{T} \\Delta C_{p}^{\\circ} dT \\implies \\Delta H^{\\circ}(T) = \\Delta H^{\\circ}(T_0) + \\Delta C_{p}^{\\circ}(T - T_0)$$\n对 $\\left(\\frac{\\partial \\Delta S^{\\circ}}{\\partial T}\\right)_{p} = \\frac{\\Delta C_{p}^{\\circ}}{T}$ 从 $T_0$ 到 $T$ 积分：\n$$\\int_{\\Delta S^{\\circ}(T_0)}^{\\Delta S^{\\circ}(T)} d(\\Delta S^{\\circ}) = \\int_{T_0}^{T} \\frac{\\Delta C_{p}^{\\circ}}{T} dT \\implies \\Delta S^{\\circ}(T) = \\Delta S^{\\circ}(T_0) + \\Delta C_{p}^{\\circ} \\ln \\left(\\frac{T}{T_0}\\right)$$\n平衡常数的温度依赖性由 van 't Hoff 方程的微分形式给出：\n$$\\frac{d(\\ln K_{\\mathrm{w}})}{dT} = \\frac{\\Delta H^{\\circ}(T)}{RT^2}$$\n代入 $\\Delta H^{\\circ}(T)$ 的表达式：\n$$\\frac{d(\\ln K_{\\mathrm{w}})}{dT} = \\frac{\\Delta H^{\\circ}(T_0) + \\Delta C_{p}^{\\circ}(T - T_0)}{RT^2} = \\frac{\\Delta H^{\\circ}(T_0) - T_0 \\Delta C_{p}^{\\circ}}{RT^2} + \\frac{\\Delta C_{p}^{\\circ}}{RT}$$\n对 $T$ 积分得到：\n$$\\ln K_{\\mathrm{w}}(T) = \\int \\left( \\frac{\\Delta H^{\\circ}(T_0) - T_0 \\Delta C_{p}^{\\circ}}{RT^2} + \\frac{\\Delta C_{p}^{\\circ}}{RT} \\right) dT$$\n$$\\ln K_{\\mathrm{w}}(T) = -\\frac{\\Delta H^{\\circ}(T_0) - T_0 \\Delta C_{p}^{\\circ}}{RT} + \\frac{\\Delta C_{p}^{\\circ}}{R} \\ln T + I$$\n其中 $I$ 是积分常数。转换为 $pK_{\\mathrm{w}}(T)$：\n$$pK_{\\mathrm{w}}(T) = \\frac{\\Delta H^{\\circ}(T_0) - T_0 \\Delta C_{p}^{\\circ}}{R \\ln 10} \\frac{1}{T} - \\frac{\\Delta C_{p}^{\\circ}}{R \\ln 10} \\ln T - \\frac{I}{\\ln 10}$$\n该方程是关于变量 $1/T$ 和 $\\ln T$ 的线性方程。为了进行线性回归，我们将其写为：\n$$pK_{\\mathrm{w}}(T) = \\beta_0 + \\beta_1 \\left(\\frac{1}{T}\\right) + \\beta_2 \\ln T$$\n需要估计的三个参数是 $\\beta_0$、$\\beta_1$ 和 $\\beta_2$。因此，模型 B 是一个三参数模型（$k=3$）。\n\n**计算方法**\n\n对于每个数据集，以摄氏度（$T_{^{\\circ}\\mathrm{C}}$）给出的温度使用 $T_{\\mathrm{K}} = T_{^{\\circ}\\mathrm{C}} + 273.15$ 转换为开尔文（$T_{\\mathrm{K}}$）。回归模型使用普通最小二乘法（OLS）进行拟合。对于形式为 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$ 的模型，参数向量 $\\boldsymbol{\\beta}$ 的 OLS 估计值为 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$。\n\n对于模型 A，$pK_{\\mathrm{w}}(T) = \\beta_0 + \\beta_1 (1/T)$，$n$ 个数据点的设计矩阵 $\\mathbf{X}_A$ 是：\n$$\\mathbf{X}_A = \\begin{pmatrix} 1  1/T_1 \\\\ 1  1/T_2 \\\\ \\vdots  \\vdots \\\\ 1  1/T_n \\end{pmatrix}$$\n对于模型 B，$pK_{\\mathrm{w}}(T) = \\beta_0 + \\beta_1 (1/T) + \\beta_2 \\ln T$，设计矩阵 $\\mathbf{X}_B$ 是：\n$$\\mathbf{X}_B = \\begin{pmatrix} 1  1/T_1  \\ln T_1 \\\\ 1  1/T_2  \\ln T_2 \\\\ \\vdots  \\vdots  \\vdots \\\\ 1  1/T_n  \\ln T_n \\end{pmatrix}$$\n模型的性能和复杂性通过以下方式评估：\n1.  **均方根误差 (RMSE)**：$\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_{i} - \\hat{y}_{i})^{2}}$，其中 $y_i$ 是观测到的 $pK_{\\mathrm{w}}$ 值，$\\hat{y}_i$ 是模型预测值。\n2.  **Akaike 信息准则 (AIC)**：$\\mathrm{AIC} = n \\ln(\\frac{\\mathrm{RSS}}{n}) + 2k$，其中 $\\mathrm{RSS} = \\sum_{i=1}^{n} (y_{i} - \\hat{y}_{i})^{2}$ 是残差平方和，而 $k$ 是拟合参数的数量（$k_A=2$, $k_B=3$）。\n\n如果 $\\mathrm{AIC}_{A} \\le \\mathrm{AIC}_{B} + 2$，则模型 A（较简单的模型）被认为是足够的。该准则在拟合优度与模型简约性之间取得平衡，对模型 B 中的额外参数进行惩罚，除非它能提供足够大的拟合改进。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting thermodynamic models to pKw data for water autoionization.\n    \n    This function processes four test cases. For each case, it fits two models (A and B)\n    to pKw vs. temperature data using ordinary least squares linear regression. It then\n    calculates the Root-Mean-Square Error (RMSE) and Akaike Information Criterion (AIC) for\n    each model, and determines if the simpler Model A is adequate based on the AIC difference rule.\n    \"\"\"\n  \n    # Define test cases: list of tuples, each containing temperature in Celsius and pKw values.\n    test_cases = [\n        {\n            \"temps_C\": [0, 25, 50, 75, 100],\n            \"pKw_obs\": [14.94, 14.00, 13.26, 12.64, 12.26]\n        },\n        {\n            \"temps_C\": [0, 25, 50, 100],\n            \"pKw_obs\": [14.94, 14.00, 13.26, 12.26]\n        },\n        {\n            \"temps_C\": [15, 25, 40, 60],\n            \"pKw_obs\": [14.35, 14.00, 13.54, 12.99]\n        },\n        {\n            \"temps_C\": [5, 35, 65, 95],\n            \"pKw_obs\": [14.73, 13.68, 12.87, 12.24]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        temps_C = np.array(case[\"temps_C\"])\n        pKw_obs = np.array(case[\"pKw_obs\"])\n        \n        # Convert temperatures from Celsius to Kelvin\n        temps_K = temps_C + 273.15\n        n = len(temps_K)\n\n        # --- Model A: pKw(T) = beta_0 + beta_1 * (1/T) ---\n        # k_A = 2 parameters\n        k_A = 2\n        \n        # Construct the design matrix X_A\n        X_A = np.vstack([np.ones(n), 1 / temps_K]).T\n        \n        # Perform ordinary least squares\n        # lstsq returns: coefficients, residual sum of squares (RSS), rank, singular values\n        # The second returned value is RSS if the number of rows of X_A > number of columns\n        coeffs_A, rss_A_array, rank_A, s_A = np.linalg.lstsq(X_A, pKw_obs, rcond=None)\n        \n        # If there are fewer data points than parameters, RSS is not returned in the array\n        if X_A.shape[0] == X_A.shape[1]:\n            pKw_pred_A = X_A @ coeffs_A\n            rss_A = np.sum((pKw_obs - pKw_pred_A)**2)\n        else:\n            rss_A = rss_A_array[0]\n\n        rmse_A = np.sqrt(rss_A / n)\n        # AIC = n * ln(RSS/n) + 2k\n        aic_A = n * np.log(rss_A / n) + 2 * k_A\n\n        # --- Model B: pKw(T) = beta_0 + beta_1 * (1/T) + beta_2 * ln(T) ---\n        # k_B = 3 parameters\n        k_B = 3\n        \n        # Construct the design matrix X_B\n        X_B = np.vstack([np.ones(n), 1 / temps_K, np.log(temps_K)]).T\n        \n        # Perform ordinary least squares\n        coeffs_B, rss_B_array, rank_B, s_B = np.linalg.lstsq(X_B, pKw_obs, rcond=None)\n\n        if X_B.shape[0] == X_B.shape[1]:\n            pKw_pred_B = X_B @ coeffs_B\n            rss_B = np.sum((pKw_obs - pKw_pred_B)**2)\n        else:\n            rss_B = rss_B_array[0]\n\n        rmse_B = np.sqrt(rss_B / n)\n        aic_B = n * np.log(rss_B / n) + 2 * k_B\n\n        # Adequacy check: Model A is adequate if AIC_A = AIC_B + 2\n        is_adequate_A = (aic_A = aic_B + 2)\n\n        # Append quintuple of results for the current case\n        all_results.extend([\n            f\"{rmse_A:.6f}\",\n            f\"{rmse_B:.6f}\",\n            f\"{aic_A:.6f}\",\n            f\"{aic_B:.6f}\",\n            str(is_adequate_A)\n        ])\n\n    # Print the final flattened list of results\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2920022"}, {"introduction": "为了建立一个真正具有预测性的模型，我们必须将热力学常数与介质的基本物理性质联系起来。这项高级练习将挑战你构建并筛选一个不仅将 $K_w$ 与温度关联，还与溶剂的介电常数关联的模型，并使用贝叶斯信息准则 (Bayesian Information Criterion, BIC) 来权衡模型的复杂性与准确性。[@problem_id:2920013]", "problem": "给定您在环境压力下纯液态水的物理上合理的温度相关数据：水的自电离平衡常数的以10为底的负对数 $pK_w(T)$ 和相对静态介电常数 $\\varepsilon(T)$。自电离反应为 $2\\,\\mathrm{H_2O}\\rightleftharpoons \\mathrm{H_3O^+} + \\mathrm{OH^-}$，其平衡常数 $K_w(T)$ 以活度定义。标准态平衡的基本热力学恒等式为 $\\,\\Delta G^\\circ(T) = - R T \\ln K(T)$。溶剂的介电响应影响离子的溶剂化自由能，因此也影响离子反应的 $\\Delta G^\\circ(T)$。您的任务是构建并评估一个回归模型，该模型仅使用与这些基础理论相一致的变换，将 $K_w(T)$ 与 $\\varepsilon(T)$ 联系起来。\n\n约束和建模要求：\n- 从基本恒等式 $\\,\\Delta G^\\circ(T) = - R T \\ln K_w(T)\\,$ 以及观察到连续介质静电溶剂化能依赖于 $\\varepsilon(T)$ 出发；例如，Born型依赖关系包含 $(1 - 1/\\varepsilon)$ 因子和 $\\varepsilon$ 的对数项。\n- 通过对平衡常数的自然对数 $\\ln K_w$（而非 $pK_w$）进行回归来重构问题。使用精确恒等式 $\\,pK_w = -\\log_{10} K_w\\,$，因此 $\\,\\ln K_w = -(\\ln 10)\\, pK_w$。\n- 构建带截距的参数线性模型，其中 $\\ln K_w$ 依赖于在 $(T,\\varepsilon)$ 处求值的以下候选基函数的子集：\n  1. $f_1(T,\\varepsilon) = 1/T$，\n  2. $f_2(T,\\varepsilon) = 1/\\varepsilon$，\n  3. $f_3(T,\\varepsilon) = 1 - 1/\\varepsilon$，\n  4. $f_4(T,\\varepsilon) = \\ln\\!\\big(1 - 1/\\varepsilon\\big)$，\n  5. $f_5(T,\\varepsilon) = (1/T)\\,\\big(1 - 1/\\varepsilon\\big)$，\n  6. $f_6(T,\\varepsilon) = (1/T)\\,\\ln\\!\\big(1 - 1/\\varepsilon\\big)$。\n- 为避免在有限数据下发生过拟合，限制模型在截距之外最多使用 $2$ 个基函数。\n- 在上述基函数的所有容许子集中，选择使贝叶斯信息准则 (BIC) 最小化的模型，该准则在训练集上计算。对于 $n$ 个观测值、$k$ 个拟合参数（包括截距）和残差平方和 $\\mathrm{RSS}$，\n  $$\\mathrm{BIC} = n \\ln\\!\\left(\\frac{\\mathrm{RSS}}{n}\\right) + k \\ln n.$$\n\n训练数据（用于拟合候选模型）：\n- $(T,\\varepsilon,pK_w)$ 元组，其中 $T$ 的单位为开尔文 (K)，$\\varepsilon$ 无量纲，$pK_w$ 无量纲：\n  - $(\\,273.15,\\; 87.9,\\; 14.94\\,)$\n  - $(\\,298.15,\\; 78.3,\\; 14.00\\,)$\n  - $(\\,323.15,\\; 69.9,\\; 13.26\\,)$\n  - $(\\,348.15,\\; 62.4,\\; 12.70\\,)$\n\n测试集（仅用于评估所选模型的预测准确性）：\n- 三个 $(T,\\varepsilon,pK_w^{\\text{true}})$ 元组，其中 $T$ 的单位为开尔文 (K)，$\\varepsilon$ 无量纲，$pK_w^{\\text{true}}$ 无量纲：\n  - $(\\,310.15,\\; 74.0,\\; 13.60\\,)$\n  - $(\\,333.15,\\; 66.9,\\; 13.00\\,)$\n  - $(\\,373.15,\\; 55.3,\\; 12.26\\,)$\n\n您的程序必须执行的计算任务：\n1. 对于训练数据，使用 $\\ln K_w = -(\\ln 10)\\, pK_w$ 将所有 $pK_w$ 值转换为 $\\ln K_w$。\n2. 枚举六个基函数的所有非空子集，并遵循最多包含两个函数的限制，同时始终添加一个截距列。对于每个子集，通过普通最小二乘法将模型与训练数据进行拟合。\n3. 对训练集上每个拟合的模型计算 BIC，并选择 BIC 最小的模型。\n4. 使用所选模型，在测试集上预测 $\\ln K_w$，并通过 $pK_w = -\\ln K_w / \\ln 10$ 将预测结果转换回 $pK_w$。\n5. 在 $pK_w$ 标度上计算测试集的均方根误差 (RMSE)：\n   $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{m}\\sum_{i=1}^{m}\\left(pK_{w,i}^{\\text{pred}} - pK_{w,i}^{\\text{true}}\\right)^2},$$\n   其中 $m$ 是测试点的数量。\n\n角度单位不适用。除上述指定单位外，不需要其他物理单位。所有输出均为无量纲。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n  - 第一项：测试集在 $pK_w$ 标度上的 RMSE，\n  - 后面各项：按上文列出的确切顺序排列的测试案例的预测 $pK_w$ 值。\n- 在打印输出中将每个浮点数四舍五入到四位小数。\n- 示例示意图（不要推断数字）：\"[rmse,pred_310.15K,pred_333.15K,pred_373.15K]\"。\n\n您的程序必须是完全自包含的，并且不得读取任何输入。它必须按照规定，仅使用所提供的数据，实现完整的训练、BIC 模型选择、预测和评估流程。", "solution": "所提出的问题是应用物理化学和统计建模中的一个有效练习。它具有科学依据，问题定义明确，并包含了得出唯一解所需的所有信息。我们将着手解决此问题。\n\n任务是寻找一个关于水自电离常数 $K_w$ 作为温度 $T$ 和静态介电常数 $\\varepsilon$ 函数的预测模型。我们分析的基础是热力学关系式 $\\Delta G^\\circ(T) = -R T \\ln K_w(T)$，它将标准反应吉布斯自由能 $\\Delta G^\\circ(T)$ 与平衡常数联系起来。离子溶剂化能对溶剂介电常数的依赖性，为关联 $\\Delta G^\\circ(T)$（并因此关联 $\\ln K_w(T)$）与 $\\varepsilon(T)$ 提供了物理基础。\n\n我们将把平衡常数的自然对数 $\\ln K_w$ 作为响应变量进行建模。实验数据以 $pK_w = -\\log_{10} K_w$ 的形式提供。转换很简单：\n$$\n\\ln K_w = \\ln(10^{-\\mathrm{p}K_w}) = -(\\ln 10) \\cdot \\mathrm{p}K_w\n$$\n这种转换将响应变量置于一个与标准吉布斯自由能 $\\Delta G^\\circ$ 成正比的标度上，而 $\\Delta G^\\circ$ 正是诸如离子溶剂化 Born 模型等物理模型通常描述的物理量。\n\n模型被规定为其参数是线性的，具有以下通用形式：\n$$\n\\ln K_w(T, \\varepsilon) = c_0 + \\sum_{j \\in S} c_j f_j(T, \\varepsilon)\n$$\n其中，$c_0$ 是截距，$\\{c_j\\}$ 是待定系数，$\\{f_j\\}$ 是从给定集合中选择的基函数。候选基函数集为：\n$f_1(T,\\varepsilon) = 1/T$，与范特霍夫方程的温度依赖性相关。\n$f_2(T,\\varepsilon) = 1/\\varepsilon$，静电依赖性的一种简单形式。\n$f_3(T,\\varepsilon) = 1 - 1/\\varepsilon$，源自离子溶剂化自由能的 Born 模型。\n$f_4(T,\\varepsilon) = \\ln(1 - 1/\\varepsilon)$，Born 项的非线性变换。\n$f_5(T,\\varepsilon) = (1/T)(1 - 1/\\varepsilon)$，代表了静电贡献的温度依赖性。\n$f_6(T,\\varepsilon) = (1/T)\\ln(1 - 1/\\varepsilon)$，一个类似的变体。\n\n为了防止在 $n=4$ 个点的少量训练数据集上出现过拟合，模型复杂度被限制为最多包含两个基函数（即 $|S| \\leq 2$）。这定义了一个包含 $\\binom{6}{1} + \\binom{6}{2} = 6 + 15 = 21$ 个模型的候选集。对于每个候选模型，我们将使用普通最小二乘 (OLS) 回归在训练数据上拟合系数 $\\{c_0, c_j\\}$。OLS 解使残差平方和 $\\mathrm{RSS} = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2$ 最小化，其中 $y_i$ 是 $\\ln K_w$ 的观测值，$\\hat{y}_i$ 是模型的预测值。\n\n模型选择将使用贝叶斯信息准则 (BIC) 进行，它在模型拟合度和复杂性之间提供了一种原则性的权衡。BIC 的计算公式为：\n$$\n\\mathrm{BIC} = n \\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right) + k \\ln n\n$$\n此处，$n=4$ 是训练观测点的数量，$k$ 是拟合参数的数量（对于有一个基函数的模型，$k=2$；对于有两个基函数的模型，$k=3$）。表现出最小 BIC 的模型将被选为数据的最优表示。\n\n一旦确定了最优模型（其基函数和系数），其预测性能将在一个包含 $m=3$ 个数据点的独立测试集上进行评估。我们将使用所选模型预测测试输入的 $\\ln K_w$ 值，然后将这些值转换回 $pK_w$ 标度：\n$$\n\\mathrm{p}K_{w,\\text{pred}} = -\\frac{\\ln K_{w,\\text{pred}}}{\\ln 10}\n$$\n这些预测的准确性将通过相对于测试集中提供的真实 $pK_w$ 值的均方根误差 (RMSE) 来量化：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{m}\\sum_{i=1}^{m}\\left(\\mathrm{p}K_{w,i}^{\\text{pred}} - \\mathrm{p}K_{w,i}^{\\text{true}}\\right)^2}\n$$\n整个过程将以数值方式实现。OLS 拟合将使用稳健的数值线性代数程序来执行。最终输出将按要求格式呈现计算出的测试集 RMSE 以及对测试用例的各个预测值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Constructs and evaluates a regression model for the autoionization of water.\n    The process includes:\n    1. Data preparation and transformation.\n    2. Enumeration of candidate models based on specified basis functions.\n    3. Model fitting via Ordinary Least Squares (OLS).\n    4. Model selection using the Bayesian Information Criterion (BIC).\n    5. Prediction on a test set using the best model.\n    6. Evaluation of predictive accuracy using Root-Mean-Square Error (RMSE).\n    \"\"\"\n\n    # --- Data Definition ---\n    # Training data: (T in K, epsilon, pKw)\n    train_data = np.array([\n        [273.15, 87.9, 14.94],\n        [298.15, 78.3, 14.00],\n        [323.15, 69.9, 13.26],\n        [348.15, 62.4, 12.70],\n    ])\n\n    # Test data: (T in K, epsilon, pKw_true)\n    test_data = np.array([\n        [310.15, 74.0, 13.60],\n        [333.15, 66.9, 13.00],\n        [373.15, 55.3, 12.26],\n    ])\n\n    # --- Data Preparation ---\n    T_train, eps_train, pKw_train = train_data.T\n    T_test, eps_test, pKw_true_test = test_data.T\n\n    # Convert pKw to ln(Kw) for the response variable y\n    ln10 = np.log(10)\n    y_train = -ln10 * pKw_train\n    \n    n_train = len(T_train)\n    n_test = len(T_test)\n\n    # --- Basis Function Definition ---\n    basis_functions = [\n        lambda T, eps: 1 / T,\n        lambda T, eps: 1 / eps,\n        lambda T, eps: 1 - 1 / eps,\n        lambda T, eps: np.log(1 - 1 / eps),\n        lambda T, eps: (1 / T) * (1 - 1 / eps),\n        lambda T, eps: (1 / T) * np.log(1 - 1 / eps),\n    ]\n\n    # Evaluate all basis functions on training and test sets\n    F_train = np.array([f(T_train, eps_train) for f in basis_functions]).T\n    F_test = np.array([f(T_test, eps_test) for f in basis_functions]).T\n\n    # --- Model Fitting and Selection ---\n    min_bic = float('inf')\n    best_model = {}\n\n    num_basis_funcs = F_train.shape[1]\n    \n    # Iterate through models with 1 or 2 basis functions\n    for num_features in [1, 2]:\n        for indices in combinations(range(num_basis_funcs), num_features):\n            indices = list(indices)\n            \n            # Construct design matrix X with intercept\n            X_train = np.c_[np.ones(n_train), F_train[:, indices]]\n            \n            # Perform Ordinary Least Squares\n            coeffs, residuals, rank, s = np.linalg.lstsq(X_train, y_train, rcond=None)\n            \n            # Check if fit was successful and residuals are available\n            if residuals.size == 0:\n                continue\n\n            rss = residuals[0]\n            k = num_features + 1  # Number of parameters including intercept\n            \n            # Calculate BIC\n            # To avoid log(0) if RSS is numerically zero\n            if rss  1e-12:\n                bic = -float('inf')\n            else:\n                bic = n_train * np.log(rss / n_train) + k * np.log(n_train)\n            \n            # Update best model if current BIC is lower\n            if bic  min_bic:\n                min_bic = bic\n                best_model = {'indices': indices, 'coeffs': coeffs}\n\n    # --- Prediction on Test Set ---\n    best_indices = best_model['indices']\n    best_coeffs = best_model['coeffs']\n    \n    # Construct test design matrix for the best model\n    X_test = np.c_[np.ones(n_test), F_test[:, best_indices]]\n    \n    # Predict ln(Kw) for the test set\n    lnKw_pred_test = X_test @ best_coeffs\n    \n    # Convert predictions back to pKw scale\n    pKw_pred_test = -lnKw_pred_test / ln10\n    \n    # --- Evaluation ---\n    # Calculate Root-Mean-Square Error (RMSE) on the test set\n    rmse = np.sqrt(np.mean((pKw_pred_test - pKw_true_test)**2))\n\n    # --- Format and Print Output ---\n    results_to_print = [rmse] + pKw_pred_test.tolist()\n    formatted_results = [f\"{val:.4f}\" for val in results_to_print]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2920013"}]}