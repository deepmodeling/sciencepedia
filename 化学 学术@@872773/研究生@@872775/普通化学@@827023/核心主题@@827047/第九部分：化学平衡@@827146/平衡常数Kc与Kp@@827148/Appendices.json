{"hands_on_practices": [{"introduction": "本练习旨在将我们对热力学平衡的理解应用于非理想溶液的实际情境中。我们将超越简单的浓度比值，探讨活度系数（它解释了分子间的相互作用）对于精确预测反应混合物最终组成的关键作用。通过这个实践，你将学习如何直接应用化学势和活度的定义来解决一个具体的计算问题。", "problem": "液相异构化反应 $A \\rightleftharpoons B$ 在恒定温度 $T$ 和恒定溶液体积下进行。以 $1\\ \\mathrm{mol\\ L^{-1}}$ 为标准态，浓度标度的热力学平衡常数（记为 $K_c(T)$）在 $T = 298\\ \\mathrm{K}$ 时已知为 $K_c(298\\ \\mathrm{K}) = 1.35$。初始时制备的溶液仅含异构体 $A$，其浓度为 $c_{A,0} = 0.100\\ \\mathrm{mol\\ L^{-1}}$，不含 $B$。溶液中含有足量的惰性电解质，以在所关注的组成范围内保持活度系数近似恒定。在 $298\\ \\mathrm{K}$ 下的独立测量表明，在这些条件下，$A$ 和 $B$ 的活度系数分别为 $\\gamma_{A} = 1.20$ 和 $\\gamma_{B} = 0.85$。假设标准浓度为 $c^{\\circ} = 1.0\\ \\mathrm{mol\\ L^{-1}}$，溶质的活度为 $a_{i} = \\gamma_{i} c_{i}/c^{\\circ}$，并且 $A$ 和 $B$ 均保持在同一相中，无副反应发生。\n\n仅从平衡时化学势相等和活度的定义出发，推导必要的关系式，并计算 $B$ 的不随时间变化的平衡浓度 $c_{B,\\mathrm{eq}}$，同时考虑 $\\gamma_{A} \\neq \\gamma_{B}$ 造成的非理想性。将最终答案四舍五入至三位有效数字。以 $\\mathrm{mol\\ L^{-1}}$ 为单位表示您的最终答案。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰。我们将进行推导和求解。\n\n对于在恒温恒压下进行的反应 $A \\rightleftharpoons B$，化学平衡的基本条件是所涉及物质的化学势相等。\n$$\n\\mu_{A,\\mathrm{eq}} = \\mu_{B,\\mathrm{eq}}\n$$\n溶液中物质 $i$ 的化学势 $\\mu_i$ 可以用其标准化学势 $\\mu_i^{\\circ}$ 和活度 $a_i$ 表示为：\n$$\n\\mu_i = \\mu_i^{\\circ} + RT \\ln(a_i)\n$$\n其中 $R$ 是理想气体常数，$T$ 是绝对温度。将此表达式代入平衡条件，得到：\n$$\n\\mu_A^{\\circ} + RT \\ln(a_{A,\\mathrm{eq}}) = \\mu_B^{\\circ} + RT \\ln(a_{B,\\mathrm{eq}})\n$$\n整理此方程，可将标准化学势分离出来：\n$$\n\\mu_B^{\\circ} - \\mu_A^{\\circ} = -RT \\ln\\left(\\frac{a_{B,\\mathrm{eq}}}{a_{A,\\mathrm{eq}}}\\right)\n$$\n左边的项 $\\mu_B^{\\circ} - \\mu_A^{\\circ}$ 是反应的标准吉布斯自由能变 $\\Delta_r G^{\\circ}$。热力学平衡常数（我们记为 $K_{\\text{th}}$）由关系式 $\\Delta_r G^{\\circ} = -RT \\ln(K_{\\text{th}})$ 定义。比较这两个 $\\Delta_r G^{\\circ}$ 的表达式，可得出用活度表示的热力学平衡常数的定义：\n$$\nK_{\\text{th}} = \\frac{a_{B,\\mathrm{eq}}}{a_{A,\\mathrm{eq}}}\n$$\n问题中给出了“浓度标度的热力学平衡常数”的值，$K_c = 1.35$。这必须被解释为真正的热力学常数 $K_{\\text{th}}$，其中活度是相对于 $c^{\\circ} = 1.0\\ \\mathrm{mol\\ L^{-1}}$ 的标准态定义的。因此，$K_c = K_{\\text{th}} = 1.35$。\n\n活度 $a_i$ 由 $a_i = \\gamma_i c_i / c^{\\circ}$ 给出，其中 $\\gamma_i$ 是活度系数，$c_i$ 是摩尔浓度。将此定义代入 $K_c$ 的表达式中：\n$$\nK_c = \\frac{\\gamma_B (c_{B,\\mathrm{eq}} / c^{\\circ})}{\\gamma_A (c_{A,\\mathrm{eq}} / c^{\\circ})} = \\frac{\\gamma_B}{\\gamma_A} \\frac{c_{B,\\mathrm{eq}}}{c_{A,\\mathrm{eq}}}\n$$\n注意标准浓度 $c^{\\circ}$ 项相互抵消。此方程将热力学常数 $K_c$与平衡浓度之比及活度系数联系起来。我们可以定义一个仅基于浓度的表观平衡常数 $K'_{c} = \\frac{c_{B,\\mathrm{eq}}}{c_{A,\\mathrm{eq}}}$。于是关系式变为 $K_c = \\frac{\\gamma_B}{\\gamma_A} K'_{c}$，或 $K'_{c} = K_c \\frac{\\gamma_A}{\\gamma_B}$。\n\n设 $x$ 表示达到平衡时 $A$ 的浓度变化量。根据反应化学计量式 $A \\rightleftharpoons B$，$A$ 的浓度减少 $x$ 会导致 $B$ 的浓度增加 $x$。鉴于初始条件 $c_{A,0} = 0.100\\ \\mathrm{mol\\ L^{-1}}$ 和 $c_{B,0} = 0$，平衡浓度为：\n$$\nc_{A,\\mathrm{eq}} = c_{A,0} - x\n$$\n$$\nc_{B,\\mathrm{eq}} = x\n$$\n将这些表达式代入 $K'_{c}$ 的方程中：\n$$\nK'_{c} = \\frac{x}{c_{A,0} - x}\n$$\n现在我们求解 $x$，即所求的平衡浓度 $c_{B,\\mathrm{eq}}$。\n$$\nK'_{c}(c_{A,0} - x) = x\n$$\n$$\nK'_{c} c_{A,0} - K'_{c} x = x\n$$\n$$\nK'_{c} c_{A,0} = x(1 + K'_{c})\n$$\n$$\nx = \\frac{K'_{c} c_{A,0}}{1 + K'_{c}}\n$$\n将 $K'_{c} = K_c \\frac{\\gamma_A}{\\gamma_B}$ 代回 $x$ 的表达式中：\n$$\nx = \\frac{\\left(K_c \\frac{\\gamma_A}{\\gamma_B}\\right) c_{A,0}}{1 + K_c \\frac{\\gamma_A}{\\gamma_B}}\n$$\n现在，我们代入所给的数值：$K_c = 1.35$，$\\gamma_A = 1.20$，$\\gamma_B = 0.85$ 以及 $c_{A,0} = 0.100\\ \\mathrm{mol\\ L^{-1}}$。\n首先，计算表观常数 $K'_{c}$ 的值：\n$$\nK'_{c} = 1.35 \\times \\frac{1.20}{0.85} = \\frac{1.62}{0.85} \\approx 1.90588\n$$\n现在，计算 $x = c_{B,\\mathrm{eq}}$：\n$$\nx = \\frac{1.90588 \\times 0.100}{1 + 1.90588} = \\frac{0.190588}{2.90588} \\approx 0.065587\\ \\mathrm{mol\\ L^{-1}}\n$$\n问题要求将最终答案四舍五入至三位有效数字。\n$$\nc_{B,\\mathrm{eq}} \\approx 0.0656\\ \\mathrm{mol\\ L^{-1}}\n$$", "answer": "$$\n\\boxed{0.0656}\n$$", "id": "2938552"}, {"introduction": "在科研实践中，近似是一种强大的工具，但必须审慎使用。本练习要求你为离子溶液和非理想气体定义理想性的边界。通过应用德拜-休克尔极限法（Debye-Hückel limiting law）和维里方程（virial equation），你将建立定量标准，以判断何时可以用浓度或分压近似替代活度，这是设计实验和解读数据时的一项关键技能。", "problem": "在平衡热力学中，真实平衡常数是使用活度来定义的，而不是直接使用浓度或分压。考虑在温度为 $298\\,\\mathrm{K}$ 的两个典型体系，标准浓度为 $c^\\circ = 1\\,\\mathrm{M}$，标准压力为 $P^\\circ = 1\\,\\mathrm{bar}$。气体常数可取为 $R = 0.08314\\,\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}}$。\n\n体系1（水溶液，离子的）：在由惰性背景电解质控制的离子强度 $I$ 下，研究水中的配合物形成反应\n$\\mathrm{Fe^{3+} + SCN^- \\rightleftharpoons FeSCN^{2+}}$\n。在 $298\\,\\mathrm{K}$ 时，Debye-Hückel 极限法中出现的常数 $A$ 的值为 $A = 0.509$（以10为底的对数）。\n\n体系2（气相）：在总压力为 $P$ 的条件下，研究基元气相离解反应\n$\\mathrm{A \\rightleftharpoons 2\\,B}$\n。在 $298\\,\\mathrm{K}$ 时，第二维里系数分别为 $B_{\\mathrm{A}} = -70\\,\\mathrm{cm^3\\,mol^{-1}}$ 和 $B_{\\mathrm{B}} = -120\\,\\mathrm{cm^3\\,mol^{-1}}$。\n\n一位研究生希望确定，在保证平衡常数的相对误差容限最多为 $5\\%$ 的情况下，何时可以用摩尔浓度（体系1）或用分压除以标准压力（体系2）来近似活度。此外，对体系2还考虑一个更严格的 $1\\%$ 容限。\n\n下列哪些独立的定量标准足以确保达到所述的容限？选择所有适用的选项。\n\nA. 对于体系1，如果 $I \\le 4.0 \\times 10^{-5}\\,\\mathrm{M}$，那么用摩尔浓度替代活度所产生的平衡常数相对误差低于 $5\\%$。\n\nB. 对于体系2，使用上述数据并在 $298\\,\\mathrm{K}$ 时，如果 $P \\le 3.0\\,\\mathrm{bar}$，那么用分压（除以 $P^\\circ$）替代活度所产生的平衡常数相对误差低于 $5\\%$。\n\nC. 对于任何 $\\Delta \\nu = 0$（气态物质的化学计量系数之和为零）的气相反应，在任何压力下都可以用分压代替活度，因为非理想性会完全抵消。\n\nD. 对于体系1，如果 $I \\le 1.0 \\times 10^{-3}\\,\\mathrm{M}$，那么用摩尔浓度替代活度所产生的平衡常数相对误差低于 $5\\%$。\n\nE. 对于体系2，使用上述数据并在 $298\\,\\mathrm{K}$ 时，如果需要更严格的 $1\\%$ 容限，那么 $P \\le 0.70\\,\\mathrm{bar}$ 的条件足以用分压（除以 $P^\\circ$）替代活度。", "solution": "**问题验证**\n\n**步骤1：提取已知条件**\n\n*   温度：$T = 298\\,\\mathrm{K}$\n*   标准浓度：$c^\\circ = 1\\,\\mathrm{M}$\n*   标准压力：$P^\\circ = 1\\,\\mathrm{bar}$\n*   气体常数：$R = 0.08314\\,\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}}$\n*   体系1（水溶液）：\n    *   反应：$\\mathrm{Fe^{3+} + SCN^- \\rightleftharpoons FeSCN^{2+}}$\n    *   用于以10为底的对数的 Debye-Hückel 常数：$A = 0.509$\n*   体系2（气相）：\n    *   反应：$\\mathrm{A \\rightleftharpoons 2\\,B}$\n    *   第二维里系数：$B_{\\mathrm{A}} = -70\\,\\mathrm{cm^3\\,mol^{-1}}$，$B_{\\mathrm{B}} = -120\\,\\mathrm{cm^3\\,mol^{-1}}$\n*   误差容限：\n    *   体系1：平衡常数的相对误差 $\\le 5\\%$\n    *   体系2：平衡常数的相对误差 $\\le 5\\%$\n    *   体系2（更严格）：平衡常数的相对误差 $\\le 1\\%$\n\n**步骤2：使用提取的已知条件进行验证**\n\n问题具有科学依据，它采用了物理化学中的标准模型来量化溶液和气体中的非理想行为。Debye-Hückel 极限法用于离子溶液，维里状态方程用于非理想气体。这些是适用于本情景的基本且恰当的概念。问题提得很好，要求找出满足给定误差容限的离子强度 ($I$) 和压力 ($P$) 的充分条件。这是一个数学上确定性的问题。所有进行必要计算所需的数据（常数、维里系数、反应化学计量、温度）都已提供。语言客观且精确。物理数值是符合实际的。该问题没有违反任何导致无效的标准。\n\n**步骤3：结论与行动**\n\n问题陈述有效。将推导解答。\n\n**解题推导与选项分析**\n\n问题的核心是将真实的热力学平衡常数 $K_a$ 与一个用浓度或分压替代活度的近似形式进行比较。相对误差定义为 $|\\frac{K_{\\text{approx}}}{K_a} - 1|$。\n\n**体系1（水溶液反应）分析**\n\n反应为 $\\mathrm{Fe^{3+}(aq) + SCN^-(aq) \\rightleftharpoons FeSCN^{2+}(aq)}$。\n热力学平衡常数为 $K_a = \\frac{a_{\\mathrm{FeSCN^{2+}}}}{a_{\\mathrm{Fe^{3+}}} a_{\\mathrm{SCN^-}}}$。\n离子 $j$ 的活度由 $a_j = \\gamma_j \\frac{c_j}{c^\\circ}$ 给出，其中 $\\gamma_j$ 是活度系数，$c_j$ 是其摩尔浓度。\n该近似方法涉及用摩尔浓度替代活度，这等同于假设所有活度系数都为1（$\\gamma_j = 1$）。近似的（无量纲的）平衡常数为 $K_{\\text{approx}} = \\frac{c_{\\mathrm{FeSCN^{2+}}}/c^\\circ}{(c_{\\mathrm{Fe^{3+}}}/c^\\circ)(c_{\\mathrm{SCN^-}}/c^\\circ)}$。\n近似常数与真实常数之比为：\n$$ \\frac{K_{\\text{approx}}}{K_a} = \\frac{1}{\\frac{\\gamma_{\\mathrm{FeSCN^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}} \\gamma_{\\mathrm{SCN^-}}}} = \\frac{\\gamma_{\\mathrm{Fe^{3+}}} \\gamma_{\\mathrm{SCN^-}}}{\\gamma_{\\mathrm{FeSCN^{2+}}}} $$\n设这个活度系数之比为 $K_\\gamma^{-1}$。相对误差为 $|K_\\gamma^{-1} - 1|$。\n\n我们使用 Debye-Hückel 极限法来求活度系数：$\\log_{10} \\gamma_j = -A z_j^2 \\sqrt{I/(c^\\circ)}$。当 $c^\\circ=1\\,\\mathrm{M}$ 时，我们有 $\\log_{10} \\gamma_j = -A z_j^2 \\sqrt{I}$。\n对该比值取对数：\n$$ \\log_{10} (K_\\gamma^{-1}) = \\log_{10}(\\gamma_{\\mathrm{Fe^{3+}}}) + \\log_{10}(\\gamma_{\\mathrm{SCN^-}}) - \\log_{10}(\\gamma_{\\mathrm{FeSCN^{2+}}}) $$\n$$ \\log_{10} (K_\\gamma^{-1}) = -A \\sqrt{I} \\left( z_{\\mathrm{Fe^{3+}}}^2 + z_{\\mathrm{SCN^-}}^2 - z_{\\mathrm{FeSCN^{2+}}}^2 \\right) $$\n电荷分别为 $z_{\\mathrm{Fe^{3+}}} = +3$，$z_{\\mathrm{SCN^-}} = -1$ 和 $z_{\\mathrm{FeSCN^{2+}}} = +2$。\n$$ \\log_{10} (K_\\gamma^{-1}) = -A \\sqrt{I} \\left( (3)^2 + (-1)^2 - (2)^2 \\right) = -A \\sqrt{I} (9 + 1 - 4) = -6 A \\sqrt{I} $$\n代入 $A = 0.509$：\n$$ \\log_{10} (K_\\gamma^{-1}) = -6(0.509)\\sqrt{I} = -3.054 \\sqrt{I} $$\n因此，$K_\\gamma^{-1} = 10^{-3.054\\sqrt{I}}$。\n由于 $I > 0$，该比值小于1。相对误差为 $1 - K_\\gamma^{-1} = 1 - 10^{-3.054\\sqrt{I}}$。\n我们要求此误差最多为 $5\\%$，即 $0.05$。\n$$ 1 - 10^{-3.054\\sqrt{I}} \\le 0.05 $$\n$$ 0.95 \\le 10^{-3.054\\sqrt{I}} $$\n对两边取以10为底的对数：\n$$ \\log_{10}(0.95) \\le -3.054\\sqrt{I} $$\n$$ -0.02228 \\le -3.054\\sqrt{I} $$\n$$ \\sqrt{I} \\le \\frac{0.02228}{3.054} \\approx 0.007295 $$\n$$ I \\le (0.007295)^2 \\approx 5.32 \\times 10^{-5}\\,\\mathrm{M} $$\n这个不等式给出了误差在 $5\\%$ 容限内的最大离子强度。任何比这更严格的条件都是充分的。\n\nA. 对于体系1，如果 $I \\le 4.0 \\times 10^{-5}\\,\\mathrm{M}$，那么用摩尔浓度替代活度所产生的平衡常数相对误差低于 $5\\%$。\n条件 $I \\le 4.0 \\times 10^{-5}\\,\\mathrm{M}$ 比我们推导出的极限 $I \\le 5.32 \\times 10^{-5}\\,\\mathrm{M}$ 更严格。因此，如果满足此条件，误差确实会小于 $5\\%$。**正确**。\n\nD. 对于体系1，如果 $I \\le 1.0 \\times 10^{-3}\\,\\mathrm{M}$，那么用摩尔浓度替代活度所产生的平衡常数相对误差低于 $5\\%$。\n这个条件比我们推导的极限宽松得多。在 $I = 1.0 \\times 10^{-3}\\,\\mathrm{M}$ 时，相对误差将是 $1 - 10^{-3.054\\sqrt{0.001}} \\approx 1 - 10^{-0.09657} \\approx 1 - 0.8005 = 0.1995$，即 $19.95\\%$。这超过了 $5\\%$ 的容限。该条件不充分。**不正确**。\n\n**体系2（气相反应）分析**\n\n反应为 $\\mathrm{A(g) \\rightleftharpoons 2B(g)}$。\n热力学平衡常数为 $K_a = \\frac{a_{\\mathrm{B}}^2}{a_{\\mathrm{A}}}$。气体组分 $j$ 的活度为 $a_j = f_j/P^\\circ = (\\phi_j P_j)/P^\\circ$，其中 $f_j$ 是其逸度，$\\phi_j$ 是其逸度系数，$P_j$ 是其分压。\n该近似方法是用分压（除以标准压力）替代活度，这等同于假设逸度系数为1（$\\phi_j=1$）。近似常数为 $K_{\\text{approx}} = \\frac{(P_{\\mathrm{B}}/P^\\circ)^2}{P_{\\mathrm{A}}/P^\\circ}$。\n该比值为：\n$$ \\frac{K_{\\text{approx}}}{K_a} = \\frac{1}{\\frac{\\phi_{\\mathrm{B}}^2}{\\phi_{\\mathrm{A}}}} = \\frac{\\phi_{\\mathrm{A}}}{\\phi_{\\mathrm{B}}^2} $$\n设此比值为 $K_\\phi^{-1}$。相对误差为 $|K_\\phi^{-1} - 1|$。\n\n对于中等压力下气体混合物中的组分 $j$，其逸度系数可以使用 Lewis-Randall 规则近似为 $\\ln \\phi_j \\approx \\frac{B_{jj}P}{RT}$，其中 $B_{jj}$ 是纯组分 $j$ 的第二维里系数，$P$ 是总压力。\n对该比值取自然对数：\n$$ \\ln(K_\\phi^{-1}) = \\ln(\\phi_{\\mathrm{A}}) - 2\\ln(\\phi_{\\mathrm{B}}) \\approx \\frac{B_{\\mathrm{A}}P}{RT} - 2\\frac{B_{\\mathrm{B}}P}{RT} = \\frac{P}{RT}(B_{\\mathrm{A}} - 2B_{\\mathrm{B}}) $$\n维里系数必须采用适当的单位：$B_{\\mathrm{A}} = -70\\,\\mathrm{cm^3\\,mol^{-1}} = -0.070\\,\\mathrm{L\\,mol^{-1}}$ 和 $B_{\\mathrm{B}} = -120\\,\\mathrm{cm^3\\,mol^{-1}} = -0.120\\,\\mathrm{L\\,mol^{-1}}$。\n$$ B_{\\mathrm{A}} - 2B_{\\mathrm{B}} = -0.070 - 2(-0.120) = -0.070 + 0.240 = 0.170\\,\\mathrm{L\\,mol^{-1}} $$\n乘积 $RT$ 为 $(0.08314\\,\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}})(298\\,\\mathrm{K}) \\approx 24.776\\,\\mathrm{L\\,bar\\,mol^{-1}}$。\n$$ \\ln(K_\\phi^{-1}) \\approx \\frac{P \\cdot (0.170\\,\\mathrm{L\\,mol^{-1}})}{24.776\\,\\mathrm{L\\,bar\\,mol^{-1}}} \\approx (0.00686\\,\\mathrm{bar^{-1}}) P $$\n所以，$K_\\phi^{-1} \\approx e^{0.00686P}$。由于 $P0$，$K_\\phi^{-1}  1$。相对误差为 $e^{0.00686P} - 1$。\n\n我们现在检查这两个容限的标准。\n对于 $5\\%$ 的容限：\n$$ e^{0.00686P} - 1 \\le 0.05 \\implies e^{0.00686P} \\le 1.05 $$\n$$ 0.00686P \\le \\ln(1.05) \\approx 0.04879 $$\n$$ P \\le \\frac{0.04879}{0.00686} \\approx 7.11\\,\\mathrm{bar} $$\n对于 $1\\%$ 的容限：\n$$ e^{0.00686P} - 1 \\le 0.01 \\implies e^{0.00686P} \\le 1.01 $$\n$$ 0.00686P \\le \\ln(1.01) \\approx 0.00995 $$\n$$ P \\le \\frac{0.00995}{0.00686} \\approx 1.45\\,\\mathrm{bar} $$\n\nB. 对于体系2，使用上述数据并在 $298\\,\\mathrm{K}$ 时，如果 $P \\le 3.0\\,\\mathrm{bar}$，那么用分压（除以 $P^\\circ$）替代活度所产生的平衡常数相对误差低于 $5\\%$。\n条件 $P \\le 3.0\\,\\mathrm{bar}$ 比为 $5\\%$ 误差推导出的极限 $P \\le 7.11\\,\\mathrm{bar}$ 更严格。因此，此条件是充分的。**正确**。\n\nE. 对于体系2，使用上述数据并在 $298\\,\\mathrm{K}$ 时，如果需要更严格的 $1\\%$ 容限，那么 $P \\le 0.70\\,\\mathrm{bar}$ 的条件足以用分压（除以 $P^\\circ$）替代活度。\n条件 $P \\le 0.70\\,\\mathrm{bar}$ 比为 $1\\%$ 误差推导出的极限 $P \\le 1.45\\,\\mathrm{bar}$ 更严格。因此，此条件是充分的。**正确**。\n\n**选项C分析**\n\nC. 对于任何 $\\Delta \\nu = 0$（气态物质的化学计量系数之和为零）的气相反应，在任何压力下都可以用分压代替活度，因为非理想性会完全抵消。\n这个陈述声称，如果 $\\Delta \\nu = \\sum_j \\nu_j = 0$，那么在任何压力下 $K_\\phi=\\prod_j \\phi_j^{\\nu_j}=1$。这要求 $\\ln(K_\\phi) = \\sum_j \\nu_j \\ln(\\phi_j) = 0$。\n使用与前面相同的近似，$\\ln \\phi_j \\approx \\frac{B_{jj}P}{RT}$：\n$$ \\sum_j \\nu_j \\ln(\\phi_j) \\approx \\frac{P}{RT} \\sum_j \\nu_j B_{jj} $$\n要使其在任何压力 $P$ 下都为零，条件必须是 $\\sum_j \\nu_j B_{jj} = 0$。维里系数 $B_{jj}$ 是单个物质 $j$ 的属性。没有物理定律规定，仅仅因为化学计量系数之和为零，这个维里系数的特定组合就必须为零。对于一个一般反应 $\\mathrm{H_2 + I_2 \\rightleftharpoons 2HI}$，$\\Delta\\nu=0$，但 $2B_{\\mathrm{HI}} - B_{\\mathrm{H_2}} - B_{\\mathrm{I_2}}$ 通常不为零。因此，非理想性通常不会抵消，该陈述是错误的。近似式 $K_a \\approx K_p'$ 仅在 $P \\to 0$ 时对所有气体都变得精确。**不正确**。\n\n**总结**\n- 选项A是正确的。\n- 选项B是正确的。\n- 选项C是错误的。\n- 选项D是错误的。\n- 选项E是正确的。\n正确的选项是A、B和E。", "answer": "$$\\boxed{ABE}$$", "id": "2938508"}, {"introduction": "化学反应很少孤立发生，它们往往是复杂网络的一部分。这最后一个练习将我们的分析提升到系统层面，引入了作为基本热力学约束的韦格沙伊德恒等式（Wegscheider's identities），以确保网络中平衡常数的自洽性。你将通过实现一种计算方法，来使实验数据与这些理论约束相协调，这项任务代表了现代化学数据分析与建模的典型工作。", "problem": "给定您几个耦合的理想气体反应网络。对于每个网络，提供了一组报告的平衡常数及其类型（基于浓度的平衡常数 $K_c$ 或基于压力的平衡常数 $K_p$）、一个共同的温度 $T$（单位为 $\\mathrm{K}$）以及报告常数的自然对数的标准差。您的任务是实现一个程序，该程序对每个网络执行热力学一致性检查，然后计算满足化学计量所蕴含的所有 Wegscheider 恒等式的最小调整平衡常数集。\n\n使用的基本原理：\n- 对于气相反应，使用理想气体定律的形式 $K_p = K_c \\left(R T\\right)^{\\Delta \\nu}$，其中 $\\Delta \\nu$ 是给定反应中反应物到产物的气体总摩尔数变化量，$R$ 是通用气体常数，$T$ 是温度。使用 $R = 0.0831446261815324\\,\\mathrm{L\\cdot bar\\cdot mol^{-1}\\cdot K^{-1}}$。\n- 标准吉布斯自由能关系 $\\Delta_r G^\\circ = - R T \\ln K$ 以及反应吉布斯自由能的化学计量构成 $\\Delta_r G^\\circ = \\mathbf{N}^\\top \\boldsymbol{\\mu}^\\circ$，其中 $\\mathbf{N}$ 是化学计量矩阵（物种×反应），$\\boldsymbol{\\mu}^\\circ$ 是在选定标准状态下各物种的化学势。\n- Wegscheider 恒等式：对于满足 $\\mathbf{N}\\,\\mathbf{c} = \\mathbf{0}$ 的任何系数向量 $\\mathbf{c}$，必须满足恒等式 $\\prod_j K_j^{c_j} = 1$，或等价地 $\\mathbf{c}^\\top \\ln \\mathbf{K} = 0$。\n\n需要实现的数学公式：\n- 对于每个网络，使用理想气体关系将所有报告的常数转换为通用的基于压力的形式 $K_p$。在自然对数空间中进行计算。令 $\\mathbf{x} = \\ln \\mathbf{K}_p^{\\mathrm{rep}}$ 表示转换后报告值的对数形式向量。\n- 设 $\\mathbf{N} \\in \\mathbb{R}^{S \\times R}$ 为化学计量矩阵，其行由物种索引，列由反应索引。确定 $\\mathbf{N}$ 的零空间的一组基，以获得一个矩阵 $\\mathbf{A} \\in \\mathbb{R}^{d \\times R}$，其行是满足 $\\mathbf{N}\\,\\mathbf{c} = \\mathbf{0}$ 的独立向量 $\\mathbf{c}$。对于调整后的对数常数 $\\mathbf{y} = \\ln \\mathbf{K}_p^{\\mathrm{adj}}$，Wegscheider 恒等式的对数形式变为 $\\mathbf{A}\\,\\mathbf{y} = \\mathbf{0}$。\n- 给定一个对角权重矩阵 $\\mathbf{W} = \\mathrm{diag}(w_1,\\dots,w_R)$，其中 $w_j = 1/\\sigma_j^2$，$\\sigma_j$ 是反应 $j$ 的 $\\ln K$ 的给定标准差，计算求解二次规划的最小调整值 $\\mathbf{y}$\n  最小化 $\\left\\|\\mathbf{y} - \\mathbf{x}\\right\\|_{\\mathbf{W}}^2$ 约束于 $\\mathbf{A}\\,\\mathbf{y} = \\mathbf{0}$，\n  其中 $\\left\\|\\mathbf{v}\\right\\|_{\\mathbf{W}}^2 = \\mathbf{v}^\\top \\mathbf{W}\\,\\mathbf{v}$。其闭式解为\n  $$\\mathbf{y} = \\mathbf{x} - \\mathbf{W}^{-1}\\mathbf{A}^\\top\\left(\\mathbf{A}\\,\\mathbf{W}^{-1}\\mathbf{A}^\\top\\right)^{+}\\mathbf{A}\\,\\mathbf{x},$$\n  其中 $(\\cdot)^{+}$ 表示 Moore–Penrose 伪逆。如果 $\\mathbf{A}$ 没有行（即没有循环），则 $\\mathbf{y} = \\mathbf{x}$。\n\n计算出 $\\mathbf{y}$ 后，以基于压力的形式报告调整后的平衡常数 $\\mathbf{K}_p^{\\mathrm{adj}} = \\exp(\\mathbf{y})$。\n\n假设：\n- 所有物种均为气体，且活度遵循理想气体行为。\n- $\\mathbf{N}$ 中的化学计量系数是整数，反应物为负值，产物为正值。\n- 所有提供的平衡常数均为严格正数。\n- 提供的标准差是常数自然对数的标准差，并且是严格正数。\n\n程序要求：\n- 精确实现上述逻辑。\n- 使用提供的 $R$ 值。\n- 全程使用自然对数。\n\n测试套件：\n提供一个程序来解决以下 $4$ 个网络。对于每个网络 $i$，您将得到一个由以下部分组成的元组：\n- 化学计量矩阵 $\\mathbf{N}^{(i)}$，表示为一个行列表，每行为长度为 $R^{(i)}$ 的列表，\n- 每个反应的类型列表，每个类型属于 $\\{\\text{Kp},\\text{Kc}\\}$，\n- 报告的常数列表 $\\left[K^{\\mathrm{rep}}_1,\\dots,K^{\\mathrm{rep}}_{R^{(i)}}\\right]$，\n- 温度 $T^{(i)}$，单位为 $\\mathrm{K}$，\n- 自然对数的标准差列表 $\\left[\\sigma_1,\\dots,\\sigma_{R^{(i)}}\\right]$。\n\n案例 1 (单个独立循环，所有 $\\Delta \\nu = 0$)：\n- $\\mathbf{N}^{(1)} = \\left[\\;[-1,\\,0,\\,1],\\;[1,\\,-1,\\,0],\\;[0,\\,1,\\,-1]\\;\\right]$。\n- 类型：$\\left[\\text{Kp},\\;\\text{Kp},\\;\\text{Kp}\\right]$。\n- 报告的常数：$\\left[2.0,\\,3.0,\\,0.2\\right]$。\n- $T^{(1)} = 700.0\\ \\mathrm{K}$。\n- $\\ln K$ 的标准差：$\\left[0.05,\\,0.05,\\,0.05\\right]$。\n\n案例 2 (混合 $K_c$ 和 $K_p$，非零 $\\Delta \\nu$，一个循环)：\n- $\\mathbf{N}^{(2)} = \\left[\\;[-1,\\,0,\\,-1],\\;[2,\\,-1,\\,1],\\;[0,\\,1,\\,1]\\;\\right]$。\n- 类型：$\\left[\\text{Kc},\\;\\text{Kc},\\;\\text{Kp}\\right]$。\n- 报告的常数：$\\left[0.05,\\,4.0,\\,9.5\\right]$。\n- $T^{(2)} = 600.0\\ \\mathrm{K}$。\n- $\\ln K$ 的标准差：$\\left[0.10,\\,0.05,\\,0.10\\right]$。\n\n案例 3 (无循环；独立反应)：\n- $\\mathbf{N}^{(3)} = \\left[\\;[-1,\\,0],\\;[1,\\,0],\\;[0,\\,-1],\\;[0,\\,1]\\;\\right]$。\n- 类型：$\\left[\\text{Kp},\\;\\text{Kc}\\right]$。\n- 报告的常数：$\\left[10.0,\\,0.1\\right]$。\n- $T^{(3)} = 450.0\\ \\mathrm{K}$。\n- $\\ln K$ 的标准差：$\\left[0.02,\\,0.02\\right]$。\n\n案例 4 (冗余循环；过参数化)：\n- $\\mathbf{N}^{(4)} = \\left[\\;[-1,\\,0,\\,-1,\\,2],\\;[1,\\,-1,\\,0,\\,0],\\;[0,\\,1,\\,1,\\,-2]\\;\\right]$。\n- 类型：$\\left[\\text{Kp},\\;\\text{Kp},\\;\\text{Kp},\\;\\text{Kp}\\right]$。\n- 报告的常数：$\\left[1.8,\\,0.5,\\,0.95,\\,1.0\\right]$。\n- $T^{(4)} = 500.0\\ \\mathrm{K}$。\n- $\\ln K$ 的标准差：$\\left[0.05,\\,0.05,\\,0.05,\\,0.05\\right]$。\n\n输出规范：\n- 对于每个案例 $i$，以与该案例提供时相同的反应顺序，将调整后的常数 $\\mathbf{K}_p^{\\mathrm{adj},(i)}$ 作为包含 $R^{(i)}$ 个浮点数的列表输出。\n- 将这 $4$ 个案例的结果聚合到一行中，作为一个包含 $4$ 个列表的逗号分隔列表，不含空格，并用方括号括起来。例如，输出格式为 $\\left[\\left[k_{11},k_{12},\\dots\\right],\\left[k_{21},\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right]\\right]$。\n- 所有调整后的平衡常数都是无量纲的。输出中不需要单位。", "solution": "问题陈述已经过严格验证，被认为是科学上和数学上可靠、自洽且适定的。它提出了一个化学热力学和数据协调中的标准问题。我们现在开始进行求解。\n\n问题的核心在于对一组实验测定的平衡常数强制施加热力学一致性。对于一个化学反应网络，平衡常数不是独立的量。它们通过网络的化学计量相互关联，这是因为每种化学物种的标准生成吉布斯自由能是状态函数的结果。这些相互依赖关系在数学上由 Wegscheider 恒等式表达。\n\n设反应网络由 $S$ 个物种和 $R$ 个反应组成。该网络的化学计量由化学计量矩阵 $\\mathbf{N} \\in \\mathbb{R}^{S \\times R}$ 完全描述，其中元素 $N_{ij}$ 是物种 $i$ 在反应 $j$ 中的化学计量系数。按照惯例，$N_{ij}$ 对于反应物为负，对于产物为正。\n\n每个反应 $j$ 的标准反应吉布斯自由能，记为 $\\Delta_r G_j^\\circ$，与物种的标准化学势 $\\boldsymbol{\\mu}^\\circ \\in \\mathbb{R}^S$ 通过以下方程相关联：\n$$ \\Delta_r \\mathbf{G}^\\circ = \\mathbf{N}^\\top \\boldsymbol{\\mu}^\\circ $$\n其中 $\\Delta_r \\mathbf{G}^\\circ \\in \\mathbb{R}^R$ 是反应吉布斯自由能的向量。\n\n当反应化学计量向量的线性组合之和为零时，就会出现一个基本的热力学循环约束，即 Wegscheider 恒等式。这样的组合代表一个使系统返回其初始状态的过程。设 $\\mathbf{c} \\in \\mathbb{R}^R$ 是这样一个线性组合的系数向量。净化学计量变化为零的条件表示为 $\\mathbf{N} \\mathbf{c} = \\mathbf{0}$。这意味着 $\\mathbf{c}$ 位于矩阵 $\\mathbf{N}$ 的零空间中。\n\n对于任何这样的向量 $\\mathbf{c}$，相应的反应吉布斯自由能的线性组合也必须为零：\n$$ \\mathbf{c}^\\top \\Delta_r \\mathbf{G}^\\circ = \\mathbf{c}^\\top (\\mathbf{N}^\\top \\boldsymbol{\\mu}^\\circ) = (\\mathbf{N} \\mathbf{c})^\\top \\boldsymbol{\\mu}^\\circ = \\mathbf{0}^\\top \\boldsymbol{\\mu}^\\circ = 0 $$\n标准反应吉布斯自由能通过著名关系式 $\\Delta_r G_j^\\circ = -R T \\ln K_j$ 与热力学平衡常数 $K_j$ 相关。将此代入前一个方程可得：\n$$ \\mathbf{c}^\\top (-R T \\ln \\mathbf{K}) = 0 \\implies \\sum_{j=1}^{R} c_j \\ln K_j = 0 $$\n其中 $\\ln \\mathbf{K}$ 是平衡常数自然对数的向量。其指数形式为 $\\prod_{j=1}^{R} K_j^{c_j} = 1$。这些就是 Wegscheider 恒等式。\n\n该问题要求对一组测量的、因此不完美的平衡常数进行调整，以使其满足这些恒等式。这是一个经典的数据协调问题。我们给定报告的常数 $\\mathbf{K}^{\\mathrm{rep}}$ 及其相关的不确定性，表示为其自然对数的标准差 $\\sigma_j$。目标是找到一组满足 Wegscheider 恒等式并且与报告值“最接近”的调整后常数 $\\mathbf{K}^{\\mathrm{adj}}$。距离的度量是在对数空间中的加权平方误差，其中权重与每次测量的方差成反比。\n\n算法流程如下：\n\n$1$. **标准化平衡常数**：所有报告的平衡常数必须转换为一种通用形式，这里选择基于压力的常数 $K_p$。从基于浓度的常数 $K_c$ 的转换由理想气体定律给出：\n$$ K_p = K_c (R T)^{\\Delta \\nu} $$\n其中 $R$ 是通用气体常数（$0.0831446261815324\\,\\mathrm{L\\cdot bar\\cdot mol^{-1}\\cdot K^{-1}}$），$T$ 是以开尔文为单位的绝对温度，反应 $j$ 的 $\\Delta \\nu_j$ 是气体摩尔数的变化量，计算方法为反应 $j$ 中化学计量系数的总和：$\\Delta \\nu_j = \\sum_{i=1}^{S} N_{ij}$。\n\n$2$. **对数变换**：通过处理平衡常数的自然对数来使问题线性化。设 $\\mathbf{x} = \\ln \\mathbf{K}_p^{\\mathrm{rep}}$ 为报告的（并已转换的）常数的自然对数向量。设 $\\mathbf{y} = \\ln \\mathbf{K}_p^{\\mathrm{adj}}$ 为所求的调整后对数常数的向量。\n\n$3$. **构建约束条件**：Wegscheider 恒等式构成了一组关于 $\\mathbf{y}$ 的线性约束。问题陈述中说“满足 $\\mathbf{N}\\,\\mathbf{c} = \\mathbf{0}$”，意味着 $\\mathbf{c}$ 在 $\\mathbf{N}$ 的零空间中。让我们精确一点。约束矩阵 $\\mathbf{A}$ 的行必须是 $\\mathbf{N}^\\top$ 的左零空间的一组基，这等价于 $\\mathbf{N}$ 的零空间。因此，我们找到 $\\mathbf{N}$ 的零空间的一组基，这些基向量构成了矩阵 $\\mathbf{A}$ 的行。约束条件可以紧凑地表示为：\n$$ \\mathbf{A} \\mathbf{y} = \\mathbf{0} $$\n如果 $\\mathbf{N}$ 的零空间是平凡的（只包含零向量），那么就没有循环，没有约束，矩阵 $\\mathbf{A}$ 的行数为零。\n\n$4$. **求解约束优化问题**：我们寻求找到向量 $\\mathbf{y}$，它在满足线性约束的条件下，最小化与实验向量 $\\mathbf{x}$ 的加权平方差之和。该优化问题是：\n$$ \\underset{\\mathbf{y}}{\\text{minimize}} \\quad (\\mathbf{y} - \\mathbf{x})^\\top \\mathbf{W} (\\mathbf{y} - \\mathbf{x}) \\quad \\text{subject to} \\quad \\mathbf{A} \\mathbf{y} = \\mathbf{0} $$\n在此，$\\mathbf{W}$ 是一个对角加权矩阵，其元素为 $W_{jj} = 1/\\sigma_j^2$，其中 $\\sigma_j$ 是给定的 $\\ln K_j$ 的标准差。被最小化的项是马氏距离的平方。这是一个标准的二次规划问题，其闭式解可通过拉格朗日乘数法导出：\n$$ \\mathbf{y} = \\mathbf{x} - \\mathbf{W}^{-1}\\mathbf{A}^\\top \\left( \\mathbf{A} \\mathbf{W}^{-1} \\mathbf{A}^\\top \\right)^{+} \\mathbf{A} \\mathbf{x} $$\n其中 $(\\cdot)^{+}$ 表示 Moore-Penrose 伪逆。伪逆确保了即使 $\\mathbf{A} \\mathbf{W}^{-1} \\mathbf{A}^\\top$ 在数值上是病态的或奇异的，也能得到一个稳定且唯一的解，尽管如果 $\\mathbf{A}$ 包含一组基，这种情况通常不会发生。请注意，$\\mathbf{W}^{-1}$ 是一个简单的对角矩阵，其元素为 $\\sigma_j^2$。如果 $\\mathbf{A}$ 没有行，则校正项消失，我们得到 $\\mathbf{y} = \\mathbf{x}$，这意味着报告值被当作调整值。\n\n$5$. **计算最终常数**：通过对解向量 $\\mathbf{y}$ 的元素取指数，可以得到基于压力的调整后平衡常数：\n$$ \\mathbf{K}_p^{\\mathrm{adj}} = \\exp(\\mathbf{y}) $$\n这些步骤将为所提供的 $4$ 个测试案例分别实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Solves for thermodynamically consistent equilibrium constants for several\n    reaction networks.\n    \"\"\"\n    R = 0.0831446261815324  # L·bar·mol−1·K−1\n\n    test_cases = [\n        # Case 1\n        (\n            [[-1, 0, 1], [1, -1, 0], [0, 1, -1]],  # N\n            ['Kp', 'Kp', 'Kp'],                   # Types\n            [2.0, 3.0, 0.2],                      # K_rep\n            700.0,                                # T\n            [0.05, 0.05, 0.05]                    # Sigmas\n        ),\n        # Case 2\n        (\n            [[-1, 0, -1], [2, -1, 1], [0, 1, 1]], # N\n            ['Kc', 'Kc', 'Kp'],                   # Types\n            [0.05, 4.0, 9.5],                     # K_rep\n            600.0,                                # T\n            [0.10, 0.05, 0.10]                    # Sigmas\n        ),\n        # Case 3\n        (\n            [[-1, 0], [1, 0], [0, -1], [0, 1]],   # N\n            ['Kp', 'Kc'],                         # Types\n            [10.0, 0.1],                          # K_rep\n            450.0,                                # T\n            [0.02, 0.02]                          # Sigmas\n        ),\n        # Case 4\n        (\n            [[-1, 0, -1, 2], [1, -1, 0, 0], [0, 1, 1, -2]], # N\n            ['Kp', 'Kp', 'Kp', 'Kp'],             # Types\n            [1.8, 0.5, 0.95, 1.0],                # K_rep\n            500.0,                                # T\n            [0.05, 0.05, 0.05, 0.05]              # Sigmas\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        N_list, types, K_rep_list, T, sigmas_list = case\n        \n        # Convert inputs to numpy arrays\n        N = np.array(N_list, dtype=np.float64)\n        K_rep = np.array(K_rep_list, dtype=np.float64)\n        sigmas = np.array(sigmas_list, dtype=np.float64)\n\n        # 1. Standardize Equilibrium Constants to Kp\n        delta_nu = N.sum(axis=0)\n        RT = R * T\n        \n        Kp_rep = np.zeros_like(K_rep)\n        for j, type in enumerate(types):\n            if type == 'Kc':\n                Kp_rep[j] = K_rep[j] * (RT ** delta_nu[j])\n            else: # type == 'Kp'\n                Kp_rep[j] = K_rep[j]\n\n        # 2. Logarithmic Transformation\n        x = np.log(Kp_rep)\n\n        # 3. Formulate Constraints\n        # The rows of A form a basis for the null space of N\n        # scipy.linalg.null_space returns columns that form an orthonormal basis\n        # for the null space. We transpose it to get the constraint matrix A.\n        null_space_basis = null_space(N)\n        A = null_space_basis.T\n        \n        # 4. Solve the Constrained Optimization Problem\n        if A.shape[0] == 0:  # No cycles, no constraints\n            y = x\n        else:\n            W_inv = np.diag(sigmas**2)\n            \n            # y = x - W^-1 * A^T * (A * W^-1 * A^T)^+ * A * x\n            M = A @ W_inv @ A.T\n            M_pinv = np.linalg.pinv(M)\n            \n            correction_term = W_inv @ A.T @ M_pinv @ A @ x\n            y = x - correction_term\n\n        # 5. Compute Final Constants\n        Kp_adj = np.exp(y)\n        results.append(Kp_adj.tolist())\n    \n    # Format the output string as specified, with no spaces\n    sub_results_str = []\n    for sub_list in results:\n        # Use a representation with sufficient precision\n        s = f\"[{','.join(f'{val:.15g}' for val in sub_list)}]\"\n        sub_results_str.append(s)\n    final_str = f\"[{','.join(sub_results_str)}]\"\n    print(final_str)\n\nsolve()\n```", "id": "2938522"}]}