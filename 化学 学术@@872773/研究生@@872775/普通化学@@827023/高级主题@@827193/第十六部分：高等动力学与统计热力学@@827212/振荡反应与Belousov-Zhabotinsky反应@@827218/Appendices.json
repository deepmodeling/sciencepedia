{"hands_on_practices": [{"introduction": "Belousov-Zhabotinsky (BZ) 反应的振荡特性取决于快速自催化步骤与抑制过程之间的精妙平衡。本练习 ([@problem_id:2949141]) 旨在通过计算关闭自催化所需的溴离子的临界浓度——即“溴化物阈值”，来深入探究这一核心机制。理解这个阈值是掌握化学系统如何在不同反应状态之间切换的基础，而这正是振荡现象的根源。", "problem": "在 Belousov–Zhabotinsky 反应（BZ 反应）的最小 Field–Noyes Oregonator 模型描述中，考虑在抑制剂溴离子 $Y \\equiv [Br^{-}]$ 存在下，自催化中间体亚溴酸 ($HBrO_{2}$)（记为 $X \\equiv [HBrO_{2}]$）的动力学。假设酸度恒定，且溴酸盐 $A \\equiv [BrO_{3}^{-}]$ 因大量过量而有效保持恒定。使用质量作用定律作为基本依据，对 $X$ 变化率的三个主要贡献进行建模，如下所示：\n\n- 自催化生成：$HBrO_{2} + BrO_{3}^{-} + H^{+} \\to 2\\,HBrO_{2}$，速率为 $k_{a}\\,A\\,X$。\n- 抑制性消耗：$HBrO_{2} + Br^{-} + H^{+} \\to \\text{产物}$，速率为 $k_{i}\\,X\\,Y$。\n- 终止反应：$2\\,HBrO_{2} \\to \\text{产物}$，速率为 $2\\,k_{t}\\,X^{2}$。\n\n此处，$k_{a}$、$k_{i}$ 和 $k_{t}$ 为正速率常数，$A$、$X$ 和 $Y$ 为浓度。在这些假设下，$X$ 的净变化率为\n$$\n\\frac{dX}{dt} \\;=\\; k_{a}\\,A\\,X \\;-\\; k_{i}\\,X\\,Y \\;-\\; 2\\,k_{t}\\,X^{2}.\n$$\n定义“溴离子阈值”$[Br^{-}]_{\\text{crit}}$ 为使得 $X$ 的无穷小扰动不因自催化而增长（即，自催化恰好被抑制）的最小抑制剂浓度。仅使用上述模型和质量作用定律，通过在 $X \\to 0^{+}$ 极限下对 $\\frac{dX}{dt}$ 施加适当条件并求解 $Y$，确定 $[Br^{-}]_{\\text{crit}}$ 的显式闭合形式表达式。\n\n将最终结果表示为包含 $k_{a}$、$k_{i}$ 和 $A$ 的解析表达式。以摩尔浓度报告 $[Br^{-}]_{\\text{crit}}$。无需进行数值近似或四舍五入。", "solution": "问题陈述经评估有效。这是一个具有科学依据、提法恰当且客观的化学动力学领域问题，具体涉及 Belousov-Zhabotinsky 反应简化模型的稳定性分析。\n\n自催化中间体浓度 $X \\equiv [HBrO_{2}]$ 的变化率由以下微分方程给出：\n$$\n\\frac{dX}{dt} = k_{a} A X - k_{i} X Y - 2 k_{t} X^{2}\n$$\n此处，$Y \\equiv [Br^{-}]$ 是抑制剂的浓度，$A \\equiv [BrO_{3}^{-}]$ 是一种大量过量的反应物的浓度，实际上是一个常数参数。各项分别对应自催化生成（$k_{a} A X$）、抑制性消耗（$k_{i} X Y$）和自终止（$-2 k_{t} X^{2}$）。所有速率常数 $k_{a}$、$k_{i}$ 和 $k_{t}$ 均为正值。\n\n目标是确定“溴离子阈值”，记为 $[Br^{-}]_{\\text{crit}}$。这被定义为使得 $X$ 的无穷小扰动不增长的最小抑制剂浓度 $Y$。这是一个关于系统在极低 $X$ 浓度下稳定性的问题，具体来说，是关于平庸稳态 $X = 0$ 的稳定性问题。\n\n$X$ 的无穷小扰动意味着我们在 $X=0$ 附近，即在 $X \\to 0^{+}$ 的极限下分析系统。这种扰动“不增长”的条件意味着，如果我们从一个非常小的正浓度 $X$ 开始，其浓度将不会增加。从数学上讲，这转化为净变化率 $\\frac{dX}{dt}$ 在 $X \\to 0^{+}$ 时必须小于或等于零的条件。\n$$\n\\frac{dX}{dt} \\le 0 \\quad \\text{for } X \\to 0^{+}\n$$\n为了分析小 $X$ 时 $\\frac{dX}{dt}$ 的行为，我们可以从速率方程中提出因子 $X$：\n$$\n\\frac{dX}{dt} = X (k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\n由于我们考虑的是一个小的正浓度 $X$（即 $X > 0$），$\\frac{dX}{dt}$ 的符号由括号中项的符号决定：\n$$\n(k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\n为了使不增长条件 $\\frac{dX}{dt} \\le 0$ 对 $X > 0$ 成立，我们必须有：\n$$\nk_{a} A - k_{i} Y - 2 k_{t} X \\le 0\n$$\n问题指定分析应针对*无穷小*扰动，这对应于 $X$ 从正方向趋近于零的极限（$X \\to 0^{+}$）。在此极限下，项 $2 k_{t} X$ 消失。因此，决定原点稳定性的不等式变为：\n$$\nk_{a} A - k_{i} Y \\le 0\n$$\n该不等式定义了对抑制剂浓度 $Y$ 的条件，该条件确保对于极小量的 $X$，自催化被抑制。对 $Y$ 进行整理，我们得到：\n$$\nk_{i} Y \\ge k_{a} A\n$$\n由于 $k_{i}$ 是一个正速率常数，我们可以用它相除而不改变不等式的方向：\n$$\nY \\ge \\frac{k_{a} A}{k_{i}}\n$$\n这个结果表明，对于任何大于或等于 $\\frac{k_{a} A}{k_{i}}$ 的溴离子浓度 $Y$，自催化过程在 $X=0$ 附近被抑制。问题要求的是“溴离子阈值”$[Br^{-}]_{\\text{crit}}$，即发生这种抑制的*最小*抑制剂浓度。这对应于不等式的边界情况，此时系统处于增长和衰减之间的临界点。我们通过将不等式设为等式来找到这个阈值：\n$$\nY_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\n回顾定义 $Y \\equiv [Br^{-}]$，溴离子阈值的最终表达式为：\n$$\n[Br^{-}]_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\n这个表达式代表了溴离子的临界浓度，在此浓度下，在 $HBrO_{2}$ 浓度为零的极限下，$HBrO_{2}$ 的自催化生成速率与其被溴离子消耗的速率完全平衡。低于此阈值，自催化占主导地位，$X$ 的小扰动将会增长。高于此阈值，抑制作用占主导地位，小扰动将会衰减。", "answer": "$$\n\\boxed{\\frac{k_{a} A}{k_{i}}}\n$$", "id": "2949141"}, {"introduction": "当一个系统的参数发生变化，导致其稳定的稳态变得不稳定时，化学振荡常常由此产生，这一现象被称为分岔。本问题 ([@problem_id:2949239]) 将引导您动手实践，运用强大的线性稳定性分析技术，判断一个简化动力学模型是否能通过霍普夫（Hopf）分岔产生振荡。通过分析雅可比矩阵及其特征值，您将对化学体系中持续振荡出现的精确数学条件有更深刻的理解。", "problem": "在普通化学中，一个最小化的双变量质量作用模型被用来解释在Belousov–Zhabotinsky（BZ）反应中观察到的振荡现象。考虑两种反应中间体的无量纲浓度$X(t)$和$Y(t)$，它们根据以下常微分方程（ODE）演化：\n$$\n\\frac{dX}{dt} \\;=\\; k_{1}\\,A\\,X \\;-\\; k_{2}\\,X\\,Y \\;-\\; k_{3}\\,X,\\qquad\n\\frac{dY}{dt} \\;=\\; k_{4}\\,X\\,Y \\;-\\; k_{5}\\,Y,\n$$\n其中$A0$是某进料物种的恒定浓度，$k_{i}0$（$i\\in\\{1,2,3,4,5\\}$）是速率常数。该函数形式符合质量作用定律，并且是用于表示Belousov–Zhabotinsky反应的Oregonator类型方案的一个简化模型。\n\n从化学动力学和动力系统的线性稳定性分析的基本定义出发，完成以下任务：\n\n1) 确定所有稳态 $(X^{\\ast},Y^{\\ast})$，并将其表示为参数的函数。\n\n2) 构建向量场的雅可比矩阵，在任意正稳态下对其求值，并推导出作为参数函数的迹和行列式。利用这些结果分析局部线性稳定性。\n\n3) 使用二维常微分方程的标准霍普夫分岔准则（即，在一对共轭特征值以非零速度穿过虚轴的参数值处，迹为零且行列式为正），确定当$k_{1}$变化而$A,k_{2},k_{3},k_{4},k_{5}$保持为正常数时，是否会发生霍普夫分岔。如果此族中不可能发生霍普夫分岔，请根据您推导出的表达式给出一个简要的理由。\n\n作为最终报告值，给出$k_{1}$的临界值$k_{1}^{\\dagger}$，在该值时正稳态首次存在（即，参数空间中分隔正稳态不存在与存在的边界）。用$A$和$k_{3}$将您的答案表示为一个闭式解析表达式。不需要进行数值近似或四舍五入。如果您希望解释物理单位，$k_{3}$的单位是$\\mathrm{s}^{-1}$，$A$的单位是$\\mathrm{M}$（摩尔浓度），因此$k_{1}^{\\dagger}$的单位将是$\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$；但是，仅报告$k_{1}^{\\dagger}$的解析表达式。", "solution": "该问题提出了一个自治常微分方程组，它代表了一个振荡化学反应的简化动力学模型。该系统由以下方程给出：\n$$\n\\frac{dX}{dt} = f(X,Y) = k_{1} A X - k_{2} X Y - k_{3} X\n$$\n$$\n\\frac{dY}{dt} = g(X,Y) = k_{4} X Y - k_{5} Y\n$$\n其中 $X(t)$ 和 $Y(t)$ 是中间体的浓度，所有参数 $A, k_1, k_2, k_3, k_4, k_5$ 均为正常数。\n\n在继续之前，对问题进行验证。已知条件是两个微分方程和对参数的正值约束。该问题具有科学依据，是Lotka-Volterra模型的一个变体，而Lotka-Volterra模型是化学动力学和种群动力学中的一个标准范式。它是一个适定问题，具有清晰且客观的数学任务。该问题是自洽的，没有矛盾或含糊之处。因此，该问题是有效的，我们可以继续进行求解。\n\n任务是求出稳态，分析正稳态的稳定性，研究霍普夫分岔的可能性，并确定正稳态存在时$k_1$的临界值。\n\n首先，我们通过将时间导数设为零来确定所有稳态 $(X^{\\ast}, Y^{\\ast})$：\n$$\n\\frac{dX}{dt} = 0 \\implies X (k_{1} A - k_{2} Y - k_{3}) = 0\n$$\n$$\n\\frac{dY}{dt} = 0 \\implies Y (k_{4} X - k_{5}) = 0\n$$\n从第二个方程，我们得到两种可能性：$Y=0$ 或 $k_4 X - k_5 = 0$。\n\n情况1：$Y=0$。\n将$Y=0$代入第一个方程得到$X(k_1 A - k_3) = 0$。这得出$X=0$。因此，我们找到了平凡稳态 $(X^{\\ast}, Y^{\\ast}) = (0, 0)$。这个稳态始终存在。\n\n情况2：$Y \\neq 0$。\n如果 $Y \\neq 0$，则第二个方程$Y(k_4 X - k_5) = 0$要求$k_4 X - k_5 = 0$，这给出$X^{\\ast} = \\frac{k_5}{k_4}$。\n由于我们考虑的是稳态可能具有$X \\neq 0$的情况，我们可以使用第一个方程$X(k_1 A - k_2 Y - k_3) = 0$来求解$Y$。当$X^{\\ast} \\neq 0$时，我们必须有$k_1 A - k_2 Y - k_3 = 0$。这得出$Y^{\\ast} = \\frac{k_1 A - k_3}{k_2}$。\n这给了我们第二个稳态 $(X^{\\ast}, Y^{\\ast}) = \\left(\\frac{k_5}{k_4}, \\frac{k_1 A - k_3}{k_2}\\right)$。为了使该状态具有物理意义，浓度必须为正，即$X^{\\ast} > 0$和$Y^{\\ast} > 0$。\n条件$X^{\\ast} = \\frac{k_5}{k_4} > 0$总是满足的，因为$k_4 > 0$且$k_5 > 0$。\n条件$Y^{\\ast} = \\frac{k_1 A - k_3}{k_2} > 0$要求$k_1 A - k_3 > 0$，因为$k_2 > 0$。这意味着$k_1 A > k_3$，或$k_1 > \\frac{k_3}{A}$。\n因此，存在两个稳态：平凡稳态 $(0,0)$ 和一个正（“共存”）稳态 $\\left(\\frac{k_5}{k_4}, \\frac{k_1 A - k_3}{k_2}\\right)$，后者仅在$k_1 > \\frac{k_3}{A}$时存在。\n\n其次，我们分析正稳态的局部线性稳定性。我们构建向量场 $(f(X,Y), g(X,Y))$ 的雅可比矩阵 $J$：\n$$\nJ(X,Y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial X}  \\frac{\\partial f}{\\partial Y} \\\\ \\frac{\\partial g}{\\partial X}  \\frac{\\partial g}{\\partial Y} \\end{pmatrix} = \\begin{pmatrix} k_1 A - k_2 Y - k_3  -k_2 X \\\\ k_4 Y  k_4 X - k_5 \\end{pmatrix}\n$$\n我们在正稳态 $(X^{\\ast}, Y^{\\ast}) = \\left(\\frac{k_5}{k_4}, \\frac{k_1 A - k_3}{k_2}\\right)$ 处对该矩阵求值。让我们将求值后的雅可比矩阵记为 $J^{\\ast}$。\n$J^{\\ast}$的分量是：\n$J^{\\ast}_{11} = k_1 A - k_2 Y^{\\ast} - k_3 = k_1 A - k_2 \\left(\\frac{k_1 A - k_3}{k_2}\\right) - k_3 = k_1 A - (k_1 A - k_3) - k_3 = 0$。\n$J^{\\ast}_{12} = -k_2 X^{\\ast} = -k_2 \\left(\\frac{k_5}{k_4}\\right) = -\\frac{k_2 k_5}{k_4}$。\n$J^{\\ast}_{21} = k_4 Y^{\\ast} = k_4 \\left(\\frac{k_1 A - k_3}{k_2}\\right) = \\frac{k_4 (k_1 A - k_3)}{k_2}$。\n$J^{\\ast}_{22} = k_4 X^{\\ast} - k_5 = k_4 \\left(\\frac{k_5}{k_4}\\right) - k_5 = k_5 - k_5 = 0$。\n因此，在正稳态下求值的雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} 0  -\\frac{k_2 k_5}{k_4} \\\\ \\frac{k_4(k_1 A - k_3)}{k_2}  0 \\end{pmatrix}\n$$\n$J^{\\ast}$的迹和行列式为：\n$\\mathrm{Tr}(J^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = 0 + 0 = 0$。\n$\\mathrm{Det}(J^{\\ast}) = J^{\\ast}_{11} J^{\\ast}_{22} - J^{\\ast}_{12} J^{\\ast}_{21} = (0)(0) - \\left(-\\frac{k_2 k_5}{k_4}\\right) \\left(\\frac{k_4(k_1 A - k_3)}{k_2}\\right) = k_5(k_1 A - k_3)$。\n为了分析稳定性，我们考察特征值$\\lambda$，它们满足特征方程$\\lambda^2 - \\mathrm{Tr}(J^{\\ast})\\lambda + \\mathrm{Det}(J^{\\ast}) = 0$。\n代入我们的结果：$\\lambda^2 + k_5(k_1 A - k_3) = 0$。\n特征值为 $\\lambda = \\pm\\sqrt{-k_5(k_1 A - k_3)}$。\n在正稳态存在的条件下，$k_1 A - k_3 > 0$，并且由于$k_5 > 0$，平方根的参数为负。因此，特征值是一对纯虚共轭对：\n$\\lambda = \\pm i \\sqrt{k_5(k_1 A - k_3)}$。\n由于特征值的实部为零，线性稳定性分析预测正稳态是一个中心点。系统在该点周围是中性稳定的。\n\n第三，我们研究当$k_1$变化时发生霍普夫分岔的可能性。二维系统中的霍普夫分岔发生在参数值$k_{1c}$处，此时一对复共轭特征值穿过虚轴。标准条件是：\n1. $\\mathrm{Tr}(J^{\\ast}(k_{1c})) = 0$。\n2. $\\mathrm{Det}(J^{\\ast}(k_{1c}))  0$。\n3. 横截性条件：$\\frac{d}{dk_1} \\mathrm{Re}(\\lambda)\\Big|_{k_1=k_{1c}} \\neq 0$，这等价于$\\frac{d}{dk_1} \\mathrm{Tr}(J^{\\ast})\\Big|_{k_1=k_{1c}} \\neq 0$。\n\n根据我们上面的分析，在正稳态存在的所​​有$k_1$值（即对于所有$k_1 > k_3/A$），雅可比矩阵的迹为$\\mathrm{Tr}(J^{\\ast}) = 0$。迹并非在某个特定的临界值处穿过零；它恒等于零。因此，它关于$k_1$的导数也为零：\n$$\n\\frac{d}{dk_1} \\mathrm{Tr}(J^{\\ast}) = \\frac{d}{dk_1}(0) = 0\n$$\n这违反了横截性条件（条件3）。特征值的实部固定为零，不会穿过虚轴。因此，描述从一个改变稳定性的不动点产生极限环的霍普夫分岔，当$k_1$变化时，在该系统中不可能发生。该模型是结构非泛型的，代表一个保守系统（一个Lotka-Volterra捕食者-被捕食者系统），它拥有一族周期轨道（一个中心点），而不是一个孤立的极限环。\n\n最后，我们确定正稳态首次存在时的临界值$k_{1}^{\\dagger}$。如前所述，正稳态由 $(X^{\\ast}, Y^{\\ast}) = \\left(\\frac{k_5}{k_4}, \\frac{k_1 A - k_3}{k_2}\\right)$ 给出。为了使该状态具有物理意义，两个浓度都必须为正。这要求$Y^{\\ast} > 0$，从而导致以下条件：\n$$\n\\frac{k_1 A - k_3}{k_2} > 0 \\implies k_1 A - k_3 > 0 \\implies k_1 > \\frac{k_3}{A}\n$$\n临界值 $k_1^{\\dagger}$ 是该参数区域的边界。它是正稳态出现时的$k_1$值，这发生在$Y^{\\ast} = 0$时。这对应于条件中的等式：\n$$\nk_1^{\\dagger} A - k_3 = 0\n$$\n求解$k_1^{\\dagger}$得到临界值。\n$$\nk_1^{\\dagger} = \\frac{k_3}{A}\n$$\n在此参数值下，发生跨临界分岔，正稳态分支与平凡稳态碰撞并发生稳定性交换。", "answer": "$$\n\\boxed{\\frac{k_3}{A}}\n$$", "id": "2949239"}, {"introduction": "BZ反应最引人注目的特征是其能够形成复杂的时空图案，如行波和螺旋。这项高级计算练习 ([@problem_id:2949245]) 要求您从零开始构建一个模拟程序，将反应动力学与扩散过程相结合，以模拟一个光敏BZ系统。您将学习如何利用光作为工具来“写入”和“擦除”化学波，从而在控制图案形成方面获得直接的实践经验，并架起从抽象微分方程到具体化学现象之间的桥梁。", "problem": "设计并实现一个完整的、可运行的程序，该程序形式化一个协议，用于在光敏 Belousov-Zhabotinsky (BZ) 反应中使用空间结构化光照来写入和擦除空间化学图案，并使用反应-扩散模型预测产生的波前。您的实现必须从质量守恒和反应-扩散输运的基本定律出发，为光敏 BZ 介质构建一个双变量最小模型。该程序必须在具有周期性边界的二维方形域上模拟动力学，并为一小组测试写入和擦除的光照协议计算指定的定量指标。\n\n该物理系统是一个可兴奋介质，具有一个激活剂和一个抑制剂，受反应动力学（源自简化为双变量最小形式的 Field-Körös-Noyes 机理）和扩散的支配。光照提供了一个局部的溴化物源，该源通过光化学作用抑制兴奋。使用无量纲的变量和参数，因此不需要进行物理单位转换；所有结果均以纯数报告。假设二维域为方形，其边长由整数网格表示。\n\n您的程序必须执行以下操作。\n\n- 通过两个标量场表示化学状态，即激活剂 $u(x,y,t)$ 和抑制剂/催化剂 $v(x,y,t)$，它们在源于质量作用动力学且与光敏 BZ 反应的 Oregonator 简化模型一致的反应项，以及具有恒定扩散系数的扩散项 $\\nabla^2 u$ 和 $\\nabla^2 v$ 的作用下演化。光照由一个非负标量场 $\\phi(x,y,t)$ 表示，它增加了有效的局部溴化物源，从而抑制兴奋。\n- 使用大小为 $N \\times N$（其中 $N = 64$）的方形网格，空间步长 $\\Delta x = 1$，并采用周期性边界条件。使用显式时间步进方案，时间步长 $\\Delta t = 0.02$。\n- 使用以下无量纲动力学和输运参数，这些参数使介质在低光照下处于可兴奋状态，在高光照下处于不可兴奋状态：$\\varepsilon = 0.20$，$f = 1.40$，$q = 0.002$，$D_u = 0.20$ 和 $D_v = 0.10$。\n- 将场初始化为与存在光照 $\\phi$ 时的动力学一致的空间均匀稳态，然后通过将小圆盘内的 $u$ 设置为一个高值来叠加一个局部“种子”兴奋，以触发波的发射。您可以在应用种子之前通过设置 $u = q$ 和 $v = q$ 来近似均匀稳态。\n- 实现以下三个光照协议（这些是测试套件）。在每种情况下，种子都是一个半径为 $r\\_0 = 3$ 的圆盘，中心位于域中心 $(x\\_0,y\\_0) = (N/2,N/2)$，圆盘内的初始激活剂值为 $u = 0.90$，其他地方不变。每种情况都使用相同的 $\\Delta t$ 和 $\\Delta x$。总模拟步数和光照图案是特定于情况的，详见下文。\n\n测试套件：\n\n- 情况 A（写入受限条带引导的波并估计轴向波前速度）：\n  - 光照图案：在 $x = N/2$ 处居中、宽度为 $w = 6$ 个网格点的垂直“暗”条带，其中 $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$，嵌入在 $\\phi = \\phi\\_{\\mathrm{bright}} = 0.070$ 的“亮”背景中。\n  - 总模拟步数：$T\\_{\\mathrm{A}} = 400$。\n  - 指标：按如下方式估计沿条带中心线列 $x = N/2$ 的轴向波前速度。设 $\\theta\\_u = 0.30$ 为波前阈值。对于每个时间 $t\\_k = k \\,\\Delta t$，其中 $k \\in \\{k\\_1,\\dots,k\\_2\\}$，$t\\_{1} = 2.00$，$t\\_{2} = 8.00$（因此 $k\\_1 = 100$，$k\\_2 = 400$），计算从中心线行 $y\\_0 = N/2$ 到中心列上满足 $u(N/2,y,t\\_k) > \\theta\\_u$ 的任意行 $y$ 的最大轴向距离。在指定时间间隔内，对该最大距离与时间进行最小二乘线性拟合，并报告拟合的斜率作为速度（一个浮点数）。\n- 情况 B（通过全局增亮进行擦除并报告淬灭成功与否）：\n  - 光照图案：在时间 $t  t\\_{\\mathrm{switch}}$ 时为均匀“暗”光照 $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$，在时间 $t \\ge t\\_{\\mathrm{switch}}$ 时为均匀“亮”光照 $\\phi = \\phi\\_{\\mathrm{erase}} = 0.080$，其中 $t\\_{\\mathrm{switch}} = 4.00$。\n  - 总模拟步数：$T\\_{\\mathrm{B}} = 600$。\n  - 指标：在最终时刻，计算激活剂场的空间平均值 $\\overline{u}$，并报告一个布尔值，指示是否满足 $\\overline{u}  \\theta\\_{\\mathrm{erase}}$，其中 $\\theta\\_{\\mathrm{erase}} = 0.10$。\n- 情况 C（边界情况：均匀明亮，无传播）：\n  - 光照图案：在所有时间均为均匀“亮”光照 $\\phi = \\phi\\_{\\mathrm{bright}} = 0.080$。\n  - 总模拟步数：$T\\_{\\mathrm{C}} = 200$。\n  - 指标：在最终时刻，计算 $u > \\theta\\_u$ 的网格点数量，并将此计数报告为一个整数。\n\n计算要求和检查：\n\n- 对拉普拉斯算子使用五点模板，并采用周期性边界。确保显式时间步长满足标准扩散稳定性判据 $\\Delta t  \\Delta x^2/(4 \\max\\{D_u,D_v\\})$；给定值满足此界限。\n- 所有变量和参数都是无量纲的；因此不需要物理单位转换或单位报告。\n- 您的程序应生成单行输出，其中包含结果，格式为方括号内的逗号分隔列表，顺序为 [情况 A 的速度（浮点数），情况 B 的布尔值，情况 C 的整数]。例如，一个有效的输出形状是 $[\\text{float},\\text{boolean},\\text{integer}]$，不含空格。\n\n您的实现必须是一个完整的、自包含的程序，不需要外部输入。它必须为三种情况构建光照场，模拟动力学，计算三个指标，并以确切指定的格式打印聚合结果。", "solution": "该问题要求设计并实现一个对二维域上的光敏 Belousov-Zhabotinsky (BZ) 反应进行的数值模拟。该问题在科学上是适定的，为完整解决方案提供了所有必要的参数和规范。任务的核心是求解一个反应-扩散偏微分方程组 (PDEs)，并为三种不同的光照协议计算指定的指标。\n\n**1. 数学模型**\n\n该系统由两个状态变量描述：激活剂浓度 $u(x,y,t)$ 和抑制剂浓度 $v(x,y,t)$。它们的演化受双变量 Oregonator 模型控制，这是完整的 Field-Körös-Noyes (FKN) 机理的简化形式，并经过修改以包含光敏性。控制该系统的偏微分方程组是：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{1}{\\varepsilon} \\left( u(1-u) - fv \\frac{u-q}{u+q} \\right) + D_u \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} = u - v + \\phi(x,y,t) + D_v \\nabla^2 v\n$$\n在这里，$u$ 是激活剂（类似于 $\\mathrm{HBrO_2}$），$v$ 是抑制剂（与氧化态的催化剂 $\\mathrm{ferriin}$ 相关）。参数 $\\varepsilon$、$f$ 和 $q$ 是决定局部动力学的动力学常数。项 $D_u \\nabla^2 u$ 和 $D_v \\nabla^2 v$ 代表具有恒定扩散系数 $D_u$ 和 $D_v$ 的 Fickian 扩散。标量场 $\\phi(x,y,t)$ 表示空间和时间上结构化的光照，它通过光化学作用产生溴离子（一种抑制剂），因此在抑制剂方程中充当源项并抑制波的激发。所有变量和参数都是无量纲的。\n\n给定的参数是：\n- 动力学参数：$\\varepsilon = 0.20$，$f = 1.40$，$q = 0.002$。\n- 扩散系数：$D_u = 0.20$，$D_v = 0.10$。\n\n**2. 数值离散化**\n\n连续的偏微分方程在方形网格上进行离散化，并随时间进行积分。\n\n- **空间离散化**：连续域被一个 $N \\times N$ 的网格所替代，其中 $N = 64$，空间步长 $\\Delta x = 1$。拉普拉斯算子 $\\nabla^2$ 使用二阶、五点有限差分模板进行近似：\n$$\n(\\nabla^2 \\psi)_{i,j} \\approx \\frac{\\psi_{i,j+1} + \\psi_{i,j-1} + \\psi_{i+1,j} + \\psi_{i-1,j} - 4\\psi_{i,j}}{(\\Delta x)^2}\n$$\n其中 $\\psi$ 可以是 $u$ 或 $v$，$(i,j)$ 是网格索引。应用周期性边界条件，意味着索引按模 $N$ 处理。\n\n- **时间离散化**：使用显式前向欧拉方法进行时间积分，时间步长为 $\\Delta t = 0.02$。时间步 $k+1$ 的状态变量由其在步 $k$ 的值计算如下：\n$$\nu^{k+1}_{i,j} = u^k_{i,j} + \\Delta t \\left[ \\frac{1}{\\varepsilon} \\left( u^k_{i,j}(1-u^k_{i,j}) - fv^k_{i,j} \\frac{u^k_{i,j}-q}{u^k_{i,j}+q} \\right) + D_u (\\nabla^2 u)^k_{i,j} \\right]\n$$\n$$\nv^{k+1}_{i,j} = v^k_{i,j} + \\Delta t \\left[ u^k_{i,j} - v^k_{i,j} + \\phi^k_{i,j} + D_v (\\nabla^2 v)^k_{i,j} \\right]\n$$\n所选的时间步长 $\\Delta t = 0.02$ 满足扩散部分的 Courant-Friedrichs-Lewy (CFL) 稳定性条件，$\\Delta t  (\\Delta x)^2 / (4 \\max\\{D_u, D_v\\})$，因为 $0.02  1^2 / (4 \\times 0.20) = 1.25$。\n\n**3. 测试用例的实现**\n\n对于所有情况，模拟都从一个近似的均匀稳态 $u=q$ 和 $v=q$ 开始。然后通过施加一个种子来引发一个波：在一个中心半径为 $r_0=3$ 的圆盘内，激活剂被设置为 $u=0.90$。\n\n- **情况 A：写入并测量速度**\n  - **光照**：一个低光照（$\\phi_{\\mathrm{dark}} = 0.005$）的垂直通道，宽度为 $w=6$，被“写入”到一个高抑制性光照（$\\phi_{\\mathrm{bright}} = 0.070$）的背景中。\n  - **模拟**：系统演化 $T_A = 400$ 步（每步 $\\Delta t=0.02$）。\n  - **指标**：估计波前沿通道中心线（$x=N/2$）的轴向速度。对于从 $k_1=100$（$t=2.0$）到 $k_2=400$（$t=8.0$）的每个时间步 $k$，我们找到从域中心沿 $y$ 轴到 $u > \\theta_u=0.30$ 的点的最大距离。通过对这些距离与时间进行最小二乘线性拟合，得到波速作为直线的斜率。\n\n- **情况 B：擦除并测试淬灭**\n  - **光照**：域开始时具有均匀的低光照（$\\phi_{\\mathrm{dark}} = 0.005$），允许波从种子向外传播。在时间 $t_{\\mathrm{switch}} = 4.0$（步 $k=200$），光照全局切换到一个高的“擦除”值（$\\phi_{\\mathrm{erase}} = 0.080$）。\n  - **模拟**：系统总共演化 $T_B = 600$ 步。\n  - **指标**：在最终时刻评估淬灭成功与否。如果激活剂的空间平均值 $\\overline{u}$ 低于阈值 $\\theta_{\\mathrm{erase}} = 0.10$，则淬灭成功（返回 `True`），否则失败（返回 `False`）。\n\n- **情况 C：边界情况（无传播）**\n  - **光照**：在整个模拟过程中，域都受到均匀的高光照（$\\phi_{\\mathrm{bright}} = 0.080$）。预计这种光照水平会抑制来自初始种子的任何波传播。\n  - **模拟**：系统演化 $T_C = 200$ 步。\n  - **指标**：在最终时刻，我们计算激活剂浓度 $u$ 保持在阈值 $\\theta_u = 0.30$ 以上的网格点数。这衡量了初始兴奋被淬灭的程度。\n\n实现将此逻辑封装到一个单一程序中，该程序运行所有三种情况，并以指定的格式报告计算出的指标。实现的核心是反应-扩散系统的数值求解器，然后在每个测试用例的特定条件下应用该求解器。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a photosensitive Belousov-Zhabotinsky (BZ) reaction\n    under three different illumination protocols and computes specified metrics.\n    \"\"\"\n    \n    # --- Global Parameters ---\n    N = 64\n    DX = 1.0\n    DT = 0.02\n    \n    # Kinetic and transport parameters\n    EPS = 0.20\n    F = 1.40\n    Q = 0.002\n    DU = 0.20\n    DV = 0.10\n\n    # Initial condition parameters\n    R0 = 3\n    U_SEED = 0.90\n    CENTER_X, CENTER_Y = N // 2, N // 2\n\n    # --- Helper Functions ---\n\n    def get_initial_state():\n        \"\"\"Initializes the activator (u) and inhibitor (v) fields.\"\"\"\n        u = np.full((N, N), Q, dtype=np.float64)\n        v = np.full((N, N), Q, dtype=np.float64)\n        \n        y_coords, x_coords = np.mgrid[0:N, 0:N]\n        dist_sq = (x_coords - CENTER_X)**2 + (y_coords - CENTER_Y)**2\n        seed_mask = dist_sq  R0**2\n        u[seed_mask] = U_SEED\n        \n        return u, v\n\n    def compute_laplacian(field):\n        \"\"\"Computes the 2D Laplacian with periodic boundary conditions.\"\"\"\n        return (np.roll(field, 1, axis=0) + np.roll(field, -1, axis=0) +\n                np.roll(field, 1, axis=1) + np.roll(field, -1, axis=1) - 4 * field) / (DX**2)\n\n    def integration_step(u, v, phi):\n        \"\"\"Performs one forward Euler step.\"\"\"\n        lap_u = compute_laplacian(u)\n        lap_v = compute_laplacian(v)\n\n        reaction_u = (1 / EPS) * (u * (1 - u) - F * v * (u - Q) / (u + Q))\n        reaction_v = u - v\n\n        u_new = u + DT * (reaction_u + DU * lap_u)\n        v_new = v + DT * (reaction_v + phi + DV * lap_v)\n        \n        return u_new, v_new\n\n    # --- Test Case Implementations ---\n\n    def run_case_a():\n        \"\"\"Case A: Write a confined stripe-guided wave and estimate axial front speed.\"\"\"\n        \n        # Parameters\n        T_STEPS = 400\n        PHI_DARK = 0.005\n        PHI_BRIGHT = 0.070\n        W = 6.0\n        THETA_U = 0.30\n        K1 = int(2.00 / DT)\n        K2 = int(8.00 / DT)\n        \n        # Setup illumination field\n        _, x_coords = np.mgrid[0:N, 0:N]\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n        stripe_mask = np.abs(x_coords - CENTER_X)  W / 2\n        phi[stripe_mask] = PHI_DARK\n\n        # Setup simulation\n        u, v = get_initial_state()\n        times, distances = [], []\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            u, v = integration_step(u, v, phi)\n            \n            if k >= K1 and k = K2:\n                center_col_u = u[:, CENTER_X]\n                above_threshold_rows = np.where(center_col_u > THETA_U)[0]\n                \n                if above_threshold_rows.size > 0:\n                    max_dist = np.max(np.abs(above_threshold_rows - CENTER_Y)) * DX\n                else:\n                    max_dist = 0.0\n                \n                times.append(k * DT)\n                distances.append(max_dist)\n        \n        # Calculate metric\n        if not times or len(times)  2:\n            return 0.0\n\n        p = np.polyfit(times, distances, 1)\n        speed = p[0]\n        \n        return float(speed)\n\n    def run_case_b():\n        \"\"\"Case B: Erase by global brightening and report quenching success.\"\"\"\n\n        # Parameters\n        T_STEPS = 600\n        T_SWITCH = 4.00\n        K_SWITCH = int(T_SWITCH / DT)\n        PHI_DARK = 0.005\n        PHI_ERASE = 0.080\n        THETA_ERASE = 0.10\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            if k * DT  T_SWITCH:\n                phi_val = PHI_DARK\n            else:\n                phi_val = PHI_ERASE\n            phi = np.full((N, N), phi_val, dtype=np.float64)\n            u, v = integration_step(u, v, phi)\n        \n        # Calculate metric\n        mean_u = np.mean(u)\n        \n        return bool(mean_u  THETA_ERASE)\n\n    def run_case_c():\n        \"\"\"Case C: Uniformly bright, no propagation.\"\"\"\n        \n        # Parameters\n        T_STEPS = 200\n        PHI_BRIGHT = 0.080\n        THETA_U = 0.30\n        \n        # Setup illumination\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for _ in range(T_STEPS):\n            u, v = integration_step(u, v, phi)\n            \n        # Calculate metric\n        count = np.sum(u > THETA_U)\n        \n        return int(count)\n\n    # --- Main Execution ---\n    results = [\n        run_case_a(),\n        run_case_b(),\n        run_case_c()\n    ]\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nsolve()\n\n```", "id": "2949245"}]}