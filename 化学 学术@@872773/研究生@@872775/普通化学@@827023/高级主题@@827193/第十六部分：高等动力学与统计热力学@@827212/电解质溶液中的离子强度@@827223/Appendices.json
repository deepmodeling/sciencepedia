{"hands_on_practices": [{"introduction": "掌握离子强度的第一步是能够准确计算它。本练习将引导你处理一个包含多种电解质的混合溶液，这是实际化学体系中常见的情况。通过从基本定义出发，你不仅将练习计算技能，还将深入理解不同价态的离子对整体离子环境的贡献有何不同。[@problem_id:2942689]", "problem": "一个处于热平衡状态的水溶液包含三种完全电离的强电解质：氯化钠 ($\\text{NaCl}$)、氯化钙 ($\\text{CaCl}_{2}$) 和硫酸钠 ($\\text{Na}_{2}\\text{SO}_{4}$)。这些盐的分析摩尔浓度分别为：$\\text{NaCl}$ 为 $0.02000~\\text{mol}\\,\\text{L}^{-1}$，$\\text{CaCl}_{2}$ 为 $0.005000~\\text{mol}\\,\\text{L}^{-1}$，$\\text{Na}_{2}\\text{SO}_{4}$ 为 $0.01000~\\text{mol}\\,\\text{L}^{-1}$。假设完全电离、理想行为，且无离子对形成或络合物形成。\n\n仅从电解质溶液中离子强度的公认定义和标准电离化学计量出发，推导该混合物离子强度 $I$ 关于单个离子浓度和电荷的显式表达式，并对给定溶液进行数值计算。然后，利用你的推导解释为什么二价离子的贡献与一价离子相比不成比例，即使其分析浓度较低。\n\n将你的最终数值 $I$ 四舍五入至四位有效数字，并以 $\\text{mol}\\,\\text{L}^{-1}$ 为单位表示。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件：\n- 一个处于热平衡状态的水溶液。\n- 三种完全电离的强电解质：氯化钠 ($\\text{NaCl}$)、氯化钙 ($\\text{CaCl}_{2}$) 和硫酸钠 ($\\text{Na}_{2}\\text{SO}_{4}$)。\n- $\\text{NaCl}$ 的分析摩尔浓度为 $0.02000~\\text{mol}\\,\\text{L}^{-1}$。\n- $\\text{CaCl}_{2}$ 的分析摩尔浓度为 $0.005000~\\text{mol}\\,\\text{L}^{-1}$。\n- $\\text{Na}_{2}\\text{SO}_{4}$ 的分析摩尔浓度为 $0.01000~\\text{mol}\\,\\text{L}^{-1}$。\n- 假设：完全电离、理想行为，无离子对形成或络合物形成。\n- 任务：\n    1.  推导离子强度 $I$ 的显式表达式。\n    2.  对 $I$ 进行数值计算。\n    3.  解释二价离子的不成比例贡献。\n- 四舍五入：将 $I$ 的最终数值保留四位有效数字。\n\n验证评估：\n该问题具有科学依据，涉及物理化学中的标准课题——电解质溶液中离子强度这一基本概念。问题提法得当，为进行唯一且明确的计算提供了所有必要的浓度和明确的标准假设（完全电离）。语言客观而精确。问题不含科学谬误、矛盾或歧义。这是一个学术背景下的标准可解问题。\n\n结论：问题有效。我们开始解答。\n\n溶液的离子强度 $I$ 是衡量离子总浓度的指标。它由以下表达式定义，该表达式考虑了溶液中每种离子种类 $i$ 的浓度 $c_i$ 和电荷数 $z_i$：\n$$I = \\frac{1}{2} \\sum_{i} c_i z_i^2$$\n题目指出，三种盐 $\\text{NaCl}$、$\\text{CaCl}_{2}$ 和 $\\text{Na}_{2}\\text{SO}_{4}$ 在水溶液中完全电离。我们必须首先写出化学计量电离反应，以确定每种离子的浓度。\n电离反应如下：\n$$ \\text{NaCl}(s) \\rightarrow \\text{Na}^{+}(aq) + \\text{Cl}^{-}(aq) $$\n$$ \\text{CaCl}_{2}(s) \\rightarrow \\text{Ca}^{2+}(aq) + 2\\text{Cl}^{-}(aq) $$\n$$ \\text{Na}_{2}\\text{SO}_{4}(s) \\rightarrow 2\\text{Na}^{+}(aq) + \\text{SO}_{4}^{2-}(aq) $$\n根据给定的盐的分析浓度，并假设完全电离，可以计算出各种离子的摩尔浓度。注意，$\\text{Na}^{+}$ 和 $\\text{Cl}^{-}$ 离子都来自不止一个源头。\n令 $c(\\text{salt})$ 表示给定盐的分析浓度。离子浓度（用方括号表示）为：\n$$ [\\text{Na}^{+}] = c_{\\text{Na}^{+}} = c(\\text{NaCl}) + 2 \\cdot c(\\text{Na}_{2}\\text{SO}_{4}) $$\n$$ [\\text{Ca}^{2+}] = c_{\\text{Ca}^{2+}} = c(\\text{CaCl}_{2}) $$\n$$ [\\text{Cl}^{-}] = c_{\\text{Cl}^{-}} = c(\\text{NaCl}) + 2 \\cdot c(\\text{CaCl}_{2}) $$\n$$ [\\text{SO}_{4}^{2-}] = c_{\\text{SO}_{4}^{2-}} = c(\\text{Na}_{2}\\text{SO}_{4}) $$\n这些离子的电荷数（$z_i$）为：$z_{\\text{Na}^{+}} = +1$，$z_{\\text{Ca}^{2+}} = +2$，$z_{\\text{Cl}^{-}} = -1$ 和 $z_{\\text{SO}_{4}^{2-}} = -2$。\n\n将所有四种离子种类的浓度和电荷代入 $I$ 的定义中，即可得到此特定混合物离子强度 $I$ 的显式表达式：\n$$ I = \\frac{1}{2} \\left( c_{\\text{Na}^{+}} z_{\\text{Na}^{+}}^2 + c_{\\text{Ca}^{2+}} z_{\\text{Ca}^{2+}}^2 + c_{\\text{Cl}^{-}} z_{\\text{Cl}^{-}}^2 + c_{\\text{SO}_{4}^{2-}} z_{\\text{SO}_{4}^{2-}}^2 \\right) $$\n将离子浓度的表达式用初始盐浓度代入，得到：\n$$ I = \\frac{1}{2} \\left( (c(\\text{NaCl}) + 2c(\\text{Na}_{2}\\text{SO}_{4}))(+1)^2 + (c(\\text{CaCl}_{2}))(+2)^2 + (c(\\text{NaCl}) + 2c(\\text{CaCl}_{2}))(-1)^2 + (c(\\text{Na}_{2}\\text{SO}_{4}))(-2)^2 \\right) $$\n这就是推导出的 $I$ 的显式表达式。\n\n现在，我们对此表达式进行数值计算。首先，我们计算每种离子的浓度：\n$$ c_{\\text{Na}^{+}} = 0.02000~\\text{mol}\\,\\text{L}^{-1} + 2 \\cdot (0.01000~\\text{mol}\\,\\text{L}^{-1}) = 0.04000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{Ca}^{2+}} = 0.005000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{Cl}^{-}} = 0.02000~\\text{mol}\\,\\text{L}^{-1} + 2 \\cdot (0.005000~\\text{mol}\\,\\text{L}^{-1}) = 0.03000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{SO}_{4}^{2-}} = 0.01000~\\text{mol}\\,\\text{L}^{-1} $$\n现在我们将这些浓度和相应的电荷代入离子强度公式中：\n$$ I = \\frac{1}{2} \\left[ (0.04000)(+1)^2 + (0.005000)(+2)^2 + (0.03000)(-1)^2 + (0.01000)(-2)^2 \\right] $$\n为了计算过程清晰，中间步骤省略了 $\\text{mol}\\,\\text{L}^{-1}$ 单位。\n$$ I = \\frac{1}{2} \\left[ 0.04000 \\cdot 1 + 0.005000 \\cdot 4 + 0.03000 \\cdot 1 + 0.01000 \\cdot 4 \\right] $$\n$$ I = \\frac{1}{2} \\left[ 0.04000 + 0.02000 + 0.03000 + 0.04000 \\right] $$\n$$ I = \\frac{1}{2} \\left[ 0.13000 \\right] $$\n$$ I = 0.065000~\\text{mol}\\,\\text{L}^{-1} $$\n题目要求最终答案保留四位有效数字。计算值 $0.065000$ 有五位有效数字。四舍五入到四位有效数字得到 $0.06500$。\n\n问题的最后一部分要求解释二价离子对离子强度的不成比例贡献。这是 $I$ 定义的数学形式的直接结果。公式中任何给定离子 $i$ 对总和的贡献是 $c_i z_i^2$。电荷数 $z_i$ 是平方的。\n对于一价离子（$z_i = \\pm 1$），其对总和的贡献是 $c_i (\\pm 1)^2 = c_i$。\n对于二价离子（$z_i = \\pm 2$），其对总和的贡献是 $c_i (\\pm 2)^2 = 4c_i$。\n因此，以摩尔为单位来看，一个二价离子对离子强度的贡献是一个一价离子的四倍。\n在我们的具体案例中：\n- 一价离子（$\\text{Na}^{+}$、$\\text{Cl}^{-}$）的总浓度为 $0.04000 + 0.03000 = 0.07000~\\text{mol}\\,\\text{L}^{-1}$。它们对总和 $\\sum c_i z_i^2$ 的贡献是 $0.04000 \\cdot 1^2 + 0.03000 \\cdot (-1)^2 = 0.07000$。\n- 二价离子（$\\text{Ca}^{2+}$、$\\text{SO}_{4}^{2-}$）的总浓度为 $0.005000 + 0.01000 = 0.01500~\\text{mol}\\,\\text{L}^{-1}$。它们对总和的贡献是 $0.005000 \\cdot 2^2 + 0.01000 \\cdot (-2)^2 = 0.02000 + 0.04000 = 0.06000$。\n尽管二价离子的总浓度（$0.01500~\\text{mol}\\,\\text{L}^{-1}$）不到一价离子总浓度（$0.07000~\\text{mol}\\,\\text{L}^{-1}$）的四分之一，但它们对离子强度总和的贡献（$0.06000$）几乎与一价离子的贡献（$0.07000$）一样大。这明确地证明了高电荷离子具有不成比例的巨大影响，这源于离子强度对离子电荷的平方依赖关系。", "answer": "$$\n\\boxed{0.06500}\n$$", "id": "2942689"}, {"introduction": "计算出离子强度后，下一步是应用它来预测和解释化学现象。本练习探讨了离子强度对化学平衡的一个经典影响——“盐效应”，即在惰性电解质存在下，微溶盐的溶解度会发生变化。通过推导并计算，你将量化地看到忽略离子强度和活度校正会如何导致对溶解度的显著预测偏差。[@problem_id:2942651]", "problem": "一种微溶盐溶解成离子，会贡献于溶液的离子强度，并受到活度效应的影响，而活度效应又会反过来影响其溶解度。从水溶液中溶质的化学势和活度的定义（以摩尔浓度为标准态）出发，推导一个 $2:2$ 型电解质的基于浓度的溶解度如何通过离子活度系数与热力学溶度积和离子强度相关联。使用以下基本关系：(i) 平衡要求以活度表示的反应吉布斯能为零，(ii) 溶度积以活度定义，(iii) 在摩尔浓度标准态下，溶质的活度是活度系数与浓度的乘积，(iv) 离子强度定义为 $I = \\tfrac{1}{2}\\sum_{i} c_{i} z_{i}^{2}$，以及 (v) 稀电解质溶液中的离子活度系数由 Debye–Hückel 理论描述。在从这些基础推导并证明之前，不要对中间结果做任何特定形式的假设。\n\n然后将您的推导应用于以下具体体系，以量化忽略离子强度效应所造成的误差的大小和方向。\n\n考虑硫酸钡在 $298\\ \\mathrm{K}$ 的水中溶解：$\\mathrm{BaSO_{4}(s)} \\rightleftharpoons \\mathrm{Ba^{2+}} + \\mathrm{SO_{4}^{2-}}$。设此温度下的热力学溶度积为 $K_{\\mathrm{sp}} = 1.10 \\times 10^{-10}$（以活度定义，标准态为 $1\\ \\mathrm{mol\\ L^{-1}}$）。假设存在一种惰性背景电解质 $\\mathrm{NaNO_{3}}$，其体相浓度为 $0.100\\ \\mathrm{mol\\ L^{-1}}$，它不与目标离子形成络合物，并且完全解离。设 $298\\ \\mathrm{K}$ 时水的 Debye–Hückel 常数 $A = 0.509$。假设 Davies 方程适用于估算在该介质离子强度下 $\\mathrm{Ba^{2+}}$ 和 $\\mathrm{SO_{4}^{2-}}$ 的单个离子活度系数。您可以假设溶解的 $\\mathrm{BaSO_{4}}$ 对离子强度的贡献与背景电解质相比可以忽略不计，但您必须对该近似进行定量证明。\n\n计算在 $298\\ \\mathrm{K}$、浓度为 $0.100\\ \\mathrm{mol\\ L^{-1}}$ 的 $\\mathrm{NaNO_{3}}$ 介质中，忽略离子强度（即将所有离子活度系数设为 $1$）的理想模型对 $\\mathrm{BaSO_{4}}$ 真实摩尔溶解度的低估或高估因子。将此因子表示为一个纯数（无量纲），并将最终答案四舍五入到四位有效数字。", "solution": "所提出的问题在科学上是有效的、表述清晰且客观的。它包含足够的信息，并基于既定的化学热力学原理。我们将继续进行推导和后续计算。\n\n首先，我们推导一种微溶的 $2:2$ 型电解质（记作 $MX$）的摩尔溶解度、热力学溶度积和离子活度系数之间的一般关系。溶解平衡为：\n$$MX(s) \\rightleftharpoons M^{2+}(aq) + X^{2-}(aq)$$\n根据所提供的基本原理，在平衡状态下，反应的吉布斯自由能变化 $\\Delta_r G$ 为零。吉布斯能的变化用所涉及物质的化学势 $\\mu_i$ 表示：\n$$\\Delta_r G = \\mu_{M^{2+}} + \\mu_{X^{2-}} - \\mu_{MX(s)} = 0$$\n纯固体的化学势是其标准化学势，$\\mu_{MX(s)} = \\mu_{MX(s)}^{\\circ}$。对于溶液中的离子 $i$，其化学势由 $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$ 给出，其中 $\\mu_i^{\\circ}$ 是标准化学势，$R$ 是气体常数，$T$ 是绝对温度，$a_i$ 是离子的活度。将这些表达式代入平衡条件，得到：\n$$(\\mu_{M^{2+}}^{\\circ} + RT \\ln a_{M^{2+}}) + (\\mu_{X^{2-}}^{\\circ} + RT \\ln a_{X^{2-}}) - \\mu_{MX(s)}^{\\circ} = 0$$\n重新排列此方程，分离标准项和非标准项：\n$$\\mu_{M^{2+}}^{\\circ} + \\mu_{X^{2-}}^{\\circ} - \\mu_{MX(s)}^{\\circ} = -RT(\\ln a_{M^{2+}} + \\ln a_{X^{2-}}) = -RT \\ln(a_{M^{2+}} a_{X^{2-}})$$\n方程的左边是标准反应吉布斯自由能 $\\Delta_r G^{\\circ}$。此反应的热力学平衡常数，即溶度积 $K_{\\mathrm{sp}}$，与 $\\Delta_r G^{\\circ}$ 的关系为 $\\Delta_r G^{\\circ} = -RT \\ln K_{\\mathrm{sp}}$。因此，我们确立了以活度表示的热力学溶度积的定义：\n$$K_{\\mathrm{sp}} = a_{M^{2+}} a_{X^{2-}}$$\n溶质的活度 $a_i$ 与其摩尔浓度 $c_i$ 和离子活度系数 $\\gamma_i$ 的关系为 $a_i = \\gamma_i (c_i/c^{\\circ})$，其中 $c^{\\circ}$ 是标准态浓度，指定为 $1\\ \\mathrm{mol\\ L^{-1}}$。设盐 $MX$ 的摩尔溶解度为 $S$。在一个仅由 $MX$ 溶解提供 $M^{2+}$ 和 $X^{2-}$ 离子的溶液中，它们的浓度为 $c_{M^{2+}} = S$ 和 $c_{X^{2-}} = S$。将这些代入 $K_{\\mathrm{sp}}$ 的表达式中：\n$$K_{\\mathrm{sp}} = \\left(\\gamma_{M^{2+}} \\frac{S}{c^{\\circ}}\\right) \\left(\\gamma_{X^{2-}} \\frac{S}{c^{\\circ}}\\right) = \\gamma_{M^{2+}} \\gamma_{X^{2-}} \\left(\\frac{S}{c^{\\circ}}\\right)^2$$\n我们引入平均离子活度系数 $\\gamma_{\\pm}$，对于化学计量比为 $1:1$ 的盐（例如 $2:2$ 型电解质），其定义为 $\\gamma_{\\pm}^2 = \\gamma_{M^{2+}} \\gamma_{X^{2-}}$。$K_{\\mathrm{sp}}$ 的表达式变为：\n$$K_{\\mathrm{sp}} = \\gamma_{\\pm}^2 \\left(\\frac{S}{c^{\\circ}}\\right)^2$$\n求解摩尔溶解度 $S$，得到所需的关系式：\n$$S = c^{\\circ} \\frac{\\sqrt{K_{\\mathrm{sp}}}}{\\gamma_{\\pm}}$$\n这个方程表明，基于浓度的溶解度 $S$ 与平均离子活度系数 $\\gamma_{\\pm}$ 成反比，而 $\\gamma_{\\pm}$ 本身是溶液离子强度 $I$ 的函数。\n\n现在，我们将此框架应用于硫酸钡 $\\mathrm{BaSO_4}$ 在 $298\\ \\mathrm{K}$ 下溶解于 $0.100\\ \\mathrm{mol\\ L^{-1}}$ 硝酸钠 $\\mathrm{NaNO_3}$ 溶液的具体情况。\n\n理想模型忽略了离子强度效应，这等同于将所有活度系数设为 1（$\\gamma_i = 1$，因此 $\\gamma_{\\pm} = 1$）。在此理想模型下的溶解度 $S_{\\mathrm{ideal}}$ 为：\n$$S_{\\mathrm{ideal}} = c^{\\circ} \\sqrt{K_{\\mathrm{sp}}} = (1\\ \\mathrm{mol\\ L^{-1}}) \\sqrt{1.10 \\times 10^{-10}} \\approx 1.0488 \\times 10^{-5}\\ \\mathrm{mol\\ L^{-1}}$$\n真实模型通过活度系数 $\\gamma_{\\pm}$ 来考虑离子间的相互作用。为了计算 $\\gamma_{\\pm}$，我们必须首先确定介质的离子强度 $I$。离子强度的定义为 $I = \\frac{1}{2}\\sum_{i} c_i z_i^2$。溶液中包含来自完全解离的背景电解质 $\\mathrm{NaNO_3}$ 的离子（$c_{\\mathrm{Na^+}} = 0.100\\ \\mathrm{mol\\ L^{-1}}$，$c_{\\mathrm{NO_3^-}} = 0.100\\ \\mathrm{mol\\ L^{-1}}$）和来自溶解的 $\\mathrm{BaSO_4}$ 的离子（$c_{\\mathrm{Ba^{2+}}} = S$，$c_{\\mathrm{SO_4^{2-}}} = S$）。问题允许我们假设 $\\mathrm{BaSO_4}$ 对离子强度的贡献可以忽略不计。我们采用此近似，并将在事后对其进行验证。\n因此，离子强度主要由背景电解质决定：\n$$I \\approx I_{\\mathrm{NaNO_3}} = \\frac{1}{2} \\left( c_{\\mathrm{Na^+}} z_{\\mathrm{Na^+}}^2 + c_{\\mathrm{NO_3^-}} z_{\\mathrm{NO_3^-}}^2 \\right) = \\frac{1}{2} \\left( (0.100)(+1)^2 + (0.100)(-1)^2 \\right) = 0.100\\ \\mathrm{mol\\ L^{-1}}$$\n我们使用指定的 Davies 方程来估算 $\\mathrm{Ba^{2+}}$ 和 $\\mathrm{SO_4^{2-}}$ 的单个离子活度系数：\n$$\\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$$\n对于 $\\mathrm{Ba^{2+}}$ ($z=+2$) 和 $\\mathrm{SO_4^{2-}}$ ($z=-2$)，电荷数的平方均为 $z_i^2 = 4$。使用给定值 $A = 0.509$ 和 $I = 0.100\\ \\mathrm{mol\\ L^{-1}}$：\n$$\\log_{10}(\\gamma_i) = -(0.509)(4) \\left( \\frac{\\sqrt{0.100}}{1+\\sqrt{0.100}} - 0.3 \\times 0.100 \\right)$$\n$$\\log_{10}(\\gamma_i) \\approx -2.036 \\left( \\frac{0.316228}{1.316228} - 0.03 \\right) = -2.036 (0.24024 - 0.03) = -2.036(0.21024) \\approx -0.42805$$\n这得到 $\\gamma_i = 10^{-0.42805} \\approx 0.37320$。由于 $\\gamma_{\\mathrm{Ba^{2+}}} = \\gamma_{\\mathrm{SO_4^{2-}}}$，平均离子活度系数为 $\\gamma_{\\pm} = \\sqrt{\\gamma_{\\mathrm{Ba^{2+}}} \\gamma_{\\mathrm{SO_4^{2-}}}} = \\gamma_i \\approx 0.37320$。\n\n真实模型中的溶解度 $S_{\\mathrm{real}}$ 为：\n$$S_{\\mathrm{real}} = \\frac{c^{\\circ} \\sqrt{K_{\\mathrm{sp}}}}{\\gamma_{\\pm}} = \\frac{S_{\\mathrm{ideal}}}{\\gamma_{\\pm}} \\approx \\frac{1.0488 \\times 10^{-5}\\ \\mathrm{mol\\ L^{-1}}}{0.37320} \\approx 2.8099 \\times 10^{-5}\\ \\mathrm{mol\\ L^{-1}}$$\n现在，我们必须验证最初的近似。溶解的 $\\mathrm{BaSO_4}$ 对离子强度的贡献为 $I_{\\mathrm{BaSO_4}} = \\frac{1}{2}(S_{\\mathrm{real}}(+2)^2 + S_{\\mathrm{real}}(-2)^2) = 4S_{\\mathrm{real}} \\approx 4 \\times (2.8099 \\times 10^{-5}) \\approx 1.12 \\times 10^{-4}\\ \\mathrm{mol\\ L^{-1}}$。与背景电解质的离子强度 $I_{\\mathrm{NaNO_3}} = 0.100\\ \\mathrm{mol\\ L^{-1}}$ 相比，我们发现来自 $\\mathrm{BaSO_4}$ 的贡献仅占总量的约 $0.11\\%$。这是一个可以忽略的量，因此该近似在定量上是合理的。\n\n问题要求计算理想模型对真实摩尔溶解度的低估或高估因子。该因子是比率 $\\frac{S_{\\mathrm{real}}}{S_{\\mathrm{ideal}}}$。\n$$\\text{因子} = \\frac{S_{\\mathrm{real}}}{S_{\\mathrm{ideal}}} = \\frac{S_{\\mathrm{ideal}} / \\gamma_{\\pm}}{S_{\\mathrm{ideal}}} = \\frac{1}{\\gamma_{\\pm}}$$\n$$\\text{因子} = \\frac{1}{0.37320} \\approx 2.6795$$\n由于该因子大于 $1$，理想模型低估了真实溶解度。惰性电解质的存在屏蔽了 $\\mathrm{Ba^{2+}}$ 和 $\\mathrm{SO_4^{2-}}$ 离子之间的静电吸引力，降低了它们的活度，并根据勒夏特列原理，使平衡向有利于进一步溶解的方向移动。这种现象被称为盐效应。\n按要求将该因子四舍五入到四位有效数字，得到 $2.680$。", "answer": "$$\\boxed{2.680}$$", "id": "2942651"}, {"introduction": "真实世界的化学体系往往涉及多个相互关联的平衡，所有这些平衡都受到离子强度的影响。本练习将挑战你构建一个“自洽”计算模型，以解决多元弱酸在溶液中的复杂平衡问题。这项任务代表了对电解质溶液进行精确建模的现代方法，它将离子强度、活度系数和多个化学平衡定律整合到一个统一的迭代算法中，是解决复杂化学问题的强大工具。[@problem_id:2942676]", "problem": "为水溶液中的通用多元质子酸实现一个完整且自洽的计算算法，该算法通过同时满足质量作用、质量平衡、电荷中性以及与离子强度相关的活度校正，来确定氢离子浓度和离子强度。该算法必须从基本定律和定义出发，并且除了这些定义之外，不得假定任何预先推导的简化表达式。\n\n您必须在标准温度 $298\\,\\mathrm{K}$ 下使用以下基本定义和经过充分检验的关系式：\n- 活度：对于每种物种 $i$，其活度为 $a_i = \\gamma_i c_i$，其中 $c_i$ 是以 $\\mathrm{mol\\,L^{-1}}$ 为单位的摩尔浓度，$\\gamma_i$ 是活度系数。\n- 离子强度：$I = \\dfrac{1}{2}\\sum_{i} c_i z_i^2$，其中 $z_i$ 是物种 $i$ 的整数电荷。\n- 水的自递质子反应：$K_\\mathrm{w} = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$。在所述温度下，使用 $K_\\mathrm{w} = 10^{-14}$ 作为热力学常数。因此 $c_{\\mathrm{OH}^-} = \\dfrac{K_\\mathrm{w}}{\\gamma_{\\mathrm{H}^+}\\gamma_{\\mathrm{OH}^-} c_{\\mathrm{H}^+}}$。\n- 具有 $m$ 个酸性质子和逐步热力学解离常数 $\\{K_1,\\dots,K_m\\}$ 的通用多元质子酸 $\\mathrm{H}_m\\mathrm{A}$ 的逐步解离平衡：\n  对于第 $i$ 步，$\\mathrm{H}_{m-(i-1)}\\mathrm{A}^{-(i-1)} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{H}_{m-i}\\mathrm{A}^{-i}$，其 $K_i = \\dfrac{a_{\\mathrm{H}^+}\\,a_{\\mathrm{H}_{m-i}\\mathrm{A}^{-i}}}{a_{\\mathrm{H}_{m-(i-1)}\\mathrm{A}^{-(i-1)}}}$.\n- 离子的活度系数由 Davies 方程给出（这是在适中离子强度下对 Debye–Hückel 理论的一个经过充分检验的扩展）：\n  $\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right)$，在 $298\\,\\mathrm{K}$ 时 $A = 0.509$。对于中性物种，$z_i = 0$ 且 $\\gamma_i = 1$。\n\n您必须强制执行：\n- 总酸质量平衡：$\\sum_{i=0}^{m} c_i = C_\\mathrm{T}$，其中 $c_0 = [\\mathrm{H}_m\\mathrm{A}]$, $c_1 = [\\mathrm{H}_{m-1}\\mathrm{A}^-]$, $\\dots$, $c_m = [\\mathrm{A}^{m-}]$。\n- 电荷中性：$c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{i=1}^{m} i\\,c_i + \\sum_{\\text{background ions}} z_j c_j = 0$。假设背景盐是作为电荷平衡的离子对添加的强电解质，其浓度固定，因此其净电荷为零，只有它们对离子强度的贡献需要考虑。在此假设下，电荷中性条件简化为 $c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{i=1}^{m} i\\,c_i = 0$。\n\n算法的设计要求：\n- 未知数包括 $c_{\\mathrm{H}^+}$ 和所有酸的质子化态浓度 $\\{c_i\\}$，其中活度系数 $\\{\\gamma_i\\}$ 以及 $\\gamma_{\\mathrm{H}^+}$、$\\gamma_{\\mathrm{OH}^-}$ 通过 Davies 关系经由 $I$ 自洽地确定。\n- 使用对 $I$ 的不动点外层迭代来更新活度系数，并结合一个内层求根过程，通过逐步平衡和活度来强制执行质量平衡，同时满足以 $c_{\\mathrm{H}^+}$ 表示的电荷中性条件。\n- 该解必须足够稳健，以覆盖稀溶液和中等浓度范围。您可以假设所有解离常数都是热力学（基于活度）常数。\n- 将背景电解质视为完全解离的强电解质，其离子浓度固定，对 $I$ 有贡献，但因其净贡献在构造上为零，故不出现在电荷中性方程中。\n\n数值输出要求：\n- 对于每个测试用例，计算氢离子浓度的负常用对数 $\\mathrm{pH} = -\\log_{10} c_{\\mathrm{H}^+}$，以及总离子强度 $I$（单位为 $\\mathrm{mol\\,L^{-1}}$）。\n- 将 $\\mathrm{pH}$ 表示为无量纲量，四舍五入到三位小数。\n- 将 $I$ 以 $\\mathrm{mol\\,L^{-1}}$ 为单位表示，并四舍五入到六位有效数字；如果需要，可使用科学记数法。\n\n需完全按照规定实现的测试套件：\n- 案例 $1$（在大量背景盐下的三元质子酸）：\n  - $m = 3$\n  - $\\mathrm{p}K_a$ 值：$[2.15,\\,7.20,\\,12.35]$\n  - 总酸浓度 $C_\\mathrm{T} = 1.0\\times 10^{-2}\\,\\mathrm{mol\\,L^{-1}}$\n  - 背景强电解质：$\\mathrm{NaCl}$ 浓度为 $1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$，处理为 $c_{\\mathrm{Na}^+} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$ 和 $c_{\\mathrm{Cl}^-} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$\n- 案例 $2$（无背景盐的二元质子酸）：\n  - $m = 2$\n  - $\\mathrm{p}K_a$ 值：$[6.35,\\,10.33]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n  - 无背景电解质\n- 案例 $3$（在低浓度背景盐下的单元弱酸）：\n  - $m = 1$\n  - $\\mathrm{p}K_a$ 值：$[4.76]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$\n  - 背景强电解质：$\\mathrm{NaCl}$ 浓度为 $1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$，其中 $c_{\\mathrm{Na}^+} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$ 且 $c_{\\mathrm{Cl}^-} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n- 案例 $4$（极低浓度、无背景盐的四元质子酸）：\n  - $m = 4$\n  - $\\mathrm{p}K_a$ 值：$[1.00,\\,3.50,\\,6.00,\\,8.50]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$\n  - 无背景电解质\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的配对列表，每个测试用例一个配对，每对依次为 $\\mathrm{pH}$ 和 $I$，例如 $[[\\mathrm{pH}_1, I_1],[\\mathrm{pH}_2, I_2],\\dots]$。", "solution": "该问题要求开发一种自洽的计算算法，以确定水溶液中通用多元质子酸的平衡状态。该状态由氢离子浓度（用于计算 $\\mathrm{pH}$）和溶液的总离子强度定义。该算法必须基于基本的物理化学原理，考虑质量作用、质量和电荷平衡，以及针对非理想行为的活度校正。\n\n该体系的平衡状态由一组耦合的非线性代数方程描述。设多元质子酸表示为 $\\mathrm{H}_m\\mathrm{A}$，其总分析浓度为 $C_\\mathrm{T}$，并有 $m$ 个逐步热力学解离常数 $\\{K_1, K_2, \\dots, K_m\\}$。溶液中由该酸衍生的物种有 $\\mathrm{H}_m\\mathrm{A}$、$\\mathrm{H}_{m-1}\\mathrm{A}^{-}$、...、$\\mathrm{A}^{m-}$，其摩尔浓度分别为 $\\{c_0, c_1, \\dots, c_m\\}$。此外，溶剂会自电离产生 $\\mathrm{H}^+$ 和 $\\mathrm{OH}^-$。\n\n在标准温度 $298\\,\\mathrm{K}$ 下的控制方程为：\n\n$1$. 质量作用定律（化学平衡）：\n物种 $i$ 的活度 $a_i$ 通过 $a_i = \\gamma_i c_i$ 与其摩尔浓度 $c_i$ 相关，其中 $\\gamma_i$ 是活度系数。\n对于酸的第 $k$ 步解离，$\\mathrm{H}_{m-(k-1)}\\mathrm{A}^{-(k-1)} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{H}_{m-k}\\mathrm{A}^{-k}$：\n$$K_k = \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{H}_{m-k}\\mathrm{A}^{-k}}}{a_{\\mathrm{H}_{m-(k-1)}\\mathrm{A}^{-(k-1)}}} = \\frac{(\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+}) (\\gamma_k c_k)}{(\\gamma_{k-1} c_{k-1})}$$\n其中，我们将物种 $\\mathrm{H}_{m-k}\\mathrm{A}^{-k}$ 的活度系数记为 $\\gamma_k$。该物种的电荷为 $-k$。中性酸 $\\mathrm{H}_m\\mathrm{A}$ 的电荷 $z_0=0$，其活度系数 $\\gamma_0$ 定义为 1。\n\n对于水的自递质子反应，$\\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{OH}^-$：\n$$K_\\mathrm{w} = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-} = (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+}) (\\gamma_{\\mathrm{OH}^-} c_{\\mathrm{OH}^-}) = 10^{-14}$$\n\n$2$. 酸的质量平衡：\n所有源自该酸的物种浓度之和必须等于总分析浓度 $C_\\mathrm{T}$：\n$$\\sum_{k=0}^{m} c_k = C_\\mathrm{T}$$\n\n$3$. 电荷平衡（电中性）：\n溶液必须呈电中性。正电荷的总和（以摩尔浓度单位计）必须等于负电荷的总和。对于含有惰性背景盐（例如 $\\mathrm{NaCl}$）的酸的水溶液，其中盐本身不贡献净电荷，该条件简化为：\n$$c_{\\mathrm{H}^+} = c_{\\mathrm{OH}^-} + \\sum_{k=1}^{m} k \\cdot c_k$$\n这可以重写为一个在平衡时必须等于零的函数：\n$$f(c_{\\mathrm{H}^+}) = c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{k=1}^{m} k \\cdot c_k = 0$$\n\n$4$. 离子强度和活度系数：\n离子强度 $I$ 是总离子浓度的一种度量，定义为：\n$$I = \\frac{1}{2} \\sum_i c_i z_i^2 = I_{\\mathrm{bg}} + \\frac{1}{2}\\left(c_{\\mathrm{H}^+} z_{\\mathrm{H}^+}^2 + c_{\\mathrm{OH}^-} z_{\\mathrm{OH}^-}^2 + \\sum_{k=1}^{m} c_k z_k^2\\right)$$\n其中 $I_{\\mathrm{bg}}$ 是来自任何背景电解质的贡献，$z_{\\mathrm{H}^+}=1$，$z_{\\mathrm{OH}^-}=-1$，对于物种 $\\mathrm{H}_{m-k}\\mathrm{A}^{-k}$，$z_k=-k$。因此，\n$$I = I_{\\mathrm{bg}} + \\frac{1}{2}\\left(c_{\\mathrm{H}^+} + c_{\\mathrm{OH}^-} + \\sum_{k=1}^{m} k^2 c_k\\right)$$\n离子物种的活度系数 $\\gamma_i$ 依赖于离子强度。这种关系由 Davies 方程建模：\n$$\\log_{10}\\gamma_i = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$$\n其中，在 $298\\,\\mathrm{K}$ 时 $A = 0.509$。对于中性物种（$z_i=0$），$\\gamma_i=1$。\n\n求解策略：\n该系统是相互依赖的：浓度决定离子强度，离子强度又决定活度系数，而活度系数反过来影响平衡浓度。这种循环依赖性表明可以采用迭代的自洽场方法。问题指定了一个两级迭代方案。\n\n首先，我们假设离子强度 $I$（以及所有 $\\gamma_i$ 值）暂时固定，将所有未知浓度表示为单一变量 $c_{\\mathrm{H}^+}$ 的函数。\n根据质量作用定律，我们可以推导出每种酸物种的相对浓度 $c_k$（用 $c_0$ 表示）：\n$$c_k = c_0 \\frac{\\gamma_0}{\\gamma_k a_{\\mathrm{H}^+}^k} \\prod_{j=1}^{k} K_j = \\frac{c_0}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k} \\prod_{j=1}^{k} K_j$$\n将这些代入质量平衡方程，可以解出 $c_0$：\n$$C_\\mathrm{T} = c_0 \\left( 1 + \\sum_{k=1}^{m} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k} \\right)$$\n令分母项为 $\\mathcal{D}$：\n$$\\mathcal{D} = 1 + \\sum_{k=1}^{m} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k}$$\n于是，$c_0 = C_\\mathrm{T} / \\mathcal{D}$，并且可以求出任何 $c_k$：\n$$c_k = \\frac{C_\\mathrm{T}}{\\mathcal{D}} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k}$$\n氢氧根离子的浓度也是 $c_{\\mathrm{H}^+}$ 的函数：\n$$c_{\\mathrm{OH}^-} = \\frac{K_\\mathrm{w}}}{\\gamma_{\\mathrm{H}^+} \\gamma_{\\mathrm{OH}^-} c_{\\mathrm{H}^+}}$$\n利用这些表达式，对于固定的 $I$，电荷平衡方程变成一个只含单个未知数 $c_{\\mathrm{H}^+}$ 的函数：$f(c_{\\mathrm{H}^+}) = 0$。该函数是单调的，可以使用像 Brent 方法这样的数值求根算法高效求解。\n\n完整的计算算法如下：\n$1$. **初始化**：为离子强度 $I_{\\mathrm{new}}$ 设置一个初始猜测值。一个合适的猜测值是来自背景电解质的贡献 $I_{\\mathrm{bg}}$，如果 $I_{\\mathrm{bg}}=0$，则可使用一个较小的值，如 $10^{-7}\\,\\mathrm{M}$。\n$2$. **外层迭代循环（针对 $I$）**：\n    a. 设置 $I_{\\mathrm{old}} = I_{\\mathrm{new}}$。\n    b. 基于 $I_{\\mathrm{old}}$，使用 Davies 方程计算所有需要的活度系数 $\\gamma_i$。\n    c. **内层程序（求解 $c_{\\mathrm{H}^+}$ 的根）**：求解电荷平衡方程 $f(c_{\\mathrm{H}^+}) = 0$ 以得到 $c_{\\mathrm{H}^+}$。函数 $f$ 使用步骤 2b 中固定的 $\\gamma_i$ 值。其解即为平衡氢离子浓度 $c_{\\mathrm{H}^+,sol}$。\n    d. 使用 $c_{\\mathrm{H}^+,sol}$，计算所有其他物种的平衡浓度：$c_{\\mathrm{OH}^-}$ 和所有 $c_k$。\n    e. 使用新找到的浓度重新计算总离子强度 $I_{\\mathrm{new}}$。\n    f. 检查收敛性：如果 $|I_{\\mathrm{new}} - I_{\\mathrm{old}}|$ 低于指定的容差，则循环终止。否则，从步骤 2a 开始重复。\n$3$. **最终确定**：一旦收敛，最终的 $c_{\\mathrm{H}^+,sol}$ 和 $I_{\\mathrm{new}}$ 就是自洽的结果。计算 $\\mathrm{pH} = -\\log_{10}(c_{\\mathrm{H}^+,sol})$ 并按要求格式化输出。\n\n这个迭代过程确保最终的浓度集同时满足平衡体系的所有基本条件。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to set up and run the test cases for the polyprotic acid equilibrium problem.\n    \"\"\"\n\n    class PolyproticAcidSolver:\n        \"\"\"\n        A solver for the equilibrium of a polyprotic acid in aqueous solution,\n        including activity corrections via the Davies equation.\n        \"\"\"\n        def __init__(self, m, pKas, C_T, background_electrolytes):\n            self.m = int(m)\n            self.pKas = np.array(pKas, dtype=float)\n            self.Kas = 10**(-self.pKas)\n            self.C_T = float(C_T)\n            \n            # Calculate ionic strength from background strong electrolytes\n            self.I_bg = 0.5 * sum(conc * charge**2 for conc, charge in background_electrolytes)\n            \n            self.charges = np.array([-i for i in range(self.m + 1)], dtype=int)\n            \n            # Pre-calculate cumulative products of Ka values\n            self.K_prods = np.cumprod(self.Kas)\n\n            # Constants\n            self.A = 0.509\n            self.K_w = 1.0e-14\n\n        def _davies_gamma(self, z, I):\n            \"\"\"Calculates activity coefficient using the Davies equation.\"\"\"\n            if z == 0 or I = 1e-15:\n                return 1.0\n            sqrt_I = np.sqrt(I)\n            log10_gamma = -self.A * z**2 * (sqrt_I / (1 + sqrt_I) - 0.3 * I)\n            return 10**log10_gamma\n\n        def calculate_equilibrium(self):\n            \"\"\"\n            Performs the self-consistent iterative calculation.\n            Outer loop iterates on ionic strength (I).\n            Inner procedure uses a root-finder for hydrogen ion concentration (c_H).\n            \"\"\"\n            I_new = self.I_bg\n            if I_new = 1e-14:  # Initial guess for I if no background salt\n                I_new = 1e-7\n\n            I_old = -1.0\n            c_H = np.nan # Initialize to indicate not yet solved\n            max_iter = 100\n            \n            for _ in range(max_iter):\n                if abs(I_new - I_old) = 1e-10 * (I_new + 1e-10):\n                    break\n                \n                I_old = I_new\n                \n                # Calculate activity coefficients for the current ionic strength I_old\n                max_charge = self.m\n                gammas_z = {z: self._davies_gamma(z, I_old) for z in range(1, max_charge + 2)}\n                gamma_H = gammas_z.get(1, 1.0)\n                gamma_OH = gammas_z.get(1, 1.0)\n\n                # Define the charge balance function to be solved for c_H\n                def charge_balance_func(c_H_test):\n                    if c_H_test = 0: return -1.0 # Guard against non-physical inputs\n                    \n                    a_H = gamma_H * c_H_test\n                    \n                    # Denominator for speciation fractions (alpha_k = c_k / C_T)\n                    # Denom = 1 + sum( (prod(K_j) / (a_H^k * gamma_k)) for k=1..m )\n                    denom_terms = [1.0]\n                    a_H_pow_k = 1.0\n                    for k in range(1, self.m + 1):\n                        a_H_pow_k *= a_H\n                        gamma_k = gammas_z.get(k, 1.0)\n                        denom_terms.append(self.K_prods[k-1] / (a_H_pow_k * gamma_k))\n                    \n                    \n                    alpha0 = 1.0 / sum(denom_terms)\n\n                    # Sum term in charge balance: sum_{k=1 to m} k*c_k\n                    sum_term = 0.0\n                    for k in range(1, self.m + 1):\n                        # alpha_k = alpha_0 * term_k\n                        alpha_k = alpha0 * denom_terms[k]\n                        c_k = self.C_T * alpha_k\n                        sum_term += k * c_k\n                        \n                    c_OH = self.K_w / (gamma_H * gamma_OH * c_H_test)\n\n                    return c_H_test - c_OH - sum_term\n\n                # Find the root of the charge balance function using Brent's method\n                # The search interval [1e-15, 10.0] covers the pH range from 15 to -1.\n                try:\n                    c_H = brentq(charge_balance_func, 1e-15, 10.0, xtol=1e-15, rtol=1e-15)\n                except ValueError:\n                    # Brent's method may fail if the function does not cross zero within the interval.\n                    # This could happen in extreme cases, though unlikely for typical chemistry problems.\n                    return np.nan, np.nan # Indicate failure\n\n                # Recalculate concentrations and update ionic strength with the new c_H\n                a_H = gamma_H * c_H\n                c_OH = self.K_w / (gamma_H * gamma_OH * c_H)\n                \n                denom_terms = [1.0]\n                a_H_pow_k = 1.0\n                for k in range(1, self.m + 1):\n                    a_H_pow_k *= a_H\n                    gamma_k = gammas_z.get(k, 1.0)\n                    denom_terms.append(self.K_prods[k-1] / (a_H_pow_k * gamma_k))\n                \n                alpha0 = 1.0 / sum(denom_terms)\n\n                ionic_strength_acid_part = 0.0\n                for k in range(1, self.m + 1):\n                    alpha_k = alpha0 * denom_terms[k]\n                    c_k = self.C_T * alpha_k\n                    ionic_strength_acid_part += c_k * (self.charges[k]**2)\n\n                I_new = self.I_bg + 0.5 * (c_H + c_OH + ionic_strength_acid_part)\n            else:\n                 # Loop finished without convergence\n                 return np.nan, np.nan\n            \n            pH = -np.log10(c_H)\n            \n            return pH, I_new\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Triprotic acid with background salt\n        {'m': 3, 'pKas': [2.15, 7.20, 12.35], 'C_T': 1.0e-2, \n         'background': [(1.0e-1, 1), (1.0e-1, -1)]}, # 0.1M NaCl\n        # Case 2: Diprotic acid without background salt\n        {'m': 2, 'pKas': [6.35, 10.33], 'C_T': 1.0e-3, \n         'background': []}, # No background\n        # Case 3: Monoprotic acid with low background salt\n        {'m': 1, 'pKas': [4.76], 'C_T': 1.0e-1, \n         'background': [(1.0e-3, 1), (1.0e-3, -1)]}, # 0.001M NaCl\n        # Case 4: Tetraprotic acid at very low concentration\n        {'m': 4, 'pKas': [1.00, 3.50, 6.00, 8.50], 'C_T': 1.0e-6, \n         'background': []}, # No background\n    ]\n\n    results = []\n    for case in test_cases:\n        solver = PolyproticAcidSolver(case['m'], case['pKas'], case['C_T'], case['background'])\n        pH, I = solver.calculate_equilibrium()\n        \n        # Format the results as per requirements\n        pH_rounded = round(pH, 3)\n        # Round I to 6 significant figures. The 'g' format specifier does this.\n        # Then convert back to float to avoid quotes in the final list literal.\n        I_rounded = float(f\"{I:.6g}\")\n        \n        results.append([pH_rounded, I_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to its string representation and remove spaces.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```", "id": "2942676"}]}