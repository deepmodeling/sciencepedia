{"hands_on_practices": [{"introduction": "热力学模型在描述真实混合物行为中至关重要。本练习将从一个给定的过剩吉布斯自由能模型出发，推导各个组分的过剩化学势，这是将宏观整体性质与微观组分性质联系起来的一项基本技能。通过直接验证吉布斯-杜亥姆方程，我们可以确保所用模型的内在热力学一致性，这是任何可靠的热力学计算的基础。[@problem_id:2628595]", "problem": "考虑一个由组分 $1$ 和 $2$ 组成的二元液体混合物，其温度 $T$ 和压力 $p$ 恒定。设总摩尔数为 $n=n_{1}+n_{2}$，摩尔分数为 $x_{1}=n_{1}/n$ 和 $x_{2}=n_{2}/n$，且 $x_{1}+x_{2}=1$。摩尔超额吉布斯能由以下依赖于组成的模型给出\n$$\ng^{E}(T,p,x_{1},x_{2}) = R T\\,x_{1}x_{2}\\left[A + B\\left(x_{1}-x_{2}\\right)\\right],\n$$\n其中 $R$ 是气体常数，$A$ 和 $B$ 是无量纲参数，在所研究的条件下，它们仅取决于 $T$（且与 $p$ 和组成无关）。总超额吉布斯能为 $G^{E} = n\\,g^{E}$。\n\n仅使用基本定义，将化学势定义为偏摩尔吉布斯能 $\\mu_{i} \\equiv \\left(\\frac{\\partial G}{\\partial n_{i}}\\right)_{T,p,n_{j\\neq i}}$，在恒定的 $T$ 和 $p$ 下按以下步骤进行：\n\n1. 从 $G^{E}=n\\,g^{E}$ 推导出超额化学势 $\\mu_{1}^{E}(x_{1})$ 和 $\\mu_{2}^{E}(x_{1})$ 的显式表达式，然后求出它们相对于无穷小的组成变化 $dx_{1}$（其中 $dx_{2}=-dx_{1}$）的全微分 $d\\mu_{1}$ 和 $d\\mu_{2}$。用 $x_{1}$、$A$、$B$、$R$、$T$ 和 $dx_{1}$ 表示你的结果。\n\n2. 直接根据你的结果，验证在恒定 $T$ 和 $p$ 下的 Gibbs–Duhem 方程\n$$\nx_{1}\\,d\\mu_{1} + x_{2}\\,d\\mu_{2} = 0,\n$$\n是否被此模型满足。\n\n报告由你的推导得出的 $x_{1}\\,d\\mu_{1} + x_{2}\\,d\\mu_{2}$ 的值，该值应为一个无单位的精确值。不需要进行数值舍入。", "solution": "问题陈述经评估有效。它具有科学依据、提法恰当且客观，是化学热力学中的一个标准练习。我们将进行严谨的推导。\n\n混合物中组分 $i$ 的化学势的基本定义由偏摩尔吉布斯能给出：\n$$\n\\mu_{i} \\equiv \\left(\\frac{\\partial G}{\\partial n_{i}}\\right)_{T,p,n_{j\\neq i}}\n$$\n其中 $G$ 是系统的总吉布斯能，$n_i$ 是组分 $i$ 的摩尔数。总吉布斯能是理想混合吉布斯能和超额吉布斯能之和，$G = G^{\\text{ideal}} + G^{E}$。因此，化学势可以分解为 $\\mu_{i} = \\mu_{i}^{\\text{ideal}} + \\mu_{i}^{E}$。所以超额化学势由下式给出：\n$$\n\\mu_{i}^{E} = \\left(\\frac{\\partial G^{E}}{\\partial n_{i}}\\right)_{T,p,n_{j\\neq i}}\n$$\n一种从摩尔量推导偏摩尔量的更便捷方法涉及对摩尔分数求导。对于二元混合物，超额化学势 $\\mu_1^E$ 和 $\\mu_2^E$ 与摩尔超额吉布斯能 $g^E$ 通过以下关系相关联：\n$$\n\\mu_{1}^{E} = g^{E} + (1-x_{1}) \\frac{d g^{E}}{d x_{1}} \\quad \\text{与} \\quad \\mu_{2}^{E} = g^{E} - x_{1} \\frac{d g^{E}}{d x_{1}}\n$$\n其中 $x_1$ 是组分 $1$ 的摩尔分数。\n\n首先，我们通过关系式 $x_2 = 1-x_1$ 将给定的摩尔超额吉布斯能 $g^E$ 表示为仅含一个组成变量 $x_1$ 的函数：\n$$\ng^{E}(x_{1}) = R T\\,x_{1}(1-x_{1})\\left[A + B\\left(x_{1}-(1-x_{1})\\right)\\right] = R T\\,x_{1}(1-x_{1})\\left[A + B\\left(2x_{1}-1\\right)\\right]\n$$\n为了简化后续的代数运算，我们使用无量纲量 $g^{E}/(RT)$：\n$$\n\\frac{g^{E}}{RT} = (x_{1}-x_{1}^{2})\\left[A + B(2x_{1}-1)\\right] = A(x_{1}-x_{1}^{2}) + B(2x_{1}^{2}-x_{1}-2x_{1}^{3}+x_{1}^{2}) = A(x_{1}-x_{1}^{2}) + B(-2x_{1}^{3}+3x_{1}^{2}-x_{1})\n$$\n接下来，我们在恒定 $T$ 和 $p$ 下计算 $g^E$ 对 $x_1$ 的导数：\n$$\n\\frac{1}{RT} \\frac{d g^{E}}{d x_{1}} = \\frac{d}{dx_1} \\left[ A(x_{1}-x_{1}^{2}) + B(-2x_{1}^{3}+3x_{1}^{2}-x_{1}) \\right] = A(1-2x_{1}) + B(-6x_{1}^{2}+6x_{1}-1)\n$$\n现在我们推导超额化学势 $\\mu_1^E$ 和 $\\mu_2^E$ 的表达式。\n对于组分 $1$：\n$$\n\\frac{\\mu_{1}^{E}}{RT} = \\frac{g^{E}}{RT} + (1-x_{1}) \\frac{1}{RT} \\frac{d g^{E}}{d x_{1}}\n$$\n$$\n\\frac{\\mu_{1}^{E}}{RT} = x_{1}(1-x_{1})[A + B(2x_{1}-1)] + (1-x_{1})[A(1-2x_{1}) + B(-6x_{1}^{2}+6x_{1}-1)]\n$$\n提出公因式 $(1-x_1)$：\n$$\n\\frac{\\mu_{1}^{E}}{RT} = (1-x_{1}) \\left\\{ x_{1}[A + B(2x_{1}-1)] + [A(1-2x_{1}) + B(-6x_{1}^{2}+6x_{1}-1)] \\right\\}\n$$\n$$\n\\frac{\\mu_{1}^{E}}{RT} = (1-x_{1}) \\left\\{ (Ax_{1} + 2Bx_{1}^{2} - Bx_{1}) + (A - 2Ax_{1} - 6Bx_{1}^{2} + 6Bx_{1} - B) \\right\\}\n$$\n$$\n\\frac{\\mu_{1}^{E}}{RT} = (1-x_{1}) \\left\\{ A - Ax_{1} - 4Bx_{1}^{2} + 5Bx_{1} - B \\right\\} = (1-x_{1}) \\left\\{ A(1-x_{1}) + B(-4x_{1}^{2} + 5x_{1} - 1) \\right\\}\n$$\n对二次项进行因式分解可得 $-4x_{1}^{2} + 5x_{1} - 1 = -(4x_1-1)(x_1-1) = (1-x_1)(4x_1-1)$。\n$$\n\\frac{\\mu_{1}^{E}}{RT} = (1-x_{1}) \\left\\{ A(1-x_{1}) + B(1-x_1)(4x_1-1) \\right\\} = (1-x_{1})^2 [A + B(4x_{1}-1)]\n$$\n因此，组分 $1$ 的超额化学势为 $\\mu_{1}^{E}(x_{1}) = RT(1-x_1)^2 [A + B(4x_1-1)]$。\n\n对于组分 $2$：\n$$\n\\frac{\\mu_{2}^{E}}{RT} = \\frac{g^{E}}{RT} - x_{1} \\frac{1}{RT} \\frac{d g^{E}}{d x_{1}}\n$$\n$$\n\\frac{\\mu_{2}^{E}}{RT} = x_{1}(1-x_{1})[A + B(2x_{1}-1)] - x_{1}[A(1-2x_{1}) + B(-6x_{1}^{2}+6x_{1}-1)]\n$$\n提出公因式 $x_1$：\n$$\n\\frac{\\mu_{2}^{E}}{RT} = x_{1} \\left\\{ (1-x_{1})[A + B(2x_{1}-1)] - [A(1-2x_{1}) + B(-6x_{1}^{2}+6x_{1}-1)] \\right\\}\n$$\n$$\n\\frac{\\mu_{2}^{E}}{RT} = x_{1} \\left\\{ (A - Ax_{1} -2Bx_{1}^{2} + 3Bx_{1} - B) - (A - 2Ax_{1} -6Bx_{1}^{2} + 6Bx_{1} - B) \\right\\}\n$$\n$$\n\\frac{\\mu_{2}^{E}}{RT} = x_{1} \\left\\{ Ax_{1} + 4Bx_{1}^{2} - 3Bx_{1} \\right\\} = x_{1}^{2} [A + B(4x_{1}-3)]\n$$\n因此，组分 $2$ 的超额化学势为 $\\mu_{2}^{E}(x_{1}) = RT x_1^2 [A + B(4x_1-3)]$。这完成了任务的第一部分。\n\n接下来，我们求全微分 $d\\mu_1$ 和 $d\\mu_2$。总化学势为 $\\mu_i = \\mu_i^{\\circ}(T,p) + RT \\ln x_i + \\mu_i^E$。由于 $T$ 和 $p$ 是恒定的，$d\\mu_i^{\\circ} = 0$。$\\mu_i$ 的变化仅由组成变化 $dx_1$ 引起。\n$$\nd\\mu_{1} = \\left(\\frac{\\partial \\mu_{1}}{\\partial x_{1}}\\right)_{T,p} dx_{1} = \\left[ \\frac{\\partial}{\\partial x_1}(RT \\ln x_1) + \\frac{\\partial \\mu_{1}^{E}}{\\partial x_1} \\right] dx_1\n$$\n$$\nd\\mu_{2} = \\left(\\frac{\\partial \\mu_{2}}{\\partial x_{1}}\\right)_{T,p} dx_{1} = \\left[ \\frac{\\partial}{\\partial x_1}(RT \\ln (1-x_1)) + \\frac{\\partial \\mu_{2}^{E}}{\\partial x_1} \\right] dx_1\n$$\n让我们计算超额部分所需的导数：\n$$\n\\frac{1}{RT} \\frac{\\partial \\mu_{1}^{E}}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( (1-x_1)^2 [A + B(4x_1-1)] \\right) = -2(1-x_1)[A + B(4x_1-1)] + (1-x_1)^2(4B)\n$$\n$$\n= -2A(1-x_1) -2B(1-x_1)(4x_1-1) + 4B(1-x_1)^2 = -2A(1-x_1) + 6B(1-x_1)(1-2x_1)\n$$\n$$\n\\frac{1}{RT} \\frac{\\partial \\mu_{2}^{E}}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( x_1^2 [A + B(4x_1-3)] \\right) = 2x_1[A + B(4x_1-3)] + x_1^2(4B)\n$$\n$$\n= 2Ax_1 + 2Bx_1(4x_1-3) + 4Bx_1^2 = 2Ax_1 + 8Bx_1^2 - 6Bx_1 + 4Bx_1^2 = 2Ax_1 + 12Bx_1^2 - 6Bx_1 = 2Ax_1+6Bx_1(2x_1-1)\n$$\n将这些与理想部分结合：\n$$\n\\frac{1}{RT} \\frac{\\partial \\mu_{1}}{\\partial x_1} = \\frac{1}{x_1} -2A(1-x_1) + 6B(1-x_1)(1-2x_1)\n$$\n$$\n\\frac{1}{RT} \\frac{\\partial \\mu_{2}}{\\partial x_1} = -\\frac{1}{1-x_1} + 2Ax_1 + 6Bx_1(2x_1-1)\n$$\n所以，微分式为：\n$$\nd\\mu_1 = RT \\left[ \\frac{1}{x_1} -2A(1-x_1) + 6B(1-x_1)(1-2x_1) \\right] dx_1\n$$\n$$\nd\\mu_2 = RT \\left[ -\\frac{1}{1-x_1} + 2Ax_1 + 6Bx_1(2x_1-1) \\right] dx_1\n$$\n最后，我们在恒定 $T$ 和 $p$ 下验证 Gibbs-Duhem 方程：$x_{1}d\\mu_{1} + x_{2}d\\mu_{2} = 0$。使用 $x_2=1-x_1$，我们计算该和：\n$$\n\\frac{x_{1}d\\mu_{1} + x_{2}d\\mu_{2}}{RT dx_1} = x_{1} \\left(\\frac{1}{RT}\\frac{\\partial \\mu_{1}}{\\partial x_1}\\right) + (1-x_{1}) \\left(\\frac{1}{RT}\\frac{\\partial \\mu_{2}}{\\partial x_1}\\right)\n$$\n$$\n= x_{1} \\left[ \\frac{1}{x_1} -2A(1-x_1) + 6B(1-x_1)(1-2x_1) \\right] + (1-x_{1}) \\left[ -\\frac{1}{1-x_1} + 2Ax_1 + 6Bx_1(2x_1-1) \\right]\n$$\n我们展开各项：\n$$\n= \\left[ 1 -2Ax_1(1-x_1) + 6Bx_1(1-x_1)(1-2x_1) \\right] + \\left[ -1 + 2A(1-x_1)x_1 + 6B(1-x_1)x_1(2x_1-1) \\right]\n$$\n现在我们按常数 $A$ 和 $B$ 分组各项：\n常数项相互抵消：$1 - 1 = 0$。\n含 $A$ 的项相互抵消：$-2Ax_1(1-x_1) + 2A(1-x_1)x_1 = 0$。\n含 $B$ 的项相互抵消：$6Bx_1(1-x_1)(1-2x_1) + 6B(1-x_1)x_1(2x_1-1) = 6Bx_1(1-x_1)(1-2x_1) - 6Bx_1(1-x_1)(1-2x_1) = 0$。\n每一项都相互抵消，所以和恒等于零。\n$$\n\\frac{x_{1}d\\mu_{1} + x_{2}d\\mu_{2}}{RT dx_1} = 0\n$$\n因此，$x_{1}d\\mu_{1} + x_{2}d\\mu_{2} = 0$。对于任意组成 $x_1$ 和任意参数 $A$ 和 $B$，Gibbs-Duhem 方程都得到满足。这不是巧合；这是所构建的化学势关系式具有热力学一致性的必然结果。该表达式的值恰好为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2628595"}, {"introduction": "吉布斯-杜亥姆方程不仅是热力学一致性的检验标准，更是一个强大的约束工具。本练习旨在展示如何利用这一关系，从一个组分的活度系数实验数据出发，通过积分来重构另一个组分的活度系数。这项技能对于评估和处理实验数据、确保相平衡计算的可靠性至关重要。[@problem_id:2927970]", "problem": "在恒定温度 $T$ 和压力 $P$ 下，研究由组分 $1$ 和 $2$ 构成的二元液体混合物。混合物中组分 $i$ 的化学势 $\\mu_i$ 由偏摩尔吉布斯能定义，对于以纯液体为标准态（拉乌尔定律标准态）的液体，其满足关系式 $\\mu_i(T,P,\\{x_j\\})=\\mu_i^{\\ast}(T,P)+R T \\ln\\!\\big(\\gamma_i x_i\\big)$，其中 $x_i$ 是摩尔分数，$\\gamma_i$ 是活度系数，$R$ 是摩尔气体常数。组分 $1$ 的活度系数对组成的实验依赖关系可由下式很好地描述：\n$$\n\\ln \\gamma_1(x_1) \\;=\\; A\\,(1-x_1)^{2} \\;+\\; B\\,(1-x_1)^{3},\n$$\n在指定的 $T$ 和 $P$ 下，$A=1.10$，$B=-0.30$。假设 $x_1 \\in [0,1]$ 且 $x_2=1-x_1$。\n\n仅使用恒定 $T$ 和 $P$ 下的基本热力学关系（吉布斯能的欧拉齐次性、化学势作为偏摩尔量的定义以及上述活度定义），完成以下任务：\n\n1) 对于恒定 $T$ 和 $P$ 下的二元混合物，推导联系 $d\\ln\\gamma_1$ 和 $d\\ln\\gamma_2$ 的组成-微分关系。\n\n2) 使用第 (1) 部分的结果和给定的 $\\ln \\gamma_1(x_1)$，重建 $\\ln \\gamma_2(x_1)$ 的闭合形式解析表达式，并施加适用于组分 $2$ 纯组分极限下拉乌尔定律标准态的边界条件，即 $\\gamma_2(x_1=0)=1$。\n\n3) 定义标量一致性泛函\n$$\nC \\;=\\; \\int_{0}^{1} \\Big[\\, x_1 \\,\\frac{d \\ln \\gamma_1}{d x_1} \\;+\\; x_2 \\,\\frac{d \\ln \\gamma_2}{d x_1} \\,\\Big] \\, d x_1.\n$$\n对重建的 $\\ln \\gamma_2(x_1)$ 计算 $C$ 的值，并说明在恒定 $T$ 和 $P$ 下数据是否热力学一致。\n\n你的最终答案应为 $\\ln \\gamma_2(x_1)$ 的单个闭合形式表达式（无需单位）。不要四舍五入；按给定的精确小数值提供系数。", "solution": "所给问题是化学热力学中的一个标准练习，涉及二元混合物中活度系数之间的关系。该问题具有科学依据，提法明确，内容自洽。因此，该问题是有效的，我们将着手求解。\n\n在恒定温度 $T$ 和压力 $P$ 下，支配混合物各组分化学势变化的基本关系是吉布斯-杜亥姆方程。对于一个摩尔数为 $n_1$ 和 $n_2$ 的二元混合物，该方程为：\n$$\nn_1 d\\mu_1 + n_2 d\\mu_2 = 0\n$$\n除以总摩尔数 $n_T = n_1 + n_2$，我们得到用摩尔分数 $x_i=n_i/n_T$ 表示的方程：\n$$\nx_1 d\\mu_1 + x_2 d\\mu_2 = 0\n$$\n液体混合物中某组分的化学势 $\\mu_i$（以纯液体为标准态）由下式给出：\n$$\n\\mu_i(T,P,\\{x_j\\}) = \\mu_i^{\\ast}(T,P) + R T \\ln(\\gamma_i x_i)\n$$\n其中 $\\mu_i^{\\ast}$ 是纯组分 $i$ 在相同 $T$ 和 $P$ 下的化学势。在恒定 $T$ 和 $P$ 下 $\\mu_i$ 的微分为：\n$$\nd\\mu_i = R T \\, d[\\ln(\\gamma_i x_i)] = R T (d\\ln\\gamma_i + d\\ln x_i)\n$$\n将此代入吉布斯-杜亥姆方程得到：\n$$\nx_1 R T (d\\ln\\gamma_1 + d\\ln x_1) + x_2 R T (d\\ln\\gamma_2 + d\\ln x_2) = 0\n$$\n常数项 $R T$ 可以消去。我们得到：\n$$\nx_1 d\\ln\\gamma_1 + x_2 d\\ln\\gamma_2 + x_1 d\\ln x_1 + x_2 d\\ln x_2 = 0\n$$\n最后两项可以简化：$x_1 d\\ln x_1 + x_2 d\\ln x_2 = x_1(\\frac{dx_1}{x_1}) + x_2(\\frac{dx_2}{x_2}) = dx_1 + dx_2$。由于 $x_1 + x_2 = 1$，它们的微分之和必须为零，$dx_1 + dx_2 = 0$。因此，吉布斯-杜亥姆方程简化为仅与活度系数相关的关系式：\n$$\nx_1 d\\ln\\gamma_1 + x_2 d\\ln\\gamma_2 = 0\n$$\n这就是第 (1) 部分所要求的组成-微分关系。\n\n对于第 (2) 部分，我们必须求出 $\\ln\\gamma_2(x_1)$ 的表达式。我们可以将微分关系表示为关于 $x_1$ 的导数，并注意到 $x_2=1-x_1$：\n$$\nx_1 \\frac{d\\ln\\gamma_1}{dx_1} + x_2 \\frac{d\\ln\\gamma_2}{dx_1} = 0\n$$\n重新整理以求解 $\\ln\\gamma_2$ 的导数：\n$$\n\\frac{d\\ln\\gamma_2}{dx_1} = -\\frac{x_1}{x_2} \\frac{d\\ln\\gamma_1}{dx_1} = -\\frac{x_1}{1-x_1} \\frac{d\\ln\\gamma_1}{dx_1}\n$$\n题目给出了 $\\ln\\gamma_1$ 的模型：\n$$\n\\ln \\gamma_1(x_1) = A(1-x_1)^2 + B(1-x_1)^3\n$$\n我们首先计算它关于 $x_1$ 的导数：\n$$\n\\frac{d\\ln\\gamma_1}{dx_1} = A \\cdot 2(1-x_1)(-1) + B \\cdot 3(1-x_1)^2(-1) = -2A(1-x_1) - 3B(1-x_1)^2\n$$\n现在，将此导数代入 $\\frac{d\\ln\\gamma_2}{dx_1}$ 的表达式中：\n$$\n\\frac{d\\ln\\gamma_2}{dx_1} = -\\frac{x_1}{1-x_1} \\left[ -2A(1-x_1) - 3B(1-x_1)^2 \\right]\n$$\n简化此表达式：\n$$\n\\frac{d\\ln\\gamma_2}{dx_1} = x_1 \\left[ 2A + 3B(1-x_1) \\right] = 2Ax_1 + 3Bx_1 - 3Bx_1^2 = (2A+3B)x_1 - 3Bx_1^2\n$$\n为了求出 $\\ln\\gamma_2(x_1)$，我们必须将此表达式对 $x_1$ 进行积分。边界条件是当 $x_2 = 1$ 时 $\\gamma_2 = 1$，这对应于 $x_1 = 0$。因此，$\\ln\\gamma_2(x_1=0) = \\ln(1) = 0$。我们从参考点 $x_1=0$ 积分到任意组成 $x_1$：\n$$\n\\int_{0}^{\\ln\\gamma_2(x_1)} d(\\ln\\gamma_2) = \\int_{0}^{x_1} \\left[ (2A+3B)\\xi - 3B\\xi^2 \\right] d\\xi\n$$\n$$\n\\ln\\gamma_2(x_1) - \\ln\\gamma_2(0) = \\left[ (2A+3B)\\frac{\\xi^2}{2} - 3B\\frac{\\xi^3}{3} \\right]_0^{x_1}\n$$\n由于 $\\ln\\gamma_2(0)=0$：\n$$\n\\ln\\gamma_2(x_1) = \\left(A + \\frac{3}{2}B\\right)x_1^2 - Bx_1^3\n$$\n这就是 $\\ln\\gamma_2(x_1)$ 的闭合形式解析表达式。为了按要求提供最终答案，我们代入常数 $A=1.10$ 和 $B=-0.30$ 的给定数值：\n$$\nA + \\frac{3}{2}B = 1.10 + \\frac{3}{2}(-0.30) = 1.10 - 0.45 = 0.65\n$$\n$$\n-B = -(-0.30) = 0.30\n$$\n所以，$\\ln \\gamma_2$ 的最终表达式是：\n$$\n\\ln\\gamma_2(x_1) = 0.65 x_1^2 + 0.30 x_1^3\n$$\n\n对于第 (3) 部分，我们必须计算一致性泛函 $C$：\n$$\nC = \\int_{0}^{1} \\left[ x_1 \\frac{d \\ln \\gamma_1}{d x_1} + x_2 \\frac{d \\ln \\gamma_2}{d x_1} \\right] d x_1\n$$\n被积函数恰好是恒定 $T$ 和 $P$ 下的吉布斯-杜亥姆方程中的表达式。\n$$\nx_1 \\frac{d \\ln \\gamma_1}{d x_1} + x_2 \\frac{d \\ln \\gamma_2}{d x_1} = 0\n$$\n对于一个热力学一致的活度系数模型，这个关系必须成立。在第 (2) 部分，我们正是通过强制执行这个条件来推导 $\\ln\\gamma_2$ 的表达式的。因此，对于所有 $x_1 \\in [0,1]$，被积函数恒为零。积分因此为：\n$$\nC = \\int_{0}^{1} 0 \\, d x_1 = 0\n$$\n$C=0$ 的值表明 $\\ln\\gamma_1$ 的模型和推导出的 $\\ln\\gamma_2$ 模型彼此是热力学一致的。\n\n题目要求以 $\\ln\\gamma_2(x_1)$ 的单个闭合形式表达式作为最终答案。根据我们的推导和代入给定系数，结果是 $\\ln\\gamma_2(x_1) = 0.65x_1^2 + 0.30x_1^3$。", "answer": "$$\\boxed{0.65 x_1^2 + 0.30 x_1^3}$$", "id": "2927970"}, {"introduction": "将抽象的热力学理论应用于实际计算是化学研究中的一项核心能力。本练习要求您设计一个数值方案，通过对基本热力学关系 $(\\partial \\mu / \\partial P)_T = \\bar{V}$ 进行积分来计算真实流体的化学势，其中摩尔体积 $\\bar{V}$ 由彭-罗宾逊状态方程确定。通过将数值积分结果与状态方程的标准解析解进行比较，您可以验证计算的准确性，并深入理解化学势的物理意义和计算方法。[@problem_id:2927949]", "problem": "您的任务是设计并实现一个数值方案，使用 Peng–Robinson 状态方程 (PR EOS) 来计算真实流体的剩余化学势，并将结果与逸度系数表达式进行验证。目标是在固定温度下，通过对定义性的导数关系进行数值积分来计算剩余化学势，并与 PR EOS 逸度系数公式的闭合形式剩余化学势进行交叉检验。您的实现必须是一个完整、可运行的程序。\n\n您可以使用的基本原理：\n- 纯物质化学势的定义以及麦克斯韦关系，即在恒温下，化学势的导数等于摩尔体积，即 $(\\partial \\mu/\\partial P)_{T} = \\bar{V}$。\n- 理想气体表达式 $(\\partial \\mu^{\\mathrm{ig}}/\\partial P)_{T} = RT/P$。\n- 标准热力学参考文献中 Peng–Robinson 状态方程对纯组分的已知函数形式及其逸度系数公式。\n\n目标量与验证：\n- 将剩余化学势 $\\mu^{R}(T,P)$ 定义为 $\\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P)$。使用恒等式\n$$\n\\left(\\frac{\\partial \\mu^{R}}{\\partial P}\\right)_{T} = \\bar{V}(T,P) - \\frac{RT}{P}.\n$$\n- 数值计算\n$$\n\\mu^{R}(T,P) = \\int_{P_{0}}^{P}\\left[\\bar{V}(T,p) - \\frac{RT}{p}\\right]\\, dp,\n$$\n其中 $P_{0}$ 是一个足够小的正数，以确保积分是良定义的且数值稳定，并且 $\\bar{V}(T,p)$ 是在 $(T,p)$ 条件下由 PR EOS 气相根计算出的摩尔体积。\n- 独立地通过 PR EOS 逸度系数关系 $\\mu^{R}(T,P) = RT \\ln \\phi(T,P)$ 计算 $\\mu^{R}(T,P)$，其中 $\\ln \\phi(T,P)$ 是标准 PR EOS 对纯组分的闭合形式表达式。您不得假定任何超出标准文献范围的特定代数重排。\n\n设计约束：\n- 对纯物质使用 Peng–Robinson 状态方程，采用单组分的标准参数：\n  - 参数：\n    - $a = 0.45724 \\dfrac{R^{2} T_{c}^{2}}{P_{c}} \\alpha(T,\\omega)$,\n    - $b = 0.07780 \\dfrac{R T_{c}}{P_{c}}$,\n    - $\\alpha(T,\\omega) = \\left[1 + \\kappa(\\omega) \\left(1 - \\sqrt{T/T_{c}}\\right)\\right]^{2}$,\n    - $\\kappa(\\omega) = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^{2}$.\n  - 使用压缩因子 $Z$ 来表示，Peng–Robinson 三次方程可以用无量纲形式写出，其中\n    $A = aP/(R^{2}T^{2})$ 且 $B = bP/(RT)$。求解该三次方程得到 $Z$，并在每个 $(T,P)$ 点选择气相根（最大的实数根）。\n- 在每个 $(T,P)$ 状态下，将摩尔体积计算为 $\\bar{V} = ZRT/P$。\n\n单位与常数：\n- 全程使用国际单位制 (SI)。温度必须以 $\\mathrm{K}$ 为单位，压力以 $\\mathrm{Pa}$ 为单位，体积以 $\\mathrm{m^{3}\\,mol^{-1}}$ 为单位，化学势以 $\\mathrm{J\\,mol^{-1}}$ 为单位。\n- 使用普适气体常数 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 在您的积分中，使用一个严格为正的下限 $P_{0}$（例如，$P_{0} = 1.0\\ \\mathrm{Pa}$），以避免被积函数在 $P=0$ 处的奇点。请证明当 $P \\gg P_{0}$ 时，这不会对积分值产生实质性影响。\n\n数值方案要求：\n- 使用稳定的求根方法求解关于 $Z$ 的三次方程；例如，计算所有根并选择适当的实数根。\n- 实现一个可靠的数值求积方法进行压力积分。您可以使用复合方法或自适应方案，以达到一个小的绝对误差容限。您的积分必须能够处理被积函数在许多压力点上涉及内部非线性 EOS 求解的事实。\n\n测试套件：\n对于下方的每个测试用例，计算绝对差\n$$\n\\Delta(T,P) = \\left|\\mu^{R}_{\\mathrm{integral}}(T,P) - RT\\ln\\phi(T,P)\\right|\n$$\n单位为 $\\mathrm{J\\,mol^{-1}}$，在相同的 $(T,P)$ 条件下，对相同的纯组分使用 PR EOS。您的程序应评估所有用例，并以指定的输出格式返回结果。\n\n使用的组分数据：\n- 甲烷：$T_{c} = 190.564\\ \\mathrm{K}$，$P_{c} = 4.5992\\times 10^{6}\\ \\mathrm{Pa}$，$\\omega = 0.01142$。\n- 二氧化碳：$T_{c} = 304.1282\\ \\mathrm{K}$，$P_{c} = 7.3773\\times 10^{6}\\ \\mathrm{Pa}$，$\\omega = 0.22394$。\n- 正丁烷：$T_{c} = 425.12\\ \\mathrm{K}$，$P_{c} = 3.796\\times 10^{6}\\ \\mathrm{Pa}$，$\\omega = 0.200$。\n\n待评估的测试用例：\n- 用例 1（常规路径，稀释气体）：甲烷在 $T = 300\\ \\mathrm{K}$ 和 $P = 1.0\\times 10^{5}\\ \\mathrm{Pa}$。\n- 用例 2（中等压力，超临界）：甲烷在 $T = 220\\ \\mathrm{K}$ 和 $P = 3.0\\times 10^{6}\\ \\mathrm{Pa}$。\n- 用例 3（高压，超临界）：二氧化碳在 $T = 400\\ \\mathrm{K}$ 和 $P = 5.0\\times 10^{6}\\ \\mathrm{Pa}$。\n- 用例 4（重组分，中等压力）：正丁烷在 $T = 450\\ \\mathrm{K}$ 和 $P = 2.0\\times 10^{6}\\ \\mathrm{Pa}$。\n- 用例 5（接近临界压力）：二氧化碳在 $T = 310\\ \\mathrm{K}$ 和 $P = 7.0\\times 10^{6}\\ \\mathrm{Pa}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的 $\\Delta(T,P)$ 结果，格式为以逗号分隔的浮点数列表，采用科学记数法，保留六位有效数字，并用方括号括起来。例如：\"[1.234000e-06,5.678900e-07,3.210000e-06,4.000000e-09,1.000000e-08]\"。", "solution": "所述问题是一项定义明确的计算热力学练习。它在科学上是合理的、自洽的，并且所有提供的数据和公式都与 Peng-Robinson 状态方程 (PR EOS) 的既定原理和标准文献一致。任务是通过比较两种计算纯物质剩余化学势的方法来进行数值验证，这是科学计算中的一种标准实践。因此，该问题被认为是有效的。\n\n目标是使用两种不同但理论上等效的、源自 PR EOS 的方法，计算在指定温度 $T$ 和压力 $P$ 下纯组分的剩余化学势 $\\mu^{R}(T,P)$，然后量化它们之间的数值差异。\n\n首先，我们将剩余化学势 $\\mu^{R}$ 定义为真实流体的化学势 $\\mu$ 与同温同压下理想气体的化学势 $\\mu^{\\mathrm{ig}}$ 之差：\n$$\n\\mu^{R}(T,P) = \\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P)\n$$\n在恒温下，化学势对压力的依赖性由基本热力学关系 $(\\partial\\mu/\\partial P)_{T} = \\bar{V}$ 给出，其中 $\\bar{V}$ 是摩尔体积。对于理想气体，$\\bar{V}^{\\mathrm{ig}} = RT/P$，因此 $(\\partial\\mu^{\\mathrm{ig}}/\\partial P)_{T} = RT/P$。将这些结合起来，得到剩余化学势对压力的依赖性：\n$$\n\\left(\\frac{\\partial \\mu^{R}}{\\partial P}\\right)_{T} = \\left(\\frac{\\partial \\mu}{\\partial P}\\right)_{T} - \\left(\\frac{\\partial \\mu^{\\mathrm{ig}}}{\\partial P}\\right)_{T} = \\bar{V} - \\frac{RT}{P}\n$$\n摩尔体积 $\\bar{V}$ 将由 PR EOS 确定。\n\nPeng-Robinson 状态方程是关于压缩因子 $Z = P\\bar{V}/(RT)$ 的三次方程。PR EOS 的参数取决于物质的临界温度 $T_{c}$、临界压力 $P_{c}$ 和偏心因子 $\\omega$。\n能量参数 $a$ 和体积参数 $b$ 由下式给出：\n$$\na(T) = 0.45724 \\frac{(RT_c)^2}{P_c} \\alpha(T, \\omega)\n$$\n$$\nb = 0.07780 \\frac{RT_c}{P_c}\n$$\n其中，与温度相关的项 $\\alpha(T, \\omega)$ 为\n$$\n\\alpha(T, \\omega) = \\left[1 + \\kappa(\\omega) \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right)\\right]^2\n$$\n其中\n$$\n\\kappa(\\omega) = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2\n$$\n使用无量纲参数 $A$ 和 $B$ 会很方便：\n$$\nA = \\frac{a(T)P}{(RT)^2} \\quad \\text{和} \\quad B = \\frac{b P}{RT}\n$$\nPR EOS 可以写成一个关于 $Z$ 的三次多项式：\n$$\nZ^3 - (1-B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0\n$$\n对于指定条件（对应于气体或超临界流体），我们必须找到该多项式的根，并选择最大的实数根，它对应于气相压缩因子。这需要一个数值求根算法。\n\n计算 $\\mu^{R}$ 的第一种方法是直接对其压力导数进行积分。从参考压力 $P_0$ 积分到目标压力 $P$ 可得：\n$$\n\\mu^{R}(T,P) - \\mu^{R}(T,P_0) = \\int_{P_0}^{P} \\left(\\bar{V}(T,p) - \\frac{RT}{p}\\right) dp\n$$\n我们选择 $P_0$ 为一个非常低的压力（例如 $1.0\\ \\mathrm{Pa}$），在此压力下流体行为近似于理想气体。在理想气体极限下，$\\mu^{R} \\to 0$。因此，我们可以近似认为 $\\mu^{R}(T,P_0) \\approx 0$。这种近似引入的误差量级为 $P_0(b - a/RT)$，对于足够小的 $P_0$ 来说可以忽略不计。该积分可以用压缩因子 $Z$ 重写：\n$$\n\\mu^{R}_{\\mathrm{integral}}(T,P) = \\int_{P_0}^{P} \\left(\\frac{Z(T,p)RT}{p} - \\frac{RT}{p}\\right) dp = \\int_{P_0}^{P} \\frac{RT}{p}(Z(T,p)-1) dp\n$$\n这个定积分使用数值求积法计算。对于求积算法所需的每个压力点 $p$，我们都必须求解 PR EOS 三次方程以得到 $Z(T,p)$。\n\n第二种方法使用从 PR EOS 推导出的逸度系数 $\\phi$ 的解析表达式。剩余化学势直接由 $\\mu^{R} = RT \\ln\\phi$ 给出。对于纯组分，其表达式为：\n$$\n\\ln\\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln\\left(\\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B}\\right)\n$$\n要使用此公式，我们首先在目标状态 $(T, P)$ 计算 $A$ 和 $B$，然后求解 PR EOS 得到相应的气相根 $Z$。接着将这些值代入表达式中计算 $\\ln\\phi$，并随后计算 $\\mu^{R}_{\\mathrm{analytical}}(T,P) = RT \\ln\\phi$。\n\n最后一步是为每个指定的测试用例计算绝对差 $\\Delta(T,P) = |\\mu^{R}_{\\mathrm{integral}}(T,P) - \\mu^{R}_{\\mathrm{analytical}}(T,P)|$。一个小的 $\\Delta$ 值将验证数值积分方案的正确性以及底层热力学模型的实现。\n\n算法流程如下：\n1. 对于每个测试用例，获取组分属性（$T_c, P_c, \\omega$）和状态条件（$T, P$）。\n2. 实现一个函数，对于任意给定的 ($T, p$)，该函数计算参数 $a(T)$ 和 $b$，然后计算 $A$ 和 $B$，求解 PR 三次方程得到 $Z$，并返回最大的实数根。\n3. 对于方法 1，定义被积函数 $f(p) = \\frac{RT}{p}(Z(T,p)-1)$。使用一个数值求积程序（例如 `scipy.integrate.quad`）来计算 $\\mu^{R}_{\\mathrm{integral}} = \\int_{P_0}^{P} f(p) dp$，其中 $P_0 = 1.0\\ \\mathrm{Pa}$。\n4. 对于方法 2，使用步骤 2 中的函数在最终状态 $(T, P)$ 找到 $Z, A, B$。将这些值代入 $\\ln\\phi$ 的解析公式中，以计算 $\\mu^{R}_{\\mathrm{analytical}}$。\n5. 计算绝对差 $\\Delta$ 并报告。对所有测试用例重复此过程。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the residual chemical potential of a pure fluid using the Peng-Robinson\n    EOS via two methods (numerical integration and analytical formula) and\n    calculates the absolute difference between them for a set of test cases.\n    \"\"\"\n\n    # Universal gas constant in SI units (J mol^-1 K^-1)\n    R_CONST = 8.31446261815324\n\n    # Pure component data: Tc (K), Pc (Pa), omega (acentric factor)\n    COMPONENTS = {\n        'methane': {'tc': 190.564, 'pc': 4.5992e6, 'omega': 0.01142},\n        'co2': {'tc': 304.1282, 'pc': 7.3773e6, 'omega': 0.22394},\n        'n_butane': {'tc': 425.12, 'pc': 3.796e6, 'omega': 0.200}\n    }\n\n    # Test cases: component, T (K), P (Pa)\n    test_cases = [\n        {'comp': 'methane', 'T': 300.0, 'P': 1.0e5},\n        {'comp': 'methane', 'T': 220.0, 'P': 3.0e6},\n        {'comp': 'co2', 'T': 400.0, 'P': 5.0e6},\n        {'comp': 'n_butane', 'T': 450.0, 'P': 2.0e6},\n        {'comp': 'co2', 'T': 310.0, 'P': 7.0e6}\n    ]\n\n    results = []\n    \n    # Lower integration limit for pressure (Pa)\n    P0 = 1.0\n\n    def get_pr_z(T, P, tc, pc, omega):\n        \"\"\"\n        Calculates the vapor-phase compressibility factor Z using the PR EOS.\n        Returns Z, A, and B.\n        \"\"\"\n        Tr = T / tc\n        \n        kappa = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n        alpha = (1 + kappa * (1 - np.sqrt(Tr)))**2\n        \n        a = 0.45724 * (R_CONST * tc)**2 / pc * alpha\n        b = 0.07780 * R_CONST * tc / pc\n        \n        A = a * P / (R_CONST * T)**2\n        B = b * P / (R_CONST * T)\n        \n        # Coefficients of the cubic equation for Z: Z^3 + c2*Z^2 + c1*Z + c0 = 0\n        c2 = B - 1\n        c1 = A - 3 * B**2 - 2 * B\n        c0 = B**2 + B**3 - A * B\n        \n        coeffs = [1, c2, c1, c0]\n        roots = np.roots(coeffs)\n        \n        # Select the largest real root (vapor phase)\n        real_roots = roots[np.isreal(roots)].real\n        if len(real_roots) == 0:\n            # Should not happen for these cases, but as a fallback\n            raise ValueError(\"No real roots found for Z.\")\n        \n        Z = np.max(real_roots)\n        \n        return Z, A, B\n\n    for case in test_cases:\n        comp_data = COMPONENTS[case['comp']]\n        T = case['T']\n        P = case['P']\n        tc, pc, omega = comp_data['tc'], comp_data['pc'], comp_data['omega']\n\n        # Method 1: Numerical Integration\n        def integrand(p, T_arg, tc_arg, pc_arg, omega_arg):\n            if p == 0:\n                # The limit exists, but to avoid division by zero, we handle p=0\n                # or rely on the integrator which won't sample exactly at zero.\n                # Here, we calculate limit of (Z-1)/p as p-0.\n                # Z-1 ~ B-A as p-0. (Z-1)/p ~ b/(RT) - a/(RT)^2.\n                # The integrand (RT/p)(Z-1) approaches b - a/RT.\n                Tr_arg = T_arg / tc_arg\n                kappa = 0.37464 + 1.54226 * omega_arg - 0.26992 * omega_arg**2\n                alpha = (1 + kappa * (1 - np.sqrt(Tr_arg)))**2\n                a_val = 0.45724 * (R_CONST * tc_arg)**2 / pc_arg * alpha\n                b_val = 0.07780 * R_CONST * tc_arg / pc_arg\n                return b_val - a_val / (R_CONST * T_arg)\n            \n            Z_p, _, _ = get_pr_z(T_arg, p, tc_arg, pc_arg, omega_arg)\n            return R_CONST * T_arg * (Z_p - 1) / p\n\n        # SciPy's quad integration\n        mu_R_integral, _ = integrate.quad(integrand, P0, P, args=(T, tc, pc, omega))\n        \n        # Method 2: Analytical Formula\n        Z, A, B = get_pr_z(T, P, tc, pc, omega)\n        \n        # Check for non-positive arguments in logs\n        if Z == B:\n            raise ValueError(f\"Z = B encountered. Z={Z}, B={B}\")\n        \n        term1 = Z - 1\n        term2 = -np.log(Z - B)\n        log_arg_numerator = Z + (1 + np.sqrt(2)) * B\n        log_arg_denominator = Z + (1 - np.sqrt(2)) * B\n        \n        if log_arg_numerator = 0 or log_arg_denominator = 0:\n            raise ValueError(\"Log argument for fugacity calculation is non-positive.\")\n            \n        term3 = -(A / (2 * np.sqrt(2) * B)) * np.log(log_arg_numerator / log_arg_denominator)\n        \n        ln_phi = term1 + term2 + term3\n        mu_R_analytical = R_CONST * T * ln_phi\n        \n        # Calculate absolute difference\n        abs_diff = np.abs(mu_R_integral - mu_R_analytical)\n        results.append(abs_diff)\n\n    # Format output as specified\n    output_str = f\"[{','.join(f'{res:.6e}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2927949"}]}