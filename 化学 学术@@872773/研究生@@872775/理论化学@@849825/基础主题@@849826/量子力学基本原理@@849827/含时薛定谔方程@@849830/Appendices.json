{"hands_on_practices": [{"introduction": "在量子动力学中，哈密顿量的瞬时改变是一种重要的理想化模型。当系统哈密顿量的变化比其内禀时间尺度快得多时，波函数来不及演化。因此，在变化发生后的瞬间，系统的状态仍然由初始波函数描述。要预测系统未来的行为，我们需要将这个初始态投影到新哈密顿量的本征态基上。这个练习 [@problem_id:537849] 将通过一个谐振子势垒瞬时改变的具体例子，让你亲手计算这种投影的概率，从而加深对“突变近似”这一核心概念的理解。", "problem": "一个质量为$m$的粒子被限制在一维谐振子势$V_0(x) = \\frac{1}{2}k_0 x^2$中。在时间$t  0$时，该粒子处于系统的基态。\n\n在时间$t=0$时，弹簧常数瞬间增大为原来的四倍，因此对于所有$t \\ge 0$，势变为$V_1(x) = \\frac{1}{2}k_1 x^2$，其中$k_1 = 4k_0$。\n\n对于势为$V(x) = \\frac{1}{2}kx^2$的一维谐振子，其归一化基态波函数由下式给出\n$$\n\\psi_0(x) = \\left(\\frac{\\sqrt{mk}}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{\\sqrt{mk}}{2\\hbar}x^2\\right)\n$$\n其中$\\hbar$是约化普朗克常数。\n\n计算在$t > 0$时对粒子进行能量测量，发现其处于*新*势$V_1(x)$的基态的概率。", "solution": "1. 定义\n$$\\alpha_0=\\frac{\\sqrt{m k_0}}{\\hbar},\\quad \\alpha_1=\\frac{\\sqrt{m k_1}}{\\hbar}=\\frac{\\sqrt{m\\,(4k_0)}}{\\hbar}=2\\alpha_0.$$\n2. 重叠系数为\n$$c_0=\\int_{-\\infty}^{\\infty}\\Bigl(\\frac{\\alpha_1}{\\pi}\\Bigr)^{1/4}e^{-\\frac{\\alpha_1x^2}{2}}\n\\Bigl(\\frac{\\alpha_0}{\\pi}\\Bigr)^{1/4}e^{-\\frac{\\alpha_0x^2}{2}}\\,dx\n=\\frac{(\\alpha_0\\alpha_1)^{1/4}}{\\sqrt{\\pi}}\n\\int_{-\\infty}^{\\infty}e^{-\\frac{\\alpha_0+\\alpha_1}{2}x^2}\\,dx.$$\n3. 使用\n$$\\int_{-\\infty}^{\\infty}e^{-B x^2}dx=\\sqrt{\\frac{\\pi}{B}},\\quad B=\\frac{\\alpha_0+\\alpha_1}{2},$$\n因此\n$$c_0=\\frac{(\\alpha_0\\alpha_1)^{1/4}}{\\sqrt{\\pi}}\\sqrt{\\frac{\\pi}{(\\alpha_0+\\alpha_1)/2}}\n=\\frac{(\\alpha_0\\alpha_1)^{1/4}}{\\sqrt{(\\alpha_0+\\alpha_1)/2}}\\,. $$\n4. 概率为\n$$P=|c_0|^2=\\frac{2\\sqrt{\\alpha_0\\alpha_1}}{\\alpha_0+\\alpha_1}\n=\\frac{2\\sqrt{\\alpha_0\\,(2\\alpha_0)}}{\\alpha_0+2\\alpha_0}\n=\\frac{2\\sqrt{2}\\,\\alpha_0}{3\\alpha_0}\n=\\frac{2\\sqrt{2}}{3}\\,. $$", "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{3}}$$", "id": "537849"}, {"introduction": "标准的量子力学理论通常处理孤立的封闭系统，其中总概率是守恒的。然而，许多现实世界的过程，如化学反应、散射或分子解离，都涉及到与环境的相互作用，导致粒子被吸收或逃逸。本练习 [@problem_id:2822589] 探讨了如何使用非厄米哈密顿量——特别是引入一个复吸收势 (Complex Absorbing Potential, CAP)——来模拟这些开放量子系统。通过推导修正后的连续性方程，你将理解这种势如何从根本上改变概率守恒定律，并为波函数提供一个“吸收”边界，这是现代计算化学中模拟开放系统的关键技术。", "problem": "考虑一个质量为$m$的非相对论性粒子在三维空间中运动，其行为由含时薛定谔方程 (TDSE) 描述，哈密顿算符为$\\hat{H} = \\hat{H}_0 - i\\,\\eta(\\mathbf{r})$。其中，$\\hat{H}_0 = -\\dfrac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})$具有实值势$V(\\mathbf{r})$，而$\\eta(\\mathbf{r}) \\ge 0$是一个实值的非负函数。项$-i\\,\\eta(\\mathbf{r})$代表一个复吸收势 (Complex Absorbing Potential, CAP)，在计算散射和动力学中用于模拟开放边界。\n\n从 TDSE 以及概率密度$\\rho(\\mathbf{r},t) = |\\psi(\\mathbf{r},t)|^2$和与$\\hat{H}_0$相关联的标准概率流的定义出发，分析 CAP 的存在如何改变连续性方程，并对由此产生的额外项进行物理解释。选择所有正确的陈述。\n\nA. 在存在局域 CAP $-i\\,\\eta(\\mathbf{r})$ 的情况下，连续性方程变为$\\partial_t \\rho(\\mathbf{r},t) + \\nabla\\!\\cdot\\!\\mathbf{j}(\\mathbf{r},t) = -\\dfrac{2}{\\hbar}\\,\\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)$，其中$\\mathbf{j}(\\mathbf{r},t)$与厄米哈密顿量$\\hat{H}_0$的概率流相同。\n\nB. CAP 为连续性方程贡献一个源项，得到$\\partial_t \\rho(\\mathbf{r},t) + \\nabla\\!\\cdot\\!\\mathbf{j}(\\mathbf{r},t) = +\\dfrac{2}{\\hbar}\\,\\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)$，因此在$\\eta(\\mathbf{r})>0$的区域，概率密度被局域放大。\n\nC. CAP 通过增加一个显式的梯度项改变了概率流的定义，得到$\\mathbf{j}(\\mathbf{r},t) \\to \\mathbf{j}(\\mathbf{r},t) - \\dfrac{\\hbar}{m}\\,\\rho(\\mathbf{r},t)\\,\\nabla \\eta(\\mathbf{r})$。\n\nD. 如果流是无散的，CAP 的存在会导致吸收区域的概率密度呈指数增长，形式为$\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0)\\,\\exp\\!\\big(+\\dfrac{\\eta(\\mathbf{r})}{\\hbar}\\,t\\big)$。\n\nE. 在$\\eta(\\mathbf{r})$空间均匀且流是无散的区域，概率密度局域衰减，形式为$\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0)\\,\\exp\\!\\big(-\\dfrac{2\\eta}{\\hbar}\\,t\\big)$。\n\nF. 总概率（范数）不守恒；其变化率为$\\dfrac{d}{dt}\\int \\rho(\\mathbf{r},t)\\,d^3\\mathbf{r} = -\\dfrac{2}{\\hbar}\\int \\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)\\,d^3\\mathbf{r}$，如果$\\eta(\\mathbf{r}) \\ge 0$，该变化率为非正。", "solution": "首先应验证问题陈述的科学性和逻辑完整性。\n\n### 第 1 步：提取已知条件\n- 一个质量为 $m$ 的非相对论性粒子在三维空间中。\n- 控制方程是含时薛定谔方程 (TDSE)。\n- 哈密顿算符为 $\\hat{H} = \\hat{H}_0 - i\\,\\eta(\\mathbf{r})$。\n- 哈密顿量的厄米部分是 $\\hat{H}_0 = -\\dfrac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})$，其中 $V(\\mathbf{r})$ 是一个实值势。\n- 非厄米部分由 $-i\\,\\eta(\\mathbf{r})$ 给出，其中 $\\eta(\\mathbf{r}) \\ge 0$ 是一个实值的非负函数，称为复吸收势 (CAP)。\n- 概率密度定义为 $\\rho(\\mathbf{r},t) = |\\psi(\\mathbf{r},t)|^2 = \\psi^*(\\mathbf{r},t)\\psi(\\mathbf{r},t)$。\n- 概率流是“与 $\\hat{H}_0$ 相关联的标准概率流”。这是对标准定义 $\\mathbf{j}(\\mathbf{r},t) = \\dfrac{\\hbar}{2mi}\\left(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*\\right)$ 的明确引用。\n- 任务是在存在 CAP 的情况下推导修正的连续性方程，解释其结果，并评估给定的陈述。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个非厄米量子系统。使用复势，特别是形式为 $-i\\eta(\\mathbf{r})$ 且 $\\eta(\\mathbf{r}) \\ge 0$ 的复势，是理论和计算化学及物理学中一种标准且具有物理意义的技术，用于模拟开放量子系统，描述粒子的耗散或吸收。其表述是正确的，并基于已建立的原理。\n- **良态问题**：这是一个良态问题。它要求在修正的哈密顿量下推导一个物理-数学方程（连续性方程）并解释其结果。这是量子力学中的一个标准练习。\n- **客观性**：问题陈述使用了精确、客观和标准的科学术语。\n- **完整性**：所有必需的定义和出发点（TDSE、哈密顿量形式、$\\rho$ 的定义）都已提供。对“标准概率流”的引用是充分的，因为这是一个普遍定义的量。\n- **其他缺陷**：该问题没有其他列出的缺陷。它不是琐碎的、隐喻性的，也不是基于不成立的前提。\n\n### 第 3 步：结论与行动\n问题陈述是有效的。可以进行严格的推导和评估。\n\n### 修正连续性方程的推导\n\n基本任务是使用给定的非厄米哈密顿量计算概率密度的时间导数 $\\dfrac{\\partial \\rho}{\\partial t}$。\n\n含时薛定谔方程为：\n$$ i\\hbar \\dfrac{\\partial\\psi}{\\partial t} = \\hat{H}\\psi = \\left(-\\dfrac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r}) - i\\eta(\\mathbf{r})\\right)\\psi $$\n这给出了波函数 $\\psi$ 的时间导数：\n$$ \\dfrac{\\partial\\psi}{\\partial t} = \\dfrac{1}{i\\hbar}\\hat{H}\\psi = \\dfrac{1}{i\\hbar}\\left(\\hat{H}_0 - i\\eta\\right)\\psi = -\\dfrac{i}{\\hbar}\\hat{H}_0\\psi - \\dfrac{\\eta}{\\hbar}\\psi $$\n\n必须取 TDSE 的复共轭。$\\hat{H}$ 的伴随算符是 $\\hat{H}^\\dagger = (\\hat{H}_0 - i\\eta)^\\dagger = \\hat{H}_0^\\dagger - (-i)\\eta^\\dagger$。由于 $\\hat{H}_0$ 是厄米的，所以 $\\hat{H}_0^\\dagger = \\hat{H}_0$。由于 $\\eta$ 是一个实函数（乘法算符），它也是厄米的，$\\eta^\\dagger = \\eta$。因此，$\\hat{H}^\\dagger = \\hat{H}_0 + i\\eta$。$\\psi^*$ 的 TDSE 是：\n$$ -i\\hbar \\dfrac{\\partial\\psi^*}{\\partial t} = (\\hat{H}\\psi)^* = \\hat{H}^\\dagger \\psi^* = (\\hat{H}_0 + i\\eta)\\psi^* $$\n这给出了复共轭波函数 $\\psi^*$ 的时间导数：\n$$ \\dfrac{\\partial\\psi^*}{\\partial t} = \\dfrac{-1}{i\\hbar}(\\hat{H}_0 + i\\eta)\\psi^* = \\dfrac{i}{\\hbar}\\hat{H}_0\\psi^* - \\dfrac{\\eta}{\\hbar}\\psi^* $$\n\n现在，我们计算概率密度 $\\rho = \\psi^*\\psi$ 的时间导数：\n$$ \\dfrac{\\partial\\rho}{\\partial t} = \\dfrac{\\partial\\psi^*}{\\partial t}\\psi + \\psi^*\\dfrac{\\partial\\psi}{\\partial t} $$\n代入时间导数的表达式：\n$$ \\dfrac{\\partial\\rho}{\\partial t} = \\left(\\dfrac{i}{\\hbar}\\hat{H}_0\\psi^* - \\dfrac{\\eta}{\\hbar}\\psi^*\\right)\\psi + \\psi^*\\left(-\\dfrac{i}{\\hbar}\\hat{H}_0\\psi - \\dfrac{\\eta}{\\hbar}\\psi\\right) $$\n$$ \\dfrac{\\partial\\rho}{\\partial t} = \\dfrac{i}{\\hbar}\\left( (\\hat{H}_0\\psi^*)\\psi - \\psi^*(\\hat{H}_0\\psi) \\right) - \\dfrac{2\\eta}{\\hbar}\\psi^*\\psi $$\n第二项是 $-\\dfrac{2\\eta}{\\hbar}\\rho$。第一项是产生概率流散度的项。我们来分析它。由于 $\\hat{H}_0 = -\\frac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})$ 并且 $V(\\mathbf{r})$ 是实数，势能部分相互抵消：\n$$ (\\hat{H}_0\\psi^*)\\psi - \\psi^*(\\hat{H}_0\\psi) = \\left(-\\dfrac{\\hbar^2}{2m}\\nabla^2\\psi^* + V\\psi^*\\right)\\psi - \\psi^*\\left(-\\dfrac{\\hbar^2}{2m}\\nabla^2\\psi + V\\psi\\right) $$\n$$ = -\\dfrac{\\hbar^2}{2m}\\left( (\\nabla^2\\psi^*)\\psi - \\psi^*\\nabla^2\\psi \\right) $$\n使用向量恒等式 $\\nabla\\cdot(A\\mathbf{B}) = (\\nabla A)\\cdot\\mathbf{B} + A(\\nabla\\cdot\\mathbf{B})$，我们可以将其写成一个散度：\n$$ (\\nabla^2\\psi^*)\\psi - \\psi^*\\nabla^2\\psi = \\nabla\\cdot((\\nabla\\psi^*)\\psi - \\psi^*\\nabla\\psi) $$\n所以，$\\dfrac{\\partial\\rho}{\\partial t}$ 表达式中的第一项变为：\n$$ \\dfrac{i}{\\hbar}\\left( -\\dfrac{\\hbar^2}{2m} \\nabla\\cdot((\\nabla\\psi^*)\\psi - \\psi^*\\nabla\\psi) \\right) = \\dfrac{i\\hbar}{2m} \\nabla\\cdot(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*) $$\n标准概率流密度定义为 $\\mathbf{j} = \\dfrac{\\hbar}{2mi}(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*)$。其散度为：\n$$ \\nabla\\cdot\\mathbf{j} = \\nabla\\cdot\\left( \\dfrac{\\hbar}{2mi}(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*) \\right) = -\\dfrac{i\\hbar}{2m}\\nabla\\cdot(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*) $$\n比较这两个表达式，我们看到我们推导出的项是 $-\\nabla\\cdot\\mathbf{j}$。\n注意符号变化：$\\dfrac{i\\hbar}{2m} \\nabla\\cdot(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*) = -(-\\dfrac{i\\hbar}{2m}\\nabla\\cdot(\\psi^*\\nabla\\psi - \\psi\\nabla\\psi^*)) = -(\\nabla\\cdot\\mathbf{j})$。\n\n结合各项，我们得到修正的连续性方程：\n$$ \\dfrac{\\partial\\rho}{\\partial t} = -\\nabla\\cdot\\mathbf{j} - \\dfrac{2\\eta}{\\hbar}\\rho $$\n或者，以标准形式：\n$$ \\dfrac{\\partial\\rho(\\mathbf{r},t)}{\\partial t} + \\nabla\\cdot\\mathbf{j}(\\mathbf{r},t) = -\\dfrac{2}{\\hbar}\\eta(\\mathbf{r})\\rho(\\mathbf{r},t) $$\n右手边的项是一个“汇”项。由于 $\\eta(\\mathbf{r}) \\ge 0$ 和 $\\rho(\\mathbf{r},t) \\ge 0$，某一点的概率密度变化率因 CAP 而减小，这代表了吸收。\n\n### 逐项分析\n\n**A. 在存在局域 CAP $-i\\,\\eta(\\mathbf{r})$ 的情况下，连续性方程变为 $\\partial_t \\rho(\\mathbf{r},t) + \\nabla\\!\\cdot\\!\\mathbf{j}(\\mathbf{r},t) = -\\dfrac{2}{\\hbar}\\,\\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)$，其中 $\\mathbf{j}(\\mathbf{r},t)$ 与厄米哈密顿量 $\\hat{H}_0$ 的概率流相同。**\n这个陈述与我们的推导结果完全匹配。推导表明，流 $\\mathbf{j}(\\mathbf{r},t)$ 的标准形式得以保留，而非厄米势引入了一个新的局域汇项。\n结论：**正确**。\n\n**B. CAP 为连续性方程贡献一个源项，得到 $\\partial_t \\rho(\\mathbf{r},t) + \\nabla\\!\\cdot\\!\\mathbf{j}(\\mathbf{r},t) = +\\dfrac{2}{\\hbar}\\,\\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)$，因此在 $\\eta(\\mathbf{r})0$ 的区域，概率密度被局域放大。**\n该陈述中汇/源项的符号不正确。正号意味着概率的产生（放大），这对应于一个发射势 $+i\\eta$。问题指定的是吸收势 $-i\\eta$。\n结论：**不正确**。\n\n**C. CAP 通过增加一个显式的梯度项改变了概率流的定义，得到 $\\mathbf{j}(\\mathbf{r},t) \\to \\mathbf{j}(\\mathbf{r},t) - \\dfrac{\\hbar}{m}\\,\\rho(\\mathbf{r},t)\\,\\nabla \\eta(\\mathbf{r})$。**\n推导表明，使用概率流 $\\mathbf{j}(\\mathbf{r},t)$ 的标准定义可以很好地写出连续性方程。CAP 的效应表现为一个局域汇项，而不是对流算符本身的修改。流算符与动量算符相关，动量算符是 $\\hat{H}_0$ 的一部分，而不是势能项的一部分。\n结论：**不正确**。\n\n**D. 如果流是无散的，CAP 的存在会导致吸收区域的概率密度呈指数增长，形式为 $\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0)\\,\\exp\\!\\big(+\\dfrac{\\eta(\\mathbf{r})}{\\hbar}\\,t\\big)$。**\n如果流是无散的，$\\nabla\\cdot\\mathbf{j}(\\mathbf{r},t)=0$。修正的连续性方程简化为关于时间的局域常微分方程：\n$$ \\dfrac{\\partial\\rho}{\\partial t} = -\\dfrac{2\\eta(\\mathbf{r})}{\\hbar}\\rho(\\mathbf{r},t) $$\n该方程的解是 $\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0) \\exp\\left(-\\dfrac{2\\eta(\\mathbf{r})}{\\hbar}t\\right)$。\n该选项提出了指数增长（指数中的正号）并且漏掉了因子 $2$。两者都是不正确的。\n结论：**不正确**。\n\n**E. 在 $\\eta(\\mathbf{r})$ 空间均匀且流是无散的区域，概率密度局域衰减，形式为 $\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0)\\,\\exp\\!\\big(-\\dfrac{2\\eta}{\\hbar}\\,t\\big)$。**\n正如为选项 D 推导的那样，如果 $\\nabla\\cdot\\mathbf{j}=0$，连续性方程变为 $\\dfrac{\\partial\\rho}{\\partial t} = -\\dfrac{2\\eta}{\\hbar}\\rho$。对于空间均匀的 $\\eta$，解确实是 $\\rho(\\mathbf{r},t) = \\rho(\\mathbf{r},0) \\exp\\left(-\\dfrac{2\\eta}{\\hbar}t\\right)$。这描述了指数衰减。\n结论：**正确**。\n\n**F. 总概率（范数）不守恒；其变化率为 $\\dfrac{d}{dt}\\int \\rho(\\mathbf{r},t)\\,d^3\\mathbf{r} = -\\dfrac{2}{\\hbar}\\int \\eta(\\mathbf{r})\\,\\rho(\\mathbf{r},t)\\,d^3\\mathbf{r}$，如果 $\\eta(\\mathbf{r}) \\ge 0$，该变化率为非正。**\n为了求总概率 $P(t) = \\int \\rho(\\mathbf{r},t)\\,d^3\\mathbf{r}$ 的变化率，我们将修正的连续性方程在全空间积分：\n$$ \\dfrac{d P(t)}{dt} = \\int \\dfrac{\\partial\\rho}{\\partial t} d^3\\mathbf{r} = \\int \\left(-\\nabla\\cdot\\mathbf{j} - \\dfrac{2\\eta}{\\hbar}\\rho\\right) d^3\\mathbf{r} $$\n$$ \\dfrac{d P(t)}{dt} = -\\int (\\nabla\\cdot\\mathbf{j})\\,d^3\\mathbf{r} - \\dfrac{2}{\\hbar}\\int \\eta(\\mathbf{r})\\rho(\\mathbf{r},t)\\,d^3\\mathbf{r} $$\n第一个积分可以使用散度定理转换为无穷远处的面积分：$\\int_V (\\nabla\\cdot\\mathbf{j})\\,d^3\\mathbf{r} = \\oint_{\\partial V} \\mathbf{j}\\cdot d\\mathbf{S}$。对于任何物理上现实的、可归一化的波函数，$\\psi$ 及其导数在无穷远处为零，这意味着 $\\mathbf{j}$ 在无穷远处也为零。因此，面积分为零。\n这样剩下：\n$$ \\dfrac{d P(t)}{dt} = -\\dfrac{2}{\\hbar}\\int \\eta(\\mathbf{r})\\rho(\\mathbf{r},t)\\,d^3\\mathbf{r} $$\n这与给出的表达式相匹配。由于 $\\eta(\\mathbf{r}) \\ge 0$ 且 $\\rho(\\mathbf{r},t) = |\\psi|^2 \\ge 0$，被积函数总是非负的。因此，积分是非负的，其与 $-\\dfrac{2}{\\hbar}$ 的乘积是非正的。这表明总概率不守恒，只能减少或保持不变。\n结论：**正确**。", "answer": "$$\\boxed{AEF}$$", "id": "2822589"}, {"introduction": "虽然解析解对于建立物理直觉至关重要，但大多数与化学相关的实际问题都过于复杂，无法手动求解。本练习 [@problem_id:2822573] 将带领你从理论分析进入计算量子动力学的实践领域。你将亲手实现分裂算符傅里叶方法 (split-operator Fourier method)，这是一种功能强大且广泛用于数值传播波包的算法。通过完成这个练习，你将直接体验现代理论化学研究中使用的核心工具，并深入理解数值求解含时薛定谔方程的原理和挑战。", "problem": "实现一个用于求解瞬时薛定谔方程的一维数值传播子，该传播子基于对称分裂算符分解，适用于形式为$H(t)=T+V(t)$的哈密顿量，其中$T=\\hat{p}^{2}/2m$，$V(t)=V(\\hat{x},t)$。完全在无量纲单位下进行计算，使得$\\hbar=1$和$m=1$。三角函数中的角度必须使用弧度。程序必须使用周期性空间网格和离散傅里叶变换，在波矢空间中实现动能算符。所用的空间傅里叶变换应采用能在离散网格上使其成为幺正的归一化。\n\n从瞬时薛定谔方程$i\\,\\partial_{t}\\psi(t)=H(t)\\psi(t)$以及上述$T$和$V(t)$的定义出发，实现一个单步传播子，该传播子使用势能在时间上的中点采样，并使用$T$和$V$的指数的对称乘积来近似从$t$到$t+\\Delta t$的时间顺序演化。然后，通过自收敛性研究，分析并验证你的实现在$\\Delta t$上的二阶精度。\n\n数值设置必须如下。\n\n- 空间网格和变换：\n  - 使用$N=1024$个等距网格点，覆盖一个以$x=0$为中心、长度为$L=200$的区间，即$x\\in[-L/2,L/2)$。\n  - 使用与该空间网格上的幺正离散傅里叶变换相对应的波矢网格$k$。\n  - 使用幺正离散傅里叶变换，以使离散$\\ell^{2}$范数$\\|\\psi\\|_{h}^{2}=\\sum_{j=0}^{N-1}|\\psi_{j}|^{2}$在变换中保持不变。\n\n- 初始态：\n  - 使用一个高斯波包，其中心为$x_{0}=-10$，宽度为$\\sigma=1.0$，平均波矢为$k_{0}=2.0$，即\n    $$\\psi_{0}(x)=C\\exp\\!\\left(-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+i\\,k_{0}(x-x_{0})\\right),$$\n    其中$C$的选择应使离散范数等于$1$。\n\n- 势：\n  - 驱动谐振子阱（含时）：$$V_{\\mathrm{drv}}(x,t)=\\tfrac{1}{2}\\,\\omega^{2}x^{2}+E_{0}\\,x\\cos(\\Omega t),$$ 其中$\\omega=0.2$，$E_{0}=0.1$，$\\Omega=1.0$。\n  - 自由粒子：$$V_{\\mathrm{free}}(x,t)=0.$$\n  - 静态谐振子阱（不含时）：$$V_{\\mathrm{ho}}(x,t)=\\tfrac{1}{2}\\,\\omega^{2}x^{2},$$ 其中$\\omega=0.2$。\n\n- 时间步进与测试：\n  - 所有传播过程必须使用对称分裂算符，对势能进行时间上的中点采样，并在$k$空间中使用精确的动能相位。\n  - 驱动阱的自收敛阶数测试：\n    - 最终时间$T=0.512$。\n    - 使用三个时间步长$\\Delta t_{1}=0.008, \\Delta t_{2}=0.004, \\Delta t_{3}=0.002$，使得每个步长都能整除$T$。\n    - 分别使用$\\Delta t_{1}$、$\\Delta t_{2}$和$\\Delta t_{3}$计算最终态$\\psi^{(1)}$、$\\psi^{(2)}$和$\\psi^{(3)}$。\n    - 通过细化关系\n      $$p_{\\mathrm{drv}}=\\log_{2}\\left(\\frac{\\|\\psi^{(1)}-\\psi^{(2)}\\|_{h}}{\\|\\psi^{(2)}-\\psi^{(3)}\\|_{h}}\\right),$$\n      估算观测到的阶数$p_{\\mathrm{drv}}$，其中$\\|\\cdot\\|_{h}$是上文定义的离散$\\ell^{2}$范数。\n  - 自由粒子的精确性检验：\n    - 最终时间$T=1.0$，步长$\\Delta t=0.01$。\n    - 使用分裂算符进行演化，并与在$k$空间中单步应用精确动能相位$e^{-i\\,k^{2}T/2}$的结果进行比较。\n    - 如果两个最终态之差的离散范数小于$5\\times 10^{-12}$，则返回一个布尔标志$b_{\\mathrm{free}}$为真。\n  - 静态谐振子阱的自收敛阶数测试：\n    - 最终时间$T=0.512$。\n    - 使用相同的三个时间步长$\\Delta t_{1}=0.008, \\Delta t_{2}=0.004, \\Delta t_{3}=0.002$。\n    - 类似于驱动情况，计算观测到的阶数$p_{\\mathrm{ho}}$。\n  - 离散幺正性保持检验：\n    - 使用驱动谐振子阱$V_{\\mathrm{drv}}(x,t)$，最终时间$T=1.0$，步长$\\Delta t=0.05$。\n    - 在每一步$n$之后记录离散范数$\\|\\psi^{n}\\|_{h}^{2}$。\n    - 如果在所有步骤中，$\\|\\psi^{n}\\|_{h}^{2}$与$1$的最大绝对偏差小于$5\\times 10^{-12}$，则返回一个布尔标志$b_{\\mathrm{uni}}$为真。\n\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，结果的顺序必须为$[p_{\\mathrm{drv}}, b_{\\mathrm{free}}, p_{\\mathrm{ho}}, b_{\\mathrm{uni}}]$。两个实数$p_{\\mathrm{drv}}$和$p_{\\mathrm{ho}}$必须四舍五入到三位小数；布尔值必须打印为语言原生的布尔字面量。不应打印任何其他文本。计算是无量纲的；输出中不应报告任何物理单位。所有三角函数角度均以弧度为单位。", "solution": "经过严格评估，该问题陈述被确定为有效。它在科学上基于量子力学和数值分析的原理，其设定良好，具有完整且一致的参数集，并以客观、正式的语言表述。因此，我们可以着手求解。\n\n问题要求实现并验证一个用于一维瞬时薛定谔方程（TDSE）的数值传播子：\n$$ i\\hbar \\frac{\\partial}{\\partial t} \\psi(x,t) = H(t) \\psi(x,t) $$\n该问题设定在无量纲单位下，其中$\\hbar=1$，粒子质量$m=1$。哈密顿量$H(t)$的形式为$H(t) = T + V(t)$，其中$T = \\frac{\\hat{p}^2}{2m} = \\frac{\\hat{p}^2}{2}$是动能算符，$V(t) = V(\\hat{x}, t)$是一个含时势能算符。\n\nTDSE 在时间间隔从$t$到$t+\\Delta t$上的形式解由下式给出\n$$ \\psi(t+\\Delta t) = U(t+\\Delta t, t) \\psi(t) $$\n其中$U(t+\\Delta t, t)$是时间演化算符，它是一个时间顺序指数：\n$$ U(t+\\Delta t, t) = \\mathcal{T} \\exp\\left(-i \\int_t^{t+\\Delta t} H(\\tau) \\,d\\tau\\right) $$\n一般来说，动能算符和势能算符不对易，即$[T, V] \\neq 0$。这种不对易性使得和的指数不能简单地分解为指数的乘积。需要使用数值方法来近似$U$的作用。\n\n问题指定使用对称分裂算符分解，这是一种二阶 Trotter-Suzuki 分解。对于含时势，我们使用中点法则来近似势在时间步长$\\Delta t$上的积分：$\\int_t^{t+\\Delta t} V(\\tau) d\\tau \\approx V(t+\\Delta t/2) \\Delta t$。于是，单步传播子近似为：\n$$ U_{\\text{step}}(t, \\Delta t) \\approx e^{-i T \\Delta t / 2} e^{-i V(t+\\Delta t/2) \\Delta t} e^{-i T \\Delta t / 2} $$\n使用这种对称分裂的单步误差为$\\mathcal{O}(\\Delta t^3)$阶，在有限时间间隔内传播后，导致的全局误差为$\\mathcal{O}(\\Delta t^2)$阶，这使得该方法在时间上是二阶精确的。\n\n该传播子的数值实现是使用分裂步傅里叶方法在离散空间网格上进行的。此方法利用了动能算符$T$在动量（波矢）表象中是对角的，而势能算符$V$在位置表象中是对角的事实。傅里叶变换被用来在这两个表象之间切换。\n1.  空间域$x \\in [-L/2, L/2)$被离散化为$N=1024$个点$x_j = -L/2 + j \\cdot \\Delta x$，其中$j=0, \\dots, N-1$，$\\Delta x = L/N$。此处，$L=200$。\n2.  相应的波矢网格$k_n$通过离散傅里叶变换关系得到。对于网格间距$\\Delta x$，波矢由$k_n=2\\pi f_n$给出，其中$f_n$是标准 FFT 库提供的频率。\n3.  势算符$e^{-i V(x_j, t+\\Delta t/2) \\Delta t}$的作用是在位置空间中对波函数数组$\\psi_j$进行简单的逐元素相乘。\n4.  动能算符$e^{-i T \\Delta t/2}$的作用在波矢空间中实现。经过傅里叶变换$\\psi(x) \\to \\tilde{\\psi}(k)$后，算符$\\hat{p}$变为乘以$k$，因此$T = \\hat{p}^2/2$变为$k^2/2$。其作用是在变换后的波函数数组$\\tilde{\\psi}_n$上逐元素乘以$e^{-i (k_n^2/2) \\Delta t/2}$。\n5.  为保持波函数的范数（总概率），离散傅里叶变换必须是幺正的。这通过对正变换和逆变换进行适当的归一化来实现。\n\n从时间$t$到$t+\\Delta t$对状态$\\psi(x,t)$进行单个传播步骤的算法如下：\na.  计算半步的动能相位因子：$P_K = \\exp(-i (k^2/2) (\\Delta t/2))$。\nb.  将状态变换到波矢空间：$\\tilde{\\psi} = \\mathcal{F}[\\psi]$，其中$\\mathcal{F}$是幺正离散傅里叶变换。\nc.  应用第一个动能半步：$\\tilde{\\psi}' = P_K \\odot \\tilde{\\psi}$（逐元素乘积）。\nd.  变换回位置空间：$\\psi' = \\mathcal{F}^{-1}[\\tilde{\\psi}']$。\ne.  计算中点时间$t+\\Delta t/2$在空间网格上的势能：$V_{mid} = V(x, t+\\Delta t/2)$。\nf.  计算势能相位因子：$P_V = \\exp(-i V_{mid} \\Delta t)$。\ng.  应用完整的势能步：$\\psi'' = P_V \\odot \\psi'$。\nh.  变换到波矢空间：$\\tilde{\\psi}'' = \\mathcal{F}[\\psi'']$。\ni.  应用第二个动能半步：$\\tilde{\\psi}''' = P_K \\odot \\tilde{\\psi}''$。\nj.  变换回位置空间以获得最终状态：$\\psi(x, t+\\Delta t) = \\mathcal{F}^{-1}[\\tilde{\\psi}''']$。\n\n这个分步过程被用来实现一个可重用的单时间步函数。从$t=0$到$t=T$的完整演化是通过重复应用此单步传播子来实现的。然后按规定执行验证测试：\n-   **自收敛性测试 ($p_{\\mathrm{drv}}$, $p_{\\mathrm{ho}}$)**：收敛阶数$p$通过使用三个递减的时间步长$\\Delta t_1$、$\\Delta t_2 = \\Delta t_1/2$和$\\Delta t_3 = \\Delta t_2/2$进行三次模拟来估计。误差通过比较得到的最终态来估算。观测到的阶数计算为$p = \\log_2(\\|\\psi^{(1)}-\\psi^{(2)}\\|_h / \\|\\psi^{(2)}-\\psi^{(3)}\\|_h)$。对于二阶方法，我们期望$p \\approx 2$。此测试验证了实现的时间精度。\n-   **自由粒子精确性测试 ($b_{\\mathrm{free}}$)**：对于自由粒子 ($V=0$)，分裂算符传播子是精确的：$U_{\\text{step}} = e^{-iT\\Delta t/2} e^0 e^{-iT\\Delta t/2} = e^{-iT\\Delta t}$。一系列步长的结果是$e^{-iT T_{final}}$。这个结果必须在机器精度范围内，与单步应用总时间$T_{final}$的精确自由粒子传播子的结果相同。此测试验证了动能传播的正确实现。\n-   **幺正性保持测试 ($b_{\\mathrm{uni}}$)**：精确的薛定谔演化是幺正的，意味着它保持总概率$\\|\\psi\\|_h^2$。数值传播子作为幺正算符的乘积（当使用幺正傅里叶变换时），也必须是幺正的。此测试验证了波函数的范数在整个模拟过程中保持恒定，从而确认数值方案不会人为地产生或消灭概率。\n\n初始态是一个归一化的高斯波包，由$\\psi_{0}(x)=C\\exp (-(x-x_{0})^{2}/(4\\sigma^{2})+i\\,k_{0}(x-x_{0}) )$给出。常数$C$的选择使得离散$\\ell^2$范数$\\|\\psi_0\\|_h^2 = \\sum_{j=0}^{N-1}|\\psi_{0,j}|^2$等于$1$。所有计算均根据问题陈述中指定的参数进行。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies a split-operator propagator for the 1D time-dependent Schrödinger equation.\n    \"\"\"\n\n    # --- 1. Define constants and grid parameters ---\n    N = 1024\n    L = 200.0\n    m = 1.0\n    hbar = 1.0 # Implicit in formulation, but useful for clarity\n\n    # Spatial grid\n    dx = L / N\n    x = np.arange(N) * dx - L / 2\n\n    # Wavevector grid (uses unitary FFT convention)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Initial wavepacket parameters\n    x0 = -10.0\n    sigma = 1.0\n    k0 = 2.0\n\n    # Potential parameters\n    omega = 0.2\n    E0 = 0.1\n    Omega = 1.0\n\n    # --- 2. Define potentials and initial state ---\n    def V_drv(x_grid, t):\n        return 0.5 * (omega**2) * (x_grid**2) + E0 * x_grid * np.cos(Omega * t)\n\n    def V_free(x_grid, t):\n        return np.zeros_like(x_grid)\n\n    def V_ho(x_grid, t):\n        return 0.5 * (omega**2) * (x_grid**2)\n    \n    # Create and normalize initial state\n    psi0_unnormalized = np.exp(-(x - x0)**2 / (4 * sigma**2) + 1j * k0 * (x - x0))\n    norm_sq = np.sum(np.abs(psi0_unnormalized)**2)\n    psi0 = psi0_unnormalized / np.sqrt(norm_sq)\n\n    # --- 3. Define propagation functions ---\n    \n    def propagate_one_step(psi_in, t, dt, potential_func):\n        \"\"\"Propagates the wavefunction by one time step dt.\"\"\"\n        \n        # Kinetic propagator for a half step\n        kinetic_propagator_half = np.exp(-1j * (k**2 / (2 * m)) * dt / 2.0)\n        \n        # 1. First kinetic half-step\n        psi_k = np.fft.fft(psi_in, norm='ortho')\n        psi_k = kinetic_propagator_half * psi_k\n        psi_x = np.fft.ifft(psi_k, norm='ortho')\n        \n        # 2. Full potential step at midpoint time\n        t_mid = t + dt / 2.0\n        V_mid = potential_func(x, t_mid)\n        potential_propagator = np.exp(-1j * V_mid * dt)\n        psi_x = potential_propagator * psi_x\n        \n        # 3. Second kinetic half-step\n        psi_k = np.fft.fft(psi_x, norm='ortho')\n        psi_k = kinetic_propagator_half * psi_k\n        psi_out = np.fft.ifft(psi_k, norm='ortho')\n        \n        return psi_out\n\n    def full_propagation(psi_start, T_final, dt, potential_func):\n        \"\"\"Performs a full propagation from t=0 to T_final.\"\"\"\n        num_steps = int(round(T_final / dt))\n        psi_current = psi_start.copy()\n        t_current = 0.0\n        for _ in range(num_steps):\n            psi_current = propagate_one_step(psi_current, t_current, dt, potential_func)\n            t_current += dt\n        return psi_current\n\n    # --- 4. Perform verification tests ---\n\n    # Test 1: Self-convergence for driven trap\n    T_conv = 0.512\n    dt_vals_conv = [0.008, 0.004, 0.002]\n    psi_final_drv = [full_propagation(psi0, T_conv, dt, V_drv) for dt in dt_vals_conv]\n    \n    err_12_drv = np.linalg.norm(psi_final_drv[0] - psi_final_drv[1])\n    err_23_drv = np.linalg.norm(psi_final_drv[1] - psi_final_drv[2])\n    p_drv = np.log2(err_12_drv / err_23_drv) if err_23_drv > 0 else 0.0\n\n    # Test 2: Exactness for free particle\n    T_free = 1.0\n    dt_free = 0.01\n    psi_split_free = full_propagation(psi0, T_free, dt_free, V_free)\n    \n    # Exact single-step evolution\n    psi0_k = np.fft.fft(psi0, norm='ortho')\n    exact_kinetic_prop = np.exp(-1j * (k**2 / (2 * m)) * T_free)\n    psi_exact_free_k = exact_kinetic_prop * psi0_k\n    psi_exact_free = np.fft.ifft(psi_exact_free_k, norm='ortho')\n    \n    err_free = np.linalg.norm(psi_split_free - psi_exact_free)\n    b_free = err_free  5e-12\n\n    # Test 3: Self-convergence for static harmonic trap\n    psi_final_ho = [full_propagation(psi0, T_conv, dt, V_ho) for dt in dt_vals_conv]\n    \n    err_12_ho = np.linalg.norm(psi_final_ho[0] - psi_final_ho[1])\n    err_23_ho = np.linalg.norm(psi_final_ho[1] - psi_final_ho[2])\n    p_ho = np.log2(err_12_ho / err_23_ho) if err_23_ho > 0 else 0.0\n\n    # Test 4: Unitarity preservation check\n    T_uni = 1.0\n    dt_uni = 0.05\n    num_steps_uni = int(round(T_uni / dt_uni))\n    psi_current = psi0.copy()\n    t_current = 0.0\n    norms_sq = []\n    \n    for _ in range(num_steps_uni):\n        psi_current = propagate_one_step(psi_current, t_current, dt_uni, V_drv)\n        t_current += dt_uni\n        norms_sq.append(np.sum(np.abs(psi_current)**2))\n    \n    max_dev = np.max(np.abs(np.array(norms_sq) - 1.0))\n    b_uni = max_dev  5e-12\n\n    # --- 5. Format and print results ---\n    results_list = [\n        f\"{p_drv:.3f}\",\n        str(b_free),\n        f\"{p_ho:.3f}\",\n        str(b_uni)\n    ]\n    print(f\"[{','.join(results_list)}]\")\n\n# Execute the solution\nsolve()\n\n```", "id": "2822573"}]}