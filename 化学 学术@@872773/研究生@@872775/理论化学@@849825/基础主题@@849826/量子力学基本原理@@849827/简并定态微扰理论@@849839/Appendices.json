{"hands_on_practices": [{"introduction": "我们将从一个简并微扰理论中最典型的模型系统——二维无限深方势阱中的粒子——开始。这个练习将引导你完成简并微扰理论的核心步骤：在简并子空间中构建微扰矩阵 $W$，然后通过对角化求得能量分裂和“正确”的零阶波函数。通过这个基础性问题（[@problem_id:2767570]），你将掌握进行微扰计算所必需的基本技能。", "problem": "考虑一个质量为 $m$ 的非相对论粒子，被限制在边长为 $L$ 的二维无限深方势阱中，其中 $0 \\le x \\le L$ 和 $0 \\le y \\le L$。未微扰哈密顿量 $\\hat{H}_{0}$ 描述了标准的无限深势阱边值问题，其归一化本征函数是正弦乘积基\n$$\n\\psi_{n_{x},n_{y}}(x,y) \\;=\\; \\phi_{n_{x}}(x)\\,\\phi_{n_{y}}(y), \n\\qquad \n\\phi_{n}(u) \\;=\\; \\sqrt{\\frac{2}{L}}\\,\\sin\\!\\left(\\frac{n\\pi u}{L}\\right),\n$$\n对应的能量为\n$$\nE^{(0)}_{n_{x},n_{y}} \\;=\\; \\frac{\\hbar^{2}\\pi^{2}}{2mL^{2}}\\left(n_{x}^{2}+n_{y}^{2}\\right).\n$$\n在 $\\hat{H}_{0}$ 下，量子态 $(n_{x},n_{y})=(1,2)$ 和 $(2,1)$ 的能级是严格简并的。\n\n现在引入一个弱的静态微扰\n$$\n\\hat{V}(x,y) \\;=\\; \\lambda\\,\\frac{xy}{L^{2}},\n$$\n其中 $\\lambda$ 是一个具有能量量纲的实常数，且 $|\\lambda|$ 足够小，使得非含时微扰理论成立。\n\n从第一性原理出发，使用简并非含时微扰理论，完成以下任务：\n- 在由 $\\{\\psi_{1,2},\\psi_{2,1}\\}$ 张成的简并子空间内，构建久期（有效）矩阵 $W$，其中 $W_{ij}=\\langle \\psi_{i}|\\hat{V}|\\psi_{j}\\rangle$，且 $i,j\\in\\{(1,2),(2,1)\\}$。\n- 在正弦基中通过进行必要的积分，显式地计算所有矩阵元。用 $\\lambda$、$\\pi$ 和有理数以闭合形式表示你的结果。\n- 确定将 $\\hat{V}$ 对角化的 $\\{\\psi_{1,2},\\psi_{2,1}\\}$ 的正交归一线性组合，并指明哪种组合具有较低的一阶能量。\n- 根据你的对角化，推导出这个简并流形中两个修正能量之间的一阶能量分裂 $\\Delta E^{(1)}$。\n\n报告一个关于一阶分裂 $\\Delta E^{(1)}$ 的单一闭合形式解析表达式，用 $\\lambda$ 表示。不要代入数值，也不要包含单位。不需要四舍五入。", "solution": "必须应用非含时简并微扰理论的原理。该问题定义明确，是量子力学中的一个标准练习。\n\n未微扰哈密顿量 $\\hat{H}_{0}$ 对于由量子数 $(n_{x},n_{y})=(1,2)$ 和 $(2,1)$ 标记的态具有简并本征态。我们将这些正交归一的态表示为 $|\\psi_{a}\\rangle \\equiv |\\psi_{1,2}\\rangle$ 和 $|\\psi_{b}\\rangle \\equiv |\\psi_{2,1}\\rangle$。这两个态对应于相同的未微扰能量：\n$$\nE^{(0)} = E^{(0)}_{1,2} = E^{(0)}_{2,1} = \\frac{\\hbar^{2}\\pi^{2}}{2mL^{2}}(1^{2}+2^{2}) = \\frac{5\\hbar^{2}\\pi^{2}}{2mL^{2}}\n$$\n微扰由 $\\hat{V}(x,y) = \\lambda \\frac{xy}{L^{2}}$ 给出。为了找到能量的一阶修正，我们必须将在由 $\\{|\\psi_{a}\\rangle, |\\psi_{b}\\rangle\\}$ 张成的简并子空间内构建的微扰矩阵 $W$ 对角化。这个 $2 \\times 2$ 矩阵的元为 $W_{ij} = \\langle \\psi_{i} | \\hat{V} | \\psi_{j} \\rangle$，其中 $i,j \\in \\{a,b\\}$。\n\n矩阵元为：\n$$\nW_{aa} = \\langle \\psi_{1,2} | \\hat{V} | \\psi_{1,2} \\rangle\n$$\n$$\nW_{bb} = \\langle \\psi_{2,1} | \\hat{V} | \\psi_{2,1} \\rangle\n$$\n$$\nW_{ab} = \\langle \\psi_{1,2} | \\hat{V} | \\psi_{2,1} \\rangle\n$$\n$$\nW_{ba} = \\langle \\psi_{2,1} | \\hat{V} | \\psi_{1,2} \\rangle\n$$\n由于 $\\hat{V}$ 是一个实算符，矩阵 $W$ 是厄米矩阵。在本例中，它是实对称的，因此 $W_{ab} = W_{ba}$。\n\n本征函数是可分离的：$\\psi_{n_{x},n_{y}}(x,y) = \\phi_{n_{x}}(x)\\phi_{n_{y}}(y)$。微扰 $\\hat{V}$ 也是可分离的。这简化了矩阵元的计算。一个通用的矩阵元是：\n$$\n\\langle \\psi_{n_{x},n_{y}} | \\hat{V} | \\psi_{n'_{x},n'_{y}} \\rangle = \\frac{\\lambda}{L^{2}} \\left( \\int_{0}^{L} \\phi_{n_{x}}(x) \\, x \\, \\phi_{n'_{x}}(x) \\, dx \\right) \\left( \\int_{0}^{L} \\phi_{n_{y}}(y) \\, y \\, \\phi_{n'_{y}}(y) \\, dy \\right)\n$$\n让我们定义积分：\n$$\nI(n, n') = \\int_{0}^{L} u \\, \\phi_{n}(u) \\, \\phi_{n'}(u) \\, du = \\frac{2}{L} \\int_{0}^{L} u \\sin\\left(\\frac{n\\pi u}{L}\\right) \\sin\\left(\\frac{n'\\pi u}{L}\\right) \\, du\n$$\n矩阵元变为：\n$$\nW_{aa} = \\frac{\\lambda}{L^{2}} I(1,1) I(2,2)\n$$\n$$\nW_{bb} = \\frac{\\lambda}{L^{2}} I(2,2) I(1,1) = W_{aa}\n$$\n$$\nW_{ab} = \\frac{\\lambda}{L^{2}} I(1,2) I(2,1)\n$$\n$$\nW_{ba} = \\frac{\\lambda}{L^{2}} I(2,1) I(1,2) = W_{ab}\n$$\n我们现在必须计算积分 $I(n, n')$。\n\n对于对角情况，$n=n'$：\n$$\n\\sin^{2}\\left(\\frac{n\\pi u}{L}\\right) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi u}{L}\\right)\\right)\n$$\n$$\nI(n,n) = \\frac{1}{L} \\int_{0}^{L} u \\left(1 - \\cos\\left(\\frac{2n\\pi u}{L}\\right)\\right) du = \\frac{1}{L}\\left[\\frac{u^{2}}{2}\\right]_{0}^{L} - \\frac{1}{L}\\int_{0}^{L} u \\cos\\left(\\frac{2n\\pi u}{L}\\right) du\n$$\n第一项是 $\\frac{L}{2}$。第二个积分是零，这可以通过分部积分法证明：\n$$\n\\int u \\cos(ku) du = \\frac{u}{k}\\sin(ku) + \\frac{1}{k^{2}}\\cos(ku)\n$$\n在 $0$ 到 $L$ 之间，当 $k = \\frac{2n\\pi}{L}$ 时，$\\sin$ 项在两个极限处都为零，而 $\\cos$ 项在两个极限处相同，结果为零。\n因此，$I(n,n) = \\frac{L}{2}$。\n\n对于非对角情况，$n \\neq n'$，我们使用积化和差恒等式：\n$$\n\\sin\\left(\\frac{n\\pi u}{L}\\right)\\sin\\left(\\frac{n'\\pi u}{L}\\right) = \\frac{1}{2}\\left(\\cos\\left(\\frac{(n-n')\\pi u}{L}\\right) - \\cos\\left(\\frac{(n+n')\\pi u}{L}\\right)\\right)\n$$\n当 $n \\neq n'$ 时，积分 $I(n,n')$ 仅当 $n$ 和 $n'$ 具有不同奇偶性时才非零。对于 $n=1$ 和 $n'=2$，它们的奇偶性不同，所以积分非零。\n$$\nI(1,2) = \\frac{1}{L} \\int_{0}^{L} u \\left(\\cos\\left(\\frac{-\\pi u}{L}\\right) - \\cos\\left(\\frac{3\\pi u}{L}\\right)\\right) du\n$$\n使用原函数 $\\int u \\cos(ku) du$：\n$$\n\\int_{0}^{L} u \\cos\\left(\\frac{\\pi u}{L}\\right) du = \\left[\\frac{Lu}{\\pi}\\sin\\left(\\frac{\\pi u}{L}\\right) + \\frac{L^{2}}{\\pi^{2}}\\cos\\left(\\frac{\\pi u}{L}\\right)\\right]_{0}^{L} = \\frac{L^{2}}{\\pi^{2}}(\\cos(\\pi) - \\cos(0)) = -\\frac{2L^{2}}{\\pi^{2}}\n$$\n$$\n\\int_{0}^{L} u \\cos\\left(\\frac{3\\pi u}{L}\\right) du = \\left[\\frac{Lu}{3\\pi}\\sin\\left(\\frac{3\\pi u}{L}\\right) + \\frac{L^{2}}{9\\pi^{2}}\\cos\\left(\\frac{3\\pi u}{L}\\right)\\right]_{0}^{L} = \\frac{L^{2}}{9\\pi^{2}}(\\cos(3\\pi) - \\cos(0)) = -\\frac{2L^{2}}{9\\pi^{2}}\n$$\n所以，$I(1,2) = \\frac{1}{L} \\left( -\\frac{2L^{2}}{\\pi^{2}} - \\left(-\\frac{2L^{2}}{9\\pi^{2}}\\right) \\right) = \\frac{L}{\\pi^{2}} \\left(-2 + \\frac{2}{9}\\right) = -\\frac{16L}{9\\pi^{2}}$。\n根据对称性，$I(2,1)=I(1,2)$。\n\n现在我们构建矩阵 $W$：\n$$\nW_{aa} = W_{bb} = \\frac{\\lambda}{L^{2}} I(1,1) I(2,2) = \\frac{\\lambda}{L^{2}} \\left(\\frac{L}{2}\\right)\\left(\\frac{L}{2}\\right) = \\frac{\\lambda}{4}\n$$\n$$\nW_{ab} = W_{ba} = \\frac{\\lambda}{L^{2}} I(1,2) I(2,1) = \\frac{\\lambda}{L^{2}} \\left(-\\frac{16L}{9\\pi^{2}}\\right)^{2} = \\frac{\\lambda}{L^{2}} \\frac{256L^{2}}{81\\pi^{4}} = \\frac{256\\lambda}{81\\pi^{4}}\n$$\n久期矩阵是：\n$$\nW = \\begin{pmatrix} \\frac{\\lambda}{4}  \\frac{256\\lambda}{81\\pi^{4}} \\\\ \\frac{256\\lambda}{81\\pi^{4}}  \\frac{\\lambda}{4} \\end{pmatrix}\n$$\n这个矩阵的本征值 $E^{(1)}$ 是一阶能量修正。它们通过求解特征方程 $\\det(W - E^{(1)}I)=0$ 得到：\n$$\n\\left(\\frac{\\lambda}{4} - E^{(1)}\\right)^{2} - \\left(\\frac{256\\lambda}{81\\pi^{4}}\\right)^{2} = 0\n$$\n$$\nE^{(1)} = \\frac{\\lambda}{4} \\pm \\frac{256\\lambda}{81\\pi^{4}}\n$$\n两个一阶能量修正是：\n$$\nE^{(1)}_{\\pm} = \\lambda\\left(\\frac{1}{4} \\pm \\frac{256}{81\\pi^{4}}\\right)\n$$\n“好”的基态（$W$的本征矢量）是原始简并态的对称和反对称线性组合。\n对于 $E^{(1)}_{+}$, 本征矢量是 $|\\psi_{S}\\rangle = \\frac{1}{\\sqrt{2}}(|\\psi_{1,2}\\rangle + |\\psi_{2,1}\\rangle)$。\n对于 $E^{(1)}_{-}$, 本征矢量是 $|\\psi_{A}\\rangle = \\frac{1}{\\sqrt{2}}(|\\psi_{1,2}\\rangle - |\\psi_{2,1}\\rangle)$。\n$|\\psi_{S}\\rangle$ 的能量修正是 $E^{(1)}_{S} = \\lambda(\\frac{1}{4} + \\frac{256}{81\\pi^4})$，$|\\psi_{A}\\rangle$ 的能量修正是 $E^{(1)}_{A} = \\lambda(\\frac{1}{4} - \\frac{256}{81\\pi^4})$。\n如果 $\\lambda > 0$, 反对称组合 $|\\psi_{A}\\rangle$ 具有较低的能量。如果 $\\lambda  0$, 对称组合 $|\\psi_{S}\\rangle$ 具有较低的能量。\n\n一阶能量分裂 $\\Delta E^{(1)}$ 是这两个能量修正之差：\n$$\n\\Delta E^{(1)} = E^{(1)}_{S} - E^{(1)}_{A} = \\lambda\\left(\\frac{1}{4} + \\frac{256}{81\\pi^{4}}\\right) - \\lambda\\left(\\frac{1}{4} - \\frac{256}{81\\pi^{4}}\\right)\n$$\n$$\n\\Delta E^{(1)} = 2\\lambda\\frac{256}{81\\pi^{4}} = \\frac{512\\lambda}{81\\pi^{4}}\n$$\n这就是所需的分裂。", "answer": "$$ \\boxed{\\frac{512\\lambda}{81\\pi^{4}}} $$", "id": "2767570"}, {"introduction": "在掌握了基本计算方法后，我们将把注意力转向原子物理学中的一个基石问题：线性斯塔克效应。这个实践将探究电场是如何解除氢原子能级简并的。此练习（[@problem_id:2767589]）的关键在于展示对称性原理和选择定则如何通过预测哪些微扰矩阵元为零来极大地简化问题，从而使我们只需计算少数几个关键的积分。", "problem": "一个核电荷数为 $Z$ 的类氢单电子离子由无场哈密顿算符 $\\hat{H}_{0}$ 描述，其本征态是归一化的类氢轨道 $\\{|n \\ell m\\rangle\\}$，对应的本征能量 $E_{n}^{(0)}$ 仅依赖于主量子数 $n$。考虑简并的 $n=2$ 流形，它由对应于 $(2s, 2p_{m=0}, 2p_{m=+1}, 2p_{m=-1})$ 轨道的四个态 $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ 组成。一个大小为 $\\mathcal{E}$ 的弱、均匀、静态电场沿 $z$ 轴施加。在长度规范下，微扰为 $\\hat{W} = e\\,\\mathcal{E}\\, z$，其中 $e$ 是元电荷，$z$ 是沿电场方向的位置算符。假设非相对论性运动，并忽略自旋、精细结构和超精细结构效应。在定态简并微扰理论的框架内进行计算。\n\n从类氢波函数的定义和基本的角动量理论出发：\n- 利用源于 $z \\propto r \\cos\\theta$ 张量特性的角动量选择定则，论证在 $n=2$ 流形内，$z$ 的哪些矩阵元是因对称性而允许存在的。\n- 通过分离径向和角向部分，从第一性原理计算 $|200\\rangle$ 和 $|210\\rangle$ 之间的非零偶极矩阵元。你可以使用 $n=2$ 的归一化类氢径向函数，\n$$\nR_{20}(r) \\;=\\; \\left(\\frac{Z}{a_{0}}\\right)^{3/2}\\,\\frac{1}{2\\sqrt{2}}\\,\\exp\\!\\left(-\\frac{Z r}{2 a_{0}}\\right)\\left(2 - \\frac{Z r}{a_{0}}\\right),\\qquad\nR_{21}(r) \\;=\\; \\left(\\frac{Z}{a_{0}}\\right)^{3/2}\\,\\frac{1}{2\\sqrt{6}}\\,\\exp\\!\\left(-\\frac{Z r}{2 a_{0}}\\right)\\left(\\frac{Z r}{a_{0}}\\right),\n$$\n和标准球谐函数 $Y_{\\ell m}(\\theta,\\phi)$，以及 $z = r \\cos\\theta$。\n- 在有序基 $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ 下，构建并对角化微扰矩阵 $\\mathbf{W}$，以获得此流形内的一阶斯塔克能量修正。\n\n答案要求：\n- 以单行矩阵的形式，按能量修正的升序排列，给出四个一阶能量修正值。\n- 将最终的能量修正以焦耳为单位，用包含 $e$、$a_{0}$、$\\mathcal{E}$ 和 $Z$ 的解析表达式表示。不要代入常数的数值。\n- 无需四舍五入。最终答案必须是单行矩阵。", "solution": "所提出的问题是应用简并定态微扰理论计算类氢原子 $n=2$能级的线性斯塔克效应的一个标准范例。该问题提法得当且科学上无误，因此我们直接进行求解。\n\n未微擾哈密顿算符为 $\\hat{H}_{0}$，其主量子数 $n=2$ 的本征态构成一个四重简并流形。基矢为 $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$。所有这些态共享相同的未微扰能量 $E_{2}^{(0)}$。微扰是由沿 $z$ 轴施加的均匀电场 $\\vec{\\mathcal{E}} = \\mathcal{E} \\hat{k}$ 引起的，因此微扰哈密顿算符为 $\\hat{W} = e\\,\\mathcal{E}\\,z$。\n\n根据简并微扰理论，一阶能量修正 $E^{(1)}$ 是在简并态基底下构建的微扰矩阵 $\\mathbf{W}$ 的本征值。这个 $4 \\times 4$ 矩阵的元素由 $W_{ij} = \\langle \\psi_i | \\hat{W} | \\psi_j \\rangle$ 给出，其中 $|\\psi_i\\rangle, |\\psi_j\\rangle$ 属于简并流形 $\\{|2 \\ell m\\rangle\\}$。\n\n首先，我们通过应用选择定则来确定矩阵 $\\mathbf{W}$ 的结构。算符 $z$ 与 $r \\cos\\theta$ 成正比。函数 $\\cos\\theta$ 与球谐函数 $Y_{10}(\\theta, \\phi)$ 成正比。具体来说，$z = r\\sqrt{\\frac{4\\pi}{3}} Y_{10}(\\theta, \\phi)$。这表明算符 $z$ 是一个秩为1的不可约张量算符的分量，其投影指标为 $q=0$。Wigner-Eckart 定理规定了其矩阵元 $\\langle n' \\ell' m' | z | n \\ell m \\rangle$ 的选择定则：\n1. 投影量子数必须满足 $m' = m+q$，对于 $z$ 而言，这意味着 $\\Delta m = m' - m = 0$。\n2. 角动量量子数必须满足三角不等式 $|\\ell - 1| \\le \\ell' \\le \\ell + 1$。这意味着 $\\Delta \\ell = \\ell' - \\ell = \\pm 1$。\n3. 总体宇称必须守恒。态 $|n \\ell m\\rangle$ 的宇称为 $(-1)^{\\ell}$。算符 $z$ 具有奇宇称 $(-1)^1$。为使矩阵元非零，被积函数 $\\psi_{\\ell' m'}^* z \\psi_{\\ell m}$ 的宇称必须为偶。总宇称为 $(-1)^{\\ell'} (-1)^1 (-1)^{\\ell} = (-1)^{\\ell'+\\ell+1}$。此值必须为 $+1$，这要求 $\\ell'+\\ell$ 为奇数。这确保了 $\\ell$ 和 $\\ell'$ 具有不同的宇称，与 $\\Delta \\ell = \\pm 1$ 一致。它也严格禁止了 $\\Delta \\ell = 0$ 的矩阵元，意味着所有对角矩阵元 $\\langle n \\ell m | z | n \\ell m \\rangle$ 都为零。\n\n我们将这些规则应用于 $n=2$ 的基矢 $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$：\n- 由于宇称规则（$\\Delta \\ell = 0$），所有对角元 $W_{ii} = \\langle 2 \\ell m | e\\mathcal{E}z | 2 \\ell m \\rangle$ 都为零。\n- $\\Delta m = 0$ 的规则意味着 $\\hat{W}$ 只连接具有相同 $m$ 值的态。因此，矩阵 $\\mathbf{W}$ 是块对角化的。态 $|211\\rangle$（$m=+1$）和 $|21{-}1\\rangle$（$m=-1$）不与其他任何态或彼此混合。它们的一阶能量修正就是对角元 $W_{33}$ 和 $W_{44}$，而它们都为零。因此，其中两个能量修正为 $E^{(1)}=0$。\n- 态 $|200\\rangle$ 和 $|210\\rangle$ 都具有 $m=0$。它们可以混合。唯一的非零矩阵元是连接这两个态的非对角元：$W_{12} = \\langle 200 | e\\mathcal{E}z | 210 \\rangle$ 和 $W_{21} = \\langle 210 | e\\mathcal{E}z | 200 \\rangle$。选择定则 $\\Delta \\ell = \\pm 1$ 和 $\\Delta m=0$ 对这对态是满足的。\n因此，在有序基 $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ 下的微扰矩阵为：\n$$ \\mathbf{W} = \\begin{pmatrix} 0  W_{12}  0  0 \\\\ W_{21}  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n由于 $\\hat{W}$ 是一个厄米算符，所以 $W_{21} = W_{12}^*$。因为波函数和算符 $z$ 可以选择为实数，所以 $W_{12}$ 将是实数，故 $W_{21}=W_{12}$。\n\n接下来，我们计算非零矩阵元 $W_{12} = e\\mathcal{E}\\langle 200 | z | 210 \\rangle$。该积分由下式给出：\n$$ \\langle 200 | z | 210 \\rangle = \\int_0^\\infty r^2 dr \\int_0^\\pi \\sin\\theta d\\theta \\int_0^{2\\pi} d\\phi \\, \\psi_{200}^*(r,\\theta,\\phi) \\, (r \\cos\\theta) \\, \\psi_{210}(r,\\theta,\\phi) $$\n我们将其分离为径向部分和角向部分。波函数为 $\\psi_{n\\ell m}(r,\\theta,\\phi) = R_{n\\ell}(r)Y_{\\ell m}(\\theta,\\phi)$。\n$$ \\langle 200 | z | 210 \\rangle = \\left( \\int_0^\\infty r^3 R_{20}(r) R_{21}(r) \\, dr \\right) \\left( \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\, Y_{00}^*(\\theta,\\phi) \\cos\\theta Y_{10}(\\theta,\\phi) \\right) $$\n角向积分使用球谐函数 $Y_{00} = \\frac{1}{\\sqrt{4\\pi}}$ 和 $Y_{10} = \\sqrt{\\frac{3}{4\\pi}}\\cos\\theta$ 来计算。\n$$ \\text{角向部分} = \\int d\\Omega \\, \\left(\\frac{1}{\\sqrt{4\\pi}}\\right) \\left(\\sqrt{\\frac{4\\pi}{3}}Y_{10}\\right) Y_{10} = \\frac{1}{\\sqrt{3}} \\int |Y_{10}(\\theta,\\phi)|^2 d\\Omega = \\frac{1}{\\sqrt{3}} $$\n径向积分使用给定的函数计算：\n$$ I_r = \\int_0^\\infty r^3 R_{20}(r) R_{21}(r) \\, dr $$\n$$ R_{20}(r) R_{21}(r) = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{2\\sqrt{2}} \\frac{1}{2\\sqrt{6}} \\left(2 - \\frac{Z r}{a_{0}}\\right) \\left(\\frac{Z r}{a_{0}}\\right) \\exp\\!\\left(-\\frac{Z r}{a_{0}}\\right) $$\n预因子是 $\\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}}$。令 $\\rho = \\frac{Zr}{a_0}$，则 $r=\\frac{a_0}{Z}\\rho$ 且 $dr=\\frac{a_0}{Z}d\\rho$。\n$$ I_r = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}} \\int_0^\\infty \\left(\\frac{a_0}{Z}\\rho\\right)^3 (2 - \\rho)\\rho \\, \\exp(-\\rho) \\, \\left(\\frac{a_0}{Z}d\\rho\\right) $$\n$$ I_r = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}} \\left(\\frac{a_0}{Z}\\right)^4 \\int_0^\\infty (\\rho^4(2-\\rho)) \\, \\exp(-\\rho) \\, d\\rho $$\n$$ I_r = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} \\left( 2\\int_0^\\infty \\rho^4 e^{-\\rho} d\\rho - \\int_0^\\infty \\rho^5 e^{-\\rho} d\\rho \\right) $$\n使用标准积分 $\\int_0^\\infty x^n e^{-x} dx = n!$，我们得到：\n$$ I_r = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} \\left( 2(4!) - 5! \\right) = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} (2 \\times 24 - 120) = \\frac{a_0}{Z} \\frac{48 - 120}{8\\sqrt{3}} = \\frac{a_0}{Z} \\frac{-72}{8\\sqrt{3}} = -\\frac{9a_0}{Z\\sqrt{3}} $$\n化简此表达式得到 $I_r = -\\frac{3\\sqrt{3}a_0}{Z}$。\n现在我们将径向和角向部分结合起来：\n$$ \\langle 200 | z | 210 \\rangle = I_r \\times (\\text{角向部分}) = \\left(-\\frac{3\\sqrt{3}a_0}{Z}\\right) \\left(\\frac{1}{\\sqrt{3}}\\right) = -\\frac{3a_0}{Z} $$\n所以，$W_{12} = W_{21} = -e\\mathcal{E}\\frac{3a_0}{Z}$。\n\n最后，我们求 $\\mathbf{W}$ 的本征值。非平凡部分是对应于 $m=0$ 子空间的左上角 $2 \\times 2$ 块：\n$$ \\mathbf{W}_{m=0} = \\begin{pmatrix} 0  -3ea_0\\mathcal{E}/Z \\\\ -3ea_0\\mathcal{E}/Z  0 \\end{pmatrix} $$\n本征值 $E^{(1)}$ 可通过特征方程 $\\det(\\mathbf{W}_{m=0} - E^{(1)}I) = 0$ 求得：\n$$ \\begin{vmatrix} -E^{(1)}  -3ea_0\\mathcal{E}/Z \\\\ -3ea_0\\mathcal{E}/Z  -E^{(1)} \\end{vmatrix} = 0 $$\n$$ (E^{(1)})^2 - \\left(-\\frac{3ea_0\\mathcal{E}}{Z}\\right)^2 = 0 \\implies (E^{(1)})^2 = \\left(\\frac{3ea_0\\mathcal{E}}{Z}\\right)^2 $$\n这给出两个本征值 $E^{(1)} = \\pm \\frac{3ea_0\\mathcal{E}}{Z}$。\n\n$n=2$ 流形的四个一阶能量修正是来自该子矩阵的两个本征值，以及对应于 $|211\\rangle$ 和 $|21{-}1\\rangle$ 态的两个零本征值。按升序排列，能量修正为：\n$$ -\\frac{3ea_0\\mathcal{E}}{Z}, \\quad 0, \\quad 0, \\quad \\frac{3ea_0\\mathcal{E}}{Z} $$\n这些就是一阶斯塔克能量修正，按照要求用基本常数和参数表示。单位是焦耳，因为 $e\\mathcal{E}$ 的单位是力，$a_0$ 的单位是长度，其乘积为能量。", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{3 e a_{0} \\mathcal{E}}{Z}  0  0  \\frac{3 e a_{0} \\mathcal{E}}{Z} \\end{pmatrix} } $$", "id": "2767589"}, {"introduction": "最后，我们将跨越从纸笔理论到现代计算化学的鸿沟。最后的这个实践练习（[@problem_id:2767462]）要求你以算法的思维方式，将简并微扰理论的抽象步骤转化为一个具体的、基于矩阵代数的计算流程。通过在普适的原子轨道基组下进行操作，这个练习展示了该方法在真实的量子化学软件中是如何被实现，用以处理复杂大分子的。", "problem": "考虑一个非相对论性分子体系，其未微扰哈密顿量在能量 $E_0$ 处有一个 $g$ 重简并本征值。设相应的简并子空间由正交归一态 $\\{ \\lvert \\phi_a \\rangle \\}_{a=1}^g$ 张成，这些态在正交归一的原子轨道（AO）基组 $\\{ \\lvert \\chi_\\mu \\rangle \\}_{\\mu=1}^n$ 中表示。微扰由一个单电子算符 $\\hat{V}$ 表示，其 AO 表示为一个实对称矩阵 $V_{\\text{AO}} \\in \\mathbb{R}^{n \\times n}$（单位为原子单位，hartree）。每个简并态的 AO 系数以列的形式收集在矩阵 $C \\in \\mathbb{R}^{n \\times g}$ 中，满足正交归一条件 $C^\\top C = I_g$，并假设 AO 基组是正交归一的。目标是以一种计算上稳健的方式，为大的简并子空间实现简并定态一阶微扰理论的计算过程。\n\n你的任务是，从希尔伯特空间中矩阵元和投影算符的定义出发，并且不使用任何预先组合的“快捷”表达式：\n- 通过仅使用基本定义 $W_{ab} = \\langle \\phi_a \\lvert \\hat{V} \\rvert \\phi_b \\rangle$ 以及 $\\lvert \\phi_a \\rangle$ 在 AO 基中的线性展开，在 $\\{ \\lvert \\phi_a \\rangle \\}$ 基中构建有效微扰矩阵 $W$，从而构造出 $\\hat{V}$ 在简并子空间上的限制。\n- 对角化 $W$ 以获得一阶能量修正（本征值）和简并子空间内的幺正变换（本征矢）。\n- 构建变换后的简并态 AO 系数 $\\widetilde{C}$，这些系数对应于在简并子空间内将微扰对角化的新的最优零阶态。\n- 在数值上验证变换后的系数在 AO 度规下（在本问题中为单位矩阵）保持正交归一，并量化与单位矩阵的最大绝对偏差。\n\n你的程序必须为以下测试套件实现上述流程。在每个案例中，AO 基组都是正交归一的，所有矩阵都是实数矩阵，能量单位为 hartree。\n\n测试套件：\n- 案例 1（一般的二维子空间）：\n  - $n = 4$, $g = 2$.\n  - AO 微扰矩阵\n    $$\n    V_{\\text{AO}}^{(1)} =\n    \\begin{bmatrix}\n    2  0  1  0 \\\\\n    0  4  0  1 \\\\\n    1  0  3  0 \\\\\n    0  1  0  5\n    \\end{bmatrix}.\n    $$\n  - 简并子空间 AO 系数列\n    $$\n    C^{(1)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}}  0 \\\\\n    \\frac{1}{\\sqrt{2}}  0 \\\\\n    0  \\frac{1}{\\sqrt{2}} \\\\\n    0  \\frac{1}{\\sqrt{2}}\n    \\end{bmatrix}.\n    $$\n- 案例 2（边界情况，在 AO 块内实际上非简并）：\n  - $n = 4$, $g = 1$.\n  - AO 微扰矩阵\n    $$\n    V_{\\text{AO}}^{(2)} =\n    \\begin{bmatrix}\n    1  0  0  0 \\\\\n    0  3  0  0 \\\\\n    0  0  5  0 \\\\\n    0  0  0  7\n    \\end{bmatrix}.\n    $$\n  - 简并子空间 AO 系数列\n    $$\n    C^{(2)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}} \\\\\n    \\frac{1}{\\sqrt{2}} \\\\\n    0 \\\\\n    0\n    \\end{bmatrix}.\n    $$\n- 案例 3（具有块间耦合的三维子空间）：\n  - $n = 5$, $g = 3$.\n  - AO 微扰矩阵\n    $$\n    V_{\\text{AO}}^{(3)} =\n    \\begin{bmatrix}\n    6  2  1  0  1 \\\\\n    2  6  0  1  0 \\\\\n    1  0  8  -1  0 \\\\\n    0  1  -1  10  2 \\\\\n    1  0  0  2  12\n    \\end{bmatrix}.\n    $$\n  - 简并子空间 AO 系数列\n    $$\n    C^{(3)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}}  0  0 \\\\\n    \\frac{1}{\\sqrt{2}}  0  0 \\\\\n    0  \\frac{1}{\\sqrt{2}}  0 \\\\\n    0  \\frac{1}{\\sqrt{2}}  0 \\\\\n    0  0  1\n    \\end{bmatrix}.\n    $$\n\n实现和输出要求：\n- 对于每个案例，构建 $W$，对其进行对角化以获得一阶能量修正（本征值），构建 $\\widetilde{C}$，并计算与正交归一性的最大绝对偏差，定义为\n  $$\n  \\delta = \\max_{i,j} \\left| \\left( \\widetilde{C}^\\top \\widetilde{C} \\right)_{ij} - \\left( I_g \\right)_{ij} \\right|.\n  $$\n- 按给定顺序为每个案例报告一个列表，其中包含按升序排列的 $W$ 的本征值（单位为 hartree），后跟 $\\delta$ 的值。将所有报告的数字四舍五入到 $6$ 位小数。\n- 你的程序应生成单行输出，其中包含所有案例的结果，格式为由逗号分隔的各案例列表的列表，并用方括号括起来。例如，一个有效的输出结构是\n  $$\n  \\big[ [\\cdots], [\\cdots], [\\cdots] \\big],\n  $$\n  所有数字都四舍五- 入到 $6$ 位小数。不应打印任何额外文本。\n\n注：所有报告的能量都必须以 hartree 表示，并四舍五入到 $6$ 位小数。本问题不涉及角度。本问题不涉及百分比。该设计必须能够使用标准的线性代数原语在任何现代语言中通用实现，并且除了上面指定的矩阵外，不得依赖于外部输入。", "solution": "所呈现的问题是量子力学简并定态微扰理论中的一个标准且适定的练习，特别关注其在有限原子轨道基组中的矩阵表示。所有提供的信息都是完整、一致且科学合理的。不存在逻辑或物理上的缺陷。因此，可以构建一个严谨的解决方案。\n\n该问题要求计算一个具有 $g$ 重简并能级 $E_0$ 的体系的一阶能量修正及其对应的零阶波函数。张成此简并子空间的未微扰态记为 $\\{ \\lvert \\phi_a \\rangle \\}_{a=1}^g$。这些态表示为底层的正交归一原子轨道（AO）基组 $\\{ \\lvert \\chi_\\mu \\rangle \\}_{\\mu=1}^n$ 的线性组合。其展开式为：\n$$\n\\lvert \\phi_a \\rangle = \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle C_{\\mu a}\n$$\n其中 $C$ 是一个 $n \\times g$ 的系数矩阵。态 $\\{ \\lvert \\phi_a \\rangle \\}$ 是正交归一的，这意味着 $\\langle \\phi_a \\lvert \\phi_b \\rangle = \\delta_{ab}$。在正交归一的 AO 基组中，此条件转化为矩阵方程 $C^\\top C = I_g$，其中 $I_g$ 是 $g \\times g$ 的单位矩阵。\n\n根据简并微扰理论，能量的一阶修正是微扰算符 $\\hat{V}$ 投影到简并子空间上的本征值。我们必须构建这个投影算符的矩阵表示，我们将其记为 $W$。这个 $g \\times g$ 矩阵的元素由基本定义给出：\n$$\nW_{ab} = \\langle \\phi_a \\lvert \\hat{V} \\rvert \\phi_b \\rangle\n$$\n为了计算这个表达式，我们代入 $\\lvert \\phi_a \\rangle$ 和 $\\lvert \\phi_b \\rangle$ 的 AO 展开式：\n$$\nW_{ab} = \\left\\langle \\sum_{\\mu=1}^n \\chi_\\mu C_{\\mu a} \\right\\lvert \\hat{V} \\left\\lvert \\sum_{\\nu=1}^n \\chi_\\nu C_{\\nu b} \\right\\rangle\n$$\n利用内积和算符的线性性质，并考虑到系数 $C_{\\mu a}$ 是实数，我们可以写出：\n$$\nW_{ab} = \\sum_{\\mu=1}^n \\sum_{\\nu=1}^n C_{\\mu a} C_{\\nu b} \\langle \\chi_\\mu \\lvert \\hat{V} \\rvert \\chi_\\nu \\rangle\n$$\n项 $\\langle \\chi_\\mu \\lvert \\hat{V} \\rvert \\chi_\\nu \\rangle$ 正是微扰算符在 AO 基中的矩阵元 $(V_{\\text{AO}})_{\\mu\\nu}$。代入此式可得：\n$$\nW_{ab} = \\sum_{\\mu=1}^n \\sum_{\\nu=1}^n C_{\\mu a} (V_{\\text{AO}})_{\\mu\\nu} C_{\\nu b}\n$$\n这个表达式是矩阵乘积的分量形式。注意到 $C_{\\mu a} = (C^\\top)_{a\\mu}$，我们有：\n$$\nW_{ab} = \\sum_{\\mu=1}^n (C^\\top)_{a\\mu} \\left( \\sum_{\\nu=1}^n (V_{\\text{AO}})_{\\mu\\nu} C_{\\nu b} \\right)\n$$\n括号中的项是矩阵乘积 $V_{\\text{AO}}C$ 的 $(\\mu, b)$ 元。因此，整个表达式是乘积 $C^\\top (V_{\\text{AO}}C)$ 的 $(a, b)$ 元。我们得到了有效微扰矩阵的紧凑矩阵公式：\n$$\nW = C^\\top V_{\\text{AO}} C\n$$\n由于 $V_{\\text{AO}}$ 是一个实对称矩阵，$W$ 也是实对称的。一阶能量修正 $\\{ E_k^{(1)} \\}_{k=1}^g$ 是 $W$ 的本征值。我们通过求解 $W$ 的本征值问题来找到它们：\n$$\nW U = U \\Lambda\n$$\n这里，$\\Lambda$ 是本征值的对角矩阵，$\\Lambda_{kk} = E_k^{(1)}$，$U$ 是一个正交矩阵（$U^\\top U = I_g$），其列是 $W$ 的相应本征矢。\n\n原始的简并态 $\\{ \\lvert \\phi_a \\rangle \\}$ 通常不是能将微扰对角化的正确的零阶态。正确的态，我们记为 $\\{ \\lvert \\psi_k \\rangle \\}_{k=1}^g$，是原始态的线性组合，其变换由本征矢矩阵 $U$ 给出：\n$$\n\\lvert \\psi_k \\rangle = \\sum_{a=1}^g \\lvert \\phi_a \\rangle U_{ak}\n$$\n这个变换确保了 $\\langle \\psi_k \\lvert \\hat{V} \\rvert \\psi_j \\rangle = E_k^{(1)} \\delta_{kj}$。为了找到这些新态的 AO 系数，我们构建矩阵 $\\widetilde{C}$，其列包含每个 $\\lvert \\psi_k \\rangle$ 的系数。我们将 $\\lvert \\phi_a \\rangle$ 的 AO 展开式代入 $\\lvert \\psi_k \\rangle$ 的表达式中：\n$$\n\\lvert \\psi_k \\rangle = \\sum_{a=1}^g \\left( \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle C_{\\mu a} \\right) U_{ak} = \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle \\left( \\sum_{a=1}^g C_{\\mu a} U_{ak} \\right)\n$$\n括号中的项是新系数矩阵 $\\widetilde{C}$ 的 $(\\mu, k)$ 元。这对应于矩阵乘积：\n$$\n\\widetilde{C} = C U\n$$\n最后，我们必须验证新态 $\\{ \\lvert \\psi_k \\rangle \\}$ 是正交归一的。它们的内积是 $\\langle \\psi_k \\lvert \\psi_j \\rangle = \\delta_{kj}$。在 AO 基中，这由矩阵 $\\widetilde{C}^\\top \\widetilde{C}$ 表示。我们可以从理论上验证这一点：\n$$\n\\widetilde{C}^\\top \\widetilde{C} = (C U)^\\top (C U) = U^\\top C^\\top C U\n$$\n使用初始条件 $C^\\top C = I_g$ 和 $U$ 是正交矩阵的性质（$U^\\top U = I_g$），我们有：\n$$\n\\widetilde{C}^\\top \\widetilde{C} = U^\\top I_g U = U^\\top U = I_g\n$$\n数值验证涉及计算 $\\widetilde{C}^\\top \\widetilde{C}$ 并测量其与单位矩阵 $I_g$ 的最大偏差。偏差 $\\delta$ 定义为：\n$$\n\\delta = \\max_{i,j} \\left| \\left( \\widetilde{C}^\\top \\widetilde{C} \\right)_{ij} - \\left( I_g \\right)_{ij} \\right|\n$$\n这个值应该接近于零，仅受机器浮点精度的限制。\n\n计算流程如下：\n1.  对于每个测试案例，取给定的矩阵 $V_{\\text{AO}}$ 和 $C$。\n2.  计算有效微扰矩阵 $W = C^\\top V_{\\text{AO}} C$。\n3.  求解对称矩阵 $W$ 的本征系统，以找到本征值（一阶能量修正, $E_k^{(1)}$）和本征矢矩阵 $U$。\n4.  将本征值按升序排序。\n5.  构建新的 AO 系数矩阵 $\\widetilde{C} = C U$。\n6.  计算正交归一性检查矩阵 $\\widetilde{C}^\\top \\widetilde{C}$。\n7.  计算与单位矩阵 $I_g$ 的最大绝对偏差 $\\delta$。\n8.  报告排序后的本征值和 $\\delta$，并四舍五入到指定的精度。\n\n该流程构成了在矩阵表示下简并微扰理论的一个完整且稳健的实现，并严格遵循基本原理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the degenerate perturbation theory problem for a given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2), 0],\n                [1/np.sqrt(2), 0],\n                [0, 1/np.sqrt(2)],\n                [0, 1/np.sqrt(2)]\n            ]),\n            \"V_AO\": np.array([\n                [2, 0, 1, 0],\n                [0, 4, 0, 1],\n                [1, 0, 3, 0],\n                [0, 1, 0, 5]\n            ])\n        },\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2)],\n                [1/np.sqrt(2)],\n                [0],\n                [0]\n            ]),\n            \"V_AO\": np.array([\n                [1, 0, 0, 0],\n                [0, 3, 0, 0],\n                [0, 0, 5, 0],\n                [0, 0, 0, 7]\n            ])\n        },\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2), 0, 0],\n                [1/np.sqrt(2), 0, 0],\n                [0, 1/np.sqrt(2), 0],\n                [0, 1/np.sqrt(2), 0],\n                [0, 0, 1]\n            ]),\n            \"V_AO\": np.array([\n                [6, 2, 1, 0, 1],\n                [2, 6, 0, 1, 0],\n                [1, 0, 8, -1, 0],\n                [0, 1, -1, 10, 2],\n                [1, 0, 0, 2, 12]\n            ])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        C = case[\"C\"]\n        V_AO = case[\"V_AO\"]\n        \n        # Get dimensions\n        n, g = C.shape\n\n        # Step 1: Construct the effective perturbation matrix W in the degenerate subspace.\n        # W = C^T * V_AO * C\n        W = C.T @ V_AO @ C\n\n        # Step 2: Diagonalize W to get first-order energy corrections and the transformation matrix U.\n        # np.linalg.eigh is used for symmetric/Hermitian matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns.\n        energy_corrections, U = np.linalg.eigh(W)\n\n        # The energy corrections are the eigenvalues, already sorted.\n\n        # Step 3: Construct the transformed degenerate-state AO coefficients C_tilde.\n        # C_tilde = C * U\n        C_tilde = C @ U\n\n        # Step 4: Verify orthonormality of the transformed coefficients.\n        # Compute the identity matrix of size g for comparison.\n        I_g = np.identity(g)\n        \n        # Compute the Gram matrix of the new coefficients.\n        ortho_check_matrix = C_tilde.T @ C_tilde\n        \n        # Compute the maximum absolute deviation from the identity matrix.\n        delta = np.max(np.abs(ortho_check_matrix - I_g))\n        \n        # Collect results for the current case.\n        # Format all numbers to 6 decimal places.\n        case_results = [f\"{val:.6f}\" for val in energy_corrections]\n        case_results.append(f\"{delta:.6f}\")\n        \n        all_results.append(f\"[{','.join(case_results)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2767462"}]}