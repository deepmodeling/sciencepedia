{"hands_on_practices": [{"introduction": "我们的实践探索始于一项基础练习：分析推导两个通用笛卡尔高斯型轨道之间的重叠积分[@problem_id:2780117]。这项练习对于掌握整个分子积分理论中使用的核心技术至关重要，包括高斯乘积定理和变量分离。通过完成此推导，您将从第一性原理层面理解如何系统地处理多项式因子，以获得解析解。", "problem": "两个原始笛卡尔高斯型轨道 (GTO) 分别以位于 $\\mathbf{A} = (A_{x},A_{y},A_{z})$ 和 $\\mathbf{B} = (B_{x},B_{y},B_{z})$ 的原子核为中心，其正指数分别为 $\\alpha_{a}$ 和 $\\alpha_{b}$，笛卡尔角动量元组分别为 $(i_{a},j_{a},k_{a})$ 和 $(i_{b},j_{b},k_{b})$。令\n$$\n\\phi_{a}(\\mathbf{r}) \\;=\\; N_{a}\\,(x-A_{x})^{i_{a}}(y-A_{y})^{j_{a}}(z-A_{z})^{k_{a}}\\,\\exp\\!\\big(-\\alpha_{a}\\,|\\mathbf{r}-\\mathbf{A}|^{2}\\big),\n$$\n$$\n\\phi_{b}(\\mathbf{r}) \\;=\\; N_{b}\\,(x-B_{x})^{i_{b}}(y-B_{y})^{j_{b}}(z-B_{z})^{k_{b}}\\,\\exp\\!\\big(-\\alpha_{b}\\,|\\mathbf{r}-\\mathbf{B}|^{2}\\big),\n$$\n其中 $N_{a}$ 和 $N_{b}$ 是实数归一化常数（不必相等，也不必为1）。请仅使用基本且经过充分检验的事实，包括高斯乘积定理、三维笛卡尔积分可分离为一维积分之积的性质，以及 Hermite 高斯展开，从第一性原理推导重叠积分\n$$\nS_{ab} \\;=\\; \\int_{\\mathbb{R}^{3}} \\phi_{a}(\\mathbf{r})\\,\\phi_{b}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n的一个完全显式的闭式解析表达式。您的推导必须：(i) 识别并定义复合指数 $p=\\alpha_{a}+\\alpha_{b}$、高斯乘积中心 $\\mathbf{P}=\\big(P_{x},P_{y},P_{z}\\big)$（其中对于 $q\\in\\{x,y,z\\}$，$P_{q}=\\big(\\alpha_{a}A_{q}+\\alpha_{b}B_{q}\\big)/p$）以及约化指数 $\\mu=\\alpha_{a}\\alpha_{b}/p$；(ii) 阐明 Hermite 展开如何将多项式前因子组织成关于 $\\mathbf{P}$ 的导数；(iii) 计算必要的一维高斯矩，以获得一个明确表示为包含二项式系数和双阶乘的有限和之积的结果。请用 $\\alpha_{a}$、$\\alpha_{b}$、$\\mathbf{A}$、$\\mathbf{B}$、$N_{a}$、$N_{b}$ 和角动量整数来表示您的最终闭式结果。无需进行数值计算。将最终答案呈现为单个闭式解析表达式。不要将中间恒等式作为最终答案，也不要包含任何单位。", "solution": "所述问题是理论量子化学中一个定义明确且基础的任务。它要求推导两个通用笛卡尔高斯型轨道 (GTO) 之间重叠积分的解析表达式。该问题具有科学依据、自成体系且客观。所有给出的定义均为该领域的标准定义。因此，该问题是有效的，我将着手进行推导。\n\n重叠积分 $S_{ab}$ 由下式给出：\n$$S_{ab} \\;=\\; \\int_{\\mathbb{R}^{3}} \\phi_{a}(\\mathbf{r})\\,\\phi_{b}(\\mathbf{r}) \\, d\\mathbf{r}$$\n代入 GTO $\\phi_a$ 和 $\\phi_b$ 的定义：\n$$S_{ab} = N_{a}N_{b}\\int_{\\mathbb{R}^{3}} (x-A_{x})^{i_{a}}(y-A_{y})^{j_{a}}(z-A_{z})^{k_{a}} (x-B_{x})^{i_{b}}(y-B_{y})^{j_{b}}(z-B_{z})^{k_{b}} \\exp(-\\alpha_{a}|\\mathbf{r}-\\mathbf{A}|^2 - \\alpha_{b}|\\mathbf{r}-\\mathbf{B}|^2) \\, d^3\\mathbf{r}$$\n推导过程主要分为三个步骤：应用高斯乘积定理、分离积分以及计算所得的一维积分。\n\n**第1步：高斯乘积定理**\n\n两个高斯指数函数的乘积是单个高斯函数。我们分析其指数部分：\n$$-\\alpha_{a}|\\mathbf{r}-\\mathbf{A}|^2 - \\alpha_{b}|\\mathbf{r}-\\mathbf{B}|^2 = -\\alpha_{a}(\\mathbf{r}\\cdot\\mathbf{r} - 2\\mathbf{r}\\cdot\\mathbf{A} + \\mathbf{A}\\cdot\\mathbf{A}) - \\alpha_{b}(\\mathbf{r}\\cdot\\mathbf{r} - 2\\mathbf{r}\\cdot\\mathbf{B} + \\mathbf{B}\\cdot\\mathbf{B})$$\n$$= -(\\alpha_a+\\alpha_b)r^2 + 2(\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - (\\alpha_a A^2 + \\alpha_b B^2)$$\n我们定义复合指数 $p = \\alpha_{a}+\\alpha_{b}$ 和乘积高斯函数的中心 $\\mathbf{P} = \\frac{\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B}}{p}$。通过对 $\\mathbf{r}$ 配方，可以重写指数部分：\n$$-p|\\mathbf{r}-\\mathbf{P}|^2 = -p(r^2 - 2\\mathbf{r}\\cdot\\mathbf{P} + P^2) = -pr^2 + 2p\\mathbf{P}\\cdot\\mathbf{r} - pP^2$$\n将此代入我们的指数表达式中，得到：\n$$-p|\\mathbf{r}-\\mathbf{P}|^2 + pP^2 - (\\alpha_a A^2 + \\alpha_b B^2)$$\n常数项简化为：\n$$p P^2 - (\\alpha_a A^2 + \\alpha_b B^2) = \\frac{(\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B})^2}{p} - (\\alpha_a A^2 + \\alpha_b B^2) = -\\frac{\\alpha_a\\alpha_b}{p}|\\mathbf{A}-\\mathbf{B}|^2$$\n使用约化指数 $\\mu = \\frac{\\alpha_a\\alpha_b}{p}$，两个指数函数的乘积为：\n$$\\exp(-\\alpha_a|\\mathbf{r}-\\mathbf{A}|^2)\\exp(-\\alpha_b|\\mathbf{r}-\\mathbf{B}|^2) = \\exp(-\\mu |\\mathbf{A}-\\mathbf{B}|^2) \\exp(-p|\\mathbf{r}-\\mathbf{P}|^2)$$\n令 $K_{AB} = \\exp(-\\mu|\\mathbf{A}-\\mathbf{B}|^2)$。积分变为：\n$$S_{ab} = N_a N_b K_{AB} \\int \\left(\\prod_{q=x,y,z} (q-A_{q})^{\\ell_{a}^{(q)}} (q-B_{q})^{\\ell_{b}^{(q)}}\\right) \\exp(-p|\\mathbf{r}-\\mathbf{P}|^2) \\, d^3\\mathbf{r}$$\n其中 $\\ell_a^{(x)}=i_a, \\ell_a^{(y)}=j_a, \\ell_a^{(z)}=k_a$，对 $b$ 也类似。\n\n**第2步：变量分离**\n\n三维积分可分离为三个一维积分的乘积：\n$$S_{ab} = N_a N_b K_{AB} \\cdot I_x \\cdot I_y \\cdot I_z$$\n其中 $x$ 坐标的一维积分是：\n$$I_x = \\int_{-\\infty}^{\\infty} (x-A_{x})^{i_{a}} (x-B_{x})^{i_{b}} \\exp(-p(x-P_x)^2) \\, dx$$\n$I_y$ 和 $I_z$ 具有类似的表达式。我们将求解 $I_x$；$I_y$ 和 $I_z$ 的解可通过简单的变量和下标替换得到。\n\n**第3步：一维积分的计算**\n\n我们首先将多项式前因子表示为相对于新中心 $P_x$ 的形式，然后进行展开。令 $u = x-P_x$。那么 $x-A_x = u + (P_x-A_x)$ 且 $x-B_x = u + (P_x-B_x)$。被积函数的多项式部分变为：\n$$(u + (P_x-A_x))^{i_a} (u + (P_x-B_x))^{i_b}$$\n使用二项式定理，将其展开为：\n$$\\left(\\sum_{l=0}^{i_a} \\binom{i_a}{l} (P_x-A_x)^{i_a-l} u^l\\right) \\left(\\sum_{m=0}^{i_b} \\binom{i_b}{m} (P_x-B_x)^{i_b-m} u^m\\right)$$\n$$= \\sum_{l=0}^{i_a} \\sum_{m=0}^{i_b} \\binom{i_a}{l} \\binom{i_b}{m} (P_x-A_x)^{i_a-l} (P_x-B_x)^{i_b-m} u^{l+m}$$\n积分 $I_x$ 于是成为包含高斯矩的项的和：\n$$I_x = \\sum_{l=0}^{i_a} \\sum_{m=0}^{i_b} \\binom{i_a}{l} \\binom{i_b}{m} (P_x-A_x)^{i_a-l} (P_x-B_x)^{i_b-m} \\int_{-\\infty}^{\\infty} u^{l+m} \\exp(-pu^2) \\, du$$\n令 $M_k = \\int_{-\\infty}^{\\infty} u^k \\exp(-pu^2) \\, du$。由于积分区间的对称性，当 $k$ 为奇数时，$M_k = 0$。\n对于偶数 $k=2n$，我们可以根据“Hermite 展开”的背景提示，使用递推关系来推导其值。注意，对于任何函数 $f(u)$，有 $\\frac{d}{du} f(u) = -\\frac{d}{dP_x} f(u)$，其中 $u=x-P_x$。我们有 $u \\exp(-pu^2) = -\\frac{1}{2p}\\frac{d}{du}\\exp(-pu^2)$。\n对 $M_{2n} = \\int u^{2n-1} (u \\exp(-pu^2)) du$ 使用分部积分法：\n$$M_{2n} = \\left[u^{2n-1} \\left(-\\frac{1}{2p}\\exp(-pu^2)\\right)\\right]_{-\\infty}^{\\infty} - \\int \\left(-\\frac{1}{2p}\\exp(-pu^2)\\right) (2n-1)u^{2n-2} du = \\frac{2n-1}{2p} M_{2n-2}$$\n基本情况是 $M_0 = \\int_{-\\infty}^{\\infty} \\exp(-pu^2) \\, du = \\sqrt{\\frac{\\pi}{p}}$。\n通过重复应用该递推关系，我们发现：\n$$M_{2n} = \\frac{(2n-1)!!}{(2p)^n} M_0 = \\frac{(2n-1)!!}{(2p)^n} \\sqrt{\\frac{\\pi}{p}}$$\n其中 $(2n-1)!! = (2n-1)(2n-3)\\cdots1$ 是双阶乘，并且我们定义 $(-1)!!=1$。\n\n将这个矩的结果代入 $I_x$ 的表达式中，我们只对 $k=l+m$ 为偶数的项求和：\n$$I_x = \\sqrt{\\frac{\\pi}{p}} \\sum_{l=0}^{i_a} \\sum_{m=0}^{i_b} \\delta_{l+m, \\text{even}} \\binom{i_a}{l} \\binom{i_b}{m} (P_x-A_x)^{i_a-l} (P_x-B_x)^{i_b-m} \\frac{(l+m-1)!!}{(2p)^{(l+m)/2}}$$\n其中，如果 $l+m$ 是偶数，则 $\\delta_{l+m, \\text{even}}$ 为 1，否则为 0。\n\n涉及 $P_x$ 的因子可以用 $A_x, B_x$ 来表示：\n$$P_x - A_x = \\frac{\\alpha_a A_x + \\alpha_b B_x}{p} - A_x = \\frac{\\alpha_b(B_x-A_x)}{p}$$\n$$P_x - B_x = \\frac{\\alpha_a A_x + \\alpha_b B_x}{p} - B_x = \\frac{\\alpha_a(A_x-B_x)}{p}$$\n代入这些表达式可以为求和项得到一个更基本的形式。我们为每个坐标 $q \\in \\{x,y,z\\}$ 定义一个分量和 $E_q$。对于 $x$：\n$$E_x(i_a, i_b) = \\sum_{l=0}^{i_a} \\sum_{m=0}^{i_b} \\delta_{l+m, \\text{even}} \\binom{i_a}{l}\\binom{i_b}{m} \\left(\\frac{\\alpha_b(B_x-A_x)}{p}\\right)^{i_a-l} \\left(\\frac{\\alpha_a(A_x-B_x)}{p}\\right)^{i_b-m} \\frac{(l+m-1)!!}{(2p)^{(l+m)/2}}$$\n于是 $I_x = \\sqrt{\\pi/p} \\cdot E_x(i_a, i_b)$。$I_y, I_z$ 也有类似的表达式。\n总重叠积分为：\n$$S_{ab} = N_a N_b K_{AB} (\\pi/p)^{3/2} E_x(i_a, i_b) E_y(j_a, j_b) E_z(k_a, k_b)$$\n这就是最终的闭式表达式。我们现在将其完整写出作为最终答案。", "answer": "$$\n\\boxed{\n\\begin{aligned}\nS_{ab} = \\;  N_a N_b \\exp\\left(-\\frac{\\alpha_a \\alpha_b}{\\alpha_a+\\alpha_b}|\\mathbf{A}-\\mathbf{B}|^2\\right) \\left(\\frac{\\pi}{\\alpha_a+\\alpha_b}\\right)^{3/2} \\\\\n \\times \\left[ \\sum_{l_x=0}^{i_a} \\sum_{m_x=0}^{i_b} \\delta_{l_x+m_x, \\text{even}} \\binom{i_a}{l_x} \\binom{i_b}{m_x} (P_x-A_x)^{i_a-l_x} (P_x-B_x)^{i_b-m_x} \\frac{(l_x+m_x-1)!!}{(2(\\alpha_a+\\alpha_b))^{(l_x+m_x)/2}} \\right] \\\\\n \\times \\left[ \\sum_{l_y=0}^{j_a} \\sum_{m_y=0}^{j_b} \\delta_{l_y+m_y, \\text{even}} \\binom{j_a}{l_y} \\binom{j_b}{m_y} (P_y-A_y)^{j_a-l_y} (P_y-B_y)^{j_b-m_y} \\frac{(l_y+m_y-1)!!}{(2(\\alpha_a+\\alpha_b))^{(l_y+m_y)/2}} \\right] \\\\\n \\times \\left[ \\sum_{l_z=0}^{k_a} \\sum_{m_z=0}^{k_b} \\delta_{l_z+m_z, \\text{even}} \\binom{k_a}{l_z} \\binom{k_b}{m_z} (P_z-A_z)^{k_a-l_z} (P_z-B_z)^{k_b-m_z} \\frac{(l_z+m_z-1)!!}{(2(\\alpha_a+\\alpha_b))^{(l_z+m_z)/2}} \\right]\n\\end{aligned}\n}\n$$", "id": "2780117"}, {"introduction": "多电子积分的计算量巨大，但通常可以通过将其简化为对一个特殊函数——Boys函数 $F_n(T)$ 的求值来处理。本练习将我们的焦点从整个积分转移到对此关键组成部分的详细分析，探索其级数展开、误差控制和递推性质[@problem_id:2780098]。掌握 Boys 函数的行为对于开发稳定高效的积分计算算法至关重要。", "problem": "在电子结构理论中，对高斯型轨道的电子排斥积分可以归约为Boys函数的求值。对于非负整数$n$，该函数由如下收敛积分定义\n$$\nF_{n}(T) \\equiv \\int_{0}^{1} x^{2n} \\exp\\!\\big(-T x^{2}\\big)\\, dx, \\quad T \\ge 0.\n$$\n从该积分定义出发，仅使用实分析和微积分中的基础工具（例如指数函数的级数定义和分部积分法），完成以下各项：\n\n1. 将指数函数展开为麦克劳林级数，并证明在区间 $[0,1]$ 上逐项积分的合理性，从而推导出如下形式的小$T$幂级数：\n$$\nF_{n}(T) = \\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k! \\big(2n + 2k + 1\\big)}.\n$$\n2. 将此级数的前 $(N+1)$ 项截断和记为 $S_{N}(T)$，\n$$\nS_{N}(T) \\equiv \\sum_{k=0}^{N} \\frac{(-T)^{k}}{k! \\big(2n + 2k + 1\\big)},\n$$\n并定义余项 $R_{N}(T) \\equiv F_{n}(T) - S_{N}(T)$。为 $|R_{N}(T)|$ 建立两个严格的上界：\n   - 一个对所有 $T \\ge 0$ 和固定的 $n \\in \\mathbb{N}_{0}$ 都有效的通用界，其形式为\n   $$\n   |R_{N}(T)| \\le \\frac{C(T)}{2n + 2N + 3}\\, \\frac{T^{N+1}}{(N+1)!},\n   $$\n   其中 $C(T)$ 是一个您必须确定的显式函数。\n   - 一个专门针对 $0  T \\le 1$ 的交错级数界，该界利用了级数项绝对值的单调递减性。\n3. 从 $F_{n}(T)$ 的积分定义出发，推导一个连接 $F_{n+1}(T)$、$F_{n}(T)$ 和 $\\exp(-T)$ 的三项线性递推关系，且不引入除指数函数外的任何特殊函数。请明确写出该递推关系，并指出在 $T$ 很小时其数值计算的稳定方向。\n4. 对于 $T = 0.8$ 和 $n = 2$ 的具体情况，确定最小的非负整数 $N$，使得由 $S_{N}(T)$ 产生的绝对截断误差 $|R_{N}(T)|$ 满足\n$$\n|R_{N}(T)|  1.0 \\times 10^{-10}.\n$$\n请使用第2部分中为 $0  T \\le 1$ 推导的交错级数误差控制。给出满足条件的最小 $N$ 作为最终答案。最终答案必须是单个整数，无需四舍五入。", "solution": "我们从积分定义出发\n$$\nF_{n}(T) \\equiv \\int_{0}^{1} x^{2n} \\exp\\!\\big(-T x^{2}\\big)\\, dx,\n$$\n其中 $n \\in \\mathbb{N}_{0}$ 且 $T \\ge 0$。\n\n1. 小$T$的级数推导。指数函数的麦克劳林级数为\n$$\n\\exp\\!\\big(-T x^{2}\\big) = \\sum_{k=0}^{\\infty} \\frac{(-T x^{2})^{k}}{k!} = \\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k!} x^{2k},\n$$\n根据魏尔斯特拉斯M判别法，对于任意固定的 $T \\ge 0$，该级数在 $x \\in [0,1]$ 上绝对且一致收敛，因为\n$$\n\\left|\\frac{(-T)^{k}}{k!} x^{2k}\\right| \\le \\frac{T^{k}}{k!} \\quad \\text{且} \\quad \\sum_{k=0}^{\\infty} \\frac{T^{k}}{k!} = \\exp(T)  \\infty.\n$$\n因此，我们可以逐项积分：\n$$\nF_{n}(T)\n= \\int_{0}^{1} x^{2n} \\left(\\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k!} x^{2k}\\right)\\, dx\n= \\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k!} \\int_{0}^{1} x^{2n+2k}\\, dx\n= \\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k!} \\frac{1}{2n + 2k + 1}.\n$$\n故而，\n$$\nF_{n}(T) = \\sum_{k=0}^{\\infty} \\frac{(-T)^{k}}{k!\\big(2n + 2k + 1\\big)}.\n$$\n\n2. 截断误差界。定义\n$$\nS_{N}(T) \\equiv \\sum_{k=0}^{N} \\frac{(-T)^{k}}{k!\\big(2n + 2k + 1\\big)}, \n\\quad\nR_{N}(T) \\equiv F_{n}(T) - S_{N}(T) = \\sum_{k=N+1}^{\\infty} \\frac{(-T)^{k}}{k!\\big(2n + 2k + 1\\big)}.\n$$\n- 对所有 $T \\ge 0$ 的通用界。对于 $k \\ge N+1$，我们有 $2n + 2k + 1 \\ge 2n + 2(N+1) + 1 = 2n + 2N + 3$，因此\n$$\n|R_{N}(T)| \\le \\sum_{k=N+1}^{\\infty} \\frac{T^{k}}{k!\\big(2n + 2k + 1\\big)}\n\\le \\frac{1}{2n + 2N + 3} \\sum_{k=N+1}^{\\infty} \\frac{T^{k}}{k!}.\n$$\n使用指数级数的拉格朗日余项形式，可得\n$$\n\\sum_{k=N+1}^{\\infty} \\frac{T^{k}}{k!} \\le \\exp(T)\\,\\frac{T^{N+1}}{(N+1)!}.\n$$\n因此，一个对所有 $T \\ge 0$ 都有效的显式界是\n$$\n|R_{N}(T)| \\le \\frac{\\exp(T)}{2n + 2N + 3}\\,\\frac{T^{N+1}}{(N+1)!}.\n$$\n所以，要求的函数是 $C(T) = \\exp(T)$。\n\n- 针对 $0  T \\le 1$ 的交错级数界。当 $T > 0$ 时，级数项的符号是交错的。令\n$$\na_{k} \\equiv \\frac{T^{k}}{k!\\big(2n + 2k + 1\\big)}, \\quad k \\ge 0.\n$$\n我们证明当 $0  T \\le 1$ 时，序列 $\\{a_{k}\\}_{k \\ge 0}$ 是严格递减的：\n$$\n\\frac{a_{k+1}}{a_{k}} = \\frac{T}{k+1} \\cdot \\frac{2n + 2k + 1}{2n + 2k + 3}  \\frac{T}{k+1} \\le T \\le 1,\n$$\n所以当 $0  T \\le 1$ 时，对所有 $k \\ge 0$ 都有 $a_{k+1}  a_k$ 成立。根据莱布尼兹判别法（交错级数审敛法），在第 $N$ 项截断后的余项满足\n$$\n|R_{N}(T)| \\le a_{N+1} = \\frac{T^{N+1}}{(N+1)!\\big(2n + 2(N+1) + 1\\big)} = \\frac{T^{N+1}}{(N+1)!\\big(2n + 2N + 3\\big)}.\n$$\n\n3. 通过分部积分法推导三项递推关系。从\n$$\nF_{n+1}(T) = \\int_{0}^{1} x^{2n+2} \\exp\\!\\big(-T x^{2}\\big)\\, dx,\n$$\n出发，考虑\n$$\n2T F_{n+1}(T) = \\int_{0}^{1} \\big(2T x\\big) x^{2n+1} \\exp\\!\\big(-T x^{2}\\big)\\, dx.\n$$\n令 $u = x^{2n+1}$ 和 $dv = 2T x \\exp(-T x^{2})\\, dx$，则 $du = (2n+1) x^{2n}\\, dx$ 和 $v = -\\exp(-T x^{2})$。分部积分得出\n$$\n2T F_{n+1}(T) = \\big[ - x^{2n+1} \\exp(-T x^{2}) \\big]_{0}^{1} + (2n+1) \\int_{0}^{1} x^{2n} \\exp(-T x^{2})\\, dx.\n$$\n边界项在 $x=1$ 处的值为 $-\\exp(-T)$，在 $x=0$ 处的值为 $0$，因此\n$$\n2T F_{n+1}(T) = - \\exp(-T) + (2n+1) F_{n}(T).\n$$\n等价地，\n$$\n(2n+1) F_{n}(T) = 2T F_{n+1}(T) + \\exp(-T).\n$$\n对于较小的 $T$，此递推关系在向下方向（从较大的 $n$到较小的$n$）是数值稳定的，而向上方向可能因减去 $\\exp(-T)$（当$T$很小时）而导致有效位数损失。\n\n此外，在积分号下求导可得\n$$\n\\frac{d}{dT} F_{n}(T) = - \\int_{0}^{1} x^{2n+2} \\exp(-T x^{2})\\, dx = - F_{n+1}(T),\n$$\n这与该递推关系相容。\n\n4. 对于 $T = 0.8$ 和 $n=2$，为使 $|R_{N}(T)|  1.0 \\times 10^{-10}$ 成立，求最小的 $N$。由于 $0  T \\le 1$，我们可以使用交错级数的下一项上界：\n$$\n|R_{N}(T)| \\le a_{N+1} = \\frac{T^{N+1}}{(N+1)!\\big(2n + 2N + 3\\big)}.\n$$\n这里 $T = 0.8$，$n = 2$，所以\n$$\na_{N+1} = \\frac{(0.8)^{N+1}}{(N+1)!\\,\\big(2\\cdot 2 + 2N + 3\\big)} = \\frac{(0.8)^{N+1}}{(N+1)!\\,\\big(2N + 7\\big)}.\n$$\n我们寻求最小的非负整数 $N \\in \\mathbb{N}_{0}$ 使得 $a_{N+1}  1.0 \\times 10^{-10}$。顺序计算 $a_k$（单调递减确保一旦低于阈值便会保持低于该阈值）：\n- $k = 1$: $a_{1} = \\dfrac{0.8}{7} \\approx 1.142857142857143 \\times 10^{-1}$。\n- $k = 2$: $a_{2} = \\dfrac{0.8^{2}}{2!\\cdot 9} = \\dfrac{0.64}{18} \\approx 3.555555555555556 \\times 10^{-2}$。\n- $k = 3$: $a_{3} = \\dfrac{0.8^{3}}{3!\\cdot 11} = \\dfrac{0.512}{66} \\approx 7.757575757575758 \\times 10^{-3}$。\n- $k = 4$: $a_{4} = \\dfrac{0.8^{4}}{4!\\cdot 13} = \\dfrac{0.4096}{312} \\approx 1.312820512820513 \\times 10^{-3}$。\n- $k = 5$: $a_{5} = \\dfrac{0.8^{5}}{5!\\cdot 15} = \\dfrac{0.32768}{1800} \\approx 1.820444444444444 \\times 10^{-4}$。\n- $k = 6$: $a_{6} = \\dfrac{0.8^{6}}{6!\\cdot 17} = \\dfrac{0.262144}{12240} \\approx 2.142483660130719 \\times 10^{-5}$。\n- $k = 7$: $a_{7} = \\dfrac{0.8^{7}}{7!\\cdot 19} = \\dfrac{0.2097152}{95760} \\approx 2.189021506105006 \\times 10^{-6}$。\n- $k = 8$: $a_{8} = \\dfrac{0.8^{8}}{8!\\cdot 21} = \\dfrac{0.16777216}{846720} \\approx 1.983272279840681 \\times 10^{-7}$。\n- $k = 9$: $a_{9} = \\dfrac{0.8^{9}}{9!\\cdot 23} = \\dfrac{0.134217728}{8346240} \\approx 1.608221429316317 \\times 10^{-8}$。\n- $k = 10$: $a_{10} = \\dfrac{0.8^{10}}{10!\\cdot 25} = \\dfrac{0.1073741824}{90720000} \\approx 1.184094767932489 \\times 10^{-9}$。\n- $k = 11$: $a_{11} = \\dfrac{0.8^{11}}{11!\\cdot 27} = \\dfrac{0.08589934592}{1077753600} \\approx 7.964090027311383 \\times 10^{-11}$。\n\n第一个使得 $a_{k}  1.0 \\times 10^{-10}$ 的索引是 $k = 11$。因为 $a_{N+1} = a_{k}$ 且 $k = N+1$，所以满足所需上界条件的最小 $N$ 是 $N=10$。\n\n因此，使用适用于 $0  T \\le 1$ 的交错级数界，最小截断阶数为 $N=10$。", "answer": "$$\\boxed{10}$$", "id": "2780098"}, {"introduction": "为了准确高效地计算电子排斥积分，特别是那些涉及高角动量的积分，先进的数值方法是不可或缺的。本练习深入探讨 Rys 正交积分法，这是一种将积分计算转化为定制高斯正交积分问题的强大算法[@problem_id:2780078]。您将实现该方法的关键步骤，从矩的计算到正交积分规则的构建，从而具体了解现代量子化学程序如何处理这些复杂积分。", "problem": "实现一个完整的程序，该程序演示对四个原始笛卡尔高斯函数之间类型为 $\\left(d\\, s \\mid p\\, s\\right)$ 的代表性电子排斥积分进行双根 Rys 正交积分求值。目标是计算与 Boys 函数参数相关联的 Rys 节点和权重，并利用这些节点和权重展示最高三次多项式因子的精确收缩。该演示必须纯粹以数学术语进行阐述，并且必须是自包含的。\n\n考虑四个原始笛卡尔高斯函数，它们位于三维空间中的点 $\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$ 和 $\\mathbf{D}$ 上，其轨道角动量分别为 $\\ell = 2$（单个笛卡尔 $d$ 型函数）、$\\ell = 0$（$s$ 型函数）、$\\ell = 1$（单个笛卡尔 $p$ 型函数）和 $\\ell = 0$（$s$ 型函数）。为明确起见，设 $d$ 型和 $p$ 型函数为所有角动量都沿 $x$ 轴的笛卡尔分量，即 $d_{xx}$ 和 $p_x$，并设 $s$ 型函数为各向同性。设位于 $\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$ 和 $\\mathbf{D}$ 上函数的的高斯指数分别为 $\\alpha_a$、$\\alpha_b$、$\\alpha_c$ 和 $\\alpha_d$。\n\n使用高斯乘积定理为 bra 和 ket 对定义复合指数和中心：\n- $p = \\alpha_a + \\alpha_b$， $q = \\alpha_c + \\alpha_d$，\n- $\\mathbf{P} = \\dfrac{\\alpha_a \\mathbf{A} + \\alpha_b \\mathbf{B}}{p}$， $\\mathbf{Q} = \\dfrac{\\alpha_c \\mathbf{C} + \\alpha_d \\mathbf{D}}{q}$。\n\n定义标准 Boys 函数参数\n$$\n\\rho = \\dfrac{p\\, q}{p+q}, \\quad T = \\rho \\, \\lVert \\mathbf{P} - \\mathbf{Q} \\rVert^2.\n$$\n对于所有角动量都沿 $x$ 轴的 $\\left(d\\, s \\mid p\\, s\\right)$ 情况，沿 $x$ 轴的总笛卡尔角动量为 $L_x = 3$，而沿 $y$ 和 $z$ 轴的总笛卡尔角动量为 $L_y = 0$ 和 $L_z = 0$。在 Rys 正交积分公式中，这意味着对辅助变量 $u \\in [0,1]$ 和权重函数 $\\exp(-T u^2)$ 进行双根正交积分（$n = 2$），因为 $u$ 中的多项式因子次数不超过 3。\n\n您的任务是：\n1. 对于每个指定的参数集，计算 $p$、$q$、$\\mathbf{P}$、$\\mathbf{Q}$、$\\rho$ 和 $T$。\n2. 计算前四个形式如下的加权矩\n$$\nM_k(T) = \\int_0^1 u^k \\, e^{-T u^2} \\, du = \\dfrac{1}{2} \\int_0^1 s^{\\frac{k-1}{2}} e^{-T s} \\, ds = \\dfrac{1}{2} \\, \\dfrac{\\gamma\\!\\left(\\dfrac{k+1}{2},\\, T\\right)}{T^{\\frac{k+1}{2}}}\n$$\n其中 $k \\in \\{0,1,2,3\\}$，$\\gamma(a,x)$ 表示下不完全伽马函数。\n3. 通过使用 Stieltjes 过程获得关于内积 $\\langle f,g\\rangle = \\int_0^1 f(u) g(u) e^{-T u^2} \\, du$ 的首一正交多项式的前两个递推系数，构建在 $[0,1]$ 上权重为 $\\exp(-T u^2)$ 的双节点高斯正交积分：\n   - 定义 $\\mu_k = M_k(T)$（其中 $k \\in \\{0,1,2,3\\}$），设首一多项式为 $\\pi_0(u) = 1$ 和 $\\pi_1(u) = u - \\alpha_0$，其中\n     $$\n     \\alpha_0 = \\dfrac{\\mu_1}{\\mu_0}.\n     $$\n   - 定义\n     $$\n     \\langle \\pi_1, \\pi_1 \\rangle = \\mu_2 - 2 \\alpha_0 \\mu_1 + \\alpha_0^2 \\mu_0, \\quad\n     \\langle u \\pi_1, \\pi_1 \\rangle = \\mu_3 - 2 \\alpha_0 \\mu_2 + \\alpha_0^2 \\mu_1.\n     $$\n     然后\n     $$\n     \\alpha_1 = \\dfrac{\\langle u \\pi_1, \\pi_1 \\rangle}{\\langle \\pi_1, \\pi_1 \\rangle}, \\quad\n     \\beta_1 = \\dfrac{\\langle \\pi_1, \\pi_1 \\rangle}{\\langle \\pi_0, \\pi_0 \\rangle} = \\dfrac{\\langle \\pi_1, \\pi_1 \\rangle}{\\mu_0}.\n     $$\n   - 构建 $2 \\times 2$ 的雅可比矩阵\n     $$\n     J = \\begin{bmatrix}\n     \\alpha_0  \\sqrt{\\beta_1} \\\\\n     \\sqrt{\\beta_1}  \\alpha_1\n     \\end{bmatrix}.\n     $$\n     其特征值 $\\{u_1,u_2\\}$ 是 $(0,1)$ 中的节点，相应的归一化特征向量 $\\mathbf{v}_i$ 产生权重 $w_i = \\mu_0 \\, (\\mathbf{v}_i)_1^2$，其中 $(\\mathbf{v}_i)_1$ 表示 $\\mathbf{v}_i$ 的第一个分量。\n4. 通过使用双节点正交积分重构四个矩，来验证最高三次多项式因子的精确收缩：\n$$\n\\widehat{M}_k(T) = \\sum_{i=1}^2 w_i \\, u_i^k, \\quad k \\in \\{0,1,2,3\\}.\n$$\n对于每个参数集，计算最大绝对偏差\n$$\n\\varepsilon = \\max_{k \\in \\{0,1,2,3\\}} \\left| \\widehat{M}_k(T) - M_k(T) \\right|.\n$$\n将此 $\\varepsilon$ 报告为浮点数。\n\n测试套件和输入数据直接嵌入程序中，不得要求用户输入。使用以下三种情况，以涵盖典型场景、近重合极限（小 $T$）和大间距极限（大 $T$）。在每种情况下，所有坐标都在同一个任意笛卡尔坐标系中，所有指数均为正实数。\n\n- 情况 1（中等间距）：\n  - $\\alpha_a = 0.8$, $\\alpha_b = 0.5$, $\\alpha_c = 0.7$, $\\alpha_d = 0.6$,\n  - $\\mathbf{A} = (0.0, 0.0, 0.0)$, $\\mathbf{B} = (0.0, 0.0, 0.0)$,\n  - $\\mathbf{C} = (1.1, 0.0, 0.0)$, $\\mathbf{D} = (1.1, 0.0, 0.0)$.\n\n- 情况 2（ket 对的中心近重合）：\n  - $\\alpha_a = 0.8$, $\\alpha_b = 0.5$, $\\alpha_c = 0.7$, $\\alpha_d = 0.6$,\n  - $\\mathbf{A} = (0.0, 0.0, 0.0)$, $\\mathbf{B} = (0.0, 0.0, 0.0)$,\n  - $\\mathbf{C} = (0.01, 0.0, 0.0)$, $\\mathbf{D} = (0.01, 0.0, 0.0)$.\n\n- 情况 3（大间距）：\n  - $\\alpha_a = 0.8$, $\\alpha_b = 0.5$, $\\alpha_c = 0.7$, $\\alpha_d = 0.6$,\n  - $\\mathbf{A} = (0.0, 0.0, 0.0)$, $\\mathbf{B} = (0.0, 0.0, 0.0)$,\n  - $\\mathbf{C} = (4.0, 0.0, 0.0)$, $\\mathbf{D} = (4.0, 0.0, 0.0)$.\n\n您的程序必须：\n- 为每种情况计算 $T$，\n- 通过 Stieltjes 和 Golub–Welsch 步骤，为在 $[0,1]$ 上的权重 $\\exp(-T u^2)$ 构建双节点 Rys 正交积分，\n- 为每种情况评估如上定义的 $\\varepsilon$，\n- 生成单行输出，其中包含三个结果，格式为方括号内以逗号分隔的列表，例如 $\\left[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3\\right]$。\n\n不需要物理单位，所有计算在构造上都是无量纲的。", "solution": "目标是为区间 $[0,1]$ 上的权重函数 $w(u) = \\exp(-T u^2)$ 实现并验证一个双节点 Rys 正交积分。这种特定的正交积分方法在量子化学中某些电子排斥积分的计算中至关重要。对于最高三次的多项式前置因子，双节点高斯正交积分可提供精确结果，我们将演示这一原理。该过程涉及几个不同的数学步骤，将对所提供的三个测试用例分别执行这些步骤。\n\n首先，我们确定表征该正交积分的参数 $T$。该参数源于相互作用的高斯函数的物理性质。给定四个中心在 $\\mathbf{A}$、$\\mathbf{B}$、$\\mathbf{C}$ 和 $\\mathbf{D}$ 且指数为 $\\alpha_a$、$\\alpha_b$、$\\alpha_c$ 和 $\\alpha_d$ 的原始笛卡尔高斯函数，我们应用高斯乘积定理。该定理将高斯函数对合并为单个高斯函数。对于 bra 对 $(\\phi_a, \\phi_b)$ 和 ket 对 $(\\phi_c, \\phi_d)$，其复合指数和中心为：\n$$\np = \\alpha_a + \\alpha_b, \\quad \\mathbf{P} = \\dfrac{\\alpha_a \\mathbf{A} + \\alpha_b \\mathbf{B}}{p}\n$$\n$$\nq = \\alpha_c + \\alpha_d, \\quad \\mathbf{Q} = \\dfrac{\\alpha_c \\mathbf{C} + \\alpha_d \\mathbf{D}}{q}\n$$\n参数 $T$ 随后定义为：\n$$\nT = \\rho \\, \\lVert \\mathbf{P} - \\mathbf{Q} \\rVert^2, \\quad \\text{其中} \\quad \\rho = \\dfrac{p\\, q}{p+q}\n$$\n对于给定的测试用例，中心满足 $\\mathbf{A} = \\mathbf{B}$ 和 $\\mathbf{C} = \\mathbf{D}$，这将复合中心简化为 $\\mathbf{P} = \\mathbf{A}$ 和 $\\mathbf{Q} = \\mathbf{C}$。\n\n其次，我们计算权重函数 $w(u) = \\exp(-T u^2)$ 在区间 $[0,1]$ 上的前四个矩 $\\mu_k$。这些矩是构建与正交积分相关的正交多项式所必需的。矩由以下积分定义：\n$$\n\\mu_k \\equiv M_k(T) = \\int_0^1 u^k \\, e^{-T u^2} \\, du\n$$\n该积分可以用下不完全伽马函数 $\\gamma(a,x)$ 解析地求值。通过代换 $s = u^2$，我们得到问题描述中提供的表达式：\n$$\nM_k(T) = \\dfrac{1}{2} \\int_0^1 s^{\\frac{k-1}{2}} e^{-T s} \\, ds = \\dfrac{1}{2} \\, \\dfrac{\\gamma\\!\\left(\\dfrac{k+1}{2},\\, T\\right)}{T^{\\frac{k+1}{2}}}\n$$\n我们计算 $k \\in \\{0, 1, 2, 3\\}$ 时的这些矩。\n\n第三，我们使用这些矩来构建 $2 \\times 2$ 的雅可比矩阵。这是通过 Stieltjes 过程实现的，该过程为关于内积 $\\langle f,g\\rangle = \\int_0^1 f(u) g(u) e^{-T u^2} \\, du$ 正交的首一多项式族 $\\{\\pi_j(u)\\}$ 生成递推系数。这些多项式满足三项递推关系 $\\pi_{j+1}(u) = (u - \\alpha_j)\\pi_j(u) - \\beta_j \\pi_{j-1}(u)$。对于双节点正交积分（$n=2$），我们需要系数 $\\alpha_0$、$\\alpha_1$ 和 $\\beta_1$。\n第一个首一多项式是 $\\pi_0(u)=1$。\n递推系数由矩 $\\mu_k$ 确定：\n$$\n\\alpha_0 = \\dfrac{\\langle u\\pi_0, \\pi_0 \\rangle}{\\langle \\pi_0, \\pi_0 \\rangle} = \\dfrac{\\mu_1}{\\mu_0}\n$$\n第二个首一多项式是 $\\pi_1(u) = u - \\alpha_0$。利用它，我们求出 $\\beta_1$ 和 $\\alpha_1$：\n$$\n\\beta_1 = \\dfrac{\\langle \\pi_1, \\pi_1 \\rangle}{\\langle \\pi_0, \\pi_0 \\rangle} = \\dfrac{\\mu_2 - 2\\alpha_0\\mu_1 + \\alpha_0^2\\mu_0}{\\mu_0}\n$$\n$$\n\\alpha_1 = \\dfrac{\\langle u\\pi_1, \\pi_1 \\rangle}{\\langle \\pi_1, \\pi_1 \\rangle} = \\dfrac{\\mu_3 - 2\\alpha_0\\mu_2 + \\alpha_0^2\\mu_1}{\\mu_2 - 2\\alpha_0\\mu_1 + \\alpha_0^2\\mu_0}\n$$\n这些系数构成了 $n=2$ 时的对称三对角雅可比矩阵：\n$$\nJ = \\begin{bmatrix}\n\\alpha_0  \\sqrt{\\beta_1} \\\\\n\\sqrt{\\beta_1}  \\alpha_1\n\\end{bmatrix}\n$$\n\n第四，我们通过求解雅可比矩阵 $J$ 的特征系统来获得正交积分节点 $u_i$ 和权重 $w_i$。这就是 Golub-Welsch 算法的精髓。$J$ 的特征值是正交积分节点 $\\{u_1, u_2\\}$。相应的归一化特征向量 $\\mathbf{v}_i$ 用于计算权重：\n$$\nw_i = \\mu_0 \\, (\\mathbf{v}_i)_1^2\n$$\n其中 $(\\mathbf{v}_i)_1$ 表示特征向量 $\\mathbf{v}_i$ 的第一个分量。\n\n最后，我们验证所构建的双节点正交积分对于最高三次的多项式是精确的。这是通过使用计算出的节点和权重来数值计算前四个矩来完成的：\n$$\n\\widehat{M}_k(T) = \\sum_{i=1}^2 w_i \\, u_i^k, \\quad \\text{for } k \\in \\{0, 1, 2, 3\\}\n$$\n理论上的精确性意味着 $\\widehat{M}_k(T)$ 应等于 $M_k(T)$。我们通过计算这四个矩的最大绝对误差来量化任何由浮点不精确性引起的偏差：\n$$\n\\varepsilon = \\max_{k \\in \\{0,1,2,3\\}} \\left| \\widehat{M}_k(T) - M_k(T) \\right|\n$$\n为每个测试用例计算此 $\\varepsilon$ 值，并作为最终结果报告。预期结果是机器精度量级的误差。", "answer": "```python\nimport numpy as np\nfrom scipy.special import gamma, gammainc\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the maximum absolute deviation for the Rys quadrature\n    for each test case and prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        # Case 1 (moderate separation)\n        {\n            'alphas': (0.8, 0.5, 0.7, 0.6),\n            'centers': (np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]),\n                        np.array([1.1, 0.0, 0.0]), np.array([1.1, 0.0, 0.0])),\n        },\n        # Case 2 (near-coincident centers)\n        {\n            'alphas': (0.8, 0.5, 0.7, 0.6),\n            'centers': (np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]),\n                        np.array([0.01, 0.0, 0.0]), np.array([0.01, 0.0, 0.0])),\n        },\n        # Case 3 (large separation)\n        {\n            'alphas': (0.8, 0.5, 0.7, 0.6),\n            'centers': (np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]),\n                        np.array([4.0, 0.0, 0.0]), np.array([4.0, 0.0, 0.0])),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        error = compute_quadrature_error(case)\n        results.append(error)\n\n    print(f\"[{','.join([f'{res:.1e}' for res in results])}]\")\n\ndef compute_quadrature_error(case):\n    \"\"\"\n    Performs the full calculation for a single test case.\n    1. Computes the Boys function parameter T.\n    2. Computes the first four moments M_k(T).\n    3. Constructs the 2x2 Jacobi matrix via Stieltjes procedure.\n    4. Computes quadrature nodes and weights via Golub-Welsch.\n    5. Verifies the quadrature by reconstructing moments and calculating error.\n    \"\"\"\n    alpha_a, alpha_b, alpha_c, alpha_d = case['alphas']\n    A, B, C, D = case['centers']\n\n    # Step 1: Compute T\n    p = alpha_a + alpha_b\n    q = alpha_c + alpha_d\n    P = (alpha_a * A + alpha_b * B) / p\n    Q = (alpha_c * C + alpha_d * D) / q\n    rho = (p * q) / (p + q)\n    dist_sq = np.sum((P - Q)**2)\n    T = rho * dist_sq\n\n    # Step 2: Compute moments M_k(T)\n    moments = np.zeros(4)\n    for k in range(4):\n        a = (k + 1.0) / 2.0\n        if T > 1e-12:\n            val = 0.5 * gammainc(a, T) * gamma(a) / (T**a)\n        else: # Handle small T case via Taylor expansion of gammainc\n            # gammainc(a,T) ~= T**a / gamma(a+1)\n            # M_k(T) ~= 0.5 * (T**a / (a*gamma(a))) / T**a = 0.5/a = 1/(k+1)\n            # A more accurate expansion could be used, but for T~0 this is fine.\n            # 1/(k+1) is the exact value for T=0.\n            val = 1.0 / (k + 1.0)\n        moments[k] = val\n    \n    mu0, mu1, mu2, mu3 = moments\n\n    # Step 3: Construct the Jacobi matrix\n    if mu0  1e-14: return 0.0 # Avoid division by zero for very large T\n\n    alpha0 = mu1 / mu0\n    \n    inner_prod_pi1_pi1 = mu2 - 2 * alpha0 * mu1 + alpha0**2 * mu0\n    # A more stable form for beta1 numerator: mu2 - mu1**2 / mu0\n    inner_prod_pi1_pi1_stable = mu2 - mu1**2 / mu0\n    \n    if inner_prod_pi1_pi1_stable  1e-14: return 0.0\n    \n    beta1 = inner_prod_pi1_pi1_stable / mu0\n\n    inner_prod_upi1_pi1 = mu3 - 2 * alpha0 * mu2 + alpha0**2 * mu1\n    alpha1 = inner_prod_upi1_pi1 / inner_prod_pi1_pi1_stable\n    \n    # Step 4: Golub-Welsch: eigenvalues/vectors of Jacobi matrix\n    J = np.array([[alpha0, np.sqrt(beta1)], \n                  [np.sqrt(beta1), alpha1]])\n    \n    nodes, eigenvectors = np.linalg.eigh(J)\n    \n    # Step 5: Compute weights\n    weights = mu0 * eigenvectors[0, :]**2\n    \n    # Step 6: Verify by reconstructing moments\n    reconstructed_moments = np.zeros(4)\n    for k in range(4):\n        reconstructed_moments[k] = np.sum(weights * (nodes**k))\n    \n    # Step 7: Compute maximum absolute error\n    error = np.max(np.abs(reconstructed_moments - moments))\n    \n    return error\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2780078"}]}