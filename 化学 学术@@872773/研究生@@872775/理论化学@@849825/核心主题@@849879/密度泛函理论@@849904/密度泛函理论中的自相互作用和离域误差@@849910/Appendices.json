{"hands_on_practices": [{"introduction": "本练习从一个基础且量化的视角，审视了常见近似密度泛函理论(DFT)泛函的一个关键缺陷。通过比较由总能量差计算的电离势与由最高占据分子轨道(HOMO)能量估算的电离势，你将直接测量其与Janak定理这一精确条件的偏离程度。这个针对简单原子的练习[@problem_id:2804406]揭示了自相互作用误差所带来的实际能量学后果。", "problem": "给你三个原子预先计算好的局域密度近似 (LDA) 数据，包括基态总能量和最高占据科恩-沈轨道能量。请使用第一电离能的定义（即阳离子与中性原子的基态总能量之差）以及科恩-沈解释中最高占据轨道能量的负值，来量化在 LDA 中产生的偏差。所有能量的单位均为哈特里 (hartree)，你的答案也必须以哈特里表示，并四舍五入到六位小数。\n\n使用的基本定义和事实：\n- 在密度泛函理论 (DFT) 中，第一电离能通过总能量的有限差分定义为 $I \\equiv E(N-1) - E(N)$，其中 $E(M)$ 表示 $M$ 个电子的精确基态总能量。\n- 在精确的科恩-沈 (KS) DFT 中，$I = -\\varepsilon_{\\mathrm{HOMO}}$ 成立，其中 $\\varepsilon_{\\mathrm{HOMO}}$ 是最高占据 KS 本征值，但诸如局域密度近似 (LDA) 之类的近似泛函通常不满足此等式。\n\n你的任务：\n- 对于每个原子，计算 $I = E(N-1) - E(N)$。\n- 计算 $-\\varepsilon_{\\mathrm{HOMO}}$。\n- 计算有符号偏差 $\\Delta = I - \\left(-\\varepsilon_{\\mathrm{HOMO}}\\right)$。\n- 对于每个原子，报告三元组 $[I,\\,-\\varepsilon_{\\mathrm{HOMO}},\\,\\Delta]$。\n\n测试组数据（LDA，在相关情况下为自旋非极化；数值为代表性的自洽值）：\n- 氢：$E_{\\mathrm{LDA}}(N=1) = -0.478$, $E_{\\mathrm{LDA}}(N-1=0) = 0.000$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.270$。\n- 氦：$E_{\\mathrm{LDA}}(N=2) = -2.834$, $E_{\\mathrm{LDA}}(N-1=1) = -1.940$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.571$。\n- 氖：$E_{\\mathrm{LDA}}(N=10) = -128.200$, $E_{\\mathrm{LDA}}(N-1=9) = -127.360$, $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.540$。\n\n测试组覆盖范围的基本原理：\n- 氢作为一个边缘情况，其中 $E(N-1)=0$ 且体系只有一个电子，这突显了自相互作用。\n- 氦是一个闭壳层的轻原子，用于探究从单电子到双电子行为的转变。\n- 氖是一个闭壳层的较重原子，用于探究多电子行为和离域化趋势。\n\n要求的最终输出格式：\n- 你的程序应产生单行输出，其中包含一个由三个列表组成的逗号分隔列表，每个列表按氢、氦、氖的顺序对应一个原子，每个内部列表包含三个浮点数 $[I,\\,-\\varepsilon_{\\mathrm{HOMO}},\\,\\Delta]$，所有数值均四舍五入到六位小数。\n- 该行必须严格按以下格式：\n  \"[[a1,a2,a3],[b1,b2,b3],[c1,c2,c3]]\"\n  其中每个 $a_i$, $b_i$, $c_i$ 是一个以哈特里为单位的浮点数，小数点后恰好有六位数字。\n\n你的程序不会接收任何输入；它必须使用上面嵌入的测试组数据，并打印出所需的单行结果。", "solution": "该问题已经过验证并被认为是有效的。它在科学上基于密度泛函理论 (DFT) 的原理，问题提法恰当，所有必要数据均已提供，并且表述客观。我们将着手提供一个解决方案。\n\n核心任务是在局域密度近似 (LDA) 的框架内，量化计算第一电离能 $I$ 的两种方法之间的差异。在精确 DFT 中，第一电离能由两个等价的表达式给出。第一个是 $(N-1)$ 电子体系和 $N$ 电子体系之间的基态总能量差：\n$$I \\equiv E(N-1) - E(N)$$\n这通常被称为 $\\Delta$SCF 方法。第二个来自于 Janak 定理，该定理将总能量对轨道占据数的导数与轨道本征值联系起来。对于最高占据分子轨道 (HOMO)，这导出了精确关系：\n$$I = -\\varepsilon_{\\mathrm{HOMO}}$$\n其中 $\\varepsilon_{\\mathrm{HOMO}}$ 是最高占据科恩-沈轨道的能量。\n\n对于像 LDA 这样的近似交换相关泛函，这一等式不一定成立。LDA 未能满足此条件是一个众所周知的缺陷，源于自相互作用误差和相关的离域化误差。在这种近似势中，一个电子会与自身的电荷密度发生虚假的相互作用，而该电荷密度被人为地分散开来。这种非物理的自排斥作用提高了轨道能量，特别是 $\\varepsilon_{\\mathrm{HOMO}}$，使其负值程度低于应有值。因此，$-\\varepsilon_{\\mathrm{HOMO}}$ 成为电离能的一个很差的近似。\n\n我们将使用这两种定义计算电离能，然后计算每个指定原子的有符号偏差 $\\Delta$。该偏差定义为：\n$$\\Delta = I - (-\\varepsilon_{\\mathrm{HOMO}})$$\n非零的 $\\Delta$ 值量化了 LDA 泛函在这一基本性质上的误差。所有能量单位均为哈特里。\n\n对于氢原子 ($N=1$)：\n提供的数据为 $E_{\\mathrm{LDA}}(N=1) = -0.478$，$E_{\\mathrm{LDA}}(N-1=0) = 0.000$ 以及 $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.270$。\n由总能量差计算出的电离能为：\n$$I_{\\mathrm{H}} = E_{\\mathrm{LDA}}(0) - E_{\\mathrm{LDA}}(1) = 0.000 - (-0.478) = 0.478$$\n由 HOMO 本征值计算出的电离能为：\n$$-\\varepsilon_{\\mathrm{HOMO, H}}^{\\mathrm{LDA}} = -(-0.270) = 0.270$$\n偏差为：\n$$\\Delta_{\\mathrm{H}} = I_{\\mathrm{H}} - (-\\varepsilon_{\\mathrm{HOMO, H}}^{\\mathrm{LDA}}) = 0.478 - 0.270 = 0.208$$\n对于单电子氢原子，这个偏差是自相互作用误差的纯粹体现。\n\n对于氦原子 ($N=2$)：\n提供的数据为 $E_{\\mathrm{LDA}}(N=2) = -2.834$，$E_{\\mathrm{LDA}}(N-1=1) = -1.940$ 以及 $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.571$。\n由总能量差计算出的电离能为：\n$$I_{\\mathrm{He}} = E_{\\mathrm{LDA}}(1) - E_{\\mathrm{LDA}}(2) = -1.940 - (-2.834) = 0.894$$\n由 HOMO 本征值计算出的电离能为：\n$$-\\varepsilon_{\\mathrm{HOMO, He}}^{\\mathrm{LDA}} = -(-0.571) = 0.571$$\n偏差为：\n$$\\Delta_{\\mathrm{He}} = I_{\\mathrm{He}} - (-\\varepsilon_{\\mathrm{HOMO, He}}^{\\mathrm{LDA}}) = 0.894 - 0.571 = 0.323$$\n这个显著的正偏差表明 $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}}$ 的值过高（负得不够）。\n\n对于氖原子 ($N=10$)：\n提供的数据为 $E_{\\mathrm{LDA}}(N=10) = -128.200$，$E_{\\mathrm{LDA}}(N-1=9) = -127.360$ 以及 $\\varepsilon_{\\mathrm{HOMO}}^{\\mathrm{LDA}} = -0.540$。\n由总能量差计算出的电离能为：\n$$I_{\\mathrm{Ne}} = E_{\\mathrm{LDA}}(9) - E_{\\mathrm{LDA}}(10) = -127.360 - (-128.200) = 0.840$$\n由 HOMO 本征值计算出的电离能为：\n$$-\\varepsilon_{\\mathrm{HOMO, Ne}}^{\\mathrm{LDA}} = -(-0.540) = 0.540$$\n偏差为：\n$$\\Delta_{\\mathrm{Ne}} = I_{\\mathrm{Ne}} - (-\\varepsilon_{\\mathrm{HOMO, Ne}}^{\\mathrm{LDA}}) = 0.840 - 0.540 = 0.300$$\n这个误差在多电子体系中持续存在，突显了 LDA 在这方面的系统性失败。在所有情况下，$-\\varepsilon_{\\mathrm{HOMO}}$ 的值都严重低估了由更可靠的总能量差方法预测的电离能。这是局域泛函未能很好地再现 $E(N)$ 曲线凸性的直接后果，局域泛函反而产生了一个近乎线性的依赖关系。正偏差 $\\Delta$ 是常见近似泛函固有的离域化误差的特征。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the deviation between two definitions of the first ionization energy\n    using precomputed Local Density Approximation (LDA) data for H, He, and Ne.\n    \"\"\"\n    \n    # Test suite data (LDA, in hartree): (E_N, E_N_minus_1, epsilon_HOMO)\n    # The data represents ground-state total energies and the highest occupied\n    # Kohn-Sham orbital energy for the neutral atom.\n    test_cases = [\n        # Hydrogen (N=1)\n        (-0.478, 0.000, -0.270),  \n        # Helium (N=2)\n        (-2.834, -1.940, -0.571),  \n        # Neon (N=10)\n        (-128.200, -127.360, -0.540) \n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        E_N, E_N_minus_1, epsilon_HOMO = case\n        \n        # 1. Compute the ionization energy from the total energy difference.\n        # I = E(N-1) - E(N)\n        I_delta_scf = E_N_minus_1 - E_N\n        \n        # 2. Compute the ionization energy from the HOMO eigenvalue.\n        # I = -epsilon_HOMO\n        I_ks_eigenvalue = -epsilon_HOMO\n        \n        # 3. Compute the signed deviation.\n        # Delta = I_delta_scf - I_ks_eigenvalue\n        deviation = I_delta_scf - I_ks_eigenvalue\n        \n        # Store the triplet [I, -epsilon_HOMO, Delta] for the current atom.\n        atom_results = [I_delta_scf, I_ks_eigenvalue, deviation]\n        all_results.append(atom_results)\n\n    # Format the final output according to the specified format:\n    # \"[[a1,a2,a3],[b1,b2,b3],[c1,c2,c3]]\" with values rounded to six decimal places.\n    formatted_results = []\n    for atom_res in all_results:\n        # Format each number in the inner list to have exactly six decimal places.\n        inner_list_str = f\"[{atom_res[0]:.6f},{atom_res[1]:.6f},{atom_res[2]:.6f}]\"\n        formatted_results.append(inner_list_str)\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Print the single required line.\n    print(final_output_string)\n\n# Execute the main function.\nsolve()\n```", "id": "2804406"}, {"introduction": "在诊断了原子中的基本误差之后，本练习将探讨其对化学键解离过程的深远影响。以氢分子离子($\\text{H}_{2}^{+}$)作为一个简洁的单电子测试案例，你将对比其精确的解离行为与一个表现出离域误差的类广义梯度近似(GGA)模型[@problem_id:2804468]。这项分析性练习凸显了近似泛函如何非物理地稳定了分数电荷，这是描述拉伸化学键时的一个典型失效模式。", "problem": "考虑阳离子氢二聚体（化学式为 $\\text{H}_{2}^{+}$）的解离，在核间距非常大的极限下，两个质子定义了两个不重叠的片段，标记为 $\\mathrm{A}$ 和 $\\mathrm{B}$。系统中只有一个电子。使用以下基本依据：\n\n- 在密度泛函理论 (DFT) 的精确 Kohn-Sham 表述中，对于任何单电子密度，Hartree 自相互作用都被交换相关泛函精确抵消。因此，对于单电子系统，总能量是无相互作用动能和外势能之和，且根据 Perdew–Parr–Levy–Balduz (PPLB) 条件，能量作为分数电子数的函数是分段线性的。\n- 在无限分离时，哈密顿量分离为两个孤立的片段，其在位单电子能量为 $\\varepsilon_{\\mathrm{A}}$ 和 $\\varepsilon_{\\mathrm{B}}$。对于氢原子，精确的非相对论性基态能量为 $-0.5$ Hartree。在对称的 $\\text{H}_{2}^{+}$ 情况下，$\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}=-0.5$ Hartree。\n- 在近似的半局域泛函中，例如广义梯度近似 (GGA)，单电子自相互作用的抵消是不完全的。一个用于描述解离时残余离域误差的稳健定性模型是片段占据数上的一个凸二次惩罚项，它反映了 Hartree 能量随电荷呈二次方标度的特性，其形式为 $E_{\\mathrm{res}}(n_{\\mathrm{A}})=\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right)$，其中 $\\alpha0$， $n_{\\mathrm{A}}\\in[0,1]$ 是局域在片段 $\\mathrm{A}$ 上的电子分数，而 $1-n_{\\mathrm{A}}$ 是局域在片段 $\\mathrm{B}$ 上的电子分数。\n\n任务：\n\n- 仅使用上述基本原理，并假设无限分离，因此没有片段间的跃迁或重叠，从第一性原理推导精确的解离极限能量作为占据数 $n_{\\mathrm{A}}$ 的函数，并找出代表对称性破缺的、电子局域化状态的最小化占据数。在完全对称的情况 $\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}$ 下，采用约定，即电子局域化分支对应于 $n_{\\mathrm{A}}=1$。\n- 通过将凸二次残余误差 $E_{\\mathrm{res}}$ 添加到无相互作用的片段能量中，构建一个 GGA 类的近似解离极限能量，并解析地确定在边界约束 $n_{\\mathrm{A}}\\in[0,1]$ 条件下最小化此近似能量的占据数 $n_{\\mathrm{A}}^{\\ast}$。指明最小值点何时严格位于区间内部，何时在边界处达到饱和。\n- 所有能量均以 Hartree 单位表示。不涉及角度。所有最终数值答案必须是实数。将所有打印的浮点数结果四舍五入到小数点后六位。\n\n您的程序必须实现所推导的公式，并对每个测试用例，按以下顺序计算以下四个量：精确的最小能量 $E_{\\mathrm{exact}}^{\\min}$ (Hartree)，对应的精确最小化占据数 $n_{\\mathrm{A,exact}}^{\\ast}$，GGA 类的最小能量 $E_{\\mathrm{GGA}}^{\\min}$ (Hartree)，以及对应的 GGA 类最小化占据数 $n_{\\mathrm{A,GGA}}^{\\ast}$。\n\n使用以下参数三元组 $(\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}},\\alpha)$ 的测试套件，所有能量单位均为 Hartree：\n\n- $( -0.5, -0.5, 0.1 )$\n- $( -0.48, -0.52, 0.1 )$\n- $( -0.3, -0.7, 0.1 )$\n- $( -0.48, -0.52, 0.01 )$\n- $( -0.5, -0.5, 0.001 )$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按上面指定的精确顺序，连接每个测试用例的四个四舍五入后的值，并按所列顺序遍历测试套件。例如，格式必须是 $[E_{\\mathrm{exact}}^{\\min}(\\text{case}\\ \\mathrm{A}),n_{\\mathrm{A,exact}}^{\\ast}(\\text{case}\\ \\mathrm{A}),E_{\\mathrm{GGA}}^{\\min}(\\text{case}\\ \\mathrm{A}),n_{\\mathrm{A,GGA}}^{\\ast}(\\text{case}\\ \\mathrm{A}),\\dots]$，不含额外的空格或文本。", "solution": "我们考虑 $\\text{H}_{2}^{+}$ 的解离极限，即两个无限分离的片段 A 和 B，其在位单电子能量分别为 $\\varepsilon_{\\mathrm{A}}$ 和 $\\varepsilon_{\\mathrm{B}}$。有一个单电子，其在片段 A 上的占据数为 $n_{\\mathrm{A}}$，在片段 B 上的占据数为 $1-n_{\\mathrm{A}}$，其中 $n_{\\mathrm{A}}\\in[0,1]$。\n\n从第一性原理推导精确解离能。对于任何单电子密度，精确的交换相关泛函会抵消 Hartree 自相互作用，且 Perdew–Parr–Levy–Balduz (PPLB) 条件强制总能量相对于每个解耦片段上的电子数呈分段线性关系。在无限分离时，没有耦合项，因此精确能量作为 $n_{\\mathrm{A}}$ 的函数就是片段能量之间的线性插值：\n$$\nE_{\\mathrm{exact}}(n_{\\mathrm{A}})=n_{\\mathrm{A}}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A}}\\right)\\,\\varepsilon_{\\mathrm{B}}.\n$$\n由于 $E_{\\mathrm{exact}}(n_{\\mathrm{A}})$ 关于 $n_{\\mathrm{A}}$ 是线性的，其在闭区间 $[0,1]$ 上的最小值在边界点达到。具体来说，\n$$\nE_{\\mathrm{exact}}^{\\min}=\\min\\left\\{\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}}\\right\\},\\quad\nn_{\\mathrm{A,exact}}^{\\ast}=\\begin{cases}\n1,  \\text{若 }\\varepsilon_{\\mathrm{A}}  \\varepsilon_{\\mathrm{B}},\\\\\n0,  \\text{若 }\\varepsilon_{\\mathrm{B}}  \\varepsilon_{\\mathrm{A}},\\\\\n1,  \\text{若 }\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}\\ \\text{（根据所述选择局域化分支的约定）}。\n\\end{cases}\n$$\n因此，精确解离将整个电子置于能量较低的片段上，在对称情况下，任何 $n_{\\mathrm{A}}\\in[0,1]$ 都是简并的；我们选择 $n_{\\mathrm{A,exact}}^{\\ast}=1$ 来表示片段 A 上的一个电子局域化状态。\n\nGGA 类的近似能量和最小值点。半局域泛函，如广义梯度近似 (GGA)，不能完全抵消单电子自相互作用，从而产生一个残余的、凸性的离域误差，该误差随电荷局域化的增强而增大。在解离极限下，对此残余误差的一个保持对称性的最小模型是片段占据数的二次惩罚项：\n$$\nE_{\\mathrm{res}}(n_{\\mathrm{A}})=\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right),\\quad \\alpha > 0.\n$$\n将其添加到无相互作用的片段能量上，得到 GGA 类的总能量：\n$$\nE_{\\mathrm{GGA}}(n_{\\mathrm{A}})=n_{\\mathrm{A}}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A}}\\right)\\,\\varepsilon_{\\mathrm{B}}+\\alpha\\left(n_{\\mathrm{A}}^{2}+\\left(1-n_{\\mathrm{A}}\\right)^{2}\\right).\n$$\n为了在 $n_{\\mathrm{A}}\\in[0,1]$ 上最小化 $E_{\\mathrm{GGA}}(n_{\\mathrm{A}})$，我们首先通过微分求其无约束驻点：\n$$\n\\frac{dE_{\\mathrm{GGA}}}{dn_{\\mathrm{A}}}=\\varepsilon_{\\mathrm{A}}-\\varepsilon_{\\mathrm{B}}+2\\alpha\\left(2n_{\\mathrm{A}}-1\\right).\n$$\n将导数设为零，得到无约束最小值点：\n$$\nn_{\\mathrm{A}}^{\\mathrm{uncon}}=\\frac{1}{2}+\\frac{\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}}{4\\alpha}.\n$$\n由于二阶导数是正常数，$\\frac{d^{2}E_{\\mathrm{GGA}}}{dn_{\\mathrm{A}}^{2}}=4\\alpha > 0$，该驻点是无约束二次函数的全局最小值点。施加边界约束 $n_{\\mathrm{A}}\\in[0,1]$，便得到有约束的最小值点：\n$$\nn_{\\mathrm{A,GGA}}^{\\ast}=\\min\\left\\{1,\\max\\left\\{0,\\ \\frac{1}{2}+\\frac{\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}}{4\\alpha}\\right\\}\\right\\}.\n$$\n相应的最小 GGA 类能量为：\n$$\nE_{\\mathrm{GGA}}^{\\min}=E_{\\mathrm{GGA}}\\!\\left(n_{\\mathrm{A,GGA}}^{\\ast}\\right)=n_{\\mathrm{A,GGA}}^{\\ast}\\,\\varepsilon_{\\mathrm{A}}+\\left(1-n_{\\mathrm{A,GGA}}^{\\ast}\\right)\\,\\varepsilon_{\\mathrm{B}}+\\alpha\\left(\\left(n_{\\mathrm{A,GGA}}^{\\ast}\\right)^{2}+\\left(1-n_{\\mathrm{A,GGA}}^{\\ast}\\right)^{2}\\right).\n$$\n内部与边界情形。最小值点严格位于内部当且仅当 $0  n_{\\mathrm{A}}^{\\mathrm{uncon}}  1$，即：\n$$\n-2\\alpha  \\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}  2\\alpha.\n$$\n若 $\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}\\leq -2\\alpha$，则 $n_{\\mathrm{A,GGA}}^{\\ast}=0$；若 $\\varepsilon_{\\mathrm{B}}-\\varepsilon_{\\mathrm{A}}\\geq 2\\alpha$，则 $n_{\\mathrm{A,GGA}}^{\\ast}=1$。在对称情况 $\\varepsilon_{\\mathrm{A}}=\\varepsilon_{\\mathrm{B}}$ 下，无约束最小值点为 $n_{\\mathrm{A}}^{\\mathrm{uncon}}=\\frac{1}{2}$，且最小能量因残余惩罚项 $\\alpha/2$ 而高于精确值，因为 $\\alpha(\\left(\\frac{1}{2}\\right)^{2}+\\left(1-\\frac{1}{2}\\right)^{2})=\\alpha/2$。\n\n计算步骤。对于每个参数三元组 $(\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}},\\alpha)$：\n- 如上计算 $E_{\\mathrm{exact}}^{\\min}=\\min\\left\\{\\varepsilon_{\\mathrm{A}},\\varepsilon_{\\mathrm{B}}\\right\\}$ 和 $n_{\\mathrm{A,exact}}^{\\ast}$，根据约定在对称情况下取 $n_{\\mathrm{A,exact}}^{\\ast}=1$。\n- 通过将 $n_{\\mathrm{A}}^{\\mathrm{uncon}}$ 的值限制在 $[0,1]$ 区间内来计算 $n_{\\mathrm{A,GGA}}^{\\ast}$，然后通过计算 $n_{\\mathrm{A,GGA}}^{\\ast}$ 处的 $E_{\\mathrm{GGA}}$ 值得到 $E_{\\mathrm{GGA}}^{\\min}$。\n- 将每个数值输出四舍五入到小数点后六位，并按要求顺序将结果汇总到一个单一的扁平列表中。\n\n应用于测试套件。使用所列参数（单位为 Hartree），我们得到：\n\n- 对于 $( -0.5, -0.5, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.5$, $n_{\\mathrm{A,exact}}^{\\ast}=1$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}$, $E_{\\mathrm{GGA}}^{\\min}=-0.5+0.1\\cdot\\frac{1}{2}=-0.45$。\n- 对于 $( -0.48, -0.52, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.52$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}+\\frac{-0.52-(-0.48)}{4\\cdot 0.1}=0.4$, 而 $E_{\\mathrm{GGA}}^{\\min}=-0.504+0.1\\cdot 0.52=-0.452$。\n- 对于 $( -0.3, -0.7, 0.1 )$: $E_{\\mathrm{exact}}^{\\min}=-0.7$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, 无约束的 $n_{\\mathrm{A}}^{\\mathrm{uncon}}=-0.5$, 所以 $n_{\\mathrm{A,GGA}}^{\\ast}=0$, 而 $E_{\\mathrm{GGA}}^{\\min}=-0.7+0.1=-0.6$。\n- 对于 $( -0.48, -0.52, 0.01 )$: $E_{\\mathrm{exact}}^{\\min}=-0.52$, $n_{\\mathrm{A,exact}}^{\\ast}=0$, 无约束的 $n_{\\mathrm{A}}^{\\mathrm{uncon}}=-0.5$, 所以 $n_{\\mathrm{A,GGA}}^{\\ast}=0$, 而 $E_{\\mathrm{GGA}}^{\\min}=-0.52+0.01=-0.51$。\n- 对于 $( -0.5, -0.5, 0.001 )$: $E_{\\mathrm{exact}}^{\\min}=-0.5$, $n_{\\mathrm{A,exact}}^{\\ast}=1$, $n_{\\mathrm{A,GGA}}^{\\ast}=\\frac{1}{2}$, 而 $E_{\\mathrm{GGA}}^{\\min}=-0.5+0.001\\cdot\\frac{1}{2}=-0.4995$。\n\n程序将重现这些值，精确到小数点后六位，并按要求将它们格式化为单一的扁平列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef clamp(x, lo, hi):\n    return max(lo, min(hi, x))\n\ndef exact_min_energy_and_occupation(eA, eB):\n    # Exact: piecewise linear, minimize at boundaries.\n    if eA  eB:\n        nA = 1.0\n        E = eA\n    elif eB  eA:\n        nA = 0.0\n        E = eB\n    else:\n        # Degenerate symmetric case: choose localized branch on A by convention.\n        nA = 1.0\n        E = eA  # equals eB\n    return E, nA\n\ndef gga_min_energy_and_occupation(eA, eB, alpha):\n    # Unconstrained minimizer for quadratic energy\n    n_uncon = 0.5 + (eB - eA) / (4.0 * alpha)\n    nA = clamp(n_uncon, 0.0, 1.0)\n    # Energy at minimizer\n    E = nA * eA + (1.0 - nA) * eB + alpha * (nA**2 + (1.0 - nA)**2)\n    return E, nA\n\ndef solve():\n    # Define the test cases from the problem statement: (eA, eB, alpha), in Hartree.\n    test_cases = [\n        (-0.5,   -0.5,  0.1),\n        (-0.48,  -0.52, 0.1),\n        (-0.3,   -0.7,  0.1),\n        (-0.48,  -0.52, 0.01),\n        (-0.5,   -0.5,  0.001),\n    ]\n\n    results = []\n    for eA, eB, alpha in test_cases:\n        E_exact, n_exact = exact_min_energy_and_occupation(eA, eB)\n        E_gga, n_gga = gga_min_energy_and_occupation(eA, eB, alpha)\n        # Append rounded values as strings to control formatting and avoid spaces.\n        results.extend([\n            f\"{E_exact:.6f}\",\n            f\"{n_exact:.6f}\",\n            f\"{E_gga:.6f}\",\n            f\"{n_gga:.6f}\",\n        ])\n\n    # Final print statement in the exact required format (single line, no extra spaces).\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2804468"}, {"introduction": "为了获得更深层次的理论理解，本练习将离域误差的概念与Hubbard模型——多体物理学的基石之一——联系起来。通过分析Hubbard二聚体，你将推导出半局域泛函中不完全的自相互作用抵消如何导致一个有效减弱的在位排斥作用$U_{\\mathrm{eff}}$ [@problem_id:2804484]。这一推导为在强电子关联背景下审视DFT误差提供了一个强有力的视角。", "problem": "考虑一个双位点哈伯德二聚体，其位点标记为 $1$ 和 $2$，跃迁振幅为 $t0$，在位相互作用为 $U0$。其哈密顿量为\n$$\n\\hat{H} \\;=\\; -t \\sum_{\\sigma} \\left( \\hat{c}_{1\\sigma}^{\\dagger}\\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger}\\hat{c}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow}.\n$$\n我们在半满填充条件下进行研究，体系中有两个电子处于自旋单态，并假设存在空间对称性，因此密度完全由布居不平衡 $m$ 决定，其定义为 $n_1 = 1 + m$ 和 $n_2 = 1 - m$，其中 $|m|\\le 1$。在 Kohn–Sham 密度泛函理论 (KS-DFT) 框架内，该二聚体的无相互作用动能是 $m$ 的泛函，表达式为\n$$\nT_{\\mathrm{s}}(m) \\;=\\; -2\\,t\\,\\sqrt{1 - m^{2}}.\n$$\n在自旋非极化密度约束下，在位相互作用的平均场哈特里能量为\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{U}{4}\\,\\big(n_1^{2} + n_2^{2}\\big).\n$$\n众所周知，密度泛函理论 (DFT) 中的半局域交换关联泛函会不完全抵消 $E_{\\mathrm{H}}[n]$ 中包含的自相互作用，并表现出离域误差（总能量相对于分数占据数的凸性）。我们通过假设在 $m=0$ 附近展开到 $m$ 的二次项时，半局域交换关联 (XC) 能量抵消了哈特里贡献的一个固定比例 $s \\in [0,1)$ 来对此效应进行建模，\n$$\nE_{\\mathrm{XC}}^{\\mathrm{sl}}[n] \\;\\approx\\; -\\,s\\,E_{\\mathrm{H}}[n] \\;+\\; \\text{terms independent of $m$} \\;+\\; \\mathcal{O}(m^{4}).\n$$\n将有效在位相互作用 $U_{\\mathrm{eff}}$ 定义为近似 DFT 总能量泛函的相互作用部分在 $m=0$ 附近按 $m$ 展开至二次项时 $m^{2}/2$ 的系数，即从下式中确定 $U_{\\mathrm{eff}}$：\n$$\nE_{\\mathrm{int}}^{\\mathrm{sl}}(m) \\;\\equiv\\; \\big(E_{\\mathrm{H}} + E_{\\mathrm{XC}}^{\\mathrm{sl}}\\big)(m) \\;=\\; \\frac{U_{\\mathrm{eff}}}{2}\\,m^{2} \\;+\\; \\text{terms independent of $m$} \\;+\\; \\mathcal{O}(m^{4}).\n$$\n从上述定义出发，只保留到 $m^2$ 阶的项，推导一个用 $U$ 和 $s$ 表示的 $U_{\\mathrm{eff}}$ 的闭式解析表达式。你的最终答案必须是单个符号表达式。无需进行数值取整。", "solution": "我们从半满填充、含有两个自旋单态电子的哈伯德模型出发，用 $n_1 = 1 + m$ 和 $n_2 = 1 - m$ 来参数化位点占据数，其中 $|m|\\le 1$。在对该双位点体系的 Kohn–Sham 密度泛函理论 (KS-DFT) 描述中，无相互作用动能是该二聚体密度差的一个已知泛函，\n$$\nT_{\\mathrm{s}}(m) \\;=\\; -2\\,t\\,\\sqrt{1 - m^{2}}.\n$$\n为了获得有效相互作用强度，我们将关注对总能量的相互作用贡献，在近似 DFT 中，这部分是哈特里能量和交换关联 (XC) 能量之和：\n$$\nE_{\\mathrm{int}}^{\\mathrm{sl}}(m) \\;=\\; E_{\\mathrm{H}}(m) + E_{\\mathrm{XC}}^{\\mathrm{sl}}(m).\n$$\n在自旋非极化约束下，在位相互作用的哈特里能量为\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{U}{4}\\,\\big(n_1^{2} + n_2^{2}\\big).\n$$\n代入 $n_1 = 1 + m$ 和 $n_2 = 1 - m$ 可得\n$$\nn_1^{2} + n_2^{2} \\;=\\; (1 + m)^{2} + (1 - m)^{2} \\;=\\; 2 + 2 m^{2}.\n$$\n因此，\n$$\nE_{\\mathrm{H}}(m) \\;=\\; \\frac{U}{4}\\,\\big(2 + 2 m^{2}\\big) \\;=\\; \\frac{U}{2} \\;+\\; \\frac{U}{2}\\,m^{2}.\n$$\n接下来，我们通过假设在 $m$ 的二次项级别上，半局域交换关联能量抵消了哈特里能量的一部分 $s$ 来对其在 $m=0$ 附近的行为进行建模，\n$$\nE_{\\mathrm{XC}}^{\\mathrm{sl}}(m) \\;\\approx\\; -\\,s\\,E_{\\mathrm{H}}(m) \\;+\\; C \\;+\\; \\mathcal{O}(m^{4}),\n$$\n其中 $C$ 是一个与 $m$ 无关的常数，在确定 $m$ 的二次项系数时可以忽略。因此，\n$$\nE_{\\mathrm{int}}^{\\mathrm{sl}}(m) \\;\\approx\\; E_{\\mathrm{H}}(m) - s\\,E_{\\mathrm{H}}(m) \\;+\\; \\text{const} \\;=\\; (1 - s)\\,E_{\\mathrm{H}}(m) \\;+\\; \\text{const}.\n$$\n使用上面 $E_{\\mathrm{H}}(m)$ 的表达式，\n$$\nE_{\\mathrm{int}}^{\\mathrm{sl}}(m) \\;\\approx\\; (1 - s)\\left(\\frac{U}{2} + \\frac{U}{2}\\,m^{2}\\right) \\;+\\; \\text{const} \\;=\\; \\text{const}' \\;+\\; \\frac{U}{2}\\,(1 - s)\\,m^{2},\n$$\n其中 $\\text{const}'$ 是一个新的与 $m$ 无关的常数，它汇集了所有不依赖于 $m$ 的项。根据定义，我们从相互作用能展开式中 $m^{2}/2$ 前的系数来确定有效在位相互作用 $U_{\\mathrm{eff}}$：\n$$\nE_{\\mathrm{int}}^{\\mathrm{sl}}(m) \\;=\\; \\frac{U_{\\mathrm{eff}}}{2}\\,m^{2} \\;+\\; \\text{const} \\;+\\; \\mathcal{O}(m^{4}).\n$$\n比较 $m^{2}$ 的系数，立即得到\n$$\n\\frac{U_{\\mathrm{eff}}}{2} \\;=\\; \\frac{U}{2}\\,(1 - s)\n\\quad\\Longrightarrow\\quad\nU_{\\mathrm{eff}} \\;=\\; (1 - s)\\,U.\n$$\n这表明，由于半局域泛函中不完全的自相互作用抵消及相关的离域误差，在低能、仅依赖密度的描述中所感受到的相互作用从 $U$ 减小到一个有效值 $U_{\\mathrm{eff}}$。对于任何 $s \\in (0,1)$，该有效值都严格小于 $U$，并且在 $m$ 的这个阶数上与跃迁振幅 $t$ 无关。", "answer": "$$\\boxed{(1 - s)\\,U}$$", "id": "2804484"}]}