{"hands_on_practices": [{"introduction": "Hohenberg-Kohn第一定理指出，基态电子密度$n_0(\\mathbf{r})$可以唯一地确定外部势$v(\\mathbf{r})$。本练习通过逆转通常的求解流程，为这一定理提供了一个直接的动手实践。我们将从一个给定的、物理上合理的基态密度——高斯函数——出发，通过反演定态薛定谔方程来找出产生该密度的唯一势场，从而具体地阐释“v-可表示性”这一概念 ([@problem_id:209541])。", "problem": "根据密度泛函理论的第一Hohenberg-Kohn定理，一个多电子体系的基态电子密度 $n_0(\\mathbf{r})$ 在相差一个加性常数的意义下唯一地确定了外势 $v(\\mathbf{r})$。该原理使得求解“逆”问题成为可能，即寻找能产生已知基态密度的势。\n\n考虑一个简单的一维系统，其中包含一个质量为 $m$ 的粒子在未知的外部势 $v(x)$ 中运动。该粒子是非相对论性的，并且处于其基态。基态波函数 $\\psi_0(x)$ 和能量 $E_0$ 的定态薛定谔方程为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2 \\psi_0(x)}{dx^2} + v(x) \\psi_0(x) = E_0 \\psi_0(x)\n$$\n基态密度由 $n_0(x) = |\\psi_0(x)|^2$ 给出。\n\n假设该系统的基态密度已被确定为归一化的高斯函数：\n$$\nn_0(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2}\n$$\n其中 $\\alpha$ 是一个正实数常数，其量纲为长度的负二次方。\n\n你的任务是找出产生此基态密度的外势 $v(x)$。为确保解的唯一性，势应被定义为其最小值为零。请用 $m$、$\\hbar$、$\\alpha$ 和 $x$ 来表示你的答案。", "solution": "1. 定态薛定谔方程为\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_0(x)}{dx^2}+v(x)\\,\\psi_0(x)=E_0\\,\\psi_0(x)\\,.\n$$\n2. 基态密度为 $n_0(x)=|\\psi_0(x)|^2$，因此我们选择实的正波函数\n$$\n\\psi_0(x)=\\biggl(\\frac{\\alpha}{\\pi}\\biggr)^{1/4}e^{-\\frac{\\alpha x^2}{2}}.\n$$\n3. 计算导数：\n$$\n\\frac{d\\psi_0}{dx}=-\\alpha x\\,\\psi_0,\\qquad\n\\frac{d^2\\psi_0}{dx^2}=(\\alpha^2x^2-\\alpha)\\,\\psi_0,\n$$\n因此\n$$\n\\frac{\\psi_0''(x)}{\\psi_0(x)}=\\alpha^2x^2-\\alpha.\n$$\n4. 代入除以 $\\psi_0$ 后的薛定谔方程：\n$$\n-\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)+v(x)=E_0\n\\;\\Longrightarrow\\;\nv(x)=E_0+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha).\n$$\n5. 强制要求 $\\min_x v(x)=0$。最小值出现在 $x=0$ 处，所以\n$$\n0=v(0)=E_0-\\frac{\\hbar^2\\alpha}{2m}\n\\;\\Longrightarrow\\;\nE_0=\\frac{\\hbar^2\\alpha}{2m}.\n$$\n6. 将 $E_0$ 代回 $v(x)$：\n$$\nv(x)=\\frac{\\hbar^2\\alpha}{2m}+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)\n=\\frac{\\hbar^2\\alpha^2}{2m}\\,x^2.\n$$", "answer": "$$\\boxed{\\frac{\\hbar^2\\alpha^2}{2m}x^2}$$", "id": "209541"}, {"introduction": "尽管从密度到势的映射是唯一的，但Hohenberg-Kohn第一定理包含一个微妙而关键的限定条件。本实践从一个构造性的例子转向一个形式化的证明，旨在探索这种唯一性的精确性质。您将证明，两个仅相差一个常数$C$的外部势$v(\\mathbf{r})$和$v(\\mathbf{r}) + C$，对应着完全相同的基态密度，从而揭示势场仅在相差一个任意加性常数的意义下是唯一的 ([@problem_id:2994356])。", "problem": "在密度泛函理论 (DFT) 框架下，考虑一个包含 $N$ 个相互作用电子的非相对论体系，该体系处于一个外标量势 $v(\\mathbf{r})$ 中。多电子哈密顿算符为\n$$\n\\hat{H}[v] \\equiv \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v(\\hat{\\mathbf{r}}_{i}),\n$$\n其中 $\\hat{T}$ 是总动能算符，$\\hat{W}$ 是电子-电子相互作用算符，$\\hat{\\mathbf{r}}_{i}$ 是第 $i$ 个电子的位置算符。基态能量通过变分法定义为\n$$\nE_{0}[v] \\equiv \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle,\n$$\n其中 $\\mathcal{H}_{N}$ 是 N 电子反对称希尔伯特空间。与一个归一化的 N 电子波函数 $\\Psi$ 相关联的基态密度为\n$$\nn_{\\Psi}(\\mathbf{r}) \\equiv N \\int |\\Psi(\\mathbf{r},\\mathbf{r}_{2},\\dots,\\mathbf{r}_{N})|^{2} \\, d\\mathbf{r}_{2}\\cdots d\\mathbf{r}_{N}.\n$$\n设 $C$ 为一个实常数（具有能量量纲），并定义一个移动后的势 $v'(\\mathbf{r}) \\equiv v(\\mathbf{r}) + C$，其对应的哈密顿算符为 $\\hat{H}[v']$，基态能量为 $E_{0}[v']$。\n\n仅使用上述定义、Rayleigh-Ritz 变分原理和基本的算符性质，回答以下问题：\n\n1) 推导基态能量移动 $E_{0}[v'] - E_{0}[v]$ 的精确表达式，用 $C$ 和 $N$ 表示。假设 $C$ 的单位是 Hartrees，你的最终答案也用 Hartrees 表示。\n\n2) 证明存在一个 $\\hat{H}[v']$ 的基态波函数，其基态密度与 $\\hat{H}[v]$ 的基态密度相同。讨论非简并和简并基态两种情况。\n\n3) 陈述你的结果对于第一 Hohenberg-Kohn 定理（Hohenberg-Kohn 第一定理）的一个精确推论，该定理关系到从基态密度 $n(\\mathbf{r})$ 到外势 $v(\\mathbf{r})$ 映射的唯一性。\n\n只有第 1) 问有数值或闭式解。为便于评分，请提供第 1) 问的单一闭式表达式作为最终答案。不需要四舍五入。", "solution": "### 第 1 部分：基态能量移动的推导\n\n分析始于两个哈密顿算符 $\\hat{H}[v]$ 和 $\\hat{H}[v']$ 的定义，它们分别对应于外势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r})$。这两个势之间的关系为 $v'(\\mathbf{r}) = v(\\mathbf{r}) + C$，其中 $C$ 是一个常数。\n\n对应于移动后势的哈密顿算符 $\\hat{H}[v']$ 可以用原始哈密顿算符 $\\hat{H}[v]$ 来表示。\n$$\n\\hat{H}[v'] = \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v'(\\hat{\\mathbf{r}}_{i})\n$$\n代入 $v'(\\mathbf{r})$ 的表达式：\n$$\n\\hat{H}[v'] = \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} \\left(v(\\hat{\\mathbf{r}}_{i}) + C\\right)\n$$\n利用求和的分配律，我们可以将各项分开：\n$$\n\\hat{H}[v'] = \\left(\\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v(\\hat{\\mathbf{r}}_{i})\\right) + \\sum_{i=1}^{N} C\n$$\n括号中的表达式是原始的哈密顿算符 $\\hat{H}[v]$。第二项是对 $N$ 个电子求和的一个常数。\n$$\n\\sum_{i=1}^{N} C = NC\n$$\n该项是一个标量算符，等价于 $NC\\hat{I}$，其中 $\\hat{I}$ 是单位算符。因此，两个哈密顿算符之间的关系是：\n$$\n\\hat{H}[v'] = \\hat{H}[v] + NC\n$$\n移动后势的基态能量 $E_0[v']$ 由 Rayleigh-Ritz 变分原理定义：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v'] | \\Psi \\rangle\n$$\n代入 $\\hat{H}[v']$ 的表达式：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\left( \\hat{H}[v] + NC \\right) | \\Psi \\rangle\n$$\n利用内积的线性性质，我们可以将期望值分解：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\left( \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle + \\langle \\Psi | NC | \\Psi \\rangle \\right)\n$$\n由于 $NC$ 是一个标量，它可以从内积中提出来：\n$$\n\\langle \\Psi | NC | \\Psi \\rangle = NC \\langle \\Psi | \\Psi \\rangle\n$$\n最小化是针对所有归一化的波函数进行的，对于这些波函数有 $\\langle \\Psi | \\Psi \\rangle = 1$。因此：\n$$\n\\langle \\Psi | NC | \\Psi \\rangle = NC\n$$\n基态能量的表达式变为：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\left( \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle + NC \\right)\n$$\n常数项 $NC$ 不依赖于波函数 $\\Psi$，因此可以移到下确界运算的外面：\n$$\nE_{0}[v'] = \\left( \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle \\right) + NC\n$$\n括号中的项根据定义就是原始系统的基态能量 $E_0[v]$。\n$$\nE_{0}[v'] = E_{0}[v] + NC\n$$\n因此，基态能量的移动为：\n$$\nE_{0}[v'] - E_{0}[v] = NC\n$$\n该表达式按要求用 $C$ 和 $N$ 表示。如果 $C$ 的单位是 Hartrees，那么 $NC$ 的单位也是 Hartrees。\n\n### 第 2 部分：共有基态密度的证明\n\n我们需要证明存在一个 $\\hat{H}[v']$ 的基态波函数，它产生的基态密度与 $\\hat{H}[v]$ 的一个基态波函数所产生的基态密度相同。设 $\\Psi_{0}$ 是 $\\hat{H}[v]$ 的一个基态波函数。根据定义，它是 $\\hat{H}[v]$ 的本征函数，具有最低可能本征值 $E_{0}[v]$：\n$$\n\\hat{H}[v] |\\Psi_{0}\\rangle = E_{0}[v] |\\Psi_{0}\\rangle\n$$\n现在让我们将新的哈密顿算符 $\\hat{H}[v']$ 作用于这同一个波函数 $\\Psi_{0}$：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = (\\hat{H}[v] + NC) |\\Psi_{0}\\rangle\n$$\n利用算符的分配律和 $\\hat{H}[v]$ 的本征值方程：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = \\hat{H}[v]|\\Psi_{0}\\rangle + NC|\\Psi_{0}\\rangle = E_{0}[v]|\\Psi_{0}\\rangle + NC|\\Psi_{0}\\rangle\n$$\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = (E_{0}[v] + NC)|\\Psi_{0}\\rangle\n$$\n根据第 1 部分的结果，我们知道 $E_{0}[v'] = E_{0}[v] + NC$。将此代入上面的方程得到：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = E_{0}[v'] |\\Psi_{0}\\rangle\n$$\n这个结果表明 $\\Psi_{0}$ 是 $\\hat{H}[v']$ 的本征函数，其本征值为 $E_{0}[v']$。由于 $E_{0}[v']$ 是势为 $v'(\\mathbf{r})$ 的系统的基态能量，所以 $\\Psi_{0}$ 是 $\\hat{H}[v']$ 的一个基态波函数。\n\n这与简并性无关：\n- **非简并情况：** 如果 $\\hat{H}[v]$ 的基态是非简并的，其波函数 $\\Psi_{0}$ 是唯一的（最多相差一个相位因子）。我们已经证明，这同一个波函数 $\\Psi_{0}$ 也是 $\\hat{H}[v']$ 的基态波函数。由于基态波函数相同，相应的基态密度 $n_{\\Psi_{0}}(\\mathbf{r})$ 也必然相同。\n- **简并情况：** 如果 $\\hat{H}[v]$ 的基态是简并的，那么基态是希尔伯特空间的一个子空间 $\\mathcal{E}_{0}[v]$。任何波函数 $\\Psi_{0} \\in \\mathcal{E}_{0}[v]$ 都是一个基态波函数。我们的证明表明，任何这样的 $\\Psi_{0}$ 也是 $\\hat{H}[v']$ 的本征函数，其本征值为基态本征值 $E_{0}[v']$。这意味着 $\\hat{H}[v']$ 的基态子空间 $\\mathcal{E}_{0}[v']$ 与 $\\hat{H}[v]$ 的基态子空间 $\\mathcal{E}_{0}[v]$ 是相同的：$\\mathcal{E}_{0}[v'] = \\mathcal{E}_{0}[v]$。因此，对于 $\\hat{H}[v]$ 的任何一个基态波函数，它同时也是 $\\hat{H}[v']$ 的一个基态波函数，所以它们共享同一组可能的基态密度。\n\n在这两种情况下，我们都证明了存在一个（实际上是所有）$\\hat{H}[v']$ 的基态波函数，它与 $\\hat{H}[v]$ 的一个基态波函数相同，因此产生相同的基态密度。\n\n### 第 3 部分：对第一 Hohenberg-Kohn 定理的推论\n\n第一 Hohenberg-Kohn (HK) 定理在 DFT 中建立了一个基本映射。该定理指出，一个相互作用电子系统的基态电子密度 $n(\\mathbf{r})$ 唯一地决定了外势 $v(\\mathbf{r})$。\n\n第 1 和第 2 部分的结果揭示了该定理中的一个关键的微妙之处。我们已经证明，两个不同的外势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r}) = v(\\mathbf{r}) + C$（对于任何 $C \\ne 0$）可以产生完全相同的基态波函数集合。其直接后果是，它们共享相同的基态密度或基态密度集合。\n\n这对于“从密度 $n(\\mathbf{r})$ 到势 $v(\\mathbf{r})$ 的映射是严格一对一的”这一过于简化的解释，构成了一个直接的反例。我们有两个不同的势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r})$，它们映射到同一个基态密度 $n(\\mathbf{r})$。\n\n因此，该结果的精确推论是，第一 Hohenberg-Kohn 定理必须加以限定：**基态密度 $n(\\mathbf{r})$ 唯一地决定外势 $v(\\mathbf{r})$，但这唯一性只到相差一个任意的加性常数。** 第一 HK 定理的标准归谬法证明，暗中依赖于一个假设，即所比较的两个势不相差一个常数，因为这正是该证明的核心矛盾无法成立的确切情况。该映射是在一个基态密度和一个势的等价类 $\\{v(\\mathbf{r}) + C | C \\in \\mathbb{R}\\}$ 之间的一对一映射。", "answer": "$$\n\\boxed{NC}\n$$", "id": "2994356"}, {"introduction": "Hohenberg-Kohn第二定理提供了变分原理，这是所有密度泛函理论实际计算的基石。该原理指出，使用任何试探密度计算出的能量都将大于或等于真实的基态能量。本练习通过一个思想实验来探讨该原理的一个关键前提：如果某次计算得出的能量*低于*真实的基态能量，这意味着什么？通过分析这个悖论，您将揭示“N-可表示性”的根本重要性——即试探密度必须能够从一个合法的N电子波函数中导出，变分原理才得以成立 ([@problem_id:1407256])。", "problem": "一位本科生正在探索密度泛函理论（DFT）的基础。他们决定在最简单的系统上——单个非相对论性的氢原子——检验Hohenberg-Kohn（HK）变分原理。\n\n在原子单位制下，氢原子的外势由 $v_{ext}(\\vec{r}) = -1/r$ 给出。已知其精确的基态能量为 $E_0 = -0.5$ Hartrees。对于单电子体系，总能量可以表示为电子密度 $n(\\vec{r})$ 的一个精确泛函：\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\n其中 $T_s[n]$ 是密度为 $n(\\vec{r})$ 的单个无相互作用电子的动能泛函。\n\n该学生使用两种不同的试探电子密度 $n_A(\\vec{r})$ 和 $n_B(\\vec{r})$ 进行了两次计算。\n1.  使用试探密度 $n_A(\\vec{r})$，计算出的能量为 $E[n_A] = -0.46$ Hartrees。\n2.  使用试探密度 $n_B(\\vec{r})$，计算出的能量为 $E[n_B] = -0.53$ Hartrees。\n\n第二个结果 $E[n_B]  E_0$ 似乎直接违反了第二Hohenberg-Kohn定理（变分原理），该原理指出，任何有效的试探密度所产生的能量必须大于或等于真实的基态能量。假设动能泛函 $T_s[n]$ 被精确求值，并且所有数值积分都没有误差，那么这个矛盾结果最根本的理论原因是什么？\n\nA. Hohenberg-Kohn定理是为多电子体系推导的，并且已知对于像氢这样的单电子体系特例会失效。\n\nB. DFT中的变分原理本身只是一个近似，并不能保证能量的下界。\n\nC. 这个结果必定是由于使用了近似的动能泛函 $T_s[n]$，因为即使对于单个电子，该泛函的精确形式也是未知的。\n\nD. 试探密度 $n_B(\\vec{r})$ 对于单电子体系而言不是一个物理上有效的密度（即，它不是“N可表示的”），因此违反了变分原理应用的一个关键前提条件。\n\nE. 计算B揭示了氢原子一个比以前已知的更稳定的电子态，表明 $E_0 = -0.5$ Hartrees 不是真正的基态。", "solution": "我们从Levy-Lieb约束搜索形式的精确Hohenberg-Kohn变分表述开始。对于给定的外势 $v(\\vec r)$ 和粒子数 $N$，定义普适泛函\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\n其中最小化是针对所有能产生密度 $n(\\vec r)$ 的反对称 $N$ 电子波函数 $\\Psi$ 进行的。对于任何 $N$ 可表示的密度 $n$（即，至少来自一个这样的 $\\Psi$），DFT能量泛函为\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\n令 $\\Psi_{n}$ 是一个在 $F[n]$ 的定义中达到（或任意接近）最小值的波函数。那么\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\n其中 $E_{0}$ 是精确的基态能量，不等式遵循Rayleigh-Ritz原理。因此，对于每一个 $N$ 可表示的密度 $n$，我们有\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\n对于单电子体系，$\\hat V_{ee} = 0$ 且\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\n其中 $T_{W}[n]$ 为精确的Weizsäcker泛函\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\n前提是 $n$ 是 $N$ 可表示的并且足够正则，使得 $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$（以确保动能有限）。因此，对于任何物理上有效的单电子密度 $n$，\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\n在问题中，我们得到了 $E[n_{B}]  E_{0}$ 的结果，同时假设 $T_{s}[n]$ 是精确求值的，并且积分是精确的。上述不等式表明，对于任何 $N$ 可表示的单电子密度，这样的结果是不可能发生的。因此，唯一剩下的逻辑可能性是 $n_{B}$ 不是一个物理上可接受的单电子密度（不满足 $N$ 可表示性，或者等价地，对于通过约束搜索得到的HK变分界限而言，它位于 $F[n]$ 的定义域之外）。典型的违规情况包括非负性缺失、未正确归一化到 $N=1$，或正则性不足，以至于不存在动能有限且满足 $|\\psi|^{2} = n_{B}$ 的波函数 $\\psi$。\n\n评估选项：\n- A是错误的：HK定理适用于任何 $N$，并且对于 $N=1$，泛函是精确已知的。\n- B是错误的：对于约束搜索泛函在其定义域上，DFT变分原理是严格成立的。\n- C是错误的：对于 $N=1$，$T_{s}[n]$ 精确等于 $T_{W}[n]$。\n- D是正确的：这个悖论的产生是因为 $n_{B}$ 不是 $N$ 可表示的，从而使得变分界限无效。\n- E是错误的：氢的 $E_{0}$ 是精确已知的，不可能被一个物理上有效的密度所突破。\n\n因此，最根本的理论原因是试探密度 $n_{B}$ 不是 $N$ 可表示的。", "answer": "$$\\boxed{D}$$", "id": "1407256"}]}