## 引言
[组态相互作用](@entry_id:195713)（Configuration Interaction, CI）是[量子化学](@entry_id:140193)中一种基础且功能强大的方法，旨在通过系统地改进哈特里-福克（Hartree-Fock）近似，以获得多电子体系薛定谔方程的精确解。然而，电子之间复杂的相互作用，即电子相关效应，构成了该领域的核心挑战。本文旨在系统性地剖析[CI方法](@entry_id:186312)族，解决如何有效且准确地处理电子相关这一根本问题。读者将通过本文学习到[CI方法](@entry_id:186312)的完整图景：第一章“原理与机制”将深入其变分理论根基，阐明CI矩阵的构建、对称性的利用以及截断近似带来的关键后果，如尺寸[延展性](@entry_id:160108)问题。第二章“应用与跨学科连接”将理论付诸实践，展示[CI方法](@entry_id:186312)在模拟[电子光谱](@entry_id:154403)、[化学键断裂](@entry_id:276545)和[分子间相互作用](@entry_id:263767)等真[实化](@entry_id:266794)学问题中的应用、挑战以及与[耦合簇](@entry_id:190682)等更高级理论的关联。最后，第三章“动手实践”提供了一系列精心设计的问题，旨在巩固理论知识并加深对核心概念的理解。本文将引导读者从基本原理出发，逐步掌握[CI方法](@entry_id:186312)的理论精髓与实践要领。

## 原理与机制

在上一章引言的基础上，本章将深入探讨[组态相互作用](@entry_id:195713)（Configuration Interaction, CI）方法背后的核心原理与关键机制。我们将从其坚实的变分理论基础出发，逐步解析其数学构造、截断近似的后果，以及为克服其内在局限性而发展出的更高级方法。本章旨在为读者构建一个系统、严谨且深入的CI理论框架。

### [组态相互作用](@entry_id:195713)的[变分原理](@entry_id:198028)

所有[CI方法](@entry_id:186312)都根植于量子力学中最基本也最强大的原理之一——**[瑞利-里兹变分原理](@entry_id:185834)**（Rayleigh-Ritz variational principle）。该原理指出，对于任意一个归一化的试验[波函数](@entry_id:147440) $|\Psi\rangle$，其[哈密顿量](@entry_id:172864) $\hat{H}$ 的[期望值](@entry_id:153208)将是体系真实[基态能量](@entry_id:263704) $E_0$ 的一个[上界](@entry_id:274738)，即 $\langle\Psi|\hat{H}|\Psi\rangle \ge E_0$。通过系统地优化试验[波函数](@entry_id:147440)以最小化该[能量期望值](@entry_id:174035)，我们可以获得对[基态](@entry_id:150928)[波函数](@entry_id:147440)和能量的近似。

在[CI方法](@entry_id:186312)中，我们构造的试验[波函数](@entry_id:147440) $|\Psi\rangle$ 是一个由一系列预先定义的、$N$ 电子的反对称[基函数](@entry_id:170178)（通常是斯莱特行列式）$|D_I\rangle$ 构成的线性组合：
$$
|\Psi\rangle = \sum_I c_I |D_I\rangle
$$
这里，$c_I$ 是待定的变分系数。为了简化推导，我们选择一组**正交归一的[行列式](@entry_id:142978)基**，即 $\langle D_I | D_J \rangle = \delta_{IJ}$。

根据变分原理，我们的任务是寻找一组系数 $\{c_I\}$，使得能量泛函 $\mathcal{E}[\mathbf{c}] = \frac{\langle\Psi|\hat{H}|\Psi\rangle}{\langle\Psi|\Psi\rangle}$ 达到最小值。在正交归一基的条件下，分母 $\langle\Psi|\Psi\rangle = \sum_{I,J} c_I^* c_J \langle D_I | D_J \rangle = \sum_I |c_I|^2$。因此，我们需要在归一化约束 $\sum_I |c_I|^2 = 1$ 下，最小化[能量期望值](@entry_id:174035) $\langle\Psi|\hat{H}|\Psi\rangle = \sum_{I,J} c_I^* c_J \langle D_I | \hat{H} | D_J \rangle$。

引入[拉格朗日乘子](@entry_id:142696) $E$ 来处理此约束优化问题，我们构建拉格朗日函数 $\mathcal{L}$：
$$
\mathcal{L} = \sum_{I,J} c_I^* H_{IJ} c_J - E \left( \sum_I |c_I|^2 - 1 \right)
$$
其中，$H_{IJ} = \langle D_I | \hat{H} | D_J \rangle$ 是[哈密顿量](@entry_id:172864)在[行列式](@entry_id:142978)基下的[矩阵元](@entry_id:186505)。通过对 $\mathcal{L}$ 关于任意一个系数的共轭 $c_K^*$ 求偏导并令其为零（$\frac{\partial \mathcal{L}}{\partial c_K^*} = 0$），我们便可得到一组[稳态](@entry_id:182458)方程。经过推导，该[方程组](@entry_id:193238)为：
$$
\sum_J H_{IJ} c_J = E c_I \quad (\text{for all } I)
$$
这组方程可以被优雅地写作一个矩阵[本征值方程](@entry_id:192306) [@problem_id:2765724]：
$$
\mathbf{H}\mathbf{c} = E\mathbf{c}
$$
这里，$\mathbf{H}$ 是一个以 $H_{IJ}$ 为元素的矩阵，称为 **CI矩阵** 或 **[哈密顿矩阵](@entry_id:136233)**；$\mathbf{c}$ 是由系数 $c_I$ 构成的列向量；$E$ 则是[本征值](@entry_id:154894)，即体系的能量。

此结果揭示了[CI方法](@entry_id:186312)的核心机制：它将求解复杂的微分形式的薛定谔方程问题，转化为一个代数形式的矩阵[本征值问题](@entry_id:142153)。通过对CI矩阵 $\mathbf{H}$ 进行对角化，我们可以得到一系列[本征值](@entry_id:154894) $E_k$ 和对应的[本征向量](@entry_id:151813) $\mathbf{c}_k$。根据[变分原理](@entry_id:198028)，这些[本征值](@entry_id:154894)是体系各个电子态能量的近似，其中最低的[本征值](@entry_id:154894) $E_0$ 是[基态能量](@entry_id:263704)的一个上界。对应的[本征向量](@entry_id:151813) $\mathbf{c}_0$ 则给出了近似的[基态](@entry_id:150928)CI[波函数](@entry_id:147440)。

### 构建基元：[基函数](@entry_id:170178)与[哈密顿量](@entry_id:172864)

CI矩阵 $\mathbf{H}$ 的构建是CI计算的起点，这需要我们明确其构成元素：[基函数](@entry_id:170178) $|D_I\rangle$ 和[哈密顿量](@entry_id:172864) $\hat{H}$。

如前所述，[基函数](@entry_id:170178)通常是**[斯莱特行列式](@entry_id:139034)**（Slater determinants）。一个由 $N$ 个正交归一的单电子**[自旋轨道](@entry_id:274032)**（spin-orbitals）$\{\chi_p(\mathbf{x})\}$ 构成的[斯莱特行列式](@entry_id:139034)，其形式为：
$$
|D\rangle = \frac{1}{\sqrt{N!}}
\begin{vmatrix}
\chi_{i_1}(\mathbf{x}_1)  \chi_{i_2}(\mathbf{x}_1)  \cdots  \chi_{i_N}(\mathbf{x}_1) \\
\chi_{i_1}(\mathbf{x}_2)  \chi_{i_2}(\mathbf{x}_2)  \cdots  \chi_{i_N}(\mathbf{x}_2) \\
\vdots  \vdots  \ddots  \vdots \\
\chi_{i_1}(\mathbf{x}_N)  \chi_{i_2}(\mathbf{x}_N)  \cdots  \chi_{i_N}(\mathbf{x}_N)
\end{vmatrix}
$$
[行列式](@entry_id:142978)的性质天然保证了[波函数](@entry_id:147440)在交换任意两个电子坐标（$\mathbf{x}_j \leftrightarrow \mathbf{x}_k$）时变号，从而满足了[费米子](@entry_id:146235)的**[反对称性](@entry_id:261893)原理**。

为了高效地计算[哈密顿矩阵元](@entry_id:201928) $H_{IJ}$，现代[量子化学](@entry_id:140193)程序广泛采用**[二次量子化](@entry_id:137766)**（second quantization）形式的[电子哈密顿量](@entry_id:177588)。在正交归一的自旋轨道基上，非相对论性的[电子哈密顿量](@entry_id:177588)（忽略常数的核-核排斥项）可以写作 [@problem_id:2765692]：
$$
\hat{H} = \sum_{pq} h_{pq} a_p^\dagger a_q + \frac{1}{2}\sum_{pqrs} (pq|rs) a_p^\dagger a_q^\dagger a_s a_r
$$
在此表达式中：
- $a_p^\dagger$ 和 $a_p$ 分别是在自旋轨道 $\chi_p$ 上产生和湮灭一个电子的**产生和湮灭算符**。它们满足[费米子](@entry_id:146235)的[反对易关系](@entry_id:153815)，如 $\{a_p, a_q^\dagger\} = \delta_{pq}$。
- $h_{pq}$ 是**[单电子积分](@entry_id:202621)**，包含了电子的动能和与所有[原子核](@entry_id:167902)的吸引[势能](@entry_id:748988)：
  $$
  h_{pq}=\int \chi_p^*(\mathbf{x})\left(-\frac{1}{2}\nabla^2 - \sum_A \frac{Z_A}{|\mathbf{r}-\mathbf{R}_A|}\right)\chi_q(\mathbf{x})\, d\mathbf{x}
  $$
- $(pq|rs)$ 是**[双电子积分](@entry_id:261879)**，描述了电子间的[库仑排斥](@entry_id:181876)作用，采用化学家常用记法时，其定义为：
  $$
  (pq|rs)=\iint \chi_p^*(\mathbf{x}_1)\chi_r(\mathbf{x}_1)\,\frac{1}{r_{12}}\,\chi_q^*(\mathbf{x}_2)\chi_s(\mathbf{x}_2)\, d\mathbf{x}_1\,d\mathbf{x}_2
  $$
  (注意：在物理学家的记法中，定义略有不同，但算符顺序会相应调整以保证最终结果一致)。

使用[二次量子化](@entry_id:137766)[哈密顿量](@entry_id:172864)和满足[反对易关系](@entry_id:153815)的算符，计算任意两个[斯莱特行列式](@entry_id:139034)之间的矩阵元 $H_{IJ}$ 的过程被系统化为一套代数规则，即**[斯莱特-康登规则](@entry_id:269341)**（Slater-Condon rules）。这些规则表明，只有当两个[行列式](@entry_id:142978)至多相差两个[自旋轨道](@entry_id:274032)时，它们之间的矩阵元才可能非零。

### 对称性的利用：自旋与空间匹配

理论上，CI矩阵的维度可能大到天文数字，使得直接[对角化](@entry_id:147016)变得不切实际。幸运的是，我们可以利用体系的对称性将巨大的CI矩阵分解为一系列互不耦合的小矩阵块，从而极大降低计算成本。

首先是**[自旋对称性](@entry_id:197993)**。对于一个不含自旋相关项的[哈密顿量](@entry_id:172864)，它与总自旋平方算符 $\hat{S}^2$ 和总自旋z分量算符 $\hat{S}_z$ 均对易，即 $[\hat{H}, \hat{S}^2]=0$ 和 $[\hat{H}, \hat{S}_z]=0$。这意味着，不同[自旋量子数](@entry_id:142550)（$S$ 和 $M_S$）的态之间没有相互作用。

单个[斯莱特行列式](@entry_id:139034)通常是 $\hat{S}_z$ 的本征函数，其[本征值](@entry_id:154894) $M_S$ 由自旋向上和自旋向下电子数之差决定。因此，在斯莱特行列式基下，CI矩阵天然地按照 $M_S$ 值分块。然而，一个斯莱特行列式（除了少数特例，如闭壳层或最[高自旋态](@entry_id:750320)）通常不是 $\hat{S}^2$ 的本征函数，即它不具备确定的[总自旋](@entry_id:153335) $S$ [@problem_id:2765710]。例如，对于一个具有两个自旋相反的不配对电子的体系，存在两个 $M_S=0$ 的[行列式](@entry_id:142978)，它们都不是纯粹的单重态或三重态，而是两者的混合。

为了利用 $\hat{S}^2$ 对称性，我们需要构建**[组态态函数](@entry_id:164365)**（Configuration State Functions, CSFs）。一个CSF被定义为一个经过**自旋匹配**（spin adaptation）的、由若干个斯莱特行列式构成的线性组合，它同时是 $\hat{S}^2$ 和 $\hat{S}_z$ 的[本征函数](@entry_id:154705)。例如，对于上述两个 $M_S=0$ 的[行列式](@entry_id:142978) $|D_1\rangle$ 和 $|D_2\rangle$，我们可以构造一个[单重态](@entry_id:154728)CSF（$S=0$）和一个[三重态](@entry_id:156705)CSF（$S=1$）：
$$
|\Psi_{\text{singlet}}\rangle = \frac{1}{\sqrt{2}}(|D_1\rangle - |D_2\rangle) \quad , \quad |\Psi_{\text{triplet}}\rangle = \frac{1}{\sqrt{2}}(|D_1\rangle + |D_2\rangle)
$$
当使用CSF作为CI展开的基时，由于 $[\hat{H}, \hat{S}^2]=0$，不同总自旋 $S$ 值的CSF之间的[哈密顿矩阵元](@entry_id:201928)为零。这使得CI矩阵能够按照[总自旋](@entry_id:153335) $S$ 值进一步分块，使我们能够独立地求解特定[自旋态](@entry_id:149436)（如[基态](@entry_id:150928)通常是[单重态](@entry_id:154728)）的能量和[波函数](@entry_id:147440)，从而极大地减小了待求解[本征问题](@entry_id:748835)的维度 [@problem_id:2765710]。

其次是**空间对称性**。如果分子具有空间[点群对称性](@entry_id:141230) $G$，那么[电子哈密顿量](@entry_id:177588)将与该群的所有[对称操作](@entry_id:143398)算符 $\hat{R}(g)$ 对易，即 $[\hat{H}, \hat{R}(g)]=0$。根据群论，这意味着[哈密顿量](@entry_id:172864)在属于不同[不可约表示](@entry_id:263310)（irreducible representation, irrep）的[基函数](@entry_id:170178)之间的矩阵元为零。一个[行列式](@entry_id:142978)（或CSF）的空间对称性由其占据的分子[轨道](@entry_id:137151)的空间对称性决定：其所属的不可约表示是所有占据的空间[轨道](@entry_id:137151)所属[不可约表示](@entry_id:263310)的直积。特别地，任何被双占据的[轨道](@entry_id:137151)对总对称性的贡献都是全对称表示（如 $A_1$），因此[行列式](@entry_id:142978)的整体对称性仅由单占据[轨道](@entry_id:137151)决定 [@problem_id:2765736]。

通过将[行列式](@entry_id:142978)（或CSF）按照其所属的不可约表示进行分组，CI矩阵可以进一步按照空间对称性分块。例如，在一个具有 $C_{2v}$ 对称性的分子中，一个从 $B_2$ 对称性[轨道](@entry_id:137151)激发到 $B_1$ 对称性[轨道](@entry_id:137151)的单[激发态](@entry_id:261453)，其整体对称性为 $B_2 \otimes B_1 = A_2$，因此它只会与同样属于 $A_2$ 表示的其他[组态态函数](@entry_id:164365)相互作用 [@problem_id:2765736]。

综上所述，通过同时利用粒子数守恒、[自旋角动量](@entry_id:149719)守恒（$M_S$ 和 $S$）以及空间[点群对称性](@entry_id:141230)（$\Gamma$），庞大的CI矩阵被分解为一系列规模小得多的、互不耦合的矩阵块。这不仅是可行的计算策略，也是保证计算结果具有正确量子数的物理要求。

### [CI方法](@entry_id:186312)族：截断及其后果

在一个给定的单电子基组下，如果我们将在CI展开中包含所有可能的斯莱特行列式，我们就得到了**[完全组态相互作用](@entry_id:172539)**（Full Configuration Interaction, FCI）。FCI在该[基组](@entry_id:160309)内给出了[电子薛定谔方程](@entry_id:177999)的精确解。然而，[行列式](@entry_id:142978)的数量随着电子数和[轨道](@entry_id:137151)数的增加呈组合爆炸式增长，使得FCI除了对于极小的体系外都无法实现。

因此，实际应用中的[CI方法](@entry_id:186312)几乎都是**截断CI**（truncated CI）方法。这些方法通过限制相对于某个参考[行列式](@entry_id:142978)（通常是Hartree-Fock[行列式](@entry_id:142978) $|\Phi_0\rangle$）的电子激发阶数来构建一个较小的CI空间。标准的截断[CI方法](@entry_id:186312)构成了一个层次结构 [@problem_id:2881691]：
- **CIS** (CI with Singles)：包含参考[行列式](@entry_id:142978) $|\Phi_0\rangle$ 和所有单[激发态](@entry_id:261453)。
- **CISD** (CI with Singles and Doubles)：包含 $|\Phi_0\rangle$、所有单[激发态](@entry_id:261453)和所有[双激发态](@entry_id:187815)。
- **CISDT** (CI with Singles, Doubles, and Triples)：在CISD基础上增加所有三[激发态](@entry_id:261453)。
- **CISDTQ** 等等，依次类推。

这种截断策略虽然使得计算变得可行，但也引入了一个严重的理论缺陷：**缺乏尺寸延展性**（size-extensivity）。一个尺寸延展的方法，其计算能量应正比于体系中电子的数量。一个密切相关的性质是**尺寸一致性**（size-consistency），即当一个体系分解为两个无相互作用的子体系A和B时，其总能量应等于两个子体系能量之和：$E(A \cdots B) = E(A) + E(B)$。

任何固定阶数截断的[CI方法](@entry_id:186312)（FCI除外）都不是尺寸延展和尺寸一致的。我们可以通过一个思想实验来理解这一点 [@problem_id:1394939]。考虑两个相距很远、无相互作用的氦原子。对单个氦原子进行CISD计算，会包含相对于其HF[基态](@entry_id:150928)的[双激发态](@entry_id:187815)，以描述其电子相关。现在，将两个[氦原子](@entry_id:150244)视为一个超分子进行CISD计算。正确的[波函数](@entry_id:147440)应该是两个独立[氦原子](@entry_id:150244)CISD[波函数](@entry_id:147440)的乘积。然而，这个乘积展开后，会包含一个“双激发在A上，同时双激发在B上”的项，这对应于超分子的一个四重激发。由于CISD方法将CI空间截断在双激发，它无法描述这种必要的四重激发项。因此，超分子的CISD能量会高于两个独立[氦原子](@entry_id:150244)CISD能量之和，即 $E_{\text{CISD}}(\text{He}_2) > 2 \times E_{\text{CISD}}(\text{He})$。

这种尺寸一致性的缺乏对化学过程的描述，尤其是键的断裂，会产生灾难性的后果。当一个分子（如H$_2$）解离时，CISD计算得到的[势能曲线](@entry_id:178979)在解离极限处的能量会显著高于两个独立原子能量之和，导致[解离能](@entry_id:272940)被严重低估，整个[势能面](@entry_id:147441)的形状也是错误的 [@problem_id:2765753]。

### [静态相关](@entry_id:195411)、[动态相关](@entry_id:171647)与[多参考方法](@entry_id:170058)的需求

为了理解截断[CI方法](@entry_id:186312)的[适用范围](@entry_id:636189)和局限性，我们需要区分两种类型的电子相关：

- **[动态相关](@entry_id:171647)**（Dynamic Correlation）：这指的是电子为避免在短距离内相遇而产生的瞬时运动相关。它通常表现为在主导的HF参考[行列式](@entry_id:142978)之上，有大量[激发态](@entry_id:261453)以很小的系数（$|c_I| \ll 1$）贡献给总[波函数](@entry_id:147440)。对于那些可以被单个[斯莱特行列式](@entry_id:139034)很好地描述的体系（如平衡构型下的闭壳层分子），CISD这类方法的主要作用就是描述[动态相关](@entry_id:171647) [@problem_id:2881696]。

- **[静态相关](@entry_id:195411)**（Static Correlation），或称**非[动态相关](@entry_id:171647)**（Nondynamic Correlation）：这发生在当几个[斯莱特行列式](@entry_id:139034)[近简并](@entry_id:172107)，以至于无法用单个[行列式](@entry_id:142978)作为合理的零级近似时。此时，真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)必须是这几个[行列式](@entry_id:142978)的显著混合，即多个系数 $|c_I|$ 的量级都很大。这种情况典型地出现在键的拉伸与断裂、过渡态、以及某些[激发态](@entry_id:261453)中。

单参考截断[CI方法](@entry_id:186312)，如CISD，其构建基础是假设[Hartree-Fock](@entry_id:142303)[行列式](@entry_id:142978) $|\Phi_0\rangle$ 占据绝对主导地位。因此，它们可以较好地处理动态相关，但对于存在显著静态相关的体系则会彻底失败 [@problem_id:2881696]。

一个实用的诊断工具是监测CI展开中参考[行列式](@entry_id:142978)的权重平方 $c_0^2$。对于一个行为良好的单参考体系，$c_0^2$ 的值应该接近于1。当分子键被拉伸时，[静态相关](@entry_id:195411)的重要性急剧增加，导致其他[行列式](@entry_id:142978)的权重上升，而 $c_0^2$ 会显著下降。例如，在H$_2$解离的[最小基组](@entry_id:167849)描述中，$c_0^2$ 会从平衡构型时的约1下降到解离极限时的0.5。因此，当 $c_0^2$ 的值显著偏离1时（例如，经验上认为低于0.9或0.85），就标志着单参考近似的失效，必须采用更高级的方法 [@problem_id:2765753]。

解决[静态相关](@entry_id:195411)问题的正确途径是采用**多参考**（Multi-Reference, MR）方法，如**[多参考组态相互作用](@entry_id:199629)**（MRCI）。MRCI的核心思想是，首先定义一个包含所有重要的、[近简并](@entry_id:172107)的[行列式](@entry_id:142978)（或CSF）的“[模型空间](@entry_id:635763)”或“参考空间”。这个参考空间通常通过**[完全活性空间自洽场](@entry_id:270551)**（CASSCF）方法来构建，它在选定的“[活性空间](@entry_id:263213)”（包含几个关键电子和[轨道](@entry_id:137151)）内进行FCI计算。这个多组态的参考[波函数](@entry_id:147440)能够正确地描述[静态相关](@entry_id:195411)。然后，MR[CI方法](@entry_id:186312)再从这个多组态参考空间出发，构建单、双（甚至更高阶）激发，以描述剩余的[动态相关](@entry_id:171647) [@problem_id:2881673], [@problem_id:2881696]。

从更形式化的角度看，使用投影算符可以将整个[希尔伯特空间](@entry_id:261193)分为模型空间P和其正交补空间Q。单参考方法将[近简并](@entry_id:172107)的组态放在了Q空间，当它们与P空间中的[参考态](@entry_id:151465)能量差很小时，会导致[微扰理论](@entry_id:138766)中的“[小分母问题](@entry_id:271168)”，使得计算不稳定或不收敛。而MRCI通过将所有[近简并](@entry_id:172107)的组态都包含在P空间中，通过对P空间内的哈密顿矩阵进行对角化来处理它们之间的强相互作用，从而从根本上解决了[小分母问题](@entry_id:271168)，为可靠地处理[动态相关](@entry_id:171647)铺平了道路 [@problem_id:2881673]。

### 数值实现：求解CI[本征值问题](@entry_id:142153)

最后，我们简要讨论如何从实践上求解巨大的CI[本征值方程](@entry_id:192306) $\mathbf{H}\mathbf{c} = E\mathbf{c}$。由于CI矩阵 $\mathbf{H}$ 的维度通常是百万级甚至更高，直接构建并[对角化](@entry_id:147016)整个矩阵是不可行的。幸运的是，$\mathbf{H}$ 是一个非常稀疏的矩阵，并且我们通常只关心少数几个最低的[本征值](@entry_id:154894)（如[基态](@entry_id:150928)和几个低[激发态](@entry_id:261453)）。

这类问题的标准求解算法是迭代方法，其中最著名的是**戴维森算法**（Davidson algorithm）。戴维森算法属于[子空间迭代](@entry_id:168266)法，其核心思想是：
1. 从一个或多个初始猜测向量开始，构建一个小的[子空间](@entry_id:150286)。
2. 在该[子空间](@entry_id:150286)中构建并对角化 $\mathbf{H}$ 的[投影矩阵](@entry_id:154479)，得到当前的近似[本征值](@entry_id:154894) $\theta$ 和[本征向量](@entry_id:151813) $\mathbf{x}$。
3. 计算[残差向量](@entry_id:165091) $\mathbf{r} = (\mathbf{H} - \theta\mathbf{I})\mathbf{x}$。如果 $\mathbf{r}$ 的模长足够小，则迭代收敛。
4. 否则，计算一个校正向量 $\mathbf{s}$，用它来扩展[子空间](@entry_id:150286)，然后返回步骤2。

算法的关键在于第4步，如何有效地计算校正向量 $\mathbf{s}$。理想的校正（基于牛顿法）需要[求解线性方程组](@entry_id:169069) $(\mathbf{H} - \theta\mathbf{I})\mathbf{s} = -\mathbf{r}$，但这和原始问题一样困难。戴维森算法的精髓在于使用一个简单而高效的**[预处理](@entry_id:141204)子**（preconditioner）来近似求解该方程。最常用的[预处理](@entry_id:141204)子是对角[预处理](@entry_id:141204)子，它忽略 $\mathbf{H}$ 的所有非对角元，从而得到近似的校正向量 [@problem_id:2881650]：
$$
s_i \approx \frac{-r_i}{H_{ii} - \theta} = \frac{r_i}{\theta - H_{ii}}
$$
其中 $H_{ii} = \langle D_i | \hat{H} | D_i \rangle$ 是第 $i$ 个[基函数](@entry_id:170178)的对角[哈密顿矩阵元](@entry_id:201928)，代表其零级能量。这种近似之所以有效，是因为分母 $(\theta - H_{ii})$ 正好是瑞利-薛定谔[微扰理论](@entry_id:138766)中[能量修正](@entry_id:198270)项的分母的近似。它会放大那些能量上与当前近似态接近（即 $|H_{ii} - \theta|$ 小）的组态所对应的残差分量，从而将搜索方向引向最重要的修正区域，加速收敛。

在实际应用中，当 $\theta$ 碰巧非常接近某个 $H_{ii}$ 时，分母会趋于零导致数值不稳定。为了避免这种情况，通常会引入一个小的“[能级移动](@entry_id:156631)”参数 $\sigma > 0$，将分母替换为 $(\theta - H_{ii} + \sigma)$，这在保证[算法稳定性](@entry_id:147637)的同时，基本不影响其收敛效率 [@problem_id:2881650]。

通过这些精巧的数值技术，求解巨大CI矩阵的低阶本征态问题在现代计算机上成为可能，使得[CI方法](@entry_id:186312)族成为理论与计算化学中不可或缺的工具。