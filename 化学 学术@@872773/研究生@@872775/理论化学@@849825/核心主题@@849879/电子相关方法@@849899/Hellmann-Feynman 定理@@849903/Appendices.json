{"hands_on_practices": [{"introduction": "本练习是赫尔曼-费曼定理的基础实践。它首先要求你从量子力学的第一性原理出发，严格推导该定理，从而巩固你的理论基础。随后，你将把推导出的定理应用于一个简单但普遍存在的两能级系统——这是量子物理学中的一个基石模型。通过将结果与直接的解析计算进行比较，本练习为定理的有效性和实用性提供了具体的验证。[@problem_id:2814495]", "problem": "一个作用于有限维希尔伯特空间的含参哈密顿量 $H(\\lambda)$ 具有瞬时本征对 $\\{E_{n}(\\lambda),\\,|\\psi_{n}(\\lambda)\\rangle\\}$，它们满足不含时薛定谔方程 $H(\\lambda)\\,|\\psi_{n}(\\lambda)\\rangle=E_{n}(\\lambda)\\,|\\psi_{n}(\\lambda)\\rangle$ 和归一化条件 $\\langle\\psi_{n}(\\lambda)|\\psi_{n}(\\lambda)\\rangle=1$。假设对于一个固定的本征值标签 $n$，$E_{n}(\\lambda)$ 是非简并的，并且映射 $\\lambda\\mapsto H(\\lambda)$ 在所关心的开区间内是可微的。\n\n从这些基本关系出发，且不援引任何外部定理，首先推导一个关于能量对参数的导数 $dE_{n}(\\lambda)/d\\lambda$ 的普适恒等式，用 $|\\psi_{n}(\\lambda)\\rangle$ 和 $\\partial H(\\lambda)/\\partial\\lambda$ 来表示。然后，将其特化到二能级哈密顿量\n$$\nH(\\lambda)=\\begin{pmatrix}\\Delta  & \\lambda\\\\ \\lambda  -\\Delta\\end{pmatrix},\n$$\n其中 $\\Delta\\in\\mathbb{R}$ 是一个固定参数，$\\lambda\\in\\mathbb{R}$ 是控制参数，并计算其两个本征值 $E_{\\pm}(\\lambda)$ 对应的 $dE_{\\pm}(\\lambda)/d\\lambda$。为使你的计算更明确，你可以构造 $H(\\lambda)$ 的归一化本征矢量，并计算出现的任何内积。\n\n另外，独立地对 $H(\\lambda)$ 进行解析对角化，以获得 $E_{\\pm}(\\lambda)$ 的闭合形式表达式，并将它们直接对 $\\lambda$ 求导。将结果与你之前的结果进行比较，并简要解释你所推导的恒等式在该模型下成立或可能失效的条件。\n\n将你的最终答案以有序对 $\\big(dE_{+}(\\lambda)/d\\lambda,\\,dE_{-}(\\lambda)/d\\lambda\\big)$ 的单个闭合形式解析表达式的形式报告。不需要单位。不要对你的答案进行四舍五入。", "solution": "所提出的问题是量子力学微扰理论中的一个标准练习，且问题定义明确。它具有科学依据，内容自洽，且客观。我们将着手解答。\n\n首先，我们推导能量本征值对参数的导数的普适恒等式，即著名的赫尔曼–费曼定理。我们从非简并本征态 $|\\psi_{n}(\\lambda)\\rangle$ 的不含时薛定谔方程开始：\n$$\nH(\\lambda)\\,|\\psi_{n}(\\lambda)\\rangle=E_{n}(\\lambda)\\,|\\psi_{n}(\\lambda)\\rangle\n$$\n给定归一化条件 $\\langle\\psi_{n}(\\lambda)|\\psi_{n}(\\lambda)\\rangle=1$，能量本征值 $E_{n}(\\lambda)$ 可以表示为哈密顿量在该态下的期望值：\n$$\nE_{n}(\\lambda) = \\langle\\psi_{n}(\\lambda)|H(\\lambda)|\\psi_{n}(\\lambda)\\rangle\n$$\n现在我们应用乘法法则对该表达式关于参数 $\\lambda$ 求导：\n$$\n\\frac{dE_{n}(\\lambda)}{d\\lambda} = \\frac{d}{d\\lambda} \\Big( \\langle\\psi_{n}(\\lambda)|H(\\lambda)|\\psi_{n}(\\lambda)\\rangle \\Big)\n$$\n$$\n\\frac{dE_{n}(\\lambda)}{d\\lambda} = \\left(\\frac{d\\langle\\psi_{n}(\\lambda)|}{d\\lambda}\\right) H(\\lambda) |\\psi_{n}(\\lambda)\\rangle + \\langle\\psi_{n}(\\lambda)| \\left(\\frac{\\partial H(\\lambda)}{\\partial\\lambda}\\right) |\\psi_{n}(\\lambda)\\rangle + \\langle\\psi_{n}(\\lambda)| H(\\lambda) \\left(\\frac{d|\\psi_{n}(\\lambda)\\rangle}{d\\lambda}\\right)\n$$\n由于哈密顿量 $H(\\lambda)$ 是厄米的，我们可以让它作用在左矢上或右矢上。使用薛定谔方程 $H(\\lambda) |\\psi_{n}(\\lambda)\\rangle = E_n(\\lambda)|\\psi_{n}(\\lambda)\\rangle$ 及其厄米共轭 $\\langle\\psi_{n}(\\lambda)| H(\\lambda) = \\langle\\psi_{n}(\\lambda)| E_n(\\lambda) = E_n(\\lambda)\\langle\\psi_{n}(\\lambda)|$。将这些代入表达式中，得到：\n$$\n\\frac{dE_{n}(\\lambda)}{d\\lambda} = E_{n}(\\lambda) \\left(\\frac{d\\langle\\psi_{n}(\\lambda)|}{d\\lambda}\\right) |\\psi_{n}(\\lambda)\\rangle + \\left\\langle\\psi_{n}(\\lambda)\\left|\\frac{\\partial H(\\lambda)}{\\partial\\lambda}\\right|\\psi_{n}(\\lambda)\\right\\rangle + E_{n}(\\lambda) \\langle\\psi_{n}(\\lambda)| \\left(\\frac{d|\\psi_{n}(\\lambda)\\rangle}{d\\lambda}\\right)\n$$\n将标量能量本征值 $E_{n}(\\lambda)$ 因子提出来：\n$$\n\\frac{dE_{n}(\\lambda)}{d\\lambda} = E_{n}(\\lambda) \\left[ \\left(\\frac{d\\langle\\psi_{n}(\\lambda)|}{d\\lambda}\\right) |\\psi_{n}(\\lambda)\\rangle + \\langle\\psi_{n}(\\lambda)| \\left(\\frac{d|\\psi_{n}(\\lambda)\\rangle}{d\\lambda}\\right) \\right] + \\left\\langle\\psi_{n}(\\lambda)\\left|\\frac{\\partial H(\\lambda)}{\\partial\\lambda}\\right|\\psi_{n}(\\lambda)\\right\\rangle\n$$\n方括号中的项恰好是归一化条件的导数：\n$$\n\\frac{d}{d\\lambda} \\langle\\psi_{n}(\\lambda)|\\psi_{n}(\\lambda)\\rangle = \\frac{d}{d\\lambda}(1) = 0\n$$\n因此，第一项为零，我们得到以下恒等式：\n$$\n\\frac{dE_{n}(\\lambda)}{d\\lambda} = \\left\\langle\\psi_{n}(\\lambda)\\left|\\frac{\\partial H(\\lambda)}{\\partial\\lambda}\\right|\\psi_{n}(\\lambda)\\right\\rangle\n$$\n这就是赫尔曼–费曼定理。\n\n接下来，我们特化到给定的二能级哈密顿量：\n$$\nH(\\lambda) = \\begin{pmatrix} \\Delta  \\lambda \\\\ \\lambda  -\\Delta \\end{pmatrix}\n$$\n哈密顿量对 $\\lambda$ 的导数是显而易见的：\n$$\n\\frac{\\partial H(\\lambda)}{\\partial\\lambda} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n为了应用所推导的恒等式，我们需要 $H(\\lambda)$ 的本征矢量。首先，我们从特征方程 $\\det(H(\\lambda) - E I) = 0$ 求解本征值 $E_{\\pm}(\\lambda)$：\n$$\n(\\Delta - E)(-\\Delta - E) - \\lambda^{2} = 0 \\implies -(\\Delta^{2} - E^{2}) - \\lambda^{2} = 0 \\implies E^{2} = \\Delta^{2} + \\lambda^{2}\n$$\n两个本征值为 $E_{+}(\\lambda) = \\sqrt{\\Delta^{2} + \\lambda^{2}}$ 和 $E_{-}(\\lambda) = -\\sqrt{\\Delta^{2} + \\lambda^{2}}$。\n\n现在我们求相应的本征矢量 $|\\psi_{\\pm}(\\lambda)\\rangle = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$。对于给定的本征值 $E$，其分量满足 $(\\Delta-E)a + \\lambda b = 0$。我们可以将未归一化的本征矢量表示为 $\\begin{pmatrix} \\lambda \\\\ E-\\Delta \\end{pmatrix}$。\n归一化常数 $N$ 可由 $N^{-2} = |\\lambda|^{2} + |E-\\Delta|^{2}$ 求得。让我们计算这个归一化因子：\n$$\n|\\lambda|^{2} + |E_{\\pm}-\\Delta|^{2} = \\lambda^{2} + (E_{\\pm}-\\Delta)^{2} = \\lambda^{2} + E_{\\pm}^{2} - 2\\Delta E_{\\pm} + \\Delta^{2}\n$$\n代入 $E_{\\pm}^{2} = \\Delta^{2} + \\lambda^{2}$，我们得到：\n$$\n= (\\lambda^{2}+\\Delta^{2}) + E_{\\pm}^{2} - 2\\Delta E_{\\pm} = E_{\\pm}^{2} + E_{\\pm}^{2} - 2\\Delta E_{\\pm} = 2E_{\\pm}^{2} - 2\\Delta E_{\\pm} = 2E_{\\pm}(E_{\\pm}-\\Delta)\n$$\n因此，归一化的本征矢量为 $|\\psi_{\\pm}(\\lambda)\\rangle = \\frac{1}{\\sqrt{2E_{\\pm}(E_{\\pm}-\\Delta)}} \\begin{pmatrix} \\lambda \\\\ E_{\\pm}-\\Delta \\end{pmatrix}$。\n\n我们现在计算期望值 $\\langle\\psi_{\\pm}|\\frac{\\partial H}{\\partial\\lambda}|\\psi_{\\pm}\\rangle$：\n$$\n\\frac{dE_{\\pm}}{d\\lambda} = \\frac{1}{2E_{\\pm}(E_{\\pm}-\\Delta)} \\begin{pmatrix} \\lambda  E_{\\pm}-\\Delta \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\lambda \\\\ E_{\\pm}-\\Delta \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2E_{\\pm}(E_{\\pm}-\\Delta)} \\begin{pmatrix} \\lambda  E_{\\pm}-\\Delta \\end{pmatrix} \\begin{pmatrix} E_{\\pm}-\\Delta \\\\ \\lambda \\end{pmatrix}\n$$\n$$\n= \\frac{\\lambda(E_{\\pm}-\\Delta) + (E_{\\pm}-\\Delta)\\lambda}{2E_{\\pm}(E_{\\pm}-\\Delta)} = \\frac{2\\lambda(E_{\\pm}-\\Delta)}{2E_{\\pm}(E_{\\pm}-\\Delta)} = \\frac{\\lambda}{E_{\\pm}}\n$$\n代入 $E_{\\pm}(\\lambda)$ 的表达式：\n$$\n\\frac{dE_{+}(\\lambda)}{d\\lambda} = \\frac{\\lambda}{E_{+}(\\lambda)} = \\frac{\\lambda}{\\sqrt{\\Delta^{2}+\\lambda^{2}}}\n$$\n$$\n\\frac{dE_{-}(\\lambda)}{d\\lambda} = \\frac{\\lambda}{E_{-}(\\lambda)} = \\frac{\\lambda}{-\\sqrt{\\Delta^{2}+\\lambda^{2}}} = -\\frac{\\lambda}{\\sqrt{\\Delta^{2}+\\lambda^{2}}}\n$$\n这就完成了使用赫尔曼–费曼定理的计算。\n\n为了独立验证，我们直接对本征值求导。\n$$\nE_{\\pm}(\\lambda) = \\pm\\sqrt{\\Delta^{2} + \\lambda^{2}}\n$$\n$$\n\\frac{dE_{\\pm}(\\lambda)}{d\\lambda} = \\pm \\frac{1}{2\\sqrt{\\Delta^{2}+\\lambda^{2}}} \\cdot (2\\lambda) = \\pm \\frac{\\lambda}{\\sqrt{\\Delta^{2}+\\lambda^{2}}}\n$$\n这证实了我们之前的结果。\n\n最后，我们讨论赫尔曼–费曼定理的有效性条件。推导过程假设了本征态 $|\\psi_{n}(\\lambda)\\rangle$ 关于 $\\lambda$ 是可微的。这个条件在本征值发生简并的点上可能会失效。对于给定的哈密顿量， $E_{+}(\\lambda) = E_{-}(\\lambda)$ 仅当 $\\sqrt{\\Delta^{2}+\\lambda^{2}} = -\\sqrt{\\Delta^{2}+\\lambda^{2}}$，这意味着 $\\Delta^{2}+\\lambda^{2} = 0$。由于 $\\Delta$ 和 $\\lambda$ 都是实数，这只在 $\\Delta=0$ 且 $\\lambda=0$ 时发生。\n情况1：$\\Delta \\neq 0$。对于任何实数 $\\lambda$，本征值 $E_{+}(\\lambda)$ 和 $E_{-}(\\lambda)$ 永不相等。能谱处处非简并。该定理对所有 $\\lambda \\in \\mathbb{R}$ 均有效。\n情况2：$\\Delta = 0$。哈密顿量为 $H(\\lambda) = \\lambda \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$，本征值为 $E_{\\pm}(\\lambda) = \\pm\\sqrt{\\lambda^{2}} = \\pm|\\lambda|$。在 $\\lambda=0$ 处，本征值发生简并， $E_{+}(0) = E_{-}(0) = 0$。函数 $|\\lambda|$ 在 $\\lambda=0$ 处不可微。因此，赫尔曼–费曼恒等式的左侧 $dE_{\\pm}/d\\lambda$ 在 $\\lambda=0$ 处没有定义。因此，对于 $\\Delta = 0$ 的情况，该定理在简并点 $\\lambda=0$ 处失效。对于任何 $\\lambda \\neq 0$，本征值是非简并的，定理成立。", "answer": "$$\n\\boxed{\\left(\\frac{\\lambda}{\\sqrt{\\Delta^{2} + \\lambda^{2}}}, -\\frac{\\lambda}{\\sqrt{\\Delta^{2} + \\lambda^{2}}}\\right)}\n$$", "id": "2814495"}, {"introduction": "在对角形式定理的基础上，本练习深入探讨了其在微扰论中的应用，这对于理解量子态如何响应外部场至关重要。你将分析一个耦合量子点模型——这是一个在现代固态物理和量子计算中具有重要意义的系统。本练习要求你运用与赫尔曼-费曼定理密切相关的一阶微扰理论，来确定当微扰被引入时，不同能级本征态之间混合的初始速率，从而揭示该定理在计算波函数修正中的作用。[@problem_id:1406912]", "problem": "考虑一个由一对耦合的相同量子点组成的模型系统。该系统可以由两个局域化的、正交归一的基态 $|1\\rangle$ 和 $|2\\rangle$ 来描述，它们分别对应于电子局域在量子点 1 或量子点 2 上的情况。在没有任何外场的情况下，系统的行为由未受扰动的哈密顿量 $H_0$ 决定。在 $\\{|1\\rangle, |2\\rangle\\}$ 基下，$H_0$ 的矩阵表示为：\n$$\nH_0 = \\begin{pmatrix} E_0  -t \\\\ -t  E_0 \\end{pmatrix}\n$$\n其中 $E_0$ 是在位能，$t$ 是隧穿（耦合）能。$E_0$ 和 $t$ 都是正实数常量。这个未受扰动哈密顿量的两个本征态是对称态和反对称态，分别为 $|\\psi_S\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle + |2\\rangle)$ 和 $|\\psi_A\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |2\\rangle)$，其对应的能量为 $E_S$ 和 $E_A$，其中 $E_S  E_A$。\n\n现在施加一个外部电场，引入一个微扰 $H' = \\lambda V$。这里，$\\lambda$ 是一个表示微扰强度的无量纲参数。算符 $V$ 在 $\\{|1\\rangle, |2\\rangle\\}$ 基下的矩阵表示如下：\n$$\nV = \\begin{pmatrix} \\Delta  0 \\\\ 0  -\\Delta \\end{pmatrix}\n$$\n其中 $\\Delta$ 是一个表示由电场引起的能量偏移的正实数常量。系统的总哈密顿量为 $H(\\lambda) = H_0 + \\lambda V$。\n\n对于任何 $\\lambda$ 值，完整哈密顿量的基态 $|\\Psi_g(\\lambda)\\rangle$ 都可以表示为未受扰动本征态的线性组合：\n$$\n|\\Psi_g(\\lambda)\\rangle = c_S(\\lambda)|\\psi_S\\rangle + c_A(\\lambda)|\\psi_A\\rangle\n$$\n我们知道，在极限 $\\lambda \\to 0$ 下，完整哈密顿量的基态平滑地连接到未受扰动的基态，即 $|\\Psi_g(0)\\rangle = |\\psi_S\\rangle$。\n\n您的任务是确定当微扰开启时，未受扰动的反对称态 $|\\psi_A\\rangle$ 混合到基态中的初始速率。具体来说，计算导数 $\\frac{dc_A}{d\\lambda}$ 在 $\\lambda=0$ 处的值。请用给定的参数 $t$ 和 $\\Delta$ 以闭合形式的解析表达式给出您的答案。", "solution": "该问题旨在应用一阶微扰理论计算基态波函数对微扰的线性响应。\n\n首先，我们确定未受扰动系统的属性。未受扰动的哈密顿量 $H_0$ 在 $\\{|1\\rangle, |2\\rangle\\}$ 基下的矩阵为：\n$$ H_0 = \\begin{pmatrix} E_0  -t \\\\ -t  E_0 \\end{pmatrix} $$\n其本征态为对称态 $|\\psi_S\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle + |2\\rangle)$ 和反对称态 $|\\psi_A\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |2\\rangle)$。对应的本征能量分别为：\n$$ E_S = E_0 - t $$\n$$ E_A = E_0 + t $$\n由于 $t>0$，基态是能量较低的对称态 $|\\psi_S\\rangle$，即 $|\\Psi_g(0)\\rangle = |\\psi_S\\rangle$。\n\n接下来，我们引入微扰 $H' = \\lambda V$，其中 $V$ 的矩阵表示为：\n$$ V = \\begin{pmatrix} \\Delta  0 \\\\ 0  -\\Delta \\end{pmatrix} $$\n根据标准的一阶微扰理论，受扰动后的基态 $|\\Psi_g(\\lambda)\\rangle$ 可以近似为未受扰动本征态的线性组合。对于小的 $\\lambda$，其一阶修正是：\n$$ |\\Psi_g(\\lambda)\\rangle \\approx |\\psi_S\\rangle + \\lambda |\\psi_S^{(1)}\\rangle $$\n其中，一阶波函数修正项 $|\\psi_S^{(1)}\\rangle$ 是通过将微扰算符耦合到其他本征态来计算的。在本例中，唯一的另一个态是 $|\\psi_A\\rangle$：\n$$ |\\psi_S^{(1)}\\rangle = \\frac{\\langle\\psi_A|V|\\psi_S\\rangle}{E_S - E_A} |\\psi_A\\rangle $$\n将此表达式代入 $|\\Psi_g(\\lambda)\\rangle$ 的展开式：\n$$ |\\Psi_g(\\lambda)\\rangle \\approx |\\psi_S\\rangle + \\lambda \\frac{\\langle\\psi_A|V|\\psi_S\\rangle}{E_S - E_A} |\\psi_A\\rangle $$\n通过与问题中给出的表达式 $|\\Psi_g(\\lambda)\\rangle = c_S(\\lambda)|\\psi_S\\rangle + c_A(\\lambda)|\\psi_A\\rangle$ 比较，我们可以识别出，对于小的 $\\lambda$，$c_A(\\lambda)$ 近似为：\n$$ c_A(\\lambda) \\approx \\lambda \\frac{\\langle\\psi_A|V|\\psi_S\\rangle}{E_S - E_A} $$\n我们要求的量是混合系数 $c_A$ 对 $\\lambda$ 的初始变化率，即导数在 $\\lambda=0$ 处的值：\n$$ \\frac{dc_A}{d\\lambda}\\bigg|_{\\lambda=0} = \\frac{\\langle\\psi_A|V|\\psi_S\\rangle}{E_S - E_A} $$\n现在我们计算分子和分母。\n能量差为：\n$$ E_S - E_A = (E_0 - t) - (E_0 + t) = -2t $$\n微扰的矩阵元为：\n$$ \\langle\\psi_A|V|\\psi_S\\rangle = \\left( \\frac{1}{\\sqrt{2}}(\\langle 1| - \\langle 2|) \\right) V \\left( \\frac{1}{\\sqrt{2}}(|1\\rangle + |2\\rangle) \\right) $$\n$$ = \\frac{1}{2} (\\langle 1| - \\langle 2|) \\begin{pmatrix} \\Delta  0 \\\\ 0  -\\Delta \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} \\Delta \\\\ -\\Delta \\end{pmatrix} $$\n$$ = \\frac{1}{2} (1 \\cdot \\Delta + (-1) \\cdot (-\\Delta)) = \\frac{1}{2} (\\Delta + \\Delta) = \\Delta $$\n将这些结果代入，得到最终答案：\n$$ \\frac{dc_A}{d\\lambda}\\bigg|_{\\lambda=0} = \\frac{\\Delta}{-2t} = -\\frac{\\Delta}{2t} $$", "answer": "$$\\boxed{-\\frac{\\Delta}{2t}}$$", "id": "1406912"}, {"introduction": "这最后一个练习旨在弥合抽象理论与实用计算化学之间的鸿沟。计算原子上的力是执行分子动力学模拟和几何优化的基本任务。本问题将指导你设计并实现一个程序，在一个简化但真实的平面波框架内计算赫尔曼-费曼力。你将直面关键的数值挑战，如基组表示和变分一致性的重要性，从而对现代电子结构软件的内部工作原理获得宝贵的见解。[@problem_id:2814531]", "problem": "设计并实现一个完整的、可运行的程序，用于演示、验证和压力测试在与理论化学相关的简化一维平面波框架中，基于 Hellmann-Feynman 定理的力的实现。从以下基本基础开始：由核坐标 $R$ 参数化的电子哈密顿量的时间无关薛定谔方程，归一化本征态的变分原理，以及周期性超胞中平面波基的定义。不要使用或假设任何预先推导的力表达式。相反，应从这些基本原理出发，推导出必须评估的内容、其有效性的原因以及推导过程。你的程序应实现一个带光滑局域赝势的最小一维平面波模型，并评估在不同数值网格分辨率下 Hellmann-Feynman 力的变分一致性。完全使用原子单位（长度单位为玻尔，能量单位为哈特里，力单位为哈特里/玻尔）进行计算，并以布尔值的形式返回最终结果，指示指定的数值一致性检查是否在给定容差内通过。\n\n你必须在以下物理上和数值上合理的假设下进行，这些假设在此作为你将实现和测试的模型定义的一部分进行陈述：\n\n- 电子哈密顿量依赖于长度为 $L$ 的周期性晶胞中的单个核位置 $R$，并使用 $\\Gamma$ 点的平面波基 $\\{\\lvert G \\rangle\\}$。动能算符在平面波基中是对角的，矩阵元为 $T_{GG'}=\\frac{1}{2}G^2 \\,\\delta_{GG'}$，其中 $G=\\frac{2\\pi}{L}n$ 且 $n\\in\\mathbb{Z}$ 受动能截断 $G_{\\text{cut}}$ 限制，通过 $\\lvert G \\rvert \\le G_{\\text{cut}}$。\n- 外部局域赝势是一个光滑的、周期性的高斯梳，中心位于 $R$，振幅为 $V_00$，宽度为 $\\sigma0$，\n  $$V(x;R) = -V_0 \\sum_{m\\in\\mathbb{Z}} \\exp\\!\\left(-\\frac{(x-R-mL)^2}{2\\sigma^2}\\right),$$\n  这导致其傅里叶系数绝对收敛，并对波矢 $q$ 以 $\\exp(-\\sigma^2 q^2/2)$ 的形式衰减。\n- 在平面波离散傅里叶变换（数值意义上的 DFT，而非密度泛函理论）中，局域势矩阵元 $V_{GG'}(R)$ 既可以利用解析傅里叶系数在倒易空间中精确构建，也可以通过在具有 $N$ 个点的实空间网格上采样来近似构建，\n  $$V_{GG'}(R) \\approx \\frac{L}{N}\\sum_{j=0}^{N-1} V(x_j;R)\\,e^{-i(G-G')x_j},\\quad x_j=\\frac{jL}{N},$$\n  如果网格的奈奎斯特波数 $G_{\\text{Nyq}}=\\pi N/L$ 未能覆盖平面波哈密顿量所需的所有重要傅里叶分量（特别是对于差值 $G-G'$ 支持到 $2G_{\\text{cut}}$ 以及局域势傅里叶谱的尾部），则会产生混叠效应。这体现了在平面波实现中控制变分一致性的数值网格考虑因素。\n\n你的程序必须实现以下内容，严格遵守基于原理的推导和数值构建：\n\n1. 根据 $L$ 和 $G_{\\text{cut}}$ 构建平面波基 $\\{G\\}$。\n2. 通过两种方式构建哈密顿矩阵 $H(R)=T+V(R)$：\n   - 倒易空间路径：使用周期性高斯梳的解析傅里叶表示，确保对 $H(R)$ 中使用的任何截断都是无混叠的构建。\n   - 实空间网格路径：通过在晶胞中的 $N$ 个网格点上对 $V(x;R)$ 进行采样，并通过离散傅里叶求和来组装 $V_{GG'}(R)$。\n3. 求解厄米本征问题 $H(R)\\lvert \\psi(R)\\rangle = E(R)\\lvert \\psi(R)\\rangle$，以获得基态能量 $E(R)$ 和在平面波基中的归一化本征矢量系数 $c_G(R)$。\n4. 计算 Hellmann-Feynman 力，其定义为总电子能量对核坐标 $R$ 的负导数，使用哈密顿量对 $R$ 的导数进行评估，即仅使用算符导数和在 $R$ 处的归一化本征矢量。基组必须被视为与 $R$ 无关（这与固定晶胞中的平面波一致），因此在该模型中不会出现 Pulay 项。\n5. 使用中心差分独立计算能量导数的有限差分估计，\n   $$\\frac{dE}{dR}\\bigg\\rvert_{R} \\approx \\frac{E(R+h)-E(R-h)}{2h},$$\n   其中 $h$ 是一个小位移。\n6. 对于指定的测试案例，使用相同或不同的哈密顿量构建路径，比较 Hellmann-Feynman 力与中心差分导数，以评估在网格分辨率变化下的变分一致性。为每个案例返回一个布尔值，报告其绝对差是否低于指定的容差。\n\n作为你推导和实施计划的一部分，你必须确保以下概念的覆盖，即使你的数值模型只包括局域势：\n- 列举在一个通用的平面波 Kohn-Sham 密度泛函理论（DFT）代码中对力有贡献的各项，以展示对完整性的理解：局域赝势、可分离的非局域赝势投影算符、Hartree 能量贡献、交换关联能量贡献，以及离子-离子相互作用（例如，通过 Ewald 求和）。指出在使用固定平面波基时 Pulay 项在何处消失，并解释在诸如投影缀加波（PAW）方法或超软赝势等方法中缀加项的作用。\n- 解释确保能量及其导数一致性所需的数值网格考虑因素，包括网格需要能表示高达约 $2G_{\\text{cut}}$ 的傅里叶分量以处理算符乘积，以及来自外部势谱的任何附加尾部。将此与常见的实践规则联系起来，例如密度网格截断和用于混叠控制的所谓 $3/2$ 规则启发法。\n\n使用以下参数值作为测试套件。如上所述，所有输入均为原子单位且无量纲，不使用角度。你的代码必须在内部设置这些参数并产生输出，无需任何用户输入。\n\n- 晶胞长度：$L=20$。\n- 平面波截断：$G_{\\text{cut}}=2.5$。\n- 高斯赝势参数：$V_0=2.0$，$\\sigma=1.0$。\n- 核位置：$R_0=5.3$。\n- 中心差分步长：$h=10^{-4}$。\n- 用于测试的实空间网格尺寸：\n  - 案例 A（参考，仅倒易空间）：Hellmann-Feynman 力和能量导数均由倒易空间哈密顿量构建，无实空间采样。\n  - 案例 B（网格，充分解析）：Hellmann-Feynman 力和能量导数均由具有 $N=128$ 的实空间采样构建，这应足以表示高达约 $2G_{\\text{cut}}$ 的差异和 $\\sigma=1.0$ 的高斯尾部。\n  - 案例 C（不匹配，故意不一致）：Hellmann-Feynman 力由具有 $N=32$ 的实空间网格构建，而能量导数由倒易空间构建。这种不匹配预计会破坏变分一致性。\n  - 案例 D（网格，欠采样但内部一致）：Hellmann-Feynman 力和能量导数均由具有 $N=32$ 的实空间网格构建。虽然表示可能不准确，但内部一致性应保持。\n\n每个案例的数值接受标准：\n- 如果 $\\lvert F_{\\text{HF}} - \\frac{E(R+h)-E(R-h)}{2h} \\rvert  \\tau$，则生成布尔值 $ \\text{True}$，否则为 $ \\text{False}$，其中 $\\tau=10^{-5}$。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 $[\\text{案例 A},\\text{案例 B},\\text{案例 C},\\text{案例 D}]$。\n\n最终输出必须匹配此确切格式，例如，$[\\text{True},\\text{True},\\text{False},\\text{True}]$（确切的布尔值必须由你的计算确定）。", "solution": "所提出的问题是计算理论化学领域一个有效且适定的练习。它要求在一个简化的一维平面波模型内，演示 Hellmann-Feynman 定理并分析其数值-变分一致性。所有必要的物理参数、数学定义和数值约束都已提供，从而可以得出一个唯一且可验证的解。该问题在科学上植根于量子力学和电子结构理论的标准数值技术。我将进行完整的推导和实现。\n\n该分析的基础是时间无关薛定谔方程，用于描述哈密顿量 $H(\\lambda)$ 依赖于参数 $\\lambda$ 的电子系统。在我们的案例中，$\\lambda$ 是核坐标，我们用 $R$ 表示。方程为：\n$$ H(R) |\\psi(R)\\rangle = E(R) |\\psi(R)\\rangle $$\n其中 $|\\psi(R)\\rangle$ 是一个本征态，其对应的能量本征值为 $E(R)$。我们考虑基态，其能量为最小值，且波函数是归一化的，$\\langle \\psi(R) | \\psi(R) \\rangle = 1$。\n\n能量可以表示为哈密顿量的期望值：\n$$ E(R) = \\langle \\psi(R) | H(R) | \\psi(R) \\rangle $$\n在位置 $R$ 处的核上的力定义为总能量的负梯度，$F(R) = -\\frac{dE(R)}{dR}$。为了推导 Hellmann-Feynman 定理，我们使用乘积法则对能量表达式关于 $R$ 求导：\n$$ \\frac{dE}{dR} = \\left\\langle \\frac{d\\psi}{dR} \\right| H | \\psi \\rangle + \\left\\langle \\psi \\left| \\frac{\\partial H}{\\partial R} \\right| \\psi \\right\\rangle + \\left\\langle \\psi \\right| H \\left| \\frac{d\\psi}{dR} \\right\\rangle $$\n由于 $|\\psi\\rangle$ 是一个本征态，因此 $H|\\psi\\rangle = E|\\psi\\rangle$。第一项变为 $E\\langle \\frac{d\\psi}{dR} | \\psi \\rangle$。利用哈密顿量的厄米性 $H^\\dagger=H$，最后一项变为 $\\langle H\\psi | \\frac{d\\psi}{dR} \\rangle = \\langle E\\psi | \\frac{d\\psi}{dR} \\rangle = E^* \\langle \\psi | \\frac{d\\psi}{dR} \\rangle$。由于厄米算符的能量本征值是实数，所以 $E^*=E$。第一项和最后一项的和是：\n$$ E \\left( \\left\\langle \\frac{d\\psi}{dR} | \\psi \\right\\rangle + \\left\\langle \\psi | \\frac{d\\psi}{dR} \\right\\rangle \\right) = E \\frac{d}{dR} \\langle \\psi | \\psi \\rangle $$\n因为波函数是归一化的，$\\langle \\psi | \\psi \\rangle = 1$，其导数为零。因此，这两项相消，得到 Hellmann-Feynman 定理：\n$$ \\frac{dE}{dR} = \\left\\langle \\psi(R) \\left| \\frac{\\partial H(R)}{\\partial R} \\right| \\psi(R) \\right\\rangle $$\n因此，力由哈密顿量导数的期望值给出：\n$$ F_{\\text{HF}}(R) = - \\left\\langle \\psi(R) \\left| \\frac{\\partial H(R)}{\\partial R} \\right| \\psi(R) \\right\\rangle $$\n只要 $|\\psi(R)\\rangle$ 是 $H(R)$ 的精确本征态，该定理就成立。变分原理确保了它对于从变分计算中获得的波函数也成立，这是 Hartree-Fock 和密度泛函理论（DFT）等方法的基石。\n\n在我们的平面波模型中，哈密顿量是 $H(R) = T + V(R)$。动能算符 $T$ 和平面波基函数 $\\{|G\\rangle\\}$ 与核位置 $R$ 无关。由 $\\langle x | G \\rangle = (1/\\sqrt{L})e^{iGx}$ 给出的基函数相对于模拟晶胞是固定的。因此，哈密顿量中唯一依赖于 $R$ 的部分是势算符 $V(R)$。力的表达式简化为：\n$$ F_{\\text{HF}}(R) = - \\left\\langle \\psi(R) \\left| \\frac{\\partial V(R)}{\\partial R} \\right| \\psi(R) \\right\\rangle $$\n\n在平面波基中展开基态波函数 $|\\psi\\rangle = \\sum_G c_G |G\\rangle$，力以矩阵形式计算：\n$$ F_{\\text{HF}} = - \\sum_{G, G'} c_{G'}^* \\left\\langle G' \\left| \\frac{\\partial V(R)}{\\partial R} \\right| G \\right\\rangle c_G = - \\mathbf{c}^\\dagger \\left( \\frac{\\partial \\mathbf{V}}{\\partial R} \\right) \\mathbf{c} $$\n其中 $\\mathbf{c}$ 是系数 $c_G$ 的列向量，$\\frac{\\partial \\mathbf{V}}{\\partial R}$ 是势导数算符的矩阵。\n\n问题要求对完整平面波 DFT 计算中的力进行更广泛的概念性讨论。作用在离子上的总力是几个贡献之和：\n1.  **局域赝势**：对应于本问题中的项。它是赝势局域部分导数的期望值。\n2.  **非局域赝势**：大多数现代赝势包含非局域投影算符。力的贡献涉及这些投影算符相对于原子位置的导数。\n3.  **Hartree 势**：电子经典静电能的导数。它依赖于电子密度相对于核坐标的导数。\n4.  **交换关联 (XC)**：该力项源于 XC 能量泛函相对于核位置的导数，这也是通过链式法则经由电子密度及其梯度进行的。\n5.  **离子-离子相互作用**：核之间的直接经典库仑力，通常通过 Ewald 求和计算周期性系统。\n\n推导出的 Hellmann-Feynman 定理假设基组与微分参数 $R$ 无关。在平面波基中，基矢量与模拟晶胞而非原子绑定，因此它们确实与 $R$ 无关。这意味着没有 **Pulay 力**（也称为 Pulay 修正）。Pulay 力出现在使用以原子为中心的基组（如高斯型轨道）的方法中，其中基函数随原子移动。这些力是解释基组本身变化的修正项。在诸如投影缀加波（PAW）等高级方法中，额外的力项源于位于原子上的缀加电荷的导数，必须小心处理。\n\n数值实现的一个关键方面是**变分一致性**。Hellmann-Feynman 定理的有效性依赖于波函数是所用*精确*哈密顿量的本征态。在数值计算中，如果我们使用近似的哈密顿量 $\\tilde{H}$（例如，在粗糙的实空间网格上构建），计算出的力 $F_{\\text{HF}} = -\\langle \\tilde{\\psi} | \\partial \\tilde{H}/\\partial R | \\tilde{\\psi} \\rangle$ 只有在*相同*的近似方案 $\\tilde{H}$ 用于两种计算时，才与有限差分力 $F_{\\text{FD}} = -(\\tilde{E}(R+h)-\\tilde{E}(R-h))/(2h)$ 一致。不匹配方案，例如对 $F_{\\text{HF}}$ 使用粗糙网格，而对 $F_{\\text{FD}}$ 使用精确公式，会破坏这种变分一致性并导致差异。\n\n这种一致性主要由用于表示算符的实空间网格的分辨率决定。两个基函数的乘积 $\\langle G'|...|G \\rangle$ 涉及诸如 $e^{-i(G-G')x}$ 之类的项。在平面波截断为 $G_{\\text{cut}}$ 的情况下，差分矢量 $G-G'$ 的大小可以达到 $2G_{\\text{cut}}$。对于势矩阵元 $\\langle G'|V|G\\rangle = \\int V(x) e^{-i(G-G')x} dx$，网格必须足够精细，以便在没有显著混叠的情况下表示高达 $2G_{\\text{cut}}$ 的振荡和势 $V(x)$ 的傅里叶分量。网格的奈奎斯特频率 $G_{\\text{Nyq}} = \\pi N/L$ 必须大于被变换量的最大频率成分。一个常见的经验法则是使用能够表示密度的网格，这涉及高达 $2G_{\\text{cut}}$ 的频率。有时，对于具有尖锐特征的势，需要更密集的网格。\"$3/2$ 规则\"是在某些情况下用于在 FFT 之前填充数组以完全消除二次量混叠的启发式方法。在这个问题中，我们将直接测试这个原理。\n\n现在，我们继续进行实现，该实现分为四个测试案例来验证这些概念。\n\n- **案例 A** (参考)：两种力计算都使用解析的、无混叠的倒易空间哈密顿量。这预计是一致的。\n- **案例 B** (足够网格)：两种计算都使用精细的实空间网格（$N=128$），这足以精确表示哈密顿量。预计是一致的。\n- **案例 C** (不匹配)：Hellmann-Feynman 力使用粗糙网格（$N=32$），而能量导数使用精确的倒易空间哈密顿量。变分一致性被破坏，预计会出现不匹配。\n- **案例 D** (一致但粗糙)：两种计算都使用相同的粗糙网格（$N=32$）。虽然绝对结果可能不准确，但这两种计算力的方法应该彼此一致。\n\n实现将根据问题定义构建哈密顿矩阵，求解所得本征问题的基态，并计算每种情况下的力以验证这些预测。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to demonstrate and test the Hellmann-Feynman theorem.\n    \"\"\"\n    \n    # --- Model Parameters (atomic units) ---\n    L = 20.0       # Cell length\n    G_cut = 2.5    # Plane-wave kinetic energy cutoff\n    V0 = 2.0       # Pseudopotential amplitude\n    sigma = 1.0    # Pseudopotential width\n    R0 = 5.3       # Nuclear position\n    h = 1.0e-4     # Central-difference step\n    tau = 1.0e-5   # Tolerance for comparison\n\n    # --- Test Case Definitions ---\n    # (N_hf, N_fd): Grid points for Hellmann-Feynman and Finite-Difference calculations.\n    # None indicates using the exact reciprocal-space representation.\n    test_cases_params = [\n        ('Case A (reciprocal only)', None, None),\n        ('Case B (grid, adequately resolved)', 128, 128),\n        ('Case C (mismatched, inconsistent)', 32, None),\n        ('Case D (grid, undersampled but consistent)', 32, 32),\n    ]\n\n    # --- Generate Plane-Wave Basis ---\n    n_max = int(np.floor(G_cut * L / (2.0 * np.pi)))\n    G_vec = (2.0 * np.pi / L) * np.arange(-n_max, n_max + 1)\n    T_matrix = 0.5 * np.diag(G_vec**2)\n    \n    # --- Helper Functions ---\n\n    def _get_periodic_potential(x_grid, R):\n        \"\"\"Calculates V(x;R) on a grid, handling periodic images of the potential.\"\"\"\n        # Find the distance to the nearest periodic image of R for each x\n        dist = x_grid - R\n        dist_periodic = dist - L * np.round(dist / L)\n        return -V0 * np.exp(-dist_periodic**2 / (2.0 * sigma**2))\n\n    def _get_periodic_potential_derivative(x_grid, R):\n        \"\"\"Calculates dV(x;R)/dR on a grid.\"\"\"\n        dist = x_grid - R\n        dist_periodic = dist - L * np.round(dist / L)\n        V_val = -V0 * np.exp(-dist_periodic**2 / (2.0 * sigma**2))\n        # d/dR = -d/dx\n        # d/dR exp(-(x-R)^2 / 2*sigma^2) = exp(...) * -(x-R)/sigma^2 * (-1)\n        # So it is V(x;R) * (x_periodic - R) / sigma^2, but our x is x_grid, R is R.\n        # The relevant distance is dist_periodic = x_grid - R_eff\n        # So dV/dR = V * (x - R_eff) / sigma^2 is incorrect. Chain rule:\n        # d/dR V(x;R) = -(-1/sigma^2)(x-R_eff) * V(x;R) = V(x;R) * (x-R_eff)/sigma^2\n        # where R_eff is the periodic image of R closest to x. So x-R_eff = dist_periodic\n        return V_val * dist_periodic / sigma**2\n        \n    def build_hamiltonian(R, N):\n        \"\"\"Constructs the Hamiltonian matrix H(R) = T + V(R).\"\"\"\n        num_basis = len(G_vec)\n        V_matrix = np.zeros((num_basis, num_basis), dtype=np.complex128)\n        \n        # Create a mesh of q = G - G' vectors\n        G_prime_mesh, G_mesh = np.meshgrid(G_vec, G_vec)\n        q_mesh = G_mesh - G_prime_mesh\n        \n        if N is None: # Reciprocal-space route\n            # The matrix element V_{GG'} = (1/L) * Integral[ V(x)exp(-i(G-G')x) ] dx\n            # The integral for a single Gaussian -V0*exp(-x^2/2s^2) is I(q) = -V0 * sqrt(2*pi)*s * exp(-s^2*q^2/2).\n            # The code is calculating I(q) * exp(-iqR), which is the Fourier transform of the shifted potential.\n            # This is correct for the integral part.\n            # Let's check the problem statement again. V_{GG'} ~ L/N sum(...)\n            # This implies the matrix elements should approximate L * V_fourier_coeff(q), or simply the integral.\n            # We will follow this convention consistently.\n            v_analytic = -V0 * np.sqrt(2.0 * np.pi) * sigma * np.exp(-1j * q_mesh * R) * \\\n                         np.exp(-0.5 * sigma**2 * q_mesh**2)\n            # For a periodic potential, we must sum over reciprocal lattice vectors.\n            # For a Gaussian comb, the FT is also a Gaussian comb.\n            # The code only considers the G=0 term of the reciprocal lattice sum for the potential FT.\n            # This is a valid approximation if L is large enough, which it is.\n            V_matrix = v_analytic\n        else: # Real-space grid route\n            x_grid = np.linspace(0, L, N, endpoint=False)\n            v_real = _get_periodic_potential(x_grid, R)\n            \n            # V_GG' approx (L/N) * sum_j V(x_j) exp(-i(G-G')x_j)\n            exp_term = np.exp(-1j * np.outer(q_mesh.flatten(), x_grid))\n            v_fourier = exp_term @ v_real\n            V_matrix = (L / N) * v_fourier.reshape(num_basis, num_basis)\n            \n        return T_matrix + V_matrix\n\n    def get_ground_state(H):\n        \"\"\"Solves the eigenproblem for the ground state.\"\"\"\n        eigvals, eigvecs = np.linalg.eigh(H)\n        ground_energy = eigvals[0]\n        ground_state_vec = eigvecs[:, 0]\n        return ground_energy, ground_state_vec\n\n    def compute_hf_force(R, c_vec, N):\n        \"\"\"Computes the Hellmann-Feynman force.\"\"\"\n        num_basis = len(G_vec)\n        dV_dR_matrix = np.zeros((num_basis, num_basis), dtype=np.complex128)\n        \n        G_prime_mesh, G_mesh = np.meshgrid(G_vec, G_vec)\n        q_mesh = G_mesh - G_prime_mesh\n        \n        if N is None: # Reciprocal-space route\n            # dV/dR = -iqV\n            v_analytic = -V0 * np.sqrt(2.0 * np.pi) * sigma * np.exp(-1j * q_mesh * R) * \\\n                         np.exp(-0.5 * sigma**2 * q_mesh**2)\n            dV_dR_matrix = -1j * q_mesh * v_analytic\n        else: # Real-space grid route\n            x_grid = np.linspace(0, L, N, endpoint=False)\n            dv_dr_real = _get_periodic_potential_derivative(x_grid, R)\n            \n            exp_term = np.exp(-1j * np.outer(q_mesh.flatten(), x_grid))\n            dv_dr_fourier = exp_term @ dv_dr_real\n            dV_dR_matrix = (L / N) * dv_dr_fourier.reshape(num_basis, num_basis)\n\n        force = -np.vdot(c_vec, dV_dR_matrix @ c_vec)\n        return force.real\n\n    def run_case(N_hf, N_fd):\n        \"\"\"Runs a single test case comparing HF and FD forces.\"\"\"\n        # 1. Compute Hellmann-Feynman force at R0\n        H_hf = build_hamiltonian(R0, N_hf)\n        _, c0 = get_ground_state(H_hf)\n        f_hf = compute_hf_force(R0, c0, N_hf)\n        \n        # 2. Compute Finite Difference force around R0\n        H_plus = build_hamiltonian(R0 + h, N_fd)\n        E_plus, _ = get_ground_state(H_plus)\n        \n        H_minus = build_hamiltonian(R0 - h, N_fd)\n        E_minus, _ = get_ground_state(H_minus)\n        \n        f_fd = -(E_plus - E_minus) / (2.0 * h)\n        \n        # 3. Compare and return boolean\n        is_consistent = np.abs(f_hf - f_fd)  tau\n        return is_consistent\n\n    # --- Execute Test Cases ---\n    results = []\n    for _, N_hf, N_fd in test_cases_params:\n        result = run_case(N_hf, N_fd)\n        results.append(str(result))\n        \n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2814531"}]}