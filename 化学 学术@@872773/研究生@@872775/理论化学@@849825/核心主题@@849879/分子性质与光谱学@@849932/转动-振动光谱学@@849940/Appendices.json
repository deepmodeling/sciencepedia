{"hands_on_practices": [{"introduction": "这项基础练习旨在巩固您对转振光谱基本结构的理解。我们将从第一性原理出发，在刚性转子和谐振子近似下，推导R支谱线位置的表达式。通过亲手计算几条初始谱线的位置，您将能清晰地看到转动量子数和转动常数如何共同决定转振谱带的基本面貌。[@problem_id:2667078]", "problem": "气相中的一个异核双原子分子在刚性转子和谐振子近似有效且离心畸变可忽略的条件下，通过吸收光谱被观测到。该跃迁对应于一个基本振动谱带，其谱带原点（纯振动能项差）为 $\\tilde{\\nu}_{0} = 2143.27\\,\\mathrm{cm^{-1}}$。较低和较高振动态的转动常数分别为 $B'' = 1.9225\\,\\mathrm{cm^{-1}}$ 和 $B' = 1.9000\\,\\mathrm{cm^{-1}}$。\n\n从刚性转子的振动能项值 $G(v)$ 和转动能项值 $F_{v}(J)$ 的定义，以及异核双原子分子振转跃迁的电偶极选择定则出发，推导 R 分支谱线位置 $\\tilde{\\nu}_{R}(J'')$ 关于 $\\tilde{\\nu}_{0}$、$B'$、$B''$ 和 $J''$ 的表达式。然后计算 $R(0)$ 到 $R(3)$ 谱线的位置（以波数为单位）。\n\n将每个最终谱线位置以 $\\mathrm{cm^{-1}}$ 表示，并四舍五入到五位有效数字。", "solution": "该问题要求在刚性转子和谐振子近似下，推导异核双原子分子 R 分支谱线位置的表达式，然后计算特定谱线的位置。我们从基本原理开始。\n\n双原子分子的总振转能量，以波数（$\\mathrm{cm^{-1}}$）为单位的能项值 $\\tilde{T}(v, J)$ 表示，是其振动能项值 $\\tilde{G}(v)$ 和转动能项值 $\\tilde{F}_{v}(J)$ 的和。\n$$ \\tilde{T}(v, J) = \\tilde{G}(v) + \\tilde{F}_{v}(J) $$\n在谐振子近似下，振动能项值由下式给出：\n$$ \\tilde{G}(v) = \\tilde{\\omega}_{e} \\left(v + \\frac{1}{2}\\right) $$\n其中 $\\tilde{\\omega}_{e}$ 是谐振频率，$v$ 是振动量子数（$v=0, 1, 2, \\dots$）。\n在刚性转子近似下，给定振动态 $v$ 的转动能项值为：\n$$ \\tilde{F}_{v}(J) = \\tilde{B}_{v} J(J+1) $$\n其中 $\\tilde{B}_{v}$ 是该振动态的转动常数，$J$ 是转动量子数（$J=0, 1, 2, \\dots$）。题目说明离心畸变可以忽略，因此不需要更多项。\n\n对应于从较低振转态 $(v'', J'')$ 到较高态 $(v', J')$ 跃迁的吸收谱线波数 $\\tilde{\\nu}$ 是它们能项值的差：\n$$ \\tilde{\\nu} = \\tilde{T}(v', J') - \\tilde{T}(v'', J'') = [\\tilde{G}(v') + \\tilde{F}_{v'}(J')] - [\\tilde{G}(v'') + \\tilde{F}_{v''}(J'')] $$\n该表达式可以重新整理，以分离振动和转动的贡献：\n$$ \\tilde{\\nu} = [\\tilde{G}(v') - \\tilde{G}(v'')] + [\\tilde{F}_{v'}(J') - \\tilde{F}_{v''}(J'')] $$\n问题指定了基本振动跃迁，这意味着 $v''=0$ 和 $v'=1$。第一项 $[\\tilde{G}(1) - \\tilde{G}(0)]$ 是纯振动能量差，称为谱带原点 $\\tilde{\\nu}_{0}$。转动能项值取决于相应振动态的转动常数，我们将其表示为较高态（$v'=1$）的 $\\tilde{B}'$ 和较低态（$v''=0$）的 $\\tilde{B}''$。因此，谱线位置的表达式变为：\n$$ \\tilde{\\nu} = \\tilde{\\nu}_{0} + \\tilde{B}' J'(J'+1) - \\tilde{B}'' J''(J''+1) $$\n对于异核双原子分子，伴随振动跃迁的转动跃迁的电偶极选择定则是 $\\Delta J = J' - J'' = \\pm 1$。R 分支对应于 $\\Delta J = +1$ 的跃迁，这意味着 $J' = J'' + 1$。允许的初始转动态为 $J'' = 0, 1, 2, \\dots$。\n\n将 $J' = J'' + 1$ 代入通用方程，得到 R 分支谱线位置 $\\tilde{\\nu}_{R}(J'')$ 的表达式：\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}' (J''+1)((J''+1)+1) - \\tilde{B}'' J''(J''+1) $$\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}' (J''+1)(J''+2) - \\tilde{B}'' J''(J''+1) $$\n这是一个有效的表达式。为了得到关于 $J''$ 的更有序的多项式形式，我们展开各项：\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}'(J''^{2} + 3J'' + 2) - \\tilde{B}''(J''^{2} + J'') $$\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + 2\\tilde{B}' + (3\\tilde{B}' - \\tilde{B}'')J'' + (\\tilde{B}' - \\tilde{B}'')J''^{2} $$\n这就是推导出的 R 分支谱线位置关于 $\\tilde{\\nu}_{0}$、$\\tilde{B}'$、$\\tilde{B}''$ 和 $J''$ 的表达式。\n\n现在，我们使用给定的数据计算 R($0$)、R($1$)、R($2$) 和 R($3$) 谱线的位置：$\\tilde{\\nu}_{0} = 2143.27\\,\\mathrm{cm^{-1}}$、$\\tilde{B}'' = 1.9225\\,\\mathrm{cm^{-1}}$ 和 $\\tilde{B}' = 1.9000\\,\\mathrm{cm^{-1}}$。使用未展开的形式进行计算更为直接。\n\n对于 R($0$) 谱线，初始态为 $J''=0$：\n$$ \\tilde{\\nu}_{R}(0) = \\tilde{\\nu}_{0} + \\tilde{B}'(0+1)(0+2) - \\tilde{B}''(0)(0+1) = \\tilde{\\nu}_{0} + 2\\tilde{B}' $$\n$$ \\tilde{\\nu}_{R}(0) = 2143.27 + 2(1.9000) = 2143.27 + 3.8000 = 2147.07\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字得到 $2147.1\\,\\mathrm{cm^{-1}}$。\n\n对于 R($1$) 谱线，初始态为 $J''=1$：\n$$ \\tilde{\\nu}_{R}(1) = \\tilde{\\nu}_{0} + \\tilde{B}'(1+1)(1+2) - \\tilde{B}''(1)(1+1) = \\tilde{\\nu}_{0} + 6\\tilde{B}' - 2\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(1) = 2143.27 + 6(1.9000) - 2(1.9225) = 2143.27 + 11.4000 - 3.8450 = 2150.825\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字得到 $2150.8\\,\\mathrm{cm^{-1}}$。\n\n对于 R($2$) 谱线，初始态为 $J''=2$：\n$$ \\tilde{\\nu}_{R}(2) = \\tilde{\\nu}_{0} + \\tilde{B}'(2+1)(2+2) - \\tilde{B}''(2)(2+1) = \\tilde{\\nu}_{0} + 12\\tilde{B}' - 6\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(2) = 2143.27 + 12(1.9000) - 6(1.9225) = 2143.27 + 22.8000 - 11.5350 = 2154.535\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字得到 $2154.5\\,\\mathrm{cm^{-1}}$。\n\n对于 R($3$) 谱线，初始态为 $J''=3$：\n$$ \\tilde{\\nu}_{R}(3) = \\tilde{\\nu}_{0} + \\tilde{B}'(3+1)(3+2) - \\tilde{B}''(3)(3+1) = \\tilde{\\nu}_{0} + 20\\tilde{B}' - 12\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(3) = 2143.27 + 20(1.9000) - 12(1.9225) = 2143.27 + 38.0000 - 23.0700 = 2158.200\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字得到 $2158.2\\,\\mathrm{cm^{-1}}$。\n\n计算出的 R($0$)、R($1$)、R($2$) 和 R($3$) 谱线位置，四舍五入到五位有效数字后，分别为 $2147.1\\,\\mathrm{cm^{-1}}$、$2150.8\\,\\mathrm{cm^{-1}}$、$2154.5\\,\\mathrm{cm^{-1}}$ 和 $2158.2\\,\\mathrm{cm^{-1}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2147.1  2150.8  2154.5  2158.2 \\end{pmatrix}}\n$$", "id": "2667078"}, {"introduction": "真实光谱常常因为量子态之间的相互作用而偏离理想模型，这些“反常”现象蕴含着丰富的分子内部动力学信息。本练习将探讨一种常见的光谱微扰——费米共振，其中两个振动态发生“混合”。通过分析原本禁戒或微弱的谱带如何“借取”强度，我们将学习如何定量计算态混合的程度，并预测其对分子转动常数的影响，从而揭示光谱如何成为探索分子内部精细相互作用的有力工具。[@problem_id:2802664]", "problem": "一个非线性三原子分子在泛音态 $|2v_{1}\\rangle$ 和基频态 $|v_{2}\\rangle$ 之间表现出近简并（费米共振）。设透振（零阶）振动基为 $\\{|1\\rangle,|2\\rangle\\}=\\{|2v_{1}\\rangle,|v_{2}\\rangle\\}$，其未微扰能量分别为 $E_{1}^{(0)}$ 和 $E_{2}^{(0)}$，且存在导致该共振的非谐耦合 $\\langle 1| \\hat{H}^{\\prime} |2\\rangle \\neq 0$。一项红外（IR）吸收实验在该区域观测到两个谱带，这两个谱带归属于由 $|1\\rangle$ 和 $|2\\rangle$ 混合形成的两个绝热本征态 $|-\\rangle$ 和 $|+\\rangle$。测得的积分谱带强度（每个都对转动结构进行了完全积分）为 $S_{-} = 1.52 \\times 10^{-20}$ 和 $S_{+} = 4.00 \\times 10^{-20}$，单位是 $\\mathrm{cm \\cdot molecule^{-1}}$。假设从基态 $|0\\rangle$ 到 $|1\\rangle$ 的零阶红外跃迁矩与到 $|2\\rangle$ 的相比可以忽略不计（因此在借用谱带中观测到的强度源于混合），并且 Herman–Wallis 效应可以忽略，从而积分谱带强度与振动跃迁偶极矩矩阵元的平方成正比。\n\n独立的高分辨率光谱学提供了未混合振动态中的有效转动常数：$B(2v_{1}) = 1.8900$ 和 $B(v_{2}) = 1.9050$，单位为 $\\mathrm{cm^{-1}}$。将转动哈密顿量视为混合振动流形内的一种微扰，并忽略混合态基中的非对角转动-振动耦合矩阵元。\n\n仅使用定态微扰理论的第一性原理以及红外谱带强度是跃迁偶极矩矩阵元平方的定义，完成以下任务：（i）根据观测到的强度借用推导出绝热本征态的混合系数（在相差一个总相位因子的情况下），以及（ii）预测混合态的有效转动常数及其相对于未混合值的位移。\n\n最后，报告能量较高的混合态的预测位移 $\\Delta B_{+} \\equiv B_{+} - B(v_{2})$，单位为 $\\mathrm{cm^{-1}}$。将答案四舍五入至四位有效数字。", "solution": "该问题要求分析一个非线性三原子分子的两个振动态 $|1\\rangle \\equiv |2v_{1}\\rangle$ 和 $|2\\rangle \\equiv |v_{2}\\rangle$ 之间的费米共振。这是二能级系统定态微扰理论中的一个标准问题。解题过程将按要求分为两部分：首先，从红外强度确定振动混合；其次，利用这种混合来预测混合态的有效转动常数。\n\n在透振基 $\\{|1\\rangle, |2\\rangle\\}$ 中，振动哈密顿量由下式给出：\n$$\n\\mathbf{H}_{vib} = \\begin{pmatrix} E_{1}^{(0)}  W \\\\ W  E_{2}^{(0)} \\end{pmatrix}\n$$\n其中 $E_{1}^{(0)}$ 和 $E_{2}^{(0)}$ 分别是态 $|1\\rangle$ 和 $|2\\rangle$ 的未微扰能量，而 $W = \\langle 1| \\hat{H}^{\\prime} |2\\rangle$ 是非谐耦合矩阵元。\n\n该哈密顿量的本征态，即观测到的绝热态 $|-\\rangle$ 和 $|+\\rangle$，是透振态的线性组合。我们可以用一个混合角 $\\theta$ 来表示它们，如下所示：\n$$\n|+\\rangle = \\cos\\theta |2\\rangle + \\sin\\theta |1\\rangle\n$$\n$$\n|-\\rangle = -\\sin\\theta |2\\rangle + \\cos\\theta |1\\rangle\n$$\n这种参数化确保了本征态是正交归一的。系数 $\\cos^2\\theta$ 和 $\\sin^2\\theta$ 表示基态在混合本征态中的组分占比。\n\n问题提供了从振动基态 $|0\\rangle$ 到混合态 $|-\\rangle$ 和 $|+\\rangle$ 的跃迁的积分红外（IR）谱带强度 $S_{-}$ 和 $S_{+}$ 的信息。强度 $S$ 与跃迁偶极矩矩阵元的平方成正比，即 $S \\propto |\\langle \\text{final} | \\hat{\\mu} | \\text{initial} \\rangle|^2$，其中 $\\hat{\\mu}$ 是电偶极矩算符。\n\n我们得到了一个关键假设：从基态到泛音态 $|1\\rangle$ 的跃迁是可忽略的，即 $\\langle 1 | \\hat{\\mu} | 0 \\rangle \\approx 0$。这意味着到基频态 $|2\\rangle$ 的跃迁是允许的：$\\mu_2 \\equiv \\langle 2 | \\hat{\\mu} | 0 \\rangle \\neq 0$。这是一个经典的*强度借用*案例，其中“暗态” $|1\\rangle$ 通过与“亮态” $|2\\rangle$ 混合而获得强度。\n\n到混合态的跃迁偶极矩为：\n$$\n\\langle + | \\hat{\\mu} | 0 \\rangle = \\cos\\theta \\langle 2 | \\hat{\\mu} | 0 \\rangle + \\sin\\theta \\langle 1 | \\hat{\\mu} | 0 \\rangle \\approx \\cos\\theta \\cdot \\mu_2\n$$\n$$\n\\langle - | \\hat{\\mu} | 0 \\rangle = -\\sin\\theta \\langle 2 | \\hat{\\mu} | 0 \\rangle + \\cos\\theta \\langle 1 | \\hat{\\mu} | 0 \\rangle \\approx -\\sin\\theta \\cdot \\mu_2\n$$\n相应的强度为：\n$$\nS_{+} \\propto |\\cos\\theta \\cdot \\mu_2|^2 = \\cos^2\\theta |\\mu_2|^2\n$$\n$$\nS_{-} \\propto |-\\sin\\theta \\cdot \\mu_2|^2 = \\sin^2\\theta |\\mu_2|^2\n$$\n该双峰的总强度为 $S_{total} = S_{+} + S_{-} \\propto (\\cos^2\\theta + \\sin^2\\theta)|\\mu_2|^2 = |\\mu_2|^2$。\n\n由此，我们可以直接从强度分数中确定混合系数：\n$$\n\\sin^2\\theta = \\frac{S_{-}}{S_{+} + S_{-}}\n$$\n$$\n\\cos^2\\theta = \\frac{S_{+}}{S_{+} + S_{-}}\n$$\n使用给定的值 $S_{-} = 1.52 \\times 10^{-20} \\ \\mathrm{cm \\cdot molecule^{-1}}$ 和 $S_{+} = 4.00 \\times 10^{-20} \\ \\mathrm{cm \\cdot molecule^{-1}}$：\n$$\nS_{total} = (1.52 + 4.00) \\times 10^{-20} = 5.52 \\times 10^{-20} \\ \\mathrm{cm \\cdot molecule^{-1}}\n$$\n$$\n\\sin^2\\theta = \\frac{1.52 \\times 10^{-20}}{5.52 \\times 10^{-20}} = \\frac{1.52}{5.52}\n$$\n$$\n\\cos^2\\theta = \\frac{4.00 \\times 10^{-20}}{5.52 \\times 10^{-20}} = \\frac{4.00}{5.52}\n$$\n由于 $S_{+} > S_{-}$，我们有 $\\cos^2\\theta > \\sin^2\\theta$。这证实了我们的参数化，即 $|+\\rangle$ 主要由亮态 $|2\\rangle$ 组成，而 $|-\\rangle$ 主要由暗态 $|1\\rangle$ 组成。这完成了问题的第一部分（i）。\n\n对于第二部分（ii），我们预测混合态的有效转动常数。对于给定的振动态 $|\\psi_v\\rangle$，其有效转动常数是转动常数算符 $\\hat{B}$ 的期望值：$B_v = \\langle \\psi_v | \\hat{B} | \\psi_v \\rangle$。问题指示我们将转动哈密顿量视为微扰，并忽略混合态基中的非对角转动-振动耦合。这意味着混合态的有效转动常数是 $\\hat{B}$ 算符在该态中的期望值，并且我们可以假设该算符在透振基 $\\{|1\\rangle, |2\\rangle\\}$ 中是对角的。\n即 $\\langle 1 | \\hat{B} | 1 \\rangle = B(2v_1) \\equiv B_1$ 和 $\\langle 2 | \\hat{B} | 2 \\rangle = B(v_2) \\equiv B_2$，而 $\\langle 1 | \\hat{B} | 2 \\rangle = 0$。\n\n态 $|+\\rangle$ 的有效转动常数为：\n$$\nB_{+} = \\langle + | \\hat{B} | + \\rangle = \\langle \\cos\\theta |2\\rangle + \\sin\\theta |1\\rangle | \\hat{B} | \\cos\\theta |2\\rangle + \\sin\\theta |1\\rangle \\rangle\n$$\n展开此式可得：\n$$\nB_{+} = \\cos^2\\theta \\langle 2 | \\hat{B} | 2 \\rangle + \\sin^2\\theta \\langle 1 | \\hat{B} | 1 \\rangle + 2\\sin\\theta\\cos\\theta \\text{Re}(\\langle 1 | \\hat{B} | 2 \\rangle)\n$$\n在 $\\langle 1 | \\hat{B} | 2 \\rangle = 0$ 的假设下，此式简化为未微扰转动常数的加权平均值：\n$$\nB_{+} = \\cos^2\\theta B_2 + \\sin^2\\theta B_1\n$$\n问题要求计算此常数相对于态 $|2\\rangle$ 的未微扰值的位移，即 $\\Delta B_{+} \\equiv B_{+} - B_2$。\n$$\n\\Delta B_{+} = (\\cos^2\\theta B_2 + \\sin^2\\theta B_1) - B_2\n$$\n使用恒等式 $\\cos^2\\theta = 1 - \\sin^2\\theta$：\n$$\n\\Delta B_{+} = ((1 - \\sin^2\\theta) B_2 + \\sin^2\\theta B_1) - B_2\n$$\n$$\n\\Delta B_{+} = B_2 - \\sin^2\\theta B_2 + \\sin^2\\theta B_1 - B_2\n$$\n$$\n\\Delta B_{+} = \\sin^2\\theta (B_1 - B_2)\n$$\n这个结果表明，态 $|+\\rangle$（主要为 $|2\\rangle$）的转动常数位移与态 $|1\\rangle$ 的混合成分（$\\sin^2\\theta$）以及未微扰转动常数之差成正比。\n\n现在我们代入数值：\n$B_1 = B(2v_{1}) = 1.8900 \\ \\mathrm{cm^{-1}}$\n$B_2 = B(v_{2}) = 1.9050 \\ \\mathrm{cm^{-1}}$\n$\\sin^2\\theta = \\frac{1.52}{5.52}$\n\n$$\n\\Delta B_{+} = \\left(\\frac{1.52}{5.52}\\right) \\times (1.8900 - 1.9050) \\ \\mathrm{cm^{-1}}\n$$\n$$\n\\Delta B_{+} = \\left(\\frac{1.52}{5.52}\\right) \\times (-0.0150) \\ \\mathrm{cm^{-1}}\n$$\n$$\n\\Delta B_{+} \\approx 0.2753623 \\times (-0.0150) \\ \\mathrm{cm^{-1}} \\approx -0.0041304347... \\ \\mathrm{cm^{-1}}\n$$\n按要求将最终答案四舍五入至四位有效数字，得到 $\\Delta B_{+} = -0.004130 \\ \\mathrm{cm^{-1}}$。", "answer": "$$\n\\boxed{-0.004130}\n$$", "id": "2802664"}, {"introduction": "从实验谱图中提取精确的分子常数是光谱学家的核心技能之一。本练习将模拟这一关键过程，带领您连接理论与实际数据分析。我们将首先生成包含离心畸变效应的模拟光谱数据，然后运用多项式拟合这一与组合差分法密切相关的技术，从数据中“反向”提取出上下振动态的转动常数，体验从光谱数据到分子参数的完整分析流程。[@problem_id:2667113]", "problem": "您的任务是构建一个程序，该程序模拟双原子分子的红外(IR)转动-振动R支谱线位置，然后通过将谱线位置拟合为有效转动指数的二次函数来推断高振动态和低振动态的转动常数。您的设计必须且仅必须从以下基础出发：每个振动态的带有一阶离心畸变的刚性转子转动能项值、R支跃迁的选择定则以及谱带原点的定义。具体来说，对于振动态指数为 $v$ 的双原子分子，其转动能项值定义为 $F_v(J) = B_v J(J+1) - D_v \\left[J(J+1)\\right]^2$，单位为反厘米；R支的选择定则为 $\\Delta J = +1$（即 $J' = J'' + 1$）；谱带原点为 $\\tilde{\\nu}_0 = G(v') - G(v'')$，单位为反厘米。您的实现必须使用这些定义来模拟谱线位置，并且不得假定任何不能从这些定义推导出的其他表达式。\n\n对于从 $(v'', J'')$ 到 $(v', J')$ 的跃迁，以反厘米为单位的谱线位置是谱带原点与高低能态转动能项值之差的和。仅使用上述定义，对每个测试用例指定范围内的整数 $J''$，通过将谱带原点与高能态减去低能态的转动能项值相加，并使用 $J' = J'' + 1$，来模拟R支谱线位置。\n\n然后，对于每个模拟的R支，使用模型 $\\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2$ 将谱线位置 $\\tilde{\\nu}_R$ 作为变量 $x \\equiv J'' + 1$ 的函数进行最小二乘二次拟合。从拟合系数中，推导出高能态和低能态的转动常数 $B'$ 和 $B''$，且不使用任何无法从上述基础推导出的公式。以反厘米为单位报告 $B'$ 和 $B''$。同时报告 $B'  B''$ 是否成立。\n\n您的程序必须使用以下物理上合理的参数集测试套件。每个测试用例指定了以反厘米为单位的谱带原点 $\\tilde{\\nu}_0$、以反厘米为单位的高能态转动常数 $B'$、以反厘米为单位的低能态转动常数 $B''$、以反厘米为单位的高能态离心畸变常数 $D'$、以反厘米为单位的低能态离心畸变常数 $D''$，以及 $J''$ 值的包含范围。您必须计算以反厘米为单位的谱线位置，然后进行二次拟合。对于所有报告的 $B$ 值，答案以反厘米为单位表示，并四舍五入到恰好 $6$ 位小数。\n\n测试套件：\n- 情况A（带有轻微离心畸变的理想路径）：$\\tilde{\\nu}_0 = 2143.26$, $B' = 1.92252$, $B'' = 1.93128$, $D' = 6.10\\times 10^{-6}$, $D'' = 6.121\\times 10^{-6}$, $J'' \\in \\{0, 1, \\dots, 15\\}$。\n- 情况B（无离心畸变，曲率显著）：$\\tilde{\\nu}_0 = 3000.00$, $B' = 1.90000$, $B'' = 2.00000$, $D' = 0.0$, $D'' = 0.0$, $J'' \\in \\{0, 1, \\dots, 20\\}$。\n- 情况C（由于 $B' = B''$ 导致的近似线性情况，带有畸变）：$\\tilde{\\nu}_0 = 1800.00$, $B' = 1.50000$, $B'' = 1.50000$, $D' = 5.00\\times 10^{-6}$, $D'' = 5.00\\times 10^{-6}$, $J'' \\in \\{0, 1, \\dots, 25\\}$。\n- 情况D（不相等的畸变常数，较高的 $J''$ 窗口）：$\\tilde{\\nu}_0 = 2500.00$, $B' = 1.68000$, $B'' = 1.70000$, $D' = 6.00\\times 10^{-6}$, $D'' = 4.00\\times 10^{-6}$, $J'' \\in \\{10, 11, \\dots, 30\\}$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是一个形如 $[B'\\_{\\text{fit}}, B''\\_{\\text{fit}}, \\text{is\\_Bprime\\_less\\_than\\_Bdoubleprime}]$ 的子列表。每个子列表的前两个条目是四舍五入到恰好 $6$ 位小数的拟合转动常数（单位为反厘米），最后一个条目是一个布尔值，指示使用未舍入的拟合值时 $B'  B''$ 是否成立。例如，两个情况的输出可能看起来像 $[[1.234000,1.345000,True],[1.500000,1.500000,False]]$。\n\n角度单位不适用。所有物理量都必须以反厘米表示。您的程序的最终输出必须是与指定格式完全匹配的单行文本。不得打印任何其他文本。", "solution": "所提出的问题是计算物理化学中一个明确定义的练习，具体涉及双原子分子转动-振动光谱的分析。它在科学上是合理的，表述正确，并且提供了解决该问题所需的所有参数。因此，它被认为是一个有效的问题。\n\n任务是首先模拟转振光谱R支的谱线位置，然后通过多项式拟合从这些模拟数据中确定转动常数 $B'$ 和 $B''$。这个过程模拟了实验光谱数据分析中常用的一个程序。\n\n首先，我们必须基于所提供的基本原理，建立R支谱线位置 $\\tilde{\\nu}_R(J'')$ 的理论表达式。一个转振能级 $(v, J)$ 的能量由振动能项值 $G(v)$ 和转动能项值 $F_v(J)$ 的和给出。从低能态 $(v'', J'')$ 到高能态 $(v', J')$ 的跃迁波数是它们能项能量的差：\n$$ \\tilde{\\nu} = [G(v') + F_{v'}(J')] - [G(v'') + F_{v''}(J'')] $$\n这可以通过分别收集振动和转动部分来重新排列。振动部分定义了谱带原点 $\\tilde{\\nu}_0 = G(v') - G(v'')$。\n$$ \\tilde{\\nu} = \\tilde{\\nu}_0 + F_{v'}(J') - F_{v''}(J'') $$\n对于给定的振动态 $v$，转动能项值表示为：\n$$ F_v(J) = B_v J(J+1) - D_v \\left[J(J+1)\\right]^2 $$\n其中 $B_v$ 是转动常数，$D_v$ 是一阶离心畸变常数。\n\n对于R支，选择定则是 $\\Delta J = J' - J'' = +1$，这意味着 $J' = J'' + 1$。将此以及能项值的表达式代入跃迁波数的方程，我们得到R支谱线位置作为低能态转动量子数 $J''$ 的函数的表达式：\n$$ \\tilde{\\nu}_R(J'') = \\tilde{\\nu}_0 + \\left( B' (J''+1)(J''+2) - D' \\left[(J''+1)(J''+2)\\right]^2 \\right) - \\left( B'' J''(J''+1) - D'' \\left[J''(J''+1)\\right]^2 \\right) $$\n在这里，单撇号表示高振动态 $v'$（所以 $B' \\equiv B_{v'}$ 和 $D' \\equiv D_{v'}$），双撇号表示低振动态 $v''$（所以 $B'' \\equiv B_{v''}$ 和 $D'' \\equiv D_{v''}$）。这个方程将用于模拟给定 $J''$ 范围内的“实验”谱线位置。\n\n问题的第二部分要求将这些谱线位置拟合为一个关于新变量 $x \\equiv J'' + 1$ 的二次模型。该模型给定为：\n$$ \\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2 $$\n为了将拟合系数 $a_0, a_1$ 和 $a_2$ 与物理常数联系起来，我们必须用 $x$ 来重新表达我们的理论公式 $\\tilde{\\nu}_R$。我们将 $J'' = x-1$ 代入表达式的理想刚性转子部分（暂时忽略畸变项，因为拟合模型只是二次的）：\n$$ \\tilde{\\nu}_R(J'') \\approx \\tilde{\\nu}_0 + B'(J''+1)(J''+2) - B''J''(J''+1) $$\n代入 $x=J''+1$ 得到 $J''+2 = x+1$ 和 $J'' = x-1$：\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + B'x(x+1) - B''(x-1)x $$\n展开并按 $x$ 的幂次合并项：\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + (B'x^2 + B'x) - (B''x^2 - B''x) $$\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + (B' + B'')x + (B' - B'')x^2 $$\n将此表达式与拟合模型 $\\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2$ 进行比较，我们可以确定系数：\n$$ a_0 \\approx \\tilde{\\nu}_0 $$\n$$ a_1 \\approx B' + B'' $$\n$$ a_2 \\approx B' - B'' $$\n这些关系是近似的，因为在推导中忽略了离心畸变项（它们对 $x$ 贡献了三次和四次项），但这些项存在于模拟数据中。最小二乘拟合将找到最佳的二次近似，而高阶项的影响将导致拟合参数与此理想关系略有偏差。然而，问题要求我们使用这些推导出的关系从拟合系数中求出转动常数。\n\n我们现在为 $B'$ 和 $B''$ 建立一个二元一次方程组：\n$$ a_1 = B' + B'' $$\n$$ a_2 = B' - B'' $$\n将这两个方程相加得到 $a_1 + a_2 = 2B'$，从而得出：\n$$ B' = \\frac{a_1 + a_2}{2} $$\n从第一个方程中减去第二个方程得到 $a_1 - a_2 = 2B''$，从而得出：\n$$ B'' = \\frac{a_1 - a_2}{2} $$\n这些是从二次拟合系数推导转动常数所需的公式。布尔条件 $B'  B''$ 可以通过比较从这些公式获得的未舍入的数值来检验。这个比较等价于测试是否 $(a_1+a_2)/2  (a_1-a_2)/2$，化简为 $a_1 + a_2  a_1 - a_2$，即 $2a_2  0$，这当且仅当 $a_2  0$ 时成立。\n\n计算步骤如下：\n1. 对每个测试用例，生成指定范围内的 $J''$ 整数值数组。\n2. 计算相应的 $x$ 值数组，其中 $x = J'' + 1$。\n3. 使用包含离心畸变常数 $D'$ 和 $D''$ 的 $\\tilde{\\nu}_R(J'')$ 的完整表达式，计算模拟的谱线位置。\n4. 使用2次多项式，对谱线位置（y值）与 $x$ 值（x值）进行最小二乘多项式拟合。这将产生系数 $a_2, a_1, a_0$。\n5. 使用推导出的公式计算拟合的转动常数 $B'_{\\text{fit}} = (a_1 + a_2)/2$ 和 $B''_{\\text{fit}} = (a_1 - a_2)/2$。\n6. 确定表达式 $B'_{\\text{fit}}  B''_{\\text{fit}}$ 的布尔值。\n7. 按规定格式化结果：舍入后的 $B'_{\\text{fit}}$、舍入后的 $B''_{\\text{fit}}$ 和布尔标志，并为所有测试用例收集这些结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates R-branch rovibrational line positions for a diatomic molecule,\n    fits them to a quadratic model, and infers the rotational constants.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (nu0, B_prime, B_double_prime, D_prime, D_double_prime, J_range_start, J_range_end)\n    test_cases = [\n        (2143.26, 1.92252, 1.93128, 6.10e-6, 6.121e-6, 0, 15),\n        (3000.00, 1.90000, 2.00000, 0.0, 0.0, 0, 20),\n        (1800.00, 1.50000, 1.50000, 5.00e-6, 5.00e-6, 0, 25),\n        (2500.00, 1.68000, 1.70000, 6.00e-6, 4.00e-6, 10, 30),\n    ]\n\n    results = []\n    for case in test_cases:\n        nu0, Bp, Bpp, Dp, Dpp, J_min, J_max = case\n\n        # 1. Generate J'' and x = J'' + 1 values.\n        # The range is inclusive, so J_max + 1.\n        J_double_prime = np.arange(J_min, J_max + 1)\n        x_var = J_double_prime + 1\n\n        # 2. Simulate R-branch line positions using the full expression.\n        # F_v(J) = B_v * J*(J+1) - D_v * (J*(J+1))^2\n        # nu_R(J'') = nu0 + F_v'(J''+1) - F_v''(J'')\n        \n        # Upper state term value F_v'(J''+1)\n        J_prime = J_double_prime + 1\n        term_val_prime = Bp * J_prime * (J_prime + 1) - Dp * (J_prime * (J_prime + 1))**2\n        \n        # Lower state term value F_v''(J'')\n        term_val_double_prime = Bpp * J_double_prime * (J_double_prime + 1) - Dpp * (J_double_prime * (J_double_prime + 1))**2\n\n        # Line positions nu_R\n        nu_R = nu0 + term_val_prime - term_val_double_prime\n\n        # 3. Perform a least-squares quadratic fit: nu_R = a2*x^2 + a1*x + a0\n        # np.polyfit returns coefficients in order of decreasing power, [a2, a1, a0].\n        coeffs = np.polyfit(x_var, nu_R, 2)\n        a2, a1, a0 = coeffs[0], coeffs[1], coeffs[2]\n\n        # 4. Deduce B' and B'' from the fitted coefficients a1 and a2.\n        # a1 = B' + B''\n        # a2 = B' - B''\n        # Solving for B' and B'':\n        # B' = (a1 + a2) / 2\n        # B'' = (a1 - a2) / 2\n        B_prime_fit = (a1 + a2) / 2\n        B_double_prime_fit = (a1 - a2) / 2\n\n        # 5. Check the condition B'_fit  B''_fit using unrounded values.\n        is_Bprime_less_than_Bdoubleprime = B_prime_fit  B_double_prime_fit\n\n        # 6. Round the fitted B values to 6 decimal places for reporting.\n        B_prime_fit_rounded = round(B_prime_fit, 6)\n        B_double_prime_fit_rounded = round(B_double_prime_fit, 6)\n        \n        # Format as a list for final output\n        results.append([B_prime_fit_rounded, B_double_prime_fit_rounded, is_Bprime_less_than_Bdoubleprime])\n\n    # Final print statement in the exact required format.\n    # The format requires floats to have 6 decimal places, which can be achieved with formatting.\n    # The list comprehension builds the string for each sublist.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f},{str(res[2])}]\" for res in results]\n    print(f\"[{','.join(formatted_results).replace('True', 'True').replace('False', 'False')}]\")\n\nsolve()\n```", "id": "2667113"}]}