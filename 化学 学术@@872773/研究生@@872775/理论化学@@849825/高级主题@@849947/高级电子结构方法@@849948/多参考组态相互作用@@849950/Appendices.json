{"hands_on_practices": [{"introduction": "在深入研究多参考组态相互作用 (MRCI) 的复杂性之前，理解其必要性至关重要。本练习 [@problem_id:2459058] 使用一个简单的双态模型，来演示当电子态能量相近（即准简并）时，像微扰理论这样的标准单参考方法为何会失效。通过分析这个模型，我们可以从根本上理解为何在处理这类问题时，必须从一开始就平等地考虑多个电子组态。", "problem": "在一个多参考组态相互作用（MRCI）的最小模型中，考虑两个组态态函数，记作 $\\lvert A \\rangle$ 和 $\\lvert B \\rangle$，它们张成一个二维的活性空间。投影到这个空间上的非相对论、无自旋的电子哈密顿量由一个 $2 \\times 2$ 的厄米矩阵表示：\n$$\nH \\;=\\; \\begin{pmatrix}\nE_{0}  V \\\\\nV  E_{1}\n\\end{pmatrix},\n$$\n其中 $E_{0}$ 和 $E_{1}$ 是实数，且满足 $E_{1} - E_{0} \\equiv 2 \\Delta > 0$，$V$ 是一个实数的、非零的耦合矩阵元。假设构造一个单参考微扰理论，选择 $\\lvert A \\rangle$ 作为参考态，其未微扰能量为 $E_{0}$，并将非对角耦合项视为微扰。\n\n令 $E_{\\mathrm{g}}$ 表示矩阵 $H$ 的精确基态能量（即较小的那个本征值）。令 $E^{(2)}$ 表示从此单参考划分中得到的、对参考能量 $E_{0}$ 的二阶 Rayleigh–Schrödinger 微扰理论校正。\n\n定义无量纲比率\n$$\nR(x) \\;=\\; \\frac{E_{\\mathrm{g}} - E_{0}}{E^{(2)}}\n$$\n作为无量纲参数 $x \\equiv \\dfrac{V}{\\Delta}$ 的函数。\n\n推导 $R(x)$ 仅用 $x$ 表示的闭式表达式。请以最简精确形式给出你的最终表达式。不需要进行数值计算。", "solution": "题目陈述已经过审阅，确认有效。这是一个适定 (well-posed) 的初等量子力学问题，没有矛盾或歧义。它描述了一个标准的二能级系统，这是物理学和化学中的一个基本模型。所有定义都清晰，所有必要条件都已给出。我们开始推导。\n\n目标是推导无量纲比率 $R(x) = \\frac{E_{\\mathrm{g}} - E_{0}}{E^{(2)}}$ 的表达式，其中 $x = \\frac{V}{\\Delta}$。这需要两个独立的计算：首先，计算系统的精确基态能量 $E_{\\mathrm{g}}$；其次，计算对参考能量 $E_{0}$ 的二阶微扰理论校正 $E^{(2)}$。\n\n首先，我们确定哈密顿矩阵的精确本征值：\n$$\nH = \\begin{pmatrix}\nE_{0}  V \\\\\nV  E_{1}\n\\end{pmatrix}\n$$\n本征值 $E$ 是特征方程 $\\det(H - E I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\begin{vmatrix}\nE_{0} - E  V \\\\\nV  E_{1} - E\n\\end{vmatrix} = (E_{0} - E)(E_{1} - E) - V^{2} = 0\n$$\n这展开为一个关于 $E$ 的二次方程：\n$$\nE^{2} - (E_{0} + E_{1})E + E_{0}E_{1} - V^{2} = 0\n$$\n$E$ 的解由二次公式给出：\n$$\nE = \\frac{(E_{0} + E_{1}) \\pm \\sqrt{(E_{0} + E_{1})^{2} - 4(E_{0}E_{1} - V^{2})}}{2}\n$$\n化简平方根下的项：\n$$\n(E_{0} + E_{1})^{2} - 4E_{0}E_{1} + 4V^{2} = E_{0}^{2} + 2E_{0}E_{1} + E_{1}^{2} - 4E_{0}E_{1} + 4V^{2} = (E_{1} - E_{0})^{2} + 4V^{2}\n$$\n所以，本征值为：\n$$\nE = \\frac{E_{0} + E_{1}}{2} \\pm \\frac{\\sqrt{(E_{1} - E_{0})^{2} + 4V^{2}}}{2}\n$$\n根据给定的定义 $E_{1} - E_{0} = 2\\Delta$ 和 $E_{1} = E_{0} + 2\\Delta$，将它们代入 $E$ 的表达式中：\n$$\nE = \\frac{E_{0} + (E_{0} + 2\\Delta)}{2} \\pm \\frac{\\sqrt{(2\\Delta)^{2} + 4V^{2}}}{2} = \\frac{2E_{0} + 2\\Delta}{2} \\pm \\frac{\\sqrt{4\\Delta^{2} + 4V^{2}}}{2} = E_{0} + \\Delta \\pm \\sqrt{\\Delta^{2} + V^{2}}\n$$\n基态能量 $E_{\\mathrm{g}}$ 是两个本征值中较小的一个，对应于负号。\n$$\nE_{\\mathrm{g}} = E_{0} + \\Delta - \\sqrt{\\Delta^{2} + V^{2}}\n$$\n比率 $R(x)$ 的分子是能量差 $E_{\\mathrm{g}} - E_{0}$：\n$$\nE_{\\mathrm{g}} - E_{0} = \\Delta - \\sqrt{\\Delta^{2} + V^{2}} = \\Delta - \\sqrt{\\Delta^{2} \\left(1 + \\frac{V^{2}}{\\Delta^{2}}\\right)} = \\Delta \\left(1 - \\sqrt{1 + \\left(\\frac{V}{\\Delta}\\right)^{2}}\\right)\n$$\n使用定义 $x = \\frac{V}{\\Delta}$，上式变为：\n$$\nE_{\\mathrm{g}} - E_{0} = \\Delta (1 - \\sqrt{1 + x^{2}})\n$$\n接下来，我们计算二阶 Rayleigh-Schrödinger 微扰理论校正 $E^{(2)}$。参考态是 $\\lvert A \\rangle$，其未微扰能量为 $E_{0}^{(0)} = E_{0}$。未微扰哈密顿量 $H_{0}$ 包含 $H$ 的对角元，微扰 $W$ 包含非对角元。\n$$\nH_{0} = \\begin{pmatrix} E_{0}  0 \\\\ 0  E_{1} \\end{pmatrix}, \\quad W = \\begin{pmatrix} 0  V \\\\ V  0 \\end{pmatrix}\n$$\n对态 $\\lvert n \\rangle$ 的二阶能量校正的通用公式是：\n$$\nE_{n}^{(2)} = \\sum_{k \\neq n} \\frac{|\\langle \\psi_{k}^{(0)} | W | \\psi_{n}^{(0)} \\rangle|^{2}}{E_{n}^{(0)} - E_{k}^{(0)}}\n$$\n在我们的情况中，参考态是 $\\lvert \\psi_{0}^{(0)} \\rangle = \\lvert A \\rangle$，且只有一个其他态 $\\lvert \\psi_{1}^{(0)} \\rangle = \\lvert B \\rangle$。求和只包含一项。\n$$\nE^{(2)} = \\frac{|\\langle B | W | A \\rangle|^{2}}{E_{0} - E_{1}}\n$$\n从矩阵 $W$ 可知，耦合元为 $\\langle B | W | A \\rangle = V$。能量分母为 $E_{0} - E_{1} = -(E_{1} - E_{0}) = -2\\Delta$。\n$$\nE^{(2)} = \\frac{V^{2}}{-2\\Delta}\n$$\n我们用无量纲参数 $x = \\frac{V}{\\Delta}$ 来表示 $E^{(2)}$，这给出 $V = x\\Delta$。\n$$\nE^{(2)} = \\frac{(x\\Delta)^{2}}{-2\\Delta} = -\\frac{x^{2}\\Delta^{2}}{2\\Delta} = -\\frac{x^{2}\\Delta}{2}\n$$\n最后，我们构造比率 $R(x)$：\n$$\nR(x) = \\frac{E_{\\mathrm{g}} - E_{0}}{E^{(2)}} = \\frac{\\Delta (1 - \\sqrt{1 + x^{2}})}{-\\frac{x^{2}\\Delta}{2}}\n$$\n因子 $\\Delta$ 消掉了。\n$$\nR(x) = \\frac{1 - \\sqrt{1 + x^{2}}}{-x^{2}/2} = \\frac{2(1 - \\sqrt{1 + x^{2}})}{-x^{2}} = \\frac{2(\\sqrt{1 + x^{2}} - 1)}{x^{2}}\n$$\n为了得到最简形式并消除在 $x=0$ 处的不定型，我们将分子和分母同乘以共轭表达式 $\\sqrt{1 + x^{2}} + 1$：\n$$\nR(x) = \\frac{2(\\sqrt{1 + x^{2}} - 1)}{x^{2}} \\times \\frac{\\sqrt{1 + x^{2}} + 1}{\\sqrt{1 + x^{2}} + 1} = \\frac{2((1 + x^{2}) - 1)}{x^{2}(\\sqrt{1 + x^{2}} + 1)} = \\frac{2x^{2}}{x^{2}(\\sqrt{1 + x^{2}} + 1)}\n$$\n因为给定 $V \\neq 0$，所以 $x \\neq 0$，我们可以安全地消去分子和分母中的 $x^{2}$ 项。\n$$\nR(x) = \\frac{2}{\\sqrt{1 + x^{2}} + 1}\n$$\n这就是比率 $R(x)$ 的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{1 + x^{2}} + 1}}\n$$", "id": "2459058"}, {"introduction": "明确了需要多个参考组态之后，我们现在转向 MRCI 波函数的构成单元。本练习 [@problem_id:2788958] 将指导您从更基本的斯莱特行列式基组出发，构建出自旋匹配的组态态函数 (CSFs)。掌握这一过程是理解 MRCI 方法如何正确处理电子自旋对称性的关键，这在多组态理论中是一项至关重要的核心技能。", "problem": "在多参考组态相互作用 (Multi-Reference Configuration Interaction, MRCI) 中，通常使用一个由从选定的空间轨道构成的完整活性空间 (Complete Active Space, CAS) 所构建的自旋匹配组态态函数 (Configuration State Functions, CSFs) 基。考虑一个最小的 CAS 活性空间，其中包含 $2$ 个电子和 $2$ 个不同的正交归一空间轨道 $\\{\\phi_{a}, \\phi_{b}\\}$，每个轨道都可以被自旋函数 $\\alpha$ 或 $\\beta$ 占据。反对称化的斯莱特行列式张成了 $N=2$ 的 $N$ 电子行列式空间。定义以下有序的行列式基（每个行列式都被理解为是归一化的，并以固定的正则自旋轨道顺序构建，以确保相位一致）：\n- $D_{1} = \\big|\\phi_{a}\\alpha,\\,\\phi_{a}\\beta\\big|$，\n- $D_{2} = \\big|\\phi_{b}\\alpha,\\,\\phi_{b}\\beta\\big|$，\n- $D_{3} = \\big|\\phi_{a}\\alpha,\\,\\phi_{b}\\alpha\\big|$，\n- $D_{4} = \\big|\\phi_{a}\\beta,\\,\\phi_{b}\\beta\\big|$，\n- $D_{5} = \\big|\\phi_{a}\\alpha,\\,\\phi_{b}\\beta\\big|$，\n- $D_{6} = \\big|\\phi_{a}\\beta,\\,\\phi_{b}\\alpha\\big|$。\n\n从第一性原理出发，利用费米子的反对称性要求、斯莱特行列式的定义以及两个自旋-$\\tfrac{1}{2}$ 角动量的叠加规则（使用 Condon–Shortley 相位约定下的 Clebsch–Gordan 系数）来：\n- 构造由此 CAS 产生的总自旋 $S=0$（单重态）和 $S=1$（三重态）的归一化自旋匹配组态态函数 (CSF)，并\n- 确定它们在行列式基 $\\{D_{1},\\dots,D_{6}\\}$ 上的展开式。\n\n最后，在上面指定的行列式顺序 $\\{D_{1},D_{2},D_{3},D_{4},D_{5},D_{6}\\}$ 下，给出每个空间轨道中有一个电子的归一化 $S=0$ CSF（即，由 $\\phi_{a}^{1}\\phi_{b}^{1}$ 占据构成的单重态）的系数行向量。将你的最终答案表示为一个包含精确符号条目的 $1\\times 6$ 行向量。无需四舍五入，且不涉及单位。[@problem_id:543]", "solution": "首先，将对所述问题进行严格的验证过程。\n\n步骤 1：提取已知条件。\n已知条件如下：\n- 一个包含 $N=2$ 个电子的体系。\n- 一个由 $2$ 个不同的正交归一空间轨道 $\\{\\phi_{a}, \\phi_{b}\\}$ 组成的活性空间。\n- 一个由 $6$ 个反对称化、归一化的斯莱特行列式构成的基：\n  - $D_{1} = \\big|\\phi_{a}\\alpha,\\,\\phi_{a}\\beta\\big|$\n  - $D_{2} = \\big|\\phi_{b}\\alpha,\\,\\phi_{b}\\beta\\big|$\n  - $D_{3} = \\big|\\phi_{a}\\alpha,\\,\\phi_{b}\\alpha\\big|$\n  - $D_{4} = \\big|\\phi_{a}\\beta,\\,\\phi_{b}\\beta\\big|$\n  - $D_{5} = \\big|\\phi_{a}\\alpha,\\,\\phi_{b}\\beta\\big|$\n  - $D_{6} = \\big|\\phi_{a}\\beta,\\,\\phi_{b}\\alpha\\big|$\n- 要求使用第一性原理，包括泡利不相容原理（反对称性）、斯莱特行列式的定义以及两个自旋-$\\frac{1}{2}$ 粒子角动量的叠加规则，来构造总自旋 $S=0$（单重态）和 $S=1$（三重态）的自旋匹配组态态函数 (CSF)。\n- 最终任务是在有序行列式基 $\\{D_{1},\\dots,D_{6}\\}$ 中，给出对应于 $\\phi_{a}^{1}\\phi_{b}^{1}$ 组态的归一化 $S=0$ CSF 的系数行向量。\n\n步骤 2：使用提取的已知条件进行验证。\n- **科学基础：** 该问题是量子化学中的一个标准练习，涉及从 CAS(2,2) 体系的行列式基构造自旋匹配波函数 (CSF)。这是诸如 MRCI 等多组态方法中的一个基本概念。它在科学上和事实上都是合理的。\n- **适定的：** 该问题为 CAS(2,2) 空间提供了一个完整的行列式基组，并要求在此空间内构造自旋算符的本征函数。目标明确，所有必要信息均已给出。存在唯一的解，最多相差一个可由标准约定固定的任意总体相位因子。\n- **客观性：** 语言正式、精确且完全客观。它提出了一个理论化学中的标准问题。\n\n步骤 3：结论与行动。\n该问题是有效的。它科学合理、适定、客观，且没有明显缺陷。我将继续进行完整解答。\n\n组态态函数 (CSF) 是斯莱特行列式的线性组合，它同时是总自旋平方算符 $\\hat{S}^2$ 和总自旋算符在 z 轴上投影 $\\hat{S}_z$ 的本征函数。其本征值分别为 $S(S+1)\\hbar^2$ 和 $M_S\\hbar$。在原子单位制中，$\\hbar=1$。\n\n首先，我们根据给定的行列式 $\\{D_i\\}$ 的 $M_S$ 本征值对其进行分类。算符 $\\hat{S}_z = \\sum_{i=1}^{N} \\hat{s}_{zi}$ 对行列式内的自旋轨道的作用是可加的。本征值 $M_S$ 是通过对单个电子的 $m_s$ 值求和得到的，其中 $m_s(\\alpha) = +\\frac{1}{2}$，$m_s(\\beta) = -\\frac{1}{2}$。\n\n- $D_{1} = |\\phi_{a}\\alpha, \\phi_{a}\\beta|$: $M_S = \\frac{1}{2} - \\frac{1}{2} = 0$。\n- $D_{2} = |\\phi_{b}\\alpha, \\phi_{b}\\beta|$: $M_S = \\frac{1}{2} - \\frac{1}{2} = 0$。\n- $D_{3} = |\\phi_{a}\\alpha, \\phi_{b}\\alpha|$: $M_S = \\frac{1}{2} + \\frac{1}{2} = 1$。\n- $D_{4} = |\\phi_{a}\\beta, \\phi_{b}\\beta|$: $M_S = -\\frac{1}{2} - \\frac{1}{2} = -1$。\n- $D_{5} = |\\phi_{a}\\alpha, \\phi_{b}\\beta|$: $M_S = \\frac{1}{2} - \\frac{1}{2} = 0$。\n- $D_{6} = |\\phi_{a}\\beta, \\phi_{b}\\alpha|$: $M_S = -\\frac{1}{2} + \\frac{1}{2} = 0$。\n\n行列式 $D_3$ 和 $D_4$ 是唯一 $M_S \\neq 0$ 的行列式。对于给定数量的电子，任何具有最大或最小可能 $M_S$ 值的行列式本身就已经是纯自旋本征函数。\n对于 $D_3$， $M_S = 1$。这必须对应于三重态 ($S=1, M_S=1$) 的高自旋分量。\n因此，一个 CSF 是：\n$^3\\Psi_{M_S=1} = D_3$。\n对其应用 $\\hat{S}^2$ 算符，得到本征值 $S(S+1) = 1(1+1) = 2$。\n\n对于 $D_4$，$M_S = -1$。这必须是同一三重态 ($S=1, M_S=-1$) 的低自旋分量。\n因此，另一个 CSF 是：\n$^3\\Psi_{M_S=-1} = D_4$。\n其 $\\hat{S}^2$ 本征值也为 2。\n\n剩下的行列式 $\\{D_1, D_2, D_5, D_6\\}$ 张成 $M_S=0$ 的子空间。这个子空间包含一个三重态分量 ($S=1, M_S=0$) 和三个单重态分量 ($S=0, M_S=0$)。\n为了构造 $M_S=0$ 的三重态分量，我们将自旋下降算符 $\\hat{S}_{-} = \\sum_{i=1}^{N} \\hat{s}_{i-}$ 应用于 $M_S=1$ 的态 $D_3$。\n$\\hat{S}_{-}$ 对一个行列式的作用是其对每个组分自旋轨道作用的总和：$\\hat{S}_{-}|\\chi_1, \\dots, \\chi_k, \\dots| = \\sum_k |\\chi_1, \\dots, \\hat{s}_{-}\\chi_k, \\dots|$。我们有 $\\hat{s}_{-}\\alpha = \\beta$ 和 $\\hat{s}_{-}\\beta = 0$。\n$$ \\hat{S}_{-} D_{3} = \\hat{S}_{-} |\\phi_{a}\\alpha, \\phi_{b}\\alpha| = |\\hat{s}_{-}(\\phi_{a}\\alpha), \\phi_{b}\\alpha| + |\\phi_{a}\\alpha, \\hat{s}_{-}(\\phi_{b}\\alpha)| = |\\phi_{a}\\beta, \\phi_{b}\\alpha| + |\\phi_{a}\\alpha, \\phi_{b}\\beta| $$\n这恰好是 $D_6 + D_5$。\n得到的态与 $M_S=0$ 的三重态分量成正比：$\\hat{S}_{-}|S, M_S\\rangle = \\sqrt{S(S+1) - M_S(M_S-1)}|S, M_S-1\\rangle$。\n在我们的情况下，$\\hat{S}_{-}|1, 1\\rangle = \\sqrt{1(2) - 1(0)}|1, 0\\rangle = \\sqrt{2}|1, 0\\rangle$。\n所以， $|1, 0\\rangle = \\frac{1}{\\sqrt{2}}\\hat{S}_{-}|1, 1\\rangle$。归一化的 CSF 为：\n$^3\\Psi_{M_S=0} = \\frac{1}{\\sqrt{2}}(D_5 + D_6)$。\n行列式 $D_5$ 和 $D_6$ 是正交的，因为它们相差两个自旋轨道。归一化是正确的：$\\langle \\frac{1}{\\sqrt{2}}(D_5+D_6) | \\frac{1}{\\sqrt{2}}(D_5+D_6) \\rangle = \\frac{1}{2}(\\langle D_5|D_5\\rangle + \\langle D_6|D_6\\rangle) = \\frac{1}{2}(1+1)=1$。\n\n现在，我们构造单重态 CSF ($S=0, M_S=0$)。\n考虑行列式 $D_1$ 和 $D_2$。它们分别对应于双占据空间轨道 $\\phi_a^2$ 和 $\\phi_b^2$ 的组态。\n对于形式为 $|\\phi_i\\alpha, \\phi_i\\beta|$ 的行列式，波函数的空间部分是对称的，$\\phi_i(1)\\phi_i(2)$，而自旋部分是内在地反对称的，$\\frac{1}{\\sqrt{2}}(\\alpha(1)\\beta(2)-\\beta(1)\\alpha(2))$，以满足泡利原理。这个自旋部分是两个电子的单重态自旋函数。因此，任何描述双占据轨道的行列式都是纯单重态。\n所以，我们的两个单重态 CSF 是：\n$^1\\Psi_1 = D_1 = |\\phi_a\\alpha, \\phi_a\\beta|$\n$^1\\Psi_2 = D_2 = |\\phi_b\\alpha, \\phi_b\\beta|$\n\n最后一个 CSF 必须是位于 $\\{D_5, D_6\\}$ 所张成子空间中的单重态，并且必须与同样位于此子空间中的三重态函数 $\\frac{1}{\\sqrt{2}}(D_5 + D_6)$ 正交。设该单重态为 $\\Psi_S = c_5 D_5 + c_6 D_6$。\n正交条件是：\n$$ \\langle \\Psi_S | ^3\\Psi_{M_S=0} \\rangle = \\langle c_5 D_5 + c_6 D_6 | \\frac{1}{\\sqrt{2}}(D_5 + D_6) \\rangle = \\frac{1}{\\sqrt{2}}(c_5 \\langle D_5|D_5\\rangle + c_6 \\langle D_6|D_6\\rangle) = \\frac{1}{\\sqrt{2}}(c_5 + c_6) = 0 $$\n这意味着 $c_6 = -c_5$。该单重态具有 $c_5(D_5 - D_6)$ 的形式。\n归一化要求 $\\langle c_5(D_5 - D_6) | c_5(D_5 - D_6) \\rangle = |c_5|^2(\\langle D_5|D_5\\rangle + \\langle D_6|D_6\\rangle) = 2|c_5|^2 = 1$。\n因此， $|c_5| = \\frac{1}{\\sqrt{2}}$。选择标准相位约定，即 $|\\dots\\alpha\\beta\\rangle$ 行列式的系数为正，我们取 $c_5 = +\\frac{1}{\\sqrt{2}}$。\n这给出了第三个单重态 CSF，对应于单占据组态 $\\phi_a^1 \\phi_b^1$：\n$^1\\Psi_3 = \\frac{1}{\\sqrt{2}}(D_5 - D_6)$。\n\n这个 CSF 在物理上代表一个共价单重键，由一个对称的空间组合 $\\frac{1}{\\sqrt{2}}(\\phi_a(1)\\phi_b(2)+\\phi_b(1)\\phi_a(2))$ 和反对称的单重态自旋函数构成。\n\n问题要求这个特定的 CSF，$^1\\Psi_3$，在有序基 $\\{D_{1},D_{2},D_{3},D_{4},D_{5},D_{6}\\}$ 中的系数行向量。\n其展开式为：\n$^1\\Psi_3 = (0)D_1 + (0)D_2 + (0)D_3 + (0)D_4 + (\\frac{1}{\\sqrt{2}})D_5 + (-\\frac{1}{\\sqrt{2}})D_6$。\n因此，系数行向量为 $\\begin{pmatrix} 0  0  0  0  \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0  0  \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}}\n$$", "id": "2788958"}, {"introduction": "尽管功能强大，但像 MR-CISD 这样的截断组态相互作用方法存在一个众所周知的缺陷：它们不具备尺寸一致性。这意味着，对于两个不相互作用的体系，用该方法计算的总能量并不等于它们各自能量之和。本练习 [@problem_id:2788967] 提供了一种动手实践的方法，来量化分子解离过程中的这种尺寸一致性误差，并展示了如戴维森 (+Q) 和波普 (+P) 等常见经验校正如何有效地减小该误差。", "problem": "您的任务是设计并实现一个完全自洽的数值解离测试，用于量化多参考组态相互作用（含单激发和双激发）（MR-CISD）及其两种常见的旨在修正此误差的经验性变体——Davidson 尺寸广延性修正（常记为 MRCI+Q）和 Pople 尺寸广延性修正（常记为 MRCI+P）——的尺寸一致性（尺寸广延性）误差。目标是对于大间距下无相互作用的碎片，形式化、计算并报告其能量与精确加和性的偏差。\n\n使用的基础原理：在非相对论量子力学中，对于两个哈密顿算符分别为 $H_A$ 和 $H_B$ 的无相互作用的子系统，当间距 $R$ 足够大时，总哈密顿算符为 $H_{AB} = H_A \\otimes I_B + I_A \\otimes H_B$，且精确基态是可分解的。因此，精确能量是可加的：$E_{\\text{exact}}(AB; R \\to \\infty) = E_{\\text{exact}}(A) + E_{\\text{exact}}(B)$。任何近似的电子结构方法，如果在无相互作用的极限下保持了这种可加性，则该方法是尺寸一致的。多参考组态相互作用（含单激发和双激发）（MR-CISD）不是严格尺寸一致的，各种经验性修正（例如 Davidson 和 Pople 修正）旨在减小由此产生的误差。\n\n您的任务：以以上能量可加性原理为唯一出发点，推导一个可计算的尺寸一致性误差的度量，该度量用于评估每种方法在大间距下计算出的二聚体能量与计算出的单体能量之和之间的偏差。实现一个程序，为下面描述的一个小型测试套件中的每种方法计算此误差。程序没有用户输入；所有数字都是硬编码的参数。所有能量均以原子单位（Hartree）给出，您最终的数值答案必须以 Hartree 表示，并四舍五入到六位小数。\n\n测试套件（能量单位为 Hartree）。对于每个测试用例，您将获得三种方法的数据：MR-CISD、MRCI+Q（Davidson 修正）和 MRCI+P（Pople 修正）。对于每种方法，您都会得到单体能量 $E_A$、$E_B$ 和大间距下的二聚体能量 $E_{AB}$。\n\n- 测试用例 1（对称碎片，典型的多参考效应）：\n  - MR-CISD: $E_A = -75.120000$, $E_B = -75.120000$, $E_{AB} = -150.235500$。\n  - MRCI+Q: $E_A = -75.125500$, $E_B = -75.125500$, $E_{AB} = -150.250400$。\n  - MRCI+P: $E_A = -75.126200$, $E_B = -75.126200$, $E_{AB} = -150.252500$。\n- 测试用例 2（非对称碎片，更强的多参考特性）：\n  - MR-CISD: $E_A = -100.200000$, $E_B = -20.050000$, $E_{AB} = -120.240000$。\n  - MRCI+Q: $E_A = -100.205000$, $E_B = -20.052000$, $E_{AB} = -120.256300$。\n  - MRCI+P: $E_A = -100.206000$, $E_B = -20.052500$, $E_{AB} = -120.259300$。\n- 测试用例 3（边缘情况，其中一个单体具有可忽略的相关能）：\n  - MR-CISD: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.599700$。\n  - MRCI+Q: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.600000$。\n  - MRCI+P: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.600100$。\n\n要求：\n- 从第一性原理出发，用 $E_A$、$E_B$ 和 $R \\to \\infty$ 时的 $E_{AB}$ 来形式化定义一种方法的尺寸一致性误差度量，并实现该计算。\n- 为每个测试用例计算所有三种方法的尺寸一致性误差，并报告结果。\n- 所有报告的数字必须以 Hartree 为单位，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个子列表，其中包含三个浮点数，按 MR-CISD、MRCI+Q、MRCI+P 的固定顺序对应于这三种方法。\n- 具体来说，输出必须看起来像一个没有空格的嵌套列表，例如：“[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33]]”，其中每个 $x_{ij}$ 是一个以 Hartree 表示并四舍五入到六位小数的浮点数。", "solution": "对问题陈述进行验证。提取所有给定信息，包括无相互作用体系能量可加性的基本原理、各种方法（MR-CISD、MRCI+Q、MRCI+P）的定义，以及三个测试用例的数值能量数据。\n\n该问题被确定为有效。它在科学上基于量子化学原理，特别是关于电子结构方法的尺寸一致性。该问题提法恰当，提供了计算一个唯一且有意义的量——尺寸一致性误差——所需的所有数据（$E_A$、$E_B$、$E_{AB}$）。语言客观，参数在物理上是合理的。不存在矛盾、歧义或逻辑缺陷。我们可以着手求解。\n\n基本原理指出，对于两个无相互作用的量子体系 $A$ 和 $B$，组合体系 $AB$ 的总能量是各自能量之和。对于精确方法，此可加性成立：$E_{\\text{exact}}(AB; R \\to \\infty) = E_{\\text{exact}}(A) + E_{\\text{exact}}(B)$。如果一个近似方法使用该方法计算的能量满足同样的关系式 $E_{\\text{method}}(AB) = E_{\\text{method}}(A) + E_{\\text{method}}(B)$，则该方法被定义为尺寸一致的。\n\n尺寸一致性误差，我们将其记为 $\\Delta E_{\\text{SC}}$，是一种方法未能遵守此原理的定量度量。它被形式化为计算出的二聚体能量与计算出的单体能量之和的偏差。对于给定的方法 $M$，误差为：\n$$\n\\Delta E_{\\text{SC}}^{M} = E_{M}(AB) - \\left( E_{M}(A) + E_{M}(B) \\right)\n$$\n$\\Delta E_{\\text{SC}}^{M} = 0$ 的值表示方法 $M$ 具有完美的尺寸一致性。我们现在将此公式应用于所提供的测试套件。所有能量均以原子单位（Hartree）给出。计算出的误差将以相同单位报告，并按要求四舍五入到六位小数。\n\n**测试用例 1**\n对于此用例，我们有：\n- MR-CISD: $E_A = -75.120000$, $E_B = -75.120000$, $E_{AB} = -150.235500$。\n- MRCI+Q: $E_A = -75.125500$, $E_B = -75.125500$, $E_{AB} = -150.250400$。\n- MRCI+P: $E_A = -75.126200$, $E_B = -75.126200$, $E_{AB} = -150.252500$。\n\n尺寸一致性误差计算如下：\n- $\\Delta E_{\\text{SC}}^{\\text{MR-CISD}} = -150.235500 - (-75.120000 + -75.120000) = -150.235500 - (-150.240000) = 0.004500$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+Q}} = -150.250400 - (-75.125500 + -75.125500) = -150.250400 - (-150.251000) = 0.000600$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+P}} = -150.252500 - (-75.126200 + -75.126200) = -150.252500 - (-150.252400) = -0.000100$。\n\n**测试用例 2**\n对于此用例，我们有：\n- MR-CISD: $E_A = -100.200000$, $E_B = -20.050000$, $E_{AB} = -120.240000$。\n- MRCI+Q: $E_A = -100.205000$, $E_B = -20.052000$, $E_{AB} = -120.256300$。\n- MRCI+P: $E_A = -100.206000$, $E_B = -20.052500$, $E_{AB} = -120.259300$。\n\n尺寸一致性误差为：\n- $\\Delta E_{\\text{SC}}^{\\text{MR-CISD}} = -120.240000 - (-100.200000 + -20.050000) = -120.240000 - (-120.250000) = 0.010000$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+Q}} = -120.256300 - (-100.205000 + -20.052000) = -120.256300 - (-120.257000) = 0.000700$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+P}} = -120.259300 - (-100.206000 + -20.052500) = -120.259300 - (-120.258500) = -0.000800$。\n\n**测试用例 3**\n对于此用例，我们有：\n- MR-CISD: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.599700$。\n- MRCI+Q: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.600000$。\n- MRCI+P: $E_A = -1.100000$, $E_B = -0.500000$, $E_{AB} = -1.600100$。\n\n尺寸一致性误差为：\n- $\\Delta E_{\\text{SC}}^{\\text{MR-CISD}} = -1.599700 - (-1.100000 + -0.500000) = -1.599700 - (-1.600000) = 0.000300$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+Q}} = -1.600000 - (-1.100000 + -0.500000) = -1.600000 - (-1.600000) = 0.000000$。\n- $\\Delta E_{\\text{SC}}^{\\text{MRCI+P}} = -1.600100 - (-1.100000 + -0.500000) = -1.600100 - (-1.600000) = -0.000100$。\n\n这些计算展示了已知的行为：未经修正的 MR-CISD 表现出正的尺寸一致性误差。Davidson (+Q) 修正显著减小了此误差，使其更接近于零。Pople (+P) 修正有时会过度修正，导致一个小的负误差。在第三个用例中，Davidson 修正实现了完美的尺寸一致性。程序实现将把这个过程代码化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used.\n\ndef solve():\n    \"\"\"\n    Computes the size-consistency error for MR-CISD, MRCI+Q, and MRCI+P\n    for a fixed set of test cases.\n    \"\"\"\n\n    # Test suite data is structured as a list of cases. Each case is a list\n    # of dictionaries, where each dictionary holds the energies for one method.\n    # Energies are in atomic units (Hartree).\n    test_cases = [\n        # Test case 1: Symmetric fragments\n        [\n            {'method': 'MR-CISD', 'E_A': -75.120000, 'E_B': -75.120000, 'E_AB': -150.235500},\n            {'method': 'MRCI+Q',  'E_A': -75.125500, 'E_B': -75.125500, 'E_AB': -150.250400},\n            {'method': 'MRCI+P',  'E_A': -75.126200, 'E_B': -75.126200, 'E_AB': -150.252500},\n        ],\n        # Test case 2: Asymmetric fragments\n        [\n            {'method': 'MR-CISD', 'E_A': -100.200000, 'E_B': -20.050000, 'E_AB': -120.240000},\n            {'method': 'MRCI+Q',  'E_A': -100.205000, 'E_B': -20.052000, 'E_AB': -120.256300},\n            {'method': 'MRCI+P',  'E_A': -100.206000, 'E_B': -20.052500, 'E_AB': -120.259300},\n        ],\n        # Test case 3: Edge case with negligible correlation\n        [\n            {'method': 'MR-CISD', 'E_A': -1.100000, 'E_B': -0.500000, 'E_AB': -1.599700},\n            {'method': 'MRCI+Q',  'E_A': -1.100000, 'E_B': -0.500000, 'E_AB': -1.600000},\n            {'method': 'MRCI+P',  'E_A': -1.100000, 'E_B': -0.500000, 'E_AB': -1.600100},\n        ],\n    ]\n\n    all_results = []\n    for case in test_cases:\n        case_results = []\n        for method_data in case:\n            e_a = method_data['E_A']\n            e_b = method_data['E_B']\n            e_ab = method_data['E_AB']\n\n            # The size-consistency error is defined as the deviation from additivity:\n            # error = E_dimer - (E_monomer_A + E_monomer_B)\n            size_consistency_error = e_ab - (e_a + e_b)\n\n            # The result is formatted to a string with 6 decimal places.\n            formatted_error = f\"{size_consistency_error:.6f}\"\n            case_results.append(formatted_error)\n        \n        # Collect the results for each case as a formatted sub-list string.\n        all_results.append(f\"[{','.join(case_results)}]\")\n\n    # Join the sub-lists to form the final nested list string, ensuring no spaces.\n    final_output_string = f\"[[{','.join(all_results)}]]\"\n    \n    # Correction for the final output string format\n    final_output_string = final_output_string.replace(\"],[[\", \"],[\")\n    final_output_string = final_output_string.replace(\"[[\", \"[\")\n    final_output_string = final_output_string.replace(\"]]\", \"]\")\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2788967"}]}