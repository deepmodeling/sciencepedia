{"hands_on_practices": [{"introduction": "在深入研究复杂的蒙特卡洛模拟之前，通过一个“纸笔练习”来掌握基本的变分原理是至关重要的。这个问题利用氢原子这个可以精确求解的案例，来帮助我们建立对试探波函数、局域能量以及变分能量最小化等变分蒙特卡洛（VMC）核心概念的直观理解。通过解析推导，我们可以验证这一基本原理的有效性，并为更复杂的数值计算打下坚实的基础。[@problem_id:2828337]", "problem": "在用于电子结构计算的变分蒙特卡罗 (VMC) 和扩散蒙特卡罗 (DMC) 方法中，对于一个试探波函数 $\\Psi_{T}(\\mathbf{R})$，局域能量定义为 $E_{L}(\\mathbf{R}) \\equiv \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$，其中 $\\hat{H}$ 是体系的哈密顿量。考虑一个在 Hartree 原子单位下的单电子类氢问题，其中 $\\hbar = m_{e} = e = 1$ 且 $4\\pi\\varepsilon_{0} = 1$。氢原子的非相对论哈密顿量为 $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$，其中 $r = |\\mathbf{r}|$。\n\n设各向同性的试探波函数为 $\\Psi_{T}(r) = \\exp(-\\alpha r)$，其中 $\\alpha > 0$ 是一个实数参数。仅使用基本定义，完成以下任务：\n\n1) 推导局域能量 $E_{L}(r)$。\n\n2) 使用变分能量的定义 $E_{V}(\\alpha) = \\dfrac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}}$，精确计算 $E_{V}(\\alpha)$ 作为 $\\alpha$ 的函数。\n\n3) 对 $\\alpha$ 最小化 $E_{V}(\\alpha)$，以获得最优参数 $\\alpha^{\\star}$。\n\n在球坐标系下进行计算，并从第一性原理出发展示所有步骤，包括拉普拉斯算符作用于球对称函数的过程。你可以解析地计算所有需要的积分。将最终答案表示为 $\\alpha^{\\star}$ 的精确值，单位为 $\\text{bohr}^{-1}$。最终答案只需提供 $\\alpha^{\\star}$；不要在最终的方框内包含局域能量或最小化后的能量。无需四舍五入。", "solution": "该问题陈述具有科学依据，内容自洽，且定量严谨。它展示了量子力学中的一个标准练习，具体而言，是将变分原理应用于氢原子。该问题是有效的，并将按所述方式进行求解。\n\n任务是为给定的氢原子试探波函数 $\\Psi_{T}(r) = \\exp(-\\alpha r)$ 找到最优参数 $\\alpha^{\\star}$，其哈密顿量在 Hartree 原子单位下为 $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$。这将通过以下三个连续的步骤完成：首先，推导局域能量 $E_{L}(r)$；其次，计算变分能量 $E_{V}(\\alpha)$；第三，对 $\\alpha$ 最小化 $E_{V}(\\alpha)$。\n\n步骤 1：推导局域能量 $E_{L}(r)$\n\n局域能量定义为 $E_{L}(\\mathbf{R}) = \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$。由于试探波函数 $\\Psi_{T}(r)$ 是球对称的，局域能量也只依赖于径向坐标 $r$。我们必须将哈密顿量 $\\hat{H}$ 作用于 $\\Psi_{T}(r)$。\n\n势能算符的作用是平凡的：\n$$\n-\\frac{1}{r} \\Psi_{T}(r) = -\\frac{1}{r} \\exp(-\\alpha r)\n$$\n\n动能算符 $-\\dfrac{1}{2}\\nabla^{2}$ 的作用需要计算 $\\Psi_{T}(r)$ 的拉普拉斯算符。在球坐标系 $(r, \\theta, \\phi)$ 中，拉普拉斯算符为：\n$$\n\\nabla^{2} = \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r} \\left( r^{2} \\frac{\\partial}{\\partial r} \\right) + \\frac{1}{r^{2}\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial}{\\partial \\theta} \\right) + \\frac{1}{r^{2}\\sin^{2}\\theta} \\frac{\\partial^{2}}{\\partial \\phi^{2}}\n$$\n由于 $\\Psi_{T}(r)$ 只依赖于 $r$，所以关于 $\\theta$ 和 $\\phi$ 的导数为零。拉普拉斯算符简化为其径向部分：\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}(r)}{dr} \\right)\n$$\n首先，我们计算 $\\Psi_{T}(r)$ 对 $r$ 的导数：\n$$\n\\frac{d\\Psi_{T}}{dr} = \\frac{d}{dr}\\exp(-\\alpha r) = -\\alpha \\exp(-\\alpha r)\n$$\n接下来，我们乘以 $r^2$ 并再次求导：\n$$\n\\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}}{dr} \\right) = \\frac{d}{dr} \\left( -r^{2}\\alpha \\exp(-\\alpha r) \\right) = - \\alpha \\left( 2r\\exp(-\\alpha r) - \\alpha r^{2}\\exp(-\\alpha r) \\right)\n$$\n最后，我们除以 $r^2$：\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^2} \\left[ -2\\alpha r \\exp(-\\alpha r) + \\alpha^{2} r^{2} \\exp(-\\alpha r) \\right] = \\left( -\\frac{2\\alpha}{r} + \\alpha^{2} \\right) \\exp(-\\alpha r)\n$$\n因此，动能算符的作用是：\n$$\n-\\frac{1}{2}\\nabla^{2}\\Psi_{T}(r) = -\\frac{1}{2} \\left( \\alpha^{2} - \\frac{2\\alpha}{r} \\right) \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r)\n$$\n现在，我们将动能项和势能项结合起来求 $\\hat{H}\\Psi_{T}(r)$：\n$$\n\\hat{H}\\Psi_{T}(r) = \\left( -\\frac{1}{2}\\nabla^{2} - \\frac{1}{r} \\right) \\Psi_{T}(r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r) - \\frac{1}{r} \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)\n$$\n局域能量 $E_{L}(r)$ 是通过将 $\\hat{H}\\Psi_{T}(r)$ 除以 $\\Psi_{T}(r)$ 得到的：\n$$\nE_{L}(r) = \\frac{\\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)}{\\exp(-\\alpha r)} = -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r}\n$$\n\n步骤 2：计算变分能量 $E_{V}(\\alpha)$\n\n变分能量是局域能量在概率分布 $|\\Psi_{T}|^{2}$ 上的期望值：\n$$\nE_{V}(\\alpha) = \\frac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}} = \\langle E_{L}(r) \\rangle\n$$\n由于 $\\Psi_{T}(r)$ 是实数，$|\\Psi_{T}(r)|^{2} = \\Psi_{T}(r)^{2} = \\exp(-2\\alpha r)$。我们可以写出：\n$$\nE_{V}(\\alpha) = \\left\\langle -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right\\rangle = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1) \\left\\langle \\frac{1}{r} \\right\\rangle\n$$\n期望值 $\\langle \\frac{1}{r} \\rangle$ 由下式给出：\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}\n$$\n我们分别计算分子和分母的积分。球坐标系下的体积元是 $d^{3}\\mathbf{r} = r^{2}\\sin\\theta\\, dr\\, d\\theta\\, d\\phi$。对角度变量 $(\\theta, \\phi)$ 的积分得到一个因子 $4\\pi$。\n\n分母积分为：\n$$\n\\int_{\\mathbb{R}^{3}} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\exp(-2\\alpha r) r^{2}\\, dr\n$$\n这是一个标准积分，形式为 $\\int_{0}^{\\infty} x^{n} \\exp(-ax)\\, dx = \\frac{n!}{a^{n+1}}$。这里，$n=2$ 且 $a=2\\alpha$。\n$$\n\\int_{0}^{\\infty} r^{2} \\exp(-2\\alpha r)\\, dr = \\frac{2!}{(2\\alpha)^{3}} = \\frac{2}{8\\alpha^{3}} = \\frac{1}{4\\alpha^{3}}\n$$\n所以，分母是 $4\\pi \\left( \\frac{1}{4\\alpha^{3}} \\right) = \\frac{\\pi}{\\alpha^{3}}$。\n\n$\\langle \\frac{1}{r} \\rangle$ 的分子积分为：\n$$\n\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\frac{1}{r} \\exp(-2\\alpha r) r^{2}\\, dr = 4\\pi \\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr\n$$\n这对应于 $n=1$ 和 $a=2\\alpha$ 的情况：\n$$\n\\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr = \\frac{1!}{(2\\alpha)^{2}} = \\frac{1}{4\\alpha^{2}}\n$$\n所以，分子是 $4\\pi \\left( \\frac{1}{4\\alpha^{2}} \\right) = \\frac{\\pi}{\\alpha^{2}}$。\n\n现在我们计算 $\\langle \\frac{1}{r} \\rangle$：\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\pi/\\alpha^{2}}{\\pi/\\alpha^{3}} = \\alpha\n$$\n将此结果代回 $E_{V}(\\alpha)$ 的表达式中：\n$$\nE_{V}(\\alpha) = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1)\\alpha = -\\frac{\\alpha^{2}}{2} + \\alpha^{2} - \\alpha = \\frac{\\alpha^{2}}{2} - \\alpha\n$$\n\n步骤 3：最小化 $E_{V}(\\alpha)$\n\n为了找到最小化变分能量的最优参数 $\\alpha^{\\star}$，我们将 $E_{V}(\\alpha)$ 对 $\\alpha$ 求导，并令结果为零：\n$$\n\\frac{dE_{V}}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\alpha^{2}}{2} - \\alpha \\right) = \\alpha - 1\n$$\n将导数设为零，得到极值条件：\n$$\n\\alpha - 1 = 0 \\implies \\alpha^{\\star} = 1\n$$\n为确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^{2}E_{V}}{d\\alpha^{2}} = \\frac{d}{d\\alpha}(\\alpha - 1) = 1\n$$\n由于二阶导数为正 ($1 > 0$)，该极值为最小值。参数的最优值为 $\\alpha^{\\star} = 1$。在 Hartree 原子单位中，长度以 Bohr 半径 $a_{0}$ 为单位进行测量。参数 $\\alpha$ 的单位是长度的倒数，所以单位正确地为 $\\text{bohr}^{-1}$。最优值为 $1\\ \\text{bohr}^{-1}$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2828337"}, {"introduction": "理解了能量的计算方式后，下一步是认识到蒙特卡洛方法产生的是统计数据，而非精确的解析值。本练习旨在解决数据分析这一关键任务，它解释了如何通过考虑样本之间的序列相关性（这是马尔可夫链蒙特卡洛的一个关键特征），来正确计算能量估计值的误差棒。掌握这种统计分析方法对于从模拟中获得可靠且有意义的结果至关重要。[@problem_id:2828332]", "problem": "对一个小闭壳层原子进行的变分蒙特卡罗（VMC）模拟，产生了一个以相等时间间隔采样的局域能量值的平稳马尔可夫链 $\\{E_{i}\\}_{i=1}^{N}$。每步采样是相关的。设局域能量的总体方差定义为 $\\sigma^{2} \\equiv \\mathrm{Var}_{\\pi}(E)$（相对于平稳分布 $\\pi$），并设（常规的）样本方差为 $s^{2} \\equiv \\frac{1}{N-1}\\sum_{i=1}^{N}(E_{i}-\\bar{E})^{2}$，其中 $\\bar{E} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} E_{i}$。延迟为 $k$ 时的归一化自相关函数为 $\\rho_{k} \\equiv \\frac{\\mathrm{Cov}(E_{i},E_{i+k})}{\\sigma^{2}}$，积分自相关时间定义为 $\\tau_{\\mathrm{int}} \\equiv \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho_{k}$。\n\n从这些定义和平稳序列协方差的基本性质出发，从概念上解释总体方差、样本方差和相关采样下样本均值的有效方差之间的区别。然后，通过用 $\\sigma^{2}$ 和 $\\tau_{\\mathrm{int}}$ 表示 $\\mathrm{Var}(\\bar{E})$，求出在 VMC 中用作 $\\bar{E}$ 误差棒的标准误差（有效方差的平方根）。\n\n现在考虑一个具体的运行，有 $N = 100000$ 个样本，并从数据分析中得到以下估计值：\n- $\\bar{E} = -2.861$ (单位：哈特里),\n- $s^{2} = 0.16$ (单位：$\\mathrm{Ha}^{2}$),\n- $\\hat{\\tau}_{\\mathrm{int}} = 12.5$ (无量纲，使用上述定义以采样间隔为单位测量)。\n\n对于大的 $N$，将 $s^{2}$ 视为 $\\sigma^{2}$ 的一致估计量，并使用 $\\hat{\\tau}_{\\mathrm{int}}$ 作为 $\\tau_{\\mathrm{int}}$ 的估计值。计算误差棒，即 $\\bar{E}$ 的标准误差，单位为哈特里。以哈特里（Ha）为单位表示最终的能量不确定性，并将您的答案四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，提法恰当且客观。所有提供的定义和数据在计算物理和化学中蒙特卡罗模拟的统计分析背景下都是标准的。因此，该问题被认为是有效的，并将提供解答。\n\n问题要求对三种不同的方差相关量进行概念性解释，推导相关数据的均值标准误差，并针对一个具体案例进行该误差的数值计算。\n\n首先，我们澄清概念上的区别。\n$1$. **总体方差**，$\\sigma^{2} \\equiv \\mathrm{Var}_{\\pi}(E)$，是物理系统和所选试探波函数的一个理论属性。它表示局域能量可观测量 $E_{L}(\\mathbf{R}) = H\\Psi_{T}(\\mathbf{R})/\\Psi_{T}(\\mathbf{R})$ 在精确概率分布 $\\pi(\\mathbf{R}) \\propto |\\Psi_{T}(\\mathbf{R})|^{2}$ 上的内在分布宽度。如果试探波函数 $\\Psi_{T}$ 是哈密顿量 $H$ 的精确本征函数，那么局域能量将处处为常数，$\\sigma^{2}$ 将为零。因此，$\\sigma^{2}$ 是衡量试探波函数质量的一个指标。它是一个固定的，尽管通常是未知的值。\n\n$2$. **样本方差**，$s^{2} \\equiv \\frac{1}{N-1}\\sum_{i=1}^{N}(E_{i}-\\bar{E})^{2}$，是一个统计估计量，从模拟过程中生成的 $N$ 个数据点 $\\{E_{i}\\}$ 的有限集合中计算得出。它是真实总体方差 $\\sigma^{2}$ 的一个*估计*。区别是根本性的：$\\sigma^{2}$ 是一个理论常数，而 $s^{2}$ 是一个随机变量，其值取决于所获得的具体有限样本。如题所述，对于大量的样本 $N$，$s^{2}$ 是 $\\sigma^{2}$ 的一个一致估计量，意味着当 $N \\to \\infty$ 时，$s^{2} \\to \\sigma^{2}$。\n\n$3$. **样本均值的有效方差**，$\\mathrm{Var}(\\bar{E})$，量化了均值能量估计值 $\\bar{E}$ 的不确定性，而不是单个数据点的分布宽度。样本均值 $\\bar{E}$ 本身就是一个随机变量。如果将整个模拟重复多次，将会得到一个 $\\bar{E}$ 值的分布。$\\mathrm{Var}(\\bar{E})$ 就是这个分布的方差。它衡量了 $\\bar{E}$ 作为能量真实期望值的近似的可靠性。与独立样本的情况（其中 $\\mathrm{Var}(\\bar{E}) = \\sigma^{2}/N$）不同，对于来自马尔可夫链的相关样本，该方差会因序列相关性的存在而被放大，而这种相关性由积分自相关时间 $\\tau_{\\mathrm{int}}$ 捕捉。\n\n接下来，我们推导 $\\bar{E}$ 的标准误差表达式。样本均值 $\\bar{E} = \\frac{1}{N}\\sum_{i=1}^{N} E_{i}$ 的方差由下式给出：\n$$\n\\mathrm{Var}(\\bar{E}) = \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} E_{i}\\right) = \\frac{1}{N^{2}} \\mathrm{Var}\\left(\\sum_{i=1}^{N} E_{i}\\right)\n$$\n使用随机变量和的方差的通用公式 $\\mathrm{Var}(\\sum_{i} X_{i}) = \\sum_{i,j} \\mathrm{Cov}(X_{i}, X_{j})$，我们有：\n$$\n\\mathrm{Var}(\\bar{E}) = \\frac{1}{N^{2}} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathrm{Cov}(E_{i}, E_{j})\n$$\n由于序列 $\\{E_{i}\\}$ 是平稳的，协方差仅取决于延迟 $k = |i-j|$：$\\mathrm{Cov}(E_{i}, E_{j}) = \\mathrm{Cov}(E_{l}, E_{l+|i-j|})$。使用归一化自相关函数的定义 $\\rho_{k} = \\mathrm{Cov}(E_{i}, E_{i+k})/\\sigma^{2}$，我们有 $\\mathrm{Cov}(E_{i}, E_{j}) = \\sigma^{2} \\rho_{|i-j|}$。\n双重求和可以通过将具有相同延迟 $k$ 的项分组来重写：\n$$\n\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathrm{Cov}(E_{i}, E_{j}) = \\sum_{k=-(N-1)}^{N-1} (N-|k|) \\mathrm{Cov}(E_{i}, E_{i+k})\n$$\n项 $(N-|k|)$ 是延迟为 $k$ 的样本对的数量。由于 $\\rho_{k} = \\rho_{-k}$，和式变为：\n$$\n= N \\mathrm{Cov}(E_{i}, E_{i}) + \\sum_{k=1}^{N-1} 2(N-k) \\mathrm{Cov}(E_{i}, E_{i+k})\n$$\n$$\n= N\\sigma^{2} + 2\\sigma^{2} \\sum_{k=1}^{N-1} (N-k)\\rho_{k} = N\\sigma^{2}\\left(1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\rho_{k}\\right)\n$$\n将此代回 $\\mathrm{Var}(\\bar{E})$ 的表达式中：\n$$\n\\mathrm{Var}(\\bar{E}) = \\frac{\\sigma^{2}}{N}\\left(1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\rho_{k}\\right)\n$$\n对于大量的样本 $N$，以及对于 $\\rho_{k}$ 不可忽略的延迟 $k$，项 $k/N$ 很小。因此，我们可以近似 $(1-k/N) \\approx 1$。此外，由于对于大的 $k$，$\\rho_{k}$ 会衰减到零，所以求和可以扩展到无穷大：\n$$\n\\mathrm{Var}(\\bar{E}) \\approx \\frac{\\sigma^{2}}{N}\\left(1 + 2\\sum_{k=1 }^{\\infty}\\rho_{k}\\right)\n$$\n使用提供的积分自相关时间定义 $\\tau_{\\mathrm{int}} = \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho_{k}$，我们可以将和式表示为 $\\sum_{k=1}^{\\infty} \\rho_{k} = \\tau_{\\mathrm{int}} - \\frac{1}{2}$。\n将此代入方差的近似表达式中：\n$$\n\\mathrm{Var}(\\bar{E}) \\approx \\frac{\\sigma^{2}}{N}\\left(1 + 2\\left(\\tau_{\\mathrm{int}} - \\frac{1}{2}\\right)\\right) = \\frac{\\sigma^{2}}{N}(1 + 2\\tau_{\\mathrm{int}} - 1) = \\frac{2\\tau_{\\mathrm{int}}\\sigma^{2}}{N}\n$$\n该表达式是在相关采样下样本均值的有效方差。量 $N_{\\mathrm{eff}} = N/(2\\tau_{\\mathrm{int}})$ 通常被解释为有效独立样本数。\n均值的标准误差，记为 $\\mathrm{SE}(\\bar{E})$，是该方差的平方根：\n$$\n\\mathrm{SE}(\\bar{E}) = \\sqrt{\\mathrm{Var}(\\bar{E})} \\approx \\sqrt{\\frac{2\\tau_{\\mathrm{int}}\\sigma^{2}}{N}}\n$$\n这就是 $\\bar{E}$ 误差棒所需的公式。\n\n最后，我们计算误差棒的数值。给定：\n- 样本数，$N = 100000 = 10^{5}$\n- 总体方差的估计值，$s^{2} = 0.16 \\ \\mathrm{Ha}^{2}$\n- 积分自相关时间的估计值，$\\hat{\\tau}_{\\mathrm{int}} = 12.5$\n\n我们在我们推导的公式中使用样本估计值 $s^{2}$ 和 $\\hat{\\tau}_{\\mathrm{int}}$ 来代替真实值 $\\sigma^{2}$ 和 $\\tau_{\\mathrm{int}}$：\n$$\n\\mathrm{SE}(\\bar{E}) \\approx \\sqrt{\\frac{2 \\hat{\\tau}_{\\mathrm{int}} s^{2}}{N}}\n$$\n代入给定的数值：\n$$\n\\mathrm{SE}(\\bar{E}) \\approx \\sqrt{\\frac{2 \\times 12.5 \\times 0.16}{100000}} = \\sqrt{\\frac{25 \\times 0.16}{10^{5}}} = \\sqrt{\\frac{4}{10^{5}}} = \\sqrt{4 \\times 10^{-5}}\n$$\n$$\n\\mathrm{SE}(\\bar{E}) = 2 \\times 10^{-2.5} = \\frac{2}{100\\sqrt{10}} \\approx \\frac{2}{100 \\times 3.162277...} \\approx \\frac{0.02}{3.162277...} \\approx 0.006324555... \\ \\mathrm{Ha}\n$$\n问题要求结果四舍五入到四位有效数字。前四位有效数字是 $6$、$3$、$2$ 和 $4$。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$\n\\mathrm{SE}(\\bar{E}) \\approx 0.006325 \\ \\mathrm{Ha}\n$$\n该值表示计算出的平均能量 $\\bar{E} = -2.861 \\ \\mathrm{Ha}$ 的统计不确定性。最终能量应报告为 $-2.861(6) \\ \\mathrm{Ha}$ 或 $-2.8610 \\pm 0.0063 \\ \\mathrm{Ha}$，尽管问题只要求误差棒本身。", "answer": "$$\n\\boxed{0.006325}\n$$", "id": "2828332"}, {"introduction": "对于晶体或电子气等周期性系统，我们通常通过模拟一个有限的周期性超胞来模拟无限大的系统。本实践展示了此类研究中至关重要的最后一步：进行有限尺寸外推。这个过程旨在消除由于模拟单元的有限性而引入的人为效应，从而获得在热力学极限下的能量，这才是具有物理意义的量。[@problem_id:2828289]", "problem": "给定在周期性边界条件下，几个不同有限尺寸的周期性均匀电子系统的扭曲平均扩散蒙特卡洛（DMC）计算的单粒子能量。扭曲平均消除了单体壳层效应，因此剩余的有限尺寸偏差源于由库仑相互作用的长波行为和静态结构因子所控制的双体关联。请仅使用以下基本依据，推导单个粒子能量中有限尺寸偏差的渐近标度形式，并为热力学极限构建一个有统计学原理的估计量：\n\n- 平移不变性和广延性意味着一个包含 $N$ 个粒子的周期性系统的总能量是一个广延性质，并且当 $N \\to \\infty$ 时，单个粒子的能量 $e(N)$ 趋近于一个热力学极限值 $e(\\infty)$。\n- 在有限的周期性盒子中，用离散的倒易点阵代替连续谱波矢会导致误差，这些误差由关联函数的长波部分控制。当通过扭曲平均消除单体壳层效应后，主要的残余误差是由于小波矢大小处的双体关联。\n- 对于一个足够光滑的长波被积函数，在三维空间中，倒易点阵矢量上的黎曼和与相应连续谱积分之间的差值，与体积的倒数成标度关系。请用盒子长度 $L$、粒子数 $N$ 和数密度 $n$ 来表达你的推理，其中 $L^{3} = N/n$。\n\n任务 A（推导）：从上述基本依据出发，不引用任何专门的或特定于系统的修正公式，论证在扭曲平均下，三维周期性均匀系统中单个粒子能量的双体有限尺寸偏差对 $N$ 的主导阶依赖关系。据此，为 $e(N)$ 提出一个最小一致性回归模型，该模型可用于从几个不同 $N$ 值的数据中估计 $e(\\infty)$。\n\n任务 B（估计）：给定 $e(N_{i})$ 的含噪声估计值 $e_{i}$，其报告的独立标准误差为 $\\sigma_{i}$（其中 $i = 1, \\dots, M$），为回归模型参数建立并解决一个加权最小二乘估计问题，并定义以下量：\n- 热力学极限下单个粒子能量的估计值 $\\hat{e}(\\infty)$，单位为哈特里/粒子。\n- 对于一个指定的目标尺寸 $N_{\\mathrm{tgt}}$，在 $N_{\\mathrm{tgt}}$ 处剩余双体有限尺寸偏差的带符号估计值，定义为 $\\Delta_{\\mathrm{tgt}} \\equiv \\hat{e}(N_{\\mathrm{tgt}}) - \\hat{e}(\\infty)$，单位为哈特里/粒子。该量代表在扭曲平均后，$N_{\\mathrm{tgt}}$ 处估计的残余双体有限尺寸误差。\n\n将您的解决方案实现为一个程序，该程序：\n- 使用权重为 $w_{i} = 1/\\sigma_{i}^{2}$ 的加权最小二乘法来估计您最小回归模型的参数。\n- 计算下面每个测试案例的 $\\hat{e}(\\infty)$ 和 $\\Delta_{\\mathrm{tgt}}$。\n- 所有输出均以哈特里/粒子为单位，并四舍五入到六位小数。\n\n测试套件：\n对于每个案例，您将获得一个粒子数列表 $N_{i}$、扭曲平均的DMC单个粒子能量 $e_{i}$（单位为哈特里/粒子）、它们的单标准差不确定度 $\\sigma_{i}$（单位为哈特里/粒子）以及一个目标 $N_{\\mathrm{tgt}}$。\n\n- 案例 1：\n  - $N = [\\,32,\\,54,\\,128,\\,250\\,]$\n  - $e = [\\,-0.421500,\\,-0.462241,\\,-0.496500,\\,-0.508700\\,]$\n  - $\\sigma = [\\,0.000800,\\,0.001000,\\,0.000600,\\,0.000600\\,]$\n  - $N_{\\mathrm{tgt}} = 128$\n\n- 案例 2（允许线性拟合的最小尺寸数的边界情况）：\n  - $N = [\\,54,\\,108\\,]$\n  - $e = [\\,-0.281481,\\,-0.290741\\,]$\n  - $\\sigma = [\\,0.001500,\\,0.001000\\,]$\n  - $N_{\\mathrm{tgt}} = 108$\n\n- 案例 3（超出主导阶的轻微曲率，以测试主导阶拟合的鲁棒性）：\n  - $N = [\\,64,\\,96,\\,216,\\,512\\,]$\n  - $e = [\\,-0.710156,\\,-0.723650,\\,-0.738346,\\,-0.745097\\,]$\n  - $\\sigma = [\\,0.000700,\\,0.000700,\\,0.000700,\\,0.000700\\,]$\n  - $N_{\\mathrm{tgt}} = 512$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表对应一个测试案例，并恰好包含两个浮点数：\n- 第一个条目是 $\\hat{e}(\\infty)$，单位为哈特里/粒子，四舍五入到六位小数。\n- 第二个条目是 $\\Delta_{\\mathrm{tgt}}$，单位为哈特里/粒子，四舍五入到六位小数。\n整体格式必须类似于\n[[$\\hat{e}(\\infty)_{1}$,$\\Delta_{\\mathrm{tgt},1}$],[$\\hat{e}(\\infty)_{2}$,$\\Delta_{\\mathrm{tgt},2}$],[$\\hat{e}(\\infty)_{3}$,$\\Delta_{\\mathrm{tgt},3}$]]\n且不含空格。例如，一个输出可能看起来像“\"[[-0.521234,0.012345],[-0.300000,0.009259],[-0.750000,0.004883]]\"”，但其值由您的计算确定。", "solution": "问题陈述已经过严格评估，被认为是有效的。它具有科学依据、提法明确，并包含进行形式推导和数值求解所需的所有信息。它提出了一个计算物理学中标准的、有一定难度的问题。\n\n任务是推导扭曲平均量子蒙特卡洛计算中有限尺寸能量偏差的渐近标度，并构建相应的热力学极限估计量。将按要求分两部分来解决。\n\n**任务A：渐近标度和回归模型的推导**\n\n我们的目标是确定对于一个大的、周期性的均匀系统，单个粒子的能量 $e(N)$ 对粒子数 $N$ 的主导阶函数依赖关系。有限尺寸偏差定义为 $\\Delta e(N) = e(N) - e(\\infty)$，其中 $e(\\infty)$ 是热力学极限（$N \\to \\infty$）下的单个粒子能量。\n\n我们有三个基本依据：\n1. 能量的广延性和热力学极限 $e(\\infty)$ 的存在。\n2. 在扭曲平均消除单体壳层效应后，主要的残余有限尺寸误差来源是双体关联能。此误差源于用离散的倒易点阵矢量和代替连续积分。\n3. 对于三维空间中一个足够光滑的函数，用离散的倒易点阵上的黎曼和来近似连续积分的误差，与系统体积 $V$ 的倒数成标度关系。\n\n让我们将论证形式化。单个粒子的能量 $e(N)$ 可以分解为动能和势能的贡献。有限尺寸误差主要由长程双体库仑相互作用决定，它对倒易空间在小波矢 $\\mathbf{k}$ 处的离散化最为敏感。\n\n设 $I(N)$ 是一个强度物理量，其计算涉及对体积 $V$ 内倒易点阵矢量 $\\{\\mathbf{k}\\}$ 的求和。一个例子是单位体积的势能。示意性地，\n$$\nI(N) = \\frac{1}{V} \\sum_{\\mathbf{k}} f(\\mathbf{k})\n$$\n其中 $f(\\mathbf{k})$ 代表来自模式 $\\mathbf{k}$ 的贡献。在热力学极限下，这个和变成一个积分：\n$$\nI(\\infty) = \\int \\frac{d^3k}{(2\\pi)^3} f(\\mathbf{k})\n$$\n基本依据指出，这种近似的误差与体积的倒数成标度关系：\n$$\nI(N) - I(\\infty) = \\frac{1}{V} \\sum_{\\mathbf{k}} f(\\mathbf{k}) - \\int \\frac{d^3k}{(2\\pi)^3} f(\\mathbf{k}) \\propto \\frac{1}{V}\n$$\n单个粒子的能量 $e(N)$ 是一个强度量。它的值由这样的基础求和决定。因此，$e(N)$ 中的有限尺寸偏差必须与这些基础强度量中的偏差成正比。\n$$\n\\Delta e(N) = e(N) - e(\\infty) \\propto [I(N) - I(\\infty)]\n$$\n结合这些比例关系，我们发现单个粒子能量偏差随体积的标度关系：\n$$\n\\Delta e(N) \\propto \\frac{1}{V}\n$$\n对于均匀系统，当趋近热力学极限时，数密度 $n = N/V$ 保持不变。这提供了体积 $V$ 和粒子数 $N$ 之间的直接关系：$V = N/n$。将此代入我们的标度关系，得到对 $N$ 的依赖关系：\n$$\n\\Delta e(N) \\propto \\frac{n}{N}\n$$\n由于对于给定系统，密度 $n$ 是一个常数参数，因此单个粒子能量的有限尺寸偏差的主导阶依赖关系是：\n$$\n\\Delta e(N) \\propto \\frac{1}{N}\n$$\n根据这个推导，对于一个大但有限的系统尺寸 $N$，单个粒子的能量可以表示为一个渐近展开：\n$$\ne(N) = e(\\infty) + \\frac{A}{N} + \\mathcal{O}\\left(\\frac{1}{N^{\\alpha}}\\right), \\quad \\alpha > 1\n$$\n其中 $A$ 是一个取决于系统性质的常数。为了从有限的数据集中进行外推，我们通过在该级数的主导阶处截断来采用最小一致性回归模型：\n$$\ne(N) \\approx e(\\infty) + \\frac{A}{N}\n$$\n该模型在变量 $1/N$ 中是线性的。待估计的参数是热力学极限能量 $e(\\infty)$（截距）和系数 $A$（斜率）。\n\n**任务 B：加权最小二乘估计**\n\n我们给定一组 $M$ 个数据点 $(N_i, e_i, \\sigma_i)$，其中 $e_i$ 是真实能量 $e(N_i)$ 的含噪声测量值，标准误差为 $\\sigma_i$。我们的线性模型是 $e_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$，其中 $x_i = 1/N_i$，$\\beta_0 = e(\\infty)$，$\\beta_1 = A$，$\\epsilon_i$ 代表统计噪声。\n\n为了找到参数 $\\boldsymbol{\\beta} = [\\beta_0, \\beta_1]^T$ 的最优估计，我们使用最大似然原理，对于独立的、服从高斯分布的误差，这等同于最小化加权残差平方和 $\\chi^2$：\n$$\n\\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^{M} w_i (e_i - (\\beta_0 + \\beta_1 x_i))^2\n$$\n适当的权重是方差的倒数，$w_i = 1/\\sigma_i^2$。这使得更精确的测量具有更大的影响力。\n\n这个最小化问题可以用矩阵代数表示。我们的目标是求解使 $(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^T \\mathbf{W} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})$ 最小化的 $\\hat{\\boldsymbol{\\beta}}$，其中：\n- $\\mathbf{y} = [e_1, e_2, \\dots, e_M]^T$ 是观测能量的向量。\n- $\\mathbf{X}$ 是 $M \\times 2$ 的设计矩阵，其行是 $[1, x_i]$：\n  $$\n  \\mathbf{X} = \\begin{pmatrix} 1 & 1/N_1 \\\\ 1 & 1/N_2 \\\\ \\vdots & \\vdots \\\\ 1 & 1/N_M \\end{pmatrix}\n  $$\n- $\\mathbf{W}$ 是 $M \\times M$ 的对角权重矩阵：\n  $$\n  \\mathbf{W} = \\text{diag}(1/\\sigma_1^2, 1/\\sigma_2^2, \\dots, 1/\\sigma_M^2)\n  $$\n这个加权线性最小二乘问题的解由正规方程组给出：\n$$\n(\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n因此，参数向量的估计量为：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n从得到的参数向量 $\\hat{\\boldsymbol{\\beta}} = [\\hat{\\beta}_0, \\hat{\\beta}_1]^T$ 中，我们提取所需的物理量：\n\n1.  在热力学极限下，单个粒子能量的估计值 $\\hat{e}(\\infty)$ 是回归的截距：\n    $$\n    \\hat{e}(\\infty) = \\hat{\\beta}_0\n    $$\n\n2.  在指定目标尺寸 $N_{\\mathrm{tgt}}$ 处的估计带符号双体有限尺寸偏差，记为 $\\Delta_{\\mathrm{tgt}}$，是该尺寸下拟合能量与外推的热力学极限能量之差：\n    $$\n    \\Delta_{\\mathrm{tgt}} = \\hat{e}(N_{\\mathrm{tgt}}) - \\hat{e}(\\infty) = \\left( \\hat{\\beta}_0 + \\frac{\\hat{\\beta}_1}{N_{\\mathrm{tgt}}} \\right) - \\hat{\\beta}_0 = \\frac{\\hat{\\beta}_1}{N_{\\mathrm{tgt}}}\n    $$\n此过程为分析所提供的数据提供了一个完整且有统计学原理的方法。实现将通过对每个测试案例数值求解正规方程组来进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    It orchestrates the data processing, calculation, and final output formatting.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": [32, 54, 128, 250],\n            \"e\": [-0.421500, -0.462241, -0.496500, -0.508700],\n            \"sigma\": [0.000800, 0.001000, 0.000600, 0.000600],\n            \"N_tgt\": 128,\n        },\n        {\n            \"N\": [54, 108],\n            \"e\": [-0.281481, -0.290741],\n            \"sigma\": [0.001500, 0.001000],\n            \"N_tgt\": 108,\n        },\n        {\n            \"N\": [64, 96, 216, 512],\n            \"e\": [-0.710156, -0.723650, -0.738346, -0.745097],\n            \"sigma\": [0.000700, 0.000700, 0.000700, 0.000700],\n            \"N_tgt\": 512,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result_pair = estimate_thermodynamic_limit(\n            np.array(case[\"N\"], dtype=float),\n            np.array(case[\"e\"], dtype=float),\n            np.array(case[\"sigma\"], dtype=float),\n            float(case[\"N_tgt\"]),\n        )\n        results.append(result_pair)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of lists with no spaces.\n    print(f\"[{','.join([f'[{r[0]:.6f},{r[1]:.6f}]' for r in results])}]\")\n\ndef estimate_thermodynamic_limit(N, e, sigma, N_tgt):\n    \"\"\"\n    Performs weighted least squares to extrapolate to the thermodynamic limit.\n\n    Args:\n        N (np.ndarray): Array of particle numbers (system sizes).\n        e (np.ndarray): Array of corresponding energies per particle.\n        sigma (np.ndarray): Array of standard errors for the energies.\n        N_tgt (float): The target system size for bias calculation.\n\n    Returns:\n        tuple: A tuple containing:\n            - (float) The estimated energy in the thermodynamic limit, e_infinity.\n            - (float) The estimated finite-size bias at N_tgt.\n    \"\"\"\n    # The independent variable for the linear model is 1/N.\n    x = 1.0 / N\n\n    # The dependent variable is the energy per particle.\n    y = e\n\n    # The weights for the weighted least squares are the inverse variances.\n    weights = 1.0 / (sigma**2)\n\n    # Construct the design matrix X for the model y = beta_0 * 1 + beta_1 * x.\n    # The first column is for the intercept (beta_0), the second for the slope (beta_1).\n    X = np.vstack((np.ones_like(x), x)).T\n\n    # Construct the diagonal weight matrix W.\n    W = np.diag(weights)\n\n    # Set up the normal equations for weighted least squares:\n    # (X^T * W * X) * beta = X^T * W * y\n    A = X.T @ W @ X\n    b = X.T @ W @ y\n\n    # Solve the system of linear equations for the parameter vector beta.\n    # beta_hat[0] will be the estimate for beta_0 (e_infinity).\n    # beta_hat[1] will be the estimate for beta_1 (the slope A).\n    try:\n        beta_hat = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        # This case should not be reached with the given valid inputs.\n        return (np.nan, np.nan)\n        \n    e_infinity_hat = beta_hat[0]\n    A_hat = beta_hat[1]\n\n    # The finite-size bias at the target size N_tgt is A / N_tgt.\n    delta_tgt = A_hat / N_tgt\n\n    return e_infinity_hat, delta_tgt\n\nsolve()\n```", "id": "2828289"}]}