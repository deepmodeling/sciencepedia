## 引言
随着纳米科技的飞速发展，单个分子作为电子器件核心构件已从科学构想变为实验现实。然而，在分子尺度上，量子效应主导着电子的运动，这为精确预测和设计分子器件的[输运性质](@entry_id:203130)带来了巨大的理论挑战。一个核心问题是：如何描述一个与宏观电极相连的微观分子（一个典型的[开放量子系统](@entry_id:138632)）的非平衡行为？[非平衡格林函数](@entry_id:201883)（NEGF）方法正是为解决这一难题而发展起来的强大理论框架，它为我们理解从原子到器件的[电荷](@entry_id:275494)、自旋和[能量输运](@entry_id:183081)提供了统一而严谨的语言。

本文旨在为读者提供一个关于NEGF在[分子输运](@entry_id:195239)中应用的全面指南。我们将从基本原理出发，逐步深入到前沿应用和计算实践，弥合抽象理论与具体问题之间的鸿沟。通过本文的学习，您将能够掌握NEGF的核心思想，并将其应用于分析和理解纳米尺度下的[量子输运](@entry_id:138932)现象。

在“**原理与机制**”一章中，我们将系统地构建NEGF的理论基础，从[哈密顿量](@entry_id:172864)的划分开始，详细阐述自能、谱函数和Keldysh形式主义等关键概念，并最终推导出计算[稳态电流](@entry_id:276565)的[Landauer公式](@entry_id:147869)。接下来的“**应用与交叉学科联系**”一章将展示NEG[F理论](@entry_id:184208)的强大应用价值，通过探讨量子干涉、分子[自旋电子学](@entry_id:141468)、非弹性效应以及与[第一性原理方法](@entry_id:268553)结合的NEGF-DFT，揭示其在多个前沿交叉领域的深刻洞见。最后，在“**动手实践**”一章中，我们提供了一系列精心设计的计算练习，引导您将理论知识转化为解决实际问题的能力，亲手计算分子结的[态密度](@entry_id:147894)和透射谱。

## 原理与机制

在本章中，我们将深入探讨[非平衡格林函数](@entry_id:201883)（NEGF）方法的核心物理原理和数学机制。我们将从一个分子结的基本[哈密顿量](@entry_id:172864)描述开始，逐步构建起描述[开放量子系统](@entry_id:138632)动力学的理论框架。我们将阐明自能、展宽矩阵和谱函数等关键概念的物理意义，并最终推导出计算[稳态电流](@entry_id:276565)的中心方程。本章的目标是为读者提供一个系统而严谨的理论基础，以便理解和模拟分子尺度上的[量子输运](@entry_id:138932)现象。

### 系统的描述：[哈密顿量](@entry_id:172864)的划分

在理论上处理一个[分子输运](@entry_id:195239)器件时，第一步是将其在数学上划分为几个相互作用的部分。一个典型的分子结系统包含一个中心的分子区域（Device, D），它通过隧穿壁垒与两个或多个宏观电极（Leads, $\alpha$）相连。这些电极，通常标记为左（L）和右（R），作为粒子和能量的巨大储存库，它们各自处于自身的热力平衡状态，由明确的化学势 $\mu_{\alpha}$ 和温度 $T$ 表征。

在[单粒子近似](@entry_id:138558)下，整个系统的总[哈密顿量](@entry_id:172864) $H$ 可以被划分为三个部分 [@problem_id:2790660]：
$$
H = H_D + \sum_{\alpha} H_{\alpha} + \sum_{\alpha} V_{D\alpha}
$$
这里，每个算符都在相应的[子空间](@entry_id:150286)上作用：
-   $H_D$ 是孤立的中心分子区域的[哈密顿量](@entry_id:172864)。它描述了分子自身的[电子结构](@entry_id:145158)，例如分子[轨道](@entry_id:137151)的能量和[轨道](@entry_id:137151)间的耦合。
-   $H_{\alpha}$ 是孤立的电极 $\alpha$ 的[哈密顿量](@entry_id:172864)。由于电极是宏观的，它通常被建模为一个具有连续[能谱](@entry_id:181780)的非[相互作用费米子](@entry_id:160994)气体。
-   $V_{D\alpha}$ 是描述中心区域与电极 $\alpha$ 之间耦合的[哈密顿量](@entry_id:172864)。它包含了使得电子能够在分子和电极之间隧穿的[矩阵元](@entry_id:186505)。总的耦合项应为 $\sum_{\alpha} (V_{D\alpha} + V_{\alpha D})$，其中 $V_{\alpha D} = V_{D\alpha}^{\dagger}$ 以确保总[哈密顿量](@entry_id:172864) $H$ 的[厄米性](@entry_id:141899)。

这种划分方式为我们运用格林函数方法处理开放系统问题提供了起点。我们的核心目标是描述中心区域 $D$ 的物理性质，而这个区域由于与电极的耦合，成为了一个[开放系统](@entry_id:147845)。

### 开放系统与自能

由于分子区域与具有连续[能谱](@entry_id:181780)的电极耦合，其自身的电子态不再是能量严格确定的束缚态。相反，它们变成了寿命有限的[准粒子](@entry_id:136584)态。NEGF 形式主义的强大之处在于，它能够通过一个名为**[自能](@entry_id:145608)**（self-energy）的[有效算符](@entry_id:183730)，精确地将电极对中心区域的所有影响包含进来。

通过在形式上“积分掉”电极的自由度，我们可以推导出一个只针对中心区域的有效格林函数。中心区域的[推迟格林函数](@entry_id:139183) $G_D^r(E)$ 满足[戴森方程](@entry_id:146246)（Dyson equation）[@problem_id:2790660]：
$$
G_D^r(E) = \left[E - H_D - \sum_{\alpha} \Sigma_{\alpha}^r(E)\right]^{-1}
$$
在这个表达式中，$E$ 是能量，而 $\Sigma_{\alpha}^r(E)$ 就是由电极 $\alpha$ 引起的**推迟[自能](@entry_id:145608)**。它是一个能量依赖的非厄米矩阵，其定义为：
$$
\Sigma_{\alpha}^r(E) = V_{D\alpha} g_{\alpha}^r(E) V_{\alpha D}
$$
这里的 $g_{\alpha}^r(E) = [E - H_{\alpha} + i0^+]^{-1}$ 是孤立电极 $\alpha$ 的表面格林函数，$0^+$ 是一个无穷小正数，确保了[推迟格林函数](@entry_id:139183)的因果性。[自能](@entry_id:145608) $\Sigma_{\alpha}^r(E)$ 将电极的连续谱和分子-电极耦合的全部信息编码，并将其作为对孤立分子[哈密顿量](@entry_id:172864) $H_D$ 的一个能量依赖的修正项。

### [自能](@entry_id:145608)的物理内涵：[能级移动](@entry_id:156631)与[寿命展宽](@entry_id:274412)

[自能](@entry_id:145608) $\Sigma_{\alpha}^r(E)$ 的非[厄米性](@entry_id:141899)是其最重要的特征，它的实部和虚部各自具有明确的物理意义 [@problem_id:2790694]。

#### [自能](@entry_id:145608)的实部：[能级移动](@entry_id:156631)

[自能](@entry_id:145608)的实部，通常记为 $\Lambda_{\alpha}(E) = \operatorname{Re}[\Sigma_{\alpha}^r(E)]$，是一个[厄米矩阵](@entry_id:155147)。它描述了分子与电极耦合所引起的[分子能级](@entry_id:158418)的**能量移动**（level shift）。这可以被理解为一种二阶微扰效应：分子的离散能级与电极的[连续能态](@entry_id:198338)发生杂化，导致[分子能级](@entry_id:158418)的能量发生偏移。因此，在输运过程中，一个分子[轨道](@entry_id:137151)的[有效能](@entry_id:139794)量不再是其本征能量 $\varepsilon_0$，而是被修正为 $\varepsilon_0 + \sum_{\alpha} \Lambda_{\alpha}(E)$。

#### [自能](@entry_id:145608)的虚部与展宽矩阵：有限寿命

自能的虚部则与粒子在分子上的**有限寿命**直接相关。我们定义一个**展宽矩阵**（broadening matrix） $\Gamma_{\alpha}(E)$ [@problem_id:2790632]：
$$
\Gamma_{\alpha}(E) = i \left[ \Sigma_{\alpha}^r(E) - \Sigma_{\alpha}^a(E) \right]
$$
其中 $\Sigma_{\alpha}^a(E) = [\Sigma_{\alpha}^r(E)]^{\dagger}$ 是超前[自能](@entry_id:145608)。利用这个关系，可以证明 $\Gamma_{\alpha}(E)$ 是一个厄米矩阵。进一步地，它与[自能](@entry_id:145608)的虚部有直接关系：
$$
\Gamma_{\alpha}(E) = -2 \operatorname{Im}[\Sigma_{\alpha}^r(E)]
$$
由于电极是被动的粒子库，分子上的电子只能衰变进入电极，而不能从电极中自发地获得能量。这个物理约束要求 $\operatorname{Im}[\Sigma_{\alpha}^r(E)]$ 必须是一个负半定矩阵，从而保证了**展宽矩阵 $\Gamma_{\alpha}(E)$ 是正半定的** [@problem_id:2790694] [@problem_id:2790632]。一个正定的 $\Gamma_{\alpha}(E)$ 意味着分子态由于耦合到电极而获得了**能级展宽**。根据[费米黄金定则](@entry_id:146239)，一个态的衰变速率（或逃逸速率）与其耦合到的末[态密度](@entry_id:147894)成正比。在这里，$\Gamma_{\alpha}(E)/\hbar$ 就给出了电子从分子逃逸到电极 $\alpha$ 的速率。因此，一个展宽为 $\Gamma$ 的能级的寿命为 $\tau = \hbar/\Gamma$。

#### 因果性与 [Kramers-Kronig 关系](@entry_id:140966)

自能的实部（[能级移动](@entry_id:156631)）和虚部（[寿命展宽](@entry_id:274412)）并非[相互独立](@entry_id:273670)的。作为一个推迟响应函数，$\Sigma_{\alpha}^r(E)$ 必须满足因果性，这意味着它在[复能量平面](@entry_id:203283)的上半平面是解析的。这一[解析性](@entry_id:140716)要求导致其**实部和虚部通过 Kramers-Kronig (KK) 关系相互关联** [@problem_id:2790694]：
$$
\operatorname{Re}[\Sigma^r_{\alpha}(E)] = \frac{1}{\pi} \mathcal{P} \int_{-\infty}^{\infty} dE' \frac{\operatorname{Im}[\Sigma^r_{\alpha}(E')]}{E'-E}
$$
这里 $\mathcal{P}$ 表示[柯西主值](@entry_id:192761)积分。这个关系意味着，只要知道了作为能量函数的展宽（虚部），就可以唯一地确定能级的移动（实部）。例如，如果一个电极的能带具有尖锐的边缘，导致 $\operatorname{Im}[\Sigma^r_{\alpha}(E)]$ 在能量上急剧变化，那么 $\operatorname{Re}[\Sigma^r_{\alpha}(E)]$ 必然会在该能量附近表现出相应的[色散](@entry_id:263750)特征。

#### 宽带近似

在许多实际情况下，尤其是在金属电极中，电极的[电子态密度](@entry_id:182354)和分子-电极耦合在分子[共振峰](@entry_id:271281)周围的能量区间内变化非常缓慢。在这种情况下，我们可以做出**宽带近似**（Wide-Band Limit, WBL）[@problem_id:2790679]。该近似假设在所有相关的[能量尺度](@entry_id:196201)（如偏压窗口、热能 $k_B T$、[共振宽度](@entry_id:186927) $\Gamma_n$）之上，乘积 $V_{\alpha}^{\dagger} \rho_{\alpha}(E) V_{\alpha}$ 是一个常数，其中 $\rho_{\alpha}(E)$ 是电极的态密度矩阵。

在此近似下，展宽矩阵 $\Gamma_{\alpha}(E)$ 变成一个与能量无关的常数矩阵 $\Gamma_{\alpha}$。通过 [Kramers-Kronig 关系](@entry_id:140966)，一个在无限能量范围内都为常数的虚部将导致一个发散的实部。然而，在一个更符合物理实际的模型中（即展宽在有限但非常宽的能带内为常数），[自能](@entry_id:145608)的实部 $\Lambda_{\alpha}(E)$ 在能带中心附近变化缓慢，可以近似为一个常数。这个常数[能级移动](@entry_id:156631)通常被吸收到分子[哈密顿量](@entry_id:172864) $H_D$ 的重新定义中，或者在某些对称情况下可以忽略不计。因此，在宽带近似下，[自能](@entry_id:145608)被极大地简化为 [@problem_id:2790694] [@problem_id:2790679]：
$$
\Sigma_{\alpha}^r(E) \approx -\frac{i}{2} \Gamma_{\alpha}
$$

### 核心物理量：[格林函数](@entry_id:147802)、谱函数与态密度

引入[自能](@entry_id:145608)后，我们可以计算出中心区域的格林函数 $G_D^r(E)$，并由此得到一系列核心物理量。

#### [谱函数](@entry_id:147628)

**[谱函数](@entry_id:147628)**（spectral function）$A(E)$ 定义为：
$$
A(E) = i \left[ G^r(E) - G^a(E) \right]
$$
其中 $G^a(E)=[G^r(E)]^{\dagger}$ 是超前格林函数。[谱函数](@entry_id:147628)是一个[厄米矩阵](@entry_id:155147)，其对角元 $A_{ii}(E)$ 描述了在能量 $E$ 处、在[轨道](@entry_id:137151) $i$ 上增加或移除一个电子的概率。因此，它直接反映了分子中可供电子占据的[量子态](@entry_id:146142)的能量[分布](@entry_id:182848)。

利用[戴森方程](@entry_id:146246)和 $\Gamma(E) = i(\Sigma^r - \Sigma^a)$，可以推导出谱函数的一个重要恒等式 [@problem_id:2790647]：
$$
A(E) = G^r(E) \Gamma(E) G^a(E)
$$
其中 $\Gamma(E) = \sum_{\alpha} \Gamma_{\alpha}(E)$ 是总的展宽矩阵。这个表达式直观地揭示了[谱函数](@entry_id:147628)的构成：一个电子在分子中通过 $G^r$ 传播，与环境（由 $\Gamma$ 描述）相互作用，然后再通过 $G^a$ 传播。

#### [局域态密度](@entry_id:136852)

与谱函数密切相关的是**[局域态密度](@entry_id:136852)**（Local Density of States, [LDOS](@entry_id:136852)）。对于分子上的[轨道](@entry_id:137151) $i$，其[局域态密度](@entry_id:136852) $\rho_i(E)$ 定义为 [@problem_id:2790647]：
$$
\rho_i(E) = \frac{1}{2\pi} A_{ii}(E)
$$
它也可以通过[推迟格林函数](@entry_id:139183)的虚部来表示：$\rho_i(E) = -\frac{1}{\pi}\operatorname{Im}[G^r_{ii}(E)]$。$\rho_i(E)$ 描述了在能量 $E$ 处、在空间位置（[轨道](@entry_id:137151)）$i$ 上的态密度。对所有[能量积分](@entry_id:166228)，可以得到该[轨道](@entry_id:137151)上的总态数，对于一个归一化的[轨道](@entry_id:137151)[基矢](@entry_id:199546)，我们有求和规则：
$$
\int_{-\infty}^{\infty} \rho_i(E) dE = 1
$$
以一个单能级 $\varepsilon_0$ 在宽带近似下的模型为例，其[推迟格林函数](@entry_id:139183)为 $G^r(E) = [E - \varepsilon_0 + i\Gamma/2]^{-1}$。其谱函数为一个[洛伦兹函数](@entry_id:199503)：
$$
A(E) = \frac{\Gamma}{(E-\varepsilon_0)^2 + (\Gamma/2)^2}
$$
对应的[局域态密度](@entry_id:136852) $\rho(E) = \frac{1}{2\pi} A(E)$ 也是一个洛伦兹峰，中心在 $\varepsilon_0$，半高全宽（FWHM）为 $\Gamma$。这清晰地表明，与电极的耦合使得原本能量精确的离散能级 $\varepsilon_0$ 展宽成了一个具有有限能量宽度的共振态。当耦合趋于零（$\Gamma \to 0^+$）时，[洛伦兹函数](@entry_id:199503)趋向于一个狄拉克 $\delta$ 函数，$\rho(E) \to \delta(E-\varepsilon_0)$，我们便恢复了孤立分子的离散能谱 [@problem_id:2790647]。

### 迈向非平衡：Keldysh 形式主义

至今为止的讨论主要集中在[推迟格林函数](@entry_id:139183)和谱函数，它们描述了系统的“可用态”。然而，要计算如粒子数或电流这样的非平衡物理量，我们还需要知道这些态的**占据情况**。这需要一个更强大的理论框架，即 Keldysh 形式主义。

考虑一个系统在 $t_0$ 时刻从某个初始状态（由[密度矩阵](@entry_id:139892) $\rho(t_0)$ 描述）开始，在[含时哈密顿量](@entry_id:136684) $H(t)$ 的驱动下演化。任何算符 $\mathcal{O}$ 在 $t$ 时刻的[期望值](@entry_id:153208)可以写为 $\langle \mathcal{O}(t) \rangle = \operatorname{Tr}\{\rho(t_0) U^{\dagger}(t, t_0) \mathcal{O}_S U(t, t_0)\}$，其中 $U(t,t_0)$ 是[时间演化算符](@entry_id:196774)。这个表达式同时包含了从 $t_0$ 到 $t$ 的正向演化 $U$ 和从 $t$ 回到 $t_0$ 的反向演化 $U^{\dagger}$。

Keldysh 形式主义巧妙地将这两种演化路径统一到一个**闭合时间路径**（或称 Keldysh 围道）$\mathcal{C}$ 上 [@problem_id:2790669]。这个围道从初始时刻 $t_0$ 沿实轴正向演化到无穷远，再沿[实轴](@entry_id:148276)反向回到 $t_0$。如果初始状态是热平衡态 $\rho(t_0) \propto \exp(-\beta H)$，还可以包含一段从 $t_0$ 到 $t_0 - i\hbar\beta$ 的虚时路径，以方便地包含初始的热关联。

在 Keldysh 围道上，我们可以定义一个**围道序[格林函数](@entry_id:147802)** $G(\tau, \tau') = -i \langle T_{\mathcal{C}} \psi(\tau) \psi^{\dagger}(\tau') \rangle$，其中 $T_{\mathcal{C}}$ 是围道排序算符，它将算符按照其在围道 $\mathcal{C}$ 上的先后顺序[排列](@entry_id:136432)。这个单一的围道序格林函数包含了系统动力学的全部信息。

#### 实时间[格林函数](@entry_id:147802)族

通过将围道序[格林函数](@entry_id:147802)的两个时间变量分别投影到正向或反向实时间分支上，我们得到四个核心的实时间格林函数 [@problem_id:2790635]：
- **[推迟格林函数](@entry_id:139183) ($G^r$)**：描述对微扰的因果响应。
  $G_{ij}^r(t,t') = -i\theta(t-t') \langle \{c_i(t), c_j^{\dagger}(t')\} \rangle$
- **超前格林函数 ($G^a$)**：
  $G_{ij}^a(t,t') = i\theta(t'-t) \langle \{c_i(t), c_j^{\dagger}(t')\} \rangle$
- **[小格林函数](@entry_id:141540) ($G^<$)**：描述粒子的占据情况和关联。
  $G_{ij}^<(t,t') = i \langle c_j^{\dagger}(t') c_i(t) \rangle$
- **[大格林函数](@entry_id:142137) ($G^>$)**：描述空穴的占据情况和关联。
  $G_{ij}^>(t,t') = -i \langle c_i(t) c_j^{\dagger}(t') \rangle$

这四个函数并非[相互独立](@entry_id:273670)，它们由一个普适的恒等式联系在一起：
$$
G^r(t,t') - G^a(t,t') = G^>(t,t') - G^<(t,t')
$$

$G^r$ 和 $G^a$ 主要与[态密度](@entry_id:147894)（[谱函数](@entry_id:147628)）相关，而 $G^<$ 和 $G^>$ 则包含了关于粒子如何占据这些态的信息。特别地，**[小格林函数](@entry_id:141540) $G^<$** 的等时值给出了系统的[单粒子密度矩阵](@entry_id:201498) [@problem_id:2790677]：
$$
\rho_{ji}(t) = \langle c_i^{\dagger}(t) c_j(t) \rangle = -i G_{ji}^<(t,t)
$$
其对角元 $\rho_{ii}(t) = -iG_{ii}^<(t,t)$ 就是[轨道](@entry_id:137151) $i$ 上的电子布居数，而非对角元则描述了[轨道](@entry_id:137151)间的量子相干性。系统的总电子数就是 $N(t) = \sum_i \rho_{ii}(t) = -i \operatorname{Tr}[G^<(t,t)]$。在[非平衡稳态](@entry_id:141783)下，尽管有净电流流过分子，但分子上的总[电荷](@entry_id:275494)数 $N(t)$ 保持恒定，即流入的速率等于流出的速率。

在非平衡条件下，[小格林函数](@entry_id:141540)可以通过 Keldysh 方程计算 [@problem_id:2790635]：
$$
G^<(E) = G^r(E) \Sigma^<(E) G^a(E)
$$
其中，**小自能** $\Sigma^<(E)$ 描述了电极向分子注入电子的速率和能量[分布](@entry_id:182848)。对于非相互作用的电极，它由各电极的费米函数 $f_{\alpha}(E)$ 加权给出：
$$
\Sigma^<(E) = i \sum_{\alpha} f_{\alpha}(E)\Gamma_{\alpha}(E)
$$