{"hands_on_practices": [{"introduction": "本练习旨在揭示系统的记忆核与环境谱密度之间的基本联系，这一联系是由涨落-耗散定理决定的。通过对一个广泛使用的模型（即带有德鲁德截断的欧姆谱）进行直接计算，你将亲身体验其中涉及的数学技巧，并对浴的频率响应如何塑造系统的耗散记忆建立起具体的直觉。这项实践是理解开放系统动力学中记忆效应的经典起点 [@problem_id:2825430]。", "problem": "考虑一个经典粒子与一个谐振子浴线性耦合，产生一个具有因果摩擦记忆核的广义朗之万方程（GLE）。在具有线性耦合的标准系统-浴框架中，谱密度 $J(\\omega)$ 表征了浴模的耦合强度。在经典极限下，一个经过充分检验的来自涨落-耗散定理（FDT）的关系通过余弦变换将谱密度 $J(\\omega)$ 与因果摩擦记忆核 $\\gamma(t)$ 联系起来\n$$\n\\gamma(t)\\;=\\;\\frac{2}{\\pi}\\int_{0}^{\\infty}\\frac{J(\\omega)}{\\omega}\\,\\cos(\\omega t)\\,d\\omega,\\qquad t0.\n$$\n假设一个具有德鲁德（Drude）截断的欧姆谱密度，其形式为\n$$\nJ(\\omega)\\;=\\;\\frac{\\eta\\,\\omega\\,\\omega_{c}^{2}}{\\omega_{c}^{2}+\\omega^{2}},\n$$\n其中 $\\eta0$ 是一个摩擦尺度，$\\omega_{c}0$ 是截断频率。仅从上述定义和标准的复分析或积分变换知识出发，推导当 $t0$ 时因果记忆核 $\\gamma(t)$ 的显式形式。然后，分析马尔可夫极限 $\\omega_{c}\\to\\infty$，说明 $\\gamma(t)$ 如何趋近于一个集中在 $t=0$ 的分布，并解释这如何在时间和拉普拉斯域中恢复GLE中的无记忆摩擦。\n\n以 $\\eta$、$\\omega_{c}$ 和 $t$（对于 $t0$）的单个闭合形式解析表达式提供最终答案。不需要单位。不需要数值近似。", "solution": "所提出的问题是开放系统理论和非平衡统计力学中的一个标准且适定的练习。它具有科学依据，内容自洽，并需要严格的推导。我们将开始进行求解。\n\n首先，我们的任务是为一个具有德鲁德截断的欧姆谱密度的系统推导因果摩擦记忆核 $\\gamma(t)$ 的显式形式。\n\n已知条件是：\n$1$. 当 $t0$ 时，核 $\\gamma(t)$ 和谱密度 $J(\\omega)$ 之间的关系：\n$$ \\gamma(t) = \\frac{2}{\\pi}\\int_{0}^{\\infty}\\frac{J(\\omega)}{\\omega}\\,\\cos(\\omega t)\\,d\\omega $$\n$2$. 谱密度的形式：\n$$ J(\\omega) = \\frac{\\eta\\,\\omega\\,\\omega_{c}^{2}}{\\omega_{c}^{2}+\\omega^{2}} $$\n其中 $\\eta0$ 和 $\\omega_{c}0$ 是常数。\n\n我们将 $J(\\omega)$ 的表达式代入 $\\gamma(t)$ 的积分中。$J(\\omega)$ 分子中的因子 $\\omega$ 与被积函数分母中的 $\\omega$ 相抵消。\n$$ \\gamma(t) = \\frac{2}{\\pi}\\int_{0}^{\\infty} \\frac{1}{\\omega} \\left( \\frac{\\eta\\,\\omega\\,\\omega_{c}^{2}}{\\omega_{c}^{2}+\\omega^{2}} \\right) \\cos(\\omega t)\\,d\\omega $$\n$$ \\gamma(t) = \\frac{2\\eta\\omega_{c}^{2}}{\\pi} \\int_{0}^{\\infty} \\frac{\\cos(\\omega t)}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega $$\n该积分为一个标准的傅里叶余弦变换。我们可以使用复分析中的留数定理来计算它。被积函数是 $\\omega$ 的偶函数，所以我们可以写成：\n$$ \\int_{0}^{\\infty} \\frac{\\cos(\\omega t)}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega = \\frac{1}{2} \\int_{-\\infty}^{\\infty} \\frac{\\cos(\\omega t)}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega = \\frac{1}{2} \\text{Re} \\left[ \\int_{-\\infty}^{\\infty} \\frac{e^{i\\omega t}}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega \\right] $$\n考虑复积分 $\\oint_{C} \\frac{e^{izt}}{z^{2}+\\omega_{c}^{2}}\\,dz$。被积函数在 $z=\\pm i\\omega_{c}$ 处有简单极点。对于 $t0$，我们在上半平面闭合围道，包围位于 $z=i\\omega_{c}$ 的极点。根据若尔当引理，当半圆弧的半径趋于无穷大时，其上的积分消失。于是，沿实轴的积分等于 $2\\pi i$ 乘以所包围极点的留数。\n$$ \\text{Res}(z=i\\omega_{c}) = \\lim_{z \\to i\\omega_{c}} (z-i\\omega_{c})\\frac{e^{izt}}{(z-i\\omega_{c})(z+i\\omega_{c})} = \\frac{e^{i(i\\omega_{c})t}}{2i\\omega_{c}} = \\frac{e^{-\\omega_{c}t}}{2i\\omega_{c}} $$\n因此，沿实轴的积分为：\n$$ \\int_{-\\infty}^{\\infty} \\frac{e^{i\\omega t}}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega = 2\\pi i \\cdot \\text{Res}(z=i\\omega_{c}) = 2\\pi i \\left( \\frac{e^{-\\omega_{c}t}}{2i\\omega_{c}} \\right) = \\frac{\\pi}{\\omega_{c}} e^{-\\omega_{c}t} $$\n这个结果是纯实数，所以取实部是平凡的。从 $0$ 到 $\\infty$ 的原积分为该值的一半：\n$$ \\int_{0}^{\\infty} \\frac{\\cos(\\omega t)}{\\omega_{c}^{2}+\\omega^{2}}\\,d\\omega = \\frac{1}{2} \\left( \\frac{\\pi}{\\omega_{c}} e^{-\\omega_{c}t} \\right) = \\frac{\\pi}{2\\omega_{c}} e^{-\\omega_{c}t} $$\n将此结果代回我们关于 $\\gamma(t)$ 的表达式：\n$$ \\gamma(t) = \\frac{2\\eta\\omega_{c}^{2}}{\\pi} \\left( \\frac{\\pi}{2\\omega_{c}} e^{-\\omega_{c}t} \\right) = \\eta\\omega_{c} e^{-\\omega_{c}t} $$\n这就是当 $t0$ 时记忆核的显式形式。\n\n接下来，我们分析马尔可夫极限，它对应于一个无限快的浴，即 $\\omega_{c} \\to \\infty$。核的记忆时间量级为 $1/\\omega_{c}$。\n记忆核变为 $\\gamma(t) = \\eta\\omega_{c}e^{-\\omega_{c}t}$。\n对于任何固定的时间 $t0$，极限为：\n$$ \\lim_{\\omega_{c}\\to\\infty} \\gamma(t) = \\lim_{\\omega_{c}\\to\\infty} \\eta\\omega_{c}e^{-\\omega_{c}t} = 0 $$\n因为指数衰减项支配了线性因子。\n在 $t=0$ 处，$\\gamma(0) = \\eta\\omega_{c}$，当 $\\omega_{c}\\to\\infty$ 时发散。\n因此，该函数在 $t=0$ 处变得无限尖锐和无限高，而在所有 $t0$ 处为零。这是狄拉克δ分布的特征。为确定该分布的强度，我们计算核在其定义域上的积分：\n$$ \\int_{0}^{\\infty} \\gamma(t)\\,dt = \\int_{0}^{\\infty} \\eta\\omega_{c}e^{-\\omega_{c}t}\\,dt = \\eta\\omega_{c} \\left[ -\\frac{1}{\\omega_{c}} e^{-\\omega_{c}t} \\right]_{0}^{\\infty} = \\eta\\omega_{c} \\left( 0 - \\left(-\\frac{1}{\\omega_{c}}\\right) \\right) = \\eta $$\n函数 $\\gamma(t)$ 的积分为 $\\eta$，与 $\\omega_{c}$ 无关。一个在原点处无限尖峰、在别处为零且保持常数积分的函数序列代表一个δ分布。因此，在分布的意义上：\n$$ \\lim_{\\omega_{c}\\to\\infty} \\gamma(t) = \\eta \\delta(t) $$\n此处，$\\delta(t)$ 是狄拉克δ函数，在因果系统中理解为其支撑集集中在 $t=0^{+}$。\n\n我们现在演示这个极限如何在广义朗之万方程（GLE）中恢复无记忆摩擦。GLE中的摩擦项由卷积积分 $-\\int_{0}^{t} \\gamma(t-\\tau)v(\\tau)\\,d\\tau$ 给出，其中 $v(t)$ 是粒子的速度。\n在马尔可夫极限下，该项变为：\n$$ -\\int_{0}^{t} \\left( \\lim_{\\omega_{c}\\to\\infty} \\gamma(t-\\tau) \\right) v(\\tau)\\,d\\tau = -\\int_{0}^{t} \\eta\\delta(t-\\tau)v(\\tau)\\,d\\tau $$\n根据δ函数的筛选性质，其中尖峰位于 $\\tau=t$（积分上限），对于因果系统，该积分的计算结果为：\n$$ -\\eta v(t) $$\n摩擦项因此变得与瞬时速度成正比，这就是无记忆或马尔可夫摩擦的定义。摩擦系数为 $\\eta$。\n\n这个结果可以在拉普拉斯域中得到证实。记忆核的拉普拉斯变换 $\\tilde{\\gamma}(s) = \\mathcal{L}\\{\\gamma(t)\\}$ 为：\n$$ \\tilde{\\gamma}(s) = \\int_{0}^{\\infty} e^{-st} (\\eta\\omega_{c}e^{-\\omega_{c}t})\\,dt = \\eta\\omega_{c} \\int_{0}^{\\infty} e^{-(s+\\omega_{c})t}\\,dt = \\frac{\\eta\\omega_{c}}{s+\\omega_{c}} $$\n现在，我们取马尔可夫极限 $\\omega_{c}\\to\\infty$：\n$$ \\lim_{\\omega_{c}\\to\\infty} \\tilde{\\gamma}(s) = \\lim_{\\omega_{c}\\to\\infty} \\frac{\\eta\\omega_{c}}{s+\\omega_{c}} = \\lim_{\\omega_{c}\\to\\infty} \\frac{\\eta}{(s/\\omega_{c})+1} = \\eta $$\nGLE中摩擦项的拉普拉斯变换是 $-\\tilde{\\gamma}(s)\\tilde{v}(s)$。在极限情况下，这变为 $-\\eta\\tilde{v}(s)$。该项的拉普拉斯逆变换是 $-\\eta v(t)$，这再次证实了摩擦变为无记忆的，且系数为 $\\eta$。时间域和拉普拉斯域分析之间的一致性证实了我们结论的正确性。一个典型的混淆点源于通过涨落-耗散定理将因果核与对称化噪声相关函数联系起来时产生的因子2问题，但如上所示，仔细且一致地应用数学定义可以解决任何明显的悖论。", "answer": "$$\\boxed{\\eta\\,\\omega_{c}\\,\\exp(-\\omega_{c}\\,t)}$$", "id": "2825430"}, {"introduction": "在森-Zwanzig形式理论中，“记忆”并非系统的内在属性，而是将完整动力学投影到一组较小的“相关”变量上所产生的结果。本练习旨在将这一抽象概念具体化。你将需要把该理论应用于一个简单的谐振子，并展示如何通过扩展相关变量集来使记忆效应完全消失。这项实践有助于阐明变量选择在定义记忆核及其性质中的关键作用 [@problem_id:2825473]。", "problem": "考虑一个模拟单分子振动模式的经典一维谐振子，其哈密顿量为 $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} q^{2}$，与温度为 $T$ 的正则热浴接触。令平衡平均值用 $\\langle \\cdot \\rangle_{\\mathrm{eq}}$ 表示，涨落定义为 $\\delta A = A - \\langle A \\rangle_{\\mathrm{eq}}$。使用内积 $(A,B) = \\langle \\delta A \\, \\delta B \\rangle_{\\mathrm{eq}}$。\n\n1) 从微观变量集 $\\{q, p\\}$ 出发，通过关于内积 $(\\cdot,\\cdot)$ 的 Gram–Schmidt 标准正交化，构建一个标准正交相关变量集 $\\{A_{1}, A_{2}\\}$。\n\n2) 使用 Mori–Zwanzig (MZ) 投影算符形式理论和广义朗之万方程 (GLE)，其中 Liouville 算符 $i \\mathcal{L}$（通过经典泊松括号定义）以及向由 $A_{1}$ 张成的一维子空间的投影，从第一性原理推导 $t=0$ 时记忆核的表达式，即 $M(0)$，用 $i \\mathcal{L}$ 和平衡平均值表示。然后，用 $m$、$\\omega$、$k_{B}$（玻尔兹曼常数）和 $T$ 显式计算该系统的 $M(0)$。\n\n3) 简要论证将相关变量集从 $\\{A_{1}\\}$ 扩展到 $\\{A_{1}, A_{2}\\}$ 如何改变记忆核的短时行为。\n\n最终答案请提供单个无量纲量 $M(0)/\\omega^{2}$。不需要进行数值计算，最终答案是无量纲的，因此不需要单位。", "solution": "该问题经确认是自洽的、有科学依据且良定的。解题过程如下。\n\n首先，我们为处于温度为 $T$ 的正则系综中的经典一维谐振子建立必要的平衡平均值。哈密顿量为 $H = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 q^2$。相空间中的概率分布与 $\\exp(-\\beta H)$ 成正比，其中 $\\beta = 1/(k_B T)$。由于哈密顿量是二次形式，势能是 $q$ 的偶函数，动能是 $p$ 的偶函数。因此，$q$ 或 $p$ 的任何奇数次幂的平均值均为零。\n$$ \\langle q \\rangle_{\\mathrm{eq}} = 0, \\quad \\langle p \\rangle_{\\mathrm{eq}} = 0 $$\n因此，涨落与变量本身相同：$\\delta q = q$ 和 $\\delta p = p$。\n根据能量均分定理，我们有：\n$$ \\left\\langle \\frac{1}{2} m \\omega^2 q^2 \\right\\rangle_{\\mathrm{eq}} = \\frac{1}{2} k_B T \\implies \\langle q^2 \\rangle_{\\mathrm{eq}} = \\frac{k_B T}{m \\omega^2} $$\n$$ \\left\\langle \\frac{p^2}{2m} \\right\\rangle_{\\mathrm{eq}} = \\frac{1}{2} k_B T \\implies \\langle p^2 \\rangle_{\\mathrm{eq}} = m k_B T $$\n由于哈密顿量在 $q$ 和 $p$ 上是可分离的，互相关为零：\n$$ \\langle q p \\rangle_{\\mathrm{eq}} = \\frac{\\iint qp \\, \\exp(-\\beta H) \\, dq \\, dp}{\\iint \\exp(-\\beta H) \\, dq \\, dp} = 0 $$\n对于 $q$ 和 $p$ 的线性组合，内积 $(A, B) = \\langle \\delta A \\, \\delta B \\rangle_{\\mathrm{eq}}$ 简化为 $(A, B) = \\langle A B \\rangle_{\\mathrm{eq}}$。\n\n1) 构建标准正交集 $\\{A_1, A_2\\}$。\n我们对集合 $\\{q, p\\}$ 应用 Gram-Schmidt 过程。\n首先，选择变量 $v_1 = q$。其范数的平方为：\n$$ (v_1, v_1) = (q, q) = \\langle q^2 \\rangle_{\\mathrm{eq}} = \\frac{k_B T}{m \\omega^2} $$\n第一个标准正交变量 $A_1$ 通过归一化得到：\n$$ A_1 = \\frac{v_1}{\\sqrt{(v_1, v_1)}} = \\frac{q}{\\sqrt{\\langle q^2 \\rangle_{\\mathrm{eq}}}} = q \\sqrt{\\frac{m \\omega^2}{k_B T}} $$\n接下来，选择变量 $v_2 = p$。我们找到 $v_2$ 与 $A_1$ 正交的分量。由于变量 $q$ 和 $p$ 已经正交，$(v_1, v_2) = (q, p) = \\langle qp \\rangle_{\\mathrm{eq}} = 0$，所以正交化步骤是平凡的。我们只需要对 $v_2$ 进行归一化。$v_2$ 的范数的平方为：\n$$ (v_2, v_2) = (p, p) = \\langle p^2 \\rangle_{\\mathrm{eq}} = m k_B T $$\n第二个标准正交变量 $A_2$ 是：\n$$ A_2 = \\frac{v_2}{\\sqrt{(v_2, v_2)}} = \\frac{p}{\\sqrt{\\langle p^2 \\rangle_{\\mathrm{eq}}}} = \\frac{p}{\\sqrt{m k_B T}} $$\n因此，标准正交集为 $\\{A_1, A_2\\} = \\left\\{ q \\sqrt{\\frac{m \\omega^2}{k_B T}}, \\frac{p}{\\sqrt{m k_B T}} \\right\\}$。\n\n2) 记忆核 $M(0)$ 的推导与计算。\nMori-Zwanzig 形式理论为相关变量（此处取为 $A_1$）提供了一个广义朗之万方程。动力学通过投影算符 $\\mathcal{P}$ 投影到由 $A_1$ 张成的子空间上：\n$$ \\mathcal{P} X = \\frac{(A_1, X)}{(A_1, A_1)} A_1 = (A_1, X) A_1 $$\n其中第二个等式成立是因为 $A_1$ 是归一化的。互补投影为 $\\mathcal{Q} = 1 - \\mathcal{P}$。记忆核 $M(t)$ 通过随机力 $F(t) = \\exp(i\\mathcal{Q}\\mathcal{L}t) i\\mathcal{Q}\\mathcal{L}A_1$ 的自相关来定义：\n$$ M(t) = \\frac{(F(t), F(0))}{(A_1, A_1)} = (F(0), e^{-i\\mathcal{Q}\\mathcal{L}t} F(0)) $$\n这里我们利用了传播子在内积下的自伴性。在时间 $t=0$ 时，这给出：\n$$ M(0) = (F(0), F(0)) = (i\\mathcal{Q}\\mathcal{L}A_1, i\\mathcal{Q}\\mathcal{L}A_1) $$\n使用 $\\mathcal{Q} = 1 - \\mathcal{P}$ 并展开，我们得到 $M(0)$ 关于 Liouville 算符 $i\\mathcal{L}$ 和平衡平均值（内积）的一般表达式：\n$$ M(0) = (i\\mathcal{L}A_1 - \\mathcal{P}(i\\mathcal{L}A_1), i\\mathcal{L}A_1 - \\mathcal{P}(i\\mathcal{L}A_1)) = (i\\mathcal{L}A_1, i\\mathcal{L}A_1) - ((A_1, i\\mathcal{L}A_1)A_1, i\\mathcal{L}A_1) - (i\\mathcal{L}A_1, (A_1, i\\mathcal{L}A_1)A_1) + ((A_1, i\\mathcal{L}A_1)A_1, (A_1, i\\mathcal{L}A_1)A_1) $$\n$$ M(0) = (i\\mathcal{L}A_1, i\\mathcal{L}A_1) - (A_1, i\\mathcal{L}A_1)^2 - (A_1, i\\mathcal{L}A_1)^2 + (A_1, i\\mathcal{L}A_1)^2(A_1, A_1) $$\n由于 $(A_1, A_1) = 1$，这简化为：\n$$ M(0) = (i\\mathcal{L}A_1, i\\mathcal{L}A_1) - (A_1, i\\mathcal{L}A_1)^2 $$\n按要求，该表达式将 $M(0)$ 与 Liouville 算符和平衡平均值联系起来。\n\n为了对我们的系统计算这个表达式，我们首先计算 $i\\mathcal{L}$ 对 $A_1$ 的作用。算符 $i\\mathcal{L}$ 的作用相当于与哈密顿量的泊松括号，即 $i\\mathcal{L}X = \\{X, H\\}$。\n$$ i\\mathcal{L}A_1 = \\{A_1, H\\} = \\left\\{q \\sqrt{\\frac{m \\omega^2}{k_B T}}, \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 q^2\\right\\} = \\sqrt{\\frac{m \\omega^2}{k_B T}} \\{q, H\\} $$\n$$ \\{q, H\\} = \\frac{\\partial q}{\\partial q}\\frac{\\partial H}{\\partial p} - \\frac{\\partial q}{\\partial p}\\frac{\\partial H}{\\partial q} = 1 \\cdot \\frac{p}{m} - 0 = \\frac{p}{m} $$\n所以，\n$$ i\\mathcal{L}A_1 = \\sqrt{\\frac{m \\omega^2}{k_B T}} \\left(\\frac{p}{m}\\right) = p \\sqrt{\\frac{\\omega^2}{m k_B T}} $$\n使用定义 $A_2 = p/\\sqrt{m k_B T}$，我们发现一个简洁的关系：\n$$ i\\mathcal{L}A_1 = \\omega A_2 $$\n现在我们计算 $M(0)$ 表达式中的两项：\n$$ (A_1, i\\mathcal{L}A_1) = (A_1, \\omega A_2) = \\omega (A_1, A_2) = 0 $$\n这是频率项 $i\\Omega_{11}$，其值为零。\n$$ (i\\mathcal{L}A_1, i\\mathcal{L}A_1) = (\\omega A_2, \\omega A_2) = \\omega^2 (A_2, A_2) = \\omega^2 $$\n因为 $A_2$ 是归一化的。将这些代入 $M(0)$ 的公式中：\n$$ M(0) = \\omega^2 - 0^2 = \\omega^2 $$\n\n3) 通过扩展相关变量集对记忆核的修正。\n记忆核源于投影到相关变量集正交子空间上的动力学。对于单变量集 $\\{A_1\\}$，正交子空间包含 $A_2$。由 $i\\mathcal{L}A_1 = \\omega A_2$ 给出的 $A_1$ 的时间演化完全指向这个正交子空间。这个“正交通量” $i\\mathcal{Q}\\mathcal{L}A_1 = i\\mathcal{L}A_1$ 是记忆效应的来源，其初始大小的平方给出 $M(0) = \\omega^2$。\n\n当相关变量集扩展到 $\\{A_1, A_2\\}$ 时，投影算符变为 $\\mathcal{P}_{12} = (A_1, \\cdot)A_1 + (A_2, \\cdot)A_2$，正交投影算符为 $\\mathcal{Q}_{12} = 1 - \\mathcal{P}_{12}$。集合中变量的动力学由 Liouville 算符描述。我们有 $i\\mathcal{L}A_1 = \\omega A_2$。我们还计算 $i\\mathcal{L}A_2$：\n$$ i\\mathcal{L}A_2 = \\{A_2, H\\} = \\left\\{\\frac{p}{\\sqrt{m k_B T}}, H\\right\\} = \\frac{1}{\\sqrt{m k_B T}} \\{p, H\\} $$\n$$ \\{p, H\\} = \\frac{\\partial p}{\\partial q}\\frac{\\partial H}{\\partial p} - \\frac{\\partial p}{\\partial p}\\frac{\\partial H}{\\partial q} = 0 - 1 \\cdot (m\\omega^2 q) = -m\\omega^2 q $$\n$$ i\\mathcal{L}A_2 = \\frac{-m\\omega^2 q}{\\sqrt{m k_B T}} = -\\omega \\left( q \\sqrt{\\frac{m\\omega^2}{k_B T}} \\right) = -\\omega A_1 $$\n在 $i\\mathcal{L}$ 作用下，$A_1$ 和 $A_2$ 的时间演化产生的向量都保持在 $\\{A_1, A_2\\}$ 的张成空间内。这意味着集合 $\\{A_1, A_2\\}$ 在 Liouville 算符的作用下是封闭的。\n因此，时间导数在正交子空间上的投影为零：\n$$ i\\mathcal{Q}_{12}\\mathcal{L}A_1 = (1-\\mathcal{P}_{12})(\\omega A_2) = \\omega A_2 - ((A_1, \\omega A_2)A_1 + (A_2, \\omega A_2)A_2) = \\omega A_2 - (0 \\cdot A_1 + \\omega \\cdot A_2) = 0 $$\n$$ i\\mathcal{Q}_{12}\\mathcal{L}A_2 = (1-\\mathcal{P}_{12})(-\\omega A_1) = -\\omega A_1 - ((A_1, -\\omega A_1)A_1 + (A_2, -\\omega A_1)A_2) = -\\omega A_1 - (-\\omega \\cdot A_1 + 0 \\cdot A_2) = 0 $$\n由于随机力分量 $F_1(t)$ 和 $F_2(t)$ 由这些项生成，它们在所有时间上都恒等于零。这意味着双变量系统的整个记忆核矩阵 $\\mathbf{M}(t)$ 为零。特别地，元素 $M_{11}(0)$，即第一种情况下标量核的类似物，为零。\n因此，将相关变量集从 $\\{A_1\\}$ 扩展到 $\\{A_1, A_2\\}$ 会将与 $A_1$ 相关的记忆核的初始值从 $M(0) = \\omega^2$ 减小到 $M_{11}(0) = 0$。包含动量变量完全捕捉了短时（实际上是全时）动力学，没有留下任何来自正交浴的“记忆”效应。\n\n所要求的最终答案是无量纲量 $M(0)/\\omega^2$，其中 $M(0)$ 是第 2 部分中一维投影得到的核。\n$$ \\frac{M(0)}{\\omega^2} = \\frac{\\omega^2}{\\omega^2} = 1 $$", "answer": "$$\\boxed{1}$$", "id": "2825473"}, {"introduction": "从解析模型转向真实数据，本练习将探讨如何直接从分子模拟轨迹中构建非参数化的记忆核。它挑战你像计算科学家一样思考，评估各种现代机器学习策略来解决这个复杂的反问题。这里的关键不仅在于找到一个能够拟合数据的方法，更在于要严格遵循因果性、对称性和涨落-耗散定理等基本物理约束 [@problem_id:2825475]。", "problem": "给定从温度为 $T$ 的原子分子动力学模拟中收集的一组粗粒度变量的平衡轨迹数据。设粗粒度变量为在平衡态下均值为零的 $d$ 维向量过程 $X(t)\\in\\mathbb{R}^d$，并令 $C(t)=\\langle X(t)X(0)^\\top\\rangle\\in\\mathbb{R}^{d\\times d}$ 表示在均匀网格 $t_n=n\\Delta t$（$n=0,\\dots,N$）上估计的矩阵值时间相关函数。假设在平衡态下，线性投影描述是合适的，并且涨落-耗散定理（FDT）适用于有效的粗粒度动力学。您的任务是确定一种机器学习策略，该策略能将经验时间相关矩阵 $\\{C(t_n)\\}_{n=0}^N$ 映射到一个非参数的矩阵值记忆核 $K(t)\\in\\mathbb{R}^{d\\times d}$，该记忆核是因果的、与FDT一致且物理上可接受的（对称性、相关噪声协方差的半正定性以及稳定性）。\n\n对于一般的 $d\\ge 1$，哪个选项能最好地从第一性原理出发满足以下所有条件：\n\n- $K(t)$ 在 $t\\ge 0$ 上的非参数表示，允许灵活的时间结构，而不强加低维参数形式。\n- 一个与数据一致的目标函数，通过主导的投影线性动力学将 $K(t)$ 与观测到的 $\\{C(t)\\}$ 联系起来。\n- 精确执行FDT约束，该约束将有色噪声协方差与 $K(t)$ 对所有 $t\\ge 0$ 关联起来。\n- 矩阵值的物理约束：因果性（$K(t)=0$ 对于 $t0$），在适当宇称下的Onsager对称性（$K(t)=K(t)^\\top$），以及所蕴含的平稳噪声协方差函数的半正定性。\n- 对采样噪声的数值鲁棒性，适用于 $d1$ 的情况，并使用交叉验证进行正则化。\n\n选择最合适的方法。\n\nA. 对标量核 $K(t)$ 设置一个高斯过程先验，其协方差是完全单调的（例如，指数函数的非负混合），以确保在 $t\\ge 0$ 上的非负性。通过一个惩罚模型推断的相关性与观测值不匹配的似然函数，使用观测到的 $\\{C(t)\\}$ 最大化边缘似然来拟合超参数。通过将标量噪声协方差 $H(t)$ 设置为等于 $k_{\\mathrm{B}}T K(t)$ 来强制执行FDT。该方法侧重于单个粗粒度变量，并通过对 $X(t)$ 的每个分量分别拟合独立的标量核来扩展到 $d1$ 的情况。\n\nB. 通过最小化预测相关性和经验相关性的傅里叶变换之间的差异来训练一个无约束的神经网络 $K_\\theta(t)$，在频域中解决一个反卷积问题。使用整流线性单元逐点强制 $K_\\theta(t)\\ge 0$，并用一个单独的神经网络学习有色噪声协方差 $H_\\phi(t)$。为了避免偏差，不在 $H_\\phi(t)$ 和 $K_\\theta(t)$ 之间施加任何进一步的关系。\n\nC. 在拉普拉斯或傅里叶域中工作，使用一个将 $\\tilde{K}(\\omega)$ 表示为 $\\tilde{C}(\\omega)$ 与其逆的乘积的代数恒等式，通过线性回归从经验的 $\\tilde{C}(\\omega)$ 直接估计 $\\tilde{K}(\\omega)$。使用Tikhonov罚项进行正则化，并通过将 $\\tilde{K}(\\omega)$ 的实部裁剪为非负来强制稳定性。将噪声近似处理为白噪声，其方差与 $K(0)$ 匹配，以在 $t=0$ 时与FDT保持一致。\n\nD. 为一个在 $t\\in[0,T]$ 上的矩阵值因果核 $K(t)=\\sum_{j=1}^M \\Theta_j \\,\\varphi_j(t)$ 提出一个变分学习问题，其中 $\\{\\varphi_j(t)\\}_{j=1}^M$ 是在 $[0,\\infty)$ 上的非负紧支集基函数（例如，B样条），而 $\\Theta_j\\in\\mathbb{R}^{d\\times d}$ 是待学习的对称系数。定义一个物理约束的损失函数，该函数测量经验相关性与由投影线性动力学（在 $\\{t_n\\}$ 上离散化）推断的相关性之间的残差的 $L^2$ 范数。通过将有色噪声协方差 $H(t)$ 等同于 $k_{\\mathrm{B}}T\\,K(t)$ 来精确执行FDT，并通过以下方式施加物理可接受性：（i）约束每个 $\\Theta_j$ 是对称的，（ii）通过基函数将支撑域限制在 $t\\ge 0$ 以实现因果性，以及（iii）要求由 $H(t_n)=k_{\\mathrm{B}}T\\,K(t_n)$ 的样本构建的块托普利茨矩阵是半正定的，这保证了有效的平稳协方差。求解由此产生的带有半定约束的凸规划问题，并对 $\\{\\Theta_j\\}$ 包含粗糙度罚项，通过交叉验证来控制方差。在 $[0,T]$ 上非参数地输出 $K(t)$，并在需要时通过基函数外插谨慎地扩展到 $T$ 之外。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取给定条件**\n- **系统**：来自原子分子动力学模拟的平衡轨迹数据。\n- **温度**：$T$。\n- **变量**：一个$d$维粗粒度变量的向量过程，$X(t)\\in\\mathbb{R}^d$。\n- **平衡性质**：该过程均值为零，$\\langle X(t) \\rangle = 0$。\n- **输入数据**：在离散均匀网格 $t_n=n\\Delta t$（$n=0, \\dots, N$）上估计的矩阵值时间相关函数 $C(t)=\\langle X(t)X(0)^\\top\\rangle\\in\\mathbb{R}^{d\\times d}$。\n- **模型假设**：动力学的线性投影描述是合适的。\n- **物理约束**：涨落-耗散定理（FDT）适用。\n- **目标**：确定一种机器学习策略，从经验数据 $\\{C(t_n)\\}_{n=0}^N$ 中确定一个非参数的矩阵值记忆核 $K(t)\\in\\mathbb{R}^{d\\times d}$。\n- **解的所需属性**：\n    1.  对于 $t \\ge 0$，$K(t)$ 必须是非参数的。\n    2.  该方法必须采用一个与数据一致的目标函数，将 $K(t)$ 与 $\\{C(t_n)\\}$ 联系起来。\n    3.  对于所有 $t \\ge 0$，必须精确执行FDT约束。\n    4.  必须满足物理可接受性约束：\n        - 因果性：$K(t)=0$ 对于 $t0$。\n        - 对称性：$K(t)=K(t)^\\top$。\n        - 相关平稳噪声协方差函数的半正定性。\n        - 动力学的稳定性。\n    5.  该方法必须数值鲁棒，适用于 $d1$，并包含正则化。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在统计力学，特别是Mori-Zwanzig投影算符方法论的背景下是良定义的。该方法论为推导一组粗粒度变量的运动方程提供了理论基础。\n\n- **科学依据**：该问题在科学上是合理的。它解决了从分子动力学数据中参数化广义朗之万方程（GLE）的核心任务。时间相关函数、记忆核和涨落-耗散定理的概念是非平衡统计力学和理论化学中的基本原理。\n- **良定性与客观性**：该问题使用精确的术语进行了客观陈述。目标是根据一组清晰而严格的物理和数学约束来评估不同的计算策略。解的存在性与找到一个满足所有列出标准的方法相关联。\n- **完整性**：该问题提供了足够的信息来进行分析。它指定了输入（$C(t)$）、期望的输出（$K(t)$）、主导的物理背景（投影线性动力学，FDT）以及解必须满足的全面约束列表。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。这是计算理论化学中一个合法的、非平凡的问题。我将继续进行选项的推导和评估。\n\n**理论框架**\n在线性投影框架内，粗粒度变量 $X(t)$ 的动力学由广义朗之万方程（GLE）描述。对于一组具有确定时间反演宇称的变量，GLE的形式为：\n$$\n\\frac{d}{dt}X(t) = - \\int_0^t K(t-s) C(0)^{-1} X(s) \\, ds + R(t)\n$$\n其中 $C(0) = \\langle X(0)X(0)^\\top \\rangle$ 是静态相关矩阵，$K(t)$ 是记忆核，$R(t)$ 是投影（有色）噪声。噪声与初始状态正交，$\\langle R(t)X(0)^\\top \\rangle = 0$。\n\n第二类涨落-耗散定理（FDT）提供了记忆核与噪声相关性之间的基本联系：\n$$\n\\langle R(t)R(s)^\\top \\rangle = k_{\\mathrm{B}}T K(|t-s|) = H(|t-s|)\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$H(t)$ 是平稳噪声协方差函数。\n\n将GLE乘以 $X(0)^\\top$ 并取系综平均，我们得到时间相关函数 $C(t)$ 的主导积分-微分方程：\n$$\n\\frac{d}{dt}C(t) = - \\int_0^t K(t-s) C(0)^{-1} C(s) \\, ds \\quad \\text{for } t  0\n$$\n这是一个矩阵值的第二类Volterra方程。任务是解决逆问题：给定 $C(t)$ 的带噪声样本，找到一个物理上可接受的 $K(t)$。\n\n物理可接受性约束至关重要：\n1.  **因果性**：$K(t)=0$ 对于 $t0$。这在GLE的积分上限中是明确的。\n2.  **对称性**：$K(t)=K(t)^\\top$。这是Onsager对于具有相同时间反演宇称的变量的互易关系的结果。\n3.  **噪声协方差的半正定性**：平稳协方差函数 $H(t) = k_{\\mathrm{B}}T K(t)$ 必须是一个半正定函数。这意味着对于任意一组时间点 $t_1, \\dots, t_M$ 和任意一组向量 $v_1, \\dots, v_M \\in \\mathbb{R}^d$，以下必须成立：\n    $$\n    \\sum_{i=1}^M \\sum_{j=1}^M v_i^\\top H(t_i - t_j) v_j \\ge 0\n    $$\n    这等效于要求第 $(i,j)$ 个块元素为 $H(t_i - t_j)$ 的块矩阵是半正定的。对于一个有效的平稳过程，这必须成立。\n\n我们现在根据这些原则和要求评估每个选项。\n\n**逐项分析选项**\n\n**A. 对标量核的高斯过程（GP）**\n该方法建议使用GP来建模一个*标量*函数 $K(t)$。它通过为每个分量拟合独立的标量核来扩展到矩阵情况。\n- **批判1（对称性）**：如果为每个矩阵元素 $(i,j)$ 独立地拟合一个标量GP $K_{ij}(t)$，就没有机制来强制执行关键的对称性约束 $K_{ij}(t) = K_{ji}(t)$。该模型将具有两倍于必要的自由度，并会违反一个基本的物理原理。如果它假设 $K(t)$ 是对角的，它就做出了一个严重简化的物理假设，即粗粒度变量的动力学是解耦的，这在一般情况下是不正确的。\n- **批判2（半正定性）**：主要缺陷在于对FDT和噪声协方差的处理。尽管断言了FDT关系 $H(t)=k_{\\mathrm{B}}T K(t)$，但该方法没有提供任何手段来确保所得到的*矩阵值*协方差函数 $H(t)$ 是半正定的。确保每个对角元素 $K_{ii}(t)$ 是非负的（或完全单调的）并不能保证 $H(t_n)$ 的完整块托普利茨矩阵是半正定的。这个约束将 $K(t)$ 矩阵的所有元素在时间上耦合起来，这是该方法完全忽略的结构。\n- **结论**：所提出的对 $d1$ 的扩展在物理上是不合理的，并且未能强制执行对称性和半正定性的矩阵结构约束。**不正确**。\n\n**B. 无约束的神经网络**\n该方法使用两个独立的神经网络来学习 $K(t)$ 和噪声协方差 $H(t)$。\n- **批判1（涨落-耗散定理）**：提议“为了避免偏差，不在 $H_\\phi(t)$ 和 $K_\\theta(t)$ 之间施加任何进一步的关系”是直接且致命地违反了问题陈述中强制执行FDT的要求。FDT，$H(t) = k_B T K(t)$，不是“偏差”；它是统计物理学的基本定律，任何有效的粗粒度模型在平衡态下都必须满足。将耗散（$K(t)$）与涨落（$H(t)$）解耦是根本错误的。\n- **批判2（物理约束）**：使用“无约束”的神经网络未能施加对称性（$K(t)=K(t)^\\top$）。建议使用逐点的ReLU激活来强制 $K_\\theta(t) \\ge 0$ 对于矩阵来说是定义不当的，并且不能强制半正定性。因果性也未被自然地纳入。这种方法是机器学习的一种幼稚应用，完全无视了问题的物理性质。\n- **结论**：该选项通过明确违反FDT，显示出对底层物理的深刻误解。**不正确**。\n\n**C. 在频域/拉普拉斯域中直接反卷积**\n该方法建议在频域中代数求解核函数。根据拉普拉斯域中的Volterra方程，可以写出 $\\tilde{K}(s) = -[s\\tilde{C}(s) - C(0)] \\tilde{C}(s)^{-1} C(0)$。\n- **批判1（FDT执行）**：该选项明确指出“将噪声近似处理为白噪声，其方差与 $K(0)$ 匹配”。这是马尔可夫近似。保留记忆核 $K(t)$ 的全部目的就是为了描述非马尔可夫（有色噪声）效应。将噪声近似为白噪声，$H(t) \\propto \\delta(t)$，等同于设置 $K(t) \\propto \\delta(t)$，这与寻找一个具有灵活时间结构的非参数核的目标相矛盾。这违反了为所有 $t \\ge 0$ 精确执行FDT的要求。\n- **批判2（数值稳定性）**：反卷积本质上是一个不适定问题。该操作需要对矩阵 $\\tilde{C}(\\omega)$ 求逆，其行列式可能在某些频率下趋近于零，导致对经验 $C(t)$ 数据中的噪声极为敏感。虽然Tikhonov正则化有帮助，但通常提供的控制不足。\n- **批判3（半正定性）**：所提议的检查，“裁剪 $\\tilde{K}(\\omega)$ 的实部”，与长期动力学的稳定性有关，但不足以保证噪声协方差函数 $H(t)=k_{\\mathrm{B}}T K(t)$ 是半正定的，这是一个函数在其整个域上的全局属性。\n- **结论**：这种方法未能正确实现有色噪声的FDT，并依赖于一个数值不稳定的过程。它不是一个鲁棒的方法。**不正确**。\n\n**D. 使用基函数和半定约束的变分学习**\n该选项将问题框架化为一个凸优化问题。核函数表示为基函数的线性组合，$K(t)=\\sum_{j=1}^M \\Theta_j \\,\\varphi_j(t)$。\n- **非参数表示**：使用基函数集（如B样条）提供了一个灵活的非参数表示，其丰富性可以通过基函数的数量 $M$ 来控制。这满足了第一个要求。\n- **与数据一致的目标函数**：损失函数通过最小化经验相关性与Volterra方程预测的相关性之间的残差，直接将模型 $K(t)$ 与数据 $C(t)$ 通过正确的支配动力学联系起来。这是拟合动态模型的标准且鲁棒的方法。\n- **FDT执行**：该方法正确地将噪声协方差确定为 $H(t) = k_{\\mathrm{B}}T K(t)$，因此通过构造精确地执行了FDT。\n- **物理可接受性**：这是该提议中最严谨的部分。\n    - **因果性**：通过选择在 $t0$ 时为零的基函数 $\\varphi_j(t)$，因果性通过构造被内置到 $K(t)$ 的拟设中。\n    - **对称性**：约束每个系数矩阵 $\\Theta_j$ 为对称，确保了 $K(t)$ 对所有 $t$ 都是对称的。\n    - **半正定性**：该方法正确地确定了一个有效的离散时间平稳噪声过程的充要条件：由样本 $H(t_n) = k_{\\mathrm{B}}T K(t_n)$ 形成的块托普利茨矩阵必须是半正定的。由于 $K(t_n)$ 在系数 $\\{\\Theta_j\\}$ 上是线性的，这个约束是一个线性矩阵不等式（LMI）。\n- **数值鲁棒性**：整个问题被表述为一个凸优化问题（具体来说，是一个半定规划，或SDP），即在满足线性和半定约束的条件下最小化一个二次损失。凸规划问题有一个唯一的全局最小值，并且可以用现代求解器高效求解。对 $\\{\\Theta_j\\}$ 包含粗糙度罚项并使用交叉验证是正则化问题和防止过拟合的正确方法。\n- **结论**：该选项正确地识别了所有的物理和数值要求，并提出了一个全面、严谨且计算上可行的框架来满足它们。它正确地处理了矩阵结构、FDT、因果性以及微妙的半正定性约束。它代表了这类问题的最新技术水平。**正确**。", "answer": "$$\\boxed{D}$$", "id": "2825475"}]}