{"hands_on_practices": [{"introduction": "变分量子本征求解器（VQE）算法的核心在于估算哈密顿量的期望值，即 $\\langle H \\rangle = \\sum_i c_i \\langle P_i \\rangle$。一个关键的实际挑战是有效测量构成哈密顿量的众多泡利算符串。本练习探讨了一种旨在减少所需量子电路数量的基本优化策略——测量分组。通过在一个简单的双量子比特系统上应用此技术，您将学会如何识别并利用泡利算符之间的对易性来最小化实验资源。", "problem": "在变分量子本征求解器 (VQE) 中，参数化态 $\\rho(\\boldsymbol{\\theta})$ 关于分子电子哈密顿量 $H$ 的能量被计算为泡利算符张量积的期望值之和。一个测量设置被定义为对每个量子比特选择单一的局域测量轴，由张量积 $\\bigotimes_{i=0}^{n-1} P_i$（其中 $P_i \\in \\{X,Y,Z\\}$）指定，用于在一次实验中收集样本。如果两个泡利串在一个共同的乘积基中同时对角化（逐量子比特对易），那么它们可以从相同的测量设置中同时估计，这样一个单一的设置通过对相同比特串进行适当的后处理，就能得出它们所有的期望值。单位算符贡献一个已知的常数，并且不需要采样。\n\n考虑双量子比特哈密顿量\n$$\nH \\;=\\; c_0\\, I \\;+\\; c_1\\, Z_0 \\;+\\; c_2\\, Z_1 \\;+\\; c_3\\, Z_0 Z_1,\n$$\n其中 $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$，$I$ 是双量子比特上的单位算符，$Z_0 = Z \\otimes I$，$Z_1 = I \\otimes Z$，$Z_0 Z_1 = Z \\otimes Z$。\n\n仅使用以下基本原则：\n- 期望值的线性性，$\\langle A + B \\rangle = \\langle A \\rangle + \\langle B \\rangle$。\n- 逐量子比特对易（可通过单量子比特基变换对角化）的对易可观测量可以在一个乘积基测量设置中同时测量。\n- 对于任何量子态，单位项 $I$ 的期望值恒为 $1$，因此不需要测量。\n\n回答以下两部分：\n1) 不分组：假设每个非单位泡利项的期望值都在一次专用实验中估计，并且一次实验的采样不会被重用于估计任何其他项。需要多少个测量设置？\n2) 在逐量子比特对易 (QWC) 兼容性下分组：将可通过单量子比特旋转同时对角化的泡利串进行聚类，并计算所需的最少测量设置数量。\n\n将您的最终答案表示为行矩阵 $\\begin{pmatrix} N_{\\text{no group}}  N_{\\text{QWC group}} \\end{pmatrix}$。无需四舍五入，也无需单位。", "solution": "该问题要求我们确定估算给定哈密顿量期望值所需的测量设置数量，分为两种情况：不分组和使用逐量子比特对易（QWC）分组。\n哈密顿量为 $H = c_0 I + c_1 Z_0 + c_2 Z_1 + c_3 Z_0 Z_1$。\n根据问题陈述，单位项 $I$ 的期望值为 1，不需要测量。我们需要测量的项是 $Z_0$、$Z_1$ 和 $Z_0 Z_1$。\n\n**1) 不分组 ($N_{\\text{no group}}$):**\n在这种情况下，我们为每个非单位泡利项执行一次专用的测量。\n- 测量 $\\langle Z_0 \\rangle$ 需要一次设置。\n- 测量 $\\langle Z_1 \\rangle$ 需要一次设置。\n- 测量 $\\langle Z_0 Z_1 \\rangle$ 需要一次设置。\n总共需要 3 个独立的测量设置。因此，$N_{\\text{no group}} = 3$。\n\n**2) 在逐量子比特对易 (QWC) 兼容性下分组 ($N_{\\text{QWC group}}$):**\n如果一组泡利串是逐量子比特对易的，它们就可以在同一个测量设置中同时被测量。逐量子比特对易意味着对于集合中的任意两个算符 $P = \\otimes_i P_i$ 和 $Q = \\otimes_i Q_i$，对于所有的量子比特 $i$ 都有 $[P_i, Q_i] = 0$。\n我们来检查需要测量的项：$Z_0 = Z \\otimes I$，$Z_1 = I \\otimes Z$ 和 $Z_0 Z_1 = Z \\otimes Z$。\n我们将这三个算符两两比较：\n- 比较 $Z_0$ 和 $Z_1$：在量子比特 0 上，算符是 $Z$ 和 $I$，$[Z, I]=0$。在量子比特 1 上，算符是 $I$ 和 $Z$，$[I, Z]=0$。所以 $Z_0$ 和 $Z_1$ 是 QWC 兼容的。\n- 比较 $Z_0$ 和 $Z_0 Z_1$：在量子比特 0 上，算符是 $Z$ 和 $Z$，$ [Z, Z]=0$。在量子比特 1 上，算符是 $I$ 和 $Z$，$[I, Z]=0$。所以 $Z_0$ 和 $Z_0 Z_1$ 是 QWC 兼容的。\n- 比较 $Z_1$ 和 $Z_0 Z_1$：在量子比特 0 上，算符是 $I$ 和 $Z$，$[I, Z]=0$。在量子比特 1 上，算符是 $Z$ 和 $Z$，$[Z, Z]=0$。所以 $Z_1$ 和 $Z_0 Z_1$ 是 QWC 兼容的。\n由于这三个泡利串（$Z_0$、$Z_1$、$Z_0 Z_1$）彼此都是 QWC 兼容的，它们可以被分到同一组中。它们都只包含 $I$ 和 $Z$ 算符，这意味着它们在 $Z$ 基（计算基）下都是对角的。因此，我们只需要一个测量设置：对两个量子比特都进行 $Z$ 基测量。从得到的比特串样本中，我们可以同时计算出 $\\langle Z_0 \\rangle$、$\\langle Z_1 \\rangle$ 和 $\\langle Z_0 Z_1 \\rangle$。\n因此，$N_{\\text{QWC group}} = 1$。\n\n**最终答案：**\n将结果组合成行矩阵 $\\begin{pmatrix} N_{\\text{no group}}  N_{\\text{QWC group}} \\end{pmatrix}$，我们得到 $\\begin{pmatrix} 3  1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  1\n\\end{pmatrix}\n}\n$$", "id": "2932509"}, {"introduction": "在VQE中，找到最优变分参数 $\\boldsymbol{\\theta}$ 的关键是高效地计算能量函数 $E(\\boldsymbol{\\theta})$ 的梯度。参数平移法则（parameter-shift rule）是在量子计算机上计算解析梯度的标准方法，但其适用性取决于参数化量子门的生成算符的谱特性。本练习将引导您深入探究不同类型的量子门，特别是那些在UCCSD等化学启发下的拟设中常见的门，并确定何时可以直接应用简单的双点参数平移法则，以及何时必须采用更高级的策略。掌握这些区别对于为复杂的量子化学问题设计有效的VQE优化循环至关重要。", "problem": "在用于量子化学的变分量子本征求解器（VQE）中，一个常见的拟设是酉耦合簇单双激发（UCCSD）拟设。考虑一个形式为 $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$ 的能量函数，其中 $U(\\boldsymbol{\\theta})$ 是参数化酉算符的乘积。对于单个参数化门 $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$（其生成元 $G_{\\ell}$ 为厄米算符），只有当 $G_{\\ell}$ 满足特定的谱条件时，才存在具有 $2$ 个评估点的精确参数偏移梯度法则。在实践中，UCCSD 层可以在经过费米子到量子比特的映射（如 Jordan–Wigner 映射）后，以几种等效形式在不同的编译或 Trotter 分解水平上实现。考虑以下代表性的门族：\n- 直接实现的单激发交换门 $U_{\\mathrm{ex}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}\\big]$，其中 $G_{pq} = \\tfrac{1}{2}\\big(X_{p} X_{q} + Y_{p} Y_{q}\\big)$ 作用于量子比特 $p$ 和 $q$。\n- 直接实现的未经 Trotter 分解的双激发门 $U_{\\mathrm{d}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}^{rs}\\big]$，其中 $G_{pq}^{rs}$ 是反厄米费米子算符 $(a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - a_{r}^{\\dagger} a_{s}^{\\dagger} a_{q} a_{p})$ 的量子比特映射镜像；经过 Jordan–Wigner 映射后，$G_{pq}^{rs}$ 是具有实系数的非对易泡利词之和。\n- 对于给定激发，使用固定顺序的一阶 Trotter 积，$U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp\\!\\big(-i \\theta \\, c_{k} P_{k}\\big)$，其中每个 $P_{k}$ 是一个泡利词，$c_{k} \\in \\mathbb{R}$，且 $K \\in \\mathbb{N}$。\n- 单个泡利旋转，$U_{P}(\\theta) = \\exp\\!\\big(-i \\theta \\, P\\big)$，其中 $P^{2} = I$。\n\n为了在使用 UCCSD 的 VQE 中进行无偏梯度估计，以下哪些陈述正确地指出了其生成元不接受精确 $2$ 点参数偏移法则的门族，并同时提出了有效的策略——基于酉算符线性组合（LCU）范式或辅助比特辅助干涉——来获得无偏梯度？\n\nA. 粒子数守恒的交换门 $U_{\\mathrm{ex}}(\\theta)$ 的生成元 $G_{pq}$ 的谱包含超过 $2$ 个不同的本征值，因此精确的 $2$ 点参数偏移法则不适用。可以通过使用广义多点参数偏移（实现为一组有限参数偏移上的 LCU）或通过一个辅助比特辅助电路来获得无偏梯度，该电路相干地实现偏移酉算符的线性组合并通过干涉提取导数。\n\nB. 单个泡利旋转 $U_{P}(\\theta)$ 不接受 $2$ 点参数偏移法则，因此需要基于辅助比特的方法来获得无偏梯度。\n\nC. 未经 Trotter 分解的双激发门 $U_{\\mathrm{d}}(\\theta)$ 的生成元 $G_{pq}^{rs}$ 是非对易泡利词的和，因此不接受 $2$ 点参数偏移法则。无偏梯度可以通过从与 $G_{pq}^{rs}$ 全谱相关的广义参数偏移法则导出的 LCU 估计器（实现为对参数偏移电路的有限加权和）或通过块编码 $G_{pq}^{rs}$ 并测量对易子对能量梯度的贡献的辅助比特辅助 Hadamard-test 构造来获得。\n\nD. 如上定义的任何一阶 Trotter 积 $U_{\\mathrm{Trot}}(\\theta)$ 都会自动违反 $2$ 点参数偏移属性，因此对于此类编译的 UCCSD 电路，精确的参数偏移梯度是不可能的。\n\nE. 向一个形式为 $U_{\\mathrm{d}}(\\theta)$ 的门添加一个控制辅助比特，普遍地使 $2$ 点参数偏移法则适用，而不管其生成元的谱如何。\n\n选择所有正确的陈述。", "solution": "问题陈述已被评估并被确定为有效。它具有科学依据，问题提出得当，并包含足够的信息来对选项中的主张进行严谨的分析。\n\n问题的核心在于计算期望值 $\\nabla_{\\boldsymbol{\\theta}} E(\\boldsymbol{\\theta})$ 的梯度，其中 $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$。对于门 $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$ 中的单个参数 $\\theta_{\\ell}$，其偏导数为：\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = i \\langle \\psi(\\boldsymbol{\\theta}) | [G_{\\ell}, H] | \\psi(\\boldsymbol{\\theta}) \\rangle\n$$\n其中 $|\\psi(\\boldsymbol{\\theta})\\rangle = U(\\boldsymbol{\\theta})|\\psi_0\\rangle$。直接测量这个对易子通常是不切实际的。参数偏移法则提供了一种替代方法，它将此导数表示为相同可观测量 $H$ 在参数偏移后的期望值的线性组合。\n\n一个具有 $M$ 个不同本征值集合 $\\{\\lambda_j\\}_{j=1}^M$ 的通用生成元 $G$ 对应一个广义参数偏移法则，该法则至少需要 $M$ 个（对于实值函数通常需要 $2M$ 或更多）评估点。非常理想的 **2 点参数偏移法则** 是一个仅使用两次电路评估即可得到梯度的精确解析表达式。其存在的充分条件是生成元 $G_{\\ell}$ 只有两个唯一的本征值。一个常见的情况是这两个本征值为 $\\pm r$，其中 $r > 0$。在这种情况下，该法则的形式为：\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = r \\left( E\\left(\\theta_{\\ell} + \\frac{\\pi}{4r}\\right) - E\\left(\\theta_{\\ell} - \\frac{\\pi}{4r}\\right) \\right)\n$$\n如果不满足此条件，则需要替代方法来进行无偏梯度估计。这些方法包括：\n1.  **广义参数偏移法则**：这适用于任何具有已知、有限本征值谱的生成元。它将梯度表示为多个参数偏移后期望值的线性组合，即 $\\frac{\\partial E}{\\partial \\theta_{\\ell}} = \\sum_k c_k E(\\theta_{\\ell} + s_k)$。这可以被看作是酉算符线性组合（LCU）范式的一个实例。\n2.  **辅助比特辅助方法**：这些技术，如 Hadamard 测试，使用一个辅助量子比特来干涉不同的量子操作，从而可以直接测量诸如 $\\operatorname{Re}\\langle\\psi|A^\\dagger B|\\psi\\rangle$ 或 $\\operatorname{Im}\\langle\\psi|A^\\dagger B|\\psi\\rangle$ 之类的量。通过将梯度表示为这样的量（例如，与对易子相关），可以构建一个基于辅助比特的电路来估计它，而无需知道生成元的光谱特性。\n\n我们现在将分析问题陈述中描述的每个门族。\n\n- **单个泡利旋转，$U_{P}(\\theta) = \\exp(-i \\theta P)$**：生成元是泡利词 $P$。根据定义，$P$ 是厄米算符且 $P^2 = I$。因此其本征值被限制在 $\\{-1, +1\\}$。由于恰好有两个不同的本征值，2 点参数偏移法則是适用的。\n\n- **单激发交换门，$U_{\\mathrm{ex}}(\\theta) = \\exp(-i \\theta G_{pq})$**：生成元是 $G_{pq} = \\frac{1}{2}(X_p X_q + Y_p Y_q)$。该算符作用于两个量子比特的希尔伯特空间。在计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 中，其矩阵表示为：\n$$\nG_{pq} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0  0  0  1 \\\\ 0  0  1  0 \\\\ 0  1  0  0 \\\\ 1  0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0  -1 \\\\ 0  0  1  0 \\\\ 0  1  0  0 \\\\ -1  0  0  0 \\end{pmatrix} \\right] = \\begin{pmatrix} 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  1  0  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n该矩阵的本征值是特征方程 $\\det(G_{pq} - \\lambda I) = \\lambda^2(\\lambda^2 - 1) = 0$ 的根。因此，本征值为 $\\{0, 0, 1, -1\\}$。不同本征值的集合是 $\\{-1, 0, 1\\}$。由于有三个不同的本征值，2 点参数偏移法则不适用。\n\n- **未经 Trotter 分解的双激发门，$U_{\\mathrm{d}}(\\theta) = \\exp(-i \\theta G_{pq}^{rs})$**：生成元 $G_{pq}^{rs}$ 源自费米子双激发算符 $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - \\text{h.c.}$，然后通过像 Jordan–Wigner 这样的费米子到量子比特的映射。单个这样的项映射为多个具有实系数的非对易泡利词的线性组合。一个通用的非对易算符的线性组合不具有仅含两个本征值的简单谱。因此，2 点参数偏移法则通常不适用于这些门。\n\n- **一阶 Trotter 积，$U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp(-i \\theta c_k P_k)$**：这个酉算符是指数的乘积，其中参数 $\\theta$ 与每个指数耦合。它不具有单个简单生成元 $G$ 的 $\\exp(-i\\theta G)$ 形式。其导数必须使用乘法法则计算：\n$$\n\\frac{\\partial U_{\\mathrm{Trot}}}{\\partial \\theta} = \\sum_{j=1}^{K} \\left( \\prod_{k=1}^{j-1} e^{-i\\theta c_k P_k} \\right) \\left( -i c_j P_j e^{-i\\theta c_j P_j} \\right) \\left( \\prod_{k=j+1}^{K} e^{-i\\theta c_k P_k} \\right)\n$$\n这导致梯度的形式为 $\\frac{\\partial E}{\\partial \\theta} = \\sum_{k=1}^{K} c_k \\frac{\\partial E}{\\partial \\phi_k}\\big|_{\\phi_k=\\theta c_k}$，其中 $\\phi_k$ 是乘积中第 $k$ 个门的参数。每一项 $\\frac{\\partial E}{\\partial \\phi_k}$ 对应一个生成元为 $P_k$ 的门，2 点参数偏移法则对其适用。因此，总梯度是精确的，可以计算为 $K$ 项之和，每一项通过 2 点偏移获得。电路评估的总次数将为 $2K$。\n\n我们现在开始评估每个选项。\n\n**选项 A**：\n该陈述声称交换门 $U_{\\mathrm{ex}}(\\theta)$ 的生成元 $G_{pq}$ 有超过 2 个不同的本征值，从而使 2 点参数偏移法则无效。我们的分析表明，不同的本征值是 $\\{-1, 0, 1\\}$，这证实了这一说法。该陈述接着提出，无偏梯度可以通过广义多点参数偏移法则（一种 LCU 方法）或通过辅助比特辅助干涉电路获得。当 2 点法则不适用时，这两种都是计算梯度的有效且标准的先进技术。\n**结论：正确**\n\n**选项 B**：\n该陈述声称单个泡利旋转 $U_P(\\theta)$ 不接受 2 点参数偏移法则。这根本上是错误的。生成元是一个泡利词 $P$，其本征值为 $\\{-1, 1\\}$，这是 2 点法则适用的典型情况。该陈述的前提是错误的。\n**结论：错误**\n\n**选项 C**：\n该陈述断言，未经 Trotter 分解的双激发门 $U_{\\mathrm{d}}(\\theta)$ 的生成元 $G_{pq}^{rs}$ 是非对易泡利词的和，因此不接受 2 点参数偏移法则。这是正确的，因为这类生成元通常具有包含两个以上不同本征值的复杂谱。该陈述接着提出了两种获得无偏梯度的有效方法：广义参数偏移法则（一种基于生成元谱的 LCU 估计器）和辅助比特辅助的 Hadamard-test 构造。后者是测量对易子或实现 LCU 的通用方法，确实是一种有效的策略。两种提议的解决方案都是正确的。\n**结论：正确**\n\n**选项 D**：\n该陈述声称对于 Trotter 积 $U_{\\mathrm{Trot}}(\\theta)$，2 点参数偏移属性被违反并且“精确的参数偏移梯度是不可能的”。虽然复合门本身不满足单个 2 点偏移法则的条件，但“精确梯度不可能”的结论是错误的。如我们的分析所示，通过应用乘法法则并使用 2 点参数偏移法则评估得到的 $K$ 个项中的每一项，可以计算出精确的梯度，因为每个分量门都是一个简单的泡利旋转。\n**结论：错误**\n\n**选项 E**：\n该陈述声称向一个形式为 $U_{\\mathrm{d}}(\\theta)$ 的门添加一个控制辅助比特，普遍地使 2 点参数偏移法则适用。这是对辅助量子比特在梯度计算中作用的误解。基于辅助比特的方法提供了一种替代的测量方案来*计算*梯度，主要是通过构建一个电路来估计必要的对易子。它们不会改变原始生成元 $G_{pq}^{rs}$ 的谱特性。参数偏移法则的适用性是参数化门生成元的内在属性，而不是可以由外部测量电路诱导的特性。\n**结论：错误**\n\n因此，陈述 A 和 C 是对情况的唯二正确描述。", "answer": "$$\\boxed{AC}$$", "id": "2932516"}, {"introduction": "虽然VQE主要用于寻找系统的基态，但激发态在光谱学和化学反应动力学中同样至关重要。变分量子“放缩”法（Variational Quantum Deflation, VQD）是一种对VQE的巧妙扩展，旨在系统地寻找这些高能级状态。该方法通过在成本函数中引入一个惩罚项，迫使变分状态与已知的低能级本征态（如基态）保持正交。通过在一个简单的双能级系统上进行推导，本练习将让您亲手构建VQD的能量图景，从而直观地理解惩罚函数如何引导变分搜索以获得激发态解。", "problem": "考虑一个由哈密顿量描述的有效单自旋-$\\tfrac{1}{2}$（双能级）电子子空间\n$$\nH \\;=\\; h_x\\,X \\;+\\; h_z\\,Z,\n$$\n其中 $X$ 和 $Z$ 是泡利算符，且 $h_x, h_z \\in \\mathbb{R}$。使用原子单位（哈特里）。使用由布洛赫角参数化的标准单量子比特纯态拟设，\n$$\n|\\psi(\\theta,\\varphi)\\rangle \\;=\\; \\cos\\!\\left(\\frac{\\theta}{2}\\right)\\,|0\\rangle \\;+\\; \\exp(i\\varphi)\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,|1\\rangle,\n$$\n其中 $0 \\le \\theta \\le \\pi$ 且 $0 \\le \\varphi  2\\pi$。令 $|\\psi_g\\rangle$ 表示 $H$ 的精确基态（可假设其已在先前的变分运行中获得）。用于寻找第一激发态的变分量子亏格 (VQD) 代价泛函增加了一个正交性惩罚项，以抑制与 $|\\psi_g\\rangle$ 的交叠：\n$$\nE_{\\mathrm{VQD}}(\\theta,\\varphi;\\beta) \\;=\\; \\langle\\psi(\\theta,\\varphi)|H|\\psi(\\theta,\\varphi)\\rangle \\;+\\; \\beta\\,\\big|\\langle \\psi(\\theta,\\varphi)\\,|\\,\\psi_g\\rangle\\big|^2,\n$$\n惩罚强度 $\\beta0$。\n\n任务：\n- 从第一性原理（泡利算符在布洛赫态上的期望值以及纯态间交叠的定义）出发，推导无惩罚的变分量子本征求解器 (VQE) 能量景观 $E(\\theta,\\varphi) = \\langle\\psi(\\theta,\\varphi)|H|\\psi(\\theta,\\varphi)\\rangle$ 的显式表达式。\n- 用 $h_x$、$h_z$、$\\theta$、$\\varphi$ 以及通过最小化 $E(\\theta,\\varphi)$ 得出的 $|\\psi_g\\rangle$ 的显式表示来表达 $E_{\\mathrm{VQD}}(\\theta,\\varphi;\\beta)$。\n- 对 $E_{\\mathrm{VQD}}(\\theta,\\varphi;\\beta)$ 关于 $\\theta$ 和 $\\varphi$ 进行最小化，以获得作为 $\\beta$ 和哈密顿量参数的函数的精确全局最小值。将您的最终结果以单一闭式解析表达式的形式给出，该表达式仅依赖于 $\\beta$、$h_x$ 和 $h_z$，并且对所有 $\\beta0$ 均有效。\n\n请用哈特里 (Hartree) 表示您的最终答案。请勿近似；无需四舍五入。最终答案必须是单一的解析表达式。", "solution": "第一个任务是推导无惩罚的 VQE 能量景观的表达式，$E(\\theta,\\varphi) = \\langle\\psi(\\theta,\\varphi)|H|\\psi(\\theta,\\varphi)\\rangle$。这是哈密顿量 $H$ 在态 $|\\psi(\\theta,\\varphi)\\rangle$ 下的期望值。\n$$\nE(\\theta,\\varphi) = \\langle\\psi(\\theta,\\varphi)|(h_x X + h_z Z)|\\psi(\\theta,\\varphi)\\rangle = h_x \\langle\\psi(\\theta,\\varphi)|X|\\psi(\\theta,\\varphi)\\rangle + h_z \\langle\\psi(\\theta,\\varphi)|Z|\\psi(\\theta,\\varphi)\\rangle\n$$\n我们计算泡利算符 $X$ 和 $Z$ 的期望值。态矢量为 $|\\psi(\\theta,\\varphi)\\rangle = \\begin{pmatrix} \\cos(\\theta/2) \\\\ \\exp(i\\varphi)\\sin(\\theta/2) \\end{pmatrix}$。\n$Z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$ 的期望值为：\n$$\n\\langle Z \\rangle = \\left(\\cos(\\tfrac{\\theta}{2}),\\, \\exp(-i\\varphi)\\sin(\\tfrac{\\theta}{2})\\right) \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\tfrac{\\theta}{2}) \\\\ \\exp(i\\varphi)\\sin(\\tfrac{\\theta}{2}) \\end{pmatrix} = \\cos^2(\\tfrac{\\theta}{2}) - \\sin^2(\\tfrac{\\theta}{2}) = \\cos(\\theta)\n$$\n$X = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$ 的期望值为：\n$$\n\\langle X \\rangle = \\left(\\cos(\\tfrac{\\theta}{2}),\\, \\exp(-i\\varphi)\\sin(\\tfrac{\\theta}{2})\\right) \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\tfrac{\\theta}{2}) \\\\ \\exp(i\\varphi)\\sin(\\tfrac{\\theta}{2}) \\end{pmatrix} = \\exp(-i\\varphi)\\sin(\\tfrac{\\theta}{2})\\cos(\\tfrac{\\theta}{2}) + \\exp(i\\varphi)\\sin(\\tfrac{\\theta}{2})\\cos(\\tfrac{\\theta}{2})\n$$\n$$\n\\langle X \\rangle = \\sin(\\tfrac{\\theta}{2})\\cos(\\tfrac{\\theta}{2})\\left(\\exp(-i\\varphi)+\\exp(i\\varphi)\\right) = \\frac{1}{2}\\sin(\\theta) \\cdot 2\\cos(\\varphi) = \\sin(\\theta)\\cos(\\varphi)\n$$\n结合这些结果，VQE 能量景观为：\n$$\nE(\\theta,\\varphi) = h_x \\sin(\\theta)\\cos(\\varphi) + h_z \\cos(\\theta)\n$$\n该表达式等价于点积 $\\vec{h} \\cdot \\vec{r}$，其中 $\\vec{h} = (h_x, 0, h_z)$，而 $\\vec{r} = (\\sin\\theta\\cos\\varphi, \\sin\\theta\\sin\\varphi, \\cos\\theta)$ 是 $|\\psi(\\theta,\\varphi)\\rangle$ 的布洛赫矢量。$H$ 的本征值是 $E(\\theta,\\varphi)$ 的最小值和最大值，分别在 $\\vec{r}$ 与 $\\vec{h}$ 反平行和平行时取到。因此，本征值为 $\\pm\\|\\vec{h}\\|$。\n基态能量为 $E_g = - \\sqrt{h_x^2 + h_z^2}$，第一激发态能量为 $E_e = \\sqrt{h_x^2 + h_z^2}$。\n\n第二个任务是表达 VQD 代价泛函 $E_{\\mathrm{VQD}}(\\theta,\\varphi;\\beta)$。该泛函定义为 $E_{\\mathrm{VQD}} = E(\\theta,\\varphi) + \\beta |\\langle \\psi(\\theta,\\varphi)|\\psi_g\\rangle|^2$。我们需要计算交叠项 $|\\langle \\psi(\\theta,\\varphi)|\\psi_g\\rangle|^2$。基态 $|\\psi_g\\rangle$ 对应于使 $E(\\theta,\\varphi)$ 最小化的布洛赫矢量 $\\vec{r}_g$，即 $\\vec{r}_g = -\\vec{h}/\\|\\vec{h}\\|$。\n由布洛赫矢量 $\\vec{r}$ 和 $\\vec{r}_g$ 表示的两个纯态之间的交叠平方由下式给出：\n$$\n|\\langle \\psi(\\theta,\\varphi)|\\psi_g\\rangle|^2 = \\frac{1 + \\vec{r} \\cdot \\vec{r}_g}{2}\n$$\n代入 $\\vec{r}_g = -\\frac{1}{\\sqrt{h_x^2+h_z^2}}(h_x, 0, h_z)$：\n$$\n\\vec{r} \\cdot \\vec{r}_g = -\\frac{\\vec{r} \\cdot \\vec{h}}{\\|\\vec{h}\\|} = -\\frac{h_x \\sin\\theta\\cos\\varphi + h_z \\cos\\theta}{\\sqrt{h_x^2+h_z^2}} = -\\frac{E(\\theta,\\varphi)}{E_e}\n$$\n其中 $E_e = \\sqrt{h_x^2+h_z^2}$。\n交叠项变为：\n$$\n|\\langle \\psi(\\theta,\\varphi)|\\psi_g\\rangle|^2 = \\frac{1}{2}\\left(1 - \\frac{E(\\theta,\\varphi)}{E_e}\\right) = \\frac{1}{2}\\left(1 - \\frac{E(\\theta,\\varphi)}{\\sqrt{h_x^2+h_z^2}}\\right)\n$$\n将此代入 VQD 代价泛函，我们得到一个依赖于 VQE 能量 $E \\equiv E(\\theta,\\varphi)$ 的表达式：\n$$\nE_{\\mathrm{VQD}}(E;\\beta) = E + \\frac{\\beta}{2}\\left(1 - \\frac{E}{\\sqrt{h_x^2+h_z^2}}\\right) = E\\left(1 - \\frac{\\beta}{2\\sqrt{h_x^2+h_z^2}}\\right) + \\frac{\\beta}{2}\n$$\n\n第三个任务是使 $E_{\\mathrm{VQD}}$ 对 $\\theta$ 和 $\\varphi$ 最小化。这等价于在 $E(\\theta,\\varphi)$ 的可能取值范围内最小化函数 $E_{\\mathrm{VQD}}(E;\\beta)$。$E$ 的定义域是区间 $[E_g, E_e]$，即 $[-\\sqrt{h_x^2+h_z^2}, \\sqrt{h_x^2+h_z^2}]$。\n函数 $E_{\\mathrm{VQD}}(E;\\beta)$ 是 $E$ 的线性函数。线性函数在闭区间上的最小值必然出现在区间的某个端点。因此，我们在 $E = E_g$ 和 $E = E_e$ 处计算 $E_{\\mathrm{VQD}}$ 的值。\n\n在下端点，$E = E_g = -\\sqrt{h_x^2+h_z^2}$：\n$$\nE_{\\mathrm{VQD}}(E_g;\\beta) = -\\sqrt{h_x^2+h_z^2}\\left(1 - \\frac{\\beta}{2\\sqrt{h_x^2+h_z^2}}\\right) + \\frac{\\beta}{2} = -\\sqrt{h_x^2+h_z^2} + \\frac{\\beta}{2} + \\frac{\\beta}{2} = \\beta - \\sqrt{h_x^2+h_z^2}\n$$\n该值对应于选择基态 $|\\psi_g\\rangle$。\n\n在上端点，$E = E_e = \\sqrt{h_x^2+h_z^2}$：\n$$\nE_{\\mathrm{VQD}}(E_e;\\beta) = \\sqrt{h_x^2+h_z^2}\\left(1 - \\frac{\\beta}{2\\sqrt{h_x^2+h_z^2}}\\right) + \\frac{\\beta}{2} = \\sqrt{h_x^2+h_z^2} - \\frac{\\beta}{2} + \\frac{\\beta}{2} = \\sqrt{h_x^2+h_z^2}\n$$\n该值对应于选择激发态 $|\\psi_e\\rangle$。\n\nVQD 代价函数的全局最小值是这两个值的较小者：\n$$\n\\min E_{\\mathrm{VQD}} = \\min\\left(\\beta - \\sqrt{h_x^2+h_z^2},\\, \\sqrt{h_x^2+h_z^2}\\right)\n$$\n根据要求，此分段定义必须转换为单一的闭式解析表达式。使用恒等式 $\\min(a,b) = \\frac{1}{2}(a+b - |a-b|)$，我们设 $a = \\beta - \\sqrt{h_x^2+h_z^2}$ 且 $b = \\sqrt{h_x^2+h_z^2}$。\n$$\na+b = \\beta\n$$\n$$\na-b = \\beta - 2\\sqrt{h_x^2+h_z^2}\n$$\n因此，全局最小值为：\n$$\n\\min E_{\\mathrm{VQD}} = \\frac{1}{2}\\left(\\beta - \\left|\\beta - 2\\sqrt{h_x^2+h_z^2}\\right|\\right)\n$$", "answer": "$$\n\\boxed{\\frac{1}{2}\\left(\\beta - \\left|\\beta - 2\\sqrt{h_x^2+h_z^2}\\right|\\right)}\n$$", "id": "2932449"}]}