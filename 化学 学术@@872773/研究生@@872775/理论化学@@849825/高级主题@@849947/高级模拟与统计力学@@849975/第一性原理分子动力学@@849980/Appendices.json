{"hands_on_practices": [{"introduction": "在从头算分子动力学中，选择一个合适的积分时间步长是确保模拟稳定性和准确性的首要步骤。本练习将通过一个具体计算，阐明为何玻恩-奥本海默分子动力学（BOMD）和 Car-Parrinello 分子动力学（CPMD）对时间步长的要求不同，帮助你掌握这两种方法的核心限制因素。[@problem_id:2759558]", "problem": "一个双原子分子的最高物理振动波数为 $3600\\,\\text{cm}^{-1}$，这是O–H伸缩振动的特征。您将比较两种从头算分子动力学方案：Born–Oppenheimer分子动力学（BOMD）和Car–Parrinello分子动力学（CPMD）。在BOMD中，核运动采用标准的辛积分方案（例如，速度-Verlet算法）进行积分，其稳定性和准确性由最快的物理振动模式决定。在CPMD中，电子自由度通过一个虚拟质量进行传播，这导致一个最高的虚拟电子振荡，其角频率据称是 $3600\\,\\text{cm}^{-1}$ 模式的十倍。\n\n从最快模式的谐振子图像出发，假设数值稳定性和可接受的能量守恒要求每个周期至少用二十个步长来解析最快的振荡。使用波数和频率之间的关系 $\\nu = c\\,\\tilde{\\nu}$（其中 $c = 2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}$）以及周期 $T = 1/\\nu$。对于CPMD，应用高十倍的虚拟频率来确定其相应的约束条件。\n\n在这些假设下，计算合理的时间步长 $\\Delta t_{\\text{BOMD}}$ 和 $\\Delta t_{\\text{CPMD}}$。将两个时间步长都以飞秒（fs）表示，并以有序对 $\\big(\\Delta t_{\\text{BOMD}}, \\Delta t_{\\text{CPMD}}\\big)$ 的形式报告您的最终结果。将您的答案四舍五入到三位有效数字。", "solution": "该问题要求根据两种*从头算*分子动力学方法（Born-Oppenheimer分子动力学BOMD和Car-Parrinello分子动力学CPMD）中与最快振荡相关的稳定性判据，计算合适的数值积分时间步长。题目陈述在科学上是合理的，并为得出唯一解提供了所有必要信息。\n\n首先，我们分析Born-Oppenheimer分子动力学（BOMD）的情况。在BOMD中，在每个时间步长，电子结构是针对一个静态的核构型求解的。然后，原子核的动力学在得到的势能面上进行传播。数值积分器（如速度-Verlet算法）的稳定性受到原子核最快物理运动的限制。题目给出这是一个振动模式，其波数为 $\\tilde{\\nu}_{\\text{phys}} = 3600\\,\\text{cm}^{-1}$。\n\n波数 $\\tilde{\\nu}$（单位为 $\\text{cm}^{-1}$）、频率 $\\nu$（单位为 $\\text{s}^{-1}$）和光速 $c$ 之间的关系由 $\\nu = c\\tilde{\\nu}$ 给出。这个振荡的周期 $T$ 是频率的倒数，$T = 1/\\nu$。因此，最快物理振动的周期 $T_{\\text{phys}}$ 是：\n$$T_{\\text{phys}} = \\frac{1}{\\nu_{\\text{phys}}} = \\frac{1}{c\\tilde{\\nu}_{\\text{phys}}}$$\n题目指出，为了数值稳定性，这个最快的振荡必须以每个周期至少 $N_{\\text{steps}} = 20$ 个步长来解析。因此，一个合理的最大时间步长 $\\Delta t_{\\text{BOMD}}$ 由此条件确定：\n$$\\Delta t_{\\text{BOMD}} = \\frac{T_{\\text{phys}}}{N_{\\text{steps}}} = \\frac{1}{N_{\\text{steps}} c \\tilde{\\nu}_{\\text{phys}}}$$\n代入给定值 $\\tilde{\\nu}_{\\text{phys}} = 3600\\,\\text{cm}^{-1}$，$c = 2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}$ 和 $N_{\\text{steps}} = 20$：\n$$\\Delta t_{\\text{BOMD}} = \\frac{1}{20 \\times (2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}) \\times (3600\\,\\text{cm}^{-1})}$$\n$$\\Delta t_{\\text{BOMD}} = \\frac{1}{2.1585056976 \\times 10^{15}\\,\\text{s}^{-1}} \\approx 4.63283 \\times 10^{-16}\\,\\text{s}$$\n为了将其表示为飞秒（其中 $1\\,\\text{fs} = 10^{-15}\\,\\text{s}$），我们乘以 $10^{15}$：\n$$\\Delta t_{\\text{BOMD}} \\approx 0.463283\\,\\text{fs}$$\n\n接下来，我们分析Car-Parrinello分子动力学（CPMD）的情况。在CPMD中，原子核和电子轨道（由系数表示）都使用扩展的拉格朗日量同时传播。电子自由度被赋予一个虚拟质量，这导致虚拟的电子振荡。CPMD的稳定性受限于这个耦合系统中的最高频率，这通常是虚拟的电子频率。\n\n题目指明，最高的虚拟电子角频率 $\\omega_{\\text{fict}}$ 是 $3600\\,\\text{cm}^{-1}$ 物理模式的角频率 $\\omega_{\\text{phys}}$ 的十倍。角频率 $\\omega$ 与频率 $\\nu$ 的关系为 $\\omega = 2\\pi\\nu$。因此：\n$$\\omega_{\\text{fict}} = 10 \\cdot \\omega_{\\text{phys}} = 10 \\cdot (2\\pi \\nu_{\\text{phys}})$$\n虚拟振荡的周期 $T_{\\text{fict}}$ 由 $T_{\\text{fict}} = 2\\pi/\\omega_{\\text{fict}}$ 给出。代入 $\\omega_{\\text{fict}}$ 的表达式：\n$$T_{\\text{fict}} = \\frac{2\\pi}{10 \\cdot (2\\pi \\nu_{\\text{phys}})} = \\frac{1}{10 \\cdot \\nu_{\\text{phys}}}$$\n由于物理周期是 $T_{\\text{phys}} = 1/\\nu_{\\text{phys}}$，我们发现两个周期之间存在直接关系：\n$$T_{\\text{fict}} = \\frac{T_{\\text{phys}}}{10}$$\nCPMD的时间步长 $\\Delta t_{\\text{CPMD}}$ 受这个快得多的虚拟振荡的限制。应用每个周期 $N_{\\text{steps}} = 20$ 个步长的相同稳定性判据：\n$$\\Delta t_{\\text{CPMD}} = \\frac{T_{\\text{fict}}}{N_{\\text{steps}}} = \\frac{T_{\\text{phys}}/10}{N_{\\text{steps}}} = \\frac{T_{\\text{phys}}}{200}$$\n这表明，在这些条件下，CPMD的时间步长是BOMD时间步长的十分之一：\n$$\\Delta t_{\\text{CPMD}} = \\frac{\\Delta t_{\\text{BOMD}}}{10}$$\n使用先前计算的 $\\Delta t_{\\text{BOMD}}$ 值：\n$$\\Delta t_{\\text{CPMD}} \\approx \\frac{0.463283\\,\\text{fs}}{10} = 0.0463283\\,\\text{fs}$$\n\n最后，我们按照要求将两个结果四舍五入到三位有效数字。\n$$\\Delta t_{\\text{BOMD}} \\approx 0.463\\,\\text{fs}$$\n$$\\Delta t_{\\text{CPMD}} \\approx 0.0463\\,\\text{fs}$$\n最终答案是有序对 $\\left(\\Delta t_{\\text{BOMD}}, \\Delta t_{\\text{CPMD}}\\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.463 & 0.0463\n\\end{pmatrix}\n}\n$$", "id": "2759558"}, {"introduction": "Car-Parrinello 分子动力学（CPMD）的成功关键在于巧妙地选择赝质量 $μ$，以维持核动力学与虚拟电子动力学之间的绝热分离。通过这个练习，你将推导并计算赝质量如何与系统的电子能隙和离子振动频率相关联，从而深化对 CPMD 方法参数化背后物理原理的理解。[@problem_id:2759553]", "problem": "Car–Parrinello 分子动力学 (CPMD) 模拟旨在维持虚拟电子动力学和离子动力学之间的绝热解耦。考虑一个带隙半导体，其 Kohn–Sham 带隙为 $\\Delta = 1\\,\\text{eV}$，最大离子振动波数为 $3000\\,\\text{cm}^{-1}$。在固定的原子核几何构型下，使用一个最小的双能级占据-虚拟子空间和 Car–Parrinello 拉格朗日量\n$$\nL \\;=\\; \\sum_{I} \\frac{M_I}{2}\\,\\dot{\\mathbf{R}}_{I}^{2}\\;+\\;\\frac{\\mu}{2}\\sum_{i}\\langle \\dot{\\psi}_{i}\\,|\\,\\dot{\\psi}_{i}\\rangle\\;-\\;E[\\{\\psi_i\\};\\{\\mathbf{R}_I\\}]\\;+\\;\\sum_{ij}\\Lambda_{ij}\\big(\\langle \\psi_i|\\psi_j\\rangle-\\delta_{ij}\\big),\n$$\n将占据轨道 $|i\\rangle$ 与虚拟轨道 $|a\\rangle$ 通过一个旋转坐标 $\\theta(t)$（定义为 $|\\phi(\\theta)\\rangle=\\cos\\theta\\,|i\\rangle+\\sin\\theta\\,|a\\rangle$）混合的小振幅动力学视为单个有效谐振模式。从该拉格朗日量出发，仅使用关于 Born–Oppenheimer 最小点的线性响应和正交归一化约束，推导出 $\\theta(t)$ 的小振动运动方程及其电子角频率 $\\omega_{e}$（用虚拟质量 $\\mu$ 和能隙 $\\Delta=\\varepsilon_{a}-\\varepsilon_{i}$ 表示）。\n\n施加绝热分离判据，即电子频率是最大离子频率（以角频率单位）的 $\\kappa$ 倍，其中 $\\kappa=5$。使用此判据计算虚拟 Car–Parrinello 质量 $\\mu$ 的一个合适值。然后，使用保守的积分器分辨率判据，即取时间步长为电子周期的二十分之一，$\\Delta t = \\frac{1}{20}\\frac{2\\pi}{\\omega_{e}}$，计算一个合适的 CPMD 时间步长。\n\n在构成 $\\mu$ 和 $\\omega_e$ 时，能量和时间使用原子单位制，然后按如下方式表达最终答案：\n- 以原子单位给出 $\\mu$。\n- 以飞秒给出 $\\Delta t$。\n\n您可以使用以下常数进行单位换算：\n- $1\\,\\text{Hartree} = 27.211386\\,\\text{eV}$，\n- $1\\,\\text{Hartree} = 219{,}474.6314\\,\\text{cm}^{-1}$，\n- $1$ 原子时间单位 $= 2.4188843\\times 10^{-17}\\,\\text{s} = 0.024188843\\,\\text{fs}$。\n\n将 $\\mu$ 和 $\\Delta t$ 都四舍五入到三位有效数字。将您的最终答案以单行矩阵 $\\big(\\mu,\\ \\Delta t\\big)$ 的形式给出，其中第二个条目单位为飞秒。", "solution": "所提出的问题是第一性原理分子动力学理论中的一个标准练习，具体涉及 Car-Parrinello 方法。它具有科学依据、问题良定且客观。它要求推导一个基本关系并将其应用于真实的物理场景。因此，该问题是有效的，并将提供解答。\n\n分析从 Car-Parrinello 拉格朗日量开始，其表达式为：\n$$\nL \\;=\\; \\sum_{I} \\frac{M_I}{2}\\,\\dot{\\mathbf{R}}_{I}^{2}\\;+\\;\\frac{\\mu}{2}\\sum_{i}\\langle \\dot{\\psi}_{i}\\,|\\,\\dot{\\psi}_{i}\\rangle\\;-\\;E[\\{\\psi_i\\};\\{\\mathbf{R}_I\\}]\\;+\\;\\sum_{ij}\\Lambda_{ij}\\big(\\langle \\psi_i|\\psi_j\\rangle-\\delta_{ij}\\big)\n$$\n我们考虑一个最小的双能级系统，由一个占据轨道 $|i\\rangle$ 和一个虚拟轨道 $|a\\rangle$ 组成，它们是静态 Kohn-Sham 哈密顿量 $\\hat{H}_{\\text{KS}}$ 的正交归一的本征态，其本征值分别为 $\\varepsilon_i$ 和 $\\varepsilon_a$。一个随时间变化的单电子轨道 $|\\phi(t)\\rangle$ 是通过在该子空间中的旋转形成的，由角度 $\\theta(t)$ 参数化：\n$$\n|\\phi(\\theta(t))\\rangle = \\cos\\theta(t)\\,|i\\rangle + \\sin\\theta(t)\\,|a\\rangle\n$$\n这种参数化自动满足正交归一化约束 $\\langle\\phi|\\phi\\rangle = 1$，因此对于这个单轨道模型，可以忽略带有拉格朗日乘子 $\\Lambda_{ij}$ 的项。我们专注于拉格朗日量的电子部分 $L_e$，因为在此推导中，原子核位置被视为固定的。\n$$\nL_e = \\frac{\\mu}{2}\\langle \\dot{\\phi} | \\dot{\\phi} \\rangle - E[\\phi]\n$$\n第一项是轨道的虚拟动能。我们计算 $|\\phi\\rangle$ 对时间的导数：\n$$\n|\\dot{\\phi}\\rangle = \\frac{d}{dt}\\big(\\cos\\theta\\,|i\\rangle + \\sin\\theta\\,|a\\rangle\\big) = (-\\sin\\theta\\,\\dot{\\theta})\\,|i\\rangle + (\\cos\\theta\\,\\dot{\\theta})\\,|a\\rangle = \\dot{\\theta}\\big(-\\sin\\theta\\,|i\\rangle + \\cos\\theta\\,|a\\rangle\\big)\n$$\n动能项变为：\n$$\n\\frac{\\mu}{2}\\langle \\dot{\\phi} | \\dot{\\phi} \\rangle = \\frac{\\mu}{2}\\dot{\\theta}^2 \\langle -\\sin\\theta i + \\cos\\theta a | -\\sin\\theta i + \\cos\\theta a \\rangle\n$$\n利用 $|i\\rangle$ 和 $|a\\rangle$ 的正交归一性（$\\langle i|i\\rangle=1$, $\\langle a|a\\rangle=1$, $\\langle i|a\\rangle=0$），内积简化为：\n$$\n\\langle -\\sin\\theta i + \\cos\\theta a | -\\sin\\theta i + \\cos\\theta a \\rangle = \\sin^2\\theta\\langle i|i\\rangle - 2\\sin\\theta\\cos\\theta\\langle i|a\\rangle + \\cos^2\\theta\\langle a|a\\rangle = \\sin^2\\theta + \\cos^2\\theta = 1\n$$\n因此，电子动能为 $T_e = \\frac{1}{2}\\mu\\dot{\\theta}^2$。\n\n势能项 $E[\\phi]$ 是 Kohn-Sham 哈密顿量在态 $|\\phi\\rangle$ 下的期望值：\n$$\nE(\\theta) = \\langle \\phi(\\theta) | \\hat{H}_{\\text{KS}} | \\phi(\\theta) \\rangle = \\langle \\cos\\theta i + \\sin\\theta a | \\hat{H}_{\\text{KS}} | \\cos\\theta i + \\sin\\theta a \\rangle\n$$\n由于 $\\hat{H}_{\\text{KS}}|i\\rangle = \\varepsilon_i|i\\rangle$ 且 $\\hat{H}_{\\text{KS}}|a\\rangle = \\varepsilon_a|a\\rangle$：\n$$\nE(\\theta) = \\langle \\cos\\theta i + \\sin\\theta a | \\cos\\theta\\varepsilon_i i + \\sin\\theta\\varepsilon_a a \\rangle = \\cos^2\\theta\\varepsilon_i + \\sin^2\\theta\\varepsilon_a\n$$\n电子坐标 $\\theta$ 的有效拉格朗日量为：\n$$\nL_e(\\theta, \\dot{\\theta}) = \\frac{1}{2}\\mu\\dot{\\theta}^2 - (\\varepsilon_i\\cos^2\\theta + \\varepsilon_a\\sin^2\\theta)\n$$\n$\\theta$ 的运动方程由 Euler-Lagrange 方程 $\\frac{d}{dt}\\frac{\\partial L_e}{\\partial \\dot{\\theta}} - \\frac{\\partial L_e}{\\partial \\theta} = 0$ 给出：\n$$\n\\frac{\\partial L_e}{\\partial \\dot{\\theta}} = \\mu\\dot{\\theta} \\quad \\implies \\quad \\frac{d}{dt}\\frac{\\partial L_e}{\\partial \\dot{\\theta}} = \\mu\\ddot{\\theta}\n$$\n$$\n\\frac{\\partial L_e}{\\partial \\theta} = -\\frac{\\partial}{\\partial\\theta}(\\varepsilon_i\\cos^2\\theta + \\varepsilon_a\\sin^2\\theta) = -(-2\\varepsilon_i\\cos\\theta\\sin\\theta + 2\\varepsilon_a\\sin\\theta\\cos\\theta) = -(\\varepsilon_a-\\varepsilon_i)(2\\sin\\theta\\cos\\theta) = -\\Delta\\sin(2\\theta)\n$$\n其中 $\\Delta = \\varepsilon_a - \\varepsilon_i$ 是能隙。运动方程为：\n$$\n\\mu\\ddot{\\theta} + \\Delta\\sin(2\\theta) = 0\n$$\n对于围绕 Born-Oppenheimer 最小点（基态 $|\\phi\\rangle=|i\\rangle$，对应于 $\\theta=0$）的小振幅动力学，我们使用近似 $\\sin(2\\theta) \\approx 2\\theta$。线性化的运动方程变为：\n$$\n\\mu\\ddot{\\theta} + 2\\Delta\\theta = 0 \\quad \\text{或} \\quad \\ddot{\\theta} + \\left(\\frac{2\\Delta}{\\mu}\\right)\\theta = 0\n$$\n这是简谐振子的方程，$\\ddot{\\theta} + \\omega_e^2\\theta = 0$，从中我们确定电子角频率的平方：\n$$\n\\omega_e^2 = \\frac{2\\Delta}{\\mu} \\quad \\implies \\quad \\omega_e = \\sqrt{\\frac{2\\Delta}{\\mu}}\n$$\n至此完成了所需的推导。\n\n接下来，我们计算虚拟质量 $\\mu$ 和时间步长 $\\Delta t$ 的数值。所有计算都必须在原子单位 (a.u.) 中进行。\n首先，我们将给定值转换为原子单位。\n能隙为 $\\Delta = 1\\,\\text{eV}$。使用换算关系 $1\\,\\text{Hartree} = 27.211386\\,\\text{eV}$：\n$$\n\\Delta = \\frac{1}{27.211386}\\,E_h \\approx 0.0367493\\,E_h\n$$\n最大离子振动波数为 $\\tilde{\\nu}_{\\text{ion,max}} = 3000\\,\\text{cm}^{-1}$。在原子单位中，其对应的角频率在数值上等于其能量（以哈特里 $E_h$ 为单位）。使用换算关系 $1\\,E_h = 219474.6314\\,\\text{cm}^{-1}$：\n$$\n\\omega_{\\text{ion,max}} = \\frac{3000}{219474.6314}\\,\\text{a.u.} \\approx 0.013669\\,\\text{a.u.}\n$$\n绝热分离判据为 $\\omega_e = \\kappa\\,\\omega_{\\text{ion,max}}$，其中 $\\kappa=5$：\n$$\n\\omega_e = 5 \\times \\frac{3000}{219474.6314} = \\frac{15000}{219474.6314}\\,\\text{a.u.} \\approx 0.068345\\,\\text{a.u.}\n$$\n现在我们可以根据推导出的关系 $\\mu = 2\\Delta/\\omega_e^2$ 来计算虚拟质量 $\\mu$：\n$$\n\\mu = \\frac{2 \\times \\left(\\frac{1}{27.211386}\\right)}{\\left(\\frac{15000}{219474.6314}\\right)^2} = \\frac{2}{27.211386} \\left(\\frac{219474.6314}{15000}\\right)^2 \\approx 15.7348\\,\\text{a.u.}\n$$\n四舍五入到三位有效数字，我们得到 $\\mu = 15.7\\,\\text{a.u.}$。\n\n最后，我们使用判据 $\\Delta t = \\frac{1}{20}\\frac{2\\pi}{\\omega_e} = \\frac{\\pi}{10\\omega_e}$ 计算时间步长 $\\Delta t$。\n首先，我们以原子时间单位计算 $\\Delta t$：\n$$\n\\Delta t_{\\text{a.u.}} = \\frac{\\pi}{10 \\times \\omega_e} = \\frac{\\pi}{10} \\left(\\frac{219474.6314}{15000}\\right) \\approx 4.5966\\,\\text{a.u. of time}\n$$\n现在我们使用 $1\\,\\text{a.u. of time} = 0.024188843\\,\\text{fs}$ 将其转换为飞秒 (fs)：\n$$\n\\Delta t = 4.5966 \\times 0.024188843\\,\\text{fs} \\approx 0.11118\\,\\text{fs}\n$$\n四舍五入到三位有效数字，得到 $\\Delta t = 0.111\\,\\text{fs}$。\n\n最终答案由数对 $(\\mu, \\Delta t)$ 组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n15.7 & 0.111\n\\end{pmatrix}\n}\n$$", "id": "2759553"}, {"introduction": "理论知识需要通过实践来巩固，本练习将理论付诸实践，通过一个简化的模型系统来直接比较 BOMD 和 CPMD 的性能。你将通过编写代码来模拟两种动力学过程，并分析总能量守恒性这一关键指标，从而直观地理解不同参数选择对模拟精度的影响。[@problem_id:2448304]", "problem": "您需要对一个沿单一分子间坐标的简化水二聚体，在两种第一性原理分子动力学范式中进行能量守恒的建模和比较。考虑一个一维核坐标 $R$，代表氧-氧间距，以玻尔半径（$a_0$）为单位。核运动由玻恩–奥本海默势能面所支配，该势能面近似为一个莫尔斯势\n$$\nE_{\\mathrm{BO}}(R) \\;=\\; D \\left[\\left(1 - e^{-a(R - R_e)}\\right)^2 - 1\\right],\n$$\n其中参数 $D$、$a$ 和 $R_e$ 在下文指定。与此同时，考虑一个辅助电子集体坐标 $q$（无量纲），其瞬时基态流形由 $q^\\star(R) = c\\,R$ 给出。定义一个扩展能量\n$$\nE_{\\mathrm{CP}}(R,q) \\;=\\; E_{\\mathrm{BO}}(R) \\;+\\; \\tfrac{1}{2} k_e \\left(q - c\\,R\\right)^2,\n$$\n其中包含耦合刚度 $k_e$ 和无量纲比例常数 $c$。您必须在持续时间为 $T = 1\\,\\mathrm{ps}$ 的轨迹上执行两种类型的动力学模拟：\n- 玻恩–奥本海默分子动力学 (BOMD)：核坐标 $R$ 在 $E_{\\mathrm{BO}}(R)$ 上演化，没有显式的电子动力学。\n- 卡–帕里内洛分子动力学 (CPMD)：核坐标 $R$ 和辅助坐标 $q$ 根据扩展能量 $E_{\\mathrm{CP}}(R,q)$ 演化，并使用一个虚拟电子质量 $M_q$。\n\n使用以下运动方程，其中点号表示时间导数：\n- 对于 BOMD：\n$$\nM_R \\,\\ddot{R} \\;=\\; -\\frac{dE_{\\mathrm{BO}}}{dR}.\n$$\n- 对于 CPMD：\n$$\nM_R \\,\\ddot{R} \\;=\\; -\\frac{dE_{\\mathrm{BO}}}{dR} \\;+\\; k_e\\,c\\left(q - c\\,R\\right),\n\\qquad\nM_q \\,\\ddot{q} \\;=\\; -k_e \\left(q - c\\,R\\right).\n$$\n核质量 $M_R$ 取为两个氧原子沿 $R$ 坐标的约化质量：\n$$\nM_R \\;=\\; \\frac{1}{2} m_{\\mathrm{O}},\n\\qquad\nm_{\\mathrm{O}} \\;=\\; 15.999 \\,u,\n\\qquad\n1\\,u \\;=\\; 1822.888486209 \\,m_e,\n$$\n以原子单位表示，其中电子质量 $m_e = 1$。莫尔斯参数和耦合参数为：\n$$\nD \\;=\\; \\frac{0.22\\,\\mathrm{eV}}{27.211386245988\\,\\mathrm{eV/Ha}} \\;\\mathrm{Ha},\n\\quad\na \\;=\\; 3.0 \\;a_0^{-1},\n\\quad\nR_e \\;=\\; 5.5 \\;a_0,\n$$\n$$\nk_e \\;=\\; 0.5 \\;\\mathrm{Ha},\n\\qquad\nc \\;=\\; 0.05.\n$$\n使用时间 $t=0$ 时的初始条件：\n$$\nR(0) \\;=\\; R_e + 0.1 \\;a_0,\n\\qquad\n\\dot{R}(0) \\;=\\; 0,\n\\qquad\nq(0) \\;=\\; c\\,R(0),\n\\qquad\n\\dot{q}(0) \\;=\\; 0.\n$$\n对 BOMD 和 CPMD 进行总时长为 $T = 1\\,\\mathrm{ps}$ 的模拟。方程应使用原子单位时间进行积分，换算关系为 $1\\,\\mathrm{a.u.\\ of\\ time} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}$ 和 $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$。需要监控的总能量为：\n- 对于 BOMD：\n$$\nE_{\\mathrm{tot}}^{\\mathrm{BO}}(t) \\;=\\; \\tfrac{1}{2} M_R \\dot{R}^2 \\;+\\; E_{\\mathrm{BO}}(R).\n$$\n- 对于 CPMD：\n$$\nE_{\\mathrm{tot}}^{\\mathrm{CP}}(t) \\;=\\; \\tfrac{1}{2} M_R \\dot{R}^2 \\;+\\; \\tfrac{1}{2} M_q \\dot{q}^2 \\;+\\; E_{\\mathrm{CP}}(R,q).\n$$\n对于每次模拟，计算轨迹上的总能量绝对漂移，\n$$\n\\Delta E \\;=\\; \\left| E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0) \\right|,\n$$\n并以电子伏特 (eV) 为单位报告 $\\Delta E$，四舍五入到恰好 $6$ 位小数。\n\n测试组。对于以下每组参数 $(\\Delta t, M_q)$，运行 BOMD 和 CPMD 模拟，持续时间为 $T = 1\\,\\mathrm{ps}$，其中 $\\Delta t$ 是用于积分的数值时间步长：\n- 情况 A：$\\Delta t = 0.25\\,\\mathrm{fs}$，$M_q = 400$。\n- 情况 B：$\\Delta t = 0.50\\,\\mathrm{fs}$，$M_q = 400$。\n- 情况 C：$\\Delta t = 0.50\\,\\mathrm{fs}$，$M_q = 1600$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含一个包含六个浮点数的列表，分别代表情况 A、B 和 C 中 BOMD 和 CPMD 的能量漂移（单位 eV），每个数值四舍五入到恰好 $6$ 位小数，顺序如下：\n$$\n[\\Delta E_{\\mathrm{BO}}^{A}, \\Delta E_{\\mathrm{CP}}^{A}, \\Delta E_{\\mathrm{BO}}^{B}, \\Delta E_{\\mathrm{CP}}^{B}, \\Delta E_{\\mathrm{BO}}^{C}, \\Delta E_{\\mathrm{CP}}^{C}].\n$$\n输出必须是单行，并且必须精确匹配指定格式（例如，$[0.000001,0.000002,0.000003,0.000004,0.000005,0.000006]$）。", "solution": "对所述问题进行验证。\n\n### 步骤 1：提取给定信息\n- **核坐标**：$R$ (玻尔, $a_0$)\n- **玻恩–奥本海默势**：$E_{\\mathrm{BO}}(R) = D[(1 - e^{-a(R - R_e)})^2 - 1]$\n- **辅助电子坐标**：$q$ (无量纲)\n- **电子基态流形**：$q^\\star(R) = c R$\n- **扩展卡–帕里内洛能量**：$E_{\\mathrm{CP}}(R,q) = E_{\\mathrm{BO}}(R) + \\tfrac{1}{2} k_e (q - cR)^2$\n- **模拟持续时间**：$T = 1\\,\\mathrm{ps}$\n- **运动方程 (BOMD)**：$M_R \\ddot{R} = -\\frac{dE_{\\mathrm{BO}}}{dR}$\n- **运动方程 (CPMD)**：\n  $M_R \\ddot{R} = -\\frac{dE_{\\mathrm{BO}}}{dR} + k_e c(q - cR)$\n  $M_q \\ddot{q} = -k_e (q - cR)$\n- **质量**：$M_R = \\frac{1}{2} m_{\\mathrm{O}}$，$m_{\\mathrm{O}} = 15.999 \\,u$，$1\\,u = 1822.888486209 \\,m_e$，$m_e = 1$\n- **势能参数**：$D = \\frac{0.22\\,\\mathrm{eV}}{27.211386245988\\,\\mathrm{eV/Ha}} \\;\\mathrm{Ha}$，$a = 3.0 \\;a_0^{-1}$，$R_e = 5.5 \\;a_0$\n- **耦合参数**：$k_e = 0.5 \\;\\mathrm{Ha}$，$c = 0.05$\n- **初始条件 ($t=0$)**：$R(0) = R_e + 0.1 \\;a_0$，$\\dot{R}(0) = 0$，$q(0) = c R(0)$，$\\dot{q}(0) = 0$\n- **时间换算**：$1\\,\\mathrm{a.u.\\ of\\ time} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}$，$1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$\n- **总能量 (BOMD)**：$E_{\\mathrm{tot}}^{\\mathrm{BO}}(t) = \\tfrac{1}{2} M_R \\dot{R}^2 + E_{\\mathrm{BO}}(R)$\n- **总能量 (CPMD)**：$E_{\\mathrm{tot}}^{\\mathrm{CP}}(t) = \\tfrac{1}{2} M_R \\dot{R}^2 + \\tfrac{1}{2} M_q \\dot{q}^2 + E_{\\mathrm{CP}}(R,q)$\n- **度量标准**：绝对能量漂移 $\\Delta E = | E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0) |$，单位为 eV，四舍五入到 $6$ 位小数。\n- **测试案例**：\n    - 情况 A：$\\Delta t = 0.25\\,\\mathrm{fs}$，$M_q = 400$\n    - 情况 B：$\\Delta t = 0.50\\,\\mathrm{fs}$，$M_q = 400$\n    - 情况 C：$\\Delta t = 0.50\\,\\mathrm{fs}$，$M_q = 1600$\n- **输出格式**：$[\\Delta E_{\\mathrm{BO}}^{A}, \\Delta E_{\\mathrm{CP}}^{A}, \\Delta E_{\\mathrm{BO}}^{B}, \\Delta E_{\\mathrm{CP}}^{B}, \\Delta E_{\\mathrm{BO}}^{C}, \\Delta E_{\\mathrm{CP}}^{C}]$\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，它使用一个简化但物理上具有代表性的模型系统，对玻恩-奥本海默和卡-帕里内洛分子动力学进行了标准比较。运动方程从所提供的能量泛函中正确导出。参数、单位和常数都明确指定，并与计算化学中的标准值相符。该问题是适定的，提供了所有必要的初始条件和参数，以确保存在唯一解。该问题是客观和自洽的，没有明显的矛盾或遗漏。\n\n### 步骤 3：结论与行动\n该问题被视为有效。将构建解答。\n\n### 解答\n\n任务是模拟一维核坐标 $R$ 在两种不同理论框架下的经典动力学：玻恩–奥本海默分子动力学 (BOMD) 和卡–帕里内洛分子动力学 (CPMD)。主要目标是比较每种范式中总能量的数值守恒情况。分析将在原子单位 (a.u.) 下进行，其中电子质量 $m_e$、基本电荷 $e$、约化普朗克常数 $\\hbar$ 和玻尔半径 $a_0$ 均设为1。能量单位是哈特里 (Hartree, Ha)。\n\n首先，我们以原子单位确定常数和参数。\n哈特里到电子伏特的换算关系为 $1\\,\\mathrm{Ha} \\approx 27.211386245988\\,\\mathrm{eV}$。\n莫尔斯势的解离能为 $D = \\frac{0.22}{27.211386245988}\\,\\mathrm{Ha} \\approx 0.0080850\\,\\mathrm{Ha}$。\n其他莫尔斯参数为 $a = 3.0\\,a_0^{-1}$ 和 $R_e = 5.5\\,a_0$。\n氧二聚体约化运动的核质量 $M_R$ 为：\n$$\nM_R = \\frac{1}{2} m_{\\mathrm{O}} = \\frac{1}{2} (15.999\\,u) = \\frac{1}{2} \\times 15.999 \\times 1822.888486209 \\,m_e \\approx 14581.285 \\,m_e\n$$\nCPMD 的耦合参数为 $k_e = 0.5\\,\\mathrm{Ha}$ 和 $c = 0.05$。\n模拟时间 $T = 1\\,\\mathrm{ps} = 1000\\,\\mathrm{fs}$。从飞秒到原子时间单位的换算为：\n$$\n1\\,\\mathrm{fs} = \\frac{10^{-15}\\,\\mathrm{s}}{2.4188843265857 \\times 10^{-17}\\,\\mathrm{s/a.u.}} \\approx 41.3413745758\\,\\mathrm{a.u.}\n$$\n因此，$T \\approx 41341.37\\,\\mathrm{a.u.}$。时间步长为 $\\Delta t_A = 0.25\\,\\mathrm{fs} \\approx 10.335\\,\\mathrm{a.u.}$ 和 $\\Delta t_B = \\Delta t_C = 0.50\\,\\mathrm{fs} \\approx 20.671\\,\\mathrm{a.u.}$。\n\n运动方程使用速度Verlet算法进行积分。这是一种时间可逆的辛积分器，以其在微正则系综模拟中出色的长期能量守恒特性而闻名。对于一个质量为 $M$、受力为 $F(x)$ 的坐标 $x$，该算法的步骤如下：\n1. $v(t + \\frac{\\Delta t}{2}) = v(t) + \\frac{1}{2} \\frac{F(x(t))}{M} \\Delta t$\n2. $x(t + \\Delta t) = x(t) + v(t + \\frac{\\Delta t}{2}) \\Delta t$\n3. $v(t + \\Delta t) = v(t + \\frac{\\Delta t}{2}) + \\frac{1}{2} \\frac{F(x(t+\\Delta t))}{M} \\Delta t$\n\n积分所需的力由各自的势能导出。\n对于 BOMD，核坐标 $R$ 上的力为：\n$$\nF_R^{\\mathrm{BO}} = -\\frac{dE_{\\mathrm{BO}}}{dR} = -2aD \\left(1 - e^{-a(R - R_e)}\\right) e^{-a(R - R_e)}\n$$\n对于 CPMD，耦合坐标 $(R, q)$ 上的力为：\n$$\nF_R^{\\mathrm{CP}} = -\\frac{\\partial E_{\\mathrm{CP}}}{\\partial R} = -\\frac{dE_{\\mathrm{BO}}}{dR} + k_e c(q - cR) = F_R^{\\mathrm{BO}} + k_e c(q - cR)\n$$\n$$\nF_q^{\\mathrm{CP}} = -\\frac{\\partial E_{\\mathrm{CP}}}{\\partial q} = -k_e(q - cR)\n$$\n这定义了一个由力 $(F_R^{\\mathrm{CP}}, F_q^{\\mathrm{CP}})$ 和相应质量 $(M_R, M_q)$ 驱动的二维系统 $(R, q)$。\n\n初始条件为：$R(0) = 5.5 + 0.1 = 5.6\\,a_0$，$\\dot{R}(0) = 0$，$q(0) = c R(0) = 0.05 \\times 5.6 = 0.28$，以及 $\\dot{q}(0) = 0$。\n系统从一个偏离的核几何构型静止开始，其中虚拟电子坐标满足基态条件 $q=cR$。\n\n在轨迹的开始 ($t=0$) 和结束 ($t=T$) 时计算每次模拟的守恒总能量。\n对于 BOMD，总能量为：\n$$\nE_{\\mathrm{tot}}^{\\mathrm{BO}}(t) = \\frac{1}{2} M_R \\dot{R}(t)^2 + D \\left[\\left(1 - e^{-a(R(t) - R_e)}\\right)^2 - 1\\right]\n$$\n对于 CPMD，守恒的扩展或虚拟能量为：\n$$\nE_{\\mathrm{tot}}^{\\mathrm{CP}}(t) = \\frac{1}{2} M_R \\dot{R}(t)^2 + \\frac{1}{2} M_q \\dot{q}(t)^2 + E_{\\mathrm{BO}}(R(t)) + \\frac{1}{2} k_e (q(t) - cR(t))^2\n$$\n对六次模拟（案例 A, B, C 的 BOMD/CPMD）中的每一次计算绝对能量漂移 $\\Delta E = |E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0)|$。最终结果从哈特里转换为 eV，并以指定的精度报告。\n\n实现将包括两个主要函数，每种动力学类型一个。每个函数将接受积分时间步长和其他相关参数，执行速度Verlet积分循环直至指定的总时长，并返回能量漂移。主程序将为每个测试案例调用这些函数，并按要求格式化结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    # --- Constants and Unit Conversions ---\n    EV_PER_HA = 27.211386245988\n    AMU_PER_ME = 1822.888486209\n    AU_TIME_PER_S = 2.4188843265857e-17\n    FS_PER_S = 1e-15\n    FS_TO_AU_TIME = FS_PER_S / AU_TIME_PER_S\n\n    # --- System Parameters in Atomic Units ---\n    D_ev = 0.22\n    D_ha = D_ev / EV_PER_HA\n    A_au = 3.0\n    RE_au = 5.5\n    \n    M_O_u = 15.999\n    M_R_me = 0.5 * M_O_u * AMU_PER_ME\n    \n    K_E_ha = 0.5\n    C_dimless = 0.05\n\n    # --- Simulation Time ---\n    T_ps = 1.0\n    T_fs = T_ps * 1000.0\n    T_au = T_fs * FS_TO_AU_TIME\n\n    # --- Initial Conditions in Atomic Units ---\n    R0 = RE_au + 0.1\n    R_DOT0 = 0.0\n    Q0 = C_dimless * R0\n    Q_DOT0 = 0.0\n\n    # --- Energy and Force Functions ---\n    def e_bo(r):\n        term = 1.0 - np.exp(-A_au * (r - RE_au))\n        return D_ha * (term**2 - 1.0)\n\n    def f_bo(r):\n        exp_term = np.exp(-A_au * (r - RE_au))\n        return 2.0 * A_au * D_ha * (1.0 - exp_term) * exp_term\n\n    def e_cp(r, q):\n        return e_bo(r) + 0.5 * K_E_ha * (q - C_dimless * r)**2\n    \n    def f_cp_r(r, q):\n        return f_bo(r) + K_E_ha * C_dimless * (q - C_dimless * r)\n        \n    def f_cp_q(r, q):\n        return -K_E_ha * (q - C_dimless * r)\n\n    # --- Simulation Functions ---\n    def run_bomd(dt_fs):\n        dt_au = dt_fs * FS_TO_AU_TIME\n        num_steps = int(round(T_au / dt_au))\n\n        r = R0\n        r_dot = R_DOT0\n\n        e_initial = 0.5 * M_R_me * r_dot**2 + e_bo(r)\n        \n        # Note: The force is -dE/dR, so the sign in the update is positive for acceleration\n        accel = -f_bo(r) / M_R_me\n        for _ in range(num_steps):\n            r_dot += 0.5 * accel * dt_au\n            r += r_dot * dt_au\n            accel = -f_bo(r) / M_R_me\n            r_dot += 0.5 * accel * dt_au\n        \n        e_final = 0.5 * M_R_me * r_dot**2 + e_bo(r)\n        \n        delta_e_ha = np.abs(e_final - e_initial)\n        return delta_e_ha * EV_PER_HA\n\n    def run_cpmd(dt_fs, M_q_me):\n        dt_au = dt_fs * FS_TO_AU_TIME\n        num_steps = int(round(T_au / dt_au))\n\n        r, r_dot = R0, R_DOT0\n        q, q_dot = Q0, Q_DOT0\n\n        e_initial = 0.5 * M_R_me * r_dot**2 + 0.5 * M_q_me * q_dot**2 + e_cp(r, q)\n\n        accel_r = -f_cp_r(r, q) / M_R_me\n        accel_q = -f_cp_q(r, q) / M_q_me\n        for _ in range(num_steps):\n            # Update velocities (half step)\n            r_dot += 0.5 * accel_r * dt_au\n            q_dot += 0.5 * accel_q * dt_au\n            \n            # Update positions\n            r += r_dot * dt_au\n            q += q_dot * dt_au\n            \n            # Update accelerations\n            accel_r = -f_cp_r(r, q) / M_R_me\n            accel_q = -f_cp_q(r, q) / M_q_me\n            \n            # Update velocities (full step)\n            r_dot += 0.5 * accel_r * dt_au\n            q_dot += 0.5 * accel_q * dt_au\n\n        e_final = 0.5 * M_R_me * r_dot**2 + 0.5 * M_q_me * q_dot**2 + e_cp(r, q)\n        \n        delta_e_ha = np.abs(e_final - e_initial)\n        return delta_e_ha * EV_PER_HA\n\n    # --- Test Cases ---\n    test_cases = [\n        # (dt_fs, M_q_me)\n        (0.25, 400.0),  # Case A\n        (0.50, 400.0),  # Case B\n        (0.50, 1600.0), # Case C\n    ]\n\n    results = []\n    \n    # Case A\n    dt_A, Mq_A = test_cases[0]\n    results.append(run_bomd(dt_A))\n    results.append(run_cpmd(dt_A, Mq_A))\n\n    # Case B\n    dt_B, Mq_B = test_cases[1]\n    # BOMD results for dt=0.50fs are identical for Cases B  C\n    bomd_b_drift = run_bomd(dt_B)\n    results.append(bomd_b_drift)\n    results.append(run_cpmd(dt_B, Mq_B))\n    \n    # Case C\n    dt_C, Mq_C = test_cases[2]\n    # Re-use BOMD result\n    results.append(bomd_b_drift) # dt is the same as in B\n    results.append(run_cpmd(dt_C, Mq_C))\n\n    # --- Format and Print Output ---\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2448304"}]}