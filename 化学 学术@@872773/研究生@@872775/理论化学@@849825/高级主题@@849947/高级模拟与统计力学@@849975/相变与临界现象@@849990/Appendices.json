{"hands_on_practices": [{"introduction": "范德华方程是描述真实气体液-气相变的经典模型，也是平均场理论最早的成功范例之一。本练习将引导你运用热力学稳定性判据，即压力对体积的偏导数为零，来精确求解这个方程的旋节线与临界点。通过这个基础性的解析计算([@problem_id:2794271])，你将掌握从物态方程出发，定量分析相变行为和确定临界参数的核心方法。", "problem": "考虑一个单组分流体，其状态由关于摩尔体积 $V$ 的范德瓦尔斯方程描述：\n$$\np(V,T) \\;=\\; \\frac{R T}{V - b} \\;-\\; \\frac{a}{V^{2}},\n$$\n其中 $a0$ 和 $b0$ 是材料参数，$R$ 是普适气体常数。在经典平衡热力学的框架下，机械稳定性边界（旋节线）由等温压缩率的发散来定义，这发生在等温导数满足 $(\\partial p/\\partial V)_{T} = 0$ 的地方。临界点定义为等温线上同时满足拐点条件的点，即 $(\\partial p/\\partial V)_{T} = 0$ 和 $(\\partial^{2} p/\\partial V^{2})_{T} = 0$。\n\n仅从这些定义和给定的状态方程出发，不引入任何额外的经验关系，推导：\n- 旋节线的闭式参数表示，即作为摩尔体积 $V$ 的两个函数 $T_{s}(V)$ 和 $p_{s}(V)$。\n- 临界点 $(T_{c}, p_{c}, V_{c})$ 的解析坐标。\n\n温度以开尔文表示，压力以帕斯卡表示。最终结果需以 $a$、$b$、$R$ 和 $V$ 的精确符号形式表示；最终的方框答案中不要包含单位。将最终答案表示为一个单行矩阵，按顺序包含 $T_{s}(V)$、$p_{s}(V)$、$V_{c}$、$T_{c}$ 和 $p_{c}$。无需进行数值舍入。", "solution": "所述问题提法恰当，有科学依据，并包含了完整推导所需的所有信息。目标是为由范德瓦尔斯状态方程描述的流体推导旋节线的参数方程和临界点的坐标：\n$$\np(V,T) \\;=\\; \\frac{R T}{V - b} \\;-\\; \\frac{a}{V^{2}}\n$$\n此处，$p$ 是压力，$V$ 是摩尔体积，$T$ 是温度，$R$ 是普适气体常数，参数 $a$ 和 $b$ 是正数 ($a0$, $b0$)。\n\n我们从推导旋节线开始。旋节线是机械稳定性的边界，由压力对体积的等温导数为零的条件定义：\n$$\n\\left(\\frac{\\partial p}{\\partial V}\\right)_{T} = 0\n$$\n首先，我们从给定的状态方程计算这个偏导数：\n$$\n\\left(\\frac{\\partial p}{\\partial V}\\right)_{T} = \\frac{\\partial}{\\partial V}\\left( \\frac{R T}{V - b} - \\frac{a}{V^{2}} \\right)_{T} = -R T(V - b)^{-2} - a(-2V^{-3}) = -\\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}}\n$$\n将此表达式设为零，得到旋节线上温度和体积之间的关系。我们将旋节线上的温度记为 $T_{s}$：\n$$\n-\\frac{R T_{s}}{(V - b)^{2}} + \\frac{2a}{V^{3}} = 0\n$$\n解出 $T_{s}$ 作为 $V$ 的函数，得到第一个所需结果 $T_{s}(V)$：\n$$\n\\frac{R T_{s}}{(V - b)^{2}} = \\frac{2a}{V^{3}} \\implies T_{s}(V) = \\frac{2a(V - b)^{2}}{R V^{3}}\n$$\n为求得旋节线上的相应压力 $p_{s}(V)$，我们将 $T_{s}(V)$ 的表达式代回原始的范德瓦尔斯方程：\n$$\np_{s}(V) = p(V, T_{s}(V)) = \\frac{R T_{s}(V)}{V - b} - \\frac{a}{V^{2}}\n$$\n$$\np_{s}(V) = \\frac{R}{V - b} \\left( \\frac{2a(V - b)^{2}}{R V^{3}} \\right) - \\frac{a}{V^{2}}\n$$\n化简表达式，约去 $R$ 和一个 $(V - b)$ 因子：\n$$\np_{s}(V) = \\frac{2a(V - b)}{V^{3}} - \\frac{a}{V^{2}} = \\frac{2aV - 2ab}{V^{3}} - \\frac{aV}{V^{3}} = \\frac{aV - 2ab}{V^{3}}\n$$\n因此，旋节线上的压力由下式给出：\n$$\np_{s}(V) = \\frac{a(V - 2b)}{V^{3}}\n$$\n接下来，我们确定临界点 $(V_{c}, T_{c}, p_{c})$ 的坐标。临界点定义为等温线上压力对体积的一阶和二阶导数同时为零的点：\n$$\n\\left(\\frac{\\partial p}{\\partial V}\\right)_{T} = 0 \\quad \\text{和} \\quad \\left(\\frac{\\partial^{2} p}{\\partial V^{2}}\\right)_{T} = 0\n$$\n我们已经求出了一阶导数。现在我们通过对一阶导数在恒定 $T$ 下关于 $V$ 求导来计算二阶导数：\n$$\n\\left(\\frac{\\partial^{2} p}{\\partial V^{2}}\\right)_{T} = \\frac{\\partial}{\\partial V}\\left( -\\frac{R T}{(V - b)^{2}} + \\frac{2a}{V^{3}} \\right)_{T} = \\frac{2 R T}{(V - b)^{3}} - \\frac{6a}{V^{4}}\n$$\n在临界点 $(V_{c}, T_{c})$，两个导数必须同时为零，这给出了以下两个方程组成的方程组：\n$$\n(1): \\quad -\\frac{R T_{c}}{(V_{c} - b)^{2}} + \\frac{2a}{V_{c}^{3}} = 0 \\implies \\frac{R T_{c}}{(V_{c} - b)^{2}} = \\frac{2a}{V_{c}^{3}}\n$$\n$$\n(2): \\quad \\frac{2 R T_{c}}{(V_{c} - b)^{3}} - \\frac{6a}{V_{c}^{4}} = 0 \\implies \\frac{2 R T_{c}}{(V_{c} - b)^{3}} = \\frac{6a}{V_{c}^{4}}\n$$\n让我们用方程 $(2)$ 除以方程 $(1)$。$R T_{c}$ 和 $a$ 项将消去，$V_c$ 和 $(V_c-b)$ 的幂次也会约去：\n$$\n\\frac{2 R T_{c} / (V_{c} - b)^{3}}{R T_{c} / (V_{c} - b)^{2}} = \\frac{6a / V_{c}^{4}}{2a / V_{c}^{3}}\n$$\n$$\n\\frac{2}{V_{c} - b} = \\frac{3}{V_{c}}\n$$\n这个代数方程可以解出 $V_{c}$：\n$$\n2V_{c} = 3(V_{c} - b) \\implies 2V_{c} = 3V_{c} - 3b \\implies V_{c} = 3b\n$$\n这就是临界摩尔体积。为了求出临界温度 $T_{c}$，我们将 $V_{c} = 3b$ 代回整理后的方程 $(1)$：\n$$\nR T_{c} = \\frac{2a(V_{c} - b)^{2}}{V_{c}^{3}} = \\frac{2a(3b - b)^{2}}{(3b)^{3}} = \\frac{2a(2b)^{2}}{27b^{3}} = \\frac{2a(4b^{2})}{27b^{3}} = \\frac{8ab^{2}}{27b^{3}} = \\frac{8a}{27b}\n$$\n因此，临界温度为：\n$$\nT_{c} = \\frac{8a}{27Rb}\n$$\n最后，为了求出临界压力 $p_{c}$，我们将 $V_{c}$ 和 $T_{c}$ 代入原始的范德瓦尔斯方程：\n$$\np_{c} = \\frac{R T_{c}}{V_{c} - b} - \\frac{a}{V_{c}^{2}} = \\frac{R}{3b - b}\\left(\\frac{8a}{27Rb}\\right) - \\frac{a}{(3b)^{2}}\n$$\n$$\np_{c} = \\frac{R}{2b}\\left(\\frac{8a}{27Rb}\\right) - \\frac{a}{9b^{2}} = \\frac{8aR}{54b^{2}R} - \\frac{a}{9b^{2}} = \\frac{4a}{27b^{2}} - \\frac{a}{9b^{2}}\n$$\n为了进行分数相减，我们使用公分母 $27b^{2}$：\n$$\np_{c} = \\frac{4a}{27b^{2}} - \\frac{3a}{27b^{2}} = \\frac{a}{27b^{2}}\n$$\n将推导出的各量汇总作为最终答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2a(V-b)^{2}}{RV^{3}},  \\frac{a(V-2b)}{V^{3}},  3b,  \\frac{8a}{27Rb},  \\frac{a}{27b^{2}}\n\\end{pmatrix}\n}\n$$", "id": "2794271"}, {"introduction": "在临界点附近，物理量的奇异行为由普适的标度律和临界指数支配，这是超越平均场理论的现代理论核心。本练习模拟一个真实的实验场景，要求你通过分析临界乳光（浊度）数据来测定磁化率指数 $\\gamma$ ([@problem_id:2794267])。你将通过编程实现对数线性回归，并学习如何校正由多重散射引起的系统误差，从而亲身體验从实验数据中提取普适物理规律的过程。", "problem": "考虑一个接近其在温度 $T_{\\mathrm{c}}$ 的分相临界点的近临界二元液体混合物。定义约化温度 $t \\equiv (T - T_{\\mathrm{c}})/T_{\\mathrm{c}}$。在单次散射（Rayleigh-Gans-Debye）区域，混合物的浊度 $\\,\\tau\\,$（定义为比尔-朗伯形式 $I(L) = I(0)\\exp(-\\tau L)$ 中单位路径长度的衰减系数）与零波数静态结构因子 $S(0)$ 成正比。根据平衡统计力学以及 $S(0)$ 与等温感受性之间的涨落-耗散关联，在接近 $T_{\\mathrm{c}}$ 的渐近标度区域，$S(0)$ 的量值随 $|t|$ 的幂律发散。该幂律指数是临界感受性指数，记为 $\\gamma$。多次散射会导致测量浊度与单次散射浊度之间出现偏差，从而在指数估计中产生系统性偏差。一个常见的用于漫射介质中多次散射的小光深模型，将测量的衰减按散射事件数展开，在超出单次散射的主导阶上，得到一个观测模型，形式为 $\\tau_{\\mathrm{obs}} \\approx \\tau_{\\mathrm{true}} + \\beta\\,\\tau_{\\mathrm{true}}^{2}$，其中无量纲系数 $\\beta \\ge 0$ 用于参数化在固定几何形状和波长下多次散射的强度。本问题中的所有量都是无量纲的，不需要物理单位。\n\n任务：从上述基本原理出发，实现一个程序，该程序：\n- 利用 $S(0)$ 随 $|t|$ 幂律发散的假设，通过对数变量的线性回归，从合成的浊度数据中估计感受性指数 $\\gamma$。您的估计器应利用幂律关系在对数变量中变为仿射关系的特性，并且必须返回指数的估计值。\n- 通过比较从未经处理的观测数据 $\\tau_{\\mathrm{obs}}$ 估计的指数和从根据二次观测模型 $\\tau_{\\mathrm{obs}} \\approx \\tau_{\\mathrm{true}} + \\beta\\,\\tau_{\\mathrm{true}}^{2}$ 校正多次散射后的数据估计的指数，来量化由多次散射引起的系统性偏差。对于 $\\beta  0$，使用此二次模型的精确代数反演来实现从 $\\tau_{\\mathrm{obs}}$ 回到 $\\tau_{\\mathrm{true}}$ 的校正映射；当 $\\beta = 0$ 时，简化为恒等映射。\n\n数据生成协议，您的程序将使用此协议：\n- 对于给定的振幅 $A  0$ 和真实指数 $\\gamma_{\\mathrm{true}}  0$，将单次散射浊度定义为 $\\tau_{\\mathrm{true}}(t) = A\\,|t|^{-\\gamma_{\\mathrm{true}}}$，并在一个指定的约化温度 $t$ 网格上进行评估，该网格包括高于和低于 $T_{\\mathrm{c}}$ 的值（对标度律使用绝对值 $|t|$）。\n- 对于给定的非负 $\\beta$，通过 $\\tau_{\\mathrm{obs}} = \\tau_{\\mathrm{true}} + \\beta\\,\\tau_{\\mathrm{true}}^{2}$ 将 $\\tau_{\\mathrm{true}}$ 映射到观测浊度。\n- 不要添加任何额外的噪声；将噪声水平设置为零以隔离系统性效应。\n\n估计器规范：\n- 给定一组数据对 $\\{(t_i,\\tau_i)\\}_{i=1}^{N}$，通过对变量 $\\{\\ln|t_i|,\\ln \\tau_i\\}$ 使用普通最小二乘法拟合仿射关系来估计 $\\gamma$。将拟合斜率的相反数作为指数的估计值报告。\n\n多次散射校正：\n- 对于 $\\beta  0$，通过精确反演二次映射，将每个观测值 $\\tau_{\\mathrm{obs}}$ 校正为 $\\tau_{\\mathrm{true}}$ 的估计值，即求解 $\\beta\\,\\tau_{\\mathrm{true}}^{2} + \\tau_{\\mathrm{true}} - \\tau_{\\mathrm{obs}} = 0$ 的正根。当 $\\beta = 0$ 时，使用 $\\tau_{\\mathrm{true}} = \\tau_{\\mathrm{obs}}$。\n\n测试套件：\n在以下三个合成数据集上实现并运行您的估计器。在每个数据集中，生成 $t$ 网格，其数值在 $t_{\\min}$ 和 $t_{\\max}$ 之间呈对数分布，并交替符号以包含 $t  0$ 和 $t  0$ 的情况；具体来说，让 $|t|$ 在 $t_{\\min}$ 和 $t_{\\max}$ 之间取 $N$ 个对数间隔的值，并为第 $i$ 个点分配符号 $(-1)^{i}$，以便对 $T_{\\mathrm{c}}$ 两侧都进行采样。使用以下参数集：\n- 情况1（理想路径，单次散射）：$A = 10^{-5}$，$\\gamma_{\\mathrm{true}} = 1.24$，$\\beta = 0$，$t_{\\min} = 10^{-3}$，$t_{\\max} = 10^{-1}$，$N = 21$。\n- 情况2（中等多次散射）：$A = 10^{-5}$，$\\gamma_{\\mathrm{true}} = 1.24$，$\\beta = 0.4$，$t_{\\min} = 10^{-3}$，$t_{\\max} = 10^{-1}$，$N = 21$。\n- 情况3（强多次散射，更接近临界点）：$A = 10^{-5}$，$\\gamma_{\\mathrm{true}} = 1.24$，$\\beta = 2.0$，$t_{\\min} = 10^{-4}$，$t_{\\max} = 10^{-1}$，$N = 31$。\n\n您的程序必须计算并输出：\n- 对于每种情况，计算两个指数估计值：一个来自原始观测数据（未校正），另一个来自使用二次反演校正多次散射后的数据。将每个估计的指数四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含六个浮点数，分别对应情况1、情况2、然后是情况3的原始和校正后的指数估计值。例如，您的输出格式应为 $[\\gamma_{1,\\mathrm{raw}},\\gamma_{1,\\mathrm{corr}},\\gamma_{2,\\mathrm{raw}},\\gamma_{2,\\mathrm{corr}},\\gamma_{3,\\mathrm{raw}},\\gamma_{3,\\mathrm{corr}}]$，每个条目都四舍五入到三位小数。\n\n注意：\n- 所有量都是无量纲的；不需要物理单位。\n- 确保校正映射对所有指定参数都具有数值稳定性。", "solution": "问题陈述已经过严格验证，被确定为科学上合理、问题明确且内部一致。它在理论化学领域，特别是在临界现象分析方面，提出了一个明确的任务。因此，我们可以着手提供一个完整的解决方案。\n\n问题的核心在于分析物理量——浊度 $\\tau$ 在临界点附近的幂律发散行为。根据标度律，真实的单次散射浊度 $\\tau_{\\mathrm{true}}$ 作为约化温度 $t \\equiv (T - T_{\\mathrm{c}})/T_{\\mathrm{c}}$ 的函数发散：\n$$\n\\tau_{\\mathrm{true}}(t) = A |t|^{-\\gamma_{\\mathrm{true}}}\n$$\n这里，$A$ 是一个振幅，$\\gamma_{\\mathrm{true}}$ 是真实的临界感受性指数。指定的值 $\\gamma_{\\mathrm{true}} = 1.24$ 与3D Ising普适类的理论值一致，二元流体分相属于该普适类。\n\n为了从一组测量值 $\\{ (t_i, \\tau_i) \\}$ 中估计指数 $\\gamma$，我们可以通过对等式两边取自然对数来线性化幂律关系：\n$$\n\\ln(\\tau_{\\mathrm{true}}) = \\ln(A |t|^{-\\gamma_{\\mathrm{true}}}) = \\ln(A) + \\ln(|t|^{-\\gamma_{\\mathrm{true}}}) = \\ln(A) - \\gamma_{\\mathrm{true}} \\ln(|t|)\n$$\n这个方程具有直线形式 $y = c + mx$，其中因变量是 $y = \\ln(\\tau_{\\mathrm{true}})$，自变量是 $x = \\ln(|t|)$，截距是 $c = \\ln(A)$，斜率是 $m = -\\gamma_{\\mathrm{true}}$。因此，临界指数可以估计为对数-对数图上数据拟合直线斜率的相反数。指定的估计方法是关于变量 $(\\ln|t_i|, \\ln\\tau_i)$ 的普通最小二乘（OLS）线性回归。\n\n当浊度很高（即非常接近临界点）时，多次散射会变得显著，从而产生一个复杂问题。问题提供了一个关于观测浊度 $\\tau_{\\mathrm{obs}}$ 的主导阶修正模型：\n$$\n\\tau_{\\mathrm{obs}} \\approx \\tau_{\\mathrm{true}} + \\beta \\tau_{\\mathrm{true}}^2\n$$\n其中 $\\beta \\ge 0$ 是一个量化多次散射强度的系数。$\\tau_{\\mathrm{obs}}$ 和 $\\tau_{\\mathrm{true}}$ 之间的这种非线性关系意味着 $\\tau_{\\mathrm{obs}}$ 对 $|t|$ 的对数-对数图将不再是一条直线。这种效应引入的曲率将系统性地偏置从线性拟合中获得的指数估计值。从未经校正的数据得到的估计值 $\\gamma_{\\mathrm{raw}}$ 将偏离 $\\gamma_{\\mathrm{true}}$。\n\n为了获得无偏估计，我们必须首先校正观测数据 $\\tau_{\\mathrm{obs}}$，以恢复真实浊度 $\\tau_{\\mathrm{true}}$ 的估计值。这需要反演二次模型。重新排列方程得到一个关于 $\\tau_{\\mathrm{true}}$ 的标准二次方程形式：\n$$\n\\beta \\tau_{\\mathrm{true}}^2 + \\tau_{\\mathrm{true}} - \\tau_{\\mathrm{obs}} = 0\n$$\n对于 $\\beta  0$，二次公式产生两个可能的 $\\tau_{\\mathrm{true}}$ 解：\n$$\n\\tau_{\\mathrm{true}} = \\frac{-1 \\pm \\sqrt{1^2 - 4(\\beta)(-\\tau_{\\mathrm{obs}})}}{2\\beta} = \\frac{-1 \\pm \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}}}{2\\beta}\n$$\n由于浊度必须是一个非负的物理量（$\\tau_{\\mathrm{true}}  0$），我们必须选择正根。对于 $\\beta  0$ 和 $\\tau_{\\mathrm{obs}}  0$，判别式总是大于1，因此保证有实根。选择‘+’号给出物理上有意义的正解。当 $\\beta$ 很小时，直接实现该公式可能会在分子中遭受灾难性抵消。为确保数值稳定性，我们可以对分子进行有理化：\n$$\n\\tau_{\\mathrm{true}} = \\frac{-1 + \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}}}{2\\beta} \\cdot \\frac{1 + \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}}}{1 + \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}}} = \\frac{(1 + 4\\beta\\tau_{\\mathrm{obs}}) - 1}{2\\beta(1 + \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}})} = \\frac{2\\tau_{\\mathrm{obs}}}{1 + \\sqrt{1 + 4\\beta\\tau_{\\mathrm{obs}}}}\n$$\n这种形式对于所有 $\\beta \\ge 0$ 都是数值稳定的。在 $\\beta = 0$ 的特殊情况下，模型简化为 $\\tau_{\\mathrm{obs}} = \\tau_{\\mathrm{true}}$，不需要校正。当 $\\beta \\to 0$ 时，该稳定公式正确地趋近于 $\\tau_{\\mathrm{true}} = \\tau_{\\mathrm{obs}}$。\n\n对于每个测试用例，实现将按以下步骤进行：\n$1$。生成 $N$ 个约化温度 $t_i$ 的网格。其数值 $|t_i|$ 在 $t_{\\min}$ 和 $t_{\\max}$ 之间呈对数间隔分布。符号按规定交替。\n$2$。计算每个点的真实浊度 $\\tau_{\\mathrm{true},i} = A|t_i|^{-\\gamma_{\\mathrm{true}}}$。\n$3$。计算观测浊度 $\\tau_{\\mathrm{obs},i} = \\tau_{\\mathrm{true},i} + \\beta \\tau_{\\mathrm{true},i}^2$。\n$4$。通过对点 $(\\ln|t_i|, \\ln\\tau_{\\mathrm{obs},i})$ 进行线性回归并取斜率的相反数，来估计原始指数 $\\gamma_{\\mathrm{raw}}$。\n$5$。对每个 $\\tau_{\\mathrm{obs},i}$ 应用校正程序以获得校正后的浊度 $\\tau_{\\mathrm{corr},i}$。对于 $\\beta  0$，使用稳定的二次反演公式。对于 $\\beta = 0$，$\\tau_{\\mathrm{corr},i} = \\tau_{\\mathrm{obs},i}$。\n$6$。通过对点 $(\\ln|t_i|, \\ln\\tau_{\\mathrm{corr},i})$ 进行线性回归并取斜率的相反数，来估计校正后的指数 $\\gamma_{\\mathrm{corr}}$。\n$7$。最终结果四舍五入到三位小数，并按指定格式报告。线性回归将使用 `numpy.polyfit` 执行。", "answer": "```python\nimport numpy as np\n\ndef estimate_exponent(t_values, tau_values):\n    \"\"\"\n    Estimates the exponent gamma by linear regression on logarithmic variables.\n    The model is ln(tau) = ln(A) - gamma * ln(|t|).\n    The exponent gamma is the negative of the slope.\n    \n    Args:\n        t_values (np.ndarray): Array of reduced temperatures.\n        tau_values (np.ndarray): Array of corresponding turbidity values.\n        \n    Returns:\n        float: The estimated exponent gamma.\n    \"\"\"\n    log_t_abs = np.log(np.abs(t_values))\n    log_tau = np.log(tau_values)\n    \n    # Perform ordinary least squares linear regression (degree 1 polynomial fit).\n    # polyfit returns [slope, intercept].\n    slope, _ = np.polyfit(log_t_abs, log_tau, 1)\n    \n    # The exponent gamma is the negative of the slope.\n    return -slope\n\ndef correct_turbidity(tau_obs, beta):\n    \"\"\"\n    Corrects observed turbidity for multiple scattering effects.\n    \n    Inverts the model tau_obs = tau_true + beta * tau_true^2 to find tau_true.\n    \n    Args:\n        tau_obs (np.ndarray): Array of observed turbidity values.\n        beta (float): Multiple scattering coefficient.\n        \n    Returns:\n        np.ndarray: Array of corrected (true) turbidity values.\n    \"\"\"\n    if beta == 0:\n        return tau_obs\n    \n    # Use the numerically stable formula for the positive root of the quadratic equation:\n    # beta * tau_true^2 + tau_true - tau_obs = 0\n    # tau_true = (2 * tau_obs) / (1 + sqrt(1 + 4 * beta * tau_obs))\n    discriminant = 1 + 4 * beta * tau_obs\n    tau_true = (2 * tau_obs) / (1 + np.sqrt(discriminant))\n    return tau_true\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, single scattering)\n        {'A': 1e-5, 'gamma_true': 1.24, 'beta': 0.0, 't_min': 1e-3, 't_max': 1e-1, 'N': 21},\n        # Case 2 (moderate multiple scattering)\n        {'A': 1e-5, 'gamma_true': 1.24, 'beta': 0.4, 't_min': 1e-3, 't_max': 1e-1, 'N': 21},\n        # Case 3 (strong multiple scattering, closer to criticality)\n        {'A': 1e-5, 'gamma_true': 1.24, 'beta': 2.0, 't_min': 1e-4, 't_max': 1e-1, 'N': 31},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case['A']\n        gamma_true = case['gamma_true']\n        beta = case['beta']\n        t_min = case['t_min']\n        t_max = case['t_max']\n        N = case['N']\n\n        # 1. Generate synthetic data\n        # |t| grid, logarithmically spaced\n        t_magnitudes = np.logspace(np.log10(t_min), np.log10(t_max), N)\n        # Apply alternating signs, according to the problem statement (-1)^i for i=0,1,2...\n        signs = (-1.0)**np.arange(N)\n        # Problem says i-th point has sign (-1)^i. Python's arange starts at 0.\n        # This makes the first point (i=0) positive.\n        t_grid = t_magnitudes * signs\n        \n        # Calculate true turbidity\n        tau_true = A * (np.abs(t_grid))**(-gamma_true)\n        \n        # Calculate observed turbidity\n        tau_obs = tau_true + beta * tau_true**2\n\n        # 2. Estimate exponent from raw (observed) data\n        gamma_raw = estimate_exponent(t_grid, tau_obs)\n        \n        # 3. Correct observed data for multiple scattering\n        tau_corrected = correct_turbidity(tau_obs, beta)\n        \n        # 4. Estimate exponent from corrected data\n        gamma_corrected = estimate_exponent(t_grid, tau_corrected)\n        \n        # 5. Round and store results\n        results.append(round(gamma_raw, 3))\n        results.append(round(gamma_corrected, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2794267"}, {"introduction": "重整化群（RG）是理解临界现象中标度律和普适性的最强大理论工具。其核心思想是通过系统地积分掉短程涨落，来考察系统在不同尺度下的有效理论演化。本练习 ([@problem_id:2794283]) 将带你亲手执行一次Wilson动量壳层重整化计算，为关键的 $\\phi^4$ 理论推导其耦合常数的流方程，并求解出控制临界行为的非平庸不动点。这将让你深刻理解普适性并非巧合，而是RG流在不动点附近支配的必然结果。", "problem": "考虑一个具有紫外动量截断 $\\Lambda$ 的单分量序参量场 $\\phi(\\mathbf{x})$ 的标量 Landau–Ginzburg–Wilson 哈密顿量：\n$$\n\\mathcal{H}[\\phi] \\;=\\; \\int d^d x \\left[ \\frac{1}{2}(\\nabla \\phi)^2 \\;+\\; \\frac{1}{2} r\\, \\phi^2 \\;+\\; \\frac{u}{4!}\\, \\phi^4 \\right],\n$$\n该模型描述了临界点附近类伊辛 (Ising) 流体的普适长波行为。使用动量壳层方案中的 Wilson 重整化群 (RG) 方法，将场 $\\phi$ 分解为慢变分量 $\\phi_{}$ 和快变分量 $\\phi_{}$，即 $\\phi = \\phi_{} + \\phi_{}$，其中傅里叶模式对于 $\\phi_{}$ 满足 $|\\mathbf{q}|\\Lambda/b$，对于 $\\phi_{}$ 满足 $\\Lambda/b|\\mathbf{q}|\\Lambda$。进行累积量展开，对 $u$ 保留到领头非平庸阶，积分掉快变模式 $\\phi_{}$，然后重标定长度和场以将截断恢复到 $\\Lambda$：\n- 将长度重标定因子 $b1$，动量重标定因子 $b^{-1}$，从而恢复截断，\n- 选择场的重标定方式，使二次梯度项的系数保持不变。\n\n根据此构造，推导在任意空间维度 $d=4-\\varepsilon$ 下耦合常数 $r$ 和 $u$ 的单圈流方程（保留到 $u$ 的领头阶），并将所有壳层积分用以下形式表示：\n$$\nK_d \\;=\\; \\frac{S_d}{(2\\pi)^d}, \\quad S_d \\;=\\; \\frac{2\\pi^{d/2}}{\\Gamma(d/2)}.\n$$\n定义无量纲耦合常数 $\\tilde{r} = r/\\Lambda^2$ 和 $\\tilde{u} = K_d \\Lambda^{-\\varepsilon} u$。然后，在 $\\varepsilon$ 的领头阶下，确定四次耦合的非平庸不动点值 $\\tilde{u}^{*}$。您的最终答案必须是关于 $\\varepsilon$ 的单个闭合形式解析表达式。不包含任何单位。", "solution": "该问题在科学上是可靠且提法正确的，是关于临界现象的Wilson重整化群方法的一个标准练习。以下是完整的推导过程。\n\n出发点是 Landau-Ginzburg-Wilson 哈密顿量：\n$$\n\\mathcal{H}[\\phi] = \\int \\frac{d^d q}{(2\\pi)^d} \\frac{1}{2} (q^2+r)\\phi(\\mathbf{q})\\phi(-\\mathbf{q}) + \\frac{u}{4!} \\int \\left(\\prod_{i=1}^4 \\frac{d^d q_i}{(2\\pi)^d} \\right) (2\\pi)^d \\delta\\left(\\sum \\mathbf{q}_i\\right) \\phi_1\\phi_2\\phi_3\\phi_4.\n$$\n\nRG步骤如下：\n1.  **粗粒化**：将场 $\\phi$ 分解为慢变模式 $\\phi_$ ($0 \\le |\\mathbf{q}|  \\Lambda/b$) 和快变模式 $\\phi_$ ($\\Lambda/b \\le |\\mathbf{q}|  \\Lambda$)。然后积分掉快变模式 $\\phi_$, 得到慢变模式的有效哈密顿量 $\\mathcal{H}_[\\phi_]$。\n    $$\n    e^{-\\mathcal{H}_} = \\int \\mathcal{D}\\phi_ \\, e^{-\\mathcal{H}[\\phi_+\\phi_]}\n    $$\n    利用累积量展开，对相互作用项 $u$ 保留到最低非平庸阶：\n    $$\n    \\Delta\\mathcal{H}_ = \\langle V \\rangle_ - \\frac{1}{2}\\left( \\langle V^2 \\rangle_ - \\langle V \\rangle_^2 \\right) + \\dots\n    $$\n    其中 $\\langle \\dots \\rangle_$ 表示对自由快变场 $\\mathcal{H}_0[\\phi_]$ 取平均。\n    \n    a) 对 $r$ 的修正（单圈图，即“tadpole”图）：$V$ 中包含 $\\frac{u}{4!} \\binom{4}{2} \\phi_^2 \\phi_^2 = \\frac{u}{4} \\phi_^2 \\phi_^2$ 这样的项。取其平均值：\n    $$\n    \\delta\\mathcal{H}_r = \\langle \\int d^dx \\frac{u}{4}\\phi_^2\\phi_^2 \\rangle_ = \\int d^dx \\frac{u}{4}\\phi_^2 \\langle\\phi_^2\\rangle_\n    $$\n    其中 $\\langle\\phi_^2\\rangle_ = \\int_{\\Lambda/b}^{\\Lambda} \\frac{d^dq}{(2\\pi)^d} \\frac{1}{q^2+r} \\approx \\int_{\\Lambda/b}^{\\Lambda} \\frac{d^dq}{(2pi)^d} \\frac{1}{q^2}$。\n    对于一个薄动量壳层 $b = 1+\\delta\\ell \\approx e^{\\delta\\ell}$，积分测度为 $K_d \\Lambda^{d-1} d q$, 积分范围为 $\\Lambda(1-\\delta\\ell)$ 到 $\\Lambda$。\n    $$\n    \\langle\\phi_^2\\rangle_ = K_d \\int_{\\Lambda(1-\\delta\\ell)}^{\\Lambda} q^{d-1} \\frac{1}{q^2} dq \\approx K_d \\Lambda^{d-3} (\\Lambda\\delta\\ell) = K_d \\Lambda^{d-2} \\delta\\ell.\n    $$\n    所以，对哈密顿量中 $\\frac{1}{2}r\\phi_^2$ 项的修正是 $\\delta r = \\frac{u}{2} K_d \\Lambda^{d-2}$。\n\n    b) 对 $u$ 的修正（单圈图）：这来自于 $\\langle V^2 \\rangle_$ 项。$V$ 中形如 $\\frac{u}{4!} \\phi_^4$ 的项的平方的期望值，会导致一个对 $\\phi_^4$ 的修正。计算结果为：\n    $$\n    \\delta\\mathcal{H}_u = -\\frac{1}{2} \\left\\langle \\left( \\int d^dx \\frac{u}{4!} \\phi_^4 \\right)^2 \\right\\rangle_{V \\to \\phi_^4} \\implies \\delta u = -\\frac{3u^2}{2} \\int_{\\Lambda/b}^{\\Lambda} \\frac{d^dq}{(2\\pi)^d} \\frac{1}{(q^2+r)^2}\n    $$\n    近似为 $r=0$：\n    $$\n    \\delta u = -\\frac{3u^2}{2} K_d \\int_{\\Lambda(1-\\delta\\ell)}^{\\Lambda} q^{d-5} dq \\approx -\\frac{3u^2}{2} K_d \\Lambda^{d-5} (\\Lambda\\delta\\ell) = -\\frac{3u^2}{2} K_d \\Lambda^{d-4} \\delta\\ell.\n    $$\n    积分后，新的耦合常数变为 $r_{new} = r + \\delta r \\cdot \\delta\\ell$ 和 $u_{new} = u + \\delta u \\cdot \\delta\\ell$。\n\n2.  **重标度**：我们重标度长度 $x \\to x' = x/b$ 和场 $\\phi_(\\mathbf{x}) \\to \\phi'(\\mathbf{x'}) = \\zeta^{-1} \\phi_(b\\mathbf{x'})$。\n    动能项 $\\int d^dx \\frac{1}{2}(\\nabla\\phi_)^2$ 变为 $\\int d^dx' b^d \\frac{1}{2} (b^{-1}\\nabla'\\zeta\\phi')^2 = \\int d^dx' \\frac{1}{2} \\zeta^2 b^{d-2} (\\nabla'\\phi')^2$。为保持其形式不变，需 $\\zeta = b^{-(d-2)/2}$。\n    这导致参数的重标度：\n    $r' = b^2 r_{new}$\n    $u' = b^{4-d} u_{new} = b^{\\varepsilon} u_{new}$\n\n3.  **流方程**：将 $b = 1+\\delta\\ell$ 代入，并将 $r'$ 和 $u'$ 展开到 $\\delta\\ell$ 的一阶。\n    $r' = (1+2\\delta\\ell)(r + \\frac{u}{2} K_d \\Lambda^{d-2} \\delta\\ell) \\approx r + (2r + \\frac{u}{2} K_d \\Lambda^{d-2}) \\delta\\ell$\n    $\\implies \\frac{dr}{d\\ell} = 2r + \\frac{u}{2} K_d \\Lambda^{d-2}$\n\n    $u' = (1+\\varepsilon\\delta\\ell)(u - \\frac{3u^2}{2} K_d \\Lambda^{-\\varepsilon} \\delta\\ell) \\approx u + (\\varepsilon u - \\frac{3u^2}{2} K_d \\Lambda^{-\\varepsilon}) \\delta\\ell$\n    $\\implies \\frac{du}{d\\ell} = \\varepsilon u - \\frac{3u^2}{2} K_d \\Lambda^{-\\varepsilon}$\n\n4.  **无量纲耦合与不动点**：引入无量纲耦合 $\\tilde{r} = r/\\Lambda^2$ 和 $\\tilde{u} = u K_d \\Lambda^{-\\varepsilon}$。\n    流方程变为：\n    $$\n    \\frac{d\\tilde{u}}{d\\ell} = \\frac{d(u K_d \\Lambda^{-\\varepsilon})}{d\\ell} = K_d \\Lambda^{-\\varepsilon} \\frac{du}{d\\ell} + u K_d \\frac{d\\Lambda^{-\\varepsilon}}{d\\ell}\n    $$\n    在RG流中，$\\Lambda \\to \\Lambda/b = \\Lambda e^{-\\delta\\ell}$，所以 $\\Lambda(\\ell) = \\Lambda_0 e^{-\\ell}$。因此 $\\frac{d\\Lambda}{d\\ell} = -\\Lambda$。\n    $\\frac{d\\Lambda^{-\\varepsilon}}{d\\ell} = -\\varepsilon \\Lambda^{-\\varepsilon-1} (-\\Lambda) = \\varepsilon \\Lambda^{-\\varepsilon}$。\n    $$\n    \\frac{d\\tilde{u}}{d\\ell} = K_d \\Lambda^{-\\varepsilon} (\\varepsilon u - \\frac{3u^2}{2} K_d \\Lambda^{-\\varepsilon}) + u K_d (\\varepsilon \\Lambda^{-\\varepsilon}) = \\varepsilon (u K_d \\Lambda^{-\\varepsilon}) - \\frac{3}{2} (u K_d \\Lambda^{-\\varepsilon})^2 + \\varepsilon (u K_d \\Lambda^{-\\varepsilon})\n    $$\n    这里有个小错误，流方程的推导中，$\\ell$ 的增加对应于 $b$ 的增加，即积分掉高动量。$d/d\\ell$ 已经包含了重标度的效应。\n    所以，直接从 $u$ 的流方程变换到 $\\tilde{u}$ 的流方程：\n    $\\frac{du}{d\\ell} = \\varepsilon u - \\frac{3}{2} u \\tilde{u}$。\n    $\\frac{d\\tilde{u}}{d\\ell} = K_d \\Lambda^{-\\varepsilon} \\frac{du}{d\\ell} = K_d \\Lambda^{-\\varepsilon} (\\varepsilon u - \\frac{3u^2}{2} K_d \\Lambda^{-\\varepsilon}) = \\varepsilon \\tilde{u} - \\frac{3}{2} \\tilde{u}^2$。\n    \n    设置 $\\beta(\\tilde{u}) = \\frac{d\\tilde{u}}{d\\ell} = 0$ 来寻找不动点：\n    $$\n    \\varepsilon \\tilde{u}^* - \\frac{3}{2}(\\tilde{u}^*)^2 = 0\n    $$\n    $$\n    \\tilde{u}^* \\left( \\varepsilon - \\frac{3}{2}\\tilde{u}^* \\right) = 0\n    $$\n    这给出两个不动点：\n    1.  高斯不动点 (平凡)：$\\tilde{u}^* = 0$\n    2.  Wilson-Fisher 不动点 (非平庸)：$\\tilde{u}^* = \\frac{2}{3}\\varepsilon$\n\n    最终答案是 Wilson-Fisher 不动点的值。", "answer": "$$\\boxed{\\frac{2}{3}\\varepsilon}$$", "id": "2794283"}]}