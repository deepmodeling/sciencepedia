{"hands_on_practices": [{"introduction": "多维量子动力学的主要挑战是计算资源随自由度数量呈指数增长，这个问题被称为“维度灾难”。本练习通过估算存储MCTDH系数张量 $A$ 所需的内存，对这一挑战进行了量化分析，并展示了现代张量网络格式（如张量列 (Tensor Train, TT) 分解）如何提供一种实用的解决方案。通过比较存储成本，你将对这些压缩表示的效率有切身的体会。[@problem_id:2817991]", "problem": "考虑一个具有 $f$ 个自由度的系统的多组态含时哈特里 (MCTDH) 波函数，该波函数在含时单粒子函数的直积基中写作\n$$\n|\\Psi(t)\\rangle \\;=\\; \\sum_{j_1=1}^{n_1}\\cdots \\sum_{j_f=1}^{n_f} A_{j_1\\cdots j_f}(t)\\,\\bigotimes_{k=1}^{f} |\\varphi^{(k)}_{j_k}(t)\\rangle,\n$$\n其中 $A_{j_1\\cdots j_f}(t)$ 是组态系数张量。假设每个系数都存储为一个128位复数（即每个条目 $16$ 字节）。\n\n已知该系统有 $f=8$ 个模，其模维度为 $n_1=n_2=20$，$n_3=n_4=18$，$n_5=n_6=16$，以及 $n_7=n_8=14$。对于 $A_{j_1\\cdots j_f}$，您考虑两种存储策略：\n- 完整的密集张量，它显式存储所有条目。\n- 张量列 (TT)，也称为矩阵乘积态 (MPS)，其内部 TT 秩统一为 $r_k=r=30$ ($k=1,\\dots,f-1$)，边界秩为 $r_0=r_f=1$。\n\n仅从上述直积展开的定义以及 TT 表示为 $f$ 个大小为 $r_{k-1}\\times n_k\\times r_k$ 的三指标核的乘积出发，完成以下任务：\n- 推导密集表示和 TT 表示的总参数数量。\n- 使用给定的每个条目的字节大小，将参数数量转换为内存需求。\n- 在您的推导中，使用标度论证简要说明为什么对于高 $f$ 值，张量列及相关格式（如 Tucker 和分层 Tucker (HT)）可以比密集张量节省大量存储空间。\n\n计算压缩因子 $\\rho$，其定义为密集内存与 TT 内存的比率，\n$$\n\\rho \\;=\\; \\frac{\\text{密集内存 (字节)}}{\\text{TT 内存 (字节)}},\n$$\n使用上面给出的特定 $f$、$\\{n_k\\}$ 和 $r$。将您最终的 $\\rho$ 数值结果四舍五入至四位有效数字。报告的 $\\rho$ 应为无单位的纯数。如果您选择进行任何中间单位换算，请假设 $1\\,\\text{GB} = 1.0\\times 10^{9}\\,\\text{bytes}$ 并在您的推理中明确说明任何此类换算，但最终报告的 $\\rho$ 值必须是无单位的，并按要求四舍五入。", "solution": "首先，我们推导 $A_{j_1 \\cdots j_f}$ 的密集张量表示的内存需求。该张量的阶为 $f=8$。第 $k$ 个维度的尺寸是 $n_k$。复系数的总数 $N_{\\text{dense}}$ 是所有模的维度的乘积：\n$$\nN_{\\text{dense}} = \\prod_{k=1}^{f} n_k = n_1 \\times n_2 \\times n_3 \\times n_4 \\times n_5 \\times n_6 \\times n_7 \\times n_8\n$$\n使用给定的值 $f=8$，$n_1=n_2=20$，$n_3=n_4=18$，$n_5=n_6=16$ 和 $n_7=n_8=14$：\n$$\nN_{\\text{dense}} = 20^2 \\times 18^2 \\times 16^2 \\times 14^2 = (20 \\times 18 \\times 16 \\times 14)^2 = (80640)^2 = 6,502,809,600\n$$\n每个系数是一个需要 $16$ 字节存储的复数。因此，密集张量的总内存 $M_{\\text{dense}}$ 是：\n$$\nM_{\\text{dense}} = N_{\\text{dense}} \\times 16\\,\\text{bytes} = 6,502,809,600 \\times 16 = 104,044,953,600\\,\\text{bytes}\n$$\n这大约是 $104\\,\\text{GB}$。\n\n接下来，我们推导张量列 (TT) 表示的内存需求。在这种格式中，张量 $A$ 由 $f$ 个三指标核的序列表示，每个核的大小为 $r_{k-1} \\times n_k \\times r_k$。要存储的参数总数 $N_{\\text{TT}}$ 是所有核大小的总和：\n$$\nN_{\\text{TT}} = \\sum_{k=1}^{f} n_k \\times r_{k-1} \\times r_k\n$$\n问题指定了边界秩 $r_0=r_f=1$ 和统一的内部秩 $r_k=r=30$ for $k=1,\\dots,f-1$。展开 $f=8$ 的求和：\n$$\nN_{\\text{TT}} = (n_1 r_0 r_1) + (n_2 r_1 r_2) + (n_3 r_2 r_3) + (n_4 r_3 r_4) + (n_5 r_4 r_5) + (n_6 r_5 r_6) + (n_7 r_6 r_7) + (n_8 r_7 r_8)\n$$\n代入给定的秩（$r_0=1$, $r_8=1$, 以及 $r_k=r=30$ for $k=1,\\dots,7$）：\n$$\nN_{\\text{TT}} = (n_1 \\cdot 1 \\cdot r) + (n_2 \\cdot r \\cdot r) + (n_3 \\cdot r \\cdot r) + (n_4 \\cdot r \\cdot r) + (n_5 \\cdot r \\cdot r) + (n_6 \\cdot r \\cdot r) + (n_7 \\cdot r \\cdot r) + (n_8 \\cdot r \\cdot 1)\n$$\n$$\nN_{\\text{TT}} = r(n_1+n_8) + r^2(n_2+n_3+n_4+n_5+n_6+n_7)\n$$\n代入模维度 $\\{n_k\\}$ 和秩 $r=30$ 的数值：\n$$\n\\sum_{k=2}^{7} n_k = 20 + 18 + 18 + 16 + 16 + 14 = 102\n$$\n$$\nN_{\\text{TT}} = 30(20+14) + 30^2(102) = 30(34) + 900(102) = 1020 + 91800 = 92820\n$$\nTT 表示的总内存 $M_{\\text{TT}}$ 是：\n$$\nM_{\\text{TT}} = N_{\\text{TT}} \\times 16\\,\\text{bytes} = 92820 \\times 16 = 1,485,120\\,\\text{bytes}\n$$\n这大约是 $1.49\\,\\text{MB}$。\n\n对于高 $f$ 值，张量网络格式能提供巨大的存储节省。一个阶为 $f$、平均模维度为 $n$ 的密集张量的存储成本按 $\\mathcal{O}(n^f)$ 标度。这是指数级增长，即“维度灾难”，这使得即使对于中等大小的 $f$，直接存储和操作在计算上也是难以处理的。相比之下，张量列 (TT) 的存储成本按 $\\mathcal{O}(f n r^2)$ 标度，其中 $r$ 是最大 TT 秩。这种标度在维度数 $f$ 上是线性的。对于许多物理相关的系统，关联是局域的，这导致所需的秩 $r$ 保持较小或随 $f$ 缓慢增长。从指数标度 $\\mathcal{O}(n^f)$ 到线性标度 $\\mathcal{O}(f n r^2)$ 的转变是巨大计算节省的来源。\n\n最后，我们计算压缩因子 $\\rho$：\n$$\n\\rho = \\frac{M_{\\text{dense}}}{M_{\\text{TT}}} = \\frac{N_{\\text{dense}} \\times 16}{N_{\\text{TT}} \\times 16} = \\frac{N_{\\text{dense}}}{N_{\\text{TT}}}\n$$\n$$\n\\rho = \\frac{6,502,809,600}{92,820} \\approx 70058.27407886\n$$\n将此结果四舍五入到四位有效数字得到 $70060$。用科学记数法表示为 $7.006 \\times 10^4$。", "answer": "$$\n\\boxed{7.006 \\times 10^4}\n$$", "id": "2817991"}, {"introduction": "MCTDH方法提供了一个强大的框架，它桥接了简单的平均场理论和完整的组态相互作用解之间的鸿沟。MCTDH拟设的灵活性由每个模式所使用的单粒子函数（SPF）的数量 $n_\\kappa$ 控制。本练习将探讨每个模式仅使用一个SPF的基础极限情况，揭示MCTDH波函数如何优雅地退化为简单的、无关联的Hartree积，从而阐明多组态在捕获模间关联中的关键作用。[@problem_id:2818034]", "problem": "考虑一个具有$f$个可分辨自由度（模）的系统，该系统由含时薛定谔方程 (TDSE) $i\\,\\partial_t \\lvert \\Psi(t)\\rangle = \\hat{H}\\lvert \\Psi(t)\\rangle$ 控制，并在多组态含时哈特里 (MCTDH) 方法中进行近似。在 MCTDH 中，波函数被展开为单粒子函数 (SPFs) 的含时哈特里积，其运动方程遵循 Dirac–Frenkel 变分原理 (DFVP) $\\langle \\delta \\Psi \\lvert i\\,\\partial_t - \\hat{H}\\rvert \\Psi\\rangle = 0$，并受到 SPF 的正交归一性约束。假设对于每个模 $\\kappa\\in\\{1,\\dots,f\\}$，您精确地选择 $n_\\kappa = 1$ 个 SPF，即每个模只有一个 SPF。\n\n仅使用 TDSE、DFVP 以及 MCTDH 拟设是由含时正交归一的 SPF 构建的组态，并带有含时系数张量的线性组合这一核心定义，从第一性原理出发，推理 $n_\\kappa=1$ 的选择如何约束波函数的结构及其运动方程。基于该推理，选择下文中在 $n_\\kappa=1$ 极限下所有必然成立的陈述，并分析其对关联的影响。\n\nA. 当所有模的 $n_\\kappa=1$ 时，组态张量简化为单个复标量，该标量可通过规范变换成为一个物理上无关的全局相位；SPF 的运动方程变为含时哈特里 (TDH) 平均场方程，总波函数是单个含时哈特里积。\n\nB. 即使 $n_\\kappa=1$，MCTDH 拟设仍通过含时的组态系数保留了模间关联，因此不同模之间的纠缠可以保持非零。\n\nC. 在 $n_\\kappa=1$ 的极限下，每个模的单粒子密度矩阵是一个 $1\\times 1$ 的单位矩阵，对应于一个秩为 1 的投影算符；因此，任意不同模的两分划分之间的冯·诺伊曼纠缠熵为 $0$，模之间的任何耦合仅通过 SPF 方程中的平均场势进入。\n\nD. 如果哈密顿量是严格可分离的，形如 $\\hat{H}=\\sum_{\\kappa=1}^f \\hat{h}^{(\\kappa)}$，且没有模间耦合，那么 $n_\\kappa=1$ 的极限将给出精确的动力学；对于不可分离的耦合，误差源于忽略了超出平均场的模间关联。\n\nE. 通过将几个物理坐标组合成一个单一的组合模，人们可以表示该组内的关联，但在此极限下，不同组之间的关联仍然被排除。\n\n选择所有正确选项。", "solution": "当每个模 $\\kappa$ 的单粒子函数 (SPF) 数量被设置为 $n_\\kappa=1$ 时，通用 MCTDH 拟设\n$$ \\lvert \\Psi(t) \\rangle = \\sum_{j_1=1}^{n_1} \\dots \\sum_{j_f=1}^{n_f} A_{j_1 \\dots j_f}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle $$\n中的所有求和都只包含一项 ($j_\\kappa=1$)。因此，系数张量 $A$ 简化为单个复标量 $A_{1\\dots1}(t)$，波函数变为\n$$ \\lvert \\Psi(t) \\rangle = A_{1\\dots1}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle $$\n由于总波函数和每个 SPF 都被归一化，我们必须有 $|A_{1\\dots1}(t)|^2=1$。这意味着 $A_{1\\dots1}(t)$ 是一个物理上无关的全局相位因子，可以通过规范选择设为1。波函数因此简化为单个哈特里积：\n$$ \\lvert \\Psi(t) \\rangle = \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle $$\n这正是含时哈特里 (TDH) 方法的拟设，它是一种平均场理论。这种乘积形式的波函数根据定义是无关联的，即它不包含模间纠缠。将此拟设代入 Dirac-Frenkel 变分原理，会得到每个 SPF $\\lvert \\varphi_1^{(\\kappa)}\\rangle$ 在其他模所产生的平均场中演化的运动方程，即 TDH 方程。\n\n基于此，我们评估各个选项：\n*   **A**: 此陈述完全正确。如上所述，系数张量变为单个全局相位，波函数是单个哈特里积，运动方程是 TDH 平均场方程。\n*   **B**: 此陈述不正确。波函数简化为单个哈特里积，这是一种无关联（无纠缠）的状态。多组态的灵活性已丧失，因此无法描述模间关联。\n*   **C**: 此陈述完全正确。对于模 $\\kappa$，约化密度算符为 $\\hat{\\rho}^{(\\kappa)} = \\lvert \\varphi_1^{(\\kappa)} \\rangle \\langle \\varphi_1^{(\\kappa)} \\rvert$，这是一个秩为1的投影算符。在 SPF 基底中，它表示为 $1\\times1$ 的单位矩阵。纯态的冯·诺伊曼熵为零。模之间的相互作用仅通过平均场哈密顿量体现。\n*   **D**: 此陈述完全正确。若哈密顿量可分离且初始态为乘积态，则精确解在所有时间都保持乘积形式，TDH ($n_\\kappa=1$) 可以精确描述。若哈密顿量不可分离，则会产生关联，而 TDH 拟设无法描述这种关联，从而产生误差。\n*   **E**: 此陈述完全正确。这描述了模组合技术。一个 SPF $\\varphi_1^{(\\kappa)}(q_a, q_b, \\dots, t)$ 可以描述其内部坐标 $\\{q_a, q_b, \\dots\\}$ 之间的任意关联。然而，如果总波函数是这些组合模的 SPF 的乘积，那么不同组合模（组）之间的关联仍然被忽略。\n\n因此，正确的陈述是 A、C、D 和 E。", "answer": "$$\\boxed{ACDE}$$", "id": "2818034"}, {"introduction": "在任何MCTDH模拟中，一个关键的实际问题是所选的单粒子函数数量是否足以精确表示真实的波函数。本练习引入了“自然布居数”的概念，即单粒子约化密度矩阵的本征值。你将探索这些布居数如何提供一种严谨的、后验的诊断工具，用以评估计算的收敛性并为截断SPF基组提供依据。[@problem_id:2818016]", "problem": "考虑一个 $f$ 模系统的纯态 $|\\Psi(t)\\rangle$，其希尔伯特空间为 $\\mathcal{H}=\\bigotimes_{\\kappa=1}^{f}\\mathcal{H}^{(\\kappa)}$，在多组态含时哈特里 (MCTDH) 框架内进行演化。在 MCTDH 中，对于每个模式 $\\kappa$，我们将 $|\\Psi(t)\\rangle$ 在一个由单粒子函数 (SPFs) $\\{|\\varphi_{i}^{(\\kappa)}(t)\\rangle\\}_{i=1}^{n_{\\kappa}}$ 构成的含时乘积基上展开，并带有含时的组态系数。运动方程由 Dirac–Frenkel 含时变分原理 (TDVP) 得到，并且 SPF 规范被限制在每个模式内部的幺正旋转。对于任意模式 $\\kappa$，我们通过偏迹 $\\hat{\\rho}^{(\\kappa)}(t)=\\operatorname{Tr}_{\\neq \\kappa}\\left(|\\Psi(t)\\rangle\\langle\\Psi(t)|\\right)$ 来定义作用在 $\\mathcal{H}^{(\\kappa)}$ 上的约化密度算符。$\\hat{\\rho}^{(\\kappa)}(t)$ 的本征值被称为模式 $\\kappa$ 的自然布居数。\n\n你需要从二分纯态的第一性原理和约化密度算符的性质出发进行推理，除了归一化和正定性外，不假设任何特殊结构。基于这些原理，评估以下关于自然布居数及其在 MCTDH 中用作 SPF 截断的后验误差指示器的陈述。选择所有正确的陈述。\n\nA. 自然布居数 $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$ 是 $|\\Psi(t)\\rangle$ 对于二分划分 $\\mathcal{H}^{(\\kappa)}\\otimes\\mathcal{H}^{(\\neq \\kappa)}$ 的施密特系数的平方。如果将模式 $\\kappa$ 的 SPF 空间截断到由具有 $m_{\\kappa}$ 个最大布居数的 $\\hat{\\rho}^{(\\kappa)}$ 的本征矢量所张成的 $m_{\\kappa}$ 维子空间，那么在所有可能的 $m_{\\kappa}$ 维 SPF 子空间中，这种选择会最小化截断误差的 2-范数，并且被丢弃分量的范数平方等于 $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$。因此，累积的被丢弃布居数为截断误差提供了一个后验上界。这种构造和界限在 SPF 的幺正旋转下是不变的。\n\nB. 自然布居数依赖于为模式 $\\kappa$ 的 SPF 选择的特定规范（含时幺正旋转），因此除非规范由外部约定固定，否则不能作为定义明确的后验指示器。\n\nC. 对于一个归一化的 $|\\Psi(t)\\rangle$，$\\hat{\\rho}^{(\\kappa)}(t)$ 的迹等于 $n_{\\kappa}$，即用于模式 $\\kappa$ 的 SPF 的数量。因此，增加 $n_{\\kappa}$ 能保证 $\\operatorname{Tr}\\hat{\\rho}^{(\\kappa)}(t)$ 趋近于 $n_{\\kappa}$，从而作为一种直接的收敛性度量。\n\nD. 如果丢弃所有单个自然布居数低于阈值 $\\varepsilon>0$ 的 SPF，那么被丢弃分量的 2-范数总是至多为 $\\varepsilon$，而与丢弃了多少个这样的 SPF 无关。", "solution": "根据施密特分解定理，对于任何二分划分 $\\mathcal{H} = \\mathcal{H}^{(\\kappa)} \\otimes \\mathcal{H}^{(\\neq \\kappa)}$，一个纯态 $|\\Psi(t)\\rangle$ 可以写为 $|\\Psi(t)\\rangle = \\sum_{\\alpha} \\sqrt{n_{\\alpha}^{(\\kappa)}} |\\chi_{\\alpha}^{(\\kappa)}\\rangle \\otimes |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle$，其中 $\\{|\\chi_{\\alpha}^{(\\kappa)}\\rangle\\}$ 和 $\\{|\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\}$ 是正交归一的施密特基矢。模式 $\\kappa$ 的约化密度算符 $\\hat{\\rho}^{(\\kappa)} = \\operatorname{Tr}_{\\neq \\kappa}(|\\Psi\\rangle\\langle\\Psi|)$ 的谱分解为 $\\hat{\\rho}^{(\\kappa)} = \\sum_{\\alpha} n_{\\alpha}^{(\\kappa)} |\\chi_{\\alpha}^{(\\kappa)}\\rangle\\langle\\chi_{\\alpha}^{(\\kappa)}|$。由此可知，自然布居数 $\\{n_{\\alpha}^{(\\kappa)}\\}$ 就是 $\\hat{\\rho}^{(\\kappa)}$ 的本征值，它们是施密特系数的平方，并且由于 $|\\Psi\\rangle$ 的归一化，满足 $\\sum_{\\alpha} n_{\\alpha}^{(\\kappa)} = 1$。因为 $\\hat{\\rho}^{(\\kappa)}$ 是通过对 $|\\Psi\\rangle$ 求偏迹内在地定义的，所以它的本征值（自然布居数）和本征矢量（自然轨道）不依赖于表示该子空间的任何特定基（如MCTDH中的工作SPF基），因此它们是规范不变的。\n\n根据 Eckart-Young-Mirsky 定理的推论，对 $|\\Psi(t)\\rangle$ 的最佳 $m_{\\kappa}$ 维近似是通过将其投影到由对应 $m_{\\kappa}$ 个最大自然布居数的自然轨道所张成的子空间上得到的。截断后被丢弃的分量的范数平方等于被忽略的自然布居数之和，即 $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$。这个和为截断引入的误差提供了一个严格的、后验的量度。\n\n现在评估各个选项：\n*   **A**: 该陈述准确地概括了上述所有要点。自然布居数是施密特系数的平方；截断到由具有最大布居数的本征矢量（自然轨道）张成的空间可以最小化 2-范数误差；误差的范数平方是被丢弃布居数的总和；并且这一切都是规范不变的。因此，该陈述是正确的。\n*   **B**: 该陈述是错误的。如上所述，自然布居数是规范不变的，这正是它们作为可靠收敛性指标的关键属性。\n*   **C**: 该陈述是错误的。对于任何归一化的态 $|\\Psi(t)\\rangle$，约化密度算符 $\\hat{\\rho}^{(\\kappa)}(t)$ 的迹恒等于 1，而不是 SPF 的数量 $n_{\\kappa}$。\n*   **D**: 该陈述是错误的。被丢弃分量的范数平方是所有低于阈值 $\\varepsilon$ 的布居数的*总和*。如果有很多个这样的小布居数，它们的总和可以远大于 $\\varepsilon$。例如，如果20个SPF的布居数均为0.04，并且阈值 $\\varepsilon=0.1$，则它们都会被丢弃，误差的范数平方为 $20 \\times 0.04 = 0.8$，而其范数 $\\sqrt{0.8} \\approx 0.89$ 远大于 $\\varepsilon=0.1$。\n\n因此，只有陈述 A 是正确的。", "answer": "$$\\boxed{A}$$", "id": "2818016"}]}