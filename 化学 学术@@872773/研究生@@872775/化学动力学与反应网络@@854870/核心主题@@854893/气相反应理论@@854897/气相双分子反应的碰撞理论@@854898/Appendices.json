{"hands_on_practices": [{"introduction": "本章的实践练习旨在将气相双分子反应的碰撞理论付诸实践。我们从最基本的模型——硬球模型——开始。这个练习将指导你从第一性原理出发，推导纯碰撞控制下的速率系数 $k_{\\text{coll}}(T)$，这为你理解所有气相反应速率的上限提供了一个重要的基准 ([@problem_id:2633142])。通过这个计算，你将掌握如何将分子的微观性质（如直径和质量）与宏观的反应动力学联系起来。", "problem": "一种二元气体混合物包含组分 $A$ 和 $B$，在稀薄气体极限下被模拟为无结构硬球。硬球碰撞定义为：当瞬时中心间距小于粒子半径之和时即发生碰撞。气体处于温度为 $T$ 的热平衡状态，因此分子速度遵循麦克斯韦-玻尔兹曼 (MB) 分布。\n\n仅从 (i) 根据粒子直径和碰撞参数所给出的硬球碰撞截面的几何定义，以及 (ii) 独立分子速度的麦克斯韦-玻尔兹曼统计和气体动理论中关于通量的基本定义出发，推导 $A + B$ 反应中由碰撞控制的二级双分子反应速率系数 $k_{\\text{coll}}(T)$，并用温度 $T$、硬球直径 $d_A$、$d_B$ 以及分子质量 $m_A$、$m_B$ 表示。然后对以下参数进行数值计算：\n- $d_A = 3.0\\ \\text{\\AA}$，$d_B = 3.5\\ \\text{\\AA}$，\n- $m_A = 28\\ \\text{u}$，$m_B = 32\\ \\text{u}$，\n- $T = 500\\ \\text{K}$。\n\n使用常数 $k_B = 1.380\\,649\\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}$，$m_u = 1.660\\,539\\,066\\,60\\times 10^{-27}\\ \\text{kg}$，以及换算关系 $1\\ \\text{\\AA} = 10^{-10}\\ \\text{m}$，$1\\ \\text{m}^3 = 10^{6}\\ \\text{cm}^3$。将浓度视为数密度，单位为 分子/$\\text{cm}^3$，因此 $k_{\\text{coll}}(T)$ 的单位为 $\\text{cm}^3\\,\\text{molecule}^{-1}\\,\\text{s}^{-1}$。将最终数值答案四舍五入至四位有效数字，并以 $\\text{cm}^3\\,\\text{molecule}^{-1}\\,\\text{s}^{-1}$ 为单位表示。", "solution": "问题陈述已经过验证，具有科学依据、提法明确且客观。这是一个气体动理论中的标准问题。我们将进行推导和后续的数值计算。\n\n组分 $A$ 和 $B$ 之间的双分子反应 $A + B \\rightarrow \\text{Products}$ 的速率由以下表达式给出：\n$$\n\\text{Rate} = k_{\\text{coll}}(T) [A] [B]\n$$\n其中 $[A]$ 和 $[B]$ 分别是组分 $A$ 和 $B$ 的数密度（单位体积内的分子数），$k_{\\text{coll}}(T)$ 是温度 $T$ 下的二级速率系数。该速率表示单位体积、单位时间内发生的 $A-B$ 碰撞次数。\n\n为了推导 $k_{\\text{coll}}(T)$，我们首先从微观角度考虑这个问题。让我们固定一个 $A$ 类粒子，并计算它与 $B$ 类粒子碰撞的频率。运动由碰撞双方的相对速度 $\\vec{v}_r = \\vec{v}_A - \\vec{v}_B$ 决定。对于硬球模型，如果一个 $B$ 粒子的中心进入到距离 $A$ 粒子中心 $R_{AB} = r_A + r_B$ 的范围内，则发生碰撞，其中 $r_A = d_A/2$ 和 $r_B = d_B/2$ 是半径。这个距离 $R_{AB} = (d_A + d_B)/2$ 定义了粒子 $A$ 相对于 $B$ 粒子场扫过的圆柱体的半径。\n\n碰撞截面 $\\sigma_{AB}$ 是这个圆柱体的底面积。任何中心位于此圆柱体内的 $B$ 粒子都将被撞击。因此，截面为：\n$$\n\\sigma_{AB} = \\pi R_{AB}^2 = \\pi \\left( \\frac{d_A + d_B}{2} \\right)^2\n$$\n在时间间隔 $dt$ 内，一个以相对速率 $v_r = |\\vec{v}_r|$ 运动的 $A$ 粒子扫过的体积为 $d\\text{Vol} = \\sigma_{AB} v_r dt$。这个体积内的 $B$ 粒子数量为 $[B] d\\text{Vol} = [B] \\sigma_{AB} v_r dt$。假设相对速率 $v_r$ 固定，这个单个 $A$ 粒子的碰撞频率为 $Z_A(v_r) = [B] \\sigma_{AB} v_r$。\n\n然而，处于热平衡状态的气体中的粒子并不具有单一速率；它们的速度由麦克斯韦-玻尔兹曼分布描述。因此，我们必须对相对速率的分布求碰撞频率的平均值。一个 $A$ 粒子的平均碰撞频率为：\n$$\nZ_A = [B] \\sigma_{AB} \\langle v_r \\rangle\n$$\n其中 $\\langle v_r \\rangle$ 是平均相对速率。\n\n单位体积内 $A-B$ 碰撞的总速率是通过将每个 $A$ 粒子的平均碰撞频率 $Z_A$ 乘以 $A$ 粒子的数密度 $[A]$ 得到的：\n$$\n\\text{Rate} = [A] Z_A = [A] [B] \\sigma_{AB} \\langle v_r \\rangle\n$$\n通过将其与宏观速率定律 $\\text{Rate} = k_{\\text{coll}}(T) [A] [B]$ 进行比较，我们确定速率系数为：\n$$\nk_{\\text{coll}}(T) = \\sigma_{AB} \\langle v_r \\rangle\n$$\n剩下的任务是求出平均相对速率 $\\langle v_r \\rangle$。速度矢量 $\\vec{v}_A$ 和 $\\vec{v}_B$ 是独立的，并且各自遵循三维麦克斯韦-玻尔兹曼分布。相对速度矢量 $\\vec{v}_r = \\vec{v}_A - \\vec{v}_B$ 的概率分布也是一个麦克斯韦分布，但其特征由双粒子体系的折合质量 $\\mu$ 决定：\n$$\n\\mu = \\frac{m_A m_B}{m_A + m_B}\n$$\n相对速度大小 $v_r$ 的概率分布由下式给出：\n$$\nP(v_r) dv_r = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v_r^2 \\exp\\left(-\\frac{\\mu v_r^2}{2 k_B T}\\right) dv_r\n$$\n平均相对速率 $\\langle v_r \\rangle$ 是该分布的一阶矩：\n$$\n\\langle v_r \\rangle = \\int_0^\\infty v_r P(v_r) dv_r = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty v_r^3 \\exp\\left(-\\frac{\\mu v_r^2}{2 k_B T}\\right) dv_r\n$$\n令 $\\alpha = \\frac{\\mu}{2 k_B T}$。该积分是标准形式 $\\int_0^\\infty x^3 \\exp(-ax^2) dx = \\frac{1}{2a^2}$。因此：\n$$\n\\int_0^\\infty v_r^3 \\exp(-\\alpha v_r^2) dv_r = \\frac{1}{2\\alpha^2} = \\frac{1}{2} \\left(\\frac{2 k_B T}{\\mu}\\right)^2 = \\frac{2 (k_B T)^2}{\\mu^2}\n$$\n将此结果代回 $\\langle v_r \\rangle$ 的表达式中：\n$$\n\\langle v_r \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\frac{2 (k_B T)^2}{\\mu^2} = 4\\pi \\frac{\\mu^{3/2}}{(2\\pi k_B T)^{3/2}} \\frac{2(k_B T)^2}{\\mu^2} = \\frac{8\\pi (k_B T)^2 \\mu^{3/2}}{2^{3/2} \\pi^{3/2} (k_B T)^{3/2} \\mu^2} = \\frac{4}{\\sqrt{2\\pi}} \\frac{\\sqrt{k_B T}}{\\sqrt{\\mu}} = \\sqrt{\\frac{16}{2\\pi}} \\sqrt{\\frac{k_B T}{\\mu}}\n$$\n$$\n\\langle v_r \\rangle = \\sqrt{\\frac{8 k_B T}{\\pi \\mu}}\n$$\n最后，将 $\\sigma_{AB}$ 和 $\\langle v_r \\rangle$ 的表达式代入 $k_{\\text{coll}}(T)$ 的方程中：\n$$\nk_{\\text{coll}}(T) = \\pi \\left( \\frac{d_A + d_B}{2} \\right)^2 \\sqrt{\\frac{8 k_B T}{\\pi \\mu}}\n$$\n\n现在，我们对该表达式进行数值计算。在转换为所要求的最终单位之前，所有计算均以国际单位制基本单位（$\\text{m}, \\text{kg}, \\text{s}, \\text{K}$）进行。\n\n给定参数为：\n$d_A = 3.0\\ \\text{\\AA} = 3.0 \\times 10^{-10}\\ \\text{m}$\n$d_B = 3.5\\ \\text{\\AA} = 3.5 \\times 10^{-10}\\ \\text{m}$\n$m_A = 28\\ \\text{u} = 28 \\times 1.660539 \\times 10^{-27}\\ \\text{kg} = 4.649509 \\times 10^{-26}\\ \\text{kg}$\n$m_B = 32\\ \\text{u} = 32 \\times 1.660539 \\times 10^{-27}\\ \\text{kg} = 5.313725 \\times 10^{-26}\\ \\text{kg}$\n$T = 500\\ \\text{K}$\n$k_B = 1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}$\n\n首先，计算折合质量 $\\mu$：\n$$\n\\mu = \\frac{m_A m_B}{m_A + m_B} = \\frac{(28\\ \\text{u})(32\\ \\text{u})}{28\\ \\text{u} + 32\\ \\text{u}} = \\frac{896}{60}\\ \\text{u} = \\frac{224}{15}\\ \\text{u}\n$$\n$$\n\\mu = \\frac{224}{15} \\times (1.66053906660 \\times 10^{-27}\\ \\text{kg}) \\approx 2.4800355 \\times 10^{-26}\\ \\text{kg}\n$$\n接下来，计算碰撞截面 $\\sigma_{AB}$：\n$$\n\\sigma_{AB} = \\pi \\left( \\frac{3.0 \\times 10^{-10}\\ \\text{m} + 3.5 \\times 10^{-10}\\ \\text{m}}{2} \\right)^2 = \\pi (3.25 \\times 10^{-10}\\ \\text{m})^2 \\approx 3.318307 \\times 10^{-19}\\ \\text{m}^2\n$$\n接下来，计算平均相对速率 $\\langle v_r \\rangle$：\n$$\n\\langle v_r \\rangle = \\sqrt{\\frac{8 (1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}) (500\\ \\text{K})}{\\pi (2.4800355 \\times 10^{-26}\\ \\text{kg})}} \\approx \\sqrt{\\frac{5.522596 \\times 10^{-20}}{7.791201 \\times 10^{-26}}}\\ \\text{m}\\,\\text{s}^{-1} \\approx 841.9204\\ \\text{m}\\,\\text{s}^{-1}\n$$\n现在，计算以国际单位制表示的速率系数 $k_{\\text{coll}}(T)$：\n$$\nk_{\\text{coll}}(T) = \\sigma_{AB} \\langle v_r \\rangle \\approx (3.318307 \\times 10^{-19}\\ \\text{m}^2) \\times (841.9204\\ \\text{m}\\,\\text{s}^{-1}) \\approx 2.79381 \\times 10^{-16}\\ \\text{m}^3\\,\\text{s}^{-1}\n$$\n问题要求答案以 $\\text{cm}^3\\,\\text{molecule}^{-1}\\,\\text{s}^{-1}$ 为单位。由于推导是基于数密度的，“每分子”这个单位是隐含的。我们使用 $1\\ \\text{m}^3 = 10^6\\ \\text{cm}^3$ 将立方米转换为立方厘米：\n$$\nk_{\\text{coll}}(T) \\approx (2.79381 \\times 10^{-16}) \\times 10^6 \\ \\text{cm}^3\\,\\text{s}^{-1} \\approx 2.79381 \\times 10^{-10}\\ \\text{cm}^3\\,\\text{s}^{-1}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nk_{\\text{coll}}(T) \\approx 2.794 \\times 10^{-10}\\ \\text{cm}^3\\,\\text{molecule}^{-1}\\,\\text{s}^{-1}\n$$", "answer": "$$\\boxed{2.794 \\times 10^{-10}}$$", "id": "2633142"}, {"introduction": "并非每一次分子碰撞都能引发化学反应。这个练习引入了一个关键概念：反应活化能。通过应用“中心线模型”([@problem_id:2633155])，我们假定只有当沿着碰撞方向的动能分量超过一个阈值 $E_0$ 时，反应才会发生。这个练习将让你亲手推导反应速率常数如何依赖于这个能量阈值，并揭示出与阿伦尼乌斯公式密切相关的指数因子 $\\exp(-E_0/k_B T)$ 的物理来源。", "problem": "物种 $A$ 和 $B$ 之间的气相双分子反应使用硬球碰撞的连心线模型进行建模。这两个物种的有效碰撞直径为 $d$，折合质量为 $\\mu$。反应要求相对平动能超过阈值 $E_{0}$。在硬球的连心线模型中，反应微分截面仅取决于相对平动能 $E$，其表达式为\n$$\n\\sigma_{r}(E) = \n\\begin{cases}\n0,  E  E_{0},\\\\\n\\pi d^{2}\\left(1 - \\dfrac{E_{0}}{E}\\right),  E \\ge E_{0}.\n\\end{cases}\n$$\n从气体动理论中双分子速率常数的定义出发，即 $\\sigma(g)\\,g$ 在相对速率 $g$ 的麦克斯韦-玻尔兹曼 (MB) 分布上的相对速率平均值，\n$$\nk(T) \\equiv \\int_{0}^{\\infty} \\sigma(g)\\, g\\, f_{g}(g;T)\\, \\mathrm{d}g,\n$$\n其中，相对运动的 MB 速率分布为\n$$\nf_{g}(g;T) = 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} g^{2}\\, \\exp\\!\\left(-\\dfrac{\\mu g^{2}}{2 k_{B} T}\\right).\n$$\n同样，硬球碰撞极限速率常数定义为\n$$\nk_{\\mathrm{coll}}(T) \\equiv \\int_{0}^{\\infty} \\pi d^{2}\\, g\\, f_{g}(g;T)\\, \\mathrm{d}g.\n$$\n给定 $d = 3.5\\ \\mathrm{\\AA}$，$\\mu = 14\\ \\mathrm{u}$ 和 $E_{0}/k_{B} = 2500\\ \\mathrm{K}$，根据连心线模型计算 $k(600\\ \\mathrm{K})$，并将其与 $k_{\\mathrm{coll}}(600\\ \\mathrm{K})$ 进行比较，以推断出有效空间因子\n$$\np \\equiv \\dfrac{k(600\\ \\mathrm{K})}{k_{\\mathrm{coll}}(600\\ \\mathrm{K})}.\n$$\n使用常数 $k_{B} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$，$1\\ \\mathrm{u} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$ 和 $1\\ \\mathrm{\\AA} = 1.0\\times 10^{-10}\\ \\mathrm{m}$。将 $k$ 和 $k_{\\mathrm{coll}}$ 以 $\\mathrm{m^{3}\\,s^{-1}}$ 为单位表示。仅报告空间因子 $p$，作为一个无量纲小数，并四舍五入到三位有效数字。", "solution": "该问题提法得当，科学上合理，并提供了获得唯一且有意义解所需的完整数据集和定义。我们将开始推导。\n\n待求量是有效空间因子 $p$，其定义为在温度 $T = 600\\ \\mathrm{K}$ 时，反应速率常数 $k(T)$ 与碰撞极限速率常数 $k_{\\mathrm{coll}}(T)$ 之比：\n$$\np \\equiv \\frac{k(600\\ \\mathrm{K})}{k_{\\mathrm{coll}}(600\\ \\mathrm{K})}\n$$\n为了求得此比值，我们首先推导 $k_{\\mathrm{coll}}(T)$ 和 $k(T)$ 的通用解析表达式。\n\n碰撞极限速率常数 $k_{\\mathrm{coll}}(T)$ 定义为：\n$$\nk_{\\mathrm{coll}}(T) \\equiv \\int_{0}^{\\infty} \\pi d^{2}\\, g\\, f_{g}(g;T)\\, \\mathrm{d}g\n$$\n由于硬球碰撞截面 $\\pi d^{2}$ 与相对速率 $g$ 无关，因此可以将其从积分中提出：\n$$\nk_{\\mathrm{coll}}(T) = \\pi d^2 \\int_{0}^{\\infty} g\\, f_{g}(g;T)\\, \\mathrm{d}g = \\pi d^2 \\langle g \\rangle\n$$\n此处，$\\langle g \\rangle$ 是平均相对速率。我们使用给定的相对速率的麦克斯韦-玻尔兹曼分布 $f_{g}(g;T)$ 来计算此积分：\n$$\n\\langle g \\rangle = \\int_{0}^{\\infty} g \\left( 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} g^{2}\\, \\exp\\!\\left(-\\dfrac{\\mu g^{2}}{2 k_{B} T}\\right) \\right) \\mathrm{d}g = 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} \\int_{0}^{\\infty} g^{3} \\exp\\!\\left(-\\dfrac{\\mu g^{2}}{2 k_{B} T}\\right) \\mathrm{d}g\n$$\n为了求解该积分，我们使用换元法，令 $x = g^2$，则 $\\mathrm{d}x = 2g\\,\\mathrm{d}g$。设指数中的常数为 $a = \\frac{\\mu}{2k_B T}$。该积分变为：\n$$\n\\int_{0}^{\\infty} g^3 e^{-ag^2} \\mathrm{d}g = \\frac{1}{2} \\int_{0}^{\\infty} x e^{-ax} \\mathrm{d}x\n$$\n这是一个标准积分形式，其值为 $\\frac{1}{a^2}$。因此：\n$$\n\\int_{0}^{\\infty} g^{3} \\exp\\!\\left(-\\dfrac{\\mu g^{2}}{2 k_{B} T}\\right) \\mathrm{d}g = \\frac{1}{2a^2} = \\frac{1}{2} \\left( \\frac{2k_B T}{\\mu} \\right)^2 = \\frac{2(k_B T)^2}{\\mu^2}\n$$\n将此结果代回 $\\langle g \\rangle$ 的表达式中：\n$$\n\\langle g \\rangle = 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} \\left( \\frac{2(k_B T)^2}{\\mu^2} \\right) = \\frac{8\\pi (k_B T)^2}{\\mu^2} \\frac{\\mu^{3/2}}{(2\\pi k_B T)^{3/2}} = \\frac{8\\pi}{\\mu^{1/2}} \\frac{(k_B T)^{1/2}}{(2\\pi)^{3/2}} = \\sqrt{\\frac{64\\pi^2}{2^3\\pi^3}} \\sqrt{\\frac{k_B T}{\\mu}} = \\sqrt{\\frac{8k_B T}{\\pi \\mu}}\n$$\n所以，碰撞极限速率常数为：\n$$\nk_{\\mathrm{coll}}(T) = \\pi d^2 \\sqrt{\\frac{8k_B T}{\\pi \\mu}}\n$$\n接下来，我们推导反应速率常数 $k(T)$。反应截面 $\\sigma_r$ 是以相对平动能 $E$ 表示的。我们通过代入 $E = \\frac{1}{2}\\mu g^2$ 将其表示为相对速率 $g$ 的函数：\n$$\n\\sigma_{r}(g) = \n\\begin{cases}\n0,  \\text{若 } \\frac{1}{2}\\mu g^2  E_{0} \\\\\n\\pi d^{2}\\left(1 - \\dfrac{E_{0}}{\\frac{1}{2}\\mu g^{2}}\\right),  \\text{若 } \\frac{1}{2}\\mu g^2 \\ge E_{0}\n\\end{cases}\n$$\n只有当速率 $g$ 超过由 $\\frac{1}{2}\\mu g_0^2 = E_0$ 定义的最小速率 $g_0$ 时，反应才会发生，因此 $g_0 = \\sqrt{2E_0/\\mu}$。对于 $g \\ge g_0$，截面为 $\\sigma_r(g) = \\pi d^2(1 - g_0^2/g^2)$。于是，速率常数 $k(T)$ 为：\n$$\nk(T) = \\int_{g_0}^{\\infty} \\sigma_r(g) g f_{g}(g;T) \\mathrm{d}g = \\int_{g_0}^{\\infty} \\pi d^2 \\left(1 - \\frac{g_0^2}{g^2}\\right) g f_{g}(g;T) \\mathrm{d}g\n$$\n代入 $f_g(g;T)$ 的表达式：\n$$\nk(T) = \\pi d^2 \\cdot 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} \\int_{g_0}^{\\infty} \\left(g - \\frac{g_0^2}{g}\\right) g^2 \\exp\\!\\left(-\\dfrac{\\mu g^{2}}{2 k_{B} T}\\right) \\mathrm{d}g\n$$\n让我们计算积分部分。像之前一样，令 $a = \\frac{\\mu}{2k_B T}$。\n$$\nI = \\int_{g_0}^{\\infty} (g^3 - g_0^2 g) \\exp(-ag^2) \\mathrm{d}g\n$$\n使用换元法 $x=g^2$，积分下限为 $x_0 = g_0^2$：\n$$\nI = \\frac{1}{2} \\int_{x_0}^{\\infty} (x - g_0^2) \\exp(-ax) \\mathrm{d}x\n$$\n我们进行分部积分。令 $u = x-g_0^2$ 且 $\\mathrm{d}v = e^{-ax}\\mathrm{d}x$。则 $\\mathrm{d}u = \\mathrm{d}x$ 且 $v = -e^{-ax}/a$。\n$$\n\\int (x - g_0^2) e^{-ax} \\mathrm{d}x = -\\frac{(x - g_0^2)e^{-ax}}{a} + \\int \\frac{e^{-ax}}{a}\\mathrm{d}x = -\\frac{(x - g_0^2)e^{-ax}}{a} - \\frac{e^{-ax}}{a^2}\n$$\n将此从 $x_0$ 到 $\\infty$ 求值：\n$$\n\\int_{x_0}^{\\infty} (x-g_0^2) e^{-ax} \\mathrm{d}x = \\left[ -\\frac{(x - g_0^2)e^{-ax}}{a} - \\frac{e^{-ax}}{a^2} \\right]_{x_0}^{\\infty} = (0-0) - \\left( -\\frac{(x_0 - g_0^2)e^{-ax_0}}{a} - \\frac{e^{-ax_0}}{a^2} \\right)\n$$\n由于 $x_0 = g_0^2$，项 $(x_0-g_0^2)$ 为零。积分为 $\\frac{e^{-ax_0}}{a^2}$。所以，$I = \\frac{1}{2a^2}e^{-ax_0}$。\n指数为 $ax_0 = \\frac{\\mu}{2k_B T} g_0^2 = \\frac{\\mu}{2k_B T} \\frac{2E_0}{\\mu} = \\frac{E_0}{k_B T}$。\n积分为 $I = \\frac{1}{2} \\left(\\frac{2k_B T}{\\mu}\\right)^2 \\exp\\left(-\\frac{E_0}{k_B T}\\right) = \\frac{2(k_B T)^2}{\\mu^2}\\exp\\left(-\\frac{E_0}{k_B T}\\right)$。\n将此代回 $k(T)$ 的表达式中：\n$$\nk(T) = \\pi d^2 \\cdot 4\\pi \\left(\\dfrac{\\mu}{2\\pi k_{B} T}\\right)^{3/2} \\left( \\frac{2(k_B T)^2}{\\mu^2} \\exp\\left(-\\frac{E_0}{k_B T}\\right) \\right)\n$$\n此表达式可简化为：\n$$\nk(T) = \\left( \\pi d^2 \\sqrt{\\frac{8k_B T}{\\pi \\mu}} \\right) \\exp\\left(-\\frac{E_0}{k_B T}\\right) = k_{\\mathrm{coll}}(T) \\exp\\left(-\\frac{E_0}{k_B T}\\right)\n$$\n有效空间因子 $p$ 是这两个速率常数的比值：\n$$\np = \\frac{k(T)}{k_{\\mathrm{coll}}(T)} = \\frac{k_{\\mathrm{coll}}(T) \\exp\\left(-\\frac{E_0}{k_B T}\\right)}{k_{\\mathrm{coll}}(T)} = \\exp\\left(-\\frac{E_0}{k_B T}\\right)\n$$\n给定值为 $E_0/k_B = 2500\\ \\mathrm{K}$ 和 $T=600\\ \\mathrm{K}$。我们现在可以计算 $p$ 的数值：\n$$\np = \\exp\\left(-\\frac{2500\\ \\mathrm{K}}{600\\ \\mathrm{K}}\\right) = \\exp\\left(-\\frac{25}{6}\\right)\n$$\n数值上，这个值为：\n$$\np \\approx \\exp(-4.1666...) \\approx 0.0155042...\n$$\n按要求四舍五入到三位有效数字。\n$$\np \\approx 0.0155\n$$", "answer": "$$\n\\boxed{0.0155}\n$$", "id": "2633155"}, {"introduction": "简单的硬球和中心线模型为了便于解析求解，牺牲了物理真实性。在更高级的实践中，我们需要考虑由更真实的分子间相互作用势决定的反应动力学。这个综合性练习 ([@problem_id:2633101]) 将指导你使用经典的莫尔斯势（Morse potential）来模拟相互作用，并推导如何通过数值方法确定反应截面 $\\sigma_R(E)$。你将探索离心势垒（centrifugal barrier）的概念，并设计一个计算方案来求解决定反应性的最大碰撞参数 $b_{\\max}(E)$，最终通过热力学平均得到速率常数 $k(T)$。", "problem": "考虑一个气相双分子碰撞，在相对坐标系中，其折合质量为 $\\,\\mu\\,$，通过一个中心势相互作用。在接近（势垒）区域，该势由截断的 Morse 形式建模：\n$$\nV(r)=D_e\\left[1-\\exp\\!\\left(-a(r-r_e)\\right)\\right]^2,\\quad r\\ge r_e,\n$$\n其中 $\\,D_e>0\\,$, $\\,a>0\\,$ 且 $\\,r_e>0\\,$。对于从无穷远处开始的散射，通过使用平移后的势，采用常规的能量零点（即在 $\\,r\\to\\infty\\,$ 时能量为零）：\n$$\nV_s(r)=V(r)-D_e=D_e\\left(e^{-2a(r-r_e)}-2e^{-a(r-r_e)}\\right),\\quad r\\ge r_e,\n$$\n使得 $\\,V_s(\\infty)=0\\,$ 且对于 $\\,r\\ge r_e\\,$ 有 $\\,V_s(r)\\le 0\\,$。假设适用经典力学、能量和角动量守恒，以及气体动理论，其中相对速度服从 Maxwell–Boltzmann 分布。仅使用以下基础事实：\n- 中心力运动的有效势为 $\\,U_{\\mathrm{eff}}(r)=V_s(r)+\\dfrac{L^2}{2\\mu r^2}\\,$，其中 $\\,L=\\mu v b\\,$ 是通过相对速度 $\\,v\\,$ 和碰撞参数 $\\,b\\,$ 表示的守恒角动量。\n- 对于给定相对动能 $\\,E=\\dfrac{1}{2}\\mu v^2\\,$ 和碰撞参数 $\\,b\\,$ 的入射轨迹，一个必要且充分的经典捕获准则（反应条件）是总能量高于外部离心势垒：$\\,E\\ge \\max_{r\\ge r_e}U_{\\mathrm{eff}}(r)\\,$。\n- 固定能量 $\\,E\\,$ 下的反应截面为 $\\,\\sigma_R(E)=\\pi b_{\\max}^2(E)\\,$，其中 $\\,b_{\\max}(E)\\,$ 是满足捕获准则的碰撞参数的上确界。\n- 热速率系数是在温度 $\\,T\\,$ 下对相对速度分布的 Maxwell–Boltzmann 平均值 $\\,k(T)=\\langle \\sigma_R(E)\\,v\\rangle\\,$，其中玻尔兹曼常数 $\\,k_B=1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n\n任务：\n1) 从给定的基础出发，推导一个可数值实现的条件，用于确定给定 $\\,E\\,$, $\\,\\mu\\,$ 和势参数下的 $\\,b_{\\max}(E)\\,$。您的推导必须消去 $\\,L\\,$, 转而使用 $\\,E\\,$ 和 $\\,b\\,$ 表示，并将固定 $\\,E\\,$ 下的捕获测试简化为关于 $\\,r\\ge r_e\\,$ 的一维最大化问题。不要使用任何预先引用的反应截面公式。\n2) 提出并实现一个稳健的数值方案来计算 $\\,\\sigma_R(E)\\,$，该方案应：\n   - 在有限区间 $\\,r\\in[r_e,r_{\\max}]\\,$ 上计算 $\\,\\max_{r\\ge r_e}U_{\\mathrm{eff}}(r)\\,$，其中 $\\,r_{\\max}\\,$ 的选择应使 $\\,V_s(r_{\\max})\\,$ 的量值可以忽略（精确说明您如何根据 $\\,a\\,$ 和 $\\,r_e\\,$ 选择 $\\,r_{\\max}\\,$）。\n   - 使用关于 $\\,b\\,$ 的求根区间法和二分法，通过捕获准则求解 $\\,b_{\\max}(E)\\,$。您的求根函数在根的邻域内必须是连续且关于 $\\,b\\,$ 严格递减的。\n   - 通过避免有效势的内部分歧区域来确保数值稳定性（您必须证明将 $\\,r\\,$ 限制在 $\\,r\\ge r_e\\,$ 是对外部离心势垒的一个数学上一致的近似）。\n3) 从 Maxwell–Boltzmann 平均值的定义出发，使用从 $\\,v\\,$ 到无量纲动能变量的变量代换，推导出一个适用于 Gauss–Laguerre 求积法的一维积分 $\\,k(T)\\,$，其形式为对 $\\,e^{-x}\\,$ 的积分。不要直接引用最终公式；相反，应展示权重和节点是如何从变换中自然产生的。\n4) 实现一个程序，对于下面提供的每个测试用例，计算：\n   - 在三个指定能量 $\\,E\\,$ 下的反应截面 $\\,\\sigma_R(E)\\,$，以 $\\mathrm{m}^2$ 为单位，以及\n   - 在两个指定温度 $\\,T\\,$ 下的热平均速率系数 $\\,k(T)\\,$，以 $\\mathrm{m}^3/\\mathrm{s}$ 为单位，\n   相对精度至少为 $\\,10^{-4}\\,$，仅使用给定的物理输入和您推导的数值方案。所有计算必须在国际单位制（SI）中执行。\n\n数值和单位要求：\n- 使用 $\\,\\mu\\,$（单位 kg）、$\\,D_e\\,$（单位 J）、$\\,a\\,$（单位 $\\mathrm{m}^{-1}$）、$\\,r_e\\,$（单位 m）、$\\,E\\,$（单位 J）、$\\,T\\,$（单位 K）；输出 $\\,\\sigma_R(E)\\,$（单位 $\\mathrm{m}^2$）和 $\\,k(T)\\,$（单位 $\\mathrm{m}^3/\\mathrm{s}$）。\n- 在 $[r_e,r_{\\max}]$ 上使用足够精细的均匀网格 $\\,r\\,$ 来解析外部势垒；证明您选择的 $\\,r_{\\max}=r_e+\\alpha/a\\,$（给出具体的 $\\,\\alpha\\,$）和网格大小能够在不失稳的情况下达到所要求的精度。\n- 对于热平均积分，对您推导的变换后积分使用阶数至少为 $\\,32\\,$ 的 Gauss–Laguerre 求积法。\n\n测试套件：\n在以下三个测试用例上实现并运行您的程序。对于每个案例，按此顺序计算五个输出：$\\,\\sigma_R(E_1)\\,$, $\\,\\sigma_R(E_2)\\,$, $\\,\\sigma_R(E_3)\\,$, $\\,k(T_1)\\,$, $\\,k(T_2)\\,$。\n\n- 案例 $\\,1\\,$：\n  - $\\,D_e=3.0\\times 10^{-20}\\,$, $\\,a=2.0\\times 10^{10}\\,$, $\\,r_e=3.0\\times 10^{-10}\\,$, $\\,\\mu=0.835\\times 10^{-27}\\,$。\n  - $\\,E_1=1.0\\times 10^{-22}\\,$, $\\,E_2=5.0\\times 10^{-21}\\,$, $\\,E_3=1.0\\times 10^{-19}\\,$。\n  - $\\,T_1=300\\,$, $\\,T_2=1000\\,$。\n\n- 案例 $\\,2\\,$：\n  - $\\,D_e=1.0\\times 10^{-20}\\,$, $\\,a=1.5\\times 10^{10}\\,$, $\\,r_e=3.5\\times 10^{-10}\\,$, $\\,\\mu=2.656\\times 10^{-26}\\,$。\n  - $\\,E_1=1.0\\times 10^{-22}\\,$, $\\,E_2=5.0\\times 10^{-21}\\,$, $\\,E_3=1.0\\times 10^{-19}\\,$。\n  - $\\,T_1=300\\,$, $\\,T_2=1500\\,$。\n\n- 案例 $\\,3\\,$：\n  - $\\,D_e=5.0\\times 10^{-21}\\,$, $\\,a=2.5\\times 10^{10}\\,$, $\\,r_e=2.5\\times 10^{-10}\\,$, $\\,\\mu=1.67\\times 10^{-27}\\,$。\n  - $\\,E_1=1.0\\times 10^{-22}\\,$, $\\,E_2=5.0\\times 10^{-21}\\,$, $\\,E_3=1.0\\times 10^{-19}\\,$。\n  - $\\,T_1=50\\,$, $\\,T_2=2000\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含 $\\,15\\,$ 个浮点数结果，使用科学记数法，保留恰好 $\\,6\\,$ 位有效数字，汇集成一个用方括号括起来的逗号分隔列表，顺序如下：\n$$\n[\\ \\sigma_R(E_1),\\ \\sigma_R(E_2),\\ \\sigma_R(E_3),\\ k(T_1),\\ k(T_2),\\ \\text{然后对案例 2 重复此五元组},\\ \\text{然后是案例 3}\\ ]。\n$$", "solution": "问题陈述经过验证，被认为是科学上合理、适定且客观的。它代表了经典碰撞理论和反应动力学中的一个标准问题。所有提供的定义、常数和条件都是自洽的，足以推导出一个唯一且有意义的解。未发现任何缺陷。我们开始求解。\n\n该问题需要一个包含四部分的解答：1) 推导最大碰撞参数的可数值实现的捕获条件，2) 设计用于计算反应截面的数值方案，3) 推导适用于求积法的热速率系数积分形式，以及 4) 实现这些方案以计算指定的物理量。\n\n### 第1部分：可数值实现的捕获条件的推导\n\n分析始于问题中给出的相对坐标系下中心力运动的有效势能 $U_{\\mathrm{eff}}(r)$：\n$$\nU_{\\mathrm{eff}}(r) = V_s(r) + \\frac{L^2}{2\\mu r^2}\n$$\n这里，$V_s(r)$ 是平移后的相互作用势，$L$ 是守恒的轨道角动量，$\\mu$ 是折合质量。角动量 $L$ 与初始相对动能 $E = \\frac{1}{2}\\mu v^2$ 和碰撞参数 $b$ 相关，关系式为 $L = \\mu v b$。我们可以用 $E$ 和 $b$ 来表示 $L^2$：\n$$\nL^2 = (\\mu v b)^2 = \\mu^2 v^2 b^2 = \\mu^2 \\left(\\frac{2E}{\\mu}\\right) b^2 = 2\\mu E b^2\n$$\n将此式代入 $U_{\\mathrm{eff}}(r)$ 的表达式中，消去 $L$ 和 $v$，转而使用初始能量 $E$ 和碰撞参数 $b$ 表示：\n$$\nU_{\\mathrm{eff}}(r, E, b) = V_s(r) + \\frac{2\\mu E b^2}{2\\mu r^2} = V_s(r) + E \\frac{b^2}{r^2}\n$$\n对于接近区域 $r \\ge r_e$，平移后的 Morse 势由下式给出：\n$$\nV_s(r)=D_e\\left(e^{-2a(r-r_e)}-2e^{-a(r-r_e)}\\right)\n$$\n当 $r > r_e$ 时，该势是吸引性的，在 $r=r_e$ 处有最小值 $-D_e$。项 $E \\frac{b^2}{r^2}$ 是一个排斥性的离心势。它们的和 $U_{\\mathrm{eff}}$ 在某个半径 $r^* > r_e$ 处表现出离心势垒。\n\n经典捕获准则指出，如果总能量 $E$ 大于或等于有效势垒的最大值，则发生反应：\n$$\nE \\ge \\max_{r \\ge r_e} U_{\\mathrm{eff}}(r, E, b)\n$$\n对于固定的能量 $E$，随着碰撞参数 $b$ 的增加，离心项 $E \\frac{b^2}{r^2}$ 增大，从而抬高势垒的高度。能够发生反应的最大碰撞参数，记为 $b_{\\max}(E)$，对应于能量恰好等于势垒高度的临界条件：\n$$\nE = \\max_{r \\ge r_e} U_{\\mathrm{eff}}(r, E, b_{\\max}(E))\n$$\n这个方程就是确定 $b_{\\max}(E)$ 的可数值实现的条件。为了求解给定 $E$ 下的 $b_{\\max}(E)$，必须找到满足此等式的 $b$ 值。这通常需要一种数值求根方法，其中对于 $b$ 的每个试验值，都必须执行 $U_{\\mathrm{eff}}$ 在 $r \\ge r_e$ 上的最大化。\n\n### 第2部分：反应截面 $\\sigma_R(E)$ 的数值方案\n\n反应截面为 $\\sigma_R(E) = \\pi b_{\\max}^2(E)$。其计算依赖于从第1部分推导的条件中找到 $b_{\\max}(E)$。\n\n**$U_{\\mathrm{eff}}(r)$ 的最大化**：\n$U_{\\mathrm{eff}}(r, E, b)$ 在 $r \\in [r_e, \\infty)$ 上的最大化是在一个有限但足够大的区间 $[r_e, r_{\\max}]$ 上进行的。势 $V_s(r)$ 随着 $r \\to \\infty$ 指数衰减到 $0$。我们选择 $r_{\\max}$ 使得 $|V_s(r_{\\max})|$ 相对于其他能量尺度可以忽略不计。我们设定条件 $|V_s(r_{\\max})| \\approx | -2 D_e e^{-a(r_{\\max}-r_e)} |  \\epsilon D_e$，其中 $\\epsilon$ 是一个很小的容差。这意味着 $a(r_{\\max}-r_e) > \\ln(2/\\epsilon)$。我们选择 $\\alpha = \\ln(2/\\epsilon) = 30$，对应于 $\\epsilon \\approx 2 \\times 10^{-13}$。因此，我们定义 $r_{\\max} = r_e + 30/a$。在区间 $[r_e, r_{\\max}]$ 上，使用一个包含 $N_r=20000$ 个点的精细均匀网格，通过直接计算来定位 $U_{\\mathrm{eff}}$ 的最大值。对于平滑的势垒轮廓，这种基于网格的搜索是稳健且足够精确的。\n\n问题指定使用定义域 $r \\ge r_e$。这在物理上和数学上都是合理的。势的形式是为该区域定义的，模拟了接近阶段。对于任何 $b>0$，作为 $U_{\\mathrm{eff}}(r)$ 最大值的离心势垒出现在半径 $r^* > r_e$ 处。因此，将最大值的搜索范围限制在 $r \\ge r_e$ 可以正确地识别出决定经典捕获的相关的外部势垒。\n\n**$b_{\\max}(E)$ 的求根**：\n我们使用二分法求解 $b_{\\max}(E)$。定义一个连续的求根函数 $f(b)$：\n$$\nf(b) = \\left( \\max_{r \\ge r_e} \\left[ V_s(r) + E \\frac{b^2}{r^2} \\right] \\right) - E\n$$\n$b_{\\max}(E)$ 的值是 $f(b) = 0$ 的根。对于 $b \\ge 0$，项 $\\max_r[\\dots]$ 是 $b$ 的单调递增函数。因此，$f(b)$ 是严格递增的。\n为了使用二分法，我们可以定义一个递减函数 $g(b) = -f(b) = E - \\max_{r \\ge r_e} U_{\\mathrm{eff}}(r, E, b)$。\n必须建立一个区间 $[b_{\\text{low}}, b_{\\text{high}}]$。\n- 对于 $b=0$，$U_{\\mathrm{eff}}=V_s(r)$，且 $\\max_{r \\ge r_e} V_s(r) = V_s(\\infty) = 0$。因此，$g(0) = E > 0$。我们设置 $b_{\\text{low}}=0$。\n- 我们需要一个 $b_{\\text{high}}$ 使得 $g(b_{\\text{high}})  0$。选择一个足够大的值，例如 $b_{\\text{high}} = 10 r_e$ 作为初始猜测，并在必要时扩大它，以保证根位于该区间内。\n二分算法迭代 $100$ 次，这为最终结果提供了远超所需精度的准确性。\n\n### 第3部分：热速率系数 $k(T)$ 积分的推导\n\n热速率系数 $k(T)$ 是相对速度 $v$ 和反应截面 $\\sigma_R(E)$ 乘积的热平均值：\n$$\nk(T) = \\langle \\sigma_R(E) v \\rangle = \\int_0^\\infty \\sigma_R(E(v)) v f(v) dv\n$$\n其中 $f(v)$ 是相对速度的 Maxwell-Boltzmann 分布：\n$$\nf(v) dv = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) dv\n$$\n我们将积分变量从速度 $v$ 更改为动能 $E = \\frac{1}{2}\\mu v^2$。这意味着 $v = \\sqrt{2E/\\mu}$，并且 $dv = \\frac{1}{\\sqrt{2\\mu E}}dE$。将这些代入，我们得到 $v f(v)dv$ 变为：\n$$\n\\sqrt{\\frac{2E}{\\mu}} \\cdot 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\frac{2E}{\\mu} \\exp\\left(-\\frac{E}{k_B T}\\right) \\frac{1}{\\sqrt{2\\mu E}}dE = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2} E \\exp\\left(-\\frac{E}{k_B T}\\right) dE\n$$\n所以，速率系数由下式给出：\n$$\nk(T) = \\int_0^\\infty \\sigma_R(E) \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2} E \\exp\\left(-\\frac{E}{k_B T}\\right) dE\n$$\n为了使其适用于 Gauss-Laguerre 求积法（该方法近似于 $\\int_0^\\infty h(x)e^{-x}dx$ 形式的积分），我们引入无量纲能量变量 $x = E/(k_B T)$。那么 $E = xk_B T$ 且 $dE = k_B T dx$。\n$$\nk(T) = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma_R(x k_B T) (x k_B T) e^{-x} (k_B T dx)\n$$\n简化常数项得到最终表达式：\n$$\nk(T) = \\sqrt{\\frac{8 k_B T}{\\pi \\mu}} \\int_0^\\infty x\\, \\sigma_R(x k_B T) e^{-x} dx\n$$\n前置因子 $\\sqrt{8 k_B T / (\\pi \\mu)}$ 是平均相对速度 $\\langle v \\rangle$。该积分使用阶数为 $N_q=64$ 的 Gauss-Laguerre 求积法进行近似：\n$$\n\\int_0^\\infty x\\, \\sigma_R(x k_B T) e^{-x} dx \\approx \\sum_{i=1}^{N_q} w_i x_i \\sigma_R(x_i k_B T)\n$$\n其中 $x_i$ 和 $w_i$ 是求积法的横坐标和权重。\n\n### 第4部分：计算实现总结\n\n所推导的方法在一个 Python 程序中实现。\n1.  一个 `ReactionSystem` 类封装了给定测试用例的物理参数（$\\mu, D_e, a, r_e$）和计算方法。\n2.  `calculate_sigma` 方法实现了上述用于寻找 $b_{\\max}(E)$ 的二分法搜索，每次试验 $b$ 时都会调用一个内部工具函数在精细网格上找到 $\\max U_{\\mathrm{eff}}$。\n3.  `calculate_k` 方法使用 `numpy.polynomial.laguerre.laggauss` 来获取阶数为 $64$ 的求积节点和权重。然后它计算加权和，其中被积函数的每次求值都涉及在相应的能量 $E_i = x_i k_B T$ 处调用 `calculate_sigma`。\n4.  一个主脚本遍历提供的测试用例，为每个用例实例化 `ReactionSystem`，计算所需的五个量（三个能量下的 $\\sigma_R$，两个温度下的 $k(T)$），并将收集到的结果格式化为指定的单行输出。所有计算均遵循国际单位制。", "answer": "```python\n# Note: The following Python code was provided in the answer tag.\n# It has been corrected for basic syntax errors (e.g., '=' to '==', '' operators).\n# However, the code is incomplete and cannot be executed to generate the numerical answer.\n# This is a known issue with the original source document.\n\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the calculation of cross sections and rate coefficients\n    and formats the final output.\n    \"\"\"\n    # Boltzmann constant in J/K, as specified in the problem\n    KB = 1.380649e-23\n\n    test_cases = [\n        # Case 1\n        {\n            \"params\": {\"De\": 3.0e-20, \"a\": 2.0e10, \"re\": 3.0e-10, \"mu\": 0.835e-27},\n            \"energies\": [1.0e-22, 5.0e-21, 1.0e-19],\n            \"temps\": [300.0, 1000.0]\n        },\n        # Case 2\n        {\n            \"params\": {\"De\": 1.0e-20, \"a\": 1.5e10, \"re\": 3.5e-10, \"mu\": 2.656e-26},\n            \"energies\": [1.0e-22, 5.0e-21, 1.0e-19],\n            \"temps\": [300.0, 1500.0]\n        },\n        # Case 3\n        {\n            \"params\": {\"De\": 5.0e-21, \"a\": 2.5e10, \"re\": 2.5e-10, \"mu\": 1.67e-27},\n            \"energies\": [1.0e-22, 5.0e-21, 1.0e-19],\n            \"temps\": [50.0, 2000.0]\n        }\n    ]\n\n    class ReactionSystem:\n        \"\"\"\n        A class to encapsulate the physical parameters and calculation methods\n        for a bimolecular reaction system.\n        \"\"\"\n        def __init__(self, De, a, re, mu):\n            self.De = De\n            self.a = a\n            self.re = re\n            self.mu = mu\n\n            # Setup for numerical maximization of U_eff\n            self.alpha = 30.0  # For r_max = re + alpha/a\n            self.r_max = self.re + self.alpha / self.a\n            self.r_grid_size = 20000\n            self.r_grid = np.linspace(self.re, self.r_max, self.r_grid_size)\n\n            # Pre-calculate potential on the grid\n            self.Vs_grid = self.De * (np.exp(-2.0 * self.a * (self.r_grid - self.re)) - 2.0 * np.exp(-self.a * (self.r_grid - self.re)))\n            \n            # Setup for quadrature\n            self.quad_order = 64\n            self.quad_x, self.quad_w = np.polynomial.laguerre.laggauss(self.quad_order)\n\n        def _get_Ueff_max(self, b, E):\n            \"\"\"Calculates the maximum of the effective potential for a given b and E.\"\"\"\n            if E == 0: return 0.0 # Physical energies are positive\n            Ueff_grid = self.Vs_grid + E * (b**2 / self.r_grid**2)\n            return np.max(Ueff_grid)\n\n        def calculate_sigma(self, E):\n            \"\"\"\n            Calculates the reactive cross section sigma_R(E) at a given energy E.\n            Uses a bisection method to find b_max.\n            \"\"\"\n            if E == 0: return 0.0\n\n            # Bracket for bisection\n            b_low = 0.0\n            # Expanding search for a safe upper bound\n            b_high = 2.0 * self.re\n            while (self._get_Ueff_max(b_high, E) - E  0):\n                b_high *= 2.0\n\n            # Bisection to find b_max\n            for _ in range(100): # 100 iterations for high precision\n                b_mid = (b_low + b_high) / 2.0\n                if b_mid == b_low or b_mid == b_high: break\n                \n                f_mid = self._get_Ueff_max(b_mid, E) - E\n                if f_mid  0:\n                    b_low = b_mid\n                else:\n                    b_high = b_mid\n            \n            b_max = (b_low + b_high) / 2.0\n            return np.pi * b_max**2\n\n        def calculate_k(self, T):\n            \"\"\"\n            Calculates the thermal rate coefficient k(T) at a given temperature T.\n            Uses Gauss-Laguerre quadrature.\n            \"\"\"\n            if T == 0: return 0.0\n            \n            # The integrand is g(x) = x * sigma_R(x * kB * T)\n            # We evaluate g(x_i) for each quadrature node x_i\n            energies = self.quad_x * KB * T\n            \n            # The sigma calculation is not easily vectorized due to the bisection search.\n            # We loop over the quadrature points.\n            integrand_values = np.zeros(self.quad_order)\n            for i, energy in enumerate(energies):\n                sigma = self.calculate_sigma(energy)\n                integrand_values[i] = self.quad_x[i] * sigma\n\n            integral = np.dot(self.quad_w, integrand_values)\n            \n            # Prefactor is the mean relative speed\n            # Note: The provided code is incomplete. The final calculation step is missing.\n            mean_speed = np.sqrt(8 * KB * T / (np.pi * self.mu))\n            return mean_speed * integral\n    # The remainder of the script to execute the calculations and format the output is missing.\n\n```", "id": "2633101"}]}