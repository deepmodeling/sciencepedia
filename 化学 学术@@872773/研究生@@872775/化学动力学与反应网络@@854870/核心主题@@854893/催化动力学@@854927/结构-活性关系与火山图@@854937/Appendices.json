{"hands_on_practices": [{"introduction": "构建任何构效关系模型的第一步是建立催化剂属性（即描述符）与其动力学性能（即速率常数）之间的数学联系。这个基础练习 [@problem_id:2680781] 将指导你通过组合阿伦尼乌斯方程、布朗斯特德-埃文斯-波兰尼（BEP）关系以及一个描述符与反应能的线性关系，来推导速率常数 $k$ 作为描述符的显式函数。完成此推导有助于深刻理解火山图的数学根源，并为更复杂的模型打下坚实基础。", "problem": "对一系列催化剂进行筛选，用于某个单一基元表面反应，该反应的动力学可以用一个 Arrhenius 速率常数很好地描述。在这一系列催化剂中，一个由 $\\xi$ 表示的单一标量描述符，会使终态的吉布斯自由能相对于一个参考催化剂发生线性偏移。假设以下基本关系成立：\n\n- 基元步骤速率常数的 Arrhenius 形式：$k = \\nu \\exp\\!\\left(-\\dfrac{E_{a}}{R T}\\right)$，其中 $\\nu$ 是指前因子，$E_{a}$ 是活化自由能，$R$ 是普适气体常数，$T$ 是绝对温度。\n- 用于能垒的 Brønsted–Evans–Polanyi (BEP) 关系：$E_{a} = \\alpha\\,\\Delta E + \\beta$，其中 $\\alpha$ 和 $\\beta$ 是与催化剂无关的常数，$\\Delta E$ 是沿着反应坐标的终态和初态之间的自由能差。\n- 反应自由能差：$\\Delta E = \\Delta G_{\\text{final}} - \\Delta G_{\\text{initial}}$。\n\n描述符 $\\xi$ 根据以下公式线性地改变终态自由能：\n$$\n\\Delta G_{\\text{final}}(\\xi) = \\Delta G_{\\text{final}}^{0} + s\\,\\xi,\n$$\n其中 $\\Delta G_{\\text{final}}^{0}$ 是 $\\xi=0$ 时的终态自由能，$s$ 是一个恒定的偏移灵敏度（单位为能量每单位 $\\xi$）。初态自由能 $\\Delta G_{\\text{initial}}$ 与 $\\xi$ 无关。\n\n仅从上述关系出发，推导速率常数 $k(\\xi)$ 作为 $\\xi$ 的显式函数的闭式表达式。将您的最终答案表示为由符号 $\\nu$、$\\alpha$、$\\beta$、$R$、$T$、$s$、$\\Delta G_{\\text{final}}^{0}$、$\\Delta G_{\\text{initial}}$ 和 $\\xi$ 构成的单个解析表达式。假设能量单位为焦耳每摩尔，$T$ 的单位为开尔文，$R$ 的单位为 $\\text{J mol}^{-1}\\,\\text{K}^{-1}$，$\\nu$ 的单位为 $\\text{s}^{-1}$，因此 $k(\\xi)$ 的单位为 $\\text{s}^{-1}$。请勿在最终表达式中包含单位。", "solution": "问题陈述依据科学和数学的严谨性原则进行验证。\n\n首先，逐字提取已知条件：\n1.  速率常数 $k$ 的 Arrhenius 方程：$k = \\nu \\exp\\left(-\\dfrac{E_{a}}{R T}\\right)$。\n2.  活化自由能 $E_{a}$ 的 Brønsted–Evans–Polanyi (BEP) 关系：$E_{a} = \\alpha\\,\\Delta E + \\beta$。\n3.  反应自由能 $\\Delta E$ 的定义：$\\Delta E = \\Delta G_{\\text{final}} - \\Delta G_{\\text{initial}}$。\n4.  终态自由能 $\\Delta G_{\\text{final}}$ 对描述符 $\\xi$ 的线性依赖关系：$\\Delta G_{\\text{final}}(\\xi) = \\Delta G_{\\text{final}}^{0} + s\\,\\xi$。\n5.  初态自由能 $\\Delta G_{\\text{initial}}$ 被说明与 $\\xi$ 无关。\n\n该问题被确定为有效。它在科学上基于化学动力学和催化学的既定原理，特别是利用了诸如 Arrhenius 定律和像 BEP 关系这样的线性自由能关系等标准模型。该问题是适定的，提供了所有必要信息，且无内部矛盾。语言客观而精确。该任务是一个直接的推导，是物理化学中的一个标准练习，其解是唯一的且可验证的。因此，可以进行求解过程。\n\n目标是推导速率常数 $k$ 作为描述符 $\\xi$ 的显式函数（记为 $k(\\xi)$）的表达式。推导过程是对给定关系进行系统性的代入。\n\n我们从 Arrhenius 方程开始，其中速率常数 $k$ 依赖于活化能 $E_{a}$：\n$$\nk(\\xi) = \\nu \\exp\\left(-\\frac{E_{a}(\\xi)}{R T}\\right)\n$$\n为了找到 $k(\\xi)$，我们必须首先将 $E_{a}$ 表示为 $\\xi$ 的函数。\n\nBEP 关系将 $E_{a}$ 与反应自由能 $\\Delta E$ 联系起来：\n$$\nE_{a}(\\xi) = \\alpha\\,\\Delta E(\\xi) + \\beta\n$$\n此处，$\\alpha$ 和 $\\beta$ 是与催化剂无关的常数，因此也与 $\\xi$ 无关。我们现在必须找到 $\\Delta E$ 对 $\\xi$ 的依赖关系。\n\n反应自由能 $\\Delta E$ 是终态和初态自由能之差：\n$$\n\\Delta E(\\xi) = \\Delta G_{\\text{final}}(\\xi) - \\Delta G_{\\text{initial}}\n$$\n问题指明 $\\Delta G_{\\text{initial}}$ 是常数，而 $\\Delta G_{\\text{final}}$ 是 $\\xi$ 的线性函数：\n$$\n\\Delta G_{\\text{final}}(\\xi) = \\Delta G_{\\text{final}}^{0} + s\\,\\xi\n$$\n将此代入 $\\Delta E(\\xi)$ 的表达式中，得到：\n$$\n\\Delta E(\\xi) = (\\Delta G_{\\text{final}}^{0} + s\\,\\xi) - \\Delta G_{\\text{initial}}\n$$\n重新整理各项可以阐明 $\\Delta E$ 对 $\\xi$ 的线性依赖关系：\n$$\n\\Delta E(\\xi) = s\\,\\xi + (\\Delta G_{\\text{final}}^{0} - \\Delta G_{\\text{initial}})\n$$\n\n现在，我们将 $\\Delta E(\\xi)$ 的这个表达式代回 BEP 关系中，以求得 $E_{a}(\\xi)$：\n$$\nE_{a}(\\xi) = \\alpha \\left( s\\,\\xi + \\Delta G_{\\text{final}}^{0} - \\Delta G_{\\text{initial}} \\right) + \\beta\n$$\n这个方程给出了作为描述符 $\\xi$ 的显式线性函数的活化能。\n\n最后，我们将 $E_{a}(\\xi)$ 的表达式代入 Arrhenius 方程，以获得所求的速率常数 $k(\\xi)$：\n$$\nk(\\xi) = \\nu \\exp\\left(-\\frac{\\alpha \\left( s\\,\\xi + \\Delta G_{\\text{final}}^{0} - \\Delta G_{\\text{initial}} \\right) + \\beta}{R T}\\right)\n$$\n这就是速率常数作为描述符 $\\xi$ 的函数的闭式表达式。按要求，该表达式只包含指定的符号 $\\nu$、$\\alpha$、$\\beta$、$R$、$T$、$s$、$\\Delta G_{\\text{final}}^{0}$、$\\Delta G_{\\text{initial}}$ 和 $\\xi$。", "answer": "$$\n\\boxed{\\nu \\exp\\left(-\\frac{\\alpha \\left(s \\xi + \\Delta G_{\\text{final}}^{0} - \\Delta G_{\\text{initial}}\\right) + \\beta}{R T}\\right)}\n$$", "id": "2680781"}, {"introduction": "虽然微观动力学模型预测的是单位活性位点的周转频率（TOF），但实验结果通常以比活性（单位面积的活性）或质量活性（单位质量的活性）来报告。这个练习 [@problem_id:2680804] 探讨了一个至关重要但常被忽视的概念：不同的活性度量标准会如何改变火山图的峰顶位置和形状。理解这一点对于正确解释和比较不同文献中的催化剂性能至关重要，因为它揭示了表观活性和内在活性之间的差异。", "problem": "考虑一个单中间体反应的一系列催化剂，该反应通过以下基元步骤进行：反应物从流体相吸附形成吸附中间体，随后发生单一的表面基元反应生成产物并再生反应位点，之后产物脱附。假设以下标准化的、广泛使用的基本要素：\n- 基元步骤遵循阿伦尼乌斯动力学，其温度为 $T$，玻尔兹曼常数为 $k_{\\mathrm{B}}$。\n- 存在一个 Brønsted–Evans–Polanyi (BEP) 关系，将表面反应的活化能与结合能描述符联系起来。\n- 吸附为准平衡过程，在活性主导区域，中间体的覆盖度高且变化缓慢（因此反应速率主要取决于表面反应和脱附的基元速率常数）。\n- 对于在固定过电势下的电催化，电势的依赖性被吸收到表面反应速率常数的有效指前因子中。\n\n令单一描述符为关键中间体标准吸附自由能的大小， $B \\equiv -\\Delta G_{\\mathrm{ads}}$，单位为电子伏特（eV）（因此更大的 $B$ 意味着更强的结合）。假设以下参数形式：\n- 每个位点的表面反应有效速率常数：$k_{\\mathrm{rxn}}(B) = k_{0}\\,\\exp\\!\\left(\\dfrac{\\gamma\\,B}{k_{\\mathrm{B}} T}\\right)$，其中 $0  \\gamma  1$ 是 BEP 斜率，$k_{0}$ 是一个单位为 $\\mathrm{s}^{-1}$ 的常数。\n- 每个位点的产物脱附速率常数（等于中间体吸附逆反应的速率常数）：$k_{\\mathrm{des}}(B) = \\nu_{\\mathrm{des}}\\,\\exp\\!\\left(-\\dfrac{B}{k_{\\mathrm{B}} T}\\right)$，其中尝试频率 $\\nu_{\\mathrm{des}}$ 的单位为 $\\mathrm{s}^{-1}$。\n\n在这些假设下，本征单位点转换频率可以很好地通过两个串联阻力的调和平均组合来近似，\n$$r_{\\mathrm{site}}(B) = \\frac{k_{\\mathrm{rxn}}(B)\\,k_{\\mathrm{des}}(B)}{k_{\\mathrm{rxn}}(B) + k_{\\mathrm{des}}(B)}\\quad\\text{in }\\mathrm{s}^{-1}.$$\n\n现在考虑针对同一描述符 $B$ 构建的火山图中三种常用的 $y$ 轴：\n1. 单位点转换频率，$r_{\\mathrm{site}}(B)$，单位为 $\\mathrm{s}^{-1}$。\n2. 电催化的单位几何面积比活性，$j_{\\mathrm{spec}}(B)$，单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$，定义为 $j_{\\mathrm{spec}}(B) = n F\\,\\sigma_{\\mathrm{site}}(B)\\,r_{\\mathrm{site}}(B)$，其中 $n$ 是电子数，$F$ 是法拉第常数，$\\sigma_{\\mathrm{site}}(B)$ 是单位几何面积上动力学有效位点的密度。\n3. 质量活性，$J_{\\mathrm{mass}}(B)$，单位为 $\\mathrm{A}\\,\\mathrm{g}^{-1}$，定义为 $J_{\\mathrm{mass}}(B) = j_{\\mathrm{spec}}(B)\\,A_{\\mathrm{m}}(B)$，其中 $A_{\\mathrm{m}}(B)$ 是单位催化剂质量的电化学活性表面积。\n\n经验上，对于一个具有合成可比性的催化剂库，假设其构效关系可以用平滑的单调趋势来描述\n$$\\sigma_{\\mathrm{site}}(B) = \\sigma_{0}\\,\\exp\\!\\left(\\frac{\\eta\\,B}{k_{\\mathrm{B}} T}\\right),\\qquad A_{\\mathrm{m}}(B) = A_{0}\\,\\exp\\!\\left(\\frac{\\xi\\,B}{k_{\\mathrm{B}} T}\\right),$$\n其中 $\\eta$ 和 $\\xi$ 是小的、正的、无量纲的指数，分别反映了随着结合增强（例如，由于 $B$ 增大时更粗糙的表面和更小的晶粒变得更稳定），单位几何面积的活性位点密度增加以及单位质量的表面积增加。取 $T = 298\\,\\mathrm{K}$，$k_{\\mathrm{B}} T \\approx 0.02585\\,\\mathrm{eV}$，$\\gamma = 0.5$，$\\eta = 0.05$ 及 $\\xi = 0.10$。你可以将 $k_{0}$、$\\nu_{\\mathrm{des}}$、$n$、$F$、$\\sigma_{0}$ 和 $A_{0}$ 视为不影响最大值相对位置的正常数。\n\n将每个火山图的顶点位置 $B^*$ 定义为 $y$ 轴量达到其最大值时的 $B$ 值。将表观宽度定义为半峰全宽 (FWHM)，记为 $W$，通过 $y$ 轴量的对数在其顶点附近的二次展开来近似。\n\n在给定参数下，对于相同的底层微观动力学模型，以下哪个陈述正确描述了 $y$ 轴的选择如何改变表观顶点位置和宽度？\n\nA. 顶点结合能遵循 $B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$，且宽度满足 $W_{\\mathrm{TOF}} > W_{\\mathrm{spec}} > W_{\\mathrm{mass}}$。\n\nB. 所有三个火山图都在相同的结合能处达到峰值，并且具有相同的宽度，因为底层的微观动力学方案是相同的。\n\nC. 顶点结合能遵循 $B^*_{\\mathrm{TOF}} > B^*_{\\mathrm{spec}} > B^*_{\\mathrm{mass}}$，且宽度满足 $W_{\\mathrm{TOF}}  W_{\\mathrm{spec}}  W_{\\mathrm{mass}}$。\n\nD. 顶点结合能遵循 $B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$，但宽度满足 $W_{\\mathrm{TOF}}  W_{\\mathrm{spec}}  W_{\\mathrm{mass}}$。", "solution": "用户提供了一个关于催化领域火山图的问题陈述。我必须首先验证该陈述。\n\n### 步骤1：提取已知条件\n- **反应序列：** 反应物吸附 - 表面反应 - 产物脱附。\n- **模型假设：**\n    - 基元步骤遵循阿伦尼乌斯动力学，其温度为 $T$，玻尔兹曼常数为 $k_{\\mathrm{B}}$。\n    - Brønsted–Evans–Polanyi (BEP) 关系。\n    - 准平衡吸附，在活性主导区中间体覆盖度高。\n    - 电催化的电势依赖性被吸收到表面反应速率常数的指前因子中。\n- **描述符：** $B \\equiv -\\Delta G_{\\mathrm{ads}}$，关键中间体标准吸附自由能的大小，单位为电子伏特。\n- **参数形式：**\n    - 表面反应速率常数：$k_{\\mathrm{rxn}}(B) = k_{0}\\,\\exp\\!\\left(\\dfrac{\\gamma\\,B}{k_{\\mathrm{B}} T}\\right)$，其中 BEP 斜率 $0  \\gamma  1$。\n    - 脱附速率常数：$k_{\\mathrm{des}}(B) = \\nu_{\\mathrm{des}}\\,\\exp\\!\\left(-\\dfrac{B}{k_{\\mathrm{B}} T}\\right)$。\n    - 单位点转换频率：$r_{\\mathrm{site}}(B) = \\dfrac{k_{\\mathrm{rxn}}(B)\\,k_{\\mathrm{des}}(B)}{k_{\\mathrm{rxn}}(B) + k_{\\mathrm{des}}(B)}$。\n- **活性度量（Y轴）：**\n    1. 转换频率：$r_{\\mathrm{site}}(B)$。\n    2. 比活性：$j_{\\mathrm{spec}}(B) = n F\\,\\sigma_{\\mathrm{site}}(B)\\,r_{\\mathrm{site}}(B)$。\n    3. 质量归一化活性：$J_{\\mathrm{mass}}(B) = j_{\\mathrm{spec}}(B)\\,A_{\\mathrm{m}}(B) = n F\\,\\sigma_{\\mathrm{site}}(B)\\,A_{\\mathrm{m}}(B)\\,r_{\\mathrm{site}}(B)$。\n- **构效关系：**\n    - 位点密度：$\\sigma_{\\mathrm{site}}(B) = \\sigma_{0}\\,\\exp\\!\\left(\\dfrac{\\eta\\,B}{k_{\\mathrm{B}} T}\\right)$。\n    - 质量比表面积：$A_{\\mathrm{m}}(B) = A_{0}\\,\\exp\\!\\left(\\dfrac{\\xi\\,B}{k_{\\mathrm{B}} T}\\right)$。\n- **参数：**\n    - $T = 298\\,\\mathrm{K}$\n    - $k_{\\mathrm{B}} T \\approx 0.02585\\,\\mathrm{eV}$\n    - $\\gamma = 0.5$\n    - $\\eta = 0.05$\n    - $\\xi = 0.10$\n- **定义：**\n    - 顶点位置 $B^*$：y轴量达到最大值时的 $B$ 值。\n    - 表观宽度 $W$：半峰全宽（FWHM），通过y轴量的对数在其顶点附近的二次展开来近似。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题陈述描述了一个在多相催化中用于基于Sabatier原理生成火山图的标准理论模型。该模型使用了诸如阿伦尼乌斯动力学、Brønsted-Evans-Polanyi关系和由速率常数的调和平均值表示的简化两步动力学模型等已建立的概念。包含依赖于描述符的位点密度和表面积是文献中已知的一种改进，用于将理想化的单位点活性与可实验测量的量（如比活性和质量活性）联系起来。该问题具有科学依据，提法明确，并使用精确、客观的语言。所提供的参数在物理上是合理的。没有矛盾、歧义或违反科学原理的地方。\n\n### 步骤3：结论与行动\n问题陈述有效。我将继续进行推导和求解。\n\n### 推导\n\n需要分析的三个活性度量是：\n1.  转换频率 (TOF): $y_1(B) = r_{\\mathrm{site}}(B)$\n2.  比活性: $y_2(B) = n F \\sigma_{\\mathrm{site}}(B) r_{\\mathrm{site}}(B) = n F \\sigma_0 \\exp\\left(\\frac{\\eta B}{k_{\\mathrm{B}} T}\\right) r_{\\mathrm{site}}(B)$\n3.  质量活性: $y_3(B) = n F \\sigma_{\\mathrm{site}}(B) A_{\\mathrm{m}}(B) r_{\\mathrm{site}}(B) = n F \\sigma_0 A_0 \\exp\\left(\\frac{(\\eta+\\xi) B}{k_{\\mathrm{B}} T}\\right) r_{\\mathrm{site}}(B)$\n\n这些可以写成通用形式 $Y(B) \\propto \\exp\\left(\\frac{\\alpha B}{k_{\\mathrm{B}} T}\\right) r_{\\mathrm{site}}(B)$，其中参数 $\\alpha$ 是：\n- 对于 TOF ($y_1$)，$\\alpha = 0$。\n- 对于比活性 ($y_2$)，$\\alpha = \\eta$。\n- 对于质量活性 ($y_3$)，$\\alpha = \\eta+\\xi$。\n\n为了找到每个火山图的顶点 $B^*$，我们最大化活性度量的对数，$L(B) = \\ln(Y(B))$。\n$L(B) = \\text{常数} + \\dfrac{\\alpha B}{k_{\\mathrm{B}} T} + \\ln(r_{\\mathrm{site}}(B))$。\n最大值出现在对 $B$ 的导数为零的地方：\n$\\dfrac{d L(B)}{d B} = \\dfrac{\\alpha}{k_{\\mathrm{B}} T} + \\dfrac{d}{d B}\\ln(r_{\\mathrm{site}}(B)) = 0$。\n\n我们首先计算 $\\ln(r_{\\mathrm{site}}(B))$ 的导数。\n$r_{\\mathrm{site}} = \\frac{k_{\\mathrm{rxn}} k_{\\mathrm{des}}}{k_{\\mathrm{rxn}} + k_{\\mathrm{des}}}$。\n$\\ln(r_{\\mathrm{site}}) = \\ln(k_{\\mathrm{rxn}}) + \\ln(k_{\\mathrm{des}}) - \\ln(k_{\\mathrm{rxn}} + k_{\\mathrm{des}})$。\n$\\dfrac{d\\ln(r_{\\mathrm{site}})}{dB} = \\dfrac{1}{k_{\\mathrm{rxn}}}\\dfrac{dk_{\\mathrm{rxn}}}{dB} + \\dfrac{1}{k_{\\mathrm{des}}}\\dfrac{dk_{\\mathrm{des}}}{dB} - \\dfrac{1}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}}\\left(\\dfrac{dk_{\\mathrm{rxn}}}{dB} + \\dfrac{dk_{\\mathrm{des}}}{dB}\\right)$。\n给定 $k_{\\mathrm{rxn}}(B) = k_0 e^{\\gamma B / k_{\\mathrm{B}}T}$ 和 $k_{\\mathrm{des}}(B) = \\nu_{\\mathrm{des}} e^{-B/k_{\\mathrm{B}}T}$，我们有：\n$\\dfrac{dk_{\\mathrm{rxn}}}{dB} = k_{\\mathrm{rxn}} \\dfrac{\\gamma}{k_{\\mathrm{B}}T}$ 和 $\\dfrac{dk_{\\mathrm{des}}}{dB} = - k_{\\mathrm{des}} \\dfrac{1}{k_{\\mathrm{B}}T}$。\n将这些代入 $\\ln(r_{\\mathrm{site}})$ 的导数中：\n$\\dfrac{d\\ln(r_{\\mathrm{site}})}{dB} = \\dfrac{\\gamma}{k_{\\mathrm{B}}T} - \\dfrac{1}{k_{\\mathrm{B}}T} - \\dfrac{1}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}}\\left(k_{\\mathrm{rxn}}\\dfrac{\\gamma}{k_{\\mathrm{B}}T} - k_{\\mathrm{des}}\\dfrac{1}{k_{\\mathrm{B}}T}\\right)$\n$= \\dfrac{1}{k_{\\mathrm{B}}T} \\left[ (\\gamma-1) - \\dfrac{\\gamma k_{\\mathrm{rxn}} - k_{\\mathrm{des}}}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}} \\right] = \\dfrac{1}{k_{\\mathrm{B}}T} \\left[ \\dfrac{(\\gamma-1)(k_{\\mathrm{rxn}}+k_{\\mathrm{des}}) - (\\gamma k_{\\mathrm{rxn}} - k_{\\mathrm{des}})}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}} \\right]$\n$= \\dfrac{1}{k_{\\mathrm{B}}T} \\left[ \\dfrac{\\gamma k_{\\mathrm{rxn}} + \\gamma k_{\\mathrm{des}} - k_{\\mathrm{rxn}} - k_{\\mathrm{des}} - \\gamma k_{\\mathrm{rxn}} + k_{\\mathrm{des}}}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}} \\right] = \\dfrac{1}{k_{\\mathrm{B}}T} \\dfrac{\\gamma k_{\\mathrm{des}} - k_{\\mathrm{rxn}}}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}}$。\n\n顶点的条件 $\\dfrac{d L}{dB}=0$ 变为：\n$\\dfrac{\\alpha}{k_{\\mathrm{B}} T} + \\dfrac{1}{k_{\\mathrm{B}}T} \\dfrac{\\gamma k_{\\mathrm{des}} - k_{\\mathrm{rxn}}}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}} = 0$。\n$\\alpha(k_{\\mathrm{rxn}}+k_{\\mathrm{des}}) + \\gamma k_{\\mathrm{des}} - k_{\\mathrm{rxn}} = 0$。\n$k_{\\mathrm{rxn}}(1-\\alpha) = k_{\\mathrm{des}}(\\gamma+\\alpha)$。\n在顶点 $B^*$ 处速率常数的比值为 $\\rho(B^*) = \\dfrac{k_{\\mathrm{rxn}}(B^*)}{k_{\\mathrm{des}}(B^*)} = \\dfrac{\\gamma+\\alpha}{1-\\alpha}$。\n\n我们也知道 $\\rho(B) = \\dfrac{k_0 e^{\\gamma B / k_{\\mathrm{B}}T}}{\\nu_{\\mathrm{des}} e^{-B/k_{\\mathrm{B}}T}} = \\dfrac{k_0}{\\nu_{\\mathrm{des}}} e^{(1+\\gamma)B/k_{\\mathrm{B}}T}$。\n所以，在顶点 $B^*$ 处：$\\dfrac{k_0}{\\nu_{\\mathrm{des}}} e^{(1+\\gamma)B^*/k_{\\mathrm{B}}T} = \\dfrac{\\gamma+\\alpha}{1-\\alpha}$。\n求解 $B^*$：\n$B^* = \\dfrac{k_{\\mathrm{B}}T}{1+\\gamma} \\ln\\left( \\dfrac{\\nu_{\\mathrm{des}}}{k_0} \\dfrac{\\gamma+\\alpha}{1-\\alpha} \\right)$。\n\n现在，我们使用 $\\gamma=0.5, \\eta=0.05, \\xi=0.10$ 对三种情况评估 $B^*$：\n1.  **TOF ($B^*_{\\mathrm{TOF}}$):** $\\alpha=0$。\n    $B^*_{\\mathrm{TOF}} = \\dfrac{k_{\\mathrm{B}}T}{1+\\gamma} \\ln\\left( \\dfrac{\\nu_{\\mathrm{des}}}{k_0} \\gamma \\right)$。\n2.  **比活性 ($B^*_{\\mathrm{spec}}$):** $\\alpha=\\eta$。\n    $B^*_{\\mathrm{spec}} = \\dfrac{k_{\\mathrm{B}}T}{1+\\gamma} \\ln\\left( \\dfrac{\\nu_{\\mathrm{des}}}{k_0} \\dfrac{\\gamma+\\eta}{1-\\eta} \\right)$。\n3.  **质量活性 ($B^*_{\\mathrm{mass}}$):** $\\alpha=\\eta+\\xi$。\n    $B^*_{\\mathrm{mass}} = \\dfrac{k_{\\mathrm{B}}T}{1+\\gamma} \\ln\\left( \\dfrac{\\nu_{\\mathrm{des}}}{k_0} \\dfrac{\\gamma+\\eta+\\xi}{1-\\eta-\\xi} \\right)$。\n\n为了比较顶点位置，我们比较对数的自变量。令 $f(x) = \\frac{\\gamma+x}{1-x}$。其导数为 $f'(x) = \\frac{1(1-x) - (\\gamma+x)(-1)}{(1-x)^2} = \\frac{1+\\gamma}{(1-x)^2} > 0$（对于 $x1$）。由于 $\\eta+\\xi = 0.15  1$，函数 $f(x)$ 在相关定义域内是严格递增的。\n我们有 $0  \\eta  \\eta+\\xi$。因此，$f(0)  f(\\eta)  f(\\eta+\\xi)$。\n对数的自变量为 $\\gamma  \\frac{\\gamma+\\eta}{1-\\eta}  \\frac{\\gamma+\\eta+\\xi}{1-\\eta-\\xi}$。\n由于 $\\ln(x)$ 是一个增函数，我们得到顶点的排序：\n$B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$。\n\n接下来，我们分析宽度 $W$。宽度由二次展开 $L(B) \\approx L(B^*) + \\frac{1}{2}L''(B^*)(B-B^*)^2$ 近似得到。半峰全宽 $W$ 满足 $W = \\sqrt{\\frac{-8\\ln(2)}{L''(B^*)}}$。因此，$W \\propto 1/\\sqrt{-L''(B^*)}$。\n二阶导数是 $L''(B) = \\dfrac{d^2}{dB^2} \\left(\\text{const} + \\dfrac{\\alpha B}{k_{\\mathrm{B}} T} + \\ln(r_{\\mathrm{site}}(B))\\right) = \\dfrac{d^2}{dB^2}\\ln(r_{\\mathrm{site}}(B))$。\n对数活性图在任何 $B$ 处的曲率都与 $\\alpha$ 无关。我们来计算这个二阶导数，$H(B) = \\frac{d^2}{dB^2}\\ln(r_{\\mathrm{site}}(B))$。\n$H(B) = \\dfrac{d}{dB} \\left( \\dfrac{1}{k_{\\mathrm{B}}T} \\dfrac{\\gamma k_{\\mathrm{des}} - k_{\\mathrm{rxn}}}{k_{\\mathrm{rxn}}+k_{\\mathrm{des}}} \\right)$。\n使用我们之前找到的商法则和导数，得到：\n$H(B) = \\dfrac{1}{(k_{\\mathrm{B}}T)^2} \\dfrac{-\\gamma(k_{\\mathrm{rxn}}+k_{\\mathrm{des}})^2 - (\\gamma k_{\\mathrm{des}}-k_{\\mathrm{rxn}})(\\gamma k_{\\mathrm{rxn}}-k_{\\mathrm{des}})}{(k_{\\mathrm{rxn}}+k_{\\mathrm{des}})^2}$。\n经过代数简化，这变为 $H(B) = -\\dfrac{(1+\\gamma)^2}{(k_{\\mathrm{B}}T)^2} \\dfrac{k_{\\mathrm{rxn}} k_{\\mathrm{des}}}{(k_{\\mathrm{rxn}}+k_{\\mathrm{des}})^2}$。\n\n宽度 $W$ 取决于该曲率在各自顶点 $B^*$ 处的值。所以我们必须比较三个火山图的 $|H(B^*)|$。\n$|H(B)| \\propto \\dfrac{k_{\\mathrm{rxn}}(B) k_{\\mathrm{des}}(B)}{(k_{\\mathrm{rxn}}(B)+k_{\\mathrm{des}}(B))^2}$。令速率比为 $\\rho(B) = k_{\\mathrm{rxn}}(B)/k_{\\mathrm{des}}(B)$。\n那么 $|H(B)| \\propto \\dfrac{\\rho(B)}{(1+\\rho(B))^2}$。令 $g(\\rho) = \\frac{\\rho}{(1+\\rho)^2}$。\n宽度通过 $W \\propto 1/\\sqrt{g(\\rho(B^*))}$ 相关联。\n为了比较宽度，我们比较在每个顶点对应的速率比下 $g(\\rho)$ 的值。\n- 在 $B^*_{\\mathrm{TOF}}$ 处，$\\rho_{\\mathrm{TOF}} = \\frac{\\gamma+0}{1-0} = \\gamma = 0.5$。\n- 在 $B^*_{\\mathrm{spec}}$ 处，$\\rho_{\\mathrm{spec}} = \\frac{\\gamma+\\eta}{1-\\eta} = \\frac{0.5+0.05}{1-0.05} = \\frac{0.55}{0.95} \\approx 0.579$。\n- 在 $B^*_{\\mathrm{mass}}$ 处，$\\rho_{\\mathrm{mass}} = \\frac{\\gamma+\\eta+\\xi}{1-\\eta-\\xi} = \\frac{0.5+0.05+0.1}{1-0.05-0.1} = \\frac{0.65}{0.85} \\approx 0.765$。\n\n我们需要知道 $g(\\rho)$ 的行为。$g'(\\rho) = \\frac{1-\\rho}{(1+\\rho)^3}$。由于 $\\gamma=0.51$ 且 $\\eta, \\xi$ 是小的正数，所有的速率比 $\\rho$ 都在0和1之间。对于 $\\rho  1$，$g'(\\rho) > 0$，所以 $g(\\rho)$ 是严格递增的。\n我们有 $\\rho_{\\mathrm{TOF}}  \\rho_{\\mathrm{spec}}  \\rho_{\\mathrm{mass}}  1$。\n这意味着 $g(\\rho_{\\mathrm{TOF}})  g(\\rho_{\\mathrm{spec}})  g(\\rho_{\\mathrm{mass}})$。\n因此，顶点处曲率的大小排序为：$|L''(B^*_{\\mathrm{TOF}})|  |L''(B^*_{\\mathrm{spec}})|  |L''(B^*_{\\mathrm{mass}})|$。\n由于宽度 $W$ 与曲率大小的平方根成反比，宽度的排序为：\n$W_{\\mathrm{TOF}} > W_{\\mathrm{spec}} > W_{\\mathrm{mass}}$。\n\n### 结果总结：\n- 顶点位置：$B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$。\n- 表观宽度：$W_{\\mathrm{TOF}} > W_{\\mathrm{spec}} > W_{\\mathrm{mass}}$。\n\n### 逐项分析\n\n**A. 顶点结合能遵循 $B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$，且宽度满足 $W_{\\mathrm{TOF}} > W_{\\mathrm{spec}} > W_{\\mathrm{mass}}$。**\n这个陈述与我们的推导结果完全匹配。辅助的标度关系 $\\sigma_{\\mathrm{site}}(B)$ 和 $A_{\\mathrm{m}}(B)$ 含有指数项，这些项将火山图顶点移向更高的结合能。“更高的结合能”对应于更大的 $B$。这个移动使顶点偏离了底层 $\\ln(r_{\\mathrm{site}})$ 火山图最大曲率的点，采样了曲率较低的区域，如果移动是负的，会导致火山图更宽。但在这里移动是正的。$\\ln(r_{\\mathrm{site}})$ 的顶点在 $\\rho=\\gamma=0.5$ 处，而最大曲率在 $\\rho=1$ 处。随着顶点移向更大的 $B$，$\\rho$ 增加并更接近于1，从而增加了曲率并使火山图变窄。我的宽度分析是正确的。更高的 $g(\\rho)$ 意味着更窄的宽度。当 $\\rho$ 从0增加到1时，$g(\\rho)$ 增加。由于 $\\rho$ 从TOF到质量活性依次增加，曲率增加而宽度减小。\n**结论：正确。**\n\n**B. 所有三个火山图都在相同的结合能处达到峰值，并且具有相同的宽度，因为底层的微观动力学方案是相同的。**\n这是不正确的。虽然 $r_{\\mathrm{site}}(B)$ 的微观动力学模型是相同的，但整体活性度量 $j_{\\mathrm{spec}}(B)$ 和 $J_{\\mathrm{mass}}(B)$ 包含了额外的依赖于 $B$ 的因子（$\\sigma_{\\mathrm{site}}(B)$ 和 $A_{\\mathrm{m}}(B)$）。这些因子移动了最大值并改变了最大值处的曲率，从而同时改变了顶点和宽度。\n**结论：不正确。**\n\n**C. 顶点结合能遵循 $B^*_{\\mathrm{TOF}} > B^*_{\\mathrm{spec}} > B^*_{\\mathrm{mass}}$，且宽度满足 $W_{\\mathrm{TOF}}  W_{\\mathrm{spec}}  W_{\\mathrm{mass}}$。**\n这个陈述给出的顶点位置和宽度的排序都与我们的推导相反。如果 $\\eta$ 和 $\\xi$ 是负数，情况就会是这样。\n**结论：不正确。**\n\n**D. 顶点结合能遵循 $B^*_{\\mathrm{TOF}}  B^*_{\\mathrm{spec}}  B^*_{\\mathrm{mass}}$，但宽度满足 $W_{\\mathrm{TOF}}  W_{\\mathrm{spec}}  W_{\\mathrm{mass}}$。**\n顶点结合能的排序是正确的。然而，宽度的排序是不正确的。增加的顶点曲率 $|L''(B^*)|$ 对应于减小的宽度 $W$。我们的推导表明曲率大小增加，因此宽度必须减小。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2680804"}, {"introduction": "现实世界中的火山图通常建立在从有限且常带有噪声的计算或实验数据中获得的标度关系之上。这个高级计算练习 [@problem_id:2680827] 模拟了这一数据驱动的建模过程，要求你通过线性回归来确定标度关系参数。更关键的是，它还要求你将拟合过程中的统计不确定性传播到火山图峰顶位置的最终预测中，这对于量化模型的预测能力和可靠性是一项核心技能。", "problem": "给定一个结构-活性模拟任务，该任务将吸附能的标度关系与一个简单的双能垒火山模型联系起来，用于描述催化活性。考虑两种吸附中间体，用物种索引 $i \\in \\{A, B\\}$ 表示，其吸附能 $\\Delta E_i$ 通过未知线性标度关系与单一描述符 $\\Delta E_{\\text{ref}}$ 线性相关，形式为 $\\Delta E_i = a_i \\Delta E_{\\text{ref}} + b_i$。您的基本假设是：(i) 线性标度关系源于对计算数据集的最小二乘拟合，因此必须从有限样本中估计；(ii) 使用线性最小二乘估计量；(iii) 决定系数 $R^2$ 由常规的方差分解定义；(iv) 不确定性根据一阶高斯-牛顿线性化（估计的一阶泰勒展开）进行传播。活性由两个有效能垒建模，这两个能垒通过 Bronsted–Evans–Polanyi (BEP) 型关系中的常数与吸附质能量线性相关。具体来说，两个控制能垒为 $E_{\\text{bar},1}(\\Delta E_{\\text{ref}}) = \\kappa_1 + \\lambda_1 \\Delta E_A$ 和 $E_{\\text{bar},2}(\\Delta E_{\\text{ref}}) = \\kappa_2 + \\lambda_2 \\Delta E_B$。火山顶描述符值 $\\Delta E_{\\text{ref}}^{\\star}$ 定义为使 $E_{\\text{bar},1}(\\Delta E_{\\text{ref}}^{\\star}) = E_{\\text{bar},2}(\\Delta E_{\\text{ref}}^{\\star})$ 成立的点。所有能量均以电子伏特 (eV) 为单位处理，您最终的能量数值答案必须以 eV 表示。决定系数 $R^2$ 是无量纲的，必须表示为小数值。\n\n您对每个测试用例的任务是：\n- 对于 $i \\in \\{A,B\\}$，使用普通最小二乘法，从给定的有限数据集 $\\{(\\Delta E_{\\text{ref}}^j, \\Delta E_i^j)\\}_j$ 中估计 $\\Delta E_i = a_i \\Delta E_{\\text{ref}} + b_i$ 中的斜率 $a_i$ 和截距 $b_i$。\n- 对每次拟合，仅使用基于平方和的基本定义计算决定系数 $R^2$。\n- 利用拟合参数及其从线性回归中估计出的协方差矩阵，通过一阶高斯误差传播，将参数不确定性传播到火山顶描述符 $\\Delta E_{\\text{ref}}^{\\star}$，其中假定两次线性回归在给定描述符值的情况下是统计独立的。\n- 对每个测试用例，报告一个包含三个结果的三元组，包括两个 $R^2$ 值（分别对应 $A$ 和 $B$）、火山顶描述符 $\\Delta E_{\\text{ref}}^{\\star}$（单位为 $\\text{eV}$）以及 $\\Delta E_{\\text{ref}}^{\\star}$ 的标准差（方差的平方根，单位为 $\\text{eV}$）。\n\n您必须遵守的基本原理：\n- 普通最小二乘估计量最小化残差平方和，并产生可以用设计矩阵 $X$ 和响应向量 $y$ 表示的正规方程。\n- 决定系数 $R^2$ 定义为可解释平方和与总平方和之比，等价于 $1$ 减去残差平方和与总平方和之比。\n- 对于具有独立同分布同方差残差的线性模型，最小二乘参数估计的协方差矩阵与费雪信息的逆矩阵成正比，具体来说是 $(X^{\\mathsf{T}} X)^{-1}$ 乘以由残差平方和和自由度估计的残差方差。\n- 一阶不确定性传播使用从参数到导出量的变换的雅可比矩阵，得出的方差等于雅可比矩阵乘以参数协方差矩阵再乘以其转置。\n\n火山模型和火山顶定义：\n- 设有 $\\Delta E_A = a_A \\Delta E_{\\text{ref}} + b_A$ 和 $\\Delta E_B = a_B \\Delta E_{\\text{ref}} + b_B$，定义 $E_{\\text{bar},1}(\\Delta E_{\\text{ref}}) = \\kappa_1 + \\lambda_1 \\Delta E_A$ 和 $E_{\\text{bar},2}(\\Delta E_{\\text{ref}}) = \\kappa_2 + \\lambda_2 \\Delta E_B$，其中 $\\kappa_1$、$\\kappa_2$ 的单位为 $\\text{eV}$，$\\lambda_1$、$\\lambda_2$ 为无量纲。火山顶 $\\Delta E_{\\text{ref}}^{\\star}$ 是方程 $E_{\\text{bar},1}(\\Delta E_{\\text{ref}}^{\\star}) = E_{\\text{bar},2}(\\Delta E_{\\text{ref}}^{\\star})$ 的解。\n\n测试套件：\n- 测试用例 1：\n  - 描述符值 $\\{\\Delta E_{\\text{ref}}^j\\}$: $\\{-1.8, -1.5, -1.2, -0.9, -0.6\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_A^j\\}$: $\\{-0.93, -0.70, -0.44, -0.23, 0.02\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_B^j\\}$: $\\{0.58, 0.46, 0.30, 0.14, 0.02\\}$ $\\text{eV}$。\n  - 火山模型常数：$\\kappa_1 = 0.8$ $\\text{eV}$，$\\lambda_1 = 0.6$，$\\kappa_2 = 0.9$ $\\text{eV}$，$\\lambda_2 = 0.7$。\n- 测试用例 2：\n  - 描述符值 $\\{\\Delta E_{\\text{ref}}^j\\}$: $\\{-2.0, -1.6, -1.2, -0.8, -0.4, 0.0\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_A^j\\}$: $\\{-0.32, -0.41, -0.20, -0.31, -0.34, -0.20\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_B^j\\}$: $\\{-0.68, -0.55, -0.38, -0.21, -0.09, 0.12\\}$ $\\text{eV}$。\n  - 火山模型常数：$\\kappa_1 = 0.5$ $\\text{eV}$，$\\lambda_1 = 0.5$，$\\kappa_2 = 0.6$ $\\text{eV}$，$\\lambda_2 = 0.4$。\n- 测试用例 3：\n  - 描述符值 $\\{\\Delta E_{\\text{ref}}^j\\}$: $\\{-1.02, -1.01, -1.00, -0.99, -0.98\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_A^j\\}$: $\\{-1.03, -1.02, -1.00, -0.99, -0.97\\}$ $\\text{eV}$。\n  - 吸附能 $\\{\\Delta E_B^j\\}$: $\\{-1.18, -1.16, -1.15, -1.14, -1.12\\}$ $\\text{eV}$。\n  - 火山模型常数：$\\kappa_1 = 0.7$ $\\text{eV}$，$\\lambda_1 = 0.8$，$\\kappa_2 = 0.9$ $\\text{eV}$，$\\lambda_2 = 0.64$。\n\n每个测试用例所需的输出：\n- $\\Delta E_A$ 对 $\\Delta E_{\\text{ref}}$ 拟合的决定系数 $R^2$（无量纲，以小数形式表示）。\n- $\\Delta E_B$ 对 $\\Delta E_{\\text{ref}}$ 拟合的决定系数 $R^2$（无量纲，以小数形式表示）。\n- 火山顶描述符 $\\Delta E_{\\text{ref}}^{\\star}$，单位为 $\\text{eV}$。\n- 通过从回归参数协方差进行一阶不确定性传播得到的 $\\Delta E_{\\text{ref}}^{\\star}$ 的标准差，单位为 $\\text{eV}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有三个测试用例的结果，形式为列表的列表，每个内部列表按 $[R^2_A, R^2_B, \\Delta E_{\\text{ref}}^{\\star}, \\sigma_{\\Delta E_{\\text{ref}}^{\\star}}]$ 的顺序排列。整个输出必须是单行，形式为用方括号括起来的逗号分隔列表。", "solution": "所呈现的问题是计算催化领域的一个标准练习，要求将线性回归、统计分析和误差传播应用于火山图模型。该问题定义明确，科学上合理，并包含了获得唯一解所需的所有信息。我们将着手进行推导和计算。\n\n该方法包括四个主要步骤：首先，使用普通最小二乘法 (OLS) 估计线性标度关系参数；其次，使用决定系数 $R^2$ 评估拟合优度；第三，根据拟合模型计算火山顶描述符；第四，将 OLS 拟合产生的参数不确定性传播到计算出的火山顶描述符。\n\n**$1$. 普通最小二乘 (OLS) 回归**\n\n对于每个物种 $i \\in \\{A, B\\}$，我们给定一组 $N$ 个数据点 $\\{(\\Delta E_{\\text{ref}}^j, \\Delta E_i^j)\\}_{j=1}^N$。我们假设存在线性关系 $\\Delta E_i = a_i \\Delta E_{\\text{ref}} + b_i$。这可以表示为矩阵形式：\n$$\n\\mathbf{y}_i = \\mathbf{X} \\boldsymbol{\\beta}_i + \\boldsymbol{\\epsilon}_i\n$$\n其中 $\\mathbf{y}_i$ 是观测到的吸附能 $\\Delta E_i^j$ 的 $N \\times 1$ 向量，$\\boldsymbol{\\beta}_i = \\begin{pmatrix} b_i \\\\ a_i \\end{pmatrix}$ 是参数（截距和斜率）的 $2 \\times 1$ 向量，$\\mathbf{X}$ 是 $N \\times 2$ 的设计矩阵，对两种物种都相同：\n$$\n\\mathbf{y}_i = \\begin{pmatrix} \\Delta E_i^1 \\\\ \\Delta E_i^2 \\\\ \\vdots \\\\ \\Delta E_i^N \\end{pmatrix}, \\quad\n\\mathbf{X} = \\begin{pmatrix} 1  \\Delta E_{\\text{ref}}^1 \\\\ 1  \\Delta E_{\\text{ref}}^2 \\\\ \\vdots  \\vdots \\\\ 1  \\Delta E_{\\text{ref}}^N \\end{pmatrix}\n$$\nOLS 估计量 $\\hat{\\boldsymbol{\\beta}}_i$ 最小化残差平方和 $\\text{RSS}_i = (\\mathbf{y}_i - \\mathbf{X}\\boldsymbol{\\beta}_i)^{\\mathsf{T}}(\\mathbf{y}_i - \\mathbf{X}\\boldsymbol{\\beta}_i)$。解由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}}_i = (\\mathbf{X}^{\\mathsf{T}} \\mathbf{X})^{-1} \\mathbf{X}^{\\mathsf{T}} \\mathbf{y}_i\n$$\n这提供了斜率 $\\hat{a}_i$ 和截距 $\\hat{b}_i$ 的估计值。\n\n**$2$. 决定系数 ($R^2$)**\n\n线性拟合的质量通过决定系数 $R^2$ 来评估。它定义为因变量总方差中可由自变量预测的部分。\n$$\nR^2_i = 1 - \\frac{\\text{RSS}_i}{\\text{TSS}_i}\n$$\n其中 $\\text{RSS}_i$ 是残差平方和，$\\text{TSS}_i$ 是总平方和。\n$$\n\\text{RSS}_i = \\sum_{j=1}^{N} (y_{ij} - \\hat{y}_{ij})^2 = \\sum_{j=1}^{N} (\\Delta E_i^j - (\\hat{a}_i \\Delta E_{\\text{ref}}^j + \\hat{b}_i))^2\n$$\n$$\n\\text{TSS}_i = \\sum_{j=1}^{N} (y_{ij} - \\bar{y}_i)^2\n$$\n此处，$\\hat{y}_{ij}$ 是回归的预测值，$\\bar{y}_i$ 是观测值 $y_{ij}$ 的均值。\n\n**$3$. 火山顶描述符 ($\\Delta E_{\\text{ref}}^{\\star}$)**\n\n火山顶 $\\Delta E_{\\text{ref}}^{\\star}$ 位于两个控制动力学能垒相等的描述符值处：\n$$\nE_{\\text{bar},1}(\\Delta E_{\\text{ref}}^{\\star}) = E_{\\text{bar},2}(\\Delta E_{\\text{ref}}^{\\star})\n$$\n代入能垒的定义 $E_{\\text{bar},1} = \\kappa_1 + \\lambda_1 \\Delta E_A$ 和 $E_{\\text{bar},2} = \\kappa_2 + \\lambda_2 \\Delta E_B$，以及拟合的线性标度关系，我们得到：\n$$\n\\kappa_1 + \\lambda_1 (\\hat{a}_A \\Delta E_{\\text{ref}}^{\\star} + \\hat{b}_A) = \\kappa_2 + \\lambda_2 (\\hat{a}_B \\Delta E_{\\text{ref}}^{\\star} + \\hat{b}_B)\n$$\n求解 $\\Delta E_{\\text{ref}}^{\\star}$ 得：\n$$\n\\Delta E_{\\text{ref}}^{\\star} = \\frac{\\kappa_2 - \\kappa_1 + \\lambda_2 \\hat{b}_B - \\lambda_1 \\hat{b}_A}{\\lambda_1 \\hat{a}_A - \\lambda_2 \\hat{a}_B}\n$$\n该表达式将 $\\Delta E_{\\text{ref}}^{\\star}$ 定义为四个估计参数的函数 $f(\\hat{b}_A, \\hat{a}_A, \\hat{b}_B, \\hat{a}_B)$。\n\n**$4$. 不确定性传播**\n\n估计参数 $\\hat{\\boldsymbol{\\beta}}_i$ 的方差由协方差矩阵给出：\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}_i) = \\hat{\\sigma}^2_i (\\mathbf{X}^{\\mathsf{T}} \\mathbf{X})^{-1}\n$$\n其中 $\\hat{\\sigma}^2_i$ 是残差方差的无偏估计量：\n$$\n\\hat{\\sigma}^2_i = \\frac{\\text{RSS}_i}{N - p}\n$$\n其中 $p=2$ 是线性模型中的参数数量。\n\n由于物种 A 和 B 的两次回归被假定为统计独立的，因此参数向量 $\\boldsymbol{\\theta} = (\\hat{b}_A, \\hat{a}_A, \\hat{b}_B, \\hat{a}_B)^{\\mathsf{T}}$ 的完整协方差矩阵是块对角的：\n$$\n\\mathbf{C}_{\\boldsymbol{\\theta}} = \\begin{pmatrix} \\text{Cov}(\\hat{\\boldsymbol{\\beta}}_A)  \\mathbf{0} \\\\ \\mathbf{0}  \\text{Cov}(\\hat{\\boldsymbol{\\beta}}_B) \\end{pmatrix}\n$$\n$\\Delta E_{\\text{ref}}^{\\star}$ 的方差使用一阶泰勒展开（delta 方法）求得：\n$$\n\\text{Var}(\\Delta E_{\\text{ref}}^{\\star}) \\approx \\mathbf{J} \\mathbf{C}_{\\boldsymbol{\\theta}} \\mathbf{J}^{\\mathsf{T}}\n$$\n其中 $\\mathbf{J}$ 是函数 $f$ 相对于 $\\boldsymbol{\\theta}$ 中参数的偏导数雅可比行向量，在其估计值处求值。设 $U = \\kappa_2 - \\kappa_1 + \\lambda_2 \\hat{b}_B - \\lambda_1 \\hat{b}_A$ 和 $V = \\lambda_1 \\hat{a}_A - \\lambda_2 \\hat{a}_B$。偏导数为：\n$$\n\\frac{\\partial f}{\\partial \\hat{b}_A} = -\\frac{\\lambda_1}{V}, \\quad \\frac{\\partial f}{\\partial \\hat{a}_A} = -\\frac{U \\lambda_1}{V^2} = -\\Delta E_{\\text{ref}}^{\\star} \\frac{\\lambda_1}{V}\n$$\n$$\n\\frac{\\partial f}{\\partial \\hat{b}_B} = \\frac{\\lambda_2}{V}, \\quad \\frac{\\partial f}{\\partial \\hat{a}_B} = \\frac{U \\lambda_2}{V^2} = \\Delta E_{\\text{ref}}^{\\star} \\frac{\\lambda_2}{V}\n$$\n由于 $\\mathbf{C}_{\\boldsymbol{\\theta}}$ 的块对角结构，方差简化为每次回归贡献的总和：\n$$\n\\text{Var}(\\Delta E_{\\text{ref}}^{\\star}) \\approx \\mathbf{J}_A \\text{Cov}(\\hat{\\boldsymbol{\\beta}}_A) \\mathbf{J}_A^{\\mathsf{T}} + \\mathbf{J}_B \\text{Cov}(\\hat{\\boldsymbol{\\beta}}_B) \\mathbf{J}_B^{\\mathsf{T}}\n$$\n其中 $\\mathbf{J}_A = (\\frac{\\partial f}{\\partial \\hat{b}_A}, \\frac{\\partial f}{\\partial \\hat{a}_A})$ 和 $\\mathbf{J}_B = (\\frac{\\partial f}{\\partial \\hat{b}_B}, \\frac{\\partial f}{\\partial \\hat{a}_B})$。标准差是该方差的平方根，即 $\\sigma_{\\Delta E_{\\text{ref}}^{\\star}} = \\sqrt{\\text{Var}(\\Delta E_{\\text{ref}}^{\\star})}$。\n\n这个完整的程序被实现并应用于所提供的每个测试用例。数值结果由随附的程序生成。", "answer": "```python\nimport numpy as np\n\ndef perform_linear_regression(x_data, y_data):\n    \"\"\"\n    Performs ordinary least squares regression for a simple linear model.\n\n    Args:\n        x_data (np.ndarray): Independent variable data.\n        y_data (np.ndarray): Dependent variable data.\n\n    Returns:\n        tuple: A tuple containing:\n            - params (np.ndarray): Estimated parameters [intercept, slope].\n            - r_squared (float): Coefficient of determination.\n            - cov_matrix (np.ndarray): Covariance matrix of the parameters.\n    \"\"\"\n    N = len(x_data)\n    if N  2:\n        raise ValueError(\"At least two data points are required for linear regression.\")\n    p = 2  # Number of parameters: intercept and slope\n\n    # Construct the design matrix X\n    X = np.vstack([np.ones(N), x_data]).T\n\n    # Calculate (X^T * X)^-1\n    try:\n        XTX_inv = np.linalg.inv(X.T @ X)\n    except np.linalg.LinAlgError:\n        # This case is unlikely with the given test data but is good practice.\n        raise np.linalg.LinAlgError(\"Design matrix is singular.\")\n\n    # Estimate parameters using the normal equations: beta = (X^T * X)^-1 * X^T * y\n    params = XTX_inv @ X.T @ y_data\n\n    # Calculate R-squared\n    y_predicted = X @ params\n    rss = np.sum((y_data - y_predicted) ** 2)\n    tss = np.sum((y_data - np.mean(y_data)) ** 2)\n    if tss == 0:\n        # Handle case where all y values are the same\n        r_squared = 1.0 if rss == 0 else 0.0\n    else:\n        r_squared = 1 - rss / tss\n\n    # Calculate the covariance matrix of parameters\n    dof = N - p\n    if dof = 0:\n      raise ValueError(\"Degrees of freedom must be positive.\")\n    residual_variance = rss / dof\n    cov_matrix = residual_variance * XTX_inv\n\n    return params, r_squared, cov_matrix\n\ndef calculate_apex_and_uncertainty(params_A, cov_A, params_B, cov_B, k1, l1, k2, l2):\n    \"\"\"\n    Calculates the volcano apex descriptor and its uncertainty.\n\n    Args:\n        params_A (np.ndarray): Parameters [b_A, a_A] for species A.\n        cov_A (np.ndarray): Covariance matrix for parameters of A.\n        params_B (np.ndarray): Parameters [b_B, a_B] for species B.\n        cov_B (np.ndarray): Covariance matrix for parameters of B.\n        k1, l1, k2, l2 (float): Constants for the volcano model.\n\n    Returns:\n        tuple: A tuple containing:\n            - apex_descriptor (float): The value of Delta E_ref at the apex.\n            - apex_std_dev (float): The standard deviation of the apex descriptor.\n    \"\"\"\n    b_A, a_A = params_A\n    b_B, a_B = params_B\n\n    # Calculate apex descriptor\n    numerator = k2 - k1 + l2 * b_B - l1 * b_A\n    denominator = l1 * a_A - l2 * a_B\n    \n    if abs(denominator)  1e-9:\n        # This indicates parallel lines, no unique apex.\n        apex_descriptor = np.nan\n        apex_std_dev = np.nan\n        return apex_descriptor, apex_std_dev\n\n    apex_descriptor = numerator / denominator\n\n    # Calculate Jacobian components\n    # f = (k2 - k1 + l2*bB - l1*bA) / (l1*aA - l2*aB)\n    # Parameters are ordered [b_A, a_A, b_B, a_B]\n    # Jacobian for A: [df/db_A, df/da_A]\n    # Jacobian for B: [df/db_B, df/da_B]\n    \n    df_dbA = -l1 / denominator\n    df_daA = -numerator * l1 / (denominator ** 2)\n    \n    df_dbB = l2 / denominator\n    df_daB = numerator * l2 / (denominator ** 2) # This should have a - sign from the chain rule on the denominator. Let me re-derive.\n    # df/daB = (k2-k1+l2bB-l1bA) * (-1) * (l1aA-l2aB)^-2 * (-l2) = numerator * l2 / denominator^2\n    # My previous implementation was correct.\n\n    J_A = np.array([df_dbA, df_daA])\n    J_B = np.array([df_dbB, df_daB])\n\n    # Propagate uncertainty\n    # Variance = J_A * Cov_A * J_A^T + J_B * Cov_B * J_B^T\n    var_A = J_A @ cov_A @ J_A.T\n    var_B = J_B @ cov_B @ J_B.T\n    \n    total_variance = var_A + var_B\n    if total_variance  0:\n        # Should not happen with positive semi-definite covariance matrices\n        apex_std_dev = np.nan\n    else:\n        apex_std_dev = np.sqrt(total_variance)\n\n    return apex_descriptor, apex_std_dev\n\ndef solve():\n    test_cases = [\n        {\n            \"E_ref\": np.array([-1.8, -1.5, -1.2, -0.9, -0.6]),\n            \"E_A\": np.array([-0.93, -0.70, -0.44, -0.23, 0.02]),\n            \"E_B\": np.array([0.58, 0.46, 0.30, 0.14, 0.02]),\n            \"k1\": 0.8, \"l1\": 0.6, \"k2\": 0.9, \"l2\": 0.7\n        },\n        {\n            \"E_ref\": np.array([-2.0, -1.6, -1.2, -0.8, -0.4, 0.0]),\n            \"E_A\": np.array([-0.32, -0.41, -0.20, -0.31, -0.34, -0.20]),\n            \"E_B\": np.array([-0.68, -0.55, -0.38, -0.21, -0.09, 0.12]),\n            \"k1\": 0.5, \"l1\": 0.5, \"k2\": 0.6, \"l2\": 0.4\n        },\n        {\n            \"E_ref\": np.array([-1.02, -1.01, -1.00, -0.99, -0.98]),\n            \"E_A\": np.array([-1.03, -1.02, -1.00, -0.99, -0.97]),\n            \"E_B\": np.array([-1.18, -1.16, -1.15, -1.14, -1.12]),\n            \"k1\": 0.7, \"l1\": 0.8, \"k2\": 0.9, \"l2\": 0.64\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        params_A, r2_A, cov_A = perform_linear_regression(case[\"E_ref\"], case[\"E_A\"])\n        params_B, r2_B, cov_B = perform_linear_regression(case[\"E_ref\"], case[\"E_B\"])\n        \n        apex, std_dev = calculate_apex_and_uncertainty(\n            params_A, cov_A, params_B, cov_B,\n            case[\"k1\"], case[\"l1\"], case[\"k2\"], case[\"l2\"]\n        )\n\n        all_results.append([r2_A, r2_B, apex, std_dev])\n\n    # Format the final output string as specified\n    output_str = f\"[[{all_results[0][0]:.8f},{all_results[0][1]:.8f},{all_results[0][2]:.8f},{all_results[0][3]:.8f}],\" \\\n               f\"[{all_results[1][0]:.8f},{all_results[1][1]:.8f},{all_results[1][2]:.8f},{all_results[1][3]:.8f}],\" \\\n               f\"[{all_results[2][0]:.8f},{all_results[2][1]:.8f},{all_results[2][2]:.8f},{all_results[2][3]:.8f}]]\"\n    print(output_str)\n\nsolve()\n```", "id": "2680827"}]}