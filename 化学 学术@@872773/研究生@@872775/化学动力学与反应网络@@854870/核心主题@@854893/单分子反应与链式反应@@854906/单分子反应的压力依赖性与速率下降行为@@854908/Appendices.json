{"hands_on_practices": [{"introduction": "单分子反应速率的压力依赖性根植于碰撞活化过程。在基础的林德曼-欣谢尔伍德（Lindemann-Hinshelwood）模型中，我们通常假设存在单一组分的“浴气”$M$。然而，在实际化学系统（如大气或燃烧过程）中，$M$往往是多种气体的混合物，而不同气体分子的碰撞传能效率各不相同。本练习将引导您通过“三体效率”这一概念来处理混合浴气的影响，并计算如何通过调整总压力来使得不同组分的混合物达到相同的有效碰撞频率，从而在坠落曲线上达到相同的位置。[@problem_id:2665130]", "problem": "在载气 $M$ 存在下，物种 $A$ 的单分子解离通过碰撞活化中间体 $A^{*}$ 进行：\n$$A + M \\rightleftharpoons A^{*} + M,\\quad A^{*} \\rightarrow \\text{products}.$$\n在固定温度下，低压极限速率系数 $k_{0}(T)$ 和高压极限速率系数 $k_{\\infty}(T)$ 是活化分子的性质，不依赖于载气组分，而载气组分通过有效碰撞物浓度影响反应。对于一个由多种载气组成的混合物，其第三体效率为 $\\alpha_{i}$，摩尔分数为 $x_{i}$，有效碰撞物浓度 $[M]_{\\text{eff}}$ 的定义为，用每种载气组分的效率对其数密度进行加权。\n\n考虑在相同温度下的两种二元载气混合物：\n- 混合物1：氮气和氩气，其中 $x_{\\mathrm{N_{2}}}=0.70$，$x_{\\mathrm{Ar}}=0.30$。\n- 混合物2：氩气和水，其中 $x_{\\mathrm{Ar}}=0.95$，$x_{\\mathrm{H_{2}O}}=0.05$。\n\n在此温度下，第三体效率分别为 $\\alpha_{\\mathrm{N_{2}}}=1.0$，$\\alpha_{\\mathrm{Ar}}=0.2$ 和 $\\alpha_{\\mathrm{H_{2}O}}=6.0$。假设所有混合物均表现为理想气体。\n\n仅使用林德曼机理的基本动力学推理和理想气体定律，构建任意混合物的有效碰撞物浓度 $[M]_{\\text{eff}}$，并说明混合物组分如何通过约化压力控制压力衰减曲线（例如，$\\ln(k/k_{\\infty})$ 对 $\\ln p$ 的图）的水平位置。然后，对于在总压 $p_{1}=1.30\\,\\text{bar}$ 下的混合物1，确定必须对混合物2施加的总压 $p_{2}$，以使两种混合物在此温度下具有相同的 $k/k_{\\infty}$ 值。\n\n将 $p_{2}$ 的最终数值答案四舍五入至四位有效数字，并以 bar 为单位表示。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰。它描述了化学动力学中的一个标准情景，特别是以林德曼-欣谢尔伍德（Lindemann-Hinshelwood）机理为模型的单分子反应的压力依赖性，并且没有任何事实或逻辑上的矛盾。因此，我们可以进行严谨的求解。\n\n单分子反应方案如下：\n$$A + M \\rightleftharpoons A^{*} + M$$\n$$A^{*} \\rightarrow \\text{products}$$\n相应的基元步骤是：\n1.  碰撞活化：$A + M \\xrightarrow{k_1} A^{*} + M$\n2.  碰撞失活：$A^{*} + M \\xrightarrow{k_{-1}} A + M$\n3.  单分子衰变：$A^{*} \\xrightarrow{k_2} \\text{products}$\n\n我们对活化分子 $[A^{*}]$ 的浓度应用稳态近似，假设其变化速率为零：\n$$\\frac{d[A^{*}]}{dt} = k_1 [A][M] - k_{-1}[A^{*}][M] - k_2 [A^{*}] \\approx 0$$\n由此，我们求解 $A^{*}$ 的稳态浓度：\n$$[A^{*}] = \\frac{k_1 [A][M]}{k_{-1}[M] + k_2}$$\n产物的生成速率由 $v = k_2 [A^{*}]$ 给出，也可以用有效一级速率系数 $k$ 来定义，即 $v = k[A]$。将这两个表达式相等可得：\n$$k[A] = k_2 \\left( \\frac{k_1 [A][M]}{k_{-1}[M] + k_2} \\right)$$\n$$k = \\frac{k_1 k_2 [M]}{k_{-1}[M] + k_2}$$\n这个 $k$ 的表达式描述了反应动力学从低压下的二级到高压下的一级的转变。\n\n高压极限速率系数 $k_{\\infty}$ 是在 $[M] \\rightarrow \\infty$ 的极限下求得的：\n$$k_{\\infty} = \\lim_{[M] \\to \\infty} \\frac{k_1 k_2 [M]}{k_{-1}[M] + k_2} = \\lim_{[M] \\to \\infty} \\frac{k_1 k_2}{k_{-1} + k_2/[M]} = \\frac{k_1 k_2}{k_{-1}}$$\n问题指出，对于载气混合物，载气浓度 $[M]$ 必须替换为有效碰撞物浓度 $[M]_{\\text{eff}}$。这考虑了不同载气组分的不同碰撞效率。因此，速率系数 $k$ 更普遍地表示为：\n$$k = \\frac{k_1 k_2 [M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2}$$\n此处我们理解 $k_1$ 和 $k_{-1}$ 是针对某一参考碰撞物的速率系数。\n\n为分析压力衰减行为，我们考虑比值 $k/k_{\\infty}$。将 $k$ 的表达式除以 $k_{\\infty}$ 的表达式：\n$$\\frac{k}{k_{\\infty}} = \\left( \\frac{k_1 k_2 [M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2} \\right) \\left( \\frac{k_{-1}}{k_1 k_2} \\right) = \\frac{k_{-1}[M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2}$$\n这可以改写为：\n$$\\frac{k}{k_{\\infty}} = \\frac{1}{1 + \\frac{k_2}{k_{-1}[M]_{\\text{eff}}}}$$\n该方程表明，表征压力衰减区位置的比值 $k/k_{\\infty}$ 是单一变量 $[M]_{\\text{eff}}$ 的函数。量 $k_2$ 和 $k_{-1}$ 仅依赖于反应物 $A$ 和温度 $T$，而不依赖于载气性质。因此，压力衰减曲线（通常绘制为 $\\ln(k/k_{\\infty})$ 对 $\\ln(p)$）的水平位置完全由 $[M]_{\\text{eff}}$ 决定。\n\n问题将混合物的有效碰撞物浓度定义为 $[M]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [M_i]$，其中 $[M_i]$ 是载气组分 $i$ 的浓度，$\\alpha_i$ 是其第三体效率。假设理想气体行为，组分 $i$ 的浓度通过理想气体定律与其摩尔分数 $x_i$ 和总压 $p$ 相关联：$[M_i] = \\frac{p_i}{RT} = \\frac{x_i p}{RT}$，其中 $R$ 是理想气体常数，$T$ 是绝对温度。\n将此代入 $[M]_{\\text{eff}}$ 的定义中：\n$$[M]_{\\text{eff}} = \\sum_{i} \\alpha_{i} \\left( \\frac{x_i p}{RT} \\right) = \\left( \\frac{p}{RT} \\right) \\sum_{i} \\alpha_{i} x_i$$\n让我们将混合物平均效率定义为 $\\alpha_{\\text{mix}} = \\sum_{i} \\alpha_{i} x_i$。那么：\n$$[M]_{\\text{eff}} = \\alpha_{\\text{mix}} \\frac{p}{RT}$$\n问题要求找到混合物2的压力 $p_2$，使得它在压力 $p_1$ 下与混合物1具有相同的 $k/k_{\\infty}$ 值。由于两种混合物的温度相同，且 $k/k_{\\infty}$ 仅是 $[M]_{\\text{eff}}$ 的函数，因此条件是：\n$$([M]_{\\text{eff}})_1 = ([M]_{\\text{eff}})_2$$\n代入将 $[M]_{\\text{eff}}$ 与压力和组分相关联的表达式：\n$$\\alpha_{\\text{mix,1}} \\frac{p_1}{RT} = \\alpha_{\\text{mix,2}} \\frac{p_2}{RT}$$\n由于 $R$ 和 $T$ 相同，它们可以消去，留下压力和混合物平均效率之间的直接关系：\n$$\\alpha_{\\text{mix,1}} p_1 = \\alpha_{\\text{mix,2}} p_2$$\n现在我们计算给定两种混合物的混合物平均效率。\n\n对于混合物1 ($x_{\\mathrm{N_{2}}}=0.70, x_{\\mathrm{Ar}}=0.30$)：\n第三体效率为 $\\alpha_{\\mathrm{N_{2}}}=1.0$ 和 $\\alpha_{\\mathrm{Ar}}=0.2$。\n$$\\alpha_{\\text{mix,1}} = x_{\\mathrm{N_{2}}}\\alpha_{\\mathrm{N_{2}}} + x_{\\mathrm{Ar}}\\alpha_{\\mathrm{Ar}} = (0.70)(1.0) + (0.30)(0.2) = 0.70 + 0.06 = 0.76$$\n\n对于混合物2 ($x_{\\mathrm{Ar}}=0.95, x_{\\mathrm{H_{2}O}}=0.05$)：\n第三体效率为 $\\alpha_{\\mathrm{Ar}}=0.2$ 和 $\\alpha_{\\mathrm{H_{2}O}}=6.0$。\n$$\\alpha_{\\text{mix,2}} = x_{\\mathrm{Ar}}\\alpha_{\\mathrm{Ar}} + x_{\\mathrm{H_{2}O}}\\alpha_{\\mathrm{H_{2}O}} = (0.95)(0.2) + (0.05)(6.0) = 0.19 + 0.30 = 0.49$$\n\n给定 $p_1 = 1.30\\,\\text{bar}$。我们现在可以求解 $p_2$：\n$$p_2 = p_1 \\frac{\\alpha_{\\text{mix,1}}}{\\alpha_{\\text{mix,2}}}$$\n$$p_2 = (1.30\\,\\text{bar}) \\frac{0.76}{0.49} = (1.30\\,\\text{bar}) \\times 1.55102... \\approx 2.0163265...\\,\\text{bar}$$\n按要求四舍五入到四位有效数字，我们得到混合物2的最终压力。\n$$p_2 = 2.016\\,\\text{bar}$$\n这个结果是合乎逻辑的：混合物2的平均碰撞效率（$\\alpha_{\\text{mix,2}} = 0.49$）低于混合物1（$\\alpha_{\\text{mix,1}} = 0.76$）。因此，混合物2需要更高的总压才能达到相同的有效碰撞物浓度，从而在压力衰减区处于相同的位置。", "answer": "$$\n\\boxed{2.016}\n$$", "id": "2665130"}, {"introduction": "为了更精确地描述单分子反应，我们需要超越经典的林德曼模型，转向基于统计力学的RRK和RRKM理论。一个精确的坠落曲线预测取决于两个核心要素：微正则速率常数$k(E)$的能量依赖性，以及碰撞能量转移模型。本练习将聚焦于第一个要素，通过一个假设的分子模型，指导您从第一性原理推导并比较经典RRK理论和更严格的RRKM理论下的高压极限速率常数$k_{\\infty}$。通过这个编码实践，您将定量地理解量子态密度和角动量守恒等物理因素如何从根本上影响速率常数的计算，并最终影响坠落曲线的位置。[@problem_id:2665127]", "problem": "你需要编写一个完整且可运行的程序，比较 Rice–Ramsperger–Kassel (RRK) 模型和 Rice–Ramsperger–Kassel–Marcus (RRKM) 模型对单分子反应衰减中心位置的预测。该程序针对一个假设分子，其具有 $s=8$ 个振动模式和阈值能量 $E_0$，满足 $E_0/k_{\\mathrm{B}}=5000\\,\\mathrm{K}$。衰减中心定义为约化压力 $p_r$ 满足 $p_r \\approx 1$ 的状态，其中 $p_r$ 是比率 $p_r = k_0(T)[\\mathrm{M}]/k_{\\infty}(T)$。衰减中心对应的数密度为 $[\\mathrm{M}]_{\\mathrm{c}} = k_{\\infty}(T)/k_0(T)$，中心的物理压力为 $P_{\\mathrm{c}}(T) = k_{\\mathrm{B}} T\\,[\\mathrm{M}]_{\\mathrm{c}}$。你的任务是计算并比较 RRK 和 RRKM 模型预测的这些中心压力。\n\n你的推导应仅基于以下基本原理和定义：\n- 理想气体定律的数密度形式 $P = k_{\\mathrm{B}} T [\\mathrm{M}]$。\n- 谐振子的正则统计力学，包括玻尔兹曼分布和振动配分函数。\n- 低压极限速率常数 $k_0(T)$ 在强碰撞极限下的定义，即它与正则内能分布中能量高于阈值 $E_0$ 的部分成正比。\n- 能量为 $E$ 时的单分子速率的微正则 RRK 表达式，以及 RRKM 的正则高压极限与过渡态理论的等价性。\n\n不要假设或引用 $k_0(T)$ 或 $k_{\\infty}(T)$ 的最终目标公式；从上述基础出发推导它们。\n\n在所有计算中应一致使用的模型规格：\n- 反应物有 $s=8$ 个振动模式；过渡态有 $s-1=7$ 个振动模式（一个模式成为反应坐标）。\n- 振动波数（单位为 $\\mathrm{cm}^{-1}$）如下：\n  - 反应物：$[400,\\,500,\\,700,\\,900,\\,1100,\\,1300,\\,1500,\\,1700]$。\n  - 过渡态：$[400,\\,500,\\,700,\\,900,\\,1100,\\,1300,\\,1500]$。\n- 使用 $E_0/k_{\\mathrm{B}} = 5000\\,\\mathrm{K}$，因此 $E_0 = 5000\\,k_{\\mathrm{B}}$（单位为焦耳）。\n- 对于低压极限，使用强碰撞近似，其中与温度无关的双分子碰撞速率常数为 $Z_{\\mathrm{coll}} = 4.0\\times 10^{-17}\\,\\mathrm{m^3\\,s^{-1}}$（基于数量的单位），因此 $k_0(T)$ 是 $Z_{\\mathrm{coll}}$ 与 $s$ 个谐振子内能高于 $E_0$ 的正则分数部分的乘积。\n- 对于 RRK 模型，微正则速率为 $k_{\\mathrm{RRK}}(E) = \\nu\\,\\left(1 - \\frac{E_0}{E}\\right)^{s-1}$（当 $E \\ge E_0$ 时），否则 $k_{\\mathrm{RRK}}(E)=0$，其中 $\\nu$ 是一个可调的频率参数，单位为 $\\mathrm{s}^{-1}$。正则高压极限 $k_{\\infty}^{\\mathrm{RRK}}(T)$ 是 $k_{\\mathrm{RRK}}(E)$ 在反应物正则系综上的玻尔兹曼平均值。\n- 对于 RRKM 模型，使用正则过渡态理论表达式计算高压极限 $k_{\\infty}^{\\mathrm{RRKM}}(T)$，该表达式用反应物和过渡态的振动配分函数以及 $E_0$ 的玻尔兹曼因子表示。\n\n对于每个测试用例的温度 $T$ 和 RRK 频率参数 $\\nu$，需要完成的计算任务：\n1. 推导并实现强碰撞极限下 $s=8$ 个模式的 $k_0(T)$，使用 $s$ 个谐振子的正则内能分布；仅用 $T$、$s$ 和 $E_0$ 表示，并进行数值计算。\n2. 通过对基于 $s$ 个谐振子经典态密度的正则分布上的微正则 RRK 速率 $k_{\\mathrm{RRK}}(E)$ 进行正则平均，推导并实现 $k_{\\infty}^{\\mathrm{RRK}}(T)$。\n3. 通过正则过渡态理论，使用给定的振动模式集、量子谐振子配分函数以及包含 $E_0$ 的玻尔兹曼因子，推导并实现 $k_{\\infty}^{\\mathrm{RRKM}}(T)$。\n4. 计算 RRK 和 RRKM 的衰减中心压力（单位为帕斯卡），$P_{\\mathrm{c}}^{\\mathrm{RRK}}(T) = k_{\\mathrm{B}} T\\,k_{\\infty}^{\\mathrm{RRK}}(T)/k_0(T)$ 和 $P_{\\mathrm{c}}^{\\mathrm{RRKM}}(T) = k_{\\mathrm{B}} T\\,k_{\\infty}^{\\mathrm{RRKM}}(T)/k_0(T)$。所有压力均以 $\\mathrm{Pa}$ 表示。\n5. 对于每个测试用例，报告无量纲比率 $R(T,\\nu) = P_{\\mathrm{c}}^{\\mathrm{RRK}}(T)/P_{\\mathrm{c}}^{\\mathrm{RRKM}}(T)$，结果为浮点数。最终程序输出必须是单行，包含一个用逗号分隔的 Python 列表，其中包含按下面测试套件顺序排列的这些比率。\n\n要使用的物理常数：\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 普朗克常数 $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 振动波数到特征温度 $\\theta$ 的转换：$\\theta = (hc/k_{\\mathrm{B}})\\,\\tilde{\\nu}$，其中 $hc/k_{\\mathrm{B}} = 1.438776877\\,\\mathrm{K\\,cm}$，$\\tilde{\\nu}$ 的单位为 $\\mathrm{cm}^{-1}$。\n\n测试套件：\n- 用例 1：$T=300\\,\\mathrm{K}$，$\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$。\n- 用例 2：$T=600\\,\\mathrm{K}$，$\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$。\n- 用例 3：$T=1000\\,\\mathrm{K}$，$\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$。\n- 用例 4：$T=300\\,\\mathrm{K}$，$\\nu = 5.0\\times 10^{12}\\,\\mathrm{s^{-1}}$。\n- 用例 5：$T=200\\,\\mathrm{K}$，$\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$。\n\n最终输出格式：\n- 你的程序应产生单行输出，包含比率 $[R_1,R_2,R_3,R_4,R_5]$，形式为一个用逗号分隔并用方括号括起来的列表，顺序与测试套件相同。每个 $R_i$ 都必须是一个浮点数。打印输出中不应出现任何单位。", "solution": "所述问题在科学上是合理的、适定的，并包含了唯一解所需的所有信息。这是化学动力学和统计力学中的一个有效练习。我们将按要求进行推导。\n\n目标是计算 Rice-Ramsperger-Kassel (RRK) 和 Rice-Ramsperger-Kassel-Marcus (RRKM) 模型预测的衰减中心压力之比 $R(T, \\nu) = P_{\\mathrm{c}}^{\\mathrm{RRK}}(T)/P_{\\mathrm{c}}^{\\mathrm{RRKM}}(T)$。中心压力定义为 $P_{\\mathrm{c}}(T) = k_{\\mathrm{B}} T [\\mathrm{M}]_{\\mathrm{c}}$，其中 $[\\mathrm{M}]_{\\mathrm{c}} = k_{\\infty}(T)/k_0(T)$ 是单分子速率为其高压值一半时的碰撞伙伴浓度。这给出 $P_{\\mathrm{c}}(T) = k_{\\mathrm{B}} T k_{\\infty}(T)/k_0(T)$。因此，所要求的比率等价于高压速率常数之比：\n$$\nR(T, \\nu) = \\frac{P_{\\mathrm{c}}^{\\mathrm{RRK}}(T)}{P_{\\mathrm{c}}^{\\mathrm{RRKM}}(T)} = \\frac{k_{\\mathrm{B}} T k_{\\infty}^{\\mathrm{RRK}}(T)/k_0(T)}{k_{\\mathrm{B}} T k_{\\infty}^{\\mathrm{RRKM}}(T)/k_0(T)} = \\frac{k_{\\infty}^{\\mathrm{RRK}}(T)}{k_{\\infty}^{\\mathrm{RRKM}}(T)}\n$$\n尽管低压极限速率常数 $k_0(T)$ 在最终比率中被消去，但仍需对所有组分进行严谨的推导，以证明对基本原理的完全理解。\n\n该分子有 $s=8$ 个振动模式。阈值能量给定为 $E_0/k_{\\mathrm{B}} = 5000\\,\\mathrm{K}$。\n\n低压极限速率常数 $k_0(T)$ 的推导\n\n在强碰撞极限下，低压速率常数 $k_0(T)$ 是双分子碰撞速率常数 $Z_{\\mathrm{coll}}$ 与内能超过阈值 $E_0$ 的分子分数之积。我们被要求将反应物建模为 $s$ 个经典谐振子的集合。\n$$\nk_0(T) = Z_{\\mathrm{coll}} \\int_{E_0}^{\\infty} P(E) dE\n$$\n温度为 $T$ 时 $s$ 个经典谐振子的正则能量分布 $P(E)$ 由伽马分布给出：\n$$\nP(E) = \\frac{1}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} E^{s-1} e^{-E/(k_{\\mathrm{B}}T)}\n$$\n其中对于整数 $s$，$\\Gamma(s) = (s-1)!$。活化分子分数的积分为：\n$$\n\\int_{E_0}^{\\infty} \\frac{E^{s-1} e^{-E/(k_{\\mathrm{B}}T)}}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} dE\n$$\n我们进行变量替换，令 $x = E/(k_{\\mathrm{B}}T)$，则 $dE = k_{\\mathrm{B}}T dx$。积分下限变为 $x_0 = E_0/(k_{\\mathrm{B}}T)$。\n$$\n\\text{Fraction}(E  E_0) = \\int_{x_0}^{\\infty} \\frac{(x k_{\\mathrm{B}}T)^{s-1} e^{-x}}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} (k_{\\mathrm{B}}T dx) = \\frac{1}{\\Gamma(s)} \\int_{x_0}^{\\infty} x^{s-1} e^{-x} dx\n$$\n这个积分定义了上不完全伽马函数 $\\Gamma(s, x_0)$。因此，该分数为正则化上不完全伽马函数 $Q(s, x_0) = \\Gamma(s, x_0) / \\Gamma(s)$。\n所以，低压速率常数为：\n$$\nk_0(T) = Z_{\\mathrm{coll}} Q\\left(s, \\frac{E_0}{k_{\\mathrm{B}}T}\\right)\n$$\n根据给定参数，$s=8$ 且 $Z_{\\mathrm{coll}} = 4.0\\times 10^{-17}\\,\\mathrm{m^3\\,s^{-1}}$。\n\n高压极限速率常数 $k_{\\infty}(T)$ 的推导\n\n我们必须推导 RRK 和 RRKM 模型的表达式。\n\nRRK 模型 ($k_{\\infty}^{\\mathrm{RRK}}(T)$)\n\nRRK 模型为能量为 $E$ 的分子提供了一个微正则速率常数 $k_{\\mathrm{RRK}}(E)$：\n$$\nk_{\\mathrm{RRK}}(E) = \\nu \\left(1 - \\frac{E_0}{E}\\right)^{s-1} \\quad \\text{for } E \\ge E_0\n$$\n高压速率常数 $k_{\\infty}^{\\mathrm{RRK}}(T)$ 是 $k_{\\mathrm{RRK}}(E)$ 在分布 $P(E)$ 上的正则平均：\n$$\nk_{\\infty}^{\\mathrm{RRK}}(T) = \\int_{E_0}^{\\infty} k_{\\mathrm{RRK}}(E) P(E) dE = \\int_{E_0}^{\\infty} \\nu \\left(\\frac{E-E_0}{E}\\right)^{s-1} \\frac{E^{s-1} e^{-E/(k_{\\mathrm{B}}T)}}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} dE\n$$\n$$\nk_{\\infty}^{\\mathrm{RRK}}(T) = \\frac{\\nu}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} \\int_{E_0}^{\\infty} (E-E_0)^{s-1} e^{-E/(k_{\\mathrm{B}}T)} dE\n$$\n令 $u = E - E_0$，则 $E = u + E_0$ 且 $dE=du$。下限变为 $u=0$。\n$$\nk_{\\infty}^{\\mathrm{RRK}}(T) = \\frac{\\nu e^{-E_0/(k_{\\mathrm{B}}T)}}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} \\int_{0}^{\\infty} u^{s-1} e^{-u/(k_{\\mathrm{B}}T)} du\n$$\n剩余的积分为 $\\Gamma(s)(k_{\\mathrm{B}}T)^s$。代入此结果可得：\n$$\nk_{\\infty}^{\\mathrm{RRK}}(T) = \\frac{\\nu e^{-E_0/(k_{\\mathrm{B}}T)}}{\\Gamma(s) (k_{\\mathrm{B}}T)^s} \\Gamma(s)(k_{\\mathrm{B}}T)^s = \\nu e^{-E_0/(k_{\\mathrm{B}}T)}\n$$\n这是一个标准结果，已由我们的推导证实。\n\nRRKM 模型 ($k_{\\infty}^{\\mathrm{RRKM}}(T)$)\n\nRRKM 高压速率常数由正则过渡态理论 (TST) 给出：\n$$\nk_{\\infty}^{\\mathrm{RRKM}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\frac{Q^{\\ddagger}(T)}{Q(T)} e^{-E_0/(k_{\\mathrm{B}}T)}\n$$\n这里，$Q(T)$ 和 $Q^{\\ddagger}(T)$ 分别是反应物和过渡态的配分函数，按规定，仅包含振动模式的贡献。我们使用量子谐振子模型计算单个振动模式 $i$（波数为 $\\tilde{\\nu}_i$）的配分函数：\n$$\nq_i(T) = \\left(1 - e^{-h c \\tilde{\\nu}_i / (k_{\\mathrm{B}}T)}\\right)^{-1} = \\left(1 - e^{-\\theta_i/T}\\right)^{-1}\n$$\n其中 $\\theta_i = (hc/k_{\\mathrm{B}})\\tilde{\\nu}_i$ 是特征振动温度。总振动配分函数是所有模式的乘积。\n反应物有 $s=8$ 个模式，波数为 $\\tilde{\\nu}_{1}, \\dots, \\tilde{\\nu}_{8}$。其配分函数为 $Q(T) = \\prod_{i=1}^{8} q_i(T)$。\n过渡态有 $s-1=7$ 个模式。问题指出其波数为 $\\tilde{\\nu}_{1}, \\dots, \\tilde{\\nu}_{7}$，与反应物的前 7 个模式相同。波数为 $\\tilde{\\nu}_{8} = 1700\\,\\mathrm{cm^{-1}}$ 的模式是反应坐标，并从过渡态的配分函数中移除。\n因此，$Q^{\\ddagger}(T) = \\prod_{i=1}^{7} q_i(T)$。配分函数之比显著简化：\n$$\n\\frac{Q^{\\ddagger}(T)}{Q(T)} = \\frac{\\prod_{i=1}^{7} q_i(T)}{\\prod_{i=1}^{8} q_i(T)} = \\frac{1}{q_8(T)} = 1 - e^{-h c \\tilde{\\nu}_8 / (k_{\\mathrm{B}}T)} = 1 - e^{-\\theta_8/T}\n$$\n将此代入 TST 表达式得到：\n$$\nk_{\\infty}^{\\mathrm{RRKM}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\left(1 - e^{-\\theta_8/T}\\right) e^{-E_0/(k_{\\mathrm{B}}T)}\n$$\n其中 $\\theta_8$ 对应于波数为 $\\tilde{\\nu}_8 = 1700\\,\\mathrm{cm^{-1}}$ 的模式。\n\n衰减中心压力比 $R(T, \\nu)$ 的计算\n\n现在我们使用推导出的高压速率常数来计算比率 $R(T, \\nu)$。\n$$\nR(T, \\nu) = \\frac{k_{\\infty}^{\\mathrm{RRK}}(T)}{k_{\\infty}^{\\mathrm{RRKM}}(T)} = \\frac{\\nu e^{-E_0/(k_{\\mathrm{B}}T)}}{\\frac{k_{\\mathrm{B}}T}{h} \\left(1 - e^{-\\theta_8/T}\\right) e^{-E_0/(k_{\\mathrm{B}}T)}}\n$$\n玻尔兹曼因子 $e^{-E_0/(k_{\\mathrm{B}}T)}$ 被消去，表达式简化为：\n$$\nR(T, \\nu) = \\frac{\\nu h}{k_{\\mathrm{B}}T \\left(1 - e^{-\\theta_8/T}\\right)}\n$$\n其中 $\\theta_8/T = (hc/k_{\\mathrm{B}})\\tilde{\\nu}_8/T$。这个最终表达式仅取决于温度 $T$、RRK 频率参数 $\\nu$ 以及成为反应坐标的最高频率模式的性质。系统的所有其他参数，包括 $s$、$E_0$ 和 $Z_{\\mathrm{coll}}$，都不出现在这个特定比率中，这是所选模型的直接结果。这就是我们将为所需计算实现的公式。\n\n用于计算的最终表达式\n\n使用提供的物理常数：\n$h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$\n$k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$hc/k_{\\mathrm{B}} = 1.438776877\\,\\mathrm{K\\,cm}$\n$\\tilde{\\nu}_8 = 1700\\,\\mathrm{cm^{-1}}$\n\n对于每个测试用例 $(T, \\nu)$ 要计算的无量纲比率为：\n$$\nR(T, \\nu) = \\frac{\\nu \\cdot (6.62607015\\times 10^{-34})}{(1.380649\\times 10^{-23}) \\cdot T \\cdot \\left(1 - \\exp\\left(-\\frac{1.438776877 \\cdot 1700}{T}\\right)\\right)}\n$$\n我们现在将进行数值实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of fall-off center pressures predicted by RRK and RRKM models\n    for a set of test cases.\n    \"\"\"\n\n    # Physical constants as specified in the problem statement.\n    # Boltzmann constant in J/K\n    k_B = 1.380649e-23\n    # Planck constant in J*s\n    h = 6.62607015e-34\n    # Conversion factor hc/k_B in K*cm\n    hc_over_k_B = 1.438776877\n\n    # Model parameters\n    # Wavenumber of the mode that becomes the reaction coordinate in cm^-1\n    nu_tilde_8 = 1700.0\n    \n    # Test suite: (Temperature in K, RRK frequency parameter nu in s^-1)\n    test_cases = [\n        (300.0, 1.0e13),\n        (600.0, 1.0e13),\n        (1000.0, 1.0e13),\n        (300.0, 5.0e12),\n        (200.0, 1.0e13),\n    ]\n\n    results = []\n    \n    # The derived ratio R(T, nu) is given by:\n    # R = (nu * h) / (k_B * T * (1 - exp(-(hc/k_B * nu_tilde_8) / T)))\n    # This simplifies to: R = (nu * (h/k_B)) / (T * (1 - exp(-(hc_over_k_B * nu_tilde_8) / T)))\n    h_over_k_B = h / k_B\n    theta_8 = hc_over_k_B * nu_tilde_8\n    \n    for T, nu in test_cases:\n        # T: Temperature in Kelvin\n        # nu: RRK frequency parameter in s^-1\n        \n        # Denominator term\n        # The argument of exp is dimensionless\n        exp_arg = -theta_8 / T\n        \n        # Ensure the argument to exp is not so large that it underflows to zero,\n        # which would cause a division by zero if (1 - exp(...)) is in the denominator.\n        # However, for the given temperatures, T is positive, exp_arg is negative,\n        # so exp(exp_arg) is between 0 and 1. The denominator is safe.\n        denominator_factor = 1.0 - np.exp(exp_arg)\n        \n        # Calculate the ratio R\n        numerator = nu * h_over_k_B\n        denominator = T * denominator_factor\n        \n        R = numerator / denominator\n        results.append(R)\n\n    # Final print statement in the exact required format.\n    # The output is a list of floating-point numbers.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2665127"}, {"introduction": "在精确预测坠落行为的第二个关键要素是碰撞能量转移模型。许多简化理论采用“强碰撞”假设，即单次碰撞足以使活化分子完全失活，但这在物理上往往过于理想化。这项高级计算实践将让您亲手构建一个完整的能量分级主方程模型，这是现代化学动力学研究的核心工具。您将通过编写代码，直接对比理想化的强碰撞模型与更接近物理现实的指数下降模型所预测的有效速率常数，从而深入理解能量转移的具体机制是如何决定坠落曲线的形状和宽度。[@problem_id:2665109]", "problem": "要求您实现对用于描述单分子反应中压力依赖性和降压行为的两种碰撞能量转移模型的定量比较，通过计算和对比在指定微正则速率 $k(E)$ 下，每个模型预测的有效一级速率系数 $k_{\\text{eff}}(T,p)$。这两种模型是：(i) 强碰撞模型，其中每次碰撞都瞬时将高能分子重新热化至正则分布；(ii) 单指数下降（SED）模型（single-exponential-down，也称为 exponential-down），其中每次碰撞向下传递的能量遵循指数分布，而向上的跃迁由细致平衡强制执行。您必须实现一个能量粒化主方程，并提取 $k_{\\text{eff}}(T,p)$，其值为束缚态布居动力学生成元的主导实部特征值的负数。然后，对于每个测试用例，您必须输出比率 $k_{\\text{eff}}^{\\text{SC}}(T,p) / k_{\\text{eff}}^{\\text{SED}}(T,p)$ 的自然对数，其中上标分别表示强碰撞和单指数下降。\n\n使用的基础和定义：\n- 理想气体定律用于数密度 $n$：$n = p / (k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$p$ 是压力。\n- 每个分子的硬球碰撞频率 $Z_{\\text{coll}}$：$Z_{\\text{coll}}(T,p) = n \\,\\sigma \\,\\bar v$，其中平均相对速度 $\\bar v = \\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi \\mu}}$，$\\sigma$ 是碰撞截面，$\\mu$ 是折合质量。\n- 在离散化能量网格 $\\{E_i\\}$ 上的正则（玻尔兹曼）能量分布：$\\pi_i \\propto \\exp\\!\\left(-\\frac{E_i}{k_{\\mathrm{B}} T}\\right)$，归一化为 $\\sum_i \\pi_i = 1$。\n- 能量粒上的布居向量 $\\mathbf{p}(t)$ 的能量粒化主方程：\n  $$\\frac{d\\mathbf{p}}{dt} = \\left[ Z_{\\text{coll}}(T,p)\\,\\left(\\mathbf{P} - \\mathbf{I}\\right) - \\mathbf{K} \\right] \\mathbf{p},$$\n  其中 $\\mathbf{P}$ 是一个列随机矩阵，编码了能量粒之间的每次碰撞跃迁概率（碰撞核），$\\mathbf{I}$ 是单位矩阵，$\\mathbf{K}$ 是对角矩阵，其元素为 $K_{ii} = k(E_i)$。宏观有效一级速率常数是存活布居的长时间衰变率，由下式给出\n  $$k_{\\text{eff}}(T,p) = -\\max\\left\\{\\Re(\\lambda): \\lambda \\in \\text{eig}\\left[Z_{\\text{coll}}(T,p)\\,(\\mathbf{P}-\\mathbf{I}) - \\mathbf{K}\\right]\\right\\}.$$\n- 微正则速率模型（物理上由简化的 Rice–Ramsperger–Kassel–Marcus 风格标度关系驱动）：对于 $E \\ge E_0$，$k(E) = k_\\infty \\left(1 - \\frac{E_0}{E}\\right)^m$，对于 $E  E_0$，$k(E) = 0$，其中 $m$ 是一个控制速率在阈值以上如何上升的正整数，$k_\\infty$ 是高能极限。\n- 碰撞核：\n  1. 强碰撞模型：$\\mathbf{P}^{\\text{SC}}$ 的所有列都相同，等于正则分布 $\\boldsymbol{\\pi}$，即对于所有 $i$，$P^{\\text{SC}}_{j i} = \\pi_j$。\n  2. 单指数下降模型：设特征下降步长能量为 $\\langle\\Delta E_{\\text{down}}\\rangle(T) = \\langle\\Delta E_{\\text{down}}\\rangle_0 \\left(\\frac{T}{T_0}\\right)^{n_d}$，其中 $T_0$ 为参考温度，$n_d$ 为指数，$\\langle\\Delta E_{\\text{down}}\\rangle_0$ 为常数。定义一个对称提议核 $S_{j i} = \\exp\\!\\left(-\\frac{|E_j-E_i|}{\\langle\\Delta E_{\\text{down}}\\rangle(T)}\\right)$，并通过 Metropolis–Hastings 构建方法对 $\\boldsymbol{\\pi}$ 施加细致平衡：\n     $$W_{j i} = \\begin{cases}\n     S_{j i}\\,\\min\\!\\left(1, \\frac{\\pi_j}{\\pi_i}\\right),  j \\ne i,\\\\\n     1,  j = i,\n     \\end{cases} \\quad \\text{和} \\quad P^{\\text{SED}}_{j i} = \\frac{W_{j i}}{\\sum_k W_{k i}}.$$\n  这样可以得到一个列随机的 $\\mathbf{P}^{\\text{SED}}$，其平均具有指数下降步长并满足精确的细致平衡。\n\n实现要求：\n- 使用一个包含 $N$ 个粒的等间距能量网格，范围从 $E_{\\min} = 0$ 到 $E_{\\max} = E_0 + \\alpha\\, k_{\\mathrm{B}} T$，其中 $N = 180$ 且 $\\alpha = 60$。计算中所有能量必须是以焦耳为单位的单个分子的能量。使用区间中心作为 $E_i$。\n- 使用的常数：\n  - 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n  - 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n  - 折合质量 $\\mu = 2.50\\times 10^{-26}\\,\\mathrm{kg}$。\n  - 硬球碰撞截面 $\\sigma = 5.00\\times 10^{-19}\\,\\mathrm{m^2}$。\n  - 每摩尔阈值能量 $E_{0,\\mathrm{mol}} = 8.00\\times 10^{4}\\,\\mathrm{J/mol}$，因此每个分子能量 $E_0 = E_{0,\\mathrm{mol}}/N_{\\mathrm{A}}$（单位：焦耳）。\n  - 微正则高能极限 $k_\\infty = 1.00\\times 10^{12}\\,\\mathrm{s^{-1}}$。\n  - 微正则形状指数 $m = 2$。\n  - SED 参考温度 $T_0 = 300\\,\\mathrm{K}$，下降步长参数 $\\langle\\Delta E_{\\text{down}}\\rangle_0 = 200\\,\\mathrm{cm^{-1}}$（使用 $1\\,\\mathrm{cm^{-1}} = 1.98644586\\times 10^{-23}\\,\\mathrm{J}$ 表达的单个分子的能量），和指数 $n_d = 0.85$。\n- 对于每个测试用例 $(T,p)$，计算 $k_{\\text{eff}}^{\\text{SC}}(T,p)$ 和 $k_{\\text{eff}}^{\\text{SED}}(T,p)$（单位为 $\\mathrm{s^{-1}}$），然后返回无量纲量\n  $$\\Delta(T,p) = \\ln\\!\\left(\\frac{k_{\\text{eff}}^{\\text{SC}}(T,p)}{k_{\\text{eff}}^{\\text{SED}}(T,p)}\\right).$$\n\n数值与算法说明：\n- 构建生成元 $\\mathbf{L} = Z_{\\text{coll}}(T,p)\\,(\\mathbf{P}-\\mathbf{I}) - \\mathbf{K}$ 并计算其特征值。有效速率 $k_{\\text{eff}}$ 是具有最大实部的特征值的负数。使用适用于实非对称矩阵的稠密特征值求解器。\n- 通过显式归一化，确保 $\\mathbf{P}$ 的所有列随机性质在数值上得到满足。\n- 通过使用指定的 $N$ 和 $E_{\\max}$，并谨慎计算玻尔兹曼因子，确保数值稳定性。\n\n测试套件与输出规范：\n- 使用以下五个测试用例 $(T,p)$，其中 $T$ 的单位是开尔文，_p_ 的单位是帕斯卡：\n  1. $(T,p) = (600\\,\\mathrm{K}, 100\\,\\mathrm{Pa})$，\n  2. $(T,p) = (600\\,\\mathrm{K}, 1.0\\times 10^{5}\\,\\mathrm{Pa})$，\n  3. $(T,p) = (1000\\,\\mathrm{K}, 1.0\\times 10^{4}\\,\\mathrm{Pa})$，\n  4. $(T,p) = (1000\\,\\mathrm{K}, 1.0\\times 10^{5}\\,\\mathrm{Pa})$，\n  5. $(T,p) = (1200\\,\\mathrm{K}, 5.0\\times 10^{4}\\,\\mathrm{Pa})$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表项与测试用例顺序相同，每一项是 $\\Delta(T,p)$ 的十进制表示（无量纲）。仅为格式示例：$[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4,\\Delta_5]$。", "solution": "该问题要求在单分子反应的背景下，对碰撞能量转移的强碰撞（SC）模型和单指数下降（SED）模型进行定量比较。目标是为一组给定的温度 $T$ 和压力 $p$ 计算有效一级速率常数 $k_{\\text{eff}}(T,p)$，然后确定这些速率常数之比的自然对数 $\\Delta(T,p) = \\ln(k_{\\text{eff}}^{\\text{SC}} / k_{\\text{eff}}^{\\text{SED}})$。\n\n该分析的基础是能量粒化主方程，它描述了布居向量 $\\mathbf{p}(t)$ 在内部能量态 $\\{E_i\\}_{i=1}^N$ 的离散网格上的时间演化。控制该过程的微分方程是：\n$$ \\frac{d\\mathbf{p}}{dt} = \\mathbf{L} \\mathbf{p} = \\left[ Z_{\\text{coll}}(T,p)\\,(\\mathbf{P} - \\mathbf{I}) - \\mathbf{K} \\right] \\mathbf{p}(t) $$\n此处，$\\mathbf{L}$ 是弛豫-反应矩阵，或称生成元。系统的长时间行为由 $\\mathbf{L}$ 的具有最大实部的特征值主导。有效速率常数 $k_{\\text{eff}}$ 是该主导特征值的负数：\n$$ k_{\\text{eff}}(T,p) = -\\max\\left\\{\\Re(\\lambda): \\lambda \\in \\text{eig}(\\mathbf{L})\\right\\} $$\n生成元 $\\mathbf{L}$ 由三个不同部分组成：碰撞频率 $Z_{\\text{coll}}(T,p)$、每次碰撞的跃迁概率矩阵 $\\mathbf{P}$ 以及微正则反应速率的对角矩阵 $\\mathbf{K}$。\n\n为每个给定的 $(T,p)$ 对计算 $\\Delta(T,p)$ 的分步过程如下：\n\n1.  **定义系统常数和能量网格：**\n    首先，所有物理常数都用国际单位制（SI单位）定义。阈值能量 $E_0$ 使用阿伏伽德罗常数 $N_{\\mathrm{A}}$ 从摩尔量 ($E_{0,\\mathrm{mol}}$) 转换为分子量：$E_0 = E_{0,\\mathrm{mol}} / N_{\\mathrm{A}}$。参考下降步长能量 $\\langle\\Delta E_{\\text{down}}\\rangle_0$ 从波数（$\\mathrm{cm^{-1}}$）转换为焦耳。\n    构建一个包含 $N=180$ 个点的等间距能量网格。网格范围从 $E_{\\min}=0$ 到 $E_{\\max} = E_0 + \\alpha k_{\\mathrm{B}} T$，其中 $\\alpha=60$。第 $i$ 个粒的能量 $E_i$ 取为能量区间的中心。能量步长为 $\\Delta E = E_{\\max}/N$，网格点为 $E_i = (i + 0.5)\\Delta E$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n\n2.  **为给定的 $(T,p)$ 计算与状态无关的量：**\n    对于每对温度 $T$ 和压力 $p$，我们计算仅依赖于这些宏观条件的量。\n    - 数密度 $n$ 根据理想气体定律计算：$n = p / (k_{\\mathrm{B}} T)$。\n    - 硬球碰撞的平均相对速度 $\\bar{v}$ 由 $\\bar{v} = \\sqrt{8 k_{\\mathrm{B}} T / (\\pi \\mu)}$ 给出，其中 $\\mu$ 是折合质量。\n    - 每个分子的总碰撞频率为 $Z_{\\text{coll}}(T,p) = n\\,\\sigma\\,\\bar{v}$，其中 $\\sigma$ 是碰撞截面。\n\n3.  **构建与状态相关的矩阵：**\n    - **正则分布 $\\boldsymbol{\\pi}$：** 在能量网格上计算平衡玻尔兹曼布居向量 $\\boldsymbol{\\pi}$。其元素为 $\\pi_i \\propto \\exp(-E_i / (k_{\\mathrm{B}} T))$。然后将该向量归一化，使得 $\\sum_i \\pi_i = 1$。\n    - **微正则速率矩阵 $\\mathbf{K}$：** 这是一个对角矩阵，其元素为 $K_{ii} = k(E_i)$。微正则速率 $k(E)$ 由以下模型给出：\n      $$ k(E_i) = \\begin{cases} k_\\infty \\left(1 - \\frac{E_0}{E_i}\\right)^m,  \\text{if } E_i \\ge E_0 \\\\ 0,  \\text{if } E_i  E_0 \\end{cases} $$\n      其中 $k_\\infty$ 是高压速率常数，$m=2$ 是一个形状指数。\n\n4.  **为强碰撞模型计算 $k_{\\text{eff}}^{\\text{SC}}$：**\n    - **跃迁矩阵 $\\mathbf{P}^{\\text{SC}}$：** 在强碰撞近似中，假定单次碰撞足以在碰撞分子中重新建立能量的玻尔兹曼分布。因此，跃迁矩阵 $\\mathbf{P}^{\\text{SC}}$ 的所有列都相同，每一列都是正则分布向量 $\\boldsymbol{\\pi}$。即，对于所有初始态 $i$，$P^{\\text{SC}}_{ji} = \\pi_j$。\n    - **生成矩阵 $\\mathbf{L}^{\\text{SC}}$：** SC 模型的生成元构建为 $\\mathbf{L}^{\\text{SC}} = Z_{\\text{coll}}(T,p)(\\mathbf{P}^{\\text{SC}} - \\mathbf{I}) - \\mathbf{K}$，其中 $\\mathbf{I}$ 是单位矩阵。\n    - **特征值计算：** 计算实非对称矩阵 $\\mathbf{L}^{\\text{SC}}$ 的特征值。有效速率常数通过 $k_{\\text{eff}}^{\\text{SC}}(T,p) = -\\max(\\Re(\\text{eig}(\\mathbf{L}^{\\text{SC}})))$ 求得。\n\n5.  **为单指数下降模型计算 $k_{\\text{eff}}^{\\text{SED}}$：**\n    - **特征能量转移 $\\langle\\Delta E_{\\text{down}}\\rangle$：** 在一次失活碰撞中传递的平均能量随温度变化，关系为 $\\langle\\Delta E_{\\text{down}}\\rangle(T) = \\langle\\Delta E_{\\text{down}}\\rangle_0 (T/T_0)^{n_d}$。\n    - **跃迁矩阵 $\\mathbf{P}^{\\text{SED}}$：** SED 核更为复杂。它的构建是为了满足细致平衡。\n        i. 定义一个对称提议核 $\\mathbf{S}$，其元素为 $S_{ji} = \\exp(-|E_j - E_i| / \\langle\\Delta E_{\\text{down}}\\rangle(T))$。\n        ii. 使用 Metropolis-Hastings 准则形成一个中间矩阵 $\\mathbf{W}$，以强制对 $\\boldsymbol{\\pi}$ 满足细致平衡：对于 $j \\neq i$，$W_{ji} = S_{ji} \\min(1, \\pi_j/\\pi_i)$，对于 $j=i$，$W_{ii} = 1$。\n        iii. 最终的跃迁矩阵 $\\mathbf{P}^{\\text{SED}}$ 通过对 $\\mathbf{W}$ 的列进行归一化得到：$P^{\\text{SED}}_{ji} = W_{ji} / \\sum_k W_{ki}$。这确保了 $\\mathbf{P}^{\\text{SED}}$ 是列随机的。\n    - **生成矩阵 $\\mathbf{L}^{\\text{SED}}$：** 相应的生成元为 $\\mathbf{L}^{\\text{SED}} = Z_{\\text{coll}}(T,p)(\\mathbf{P}^{\\text{SED}} - \\mathbf{I}) - \\mathbf{K}$。\n    - **特征值计算：** 与 SC 模型类似，计算 $\\mathbf{L}^{\\text{SED}}$ 的特征值，并确定速率常数：$k_{\\text{eff}}^{\\text{SED}}(T,p) = -\\max(\\Re(\\text{eig}(\\mathbf{L}^{\\text{SED}})))$。\n\n6.  **计算最终比率：**\n    对于每个 $(T,p)$ 测试用例，计算最终所需量：\n    $$ \\Delta(T,p) = \\ln\\left(\\frac{k_{\\text{eff}}^{\\text{SC}}(T,p)}{k_{\\text{eff}}^{\\text{SED}}(T,p)}\\right) $$\n    收集所有测试用例的结果，并按指定格式呈现。整个过程使用 Python 及其 `numpy` 库进行数值实现，特别是用于生成元矩阵的特征值分解等线性代数运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants as spc\n\ndef solve():\n    \"\"\"\n    Computes and contrasts the effective first-order rate coefficients for\n    unimolecular reactions from the strong-collision and single-exponential-down models.\n    \"\"\"\n\n    # --- Problem Constants ---\n    # Physical constants from scipy for precision\n    KB_J_PER_K = spc.k  # Boltzmann constant in J/K\n    NA_PER_MOL = spc.N_A  # Avogadro constant in mol^-1\n\n    # System-specific constants\n    MU_KG = 2.50e-26  # Reduced mass in kg\n    SIGMA_M2 = 5.00e-19  # Hard-sphere cross section in m^2\n    E0_MOL_J_PER_MOL = 8.00e4  # Threshold energy in J/mol\n    KINFTY_S_MINUS_1 = 1.00e12  # High-energy limit rate constant in s^-1\n    M_EXPONENT = 2  # Microcanonical rate shape exponent\n\n    # SED model parameters\n    T0_K = 300.0  # Reference temperature in K\n    CM_MINUS_1_TO_J = 1.98644586e-23  # Conversion factor\n    DELTA_E_DOWN_0_CM = 200.0  # Reference down-step energy in cm^-1\n    ND_EXPONENT = 0.85  # Temperature dependence exponent for SED\n\n    # Numerical grid parameters\n    N_GRAINS = 180\n    ALPHA_GRID = 60.0\n\n    # Convert constants to per-molecule SI units\n    E0_J = E0_MOL_J_PER_MOL / NA_PER_MOL\n    DELTA_E_DOWN_0_J = DELTA_E_DOWN_0_CM * CM_MINUS_1_TO_J\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (600.0, 100.0),            # (T in K, p in Pa)\n        (600.0, 1.0e5),\n        (1000.0, 1.0e4),\n        (1000.0, 1.0e5),\n        (1200.0, 5.0e4),\n    ]\n\n    results = []\n    for T_k, p_pa in test_cases:\n        # --- 1. Setup Energy Grid and State-Independent Quantities ---\n        e_max = E0_J + ALPHA_GRID * KB_J_PER_K * T_k\n        # Use bin centers for the energy grid\n        e_grid_edges = np.linspace(0, e_max, N_GRAINS + 1)\n        e_grid_centers = (e_grid_edges[:-1] + e_grid_edges[1:]) / 2.0\n\n        # --- 2. Calculate Collision Frequency ---\n        number_density = p_pa / (KB_J_PER_K * T_k)\n        mean_relative_speed = np.sqrt(8.0 * KB_J_PER_K * T_k / (np.pi * MU_KG))\n        z_coll = number_density * SIGMA_M2 * mean_relative_speed\n\n        # --- 3. Construct State-Dependent Matrices ---\n        # Canonical (Boltzmann) distribution vector\n        # Stable calculation of Boltzmann factors\n        exponents = -e_grid_centers / (KB_J_PER_K * T_k)\n        pi_vec = np.exp(exponents)\n        pi_vec /= np.sum(pi_vec)\n\n        # Microcanonical rate diagonal matrix K\n        k_vec = np.zeros(N_GRAINS)\n        reactive_mask = e_grid_centers >= E0_J\n        # Avoid division by zero, although grid centers are positive\n        energies_above_threshold = e_grid_centers[reactive_mask]\n        k_vec[reactive_mask] = KINFTY_S_MINUS_1 * \\\n            (1.0 - E0_J / energies_above_threshold)**M_EXPONENT\n        K_matrix = np.diag(k_vec)\n        \n        I_matrix = np.identity(N_GRAINS)\n\n        # --- 4. Strong-Collision Model ---\n        # Transition matrix has identical columns equal to pi_vec\n        P_sc = np.tile(pi_vec.reshape(-1, 1), (1, N_GRAINS))\n        \n        # Generator matrix L\n        L_sc = z_coll * (P_sc - I_matrix) - K_matrix\n        \n        # Eigenvalue calculation\n        eigvals_sc = np.linalg.eigvals(L_sc)\n        k_eff_sc = -np.max(np.real(eigvals_sc))\n\n        # --- 5. Single-Exponential-Down Model ---\n        # Characteristic down-step energy\n        delta_e_down = DELTA_E_DOWN_0_J * (T_k / T0_K)**ND_EXPONENT\n        \n        # Metropolis-Hastings kernel construction\n        # Symmetric proposal kernel S\n        e_diff_matrix = np.abs(e_grid_centers[:, np.newaxis] - e_grid_centers)\n        S_matrix = np.exp(-e_diff_matrix / delta_e_down)\n        \n        # Intermediate matrix W\n        # Using reshape for safe broadcasting\n        pi_ratio_matrix = pi_vec.reshape(-1, 1) / pi_vec.reshape(1, -1)\n        W_matrix = S_matrix * np.minimum(1.0, pi_ratio_matrix)\n        np.fill_diagonal(W_matrix, 1.0)\n        \n        # Column-normalize W to get the stochastic matrix P_sed\n        P_sed = W_matrix / np.sum(W_matrix, axis=0)\n        \n        # Generator matrix L\n        L_sed = z_coll * (P_sed - I_matrix) - K_matrix\n\n        # Eigenvalue calculation\n        eigvals_sed = np.linalg.eigvals(L_sed)\n        k_eff_sed = -np.max(np.real(eigvals_sed))\n\n        # --- 6. Calculate Final Ratio ---\n        delta = np.log(k_eff_sc / k_eff_sed)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2665109"}]}