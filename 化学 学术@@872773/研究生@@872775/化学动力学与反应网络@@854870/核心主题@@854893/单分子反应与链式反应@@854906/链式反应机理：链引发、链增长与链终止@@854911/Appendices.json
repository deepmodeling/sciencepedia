{"hands_on_practices": [{"introduction": "本练习旨在深入探讨链式聚合反应中的一个核心问题：终止步骤的机理如何决定聚合物的宏观性质。通过对比重组终止和歧化终止这两种竞争路径，你将运用稳态近似法，从基本动力学原理出发，推导出数均聚合度（$X_n$）的表达式。这项实践将强化你从微观反应机理推导宏观可测量的能力，这是化学动力学研究中的一项基本技能。[@problem_id:2631169]", "problem": "一种乙烯基单体的本体自由基聚合通过三个机理阶段进行：引发、增长和终止。在引发阶段，初级自由基以有效体积速率 $R_i$ (摩尔/体积/时间) 生成。在增长阶段，一个活性聚合物自由基 $\\mathrm{P}_n^\\bullet$ 根据基元质量作用定律与单体 $\\mathrm{M}$ 加成，增长一个重复单元，其二级速率常数为 $k_p$。终止完全通过双分子自由基-自由基反应发生，存在两个竞争通道：复合（也称为偶合），其中两个活性自由基偶联形成一条死聚合物链，二级速率系数为 $k_{\\text{comb}}$；以及歧化，其中两个活性自由基发生氢转移，生成两条死聚合物链，二级速率系数为 $k_{\\text{disp}}$。假设在自由基动力学的时间尺度上，反应条件为等温、混合良好，单体浓度 $[M]$ 恒定，链转移可忽略不计，并且稳态近似(SSA)对于活性自由基浓度 $[\\mathrm{R}^\\bullet]$ 成立。\n\n简要说明歧化和复合在每次终止相遇产生的死聚合物分子数量方面的机理区别。然后，仅从基元质量作用动力学、稳态近似下的自由基守恒，以及数均聚合度 $X_n$（定义为每个形成的聚合物分子所包含的平均单体单元数）的定义出发，推导出一个关于 $k_p$、$[M]$、$R_i$、$k_{\\text{comb}}$ 和 $k_{\\text{disp}}$ 的 $X_n$ 的封闭形式解析表达式。你的最终答案必须是单一的解析表达式。不需要进行数值评估，也无需四舍五入。最终答案以无单位形式表示。", "solution": "所提出的问题是聚合化学动力学中一个标准的、适定的练习题。它具有科学依据，内容自洽且客观。所有必要的假设、定义和动力学参数都已提供，以推导出一个唯一的解析解。因此，该问题是有效的。\n\n任务有两部分：首先，陈述复合终止和歧化终止之间的机理区别；其次，推导数均聚合度 $X_n$ 的表达式。\n\n首先，我们来解决机理区别的问题。在自由基聚合中，终止事件消耗活性聚合物自由基，形成稳定、无反应性的“死”聚合物链。\n- **复合（或偶合）**：两个活性聚合物自由基，例如 $\\mathrm{P}_n^\\bullet$ 和 $\\mathrm{P}_m^\\bullet$，直接偶联形成一个更长的死聚合物链 $\\mathrm{P}_{n+m}$。因此，一次通过复合的终止相遇产生**一个**死聚合物分子。化学方程式为：\n$$ \\mathrm{P}_n^\\bullet + \\mathrm{P}_m^\\bullet \\xrightarrow{k_{\\text{comb}}} \\mathrm{P}_{n+m} $$\n- **歧化**：一个活性自由基从另一个活性自由基上夺取一个原子（通常是氢原子）。这导致产生两条死聚合物链：一条是饱和的，另一条带有末端双键。例如，$\\mathrm{P}_n^\\bullet$ 和 $\\mathrm{P}_m^\\bullet$ 反应生成 $\\mathrm{P}_n$ 和 $\\mathrm{P}_m$。因此，一次通过歧化的终止相遇产生**两个**死聚合物分子。化学方程式为：\n$$ \\mathrm{P}_n^\\bullet + \\mathrm{P}_m^\\bullet \\xrightarrow{k_{\\text{disp}}} \\mathrm{P}_n + \\mathrm{P}_m $$\n\n现在，我们开始推导 $X_n$。数均聚合度 $X_n$ 定义为每个形成的聚合物分子所包含的平均单体单元数。这可以表示为单体消耗速率与死聚合物分子生成速率之比。\n$$ X_n = \\frac{\\text{单体消耗速率}}{\\text{死聚合物生成速率}} $$\n\n单体的消耗绝大多数发生在增长步骤中。增长速率 $R_p$ 由反应 $\\mathrm{P}_n^\\bullet + \\mathrm{M} \\rightarrow \\mathrm{P}_{n+1}^\\bullet$ 的基元质量作用定律给出。对所有链长求和，总增长速率为：\n$$ R_p = k_p [\\mathrm{M}] \\sum_n [\\mathrm{P}_n^\\bullet] = k_p [\\mathrm{M}] [\\mathrm{R}^\\bullet] $$\n其中 $[\\mathrm{R}^\\bullet]$ 是所有活性聚合物自由基的总浓度。\n\n接下来，我们必须确定死聚合物分子的生成速率。我们将此速率表示为 $R_{form}$。死聚合物由复合和歧化两种事件形成。\n涉及两个自由基的复合事件的速率是 $k_{\\text{comb}} [\\mathrm{R}^\\bullet]^2$。由于每个复合事件产生一个死聚合物分子，因此由复合生成的聚合物速率为 $k_{\\text{comb}} [\\mathrm{R}^\\bullet]^2$。\n歧化事件的速率是 $k_{\\text{disp}} [\\mathrm{R}^\\bullet]^2$。由于每个歧化事件产生两个死聚合物分子，因此由歧化生成的聚合物速率为 $2 k_{\\text{disp}} [\\mathrm{R}^\\bullet]^2$。\n死聚合物分子的总生成速率是这两个速率之和：\n$$ R_{form} = k_{\\text{comb}} [\\mathrm{R}^\\bullet]^2 + 2 k_{\\text{disp}} [\\mathrm{R}^\\bullet]^2 = (k_{\\text{comb}} + 2 k_{\\text{disp}}) [\\mathrm{R}^\\bullet]^2 $$\n\n现在，通过代入 $R_p$ 和 $R_{form}$ 的表达式，我们可以写出 $X_n$ 的中间表达式：\n$$ X_n = \\frac{R_p}{R_{form}} = \\frac{k_p [\\mathrm{M}] [\\mathrm{R}^\\bullet]}{(k_{\\text{comb}} + 2 k_{\\text{disp}}) [\\mathrm{R}^\\bullet]^2} = \\frac{k_p [\\mathrm{M}]}{(k_{\\text{comb}} + 2 k_{\\text{disp}}) [\\mathrm{R}^\\bullet]} $$\n\n这个表达式包含未知的自由基浓度 $[\\mathrm{R}^\\bullet]$。我们通过应用稳态近似(SSA)来求得 $[\\mathrm{R}^\\bullet]$，该近似假定自由基的生成速率（引发）等于自由基的消灭速率（终止）。\n自由基的生成速率已知为 $R_i$。\n自由基的消灭速率，即终止速率 $R_t$，描述了自由基的消耗。在每次终止事件中，无论是通过复合还是歧化，都会消耗两个自由基。总终止速率常数为 $k_t = k_{\\text{comb}} + k_{\\text{disp}}$。因此，自由基的消耗速率是：\n$$ R_t = 2 (k_{\\text{comb}} + k_{\\text{disp}}) [\\mathrm{R}^\\bullet]^2 $$\n应用SSA，我们令引发速率等于终止速率：\n$$ R_i = R_t = 2 (k_{\\text{comb}} + k_{\\text{disp}}) [\\mathrm{R}^\\bullet]^2 $$\n解出稳态自由基浓度 $[\\mathrm{R}^\\bullet]$：\n$$ [\\mathrm{R}^\\bullet] = \\left( \\frac{R_i}{2(k_{\\text{comb}} + k_{\\text{disp}})} \\right)^{1/2} $$\n\n最后，我们将 $[\\mathrm{R}^\\bullet]$ 的这个表达式代回到我们关于 $X_n$ 的方程中：\n$$ X_n = \\frac{k_p [\\mathrm{M}]}{(k_{\\text{comb}} + 2 k_{\\text{disp}}) \\left( \\frac{R_i}{2(k_{\\text{comb}} + k_{\\text{disp}})} \\right)^{1/2}} $$\n这个表达式可以重新整理，以提供最终的封闭形式解：\n$$ X_n = \\frac{k_p [\\mathrm{M}]}{(k_{\\text{comb}} + 2 k_{\\text{disp}})} \\frac{\\sqrt{2(k_{\\text{comb}} + k_{\\text{disp}})}}{\\sqrt{R_i}} $$\n$$ X_n = \\frac{k_p [\\mathrm{M}] \\sqrt{2(k_{\\text{comb}} + k_{\\text{disp}})}}{\\sqrt{R_i}(k_{\\text{comb}} + 2 k_{\\text{disp}})} $$\n这就是所要求的、作为给定参数函数的数均聚合度表达式。", "answer": "$$\n\\boxed{\\frac{k_p [\\mathrm{M}] \\sqrt{2(k_{\\text{comb}} + k_{\\text{disp}})}}{\\sqrt{R_i}(k_{\\text{comb}} + 2 k_{\\text{disp}})}}\n$$", "id": "2631169"}, {"introduction": "许多链式反应并非在空间均匀的条件下进行，光化学反应就是一个典型例子。本练习将带领你分析光引发过程，其中引发速率取决于局部光强，而光强本身会因吸收而衰减。你将应用比尔-朗伯定律（Beer–Lambert law）来描述这一空间非均匀性，并推导整个反应体系的平均引发速率，这有助于理解在光刻、材料表面改性等实际应用中，反应速率如何在空间上分布。[@problem_id:2631199]", "problem": "一个厚度为 $L$ 的均匀液体平板，其中含有浓度均匀为 $C_A$ 的溶解光引发剂 $A$。该平板从一侧（$z=0$）受到单色准直光束的辐照，其光子通量密度为 $I_0$（单位：mol photons m$^{-2}$ s$^{-1}$）。光引发步骤为 $A + h\\nu \\to 2R$，其中每个被吸收的光子平均产生 $\\Phi$ 个自由基（量子产率 $\\Phi$，无量纲）。假设以下理想化条件：介质无散射、无发射，反射可忽略不计，$C_A$ 在辐照期间空间上保持均匀，且衰减遵循比尔-朗伯定律，具有空间均匀的纳皮尔吸收系数 $\\alpha$（单位：m$^{-1}$），该系数与 $C_A$ 呈线性正比。令 $I(z)$ 表示深度 $z \\in [0,L]$ 处的局部光子通量密度。\n\n从光子守恒和比尔-朗伯衰减定律出发，推导自由基的空间平均体积引发速率的封闭形式表达式，\n$$\\bar{r}_i \\equiv \\frac{1}{L}\\int_0^L r_i(z)\\,dz,$$\n用 $I_0$、$\\alpha$、$L$ 和 $\\Phi$ 表示，其中 $r_i(z)$ 是由光引发引起的局部自由基生成体积速率。将最终的 $\\bar{r}_i$ 以 mol m$^{-3}$ s$^{-1}$ 为单位，用符号形式表示，无需数值代入。\n\n然后，使用您推导的表达式，论证弱吸收（$\\alpha L \\ll 1$）和强吸收（$\\alpha L \\gg 1$）情况下的极限行为，并从物理上解释在强吸收条件下，比尔-朗伯定律如何影响引发的空间分布。无需进行数值计算；仅提供 $\\bar{r}_i$ 的封闭形式解析结果作为最终答案。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   系统：厚度为 $L$ 的均匀液体平板。\n-   光引发剂：物种 $A$，浓度均匀为 $C_A$。\n-   辐照：在 $z=0$ 处的单色准直光束，光子通量密度为 $I_0$ [mol photons m$^{-2}$ s$^{-1}$]。\n-   深度 $z$ 处的光子通量密度：$I(z)$。\n-   光引发反应：$A + h\\nu \\to 2R$。\n-   量子产率：$\\Phi$ [自由基/光子]。\n-   吸收：遵循比尔-朗伯定律，具有空间均匀的纳皮尔吸收系数 $\\alpha$ [m$^{-1}$]。\n-   假设：介质无散射、无发射；反射可忽略；$C_A$ 空间均匀；$\\alpha$ 与 $C_A$ 呈线性正比。\n-   目标量：自由基的空间平均体积引发速率，$\\bar{r}_i \\equiv \\frac{1}{L}\\int_0^L r_i(z)\\,dz$，其中 $r_i(z)$ 是局部自由基生成体积速率。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。它基于化学动力学和辐射传输的基本原理，特别是比尔-朗伯定律和量子产率的概念。该问题是自洽的，提供了推导唯一解所需的所有物理定律、变量和边界条件（$I(0) = I_0$）。这些理想化条件（例如，浓度均匀，无散射）是为获得解析解而采用的标准简化假设，并不构成缺陷。术语精确，目标明确。该问题既不平凡，也非不适定问题。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。我们将进行完整推导。\n\n推导从支配光子传输和吸收的基本原理开始。比尔-朗伯定律描述了光强度在吸收介质中的衰减。对于一维系统，这表示为关于光子通量密度 $I(z)$ 的一阶常微分方程：\n$$ \\frac{dI}{dz} = -\\alpha I(z) $$\n其中 $\\alpha$ 是纳皮尔吸收系数。边界条件是平板前表面的入射通量，$I(z=0) = I_0$。我们通过分离变量法求解此微分方程：\n$$ \\int_{I_0}^{I(z)} \\frac{dI'}{I'} = -\\int_0^z \\alpha \\,dz' $$\n由于假设 $\\alpha$ 在空间上是均匀的，积分得出：\n$$ \\ln\\left(\\frac{I(z)}{I_0}\\right) = -\\alpha z $$\n求解 $I(z)$，得到光子通量密度作为深度函数的显式表达式：\n$$ I(z) = I_0 \\exp(-\\alpha z) $$\n我们记为 $r_{abs}(z)$ 的局部光子吸收体积速率，由光子通量矢量的负散度给出。在一维情况下，这简化为 $I(z)$ 的负导数：\n$$ r_{abs}(z) = -\\frac{dI}{dz} $$\n将比尔-朗伯定律代入此表达式，我们发现局部吸收速率与局部光强成正比：\n$$ r_{abs}(z) = -(-\\alpha I(z)) = \\alpha I(z) = \\alpha I_0 \\exp(-\\alpha z) $$\n$r_{abs}(z)$ 的单位是 mol photons m$^{-3}$ s$^{-1}$，符合体积速率的要求。\n\n接下来，我们定义局部自由基生成体积速率 $r_i(z)$。问题陈述指出，量子产率 $\\Phi$ 是每个被吸收光子产生的自由基的平均数量。因此，$r_i(z)$ 是量子产率与局部光子吸收速率的乘积：\n$$ r_i(z) = \\Phi \\cdot r_{abs}(z) = \\Phi \\alpha I_0 \\exp(-\\alpha z) $$\n$r_i(z)$ 的单位是 mol radicals m$^{-3}$ s$^{-1}$。\n\n目标是求出在平板厚度 $L$ 上的空间平均体积引发速率 $\\bar{r}_i$。这由积分定义：\n$$ \\bar{r}_i = \\frac{1}{L}\\int_0^L r_i(z)\\,dz $$\n我们将 $r_i(z)$ 的表达式代入此积分：\n$$ \\bar{r}_i = \\frac{1}{L}\\int_0^L \\Phi \\alpha I_0 \\exp(-\\alpha z)\\,dz $$\n项 $\\Phi$、$\\alpha$、$I_0$ 和 $L$ 相对于积分变量 $z$ 是常数，因此我们可以将它们移到积分符号外：\n$$ \\bar{r}_i = \\frac{\\Phi \\alpha I_0}{L} \\int_0^L \\exp(-\\alpha z)\\,dz $$\n指数函数的积分是直接的：\n$$ \\int_0^L \\exp(-\\alpha z)\\,dz = \\left[ -\\frac{1}{\\alpha}\\exp(-\\alpha z) \\right]_0^L = -\\frac{1}{\\alpha}(\\exp(-\\alpha L) - \\exp(0)) = \\frac{1}{\\alpha}(1 - \\exp(-\\alpha L)) $$\n将此结果代回 $\\bar{r}_i$ 的表达式中：\n$$ \\bar{r}_i = \\frac{\\Phi \\alpha I_0}{L} \\left( \\frac{1}{\\alpha}(1 - \\exp(-\\alpha L)) \\right) $$\n项 $\\alpha$ 被消去，得到空间平均引发速率的最终封闭形式表达式：\n$$ \\bar{r}_i = \\frac{\\Phi I_0}{L} (1 - \\exp(-\\alpha L)) $$\n此表达式给出了以指定单位 mol m$^{-3}$ s$^{-1}$ 表示的平均自由基形成速率。\n\n我们现在分析此表达式的极限行为。\n\n情况1：弱吸收（$\\alpha L \\ll 1$）。\n这个条件描述了一个光学薄板。我们使用指数函数的泰勒级数展开，对于小的 $x$，有 $\\exp(-x) \\approx 1 - x$。令 $x = \\alpha L$，我们有 $\\exp(-\\alpha L) \\approx 1 - \\alpha L$。将此代入 $\\bar{r}_i$ 的表达式中：\n$$ \\bar{r}_i \\approx \\frac{\\Phi I_0}{L} (1 - (1 - \\alpha L)) = \\frac{\\Phi I_0}{L} (\\alpha L) = \\Phi \\alpha I_0 $$\n在弱吸收极限下，平均引发速率与平板厚度 $L$ 无关，且与吸收系数 $\\alpha$ 和入射通量 $I_0$ 呈线性正比。这在物理上是一致的：当平板为光学薄板时，光强 $I(z)$ 在整个体积内近似为常数，等于 $I_0$。因此，局部引发速率几乎是均匀的，$r_i(z) \\approx \\Phi \\alpha I_0$，其平均值就是这个常数。\n\n情况2：强吸收（$\\alpha L \\gg 1$）。\n这个条件描述了一个光学厚板。当 $\\alpha L \\to \\infty$ 时，项 $\\exp(-\\alpha L) \\to 0$。$\\bar{r}_i$ 的表达式变为：\n$$ \\bar{r}_i \\to \\frac{\\Phi I_0}{L} (1 - 0) = \\frac{\\Phi I_0}{L} $$\n在此极限下，平均引发速率变得与吸收系数 $\\alpha$ 无关，并与平板厚度 $L$ 成反比。物理原因是，对于光学厚板，所有入射光子都在板内被吸收。每单位面积进入平板的光子总数为 $I_0$。因此，每单位面积产生的自由基总数为 $\\Phi I_0$。平均体积速率是这个单位面积的总速率分布在厚度为 $L$ 的体积上，得到 $\\bar{r}_i = (\\Phi I_0)/L$。该速率与 $\\alpha$ 无关，因为只要 $\\alpha$ 足够大以吸收所有光，其精确值不会改变被吸收光子的总数。\n\n最后，我们讨论强吸收条件下引发的空间分布。局部速率 $r_i(z) = \\Phi \\alpha I_0 \\exp(-\\alpha z)$ 显示出随深度 $z$ 的指数衰减。这种衰减的特征长度尺度是吸收深度 $1/\\alpha$。对于强吸收，$\\alpha L \\gg 1$，这意味着 $L \\gg 1/\\alpha$。因此，绝大多数光引发事件发生在靠近受辐照表面（$z=0$）的一个薄层内。引发速率在 $z=0$ 处达到最大值（$r_i(0) = \\Phi \\alpha I_0$），并在平板深处，远未到达 $z=L$ 的后表面时，衰减到可忽略的值。这种由比尔-朗伯定律决定的高度不均匀分布，导致自由基浓度的陡峭梯度，这是许多光化学驱动过程（如光聚合）的一个决定性特征。", "answer": "$$\\boxed{\\frac{\\Phi I_0}{L} \\left(1 - \\exp(-\\alpha L)\\right)}$$", "id": "2631199"}, {"introduction": "虽然解析解能提供深刻的物理洞见，但大多数复杂的动力学系统必须通过数值方法求解。本练习将探讨一个关键的计算挑战——“刚性”（stiffness）问题，即反应网络中存在巨大差异的时间尺度，这会导致标准数值积分方法失效。通过构建雅可比矩阵（Jacobian matrix）并分析其特征值，你将学习如何量化刚性并选择合适的数值算法，这是计算化学动力学研究者的必备技能。[@problem_id:2631134]", "problem": "考虑一个包含链引发、链增长和链终止的自由基链式反应机理。所涉及的物种有：引发剂 $I$、底物 $A$、两种自由基中间体 $R_1$ 和 $R_2$ 以及产物 $P$。该机理如下：\n- 链引发：$I \\rightarrow 2R_1$，速率系数为 $k_1$，单位为 $\\mathrm{s}^{-1}$。\n- 链增长：$R_1 + A \\rightarrow R_2 + P$，速率系数为 $k_2$，单位为 $\\left(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\right)^{-1}\\ \\mathrm{s}^{-1}$；以及 $R_2 + A \\rightarrow R_1 + P$，速率系数为 $k_3$，单位为 $\\left(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\right)^{-1}\\ \\mathrm{s}^{-1}$。\n- 链终止：$R_1 + R_1 \\rightarrow \\text{失活产物}$，速率系数为 $k_4$，单位为 $\\left(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\right)^{-1}\\ \\mathrm{s}^{-1}$；$R_2 + R_2 \\rightarrow \\text{失活产物}$，速率系数为 $k_5$，单位为 $\\left(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\right)^{-1}\\ \\mathrm{s}^{-1}$；以及 $R_1 + R_2 \\rightarrow \\text{失活产物}$，速率系数为 $k_6$，单位为 $\\left(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\right)^{-1}\\ \\mathrm{s}^{-1}$。\n\n使用质量作用定律，为 $\\mathbf{x} = \\left[I,\\ A,\\ R_1,\\ R_2,\\ P\\right]^\\top$ 写出自治常微分方程组 $\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x})$，并根据线性化的第一性原理，定义在给定状态 $\\mathbf{x}$ 下计算的雅可比矩阵 $J(\\mathbf{x}) = \\partial \\mathbf{f} / \\partial \\mathbf{x}$。对于 $\\dot{\\mathbf{y}} = J \\mathbf{y}$ 的线性稳定性分析，雅可比矩阵 $J$ 的特征值（单位为 $\\mathrm{s}^{-1}$）决定了局部的衰减或增长速率。一个广泛使用的刚度量化指标是刚度比，此处定义为\n$$\n\\mathrm{SR} = \n\\begin{cases}\n\\dfrac{\\max\\left\\{ -\\operatorname{Re}(\\lambda_i)\\ :\\ \\operatorname{Re}(\\lambda_i)  0 \\right\\}}{\\min\\left\\{ -\\operatorname{Re}(\\lambda_i)\\ :\\ \\operatorname{Re}(\\lambda_i)  0 \\right\\}},  \\text{如果至少有两个特征值的实部为负}, \\\\\n1.0,  \\text{其他情况},\n\\end{cases}\n$$\n其中 $\\lambda_i$ 是 $J(\\mathbf{x})$ 的特征值，$\\operatorname{Re}(\\cdot)$ 表示实部。\n\n基于谱特征和数值积分器的经典线性稳定性概念，为推进此非线性系统，推荐以下时间积分器类别之一：\n- 代码 $0$：可接受四阶显式 Runge–Kutta 方法。\n- 代码 $1$：推荐使用 Runge–Kutta–Chebyshev 类别的显式稳定方法。\n- 代码 $2$：推荐使用 A-稳定 的隐式方法（例如，梯形法则）。\n- 代码 $3$：需要使用 L-稳定 的隐式方法（例如，后向欧拉法或二阶后向差分公式）。\n\n您的推荐必须根据雅可比谱通过以下方式确定性地映射得出。设 $\\mathcal{N} = \\left\\{ -\\operatorname{Re}(\\lambda_i)\\ :\\ \\operatorname{Re}(\\lambda_i)  -\\varepsilon \\right\\}$（其中 $\\varepsilon = 10^{-12}$ 是一个很小的数值容差），并设 $\\mathcal{P} = \\left\\{ \\operatorname{Re}(\\lambda_i)\\ :\\ \\operatorname{Re}(\\lambda_i) > \\varepsilon \\right\\}$。使用上述公式和集合 $\\mathcal{N}$ 定义 $\\mathrm{SR}$，并应用以下规则：\n- 如果 $\\lvert \\mathcal{N} \\rvert \\le 1$，无论 $\\mathcal{P}$ 如何，都输出代码 $0$。\n- 如果 $\\lvert \\mathcal{N} \\rvert \\ge 2$ 且 $\\mathcal{P}$ 为空：\n  - 如果 $\\mathrm{SR} \\le 20$，输出代码 $0$。\n  - 如果 $20  \\mathrm{SR} \\le 200$，输出代码 $1$。\n  - 如果 $200  \\mathrm{SR} \\le 5000$，输出代码 $2$。\n  - 如果 $\\mathrm{SR} > 5000$，输出代码 $3$。\n- 如果 $\\lvert \\mathcal{N} \\rvert \\ge 2$ 且 $\\mathcal{P}$ 非空：\n  - 如果 $\\mathrm{SR} > 200$，输出代码 $3$。\n  - 如果 $20  \\mathrm{SR} \\le 200$，输出代码 $2$。\n  - 如果 $\\mathrm{SR} \\le 20$，输出代码 $1$。\n\n此规则编码了以下理由：显式方法在负实轴上的稳定区域有限，而当衰减模式的跨度增大或当增长模式与快速衰减模式共存时，需要使用 A-稳定或 L-稳定的方法。\n\n测试套件。对于每组参数，在指定状态下计算雅可比矩阵，然后计算特征值、刚度比 $\\mathrm{SR}$（无单位）和推荐的代码（整数）。使用以下四个案例，每个案例都由速率系数和状态向量完全指定：\n- 案例 1（中等刚度）：$\\left[k_1,k_2,k_3,k_4,k_5,k_6\\right] = \\left[1,\\ 100,\\ 80,\\ 10^6,\\ 10^6,\\ 5\\times 10^6\\right]$，状态为 $\\left[I,A,R_1,R_2,P\\right] = \\left[10^{-6},\\ 1.0,\\ 10^{-7},\\ 2\\times 10^{-7},\\ 0\\right]$，适用单位为 $\\mathrm{mol}\\ \\mathrm{L}^{-1}$ 和 $\\mathrm{s}^{-1}$。\n- 案例 2（由链终止导致的极端刚度）：$\\left[k_1,k_2,k_3,k_4,k_5,k_6\\right] = \\left[0.5,\\ 150,\\ 120,\\ 10^9,\\ 10^9,\\ 2\\times 10^9\\right]$，状态为 $\\left[I,A,R_1,R_2,P\\right] = \\left[10^{-6},\\ 1.0,\\ 5\\times 10^{-7},\\ 5\\times 10^{-7},\\ 0\\right]$，适用单位为 $\\mathrm{mol}\\ \\mathrm{L}^{-1}$ 和 $\\mathrm{s}^{-1}$。\n- 案例 3（链增长主导且链引发缓慢）：$\\left[k_1,k_2,k_3,k_4,k_5,k_6\\right] = \\left[10^{-3},\\ 5\\times 10^2,\\ 5\\times 10^2,\\ 10^3,\\ 10^3,\\ 10^3\\right]$，状态为 $\\left[I,A,R_1,R_2,P\\right] = \\left[10^{-3},\\ 5.0,\\ 10^{-9},\\ 10^{-9},\\ 0\\right]$，适用单位为 $\\mathrm{mol}\\ \\mathrm{L}^{-1}$ 和 $\\mathrm{s}^{-1}$。\n- 案例 4（自由基浓度为零的边界情况）：$\\left[k_1,k_2,k_3,k_4,k_5,k_6\\right] = \\left[10,\\ 1,\\ 1,\\ 10^6,\\ 10^6,\\ 10^6\\right]$，状态为 $\\left[I,A,R_1,R_2,P\\right] = \\left[1.0,\\ 1.0,\\ 0.0,\\ 0.0,\\ 0.0\\right]$，适用单位为 $\\mathrm{mol}\\ \\mathrm{L}^{-1}$ 和 $\\mathrm{s}^{-1}$。\n\n您的任务：\n- 实现一个程序，对每个案例，根据质量作用模型构建雅可比矩阵 $J(\\mathbf{x})$，计算 $J(\\mathbf{x})$ 的所有特征值 $\\lambda_i$，计算如上定义的 $\\mathrm{SR}$，并根据上述规则选择推荐的代码。\n- 将 $\\mathrm{SR}$ 表示为四舍五入到六位有效数字的小数（无单位）。代码为整数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个案例的结果必须是一个双元素列表 $\\left[\\mathrm{SR},\\ \\text{code}\\right]$，整体输出必须是包含这四个列表的单一列表。例如，打印的行必须类似于 $\\left[\\left[\\mathrm{SR}_1,\\ \\text{code}_1\\right],\\left[\\mathrm{SR}_2,\\ \\text{code}_2\\right],\\left[\\mathrm{SR}_3,\\ \\text{code}_3\\right],\\left[\\mathrm{SR}_4,\\ \\text{code}_4\\right]\\right]$，并用数值替换。输出中不应包含单位。不涉及角度。不涉及百分比。", "solution": "所述问题在科学上是合理的，形式上是适定的，并且是客观的。它基于化学动力学的基本原理（质量作用定律）和常微分方程的数值分析（线性稳定性理论，刚度）。唯一解所需的所有必要数据和定义均已提供。因此，该问题是有效的，我将着手解决它。\n\n问题的核心是分析一个模拟自由基链式反应的自治常微分方程组（ODE）的局部稳定性。系统的状态由浓度向量 $\\mathbf{x} = \\left[[I], [A], [R_1], [R_2], [P]\\right]^\\top$ 描述，其中 $[S]$ 表示物种 $S$ 的浓度。系统的时间演化由 $\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x})$ 给出。\n\n首先，我们必须使用质量作用定律从反应机理中推导出向量值函数 $\\mathbf{f}(\\mathbf{x})$。基元反应步骤及其相应的速率（$v_i$）如下：\n\\begin{itemize}\n    \\item 链引发：$I \\xrightarrow{k_1} 2R_1$，速率 $v_1 = k_1 [I]$\n    \\item 链增长：$R_1 + A \\xrightarrow{k_2} R_2 + P$，速率 $v_2 = k_2 [R_1] [A]$\n    \\item 链增长：$R_2 + A \\xrightarrow{k_3} R_1 + P$，速率 $v_3 = k_3 [R_2] [A]$\n    \\item 链终止：$R_1 + R_1 \\xrightarrow{k_4} \\text{失活产物}$，速率 $v_4 = k_4 [R_1]^2$\n    \\item 链终止：$R_2 + R_2 \\xrightarrow{k_5} \\text{失活产物}$，速率 $v_5 = k_5 [R_2]^2$\n    \\item 链终止：$R_1 + R_2 \\xrightarrow{k_6} \\text{失活产物}$，速率 $v_6 = k_6 [R_1] [R_2]$\n\\end{itemize}\n\n向量 $\\mathbf{f}(\\mathbf{x})$ 的分量代表每种物质的净变化率，如下所示：\n$$\n\\dot{x}_1 = \\frac{d[I]}{dt} = -v_1 = -k_1 [I]\n$$\n$$\n\\dot{x}_2 = \\frac{d[A]}{dt} = -v_2 - v_3 = -k_2 [R_1] [A] - k_3 [R_2] [A]\n$$\n$$\n\\dot{x}_3 = \\frac{d[R_1]}{dt} = 2v_1 - v_2 + v_3 - 2v_4 - v_6 = 2k_1 [I] - k_2 [R_1] [A] + k_3 [R_2] [A] - 2k_4 [R_1]^2 - k_6 [R_1] [R_2]\n$$\n$$\n\\dot{x}_4 = \\frac{d[R_2]}{dt} = v_2 - v_3 - 2v_5 - v_6 = k_2 [R_1] [A] - k_3 [R_2] [A] - 2k_5 [R_2]^2 - k_6 [R_1] [R_2]\n$$\n$$\n\\dot{x}_5 = \\frac{d[P]}{dt} = v_2 + v_3 = k_2 [R_1] [A] + k_3 [R_2] [A]\n$$\n\n接下来，我们推导雅可比矩阵 $J(\\mathbf{x})$，其元素定义为 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$，其中 $i, j \\in \\{1, 2, 3, 4, 5\\}$。状态向量的分量为 $x_1=[I], x_2=[A], x_3=[R_1], x_4=[R_2], x_5=[P]$。\n\n雅可比矩阵的非零元素为：\n$J_{11} = \\frac{\\partial f_1}{\\partial [I]} = -k_1$\n\n$J_{22} = \\frac{\\partial f_2}{\\partial [A]} = -k_2 [R_1] - k_3 [R_2]$\n$J_{23} = \\frac{\\partial f_2}{\\partial [R_1]} = -k_2 [A]$\n$J_{24} = \\frac{\\partial f_2}{\\partial [R_2]} = -k_3 [A]$\n\n$J_{31} = \\frac{\\partial f_3}{\\partial [I]} = 2k_1$\n$J_{32} = \\frac{\\partial f_3}{\\partial [A]} = -k_2 [R_1] + k_3 [R_2]$\n$J_{33} = \\frac{\\partial f_3}{\\partial [R_1]} = -k_2 [A] - 4k_4 [R_1] - k_6 [R_2]$\n$J_{34} = \\frac{\\partial f_3}{\\partial [R_2]} = k_3 [A] - k_6 [R_1]$\n\n$J_{42} = \\frac{\\partial f_4}{\\partial [A]} = k_2 [R_1] - k_3 [R_2]$\n$J_{43} = \\frac{\\partial f_4}{\\partial [R_1]} = k_2 [A] - k_6 [R_2]$\n$J_{44} = \\frac{\\partial f_4}{\\partial [R_2]} = -k_3 [A] - 4k_5 [R_2] - k_6 [R_1]$\n\n$J_{52} = \\frac{\\partial f_5}{\\partial [A]} = k_2 [R_1] + k_3 [R_2]$\n$J_{53} = \\frac{\\partial f_5}{\\partial [R_1]} = k_2 [A]$\n$J_{54} = \\frac{\\partial f_5}{\\partial [R_2]} = k_3 [A]$\n\n雅可比矩阵的所有其他元素均为零。完整的雅可比矩阵为：\n$$\nJ(\\mathbf{x}) = \\begin{pmatrix}\n-k_1  0  0  0  0 \\\\\n0  -k_2 [R_1] - k_3 [R_2]  -k_2 [A]  -k_3 [A]  0 \\\\\n2k_1  -k_2 [R_1] + k_3 [R_2]  -k_2 [A] - 4k_4 [R_1] - k_6 [R_2]  k_3 [A] - k_6 [R_1]  0 \\\\\n0  k_2 [R_1] - k_3 [R_2]  k_2 [A] - k_6 [R_2]  -k_3 [A] - 4k_5 [R_2] - k_6 [R_1]  0 \\\\\n0  k_2 [R_1] + k_3 [R_2]  k_2 [A]  k_3 [A]  0\n\\end{pmatrix}\n$$\n\n所提供的任务要求实现一个程序，为每个给定的测试案例执行以下步骤：\n1.  使用给定的速率系数 $k_i$ 和状态向量 $\\mathbf{x}$ 构建数值雅可比矩阵 $J(\\mathbf{x})$。\n2.  计算矩阵 $J(\\mathbf{x})$ 的特征值 $\\lambda_i$。\n3.  识别实部为负和实部为正的特征值集合，超出容差 $\\varepsilon = 10^{-12}$：\n    $\\mathcal{N} = \\{ -\\operatorname{Re}(\\lambda_i) : \\operatorname{Re}(\\lambda_i)  -\\varepsilon \\}$\n    $\\mathcal{P} = \\{ \\operatorname{Re}(\\lambda_i) : \\operatorname{Re}(\\lambda_i) > \\varepsilon \\}$\n4.  根据定义，使用集合 $\\mathcal{N}$ 计算刚度比 $\\mathrm{SR}$：\n    $$\n    \\mathrm{SR} = \\begin{cases} \\frac{\\max(\\mathcal{N})}{\\min(\\mathcal{N})}  \\text{如果 } |\\mathcal{N}| \\ge 2 \\\\ 1.0  \\text{如果 } |\\mathcal{N}|  2 \\end{cases}\n    $$\n5.  基于 $|\\mathcal{N}|$、$\\mathcal{P}$ 是否为空以及 $\\mathrm{SR}$ 的值，应用指定的决策规则来确定推荐的积分器代码（$0, 1, 2$ 或 $3$）。\n6.  将计算出的 $\\mathrm{SR}$ 格式化为四舍五入到六位有效数字的小数。\n\n以下程序实现了此过程。", "answer": "[[1120.0,2],[2000000.0,3],[2500000.0,3],[5.0,0]]", "id": "2631134"}]}