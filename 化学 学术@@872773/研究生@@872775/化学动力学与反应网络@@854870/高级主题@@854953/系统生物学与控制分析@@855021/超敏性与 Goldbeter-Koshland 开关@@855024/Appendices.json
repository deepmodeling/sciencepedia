{"hands_on_practices": [{"introduction": "要理解任何生物开关，首要问题是确定其激活点。这项基础练习旨在推导 Goldbeter-Koshland 开关的操作阈值，即产生半最大激活的特定输入信号比率。通过求解稳态代数，你将直接掌握酶动力学参数如何定义开关的核心工作点，并为理解其行为建立一个清晰的分析基础 [@problem_id:2691951]。", "problem": "考虑一个共价修饰循环，其中底物 $X$ 在两种相反的酶 $E_1$（正向修饰）和 $E_2$（反向修饰）的作用下，在未修饰形式 $X$ 和修饰形式 $X^{\\ast}$ 之间相互转化。基本反应式为\n$E_1 + X \\rightleftharpoons C_1 \\rightarrow E_1 + X^{\\ast}$ 和 $E_2 + X^{\\ast} \\rightleftharpoons C_2 \\rightarrow E_2 + X$，总底物浓度 $S_{\\mathrm{T}} = [X] + [X^{\\ast}]$ 守恒。假设准稳态近似适用于酶-底物复合物 $C_1$ 和 $C_2$，标准的米氏-孟顿描述对每个分支都有效，并且在所关心的时间尺度上 $S_{\\mathrm{T}}$ 是恒定的。令 $V_1 = k_{\\mathrm{cat},1}[E_1]_{\\mathrm{T}}$ 和 $V_2 = k_{\\mathrm{cat},2}[E_2]_{\\mathrm{T}}$ 分别表示最大速率，$K_{M1}$ 和 $K_{M2}$ 分别是 $E_1$ 和 $E_2$ 反应的米氏常数。将无量纲输出定义为修饰分数 $\\phi = [X^{\\ast}]/S_{\\mathrm{T}}$，并引入无量纲参数 $\\kappa_1 = K_{M1}/S_{\\mathrm{T}}$、$\\kappa_2 = K_{M2}/S_{\\mathrm{T}}$ 以及酶活性比 $\\theta = V_1/V_2$。\n\n在稳态下，正向和反向修饰通量达到平衡。将操作阈值 $\\theta_{0.5}$ 定义为当 $\\phi = 0.5$ 时 $\\theta$ 的值。仅从 $S_{\\mathrm{T}}$ 的守恒定律、两个相反分支的米氏-孟顿速率表达式的有效性以及正向和反向通量的稳态平衡出发，推导出一个关于 $\\kappa_1$ 和 $\\kappa_2$ 的 $\\theta_{0.5}$ 的单一闭式解析表达式。你的最终答案必须是只包含 $\\kappa_1$ 和 $\\kappa_2$ 的单一符号表达式。不要引入任何额外的参数。不需要数值近似，最终表达式中也不需要单位。", "solution": "该问题陈述是化学动力学中一个有效且适定的练习。它描述了共价修饰的经典 Goldbeter-Koshland 模型，这是系统生物学中理解超敏反应的一个基本概念。推导指定量所需的所有必要参数和条件均已提供。我们将开始推导。\n\n该系统涉及两个相反的酶促反应。由酶 $E_1$ 催化的正向反应将底物 $X$ 转化为其修饰形式 $X^{\\ast}$。由酶 $E_2$ 催化的反向反应将 $X^{\\ast}$ 转化回 $X$。问题陈述指出，两个反应都可以用米氏-孟顿动力学来描述。\n\n正向反应的速率 $v_1$ 是其底物浓度 $[X]$ 的函数。\n$$v_1 = \\frac{V_1 [X]}{K_{M1} + [X]}$$\n此处，$V_1$ 是正向反应的最大速率，$K_{M1}$ 是其米氏常数。\n\n反向反应的速率 $v_2$ 是其底物浓度 $[X^{\\ast}]$ 的函数。\n$$v_2 = \\frac{V_2 [X^{\\ast}]}{K_{M2} + [X^{\\ast}]}$$\n此处，$V_2$ 是反向反应的最大速率，$K_{M2}$ 是其米氏常数。\n\n在稳态下，$X^{\\ast}$ 的生成速率必须等于其消耗速率。这意味着通过正向和反向途径的通量是平衡的。\n$$v_1 = v_2$$\n代入速率的米氏-孟顿表达式得到：\n$$\\frac{V_1 [X]}{K_{M1} + [X]} = \\frac{V_2 [X^{\\ast}]}{K_{M2} + [X^{\\ast}]}$$\n问题定义了总底物浓度 $S_{\\mathrm{T}}$，它是守恒的：\n$$S_{\\mathrm{T}} = [X] + [X^{\\ast}]$$\n我们还得到了无量纲输出 $\\phi$ 的定义，即修饰底物的分数：\n$$\\phi = \\frac{[X^{\\ast}]}{S_{\\mathrm{T}}}$$\n根据这两个关系，我们可以用 $S_{\\mathrm{T}}$ 和 $\\phi$ 来表示浓度 $[X]$ 和 $[X^{\\ast}]$。\n$$[X^{\\ast}] = \\phi S_{\\mathrm{T}}$$\n$$[X] = S_{\\mathrm{T}} - [X^{\\ast}] = S_{\\mathrm{T}} - \\phi S_{\\mathrm{T}} = (1-\\phi)S_{\\mathrm{T}}$$\n现在，我们将 $[X]$ 和 $[X^{\\ast}]$ 的这些表达式代入稳态方程：\n$$\\frac{V_1 (1-\\phi)S_{\\mathrm{T}}}{K_{M1} + (1-\\phi)S_{\\mathrm{T}}} = \\frac{V_2 \\phi S_{\\mathrm{T}}}{K_{M2} + \\phi S_{\\mathrm{T}}}$$\n为了找到酶活性比 $\\theta = V_1 / V_2$ 的表达式，我们重新整理方程：\n$$\\frac{V_1}{V_2} = \\theta = \\frac{\\phi S_{\\mathrm{T}}}{K_{M2} + \\phi S_{\\mathrm{T}}} \\cdot \\frac{K_{M1} + (1-\\phi)S_{\\mathrm{T}}}{(1-\\phi)S_{\\mathrm{T}}}$$\n为了引入无量纲米氏常数 $\\kappa_1 = K_{M1}/S_{\\mathrm{T}}$ 和 $\\kappa_2 = K_{M2}/S_{\\mathrm{T}}$，我们将每个分数的分子和分母都除以 $S_{\\mathrm{T}}$：\n$$\\theta = \\frac{\\phi}{\\frac{K_{M2}}{S_{\\mathrm{T}}} + \\phi} \\cdot \\frac{\\frac{K_{M1}}{S_{\\mathrm{T}}} + (1-\\phi)}{1-\\phi}$$\n代入 $\\kappa_1$ 和 $\\kappa_2$ 的定义：\n$$\\theta = \\left(\\frac{\\phi}{\\kappa_2 + \\phi}\\right) \\left(\\frac{\\kappa_1 + 1 - \\phi}{1 - \\phi}\\right)$$\n这是输入信号 $\\theta$ 和输出响应 $\\phi$ 之间的一般稳态关系。问题要求计算操作阈值 $\\theta_{0.5}$，这是当 $\\phi = 0.5$ 时 $\\theta$ 的特定值。\n我们在 $\\theta$ 的一般表达式中令 $\\phi = 0.5$：\n$$\\theta_{0.5} = \\left(\\frac{0.5}{\\kappa_2 + 0.5}\\right) \\left(\\frac{\\kappa_1 + 1 - 0.5}{1 - 0.5}\\right)$$\n简化表达式：\n$$\\theta_{0.5} = \\left(\\frac{0.5}{\\kappa_2 + 0.5}\\right) \\left(\\frac{\\kappa_1 + 0.5}{0.5}\\right)$$\n第一项的分子和第二项的分母中的因子 $0.5$ 相互抵消，得到：\n$$\\theta_{0.5} = \\frac{\\kappa_1 + 0.5}{\\kappa_2 + 0.5}$$\n为了以不含小数的形式呈现此结果，我们将分子和分母同乘以 $2$：\n$$\\theta_{0.5} = \\frac{2(\\kappa_1 + 0.5)}{2(\\kappa_2 + 0.5)} = \\frac{2\\kappa_1 + 1}{2\\kappa_2 + 1}$$\n这就是所要求的，仅作为无量纲参数 $\\kappa_1$ 和 $\\kappa_2$ 函数的操作阈值 $\\theta_{0.5}$ 的最终闭式解析表达式。", "answer": "$$\\boxed{\\frac{2\\kappa_1 + 1}{2\\kappa_2 + 1}}$$", "id": "2691951"}, {"introduction": "除了激活阈值，Goldbeter-Koshland 模块的决定性特征是其超敏性能力。这个练习将关注点从开关在“何处”发生转移到它“多陡峭地”发生，通过量化其响应的陡峭程度来实现。你将推导对数敏感度，并分析酶饱和度如何产生“零级超敏性”，正是这种机制使得该模块在细胞信号传导中如此强大 [@problem_id:2691968]。", "problem": "考虑一个共价修饰循环（Goldbeter–Koshland 开关），其中底物分别通过一个修饰酶和一个去修饰酶在未修饰形式和修饰形式之间相互转换。假设准稳态 Michaelis–Menten 描述适用于作用于其各自底物库的每种酶。设总底物浓度为 $S_T$，修饰分数为 $a \\in [0,1]$，最大速率为 $V_1$（修饰）和 $V_2$（去修饰），米氏常数为 $K_1$ 和 $K_2$。定义无量纲参数 $J_1 \\equiv K_1/S_T$、$J_2 \\equiv K_2/S_T$ 和活性比 $\\alpha \\equiv V_1/V_2$。在稳态下，正向和反向速率达到平衡。\n\n将开关相对于输入 $\\alpha$ 在对称点 $\\alpha=1$ 处的超敏锐度（陡峭度）定义为对数斜率 $S(J_1,J_2) \\equiv \\left.\\frac{d a}{d \\ln \\alpha}\\right|_{\\alpha=1}$。\n\n仅从 Michaelis–Menten 动力学和上述定义所隐含的稳态速率平衡出发，按顺序完成以下任务：\n\n(i) 在不引用任何关于 Goldbeter–Koshland 函数的现成公式的情况下，推导 $S(J_1,J_2)$ 的闭式解析表达式。\n\n(ii) 使用你的结果，通过计算比率来比较仅有一个酶饱和与两个酶都饱和时的超敏锐度\n$$\n\\mathcal{R} \\equiv \\frac{\\displaystyle \\lim_{J_1 \\to 0,\\; J_2 \\to \\infty} S(J_1,J_2)}{\\displaystyle \\lim_{\\varepsilon \\to 0} S(\\varepsilon,\\varepsilon)}.\n$$\n这里，情形 $K_1 \\ll S_T \\ll K_2$ 对应于 $J_1 \\to 0$ 和 $J_2 \\to \\infty$（仅修饰酶饱和），而 $K_1 \\ll S_T$ 和 $K_2 \\ll S_T$ 对应于 $J_1 \\to 0$ 和 $J_2 \\to 0$（两个酶对称饱和，表示为 $J_1=J_2=\\varepsilon \\to 0$）。将 $\\mathcal{R}$ 的最终答案表示为单个实数。无需四舍五入。答案是无量纲的，因此报告时无需单位。", "solution": "该问题要求推导 Goldbeter-Koshland 开关的锐度，并计算在不同极限条件下该锐度的比率。该问题具有科学依据、提法明确且客观。我将开始解答。\n\n首先，我们建立系统的稳态条件。设 $S_{unmod}$ 为未修饰底物的浓度，$S_{mod}$ 为修饰底物的浓度。总底物浓度为 $S_T = S_{unmod} + S_{mod}$。修饰底物的分数为 $a = S_{mod}/S_T$，因此 $S_{mod} = a S_T$ 且 $S_{unmod} = (1-a)S_T$。\n\n正向（修饰）反应速率 $v_1$ 和反向（去修饰）反应速率 $v_2$ 由 Michaelis-Menten 动力学给出：\n$$ v_1 = \\frac{V_1 S_{unmod}}{K_1 + S_{unmod}} = \\frac{V_1 (1-a)S_T}{K_1 + (1-a)S_T} $$\n$$ v_2 = \\frac{V_2 S_{mod}}{K_2 + S_{mod}} = \\frac{V_2 a S_T}{K_2 + a S_T} $$\n在稳态下，速率相等，$v_1=v_2$：\n$$ \\frac{V_1 (1-a)S_T}{K_1 + (1-a)S_T} = \\frac{V_2 a S_T}{K_2 + a S_T} $$\n我们引入问题中给出的无量纲参数：$\\alpha = V_1/V_2$，$J_1 = K_1/S_T$ 和 $J_2 = K_2/S_T$。为此，我们首先将方程两边同除以 $V_2$，然后将两边的分子和分母同除以 $S_T$：\n$$ \\frac{\\alpha (1-a)}{K_1/S_T + (1-a)} = \\frac{a}{K_2/S_T + a} $$\n代入 $J_1$ 和 $J_2$ 的定义，我们得到无量纲形式的稳态方程：\n$$ \\frac{\\alpha (1-a)}{J_1 + 1-a} = \\frac{a}{J_2 + a} $$\n该方程隐式地将修饰分数 $a$ 定义为活性比 $\\alpha$ 的函数。\n\n(i) 推导锐度的表达式 $S(J_1, J_2) = \\left.\\frac{d a}{d \\ln \\alpha}\\right|_{\\alpha=1}$。\n\n我们使用链式法则：$\\frac{da}{d\\ln\\alpha} = \\frac{da}{d\\alpha} \\frac{d\\alpha}{d\\ln\\alpha}$。由于 $\\ln\\alpha$ 意味着 $\\alpha = \\exp(\\ln\\alpha)$，我们有 $\\frac{d\\alpha}{d\\ln\\alpha} = \\alpha$。\n因此，$S(J_1, J_2) = \\left. \\alpha \\frac{da}{d\\alpha} \\right|_{\\alpha=1}$。\n\n为了求 $\\frac{da}{d\\alpha}$，我们对稳态方程进行隐式微分。让我们将方程重新整理成 $F(a, \\alpha) = 0$ 的形式：\n$$ F(a, \\alpha) = \\alpha (1-a)(J_2+a) - a(J_1 + 1-a) = 0 $$\n对 $\\alpha$ 求导得到：\n$$ \\frac{\\partial F}{\\partial \\alpha} + \\frac{\\partial F}{\\partial a} \\frac{da}{d\\alpha} = 0 \\implies \\frac{da}{d\\alpha} = - \\frac{\\partial F / \\partial \\alpha}{\\partial F / \\partial a} $$\n偏导数分别为：\n$$ \\frac{\\partial F}{\\partial \\alpha} = (1-a)(J_2+a) $$\n$$ \\frac{\\partial F}{\\partial a} = \\alpha[(-1)(J_2+a) + (1-a)(1)] - [1 \\cdot (J_1+1-a) + a(-1)] = \\alpha(1-J_2-2a) - (J_1+1-2a) $$\n锐度需要在 $\\alpha=1$ 处计算。首先，我们必须求出当 $\\alpha=1$ 时 $a$ 的值，记为 $a_0$。在稳态方程中令 $\\alpha=1$：\n$$ (1-a_0)(J_2+a_0) = a_0(J_1+1-a_0) $$\n$$ J_2 + a_0 - a_0 J_2 - a_0^2 = a_0 J_1 + a_0 - a_0^2 $$\n$$ J_2 - a_0 J_2 = a_0 J_1 \\implies J_2 = a_0(J_1+J_2) $$\n$$ a_0 = \\frac{J_2}{J_1+J_2} $$\n现在我们计算在 $\\alpha=1$ 和 $a=a_0$ 处的偏导数：\n$$ \\left. \\frac{\\partial F}{\\partial \\alpha} \\right|_{\\alpha=1} = (1-a_0)(J_2+a_0) $$\n$$ \\left. \\frac{\\partial F}{\\partial a} \\right|_{\\alpha=1} = (1-J_2-2a_0) - (J_1+1-2a_0) = -J_1-J_2 = -(J_1+J_2) $$\n所以，在 $\\alpha=1$ 处：\n$$ \\left. \\frac{da}{d\\alpha} \\right|_{\\alpha=1} = - \\frac{(1-a_0)(J_2+a_0)}{-(J_1+J_2)} = \\frac{(1-a_0)(J_2+a_0)}{J_1+J_2} $$\n锐度为 $S(J_1, J_2) = 1 \\cdot \\left. \\frac{da}{d\\alpha} \\right|_{\\alpha=1} = \\frac{(1-a_0)(J_2+a_0)}{J_1+J_2}$。\n我们代入 $a_0$ 和 $1-a_0 = 1 - \\frac{J_2}{J_1+J_2} = \\frac{J_1}{J_1+J_2}$ 的表达式：\n$$ 1-a_0 = \\frac{J_1}{J_1+J_2} $$\n$$ J_2+a_0 = J_2 + \\frac{J_2}{J_1+J_2} = \\frac{J_2(J_1+J_2)+J_2}{J_1+J_2} = \\frac{J_2(J_1+J_2+1)}{J_1+J_2} $$\n将这些代入 $S(J_1, J_2)$ 的表达式中：\n$$ S(J_1, J_2) = \\frac{\\left(\\frac{J_1}{J_1+J_2}\\right) \\left(\\frac{J_2(J_1+J_2+1)}{J_1+J_2}\\right)}{J_1+J_2} = \\frac{J_1 J_2 (1+J_1+J_2)}{(J_1+J_2)^3} $$\n这就是锐度的闭式解析表达式。\n\n(ii) 通过计算比率 $\\mathcal{R}$ 来比较两种极限情形下的锐度。\n\n要计算的比率是 $\\mathcal{R} \\equiv \\frac{\\displaystyle S_{num}}{S_{den}}$，其中 $S_{num} = \\displaystyle \\lim_{J_1 \\to 0,\\; J_2 \\to \\infty} S(J_1,J_2)$ 且 $S_{den} = \\displaystyle \\lim_{\\varepsilon \\to 0} S(\\varepsilon,\\varepsilon)$。\n\n首先，我们计算分子 $S_{num}$。这对应于情形 $K_1 \\ll S_T \\ll K_2$。\n$$ S_{num} = \\lim_{J_1 \\to 0, J_2 \\to \\infty} \\frac{J_1 J_2 (1+J_1+J_2)}{(J_1+J_2)^3} $$\n当 $J_1 \\to 0$ 和 $J_2 \\to \\infty$ 时，因子 $(1+J_1+J_2)$ 中的主导项是 $J_2$，而 $(J_1+J_2)$ 中的主导项也是 $J_2$。该表达式渐近等价于：\n$$ S_{num} \\approx \\lim_{J_1 \\to 0, J_2 \\to \\infty} \\frac{J_1 J_2 (J_2)}{(J_2)^3} = \\lim_{J_1 \\to 0, J_2 \\to \\infty} \\frac{J_1 J_2^2}{J_2^3} = \\lim_{J_1 \\to 0, J_2 \\to \\infty} \\frac{J_1}{J_2} $$\n由于 $J_1 \\to 0$ 且 $J_2 \\to \\infty$，该极限为 $0$。\n$$ S_{num} = 0 $$\n\n接下来，我们计算分母 $S_{den}$。这对应于对称饱和情形 $K_1 \\ll S_T$ 和 $K_2 \\ll S_T$，其中 $J_1=J_2=\\varepsilon \\to 0$。\n$$ S_{den} = \\lim_{\\varepsilon \\to 0} S(\\varepsilon, \\varepsilon) = \\lim_{\\varepsilon \\to 0} \\frac{\\varepsilon \\cdot \\varepsilon (1+\\varepsilon+\\varepsilon)}{(\\varepsilon+\\varepsilon)^3} = \\lim_{\\varepsilon \\to 0} \\frac{\\varepsilon^2(1+2\\varepsilon)}{(2\\varepsilon)^3} $$\n$$ S_{den} = \\lim_{\\varepsilon \\to 0} \\frac{\\varepsilon^2(1+2\\varepsilon)}{8\\varepsilon^3} = \\lim_{\\varepsilon \\to 0} \\frac{1+2\\varepsilon}{8\\varepsilon} $$\n当 $\\varepsilon \\to 0^+$ 时，$2\\varepsilon$ 项消失，而 $1/(8\\varepsilon)$ 项发散到正无穷大。\n$$ S_{den} = \\infty $$\n最后，我们计算比率 $\\mathcal{R}$：\n$$ \\mathcal{R} = \\frac{S_{num}}{S_{den}} = \\frac{0}{\\infty} = 0 $$\n这个结果的原因是，在不对称情况（$J_1 \\to 0, J_2 \\to \\infty$）下，响应曲线变得高度不对称，点 $\\alpha=1$ 位于上平台区很远的位置（$a_0 \\to 1$），在该处响应曲线是平坦的，因此局部斜率为零。在对称、双饱和情况（$J_1, J_2 \\to 0$）下，响应曲线变成一个精确以 $\\alpha=1$ 为中心的无限陡峭的阶跃函数，导致无限大的锐度。零锐度与无限大锐度的比值为零。", "answer": "$$\\boxed{0}$$", "id": "2691968"}, {"introduction": "解析推导能提供深刻的见解，但计算探索对于理解系统的全局行为至关重要。这项练习要求你以数值方式追踪 Goldbeter-Koshland 开关的完整刺激-响应曲线。通过实施一个数值延拓算法，你将验证关于系统单调性和不存在双稳态（这需要折叠分岔）的理论预测，从而架起数学理论与计算系统生物学之间的桥梁 [@problem_id:2692003]。", "problem": "考虑标准的 Goldbeter–Koshland 共价修饰循环，其中底物被激酶和磷酸酶可逆地修饰。在酶-底物复合物的准稳态假设下，净修饰和去修饰通量由米氏动力学描述。令修饰后底物的比例表示为 $\\phi \\in (0,1)$，并将总底物浓度归一化为 $1$。令无量纲比率 $\\theta = V_1/V_2$ 比较激酶和磷酸酶的最大速度，并令 $a = K_1/S_T$ 和 $b = K_2/S_T$ 表示无量纲米氏常数，其中 $S_T$ 是总底物浓度。\n\n在稳态下，通量平衡意味着 $v_1 = v_2$，其中\n$$\nv_1 = V_1 \\frac{1-\\phi}{K_1 + (1-\\phi) S_T}, \n\\qquad\nv_2 = V_2 \\frac{\\phi}{K_2 + \\phi S_T}.\n$$\n经 $V_2$ 和 $S_T$ 归一化后，稳态条件可以写为求根问题 $F(\\phi,\\theta;a,b) = 0$，其中\n$$\nF(\\phi,\\theta;a,b) \\equiv \\theta \\frac{1-\\phi}{a + 1 - \\phi} - \\frac{\\phi}{b + \\phi}.\n$$\n\n您的任务是设计一个算法，对固定的 $(a,b)$ 在 $\\theta$ 上执行数值延拓，通过求解每个 $\\theta$ 对应的 $F(\\phi,\\theta;a,b)=0$ 来计算相应的稳态分支 $\\phi(\\theta)$，然后在广泛的参数范围内数值验证标准的 Goldbeter–Koshland 模型中不会出现折叠（鞍节点）分岔。在由 $F(\\phi,\\theta;a,b)=0$ 隐式定义的稳态单参数延拓中，折叠分岔仅可能在某个解点 $(\\phi,\\theta)$ 处发生，该点满足 $\\partial F/\\partial \\phi = 0$ 且 $\\partial F/\\partial \\theta \\neq 0$。映射 $\\theta \\mapsto \\phi(\\theta)$ 的单调性可以通过在足够密集的网格上使用有限差分来检验。\n\n从上述通量平衡公式以及 $\\theta$、$a$ 和 $b$ 的定义出发，为每个测试用例实现以下步骤：\n- 对于给定的网格 $\\{\\theta_i\\}_{i=1}^{N}$（其中 $\\theta_i \\in [\\theta_{\\min}, \\theta_{\\max}]$），通过求解 $F(\\phi,\\theta_i;a,b)=0$ 计算唯一的稳态 $\\phi(\\theta_i) \\in (0,1)$。使用一种区间法，保证根位于区间 $\\phi \\in [0,1]$ 内。避免使用任何 $\\phi$ 的封闭形式解。\n- 通过检查前向有限差分 $\\Delta \\phi_i = \\phi(\\theta_{i+1}) - \\phi(\\theta_i)$ 在一个小的容差范围内是否为非负值，来验证网格上 $\\phi(\\theta)$ 的数值单调性。使用单调性容差 $\\tau_{\\mathrm{mono}} = 10^{-10}$，即要求对所有 $i$ 都有 $\\Delta \\phi_i \\ge -\\tau_{\\mathrm{mono}}$，并且要求 $\\phi(\\theta_N) - \\phi(\\theta_1) > 0$。\n- 在每个计算出的点 $(\\phi(\\theta_i), \\theta_i)$ 处计算偏导数 $\\partial F/\\partial \\phi$，并验证它在一个小的容差范围内永远不为零。使用导数容差 $\\tau_{\\mathrm{fold}} = 10^{-10}$，并要求 $\\max_i \\left( \\partial F/\\partial \\phi \\big|_{(\\phi(\\theta_i), \\theta_i)} \\right) \\le -\\tau_{\\mathrm{fold}}$（即严格为负且有界地远离 $0$），这在数值上排除了折叠分岔的可能。\n- 对于每个测试用例，输出一个布尔值，当且仅当以下两个条件都成立时，该值为 $\\,\\mathrm{True}\\,$：(i) 根据容差为 $\\tau_{\\mathrm{mono}}$ 的有限差分检验，$\\phi(\\theta)$ 是数值单调递增的；(ii) 根据容差为 $\\tau_{\\mathrm{fold}}$ 的导数检验，未检测到折叠分岔。否则输出 $\\,\\mathrm{False}\\,$。\n\n您的程序必须实现上述逻辑，并将其应用于以下 $(a,b,\\theta_{\\min},\\theta_{\\max},N)$ 值的测试套件。所有数字都必须解释为无量纲的：\n- 用例 1：$(a,b,\\theta_{\\min},\\theta_{\\max},N) = (10^{-2}, 10^{-2}, 10^{-3}, 10^{3}, 201)$。\n- 用例 2：$(a,b,\\theta_{\\min},\\theta_{\\max},N) = (5, 5, 10^{-6}, 10^{6}, 121)$。\n- 用例 3：$(a,b,\\theta_{\\min},\\theta_{\\max},N) = (10^{-3}, 5, 10^{-4}, 10^{4}, 161)$。\n- 用例 4：$(a,b,\\theta_{\\min},\\theta_{\\max},N) = (5, 10^{-3}, 10^{-4}, 10^{4}, 161)$。\n- 用例 5：$(a,b,\\theta_{\\min},\\theta_{\\max},N) = (10^{-6}, 10^{-6}, 10^{-3}, 10^{3}, 201)$。\n\n实现要求：\n- 对于每个测试用例，在 $\\theta_{\\min}$ 和 $\\theta_{\\max}$ 之间生成一个对数间隔的网格 $\\{\\theta_i\\}_{i=1}^N$。\n- 对于每个 $\\theta_i$，使用区间求解器在区间 $[0,1]$ 上求解 $F(\\phi,\\theta_i;a,b)=0$ 以得到 $\\phi \\in (0,1)$。\n- 使用上文指定的数值容差 $\\tau_{\\mathrm{mono}} = 10^{-10}$ 和 $\\tau_{\\mathrm{fold}} = 10^{-10}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $[\\mathrm{True},\\mathrm{False}]$。具体来说，该列表必须包含 $5$ 个布尔值，按上述顺序每个测试用例对应一个，指示数值证据是否支持该用例中没有折叠分岔且 $\\phi$ 对于 $\\theta$ 是单调的。", "solution": "问题陈述已经过严格验证，被认为是有效的。这是一个建立在化学反应网络和动力系统既有理论基础上的适定问题。我们现在开始求解。\n\n任务是为标准的 Goldbeter-Koshland 模型进行数值验证，证明修饰底物的稳态比例 $\\phi$ 是激酶与磷酸酶活性比率 $\\theta$ 的单调函数，并且在该解分支上不会发生折叠分岔。这将针对几组指定的无量纲米氏常数 $(a,b)$ 来完成。\n\n系统的稳态由通量平衡条件定义，这导出了求根问题 $F(\\phi,\\theta;a,b) = 0$，其中函数 $F$ 由下式给出：\n$$\nF(\\phi,\\theta;a,b) \\equiv \\theta \\frac{1-\\phi}{a + 1 - \\phi} - \\frac{\\phi}{b + \\phi}\n$$\n此处，$\\phi \\in (0,1)$ 是修饰底物的比例，$\\theta = V_1/V_2 > 0$ 是最大酶促反应速率之比，而 $a=K_1/S_T > 0$ 和 $b=K_2/S_T > 0$ 是无量纲米氏常数。\n\n折叠（或称鞍节点）分岔可能在一点 $(\\phi, \\theta)$ 处发生，该点满足 $F(\\phi,\\theta;a,b) = 0$ 且隐函数定理不成立，具体来说就是当 $\\partial F/\\partial \\phi = 0$ 时。$F$ 相对于 $\\phi$ 的偏导数为：\n$$\n\\frac{\\partial F}{\\partial \\phi} = \\theta \\frac{-(a+1-\\phi) - (1-\\phi)(-1)}{(a+1-\\phi)^2} - \\frac{(1)(b+\\phi) - (\\phi)(1)}{(b+\\phi)^2} = -\\frac{a\\theta}{(a+1-\\phi)^2} - \\frac{b}{(b+\\phi)^2}\n$$\n由于参数 $a$、$b$ 和 $\\theta$ 均为严格正值，且 $\\phi \\in [0,1]$，$\\partial F/\\partial \\phi$ 表达式中的两项均为严格负值。因此，对于所有有效的 $\\phi$、$\\theta$、$a$ 和 $b$，都有 $\\partial F/\\partial \\phi < 0$。这个解析结果证明了两个关键性质：\n1.  对于任何固定的 $(\\theta, a, b)$，函数 $F$ 相对于 $\\phi$ 是严格单调的。因为 $F(0, \\theta; a, b) = \\theta/(a+1) > 0$ 且 $F(1, \\theta; a, b) = -1/(b+1) < 0$，根据介值定理和严格单调性，可以保证存在唯一的稳态解 $\\phi \\in (0,1)$。\n2.  由于 $\\partial F/\\partial \\phi$ 永远不可能为零，因此该模型中不可能出现折叠分岔。\n\n响应曲线 $\\phi(\\theta)$ 的单调性也可以被确立。根据隐函数定理，解分支的斜率由下式给出：\n$$\n\\frac{d\\phi}{d\\theta} = - \\frac{\\partial F / \\partial \\theta}{\\partial F / \\partial \\phi}\n$$\n相对于 $\\theta$ 的偏导数是 $\\partial F/\\partial \\theta = (1-\\phi)/(a+1-\\phi)$，对于 $\\phi \\in (0,1)$，该值为正。由于 $\\partial F/\\partial \\phi < 0$ 且 $\\partial F/\\partial \\theta > 0$，因此 $d\\phi/d\\theta > 0$。所以，$\\phi$ 是 $\\theta$ 的一个严格递增函数。\n\n问题要求对这些已确立的理论事实进行数值验证。对于每个测试用例 $(a,b,\\theta_{\\min},\\theta_{\\max},N)$，算法将按以下步骤进行：\n\n1.  **网格生成**：为分岔参数 $\\theta$ 创建一个包含 $N$ 个点的网格，记为 $\\{\\theta_i\\}_{i=1}^N$，这些点在 $\\theta_{\\min}$ 和 $\\theta_{\\max}$ 之间按对数间隔分布。\n\n2.  **数值延拓**：对于网格中的每个 $\\theta_i$，通过数值求解非线性方程 $F(\\phi, \\theta_i; a, b) = 0$ 来找到唯一的稳态解 $\\phi_i$。按照规定，使用一种在区间 $[0,1]$ 上的区间法，该区间保证包含根。解集 $\\{\\phi_i\\}_{i=1}^N$ 构成了数值计算出的解分支。\n\n3.  **单调性验证**：检查计算出的分支的单调性。这包括计算前向有限差分 $\\Delta \\phi_i = \\phi_{i+1} - \\phi_i$。如果对于所有 $i \\in \\{1, \\dots, N-1\\}$ 都有 $\\Delta \\phi_i \\ge -\\tau_{\\mathrm{mono}}$，并且全局变化量 $\\phi_N - \\phi_1 > 0$，则测试通过。容差 $\\tau_{\\mathrm{mono}} = 10^{-10}$ 用以容纳微小的浮点不精确性。\n\n4.  **折叠分岔验证**：通过在每个计算点 $(\\phi_i, \\theta_i)$ 处计算导数 $\\partial F/\\partial \\phi$ 来验证不存在折叠分岔。如果该导数保持严格为负且有界地远离零，则测试通过。这通过检查是否满足 $\\max_i (\\partial F/\\partial \\phi)|_{(\\phi_i, \\theta_i)} \\le -\\tau_{\\mathrm{fold}}$ 来进行数值确认，其中容差为 $\\tau_{\\mathrm{fold}} = 10^{-10}$。\n\n一个测试用例被认为是成功的，其结果为 `True`，当且仅当单调性检验和折叠分岔检验都通过。否则，结果为 `False`。该实现将对所有提供的测试用例执行此过程。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Goldbeter-Koshland problem for a suite of test cases.\n\n    For each case, it performs a numerical continuation in the parameter theta,\n    computes the steady-state substrate modification phi(theta), and verifies\n    two properties:\n    1. The response phi(theta) is monotonic.\n    2. No fold bifurcations are detected.\n    \"\"\"\n    test_cases = [\n        # (a, b, theta_min, theta_max, N)\n        (1e-2, 1e-2, 1e-3, 1e3, 201),\n        (5.0, 5.0, 1e-6, 1e6, 121),\n        (1e-3, 5.0, 1e-4, 1e4, 161),\n        (5.0, 1e-3, 1e-4, 1e4, 161),\n        (1e-6, 1e-6, 1e-3, 1e3, 201),\n    ]\n\n    tau_mono = 1e-10\n    tau_fold = 1e-10\n\n    results = []\n\n    def F(phi, theta, a, b):\n        \"\"\"\n        Steady-state flux balance function F(phi, theta; a, b) = 0.\n        \"\"\"\n        if a + 1 - phi == 0 or b + phi == 0:\n            # Avoid division by zero, though phi is in [0,1] and a, b > 0\n            # should prevent this for the denominator a+1-phi unless phi=a+1.\n            # b+phi=0 is only for phi=0,b=0, not an issue.\n            return np.inf if a + 1 - phi == 0 else -np.inf\n        \n        term1 = theta * (1.0 - phi) / (a + 1.0 - phi)\n        term2 = phi / (b + phi)\n        return term1 - term2\n\n    def dF_dphi(phi, theta, a, b):\n        \"\"\"\n        Partial derivative of F with respect to phi.\n        \"\"\"\n        term1 = -a * theta / ((a + 1.0 - phi)**2)\n        term2 = -b / ((b + phi)**2)\n        return term1 + term2\n\n    for a, b, theta_min, theta_max, N in test_cases:\n        # Generate a logarithmically spaced grid for theta\n        theta_grid = np.logspace(np.log10(theta_min), np.log10(theta_max), N)\n        phi_values = np.zeros(N)\n\n        # Compute phi(theta) for each theta in the grid\n        for i, theta_i in enumerate(theta_grid):\n            # Define the function for which to find the root phi\n            f_to_solve = lambda phi: F(phi, theta_i, a, b)\n            \n            # Use brentq, a robust bracketing root-finding method\n            # The root is guaranteed to be in the interval (0, 1)\n            phi_values[i] = brentq(f_to_solve, 0.0, 1.0)\n            \n        # 1. Verify numerical monotonicity of phi(theta)\n        diffs = np.diff(phi_values)\n        is_monotone = np.all(diffs >= -tau_mono) and (phi_values[-1] - phi_values[0] > 0)\n        \n        # 2. Verify that the derivative dF/dphi never vanishes (no fold)\n        dF_dphi_values = dF_dphi(phi_values, theta_grid, a, b)\n        max_deriv = np.max(dF_dphi_values)\n        no_fold_detected = max_deriv = -tau_fold\n        \n        # The result for the case is True if both conditions hold\n        results.append(is_monotone and no_fold_detected)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2692003"}]}