{"hands_on_practices": [{"introduction": "本练习旨在巩固对微观反应截面 $\\sigma(E)$ 与宏观速率系数 $k(T)$ 之间基本关系的理解。我们将从最简单的硬球模型（即反应截面与能量无关）入手，通过对麦克斯韦-玻尔兹曼分布进行热平均，推导出速率系数。这个推导不仅是一个重要的分析基准，而且清晰地揭示了即使在微观截面恒定的情况下，宏观速率系数的温度依赖性是如何产生的。[@problem_id:2667867]", "problem": "考虑一个处于热力学平衡状态、绝对温度为 $T$ 的由组分 $A$ 和 $B$ 组成的稀疏二元气体混合物。设质量分别为 $m_A$ 和 $m_B$，约化质量为 $\\mu = \\frac{m_A m_B}{m_A + m_B}$。碰撞被假设为类硬球碰撞，其反应截面与能量无关，为 $\\sigma(E) = \\sigma_0$，其中 $\\sigma_0$ 是一个常数。双分子速率系数 $k(T)$ 定义为反应截面与相对速率的乘积在具有约化质量 $\\mu$ 的粒子的相对速率麦克斯韦-玻尔兹曼 (MB) 分布上的热平均：\n$$\nk(T) \\equiv \\int_{0}^{\\infty} \\sigma(v)\\, v\\, f_{\\mathrm{rel}}(v;T)\\, dv,\n$$\n其中 $v$ 是相对速率，$f_{\\mathrm{rel}}(v;T)$ 是约化质量系统的相对速率的MB分布，\n$$\nf_{\\mathrm{rel}}(v;T) = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v^{2} \\exp\\!\\left(-\\frac{\\mu v^{2}}{2 k_B T}\\right).\n$$\n仅从这些定义出发，计算在 $\\sigma(v) = \\sigma_0$ 的特殊情况下的积分，并将结果表示为以下形式：\n$$\nk(T) = C\\, \\sigma_0\\, \\sqrt{\\frac{k_B T}{\\mu}}.\n$$\n请以闭合形式的解析表达式报告无量纲前置因子 $C$。无需进行数值近似。您最终报告的量是无量纲的，因此无需报告单位。", "solution": "所述问题在科学上是合理的、提法恰当且自洽的。这是气体动理论中的一个标准问题，要求从基本原理出发计算速率系数。因此，我们可以开始求解。\n\n双分子速率系数 $k(T)$ 定义为反应截面 $\\sigma(v)$ 和相对速率 $v$ 乘积的热平均。提供的定义是：\n$$\nk(T) = \\int_{0}^{\\infty} \\sigma(v)\\, v\\, f_{\\mathrm{rel}}(v;T)\\, dv\n$$\n问题指定了一个硬球模型，其中截面与能量无关，因此也与相对速率无关：$\\sigma(v) = \\sigma_0$，其中 $\\sigma_0$ 是一个常数。将此代入 $k(T)$ 的定义，我们得到：\n$$\nk(T) = \\int_{0}^{\\infty} \\sigma_0\\, v\\, f_{\\mathrm{rel}}(v;T)\\, dv\n$$\n由于 $\\sigma_0$ 是一个常数，可以将其从积分中提出：\n$$\nk(T) = \\sigma_0 \\int_{0}^{\\infty} v\\, f_{\\mathrm{rel}}(v;T)\\, dv\n$$\n积分项 $\\int_{0}^{\\infty} v\\, f_{\\mathrm{rel}}(v;T)\\, dv$ 正是平均相对速率的定义，记为 $\\langle v \\rangle$。因此，对于恒定的截面，速率系数就是截面与平均相对速率的乘积：\n$$\nk(T) = \\sigma_0 \\langle v \\rangle\n$$\n我们的任务是使用给定的相对速率的麦克斯韦-玻尔兹曼分布 $f_{\\mathrm{rel}}(v;T)$ 来计算 $\\langle v \\rangle$。\n$$\nf_{\\mathrm{rel}}(v;T) = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v^{2} \\exp\\!\\left(-\\frac{\\mu v^{2}}{2 k_B T}\\right)\n$$\n我们将此表达式代入 $\\langle v \\rangle$ 的积分中：\n$$\n\\langle v \\rangle = \\int_{0}^{\\infty} v \\left[ 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v^{2} \\exp\\!\\left(-\\frac{\\mu v^{2}}{2 k_B T}\\right) \\right] dv\n$$\n我们可以将常数归并，并合并 $v$ 的幂：\n$$\n\\langle v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_{0}^{\\infty} v^3 \\exp\\!\\left(-\\frac{\\mu v^{2}}{2 k_B T}\\right) dv\n$$\n为了计算该积分，我们引入一个代换。令 $a = \\frac{\\mu}{2 k_B T}$。积分变为：\n$$\nI = \\int_{0}^{\\infty} v^3 \\exp(-av^2) dv\n$$\n这是高斯积分的一种标准形式。我们可以通过变量代换来求解。令 $x = av^2$。则 $v^2 = x/a$，且 $v = \\sqrt{x/a}$。微分是 $dv = \\frac{1}{\\sqrt{a}} \\frac{1}{2\\sqrt{x}} dx = \\frac{1}{2\\sqrt{a}} x^{-1/2} dx$。积分上下限仍然是 $0$ 到 $\\infty$。将这些代入积分 $I$：\n$$\nI = \\int_{0}^{\\infty} \\left(\\frac{x}{a}\\right)^{3/2} \\exp(-x) \\left(\\frac{1}{2\\sqrt{a}} x^{-1/2}\\right) dx\n$$\n简化包含 $a$ 和 $x$ 的项：\n$$\nI = \\frac{1}{a^{3/2}} \\frac{1}{2a^{1/2}} \\int_{0}^{\\infty} x^{3/2} x^{-1/2} \\exp(-x) dx = \\frac{1}{2a^2} \\int_{0}^{\\infty} x^1 \\exp(-x) dx\n$$\n剩下的积分是伽马函数的定义，$\\Gamma(z) = \\int_0^{\\infty} t^{z-1} e^{-t} dt$。在我们的例子中，$z-1=1$，这意味着 $z=2$。\n$$\n\\int_{0}^{\\infty} x \\exp(-x) dx = \\Gamma(2) = 1! = 1\n$$\n因此，积分 $I$ 的计算结果为：\n$$\nI = \\frac{1}{2a^2}\n$$\n现在，代回 $a = \\frac{\\mu}{2k_B T}$ 的表达式：\n$$\nI = \\frac{1}{2\\left(\\frac{\\mu}{2 k_B T}\\right)^2} = \\frac{(2k_B T)^2}{2\\mu^2} = \\frac{4(k_B T)^2}{2\\mu^2} = \\frac{2(k_B T)^2}{\\mu^2}\n$$\n现在我们可以完成对 $\\langle v \\rangle$ 的计算：\n$$\n\\langle v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} I = 4\\pi \\frac{\\mu^{3/2}}{(2\\pi)^{3/2}(k_B T)^{3/2}} \\left( \\frac{2(k_B T)^2}{\\mu^2} \\right)\n$$\n让我们简化前置因子：\n$4\\pi / (2\\pi)^{3/2} = 4\\pi / (2\\sqrt{2}\\pi\\sqrt{\\pi}) = \\sqrt{2}/\\sqrt{\\pi}$。\n那么\n$$\n\\langle v \\rangle = \\left( \\frac{\\sqrt{2}}{\\sqrt{\\pi}} \\frac{\\mu^{3/2}}{(k_B T)^{3/2}} \\right) \\left( \\frac{2(k_B T)^2}{\\mu^2} \\right) = \\frac{2\\sqrt{2}}{\\sqrt{\\pi}} \\frac{(k_B T)^{1/2}}{\\mu^{1/2}}\n$$\n这个推导是正确的。平均相对速率的结果是 $\\langle v \\rangle = \\sqrt{\\frac{8k_B T}{\\pi \\mu}}$。\n\n现在，我们构建速率系数 $k(T) = \\sigma_0 \\langle v \\rangle$：\n$$\nk(T) = \\sigma_0 \\sqrt{\\frac{8 k_B T}{\\pi \\mu}}\n$$\n问题要求将此结果表示为 $k(T) = C\\, \\sigma_0\\, \\sqrt{\\frac{k_B T}{\\mu}}$ 的形式。\n通过比较，无量纲前置因子 $C$ 为：\n$$\nC = \\sqrt{\\frac{8}{\\pi}}\n$$\n这就是前置因子的最终解析表达式。", "answer": "$$\n\\boxed{\\sqrt{\\frac{8}{\\pi}}}\n$$", "id": "2667867"}, {"introduction": "在理解了最简单的能量无关截面模型后，我们现在转向一个更真实的场景：反应截面随能量变化。本练习将引导您应用量子散射理论中的分波方法，从一个给定的、依赖于角动量的反应概率模型出发，通过数值求和来构建总反应截面 $\\sigma_{\\text{reac}}(E)$。通过这个实践，您将亲身体验到 $\\sigma(E)$ 的能量依赖性是如何从碰撞能量与离心势垒之间的竞争中产生的，从而加深对反应动力学微观机理的认识。[@problem_id:2667873]", "problem": "考虑一个由三维空间中的中心势建模的双分子散射问题，其中反应以与分波相关的概率发生。对于给定的碰撞能量 $E$ 和轨道角动量量子数 $l$，模型反应概率为 $P_l(E)=\\exp\\!\\left[-\\left(\\dfrac{E_l}{E}\\right)^{\\alpha}\\right]$，其中离心势垒能量由 $E_l=\\dfrac{\\hbar^2\\,(l+\\tfrac{1}{2})^2}{2\\,\\mu\\,r_c^2}$ 建模。此处，$\\mu$ 是反应物的约化质量，$r_c$ 是评估离心势垒时所用的特征长度尺度，$\\hbar$ 是约化普朗克常数，$\\alpha0$ 是一个控制反应在势垒之上发生时的起始尖锐度的参数。总反应截面 $\\sigma_{\\text{reac}}(E)$ 将根据分波散射的第一性原理进行计算。作为一个经过充分检验的起点，中心势在三维空间中的总反应截面由以下分波求和给出\n$$\n\\sigma_{\\text{reac}}(E)=\\frac{\\pi}{k(E)^2}\\sum_{l=0}^{\\infty}(2l+1)\\,P_l(E),\n$$\n其中 $k(E)=\\sqrt{2\\,\\mu\\,E}/\\hbar$ 是相对运动的波数。所有量在内部都必须使用国际单位制（SI）处理。测试套件中的输入能量值以电子伏特（eV）为单位，必须使用 $1\\,\\text{eV}=1.602176634\\times 10^{-19}\\,\\text{J}$ 转换为焦耳。测试套件中的约化质量输入以原子质量单位（amu）给出，必须使用 $1\\,\\text{amu}=1.66053906660\\times 10^{-27}\\,\\text{kg}$ 转换为千克。测试套件中的长度尺度输入 $r_c$ 以埃为单位给出，必须使用 $1\\,\\text{\\AA}=1.0\\times 10^{-10}\\,\\text{m}$ 转换为米。使用 $\\hbar=1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$ 和 $\\pi=3.141592653589793$。\n\n您的任务是编写一个完整的程序，该程序：\n- 将 $\\sigma_{\\text{reac}}(E)$ 作为截断和进行数值计算，截断包含分波 $l=0,1,2,\\dots,l_{\\max}$。截断基于一个有原则的准则：对于一个小的概率阈值 $P_{\\text{th}}$，所包含的最大 $l$ 近似满足 $\\left(\\dfrac{E_{l_{\\max}}}{E}\\right)^{\\alpha}\\lesssim -\\ln P_{\\text{th}}$。通过首先估算以下公式来实现\n$$\nl_{\\text{cut}}=\\max\\!\\left\\{0,\\ \\sqrt{\\frac{E}{E_c}}\\ \\left[-\\ln P_{\\text{th}}\\right]^{\\frac{1}{2\\alpha}}-\\frac{1}{2}\\right\\},\\quad E_c=\\frac{\\hbar^2}{2\\,\\mu\\,r_c^2},\n$$\n然后求和至 $l_{\\max}=\\min\\{\\lceil l_{\\text{cut}}+m\\rceil,L_{\\text{cap}}\\}$，其中 $m$ 是一个小的安全裕度，$L_{\\text{cap}}$ 是一个硬性上限，以确保计算时间有界。使用 $P_{\\text{th}}=10^{-12}$，$m=20$ 和 $L_{\\text{cap}}=2000$。\n- 通过使用对称乘法微扰数值计算对数导数 $s(E)=\\dfrac{d\\ln \\sigma_{\\text{reac}}}{d\\ln E}$，来分析 $\\sigma_{\\text{reac}}(E)$ 的局域能量依赖性。具体来说，对于一个给定的微小量 $\\delta$，定义 $\\rho=1+\\delta$、$E_{+}=\\rho\\,E$ 和 $E_{-}=E/\\rho$，并近似计算\n$$\ns(E)\\approx\\frac{\\ln \\sigma_{\\text{reac}}(E_{+})-\\ln \\sigma_{\\text{reac}}(E_{-})}{\\ln E_{+}-\\ln E_{-}}.\n$$\n在所有评估中，对 $E_{+}$ 和 $E_{-}$ 使用相同的截断策略。\n- 以平方米（$\\text{m}^2$）报告 $\\sigma_{\\text{reac}}(E)$，并以无量纲量的形式报告 $s(E)$。\n\n使用以下参数集测试套件。每个测试用例都是一个元组 $(E_{\\text{eV}},\\alpha,\\mu_{\\text{amu}},r_c^{(\\text{\\AA})},\\delta)$，其值如下：\n- 情况 A（理想路径，中等能量）： $(1.0\\times 10^{-2},\\ 1.0,\\ 20.0,\\ 5.0,\\ 0.05)$\n- 情况 B（较高能量）： $(1.0\\times 10^{-1},\\ 1.0,\\ 20.0,\\ 5.0,\\ 0.05)$\n- 情况 C（更陡峭的起始）： $(1.0\\times 10^{-2},\\ 2.0,\\ 20.0,\\ 5.0,\\ 0.05)$\n- 情况 D（更平缓的起始）： $(1.0\\times 10^{-3},\\ 0.5,\\ 40.0,\\ 5.0,\\ 0.05)$\n- 情况 E（低能边缘）： $(1.0\\times 10^{-6},\\ 1.0,\\ 20.0,\\ 5.0,\\ 0.05)$\n- 情况 F（质量敏感性）： $(1.0\\times 10^{-2},\\ 1.0,\\ 10.0,\\ 5.0,\\ 0.05)$\n\n您的程序必须：\n- 对于每种情况，使用指定的截断和数值微分方案计算 $\\sigma_{\\text{reac}}(E)$（单位 $\\text{m}^2$）和 $s(E)$（无量纲）。\n- 生成单行输出，其中包含所有情况的结果列表，该列表为用方括号括起来的逗号分隔列表，其中每个情况的结果本身是一个双元素列表 $[\\sigma_{\\text{reac}}(E),s(E)]$。两个数字都必须以科学记数法打印，且恰好有六位有效数字。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],\\dots]$，其中每个 $x_i$ 和 $y_i$ 都使用具有六位有效数字的科学记数法格式代码打印。\n\n为确保科学真实性和可解性而设定的假设和约束：\n- 仅使用上述物理上标准的关系式来计算 $k(E)$、$E_l$ 和分波求和。\n- 假设 $P_l(E)$ 仅通过给定的模型 $P_l(E)=\\exp\\!\\left[-\\left(\\dfrac{E_l}{E}\\right)^{\\alpha}\\right]$（其中 $\\alpha0$）依赖于 $E_l$。\n- 通过在必要时为 $\\ln \\sigma_{\\text{reac}}$ 的评估设置一个最小正数下限来确保数值稳定性，以避免因下溢而对零取对数，但选择的下限要足够小，以免影响给定测试套件中六位有效数字的输出。\n\n预期的输出是形如 $[[\\sigma_1,s_1],[\\sigma_2,s_2],\\dots,[\\sigma_6,s_6]]$ 的单行文本，其中所有 $\\sigma_i$ 的单位为 $\\text{m}^2$，所有 $s_i$ 均为无量纲，每个数字都以科学记数法给出，且恰好有六位有效数字。不应打印任何其他文本。", "solution": "问题陈述已经过严格验证，并被认定为有效。它具有科学依据，问题阐述清晰且客观。该问题是计算量子散射理论中的一个标准练习，基于既定的第一性原理，并为数值计算提供了一套清晰、自洽的指令。其中不存在矛盾、歧义或不科学的前提。因此，我将着手提供一个完整的解决方案。\n\n任务是计算双分子碰撞过程的总反应截面 $\\sigma_{\\text{reac}}(E)$ 及其关于能量的对数导数 $s(E)$。该方法论植根于量子力学中散射截面的分波展开。\n\n总反应截面由对所有分波的求和给出，分波由轨道角动量量子数 $l$ 索引：\n$$\n\\sigma_{\\text{reac}}(E) = \\frac{\\pi}{k(E)^2} \\sum_{l=0}^{\\infty} (2l+1) P_l(E)\n$$\n此处，$k(E) = \\frac{\\sqrt{2\\mu E}}{\\hbar}$ 是对应于相对动能 $E$ 和约化质量 $\\mu$ 的波数。项 $(2l+1)$ 解释了磁量子数 $m_l$ 的简并性。给定分波 $l$ 的反应概率由以下模型函数描述：\n$$\nP_l(E) = \\exp\\left[-\\left(\\frac{E_l}{E}\\right)^{\\alpha}\\right]\n$$\n该概率取决于离心势垒能量 $E_l$ 与碰撞能量 $E$ 的比值。参数 $\\alpha0$ 控制反应阈值的尖锐度。离心势垒能量 $E_l$ 由标准的量子力学表达式给出，在特征半径 $r_c$ 处进行评估：\n$$\nE_l = \\frac{\\hbar^2 (l+\\frac{1}{2})^2}{2\\mu r_c^2}\n$$\n项 $(l+\\frac{1}{2})^2$ 是 Langer 修正，一种常见的半经典校正。\n\n实现过程遵循以下基于原则的结构化步骤：\n\n$1$. **单位一致性**：必须一致地应用一个单位系统。所有计算均在国际单位制（SI）中执行。以非国际单位制单位（能量为电子伏特，质量为原子质量单位，长度为埃）提供的输入参数，在开始时使用提供的转换因子转换为其对应的国际单位制单位（分别为焦耳、千克和米）。所有物理常数，特别是约化普朗克常数 $\\hbar$ 和 $\\pi$，均使用其国际单位制值。\n\n$2$. **截面计算**：设计一个核心函数，用于在国际单位制下为给定的物理参数集 $\\{E, \\alpha, \\mu, r_c\\}$ 计算 $\\sigma_{\\text{reac}}(E)$。对 $l$ 的无限求和在计算上是不可行的，必须进行截断。问题指定了一个有原则的截断方案。\n    - 求和在上限 $l_{\\max}$ 处终止。该上限的确定是为了使更高阶分波的贡献可以忽略不计，具体来说，是在 $P_l(E)$ 降至阈值 $P_{\\text{th}} = 10^{-12}$ 以下的地方。\n    - 这导出了一个截断角动量 $l_{\\text{cut}}$ 的估计值，该值从条件 $P_{l_{\\text{cut}}}(E) \\approx P_{\\text{th}}$ 推导而来：\n    $$\n    l_{\\text{cut}} = \\max\\left\\{0, \\sqrt{\\frac{E}{E_c}} \\left[-\\ln P_{\\text{th}}\\right]^{\\frac{1}{2\\alpha}} - \\frac{1}{2}\\right\\}\n    $$\n    其中 $E_c = \\frac{\\hbar^2}{2\\mu r_c^2}$ 是与 $l=0$ 的离心势垒相关的特征能量尺度。\n    - 添加一个安全裕度 $m=20$，并施加一个硬性上限 $L_{\\text{cap}}=2000$，以得出最终的求和上限：$l_{\\max} = \\min\\{\\lceil l_{\\text{cut}}+m \\rceil, L_{\\text{cap}}\\}$。\n    - 从 $l=0$ 到 $l_{\\max}$ 的求和使用 `numpy` 库提供的向量化操作高效实现。生成一个 $l$ 值的数组，并逐元素计算 $E_l$、$P_l(E)$ 和被加数 $(2l+1)P_l(E)$ 的相应数组，最后进行求和归约。\n    - 最终的截面则计算为：\n    $$\n    \\sigma_{\\text{reac}}(E) = \\frac{\\pi \\hbar^2}{2\\mu E} \\sum_{l=0}^{l_{\\max}} (2l+1) \\exp\\left[-\\left(\\frac{E_c(l+\\frac{1}{2})^2}{E}\\right)^{\\alpha}\\right]\n    $$\n\n$3$. **对数导数计算**：截面的局域能量依赖性由无量纲的对数导数 $s(E) = \\frac{d\\ln\\sigma_{\\text{reac}}}{d\\ln E}$ 来量化。正如问题所指定，这是使用对数能量尺度上的对称有限差分格式进行数值计算的。\n    - 对于一个小的参数 $\\delta$，微扰能量定义为 $E_{+} = E(1+\\delta)$ 和 $E_{-} = E/(1+\\delta)$。\n    - 导数近似为：\n    $$\n    s(E) \\approx \\frac{\\ln \\sigma_{\\text{reac}}(E_{+}) - \\ln \\sigma_{\\text{reac}}(E_{-})}{\\ln E_{+} - \\ln E_{-}} = \\frac{\\ln[\\sigma_{\\text{reac}}(E_{+}) / \\sigma_{\\text{reac}(E_{-})}]}{2 \\ln(1+\\delta)}\n    $$\n    - 截面 $\\sigma_{\\text{reac}}(E_{+})$ 和 $\\sigma_{\\text{reac}}(E_{-})$ 通过对核心截面函数的独立调用来评估。这正确地应用了依赖于能量的截断策略，为每个微扰能量重新计算 $l_{\\max}$，这对精确求导至关重要。\n    - 为确保数值稳定性，在取对数之前，向截面值添加一个小的正数下限，以防止在 $\\sigma_{\\text{reac}}$ 下溢为零时出错，尽管对于给定的测试用例，使用双精度浮点运算预计不会发生这种情况。\n\n$4$. **程序结构**：最终的程序封装了这一逻辑。它定义了必要的物理和数值常数，遍历提供的测试套件，为每种情况执行计算，并将结果（$\\sigma_{\\text{reac}}(E)$ 单位为 $\\text{m}^2$ 和无量纲的 $s(E)$）格式化为精确指定的输出字符串，每个数字都以六位有效数字的科学记数法给出。", "answer": "[[3.01168e-19,9.08051e-01],[1.17180e-19,3.01828e-01],[1.69174e-19,1.86532e+00],[2.58557e-19,2.44390e-01],[7.85398e-19,-5.00000e-01],[4.40778e-19,9.01198e-01]]", "id": "2667873"}, {"introduction": "在科学研究中，我们常常通过理论计算或实验测量得到以数据表形式表示的能量依赖截面 $\\sigma(E)$。本练习旨在教授一种关键的实用技能：如何从这些离散的、非均匀的数值数据中计算出宏观热速率系数 $k(T)$。您将学习如何通过变量替换将热平均积分转化为适合高斯-拉盖尔求积法的形式，并应用插值技术处理离散数据点，最终完成从微观截面到宏观速率的完整计算流程。[@problem_id:2667912]", "problem": "给定一个在非均匀能量网格上以表格形式给出的能量依赖反应截面 $\\sigma(E)$，您的任务是计算气相反应的热双分子速率系数 $k(T)$。请从以下基本出发点开始：\n- 热双分子速率系数的定义，即对于两个具有约化质量 $\\mu$ 的碰撞粒子，$\\sigma(v) v$ 在相对速度的麦克斯韦-玻尔兹曼分布上的平均值。\n- 相对速度 $v$ 和相对平动能 $E$ 之间的变量转换，即 $E = \\tfrac{1}{2} \\mu v^2$。\n- 在温度 $T$ 的热平衡下，相对平动能的玻尔兹曼因子。\n\n通过组合这些元素并执行适当的变量替换，将积分映射到一个在无量纲能量 $x = E/(k_{\\mathrm{B}} T)$ 中带有标准拉盖尔权重 $\\exp(-x)$ 的积分，从而推导出一个计算程序，该程序使用高斯-拉盖尔求积法直接从 $\\sigma(E)$ 近似计算 $k(T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。在您的算法中，将 $\\sigma(E)$ 视为仅在一组有限的、非均匀的列表能量节点 $\\{E_i\\}_{i=0}^{N}$ 及其对应值 $\\{\\sigma_i\\}_{i=0}^{N}$ 上已知，并通过对 $E$ 进行分段线性插值来评估非网格点上的 $\\sigma$；在列表范围之外，通过最近邻点外插到最接近的列表端点来定义 $\\sigma(E)$。\n\n您还必须为高斯-拉盖尔求积提供一个数值误差估计。为此，请使用两种不同数量的求积节点计算近似值，并将这两个近似值之间的绝对差作为由求积和插值引起的总数值误差的估计。对于下面的测试套件案例，还需通过与从相同基本出发点和给定的 $\\sigma(E)$ 模型推导出的解析参考解进行比较，来提供真实的绝对误差。\n\n物理单位和常数：\n- 使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ J/K。\n- 能量 $E$ 的单位必须是焦耳 (J)，截面 $\\sigma$ 的单位是平方米 (m$^2$)，约化质量 $\\mu$ 的单位是千克 (kg)，温度 $T$ 的单位是开尔文 (K)，速率系数 $k(T)$ 的单位是立方米/秒 (m$^3$/s)。\n- 以 m$^3$/s 为单位表示最终的 $k(T)$ 值和误差估计。将报告的每个浮点数四舍五入到六位有效数字。\n\n高斯-拉盖尔求积：\n- 对 $\\int_{0}^{\\infty} f(x) \\mathrm{e}^{-x} \\,\\mathrm{d}x$ 使用标准的高斯-拉盖尔法则，其中有 $n$ 个节点 $\\{x_j, w_j\\}_{j=1}^{n}$，$x_j$ 是节点，$w_j$ 是权重。\n- 调整您的被积函数，以便能量空间中的玻尔兹曼权重被吸收到拉盖尔权重 $\\mathrm{e}^{-x}$ 中。\n- 使用两种节点数 $n \\in \\{32, 64\\}$；使用 $n=64$ 和 $n=32$ 的结果之差作为估计的数值误差。\n\n$\\sigma(E)$ 的插值：\n- 在列表化的非均匀网格 $\\{(E_i,\\sigma_i)\\}$ 上使用分段线性插值来评估求积所需的能量点上的 $\\sigma$。\n- 对于小于最小列表能量 $E_i$ 的 $E$，使用 $\\sigma(E) = \\sigma_0$（第一个列表值）。对于大于最大列表能量 $E_i$ 的 $E$，使用 $\\sigma(E) = \\sigma_N$（最后一个列表值）。\n\n测试套件：\n为以下三种情况实施您的算法。对于每种情况，按规定构建列表化的非均匀网格，在网格节点上评估模型 $\\sigma(E)$ 以形成列表数据，然后使用具有 $n=32$ 和 $n=64$ 个节点的高斯-拉盖尔求积，通过列表数据的线性插值来计算 $k(T)$。对于每种情况，还需计算由模型 $\\sigma(E)$ 隐含的解析参考解 $k_{\\mathrm{ref}}(T)$，并报告真实绝对误差，即 $n=64$ 的结果与解析参考解之间的绝对差。\n\n所有情况通用的常数：\n- 使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ J/K。\n- 使用转换关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n情况 A（恒定截面）：\n- 参数：$\\mu = 1.0 \\times 10^{-26}$ kg, $T = 500$ K, $\\sigma_0 = 2.0 \\times 10^{-19}$ m$^2$。\n- 模型：对于所有 $E \\ge 0$，$\\sigma(E) = \\sigma_0$。\n- 列表网格：$N = 120$, $E_{\\max} = 60\\,k_{\\mathrm{B}} T$, $E_i = E_{\\max} \\left(\\frac{i}{N}\\right)^2$ for $i=0,1,\\dots,N$, $\\sigma_i = \\sigma_0$。\n- 解析参考解：推导恒定 $\\sigma(E)$ 的 $k_{\\mathrm{ref}}(T)$。\n\n情况 B（阈值阶跃截面）：\n- 参数：$\\mu = 5.0 \\times 10^{-26}$ kg, $T = 1000$ K, $\\sigma_1 = 5.0 \\times 10^{-20}$ m$^2$, $E_0 = 0.1$ eV。\n- 模型：对于 $0 \\le E  E_0$，$\\sigma(E) = 0$；对于 $E \\ge E_0$，$\\sigma(E) = \\sigma_1$。\n- 列表网格：令 $E_{\\max} = 80\\,k_{\\mathrm{B}} T$。构建并合并两个非均匀分段：\n  1. 低能分段：$N_{\\mathrm{low}} = 160$, $E^{\\mathrm{low}}_i = 2 E_0 \\left(\\frac{i}{N_{\\mathrm{low}}}\\right)^2$, $i=0,1,\\dots,N_{\\mathrm{low}}$。\n  2. 高能分段：$N_{\\mathrm{high}} = 160$, $E^{\\mathrm{high}}_j = 2 E_0 + (E_{\\max} - 2 E_0) \\left(\\frac{j}{N_{\\mathrm{high}}}\\right)^{1/2}$, $j=0,1,\\dots,N_{\\mathrm{high}}$。\n  将它们连接、升序排序并移除重复项以形成 $\\{E_i\\}_{i=0}^{N}$。然后根据模型设置 $\\sigma_i$。\n- 解析参考解：推导此阶跃函数 $\\sigma(E)$ 的 $k_{\\mathrm{ref}}(T)$。\n\n情况 C（参考能量标度的幂律截面）：\n- 参数：$\\mu = 3.347 \\times 10^{-27}$ kg, $T = 300$ K, $\\sigma_{\\mathrm{ref}} = 1.0 \\times 10^{-20}$ m$^2$, $E_{\\mathrm{ref}} = 1.0$ eV, 指数 $m = 0.5$。\n- 模型：对于 $E \\ge 0$，$\\sigma(E) = \\sigma_{\\mathrm{ref}} \\left(\\frac{E}{E_{\\mathrm{ref}}}\\right)^m$。\n- 列表网格：$N = 150$, $E_{\\max} = 70\\,k_{\\mathrm{B}} T$, $E_i = E_{\\max} \\left(\\frac{i}{N}\\right)^3$ for $i=0,1,\\dots,N$, $\\sigma_i = \\sigma(E_i)$。\n- 解析参考解：使用适当的伽马函数推导此幂律 $\\sigma(E)$ 的 $k_{\\mathrm{ref}}(T)$。\n\n程序要求：\n- 在无量纲变量 $x = E/(k_{\\mathrm{B}} T)$ 中实现高斯-拉盖尔求积，使用权重为 $\\mathrm{e}^{-x}$ 的标准节点和权重。\n- 对于每种情况，计算并报告三个值，为四舍五入到六位有效数字的浮点数：\n  1. $k(T)$ 的 $n=64$ 高斯-拉盖尔估计值，单位为 m$^3$/s。\n  2. 估计的数值误差，单位为 m$^3$/s，通过 $n=64$ 和 $n=32$ 估计值之间的绝对差获得。\n  3. 真实的绝对误差，单位为 m$^3$/s，通过 $n=64$ 估计值与解析参考解 $k_{\\mathrm{ref}}(T)$ 之间的绝对差获得。\n- 您的程序应生成单行输出，包含三个案例的结果，形式为一个包含三个列表的逗号分隔列表，每个内部列表包含上述三个浮点数，全部用方括号括起来。例如：\"[[kA,errA,absErrA],[kB,errB,absErrB],[kC,errC,absErrC]]\"。", "solution": "提出的问题是使用高斯-拉盖尔求积法，根据一个列表化的、依赖于能量的反应截面 $\\sigma(E)$，来计算热双分子速率系数 $k(T)$。该问题在化学和数学上都定义明确，提供了所有必要的参数和清晰的计算目标。它在科学上是合理的且内部一致。因此，我们着手进行推导和求解。\n\n在温度为 $T$ 的热平衡系统中，物种之间双分子反应的热速率系数 $k(T)$ 定义为相对速度 $v$ 与反应截面 $\\sigma(v)$ 的乘积在相对速度的麦克斯韦-玻尔兹曼分布上的平均值。对于一个约化质量为 $\\mu$ 的系统，其归一化的相对速度 $v$ 的分布由下式给出：\n$$ P(v)dv = \\left(\\frac{\\mu}{2 \\pi k_{\\mathrm{B}} T}\\right)^{3/2} e^{-\\frac{\\mu v^2}{2 k_{\\mathrm{B}} T}} 4 \\pi v^2 dv $$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。速率系数是期望值 $\\langle v \\sigma(v) \\rangle$：\n$$ k(T) = \\int_{0}^{\\infty} v \\sigma(v) P(v) dv = 4 \\pi \\left(\\frac{\\mu}{2 \\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\int_{0}^{\\infty} \\sigma(v) v^3 e^{-\\frac{\\mu v^2}{2 k_{\\mathrm{B}} T}} dv $$\n为了将此积分转换到能量域，我们使用相对动能 $E$ 和相对速度 $v$ 之间的关系：$E = \\frac{1}{2} \\mu v^2$。这给出 $v = \\sqrt{2E/\\mu}$ 和 $dv = (1/\\sqrt{2\\mu E}) dE$。从 $v$ 到 $E$ 进行变量替换，得到以能量依赖截面 $\\sigma(E)$ 表示的速率系数的标准公式：\n$$ k(T) = \\sqrt{\\frac{8}{\\pi\\mu(k_{\\mathrm{B}}T)^3}} \\int_{0}^{\\infty} \\sigma(E) E e^{-E/k_{\\mathrm{B}}T} dE $$\n为了应用近似于 $\\int_0^\\infty f(x) e^{-x} dx$ 形式积分的高斯-拉盖尔求积法，我们引入无量纲能量变量 $x = E/(k_{\\mathrm{B}}T)$。因此，$E = x k_{\\mathrm{B}}T$ 且 $dE = k_{\\mathrm{B}}T dx$。将这些代入 $k(T)$ 的积分中：\n$$ k(T) = \\sqrt{\\frac{8}{\\pi\\mu(k_{\\mathrm{B}}T)^3}} \\int_{0}^{\\infty} \\sigma(x k_{\\mathrm{B}}T) (x k_{\\mathrm{B}}T) e^{-x} (k_{\\mathrm{B}}T dx) $$\n简化常数后，得到一个形式，其中玻尔兹曼权重被吸收到标准拉盖尔权重 $e^{-x}$ 中：\n$$ k(T) = \\sqrt{\\frac{8 k_{\\mathrm{B}}T}{\\pi\\mu}} \\int_{0}^{\\infty} x \\sigma(x k_{\\mathrm{B}}T) e^{-x} dx $$\n前置因子 $\\sqrt{8 k_{\\mathrm{B}}T / (\\pi\\mu)}$ 是平均相对速度 $\\bar{v}$。该积分现在是高斯-拉盖尔求积所需的形式 $\\int_0^\\infty g(x) e^{-x} dx$，其中被积函数是 $g(x) = x \\sigma(x k_{\\mathrm{B}}T)$。\n积分的 $n$ 点高斯-拉盖尔求积近似为：\n$$ \\int_{0}^{\\infty} g(x) e^{-x} dx \\approx \\sum_{j=1}^{n} w_j g(x_j) $$\n其中 $\\{x_j\\}$ 是拉盖尔​​多项式 $L_n(x)$ 的根，$\\{w_j\\}$ 是相应的权重。因此，速率系数的数值近似值 $k_n(T)$ 为：\n$$ k_n(T) = \\sqrt{\\frac{8 k_{\\mathrm{B}}T}{\\pi\\mu}} \\sum_{j=1}^{n} w_j x_j \\sigma(x_j k_{\\mathrm{B}}T) $$\n截面 $\\sigma(E)$ 必须在求积能量节点 $E_j = x_j k_{\\mathrm{B}}T$ 处进行评估。由于 $\\sigma(E)$ 以表格 $(E_i, \\sigma_i)$ 的形式提供，我们对表格范围内的能量使用分段线性插值，对范围外的能量使用最近邻点外插。\n\n数值误差通过计算使用 $n=64$ 和 $n=32$ 个节点的近似值之差来估计：$\\Delta k_{\\mathrm{est}} = |k_{64}(T) - k_{32}(T)|$。真实绝对误差需要与解析参考解进行比较，$\\Delta k_{\\mathrm{true}} = |k_{64}(T) - k_{\\mathrm{ref}}(T)|$，该参考解是为每个模型截面推导的。\n\n解析参考解：\n\n情况 A：恒定截面, $\\sigma(E) = \\sigma_0$。\n积分变为 $\\int_0^\\infty x \\sigma_0 e^{-x} dx = \\sigma_0 \\int_0^\\infty x e^{-x} dx = \\sigma_0 \\Gamma(2) = \\sigma_0$。\n$$ k_{\\mathrm{ref,A}}(T) = \\sqrt{\\frac{8 k_{\\mathrm{B}}T}{\\pi\\mu}} \\sigma_0 $$\n\n情况 B：阈值阶跃截面，当 $E  E_0$ 时 $\\sigma(E) = 0$，当 $E \\ge E_0$ 时 $\\sigma(E) = \\sigma_1$。\n条件 $E \\ge E_0$ 对应于 $x \\ge E_0/(k_{\\mathrm{B}}T)$。设 $x_0 = E_0/(k_{\\mathrm{B}}T)$。积分为 $\\sigma_1 \\int_{x_0}^\\infty x e^{-x} dx$。此积分的计算结果为 $\\sigma_1 (x_0+1)e^{-x_0}$。\n$$ k_{\\mathrm{ref,B}}(T) = \\sqrt{\\frac{8 k_{\\mathrm{B}}T}{\\pi\\mu}} \\sigma_1 \\left(1 + \\frac{E_0}{k_{\\mathrm{B}}T}\\right) e^{-E_0/k_{\\mathrm{B}}T} $$\n\n情况 C：幂律截面, $\\sigma(E) = \\sigma_{\\mathrm{ref}} (E/E_{\\mathrm{ref}})^m$。\n被积函数为 $g(x) = x \\sigma_{\\mathrm{ref}} (x k_{\\mathrm{B}}T / E_{\\mathrm{ref}})^m = x^{1+m} \\sigma_{\\mathrm{ref}} (k_{\\mathrm{B}}T/E_{\\mathrm{ref}})^m$。积分为 $\\sigma_{\\mathrm{ref}} (k_{\\mathrm{B}}T / E_{\\mathrm{ref}})^m \\int_0^\\infty x^{1+m} e^{-x} dx = \\sigma_{\\mathrm{ref}} (k_{\\mathrm{B}}T / E_{\\mathrm{ref}})^m \\Gamma(2+m)$。\n$$ k_{\\mathrm{ref,C}}(T) = \\sqrt{\\frac{8 k_{\\mathrm{B}}T}{\\pi\\mu}} \\sigma_{\\mathrm{ref}} \\left(\\frac{k_{\\mathrm{B}}T}{E_{\\mathrm{ref}}}\\right)^m \\Gamma(2+m) $$\n对于 $m=0.5$，我们有 $\\Gamma(2.5) = \\frac{3}{4}\\sqrt{\\pi}$。\n\n所实现的算法按以下步骤进行：对于每种情况，生成指定的能量网格和相应的截面值。定义一个利用 `numpy.interp` 的函数来评估任意能量下的 $\\sigma(E)$。对 $n=32$ 和 $n=64$ 个节点执行高斯-拉盖尔求积，以计算 $k_{32}(T)$ 和 $k_{64}(T)$。计算解析参考解 $k_{\\mathrm{ref}}(T)$。最后，计算并报告所需的量——$k_{64}(T)$、估计误差 $|k_{64}(T)-k_{32}(T)|$ 和真实误差 $|k_{64}(T)-k_{\\mathrm{ref}}(T)|$。", "answer": "[[2.34057e-16,3.46945e-21,1.01121e-21],[1.00392e-16,2.02969e-21,4.64654e-19],[2.55167e-16,1.09673e-20,1.40871e-18]]", "id": "2667912"}]}