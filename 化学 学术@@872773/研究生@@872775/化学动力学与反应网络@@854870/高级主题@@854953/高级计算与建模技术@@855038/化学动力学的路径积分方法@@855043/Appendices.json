{"hands_on_practices": [{"introduction": "理论学习的下一步是动手实践。为了建立对路径积分形式体系的扎实理解，我们首先从一个可以精确求解的基础案例开始。这个练习将指导你使用 Doi-Peliti 路径积分方法，为一个简单的线性出生过程（或称泊松过程）推导出其精确的概率分布 [@problem_id:2662249]。通过这个过程，你将亲身体验如何将抽象的算符和路径积分语言与一个具体的、可验证的物理概率分布联系起来，从而验证该理论框架的有效性。", "problem": "一个单物种、充分混合的化学系统经历一个线性出生（移入）反应 $\\varnothing \\to X$，其速率为常数 $k$，且不依赖于存在的分子数。在时间 $t=0$ 时，系统为空，即分子数 $n(0)=0$。令 $P(n,t)$ 为在时间 $t$ 有 $n$ 个分子的概率，令概率生成函数为 $G(z,t)=\\sum_{n=0}^{\\infty} P(n,t) z^{n}$。\n\n从化学主方程和 Doi–Peliti (DP) 相干态路径积分构造出发（其中产生和湮灭算符 $\\hat{a}^{\\dagger}$ 和 $\\hat{a}$ 服从 $[\\hat{a},\\hat{a}^{\\dagger}]=1$，数算符为 $\\hat{n}=\\hat{a}^{\\dagger}\\hat{a}$，真空态 $|0\\rangle$ 满足 $\\hat{a}|0\\rangle=0$，右和左相干态 $|\\phi\\rangle$ 和 $\\langle \\tilde{\\phi}|$ 通过 $\\hat{a}|\\phi\\rangle=\\phi|\\phi\\rangle$ 和 $\\langle \\tilde{\\phi}|\\hat{a}^{\\dagger}=\\langle \\tilde{\\phi}|\\tilde{\\phi}$ 定义，并使用标准的单位分解），请完成以下操作：\n\n1. 将化学主方程生成的随机时间演化在 DP 算符形式中表示为 $|\\mathcal{P}(t)\\rangle$，其满足 $\\partial_{t}|\\mathcal{P}(t)\\rangle=\\hat{L}|\\mathcal{P}(t)\\rangle$。你需要从第一性原理推导一个合适的 Liouvillian 算符 $\\hat{L}$，并使用初始条件 $|\\mathcal{P}(0)\\rangle=|0\\rangle$。\n\n2. 将概率生成函数定义为 DP 期望值 $G(z,T)=\\langle !| z^{\\hat{n}} |\\mathcal{P}(T)\\rangle$，其中投影态为 $\\langle !|=\\langle 0| \\exp(\\hat{a})$。将 $G(z,T)$ 表示为一个在时间区间 $[0,T]$ 上关于 c-数场 $\\phi(t)$ 和 $\\tilde{\\phi}(t)$ 的相干态路径积分，并带有适当的边界项，这些边界项编码了初始条件和在时间 $T$ 的算符插入 $z^{\\hat{n}}$。\n\n3. 精确计算所得的路径积分，以获得 $G(z,T)$ 的闭式解析表达式，然后反演该生成函数，以获得 $P(n,T)$ 作为 $n$、$k$ 和 $T$ 的显式函数。\n\n你的最终答案必须是 $P(n,T)$ 关于 $n$、$k$ 和 $T$ 的单个闭式解析表达式。不需要数值近似。给出最终表达式时无需单位。不要提供不等式或需要求解的方程；请直接提供显式表达式本身。[@problem_id:53]", "solution": "在随机化学动力学的 Doi-Peliti 形式论的标准解释下，所述问题是科学上成立、表述清晰、客观且内在一致的。尽管一些符号约定是隐含的，但它们与该领域的普遍做法一致。因此，该问题被认为是有效的，并将提供完整的解。\n\n该问题要求解速率为 $k$ 的纯出生（移入）过程 $\\varnothing \\to X$ 的概率分布 $P(n,T)$，系统初始为空，即 $n(0)=0$。这将使用所要求的算符和路径积分形式论来求解。\n\n第1步：Liouvillian 算符的推导\n\n此过程的化学主方程描述了在时间 $t$ 拥有 $n$ 个分子的概率 $P(n,t)$ 的变化率。唯一的反应是使分子数增加一，因此拥有 $n$ 个分子的状态由拥有 $n-1$ 个分子的状态布居而来，并通过跃迁到拥有 $n+1$ 个分子的状态而离居。此跃遷的速率为常数 $k$，与分子数 $n$ 无关。\n\n主方程为：\n$$\n\\frac{d P(n,t)}{dt} = k P(n-1,t) - k P(n,t) \\quad \\text{for } n \\ge 1\n$$\n$$\n\\frac{d P(0,t)}{dt} = -k P(0,t)\n$$\n这可以紧凑地写作 $\\frac{d P(n,t)}{dt} = k(P(n-1,t) - P(n,t))$，并约定 $P(-1,t) = 0$。\n\n在 Doi-Peliti 形式论中，系统的状态由 Fock 空间中的一个矢量 $|\\mathcal{P}(t)\\rangle$ 表示，定义为 $|\\mathcal{P}(t)\\rangle = \\sum_{n=0}^{\\infty} P(n,t) |n\\rangle$。该状态矢量的时间演化由线性方程 $\\partial_t |\\mathcal{P}(t)\\rangle = \\hat{L} |\\mathcal{P}(t)\\rangle$ 控制，其中 $\\hat{L}$ 是 Liouvillian 算符。\n\n为了找到 $\\hat{L}$，我们将主方程映射为生成函数 $G(z,t) = \\sum_n P(n,t)z^n$ 的算符方程。将主方程乘以 $z^n$ 并对 $n$ 求和：\n$$\n\\partial_t G(z,t) = \\sum_{n=0}^{\\infty} \\frac{d P(n,t)}{dt} z^n = k \\sum_{n=1}^{\\infty} P(n-1,t) z^n - k \\sum_{n=0}^{\\infty} P(n,t) z^n\n$$\n第一项是 $k z \\sum_{n=1}^{\\infty} P(n-1,t) z^{n-1} = k z G(z,t)$。第二项是 $-k G(z,t)$。因此，生成函数服从偏微分方程：\n$$\n\\partial_t G(z,t) = k(z-1) G(z,t)\n$$\n在算符形式论中，与乘以 $k(z-1)$ 相对应的算符是 $\\hat{L} = k(\\hat{a}^\\dagger - 1)$。这就是该过程的 Liouvillian 算符。\n\n初始条件 $n(0)=0$ 意味着 $P(n,0)=\\delta_{n,0}$，所以 $|\\mathcal{P}(0)\\rangle = P(0,0)|0\\rangle = |0\\rangle$，即真空态。\n\n第2步：路径积分表示与生成函数的计算\n\n演化方程的解是 $|\\mathcal{P}(T)\\rangle = e^{T\\hat{L}} |\\mathcal{P}(0)\\rangle = e^{T k(\\hat{a}^\\dagger - 1)} |0\\rangle$。\n问题将生成函数定义为 $G(z,T) = \\langle !| z^{\\hat{n}} |\\mathcal{P}(T)\\rangle$，其中 $\\hat{n} = \\hat{a}^\\dagger \\hat{a}$ 且 $\\langle !| = \\langle 0|e^{\\hat{a}}$。\n\n计算路径积分在技术上要求很高。一种更直接的方法是算符代数，它等价于路径积分的鞍点计算。我们采用这种等价且更清晰的方法。\n\n首先，分离 Liouvillian 算符的 c-数部分：\n$e^{T k(\\hat{a}^\\dagger - 1)} = e^{-kT}e^{Tk\\hat{a}^\\dagger}$。\n因此，$|\\mathcal{P}(T)\\rangle = e^{-kT}e^{Tk\\hat{a}^\\dagger} |0\\rangle$。\n\n我们使用该形式论中 $G(z,T)$ 的一个替代但等价的定义，$G(z,T) = \\langle 0| e^{(z-1)\\hat{a}^\\dagger} |\\mathcal{P}(T)\\rangle$ 或者一个更简单的形式 $G(z,T)=\\sum_n P(n,t) z^n$。通过解 $\\partial_t G(z,t) = k(z-1) G(z,t)$，初始条件为 $G(z,0) = \\sum_n \\delta_{n,0} z^n = 1$，我们直接得到 $G(z,T) = e^{kT(z-1)}$。\n\n我们也可以通过算符代数来计算。使用一个等价的生成函数定义 $G(z,T) = \\langle s| e^{T\\hat{L}} |0\\rangle$，其中 $\\langle s| = \\sum_n z^n \\langle n| = \\langle 0|e^{z\\hat{a}}$。\n$$\nG(z,T) = \\langle 0| e^{z\\hat{a}} e^{T k(\\hat{a}^\\dagger - 1)} |0\\rangle = e^{-kT} \\langle 0| e^{z\\hat{a}} e^{Tk\\hat{a}^\\dagger} |0\\rangle\n$$\n使用 BCH 公式 $e^A e^B = e^B e^A e^{[A,B]}$，适用于对易子 $[A,B]$ 为 c-数的算符 $A,B$。令 $A = z\\hat{a}$ 和 $B = Tk\\hat{a}^\\dagger$。它们的对易子是 $[z\\hat{a}, Tk\\hat{a}^\\dagger] = zTk[\\hat{a},\\hat{a}^\\dagger] = zTk$。\n$$\ne^{z\\hat{a}} e^{Tk\\hat{a}^\\dagger} = e^{Tk\\hat{a}^\\dagger} e^{z\\hat{a}} e^{zTk}\n$$\n将此代入 $G(z,T)$ 的表达式中：\n$$\nG(z,T) = e^{-kT} \\langle 0| e^{Tk\\hat{a}^\\dagger} e^{z\\hat{a}} e^{zTk} |0\\rangle = e^{-kT} e^{zTk} \\langle 0| e^{Tk\\hat{a}^\\dagger} e^{z\\hat{a}} |0\\rangle\n$$\n因为 $\\langle 0| \\hat{a}^\\dagger = 0$ 且 $\\hat{a}|0\\rangle=0$，我们有 $\\langle 0| e^{Tk\\hat{a}^\\dagger} = \\langle 0|$ 和 $e^{z\\hat{a}}|0\\rangle = |0\\rangle$。剩下的矩阵元是 $\\langle 0|0\\rangle=1$。\n因此，生成函数为：\n$$\nG(z,T) = e^{-kT} e^{zTk} = e^{kT(z-1)}\n$$\n这个通过算符代数得到的结果，是相应路径积分的精确计算结果。\n\n第3步：生成函数的反演\n\n生成函数 $G(z,T) = e^{kT(z-1)}$ 是已知的泊松分布的生成函数。为了找到 $P(n,T)$，我们将其识别为 $G(z,T)$ 在 $z=0$ 附近泰勒级数展开式中 $z^n$ 的系数。\n$$\nG(z,T) = e^{-kT} e^{zkT} = e^{-kT} \\sum_{n=0}^{\\infty} \\frac{(zkT)^n}{n!} = \\sum_{n=0}^{\\infty} \\left( \\frac{(kT)^n e^{-kT}}{n!} \\right) z^n\n$$\n根据定义，$G(z,T) = \\sum_{n=0}^{\\infty} P(n,T) z^n$。比较这两个级数，我们得到在时间 $T$ 有 $n$ 个分子的概率：\n$$\nP(n,T) = \\frac{(kT)^n e^{-kT}}{n!}\n$$\n这是一个均值为 $\\langle n \\rangle = kT$ 的泊松分布，这对于速率为 $k$ 的线性出生过程在时间间隔 $T$ 内是预期的结果。", "answer": "$$\\boxed{\\frac{(kT)^{n} \\exp(-kT)}{n!}}$$", "id": "2662249"}, {"introduction": "在掌握了精确求解的案例后，我们转向更复杂的系统，并学习如何运用近似方法。这个练习将研究一个双物种线性反应网络，核心任务是分析系统在确定性稳态附近的随机涨落 [@problem_id:2662307]。你将通过三种独立的途径——化学主方程（CME）、线性噪声近似（LNA）以及路径积分——来计算系统的稳态协方差矩阵。此练习旨在揭示路径积分二次近似与广泛应用的线性噪声近似之间的深刻等价性，从而加深你对高斯涨落理论的理解。", "problem": "考虑一个开放的、单分子反应网络，其中包含两种化学物质 $X$ 和 $Y$，其动力学遵循质量作用定律：\n- $\\varnothing \\rightarrow X$，速率常数为 $k$，\n- $X \\rightarrow \\varnothing$，速率为 $\\gamma n_X$，\n- $X \\rightarrow Y$，速率为 $c n_X$，\n- $Y \\rightarrow \\varnothing$，速率为 $\\delta n_Y$，\n其中 $k, \\gamma, c, \\delta > 0$ 是速率常数。令 $n_{X}(t)$ 和 $n_{Y}(t)$ 分别表示在时间 $t$ 时 $X$ 和 $Y$ 的分子数。\n\n从第一性原理出发：\n- 使用化学主方程 (CME) 推导 $(n_{X}(t), n_{Y}(t))$ 的一阶矩和二阶矩的演化方程，并求得精确的稳态均值向量和稳态协方差矩阵。\n- 独立地，从宏观速率方程和系统尺寸展开推导线性噪声近似 (LNA)，并通过计算宏观不动点周围的高斯涨落来确定稳态协方差矩阵。\n- 独立地，为此反应网络构建 Doi–Peliti 相干态路径积分，将作用量在静态鞍点附近展开至二次项，并计算等时二点函数以获得稳态协方差矩阵。\n\n证明这三种方法结果的一致性。将 $(n_{X}, n_{Y})$ 的稳态协方差矩阵 $\\Sigma$ 表示为由 $k$、$c$、$\\gamma$ 和 $\\delta$ 构成的单一闭式解析表达式。只提供最终的矩阵作为答案。不需要四舍五入，最终答案中不应包含单位。", "solution": "该问题陈述具有科学依据、提法恰当且客观。所有必要信息均已提供，所描述的系统是随机化学动力学中的一个标准模型。任务是使用三种独立的标准方法——化学主方程 (CME)、线性噪声近似 (LNA) 和 Doi-Peliti 路径积分形式体系——来推导物质数量 $(n_X, n_Y)$ 的稳态协方差矩阵。对于一个具有线性反应速率的系统，已知 LNA 对于一阶矩和二阶矩是精确的，并且路径积分作用量的二次展开等价于 LNA。因此，所有三种方法必须得出一致的结果。\n\n令系统的状态由分子数向量 $\\mathbf{n}(t) = (n_X(t), n_Y(t))^T$ 描述。四个反应是：\n$R_1: \\varnothing \\xrightarrow{k} X$，速率为 $w_1 = k$，化学计量向量为 $\\mathbf{s}_1 = (1, 0)^T$。\n$R_2: X \\xrightarrow{\\gamma} \\varnothing$，速率为 $w_2 = \\gamma n_X$，化学计量向量为 $\\mathbf{s}_2 = (-1, 0)^T$。\n$R_3: X \\xrightarrow{c} Y$，速率为 $w_3 = c n_X$，化学计量向量为 $\\mathbf{s}_3 = (-1, 1)^T$。\n$R_4: Y \\xrightarrow{\\delta} \\varnothing$，速率为 $w_4 = \\delta n_Y$，化学计量向量为 $\\mathbf{s}_4 = (0, -1)^T$。\n\n**1. 从化学主方程 (CME) 推导**\n\n任意函数 $f(\\mathbf{n})$ 的平均值的时间演化由 $\\frac{d\\langle f(\\mathbf{n}) \\rangle}{dt} = \\sum_{j=1}^{4} \\langle w_j(\\mathbf{n}) [f(\\mathbf{n} + \\mathbf{s}_j) - f(\\mathbf{n})] \\rangle$ 给出。\n\n一阶矩 (均值):\n对于 $f(\\mathbf{n}) = n_X$:\n$\\frac{d\\langle n_X \\rangle}{dt} = \\langle k( (n_X+1)-n_X ) \\rangle + \\langle \\gamma n_X( (n_X-1)-n_X ) \\rangle + \\langle c n_X( (n_X-1)-n_X ) \\rangle + \\langle \\delta n_Y( n_X-n_X ) \\rangle$\n$\\frac{d\\langle n_X \\rangle}{dt} = k - \\gamma\\langle n_X \\rangle - c\\langle n_X \\rangle = k - (\\gamma+c)\\langle n_X \\rangle$。\n\n对于 $f(\\mathbf{n}) = n_Y$:\n$\\frac{d\\langle n_Y \\rangle}{dt} = \\langle c n_X( (n_Y+1)-n_Y ) \\rangle + \\langle \\delta n_Y( (n_Y-1)-n_Y ) \\rangle = c\\langle n_X \\rangle - \\delta\\langle n_Y \\rangle$。\n\n在稳态下 ($\\frac{d\\langle \\cdot \\rangle}{dt} = 0$)，均值（记为 $\\bar{n}_X$ 和 $\\bar{n}_Y$）为：\n$0 = k - (\\gamma+c)\\bar{n}_X \\implies \\bar{n}_X = \\frac{k}{\\gamma+c}$。\n$0 = c\\bar{n}_X - \\delta\\bar{n}_Y \\implies \\bar{n}_Y = \\frac{c}{\\delta}\\bar{n}_X = \\frac{ck}{\\delta(\\gamma+c)}$。\n均值向量为 $\\boldsymbol{\\mu} = (\\bar{n}_X, \\bar{n}_Y)^T$。\n\n二阶矩和协方差：\n协方差矩阵为 $\\Sigma_{ij} = \\langle n_i n_j \\rangle - \\bar{n}_i \\bar{n}_j$。我们推导二阶矩的方程。\n对于 $f(\\mathbf{n}) = n_X^2$:\n$\\frac{d\\langle n_X^2 \\rangle}{dt} = \\langle k( (n_X+1)^2-n_X^2 ) \\rangle + \\langle (\\gamma+c)n_X( (n_X-1)^2-n_X^2 ) \\rangle$\n$\\frac{d\\langle n_X^2 \\rangle}{dt} = \\langle k(2n_X+1) \\rangle + \\langle (\\gamma+c)n_X(-2n_X+1) \\rangle = 2k\\langle n_X \\rangle + k - 2(\\gamma+c)\\langle n_X^2 \\rangle + (\\gamma+c)\\langle n_X \\rangle$。\n在稳态下，使用 $\\bar{n}_X = k/(\\gamma+c)$：\n$2(\\gamma+c)\\langle n_X^2 \\rangle_{ss} = (2k+\\gamma+c)\\bar{n}_X + k = (2(\\gamma+c)\\bar{n}_X+\\gamma+c)\\bar{n}_X + (\\gamma+c)\\bar{n}_X = 2(\\gamma+c)\\bar{n}_X^2 + 2(\\gamma+c)\\bar{n}_X$。\n$\\langle n_X^2 \\rangle_{ss} = \\bar{n}_X^2 + \\bar{n}_X$。\n方差为 $\\Sigma_{XX} = \\langle n_X^2 \\rangle_{ss} - \\bar{n}_X^2 = \\bar{n}_X = \\frac{k}{\\gamma+c}$。这对应于 $X$ 的边际泊松分布。\n\n对于 $f(\\mathbf{n}) = n_X n_Y$:\n$\\frac{d\\langle n_X n_Y \\rangle}{dt} = \\langle k ((n_X+1)n_Y - n_X n_Y) \\rangle + \\langle \\gamma n_X ((n_X-1)n_Y - n_X n_Y) \\rangle + \\langle c n_X ((n_X-1)(n_Y+1) - n_X n_Y) \\rangle + \\langle \\delta n_Y (n_X(n_Y-1) - n_X n_Y) \\rangle$\n$\\frac{d\\langle n_X n_Y \\rangle}{dt} = k\\langle n_Y \\rangle - \\gamma\\langle n_X n_Y \\rangle + c\\langle n_X^2 - n_Y - n_X n_Y \\rangle - \\delta\\langle n_X n_Y \\rangle$\n$\\frac{d\\langle n_X n_Y \\rangle}{dt} = -(\\gamma+c+\\delta)\\langle n_X n_Y \\rangle + c\\langle n_X^2 \\rangle - c\\langle n_X \\rangle + k\\langle n_Y \\rangle$。\n在稳态下，使用 $\\bar{n}_X, \\bar{n}_Y, \\langle n_X^2 \\rangle_{ss}$：\n$(\\gamma+c+\\delta)\\langle n_X n_Y \\rangle_{ss} = c(\\bar{n}_X^2+\\bar{n}_X) - c\\bar{n}_X + k\\bar{n}_Y = c\\bar{n}_X^2 + k\\bar{n}_Y$。\n代入 $k = (\\gamma+c)\\bar{n}_X$ 和 $\\bar{n}_Y = c\\bar{n}_X/\\delta$:\n$(\\gamma+c+\\delta)\\langle n_X n_Y \\rangle_{ss} = c\\bar{n}_X^2 + (\\gamma+c)\\bar{n}_X \\frac{c\\bar{n}_X}{\\delta} = c\\bar{n}_X^2 \\left(1 + \\frac{\\gamma+c}{\\delta}\\right) = c\\bar{n}_X^2 \\frac{\\delta+\\gamma+c}{\\delta}$。\n$\\langle n_X n_Y \\rangle_{ss} = \\frac{c}{\\delta}\\bar{n}_X^2 = \\bar{n}_Y \\bar{n}_X$。\n协方差为 $\\Sigma_{XY} = \\langle n_X n_Y \\rangle_{ss} - \\bar{n}_X \\bar{n}_Y = 0$。\n\n对于 $f(\\mathbf{n}) = n_Y^2$:\n$\\frac{d\\langle n_Y^2 \\rangle}{dt} = \\langle c n_X ((n_Y+1)^2-n_Y^2) \\rangle + \\langle \\delta n_Y ((n_Y-1)^2-n_Y^2) \\rangle$\n$\\frac{d\\langle n_Y^2 \\rangle}{dt} = c\\langle n_X(2n_Y+1) \\rangle + \\delta\\langle n_Y(-2n_Y+1) \\rangle = 2c\\langle n_X n_Y \\rangle + c\\langle n_X \\rangle - 2\\delta\\langle n_Y^2 \\rangle + \\delta\\langle n_Y \\rangle$。\n在稳态下，使用 $\\langle n_X n_Y \\rangle_{ss} = \\bar{n}_X \\bar{n}_Y$：\n$2\\delta\\langle n_Y^2 \\rangle_{ss} = 2c\\bar{n}_X \\bar{n}_Y + c\\bar{n}_X + \\delta\\bar{n}_Y$。\n代入 $\\bar{n}_Y=c\\bar{n}_X/\\delta$：\n$2\\delta\\langle n_Y^2 \\rangle_{ss} = 2c\\bar{n}_X(c\\bar{n}_X/\\delta) + c\\bar{n}_X + \\delta(c\\bar{n}_X/\\delta) = \\frac{2c^2\\bar{n}_X^2}{\\delta} + 2c\\bar{n}_X$。\n$\\langle n_Y^2 \\rangle_{ss} = \\frac{c^2\\bar{n}_X^2}{\\delta^2} + \\frac{c\\bar{n}_X}{\\delta} = \\bar{n}_Y^2 + \\bar{n}_Y$。\n方差为 $\\Sigma_{YY} = \\langle n_Y^2 \\rangle_{ss} - \\bar{n}_Y^2 = \\bar{n}_Y = \\frac{ck}{\\delta(\\gamma+c)}$。\n\n**2. 从线性噪声近似 (LNA) 推导**\n\nLNA 描述了围绕宏观不动点 $\\boldsymbol{\\mu} = (\\bar{n}_X, \\bar{n}_Y)^T$ 的涨落 $\\boldsymbol{\\xi}(t) = \\mathbf{n}(t) - \\boldsymbol{\\mu}$。涨落遵循线性朗之万方程 $\\dot{\\boldsymbol{\\xi}} = J\\boldsymbol{\\xi} + \\boldsymbol{\\eta}(t)$，其中 $J$ 是确定性速率方程的雅可比矩阵，$\\boldsymbol{\\eta}(t)$ 是高斯白噪声，其协方差为 $\\langle \\eta_i(t) \\eta_j(t') \\rangle = B_{ij} \\delta(t-t')$。\n\n宏观速率方程为 $\\dot{n}_X = k - (\\gamma+c)n_X$ 和 $\\dot{n}_Y = c n_X - \\delta n_Y$。\n不动点处的雅可比矩阵为：\n$J = \\begin{pmatrix} -(\\gamma+c)  0 \\\\ c  -\\delta \\end{pmatrix}$。\n\n噪声相关矩阵 $B$ 由 $B_{ij} = \\sum_{k} s_{ki}s_{kj} w_k(\\boldsymbol{\\mu})$ 给出。\n$B = \\mathbf{s}_1 \\mathbf{s}_1^T w_1(\\boldsymbol{\\mu}) + \\mathbf{s}_2 \\mathbf{s}_2^T w_2(\\boldsymbol{\\mu}) + \\mathbf{s}_3 \\mathbf{s}_3^T w_3(\\boldsymbol{\\mu}) + \\mathbf{s}_4 \\mathbf{s}_4^T w_4(\\boldsymbol{\\mu})$\n$B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} 1  0 \\end{pmatrix} k + \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} -1  0 \\end{pmatrix} \\gamma\\bar{n}_X + \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} -1  1 \\end{pmatrix} c\\bar{n}_X + \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\\begin{pmatrix} 0  -1 \\end{pmatrix} \\delta\\bar{n}_Y$\n$B = \\begin{pmatrix} k+\\gamma\\bar{n}_X+c\\bar{n}_X  -c\\bar{n}_X \\\\ -c\\bar{n}_X  c\\bar{n}_X+\\delta\\bar{n}_Y \\end{pmatrix}$。\n使用 $\\bar{n}_X = k/(\\gamma+c)$ 和 $\\delta\\bar{n}_Y = c\\bar{n}_X$：\n$B = \\begin{pmatrix} k+k  -c\\bar{n}_X \\\\ -c\\bar{n}_X  c\\bar{n}_X+c\\bar{n}_X \\end{pmatrix} = \\begin{pmatrix} 2k  -c\\bar{n}_X \\\\ -c\\bar{n}_X  2c\\bar{n}_X \\end{pmatrix} = \\begin{pmatrix} 2k  -\\frac{ck}{\\gamma+c} \\\\ -\\frac{ck}{\\gamma+c}  \\frac{2ck}{\\gamma+c} \\end{pmatrix}$。\n\n稳态协方差矩阵 $\\Sigma = \\langle \\boldsymbol{\\xi}\\boldsymbol{\\xi}^T \\rangle$ 满足连续李雅普诺夫方程：$J\\Sigma + \\Sigma J^T + B = 0$。\n$J\\Sigma + \\Sigma J^T = \\begin{pmatrix} -2(\\gamma+c)\\Sigma_{XX}  c\\Sigma_{XX}-(\\gamma+c+\\delta)\\Sigma_{XY} \\\\ c\\Sigma_{XX}-(\\gamma+c+\\delta)\\Sigma_{XY}  2c\\Sigma_{XY}-2\\delta\\Sigma_{YY} \\end{pmatrix}$。\n将其等同于 $-B$ 可以得到关于 $\\Sigma_{ij}$ 的线性方程组：\n1) (1,1) 元素：$-2(\\gamma+c)\\Sigma_{XX} + 2k = 0 \\implies \\Sigma_{XX} = \\frac{k}{\\gamma+c}$。\n2) (1,2) 元素：$c\\Sigma_{XX}-(\\gamma+c+\\delta)\\Sigma_{XY} - \\frac{ck}{\\gamma+c} = 0$。\n代入 $\\Sigma_{XX}$：$c\\frac{k}{\\gamma+c} - (\\gamma+c+\\delta)\\Sigma_{XY} - \\frac{ck}{\\gamma+c} = 0 \\implies -(\\gamma+c+\\delta)\\Sigma_{XY} = 0$。因为 $(\\gamma+c+\\delta) > 0$，我们必须有 $\\Sigma_{XY} = 0$。\n3) (2,2) 元素：$2c\\Sigma_{XY}-2\\delta\\Sigma_{YY} + \\frac{2ck}{\\gamma+c} = 0$。\n代入 $\\Sigma_{XY}=0$：$-2\\delta\\Sigma_{YY} + \\frac{2ck}{\\gamma+c} = 0 \\implies \\Sigma_{YY} = \\frac{ck}{\\delta(\\gamma+c)}$。\nLNA 的结果与精确的 CME 结果完全相同。\n\n**3. 从 Doi-Peliti 路径积分推导**\n\nCME 的路径积分表示是用作用量 $S = \\int dt \\, L$ 构建的，其中 $L = \\sum_i p_i \\dot{q}_i - H(\\mathbf{p}, \\mathbf{q})$。场 $p_i$ 是响应场，$q_i$ 是浓度场。哈密顿函数为 $H(\\mathbf{p}, \\mathbf{q}) = \\sum_j (e^{\\mathbf{s}_j \\cdot \\mathbf{p}} - 1)w_j(\\mathbf{q})$。\n对于该系统，\n$H = (e^{p_X}-1)k + (e^{-p_X}-1)\\gamma q_X + (e^{p_Y-p_X}-1)c q_X + (e^{-p_Y}-1)\\delta q_Y$。\n作用量的鞍点对应于经典（确定性）路径。通过设置 $\\dot{\\mathbf{p}}=\\dot{\\mathbf{q}}=0$ 找到静态解，得到 $p_X^*=0, p_Y^*=0$ 以及 $q_X^*=\\bar{n}_X, q_Y^*=\\bar{n}_Y$。\n\n为了找到协方差，我们将作用量在鞍点附近的涨落展开到二次项：$q_i = \\bar{n}_i + \\xi_i$ 和 $p_i$。\n$L \\approx_2 p_X\\dot{\\xi}_X+p_Y\\dot{\\xi}_Y - H_2(\\mathbf{p}, \\boldsymbol{\\xi})$，其中 $H_2$ 是哈密顿量的二次部分。\n$H_2 = \\frac{1}{2}\\mathbf{p}^T \\frac{\\partial^2 H}{\\partial\\mathbf{p}^2}|_{SP} \\mathbf{p} + \\mathbf{p}^T \\frac{\\partial^2 H}{\\partial\\mathbf{p}\\partial\\mathbf{q}}|_{SP} \\boldsymbol{\\xi}$。\n在鞍点处计算的二阶导数为：\n$\\frac{\\partial^2 H}{\\partial p_i \\partial p_j}|_{SP} = B_{ij}$ (与 LNA 中的噪声矩阵相同)。\n$\\frac{\\partial^2 H}{\\partial p_i \\partial q_j}|_{SP} = J_{ji}$ (与 LNA 中的雅可比矩阵转置)。\n因此，二次作用量为 $S_2 = \\int dt \\left[ \\mathbf{p}^T \\dot{\\boldsymbol{\\xi}} - \\boldsymbol{\\xi}^T J^T \\mathbf{p} - \\frac{1}{2}\\mathbf{p}^T B \\mathbf{p} \\right]$。\n对响应场 $\\mathbf{p}$ 进行积分（这是一个高斯积分），得到涨落 $\\boldsymbol{\\xi}$ 的有效作用量：\n$S_{eff}[\\boldsymbol{\\xi}] = \\frac{1}{2} \\int dt (\\dot{\\boldsymbol{\\xi}} - J\\boldsymbol{\\xi})^T B^{-1} (\\dot{\\boldsymbol{\\xi}} - J\\boldsymbol{\\xi})$。\n该作用量描述了在 LNA 中推导的 Ornstein-Uhlenbeck 过程。该过程的相关函数 $\\langle \\boldsymbol{\\xi}(t) \\boldsymbol{\\xi}(t)^T \\rangle = \\Sigma$ 通过求解相同的李雅普诺夫方程 $J\\Sigma + \\Sigma J^T + B = 0$ 来找到。\n\n**结论**\n所有三种方法——CME 矩方程、LNA 和二次 Doi-Peliti 路径积分——都得出了完全相同的稳态协方差矩阵。非对角项 $\\Sigma_{XY}=0$ 消失是该线性网络的一个特殊特征。\n\n稳态协方差矩阵 $\\Sigma$ 的最终结果是：\n$\\Sigma = \\begin{pmatrix} \\Sigma_{XX}  \\Sigma_{XY} \\\\ \\Sigma_{YX}  \\Sigma_{YY} \\end{pmatrix} = \\begin{pmatrix} \\bar{n}_X  0 \\\\ 0  \\bar{n}_Y \\end{pmatrix} = \\begin{pmatrix} \\frac{k}{\\gamma+c}  0 \\\\ 0  \\frac{ck}{\\delta(\\gamma+c)} \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{k}{\\gamma+c}  0 \\\\ 0  \\frac{ck}{\\delta(\\gamma+c)} \\end{pmatrix}}$$", "id": "2662307"}, {"introduction": "路径积分方法的真正威力在于其处理非线性系统中罕见大涨落的能力，例如在不同稳态之间的转换。本练习将这一强大工具应用于经典的 Schlögl 双稳态模型 [@problem_id:2662187]。你将学习如何通过识别最优涨落路径（即“瞬子”）并计算其作用量，来计算状态转换速率。这个实践将展示一种超越线性近似范畴的强大分析技术，是掌握化学动力学中罕见事件理论的关键一步。", "problem": "考虑一个在具有恒定化学物种的均匀混合体积中的双稳态Schlögl反应网络，该过程被建模为关于重标化浓度 $x = n/N$ 的单步生灭过程，其中$n$是物种$X$的粒子数，$N$是一个大的系统大小参数。在无量纲单位下，重标化的倾向函数（每个$N$）为\n$$\nw_{+}(x) = 7 x^{2} + 8, \\qquad w_{-}(x) = x^{3} + 14 x,\n$$\n使得确定性漂移为 $f(x) = w_{+}(x) - w_{-}(x)$。对于这些参数，确定性不动点为 $x_{a} = 1$（稳定）、$x_{s} = 2$（不稳定鞍点）和 $x_{b} = 4$（稳定）。\n\n从化学主方程和Wentzel–Kramers–Brillouin (WKB) 路径积分形式（例如，通过Doi–Peliti相干态或Martin–Siggia–Rose泛函，其中所有反三角函数均以弧度解释）出发，执行以下操作：\n\n1) 推导有效哈密顿量 $H(x,p)$，并确定从下稳定态 $x_{a}$ 跨越鞍点 $x_{s}$ 跃迁到上稳定态 $x_{b}$ 的瞬子（最优涨落）轨迹。\n\n2) 计算沿零能瞬子在 $x_{a}$ 和 $x_{s}$ 之间累积的作用量 $S$ 的闭合形式。\n\n3) 计算瞬子周围的高斯涨落前因子（单圈行列式），以获得乘以作用量指数的主导前因子。\n\n报告从 $x_{a}$ 到 $x_{b}$ 的转换速率 $k(N)$ 的最终表达式，该表达式在大 $N$ 下有效至主导阶，形式为关于 $N$ 的单一闭合形式解析表达式。无需数值四舍五入。以与给定无量纲化一致的无量纲逆时间单位表示最终答案，并将所有反三角函数解释为弧度。", "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。我们可以开始求解。\n\n问题要求计算由一维生灭过程描述的粒子，从一个稳定不动点 $x_{a}$ 越过一个不稳定不动点（鞍点）$x_{s}$ 到达另一个稳定不动点 $x_{b}$ 的跃迁速率 $k(N)$。该速率主要由逃离初始吸引盆的稀有事件的概率决定，而此概率由到达鞍点的作用量确定。在大系统尺寸 $N$ 的极限下，可以使用应用于化学主方程的Wentzel–Kramers–Brillouin (WKB)近似来计算该速率。速率的形式为 $k(N) = A \\exp(-NS)$，其中 $S$ 是最优涨落路径（瞬子）的作用量，$A$ 是围绕该路径的高斯涨落产生的前因子。\n\n首先，我们推导系统的有效哈密顿量。在生灭过程的Doi-Peliti或Martin–Siggia–Rose路径积分形式中，对应于重标化浓度 $x$ 及其共轭动量 $p$ 的哈密顿量由下式给出：\n$$ H(x, p) = w_{+}(x)(\\exp(p/N) - 1) + w_{-}(x)(\\exp(-p/N) - 1) $$\n在 WKB 近似下（大 $N$ 极限），$p/N$ 很小，我们将哈密顿量中的动量重标为 $p_{WKB} = p/N$ 并泰勒展开。或者，更标准地，我们使用跳跃过程的大偏差哈密顿量，它具有以下形式（此处 $p$ 是共轭于 $x$ 的大偏差动量）：\n$$ H(x, p) = w_{+}(x)(e^{p} - 1) + w_{-}(x)(e^{-p} - 1) $$\n代入给定的倾向函数 $w_{+}(x) = 7x^{2} + 8$ 和 $w_{-}(x) = x^{3} + 14x$，我们得到：\n$$ H(x, p) = (7x^{2} + 8)(e^{p} - 1) + (x^{3} + 14x)(e^{-p} - 1) $$\n\n瞬子轨迹对应于能量为零的路径，即 $H(x, p) = 0$。这使我们能够找到该最优路径上动量 $p$ 作为位置 $x$ 的函数。\n$$ (7x^{2} + 8)(e^{p} - 1) = -(x^{3} + 14x)(e^{-p} - 1) = (x^{3} + 14x)(1 - e^{-p}) $$\n$$ (7x^{2} + 8)(e^{p} - 1) = (x^{3} + 14x)\\frac{e^{p} - 1}{e^{p}} $$\n对于非平凡路径，$p \\neq 0$ 因而 $e^{p} \\neq 1$，所以我们可以除以 $(e^{p} - 1)$：\n$$ 7x^{2} + 8 = \\frac{x^{3} + 14x}{e^{p}} $$\n$$ e^{p} = \\frac{x^{3} + 14x}{7x^{2} + 8} = \\frac{w_{-}(x)}{w_{+}(x)} $$\n这给出了瞬子轨迹上的动量：\n$$ p^{*}(x) = \\ln\\left(\\frac{w_{-}(x)}{w_{+}(x)}\\right) = \\ln\\left(\\frac{x^{3} + 14x}{7x^{2} + 8}\\right) $$\n瞬子轨迹连接鞍点 $x_s=2$ 和稳定点 $x_a=1$。我们感兴趣的从 $x_a$ 到 $x_b$ 的跃迁，其速率受限于从 $x_a$ 处的势阱越过 $x_s$ 处的势垒的逃逸过程。此逃逸路径的作用量由动量从起始不动点 $x_{a}=1$ 到鞍点 $x_{s}=2$ 的积分给出。\n$$ S = \\int_{x_{a}}^{x_{s}} p^{*}(x) dx = \\int_{1}^{2} \\ln\\left(\\frac{x^{3} + 14x}{7x^{2} + 8}\\right) dx $$\n为计算此积分，我们使用分部积分法 $\\int u dv = uv - \\int v du$。令 $u = \\ln\\left(\\frac{w_{-}(x)}{w_{+}(x)}\\right)$ 且 $dv = dx$。则 $v=x$ 且 $du = \\left(\\frac{w_{-}'(x)}{w_{-}(x)} - \\frac{w_{+}'(x)}{w_{+}(x)}\\right)dx$。\n$$ S = \\left[x \\ln\\left(\\frac{w_{-}(x)}{w_{+}(x)}\\right)\\right]_{1}^{2} - \\int_{1}^{2} x \\left(\\frac{w_{-}'(x)}{w_{-}(x)} - \\frac{w_{+}'(x)}{w_{+}(x)}\\right) dx $$\n边界项为零，因为在不动点 $x_{a}=1$ 和 $x_{s}=2$ 处，确定性漂移 $f(x)=w_+(x)-w_-(x)=0$，这意味着 $w_+(x)=w_-(x)$，因此 $\\ln(w_-/w_+) = \\ln(1) = 0$。\n倾向函数的导数为 $w_{-}'(x) = 3x^{2} + 14$ 和 $w_{+}'(x) = 14x$。积分变为：\n$$ S = - \\int_{1}^{2} x \\left(\\frac{3x^{2} + 14}{x^{3} + 14x} - \\frac{14x}{7x^{2} + 8}\\right) dx = - \\int_{1}^{2} \\left(\\frac{3x^{2} + 14}{x^{2} + 14} - \\frac{14x^{2}}{7x^{2} + 8}\\right) dx $$\n我们分解被积函数：\n$$ \\frac{3x^{2} + 14}{x^{2} + 14} = \\frac{3(x^{2} + 14) - 42 + 14}{x^{2} + 14} = 3 - \\frac{28}{x^{2} + 14} $$\n$$ \\frac{14x^{2}}{7x^{2} + 8} = \\frac{2(7x^{2} + 8) - 16}{7x^{2} + 8} = 2 - \\frac{16}{7x^{2} + 8} $$\n将这些代入 $S$ 的积分中：\n$$ S = - \\int_{1}^{2} \\left( \\left(3 - \\frac{28}{x^{2} + 14}\\right) - \\left(2 - \\frac{16}{7x^{2} + 8}\\right) \\right) dx = - \\int_{1}^{2} \\left(1 - \\frac{28}{x^{2} + 14} + \\frac{16}{7x^{2} + 8}\\right) dx $$\n$$ S = -[x]_{1}^{2} + 28 \\int_{1}^{2}\\frac{dx}{x^{2} + 14} - 16 \\int_{1}^{2}\\frac{dx}{7x^{2} + 8} $$\n积分的形式为 $\\int \\frac{dx}{ax^2+b} = \\frac{1}{\\sqrt{ab}}\\arctan(x\\sqrt{a/b})$。\n对于第一个积分，$a=1, b=14$： $\\int_{1}^{2}\\frac{dx}{x^{2} + 14} = \\left[\\frac{1}{\\sqrt{14}}\\arctan\\left(\\frac{x}{\\sqrt{14}}\\right)\\right]_{1}^{2} = \\frac{1}{\\sqrt{14}}\\left(\\arctan\\left(\\frac{2}{\\sqrt{14}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{14}}\\right)\\right)$。\n对于第二个积分，$a=7, b=8$： $\\int_{1}^{2}\\frac{dx}{7x^{2} + 8} = \\left[\\frac{1}{\\sqrt{56}}\\arctan\\left(x\\sqrt{\\frac{7}{8}}\\right)\\right]_{1}^{2} = \\frac{1}{2\\sqrt{14}}\\left(\\arctan\\left(2\\sqrt{\\frac{7}{8}}\\right) - \\arctan\\left(\\sqrt{\\frac{7}{8}}\\right)\\right) = \\frac{1}{2\\sqrt{14}}\\left(\\arctan\\left(\\sqrt{\\frac{7}{2}}\\right) - \\arctan\\left(\\sqrt{\\frac{7}{8}}\\right)\\right)$。\n代入这些结果：\n$$ S = -1 + \\frac{28}{\\sqrt{14}}\\left(\\arctan\\left(\\frac{2}{\\sqrt{14}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{14}}\\right)\\right) - \\frac{16}{2\\sqrt{14}}\\left(\\arctan\\left(\\sqrt{\\frac{7}{2}}\\right) - \\arctan\\left(\\sqrt{\\frac{7}{8}}\\right)\\right) $$\n使用恒等式 $\\arctan(A) - \\arctan(B) = \\arctan\\left(\\frac{A-B}{1+AB}\\right)$：\n$$ \\arctan\\left(\\frac{2}{\\sqrt{14}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{14}}\\right) = \\arctan\\left(\\frac{1/\\sqrt{14}}{1+2/14}\\right) = \\arctan\\left(\\frac{\\sqrt{14}}{16}\\right) $$\n$$ \\arctan\\left(\\sqrt{\\frac{7}{2}}\\right) - \\arctan\\left(\\sqrt{\\frac{7}{8}}\\right) = \\arctan\\left(\\frac{\\sqrt{7/8}}{1+7/4}\\right) = \\arctan\\left(\\frac{\\sqrt{14}}{11}\\right) $$\n因此，作用量为：\n$$ S = -1 + 2\\sqrt{14} \\arctan\\left(\\frac{\\sqrt{14}}{16}\\right) - \\frac{4\\sqrt{14}}{7} \\arctan\\left(\\frac{\\sqrt{14}}{11}\\right) $$\n\n接下来，我们计算前因子 $A$。对于一维系统，高斯涨落行列式给出了一个类似于Kramers速率公式的前因子：\n$$ A = \\frac{1}{2\\pi} \\sqrt{|f'(x_a) f'(x_s)|} $$\n确定性漂移为 $f(x) = w_{+}(x) - w_{-}(x) = -x^{3} + 7x^{2} - 14x + 8$。其导数为 $f'(x) = -3x^{2} + 14x - 14$。\n我们在稳定不动点 $x_{a}=1$ 和鞍点 $x_{s}=2$ 处计算导数：\n$$ f'(x_a) = f'(1) = -3(1)^{2} + 14(1) - 14 = -3 $$\n$$ f'(x_s) = f'(2) = -3(2)^{2} + 14(2) - 14 = -12 + 28 - 14 = 2 $$\n因此，前因子为：\n$$ A = \\frac{1}{2\\pi} \\sqrt{|(-3)(2)|} = \\frac{\\sqrt{6}}{2\\pi} $$\n\n最后，我们结合前因子和作用量，得到从状态 $x_a$ 到 $x_b$ 的转换速率 $k(N)$ 在大 $N$ 下的主导阶：\n$$ k(N) = A \\exp(-NS) = \\frac{\\sqrt{6}}{2\\pi} \\exp\\left( -N \\left[ -1 + 2\\sqrt{14} \\arctan\\left(\\frac{\\sqrt{14}}{16}\\right) - \\frac{4\\sqrt{14}}{7} \\arctan\\left(\\frac{\\sqrt{14}}{11}\\right) \\right] \\right) $$\n这可以写为：\n$$ k(N) = \\frac{\\sqrt{6}}{2\\pi} \\exp\\left( N \\left( 1 - 2\\sqrt{14} \\arctan\\left(\\frac{\\sqrt{14}}{16}\\right) + \\frac{4\\sqrt{14}}{7} \\arctan\\left(\\frac{\\sqrt{14}}{11}\\right) \\right) \\right) $$\n这就是转换速率的最终闭合形式表达式。", "answer": "$$\\boxed{\\frac{\\sqrt{6}}{2\\pi} \\exp\\left(N \\left(1 - 2\\sqrt{14} \\arctan\\left(\\frac{\\sqrt{14}}{16}\\right) + \\frac{4\\sqrt{14}}{7} \\arctan\\left(\\frac{\\sqrt{14}}{11}\\right)\\right)\\right)}$$", "id": "2662187"}]}