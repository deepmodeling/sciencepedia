{"hands_on_practices": [{"introduction": "局部敏感性分析是理解微小参数扰动如何影响模型动态的基础。本练习将引导您使用直接微分法这一基本技术，来为一个时变系统推导其敏感性方程。通过解决经典的 A → B → C 反应问题[@problem_id:2673555]，您将亲身体验如何建立和求解局部敏感性系数，这些系数用以量化系统状态相对于其参数的梯度。", "problem": "考虑一个充分混合的等温间歇式反应器，其中发生连续一级反应网络 $A \\to B \\to C$。设浓度分别为 $A(t)$、$B(t)$ 和 $C(t)$，并收集在状态向量 $x(t) = (A(t), B(t), C(t))^{\\top}$ 中。反应遵循质量作用动力学，速率常数 $k_{1} > 0$ 和 $k_{2} > 0$ 为严格为正且不随时间变化的常数，收集在参数向量 $p = (k_{1}, k_{2})^{\\top}$ 中。初始条件为 $(A(0), B(0), C(0)) = (A_{0}, 0, 0)$，其中 $A_{0} > 0$。\n\n从质量作用动力学的定义和微分链式法则出发，完成以下任务：\n\n1.  推导自治状态动力学方程 $ \\dot{x}(t) = f(x(t), p)$。\n2.  对于参数化 $p = (k_{1}, k_{2})^{\\top}$，显式计算状态雅可比矩阵 $f_{x}(x,p) = \\frac{\\partial f}{\\partial x}$ 和参数雅可比矩阵 $f_{p}(x,p) = \\frac{\\partial f}{\\partial p}$。\n3.  通过对状态动力学方程关于 $p$ 求导，推导灵敏度矩阵 $S(t) = \\frac{\\partial x(t)}{\\partial p}$ 的局部敏感性方程，其形式为一个显式的线性非齐次矩阵微分方程 $\\dot{S}(t) = \\cdots$，并给出其在 $t = 0$ 时的初始条件。\n4.  假设 $k_{1} \\neq k_{2}$，仅使用第 1-3 步的结果和线性微分方程的标准方法，求出未归一化的局部敏感性 $s_{C,k_{1}}(t) = \\frac{\\partial C(t)}{\\partial k_{1}}$ 作为 $t$、$A_{0}$、$k_{1}$ 和 $k_{2}$ 的函数的闭式表达式。\n\n请以单一闭式解析表达式的形式给出 $s_{C,k_{1}}(t)$ 的最终结果。最终表达式中不包含单位。", "solution": "首先对问题进行验证。\n\n从问题陈述中逐字提取已知条件：\n- 反应网络：$A \\to B \\to C$，连续一级反应。\n- 反应器条件：充分混合、等温、间歇式。\n- 状态向量：$x(t) = (A(t), B(t), C(t))^{\\top}$。\n- 动力学：质量作用动力学。\n- 参数向量：$p = (k_{1}, k_{2})^{\\top}$，速率常数 $k_{1} > 0$ 和 $k_{2} > 0$ 不随时间变化。\n- 初始条件：$x(0) = (A_{0}, 0, 0)^{\\top}$，其中 $A_{0} > 0$。\n- 约束条件：$k_{1} \\neq k_{2}$。\n- 目标：推导未归一化的局部敏感性 $s_{C,k_{1}}(t) = \\frac{\\partial C(t)}{\\partial k_{1}}$ 的闭式表达式。\n\n评估问题的有效性。该问题具有科学依据，描述了一个采用标准质量作用动力学的经典反应方案。该问题是适定的，提供了一套完整的线性常微分方程组及指定的初始条件和参数，这保证了唯一解的存在。问题以客观、无歧义的数学语言陈述。所有必要信息均已提供，且无内部矛盾。因此，该问题被认定为有效，并将提供解答。\n\n解题过程通过执行问题陈述中列出的四个任务来进行。\n\n任务 1：推导状态动力学方程 $\\dot{x}(t) = f(x(t), p)$。\n对于反应网络 $A \\xrightarrow{k_1} B \\xrightarrow{k_2} C$，在质量作用动力学下，反应速率为 $r_{1} = k_{1} A(t)$ 和 $r_{2} = k_{2} B(t)$。浓度 $A(t)$、$B(t)$ 和 $C(t)$ 的变化率分别为：\n$$\n\\frac{dA(t)}{dt} = -r_{1} = -k_{1} A(t)\n$$\n$$\n\\frac{dB(t)}{dt} = r_{1} - r_{2} = k_{1} A(t) - k_{2} B(t)\n$$\n$$\n\\frac{dC(t)}{dt} = r_{2} = k_{2} B(t)\n$$\n使用状态向量表示法 $x(t) = (A(t), B(t), C(t))^{\\top} = (x_{1}(t), x_{2}(t), x_{3}(t))^{\\top}$，常微分方程组 $\\dot{x}(t) = f(x(t), p)$ 为：\n$$\nf(x(t), p) = \\begin{pmatrix} -k_{1} x_{1}(t) \\\\ k_{1} x_{1}(t) - k_{2} x_{2}(t) \\\\ k_{2} x_{2}(t) \\end{pmatrix}\n$$\n\n任务 2：计算雅可比矩阵 $f_{x}(x,p)$ 和 $f_{p}(x,p)$。\n状态雅可比矩阵 $f_{x}$ 是 $f$ 关于 $x$ 各分量的偏导数矩阵。\n$$\nf_{x}(x,p) = \\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial x_{1}}  \\frac{\\partial f_{1}}{\\partial x_{2}}  \\frac{\\partial f_{1}}{\\partial x_{3}} \\\\ \\frac{\\partial f_{2}}{\\partial x_{1}}  \\frac{\\partial f_{2}}{\\partial x_{2}}  \\frac{\\partial f_{2}}{\\partial x_{3}} \\\\ \\frac{\\partial f_{3}}{\\partial x_{1}}  \\frac{\\partial f_{3}}{\\partial x_{2}}  \\frac{\\partial f_{3}}{\\partial x_{3}} \\end{pmatrix} = \\begin{pmatrix} -k_{1}  0  0 \\\\ k_{1}  -k_{2}  0 \\\\ 0  k_{2}  0 \\end{pmatrix}\n$$\n参数雅可比矩阵 $f_{p}$ 是 $f$ 关于 $p = (k_{1}, k_{2})^{\\top}$ 各分量的偏导数矩阵。\n$$\nf_{p}(x,p) = \\frac{\\partial f}{\\partial p} = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial k_{1}}  \\frac{\\partial f_{1}}{\\partial k_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial k_{1}}  \\frac{\\partial f_{2}}{\\partial k_{2}} \\\\ \\frac{\\partial f_{3}}{\\partial k_{1}}  \\frac{\\partial f_{3}}{\\partial k_{2}} \\end{pmatrix} = \\begin{pmatrix} -x_{1}(t)  0 \\\\ x_{1}(t)  -x_{2}(t) \\\\ 0  x_{2}(t) \\end{pmatrix}\n$$\n\n任务 3：推导灵敏度矩阵 $S(t) = \\frac{\\partial x(t)}{\\partial p}$ 的局部灵敏度方程。\n灵敏度矩阵 $S(t)$ 衡量状态向量 $x(t)$ 对参数向量 $p$ 中无穷小扰动的响应。我们将状态动力学方程 $\\dot{x}(t) = f(x(t),p)$ 对 $p$ 求导。交换微分次序并应用多元链式法则，可得：\n$$\n\\dot{S}(t) = \\frac{d}{dt}\\left(\\frac{\\partial x(t)}{\\partial p}\\right) = \\frac{\\partial}{\\partial p}\\left(\\frac{dx(t)}{dt}\\right) = \\frac{\\partial f(x(t), p)}{\\partial p} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial p} + \\frac{\\partial f}{\\partial p}\n$$\n代入任务 2 中的雅可比矩阵，得到 $S(t)$ 的矩阵微分方程为：\n$$\n\\dot{S}(t) = f_{x}(x, p)S(t) + f_{p}(x, p)\n$$\n$$\n\\dot{S}(t) = \\begin{pmatrix} -k_{1}  0  0 \\\\ k_{1}  -k_{2}  0 \\\\ 0  k_{2}  0 \\end{pmatrix} S(t) + \\begin{pmatrix} -x_{1}(t)  0 \\\\ x_{1}(t)  -x_{2}(t) \\\\ 0  x_{2}(t) \\end{pmatrix}\n$$\n初始条件 $x(0) = (A_{0}, 0, 0)^{\\top}$ 与参数 $k_{1}$ 和 $k_{2}$ 无关。因此，初始灵敏度为零矩阵：\n$$\nS(0) = \\frac{\\partial x(0)}{\\partial p} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n\n任务 4：求出 $s_{C,k_{1}}(t) = \\frac{\\partial C(t)}{\\partial k_{1}}$ 的闭式表达式。\n所求的灵敏度 $s_{C,k_{1}}(t)$ 是 $S(t)$ 矩阵的第三行第一列元素。记 $S(t)$ 的第一列为 $S_{\\cdot, 1}(t) = (s_{A,k_{1}}(t), s_{B,k_{1}}(t), s_{C,k_{1}}(t))^{\\top}$。该向量的常微分方程组为：\n$$\n\\frac{d}{dt} \\begin{pmatrix} s_{A,k_{1}} \\\\ s_{B,k_{1}} \\\\ s_{C,k_{1}} \\end{pmatrix} = \\begin{pmatrix} -k_{1}  0  0 \\\\ k_{1}  -k_{2}  0 \\\\ 0  k_{2}  0 \\end{pmatrix} \\begin{pmatrix} s_{A,k_{1}} \\\\ s_{B,k_{1}} \\\\ s_{C,k_{1}} \\end{pmatrix} + \\begin{pmatrix} -A(t) \\\\ A(t) \\\\ 0 \\end{pmatrix}\n$$\n初始条件为 $(s_{A,k_{1}}(0), s_{B,k_{1}}(0), s_{C,k_{1}}(0))^{\\top} = (0,0,0)^{\\top}$。求解这个线性系统需要 $A(t)$ 和 $B(t)$ 的显式形式，它们可以通过求解原始状态方程得到：\n$$\nA(t) = A_{0} \\exp(-k_{1}t)\n$$\n$$\nB(t) = \\frac{k_{1}A_{0}}{k_{2}-k_{1}}(\\exp(-k_{1}t) - \\exp(-k_{2}t))\n$$\n我们依次求解灵敏度方程。首先，求解 $s_{A,k_{1}}(t)$：\n$$\n\\dot{s}_{A,k_{1}} + k_{1}s_{A,k_{1}} = -A(t) = -A_{0}\\exp(-k_{1}t)\n$$\n在 $s_{A,k_{1}}(0) = 0$ 的条件下，解为 $s_{A,k_{1}}(t) = -A_{0}t\\exp(-k_{1}t)$。\n\n接下来，求解 $s_{B,k_{1}}(t)$：\n$$\n\\dot{s}_{B,k_{1}} + k_{2}s_{B,k_{1}} = k_{1}s_{A,k_{1}}(t) + A(t) = k_{1}(-A_{0}t\\exp(-k_{1}t)) + A_{0}\\exp(-k_{1}t) = A_{0}(1-k_{1}t)\\exp(-k_{1}t)\n$$\n求解此线性一阶常微分方程，并应用初始条件 $s_{B,k_{1}}(0) = 0$，可得：\n$$\ns_{B,k_{1}}(t) = \\frac{A_{0} k_{2}}{(k_{2} - k_{1})^{2}}(\\exp(-k_{1}t) - \\exp(-k_{2}t)) - \\frac{A_{0} k_{1} t}{k_{2} - k_{1}}\\exp(-k_{1}t)\n$$\n最后，我们从第三个灵敏度方程求解 $s_{C,k_{1}}(t)$：\n$$\n\\dot{s}_{C,k_{1}} = k_{2}s_{B,k_{1}}(t)\n$$\n在 $s_{C,k_{1}}(0)=0$ 的条件下，我们从 $0$ 到 $t$ 进行积分：\n$$\ns_{C,k_{1}}(t) = \\int_{0}^{t} k_{2} s_{B,k_{1}}(\\tau) d\\tau\n$$\n代入 $s_{B,k_{1}}(\\tau)$ 的表达式：\n$$\ns_{C,k_{1}}(t) = k_{2} \\int_{0}^{t} \\left[ \\frac{A_{0} k_{2}}{(k_{2} - k_{1})^{2}}(\\exp(-k_{1}\\tau) - \\exp(-k_{2}\\tau)) - \\frac{A_{0} k_{1} \\tau}{k_{2} - k_{1}}\\exp(-k_{1}\\tau) \\right] d\\tau\n$$\n该积分的计算分两部分进行。第一个积分为：\n$$\n\\frac{A_{0}k_{2}^{2}}{(k_{2}-k_{1})^{2}} \\int_{0}^{t} (\\exp(-k_{1}\\tau) - \\exp(-k_{2}\\tau)) d\\tau = \\frac{A_{0}k_{2}^{2}}{(k_{2}-k_{1})^{2}} \\left( \\frac{1-\\exp(-k_{1}t)}{k_{1}} - \\frac{1-\\exp(-k_{2}t)}{k_{2}} \\right)\n$$\n第二个积分，使用分部积分法：\n$$\n-\\frac{A_{0}k_{1}k_{2}}{k_{2}-k_{1}} \\int_{0}^{t} \\tau\\exp(-k_{1}\\tau) d\\tau = -\\frac{A_{0}k_{1}k_{2}}{k_{2}-k_{1}} \\left( \\frac{1-\\exp(-k_{1}t)-k_{1}t\\exp(-k_{1}t)}{k_{1}^{2}} \\right)\n$$\n将这些结果相加并进行大量代数化简，得到最终表达式：\n$$\ns_{C,k_{1}}(t) = \\frac{A_{0}k_{2}}{(k_{2}-k_{1})^{2}} \\left( \\exp(-k_{2}t) - \\exp(-k_{1}t) \\right) + \\frac{A_{0}k_{2}t}{k_{2}-k_{1}} \\exp(-k_{1}t)\n$$\n整理成更紧凑的形式，得到最终答案。", "answer": "$$\n\\boxed{A_{0} k_{2} \\left( \\frac{t}{k_{2} - k_{1}} \\exp(-k_{1} t) + \\frac{\\exp(-k_{2} t) - \\exp(-k_{1} t)}{(k_{2} - k_{1})^{2}} \\right)}\n$$", "id": "2673555"}, {"introduction": "局部敏感性分析研究的是无穷小的变化，而全局敏感性分析（GSA）则评估参数在整个不确定性范围内的大幅变化所带来的影响。本练习通过一个简单的线性模型来介绍 GSA 的基本概念[@problem_id:2673531]。您将推导一阶和全阶 Sobol 指数，学习它们如何将输出方差分配给不同的输入参数，并揭示模型的结构信息。", "problem": "考虑一个标量模型输出 $Y$ 的随机线性动力学代理模型，其表达式为 $Y=\\sum_{j=1}^{m} a_{j} P_{j}$，其中参数 $\\{P_{j}\\}_{j=1}^{m}$ 是相互独立的随机变量，具有零均值和有限方差 $\\operatorname{Var}(P_{j})=\\sigma_{j}^{2}$，且系数 $\\{a_{j}\\}_{j=1}^{m}$ 是固定的实常数。令 $\\operatorname{Var}(\\cdot)$ 表示方差，$\\mathbb{E}[\\cdot]$ 表示期望。采用基于方差的全局敏感性分析框架，其中参数 $P_{j}$ 的一阶 Sobol 指数定义为 $S_{j}=\\operatorname{Var}_{P_{j}}\\!\\left(\\mathbb{E}[Y \\mid P_{j}]\\right) / \\operatorname{Var}(Y)$，全局效应 Sobol 指数定义为 $S_{T_{j}}=1-\\operatorname{Var}_{P_{-j}}\\!\\left(\\mathbb{E}[Y \\mid P_{-j}]\\right) / \\operatorname{Var}(Y)$，其中 $P_{-j}$ 表示除 $P_{j}$ 外所有输入的集合。仅使用这些定义、输入 $Y$ 的线性性质以及 $P_{j}$ 的相互独立性，推导出 $S_{j}$ 和 $S_{T_{j}}$ 关于 $\\{a_{k}\\}$ 和 $\\{\\sigma_{k}^{2}\\}$ 的显式闭式表达式。您的最终答案必须是单个闭式解析表达式。不要求进行数值评估，也不涉及单位。", "solution": "本题要求推导一个随机线性模型的一阶 Sobol 指数 $S_{j}$ 和全局效应 Sobol 指数 $S_{T_{j}}$ 的显式闭式表达式。模型输出由 $Y = \\sum_{j=1}^{m} a_{j} P_{j}$ 给出，其中系数 $\\{a_{j}\\}_{j=1}^{m}$ 是固定实常数，参数 $\\{P_{j}\\}_{j=1}^{m}$ 是相互独立的随机变量。每个参数 $P_j$ 的均值为零，$\\mathbb{E}[P_{j}] = 0$，且具有有限方差 $\\operatorname{Var}(P_{j}) = \\sigma_{j}^{2}$。我们将首先计算输出的总方差 $\\operatorname{Var}(Y)$，然后使用给定的定义来推导每个指数。\n\n首先，我们计算 $Y$ 的总方差。$Y$ 的期望可以通过期望算子的线性性质求得：\n$$ \\mathbb{E}[Y] = \\mathbb{E}\\left[\\sum_{k=1}^{m} a_{k} P_{k}\\right] = \\sum_{k=1}^{m} a_{k} \\mathbb{E}[P_{k}] $$\n鉴于对于所有 $k \\in \\{1, \\dots, m\\}$ 都有 $\\mathbb{E}[P_{k}] = 0$， $Y$ 的期望为：\n$$ \\mathbb{E}[Y] = \\sum_{k=1}^{m} a_{k} (0) = 0 $$\n$Y$ 的方差定义为 $\\operatorname{Var}(Y) = \\mathbb{E}[Y^{2}] - (\\mathbb{E}[Y])^{2}$。由于 $\\mathbb{E}[Y] = 0$，方差简化为 $\\operatorname{Var}(Y) = \\mathbb{E}[Y^{2}]$。我们可以直接计算和的方差。由于参数 $\\{P_{k}\\}_{k=1}^{m}$ 是相互独立的，它们的加权和的方差是它们方差的加权和：\n$$ \\operatorname{Var}(Y) = \\operatorname{Var}\\left(\\sum_{k=1}^{m} a_{k} P_{k}\\right) = \\sum_{k=1}^{m} \\operatorname{Var}(a_{k} P_{k}) = \\sum_{k=1}^{m} a_{k}^{2} \\operatorname{Var}(P_{k}) $$\n代入给定的方差 $\\operatorname{Var}(P_{k})=\\sigma_{k}^{2}$，我们得到总方差：\n$$ \\operatorname{Var}(Y) = \\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2} $$\n这个表达式将作为两个 Sobol 指数的分母。\n\n接下来，我们推导一阶 Sobol 指数 $S_{j}$，其定义为 $S_{j} = \\operatorname{Var}_{P_{j}}\\!\\left(\\mathbb{E}[Y \\mid P_{j}]\\right) / \\operatorname{Var}(Y)$。我们必须首先计算条件期望 $\\mathbb{E}[Y \\mid P_{j}]$。我们可以将 $Y$ 的和式分解为包含 $P_{j}$ 的项和不包含 $P_{j}$ 的项：\n$$ \\mathbb{E}[Y \\mid P_{j}] = \\mathbb{E}\\left[a_{j} P_{j} + \\sum_{k \\neq j} a_{k} P_{k} \\mid P_{j}\\right] $$\n根据条件期望的线性性质：\n$$ \\mathbb{E}[Y \\mid P_{j}] = \\mathbb{E}[a_{j} P_{j} \\mid P_{j}] + \\mathbb{E}\\left[\\sum_{k \\neq j} a_{k} P_{k} \\mid P_{j}\\right] $$\n当我们以 $P_j$ 为条件时，$a_{j} P_{j}$ 项是已知的，所以 $\\mathbb{E}[a_{j} P_{j} \\mid P_{j}] = a_{j} P_{j}$。对于第二项，由于参数的相互独立性，对于任何 $k \\neq j$，$P_k$ 都独立于 $P_j$。因此，以 $P_j$ 为条件不影响 $P_k$ 的期望：\n$$ \\mathbb{E}\\left[\\sum_{k \\neq j} a_{k} P_{k} \\mid P_{j}\\right] = \\sum_{k \\neq j} a_{k} \\mathbb{E}[P_{k} \\mid P_{j}] = \\sum_{k \\neq j} a_{k} \\mathbb{E}[P_{k}] = \\sum_{k \\neq j} a_{k} (0) = 0 $$\n因此，条件期望为：\n$$ \\mathbb{E}[Y \\mid P_{j}] = a_{j} P_{j} $$\n现在我们计算这个量关于 $P_j$ 的方差：\n$$ \\operatorname{Var}_{P_{j}}\\!\\left(\\mathbb{E}[Y \\mid P_{j}]\\right) = \\operatorname{Var}(a_{j} P_{j}) = a_{j}^{2} \\operatorname{Var}(P_{j}) = a_{j}^{2} \\sigma_{j}^{2} $$\n最后，一阶 Sobol 指数 $S_{j}$ 是该方差与总方差的比值：\n$$ S_{j} = \\frac{a_{j}^{2} \\sigma_{j}^{2}}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}} $$\n\n最后，我们推导全局效应 Sobol 指数 $S_{T_{j}}$，其定义为 $S_{T_{j}} = 1 - \\operatorname{Var}_{P_{-j}}\\!\\left(\\mathbb{E}[Y \\mid P_{-j}]\\right) / \\operatorname{Var}(Y)$，其中 $P_{-j}$ 表示除 $P_{j}$ 之外的所有参数的集合。我们计算条件期望 $\\mathbb{E}[Y \\mid P_{-j}]$：\n$$ \\mathbb{E}[Y \\mid P_{-j}] = \\mathbb{E}\\left[a_{j} P_{j} + \\sum_{k \\neq j} a_{k} P_{k} \\mid P_{-j}\\right] = \\mathbb{E}[a_{j} P_{j} \\mid P_{-j}] + \\mathbb{E}\\left[\\sum_{k \\neq j} a_{k} P_{k} \\mid P_{-j}\\right] $$\n由于 $P_j$ 独立于集合 $P_{-j}$，我们有 $\\mathbb{E}[a_{j} P_{j} \\mid P_{-j}] = a_{j} \\mathbb{E}[P_{j}] = 0$。项 $\\sum_{k \\neq j} a_{k} P_{k}$ 完全由 $P_{-j}$ 中的变量确定，因此其在 $P_{-j}$ 条件下的期望是其本身。\n$$ \\mathbb{E}[Y \\mid P_{-j}] = 0 + \\sum_{k \\neq j} a_{k} P_{k} = \\sum_{k \\neq j} a_{k} P_{k} $$\n现在我们计算这个量关于 $P_{-j}$ 中变量的方差：\n$$ \\operatorname{Var}_{P_{-j}}\\!\\left(\\mathbb{E}[Y \\mid P_{-j}]\\right) = \\operatorname{Var}\\left(\\sum_{k \\neq j} a_{k} P_{k}\\right) $$\n由于 $P_{-j}$ 中变量的相互独立性，该方差为：\n$$ \\operatorname{Var}\\left(\\sum_{k \\neq j} a_{k} P_{k}\\right) = \\sum_{k \\neq j} \\operatorname{Var}(a_{k} P_{k}) = \\sum_{k \\neq j} a_{k}^{2} \\sigma_{k}^{2} $$\n将此代入 $S_{T_{j}}$ 的定义中：\n$$ S_{T_{j}} = 1 - \\frac{\\sum_{k \\neq j} a_{k}^{2} \\sigma_{k}^{2}}{\\operatorname{Var}(Y)} = 1 - \\frac{\\sum_{k \\neq j} a_{k}^{2} \\sigma_{k}^{2}}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}} $$\n通分后：\n$$ S_{T_{j}} = \\frac{\\left(\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}\\right) - \\left(\\sum_{k \\neq j} a_{k}^{2} \\sigma_{k}^{2}\\right)}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}} $$\n分子简化为仅含索引 $j$ 的项：\n$$ \\left(\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}\\right) - \\left(\\sum_{k \\neq j} a_{k}^{2} \\sigma_{k}^{2}\\right) = a_{j}^{2} \\sigma_{j}^{2} $$\n因此，全局效应指数为：\n$$ S_{T_{j}} = \\frac{a_{j}^{2} \\sigma_{j}^{2}}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}} $$\n我们发现对于这个具有独立输入的线性模型，$S_{j} = S_{T_{j}}$。这是一个预期的结果，因为这样的模型是纯粹加性的，这意味着参数之间没有交互效应。全局效应指数衡量主效应加上所有交互作用；在没有交互作用的情况下，它等于主效应，而这正是一阶指数所衡量的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nS_j,  S_{T_j}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{a_{j}^{2} \\sigma_{j}^{2}}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}},  \\frac{a_{j}^{2} \\sigma_{j}^{2}}{\\sum_{k=1}^{m} a_{k}^{2} \\sigma_{k}^{2}}\n\\end{pmatrix}\n}\n$$", "id": "2673531"}, {"introduction": "对于大多数复杂的非线性动力学模型，解析地进行全局敏感性分析是不可能的。本练习将从理论走向应用，介绍强大的非侵入式多项式混沌展开（PCE）方法[@problem_id:2673601]。您将实现一个计算流程，为一个非线性目标量构建代理模型，然后直接从代理模型的系数中提取 Sobol 指数，这是一种在现代科学计算中广泛应用的技术。", "problem": "考虑一个具有质量作用动力学的不可逆一级反应网络，$A \\to B$ 的速率常数为 $k_1$，$B \\to C$ 的速率常数为 $k_2$，初始条件为 $(A(0),B(0),C(0))=(A_0,0,0)$。设不确定参数 $(k_1,k_2)$ 独立且服从对数正态分布，即 $k_i = \\exp(\\mu_i + \\sigma_i Z_i)$，其中 $Z_i \\sim \\mathcal{N}(0,1)$ 是独立的标准正态随机变量。定义标量目标量 $Y = B_{\\max}$，即物种 $B$ 在时间 $t \\ge 0$ 上的最大瞬时浓度。\n\n您的任务是，使用标准正态变量中概率论埃尔米特多项式的标准正交基，为 $Y$ 实现一个非侵入式低阶多项式混沌展开 (PCE) 代理模型，然后直接从 PCE 系数计算 $k_1$ 和 $k_2$ 的一阶 Sobol 敏感性指数。\n\n基本原理：\n- 质量作用动力学可导出以下常微分方程组：$dA/dt = -k_1 A$，$dB/dt = k_1 A - k_2 B$，$dC/dt = k_2 B$，初始条件为 $A(0)=A_0$，$B(0)=0$，$C(0)=0$。\n- 当 $k_1 \\ne k_2$ 时，精确解为 $A(t) = A_0 e^{-k_1 t}$ 和 $B(t) = \\dfrac{k_1 A_0}{k_2 - k_1}\\left(e^{-k_1 t} - e^{-k_2 t}\\right)$；当 $k_1 = k_2$ 时，其极限可通过洛必达法则导出。\n- 对于 $k_1 \\ne k_2$，$B(t)$ 在 $t \\ge 0$ 上的最大值出现在唯一的临界时间 $t^\\star = \\dfrac{\\ln(k_2/k_1)}{k_2 - k_1}$，这给出了 $B_{\\max}$ 的闭式表达式 $B_{\\max} = B(t^\\star)$。在极限情况 $k_1 \\to k_2$ 时，$B_{\\max} = A_0/e$。\n\nPCE 规格：\n- 在标准正态输入 $(Z_1,Z_2)$ 中，使用总阶为 $p$ 的 PCE，其中 $p=2$。\n- 使用由概率论埃尔米特多项式 $\\{\\psi_n(z)\\}_{n=0}^2$ 构建的、关于标准正态概率密度函数 (PDF) 的标准正交基，其中 $\\psi_0(z)=1$，$\\psi_1(z)=z$，$\\psi_2(z)=(z^2-1)/\\sqrt{2}$；二元基函数是张量积 $\\Psi_{i,j}(Z_1,Z_2)=\\psi_i(Z_1)\\psi_j(Z_2)$。\n- 通过谱投影法，并使用张量积高斯-埃尔米特求积来估计 PCE 系数。该求积法通过变量代换 $Z=\\sqrt{2}\\,x$ 来适应标准正态 PDF，其中 $x$ 是与权重 $e^{-x^2}$ 相关联的高斯-埃尔米特节点。每个输入维度使用 $q = 9$ 个节点。\n- 对于标准正交 PCE，方差是非恒定项系数的平方和。$k_1$ 的一阶 Sobol 指数 ($S_{k_1}$) 是由其基函数仅依赖于 $Z_1$ 的系数（即指数为 $(i,0)$ 且 $i \\ge 1$）所贡献的方差比例。类似地，$S_{k_2}$ 使用指数为 $(0,j)$ 且 $j \\ge 1$ 的系数。\n\n数值与输出要求：\n- 输出中无需物理单位；Sobol 指数是无量纲的，必须以小数（而非百分比）形式报告。\n- 对所有情况，均使用总 PCE 阶数 $p = 2$ 和每个输入维度 $q = 9$ 个点的高斯-埃尔米特求积。\n- 对于 $k_1$ 接近 $k_2$ 的情况，基于极限情况 $B_{\\max} = A_0/e$ 使用数值稳定的计算方法来评估 $B_{\\max}$。\n- 将整个计算过程实现为一个自包含的程序。\n- 对每个测试用例，输出数对 $(S_{k_1}, S_{k_2})$，四舍五入至 $6$ 位小数。\n\n测试套件：\n为以下四个用例计算 $(S_{k_1}, S_{k_2})$，每个用例指定为 $(A_0,\\mu_1,\\sigma_1,\\mu_2,\\sigma_2)$:\n- 用例 1: $(A_0,\\mu_1,\\sigma_1,\\mu_2,\\sigma_2) = (1.0,-0.7,0.25,0.3,0.2)$。\n- 用例 2: $(A_0,\\mu_1,\\sigma_1,\\mu_2,\\sigma_2) = (1.0,0.0,0.05,0.0,0.05)$。\n- 用例 3: $(A_0,\\mu_1,\\sigma_1,\\mu_2,\\sigma_2) = (2.5,-1.0,0.6,0.2,0.6)$。\n- 用例 4: $(A_0,\\mu_1,\\sigma_1,\\mu_2,\\sigma_2) = (0.8,-2.0,0.3,1.0,0.3)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起的逗号分隔列表，其扁平化顺序为\n$[S_{k_1}^{(1)}, S_{k_2}^{(1)}, S_{k_1}^{(2)}, S_{k_2}^{(2)}, S_{k_1}^{(3)}, S_{k_2}^{(3)}, S_{k_1}^{(4)}, S_{k_2}^{(4)}]$\n其中上标表示从 1 到 4 的测试用例索引。每个值必须四舍五入到 6 位小数。", "solution": "所提出的问题陈述具有科学依据、是良定的且客观的。它为一个化学动力学和不确定性量化领域的标准问题，提供了一套完整且一致的定义、参数和目标。所有必要的组成部分都已明确指定：动力学模型、目标量的解析解、不确定参数的统计分布、包括基函数在内的多项式混沌展开的精确形式，以及用于系数估计的数值方法。因此，该问题是有效的，有理由继续求解。\n\n分析结构如下。首先，我们定义物理模型和目标量。其次，我们形式化此数量的多项式混沌展开 (PCE)。第三，我们详细说明使用高斯-埃尔米特求积通过谱投影法计算 PCE 系数的数值过程。最后，我们直接从这些系数推导出一阶 Sobol 敏感性指数。\n\n**1. 模型与目标量**\n\n该问题涉及一个不可逆、一级、两步反应网络 $A \\xrightarrow{k_1} B \\xrightarrow{k_2} C$。在质量作用动力学下，控制常微分方程组为：\n$$\n\\frac{d[A]}{dt} = -k_1 [A]\n$$\n$$\n\\frac{d[B]}{dt} = k_1 [A] - k_2 [B]\n$$\n$$\n\\frac{d[C]}{dt} = k_2 [B]\n$$\n初始条件为 $[A](0) = A_0$，$[B](0) = 0$ 和 $[C](0) = 0$。物种 $B$ 浓度的解析解为：\n$$\n[B](t) = \\frac{k_1 A_0}{k_2 - k_1} \\left( e^{-k_1 t} - e^{-k_2 t} \\right) \\quad \\text{当 } k_1 \\neq k_2 \\text{ 时}\n$$\n目标量 $Y$ 是 $B$ 的最大浓度，记为 $B_{\\max}$。为求此值，我们令 $\\frac{d[B]}{dt} = 0$，得到 $k_1 [A](t^\\star) = k_2 [B](t^\\star)$。解出最大值出现的时间 $t^\\star$：\n$$\nt^\\star = \\frac{\\ln(k_2/k_1)}{k_2 - k_1} \\quad \\text{当 } k_1 \\neq k_2 \\text{ 时}\n$$\n将 $t^\\star$ 代回 $[B](t)$ 的表达式中，得到 $Y$ 的解析公式：\n$$\nY(k_1, k_2) = B_{\\max} = A_0 \\left( \\frac{k_1}{k_2} \\right)^{\\frac{k_2}{k_2 - k_1}}\n$$\n当 $k_1 \\to k_2$ 时，该表达式是数值不稳定的。在极限情况 $k_1 = k_2 = k$下，$[B](t)$ 的解变为 $[B](t) = k A_0 t e^{-kt}$，在 $t^\\star = 1/k$ 时达到最大值 $B_{\\max} = A_0 / e$。在实现时，需要一个阈值。如果 $|k_1 - k_2|$ 相对于其大小而言很小，则必须使用极限值 $A_0/e$ 来确保数值稳定性。\n\n**2. 多项式混沌展开**\n\n速率参数 $k_1$ 和 $k_2$ 被建模为独立的对数正态随机变量。它们是独立标准正态随机变量 $Z_1, Z_2 \\sim \\mathcal{N}(0,1)$ 的函数：\n$$\nk_1(Z_1) = \\exp(\\mu_1 + \\sigma_1 Z_1)\n$$\n$$\nk_2(Z_2) = \\exp(\\mu_2 + \\sigma_2 Z_2)\n$$\n因此，目标量 $Y$ 是这两个随机变量的函数，$Y(Z_1, Z_2)$。我们使用总阶为 $p=2$ 的 PCE 来近似 $Y(Z_1, Z_2)$：\n$$\nY(Z_1, Z_2) \\approx \\hat{Y}(Z_1, Z_2) = \\sum_{|\\alpha| \\le 2} c_{\\alpha} \\Psi_{\\alpha}(Z_1, Z_2)\n$$\n其中 $\\alpha = (\\alpha_1, \\alpha_2)$ 是一个非负整数的多重索引，$|\\alpha| = \\alpha_1 + \\alpha_2$ 是其总阶，$c_{\\alpha}$ 是 PCE 系数，$\\Psi_{\\alpha}(Z_1, Z_2)$ 是多元基函数。基函数由一维标准正交的概率论埃尔米特多项式的张量积构成，$\\Psi_{\\alpha}(Z_1, Z_2) = \\psi_{\\alpha_1}(Z_1) \\psi_{\\alpha_2}(Z_2)$。所需的多项式为：\n$$\n\\psi_0(z) = 1\n$$\n$$\n\\psi_1(z) = z\n$$\n$$\n\\psi_2(z) = \\frac{z^2 - 1}{\\sqrt{2}}\n$$\n总阶数最高为 $p=2$ 的展开式包含 $P = \\frac{(n+p)!}{n!p!} = \\frac{(2+2)!}{2!2!} = 6$ 个基函数：\n$$\n\\hat{Y} = c_{00}\\Psi_{00} + c_{10}\\Psi_{10} + c_{01}\\Psi_{01} + c_{20}\\Psi_{20} + c_{02}\\Psi_{02} + c_{11}\\Psi_{11}\n$$\n\n**3. 通过谱投影法估计系数**\n\n系数 $c_{\\alpha}$ 是通过将模型输出 $Y$ 投影到基函数上计算得出的。由于基 $\\{\\Psi_\\alpha\\}$ 关于标准正态变量的联合概率密度函数 $\\phi(Z_1,Z_2) = \\phi(Z_1)\\phi(Z_2)$ 具有标准正交性，系数由内积给出：\n$$\nc_{\\alpha} = \\langle Y, \\Psi_{\\alpha} \\rangle = \\mathbb{E}[Y \\cdot \\Psi_{\\alpha}] = \\iint_{\\mathbb{R}^2} Y(Z_1, Z_2) \\Psi_{\\alpha}(Z_1, Z_2) \\phi(Z_1)\\phi(Z_2) \\,dZ_1 \\,dZ_2\n$$\n该积分使用每维 $q=9$ 个点的张量积高斯-埃尔米特求积法则进行数值近似。标准高斯-埃尔米特求积近似形如 $\\int_{-\\infty}^{\\infty} f(x) e^{-x^2} \\,dx$ 的积分。为了处理标准正态权重函数 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2}$，我们进行变量代换 $z = \\sqrt{2}x$。这导出了求积公式：\n$$\n\\int_{-\\infty}^{\\infty} g(z) \\phi(z) \\,dz = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} g(\\sqrt{2}x) e^{-x^2} \\,dx \\approx \\sum_{i=1}^{q} g(\\sqrt{2}x_i) \\frac{W_i}{\\sqrt{\\pi}}\n$$\n其中 $(x_i, W_i)$ 是标准的物理学家高斯-埃尔米特节点和权重。令 $z_i = \\sqrt{2}x_i$ 和 $w_i = W_i/\\sqrt{\\pi}$ 为概率论埃尔米特多项式的节点和权重。系数则估计为：\n$$\nc_{\\alpha} \\approx \\sum_{i=1}^{q} \\sum_{j=1}^{q} Y(z_i, z_j) \\Psi_{\\alpha}(z_i, z_j) w_i w_j\n$$\n该算法涉及在 $q \\times q$ 求积网格上的每个点 $(z_i, z_j)$ 评估完整模型 $Y(k_1(z_i), k_2(z_j))$。\n\n**4. 从 PCE 系数计算 Sobol' 敏感性指数**\n\n使用标准正交 PCE 的一个关键优势是，可以直接从系数计算 Sobol' 指数，而无需额外的模型评估。PCE 代理模型的总方差 $D$ 是所有非恒定系数的平方和：\n$$\nD = \\text{Var}[\\hat{Y}] = \\sum_{|\\alpha|  0} c_{\\alpha}^2 \\langle \\Psi_{\\alpha}^2 \\rangle = \\sum_{0  |\\alpha| \\le p} c_{\\alpha}^2\n$$\n对于我们的 $p=2$ 展开式，这等于：\n$$\nD \\approx c_{10}^2 + c_{01}^2 + c_{20}^2 + c_{02}^2 + c_{11}^2\n$$\n输入变量的一阶 Sobol' 指数衡量的是仅由该变量引起的方差占总方差的比例。对于输入 $Z_1$（其控制 $k_1$），这对应于所有仅依赖于 $Z_1$ 的基函数所贡献的方差。部分方差 $D_1$ 为：\n$$\nD_1 \\approx \\sum_{\\alpha_1=1}^{p} c_{(\\alpha_1, 0, \\dots, 0)}^2 = c_{10}^2 + c_{20}^2\n$$\n类似地，与 $Z_2$（其控制 $k_2$）相关的部分方差 $D_2$ 为：\n$$\nD_2 \\approx \\sum_{\\alpha_2=1}^{p} c_{(0, \\alpha_2, \\dots, 0)}^2 = c_{01}^2 + c_{02}^2\n$$\n参数 $k_1$ 和 $k_2$ 的一阶 Sobol' 指数则由下式给出：\n$$\nS_{k_1} = \\frac{D_1}{D} = \\frac{c_{10}^2 + c_{20}^2}{c_{10}^2 + c_{01}^2 + c_{20}^2 + c_{02}^2 + c_{11}^2}\n$$\n$$\nS_{k_2} = \\frac{D_2}{D} = \\frac{c_{01}^2 + c_{02}^2}{c_{10}^2 + c_{01}^2 + c_{20}^2 + c_{02}^2 + c_{11}^2}\n$$\n此过程将应用于所提供的四个测试用例。", "answer": "$$\n\\boxed{[0.210519, 0.781129, 0.499912, 0.499912, 0.493649, 0.494793, 0.019445, 0.978693]}\n$$", "id": "2673601"}]}