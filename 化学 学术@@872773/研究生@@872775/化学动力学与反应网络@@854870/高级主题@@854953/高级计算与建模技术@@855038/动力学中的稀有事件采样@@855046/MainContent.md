## 引言
在自然科学的广阔领域中，从单分子的[化学反应](@entry_id:146973)到宏观的生态演化，许多决定系统命运的关键性转变都以“稀有事件”的形式发生。这些事件，如蛋白质折叠、药物与靶点的解离或新物种的诞生，虽然至关重要，但其发生频率极低，系统在绝大多数时间内都停留在能量或构象的稳定区域。这种固有的时间尺度分离现象，对我们通过直接计算模拟来研究其动力学构成了根本性的障碍——计算机将耗费海量的资源来模拟系统在稳定态中看似“无趣”的等待过程。

本文旨在系统性地解决这一知识鸿沟，为读者提供一个关于[稀有事件采样](@entry_id:182602)理论与实践的全面指南。我们将深入探讨如何从计算上高效地捕捉和量化这些转瞬即逝却又意义深远的过程。

在“原理与机制”一章中，我们将首先剖析[时间尺度分离](@entry_id:149780)这一根本挑战，并追溯稀有事件的物理起源至[Kramers理论](@entry_id:185320)。随后，我们将引入提交者概率等严谨的数学工具，并在此基础上详细阐述一系列先进的采样算法策略，如过渡[路径采样](@entry_id:753258)（TPS）和[前向通量采样](@entry_id:187552)（FFS）。接下来，在“应用与跨学科连接”一章中，我们将展示这些理论和方法如何在[化学物理](@entry_id:199585)、分子生物学、[药物设计](@entry_id:140420)、[材料科学](@entry_id:152226)乃至生态学等前沿领域中发挥关键作用，将抽象的理论与具体的科学问题紧密相连。最后，“动手实践”部分将通过精心设计的计算问题，引导读者亲手应用所学知识，加深对核心概念的理解。通过这三部分的学习，读者将能够掌握[稀有事件采样](@entry_id:182602)的核心思想，并具备将其应用于各自研究领域的能力。

## 原理与机制

本章将深入探讨[稀有事件动力学](@entry_id:186537)采样所依据的核心科学原理与关键机制。我们将从稀有事件对直接模拟构成的根本挑战出发，建立描述这些过程的物理和数学框架，并最终系统地阐述为克服这些挑战而设计的各种先进算法策略。

### 根本挑战：[时间尺度分离](@entry_id:149780)

在化学动力学中，许多重要的过程，如[化学反应](@entry_id:146973)、[蛋白质折叠](@entry_id:136349)或[成核](@entry_id:140577)现象，都属于**稀有事件 (rare events)**。这些事件的特征是系统在绝大多数时间内都停留在能量上或构象上的**[亚稳态](@entry_id:167515) (metastable states)** 区域内，仅在极偶然的情况下，通过一个高能量的过渡态，快速地从一个[亚稳态跃迁](@entry_id:198964)到另一个。这种行为导致了[系统动力学](@entry_id:136288)中固有的**时间尺度分离 (separation of timescales)**：在[亚稳态](@entry_id:167515)区域内部的快速[振动](@entry_id:267781)或弛豫，以及在[亚稳态](@entry_id:167515)之间极其缓慢的、偶发的跃迁。

这种时间尺度分离对直接[随机模拟](@entry_id:168869)构成了巨大的计算挑战。我们可以通过分析化学反应网络的标准[模拟方法](@entry_id:751987)——**Gillespie[随机模拟算法](@entry_id:189454) (Stochastic Simulation Algorithm, SSA)** 来理解这一点 [@problem_id:2667181]。[Gillespie算法](@entry_id:749905)是一个精确的事件驱动方法，用于模拟由[化学主方程](@entry_id:161378)描述的连续时间[马尔可夫跳跃过程](@entry_id:751684)。其核心步骤是：

1.  在系统当前状态下，计算所有可能反应通道 $i$ 的**[反应倾向函数](@entry_id:181123) (propensity function)** $a_i$。总[倾向函数](@entry_id:181123)为所有通道倾向之和，$a_0 = \sum_i a_i$。
2.  从一个速率为 $a_0$ 的[指数分布](@entry_id:273894)中抽样，确定到下一个反应发生所需的等待时间 $\tau$。
3.  以概率 $a_i / a_0$ 选择下一个发生的反应通道 $i$。

现在，设想一个简化的亚[稳态模型](@entry_id:157508) [@problem_id:2667181]：系统位于一个[亚稳态](@entry_id:167515)盆地中，其中存在两类反应。一类是盆地内部的快速反应，总倾向为 $a_f$；另一类是导致系统离开盆地的稀有出口反应，其倾向为 $a_r$。根据稀有事件的定义，我们有 $a_r \ll a_f$。

根据[Gillespie算法](@entry_id:749905)，系统演化的平均时间步长为 $\mathbb{E}[\tau] = 1/a_0 = 1/(a_f + a_r)$。由于 $a_f \gg a_r$，这个时间步长约等于 $1/a_f$，非常短。然而，稀有的出口反应本身可以被看作一个独立的泊松过程，其速率为 $a_r$。因此，系统成功逃离该[亚稳态](@entry_id:167515)盆地的平均等待时间，即**平均[首次穿越时间](@entry_id:271944) (Mean First Passage Time, MFPT)**，为 $\mathbb{E}[T_{\text{exit}}] = 1/a_r$。

这意味着，为了在模拟中观察到一次稀有事件，我们平均需要模拟的总时长约为 $1/a_r$。在这段时间内，模拟算法执行的总步数约为 $(1/a_r) / (1/a_0) \approx (1/a_r) / (1/a_f) = a_f / a_r$。由于 $a_f/a_r$ 是一个非常大的数，这表明直接模拟将花费绝大部分的计算资源来模拟在亚稳态内部的、对于过渡事件本身而言“无意义”的快速[振动](@entry_id:267781)。这正是[稀有事件模拟](@entry_id:754079)的根本计算困境。增加更多的快速内部反应（增大 $a_f$）并不会加速稀有事件的发生，反而会使模拟步长变得更小，从而需要更多的计算步骤来跨越相同的时间间隔，使得问题更加棘手 [@problem_id:2667181]。

### 稀有事件的物理起源：越过势垒的激活过程

为了更深入地理解稀有事件的速率，我们需要从抽象的[倾向函数](@entry_id:181123)转向更具体的物理模型。在分子尺度上，系统的状态通常由其在多维**[势能面](@entry_id:147441) (Potential Energy Surface, PES)** 上的位置来描述。亚稳态对应于[势能面](@entry_id:147441)上的[局部极小值](@entry_id:143537)（[势阱](@entry_id:151413)），而稀有事件则对应于系统获得足够能量以越过分隔不同[势阱](@entry_id:151413)的**势垒 (potential barrier)** 的过程。

**[Kramers理论](@entry_id:185320) (Kramers' theory)** 为这一过程提供了首个重要的理论框架 [@problem_id:2667148]。该理论将粒子在一维[势能](@entry_id:748988) $U(x)$ 中的运动建模为**[Langevin动力学](@entry_id:142305)**，考虑了来自溶剂分子的随机碰撞（表现为**摩擦 (friction)** 和**噪声 (noise)**）。在**高摩擦极限（或称[过阻尼极限](@entry_id:161869)）**下，粒子的惯性可以忽略，其动力学由Smoluchowski方程描述。

Kramers推导出的逸出速率 $k$ 不仅依赖于势垒的高度 $\Delta U = U(x_b) - U(x_a)$（其中 $x_a$ 是[势阱](@entry_id:151413)底部，$x_b$ 是势垒顶部），还依赖于[势阱](@entry_id:151413)和势垒的形状（由阱底频率 $\omega_a$ 和垒顶[虚频](@entry_id:165180) $\omega_b$ 描述）以及与溶剂的耦合强度，即摩擦系数 $\zeta$。

在高摩擦极限下（$\zeta \gg \omega_b$），速率表达式为：
$$ k = \frac{\omega_a \omega_b}{2\pi \zeta} \exp(-\beta \Delta U) $$
其中 $\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是温度。在此区域，速率与摩擦系数成反比 ($k \propto 1/\zeta$)。这被称为**空间[扩散限制](@entry_id:153636) (spatial-diffusion limited)** 区域。物理上，这意味着粒子虽然有足够的能量到达势垒顶部，但由于与溶剂的强烈摩擦，它在顶部附近进行缓慢的布朗运动，很难有效地[扩散](@entry_id:141445)到产物区域，并且很容易重新落回反应物[势阱](@entry_id:151413)。

与此相对，在**低摩擦极限**下（$\zeta \ll \omega_b$），速率近似与摩擦系数成正比 ($k \propto \zeta$)。这被称为**能量[扩散限制](@entry_id:153636) (energy-diffusion limited)** 区域。此时，粒子与溶剂的耦合很弱，其能量变化缓慢。速率的瓶颈在于从溶剂中缓慢“收集”足够的热能以达到势垒高度。摩擦越强，能量交换越快，速率也越高。

这两个极限揭示了著名的**Kramers翻转 (Kramers' turnover)** 现象：随着摩擦系数 $\zeta$ 从零开始增加，逸出率先增大后减小。这一理论深刻地揭示了[反应速率](@entry_id:139813)并非仅由势垒高度决定，而是由势垒特性和环境动力学共同作用的结果。

### 亚稳态与过渡的严格描述

为了开发和分析先进的采样算法，我们需要对[亚稳态](@entry_id:167515)和过渡路径进行更严格的数学定义。

#### 亚稳态的定义

一个系统具有[亚稳态](@entry_id:167515)特性，并不仅仅意味着其全局[弛豫时间](@entry_id:191572)很长。一个更精确的定义是建立在时间尺度分离的局部化概念之上的 [@problem_id:2667176]。

考虑一个[马尔可夫过程](@entry_id:160396)，一个[子集](@entry_id:261956) $M$ 被称为是亚稳态的，如果以下两个条件成立：
1.  **快速内部混合**：从 $M$ 内部任意初始状态出发，在尚未离开 $M$ 的条件下，系统的[概率分布](@entry_id:146404)会快速地弛豫到一个唯一的**准平稳分布 (Quasi-Stationary Distribution, QSD)** $\nu_M$。这个[混合时间](@entry_id:262374) $\tau_{\text{mix}}^{(M)}$ 相对较短。
2.  **缓慢的外部逃逸**：一旦系统弛豫到 QSD，它会在 $M$ 中停留很长时间。从 QSD 开始的平均逃逸时间 $\mathbb{E}_{\nu_M}[T_{M^c}]$ 远大于内部[混合时间](@entry_id:262374)，即 $\tau_{\text{mix}}^{(M)} \ll \mathbb{E}_{\nu_M}[T_{M^c}]$。逃逸事件本身近似为一个泊松过程，其速率 $\lambda_M$ 很小。

这个定义将[亚稳态](@entry_id:167515)与由**谱隙 (spectral gap)** $\gamma$ 所衡量的全局慢混合区分开来。谱隙描述的是整个系统趋向于全局稳态分布 $\pi$ 的最慢速率。虽然具有亚稳态的系统必然有很小的[谱隙](@entry_id:144877)（因为亚稳态之间的慢跃迁主导了全局弛豫），但小的[谱隙](@entry_id:144877)本身并不足以定义[亚稳态](@entry_id:167515)。例如，一个粒子在一个大的、平滑的环上进行[扩散](@entry_id:141445)，其[谱隙](@entry_id:144877)可以任意小，但系统中不存在任何局部化的、快速平衡的区域。因此，亚稳态是一个比全局慢混合更强的、结构性的性质 [@problem_id:2667176]。

#### 提交者函数与[反应坐标](@entry_id:156248)

描述从反应物区域 $A$ 到产物区域 $B$ 的过渡过程的核心数学工具是**提交者概率 (committor probability)**，也称为[分裂概率](@entry_id:196942) (splitting probability) [@problem_id:2667189]。

**前向提交者函数 (forward committor)** $q(x)$（或记作 $q^+(x)$）被定义为：从状态 $x$ 出发的轨迹，在返回 $A$ 之前先到达 $B$ 的概率。
$$ q(x) = \mathbb{P}_x(\tau_B  \tau_A) $$
其中 $\tau_S$ 是首次到达集合 $S$ 的时间。

根据其定义，提交者函数满足以下边界条件：
-   若 $x \in A$，则 $q(x) = 0$。
-   若 $x \in B$，则 $q(x) = 1$。

在 $A$ 和 $B$ 之间的过渡区域中，对于一个由生成元 $L$ 描述的[马尔可夫过程](@entry_id:160396)，前向提交者函数是该算子的一个[调和函数](@entry_id:746864)，即它满足以下方程：
$$ Lq(x) = 0, \quad \text{for } x \notin A \cup B $$
这个方程是后向[Kolmogorov方程](@entry_id:270139)的一个特例。

相应地，可以定义**后向提交者函数 (backward committor)** $\tilde{q}(x)$（或 $q^-(x)$），它描述了从[稳态](@entry_id:182458)轨迹上的点 $x$ 回溯时，轨迹来自 $A$ 而非 $B$ 的概率。它等价于时间反演过程的前向提交者，其目标集是 $A$。后向提交者函数满足由$L$的伴随算子 $L^\dagger$ 所决定的方程 $L^\dagger \tilde{q}(x) = 0$，并带有边界条件 $\tilde{q}(x)=1$（对 $x \in A$）和 $\tilde{q}(x)=0$（对 $x \in B$） [@problem_id:2667189]。

提交者函数之所以如此重要，是因为它被认为是**理想的[反应坐标](@entry_id:156248) (reaction coordinate)** [@problem_id:2667157]。一个“好”的一维反应坐标 $\rho(x)$ 应该能够唯一地度量反应的进程。理论上，一个好的反应坐标是提交者函数的[严格单调函数](@entry_id:158442)，即 $\rho(x) = h(q(x))$，其中 $h$ 是一个严格增函数。

这个严格的函数关系意味着：
1.  如果两个微观状态 $x_1$ 和 $x_2$ 有相同的提交者值 $q(x_1) = q(x_2)$，那么它们的[反应坐标](@entry_id:156248)值也必须相同，$\rho(x_1) = \rho(x_2)$。
2.  如果 $q(x_1)  q(x_2)$，那么必须有 $\rho(x_1)  \rho(x_2)$。

任何不满足这些条件的备选反应坐标（例如，仅与提交者有良好[线性相关](@entry_id:185830)性的变量）都是有缺陷的。例如，如果存在两个状态 $x_a$ 和 $x_b$，使得 $q(x_a) = q(x_b)$ 但 $\rho(x_a) \neq \rho(x_b)$，那么 $\rho$ 的[等值面](@entry_id:196027)就不是提交者的[等值面](@entry_id:196027)。这意味着，当轨迹在这些[等值面](@entry_id:196027)上运动时，它实际上并未在反应进程上前进或后退，从而导致了所谓的**重过穿 (recrossing)** 现象。使用这样的[反应坐标](@entry_id:156248)来定义过渡态或计算速率，会得到依赖于具体阈值选择且通常不准确的结果 [@problem_id:2667157]。

所有反应性轨迹构成的集合，即从 $A$ 出发最终到达 $B$ 而不先返回 $A$ 的轨迹，被称为**过渡[路径系综](@entry_id:753252) (transition path ensemble)**。提交者值为 $q(x)=0.5$ 的[等值面](@entry_id:196027)，被称为**过渡态[曲面](@entry_id:267450) (transition state surface)**，它包含了所有过渡路径的瓶颈区域。

### [稀有事件采样](@entry_id:182602)的算法策略

基于上述原理，研究者们开发了多种巧妙的算法，旨在绕过直接模拟的计算瓶颈。这些算法大致可以分为几类。

#### 利用逃逸过程的泊松性质

这类方法的核心假设是，从一个[亚稳态](@entry_id:167515)盆地中的逃逸是一个**内存无关 (memoryless)** 的泊松过程 [@problem_id:2667195]。这意味着一旦系统在盆地内达到准[平稳分布](@entry_id:194199)，其逃逸的瞬时概率就与它在盆地内的历史无关。

-   **[并行副本动力学](@entry_id:753140) (Parallel Replica Dynamics, ParRep)**: 此方法直接利用了泊松过程的统计特性。它同时在 $N$ 个独立的处理器上运行系统的 $N$ 个相同副本（replica），每个副本都从亚稳态盆地内的准平稳分布中抽样开始。由于每个副本的逃逸过程都是独立的、速率为 $k$ 的泊松过程，因此第一个副本发生逃逸的时间 $\tau_{\min}$ 服从一个速率为 $Nk$ 的[指数分布](@entry_id:273894)。总的模拟物理时间通过将观测到的最短逃逸时间乘以副本数 $N$ 来恢复。因为每个副本都遵循真实的动力学，所以第一个发生的逃逸事件的类型（即逃逸到哪个邻近的盆地）是无偏的。ParRep通过空间并行化有效地加速了时间的演化 [@problem_id:2667195]。

-   **[温度加速动力学](@entry_id:755832) (Temperature-Accelerated Dynamics, TAD)**: 此方法通过在比目标温度 $T_\ell$ 高得多的温度 $T_h$ 下运行模拟来加速事件的发生。在高溫下，系统更容易越过势垒，从而可以在可接受的模拟时间内观察到多次逃逸事件，并测量出相应的[速率常数](@entry_id:196199) $k(T_h)$。然后，利用**Arrhenius关系式** $k(T) = \nu \exp(-\beta(T)\Delta E)$ 将速率外推回低温 $T_\ell$。该方法的有效性依赖于几个关键假设：从 $T_\ell$ 到 $T_h$ 的温度范围内，[反应机制](@entry_id:149504)（即相关的过渡态）保持不变，并且[指前因子](@entry_id:145277) $\nu$ 对温度的依赖性可以忽略 [@problem_id:2667195]。

-   **[超动力学](@entry_id:750477) (Hyperdynamics)**: 此方法通过修改系统的[势能面](@entry_id:147441)来加速模拟。它在原始[势能](@entry_id:748988) $U(x)$ 的基础上增加一个非负的**偏置势 (bias potential)** $\Delta V(x)$，使得修改后的[势能](@entry_id:748988)为 $U'(x) = U(x) + \Delta V(x)$。这个偏置势的设计原则是，在[势阱](@entry_id:151413)内部它为正值，从而“抬高”[势阱](@entry_id:151413)底部，但在分隔不同[势阱](@entry_id:151413)的过渡态[曲面](@entry_id:267450)上必须为零。这样，所有势垒的高度 $\Delta U$ 保持不变，保证了不同逃逸路径之间的相对速率不变，从而不改变逃逸事件的类型。由于[势阱](@entry_id:151413)被抬高，系统在偏置势下的逃逸速率被显著加速。物理时间通过对模拟过程中的“增强因子” $\exp[\beta \Delta V(x(t))]$ 进行积分来精确恢复。这种方法的核心是，在保持逃逸通道统计不变的前提下，仅仅缩短了等待时间 [@problem_id:2667195]。

#### 基于路径的[采样方法](@entry_id:141232)

这类方法不关注单个的逃逸事件，而是直接对连接反应物和产物的整个**过渡[路径系综](@entry_id:753252)**进行采样。

-   **过渡[路径采样](@entry_id:753258) (Transition Path Sampling, TPS)**: TPS是一种在轨[迹空间](@entry_id:756085)中进行的**[马尔可夫链蒙特卡洛 (MCMC)](@entry_id:137985)** 方法 [@problem_id:2667179]。其目标是从满足特定边界条件（如从 $A$ 开始，在 $B$ 结束）的[路径系综](@entry_id:753252) $\mathcal{P}[\omega]$ 中进行抽样。算法从一条已知的[反应路径](@entry_id:163735)开始，通过一系列“移动”来生成新的候选路径，从而在路径空间中进行探索。
    -   **射击 (shooting)** 移动：从当前路径 $\omega$ 上随机选择一个时间点（射击点），对该点的状态（如速度）施加一个小的随机扰动，然后从这个新的状态点分别向前和向后积分动力学方程，生成一条新的候选路径 $\omega'$。
    -   **平移 (shifting)** 移动：将当前路径的时间窗口沿着一条更长的轨迹进行微小的平移，生成新的路径。
    候选路径 $\omega'$ 根据**[Metropolis-Hastings准则](@entry_id:164679)**被接受或拒绝，该准则确保了最终采样的路径[分布](@entry_id:182848)收敛到目标[路径系综](@entry_id:753252) $\mathcal{P}[\omega]$。这个[接受概率](@entry_id:138494)依赖于新旧路径的概率比值以及生成过程的对称性。TPS的强大之处在于它不需要预先知道反应坐标，而是直接探索连接两个已知状态的动力学通道 [@problem_id:2667179, @problem_id:2667164]。

-   **[前向通量采样](@entry_id:187552) (Forward Flux Sampling, FFS)**: 与TPS不同，FFS是一种**路径分裂 (path splitting)** 或分支方法，而非MCMC [@problem_id:2667164]。它将从 $A$到$B$的稀有事件分解为一系列不那么稀有的连续步骤。
    1.  首先，在[状态空间](@entry_id:177074)中沿着一个选定的[序参量](@entry_id:144819) $\lambda$ 定义一系列不相交的**界面 (interfaces)** $\lambda_0, \lambda_1, \dots, \lambda_n=\lambda_B$。
    2.  在第一阶段，进行长时间的模拟，限制系统在区域 $A$ 及其附近，并测量从 $A$ 出发首次穿过第一个界面 $\lambda_0$ 的[稳态通量](@entry_id:183999) $\Phi_{A \to \lambda_0}$。同时，收集所有成功穿越 $\lambda_0$ 的系统构型。
    3.  在第二阶段，从在 $\lambda_i$ 上收集到的构型出发，发起大量短时间的、独立的模拟。追踪这些模拟，直到它们到达下一个界面 $\lambda_{i+1}$（成功）或返回到初始区域 $A$（失败）。成功轨迹的比例给出了[条件概率](@entry_id:151013) $P(\lambda_{i+1} | \lambda_i)$。
    最终，总的 $A \to B$ [反应速率](@entry_id:139813) $k_{AB}$ 可以通过将初始通量与所有后续的[条件概率](@entry_id:151013)连乘得到：$k_{AB} \propto \Phi_{A \to \lambda_0} \times \prod_{i=0}^{n-1} P(\lambda_{i+1} | \lambda_i)$。FFS的一个显著优点是，由于它在每个阶段都使用真实的动力学并且不依赖于满足路径空间中的细致平衡，因此它可以直接应用于**[非平衡稳态](@entry_id:141783) (non-equilibrium steady states)** 系统 [@problem_id:2667164]。

#### 路径重加权与粗粒化方法

-   **重要性采样 (Importance Sampling)**: 这种方法通过在一个修改过的、偏置的动力学系统 $\mathbb{Q}$ 中进行模拟来提高稀有事件的[采样效率](@entry_id:754496)，然后通过**重加权 (reweighting)** 来校正结果，以获得在原始物理系统 $\mathbb{P}$ 下的精确[期望值](@entry_id:153208) [@problem_id:2667154]。
    其核心公式为：$\mathbb{E}_{\mathbb{P}}[H] = \mathbb{E}_{\mathbb{Q}}[H(\omega) L(\omega)]$，其中 $H(\omega)$ 是路径上的可观测量，而 $L(\omega)$ 是权重，即**[Radon-Nikodym导数](@entry_id:158399)** $d\mathbb{P}/d\mathbb{Q}$。对于连续时间[马尔可夫跳跃过程](@entry_id:751684)，这个权重（或称似然比）由两部分组成：一部分是路径上所有发生的反应的[倾向函数](@entry_id:181123)在原始系统和偏置系统中比值的乘积；另一部分是一个指数项，它解释了由于总[倾向函数](@entry_id:181123)改变而导致的两次跳跃之间[等待时间分布](@entry_id:262786)的变化。其具体形式为：
    $$ L(\omega) = \frac{d\mathbb{P}}{d\mathbb{Q}}(\omega) = \exp\left( \sum_{j=1}^n \log \frac{a_{r_j}(X_{t_j^-})}{\tilde{a}_{r_j}(X_{t_j^-})} - \int_0^T (\lambda(X_s) - \tilde{\lambda}(X_s)) ds \right) $$
    其中 $a_r$ 和 $\tilde{a}_r$ 分别是原始和偏置倾向，$\lambda$ 和 $\tilde{\lambda}$ 是相应的总倾向。选择合适的偏置动力学是该方法的关键。

-   **里程碑方法 (Milestoning)**: 这是一种对状态空间进行**粗粒化 (coarse-graining)** 的方法 [@problem_id:2667150]。它引入一系列不相交的[超曲面](@entry_id:159491)，称为**里程碑 (milestones)** $\Sigma_i$，将整个状态空间划分为不同的单元。完整的动力学过程被简化为在这些离散的里程碑之间的一系列跳跃。
    该方法的核心是**马尔可夫跳跃假设 (Markovian hopping assumption)**，即系统到达下一个里程碑的身份以及所需的时间，仅取决于它当前所在的里程碑，而与它如何到达该里程碑的历史无关。这个假设的物理基础同样是[时间尺度分离](@entry_id:149780)：当轨迹到达一个里程碑 $\Sigma_i$ 后，它在该里程碑上的构象[分布](@entry_id:182848)会快速弛豫到一个[局部平衡](@entry_id:156295)态，这个[弛豫时间](@entry_id:191572) $\tau_{\text{relax},i}$ 远小于从该里程碑跳跃到下一个里程碑的平均时间 $\tau_{\text{hop},i}$。这种快速的内存擦除使得里程碑之间的动力学近似马尔可夫。为了更好地满足这一条件，一个理想的选择是将里程碑设置为提交者函数的[等值面](@entry_id:196027)（即等提交者[曲面](@entry_id:267450)），因为沿着这些[曲面](@entry_id:267450)的弛豫通常比垂直于它们的反应进程快得多 [@problem_id:2667150]。通过模拟从每个里程碑出发的短轨迹来计算里程碑之间的跃迁概率和平均穿越时间，最终可以重构出整个系统的全局动力学，如平均[首次穿越时间](@entry_id:271944)和[反应速率](@entry_id:139813)。