{"hands_on_practices": [{"introduction": "复杂的生物化学网络通常涉及在截然不同的时间尺度上发生的过程。为了分析随机共振这类在长时间尺度上展开的现象，通过消除快速反应的物种来简化系统至关重要。这项实践 [@problem_id:2659058] 将引导你运用强大的准稳态近似 (Quasi-Steady-State Approximation, QSSA) 技术，将一个基因调控网络的二维化学朗之万方程简化为有效的一维模型，这是为慢随机动力学建模的一项基本技能。", "problem": "考虑一个自调控单体物种 $X$ 的反应网络，该单体通过一个慢步骤二聚化成 $D$。反应如下：\n1. $X$ 的零级生产，受二聚体 $D$ 激活：$\\varnothing \\to X$，倾向为 $a_{1}(n_{d},t) = \\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]$，其中 $n_{d}$ 是 $D$ 的拷贝数，$\\alpha_{0} > 0$ 是基础生产速率，$\\alpha_{a} \\ge 0$ 是激活剂强度，$K > 0$ 是半激活常数，$0 \\le \\epsilon \\ll 1$ 和 $\\omega > 0$ 定义了一个弱周期性驱动。\n2. $X$ 的一级降解：$X \\to \\varnothing$，倾向为 $a_{2}(n_{x}) = \\gamma\\, n_{x}$，其中 $n_{x}$ 是 $X$ 的拷贝数，$\\gamma > 0$ 是降解速率。\n3. 慢速二聚化：$2X \\to D$，倾向为 $a_{3}(n_{x}) = k_{d}\\,\\frac{n_{x}(n_{x}-1)}{2}$，其中 $k_{d} > 0$ 很小。\n4. 慢速解离：$D \\to 2X$，倾向为 $a_{4}(n_{d}) = k_{r}\\, n_{d}$，其中 $k_{r} > 0$ 很小。\n\n假设处于介观尺度，其中化学主方程（CME）可以很好地被化学朗之万方程（CLE）近似，并且存在明显的时间尺度分离，$X$ 的生灭动力学与二聚体的形成和解离相比是快速的（$\\gamma$ 很大，$k_{d}$ 和 $k_{r}$ 很小）。在伊东 (Itô) 诠释下进行计算。您的任务是：\n\na) 从倾向和化学计量出发，写出 $(n_x, n_d)$ 的二维CLE。\n\nb) 执行准稳态近似（QSSA），通过将快速的 $X$ 动力学设置为其瞬时稳态，从而消去 $n_x$，用 $n_d$ 表示。在此过程中，保留来自解离的源项 $+2a_4$，但相对于 $\\gamma n_{x}$，在小比率 $k_{d}/\\gamma$ 的领头阶上忽略汇项 $-2a_3$。求解准稳态单体拷贝数 $n_{x}^{*}(n_{d},t)$，用参数以及 $n_d, t$ 表示。\n\nc) 将 $n_{x}^{*}(n_{d},t)$ 代入慢速的 $D$ 动力学中，以获得 $n_{d}(t)$ 的有效一维朗之万方程，形式如下\n$$\n\\mathrm{d} n_{d} \\;=\\; f(n_{d},t)\\,\\mathrm{d}t \\;+\\; \\sqrt{g(n_{d},t)}\\,\\mathrm{d}W_{t},\n$$\n识别漂移项 $f(n_{d},t)$ 和扩散强度 $g(n_{d},t)$，用 $n_d, t$ 和参数表示。您的推导应从CME到CLE近似和时间尺度分离的第一性原理出发，明确说明所使用的任何近似。\n\nd) 这个有效的随机微分方程适用于克拉默斯 (Kramers) 逃逸率估计（当 $\\epsilon=0$ 时）和随机共振（SR）分析（当 $0  \\epsilon \\ll 1$ 时），因为慢坐标 $n_d$ 经历了通过 $a_{1}(n_{d},t)$ 产生的弱周期性调制的漂移。最后，陈述由您的QSSA得出的漂移项 $f(n_{d},t)$ 的显式闭式表达式。\n\n作为您的最终答案，仅提供 $f(n_{d},t)$ 关于 $\\alpha_{0}, \\alpha_{a}, K, \\epsilon, \\omega, \\gamma, k_{d}, k_{r}$ 以及变量 $n_{d}$ 和 $t$ 的简化符号表达式。最终的框式答案中不要包含单位。如果您引入任何辅助符号，请在最终表达式中将其消去。无需进行数值评估。", "solution": "问题陈述需经过验证。\n\n**第一步：提取已知条件**\n- **物种和拷贝数：** 单体 $X$ ($n_x$) 和二聚体 $D$ ($n_d$)。\n- **反应网络和倾向：**\n    1. $\\varnothing \\to X$: $a_{1}(n_{d},t) = \\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]$\n    2. $X \\to \\varnothing$: $a_{2}(n_{x}) = \\gamma\\, n_{x}$\n    3. $2X \\to D$: $a_{3}(n_{x}) = k_{d}\\,\\frac{n_{x}(n_{x}-1)}{2}$\n    4. $D \\to 2X$: $a_{4}(n_{d}) = k_{r}\\, n_{d}$\n- **参数和约束：**\n    - $\\alpha_{0}  0$ (基础生产速率)\n    - $\\alpha_{a} \\ge 0$ (激活剂强度)\n    - $K  0$ (半激活常数)\n    - $0 \\le \\epsilon \\ll 1$ (弱驱动振幅)\n    - $\\omega  0$ (驱动频率)\n    - $\\gamma  0$ 很大 (降解速率)\n    - $k_{d}  0$ 很小 (二聚化速率)\n    - $k_{r}  0$ 很小 (解离速率)\n- **假设：**\n    - 系统处于介观尺度，证明化学朗之万方程（CLE）作为化学主方程（CME）的近似是合理的。\n    - 时间尺度分离：$X$ 动力学是快速的，$D$ 动力学是慢速的。\n    - 随机微分方程的伊东 (Itô) 诠释。\n    - 对于准稳态近似（QSSA），在 $n_x$ 动力学方程中，相对于 $\\gamma n_x$ 忽略 $-2a_3$ 项，但保留 $+2a_4$ 项。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了一个带有周期性外部信号的典型基因自调控模型，这是系统生物学和非平衡统计力学中的一个标准课题。反应倾向基于质量作用动力学和希尔型调控，这些都是公认的原理。该问题在科学上是合理的。\n- **适定性：** 问题提供了一套完整的反应、参数和约束。任务定义清晰，涉及随机化学动力学中标准但高级的技术（CLE、QSSA）。可以推导出所要求的漂移项的唯一解析表达式。\n- **客观性：** 问题以精确、客观和定量的语言表述，没有任何主观性或模糊性。\n\n**第三步：结论与行动**\n该问题有效。它是一个来自随机化学动力学领域的、定义明确且具有科学依据的问题。将提供完整解答。\n\n**求解过程**\n\n**a) 二维化学朗之万方程**\n\n系统的状态由拷贝数向量 $\\boldsymbol{n} = (n_x, n_d)^T$ 描述。反应1、2、3、4中拷贝数的变化由化学计量向量 $\\boldsymbol{s}_1 = (1, 0)^T$、$\\boldsymbol{s}_2 = (-1, 0)^T$、$\\boldsymbol{s}_3 = (-2, 1)^T$ 和 $\\boldsymbol{s}_4 = (2, -1)^T$ 给出。CLE的一般形式，对每个反应通道 $j$ 使用独立的维纳过程 $\\mathrm{d}W_j$，是：\n$$ \\mathrm{d}\\boldsymbol{n} = \\sum_{j=1}^{4} \\boldsymbol{s}_j a_j(\\boldsymbol{n}, t) \\mathrm{d}t + \\sum_{j=1}^{4} \\boldsymbol{s}_j \\sqrt{a_j(\\boldsymbol{n}, t)} \\mathrm{d}W_j $$\n对每个物种写出该方程：\n对于 $n_x$：\n$$ \\mathrm{d}n_x = (a_1 - a_2 - 2a_3 + 2a_4)\\mathrm{d}t + \\sqrt{a_1}\\mathrm{d}W_1 - \\sqrt{a_2}\\mathrm{d}W_2 - 2\\sqrt{a_3}\\mathrm{d}W_3 + 2\\sqrt{a_4}\\mathrm{d}W_4 $$\n对于 $n_d$：\n$$ \\mathrm{d}n_d = (a_3 - a_4)\\mathrm{d}t + \\sqrt{a_3}\\mathrm{d}W_3 - \\sqrt{a_4}\\mathrm{d}W_4 $$\n其中倾向 $a_j$ 是问题陈述中定义的关于 $n_x, n_d,$ 和 $t$ 的函数。\n\n**b) 对 $n_x$ 的准稳态近似 (QSSA)**\n\n由于降解速率 $\\gamma$ 很大，变量 $n_x$ 是快速变量。由于 $k_d$ 和 $k_r$ 很小，变量 $n_d$ 是慢速变量。我们执行QSSA，假设 $n_x$ 瞬时平衡到一个值 $n_x^*$，该值取决于慢速变量 $n_d$ 的当前状态和时间 $t$。我们将 $n_x$ 的CLE的确定性部分设为零：\n$$ \\frac{\\mathrm{d}n_x}{\\mathrm{d}t}|_{\\text{det}} = a_1(n_d, t) - a_2(n_x) - 2a_3(n_x) + 2a_4(n_d) = 0 $$\n问题指示，相对于快速降解项 $-a_2(n_x) = -\\gamma n_x$，忽略来自慢速二聚化反应的项 $-2a_3(n_x) = -k_d n_x(n_x-1)$。这个近似是合理的，因为它们的特征速率之比 $k_d/\\gamma$ 很小。但是，我们必须保留项 $2a_4(n_d) = 2k_r n_d$。因此，QSSA方程简化为：\n$$ a_1(n_d, t) - a_2(n_x^*) + 2a_4(n_d) = 0 $$\n$$ \\left(\\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]\\right) - \\gamma n_x^* + 2k_r n_d = 0 $$\n求解准稳态单体拷贝数 $n_x^*$：\n$$ n_x^*(n_d, t) = \\frac{1}{\\gamma} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right) $$\n\n**c) $n_d$ 的有效一维朗之万方程**\n\n为了获得慢速变量 $n_d$ 的有效动力学，我们将QSSA结果代入 $n_d$ 的CLE中。一个严谨的过程包括在给定慢速变量 $n_d$ 的条件下，对快速变量 $n_x$ 的稳态分布求倾向的平均值。\n漂移项为 $f(n_d, t) = \\langle a_3(n_x) - a_4(n_d) \\rangle_{fast} = \\langle a_3(n_x) \\rangle_{fast} - a_4(n_d)$。\n对于固定的 $n_d$ 和 $t$， $n_x$ 的动力学近似为一个线性生灭过程，其出生率为 $B = a_1(n_d, t) + 2k_r n_d$，单位分子的死亡率为 $\\gamma$。在此近似下，$n_x$ 的稳态分布是均值为 $\\lambda = B/\\gamma = n_x^*(n_d, t)$ 的泊松分布。\n二聚化倾向 $a_3(n_x)$ 的平均值为：\n$$ \\langle a_3(n_x) \\rangle_{fast} = \\left\\langle k_d \\frac{n_x(n_x-1)}{2} \\right\\rangle_{fast} = \\frac{k_d}{2} \\langle n_x(n_x-1) \\rangle_{fast} $$\n对于均值为 $\\lambda$ 的泊松分布变量，其二阶阶乘矩为 $\\langle k(k-1) \\rangle = \\lambda^2$。因此：\n$$ \\langle a_3(n_x) \\rangle_{fast} = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 $$\n因此，$n_d$ 的有效一维朗之万方程的漂移项为：\n$$ f(n_d, t) = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 - k_r n_d $$\n扩散强度 $g(n_d, t)$ 是影响 $n_d$ 的反应的平均倾向之和：\n$$ g(n_d, t) = \\langle a_3(n_x) \\rangle_{fast} + a_4(n_d) = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 + k_r n_d $$\n得到的有效一维朗之万方程是：\n$$ \\mathrm{d} n_{d} = \\left( \\frac{k_d}{2} [n_x^*(n_d, t)]^2 - k_r n_d \\right) \\mathrm{d}t + \\sqrt{\\frac{k_d}{2} [n_x^*(n_d, t)]^2 + k_r n_d} \\, \\mathrm{d}W_t $$\n\n**d) 漂移项 $f(n_d, t)$ 的显式表达式**\n\n最后的任务是提供漂移项 $f(n_d, t)$ 的显式闭式表达式。我们将(b)部分得到的 $n_x^*(n_d, t)$ 表达式代入(c)部分找到的 $f(n_d, t)$ 表达式中：\n$$ f(n_d, t) = \\frac{k_d}{2} \\left[ \\frac{1}{\\gamma} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right) \\right]^2 - k_r n_d $$\n这可以写成：\n$$ f(n_d, t) = \\frac{k_d}{2\\gamma^2} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right)^2 - k_r n_d $$\n这是慢速二聚体动力学的有效朗之万方程的漂移项的最终表达式，适用于分析系统中的双稳态和随机共振。", "answer": "$$\n\\boxed{\\frac{k_d}{2\\gamma^2} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right)^2 - k_r n_d}\n$$", "id": "2659058"}, {"introduction": "一旦系统可以用一个有效的势能景观来描述，关键问题就变成了：噪声以多快的速度诱导势阱之间的跃迁？这项实践 [@problem_id:2659063] 通过应用克拉默斯理论 (Kramers' theory) 来计算转换速率，从而深入探讨了噪声诱导跃迁的核心。通过从势的性质推导速率，你将对势垒高度和噪声强度如何决定随机转换的时间尺度获得定量的理解。", "problem": "一个充分混合细胞中的单基因正反馈模块由于双稳态性而表现出两种长寿命的表达状态。经过无量纲化并投影到基因表达的一维序参量 $x$ 上后，化学主方程 (CME) 在大系统尺寸极限下可近似为化学朗之万方程，其过阻尼 Itô 形式为\n$$\ndx \\;=\\; -\\,U'(x)\\,dt \\;+\\; \\sqrt{2\\,\\varepsilon}\\,dW_t,\n$$\n其中 $U(x)$ 是一个有效势，$\\varepsilon0$ 是一个捕捉内在涨落的无量纲小噪声振幅，$W_t$ 是一个标准维纳过程。考虑有效势\n$$\nU(x) \\;=\\; \\frac{A}{4}\\,(x-1)^{2}\\,(x-3)^{2},\n$$\n其中 $A0$ 是一个无量纲控制参数。这两个基因表达状态对应于 $x_{L}=1$ 和 $x_{H}=3$ 处的极小值点，它们被位于 $x_{B}=2$ 的激活势垒隔开。\n\n使用适用于 CME 朗之万极限的第一性原理（即与上述 Itô 随机微分方程相关联的 Smoluchowski 方程和小噪声奇异微扰计算），计算从低表达状态 $x_{L}$ 转换到高表达状态 $x_{H}$ 的平均转换速率 $k_{L}$ 的领头阶渐近表达式，包括领头指数因子和领头前因子。独立地，在过阻尼、小噪声机制下，基于相同的有效势 $U(x)$ 计算 Kramers 型越垒估计值 $k_{K}$。最后，求出比值\n$$\nR \\;=\\; \\frac{k_{L}}{k_{K}}.\n$$\n将 $R$ 作为你的最终答案，它是一个无量纲数。无需四舍五入，也无需报告单位。", "solution": "必须首先验证问题陈述的科学合理性、一致性和完整性。\n\n第1步：提取已知条件。\n系统由一个一维过阻尼朗之万方程的 Itô 形式描述：\n$$dx = -U'(x)dt + \\sqrt{2\\varepsilon}dW_t$$\n其中 $x$ 是一个无量纲序参量，$W_t$ 是一个标准维纳过程，$\\varepsilon  0$ 是一个小噪声振幅。\n有效势由下式给出：\n$$U(x) = \\frac{A}{4}(x-1)^2(x-3)^2$$\n其中 $A  0$。\n系统在 $x_L = 1$（低表达）和 $x_H = 3$（高表达）处有两个稳定态（$U(x)$ 的极小值点），它们被位于势垒位置 $x_B = 2$ 的一个不稳定态（$U(x)$ 的极大值点）隔开。\n任务是：\n1. 使用随机过程的第一性原理（Smoluchowski 方程和奇异微扰理论）计算从状态 $x_L$ 到状态 $x_H$ 的平均转换速率 $k_L$。\n2. 计算 Kramers 型越垒估计值 $k_K$。\n3. 计算比值 $R = \\frac{k_L}{k_K}$。\n\n第2步：使用提取的已知条件进行验证。\n该问题具有科学依据。朗之万方程是化学主方程的一个标准且合适的连续极限，用于模拟像双稳态基因回路这样的化学反应网络中的随机性。势 $U(x)$ 是一个用于模拟双稳态的经典双阱势。所要求的方法——用于 Smoluchowski (Fokker-Planck) 方程的奇异微扰理论和 Kramers 速率理论——是分析此类系统中噪声诱导转换的典范工具。该问题是适定的、客观的，并包含推导所需量所需的全部信息。参数 $A$ 和 $\\varepsilon$ 是符号性的，最终答案是一个比值，这表明这些参数将会消去，这对于一个结构良好的理论问题来说是典型的。\n该问题没有缺陷。这是一个统计物理学中的标准但很微妙的问题。\n\n第3步：结论与行动。\n问题有效。将提供解答。\n\n该问题需要计算两个速率 $k_L$ 和 $k_K$ 以及它们的比值。\n\n首先，我们从第一性原理计算平均转换速率 $k_L$。朗之万方程对应于概率密度 $p(x,t)$ 的 Smoluchowski（或一维 Fokker-Planck）方程：\n$$ \\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x} \\left[ U'(x)p(x,t) + \\varepsilon \\frac{\\partial p(x,t)}{\\partial x} \\right] $$\n平均转换速率 $k_L$ 是控制从低表达状态到高表达状态转换的速率常数。对于一个双稳态系统，其动力学可以粗粒化为一个两态模型 $L \\rightleftharpoons H$，由以下速率方程描述：\n$$ \\frac{dP_L}{dt} = -k_L P_L + k_H P_H $$\n$$ \\frac{dP_H}{dt} = k_L P_L - k_H P_H $$\n其中 $P_L$ 和 $P_H$ 分别是处于 $x_L$ 和 $x_H$ 吸引盆中的概率。我们寻求的量 $k_L$ 是正向速率常数。\n\n系统的最慢弛豫模式对应于两个势阱之间的概率交换。这个弛豫的速率由 Fokker-Planck 算子的最小非零本征值 $\\lambda_1$ 给出。该本征值通过 $\\lambda_1 = k_L + k_H$ 与宏观速率常数相关。\n\n为了继续，我们必须分析势 $U(x)$ 的性质。\n势的极小值点位于 $x_L=1$ 和 $x_H=3$。\n$U(1) = \\frac{A}{4}(1-1)^2(1-3)^2 = 0$。\n$U(3) = \\frac{A}{4}(3-1)^2(3-3)^2 = 0$。\n势垒位于 $x_B=2$。\n$U(2) = \\frac{A}{4}(2-1)^2(2-3)^2 = \\frac{A}{4}$。\n正向转换 $L \\to H$ 的势垒高度为 $\\Delta U_L = U(x_B) - U(x_L) = \\frac{A}{4} - 0 = \\frac{A}{4}$。\n反向转换 $H \\to L$ 的势垒为 $\\Delta U_H = U(x_B) - U(x_H) = \\frac{A}{4} - 0 = \\frac{A}{4}$。\n由于势垒高度相等，该势关于转换态是对称的。这意味着在小噪声极限下，正向和反向速率相等：$k_L = k_H$。\n因此，本征值与速率之间的关系简化为 $\\lambda_1 = 2k_L$，这意味着 $k_L = \\lambda_1/2$。\n\n通过 Fokker-Planck 方程的奇异微扰理论进行的“第一性原理”计算，得出了在小噪声极限（$\\varepsilon \\to 0$）下 $\\lambda_1$ 的领头阶渐近表达式：\n$$ \\lambda_1 = \\frac{\\sqrt{U''(x_L)|U''(x_B)|}}{\\pi} \\exp\\left(-\\frac{\\Delta U_L}{\\varepsilon}\\right) $$\n我们必须计算势在极小值点和势垒顶点的二阶导数。\n$U'(x) = A(x-1)(x-2)(x-3)$。\n$U''(x) = A[(x-2)(x-3) + (x-1)(x-3) + (x-1)(x-2)] = A(3x^2 - 12x + 11)$。\n在低表达极小值点 $x_L = 1$ 处：\n$U''(1) = A(3(1)^2 - 12(1) + 11) = A(3-12+11) = 2A$。\n在势垒顶点 $x_B = 2$ 处：\n$U''(2) = A(3(2)^2 - 12(2) + 11) = A(12-24+11) = -A$。\n其绝对值为 $|U''(2)| = A$。\n\n将这些值代入 $\\lambda_1$ 的表达式中：\n$$ \\lambda_1 = \\frac{\\sqrt{(2A)(A)}}{\\pi} \\exp\\left(-\\frac{A/4}{\\varepsilon}\\right) = \\frac{A\\sqrt{2}}{\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right) $$\n由于势的对称性，平均转换速率 $k_L$ 是该值的一半：\n$$ k_L = \\frac{1}{2}\\lambda_1 = \\frac{A\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right) $$\n\n接下来，我们计算 Kramers 型越垒估计值 $k_K$。对应于给定朗之万方程（其有效摩擦系数为 $\\gamma=1$）的过阻尼机制的标准 Kramers 速率公式是：\n$$ k_K = \\frac{\\sqrt{U''(x_L)|U''(x_B)|}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_L}{\\varepsilon}\\right) $$\n这个表达式是通量-布居数计算的结果，它正确地考虑了轨迹重新穿过势垒的概率。使用我们之前计算的曲率和势垒高度值：\n$$ k_K = \\frac{\\sqrt{(2A)(A)}}{2\\pi} \\exp\\left(-\\frac{A/4}{\\varepsilon}\\right) = \\frac{\\sqrt{2A^2}}{2\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right) = \\frac{A\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right) $$\n我们观察到，平均转换速率 $k_L$ 的第一性原理计算和速率估计值 $k_K$ 的标准 Kramers 公式得出了相同的表达式。其微妙之处在于，对于一个对称势，正确地将平均转换速率 $k_L$ 等同于 $\\lambda_1/2$，这是严格的第一性原理推导的基石。\n\n最后，我们计算比值 $R$：\n$$ R = \\frac{k_L}{k_K} = \\frac{\\frac{A\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right)}{\\frac{A\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{A}{4\\varepsilon}\\right)} = 1 $$\n该比值恰好为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2659063"}, {"introduction": "随机共振的一个著名特征是系统响应对噪声强度的非单调依赖性。这最后一项实践 [@problem_id:2659065] 提供了一个完整的动手工作流程，以计算方式验证随机共振的这一标志性特征。你将模拟一个受弱周期性驱动的双稳态系统，对其输出信号进行谱分析，并通过分析信噪比 (Signal-to-Noise Ratio, SNR) 作为噪声的函数，来实施一个决策规则以区分真实的随机共振与确定性同步。", "problem": "考虑一个受到热涨落和弱周期性驱动影响的双稳态化学反应坐标。您将使用一个粗粒化的过阻尼朗之万方程，该方程模拟了一个捕获两种亚稳化学态的双稳态有效势。您的任务是设计并实现一个统计决策规则，通过探究输出信噪比 (SNR) 对噪声强度的依赖关系，来区分真正的随机共振 (SR) 与平凡的确定性同步。该决策必须基于第一性原理，您的程序必须：生成时间序列，估计驱动频率处的信噪比，评估信噪比随噪声强度变化的非单调性，然后判断是否存在随机共振。所有测试用例的最终输出必须是包含一个布尔值列表的单行文本。\n\n基本和建模假设。使用过阻尼朗之万方程来描述在对称四次势和正弦驱动力作用下的双稳态反应坐标，\n$$\n\\mathrm{d}x = \\left(-\\frac{\\mathrm{d}U}{\\mathrm{d}x} + A\\cos(2\\pi f t)\\right)\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中 $x$ 是粗粒化反应坐标，$U(x)$ 是势能，$A$ 是驱动振幅，$f$ 是驱动频率，$D$ 是有效噪声强度（与 $U(x)$ 单位相同），$W_t$ 是标准维纳过程。使用四次势\n$$\nU(x) = \\frac{a}{4}x^4 - \\frac{b}{2}x^2,\n$$\n其中 $a0$ 且 $b0$，因此在 $\\pm \\sqrt{b/a}$ 附近有两个势阱。在单位摩擦的无量纲单位下进行计算。该系统代表了慢反应坐标附近的通用双稳态反应网络。驱动频率处的信噪比 (SNR) 由 $x(t)$ 的功率谱密度定义，即驱动频率处的谱功率与在附近频率处稳健估计的局部谱背景之比。\n\n您的程序必须实现以下组件：\n\n1) 时域模拟。使用与连续态化学动力学的过阻尼朗之万动力学一致的标准时间离散化方案，对随机微分方程进行数值积分，并为不同的噪声强度 $D$ 生成实现 $x(t)$。丢弃初始瞬态，并使用剩余部分来估计谱。\n\n2) 信噪比估计。使用 $x(t)$ 的离散傅里叶变换，估计单边功率谱密度，并计算驱动频率 $f$ 处的信噪比 (SNR)，其计算方法为最接近 $f$ 的频率仓中的谱功率与通过排除驱动仓的相邻频率仓计算出的噪声基底的稳健估计值之比。信噪比必须为正实数。\n\n3) 统计决策规则。设计一个测试，在以下两者之间做出决策：\n- 假设 $\\mathrm{H}_1$ (真正的随机共振)：$A$ 是亚阈值的，使得 $D\\to 0$ 时的信噪比很小，并且信噪比作为 $D$ 的函数表现出非单调的单峰依赖关系，其内部最大值以具有科学意义的余量超过端点值。在小的 $D$ 范围内，信噪比随 $D$ 增加；在大的 $D$ 范围内，信噪比随 $D$ 减小。\n- 假设 $\\mathrm{H}_0$ (非随机共振，包括确定性同步)：信噪比在 $D=0$ 时已经很高，并且没有显示出可归因于噪声的内部最大值，或者信噪比在测试的 $D$ 范围内是单调的，没有足够显著的内部最大值。\n\n您的测试必须通过结合至少以下要素来将上述内容形式化：(i) 检测信噪比对 $D$ 的关系图中一个严格的内部峰值，该峰值比两个端点值都大一个指定的余量，(ii) 离散斜率在峰值附近从正（低 $D$）到负（高 $D$）的符号变化，以及 (iii) 检查当提供 $D=0$ 时，在 $\\mathrm{H}_1$ 假设下 $D=0$ 处的信噪比与峰值相比很小，但在 $\\mathrm{H}_0$ 假设下则不然。每个案例的最终决策必须是布尔值：如果接受 $\\mathrm{H}_1$ 则返回 $True$，否则返回 $False$。\n\n数值细节。对势能使用以下参数集：$a=1$ 和 $b=1$。对于驱动，使用下面每个测试用例指定的 $f$。使用每个用例指定的时间步长 $\\Delta t$、总时间 $T$ 进行模拟，并丢弃前 $\\theta T$（其中 $\\theta=\\;0.1$）作为瞬态。频率以与无量纲的 $t$ 和 $x$ 一致的时间倒数单位表示。当出现角度时，必须以弧度为单位。输出中不需要物理单位，因为输出是布尔值。\n\n测试套件。您的程序必须按指定顺序运行以下四个案例并输出决策：\n\n- 案例 1 (预期为真正的SR): $A=\\;0.15$, $f=\\;0.05$, $D\\in\\{0.02,\\,0.05,\\,0.08,\\,0.12,\\,0.18\\}$, $\\Delta t=\\;0.02$, $T=\\;500$。\n- 案例 2 (预期为确定性同步): $A=\\;0.80$, $f=\\;0.05$, $D\\in\\{0.00,\\,0.02,\\,0.05,\\,0.08\\}$, $\\Delta t=\\;0.02$, $T=\\;500$。\n- 案例 3 (无驱动；预期为非SR): $A=\\;0.00$, $f=\\;0.05$, $D\\in\\{0.02,\\,0.05,\\,0.08,\\,0.12\\}$, $\\Delta t=\\;0.02$, $T=\\;500$。\n- 案例 4 (在测试范围内单调；预期为非SR): $A=\\;0.10$, $f=\\;0.02$, $D\\in\\{0.005,\\,0.010,\\,0.020,\\,0.030\\}$, $\\Delta t=\\;0.02$, $T=\\;800$。\n\n算法约束。在谱估计中使用加窗以减少泄漏。噪声基底估计必须排除驱动仓周围至少 $\\pm 2$ 个频率仓的对称邻域。在不包括零频率的频带上，使用稳健统计量（例如，中位数）来估计噪声基底。对于给定的随机数生成器种子，您的决策规则必须是确定性的。\n\n最终输出格式。您的程序应生成单行输出，其中包含四个布尔决策，以逗号分隔的列表形式包含在方括号中，顺序与上述案例一致。例如，打印的行必须看起来像\n$$\n[\\mathrm{True},\\mathrm{False},\\mathrm{False},\\mathrm{False}],\n$$\n但其中的决策是您的方法从模拟中计算出的实际结果。\n\n您的程序必须是完全自包含的：它必须定义上述所有参数，内部生成所有数据，并且只打印最终结果行。不允许有其他输出。", "solution": "该问题要求设计并实现一种计算方法，用于区分双稳态化学系统中的真正随机共振 (SR) 与确定性同步或其他非共振行为。该分析将基于系统对不同热噪声强度的响应。这需要模拟系统动力学，执行谱分析以量化输出信噪比 (SNR)，并基于 SNR 的非单调行为应用一个有原则的决策规则，这是 SR 的标志。\n\n系统动力学由反应坐标 $x(t)$ 的过阻尼朗之万方程建模，该坐标受到势能力、周期性驱动力和随机热涨落的影响：\n$$\n\\mathrm{d}x = \\left(-\\frac{\\mathrm{d}U(x)}{\\mathrm{d}x} + A\\cos(2\\pi f t)\\right)\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n此处，$x$ 是无量纲反应坐标，$t$ 是无量纲时间，$U(x)$ 是双稳态势能，$A$ 是外部周期驱动的振幅，$f$ 是其频率，$D$ 是代表热能的噪声强度，$W_t$ 是模拟白噪声的标准维纳过程。该势能是一个对称的四次双阱，由下式给出：\n$$\nU(x) = \\frac{a}{4}x^4 - \\frac{b}{2}x^2\n$$\n使用指定参数 $a=1$ 和 $b=1$，势能变为 $U(x) = \\frac{1}{4}x^4 - \\frac{1}{2}x^2$。该势能在 $x = \\pm\\sqrt{b/a} = \\pm 1$ 处有两个稳定极小值，对应两个亚稳化学态。这些状态由位于 $x=0$ 处的势垒隔开，势垒高度为 $\\Delta U = U(0) - U(\\pm 1) = 0 - (\\frac{1}{4} - \\frac{1}{2}) = \\frac{1}{4}$。\n\n为了模拟系统的演化，我们必须对随机微分方程 (SDE) 进行数值积分。一阶 Euler-Maruyama 方法是完成此任务的标准且合适的选择。坐标 $x$ 在时间步 $i$ 的离散化更新规则是：\n$$\nx_{i+1} = x_i + \\left[ -(ax_i^3 - bx_i) + A\\cos(2\\pi f t_i) \\right] \\Delta t + \\sqrt{2D\\Delta t} Z_i\n$$\n其中 $t_i = i\\Delta t$，$\\Delta t$ 是时间步长，$Z_i$ 是从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取的随机变量。每个模拟运行总时间 $T$，并将生成的时间序列的初始 $10\\%$ 作为瞬态周期丢弃，以确保分析是在系统的统计平稳态上进行的，从初始条件 $x(0)=-1$ 开始。\n\n信噪比 (SNR) 是检测 SR 的关键指标。它是根据 $x(t)$ 的平稳时间序列的功率谱密度 (PSD) 估计的。步骤如下：\n1.  对时间序列数据应用汉宁窗以减少谱泄漏，这是有限时间傅里叶分析的一种人为现象。\n2.  使用加窗数据的实数快速傅里叶变换 (`rfft`) 计算单边功率谱密度。第 $k$ 个频率仓的功率 $P_k$ 与相应傅里叶系数的幅度平方 $|X_k|^2$ 成正比。\n3.  信号功率 $S_{sig}$ 定义为最接近外部驱动频率 $f$ 的单个频率仓 $k_f$ 中包含的功率。\n4.  噪声功率 $S_{noise}$ 是信号频率附近谱背景的稳健估计。它被计算为围绕信号仓 $k_f$ 的一个频带内功率值的中位数。为避免信号峰的污染，此计算排除了 $k_f$ 周围 $\\pm 2$ 个频率仓的区域。\n5.  信噪比是无量纲比率 $SNR = S_{sig} / S_{noise}$。\n\n最后一步是对计算出的 SNR 值作为噪声强度 $D$ 的函数应用决策规则。对于每个测试用例，都为一组给定的 $D$ 值 $\\{D_j\\}$ 计算 SNR。分析所得曲线 $\\text{SNR}(D)$ 以确定是否存在 SR。\n\n如果 $\\text{SNR}(D)$ 曲线表现出统计上显著的、非单调的、单峰的峰值，则接受假设 $\\mathrm{H}_1$ (真正的 SR)。这通过以下联合准则进行形式化：\n1.  **内部峰值**：最大信噪比必须出现在一个噪声强度 $D_{peak}$ 处，该强度严格位于测试的最小和最大 $D$ 值之间。如果最大信噪比出现在 $D$ 范围的任一端点，则认为该行为在测试范围内是单调的，并拒绝 $\\mathrm{H}_1$。\n2.  **峰值显著性**：SR 峰值必须显著大于范围边界处的背景信号响应。我们通过要求最大信噪比 $\\text{SNR}_{max}$ 比端点信噪比大一个余量因子 $R_{margin}$ 来量化这一点。条件是 $\\text{SNR}_{max} > R_{margin} \\cdot \\text{SNR}_{first}$ 并且 $\\text{SNR}_{max} > R_{margin} \\cdot \\text{SNR}_{last}$。为该规则选择的值为 $R_{margin}=1.25$。\n3.  **亚阈值条件**：强驱动或“超阈值”驱动即使在没有噪声 ($D=0$) 的情况下也能引起周期性转换，导致 $D=0$ 时的高信噪比。这是确定性同步，不是 SR。为了区分这一点，如果 $D=0$ 是测试集的一部分，我们施加一个更严格的要求：峰值信噪比必须远大于零噪声时的信噪比。条件是 $\\text{SNR}_{max} > R_{sub} \\cdot \\text{SNR}_{D=0}$，选择的余量为 $R_{sub}=2.0$。\n\n如果给定测试用例满足所有适用条件，则结果为 `True`，表示存在 SR。否则，结果为 `False`。这个基于 SR 物理原理的确定性规则，允许对所提供测试用例中系统行为进行稳健且可复现的分类。使用固定的随机种子以确保随机模拟本身是可复现的。", "answer": "```python\nimport numpy as np\nimport scipy.fft\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for Stochastic Resonance detection.\n    \"\"\"\n    # Set a global seed for reproducibility of the stochastic simulations.\n    # The problem implies seeds are given, but they are not. A fixed seed must be used.\n    np.random.seed(42)\n\n    def run_simulation(a, b, A, f, D, dt, T, theta):\n        \"\"\"\n        Simulates the overdamped Langevin equation using the Euler-Maruyama method.\n        \n        Args:\n            a, b: Quartic potential parameters.\n            A, f: Drive amplitude and frequency.\n            D: Noise intensity.\n            dt: Time step.\n            T: Total simulation time.\n            theta: Fraction of time series to discard as transient.\n\n        Returns:\n            The stationary part of the time series x(t).\n        \"\"\"\n        num_steps = int(T / dt)\n        t = np.linspace(0, T, num_steps)\n        x = np.zeros(num_steps)\n        x[0] = -1.0  # Start at one of the potential minima\n\n        # Pre-generate random numbers for efficiency\n        white_noise = np.random.randn(num_steps)\n\n        # Euler-Maruyama integration\n        for i in range(num_steps - 1):\n            force = -(a * x[i]**3 - b * x[i]) + A * np.cos(2 * np.pi * f * t[i])\n            x[i+1] = x[i] + force * dt + np.sqrt(2 * D * dt) * white_noise[i]\n\n        transient_steps = int(theta * num_steps)\n        return x[transient_steps:]\n\n    def calculate_snr(ts, dt, f):\n        \"\"\"\n        Calculates the Signal-to-Noise Ratio (SNR) from a time series.\n\n        Args:\n            ts: The time series data.\n            dt: The time step of the series.\n            f: The drive frequency to find the signal peak.\n\n        Returns:\n            The estimated SNR.\n        \"\"\"\n        n = len(ts)\n        if n == 0:\n            return 0.0\n\n        # Apply Hanning window to reduce spectral leakage\n        windowed_ts = ts * np.hanning(n)\n\n        # Compute the real FFT and the corresponding frequencies\n        fft_coeffs = scipy.fft.rfft(windowed_ts)\n        fft_freqs = scipy.fft.rfftfreq(n, d=dt)\n        \n        # Power is the squared magnitude of the FFT coefficients\n        power = np.abs(fft_coeffs)**2\n\n        # Find the index of the frequency bin closest to the drive frequency\n        drive_idx = np.argmin(np.abs(fft_freqs - f))\n        \n        # Signal power is the power in the drive frequency bin\n        signal_power = power[drive_idx]\n        \n        # Define noise estimation band, excluding the peak and its immediate neighbors\n        noise_exclude_half_width = 2\n        noise_band_half_width = 15 # robustly estimate over a wider band\n        \n        noise_indices = []\n        low_start = max(1, drive_idx - noise_band_half_width) # Exclude DC component (index 0)\n        low_end = drive_idx - noise_exclude_half_width\n        if low_end > low_start:\n            noise_indices.extend(range(low_start, low_end))\n            \n        high_start = drive_idx + noise_exclude_half_width + 1\n        high_end = min(len(power), drive_idx + noise_band_half_width + 1)\n        if high_end > high_start:\n            noise_indices.extend(range(high_start, high_end))\n\n        if not noise_indices:\n            # Fallback if frequency bins are too few\n            return 1.0\n\n        # Noise power is the median of the power in the noise band\n        noise_power = np.median(power[noise_indices])\n\n        if noise_power == 0:\n            # Avoid division by zero; if noise is zero, SNR is effectively infinite\n            # but usually indicates an issue. Let's return a large number or 1.0 if signal is also 0.\n            return 1.0 if signal_power == 0 else 1e12\n\n        return signal_power / noise_power\n\n    def is_sr(d_values, snr_values):\n        \"\"\"\n        Applies the statistical decision rule to determine if Stochastic Resonance is present.\n\n        Args:\n            d_values: List of noise intensities.\n            snr_values: List of corresponding SNR values.\n\n        Returns:\n            True if SR is detected, False otherwise.\n        \"\"\"\n        # SR requires a non-monotonic curve with an interior peak. Min 3 points needed.\n        if len(d_values)  3:\n            return False\n\n        snr_arr = np.array(snr_values)\n        i_max = np.argmax(snr_arr)\n        snr_max = snr_arr[i_max]\n\n        # 1. Interior Peak Condition: The maximum SNR must not be at the endpoints.\n        if not (0  i_max  len(snr_arr) - 1):\n            return False\n        \n        # 2. Peak Prominence Condition: The peak must be significantly higher than endpoints.\n        margin = 1.25\n        is_prominent = snr_max > margin * snr_arr[0] and snr_max > margin * snr_arr[-1]\n        if not is_prominent:\n            return False\n            \n        # 3. Subthreshold Drive Condition: If D=0 is tested, SNR should show large gain.\n        # This rules out deterministic entrainment where SNR is already high at D=0.\n        if d_values[0] == 0.0:\n            subthreshold_margin = 2.0\n            if not (snr_max > subthreshold_margin * snr_arr[0]):\n                return False\n        \n        # If all conditions pass, it is classified as genuine SR.\n        return True\n\n    # --- Test Suite ---\n    \n    # Potential parameters\n    a, b = 1.0, 1.0\n    # Transient discard fraction\n    theta = 0.1\n\n    test_cases = [\n        {'id': 1, 'A': 0.15, 'f': 0.05, 'D_values': [0.02, 0.05, 0.08, 0.12, 0.18], 'dt': 0.02, 'T': 500},\n        {'id': 2, 'A': 0.80, 'f': 0.05, 'D_values': [0.00, 0.02, 0.05, 0.08], 'dt': 0.02, 'T': 500},\n        {'id': 3, 'A': 0.00, 'f': 0.05, 'D_values': [0.02, 0.05, 0.08, 0.12], 'dt': 0.02, 'T': 500},\n        {'id': 4, 'A': 0.10, 'f': 0.02, 'D_values': [0.005, 0.010, 0.020, 0.030], 'dt': 0.02, 'T': 800},\n    ]\n\n    results = []\n    for case in test_cases:\n        snr_values = []\n        for D in case['D_values']:\n            ts = run_simulation(a, b, case['A'], case['f'], D, case['dt'], case['T'], theta)\n            snr = calculate_snr(ts, case['dt'], case['f'])\n            snr_values.append(snr)\n        \n        decision = is_sr(case['D_values'], snr_values)\n        results.append(decision)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2659065"}]}