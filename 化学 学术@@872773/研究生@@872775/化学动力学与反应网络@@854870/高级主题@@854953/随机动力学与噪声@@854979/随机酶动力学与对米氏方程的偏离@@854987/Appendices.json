{"hands_on_practices": [{"introduction": "我们的第一个实践练习探讨“静态无序”这一概念，即一个酶群体由多个独立的、不相互转换的亚群组成。我们将推导这种异质性如何影响整体反应速率，尤其是在低底物浓度下。这个练习将展示为何简单地对米氏常数（$K_M$）等动力学参数进行平均会导致错误的预测，并揭示一个基本原理：异质性可以系统地改变观测到的动力学行为。[@problem_id:2677172]", "problem": "考虑一个遵循经典结合-催化反应网络 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 的酶的体外批量分析，该分析在准稳态近似 (QSSA) 条件下进行。该分析包含大量互不相互作用的酶分子，由于存在一个巨大的底物库，这些酶分子暴露在均匀且不随时间变化的底物浓度 $[S]$ 中。该酶群体表现出静态无序（群体异质性）：一部分比例为 $p \\in (0,1)$ 的分子属于亚群1，其米氏常数为 $K_{M,1}$；剩余比例为 $1-p$ 的分子属于亚群2，其米氏常数为 $K_{M,2} \\neq K_{M,1}$。假设两个亚群具有相同的催化转换常数 $k_{\\mathrm{cat}}$ 和相同的双分子结合常数 $k_{\\mathrm{on}}$，而 $K_{M,i}$ 的差异源于 $k_{\\mathrm{off},i}$ 的不同，其关系为 $K_{M,i} = (k_{\\mathrm{off},i} + k_{\\mathrm{cat}})/k_{\\mathrm{on}}$。总酶浓度为 $[E]_{\\mathrm{tot}}$，其中亚群1的浓度为 $p [E]_{\\mathrm{tot}}$，亚群2的浓度为 $(1-p) [E]_{\\mathrm{tot}}$。\n\n将每个亚群在QSSA下视作均相，并对静态无序进行系综平均，从第一性原理推导零底物极限倍数偏差的解析表达式：\n$$r_{0} \\equiv \\lim_{[S] \\to 0} \\frac{v_{\\mathrm{het}}([S])}{v_{\\mathrm{hom}}([S])},$$\n其中 $v_{\\mathrm{het}}([S])$ 是通过对给定 $[S]$ 下两个亚群的速率进行平均计算得到的系综平均初始生成速率，而 $v_{\\mathrm{hom}}([S])$ 是通过将算术平均的米氏常数 $\\overline{K}_{M} \\equiv p K_{M,1} + (1-p) K_{M,2}$（以及共同的 $k_{\\mathrm{cat}}$）代入均相酶的标准QSSA速率定律得到的朴素均相初始生成速率。\n\n你的推导必须从均相酶的QSSA速率定律出发，并利用独立性和期望的线性性质来构建异质群体的系综平均。将你的最终答案表示为仅包含 $p$、$K_{M,1}$ 和 $K_{M,2}$ 的闭式解析表达式。最终答案中不应包含任何单位。不要通过代入任何数值来简化。最终答案必须是单个表达式，而不是方程或不等式。", "solution": "问题陈述经过严格验证，被认为是科学上合理、定义明确、客观且自洽的。这是化学动力学中的一个有效问题，具体涉及静态无序对系综平均酶反应速率的影响。我们可以开始推导。\n\n基本的出发点是在准稳态近似 (QSSA) 下为均相酶群体推导出的米氏-门腾速率定律。对于一个总浓度为 $[E]_{\\mathrm{tot}}$、催化转换常数为 $k_{\\mathrm{cat}}$、米氏常数为 $K_M$ 的酶，在底物浓度为 $[S]$ 时，产物生成的初始速率 $v$ 为：\n$$v([S]) = \\frac{k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S]}{K_M + [S]}$$\n此方程将应用于每个亚群以及假想的均相群体。\n\n首先，我们构建异质群体系综平均初始速率 $v_{\\mathrm{het}}([S])$ 的表达式。总酶群体（浓度为 $[E]_{\\mathrm{tot}}$）是两个不相互作用的亚群的混合物。总速率是每个亚群贡献的速率之和。\n亚群1的浓度为 $[E]_1 = p [E]_{\\mathrm{tot}}$，米氏常数为 $K_{M,1}$，催化常数为 $k_{\\mathrm{cat}}$。其速率 $v_1([S])$ 为：\n$$v_1([S]) = \\frac{k_{\\mathrm{cat}} [E]_1 [S]}{K_{M,1} + [S]} = \\frac{k_{\\mathrm{cat}} (p [E]_{\\mathrm{tot}}) [S]}{K_{M,1} + [S]}$$\n亚群2的浓度为 $[E]_2 = (1-p) [E]_{\\mathrm{tot}}$，米氏常数为 $K_{M,2}$，并具有相同的催化常数 $k_{\\mathrm{cat}}$。其速率 $v_2([S])$ 为：\n$$v_2([S]) = \\frac{k_{\\mathrm{cat}} [E]_2 [S]}{K_{M,2} + [S]} = \\frac{k_{\\mathrm{cat}} ((1-p) [E]_{\\mathrm{tot}}) [S]}{K_{M,2} + [S]}$$\n异质混合物的总速率 $v_{\\mathrm{het}}([S])$ 是这两个速率之和：\n$$v_{\\mathrm{het}}([S]) = v_1([S]) + v_2([S]) = k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S] \\left( \\frac{p}{K_{M,1} + [S]} + \\frac{1-p}{K_{M,2} + [S]} \\right)$$\n\n接下来，我们构建朴素均相初始生成速率 $v_{\\mathrm{hom}}([S])$ 的表达式。该速率的计算假设整个酶群体是均相的，其浓度为 $[E]_{\\mathrm{tot}}$，催化常数为 $k_{\\mathrm{cat}}$，米氏常数为算术平均值 $\\overline{K}_{M}$。问题将此平均值定义为：\n$$\\overline{K}_{M} = p K_{M,1} + (1-p) K_{M,2}$$\n将此平均参数代入标准的米氏-门腾速率定律，得到：\n$$v_{\\mathrm{hom}}([S]) = \\frac{k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S]}{\\overline{K}_{M} + [S]} = \\frac{k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S]}{(p K_{M,1} + (1-p) K_{M,2}) + [S]}$$\n\n现在，我们必须计算零底物极限倍数偏差 $r_0$，其定义为：\n$$r_{0} \\equiv \\lim_{[S] \\to 0} \\frac{v_{\\mathrm{het}}([S])}{v_{\\mathrm{hom}}([S])}$$\n我们使用上面推导出的表达式来构造比率：\n$$ \\frac{v_{\\mathrm{het}}([S])}{v_{\\mathrm{hom}}([S])} = \\frac{k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S] \\left( \\frac{p}{K_{M,1} + [S]} + \\frac{1-p}{K_{M,2} + [S]} \\right)}{\\frac{k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S]}{(p K_{M,1} + (1-p) K_{M,2}) + [S]}} $$\n对于任何非零底物浓度 $[S] \\neq 0$，分子和分母中的公因子 $k_{\\mathrm{cat}} [E]_{\\mathrm{tot}} [S]$ 可以消去。这得到：\n$$ \\frac{v_{\\mathrm{het}}([S])}{v_{\\mathrm{hom}}([S])} = \\left( \\frac{p}{K_{M,1} + [S]} + \\frac{1-p}{K_{M,2} + [S]} \\right) \\left( (p K_{M,1} + (1-p) K_{M,2}) + [S] \\right) $$\n现在可以通过直接代入来计算 $[S] \\to 0$ 时的极限，因为所得表达式在 $[S] = 0$ 处是 $[S]$ 的连续函数：\n$$ r_0 = \\lim_{[S] \\to 0} \\left[ \\left( \\frac{p}{K_{M,1} + [S]} + \\frac{1-p}{K_{M,2} + [S]} \\right) \\left( (p K_{M,1} + (1-p) K_{M,2}) + [S] \\right) \\right] $$\n代入 $[S] = 0$：\n$$ r_0 = \\left( \\frac{p}{K_{M,1} + 0} + \\frac{1-p}{K_{M,2} + 0} \\right) \\left( (p K_{M,1} + (1-p) K_{M,2}) + 0 \\right) $$\n这可以简化为：\n$$ r_0 = \\left( \\frac{p}{K_{M,1}} + \\frac{1-p}{K_{M,2}} \\right) \\left( p K_{M,1} + (1-p) K_{M,2} \\right) $$\n此表达式用所需的参数 $p$、$K_{M,1}$ 和 $K_{M,2}$ 给出了答案。为了将其表示为单个分数，我们为第一项找到一个公分母：\n$$ \\frac{p}{K_{M,1}} + \\frac{1-p}{K_{M,2}} = \\frac{p K_{M,2} + (1-p) K_{M,1}}{K_{M,1} K_{M,2}} $$\n将此代回 $r_0$ 的表达式，得到最终的解析形式：\n$$ r_0 = \\frac{\\left( p K_{M,2} + (1-p) K_{M,1} \\right) \\left( p K_{M,1} + (1-p) K_{M,2} \\right)}{K_{M,1} K_{M,2}} $$\n这个结果可以解释为 $K_M$ 值的算术平均值 $\\overline{K_M}$ 与 $K_M$ 倒数值的算术平均值 $\\overline{1/K_M}$ 的乘积。根据算术-调和平均值不等式，该乘积总是大于或等于1，当且仅当 $K_{M,1} = K_{M,2}$ 时等号成立。这表明，用算术平均参数来近似异质群体会系统性地低估在低底物浓度下的催化效率。该结果在物理上和数学上都是一致的。", "answer": "$$\n\\boxed{\\frac{\\left( p K_{M,2} + (1-p) K_{M,1} \\right) \\left( p K_{M,1} + (1-p) K_{M,2} \\right)}{K_{M,1} K_{M,2}}}\n$$", "id": "2677172"}, {"introduction": "从静态群体转向单个分子的动态行为，这个练习深入探讨了“动态无序”现象。在这里，单个酶分子随时间在不同的构象状态之间波动。你将学习如何将单分子实验中可测量的统计量——例如平均产物生成速率和法诺因子——与酶的内在、不可直接观测的微观速率联系起来。这个问题阐明了随机分析在提取经典系综测量无法获得的详细机理信息方面的强大能力。[@problem_id:2677167]", "problem": "一个酶分子在非活性构象 $\\mathrm{I}$ 和活性构象 $\\mathrm{A}$ 之间相互转换，其过程为一个连续时间马尔可夫链 (CTMC)，从 $\\mathrm{I}$ 到 $\\mathrm{A}$ 的转移速率为 $\\alpha$，从 $\\mathrm{A}$ 到 $\\mathrm{I}$ 的转移速率为 $\\beta$。在底物饱和的条件下，产物生成事件以一个点过程的形式发生，其风险率（hazard）依赖于状态：当酶处于 $\\mathrm{A}$ 状态时，产物以催化速率 $k$（一级风险率）生成；当酶处于 $\\mathrm{I}$ 状态时，不生成产物。您可以在单分子分辨率下长时间观察带有时间戳的产物生成事件，但无法直接观察到构象状态。一项独立的单分子构象涨落探测实验得到了该双态过程的构象自相关时间 $\\tau_{c}$。\n\n假设以下模型基础：\n- 催化事件过程是一个双重随机泊松过程 (DSPP)，也称为考克斯过程 (Cox process)，其随机强度为 $\\lambda(t) = k \\,\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)$，由底层的构象动力学双态 CTMC 驱动。\n- 构象 CTMC 是平稳的，其平稳活性分数（stationary active fraction）为 $p = \\alpha/(\\alpha+\\beta)$，相关速率（correlation rate）为 $\\gamma = \\alpha+\\beta = 1/\\tau_{c}$。\n- 长时间法诺因子 (long-time Fano factor) $F_{\\infty}$ 定义为 $F_{\\infty} = \\lim_{T \\to \\infty} \\operatorname{Var}[N(T)]/\\mathbb{E}[N(T)]$，其中 $N(T)$ 是在时长为 $T$ 的窗口内的产物事件数。\n\n仅根据这些基础和定义（不要使用任何无法从它们推导出来的现成公式），推导催化速率 $k$ 关于稳态平均生成速率 $m = \\lim_{T \\to \\infty} \\mathbb{E}[N(T)]/T$、长时间法诺因子 $F_{\\infty}$ 和构象相关时间 $\\tau_{c}$ 的显式表达式。然后，根据测量值 $m = 3.0 \\, \\mathrm{s}^{-1}$、$F_{\\infty} = 2.2$ 和 $\\tau_{c} = 0.5 \\, \\mathrm{s}$，对 $k$ 进行数值计算。\n\n以 $\\mathrm{s}^{-1}$ 为单位表示最终的催化速率，并将答案四舍五入至四位有效数字。", "solution": "本问题要求基于所提供的随机模型，从第一性原理出发推导催化速率 $k$。我们将首先进行严格的推导，然后进行数值计算。\n\n首先，我们分析产物事件的平均数 $\\mathbb{E}[N(T)]$。该过程被定义为一个双重随机泊松过程 (DSPP)，其随机强度为 $\\lambda(t) = k \\,\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)$，其中 $\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)$ 是酶处于活性状态 $\\mathrm{A}$ 的指示函数。根据 DSPP 的性质和积分算子的线性特性，在时长为 $T$ 的时间间隔内，事件数 $N(T)$ 的平均值为：\n$$ \\mathbb{E}[N(T)] = \\mathbb{E}\\left[\\int_0^T \\lambda(t) \\, dt\\right] = \\int_0^T \\mathbb{E}[\\lambda(t)] \\, dt $$\n强度的期望值为：\n$$ \\mathbb{E}[\\lambda(t)] = \\mathbb{E}[k \\,\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)] = k \\, \\mathbb{E}[\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)] $$\n指示函数 $\\mathbb{E}[\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)]$ 的期望值是酶在时间 $t$ 处于活性状态 $\\mathrm{A}$ 的概率。由于假设底层的构象 CTMC 是平稳的，这个概率就是平稳活性分数 $p$，它不随时间变化：$\\mathbb{E}[\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)] = p$。因此：\n$$ \\mathbb{E}[N(T)] = \\int_0^T k p \\, dt = k p T $$\n稳态平均生成速率 $m$ 定义为 $m = \\lim_{T \\to \\infty} \\mathbb{E}[N(T)]/T$。根据我们的结果，得到第一个基本关系式：\n$$ m = \\lim_{T \\to \\infty} \\frac{k p T}{T} = kp $$\n\n接下来，我们推导事件数 $N(T)$ 的方差 $\\operatorname{Var}[N(T)]$。对于一个 DSPP，全方差公式（也称为条件方差公式）给出：\n$$ \\operatorname{Var}[N(T)] = \\mathbb{E}[\\operatorname{Var}[N(T) | \\{\\lambda(t')\\}_{0 \\le t' \\le T}]] + \\operatorname{Var}[\\mathbb{E}[N(T) | \\{\\lambda(t')\\}_{0 \\le t' \\le T}]] $$\n在给定强度过程 $\\lambda(t)$ 的一个特定实现下，计数过程 $N(T)$ 是一个非齐次泊松过程。其条件均值和条件方差都等于积分强度 $\\Lambda_T = \\int_0^T \\lambda(t) \\, dt$。因此：\n$$ \\operatorname{Var}[N(T)] = \\mathbb{E}[\\Lambda_T] + \\operatorname{Var}[\\Lambda_T] $$\n我们已经确定 $\\mathbb{E}[\\Lambda_T] = \\mathbb{E}[N(T)] = k p T$。任务简化为求积分强度的方差：\n$$ \\operatorname{Var}[\\Lambda_T] = \\operatorname{Var}\\left[\\int_0^T k \\,\\mathbf{1}_{\\{\\mathrm{A}\\}}(t) \\, dt\\right] = k^2 \\operatorname{Var}\\left[\\int_0^T \\mathbf{1}_{\\{\\mathrm{A}\\}}(t) \\, dt\\right] $$\n一个平稳随机过程的时间积分的方差由其自协方差函数的二重积分给出：\n$$ \\operatorname{Var}\\left[\\int_0^T \\mathbf{1}_{\\{\\mathrm{A}\\}}(t) \\, dt\\right] = \\int_0^T \\int_0^T C_{\\mathbf{1}}(t_1, t_2) \\, dt_1 \\, dt_2 $$\n其中 $C_{\\mathbf{1}}(t_1, t_2) = \\operatorname{Cov}[\\mathbf{1}_{\\{\\mathrm{A}\\}}(t_1), \\mathbf{1}_{\\{\\mathrm{A}\\}}(t_2)]$。对于平穩的双态 CTMC，已知其自协方差函数随时间延迟 $\\tau = |t_2-t_1|$呈指数衰减：\n$$ C_{\\mathbf{1}}(\\tau) = \\operatorname{Var}[\\mathbf{1}_{\\{\\mathrm{A}\\}}(0)] \\exp(-\\gamma \\tau) $$\n伯努利随机变量 $\\mathbf{1}_{\\{\\mathrm{A}\\}}(t)$ 的方差是 $p(1-p)$。这给出：\n$$ C_{\\mathbf{1}}(\\tau) = p(1-p) \\exp(-\\gamma |\\tau|) $$\n其中 $\\gamma = \\alpha+\\beta = 1/\\tau_c$ 是相关速率。我们现在计算这个二重积分：\n$$ \\int_0^T \\int_0^T \\exp(-\\gamma |t_2 - t_1|) \\, dt_1 \\, dt_2 = \\frac{2}{\\gamma^2}(\\gamma T - 1 + \\exp(-\\gamma T)) $$\n这是一个标准结果。因此，积分强度的方差为：\n$$ \\operatorname{Var}[\\Lambda_T] = k^2 p(1-p) \\frac{2}{\\gamma^2}(\\gamma T - 1 + \\exp(-\\gamma T)) $$\n合并各项得到 $N(T)$ 的总方差：\n$$ \\operatorname{Var}[N(T)] = k p T + 2 k^2 p(1-p) \\frac{1}{\\gamma^2}(\\gamma T - 1 + \\exp(-\\gamma T)) $$\n\n现在我们使用长时间法诺因子 $F_{\\infty}$ 的定义：\n$$ F_{\\infty} = \\lim_{T \\to \\infty} \\frac{\\operatorname{Var}[N(T)]}{\\mathbb{E}[N(T)]} = \\lim_{T \\to \\infty} \\frac{k p T + 2k^2 p(1-p)\\frac{1}{\\gamma^2}(\\gamma T - 1 + \\exp(-\\gamma T))}{k p T} $$\n分子和分母同除以 $k p T$：\n$$ F_{\\infty} = \\lim_{T \\to \\infty} \\left( 1 + \\frac{2k(1-p)}{\\gamma^2} \\left(\\gamma - \\frac{1}{T} + \\frac{\\exp(-\\gamma T)}{T}\\right) \\right) $$\n当 $T \\to \\infty$ 时取极限，乘以 $1/T$ 和 $\\exp(-\\gamma T)/T$ 的项消失，得到：\n$$ F_{\\infty} = 1 + \\frac{2k(1-p)}{\\gamma} $$\n这个结果表明，法诺因子偏离泊松值 $1$ 是由酶的随机转换引起的，其程度由速率 $k$ 和 $\\gamma$ 以及占据概率 $p$ 量化。\n\n我们有两个联系微观参数和宏观可观测量的方程：\n1.  $m = kp$\n2.  $F_{\\infty} = 1 + \\frac{2k(1-p)}{\\gamma}$\n\n我们的目标是求出 $k$。我们消去未观测的参数 $p$。由第一个方程，我们有 $p = m/k$。将此代入第二个方程：\n$$ F_{\\infty} = 1 + \\frac{2k(1 - m/k)}{\\gamma} = 1 + \\frac{2(k-m)}{\\gamma} $$\n现在，我们求解 $k$：\n$$ F_{\\infty} - 1 = \\frac{2(k-m)}{\\gamma} $$\n$$ \\gamma(F_{\\infty} - 1) = 2(k-m) $$\n$$ k-m = \\frac{\\gamma}{2}(F_{\\infty} - 1) $$\n$$ k = m + \\frac{\\gamma}{2}(F_{\\infty} - 1) $$\n最后，利用给定的关系 $\\gamma = 1/\\tau_c$，我们得到了 $k$ 关于可测量量的期望表达式：\n$$ k = m + \\frac{F_{\\infty} - 1}{2\\tau_c} $$\n\n最后一步是代入所给的数值：$m = 3.0 \\, \\mathrm{s}^{-1}$、$F_{\\infty} = 2.2$ 和 $\\tau_c = 0.5 \\, \\mathrm{s}$。\n$$ k = 3.0 + \\frac{2.2 - 1}{2 \\times 0.5} $$\n$$ k = 3.0 + \\frac{1.2}{1.0} $$\n$$ k = 3.0 + 1.2 = 4.2 $$\n单位是 $\\mathrm{s}^{-1}$，与催化速率的单位一致。问题要求答案表示为四位有效数字，即 $4.200$。", "answer": "$$\\boxed{4.200}$$", "id": "2677167"}, {"introduction": "我们最后的实践练习将动力学模型扩展到包含空间效应，这是在拥挤的细胞环境中运作的酶的一个关键影响因素。我们将构建一个模型，该模型整合了底物解离、在局部微域中的扩散以及在逃逸到本体溶液之前发生“孪生重结合”的可能性。通过实现并求解这个更符合实际的模型，你将量化其与经典米氏-门腾动力学框架的偏差，并获得使用两种独立的理论方法来验证模型的经验。[@problem_id:2677177]", "problem": "考虑一个单酶催化机制，其中扩散介导相遇，解离产生一个可重新结合的空间局域化相遇复合物，并且逃逸至本体溶液与重结合竞争。将酶建模为一个具有三个状态的连续时间马尔可夫链：自由酶状态 $E$、结合复合物状态 $ES$ 和代表扩散重结合微区的相遇状态 $C$。状态转换为：\n- $E \\to ES$，在底物浓度为 $[S]$（单位 $\\mathrm{M}$）时，二级结合速率常数为 $k_{\\mathrm{on}}$（单位 $\\mathrm{M^{-1}\\,s^{-1}}$），得到有效一级速率 $a = k_{\\mathrm{on}} [S]$（单位 $\\mathrm{s^{-1}}$）。\n- $ES \\to E$，通过催化作用，速率为 $k_{\\mathrm{cat}}$（单位 $\\mathrm{s^{-1}}$），产生一个产物分子并使酶返回到 $E$ 状态。\n- $ES \\to C$，通过微观解离，速率为 $k_{\\mathrm{off}}^0$（单位 $\\mathrm{s^{-1}}$）。\n- $C \\to ES$，通过对偶重结合，速率为 $k_{\\mathrm{rb}}$（单位 $\\mathrm{s^{-1}}$）。\n- $C \\to E$，通过逃逸至本体溶液，速率为 $k_{\\mathrm{esc}}$（单位 $\\mathrm{s^{-1}}$）。\n\n假设只有一个酶，因此瞬时产物生成速率等于 $k_{\\mathrm{cat}}$ 乘以处于 $ES$ 状态的概率。对于正速率，该系统是遍历的。\n\n您的任务是针对几组参数集，计算稳态转换速率 $v_{\\mathrm{ss}}$（单位 $\\mathrm{s^{-1}}$），并量化其与忽略相遇状态的经典两状态米氏-门腾预测的偏差。按以下基本原理进行操作。\n\n1. 稳态通量公式。设 $\\boldsymbol{\\pi} = (\\pi_E,\\pi_{ES},\\pi_C)$ 为马尔可夫链的稳态分布。使用稳态下的化学主方程平衡和归一化条件，确定 $\\boldsymbol{\\pi}$ 并计算 $v_{\\mathrm{ss}} = k_{\\mathrm{cat}} \\,\\pi_{ES}$（单位 $\\mathrm{s^{-1}}$）。\n\n2. 更新（首次通过）公式。考虑一个催化循环，该循环从酶处于自由状态（$E$）开始，到通过催化转化（$ES \\to E$，速率为 $k_{\\mathrm{cat}}$）产生一个产物分子结束。分别定义从状态 $E$、$ES$ 和 $C$ 开始到产物生成的平均首次通过时间 $T_E$、$T_{ES}$ 和 $T_C$。根据连续时间马尔可夫链的指数等待时间特性，为这些平均时间写出线性方程组，并求解 $T_E$。更新理论的转换速率为 $v_{\\mathrm{ren}} = 1/T_E$（单位 $\\mathrm{s^{-1}}$）。\n\n3. 经典米氏-门腾比较模型。简化的两状态模型 $E \\rightleftharpoons ES \\to E + P$ 中，$E \\to ES$ 的速率为 $a = k_{\\mathrm{on}}[S]$，$ES \\to E$ 的总速率为 $k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}}$，其预测的稳态速率为 $v_{\\mathrm{MM}} = k_{\\mathrm{cat}} \\, \\dfrac{a}{a + k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}}}$（单位 $\\mathrm{s^{-1}}$），这等价于 $K_M = (k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}})/k_{\\mathrm{on}}$ 的米氏-门腾表达式。定义偏差因子 $\\Delta = v_{\\mathrm{ss}}/v_{\\mathrm{MM}}$（无量纲）。\n\n实现一个程序，对下面测试套件中的每个参数集执行以下操作：\n- 通过稳态通量公式计算 $v_{\\mathrm{ss}}$。\n- 通过更新公式计算 $v_{\\mathrm{ren}}$。\n- 数值验证 $v_{\\mathrm{ss}}$ 和 $v_{\\mathrm{ren}}$ 在 $10^{-9}$ 的相对误差范围内一致；如果不一致，程序必须引发异常。\n- 计算 $\\Delta = v_{\\mathrm{ss}}/v_{\\mathrm{MM}}$。\n- 仅报告所有测试用例的 $\\Delta$ 值列表，按顺序排列，形式为包含在方括号中的逗号分隔列表的单行。每个 $\\Delta$ 值必须以小数点后恰好六位的小数形式打印。输出是无量纲的，且不得包含单位。\n\n测试套件（所有速率常数单位为 $\\mathrm{s^{-1}}$，$k_{\\mathrm{on}}$ 单位为 $\\mathrm{M^{-1}\\,s^{-1}}$，浓度单位为 $\\mathrm{M}$）：\n- 情况 A（理想路径，显著的对偶重结合）：$k_{\\mathrm{on}} = 10^8$，$[S] = 2 \\times 10^{-6}$，$k_{\\mathrm{cat}} = 10$，$k_{\\mathrm{off}}^0 = 50$，$k_{\\mathrm{rb}} = 1000$，$k_{\\mathrm{esc}} = 100$。\n- 情况 B（边界情况，无重结合且瞬时逃逸近似于两状态模型）：$k_{\\mathrm{on}} = 10^8$，$[S] = 2 \\times 10^{-6}$，$k_{\\mathrm{cat}} = 10$，$k_{\\mathrm{off}}^0 = 50$，$k_{\\mathrm{rb}} = 0$，$k_{\\mathrm{esc}} = 10^6$。\n- 情况 C（扩散限制的逃逸，强重结合）：$k_{\\mathrm{on}} = 10^8$，$[S] = 2 \\times 10^{-6}$，$k_{\\mathrm{cat}} = 10$，$k_{\\mathrm{off}}^0 = 50$，$k_{\\mathrm{rb}} = 1000$，$k_{\\mathrm{esc}} = 1$。\n- 情况 D（低底物浓度区域）：$k_{\\mathrm{on}} = 10^8$，$[S] = 10^{-8}$，$k_{\\mathrm{cat}} = 5$，$k_{\\mathrm{off}}^0 = 20$，$k_{\\mathrm{rb}} = 500$，$k_{\\mathrm{esc}} = 50$。\n- 情况 E（快速催化，重结合影响有限）：$k_{\\mathrm{on}} = 10^8$，$[S] = 2 \\times 10^{-6}$，$k_{\\mathrm{cat}} = 1000$，$k_{\\mathrm{off}}^0 = 50$，$k_{\\mathrm{rb}} = 1000$，$k_{\\mathrm{esc}} = 100$。\n\n最终输出格式：您的程序应生成单行输出，其中包含情况 A–E 的 $\\Delta$ 值，格式为方括号括起来的逗号分隔列表，例如 $[\\Delta_A,\\Delta_B,\\Delta_C,\\Delta_D,\\Delta_E]$，其中每个条目小数点后恰好有六位数字。不应打印其他任何文本。", "solution": "我们从三状态酶机制的连续时间马尔可夫链描述开始。令 $a = k_{\\mathrm{on}}[S]$ 表示有效的一级结合速率（单位 $\\mathrm{s^{-1}}$）。状态为 $E$、$ES$ 和 $C$。转换和速率如下：$E \\to ES$ 速率为 $a$，$ES \\to E$ 速率为 $k_{\\mathrm{cat}}$，$ES \\to C$ 速率为 $k_{\\mathrm{off}}^0$，$C \\to ES$ 速率为 $k_{\\mathrm{rb}}$，以及 $C \\to E$ 速率为 $k_{\\mathrm{esc}}$。\n\n稳态通量公式。设 $\\boldsymbol{\\pi} = (\\pi_E,\\pi_{ES},\\pi_C)$ 为稳态分布。生成元矩阵 $\\mathbf{Q}$ 的非对角元素为 $Q_{E,ES} = a$、$Q_{ES,E} = k_{\\mathrm{cat}}$、$Q_{ES,C} = k_{\\mathrm{off}}^0$、$Q_{C,ES} = k_{\\mathrm{rb}}$、$Q_{C,E} = k_{\\mathrm{esc}}$，对角元素使每行和为零。稳态条件为 $\\boldsymbol{\\pi}^{\\top} \\mathbf{Q} = \\boldsymbol{0}^{\\top}$，归一化条件为 $\\pi_E + \\pi_{ES} + \\pi_C = 1$。明确写出平衡方程，\n- $E$-平衡：流入等于流出，得到 $a \\,\\pi_E = k_{\\mathrm{cat}} \\,\\pi_{ES} + k_{\\mathrm{esc}} \\,\\pi_C$。\n- $ES$-平衡：$(k_{\\mathrm{cat}} + k_{\\mathrm{off}}^0)\\,\\pi_{ES} = a \\,\\pi_E + k_{\\mathrm{rb}} \\,\\pi_C$。\n- $C$-平衡：$(k_{\\mathrm{rb}} + k_{\\mathrm{esc}})\\,\\pi_C = k_{\\mathrm{off}}^0 \\,\\pi_{ES}$。\n这些线性方程与 $\\pi_E + \\pi_{ES} + \\pi_C = 1$ 一起确定了 $\\boldsymbol{\\pi}$。稳态产物生成速率即催化通量，\n$$\nv_{\\mathrm{ss}} = k_{\\mathrm{cat}} \\,\\pi_{ES} \\quad \\text{单位 } \\mathrm{s^{-1}}.\n$$\n\n更新（首次通过）公式。设 $T_E$、$T_{ES}$ 和 $T_C$ 分别表示从状态 $E$、$ES$ 和 $C$ 开始到产物生成（即 $ES \\to E$ 的催化转换）的平均首次通过时间。对于具有指数等待时间的连续时间马尔可夫链，离开一个状态到下一次转换的平均等待时间是总离开速率的倒数；对下一次转换进行条件化可得到平均首次通过时间的线性方程组。具体来说：\n- 从 $E$ 出发，唯一的转换是 $E \\to ES$，速率为 $a$，因此离开的平均等待时间是 $1/a$，之后过程从 $ES$ 继续。因此\n$$\nT_E = \\frac{1}{a} + T_{ES}.\n$$\n- 从 $ES$ 出发，有两种可能的转换：速率为 $k_{\\mathrm{cat}}$ 的催化 $ES \\to E$（完成循环）和速率为 $k_{\\mathrm{off}}^0$ 的解离 $ES \\to C$（之后过程从 $C$ 继续）。到下一个事件的平均等待时间是 $1/(k_{\\mathrm{cat}} + k_{\\mathrm{off}}^0)$。因此\n$$\nT_{ES} = \\frac{1}{k_{\\mathrm{cat}} + k_{\\mathrm{off}}^0} + \\frac{k_{\\mathrm{off}}^0}{k_{\\mathrm{cat}} + k_{\\mathrm{off}}^0} \\, T_C + \\frac{k_{\\mathrm{cat}}}{k_{\\mathrm{cat}} + k_{\\mathrm{off}}^0} \\cdot 0.\n$$\n- 从 $C$ 出发，有两种可能的转换：速率为 $k_{\\mathrm{rb}}$ 的重结合 $C \\to ES$ 和速率为 $k_{\\mathrm{esc}}$ 的逃逸 $C \\to E$。到下一个事件的平均等待时间是 $1/(k_{\\mathrm{rb}} + k_{\\mathrm{esc}})$。因此\n$$\nT_C = \\frac{1}{k_{\\mathrm{rb}} + k_{\\mathrm{esc}}} + \\frac{k_{\\mathrm{rb}}}{k_{\\mathrm{rb}} + k_{\\mathrm{esc}}} \\, T_{ES} + \\frac{k_{\\mathrm{esc}}}{k_{\\mathrm{rb}} + k_{\\mathrm{esc}}} \\, T_E.\n$$\n这个线性系统唯一地确定了 $T_E$，更新速率为\n$$\nv_{\\mathrm{ren}} = \\frac{1}{T_E} \\quad \\text{单位 } \\mathrm{s^{-1}}.\n$$\n两种公式都源于连续时间马尔可夫链和更新理论的基本性质。\n\n$v_{\\mathrm{ss}}$ 和 $v_{\\mathrm{ren}}$ 的等价性。通常，对于划分为独立同分布循环的遍历马尔可夫更新过程，稳态吞吐量等于平均循环时间的倒数。在这里，由于催化后返回到 $E$ 状态的再生结构，$v_{\\mathrm{ss}} = v_{\\mathrm{ren}}$ 成立。在数值上，求解稳态平衡方程和平均首次通过时间方程必须在数值精度范围内得到相同的速率。\n\n经典米氏-门腾比较模型。如果忽略相遇状态，两状态模型中 $E \\to ES$ 速率为 $a$，$ES \\to E$ 总速率为 $k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}}$，其稳态结合概率为\n$$\n\\pi_{ES}^{\\mathrm{(2\\text{-}state)}} = \\frac{a}{a + k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}}},\n$$\n因此\n$$\nv_{\\mathrm{MM}} = k_{\\mathrm{cat}} \\, \\frac{a}{a + k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}}} \\quad \\text{单位 } \\mathrm{s^{-1}}.\n$$\n偏差因子\n$$\n\\Delta = \\frac{v_{\\mathrm{ss}}}{v_{\\mathrm{MM}}}\n$$\n量化了由扩散影响的重结合和空间逃逸路径引起的增强或减弱效应。值得注意的是，当 $k_{\\mathrm{rb}} = 0$ 且 $k_{\\mathrm{esc}}$ 足够大以至于逃逸可视为瞬时发生时，三状态机制简化为两状态模型，$\\Delta$ 趋近于 1。相反，当 $k_{\\mathrm{rb}} \\gg k_{\\mathrm{esc}}$ 时，对偶重结合频繁发生，有效增加了 $ES$ 解离后的占据率，导致 $\\Delta > 1$。\n\n程序算法计划。\n- 对每个测试用例，计算 $a = k_{\\mathrm{on}} [S]$。\n- 稳态速率 $v_{\\mathrm{ss}}$：\n  - 构建转置生成元矩阵 $\\mathbf{Q}^{\\top}$ 并求解 $\\mathbf{Q}^{\\top} \\boldsymbol{\\pi} = \\boldsymbol{0}$ 及 $\\pi_E + \\pi_{ES} + \\pi_C = 1$。一种实用的方法是用归一化方程替换三个方程中的一个，然后求解一个 $3 \\times 3$ 线性系统。然后计算 $v_{\\mathrm{ss}} = k_{\\mathrm{cat}} \\,\\pi_{ES}$。\n- 更新速率 $v_{\\mathrm{ren}}$：\n  - 求解上述定义的 $(T_E, T_{ES}, T_C)$ 的 $3 \\times 3$ 线性系统，然后计算 $v_{\\mathrm{ren}} = 1/T_E$。\n- 断言相对一致性：验证 $\\left|v_{\\mathrm{ss}} - v_{\\mathrm{ren}}\\right| / \\max(1, v_{\\mathrm{ss}}) \\le 10^{-9}$。\n- 计算 $v_{\\mathrm{MM}} = k_{\\mathrm{cat}} \\, a / (a + k_{\\mathrm{off}}^0 + k_{\\mathrm{cat}})$。\n- 计算 $\\Delta = v_{\\mathrm{ss}} / v_{\\mathrm{MM}}$。\n- 按测试用例顺序收集 $\\Delta$ 值，并按要求格式化为单个列表打印，每个条目小数点后恰好六位。\n\n对于所提供的参数量级，此计算是数值稳定的，因为所有速率都是非负的且尺度适中；对于给定情况，$3 \\times 3$ 线性系统的系数是良态的。中间速率的单位得到了一致处理，但最终报告的 $\\Delta$ 值是无量纲的，并且打印时不带单位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef steady_state_flux(kon, S, kcat, koff0, krb, kesc):\n    \"\"\"\n    Compute steady-state catalytic flux v_ss = kcat * pi_ES for the three-state CTMC.\n    States order: [E, ES, C]\n    \"\"\"\n    a = kon * S  # effective first-order association rate\n    # Generator transpose Q^T for equations Q^T * pi = 0\n    # Rows correspond to equations for E, ES, C balances:\n    # For numerical solution with normalization, we build a 3x3 system:\n    # Replace the last row by normalization: pi_E + pi_ES + pi_C = 1\n    QT = np.array([\n        [-a,           kcat,        kesc],       # balance for E: -a*pi_E + kcat*pi_ES + kesc*pi_C = 0\n        [a,      -(kcat+koff0),     krb],        # balance for ES: a*pi_E - (kcat+koff0)*pi_ES + krb*pi_C = 0\n        [1.0,          1.0,         1.0]         # normalization\n    ], dtype=float)\n    b = np.array([0.0, 0.0, 1.0], dtype=float)\n    try:\n        pi = np.linalg.solve(QT, b)\n    except np.linalg.LinAlgError as e:\n        # As a fallback, use least squares (should not happen for well-posed cases)\n        pi, *_ = np.linalg.lstsq(QT, b, rcond=None)\n    pi_E, pi_ES, pi_C = pi\n    v_ss = kcat * pi_ES\n    return v_ss, (pi_E, pi_ES, pi_C)\n\ndef renewal_flux(kon, S, kcat, koff0, krb, kesc):\n    \"\"\"\n    Compute renewal-theory flux v_ren = 1 / T_E via mean first-passage times.\n    Unknowns: [T_E, T_ES, T_C], linear system A * T = rhs\n    Equations:\n      T_E  = 1/a + T_ES\n      T_ES = 1/(kcat+koff0) + (koff0/(kcat+koff0)) * T_C\n      T_C  = 1/(krb+kesc) + (krb/(krb+kesc)) * T_ES + (kesc/(krb+kesc)) * T_E\n    \"\"\"\n    a = kon * S\n    # Handle potential zero a to avoid division by zero (not present in tests)\n    if a == 0.0:\n        raise ValueError(\"Association rate a must be positive for mean cycle time.\")\n    A = np.zeros((3, 3), dtype=float)\n    rhs = np.zeros(3, dtype=float)\n    # T_E - T_ES = 1/a\n    A[0, 0] = 1.0\n    A[0, 1] = -1.0\n    rhs[0] = 1.0 / a\n    # T_ES - (koff0/(kcat+koff0)) * T_C = 1/(kcat+koff0)\n    denom_es = kcat + koff0\n    if denom_es == 0.0:\n        raise ValueError(\"kcat + koff0 must be positive.\")\n    A[1, 1] = 1.0\n    A[1, 2] = -(koff0 / denom_es)\n    rhs[1] = 1.0 / denom_es\n    # T_C - (krb/(krb+kesc)) * T_ES - (kesc/(krb+kesc)) * T_E = 1/(krb+kesc)\n    denom_c = krb + kesc\n    if denom_c == 0.0:\n        raise ValueError(\"krb + kesc must be positive.\")\n    A[2, 2] = 1.0\n    A[2, 1] = -(krb / denom_c)\n    A[2, 0] = -(kesc / denom_c)\n    rhs[2] = 1.0 / denom_c\n    try:\n        T = np.linalg.solve(A, rhs)\n    except np.linalg.LinAlgError as e:\n        T, *_ = np.linalg.lstsq(A, rhs, rcond=None)\n    T_E = T[0]\n    v_ren = 1.0 / T_E\n    return v_ren, tuple(T.tolist())\n\ndef mm_naive_flux(kon, S, kcat, koff0):\n    \"\"\"\n    Classical two-state Michaelis-Menten steady-state flux for a single enzyme:\n    v_MM = kcat * a / (a + koff0 + kcat), where a = kon * S.\n    \"\"\"\n    a = kon * S\n    denom = a + koff0 + kcat\n    if denom == 0.0:\n        return 0.0\n    return kcat * a / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (kon [M^-1 s^-1], S [M], kcat [s^-1], koff0 [s^-1], krb [s^-1], kesc [s^-1])\n    test_cases = [\n        (1e8, 2e-6, 10.0, 50.0, 1000.0, 100.0),     # Case A\n        (1e8, 2e-6, 10.0, 50.0,    0.0, 1e6),       # Case B\n        (1e8, 2e-6, 10.0, 50.0, 1000.0,   1.0),     # Case C\n        (1e8, 1e-8,  5.0, 20.0,  500.0,  50.0),     # Case D\n        (1e8, 2e-6, 1000.0, 50.0, 1000.0, 100.0),   # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        kon, S, kcat, koff0, krb, kesc = case\n        v_ss, _ = steady_state_flux(kon, S, kcat, koff0, krb, kesc)\n        v_ren, _ = renewal_flux(kon, S, kcat, koff0, krb, kesc)\n        # Relative check with tolerance 1e-9; scale by max(1, v_ss) to avoid tiny denominators\n        denom = max(1.0, abs(v_ss))\n        rel_err = abs(v_ss - v_ren) / denom\n        if rel_err > 1e-9:\n            raise RuntimeError(f\"v_ss and v_ren mismatch: v_ss={v_ss}, v_ren={v_ren}, rel_err={rel_err}\")\n        v_mm = mm_naive_flux(kon, S, kcat, koff0)\n        # Avoid division by zero; per test design v_mm > 0\n        if v_mm == 0.0:\n            delta = float('nan')\n        else:\n            delta = v_ss / v_mm\n        results.append(delta)\n\n    # Format each result to exactly six digits after decimal point.\n    formatted = \"[\" + \",\".join(f\"{x:.6f}\" for x in results) + \"]\"\n    # Final print statement in the exact required format.\n    print(formatted)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2677177"}]}