{"hands_on_practices": [{"introduction": "理解化学主方程始于掌握其核心组成部分：倾向函数。第一个练习将挑战您从基本原理出发，推导一个三分子反应的倾向函数。通过将反应物组合的微观数量与宏观速率定律联系起来，您将巩固对化学动力学的随机性描述和确定性描述之间关系的理解 ([@problem_id:2684395])。", "problem": "考虑一个体积为 $V$ 的充分混合、恒温的密闭容器，其中包含三种不同的化学物质 $S_1$、$S_2$ 和 $S_3$，其分子数（拷贝数）随时间变化，分别为 $X_1(t)$、$X_2(t)$ 和 $X_3(t)$。该系统包含一个总分子数为 $3$ 的基元反应通道：\n$$\nS_1 + S_2 + S_3 \\longrightarrow \\cdot,\n$$\n其中产物的化学计量对反应发生速率无关。化学主方程（CME）规定，对于一个倾向性（propensity）为 $a(\\mathbf{X})$ 的反应通道，在给定状态 $\\mathbf{X}(t)=\\mathbf{X}$ 的条件下，在短时间间隔 $[t, t+\\Delta t)$ 内该通道恰好发生 $1$ 次反应的概率为 $a(\\mathbf{X})\\,\\Delta t + o(\\Delta t)$。假设在微观层面遵循质量作用动力学，并设 $k>0$ 为宏观三级速率常数，出现在单位体积反应事件速率的确定性定律中，即 $r(t) = k\\,[S_1](t)\\,[S_2](t)\\,[S_3](t)$，其中浓度以数密度 $[S_i](t) = X_i(t)/V$ 来衡量。仅从这些定义出发，并利用在热力学极限下（$V \\to \\infty$ 且 $X_i(t)/V \\to \\phi_i(t)$ 固定），随机性描述恢复为确定性速率定律这一要求，推导此三分子反应的质量作用倾向性 $a(\\mathbf{X};V,k)$。清晰地陈述并论证您在计算不同反应物元组时使用的任何组合因子。\n\n然后，用文字讨论在充分混合的体积中，用此倾向性来模拟一个基元三分子反应的物理合理性限制，指出在何种条件下这种描述是合理的，以及在何种条件下由连续的双分子步骤构建的简化机理更为合适。\n\n请用一个包含 $X_1$、$X_2$、$X_3$、$V$ 和 $k$ 的单闭式解析表达式来表示您的最终答案 $a(\\mathbf{X};V,k)$。无需进行数值计算。", "solution": "所述问题在科学上是合理的、适定的和客观的。它提出了一个随机化学动力学中的标准理论练习：通过倾向性函数将反应系统的微观描述与其通过确定性速率定律的宏观描述联系起来。所有必要的信息和定义都已提供，不存在内部矛盾或事实不准确之处。因此，可以推导出解决方案。\n\n问题要求推导基元三分子反应 $S_1 + S_2 + S_3 \\longrightarrow \\cdot$ 的质量作用倾向性函数 $a(\\mathbf{X};V,k)$，其中 $S_1$、$S_2$ 和 $S_3$ 是不同的化学物质。系统在时间 $t$ 的状态由分子数向量 $\\mathbf{X}(t) = (X_1(t), X_2(t), X_3(t))$ 给出，其中 $X_i(t)$ 是物质 $S_i$ 的分子数。\n\n倾向性函数 $a(\\mathbf{X})$ 的定义是，在系统处于状态 $\\mathbf{X}$ 的条件下，$a(\\mathbf{X})\\Delta t$ 是反应在无穷小时间间隔 $[t, t+\\Delta t)$ 内发生的概率。对于一个基元反应，倾向性与体积 $V$ 中存在的不同反应物分子组合的数量成正比。\n\n该反应涉及一个 $S_1$ 分子，一个 $S_2$ 分子和一个 $S_3$ 分子。\n物质 $S_1$ 的分子数为 $X_1$。\n物质 $S_2$ 的分子数为 $X_2$。\n物质 $S_3$ 的分子数为 $X_3$。\n\n为了形成一个反应三联体，我们必须从每种物质中选择一个分子。由于这些物质是不同的，选择一种物质的分子与选择另一种物质的分子是相互独立的。\n从 $X_1$ 个可用的 $S_1$ 分子中选择一个分子的方法有 $\\binom{X_1}{1} = X_1$ 种。\n从 $X_2$ 个可用的 $S_2$ 分子中选择一个分子的方法有 $\\binom{X_2}{1} = X_2$ 种。\n从 $X_3$ 个可用的 $S_3$ 分子中选择一个分子的方法有 $\\binom{X_3}{1} = X_3$ 种。\n\n反应物分子 $(S_1, S_2, S_3)$ 的不同组合总数为这些数字的乘积。\n$$\n\\text{反应物组合数} = X_1 \\cdot X_2 \\cdot X_3\n$$\n倾向性函数与这个组合因子成正比：\n$$\na(\\mathbf{X}) = c \\cdot X_1 X_2 X_3\n$$\n其中 $c$ 是随机速率常数，我们必须将其与宏观速率常数 $k$ 联系起来。\n\n问题提供了单位体积反应事件速率 $r(t)$ 的宏观速率定律：\n$$\nr(t) = k\\,[S_1](t)\\,[S_2](t)\\,[S_3](t)\n$$\n其中 $[S_i](t) = X_i(t)/V$ 是物质 $S_i$ 的浓度（数密度）。为了求出整个体积 $V$ 内反应事件的总速率，我们将单位体积速率 $r(t)$ 乘以体积 $V$。\n$$\n\\text{总速率（事件/时间）} = V \\cdot r(t) = V \\cdot k\\,[S_1](t)\\,[S_2](t)\\,[S_3](t)\n$$\n代入浓度的定义：\n$$\n\\text{总速率} = V \\cdot k \\left(\\frac{X_1}{V}\\right) \\left(\\frac{X_2}{V}\\right) \\left(\\frac{X_3}{V}\\right) = \\frac{k}{V^2} X_1 X_2 X_3\n$$\n连接随机和确定性框架的核心原则是，在热力学极限下（$V \\to \\infty$ 且 $X_i \\to \\infty$ 以至于浓度 $X_i/V$ 保持有限），由倾向性函数 $a(\\mathbf{X})$ 给出的随机反应速率必须收敛于确定性的总反应速率。\n$$\na(\\mathbf{X}) \\rightarrow \\text{总速率}\n$$\n通过将我们得到的倾向性表达式与确定性总速率相等，我们可以确定随机常数 $c$。\n$$\nc \\cdot X_1 X_2 X_3 = \\frac{k}{V^2} X_1 X_2 X_3\n$$\n这个等式必须对任何非零的 $X_1$、$X_2$ 和 $X_3$ 值都成立。因此，我们可以解出 $c$：\n$$\nc = \\frac{k}{V^2}\n$$\n将此结果代回倾向性函数的表达式，得到最终形式：\n$$\na(\\mathbf{X};V,k) = \\frac{k}{V^2} X_1 X_2 X_3\n$$\n这就是指定三分子反应的质量作用倾向性函数。组合因子就是分子数的乘积，因为反应物种是不同的。\n\n问题的第二部分要求讨论将一个反应模拟为基元三分子事件的物理合理性。\n\n基元反应是在单一步骤中发生的反应，对应于分子水平上的单个碰撞事件。因此，一个三分子反应，如本文所考虑的，将需要三个不同的分子（$S_1$、$S_2$ 和 $S_3$）以正确的方向和足够的能量同时碰撞，以克服活化能垒。\n\n在大多数实际条件下，这种事件的物理合理性非常低。在气相中，分子通常相距很远，双分子碰撞的持续时间极短。第三个分子在两个碰撞分子的微小相互作用体积内，在完全相同的瞬间到达的概率极小。因此，真正的基元三分子反应极为罕见。\n\n相反，具有观测到的三级速率定律的反应几乎总是复合反应，通过一系列更合理的双分子和/或单分子步骤进行。一种常见的机理涉及一个快速的预平衡，其中两个分子形成一个不稳定的中间体，然后该中间体与第三个分子在速率决定步骤中碰撞。例如：\n$$\nS_1 + S_2 \\rightleftharpoons I \\quad (\\text{快速平衡})\n$$\n$$\nI + S_3 \\longrightarrow \\text{产物} \\quad (\\text{慢，速率决定})\n$$\n如果中间体 $I$ 寿命短且浓度低，则可以应用稳态近似。这通常会导致一个总的有效速率定律，该定律对反应物浓度呈三级关系。在这种情况下，三分子倾向性函数 $a(\\mathbf{X}) = (k/V^2) X_1 X_2 X_3$ 并非对单个事件的机理上准确的描述，而是一个唯象模型，它正确地捕捉了由更复杂的潜在机理产生的宏观动力学。\n\n尽管存在这种物理上的不可能性，但在特定情况下，用三分子倾向性来模拟反应可以被认为是合理的。在高度浓缩的系统中，例如在液相或极端压力下，分子不断地与“溶剂笼”中的多个邻近分子紧密接触。离散碰撞事件之间的区别变得模糊。在这种情况下，一个双分子对与第三个反应物相遇的可能性变得更大，三级速率定律可能成为对观测到的动力学的一个有效但简化的描述。然而，即使在这些情况下，将其描述为单个基元步骤也是一种显著的理想化。\n\n总而言之，由连续的双分子步骤构建的简化机理几乎总是一种在物理上更合适、更准确的描述，特别是在气相中或当需要机理上的洞察时。基元三分子模型在很大程度上是为了处理表现出三级动力学的系统而采用的一种数学上的便利，其作为三体同时碰撞的直接物理解释在大多数条件下都是不现实的。", "answer": "$$\n\\boxed{\\frac{k}{V^2} X_1 X_2 X_3}\n$$", "id": "2684395"}, {"introduction": "现实世界中的生物系统通常涉及在截然不同的时间尺度上发生的过程，而化学主方程框架恰好能够应对这一挑战。本练习探讨了一个经典例子：协同性转录因子结合，其中快速的结合/解离动力学在缓慢的基因表达时间尺度上达到平衡。您将推导出一个有效倾向函数，这是一种强大的技术，它在简化复杂模型的同时保留了其基本特征 ([@problem_id:2684383])。", "problem": "考虑一个充分混合区室中的单个基因启动子，其上有 $n$ 个用于转录因子 $X$ 的相同结合位点。设 $x$ 表示在基因表达的慢时间尺度上 $X$ 的（整数）分子数。启动子状态由整数 $i \\in \\{0,1,\\dots,n\\}$ 指定，即当前已结合的位点数。在快时间尺度上，$i$ 的微观动力学由化学主方程 (CME) 描述，并假定其比任何其他反应都快得多。\n\n对基元结合和解离事件作如下假设：\n- 在状态 $i$ 的条件下，结合反应 $i \\to i+1$ 的倾向性为 $a_{i \\to i+1}(x) = k^{+}\\,\\omega^{i}\\,(n-i)\\,x$，其中 $k^{+} > 0$ 是一个双分子结合速率常数（已缩放至介观倾向性形式），$\\omega > 0$ 是一个协同性参数，使得 $\\omega > 1$ 表示正协同性，$\\omega = 1$ 表示独立结合，而 $\\omega  1$ 表示负协同性。\n- 解离反应 $i \\to i-1$ 的倾向性为 $a_{i \\to i-1} = k^{-}\\,i$，其中 $k^{-}  0$ 是一个单分子解离速率常数。\n\n在基因表达的慢时间尺度上，当且仅当至少有 $r$ 个位点被占据（固定阈值 $r \\in \\{1,\\dots,n\\}$）时，启动子以倾向性 $k_{\\mathrm{prod}}$ 产生输出分子种类 $Y$，否则倾向性为零。也就是说，在给定 $i$ 的条件下，当 $i \\ge r$ 时生产倾向性为 $k_{\\mathrm{prod}}$，当 $i  r$ 时为 $0$。\n\n在快速平衡近似下，将 $x$ 在结合与解离的快时间尺度上视作常数，并假设启动子状态 $i$ 达到其以 $x$ 为条件的稳态分布。从 CME 和倾向性函数的定义出发，仅使用稳态生灭过程和细致平衡的第一性原理，推导：\n1. 稳态分布 $P_{i}(x)$ 的闭式表达式，即在给定 $x$ 的情况下，恰好有 $i$ 个位点被结合的概率。\n2. 在慢时间尺度上 $Y$ 的有效生产倾向性 $a_{\\mathrm{eff}}(x)$，其通过在 $i$ 的平衡分布上对条件生产倾向性进行平均得到。\n\n用 $n$、$r$、$x$、$k^{+}$、$k^{-}$ 和 $\\omega$ 表示你的最终答案，并使用缩写 $\\kappa \\equiv k^{+}/k^{-}$。无需进行数值计算或四舍五入。仅以符号表达式形式提供最终答案，最终表达式中不包含单位。", "solution": "我们给定一个具有 $n$ 个用于物种 $X$ 的相同结合位点的启动子，其中已结合位点数 $i \\in \\{0,1,\\dots,n\\}$ 通过使 $i$ 增加或减少一的基元反应演化。状态转换在快时间尺度上定义了一个一维生灭过程（相对于 $Y$ 的产生，结合和解离是快速的）。设 $P_{i}(t \\mid x)$ 表示在时刻 $t$，给定存在 $x$ 个 $X$ 分子且在快时间尺度上其数量不变的条件下，有 $i$ 个位点被结合的概率。该生灭链的化学主方程 (CME) 为\n$$\n\\frac{d}{dt}P_{i}(t \\mid x)\n= a_{i-1 \\to i}(x)\\,P_{i-1}(t \\mid x) + a_{i+1 \\to i}\\,P_{i+1}(t \\mid x) - \\left[a_{i \\to i+1}(x) + a_{i \\to i-1}\\right] P_{i}(t \\mid x),\n$$\n其中约定 $a_{-1\\to 0} = a_{n+1 \\to n} = 0$ 且 $P_{-1} = P_{n+1} = 0$。我们已知倾向性为\n$$\na_{i \\to i+1}(x) = k^{+}\\,\\omega^{i}\\,(n-i)\\,x, \\quad a_{i \\to i-1} = k^{-}\\,i.\n$$\n\n在快速平衡近似下，我们寻求固定 $x$ 时的稳态分布 $P_{i}(x) \\equiv \\lim_{t \\to \\infty} P_{i}(t \\mid x)$。对于一个遍历的生灭过程，稳态的一个充分条件是相邻状态间的细致平衡：\n$$\nP_{i}(x)\\,a_{i \\to i+1}(x) = P_{i+1}(x)\\,a_{i+1 \\to i} \\quad \\text{对所有 } i \\in \\{0,1,\\dots,n-1\\}.\n$$\n代入给定的倾向性，\n$$\nP_{i}(x)\\,k^{+}\\,\\omega^{i}\\,(n-i)\\,x \\;=\\; P_{i+1}(x)\\,k^{-}\\,(i+1).\n$$\n整理后得到概率比的递推关系：\n$$\n\\frac{P_{i+1}(x)}{P_{i}(x)} \\;=\\; \\frac{k^{+}}{k^{-}}\\,\\omega^{i}\\,\\frac{(n-i)\\,x}{i+1} \\;=\\; \\kappa\\,\\omega^{i}\\,\\frac{(n-i)\\,x}{i+1},\n$$\n其中我们定义了 $\\kappa \\equiv k^{+}/k^{-}$。从 $i=0$ 开始迭代得出\n$$\n\\frac{P_{i}(x)}{P_{0}(x)} \\;=\\; \\prod_{j=0}^{i-1} \\left[\\kappa\\,\\omega^{j}\\,\\frac{(n-j)\\,x}{j+1}\\right].\n$$\n我们可以通过对因子进行分组来简化乘积：\n- $(n-j)/(j+1)$ 对 $j=0,1,\\dots,i-1$ 的连乘积等于二项式系数 $\\binom{n}{i}$。\n- $\\omega^{j}$ 对 $j=0,1,\\dots,i-1$ 的连乘积等于 $\\omega^{\\sum_{j=0}^{i-1} j} = \\omega^{i(i-1)/2}$。\n- $\\kappa\\,x$ 对 $j=0,1,\\dots,i-1$ 的连乘积等于 $(\\kappa x)^{i}$。\n\n因此，\n$$\n\\frac{P_{i}(x)}{P_{0}(x)} \\;=\\; \\binom{n}{i}\\,(\\kappa x)^{i}\\,\\omega^{i(i-1)/2}.\n$$\n归一化条件 $\\sum_{i=0}^{n} P_{i}(x) = 1$ 通过配分函数确定了 $P_{0}(x)$\n$$\nZ(x) \\;\\equiv\\; \\sum_{j=0}^{n} \\binom{n}{j}\\,(\\kappa x)^{j}\\,\\omega^{j(j-1)/2}.\n$$\n因此稳态分布为\n$$\nP_{i}(x) \\;=\\; \\frac{1}{Z(x)}\\,\\binom{n}{i}\\,(\\kappa x)^{i}\\,\\omega^{i(i-1)/2}, \\quad \\text{其中} \\quad Z(x) = \\sum_{j=0}^{n} \\binom{n}{j}\\,(\\kappa x)^{j}\\,\\omega^{j(j-1)/2}.\n$$\n\n我们现在计算在慢时间尺度上 $Y$ 的有效生产倾向性。根据定义，在给定 $i$ 的条件下，当 $i \\ge r$ 时生产倾向性为 $k_{\\mathrm{prod}}$，否则为 $0$。在快速平衡下，我们对给定 $x$ 的 $i$ 的稳态分布进行平均：\n$$\na_{\\mathrm{eff}}(x) \\;=\\; \\sum_{i=0}^{n} \\left[\\mathbf{1}_{\\{i \\ge r\\}}\\,k_{\\mathrm{prod}}\\right]\\,P_{i}(x) \\;=\\; k_{\\mathrm{prod}} \\sum_{i=r}^{n} P_{i}(x).\n$$\n代入 $P_{i}(x)$ 的表达式并使用 $Z(x)$，\n$$\na_{\\mathrm{eff}}(x) \\;=\\; k_{\\mathrm{prod}}\\,\\frac{\\sum_{i=r}^{n} \\binom{n}{i}\\,(\\kappa x)^{i}\\,\\omega^{i(i-1)/2}}{\\sum_{j=0}^{n} \\binom{n}{j}\\,(\\kappa x)^{j}\\,\\omega^{j(j-1)/2}}.\n$$\n\n这些公式是满足 CME 细致平衡条件并通过 $\\omega$ 引入协同性的闭式表达式。特殊情况包括 $\\omega = 1$（独立位点），此时 $P_{i}(x)$ 简化为成功参数与 $\\kappa x$ 成正比的二项分布；以及 $r = n$（仅在完全结合时有活性），此时 $a_{\\mathrm{eff}}(x)$ 简化为 $k_{\\mathrm{prod}}\\,P_{n}(x)$，这是一种指数由 $n$ 和 $\\omega$ 决定的 Hill 型形式。", "answer": "$$\\boxed{\\begin{pmatrix}\nP_{i}(x) \\;=\\; \\dfrac{\\binom{n}{i}\\,(\\kappa x)^{i}\\,\\omega^{i(i-1)/2}}{\\displaystyle \\sum_{j=0}^{n} \\binom{n}{j}\\,(\\kappa x)^{j}\\,\\omega^{j(j-1)/2}} \\\\\na_{\\mathrm{eff}}(x) \\;=\\; k_{\\mathrm{prod}}\\,\\dfrac{\\displaystyle \\sum_{i=r}^{n} \\binom{n}{i}\\,(\\kappa x)^{i}\\,\\omega^{i(i-1)/2}}{\\displaystyle \\sum_{j=0}^{n} \\binom{n}{j}\\,(\\kappa x)^{j}\\,\\omega^{j(j-1)/2}}\n\\end{pmatrix}}$$", "id": "2684383"}, {"introduction": "虽然化学主方程提供了完整的概率描述，但其解析解通常难以求得。最后的这个练习将理论与计算联系起来，指导您在一个有限状态空间上对生灭过程的化学主方程进行数值求解。通过构建系统的生成元矩阵并使用矩阵指数，您将获得解决这类重要模型的直接、精确方法的实践经验 ([@problem_id:2684412])。", "problem": "给定一个连续时间生灭反应网络，其中包含一种化学物种和两种反应：倾向函数为 $a_b(x) = \\alpha$ 的零级出生反应，以及倾向函数为 $a_d(x) = \\beta x$ 的一级死亡反应，其中 $x \\in \\mathbb{N}_0$ 是当前的分子数。考虑一个截断到 $\\mathcal{X}_K = \\{0,1,\\dots,K\\}$ 的状态空间，其中 $K \\ge 0$ 是一个有限整数。您的任务是构建与化学主方程 (CME) 一致的无穷小生成元矩阵 $Q_K$，并通过矩阵指数计算在时间 $t$ 对应的有限状态转移概率矩阵 $P_K(t)$。\n\n基本原理和建模约束：\n- 从倾向函数的定义以及将化学主方程 (CME) 解释为可数状态空间上连续时间马尔可夫链 (CTMC) 的向前方程这一标准解释出发。\n- 截断生成元 $Q_K$ 必须只反映在 $\\mathcal{X}_K$ 内部的转移。这意味着对于任何状态 $x \\in \\mathcal{X}_K$，非对角线元素由网络内转移给出，任何会离开 $\\mathcal{X}_K$ 的转移都被省略。每一行的对角线元素被确定，以使 $Q_K$ 的每一行和为零。\n- 转移概率矩阵 $P_K(t)$ 必须作为由 $Q_K$ 在时间 $t$ 诱导的向前演化的唯一解来计算，使用数值计算的矩阵指数。\n- 时间 $t$ 以秒 (s) 为单位，出生率 $\\alpha$ 和死亡率 $\\beta$ 的单位为 $\\mathrm{s}^{-1}$，概率是无量纲的。将所有最终概率表示为四舍五入到 $10$ 位小数的小数。\n\n需遵守的构建细节：\n- 对于 $x \\in \\{0,1,\\dots,K-1\\}$，在 $Q_K$ 中包含速率为 $\\alpha$ 的出生转移 $x \\to x+1$。\n- 对于 $x \\in \\{1,2,\\dots,K\\}$，在 $Q_K$ 中包含速率为 $\\beta x$ 的死亡转移 $x \\to x-1$。\n- 对于每个 $x \\in \\{0,1,\\dots,K\\}$，设置对角线元素，使得在仅考虑包含的非对角线转移时行和为零。特别地，对于 $K=0$，没有非对角线转移，因此单个对角线元素为零。\n- 设 $P_K(t)$ 为时间 $t$ 的 $(K+1)\\times(K+1)$ 转移概率矩阵。对于初始状态 $x_0 \\in \\mathcal{X}_K$ 和目标状态 $x \\in \\mathcal{X}_K$，转移概率 $p_{x_0 \\to x}(t)$ 是 $P_K(t)$ 的 $(x_0,x)$ 项。\n\n您的程序必须：\n- 遵循上述规则构建 $Q_K$。\n- 通过矩阵指数计算 $P_K(t)$。\n- 对于下面的每个测试用例，从 $P_K(t)$ 中提取单个转移概率 $p_{x_0 \\to x}(t)$ 并将其四舍五入到 $10$ 位小数。\n\n测试套件：\n- 情况 1：$K=5$，$\\alpha=0.7\\,\\mathrm{s}^{-1}$，$\\beta=0.3\\,\\mathrm{s}^{-1}$，$t=2.5\\,\\mathrm{s}$，$x_0=2$，$x=4$。\n- 情况 2：$K=0$，$\\alpha=1.2\\,\\mathrm{s}^{-1}$，$\\beta=0.8\\,\\mathrm{s}^{-1}$，$t=10.0\\,\\mathrm{s}$，$x_0=0$，$x=0$。\n- 情况 3：$K=4$，$\\alpha=2.0\\,\\mathrm{s}^{-1}$，$\\beta=1.0\\,\\mathrm{s}^{-1}$，$t=0.0\\,\\mathrm{s}$，$x_0=3$，$x=1$。\n- 情况 4：$K=4$，$\\alpha=0.0\\,\\mathrm{s}^{-1}$，$\\beta=0.5\\,\\mathrm{s}^{-1}$，$t=3.0\\,\\mathrm{s}$，$x_0=4$，$x=0$。\n- 情况 5：$K=6$，$\\alpha=1.5\\,\\mathrm{s}^{-1}$，$\\beta=1.5\\,\\mathrm{s}^{-1}$，$t=1.0\\,\\mathrm{s}$，$x_0=6$，$x=6$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的结果，形式为方括号括起来的逗号分隔列表。例如，一个有效的输出格式形如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是所需的概率，四舍五入到 $10$ 位小数。", "solution": "所提出的问题是连续时间马尔可夫链 (CTMC) 理论应用于化学动力学的一个标准的、适定的练习。它具有科学依据，并包含获得唯一解所需的所有信息。因此，我将着手解决它。\n\n问题的核心在于对有限状态空间上的随机生灭过程进行建模。系统的状态是单个化学物种的分子数，用 $x$ 表示。状态空间被截断为 $\\mathcal{X}_K = \\{0, 1, \\dots, K\\}$，其中 $K \\ge 0$ 为某个整数。动力学由两个反应控制：倾向为 $\\alpha$ 的零级出生和倾向为 $\\beta x$ 的一级死亡。\n\n这个随机过程是一个 CTMC。状态上概率分布的演化由化学主方程 (CME) 描述，它是该 CTMC 的向前柯尔莫哥洛夫方程。动力学可以完全由一个无穷小生成元矩阵来表征，我们将其表示为 $Q_K$。该矩阵的大小为 $(K+1) \\times (K+1)$，其行和列由状态 $\\{0, 1, \\dots, K\\}$ 索引。\n\n$Q_K$ 的元素，记为 $q_{i,j}$（其中 $i, j \\in \\mathcal{X}_K$），表示状态之间的瞬时转移率。对于 $i \\neq j$，$q_{i,j}$ 是从状态 $i$ 转移到状态 $j$ 的速率。对角线元素 $q_{i,i}$ 是从状态 $i$ 的总离开率的负数，这确保了每行之和为零：$\\sum_{j=0}^{K} q_{i,j} = 0$。\n\n根据问题的规定，我们如下构建 $Q_K$：\n1.  **出生反应 ($x \\to x+1$)**：此转移的速率为 $\\alpha$。它对应于从状态 $i$ 移动到 $i+1$。只要目标状态 $i+1$ 在截断的状态空间 $\\mathcal{X}_K$ 内，这对任何状态 $i$ 都是可能的。因此，对于 $i \\in \\{0, 1, \\dots, K-1\\}$，我们有 $q_{i, i+1} = \\alpha$。\n2.  **死亡反应 ($x \\to x-1$)**：此转移的速率为 $\\beta x$。它对应于从状态 $i$ 移动到 $i-1$。这对任何状态 $i  0$ 都是可能的。因此，对于 $i \\in \\{1, 2, \\dots, K\\}$，我们有 $q_{i, i-1} = \\beta i$。\n3.  **其他转移**：除了最近邻转移之外的所有其他转移都是不可能的。因此，如果 $|i-j|  1$，则 $q_{i,j} = 0$。\n4.  **对角线元素**：对角线元素由行和为零的约束确定。\n    - 对于状态 $i=0$，唯一的离开是到状态 $1$。总离开率为 $\\alpha$。因此，$q_{0,0} = -\\alpha$。\n    - 对于状态 $i \\in \\{1, 2, \\dots, K-1\\}$，可能离开到状态 $i-1$（速率 $\\beta i$）和状态 $i+1$（速率 $\\alpha$）。总离开率为 $\\beta i + \\alpha$。因此，$q_{i,i} = -(\\beta i + \\alpha)$。\n    - 对于边界状态 $i=K$，到 $K+1$ 的出生转移被截断。唯一的离开是到状态 $K-1$，速率为 $\\beta K$。总离开率为 $\\beta K$。因此，$q_{K,K} = -\\beta K$。\n    - 对于 $K=0$ 的平凡情况，状态空间为 $\\{0\\}$。没有转移是可能的，所以 $Q_0$ 是 $1 \\times 1$ 的零矩阵 $[0]$。\n\n这个构造产生了一个三对角矩阵 $Q_K$。转移概率矩阵 $P_K(t)$ 给出在时间 $t$ 内从状态 $i$ 移动到状态 $j$ 的概率。它是矩阵微分方程 $\\frac{d}{dt} P_K(t) = Q_K P_K(t)$ 在初始条件 $P_K(0) = I$（其中 $I$ 是单位矩阵）下的解。唯一解由矩阵指数给出：\n$$\nP_K(t) = e^{Q_K t}\n$$\n在时间 $t$ 内从初始状态 $x_0$ 转移到目标状态 $x$ 的概率，记为 $p_{x_0 \\to x}(t)$，是 $P_K(t)$ 矩阵中第 $x_0$ 行和第 $x$ 列的元素。\n\n因此，计算步骤如下：\n1.  对于每个由参数 $(K, \\alpha, \\beta, t, x_0, x)$ 指定的测试用例，根据上述推导的规则构建 $(K+1) \\times (K+1)$ 的生成元矩阵 $Q_K$。\n2.  计算矩阵乘积 $Q_K t$。\n3.  使用数值库函数计算矩阵指数 $P_K(t) = \\exp(Q_K t)$。\n4.  从结果矩阵中提取元素 $P_{x_0, x}$。\n5.  按要求将此值四舍五入到 $10$ 位小数。\n\n将实施此程序来求解给定的测试用例。特殊情况如 $t=0$（其中 $P_K(0)=I$）和 $K=0$（其中 $Q_0=[0]$ 且 $P_0(t)=[1]$）可作为对实现正确性的基本检查。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves for transition probabilities in a truncated birth-death process\n    for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (K, alpha, beta, t, x0, x)\n    test_cases = [\n        (5, 0.7, 0.3, 2.5, 2, 4),\n        (0, 1.2, 0.8, 10.0, 0, 0),\n        (4, 2.0, 1.0, 0.0, 3, 1),\n        (4, 0.0, 0.5, 3.0, 4, 0),\n        (6, 1.5, 1.5, 1.0, 6, 6),\n    ]\n\n    results = []\n    for case in test_cases:\n        K, alpha, beta, t, x0, x = case\n        \n        # The state space is {0, 1, ..., K}, so the matrix size is (K+1)x(K+1).\n        size = K + 1\n        \n        # Construct the infinitesimal generator matrix Q_K.\n        Q_K = np.zeros((size, size), dtype=float)\n        \n        # Off-diagonal elements\n        # Birth transitions: x - x+1 with rate alpha\n        if K = 0:\n            for i in range(K):\n                Q_K[i, i + 1] = alpha\n        \n        # Death transitions: x - x-1 with rate beta*x\n        if K = 1:\n            for i in range(1, K + 1):\n                Q_K[i, i - 1] = beta * i\n                \n        # Diagonal elements: such that row sums are zero\n        for i in range(size):\n            Q_K[i, i] = -np.sum(Q_K[i, :])\n            \n        # Compute the transition probability matrix P_K(t) = exp(Q_K * t).\n        # The expm function from scipy.linalg is required for the matrix exponential.\n        P_K_t = expm(Q_K * t)\n        \n        # Extract the specific transition probability p_{x0 - x}(t).\n        # This is the element at row x0, column x.\n        prob = P_K_t[x0, x]\n        \n        # Round the result to 10 decimal places.\n        rounded_prob = round(prob, 10)\n        results.append(f\"{rounded_prob:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(['0.1345995449', '1.0000000000', '0.0000000000', '0.0573983220', '0.0000004904'])}]\")\n\nsolve()\n```", "id": "2684412"}]}