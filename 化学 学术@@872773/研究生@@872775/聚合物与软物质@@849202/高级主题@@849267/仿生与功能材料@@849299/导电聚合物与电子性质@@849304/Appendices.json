{"hands_on_practices": [{"introduction": "本练习深入探讨了共轭聚合物电子结构的量子力学起源。通过将紧束缚模型应用于有限链，您将推导出关键的HOMO-LUMO能隙如何随链长而变化，这是理解这些材料光学和电子性质的基础概念。[@problem_id:2910328]", "problem": "一个线性共轭聚合物低聚物被建模为一个由$N$个相同重复单元组成、具有开放边界的一维链。每个重复单元提供一个$\\pi$电子轨道，其电子结构由一个最近邻紧束缚哈密顿量描述，其中在位能设置为$0$，最近邻跃迁积分$t$为实数且为正。晶格间距为$a$。假设存在自旋简并，且链是半满的（$N$为偶数），因此电子总数为$N$，每个单粒子本征态可以容纳2个电子。所有角度均以弧度为单位。\n\n从定态薛定谔方程得到的紧束缚差分方程出发，并在两端施加开放边界条件，构建驻波本征态的量子化波矢$k_{n}$以及相应的能谱。利用这些结果确定最高已占分子轨道 (HOMO) 和最低未占分子轨道 (LUMO) 的指数，并从紧束缚能谱估计HOMO–LUMO能隙随$N$变化的标度关系。作为最终答案，请提供一个用$t$和$N$表示的HOMO–LUMO能隙$\\Delta_{\\mathrm{HL}}(N)$的单一闭式解析表达式。不要代入数值。请用符号表示答案；最终表达式中不需要单位。", "solution": "所述问题具有科学依据，提法恰当且客观。它代表了凝聚态物理和量子化学中的一个标准的、可解的问题，具体来说是休克尔（Hückel）或紧束缚模型在有限体系中的应用。所有必要的参数和条件都已给出，且不存在内部矛盾。因此，我们开始求解。\n\n该系统是一个由$N$个格点组成的一维链。电子波函数$|\\psi\\rangle$可以在以每个格点$j=1, 2, \\dots, N$为中心的局域轨道$|j\\rangle$的基底下展开：\n$$ |\\psi\\rangle = \\sum_{j=1}^{N} c_j |j\\rangle $$\n其中$c_j$是波函数在格点$j$处的复振幅。在只考虑最近邻相互作用的紧束缚近似下，并采用物理学中常见的约定（跃迁积分前的符号为负，且$t$为正实数），定态薛定谔方程 $H|\\psi\\rangle = E|\\psi\\rangle$ 变为一组关于振幅$c_j$的差分方程。对于一个普通格点$j$（其中$2 \\le j \\le N-1$），方程为：\n$$ -t c_{j-1} - t c_{j+1} = E c_j $$\n对于具有开放边界的有限长链，波函数振幅在虚拟格点$j=0$和$j=N+1$处必须为零。这意味着$c_0 = 0$和$c_{N+1} = 0$。\n\n我们寻求驻波形式的解，这种解可以由左行和右行平面波的叠加构成。一个满足$j=0$处边界条件的合适试探解是：\n$$ c_j = \\mathcal{A} \\sin(k j a) $$\n其中$k$是波矢，$a$是晶格间距，$\\mathcal{A}$是归一化常数。条件$c_0 = \\mathcal{A} \\sin(0) = 0$自动满足。\n第二个边界条件$c_{N+1}=0$对波矢$k$施加了量子化条件：\n$$ \\mathcal{A} \\sin(k (N+1) a) = 0 $$\n对于非平庸解（$\\mathcal{A} \\neq 0$），这要求$k(N+1)a = n\\pi$，其中$n$为整数。因此，允许的波矢为：\n$$ k_n = \\frac{n\\pi}{(N+1)a} $$\n不同的、具有物理意义的本征态对应于$n = 1, 2, \\dots, N$。归一化本征态为：\n$$ c_j^{(n)} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{n\\pi j}{N+1}\\right) $$\n为了找到能量本征值，我们将试探解代回体内的差分方程：\n$$ -t \\left[ \\sin(k(j-1)a) + \\sin(k(j+1)a) \\right] = E \\sin(kja) $$\n使用三角恒等式$\\sin(X-Y) + \\sin(X+Y) = 2\\sin(X)\\cos(Y)$，我们得到：\n$$ -t \\left[ 2\\sin(kja)\\cos(ka) \\right] = E \\sin(kja) $$\n这就得到了与主文本一致的色散关系 $E(k) = -2t \\cos(ka)$。代入量子化的波矢$k_n$，我们得到分立的能谱：\n$$ E_n = -2t \\cos(k_n a) = -2t \\cos\\left(\\frac{n\\pi}{N+1}\\right), \\quad n=1, 2, \\dots, N $$\n问题陈述中指出$t$为正值。由于函数$\\cos(x)$在$x \\in [0, \\pi]$上是单调递减的，因此$-\\cos(x)$是单调递增的。当量子数$n$从$1$增加到$N$时，能级$E_n$随之增加。能量最低的态是$E_1$，能量最高的态是$E_N$。\n\n系统中有$N$个电子，由于自旋简并，每个能级可以容纳2个电子。为了达到基态，我们从最低能级开始，填充$N/2$个单粒子态。因此，已占态的量子数集合为$\\{1, 2, \\dots, N/2\\}$。\n\n最高已占分子轨道 (HOMO) 是能量最高的已占态，对应于已占态中的最大量子数：\n$$ n_{\\mathrm{HOMO}} = \\frac{N}{2} $$\nHOMO能级的能量为：\n$$ E_{\\mathrm{HOMO}} = E_{N/2} = -2t \\cos\\left(\\frac{(\\frac{N}{2})\\pi}{N+1}\\right) = -2t \\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) $$\n最低未占分子轨道 (LUMO) 是能量最低的未占态，对应于未占态中的最小量子数：\n$$ n_{\\mathrm{LUMO}} = \\frac{N}{2} + 1 $$\nLUMO能级的能量为：\n$$ E_{\\mathrm{LUMO}} = E_{N/2+1} = -2t \\cos\\left(\\frac{(\\frac{N}{2}+1)\\pi}{N+1}\\right) = -2t \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right) $$\nHOMO-LUMO能隙$\\Delta_{\\mathrm{HL}}$是LUMO和HOMO之间的能量差。\n$$ \\Delta_{\\mathrm{HL}} = E_{\\mathrm{LUMO}} - E_{\\mathrm{HOMO}} = -2t \\left[ \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right) - \\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) \\right] $$\n为简化此表达式，我们使用涉及$\\pi/2$的三角恒等式。令$x = \\frac{\\pi}{2(N+1)}$。\n第一个余弦函数的自变量是$\\frac{(N+2)\\pi}{2(N+1)} = \\frac{(N+1+1)\\pi}{2(N+1)} = \\frac{\\pi}{2} + \\frac{\\pi}{2(N+1)} = \\frac{\\pi}{2}+x$。\n第二个余弦函数的自变量是$\\frac{N\\pi}{2(N+1)} = \\frac{(N+1-1)\\pi}{2(N+1)} = \\frac{\\pi}{2} - \\frac{\\pi}{2(N+1)} = \\frac{\\pi}{2}-x$。\n使用$\\cos(\\frac{\\pi}{2}+x) = -\\sin(x)$和$\\cos(\\frac{\\pi}{2}-x) = \\sin(x)$，能隙变为：\n$$ \\Delta_{\\mathrm{HL}} = -2t \\left[ -\\sin\\left(x\\right) - \\sin\\left(x\\right) \\right] = -2t \\left[-2\\sin(x)\\right] $$\n$$ \\Delta_{\\mathrm{HL}} = 4t \\sin\\left(\\frac{\\pi}{2(N+1)}\\right) $$\n这就给出了HOMO-LUMO能隙的最终闭式表达式。\n对于大的$N$，$\\frac{\\pi}{2(N+1)}$很小，使用近似$\\sin(x) \\approx x$，我们发现$\\Delta_{\\mathrm{HL}} \\approx 4t \\left(\\frac{\\pi}{2(N+1)}\\right) = \\frac{2\\pi t}{N+1}$。对于长链，能隙与$1/N$成标度关系，这是一个特征性结果。", "answer": "$$\n\\boxed{4t \\sin\\left(\\frac{\\pi}{2(N+1)}\\right)}\n$$", "id": "2910328"}, {"introduction": "为了使导电聚合物在电子学中发挥作用，必须对其电导率进行控制，这通常通过一种称为“掺杂”的过程来实现。本练习在电化学实验和由此产生的材料性质之间建立了实际联系，让您能够从测量的电荷中量化平均掺杂水平。[@problem_id:1546080]", "problem": "在材料科学中，导电聚合物的性质可以通过一种称为电化学掺杂的过程进行调节。考虑一层沉积在惰性电极上的中性导电聚合物poly(3-hexylthiophene)薄膜。该聚合物的单体单元摩尔质量为 $M = 166.28 \\text{ g/mol}$。将一份质量为 $m = 1.25 \\text{ mg}$ 的该薄膜样品进行恒电位库仑法分析。在实验过程中，聚合物被电化学氧化，这会从聚合物主链上移除电子，并产生可移动的正电荷。该过程持续进行，直到总电荷量 $Q = 43.6 \\text{ mC}$ 通过，将中性聚合物转化为带正电（p型掺杂）的状态。\n\n平均掺杂水平 $y$ 定义为聚合物中每个单体单元上产生的平均正基本电荷数。使用所提供的数据和法拉第常数 $F = 96485 \\text{ C}\\cdot\\text{mol}^{-1}$，计算平均掺杂水平 $y$。将你的答案以无量纲的小数值形式报告，并四舍五入至三位有效数字。", "solution": "氧化过程从聚合物中移除了电子，产生了正电荷（空穴）。根据法拉第定律，转移的电子摩尔数为 $n_{e} = \\frac{Q}{F}$。薄膜中存在的单体单元摩尔数为 $n_{m} = \\frac{m}{M}$。平均掺杂水平，定义为每个单体单元上的正电荷数，是以下比率：\n$$\ny = \\frac{n_{e}}{n_{m}} = \\frac{\\frac{Q}{F}}{\\frac{m}{M}} = \\frac{Q M}{F m}.\n$$\n将给定数量转换为基本单位：$m = 1.25 \\times 10^{-3}\\ \\text{g}$ 和 $Q = 4.36 \\times 10^{-2}\\ \\text{C}$。代入数值，\n$$\ny = \\frac{\\left(4.36 \\times 10^{-2}\\ \\text{C}\\right)\\left(166.28\\ \\text{g}\\cdot\\text{mol}^{-1}\\right)}{\\left(96485\\ \\text{C}\\cdot\\text{mol}^{-1}\\right)\\left(1.25 \\times 10^{-3}\\ \\text{g}\\right)}.\n$$\n分别计算分子和分母：\n$$\nQ M = 4.36 \\times 10^{-2} \\times 166.28 = 7.249808,\n$$\n$$\nF m = 96485 \\times 1.25 \\times 10^{-3} = 120.60625.\n$$\n因此，\n$$\ny = \\frac{7.249808}{120.60625} \\approx 0.0601,\n$$\n四舍五入至三位有效数字。根据 $y$ 的定义，这是一个无量纲的量。", "answer": "$$\\boxed{0.0601}$$", "id": "1546080"}, {"introduction": "这项高级练习要求您为有机电化学晶体管（OECT）的完整操作过程建立模型，OECT是生物电子学中的关键器件。您将推导由离子和电子耦合输运控制的瞬态响应，然后开发一种计算方法，从器件级的测量中提取基本的材料参数。[@problem_id:2910304]", "problem": "一个有机电化学晶体管 (OECT) 由一个厚度为 $T$ 的混合离子-电子导电聚合物沟道组成，该沟道在 $x=0$ 处与电解质紧密接触，并在 $x=T$ 处由绝缘基底支撑。在时间 $t=0^{+}$ 时，一个栅极电压阶跃将反离子从电解质驱动到聚合物中，从而在所有 $t0$ 的时间内，在电解质界面处建立一个固定的离子浓度 $c_{s}$。假设离子在厚度方向 $x \\in [0,T]$ 上进行一维传输，该过程受 Fick 第二定律和局部电中性体积充电控制，因此电子空穴密度与局部离子浓度成正比。您必须从以下基本原理出发：(i) 针对离子浓度 $c(x,t)$ 的 Fick 扩散定律，(ii) 电荷守恒，以及 (iii) 电子电导率的定义 $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$，其中 $q$ 是基本电荷，$\\mu_{e}$ 是电子迁移率，$\\beta$ 是一个无量纲的化学计量比例常数。\n\n您的任务是：\n- 从 Fick 第二定律出发，使用边界条件 $c(0,t)=c_{s}$ 和 $\\partial c/\\partial x|_{x=T}=0$ 以及初始条件 $c(x,0)=0$，推导空间平均离子浓度 $\\bar{c}(t) \\equiv \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx$ 作为离子扩散系数 $D$、厚度 $T$ 和时间 $t$ 的函数。除所述基本原理外，不得假定任何其他结果。\n- 使用本构关系 $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$ 和扩散极限下的欧姆定律，说明沿沟道（长度 $L_{\\mathrm{ch}}$，宽度 $W$）的电导 $G(t)$ 如何通过 $G(t) = \\frac{W}{L_{\\mathrm{ch}}} \\int_{0}^{T} \\sigma(x,t)\\,dx$ 与 $\\bar{c}(t)$ 相关联。\n- 设计一种算法方法，在给定 $q$、$\\beta$、$T$、$W$、$L_{\\mathrm{ch}}$ 和时间样本 $\\{t_{i}\\}$ 的情况下，从由浓度阶跃 $c_{s}$ 产生的测量电导瞬态 $G(t)$ 中估算 $D$ 和 $\\mu_{e}$。您的方法必须仅依赖于上述基本定律，并且必须解释如何将形状参数 $D$ 与振幅参数 $\\mu_{e}$ 解耦。\n- 将该方法实现为一个完整、可运行的程序，该程序：(a) 使用上述指定的物理原理和已知的 $(D_{\\mathrm{true}},\\mu_{e,\\mathrm{true}})$ 为每个测试用例生成合成的、无噪声的电导瞬态 $G(t)$，(b) 从合成的 $G(t)$ 中估算 $(\\hat{D},\\hat{\\mu}_{e})$，以及 (c) 输出估算出的参数。\n\n使用以下测试套件，所有量均采用国际单位制 (SI)。对所有情况使用 $q=1.602176634\\times 10^{-19}\\,\\mathrm{C}$ 和 $\\beta=1$。对于每个测试，程序必须使用真实参数和时间向量生成 $G(t)$，然后给出相应的估算值。\n\n- 测试 1：\n  - $T=1.0\\times 10^{-7}\\,\\mathrm{m}$，$W=1.0\\times 10^{-4}\\,\\mathrm{m}$，$L_{\\mathrm{ch}}=1.0\\times 10^{-5}\\,\\mathrm{m}$，$c_{s}=1.0\\times 10^{26}\\,\\mathrm{m^{-3}}$。\n  - $D_{\\mathrm{true}}=1.0\\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$，$\\mu_{e,\\mathrm{true}}=4.0\\times 10^{-4}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$。\n  - 时间样本：$N_{t}=200$ 个点，在 $t_{\\min}=1.0\\times 10^{-7}\\,\\mathrm{s}$ 到 $t_{\\max}=1.0\\times 10^{-2}\\,\\mathrm{s}$ 之间呈对数分布。\n- 测试 2：\n  - $T=8.0\\times 10^{-8}\\,\\mathrm{m}$，$W=5.0\\times 10^{-5}\\,\\mathrm{m}$，$L_{\\mathrm{ch}}=5.0\\times 10^{-6}\\,\\mathrm{m}$，$c_{s}=5.0\\times 10^{25}\\,\\mathrm{m^{-3}}$。\n  - $D_{\\mathrm{true}}=5.0\\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$，$\\mu_{e,\\mathrm{true}}=1.5\\times 10^{-3}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$。\n  - 时间样本：$N_{t}=200$ 个点，在 $t_{\\min}=1.0\\times 10^{-7}\\,\\mathrm{s}$ 到 $t_{\\max}=2.0\\times 10^{-3}\\,\\mathrm{s}$ 之间呈对数分布。\n- 测试 3：\n  - $T=2.0\\times 10^{-7}\\,\\mathrm{m}$，$W=2.0\\times 10^{-4}\\,\\mathrm{m}$，$L_{\\mathrm{ch}}=2.5\\times 10^{-5}\\,\\mathrm{m}$，$c_{s}=2.0\\times 10^{26}\\,\\mathrm{m^{-3}}$。\n  - $D_{\\mathrm{true}}=1.0\\times 10^{-11}\\,\\mathrm{m^{2}\\,s^{-1}}$，$\\mu_{e,\\mathrm{true}}=8.0\\times 10^{-4}\\,\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$。\n  - 时间样本：$N_{t}=220$ 个点，在 $t_{\\min}=1.0\\times 10^{-6}\\,\\mathrm{s}$ 到 $t_{\\max}=5.0\\times 10^{-1}\\,\\mathrm{s}$ 之间呈对数分布。\n\n程序要求：\n- 物理引擎：在所述边界条件下，实现 Fick 方程分离变量法所蕴含的解析级数解，以计算 $\\bar{c}(t)$ 并避免数值不稳定性。使用带有足够项数的截断策略以确保收敛。\n- 估算方法：通过最小化归一化测量电导瞬态与归一化模型瞬态之间的平方偏差和来估算 $\\hat{D}$，其中归一化是相对于稳态值进行的。然后根据稳态电导幅值计算 $\\hat{\\mu}_{e}$。说明如何从有限时间样本中近似稳态。\n- 输出：对于每个测试用例，以 SI 单位生成参数对 $(\\hat{D},\\hat{\\mu}_{e})$。您的程序应生成单行输出，其中包含结果，格式为方括号内的逗号分隔列表，顺序为 $[\\hat{D}_{1},\\hat{\\mu}_{e,1},\\hat{D}_{2},\\hat{\\mu}_{e,2},\\hat{D}_{3},\\hat{\\mu}_{e,3}]$。以 SI 单位表示每个数字，并将每个数字四舍五入到 $6$ 位有效数字。不使用角度。不包括百分号；如果报告任何比率，则必须是小数形式。", "solution": "我们从一维情况下离子浓度 $c(x,t)$ 的 Fick 第二定律开始，\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}},\n$$\n在域 $x \\in [0,T]$ 上，初始条件为 $c(x,0)=0$，混合边界条件为 $c(0,t)=c_{s}$ 和 $\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=T}=0$。引入 $u(x,t) \\equiv c_{s}-c(x,t)$，使得 $u$ 满足\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^{2} u}{\\partial x^{2}}, \\quad u(0,t)=0, \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{x=T}=0, \\quad u(x,0)=c_{s}.\n$$\n我们通过分离变量法求解，设 $u(x,t)=X(x)T(t)$，得到\n$$\n\\frac{1}{D}\\frac{1}{T}\\frac{dT}{dt} = \\frac{1}{X}\\frac{d^{2}X}{dx^{2}} = -\\lambda,\n$$\n其本征函数为 $X_{n}(x)=\\sin(k_{n} x)$，满足 $X_{n}(0)=0$ 和 $X_{n}'(T)=k_{n}\\cos(k_{n} T)=0$，因此 $\\cos(k_{n} T)=0$。允许的波数为\n$$\nk_{n} = \\frac{(2n+1)\\pi}{2T}, \\quad n=0,1,2,\\dots,\n$$\n时间因子为 $T_{n}(t)=\\exp(-D k_{n}^{2} t)$。在此正弦基上展开初始条件 $u(x,0)=c_{s}$，\n$$\nu(x,0) = \\sum_{n=0}^{\\infty} A_{n} \\sin(k_{n} x),\n$$\n根据正交性 $\\int_{0}^{T} \\sin(k_{m} x)\\sin(k_{n} x)\\,dx = \\frac{T}{2}\\delta_{mn}$，我们得到\n$$\nA_{n} = \\frac{2}{T} \\int_{0}^{T} c_{s} \\sin(k_{n} x)\\,dx = \\frac{2 c_{s}}{T k_{n}} \\left[1 - \\cos(k_{n} T)\\right] = \\frac{2 c_{s}}{T k_{n}},\n$$\n因为 $\\cos(k_{n} T)=\\cos\\left(\\frac{(2n+1)\\pi}{2}\\right)=0$。因此，\n$$\nu(x,t) = \\sum_{n=0}^{\\infty} \\frac{2 c_{s}}{T k_{n}} \\sin(k_{n} x) \\exp(-D k_{n}^{2} t),\n$$\n以及\n$$\nc(x,t) = c_{s} - u(x,t) = c_{s} \\left[1 - \\sum_{n=0}^{\\infty} \\frac{2}{T k_{n}} \\sin(k_{n} x) \\exp(-D k_{n}^{2} t)\\right].\n$$\n我们求空间平均值 $\\bar{c}(t) = \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx$。使用 $\\int_{0}^{T} \\sin(k_{n} x)\\,dx = \\frac{1 - \\cos(k_{n}T)}{k_{n}} = \\frac{1}{k_{n}}$，我们得到\n$$\n\\bar{c}(t) = \\frac{1}{T}\\int_{0}^{T} c(x,t)\\,dx = c_{s}\\left[1 - \\sum_{n=0}^{\\infty} \\frac{2}{T k_{n}} \\frac{1}{T k_{n}} \\exp(-D k_{n}^{2} t)\\right].\n$$\n由于 $k_{n} = \\frac{(2n+1)\\pi}{2T}$，我们有 $(T k_{n})^{2}=\\frac{(2n+1)^{2}\\pi^{2}}{4}$，因此\n$$\n\\bar{c}(t) = c_{s}\\left[1 - \\sum_{n=0}^{\\infty} \\frac{8}{(2n+1)^{2}\\pi^{2}} \\exp\\left(- \\frac{(2n+1)^{2}\\pi^{2} D}{4 T^{2}} t\\right)\\right].\n$$\n\n接下来，局部电子电导率为 $\\sigma(x,t)=q \\mu_{e} \\beta c(x,t)$。对于宽度为 $W$、长度为 $L_{\\mathrm{ch}}$、厚度为 $T$ 的矩形沟道，其沟道电导 $G(t)$ 的计算方法是：首先对电导率沿厚度方向积分得到单位长度的横截面电导，然后除以长度：\n$$\nG(t) = \\frac{W}{L_{\\mathrm{ch}}} \\int_{0}^{T} \\sigma(x,t)\\,dx = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta \\int_{0}^{T} c(x,t)\\,dx = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta\\, T\\, \\bar{c}(t).\n$$\n因此，时间依赖性仅通过 $\\bar{c}(t)$ 引入，而振幅与 $\\mu_{e}$ 呈线性关系。在稳态 $t\\to\\infty$ 时，$\\bar{c}(\\infty)=c_{s}$，我们有\n$$\nG_{\\infty} = \\frac{W}{L_{\\mathrm{ch}}} q \\mu_{e} \\beta\\, T\\, c_{s}.\n$$\n这直接得出\n$$\n\\mu_{e} = \\frac{G_{\\infty}\\,L_{\\mathrm{ch}}}{W\\,q\\,\\beta\\,T\\,c_{s}}.\n$$\n\n估算策略：\n- 将电导瞬态归一化为 $g(t) \\equiv \\frac{G(t)}{G_{\\infty}} = \\frac{\\bar{c}(t)}{c_{s}}$，该值仅取决于 $D$ 和 $T$：\n$$\ng(t;D,T) = 1 - \\sum_{n=0}^{\\infty} \\frac{8}{(2n+1)^{2}\\pi^{2}} \\exp\\left(- \\frac{(2n+1)^{2}\\pi^{2} D}{4 T^{2}} t\\right).\n$$\n- 给定时间样本 $\\{t_{i}\\}$ 和测量的 $G(t_{i})$，当时间窗口远大于特征扩散时间 $\\tau_{D} \\sim \\frac{T^{2}}{D}$ 时，用最后的采样值 $G(t_{N})$ 来近似 $G_{\\infty}$。计算归一化数据 $\\tilde{g}_{i}=G(t_{i})/G(t_{N})$。\n- 在 $D$ 的正值范围内，通过最小化残差平方和 $\\sum_{i} \\left[\\tilde{g}_{i} - g(t_{i};D,T)\\right]^{2}$ 来估算 $\\hat{D}$。这可以通过在对数间隔的候选 $D$ 值上进行网格搜索并选择使残差平方和最小的值来完成。\n- 获得 $\\hat{D}$ 后，使用稳态关系和测量的最终电导 $G(t_{N})$ 来估算 $\\hat{\\mu}_{e}$：\n$$\n\\hat{\\mu}_{e} = \\frac{G(t_{N})\\,L_{\\mathrm{ch}}}{W\\,q\\,\\beta\\,T\\,c_{s}}.\n$$\n\n算法设计：\n- 为了高效稳定地计算 $g(t;D,T)$，将无穷级数截断为有限的 $N$ 项。级数项以 $(2n+1)^{-2}$ 的速度衰减，并随时间呈指数衰减；在实践中，选择足够大的 $N$（例如，$N=400$）可确保在给定的时间窗口内收敛到机器精度。\n- 使用数值数组对 $n$ 和 $t$ 进行矢量化，以高效计算 $g(t;D,T)$。\n- 对于网格搜索，在一个包含真实值的区间内（例如从 $10^{-12}\\,\\mathrm{m^{2}\\,s^{-1}}$ 到 $10^{-8}\\,\\mathrm{m^{2}\\,s^{-1}}$）以足够的分辨率选择对数间隔的候选 $D$ 值。\n\n单位和输出：\n- 所有输入和输出均采用国际单位制。估算的 $\\hat{D}$ 单位必须是 $\\mathrm{m^{2}\\,s^{-1}}$，$\\hat{\\mu}_{e}$ 的单位必须是 $\\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$。\n- 将报告的每个数字四舍五入到 $6$ 位有效数字。\n- 最终程序输出为单行：一个方括号内的逗号分隔列表，顺序为 $[\\hat{D}_{1},\\hat{\\mu}_{e,1},\\hat{D}_{2},\\hat{\\mu}_{e,2},\\hat{D}_{3},\\hat{\\mu}_{e,3}]$。\n\n这种方法是有原则的：扩散方程和边界条件产生一个仅由 $D$ 控制的归一化瞬态形状，而稳态振幅则编码了 $\\mu_{e}$。分离变量解为生成合成数据和执行参数估算提供了一个快速准确的正向模型。所选的测试窗口满足 $t_{\\max} \\gg \\tau_{D}$，以确保最后一个时间点是对稳态的良好近似，从而能够从最终电导值准确推断 $\\mu_{e}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants\nq = 1.602176634e-19  # Coulombs\nbeta = 1.0           # dimensionless\n\ndef series_normalized_avg_c(t, D, T, n_terms=500):\n    \"\"\"\n    Compute the normalized average concentration g(t; D, T) = c_avg(t)/c_s\n    using the analytic series solution for the 1D diffusion problem with\n    Dirichlet at x=0 and Neumann at x=T.\n\n    Parameters:\n        t : array of time points [s]\n        D : diffusion coefficient [m^2/s]\n        T : thickness [m]\n        n_terms : number of terms in the series truncation\n\n    Returns:\n        g : array of same shape as t with normalized average concentration\n    \"\"\"\n    # Prepare mode indices n = 0..n_terms-1\n    n = np.arange(n_terms, dtype=np.float64)\n    # Precompute coefficients: a_n = 8 / ((2n+1)^2 * pi^2)\n    odd = 2.0 * n + 1.0\n    a_n = 8.0 / (odd**2 * np.pi**2)\n    # Exponential rate factors: lambda_n = ((2n+1)^2 * pi^2 * D) / (4 T^2)\n    lam_n = (odd**2 * np.pi**2 * D) / (4.0 * T**2)\n\n    # Compute exp(-lambda_n * t) for all n and t\n    t = np.asarray(t, dtype=np.float64)\n    # Shape: (n_terms, len(t))\n    exp_matrix = np.exp(-np.outer(lam_n, t))\n    # Sum over n: sum a_n * exp(-lambda_n t)\n    sum_terms = a_n @ exp_matrix  # shape (len(t),)\n    g = 1.0 - sum_terms\n    return g\n\ndef conductance_transient(D, mu_e, T, W, Lch, c_s, t, n_terms=500):\n    \"\"\"\n    Compute the conductance transient G(t) using\n    G(t) = (W/Lch) * q * mu_e * beta * T * c_avg(t)\n    where c_avg(t) = c_s * g(t; D, T).\n    \"\"\"\n    g = series_normalized_avg_c(t, D, T, n_terms=n_terms)\n    A = (W / Lch) * q * beta * T\n    G = A * mu_e * c_s * g\n    return G\n\ndef estimate_D_from_normalized(G, t, T, D_min=1e-12, D_max=1e-8, n_grid=401, n_terms=500):\n    \"\"\"\n    Estimate D by grid-search minimizing squared error between\n    normalized data G/G_final and the model g(t; D, T).\n    \"\"\"\n    # Normalize data by final value (approximate steady-state)\n    G_final = G[-1]\n    g_data = G / G_final\n\n    # Grid search over D\n    D_grid = np.logspace(np.log10(D_min), np.log10(D_max), n_grid)\n    # Compute model curves for all D candidates\n    # We'll evaluate cost for each D: sum((g_data - g_model)^2)\n    best_cost = np.inf\n    best_D = None\n    for D in D_grid:\n        g_model = series_normalized_avg_c(t, D, T, n_terms=n_terms)\n        # Use squared error; optionally weight early/late equally\n        cost = np.sum((g_data - g_model)**2)\n        if cost  best_cost:\n            best_cost = cost\n            best_D = D\n    return best_D\n\ndef estimate_mu_from_final(G, T, W, Lch, c_s):\n    \"\"\"\n    Estimate mu_e using the steady-state relation:\n    mu_e = G_infty * Lch / (W * q * beta * T * c_s)\n    Approximating G_infty by the last sampled G value.\n    \"\"\"\n    G_final = G[-1]\n    mu_e = G_final * Lch / (W * q * beta * T * c_s)\n    return mu_e\n\ndef fmt_sig6(x):\n    \"\"\"Format a float with 6 significant digits, using general format.\"\"\"\n    return format(float(x), \".6g\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: dict with parameters and time vector construction\n        {\n            \"T\": 1.0e-7,\n            \"W\": 1.0e-4,\n            \"Lch\": 1.0e-5,\n            \"c_s\": 1.0e26,\n            \"D_true\": 1.0e-10,\n            \"mu_true\": 4.0e-4,\n            \"t\": np.logspace(np.log10(1.0e-7), np.log10(1.0e-2), 200)\n        },\n        {\n            \"T\": 8.0e-8,\n            \"W\": 5.0e-5,\n            \"Lch\": 5.0e-6,\n            \"c_s\": 5.0e25,\n            \"D_true\": 5.0e-10,\n            \"mu_true\": 1.5e-3,\n            \"t\": np.logspace(np.log10(1.0e-7), np.log10(2.0e-3), 200)\n        },\n        {\n            \"T\": 2.0e-7,\n            \"W\": 2.0e-4,\n            \"Lch\": 2.5e-5,\n            \"c_s\": 2.0e26,\n            \"D_true\": 1.0e-11,\n            \"mu_true\": 8.0e-4,\n            \"t\": np.logspace(np.log10(1.0e-6), np.log10(5.0e-1), 220)\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]; W = case[\"W\"]; Lch = case[\"Lch\"]; c_s = case[\"c_s\"]\n        D_true = case[\"D_true\"]; mu_true = case[\"mu_true\"]; t = case[\"t\"]\n\n        # Generate synthetic conductance transient (noise-free)\n        G = conductance_transient(D_true, mu_true, T, W, Lch, c_s, t, n_terms=600)\n\n        # Estimate D from normalized transient\n        D_est = estimate_D_from_normalized(G, t, T, D_min=1e-12, D_max=1e-8, n_grid=501, n_terms=600)\n\n        # Estimate mu from steady-state amplitude (last time sample)\n        mu_est = estimate_mu_from_final(G, T, W, Lch, c_s)\n\n        results.append(fmt_sig6(D_est))\n        results.append(fmt_sig6(mu_est))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2910304"}]}