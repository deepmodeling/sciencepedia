{"hands_on_practices": [{"introduction": "要掌握活性物质，首先需要理解单个粒子的运动。主动布朗粒子（Active Brownian Particles, ABPs）和“运动-翻滚”粒子（Run-and-Tumble Particles, RTPs）是该领域两个最经典的模型。本练习 [@problem_id:2906697] 将引导你从第一性原理出发，推导这两种粒子的均方位移（mean-squared displacement, MSD），这一过程将揭示它们标志性的从弹道式运动到扩散式运动的转变，并帮助你深入理解其动力学特性。", "problem": "考虑一个在恒温的$d$维各向同性流体介质中的单个自驱动粒子，该粒子可以通过两种不同的方式建模：作为活性布朗粒子（ABP）或作为“运动-翻滚”粒子（RTP）。在这两种模型中，粒子位置$\\mathbf{r}(t)$根据过阻尼运动学$d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$演化，其中$\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$，自驱动速率$v_0$为常数，$D_t$是平移扩散系数，$\\boldsymbol{\\xi}(t)$是零均值、单位方差且与$\\mathbf{n}(t)$不相关的高斯白噪声。单位向量$\\mathbf{n}(t)$是自驱动的瞬时方向。对于ABP，$\\mathbf{n}(t)$在单位$(d-1)$维球面上进行各向同性旋转扩散，旋转扩散系数为$D_r$。对于RTP，$\\mathbf{n}(t)$在瞬时翻滚之间是分段恒定的，翻滚事件以速率$\\alpha$的泊松过程发生；每次翻滚都会将$\\mathbf{n}(t)$重置为一个各向同性分布的方向，且该方向与其先前的值无关。\n\n仅使用基本定义和第一性原理（例如，速度的时间积分、平稳性和各向同性、以及均方位移与速度自相关之间的关系），完成以下任务：\n\n1. 从$\\Delta \\mathbf{r}(t) = \\int_0^t \\mathbf{v}(s)\\,ds + \\text{热贡献}$出发，推导均方位移$\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$的精确表达式，用方向自相关函数$C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$表示。\n2. 对于ABP，证明$C_n(t)$是时间的单指数函数，其去相关速率取决于$d$和$D_r$，并利用此结果获得对长时扩散系数的活性贡献，记为$D_a^{\\mathrm{ABP}}$。\n3. 对于RTP，计算$C_n(t)$以及相应的对长时扩散系数的活性贡献，记为$D_a^{\\mathrm{RTP}}$。\n4. 将弹道-扩散交叉时间$t_c$定义为唯一的正时间，在该时间点，来自自驱动的短时弹道贡献主导项$v_0^2 t^2$等于仅来自自驱动的长时扩散贡献主导项的两倍，即\n$$\nv_0^2 t_c^2 = 2 d\\, D_a\\, t_c,\n$$\n其中$D_a$是所考虑模型对长时扩散系数的活性贡献。使用此操作性定义，获得$t_c^{\\mathrm{ABP}}$和$t_c^{\\mathrm{RTP}}$关于$d$，$D_r$和$\\alpha$的闭合形式表达式。\n5. 基于您对均方位移的表达式，比较ABP和RTP在中间时间的随时间标度关系，识别出交叉过程发生的任何定性相似性或差异。\n\n将你的最终答案以行矩阵的形式返回，按顺序包含$t_c^{\\mathrm{ABP}}$和$t_c^{\\mathrm{RTP}}$。在国际单位制（SI）下进行计算，并以秒表示时间。最终的方框答案中不包含单位。无需数值四舍五入；提供精确的符号表达式。", "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n首先，从问题陈述中逐字提取给定条件：\n- 粒子位置根据过阻尼运动学$d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$演化。\n- 自驱动速度为$\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$，其中$v_0$是恒定速率。\n- 方向$\\mathbf{n}(t)$是一个单位向量。\n- 热噪声$\\boldsymbol{\\xi}(t)$是零均值、单位方差的高斯白噪声，具体满足$\\langle \\xi_i(t) \\xi_j(t') \\rangle = \\delta_{ij} \\delta(t-t')$，并且与$\\mathbf{n}(t)$不相关。\n- 平移扩散系数为$D_t$。\n- 对于活性布朗粒子（ABP），$\\mathbf{n}(t)$在单位$(d-1)$维球面上进行各向同性旋转扩散，旋转扩散系数为$D_r$。\n- 对于“运动-翻滚”粒子（RTP），$\\mathbf{n}(t)$以泊松速率$\\alpha$进行翻滚，之后重置为一个新的、各向同性随机的方向。\n- 方向自相关函数定义为$C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$。\n- 交叉时间$t_c$由关系$v_0^2 t_c^2 = 2 d\\, D_a\\, t_c$定义，其中$D_a$是对长时扩散系数的活性贡献。\n\n现在根据所需标准对问题进行验证。\n- **科学基础**：该问题基于活性布朗粒子和“运动-翻滚”粒子的经典模型，这些是活性物质物理学的基石。所使用的数学框架是随机微分方程（朗之万方程），这是统计力学中的标准方法。该问题不含伪科学和事实错误。\n- **适定与客观**：该问题提供了所有必要的定义、常数和模型描述。任务陈述清晰，并能基于已建立的物理原理得出唯一的、有意义的解。语言精确客观。\n- **完整性**：该问题是自洽的，没有缺失或矛盾的信息。\n\n结论是该问题有效。我们可以开始解答。\n\n粒子在时间间隔$t$内的位移通过对方程进行积分得到：\n$$\n\\Delta \\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0) = \\int_0^t \\left( v_0 \\mathbf{n}(s) + \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) \\right) ds\n$$\n均方位移（MSD）为$\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\langle \\Delta \\mathbf{r}(t) \\cdot \\Delta \\mathbf{r}(t) \\rangle$。我们展开此表达式：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t v_0 \\mathbf{n}(s') ds' \\right) \\right\\rangle + \\left\\langle \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle + 2 \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle\n$$\n第一项是活性贡献。第二项是热贡献。第三项是交叉项。由于方向$\\mathbf{n}(s)$和热噪声$\\boldsymbol{\\xi}(s')$在所有$s$和$s'$下均不相关，且$\\boldsymbol{\\xi}$的均值为零，所以交叉项为零。\n\n我们来计算热贡献：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\langle \\boldsymbol{\\xi}(s) \\cdot \\boldsymbol{\\xi}(s') \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\langle \\xi_i(s) \\xi_i(s') \\rangle\n$$\n利用白噪声的性质$\\langle \\xi_i(s) \\xi_i(s') \\rangle = \\delta(s-s')$，我们有：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\delta(s-s') = 2 D_t \\int_0^t ds \\cdot d = 2 d D_t t\n$$\n现在，我们用$C_n(t)$来计算活性贡献：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{active}}^2 \\rangle = v_0^2 \\int_0^t ds \\int_0^t ds' \\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle\n$$\n由于方向的潜在随机过程具有平稳性，相关函数仅取决于时间差：$\\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle = C_n(|s-s'|)$。该二重积分可以通过换元$\\tau = s-s'$和$u = s+s'$来变换。更直接地，它可以写成：\n$$\n\\int_0^t ds \\int_0^t ds' C_n(|s-s'|) = 2 \\int_0^t d\\tau (t-\\tau) C_n(\\tau)\n$$\n因此，总的MSD为：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 d D_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau\n$$\n这完成了任务1。\n\n对于任务2（ABP），我们必须找到$C_n(t)$。方向向量$\\mathbf{n}(t)$在$(d-1)$维球面上进行旋转扩散。其概率分布的演化由旋转扩散方程$\\partial_t P = D_r \\nabla_S^2 P$决定，其中$\\nabla_S^2$是球面上的拉普拉斯-贝尔特拉米算子。方向自相关函数$C_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle$可以通过考虑第一阶球谐函数的弛豫来计算。算子$-\\nabla_S^2$的特征值为$\\lambda_l = l(l+d-2)$，对应于$l$阶球谐函数。向量$\\mathbf{n}$的分量是一阶（$l=1$）球谐函数。任何$l=1$模式的相关函数都以相应的特征值$\\lambda_1 = 1(1+d-2) = d-1$衰减。因此，去相关速率为$(d-1)D_r$。\n$$\nC_n(t) = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\exp(-(d-1)D_r t) = \\exp(-(d-1)D_r t)\n$$\n长时有效扩散系数$D_{\\text{eff}}$可以从MSD的长时极限得出：$D_{\\text{eff}} = \\lim_{t\\to\\infty} \\frac{\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle}{2dt}$。总MSD为$\\langle |\\Delta\\mathbf{r}(t)|^2\\rangle = 2dD_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau)d\\tau$。在$t \\to \\infty$的极限下，积分$\\int_0^t (t-\\tau) C_n(\\tau)d\\tau \\approx t \\int_0^\\infty C_n(\\tau)d\\tau$。\n所以，$\\lim_{t\\to\\infty} \\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx 2 d D_t t + 2 v_0^2 t \\int_0^\\infty C_n(\\tau) d\\tau$。\n有效扩散系数为$D_{\\text{eff}} = D_t + D_a$，其中活性贡献为：\n$$\nD_a = \\frac{v_0^2}{d} \\int_0^\\infty C_n(\\tau)d\\tau\n$$\n对于ABP，我们计算这个积分：\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-(d-1)D_r \\tau) d\\tau = \\frac{1}{(d-1)D_r}\n$$\n所以，ABP的活性扩散系数为：\n$$\nD_a^{\\mathrm{ABP}} = \\frac{v_0^2}{d(d-1)D_r}\n$$\n这完成了任务2。\n\n对于任务3（RTP），我们求其方向自相关$C_n(t)$。翻滚事件以速率$\\alpha$发生，使方向随机化。在区间$[0, t]$内没有翻滚发生的概率由泊松分布给出，$P_0(t) = \\exp(-\\alpha t)$。如果没有发生翻滚，$\\mathbf{n}(t) = \\mathbf{n}(0)$。如果发生一次或多次翻滚，新的方向与初始方向不相关，因此$\\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} = 0$。\n总相关是加权平均：\n$$\nC_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\cdot P_0(t) + \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} \\cdot (1-P_0(t))\n$$\n$$\nC_n(t) = 1 \\cdot \\exp(-\\alpha t) + 0 \\cdot (1-\\exp(-\\alpha t)) = \\exp(-\\alpha t)\n$$\n现在我们计算活性扩散系数$D_a^{\\mathrm{RTP}}$：\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-\\alpha \\tau) d\\tau = \\frac{1}{\\alpha}\n$$\n$$\nD_a^{\\mathrm{RTP}} = \\frac{v_0^2}{d\\alpha}\n$$\n这完成了任务3。\n\n对于任务4，我们使用给定的定义计算交叉时间$t_c$：$v_0^2 t_c^2 = 2 d D_a t_c$。因为我们假设$t_c  0$，我们可以除以$v_0^2 t_c$：\n$$\nt_c = \\frac{2d D_a}{v_0^2}\n$$\n对于ABP：\n$$\nt_c^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d(d-1)D_r} = \\frac{2}{(d-1)D_r}\n$$\n对于RTP：\n$$\nt_c^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d\\alpha} = \\frac{2}{\\alpha}\n$$\n这完成了任务4。\n\n对于任务5，我们比较中间时间的标度关系。MSD的活性部分由$\\text{MSD}_a(t) = 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau$给出。\n对于ABP，令$\\tau_p^{\\mathrm{ABP}} = 1/((d-1)D_r)$。则$C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{ABP}})$。\n对于RTP，令$\\tau_p^{\\mathrm{RTP}} = 1/\\alpha$。则$C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{RTP}})$。\n在这两种情况下，相关函数都是单指数形式，$C_n(t) = \\exp(-t/\\tau_p)$，其中$\\tau_p$是方向的持续时间。\n让我们对一个通用的指数相关函数进行积分：\n$$\n\\int_0^t (t-\\tau) \\exp(-\\tau/\\tau_p) d\\tau = \\left[ -(t-\\tau)\\tau_p \\exp(-\\tau/\\tau_p) \\right]_0^t - \\int_0^t (-\\tau_p) \\exp(-\\tau/\\tau_p) (-1) d\\tau\n$$\n$$\n= t\\tau_p - \\tau_p \\int_0^t \\exp(-\\tau/\\tau_p) d\\tau = t\\tau_p - \\tau_p [-\\tau_p \\exp(-\\tau/\\tau_p)]_0^t = t\\tau_p - \\tau_p^2 (1 - \\exp(-t/\\tau_p))\n$$\n因此，对于两种模型，当用各自的持续时间$\\tau_p$表示时，MSD的活性贡献具有相同的函数形式：\n$$\n\\text{MSD}_a(t) = 2 v_0^2 \\tau_p^2 \\left( \\frac{t}{\\tau_p} - 1 + \\exp(-t/\\tau_p) \\right)\n$$\n从短时弹道区（对于$t \\ll \\tau_p$，$\\text{MSD}_a(t) \\approx v_0^2 t^2$）到长时扩散区（对于$t \\gg \\tau_p$，$\\text{MSD}_a(t) \\approx (2 v_0^2 \\tau_p) t$）的交叉对于两种模型在定性上是相同的。根本区别在于设定持续时间$\\tau_p$的物理机制：ABP是连续的旋转扩散，而RTP是离散的、瞬时的翻滚。然而，由均方位移所表征的最终宏观运动表现出相同的交叉行为。\n\n最终答案需要$t_c^{\\mathrm{ABP}}$和$t_c^{\\mathrm{RTP}}$的表达式。\n$t_c^{\\mathrm{ABP}} = \\frac{2}{(d-1)D_r}$\n$t_c^{\\mathrm{RTP}} = \\frac{2}{\\alpha}$\n这些将以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{(d-1)D_r}  \\frac{2}{\\alpha} \\end{pmatrix}}\n$$", "id": "2906697"}, {"introduction": "在理解了理论模型之后，一个关键的步骤是将其与实验观测联系起来。在现实世界中，通过粒子追踪技术获得的数据总是离散的且包含噪声。这个练习 [@problem_id:2906653] 将指导你如何从测量的轨迹中推导出稳健的方法，以提取如自驱动速度 $v_0$ 和旋转扩散系数 $D_r$ 等关键物理参数。这是一项进行定量分析时至关重要的技能。", "problem": "在一个持续时间为 $T = N \\Delta$ 的有限观测窗口内，一个稀疏的二维活性布朗粒子（ABPs; Active Brownian Particles）系综在离散时间点 $t_{n} = n \\Delta$ 被追踪，其中 $\\Delta$ 是帧间隔，且 $N \\gg 1$。每个粒子遵循过阻尼动力学\n$$\n\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t),\n\\qquad\n\\dot{\\theta}(t) = \\sqrt{2 D_{r}}\\,\\eta(t),\n$$\n其中 $\\boldsymbol{r}(t)$ 是位置，$\\boldsymbol{u}(t) = (\\cos\\theta(t), \\sin\\theta(t))$ 是朝向，$v_{0}$ 是恒定的自驱动速度，$D_{t}$ 是平移扩散系数，$D_{r}$ 是旋转扩散系数，而 $\\boldsymbol{\\xi}(t)$ 和 $\\eta(t)$ 是零均值单位方差的独立高斯白噪声。朝向相关是稳态的，其形式为 $\\langle \\boldsymbol{u}(t)\\cdot \\boldsymbol{u}(t+\\tau)\\rangle = \\exp(-D_{r}\\tau)$。\n\n每一帧记录的位置都带有独立的、零均值的定位噪声，因此测得的位置为 $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$，其中对于笛卡尔分量 $\\alpha,\\beta \\in \\{x,y\\}$，有 $\\langle \\eta_{n,\\alpha}\\rangle = 0$ 和 $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$。定义延迟 $\\tau = k \\Delta$ 处的经验均方位移（MSD）为\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle \\left| \\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}) \\right|^{2} \\right\\rangle_{n},\n$$\n并通过前向差分定义粗粒化速度 $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = \\big(\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})\\big)/\\Delta$，由此，延迟 $\\ell \\Delta$ 处的经验速度自相关函数（VACF; velocity autocorrelation function）由下式给出\n$$\nC_{\\mathrm{m}}(\\ell \\Delta) = \\left\\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\right\\rangle_{n}.\n$$\n假设 $1 \\le \\ell \\le \\ell_{\\max} \\ll N$，从而时间平均是良定义的且边缘效应可以忽略。您可以假设在各态历经极限下，经验平均在统计误差范围内等于系综平均。\n\n严格从给定的随机动力学、定义和已知的朝向相关出发，推导自驱动速度 $v_{0}$ 和旋转扩散系数 $D_{r}$ 的估计量，要求这些估计量对定位噪声 $\\sigma^{2}$ 和有限差分具有鲁棒性。具体要求如下：\n\n1) 推导MSD的期望函数形式 $M_{\\mathrm{m}}(\\tau)$，包括定位噪声的贡献。利用此结果，构造一个由三个正延迟 $\\tau_{s} = \\Delta, 2\\Delta, 3\\Delta$ 组成的小延迟组合，该组合能够同时消除常数噪声偏移项和随时间线性的扩散项，从而在 $D_{r} \\Delta \\to 0$ 的极限下，得到一个对 $v_{0}^{2}$ 的渐近无偏的主阶估计。\n\n2) 推导整数 $\\ell \\ge 1$ 时粗粒化VACF的期望函数形式 $C_{\\mathrm{m}}(\\ell \\Delta)$。证明当 $\\ell \\ge 1$ 时，平移扩散和定位噪声均无贡献，并且在 $\\Delta$ 上的有限差分会产生一个仅依赖于 $D_{r}\\Delta$ 的乘法形状因子。利用 $C_{\\mathrm{m}}(\\ell_{1}\\Delta)$ 和 $C_{\\mathrm{m}}(\\ell_{2}\\Delta)$（其中 $\\ell_{2}  \\ell_{1} \\ge 1$ 为整数）的比值来消除未知振幅，从而获得一个对任意 $D_{r}\\Delta$ 都有效的 $D_{r}$ 的闭式估计量。\n\n请明确地用测得的 $M_{\\mathrm{m}}(\\Delta)$、$M_{\\mathrm{m}}(2\\Delta)$、$M_{\\mathrm{m}}(3\\Delta)$、$C_{\\mathrm{m}}(\\ell_{1}\\Delta)$、$C_{\\mathrm{m}}(\\ell_{2}\\Delta)$、$\\Delta$、$\\ell_{1}$ 和 $\\ell_{2}$ 表示出您的最终估计量 $\\hat{v}_{0}$ 和 $\\hat{D}_{r}$。不需要数值。最终答案必须是关于数对 $(\\hat{v}_{0}, \\hat{D}_{r})$ 的单个解析表达式；在最终答案框中不要包含任何单位。如果在推导中使用了任何近似，请明确说明其有效范围。不要对任何量进行四舍五入。", "solution": "所述问题在科学上是合理的，提法恰当，客观，并且在活性物质物理的既定框架内是自洽的。它提出了一个基于活性布朗粒子（ABP）模型的标准的、尽管并非微不足道的解析任务。因此，该问题被认为是有效的，有必要进行完整的推导。\n\n解决方案按要求分为两个子问题：首先，推导自驱动速度 $v_{0}$ 的估计量；其次，推导旋转扩散系数 $D_{r}$ 的估计量。\n\n**第一部分：自驱动速度 $v_{0}$ 的估计量**\n\n我们首先推导一个ABP的理论均方位移（MSD），其中包含平移扩散和测量噪声的影响。位置 $\\boldsymbol{r}(t)$ 根据郎之万方程 $\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t)$ 演化。在时间间隔 $\\tau$ 内的位移是\n$$\n\\Delta\\boldsymbol{r}(\\tau) = \\boldsymbol{r}(t+\\tau) - \\boldsymbol{r}(t) = v_{0} \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds + \\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds.\n$$\n真实MSD，$M(\\tau) = \\langle |\\Delta\\boldsymbol{r}(\\tau)|^{2} \\rangle$，是通过对模的平方取系综平均来计算的。自驱动项和平移噪声项是不相关的，因此它们的交叉项在平均后消失。总MSD是各项贡献之和。\n来自平移扩散的贡献是标准的：对于二维情况，$\\langle |\\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds|^{2} \\rangle = 4D_{t}\\tau$。\n来自主动运动的贡献是\n$$\nv_{0}^{2} \\left\\langle \\left| \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds \\right|^{2} \\right\\rangle = v_{0}^{2} \\int_{t}^{t+\\tau} \\int_{t}^{t+\\tau} \\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle ds ds'.\n$$\n使用稳态朝向相关 $\\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle = \\exp(-D_{r}|s-s'|)$，这个二重积分的计算结果为\n$$\nv_{0}^{2} \\int_{0}^{\\tau} \\int_{0}^{\\tau} \\exp(-D_{r}|s-s'|) ds ds' = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right).\n$$\n因此，真实MSD为 $M(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} (D_{r}\\tau - 1 + \\exp(-D_{r}\\tau)) + 4D_{t}\\tau$。\n\n测得的位置是 $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$，其中 $\\boldsymbol{\\eta}_{n}$ 是定位噪声，满足 $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$。在延迟 $\\tau=k\\Delta$ 处的测量MSD是\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle |\\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})|^{2} \\right\\rangle = \\left\\langle |(\\boldsymbol{r}_{n+k} - \\boldsymbol{r}_{n}) + (\\boldsymbol{\\eta}_{n+k} - \\boldsymbol{\\eta}_{n})|^{2} \\right\\rangle.\n$$\n由于定位噪声与粒子的轨迹无关，交叉项消失。对于 $k \\ge 1$，$\\boldsymbol{\\eta}_{n+k}$ 和 $\\boldsymbol{\\eta}_{n}$ 是不相关的。因此，\n$$\nM_{\\mathrm{m}}(k\\Delta) = M(k\\Delta) + \\langle|\\boldsymbol{\\eta}_{n+k}|^{2}\\rangle + \\langle|\\boldsymbol{\\eta}_{n}|^{2}\\rangle = M(k\\Delta) + 2\\sigma^{2} + 2\\sigma^{2} = M(k\\Delta) + 4\\sigma^{2}.\n$$\n测量MSD的完整表达式为\n$$\nM_{\\mathrm{m}}(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right) + 4D_{t}\\tau + 4\\sigma^{2}.\n$$\n为了构造一个对 $\\sigma^{2}$ 和 $D_{t}$ 鲁棒的 $v_{0}$ 估计量，我们构造一个在延迟 $\\tau_{s} = \\Delta, 2\\Delta, 3\\Delta$ 处的测量MSD的线性组合，该组合能消除常数项（$4\\sigma^2$）和时间线性项（$4D_t\\tau$）。应用于函数 $f(k\\Delta)$ 的离散二阶导数算子是 $f((k+1)\\Delta) - 2f(k\\Delta) + f((k-1)\\Delta)$。我们使用指定的延迟来应用此结构：$M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)$。这个组合能消除任何形如 $A + B(k\\Delta)$ 的项。\n将此应用于完整的 $M_{\\mathrm{m}}(k\\Delta)$ 表达式，$4\\sigma^{2}+4D_{t}k\\Delta$ 项以及主动项的线性部分 $\\frac{2v_0^2}{D_r}k\\Delta$ 被完全消除。剩下的是来自非线性部分的贡献：\n$$\nM_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left[ \\left(\\exp(-3D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-D_{r}\\Delta)\\right) - (1-2+1) \\right].\n$$\n常数项部分为零。剩余的表达式正比于\n$$\n\\exp(-D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-3D_{r}\\Delta) = \\exp(-D_{r}\\Delta)(1 - \\exp(-D_{r}\\Delta))^{2}.\n$$\n所以，$M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\exp(-D_{r}\\Delta) \\left(1 - \\exp(-D_{r}\\Delta)\\right)^{2}$。\n问题要求一个在 $D_{r}\\Delta \\to 0$ 时渐近无偏的估计量。在此极限下，我们展开指数项：\n$1 - \\exp(-D_{r}\\Delta) = D_{r}\\Delta - \\frac{1}{2}(D_{r}\\Delta)^{2} + O((D_{r}\\Delta)^{3})$。\n$\\exp(-D_{r}\\Delta) = 1 - D_{r}\\Delta + O((D_{r}\\Delta)^{2})$。\n该组合变为：\n$$\n\\frac{2v_{0}^{2}}{D_{r}^{2}} (1 - D_{r}\\Delta + \\dots)(D_{r}\\Delta - \\dots)^{2} = \\frac{2v_{0}^{2}}{D_{r}^{2}} (1+\\dots)(D_{r}^{2}\\Delta^{2}+\\dots) = 2v_{0}^{2}\\Delta^{2} + O((D_{r}\\Delta)^{3}).\n$$\n主阶行为是 $2v_{0}^{2}\\Delta^{2}$。由此，我们构造 $v_{0}^{2}$ 的估计量：\n$$\n\\hat{v}_{0}^{2} = \\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^{2}}.\n$$\n取平方根得到 $v_{0}$ 的估计量。\n\n**第二部分：旋转扩散系数 $D_{r}$ 的估计量**\n\n我们推导粗粒化速度自相关函数（VACF）的期望函数形式。测得的速度是 $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = (\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}))/\\Delta$。在延迟 $\\ell\\Delta$ 处的VACF是 $C_{\\mathrm{m}}(\\ell\\Delta) = \\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\rangle$。\n代入 $\\boldsymbol{v}_{\\mathrm{m}}$ 的定义，我们有\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\left\\langle \\left( \\Delta\\boldsymbol{r}_{n} + \\Delta\\boldsymbol{\\eta}_{n} \\right) \\cdot \\left( \\Delta\\boldsymbol{r}_{n+\\ell} + \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\right) \\right\\rangle,\n$$\n其中 $\\Delta\\boldsymbol{r}_{j} = \\boldsymbol{r}_{j+1}-\\boldsymbol{r}_{j}$ 和 $\\Delta\\boldsymbol{\\eta}_{j} = \\boldsymbol{\\eta}_{j+1}-\\boldsymbol{\\eta}_{j}$。\n对于 $\\ell \\ge 1$，第一项因子中的噪声项的时间索引 $n$ 和 $n+1$ 与第二项因子中的时间索引 $n+\\ell$ 和 $n+\\ell+1$ 是不同的。考虑到 $\\langle\\boldsymbol{\\eta}_{i}\\cdot\\boldsymbol{\\eta}_{j}\\rangle \\propto \\delta_{ij}$，噪声项 $\\langle \\Delta\\boldsymbol{\\eta}_{n} \\cdot \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\rangle$ 为零。涉及 $\\Delta\\boldsymbol{r}$ 和 $\\Delta\\boldsymbol{\\eta}$ 的交叉项也为零。因此，对于 $\\ell \\ge 1$，定位噪声对VACF没有贡献。\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = C(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\langle \\Delta\\boldsymbol{r}_{n} \\cdot \\Delta\\boldsymbol{r}_{n+\\ell} \\rangle.\n$$\n代入位移的积分形式 $\\Delta\\boldsymbol{r}_{n} = v_0 \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt + \\sqrt{2D_t} \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{\\xi}(t) dt$。对于 $\\ell \\ge 1$，$\\Delta\\boldsymbol{r}_n$ 和 $\\Delta\\boldsymbol{r}_{n+\\ell}$ 的积分区间是不相交的。因此维纳过程的增量是不相关的，所以平移扩散项 $\\langle (\\int \\boldsymbol{\\xi} dt) \\cdot (\\int \\boldsymbol{\\xi} dt) \\rangle$ 消失。我们只剩下主动分量：\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\left\\langle \\left( \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt \\right) \\cdot \\left( \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} \\boldsymbol{u}(t') dt' \\right) \\right\\rangle = \\frac{v_{0}^{2}}{\\Delta^{2}} \\int_{n\\Delta}^{(n+1)\\Delta} dt \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} dt' \\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle.\n$$\n使用 $t'  t$ 时的 $\\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle = \\exp(-D_{r}(t'-t))$，积分变为可分离的：\n$$\n\\int_{0}^{\\Delta} ds \\int_{0}^{\\Delta} ds' \\exp(-D_{r}(\\ell\\Delta + s' - s)) = \\exp(-D_{r}\\ell\\Delta) \\left( \\int_{0}^{\\Delta} e^{D_{r}s} ds \\right) \\left( \\int_{0}^{\\Delta} e^{-D_{r}s'} ds' \\right).\n$$\n积分计算结果为：$\\int_{0}^{\\Delta} e^{\\pm D_{r}s} ds = \\frac{1}{\\pm D_{r}}(\\exp(\\pm D_{r}\\Delta) - 1)$。它们的乘积是 $\\frac{1}{-D_r^2}(e^{D_r\\Delta}-1)(e^{-D_r\\Delta}-1) = \\frac{1}{D_r^2}(2 - e^{D_r\\Delta} - e^{-D_r\\Delta}) = \\frac{2}{D_r^2}(1-\\cosh(D_r\\Delta)) = \\frac{4}{D_r^2}\\sinh^2(D_r\\Delta/2)$。\n综合所有结果，我们得到 $\\ell \\ge 1$ 时的VACF：\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\exp(-D_{r}\\ell\\Delta) \\frac{4\\sinh^{2}(D_{r}\\Delta/2)}{D_{r}^{2}} = v_{0}^{2} \\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2} \\exp(-D_{r}\\ell\\Delta).\n$$\n项 $\\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2}$ 是由有限差分产生的乘法形状因子。它仅依赖于乘积 $D_{r}\\Delta$。总体形式为 $C_{\\mathrm{m}}(\\ell\\Delta) = A \\exp(-D_{r}\\ell\\Delta)$，其中振幅 $A$ 与 $\\ell$ 无关。\n为了求得 $D_{r}$，我们取两个不同延迟 $\\ell_{2}  \\ell_{1} \\ge 1$ 处的VACF的比值：\n$$\n\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)} = \\frac{A \\exp(-D_{r}\\ell_{1}\\Delta)}{A \\exp(-D_{r}\\ell_{2}\\Delta)} = \\exp(D_{r}(\\ell_{2}-\\ell_{1})\\Delta).\n$$\n这个比值与 $v_{0}$ 和形状因子无关。解出 $D_{r}$ 得到一个对任意 $D_{r}\\Delta$ 值都有效的闭式估计量：\n$$\n\\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right) = D_{r}(\\ell_{2}-\\ell_{1})\\Delta \\implies \\hat{D}_{r} = \\frac{1}{(\\ell_{2}-\\ell_{1})\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right).\n$$\n这就完成了所需估计量的推导。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^2}}  \\frac{1}{(\\ell_2 - \\ell_1)\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_1\\Delta)}{C_{\\mathrm{m}}(\\ell_2\\Delta)}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2906653"}, {"introduction": "对于那些解析上难以处理的活性物质现象，例如与复杂边界的相互作用或集体行为，计算机模拟是不可或缺的研究工具。本练习 [@problem_id:2906656] 聚焦于模拟的一个基本方面：如何正确地实现随机动力学过程，并选择一个合适的时间步长 $\\Delta t$ 以确保模拟的准确性。通过考虑一个靠近墙壁的主动布朗粒子，你将学习如何建立一个稳定且精确的模拟，从而能够捕捉到诸如壁面堆积等重要的物理效应。", "problem": "考虑一个单一的、无相互作用的活性布朗粒子 (ABP)，其中活性布朗粒子 (ABP) 指的是一个点状的、具有内在朝向的自驱动粒子，该粒子在二维空间中运动，靠近位于 $x=0$ 处的一个无限延伸的理想反射直壁，其可及半空间由 $x \\ge 0$ 给出。该粒子沿着其瞬时单位朝向 $\\mathbf{p} = (\\cos \\theta, \\sin \\theta)$ 以自驱动速率 $v_0$ 运动，具有平移扩散性（扩散系数为 $D_t$），其朝向角 $\\theta$ 具有转动扩散性（转动扩散系数为 $D_r$）。其随机动力学由成熟的过阻尼朗之万方程描述\n$$\n\\frac{d x}{d t} = v_0 \\cos \\theta + \\sqrt{2 D_t} \\, \\xi_x(t), \\quad\n\\frac{d y}{d t} = v_0 \\sin \\theta + \\sqrt{2 D_t} \\, \\xi_y(t), \\quad\n\\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t),\n$$\n其中 $\\xi_x(t)$、$\\xi_y(t)$ 和 $\\eta(t)$ 是独立的单位方差高斯白噪声。$x=0$ 处的反射边界强制执行无通量条件，这可以通过将任何试图穿过壁的步长反射回半空间 $x \\ge 0$ 来实现。\n\n您的任务是为朝向和位置指定一个离散时间积分方案，该方案能保留正确的转动扩散统计特性，并量化一个时间步长约束，以确保精确捕捉稳态壁面积累（由于持续性运动导致壁附近概率密度的增强）。您必须从上述基本随机方程出发，推导出一个使用时间步长 $\\Delta t$ 的算法。\n\n用于量化时间步长约束的精度标准，应根据解析近壁边界层内的物理现象来定义。定义一个特征边界层长度尺度\n$$\n\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right),\n$$\n其值为持续长度和扩散-转动耦合长度中的较大者。为限制 $\\Delta t$，施加以下所有条件：\n- 转动分辨率界限：要求时间步长能够解析转动弛豫时间，即\n$$\n\\Delta t \\le \\frac{\\beta}{D_r},\n$$\n其中 $\\beta$ 为固定常数。\n- 近壁法向位移界限：要求单步法向位移均方根的三倍标准差估计值是边界层长度尺度的一个小分数 $c_{\\mathrm{rms}}$。利用体相中朝向噪声和平移噪声的独立性，取法向分量的均方根值为\n$$\n\\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t},\n$$\n并施加条件\n$$\n3 \\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t} \\le c_{\\mathrm{rms}} \\, \\ell_\\star.\n$$\n- 弹道步长界限：要求每个时间步长内的确定性自驱动步长是边界层尺度的一个小分数 $c_{\\mathrm{bal}}$：\n$$\nv_0 \\, \\Delta t \\le c_{\\mathrm{bal}} \\, \\ell_\\star,\n$$\n以避免在 $D_t$ 较小时出现几何分辨率不足的问题。\n\n对于纯被动极限 $v_0 = 0$ 的情况，不存在稳态壁面积累。在这种情况下，仅需强制执行转动分辨率界限。\n\n采用固定的数值常数 $\\beta = 0.05$、$c_{\\mathrm{rms}} = 0.1$ 和 $c_{\\mathrm{bal}} = 0.1$。角度必须以弧度为单位。所有输出必须以秒为单位表示。\n\n对于以下测试套件中的每组参数，您的程序必须计算最大允许时间步长 $\\Delta t_{\\max}$（单位为秒），其值为上述三个界限（或在 $v_0 = 0$ 时仅为转动分辨率界限）所隐含的最小值。结果必须四舍五入到 $6$ 位小数。\n\n测试套件（附单位）：\n- 案例 1：$v_0 = 1.0$ 微米/秒，$D_r = 1.0$ /秒，$D_t = 0.05$ 平方微米/秒。\n- 案例 2：$v_0 = 3.0$ 微米/秒，$D_r = 0.5$ /秒，$D_t = 0.01$ 平方微米/秒。\n- 案例 3：$v_0 = 0.0$ 微米/秒，$D_r = 1.0$ /秒，$D_t = 0.10$ 平方微米/秒。\n- 案例 4：$v_0 = 1.0$ 微米/秒，$D_r = 10.0$ /秒，$D_t = 0.00$ 平方微米/秒。\n\n最终输出格式：您的程序应生成一行包含四个 $\\Delta t_{\\max}$ 值的 Python 风格列表（单位为秒），四舍五入到 $6$ 位小数，条目之间用逗号分隔且无空格，例如：$[0.123456,0.234567,0.345678,0.456789]$。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于成熟的活性物质理论，特别是活性布朗粒子 (ABP) 模型。该问题是适定 (well-posed) 的，所有必要的参数和约束都已明确定义，从而允许一个唯一且有意义的解。其语言客观而精确。我现在开始解答。\n\n任务有两部分：首先，为给定的随机动力学指定一个离散时间积分方案；其次，根据一组指定的精度约束计算最大允许时间步长 $\\Delta t_{\\max}$。\n\n对于所提供的这组过阻尼朗之万方程，一个合适的数值积分方案是 Euler-Maruyama 方法。这种一阶方法是随机微分方程 (SDEs) 的直接离散化，实现简单，同时能保留噪声项的基本统计特性。对于有限时间步长 $\\Delta t$ 的积分分两个阶段进行：首先更新朝向，然后更新位置。\n\n$1$. **朝向更新：** 朝向角 $\\theta$ 的动力学由一个简单的转动扩散方程决定：\n$$ \\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t) $$\n该方程的 Euler-Maruyama 离散化形式为：\n$$ \\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\, Z_{\\theta} $$\n此处，$\\theta_n$ 是时间步 $n$ 处的角度，$Z_{\\theta}$ 是从均值为 $0$、方差为 $1$ 的标准正态分布中抽取的随机数。该更新规则正确地模拟了角度的扩散性质，因为一步内的角位移方差为 $\\langle (\\theta_{n+1} - \\theta_n)^2 \\rangle = 2 D_r \\Delta t$。\n\n$2$. **位置更新：** 位置坐标 $(x, y)$ 基于时间步开始时的朝向 $\\theta_n$ 进行更新：\n$$ x_{n+1} = x_n + v_0 \\cos(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_x $$\n$$ y_{n+1} = y_n + v_0 \\sin(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_y $$\n此处，$Z_x$ 和 $Z_y$ 是两个独立的随机数，也从标准正態分布中抽取，并且与 $Z_{\\theta}$ 相互独立。\n\n$3$. **边界条件：** 问题指定了一个位于 $x=0$ 的理想反射壁。在计算出新的临时位置 $(x_{n+1}, y_{n+1})$ 后，必须强制执行此约束。如果粒子试图穿过壁，即如果 $x_{n+1}  0$，其 $x$ 坐标将被反射回可及域内：\n$$ x_{n+1} \\rightarrow -x_{n+1} $$\n$y$ 坐标和朝向 $\\theta$ 不受此反射影响。这实现了所要求的无通量边界条件。\n\n接下来，我们通过分析给定的约束条件来确定最大允许时间步长 $\\Delta t_{\\max}$。对于每组参数，$\\Delta t_{\\max}$ 是从这些条件导出的上界中的最小值。数值常数为 $\\beta = 0.05$、$c_{\\mathrm{rms}} = 0.1$ 和 $c_{\\mathrm{bal}} = 0.1$。\n\n特征边界层长度尺度定义为 $\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right)$。\n\n约束条件如下：\n\n**1. 转动分辨率界限：**\n此约束确保转动运动得到充分解析。\n$$ \\Delta t \\le \\frac{\\beta}{D_r} $$\n这给出了一个上界 $\\Delta t_{1, \\max} = \\beta / D_r$。\n\n**2. 近壁法向位移界限：**\n此界限仅在 $v_0  0$ 时适用。它限制了在一个时间步内垂直于壁的位移。\n$$ 3 \\sqrt{\\frac{v_0^2}{2} (\\Delta t)^2 + 2 D_t \\Delta t} \\le c_{\\mathrm{rms}} \\ell_\\star $$\n两边平方并重新排列，得到关于 $\\Delta t$ 的二次不等式：\n$$ \\left( \\frac{9 v_0^2}{2} \\right) (\\Delta t)^2 + (18 D_t) \\Delta t - c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0 $$\n其形式为 $A (\\Delta t)^2 + B \\Delta t + C \\le 0$，其中 $A = 4.5 v_0^2  0$，$B = 18 D_t \\ge 0$，且 $C = -c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0$。对于 $\\Delta t  0$ 的有效范围是 $0  \\Delta t \\le \\Delta t_{2, \\max}$，其中 $\\Delta t_{2, \\max}$ 是二次方程 $A (\\Delta t)^2 + B \\Delta t + C = 0$ 的正根：\n$$ \\Delta t_{2, \\max} = \\frac{-B + \\sqrt{B^2 - 4AC}}{2A} = \\frac{-18 D_t + \\sqrt{(18 D_t)^2 + 18 v_0^2 c_{\\mathrm{rms}}^2 \\ell_\\star^2}}{9 v_0^2} $$\n在 $D_t = 0$ 的特殊情况下，不等式简化为 $3 v_0 \\Delta t / \\sqrt{2} \\le c_{\\mathrm{rms}} \\ell_\\star$，得出 $\\Delta t_{2, \\max} = \\frac{\\sqrt{2} c_{\\mathrm{rms}} \\ell_\\star}{3 v_0}$。\n\n**3. 弹道步长界限：**\n此界限也仅在 $v_0  0$ 时适用，并防止粒子在单个确定性步骤中跨越边界层。\n$$ v_0 \\Delta t \\le c_{\\mathrm{bal}} \\ell_\\star $$\n这给出了上界 $\\Delta t_{3, \\max} = \\frac{c_{\\mathrm{bal}} \\ell_\\star}{v_0}$。\n\n对于任何 $v_0  0$ 的情况，最大时间步长为 $\\Delta t_{\\max} = \\min(\\Delta t_{1, \\max}, \\Delta t_{2, \\max}, \\Delta t_{3, \\max})$。\n对于被动情况 $v_0 = 0$，问题明确指出仅强制执行转动分辨率界限，因此 $\\Delta t_{\\max} = \\Delta t_{1, \\max}$。\n\n我们现在将此框架应用于测试套件：\n\n**案例 1：** $v_0 = 1.0$, $D_r = 1.0$, $D_t = 0.05$。\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{1.0}, \\sqrt{\\frac{0.05}{1.0}} \\right) = \\max(1.0, 0.2236...) = 1.0$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$。\n- $\\Delta t_{2, \\max} = \\frac{-18(0.05) + \\sqrt{(18 \\cdot 0.05)^2 + 18(1.0)^2(0.1)^2(1.0)^2}}{9(1.0)^2} = \\frac{-0.9 + \\sqrt{0.81 + 0.18}}{9} = \\frac{-0.9 + \\sqrt{0.99}}{9} \\approx 0.010554$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 1.0}{1.0} = 0.1$。\n- $\\Delta t_{\\max} = \\min(0.05, 0.010554, 0.1) = 0.010554$。\n\n**案例 2：** $v_0 = 3.0$, $D_r = 0.5$, $D_t = 0.01$。\n- $\\ell_\\star = \\max\\left( \\frac{3.0}{0.5}, \\sqrt{\\frac{0.01}{0.5}} \\right) = \\max(6.0, 0.1414...) = 6.0$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{0.5} = 0.1$。\n- $\\Delta t_{2, \\max} = \\frac{-18(0.01) + \\sqrt{(18 \\cdot 0.01)^2 + 18(3.0)^2(0.1)^2(6.0)^2}}{9(3.0)^2} = \\frac{-0.18 + \\sqrt{0.0324 + 58.32}}{81} = \\frac{-0.18 + \\sqrt{58.3524}}{81} \\approx 0.092085$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 6.0}{3.0} = 0.2$。\n- $\\Delta t_{\\max} = \\min(0.1, 0.092085, 0.2) = 0.092085$。\n\n**案例 3：** $v_0 = 0.0$, $D_r = 1.0$, $D_t = 0.10$。\n- 这是被动极限 ($v_0 = 0$)。根据问题陈述，仅强制执行转动分辨率界限。\n- $\\Delta t_{\\max} = \\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$。\n\n**案例 4：** $v_0 = 1.0$, $D_r = 10.0$, $D_t = 0.0$。\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{10.0}, \\sqrt{\\frac{0.0}{10.0}} \\right) = \\max(0.1, 0) = 0.1$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{10.0} = 0.005$。\n- 由于 $D_t = 0$，我们使用第二界限的简化公式：$\\Delta t_{2, \\max} = \\frac{\\sqrt{2} \\times 0.1 \\times 0.1}{3 \\times 1.0} = \\frac{0.01\\sqrt{2}}{3} \\approx 0.004714$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 0.1}{1.0} = 0.01$。\n- $\\Delta t_{\\max} = \\min(0.005, 0.004714, 0.01) = 0.004714$。\n\n最终结果四舍五入到 $6$ 位小数，分别为 $0.010554$、$0.092085$、$0.050000$ 和 $0.004714$。这些结果由最终答案中提供的程序计算得出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable time step for simulating an Active Brownian\n    Particle near a wall, based on a set of accuracy constraints.\n    \"\"\"\n\n    # Define the fixed numerical constants from the problem statement.\n    BETA = 0.05\n    C_RMS = 0.1\n    C_BAL = 0.1\n\n    # Test suite with parameters (v0, Dr, Dt).\n    # Units: v0 [micrometer/s], Dr [1/s], Dt [micrometer^2/s]\n    test_cases = [\n        (1.0, 1.0, 0.05),   # Case 1\n        (3.0, 0.5, 0.01),   # Case 2\n        (0.0, 1.0, 0.10),   # Case 3\n        (1.0, 10.0, 0.00),  # Case 4\n    ]\n\n    results = []\n    for v0, Dr, Dt in test_cases:\n        # According to the problem, Dr  0 is implicitly assumed.\n        # Rotational-resolution bound is always applicable.\n        dt_max_1 = BETA / Dr\n\n        # For the passive limit (v0 = 0), only the rotational-resolution bound is enforced.\n        if v0 == 0.0:\n            results.append(dt_max_1)\n            continue\n\n        # For active cases (v0  0), calculate the other two bounds.\n        \n        # Calculate characteristic boundary-layer length scale l_star.\n        l_star = np.max([v0 / Dr, np.sqrt(Dt / Dr)])\n\n        # Bound 2: Near-wall normal-displacement bound.\n        # This requires solving a quadratic inequality for dt:\n        # A * (dt)^2 + B * dt + C = 0\n        # where A = 4.5 * v0^2, B = 18 * Dt, C = -c_rms^2 * l_star^2\n        A = 4.5 * v0**2\n        B = 18 * Dt\n        C = -C_RMS**2 * l_star**2\n        \n        # We need the positive root of A*x^2 + B*x + C = 0.\n        # dt_max_2 = (-B + sqrt(B^2 - 4*A*C)) / (2*A)\n        discriminant = B**2 - 4 * A * C\n        dt_max_2 = (-B + np.sqrt(discriminant)) / (2 * A)\n\n        # Bound 3: Ballistic step bound.\n        dt_max_3 = (C_BAL * l_star) / v0\n\n        # The maximum allowable time step is the minimum of the three bounds.\n        dt_max = np.min([dt_max_1, dt_max_2, dt_max_3])\n        results.append(dt_max)\n\n    # Format the output as a list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2906656"}]}