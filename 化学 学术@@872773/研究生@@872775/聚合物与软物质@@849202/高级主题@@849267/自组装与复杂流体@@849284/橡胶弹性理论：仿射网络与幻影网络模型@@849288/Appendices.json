{"hands_on_practices": [{"introduction": "本练习旨在巩固仿射网络和幻影网络模型的核心定量预测。通过推导和计算给定网络的剪切模量 $G$，您将掌握两种模型之间的根本区别，并理解考虑了交联点涨落的修正因子 $(1-2/f)$ 的物理意义。这是为橡胶弹性理论建立定量直觉的第一个关键步骤。[@problem_id:2518798]", "problem": "一个理想的干弹性体网络在熔融状态下由四功能交联点形成，然后通过淬火固定其拓扑结构。该网络是各向同性的，在剪切作用下不可压缩，并且交联点之间的链段可以被建模为高斯链。在温度 $T = 298\\ \\mathrm{K}$ 时，弹性活性网络链段的密度为 $\\nu = 5\\ \\mathrm{mol/m^{3}}$。考虑两种极限网络弹性模型：\n\n- 在仿射网络模型中，交联点被约束以遵循宏观形变。\n- 在幻影网络模型中，由于缺少周围基体的约束，交联点围绕其平均位置进行热涨落；考虑这些涨落如何减少功能度为 $f$ 的每个交联点的独立约束数量。\n\n从高斯链的熵弹性以及剪切模量作为关联剪切应力与剪切应变的小应变极限的定义出发，推导每种模型下剪切模量 $G$ 的表达式，并对 $f = 4$ 的情况进行求值。然后，量化折减因子，其定义为幻影模型模量与仿射模型模量之比。\n\n使用普适气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。将 $G$ 以 $\\mathrm{MPa}$ 为单位表示，并将折减因子表示为无量纲数。将您的结果四舍五入至四位有效数字。按顺序报告仿射模型模量、幻影模型模量和折减因子。", "solution": "首先对问题的科学性和逻辑一致性进行验证。\n\n**第一步：提取已知条件**\n- 网络类型：理想的干弹性体\n- 交联功能度：$f = 4$ (四功能)\n- 网络形成：在熔融状态下，然后淬火\n- 网络性质：各向同性，剪切下不可压缩\n- 链模型：高斯链\n- 弹性活性网络链段的密度：$\\nu = 5\\ \\mathrm{mol/m^{3}}$\n- 温度：$T = 298\\ \\mathrm{K}$\n- 仿射网络模型：交联点遵循宏观形变\n- 幻影网络模型：交联点发生热涨落，减少约束\n- 任务：推导并计算两种模型下的剪切模量 $G$，并求出幻影模型模量与仿射模型模量之比。\n- 常数：$R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及到标准的橡胶弹性经典理论，比较了两种典型的极限情况：仿射网络模型和幻影网络模型。这些是高分子物理和材料化学中公认的概念。该问题提法得当，提供了计算所需量所需的所有必要参数（$\\nu$, $T$, $f$, $R$）。语言客观且精确。该问题不违反任何基本原理，不是不完整或矛盾的，也不是无足輕重的。它代表了特定领域中一个标准的、可形式化的问题。\n\n**第三步：结论与行动**\n问题被认定为有效。将提供解答。\n\n理想弹性体网络的弹性性质源于形变时高分子链构象熵的变化。一个由高斯链组成的网络在经受主拉伸比 $\\lambda_1, \\lambda_2, \\lambda_3$ 时，其亥姆霍兹自由能密度的变化 $W = \\Delta A_{el}$ 由下式给出：\n$$\nW = C (\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2 - 3)\n$$\n其中 $C$ 是一个与网络结构和温度相关的常数。材料被说明是不可压缩的，这施加了约束条件 $\\lambda_1 \\lambda_2 \\lambda_3 = 1$。剪切模量 $G$ 可以从简单剪切中的应力-应变关系定义。对于上述形式（新胡克形式）的能量密度函数，剪切模量为 $G = 2C$。我们的任务是确定仿射模型和幻影模型中 $C$ 的适当形式。\n\n**仿射网络模型**\n在仿射网络模型中，假定交联点固定在弹性基体中，并随宏观形变发生仿射变换。弹性自由能密度是通过对每单位体积中所有 $\\nu$ 个弹性活性链段的贡献求和来计算的。对于此模型，常数 $C$ 为：\n$$\nC_{affine} = \\frac{1}{2} \\nu R T\n$$\n这里，$\\nu$ 是弹性活性链段的摩尔密度，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n因此，仿射模型的剪切模量 $G_{affine}$ 为：\n$$\nG_{affine} = 2 C_{affine} = 2 \\left( \\frac{1}{2} \\nu R T \\right) = \\nu R T\n$$\n\n**幻影网络模型**\n在幻影网络模型中，交联点不是固定的，而是可以围绕其平均位置自由地进行热涨落。这些涨落仅受连接到每个交联点的 $f$ 条链的约束。这个由 James 和 Guth 发展的模型认识到，只有交联点平均位置的形变才对弹性恢复力有贡献。热涨落降低了网络的有效弹性响应。其结果是弹性自由能密度按一个与交联功能度 $f$ 相关的因子减少。\n\n有效弹性约束的数量由网络的环阶数 $\\xi$ 来描述。对于一个具有 $N_{chains}$ 条链和 $N_c$ 个功能度为 $f$ 的交联点的网络，其环阶数为 $\\xi \\approx N_{chains} - N_c$。从拓扑学角度考虑，$2 N_{chains} = f N_c$。这允许我们用 $N_{chains}$ 来表示 $\\xi$：\n$$\n\\xi = N_{chains} - \\frac{2}{f} N_{chains} = N_{chains} \\left( 1 - \\frac{2}{f} \\right)\n$$\n弹性自由能密度与这个有效链数（环阶数密度, $\\xi/V$）成正比。因此，幻影模型的常数 $C$ 为：\n$$\nC_{phantom} = \\left( 1 - \\frac{2}{f} \\right) \\frac{1}{2} \\nu R T\n$$\n幻影模型的剪切模量 $G_{phantom}$ 为：\n$$\nG_{phantom} = 2 C_{phantom} = 2 \\left[ \\left( 1 - \\frac{2}{f} \\right) \\frac{1}{2} \\nu R T \\right] = \\left( 1 - \\frac{2}{f} \\right) \\nu R T\n$$\n对于给定的四功能网络，$f=4$。表达式简化为：\n$$\nG_{phantom} = \\left( 1 - \\frac{2}{4} \\right) \\nu R T = \\frac{1}{2} \\nu R T\n$$\n\n**数值计算**\n给定条件：\n$\\nu = 5\\ \\mathrm{mol/m^{3}}$\n$T = 298\\ \\mathrm{K}$\n$R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n首先，我们计算乘积 $\\nu R T$：\n$$\n\\nu R T = (5\\ \\mathrm{mol\\,m^{-3}}) \\times (8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298\\ \\mathrm{K})\n$$\n$$\n\\nu R T = 12388.5492... \\ \\mathrm{J\\,m^{-3}} = 12388.5492... \\ \\mathrm{Pa}\n$$\n\n现在我们以兆帕（$\\mathrm{MPa}$）为单位计算模量，其中 $1\\ \\mathrm{MPa} = 10^6\\ \\mathrm{Pa}$。\n\n1.  **仿射模量**:\n    $$\n    G_{affine} = \\nu R T = 12388.5492... \\ \\mathrm{Pa} = 0.0123885... \\ \\mathrm{MPa}\n    $$\n    四舍五入到四位有效数字，$G_{affine} = 0.01239\\ \\mathrm{MPa}$。\n\n2.  **幻影模量**:\n    $$\n    G_{phantom} = \\frac{1}{2} \\nu R T = \\frac{1}{2} \\times (12388.5492... \\ \\mathrm{Pa}) = 6194.2746... \\ \\mathrm{Pa} = 0.00619427... \\ \\mathrm{MPa}\n    $$\n    四舍五入到四位有效数字，$G_{phantom} = 0.006194\\ \\mathrm{MPa}$。\n\n**折减因子**\n折减因子是幻影模型模量与仿射模型模量之比。\n$$\n\\text{折减因子} = \\frac{G_{phantom}}{G_{affine}} = \\frac{\\left( 1 - \\frac{2}{f} \\right) \\nu R T}{\\nu R T} = 1 - \\frac{2}{f}\n$$\n对于 $f=4$:\n$$\n\\text{折减因子} = 1 - \\frac{2}{4} = 1 - 0.5 = 0.5\n$$\n作为一个报告到四位有效数字的无量纲数，该值为 $0.5000$。\n\n按要求的顺序和精度，最终结果为：$G_{affine} = 0.01239\\ \\mathrm{MPa}$，$G_{phantom} = 0.006194\\ \\mathrm{MPa}$，以及折减因子是 $0.5000$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01239  0.006194  0.5000 \\end{pmatrix}}\n$$", "id": "2518798"}, {"introduction": "此实践将挑战您像实验科学家一样思考，将纯粹的理论与可行的检验方法联系起来。通过分析小角中子散射 (SANS) 图谱如何随形变而变化，您可以直接在分子尺度上探测仿射变换假设的有效性。本练习阐明了宏观力学性质与微观结构变化之间的强大联系，以及倒易空间测量如何揭示实空间动力学。[@problem_id:2935667]", "problem": "小角中子散射 (SANS) 通过结构因子来探测材料的两点密度相关性，结构因子是散射标记密度的实空间相关函数的傅里叶变换。考虑一个初始时各向同性、统计均匀的交联聚合物网络，由于介观不均匀性，其参考态的结构因子在波矢大小 $q^\\ast$ 处呈现一个宽环。样品沿 $z$ 轴经受单轴拉伸，其形变梯度为 $\\mathbf{F}$，主拉伸比为 $(\\lambda_{\\perp}, \\lambda_{\\perp}, \\lambda)$。假设样品不可压缩，因此 $\\lambda_{\\perp}=\\lambda^{-1/2}$ 且 $\\det \\mathbf{F}=1$。你希望在单轴拉伸下使用 SANS 来检验一个假设：密度涨落被宏观形变（仿射映射）所对流输运。从第一性原理出发，即在仿射形变下，实空间分离矢量变换为 $\\mathbf{r}\\mapsto \\mathbf{F}\\,\\mathbf{r}$，且测得的散射强度是两点相关函数的傅里叶变换，推断出在倒易空间中应出现何种可观测的几何畸变，以及如何将其用作仿射映射的定量检验。下列哪个陈述正确地概述了用于此类检验的有效且自洽的程序或判据？\n\nA. 如果形变是仿射且不可压缩的，那么在 $|\\mathbf{q}|=q^\\ast$ 处的初始圆形等强度线会变成一个椭球体，其主截距满足：沿拉伸方向为 $q_{\\parallel}=q^\\ast/\\lambda$，在横向方向上为 $q_{\\perp}=q^\\ast \\lambda^{1/2}$，因此各向异性比 $\\rho \\equiv q_{\\perp}/q_{\\parallel}=\\lambda^{3/2}$ 且与 $q^\\ast$ 无关。在多个 $q^\\ast$ 处验证 $\\rho$ 是否等于 $\\lambda^{3/2}$（在实验不确定度范围内）为仿射映射提供了直接的检验。\n\nB. 在仿射且不可压缩的形变下，倒易矢量本身也发生拉伸，即 $\\mathbf{q}'=\\mathbf{F}\\,\\mathbf{q}$，因此 $q_{\\parallel}=q^\\ast \\lambda$ 且 $q_{\\perp}=q^\\ast \\lambda^{-1/2}$，这意味着各向异性比 $\\rho=\\lambda^{1/2}$。将测量的 $\\rho$ 与 $\\lambda^{1/2}$ 进行比较，可以检验仿射假设。\n\nC. 对于幻影网络，仿射映射预测 SANS 的各向异性对任何 $\\lambda$ 都为零，因为交联点的热涨落会消除链段尺度上施加的形变；因此，检验仿射性的正确方法是看散射图谱是否在任何 $\\lambda$ 下都保持圆形。\n\nD. 检验仿射性的决定性方法是基于振幅的：在等强度壳层上的积分强度必须随拉伸统一地按 $1/\\lambda$ 比例缩放，且与方向无关，因为在单轴拉伸中 $\\det \\mathbf{F}=\\lambda$；这种振幅缩放，而非几何畸变，是关键的诊断特征。\n\nE. 检验仿射性的一个稳健方法是倒易空间重映射：如果形变是仿射且不可压缩的，那么将形变后的图谱与 $\\mathbf{q}\\mapsto \\mathbf{F}^{-T}\\mathbf{q}$ 进行复合，应能恢复各向同性，并将 $I'(\\mathbf{F}^{-T}\\mathbf{q};\\lambda)$ 坍缩到未形变的 $I_0(\\mathbf{q})$ 上（最多相差一个总的常数因子），因此不同 $\\lambda$ 的数据经过此逆映射后会叠加在一起。", "solution": "问题陈述在科学上是合理的、提法是严谨的，并且包含了足够的信息来推导仿射形变假设对小角中子散射 (SANS) 图谱的影响。我们将从第一性原理开始推导。\n\n**从第一性原理推导**\n\nSANS 强度 $I(\\mathbf{q})$ 与静态结构因子 $S(\\mathbf{q})$ 成正比，而静态结构因子是两点密度-密度相关函数 $C(\\mathbf{r})$ 的空间傅里叶变换。设 $\\delta\\rho(\\mathbf{x})$ 为散射标记密度围绕平均值的局部涨落。\n相关函数定义为 $C(\\mathbf{r}) = \\langle \\delta\\rho(\\mathbf{y}) \\delta\\rho(\\mathbf{y}+\\mathbf{r}) \\rangle_{\\mathbf{y}}$。\n那么结构因子为：\n$$ S(\\mathbf{q}) = \\int C(\\mathbf{r}) e^{-i \\mathbf{q} \\cdot \\mathbf{r}} d^3\\mathbf{r} $$\n在初始未形变状态下，聚合物网络是各向同性且统计均匀的。相关函数 $C_0(\\mathbf{r})$ 仅依赖于分离矢量的大小 $r=|\\mathbf{r}|$。因此，初始结构因子 $S_0(\\mathbf{q})$ 也是各向同性的，仅依赖于波矢大小 $q=|\\mathbf{q}|$。题目指出 $S_0(q)$ 在 $q=q^\\ast$ 处有一个峰。\n\n待检验的假设是，密度涨落被宏观形变仿射地对流输运。这意味着参考态中位置为 $\\mathbf{r}_0$ 的一个点在形变状态下移动到 $\\mathbf{r} = \\mathbf{F} \\mathbf{r}_0$，其中 $\\mathbf{F}$ 是形变梯度张量。新位置的密度涨落等于原始位置的密度涨落：$\\delta\\rho(\\mathbf{r}) = \\delta\\rho_0(\\mathbf{r}_0)$。\n\n在形变状态下，对于一个分离矢量 $\\mathbf{r}$，相关函数 $C(\\mathbf{r})$ 是点 $\\mathbf{y}$ 和 $\\mathbf{y}+\\mathbf{r}$ 处密度涨落之间的相关性。利用仿射映射，这些点在参考态中对应于 $\\mathbf{y}_0 = \\mathbf{F}^{-1}\\mathbf{y}$ 和 $\\mathbf{y}_0 + \\mathbf{r}_0 = \\mathbf{F}^{-1}(\\mathbf{y}+\\mathbf{r})$。因此，分离矢量的变换关系为 $\\mathbf{r} = \\mathbf{F}\\mathbf{r}_0$，或者 $\\mathbf{r}_0 = \\mathbf{F}^{-1}\\mathbf{r}$。\n形变状态下的相关函数可以用初始相关函数表示：\n$$ C(\\mathbf{r}) = \\langle \\delta\\rho(\\mathbf{F}\\mathbf{y}_0) \\delta\\rho(\\mathbf{F}(\\mathbf{y}_0+\\mathbf{r}_0)) \\rangle_{\\mathbf{y}_0} = \\langle \\delta\\rho_0(\\mathbf{y}_0) \\delta\\rho_0(\\mathbf{y}_0+\\mathbf{r}_0) \\rangle_{\\mathbf{y}_0} = C_0(\\mathbf{r}_0) = C_0(\\mathbf{F}^{-1}\\mathbf{r}) $$\n现在，我们通过对 $C(\\mathbf{r})$ 进行傅里叶变换来计算形变体系的结构因子：\n$$ S(\\mathbf{q}) = \\int C_0(\\mathbf{F}^{-1}\\mathbf{r}) e^{-i \\mathbf{q} \\cdot \\mathbf{r}} d^3\\mathbf{r} $$\n我们在积分中进行变量替换：令 $\\mathbf{r}' = \\mathbf{F}^{-1}\\mathbf{r}$，则 $\\mathbf{r} = \\mathbf{F}\\mathbf{r}'$。体积元变换为 $d^3\\mathbf{r} = |\\det(\\mathbf{F})| d^3\\mathbf{r}'$。鉴于不可压缩性约束，$\\det(\\mathbf{F})=1$。积分变为：\n$$ S(\\mathbf{q}) = \\int C_0(\\mathbf{r}') e^{-i \\mathbf{q} \\cdot (\\mathbf{F}\\mathbf{r}')} d^3\\mathbf{r}' $$\n利用点积恒等式 $\\mathbf{a} \\cdot (\\mathbf{B}\\mathbf{c}) = (\\mathbf{B}^T \\mathbf{a}) \\cdot \\mathbf{c}$，我们可以重写指数部分：\n$$ S(\\mathbf{q}) = \\int C_0(\\mathbf{r}') e^{-i (\\mathbf{F}^T \\mathbf{q}) \\cdot \\mathbf{r}'} d^3\\mathbf{r}' $$\n该表达式是初始结构因子 $S_0$ 在波矢 $\\mathbf{F}^T \\mathbf{q}$ 处的定义。因此，我们得到了结构因子仿射形变的基本关系：\n$$ S(\\mathbf{q}) = S_0(\\mathbf{F}^T \\mathbf{q}) $$\n由于 $S_0$ 是各向同性的，所以 $S_0(\\mathbf{k}) = S_0(|\\mathbf{k}|)$。因此，$S(\\mathbf{q}) = S_0(|\\mathbf{F}^T \\mathbf{q}|)$。\n\n形变状态下的等强度线由 $S(\\mathbf{q}) = \\text{constant}$ 给出。这对应于 $|\\mathbf{F}^T \\mathbf{q}| = \\text{constant}$。初始时位于 $|\\mathbf{q}| = q^\\ast$ 的散射峰，现在将位于满足以下条件的波矢 $\\mathbf{q}$ 处：\n$$ |\\mathbf{F}^T \\mathbf{q}| = q^\\ast $$\n对于沿 $z$ 轴的给定单轴拉伸和不可压缩性（$\\lambda_{\\perp} = \\lambda^{-1/2}$），形变梯度张量 $\\mathbf{F}$ 是对角且对称的（$\\mathbf{F}^T = \\mathbf{F}$）：\n$$ \\mathbf{F} = \\begin{pmatrix} \\lambda^{-1/2}  0  0 \\\\ 0  \\lambda^{-1/2}  0 \\\\ 0  0  \\lambda \\end{pmatrix} $$\n峰值等值线的条件变为：\n$$ (\\lambda^{-1/2} q_x)^2 + (\\lambda^{-1/2} q_y)^2 + (\\lambda q_z)^2 = (q^\\ast)^2 $$\n$$ \\lambda^{-1} q_{\\perp}^2 + \\lambda^2 q_{\\parallel}^2 = (q^\\ast)^2 $$\n其中 $q_{\\parallel} = q_z$，$q_{\\perp} = \\sqrt{q_x^2 + q_y^2}$。这是一个椭球方程。\n\n**逐项分析**\n\nA. **如果形变是仿射且不可压缩的，那么在 $|\\mathbf{q}|=q^\\ast$ 处的初始圆形等强度线会变成一个椭球体，其主截距满足：沿拉伸方向为 $q_{\\parallel}=q^\\ast/\\lambda$，在横向方向上为 $q_{\\perp}=q^\\ast \\lambda^{1/2}$，因此各向异性比 $\\rho \\equiv q_{\\perp}/q_{\\parallel}=\\lambda^{3/2}$ 且与 $q^\\ast$ 无关。在多个 $q^\\ast$ 处验证 $\\rho$ 是否等于 $\\lambda^{3/2}$（在实验不确定度范围内）为仿射映射提供了直接的检验。**\n为了找到平行截距 ($q_{\\parallel}$)，我们在椭球方程中设 $q_{\\perp}=0$：$\\lambda^2 q_{\\parallel}^2 = (q^\\ast)^2$，得到 $q_{\\parallel} = q^\\ast/\\lambda$。为了找到垂直截距 ($q_{\\perp}$)，我们设 $q_{\\parallel}=0$：$\\lambda^{-1} q_{\\perp}^2 = (q^\\ast)^2$，得到 $q_{\\perp} = q^\\ast/\\lambda^{-1/2} = q^\\ast \\lambda^{1/2}$。各向异性比为 $\\rho = q_{\\perp} / q_{\\parallel} = (q^\\ast \\lambda^{1/2}) / (q^\\ast / \\lambda) = \\lambda^{3/2}$。这个结果与 $q^\\ast$ 无关。将测量的各向异性比与理论预测值 $\\lambda^{3/2}$ 进行比较，是仿射映射假设的一个直接且有效的检验。\n**结论：正确。**\n\nB. **在仿射且不可压缩的形变下，倒易矢量本身也发生拉伸，即 $\\mathbf{q}'=\\mathbf{F}\\,\\mathbf{q}$，因此 $q_{\\parallel}=q^\\ast \\lambda$ 且 $q_{\\perp}=q^\\ast \\lambda^{-1/2}$，这意味着各向异性比 $\\rho=\\lambda^{1/2}$。将测量的 $\\rho$ 与 $\\lambda^{1/2}$ 进行比较，可以检验仿射假设。**\n这个陈述从根本上是错误的。推导表明，变换通过 $\\mathbf{q}_{\\rm deformed} = \\mathbf{F}^{-T} \\mathbf{q}_{\\rm initial}$ 关联倒易空间中的点。声称 $\\mathbf{q}' = \\mathbf{F}\\mathbf{q}$ 混淆了实空间矢量和倒易空间矢量的变换。因此，推导出的截距 $q_{\\parallel}=q^\\ast \\lambda$ 和 $q_{\\perp}=q^\\ast \\lambda^{-1/2}$ 与正确关系正好相反。得到的各向异性比也是错误的。\n**结论：错误。**\n\nC. **对于幻影网络，仿射映射预测 SANS 的各向异性对任何 $\\lambda$ 都为零，因为交联点的热涨落会消除链段尺度上施加的形变；因此，检验仿射性的正确方法是看散射图谱是否在任何 $\\lambda$ 下都保持圆形。**\n这个陈述错误地将仿射模型与幻影网络模型混为一谈。问题要求检验仿射映射假设。根据定义，仿射模型忽略了交联点的热涨落，并*预测*了特定的、非零的各向异性，如选项 A 的分析所示。幻影模型是另一种模型，它预测的各向异性*小于*仿射模型，但未必为零。该陈述的前提是一个矛盾。对于 $\\lambda \\ne 1$ 的情况，一个圆形的散射图谱会证伪而非证实仿射假设。\n**结论：错误。**\n\nD. **检验仿射性的决定性方法是基于振幅的：在等强度壳层上的积分强度必须随拉伸统一地按 $1/\\lambda$ 比例缩放，且与方向无关，因为在单轴拉伸中 $\\det \\mathbf{F}=\\lambda$；这种振幅缩放，而非几何畸变，是关键的诊断特征。**\n这个陈述包含一个关键错误。对于所述的不可压缩形变，$\\det \\mathbf{F} = 1$。声称 $\\det \\mathbf{F} = \\lambda$ 是错误的。此外，基本关系 $S(\\mathbf{q}) = S_0(\\mathbf{F}^T \\mathbf{q})$ 不包含任何会缩放强度的前置因子。强度值仅仅是在倒易空间中被重新分布。几何畸变是仿射形变的主要特征，而不是整体的振幅缩放。\n**结论：错误。**\n\nE. **检验仿射性的一个稳健方法是倒易空间重映射：如果形变是仿射且不可压缩的，那么将形变后的图谱与 $\\mathbf{q}\\mapsto \\mathbf{F}^{-T}\\mathbf{q}$ 进行复合，应能恢复各向同性，并将 $I'(\\mathbf{F}^{-T}\\mathbf{q};\\lambda)$ 坍缩到未形变的 $I_0(\\mathbf{q})$ 上（最多相差一个总的常数因子），因此不同 $\\lambda$ 的数据经过此逆映射后会叠加在一起。**\n这描述了一个基于推导出的关系 $S(\\mathbf{q}) = S_0(\\mathbf{F}^T \\mathbf{q})$ 的数学上合理的过程。设测得的形变强度为 $I'(\\mathbf{q}; \\lambda) \\propto S(\\mathbf{q})$。如果我们定义一个新函数 $J(\\mathbf{p}) = I'(\\mathbf{F}^{-T}\\mathbf{p}; \\lambda)$，我们发现：\n$J(\\mathbf{p}) \\propto S(\\mathbf{F}^{-T}\\mathbf{p}) = S_0(|\\mathbf{F}^T (\\mathbf{F}^{-T}\\mathbf{p})|) = S_0(|\\mathbf{p}|)$。\n重映射后的函数 $J(\\mathbf{p})$ 确实是原始的各向同性散射函数。这意味着如果仿射假设成立，来自所有方向和所有拉伸比 $\\lambda$ 的实验数据，当以这种方式重映射时，应该坍缩到一条对应于未形变样品散射轮廓的单一主曲线上。这是对仿射模型的一个全面而稳健的检验。\n**结论：正确。**", "answer": "$$\\boxed{AE}$$", "id": "2935667"}, {"introduction": "最后的这项实践提供了最深入的动手经验，要求您从头开始构建一个珠簧网络模型。通过亲手实现仿射和幻影模型的关键假设，您将能直接测量非仿射涨落，并从数值上验证幻影模型的理论修正因子。这个练习将帮助您从抽象的方程过渡到对一个具体的、动态的系统进行理解和分析。[@problem_id:2935696]", "problem": "您需要实现一个完整的、可运行的程序，该程序构建并分析一个三维珠簧网络，以量化交联点涨落，从应力-应变数据中提取剪切模量，并将测得的非仿射（幻影）剪切模量与其相对于仿射预测的理论折减值进行比较。\n\n推导和算法应基于以下基本事实：\n\n- 高斯链弹性：一个聚合物网络的理想链段，其端到端矢量为 $\\mathbf{r}$，自由能正比于 $\\lVert \\mathbf{r} \\rVert^2$，从而得到一个谐振子弹簧模型。将每个网络链段建模为一个谐振子弹簧，其能量为 $E_{\\text{spring}} = \\tfrac{1}{2} k \\lVert \\mathbf{r} \\rVert^2$，其中 $k$ 是一个恒定的弹簧刚度（使用约化单位，令 $k = 1$）。\n- 网络运动学：设 $\\mathbf{R}_i$ 为边长为 $L$ 的周期性立方晶胞中交联点 $i$ 的参考位置（使用约化单位，晶格间距为 $1$，因此对于 $n \\times n \\times n$ 的晶格，$L = n$）。一个施加的简单剪切，其工程剪切应变为 $\\gamma$，方向沿 $x$ 轴，梯度沿 $y$ 轴，由形变梯度 $\\mathbf{F}(\\gamma) = \\mathbf{I} + \\gamma\\, \\mathbf{e}_x \\otimes \\mathbf{e}_y$ 表示，即 $\\mathbf{F} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$。\n- 仿射与幻影运动学：仿射预测将节点位置取为 $\\mathbf{r}_i^{\\text{aff}} = \\mathbf{F}\\mathbf{R}_i$。幻影网络允许交联点在施加的宏观形变下发生非仿射位移 $\\mathbf{w}_i$，以最小化网络总能量：$\\mathbf{r}_i = \\mathbf{F}\\mathbf{R}_i + \\mathbf{w}_i$。\n- 能量公式：对于节点 $i$ 和 $j$ 之间的一个无向键（弹簧），其参考键矢量为 $\\Delta \\mathbf{R}_{ij}$（考虑周期性），当前键矢量为 $\\mathbf{r}_j - \\mathbf{r}_i = \\mathbf{F}\\Delta \\mathbf{R}_{ij} + (\\mathbf{w}_j - \\mathbf{w}_i)$。总能量为 $E(\\gamma, \\{\\mathbf{w}\\}) = \\tfrac{1}{2} \\sum_{\\langle ij \\rangle} \\lVert \\mathbf{F}\\Delta \\mathbf{R}_{ij} + (\\mathbf{w}_j - \\mathbf{w}_i) \\rVert^2$。仿射能量使用 $\\mathbf{w}_i \\equiv \\mathbf{0}$（对所有 $i$）。\n- 剪切模量的线性响应提取：在小应变范围内，简单剪切中的应变能密度为 $u(\\gamma) = \\tfrac{1}{2} G \\gamma^2 + o(\\gamma^2)$。因此，对于一个体积为 $V$ 的系统，在 $\\gamma \\to 0$ 的极限下，剪切模量可以从相对于零应变的能量变化中提取：$G = \\dfrac{2}{V\\,\\gamma^2}\\left[E(\\gamma) - E(0)\\right]$。这等价于 $G = \\left.\\dfrac{\\partial \\sigma_{xy}}{\\partial \\gamma}\\right|_{\\gamma \\to 0}$，其中 $\\sigma_{xy}$ 是剪切应力，但在此您必须使用基于能量的路径。\n\n网络构建与数值方法约束：\n\n- 几何与连通性：在 $n \\times n \\times n$ 网格上构建一个具有周期性边界条件 (PBC) 的周期性简单立方交联网络。使用连接每个节点到其沿坐标轴 $(\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}})$ 的六个最近邻的键，通过仅列出正方向上的键 $(+\\hat{\\mathbf{x}}, +\\hat{\\mathbf{y}}, +\\hat{\\mathbf{z}})$ 并应用周期性边界条件来实现；这使得每个交联点都具有统一的功能度（配位数）$f = 6$。\n- 约化单位：使用约化单位，令 $k = 1$，晶格间距 $a = 1$，玻尔兹曼常数乘以温度 $k_{\\mathrm{B}} T = 1$，因此所有输出均为无量纲的。立方晶胞体积为 $V = L^3$，其中 $L = n$。\n- 幻影最小化：对于给定的 $\\gamma$，计算使 $E(\\gamma, \\{\\mathbf{w}\\})$ 最小化的非仿射位移 $\\{\\mathbf{w}_i\\}$。使用图关联矩阵 $\\mathbf{B}$（行代表键，列代表节点，每行在键的起始节点处为 $-1$，末端节点处为 $+1$），为每个笛卡尔分量 $\\alpha \\in \\{x,y,z\\}$ 写出二次型 $E_\\alpha = \\tfrac{1}{2}\\lVert \\mathbf{B}\\,\\mathbf{w}^{(\\alpha)} + \\mathbf{d}^{(\\alpha)} \\rVert^2$，其中 $\\mathbf{d}^{(\\alpha)}$ 堆叠了所有键的 $\\mathbf{F}\\Delta \\mathbf{R}_{ij}$ 的 $\\alpha$ 分量。最小化可得到稀疏法向方程 $\\mathbf{L}\\,\\mathbf{w}^{(\\alpha)} = -\\mathbf{B}^{\\mathsf{T}} \\mathbf{d}^{(\\alpha)}$，其中图拉普拉斯算子为 $\\mathbf{L} = \\mathbf{B}^{\\mathsf{T}}\\mathbf{B}$。通过将每个分量中一个节点的位移固定为零来固定规范，以消除与刚性平移相关的零空间。\n- 能量评估：计算仿射能量变化 $\\Delta E_{\\text{aff}}(\\gamma) = E_{\\text{aff}}(\\gamma) - E_{\\text{aff}}(0)$ 和幻影最小化能量变化 $\\Delta E_{\\text{phan}}(\\gamma) = E_{\\text{min}}(\\gamma) - E_{\\text{min}}(0)$，然后通过 $G = \\dfrac{2\\Delta E}{V \\gamma^2}$ 提取 $G_{\\text{aff}}$ 和 $G_{\\text{phan}}$。\n\n交联点涨落量化与理论折减因子：\n\n- 交联点涨落：报告在所有节点上平均的非仿射位移大小的均方值 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle$，并报告应变归一化的涨落振幅 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle / \\gamma^2$。\n- 理论幻影折减因子：推导具有统一功能度 $f$ 的幻影网络中剪切模量的理论折减因子，并用它计算幻影剪切模量与仿射剪切模量之间的预测比率（仅用 $f$ 表示）。不要使用任何经验拟合；您的推导必须遵循消除由二次能量和网络连通性所蕴含的交联点平移涨落模式的思路。\n\n需要实现和计算的任务：\n\n1. 对于给定的 $n$，构建 $f = 6$ 的周期性立方网络，构建其关联矩阵 $\\mathbf{B}$ 和拉普拉斯算子 $\\mathbf{L}$，并为幻影网络实现能量最小化求解器，该求解器对每个笛卡尔分量使用一个稀疏线性系统，且每个分量固定一个节点。\n2. 对于下面的每个测试用例，计算：\n   - 来自 $\\Delta E_{\\text{aff}}(\\gamma)$ 的仿射模量 $G_{\\text{aff}}$。\n   - 来自 $\\Delta E_{\\text{phan}}(\\gamma)$ 的幻影模量 $G_{\\text{phan}}$。\n   - 测量的折减因子 $\\phi_{\\text{meas}} = G_{\\text{phan}} / G_{\\text{aff}}$。\n   - 根据 $f$ 推导出的理论预测因子 $\\phi_{\\text{theory}}$，以及绝对误差 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$。\n   - 针对指定用例的应变归一化的交联点涨落振幅 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle / \\gamma^2$。\n\n3. 使用基于能量的定义，通过在两个小应变下计算 $G_{\\text{phan}}$ 并返回其绝对差值来检查线性响应。\n\n测试套件（所有输出均为无量纲浮点数）：\n\n- 用例 A（有限尺寸，小晶胞）：$n = 2$，$\\gamma = 1.0 \\times 10^{-4}$。返回 $\\phi_{\\text{meas}}$ 和 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$。\n- 用例 B（较大晶胞）：$n = 4$，$\\gamma = 1.0 \\times 10^{-4}$。返回 $\\phi_{\\text{meas}}$ 和 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$。\n- 用例 C（线性度检查）：$n = 4$，$\\gamma_1 = 1.0 \\times 10^{-4}$ 和 $\\gamma_2 = 5.0 \\times 10^{-4}$。返回 $|G_{\\text{phan}}(\\gamma_1) - G_{\\text{phan}}(\\gamma_2)|$。\n- 用例 D（交联点涨落）：$n = 4$，$\\gamma = 1.0 \\times 10^{-3}$。返回应变归一化的涨落振幅 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle / \\gamma^2$。\n\n最终输出格式：\n\n- 您的程序必须产生单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序如下：\n  1. 用例 A 的 $\\phi_{\\text{meas}}$，\n  2. 用例 A 的 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$，\n  3. 用例 B 的 $\\phi_{\\text{meas}}$，\n  4. 用例 B 的 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$，\n  5. 用例 C 的 $|G_{\\text{phan}}(\\gamma_1) - G_{\\text{phan}}(\\gamma_2)|$，\n  6. 用例 D 的 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle / \\gamma^2$。", "solution": "该问题已经过验证，被认定具有科学依据、提法明确且客观。它代表了聚合物网络弹性领域一个标准的计算问题。所有必要的参数和方法都已提供，以获得唯一的数值解。我将进行完整的推导和算法描述。\n\n### 理论基础\n\n该问题要求分析一个在简单剪切作用下的珠簧聚合物网络，并比较仿射网络模型和幻影网络模型的预测结果。\n\n**1. 网络能量公式**\n\n一个网络由 $N$ 个交联点（节点）和弹性链段（键）连接而成。在约化单位中，弹簧常数 $k=1$。单个端到端矢量为 $\\mathbf{r}$ 的链段的弹性能为 $E_{\\text{spring}} = \\frac{1}{2} \\lVert \\mathbf{r} \\rVert^2$。\n\n交联点的参考位置构成一个大小为 $n \\times n \\times n$ 的简单立方晶格，记为 $\\{\\mathbf{R}_i\\}$。周期性晶胞的体积为 $V = n^3$。施加一个宏观简单剪切形变，由形变梯度张量描述：\n$$\n\\mathbf{F}(\\gamma) = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n仿射模型假设交联点完美地遵循宏观形变。节点 $i$ 的位置是 $\\mathbf{r}_i^{\\text{aff}} = \\mathbf{F}\\mathbf{R}_i$。\n幻影模型允许交联点相对于仿射位置有局部的非仿射位移 $\\mathbf{w}_i$，使得 $\\mathbf{r}_i = \\mathbf{F}\\mathbf{R}_i + \\mathbf{w}_i$。这些位移通过最小化网络总能量来确定。\n\n对于连接节点 $i$ 和 $j$ 的一个键，其参考矢量为 $\\Delta\\mathbf{R}_{ij} = \\mathbf{R}_j - \\mathbf{R}_i$，当前键矢量为 $\\mathbf{r}_j - \\mathbf{r}_i = \\mathbf{F}\\Delta\\mathbf{R}_{ij} + (\\mathbf{w}_j - \\mathbf{w}_i)$。网络的总能量是所有键 $\\langle ij \\rangle$ 上能量的总和：\n$$\nE(\\gamma, \\{\\mathbf{w}\\}) = \\frac{1}{2} \\sum_{\\langle ij \\rangle} \\lVert \\mathbf{F}\\Delta\\mathbf{R}_{ij} + \\mathbf{w}_j - \\mathbf{w}_i \\rVert^2\n$$\n仿射能量 $E_{\\text{aff}}(\\gamma)$ 是通过将所有 $\\mathbf{w}_i = \\mathbf{0}$ 设置得到的。幻影能量 $E_{\\text{min}}(\\gamma)$ 是通过对所有非仿射位移 $\\{\\mathbf{w}_i\\}$ 最小化 $E(\\gamma, \\{\\mathbf{w}\\})$ 得到的。\n\n**2. 幻影网络的能量最小化**\n\n能量表达式是关于位移 $\\mathbf{w}_i$ 的二次型。位移的三个笛卡尔分量是解耦的，允许对每个分量 $\\alpha \\in \\{x, y, z\\}$ 进行独立最小化。设 $\\mathbf{w}^{(\\alpha)}$ 为所有 $w_{i,\\alpha}$ 构成的向量，$\\mathbf{d}^{(\\alpha)}$ 为所有键的 $\\mathbf{F}\\Delta\\mathbf{R}_{ij}$ 的 $\\alpha$ 分量构成的向量。使用图关联矩阵 $\\mathbf{B}$，其中每行对应一个键，并在起始和末端节点的列上分别有 $-1$ 和 $+1$ 的条目，分量 $\\alpha$ 的能量为：\n$$\nE_\\alpha = \\frac{1}{2} \\left\\lVert \\mathbf{B}\\mathbf{w}^{(\\alpha)} + \\mathbf{d}^{(\\alpha)} \\right\\rVert^2\n$$\n通过将梯度设为零 $\\nabla_{\\mathbf{w}^{(\\alpha)}} E_\\alpha = \\mathbf{B}^{\\mathsf{T}}(\\mathbf{B}\\mathbf{w}^{(\\alpha)} + \\mathbf{d}^{(\\alpha)}) = \\mathbf{0}$，对此二次型关于 $\\mathbf{w}^{(\\alpha)}$ 进行最小化，可得法向方程：\n$$\n(\\mathbf{B}^{\\mathsf{T}}\\mathbf{B})\\mathbf{w}^{(\\alpha)} = -\\mathbf{B}^{\\mathsf{T}}\\mathbf{d}^{(\\alpha)}\n$$\n矩阵 $\\mathbf{L} = \\mathbf{B}^{\\mathsf{T}}\\mathbf{B}$ 是网络的图拉普拉斯算子。$\\mathbf{L}$ 是奇异的；其零空间由常数向量构成，对应于整个网络的均匀平移，这种平移不改变能量。为获得唯一解，我们必须固定规范。这可以通过固定一个节点（例如节点0）来实现，使得 $\\mathbf{w}_0 = \\mathbf{0}$。这对应于从 $\\mathbf{L}$ 中移除第一行和第一列，并从 $\\mathbf{w}^{(\\alpha)}$ 和右侧向量中移除第一个元素，从而得到一个可以求解其余位移的非奇异线性系统。\n\n**3. 剪切模量计算**\n\n剪切模量 $G$ 是在小应变 $\\gamma$ 极限下，从应变能密度 $u(\\gamma) = E(\\gamma)/V$ 的变化中提取的：\n$$\nG = \\lim_{\\gamma \\to 0} \\frac{2 \\left[ E(\\gamma) - E(0) \\right]}{V \\gamma^2}\n$$\n对于仿射模型，$G_{\\text{aff}}$ 使用 $E(\\gamma) = E_{\\text{aff}}(\\gamma)$ 计算。对于幻影模型，$G_{\\text{phan}}$ 使用 $E(\\gamma) = E_{\\text{min}}(\\gamma)$ 计算。\n对于指定的具有最近邻键（长度 $a=1$）的立方晶格，有 $N=n^3$ 个节点和 $M=3N$ 个键。对于 $N$ 个节点中的每一个，都有一个在 $+\\hat{\\mathbf{y}}$ 方向上的键，其 $\\Delta\\mathbf{R}=(0,1,0)$。仿射能量变化为 $\\Delta E_{\\text{aff}} = E_{\\text{aff}}(\\gamma) - E_{\\text{aff}}(0) = \\frac{1}{2}\\sum_{\\langle ij \\rangle} (\\lVert\\mathbf{F}\\Delta\\mathbf{R}_{ij}\\rVert^2 - \\lVert\\Delta\\mathbf{R}_{ij}\\rVert^2)$。\n该项计算结果为 $\\frac{1}{2}\\sum_{\\langle ij \\rangle} (2\\gamma \\Delta R_x \\Delta R_y + \\gamma^2 \\Delta R_y^2)$。对于指定的晶格连通性，所有键的 $\\Delta R_x \\Delta R_y=0$。只有 $N$ 个 $\\Delta\\mathbf{R}=(0,1,0)$ 的键有贡献，得到 $\\Delta E_{\\text{aff}} = \\frac{1}{2} N \\gamma^2$。因此，仿射模量为：\n$$\nG_{\\text{aff}} = \\frac{2 (\\frac{1}{2}N\\gamma^2)}{V\\gamma^2} = \\frac{N\\gamma^2}{n^3\\gamma^2} = 1\n$$\n这为数值实现提供了一个有用的解析基准。\n\n**4. 幻影网络的理论折减因子**\n\n幻影网络模型预测的模量低于仿射模型，因为一部分宏观应变被涨落的交联点的平均位置重排所吸收，而不是完全传递到链的形变中。理论折减因子 $\\phi_{\\text{theory}} = G_{\\text{phan}}/G_{\\text{aff}}$ 可以从自由度论证中推导出来。\n\n一个理想网络由 $N$ 个交联点（接点）和 $\\nu_e$ 条弹性活性链组成。在仿射模型中，所有交联点都固定于宏观形变，模量与链的数量成正比：$G_{\\text{aff}} \\propto \\nu_e$。\n在幻影模型中，交联点不是固定的，而是会涨落。链对交联点的约束减少了弹性自由度的总数。对于一个完美网络（无悬垂末端），模量与链的数量减去交联点的数量成正比：$G_{\\text{phan}} \\propto (\\nu_e - N)$。\n\n因此，模量的比值为：\n$$\n\\phi_{\\text{theory}} = \\frac{G_{\\text{phan}}}{G_{\\text{aff}}} = \\frac{\\nu_e - N}{\\nu_e} = 1 - \\frac{N}{\\nu_e}\n$$\n对于一个每个交联点都具有统一配位数（功能度）$f$ 的网络，每条链连接两个交联点，每个交联点是 $f$ 条链的端点。因此，链的数量为 $\\nu_e = \\frac{f N}{2}$。将此代入比值公式中可得：\n$$\n\\phi_{\\text{theory}} = 1 - \\frac{N}{fN/2} = 1 - \\frac{2}{f}\n$$\n在问题中，网络是一个具有最近邻连通性的简单立方晶格，因此每个节点连接到 6 个邻居。功能度为 $f=6$。\n理论折减因子为：\n$$\n\\phi_{\\text{theory}} = 1 - \\frac{2}{6} = \\frac{2}{3}\n$$\n\n### 算法实现\n\n该解决方案通过一个Python程序实现，遵循以下步骤：\n\n1.  **网络生成：** 对于给定的边长 $n$，生成 $N=n^3$ 个节点。使用一个从三维晶格坐标 $(i,j,k)$ 到单个节点索引 $u$ 的映射：$u = i \\cdot n^2 + j \\cdot n + k$。\n2.  **键列表和矩阵构建：** 创建所有键及其对应参考矢量 $\\Delta\\mathbf{R}_{ij}$ 的列表。对于指定的周期性简单立方晶格，我们通过将每个节点连接到其在 $+\\hat{\\mathbf{x}}$、 $+\\hat{\\mathbf{y}}$ 和 $+\\hat{\\mathbf{z}}$ 方向上的邻居来定义 $3N$ 个键，并应用周期性边界条件。参考矢量分别为 $(1,0,0)$、$(0,1,0)$ 和 $(0,0,1)$。\n3.  **关联矩阵和拉普拉斯矩阵：** 构建大小为 $(3N \\times N)$ 的稀疏关联矩阵 $\\mathbf{B}$。使用稀疏矩阵乘法计算图拉普拉斯算子 $\\mathbf{L} = \\mathbf{B}^{\\mathsf{T}}\\mathbf{B}$。\n4.  **非仿射位移求解器：**\n    *   对于给定的剪切应变 $\\gamma$，计算每个笛卡尔分量的驱动向量 $\\mathbf{d}^{(\\alpha)}$。\n    *   对于每个分量，形成右侧向量 $\\mathbf{b}^{(\\alpha)} = -\\mathbf{B}^{\\mathsf{T}}\\mathbf{d}^{(\\alpha)}$。\n    *   通过从 $\\mathbf{L}$ 中移除对应于被固定节点（节点0）的行和列来应用规范固定条件，得到一个可逆矩阵 $\\mathbf{L}'$。类似地，从 $\\mathbf{b}^{(\\alpha)}$ 中移除第一个元素得到 $\\mathbf{b'}^{(\\alpha)}$。\n    *   使用 `scipy.sparse.linalg.spsolve` 求解稀疏线性系统 $\\mathbf{L}'\\mathbf{w'}^{(\\alpha)} = \\mathbf{b'}^{(\\alpha)}$。\n    *   通过为被固定的节点插入一个零来重构完整的位移向量 $\\mathbf{w}^{(\\alpha)}$。\n5.  **能量和模量计算：**\n    *   仿射模量 $G_{\\text{aff}}$ 的解析值为 $1$。\n    *   应变为 $\\gamma$ 时的最小化幻影能量为 $E_{\\text{min}}(\\gamma) = \\frac{1}{2} \\sum_{\\alpha} \\lVert \\mathbf{B}\\mathbf{w}^{(\\alpha)} + \\mathbf{d}^{(\\alpha)} \\rVert^2$。\n    *   零应变时的能量为 $E_{\\text{min}}(0) = E_{\\text{aff}}(0) = \\frac{1}{2}\\sum_{\\langle ij \\rangle}\\lVert \\Delta\\mathbf{R}_{ij} \\rVert^2 = \\frac{3N}{2}$，因为所有键长都为 $1$。\n    *   幻影模量计算为 $G_{\\text{phan}} = \\frac{2(E_{\\text{min}}(\\gamma) - E_{\\text{min}}(0))}{V\\gamma^2}$。\n6.  **涨落分析：**\n    *   均方非仿射位移计算为 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle = \\frac{1}{N} \\sum_i (\\mathbf{w}_i \\cdot \\mathbf{w}_i)$。\n    *   应变归一化的涨落振幅则为 $\\langle \\lVert \\mathbf{w} \\rVert^2 \\rangle / \\gamma^2$。\n7.  **测试用例执行：** 对测试套件中指定的每组参数执行上述过程，并收集所要求的量以用于最终输出。根据要求计算绝对误差 $|\\phi_{\\text{meas}} - \\phi_{\\text{theory}}|$ 和线性度检查 $|G_{\\text{phan}}(\\gamma_1)-G_{\\text{phan}}(\\gamma_2)|$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef calculate_network_properties(n, gamma, calculate_fluctuations=False):\n    \"\"\"\n    Constructs and analyzes a bead-spring network to find elastic moduli.\n\n    Args:\n        n (int): Side length of the cubic lattice.\n        gamma (float): Applied engineering shear strain.\n        calculate_fluctuations (bool): If True, computes and returns the \n                                       normalized fluctuation amplitude.\n\n    Returns:\n        tuple: A tuple containing (G_aff, G_phan, fluctuation_amplitude).\n               fluctuation_amplitude is 0.0 unless calculate_fluctuations is True.\n    \"\"\"\n    # 1. Network Construction\n    N = n * n * n  # Total number of nodes\n    V = float(N)   # Volume in reduced units\n\n    # Create lists of bonds and their reference vectors\n    bonds = []\n    bond_vectors = []\n    for i in range(n):\n        for j in range(n):\n            for k in range(n):\n                u = i * n**2 + j * n + k\n                \n                # Bond in +x direction (with PBC)\n                v_x = ((i + 1) % n) * n**2 + j * n + k\n                bonds.append((u, v_x))\n                bond_vectors.append([1.0, 0.0, 0.0])\n\n                # Bond in +y direction (with PBC)\n                v_y = i * n**2 + ((j + 1) % n) * n + k\n                bonds.append((u, v_y))\n                bond_vectors.append([0.0, 1.0, 0.0])\n                \n                # Bond in +z direction (with PBC)\n                v_z = i * n**2 + j * n + ((k + 1) % n)\n                bonds.append((u, v_z))\n                bond_vectors.append([0.0, 0.0, 1.0])\n    \n    num_bonds = len(bonds)\n    bond_vectors = np.array(bond_vectors, dtype=np.float64)\n\n    # 2. Matrix Construction (Incidence B, Laplacian L)\n    B = lil_matrix((num_bonds, N), dtype=np.float64)\n    for bond_idx, (u, v) in enumerate(bonds):\n        B[bond_idx, u] = -1.0\n        B[bond_idx, v] = 1.0\n    B = B.tocsc()\n    L = (B.T @ B).tocsc()\n\n    # 3. Affine Modulus Calculation (Analytical)\n    # delta_E_aff = 0.5 * sum over bonds of (gamma^2 * dy^2)\n    # There are N y-bonds, each with dy=1.\n    delta_E_aff = 0.5 * N * gamma**2\n    G_aff = (2.0 * delta_E_aff) / (V * gamma**2) # Should be exactly 1.0\n\n    # 4. Phantom Modulus Calculation (Numerical)\n    # a) Deformation gradient F and driving vector d\n    F = np.array([[1.0, gamma, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n    d_vectors = (F @ bond_vectors.T).T\n    d_x, d_y, d_z = d_vectors[:, 0], d_vectors[:, 1], d_vectors[:, 2]\n\n    # b) Solve for non-affine displacements w\n    # Pin node 0 to remove rigid translation nullspace\n    pinned_node_idx = 0\n    active_nodes_indices = list(range(N))\n    active_nodes_indices.pop(pinned_node_idx)\n    \n    L_prime = L[np.ix_(active_nodes_indices, active_nodes_indices)]\n\n    # RHS vectors b = -B^T * d\n    b_x, b_y, b_z = -B.T @ d_x, -B.T @ d_y, -B.T @ d_z\n    \n    b_x_prime = b_x[active_nodes_indices]\n    b_y_prime = b_y[active_nodes_indices]\n    b_z_prime = b_z[active_nodes_indices]\n    \n    # Solve sparse linear system L'w' = b'\n    w_x_prime = spsolve(L_prime, b_x_prime)\n    w_y_prime = spsolve(L_prime, b_y_prime)\n    w_z_prime = spsolve(L_prime, b_z_prime)\n\n    # Reconstruct full w vectors\n    w_x, w_y, w_z = np.zeros(N), np.zeros(N), np.zeros(N)\n    w_x[active_nodes_indices] = w_x_prime\n    w_y[active_nodes_indices] = w_y_prime\n    w_z[active_nodes_indices] = w_z_prime\n    \n    # c) Calculate minimized energy and modulus\n    # Energy at gamma=0. E(0) = 0.5 * sum(|bond_vector|^2) = 0.5 * num_bonds * 1^2\n    E_min_0 = 0.5 * num_bonds\n\n    # Minimized energy at strain gamma. E_min(gamma) = 0.5 * ||Bw + d||^2 for each component\n    E_min_gamma = 0.5 * (\n        np.linalg.norm(B @ w_x + d_x)**2 +\n        np.linalg.norm(B @ w_y + d_y)**2 +\n        np.linalg.norm(B @ w_z + d_z)**2\n    )\n\n    delta_E_phan = E_min_gamma - E_min_0\n    G_phan = (2.0 * delta_E_phan) / (V * gamma**2)\n    \n    # 5. Fluctuation amplitude calculation (optional)\n    fluctuation_amplitude = 0.0\n    if calculate_fluctuations:\n        # ||w||^2 = wx^2 + wy^2 + wz^2\n        w_squared_mag = w_x**2 + w_y**2 + w_z**2\n        mean_w_squared_mag = np.mean(w_squared_mag)\n        fluctuation_amplitude = mean_w_squared_mag / gamma**2\n\n    return G_aff, G_phan, fluctuation_amplitude\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'id': 'A', 'n': 2, 'gamma': 1.0e-4},\n        {'id': 'B', 'n': 4, 'gamma': 1.0e-4},\n        {'id': 'C', 'n': 4, 'gammas': [1.0e-4, 5.0e-4]},\n        {'id': 'D', 'n': 4, 'gamma': 1.0e-3}\n    ]\n\n    # Theoretical reduction factor for functionality f=6\n    f = 6.0\n    phi_theory = 1.0 - 2.0 / f\n\n    results = []\n\n    # --- Case A ---\n    case_A = test_cases[0]\n    G_aff_A, G_phan_A, _ = calculate_network_properties(case_A['n'], case_A['gamma'])\n    phi_meas_A = G_phan_A / G_aff_A\n    error_A = abs(phi_meas_A - phi_theory)\n    results.extend([phi_meas_A, error_A])\n\n    # --- Case B ---\n    case_B = test_cases[1]\n    G_aff_B, G_phan_B, _ = calculate_network_properties(case_B['n'], case_B['gamma'])\n    phi_meas_B = G_phan_B / G_aff_B\n    error_B = abs(phi_meas_B - phi_theory)\n    results.extend([phi_meas_B, error_B])\n\n    # --- Case C ---\n    case_C = test_cases[2]\n    _, G_phan_C1, _ = calculate_network_properties(case_C['n'], case_C['gammas'][0])\n    _, G_phan_C2, _ = calculate_network_properties(case_C['n'], case_C['gammas'][1])\n    G_diff_C = abs(G_phan_C1 - G_phan_C2)\n    results.append(G_diff_C)\n\n    # --- Case D ---\n    case_D = test_cases[3]\n    _, _, fluctuation_D = calculate_network_properties(case_D['n'], case_D['gamma'], calculate_fluctuations=True)\n    results.append(fluctuation_D)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2935696"}]}