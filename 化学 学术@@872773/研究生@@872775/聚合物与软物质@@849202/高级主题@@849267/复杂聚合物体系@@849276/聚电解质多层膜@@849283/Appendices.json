{"hands_on_practices": [{"introduction": "石英晶体微天平（QCM-D）是原位监测聚电解质多层膜（PEM）生长的关键技术。然而，原始数据（频率变化）通常对应于包含大量水分的“水合质量”，直接使用Sauerbrey方程会引入显著误差。本练习将指导您如何超越简单的Sauerbrey模型，应用Voigt粘弹性模型来校正耦合水的影响，从而精确计算出沉积的聚合物干质量[@problem_id:2922924]。", "problem": "通过在具有耗散监测功能的石英晶体微天平（QCM-D）上交替吸附聚阳离子和聚阴离子来组装聚电解质多层膜。对于在 $f_{0}=5.0 \\ \\mathrm{MHz}$ 晶体上，泛音指数 $n=5$ 的单个聚阴离子吸附步骤，仪器报告的Sauerbrey等效面密度增量为 $550 \\ \\mathrm{ng} \\ \\mathrm{cm}^{-2}$。由于薄膜不是刚性的，需要使用Voigt粘弹性模型进行描述。使用已知水合膜的储能模量和粘度，对同一步骤进行独立的、频率匹配的Voigt拟合，得到在角频率 $\\omega = 2 \\pi \\times 25 \\times 10^{6} \\ \\mathrm{s}^{-1}$ 下，水合膜厚度增量为 $h = 5.0 \\ \\mathrm{nm}$。在该水合状态下，Voigt模型中薄膜的复剪切模量为 $G^{*} = \\mu' + i \\omega \\eta$，其中储能模量 $\\mu' = 0.30 \\ \\mathrm{MPa}$，粘度 $\\eta = 0.20 \\ \\mathrm{Pa} \\cdot \\mathrm{s}$。假设在此时间尺度上，水相的储能模量可忽略不计，$G'_{\\mathrm{water}} \\approx 0$，并且在相同频率下，干燥聚合物的储能模量为 $G'_{\\mathrm{polymer}} = 1.00 \\ \\mathrm{MPa}$。将水合膜视为聚合物和水的等应变（并联）复合材料，这与Voigt模型一致，因此储能模量线性混合，密度遵循混合法则。取聚合物密度 $\\rho_{p} = 1.35 \\ \\mathrm{g} \\ \\mathrm{cm}^{-3}$，水密度 $\\rho_{w} = 1.00 \\ \\mathrm{g} \\ \\mathrm{cm}^{-3}$。\n\n利用这些数据和假设，通过校正捕获的水分，计算在此吸附步骤中增加的单位面积干燥聚合物质量。最终答案以 $\\mathrm{ng} \\ \\mathrm{cm}^{-2}$ 为单位表示，并四舍五入到三位有效数字。", "solution": "具有耗散监测功能的石英晶体微天平（QCM-D）测量共振频移，对于刚性薄膜，该频移与面密度成正比（Sauerbrey关系）。对于粘弹性薄膜，Voigt模型将薄膜视为具有复剪切模量 $G^{*} = \\mu' + i \\omega \\eta$ 的均匀连续体。水合膜同时包含聚合物和水；其储能模量 $G'_{\\mathrm{film}}$ 反映了承载负荷的聚合物的比例。在与Voigt模型一致的等应变（并联）假设下，两相复合材料的储能模量线性混合，\n$$\nG'_{\\mathrm{film}} = \\phi_{p} \\, G'_{\\mathrm{polymer}} + (1 - \\phi_{p}) \\, G'_{\\mathrm{water}} \\, ,\n$$\n其中 $\\phi_{p}$ 是水合膜中聚合物的体积分数。在测量时间尺度上，液态水的储能模量可忽略不计，因此 $G'_{\\mathrm{water}} \\approx 0$，得到\n$$\nG'_{\\mathrm{film}} \\approx \\phi_{p} \\, G'_{\\mathrm{polymer}} \\quad \\Rightarrow \\quad \\phi_{p} = \\frac{G'_{\\mathrm{film}}}{G'_{\\mathrm{polymer}}} = \\frac{\\mu'}{G'_{\\mathrm{polymer}}} \\, .\n$$\n代入给定值，\n$$\n\\phi_{p} = \\frac{0.30 \\ \\mathrm{MPa}}{1.00 \\ \\mathrm{MPa}} = 0.30 \\, .\n$$\n\n该步骤相关的单位面积干燥聚合物质量是聚合物密度乘以其单位面积的体积，即聚合物体积分数乘以水合厚度：\n$$\nm_{\\mathrm{dry}} = \\rho_{p} \\, \\phi_{p} \\, h \\, .\n$$\n代入数值，将厚度转换为厘米以获得每平方厘米的质量：\n$$\nh = 5.0 \\ \\mathrm{nm} = 5.0 \\times 10^{-7} \\ \\mathrm{cm} \\, ,\n$$\n以及\n$$\nm_{\\mathrm{dry}} = \\left(1.35 \\ \\mathrm{g} \\ \\mathrm{cm}^{-3}\\right) \\times 0.30 \\times \\left(5.0 \\times 10^{-7} \\ \\mathrm{cm}\\right) \\, .\n$$\n计算乘积：\n$$\n1.35 \\times 0.30 = 0.405 \\, ,\n$$\n所以\n$$\nm_{\\mathrm{dry}} = 0.405 \\times 5.0 \\times 10^{-7} \\ \\mathrm{g} \\ \\mathrm{cm}^{-2} = 2.025 \\times 10^{-7} \\ \\mathrm{g} \\ \\mathrm{cm}^{-2} \\, .\n$$\n使用 $1 \\ \\mathrm{g} = 10^{9} \\ \\mathrm{ng}$ 将单位转换为 $\\mathrm{ng} \\ \\mathrm{cm}^{-2}$：\n$$\nm_{\\mathrm{dry}} = 2.025 \\times 10^{-7} \\ \\mathrm{g} \\ \\mathrm{cm}^{-2} \\times 10^{9} \\ \\frac{\\mathrm{ng}}{\\mathrm{g}} = 2.025 \\times 10^{2} \\ \\mathrm{ng} \\ \\mathrm{cm}^{-2} \\, .\n$$\n最后，四舍五入到三位有效数字：\n$$\nm_{\\mathrm{dry}} \\approx 203 \\ \\mathrm{ng} \\ \\mathrm{cm}^{-2} \\, .\n$$\n\n作为一致性检查，我们还可以使用密度混合法则，将水合面密度估算为 $\\rho_{\\mathrm{film}} h$，\n$$\n\\rho_{\\mathrm{film}} = \\phi_{p} \\rho_{p} + (1 - \\phi_{p}) \\rho_{w} = 0.30 \\times 1.35 + 0.70 \\times 1.00 = 1.105 \\ \\mathrm{g} \\ \\mathrm{cm}^{-3} \\, ,\n$$\n所以\n$$\nm_{\\mathrm{hydrated}} = 1.105 \\ \\mathrm{g} \\ \\mathrm{cm}^{-3} \\times 5.0 \\times 10^{-7} \\ \\mathrm{cm} = 5.525 \\times 10^{-7} \\ \\mathrm{g} \\ \\mathrm{cm}^{-2} = 552.5 \\ \\mathrm{ng} \\ \\mathrm{cm}^{-2} \\, ,\n$$\n这与报告的Sauerbrey等效增量一致，验证了校正的内部一致性。然而，所要求的量是上面计算的干燥聚合物增加量 $m_{\\mathrm{dry}}$。", "answer": "$$\\boxed{203}$$", "id": "2922924"}, {"introduction": "聚电解质多层膜的生长并非总是线性的，指数增长是一个重要且常见的模式，它通常表明聚合物链在深入渗透到现有膜中。本练习旨在将宏观测量（例如，通过椭圆偏振光谱法测量的厚度指数增长）与微观物理过程（扩散）联系起来。您将学习如何从实验数据中提取特征增长指数，并利用菲克扩散模型，将该宏观参数与聚合物在膜内的有效扩散系数关联起来，从而深化对自组装机理的理解[@problem_id:2922913]。", "problem": "通过交替吸附带相反电荷的聚合物组装而成的聚电解质多层膜（PEM），其厚度随双层指数呈指数增长。时间分辨椭偏仪测得在双层数 $n$ 时的干膜厚度值为：$h(0)=18.0\\,\\mathrm{nm}$，$h(3)=22.045\\,\\mathrm{nm}$ 和 $h(6)=27.0\\,\\mathrm{nm}$。假设函数形式 $h(n)=h_0 \\exp(\\alpha n)$ 在此范围内精确成立。\n\n在每次从溶液中吸附渗入的聚阴离子过程中，其向膜内的互穿受扩散限制。将持续时间为 $\\tau=600\\,\\mathrm{s}$ 的单个吸附步骤中的互穿过程，模拟为向一个半無限介质中的一维菲克扩散。该介质的初始内部聚合物浓度对于 $z>0$ 为 $C(z,0)=0$，且在 $0  t \\le \\tau$ 期间，在表面 $z=0$ 处维持一个恒定的聚合物浓度 $C_0$。在时间 $\\tau$ 后，单位面积上吸附的总质量 $M$ 与浓度分布的积分成正比。将指数增长率 $\\alpha$ 与此吸附过程相关联，认为每个双层步骤中相对厚度的增加 $\\alpha = \\Delta h / h$ 等于一个无量纲常数 $k=0.0125\\,\\mathrm{nm}^{-1}$ 乘以扩散长度 $\\ell_D=\\sqrt{D \\tau}$。\n\n根据实验测量的厚度数据，计算聚合物在膜内的扩散系数 $D$。最终答案以 $\\mathrm{m}^2 \\mathrm{s}^{-1}$ 为单位，并四舍五入到三位有效数字。", "solution": "**步骤 1：从实验数据中提取指数增长率 $\\alpha$**\n\n给定的厚度增长模型为指数形式：$h(n) = h_0 \\exp(\\alpha n)$。\n其中 $n$ 是双层数。我们有实验数据点：\n-   当 $n=0$ 时，$h(0) = 18.0\\,\\mathrm{nm}$。这直接给出了初始厚度 $h_0 = 18.0\\,\\mathrm{nm}$。\n-   当 $n=3$ 时，$h(3) = 22.045\\,\\mathrm{nm}$。\n\n我们可以用这两个数据点来计算无量纲的指数增长率 $\\alpha$。\n$$\nh(3) = h(0) \\exp(3\\alpha)\n$$\n$$\n22.045 = 18.0 \\exp(3\\alpha)\n$$\n$$\n\\exp(3\\alpha) = \\frac{22.045}{18.0} \\approx 1.224722\n$$\n对两边取自然对数：\n$$\n3\\alpha = \\ln(1.224722) \\approx 0.20273\n$$\n$$\n\\alpha = \\frac{0.20273}{3} \\approx 0.067577\n$$\n我们可以用 $n=6$ 的数据点进行验证：\n$$\nh(6) = 18.0 \\exp(6 \\times 0.067577) = 18.0 \\exp(0.405462) \\approx 18.0 \\times 1.500 = 27.0\\,\\mathrm{nm}\n$$\n这与给定的 $h(6)=27.0\\,\\mathrm{nm}$ 完全吻合，证实了 $\\alpha$ 值的准确性。\n\n**步骤 2：应用扩散模型计算扩散系数 $D$**\n\n问题陈述提供了一个将宏观增长率 $\\alpha$ 与微观扩散过程联系起来的模型：\n$$\n\\alpha = k \\cdot \\ell_D = k \\sqrt{D \\tau}\n$$\n其中：\n-   $\\alpha \\approx 0.067577$ (无量纲)\n-   $k = 0.0125\\,\\mathrm{nm}^{-1}$ (给定的比例常数)\n-   $\\tau = 600\\,\\mathrm{s}$ (吸附时间)\n-   $D$ 是待求的扩散系数。\n\n将已知值代入模型方程：\n$$\n0.067577 = (0.0125\\,\\mathrm{nm}^{-1}) \\times \\sqrt{D \\times 600\\,\\mathrm{s}}\n$$\n首先，求解扩散长度 $\\sqrt{D \\tau}$：\n$$\n\\sqrt{D \\tau} = \\frac{0.067577}{0.0125\\,\\mathrm{nm}^{-1}} \\approx 5.40616\\,\\mathrm{nm}\n$$\n然后，对上式两边平方，以求解 $D \\tau$：\n$$\nD \\tau = (5.40616\\,\\mathrm{nm})^2 \\approx 29.2266\\,\\mathrm{nm}^2\n$$\n最后，除以时间 $\\tau$ 得到扩散系数 $D$：\n$$\nD = \\frac{29.2266\\,\\mathrm{nm}^2}{600\\,\\mathrm{s}} \\approx 0.048711\\,\\mathrm{nm}^2/\\mathrm{s}\n$$\n\n**步骤 3：单位换算与格式化**\n\n问题要求答案以 $\\mathrm{m}^2 \\mathrm{s}^{-1}$ 为单位，并保留三位有效数字。我们需要将 $\\mathrm{nm}^2$ 转换为 $\\mathrm{m}^2$。\n$$\n1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m} \\implies 1\\,\\mathrm{nm}^2 = (10^{-9})^2\\,\\mathrm{m}^2 = 10^{-18}\\,\\mathrm{m}^2\n$$\n所以，\n$$\nD \\approx 0.048711 \\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s} = 4.8711 \\times 10^{-20}\\,\\mathrm{m}^2/\\mathrm{s}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\nD = 4.87 \\times 10^{-20}\\,\\mathrm{m}^2/\\mathrm{s}\n$$", "answer": "$$\\boxed{4.87 \\times 10^{-20}}$$", "id": "2922913"}, {"introduction": "“智能”聚电解质多层膜的功能通常源于其对pH等外部刺激的响应性，这种响应性在由弱聚电解质构成的膜中尤为显著。本高级练习将指导您建立一个物理模型来描述膜的电荷调节行为，并通过将模型拟合到滴定数据，提取出聚合物在膜内的有效$p K_a$值。这能够量化地揭示局部静电环境是如何改变聚合物链的酸碱性质的，这是理解和设计功能性薄膜的关键一步[@problem_id:2922967]。", "problem": "由弱聚电解质酸和弱聚电解质碱形成的聚电解质多层膜（PEM）在其内部表现出pH依赖性的电荷调节特性。考虑一个均匀的PEM，其中聚碱位点的分数为组分变量 $c \\in (0,1)$，聚酸位点的分数为 $1-c$。设酸性位点和碱性位点在自由溶液中的固有解离常数分别为 $\\mathrm{p}K_{a,\\mathrm{acid}}^{0} = 4.8$ 和 $\\mathrm{p}K_{a,\\mathrm{base}}^{0} = 9.2$。由于膜内的限域效应和静电环境，有效的酸和碱解离常数会偏离其在自由溶液中的值。假设这些有效偏移是组分的线性函数：\n$$\n\\Delta \\mathrm{p}K_{a,\\mathrm{acid}}(c) = a_0 + a_1 \\left( c - 0.5 \\right),\n\\quad\n\\Delta \\mathrm{p}K_{a,\\mathrm{base}}(c) = b_0 + b_1 \\left( c - 0.5 \\right),\n$$\n其中 $a_0, a_1, b_0, b_1$ 是待确定的未知实数参数。\n\n使用标准位点结合质量作用框架来模拟均匀环境中弱酸和弱碱在平衡时的电离度。设酸性位点的电离（去质子化）分数是本体 $\\mathrm{pH}$ 和有效 $\\mathrm{p}K_a$ 的函数，碱性位点（质子化分数）也类似。每个位点的归一化膜净电荷（记为 $y$）定义为质子化的碱性位点贡献的正电荷与去质子化的酸性位点贡献的负电荷之差，两者均按其在膜中的位点分数加权。具体来说，$y$ 是无量纲的。\n\n给定在六个本体 $\\mathrm{pH}$ 值下测量的三种膜组分 $c \\in \\{0.3, 0.5, 0.7\\}$ 的以下滴定数据，通过对所有组分同时使用非线性最小二乘法将模型拟合到数据，来估计参数 $a_0, a_1, b_0, b_1$。然后，使用拟合的参数，计算在 $c=0.4$ 和 $c=0.6$ 时的有效解离常数：\n$$\n\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(c) = \\mathrm{p}K_{a,\\mathrm{acid}}^{0} + \\Delta \\mathrm{p}K_{a,\\mathrm{acid}}(c),\n\\quad\n\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(c) = \\mathrm{p}K_{a,\\mathrm{base}}^{0} + \\Delta \\mathrm{p}K_{a,\\mathrm{base}}(c).\n$$\n\n使用的基本原理：\n- 酸碱平衡的质量作用定律，总结为关于电离度作为 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 函数的 Henderson–Hasselbalch 关系式。\n- $y$ 的定义，即碱性和酸性位点电离分数的组分加权差。\n\n数据（除 $\\mathrm{pH}$ 在对数标度上是无单位的外，所有数字都是无量纲的）：\n- 组分 $c = 0.3$：\n  - $\\mathrm{pH}$ 值： $[\\,3.5,\\,4.5,\\,5.5,\\,7.0,\\,9.0,\\,10.5\\,]$\n  - 测量的 $y$ 值： $[\\,0.293954,\\,0.243904,\\,-0.026039,\\,-0.381346,\\,-0.599579,\\,-0.695311\\,]$\n- 组分 $c = 0.5$：\n  - $\\mathrm{pH}$ 值： $[\\,3.5,\\,4.5,\\,5.5,\\,7.0,\\,9.0,\\,10.5\\,]$\n  - 测量的 $y$ 值： $[\\,0.493778,\\,0.444060,\\,0.221094,\\,0.004441,\\,-0.306449,\\,-0.490212\\,]$\n- 组分 $c = 0.7$：\n  - $\\mathrm{pH}$ 值： $[\\,3.5,\\,4.5,\\,5.5,\\,7.0,\\,9.0,\\,10.5\\,]$\n  - 测量的 $y$ 值： $[\\,0.694636,\\,0.653782,\\,0.506077,\\,0.396387,\\,0.009938,\\,-0.282843\\,]$\n\n任务：\n1. 从第一性原理出发，使用弱酸和弱碱位点电离度的质量作用表达式（以 $\\mathrm{pH}$ 和有效 $\\mathrm{p}K_a$ 值表示）以及组分加权，构建 $y(\\mathrm{pH}, c; a_0, a_1, b_0, b_1)$ 的公式。\n2. 通过最小化所有给定数据点的残差平方和，拟合参数 $a_0, a_1, b_0, b_1$。\n3. 使用拟合的参数，计算在 $c=0.4$ 和 $c=0.6$ 时的 $\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(c)$ 和 $\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(c)$。\n\n测试组和所需输出：\n- 使用这三种组分及其数据作为测试组。\n- 您的程序必须输出一个包含八个浮点数的列表，保留三位小数，顺序如下：\n  - $[\\,a_0,\\,a_1,\\,b_0,\\,b_1,\\,\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(0.4),\\,\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(0.6),\\,\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(0.4),\\,\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(0.6)\\,]`。\n- 最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[\\,\\dots\\,]$），无空格，且每个数字保留三位小数。\n\n科学真实性和假设：\n- 假设均匀的膜环境，其特征是有效 $\\mathrm{p}K_a$ 偏移随 $c$ 线性变化。\n- 对 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 使用以10为底的对数。\n- 将 $y$ 视为无量纲量。输出中不需要物理单位。", "solution": "所提出的问题是物理化学和高分子科学中的一个标准练习，涉及弱聚电解质多层膜中电荷调节的建模。该问题具有科学依据，提法明确，并包含获得唯一解所需的所有信息。我们将着手解决它。\n\n该模型的基础是酸碱平衡的质量作用定律。弱聚酸和弱聚碱位点的电离度作为本体溶液 $\\mathrm{pH}$ 的函数，由类似 Henderson-Hasselbalch 的关系式描述。\n\n首先，考虑酸性位点（记为 HA），它会发生去质子化反应：$\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^- + \\mathrm{H}^+$。去质子化（电离）的位点分数 $\\alpha_{\\mathrm{acid}}$ 由下式给出：\n$$\n\\alpha_{\\mathrm{acid}} = \\frac{1}{1 + 10^{\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}} - \\mathrm{pH}}}\n$$\n此处，$\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}$ 是聚合物膜内的有效酸解离常数。\n\n其次，考虑碱性位点（记为 B），它会发生质子化反应：$\\mathrm{B} + \\mathrm{H}^+ \\rightleftharpoons \\mathrm{BH}^+$。质子化（电离）的位点分数 $\\alpha_{\\mathrm{base}}$ 由其共轭酸 $\\mathrm{BH}^+$ 的关系式给出：\n$$\n\\alpha_{\\mathrm{base}} = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}}}\n$$\n此处，$\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}$ 是膜内聚碱共轭酸的有效解离常数。\n\n每个单体位点的归一化膜净电荷 $y$ 定义为来自动电离位点的电荷的加权和。聚碱位点的分数为 $c$，当质子化时，它们贡献 $+1$ 的电荷。聚酸位点的分数为 $1-c$，当去质子化时，它们贡献 $-1$ 的电荷。因此，$y$ 由下式给出：\n$$\ny(c, \\mathrm{pH}) = c \\cdot \\alpha_{\\mathrm{base}} - (1-c) \\cdot \\alpha_{\\mathrm{acid}}\n$$\n代入 $\\alpha_{\\mathrm{acid}}$ 和 $\\alpha_{\\mathrm{base}}$ 的表达式，得到：\n$$\ny(c, \\mathrm{pH}) = \\frac{c}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}}} - \\frac{1-c}{1 + 10^{\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}} - \\mathrm{pH}}}\n$$\n问题陈述，有效 $\\mathrm{p}K_a$ 值是组分 $c$ 的函数。它们相对于其自由溶液中的值 $\\mathrm{p}K_{a,\\mathrm{acid}}^{0} = 4.8$ 和 $\\mathrm{p}K_{a,\\mathrm{base}}^{0} = 9.2$ 发生了偏移，偏移量 $\\Delta \\mathrm{p}K_a$ 随 $c$ 线性变化：\n$$\n\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(c) = \\mathrm{p}K_{a,\\mathrm{acid}}^{0} + \\Delta \\mathrm{p}K_{a,\\mathrm{acid}}(c) = 4.8 + a_0 + a_1 (c - 0.5)\n$$\n$$\n\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(c) = \\mathrm{p}K_{a,\\mathrm{base}}^{0} + \\Delta \\mathrm{p}K_{a,\\mathrm{base}}(c) = 9.2 + b_0 + b_1 (c - 0.5)\n$$\n四个未知参数是 $a_0, a_1, b_0, b_1$。将这些方程结合起来，得到 $y$ 作为自变量 $\\mathrm{pH}$ 和 $c$ 以及参数矢量 $\\mathbf{p} = (a_0, a_1, b_0, b_1)$ 函数的完整模型：\n$$\ny(\\mathrm{pH}, c; \\mathbf{p}) = \\frac{c}{1 + 10^{\\mathrm{pH} - (9.2 + b_0 + b_1 (c - 0.5))}} - \\frac{1-c}{1 + 10^{(4.8 + a_0 + a_1 (c - 0.5)) - \\mathrm{pH}}}\n$$\n为确定这些参数，我们执行非线性最小二乘回归，以最小化模型预测与所提供的实验数据之间的残差平方和（SSR）。数据包含在不同的 $(\\mathrm{pH}_i, c_i)$ 对下的 $N=18$ 个 $y_i^{\\mathrm{exp}}$ 测量值。要最小化的目标函数是：\n$$\n\\mathrm{SSR}(\\mathbf{p}) = \\sum_{i=1}^{N} \\left[ y(\\mathrm{pH}_i, c_i; \\mathbf{p}) - y_i^{\\mathrm{exp}} \\right]^2\n$$\n这个优化问题需要数值求解。我们将使用一个标准算法，例如 Levenberg-Marquardt 算法，它在 `scipy.optimize.least_squares` 库函数中已实现。初始猜测值 $\\mathbf{p}_0 = (0, 0, 0, 0)$ 是合适的，因为它对应于物理上合理的初始假设，即不存在 pK 偏移。\n\n一旦获得最优参数矢量 $\\mathbf{p}_{\\mathrm{fit}} = (a_0, a_1, b_0, b_1)$，最后的任务是使用拟合的参数计算在组分 $c=0.4$ 和 $c=0.6$ 时的有效解离常数：\n$$\n\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(0.4) = 4.8 + a_0 + a_1 (0.4 - 0.5) = 4.8 + a_0 - 0.1 a_1\n$$\n$$\n\\mathrm{p}K_{a,\\mathrm{acid}}^{\\mathrm{eff}}(0.6) = 4.8 + a_0 + a_1 (0.6 - 0.5) = 4.8 + a_0 + 0.1 a_1\n$$\n$$\n\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(0.4) = 9.2 + b_0 + b_1 (0.4 - 0.5) = 9.2 + b_0 - 0.1 b_1\n$$\n$$\n\\mathrm{p}K_{a,\\mathrm{base}}^{\\mathrm{eff}}(0.6) = 9.2 + b_0 + b_1 (0.6 - 0.5) = 9.2 + b_0 + 0.1 b_1\n$$\n这 $8$ 个值—— $4$ 个拟合参数和 $4$ 个计算出的有效 $\\mathrm{p}K_a$ 值——构成了所需的解。实现细节在随后的代码块中提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the PEM charge regulation problem by fitting model parameters\n    to experimental data and calculating derived quantities.\n    \"\"\"\n    # Define the intrinsic pKa constants.\n    PK_ACID_0 = 4.8\n    PK_BASE_0 = 9.2\n\n    # Experimental data provided in the problem statement.\n    data = {\n        0.3: {\n            \"pH\": [3.5, 4.5, 5.5, 7.0, 9.0, 10.5],\n            \"y\": [0.293954, 0.243904, -0.026039, -0.381346, -0.599579, -0.695311],\n        },\n        0.5: {\n            \"pH\": [3.5, 4.5, 5.5, 7.0, 9.0, 10.5],\n            \"y\": [0.493778, 0.444060, 0.221094, 0.004441, -0.306449, -0.490212],\n        },\n        0.7: {\n            \"pH\": [3.5, 4.5, 5.5, 7.0, 9.0, 10.5],\n            \"y\": [0.694636, 0.653782, 0.506077, 0.396387, 0.009938, -0.282843],\n        },\n    }\n\n    # Flatten the data for cooperative fitting across all compositions.\n    ph_all = []\n    c_all = []\n    y_exp_all = []\n\n    for c_val, measurements in data.items():\n        for i in range(len(measurements[\"pH\"])):\n            ph_all.append(measurements[\"pH\"][i])\n            c_all.append(c_val)\n            y_exp_all.append(measurements[\"y\"][i])\n\n    ph_all = np.array(ph_all)\n    c_all = np.array(c_all)\n    y_exp_all = np.array(y_exp_all)\n\n    def residuals(params, ph_data, c_data, y_data):\n        \"\"\"\n        Calculates the residuals between the model and experimental data.\n        params: a0, a1, b0, b1\n        \"\"\"\n        a0, a1, b0, b1 = params\n        \n        # Calculate effective pKa values based on the model.\n        pk_acid_eff = PK_ACID_0 + a0 + a1 * (c_data - 0.5)\n        pk_base_eff = PK_BASE_0 + b0 + b1 * (c_data - 0.5)\n\n        # Calculate degrees of ionization.\n        alpha_acid = 1.0 / (1.0 + 10**(pk_acid_eff - ph_data))\n        alpha_base = 1.0 / (1.0 + 10**(ph_data - pk_base_eff))\n\n        # Calculate the model prediction for net charge y.\n        y_model = c_data * alpha_base - (1.0 - c_data) * alpha_acid\n\n        return y_model - y_data\n\n    # Initial guess for the parameters [a0, a1, b0, b1].\n    initial_guess = [0.0, 0.0, 0.0, 0.0]\n\n    # Perform nonlinear least-squares fitting.\n    result = least_squares(\n        residuals,\n        initial_guess,\n        args=(ph_all, c_all, y_exp_all)\n    )\n\n    # Extract the fitted parameters.\n    a0_fit, a1_fit, b0_fit, b1_fit = result.x\n\n    # Calculate the effective pKa values at c=0.4 and c=0.6.\n    c_vals_to_calc = [0.4, 0.6]\n    \n    # pK_acid_eff(c) = pK_acid_0 + a0 + a1*(c - 0.5)\n    pk_acid_eff_04 = PK_ACID_0 + a0_fit + a1_fit * (c_vals_to_calc[0] - 0.5)\n    pk_acid_eff_06 = PK_ACID_0 + a0_fit + a1_fit * (c_vals_to_calc[1] - 0.5)\n\n    # pK_base_eff(c) = pK_base_0 + b0 + b1*(c - 0.5)\n    pk_base_eff_04 = PK_BASE_0 + b0_fit + b1_fit * (c_vals_to_calc[0] - 0.5)\n    pk_base_eff_06 = PK_BASE_0 + b0_fit + b1_fit * (c_vals_to_calc[1] - 0.5)\n\n    # Assemble the final list of results.\n    final_results = [\n        a0_fit, a1_fit, b0_fit, b1_fit,\n        pk_acid_eff_04, pk_acid_eff_06,\n        pk_base_eff_04, pk_base_eff_06\n    ]\n\n    # Format the results to 3 decimal places without spaces.\n    formatted_results = \",\".join(map(lambda x: f\"{x:.3f}\", final_results))\n    \n    # Print the final output in the required format.\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```", "id": "2922967"}]}