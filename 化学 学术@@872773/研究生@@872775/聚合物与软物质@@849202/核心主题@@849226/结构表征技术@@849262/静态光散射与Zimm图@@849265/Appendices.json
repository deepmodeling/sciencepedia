{"hands_on_practices": [{"introduction": "静态光散射 (SLS) 实验的原始输出是探测器在不同角度记录的光子计数值。为了从这些原始数据中提取有意义的物理信息，我们必须首先执行关键的数据归约步骤。这个过程包括将原始信号校正，减去溶剂散射、暗计数和杂散光等背景贡献，然后利用仪器校正常数将其转换为过剩瑞利比 $R_{\\text{ex}}(\\theta)$。本练习将指导您完成这一基本的数据处理流程，并实践不确定性传播，确保最终结果的科学严谨性 [@problem_id:2928743]。", "problem": "您的任务是构建一个程序，从第一性原理出发，实现静态光散射 (SLS) 测量中过剩瑞利比的构建，并传递相关的不确定度。目标是计算聚合物溶液的过剩瑞利比，其定义为在散射角 $\\theta$ 下，溶液的瑞利比与在相同光学几何条件下测量的纯溶剂的瑞利比之差。您的程序必须根据每次测量的暗计数和杂散光校正原始测量强度，并使用校准常数将校正后的计数率转换成瑞利比。您还必须在所有输入量均为统计独立和高斯分布的假设下，传递标准不确定度。\n\n使用以下基本定义作为起点：\n- 瑞利比 $R(\\theta)$ 是指在距离 $r$ 处，单位立体角内的散射强度，经入射强度归一化，在扣除背景后，它与仪器记录的计数率成正比。仪器校准将几何和通量因子合并为一个校准常数。\n- 过剩瑞利比定义为 $R_{\\text{ex}}(\\theta) = R_{\\text{solution}}(\\theta) - R_{\\text{solvent}}(\\theta)$。\n- 原始记录的计数率必须先根据在相同条件下测量的暗计数和杂散光贡献进行校正，然后再应用校准。\n- 对于独立变量 $\\{x_i\\}$，函数 $f(\\{x_i\\})$ 的一阶（线性）高斯不确定度传播公式为 $\\sigma_f^2 = \\sum_i \\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$。\n\n您的程序必须实现的输入和建模假设：\n- 对于在散射角 $\\theta$（角度以度为单位）下的每次测量，仪器为聚合物溶液和纯溶剂提供以下数据：\n  - 测量的计数率 $I_{\\mathrm{meas}}(\\theta)$（单位 $\\mathrm{cts/s}$）及其标准不确定度。\n  - 暗计数率 $D(\\theta)$（单位 $\\mathrm{cts/s}$）及其标准不确定度。\n  - 杂散光率 $S(\\theta)$（单位 $\\mathrm{cts/s}$）及其标准不确定度。\n- 校准常数 $C$ 通过 $R(\\theta) = C \\times I_{\\mathrm{net}}(\\theta)$ 将校正后的计数率（单位 $\\mathrm{cts/s}$）转换为瑞利比（单位 $\\mathrm{m^{-1}}$），其中净计数率为 $I_{\\mathrm{net}}(\\theta) = I_{\\mathrm{meas}}(\\theta) - D(\\theta) - S(\\theta)$。校准常数有其自身的标准不确定度。\n- 将所有报告的标准不确定度视为一西格玛值，并假设所有测量量之间统计独立。\n\n计算要求：\n- 通过减去相应的暗计数率和杂散光率，计算聚合物溶液和溶剂在每个 $\\theta$ 处的净计数率。\n- 使用校准常数 $C$ 将每个净计数率转换为瑞利比，然后作差，从而计算出过剩瑞利比 $R_{\\text{ex}}(\\theta)$。\n- 使用一阶不确定度传播，计算 $R_{\\text{ex}}(\\theta)$ 的标准不确定度。\n\n单位和报告：\n- 报告每个 $R_{\\text{ex}}(\\theta)$（单位 $\\mathrm{m^{-1}}$）及其相关的标准不确定度（单位 $\\mathrm{m^{-1}}$）。\n- 角度 $\\theta$ 以度为单位指定，在本次计算中无需转换。\n\n要实现的测试套件：\n提供一个程序，计算以下四种情况的结果。在每种情况下，所有计数率的单位均为 $\\mathrm{cts/s}$，角度单位为度，校准常数的单位为 $\\mathrm{m^{-1}}\\cdot(\\mathrm{cts/s})^{-1}$。\n\n- 情况 1 (理想情况, $\\theta = 90^\\circ$):\n  - 聚合物溶液: $I_{\\mathrm{meas}} = 15230$, $\\sigma_{I} = 50$; $D = 120$, $\\sigma_D = 10$; $S = 30$, $\\sigma_S = 5$。\n  - 纯溶剂: $I_{\\mathrm{meas}} = 8120$, $\\sigma_{I} = 40$; $D = 118$, $\\sigma_D = 10$; $S = 32$, $\\sigma_S = 5$。\n  - 校准: $C = 2.1\\times 10^{-7}$, $\\sigma_C = 2.1\\times 10^{-9}$。\n\n- 情况 2 (近似抵消, $\\theta = 60^\\circ$):\n  - 聚合物溶液: $I_{\\mathrm{meas}} = 10050$, $\\sigma_{I} = 60$; $D = 130$, $\\sigma_D = 8$; $S = 45$, $\\sigma_S = 6$。\n  - 纯溶剂: $I_{\\mathrm{meas}} = 10020$, $\\sigma_{I} = 60$; $D = 128$, $\\sigma_D = 8$; $S = 46$, $\\sigma_S = 6$。\n  - 校准: $C = 2.0\\times 10^{-7}$, $\\sigma_C = 3.0\\times 10^{-9}$。\n\n- 情况 3 (背景漂移, $\\theta = 30^\\circ$):\n  - 聚合物溶液: $I_{\\mathrm{meas}} = 4500$, $\\sigma_{I} = 30$; $D = 200$, $\\sigma_D = 15$; $S = 100$, $\\sigma_S = 12$。\n  - 纯溶剂: $I_{\\mathrm{meas}} = 4200$, $\\sigma_{I} = 30$; $D = 150$, $\\sigma_D = 15$; $S = 80$, $\\sigma_S = 12$。\n  - 校准: $C = 1.8\\times 10^{-7}$, $\\sigma_C = 2.0\\times 10^{-9}$。\n\n- 情况 4 (低计数，可能出现负过剩值, $\\theta = 120^\\circ$):\n  - 聚合物溶液: $I_{\\mathrm{meas}} = 500$, $\\sigma_{I} = 20$; $D = 50$, $\\sigma_D = 5$; $S = 30$, $\\sigma_S = 5$。\n  - 纯溶剂: $I_{\\mathrm{meas}} = 520$, $\\sigma_{I} = 20$; $D = 50$, $\\sigma_D = 5$; $S = 30$, $\\sigma_S = 5$。\n  - 校准: $C = 2.2\\times 10^{-7}$, $\\sigma_C = 2.2\\times 10^{-9}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表，列表的每个元素是对应情况的结果列表，每个内部列表包含两个浮点数：$\\left[R_{\\text{ex}}(\\theta), \\sigma_{R_{\\text{ex}}}(\\theta)\\right]$，顺序与上述情况相同。\n- 例如，一个有效的输出格式如下：$\\left[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]\\right]$ 其中每个 $x_i$ 和 $y_i$ 是单位为 $\\mathrm{m^{-1}}$ 的浮点数。", "solution": "所提出的问题是实验数据分析中的一个标准练习，具体涉及静态光散射实验原始数据的处理和相关不确定度的传播。该问题定义明确、科学上合理且内部一致。它要求将误差分析的基本原理应用于特定的物理测量。我们将继续推导必要的公式并加以实现。\n\n设在给定散射角 $\\theta$ 下，聚合物溶液的测量量用下标 `sol` 表示，纯溶剂的测量量用下标 `sv` 表示。提供的输入如下：\n- 测量计数率：$I_{\\text{meas,sol}}$ 和 $I_{\\text{meas,sv}}$\n- 暗计数率：$D_{\\text{sol}}$ 和 $D_{\\text{sv}}$\n- 杂散光率：$S_{\\text{sol}}$ 和 $S_{\\text{sv}}$\n- 校准常数：$C$\n- 它们对应的标准不确定度：$\\sigma_{I,\\text{sol}}$, $\\sigma_{I,\\text{sv}}$, $\\sigma_{D,\\text{sol}}$, $\\sigma_{D,\\text{sv}}$, $\\sigma_{S,\\text{sol}}$, $\\sigma_{S,\\text{sv}}$ 和 $\\sigma_C$。\n\n假设所有这 13 个输入量都是统计独立的。\n第一步是计算溶液和溶剂的净计数率 $I_{\\text{net}}(\\theta)$。净计数率是测量计数率经过背景贡献校正后的值。\n对于聚合物溶液：\n$$I_{\\text{net,sol}} = I_{\\text{meas,sol}} - D_{\\text{sol}} - S_{\\text{sol}}$$\n对于纯溶剂：\n$$I_{\\text{net,sv}} = I_{\\text{meas,sv}} - D_{\\text{sv}} - S_{\\text{sv}}$$\n\n过剩瑞利比 $R_{\\text{ex}}(\\theta)$ 定义为溶液的瑞利比 $R_{\\text{sol}}(\\theta)$ 与溶剂的瑞利比 $R_{\\text{sv}}(\\theta)$ 之差。每个组分的瑞利比是通过将其净计数率乘以校准常数 $C$ 得到的。\n$$R_{\\text{sol}}(\\theta) = C \\cdot I_{\\text{net,sol}}$$\n$$R_{\\text{sv}}(\\theta) = C \\cdot I_{\\text{net,sv}}$$\n因此，过剩瑞利比为：\n$$R_{\\text{ex}}(\\theta) = R_{\\text{sol}}(\\theta) - R_{\\text{sv}}(\\theta) = C \\cdot I_{\\text{net,sol}} - C \\cdot I_{\\text{net,sv}}$$\n简化后可得：\n$$R_{\\text{ex}}(\\theta) = C \\cdot (I_{\\text{net,sol}} - I_{\\text{net,sv}})$$\n代入净计数率的表达式，我们得到以直接测量量表示的 $R_{\\text{ex}}(\\theta)$ 的最终公式：\n$$R_{\\text{ex}}(\\theta) = C \\cdot \\left( (I_{\\text{meas,sol}} - D_{\\text{sol}} - S_{\\text{sol}}) - (I_{\\text{meas,sv}} - D_{\\text{sv}} - S_{\\text{sv}}) \\right)$$\n\n接下来，我们必须推导 $R_{\\text{ex}}(\\theta)$ 的标准不确定度公式，记为 $\\sigma_{R_{\\text{ex}}}$。我们使用对于独立变量 $\\{x_i\\}$ 的函数 $f$ 的一阶高斯误差传播公式：\n$$\\sigma_f^2 = \\sum_i \\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$$\n在我们的情况下，函数是 $f = R_{\\text{ex}}(\\theta)$，独立变量集合是 $\\{x_i\\} = \\{C, I_{\\text{meas,sol}}, D_{\\text{sol}}, S_{\\text{sol}}, I_{\\text{meas,sv}}, D_{\\text{sv}}, S_{\\text{sv}}\\}$。\n\n我们必须计算 $R_{\\text{ex}}(\\theta)$ 对每个变量的偏导数。\n1. 对 $C$ 的导数：\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial C} = (I_{\\text{meas,sol}} - D_{\\text{sol}} - S_{\\text{sol}}) - (I_{\\text{meas,sv}} - D_{\\text{sv}} - S_{\\text{sv}}) = I_{\\text{net,sol}} - I_{\\text{net,sv}}$$\n2. 对溶液测量量的导数：\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial I_{\\text{meas,sol}}} = C$$\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial D_{\\text{sol}}} = -C$$\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial S_{\\text{sol}}} = -C$$\n3. 对溶剂测量量的导数：\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial I_{\\text{meas,sv}}} = -C$$\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial D_{\\text{sv}}} = C$$\n$$\\frac{\\partial R_{\\text{ex}}}{\\partial S_{\\text{sv}}} = C$$\n\n现在，我们将这些导数代入方差公式：\n$$\\sigma_{R_{\\text{ex}}}^2 = \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial C}\\right)^2 \\sigma_C^2 + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial I_{\\text{meas,sol}}}\\right)^2 \\sigma_{I,\\text{sol}}^2 + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial D_{\\text{sol}}}\\right)^2 \\sigma_{D,\\text{sol}}^2 + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial S_{\\text{sol}}}\\right)^2 \\sigma_{S,\\text{sol}}^2 + \\ldots$$\n$$\\ldots + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial I_{\\text{meas,sv}}}\\right)^2 \\sigma_{I,\\text{sv}}^2 + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial D_{\\text{sv}}}\\right)^2 \\sigma_{D,\\text{sv}}^2 + \\left(\\frac{\\partial R_{\\text{ex}}}{\\partial S_{\\text{sv}}}\\right)^2 \\sigma_{S,\\text{sv}}^2$$\n代入偏导数的表达式：\n$$\\sigma_{R_{\\text{ex}}}^2 = (I_{\\text{net,sol}} - I_{\\text{net,sv}})^2 \\sigma_C^2 + (C)^2 \\sigma_{I,\\text{sol}}^2 + (-C)^2 \\sigma_{D,\\text{sol}}^2 + (-C)^2 \\sigma_{S,\\text{sol}}^2 + (-C)^2 \\sigma_{I,\\text{sv}}^2 + (C)^2 \\sigma_{D,\\text{sv}}^2 + (C)^2 \\sigma_{S,\\text{sv}}^2$$\n提出因子 $C^2$：\n$$\\sigma_{R_{\\text{ex}}}^2 = (I_{\\text{net,sol}} - I_{\\text{net,sv}})^2 \\sigma_C^2 + C^2 \\left( \\sigma_{I,\\text{sol}}^2 + \\sigma_{D,\\text{sol}}^2 + \\sigma_{S,\\text{sol}}^2 \\right) + C^2 \\left( \\sigma_{I,\\text{sv}}^2 + \\sigma_{D,\\text{sv}}^2 + \\sigma_{S,\\text{sv}}^2 \\right)$$\n括号中的项是净计数率的方差。令 $\\sigma_{I_{\\text{net,sol}}}^2 = \\sigma_{I,\\text{sol}}^2 + \\sigma_{D,\\text{sol}}^2 + \\sigma_{S,\\text{sol}}^2$ 且 $\\sigma_{I_{\\text{net,sv}}}^2 = \\sigma_{I,\\text{sv}}^2 + \\sigma_{D,\\text{sv}}^2 + \\sigma_{S,\\text{sv}}^2$，因为每个净计数率的组成部分是独立的。过剩瑞利比的方差表达式简化为：\n$$\\sigma_{R_{\\text{ex}}}^2 = (I_{\\text{net,sol}} - I_{\\text{net,sv}})^2 \\sigma_C^2 + C^2 \\left( \\sigma_{I_{\\text{net,sol}}}^2 + \\sigma_{I_{\\text{net,sv}}}^2 \\right)$$\n标准不确定度是该方差的平方根：\n$$\\sigma_{R_{\\text{ex}}} = \\sqrt{ (I_{\\text{net,sol}} - I_{\\text{net,sv}})^2 \\sigma_C^2 + C^2 \\left( \\sigma_{I_{\\text{net,sol}}}^2 + \\sigma_{I_{\\text{net,sv}}}^2 \\right) }$$\n这就是需要实现的最终公式。它正确地考虑了校准常数 $C$ 的不确定度会在计算出的溶液和溶剂的瑞利比中引入一个相关的误差分量，而溶液和溶剂的计数统计是独立的这一事实。\n\n将要构建的程序会直接实现这些推导出的公式。对于每个测试用例，它将：\n1.  计算 $I_{\\text{net,sol}}$ 和 $I_{\\text{net,sv}}$。\n2.  使用净计数率的差值计算 $R_{\\text{ex}}(\\theta)$。\n3.  计算方差 $\\sigma_{I_{\\text{net,sol}}}^2$ 和 $\\sigma_{I_{\\text{net,sv}}}^2$。\n4.  计算最终方差 $\\sigma_{R_{\\text{ex}}}^2$ 并取其平方根得到 $\\sigma_{R_{\\text{ex}}}$。\n5.  报告每种情况下的配对值 $[R_{\\text{ex}}, \\sigma_{R_{\\text{ex}}}]$。\n该实现将采用过程化方法，将这些步骤系统地应用于问题中提供的每个数据集。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the excess Rayleigh ratio and its uncertainty for a series of\n    Static Light Scattering (SLS) measurement cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, theta = 90 deg)\n        {\n            \"sol\": {\"I_meas\": 15230, \"s_I\": 50, \"D\": 120, \"s_D\": 10, \"S\": 30, \"s_S\": 5},\n            \"sv\": {\"I_meas\": 8120, \"s_I\": 40, \"D\": 118, \"s_D\": 10, \"S\": 32, \"s_S\": 5},\n            \"cal\": {\"C\": 2.1e-7, \"s_C\": 2.1e-9},\n        },\n        # Case 2 (near cancellation, theta = 60 deg)\n        {\n            \"sol\": {\"I_meas\": 10050, \"s_I\": 60, \"D\": 130, \"s_D\": 8, \"S\": 45, \"s_S\": 6},\n            \"sv\": {\"I_meas\": 10020, \"s_I\": 60, \"D\": 128, \"s_D\": 8, \"S\": 46, \"s_S\": 6},\n            \"cal\": {\"C\": 2.0e-7, \"s_C\": 3.0e-9},\n        },\n        # Case 3 (drifted backgrounds, theta = 30 deg)\n        {\n            \"sol\": {\"I_meas\": 4500, \"s_I\": 30, \"D\": 200, \"s_D\": 15, \"S\": 100, \"s_S\": 12},\n            \"sv\": {\"I_meas\": 4200, \"s_I\": 30, \"D\": 150, \"s_D\": 15, \"S\": 80, \"s_S\": 12},\n            \"cal\": {\"C\": 1.8e-7, \"s_C\": 2.0e-9},\n        },\n        # Case 4 (low counts, possible negative excess, theta = 120 deg)\n        {\n            \"sol\": {\"I_meas\": 500, \"s_I\": 20, \"D\": 50, \"s_D\": 5, \"S\": 30, \"s_S\": 5},\n            \"sv\": {\"I_meas\": 520, \"s_I\": 20, \"D\": 50, \"s_D\": 5, \"S\": 30, \"s_S\": 5},\n            \"cal\": {\"C\": 2.2e-7, \"s_C\": 2.2e-9},\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract data for solution (sol), solvent (sv), and calibration (cal)\n        sol_data = case[\"sol\"]\n        sv_data = case[\"sv\"]\n        cal_data = case[\"cal\"]\n\n        # Step 1: Compute net count rates for solution and solvent\n        I_net_sol = sol_data[\"I_meas\"] - sol_data[\"D\"] - sol_data[\"S\"]\n        I_net_sv = sv_data[\"I_meas\"] - sv_data[\"D\"] - sv_data[\"S\"]\n\n        # Step 2: Compute excess Rayleigh ratio, R_ex\n        C = cal_data[\"C\"]\n        delta_I_net = I_net_sol - I_net_sv\n        R_ex = C * delta_I_net\n\n        # Step 3: Compute variances of the net count rates\n        var_I_net_sol = sol_data[\"s_I\"]**2 + sol_data[\"s_D\"]**2 + sol_data[\"s_S\"]**2\n        var_I_net_sv = sv_data[\"s_I\"]**2 + sv_data[\"s_D\"]**2 + sv_data[\"s_S\"]**2\n\n        # Step 4: Compute variance of the excess Rayleigh ratio\n        # var(R_ex) = (I_net_sol - I_net_sv)^2 * var(C) + C^2 * (var(I_net_sol) + var(I_net_sv))\n        s_C = cal_data[\"s_C\"]\n        var_R_ex = (delta_I_net**2 * s_C**2) + (C**2 * (var_I_net_sol + var_I_net_sv))\n        \n        # Final uncertainty is the square root of the variance\n        s_R_ex = np.sqrt(var_R_ex)\n\n        results.append([R_ex, s_R_ex])\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2928743"}, {"introduction": "在获得一系列不同角度和浓度下的过剩瑞利比数据后，下一步便是从中提取聚合物的核心物理参数。Zimm 图及其变种 Berry 图是实现这一目标的核心分析工具，它通过巧妙的线性化和双重外推，使我们能够同时得到零角度和零浓度下的散射信息。通过这种方法，我们可以精确地确定聚合物的重均分子量 ($M_w$) 和均方根回旋半径 ($R_g$)。本练习将让您亲手构建这些图，并学习如何利用定量标准（如决定系数 $R^2$）来评估和选择更可靠的数据分析模型 [@problem_id:2928740]。", "problem": "提供给您用于稀释聚合物溶液的合成静态光散射数据，旨在练习 Zimm 图和 Berry 图的构建。目标是使用与吉尼尔（Guinier）区单次散射一致的一阶低角度和低浓度展开，从每个数据集中提取重均分子量 $M_w$ 和回转半径 $R_g$，然后通过定量标准来决定哪种线性化方法（Zimm 或 Berry）更可靠。\n\n使用的基本原理：\n- 在单次散射条件下，稀释聚合物溶液的静态光散射中，角度依赖性由粒子形状因子决定，该因子允许在小 $q$ 范围内（吉尼尔区）进行展开。对于热力学上的稀释溶液，溶液浓度的依赖性通过维里展开引入。这些事实证明了对 $q^2$ 和 $c$ 进行最低阶线性化是合理的。\n- 散射波矢的大小为 $q = \\dfrac{4\\pi n}{\\lambda}\\sin(\\theta/2)$，其中 $n$ 是溶剂的折射率，$\\lambda$ 是入射光的真空波长，$\\theta$ 是散射角。使用 $\\lambda = 632.8\\,\\mathrm{nm}$ 和 $n=1.333$。在计算正弦函数时将角度转换为弧度，但输入的角度以度为单位给出。\n- 用于 Zimm 分析的实验归约变量是 $Y = \\dfrac{K c}{R(\\theta)}$，其中 $R(\\theta)$ 是瑞利比，$K$ 是一个光学常数。在本问题中，数据集已提供 $Y$ 值（因此您不需要单独的 $K$ 或 $R(\\theta)$）。\n- Zimm 图线性化使用 $Y$，Berry 图线性化使用 $\\sqrt{Y}$，每种方法都将 $q^2$ 和 $c$ 处理到一阶，并忽略交叉项和高阶项。\n\n对于下面的每个数据集：\n1. 使用给定的 $n$ 和 $\\lambda$ 计算每个给定角度的 $q$（角度以度为单位；三角函数必须使用弧度）。\n2. 将配对的测量值 $\\{(q^2,c)\\}$ 与其对应的所提供的 $Y$ 值组合起来。\n3. 对变量 $(q^2,c)$ 中的平面进行两次独立的普通最小二乘法拟合：\n   - Zimm：将 $Y$ 拟合为关于 $1$、$q^2$ 和 $c$ 的一阶线性函数，忽略交叉项和高阶项。\n   - Berry：将 $\\sqrt{Y}$ 拟合为关于 $1$、$q^2$ 和 $c$ 的一阶线性函数，忽略交叉项和高阶项。\n4. 根据每次拟合，使用高斯线圈的小 $q$ 形状因子展开和稀溶液维里展开所隐含的前导阶关系，推断出 $M_w$ 和 $R_g$。将 $M_w$ 以 $\\mathrm{g/mol}$ 表示，$R_g$ 以 $\\mathrm{nm}$ 表示。\n5. 对于每种线性化方法，计算决定系数\n   $$R^2 = 1 - \\dfrac{\\sum_i \\left(y_i - \\hat{y}_i\\right)^2}{\\sum_i \\left(y_i - \\bar{y}\\right)^2},$$\n   其中 $y_i$ 和 $\\hat{y}_i$ 分别是观测响应和拟合响应，$\\bar{y}$ 是该线性化中使用的响应的样本均值。\n6. 可靠性选择标准：\n   - 优先选择 $R^2$ 较大的线性化方法。\n   - 如果 $\\left|R^2_{\\mathrm{Berry}} - R^2_{\\mathrm{Zimm}}\\right|  \\delta$（其中 $\\delta = 0.005$），则选择通过普通最小二乘协方差和误差传递的 delta 方法估计出的 $M_w$ 相对标准误差较小的方法。\n7. 对于每个数据集，输出一个三元组 $[m, M_w, R_g]$，其中 $m$ 对于 Zimm 是 $0$，对于 Berry 是 $1$，$M_w$ 的单位是 $\\mathrm{g/mol}$，$R_g$ 的单位是 $\\mathrm{nm}$。将 $M_w$ 和 $R_g$ 都四舍五入到三位有效数字。\n\n角度以度为单位。三角函数必须使用弧度。\n\n测试套件数据集：\n- 通用光学参数：$\\lambda = 632.8\\,\\mathrm{nm}$，$n=1.333$。\n- 浓度 $c$（单位 $\\mathrm{g/mL}$）：所有数据集均为 $[0.002, 0.004, 0.006]$。\n- 角度 $\\theta$（单位 度）：所有数据集均为 $[30, 60, 90, 120]$。\n- 响应 $Y = K c / R(\\theta)$ 值在下面以 $3\\times 4$ 数组的形式给出，单位与 $Y$ 一致；每行对应于所列顺序的一个浓度，每列对应于所列顺序的一个角度。\n\n数据集 A（中等角度依赖性，轻度噪声）：\n- $c = [0.002, 0.004, 0.006]$,\n- $\\theta = [30, 60, 90, 120]$,\n- $Y =\n\\begin{bmatrix}\n1.125\\times 10^{-6}  1.160\\times 10^{-6}  1.190\\times 10^{-6}  1.200\\times 10^{-6} \\\\\n1.330\\times 10^{-6}  1.368\\times 10^{-6}  1.402\\times 10^{-6}  1.412\\times 10^{-6} \\\\\n1.536\\times 10^{-6}  1.575\\times 10^{-6}  1.608\\times 10^{-6}  1.620\\times 10^{-6}\n\\end{bmatrix}.$\n\n数据集 B（较高角度下有更强的曲率）：\n- $c = [0.002, 0.004, 0.006]$,\n- $\\theta = [30, 60, 90, 120]$,\n- $Y =\n\\begin{bmatrix}\n9.600\\times 10^{-7}  1.010\\times 10^{-6}  1.090\\times 10^{-6}  1.240\\times 10^{-6} \\\\\n1.120\\times 10^{-6}  1.170\\times 10^{-6}  1.250\\times 10^{-6}  1.400\\times 10^{-6} \\\\\n1.280\\times 10^{-6}  1.330\\times 10^{-6}  1.410\\times 10^{-6}  1.560\\times 10^{-6}\n\\end{bmatrix}.$\n\n数据集 C（几乎与角度无关，有效 $R_g$ 小）：\n- $c = [0.002, 0.004, 0.006]$,\n- $\\theta = [30, 60, 90, 120]$,\n- $Y =\n\\begin{bmatrix}\n1.710\\times 10^{-6}  1.712\\times 10^{-6}  1.715\\times 10^{-6}  1.716\\times 10^{-6} \\\\\n1.810\\times 10^{-6}  1.812\\times 10^{-6}  1.815\\times 10^{-6}  1.816\\times 10^{-6} \\\\\n1.910\\times 10^{-6}  1.912\\times 10^{-6}  1.915\\times 10^{-6}  1.916\\times 10^{-6}\n\\end{bmatrix}.$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表，该列表有三个条目，每个数据集一个，每个条目都是如上定义的列表 $[m, M_w, R_g]$。例如：$[[m_1,M_{w,1},R_{g,1}],[m_2,M_{w,2},R_{g,2}],[m_3,M_{w,3},R_{g,3}]]$。\n- 使用单位为 $\\mathrm{g/mol}$ 的 $M_w$ 和单位为 $\\mathrm{nm}$ 的 $R_g$，两者均四舍五入到三位有效数字。", "solution": "当前问题要求分析用于稀释聚合物溶液的合成静态光散射（SLS）数据。目标是使用两种不同的线性化方法——Zimm 图和 Berry 图——来确定重均分子量 $M_w$ 和回转半径 $R_g$。然后将使用一个定量标准为每个数据集选择更可靠的方法。整个分析基于低聚合物浓度和小散射角极限下的光散射基本理论。\n\n来自非相互作用、光学各向同性大分子的稀溶液的静态光散射的核心方程是：\n$$ \\frac{K c}{R(\\theta, c)} = \\frac{1}{M_w P(q)} + 2 A_2 c $$\n其中 $c$ 是聚合物的质量浓度，$R(\\theta, c)$ 是在散射角 $\\theta$ 处的过量瑞利比，$K$ 是一个依赖于溶剂折射率、入射波长和聚合物折射率增量的光学常数，$M_w$ 是重均分子量，$A_2$ 是说明聚合物-溶剂相互作用的第二维里系数，$P(q)$ 是粒子形状因子。形状因子描述了由粒子内干涉引起的散射强度的角度依赖性。它取决于散射波矢的大小 $q$，由下式给出：\n$$ q = \\frac{4\\pi n}{\\lambda}\\sin(\\theta/2) $$\n其中 $n$ 是溶剂的折射率，$\\lambda$ 是光的真空波长。\n\n对于小 $q$ 值，对应于小散射角或大颗粒，粒子形状因子的倒数可以通过吉尼尔（Guinier）展开来近似：\n$$ P(q)^{-1} \\approx 1 + \\frac{q^2 R_g^2}{3} $$\n这里，$R_g$ 是回转半径，是衡量聚合物线圈空间范围的指标。\n\n将此展开式代入主散射方程，得到著名的 Zimm 方程。问题提供了归约量 $Y = K c / R(\\theta, c)$，因此工作方程为：\n$$ Y(q, c) \\approx \\frac{1}{M_w} \\left(1 + \\frac{q^2 R_g^2}{3}\\right) + 2 A_2 c $$\n重新整理该式，为 Zimm 图线性化提供了基础，这是一个在 $q^2$ 和 $c$ 中线性的平面模型：\n$$ Y(q^2, c) = \\frac{1}{M_w} + \\left(\\frac{R_g^2}{3 M_w}\\right) q^2 + (2 A_2) c $$\n该方程的形式为 $z = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2$，其中响应是 $z = Y$，自变量是 $x_1 = q^2$ 和 $x_2 = c$，系数为：\n$$ \\beta_0 = \\frac{1}{M_w}, \\quad \\beta_1 = \\frac{R_g^2}{3 M_w}, \\quad \\beta_2 = 2 A_2 $$\n通过对实验数据 $\\{Y_i\\}$ 与对应的 $\\{q_i^2, c_i\\}$ 值进行多元线性回归，我们得到系数 $\\beta_0$、$\\beta_1$ 和 $\\beta_2$ 的估计值。由此，可以提取出物理参数 $M_w$ 和 $R_g$：\n$$ M_w = \\frac{1}{\\beta_0}, \\quad R_g = \\sqrt{\\frac{3 \\beta_1}{\\beta_0}} $$\n\nBerry 图提供了另一种线性化方法。它是通过对 Zimm 方程取平方根并应用泰勒展开得到的，在某些情况下，这可以将线性范围扩展到更高的 $q R_g$。得到的 Berry 方程是：\n$$ \\sqrt{Y(q^2, c)} \\approx \\frac{1}{\\sqrt{M_w}} + \\left(\\frac{R_g^2}{6 \\sqrt{M_w}}\\right) q^2 + (A_2 \\sqrt{M_w}) c $$\n这也是一个平面模型，$z = \\gamma_0 + \\gamma_1 x_1 + \\gamma_2 x_2$，其中响应现在是 $z = \\sqrt{Y}$，系数为：\n$$ \\gamma_0 = \\frac{1}{\\sqrt{M_w}}, \\quad \\gamma_1 = \\frac{R_g^2}{6 \\sqrt{M_w}}, \\quad \\gamma_2 = A_2 \\sqrt{M_w} $$\n对 $\\{\\sqrt{Y_i}\\}$ 与 $\\{q_i^2, c_i\\}$ 进行多元线性回归，得到系数 $\\gamma_0$、$\\gamma_1$ 和 $\\gamma_2$。然后可以找到物理参数：\n$$ M_w = \\frac{1}{\\gamma_0^2}, \\quad R_g = \\sqrt{\\frac{6 \\gamma_1}{\\gamma_0}} $$\n\n对于每个数据集，我们将使用普通最小二乘法（OLS）进行两种回归。模型 $\\mathbf{z} = X \\boldsymbol{\\beta}$ 中系数向量 $\\boldsymbol{\\beta}$ 的 OLS 解由 $\\hat{\\boldsymbol{\\beta}} = (X^T X)^{-1} X^T \\mathbf{z}$ 给出，其中 $X$ 是设计矩阵，其列分别对应常数项（$1$）、$q^2$ 和 $c$，而 $\\mathbf{z}$ 是观测响应（$Y$ 或 $\\sqrt{Y}$）的向量。\n\n为了决定哪种线性化更可靠，我们首先为每次拟合计算决定系数 $R^2$：\n$$ R^2 = 1 - \\frac{\\sum_i (z_i - \\hat{z}_i)^2}{\\sum_i (z_i - \\bar{z})^2} $$\n其中 $z_i$ 是观测到的响应，$\\hat{z}_i$ 是模型的拟合值，$\\bar{z}$ 是观测响应的平均值。$R^2$ 的值越接近 $1$ 表示拟合效果越好。$R^2$ 较高的方法更优。\n\n如果 $R^2$ 值的差异很小，特别是 $|R^2_{\\mathrm{Berry}} - R^2_{\\mathrm{Zimm}}|  \\delta$（其中 $\\delta = 0.005$），则启用决胜规则。我们必须选择对 $M_w$ 产生较小相对标准误差（RSE）的方法。估计参数 $\\hat{\\boldsymbol{\\beta}}$ 的方差由协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\hat{\\sigma}^2 (X^T X)^{-1}$ 给出，其中 $\\hat{\\sigma}^2 = \\frac{1}{N-p} \\sum_i (z_i - \\hat{z}_i)^2$ 是残差的估计方差，其中 $N$ 是数据点数，$p$ 是参数数量。\n\n我们使用 delta 方法将误差从拟合系数传播到 $M_w$。对于 Zimm 拟合，$M_w = 1/\\beta_0$。方差为 $\\mathrm{Var}(M_w) \\approx (\\frac{\\partial M_w}{\\partial \\beta_0})^2 \\mathrm{Var}(\\hat{\\beta}_0) = (\\frac{-1}{\\beta_0^2})^2 \\mathrm{Var}(\\hat{\\beta}_0)$。RSE 为：\n$$ \\mathrm{RSE}(M_w)_{\\mathrm{Zimm}} = \\frac{\\mathrm{SE}(M_w)}{M_w} = \\frac{\\sqrt{\\mathrm{Var}(M_w)}}{M_w} = \\frac{(1/\\beta_0^2)\\sqrt{\\mathrm{Var}(\\hat{\\beta}_0)}}{1/\\beta_0} = \\frac{\\sqrt{\\mathrm{Var}(\\hat{\\beta}_0)}}{|\\beta_0|} $$\n对于 Berry 拟合，$M_w = 1/\\gamma_0^2$。方差为 $\\mathrm{Var}(M_w) \\approx (\\frac{\\partial M_w}{\\partial \\gamma_0})^2 \\mathrm{Var}(\\hat{\\gamma}_0) = (\\frac{-2}{\\gamma_0^3})^2 \\mathrm{Var}(\\hat{\\gamma}_0)$。RSE 为：\n$$ \\mathrm{RSE}(M_w)_{\\mathrm{Berry}} = \\frac{\\mathrm{SE}(M_w)}{M_w} = \\frac{(2/|\\gamma_0|^3)\\sqrt{\\mathrm{Var}(\\hat{\\gamma}_0)}}{1/\\gamma_0^2} = \\frac{2\\sqrt{\\mathrm{Var}(\\hat{\\gamma}_0)}}{|\\gamma_0|} $$\n在这种情况下，产生较低 $M_w$ RSE 的方法被认为是更可靠的。\n\n每个数据集的步骤如下：\n$1$. 使用 $\\lambda = 632.8\\,\\mathrm{nm}$ 和 $n=1.333$ 计算给定角度 $\\theta = [30, 60, 90, 120]^\\circ$ 的 $q^2$。\n$2$. 根据 $3 \\times 4 = 12$ 对 $(q^2, c)$ 值构建设计矩阵 $X$。\n$3$. 对 Zimm（$Y$ 响应）和 Berry（$\\sqrt{Y}$ 响应）模型进行 OLS 拟合。\n$4$. 从每个模型的回归系数中提取 $M_w$ 和 $R_g$。\n$5$. 计算 $R^2$ 以及在必要时计算两个模型的 $M_w$ 的 RSE。\n$6$. 应用选择标准来选择更好的方法（Zimm 为 $m=0$，Berry 为 $m=1$）。\n$7$. 报告所选方法及其对应的 $M_w$ 和 $R_g$ 值，四舍五入到三位有效数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: scipy is permitted but not strictly necessary for this implementation.\n# import scipy.linalg\n\ndef solve():\n    \"\"\"\n    Main function to process all datasets and print the final result.\n    \"\"\"\n\n    def round_to_significant_figures(value, sig_figs):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if value == 0:\n            return 0.0\n        return round(value, sig_figs - int(np.floor(np.log10(abs(value)))) - 1)\n\n    def analyze_sls_data(Y_data, c_vals, theta_vals, lambda_vac, n, delta):\n        \"\"\"\n        Analyzes a single SLS dataset using Zimm and Berry formalisms.\n        \"\"\"\n        # 1. Prepare data: calculate q^2 and construct design matrix\n        theta_rad = np.deg2rad(theta_vals)\n        q = (4 * np.pi * n / lambda_vac) * np.sin(theta_rad / 2)\n        q2_vals = q**2\n\n        num_c = len(c_vals)\n        num_theta = len(theta_vals)\n        num_points = num_c * num_theta\n        \n        # Design matrix X and response vectors z\n        X = np.zeros((num_points, 3))\n        Y_flat = Y_data.flatten()\n        \n        idx = 0\n        for i in range(num_c):\n            for j in range(num_theta):\n                X[idx, :] = [1, q2_vals[j], c_vals[i]]\n                idx += 1\n\n        # --- 2. Zimm Analysis ---\n        z_zimm = Y_flat\n        \n        # OLS fit: X * beta = z_zimm\n        beta, res_zimm, _, _ = np.linalg.lstsq(X, z_zimm, rcond=None)\n        beta_0, beta_1, _ = beta\n        \n        # Extract physical parameters\n        # Add small epsilon to prevent division by zero in pathological cases\n        epsilon = 1e-20\n        Mw_zimm = 1.0 / (beta_0 + epsilon)\n        # Check for non-physical result (negative slope beta_1)\n        Rg_zimm = np.sqrt(3 * beta_1 / (beta_0 + epsilon)) if beta_1 > 0 and beta_0 > 0 else 0.0\n\n        # Calculate R^2\n        z_zimm_pred = X @ beta\n        ss_res_zimm = np.sum((z_zimm - z_zimm_pred)**2)\n        ss_tot_zimm = np.sum((z_zimm - np.mean(z_zimm))**2)\n        R2_zimm = 1.0 - ss_res_zimm / (ss_tot_zimm + epsilon)\n\n        # Calculate RSE of Mw\n        p = X.shape[1] # Number of parameters (3)\n        sigma2_hat_zimm = res_zimm[0] / (num_points - p)\n        cov_beta = sigma2_hat_zimm * np.linalg.inv(X.T @ X)\n        var_beta_0 = cov_beta[0, 0]\n        rse_Mw_zimm = np.sqrt(var_beta_0) / np.abs(beta_0 + epsilon)\n\n        # --- 3. Berry Analysis ---\n        z_berry = np.sqrt(Y_flat)\n\n        # OLS fit: X * gamma = z_berry\n        gamma, res_berry, _, _ = np.linalg.lstsq(X, z_berry, rcond=None)\n        gamma_0, gamma_1, _ = gamma\n\n        # Extract physical parameters\n        Mw_berry = 1.0 / (gamma_0**2 + epsilon)\n        # Check for non-physical result\n        Rg_berry = np.sqrt(6 * gamma_1 / (gamma_0 + epsilon)) if gamma_1 > 0 and gamma_0 > 0 else 0.0\n\n        # Calculate R^2\n        z_berry_pred = X @ gamma\n        ss_res_berry = np.sum((z_berry - z_berry_pred)**2)\n        ss_tot_berry = np.sum((z_berry - np.mean(z_berry))**2)\n        R2_berry = 1.0 - ss_res_berry / (ss_tot_berry + epsilon)\n\n        # Calculate RSE of Mw\n        sigma2_hat_berry = res_berry[0] / (num_points - p)\n        cov_gamma = sigma2_hat_berry * np.linalg.inv(X.T @ X)\n        var_gamma_0 = cov_gamma[0, 0]\n        rse_Mw_berry = 2 * np.sqrt(var_gamma_0) / np.abs(gamma_0 + epsilon)\n\n        # --- 4. Selection Criterion ---\n        if np.abs(R2_berry - R2_zimm)  delta:\n            # Tie-breaker: smaller RSE of Mw\n            if rse_Mw_berry  rse_Mw_zimm:\n                m, Mw, Rg = 1, Mw_berry, Rg_berry\n            else:\n                m, Mw, Rg = 0, Mw_zimm, Rg_zimm\n        elif R2_berry > R2_zimm:\n             m, Mw, Rg = 1, Mw_berry, Rg_berry\n        else: # R2_zimm > R2_berry\n             m, Mw, Rg = 0, Mw_zimm, Rg_zimm\n\n        # --- 5. Format Output ---\n        Mw_rounded = round_to_significant_figures(Mw, 3)\n        Rg_rounded = round_to_significant_figures(Rg, 3)\n        \n        return [m, Mw_rounded, Rg_rounded]\n\n    # --- Problem Definition ---\n    lambda_vac = 632.8  # nm\n    n = 1.333\n    delta = 0.005\n    \n    c_vals = np.array([0.002, 0.004, 0.006]) # g/mL\n    theta_vals = np.array([30, 60, 90, 120]) # degrees\n\n    test_cases = [\n        # Dataset A\n        np.array([\n            [1.125e-6, 1.160e-6, 1.190e-6, 1.200e-6],\n            [1.330e-6, 1.368e-6, 1.402e-6, 1.412e-6],\n            [1.536e-6, 1.575e-6, 1.608e-6, 1.620e-6]\n        ]),\n        # Dataset B\n        np.array([\n            [9.600e-7, 1.010e-6, 1.090e-6, 1.240e-6],\n            [1.120e-6, 1.170e-6, 1.250e-6, 1.400e-6],\n            [1.280e-6, 1.330e-6, 1.410e-6, 1.560e-6]\n        ]),\n        # Dataset C\n        np.array([\n            [1.710e-6, 1.712e-6, 1.715e-6, 1.716e-6],\n            [1.810e-6, 1.812e-6, 1.815e-6, 1.816e-6],\n            [1.910e-6, 1.912e-6, 1.915e-6, 1.916e-6]\n        ])\n    ]\n\n    results = []\n    for Y_data in test_cases:\n        result = analyze_sls_data(Y_data, c_vals, theta_vals, lambda_vac, n, delta)\n        results.append(result)\n\n    # Final print statement in the exact required format\n    # Using a compact representation for the final list\n    print(str(results).replace(\" \", \"\"))\n```", "id": "2928740"}, {"introduction": "在实际研究中，我们处理的聚合物样品很少是完全单分散的，它们通常是不同链长的混合物，即具有多分散性。静态光散射测量的是样品的平均分子量和平均尺寸，但具体是哪种平均值呢？理解这一点对于正确解释实验结果至关重要。本练习通过分析一个双峰混合物模型，揭示了静态光散射得到的是重均分子量 ($M_w$) 和 z-均回旋半径 ($R_{g,z}$)。掌握这一原理有助于您准确地解读多分散体系的散射数据，并将其与其他表征技术的结果进行有意义的比较 [@problem_id:2928726]。", "problem": "通过静态光散射 (SLS) 和 Zimm 图 (Zimm 分析) 对两种单分散聚合物的稀二元混合物进行分析。该溶液在一种溶剂中制备，在该测量浓度下，粒子间的相互作用可以忽略不计（第二维里系数可视为零），两种组分的折射率增量相同，并且满足单次散射条件。每条链的散射振幅与其质量成正比，对于小的散射矢量幅度 $q$，单链形状因子可以按 $q^{2}$ 进行领先阶展开。该混合物包含组分 $1$ 和 $2$，其摩尔质量分别为 $M_{1}$ 和 $M_{2}$，回旋半径分别为 $R_{g,1}$ 和 $R_{g,2}$，质量分数（相对于总溶质质量）分别为 $w_{1}$ 和 $w_{2}$，且 $w_{1}+w_{2}=1$。从独立粒子散射强度的可加性和单链形状因子的小 $q$ 展开出发，推导在多分散混合物的 Zimm 分析中，由截距和初始角斜率（当 $q \\to 0$ 时）给出的表观重均摩尔质量和 z-均回旋半径的表达式。然后对以下混合物进行数值计算：\n- $M_{1} = 1.00 \\times 10^{5}$ $\\mathrm{g\\,mol^{-1}}$，$R_{g,1} = 12.0$ $\\mathrm{nm}$，\n- $M_{2} = 1.00 \\times 10^{6}$ $\\mathrm{g\\,mol^{-1}}$，$R_{g,2} = 38.0$ $\\mathrm{nm}$，\n- $w_{1} = 0.70$，$w_{2} = 0.30$。\n\n报告表观重均摩尔质量 $M_{w}$（单位为 $\\mathrm{g\\,mol^{-1}}$）和 z-均回旋半径 $R_{g,z}$（单位为 $\\mathrm{nm}$）。将两个数值答案四舍五入至三位有效数字。", "solution": "该问题要求从多分散聚合物混合物的静态光散射 (SLS) 分析中推导出重均摩尔质量 $M_w$ 和 z-均回旋半径 $R_{g,z}$ 的表达式，然后对一个特定的二元混合物进行数值计算。该问题已经过验证，科学上合理，提法恰当，并包含了所有必要的信息。\n\n稀聚合物溶液静态光散射的基本方程是 Zimm 方程。对于一个总溶质质量浓度为 $c$ 的多分散体系，并假设第二维里系数 $A_2$ 为零（如给定溶剂所述），该方程为：\n$$ \\frac{K c}{R_\\theta(q)} = \\frac{1}{\\sum_{i} w_i M_i P_i(q)} $$\n其中 $K$ 是一个光学常数，取决于溶剂折射率、波长和折射率增量 $dn/dc$（假设对所有组分都恒定），$R_\\theta(q)$ 是在散射矢量幅度 $q$ 处的超额瑞利比，$w_i$ 是组分 $i$ 的质量分数，$M_i$ 是其摩尔质量，$P_i(q)$ 是其单链形状因子。散射矢量幅度与散射角 $\\theta$ 的关系为 $q = \\frac{4\\pi n}{\\lambda} \\sin(\\frac{\\theta}{2})$，其中 $n$ 是溶剂折射率，$\\lambda$ 是入射光的真空波长。\n\n问题指出，对于小 $q$，单链形状因子可以按 $q^2$ 展开到领先阶。这就是 Guinier 近似：\n$$ P_i(q) \\approx 1 - \\frac{q^2 R_{g,i}^2}{3} $$\n其中 $R_{g,i}$ 是组分 $i$ 的回旋半径。\n\n将此展开式代入 Zimm 方程的分母，得到：\n$$ \\sum_i w_i M_i P_i(q) \\approx \\sum_i w_i M_i \\left(1 - \\frac{q^2 R_{g,i}^2}{3}\\right) = \\sum_i w_i M_i - \\frac{q^2}{3} \\sum_i w_i M_i R_{g,i}^2 $$\n第一项 $\\sum_i w_i M_i$ 根据定义是重均摩尔质量 $M_w$。\n$$ M_w \\equiv \\frac{\\sum_i c_i M_i}{\\sum_i c_i} = \\sum_i \\frac{c_i}{c} M_i = \\sum_i w_i M_i $$\n所以分母变为 $M_w - \\frac{q^2}{3} \\sum_i w_i M_i R_{g,i}^2$。\n\n因此，对于小 $q$ 的 Zimm 方程为：\n$$ \\frac{K c}{R_\\theta(q)} \\approx \\frac{1}{M_w - \\frac{q^2}{3} \\sum_i w_i M_i R_{g,i}^2} $$\n为了以线性图的形式分析此表达式，我们对小 $q^2$ 进行泰勒展开，使用近似 $(1-x)^{-1} \\approx 1+x$（对于小 $x$）：\n$$ \\frac{K c}{R_\\theta(q)} \\approx \\frac{1}{M_w} \\left( \\frac{1}{1 - \\frac{q^2}{3M_w} \\sum_i w_i M_i R_{g,i}^2} \\right) \\approx \\frac{1}{M_w} \\left( 1 + \\frac{q^2}{3M_w} \\sum_i w_i M_i R_{g,i}^2 \\right) $$\n这个表达式表明，$\\frac{K c}{R_\\theta(q)}$ 对 $q^2$ 的图在小 $q^2$ 时是线性的。\n\n在 Zimm 分析中，表观摩尔质量是通过外推到零散射角（$q \\to 0$）得到的。根据推导的表达式：\n$$ \\lim_{q\\to 0} \\frac{K c}{R_\\theta(q)} = \\frac{1}{M_w} $$\n因此，由 SLS 测得的表观摩尔质量是重均摩尔质量 $M_w$。第一个推导出的表达式是：\n$$ M_w = \\sum_i w_i M_i $$\n\n表观回旋半径由 $\\frac{K c}{R_\\theta(q)}$ 对 $q^2$ 的图的初始斜率确定。对于单分散体系，此方程为 $\\frac{K c}{R_\\theta(q)} \\approx \\frac{1}{M}(1 + \\frac{q^2 R_g^2}{3})$。初始斜率与截距之比为 $\\frac{R_g^2/ (3M)}{1/M} = \\frac{R_g^2}{3}$。\n对于我们的多分散体系，截距是 $I = \\frac{1}{M_w}$，相对于 $q^2$ 的初始斜率是 $S_{q^2} = \\frac{1}{3M_w^2} \\sum_i w_i M_i R_{g,i}^2$。斜率与截距之比得出：\n$$ \\frac{S_{q^2}}{I} = \\frac{\\frac{1}{3M_w^2} \\sum_i w_i M_i R_{g,i}^2}{\\frac{1}{M_w}} = \\frac{1}{3M_w} \\sum_i w_i M_i R_{g,i}^2 $$\n这个比值定义了表观均方回旋半径 $\\langle R_g^2 \\rangle_{app}$ 除以 3：\n$$ \\frac{\\langle R_g^2 \\rangle_{app}}{3} = \\frac{\\sum_i w_i M_i R_{g,i}^2}{3 M_w} \\implies \\langle R_g^2 \\rangle_{app} = \\frac{\\sum_i w_i M_i R_{g,i}^2}{M_w} = \\frac{\\sum_i w_i M_i R_{g,i}^2}{\\sum_i w_i M_i} $$\n这个表达式是 z-均均方回旋半径 $R_{g,z}^2$ 的定义。因此，SLS 报告的回旋半径是 z-均回旋半径 $R_{g,z}$。第二个推导出的表达式是：\n$$ R_{g,z} = \\sqrt{\\frac{\\sum_i w_i M_i R_{g,i}^2}{\\sum_i w_i M_i}} $$\n\n现在，我们对给定的二元混合物（$i=1, 2$）计算这些表达式的值：\n- $M_1 = 1.00 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}}$，$R_{g,1} = 12.0 \\ \\mathrm{nm}$，$w_1 = 0.70$\n- $M_2 = 1.00 \\times 10^6 \\ \\mathrm{g\\,mol^{-1}}$，$R_{g,2} = 38.0 \\ \\mathrm{nm}$，$w_2 = 0.30$\n\n重均摩尔质量 $M_w$ 是：\n$$ M_w = w_1 M_1 + w_2 M_2 = (0.70)(1.00 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}}) + (0.30)(1.00 \\times 10^6 \\ \\mathrm{g\\,mol^{-1}}) $$\n$$ M_w = 7.0 \\times 10^4 \\ \\mathrm{g\\,mol^{-1}} + 3.0 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}} = 3.7 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}} $$\n按要求四舍五入到三位有效数字：\n$$ M_w = 3.70 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}} $$\n\nz-均均方回旋半径 $R_{g,z}^2$ 是：\n$$ R_{g,z}^2 = \\frac{w_1 M_1 R_{g,1}^2 + w_2 M_2 R_{g,2}^2}{M_w} $$\n分子是：\n$$ w_1 M_1 R_{g,1}^2 + w_2 M_2 R_{g,2}^2 = (0.70)(1.00 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}})(12.0 \\ \\mathrm{nm})^2 + (0.30)(1.00 \\times 10^6 \\ \\mathrm{g\\,mol^{-1}})(38.0 \\ \\mathrm{nm})^2 $$\n$$ = (7.0 \\times 10^4)(144) \\ \\mathrm{g\\,mol^{-1}\\,nm^2} + (3.0 \\times 10^5)(1444) \\ \\mathrm{g\\,mol^{-1}\\,nm^2} $$\n$$ = 1.008 \\times 10^7 \\ \\mathrm{g\\,mol^{-1}\\,nm^2} + 4.332 \\times 10^8 \\ \\mathrm{g\\,mol^{-1}\\,nm^2} $$\n$$ = 4.4328 \\times 10^8 \\ \\mathrm{g\\,mol^{-1}\\,nm^2} $$\n现在，我们计算 $R_{g,z}^2$：\n$$ R_{g,z}^2 = \\frac{4.4328 \\times 10^8 \\ \\mathrm{g\\,mol^{-1}\\,nm^2}}{3.7 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}}} \\approx 1198.05 \\ \\mathrm{nm}^2 $$\nz-均回旋半径 $R_{g,z}$ 是其平方根：\n$$ R_{g,z} = \\sqrt{1198.05 \\ \\mathrm{nm}^2} \\approx 34.613 \\ \\mathrm{nm} $$\n四舍五入到三位有效数字：\n$$ R_{g,z} = 34.6 \\ \\mathrm{nm} $$\n\n计算出的值为 $M_w = 3.70 \\times 10^5 \\ \\mathrm{g\\,mol^{-1}}$ 和 $R_{g,z} = 34.6 \\ \\mathrm{nm}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3.70 \\times 10^{5}  34.6 \\end{pmatrix}}\n$$", "id": "2928726"}]}