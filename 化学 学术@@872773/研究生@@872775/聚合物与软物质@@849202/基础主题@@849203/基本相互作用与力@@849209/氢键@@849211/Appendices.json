{"hands_on_practices": [{"introduction": "为了从根本上理解氢键，我们首先需要对其相互作用的势能形貌进行建模。本练习介绍了一种在分子模拟中广泛应用的方法，即结合 Lennard-Jones 势和静电势来描述氢键相互作用 [@problem_id:123489]。通过求解该模型的平衡距离和解离能，你可以掌握如何运用物理模型和微积分来确定衡量氢键强度的关键参数。", "problem": "一个用于描述氢键（例如 N-H···O 键）的简化一维模型，将相互作用势能描述为两个重原子（N 和 O）之间距离 $r$ 的函数。该势能 $U(r)$ 是范德华项和静电项之和。\n\n1.  范德华相互作用由标准的 Lennard-Jones (LJ) 势描述：\n    $$\n    U_{LJ}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n    $$\n    此处，$\\epsilon$ 是 LJ 势阱的深度，$\\sigma$ 是 LJ 势为零时的距离。\n\n2.  氢键的定向、强静电特性通过以下给出的有效吸引势来建模：\n    $$\n    U_{elec}(r) = -\\frac{A}{r^6}\n    $$\n    其中 $A$ 是一个正常数，代表了这种特定静电相互作用的强度。\n\nN-O 相互作用的总势能是这两项贡献之和：\n$$\nU(r) = U_{LJ}(r) + U_{elec}(r)\n$$\n\n解离能 $D_e$ 定义为将两个重原子从其平衡距离 $r_e$ 分离至无限远处所需的能量。鉴于无限分离时势能为零，解离能等于平衡距离处势能的负值，即 $D_e = -U(r_e)$。\n\n计算该氢键模型的解离能 $D_e$。请用参数 $\\epsilon$、$\\sigma$ 和 $A$ 将您的答案表示为一个闭式解析表达式。", "solution": "解离能由 $ D_e = -U(r_e) $ 给出，其中 $ r_e $ 是满足 $ \\frac{dU}{dr} \\big|_{r=r_e} = 0 $ 的平衡距离。总势能为：\n\n$$\nU(r) = 4\\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] - \\frac{A}{r^6}\n$$\n\n将 $ U(r) $ 用 $ r^{-6} $ 表示：\n\n$$\nU(r) = 4\\epsilon \\sigma^{12} r^{-12} - 4\\epsilon \\sigma^6 r^{-6} - A r^{-6} = 4\\epsilon \\sigma^{12} (r^{-6})^2 - (4\\epsilon \\sigma^6 + A) r^{-6}\n$$\n\n设 $ x = r^{-6} $，则：\n\n$$\nU = 4\\epsilon \\sigma^{12} x^2 - (4\\epsilon \\sigma^6 + A) x\n$$\n\n关于 $ r $ 的导数为：\n\n$$\n\\frac{dU}{dr} = \\frac{dU}{dx} \\frac{dx}{dr} = \\left[ 8\\epsilon \\sigma^{12} x - (4\\epsilon \\sigma^6 + A) \\right] \\cdot (-6 r^{-7})\n$$\n\n在平衡状态下，$ \\frac{dU}{dr} = 0 $，这意味着：\n\n$$\n8\\epsilon \\sigma^{12} x_e - (4\\epsilon \\sigma^6 + A) = 0\n$$\n\n其中 $ x_e = r_e^{-6} $。求解 $ x_e $：\n\n$$\nx_e = \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}}\n$$\n\n现在，计算 $ U(r_e) $：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} x_e^2 - (4\\epsilon \\sigma^6 + A) x_e\n$$\n\n代入 $ x_e $：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)^2 - (4\\epsilon \\sigma^6 + A) \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)\n$$\n\n化简：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\cdot \\frac{(4\\epsilon \\sigma^6 + A)^2}{64 \\epsilon^2 \\sigma^{24}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}} = \\frac{(4epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}}\n$$\n\n\n$$\nU(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( \\frac{1}{16\\epsilon} - \\frac{1}{8\\epsilon} \\right) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( -\\frac{1}{16\\epsilon} \\right) = -\\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\n因此，解离能为：\n\n$$\nD_e = -U(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\n展开分子：\n\n$$\n(4\\epsilon \\sigma^6 + A)^2 = 16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2\n$$\n\n所以：\n\n$$\nD_e = \\frac{16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2}{16\\epsilon \\sigma^{12}} = \\epsilon + \\frac{A}{2\\sigma^6} + \\frac{A^2}{16\\epsilon \\sigma^{12}}\n$$", "answer": "$$\n\\boxed{\\epsilon + \\frac{A}{2\\sigma^{6}} + \\frac{A^{2}}{16\\epsilon \\sigma^{12}}}\n$$", "id": "123489"}, {"introduction": "从单个氢键的性质过渡到由氢键连接而成的网络系统，我们会发现许多有趣的集体效应。本练习将以冰的结构为背景，探讨著名的 Bernal-Fowler 定则如何限制质子的排布方式 [@problem_id:123520]。通过计算一个环状结构中所有可能的质子构型数量，你将直接理解微观约束如何导致宏观的热力学现象——剩余熵，并在此过程中学习到统计力学中强大的传递矩阵方法。", "problem": "在晶体冰中，氢原子（质子）的排列遵循 Bernal-Fowler 冰规则：\n1. 每个氧原子都与恰好两个氢原子形成共价键。\n2. 连接两个氧原子的每个氢键中，都包含恰好一个氢原子。\n\n这些规则导致了大量可能的质子构型，从而在零温下产生了残余熵。\n\n考虑一个简化模型，该模型针对存在于某些冰的多晶型或笼形水合物中的一种结构基元。该结构由一个包含 $N$ 个氧原子组成的闭合环组成。每个氧原子 $O_i$ (其中 $i=1, \\dots, N$) 都呈四面体配位。其四个氢键中的两个将其与环内的相邻原子 $O_{i-1}$ 和 $O_{i+1}$ 连接起来（采用周期性边界条件，即 $O_{N+1} \\equiv O_1$）。每个氧原子的另外两个氢键连接到晶格的其余部分，我们可以将其视为外部环境。\n\n对于一个由 $N=10$ 个氧原子组成的环，请确定符合 Bernal-Fowler 冰规则的允许质子构型的总数。", "solution": "Bernal-Fowler 冰规则要求：\n1. 每个氧原子拥有恰好两个共价键合的氢原子。\n2. 每个氢键包含恰好一个氢原子。\n\n对于一个由 $N$ 个氧原子组成的环，每个氧原子 $O_i$（$i = 1, \\dots, N$）有：\n- 两个环内键：连接到 $O_{i-1}$ 的左键（采用周期性边界，$O_0 \\equiv O_N$）和连接到 $O_{i+1}$ 的右键（$O_{N+1} \\equiv O_1$）。\n- 两个连接到环境的外部键。\n\n定义 $L_i$ 如下：\n\n$$\nL_i = \\begin{cases} \n1  \\text{如果 } O_i \\text{ 拥有左侧环内键（连接到 } O_{i-1}\\text{）中的质子}, \\\\\n0  \\text{如果 } O_{i-1} \\text{ 拥有该质子}。\n\\end{cases}\n$$\n\n右侧环内键（连接到 $O_{i+1}$）的归属受冰规则约束：如果 $O_i$ 拥有该键中的质子，那么 $O_{i+1}$ 就不能拥有，反之亦然。因此：\n\n$$\nR_i = 1 - L_{i+1},\n$$\n\n其中 $R_i$ 表示 $O_i$ 对右键的所有权。\n\n每个氧原子总共必须拥有恰好两个质子。$O_i$ 拥有的质子来自：\n- 左侧环内键：$L_i$，\n- 右侧环内键：$R_i = 1 - L_{i+1}$，\n- 两个外部键：令 $E_{i1}, E_{i2} \\in \\{0,1\\}$ 表示 $O_i$ 是否拥有该键中的质子。\n\n方程为：\n\n$$\nL_i + (1 - L_{i+1}) + E_{i1} + E_{i2} = 2,\n$$\n\n简化为：\n\n$$\nL_i - L_{i+1} + s_i = 1, \\quad s_i = E_{i1} + E_{i2}, \\quad s_i \\in \\{0,1,2\\}。\n$$\n\n由于 $L_i, L_{i+1} \\in \\{0,1\\}$，所以 $L_i - L_{i+1} \\in \\{-1,0,1\\}$，并且 $s_i = 1 - L_i + L_{i+1}$ 的值总是在 $\\{0,1,2\\}$ 中。对于给定的 $s_i$，分配外部键的方式数量为：\n\n$$\nw(s_i) = \\begin{cases} \n1  \\text{如果 } s_i = 0 \\text{ 或 } s_i = 2, \\\\\n2  \\text{如果 } s_i = 1。\n\\end{cases}\n$$\n\n因此，$w(1 - L_i + L_{i+1})$ 仅取决于 $L_i$ 和 $L_{i+1}$。\n\n对于 $L_i$ 和 $L_{i+1}$ 的状态，其转移矩阵 $T$ 为：\n\n$$\nT = \\begin{pmatrix}\nT_{00}  T_{01} \\\\\nT_{10}  T_{11}\n\\end{pmatrix}, \\quad \\text{其中} \\quad T_{ab} = w(1 - a + b) \\quad \\text{对于} \\quad a,b \\in \\{0,1\\}。\n$$\n\n计算矩阵元素：\n- $a=0, b=0$：$s_i = 1 - 0 + 0 = 1$, $w(1) = 2$ → $T_{00} = 2$，\n- $a=0, b=1$：$s_i = 1 - 0 + 1 = 2$, $w(2) = 1$ → $T_{01} = 1$，\n- $a=1, b=0$：$s_i = 1 - 1 + 0 = 0$, $w(0) = 1$ → $T_{10} = 1$，\n- $a=1, b=1$：$s_i = 1 - 1 + 1 = 1$, $w(1) = 2$ → $T_{11} = 2$。\n\n所以：\n\n$$\nT = \\begin{pmatrix}\n2  1 \\\\\n1  2\n\\end{pmatrix}.\n$$\n\n\n对于具有周期性边界的环，其构型数量为 $\\operatorname{Tr}(T^N)$。$T$ 的特征值 $\\lambda$ 满足：\n\n$$\n\\det(T - \\lambda I) = \\det\\begin{pmatrix} 2 - \\lambda  1 \\\\ 1  2 - \\lambda \\end{pmatrix} = (2 - \\lambda)^2 - 1 = \\lambda^2 - 4\\lambda + 3 = 0.\n$$\n\n解为：\n\n$$\n\\lambda = \\frac{4 \\pm \\sqrt{16 - 12}}{2} = \\frac{4 \\pm 2}{2} \\implies \\lambda_1 = 3, \\lambda_2 = 1.\n$$\n\n因此：\n\n$$\n\\operatorname{Tr}(T^N) = \\lambda_1^N + \\lambda_2^N = 3^N + 1^N = 3^N + 1.\n$$\n\n\n对于 $N = 10$：\n\n$$\n3^{10} = 59049, \\quad 3^{10} + 1 = 59050.\n$$\n\n这就是允许的质子构型（包括环内键和外部键）的总数。", "answer": "$$\\boxed{59050}$$", "id": "123520"}, {"introduction": "本章的最终练习将理论模型与现代计算科学联系起来，让你体验计算化学中的一项核心任务。我们将采用“炼金术”式的热力学积分方法，计算氢键对体系自由能的贡献 [@problem_id:2773869]。通过分析给定的模拟数据，你不仅能确定关闭氢键过程中的自由能变化 $\\Delta F_{\\text{off}}$，还能将其分解为焓变 $\\Delta U_{\\text{off}}$ 和熵变 $\\Delta S_{\\text{off}}$ 的贡献，从而获得对氢键作用的完整热力学描述。", "problem": "考虑一个温度为 $T$ 的等温正则系综，该系综用于描述一个纳米尺度界面体系，其中吸附物与周围流体之间的氢键相互作用通过一个炼金术耦合参数 $\\lambda \\in [0,1]$ 进行调节。势能分解为 $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)\\,U_{\\text{hb}}$，其中 $U_{\\text{nonhb}}$ 是力场中不依赖于 $\\lambda$ 的部分，$U_{\\text{hb}}$ 是氢键相互作用能项。耦合方案 $s(\\lambda)$ 满足 $s(1)=1$ 和 $s(0)=0$，因此 $\\lambda=1$ 对应于完全相互作用的氢键状态，而 $\\lambda=0$ 对应于氢键被关闭的状态。亥姆霍兹自由能定义为 $F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$，其中 $Z(\\lambda)$ 是在 $\\lambda$ 处的正则配分函数。目标是计算关闭氢键的自由能变 $\\Delta F_{\\text{off}} = F(0)-F(1)$，然后根据焓和熵的贡献来解释它。从第一性原理出发，利用正则配分函数的定义以及 $U(\\lambda)$ 对 $\\lambda$ 的依赖性，推导出一个可计算的 $\\Delta F_{\\text{off}}$ 表达式和一个从系综平均值中数值评估该表达式的算法。仅使用所提供的可观测量平均值和指定的耦合方案，除基本定义外不引入任何额外假设。\n\n您的程序必须为每个测试案例计算：\n- 关闭氢键的亥姆霍兹自由能变 $\\Delta F_{\\text{off}}$ (单位 kJ/mol)。\n- 相应的内能变 $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ (单位 kJ/mol)，其中 $\\langle U_{\\text{tot}} \\rangle_{\\lambda}$ 是在固定 $\\lambda$ 下的系综平均总势能。\n- 由 $\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T\\,\\Delta S_{\\text{off}}$ 定义的熵变 $\\Delta S_{\\text{off}}$ (单位 kJ/(mol·K))。\n\n所有数值答案必须以指定单位表示，并四舍五入到三位小数。\n\n给定离散的 $\\lambda$ 网格、相应的系综平均值 $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (单位 kJ/mol)、端点平均值 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ 和 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ (单位 kJ/mol)，以及耦合方案 $s(\\lambda)$。使用适用于具有偶数个子区间的等间距 $\\lambda$ 网格的求积方案来评估您推导中出现的任何 $\\lambda$ 积分。假设在每个 $\\lambda$ 处的采样对于求积来说是已平衡且充分收敛的。\n\n测试套件（四个案例）：\n\n案例 A (理想情况，线性耦合):\n- 温度 $T = 298.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$ for $\\lambda \\in [0,1]$。\n- $\\lambda$-网格: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.2,\\,-1.8,\\,-3.5,\\,-5.0,\\,-6.5,\\,-8.0,\\,-9.3,\\,-10.6,\\,-11.9,\\,-13.2,\\,-14.5]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -250.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -262.0\\,\\mathrm{kJ/mol}$。\n\n案例 B (边界情况，氢键可忽略，线性耦合):\n- 温度 $T = 298.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$。\n- $\\lambda$-网格: $[0.0,\\,0.25,\\,0.5,\\,0.75,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.1,\\,-0.2,\\,-0.1,\\,0.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -150.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -150.2\\,\\mathrm{kJ/mol}$。\n\n案例 C (低温下更强的氢键，线性耦合):\n- 温度 $T = 260.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$。\n- $\\lambda$-网格: $[0.0,\\,0.125,\\,0.25,\\,0.375,\\,0.5,\\,0.625,\\,0.75,\\,0.875,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.5,\\,-4.0,\\,-8.0,\\,-12.0,\\,-16.0,\\,-20.0,\\,-24.0,\\,-27.0,\\,-30.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -300.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -322.5\\,\\mathrm{kJ/mol}$。\n\n案例 D (非线性耦合，$\\lambda=0$ 附近软化):\n- 温度 $T = 300.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda^{2}$。\n- $\\lambda$-网格: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.5,\\,-2.0,\\,-4.2,\\,-6.8,\\,-9.5,\\,-12.0,\\,-14.0,\\,-16.0,\\,-18.0,\\,-20.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -500.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -510.0\\,\\mathrm{kJ/mol}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含按 A、B、C、D 顺序排列的各案例结果列表。每个案例的结果必须是一个列表 $[\\Delta F_{\\text{off}}, \\Delta U_{\\text{off}}, \\Delta S_{\\text{off}}]$，其中 $\\Delta F_{\\text{off}}$ 和 $\\Delta U_{\\text{off}}$ 的值四舍五入到三位小数，单位为 kJ/mol，$\\Delta S_{\\text{off}}$ 的单位为 kJ/(mol·K)。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n\n*   **体系**：一个描述纳米尺度界面体系的等温正则系综，温度为 $T$。\n*   **势能**：$U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)\\,U_{\\text{hb}}$，其中 $\\lambda \\in [0,1]$ 是一个炼金术耦合参数。\n*   **能量项**：$U_{\\text{nonhb}}$ 是不依赖 $\\lambda$ 的背景势能；$U_{\\text{hb}}$ 是氢键相互作用能。\n*   **耦合方案**：一个函数 $s(\\lambda)$，满足 $s(1)=1$（氢键完全开启）和 $s(0)=0$（氢键完全关闭）。\n*   **亥姆霍兹自由能**：$F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$，其中 $Z(\\lambda)$ 是正则配分函数。\n*   **主要目标**：计算关闭氢键的自由能变，$\\Delta F_{\\text{off}} = F(0)-F(1)$。\n*   **次要目标**：计算内能变 $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ 和熵变 $\\Delta S_{\\text{off}}$，它们通过热力学恒等式 $\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T\\,\\Delta S_{\\text{off}}$ 相关联。\n*   **提供的数据**：对于每个测试案例，给定了温度 $T$、函数 $s(\\lambda)$、一个离散且等间距的 $\\lambda$ 网格、相应的系综平均值 $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$，以及端点总能量平均值 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ 和 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$。\n*   **数值方法约束**：对于任何积分，必须使用适用于具有偶数个子区间的等间距 $\\lambda$ 网格的求积方案。\n*   **假设**：系综平均值被认为是收敛的。\n*   **单位**：所有能量量纲都以 $\\mathrm{kJ/mol}$ 为单位；温度以 $\\mathrm{K}$ 为单位；熵变以 $\\mathrm{kJ/(mol \\cdot K)}$ 为单位。\n*   **测试案例**：提供了四个具体的案例（A、B、C、D），包含所有必要的数值数据。\n\n**第2步：问题陈述的验证**\n\n*   **科学依据**：该问题是热力学积分的应用，这是统计力学和计算物理学中计算自由能差的核心技术。势能、亥姆霍兹自由能的定义及其与系综平均值的关系是基本且正确的。\n*   **适定性**：该问题是适定的。它要求推导一个标准公式并将其应用于一套完整的数据。对给定网格结构（偶数个区间）的数值积分方法的指定意味着一个唯一确定的数值结果，对此辛普森 1/3 法则是合适的标准选择。\n*   **客观性**：问题以精确、客观和定量的术语陈述，没有歧义或主观内容。\n*   **结论**：该问题在科学上是合理的、自洽的，并且结构严谨。它没有违反任何指定的无效性标准。\n\n**第3步：裁定与行动**\n\n问题被判定为 **有效**。将提供解答。\n\n**控制方程的推导**\n\n亥姆霍兹自由能 $F(\\lambda)$ 由下式给出：\n$$F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z(\\lambda)$ 是给定耦合参数 $\\lambda$ 值下的正则配分函数。配分函数是对所有微观态（相空间坐标 $\\mathbf{q}$ 和动量 $\\mathbf{p}$）的积分：\n$$Z(\\lambda) = \\frac{1}{h^{3N}N!} \\int d\\mathbf{q} \\int d\\mathbf{p} \\, \\exp\\left(-\\frac{H(\\mathbf{q}, \\mathbf{p}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\n由于势能 $U(\\lambda)$ 与动量无关，动量部分可以被积分掉，得到一个常数因子。相关的依赖关系在于构型积分：\n$$Z(\\lambda) \\propto \\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\n为了求得自由能的变化，我们首先对 $F(\\lambda)$ 关于 $\\lambda$ 求导：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\lambda)} \\frac{\\partial Z}{\\partial \\lambda}$$\n配分函数的导数是：\n$$\\frac{\\partial Z}{\\partial \\lambda} \\propto \\int d\\mathbf{q} \\, \\left(-\\frac{1}{k_{\\mathrm{B}}T} \\frac{\\partial U(\\mathbf{q}, \\lambda)}{\\partial \\lambda}\\right) \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\n将此代入 $\\frac{\\partial F}{\\partial \\lambda}$ 的表达式中：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\int d\\mathbf{q} \\, \\frac{\\partial U(\\mathbf{q}, \\lambda)}{\\partial \\lambda} \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}{\\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}$$\n这是势能对 $\\lambda$ 的导数的正则系综平均的定义。因此，我们得到了热力学积分的基本关系：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$$\n势能给定为 $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)U_{\\text{hb}}$。对其关于 $\\lambda$ 求导得到：\n$$\\frac{\\partial U}{\\partial \\lambda} = \\frac{\\partial s(\\lambda)}{\\partial \\lambda} U_{\\text{hb}} = s'(\\lambda) U_{\\text{hb}}$$\n因此，自由能的导数变为：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle s'(\\lambda) U_{\\text{hb}} \\right\\rangle_{\\lambda} = s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda}$$\n因为 $s'(\\lambda)$ 是 $\\lambda$ 的一个确定性函数，不随系统微观态而涨落。\n\n关闭氢键的总自由能变 $\\Delta F_{\\text{off}} = F(\\lambda=0) - F(\\lambda=1)$，可以通过将此导数从 $\\lambda = 1$ 积分到 $\\lambda = 0$ 来求得：\n$$\\Delta F_{\\text{off}} = \\int_{1}^{0} \\frac{\\partial F}{\\partial \\lambda} d\\lambda = \\int_{1}^{0} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda$$\n这等价于：\n$$\\Delta F_{\\text{off}} = - \\int_{0}^{1} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda$$\n这就是需要计算的最终表达式。$\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ 的输入以摩尔单位（$\\mathrm{kJ/mol}$）提供，因此得到的 $\\Delta F_{\\text{off}}$ 也将以 $\\mathrm{kJ/mol}$ 为单位。\n\n**热力学分解**\n\n问题要求将自由能变分解为其内能和熵分量。关闭氢键时的内能变由端点平均值直接给出：\n$$\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$$\n连接这些量的基本热力学关系是 $\\Delta F = \\Delta U - T\\Delta S$。对于关闭氢键的过程，这表示为：\n$$\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T \\Delta S_{\\text{off}}$$\n整理得到熵变 $\\Delta S_{\\text{off}}$ 的表达式：\n$$\\Delta S_{\\text{off}} = \\frac{\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}}{T}$$\n$\\Delta F_{\\text{off}}$ 的正值表示关闭氢键是一个非自发过程，意味着氢键的存在在热力学上是有利的。$\\Delta U_{\\text{off}}$ 代表系统平均势能的变化；正值意味着没有氢键时系统在能量上更不稳定。$\\Delta S_{\\text{off}}$ 代表无序度的变化；正值通常表示当氢键被关闭时，系统具有更多可及的微观态（例如，更大的构象自由度）。\n\n**计算算法**\n\n数值评估按以下步骤进行：\n1. 对于每个测试案例，确定温度 $T$、耦合方案 $s(\\lambda)$、$\\lambda$-网格 $\\{\\lambda_i\\}_{i=0}^N$、平均氢键能 $\\{\\langle U_{\\text{hb}} \\rangle_{\\lambda_i}\\}_{i=0}^N$，以及端点总能量 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ 和 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$。\n2. 解析地确定耦合方案的导数 $s'(\\lambda)$。\n3. 对于网格上的每个点 $\\lambda_i$，计算被积函数的值 $I_i = s'(\\lambda_i) \\langle U_{\\text{hb}} \\rangle_{\\lambda_i}$。\n4. 使用辛普森 1/3 法则从离散值 $\\{I_i\\}$ 和 $\\{\\lambda_i\\}$ 中数值计算积分 $W = \\int_{0}^{1} I(\\lambda) d\\lambda$。该方法适用于偶数个区间。\n5. 计算亥姆霍兹自由能变：$\\Delta F_{\\text{off}} = -W$。\n6. 计算内能变：$\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$。\n7. 计算熵变：$\\Delta S_{\\text{off}} = (\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}) / T$。\n8. 将结果 $[\\Delta F_{\\text{off}}, \\Delta U_{\\text{off}}, \\Delta S_{\\text{off}}]$ 格式化，数值四舍五入到三位小数。\n\n此算法将针对所提供的四个测试案例进行实现。", "answer": "[[7.797, 12.000, 0.014], [0.100, 0.200, 0.000], [15.896, 22.500, 0.025], [13.064, 10.000, -0.010]]", "id": "2773869"}]}