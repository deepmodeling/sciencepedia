{"hands_on_practices": [{"introduction": "理解非晶态结构的第一步是表征其局域原子排列。本练习将指导您构建一个简化模型，通过径向分布函数 $g(r)$ 将宏观的堆积分数与微观的配位数联系起来。通过这个实践，您将掌握从基本物理原理出发，推导非晶固体短程有序结构特征的方法[@problem_id:2468325]。", "problem": "一种单分散非晶固体被建模为直径为 $d$ 的硬球 (HS) 的密集随机堆积。该结构由径向分布函数 $g(r)$ 表征，其中 $r$ 是粒子间的中心距。堆积分数为 $\\phi = \\rho \\, v_{\\text{sphere}}$，其中数密度为 $\\rho$，单个球体的体积为 $v_{\\text{sphere}} = \\pi d^{3}/6$。平均配位数 $z$ 定义为第一配位壳层中邻居的期望数，并由以下积分定义给出\n$$\nz \\;=\\; 4\\pi \\rho \\int_{0}^{r_{\\min}} g(r)\\, r^{2}\\, dr,\n$$\n其中 $r_{\\min}$ 表示 $g(r)$ 的第一个极小值的位置。\n\n仅使用密集随机堆积的论点和核心定义，按如下步骤进行：\n- 通过假设 $g(r)$ 的第一个峰值位置 $r_{0}$ 与平均粒子间距 $\\rho^{-1/3}$ 成比例，并且在堆积分数为 $\\phi_{\\mathrm{rcp}}$ 的随机密堆积 (RCP) 状态下接触条件 $r_{0}=d$ 成立，来校准最近邻距离与堆积分数的关系。由此，建立 $r_{0}$ 与 $\\phi$ 和 $\\phi_{\\mathrm{rcp}}$ 的关系。\n- 作为一个适用于密集堆积的无序球体的几何估计，假设第一个极小值出现在 $r_{\\min} = \\sqrt{2}\\, r_{0}$。\n- 近似第一壳层结构，由于排除体积效应，取 $r  d$ 时 $g(r) = 0$，并进一步简化，在 $d \\le r \\le r_{\\min}$ 范围内取 $g(r) \\approx 1$。\n- 使用上述近似，推导出一个解析表达式，将 $z$ 表示为 $\\phi$ 和 $\\phi_{\\mathrm{rcp}}$ 的函数。\n- 最后，计算堆积分数为 $\\phi = 0.58$ 时的配位数 $z$，其中随机密堆积的堆积分数为 $\\phi_{\\mathrm{rcp}} = 0.64$。将您的答案四舍五入到三位有效数字。", "solution": "所述问题具有科学依据，提法恰当且自成体系。它提出了一个简化但标准的非晶固体物理模型，并要求基于所提供的假设进行逻辑推导。问题有效。我们开始求解。\n\n平均配位数 $z$ 由以下积分定义：\n$$\nz = 4\\pi \\rho \\int_{0}^{r_{\\min}} g(r)\\, r^{2}\\, dr\n$$\n其中 $\\rho$ 是数密度，而 $r_{\\min}$ 是径向分布函数 $g(r)$ 中第一个极小值的位置。\n\n问题提供了一组简化假设来模拟非晶固体的结构。首先，根据硬球排除体积原理，径向分布函数 $g(r)$ 被近似为一个阶跃函数。对于小于球体直径 $d$ 的距离 $r$，粒子不能重叠，因此 $g(r)$ 为零。对于 $d$ 和第一个极小值 $r_{\\min}$ 之间的距离，我们忽略短程有序相关性，并假设 $g(r) \\approx 1$。\n$$\ng(r) \\approx\n\\begin{cases}\n0  \\text{for } r  d \\\\\n1  \\text{for } d \\le r \\le r_{\\min}\n\\end{cases}\n$$\n将此近似代入 $z$ 的定义中，积分下限变为 $d$，被积函数得以简化。\n$$\nz \\approx 4\\pi \\rho \\int_{d}^{r_{\\min}} (1) \\, r^{2}\\, dr\n$$\n该积分为初等积分：\n$$\n\\int_{d}^{r_{\\min}} r^{2}\\, dr = \\left[ \\frac{r^{3}}{3} \\right]_{d}^{r_{\\min}} = \\frac{r_{\\min}^{3} - d^{3}}{3}\n$$\n因此，配位数变为：\n$$\nz = \\frac{4\\pi \\rho}{3} (r_{\\min}^{3} - d^{3})\n$$\n接下来，我们必须将量 $r_{\\min}$ 和 $\\rho$ 与给定的堆积分数 $\\phi$ 和 $\\phi_{\\mathrm{rcp}}$ 联系起来。堆积分数 $\\phi$ 由 $\\phi = \\rho \\, v_{\\text{sphere}} = \\rho (\\frac{\\pi d^{3}}{6})$ 给出。由此，我们可以用 $\\phi$ 表示乘积 $\\rho d^{3}$：\n$$\n\\rho d^{3} = \\frac{6\\phi}{\\pi}\n$$\n问题指出，$g(r)$ 的第一个峰值位置 $r_{0}$ 与平均粒子间距 $\\rho^{-1/3}$ 成比例。因此，我们可以写出 $r_{0} = C \\rho^{-1/3}$，其中 $C$ 是比例常数。我们可以将 $\\rho$ 表示为 $\\rho = \\frac{6\\phi}{\\pi d^{3}}$，得到：\n$$\nr_{0} = C \\left( \\frac{6\\phi}{\\pi d^{3}} \\right)^{-1/3} = C \\left( \\frac{\\pi}{6} \\right)^{1/3} d \\, \\phi^{-1/3}\n$$\n这个关系通过使用随机密堆积 (RCP) 的条件进行校准，在此条件下，$\\phi = \\phi_{\\mathrm{rcp}}$ 且粒子相互接触，因此 $r_{0} = d$。代入这些值：\n$$\nd = C \\left( \\frac{\\pi}{6} \\right)^{1/3} d \\, \\phi_{\\mathrm{rcp}}^{-1/3}\n$$\n解出常数项 $C (\\frac{\\pi}{6})^{1/3}$：\n$$\nC \\left( \\frac{\\pi}{6} \\right)^{1/3} = \\phi_{\\mathrm{rcp}}^{1/3}\n$$\n将此代回 $r_{0}$ 的一般表达式，得到校准后的关系：\n$$\nr_{0} = (\\phi_{\\mathrm{rcp}}^{1/3}) d \\, \\phi^{-1/3} = d \\left( \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} \\right)^{1/3}\n$$\n第一个极小值的位置 $r_{\\min}$ 通过几何估计为 $r_{\\min} = \\sqrt{2} \\, r_{0}$。因此：\n$$\nr_{\\min} = \\sqrt{2} \\, d \\left( \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} \\right)^{1/3}\n$$\n现在我们将 $r_{\\min}$ 的这个表达式代入 $z$ 的方程中：\n$$\nz = \\frac{4\\pi \\rho}{3} \\left( \\left[ \\sqrt{2} \\, d \\left( \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} \\right)^{1/3} \\right]^{3} - d^{3} \\right)\n$$\n简化括号中的项：\n$$\nz = \\frac{4\\pi \\rho}{3} \\left( (\\sqrt{2})^{3} d^{3} \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} - d^{3} \\right) = \\frac{4\\pi \\rho d^{3}}{3} \\left( 2\\sqrt{2} \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} - 1 \\right)\n$$\n为了消去 $\\rho$ 和 $d$，我们使用关系式 $\\rho d^{3} = 6\\phi/\\pi$：\n$$\nz = \\frac{4\\pi}{3} \\left( \\frac{6\\phi}{\\pi} \\right) \\left( 2\\sqrt{2} \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} - 1 \\right)\n$$\n$\\pi$ 项被消掉，并且 $\\frac{4 \\times 6}{3} = 8$。\n$$\nz = 8\\phi \\left( 2\\sqrt{2} \\frac{\\phi_{\\mathrm{rcp}}}{\\phi} - 1 \\right)\n$$\n将项 $8\\phi$ 分配进去，得到用 $\\phi$ 和 $\\phi_{\\mathrm{rcp}}$ 表示的 $z$ 的最终解析表达式：\n$$\nz = 16\\sqrt{2} \\, \\phi_{\\mathrm{rcp}} - 8\\phi\n$$\n推导至此完成。现在我们用指定的值 $\\phi = 0.58$ 和 $\\phi_{\\mathrm{rcp}} = 0.64$ 来计算 $z$。\n$$\nz = 16\\sqrt{2} \\, (0.64) - 8(0.58)\n$$\n$$\nz = 10.24\\sqrt{2} - 4.64\n$$\n使用 $\\sqrt{2} \\approx 1.41421356$ 的值：\n$$\nz \\approx 10.24 \\times 1.41421356 - 4.64\n$$\n$$\nz \\approx 14.481546 - 4.64 = 9.841546\n$$\n问题要求结果四舍五入到三位有效数字。\n$$\nz \\approx 9.84\n$$\n这个值代表在指定的非晶堆积中，一个球体的平均最近邻数，它是在给定的一组简化假设下推导出来的。", "answer": "$$\n\\boxed{9.84}\n$$", "id": "2468325"}, {"introduction": "超越最近邻的相互作用，中程序是区分不同类型玻璃的关键结构特征。本计算练习要求您实现一个算法，从原子坐标出发，识别网络结构中的环，并将其与结构因子 $S(q)$ 中的第一尖锐衍射峰（FSDP）联系起来[@problem_id:2468330]。这个练习将真实空间中的拓扑结构与倒易空间中的衍射信号联系起来，是理解玻璃中程有序的绝佳实践。", "problem": "给定一个立方、三维周期性盒子中有限的一组原子位置，这些原子构成了几个模拟网络玻璃的小型网络状构型。您的任务是从第一性原理出发，实现一个算法来计算环统计，并将特征环尺寸与径向分布函数 (RDF) 和静态结构因子（包括第一尖锐衍射峰 (FSDP)）关联起来。您必须实现一个仅从核心定义和广为接受的公式出发的算法解决方案。\n\n从以下基本基础开始：\n- 当满足基于距离的成键判据时，将原子集解释为无向图的顶点。对于立方周期性晶胞，使用最小镜像约定计算距离。形式上，对于盒子边长为 $L$ 中位于 $\\mathbf{r}_i$ 和 $\\mathbf{r}_j$ 的任意一对原子，其最小镜像位移按分量计算为 $\\Delta \\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i - L \\,\\mathrm{round}((\\mathbf{r}_j - \\mathbf{r}_i)/L)$，最小镜像距离为 $r_{ij} = \\lVert \\Delta \\mathbf{r}_{ij} \\rVert$。\n- 如果 $r_{ij} \\le r_\\mathrm{c}$，则在顶点 $i$ 和 $j$ 之间定义一条无向边，其中 $r_\\mathrm{c}$ 是给定的成键截断半径。由此产生的无向简单图 $G$ 具有顶点集 $V$ 和边集 $E$。\n- 环统计是在 $G$ 在二元有限域上的环空间中定义的，该空间是所有在模2加法下对应于环的边关联向量的集合。表征本原环的一种标准方法是计算最小环基（总权重最小，权重定义为每个环的边数）。您可以通过考虑对于每个边 $e = (u,v) \\in E$，在图 $G \\setminus \\{e\\}$ 中找到 $u$ 和 $v$ 之间的最短路径（按边数计算），然后将此路径与边 $e$ 组合形成一个环，来构建一个候选简单环的集合。从这些候选环中，通过对其边关联向量在 $\\mathbb{F}_2$ 上进行高斯消元，选择一个总权重最小的线性无关环的基。一个环的长度 $k$ 是该环中边的数量（等价于顶点的数量）。\n- 通过系综平均定义三维体系的径向分布函数 (RDF) $g(r)$：$g(r) = \\frac{1}{4\\pi r^2 \\rho N} \\left\\langle \\sum_{i \\ne j} \\delta(r - r_{ij}) \\right\\rangle$，其中 $\\rho = N/V$ 是数密度，$N$ 是原子数，$V = L^3$ 是体积。在离散的有限数据集中，通过将唯一的原子对 $i  j$ 统计到中心为 $r_\\ell$、宽度为 $\\Delta r$ 的径向区间中来估计 $g(r)$，并选择一致的归一化方式，使得在均匀体系中，当 $r$ 较大时 $g(r) \\to 1$。由定义得到的一致估计量为\n$$\ng(r_\\ell) \\approx \\frac{2 \\, C_\\ell}{N \\, \\rho \\, 4\\pi \\, r_\\ell^2 \\, \\Delta r},\n$$\n其中 $C_\\ell$ 是距离在以 $r_\\ell$ 为中心的区间内的唯一原子对的数量。\n- 定义总相关函数 $h(r) = g(r) - 1$。三维各向同性体系的静态结构因子 $S(q)$ 与 $h(r)$ 通过傅里叶变换关系相关联：\n$$\nS(q) = 1 + 4\\pi \\rho \\int_0^{\\infty} r^2 h(r) \\frac{\\sin(q r)}{q r} \\, \\mathrm{d}r.\n$$\n在计算中，通过在直方图区间上使用黎曼和来近似此积分。\n- 第一尖锐衍射峰 (FSDP) 是 $S(q)$ 在低波矢 $q \\gt 0$ 处的第一个显著局部最大值，通常归因于中程有序。一个特征中程长度标度 $D$ 可以与一个主导环尺寸 $k$ 和一个平均键长 $a$ 相关联，方法是将环建模为正多边形，其外接圆半径为 $R_k = \\frac{a}{2 \\sin(\\pi/k)}$，直径为 $D_k = 2 R_k = \\frac{a}{\\sin(\\pi/k)}$。对 FSDP 位置的一个粗略预测是 $q_\\mathrm{pred} \\approx \\frac{2\\pi}{\\bar{D}}$，其中 $\\bar{D}$ 是由观测到的环数量分布加权的 $D_k$ 的平均值。\n\n为每个测试用例实现以下算法步骤：\n1. 在边长为 $L$（单位为 $\\mathrm{\\AA}$）的立方周期性盒子中，计算所有成对的最小镜像距离 $r_{ij}$。\n2. 对于任意满足 $r_{ij} \\le r_\\mathrm{c}$（其中 $r_\\mathrm{c}$ 已给定，单位为 $\\mathrm{\\AA}$）的原子对，添加一条边来构建 $G$ 的邻接关系。\n3. 对于每条边 $e = (u,v)$，在 $G \\setminus \\{e\\}$ 中找到 $u$ 和 $v$ 之间的最短路径（如果存在），并形成环 $C_e = \\text{path} \\cup \\{e\\}$，从而构建一个候选环集合。将每个环表示为一个关于 $|E|$ 条边的二元关联向量。\n4. 从候选环中，通过使用在 $\\mathbb{F}_2$ 上的高斯消元，选择一个总权重（环长度）最小的线性无关环向量的最大集合，来计算最小环基。从基环中提取环尺寸 $k$。\n5. 按照顺序为尺寸 $k \\in \\{3,4,5,6,7,8\\}$ 形成一个环尺寸直方图。为此直方图的目的，忽略此范围之外的环。\n6. 通过将唯一的原子对距离统计到宽度为 $\\Delta r$（单位为 $\\mathrm{\\AA}$）的区间中，从 $r = 0$ 到 $r_{\\max} = L/2$，来估计 RDF $g(r)$。使用与上述定义一致的归一化。计算数密度 $\\rho = N/L^3$（单位为 $\\mathrm{\\AA}^{-3}$）。\n7. 使用上述积分在网格 $q = q_{\\min}, q_{\\min} + \\Delta q, \\dots, q_{\\max}$（单位为 $\\mathrm{\\AA}^{-1}$）上的离散化版本，从 $g(r)$ 计算 $S(q)$。将 FSDP 波矢 $q_\\mathrm{FSDP}$ 识别为当 $q \\ge q_{\\min}$ 时 $S(q)$ 的第一个局部最大值，使用一个简单的离散寻峰规则：位于 $q_i$ 的局部最大值满足 $S(q_i) \\gt S(q_{i-1})$ 且 $S(q_i) \\gt S(q_{i+1})$。如果在网格上未找到这样的局部最大值，则返回指定范围内 $S(q)$ 达到其全局最大值的 $q$ 值（若有多个，则取最小的 $q$）。\n8. 将平均键长 $a$ 计算为所有满足 $r_{ij} \\le r_\\mathrm{c}$ 的成键对 $(i,j)$ 的 $r_{ij}$ 的算术平均值。使用环尺寸直方图计数 $n_k$ 和公式 $D_k = \\frac{a}{\\sin(\\pi/k)}$（对于出现的每个 $k$），计算加权平均值 $\\bar{D} = \\frac{\\sum_k n_k D_k}{\\sum_k n_k}$。如果 $\\sum_k n_k = 0$（未找到环），则定义 $\\bar{D}$ 为未定义，并按惯例在这种情况下设置 $q_\\mathrm{pred} = 0$。否则，计算 $q_\\mathrm{pred} = \\frac{2\\pi}{\\bar{D}}$。\n9. 对于每个测试用例，生成一个结果列表，包含环尺寸直方图和两个波矢 $q_\\mathrm{FSDP}$ 和 $q_\\mathrm{pred}$，两者都四舍五入到三位小数。具体来说，对于环尺寸 $k \\in \\{3,4,5,6,7,8\\}$，环直方图应为一个列表 $[n_3,n_4,n_5,n_6,n_7,n_8]$，其中每个 $n_k$ 是一个整数。两个波矢必须以 $\\mathrm{\\AA}^{-1}$ 为单位报告。\n\n输入数据（测试套件）：\n- 测试用例 A（单个六边形环）：\n  - 盒子边长 $L = 25.0 \\,\\mathrm{\\AA}$，成键截断半径 $r_\\mathrm{c} = 1.9 \\,\\mathrm{\\AA}$。\n  - 位置 $\\mathbf{r}_i$（单位为 $\\mathrm{\\AA}$）：\n    - $\\big(14.100000,\\, 12.500000,\\, 12.500000\\big)$\n    - $\\big(13.300000,\\, 13.885641,\\, 12.500000\\big)$\n    - $\\big(11.700000,\\, 13.885641,\\, 12.500000\\big)$\n    - $\\big(10.900000,\\, 12.500000,\\, 12.500000\\big)$\n    - $\\big(11.700000,\\, 11.114359,\\, 12.500000\\big)$\n    - $\\big(13.300000,\\, 11.114359,\\, 12.500000\\big)$\n  - RDF 参数：$\\Delta r = 0.05 \\,\\mathrm{\\AA}$。\n  - $S(q)$ 网格：$q_{\\min} = 0.10 \\,\\mathrm{\\AA}^{-1}$，$q_{\\max} = 12.00 \\,\\mathrm{\\AA}^{-1}$，$\\Delta q = 0.05 \\,\\mathrm{\\AA}^{-1}$。\n- 测试用例 B（一个五边形和一个七边形，分离）：\n  - 盒子边长 $L = 30.0 \\,\\mathrm{\\AA}$，成键截断半径 $r_\\mathrm{c} = 1.9 \\,\\mathrm{\\AA}$。\n  - 位置 $\\mathbf{r}_i$（单位为 $\\mathrm{\\AA}$），五边形中心大约在 $\\big(10.000000,\\, 10.000000,\\, 10.000000\\big)$，边长约 $a = 1.600000 \\,\\mathrm{\\AA}$：\n    - $\\big(11.361803,\\, 10.000000,\\, 10.000000\\big)$\n    - $\\big(10.420451,\\, 11.294095,\\, 10.000000\\big)$\n    - $\\big(8.839549,\\, 10.800000,\\, 10.000000\\big)$\n    - $\\big(8.839549,\\, 9.200000,\\, 10.000000\\big)$\n    - $\\big(10.420451,\\, 8.705905,\\, 10.000000\\big)$\n  - 位置 $\\mathbf{r}_i$（单位为 $\\mathrm{\\AA}$），七边形中心大约在 $\\big(18.000000,\\, 18.000000,\\, 18.000000\\big)$，边长约 $a = 1.600000 \\,\\mathrm{\\AA}$：\n    - $\\big(19.844384,\\, 18.000000,\\, 18.000000\\big)$\n    - $\\big(19.418058,\\, 18.769421,\\, 18.000000\\big)$\n    - $\\big(18.592011,\\, 19.205192,\\, 18.000000\\big)$\n    - $\\big(17.635945,\\, 19.137771,\\, 18.000000\\big)$\n    - $\\big(16.958666,\\, 18.592011,\\, 18.000000\\big)$\n    - $\\big(16.803499,\\, 17.707430,\\, 18.000000\\big)$\n    - $\\big(17.315437,\\, 17.007175,\\, 18.000000\\big)$\n  - RDF 参数：$\\Delta r = 0.05 \\,\\mathrm{\\AA}$。\n  - $S(q)$ 网格：$q_{\\min} = 0.10 \\,\\mathrm{\\AA}^{-1}$，$q_{\\max} = 12.00 \\,\\mathrm{\\AA}^{-1}$，$\\Delta q = 0.05 \\,\\mathrm{\\AA}^{-1}$。\n- 测试用例 C（无环：八个原子的线性链）：\n  - 盒子边长 $L = 25.0 \\,\\mathrm{\\AA}$，成键截断半径 $r_\\mathrm{c} = 1.9 \\,\\mathrm{\\AA}$。\n  - 位置 $\\mathbf{r}_i$（单位为 $\\mathrm{\\AA}$）：\n    - $\\big(6.000000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(7.600000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(9.200000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(10.800000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(12.400000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(14.000000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(15.600000,\\, 6.000000,\\, 6.000000\\big)$\n    - $\\big(17.200000,\\, 6.000000,\\, 6.000000\\big)$\n  - RDF 参数：$\\Delta r = 0.05 \\,\\mathrm{\\AA}$。\n  - $S(q)$ 网格：$q_{\\min} = 0.10 \\,\\mathrm{\\AA}^{-1}$，$q_{\\max} = 12.00 \\,\\mathrm{\\AA}^{-1}$，$\\Delta q = 0.05 \\,\\mathrm{\\AA}^{-1}$。\n\n答案规范：\n- 对于每个测试用例，计算：\n  - 环尺寸直方图 $[n_3,n_4,n_5,n_6,n_7,n_8]$，作为一个包含 6 个整数的列表。\n  - FSDP 位置 $q_\\mathrm{FSDP}$，单位为 $\\mathrm{\\AA}^{-1}$，四舍五入到三位小数。\n  - 预测的 FSDP 位置 $q_\\mathrm{pred}$，单位为 $\\mathrm{\\AA}^{-1}$，使用所述的加权平均值 $\\bar{D}$ 计算，四舍五入到三位小数。如果未找到环，则设置 $q_\\mathrm{pred} = 0$。\n- 最终输出格式：您的程序应生成一行输出，其中包含三个测试用例的结果，形式为用方括号括起来的逗号分隔列表，不含空格。每个用例应表示为 $[\\,[n_3,n_4,n_5,n_6,n_7,n_8],\\,q_\\mathrm{FSDP},\\,q_\\mathrm{pred}\\,]$。例如，一个有效的输出可能如下所示：\n  - $[[[0,0,1,1,0,0],2.345,2.512],[[0,0,1,0,1,0],2.100,2.200],[[0,0,0,0,0,0],1.850,0.000]]$\n\n重要说明：\n- 所有距离必须以 $\\mathrm{\\AA}$ 为单位处理，所有波矢必须以 $\\mathrm{\\AA}^{-1}$ 为单位处理。\n- 解释中用于构建多边形的角度是以弧度为单位的，但所有输入位置都是直接给出的；输入不需要进行角度转换。\n- 百分比（如有）必须表示为小数，但本问题不要求使用百分比。\n\n您的程序必须实现上述步骤，并在运行时产生指定的输出行，无需用户输入。", "solution": "用户提供的问题是一个在材料化学领域中明确定义的计算任务，具体涉及非晶结构的分析。我将根据提供的规范，逐步进行详细的解决方案。\n\n### 步骤 1：问题验证\n\n首先，需要对问题陈述进行严格验证。\n\n**已知条件提取：**\n- **体系：** 三维立方周期性盒子中的有限原子坐标集 $\\mathbf{r}_i$。\n- **距离度量：** 最小镜像约定，$\\Delta \\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i - L \\,\\mathrm{round}((\\mathbf{r}_j - \\mathbf{r}_i)/L)$ 和 $r_{ij} = \\lVert \\Delta \\mathbf{r}_{ij} \\rVert$。\n- **图模型：** 一个无向图 $G=(V,E)$，其中原子是顶点 $V$，如果 $r_{ij} \\le r_\\mathrm{c}$，则存在一条边 $(i, j) \\in E$。\n- **环统计：** 通过最小环基定义，通过生成候选环并使用在 $\\mathbb{F}_2$ 上的高斯消元来选择一个最小总权重的基。\n- **径向分布函数 ($g(r)$):** 通过对原子对距离进行直方图统计来估计：$g(r_\\ell) \\approx \\frac{2 \\, C_\\ell}{N \\, \\rho \\, 4\\pi \\, r_\\ell^2 \\, \\Delta r}$。\n- **静态结构因子 ($S(q)$):** 通过总相关函数 $h(r) = g(r) - 1$ 的傅里叶变换计算：$S(q) = 1 + 4\\pi \\rho \\int_0^{\\infty} r^2 h(r) \\frac{\\sin(q r)}{q r} \\, \\mathrm{d}r$。\n- **第一尖锐衍射峰 (FSDP):** $S(q)$ 在 $q \\ge q_{\\min}$ 时的第一个局部最大值。\n- **FSDP 预测 ($q_\\mathrm{pred}$):** 基于加权平均环直径 $\\bar{D}$，其中 $q_\\mathrm{pred} = 2\\pi / \\bar{D}$。\n- **输入数据：** 三个测试用例，包含具体的原子位置、盒子尺寸 ($L$)、成键截断半径 ($r_\\mathrm{c}$)、RDF 参数 ($\\Delta r$) 和 $S(q)$ 网格参数 ($q_{\\min}, q_{\\max}, \\Delta q$)。\n- **输出格式：** 对于每个用例，为 $[[n_3, ..., n_8], q_\\mathrm{FSDP}, q_\\mathrm{pred}]$。最终输出是这些结果的列表。\n\n**验证结论：**\n- **科学依据：** 该问题牢固地植根于凝聚态物理和材料科学中用于分析非晶体系的标准理论和计算方法。所有定义和公式（$g(r)$, $S(q)$, 最小镜像约定）都是标准的。环统计及其与 FSDP 的关系是该领域的基石。\n- **良构性：** 该问题提供了计算唯一解所需的所有数据和算法定义。步骤以清晰、顺序的方式描述。\n- **客观性：** 问题以精确、定量和无偏见的语言陈述。\n\n该问题没有违反任何无效标准。它是一个复杂但自洽且科学上合理的计算任务。因此，该问题是**有效的**。\n\n### 步骤 2：解决方案设计\n\n解决方案将作为一个 Python 脚本实现，并遵循指定的环境。一个主函数将协调处理每个测试用例。一个专门的函数 `process_case` 将对单个原子构型执行所需的算法步骤。\n\n**算法步骤：**\n\n1.  **图构建**：\n    - 对于每对原子 $(i, j)$，计算最小镜像距离 $r_{ij}$。\n    - 如果 $r_{ij} \\le r_c$，则创建一条边。此过程填充图的邻接列表、边列表，以及从每个边到唯一索引的映射。收集成键对的距离以计算平均键长 $a$。\n\n2.  **候选环生成**：\n    - 对于图中的每条边 $e=(u, v)$，我们在图 $G \\setminus \\{e\\}$ 中找到 $u$ 和 $v$ 之间的最短路径。这通过从 $u$ 开始的广度优先搜索 (BFS) 来完成，它系统地逐层探索图，以找到不使用边 $e$ 到达 $v$ 的最短路径。\n    - 如果找到路径，则将其与边 $e$ 组合形成一个环。为每个这样的环创建一个边关联向量（长度为 $|E|$ 的二元向量）。\n\n3.  **最小环基计算**：\n    - 候选环的集合通常是环空间的生成集，但不必是基，当然也不是权重最小的基。为了找到最小权重的基，采用贪心算法。\n    - 候选环按其长度（权重）升序排序。\n    - 我们遍历排序后的环。对于每个环，我们测试其关联向量是否与到目前为止找到的基向量线性无关。此检查通过使用异或 (XOR) 操作对向量与当前基进行约简来执行。\n    - 如果环是独立的，则将其长度添加到我们的基环长度列表中，并将此新独立维度的表示添加到我们的测试基中，该测试基维持在行阶梯形中，以确保后续独立性检查的高效性。\n\n4.  **环尺寸直方图**：\n    - 将计算出的基中环的长度制成尺寸为 $k=3, 4, ..., 8$ 的直方图。\n\n5.  **径向分布函数 ($g(r)$)**：\n    - 将所有唯一的成对距离 $r_{ij}$ 统计到宽度为 $\\Delta r$ 的区间中。\n    - 每个区间中的计数 $C_\\ell$ 根据提供的公式 $g(r_\\ell) \\approx \\frac{2 \\, C_\\ell}{N \\, \\rho \\, 4\\pi \\, r_\\ell^2 \\, \\Delta r}$ 进行归一化，其中 $\\rho = N/L^3$ 是数密度，$r_\\ell$ 是区间的中心。\n\n6.  **静态结构因子 ($S(q)$)**：\n    - 首先，计算总相关函数：$h(r) = g(r) - 1$。\n    - $S(q)$ 的积分被离散化为 RDF 区间上的黎曼和。对于指定网格上的每个波矢 $q$，我们计算 $S(q) = 1 + 4\\pi \\rho \\sum_\\ell r_\\ell^2 h(r_\\ell) \\frac{\\sin(q r_\\ell)}{q r_\\ell} \\Delta r$。$\\frac{\\sin(x)}{x}$ 项使用 `numpy.sinc` 小心处理，以避免在 $x=0$ 附近出现数值问题。\n\n7.  **FSDP 识别**：\n    - 扫描计算出的 $S(q)$ 曲线以寻找第一个局部最大值（一个点 $q_i$ 使得 $S(q_i)  S(q_{i-1})$ 且 $S(q_i)  S(q_{i+1})$）。\n    - 如果没有找到这样的峰，则将给定范围内 $S(q)$ 的全局最大值的位置作为 FSDP 位置。\n\n8.  **FSDP 预测**：\n    - 计算平均键长 $a$。\n    - 使用环直方图，计算加权平均环直径 $\\bar{D} = \\frac{\\sum_k n_k D_k}{\\sum_k n_k}$，其中 $D_k = a / \\sin(\\pi/k)$。\n    - 然后预测的 FSDP 位置是 $q_\\mathrm{pred} = 2\\pi / \\bar{D}$。如果未找到环，则按惯例将 $q_\\mathrm{pred}$ 设置为 0。\n\n9.  **输出格式化**：\n    - 将每个测试用例的最终结果——环直方图、$q_\\mathrm{FSDP}$ 和 $q_\\mathrm{pred}$——组装成指定的列表格式。浮点值四舍五入到三位小数。最终的输出字符串的构造不带任何空格，以精确匹配所需格式。", "answer": "[[[0,0,0,1,0,0],2.150,1.963],[[0,0,1,0,1,0],1.900,1.868],[[0,0,0,0,0,0],4.750,0.000]]", "id": "2468330"}, {"introduction": "在理解了玻璃的静态结构之后，我们将注意力转向其形成的动力学过程。本练习要求您分析过冷液体的粘度数据，以构建 Angell 图——这是将玻璃形成液体分为“强”和“脆”两类的关键工具[@problem_id:2468331]。通过计算脆性指数 $m$，您将能够定量地理解当液体冷却并接近玻璃化转变时，其动力学行为呈现的巨大差异。", "problem": "两种过冷液体，记为液体 A 和液体 B，其黏度作为温度的函数已在平衡过冷区被测量。请使用以下信息，从安格尔图的角度分析它们的脆性。\n\n使用的基本定义：\n- 玻璃化转变温度 $T_{g}$ 在操作上定义为黏度 $\\eta$ 在平衡状态下达到 $10^{12}$ Pa·s 时的温度。\n- 安格尔图（Angell plot）是 $y \\equiv \\log_{10}\\!\\big(\\eta/(\\mathrm{Pa}\\cdot\\mathrm{s})\\big)$ 相对于 $x \\equiv T_{g}/T$ 的图像。\n- 动力学脆性指数 $m$ 定义为斜率 $m \\equiv \\left.\\dfrac{d\\,\\log_{10}\\eta}{d\\,(T_{g}/T)}\\right|_{x=1}$，从平衡液体侧（即 $T \\ge T_{g}$）进行评估。\n\n数据（温度单位为开尔文，黏度单位为 Pa·s）：\n- 液体 A：\n  - $T = 320$，$\\eta = 10^{12}$\n  - $T = 330$，$\\eta = 10^{107/11}$\n  - $T = 340$，$\\eta = 10^{129/17}$\n  - $T = 360$，$\\eta = 10^{11/3}$\n  - $T = 380$，$\\eta = 10^{3/19}$\n- 液体 B：\n  - $T = 280$，$\\eta = 10^{12}$\n  - $T = 290$，$\\eta = 10^{328/29}$\n  - $T = 300$，$\\eta = 10^{32/3}$\n  - $T = 320$，$\\eta = 10^{19/2}$\n  - $T = 340$，$\\eta = 10^{144/17}$\n\n任务：\n1) 对于每种液体，使用所述的操作性定义从数据中确定 $T_{g}$。\n2) 对于最接近 $T_{g}$ 的三个平衡点（$T \\ge T_{g}$，包括 $T=T_{g}$），构建安格尔变量 $x \\equiv T_{g}/T$ 和 $y \\equiv \\log_{10}\\!\\big(\\eta/(\\mathrm{Pa}\\cdot\\mathrm{s})\\big)$，并通过对这三点进行普通最小二乘线性拟合 $y \\approx a + m x$ 来估计在 $x=1$ 处的斜率。将拟合得到的斜率作为该液体的脆性指数 $m$。\n3) 通过比较 $m$ 的值来判断哪种液体更脆。\n\n请以有序对 $(m_{A}, m_{B})$ 的形式报告你最终的脆性指数。脆性指数是无量纲的。将你的最终数值四舍五入到三位有效数字。在你报告的最终有序对中不要包含任何单位。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n步骤 1：提取给定信息\n- 玻璃化转变温度 $T_{g}$ 的定义：黏度 $\\eta = 10^{12}$ Pa·s 时的温度 $T$。\n- 安格尔图变量的定义：$y \\equiv \\log_{10}\\!\\big(\\eta/(\\mathrm{Pa}\\cdot\\mathrm{s})\\big)$ 和 $x \\equiv T_{g}/T$。\n- 动力学脆性指数 $m$ 的定义：$m \\equiv \\left.\\dfrac{d\\,\\log_{10}\\eta}{d\\,(T_{g}/T)}\\right|_{x=1}$。\n- 液体 A 的数据（T 单位为开尔文，$\\eta$ 单位为 Pa·s）：\n  - ($T=320$，$\\eta=10^{12}$)\n  - ($T=330$，$\\eta=10^{107/11}$)\n  - ($T=340$，$\\eta=10^{129/17}$)\n  - ($T=360$，$\\eta=10^{11/3}$)\n  - ($T=380$，$\\eta=10^{3/19}$)\n- 液体 B 的数据（T 单位为开尔文，$\\eta$ 单位为 Pa·s）：\n  - ($T=280$，$\\eta=10^{12}$)\n  - ($T=290$，$\\eta=10^{328/29}$)\n  - ($T=300$，$\\eta=10^{32/3}$)\n  - ($T=320$，$\\eta=10^{19/2}$)\n  - ($T=340$，$\\eta=10^{144/17}$)\n- 指示：使用 $T \\ge T_{g}$ 且最接近 $T_{g}$ 的三个数据点，通过形式为 $y \\approx a + m x$ 的普通最小二乘（OLS）线性拟合来估计 $m$。\n- 指示：以有序对 $(m_{A}, m_{B})$ 的形式报告结果，四舍五入到三位有效数字。\n\n步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，使用了材料化学和凝聚态物理学中的标准定义（玻璃化转变、脆性、安格尔图）。数据在物理上是一致的：对于两种液体，黏度都随着温度的升高而降低。问题是适定的，提供了所有必要的数据和清晰、客观的程序（OLS）以找到唯一解。它没有歧义、矛盾或不可形式化的部分。\n\n步骤 3：结论和行动\n问题有效。将提供解答。\n\n任务是分别计算液体 A 和液体 B 的脆性指数 $m_{A}$ 和 $m_{B}$。\n\n首先，根据操作性定义 $\\eta(T_{g}) = 10^{12}$ Pa·s，确定每种液体的玻璃化转变温度 $T_{g}$。\n对于液体 A，数据点 ($T=320$ K, $\\eta=10^{12}$ Pa·s) 意味着 $T_{g,A} = 320$ K。\n对于液体 B，数据点 ($T=280$ K, $\\eta=10^{12}$ Pa·s) 意味着 $T_{g,B} = 280$ K。\n\n脆性指数 $m$ 是通过对 $T \\ge T_g$ 且最接近 $T_g$ 的三个数据点进行线性拟合 $y = a + mx$ 来估计的。对于一组 $N$ 个点 $(x_i, y_i)$，通过普通最小二乘回归计算斜率 $m$ 的公式是：\n$$m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2}$$\n\n液体 A 的计算：\n需要使用的三个点是 $T = 320$ K, $T = 330$ K 和 $T = 340$ K。我们构建安格尔图变量 $x_i = T_{g,A}/T_i$ 和 $y_i = \\log_{10}(\\eta_i)$。\n1.  $T_1 = 320$：$x_1 = 320/320 = 1$， $y_1 = \\log_{10}(10^{12}) = 12$。\n2.  $T_2 = 330$：$x_2 = 320/330 = 32/33$， $y_2 = \\log_{10}(10^{107/11}) = 107/11$。\n3.  $T_3 = 340$：$x_3 = 320/340 = 16/17$， $y_3 = \\log_{10}(10^{129/17}) = 129/17$。\n\n为了简化 OLS 计算，我们引入一个移位变量 $u = 1 - x$。回归 $y = a + m x$ 变为 $y = a + m(1-u) = (a+m) - mu$。这是 $y$ 对 $u$ 的线性回归，斜率为 $m' = -m$。由于其中一个 $u_i$ 值为零，OLS 计算更简单。然后斜率 $m$ 可以通过 $m = -m'$ 恢复。\n数据点在 $(u,y)$ 坐标系中为：\n1.  $u_1 = 1 - 1 = 0$, $y_1 = 12$。\n2.  $u_2 = 1 - 32/33 = 1/33$, $y_2 = 107/11$。\n3.  $u_3 = 1 - 16/17 = 1/17$, $y_3 = 129/17$。\n\n我们计算 $N=3$ 所需的各项和：\n$\\sum u_i = 0 + \\frac{1}{33} + \\frac{1}{17} = \\frac{17+33}{561} = \\frac{50}{561}$。\n$\\sum y_i = 12 + \\frac{107}{11} + \\frac{129}{17} = \\frac{12 \\cdot 187 + 107 \\cdot 17 + 129 \\cdot 11}{187} = \\frac{2244 + 1819 + 1419}{187} = \\frac{5482}{187}$。\n$\\sum u_i^2 = 0^2 + (\\frac{1}{33})^2 + (\\frac{1}{17})^2 = \\frac{1}{1089} + \\frac{1}{289} = \\frac{289 + 1089}{314721} = \\frac{1378}{314721}$。\n$\\sum u_i y_i = 0 \\cdot 12 + \\frac{1}{33} \\cdot \\frac{107}{11} + \\frac{1}{17} \\cdot \\frac{129}{17} = \\frac{107}{363} + \\frac{129}{289} = \\frac{107 \\cdot 289 + 129 \\cdot 363}{104907} = \\frac{30923 + 46827}{104907} = \\frac{77750}{104907}$。\n\n斜率 $m'$ 是：\n$m' = \\frac{N \\sum(u_i y_i) - (\\sum u_i)(\\sum y_i)}{N \\sum(u_i^2) - (\\sum u_i)^2}$\n分子：$3 \\cdot \\frac{77750}{104907} - \\frac{50}{561} \\cdot \\frac{5482}{187} = \\frac{3 \\cdot 77750 - 50 \\cdot 5482}{104907} = \\frac{233250 - 274100}{104907} = \\frac{-40850}{104907}$。\n分母：$3 \\cdot \\frac{1378}{314721} - (\\frac{50}{561})^2 = \\frac{3 \\cdot 1378 - 50^2}{561^2} = \\frac{4134 - 2500}{314721} = \\frac{1634}{314721}$。\n$m' = \\frac{-40850/104907}{1634/314721} = \\frac{-40850}{104907} \\cdot \\frac{314721}{1634} = \\frac{-40850 \\cdot 3}{1634} = \\frac{-122550}{1634} = -75$。\n液体 A 的脆性指数是 $m_A = -m' = 75$。\n\n液体 B 的计算：\n需要使用的三个点是 $T = 280$ K, $T = 290$ K 和 $T = 300$ K。\n$T_{g,B} = 280$ K。\n1.  $T_1 = 280$：$x_1 = 280/280=1$, $y_1 = 12$。\n2.  $T_2 = 290$：$x_2 = 280/290 = 28/29$, $y_2 = 328/29$。\n3.  $T_3 = 300$：$x_3 = 280/300 = 14/15$, $y_3 = 32/3$。\n\n使用移位变量 $u = 1-x$：\n1.  $u_1 = 0$, $y_1 = 12$。\n2.  $u_2 = 1 - 28/29 = 1/29$, $y_2 = 328/29$。\n3.  $u_3 = 1 - 14/15 = 1/15$, $y_3 = 32/3$。\n\n我们计算 $N=3$ 所需的各项和：\n$\\sum u_i = 0 + \\frac{1}{29} + \\frac{1}{15} = \\frac{15+29}{435} = \\frac{44}{435}$。\n$\\sum y_i = 12 + \\frac{328}{29} + \\frac{32}{3} = \\frac{12 \\cdot 87 + 328 \\cdot 3 + 32 \\cdot 29}{87} = \\frac{1044 + 984 + 928}{87} = \\frac{2956}{87}$。\n$\\sum u_i^2 = 0^2 + (\\frac{1}{29})^2 + (\\frac{1}{15})^2 = \\frac{1}{841} + \\frac{1}{225} = \\frac{225 + 841}{189225} = \\frac{1066}{189225}$。\n$\\sum u_i y_i = 0 \\cdot 12 + \\frac{1}{29} \\cdot \\frac{328}{29} + \\frac{1}{15} \\cdot \\frac{32}{3} = \\frac{328}{841} + \\frac{32}{45} = \\frac{328 \\cdot 45 + 32 \\cdot 841}{37845} = \\frac{14760 + 26912}{37845} = \\frac{41672}{37845}$。\n\n斜率 $m'$ 是：\n分子：$3 \\cdot \\frac{41672}{37845} - \\frac{44}{435} \\cdot \\frac{2956}{87} = \\frac{3 \\cdot 41672 - 44 \\cdot 2956}{37845} = \\frac{125016 - 130064}{37845} = \\frac{-5048}{37845}$。\n分母：$3 \\cdot \\frac{1066}{189225} - (\\frac{44}{435})^2 = \\frac{3 \\cdot 1066 - 44^2}{435^2} = \\frac{3198 - 1936}{189225} = \\frac{1262}{189225}$。\n$m' = \\frac{-5048/37845}{1262/189225} = \\frac{-5048}{37845} \\cdot \\frac{189225}{1262} = \\frac{-5048 \\cdot 5}{1262} = \\frac{-25240}{1262} = -20$。\n液体 B 的脆性指数是 $m_B = -m' = 20$。\n\n比较与最终答案：\n液体 A 的脆性指数是 $m_A = 75$。\n液体 B 的脆性指数是 $m_B = 20$。\n由于 $m_A  m_B$，液体 A 比液体 B 更脆。液体 B 表现出更接近“强”液体的行为。\n\n问题要求最终答案四舍五入到三位有效数字。\n$m_A = 75.0$。\n$m_B = 20.0$。\n有序对是 $(75.0, 20.0)$。", "answer": "$$\n\\boxed{(75.0, 20.0)}\n$$", "id": "2468331"}]}