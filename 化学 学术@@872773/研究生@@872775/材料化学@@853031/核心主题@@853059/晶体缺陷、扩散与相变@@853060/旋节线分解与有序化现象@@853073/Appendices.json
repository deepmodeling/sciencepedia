{"hands_on_practices": [{"introduction": "深入理解相图是材料科学的核心，而临界点是理解相分离行为的起点。本练习将指导你应用正则溶液模型，通过分析自由能曲线的曲率，从热力学第一性原理出发，确定固溶体中混溶间隙出现的临界温度 $T_c$ 和组分 $c_c$ ([@problem_id:2524752])。这项基本技能对于预测和控制材料的相变至关重要，它将抽象的自由能概念与相图上可测量的关键特征联系起来。", "problem": "一种由 $A$ 和 $B$ 两种组分在刚性晶格上构成的二元置换合金，在 Bragg–Williams (BW) 平均场框架内被建模为对称正规溶体。每个晶格点的混合亥姆霍兹自由能 $f(c,T)$，作为组分 $A$ 的原子分数 $c \\in (0,1)$ 和绝对温度 $T$ 的函数，由理想构型熵和平均场焓的总和给出，该焓由一个与温度无关的正值正规溶体参数 $\\Omega$ 表征：\n$$\nf(c,T) \\;=\\; k_{B} T \\left[ c \\ln c \\;+\\; (1-c)\\,\\ln(1-c) \\right] \\;+\\; \\Omega\\, c(1-c),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数。假设 $\\Omega0$ 并忽略所有其他贡献（例如，弹性、梯度或振动项）。\n\n使用相分离的基本热力学稳定性判据，确定定义该模型中不互溶间隙首次出现的唯一临界点的数学条件，然后以闭合形式确定临界温度和临界组分 $(T_{c},c_{c})$。将临界温度以开尔文表示，同时保持 $k_{B}$ 和 $\\Omega$ 为符号形式，并将有序对 $(T_{c},c_{c})$ 表示为单行矩阵。无需进行数值四舍五入。在最终的方框答案中不要包含单位。", "solution": "所述问题是有效的。这是一个源于经典材料热力学，特别是溶体理论的适定且有科学依据的问题。它没有歧义、矛盾和事实错误。我现在开始解答。\n\n该系统由对称正规溶体的每个晶格点的混合亥姆霍兹自由能 $f(c,T)$ 描述：\n$$\nf(c,T) = k_{B} T \\left[ c \\ln c + (1-c)\\ln(1-c) \\right] + \\Omega c(1-c)\n$$\n其中 $c$ 是组分， $T$ 是温度， $k_{B}$ 是玻尔兹曼常数， $\\Omega  0$ 是正规溶体参数。\n\n抵抗组分涨落的局部稳定性的热力学条件是自由能曲线必须是凸的，这在数学上等价于自由能对组分的二阶导数为正：\n$$\n\\frac{\\partial^2 f}{\\partial c^2}  0\n$$\n这种稳定性的极限，称为亚稳相分解曲线（spinodal curve），是自由能函数的曲率为零之处：\n$$\n\\frac{\\partial^2 f}{\\partial c^2} = 0\n$$\n临界点 $(T_{c}, c_{c})$ 是相图上的一个唯一点，在该点冷却时首次出现不互溶间隙。它是亚稳相分解曲线上的最高温度。在这个特定点，自由能函数不仅处于拐点，而且该拐点本身是平坦的。这施加了一个更严格的数学条件：自由能对组分的三阶导数也必须为零。\n$$\n\\frac{\\partial^3 f}{\\partial c^3} = 0\n$$\n因此，临界点由以下两个条件的联立解唯一确定：$\\frac{\\partial^2 f}{\\partial c^2} = 0$ 和 $\\frac{\\partial^3 f}{\\partial c^3} = 0$。\n\n首先，我们必须计算 $f(c,T)$ 对 $c$ 的所需偏导数。\n\n一阶导数为：\n$$\n\\frac{\\partial f}{\\partial c} = \\frac{\\partial}{\\partial c} \\left( k_{B} T \\left[ c \\ln c + (1-c)\\ln(1-c) \\right] + \\Omega(c-c^2) \\right)\n$$\n$$\n\\frac{\\partial f}{\\partial c} = k_{B} T \\left[ (\\ln c + c\\frac{1}{c}) + (-\\ln(1-c) + (1-c)\\frac{-1}{1-c}) \\right] + \\Omega(1-2c)\n$$\n$$\n\\frac{\\partial f}{\\partial c} = k_{B} T \\left[ \\ln c - \\ln(1-c) \\right] + \\Omega(1-2c) = k_{B} T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1-2c)\n$$\n\n二阶导数为：\n$$\n\\frac{\\partial^2 f}{\\partial c^2} = \\frac{\\partial}{\\partial c} \\left( k_{B} T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1-2c) \\right)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial c^2} = k_{B} T \\left( \\frac{1}{c} - \\frac{-1}{1-c} \\right) - 2\\Omega = k_{B} T \\left( \\frac{1}{c} + \\frac{1}{1-c} \\right) - 2\\Omega\n$$\n$$\n\\frac{\\partial^2 f}{\\partial c^2} = k_{B} T \\left( \\frac{1-c+c}{c(1-c)} \\right) - 2\\Omega = \\frac{k_{B} T}{c(1-c)} - 2\\Omega\n$$\n\n三阶导数为：\n$$\n\\frac{\\partial^3 f}{\\partial c^3} = \\frac{\\partial}{\\partial c} \\left( \\frac{k_{B} T}{c-c^2} - 2\\Omega \\right) = k_{B} T \\frac{\\partial}{\\partial c} \\left( (c-c^2)^{-1} \\right)\n$$\n$$\n\\frac{\\partial^3 f}{\\partial c^3} = k_{B} T \\left[ -1(c-c^2)^{-2}(1-2c) \\right] = -k_{B} T \\frac{1-2c}{\\left(c(1-c)\\right)^2}\n$$\n\n现在，我们应用临界点 $(T_{c}, c_{c})$ 的条件。我们首先使用条件 $\\frac{\\partial^3 f}{\\partial c^3} = 0$ 来求临界组分 $c_{c}$。\n$$\n-k_{B} T_{c} \\frac{1-2c_{c}}{\\left(c_{c}(1-c_{c})\\right)^2} = 0\n$$\n对于一个有物理意义的解，$T_{c}  0$ 且 $c_{c} \\in (0,1)$，这意味着分母不为零。只有当分子为零时，方程才成立：\n$$\n1-2c_{c} = 0 \\implies c_{c} = \\frac{1}{2}\n$$\n由于正规溶体模型的对称性，这个结果是预料之中的。\n\n接下来，我们使用第二个条件 $\\frac{\\partial^2 f}{\\partial c^2} = 0$ 来求临界温度 $T_{c}$。我们在临界组分 $c_{c} = \\frac{1}{2}$ 处评估此条件：\n$$\n\\left. \\frac{\\partial^2 f}{\\partial c^2} \\right|_{(T_c, c_c)} = \\frac{k_{B} T_{c}}{c_{c}(1-c_{c})} - 2\\Omega = 0\n$$\n代入 $c_{c} = \\frac{1}{2}$：\n$$\n\\frac{k_{B} T_{c}}{\\frac{1}{2}\\left(1-\\frac{1}{2}\\right)} - 2\\Omega = 0\n$$\n$$\n\\frac{k_{B} T_{c}}{\\frac{1}{4}} - 2\\Omega = 0\n$$\n$$\n4k_{B} T_{c} - 2\\Omega = 0\n$$\n$$\n4k_{B} T_{c} = 2\\Omega\n$$\n求解 $T_{c}$ 得：\n$$\nT_{c} = \\frac{2\\Omega}{4k_{B}} = \\frac{\\Omega}{2k_{B}}\n$$\n由于 $\\Omega  0$ 和 $k_B  0$，临界温度 $T_c$ 为正值，这在物理上是正确的。\n\n因此，唯一临界点位于组分 $c_{c} = \\frac{1}{2}$ 和温度 $T_{c} = \\frac{\\Omega}{2k_{B}}$ 处。题目要求将有序对 $(T_{c}, c_{c})$ 表示为单行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\Omega}{2k_{B}}  \\frac{1}{2} \\end{pmatrix}}$$", "id": "2524752"}, {"introduction": "在确定了相分离的热力学条件后，即自由能对组分的二阶导数小于零 ($f''(c_0) \\lt 0$) 的区域，我们转向动力学问题：相分离是如何随时间演变的？本练习通过对 Cahn-Hilliard 方程进行线性稳定性分析，揭示了旋节线分解的早期阶段特征 ([@problem_id:2524717])。你将通过无量纲化推导出决定新生相畴特征尺寸的色散关系，这种分析是理解和设计具有特定纳米尺度微结构材料的关键。", "problem": "在二元合金中，一个守恒的序参量场 $c(\\mathbf{x},t)$ 由Cahn-Hilliard (CH) 方程控制，该方程结合了质量守恒和由化学势梯度驱动通量的本构关系。其控制方程为\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right),\n\\qquad\n\\mu \\;=\\; \\frac{\\partial f}{\\partial c} \\;-\\; \\kappa \\,\\nabla^{2} c,\n$$\n其中 $M$ 是一个常数迁移率，$\\kappa$ 是一个正的梯度能量系数，$f(c)$ 是均匀自由能密度。考虑在旋节线区域内的一个均匀态 $c_{0}$，使得 $f''(c_{0})0$。假设存在小振幅涨落 $\\delta c = c - c_{0}$，使得 $\\frac{\\partial f}{\\partial c} \\approx f''(c_{0})\\,\\delta c$。\n\n使用特征长度 $\\ell_{0} = \\sqrt{\\kappa/|f''(c_{0})|}$ 和特征时间 $t_{0} = \\ell_{0}^{2}/\\left(M\\,|f''(c_{0})|\\right)$，通过引入标度化变量 $\\tilde{\\mathbf{x}} = \\mathbf{x}/\\ell_{0}$、$\\tilde{t} = t/t_{0}$ 和 $\\tilde{c} = \\delta c / c_{\\star}$（其中 $c_{\\star}$ 为任意浓度标度），对线性化的CH方程进行无量纲化。找出该线性化、无量纲化方程中产生的所有无量纲群，并说明是否还存在自由参数。\n\n然后，通过寻找形式为 $\\tilde{c}(\\tilde{\\mathbf{x}},\\tilde{t}) = \\hat{c}\\,\\exp\\!\\left(\\mathrm{i}\\,\\tilde{\\mathbf{k}}\\cdot \\tilde{\\mathbf{x}} + \\tilde{\\omega}\\,\\tilde{t}\\right)$ 的简正模（其中无量纲波数大小为 $\\tilde{k}=|\\tilde{\\mathbf{k}}|$），对 $\\tilde{c}=0$ 进行线性稳定性分析。确定无量纲色散关系 $\\tilde{\\omega}(\\tilde{k})$，并找出在所有 $\\tilde{k}$ 上的最大增长率 $\\tilde{\\omega}_{\\max}$。\n\n请给出最大无量纲增长率 $\\tilde{\\omega}_{\\max}$ 的值作为最终答案，该值为一个精确数，不带单位。无需四舍五入。", "solution": "出发点是质量守恒和通量与化学势梯度成正比的本构关系。这些共同给出了Cahn-Hilliard (CH)方程，\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right),\n\\qquad\n\\mu \\;=\\; \\frac{\\partial f}{\\partial c} \\;-\\; \\kappa \\,\\nabla^{2} c.\n$$\n考虑旋节线内部的一个均匀基态 $c_{0}$，使得 $f''(c_{0})0$。对于小涨落 $\\delta c = c - c_{0}$，将化学势展开到线性阶：\n$$\n\\mu \\;\\approx\\; f'(c_{0}) \\;+\\; f''(c_{0})\\,\\delta c \\;-\\; \\kappa \\,\\nabla^{2}\\delta c.\n$$\n常数 $f'(c_{0})$ 对通量没有贡献，因此 $\\delta c$ 的线性化方程为\n$$\n\\frac{\\partial (\\delta c)}{\\partial t} \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\left[ f''(c_{0})\\,\\delta c \\;-\\; \\kappa \\,\\nabla^{2}\\delta c \\right] \\right).\n$$\n\n引入特征尺度\n$$\n\\ell_{0} \\;=\\; \\sqrt{\\frac{\\kappa}{|f''(c_{0})|}}, \n\\qquad\nt_{0} \\;=\\; \\frac{\\ell_{0}^{2}}{M\\,|f''(c_{0})|} \\;=\\; \\frac{\\kappa}{M\\,|f''(c_{0})|^{2}},\n$$\n以及无量纲变量\n$$\n\\tilde{\\mathbf{x}} \\;=\\; \\frac{\\mathbf{x}}{\\ell_{0}}, \n\\qquad \n\\tilde{t} \\;=\\; \\frac{t}{t_{0}}, \n\\qquad \n\\tilde{c} \\;=\\; \\frac{\\delta c}{c_{\\star}},\n$$\n其中 $c_{\\star}$ 为任意浓度标度。空间导数变换为 $\\nabla = \\ell_{0}^{-1}\\,\\tilde{\\nabla}$ 和 $\\nabla^{2} = \\ell_{0}^{-2}\\,\\tilde{\\nabla}^{2}$，时间导数变换为 $\\partial/\\partial t = t_{0}^{-1}\\,\\partial/\\partial \\tilde{t}$。代入并化简，\n\n$$\n\\begin{aligned}\n\\frac{\\partial (c_{\\star}\\tilde{c})}{\\partial (t_{0}\\tilde{t})}\n= \\nabla \\cdot \\left( M \\,\\nabla \\left[ f''(c_{0})\\,c_{\\star}\\tilde{c} \\;-\\; \\kappa \\,\\nabla^{2}(c_{\\star}\\tilde{c}) \\right] \\right) \\\\\n\\frac{c_{\\star}}{t_{0}} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n= \\left(\\frac{1}{\\ell_{0}}\\tilde{\\nabla}\\right) \\cdot \\left( M \\left(\\frac{1}{\\ell_{0}}\\tilde{\\nabla}\\right) \\left[ f''(c_{0})\\,c_{\\star}\\tilde{c} \\;-\\; \\kappa \\left(\\frac{1}{\\ell_{0}^{2}}\\tilde{\\nabla}^{2}\\right)(c_{\\star}\\tilde{c}) \\right] \\right) \\\\\n\\frac{c_{\\star}}{t_{0}} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n= \\frac{M\\,c_{\\star}}{\\ell_{0}^{2}} \\,\\tilde{\\nabla} \\cdot \\left( \\tilde{\\nabla} \\left[ f''(c_{0})\\,\\tilde{c} \\;-\\; \\frac{\\kappa}{\\ell_{0}^{2}} \\,\\tilde{\\nabla}^{2}\\tilde{c} \\right] \\right).\n\\end{aligned}\n$$\n\n消去 $c_{\\star}$ 并使用 $\\ell_{0}$ 和 $t_{0}$ 的定义，\n\n$$\n\\begin{aligned}\n\\frac{1}{t_{0}} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n= \\frac{M}{\\ell_{0}^{2}} \\,\\tilde{\\nabla}^{2} \\left( f''(c_{0})\\,\\tilde{c} \\;-\\; \\frac{\\kappa}{\\ell_{0}^{2}} \\,\\tilde{\\nabla}^{2}\\tilde{c} \\right) \\\\\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n= \\left(\\frac{M\\,t_{0}}{\\ell_{0}^{2}}\\right) \\,\\tilde{\\nabla}^{2} \\left( f''(c_{0})\\,\\tilde{c} \\;-\\; \\frac{\\kappa}{\\ell_{0}^{2}} \\,\\tilde{\\nabla}^{2}\\tilde{c} \\right).\n\\end{aligned}\n$$\n\n利用 $t_{0}=\\ell_{0}^{2}/(M\\,|f''(c_{0})|)$ 和 $\\kappa/\\ell_{0}^{2}=|f''(c_{0})|$，我们得到\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n\\;=\\; \\frac{M\\,\\ell_{0}^{2}}{M\\,|f''(c_{0})|\\,\\ell_{0}^{2}} \\,\\tilde{\\nabla}^{2} \\left( f''(c_{0})\\,\\tilde{c} \\;-\\; |f''(c_{0})| \\,\\tilde{\\nabla}^{2}\\tilde{c} \\right)\n\\;=\\; \\tilde{\\nabla}^{2} \\left( \\frac{f''(c_{0})}{|f''(c_{0})|}\\,\\tilde{c} \\;-\\; \\tilde{\\nabla}^{2}\\tilde{c} \\right).\n$$\n定义符号参数 $\\sigma \\equiv f''(c_{0})/|f''(c_{0})|$，在旋节线区域内其值为 $-1$。因此，无量纲化的线性CH方程为\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n\\;=\\; \\tilde{\\nabla}^{2} \\left( \\sigma\\,\\tilde{c} \\;-\\; \\tilde{\\nabla}^{2}\\tilde{c} \\right).\n$$\n无量纲群的识别：经过所选的标度变换后，所有材料参数 $M$、$\\kappa$ 和 $|f''(c_{0})|$ 都被消去了。线性化方程中唯一剩下的无量纲量是符号 $\\sigma$，它表示系统是处于旋节线内部 ($\\sigma=-1$) 还是外部 ($\\sigma=+1$)。在旋节线内部 ($\\sigma=-1$)，方便起见，可以通过分解符号来重写方程：\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n\\;=\\; \\tilde{\\nabla}^{2} \\left( -\\tilde{c} \\;-\\; \\tilde{\\nabla}^{2}\\tilde{c} \\right)\n\\;=\\; -\\tilde{\\nabla}^{2} \\left( \\tilde{c} \\;+\\; \\tilde{\\nabla}^{2}\\tilde{c} \\right)\n$$\n如果需要，可以重新定义 $\\tilde{c}\\to -\\tilde{c}$。无论哪种情况，都不再有自由的量级类型的参数；线性化动力学在无量纲形式下是无参数的。\n\n为了获得色散关系，我们寻找形式为 $\\tilde{c}(\\tilde{\\mathbf{x}},\\tilde{t}) = \\hat{c}\\,\\exp\\!\\left(\\mathrm{i}\\,\\tilde{\\mathbf{k}}\\cdot \\tilde{\\mathbf{x}} + \\tilde{\\omega}\\,\\tilde{t}\\right)$ 的简正模，其中 $\\tilde{k}=|\\tilde{\\mathbf{k}}|$。使用 $\\tilde{\\nabla} \\to \\mathrm{i}\\,\\tilde{\\mathbf{k}}$ 和 $\\tilde{\\nabla}^{2} \\to -\\tilde{k}^{2}$，代入\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}}\n\\;=\\; -\\tilde{\\nabla}^{2} \\left( \\tilde{c} \\;+\\; \\tilde{\\nabla}^{2}\\tilde{c} \\right)\n$$\n得到\n\n$$\n\\begin{aligned}\n\\tilde{\\omega}\\,\\hat{c}\n= -(-\\tilde{k}^{2}) \\left( \\hat{c} \\;+\\; (-\\tilde{k}^{2})\\,\\hat{c} \\right)\n= \\tilde{k}^{2} \\left( \\hat{c} \\;-\\; \\tilde{k}^{2}\\,\\hat{c} \\right)\n= \\tilde{k}^{2}\\left( 1 \\;-\\; \\tilde{k}^{2} \\right)\\hat{c}.\n\\end{aligned}\n$$\n\n因此，无量纲色散关系为\n$$\n\\tilde{\\omega}(\\tilde{k}) \\;=\\; \\tilde{k}^{2}\\left( 1 \\;-\\; \\tilde{k}^{2} \\right).\n$$\n为了找到最大增长率，对 $\\tilde{k}\\ge 0$ 的 $\\tilde{\\omega}(\\tilde{k})$ 求最大值。对 $\\tilde{k}$ 求导：\n$$\n\\frac{d\\tilde{\\omega}}{d\\tilde{k}} \\;=\\; 2\\tilde{k}\\left(1 \\;-\\; \\tilde{k}^{2}\\right) \\;+\\; \\tilde{k}^{2}(-2\\tilde{k})\n\\;=\\; 2\\tilde{k}\\left(1 \\;-\\; 2\\tilde{k}^{2}\\right).\n$$\n令 $d\\tilde{\\omega}/d\\tilde{k}=0$ 得到驻点 $\\tilde{k}=0$ 和 $\\tilde{k}^{2}=1/2$。点 $\\tilde{k}=0$ 给出 $\\tilde{\\omega}=0$；内部最大值点在 $\\tilde{k}=\\frac{1}{\\sqrt{2}}$。在此处计算 $\\tilde{\\omega}$ 的值，\n$$\n\\tilde{\\omega}_{\\max} \\;=\\; \\left(\\frac{1}{\\sqrt{2}}\\right)^{2} \\left( 1 \\;-\\; \\left(\\frac{1}{\\sqrt{2}}\\right)^{2} \\right)\n\\;=\\; \\frac{1}{2}\\left(1 \\;-\\; \\frac{1}{2}\\right)\n\\;=\\; \\frac{1}{4}.\n$$\n因此，最大无量纲增长率为 $\\tilde{\\omega}_{\\max} = 1/4$，在无量纲波数 $\\tilde{k} = 1/\\sqrt{2}$ 处取得。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2524717"}, {"introduction": "真实的材料系统通常涉及多种相互作用的物理过程，例如相分离和原子有序化。在这个综合性练习中，你将设计并实现一个能够模拟这种耦合动力学的数值方案，并确保其在离散层面严格遵守质量守恒和能量耗散等基本物理定律 ([@problem_id:2524728])。这项实践让你掌握了计算材料科学中的前沿工具，能够用于研究和预测复杂微观结构的形成过程，完美地将理论知识转化为可执行的计算模型。", "problem": "考虑一个长度为 $L_x$ 的一维周期性区域，其坐标为 $x \\in [0,L_x]$。令 $c(x,t)$ 为一个守恒的组分场，$\\eta(x,t)$ 为一个非守恒的有序场。总自由能泛函为\n$$\nF[c,\\eta] \\;=\\; \\int_0^{L_x} \\left( f_0(c,\\eta) \\;+\\; \\frac{\\kappa_c}{2}\\,\\lvert \\partial_x c \\rvert^2 \\;+\\; \\frac{\\kappa_\\eta}{2}\\,\\lvert \\partial_x \\eta \\rvert^2 \\right)\\,dx,\n$$\n其中局域自由能密度为\n$$\nf_0(c,\\eta) \\;=\\; \\frac{1}{4}\\,\\big(c^2-1\\big)^2 \\;+\\; \\frac{a}{2}\\,\\eta^2 \\;+\\; \\frac{b}{4}\\,\\eta^4 \\;+\\; \\gamma\\,c\\,\\eta.\n$$\n化学势定义为变分导数 $\\mu_c = \\delta F/\\delta c$ 和 $\\mu_\\eta = \\delta F/\\delta \\eta$。材料动力学由一个针对 $c$ 的守恒型 Cahn–Hilliard 方程和一个针对 $\\eta$ 的非守恒型 Allen–Cahn 方程给出，\n$$\n\\partial_t c \\;=\\; \\nabla\\cdot\\big(M\\,\\nabla \\mu_c\\big), \n\\qquad\n\\partial_t \\eta \\;=\\; -\\mathcal{L}\\,\\mu_\\eta,\n$$\n其中 $c$ 的迁移率为常数 $M$，$\\eta$ 的动力学系数为常数 $\\mathcal{L}$，且在 $[0,L_x]$ 上具有周期性边界条件。梯度算子 $\\nabla$ 和拉普拉斯算子 $\\nabla^2$ 在一维情况下表示对 $x$ 的导数。\n\n你的任务是设计并实现一个完全离散的数值格式，该格式对所有时间步长同时满足以下两个性质：\n- 对 $c$ 的离散质量守恒，即在周期性边界条件下，$c$ 的空间平均值不随时间变化。\n- 对总自由能 $F$ 的离散能量耗散，即离散的总自由能不随时间增加。\n\n设计必须从第一性原理出发：(i) 变分化学势 $\\mu_c$ 和 $\\mu_\\eta$ 的定义，(ii) 演化方程的梯度流结构，以及 (iii) 周期性边界条件。你不能假设或引用任何现成的离散化公式；必须从这些基础上逻辑地推导出你的格式。该格式必须能在均匀空间网格和恒定时间步长下实现，并且其算法必须足够明确，以便任何开发者都能复现。\n\n空间离散化在周期性边界条件下应具有谱精度（例如，使用离散傅里叶变换），或者在完全离散的层面上，能被证明与所需的两个不变量一致。时间积分必须具有一阶或更高阶的精度。所得程序必须通过在每个时间步计算 $c$ 的离散质量和离散总自由能 $F$ 来数值验证这两个性质。\n\n初始条件。对 $c$ 使用具有非零平均值的确定性光滑初始场：\n- $c(x,0) \\,=\\, c_0 \\;+\\; 0.05\\,\\cos\\!\\big(2\\pi x/L_x\\big) \\;+\\; 0.02\\,\\cos\\!\\big(4\\pi x/L_x\\big)$，其中 $c_0 = 0.1$。\n- $\\eta(x,0) \\,=\\, 0.05\\,\\sin\\!\\big(2\\pi x/L_x\\big)$。\n\n数值积分。所有空间积分必须在均匀网格上使用梯形法则计算，该方法对于周期性光滑函数具有谱精度。\n\n能量单调性检查。令 $F^n$ 表示在时间步 $n$ 的离散总自由能。对于给定的绝对容差 $\\varepsilon = 10^{-9}$，检查所有步数是否满足 $F^{n+1} \\le F^n + \\varepsilon$。对于质量守恒，令 $\\overline{c}^n$ 表示在时间步 $n$ 时 $c$ 的空间平均值；验证在 $N_t$ 个时间步后，是否满足 $\\lvert \\overline{c}^{N_t} - \\overline{c}^0 \\rvert \\le \\delta$，其中 $\\delta = 10^{-10}$。\n\n测试套件。为以下三种情况实现你的格式（所有参数均为无量纲）：\n- 情况 $\\mathsf{A}$：$L_x=1.0$, $N=128$, $\\Delta t=10^{-4}$, $N_t=200$, $M=1.0$, $\\mathcal{L}=1.0$, $\\kappa_c=10^{-2}$, $\\kappa_\\eta=10^{-2}$, $a=0.5$, $b=1.0$, $\\gamma=0.3$。\n- 情况 $\\mathsf{B}$：$L_x=1.0$, $N=96$, $\\Delta t=8\\times 10^{-5}$, $N_t=250$, $M=0.5$, $\\mathcal{L}=1.5$, $\\kappa_c=8\\times 10^{-3}$, $\\kappa_\\eta=5\\times 10^{-3}$, $a=0.5$, $b=1.0$, $\\gamma=0.2$。\n- 情况 $\\mathsf{C}$：$L_x=1.0$, $N=64$, $\\Delta t=1.2\\times 10^{-4}$, $N_t=300$, $M=1.2$, $\\mathcal{L}=0.8$, $\\kappa_c=10^{-2}$, $\\kappa_\\eta=10^{-2}$, $a=0.5$, $b=1.0$, $\\gamma=0.0$。\n\n输出规范。对于每种情况，计算两个布尔值：第一个表示在最终时间步，$c$ 的离散质量与初始质量之差是否在 $\\delta = 10^{-10}$ 范围内；第二个表示在所有时间步中，离散总自由能是否在 $\\varepsilon = 10^{-9}$ 的容差内单调非增。将三种情况的结果汇总为一个包含六个布尔值的扁平列表，顺序如下：$\\big[$情况 $\\mathsf{A}$ 质量, 情况 $\\mathsf{A}$ 能量, 情况 $\\mathsf{B}$ 质量, 情况 $\\mathsf{B}$ 能量, 情况 $\\mathsf{C}$ 质量, 情况 $\\mathsf{C}$ 能量$\\big]$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$\\big[$$\\texttt{True}$,$\\texttt{False}$,$\\texttt{True}$,$\\texttt{True}$,$\\texttt{True}$,$\\texttt{False}$$\\big]$）。不应打印任何其他文本。", "solution": "该问题要求为耦合的 Cahn-Hilliard 和 Allen-Cahn 系统设计并实现一个数值格式。该格式必须从第一性原理构建，并且必须满足组分场 $c$ 的离散质量守恒和总自由能 $F$ 的离散能量耗散。\n\n首先，我们确定连续系统的基本性质。总自由能泛函由下式给出\n$$\nF[c,\\eta] = \\int_0^{L_x} \\left( f_0(c,\\eta) + \\frac{\\kappa_c}{2}\\,\\lvert \\partial_x c \\rvert^2 + \\frac{\\kappa_\\eta}{2}\\,\\lvert \\partial_x \\eta \\rvert^2 \\right)\\,dx,\n$$\n其中局域自由能密度为\n$$\nf_0(c,\\eta) = \\frac{1}{4}\\,(c^2-1)^2 + \\frac{a}{2}\\,\\eta^2 + \\frac{b}{4}\\,\\eta^4 + \\gamma\\,c\\,\\eta.\n$$\n化学势 $\\mu_c$ 和 $\\mu_\\eta$ 是 $F$ 相对于 $c$ 和 $\\eta$ 的变分导数。使用欧拉-拉格朗日公式，它们是\n$$\n\\mu_c = \\frac{\\delta F}{\\delta c} = \\frac{\\partial f_0}{\\partial c} - \\kappa_c \\partial_x^2 c = (c^3 - c + \\gamma\\eta) - \\kappa_c \\partial_x^2 c,\n$$\n$$\n\\mu_\\eta = \\frac{\\delta F}{\\delta \\eta} = \\frac{\\partial f_0}{\\partial \\eta} - \\kappa_\\eta \\partial_x^2 \\eta = (a\\eta + b\\eta^3 + \\gamma c) - \\kappa_\\eta \\partial_x^2 \\eta.\n$$\n系统的动力学由梯度流描述，\n$$\n\\partial_t c = M \\nabla^2 \\mu_c, \\qquad \\partial_t \\eta = -\\mathcal{L} \\mu_\\eta.\n$$\n总能量 $F$ 的时间演化为\n$$\n\\frac{dF}{dt} = \\int_0^{L_x} \\left( \\frac{\\delta F}{\\delta c} \\partial_t c + \\frac{\\delta F}{\\delta \\eta} \\partial_t \\eta \\right) dx = \\int_0^{L_x} (\\mu_c \\partial_t c + \\mu_\\eta \\partial_t \\eta) dx.\n$$\n代入演化方程并利用分部积分和周期性边界条件，可得\n$$\n\\frac{dF}{dt} = \\int_0^{L_x} \\left( \\mu_c (M \\nabla^2 \\mu_c) - \\mu_\\eta (\\mathcal{L} \\mu_\\eta) \\right) dx = -\\int_0^{L_x} \\left( M |\\nabla \\mu_c|^2 + \\mathcal{L} |\\mu_\\eta|^2 \\right) dx \\le 0,\n$$\n因为 $M, \\mathcal{L}  0$。这证实了总能量是时间的非增函数。\n\n对于质量守恒，我们考虑 $c$ 的空间平均值 $\\overline{c}(t) = \\frac{1}{L_x} \\int_0^{L_x} c(x,t) dx$。其时间导数为\n$$\n\\frac{d\\overline{c}}{dt} = \\frac{1}{L_x} \\int_0^{L_x} \\partial_t c \\,dx = \\frac{M}{L_x} \\int_0^{L_x} \\nabla^2 \\mu_c \\,dx = \\frac{M}{L_x} [\\partial_x \\mu_c]_0^{L_x} = 0,\n$$\n由于周期性。因此，总质量是守恒的。我们的离散格式必须保持这两个基本性质。\n\n现在我们来设计数值格式。对于均匀网格 $x_j=j\\Delta x$（其中 $j=0, \\dots, N-1$ 且 $\\Delta x = L_x/N$）上的空间离散化，我们使用傅里叶伪谱法，该方法对周期函数具有谱精度。空间导数 $\\partial_x$ 和 $\\nabla^2 = \\partial_x^2$ 在傅里叶空间中计算。令 $\\hat{u}_k$ 为网格函数 $u_j$ 的离散傅里叶变换 (DFT)。其导数的 DFT 为 $(\\widehat{\\partial_x^p u})_k = (i q_k)^p \\hat{u}_k$，其中 $q_k = 2\\pi k/L_x$ 是波数，$k \\in \\{-N/2+1, \\dots, N/2\\}$。\n\n对于时间离散化，标准的显式格式对于此类梯度流通常不稳定，而全隐式格式会导致非线性系统。为了保证能量稳定性，我们构建一个基于标量辅助变量 (SAV) 方法的格式。这种方法是系统性的，并且在每个时间步都导出一个线性系统。\n\n首先，我们观察到局域能量密度 $f_0(c, \\eta)$ 是有下界的。因此，我们可以定义一个非负的能量泛函 $E_0[c, \\eta] = \\int_0^{L_x} f_0(c, \\eta) dx + C_1$，其中 $C_1$ 是一个为确保 $E_0  0$ 而选择的常数。我们引入一个标量辅助变量 $r(t) = \\sqrt{E_0[c(t), \\eta(t)]}$。总自由能可以表示为\n$$\nF[c, \\eta, r] = \\int_0^{L_x} \\left(\\frac{\\kappa_c}{2} |\\partial_x c|^2 + \\frac{\\kappa_\\eta}{2} |\\partial_x \\eta|^2 \\right) dx + r^2 - C_1.\n$$\n当约束 $r^2 = E_0$ 满足时，这个修改后的能量与原始能量等价。演化方程使用一阶半隐式格式进行离散化，其中线性项被隐式处理，非线性项通过 SAV 方法处理。令 $\\mu_{c,nl} = \\partial f_0/\\partial c$ 和 $\\mu_{\\eta,nl} = \\partial f_0/\\partial \\eta$。从时间步 $n$到 $n+1$ 的格式为：\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M\\nabla^2 \\left( \\frac{r^{n+1}}{r^n} \\mu_{c,nl}^n - \\kappa_c \\nabla^2 c^{n+1} \\right)\n$$\n$$\n\\frac{\\eta^{n+1} - \\eta^n}{\\Delta t} = -\\mathcal{L} \\left( \\frac{r^{n+1}}{r^n} \\mu_{\\eta,nl}^n - \\kappa_\\eta \\nabla^2 \\eta^{n+1} \\right)\n$$\n$$\n\\frac{r^{n+1} - r^n}{\\Delta t} = \\frac{1}{2 r^n} \\left( \\left\\langle \\mu_{c,nl}^n, \\frac{c^{n+1}-c^n}{\\Delta t} \\right\\rangle + \\left\\langle \\mu_{\\eta,nl}^n, \\frac{\\eta^{n+1}-\\eta^n}{\\Delta t} \\right\\rangle \\right)\n$$\n其中 $\\langle u, v \\rangle = \\int u v dx$。该系统对于未知数 $c^{n+1}, \\eta^{n+1}, r^{n+1}$ 是线性的。令 $q^{n+1} = r^{n+1}/r^n$。在傅里叶空间中，场方程变为：\n$$\n\\hat{c}_k^{n+1} (1 + \\Delta t M \\kappa_c q_k^4) = \\hat{c}_k^n - \\Delta t M q_k^2 q^{n+1} (\\widehat{\\mu_{c,nl}^n})_k\n$$\n$$\n\\hat{\\eta}_k^{n+1} (1 + \\Delta t \\mathcal{L} \\kappa_\\eta q_k^2) = \\hat{\\eta}_k^n - \\Delta t \\mathcal{L} q^{n+1} (\\widehat{\\mu_{\\eta,nl}^n})_k\n$$\n这些方程可以解出 $\\hat{c}_k^{n+1}$ 和 $\\hat{\\eta}_k^{n+1}$，它们是 $q^{n+1}$ 的线性函数：\n$$\n\\hat{c}_k^{n+1} = A_{c,k} + B_{c,k} q^{n+1}, \\qquad \\hat{\\eta}_k^{n+1} = A_{\\eta,k} + B_{\\eta,k} q^{n+1}\n$$\n其中 $A_{c,k}, B_{c,k}, A_{\\eta,k}, B_{\\eta,k}$ 仅依赖于时间步 $n$ 的值。将这些代入 $r^{n+1}$ 的离散方程中，可以得到一个关于 $q^{n+1}$ 的单一线性方程，该方程很容易求解。一旦知道了 $q^{n+1}$，$c^{n+1}$ 和 $\\eta^{n+1}$ 就可以计算出来。\n\n该格式严格保持离散质量。对于 $k=0$ 模式（$q_0=0$），$\\hat{c}_0$ 的方程是 $\\hat{c}_0^{n+1} = \\hat{c}_0^n$。因为离散空间平均值为 $\\overline{c} = \\hat{c}_0/N$，这证明了精确的离散质量守恒。\n\n对于修改后的能量 $F[c,\\eta,r]$，该格式是无条件能量稳定的。虽然由于 SAV 公式中的一阶近似，这并不能严格保证原始能量 $F[c,\\eta]$ 在每一步都耗散，但偏差通常为 $\\mathcal{O}(\\Delta t^2)$ 阶，对于小的时间步长可以忽略不计。我们将数值验证对于给定的微小容差 $\\varepsilon$，是否满足 $F^{n+1} \\le F^n + \\varepsilon$。\n\n整体算法如下：\n1.  初始化场 $c^0, \\eta^0$ 并计算初始质量和能量。\n2.  在每个时间步 $n$：\n    a. 计算非线性势项 $\\mu_{c,nl}^n, \\mu_{\\eta,nl}^n$ 和辅助变量 $r^n$。\n    b. 变换到傅里叶空间并计算系数 $A_{c,k}, B_{c,k}, A_{\\eta,k}, B_{\\eta,k}$。\n    c. 将系数变换回实空间以计算内积。\n    d. 求解标量 $q^{n+1}$。\n    e. 在实空间中更新场 $c^{n+1}$ 和 $\\eta^{n+1}$。\n    f. 使用梯形法则计算积分，使用谱方法计算导数，来计算新的总能量 $F^{n+1}$。\n    g. 检查能量耗散条件 $F^{n+1} \\le F^n + \\varepsilon$。\n3. 在最后一步之后，检查质量守恒条件 $|\\overline{c}^{N_t} - \\overline{c}^0| \\le \\delta$。\n\n此过程提供了一个稳健、高效且可证明稳定（在 SAV 意义上）的格式，满足问题的要求。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coupled Cahn-Hilliard/Allen-Cahn system for three test cases\n    and verifies discrete mass conservation and energy dissipation.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'Lx': 1.0, 'N': 128, 'dt': 1e-4, 'Nt': 200, 'M': 1.0, 'L': 1.0,\n         'kappa_c': 1e-2, 'kappa_eta': 1e-2, 'a': 0.5, 'b': 1.0, 'gamma': 0.3},\n        # Case B\n        {'Lx': 1.0, 'N': 96, 'dt': 8e-5, 'Nt': 250, 'M': 0.5, 'L': 1.5,\n         'kappa_c': 8e-3, 'kappa_eta': 5e-3, 'a': 0.5, 'b': 1.0, 'gamma': 0.2},\n        # Case C\n        {'Lx': 1.0, 'N': 64, 'dt': 1.2e-4, 'Nt': 300, 'M': 1.2, 'L': 0.8,\n         'kappa_c': 1e-2, 'kappa_eta': 1e-2, 'a': 0.5, 'b': 1.0, 'gamma': 0.0}\n    ]\n\n    delta_mass_tol = 1e-10\n    epsilon_energy_tol = 1e-9\n    \n    final_results = []\n\n    for params in test_cases:\n        # Unpack parameters\n        Lx, N, dt, Nt = params['Lx'], params['N'], params['dt'], params['Nt']\n        M, L, kappa_c, kappa_eta = params['M'], params['L'], params['kappa_c'], params['kappa_eta']\n        a, b, gamma = params['a'], params['b'], params['gamma']\n\n        # Spatial grid and wavevectors\n        dx = Lx / N\n        x = np.arange(N) * dx\n        q = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n        q2 = q**2\n        q4 = q**4\n\n        # Initial conditions\n        c0_avg = 0.1\n        c = c0_avg + 0.05 * np.cos(2 * np.pi * x / Lx) + 0.02 * np.cos(4 * np.pi * x / Lx)\n        eta = 0.05 * np.sin(2 * np.pi * x / Lx)\n\n        # Helper function to compute f0\n        def f0(c_loc, eta_loc):\n            return 0.25 * (c_loc**2 - 1.0)**2 + 0.5 * a * eta_loc**2 + 0.25 * b * eta_loc**4 + gamma * c_loc * eta_loc\n\n        # Helper function to compute total energy F\n        def compute_energy(c_field, eta_field):\n            c_hat, eta_hat = np.fft.fft(c_field), np.fft.fft(eta_field)\n            grad_c_sq = np.real(np.fft.ifft((1j * q) * c_hat))**2\n            grad_eta_sq = np.real(np.fft.ifft((1j * q) * eta_hat))**2\n            \n            local_energy = f0(c_field, eta_field)\n            grad_energy = 0.5 * kappa_c * grad_c_sq + 0.5 * kappa_eta * grad_eta_sq\n            \n            total_energy = dx * np.sum(local_energy + grad_energy)\n            return total_energy\n\n        # Initial state\n        initial_mass = np.mean(c)\n        F_prev = compute_energy(c, eta)\n        \n        energy_monotonic = True\n        \n        # SAV constant, ensure E0+C1 > 0. For these ICs, C1=0 is fine.\n        C1 = 0.0\n        sav_epsilon = 1e-12 # Small stabilization for sqrt\n\n        # Time evolution loop\n        for _ in range(Nt):\n            # Step 1: Compute nonlinear parts and SAV variable r\n            mu_c_nl = c**3 - c + gamma * eta\n            mu_eta_nl = a * eta + b * eta**3 + gamma * c\n            \n            E0_n = dx * np.sum(f0(c, eta))\n            r_n = np.sqrt(E0_n + C1 + sav_epsilon)\n\n            # Step 2: FFTs\n            c_hat = np.fft.fft(c)\n            eta_hat = np.fft.fft(eta)\n            mu_c_nl_hat = np.fft.fft(mu_c_nl)\n            mu_eta_nl_hat = np.fft.fft(mu_eta_nl)\n            \n            # Step 3: Compute coefficients for q^(n+1)\n            # Denominators for implicit terms\n            den_c = 1.0 + dt * M * kappa_c * q4\n            den_eta = 1.0 + dt * L * kappa_eta * q2\n\n            # A_k and B_k coefficients in Fourier space\n            A_c_hat = c_hat / den_c\n            B_c_hat = -dt * M * q2 * mu_c_nl_hat / den_c\n            A_eta_hat = eta_hat / den_eta\n            B_eta_hat = -dt * L * mu_eta_nl_hat / den_eta\n\n            # IFFT to get real space representations A, B\n            A_c = np.real(np.fft.ifft(A_c_hat))\n            B_c = np.real(np.fft.ifft(B_c_hat))\n            A_eta = np.real(np.fft.ifft(A_eta_hat))\n            B_eta = np.real(np.fft.ifft(B_eta_hat))\n            \n            # Step 4: Compute inner products and solve for q^(n+1)\n            # Inner products are sums scaled by dx\n            num_term1 = dx * np.sum(mu_c_nl * (A_c - c))\n            num_term2 = dx * np.sum(mu_eta_nl * (A_eta - eta))\n            \n            den_term1 = dx * np.sum(mu_c_nl * B_c)\n            den_term2 = dx * np.sum(mu_eta_nl * B_eta)\n\n            q_num = r_n**2 + 0.5 * (num_term1 + num_term2)\n            q_den = r_n**2 - 0.5 * (den_term1 + den_term2)\n            \n            q_np1 = q_num / q_den if abs(q_den) > 1e-12 else 1.0\n            \n            # Step 5: Update fields\n            c = A_c + B_c * q_np1\n            eta = A_eta + B_eta * q_np1\n\n            # Step 6: Verify energy dissipation\n            F_next = compute_energy(c, eta)\n            if F_next > F_prev + epsilon_energy_tol:\n                energy_monotonic = False\n                break \n            F_prev = F_next\n\n        # Post-loop verification\n        final_mass = np.mean(c)\n        mass_conserved = np.abs(final_mass - initial_mass) = delta_mass_tol\n        \n        final_results.extend([mass_conserved, energy_monotonic])\n\n    # Final output formatting\n    print(f\"[{','.join(map(str, final_results))}]\".replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\nsolve()\n```", "id": "2524728"}]}