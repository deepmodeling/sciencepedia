## 引言
[粉末X射线衍射](@entry_id:161656)是[材料科学](@entry_id:152226)、化学及相关领域中不可或缺的表征工具，它为我们提供了窥探物质[晶体结构](@entry_id:140373)的窗口。然而，从复杂的实验衍射图谱中——尤其是那些包含多[物相](@entry_id:196677)、严重峰重叠和各种非理想效应的图谱——提取准确、定量的结构与组成信息，是一项巨大的挑战。传统的基于单峰积分的分析方法在这些情况下往往力不从心，导致信息提取不完整甚至产生误导性结论。[Rietveld精修](@entry_id:147438)方法正是为了解决这一难题而诞生的强大技术。它将整个衍射图谱视为一个整体，通过拟合一个综合的物理模型，能够从未分解的复杂数据中“解构”出精确的[晶格参数](@entry_id:191810)、原子坐标、相含量等关键信息。

本文旨在为研究生及高级研究人员提供一份关于[Rietveld精修](@entry_id:147438)与[定量相分析](@entry_id:189993)的全面指南。我们将超越“黑箱式”的软件操作，深入其核心。文章将分为三个主要部分：首先，在“原理与机制”一章中，我们将系统剖析支撑Rietveld方法的数学模型、优化算法以及结果的统计解释，为您打下坚实的理论基础。接着，在“应用与跨学科交叉”一章，我们将通过一系列实际案例，展示如何运用该方法解决真实世界中的复杂材料问题，并探讨其如何与其他分析技术协同作用，拓展研究的深度与广度。最后，“动手实践”部分将提供具体的练习，引导您将理论知识应用于解决实际的[结构分析](@entry_id:153861)问题。通过本系列的学习，您将能够自信地运用[Rietveld精修](@entry_id:147438)，将其从一个单纯的数据处理工具，转变为探索材料微观世界的强大武器。

## 原理与机制

[Rietveld精修](@entry_id:147438)是一种基于[最小二乘法](@entry_id:137100)的[全谱拟合](@entry_id:203800)技术，它将实验观测到的[粉末衍射](@entry_id:157495)图谱与根据[晶体结构](@entry_id:140373)和仪器参数计算出的理论图谱进行比较和拟合。该方法不仅仅是拟合单个衍射峰，而是将整个衍射图谱作为一个整体进行处理，从而能够从未分解的复杂图谱中提取出精确的结构信息、微观结构信息和相含量信息。本章将深入探讨支持[Rietveld精修](@entry_id:147438)和[定量相分析](@entry_id:189993)的核心原理与基本机制。

### Rietveld模型：解构衍射图谱

Rietveld方法的核心在于建立一个能够精确描述整个衍射图谱的数学模型。这个模型是多个物理贡献的加和，主要包括来自晶体相的[布拉格衍射](@entry_id:148063)峰、描述仪器和样品效应的峰形函数，以及一个平滑变化的背景函数。

#### 晶体贡献：[布拉格衍射](@entry_id:148063)峰

一个[理想晶体](@entry_id:138314)产生的衍射图谱由一系列尖锐的[布拉格衍射](@entry_id:148063)峰构成。在Rietveld模型中，每个衍射峰的积分强度都与相应[晶面](@entry_id:166481)族 $(hkl)$ 的[结构因子](@entry_id:158623) $F_{\mathbf{h}}$ 的模平方 $|F_{\mathbf{h}}|^2$ 成正比。[结构因子](@entry_id:158623)是描述一个晶胞内所有原子对特定衍射方向 $(hkl)$ 的[相干散射](@entry_id:267724)能力的复数。它综合了晶胞内原子的种类、位置和[振动](@entry_id:267781)状态等信息。对于[X射线衍射](@entry_id:147790)，其通用表达式为：

$$
F_{\mathbf{h}} = \sum_{j} \mathrm{occ}_{j} f_{j}(s) \exp(-B_{j}s^2) \exp(2\pi i \mathbf{h} \cdot \mathbf{r}_{j})
$$

这个公式中的每一个组成部分都有其明确的物理意义 [@problem_id:2517857]：

*   **[原子散射因子](@entry_id:197944)** $f_{j}(s)$：描述单个原子 $j$ 的散射能力。对于[X射线](@entry_id:187649)，它取决于原子的电子云[分布](@entry_id:182848)，并随着[散射矢量](@entry_id:262662)的大小 $s = \sin\theta/\lambda$ 的增加而减小。这意味着高角度的衍射峰会因为原子内部[电子散射](@entry_id:159023)的非[相干性](@entry_id:268953)而减弱。当入射[X射线](@entry_id:187649)能量接近[原子吸收](@entry_id:199242)边时，[原子散射因子](@entry_id:197944)还需包含[反常散射](@entry_id:141883)校正项 $f_j(s) = f_{0,j}(s) + f_j' + i f_j''$。

*   **占位度** $\mathrm{occ}_{j}$：表示原子 $j$ 在其[晶体学](@entry_id:140656)格点上的占据概率（$0 \le \mathrm{occ}_{j} \le 1$）。它线性地调节了该原子对总[结构因子](@entry_id:158623)的贡献。

*   **[德拜-瓦勒因子](@entry_id:142464)** (Debye-Waller Factor) $\exp(-B_{j}s^2)$：也称为[温度因子](@entry_id:190408)，它描述了原子热[振动](@entry_id:267781)或[静态无序](@entry_id:144184)对其散射能力的衰减效应。原子偏离其[平衡位置](@entry_id:272392)的[均方根位移](@entry_id:137352)越大（即 $B_j$ 越大），高角度衍射峰的强度衰减越严重。

*   **相位因子** $\exp(2\pi i \mathbf{h} \cdot \mathbf{r}_{j})$：这个复指数项描述了位于晶胞分数坐标 $\mathbf{r}_j$ 处的原子所散射的波相对于位于原点的原子所散射的[波的相位](@entry_id:171303)差。整个[晶胞](@entry_id:143489)的散射是所有原子散射波的相干叠加，正是这些相位关系导致了衍射的相长和相消干涉。

在实际计算中，我们通常只需考虑不对称单元内的原子，并通过空间群对称操作生成[晶胞](@entry_id:143489)内所有等效原子的位置，从而得到完整的[结构因子](@entry_id:158623)。

除了与结构相关的强度调制外，每个物相的总衍射强度还受到其在样品中含量的影响。这通过一个称为**相标度因子**（Phase Scale Factor）$S_p$ 的参数来体现。从基本原理出发，样品中被[X射线](@entry_id:187649)束照射的体积内，特定物相 $p$ 的总[散射强度](@entry_id:202196)正比于该[物相](@entry_id:196677)被照射的晶胞数量 $N_p$。而 $N_p$ 等于该物相的体积 $V_{\text{phase},p}$ 除以其[晶胞体积](@entry_id:173348) $V_{\text{cell},p}$ [@problem_id:2517812]。由于物相的[体积分数](@entry_id:756566) $\phi_p = V_{\text{phase},p} / V_{\text{total}}$，在总照射体积 $V_{\text{total}}$ 恒定的情况下，我们得到 $N_p \propto \phi_p / V_{\text{cell},p}$。因此，标度因子 $S_p$ 作为物相 $p$ 所有衍射峰强度的总乘子，其物理意义在于它正比于该物相的[体积分数](@entry_id:756566)，同时反比于其[晶胞体积](@entry_id:173348)：

$$
S_p \propto \frac{\phi_p}{V_{\text{cell},p}}
$$

这个关系是利用[Rietveld精修](@entry_id:147438)进行[定量相分析](@entry_id:189993)（Quantitative Phase Analysis, QPA）的理论基石。

#### 峰形函数：塑造衍射峰

理论上无限小的晶体产生的衍射峰是狄拉克 $\delta$ 函数。然而，在实际测量中，由于仪器光学系统（如[X射线源](@entry_id:268482)尺寸、狭缝宽度、检测器分辨率）的限制和样品自身特性（如微晶尺寸、微观应变），衍射峰会展宽成具有特定形状的[分布](@entry_id:182848)。峰形函数 $\phi(2\theta_i - 2\theta_k)$ 就是用来描述这种展宽效应的数学函数。

常用的峰形函数包括高斯函数、[洛伦兹函数](@entry_id:199503)以及它们的线性组合或卷积，如伪沃伊特（pseudo-Voigt）函数和皮尔逊VII（Pearson VII）函数。这些函数的半高全宽（FWHM）和形状参数本身也是精修的对象，它们随衍射角 $2\theta$ 的变化规律（如Caglioti公式）可以用来提取关于微晶尺寸和微观应变等微观结构信息。

#### 背景函数：模拟基线信号

实验衍射图谱中除了来自晶相的[布拉格衍射](@entry_id:148063)峰外，还包含一个缓变的背景信号。其来源多样，包括样品对[X射线](@entry_id:187649)的[非相干散射](@entry_id:190180)（康普頓散射）、样品中非晶成分的漫散射、样品支持物或空气的散射，以及探测器自身的电子学噪声和来自光源的荧光辐射等 [@problem_id:2517884]。

在Rietveld模型中，背景被视为一个与[布拉格峰](@entry_id:140755)无关的、可加的贡献项 $B(2\theta)$。由于背景通常是 $2\theta$ 的平滑函数，它可以通过一个低阶多项式或其他[解析函数](@entry_id:139584)来建模。[切比雪夫多项式](@entry_id:145074)（Chebyshev polynomials）是一种特别受欢迎的选择，因为它具有优越的数学性质。当在一个有限区间上（例如，实验测量的 $2\theta$ 范围）使用时，切比雪夫多项式级数能够提供对平滑函数的近乎最优的均匀逼近，有效避免了普通幂级数多项式在高阶时可能出现的“龙格现象”（即在区间端点处的剧烈[振荡](@entry_id:267781)）。此外，[切比雪夫多项式](@entry_id:145074)[基函数](@entry_id:170178)在离散点上近似正交，这有助于减少背景系数与其他缓慢变化的模型参数（如标度因子）之间的相关性，从而提高精修的数值稳定性 [@problem_ID:2517884]。

#### 叠加原理与重叠峰处理

Rietveld模型的最终形式是将上述所有组分叠加起来。在衍射图谱的任意一个角度 $2\theta_i$ 处，计算的总强度 $y_i^{\text{calc}}$是背景强度与所有物相、所有可能的[布拉格衍射](@entry_id:148063)峰在该点的贡献之和：

$$
y_i^{\text{calc}} = B(2\theta_i) + \sum_{p} S_p \sum_{k} L_{pk} |F_{pk}|^2 \phi(2\theta_i - 2\theta_{pk}) P_{pk} A
$$

其中 $L_{pk}$ 是洛伦兹-偏振和[多重性](@entry_id:136466)因子，$P_{pk}$ 是[择优取向](@entry_id:190900)校正函数，$A$ 是吸收校正。

这一叠加原理是Rietveld方法强大功能的关键。在复杂的[粉末衍射](@entry_id:157495)图谱中，尤其是对于低对称性晶体或多[相混合](@entry_id:199798)物，衍射峰的重叠是普遍现象。当两个或多个衍射峰的中心位置间距小于它们的峰形宽度时，就会发生**峰重叠**（Peak Overlap），使得无法通过简单的积分方法分离出单个峰的强度 [@problem_id:2517933]。然而，Rietveld方法并不需要分离单个峰。它利用了每个晶相的[晶体结构](@entry_id:140373)这一先验知识。[晶体结构](@entry_id:140373)决定了该相**所有**衍射峰的相对位置和相对强度。即使在某个局部区域峰严重重叠，整个图谱的其他区域也包含了区分不同物相的“指纹”信息。通过对整个图谱进行[最小二乘拟合](@entry_id:751226)，算法可以利用全局信息来“解构”重叠区域中各个[物相](@entry_id:196677)的贡献，并稳定地确定各自的标度因子 $S_p$，从而实现精确的[定量相分析](@entry_id:189993)。前提是不同物相的衍射图谱在数学上是线性无关的。

### 精修机制：最小化差异

[Rietveld精修](@entry_id:147438)的目标是调整模型参数（如[晶格参数](@entry_id:191810)、原子坐标、峰形参数、标度因子等），使得[计算图](@entry_id:636350)谱 $y_i^{\text{calc}}$ 与实验图谱 $y_i^{\text{obs}}$ 之间的差异最小化。这个过程是通过[非线性最小二乘法](@entry_id:178660)实现的。

#### [目标函数](@entry_id:267263)与[统计权重](@entry_id:186394)

“差异”的度量是通过一个[目标函数](@entry_id:267263)，即**加权[残差平方和](@entry_id:174395)**（Weighted Residual Sum of Squares, WRSS），通常表示为 $\chi^2$：

$$
S(\mathbf{p}) = \sum_i w_i [y_i^{\text{obs}} - y_i^{\text{calc}}(\mathbf{p})]^2
$$

这里的 $\mathbf{p}$ 是包含所有待精修参数的向量。$w_i$ 是分配给每个数据点 $i$ 的**权重**。权重的选择至关重要，它反映了每个数据点测量值的可靠性。根据[最大似然估计](@entry_id:142509)原理，最优的权重是该点测量值[方差](@entry_id:200758) $\sigma_i^2$ 的倒数，即 $w_i = 1/\sigma_i^2$。这意味着不确定性大的数据点（[方差](@entry_id:200758)大）对拟合的贡献应该小，反之亦然 [@problem_id:2517864]。

在[光子计数](@entry_id:186176)型[X射线衍射](@entry_id:147790)实验中，计数值服从[泊松分布](@entry_id:147769)，其[方差](@entry_id:200758)等于[期望值](@entry_id:153208)。因此，一个简单而有效的权重方案是使用观测计数值本身来估计[方差](@entry_id:200758)：$w_i = 1/y_i^{\text{obs}}$。这个基本的权重方案可以根据不同的实验情况进行修正：

*   **探测器读出噪声**：如果探测器除了[光子计数](@entry_id:186176)噪声（泊松）外，还有一个独立的、[方差](@entry_id:200758)为 $\sigma_r^2$ 的高斯读出噪声，那么总[方差](@entry_id:200758)是两者之和，权重应为 $w_i = 1/(y_i^{\text{obs}} + \sigma_r^2)$。
*   **[背景扣除](@entry_id:190391)**：如果从原始数据 $y_i^{\text{obs}}$ 中扣除了一个独立测量的背景 $b_i$，那么处理后的数据 $\tilde{y}_i = y_i^{\text{obs}} - b_i$ 的[方差](@entry_id:200758)是原始信号和背景信号[方差](@entry_id:200758)之和，即 $\text{Var}(\tilde{y}_i) \approx y_i^{\text{obs}} + b_i$。因此，权重应为 $w_i = 1/(y_i^{\text{obs}} + b_i)$。
*   **[数据归一化](@entry_id:265081)**：如果数据被归一化为计数率 $r_i = y_i/t_i$（其中 $t_i$ 是[停留时间](@entry_id:263953)），则[方差](@entry_id:200758)传播定律给出 $\text{Var}(r_i) = \text{Var}(y_i)/t_i^2 \approx y_i/t_i^2 = r_i/t_i$。相应的权重为 $w_i = t_i/r_i$。

错误地选择权重会严重影响精修结果的可靠性。例如，赋予高强度点过高权重（如 $w_i=y_i^{\text{obs}}$）是错误的，因为高强度点的绝对[方差](@entry_id:200758)更大，应该被赋予相对较小的权重 [@problem_id:2517864]。

#### [Levenberg-Marquardt算法](@entry_id:172092)： navigating [参数空间](@entry_id:178581)

由于Rietveld模型 $y_i^{\text{calc}}(\mathbf{p})$ 是参数 $\mathbf{p}$ 的高度[非线性](@entry_id:637147)函数，最小化 $S(\mathbf{p})$ 需要迭代算法。**Levenberg-Marquardt (LM) 算法**是解决此类[非线性](@entry_id:637147)最小二乘问题的标准方法 [@problem_id:2517931]。

LM算法巧妙地结合了两种经典的优化策略：[高斯-牛顿法](@entry_id:173233)（Gauss-Newton method）和[最速下降法](@entry_id:140448)（gradient descent method）。它通过求解一个修正的线性方程组来计算每一步的参数更新量 $\Delta\mathbf{p}$：

$$
(\mathbf{J}^\top \mathbf{W} \mathbf{J} + \lambda \mathbf{D}) \Delta\mathbf{p} = \mathbf{J}^\top \mathbf{W} \mathbf{r}
$$

其中，$\mathbf{J}$ 是[雅可比矩阵](@entry_id:264467)（其元素为 $J_{ij} = \partial r_i / \partial p_j$，其中 $r_i = y_i^\text{obs} - y_i^\text{calc}$），$\mathbf{W}$ 是权重矩阵，$\mathbf{r}$ 是残差向量。

关键在于**阻尼参数** $\lambda$。
*   当 $\lambda \to 0$ 时，LM算法趋近于**[高斯-牛顿法](@entry_id:173233)**。此方法在接近最小值时收敛速度快，但如果初始猜测远离最小值，或者参数高度相关导致矩阵 $\mathbf{J}^\top \mathbf{W} \mathbf{J}$ 近似奇异，则可能不稳定甚至发散。
*   当 $\lambda \to \infty$ 时，LM算法趋近于**[最速下降法](@entry_id:140448)**。此方法总是沿着目标函数下降最快的方向（负梯度方向）前进一小步，保证了收敛性，但收敛速度非常慢。

LM算法的精髓在于**自适应地调整** $\lambda$。如果一个迭代步成功地减小了 $S(\mathbf{p})$，说明当前模型近似良好，算法会减小 $\lambda$，使得下一步更接近快速的[高斯-牛顿法](@entry_id:173233)。如果一个迭代步导致 $S(\mathbf{p})$ 增加，说明模型近似差，算法会增大 $\lambda$，使得下一步更保守，更接近稳妥的最速下降法。这种动态调整使得LM算法兼具了[高斯-牛顿法](@entry_id:173233)的快速收敛性和[最速下降法](@entry_id:140448)的稳定性，非常适合[Rietveld精修](@entry_id:147438)中参数高度相关且模型复杂的场景。

### [定量相分析](@entry_id:189993)与统计解释

精修完成后，我们需要从结果中提取定量的物理化学信息，并评估模型的可靠性。

#### 从标度因子到相分数

如前所述，精修得到的标度因子 $S_p$ 蕴含了相分数的信息。对于一个包含 $N$ 个物相的混合物，第 $p$ 个物相的重量分数 $W_p$ 可以通过Hill和Howard提出的公式计算：

$$
W_p = \frac{S_p (ZMV)_p}{\sum_{j=1}^{N} S_j (ZMV)_j}
$$

其中，对于[物相](@entry_id:196677) $p$，$Z$ 是每个[晶胞](@entry_id:143489)包含的[化学式单位](@entry_id:145960)数，$M$ 是[化学式单位](@entry_id:145960)的质量，$V$ 是[晶胞体积](@entry_id:173348)。$Z$, $M$, $V$ 都是已知的或可以通过精修得到的晶体学常数。这个公式将实验中 refined 出来的抽象参数 $S_p$ 转换为了具有明确物理意义的重量分数，实现了[定量相分析](@entry_id:189993)。

#### 评估[拟合优度](@entry_id:637026)

如何判断一次精修的好坏？[Rietveld精修](@entry_id:147438)提供了几个关键的统计指标（[R因子](@entry_id:181660)）：

*   **加权谱[R因子](@entry_id:181660)** ($R_{wp}$): $R_{wp} = [S(\mathbf{p}) / \sum_i w_i (y_i^{\text{obs}})^2]^{1/2}$。它是最直接反映拟合残差与数据本身相对大小的指标，也是精修过程中实际最小化的目标。然而，仅凭 $R_{wp}$ 的值无法判断模型是否合理。

*   **[拟合优度](@entry_id:637026)** (Goodness of Fit, GoF, 或 $S$): $GoF = R_{wp}/R_{exp} = [S(\mathbf{p}) / (N-P)]^{1/2}$。这是一个更具统计意义的指标。其中 $N$ 是数据点总数，$P$ 是精修参数的个数，$N-P$ 是自由度。$R_{exp}$ 是统计上期望的 $R_{wp}$ 最小值。如果模型完全正确，且权重 $w_i = 1/\sigma_i^2$ 也完全准确，那么 $S(\mathbf{p})$ 的[期望值](@entry_id:153208)应该是 $N-P$，从而 $GoF$ 的[期望值](@entry_id:153208)为1 [@problem_id:2517817]。
    *   $GoF \gg 1$ 通常意味着**[欠拟合](@entry_id:634904)**（underfitting）。模型不够复杂或不正确，无法描述数据中的所有系统性特征，导致加权残差远大于统计噪声的预期水平。
    *   $GoF \ll 1$ 则可能意味着**[过拟合](@entry_id:139093)**（overfitting）。模型过于灵活（参数过多），开始拟合数据中的随机噪声，或者权重被错误地低估了（即[方差](@entry_id:200758)被高估）。
    *   一个成功的精修通常追求 $GoF \approx 1$。例如，一个模型A参数较少（$P_A=70$）得到 $GoF_A = 2.2$，表明模型可能遗漏了某些物理效应。而另一个模型B使用大量参数（$P_B=150$）并人为地夸大了数据[方差](@entry_id:200758)，得到了 $GoF_B = 0.7$，这极有可能是[过拟合](@entry_id:139093)的迹象，多余的参数并没有真实的物理意义，只是在吸收噪声 [@problem_id:2517817]。

#### [参数不确定性](@entry_id:264387)与相关性

最小二乘精修不仅给出了参数的最佳估计值，还提供了它们的**不确定性**（标准偏差）和**相关性**。这些信息包含在**[协方差矩阵](@entry_id:139155)** $\mathbf{C}$ 中 [@problem_id:2517899]。

在最小二乘理论中，参数的[协方差矩阵](@entry_id:139155)是LM算法中出现的法方程矩阵（normal matrix）的逆：

$$
\mathbf{C} = (\mathbf{A}^\top \mathbf{W} \mathbf{A})^{-1}
$$

*   协方差矩阵的**对角元素** $C_{ii}$ 是参数 $p_i$ 的[方差](@entry_id:200758) $\sigma^2(p_i)$。其平方根 $\sigma(p_i)$ 就是我们常说的参数的标准不确定度（standard uncertainty）。

*   **非对角元素** $C_{ij}$ ($i \neq j$) 是参数 $p_i$ 和 $p_j$ 之间的协[方差](@entry_id:200758)。它量化了这两个参数估计误差之间的关联程度。为了更直观地理解，通常会将其归一化为**相关系数** $\rho_{ij} = C_{ij} / \sqrt{C_{ii}C_{jj}}$，其值在-1到1之间。
    *   $\rho_{ij}$ 接近0，表示两个参数在拟合中几乎不相互影响，是**不相关**的。
    *   $\rho_{ij}$ 接近+1，表示两个参数**强正相关**。这意味着如果模型高估了其中一个参数，它也倾向于高估另一个。
    *   $\rho_{ij}$ 接近-1，表示两个参数**强负相关**。这意味着高估一个参数的同时倾向于低估另一个，两者在模型中存在“权衡”（trade-off）关系。例如，在两个物相衍射峰严重重叠的情况下，它们的标度因子通常会呈现强烈的负相关。增加一个相的含量，必须减少另一个相的含量才能维持对重叠区域总强度的拟合 [@problem_id:2517899]。

分析相关性矩阵是诊断精修问题的重要手段。高的[参数相关性](@entry_id:274177)不仅会增大参数的不确定性，还可能导致精修不稳定。

### 高级应用与局限性

#### 多图谱精修：整合信息

Rietveld方法可以同时精修来自同一份样品但在不同条件下（如不同仪器、不同波长、不同温度）测得的多个衍射图谱 [@problem_id:2517838]。这种**多图谱精修**（multi-pattern refinement）的关键在于正确地共享和约束参数。
*   **样品固有参数**：如[晶格参数](@entry_id:191810)、原子坐标、占位度、相分数等，是样品的内在属性，不随测量条件改变。因此，它们应该在所有图谱间被**共享**或**约束为相同**。
*   **仪器相关参数**：如零点漂移、峰形参数、背景参数、标度因子等，是每次实验特有的。它们必须为每个图谱**独立精修**。

通过这种方式，多图谱精修能够利用来自不同实验的互补信息，更稳健、更精确地确定样品的结构和组成。

#### 超越理想晶体：方法的局限性

传统的Rietveld方法建立在晶体具有完美三维周期性的假设之上。当材料含有大量缺陷，如[堆垛层错](@entry_id:138255)、纳米畴或显著的[短程有序](@entry_id:158915)而缺乏长程有序时，这个基本假设就会被打破 [@problem_id:2517873]。此时，常规[Rietveld精修](@entry_id:147438)会遇到严重困难：

*   **衍射强度的重新[分布](@entry_id:182848)**：理想晶体的全部[相干散射](@entry_id:267724)能量都集中在布拉格峰中。而缺陷会使部分[散射强度](@entry_id:202196)从布拉格峰转移到峰之间，形成**结构化的漫散射**（structured diffuse scattering）。
*   **违反假设**：
    1.  “所有强度都在布拉格峰上”的假设失效。
    2.  “背景是平滑且与结构无关”的假设失效，因为漫散射本身就是结构信息的体现。
    3.  “峰形简单对称”的假设失效，因为[堆垛层错](@entry_id:138255)等缺陷会导致衍射峰呈现出高度各向异性和不对称的形状。
    4.  用于QPA的“标度因子正比于相分数”的假设失效，因为常规Rietveld模型只拟合了布拉格峰的强度，忽略了转移到漫散射中的那部分强度，从而系统性地低估了缺陷相的含量。

处理这类非理想晶体需要超越常规Rietveld方法的范畴，例如使用基于原子[对分布函数](@entry_id:145441)（PDF）的全散射方法，或者采用能够模拟特定缺陷（如[堆垛层错](@entry_id:138255)）对衍射图谱影响的专用模型。认识到这些局限性，是作为高级研究者正确运用衍射方法的关键一步。