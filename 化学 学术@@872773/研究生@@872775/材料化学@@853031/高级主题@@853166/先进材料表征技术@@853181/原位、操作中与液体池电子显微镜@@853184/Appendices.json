{"hands_on_practices": [{"introduction": "液体环境是原位电子显微镜的核心，但也带来了主要挑战：电子束在穿过液体时会发生显著的非弹性散射。量化这种散射效应是理解图像衬度、分辨率和样品厚度限制的第一步。本练习将通过非弹性平均自由程（$\\lambda$）和泊松统计模型，帮助你计算穿过水层后零损失电子的比例以及每个电子的平均散射次数，从而对多重散射问题建立起一个定量的认识[@problem_id:2492582]。", "problem": "在一次液体池透射电子显微镜 (LCTEM) 实验中，加速电压为 $200\\,\\mathrm{keV}$ 的单能电子束穿过一层厚度均匀为 $t=300\\,\\mathrm{nm}$ 的水层。假设非弹性散射事件沿路径是独立且稀有的，因此单个电子在路径长度上累积的非弹性事件数可以建模为一个泊松过程，其非弹性平均自由程 $\\lambda=120\\,\\mathrm{nm}$ 且与深度无关。仅使用平均自由程的定义、独立事件的泊松分布性质以及独立散射过程的指数衰减概念，推导透射电子中经历零次非弹性散射事件的电子比例（表示为 $I_{0}/I_{t}$）和每个透射电子的预期非弹性散射事件数（表示为 $\\langle N\\rangle$）的表达式。然后，对于给定的 $t$ 和 $\\lambda$，对这两个量进行数值计算。将两个结果四舍五入到 $4$ 位有效数字，并以无单位小数的形式报告。按顺序 $\\left(I_{0}/I_{t},\\,\\langle N\\rangle\\right)$ 提供这两个数。[@problem_id:149]", "solution": "首先必须严格验证所述问题的科学性和逻辑一致性。\n\n**步骤 1：提取已知条件**\n提供了以下参数和条件：\n- 电子束加速电压：`$200\\,\\mathrm{keV}`$。\n- 水层均匀厚度：`$t = 300\\,\\mathrm{nm}`$。\n- 非弹性平均自由程（与深度无关）：`$\\lambda = 120\\,\\mathrm{nm}`$。\n- 非弹性散射事件的数量被建模为泊松过程。\n- 目标是推导表达式并进行数值计算：\n    1.  `$I_{0}/I_{t}$`：发生零次非弹性散射的透射电子的比例。\n    2.  `$\\langle N\\rangle$`：每个透射电子的预期非弹性散射事件数。\n- 数值结果必须四舍五入到 `$4$` 位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据。该场景描述了电子显微学中的一个标准问题，特别是对薄液态样品中电子散射的分析。非弹性平均自由程（`$\\lambda$`）、散射的泊松统计以及指数衰减（比尔-朗伯定律）等概念是该领域的基本原理。所提供的厚度（`$t = 300\\,\\mathrm{nm}$`）、平均自由程（`$\\lambda = 120\\,\\mathrm{nm}$`）和加速电压（`$200\\,\\mathrm{keV}$`）的值对于液体池透射电镜实验是合理的。该问题提法恰当、内容自洽且客观，为求得唯一解提供了所有必要信息，没有歧义或矛盾。加速电压参数虽然在上下文中是相关的，但对于涉及 `$t$` 和 `$\\lambda$` 的具体计算并非必需，这并不构成缺陷。该问题是对基本原理的有效检验。\n\n**步骤 3：结论与行动**\n问题有效。我将继续进行推导和求解。\n\n**解题推导**\n该问题要求基于第一性原理进行推导。让我们定义 `$P_k(x)$` 为电子在材料中行进距离 `$x$` 后，恰好经历了 `$k$` 次非弹性散射事件的概率。因此，经历零次非弹性散射事件的电子比例为 `$P_0(t)$`，这对应于比率 `$I_0/I_t$`。\n\n非弹性平均自由程 `$\\lambda$` 是电子在两次非弹性碰撞之间行进的平均距离。因此，在无穷小路径长度 `$\\mathrm{d}x$` 内发生一次非弹性散射事件的概率由 `$\\mathrm{d}p = \\frac{\\mathrm{d}x}{\\lambda}`$ 给出。\n\n首先，我们推导 `$I_{0}/I_{t} = P_0(t)$` 的表达式。\n一个电子要在行进距离 `$x + \\mathrm{d}x$` 后没有发生散射事件，它必须在行进到距离 `$x$` 时没有发生事件，并且在随后的区间 `$\\mathrm{d}x$` 内也没有发生事件。在 `$\\mathrm{d}x$` 内不发生散射的概率是 `$(1 - \\mathrm{d}p) = (1 - \\frac{\\mathrm{d}x}{\\lambda})$`。由于这些事件是独立的，我们可以写出：\n$$P_0(x + \\mathrm{d}x) = P_0(x) \\left(1 - \\frac{\\mathrm{d}x}{\\lambda}\\right)$$\n重新整理这个表达式，我们得到：\n$$\\frac{P_0(x + \\mathrm{d}x) - P_0(x)}{\\mathrm{d}x} = -\\frac{P_0(x)}{\\lambda}$$\n取极限 `$\\mathrm{d}x \\to 0$`，我们得到一个一阶常微分方程：\n$$\\frac{\\mathrm{d}P_0(x)}{\\mathrm{d}x} = -\\frac{1}{\\lambda} P_0(x)$$\n该方程的求解需要初始条件：在材料入口处（`$x=0$`），没有发生散射，因此 `$P_0(0) = 1$`。解是一个标准的指数衰减函数：\n$$P_0(x) = \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n对总厚度 `$t$` 计算此式，我们得到零损失电子的比例：\n$$ \\frac{I_0}{I_t} = P_0(t) = \\exp\\left(-\\frac{t}{\\lambda}\\right) $$\n这个结果与泊松分布一致。在长度 `$t$` 上的平均事件数是 `$\\mu = t/\\lambda$`。对于泊松过程，观测到 `$k=0$` 个事件的概率是 `$P(N=0) = \\frac{\\mu^0 e^{-\\mu}}{0!} = e^{-\\mu} = \\exp(-t/\\lambda)$`。\n\n接下来，我们推导非弹性散射事件的期望数 `$\\langle N\\rangle$` 的表达式。\n根据定义，这个量是散射事件泊松分布的均值。单位长度的事件发生率是恒定的，等于 `$1/\\lambda$`。对于总路径长度 `$t$`，期望事件数是发生率乘以路径长度。\n$$ \\langle N\\rangle = \\left(\\frac{1}{\\lambda}\\right) \\times t = \\frac{t}{\\lambda} $$\n这就是泊松分布的参数 `$\\mu$`，也就是它的期望值。\n\n**数值计算**\n给定 `$t = 300\\,\\mathrm{nm}$` 和 `$\\lambda = 120\\,\\mathrm{nm}`$。首先，我们计算关键的无量纲参数 `$t/\\lambda$`。\n$$ \\frac{t}{\\lambda} = \\frac{300\\,\\mathrm{nm}}{120\\,\\mathrm{nm}} = 2.5 $$\n现在我们可以计算所需的两个量。\n\n1.  零损失电子的比例，`$I_{0}/I_{t}$`：\n$$ \\frac{I_0}{I_t} = \\exp\\left(-\\frac{t}{\\lambda}\\right) = \\exp(-2.5) $$\n数值上，这个值是 `$0.08208499...$`。四舍五入到 `$4$` 位有效数字得到 `$0.08208$`。\n\n2.  预期非弹性散射事件数，`$\\langle N\\rangle$`：\n$$ \\langle N\\rangle = \\frac{t}{\\lambda} = 2.5 $$\n为了用 `$4$` 位有效数字表示，我们写作 `$2.500$`。\n\n最终答案要求按顺序给出这两个数，`$I_{0}/I_{t}$` 和 `$\\langle N\\rangle$`。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.08208  2.500 \\end{pmatrix} } $$", "id": "2492582"}, {"introduction": "电子束与液体的相互作用并非总是无害的；水辐解产生的活性物质是一个关键的干扰项，它可能会改变我们希望观察的化学反应本身。本练习旨在从被动理解转向主动控制，探讨如何通过在时间上“雕刻”电子束剂量（即束闸技术）来管理活性自由基的浓度。你将分析不同的曝光策略，以在不牺牲时间分辨率和信噪比的前提下，找到抑制辐解效应的最优方案，这正是在实验中需要权衡的实际问题[@problem_id:2492584]。", "problem": "在液体池透射电子显微镜 (LCTEM) 中，电子束下的水辐解会产生活性物种，这些物种会干扰溶液化学并使成核过程产生偏差。考虑一个混合均匀的观察像素（其空间尺度与帧周期内的扩散长度相比很小），其中一种代表性的还原性自由基的浓度（表示为 $C(t)$）遵循一个质量平衡方程，该方程包含一个与电子束相关的生成项和一个向有效清除剂池的一级消除项：\n$$\n\\frac{dC}{dt} = r(t) - k C(t),\n$$\n其中 $r(t)$ 是辐照期间的自由基生成速率，$k$ 是一级消除速率常数。假设对于含有清除剂的水基介质中受辐解限制的动力学，以下已知且经过充分检验的事实成立：(i) 自由基的生成与瞬时剂量率成正比；(ii) 在固定组分下，在所关注的时间尺度上，占主导地位的长寿命物种池的消除可以很好地用一个有效的一级速率常数来描述；(iii) 当电子束被遮挡时，$r(t)=0$。\n\n您正在设计一个实验来观察一个成核事件，该事件在约 $t_{\\mathrm{nuc}} \\approx 50\\,\\mathrm{ms}$ 的时间尺度上演化。为了保持时间分辨率，您需要帧周期为 $T = 10\\,\\mathrm{ms}$，且曝光门宽不大于 $1\\,\\mathrm{ms}$，以使帧内运动模糊保持在成核动力学时间尺度以下。探测器是散粒噪声受限的，每帧的信噪比 (SNR) 与该帧期间积分的电子数的平方根成正比；因此，为了保持信噪比至少与指定基线一样大，每帧的电子剂量必须相对于基线保持不变。\n\n基线条件：在恒定剂量率的连续辐照下，对应的自由基生成速率为 $r_c = 100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$，有效消除速率为 $k = 50\\,\\mathrm{s}^{-1}$，稳态浓度为 $C_{\\mathrm{ss}} = r_c/k = 2\\,\\mu\\mathrm{M}$。已知只要瞬时自由基浓度保持在阈值 $C_{\\mathrm{crit}} = 3\\,\\mu\\mathrm{M}$ 以下，成核化学过程就不会产生偏差。\n\n您正在考虑在每个 $T = 10\\,\\mathrm{ms}$ 的帧内采用几种不同的辐照策略，以减轻累积辐解，同时保持时间分辨率要求。在所有声称能保持信噪比的策略中，每帧的总电子剂量等于基线剂量（即，瞬时剂量率在 $T$ 上的时间积分保持不变）。对于每种策略，在开启门期间 $r(t)$ 等于一个常数 $r_{\\mathrm{on}}$，在遮挡期间等于 $0$，其中 $r_{\\mathrm{on}}$ 的选择是为了在需要时保持每帧剂量与基线剂量相等。假设在像素尺度上，样品在 $T$ 时间内的行为如同一个空间均匀、混合良好的反应器。\n\n哪种或哪些策略同时满足以下所有条件：(1) 在稳态周期性操作中，对于所有 $t$，$C(t)  C_{\\mathrm{crit}}$；(2) 每次子曝光的曝光门宽 $\\le 1\\,\\mathrm{ms}$，以控制运动模糊；(3) 每帧信噪比至少与基线一样大？\n\nA. 连续辐照，不使用电子束遮挡：对所有 $t$，$r(t) = r_c$；相机以 $100\\,\\mathrm{frames/s}$ 的速率输出，每帧的有效曝光时间为 $10\\,\\mathrm{ms}$。\n\nB. 单脉冲电子束遮挡：在每个 $10\\,\\mathrm{ms}$ 帧的开始处，有一个宽度为 $w = 1\\,\\mathrm{ms}$ 的开启门，并选择 $r_{\\mathrm{on}}$ 以使每帧剂量等于基线剂量。\n\nC. 帧内剂量分割：在每个 $10\\,\\mathrm{ms}$ 帧内，有五个宽度为 $w_p = 0.2\\,\\mathrm{ms}$ 的开启门，它们之间由 $1.8\\,\\mathrm{ms}$ 的遮挡间隔分开，并选择 $r_{\\mathrm{on}}$ 以使每帧剂量等于基线剂量。\n\nD. 使用更长门宽的单脉冲电子束遮挡：每帧一个宽度为 $w = 2\\,\\mathrm{ms}$ 的开启门，并选择 $r_{\\mathrm{on}}$ 以使每帧剂量等于基线剂量。\n\nE. 使用降低的每帧剂量的单脉冲电子束遮挡：每帧一个宽度为 $w = 1\\,\\mathrm{ms}$ 的开启门，并选择 $r_{\\mathrm{on}}$ 以使每帧电子剂量为基线剂量的一半。\n\n选择所有适用项。", "solution": "问题陈述已经过验证，被确定为具有科学依据、问题明确且自洽。所有解决该问题所需的数据均已提供。我们可以开始求解。\n\n该问题要求我们分析液体池透射电子显微镜 (LCTEM) 中的几种电子束辐照策略。一种自由基物种的浓度 $C(t)$ 由以下一阶线性常微分方程决定：\n$$\n\\frac{dC}{dt} = r(t) - k C(t)\n$$\n其中 $r(t)$ 是生成速率，$k$ 是消除速率常数。给定 $k = 50\\,\\mathrm{s}^{-1}$。我们必须根据三个同时满足的条件来评估每个提议的策略：\n1.  在稳态周期性操作中，峰值自由基浓度必须始终保持在临界阈值以下：$C(t)  C_{\\mathrm{crit}} = 3\\,\\mu\\mathrm{M}$。\n2.  任何单次连续曝光的持续时间（开启门宽度）必须小于或等于 $1\\,\\mathrm{ms}$，以减轻运动模糊。\n3.  每帧的信噪比 (SNR) 必须至少与基线相同，这要求每帧的总电子剂量保持不变。\n\n基线是连续辐照，其中 $r(t) = r_c = 100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$。在周期 $T=10\\,\\mathrm{ms}=0.01\\,\\mathrm{s}$ 的每帧内，总的自由基生成量与速率的积分成正比，我们称之为“剂量等效量”$D_f$：\n$$\nD_{f, \\text{base}} = \\int_0^T r_c \\, dt = r_c T = (100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(0.01\\,\\mathrm{s}) = 1\\,\\mu\\mathrm{M}.\n$$\n对于任何脉冲策略，要满足条件 (3)，其每帧的总生成量也必须是 $1\\,\\mu\\mathrm{M}$。如果每帧的总开启时间是 $W_{\\mathrm{tot}}$，则脉冲期间的生成速率 $r_{\\mathrm{on}}$ 必须满足 $r_{\\mathrm{on}} W_{\\mathrm{tot}} = r_c T$。\n\n我们将在稳态周期性状态下分析该系统。对于一个通用策略，其重复周期包括一个持续时间为 $w$、生成速率为 $r_{\\mathrm{on}}$ 的“开启”脉冲，以及一个持续时间为 $T-w$、生成速率为 $0$ 的“关闭”（遮挡）周期，我们可以求出最大浓度 $C_{\\mathrm{max}}$。浓度在“开启”阶段增加，在“关闭”阶段减少。因此，最大浓度出现在“开启”脉冲结束时。\n\n从初始浓度 $C_{\\mathrm{min}}$ 开始，在“开启”阶段（$0 \\le t \\le w$）控制常微分方程的解为：\n$$\nC(t) = \\frac{r_{\\mathrm{on}}}{k} \\left(1 - e^{-kt}\\right) + C_{\\mathrm{min}} e^{-kt}\n$$\n峰值浓度在 $t=w$ 时达到：$C_{\\mathrm{max}} = C(w) = \\frac{r_{\\mathrm{on}}}{k} \\left(1 - e^{-kw}\\right) + C_{\\mathrm{min}} e^{-kw}$。在“关闭”阶段（$w  t \\le T$），解为 $C(t) = C_{\\mathrm{max}} e^{-k(t-w)}$。对于稳态周期性状态，$C(T) = C_{\\mathrm{min}}$。因此，$C_{\\mathrm{min}} = C_{\\mathrm{max}} e^{-k(T-w)}$。求解这个由两个方程组成的方程组，得到 $C_{\\mathrm{max}}$：\n$$\nC_{\\mathrm{max}} = \\frac{r_{\\mathrm{on}}}{k} \\frac{1 - e^{-kw}}{1 - e^{-kT}}\n$$\n我们将使用此公式来评估各种策略。\n\n**A. 连续辐照**\n此处，对所有 $t$，$r(t) = r_c = 100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$。系统达到稳态，此时 $\\frac{dC}{dt}=0$，得到 $C(t) = C_{\\mathrm{ss}} = r_c/k$。\n$C_{\\mathrm{ss}} = (100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}) / (50\\,\\mathrm{s}^{-1}) = 2\\,\\mu\\mathrm{M}$。\n\n1.  **浓度检查**：$C(t) = 2\\,\\mu\\mathrm{M}$。由于 $2\\,\\mu\\mathrm{M}  C_{\\mathrm{crit}} = 3\\,\\mu\\mathrm{M}$，该条件 **满足**。\n2.  **门宽检查**：问题陈述指出“有效曝光时间”为 $10\\,\\mathrm{ms}$。这是开启门宽度。$10\\,\\mathrm{ms} > 1\\,\\mathrm{ms}$。该条件 **不满足**。\n3.  **信噪比检查**：这是基线，因此根据定义，信噪比得以保持。该条件 **满足**。\n\n由于条件 (2) 未满足，策略 A 是 **不正确的**。\n\n**B. 单脉冲电子束遮挡**\n帧包含一个宽度为 $w = 1\\,\\mathrm{ms} = 0.001\\,\\mathrm{s}$ 的开启门，周期为 $T = 10\\,\\mathrm{ms} = 0.01\\,\\mathrm{s}$。\n为了保持剂量（条件 3），$r_{\\mathrm{on}} w = r_c T$，所以 $r_{\\mathrm{on}} = r_c (T/w) = (100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(10\\,\\mathrm{ms}/1\\,\\mathrm{ms}) = 1000\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$。\n我们使用推导出的公式计算 $C_{\\mathrm{max}}$，其中 $k=50\\,\\mathrm{s}^{-1}$：\n$kw = (50\\,\\mathrm{s}^{-1})(0.001\\,\\mathrm{s}) = 0.05$。\n$kT = (50\\,\\mathrm{s}^{-1})(0.01\\,\\mathrm{s}) = 0.5$。\n$r_{\\mathrm{on}}/k = (1000\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}) / (50\\,\\mathrm{s}^{-1}) = 20\\,\\mu\\mathrm{M}$。\n$$\nC_{\\mathrm{max}} = (20\\,\\mu\\mathrm{M}) \\frac{1 - e^{-0.05}}{1 - e^{-0.5}} \\approx (20\\,\\mu\\mathrm{M}) \\frac{1 - 0.95123}{1 - 0.60653} = (20\\,\\mu\\mathrm{M}) \\frac{0.04877}{0.39347} \\approx 2.479\\,\\mu\\mathrm{M}.\n$$\n1.  **浓度检查**：$C_{\\mathrm{max}} \\approx 2.48\\,\\mu\\mathrm{M}$。由于 $2.48\\,\\mu\\mathrm{M}  3\\,\\mu\\mathrm{M}$，该条件 **满足**。\n2.  **门宽检查**：门宽为 $w=1\\,\\mathrm{ms}$。由于 $1\\,\\mathrm{ms} \\le 1\\,\\mathrm{ms}$，该条件 **满足**。\n3.  **信噪比检查**：通过设计保持了剂量。该条件 **满足**。\n\n由于所有三个条件都满足，策略 B 是 **正确的**。\n\n**C. 帧内剂量分割**\n该策略使用 $N=5$ 个开启门，每个宽度为 $w_p = 0.2\\,\\mathrm{ms} = 0.0002\\,\\mathrm{s}$。总开启时间为 $W_{\\mathrm{tot}} = 5 \\times 0.2\\,\\mathrm{ms} = 1.0\\,\\mathrm{ms}$。\n为了保持剂量（条件 3），$r_{\\mathrm{on}} W_{\\mathrm{tot}} = r_c T$，所以 $r_{\\mathrm{on}} = r_c T / W_{\\mathrm{tot}} = (100\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(10\\,\\mathrm{ms}/1.0\\,\\mathrm{ms}) = 1000\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$。\n脉冲模式每 $2\\,\\mathrm{ms}$ 重复一次（$0.2\\,\\mathrm{ms}$ 开启，$1.8\\,\\mathrm{ms}$ 关闭）。我们分析这个更短的周期，$T_p = 2\\,\\mathrm{ms} = 0.002\\,\\mathrm{s}$，脉冲宽度为 $w_p = 0.2\\,\\mathrm{ms}$。\n$kw_p = (50\\,\\mathrm{s}^{-1})(0.0002\\,\\mathrm{s}) = 0.01$。\n$kT_p = (50\\,\\mathrm{s}^{-1})(0.002\\,\\mathrm{s}) = 0.1$。\n$r_{\\mathrm{on}}/k = (1000\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}) / (50\\,\\mathrm{s}^{-1}) = 20\\,\\mu\\mathrm{M}$。\n$$\nC_{\\mathrm{max}} = (20\\,\\mu\\mathrm{M}) \\frac{1 - e^{-0.01}}{1 - e^{-0.1}} \\approx (20\\,\\mu\\mathrm{M}) \\frac{1 - 0.99005}{1 - 0.90484} = (20\\,\\mu\\mathrm{M}) \\frac{0.00995}{0.09516} \\approx 2.091\\,\\mu\\mathrm{M}.\n$$\n1.  **浓度检查**：$C_{\\mathrm{max}} \\approx 2.09\\,\\mu\\mathrm{M}$。由于 $2.09\\,\\mu\\mathrm{M}  3\\,\\mu\\mathrm{M}$，该条件 **满足**。\n2.  **门宽检查**：每个子曝光的门宽为 $w_p=0.2\\,\\mathrm{ms}$。由于 $0.2\\,\\mathrm{ms} \\le 1\\,\\mathrm{ms}$，该条件 **满足**。\n3.  **信噪比检查**：通过设计保持了总剂量。该条件 **满足**。\n\n由于所有三个条件都满足，策略 C 是 **正确的**。\n\n**D. 使用更长门宽的单脉冲电子束遮挡**\n开启门宽度为 $w = 2\\,\\mathrm{ms}$。\n\n1.  **浓度检查**：无需进行。\n2.  **门宽检查**：门宽为 $w=2\\,\\mathrm{ms}$。由于 $2\\,\\mathrm{ms} > 1\\,\\mathrm{ms}$，该条件 **不满足**。\n3.  **信噪比检查**：问题陈述指出剂量得以保持。该条件 **满足**。\n\n由于条件 (2) 未满足，策略 D 是 **不正确的**。\n\n**E. 使用降低的每帧剂量的单脉冲电子束遮挡**\n开启门宽度为 $w=1\\,\\mathrm{ms}$，每帧剂量是基线的一半。\n\n1.  **浓度检查**：峰值浓度将是策略 B 的一半，因为 $r_{\\mathrm{on}}$ 将减半。$C_{\\mathrm{max}} = 0.5 \\times 2.48\\,\\mu\\mathrm{M} = 1.24\\,\\mu\\mathrm{M}$。这小于 $3\\,\\mu\\mathrm{M}$。该条件 **满足**。\n2.  **门宽检查**：$w=1\\,\\mathrm{ms}$。该条件 **满足**。\n3.  **信噪比检查**：每帧剂量减半。由于信噪比与剂量的平方根成正比，新的信噪比是基线信噪比的 $1/\\sqrt{2} \\approx 0.707$ 倍。这是一个降低。该条件 **不满足**。\n\n由于条件 (3) 未满足，策略 E 是 **不正确的**。\n\n综上所述，只有策略 B 和 C 满足所有指定约束。", "answer": "$$\\boxed{BC}$$", "id": "2492584"}, {"introduction": "在解决了样品与电子束的相互作用后，我们的注意力转向信号的探测与优化。在液体池扫描透射电子显微镜（STEM）中，来自纳米颗粒的信号总是叠加在来自液体的强烈散射背景之上。这个计算练习要求你对信号和背景进行建模，并优化环形暗场探测器的收集角度（$\\alpha_{i}$ 和 $\\alpha_{o}$），以最大化信噪比（SNR），从而展示如何通过精心的实验设计来主动提升数据质量[@problem_id:2492589]。", "problem": "您正在研究在原位 (in situ) 或操作 (operando) 条件下，微流控池中分散在液体里的纳米粒子的扫描透射电子显微镜 (STEM) 成像。在使用环形探测器的 STEM 中，探测强度是通过将极角依赖的散射强度在探测器的角接收范围内积分得到的。对于轴对称电子束和探测器，立体角元的小角度近似适用，因此，通过使用立体角元 $d\\Omega \\approx 2\\pi \\theta \\, d\\theta$ 进行积分，可以计算出在内半角和外半角之间收集到的强度，其中 $\\theta$ 是散射半角。假设粒子（信号）和液体（背景）对每单位立体角的微分强度的贡献由以下具有物理动机且被广泛使用的形式给出：\n- 粒子的角分布（信号）被建模为屏蔽类卢瑟福 (screened Rutherford-like) 尾：$S(\\theta) = \\dfrac{A_{\\mathrm{P}}}{\\left(\\theta^{2} + \\theta_{s}^{2}\\right)^{2}}$，其中 $A_{\\mathrm{P}}$ 是一个正振幅，$\\theta_{s}$ 是一个正屏蔽角。\n- 液体的角分布（背景）被建模为宽类洛伦兹 (broad Lorentzian-like) 尾：$B(\\theta) = \\dfrac{A_{\\mathrm{L}} \\, \\theta_{\\mathrm{L}}^{2}}{\\theta^{2} + \\theta_{\\mathrm{L}}^{2}}$，其中 $A_{\\mathrm{L}}$ 和 $\\theta_{\\mathrm{L}}$ 是编码液体散射强度和宽度的正参数。\n\n假设泊松计数统计，因此由内半角 $\\alpha_{i}$ 和外半角 $\\alpha_{o}$ 定义的环带的信噪比 (SNR) 由 $ \\mathrm{SNR} = \\dfrac{I_{S}}{\\sqrt{I_{S} + I_{B}}}$ 给出，其中 $I_{S}$ 和 $I_{B}$ 是环带收集到的信号和背景计数：\n- $I_{S} = \\displaystyle \\int_{\\alpha_{i}}^{\\alpha_{o}} S(\\theta)\\, 2\\pi \\theta \\, d\\theta$,\n- $I_{B} = \\displaystyle \\int_{\\alpha_{i}}^{\\alpha_{o}} B(\\theta)\\, 2\\pi \\theta \\, d\\theta$.\n\n所有角度都以毫弧度 (mrad) 为单位处理和报告。所有的 $A_{\\mathrm{P}}$ 和 $A_{\\mathrm{L}}$ 都是正实数，SNR 是无量纲的。\n\n您的任务是编写一个完整的程序，该程序：\n1. 根据上述定义，推导并实现数值稳定的表达式来计算 $I_{S}$ 和 $I_{B}$，要求不引入非物理的发散，并使用小角度立体角元以及给定的 $S(\\theta)$ 和 $B(\\theta)$ 函数。\n2. 对于给定的探测器几何结构和材料参数，计算 $\\mathrm{SNR}(\\alpha_{i}, \\alpha_{o})$。\n3. 通过在受最小环带宽约束的可行设计区域内优化探测器的内外半角，提出信噪比的改进方案。优化问题是：在满足 $\\alpha_{\\min} \\le \\alpha_{i}  \\alpha_{o} \\le \\alpha_{\\max}$ 和 $\\alpha_{o} - \\alpha_{i} \\ge \\Delta_{\\min}$ 的条件下，最大化 $\\mathrm{SNR}(\\alpha_{i}, \\alpha_{o})$。在可行区域上使用步长均匀的 $\\Delta_{\\theta}$ 进行离散网格搜索，以产生可复现的最优解。\n\n使用以下测试套件。对于每个用例，计算指定当前探测器几何结构下的当前信噪比，然后计算优化后的信噪比和相应的优化角度，最后计算定义为优化后信噪比与当前信噪比之比的信噪比增益。所有角度均以毫弧度 (mrad) 为单位。将 SNR 值以小数浮点数形式报告，角度以 mrad 为单位报告。\n\n测试用例：\n- 用例 1 (典型情况)：$A_{\\mathrm{P}} = 100.0$，$\\theta_{s} = 0.6$， $A_{\\mathrm{L}} = 0.02$，$\\theta_{\\mathrm{L}} = 8.0$，当前探测器 $\\left[\\alpha_{i}, \\alpha_{o}\\right] = \\left[20.0, 80.0\\right]$，可行区域 $\\alpha_{\\min} = 5.0$，$\\alpha_{\\max} = 120.0$，最小环带宽度 $\\Delta_{\\min} = 5.0$，网格步长 $\\Delta_{\\theta} = 0.5$。\n- 用例 2 (边界聚焦)：$A_{\\mathrm{P}} = 80.0$，$\\theta_{s} = 0.6$， $A_{\\mathrm{L}} = 0.005$，$\\theta_{\\mathrm{L}} = 5.0$，当前探测器 $\\left[\\alpha_{i}, \\alpha_{o}\\right] = \\left[10.0, 40.0\\right]$，可行区域 $\\alpha_{\\min} = 5.0$，$\\alpha_{\\max} = 60.0$，最小环带宽度 $\\Delta_{\\min} = 5.0$，网格步长 $\\Delta_{\\theta} = 0.5$。\n- 用例 3 (宽液体背景)：$A_{\\mathrm{P}} = 60.0$，$\\theta_{s} = 0.8$，$A_{\\mathrm{L}} = 0.05$，$\\theta_{\\mathrm{L}} = 20.0$，当前探测器 $\\left[\\alpha_{i}, \\alpha_{o}\\right] = \\left[40.0, 100.0\\right]$，可行区域 $\\alpha_{\\min} = 5.0$，$\\alpha_{\\max} = 120.0$，最小环带宽度 $\\Delta_{\\min} = 5.0$，网格步长 $\\Delta_{\\theta} = 0.5$。\n\n角度单位：毫弧度。数值输出必须使用以下单位和舍入规则报告：\n- 将 SNR 值和增益报告为四舍五入到 $6$ 位小数的小数浮点数。\n- 将角度 $\\alpha_{i}$ 和 $\\alpha_{o}$ 以毫弧度为单位报告，并四舍五入到 $1$ 位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素是针对一个测试用例的 5 元素列表，按给定顺序排列，格式为 $[\\mathrm{SNR}_{\\mathrm{current}}, \\mathrm{SNR}_{\\mathrm{opt}}, \\alpha_{i,\\mathrm{opt}}, \\alpha_{o,\\mathrm{opt}}, \\mathrm{gain}]$。例如，输出必须看起来像：$[[\\dots],[\\dots],[\\dots]]$。", "solution": "问题陈述经过了严格的验证。\n\n### 步骤 1：提取已知条件\n提供了以下数据和定义：\n- 粒子（信号）微分强度：$S(\\theta) = \\dfrac{A_{\\mathrm{P}}}{\\left(\\theta^{2} + \\theta_{s}^{2}\\right)^{2}}$，其中 $A_{\\mathrm{P}}  0$ 且 $\\theta_{s}  0$。\n- 液体（背景）微分强度：$B(\\theta) = \\dfrac{A_{\\mathrm{L}} \\, \\theta_{\\mathrm{L}}^{2}}{\\theta^{2} + \\theta_{\\mathrm{L}}^{2}}$，其中 $A_{\\mathrm{L}}  0$ 且 $\\theta_{\\mathrm{L}}  0$。\n- 小角度立体角元：$d\\Omega \\approx 2\\pi \\theta \\, d\\theta$。\n- 在环带 $[\\alpha_{i}, \\alpha_{o}]$ 上的积分信号计数：$I_{S} = \\displaystyle \\int_{\\alpha_{i}}^{\\alpha_{o}} S(\\theta)\\, 2\\pi \\theta \\, d\\theta$。\n- 在环带 $[\\alpha_{i}, \\alpha_{o}]$ 上的积分背景计数：$I_{B} = \\displaystyle \\int_{\\alpha_{i}}^{\\alpha_{o}} B(\\theta)\\, 2\\pi \\theta \\, d\\theta$。\n- 泊松统计下的信噪比 (SNR)：$\\mathrm{SNR} = \\dfrac{I_{S}}{\\sqrt{I_{S} + I_{B}}}$。\n- 优化目标：最大化 $\\mathrm{SNR}(\\alpha_{i}, \\alpha_{o})$。\n- 优化约束：$\\alpha_{\\min} \\le \\alpha_{i}  \\alpha_{o} \\le \\alpha_{\\max}$ 和 $\\alpha_{o} - \\alpha_{i} \\ge \\Delta_{\\min}$。\n- 优化方法：使用均匀步长 $\\Delta_{\\theta}$ 的离散网格搜索。\n- 提供了三个测试用例，包含所有参数的具体数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n- **科学基础（关键）**：该问题基于已建立的 STEM 电子散射物理模型。用于粒子散射的屏蔽类卢瑟福模型和用于液体漫散射背景的类洛伦兹模型是标准的、有物理动机的近似。SNR 公式是假设散粒噪声受限探测（服从泊松统计）的直接结果，这是计数实验中的一个基本概念。\n- **适定性**：该问题在数学上是适定的。对于 $\\theta > 0$，$I_S$ 和 $I_B$ 的被积函数是非负且有限的，并且在任何有限区间 $[\\alpha_i, \\alpha_o]$ 上的积分都是收敛的。优化是在一个离散、紧凑的可行角度对集合上进行的，这保证了最大值存在，并且指定的网格搜索将可复现地找到它。\n- **客观性（关键）**：问题以客观、定量的方式陈述，使用精确的数学语言，没有任何主观或模糊的术语。\n- **完整性与一致性**：问题陈述是自洽的。所有必需的方程、参数、约束和测试数据都已提供。设置中没有矛盾。\n- **可行性**：参数和条件在液池 STEM 实验的物理合理范围内。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。它在科学上是合理的，数学上是适定的，并且为解决它提供了所有必要的信息。将逐步制定解决方案。\n\n### 解题推导\n\n该解决方案需要三个主要部分：积分强度的解析评估、SNR 的计算，以及通过网格搜索优化探测器几何结构。\n\n**1. 积分强度的解析评估**\n\n为确保数值稳定性和准确性，我们首先推导积分信号 $I_S$ 和背景 $I_B$ 的闭式解析表达式。\n\n积分信号 $I_S$ 由以下公式给出：\n$$ I_{S} = \\int_{\\alpha_{i}}^{\\alpha_{o}} S(\\theta)\\, 2\\pi \\theta \\, d\\theta = \\int_{\\alpha_{i}}^{\\alpha_{o}} \\frac{A_{\\mathrm{P}}}{(\\theta^2 + \\theta_s^2)^2} 2\\pi \\theta \\, d\\theta $$\n我们进行换元。令 $u = \\theta^2 + \\theta_s^2$。那么，微分为 $du = 2\\theta \\, d\\theta$。积分的上下限变为 $u(\\alpha_i) = \\alpha_i^2 + \\theta_s^2$ 和 $u(\\alpha_o) = \\alpha_o^2 + \\theta_s^2$。积分变为：\n$$ I_{S} = \\pi A_{\\mathrm{P}} \\int_{\\alpha_i^2 + \\theta_s^2}^{\\alpha_o^2 + \\theta_s^2} \\frac{du}{u^2} = \\pi A_{\\mathrm{P}} \\left[ -\\frac{1}{u} \\right]_{\\alpha_i^2 + \\theta_s^2}^{\\alpha_o^2 + \\theta_s^2} $$\n$$ I_{S}(\\alpha_i, \\alpha_o) = \\pi A_{\\mathrm{P}} \\left( -\\frac{1}{\\alpha_o^2 + \\theta_s^2} - \\left(-\\frac{1}{\\alpha_i^2 + \\theta_s^2}\\right) \\right) = \\pi A_{\\mathrm{P}} \\left( \\frac{1}{\\alpha_i^2 + \\theta_s^2} - \\frac{1}{\\alpha_o^2 + \\theta_s^2} \\right) $$\n此表达式是数值稳定的，因为 $\\theta_s^2 > 0$ 可以防止任何除以零的情况。\n\n积分背景 $I_B$ 由以下公式给出：\n$$ I_{B} = \\int_{\\alpha_{i}}^{\\alpha_{o}} B(\\theta)\\, 2\\pi \\theta \\, d\\theta = \\int_{\\alpha_{i}}^{\\alpha_{o}} \\frac{A_{\\mathrm{L}} \\theta_{\\mathrm{L}}^2}{\\theta^2 + \\theta_{\\mathrm{L}}^2} 2\\pi \\theta \\, d\\theta $$\n我们进行类似的换元。令 $v = \\theta^2 + \\theta_{\\mathrm{L}}^2$。那么，$dv = 2\\theta \\, d\\theta$。积分的上下限变为 $v(\\alpha_i) = \\alpha_i^2 + \\theta_{\\mathrm{L}}^2$ 和 $v(\\alpha_o) = \\alpha_o^2 + \\theta_{\\mathrm{L}}^2$。积分变为：\n$$ I_{B} = \\pi A_{\\mathrm{L}} \\theta_{\\mathrm{L}}^2 \\int_{\\alpha_i^2 + \\theta_{\\mathrm{L}}^2}^{\\alpha_o^2 + \\theta_{\\mathrm{L}}^2} \\frac{dv}{v} = \\pi A_{\\mathrm{L}} \\theta_{\\mathrm{L}}^2 \\left[ \\ln(v) \\right]_{\\alpha_i^2 + \\theta_{\\mathrm{L}}^2}^{\\alpha_o^2 + \\theta_{\\mathrm{L}}^2} $$\n$$ I_{B}(\\alpha_i, \\alpha_o) = \\pi A_{\\mathrm{L}} \\theta_{\\mathrm{L}}^2 \\left( \\ln(\\alpha_o^2 + \\theta_{\\mathrm{L}}^2) - \\ln(\\alpha_i^2 + \\theta_{\\mathrm{L}}^2) \\right) = \\pi A_{\\mathrm{L}} \\theta_{\\mathrm{L}}^2 \\ln\\left(\\frac{\\alpha_o^2 + \\theta_{\\mathrm{L}}^2}{\\alpha_i^2 + \\theta_{\\mathrm{L}}^2}\\right) $$\n此表达式也是数值稳定的，因为 $\\theta_L^2 > 0$ 且 $\\alpha_o > \\alpha_i \\ge 0$ 确保了对数的自变量始终大于 1。\n\n**2. 信噪比 (SNR) 计算**\n\n利用 $I_S$ 和 $I_B$ 的解析表达式，可以直接计算给定探测器几何结构 $[\\alpha_i, \\alpha_o]$ 的信噪比：\n$$ \\mathrm{SNR}(\\alpha_i, \\alpha_o) = \\frac{I_S(\\alpha_i, \\alpha_o)}{\\sqrt{I_S(\\alpha_i, \\alpha_o) + I_B(\\alpha_i, \\alpha_o)}} $$\n对于每个测试用例，使用提供的当前探测器角度计算当前信噪比 $\\mathrm{SNR}_{\\mathrm{current}}$。\n\n**3. 通过网格搜索进行优化**\n\n主要任务是找到最优的探测器角度 $[\\alpha_{i,\\mathrm{opt}}, \\alpha_{o,\\mathrm{opt}}]$ 以最大化信噪比。问题指定了离散网格搜索，实现如下：\n1. 生成一个从 $\\alpha_{\\min}$ 到 $\\alpha_{\\max}$，步长均匀为 $\\Delta_{\\theta}$ 的一维角度值网格。\n2. 一个嵌套循环遍历该网格中所有可能的 $(\\alpha_{i}, \\alpha_{o})$ 对。\n3. 对于每一对，检查以下可行性约束：\n    - $\\alpha_i  \\alpha_o$ (内角必须小于外角)。\n    - $\\alpha_o - \\alpha_i \\ge \\Delta_{\\min}$ (环带必须有最小宽度)。\n4. 如果一对是可行的，则使用推导出的公式计算 $\\mathrm{SNR}(\\alpha_i, \\alpha_o)$。\n5. 将此 SNR 与迄今为止找到的最大 SNR 进行比较。如果当前 SNR 更高，则将其存储为新的最大值，并将相应的角度 $(\\alpha_i, \\alpha_o)$ 存储为新的最优角度。\n这种暴力搜索保证能在离散网格上找到最大信噪比。\n\n找到 $\\mathrm{SNR}_{\\mathrm{opt}}$、$\\alpha_{i, \\mathrm{opt}}$ 和 $\\alpha_{o, \\mathrm{opt}}$ 后，信噪比增益计算为以下比率：\n$$ \\mathrm{gain} = \\frac{\\mathrm{SNR}_{\\mathrm{opt}}}{\\mathrm{SNR}_{\\mathrm{current}}} $$\n然后将每个测试用例的结果格式化为指定的精度，并以所需的列表的列表格式呈现。", "answer": "```\n[[8.019557,11.246418,5.0,24.0,1.402377],[10.871988,10.871988,10.0,40.0,1.000000],[5.021966,5.326265,5.0,30.5,1.060594]]\n```", "id": "2492589"}]}