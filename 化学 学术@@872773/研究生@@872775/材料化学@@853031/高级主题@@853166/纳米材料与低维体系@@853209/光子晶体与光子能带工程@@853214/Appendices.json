{"hands_on_practices": [{"introduction": "在分析光子晶体中的波传播之前，我们必须首先掌握其在倒易空间中的几何框架。本练习将引导您完成构建布里渊区和识别其高对称性点的基本技能 [@problem_id:2509781]，这为您绘制和解读任何能带图奠定了基础。", "problem": "一个二维（$2$D）六方布拉菲格子被用来描述一种与材料化学相关的介质光子晶体，其实空间原胞矢量在笛卡尔坐标系下由 $\\mathbf{a}_{1} = a\\,(1,\\,0)$ 和 $\\mathbf{a}_{2} = a\\,\\left(\\tfrac{1}{2},\\,\\tfrac{\\sqrt{3}}{2}\\right)$ 给出，其中 $a$ 是实空间晶格常数。从满足 $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi\\,\\delta_{ij}$ 的倒易格子 $\\mathbf{b}_{i}$ 的标准定义出发，确定倒易格子矢量并构建第一布里渊区（倒易空间中的维格纳-赛兹原胞）。\n\n仅使用这些基本定义：\n- 对于给定的 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$，推导该布里渊区的高对称点 $\\Gamma$、$M$ 和 $K$ 的显式笛卡尔坐标。其中 $\\Gamma$ 是布里渊区中心，$M$ 是布里渊区边界的中点，$K$ 是布里渊区的角点（顶点）。\n- 简要概述用于绘制二维六方光子晶体光子能带结构的标准高对称路径。\n\n最后，使用您推导出的坐标计算无量纲比值 $R = \\dfrac{|\\Gamma K|}{|\\Gamma M|}$。以简化的精确表达式形式给出最终比值，不带单位。请勿对结果进行近似计算。", "solution": "该问题陈述科学上是合理的，提法恰当，并包含足够的信息以得到唯一解。这是固态物理学中的一个标准练习，适用于光子晶体的研究。我们开始进行推导。\n\n第一步是根据给定的实空间原胞矢量 $\\mathbf{a}_{1} = a(1, 0)$ 和 $\\mathbf{a}_{2} = a(\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$ 来确定倒易格子原胞矢量 $\\mathbf{b}_{1}$ 和 $\\mathbf{b}_{2}$。在二维（$2$D）情况下，倒易格子矢量的定义由关系式 $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi\\delta_{ij}$ 给出，其中 $\\delta_{ij}$ 是克罗内克δ函数。\n\n设倒易矢量在笛卡尔坐标系中表示为 $\\mathbf{b}_{1} = (b_{1x}, b_{1y})$ 和 $\\mathbf{b}_{2} = (b_{2x}, b_{2y})$。我们求解从定义关系式推导出的线性方程组。\n\n对于 $\\mathbf{b}_{1}$：\n条件 $\\mathbf{b}_{1} \\cdot \\mathbf{a}_{1} = 2\\pi$ 意味着 $b_{1x} \\cdot a + b_{1y} \\cdot 0 = 2\\pi$，这给出 $b_{1x} = \\frac{2\\pi}{a}$。\n条件 $\\mathbf{b}_{1} \\cdot \\mathbf{a}_{2} = 0$ 意味着 $b_{1x} \\cdot \\frac{a}{2} + b_{1y} \\cdot \\frac{a\\sqrt{3}}{2} = 0$。代入 $b_{1x}$ 的值，我们得到 $(\\frac{2\\pi}{a})(\\frac{a}{2}) + b_{1y}(\\frac{a\\sqrt{3}}{2}) = 0$，简化为 $\\pi + b_{1y}(\\frac{a\\sqrt{3}}{2}) = 0$。解出 $b_{1y}$ 得到 $b_{1y} = -\\frac{2\\pi}{a\\sqrt{3}}$。\n因此，第一个倒易格子矢量是 $\\mathbf{b}_{1} = (\\frac{2\\pi}{a}, -\\frac{2\\pi}{a\\sqrt{3}}) = \\frac{2\\pi}{a}(1, -\\frac{1}{\\sqrt{3}})$。\n\n对于 $\\mathbf{b}_{2}$：\n条件 $\\mathbf{b}_{2} \\cdot \\mathbf{a}_{1} = 0$ 意味着 $b_{2x} \\cdot a + b_{2y} \\cdot 0 = 0$，这给出 $b_{2x} = 0$。\n条件 $\\mathbf{b}_{2} \\cdot \\mathbf{a}_{2} = 2\\pi$ 意味着 $b_{2x} \\cdot \\frac{a}{2} + b_{2y} \\cdot \\frac{a\\sqrt{3}}{2} = 2\\pi$。代入 $b_{2x}$ 的值，我们得到 $0 + b_{2y}(\\frac{a\\sqrt{3}}{2}) = 2\\pi$，这给出 $b_{2y} = \\frac{4\\pi}{a\\sqrt{3}}$。\n因此，第二个倒易格子矢量是 $\\mathbf{b}_{2} = (0, \\frac{4\\pi}{a\\sqrt{3}}) = \\frac{2\\pi}{a}(0, \\frac{2}{\\sqrt{3}})$。\n\n第一布里渊区（BZ）是倒易格子的维格纳-赛兹原胞，以原点为中心。它是由到最近邻倒易格点的矢量的垂直平分线所围成的区域。对于六方格子，第一布里渊区是一个正六边形。\n\n高对称点由这个六边形的几何形状定义。\n- $\\Gamma$ 点是布里渊区的中心，其坐标为 $\\Gamma=(0, 0)$。\n- $M$ 点是布里渊区六条边中任意一条边的中心。根据六边形的几何结构，其与中心 $\\Gamma$ 点的距离为 $|\\Gamma M| = \\frac{2\\pi}{a\\sqrt{3}}$。\n- $K$ 点是六边形布里渊区的顶点。其与中心 $\\Gamma$ 点的距离为 $|\\Gamma K| = \\frac{4\\pi}{3a}$。\n\n用于绘制二维六方晶体光子能带结构的标准高对称路径通常会遍历不可约布里渊区（IBZ）的边界，该区域是以 $\\Gamma$、$M$ 和 $K$ 为顶点的三角形。该路径通常定义为 $\\Gamma \\rightarrow M \\rightarrow K \\rightarrow \\Gamma$。\n\n最后，我们计算无量纲比值 $R = \\frac{|\\Gamma K|}{|\\Gamma M|}$。\n$$R = \\frac{|\\Gamma K|}{|\\Gamma M|} = \\frac{4\\pi/(3a)}{2\\pi/(a\\sqrt{3})} = \\frac{4\\pi}{3a} \\cdot \\frac{a\\sqrt{3}}{2\\pi} = \\frac{2\\sqrt{3}}{3}$$\n这个结果正确地证实了正六边形的外接圆半径和边心距之间已知的几何关系。", "answer": "$$\\boxed{\\frac{2\\sqrt{3}}{3}}$$", "id": "2509781"}, {"introduction": "麦克斯韦方程组的标度不变性是光子晶体物理学中的一个基本而深刻的原理。这项练习将从第一性原理出发，揭示光子晶体的本征频率如何随其几何尺寸进行缩放 [@problem_id:2509800]，从而阐明归一化频率 $\\omega a/(2\\pi c)$ 为何是描述光子能带结构的通用语言。", "problem": "考虑一个平面内的二维方形晶格光子晶体，其晶格常数为 $a$，空间周期性相对介电常数分布为 $\\varepsilon(\\mathbf{r})$，对于任意正格矢 $\\mathbf{R}$ 满足 $\\varepsilon(\\mathbf{r}+\\mathbf{R})=\\varepsilon(\\mathbf{r})$。假设介质为非磁性材料，具有均匀磁导率 $\\mu=\\mu_{0}$，并采用无源、时谐形式的麦克斯韦方程组，角频率为 $\\omega$。令 $\\mathbf{k}$ 表示布洛赫波矢，并在原胞上施加布洛赫边界条件。\n\n从频域麦克斯韦旋度方程和布洛赫定理出发，利用约化坐标 $\\boldsymbol{\\rho}=\\mathbf{r}/a$ 和约化波矢 $\\boldsymbol{\\kappa}=a\\,\\mathbf{k}$，将原胞上的本征值问题重写为无量纲形式。然后，考虑对晶体进行因子为 $s>0$ 的均匀几何缩放，使得新的晶格常数为 $a'=s\\,a$，介电常数分布按 $\\varepsilon'(\\mathbf{r})=\\varepsilon(\\mathbf{r}/s)$ 进行缩放。在缩放后的原胞上，施加波矢为 $\\mathbf{k}'$ 的布洛赫边界条件，使得跨越一个原胞平移的布洛赫相位在约化坐标下保持不变。\n\n仅使用这些原理，不使用任何额外的简化公式，计算在相同约化波矢下，相应本征频率之比所定义的缩放因子 $R(s)$，\n$$\nR(s)\\equiv\\frac{\\omega'(\\boldsymbol{\\kappa})}{\\omega(\\boldsymbol{\\kappa})},\n$$\n其中 $\\omega(\\boldsymbol{\\kappa})$ 是原始晶体在约化波矢 $\\boldsymbol{\\kappa}$ 处的一个本征频率，$\\omega'(\\boldsymbol{\\kappa})$ 是缩放后晶体在相同 $\\boldsymbol{\\kappa}$ 处的相应本征频率。将你的结果表示为仅含 $s$ 的单个闭合形式表达式。\n\n最后，通过明确指出决定光子能带的无量纲本征值，并解释布洛赫边界条件如何引入，来论证归一化频率 $\\omega a/(2\\pi c)$ 在此缩放下的不变性。不需要进行数值计算，最终报告的 $R(s)$ 表达式中不应包含任何单位。", "solution": "该问题陈述已经过验证，具有科学依据，问题设定良好，且没有矛盾或含糊之处。我们可以开始求解。\n\n该问题要求推导光子晶体本征频率的标度律。我们从基本原理出发，即在具有均匀磁导率 $\\mu_0$ 和空间周期性相对介电常数 $\\varepsilon(\\mathbf{r})$ 的非磁性介质中，采用时谐、无源的麦克斯韦方程组。\n\n麦克斯韦旋度方程为：\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu_0\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})\\mathbf{E} $$\n此处，$\\mathbf{E}$ 和 $\\mathbf{H}$ 分别是电场和磁场的复振幅，$\\omega$ 是角频率，$\\varepsilon_0$ 和 $\\mu_0$ 分别是真空介电常数和真空磁导率，$c = 1/\\sqrt{\\varepsilon_0\\mu_0}$ 是真空中的光速。\n\n我们可以解耦这些方程，得到关于磁场 $\\mathbf{H}$ 的本征值方程。从第二个方程，我们有 $\\mathbf{E} = \\frac{i}{\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H}$。将其代入第一个方程得到：\n$$ \\nabla \\times \\left( \\frac{i}{\\omega\\varepsilon_0\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H} \\right) = i\\omega\\mu_0\\mathbf{H} $$\n重新整理各项，我们得到磁场的主方程，这是一个关于本征值 $(\\omega/c)^2$ 的厄米本征值问题：\n$$ \\nabla \\times \\left( \\frac{1}{\\varepsilon(\\mathbf{r})} \\nabla \\times \\mathbf{H}(\\mathbf{r}) \\right) = \\left(\\frac{\\omega}{c}\\right)^2 \\mathbf{H}(\\mathbf{r}) $$\n使用这种形式可以简化分析，因为 $\\nabla \\cdot \\mathbf{B} = 0$，在均匀磁介质中意味着 $\\nabla \\cdot \\mathbf{H} = 0$，这样就无需考虑矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ 带来的额外项。\n\n晶体具有平移对称性，因此介电常数是周期性的：对于任意正格矢 $\\mathbf{R}$，有 $\\varepsilon(\\mathbf{r}+\\mathbf{R})=\\varepsilon(\\mathbf{r})$。根据布洛赫定理，在此类周期性介质中，波动方程的解可以写成如下形式：\n$$ \\mathbf{H}(\\mathbf{r}) = \\mathbf{h_k}(\\mathbf{r}) e^{i\\mathbf{k}\\cdot\\mathbf{r}} $$\n其中 $\\mathbf{h_k}(\\mathbf{r})$ 具有与晶格相同的周期性，即 $\\mathbf{h_k}(\\mathbf{r}+\\mathbf{R}) = \\mathbf{h_k}(\\mathbf{r})$，而 $\\mathbf{k}$ 是布洛赫波矢。将此代入主方程，作用于布洛赫函数 $\\mathbf{H}(\\mathbf{r})$ 的旋度算符 $\\nabla$ 可以被作用于周期部分 $\\mathbf{h_k}(\\mathbf{r})$ 的 $(\\nabla + i\\mathbf{k})$ 所替代。这将整个空间上的本征值问题转化为在单个原胞上、对 $\\mathbf{h_k}(\\mathbf{r})$ 施加周期性边界条件的问题：\n$$ (\\nabla + i\\mathbf{k}) \\times \\left( \\frac{1}{\\varepsilon(\\mathbf{r})} (\\nabla + i\\mathbf{k}) \\times \\mathbf{h_k}(\\mathbf{r}) \\right) = \\left(\\frac{\\omega(\\mathbf{k})}{c}\\right)^2 \\mathbf{h_k}(\\mathbf{r}) $$\n频率 $\\omega$ 现在记为 $\\omega(\\mathbf{k})$，以强调它是对应于波矢 $\\mathbf{k}$ 的一个本征值。\n\n接下来，我们利用约化坐标 $\\boldsymbol{\\rho} = \\mathbf{r}/a$ 和约化波矢 $\\boldsymbol{\\kappa} = a\\mathbf{k}$，将此方程重写为无量纲形式，其中 $a$ 是晶格常数。梯度算符变换为 $\\nabla_{\\mathbf{r}} = (1/a)\\nabla_{\\boldsymbol{\\rho}}$。介电常数函数 $\\varepsilon(\\mathbf{r})$ 和周期性场包络 $\\mathbf{h_k}(\\mathbf{r})$ 可以视为约化坐标 $\\boldsymbol{\\rho}$ 的函数。我们分别将它们记为 $\\varepsilon(\\boldsymbol{\\rho})$ 和 $\\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho})$。将这些无量纲量代入方程，得到：\n$$ \\left(\\frac{1}{a}\\nabla_{\\boldsymbol{\\rho}} + i\\frac{\\boldsymbol{\\kappa}}{a}\\right) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} \\left(\\frac{1}{a}\\nabla_{\\boldsymbol{\\rho}} + i\\frac{\\boldsymbol{\\kappa}}{a}\\right) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\n从左侧提出因子 $1/a^2$，我们得到：\n$$ \\frac{1}{a^2} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\n重新整理得到无量纲本征值方程：\n$$ (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega(\\boldsymbol{\\kappa})a}{c}\\right)^2 \\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\n这个方程定义了光子能带结构。左边的算符，我们称之为 $\\mathcal{L}_{\\boldsymbol{\\kappa}}$，仅依赖于约化波矢 $\\boldsymbol{\\kappa}$ 和作为约化坐标函数的介电常数分布 $\\varepsilon(\\boldsymbol{\\rho})$。方程的解给出了无量纲本征值 $(\\omega a / c)^2$ 和相应的无量纲周期性本征函数 $\\mathbf{h}_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho})$。\n\n现在考虑缩放后的晶体，其晶格常数为 $a' = sa$，介电常数分布为 $\\varepsilon'(\\mathbf{r}) = \\varepsilon(\\mathbf{r}/s)$。这个缩放后系统（带撇量的）的无量纲本征值方程是：\n$$ (\\nabla_{\\boldsymbol{\\rho}'} + i\\boldsymbol{\\kappa}') \\times \\left( \\frac{1}{\\varepsilon'(\\boldsymbol{\\rho}')} (\\nabla_{\\boldsymbol{\\rho}'} + i\\boldsymbol{\\kappa}') \\times \\mathbf{h}'_{\\boldsymbol{\\kappa}'}(\\boldsymbol{\\rho}') \\right) = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa'})a'}{c}\\right)^2 \\mathbf{h}'_{\\boldsymbol{\\kappa}'}(\\boldsymbol{\\rho}') $$\n其中 $\\boldsymbol{\\rho}' = \\mathbf{r}/a'$ 和 $\\boldsymbol{\\kappa}' = a'\\mathbf{k}'$。问题要求在相同的约化波矢下进行比较，因此我们令 $\\boldsymbol{\\kappa}' = \\boldsymbol{\\kappa}$。这在约化坐标下保持了跨越一个原胞的布洛赫相因子不变。\n\n让我们考察缩放后晶体在其约化坐标下的介电常数分布：\n$$ \\varepsilon'(\\boldsymbol{\\rho}') = \\varepsilon'(a'\\boldsymbol{\\rho}') = \\varepsilon'((sa)\\boldsymbol{\\rho}') $$\n使用定义 $\\varepsilon'(\\mathbf{r}) = \\varepsilon(\\mathbf{r}/s)$，我们令 $\\mathbf{r} = sa\\boldsymbol{\\rho}'$：\n$$ \\varepsilon'(\\boldsymbol{\\rho}') = \\varepsilon\\left(\\frac{sa\\boldsymbol{\\rho}'}{s}\\right) = \\varepsilon(a\\boldsymbol{\\rho}') $$\n这与原始介电常数在其约化坐标下的函数形式 $\\varepsilon(\\boldsymbol{\\rho}) = \\varepsilon(a\\boldsymbol{\\rho})$ 相同。因此，在约化坐标空间中，原始系统和缩放后系统的介电函数是相同的：$\\varepsilon'(\\cdot) = \\varepsilon(\\cdot)$。\n\n将 $\\boldsymbol{\\kappa}'=\\boldsymbol{\\kappa}$，$a'=sa$ 和 $\\varepsilon'(\\cdot) = \\varepsilon(\\cdot)$ 代入缩放后的无量纲方程，我们得到：\n$$ (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\left( \\frac{1}{\\varepsilon(\\boldsymbol{\\rho})} (\\nabla_{\\boldsymbol{\\rho}} + i\\boldsymbol{\\kappa}) \\times \\mathbf{h}'_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) \\right) = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c}\\right)^2 \\mathbf{h}'_{\\boldsymbol{\\kappa}}(\\boldsymbol{\\rho}) $$\n注意到左边的算符与原始问题中的算符 $\\mathcal{L}_{\\boldsymbol{\\kappa}}$ 完全相同。由于算符和约化单位原胞上的周期性边界条件都相同，其本征值集合也必定相同。\n通过令原始系统和缩放后系统的本征值相等：\n$$ \\left(\\frac{\\omega(\\boldsymbol{\\kappa})a}{c}\\right)^2 = \\left(\\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c}\\right)^2 $$\n由于频率是正值，我们可以对两边取平方根：\n$$ \\frac{\\omega(\\boldsymbol{\\kappa})a}{c} = \\frac{\\omega'(\\boldsymbol{\\kappa})sa}{c} $$\n$$ \\omega(\\boldsymbol{\\kappa}) = s \\cdot \\omega'(\\boldsymbol{\\kappa}) $$\n问题要求比值 $R(s) = \\omega'(\\boldsymbol{\\kappa})/\\omega(\\boldsymbol{\\kappa})$。从上述关系中，我们发现：\n$$ R(s) = \\frac{\\omega'(\\boldsymbol{\\kappa})}{\\omega(\\boldsymbol{\\kappa})} = \\frac{1}{s} $$\n\n最后，我们必须论证归一化频率 $\\omega a / (2\\pi c)$ 的不变性，并讨论无量纲本征值和布洛赫条件的作用。\n决定光子能带的无量纲本征值是 $(\\omega a / c)^2$。它的平方根 $\\omega a / c$，或常用的归一化频率 $\\tilde{\\omega} = \\omega a / (2\\pi c)$，正是我们需要解释其恒定性的量。我们的推导表明，对于任何本征模式，原始系统和缩放后系统的无量纲算符的本征值必须相同：\n$$ \\frac{\\omega(\\boldsymbol{\\kappa})a}{c} = \\frac{\\omega'(\\boldsymbol{\\kappa})a'}{c} $$\n这个等式明确地表明，只要在相同的约化波矢 $\\boldsymbol{\\kappa}$ 下比较系统，归一化频率就是该缩放变换的一个不变量。这就是为什么一张描绘归一化频率对约化波矢的光子能带图，能够描述一整族几何相似的晶体，它们之间仅有缩放因子 $s$ 的不同。\n\n布洛赫边界条件是整个框架的核心。通过假设解的布洛赫形式 $\\mathbf{H}(\\mathbf{r}) = \\mathbf{h_k}(\\mathbf{r}) e^{i\\mathbf{k}\\cdot\\mathbf{r}}$，我们能够将一个无限域问题转化为单个原胞上的本征值问题。这将波矢 $\\mathbf{k}$ 引入到微分算符中。随后相对于晶格常数 $a$ 的无量纲化，自然地将 $\\omega$ 与 $a$ 组合形成无量纲本征值 $(\\omega a / c)^2$，将 $\\mathbf{k}$ 与 $a$ 组合形成约化波矢 $\\boldsymbol{\\kappa} = a\\mathbf{k}$，后者成为无量纲算符的参数。在相同的 $\\boldsymbol{\\kappa}$ 处比较本征频率的条件，是关于布洛赫相位的一个条件，它使得无量纲算符相同，并直接导出了标度律和归一化频率的不变性。", "answer": "$$\\boxed{\\frac{1}{s}}$$", "id": "2509800"}, {"introduction": "许多光子晶体应用的核心在于通过引入缺陷来打破其完美周期性，从而创造出功能性结构。本练习将理论模型（如耦合谐振子理论）与实际工程设计相结合，指导您设计一个线缺陷波导 [@problem_id:2509811]。您将学习如何应用光锥概念来确保低损耗的光导引，这是实现高效片上光子器件的关键一步。", "problem": "一个二维三角晶格平板光子晶体（PhC）波导可以通过移除单排空气孔来形成，从而产生一个线缺陷，该缺陷支持一个沿缺陷方向传播的导模。从线性、无损、非磁性介质中的频域无源麦克斯韦方程组出发，其中相对磁导率 $ \\mu_{r} = 1 $，相对介电常数 $ \\varepsilon(\\mathbf{r}) $ 呈空间周期性，\n$$\n\\nabla \\times \\nabla \\times \\mathbf{E}(\\mathbf{r}) = \\frac{\\omega^{2}}{c^{2}} \\, \\varepsilon(\\mathbf{r}) \\, \\mathbf{E}(\\mathbf{r}) \\, ,\n$$\n结合周期性介质的布洛赫定理，以及二维光子晶体中的线缺陷形成一维耦合局域谐振阵列的物理图像。仅利用这些基础，推导基线缺陷导模的最近邻耦合谐振器色散关系，该关系用孤立缺陷的特征谐振角频率 $ \\omega_{0} $ 和最近邻耦合参数 $ \\kappa $ 表示。将此色散关系转换为归一化频率表示 $ f \\equiv \\omega a / (2\\pi c) $，其中 $ a $ 是面内晶格常数，$ c $ 是真空中的光速。单独推导向折射率为 $ n_{\\mathrm{clad}} $ 的均匀包层中进行面外辐射的光线关系，表示为归一化频率 $ f_{\\mathrm{LL}} $ 作为面内布洛赫波矢大小 $ k_{\\parallel} $ 的函数。使用导模条件：当且仅当缺陷模的归一化频率严格低于相同面内波矢下的包层光线时，该模式才被垂直限制。[@problem_id:458]\n\n你的任务是，在一个完整的、可运行的程序中实现这些推导，以评估给定的光子晶体线缺陷设计是否在布里渊区边缘附近指定的高波矢操作窗口内实现低辐射损耗。对每个测试用例，请按以下步骤操作：\n\n- 将波导视为沿传播方向周期为 $ a $ 的一维周期链。在第一布里渊区内操作，对无量纲量 $ k a $ 在 $ 0 $ 到 $ \\pi $（包含两端）的范围内进行 $ M $ 个等间距采样，其中 $ k $ 是沿缺陷方向的标量波矢分量，角度以弧度为单位。使用 $ M = 1001 $。\n- 根据你推导的最近邻色散关系，计算每个采样点 $ k a $ 处的归一化缺陷带频率 $ f_{\\mathrm{def}}(k a) $。\n- 根据你推导的光线关系，为均匀包层折射率 $ n_{\\mathrm{clad}} $ 计算每个采样点 $ k a $ 处的归一化光线频率 $ f_{\\mathrm{LL}}(k a) $。\n- 将高波矢操作窗口定义为 $ k a \\in [\\alpha \\pi, \\pi] $，其中 $ \\alpha = 0.8 $。在此窗口内，确定：\n  1. 导模点分数 $ \\phi $，定义为窗口内满足 $ f_{\\mathrm{def}}(k a)  f_{\\mathrm{LL}}(k a) $ 的采样点所占的比例。\n  2. 窗口内导模点上的最小相对间隔 $ s_{\\min} $，定义为在这些导模点上计算的 $ \\left( f_{\\mathrm{LL}} - f_{\\mathrm{def}} \\right) / f_{\\mathrm{LL}} $ 的最小值。如果窗口内没有导模点，则定义 $ s_{\\min} = 0 $ 且 $ \\phi = 0 $。\n- 当且仅当 $ \\phi \\ge \\phi_{\\mathrm{req}} $ 和 $ s_{\\min} \\ge s_{\\mathrm{req}} $ 同时满足时，宣布该设计符合低辐射损耗标准，其中 $ \\phi_{\\mathrm{req}} $ 和 $ s_{\\mathrm{req}} $ 是预设的阈值。\n\n归一化频率 $ f $ 无物理单位，因为根据定义它们是无量纲的。$ k a $ 的角度以弧度为单位。最终程序必须对所有浮点输出结果四舍五入到六位小数。\n\n测试套件。对于每个测试用例，给定以纳米（nm）为单位的 $ a $、$ n_{\\mathrm{clad}} $、孤立缺陷的归一化谐振频率 $ f_{0} \\equiv \\omega_{0} a / (2\\pi c) $、以归一化频率单位表示的最近邻耦合 $ t $（与你的推导中的 $ \\kappa a / (2\\pi c) $ 成正比），以及接受阈值 $ s_{\\mathrm{req}} $ 和 $ \\phi_{\\mathrm{req}} $：\n\n- 用例 A（正常路径）：$ a = 420 \\,\\mathrm{nm} $，$ n_{\\mathrm{clad}} = 1.44 $，$ f_{0} = 0.275 $，$ t = 0.020 $，$ s_{\\mathrm{req}} = 0.100 $，$ \\phi_{\\mathrm{req}} = 0.950 $。\n- 用例 B（边界类）：$ a = 420 \\,\\mathrm{nm} $，$ n_{\\mathrm{clad}} = 1.44 $，$ f_{0} = 0.335 $，$ t = 0.005 $，$ s_{\\mathrm{req}} = 0.200 $，$ \\phi_{\\mathrm{req}} = 0.900 $。\n- 用例 C（边缘情况，无导模窗口）：$ a = 420 \\,\\mathrm{nm} $，$ n_{\\mathrm{clad}} = 3.10 $，$ f_{0} = 0.220 $，$ t = 0.010 $，$ s_{\\mathrm{req}} = 0.050 $，$ \\phi_{\\mathrm{req}} = 0.500 $。\n\n你的程序必须为每个用例计算三元组 $ [\\phi, s_{\\min}, \\mathrm{pass}] $，其中 $ \\phi $ 和 $ s_{\\min} $ 是四舍五入到六位小数的浮点数，$ \\mathrm{pass} $ 是一个布尔值，指示是否两个阈值都已满足。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素本身就是对应一个测试用例（按 A、B、C 的顺序）的列表 $ [\\phi, s_{\\min}, \\mathrm{pass}] $。例如，一个语法上有效的输出格式是 $ [[0.123456,0.234567,True],[\\dots],[\\dots]] $。", "solution": "所提出的问题是材料科学和光子学领域中的一个有效且定义明确的任务，具体涉及光子晶体波导的设计。该问题在科学上基于麦克斯韦方程组以及固态物理学原理，如布洛赫定理和耦合模理论。它是客观、完整的，并包含推导和计算唯一解所需的所有必要数据和定义。因此，我将着手提供一个完整的解决方案。\n\n该解决方案需要两个关键的推导，然后是数值实现。\n\n首先，我们必须推导线缺陷波导中导模的色散关系。问题指示我们将波导建模为一维耦合局域谐振器链，其空间周期等于晶格常数 $a$。设 $A_n(t)$ 为第 $n$ 个谐振器处的场振幅。根据最近邻相互作用的耦合模理论原理，位置 $n$ 处振幅的时间演化由以下方程决定：\n$$\ni \\frac{d A_n}{dt} = \\omega_0 A_n + \\kappa (A_{n-1} + A_{n+1})\n$$\n在此，$\\omega_0$ 是孤立谐振器的谐振角频率，$\\kappa$ 是相邻谐振器之间的耦合系数。$\\kappa$ 的符号取决于耦合的物理性质；我们将假设它被吸收到所提供的参数 $t$ 中。\n\n我们寻求模解，即沿链传播的波。根据一维周期系统的布洛赫定理，这样的解必须具有 $A_n(t) = A_k e^{i(k(na) - \\omega t)}$ 的形式，其中 $k$ 是布洛赫波矢，$\\omega$ 是对应的角频率。将此 ansatz 代入耦合模方程，得到：\n$$\ni \\left( -i\\omega \\right) A_k e^{i(kna - \\omega t)} = \\omega_0 A_k e^{i(kna - \\omega t)} + \\kappa \\left( A_k e^{i(k(n-1)a - \\omega t)} + A_k e^{i(k(n+1)a - \\omega t)} \\right)\n$$\n在代入时间导数并消去公因子 $A_k e^{i(kna - \\omega t)}$ 后，我们得到：\n$$\n\\omega = \\omega_0 + \\kappa \\left( e^{-ika} + e^{ika} \\right)\n$$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到色散关系：\n$$\n\\omega(k) = \\omega_0 + 2\\kappa \\cos(ka)\n$$\n问题要求将其表示为归一化频率 $f = \\omega a / (2\\pi c)$。我们将方程两边同除以 $2\\pi c/a$：\n$$\n\\frac{\\omega a}{2\\pi c} = \\frac{\\omega_0 a}{2\\pi c} + \\frac{2\\kappa a}{2\\pi c} \\cos(ka)\n$$\n我们已知归一化的孤立谐振频率 $f_0 = \\omega_0 a / (2\\pi c)$ 和一个归一化耦合参数 $t$，它与 $\\kappa a / (2\\pi c)$ 成正比。在紧束缚模型中的标准解释是，所提供的归一化耦合 $t$ 对应于基本的跳跃积分，在我们的推导中即为 $\\kappa a/(2\\pi c)$。因子 $2$ 来自对两个最近邻的求和。因此，缺陷模的色散关系 $f_{\\mathrm{def}}$ 为：\n$$\nf_{\\mathrm{def}}(ka) = f_0 + 2t \\cos(ka)\n$$\n\n其次，我们推导光线关系，它定义了向包层辐射损耗的边界。如果一个模式的面内波矢 $k$ 大于在相同频率 $\\omega$ 下包层中任何辐射模式的波矢，那么该模式将通过全内反射（或者在本例中，通过光子带隙的限制）被引导。在包层（折射率 $n_{\\mathrm{clad}}$）中传播的辐射模式具有色散关系 $\\omega = (c/n_{\\mathrm{clad}}) \\cdot |\\mathbf{k}_{\\mathrm{clad}}|$。要使模式从波导泄漏，其频率 $\\omega$ 和面内波矢分量 $k$ 必须守恒。设波导轴为 $x$ 方向。包层模式的波矢为 $\\mathbf{k}_{\\mathrm{clad}} = (k_x, k_y, k_z)$。相位匹配要求 $k_x = k$。辐射模式是那些面外分量 $k_z$ 为实数的模式，这意味着 $k_z^2 \\ge 0$。包层波矢的大小为 $|\\mathbf{k}_{\\mathrm{clad}}|^2 = k_x^2 + k_y^2 + k_z^2$。考虑到主要远离波导传播的辐射（$k_y=0$），我们有 $|\\mathbf{k}_{\\mathrm{clad}}|^2 = k^2 + k_z^2$。\n因此，在包层中存在传播波的条件是：\n$$\n|\\mathbf{k}_{\\mathrm{clad}}|^2 - k^2 \\ge 0 \\implies \\left(\\frac{\\omega n_{\\mathrm{clad}}}{c}\\right)^2 \\ge k^2 \\implies \\omega \\ge \\frac{c k}{n_{\\mathrm{clad}}}\n$$\n这个辐射区的边界是光线，$\\omega_{\\mathrm{LL}}(k) = c k / n_{\\mathrm{clad}}$。如果导模的频率严格低于这条线，即 $\\omega_{\\mathrm{def}}  \\omega_{\\mathrm{LL}}$，则该模式被限制（非泄漏）。\n以归一化频率单位表示，光线为：\n$$\nf_{\\mathrm{LL}}(ka) = \\frac{\\omega_{\\mathrm{LL}} a}{2\\pi c} = \\frac{(ck/n_{\\mathrm{clad}})a}{2\\pi c} = \\frac{ka}{2\\pi n_{\\mathrm{clad}}}\n$$\n\n有了这两个方程，我们就可以进行数值评估。对于每个测试用例，我们将在 $[0, \\pi]$ 范围内对无量纲波矢 $ka$ 采样 $M=1001$ 个点。然后，我们确定这些点中落入高波矢操作窗口 $ka \\in [0.8\\pi, \\pi]$ 的子集。在此窗口内，我们计算满足导模条件 $f_{\\mathrm{def}}(ka)  f_{\\mathrm{LL}}(ka)$ 的点的比例 $\\phi$。对于这些导模点，我们计算相对间隔 $(f_{\\mathrm{LL}} - f_{\\mathrm{def}})/f_{\\mathrm{LL}}$ 并找出其最小值 $s_{\\min}$。如果没有导模点，则 $\\phi=0$ 且 $s_{\\min}=0$。最后，我们将这些计算出的指标与阈值 $\\phi_{\\mathrm{req}}$ 和 $s_{\\mathrm{req}}$ 进行比较，以确定设计是否通过低辐射损耗标准。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the photonic crystal waveguide design problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite parameters:\n    # (a [nm], n_clad, f0, t, s_req, phi_req)\n    # The lattice constant 'a' is not needed as all calculations are dimensionless.\n    test_cases = [\n        (420, 1.44, 0.275, 0.020, 0.100, 0.950),  # Case A\n        (420, 1.44, 0.335, 0.005, 0.200, 0.900),  # Case B\n        (420, 3.10, 0.220, 0.010, 0.050, 0.500),  # Case C\n    ]\n    \n    results = []\n    \n    # Constants for the numerical evaluation\n    M = 1001  # Number of sampling points\n    alpha = 0.8  # Start of the high-wavevector window\n    \n    # Generate the dimensionless wavevector array ka from 0 to pi\n    ka_vals = np.linspace(0, np.pi, M)\n    \n    for case in test_cases:\n        a_nm, n_clad, f0, t, s_req, phi_req = case\n        \n        # 1. Compute the normalized defect-band frequency f_def(ka)\n        # f_def(ka) = f0 + 2*t*cos(ka)\n        f_def = f0 + 2 * t * np.cos(ka_vals)\n        \n        # 2. Compute the normalized light-line frequency f_ll(ka)\n        # f_ll(ka) = ka / (2*pi*n_clad)\n        f_ll = ka_vals / (2 * np.pi * n_clad)\n        \n        # 3. Define the high-wavevector operational window\n        window_mask = ka_vals >= alpha * np.pi\n        ka_window = ka_vals[window_mask]\n        f_def_window = f_def[window_mask]\n        f_ll_window = f_ll[window_mask]\n        \n        total_points_in_window = len(ka_window)\n        \n        phi = 0.0\n        s_min = 0.0\n        \n        if total_points_in_window > 0:\n            # 4. Determine the guided points within the window\n            guided_mask = f_def_window  f_ll_window\n            num_guided_points = np.sum(guided_mask)\n\n            # 5. Calculate the guided-point fraction phi\n            phi = num_guided_points / total_points_in_window\n            \n            if num_guided_points > 0:\n                # 6. Calculate the minimum relative separation s_min\n                f_def_guided = f_def_window[guided_mask]\n                f_ll_guided = f_ll_window[guided_mask]\n                \n                relative_separation = (f_ll_guided - f_def_guided) / f_ll_guided\n                s_min = np.min(relative_separation)\n            # If no guided points, phi and s_min remain 0 as per the problem statement\n        \n        # 7. Check if the low-radiation-loss criterion is met\n        is_pass = (phi >= phi_req) and (s_min >= s_req)\n        \n        # Store results for the current case\n        results.append([phi, s_min, is_pass])\n\n    # Format the final output string as specified: [[phi,s_min,pass],[...],...]\n    result_strings = []\n    for res in results:\n        phi_val, s_min_val, pass_val = res\n        # Format floats to 6 decimal places and create the string for one result\n        pass_str = str(pass_val) # 'True' or 'False'\n        result_str = f\"[{phi_val:.6f},{s_min_val:.6f},{pass_str}]\"\n        result_strings.append(result_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2509811"}]}