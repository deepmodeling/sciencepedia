{"hands_on_practices": [{"introduction": "比表面积是评估多孔骨架材料性能的首要指标之一，它直接关系到材料的吸附容量和催化活性位点的数量。Brunauer–Emmett–Teller (BET) 理论是利用气体吸附等温线来测定材料比表面积的黄金标准。本练习将指导你完成一个典型的BET分析过程，通过处理给定的氮气吸附数据，应用线性化的BET方程，从而精确计算出材料的比表面积，这是多孔材料表征中最基本也最重要的技能之一。[@problem_id:2514683]", "problem": "一种金属有机框架（MOF）在 $77\\ \\mathrm{K}$ 温度下进行氮气吸附表征。在 Brunauer–Emmett–Teller (BET) 范围内，获得了在相对压力 $P/P_0$ 下的以下平衡吸附数据，以单位质量的吸附量 $n$（单位为 $\\mathrm{mmol\\ g^{-1}}$）表示：\n- $P/P_0 = 0.10$，$n = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$\n- $P/P_0 = 0.20$，$n = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$\n- $P/P_0 = 0.25$，$n = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$\n\n从线性化的 Brunauer–Emmett–Teller (BET) 方程出发，\n$$\n\\frac{P}{n\\,(P_0 - P)} \\;=\\; \\frac{1}{n_m\\,C} \\;+\\; \\frac{C - 1}{n_m\\,C}\\,\\frac{P}{P_0},\n$$\n其中 $n_m$ 是单层容量（单位为 $\\mathrm{mol\\ g^{-1}}$），$C$ 是 BET 常数，请完成以下任务：\n- 通过定义 $x \\equiv P/P_0$ 和 $y \\equiv P/\\!\\left[n\\,(P_0 - P)\\right]$ 来构建 BET 图，并在所述的 $P/P_0$ 范围内进行线性拟合 $y = s\\,x + i$，以获得斜率 $s$ 和截距 $i$。\n- 从 $s$ 和 $i$ 中，求出 $n_m$ 和 $C$。\n- 使用 $n_m$ 计算比表面积 $S_{\\mathrm{BET}}$，根据基于紧密堆積氮分子横截面积的单层方法，其中 $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$ 且每个分子的 $a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2}$。使用 $1\\ \\mathrm{nm^2} = 1 \\times 10^{-18}\\ \\mathrm{m^2}$。将 $S_{\\mathrm{BET}}$ 以 $\\mathrm{m^2\\ g^{-1}}$ 为单位表示。\n\n将 $S_{\\mathrm{BET}}$ 的最终数值答案四舍五入到四位有效数字。", "solution": "首先对问题陈述进行严格验证。\n\n**问题验证**\n\n已知条件如下：\n1.  金属有机框架（MOF）在 $77\\ \\mathrm{K}$ 下的氮气吸附数据：\n    - 对于 $P/P_0 = 0.10$，吸附量为 $n = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$。\n    - 对于 $P/P_0 = 0.20$，吸附量为 $n = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$。\n    - 对于 $P/P_0 = 0.25$，吸附量为 $n = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$。\n2.  线性化的 Brunauer–Emmett–Teller (BET) 方程：$\\frac{P}{n\\,(P_0 - P)} \\;=\\; \\frac{1}{n_m\\,C} \\;+\\; \\frac{C - 1}{n_m\\,C}\\,\\frac{P}{P_0}$。\n3.  线性图的定义：$x \\equiv P/P_0$ 和 $y \\equiv P/\\!\\left[n\\,(P_0 - P)\\right]$。线性拟合为 $y = s\\,x + i$。\n4.  物理常数：阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$ 和氮分子横截面积 $a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2}$。\n5.  单位换算：$1\\ \\mathrm{nm^2} = 1 \\times 10^{-18}\\ \\mathrm{m^2}$。\n6.  要求输出：斜率 $s$、截距 $i$、单层容量 $n_m$、BET 常数 $C$ 和比表面积 $S_{\\mathrm{BET}}$（单位为 $\\mathrm{m^2\\ g^{-1}}$，四舍五入到四位有效数字）。问题规定 $n_m$ 的单位应为 $\\mathrm{mol\\ g^{-1}}$。\n\n**结论**\n该问题被认为是**有效的**。它在物理吸附和通过 BET 模型进行表面积分析的既定原理上具有科学依据。问题提法得当，提供了足够的数据和清晰的定义来确定唯一解。语言客观精确。数据虽然是为了产生完美的线性关系而设计的，但对于高比表面积材料而言在物理上是合理的。该任务是表面科学原理的标准应用。\n\n**解答**\n\n解答过程按以下逻辑步骤进行。\n\n**步骤 1：为 BET 图进行数据转换**\n我们已知 BET 方程的线性形式。为了构建 BET 图，我们必须将给定的吸附数据 $(P/P_0, n)$ 转换为坐标 $(x, y)$。自变量是 $x = P/P_0$。因变量是 $y = \\frac{P}{n\\,(P_0 - P)}$，可以用 $x$ 改写为：\n$$\ny = \\frac{P/P_0}{n(1 - P/P_0)} = \\frac{x}{n(1-x)}\n$$\n$n$ 的单位是 $\\mathrm{mmol\\ g^{-1}}$，所以 $y$ 的单位將是 $\\mathrm{g\\ mmol^{-1}}$。\n\n我们计算三个给定数据点的 $(x, y)$ 坐标：\n- 点 1：$x_1 = 0.10$，$n_1 = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_1 = \\frac{0.10}{12.23241590 \\cdot (1 - 0.10)} = \\frac{0.10}{11.00917431} \\approx 0.00908333\\ \\mathrm{g\\ mmol^{-1}}\n$$\n- 点 2：$x_2 = 0.20$，$n_2 = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_2 = \\frac{0.20}{14.42307692 \\cdot (1 - 0.20)} = \\frac{0.20}{11.538461536} \\approx 0.01733333\\ \\mathrm{g\\ mmol^{-1}}\n$$\n- 点 3：$x_3 = 0.25$，$n_3 = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_3 = \\frac{0.25}{15.53398058 \\cdot (1 - 0.25)} = \\frac{0.25}{11.650485435} \\approx 0.02145833\\ \\mathrm{g\\ mmol^{-1}}\n$$\n\n**步骤 2：线性拟合以获得斜率和截距**\n问题要求对这些点进行线性拟合 $y = s\\,x + i$。我们首先计算相邻点之间的斜率 $s$ 以验证共线性。\n点 1 和点 2 之间的斜率：\n$$\ns_{12} = \\frac{y_2 - y_1}{x_2 - x_1} = \\frac{0.01733333... - 0.00908333...}{0.20 - 0.10} = \\frac{0.00825}{0.10} = 0.0825\\ \\mathrm{g\\ mmol^{-1}}\n$$\n点 2 和点 3 之间的斜率：\n$$\ns_{23} = \\frac{y_3 - y_2}{x_3 - x_2} = \\frac{0.02145833... - 0.01733333...}{0.25 - 0.20} = \\frac{0.004125}{0.05} = 0.0825\\ \\mathrm{g\\ mmol^{-1}}\n$$\n斜率相同，证实了这三个点是完全共线的。直线的斜率为 $s = 0.0825 = \\frac{33}{400}\\ \\mathrm{g\\ mmol^{-1}}$。\n截距 $i$ 可以使用点斜式 $i = y - s\\,x$ 求得。使用点 1：\n$$\ni = y_1 - s\\,x_1 = 0.00908333... - (0.0825)(0.10) = 0.00908333... - 0.00825 = 0.00083333...\n$$\n这个循环小数是有理数 $\\frac{1}{1200}$。因此，截距为 $i = \\frac{1}{1200}\\ \\mathrm{g\\ mmol^{-1}}$。\n\n**步骤 3：求取单层容量 ($n_m$) 和 BET 常数 ($C$)**\n我们将经验斜率 $s$ 和截距 $i$ 与理论 BET 方程中的参数关联起来：\n$$\ns = \\frac{C - 1}{n_m\\,C} \\quad \\text{和} \\quad i = \\frac{1}{n_m\\,C}\n$$\n这是一个关于两个未知数 $n_m$ 和 $C$ 的二元方程组。\n首先，通过求 $s$ 与 $i$ 的比值来求解 $C$：\n$$\n\\frac{s}{i} = \\frac{(C-1)/(n_m\\,C)}{1/(n_m\\,C)} = C - 1\n$$\n$$\nC = \\frac{s}{i} + 1 = \\frac{0.0825}{0.00083333...} + 1 = \\frac{33/400}{1/1200} + 1 = \\frac{33}{400} \\cdot 1200 + 1 = 33 \\cdot 3 + 1 = 99 + 1 = 100\n$$\nBET 常数 $C$ 是一个无量纲量，等于 $100$。\n\n接下来，我们确定单层容量 $n_m$。一个直接的方法是将斜率和截距的表达式相加：\n$$\ns + i = \\frac{C - 1}{n_m\\,C} + \\frac{1}{n_m\\,C} = \\frac{C - 1 + 1}{n_m\\,C} = \\frac{C}{n_m\\,C} = \\frac{1}{n_m}\n$$\n因此，$n_m = \\frac{1}{s+i}$。\n$$\ns+i = 0.0825 + 0.00083333... = \\frac{33}{400} + \\frac{1}{1200} = \\frac{99+1}{1200} = \\frac{100}{1200} = \\frac{1}{12}\\ \\mathrm{g\\ mmol^{-1}}\n$$\n$$\nn_m = \\frac{1}{1/12} = 12\\ \\mathrm{mmol\\ g^{-1}}\n$$\n根据问题陈述，我们将其转换为 $\\mathrm{mol\\ g^{-1}}$：\n$$\nn_m = 12\\ \\mathrm{mmol\\ g^{-1}} = 12 \\times 10^{-3}\\ \\mathrm{mol\\ g^{-1}} = 0.012\\ \\mathrm{mol\\ g^{-1}}\n$$\n\n**步骤 4：计算比表面积 ($S_{\\mathrm{BET}}$)**\n比表面积是指在一克吸附剂表面上形成完整单分子层的分子所占据的总面积。它的计算方法是将每克单分子层中的摩尔数 ($n_m$) 乘以阿伏伽德罗常数 ($N_A$) 得到分子数，然后再乘以单个吸附质分子 ($a_{\\mathrm{N_2}}$) 的横截面积。\n$$\nS_{\\mathrm{BET}} = n_m \\cdot N_A \\cdot a_{\\mathrm{N_2}}\n$$\n我们使用给定的值：\n$n_m = 0.012\\ \\mathrm{mol\\ g^{-1}}$\n$N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n$a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2} = 0.162 \\times 10^{-18}\\ \\mathrm{m^2}$\n\n将这些值代入方程：\n$$\nS_{\\mathrm{BET}} = (0.012\\ \\mathrm{mol\\ g^{-1}}) \\times (6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}) \\times (0.162 \\times 10^{-18}\\ \\mathrm{m^2})\n$$\n$$\nS_{\\mathrm{BET}} = (0.012 \\times 6.02214076 \\times 0.162) \\times 10^{23-18}\\ \\mathrm{m^2\\ g^{-1}}\n$$\n$$\nS_{\\mathrm{BET}} = 0.0117072436... \\times 10^{5}\\ \\mathrm{m^2\\ g^{-1}}\n$$\n$$\nS_{\\mathrm{BET}} = 1170.72436...\\ \\mathrm{m^2\\ g^{-1}}\n$$\n问题要求最终答案四舍五入到四位有效数字。第五位有效数字是 7，因此需要将第四位数字向上取整。\n$$\nS_{\\mathrm{BET}} \\approx 1171\\ \\mathrm{m^2\\ g^{-1}}\n$$", "answer": "$$\\boxed{1171}$$", "id": "2514683"}, {"introduction": "在掌握了单组分吸附表征后，我们进而转向更贴近实际应用的多组分体系，例如烟气脱碳。理想吸附溶液理论 (Ideal Adsorbed Solution Theory, IAST) 是一个强大的预测工具，它能够仅基于纯组分吸附等温线数据，来预测混合物在吸附剂上的竞争性吸附行为和分离选择性。本练习要求你通过编程实现IAST模型，计算在特定混合气体条件下（例如 $CO_2/N_2$），多孔材料的吸附选择性，从而评估其在气体分离应用中的潜力。[@problem_id:2514698]", "problem": "您正在模拟二氧化碳和氮气在多孔骨架材料（如金属有机框架（MOF）或共价有机框架（COF））中的竞争性吸附。假设为理想气体混合物，并应用理想吸附溶液理论 (IAST)，从纯组分等温线计算二元混合物的平衡吸附相组成。每种纯组分的吸附等温线均遵循Langmuir形式。您的任务是计算几组参数下二氧化碳相对于氮气的IAST选择性，并展示其对饱和吸附量和亲和参数的敏感性。\n\n使用的基本原理和假设：\n- 总压为 $P$、气相摩尔分数为 $y_{i}$ 的理想气体混合物。\n- 理想吸附溶液理论 (IAST)：混合物中各组分的展布压力 $\\pi$ 等于该组分在其纯组分等温线上某个等效压力 $P_{i}^{0}$ 下所具有的展布压力，并且类拉乌尔关系成立。\n- 组分 $i$ 的Langmuir等温线：$q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$，其中 $q_{i,\\max}$ 是饱和吸附量，$b_{i}$ 是亲和常数。\n- IAST中的展布压力相等性要求对于每个组分 $i$ 都有 $\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$。对于Langmuir等温线，该积分是良定义的且可逆的。\n- 约束条件 $\\sum_{i} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$ 确定了 $\\pi$ 的值。\n- 一旦确定了 $\\pi$，吸附相摩尔分数为 $x_{i} = \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)}$，二氧化碳相对于氮气的理想吸附溶液理论 (IAST) 选择性为 $S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$。\n\n所有计算必须在总压 $P = 1$ bar下进行。$b_{i}$ 的单位使用 $\\mathrm{bar}^{-1}$，$q_{i,\\max}$ 的单位使用 $\\mathrm{mmol}\\,\\mathrm{g}^{-1}$（只要两种物质使用一致的单位，选择性计算中的单位就会抵消）。不涉及角度。程序必须计算每个测试用例的 $S_{\\mathrm{IAST}}$，并将结果报告为四舍五入到六位小数的十进制浮点数。\n\n测试套件（每个用例是一个元组 $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P)$，其中 $P$ 的单位是 bar）：\n1. 基准烟道气，总压 $P = 1$ bar：(\\,$4.5$, $2.0$, $2.0$, $0.05$, $0.15$, $1.0$\\,)。\n2. 对称参数（期望 $S_{\\mathrm{IAST}} \\approx 1$）：(\\,$3.0$, $0.5$, $3.0$, $0.5$, $0.15$, $1.0$\\,)。\n3. 增加二氧化碳的亲和力（对 $b$ 的敏感性）：(\\,$4.5$, $5.0$, $2.0$, $0.05$, $0.15$, $1.0$\\,)。\n4. 增加二氧化碳的吸附量（对 $q_{\\max}$ 的敏感性）：(\\,$9.0$, $2.0$, $2.0$, $0.05$, $0.15$, $1.0$\\,)。\n5. 低气相二氧化碳浓度和近亨利区：(\\,$4.5$, $0.1$, $2.0$, $0.01$, $0.05$, $1.0$\\,)。\n\n实现要求：\n- 仅使用上面列出的基本原理和假设。除了直接从Langmuir等温线和IAST定义中得出的公式外，不要调用任何吸附捷径公式。\n- 对于每个测试用例，通过求解标量方程 $\\sum_{i \\in \\{\\mathrm{CO_{2}}, \\mathrm{N_{2}}\\}} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$ 来确定 $\\pi$，其中 $P_{i}^{0}(\\pi)$ 由组分 $i$ 的Langmuir等温线的积分 $\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$ 隐式定义。\n- 计算 $x_{\\mathrm{CO_{2}}}$ 和 $x_{\\mathrm{N_{2}}}$，然后报告 $S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$。\n- 输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序与测试套件相同（例如，“[result1,result2,result3,result4,result5]”）。每个结果必须是四舍五入到六位小数的浮点数。", "solution": "对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n\n问题为在多孔材料中模拟二元气体混合物（$i \\in \\{ \\mathrm{CO}_{2}, \\mathrm{N}_{2} \\}$）的竞争性吸附提供了以下数据、定义和约束：\n\n*   **系统**：总压为 $P$、气相摩尔分数为 $y_{i}$ 的二元理想气体混合物。\n*   **理论**：理想吸附溶液理论 (IAST)。\n*   **纯组分等温线模型**：组分 $i$ 的Langmuir等温线：\n    $$q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$$\n    其中 $q_{i,\\max}$ 是饱和吸附量，$b_{i}$ 是亲和常数。\n*   **展布压力定义**：展布压力 $\\pi$ 通过积分方程与纯组分压力 $P_{i}^{0}$ 相关联：\n    $$\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$$\n*   **IAST核心方程**：混合物的总展布压力 $\\pi$ 由以下约束条件确定：\n    $$\\sum_{i} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$$\n*   **吸附相组成**：组分 $i$ 的吸附相摩尔分数由下式给出：\n    $$x_{i} = \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)}$$\n*   **选择性定义**：$\\mathrm{CO}_2$ 相对于 $\\mathrm{N}_2$ 的IAST选择性为：\n    $$S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$$\n*   **全局条件**：总压 $P = 1 \\, \\mathrm{bar}$。$b_{i}$ 的单位为 $\\mathrm{bar}^{-1}$，$q_{i,\\max}$ 的单位为 $\\mathrm{mmol}\\,\\mathrm{g}^{-1}$。\n*   **测试用例**：\n    1.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 2.0, 2.0, 0.05, 0.15, 1.0)$\n    2.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (3.0, 0.5, 3.0, 0.5, 0.15, 1.0)$\n    3.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 5.0, 2.0, 0.05, 0.15, 1.0)$\n    4.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (9.0, 2.0, 2.0, 0.05, 0.15, 1.0)$\n    5.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 0.1, 2.0, 0.01, 0.05, 1.0)$\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n\n*   **有科学依据**：该问题基于Langmuir等温线和理想吸附溶液理论，这些是材料化学和化学工程中用于描述吸附现象的标准、成熟的模型。该框架在科学上是合理的，不含伪科学。\n*   **适定性**：该问题提供了一套完整的方程和参数，为获得唯一解定义了清晰的路径。核心任务是求解一个单变量的非线性方程，这是一个适定的数值问题。\n*   **客观性**：该问题使用精确的数学语言和定量数据来表述。它不含主观或模棱两可的陈述。\n*   **完整性和一致性**：提供了所有必要信息。对于二元混合物，第二组分 $\\mathrm{N_{2}}$ 的摩尔分数 $y_{\\mathrm{N_{2}}}$ 由 $y_{\\mathrm{N_{2}}} = 1 - y_{\\mathrm{CO_{2}}}$ 明确确定。该问题是自洽且内部一致的。\n*   **真实性**：等温线参数和气相组成在物理上是合理的，并且代表了使用MOFs和COFs等多孔材料研究气体分离（例如烟道气）的典型条件。\n\n### 步骤3：结论与行动\n\n该问题是 **有效的**。它有科学依据、适定且完整。将制定一个严谨的解法。\n\n### 解法推导\n\n求解过程需要逐步应用所提供的理论框架。组分用 $1$ 表示 $\\mathrm{CO_{2}}$，用 $2$ 表示 $\\mathrm{N_{2}}$。\n\n**1. 对展布压力方程进行解析积分**\n\n首先，必须对Langmuir等温线的展布压力 $\\pi$ 积分进行解析求解。\n给定的积分为：\n$$\\pi = \\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp$$\n代入Langmuir表达式 $q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$：\n$$\\pi = \\int_{0}^{P_{i}^{0}} \\dfrac{1}{p} \\left( \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p} \\right) dp = q_{i,\\max} b_{i} \\int_{0}^{P_{i}^{0}} \\dfrac{1}{1 + b_{i} \\, p} \\, dp$$\n这个标准积分的计算很简单：\n$$\\pi = q_{i,\\max} b_{i} \\left[ \\dfrac{1}{b_{i}} \\ln(1 + b_{i} p) \\right]_{0}^{P_{i}^{0}} = q_{i,\\max} \\left( \\ln(1 + b_{i} P_{i}^{0}) - \\ln(1 + 0) \\right)$$\n这得出了 $\\pi$ 和 $P_{i}^{0}$ 之间的直接关系：\n$$\\pi = q_{i,\\max} \\ln(1 + b_{i} P_{i}^{0})$$\n\n**2. 反转展布压力关系**\n\n为了使用IAST核心方程，我们必须将虚拟纯组分压力 $P_{i}^{0}$ 表示为展布压力 $\\pi$ 的函数。这需要反转上面推导出的方程。\n$$\\dfrac{\\pi}{q_{i,\\max}} = \\ln(1 + b_{i} P_{i}^{0})$$\n对两边取指数：\n$$\\exp\\left(\\dfrac{\\pi}{q_{i,\\max}}\\right) = 1 + b_{i} P_{i}^{0}$$\n求解 $P_{i}^{0}$：\n$$P_{i}^{0}(\\pi) = \\dfrac{1}{b_{i}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{i,\\max}}\\right) - 1 \\right]$$\n这就是所需要的函数 $P_{i}^{0}(\\pi)$。\n\n**3. 构建用于数值求解的方程**\n\nIAST约束条件 $\\sum_{i} \\frac{y_{i} P}{P_{i}^{0}(\\pi)} = 1$ 必须求解 $\\pi$。对于 $\\mathrm{CO_{2}}$（组分1）和 $\\mathrm{N_{2}}$（组分2）的二元混合物：\n$$\\dfrac{y_{1} P}{P_{1}^{0}(\\pi)} + \\dfrac{y_{2} P}{P_{2}^{0}(\\pi)} = 1$$\n代入 $P_{i}^{0}(\\pi)$ 的表达式：\n$$\\dfrac{y_{1} P}{\\dfrac{1}{b_{1}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1 \\right]} + \\dfrac{y_{2} P}{\\dfrac{1}{b_{2}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1 \\right]} = 1$$\n这是一个关于变量 $\\pi$ 的非线性标量方程。可以通过找到函数 $f(\\pi)$ 的根来数值求解：\n$$f(\\pi) = \\dfrac{y_{1} P b_{1}}{\\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1} + \\dfrac{y_{2} P b_{2}}{\\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1} - 1 = 0$$\n对于 $\\pi  0$，此函数是单调且良态的。当 $\\pi \\to 0^{+}$ 时，$f(\\pi) \\to +\\infty$；当 $\\pi \\to \\infty$ 时，$f(\\pi) \\to -1$。这保证了存在一个唯一的正根，可以使用标准的数值求根算法（如Brent-Dekker方法）找到。\n\n**4. 计算IAST选择性**\n\n一旦确定了唯一的根 $\\pi$，就可以计算IAST选择性 $S_{\\mathrm{IAST}}$。定义如下：\n$$S_{\\mathrm{IAST}} = \\dfrac{x_{1} / x_{2}}{y_{1} / y_{2}}$$\n使用IAST关系 $x_{i} = \\frac{y_{i} P}{P_{i}^{0}(\\pi)}$：\n$$S_{\\mathrm{IAST}} = \\dfrac{\\left(\\dfrac{y_{1} P}{P_{1}^{0}(\\pi)}\\right) / \\left(\\dfrac{y_{2} P}{P_{2}^{0}(\\pi)}\\right)}{y_{1} / y_{2}} = \\dfrac{y_{1} P_{2}^{0}(\\pi)}{y_{2} P_{1}^{0}(\\pi)} \\cdot \\dfrac{y_{2}}{y_{1}}$$\n这可以简化为虚拟纯组分压力的比值：\n$$S_{\\mathrm{IAST}} = \\dfrac{P_{2}^{0}(\\pi)}{P_{1}^{0}(\\pi)}$$\n代入 $P_{i}^{0}(\\pi)$ 的反转表达式：\n$$S_{\\mathrm{IAST}} = \\dfrac{\\dfrac{1}{b_{2}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1 \\right]}{\\dfrac{1}{b_{1}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1 \\right]} = \\dfrac{b_{1}}{b_{2}} \\dfrac{\\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1}{\\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1}$$\n在确定 $\\pi$ 之后，将使用这个最终表达式进行计算。\n\n计算过程如下：\n对于每个测试用例：\n1.  定义参数：$\\mathrm{CO_{2}}$ 的 $q_{1,\\max}$、$b_{1}$、$y_{1}$ 和 $\\mathrm{N_{2}}$ 的 $q_{2,\\max}$、$b_{2}$。压力 $P=1$ 且 $y_{2} = 1 - y_{1}$。\n2.  使用求根算法在合适的区间（如 $[10^{-9}, 1000]$）上数值求解方程 $f(\\pi) = 0$ 得到 $\\pi$。\n3.  使用最终推导的公式计算 $S_{\\mathrm{IAST}}$。\n4.  按要求将结果四舍五入到六位小数。\n此过程将应用于所有提供的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the IAST selectivity for a binary mixture of CO2 and N2\n    following Langmuir isotherms.\n    \"\"\"\n\n    # Test suite: (q_co2_max, b_co2, q_n2_max, b_n2, y_co2, P)\n    # q_max in mmol/g, b in 1/bar, y is mole fraction, P in bar.\n    test_cases = [\n        # 1. Baseline flue gas\n        (4.5, 2.0, 2.0, 0.05, 0.15, 1.0),\n        # 2. Symmetric parameters\n        (3.0, 0.5, 3.0, 0.5, 0.15, 1.0),\n        # 3. Increased affinity for CO2\n        (4.5, 5.0, 2.0, 0.05, 0.15, 1.0),\n        # 4. Increased capacity for CO2\n        (9.0, 2.0, 2.0, 0.05, 0.15, 1.0),\n        # 5. Low gas-phase CO2 and near-Henry regime\n        (4.5, 0.1, 2.0, 0.01, 0.05, 1.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q_co2_max, b_co2, q_n2_max, b_n2, y_co2, P = case\n        y_n2 = 1.0 - y_co2\n\n        # Define the function f(pi) whose root needs to be found.\n        # f(pi) = (y_co2 * P / P0_co2(pi)) + (y_n2 * P / P0_n2(pi)) - 1 = 0\n        # where P0_i(pi) = (1/b_i) * [exp(pi / q_i_max) - 1]\n        def iast_root_function(pi):\n            # To avoid potential overflow or math domain errors for pi = 0\n            if pi == 0:\n                return np.inf\n            \n            # exp(pi / q_max) can be very large. Check term by term.\n            term1_denom = np.exp(pi / q_co2_max) - 1.0\n            term2_denom = np.exp(pi / q_n2_max) - 1.0\n\n            # Guard against division by zero if a denominator is zero,\n            # which happens only if pi is zero, handled above.\n            term1 = (y_co2 * P * b_co2) / term1_denom\n            term2 = (y_n2 * P * b_n2) / term2_denom\n            \n            return term1 + term2 - 1.0\n\n        # Find the spreading pressure (pi) by solving iast_root_function(pi) = 0.\n        # The function f(pi) -> +inf as pi -> 0+ and f(pi) -> -1 as pi -> +inf.\n        # A root is guaranteed to exist in a bracket like [1e-9, 1000].\n        try:\n            pi_solution = brentq(iast_root_function, 1e-9, 1000.0)\n        except ValueError:\n            # Handle cases where the bracket might not be valid, though unlikely.\n            results.append(np.nan)\n            continue\n\n        # Calculate IAST selectivity: S = (x_co2/y_co2) / (x_n2/y_n2) = P0_n2/P0_co2\n        # S = (b_co2/b_n2) * (exp(pi/q_n2_max) - 1) / (exp(pi/q_co2_max) - 1)\n        \n        # Numerator part of selectivity calculation\n        num = (np.exp(pi_solution / q_n2_max) - 1.0)\n        \n        # Denominator part of selectivity calculation\n        den = (np.exp(pi_solution / q_co2_max) - 1.0)\n        \n        # Avoid division by zero if den is zero\n        if den == 0:\n            selectivity = np.inf\n        else:\n            selectivity = (b_co2 / b_n2) * (num / den)\n\n        results.append(round(selectivity, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2514698"}, {"introduction": "吸附过程的最终平衡固然重要，但达到平衡的速度——即吸附动力学——对于设计实际的动态分离过程（如变压吸附或变温吸附）至关重要。线性驱动力 (Linear Driving Force, LDF) 模型是一个简洁而有效的近似方法，用以描述吸附质在多孔颗粒内部的传质速率。在本练习中，你将通过对模拟的穿透曲线数据进行拟合，来确定LDF模型的关键动力学参数，并进一步将其与颗粒的有效扩散系数和尺寸等微观物理性质关联起来，从而深入理解影响吸附速率的内在因素。[@problem_id:2514702]", "problem": "您的任务是设计并实现一个程序，用于估算多孔骨架材料吸附过程中的线性驱动力模型动力学参数，然后利用吸附剂颗粒的几何信息将此动力学参数与有效扩散系数关联起来。该系统代表一个短的、充分混合的吸附床（短固定床的零维近似），其中装填有金属有机骨架或共价有机骨架（统称为多孔骨架材料）。目标是拟合入口气体浓度阶跃变化的合成穿透数据，然后计算有效颗粒内扩散系数。\n\n基本原理和控制关系：\n- 线性驱动力模型假设 $$\\frac{dq}{dt} = k_{\\mathrm{LDF}} \\left(q^\\ast - q\\right),$$ 其中 $q$ 是颗粒内体积平均的吸附相浓度（单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$），$q^\\ast$ 是与颗粒表面气体浓度相对应的平衡吸附相浓度，$k_{\\mathrm{LDF}}$ 是线性驱动力速率系数（单位为 $\\mathrm{s}^{-1}$）。\n- 对于亨利定律范围内的稀释气体吸附，假设 $$q^\\ast = K\\,C,$$ 其中 $K$ 是亨利常数（单位为 $\\mathrm{m}^3\\,\\mathrm{kg}^{-1}$），$C$ 是气相摩尔浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。\n- 对于一个暴露于入口浓度阶跃变化的小型、充分混合的床段（气体加固体），气相和固相的质量守恒产生一个耦合系统：\n  $$V_g \\frac{dC}{dt} = F\\left(C_{\\mathrm{in}} - C\\right) - m_s \\frac{dq}{dt},$$\n  $$\\frac{dq}{dt} = k_{\\mathrm{LDF}}\\left(K C - q\\right),$$\n  其中 $V_g$ 是气体滞留体积（单位为 $\\mathrm{m}^3$），$F$ 是体积流量（单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$），$C_{\\mathrm{in}}$ 是入口气体浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$m_s$ 是吸附剂质量（单位为 $\\mathrm{kg}$）。\n- 为便于解释，定义无量纲出口穿透比 $$u(t) \\equiv \\frac{C(t)}{C_{\\mathrm{in}}}.$$\n\n推导目标：\n- 从半径为 $R_p$（单位为 $\\mathrm{m}$）的球体中的菲克扩散定律出发，并使用体积平均载荷作为状态变量，推导出一个关系式，在膜传质不是速率限制步骤以及线性驱动力模型近似了球体内菲克扩散问题的体积平均响应的假设下，将 $k_{\\mathrm{LDF}}$ 与有效颗粒内扩散系数 $D_{\\mathrm{eff}}$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）及 $R_p$ 联系起来。您的推导必须遵循第一性原理：从球坐标系下的菲克第二定律以及适当的边界和初始条件开始；不要引用任何高级结果作为捷径。\n\n拟合任务：\n- 您将获得三个测试案例，它们的颗粒半径 $R_p$ 和已知的有效扩散系数 $D_{\\mathrm{eff,true}}$ 不同，后者仅用于生成合成的含噪声穿透数据。对于每个测试案例，“观测”数据按以下方式构建：\n  1. 根据您推导出的 $k_{\\mathrm{LDF}}$、$D_{\\mathrm{eff}}$ 和 $R_p$ 之间的关系，在 $D_{\\mathrm{eff,true}}$ 处计算“真实”线性驱动力系数 $k_{\\mathrm{true}}$。\n  2. 对耦合系统进行积分，求解 $C(t)$ 和 $q(t)$，以模拟从 $t=0$ 时的 $C(0)=0$（预吹扫床）和 $q(0)=0$（无初始载荷）到此后的 $C_{\\mathrm{in}}$ 的阶跃变化。\n  3. 定义纯净穿透响应 $u_{\\mathrm{clean}}(t)=C(t)/C_{\\mathrm{in}}$。\n  4.向 $u_{\\mathrm{clean}}(t)$ 添加零均值、标准差为 $\\sigma=0.005$ 的独立同分布高斯扰动，并将结果裁剪到区间 $[0,1]$ 内，以生成 $u_{\\mathrm{obs}}(t)$。\n- 您的程序必须通过最小二乘法将模型预测的 $u(t)$ 拟合到合成的“观测”数据 $u_{\\mathrm{obs}}(t)$，从而估算 $k_{\\mathrm{LDF}}$。在此过程中，使用给定的 $F$、$V_g$、$m_s$、$K$、$C_{\\mathrm{in}}$ 以及指定的时间网格。\n\n所有测试案例的通用常量：\n- 体积流量 $F = 1.0\\times 10^{-6}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n- 气体体积 $V_g = 1.0\\times 10^{-6}\\ \\mathrm{m}^3$。\n- 吸附剂质量 $m_s = 5.0\\times 10^{-4}\\ \\mathrm{kg}$。\n- 亨利常数 $K = 1.0\\times 10^{-1}\\ \\mathrm{m}^3\\,\\mathrm{kg}^{-1}$。\n- 入口浓度 $C_{\\mathrm{in}} = 4.03\\times 10^{1}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 时间网格：从 $t=0$到 $t=600\\ \\mathrm{s}$ 均匀间隔，步长为 $\\Delta t = 2\\ \\mathrm{s}$（即 $301$ 个点）。\n- 观测穿透曲线 $u_{\\mathrm{obs}}(t)$ 的噪声标准差：$\\sigma = 5.0\\times 10^{-3}$。\n- 使用固定的伪随机种子生成噪声以确保可复现性：种子 $= 12345$。\n\n测试套件（三个案例）：\n- 案例A：颗粒半径 $R_p = 3.0\\times 10^{-4}\\ \\mathrm{m}$；用于数据生成的有效扩散系数 $D_{\\mathrm{eff,true}} = 1.2\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- 案例B：颗粒半径 $R_p = 5.0\\times 10^{-4}\\ \\mathrm{m}$；用于数据生成的有效扩散系数 $D_{\\mathrm{eff,true}} = 2.0\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- 案例C：颗粒半径 $R_p = 8.0\\times 10^{-4}\\ \\mathrm{m}$；用于数据生成的有效扩散系数 $D_{\\mathrm{eff,true}} = 8.0\\times 10^{-11}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n\n您的程序必须执行以下操作：\n- 对于每个案例，按所述方法生成 $u_{\\mathrm{obs}}(t)$，然后通过在给定时间网格上最小化模型预测的 $u(t)$ 和 $u_{\\mathrm{obs}}(t)$ 之间的残差平方和来估算 $k_{\\mathrm{LDF}}$。\n- 使用您推导的关系式，将拟合得到的 $k_{\\mathrm{LDF}}$ 转换为推断出的有效扩散系数 $D_{\\mathrm{eff,fit}}$，并使用该案例给定的 $R_p$。\n- 为每个案例报告拟合得到的 $k_{\\mathrm{LDF}}$（单位为 $\\mathrm{s}^{-1}$）和推断出的 $D_{\\mathrm{eff,fit}}$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。\n\n答案格式和单位：\n- 以 $\\mathrm{s}^{-1}$ 表示 $k_{\\mathrm{LDF}}$，以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 表示 $D_{\\mathrm{eff,fit}}$。\n- 您的程序应生成单行输出，其中包含一个列表的列表，每个内部列表对应一个测试案例，顺序为[案例A, 案例B, 案例C]，其中每个内部列表包含两个浮点数 $[k_{\\mathrm{LDF}}, D_{\\mathrm{eff,fit}}]$。\n- 格式示例：$[[k_A, D_A],[k_B, D_B],[k_C, D_C]]$，使用小数或科学记数法。不要添加额外文本。\n\n角度单位不适用。百分比不适用；不要使用百分号。\n\n设计考虑：\n- 参数估计必须对小的加性噪声具有鲁棒性。\n- 单位要明确且一致。\n- 您用来关联 $k_{\\mathrm{LDF}}$ 和 $D_{\\mathrm{eff}}$ 的推导必须源于球体中扩散的第一性原理以及线性驱动力近似的定义；不要在没有证明的情况下假设或引用最终的比例常数。", "solution": "该问题已经过验证，被认为是科学上合理、定义明確且完整的。因此，开发了一个解决方案。该解决方案包括两个主要部分：首先，推导线性驱动力（LDF）系数 $k_{\\mathrm{LDF}}$ 与有效颗粒内扩散系数 $D_{\\mathrm{eff}}$ 之间的关系；其次，通过数值实现来拟合合成的实验数据并确定这些参数。\n\n**第1部分：$k_{\\mathrm{LDF}}$ 与 $D_{\\mathrm{eff}}$ 之间关系的推导**\n\n问题要求从第一性原理出发，将现象学的 LDF 模型系数 $k_{\\mathrm{LDF}}$ 与球形吸附剂颗粒（半径为 $R_p$）中菲克扩散过程的物理参数联系起来。\n\n1.  **菲克扩散模型：** 假设径向对称且有效扩散系数 $D_{\\mathrm{eff}}$ 恒定，球形多孔颗粒内吸附物质的传输由菲克第二定律描述。用在径向位置 $r$ 和时间 $t$ 的局部吸附相浓度 $q_p(r, t)$ 表示，该定律为：\n    $$ \\frac{\\partial q_p}{\\partial t} = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 D_{\\mathrm{eff}} \\frac{\\partial q_p}{\\partial r} \\right) $$\n    初始条件是颗粒不含吸附物，$q_p(r, 0) = 0$。边界条件是中心对称，$\\left(\\frac{\\partial q_p}{\\partial r}\\right)_{r=0} = 0$，以及外表面达到平衡，$q_p(R_p, t) = q^*(t)$，其中 $q^*(t)$ 是与主体气相平衡的吸附浓度。\n\n2.  **体积平均浓度：** LDF 模型是根据体积平均吸附浓度 $q(t)$ 来构建的，其定义为：\n    $$ q(t) = \\frac{1}{V_p} \\int_{V_p} q_p(r, t) dV = \\frac{3}{R_p^3} \\int_0^{R_p} q_p(r, t) 4\\pi r^2 \\frac{dr}{4\\pi} = \\frac{3}{R_p^3} \\int_0^{R_p} q_p(r, t) r^2 dr $$\n\n3.  **吸附速率：** 将 $q(t)$ 的表达式对时间求导，得到总吸附速率：\n    $$ \\frac{dq}{dt} = \\frac{3}{R_p^3} \\int_0^{R_p} \\frac{\\partial q_p}{\\partial t} r^2 dr $$\n    将菲克定律代入此积分：\n    $$ \\frac{dq}{dt} = \\frac{3}{R_p^3} \\int_0^{R_p} \\left[ D_{\\mathrm{eff}} \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial q_p}{\\partial r} \\right) \\right] r^2 dr = \\frac{3 D_{\\mathrm{eff}}}{R_p^3} \\int_0^{R_p} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial q_p}{\\partial r} \\right) dr $$\n    计算该积分可得到基于表面通量的精确吸附速率表达式：\n    $$ \\frac{dq}{dt} = \\frac{3 D_{\\mathrm{eff}}}{R_p^3} \\left[ r^2 \\frac{\\partial q_p}{\\partial r} \\right]_0^{R_p} = \\frac{3 D_{\\mathrm{eff}}}{R_p} \\left( \\frac{\\partial q_p}{\\partial r} \\right)_{r=R_p} $$\n\n4.  **线性驱动力（LDF）模型：** LDF 模型提供了一个简化的、现象学的吸附速率描述：\n    $$ \\frac{dq}{dt} = k_{\\mathrm{LDF}} (q^*(t) - q(t)) $$\n    该方程假设吸附速率与表面浓度 $q^*$ 和平均浓度 $q$ 之间的差值成线性比例，从而近似了复杂的颗粒内动力学。\n\n5.  **通过矩分析等同模型：** 为了找到 $k_{\\mathrm{LDF}}$ 和 $D_{\\mathrm{eff}}$ 之间的关系，我们将这两个模型等同起来。一个可靠的方法是匹配它们各自对表面浓度从 $q_p(R_p, t0) = 0$ 到 $q_p(R_p, t\\ge0) = q^*_{\\mathrm{const}}$ 的阶跃变化响应的一阶时间矩。一阶矩，即平均吸附时间（$\\tau$），表征了过程的整体速度。\n\n    对于 LDF 模型，对阶跃变化的解为 $q(t) = q^*_{\\mathrm{const}}(1 - e^{-k_{\\mathrm{LDF}} t})$。归一化吸附速率为 $E(t) = \\frac{1}{q^*_{\\mathrm{const}}} \\frac{dq}{dt} = k_{\\mathrm{LDF}} e^{-k_{\\mathrm{LDF}} t}$。平均吸附时间为：\n    $$ \\tau_{\\mathrm{LDF}} = \\int_0^\\infty t E(t) dt = \\int_0^\\infty t k_{\\mathrm{LDF}} e^{-k_{\\mathrm{LDF}} t} dt = \\frac{1}{k_{\\mathrm{LDF}}} $$\n\n    对于球体中的菲克扩散模型，平均吸附时间是一個标准结果，可以通过拉普拉斯变换推导得出。结果是：\n    $$ \\tau_{\\mathrm{Fick}} = \\frac{R_p^2}{15 D_{\\mathrm{eff}}} $$\n\n6.  **最终关系：** 通过令平均吸附时间相等，$\\tau_{\\mathrm{LDF}} = \\tau_{\\mathrm{Fick}}$，我们建立了 LDF 系数与扩散模型参数之间的直接对应关系：\n    $$ \\frac{1}{k_{\\mathrm{LDF}}} = \\frac{R_p^2}{15 D_{\\mathrm{eff}}} $$\n    整理后得到我们分析所用的最终表达式：\n    $$ k_{\\mathrm{LDF}} = \\frac{15 D_{\\mathrm{eff}}}{R_p^2} $$\n这种关系使我们能够用更基本的有效扩散系数 $D_{\\mathrm{eff}}$ 来解释拟合得到的 LDF 系数 $k_{\\mathrm{LDF}}$。\n\n**第2部分：数值步骤**\n\n程序将对每个测试案例执行以下步骤：\n\n1.  **合成数据生成：**\n    a. 给定案例的 $D_{\\mathrm{eff,true}}$ 和 $R_p$，计算“真实”LDF 系数 $k_{\\mathrm{true}} = 15 D_{\\mathrm{eff,true}} / R_p^2$。\n    b. 用于充分混合床的耦合常微分方程（ODEs）系统是：\n       $$ \\frac{dC}{dt} = \\frac{F}{V_g}(C_{\\mathrm{in}} - C) - \\frac{m_s}{V_g} k_{\\mathrm{true}}(K C - q) $$\n       $$ \\frac{dq}{dt} = k_{\\mathrm{true}}(K C - q) $$\n    c. 该系统使用 `scipy.integrate.solve_ivp` 在指定的时间网格上进行数值求解，初始条件为 $C(0)=0$ 和 $q(0)=0$。考虑到可能存在的刚性问题，选择 'BDF' 方法以确保鲁棒性。\n    d. 从解中计算出纯净的穿透曲线 $u_{\\mathrm{clean}}(t) = C(t) / C_{\\mathrm{in}}$。\n    e. 添加噪声：将均值为 $0$、标准差为 $\\sigma=0.005$ 的独立高斯噪声添加到 $u_{\\mathrm{clean}}(t)$。将含噪信号裁剪到物理上有意义的范围 $[0, 1]$ 内，以生成“观测”数据 $u_{\\mathrm{obs}}(t)$。固定的随机种子确保了可复现性。\n\n2.  **参数估计：**\n    a. 定义一个目标函数来计算模型预测与合成数据之间的残差平方和（SSR）：\n       $$ \\mathrm{SSR}(k_{\\mathrm{LDF}}) = \\sum_{i} \\left( u_{\\mathrm{model}}(t_i; k_{\\mathrm{LDF}}) - u_{\\mathrm{obs}}(t_i) \\right)^2 $$\n       其中 $u_{\\mathrm{model}}(t_i; k_{\\mathrm{LDF}})$ 是通过使用 $k_{\\mathrm{LDF}}$ 的试验值求解 ODE 系统得到的模型预测穿透比。\n    b. 使用 `scipy.optimize.minimize` 函数找到使 SSR 最小化的 $k_{\\mathrm{LDF}}$ 值。使用 'L-BFGS-B' 算法将 $k_{\\mathrm{LDF}}$ 的搜索范围限制为正值。使用 $k_{\\mathrm{LDF}}=0.01\\ \\mathrm{s}^{-1}$ 作为初始猜测值。\n\n3.  **结果计算：**\n    a. 优化后的参数是拟合得到的 LDF 系数，$k_{\\mathrm{LDF,fit}}$。\n    b. 然后使用所推导关系的反函数，用这个值来计算推斷出的有效扩散系数：\n       $$ D_{\\mathrm{eff,fit}} = \\frac{k_{\\mathrm{LDF,fit}} R_p^2}{15} $$\n\n4.  **输出：** 对于每个案例，存储数据对 $[k_{\\mathrm{LDF,fit}}, D_{\\mathrm{eff,fit}}]$。最终输出是一个包含所有测试案例的这些数据对的列表，格式如指定。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves for the LDF kinetic parameter and effective diffusivity from synthetic\n    breakthrough data.\n    \"\"\"\n\n    # Common constants\n    F = 1.0e-6    # Volumetric flow rate, m^3/s\n    Vg = 1.0e-6   # Gas volume, m^3\n    ms = 5.0e-4   # Adsorbent mass, kg\n    K = 1.0e-1    # Henry's constant, m^3/kg\n    C_in = 4.03e1 # Inlet concentration, mol/m^3\n    SIGMA = 5.0e-3 # Noise standard deviation for u(t)\n    SEED = 12345  # Pseudorandom seed for reproducibility\n\n    # Time grid\n    t_span = [0, 600]\n    dt = 2.0\n    t_eval = np.arange(t_span[0], t_span[1] + dt, dt)\n\n    # Test suite\n    test_cases = [\n        # Case A\n        {'Rp': 3.0e-4, 'Deff_true': 1.2e-10},\n        # Case B\n        {'Rp': 5.0e-4, 'Deff_true': 2.0e-10},\n        # Case C\n        {'Rp': 8.0e-4, 'Deff_true': 8.0e-11},\n    ]\n\n    # Initialize random number generator\n    rng = np.random.default_rng(SEED)\n\n    def ldf_relation_k(D_eff, R_p):\n        \"\"\"Calculates k_LDF from D_eff and R_p.\"\"\"\n        return 15.0 * D_eff / (R_p**2)\n\n    def ldf_relation_d(k_LDF, R_p):\n        \"\"\"Calculates D_eff from k_LDF and R_p.\"\"\"\n        return k_LDF * R_p**2 / 15.0\n\n    def breakthrough_model(t, y, k_ldf):\n        \"\"\"\n        Coupled ODE system for the adsorption bed.\n        y = [C, q]\n        \"\"\"\n        C, q = y\n        dCdt = (F / Vg) * (C_in - C) - (ms / Vg) * k_ldf * (K * C - q)\n        dqdt = k_ldf * (K * C - q)\n        return [dCdt, dqdt]\n\n    def solve_breakthrough(k_ldf):\n        \"\"\"\n        Solves the ODE system for a given k_LDF and returns the breakthrough curve u(t).\n        \"\"\"\n        y0 = [0.0, 0.0]  # Initial conditions C(0)=0, q(0)=0\n        sol = solve_ivp(\n            fun=breakthrough_model,\n            t_span=t_span,\n            y0=y0,\n            method='BDF',\n            t_eval=t_eval,\n            args=(k_ldf,)\n        )\n        C_t = sol.y[0]\n        u_t = C_t / C_in\n        return u_t\n\n    def objective_function(k_ldf_guess, u_obs):\n        \"\"\"\n        Calculates the sum of squared residuals for the optimizer.\n        \"\"\"\n        # k_ldf_guess is an array, so extract the float\n        k = k_ldf_guess[0]\n        u_model = solve_breakthrough(k)\n        ssr = np.sum((u_model - u_obs)**2)\n        return ssr\n\n    results = []\n\n    for case in test_cases:\n        Rp = case['Rp']\n        Deff_true = case['Deff_true']\n\n        # 1. Generate synthetic data\n        k_true = ldf_relation_k(Deff_true, Rp)\n        u_clean = solve_breakthrough(k_true)\n        noise = rng.normal(0, SIGMA, len(u_clean))\n        u_obs = np.clip(u_clean + noise, 0.0, 1.0)\n\n        # 2. Fit k_LDF to the synthetic data\n        initial_guess = [0.01]\n        bounds = [(1e-6, None)] # k_LDF must be positive\n        \n        opt_result = minimize(\n            fun=objective_function,\n            x0=initial_guess,\n            args=(u_obs,),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n\n        k_ldf_fit = opt_result.x[0]\n\n        # 3. Infer D_eff from the fitted k_LDF\n        Deff_fit = ldf_relation_d(k_ldf_fit, Rp)\n\n        results.append([k_ldf_fit, Deff_fit])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2514702"}]}