{"hands_on_practices": [{"introduction": "含时密度泛函理论 (TD-DFT) 是模拟分子光物理过程（如光吸收和荧光）的强大工具。斯托克斯位移，即吸收光谱峰值与发射光谱峰值之间的能量差，其根源在于分子被光激发后发生的几何结构弛豫。本练习将引导您完成计算这一重要性质的标准流程，即通过优化基态和激发态的几何构型，并结合单点能计算，从而为理解真实世界中有机分子的发光特性提供坚实的理论基础 [@problem_id:1417512]。", "problem": "一位计算化学家正在研究一种新合成的有机分子的光物理性质，该分子旨在用于有机发光二极管（OLED）。目标是预测斯托克斯位移，即吸收光谱和发射光谱最大值之间的能量差。这是通过使用量子化学方法模拟分子在光激发后的行为来实现的。\n\n该计算方案基于用于基态的密度泛函理论（DFT）和用于激发态的含时密度泛函理论（TD-DFT），包括以下步骤：\n1.  在其电子基态 ($S_0$) 下优化分子的几何结构，得到平衡几何结构 $R_0$。\n2.  然后在其第一单重激发态 ($S_1$) 下优化几何结构，得到弛豫的激发态平衡几何结构 $R_1$。\n\n然后进行一系列单点能计算。这些计算得到的总电子能量如下所示。请注意，$E(S_i, R_j)$ 表示在固定的原子核几何结构 $R_j$ 下计算的电子态 $S_i$ 的能量。\n\n-   在优化的基态几何结构下的基态能量，$E(S_0, R_0) = -450.1234$ Hartrees。\n-   在优化的基态几何结构下的第一激发态能量，$E(S_1, R_0) = -449.9948$ Hartrees。\n-   在优化的激发态几何结构下的第一激发态能量，$E(S_1, R_1) = -449.9985$ Hartrees。\n-   在优化的激发态几何结构下的基态能量，$E(S_0, R_1) = -450.1197$ Hartrees。\n\n使用所提供的数据和转换因子 1 Hartree = 27.2114 eV，计算该分子的斯托克斯位移。以电子伏特（eV）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "根据弗兰克-康登原理，斯托克斯位移定义为垂直吸收能（从 $R_{0}$ 处的 $S_{0}$ 到 $R_{0}$ 处的 $S_{1}$）与垂直发射能（从 $R_{1}$ 处的 $S_{1}$ 到 $R_{1}$ 处的 $S_{0}$）之间的差值。\n\n定义吸收能：\n$$\nE_{\\text{abs}}=\\left[E(S_{1},R_{0})-E(S_{0},R_{0})\\right].\n$$\n代入给定值（单位为 Hartrees）：\n$$\nE_{\\text{abs}} = \\left[-449.9948 - (-450.1234)\\right] = 0.1286.\n$$\n\n定义发射能：\n$$\nE_{\\text{em}}=\\left[E(S_{1},R_{1})-E(S_{0},R_{1})\\right].\n$$\n代入给定值（单位为 Hartrees）：\n$$\nE_{\\text{em}} = \\left[-449.9985 - (-450.1197)\\right] = 0.1212.\n$$\n\n那么，以能量单位表示的斯托克斯位移为：\n$$\n\\Delta E_{\\text{Stokes}} = E_{\\text{abs}} - E_{\\text{em}} = 0.1286 - 0.1212 = 0.0074 \\text{ Hartree}.\n$$\n\n使用 $1 \\text{ Hartree} = 27.2114 \\text{ eV}$ 将 Hartrees 转换为电子伏特：\n$$\n\\Delta E_{\\text{Stokes}} (\\text{eV}) = 0.0074 \\times 27.2114 = 0.20136436 \\text{ eV}.\n$$\n\n四舍五入到三位有效数字：\n$$\n\\Delta E_{\\text{Stokes}} = 0.201 \\text{ eV}.\n$$", "answer": "$$\\boxed{0.201}$$", "id": "1417512"}, {"introduction": "在掌握了基本计算流程之后，理解计算参数如何影响结果的准确性至关重要。基组的选择是其中一个关键环节，它决定了我们用来描述分子轨道的数学函数的完备性。本练习 [@problem_id:2466169] 将通过一个简化的模型，让您动手实践并量化激发能的计算结果对基组选择的敏感度，突显为特定类型的激发态（如偶氮苯的 $n \\to \\pi^*$ 和 $\\pi \\to \\pi^*$ 跃迁）选择具有足够灵活性（即更高的基数和包含弥散函数）的基组是何等重要。", "problem": "你的任务是模拟在含时密度泛函理论（Time-Dependent Density Functional Theory, TD-DFT）框架内计算的偶氮苯生色团的最低单重态激发能对轨道基组选择的敏感性。考虑一个单一的主导轨道跃迁，并采用线性响应TD-DFT的Tamm-Dancoff近似（TDA）。在这个单跃迁TDA模型中，激发能定义为Kohn–Sham轨道能量差和有效核耦合之和，两者均以电子伏特表示。对于一个由有效主数和增广标志表征的基组，使用以下模型来描述基组不完备性：\n1. Kohn–Sham带隙由下式给出\n$$\\Delta \\varepsilon(X,d) = \\Delta \\varepsilon_{\\infty} + \\frac{\\alpha}{X^{p}} - \\beta\\, d,$$\n2. 有效核耦合由下式给出\n$$K(X,d) = K_{\\infty} + \\frac{\\gamma}{X^{q}} - \\delta\\, d,$$\n3. Tamm–Dancoff激发能则为\n$$\\omega(X,d) = \\Delta \\varepsilon(X,d) + K(X,d)。$$\n\n此处，$X$ 是一个正实数，代表基组的有效zeta基数，而 $d \\in \\{0,1\\}$ 表示是否存在 ($d=1$) 或不存在 ($d=0$) 弥散增广函数。所有能量单位均为电子伏特（eV）。参数 $\\Delta \\varepsilon_{\\infty}$、$K_{\\infty}$、$\\alpha$、$\\beta$、$\\gamma$、$\\delta$、$p$ 和 $q$ 在每个测试案例中给出。对基组使用以下映射关系：\n- $6\\text{-}31\\text{G}^*$：$(X,d) = (2,0)$，\n- $\\text{cc-pVTZ}$：$(X,d) = (3,0)$，\n- $\\text{aug-cc-pVTZ}$：$(X,d) = (3,1)$。\n\n将两个基组 $A$ 和 $B$ 之间的激发能敏感性定义为\n$$S(A,B) = \\left|\\omega(X_A,d_A) - \\omega(X_B,d_B)\\right|。$$\n\n对于下方的每个测试案例，计算两种敏感性，单位为电子伏特：\n- $S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ})$，\n- $S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ})$。\n\n将所有最终的敏感性值以eV为单位表示，并四舍五入到四位小数。\n\n测试套件（每行为一个独立的测试案例，除非另有说明，参数单位为eV）：\n- 测试案例1（偶氮苯 $n \\rightarrow \\pi^*$ 类跃迁）：$\\Delta \\varepsilon_{\\infty} = 2.30$, $K_{\\infty} = 0.20$, $\\alpha = 0.90$, $\\beta = 0.05$, $\\gamma = 0.30$, $\\delta = 0.02$, $p = 2$, $q = 3$。\n- 测试案例2（偶氮苯 $\\pi \\rightarrow \\pi^*$ 类跃迁）：$\\Delta \\varepsilon_{\\infty} = 4.10$, $K_{\\infty} = 0.35$, $\\alpha = 0.70$, $\\beta = 0.03$, $\\gamma = 0.20$, $\\delta = 0.01$, $p = 2$, $q = 3$。\n- 测试案例3（弥散，类里德堡边缘情况）：$\\Delta \\varepsilon_{\\infty} = 3.60$, $K_{\\infty} = 0.10$, $\\alpha = 1.50$, $\\beta = 0.10$, $\\gamma = 0.50$, $\\delta = 0.05$, $p = 2$, $q = 3$。\n\n你的程序必须对每个测试案例按给定顺序计算一对敏感性，顺序为\n$[S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ}), S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ})]$,\n然后将所有测试案例的结果按以下顺序汇总到一个列表中：\n$$[S_1^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_1^{(\\text{cc},\\text{aug})}, S_2^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_2^{(\\text{cc},\\text{aug})}, S_3^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_3^{(\\text{cc},\\text{aug})}].$$\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个数字四舍五入到四位小数（例如，“[0.1234,0.0567,0.8910,0.0001,0.2222,0.3333]”）。所有值都必须以eV为单位。不应打印任何其他文本。", "solution": "本问题的目标是根据提供的模型，计算TD-DFT激发能对基组选择的敏感性。\n\n首先，我们将各分量表达式合并，得到总激发能 $\\omega$ 的完整表达式：\n$$ \\omega(X,d) = \\Delta\\varepsilon(X,d) + K(X,d) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{X^{p}} + \\frac{\\gamma}{X^{q}} - (\\beta + \\delta)d $$\n这里，$X$ 是基组的有效zeta基数，$d$ 是弥散函数的标志。\n\n问题中给出了三种基组及其对应的 $(X,d)$ 参数：\n- 基组 A ($6\\text{-}31\\text{G}^*$): $(X_A, d_A) = (2, 0)$\n- 基组 B ($\\text{cc-pVTZ}$): $(X_B, d_B) = (3, 0)$\n- 基组 C ($\\text{aug-cc-pVTZ}$): $(X_C, d_C) = (3, 1)$\n\n我们需要为每个测试案例计算两种敏感性：\n1. $S_1 = S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ}) = |\\omega(X_A, d_A) - \\omega(X_C, d_C)| = |\\omega(2, 0) - \\omega(3, 1)|$\n2. $S_2 = S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ}) = |\\omega(X_B, d_B) - \\omega(X_C, d_C)| = |\\omega(3, 0) - \\omega(3, 1)|$\n\n我们先推导 $S_1$ 和 $S_2$ 的一般表达式。\n首先计算三个基组对应的激发能：\n$$ \\omega_A = \\omega(2, 0) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{2^{p}} + \\frac{\\gamma}{2^{q}} $$\n$$ \\omega_B = \\omega(3, 0) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} $$\n$$ \\omega_C = \\omega(3, 1) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta) $$\n\n现在计算敏感性 $S_2$：\n\\begin{align*}\nS_2 &= |\\omega_B - \\omega_C| \\\\\n&= \\left| \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} \\right) - \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta) \\right) \\right| \\\\\n&= | \\beta + \\delta |\n\\end{align*}\n由于模型参数 $\\beta$ 和 $\\delta$ 都是正数，所以 $S_2 = \\beta + \\delta$。这大大简化了第二种敏感性的计算，它只取决于弥散函数对能隙和耦合项的直接影响。\n\n接下来计算敏感性 $S_1$：\n\\begin{align*}\nS_1 &= |\\omega_A - \\omega_C| \\\\\n&= \\left| \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{2^{p}} + \\frac{\\gamma}{2^{q}} \\right) - \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta) \\right) \\right| \\\\\n&= \\left| \\left( \\frac{\\alpha}{2^{p}} - \\frac{\\alpha}{3^{p}} \\right) + \\left( \\frac{\\gamma}{2^{q}} - \\frac{\\gamma}{3^{q}} \\right) + (\\beta + \\delta) \\right|\n\\end{align*}\n这个表达式衡量了从一个较小的、无弥散函数的基组 ($X=2$) 变到一个较大的、有弥散函数的基组 ($X=3$) 所带来的综合效应。\n\n**计算流程**：\n对于每个测试案例，使用给定的参数 ($\\Delta\\varepsilon_{\\infty}, K_{\\infty}, \\alpha, \\beta, \\gamma, \\delta, p, q$)：\n1.  计算 $S_1 = \\left| \\alpha(\\frac{1}{2^p} - \\frac{1}{3^p}) + \\gamma(\\frac{1}{2^q} - \\frac{1}{3^q}) + \\beta + \\delta \\right|$。\n2.  计算 $S_2 = \\beta + \\delta$。\n3.  将 $S_1$ 和 $S_2$ 的结果四舍五入到四位小数。\n4.  将所有测试案例的结果按指定顺序汇总成一个列表。\n\n此算法将由提供的Python代码实现，以处理给定的测试套件。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of TD-DFT excitation energies to basis set choice\n    based on a provided model.\n    \"\"\"\n\n    # Define the basis set mappings from name to (X, d) parameters.\n    basis_sets = {\n        \"6-31G*\": (2.0, 0),\n        \"cc-pVTZ\": (3.0, 0),\n        \"aug-cc-pVTZ\": (3.0, 1)\n    }\n\n    # Define the test cases with their specific parameters.\n    # Parameters: de_inf, k_inf, alpha, beta, gamma, delta, p, q\n    test_cases = [\n        # Test case 1\n        (2.30, 0.20, 0.90, 0.05, 0.30, 0.02, 2.0, 3.0),\n        # Test case 2\n        (4.10, 0.35, 0.70, 0.03, 0.20, 0.01, 2.0, 3.0),\n        # Test case 3\n        (3.60, 0.10, 1.50, 0.10, 0.50, 0.05, 2.0, 3.0),\n    ]\n\n    all_results = []\n\n    def calculate_omega(X, d, params):\n        \"\"\"\n        Calculates the excitation energy omega(X, d) for a given set of parameters.\n        \n        Args:\n            X (float): Effective zeta cardinality.\n            d (int): Diffuse function flag (0 or 1).\n            params (tuple): A tuple containing the model parameters in the order\n                            (de_inf, k_inf, alpha, beta, gamma, delta, p, q).\n        \n        Returns:\n            float: The calculated excitation energy omega in eV.\n        \"\"\"\n        de_inf, k_inf, alpha, beta, gamma, delta, p, q = params\n        \n        delta_eps = de_inf + (alpha / (X**p)) - (beta * d)\n        K = k_inf + (gamma / (X**q)) - (delta * d)\n        \n        return delta_eps + K\n\n    for case_params in test_cases:\n        # Get the (X, d) tuples for the basis sets of interest\n        x_a, d_a = basis_sets[\"6-31G*\"]\n        x_b, d_b = basis_sets[\"cc-pVTZ\"]\n        x_c, d_c = basis_sets[\"aug-cc-pVTZ\"]\n\n        # Calculate the excitation energy for each basis set\n        omega_a = calculate_omega(x_a, d_a, case_params)\n        omega_b = calculate_omega(x_b, d_b, case_params)\n        omega_c = calculate_omega(x_c, d_c, case_params)\n\n        # Calculate the two required sensitivities\n        # S1 = S(6-31G*, aug-cc-pVTZ)\n        sensitivity_1 = np.abs(omega_a - omega_c)\n\n        # S2 = S(cc-pVTZ, aug-cc-pVTZ)\n        sensitivity_2 = np.abs(omega_b - omega_c)\n\n        # Append the formatted results to the final list\n        all_results.append(f\"{sensitivity_1:.4f}\")\n        all_results.append(f\"{sensitivity_2:.4f}\")\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2466169"}, {"introduction": "TD-DFT 并非一个能解决所有问题的“黑匣子”，它有着一些著名的局限性，其中最典型的便是“电荷转移（CT）问题”。当电子激发涉及从分子的一部分（给体）到空间上分离的另一部分（受体）时，许多标准的近似泛函会给出灾难性的错误预测。本练习 [@problem_id:2466214] 将指导您从第一性原理出发，推导并用代码验证这一理论缺陷，演示为何一个标准的 GGA 泛函会错误地预测一个虚假的、能量过低的 CT 激发态。完成这一练习有助于培养您在实际研究中批判性地选择和评估计算方法的能力。", "problem": "要求您编写一个完整、可运行的程序，在一个最小但有科学依据的模型中，演示含时密度泛函理论 (TD-DFT) 如何在使用标准广义梯度近似 (GGA) 泛函时，错误地预测空间分离的给体-受体对中存在一个人为的低能荷移激发。您的程序必须从第一性原理出发实现以下逻辑。\n\n从密度泛函理论 (DFT) 中电离势和电子亲和能的基本定义，以及分离电荷的静电相互作用出发。使用这些原理推导出大间距下最低的给体到受体荷移激发能的表达式。然后，利用线性响应 TD-DFT 以及对于空间上无重叠的轨道，绝热半局域哈特里-交换-相关核产生的耦合可以忽略不计这一事实，推导出半局域 GGA 泛函所做的相应预测。最后，通过引入导数不连续性，将 Kohn-Sham 轨道能量差与基本能隙联系起来。在推导过程中，请勿使用或引用任何已有的简化公式；相反，仅基于以下基本原理进行推理：\n- 基本定义：通过总能量差定义的电离势 $I$ 和电子亲和能 $A$，以及相距为 $R$ 的两个单位电荷之间的静电相互作用能。\n- 线性响应理论核心思想：激发能来自一个由非相互作用跃迁能和耦合项决定的响应极点，并且对于轨道重叠可忽略不计的空间分离片段之间的电荷转移，局域和绝热的核提供的长程耦合可忽略不计。\n- 经过充分检验的概念性事实：多体基本能隙通过导数不连续性与 Kohn-Sham 能隙相关联。\n\n为每个测试用例实现一个最小的双片段模型，参数如下：\n- 给体电离势 $I_D$（单位：哈特里）。\n- 受体电子亲和能 $A_A$（单位：哈特里）。\n- 中心间距 $R$（单位：玻尔）。\n- 一个有效的正导数不连续性参数 $\\Delta_{\\mathrm{xc}}$（单位：哈特里），该参数捕捉了半局域 GGA 泛函低估能隙的特征。\n\n对于每个测试用例，计算：\n1. 基于上述原理的、物理上合理的的大间距荷移激发能，以哈特里为单位，此处表示为 $E_{\\mathrm{true}}$。\n2. 绝热半局域 GGA TD-DFT 对相同荷移激发的预测值，以哈特里为单位，此处表示为 $E_{\\mathrm{GGA}}$。\n3. 带符号误差 $\\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}}$（单位：哈特里）。\n4. 一个布尔标志，当且仅当 GGA 预测值人为地过低时（定义为严格不等式 $E_{\\mathrm{GGA}}  E_{\\mathrm{true}}$）为真。\n\n您的程序必须使用以下固定的参数元组 $(I_D,A_A,R,\\Delta_{\\mathrm{xc}})$ 测试套件，单位为原子单位（能量为哈特里，距离为玻尔）：\n- 测试 1（一般分离对）：$(0.30, 0.08, 30.0, 0.12)$。\n- 测试 2（极大间距）：$(0.30, 0.08, 200.0, 0.12)$。\n- 测试 3（导致 GGA 激发能接近于零的小基本能隙）：$(0.20, 0.08, 25.0, 0.12)$。\n- 测试 4（在此 $R$ 值下，低估值等于缺失的静电相互作用的数值平衡点）：$(0.25, 0.05, 8.\\overline{3}, 0.12)$，其中 $8.\\overline{3}$ 表示 $25/3$ 玻尔。\n\n所有能量必须以哈特里表示，并四舍五入到六位小数。对于每个测试用例，您的程序必须按顺序输出 $E_{\\mathrm{true}}$、$E_{\\mathrm{GGA}}$、$\\Delta E$ 和布尔标志这四个值。将所有测试用例的结果汇总到一个扁平列表中。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,...]”）。\n\n不涉及角度单位。不允许外部输入；程序必须完全自包含，并在执行时产生所需的单行输出。", "solution": "问题陈述具有科学依据，提法明确，并包含推导唯一解所需的所有信息。它描述了常见密度泛函近似的一种众所周知的失效模式。因此，该问题被认为是有效的，并将基于所提供的第一性原理构建解决方案。\n\n我们首先推导物理上正确的、大间距下的荷移 ($CT$) 激发能的表达式，记为 $E_{\\mathrm{true}}$。一个 $CT$ 激发过程涉及将一个电子从给体分子 $D$ 移动到相距为 $R$ 的受体分子 $A$。该过程可表示为 $D^0A^0 \\rightarrow D^+A^-$。此激发的能量 $\\omega_{CT}$ 是最终态和初始态总能量之差：\n$$ \\omega_{CT} = E(D^+A^-) - E(D^0A^0) $$\n在大间距 $R$ 的极限下，组合体系的能量可以近似为其非相互作用的组成片段的能量之和，再加上它们的经典静电相互作用能。对于初始中性态，能量为：\n$$ E(D^0A^0) \\approx E(D^0) + E(A^0) $$\n对于最终的离子态，能量包括新形成的离子之间的静电引力：\n$$ E(D^+A^-) \\approx E(D^+) + E(A^-) + E_{\\mathrm{int}} $$\n这里，$E(X)$ 表示物种 $X$ 的总能量。$D^+$ 上的 $+1e$ 点电荷与 $A^-$ 上的 $-1e$ 点电荷之间的相互作用能 $E_{\\mathrm{int}}$ 由库仑定律给出。在原子单位制中，能量单位为哈特里，距离单位为玻尔，该能量为：\n$$ E_{\\mathrm{int}} = -\\frac{1}{R} $$\n将这些表达式代入 $\\omega_{CT}$ 的方程，我们得到：\n$$ \\omega_{CT} \\approx \\left( E(D^+) + E(A^-) - \\frac{1}{R} \\right) - \\left( E(D^0) + E(A^0) \\right) $$\n按物种对各项进行重新排列可得：\n$$ \\omega_{CT} \\approx \\left( E(D^+) - E(D^0) \\right) + \\left( E(A^-) - E(A^0) \\right) - \\frac{1}{R} $$\n括号中的项对应于基本定义。给体的电离势 $I_D$ 是移去一个电子所需的能量：\n$$ I_D = E(D^+) - E(D^0) $$\n受体的电子亲和能 $A_A$ 是俘获一个电子所释放的能量，定义为：\n$$ A_A = E(A^0) - E(A^-) $$\n根据这个定义，可以得出 $E(A^-) - E(A^0) = -A_A$。通过代入 $I_D$ 和 $A_A$ 的这些定义，我们得到了真实的大间距荷移激发能的表达式：\n$$ E_{\\mathrm{true}} = I_D - A_A - \\frac{1}{R} $$\n\n接下来，我们推导绝热半局域含时密度泛函理论 ($TD-DFT$) 的相应预测值，记为 $E_{\\mathrm{GGA}}$。在线性响应 $TD-DFT$ 中，激发能 $\\omega$ 是通过一个矩阵方程的本征值得到的。对于从一个占据的 Kohn-Sham ($KS$) 轨道 $\\phi_i$ 到一个虚 $KS$ 轨道 $\\phi_a$ 的单次激发，在绝热近似下的激发能由下式给出：\n$$ \\omega_{ia} = \\varepsilon_a - \\varepsilon_i + K_{ia,ia} $$\n其中 $\\varepsilon_i$ 和 $\\varepsilon_a$ 是 $KS$ 轨道的能量，$K_{ia,ia}$ 是耦合矩阵元。该矩阵元依赖于哈特里-交换-相关 ($HXC$) 核 $f_{HXC}$：\n$$ K_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r}) f_{HXC}(\\mathbf{r}, \\mathbf{r}') \\phi_a^*(\\mathbf{r}')\\phi_i(\\mathbf{r}') d\\mathbf{r} d\\mathbf{r}' $$\n对于我们所考虑的 $CT$ 激发，占据轨道 $\\phi_i$ 是给体的最高占据分子轨道 ($HOMO_D$)，虚轨道 $\\phi_a$ 是受体的最低未占分子轨道 ($LUMO_A$)。在大间距 $R$ 下，这些轨道在空间上是孤立的，它们的重叠乘积 $\\phi_i(\\mathbf{r})\\phi_a(\\mathbf{r})$ 对于所有 $\\mathbf{r}$ 都是可以忽略不计的。\n对于一个半局域泛函，例如广义梯度近似 ($GGA$)，其核 $f_{HXC}^{GGA}(\\mathbf{r}, \\mathbf{r}')$ 实际上是局域的，意味着它随着距离 $|\\mathbf{r} - \\mathbf{r}'|$ 的增加而迅速衰减为零。局域核和可忽略的轨道重叠的结合导致耦合积分 $K_{ia,ia}$ 变为零：\n$$ K_{ia,ia}^{GGA} \\approx 0 $$\n因此，$TD-GGA$ 激发能错误地简化为所涉及的 $KS$ 轨道能量的简单差值：\n$$ E_{\\mathrm{GGA}} = \\omega_{CT}^{GGA} \\approx \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D} $$\n为了使该表达式有用，我们必须将这个 $KS$ 轨道能隙与物理量 $I_D$ 和 $A_A$ 联系起来。组合的 $D-A$ 体系的基本多体能隙为 $E_{gap} = I_D - A_A$。相应的 $KS$ 能隙为 $\\varepsilon_{gap}^{KS} = \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}$。对于一个精确的泛函，这些量通过交换相关势的导数不连续性 $\\Delta_{xc}$ 相关联：\n$$ E_{gap} = \\varepsilon_{gap}^{KS} + \\Delta_{xc} \\implies I_D - A_A = (\\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}) + \\Delta_{xc} $$\n像 $GGA$ 这样的近似泛函存在一个系统性误差，这个误差实际上对应于缺失的导数不连续性。该问题提供了一个有效的参数 $\\Delta_{\\mathrm{xc}} > 0$ 来模拟这一缺陷。在 $GGA$ 框架内，对 $KS$ 能隙的方程进行重新排列可得：\n$$ \\varepsilon_{LUMO,A}^{GGA} - \\varepsilon_{HOMO,D}^{GGA} = (I_D - A_A) - \\Delta_{\\mathrm{xc}} $$\n这给出了 $TD-GGA$ 荷移激发能的最终表达式：\n$$ E_{\\mathrm{GGA}} = I_D - A_A - \\Delta_{\\mathrm{xc}} $$\n这个结果错误地显示了激发能在 $R$ 很大时趋于一个常数值，完全没有体现正确的 $-1/R$ 渐近行为。\n\n最后，我们计算带符号误差 $\\Delta E$ 并建立人为低预测值的条件。误差是 $GGA$ 值与真实值之差：\n$$ \\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}} = (I_D - A_A - \\Delta_{\\mathrm{xc}}) - \\left(I_D - A_A - \\frac{1}{R}\\right) $$\n$$ \\Delta E = \\frac{1}{R} - \\Delta_{\\mathrm{xc}} $$\n$GGA$ 预测值人为地过低，当且仅当 $E_{\\mathrm{GGA}}  E_{\\mathrm{true}}$，这意味着 $\\Delta E  0$。这给出了条件：\n$$ \\frac{1}{R} - \\Delta_{\\mathrm{xc}}  0 \\implies \\frac{1}{R}  \\Delta_{\\mathrm{xc}} $$\n随着间距 $R$ 的增加，$1/R$ 减小。对于任何存在非零能隙低估误差（$\\Delta_{\\mathrm{xc}} > 0$）的体系，都存在一个间距，超过该间距后此不等式即成立，这证明了绝热半局域泛函在描述长程荷移方面的根本性失败。以下程序实现了这些推导出的公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the true and TD-GGA charge-transfer excitation energies for a\n    series of donor-acceptor pairs to demonstrate the failure of semilocal DFT.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (I_D, A_A, R, delta_xc) in atomic units.\n    test_cases = [\n        # Test 1: General separated pair\n        (0.30, 0.08, 30.0, 0.12),\n        # Test 2: Very large separation\n        (0.30, 0.08, 200.0, 0.12),\n        # Test 3: Small fundamental gap\n        (0.20, 0.08, 25.0, 0.12),\n        # Test 4: Numerical balance point\n        (0.25, 0.05, 25.0/3.0, 0.12),\n    ]\n\n    results = []\n    for case in test_cases:\n        I_D, A_A, R, delta_xc = case\n        \n        # 1. Calculate the physically motivated charge-transfer energy, E_true.\n        # This is derived from E_true = I_D - A_A - 1/R.\n        E_true = I_D - A_A - 1.0/R\n        \n        # 2. Calculate the adiabatic semilocal GGA TD-DFT prediction, E_GGA.\n        # This is derived from E_GGA = I_D - A_A - delta_xc.\n        E_gga = I_D - A_A - delta_xc\n        \n        # 3. Calculate the signed error, delta_E.\n        # This is delta_E = E_GGA - E_true, which simplifies to 1/R - delta_xc.\n        delta_E = 1.0/R - delta_xc\n\n        # 4. Determine if the GGA prediction is spuriously low.\n        # This is true if E_GGA  E_true.\n        is_spurious = E_gga  E_true\n\n        # Append the four required results for this test case.\n        # Energies are rounded to six decimal places.\n        results.append(np.round(E_true, 6))\n        results.append(np.round(E_gga, 6))\n        results.append(np.round(delta_E, 6))\n        results.append(is_spurious)\n        \n    # Final print statement in the exact required format.\n    # The boolean `True`/`False` is converted to string \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2466214"}]}