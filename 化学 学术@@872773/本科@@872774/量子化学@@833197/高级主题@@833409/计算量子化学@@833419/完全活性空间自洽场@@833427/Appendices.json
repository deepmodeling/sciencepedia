{"hands_on_practices": [{"introduction": "要真正理解完整活性空间自洽场（CASSCF）方法的威力，我们需要亲自动手构建其核心要素。本练习将深入探讨 CAS(2,2) 活性空间，这是描述单个化学键断裂所需的最简化模型。通过手动计算在这种情况下可以产生的自旋匹配的电子组态数量，我们能够揭示多参考波函数的内在复杂性，并为更复杂的应用奠定坚实的基础。[@problem_id:1359559]", "problem": "在量子化学中，要准确描述化学键断裂或电子激发态等化学现象，通常需要超越单行列式的Hartree-Fock图像。全活性空间自洽场 (Complete Active Space Self-Consistent Field, CASSCF) 方法是为此类情况设计的一种基础的多组态方法。在CASSCF计算中，一部分被称为“活性”电子的电子，以所有可能的方式分布在相应的“活性”轨道子集中。\n\n考虑一个通用的CAS($M,N$)计算，其中$M$是活性电子数，$N$是活性轨道数。总波函数则构建为此活性空间内所有可能的组态态函数 (Configuration State Functions, CSFs) 的线性组合。一个CSF是Slater行列式的特定线性组合，并且是总自旋平方算符 $\\hat{S}^2$ 的纯本征函数。\n\n对于正确描述单个共价键（例如 $\\text{H}_2$ 或 $\\text{F}_2$ 中的键）解离这一典型问题，所需的最小活性空间包含成键的两个电子以及它们所占据的两个轨道（成键和反键分子轨道）。这对应于一个CAS(2,2)活性空间。\n\n你的任务是确定在一个CAS(2,2)活性空间内可以构建出的单重态 ($S=0$) 组态态函数的总数。", "solution": "在一个CAS(2,2)活性空间中，有两个空间轨道（记为$p$和$q$）和两个电子。相应的自旋轨道为$p\\alpha$、$p\\beta$、$q\\alpha$和$q\\beta$。从这四个自旋轨道可以形成的不同双电子Slater行列式的总数是二项式系数\n$$\n\\binom{4}{2}=6.\n$$\n一个明确的列表是\n$$\n|p\\alpha, p\\beta\\rangle,\\quad |q\\alpha, q\\beta\\rangle,\\quad |p\\alpha, q\\alpha\\rangle,\\quad |p\\beta, q\\beta\\rangle,\\quad |p\\alpha, q\\beta\\rangle,\\quad |p\\beta, q\\alpha\\rangle.\n$$\n组态态函数 (CSFs) 是 $\\hat{S}^{2}$ 的纯本征函数，由这些行列式线性组合而成（或在特殊情况下等于单个行列式）。\n\n1) 两个电子处于同一空间轨道的行列式必然是闭壳层单重态。因此，\n$$\n|p\\alpha, p\\beta\\rangle\\quad\\text{和}\\quad |q\\alpha, q\\beta\\rangle\n$$\n每一个都已经是自旋匹配的，且 $S=0$。这产生了两个线性无关的单重态CSF。\n\n2) 每个空间轨道中各有一个电子的行列式可以组合成自旋匹配的单重态和三重态函数。这种开壳层占据的单重态CSF是\n$$\n|S; M_{S}=0\\rangle=\\frac{1}{\\sqrt{2}}\\big(|p\\alpha, q\\beta\\rangle - |p\\beta, q\\alpha\\rangle\\big),\n$$\n它是一个纯的 $S=0$ 本征函数。剩余的独立组合构成了三重态流形：\n$$\n|T; M_{S}=+1\\rangle=|p\\alpha, q\\alpha\\rangle,\\quad\n|T; M_{S}=0\\rangle=\\frac{1}{\\sqrt{2}}\\big(|p\\alpha, q\\beta\\rangle + |p\\beta, q\\alpha\\rangle\\big),\\quad\n|T; M_{S}=-1\\rangle=|p\\beta, q\\beta\\rangle,\n$$\n它们的 $S$ 值均为1。\n\n将所有单重态CSF收集起来，有两个闭壳层单重态和一个开壳层单重态，总计为\n$$\n2+1=3\n$$\n个线性无关的CAS(2,2)单重态CSF。", "answer": "$$\\boxed{3}$$", "id": "1359559"}, {"introduction": "在实践中，选择一个“正确”的活性空间往往是一个需要反复尝试和优化的迭代过程。本练习介绍了一种关键的诊断工具——自然轨道占据数（Natural Orbital Occupation Numbers, NOONs），它是评估和改进活性空间选择的重要依据。通过分析一个假设的计算结果，你将学会如何解读这些占据数，从而判断哪些轨道对于描述静态相关至关重要，而哪些则可以为了提高计算效率而从活性空间中移除。[@problem_id:2452655]", "problem": "一名学生对一个处于平衡构型附近的闭壳层分子进行完全活性空间自洽场 (CASSCF) 计算。对活性空间内的一粒子约化密度矩阵 (RDM) 进行对角化，得到自然轨道及其占据数。根据定义，对于自旋求和的空间轨道，自然轨道占据数是一粒子约化密度矩阵的本征值，其值介于$[0, 2]$之间。在平均场参照中，始终双占据的轨道其占据数接近$2.0$，而始终未占据的轨道其占据数接近$0.0$。在多组态波函数中，对于描述静态（近简并）相关至关重要的轨道，其占据数通常会显著偏离这些极限值。\n\n假设在收敛的 CASSCF 解中，当前包含在活性空间中的一个轨道的占据数为$1.998$。关于该轨道在活性空间中的必要性，以下哪个陈述最能说明其含义？\n\nA. 该轨道的行为基本上是双占据的，因此可以将其重新分配到非活性（双占据）空间，而不会影响对静态相关的描述。\n\nB. 该轨道必须保留在活性空间中，因为任何不完全等于$2.000$的占据数都表示强静态相关。\n\nC. 该轨道应移至虚轨道空间，因为其占据数接近$0.000$。\n\nD. 来自一粒子约化密度矩阵的自然轨道占据数对于活性空间的选择没有提供信息，因此无法做出推断。", "solution": "必须首先对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- **方法：** 完全活性空间自洽场 (CASSCF) 计算。\n- **体系：** 处于平衡构型附近的闭壳层分子。\n- **过程：** 对活性空间内的一粒子约化密度矩阵 (RDM) 进行对角化。\n- **输出：** 自然轨道及其占据数。\n- **定义 1：** 对于自旋求和的空间轨道，自然轨道占据数是一粒子约化密度矩阵的本征值，取值范围在 $[0, 2]$ 内。\n- **定义 2：** 在平均场参照中，双占据轨道的占据数接近 $2$，未占据轨道的占据数接近 $0$。\n- **定义 3：** 对于多组态波函数，对静态相关至关重要的轨道，其占据数会“显著”偏离 $0$ 和 $2$。\n- **具体数据：** 一个活性空间轨道的收敛占据数为 $1.998$。\n- **问题：** 这对于该轨道被包含在活性空间中的必要性有何启示？\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题陈述的有效性进行评估。\n\n- **科学基础：** 该问题坚实地植根于多组态量子化学理论。CASSCF、一粒子约化密度矩阵、自然轨道及其占据数的解释都是标准的、公认的概念。所述的占据数范围 $[0, 2]$ 对于自旋求和的空间轨道是正确的。静态相关与占据数显著偏离整数值之间的联系是指导活性空间选择的基本原则。\n- **适定性：** 这是一个适定问题。它提供了一个标准计算程序得出的具体、定量的结果 ($1.998$)，并要求根据所提供的理论背景对其进行正确解释。可以得出一个唯一、明确的结论。\n- **客观性：** 问题以客观、科学的语言陈述。“显著”一词是该领域的标准定性语言，用以区分（指示静态相关的）显著偏差和（指示动态相关的）微小偏差。问题不含主观或非科学的主张。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它不包含任何使其无效的缺陷。我将继续进行解答。\n\n**求解推导**\n\n完全活性空间自洽场 (CASSCF) 计算的目的是为那些单一斯莱特行列式（即 Hartree-Fock 或 Kohn-Sham DFT 参照）不足以描述的体系提供一个定性正确的电子结构描述。这种情况源于前线轨道之间的近简并，导致所谓的**静态相关**。\n\n轨道空间被划分为三组：\n1.  **非活性（或核心）空间：** 假设这些轨道在构成总波函数的每个组态态函数 (CSF) 中都是双占据的。\n2.  **活性空间：** 通过将指定数量的活性电子分配到活性轨道中，构建所有可能的电子组态（与自旋和空间对称性一致）。活性空间内的这种完全组态相互作用旨在捕捉强的静态相关效应。\n3.  **虚（或外部）空间：** 假设这些轨道在每个 CSF 中都是未占据的。\n\n活性空间的选择是关键一步。理想的活性空间包括所有其占据数预计会显著偏离$2$（双占据）或$0$（未占据）的轨道。在 CASSCF 计算收敛后，作为一粒子约化密度矩阵本征值的自然轨道占据数 (NOONs) 成为评估所选活性空间质量的主要诊断工具。\n\n根据题意，活性空间内一个特定轨道的自然占据数为$1.998$。对于一个自旋求和的空间轨道，可能的最大占据数是$2.0$。占据数为$1.998$与此最大值仅相差$0.002$。这表明该轨道在构成总波函数权重$99.9\\%$的组态中是双占据的，只有极小部分贡献来自它被单占据或未占据的组态。\n\n这种与整数占据数（$2.0$或$0.0$）的微小偏离是**动态相关**的特征，而非静态相关。静态相关涉及组态的强混合，这将导致占据数显著远离整数值（例如，$1.9$、$1.5$、$1.0$、$0.5$、$0.1$）。\n\n由于活性空间是专门为处理静态相关而构建的，一个表现为几乎完全双占据的轨道在活性空间中是不必要的。将其包含在内会增加计算成本（通过增加 CI 展开的规模），而对计算的主要目标没有贡献。正确的做法是在后续计算中将该轨道重新分类为非活性（核心/双占据）轨道。与其相关的微小动态相关效应，通过后-CASSCF方法（如 CASPT2 或 NEVPT2）处理会更好、更有效。\n\n**逐项分析**\n\n**A. 该轨道的行为基本上是双占据的，因此可以将其重新分配到非活性（双占据）空间，而不会影响对静态相关的描述。**\n这个陈述是对结果的精确和正确的解释。占据数为 $1.998$ 表示，对于与静态相关相关的所有实际目的而言，该轨道是双占据的。将其移至非活性空间是优化活性空间、降低计算成本同时保留核心物理的标准程序。\n结论：**正确**。\n\n**B. 该轨道必须保留在活性空间中，因为任何不完全等于 $2.000$ 的占据数都表示强静态相关。**\n这个陈述是错误的。它代表了对静态相关和动态相关之间区别的根本性误解。在相关计算中，由于动态相关，所有轨道，即使是深层核心轨道，其占据数也会略小于 $2.000$。如果使用此标准，所有占据轨道都需要包含在活性空间中，这在计算上是不可能的，在概念上也是不正确的。活性空间是为那些占据数*显著*偏离整数值的轨道保留的。\n结论：**错误**。\n\n**C. 该轨道应移至虚轨道空间，因为其占据数接近 $0.000$。**\n这个陈述在事实上是错误的。给定的占据数是 $1.998$，接近 $2.000$。一个占据数接近 $0.000$（例如 $0.002$）的轨道才应被考虑放入虚（未占据）空间。此选项误解了所提供的数据。\n结论：**错误**。\n\n**D. 来自一粒子约化密度矩阵的自然轨道占据数对于活性空间的选择没有提供信息，因此无法做出推断。**\n这个陈述是明显错误的。分析自然轨道占据数可以说是验证和优化 CASSCF 计算中所选活性空间的最重要诊断工具。它直接揭示了哪些轨道具有强的多组态特性，哪些轨道的行为像简单的非活性或虚轨道。声称无法做出推断，就是否定了多组态理论和实践的基石。\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2452655"}, {"introduction": "CASSCF 方法的真正力量在于它能够准确描述势能面上的复杂区域，例如在化学键形成与断裂过程中发生的避免交叉（avoided crossing）。这个练习利用一个简化的双态模型来模拟氟化锂（$\\text{LiF}$）分子从共价态到离子态的转变。通过计算不同核间距下的绝热能级，你将亲眼见证多参考方法如何成功捕捉到单参考理论失效的关键物理现象。[@problem_id:2452667]", "problem": "考虑一个氟化锂的最小完整活性空间自洽场 (CASSCF) 模型，其中活性空间包含两个组态态函数：一个离子组态$\\lvert \\mathrm{Li}^{+}\\mathrm{F}^{-} \\rangle$和一个共价组态$\\lvert \\mathrm{Li} \\cdot \\mathrm{F} \\cdot \\rangle$。在这个双组态基中，核间距为$R$（单位为玻尔）的系统由一个对称的$2 \\times 2$哈密顿量$H(R)$表示，其对角线元素为非绝热（非耦合）能量，非对角线元素为态间耦合。非绝热能量由具有物理动机的函数形式给出（全文使用原子单位，能量单位为哈特里，$1 \\, \\text{E}_\\text{h}$，距离单位为玻尔）：\n- 共价非绝热能量$E_{\\mathrm{cov}}(R) = A_{\\mathrm{rep}} \\, e^{-b R} - \\frac{C_6}{R^6}$，其渐近值为$E_{\\mathrm{cov}}(\\infty) = 0$。\n- 离子非绝热能量$E_{\\mathrm{ion}}(R) = \\Delta - \\frac{1}{R} + A_{\\mathrm{ion}} \\, e^{-b_{\\mathrm{ion}} R}$，其中$\\Delta$是离子和共价渐近线之间的能量差，由锂的电离能和氟的电子亲和能之差决定，此处取$\\Delta = 0.0735 \\, \\text{E}_\\text{h}$。\n\n态间耦合被假定为随距离指数衰减，形式为$V(R) = V_0 \\, e^{-\\alpha R}$。在非绝热基$\\{\\lvert \\mathrm{cov} \\rangle, \\lvert \\mathrm{ion} \\rangle\\}$中，有效$2 \\times 2$哈密顿量为\n$$\nH(R) = \\begin{pmatrix}\nE_{\\mathrm{cov}}(R) & V(R) \\\\\nV(R) & E_{\\mathrm{ion}}(R)\n\\end{pmatrix}。\n$$\n\n使用以下参数值（原子单位）：\n- $A_{\\mathrm{rep}} = 5.0$, $b = 1.2$, $C_6 = 115.0$。\n- $A_{\\mathrm{ion}} = 5.0$, $b_{\\mathrm{ion}} = 1.2$。\n- $V_0 = 0.200$, $\\alpha = 0.300$。\n- $\\Delta = 0.0735$。\n\n对于下面测试集中的每个距离$R$，计算绝热能隙$\\Delta E_{\\mathrm{ad}}(R)$，其定义为$H(R)$的较高和较低本征值之差：\n$$\n\\Delta E_{\\mathrm{ad}}(R) = E_{\\mathrm{high}}(R) - E_{\\mathrm{low}}(R)。\n$$\n将每个$\\Delta E_{\\mathrm{ad}}(R)$以哈特里为单位表示，并四舍五入为保留六位小数的浮点数。\n\n测试集（距离单位必须解释为玻尔）：$R \\in \\{ 3.0, 8.0, 13.6, 20.0, 60.0 \\}$。\n\n您的程序必须按给定顺序为每个$R$计算$\\Delta E_{\\mathrm{ad}}(R)$，并生成一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如$[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$，其中每个$\\delta_i$是对应测试用例的四舍五入浮点值。所有输出都必须以哈特里为单位。", "solution": "在尝试任何解答之前，该问题都经过了验证。\n\n**步骤 1：提取给定信息**\n- **系统模型**：一个用于氟化锂的双态完整活性空间自洽场 (CASSCF) 模型。\n- **基态**：共价态 $|\\mathrm{cov} \\rangle$ 和离子态 $|\\mathrm{ion} \\rangle$。\n- **哈密顿量**：一个作为核间距 $R$ 函数的 $2 \\times 2$ 对称矩阵 $H(R)$。\n$$\nH(R) = \\begin{pmatrix} E_{\\mathrm{cov}}(R) & V(R) \\\\ V(R) & E_{\\mathrm{ion}}(R) \\end{pmatrix}\n$$\n- **非绝热能量**：\n  - 共价态：$E_{\\mathrm{cov}}(R) = A_{\\mathrm{rep}} \\, e^{-b R} - \\dfrac{C_6}{R^6}$\n  - 离子态：$E_{\\mathrm{ion}}(R) = \\Delta - \\dfrac{1}{R} + A_{\\mathrm{ion}} \\, e^{-b_{\\mathrm{ion}} R}$\n- **态间耦合**：$V(R) = V_0 \\, e^{-\\alpha R}$\n- **参数（原子单位）**：\n  - $A_{\\mathrm{rep}} = 5.0$\n  - $b = 1.2$\n  - $C_6 = 115.0$\n  - $A_{\\mathrm{ion}} = 5.0$\n  - $b_{\\mathrm{ion}} = 1.2$\n  - $V_0 = 0.200$\n  - $\\alpha = 0.300$\n  - $\\Delta = 0.0735$\n- **任务**：为 $R \\in \\{ 3.0, 8.0, 13.6, 20.0, 60.0 \\}$ 玻尔计算绝热能隙 $\\Delta E_{\\mathrm{ad}}(R) = E_{\\mathrm{high}}(R) - E_{\\mathrm{low}}(R)$。\n- **输出**：结果以哈特里为单位，四舍五入至六位小数，并采用特定的列表格式。\n\n**步骤 2：使用提取的信息进行验证**\n- **科学依据**：该问题描述了一个物理上真实的避免交叉双态模型，这是量子化学和分子物理学中的一个基本概念。势能函数采用标准的、具有物理动机的形式（Born-Mayer 排斥、库仑吸引、van der Waals 相互作用）。参数 $\\Delta$ 正确地反映了基于电离能和电子亲和能的渐近能量差。该问题在科学上是合理的。\n- **适定性**：任务是求一个 $2 \\times 2$ 实对称矩阵的本征值之差。对于任何物理分离距离 $R > 0$，矩阵元素都是定义明确的实数。这样的矩阵总是有两个实数本征值，它们的差是一个唯一、稳定且有意义的量。该问题是适定的。\n- **客观性**：该问题以精确、定量和明确的数学语言表述。它不含主观论断。\n- **完整性**：所有必需的函数、参数和常数均已提供。没有矛盾或缺失的定义。\n\n**步骤 3：结论与行动**\n该问题有效。这是一个来自计算化学领域的适定的、有科学依据的问题。将提供解答。\n\n**解题推导**\n目标是计算绝热能隙 $\\Delta E_{\\mathrm{ad}}(R)$，即给定的 $2 \\times 2$ 哈密顿矩阵 $H(R)$ 的本征值之差。绝热能量就是 $H(R)$ 的本征值。\n\n对于一个形如下式的一般 $2 \\times 2$ 实对称矩阵：\n$$\nM = \\begin{pmatrix} A & C \\\\ C & B \\end{pmatrix}\n$$\n其本征值 $\\lambda$ 是特征方程 $\\det(M - \\lambda I) = 0$ 的根：\n$$\n(A - \\lambda)(B - \\lambda) - C^2 = 0\n$$\n$$\n\\lambda^2 - (A+B)\\lambda + (AB - C^2) = 0\n$$\n使用二次公式，两个本征值为：\n$$\n\\lambda_{\\pm} = \\frac{(A+B) \\pm \\sqrt{(A+B)^2 - 4(AB - C^2)}}{2}\n$$\n化简平方根下的项：\n$$\n(A+B)^2 - 4AB + 4C^2 = A^2 + 2AB + B^2 - 4AB + 4C^2 = A^2 - 2AB + B^2 + 4C^2 = (A-B)^2 + 4C^2\n$$\n因此，本征值由下式给出：\n$$\n\\lambda_{\\pm} = \\frac{A+B}{2} \\pm \\frac{1}{2}\\sqrt{(A-B)^2 + 4C^2}\n$$\n较高的本征值为 $E_{\\mathrm{high}} = \\lambda_{+}$，较低的为 $E_{\\mathrm{low}} = \\lambda_{-}$。绝热能隙是这两个本征值之差：\n$$\n\\Delta E_{\\mathrm{ad}} = E_{\\mathrm{high}} - E_{\\mathrm{low}} = \\lambda_{+} - \\lambda_{-} = \\sqrt{(A-B)^2 + 4C^2}\n$$\n在我们问题的背景下，矩阵元素是核间距 $R$ 的函数：\n- $A = E_{\\mathrm{cov}}(R)$\n- $B = E_{\\mathrm{ion}}(R)$\n- $C = V(R)$\n\n将这些代入推导出的能隙公式，得到用于计算的表达式：\n$$\n\\Delta E_{\\mathrm{ad}}(R) = \\sqrt{(E_{\\mathrm{cov}}(R) - E_{\\mathrm{ion}}(R))^2 + 4V(R)^2}\n$$\n这个结果在二能级量子系统的研究中是基础性的。它表明，绝热态之间的能隙由两个因素决定：非绝热（非耦合）态的能量间隔 $|E_{\\mathrm{cov}}(R) - E_{\\mathrm{ion}}(R)|$，以及它们之间的耦合强度 $2|V(R)|$。最小能隙出现在非绝热交叉点附近，即 $E_{\\mathrm{cov}}(R) \\approx E_{\\mathrm{ion}}(R)$ 的地方，其值等于 $2|V(R)|$。\n\n因此，计算步骤如下：\n1. 使用给定参数定义函数 $E_{\\mathrm{cov}}(R)$、$E_{\\mathrm{ion}}(R)$ 和 $V(R)$。\n2. 对于测试集中的每个 $R$ 值，计算这三个函数的值。\n3. 将结果代入 $\\Delta E_{\\mathrm{ad}}(R)$ 的最终公式。\n4. 将最终结果四舍五入到要求的小数位数（六位）。\n\n此过程将在提供的代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic energy gap for a two-state model of LiF at\n    various internuclear separations.\n    \"\"\"\n\n    # Define the constants and parameters given in the problem statement (in atomic units).\n    A_rep = 5.0\n    b = 1.2\n    C6 = 115.0\n    A_ion = 5.0\n    b_ion = 1.2\n    V0 = 0.200\n    alpha = 0.300\n    delta = 0.0735\n\n    # Test suite of internuclear separations R in bohr.\n    test_cases_R = [3.0, 8.0, 13.6, 20.0, 60.0]\n\n    # List to store the results.\n    results = []\n\n    # Define the functions for the Hamiltonian matrix elements.\n    def e_cov(R):\n        \"\"\"Calculates the covalent diabatic energy E_cov(R).\"\"\"\n        return A_rep * np.exp(-b * R) - C6 / (R**6)\n\n    def e_ion(R):\n        \"\"\"Calculates the ionic diabatic energy E_ion(R).\"\"\"\n        return delta - 1.0/R + A_ion * np.exp(-b_ion * R)\n\n    def v_coupling(R):\n        \"\"\"Calculates the interstate coupling V(R).\"\"\"\n        return V0 * np.exp(-alpha * R)\n\n    # Loop through each test case.\n    for R in test_cases_R:\n        # Calculate the Hamiltonian matrix elements for the given R.\n        E_cov_val = e_cov(R)\n        E_ion_val = e_ion(R)\n        V_val = v_coupling(R)\n\n        # The adiabatic energy gap is given by sqrt((E_cov - E_ion)^2 + 4V^2).\n        # This is derived from finding the difference between the two eigenvalues\n        # of the 2x2 Hamiltonian matrix.\n        diabatic_energy_diff = E_cov_val - E_ion_val\n        adiabatic_gap = np.sqrt(diabatic_energy_diff**2 + 4 * V_val**2)\n\n        results.append(adiabatic_gap)\n\n    # Format the results as a string with each value rounded to six decimal places,\n    # then join them into a comma-separated list enclosed in square brackets.\n    # Using f-string formatting '{:.6f}' ensures rounding to 6 decimal places.\n    formatted_results = [f'{res:.6f}' for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "2452667"}]}