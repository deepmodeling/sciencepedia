{"hands_on_practices": [{"introduction": "为了确保我们对尺寸一致性 (size consistency) 和尺寸广延性 (size extensivity) 有扎实的理解，让我们从一个基础练习开始。这个思想实验 [@problem_id:1394925] 使用一个假设的量子化学方法，其能量由一个简单的解析表达式给出。通过将此表达式与尺寸一致性和尺寸广延性的严格定义进行比较，我们可以直接检验该方法是否满足这些关键性质，从而巩固我们对这些核心概念的把握。", "problem": "在量子化学中，一个理论方法的两个重要性质是尺寸一致性（size consistency）和尺寸广延性（size extensivity）。\n- **尺寸一致性**：对于任意两个无相互作用的子体系A和B，用该方法计算的超体系总能量必须等于分别计算的子体系能量之和，即 $E(A+B) = E(A) + E(B)$。\n- **尺寸广延性**：对于一个由 $N$ 个相同的、无相互作用的子体系构成的系统，其总能量必须精确等于单个子体系能量的 $N$ 倍，即 $E(N) = N \\times E(1)$。这个性质确保了能量作为广延量，随粒子数 $N$ 呈严格的线性标度。\n\n这两个性质密切相关，尺寸广延性通常被认为是尺寸一致性在N个相同粒子体系下的一个特例。\n\n考虑一个假设的量子化学方法，它被用于测试一个由$N$个无相互作用的氦原子组成的体系。该方法得出的体系总能量由以下表达式给出：\n$$E_{total}(N) = N E_{a} + c N^{2}$$\n其中$N$是氦原子的数量，$E_{a}$是一个代表主要单原子能量贡献的常数，而$c$是一个小的、非零的常数，代表该方法中的一个系统误差。\n\n根据所提供的定义，判断这个假设的方法是否是尺寸一致的和/或尺寸广延的。\n\n下列哪个陈述是正确的？\n\nA. 该方法是尺寸一致的，但不是尺寸广延的。\n\nB. 该方法是尺寸广延的，但不是尺寸一致的。\n\nC. 该方法既是尺寸一致的，也是尺寸广延的。\n\nD. 该方法既不是尺寸一致的，也不是尺寸广延的。\n\nE. 该方法是否尺寸一致或尺寸广延取决于$E_{a}$的值。", "solution": "我们得到一个方法，其对于$N$个无相互作用的相同子系统（氦原子）的总能量为\n$$\nE_{total}(N) = N E_{a} + c N^{2},\n$$\n其中 $c \\neq 0$。\n\n根据尺寸广延性的定义，对于$N$个相同且无相互作用的子系统，能量必须满足\n$$\nE(N) = N \\times E(1).\n$$\n首先，从给定方法计算$E(1)$：\n$$\nE(1) = E_{a}(1) + c(1)^2 = E_a + c.\n$$\n那么，尺寸广延性的要求意味着\n$$\nN \\times E(1) = N(E_{a} + c) = N E_{a} + c N.\n$$\n将此与该方法的预测结果相比较：\n$$\nE_{total}(N) = N E_{a} + c N^{2}.\n$$\n两者相等，当且仅当\n$$\nc N^{2} = c N \\quad \\Longleftrightarrow \\quad c N (N - 1) = 0.\n$$\n由于$c \\neq 0$且对于$N > 1$有$N(N-1) \\neq 0$，所以等式不成立。因此，该方法不是尺寸广延的。\n\n因为对于N个相同粒子的尺寸广延性是尺寸一致性的一个必要条件，所以该方法也不是尺寸一致的。我们可以通过考虑两个不同的系统A和B（分别有$N_A$和$N_B$个粒子）来直接验证这一点。该方法给出的能量为 $E(A) = N_A E_a + c N_A^2$ 和 $E(B) = N_B E_a + c N_B^2$。两个系统的总能量为 $E(A+B) = (N_A+N_B)E_a + c(N_A+N_B)^2$。\n尺寸一致性要求 $E(A+B) = E(A) + E(B)$。\n$ (N_A+N_B)E_a + c(N_A^2 + 2N_A N_B + N_B^2) = (N_A E_a + c N_A^2) + (N_B E_a + c N_B^2) $\n$ c(N_A^2 + 2N_A N_B + N_B^2) = cN_A^2 + cN_B^2 $\n$ 2cN_A N_B = 0 $\n因为 $c \\neq 0$，这只在 $N_A=0$ 或 $N_B=0$ 时成立。因此，该方法不是尺寸一致的。\n\n能量表达式中包含一个二次项$c N^{2}$，这违反了能量随粒子数 $N$ 线性标度的要求。因此，该方法也不是尺寸广延的。\n\n因此，正确的选项是该方法既不是尺寸一致的，也不是尺寸广延的。", "answer": "$$\\boxed{D}$$", "id": "1394925"}, {"introduction": "在理解了尺寸一致性的定义之后，下一个关键问题是：为什么像 CISD 这样一些广泛使用的方法会不满足这个性质？这个练习 [@problem_id:2805781] 通过一个简化的双组态模型，引导我们从第一性原理出发，通过线性代数推导，精确地揭示尺寸不一致性的理论根源。完成这个推导将让你深刻理解截断组态相互作用 (truncated Configuration Interaction) 方法中，由于忽略了某些激发（此处为四重激发）而导致能量非加和性的本质。", "problem": "考虑两个相同的、无限分离的、处于拉伸构型下的氢二聚体 $\\mathrm{H}_{2}^{(A)}$ 和 $\\mathrm{H}_{2}^{(B)}$。体系在玻恩-奥本海默近似（固定原子核）下处理，且每个单体使用最小基组。对每个单体，使用一个由限制性哈特里-福克 (RHF) 参考行列式 $\\lvert \\Phi_{0} \\rangle$ 和相应的双激发行列式 $\\lvert \\Phi_{2} \\rangle$ 构成的双组态自旋匹配模型空间。在 $\\lvert \\Phi_{2} \\rangle$ 中，电子对从成键空间轨道被提升到反键空间轨道。假设每个孤立单体满足以下条件：(i) 选择能量零点，使得 $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$；(ii) $\\lvert \\Phi_{2} \\rangle$ 的对角能量为 $\\Delta > 0$；(iii) 两个行列式之间的非对角耦合是一个实常数 $v \\neq 0$。因此，限制在 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 空间内的电子哈密顿量为\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0  v \\\\\nv  \\Delta\n\\end{pmatrix}.\n$$\n此处，单双激发组态相互作用 (CISD) 定义为：在使用变分原理的情况下，在由所考虑体系的 RHF 参考态的所有单激发和双激发所产生的行列式张成的空间内，对薛定谔方程的变分解。对于上述双行列式空间中的双电子单体，CISD 与完全组态相互作用是一致的。\n\n现在，构建一个哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$ 的复合、无相互作用的二聚体 $\\mathrm{H}_{2}^{(A)} + \\mathrm{H}_{2}^{(B)}$，并取二聚体的 CISD 模型空间由以下三个乘积行列式张成\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\n该空间忽略了非连线乘积 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$，因为相对于二聚体的 RHF 参考态，它是一个四重激发。假设单体之间严格无相互作用，因此不同单体上的激发之间没有耦合，并且除了单体贡献之和外没有额外的能量移动。\n\n仅使用变分原理、无相互作用子系统的可分离性以及线性代数，完成以下任务：\n- 推导单个单体的 CISD 基态能量 $E_{\\text{mono}}(\\Delta, v)$。\n- 在上述三行列式空间内，推导无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。\n- 将尺寸一致性误差定义为 $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$，并求出 $\\delta E_{\\text{CISD}}(\\Delta, v)$ 的闭式解析表达式。\n\n将最终答案表示为关于 $\\Delta$ 和 $v$ 的单一简化解析表达式。无需四舍五入。以符号形式保留答案，不要包含单位。", "solution": "问题陈述被认为是有效的，因为它具有科学依据、是适定的且客观的。它提出了理论化学中用于分析尺寸一致性的一个标准模型。我们现在开始解答。\n\n该问题要求通过一个分三部分的推导，来找出简化的单双激发组态相互作用 (CISD) 模型的尺寸一致性误差。\n\n首先，我们确定单个单体的基态能量 $E_{\\text{mono}}(\\Delta, v)$。在指定的 2 行列式基 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 内，单体的电子哈密顿量由下式给出：\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0  v \\\\ v  \\Delta \\end{pmatrix}\n$$\n能量本征值通过求解久期方程 $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$ 得到，其中 $\\mathbf{I}$ 是 2 维单位矩阵。\n$$\n\\det \\begin{pmatrix} -E  v \\\\ v  \\Delta - E \\end{pmatrix} = 0\n$$\n这导出了特征多项式：\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\n这是一个关于能量 $E$ 的二次方程。应用二次公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中系数为 $a = 1$, $b = -\\Delta$ 和 $c = -v^2$，我们得到两个能量本征值：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n基态能量是这两个本征值中较低的一个。考虑到 $\\Delta > 0$ 且 $v \\neq 0$，项 $\\sqrt{\\Delta^2 + 4v^2}$ 严格大于 $\\Delta$。因此，最低的能量本征值对应于负号。此能量即为单体的 CISD 能量，在这个双态模型中，它与完全组态相互作用 (FCI) 能量相同。\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\n其次，我们确定无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。二聚体的哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$。二聚体的 CISD 模型空间由 3 个基函数 $\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$ 张成。我们必须在此基中构建哈密顿矩阵 $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$。矩阵元为 $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$。利用单体基态的性质和无相互作用假设：\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$。\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$。\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$。\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$。\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$。\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$，因为哈密顿量仅耦合同一单体内的状态。\n由此得到的厄米矩阵为：\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0  v  v \\\\ v  \\Delta  0 \\\\ v  0  \\Delta \\end{pmatrix}\n$$\n为了求出本征值 $E$，我们求解特征方程 $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$：\n$$\n\\det \\begin{pmatrix} -E  v  v \\\\ v  \\Delta - E  0 \\\\ v  0  \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - v(v(\\Delta-E)) - v(-v(\\Delta-E)) = 0\n$$\n$$\n-E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\n该方程产生两种可能性：\n1. $\\Delta - E = 0 \\implies E = \\Delta$。\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$。\n第二种情况是一个二次方程，其解为：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n因此，三个本征值为 $\\Delta$、$\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$ 和 $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$。基态能量是这些值中最低的一个。由于 $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$，最低的本征值为：\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\n第三，我们计算尺寸一致性误差 $\\delta E_{\\text{CISD}}(\\Delta, v)$，其定义为二聚体能量与两倍单体能量之差。\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\n代入上面推导出的表达式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n这个表达式可以重新整理成一个更具结构化的形式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n这就是尺寸一致性误差的最终闭式表达式。由于 $v \\neq 0$，该误差通常不为零，这表明截断的 CISD 方法不具有尺寸一致性。这个缺陷源于从二聚体的模型空间中省略了非连线的四重激发组态 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$。", "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$", "id": "2805781"}, {"introduction": "理论的价值最终体现在其对真实计算的指导意义上。最后的这个动手实践 [@problem_id:2805718] 将我们带入计算化学家的日常工作，通过分析一系列模拟的 $(\\text{H}_2\\text{O})_N$ 团簇的能量数据，来诊断不同量子化学方法（如 HF, MP2, CCSD 和 CISD）的尺寸广延性。你将通过编写程序实现几种标准的数值诊断方法，例如线性拟合和曲率分析，从而亲手验证哪些方法是尺寸广延的，哪些不是，并将抽象的理论概念与具体的计算结果联系起来。", "problem": "您接到的任务是为无相互作用的水分子设计一个片段加成标度研究，用以在高等研究生理论化学的层面上，探究尺寸一致性与尺寸广延性的概念。其基本出发点是无相互作用片段的非相对论电子能量的可加性：对于一个由 $N$ 个无相互作用的相同子系统组成的体系，其哈密顿量是可分离的，即 $\\hat{H} = \\sum_{k=1}^{N} \\hat{H}_k$，且精确的基态能量是可加的，即 $E(N) = \\sum_{k=1}^{N} E_k = N E(1)$。如果一种方法对于无相互作用的相同子系统能够保持 $E(N) = N E(1)$，那么该方法就是尺寸广延的；等价地，当外推至 $N=0$ 时，总能量随 $N$ 线性变化且截距为零。对这种线性关系的偏离程度可用于量化尺寸广延性的失效情况。\n\n编写一个完整、可运行的程序，通过对无相互作用的 $(\\mathrm{H_2O})_N$ 团簇的 $E(N)$ 数据应用最小二乘线性分析和曲率诊断，来实现对尺寸广延性的定量诊断。该程序必须：\n\n- 使用以下按方法标记的数据集测试套件。每个数据集包含 $N=1,2,3,4,5,6$ 时的能量 $E(N)$（单位为哈特里），这些能量是在相互作用消失的极大间距下计算的。这四种方法分别是：哈特里-福克（HF）、二阶莫勒-普勒塞特微扰理论（MP2）、包含单、双激发的耦合簇理论（CCSD）以及包含单、双激发的组态相互作用（CISD）。数据数组如下：\n  - HF: $[-76.0260,-152.0520,-228.0780,-304.1040,-380.1300,-456.1560]$\n  - MP2: $[-76.3000,-152.6000,-228.9000,-305.2000,-381.5000,-457.8000]$\n  - CCSD: $[-76.3500,-152.7000,-229.0500,-305.4000,-381.7500,-458.1000]$\n  - CISD: $[-76.3200,-152.6399,-228.9597,-305.2794,-381.5990,-457.9185]$\n- 对每种方法，计算以下诊断指标：\n  1. 通过原点约束的最佳拟合斜率 $s_0$，它通过最小化 $\\sum_{i=1}^{M} \\left(E(N_i)-s N_i\\right)^2$（其中 $N_i \\in \\{1,2,3,4,5,6\\}$）来定义。其闭式表达式为 $s_0 = \\dfrac{\\sum_i N_i E(N_i)}{\\sum_i N_i^2}$。报告 $s_0$（单位为哈特里）。\n  2. 求解 $E(N) \\approx s N + b$ 的无约束最小二乘线性拟合参数 $(s,b)$。报告截距 $b$（单位为哈特里）。\n  3. 约束拟合的均方根偏差 $\\mathrm{RMSD}_0 = \\sqrt{\\dfrac{1}{M}\\sum_i \\left(E(N_i)-s_0 N_i\\right)^2}$（单位为哈特里）。\n  4. 最大绝对二阶有限差分（一种离散曲率诊断），$\\max_{i=2,3,4,5} \\left|E(N_{i+1}) - 2 E(N_i) + E(N_{i-1})\\right|$（单位为哈特里）。\n  5. 相对于 $E(1)$ 定义的最大绝对尺寸广延性误差，$\\max_{i} \\left|E(N_i) - N_i E(1)\\right|$（单位为哈特里）。\n- 当且仅当以下三个条件同时满足时，将每种方法分类为在严格数值容差内通过尺寸广延性测试：$\\left|b\\right| \\le \\tau_b$、$\\max\\left|\\Delta^2 E\\right| \\le \\tau_c$ 和 $\\max\\left|E(N)-N E(1)\\right| \\le \\tau_\\varepsilon$。其中容差为 $\\tau_b = 10^{-8}$ 哈特里、$\\tau_c = 10^{-8}$ 哈特里和 $\\tau_\\varepsilon = 10^{-8}$ 哈特里。\n\n您的程序应生成单行输出，其中包含一个JSON数组的数组形式的结果，每个内部数组的格式为 $[m, s_0, b, \\mathrm{RMSD}_0, \\max\\left|\\Delta^2 E\\right|, \\max\\left|E(N)-N E(1)\\right|, \\mathrm{pass}]$。其中 $m$ 是整数方法索引，映射关系为：HF为 $m=0$，MP2为 $m=1$，CCSD为 $m=2$，CISD为 $m=3$；$s_0$、$b$、$\\mathrm{RMSD}_0$、$\\max\\left|\\Delta^2 E\\right|$ 和 $\\max\\left|E(N)-N E(1)\\right|$ 是单位为哈特里的浮点数；$\\mathrm{pass}$ 是一个布尔值。输出必须打印为单行，不含任何附加文本。所有浮点数都应解释为哈特里单位，数字旁边不应打印任何单位。\n\n测试套件覆盖要求：\n- HF、MP2 和 CCSD 数据集代表了理想情况，其中严格的尺寸广延性应被精确满足，从而产生线性标度 $E(N)=N E(1)$、零截距、零曲率和零偏差。\n- CISD 数据集编码了一个受控的二次偏差，以模拟缺乏非连接激发的情况，这导致了次线性的相关标度以及 $E(N)$ 中的正曲率；它必须不能满足上述容差。\n\n角度单位不适用。不使用百分比；如果需要，任何比率都必须以小数形式返回，但本问题不要求计算比率。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上植根于量子化学的原理，特别是尺寸广延性和尺寸一致性的概念。该问题定义明确，提供了所有必要的数据、所需诊断的明确数学公式以及清晰的分类标准。为哈特里-福克（$HF$）、莫勒-普勒塞特微扰理论（$MP2$）、包含单、双激发的耦合簇理论（$CCSD$）和包含单、双激发的组态相互作用（$CISD$）方法提供的能量数据集与已建立的理论知识一致：$HF$、$MP2$ 和 $CCSD$ 是尺寸广延的方法，而 $CISD$ 不是。任务是实现一个数值分析，以验证给定数据的这一性质。\n\n所要考察的核心原理是尺寸广延性。如果一个理论方法计算的、由 $N$ 个无相互作用的相同子系统组成的体系的能量 $E(N)$ 随 $N$ 线性变化，则该方法是尺寸广延的。在数学上，这表示为 $E(N) = N \\times E(1)$，其中 $E(1)$ 是单个子系统的能量。任何对这种严格线性关系的偏离都表明尺寸广延性的失效，这是量子化学模型中的一个严重缺陷，因为它会导致较大体系出现不符合物理规律的能量标度。\n\n程序将对四种指定方法中的每一种，分析所提供的能量数据 $E(N)$（其中 $N \\in \\{1, 2, 3, 4, 5, 6\\}$）。对于每种方法，将计算以下五个定量诊断指标，以探究与线性标度的偏差。\n\n1.  约束线性拟合：将一个约束通过原点的线性模型 $E(N) = s_0 N$ 拟合到数据。最优斜率 $s_0$ 由最小二乘公式 $s_0 = \\frac{\\sum_{i=1}^{M} N_i E(N_i)}{\\sum_{i=1}^{M} N_i^2}$ 给出，其中 $M=6$ 是数据点的数量。对于尺寸广延的方法，该斜率 $s_0$ 应等于单体能量 $E(1)$。\n\n2.  无约束线性拟合：将一个通用线性模型 $E(N) = sN + b$ 拟合到数据。截距 $b$ 直接度量了在 $N=0$ 个片段的理论极限下的误差。对于一个完全尺寸广延的方法，数据必须位于一条通过原点的直线上，因此截距 $b$ 必须为零。\n\n3.  约束均方根偏差（$\\mathrm{RMSD}_0$）：约束拟合的质量通过均方根偏差来量化，定义为 $\\mathrm{RMSD}_0 = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} (E(N_i) - s_0 N_i)^2}$。该指标捕捉了偏离“通过原点的完美线性关系”的总体幅度。\n\n4.  曲率诊断：能量的二阶有限差分 $\\Delta^2 E_i = E(N_{i+1}) - 2E(N_i) + E(N_{i-1})$，可作为二阶导数 $\\frac{d^2E}{dN^2}$ 的离散模拟。线性函数的二阶导数为零。我们在适用的索引范围内计算该量的最大绝对值 $\\max |\\Delta^2 E|$。非零值表示能量标度是非线性的，即具有曲率。\n\n5.  直接尺寸广延性误差：对尺寸广延性最直接的测试是为每个数据点计算误差 $\\delta_i = E(N_i) - N_i E(1)$，并找出最大绝对误差 $\\max_i |\\delta_i|$。对于尺寸广延的方法，该误差对所有 $N_i$ 都必须为零。\n\n当且仅当一种方法能同时通过三项针对严格数值容差的检查时，才被分类为尺寸广延的：无约束截距的绝对值 $|b|$ 必须小于或等于 $\\tau_b = 10^{-8}$ 哈特里，最大曲率 $\\max|\\Delta^2 E|$ 必须小于或等于 $\\tau_c = 10^{-8}$ 哈特里，以及最大直接广延性误差 $\\max|E(N)-N E(1)|$ 必须小于或等于 $\\tau_\\varepsilon = 10^{-8}$ 哈特里。\n\n该实现将使用 Python 完成，并利用 `numpy` 库进行高效的基于数组的数值计算。将设计一个单一函数来处理每种方法的能量数据，计算五个诊断指标并应用分类逻辑。该函数将迭代应用于所有四个数据集。最终结果，包括方法索引 $m$（$HF$ 为 $0$，$MP2$ 为 $1$，$CCSD$ 为 $2$，$CISD$ 为 $3$）、五个计算出的诊断值和一个布尔 `pass` 标志，将按照问题中指定的格式，格式化为符合JSON标准的数组的数组，并打印到标准输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport json\n\ndef solve():\n    \"\"\"\n    Performs a size-extensivity analysis on quantum chemistry energy data.\n    \"\"\"\n    # Define the datasets for each method as specified in the problem.\n    # The structure is a list of tuples, where each tuple contains:\n    # (method_index, numpy_array_of_energies_in_Hartree)\n    test_cases = [\n        (0, np.array([-76.0260, -152.0520, -228.0780, -304.1040, -380.1300, -456.1560])), # HF\n        (1, np.array([-76.3000, -152.6000, -228.9000, -305.2000, -381.5000, -457.8000])), # MP2\n        (2, np.array([-76.3500, -152.7000, -229.0500, -305.4000, -381.7500, -458.1000])), # CCSD\n        (3, np.array([-76.3200, -152.6399, -228.9597, -305.2794, -381.5990, -457.9185]))  # CISD\n    ]\n\n    # Define the vector of system sizes N and its length M.\n    N_values = np.arange(1, 7, dtype=float)\n    M = len(N_values)\n    \n    # Define the tolerances for the classification.\n    tau_b = 1.0e-8  # Tolerance for the intercept\n    tau_c = 1.0e-8  # Tolerance for the curvature\n    tau_e = 1.0e-8  # Tolerance for the extensivity error\n\n    all_results = []\n\n    for m, E_values in test_cases:\n        # Diagnostic 1: Best-fit slope constrained through the origin, s_0\n        s0 = np.sum(N_values * E_values) / np.sum(N_values**2)\n\n        # Diagnostic 2: Unconstrained least-squares fit E = s*N + b\n        A = np.vstack([N_values, np.ones(M)]).T\n        s, b = np.linalg.lstsq(A, E_values, rcond=None)[0]\n\n        # Diagnostic 3: Root-mean-square deviation for the constrained fit, RMSD_0\n        residuals_0 = E_values - s0 * N_values\n        rmsd0 = np.sqrt(np.mean(residuals_0**2))\n\n        # Diagnostic 4: Maximum absolute second finite difference (curvature)\n        # Note: problem states max over i=2,3,4,5 for E(i+1)-2E(i)+E(i-1)\n        # This corresponds to all elements of np.diff(E_values, n=2)\n        second_diffs = np.diff(E_values, n=2)\n        max_curvature = np.max(np.abs(second_diffs)) if len(second_diffs) > 0 else 0.0\n\n        # Diagnostic 5: Maximum absolute size-extensivity error relative to E(1)\n        E1 = E_values[0]\n        extensivity_errors = np.abs(E_values - N_values * E1)\n        max_extensivity_error = np.max(extensivity_errors)\n\n        # Classification: Check if the method passes the size-extensivity test\n        is_pass = (np.abs(b) = tau_b) and \\\n                  (max_curvature = tau_c) and \\\n                  (max_extensivity_error = tau_e)\n        \n        # Store results for this method\n        result = [m, s0, b, rmsd0, max_curvature, max_extensivity_error, is_pass]\n        all_results.append(result)\n\n    # Use json.dumps for robust, clean formatting of the final output.\n    # This avoids manual string construction and handles boolean/float types correctly.\n    print(json.dumps(all_results, separators=(',', ':')))\n\nsolve()\n```", "id": "2805718"}]}