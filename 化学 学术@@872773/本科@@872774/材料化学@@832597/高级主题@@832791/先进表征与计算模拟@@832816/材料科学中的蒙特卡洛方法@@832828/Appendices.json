{"hands_on_practices": [{"introduction": "原子扩散是材料科学中的一个基本过程，控制着从相变到合金化的许多现象。蒙特卡洛方法通过将原子的随机热运动建模为晶格上的“随机行走”，为我们提供了一个强大的工具来模拟这一过程。这个练习将指导您逐步执行一个基础的动力学蒙特卡洛模拟，通过将一系列伪随机数转化为原子跃迁事件，从而追踪间隙原子在晶格中的扩散路径，直到它被一个空位湮灭。[@problem_id:1318228]", "problem": "在材料科学中，原子的扩散可以使用蒙特卡洛方法进行建模。考虑一个简化的模型，其中一个间隙原子在二维晶格中扩散，直到被一个空位湮灭。\n\n系统是一个大小为 $5 \\times 5$ 的二维方格晶格，其中格点坐标 $(x, y)$ 是整数，满足 $x, y \\in \\{0, 1, 2, 3, 4\\}$。一个固定的空位位于格点 $V = (3, 1)$。一个可移动的间隙原子初始位于格点 $I_0 = (1, 3)$。\n\n原子的运动以离散时间步长进行模拟。在每一步中，从区间 $[0, 1)$ 上的均匀分布中抽取一个伪随机数 $r$。这个数字根据以下规则决定原子尝试跳跃到相邻格点的方向：\n- 如果 $0 \\le r  0.25$，原子尝试向右移动（到 $(x+1, y)$）。\n- 如果 $0.25 \\le r  0.50$，原子尝试向上移动（到 $(x, y+1)$）。\n- 如果 $0.50 \\le r  0.75$，原子尝试向左移动（到 $(x-1, y)$）。\n- 如果 $0.75 \\le r  1.00$，原子尝试向下移动（到 $(x, y-1)$）。\n\n晶格具有刚性边界。如果尝试的移动会将原子置于 $5 \\times 5$ 网格之外的坐标（即 $x$ 或 $y$ 坐标小于 0 或大于 4），则该步原子不移动；它停留在当前位置。\n\n当间隙原子的坐标与空位的坐标相同时，模拟结束，此时认为两者已湮灭。\n\n给定前 12 步的伪随机数序列如下：\n$0.31, 0.82, 0.15, 0.55, 0.09, 0.41, 0.99, 0.68, 0.20, 0.77, 0.11, 0.80$\n\n确定间隙原子在空位处湮灭所需的总步数。以一个表示总步数的整数形式给出你的答案。", "solution": "我们有一个 $5 \\times 5$ 的晶格，其格点坐标 $(x,y)$ 满足 $x,y \\in \\{0,1,2,3,4\\}$。空位固定在 $V=(3,1)$，间隙原子从 $I_{0}=(1,3)$ 开始。在每个离散步骤中，一个伪随机数 $r \\in [0,1)$ 根据以下规则决定尝试的移动：$r \\in [0,0.25)$ 对应向右 $(x,y)\\to(x+1,y)$，$r \\in [0.25,0.50)$ 对应向上 $(x,y)\\to(x,y+1)$，$r \\in [0.50,0.75)$ 对应向左 $(x,y)\\to(x-1,y)$，$r \\in [0.75,1.00)$ 对应向下 $(x,y)\\to(x,y-1)$。边界是刚性的：如果提议的移动产生一个在 $\\{0,1,2,3,4\\}$ 之外的坐标，原子将停留在其当前位置。当间隙原子到达 $V$ 时，模拟结束。\n\n使用给定的 $r$ 值序列，并在每一步应用移动规则并进行边界检查：\n\n第 $1$ 步：$r=0.31 \\in [0.25,0.50)$，向上，尝试 $(1,3)\\to(1,4)$ 在网格内，所以 $I_{1}=(1,4)$。\n\n第 $2$ 步：$r=0.82 \\in [0.75,1.00)$，向下，$(1,4)\\to(1,3)$ 有效，所以 $I_{2}=(1,3)$。\n\n第 $3$ 步：$r=0.15 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，所以 $I_{3}=(2,3)$。\n\n第 $4$ 步：$r=0.55 \\in [0.50,0.75)$，向左，$(2,3)\\to(1,3)$ 有效，所以 $I_{4}=(1,3)$。\n\n第 $5$ 步：$r=0.09 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，所以 $I_{5}=(2,3)$。\n\n第 $6$ 步：$r=0.41 \\in [0.25,0.50)$，向上，$(2,3)\\to(2,4)$ 有效，所以 $I_{6}=(2,4)$。\n\n第 $7$ 步：$r=0.99 \\in [0.75,1.00)$，向下，$(2,4)\\to(2,3)$ 有效，所以 $I_{7}=(2,3)$。\n\n第 $8$ 步：$r=0.68 \\in [0.50,0.75)$，向左，$(2,3)\\to(1,3)$ 有效，所以 $I_{8}=(1,3)$。\n\n第 $9$ 步：$r=0.20 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，所以 $I_{9}=(2,3)$。\n\n第 $10$ 步：$r=0.77 \\in [0.75,1.00)$，向下，$(2,3)\\to(2,2)$ 有效，所以 $I_{10}=(2,2)$。\n\n第 $11$ 步：$r=0.11 \\in [0,0.25)$，向右，$(2,2)\\to(3,2)$ 有效，所以 $I_{11}=(3,2)$。\n\n第 $12$ 步：$r=0.80 \\in [0.75,1.00)$，向下，$(3,2)\\to(3,1)$ 有效，所以 $I_{12}=(3,1)=V$；湮灭发生在第 $12$ 步结束时。\n\n因此，所需的总步数是 $12$。", "answer": "$$\\boxed{12}$$", "id": "1318228"}, {"introduction": "高分子材料的宏观性质，如粘度、弹性和扩散系数，都深刻地根植于其微观链构象。蒙特卡洛模拟通过执行一系列随机的“移动”（如链端旋转或扭转）来探索聚合物链可能存在的巨大构象空间。本练习将演示如何模拟聚合物链构象的变化，并计算一个关键的结构参数——回转半径（$R_g$），同时还将展示物理约束（例如在纳米通道中的限制）如何显著影响聚合物的行为。[@problem_id:1318246]", "problem": "一个简化的聚合物链模型在晶格间距为1个单位的二维方格晶格上进行模拟。该聚合物表示为一个由$N=5$个相连单体组成的自回避链。聚合物的构象可以通过其均方回转半径$R_g^2$来表征，其定义为：\n$$R_g^2 = \\frac{1}{N} \\sum_{i=1}^{N} ||\\vec{r}_i - \\vec{R}_{cm}||^2$$\n其中$\\vec{r}_i$是第$i$个单体的位置向量，而$\\vec{R}_{cm} = \\frac{1}{N} \\sum_{i=1}^{N} \\vec{r}_i$是链的质心。\n\n最初，五个标记为$M_1$到$M_5$的单体排列成一条直线，坐标为：$M_1=(0,0)$，$M_2=(1,0)$，$M_3=(2,0)$，$M_4=(3,0)$和$M_5=(4,0)$。\n\n链的构型使用蒙特卡洛（MC）算法进行更新，该算法涉及一系列“末端枢轴”移动。末端枢轴移动包括选择链末端的两个单体之一，并尝试将其移动到一个新的晶格位置。只有当目标位置与该单体的唯一邻居相邻（非对角线）且未被链中任何其他单体占据时，移动才算成功。\n\n我们将通过尝试相同的三个移动序列，来比较聚合物在两种不同环境中的行为：\n1. 尝试将末端单体 $M_1$ 移动到新位置 $(1,1)$。\n2. 尝试将末端单体 $M_5$ 移动到新位置 $(3,1)$。\n3. 尝试将末端单体 $M_1$ 移动到新位置 $(0,0)$。\n\n**场景 A（无限制）：** 聚合物处于一个开放的、无限的二维空间中。\n**场景 B（受限）：** 聚合物处于一个由位于$y=0.5$和$y=-0.5$的两堵不可穿透的水平壁定义的纳米通道中。这种限制规定所有单体的y坐标在任何时候都必须恰好为0。任何试图将单体放置在$y \\neq 0$位置的移动都将被拒绝。\n\n设$R_{g, \\text{unconfined}}^2$为场景A中的最终均方回转半径，$R_{g, \\text{confined}}^2$为场景B中的最终均方回转半径。计算比率$\\frac{R_{g, \\text{unconfined}}^2}{R_{g, \\text{confined}}^2}$。将您的最终答案四舍五入到两位有效数字。", "solution": "我们使用均方回转半径的定义，\n$$R_{g}^{2}=\\frac{1}{N}\\sum_{i=1}^{N}\\|\\vec{r}_{i}-\\vec{R}_{cm}\\|^{2},\\quad \\vec{R}_{cm}=\\frac{1}{N}\\sum_{i=1}^{N}\\vec{r}_{i},$$\n其中$N=5$。\n\n初始链坐标为$M_{1}=(0,0)$，$M_{2}=(1,0)$，$M_{3}=(2,0)$，$M_{4}=(3,0)$，$M_{5}=(4,0)$。\n\n末端枢轴移动规则：末端单体可以移动到目标位置，当且仅当(i)目标位置与其唯一邻居相邻（曼哈顿距离为1），且(ii)目标位置未被任何其他单体占据。在受限场景中，一个额外的约束要求所有单体的$y=0$；任何目标$y\\neq 0$的移动都将被拒绝。\n\n场景 A（无限制）：\n1) 将$M_{1}$移动到$(1,1)$：目标位置与$M_{2}=(1,0)$相邻且未被占据，因此接受。新位置：$M_{1}$到$M_{5}$分别为$(1,1),(1,0),(2,0),(3,0),(4,0)$。\n2) 将$M_{5}$移动到$(3,1)$：目标位置与$M_{4}=(3,0)$相邻且未被占据，因此接受。新位置：$M_{1}=(1,1)$，$M_{2}=(1,0)$，$M_{3}=(2,0)$，$M_{4}=(3,0)$，$M_{5}=(3,1)$。\n3) 将起始位置为$(0,0)$的末端单体（即$M_{1}$）移动到$(0,0)$：目标位置与$M_{2}=(1,0)$相邻且未被占据，因此接受。最终位置：\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(3,1)。$$\n计算$\\vec{R}_{cm}$：\n$$\\vec{R}_{cm}=\\frac{1}{5}\\big((0+1+2+3+3),(0+0+0+0+1)\\big)=\\left(\\frac{9}{5},\\frac{1}{5}\\right)。$$\n计算平方距离之和：\n- 对于 $(0,0)$: $\\left(-\\frac{9}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{82}{25}$。\n- 对于 $(1,0)$: $\\left(-\\frac{4}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{17}{25}$。\n- 对于 $(2,0)$: $\\left(\\frac{1}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{2}{25}$。\n- 对于 $(3,0)$: $\\left(\\frac{6}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{37}{25}$。\n- 对于 $(3,1)$: $\\left(\\frac{6}{5}\\right)^{2}+\\left(\\frac{4}{5}\\right)^{2}=\\frac{52}{25}$。\n总和 $=\\frac{82+17+2+37+52}{25}=\\frac{190}{25}=\\frac{38}{5}$。因此\n$$R_{g,\\text{unconfined}}^{2}=\\frac{1}{5}\\cdot\\frac{190}{25}=\\frac{38}{25}。$$\n\n场景 B（受限：要求$y=0$）：\n1) 将$M_{1}$移动到$(1,1)$：因目标位置$y\\neq 0$而被拒绝。\n2) 将$M_{5}$移动到$(3,1)$：因目标位置$y\\neq 0$而被拒绝。\n3) 将起始位置为$(0,0)$的末端单体移动到$(0,0)$：这不会产生任何变化；最终位置保持不变\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(4,0)。$$\n计算$\\vec{R}_{cm}=(2,0)$以及平方距离之和：\n$4+1+0+1+4=10$。因此\n$$R_{g,\\text{confined}}^{2}=\\frac{1}{5}\\cdot 10=2。$$\n\n因此，所求比率为\n$$\\frac{R_{g,\\text{unconfined}}^{2}}{R_{g,\\text{confined}}^{2}}=\\frac{\\frac{38}{25}}{2}=\\frac{19}{25}=0.76。$$\n四舍五入到两位有效数字，结果是$0.76$。", "answer": "$$\\boxed{0.76}$$", "id": "1318246"}, {"introduction": "设计具有特定性能的新材料是材料科学的核心挑战之一，而计算模拟在其中扮演着日益重要的角色。Metropolis 蒙特卡洛算法是模拟退火等优化技术的基础，它通过巧妙地探索系统的能量“景观”，为寻找低能量（即更稳定或更优）的原子构型提供了一种有效途径。这个更具挑战性的练习将让您应用 Metropolis 判据来解决一个材料设计问题，展示蒙特卡洛方法如何通过接受概率性地增加能量的“坏”移动，来避免陷入局部最优解，从而找到全局最优的材料微观结构。[@problem_id:1318218]", "problem": "为了设计一种具有接近零热膨胀系数的复合超材料，一位计算材料科学家采用了一种模拟退火策略。该材料被建模为一个具有周期性边界条件的二维 `4 x 4` 方格晶格。晶格上的每个位置被两种相中的一种占据：A相具有正热膨胀系数，B相具有负热膨胀系数。系统中恰好有8个A相位置和8个B相位置。\n\n一个简化模型被用来近似给定微观排布下的总内应变能 `H`。这个能量函数旨在惩罚作为热失配应变来源的局部相不平衡。总能量是晶格上所有16个唯一的 `2 x 2` 小方块（或四个相邻位置组成的块）贡献的总和。单个小方块 `p` 的能量 `H_p` 由下式给出：\n$$H_p = C \\left( n_A(p) - n_B(p) \\right)^2$$\n其中 `n_A(p)` 和 `n_B(p)` 分别是该小方块内A和B位置的数量。总能量为 `H = \\sum_{p} H_p`。常数 `C` 给定为 `1.0 J`。\n\n系统当前处于由以下构型定义的状态（行和列使用从0开始的索引，其中 `(0,0)` 是左上角的位置）：\n$$\n\\begin{pmatrix}\n\\text{A}  \\text{A}  \\text{B}  \\text{B} \\\\\n\\text{A}  \\text{B}  \\text{B}  \\text{B} \\\\\n\\text{B}  \\text{A}  \\text{A}  \\text{A} \\\\\n\\text{B}  \\text{B}  \\text{A}  \\text{A}\n\\end{pmatrix}\n$$\n在温度 `T` 下（此时热能为 `k_B T = 8.0 J`，`k_B` 是玻尔兹曼常数），尝试进行一次Metropolis蒙特卡洛移动。提议的移动是交换位置 `(1, 1)` 和位置 `(2, 1)` 处的相。为了决定是否接受此移动，从 `[0, 1)` 上的均匀分布中抽取一个随机数 `r = 0.10`。\n\n计算在尝试了这一次蒙特卡洛步骤*之后*材料构型的总能量。答案以焦耳为单位，并四舍五入到三位有效数字。", "solution": "晶格是一个具有周期性边界的 $4 \\times 4$ 系统。总能量是所有 $16$ 个小方块 $p$ 的能量之和 $H=\\sum_{p} H_{p}$，其中对于每个小方块\n$$\nH_{p}=C\\left(n_{A}(p)-n_{B}(p)\\right)^{2}。\n$$\n由于每个小方块有 $n_{A}(p)+n_{B}(p)=4$，我们得到 $n_{B}(p)=4-n_{A}(p)$ 且\n$$\nn_{A}(p)-n_{B}(p)=2n_{A}(p)-4=2\\left(n_{A}(p)-2\\right),\n$$\n所以当 $C=1$ 时，\n$$\nH_{p}=4\\left(n_{A}(p)-2\\right)^{2}。\n$$\n一次Metropolis移动交换了位置 $(1,1)$ 和 $(2,1)$ 上的相，交换前它们分别为 $B$ 和 $A$。只有包含这两个位置中任意一个的小方块的能量会改变。一个位置 $(r,c)$ 属于左上角坐标为 $(r,c)$、$(r,c-1)$、$(r-1,c)$、$(r-1,c-1)$ 的小方块（索引模 $4$）。因此，受影响的小方块的左上角坐标为\n$$\n(0,0),\\ (0,1),\\ (1,0),\\ (1,1),\\ (2,0),\\ (2,1).\n$$\n计算这些小方块在交换前后的 $n_{A}$ 和 $H_{p}$：\n\n- 对于 $(0,0)$：交换前 $n_{A}=3 \\Rightarrow H_{p}=4$，交换后 $n_{A}=4 \\Rightarrow H_{p}=16$，变化量 $+12$。\n- 对于 $(0,1)$：交换前 $n_{A}=1 \\Rightarrow H_{p}=4$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $-4$。\n- 对于 $(1,0)$：交换前 $n_{A}=2 \\Rightarrow H_{p}=0$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $0$。\n- 对于 $(1,1)$：交换前 $n_{A}=2 \\Rightarrow H_{p}=0$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $0$。\n- 对于 $(2,0)$：交换前 $n_{A}=1 \\Rightarrow H_{p}=4$，交换后 $n_{A}=0 \\Rightarrow H_{p}=16$，变化量 $+12$。\n- 对于 $(2,1)$：交换前 $n_{A}=3 \\Rightarrow H_{p}=4$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $-4$。\n\n因此，总能量变化为\n$$\n\\Delta H = (+12)+(-4)+0+0+(+12)+(-4)=+16.\n$$\n在热能 $k_{B}T=8$ 下的Metropolis接受概率是\n$$\nP=\\min\\left(1,\\exp\\left(-\\frac{\\Delta H}{k_{B}T}\\right)\\right)=\\exp\\left(-\\frac{16}{8}\\right)=\\exp(-2).\n$$\n由于随机数 $r=0.10$ 且 $0.10  \\exp(-2)$，该移动被接受。\n\n为了得到最终的总能量，我们通过对所有 $16$ 个小方块求和来计算初始总能量 $H_{\\text{old}}$。初始非零的贡献项是\n$$\nH_{(0,0)}=4,\\ H_{(0,1)}=4,\\ H_{(0,2)}=16,\\ H_{(2,0)}=4,\\ H_{(2,1)}=4,\\ H_{(2,2)}=16,\n$$\n所有其他的 $H_{p}=0$，得到\n$$\nH_{\\text{old}}=48.\n$$\n由于交换被接受，\n$$\nH_{\\text{new}}=H_{\\text{old}}+\\Delta H=48+16=64.\n$$\n四舍五入到三位有效数字，尝试步骤后的总能量为 $64.0$。", "answer": "$$\\boxed{64.0}$$", "id": "1318218"}]}