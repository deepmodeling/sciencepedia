{"hands_on_practices": [{"introduction": "Q检验是处理小样本数据时一种简单快捷的离群值检验方法。本练习提供了一个在质量控制场景中应用Q检验的基础实践，帮助你掌握计算$Q$统计量并将其与临界值进行比较的核心技能[@problem_id:1479855]。", "problem": "一名分析化学专业的学生正在对一批新溶剂进行质量控制检查。溶剂的密度是一个关键参数。该学生对溶剂的密度进行了五次重复测量，得到以下结果（单位：g/mL）：0.8512、0.8509、0.8515、0.8421 和 0.8510。该学生怀疑最低的测量值 0.8421 g/mL 可能是由于操作失误导致的异常值。\n\n为了客观地评估这一怀疑，该学生决定应用 Dixon Q 检验。对于这个大小的数据集（n=5），在 95% 置信水平下的临界 Q 值（$Q_{crit}$）为 0.710。\n\n根据这些信息，下列哪个选项正确报告了计算出的 Q 统计量（$Q_{calc}$）（四舍五入到三位有效数字）以及对可疑数据点的相应决策？\n\nA. $Q_{calc} = 0.011$；保留该值。\n\nB. $Q_{calc} = 0.936$；舍弃该值。\n\nC. $Q_{calc} = 0.936$；保留该值。\n\nD. $Q_{calc} = 0.710$；舍弃该值。\n\nE. $Q_{calc} = 1.000$；舍弃该值。", "solution": "我们首先将测量值按升序排列：\n$$x_{(1)}=0.8421,\\; x_{(2)}=0.8509,\\; x_{(3)}=0.8510,\\; x_{(4)}=0.8512,\\; x_{(5)}=0.8515.$$\n可疑的异常值是最小值 $x_{(1)}$。对于存在可疑低异常值的 Dixon Q 检验，其检验统计量定义为\n$$Q_{\\text{calc}}=\\frac{x_{(2)}-x_{(1)}}{x_{(5)}-x_{(1)}}.$$\n计算分子（间距）和分母（极差）：\n$$\\text{gap}=x_{(2)}-x_{(1)}=0.8509-0.8421=0.0088,$$\n$$\\text{range}=x_{(5)}-x_{(1)}=0.8515-0.8421=0.0094.$$\n因此，\n$$Q_{\\text{calc}}=\\frac{0.0088}{0.0094}=\\frac{88}{94}\\approx 0.936.$$\n在 0.95 置信水平下，对于 $n=5$，给定的临界值为 $Q_{\\text{crit}}=0.710$。由于\n$$Q_{\\text{calc}}=0.936>Q_{\\text{crit}}=0.710,$$\n我们舍弃该可疑值，视其为异常值。这对应于选项 B，该选项报告了 $Q_{\\text{calc}}=0.936$（保留三位有效数字）以及舍弃该值的决策。", "answer": "$$\\boxed{B}$$", "id": "1479855"}, {"introduction": "真实的实验数据往往比较复杂，有时会包含不止一个可疑数据点。本练习将演示处理这种情况的标准流程：序贯格拉布斯检验法[@problem_id:1479860]。通过本练习，你将理解系统性方法的重要性，以及剔除一个离群值后如何影响对剩余数据的统计分析。", "problem": "一家制药公司的质量控制化学家正在分析一批新生产的药片，以验证其中活性药物成分（API）的含量。从该批次中随机抽取十片药片，并测量每片药片中 API 的质量。得到以下结果，单位为毫克（mg）：\n\n100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2, 96.5\n\n该化学家注意到，其中两个测量值 96.5 mg 和 98.2 mg 与其他值相比似乎异常偏低，并怀疑它们可能是离群值。为了做出统计上合理的决策，该化学家决定应用 Grubbs' 检验来识别并可能剔除离群值。该检验应按顺序应用，从最极端的数值开始。如果一个值被剔除，应在测试下一个潜在离群值之前将其从数据集中移除。\n\nGrubbs' 检验统计量 $G$ 使用以下公式计算：\n$$G = \\frac{|\\text{可疑值} - \\bar{x}|}{s}$$\n其中 $\\bar{x}$ 是样本均值，$s$ 是样本标准差。如果在期望的置信水平下，计算出的 $G$ 值（$G_{\\text{calc}}$）大于临界的 $G$ 值（$G_{\\text{critical}}$），则该值将被剔除。\n\n在 95% 置信水平下，Grubbs' 检验的临界值为：\n- 对于 $n=10$ 个观测值：$G_{\\text{critical}} = 2.290$\n- 对于 $n=9$ 个观测值：$G_{\\text{critical}} = 2.176$\n\n基于在 95% 置信水平下顺序应用 Grubbs' 检验，关于这两个可疑数据点的正确结论是什么？\n\nA. 96.5 mg 和 98.2 mg 均可作为离群值在统计上被剔除。\n\nB. 只有 96.5 mg 可以被剔除；98.2 mg 必须保留。\n\nC. 96.5 mg 和 98.2 mg 都不能被剔除。\n\nD. 只有 98.2 mg 可以被剔除；96.5 mg 必须保留。\n\nE. 测量值 96.5 mg 可以被剔除，但必须使用不同的置信水平重新应用检验来评估 98.2 mg。", "solution": "我们顺序应用 Grubbs’ 检验，从最极端的数值开始，使用检验统计量\n$$G=\\frac{|x_{\\text{suspect}}-\\bar{x}|}{s},$$\n其中 $\\bar{x}$ 是样本均值，$s$ 是分母为 $n-1$ 计算出的样本标准差：\n$$\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i},\\quad s=\\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}}.$$\n\n第一次检验（$n=10$，包含所有值）。数据为 $100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2, 96.5$。计算\n$$\\bar{x}=\\frac{995.7}{10}=99.57,$$\n$$\\sum_{i=1}^{10}(x_{i}-\\bar{x})^{2}=14.8210,\\quad s=\\sqrt{\\frac{14.8210}{9}}\\approx 1.2833.$$\n对于最极端的低值 $96.5$：\n$$G_{\\text{calc}}=\\frac{|96.5-99.57|}{1.2833}=\\frac{3.07}{1.2833}\\approx 2.392.$$\n由于 $G_{\\text{calc}}\\approx 2.392>G_{\\text{critical}}=2.290$（对于 $n=10$ 和给定的置信水平），剔除 $96.5$。\n\n第二次检验（移除 $96.5$，此时 $n=9$）。剩余数据为 $100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2$。计算\n$$\\bar{x}'=\\frac{899.2}{9}\\approx 99.9111,$$\n$$\\sum_{i=1}^{9}(x_{i}-\\bar{x}')^{2}\\approx 4.348518518,\\quad s'=\\sqrt{\\frac{4.348518518}{8}}\\approx 0.7373.$$\n检验下一个最极端的低值 $98.2$：\n$$G_{\\text{calc}}'=\\frac{|98.2-99.9111|}{0.7373}\\approx \\frac{1.7111}{0.7373}\\approx 2.322.$$\n由于 $G_{\\text{calc}}'\\approx 2.322>G_{\\text{critical}}=2.176$（对于 $n=9$ 和给定的置信水平），剔除 $98.2$。\n\n结论：在给定的置信水平下，根据所述的顺序 Grubbs’ 检验，96.5 mg 和 98.2 mg 均被作为离群值剔除，对应选项 A。", "answer": "$$\\boxed{A}$$", "id": "1479860"}, {"introduction": "诸如格拉布斯检验之类的统计方法，其可靠性在数据服从正态分布时最高。本练习探讨了环境化学中常见的一种情况，即数据呈现对数正态分布[@problem_id:1479839]。它要求你思考一个简单的数学变换如何深刻地改变检验结果，从而强调在应用统计工具前理解数据内在分布的至关重要性。", "problem": "一位环境化学家正在分析土壤样品中的痕量镉 (Cd) 浓度。对均质化土壤样品进行五次重复分析后，获得了以下浓度（单位：纳克/克，ng/g）：\n\n{10.0, 12.6, 15.8, 20.0, 63.1}\n\n该化学家怀疑最高值 63.1 ng/g 可能是一个离群值。已知环境基质中的痕量元素浓度通常服从对数正态分布，这意味着浓度的对数近似服从正态分布。为了研究这个可疑数据点，该化学家决定应用格拉布斯检验法 (Grubbs' test) 来检测离群值。\n\n格拉布斯检验统计量 $G_{calc}$ 的计算公式如下：\n$$G_{calc} = \\frac{|x_{suspect} - \\bar{x}|}{s}$$\n其中，$x_{suspect}$ 是可疑离群值，$\\bar{x}$ 是样本均值，$s$ 是样本标准差。在给定的置信水平下，如果 $G_{calc}$ 大于临界值 $G_{critical}$，则该数据点被判定为离群值并予以剔除。对于样本量 $N=5$ 和 95% 的置信水平，临界值为 $G_{critical} = 1.672$。\n\n你的任务是分别对原始数据和数据的常用对数（$\\log_{10}(x)$）进行格拉布斯检验。根据你的计算，以下哪个陈述正确描述了从这两种方法得出的结论？\n\nA. 在检验原始数据时，63.1 ng/g 这个值被判定为离群值并剔除；在检验对数转换后的数据时，它也被剔除。\n\nB. 在检验原始数据时，63.1 ng/g 这个值被保留为有效数据点；在检验对数转换后的数据时，它也被保留。\n\nC. 在检验原始数据时，63.1 ng/g 这个值被判定为离群值并剔除，但在检验对数转换后的数据时被保留。\n\nD. 在检验原始数据时，63.1 ng/g 这个值被保留为有效数据点，但在检验对数转换后的数据时被剔除。\n\nE. 在这种情况下，由于样本量太小，无法应用格拉布斯检验。", "solution": "问题要求我们对一个数据集进行格拉布斯离群值检验，首先使用原始数据，然后使用对数转换后的数据，最后比较结论。数据集为 {10.0, 12.6, 15.8, 20.0, 63.1}，可疑值为 $x_{suspect} = 63.1$，对于样本量 $N=5$ 和 95% 置信水平，给定的格拉布斯临界值为 $G_{critical} = 1.672$。\n\n**第 1 部分：对原始数据进行格拉布斯检验**\n\n首先，我们分析原始数据：{10.0, 12.6, 15.8, 20.0, 63.1}。\n\n步骤 1：计算样本均值（$\\bar{x}$）。\n$$ \\bar{x} = \\frac{10.0 + 12.6 + 15.8 + 20.0 + 63.1}{5} = \\frac{121.5}{5} = 24.3 $$\n\n步骤 2：计算样本标准差（$s$）。\n样本标准差的公式为 $s = \\sqrt{\\frac{\\sum_{i=1}^{N}(x_i - \\bar{x})^2}{N-1}}$。\n与均值的离差平方和为：\n$$ \\sum(x_i - \\bar{x})^2 = (10.0 - 24.3)^2 + (12.6 - 24.3)^2 + (15.8 - 24.3)^2 + (20.0 - 24.3)^2 + (63.1 - 24.3)^2 $$\n$$ \\sum(x_i - \\bar{x})^2 = (-14.3)^2 + (-11.7)^2 + (-8.5)^2 + (-4.3)^2 + (38.8)^2 $$\n$$ \\sum(x_i - \\bar{x})^2 = 204.49 + 136.89 + 72.25 + 18.49 + 1505.44 = 1937.56 $$\n现在，我们计算方差（$s^2$）和标准差（$s$）：\n$$ s^2 = \\frac{1937.56}{5-1} = \\frac{1937.56}{4} = 484.39 $$\n$$ s = \\sqrt{484.39} \\approx 22.0089 $$\n\n步骤 3：计算格拉布斯统计量（$G_{calc, raw}$）。\n$$ G_{calc, raw} = \\frac{|x_{suspect} - \\bar{x}|}{s} = \\frac{|63.1 - 24.3|}{22.0089} = \\frac{38.8}{22.0089} \\approx 1.7629 $$\n\n步骤 4：将 $G_{calc, raw}$ 与 $G_{critical}$ 进行比较。\n$$ G_{calc, raw} \\approx 1.7629 > G_{critical} = 1.672 $$\n由于计算出的 G 统计量大于临界值，因此拒绝原假设（即 63.1 不是离群值）。根据原始数据，值 63.1 ng/g 被归类为离群值。\n\n**第 2 部分：对对数转换后的数据进行格拉布斯检验**\n\n问题指出，痕量元素浓度通常服从对数正态分布，因此对数据的对数应用该检验是一种有效的方法。我们使用常用对数（以 10 为底）。\n\n步骤 1：通过取每个值的常用对数来转换数据。令 $y_i = \\log_{10}(x_i)$。\n$$ y_1 = \\log_{10}(10.0) = 1.0000 $$\n$$ y_2 = \\log_{10}(12.6) \\approx 1.1004 $$\n$$ y_3 = \\log_{10}(15.8) \\approx 1.1987 $$\n$$ y_4 = \\log_{10}(20.0) \\approx 1.3010 $$\n$$ y_5 = \\log_{10}(63.1) \\approx 1.8000 $$\n对数转换后的数据集为 {1.0000, 1.1004, 1.1987, 1.3010, 1.8000}。可疑值为 $y_{suspect} = 1.8000$。\n\n步骤 2：计算对数转换后数据的均值（$\\bar{y}$）。\n$$ \\bar{y} = \\frac{1.0000 + 1.1004 + 1.1987 + 1.3010 + 1.8000}{5} = \\frac{6.4001}{5} = 1.28002 $$\n\n步骤 3：计算对数转换后数据的标准差（$s_y$）。\n与均值的离差平方和为：\n$$ \\sum(y_i - \\bar{y})^2 = (1.0000 - 1.28002)^2 + (1.1004 - 1.28002)^2 + (1.1987 - 1.28002)^2 + (1.3010 - 1.28002)^2 + (1.8000 - 1.28002)^2 $$\n$$ \\sum(y_i - \\bar{y})^2 = (-0.28002)^2 + (-0.17962)^2 + (-0.08132)^2 + (0.02098)^2 + (0.51998)^2 $$\n$$ \\sum(y_i - \\bar{y})^2 \\approx 0.07841 + 0.03226 + 0.00661 + 0.00044 + 0.27038 = 0.3881 $$\n现在，我们计算方差（$s_y^2$）和标准差（$s_y$）：\n$$ s_y^2 = \\frac{0.3881}{5-1} = \\frac{0.3881}{4} = 0.097025 $$\n$$ s_y = \\sqrt{0.097025} \\approx 0.3115 $$\n\n步骤 4：计算对数转换后数据的格拉布斯统计量（$G_{calc, log}$）。\n$$ G_{calc, log} = \\frac{|y_{suspect} - \\bar{y}|}{s_y} = \\frac{|1.8000 - 1.28002|}{0.3115} = \\frac{0.51998}{0.3115} \\approx 1.6693 $$\n\n步骤 5：将 $G_{calc, log}$ 与 $G_{critical}$ 进行比较。\n$$ G_{calc, log} \\approx 1.6693  G_{critical} = 1.672 $$\n由于计算出的 G 统计量小于临界值，我们无法拒绝原假设。当对对数转换后的数据应用该检验时，该值被保留为有效数据点。\n\n**结论**\n\n比较两个结果：\n- 原始数据检验：值 63.1 ng/g 被判定为离群值并剔除。\n- 对数转换数据检验：该值被保留。\n\n这与选项 C 相符。向类正态分布的转换缓和了这个高值的影响，表明它可能是对数正态分布尾部的一个合理点，而在偏态的原始数据中，它与均值的距离使其看起来像一个误差。", "answer": "$$\\boxed{C}$$", "id": "1479839"}]}