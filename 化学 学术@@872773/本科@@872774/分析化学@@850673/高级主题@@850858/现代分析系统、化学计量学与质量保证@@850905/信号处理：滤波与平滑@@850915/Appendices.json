{"hands_on_practices": [{"introduction": "提高信噪比（$S/N$）是分析测量中的一个首要目标。对抗随机噪声最基本、最强大的方法之一是信号平均法。本练习将探讨平均测量的次数与信号质量改善之间的直接数学关系，这是增强光谱学和色谱学等领域中微弱信号的一项基石技术。[@problem_id:1471994]", "problem": "一位分析化学家正在使用一种光谱技术来检测河水样本中痕量的特定环境污染物。仪器噪声（主要是随机热噪声）相对于来自污染物的微弱信号而言非常显著。一次快速扫描的初步分析产生了一个谱图，其中污染物的特征峰的信噪比（S/N）为3.0。为确保可靠的鉴定和定量，实验室规程要求该峰的信噪比必须提高到至少30。这可以通过采集多次扫描并对其进行平均来实现。假设信号是相干的，而噪声是随机且在扫描之间不相关的，确定为达到目标信噪比30所必须采集和平均的最少扫描次数。", "solution": "对于相干信号和随机、不相关的噪声，对$N$次扫描进行平均会将噪声标准差减小一个因子$\\sqrt{N}$，而平均信号保持不变。因此，信噪比的变化规律如下\n$$\n\\left(\\frac{S}{N}\\right)_{N}=\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}.\n$$\n设单次扫描的值为$\\left(\\frac{S}{N}\\right)_{1}=3$，目标值为$\\left(\\frac{S}{N}\\right)_{\\text{target}}=30$。要求是\n$$\n\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}\\geq \\left(\\frac{S}{N}\\right)_{\\text{target}} \\quad \\Longrightarrow \\quad \\sqrt{N}\\geq \\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}.\n$$\n将两边平方可得\n$$\nN \\geq \\left(\\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}\\right)^{2}.\n$$\n因此，所需的最少整数扫描次数为\n$$\nN_{\\min}=\\left\\lceil \\left(\\frac{30}{3}\\right)^{2} \\right\\rceil=\\left\\lceil 10^{2} \\right\\rceil=100.\n$$\n由于平方结果已是整数，除了确认不等式外，无需额外的取整。", "answer": "$$\\boxed{100}$$", "id": "1471994"}, {"introduction": "除了对整个数据集进行平均，我们还可以使用数字滤波器对单个信号进行局部平滑。移动平均滤波器是一个直观的起点，它用每个数据点及其邻近点的平均值来替代该数据点。本练习提供了一个使用加权（三角）移动平均的动手计算，展示了如何通过与一组权重进行卷积来降低噪声并揭示潜在趋势。[@problem_id:1472012]", "problem": "在一次分析化学实验中，一名学生使用分光光度计监测一个缓慢的显色反应。样品的吸光度按固定时间间隔记录，但数据中含有少量随机电子噪声。为了减少这种噪声并更好地辨别趋势，将应用一个数字平滑滤波器。记录的前五个吸光度测量值是：\n\n`[0.215, 0.231, 0.224, 0.240, 0.236]`\n\n一个3点三角移动平均被用于平滑处理。对于此滤波器，一个新的平滑数据点通过原始数据点及其直接相邻点（前一个点和后一个点）的加权平均来计算。施加于前一个点、中心点和后一个点的权重分别为1、2和1。\n\n计算与原始序列中第三次测量相对应的平滑吸光度值。以数值形式提供答案，并四舍五入到四位有效数字。吸光度是一个无量纲量。", "solution": "一个3点三角移动平均，其前一个点、中心点和后一个点的权重分别为1、2和1，计算索引 $i$ 处的平滑值如下\n$$\ns_{i}=\\frac{1\\cdot x_{i-1}+2\\cdot x_{i}+1\\cdot x_{i+1}}{1+2+1}=\\frac{x_{i-1}+2x_{i}+x_{i+1}}{4}.\n$$\n对于第三次测量，有 $x_{2}=0.231$，$x_{3}=0.224$ 和 $x_{4}=0.240$。代入得，\n$$\ns_{3}=\\frac{0.231+2\\cdot 0.224+0.240}{4}=\\frac{0.231+0.448+0.240}{4}=\\frac{0.919}{4}=0.22975.\n$$\n四舍五入到四位有效数字得到 $0.2298$。", "answer": "$$\\boxed{0.2298}$$", "id": "1472012"}, {"introduction": "虽然简单的移动平均能有效降低噪声，但它们也可能扭曲重要的信号特征，如峰高和峰宽。Savitzky-Golay滤波器是一种更先进的技术，它通过对相邻点的小窗口拟合多项式来平滑数据。本练习演示了如何应用预定义的Savitzky-Golay滤波器卷积权重，该方法因其在平滑噪声的同时能保持原始信号形状的完整性而在分析化学中被广泛使用。[@problem_id:1471959]", "problem": "在一项使用分光光度法的动力学研究中，溶液的吸光度随时间被监测。由于检测器中固有的电子噪声，原始数据需要进行平滑处理，以便更好地确定反应速率。Savitzky-Golay 滤波法是用于此目的的常用技术。它的工作原理是将一组卷积整数（或称权重）应用于数据点的移动窗口。\n\n考虑以下七个连续的原始吸光度测量值序列，这些值是无单位的：\n$y_1 = 0.112$, $y_2 = 0.203$, $y_3 = 0.388$, $y_4 = 0.495$, $y_5 = 0.401$, $y_6 = 0.215$, $y_7 = 0.098$\n\n为了平滑这些数据，使用了一个5点二次Savitzky-Golay滤波器。该滤波器的权重集，从窗口中最左边的点到最右边的点，由整数 `[-3, 12, 17, 12, -3]` 给出。平滑后中心点的值是通过计算窗口中每个数据点与其相应权重的乘积之和，然后将此和除以一个归一化常数来得到的。对于这组特定的权重，归一化常数为 $35$。\n\n使用所提供的数据、权重和归一化常数，计算与原始第四个数据点 $y_4$ 相对应的平滑后吸光度值。将你的最终答案四舍五入到四位有效数字。", "solution": "为了使用权重为 $[-3,12,17,12,-3]$ 且归一化常数为 $35$ 的5点二次Savitzky-Golay滤波器来获得与 $y_{4}$ 相对应的中心点的平滑值，我们将卷积应用于以 $y_{4}$ 为中心的5点窗口，即 $\\{y_{2},y_{3},y_{4},y_{5},y_{6}\\}$。平滑后的值为\n$$\n\\tilde{y}_{4}=\\frac{1}{35}\\left[-3y_{2}+12y_{3}+17y_{4}+12y_{5}-3y_{6}\\right].\n$$\n代入给定的值：\n$$\n\\tilde{y}_{4}=\\frac{1}{35}\\left[-3(0.203)+12(0.388)+17(0.495)+12(0.401)-3(0.215)\\right].\n$$\n计算每一项：\n$$\n-3(0.203)=-0.609,\\quad 12(0.388)=4.656,\\quad 17(0.495)=8.415,\\quad 12(0.401)=4.812,\\quad -3(0.215)=-0.645.\n$$\n对分子求和：\n$$\n-0.609+4.656+8.415+4.812-0.645=16.629.\n$$\n除以归一化常数：\n$$\n\\tilde{y}_{4}=\\frac{16.629}{35}=0.475114\\ldots\n$$\n四舍五入到四位有效数字，结果为 $0.4751$。", "answer": "$$\\boxed{0.4751}$$", "id": "1471959"}]}