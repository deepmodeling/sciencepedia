{
    "hands_on_practices": [
        {
            "introduction": "行星大气结构的探索始于其与地表的交界面。地表吸收的太阳辐射与自身向外发出的热辐射，以及与大气之间的湍流热量和水汽交换，共同构成了地表能量收支的复杂画面。通过建立并求解这个能量平衡方程 ，我们可以计算出地表的平衡温度，并进一步判断近地表大气的稳定性。这项实践将让您亲手构建一个地表能量收支模型，从而理解地表特性（如反照率和粗糙度）如何从根本上决定对流活动的强度，这是理解对流层天气和气候的关键一步。",
            "id": "4170614",
            "problem": "你需要编写一个完整、可运行的程序，该程序构建一个物理上一致的地表能量收支模型，并用它来量化在不同地表属性下对流层低层的对流和稳定度。程序必须求解平衡地表温度，然后为每个提供的测试用例计算一个整体稳定度度量。答案必须以指定的单位表示，最终输出必须遵循本问题末尾描述的精确格式。\n\n使用以下基本原理和经过充分检验的关系式来推导算法：\n\n- 地表的能量守恒要求地表净辐射输入与湍流感热通量、潜热通量以及任何地下热通量相平衡。假设日平衡且无热量储存，即 $G = 0$，因此地表能量平衡方程为\n$$\n(1 - \\alpha) S_\\downarrow + L_\\downarrow - \\epsilon \\sigma T_s^4 = \\rho c_p C_H U (T_s - T_a) + \\rho L_v C_E U (q_s(T_s) - q_a).\n$$\n所有符号必须用物理上一致的单位来解释。\n\n- 地表净短波辐射为 $S_n = (1 - \\alpha) S_\\downarrow$，其中 $\\alpha$ 是地表反照率。\n\n- 地表净长波辐射为 $L_n = L_\\downarrow - \\epsilon \\sigma T_s^4$，其中 $\\epsilon$ 是地表长波发射率，$\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n- 湍流通量的整体空气动力学中性传输参数化使用中性拖曳/传输系数\n$$\nC = \\frac{\\kappa^2}{\\left[\\ln\\!\\left(\\frac{z}{z_0}\\right)\\right]^2},\n$$\n其中，在中性稳定度下 $C_H = C_E = C$，$\\kappa$ 是冯·卡门常数，$z$ 是参考高度，$z_0$ 是地表粗糙度长度。\n\n- 近地表的空气密度由理想气体定律近似得出，\n$$\n\\rho = \\frac{p}{R_d T_a},\n$$\n其中 $p$ 是地表气压，$R_d$ 是干空气比气体常数，$T_a$ 是高度 $z$ 处的空气温度。\n\n- 地表水的饱和水汽压由在三相点附近线性化的克劳修斯-克拉佩龙关系式给出，\n$$\ne_{\\text{sat}}(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right),\n$$\n其中 $e_0$ 是三相点 $T_0$ 处的饱和水汽压，$L_v$ 是汽化潜热，$R_v$ 是水汽比气体常数。在 $e_{\\text{sat}} \\ll p$ 的典型条件下，地表饱和比湿可取为\n$$\nq_s(T_s) \\approx \\epsilon_w \\frac{e_{\\text{sat}}(T_s)}{p},\n$$\n其中 $\\epsilon_w$ 是分子量比值。\n\n- 位温为\n$$\n\\theta(T, p) = T \\left(\\frac{p_0}{p}\\right)^{R_d/c_p},\n$$\n其中 $p_0$ 是一个参考气压。使用此公式定义整体理查森数，作为近地表静力稳定度的度量，\n$$\nRi_b = \\frac{g z}{\\theta_a} \\frac{\\theta_z - \\theta_s}{U^2},\n$$\n其中 $\\theta_s = \\theta(T_s, p)$ 是地表位温，$\\theta_z = \\theta(T_a, p)$ 是高度 $z$ 处的空气位温，为方便起见，取 $\\theta_a = \\theta_z$。\n\n你的程序必须：\n\n1. 对于每个测试用例，求解由地表能量平衡给出的非线性方程，以确定平衡地表温度 $T_s$（单位为开尔文）。使用一种稳健的求根方法，该方法不假定存在闭合形式解。所有通量必须以瓦特每平方米（$\\mathrm{W\\,m^{-2}}$）计算，温度以开尔文（$\\mathrm{K}$）计算，风速以米每秒（$\\mathrm{m\\,s^{-1}}$）计算，长度以米（$\\mathrm{m}$）计算，气压以帕斯卡（$\\mathrm{Pa}$）计算，比湿以千克每千克（$\\mathrm{kg\\,kg^{-1}}$）计算。斯特藩-玻尔兹曼常数 $\\sigma$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n\n2. 对于每种情况，使用求解出的 $T_s$ 计算整体理查森数 $Ri_b$。将 $Ri_b  0$（负值）解释为动力学上有利于对流，将 $Ri_b \\ge 0$（非负值）解释为稳定分层。将 $Ri_b$ 报告为无量纲浮点数。\n\n在所有情况下使用的常数：\n- $\\sigma = 5.670374419 \\times 10^{-8}$ $\\mathrm{W\\,m^{-2}\\,K^{-4}}$,\n- $c_p = 1004$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $R_d = 287$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $R_v = 461$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $L_v = 2.5 \\times 10^6$ $\\mathrm{J\\,kg^{-1}}$,\n- $e_0 = 611.2$ $\\mathrm{Pa}$,\n- $T_0 = 273.15$ $\\mathrm{K}$,\n- $\\epsilon_w = 0.622$ (无量纲),\n- $\\kappa = 0.4$ (无量纲),\n- $p_0 = 100000$ $\\mathrm{Pa}$.\n\n测试套件（每个用例是一个参数元组 $(S_\\downarrow, L_\\downarrow, \\alpha, \\epsilon, U, z_0, z, T_a, q_a, p, g)$，单位如上所列）：\n- 用例 $1$（类地，海洋正午）：$(800, 400, 0.06, 0.98, 5, 0.001, 10, 300, 0.012, 100000, 9.81)$。\n- 用例 $2$（沙漠，高反照率，干燥空气）：$(900, 350, 0.35, 0.95, 3, 0.05, 10, 305, 0.004, 95000, 9.81)$。\n- 用例 $3$（冰面，较冷大气）：$(500, 250, 0.60, 0.97, 2, 0.001, 10, 270, 0.001, 100000, 9.81)$。\n- 用例 $4$（系外行星，较高重力，低风速）：$(1200, 300, 0.20, 0.90, 1, 0.01, 10, 295, 0.010, 80000, 15.0)$。\n\n覆盖范围设计：\n- 用例 $1$ 是一个通用的“理想路径”。\n- 用例 $2$ 强调高地表反照率和粗糙度。\n- 用例 $3$ 接近辐射输入减少和冷空气有利于稳定度的边界条件。\n- 用例 $4$ 在低风速条件下探讨了修改重力和气压后的系外行星参数变化。\n\n最终输出规格：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如，“[$r_1, r_2, r_3, r_4$]”。每个条目必须是对应测试用例的整体理查森数 $Ri_b$，四舍五入到六位小数（无量纲）。",
            "solution": "用户的要求是开发一个 Python 程序，该程序求解行星表面的平衡地表温度 ($T_s$)，然后计算大气稳定度的度量——整体理查森数 ($Ri_b$)。这需要验证问题陈述，如果有效，则基于所提供的物理原理构建一个解决方案。\n\n### 第 1 和 2 步：问题验证\n\n该问题经过了严格的验证过程。\n\n1.  **提取给定条件**：所有提供的方程、常数和测试用例都已被仔细提取。该问题定义了一个完整的物理模型：\n    *   **地表能量平衡**：$(1 - \\alpha) S_\\downarrow + L_\\downarrow - \\epsilon \\sigma T_s^4 = \\rho c_p C_H U (T_s - T_a) + \\rho L_v C_E U (q_s(T_s) - q_a)$。这是需求解 $T_s$ 的核心方程。\n    *   **辅助方程**：提供了空气密度（$\\rho$）、湍流传输系数（$C_H, C_E$）、饱和水汽压（$e_{\\text{sat}}$）、比湿（$q_s$）、位温（$\\theta$）和整体理查森数（$Ri_b$）的标准物理和气象学公式。\n    *   **常数**：给出了一个包含精确值的物理常数综合列表（$\\sigma, c_p, R_d, R_v, L_v, e_0, T_0, \\epsilon_w, \\kappa, p_0$）。\n    *   **测试用例**：提供了四个定义明确、包含所有必要输入参数的独立测试用例。\n\n2.  **验证检查**：\n    *   **科学依据**：该问题从根本上基于能量守恒原理，并采用了大气科学和微气象学中标准的、被广泛接受的参数化方案。该物理模型虽然经过简化（例如，使用中性传输系数），但在科学上是合理的，并且适合于此类分析。所有常数和参数范围都是物理上现实的。\n    *   **适定性**：核心任务是找到能量平衡方程的根，该方程可表示为 $F(T_s) = 0$。函数 $F(T_s)$ 是进入地表的净能量通量。对其分量的分析表明，对于 $T_s > 0$，它是一个严格单调递减的函数。出射长波辐射项 ($-\\epsilon \\sigma T_s^4$) 和潜热通量项（由 $q_s(T_s)$ 驱动，是 $T_s$ 的指数函数）确保了这一行为。由于 $F(T_s \\to 0^+) > 0$ 且 $F(T_s \\to \\infty) \\to -\\infty$，根据介值定理，可以保证存在一个唯一的、稳定的 $T_s$ 解。\n    *   **目标明确**：问题以精确、定量和明确的数学和物理术语陈述。\n    *   **完整性**：问题是自洽的。求解 $T_s$ 并随后计算 $Ri_b$ 所需的所有变量、常数和条件都已提供。\n\n**结论**：该问题是**有效的**。它在科学上是合理的，具有适定性，并且提供了构建唯一、有意义的解决方案所需的所有信息。\n\n### 第 3 步：算法设计与解决方案\n\n解决方案的步骤是首先确定平衡地表温度 $T_s$，然后用它来计算整体理查森数 $Ri_b$。\n\n#### 第 1 部分：求解平衡地表温度 ($T_s$)\n\n必须求解地表能量平衡方程以得到 $T_s$：\n$$\n(1 - \\alpha) S_\\downarrow + L_\\downarrow - \\epsilon \\sigma T_s^4 - \\rho c_p C U (T_s - T_a) - \\rho L_v C U (q_s(T_s) - q_a) = 0\n$$\n这是一个非线性的超越方程，因为它包含 $T_s^4$ 项，并且 $q_s$ 通过克劳修斯-克拉佩龙关系式与 $T_s$ 呈指数依赖关系：\n$$\nq_s(T_s) \\approx \\frac{\\epsilon_w}{p} e_{\\text{sat}}(T_s) = \\frac{\\epsilon_w}{p} \\left[ e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T_s}\\right)\\right) \\right]\n$$\n为了求解 $T_s$，我们定义一个函数 $f(T_s)$ 来表示地表的净能量不平衡。目标是找到根 $T_s$，使得 $f(T_s) = 0$。这需要一个数值求根算法。`scipy.optimize.brentq` 函数是一个绝佳的选择，因为它是一种稳健而高效的方法，只要根位于指定的搜索区间内，就能保证收敛。基于物理推理，对于给定的测试用例，搜索区间如 $[100\\,\\mathrm{K}, 500\\,\\mathrm{K}]$ 必定包含根。\n\n为提高效率，首先计算能量平衡中不依赖于 $T_s$ 的项：\n- 空气密度：$\\rho = \\frac{p}{R_d T_a}$\n- 中性传输系数：$C = \\frac{\\kappa^2}{\\left[\\ln(z/z_0)\\right]^2}$\n\n#### 第 2 部分：计算整体理查森数 ($Ri_b$)\n\n一旦找到平衡地表温度 $T_s$，我们就可以使用整体理查森数来评估近地表层的静力稳定度：\n$$\nRi_b = \\frac{g z}{\\theta_a} \\frac{\\theta_z - \\theta_s}{U^2}\n$$\n计算包括以下步骤：\n1.  使用各自的温度 $T_s$ 和 $T_a$ 以及地表气压 $p$，计算地表位温 $\\theta_s$ 和高度 $z$ 处的空气位温 $\\theta_z$。位温 $\\theta$ 由以下公式给出：\n    $$\n    \\theta(T, p) = T \\left(\\frac{p_0}{p}\\right)^{R_d/c_p}\n    $$\n2.  计算 $\\theta_s = \\theta(T_s, p)$ 和 $\\theta_z = \\theta(T_a, p)$。\n3.  按照规定，在分母中使用 $\\theta_a = \\theta_z$ 作为参考位温。\n4.  将所有值代入 $Ri_b$ 公式。负的 $Ri_b$（此时 $T_s > T_a$，因此 $\\theta_s > \\theta_z$）表示不稳定的温度直减率，有利于对流。非负的 $Ri_b$ 表示稳定分层。\n\n最终程序为每个测试用例实现这些步骤，计算相应的 $Ri_b$，并根据指定的输出格式对结果进行格式化。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\n# This program solves for the equilibrium surface temperature and computes the\n# bulk Richardson number for a set of planetary surface layer scenarios.\n\n# Constants are defined with their standard physical values and units.\nSIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\nCP = 1004.0             # Specific heat of dry air at constant pressure (J kg^-1 K^-1)\nRD = 287.0              # Specific gas constant for dry air (J kg^-1 K^-1)\nRV = 461.0              # Specific gas constant for water vapor (J kg^-1 K^-1)\nLV = 2.5e6              # Latent heat of vaporization of water (J kg^-1)\nE0 = 611.2              # Saturation vapor pressure at triple point (Pa)\nT0 = 273.15             # Triple point of water (K)\nEPSILON_W = 0.622       # Ratio of molecular weights (water vapor / dry air)\nKAPPA = 0.4             # von Kármán constant (dimensionless)\nP0 = 100000.0           # Reference pressure (Pa)\n\ndef solve():\n    \"\"\"\n    Main function to process test cases, solve for surface temperature,\n    and calculate the bulk Richardson number.\n    \"\"\"\n    # Test cases defined as tuples of parameters:\n    # (S_downarrow, L_downarrow, alpha, epsilon, U, z0, z, Ta, qa, p, g)\n    test_cases = [\n        # Case 1: Earth-like, oceanic mid-day\n        (800.0, 400.0, 0.06, 0.98, 5.0, 0.001, 10.0, 300.0, 0.012, 100000.0, 9.81),\n        # Case 2: Desert, high albedo, drier air\n        (900.0, 350.0, 0.35, 0.95, 3.0, 0.05, 10.0, 305.0, 0.004, 95000.0, 9.81),\n        # Case 3: Icy surface, colder atmosphere\n        (500.0, 250.0, 0.60, 0.97, 2.0, 0.001, 10.0, 270.0, 0.001, 100000.0, 9.81),\n        # Case 4: Exoplanet, higher gravity, low wind\n        (1200.0, 300.0, 0.20, 0.90, 1.0, 0.01, 10.0, 295.0, 0.010, 80000.0, 15.0),\n    ]\n\n    results = []\n\n    for params in test_cases:\n        S_down, L_down, alpha, epsilon, U, z0, z, Ta, qa, p, g = params\n\n        # Pre-calculate terms that do not depend on the surface temperature Ts\n        rho = p / (RD * Ta)\n        C = (KAPPA**2) / (np.log(z / z0)**2)\n\n        def energy_balance(Ts, *args):\n            \"\"\"\n            This function represents the surface energy balance equation.\n            The root of this function is the equilibrium surface temperature.\n            f(Ts) = R_net - SH - LH\n            \"\"\"\n            S_down, L_down, alpha, epsilon, U, Ta, qa, p, rho, C = args\n\n            # Net Radiation (R_net)\n            sw_net = (1 - alpha) * S_down\n            lw_out = epsilon * SIGMA * Ts**4\n            R_net = sw_net + L_down - lw_out\n\n            # Sensible Heat Flux (SH)\n            SH = rho * CP * C * U * (Ts - Ta)\n\n            # Latent Heat Flux (LH)\n            e_sat_s = E0 * np.exp((LV / RV) * (1 / T0 - 1 / Ts))\n            qs_s = EPSILON_W * e_sat_s / p\n            LH = rho * LV * C * U * (qs_s - qa)\n            \n            return R_net - SH - LH\n\n        # Solve for the equilibrium surface temperature Ts using a robust root-finder.\n        # A bracketing interval [100 K, 500 K] is safe for these scenarios.\n        solver_args = (S_down, L_down, alpha, epsilon, U, Ta, qa, p, rho, C)\n        Ts_sol = brentq(energy_balance, 100.0, 500.0, args=solver_args)\n\n        # Calculate the bulk Richardson number (Ri_b)\n        exp_theta = RD / CP\n        \n        # Surface and air potential temperatures\n        theta_s = Ts_sol * (P0 / p)**exp_theta\n        theta_z = Ta * (P0 / p)**exp_theta\n        \n        # As per problem, theta_a = theta_z\n        theta_a = theta_z\n\n        # Ri_b calculation. Wind speed U is > 0 for all test cases.\n        Ri_b = (g * z / theta_a) * (theta_z - theta_s) / (U**2)\n        \n        results.append(Ri_b)\n\n    # Format the results to 6 decimal places and print in the specified format\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从地表向上，我们进入一个由湍流主导的大气区域，即均匀层（homosphere）。在这个区域内，强烈的垂直混合使得大气的主要化学成分（如氮气、氧气）的混合比基本保持不变。这种混合过程的效率可以通过一个称为“涡动扩散”的物理过程来量化，其特征在于一个涡动扩散系数 $K_{zz}$ 和一个相关的混合时间尺度。这项实践  旨在通过推导和计算这一时间尺度，帮助您理解决定大气成分是否“充分混合”的物理机制，这对于区分由动力学主导的物种和由光化学主导的物种至关重要。",
            "id": "4170644",
            "problem": "一个垂直分层、静力平衡的系外行星大气以氮为主，在均质层顶以下是稳定分层的，在该区域，湍流涡旋混合主导分子扩散。考虑一个没有局地源或汇的被动示踪物。在均质层顶以下，示踪物的垂直输运可以通过一个在厚度为 $L$ 的有限垂直层上为常数的涡流扩散系数 $K_{zz}$ 来参数化。\n\n从示踪物的质量守恒和湍流混合的扩散通量定律出发，当 $K_{zz}$ 空间均匀时，推导一个示踪物在厚度为 $L$ 的层上实现垂直均匀化的特征时间尺度。然后，对于“均质层顶区域”（此处理想化为一个厚度为 $L = 2H$ 的层，其中 $H$ 是当地的气压标高），计算这个时间尺度。假设均质层顶温度 $T$ 为等温，大气处于静力平衡，且为理想气体。使用以下参数、常数和定义：\n- 重力 $g = 12 \\ \\mathrm{m \\ s^{-2}}$，\n- 均质层顶温度 $T = 220 \\ \\mathrm{K}$，\n- 平均分子质量 $\\mu = 28$（无量纲，以原子质量单位计），\n- 均质层顶及其正下方的涡流扩散系数 $K_{zz} = 100 \\ \\mathrm{m^{2} \\ s^{-1}}$，\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\ K^{-1}}$，\n- 原子质量单位 $m_{u} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$，\n- 气压标高 $H = \\dfrac{k_{B} T}{\\mu \\, m_{u} \\, g}$，\n- 一天等于 $86400 \\ \\mathrm{s}$。\n\n在推导过程中清晰地概述物理假设。最后，计算穿越均质层顶区域的垂直混合时间尺度的数值，并以天为单位给出最终答案。将答案四舍五入到三位有效数字。简要评论这个时间尺度如何揭示均质层顶以下的主体成分相对于平流层中可能的光化学寿命而言，是否倾向于混合均匀。",
            "solution": "该问题要求推导和计算行星大气中被动示踪物垂直均匀化的特征时间尺度。此过程必须从质量守恒原理的正式推导开始。\n\n**第1步：推导控制方程**\n\n我们从数密度为 $n_t$ 的示踪物种的连续性方程开始。对于没有局地源或汇的被动示踪物，在一维垂直框架中，该方程为：\n$$\n\\frac{\\partial n_t}{\\partial t} + \\frac{\\partial \\Phi_{t,z}}{\\partial z} = 0\n$$\n其中，$t$ 是时间，$z$ 是垂直坐标，$\\Phi_{t,z}$ 是示踪物的垂直通量。\n\n问题指出，湍流涡旋混合占主导地位。垂直涡流扩散通量由涡流扩散系数 $K_{zz}$ 参数化，并与示踪物混合比 $f = n_t/n$ 的梯度成正比，其中 $n$ 是背景大气的数密度。这是因为湍流混合的是位温和混合比，而不是绝对温度或密度。通量由一个类菲克定律给出：\n$$\n\\Phi_{t,z} = -K_{zz} n \\frac{\\partial f}{\\partial z}\n$$\n将通量代入连续性方程，我们得到：\n$$\n\\frac{\\partial n_t}{\\partial t} - \\frac{\\partial}{\\partial z} \\left( K_{zz} n \\frac{\\partial f}{\\partial z} \\right) = 0\n$$\n我们可以将 $n_t$ 重写为 $f \\cdot n$。假设背景大气处于稳态（$\\frac{\\partial n}{\\partial t} = 0$），时间导数变为：\n$$\n\\frac{\\partial n_t}{\\partial t} = \\frac{\\partial (f n)}{\\partial t} = n \\frac{\\partial f}{\\partial t}\n$$\n问题指出 $K_{zz}$ 在空间上是均匀的（随 $z$ 不变）。因此，我们可以写出：\n$$\nn \\frac{\\partial f}{\\partial t} = K_{zz} \\frac{\\partial}{\\partial z} \\left( n \\frac{\\partial f}{\\partial z} \\right)\n$$\n两边除以 $n$ 得到混合比 $f$ 的控制方程：\n$$\n\\frac{\\partial f}{\\partial t} = \\frac{K_{zz}}{n} \\frac{\\partial}{\\partial z} \\left( n \\frac{\\partial f}{\\partial z} \\right)\n$$\n假设大气处于静力平衡且等温。理想气体定律为 $P = n k_B T$，静力学方程为 $\\frac{dP}{dz} = -\\rho g = -n \\mu m_u g$，其中 $P$ 是气压，$T$ 是温度，$g$ 是重力，$\\mu$ 是以原子质量单位计的平均分子质量，$m_u$ 是原子质量单位。由于 $T$ 是常数：\n$$\nk_B T \\frac{dn}{dz} = -n \\mu m_u g \\implies \\frac{1}{n} \\frac{dn}{dz} = -\\frac{\\mu m_u g}{k_B T}\n$$\n根据定义，气压标高为 $H = \\frac{k_B T}{\\mu m_u g}$。因此，$\\frac{1}{n} \\frac{dn}{dz} = -\\frac{1}{H}$。这得到了我们熟悉的数密度气压分布：$n(z) = n_0 \\exp(-z/H)$。\n\n将 $\\frac{dn}{dz} = -n/H$ 代入 $f$ 的控制方程：\n$$\n\\frac{\\partial f}{\\partial t} = \\frac{K_{zz}}{n} \\left( \\frac{\\partial n}{\\partial z} \\frac{\\partial f}{\\partial z} + n \\frac{\\partial^2 f}{\\partial z^2} \\right) = K_{zz} \\left( \\frac{1}{n} \\frac{dn}{dz} \\frac{\\partial f}{\\partial z} + \\frac{\\partial^2 f}{\\partial z^2} \\right)\n$$\n$$\n\\frac{\\partial f}{\\partial t} = K_{zz} \\left( \\frac{\\partial^2 f}{\\partial z^2} - \\frac{1}{H} \\frac{\\partial f}{\\partial z} \\right)\n$$\n这是一维混合比 $f$ 的平流-扩散方程。$\\frac{\\partial^2 f}{\\partial z^2}$ 项代表扩散，而 $-\\frac{1}{H}\\frac{\\partial f}{\\partial z}$ 项代表由大气密度分层引起的有效平流。\n\n**第2步：推导特征时间尺度**\n\n对于由微分方程描述的物理过程，其特征时间尺度 $\\tau$ 可以通过量纲分析来估计。我们将时间导数与主要的​​空间导数项进行平衡。“均匀化”一词意味着一个平滑过程，这在根本上是扩散性的。最高阶的空间导数，即扩散项，在最小尺度上控制着这种平滑过程。\n设 $L$ 是待均匀化的示踪物分布的特征垂直长度尺度。我们可以如下近似导数：\n$$\n\\frac{\\partial f}{\\partial t} \\sim \\frac{\\Delta f}{\\tau} \\quad \\text{和} \\quad \\frac{\\partial^2 f}{\\partial z^2} \\sim \\frac{\\Delta f}{L^2}\n$$\n其中 $\\Delta f$ 是层内混合比的特征变化。通过平衡控制方程中的时间导数项与扩散项：\n$$\n\\frac{\\Delta f}{\\tau} \\sim K_{zz} \\frac{\\Delta f}{L^2}\n$$\n这得出了垂直涡流扩散的特征时间尺度：\n$$\n\\tau = \\frac{L^2}{K_{zz}}\n$$\n这是扩散时间尺度的标准定义。它代表了湍流涡旋将物质在垂直距离 $L$ 上混合所需的大致时间。\n\n**第3步：数值计算**\n\n问题指定层厚为 $L = 2H$。首先，我们必须计算气压标高 $H$。\n$$\nH = \\frac{k_B T}{\\mu m_u g}\n$$\n使用给定的参数：\n- $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\ K^{-1}}$\n- $T = 220 \\ \\mathrm{K}$\n- $\\mu = 28$\n- $m_u = 1.660539 \\times 10^{-27} \\ \\mathrm{kg}$\n- $g = 12 \\ \\mathrm{m \\ s^{-2}}$\n\n以千克为单位的平均分子质量为 $m = \\mu m_u = 28 \\times (1.660539 \\times 10^{-27} \\ \\mathrm{kg}) = 4.6495092 \\times 10^{-26} \\ \\mathrm{kg}$。\n$$\nH = \\frac{(1.380649 \\times 10^{-23} \\ \\mathrm{J \\ K^{-1}}) \\times (220 \\ \\mathrm{K})}{(4.6495092 \\times 10^{-26} \\ \\mathrm{kg}) \\times (12 \\ \\mathrm{m \\ s^{-2}})} = \\frac{3.0374278 \\times 10^{-21} \\ \\mathrm{J}}{5.579411 \\times 10^{-25} \\ \\mathrm{kg \\ m \\ s^{-2}}} \\approx 5444.03 \\ \\mathrm{m}\n$$\n均质层顶区域的厚度为 $L = 2H \\approx 2 \\times 5444.03 \\ \\mathrm{m} = 10888.06 \\ \\mathrm{m}$。\n\n现在我们可以使用推导出的公式和给定的涡流扩散系数 $K_{zz} = 100 \\ \\mathrm{m^2 \\ s^{-1}}$ 来计算混合时间尺度 $\\tau$。\n$$\n\\tau = \\frac{L^2}{K_{zz}} = \\frac{(2H)^2}{K_{zz}} = \\frac{4H^2}{K_{zz}}\n$$\n$$\n\\tau = \\frac{(10888.06 \\ \\mathrm{m})^2}{100 \\ \\mathrm{m^2 \\ s^{-1}}} = \\frac{1.1855185 \\times 10^8 \\ \\mathrm{m^2}}{100 \\ \\mathrm{m^2 \\ s^{-1}}} = 1,185,518.5 \\ \\mathrm{s}\n$$\n为了以天为单位表示这个时间尺度，我们使用换算关系 $1 \\ \\mathrm{day} = 86400 \\ \\mathrm{s}$。\n$$\n\\tau_{\\text{days}} = \\frac{1,185,518.5 \\ \\mathrm{s}}{86400 \\ \\mathrm{s/day}} \\approx 13.721279 \\ \\mathrm{days}\n$$\n将结果四舍五入到三位有效数字，得到 $13.7 \\ \\mathrm{天}$。\n\n**第4步：评论**\n\n计算出的约 $13.7$ 天的垂直混合时间尺度，为均质层顶以下区域的大气主体成分被湍流均匀化的速度提供了一个定量度量。这个时间尺度是与化学时间尺度进行比较的关键基准。\n\n如果某个化学物种的光化学寿命远长于这个混合时间尺度（例如，数月或数年），那么输运将主导化学损失。因此，该物种的混合比将在整个大气层中保持垂直恒定，即“混合均匀”。地球上这类物种的例子有 N$_2$O 和 CH$_4$。\n\n相反，如果一个物种的寿命远短于 $13.7$ 天，其垂直分布将主要由光化学生成和损失的局地平衡决定，它将不会是混合均匀的。其混合比将表现出显著的垂直梯度。\n\n因此，这个时间尺度有助于区分哪些化学成分在均质层模型中符合“混合均匀”的假设，哪些则需要对化学动力学和输运进行明确处理。",
            "answer": "$$\n\\boxed{13.7}\n$$"
        },
        {
            "introduction": "在某一高度（称为均匀层顶，homopause），湍流混合的强度减弱到可以忽略不计，分子扩散成为主导的气体输运过程。在此之上，大气进入非均匀层（heterosphere），其成分开始依据质量发生显著的分层。与湍流混合将所有气体“捆绑”在一起不同，分子扩散允许每种气体在重力作用下独立沉降，建立起各自独特的标高。这项练习  将引导您推导并计算这种扩散分离效应，从而解释为何行星的上层大气（热层）会从富含较重的分子（如 $N_2$）过渡到由较轻的原子（如 $O$ 和 $H$）主导，这是高层大气物理学和大气逃逸研究中的一个核心概念。",
            "id": "4170655",
            "problem": "一颗地球大小的系外行星围绕一颗晚型恒星运行，其在狭窄的海拔范围内表现出等温热层，在该范围内，扩散分离导致了从分子氮主导到原子氧主导的过渡。从适用于大气结构的基本原理出发，特别是静力平衡和理想气体定律，推导等温层的局部物种特定的指数密度剖面，并根据物种质量、温度和引力加速度确定与物种相关的标高。然后，通过确定当主导物种质量从 $28\\,m_{u}$ 变为 $16\\,m_{u}$ 时标高如何变化，来评估因扩散分离引起的从分子氮到原子氧过渡过程中的可变平均分子量的影响，其中 $m_{u}$ 是原子质量单位。\n\n对于一个特定的、科学上合理的系外行星，假设如下：\n- 行星质量 $M_{p} = 1.3\\,M_{\\oplus} = 7.7636 \\times 10^{24}\\,\\mathrm{kg}$，\n- 行星半径 $R_{p} = 1.2\\,R_{\\oplus} = 7.6452 \\times 10^{6}\\,\\mathrm{m}$，\n- 引力常数 $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，\n- 原子质量单位 $m_{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$，\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，\n- 在所考虑的 $z$ 范围内，等温热层温度 $T = 1200\\,\\mathrm{K}$，\n- 过渡高度 $z_{t} = 4.00 \\times 10^{5}\\,\\mathrm{m}$。\n\n假设以下与狭窄层分析一致的建模简化：该层是等温的，大气处于静力平衡状态，均质层顶上方的分子扩散产生物种特定的密度剖面，并且在用于定义 $z_t$ 处局部标高的垂直区间内，引力加速度可取为 $g(z_{t}) = G M_{p} / (R_{p} + z_{t})^{2}$。\n\n使用原子氧的质量 $m_{\\mathrm{O}} = 16\\,m_{u}$ 计算在 $z_{t}$ 处的原子氧标高 $H_{\\mathrm{O}}$。以 $\\mathrm{km}$ 为单位表示最终标高，并将答案四舍五入到四位有效数字。",
            "solution": "首先根据具有科学依据、适定性和客观性的标准对问题进行验证。问题陈述基于大气物理学的基本原理，即静力平衡和理想气体定律。行星热层中的扩散分离这一物理情景是一个公认的概念。所有必要的物理常数和行星参数均已提供，其数值对于一颗超级地球系外行星来说是科学上合理的。等温层和局部恒定引力的假设是标准的，适用于在狭窄海拔范围内进行的一阶分析。该问题是适定的，因为它要求先进行推导，然后进行计算，存在唯一解。语言精确且客观。因此，该问题被认为是有效的，可以提供完整解答。\n\n主要任务是推导处于静力平衡的等温大气层的物种特定密度剖面，确定标高，然后为给定系外行星上的原子氧计算该值。\n\n我们从静力平衡方程开始，该方程描述了流体元上压力梯度力与引力之间的平衡。对于扩散分离大气中的单一物种 $i$，其分压 $P_i$ 随高度 $z$ 的变化遵循以下公式：\n$$\n\\frac{dP_i}{dz} = -\\rho_i(z) g(z)\n$$\n其中 $\\rho_i(z)$ 是物种 $i$ 在高度 $z$ 处的质量密度，而 $g(z)$ 是局部引力加速度。\n\n我们使用理想气体定律来模拟气体，该定律关联了分压 $P_i$、数密度 $n_i$ 和温度 $T$：\n$$\nP_i = n_i k_B T\n$$\n其中 $k_B$ 是玻尔兹曼常数。质量密度 $\\rho_i$ 与数密度 $n_i$ 以及物种 $i$ 的单个粒子质量 $m_i$ 的关系如下：\n$$\n\\rho_i = n_i m_i\n$$\n将 $n_i = P_i / (k_B T)$ 代入质量密度方程，得到：\n$$\n\\rho_i = \\frac{P_i m_i}{k_B T}\n$$\n现在我们将这个 $\\rho_i$ 的表达式代回静力平衡方程：\n$$\n\\frac{dP_i}{dz} = -\\left(\\frac{P_i m_i}{k_B T}\\right) g(z)\n$$\n这是一个一阶可分离微分方程。我们重新整理它以分离变量 $P_i$ 和 $z$：\n$$\n\\frac{dP_i}{P_i} = -\\frac{m_i g(z)}{k_B T} dz\n$$\n问题陈述我们正在研究一个狭窄的等温层，因此 $T$ 是常数。它还允许我们近似地认为引力加速度 $g$ 在局部海拔范围内是恒定的，具体来说是 $g(z) \\approx g(z_t)$。从参考高度 $z_0$ 积分到高度 $z$，得到：\n$$\n\\int_{P_i(z_0)}^{P_i(z)} \\frac{dP'_i}{P'_i} = -\\frac{m_i g}{k_B T} \\int_{z_0}^{z} dz'\n$$\n$$\n\\ln\\left(\\frac{P_i(z)}{P_i(z_0)}\\right) = -\\frac{m_i g}{k_B T} (z - z_0)\n$$\n对两边取指数，得到物种 $i$ 的压力剖面：\n$$\nP_i(z) = P_i(z_0) \\exp\\left(-\\frac{z - z_0}{\\frac{k_B T}{m_i g}}\\right)\n$$\n由于 $T$ 是常数，数密度剖面 $n_i(z) = P_i(z) / (k_B T)$ 具有相同的指数形式：\n$$\nn_i(z) = n_i(z_0) \\exp\\left(-\\frac{z - z_0}{\\frac{k_B T}{m_i g}}\\right)\n$$\n这就是所要求的局部物种特定的指数密度剖面。该剖面通常写作 $n_i(z) = n_i(z_0) \\exp\\left(-(z-z_0)/H_i\\right)$。通过比较这两种形式，我们确定与物种相关的标高 $H_i$：\n$$\nH_i = \\frac{k_B T}{m_i g}\n$$\n这个表达式表明，标高与物种的质量 $m_i$ 成反比。在热层中，扩散分离使得每个物种都能建立自己的标高。较轻的物种（较小的 $m_i$）将具有较大的标高 $H_i$，这意味着与较重的物种相比，其密度随高度增加而减小得更慢。这解释了为什么随着高度增加，大气从由较重物种（如分子氮，$m_{\\mathrm{N}_2} = 28\\,m_u$）主导过渡到由较轻物种（如原子氧，$m_{\\mathrm{O}} = 16\\,m_u$，并最终是氢）主导。\n\n现在，我们计算在过渡高度 $z_t = 4.00 \\times 10^5\\,\\mathrm{m}$ 处的原子氧标高 $H_{\\mathrm{O}}$ 的数值。首先，我们使用给定的公式和常数计算该高度处的引力加速度 $g(z_t)$：\n$M_p = 7.7636 \\times 10^{24}\\,\\mathrm{kg}$\n$R_p = 7.6452 \\times 10^{6}\\,\\mathrm{m}$\n$G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n$$\ng(z_t) = \\frac{G M_p}{(R_p + z_t)^2} = \\frac{(6.67430 \\times 10^{-11}) \\times (7.7636 \\times 10^{24})}{(7.6452 \\times 10^6 + 4.00 \\times 10^5)^2}\n$$\n$$\ng(z_t) = \\frac{5.181500348 \\times 10^{14}}{(8.0452 \\times 10^6)^2} = \\frac{5.181500348 \\times 10^{14}}{64.72524304 \\times 10^{12}} \\approx 8.005803\\,\\mathrm{m\\,s^{-2}}\n$$\n接下来，我们确定单个原子氧的质量 $m_{\\mathrm{O}}$：\n$m_u = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$\n$$\nm_{\\mathrm{O}} = 16\\,m_u = 16 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) = 2.65686250656 \\times 10^{-26}\\,\\mathrm{kg}\n$$\n最后，我们使用等温温度 $T = 1200\\,\\mathrm{K}$ 和玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 来计算标高 $H_{\\mathrm{O}}$：\n$$\nH_{\\mathrm{O}} = \\frac{k_B T}{m_{\\mathrm{O}} g(z_t)} = \\frac{(1.380649 \\times 10^{-23}) \\times 1200}{(2.65686250656 \\times 10^{-26}) \\times (8.005803)}\n$$\n$$\nH_{\\mathrm{O}} = \\frac{1.6567788 \\times 10^{-20}}{2.1269989 \\times 10^{-25}} \\approx 77892.80\\,\\mathrm{m}\n$$\n问题要求答案以公里为单位，并四舍五入到四位有效数字。\n$$\nH_{\\mathrm{O}} \\approx 77.89280\\,\\mathrm{km}\n$$\n四舍五入到四位有效数字得到 $77.89\\,\\mathrm{km}$。",
            "answer": "$$\n\\boxed{77.89}\n$$"
        }
    ]
}