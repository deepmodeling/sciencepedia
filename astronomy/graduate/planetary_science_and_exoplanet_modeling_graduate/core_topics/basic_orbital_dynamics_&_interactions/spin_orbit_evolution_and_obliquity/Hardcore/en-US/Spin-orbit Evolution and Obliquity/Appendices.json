{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the evolution of a planet's spin, we must first precisely describe its orientation in space. This exercise provides practice in this fundamental geometric task, starting from a planet's spin vector and its Keplerian orbital elements. By mastering the transformation from orbital elements like inclination $I$ and longitude of the ascending node $\\Omega$ to the orbital normal vector $\\hat{\\mathbf{n}}$, you will be able to compute the obliquity $\\epsilon$, a critical parameter in climate and tidal theory .",
            "id": "4178971",
            "problem": "A close-in super-Earth exoplanet orbits a Sun-like star. In the ecliptic inertial frame with orthonormal basis vectors $\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, and $\\hat{\\mathbf{z}}$ (with $\\hat{\\mathbf{z}}$ pointing toward the north ecliptic pole), the planet’s spin axis unit vector is measured to be $\\hat{\\mathbf{s}} = \\left(\\frac{1}{2}, 0, \\frac{\\sqrt{3}}{2}\\right)$. At epoch $t_{0}$, the planet’s osculating Keplerian orbital elements are $(a, e, I, \\Omega, \\omega) = (0.08\\,\\text{AU}, 0.10, \\pi/6, \\pi/3, \\pi/5)$. Starting from the definition that the orbital plane normal is parallel to the specific angular momentum vector $\\mathbf{h} = \\mathbf{r} \\times \\mathbf{v}$ and from the standard Euler-angle rotation construction of the orbital plane from the ecliptic frame, derive the orbital normal unit vector $\\hat{\\mathbf{n}}$ in the ecliptic frame and compute the obliquity $\\epsilon = \\arccos\\!\\left(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}}\\right)$ at the epoch $t_{0}$. Explicitly state your assumptions about nodal precession and whether $\\Omega$ and $I$ are treated as varying or fixed over the time interval of interest. Express the obliquity in radians and round your final numerical answer to four significant figures.",
            "solution": "The problem requires the calculation of the exoplanet's obliquity, $\\epsilon$, at a specific epoch $t_{0}$. This involves deriving the orbital normal unit vector, $\\hat{\\mathbf{n}}$, from the given osculating Keplerian elements and then computing the angle between $\\hat{\\mathbf{n}}$ and the given spin axis unit vector, $\\hat{\\mathbf{s}}$.\n\nFirst, regarding the requested assumptions: the problem provides the osculating orbital elements $(I, \\Omega)$ at the epoch $t_{0}$. The calculation of the obliquity at this single, specific instant in time means we treat these elements as fixed at their given values. The dynamic evolution of the orbit due to effects like nodal precession is not relevant for determining the geometric state of the system at epoch $t_{0}$. Therefore, $I$ and $\\Omega$ are considered constant for this calculation.\n\nThe orientation of the orbital plane with respect to the ecliptic reference frame is defined by two Euler angles: the inclination $I$ and the longitude of the ascending node $\\Omega$. The orbital normal unit vector $\\hat{\\mathbf{n}}$ is perpendicular to this plane. We can express $\\hat{\\mathbf{n}}$ in the ecliptic frame coordinates $(\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}})$.\n\nThe inclination, $I$, is the angle between the ecliptic plane's normal vector $\\hat{\\mathbf{z}}$ and the orbital plane's normal vector $\\hat{\\mathbf{n}}$. Therefore, their dot product is:\n$$ \\hat{\\mathbf{n}} \\cdot \\hat{\\mathbf{z}} = |\\hat{\\mathbf{n}}| |\\hat{\\mathbf{z}}| \\cos(I) = \\cos(I) $$\nGiven $\\hat{\\mathbf{n}} = (n_x, n_y, n_z)$, this directly gives the $z$-component as $n_z = \\cos(I)$.\n\nThe longitude of the ascending node, $\\Omega$, defines the direction of the line of nodes, which is the intersection of the orbital and ecliptic planes. A unit vector $\\hat{\\mathbf{N}}$ along the line of ascending nodes is given by $\\hat{\\mathbf{N}} = (\\cos(\\Omega), \\sin(\\Omega), 0)$. As this vector lies in the orbital plane, it must be perpendicular to the orbital normal $\\hat{\\mathbf{n}}$.\n\nThe projection of $\\hat{\\mathbf{n}}$ onto the ecliptic ($xy$) plane is the vector $(n_x, n_y, 0)$. Since $\\hat{\\mathbf{n}}$ is a unit vector, $n_x^2 + n_y^2 + n_z^2 = 1$. Substituting $n_z = \\cos(I)$, we find the magnitude of the projection to be $\\sqrt{n_x^2 + n_y^2} = \\sqrt{1 - \\cos^2(I)} = |\\sin(I)|$. For a prograde orbit, as indicated by $I = \\pi/6$ (where $0 \\leq I < \\pi/2$), this is $\\sin(I)$.\n\nFor a prograde orbit, the projection of the angular momentum vector $\\hat{\\mathbf{n}}$ onto the ecliptic plane leads the ascending node by an angle of $\\pi/2$. The azimuthal angle of this projection is therefore $\\Omega + \\pi/2$. This allows us to write the $x$ and $y$ components of $\\hat{\\mathbf{n}}$:\n$$n_x = \\sin(I) \\cos(\\Omega + \\pi/2) = -\\sin(I) \\sin(\\Omega)$$\n$$n_y = \\sin(I) \\sin(\\Omega + \\pi/2) = \\sin(I) \\cos(\\Omega)$$\nCombining the components, the orbital normal vector is:\n$$ \\hat{\\mathbf{n}} = (-\\sin(I) \\sin(\\Omega), \\sin(I) \\cos(\\Omega), \\cos(I)) $$\nWe are given the orbital elements $I = \\pi/6$ and $\\Omega = \\pi/3$. We calculate the trigonometric values:\n$$ \\sin(I) = \\sin(\\pi/6) = \\frac{1}{2} $$\n$$ \\cos(I) = \\cos(\\pi/6) = \\frac{\\sqrt{3}}{2} $$\n$$ \\sin(\\Omega) = \\sin(\\pi/3) = \\frac{\\sqrt{3}}{2} $$\n$$ \\cos(\\Omega) = \\cos(\\pi/3) = \\frac{1}{2} $$\nSubstituting these into the expression for $\\hat{\\mathbf{n}}$:\n$$ n_x = -\\left(\\frac{1}{2}\\right) \\left(\\frac{\\sqrt{3}}{2}\\right) = -\\frac{\\sqrt{3}}{4} $$\n$$ n_y = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4} $$\n$$ n_z = \\frac{\\sqrt{3}}{2} $$\nThus, the orbital normal unit vector is $\\hat{\\mathbf{n}} = \\left(-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}, \\frac{\\sqrt{3}}{2}\\right)$. The provided elements $a=0.08\\,\\text{AU}$, $e=0.10$, and $\\omega=\\pi/5$ are not needed for this part of the calculation.\n\nThe obliquity $\\epsilon$ is the angle between the spin axis $\\hat{\\mathbf{s}}$ and the orbital normal $\\hat{\\mathbf{n}}$, given by $\\epsilon = \\arccos(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}})$. The spin vector is given as $\\hat{\\mathbf{s}} = \\left(\\frac{1}{2}, 0, \\frac{\\sqrt{3}}{2}\\right)$. We compute the dot product:\n$$ \\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}} = \\left(\\frac{1}{2}\\right)\\left(-\\frac{\\sqrt{3}}{4}\\right) + (0)\\left(\\frac{1}{4}\\right) + \\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right) $$\n$$ \\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{n}} = -\\frac{\\sqrt{3}}{8} + 0 + \\frac{3}{4} = \\frac{6-\\sqrt{3}}{8} $$\nThe obliquity is therefore:\n$$ \\epsilon = \\arccos\\left(\\frac{6 - \\sqrt{3}}{8}\\right) $$\nTo find the numerical value, we compute the argument of the arccosine function:\n$$ \\frac{6 - \\sqrt{3}}{8} \\approx \\frac{6 - 1.7320508}{8} = \\frac{4.2679492}{8} \\approx 0.53349365 $$\nTaking the arccosine gives the obliquity in radians:\n$$ \\epsilon = \\arccos(0.53349365) \\approx 1.008433 \\text{ rad} $$\nRounding the result to four significant figures as requested yields $1.008$.",
            "answer": "$$\\boxed{1.008}$$"
        },
        {
            "introduction": "Tidal dissipation is a primary engine of spin-orbit evolution, driving planets toward synchronous rotation and circular orbits. This practice delves into the energetics of this process, asking you to calculate the total energy released as a rapidly spinning planet slows to a synchronized state . This calculation highlights the immense thermal power of tides, a crucial factor in the geological activity and potential habitability of many exoplanets, and provides a foundation for understanding how rotational energy is partitioned between interior heating and orbital expansion.",
            "id": "4178975",
            "problem": "A rigid, homogeneous exoplanet of mass $m_p$, radius $R_p$, and dimensionless moment of inertia factor $C$ orbits a star of mass $M_\\star$ on a circular orbit with orbital period $P_{\\mathrm{orb}}$. The planet begins with a prograde spin period $P_0$ and evolves tidally toward spin synchronization with the orbit, reaching a final spin rate equal to the orbital mean motion. Assume the following:\n\n- The planet’s principal moment of inertia is $I = C\\,m_p R_p^2$.\n- The orbit remains circular and the change in semi-major axis due to tides is negligible over the synchronization interval (i.e., tidal angular momentum exchange with the orbit is too small to appreciably modify $a$ or $P_{\\mathrm{orb}}$), so the mean motion $n$ can be treated as constant.\n- The spin axis is aligned with the orbital angular momentum (obliquity is effectively zero), so there is no precessional work.\n- Tidal dissipation is governed by frictional processes in the interior; you may treat the gravitational forcing as conservative and the interior as the only sink of mechanical energy.\n\nStarting from first principles of rotational dynamics and energy balance, derive the expression for the total energy dissipated internally during the spin evolution from initial angular velocity $\\Omega_0 = 2\\pi/P_0$ to final angular velocity $\\Omega_f = 2\\pi/P_{\\mathrm{orb}}$. Then, using the numerical values\n$m_p = 6.0 \\times 10^{24}\\,\\mathrm{kg}$, $R_p = 6.37 \\times 10^{6}\\,\\mathrm{m}$, $C = 0.33$, $P_0 = 8\\,\\mathrm{h}$, and $P_{\\mathrm{orb}} = 3\\,\\mathrm{d}$, compute the total dissipated energy. Express the final energy in $\\mathrm{J}$ and round your answer to four significant figures.\n\nFinally, discuss in words how, in more general cases where orbital evolution is not negligible, the dissipated energy partitions between interior heating and changes in orbital energy, indicating the role of tidal torques and the orbital mean motion in mediating the energy flow. Do not compute a numerical partition for this discussion.",
            "solution": "The problem asks for the total energy dissipated internally as a planet's spin evolves from an initial state to a final synchronous state. The system consists of the planet's rotational kinetic energy and its orbital energy. The total mechanical energy of the star-planet system is given by:\n$$\nE_{\\mathrm{total}} = E_{\\mathrm{rot}} + E_{\\mathrm{orb}}\n$$\nwhere $E_{\\mathrm{rot}}$ is the planet's rotational kinetic energy and $E_{\\mathrm{orb}}$ is the orbital energy of the planet.\n\nThe rotational kinetic energy of the planet is:\n$$\nE_{\\mathrm{rot}} = \\frac{1}{2}I\\Omega^2\n$$\nwhere $I = C m_p R_p^2$ is the planet's principal moment of inertia and $\\Omega$ is its angular spin velocity.\n\nThe problem states to assume that the orbit remains circular and the semi-major axis $a$ does not change. This implies that the orbital period $P_{\\mathrm{orb}}$ and the orbital mean motion $n = 2\\pi/P_{\\mathrm{orb}}$ are constant. Consequently, the orbital energy, $E_{\\mathrm{orb}} = -\\frac{G M_\\star m_p}{2a}$, is also constant.\n\nUnder this simplifying assumption, any change in the total mechanical energy of the system is solely due to the change in the planet's rotational kinetic energy:\n$$\n\\Delta E_{\\mathrm{total}} = \\Delta E_{\\mathrm{rot}} = E_{\\mathrm{rot, final}} - E_{\\mathrm{rot, initial}}\n$$\nThe problem specifies that tidal dissipation occurs internally. By the first law of thermodynamics, the energy dissipated as heat, $E_{\\mathrm{diss}}$, is equal to the negative of the change in the system's total mechanical energy:\n$$\nE_{\\mathrm{diss}} = -\\Delta E_{\\mathrm{total}} = -\\Delta E_{\\mathrm{rot}}\n$$\nThe initial state is characterized by an angular velocity $\\Omega_0 = 2\\pi/P_0$, and the final synchronous state has an angular velocity $\\Omega_f = n = 2\\pi/P_{\\mathrm{orb}}$. Substituting these into the energy expression:\n$$\nE_{\\mathrm{diss}} = -(E_{\\mathrm{rot, final}} - E_{\\mathrm{rot, initial}}) = E_{\\mathrm{rot, initial}} - E_{\\mathrm{rot, final}}\n$$\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2}I\\Omega_0^2 - \\frac{1}{2}I\\Omega_f^2 = \\frac{1}{2}I(\\Omega_0^2 - \\Omega_f^2)\n$$\nSubstituting the expressions for $I$, $\\Omega_0$, and $\\Omega_f$:\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2}(C m_p R_p^2) \\left[ \\left(\\frac{2\\pi}{P_0}\\right)^2 - \\left(\\frac{2\\pi}{P_{\\mathrm{orb}}}\\right)^2 \\right]\n$$\nFactoring out the common terms, we arrive at the final analytical expression for the dissipated energy:\n$$\nE_{\\mathrm{diss}} = 2\\pi^2 C m_p R_p^2 \\left( \\frac{1}{P_0^2} - \\frac{1}{P_{\\mathrm{orb}}^2} \\right)\n$$\nNow, we compute the numerical value using the provided data in SI units.\nGiven:\n$m_p = 6.0 \\times 10^{24}\\,\\mathrm{kg}$\n$R_p = 6.37 \\times 10^{6}\\,\\mathrm{m}$\n$C = 0.33$\n$P_0 = 8\\,\\mathrm{h} = 8 \\times 3600\\,\\mathrm{s} = 28800\\,\\mathrm{s}$\n$P_{\\mathrm{orb}} = 3\\,\\mathrm{d} = 3 \\times 24 \\times 3600\\,\\mathrm{s} = 259200\\,\\mathrm{s}$\n\nFirst, we calculate the planet's moment of inertia $I$:\n$$\nI = C m_p R_p^2 = (0.33) \\times (6.0 \\times 10^{24}\\,\\mathrm{kg}) \\times (6.37 \\times 10^{6}\\,\\mathrm{m})^2 = 8.0342346 \\times 10^{37}\\,\\mathrm{kg\\,m^2}\n$$\nNext, we calculate the initial and final angular velocities:\n$$\n\\Omega_0 = \\frac{2\\pi}{P_0} = \\frac{2\\pi}{28800\\,\\mathrm{s}}\n$$\n$$\n\\Omega_f = \\frac{2\\pi}{P_{\\mathrm{orb}}} = \\frac{2\\pi}{259200\\,\\mathrm{s}}\n$$\nNow, we can substitute these into the expression for $E_{\\mathrm{diss}}$:\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2}I(\\Omega_0^2 - \\Omega_f^2) = \\frac{1}{2}(8.0342346 \\times 10^{37}) \\left[ \\left(\\frac{2\\pi}{28800}\\right)^2 - \\left(\\frac{2\\pi}{259200}\\right)^2 \\right]\n$$\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2}(8.0342346 \\times 10^{37}) (4\\pi^2) \\left[ \\frac{1}{28800^2} - \\frac{1}{259200^2} \\right]\n$$\n$$\nE_{\\mathrm{diss}} = 2\\pi^2 (8.0342346 \\times 10^{37}) \\left[ \\frac{1}{8.2944 \\times 10^8} - \\frac{1}{6.718464 \\times 10^{10}} \\right]\n$$\n$$\nE_{\\mathrm{diss}} \\approx (1.585785 \\times 10^{39}) \\left[ (1.20563 \\times 10^{-9}) - (1.48844 \\times 10^{-11}) \\right]\n$$\n$$\nE_{\\mathrm{diss}} \\approx (1.585785 \\times 10^{39}) (1.19075 \\times 10^{-9})\n$$\n$$\nE_{\\mathrm{diss}} \\approx 1.88815 \\times 10^{30}\\,\\mathrm{J}\n$$\nRounding to four significant figures, the total dissipated energy is $1.888 \\times 10^{30}\\,\\mathrm{J}$.\n\nIn a more general case where orbital evolution is not negligible, the total mechanical energy $E = E_{\\mathrm{rot}} + E_{\\mathrm{orb}}$ is not conserved due to internal dissipation. The tidal torque $T$ exerted by the star on the planet changes the planet's rotational angular momentum $L_{\\mathrm{rot}} = I\\Omega$ at a rate $\\frac{dL_{\\mathrm{rot}}}{dt} = T$. By conservation of the total angular momentum of the isolated system, the planet's orbital angular momentum $L_{\\mathrm{orb}}$ must change at an equal and opposite rate: $\\frac{dL_{\\mathrm{orb}}}{dt} = -T$.\n\nThe rate of change of rotational energy is $\\frac{dE_{\\mathrm{rot}}}{dt} = \\Omega \\frac{dL_{\\mathrm{rot}}}{dt} = \\Omega T$. The rate of change of orbital energy for a nearly circular orbit can be shown to be related to the rate of change of orbital angular momentum by $\\frac{dE_{\\mathrm{orb}}}{dt} = n \\frac{dL_{\\mathrm{orb}}}{dt}$, where $n$ is the orbital mean motion. Substituting $\\frac{dL_{\\mathrm{orb}}}{dt} = -T$, we get $\\frac{dE_{\\mathrm{orb}}}{dt} = -nT$.\n\nThe total rate of change of mechanical energy is the sum of these two rates:\n$$\n\\frac{dE}{dt} = \\frac{dE_{\\mathrm{rot}}}{dt} + \\frac{dE_{\\mathrm{orb}}}{dt} = \\Omega T - n T = T(\\Omega - n)\n$$\nThe rate of energy dissipation as heat, $\\dot{E}_{\\mathrm{diss}}$, is the negative of the rate of change of the total mechanical energy:\n$$\n\\dot{E}_{\\mathrm{diss}} = -\\frac{dE}{dt} = -T(\\Omega - n)\n$$\nIn the case considered (prograde spin-down), the planet spins faster than it orbits ($\\Omega > n$). The tidal bulge raised on the planet by the star lags behind the line of centers, causing the star's gravity to exert a negative (spin-down) torque, so $T<0$. Consequently, $\\dot{E}_{\\mathrm{diss}} = -T(\\Omega - n)$ is positive, and energy is dissipated.\n\nThe energy lost from the planet's rotation, $-\\frac{dE_{\\mathrm{rot}}}{dt} = -\\Omega T$, is partitioned between two sinks. One part is dissipated as heat, $\\dot{E}_{\\mathrm{diss}} = -T(\\Omega - n)$. The other part goes into changing the orbital energy, $\\frac{dE_{\\mathrm{orb}}}{dt} = -nT$. For a spin-down case ($T<0$), $\\frac{dE_{\\mathrm{orb}}}{dt}$ is positive. Since orbital energy is negative ($E_{\\mathrm{orb}} = -G M_\\star m_p / 2a$), an increase in orbital energy corresponds to an increase in the semi-major axis $a$. Thus, the rotational energy of the planet is used to both heat its interior and push it into a higher orbit. The tidal torque $T$ mediates this exchange, while the ratio of the mean motion to the spin rate, $n/\\Omega$, determines the partitioning: the fraction of the extracted rotational power that goes into the orbit is $n/\\Omega$, and the fraction that becomes heat is $1 - n/\\Omega$.",
            "answer": "$$\n\\boxed{1.888 \\times 10^{30}}\n$$"
        },
        {
            "introduction": "Real planetary systems evolve under a complex interplay of forces, including tidal dissipation, spin precession, and external perturbations. This final practice challenges you to bridge the gap from isolated physical principles to a comprehensive, research-grade model by formulating the complete system of coupled differential equations that govern this evolution . Critically, it forces you to confront the numerical \"stiffness\" of the system—where fast precession and slow tidal damping occur simultaneously—and select an appropriate implicit integration scheme, a key skill for any computational planetary scientist.",
            "id": "4178978",
            "problem": "Consider a single close-in planet of mass $m$ and radius $R$ orbiting a star of mass $M_\\star$ with semi-major axis $a$, eccentricity $e$, and mean motion $n(a)=\\sqrt{G(M_\\star+m)/a^3}$. Let $\\boldsymbol{\\Omega}$ be the planet’s spin vector, $\\mathbf{S}=C\\,\\boldsymbol{\\Omega}$ its spin angular momentum with $C=\\lambda m R^2$ where $\\lambda$ is the dimensionless moment-of-inertia factor, and let the orbit-normal be the unit vector $\\hat{\\mathbf{l}}$ so that the orbital angular momentum is $\\mathbf{L}=m\\sqrt{G(M_\\star+m)\\,a(1-e^2)}\\,\\hat{\\mathbf{l}}$. Define the obliquity $\\epsilon$ by $\\cos\\epsilon=\\hat{\\mathbf{s}}\\cdot\\hat{\\mathbf{l}}$ where $\\hat{\\mathbf{s}}=\\boldsymbol{\\Omega}/\\|\\boldsymbol{\\Omega}\\|$. Assume the following foundational ingredients only:\n- Newton’s law for rotational dynamics, $\\mathbf{T}=d\\mathbf{S}/dt$, and for orbital angular momentum, $\\mathbf{T}_{\\text{on orbit}}=d\\mathbf{L}/dt$.\n- The orbit-averaged equilibrium tide with constant time lag (CTL), parameterized by the Love number $k_2$ and lag $\\Delta t$, which produces a dissipative torque proportional to $k_2\\Delta t$ and to appropriate combinations of $\\boldsymbol{\\Omega}$, $n$, $\\hat{\\mathbf{l}}$, and powers of $e$. The CTL averaging yields smooth, positive functions of $e$, here denoted $f_i(e)$ and $\\Xi_i(e,\\cdot)$, that are of order unity for $e\\lesssim 1$.\n- A conservative spin precession torque from the stellar gravity acting on the planet’s rotational quadrupole that makes $\\mathbf{S}$ precess about $\\hat{\\mathbf{l}}$ with precession constant $\\alpha(a,\\Omega)>0$, and a prescribed orbital-plane precession vector $\\mathbf{g}(t)$ due to external perturbations so that, in the absence of dissipation, $d\\hat{\\mathbf{l}}/dt=\\mathbf{g}\\times\\hat{\\mathbf{l}}$.\n\nThe coupled spin-orbit evolution under these torques is stiff because the conservative spin precession frequency $\\sim \\alpha$ and possible fast nodal precession $\\sim \\|\\mathbf{g}\\|$ can be much larger than the slow tidal damping rates that govern $a$, $e$, and $\\epsilon$.\n\nWhich option below gives a scientifically consistent compact vector formulation for the stiff system of orbit-averaged ordinary differential equations, together with an implicit time integration strategy that is appropriate for widely separated timescales and properly maintains the unit-length of $\\hat{\\mathbf{l}}$ and $\\hat{\\mathbf{s}}$?\n\nA. Use the following vector system with CTL tides acting only on the planet, conservative precession of $\\mathbf{S}$ about $\\hat{\\mathbf{l}}$, and orbital-plane precession $\\mathbf{g}(t)$:\n- Define the CTL torque amplitude $K(a)=3 G M_\\star^2 k_2 R^5 \\Delta t/a^6$ and decompose $\\boldsymbol{\\Omega}$ into components parallel and perpendicular to $\\hat{\\mathbf{l}}$, $\\Omega_\\parallel=(\\boldsymbol{\\Omega}\\cdot\\hat{\\mathbf{l}})$ and $\\boldsymbol{\\Omega}_\\perp=\\boldsymbol{\\Omega}-\\Omega_\\parallel\\hat{\\mathbf{l}}$.\n- Let the dissipative tidal torque on the spin be\n$$\n\\mathbf{T}_{\\text{tide}}=-K(a)\\Big[f_\\perp(e)\\,\\boldsymbol{\\Omega}_\\perp+f_\\parallel(e)\\,\\big(\\Omega_\\parallel - n(a)\\,f_n(e)\\big)\\,\\hat{\\mathbf{l}}\\Big],\n$$\nwhere $f_\\perp(e)$, $f_\\parallel(e)$, and $f_n(e)$ are the standard orbit-averaged CTL functions.\n- Let the conservative spin precession torque be\n$$\n\\mathbf{T}_{\\text{prec}}=\\alpha(a,\\Omega)\\,(\\mathbf{S}\\cdot\\hat{\\mathbf{l}})\\,(\\mathbf{S}\\times\\hat{\\mathbf{l}})/\\|\\mathbf{S}\\|.\n$$\n- The coupled equations are\n$$\n\\frac{d\\mathbf{S}}{dt}=\\mathbf{T}_{\\text{prec}}+\\mathbf{T}_{\\text{tide}},\\qquad\n\\frac{d\\hat{\\mathbf{l}}}{dt}=\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}+\\frac{1}{\\|\\mathbf{L}\\|}\\,\\hat{\\mathbf{l}}\\times\\big(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}}\\big),\n$$\nand the semi-major axis and eccentricity evolve under the CTL scalars\n$$\n\\frac{da}{dt}=-\\frac{K(a)}{m\\,n(a)\\,a}\\,\\Xi_a\\!\\Big(e,\\frac{\\Omega_\\parallel}{n(a)}\\Big),\\qquad\n\\frac{de}{dt}=-\\frac{K(a)}{m\\,n(a)\\,a^2}\\,\\Xi_e\\!\\Big(e,\\frac{\\Omega_\\parallel}{n(a)}\\Big),\n$$\nwith $\\|\\mathbf{L}\\|=m\\sqrt{G(M_\\star+m)\\,a(1-e^2)}$. This closes the system in the state $\\mathbf{y}=(\\mathbf{S},\\hat{\\mathbf{l}},a,e)$.\n- Integrate with a variable-order backward differentiation formula (BDF) method of order $k\\in\\{1,2,\\dots,5\\}$, fully implicit in all terms, using Newton iterations with a block Jacobian that treats $(\\mathbf{S},\\hat{\\mathbf{l}},a,e)$ simultaneously. Enforce the unit constraints by projecting $\\hat{\\mathbf{l}}\\mapsto \\hat{\\mathbf{l}}/\\|\\hat{\\mathbf{l}}\\|$ and $\\hat{\\mathbf{s}}\\mapsto \\hat{\\mathbf{s}}/\\|\\hat{\\mathbf{s}}\\|$ after each converged step, or equivalently by augmenting with algebraic constraints to form a differential-algebraic system and solving with a Jacobian that includes the constraint rows. Control steps with a local truncation error estimator to bridge the fast precession scales $\\sim \\alpha$ and $\\|\\mathbf{g}\\|$ and the slow tidal scales.\n\nB. Use the following decoupled scalars and an explicit integrator:\n- Evolve only the magnitudes with\n$$\n\\frac{d\\Omega}{dt}=-\\gamma\\big(\\Omega-n\\big),\\quad \\frac{d\\epsilon}{dt}=-\\gamma'\\sin\\epsilon,\\quad \\frac{da}{dt}=-\\eta\\,a,\\quad \\frac{de}{dt}=-\\eta'\\,e,\n$$\nwhere $\\gamma$, $\\gamma'$, $\\eta$, and $\\eta'$ are positive constants, and keep $\\hat{\\mathbf{l}}$ fixed in inertial space.\n- Integrate with a fixed-step explicit Runge–Kutta of order $4$ and reduce the step size until stability is observed.\n\nC. Use a symplectic leapfrog for the entire system and a conservative precession torque of the form\n$$\n\\frac{d\\mathbf{S}}{dt}=-\\alpha\\,\\hat{\\mathbf{s}}\\times\\hat{\\mathbf{l}},\\qquad \\frac{d\\mathbf{L}}{dt}=+\\alpha\\,\\hat{\\mathbf{s}}\\times\\hat{\\mathbf{l}},\n$$\nwith tidal dissipation represented by periodic impulsive kicks that reduce $\\|\\mathbf{S}\\|$ and $a$ discretely after every $N$ steps, keeping $e$ constant. Assume $\\hat{\\mathbf{l}}$ does not precess unless tides act.\n\nD. Use the vector spin equation with precession and tides, but let the orbit evolve only by a prescribed precession $\\mathbf{g}(t)$ and keep $a$ and $e$ constant:\n$$\n\\frac{d\\mathbf{S}}{dt}=\\alpha(\\mathbf{S}\\cdot\\hat{\\mathbf{l}})\\,(\\mathbf{S}\\times\\hat{\\mathbf{l}})/\\|\\mathbf{S}\\| - K(a)\\,\\boldsymbol{\\Omega},\\qquad \\frac{d\\hat{\\mathbf{l}}}{dt}=\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}.\n$$\nIntegrate with an implicit midpoint rule applied only to the precession terms, leaving the tidal term explicit, and do not enforce the unit norms of $\\hat{\\mathbf{l}}$ or $\\hat{\\mathbf{s}}$ since drift is small for sufficiently small steps.",
            "solution": "The problem requires constructing a system of ordinary differential equations (ODEs) for the state vector $(\\mathbf{S}, \\hat{\\mathbf{l}}, a, e)$ and identifying an appropriate numerical integrator for this stiff system.\n\n### 1. Governing Equations\nThe evolution of the system is governed by torques.\n- **Spin Evolution**: The rate of change of the spin angular momentum $\\mathbf{S}$ is the sum of the conservative precession torque $\\mathbf{T}_{\\text{prec}}$ and the dissipative tidal torque $\\mathbf{T}_{\\text{tide}}$.\n  $$ \\frac{d\\mathbf{S}}{dt} = \\mathbf{T}_{\\text{prec}} + \\mathbf{T}_{\\text{tide}} $$\n- **Orbital Evolution**: The rate of change of the orbital angular momentum $\\mathbf{L}$ is the sum of the torque from external perturbers $\\mathbf{T}_{\\text{ext}}$ and the back-reaction from the planetary tides, which is $-\\mathbf{T}_{\\text{tide}}$ by Newton's third law.\n  $$ \\frac{d\\mathbf{L}}{dt} = \\mathbf{T}_{\\text{ext}} - \\mathbf{T}_{\\text{tide}} $$\n  The external perturbation is given as generating a precession $d\\hat{\\mathbf{l}}/dt|_{\\text{ext}} = \\mathbf{g}(t)\\times\\hat{\\mathbf{l}}$.\n\nFrom $\\mathbf{L} = L\\hat{\\mathbf{l}}$, we have $d\\mathbf{L}/dt = (dL/dt)\\hat{\\mathbf{l}} + L(d\\hat{\\mathbf{l}}/dt)$. The change in the direction of the orbit normal $\\hat{\\mathbf{l}}$ is driven by the component of the total torque perpendicular to $\\mathbf{L}$.\n$$ L\\frac{d\\hat{\\mathbf{l}}}{dt} = \\left(\\frac{d\\mathbf{L}}{dt}\\right)_\\perp = \\left(\\mathbf{T}_{\\text{ext}} - \\mathbf{T}_{\\text{tide}}\\right)_\\perp $$\n$$ \\frac{d\\hat{\\mathbf{l}}}{dt} = \\frac{(\\mathbf{T}_{\\text{ext}})_\\perp}{L} - \\frac{(\\mathbf{T}_{\\text{tide}})_\\perp}{L} $$\nThe external part is given as $\\mathbf{g}(t)\\times\\hat{\\mathbf{l}}$. The component of any vector $\\mathbf{V}$ perpendicular to $\\hat{\\mathbf{l}}$ can be written as $\\mathbf{V}_\\perp = \\hat{\\mathbf{l}}\\times(\\mathbf{V}\\times\\hat{\\mathbf{l}})$. Thus, the tidal contribution is $-\\frac{1}{L}\\hat{\\mathbf{l}}\\times(\\mathbf{T}_{\\text{tide}}\\times\\hat{\\mathbf{l}})$.\n\n- **Evolution of $a$ and $e$**: The semi-major axis $a$ and eccentricity $e$ evolve due to the dissipative work done by tides. Their evolution is derived from the rates of change of orbital energy and the magnitude of the orbital angular momentum. In the orbit-averaged CTL framework, these are given by scalar ODEs involving functions $\\Xi_a$ and $\\Xi_e$ which depend on $e$ and the ratio of the planet's spin component along the orbit normal, $\\Omega_\\parallel = \\boldsymbol{\\Omega}\\cdot\\hat{\\mathbf{l}}$, to the mean motion $n$.\n\n### 2. Numerical Integration Strategy\nThe problem is identified as \"stiff\". This is a critical property dictating the choice of numerical method.\n- **Stiffness**: Stiffness arises when a system has processes occurring on vastly different timescales. Here, the fast timescales are spin precession and orbital precession ($\\sim 1/\\alpha, \\sim 1/\\|\\mathbf{g}\\|$), while the slow timescale is tidal evolution.\n- **Explicit Integrators (e.g., Runge-Kutta)**: These methods are conditionally stable. To maintain stability, their step size must be constrained by the *fastest* timescale in the system, i.e., $\\Delta t \\lesssim 1/\\alpha$. This makes them prohibitively expensive for simulating the long-term evolution governed by the slow tides.\n- **Implicit Integrators (e.g., BDF, Radau)**: These methods have much larger stability regions. A-stable or L-stable methods can take time steps comparable to the slow timescale of interest ($\\Delta t \\gg 1/\\alpha$) while remaining numerically stable. Each step requires solving a (typically non-linear) system of algebraic equations, often via Newton's method, which is computationally more expensive per step but allows for much larger steps, leading to immense overall speedup for stiff problems.\n- **Constraint Preservation**: The vectors $\\hat{\\mathbf{s}}$ and $\\hat{\\mathbf{l}}$ must maintain unit length. Numerical methods can cause these lengths to drift. This must be handled, either by projecting the vectors back to the unit sphere after each step or by treating the constraints as algebraic equations within a Differential-Algebraic Equation (DAE) framework. Both are valid approaches.\n\n## Option-by-Option Analysis\n\n**A. Use the following vector system with CTL tides...**\n- **Physical Model**:\n  - The equation for $d\\mathbf{S}/dt$ correctly includes a standard precession torque and the standard form for the orbit-averaged CTL tidal torque, decomposing the spin into components parallel and perpendicular to the orbit normal.\n  - The equation for $d\\hat{\\mathbf{l}}/dt$ correctly includes the external precession and a term for the tidal back-reaction on the orbit's orientation.\n  - The equations for $da/dt$ and $de/dt$ are the standard, correct forms for CTL tidal evolution.\n  - Overall, this represents a physically comprehensive and state-of-the-art model for the coupled spin-orbit evolution.\n- **Numerical Method**:\n  - It proposes a variable-order backward differentiation formula (BDF) method, an excellent choice for stiff ODEs.\n  - It correctly describes the need for a fully implicit solver using Newton iterations on the entire coupled system.\n  - It correctly identifies the need to maintain unit-vector constraints and proposes standard, valid methods (projection or DAE formulation).\n  - The strategy correctly aims to \"bridge the fast precession scales... and the slow tidal scales.\"\n- **Verdict**: **Correct**. This option presents a comprehensive and physically consistent model, paired with a state-of-the-art numerical method appropriate for stiff, constrained differential equations.\n\n**B. Use the following decoupled scalars and an explicit integrator...**\n- **Physical Model**: The equations are vast oversimplifications. They are decoupled, ignoring fundamental couplings. The linear damping laws are ad-hoc and not derived from the specified CTL model. Fixing $\\hat{\\mathbf{l}}$ in space is factually incorrect.\n- **Numerical Method**: It proposes an explicit Runge-Kutta method, which is unsuitable and highly inefficient for stiff systems.\n- **Verdict**: **Incorrect**. Both the physical model and the numerical method are fundamentally flawed.\n\n**C. Use a symplectic leapfrog for the entire system...**\n- **Physical Model**: The precession torque formulation is incorrect. A symplectic method is designed for conservative systems, but this problem is fundamentally dissipative. Representing tides as \"impulsive kicks\" is a valid approach in some contexts, but pairing it with a symplectic integrator for the whole system is ill-suited.\n- **Numerical Method**: A symplectic integrator's main advantage (preservation of Hamiltonian structure) is lost in a dissipative system. It is not the appropriate tool.\n- **Verdict**: **Incorrect**. The numerical method is poorly chosen, and the physical model contains significant errors.\n\n**D. Use the vector spin equation... and keep $a$ and $e$ constant...**\n- **Physical Model**: Keeping $a$ and $e$ constant ignores a crucial part of the tidal evolution. The tidal torque is oversimplified, and tidal feedback on the orbit's orientation is neglected.\n- **Numerical Method**: It proposes a semi-implicit method, which can be a valid approach. However, it fatally suggests *not* enforcing the unit norms. In any long-term integration, this will lead to a catastrophic failure of the model. The justification that \"drift is small for sufficiently small steps\" is self-defeating, as the point of a stiff integrator is to take large steps.\n- **Verdict**: **Incorrect**. The physical model is incomplete, and the numerical strategy contains a critical flaw.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}