{
    "hands_on_practices": [
        {
            "introduction": "在深入研究 N 体问题复杂的动力学之前，我们必须首先建立一个有效的数学框架。雅可比坐标系通过将系统分层分解为一系列二体问题，极大地简化了运动方程，是将平动自由度从系统中分离出来的标准方法。本练习  旨在通过一个三体系统的具体计算，让您亲手实践这一基础坐标变换，这对于后续的解析理论推导和数值模拟算法的构建都至关重要。",
            "id": "4168043",
            "problem": "考虑一个恒星-行星系统，其中三颗行星被建模为一个相互作用的子系统，它们的坐标是在仅包含行星子系统（不包括主恒星）的质心参考系中给出的。设这三颗行星在某一固定历元的质量分别为 $m_{1}$、$m_{2}$、$m_{3}$，质心位置矢量分别为 $\\mathbf{X}_{1}$、$\\mathbf{X}_{2}$、$\\mathbf{X}_{3}$。假设行星子系统的质心约束成立，即三颗行星的质心（COM）位于原点，因此 $\\sum_{i=1}^{3} m_{i} \\mathbf{X}_{i} = \\mathbf{0}$。仅使用牛顿力学（平移不变性及质心定义），为这个三体子系统构建分层相对坐标以消除全局平移自由度，并定义相应的两个雅可比坐标。然后，根据以下物理上合理的数据，计算这些雅可比坐标的数值，并验证其满足分层质量加权定义：\n\n- 质量（以太阳质量为单位）：$m_{1} = 1.5 \\times 10^{-3}$，$m_{2} = 4.0 \\times 10^{-4}$，$m_{3} = 1.0 \\times 10^{-3}$。\n- 质心位置（以天文单位 AU 为单位）：$\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00)$，$\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00)$，$\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00)$。\n\n使用质心定义构建分层坐标，推导回 $\\mathbf{X}_{i}$ 的逆映射，并明确检验给定的 $\\mathbf{X}_{i}$ 是否能被还原。最后，将两个雅可比矢量以包含六个分量 $(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z})$ 的单个行矩阵形式报告。\n\n将您的数值条目四舍五入至四位有效数字。坐标以天文单位（AU）表示。最终答案必须仅为行矩阵，方框内不含单位。",
            "solution": "基础出发点是牛顿力学中的平移不变性以及质心（COM）的定义。对于质量为 $m_{i}$、惯性位置为 $\\mathbf{X}_{i}$ 的一组天体，其质心定义为\n$$\n\\mathbf{C} = \\frac{\\sum_{i} m_{i} \\mathbf{X}_{i}}{\\sum_{i} m_{i}}.\n$$\n在行星子系统的质心参考系中，三颗行星的 $\\mathbf{C} = \\mathbf{0}$，因此\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0}.\n$$\n雅可比坐标是为消除全局平移并反映质量加权分层结构而构建的分层相对坐标。对于三体问题，我们在每一步中使用前 $k$ 个天体的质心来定义两个雅可比矢量。\n\n首先，定义天体1和2的部分质心：\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}}, \\quad \\text{其中} \\quad M_{12} = m_{1} + m_{2}.\n$$\n那么，该三体子系统的两个雅可比矢量定义为\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1},\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12}.\n$$\n这些定义直接源于对质心的分层使用：第一个矢量是天体2相对于天体1的相对坐标，第二个矢量是天体3相对于天体1和2的质心的位置。\n\n我们还推导了从 $\\mathbf{y}_{1}$ 和 $\\mathbf{y}_{2}$ 到质心位置 $\\mathbf{X}_{i}$ 的逆映射。使用 $\\mathbf{X}_{2} = \\mathbf{X}_{1} + \\mathbf{y}_{1}$ 以及 $\\mathbf{C}_{12}$ 的定义，\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}\n\\quad \\Rightarrow \\quad\n(m_{1} + m_{2}) \\mathbf{X}_{1} + m_{2} \\mathbf{y}_{1} = M_{12} \\mathbf{C}_{12},\n$$\n这给出\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad\n\\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}.\n$$\n对于第三个天体，\n$$\n\\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12}.\n$$\n如果三体质心位于原点，那么\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0},\n$$\n这与上述定义是一致的，因为 $m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}$，因此\n$$\nM_{12} \\mathbf{C}_{12} + m_{3} (\\mathbf{y}_{2} + \\mathbf{C}_{12}) = (M_{12} + m_{3}) \\mathbf{C}_{12} + m_{3} \\mathbf{y}_{2}.\n$$\n在一个严格的子性质心参考系中，$\\mathbf{C} = \\mathbf{0}$，而选择 $\\mathbf{y}_{2}$ 相对于 $\\mathbf{C}_{12}$ 既保留了平移不变性，又提供了分层的质量加权。\n\n现在我们根据给定数据计算所需量。\n\n给定质量：\n$$\nm_{1} = 1.5 \\times 10^{-3}, \\quad m_{2} = 4.0 \\times 10^{-4}, \\quad m_{3} = 1.0 \\times 10^{-3},\n$$\n以及质心位置（以天文单位为单位）：\n$$\n\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00), \\quad\n\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00), \\quad\n\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00).\n$$\n首先，验证质心约束：\n$$\nm_{1} \\mathbf{X}_{1} = (0.0015 \\cdot 0.50,\\, 0.0015 \\cdot 0.10,\\, 0) = (0.00075,\\, 0.00015,\\, 0),\n$$\n$$\nm_{2} \\mathbf{X}_{2} = (0.0004 \\cdot (-0.20),\\, 0.0004 \\cdot 0.40,\\, 0) = (-0.00008,\\, 0.00016,\\, 0),\n$$\n$$\nm_{3} \\mathbf{X}_{3} = (0.001 \\cdot (-0.67),\\, 0.001 \\cdot (-0.31),\\, 0) = (-0.00067,\\, -0.00031,\\, 0).\n$$\n求和得，\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = (0.00075 - 0.00008 - 0.00067,\\, 0.00015 + 0.00016 - 0.00031,\\, 0) = (0,\\, 0,\\, 0),\n$$\n因此质心位于原点。\n\n计算天体1和2的部分质心：\n$$\nM_{12} = m_{1} + m_{2} = 1.5 \\times 10^{-3} + 4.0 \\times 10^{-4} = 1.9 \\times 10^{-3},\n$$\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}} \n= \\frac{(0.00075 - 0.00008,\\, 0.00015 + 0.00016,\\, 0)}{0.0019}\n= \\frac{(0.00067,\\, 0.00031,\\, 0)}{0.0019}.\n$$\n数值上，\n$$\n\\mathbf{C}_{12} \\approx (0.3526315789,\\, 0.1631578947,\\, 0).\n$$\n计算雅可比矢量：\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1} = (-0.20 - 0.50,\\, 0.40 - 0.10,\\, 0.00 - 0.00) = (-0.70,\\, 0.30,\\, 0.00),\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12} = (-0.67 - 0.3526315789,\\, -0.31 - 0.1631578947,\\, 0.00 - 0.00).\n$$\n因此，\n$$\n\\mathbf{y}_{2} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0.00).\n$$\n将每个分量四舍五入至四位有效数字（以天文单位为单位）：\n$$\n\\mathbf{y}_{1} \\to (-0.7000,\\, 0.3000,\\, 0.0000), \\quad\n\\mathbf{y}_{2} \\to (-1.023,\\, -0.4732,\\, 0.0000).\n$$\n通过从 $\\mathbf{y}_{1}$、$\\mathbf{y}_{2}$ 和 $\\mathbf{C}_{12}$ 重构 $\\mathbf{X}_{i}$ 来验证分层质量加权定义。使用\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12},\n$$\n并利用 $m_{2}/M_{12} = \\frac{4.0 \\times 10^{-4}}{1.9 \\times 10^{-3}} \\approx 0.2105263158$ 和 $m_{1}/M_{12} \\approx 0.7894736842$，我们得到\n$$\n\\mathbf{X}_{1} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) - 0.2105263158 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 + 0.1473684211,\\, 0.1631578947 - 0.0631578947,\\, 0)\n= (0.50,\\, 0.10,\\, 0),\n$$\n$$\n\\mathbf{X}_{2} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) + 0.7894736842 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 - 0.5526315789,\\, 0.1631578947 + 0.2368421053,\\, 0)\n= (-0.20,\\, 0.40,\\, 0),\n$$\n$$\n\\mathbf{X}_{3} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0) + (0.3526315789,\\, 0.1631578947,\\, 0)\n= (-0.67,\\, -0.31,\\, 0).\n$$\n因此，分层质量加权定义得到满足，并且逆映射还原了原始的质心位置。\n\n按要求，最终答案是两个雅可比矢量分量的单个行矩阵，四舍五入到四位有效数字，单位为天文单位（AU）：\n$$\n(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z}) = (-0.7000,\\, 0.3000,\\, 0.0000,\\, -1.023,\\, -0.4732,\\, 0.0000).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.7000  0.3000  0.0000  -1.023  -0.4732  0.0000\\end{pmatrix}}$$"
        },
        {
            "introduction": "行星系统的长期演化在很大程度上是由行星间的引力相互作用驱动的，其中近距离遭遇是塑造系统结构的决定性事件。这些遭遇可能导致行星被弹出系统、轨道被大幅改变，甚至发生直接碰撞。本练习  要求您将牛顿引力定律和双体问题的双曲线轨道理论转化为一个可执行的计算机程序，模拟一次这样的遭遇。通过这个实践，您将掌握如何计算最近接近距离，并基于撞击参数和逃逸速度等关键物理量来评估遭遇的最终结果，这是行星动力学数值研究的核心技能之一。",
            "id": "4168034",
            "problem": "在行星科学中，一个双体引力相遇问题可以在牛顿引力下，在约化质量的相对参考系中进行有效分析。考虑两个被视为均匀球体的行星，它们具有物理半径且不存在耗散力。这种相互作用被建模为一条开普勒双曲线轨道，其特征由无穷远处的相对速度和碰撞参数决定。目标是计算相遇过程中行星中心之间的最小接近距离，并评估是否发生物理碰撞，或者结果是否为非碰撞的引力散射。评估将使用接触半径处的逃逸速度和球体的半径。\n\n您必须实现一个完整的程序，该程序针对一组指定的测试用例，为每个用例返回最小接近距离和两个逻辑评估：根据精确的近心点计算是否发生碰撞，以及根据由逃逸速度和物理半径推导出的引力聚焦阈值是否会预测发生碰撞。\n\n所有量必须使用国际单位制 (SI) 处理。距离必须以米表示，速度以米/秒表示，质量以千克表示，引力常数以 SI 单位表示。角度不是必需的。距离的最终数值输出必须以米为单位。布尔值必须以编程语言原生的 true 或 false 值提供。\n\n基本假设和定义：\n- 适用牛顿万有引力定律：引力常数为 $G$，其中 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$。\n- 使用二体问题约化方法，总质量为 $M = m_1 + m_2$，约化质量为 $\\mu_{\\mathrm{red}} = \\frac{m_1 m_2}{m_1 + m_2}$，引力参数为 $\\mu = G M$。\n- 无穷远处的入射相对速度为 $v_{\\infty} > 0$，碰撞参数为 $b \\ge 0$。比轨道能量（单位约化质量）为 $E = \\frac{v_{\\infty}^{2}}{2}$，比角动量（单位约化质量）为 $h = b\\,v_{\\infty}$。\n- 相对轨道是双曲线，其离心率为 $e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$。\n- 最小接近距离（双曲线轨道的近心点）由 $r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$ 给出。\n- 物理接触阈值为 $R_{\\mathrm{tot}} = R_1 + R_2$，其中 $R_1$ 和 $R_2$ 是两个行星的物理半径。当且仅当 $r_{\\min} \\le R_{\\mathrm{tot}}$ 时，发生碰撞。\n- 在接触距离处定义的逃逸速度为 $v_{\\mathrm{esc}}(R_{\\mathrm{tot}}) = \\sqrt{\\frac{2 \\mu}{R_{\\mathrm{tot}}}}$。引力聚焦产生一个临界碰撞参数\n$$\nb_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{v_{\\mathrm{esc}}^{2}(R_{\\mathrm{tot}})}{v_{\\infty}^{2}}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}.\n$$\n当且仅当 $b \\le b_{\\mathrm{crit}}$ 时，聚焦阈值预测会发生碰撞。\n\n程序要求：\n- 对于每个测试用例，计算以米为单位的 $r_{\\min}$、定义为 $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$ 的碰撞布尔值 $C_{\\mathrm{peri}}$，以及定义为 $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$ 的引力聚焦布尔值 $C_{\\mathrm{foc}}$。\n- 严格按照上述公式进行计算，除基本假设中明确定义的公式外，不使用任何捷径公式。\n\n测试套件：\n为以下五个测试用例提供计算。每个用例指定了 $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$：\n\n1. 类地行星的正常路径散射情况：\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$。\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$。\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$。\n   - $b = 5.0 \\times 10^{7}\\ \\mathrm{m}$。\n\n2. 木星-地球相遇在引力聚焦阈值处的边界情况：\n   - $m_1 = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R_1 = 6.9911 \\times 10^{7}\\ \\mathrm{m}$。\n   - $m_2 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 6.371 \\times 10^{6}\\ \\mathrm{m}$。\n   - $v_{\\infty} = 2.0 \\times 10^{4}\\ \\mathrm{m/s}$。\n   - $b$ 定义为等于根据上述公式为这些参数计算出的 $b_{\\mathrm{crit}}$。\n\n3. 两个超级地球的正面相遇：\n   - $m_1 = 8.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 8.0 \\times 10^{6}\\ \\mathrm{m}$。\n   - $m_2 = 6.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 7.0 \\times 10^{6}\\ \\mathrm{m}$。\n   - $v_{\\infty} = 1.0 \\times 10^{3}\\ \\mathrm{m/s}$。\n   - $b = 0$。\n\n4. 冰巨星之间的高速近距离飞掠：\n   - $m_1 = 1.02413 \\times 10^{26}\\ \\mathrm{kg}$, $R_1 = 2.4622 \\times 10^{7}\\ \\mathrm{m}$。\n   - $m_2 = 8.6810 \\times 10^{25}\\ \\mathrm{kg}$, $R_2 = 2.5362 \\times 10^{7}\\ \\mathrm{m}$。\n   - $v_{\\infty} = 1.0 \\times 10^{5}\\ \\mathrm{m/s}$。\n   - $b = 1.0 \\times 10^{8}\\ \\mathrm{m}$。\n\n5. 针对测试用例1中类地行星情况，碰撞参数略高于聚焦阈值的边缘情况：\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$。\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$。\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$。\n   - $b$ 定义为 $b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$，其中 $b_{\\mathrm{crit}}$ 是为这些参数计算得出的，因此近心点刚好在接触阈值之上。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例的结果，其本身也是一个形式为 $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$ 的列表。例如，输出必须采用格式 $[[r_{\\min,1}, C_{\\mathrm{peri},1}, C_{\\mathrm{foc},1}], [r_{\\min,2}, C_{\\mathrm{peri},2}, C_{\\mathrm{foc},2}], \\dots]$，其中 $r_{\\min,i}$ 以米为单位，布尔值以该语言的原生格式给出。不得打印任何额外文本。",
            "solution": "该问题被评估为**有效**。它在科学上基于牛顿天体力学，内容自洽，且在算法上是适定的。所提供的二体问题公式是标准且正确的。测试用例在物理上是现实的，并包含了精心选择的边界和边缘情况，以测试实现的鲁棒性。该问题要求计算两个碰撞判据，一个基于近心点距离，另一个基于引力聚焦碰撞参数。如下文所示，这两个判据在数学上是等价的，这为任何正确的实现提供了一个极好的内部一致性检查。\n\n解决方案的流程是为每个测试用例实现指定的公式。引力常数为 $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$。\n\n对于由质量 $m_1$ 和 $m_2$、物理半径 $R_1$ 和 $R_2$、无穷远处相对速度 $v_{\\infty}$ 以及碰撞参数 $b$ 指定的每个测试用例，我们执行以下计算：\n\n1.  **系统参数**：首先，我们计算二体系统的参数。\n    -   总质量：$M = m_1 + m_2$。\n    -   系统的引力参数：$\\mu = G M$。该参数决定了引力相互作用的强度。\n    -   接触的总物理半径：$R_{\\mathrm{tot}} = R_1 + R_2$。如果两个天体中心的距离接近到小于或等于此值，则发生碰撞。\n\n2.  **轨道参数**：接下来，我们描述相对运动的双曲线轨道的特征。\n    -   比轨道能量（单位约化质量）：$E = \\frac{v_{\\infty}^{2}}{2}$。由于 $v_{\\infty} > 0$，能量为正，这对应于一条不受束缚的双曲线轨道。\n    -   比角动量（单位约化质量）：$h = b\\,v_{\\infty}$。这是一个守恒量，反映了运动的旋转特性。\n    -   离心率：$e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$。代入 $E$ 和 $h$ 的表达式，可得 $e = \\sqrt{1 + \\frac{v_{\\infty}^{2} (b v_{\\infty})^2}{\\mu^{2}}} = \\sqrt{1 + \\frac{b^2 v_{\\infty}^4}{\\mu^2}}$。离心率量化了轨道的形状；对于双曲线，有 $e > 1$。如果 $b=0$，则会出现特殊情况，此时 $h=0$ 且 $e=1$，代表一条退化的双曲线（一条直线轨迹）。\n\n3.  **近心点计算（$r_{\\min}$ 和 $C_{\\mathrm{peri}}$）**：我们根据轨道的几何形状确定最小间隔距离。\n    -   最小接近距离（近心点）：$r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$。该公式给出了两个天体质心之间的最近接近距离。在 $b=0$ 的特殊情况下，我们有 $h=0$ 和 $e=1$，这导致 $r_{\\min} = 0$。\n    -   基于近心点的碰撞条件：如果最小间隔距离小于或等于半径之和，则发生碰撞。这由布尔值 $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$ 表示。\n\n4.  **引力聚焦计算（$b_{\\mathrm{crit}}$ 和 $C_{\\mathrm{foc}}$）**：我们根据一个源于能量和动量守恒的、等价的替代判据来确定是否发生碰撞。这个概念被称为引力聚焦，即引力“聚焦”了入射粒子的路径，从而增加了有效碰撞截面。\n    -   临界碰撞参数：如果碰撞参数 $b$ 小于或等于一个临界值 $b_{\\mathrm{crit}}$，则发生碰撞。这个临界参数是通过将近心点距离 $r_{\\min}$ 设为等于接触半径 $R_{\\mathrm{tot}}$ 并求解 $b$ 推导出来的。其公式为 $b_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}$。\n    -   基于聚焦的碰撞条件：如果实际碰撞参数在此临界范围内，则预测会发生碰撞。这由布尔值 $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$ 表示。\n\n条件 $r_{\\min} \\le R_{\\mathrm{tot}}$ 和 $b \\le b_{\\mathrm{crit}}$ 的数学等价性是轨道力学的一个基本结果。一个正确的实现必须在所有测试用例中都得出 $C_{\\mathrm{peri}} = C_{\\mathrm{foc}}$ 的结果，同时考虑到边界上潜在的浮点数不精确性。所提供的测试用例旨在验证这一点，包括一个恰好在边界上（$b = b_{\\mathrm{crit}}$）和另一个刚好在边界外（$b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$）的情况。\n\n程序的算法将是遍历五个测试用例。对于每个用例：\n- 解析输入参数 $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$。\n- 注意，对于测试用例2和5， $b$ 的值不是直接给出的，而是相对于 $b_{\\mathrm{crit}}$ 定义的。因此，在这些情况下，需要先计算 $b_{\\mathrm{crit}}$ 以确定后续步骤中要使用的 $b$ 的值。\n- 应用上述公式序列来计算 $r_{\\min}$、$C_{\\mathrm{peri}}$ 和 $C_{\\mathrm{foc}}$。\n- 存储结果三元组 $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$。\n- 处理完所有用例后，将收集到的结果格式化为指定的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum approach distance and collision booleans for a series\n    of two-body gravitational encounters.\n    \"\"\"\n    # Gravitational constant in SI units (m^3 kg^-1 s^-2)\n    G = 6.67430e-11\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (m1, R1, m2, R2, v_inf, b_spec)\n    # where b_spec is either a numeric value or a descriptive string.\n    test_cases = [\n        # 1. Happy path scattering case with terrestrial planets\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, 5.0e7),\n\n        # 2. Boundary case at the gravitational focusing threshold for a Jupiter–Earth encounter\n        (1.898e27, 6.9911e7, 5.972e24, 6.371e6, 2.0e4, \"b_crit\"),\n\n        # 3. Head-on encounter of two super-Earths\n        (8.0e24, 8.0e6, 6.0e24, 7.0e6, 1.0e3, 0.0),\n\n        # 4. High-speed near-miss between ice giants\n        (1.02413e26, 2.4622e7, 8.6810e25, 2.5362e7, 1.0e5, 1.0e8),\n\n        # 5. Edge case slightly above the focusing threshold for the terrestrial case in 1\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, \"b_crit_plus_eps\")\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m1, R1, m2, R2, v_inf, b_spec = case\n\n        # Step 1: System Parameters\n        M = m1 + m2\n        mu = G * M\n        R_tot = R1 + R2\n\n        # Determine the impact parameter b based on the test case specification\n        if isinstance(b_spec, str):\n            # Calculate b_crit for cases 2 and 5\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n            if b_spec == \"b_crit\":\n                b = b_crit\n            elif b_spec == \"b_crit_plus_eps\":\n                b = b_crit * (1 + 1e-8)\n        else:\n            b = b_spec\n            # Calculate b_crit for the C_foc check\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n\n        # Step 2: Orbital Parameters\n        E = (v_inf**2) / 2\n        h = b * v_inf\n\n        # Step 3: Pericenter Calculation\n        if b == 0:  # Head-on collision case\n            r_min = 0.0\n        else:\n            # Eccentricity\n            e_sq = 1 + (2 * E * h**2) / (mu**2)\n            e = np.sqrt(e_sq)\n            \n            # Minimum approach distance (pericenter)\n            r_min = (h**2) / (mu * (1 + e))\n\n        # Pericenter-based collision boolean\n        C_peri = bool(r_min = R_tot)\n\n        # Step 4: Gravitational Focusing Calculation\n        # b_crit is already calculated for all cases now.\n        C_foc = bool(b = b_crit)\n        \n        # Append the results for this case\n        results.append([r_min, C_peri, C_foc])\n\n    # Final print statement in the exact required format.\n    # Convert bools to lowercase 'true'/'false' to match example if needed,\n    # but Python's default str(True) is 'True', which is a language-native format.\n    # The output format requests native boolean format.\n    # repr() is a robust way to format lists containing various types.\n    print(f\"[{','.join(map(repr, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "对长达数十亿年的行星系统演化进行数值积分是现代天体物理学的基石，但这需要我们对模拟的精度有深刻的理解和控制。任何数值积分方案都会引入误差，这些误差会随着时间的推移而累积，可能导致模拟结果偏离真实的物理轨迹。本练习  将引导您为一个长时程积分估算一份“误差预算”，具体分析一个辛积分器中由离散化引起的长期相位误差，以及由浮点运算舍入误差累积导致的能量和角动量漂移。掌握这种误差分析能力，是确保计算结果物理可靠性、避免数值假象的关键，也是计算天体物理学家的必备高级技能。",
            "id": "4168085",
            "problem": "考虑一个质量为 $m$ 的单一、近圆形、低偏心率行星，以半长轴 $a$ 绕着一颗质量为 $M$ 的恒星运行。该行星被建模为在引力参数为 $\\mu = G M$ 的中心平方反比引力场中的一个测试粒子。使用固定时间步长 $\\Delta t = 0.02$ 年的二阶辛速度 Verlet (蛙跳) 算法，在标准的双精度浮点运算（机器精度 $\\epsilon = 2.22 \\times 10^{-16}$）下，对轨道进行总时间为 $t = 1.0 \\times 10^{9}$ 年的积分。假设在积分过程中，轨道保持近圆形且不受扰动，并用其线性化的周转轮动力学来近似轨道运动，其平均运动角速度为 $n = \\sqrt{\\mu / a^{3}}$。对于一颗太阳质量的恒星和 $a = 1$ 天文单位，使用 $n = 2 \\pi$ 弧度/年。\n\n仅使用基本定律和经过充分检验的事实（牛顿定律、开普勒第三定律、将圆形开普勒运动线性化为频率为 $n$ 的周转轮，以及二阶辛离散化的性质），完成以下任务：\n\n1. 推导在积分时间 $t$ 内，由周转轮频率的离散化引起的偏移所导致的轨道相位长期累积 $\\Delta \\phi$ 的首项估计。将蛙跳格式的离散频率视为有效平均运动角速度 $n_{\\mathrm{eff}}$，并求出 $\\Delta \\phi \\approx (n_{\\mathrm{eff}} - n)\\, t$ 在 $n \\Delta t$ 上的首个非平凡阶。\n\n2. 估算总能量和总角动量的均方根长期漂移，分别表示为相对误差 $\\delta E / E$ 和 $\\delta L / L$。这些漂移是由浮点舍入误差在 $N = t / \\Delta t$ 个时间步长上作为不相关随机游走累积而产生的。对于辛格式，忽略这些守恒量中由截断误差引起的长期漂移，并专注于舍入误差的累积。\n\n在推导过程中清楚地说明你所做的任何近似。将最终数值答案四舍五入到三位有效数字。相位累积以弧度表示，能量和角动量的相对漂移以无单位小数表示。",
            "solution": "用户提供的问题已经过评估，并被确定为有效。该问题具有科学依据，提法明确，且客观。它基于天体力学、数值积分和误差分析的既定原则。所给条件是自洽的，足以推导出所要求的估计值。\n\n### **第一部分：轨道相位的长期累积 ($\\Delta \\phi$)**\n\n问题要求计算由数值积分器引起的首项长期相位累积。运动被近似为其线性化的周转轮动力学，对于近圆形轨道，这对应于一个简谐振子。对于偏离平均圆形运动的径向或方位角扰动 $x$，其运动方程为：\n$$\n\\ddot{x} = -n^2 x\n$$\n其中 $n$ 是真实的平均运动角速度。我们将二阶辛速度 Verlet (蛙跳) 积分器应用于此方程。蛙跳格式由以下步骤定义：\n1.  将速度更新到半步：$\\mathbf{v}_{k+1/2} = \\mathbf{v}_k + \\mathbf{a}_k \\frac{\\Delta t}{2}$\n2.  将位置更新到整步：$\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{v}_{k+1/2} \\Delta t$\n3.  将速度更新到整步：$\\mathbf{v}_{k+1} = \\mathbf{v}_{k+1/2} + \\mathbf{a}_{k+1} \\frac{\\Delta t}{2}$\n\n对于我们的一维简谐振子，其加速度为 $a_k = -n^2 x_k$，我们可以推导出位置 $x_k$ 的递推关系。从步骤2，我们有 $\\mathbf{v}_{k+1/2} = (\\mathbf{x}_{k+1} - \\mathbf{x}_k) / \\Delta t$。类似的关系也适用于前一个半步：$\\mathbf{v}_{k-1/2} = (\\mathbf{x}_{k} - \\mathbf{x}_{k-1}) / \\Delta t$。\n蛙跳的速度更新也可以写成 $\\mathbf{v}_{k+1/2} = \\mathbf{v}_{k-1/2} + \\mathbf{a}_k \\Delta t$。代入速度的表达式得到：\n$$\n\\frac{x_{k+1} - x_k}{\\Delta t} = \\frac{x_k - x_{k-1}}{\\Delta t} + (-n^2 x_k) \\Delta t\n$$\n两边乘以 $\\Delta t$ 并重新整理，得到位置的有限差分方程：\n$$\nx_{k+1} - 2x_k + x_{k-1} = -(n \\Delta t)^2 x_k\n$$\n$$\nx_{k+1} - \\left(2 - (n \\Delta t)^2\\right)x_k + x_{k-1} = 0\n$$\n我们寻求形式为 $x_k = A \\exp(i k n_{\\mathrm{eff}} \\Delta t)$ 的解，其中 $n_{\\mathrm{eff}}$ 是振子的有效（或数值）频率。将此拟设解代入递推关系得到：\n$$\n\\exp(i n_{\\mathrm{eff}} \\Delta t) - \\left(2 - (n \\Delta t)^2\\right) + \\exp(-i n_{\\mathrm{eff}} \\Delta t) = 0\n$$\n使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，我们得到：\n$$\n2\\cos(n_{\\mathrm{eff}} \\Delta t) = 2 - (n \\Delta t)^2\n$$\n$$\n\\cos(n_{\\mathrm{eff}} \\Delta t) = 1 - \\frac{(n \\Delta t)^2}{2}\n$$\n为了在 $n \\Delta t$ 很小时找到 $n_{\\mathrm{eff}}$ 和 $n$ 之间的关系，我们使用三角恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$：\n$$\n1 - 2\\sin^2\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right) = 1 - \\frac{(n \\Delta t)^2}{2}\n$$\n$$\n\\sin\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right) = \\frac{n \\Delta t}{2}\n$$\n我们使用泰勒级数展开正弦函数，$\\sin(z) = z - z^3/6 + \\mathcal{O}(z^5)$。令 $z = n_{\\mathrm{eff}} \\Delta t / 2$：\n$$\n\\frac{n_{\\mathrm{eff}} \\Delta t}{2} - \\frac{1}{6}\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right)^3 + \\dots = \\frac{n \\Delta t}{2}\n$$\n两边除以 $\\Delta t/2$ 并重新整理：\n$$\nn_{\\mathrm{eff}} \\left(1 - \\frac{1}{6}\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right)^2 + \\dots\\right) = n\n$$\n在首项阶上，$n_{\\mathrm{eff}} \\approx n$。我们可以将此代入括号中的项：\n$$\nn_{\\mathrm{eff}} \\approx n \\left(1 - \\frac{(n \\Delta t)^2}{24}\\right)^{-1}\n$$\n对于小的 $x$，使用二项式近似 $(1-x)^{-1} \\approx 1+x$：\n$$\nn_{\\mathrm{eff}} \\approx n \\left(1 + \\frac{(n \\Delta t)^2}{24}\\right)\n$$\n因此，频率偏移为：\n$$\nn_{\\mathrm{eff}} - n \\approx \\frac{n^3 (\\Delta t)^2}{24}\n$$\n在积分时间 $t$ 内累积的总相位误差 $\\Delta \\phi$ 是该频率偏移与总时间的乘积：\n$$\n\\Delta \\phi \\approx (n_{\\mathrm{eff}} - n) t \\approx \\frac{n^3 (\\Delta t)^2 t}{24}\n$$\n问题提供了以下数值：$n = 2\\pi$ 弧度/年，$\\Delta t = 0.02$ 年，以及 $t = 1.0 \\times 10^9$ 年。\n$$\n\\Delta \\phi \\approx \\frac{(2\\pi)^3 (0.02)^2 (1.0 \\times 10^9)}{24} = \\frac{8\\pi^3 (4 \\times 10^{-4}) (10^9)}{24} = \\frac{32\\pi^3 \\times 10^5}{24} = \\frac{4\\pi^3}{3} \\times 10^5\n$$\n数值上，计算结果为：\n$$\n\\Delta \\phi \\approx \\frac{4 \\times (3.14159)^3}{3} \\times 10^5 \\approx 4.13417 \\times 10^6 \\text{ 弧度}\n$$\n四舍五入到三位有效数字，相位累积为 $4.13 \\times 10^6$ 弧度。\n\n### **第二部分：能量和角动量的长期漂移 ($\\delta E/E$, $\\delta L/L$)**\n\n第二个任务关注守恒量总能量 $E$ 和总角动量 $L$ 中浮点舍入误差的累积。问题指明这种累积表现为不相关的随机游走。对于随机游走，经过 $N$ 步后的均方根 (RMS) 偏差的增长与 $\\sqrt{N}$ 成正比，比例系数为单步贡献的均方根大小。\n\n总时间步数为 $N = t / \\Delta t$：\n$$\nN = \\frac{1.0 \\times 10^9 \\text{ years}}{0.02 \\text{ years}} = 5 \\times 10^{10} \\text{ 步}\n$$\n总均方根误差将与 $\\sqrt{N}$ 成正比：\n$$\n\\sqrt{N} = \\sqrt{5 \\times 10^{10}} = \\sqrt{50} \\times 10^4 \\approx 7.071 \\times 10^4\n$$\n在积分的每一步中，对位置和速度向量进行的浮点算术运算（加法、乘法）都会引入一个小的误差。这个误差的大小与机器精度 $\\epsilon$ 以及所操作的量的大小成正比。对于像 $x_{k+1} = x_k + v_k \\Delta t + \\dots$ 这样的标准更新步骤，求和引入的误差大约是 $\\epsilon |x_{k+1}|$ 的量级。因此，引入状态变量的每步相对误差是 $\\epsilon$ 的量级。\n\n由于总能量 $E$ 和总角动量 $L$ 都是位置和速度的函数，状态向量中的这种每步误差会在计算出的 $E$ 和 $L$ 值中引入一个随机误差。对于一个具有特征位置量 $a$ 和特征速度量 $v \\sim na$ 的系统，能量和角动量的大小为 $|E| \\sim m(na)^2$ 和 $L \\sim m a (na)$。位置和速度中每步 $\\epsilon$ 的相对误差会传播为 $E$ 和 $L$ 中量级为 $\\epsilon$ 的每步相对误差。\n\n因此，我们将每一步中某个量 $Q$（其中 $Q$ 是 $E$ 或 $L$）的相对误差建模为一个均方根大小为 $\\epsilon$ 的随机变量。在 $N$ 步上累积的总相对误差为：\n$$\n\\frac{\\delta Q}{Q} \\approx \\epsilon \\sqrt{N}\n$$\n这个模型是合适的，因为问题说明要忽略这些量的截断误差，这是合理的，因为辛积分器在能量上表现出有界振荡，并且对于中心力问题具有出色的角动量守恒性。因此，长期漂移的唯一来源是舍入误差的随机游走。\n\n使用给定的机器精度 $\\epsilon = 2.22 \\times 10^{-16}$ 和计算出的 $\\sqrt{N}$：\n$$\n\\frac{\\delta E}{E} \\approx \\frac{\\delta L}{L} \\approx (2.22 \\times 10^{-16}) \\times (7.071 \\times 10^4) \\approx 1.5699... \\times 10^{-11}\n$$\n四舍五入到三位有效数字，相对漂移为：\n$$\n\\frac{\\delta E}{E} \\approx 1.57 \\times 10^{-11}\n$$\n$$\n\\frac{\\delta L}{L} \\approx 1.57 \\times 10^{-11}\n$$\n该问题是适定的，因为结果与 $m$、$M$ 和 $a$ 无关，仅取决于数值参数 $t$、$\\Delta t$ 和 $\\epsilon$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.13 \\times 10^{6}  1.57 \\times 10^{-11}  1.57 \\times 10^{-11} \\end{pmatrix}}\n$$"
        }
    ]
}