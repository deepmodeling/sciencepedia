{
    "hands_on_practices": [
        {
            "introduction": "The complexity of the N-body problem can be significantly reduced by choosing a coordinate system that simplifies the equations of motion. Jacobi coordinates are an essential tool for this purpose, as they elegantly separate the system's center-of-mass motion from its internal dynamics, leading to a diagonal kinetic energy matrix in the Hamiltonian. This exercise provides direct, hands-on practice in constructing these hierarchical coordinates from fundamental principles and applying them to a concrete three-body system. ",
            "id": "4168043",
            "problem": "Consider a star–planet system in which three planets are modeled as an interacting sub-system, and their coordinates are given in the barycentric frame of the planetary sub-system alone (excluding the host star). Let the three planets have masses $m_{1}$, $m_{2}$, $m_{3}$ and barycentric position vectors $\\mathbf{X}_{1}$, $\\mathbf{X}_{2}$, $\\mathbf{X}_{3}$ at a fixed epoch. Assume the barycentric constraint of the planetary sub-system holds, namely that the center of mass (COM) of the three planets is at the origin, so $\\sum_{i=1}^{3} m_{i} \\mathbf{X}_{i} = \\mathbf{0}$. Using only Newtonian mechanics (translational invariance and the definition of the center of mass), construct hierarchical relative coordinates for this three-body sub-system that eliminate the global translational degree of freedom, and define the corresponding two Jacobi coordinates. Then compute the numerical values of these Jacobi coordinates for the following physically plausible data and verify that the hierarchical mass-weighted definitions are satisfied:\n\n- Masses (in Solar masses): $m_{1} = 1.5 \\times 10^{-3}$, $m_{2} = 4.0 \\times 10^{-4}$, $m_{3} = 1.0 \\times 10^{-3}$.\n- Barycentric positions (in astronomical units, AU): $\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00)$, $\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00)$, $\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00)$.\n\nUse the center of mass definition to construct the hierarchical coordinates, derive the inverse mapping back to $\\mathbf{X}_{i}$, and explicitly check that the given $\\mathbf{X}_{i}$ are recovered. Finally, report the two Jacobi vectors as a single row matrix of six entries $(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z})$.\n\nRound your numerical entries to four significant figures. Express coordinates in astronomical units (AU). The final answer must be the row matrix only, with no units included in the box.",
            "solution": "The foundational starting point is translational invariance in Newtonian mechanics and the definition of the center of mass (COM). For masses $m_{i}$ and inertial positions $\\mathbf{X}_{i}$, the COM of a set of bodies is defined by\n$$\n\\mathbf{C} = \\frac{\\sum_{i} m_{i} \\mathbf{X}_{i}}{\\sum_{i} m_{i}}.\n$$\nIn a barycentric frame for the planetary sub-system, $\\mathbf{C} = \\mathbf{0}$ for the three planets, so\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0}.\n$$\nJacobi coordinates are hierarchical relative coordinates constructed to remove the global translation and to reflect the mass-weighted hierarchy. For three bodies, we define two Jacobi vectors by using the COM of the first $k$ bodies at each step.\n\nFirst, define the partial center of mass of bodies $1$ and $2$:\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}}, \\quad \\text{where} \\quad M_{12} = m_{1} + m_{2}.\n$$\nThe two Jacobi vectors for the three-body sub-system are then defined by\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1},\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12}.\n$$\nThese follow directly from the hierarchical use of the COM: the first vector is the relative coordinate of body $2$ with respect to body $1$, and the second is the position of body $3$ relative to the COM of bodies $1$ and $2$.\n\nWe also derive the inverse mapping from $\\mathbf{y}_{1}$ and $\\mathbf{y}_{2}$ to the barycentric positions $\\mathbf{X}_{i}$. Using $\\mathbf{X}_{2} = \\mathbf{X}_{1} + \\mathbf{y}_{1}$ and the definition of $\\mathbf{C}_{12}$,\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}\n\\quad \\Rightarrow \\quad\n(m_{1} + m_{2}) \\mathbf{X}_{1} + m_{2} \\mathbf{y}_{1} = M_{12} \\mathbf{C}_{12},\n$$\nwhich gives\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad\n\\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}.\n$$\nFor the third body,\n$$\n\\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12}.\n$$\nIf the three-body COM is at the origin, then\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = \\mathbf{0},\n$$\nwhich is consistent with the definitions above because $m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} = M_{12} \\mathbf{C}_{12}$ and thus\n$$\nM_{12} \\mathbf{C}_{12} + m_{3} (\\mathbf{y}_{2} + \\mathbf{C}_{12}) = (M_{12} + m_{3}) \\mathbf{C}_{12} + m_{3} \\mathbf{y}_{2}.\n$$\nIn a strictly barycentric frame for the sub-system, $\\mathbf{C} = \\mathbf{0}$, and the choice of $\\mathbf{y}_{2}$ relative to $\\mathbf{C}_{12}$ retains translational invariance while providing hierarchical mass-weighting.\n\nWe now compute the required quantities for the given data.\n\nGiven masses:\n$$\nm_{1} = 1.5 \\times 10^{-3}, \\quad m_{2} = 4.0 \\times 10^{-4}, \\quad m_{3} = 1.0 \\times 10^{-3},\n$$\nand barycentric positions (in astronomical units):\n$$\n\\mathbf{X}_{1} = (0.50,\\, 0.10,\\, 0.00), \\quad\n\\mathbf{X}_{2} = (-0.20,\\, 0.40,\\, 0.00), \\quad\n\\mathbf{X}_{3} = (-0.67,\\, -0.31,\\, 0.00).\n$$\nFirst, verify the barycentric constraint:\n$$\nm_{1} \\mathbf{X}_{1} = (0.0015 \\cdot 0.50,\\, 0.0015 \\cdot 0.10,\\, 0) = (0.00075,\\, 0.00015,\\, 0),\n$$\n$$\nm_{2} \\mathbf{X}_{2} = (0.0004 \\cdot (-0.20),\\, 0.0004 \\cdot 0.40,\\, 0) = (-0.00008,\\, 0.00016,\\, 0),\n$$\n$$\nm_{3} \\mathbf{X}_{3} = (0.001 \\cdot (-0.67),\\, 0.001 \\cdot (-0.31),\\, 0) = (-0.00067,\\, -0.00031,\\, 0).\n$$\nSumming,\n$$\nm_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2} + m_{3} \\mathbf{X}_{3} = (0.00075 - 0.00008 - 0.00067,\\, 0.00015 + 0.00016 - 0.00031,\\, 0) = (0,\\, 0,\\, 0),\n$$\nso the COM is at the origin.\n\nCompute the partial COM of bodies $1$ and $2$:\n$$\nM_{12} = m_{1} + m_{2} = 1.5 \\times 10^{-3} + 4.0 \\times 10^{-4} = 1.9 \\times 10^{-3},\n$$\n$$\n\\mathbf{C}_{12} = \\frac{m_{1} \\mathbf{X}_{1} + m_{2} \\mathbf{X}_{2}}{M_{12}} \n= \\frac{(0.00075 - 0.00008,\\, 0.00015 + 0.00016,\\, 0)}{0.0019}\n= \\frac{(0.00067,\\, 0.00031,\\, 0)}{0.0019}.\n$$\nNumerically,\n$$\n\\mathbf{C}_{12} \\approx (0.3526315789,\\, 0.1631578947,\\, 0).\n$$\nCompute the Jacobi vectors:\n$$\n\\mathbf{y}_{1} = \\mathbf{X}_{2} - \\mathbf{X}_{1} = (-0.20 - 0.50,\\, 0.40 - 0.10,\\, 0.00 - 0.00) = (-0.70,\\, 0.30,\\, 0.00),\n$$\n$$\n\\mathbf{y}_{2} = \\mathbf{X}_{3} - \\mathbf{C}_{12} = (-0.67 - 0.3526315789,\\, -0.31 - 0.1631578947,\\, 0.00 - 0.00).\n$$\nThus,\n$$\n\\mathbf{y}_{2} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0.00).\n$$\nRound each entry to four significant figures (in astronomical units):\n$$\n\\mathbf{y}_{1} \\to (-0.7000,\\, 0.3000,\\, 0.0000), \\quad\n\\mathbf{y}_{2} \\to (-1.023,\\, -0.4732,\\, 0.0000).\n$$\nVerification of the hierarchical mass-weighted definitions proceeds by reconstructing $\\mathbf{X}_{i}$ from $\\mathbf{y}_{1}$, $\\mathbf{y}_{2}$, and $\\mathbf{C}_{12}$. Using\n$$\n\\mathbf{X}_{1} = \\mathbf{C}_{12} - \\frac{m_{2}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{2} = \\mathbf{C}_{12} + \\frac{m_{1}}{M_{12}} \\mathbf{y}_{1}, \\quad \\mathbf{X}_{3} = \\mathbf{y}_{2} + \\mathbf{C}_{12},\n$$\nwith $m_{2}/M_{12} = \\frac{4.0 \\times 10^{-4}}{1.9 \\times 10^{-3}} \\approx 0.2105263158$ and $m_{1}/M_{12} \\approx 0.7894736842$, we obtain\n$$\n\\mathbf{X}_{1} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) - 0.2105263158 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 + 0.1473684211,\\, 0.1631578947 - 0.0631578947,\\, 0)\n= (0.50,\\, 0.10,\\, 0),\n$$\n$$\n\\mathbf{X}_{2} \\approx (0.3526315789,\\, 0.1631578947,\\, 0) + 0.7894736842 \\cdot (-0.70,\\, 0.30,\\, 0)\n\\approx (0.3526315789 - 0.5526315789,\\, 0.1631578947 + 0.2368421053,\\, 0)\n= (-0.20,\\, 0.40,\\, 0),\n$$\n$$\n\\mathbf{X}_{3} \\approx (-1.0226315789,\\, -0.4731578947,\\, 0) + (0.3526315789,\\, 0.1631578947,\\, 0)\n= (-0.67,\\, -0.31,\\, 0).\n$$\nTherefore the hierarchical mass-weighted definitions are satisfied and the inverse mapping recovers the original barycentric positions.\n\nAs requested, the final answer is the single row matrix of the two Jacobi vectors’ components, rounded to four significant figures, in astronomical units (AU):\n$$\n(y_{1x},\\, y_{1y},\\, y_{1z},\\, y_{2x},\\, y_{2y},\\, y_{2z}) = (-0.7000,\\, 0.3000,\\, 0.0000,\\, -1.023,\\, -0.4732,\\, 0.0000).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.7000  0.3000  0.0000  -1.023  -0.4732  0.0000\\end{pmatrix}}$$"
        },
        {
            "introduction": "While long-term evolution is often dominated by gentle secular perturbations, the fate of a planetary system can be decided by brief, powerful close encounters. This practice challenges you to move from theory to code by implementing a tool to analyze such encounters, translating orbital parameters like the impact parameter $b$ and relative velocity $v_{\\infty}$ into a definitive outcome. You will compute the minimum approach distance and verify the crucial concept of gravitational focusing, which explains how gravity enhances the effective collision cross-section of a planet. ",
            "id": "4168034",
            "problem": "A two-body gravitational encounter in planetary science can be meaningfully analyzed in the relative frame of the reduced mass under Newtonian gravity. Consider two planets treated as uniform spheres with physical radii and no dissipative forces. The interaction is modeled as a Keplerian hyperbolic trajectory characterized by the relative speed at infinity and an impact parameter. The objective is to compute the minimum approach distance between the planetary centers during the encounter and to assess whether a physical collision occurs, or whether the outcome is a non-collisional gravitational scattering, evaluated using the escape velocity at the contact radius and the spheres’ radii.\n\nYou must implement a complete program that, for a specified set of test cases, returns for each case the minimum approach distance and two logical assessments: whether a collision occurs according to the exact pericenter calculation, and whether a collision would be predicted by the gravitational focusing threshold derived from escape velocity and the physical radii.\n\nAll quantities must be treated in the International System of Units (SI). Distances must be expressed in meters, velocities in meters per second, masses in kilograms, and the gravitational constant in SI units. Angles are not required. The final numerical outputs for distances must be in meters. Booleans must be provided as the programming language native true or false values.\n\nFundamental base assumptions and definitions:\n- Newton’s law of universal gravitation applies: the gravitational parameter is $G$, with $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$.\n- The two-body reduction is used, with total mass $M = m_1 + m_2$, reduced mass $\\mu_{\\mathrm{red}} = \\frac{m_1 m_2}{m_1 + m_2}$, and gravitational parameter $\\mu = G M$.\n- The incoming relative speed at infinity is $v_{\\infty}  0$, and the impact parameter is $b \\ge 0$. The specific orbital energy (per unit reduced mass) is $E = \\frac{v_{\\infty}^{2}}{2}$ and the specific angular momentum (per unit reduced mass) is $h = b\\,v_{\\infty}$.\n- The relative orbit is hyperbolic with eccentricity $e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$.\n- The minimum approach distance (the pericenter of the hyperbolic orbit) is given by $r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$.\n- The physical contact threshold is $R_{\\mathrm{tot}} = R_1 + R_2$, where $R_1$ and $R_2$ are the physical radii of the two planets. A collision occurs if and only if $r_{\\min} \\le R_{\\mathrm{tot}}$.\n- The escape velocity defined at the contact distance is $v_{\\mathrm{esc}}(R_{\\mathrm{tot}}) = \\sqrt{\\frac{2 \\mu}{R_{\\mathrm{tot}}}}$. Gravitational focusing yields a critical impact parameter\n$$\nb_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{v_{\\mathrm{esc}}^{2}(R_{\\mathrm{tot}})}{v_{\\infty}^{2}}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}.\n$$\nA collision is predicted by the focusing threshold if and only if $b \\le b_{\\mathrm{crit}}$.\n\nProgram requirements:\n- For each test case, compute $r_{\\min}$ in meters, the collision boolean $C_{\\mathrm{peri}}$ defined as $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$, and the gravitational focusing boolean $C_{\\mathrm{foc}}$ defined as $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$.\n- Use the formulas exactly as stated above, without shortcut formulas other than those explicitly defined in the fundamental base.\n\nTest suite:\nProvide computations for the following five test cases. Each case specifies $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$:\n\n1. Happy path scattering case with terrestrial planets:\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b = 5.0 \\times 10^{7}\\ \\mathrm{m}$.\n\n2. Boundary case at the gravitational focusing threshold for a Jupiter–Earth encounter:\n   - $m_1 = 1.898 \\times 10^{27}\\ \\mathrm{kg}$, $R_1 = 6.9911 \\times 10^{7}\\ \\mathrm{m}$.\n   - $m_2 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 2.0 \\times 10^{4}\\ \\mathrm{m/s}$.\n   - $b$ is defined to be equal to $b_{\\mathrm{crit}}$ computed from the above formula for these parameters.\n\n3. Head-on encounter of two super-Earths:\n   - $m_1 = 8.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 8.0 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.0 \\times 10^{24}\\ \\mathrm{kg}$, $R_2 = 7.0 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 1.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b = 0$.\n\n4. High-speed near-miss between ice giants:\n   - $m_1 = 1.02413 \\times 10^{26}\\ \\mathrm{kg}$, $R_1 = 2.4622 \\times 10^{7}\\ \\mathrm{m}$.\n   - $m_2 = 8.6810 \\times 10^{25}\\ \\mathrm{kg}$, $R_2 = 2.5362 \\times 10^{7}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 1.0 \\times 10^{5}\\ \\mathrm{m/s}$.\n   - $b = 1.0 \\times 10^{8}\\ \\mathrm{m}$.\n\n5. Edge case slightly above the focusing threshold for the terrestrial case in 1:\n   - $m_1 = 5.972 \\times 10^{24}\\ \\mathrm{kg}$, $R_1 = 6.371 \\times 10^{6}\\ \\mathrm{m}$.\n   - $m_2 = 6.417 \\times 10^{23}\\ \\mathrm{kg}$, $R_2 = 3.3895 \\times 10^{6}\\ \\mathrm{m}$.\n   - $v_{\\infty} = 5.0 \\times 10^{3}\\ \\mathrm{m/s}$.\n   - $b$ is defined as $b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$ computed for these parameters, so that the pericenter is just above the contact threshold.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case result and is itself a list of the form $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$. For example, the output must have the format\n$[[r_{\\min,1}, C_{\\mathrm{peri},1}, C_{\\mathrm{foc},1}], [r_{\\min,2}, C_{\\mathrm{peri},2}, C_{\\mathrm{foc},2}], \\dots]$\nwith $r_{\\min,i}$ in meters and booleans given in the language’s native format. No additional text may be printed.",
            "solution": "The problem is assessed to be **valid**. It is scientifically grounded in Newtonian celestial mechanics, self-contained, and algorithmically well-posed. The provided formulas for the two-body problem are standard and correct. The test cases are physically realistic and include well-chosen boundary and edge cases to test the implementation's robustness. The problem asks to compute two collision criteria, one based on the pericenter distance and one on the gravitational focusing impact parameter. As will be shown, these two criteria are mathematically equivalent, providing an excellent internal consistency check for any correct implementation.\n\nThe solution proceeds by implementing the specified formulas for each test case. The gravitational constant is $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$.\n\nFor each test case, specified by the masses $m_1$ and $m_2$, physical radii $R_1$ and $R_2$, relative velocity at infinity $v_{\\infty}$, and impact parameter $b$, we perform the following calculations:\n\n1.  **System Parameters**: First, we compute the parameters of the two-body system.\n    -   Total mass: $M = m_1 + m_2$.\n    -   Gravitational parameter for the system: $\\mu = G M$. This parameter governs the strength of the gravitational interaction.\n    -   Total physical radius for contact: $R_{\\mathrm{tot}} = R_1 + R_2$. A collision occurs if the centers of the two bodies approach a distance less than or equal to this value.\n\n2.  **Orbital Parameters**: Next, we characterize the hyperbolic trajectory of the relative motion.\n    -   Specific orbital energy (per unit reduced mass): $E = \\frac{v_{\\infty}^{2}}{2}$. Since $v_{\\infty}  0$, the energy is positive, which corresponds to an unbound, hyperbolic orbit.\n    -   Specific angular momentum (per unit reduced mass): $h = b\\,v_{\\infty}$. This is a conserved quantity, reflecting the rotational aspect of the motion.\n    -   Eccentricity: $e = \\sqrt{1 + \\frac{2 E h^{2}}{\\mu^{2}}}$. Substituting the expressions for $E$ and $h$, this becomes $e = \\sqrt{1 + \\frac{v_{\\infty}^{2} (b v_{\\infty})^2}{\\mu^{2}}} = \\sqrt{1 + \\frac{b^2 v_{\\infty}^4}{\\mu^2}}$. The eccentricity quantifies the shape of the orbit; for a hyperbola, $e  1$. A special case occurs if $b=0$, yielding $h=0$ and $e=1$, which represents a degenerate hyperbola (a straight-line trajectory).\n\n3.  **Pericenter Calculation ($r_{\\min}$ and $C_{\\mathrm{peri}}$)**: We determine the minimum separation distance based on the orbit's geometry.\n    -   Minimum approach distance (pericenter): $r_{\\min} = \\frac{h^{2}}{\\mu\\,(1 + e)}$. This formula gives the distance of closest approach between the two bodies' centers of mass. In the special case where $b=0$, we have $h=0$ and $e=1$, which gives $r_{\\min} = 0$.\n    -   Pericenter-based collision condition: A collision occurs if the minimum separation is less than or equal to the sum of the radii. This is represented by the boolean $C_{\\mathrm{peri}} := (r_{\\min} \\le R_{\\mathrm{tot}})$.\n\n4.  **Gravitational Focusing Calculation ($b_{\\mathrm{crit}}$ and $C_{\\mathrm{foc}}$)**: We determine whether a collision occurs based on an alternative, but equivalent, criterion derived from energy and momentum conservation. This concept is known as gravitational focusing, where gravity \"focuses\" incoming particle paths, increasing the effective collision cross-section.\n    -   Critical impact parameter: A collision occurs if the impact parameter $b$ is less than or equal to a critical value, $b_{\\mathrm{crit}}$. This critical parameter is derived by setting the pericenter distance $r_{\\min}$ equal to the contact radius $R_{\\mathrm{tot}}$ and solving for $b$. The formula is given as $b_{\\mathrm{crit}} = R_{\\mathrm{tot}}\\,\\sqrt{1 + \\frac{2\\mu}{R_{\\mathrm{tot}}\\,v_{\\infty}^{2}}}$.\n    -   Focusing-based collision condition: The collision is predicted if the actual impact parameter is within this critical range. This is represented by the boolean $C_{\\mathrm{foc}} := (b \\le b_{\\mathrm{crit}})$.\n\nThe mathematical equivalence of the conditions $r_{\\min} \\le R_{\\mathrm{tot}}$ and $b \\le b_{\\mathrm{crit}}$ is a fundamental result of orbital mechanics. A correct implementation must yield $C_{\\mathrm{peri}} = C_{\\mathrm{foc}}$ for all test cases, accounting for potential floating-point inaccuracies at the boundary. The provided test cases are designed to verify this, including a case exactly at the boundary ($b = b_{\\mathrm{crit}}$) and one just outside ($b = b_{\\mathrm{crit}} \\times (1 + 10^{-8})$).\n\nThe algorithm for the program will be to iterate through the five test cases. For each case:\n- Parse the input parameters $(m_1, R_1, m_2, R_2, v_{\\infty}, b)$.\n- Note that for test cases $2$ and $5$, the value of $b$ is not given directly but is defined relative to $b_{\\mathrm{crit}}$. Therefore, for these cases, an initial calculation of $b_{\\mathrm{crit}}$ is required to determine the value of $b$ to be used in subsequent steps.\n- Apply the sequence of formulas described above to calculate $r_{\\min}$, $C_{\\mathrm{peri}}$, and $C_{\\mathrm{foc}}$.\n- Store the resulting triplet $[r_{\\min}, C_{\\mathrm{peri}}, C_{\\mathrm{foc}}]$.\n- After processing all cases, format the collected results into the specified string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum approach distance and collision booleans for a series\n    of two-body gravitational encounters.\n    \"\"\"\n    # Gravitational constant in SI units (m^3 kg^-1 s^-2)\n    G = 6.67430e-11\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (m1, R1, m2, R2, v_inf, b_spec)\n    # where b_spec is either a numeric value or a descriptive string.\n    test_cases = [\n        # 1. Happy path scattering case with terrestrial planets\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, 5.0e7),\n\n        # 2. Boundary case at the gravitational focusing threshold for a Jupiter–Earth encounter\n        (1.898e27, 6.9911e7, 5.972e24, 6.371e6, 2.0e4, \"b_crit\"),\n\n        # 3. Head-on encounter of two super-Earths\n        (8.0e24, 8.0e6, 6.0e24, 7.0e6, 1.0e3, 0.0),\n\n        # 4. High-speed near-miss between ice giants\n        (1.02413e26, 2.4622e7, 8.6810e25, 2.5362e7, 1.0e5, 1.0e8),\n\n        # 5. Edge case slightly above the focusing threshold for the terrestrial case in 1\n        (5.972e24, 6.371e6, 6.417e23, 3.3895e6, 5.0e3, \"b_crit_plus_eps\")\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m1, R1, m2, R2, v_inf, b_spec = case\n\n        # Step 1: System Parameters\n        M = m1 + m2\n        mu = G * M\n        R_tot = R1 + R2\n\n        # Determine the impact parameter b based on the test case specification\n        if isinstance(b_spec, str):\n            # Calculate b_crit for cases 2 and 5\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n            if b_spec == \"b_crit\":\n                b = b_crit\n            elif b_spec == \"b_crit_plus_eps\":\n                b = b_crit * (1 + 1e-8)\n        else:\n            b = b_spec\n            # Calculate b_crit for the C_foc check\n            b_crit_sq = R_tot**2 * (1 + (2 * mu) / (R_tot * v_inf**2))\n            b_crit = np.sqrt(b_crit_sq)\n\n        # Step 2: Orbital Parameters\n        E = (v_inf**2) / 2\n        h = b * v_inf\n\n        # Step 3: Pericenter Calculation\n        if b == 0:  # Head-on collision case\n            r_min = 0.0\n        else:\n            # Eccentricity\n            e_sq = 1 + (2 * E * h**2) / (mu**2)\n            e = np.sqrt(e_sq)\n            \n            # Minimum approach distance (pericenter)\n            r_min = (h**2) / (mu * (1 + e))\n\n        # Pericenter-based collision boolean\n        C_peri = bool(r_min = R_tot)\n\n        # Step 4: Gravitational Focusing Calculation\n        # b_crit is already calculated for all cases now.\n        C_foc = bool(b = b_crit)\n        \n        # Append the results for this case\n        results.append([r_min, C_peri, C_foc])\n\n    # Final print statement in the exact required format.\n    # Convert bools to lowercase 'true'/'false' to match example if needed,\n    # but Python's default str(True) is 'True', which is a language-native format.\n    # The output format requests native boolean format.\n    # repr() is a robust way to format lists containing various types.\n    print(f\"[{','.join(map(repr, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Simulating a planetary system for billions of years pushes the limits of numerical computation, and trusting the results requires a deep understanding of error propagation. This exercise provides a masterclass in planning a numerical error budget, a vital skill for any computational astrophysicist. By performing a \"back-of-the-envelope\" calculation, you will learn to distinguish and estimate the two main long-term error sources in symplectic integrators: the systematic phase error from discretization and the secular drift in conserved quantities from the random walk of floating-point errors. ",
            "id": "4168085",
            "problem": "Consider a single, nearly circular, low-eccentricity planet of mass $m$ orbiting a star of mass $M$ at semimajor axis $a$, modeled as a test particle in a central inverse-square gravitational field with gravitational parameter $\\mu = G M$. The orbit is integrated for a total time $t = 1.0 \\times 10^{9}$ years using a fixed-timestep, second-order symplectic velocity Verlet (leapfrog) method with timestep $\\Delta t = 0.02$ years in standard double precision floating point arithmetic, with machine epsilon $\\epsilon = 2.22 \\times 10^{-16}$. Assume the orbit remains nearly circular and unperturbed over the integration, and approximate the orbital motion by its linearized epicyclic dynamics with mean motion $n = \\sqrt{\\mu / a^{3}}$. For a solar-mass star and $a = 1$ astronomical unit, use $n = 2 \\pi$ radians per year.\n\nUsing only fundamental laws and well-tested facts (Newton’s laws, Kepler’s third law, the linearization of circular Keplerian motion as an epicycle with frequency $n$, and the properties of second-order symplectic discretizations), complete the following tasks:\n\n1. Derive the leading-order estimate of the secular accumulation in orbital phase $\\Delta \\phi$ over the integration time $t$ that arises from the discretization-induced shift in the epicyclic frequency. Treat the leapfrog scheme’s discrete frequency as an effective mean motion $n_{\\mathrm{eff}}$ and obtain $\\Delta \\phi \\approx (n_{\\mathrm{eff}} - n)\\, t$ to leading nontrivial order in $n \\Delta t$.\n\n2. Estimate the root-mean-square secular drifts in the total energy and the total angular momentum, expressed as fractional errors $\\delta E / E$ and $\\delta L / L$, respectively, that arise from floating-point round-off error accumulated as an uncorrelated random walk over $N = t / \\Delta t$ timesteps. Neglect truncation-induced secular drift in these conserved quantities for the symplectic scheme and focus on round-off accumulation.\n\nState clearly any approximations you make in your derivations. Round your final numerical answers to three significant figures. Express the phase accumulation in radians, and the fractional energy and angular momentum drifts as unitless decimals.",
            "solution": "The user-provided problem has been assessed and is determined to be valid. It is scientifically grounded, well-posed, and objective. It is based on established principles of celestial mechanics, numerical integration, and error analysis. The givens are self-contained and sufficient for deriving the requested estimates.\n\n### **Part 1: Secular Accumulation in Orbital Phase ($\\Delta \\phi$)**\n\nThe problem asks for the leading-order secular phase accumulation due to the numerical integrator. The motion is approximated by its linearized epicyclic dynamics, which for a nearly circular orbit corresponds to a simple harmonic oscillator. For a radial or azimuthal perturbation $x$ from the mean circular motion, the equation of motion is:\n$$\n\\ddot{x} = -n^2 x\n$$\nwhere $n$ is the true mean motion. We apply the second-order symplectic velocity Verlet (leapfrog) integrator to this equation. The leapfrog scheme is defined by the following steps:\n1.  Update velocity to mid-step: $\\mathbf{v}_{k+1/2} = \\mathbf{v}_k + \\mathbf{a}_k \\frac{\\Delta t}{2}$\n2.  Update position to full step: $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{v}_{k+1/2} \\Delta t$\n3.  Update velocity to full step: $\\mathbf{v}_{k+1} = \\mathbf{v}_{k+1/2} + \\mathbf{a}_{k+1} \\frac{\\Delta t}{2}$\n\nFor our one-dimensional simple harmonic oscillator with acceleration $a_k = -n^2 x_k$, we can derive a recurrence relation for the positions $x_k$. From step 2, we have $\\mathbf{v}_{k+1/2} = (\\mathbf{x}_{k+1} - \\mathbf{x}_k) / \\Delta t$. A similar relation holds for the previous half-step: $\\mathbf{v}_{k-1/2} = (\\mathbf{x}_{k} - \\mathbf{x}_{k-1}) / \\Delta t$.\nThe leapfrog update for velocity can also be written as $\\mathbf{v}_{k+1/2} = \\mathbf{v}_{k-1/2} + \\mathbf{a}_k \\Delta t$.\nSubstituting the expressions for the velocities gives:\n$$\n\\frac{x_{k+1} - x_k}{\\Delta t} = \\frac{x_k - x_{k-1}}{\\Delta t} + (-n^2 x_k) \\Delta t\n$$\nMultiplying by $\\Delta t$ and rearranging yields the finite-difference equation for the position:\n$$\nx_{k+1} - 2x_k + x_{k-1} = -(n \\Delta t)^2 x_k\n$$\n$$\nx_{k+1} - \\left(2 - (n \\Delta t)^2\\right)x_k + x_{k-1} = 0\n$$\nWe seek solutions of the form $x_k = A \\exp(i k n_{\\mathrm{eff}} \\Delta t)$, where $n_{\\mathrm{eff}}$ is the effective, or numerical, frequency of the oscillator. Substituting this ansatz into the recurrence relation gives:\n$$\n\\exp(i n_{\\mathrm{eff}} \\Delta t) - \\left(2 - (n \\Delta t)^2\\right) + \\exp(-i n_{\\mathrm{eff}} \\Delta t) = 0\n$$\nUsing the identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, we get:\n$$\n2\\cos(n_{\\mathrm{eff}} \\Delta t) = 2 - (n \\Delta t)^2\n$$\n$$\n\\cos(n_{\\mathrm{eff}} \\Delta t) = 1 - \\frac{(n \\Delta t)^2}{2}\n$$\nTo find the relation between $n_{\\mathrm{eff}}$ and $n$ for small $n \\Delta t$, we use the trigonometric identity $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$:\n$$\n1 - 2\\sin^2\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right) = 1 - \\frac{(n \\Delta t)^2}{2}\n$$\n$$\n\\sin\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right) = \\frac{n \\Delta t}{2}\n$$\nWe expand the sine function using its Taylor series, $\\sin(z) = z - z^3/6 + \\mathcal{O}(z^5)$. Let $z = n_{\\mathrm{eff}} \\Delta t / 2$:\n$$\n\\frac{n_{\\mathrm{eff}} \\Delta t}{2} - \\frac{1}{6}\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right)^3 + \\dots = \\frac{n \\Delta t}{2}\n$$\nDividing by $\\Delta t/2$ and rearranging:\n$$\nn_{\\mathrm{eff}} \\left(1 - \\frac{1}{6}\\left(\\frac{n_{\\mathrm{eff}} \\Delta t}{2}\\right)^2 + \\dots\\right) = n\n$$\nTo leading order, $n_{\\mathrm{eff}} \\approx n$. We can substitute this into the term in parentheses:\n$$\nn_{\\mathrm{eff}} \\approx n \\left(1 - \\frac{(n \\Delta t)^2}{24}\\right)^{-1}\n$$\nUsing the binomial approximation $(1-x)^{-1} \\approx 1+x$ for small $x$:\n$$\nn_{\\mathrm{eff}} \\approx n \\left(1 + \\frac{(n \\Delta t)^2}{24}\\right)\n$$\nThe frequency shift is therefore:\n$$\nn_{\\mathrm{eff}} - n \\approx \\frac{n^3 (\\Delta t)^2}{24}\n$$\nThe total accumulated phase error $\\Delta \\phi$ over the integration time $t$ is the product of this frequency shift and the total time:\n$$\n\\Delta \\phi \\approx (n_{\\mathrm{eff}} - n) t \\approx \\frac{n^3 (\\Delta t)^2 t}{24}\n$$\nThe problem provides the following values: $n = 2\\pi$ rad/year, $\\Delta t = 0.02$ years, and $t = 1.0 \\times 10^9$ years.\n$$\n\\Delta \\phi \\approx \\frac{(2\\pi)^3 (0.02)^2 (1.0 \\times 10^9)}{24} = \\frac{8\\pi^3 (4 \\times 10^{-4}) (10^9)}{24} = \\frac{32\\pi^3 \\times 10^5}{24} = \\frac{4\\pi^3}{3} \\times 10^5\n$$\nNumerically, this evaluates to:\n$$\n\\Delta \\phi \\approx \\frac{4 \\times (3.14159)^3}{3} \\times 10^5 \\approx 4.13417 \\times 10^6 \\text{ radians}\n$$\nRounding to three significant figures, the phase accumulation is $4.13 \\times 10^6$ radians.\n\n### **Part 2: Secular Drifts in Energy and Angular Momentum ($\\delta E/E$, $\\delta L/L$)**\n\nThe second task concerns the accumulation of floating-point round-off error in the conserved quantities of total energy $E$ and total angular momentum $L$. The problem specifies that this accumulation behaves as an uncorrelated random walk. For a random walk, the root-mean-square (RMS) deviation after $N$ steps grows as $\\sqrt{N}$ times the RMS size of a single step's contribution.\n\nThe total number of timesteps is $N = t / \\Delta t$:\n$$\nN = \\frac{1.0 \\times 10^9 \\text{ years}}{0.02 \\text{ years}} = 5 \\times 10^{10} \\text{ steps}\n$$\nThe total RMS error will be proportional to $\\sqrt{N}$:\n$$\n\\sqrt{N} = \\sqrt{5 \\times 10^{10}} = \\sqrt{50} \\times 10^4 \\approx 7.071 \\times 10^4\n$$\nIn each step of the integration, floating-point arithmetic operations (addition, multiplication) on the position and velocity vectors introduce a small error. The magnitude of this error is proportional to the machine epsilon, $\\epsilon$, and the magnitude of the quantities being operated on. For a standard update step like $x_{k+1} = x_k + v_k \\Delta t + \\dots$, the error introduced in the sum is roughly of order $\\epsilon |x_{k+1}|$. Thus, the per-step fractional error introduced into the state variables is of order $\\epsilon$.\n\nSince both total energy $E$ and angular momentum $L$ are functions of position and velocity, this per-step error in the state vector introduces a random error in the computed values of $E$ and $L$. For a system with characteristic quantities of position $a$ and velocity $v \\sim na$, the magnitudes of energy and angular momentum are $|E| \\sim m(na)^2$ and $L \\sim m a (na)$. A per-step fractional error of $\\epsilon$ in position and velocity propagates to a per-step fractional error of order $\\epsilon$ in both $E$ and $L$.\n\nThus, we model the fractional error in a quantity $Q$ (where $Q$ is either $E$ or $L$) at each step as a random variable with RMS size $\\epsilon$. The total accumulated fractional error over $N$ steps is:\n$$\n\\frac{\\delta Q}{Q} \\approx \\epsilon \\sqrt{N}\n$$\nThis model is appropriate because the problem states to neglect truncation error for these quantities, which is justified as symplectic integrators exhibit bounded oscillations in energy and excellent conservation of angular momentum for central force problems. The only source of secular drift is then the random walk of round-off errors.\n\nUsing the given machine epsilon $\\epsilon = 2.22 \\times 10^{-16}$ and the calculated $\\sqrt{N}$:\n$$\n\\frac{\\delta E}{E} \\approx \\frac{\\delta L}{L} \\approx (2.22 \\times 10^{-16}) \\times (7.071 \\times 10^4) \\approx 1.5699... \\times 10^{-11}\n$$\nRounding to three significant figures, the fractional drifts are:\n$$\n\\frac{\\delta E}{E} \\approx 1.57 \\times 10^{-11}\n$$\n$$\n\\frac{\\delta L}{L} \\approx 1.57 \\times 10^{-11}\n$$\nThe problem is well-defined as the result is independent of $m$, $M$, and $a$, depending only on the numerical parameters $t$, $\\Delta t$, and $\\epsilon$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.13 \\times 10^{6}  1.57 \\times 10^{-11}  1.57 \\times 10^{-11} \\end{pmatrix}}\n$$"
        }
    ]
}