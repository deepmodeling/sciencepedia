{
    "hands_on_practices": [
        {
            "introduction": "在引力微透镜中，爱因斯坦半径是定义该现象角尺度的最基本参数。本练习将引导您从广义相对论的第一性原理出发，推导出这一关键参数的表达式，并计算一个典型值。通过这个实践，您将直观地理解为何对于银河系内的微透镜事件，我们无法直接分辨被引力透镜放大的像，而是观测其光度放大效应 。",
            "id": "4182103",
            "problem": "银河系中的一个点质量引力微透镜根据广义相对论（GR）使光线偏转。考虑一个距离为 $D_S = 8\\,\\mathrm{kpc}$ 的源恒星，其后方有一个质量为 $M = 0.3\\,M_{\\odot}$、距离为 $D_L = 6\\,\\mathrm{kpc}$ 的透镜。在薄透镜、小角度近似下进行计算，并假设一个适用于银河系尺度的、平直空间中的静态弱场点质量透镜。使用以下基本要素作为出发点：(i) 点质量在冲击参数 $b$ 处产生的光线偏折角（GR），$\\hat{\\alpha} = 4GM/(c^2 b)$，以及 (ii) 小角度透镜几何，其中折合偏折角为 $\\alpha = (D_{LS}/D_S)\\,\\hat{\\alpha}$，其中 $D_{LS} = D_S - D_L$，并且所有角度通过 $b \\approx D_L \\,\\theta$ 与物理距离相关联。\n\n1. 基于这些基础，推导在源-透镜-观测者完美对齐情况下的角爱因斯坦半径 $\\theta_E$ 的表达式。然后，对 $M=0.3\\,M_{\\odot}$、$D_L=6\\,\\mathrm{kpc}$ 和 $D_S=8\\,\\mathrm{kpc}$ 的情况，数值计算 $\\theta_E$。\n\n2. 将 $\\theta_E$ 的最终数值以毫角秒（milliarcsecond (mas)）为单位表示。将你的答案四舍五入到三位有效数字。\n\n3. 简要地用文字评估，对于典型的地面台站视宁度限制的角分辨率（数量级为 $0.7$–$1.0\\,\\mathrm{arcsec}$ 半高全宽（FWHM）），相应的爱因斯坦环或单个微像是否可以直接分辨。你的评估不属于最终数值答案的一部分。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个基于广义相对论在弱场极限下的既定原理的引力微透镜标准问题。所有必要的数据和基础方程均已提供。因此，我们可以着手求解。\n\n问题分为三个部分：首先，推导角爱因斯坦半径 $\\theta_E$ 的表达式；其次，为给定参数计算其数值；第三，评估其可观测性。\n\n**第1部分：爱因斯坦半径 $\\theta_E$ 的推导与数值计算**\n\n透镜方程将源的真实角位置 $\\beta$ 与像的表观角位置 $\\theta$ 联系起来。对于点质量透镜，几何结构是轴对称的，标量透镜方程由下式给出：\n$$ \\beta = \\theta - \\alpha(\\theta) $$\n其中 $\\alpha(\\theta)$ 是折合偏折角，它依赖于像的位置 $\\theta$。\n\n源、透镜和观测者的完美对齐对应于源的真实位置在光轴上的情况，即 $\\beta=0$。在这种特定配置下，透镜成像在透镜位置周围形成一个完美的环，称为爱因斯坦环。根据定义，这个环的角半径就是爱因斯坦半径 $\\theta_E$。\n\n在透镜方程中设 $\\beta = 0$ 和 $\\theta = \\theta_E$，得到爱因斯坦半径的条件：\n$$ \\theta_E = \\alpha(\\theta_E) $$\n问题提供了表达 $\\alpha(\\theta_E)$ 所需的关系式。折合偏折角 $\\alpha$ 与真实的广义相对论偏折角 $\\hat{\\alpha}$ 的关系如下：\n$$ \\alpha = \\frac{D_{LS}}{D_S} \\hat{\\alpha} $$\n其中 $D_S$ 是观测者-源距离，$D_L$ 是观测者-透镜距离，而 $D_{LS} = D_S - D_L$ 是透镜-源距离。\n\n对于质量为 $M$ 的点质量，在冲击参数 $b$ 处的真实偏折角 $\\hat{\\alpha}$ 由下式给出：\n$$ \\hat{\\alpha} = \\frac{4GM}{c^2 b} $$\n其中 $G$ 是引力常数，$c$ 是光速。\n\n最后，在小角度近似下，对应于角度 $\\theta$ 处的像的冲击参数 $b$ 由 $b \\approx D_L \\theta$ 给出。对于爱因斯坦环，冲击参数为 $b_E = D_L \\theta_E$。\n\n现在我们可以将这些表达式代入 $\\theta_E$ 的条件中。首先，用 $\\theta$ 表示 $\\alpha$：\n$$ \\hat{\\alpha}(\\theta) = \\frac{4GM}{c^2 (D_L \\theta)} $$\n$$ \\alpha(\\theta) = \\frac{D_{LS}}{D_S} \\left( \\frac{4GM}{c^2 D_L \\theta} \\right) = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} \\frac{1}{\\theta} $$\n现在，应用条件 $\\theta_E = \\alpha(\\theta_E)$：\n$$ \\theta_E = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} \\frac{1}{\\theta_E} $$\n解出 $\\theta_E$ 得：\n$$ \\theta_E^2 = \\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S} $$\n取平方根得到所求的角爱因斯坦半径表达式：\n$$ \\theta_E = \\sqrt{\\frac{4GM}{c^2} \\frac{D_{LS}}{D_L D_S}} $$\n这就是推导出的表达式。我们可以代入 $D_{LS} = D_S - D_L$ 得到等价形式：\n$$ \\theta_E = \\sqrt{\\frac{4GM}{c^2} \\frac{D_S - D_L}{D_L D_S}} $$\n\n接下来，我们对这个表达式进行数值计算。给定的参数是：\n- 透镜质量：$M = 0.3\\,M_{\\odot}$\n- 透镜距离：$D_L = 6\\,\\mathrm{kpc}$\n- 源距离：$D_S = 8\\,\\mathrm{kpc}$\n\n这意味着透镜-源距离为 $D_{LS} = D_S - D_L = 2\\,\\mathrm{kpc}$。我们使用以下国际单位制（SI）中的标准物理常数：\n- 引力常数：$G \\approx 6.674 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n- 光速：$c \\approx 2.998 \\times 10^8\\,\\mathrm{m\\,s^{-1}}$\n- 太阳质量：$M_{\\odot} \\approx 1.989 \\times 10^{30}\\,\\mathrm{kg}$\n- 千秒差距：$1\\,\\mathrm{kpc} \\approx 3.086 \\times 10^{19}\\,\\mathrm{m}$\n\n首先，我们将给定物理量转换为国际单位制：\n- $M = 0.3 \\times (1.989 \\times 10^{30}\\,\\mathrm{kg}) = 5.967 \\times 10^{29}\\,\\mathrm{kg}$\n- $D_L = 6 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 1.8516 \\times 10^{20}\\,\\mathrm{m}$\n- $D_S = 8 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 2.4688 \\times 10^{20}\\,\\mathrm{m}$\n- $D_{LS} = 2 \\times (3.086 \\times 10^{19}\\,\\mathrm{m}) = 6.172 \\times 10^{19}\\,\\mathrm{m}$\n\n现在，我们计算 $\\theta_E^2$ 表达式中的两项：\n第一项是与透镜质量相关的特征长度尺度：\n$$ \\frac{4GM}{c^2} = \\frac{4 \\times (6.674 \\times 10^{-11}) \\times (5.967 \\times 10^{29})}{(2.998 \\times 10^8)^2} \\approx 1.772 \\times 10^3\\,\\mathrm{m} $$\n第二项是描述透镜几何的因子，其单位是长度的倒数。使用kpc单位计算更为直接：\n$$ \\frac{D_{LS}}{D_L D_S} = \\frac{D_S - D_L}{D_L D_S} = \\frac{8\\,\\mathrm{kpc} - 6\\,\\mathrm{kpc}}{(6\\,\\mathrm{kpc})(8\\,\\mathrm{kpc})} = \\frac{2}{48}\\,\\mathrm{kpc}^{-1} = \\frac{1}{24}\\,\\mathrm{kpc}^{-1} $$\n将其转换为国际单位制（米的倒数）：\n$$ \\frac{1}{24\\,\\mathrm{kpc}} = \\frac{1}{24 \\times (3.086 \\times 10^{19}\\,\\mathrm{m})} \\approx 1.350 \\times 10^{-21}\\,\\mathrm{m^{-1}} $$\n现在，我们将这两项相乘得到 $\\theta_E^2$：\n$$ \\theta_E^2 = \\left(\\frac{4GM}{c^2}\\right) \\left(\\frac{D_{LS}}{D_L D_S}\\right) = (1.772 \\times 10^3\\,\\mathrm{m}) \\times (1.350 \\times 10^{-21}\\,\\mathrm{m^{-1}}) \\approx 2.392 \\times 10^{-18} $$\n这个值是无量纲的，符合弧度制下角度平方的要求。\n取平方根得到以弧度为单位的 $\\theta_E$：\n$$ \\theta_E = \\sqrt{2.392 \\times 10^{-18}} \\approx 1.547 \\times 10^{-9}\\,\\mathrm{radians} $$\n\n**第2部分：转换为毫角秒**\n\n最后一步是将这个角度从弧度转换为毫角秒（mas），并四舍五入到三位有效数字。转换因子是：\n$1\\,\\mathrm{radian} = \\frac{180}{\\pi}\\,\\mathrm{degrees}$\n$1\\,\\mathrm{degree} = 3600\\,\\mathrm{arcseconds}$\n$1\\,\\mathrm{arcsecond} = 1000\\,\\mathrm{mas}$\n因此，$1\\,\\mathrm{radian} \\approx 206264.8\\,\\mathrm{arcseconds} = 2.062648 \\times 10^8\\,\\mathrm{mas}$。\n\n$$ \\theta_E (\\mathrm{mas}) = (1.547 \\times 10^{-9}\\,\\mathrm{rad}) \\times (2.062648 \\times 10^8\\,\\mathrm{mas/rad}) \\approx 0.31915\\,\\mathrm{mas} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\theta_E \\approx 0.319\\,\\mathrm{mas} $$\n\n**第3部分：可分辨性评估**\n\n该微透镜事件的特征角尺度是爱因斯坦环的直径，即 $2\\theta_E \\approx 2 \\times 0.319\\,\\mathrm{mas} = 0.638\\,\\mathrm{mas}$。问题陈述指出，典型的地面台站视宁度限制的角分辨率在 $0.7$–$1.0\\,\\mathrm{arcsec}$ 的数量级。将其转换为毫角秒，得到视宁盘的半高全宽为 $700$–$1000\\,\\mathrm{mas}$。\n\n透镜成像的角大小（$\\sim 0.6\\,\\mathrm{mas}$）比大气视宁度极限（$\\sim 1000\\,\\mathrm{mas}$）小三个数量级以上。因此，用受视宁度限制的地面望远镜不可能分辨出单个微像或爱因斯坦环。观测者将看到一个单一的、未分辨的光点，其表观亮度是源和其透镜成像亮度的总和。微透镜效应的主要可观测效应是这种光度放大，它随着源、透镜和观测者之间对齐情况随时间的变化而变化。这也正是该现象被称为*微*透镜效应的原因。",
            "answer": "$$\n\\boxed{0.319}\n$$"
        },
        {
            "introduction": "行星伴星的存在会使微透镜的放大图像变得复杂，形成称为“焦散线”的结构。当背景源星穿过焦散线时，其亮度会发生剧烈而快速的变化，这是寻找系外行星的一个关键信号。通过从基本几何学原理推导焦散线穿越时长，您将深入了解光变曲线的特征如何揭示行星系统和源星自身的物理属性 。",
            "id": "4182049",
            "problem": "在一次引力微透镜事件中，行星扰动会产生一个尖锐的折叠焦散线，背景源恒星会穿过它。假设在穿越期间，该焦散线在局部可以很好地近似为一条直线，源恒星具有均匀的表面亮度，其角半径为 $\\theta_{\\ast}$，并且透镜-源的地心相对自行运动为 $\\mu_{\\text{rel}}$（天空中的一个角速度）。设 $\\alpha$ 为在天球平面上测量的、源的轨迹与穿越点处焦散线切线之间的夹角。忽略在恒星直径范围内的任何焦散线曲率、穿越期间的透镜轨道运动以及微透镜视差效应。\n\n仅使用几何推理和自行作为角速度的定义，从第一性原理推导恒星边缘与焦散线的第一次和第二次接触之间的持续时间 $t_{\\rm cc}$（整个恒星盘面穿越焦散线的持续时间）的表达式，用 $\\theta_{\\ast}$、$\\mu_{\\text{rel}}$ 和 $\\alpha$ 表示。然后对以下数值计算你的表达式：\n- $\\theta_{\\ast} = 1.2\\,\\mu\\mathrm{as}$（微角秒，其中 $1\\,\\mu\\mathrm{as} = 10^{-6}\\,\\mathrm{arcsec}$），\n- $\\mu_{\\text{rel}} = 6.0\\,\\mathrm{mas}\\,\\mathrm{yr}^{-1}$（毫角秒每年，其中 $1\\,\\mathrm{mas} = 10^{-3}\\,\\mathrm{arcsec}$），\n- $\\alpha = 30.0^\\circ$（度）。\n\n将最终持续时间以小时为单位表示，并将答案四舍五入到三位有效数字。使用 $1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days}$ 和 $1\\,\\mathrm{day} = 24\\,\\mathrm{hours}$。不要假设任何现成的微透镜公式；从基本的运动学和平面几何开始。你的最终答案必须是一个实数。",
            "solution": "这个问题提得很好，并且科学上是合理的，允许基于几何学和运动学的第一性原理直接求解。我们的任务是推导焦散线穿越持续时间的表达式，然后进行数值计算。\n\n让我们在天球平面上对该事件进行建模。焦散线近似为一条直线。我们建立一个笛卡尔坐标系，使得焦散线位于 x 轴上，因此其方程为 $y=0$。源恒星是一个角半径为 $\\theta_{\\ast}$ 的圆盘。源恒星的中心以恒定的地心相对自行运动 $\\mu_{\\text{rel}}$ 移动，这是一个角速度。恒星中心的路径是一条直线，我们称之为轨迹。该轨迹与焦散线（x 轴）形成一个角度 $\\alpha$。\n\n焦散线穿越持续时间 $t_{\\text{cc}}$ 是“第一次接触”和“最后一次接触”之间的时间间隔。\n第一次接触发生在恒星盘面的前缘首次接触到焦散线时。在这一瞬间，恒星的中心位于位置 $(x_1, y_1)$，并且圆盘与直线 $y=0$ 相切。对于一个以 $(x_1, y_1)$ 为中心、半径为 $\\theta_{\\ast}$ 的圆盘要与直线 $y=0$ 相切，其中心到该直线的垂直距离必须等于半径。假设恒星从 $y0$ 的方向接近，第一次接触发生在其中心的 y 坐标为 $y_1 = -\\theta_{\\ast}$ 的位置。如果它从 $y0$ 的方向接近，则 $y_1 = \\theta_{\\ast}$。总的来说，在第一次接触时，中心到焦散线的垂直距离为 $\\theta_{\\ast}$。\n\n最后一次接触发生在恒星盘面的后缘离开焦散线时。通过类似的论证，在这一刻，恒星已经完全穿过焦散线，其圆盘再次与直线 $y=0$ 相切，但位于另一侧。恒星中心到焦散线的垂直距离再次为 $\\theta_{\\ast}$。\n\n设 $d_{\\perp}$ 为在整个穿越事件中，恒星中心在垂直于焦散线的方向上行进的总距离。中心必须从焦散线一侧垂直距离为 $\\theta_{\\ast}$ 的位置移动到另一侧垂直距离为 $\\theta_{\\ast}$ 的位置。因此，行进的总垂直距离为 $d_{\\perp} = \\theta_{\\ast} + \\theta_{\\ast} = 2\\theta_{\\ast}$。\n\n恒星中心的速度是一个大小为 $\\mu_{\\text{rel}}$ 的矢量，其方向与焦散线成 $\\alpha$ 角。我们可以将此速度分解为两个分量：一个平行于焦散线，$\\mu_{\\parallel} = \\mu_{\\text{rel}} \\cos(\\alpha)$，一个垂直于焦散线，$\\mu_{\\perp} = \\mu_{\\text{rel}} \\sin(\\alpha)$。我们必须考虑绝对值，但由于两条线之间的夹角通常取在 $[0, 90^\\circ]$ 范围内，或者物理问题暗示的几何结构中 $\\sin(\\alpha)$ 为正，我们继续使用 $\\sin(\\alpha)$。对于 $\\alpha=30.0^\\circ$，这是有效的。\n\n穿越的持续时间 $t_{\\text{cc}}$ 由恒星以垂直速度 $\\mu_{\\perp}$ 行进垂直距离 $d_{\\perp}$ 所需的时间确定。\n$$t_{\\text{cc}} = \\frac{d_{\\perp}}{\\mu_{\\perp}}$$\n代入 $d_{\\perp}$ 和 $\\mu_{\\perp}$ 的表达式，我们得到：\n$$t_{\\text{cc}} = \\frac{2\\theta_{\\ast}}{\\mu_{\\text{rel}} \\sin(\\alpha)}$$\n这是从第一性原理推导出的整个恒星盘面穿越焦散线持续时间的符号表达式。\n\n现在，我们对给定的数值计算这个表达式：\n- 恒星角半径：$\\theta_{\\ast} = 1.2\\,\\mu\\mathrm{as} = 1.2 \\times 10^{-6}\\,\\mathrm{arcsec}$。\n- 相对自行运动：$\\mu_{\\text{rel}} = 6.0\\,\\mathrm{mas}\\,\\mathrm{yr}^{-1} = 6.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}$。\n- 穿越角度：$\\alpha = 30.0^\\circ$。\n\n首先，我们计算 $\\sin(\\alpha)$：\n$$\\sin(30.0^\\circ) = 0.5$$\n\n接下来，我们将数值代入推导出的 $t_{\\text{cc}}$ 公式中：\n$$t_{\\text{cc}} = \\frac{2 \\times (1.2 \\times 10^{-6}\\,\\mathrm{arcsec})}{(6.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}) \\times 0.5}$$\n$$t_{\\text{cc}} = \\frac{2.4 \\times 10^{-6}\\,\\mathrm{arcsec}}{3.0 \\times 10^{-3}\\,\\mathrm{arcsec}\\,\\mathrm{yr}^{-1}}$$\n$$t_{\\text{cc}} = 0.8 \\times 10^{-3}\\,\\mathrm{yr} = 8.0 \\times 10^{-4}\\,\\mathrm{yr}$$\n\n问题要求最终答案以小时为单位。我们使用给定的转换因子：\n- $1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days}$\n- $1\\,\\mathrm{day} = 24\\,\\mathrm{hours}$\n\n一年中的小时数为：\n$$1\\,\\mathrm{yr} = 365.25\\,\\mathrm{days} \\times 24\\,\\mathrm{hours/day} = 8766\\,\\mathrm{hours}$$\n\n现在，我们将 $t_{\\text{cc}}$ 从年转换成小时：\n$$t_{\\text{cc}} = (8.0 \\times 10^{-4}\\,\\mathrm{yr}) \\times (8766\\,\\mathrm{hours/yr})$$\n$$t_{\\text{cc}} = 7.0128\\,\\mathrm{hours}$$\n\n最后，我们按照要求将结果四舍五入到三位有效数字：\n$$t_{\\text{cc}} \\approx 7.01\\,\\mathrm{hours}$$",
            "answer": "$$\\boxed{7.01}$$"
        },
        {
            "introduction": "本练习旨在搭建理想化理论与真实天文数据复杂性之间的桥梁，关注一个在实际观测中普遍存在的系统效应——光污染（blending）。在许多情况下，来自被透镜化源星的光会与来自附近未分辨恒星的光混合在一起。这个编码练习将模拟这种情况，让您通过拟合来量化忽略光污染效应会如何导致我们对透镜物理参数的错误估计，从而强调在科学分析中建立完备物理模型的重要性 。",
            "id": "4182113",
            "problem": "您的任务是量化在拟合点源点透镜 (PSPL) 引力微透镜光变曲线时，因忽略流量混合而引入的参数偏差。由单个点质量透镜化的点源的 PSPL 放大率由 $A(u) = \\dfrac{u^2 + 2}{u \\sqrt{u^2 + 4}}$ 给出，其中 $u(t) = \\sqrt{u_0^2 + \\left(\\dfrac{t - t_0}{t_E}\\right)^2}$，$u_0$ 是最小撞击参数，$t_0$ 是峰值放大率时间，$t_E$ 是爱因斯坦时间标度。观测到的混合流量为 $F(t) = F_s A(u(t)) + F_b$，其中 $F_s$ 是源流量，$F_b$ 是来自无关源的混合流量。基线流量为 $F_0 = F_s + F_b$，表观基线归一化放大率为 $\\tilde{A}(t) = \\dfrac{F(t)}{F_0} = 1 + s \\left(A(u(t)) - 1\\right)$，其中 $s = \\dfrac{F_s}{F_s + F_b} = 1 - g$ 且 $g = \\dfrac{F_b}{F_s + F_b}$ 是混合分数。\n\n在一个忽略混合的朴素拟合中，假设 $\\tilde{A}(t)$ 是由一个未混合的 PSPL 模型生成的，并用 $A\\!\\left(\\sqrt{u_0'^2 + \\left(\\dfrac{t - t_0}{t_E'}\\right)^2}\\right)$ 来拟合 $\\tilde{A}(t)$，从而通过在时间网格上最小化未混合 PSPL 模型与 $\\tilde{A}(t)$ 之间的残差平方和，从混合光变曲线中估计 $u_0'$ 和 $t_E'$。目标是计算分数偏差 $(\\delta t_E/t_E)$ 和 $(\\delta u_0/u_0)$，其中 $\\delta t_E = t_E' - t_E$ 和 $\\delta u_0 = u_0' - u_0$。\n\n从基本 PSPL 放大率 $A(u)$ 和流量叠加 $F(t) = F_s A(u(t)) + F_b$ 出发，推导一个算法，该算法对于给定的一组真实参数 $(u_0, t_E, t_0, g)$，在时间网格上构建 $\\tilde{A}(t)$，然后通过最小化非线性最小二乘目标函数 $\\sum_t \\left[A\\!\\left(\\sqrt{u_0'^2 + \\left(\\dfrac{t - t_0}{t_E'}\\right)^2}\\right) - \\tilde{A}(t)\\right]^2$ 来估计 $(u_0', t_E')$。使用该算法计算 $(\\delta t_E/t_E)$ 和 $(\\delta u_0/u_0)$。\n\n在一个完整、可运行的程序中实现该算法。必须评估以下测试套件：\n\n- 案例 1：$u_0 = 0.1$，$t_E = 20$ 天，$t_0 = 0$ 天，$g = 0.0$。\n- 案例 2：$u_0 = 0.1$，$t_E = 20$ 天，$t_0 = 0$ 天，$g = 0.5$。\n- 案例 3：$u_0 = 0.01$，$t_E = 30$ 天，$t_0 = 0$ 天，$g = 0.9$。\n- 案例 4：$u_0 = 1.0$，$t_E = 5$ 天，$t_0 = 0$ 天，$g = 0.2$。\n\n对于每个案例，构建一个包含 $201$ 个样本的均匀时间网格，范围从 $t = t_0 - 5 t_E$ 到 $t = t_0 + 5 t_E$（单位为天），计算 $\\tilde{A}(t)$，并通过非线性最小二乘法拟合 $(u_0', t_E')$，约束条件为 $u_0'  0$ 和 $t_E'  0$。需要报告的分数偏差是 $(\\delta t_E/t_E)$ 和 $(\\delta u_0/u_0)$，它们是无单位的小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例的结果是一个双元素列表 $[\\delta t_E/t_E,\\delta u_0/u_0]$，没有空格，并按上述案例的顺序排列。例如，格式必须是 $[[\\delta t_{E,1}/t_{E,1},\\delta u_{0,1}/u_{0,1}],[\\delta t_{E,2}/t_{E,2},\\delta u_{0,2}/u_{0,2}],\\dots]$。不应打印任何其他文本。由于分数偏差是无单位的，最终输出中不出现物理单位。",
            "solution": "该问题要求量化当一个混合引力微透镜事件被错误地用一个未混合的点源点透镜 (PSPL) 模型拟合时所产生的参数偏差。这包括为一个混合事件生成合成数据，然后执行非线性最小二乘拟合，以找到与该数据最佳匹配的不正确模型的参数。偏差是拟合参数与真实参数之间的分数差异。\n\n逻辑步骤如下：\n1.  为真实（混合）和拟合（未混合）的光变曲线定义数学模型。\n2.  对于每个测试案例，根据提供的“真实”参数生成一条合成的混合光变曲线。\n3.  通过定义要最小化的目标函数来建立优化问题。\n4.  数值求解优化问题以找到有偏差的参数。\n5.  从真实参数和有偏差的参数计算所要求的分数偏差。\n\n**1. 数学模型**\n\n基本构建模块是 PSPL 放大率 $A(u)$，它取决于源和透镜星之间的无量纲投影分离距离 $u$：\n$$A(u) = \\frac{u^2 + 2}{u \\sqrt{u^2 + 4}}$$\n该表达式对 $u  0$ 有效。对于 $u \\to 0$，放大率发散为 $A(u) \\approx 1/u$，这对应于完美对齐。\n\n分离距离 $u$ 是时间 $t$ 的函数，由下式给出：\n$$u(t) = \\sqrt{u_0^2 + \\left(\\frac{t - t_0}{t_E}\\right)^2}$$\n这里，$u_0$ 是撞击参数（以爱因斯坦半径为单位的最小分离距离），$t_0$ 是最接近时间（因此是峰值放大率时间），$t_E$ 是爱因斯坦时间标度，它表征了事件的持续时间。\n\n在现实场景中，观测到的光可能包含来自源或透镜附近未分辨恒星的流量，这被称为混合光。总观测流量 $F(t)$ 是放大后的源流量 $F_s A(u(t))$ 和恒定的混合流量 $F_b$ 的总和：\n$$F(t) = F_s A(u(t)) + F_b$$\n在分析光变曲线时，流量通常由基线流量 $F_0$ 进行归一化，基线流量是远离透镜事件峰值时的流量，此时 $A(u(t)) \\to 1$。因此，$F_0 = F_s + F_b$。表观的、基线归一化的放大率 $\\tilde{A}(t)$ 是：\n$$\\tilde{A}(t) = \\frac{F(t)}{F_0} = \\frac{F_s A(u(t)) + F_b}{F_s + F_b}$$\n这可以使用混合分数 $g = F_b / (F_s + F_b)$ 和源流量分数 $s = F_s / (F_s + F_b) = 1 - g$ 重写为：\n$$\\tilde{A}(t) = \\frac{F_s}{F_s + F_b} A(u(t)) + \\frac{F_b}{F_s + F_b} = s A(u(t)) + g = (1-g)A(u(t)) + g$$\n重新整理成更标准的形式可以突出与基线 1 的偏差：\n$$\\tilde{A}(t) = 1 + s(A(u(t)) - 1)$$\n这就是我们将要生成的合成数据的“真实”模型。\n\n一个朴素的分析会忽略混合（即假设 $g=0$ 和 $s=1$），并试图用一个纯 PSPL 模型来拟合数据 $\\tilde{A}(t)$。这个我们记为 $A_{fit}$ 的拟合模型有它自己的参数 $u_0'$ 和 $t_E'$：\n$$A_{fit}(t; u_0', t_E') = A\\left(\\sqrt{u_0'^2 + \\left(\\frac{t - t_0}{t_E'}\\right)^2}\\right)$$\n问题指明峰值放大率时间不是一个拟合参数，而是固定为真实值 $t_0$。\n\n**2. 合成数据生成**\n\n对于每组给定的真实参数 $(u_0, t_E, t_0, g)$，我们必须首先生成合成的“观测”数据。这包括：\n- 创建一个包含 $201$ 个点的时间网格，范围从 $t_{start} = t_0 - 5 t_E$ 到 $t_{end} = t_0 + 5 t_E$。设此网格为 $\\{t_i\\}$。\n- 使用真实参数 $(u_0, t_E, t_0)$ 计算每个时间样本上的真实分离距离 $u(t_i)$。\n- 计算每个样本上的真实 PSPL 放大率 $A(u(t_i))$。\n- 计算源流量分数 $s = 1 - g$。\n- 计算所有 $t_i$ 的表观放大率 $\\tilde{A}(t_i) = 1 + s(A(u(t_i)) - 1)$。生成的数组 $\\{\\tilde{A}(t_i)\\}$ 就是我们的合成数据集。\n\n**3. 优化问题**\n\n目标是找到参数 $(u_0', t_E')$，使得朴素模型 $A_{fit}(t; u_0', t_E')$ 与合成数据 $\\{\\tilde{A}(t_i)\\}$ 最佳匹配。这是通过最小化残差平方和（目标函数 $\\chi^2$）来实现的：\n$$\\chi^2(u_0', t_E') = \\sum_i \\left[ A_{fit}(t_i; u_0', t_E') - \\tilde{A}(t_i) \\right]^2$$\n这是一个标准的非线性最小二乘优化问题。待优化的参数是向量 $\\mathbf{p} = [u_0', t_E']$。最小化必须在物理约束条件 $u_0'  0$ 和 $t_E'  0$ 下进行。\n\n**4. 数值解法**\n\n我们使用 `scipy.optimize.least_squares` 函数，该函数专为此类问题设计。此函数迭代地调整参数向量 $\\mathbf{p}$，以最小化用户提供的残差函数的平方和。\n残差函数 $R(\\mathbf{p})$ 返回一个向量，其元素是模型与数据在每个时间步长的差值：\n$$R_i(\\mathbf{p}) = A_{fit}(t_i; u_0', t_E') - \\tilde{A}(t_i)$$\n`least_squares` 算法最小化 $\\sum_i R_i^2$。\n- **初始猜测：** 一个好的优化初始猜测对于收敛至关重要。真实参数 $(u_0, t_E)$ 是一个绝佳的起点。\n- **边界：** 通过向求解器提供 `bounds=([0, 0], [inf, inf])` 来强制执行约束条件 $u_0'  0$ 和 $t_E'  0$。\n\n求解器返回一个结果对象，我们从中提取最优参数向量 $\\mathbf{p}_{opt} = [u_0', t_E']$。\n\n**5. 偏差计算**\n\n一旦确定了最佳拟合参数 $(u_0', t_E')$，最后一步就是计算相对于真实参数 $(u_0, t_E)$ 的分数偏差：\n- 爱因斯坦时间标度的分数偏差：$\\dfrac{\\delta t_E}{t_E} = \\dfrac{t_E' - t_E}{t_E}$\n- 撞击参数的分数偏差：$\\dfrac{\\delta u_0}{u_0} = \\dfrac{u_0' - u_0}{u_0}$\n\n对于混合分数 $g=0$ 的情况，我们有 $s=1$，因此 $\\tilde{A}(t) = A(u(t))$。合成数据是一条精确的未混合 PSPL 曲线。因此，最小二乘拟合应该能恢复真实参数，得出 $(u_0', t_E') = (u_0, t_E)$，从而在数值精度范围内产生零偏差。这为实现提供了一个有价值的合理性检查。对于 $g  0$ 的情况，我们预计拟合会受到影响，导致非零偏差。通常，混合会使事件看起来具有较低的峰值放大率和较窄的翼部，未混合模型通过增加撞击参数（$u_0'  u_0$）和减小时间标度（$t_E'  t_E$）来对此进行补偿。这导致 $u_0$ 出现正偏差，$t_E$ 出现负偏差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef pspl_magnification(u):\n    \"\"\"\n    Computes the Point Source Point Lens (PSPL) magnification.\n    Args:\n        u (float or np.ndarray): The dimensionless source-lens separation.\n    Returns:\n        float or np.ndarray: The magnification A(u).\n    \"\"\"\n    u_sq = u**2\n    return (u_sq + 2) / (u * np.sqrt(u_sq + 4))\n\ndef model_unblended(t, u0, tE, t0):\n    \"\"\"\n    Computes the unblended PSPL model light curve.\n    Args:\n        t (np.ndarray): Array of times.\n        u0 (float): Impact parameter.\n        tE (float): Einstein timescale.\n        t0 (float): Time of peak magnification.\n    Returns:\n        np.ndarray: The model magnification at each time t.\n    \"\"\"\n    u = np.sqrt(u0**2 + ((t - t0) / tE)**2)\n    # Handle u=0 case to avoid division by zero, although it's unlikely on a grid.\n    # Magnification is infinite at u=0, but we can use a very large number.\n    # For u -> 0, A(u) -> 1/u.\n    # We add a small epsilon to u to prevent division by zero.\n    epsilon = 1e-12\n    return pspl_magnification(u + epsilon)\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the validation and calculation for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (u0_true, tE_true, t0_true, g_true)\n        (0.1, 20.0, 0.0, 0.0),   # Case 1\n        (0.1, 20.0, 0.0, 0.5),   # Case 2\n        (0.01, 30.0, 0.0, 0.9),  # Case 3\n        (1.0, 5.0, 0.0, 0.2),    # Case 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        u0_true, tE_true, t0_true, g_true = case\n        \n        # 1. Generate synthetic \"observed\" data\n        s_true = 1.0 - g_true\n        \n        time_grid = np.linspace(t0_true - 5 * tE_true, t0_true + 5 * tE_true, 201)\n        \n        # True unblended magnification\n        A_true = model_unblended(time_grid, u0_true, tE_true, t0_true)\n        \n        # Apparent (blended) magnification\n        A_tilde_data = 1.0 + s_true * (A_true - 1.0)\n        \n        # 2. Set up the nonlinear least-squares fit\n        \n        def residual_function(params, t, t0, data):\n            \"\"\"\n            Residual function for the least-squares fitter.\n            The function to be minimized is the sum of squares of this residual.\n            \"\"\"\n            u0_fit, tE_fit = params\n            model_pred = model_unblended(t, u0_fit, tE_fit, t0)\n            return model_pred - data\n\n        # Initial guess for the parameters [u0_prime, tE_prime]\n        initial_guess = [u0_true, tE_true]\n        \n        # Physical bounds for the parameters: u0' > 0, tE' > 0\n        param_bounds = ([1e-9, 1e-9], [np.inf, np.inf])\n\n        # 3. Perform the fit\n        fit_result = least_squares(\n            residual_function,\n            initial_guess,\n            bounds=param_bounds,\n            args=(time_grid, t0_true, A_tilde_data)\n        )\n        \n        u0_fit, tE_fit = fit_result.x\n        \n        # 4. Calculate fractional biases\n        delta_tE_over_tE = (tE_fit - tE_true) / tE_true\n        delta_u0_over_u0 = (u0_fit - u0_true) / u0_true\n        \n        results.append([delta_tE_over_tE, delta_u0_over_u0])\n\n    # Final print statement in the exact required format.\n    # e.g., [[-0.1,0.2],[-0.3,0.4]]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}