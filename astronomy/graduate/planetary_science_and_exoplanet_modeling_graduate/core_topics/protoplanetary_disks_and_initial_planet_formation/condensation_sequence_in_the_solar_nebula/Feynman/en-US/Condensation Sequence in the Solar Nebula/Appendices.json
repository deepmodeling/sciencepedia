{
    "hands_on_practices": [
        {
            "introduction": "The concept of a condensation sequence is built upon the principles of chemical thermodynamics. At its core, the sequence is a ranking of minerals by the temperature at which they become stable in a cooling gas of a specific pressure and composition. This first exercise  provides fundamental practice in this cornerstone calculation by asking you to determine the condensation temperature ($T_c$) of forsterite ($\\mathrm{Mg_2SiO_4}$), one of the most important high-temperature condensates in the solar nebula. By applying the law of mass action and using the equilibrium constant, you will directly compute the point at which the formation of this solid becomes thermodynamically favorable, a key skill for modeling the initial composition of planetary building blocks.",
            "id": "4157164",
            "problem": "A simplified equilibrium condensation calculation for the formation of forsterite $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$ from a solar-composition gas is to be carried out at a total gas pressure $P=10^{-3}\\ \\mathrm{bar}$. Assume the dominant gas species carrying the relevant elements at high temperature are $\\mathrm{Mg}(\\mathrm{g})$, $\\mathrm{SiO}(\\mathrm{g})$, and $\\mathrm{O}_{2}(\\mathrm{g})$, and that the solid forsterite has unit activity upon appearance. The reaction of interest is\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s}).$$\nTreat the gas as ideal, so that the partial pressure of species $i$ is $p_{i}=y_{i}\\,P$, where $y_{i}$ is its mole fraction in the gas and $P$ is the total pressure. Take the standard-state pressure to be $p^{\\circ}=1\\ \\mathrm{bar}$, so dimensionless activities of gases are $p_{i}/p^{\\circ}$ and the activity of the solid is $1$. Use the following solar-composition mole fractions for the uncondensed gas at the onset of condensation: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$, and $y_{\\mathrm{O}_{2}}=1.00\\times 10^{-6}$ (assumed approximately constant over the narrow temperature interval of interest). The tabulated equilibrium constant for the reaction above is provided as an empirical fit,\n$$\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T},$$\nwhere $K_{p}(T)$ is the equilibrium constant in terms of gas partial pressures and $T$ is the temperature in kelvin.\n\nStarting from the definitions of the equilibrium constant and the ideal gas law, derive the condition for the onset of forsterite condensation and compute the condensation temperature $T_{c}$ at which the reaction becomes thermodynamically favorable at $P=10^{-3}\\ \\mathrm{bar}$. Round your final numerical answer to four significant figures and express it in kelvin.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   System: A solar-composition gas.\n-   Process: Equilibrium condensation of forsterite, $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$.\n-   Total gas pressure: $P=10^{-3}\\ \\mathrm{bar}$.\n-   Gas species: $\\mathrm{Mg}(\\mathrmg)$, $\\mathrm{SiO}(\\mathrmg)$, $\\mathrm{O}_{2}(\\mathrmg)$.\n-   Solid activity: $a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrms})} = 1$.\n-   Reaction: $2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\longrightarrow \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$.\n-   Gas model: Ideal gas, partial pressure $p_{i}=y_{i}\\,P$.\n-   Standard-state pressure: $p^{\\circ}=1\\ \\mathrm{bar}$.\n-   Gas activities: $a_{i} = p_{i}/p^{\\circ}$.\n-   Mole fractions at onset of condensation: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrm{SiO}}=3.24\\times 10^{-5}$, $y_{\\mathrm{O}_{2}}=1.00\\times 10^{-6}$.\n-   Equilibrium constant fit: $\\log_{10}K_{p}(T)=-12.0+\\frac{6.45\\times 10^{4}}{T}$, where $T$ is in kelvin.\n-   Objective: Derive the condensation condition and compute the condensation temperature $T_{c}$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of chemical thermodynamics and their application to cosmochemistry, a subfield of planetary science. The condensation of forsterite is a cornerstone of models of the solar nebula. The reaction is stoichiometrically correct, and the use of the ideal gas law, partial pressures, and an empirical fit for the equilibrium constant are standard methodologies. The provided data values are physically plausible for the environment described.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary data and relationships (total pressure, mole fractions, and the temperature-dependent equilibrium constant) to solve for a single unknown, the condensation temperature $T_{c}$. A unique, stable, and meaningful solution is expected.\n-   **Objective**: The problem is stated in objective, quantitative terms, free from ambiguity, subjectivity, or opinion.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist (Scientific or Factual Unsoundness, Non-Formalizable or Irrelevant, Incomplete or Contradictory Setup, Unrealistic or Infeasible, Ill-Posed or Poorly Structured, Pseudo-Profound/Trivial, Outside Scientific Verifiability).\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\nThe condensation of forsterite, $\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrms})$, from a gas of solar composition is described by the chemical reaction:\n$$2\\,\\mathrm{Mg}(\\mathrm{g})+\\mathrm{SiO}(\\mathrm{g})+\\frac{3}{2}\\,\\mathrm{O}_{2}(\\mathrm{g})\\rightleftharpoons \\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrm{s})$$\nThe condition for chemical equilibrium is that the thermodynamic equilibrium constant, $K(T)$, is equal to the reaction quotient, $Q$. Condensation begins at the temperature $T_c$ where this condition is first met as the gas cools. The thermodynamic equilibrium constant is defined in terms of the activities, $a_i$, of the reactants and products.\n$$K(T) = \\frac{a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrms)}}{a_{\\mathrm{Mg}(\\mathrmg)}^{2} a_{\\mathrm{SiO}(\\mathrmg)} a_{\\mathrm{O}_{2}(\\mathrmg)}^{3/2}}$$\nThe problem states that the activity of the solid forsterite is unity, $a_{\\mathrm{Mg}_{2}\\mathrm{SiO}_{4}(\\mathrms})} = 1$. The activities of the ideal gas species are given by $a_i = p_i / p^{\\circ}$, where $p_i$ is the partial pressure of species $i$ and $p^{\\circ}=1\\ \\mathrm{bar}$ is the standard-state pressure. Substituting these into the expression for $K(T)$ gives:\n$$K(T) = \\frac{1}{\\left(\\frac{p_{\\mathrm{Mg}}}{p^{\\circ}}\\right)^{2} \\left(\\frac{p_{\\mathrm{SiO}}}{p^{\\circ}}\\right) \\left(\\frac{p_{\\mathrm{O}_2}}{p^{\\circ}}\\right)^{3/2}}$$\nThe partial pressure of each species $i$ is related to its mole fraction $y_i$ and the total pressure $P$ by the ideal gas law, $p_i = y_i P$. The onset of condensation occurs at temperature $T_c$ when the gas partial pressures satisfy the equilibrium condition. Substituting $p_i = y_i P$ into the equation:\n$$K(T_c) = \\frac{1}{\\left(\\frac{y_{\\mathrm{Mg}}P}{p^{\\circ}}\\right)^{2} \\left(\\frac{y_{\\mathrm{SiO}}P}{p^{\\circ}}\\right) \\left(\\frac{y_{\\mathrm{O}_2}P}{p^{\\circ}}\\right)^{3/2}}$$\nThis expression can be rearranged to group the mole fractions and the pressure terms:\n$$K(T_c) = \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} \\left(\\frac{P}{p^{\\circ}}\\right)^{4.5}}$$\nThe problem provides an empirical fit for the equilibrium constant, denoted as $K_p(T)$. Since the argument of a logarithm must be dimensionless, this $K_p(T)$ is the thermodynamic equilibrium constant $K(T)$. We can solve for $T_c$ by equating the two expressions for the equilibrium constant. It is most convenient to work with logarithms to handle the wide range of numerical values. Taking the base-$10$ logarithm of the expression for $K(T_c)$:\n$$\\log_{10} K(T_c) = \\log_{10} \\left( \\frac{1}{y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5}} \\right) = - \\log_{10} \\left( y_{\\mathrm{Mg}}^{2} y_{\\mathrm{SiO}} y_{\\mathrm{O}_2}^{3/2} (P/p^{\\circ})^{4.5} \\right)$$\nUsing the properties of logarithms, this becomes:\n$$\\log_{10} K(T_c) = - \\left[ 2\\log_{10}(y_{\\mathrm{Mg}}) + \\log_{10}(y_{\\mathrm{SiO}}) + \\frac{3}{2}\\log_{10}(y_{\\mathrm{O}_2}) + 4.5\\log_{10}\\left(\\frac{P}{p^{\\circ}}\\right) \\right]$$\nWe are given the values: $y_{\\mathrm{Mg}}=3.98\\times 10^{-5}$, $y_{\\mathrmSiO}=3.24\\times 10^{-5}$, $y_{\\mathrm{O}_2}=1.00\\times 10^{-6}$, and $P=10^{-3}\\ \\mathrm{bar}$, with $p^{\\circ}=1\\ \\mathrm{bar}$, so $P/p^{\\circ} = 10^{-3}$.\nLet's compute the terms in the square brackets:\n$2\\log_{10}(3.98\\times 10^{-5}) = 2(\\log_{10}(3.98) - 5) \\approx 2(0.59988 - 5) = 2(-4.40012) = -8.80024$\n$\\log_{10}(3.24\\times 10^{-5}) = \\log_{10}(3.24) - 5 \\approx 0.51055 - 5 = -4.48945$\n$\\frac{3}{2}\\log_{10}(1.00\\times 10^{-6}) = 1.5(-6) = -9.0$\n$4.5\\log_{10}(10^{-3}) = 4.5(-3) = -13.5$\nSumming these terms:\n$\\log_{10} K(T_c) = -[-8.80024 - 4.48945 - 9.0 - 13.5] = -[-35.78969] = 35.78969$\nNow, we equate this value with the given empirical fit for the equilibrium constant at $T=T_c$:\n$$\\log_{10}K_{p}(T_c) = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\n$$35.78969 = -12.0 + \\frac{6.45\\times 10^{4}}{T_c}$$\nSolving for $T_c$:\n$$35.78969 + 12.0 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$47.78969 = \\frac{6.45\\times 10^{4}}{T_c}$$\n$$T_c = \\frac{6.45\\times 10^{4}}{47.78969} \\approx 1349.6436\\ \\mathrm{K}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$T_c \\approx 1350\\ \\mathrm{K}$$\nThis is the condensation temperature of forsterite under the specified conditions.",
            "answer": "$$\n\\boxed{1350}\n$$"
        },
        {
            "introduction": "While calculating a condensation temperature at a fixed pressure is a crucial first step, in a real protoplanetary disk, both pressure and temperature are strong functions of location. This practice  challenges you to connect the microscopic chemistry of condensation with the macroscopic physics of disk structure. You will first derive an expression for the midplane pressure from the principles of vertical hydrostatic equilibrium and then use it to understand how the radial profiles of pressure and temperature jointly determine the location of condensation fronts, or \"ice lines,\" for volatile species. This exercise is essential for appreciating how the large-scale architecture of a disk dictates its chemical geography and the composition of forming planets.",
            "id": "4157114",
            "problem": "Consider a vertically isothermal, axisymmetric protoplanetary disk around a Sun-like star of mass $M_{\\star}$. The disk is in vertical hydrostatic equilibrium, so its vertical pressure gradient is balanced by stellar gravity. The local gas pressure $P(z)$ and mass density $\\rho(z)$ are related by the Ideal Gas Law, and the disk’s surface density $\\Sigma(r)$ is defined as the vertical integral of $\\rho(z)$ at cylindrical radius $r$. Assume the temperature is a function of radius only. You are modeling the condensation sequence in the solar nebula and need the midplane pressure to assess the location of condensation fronts.\n\nStarting from the fundamental relations of vertical hydrostatic balance, the Ideal Gas Law, and the definition of surface density, and assuming a vertically isothermal equation of state, derive an expression for the midplane pressure $P_{0}(r)$ in terms of $\\Sigma(r)$, the Keplerian angular frequency $\\Omega_{K}(r)$, the Boltzmann constant $k_{B}$, the mean molecular mass $\\mu$, and the midplane temperature $T(r)$. Then evaluate $P_{0}$ at $r = 2\\,\\mathrm{AU}$, for the following scientifically plausible disk model and constants:\n\n- Surface density profile: $\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$, with $\\Sigma_{0} = 1.7 \\times 10^{4}\\ \\mathrm{kg\\ m^{-2}}$, $r_{0} = 1\\ \\mathrm{AU}$, and $p = 1.5$.\n- Temperature profile: $T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$, with $T_{0} = 280\\ \\mathrm{K}$ and $q = 0.5$.\n- Star mass: $M_{\\star} = 1.9885 \\times 10^{30}\\ \\mathrm{kg}$.\n- Mean molecular mass: $\\mu = 2.34\\,m_{p}$, where $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$ is the proton mass.\n- Keplerian angular frequency: $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$, where $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^{3}\\ kg^{-1}\\ s^{-2}}$.\n- Boltzmann constant: $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$.\n- Astronomical Unit (AU): $1\\ \\mathrm{AU} = 1.495978707 \\times 10^{11}\\ \\mathrm{m}$.\n\nRound your numerical answer for $P_{0}(2\\,\\mathrm{AU})$ to three significant figures. Express the final pressure in $\\mathrm{Pa}$.\n\nFinally, explain based on first principles how the magnitude of $P_{0}(r)$ influences the radial locations of condensation fronts for a volatile species whose saturation vapor pressure follows a Clausius–Clapeyron form $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp\\!\\left(-\\frac{A}{T}\\right)$, if the species’ midplane partial pressure is $f_{i}\\,P_{0}(r)$, where $0 < f_{i} < 1$ is its molar fraction. Your explanation should be qualitative but grounded in the derived $P_{0}(r)$ dependencies. The explanation does not require any additional computation and does not affect the requested numerical answer for $P_{0}(2\\,\\mathrm{AU})$.",
            "solution": "The problem is validated against the specified criteria and is deemed scientifically grounded, well-posed, objective, and complete. All necessary physical principles, model parameters, and constants are provided and are consistent with established models in planetary science. The problem is a standard exercise in the study of protoplanetary disks. We may therefore proceed with the solution.\n\nThe problem asks for three distinct parts: first, to derive an expression for the midplane pressure $P_{0}(r)$; second, to evaluate this pressure at a specific radius; and third, to provide a qualitative explanation of how pressure influences condensation fronts.\n\nPart 1: Derivation of Midplane Pressure $P_{0}(r)$\n\nWe begin with the equation of vertical hydrostatic equilibrium, which states that the vertical pressure gradient is balanced by the vertical component of the star's gravity.\n$$\n\\frac{dP}{dz} = \\rho g_{z}\n$$\nwhere $P(z)$ is the pressure, $\\rho(z)$ is the mass density, and $g_{z}$ is the vertical component of the gravitational acceleration at a cylindrical radius $r$ and height $z$ above the midplane. For a thin disk where $z \\ll r$, the vertical acceleration due to the central star of mass $M_{\\star}$ is approximated as:\n$$\ng_{z} = - \\frac{G M_{\\star}}{r^{2}} \\sin(\\theta) \\approx - \\frac{G M_{\\star}}{r^{2}} \\tan(\\theta) = - \\frac{G M_{\\star}}{r^{2}} \\frac{z}{r} = - \\left(\\frac{G M_{\\star}}{r^{3}}\\right) z\n$$\nThe term in parentheses is the square of the Keplerian angular frequency, $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$. Thus, $g_{z} = -\\Omega_{K}^{2} z$. Substituting this into the hydrostatic equilibrium equation gives:\n$$\n\\frac{dP}{dz} = -\\rho(z) \\Omega_{K}^{2} z\n$$\nThe problem states that the gas is related by the Ideal Gas Law:\n$$\nP(z) = \\frac{\\rho(z) k_{B} T(r)}{\\mu}\n$$\nwhere $k_{B}$ is the Boltzmann constant, $\\mu$ is the mean molecular mass, and $T(r)$ is the temperature. A key assumption is that the disk is vertically isothermal, meaning $T$ is a function of $r$ only and does not vary with $z$. We can rearrange the Ideal Gas Law to express density in terms of pressure:\n$$\n\\rho(z) = \\frac{\\mu}{k_{B} T(r)} P(z)\n$$\nSubstituting this expression for $\\rho(z)$ into the hydrostatic balance equation gives a first-order differential equation for $P(z)$:\n$$\n\\frac{dP}{dz} = - \\left(\\frac{\\mu P(z)}{k_{B} T(r)}\\right) \\Omega_{K}^{2} z \\implies \\frac{1}{P} \\frac{dP}{dz} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} z\n$$\nWe can integrate this equation from the midplane (where $z=0$ and $P=P_{0}$) to a height $z$:\n$$\n\\int_{P_{0}}^{P(z)} \\frac{dP'}{P'} = - \\frac{\\mu \\Omega_{K}^{2}}{k_{B} T(r)} \\int_{0}^{z} z' dz'\n$$\n$$\n\\ln\\left(\\frac{P(z)}{P_{0}}\\right) = - \\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\n$$\nSolving for $P(z)$ yields a Gaussian pressure profile:\n$$\nP(z) = P_{0} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right)\n$$\nUsing the Ideal Gas Law again, we find the density profile:\n$$\n\\rho(z) = \\frac{\\mu P(z)}{k_{B} T(r)} = \\frac{\\mu P_{0}}{k_{B} T(r)} \\exp\\left(-\\frac{\\mu \\Omega_{K}^{2}}{2 k_{B} T(r)} z^{2}\\right) = \\rho_{0} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right)\n$$\nwhere $\\rho_{0} = \\frac{\\mu P_{0}}{k_{B} T(r)}$ is the midplane density and $h = \\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}$ is the gas pressure scale height.\n\nThe surface density $\\Sigma(r)$ is defined as the integral of the volume density over all $z$:\n$$\n\\Sigma(r) = \\int_{-\\infty}^{\\infty} \\rho(z) dz = \\rho_{0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{z^{2}}{2h^{2}}\\right) dz\n$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$. Here, $a = 1/(2h^{2})$, so the integral evaluates to $\\sqrt{2\\pi h^{2}} = h\\sqrt{2\\pi}$.\n$$\n\\Sigma(r) = \\rho_{0} h \\sqrt{2\\pi}\n$$\nOur goal is to find $P_{0}$. We substitute the expressions for $\\rho_{0}$ and $h$:\n$$\n\\Sigma(r) = \\left(\\frac{\\mu P_{0}}{k_{B} T(r)}\\right) \\left(\\sqrt{\\frac{k_{B} T(r)}{\\mu \\Omega_{K}^{2}}}\\right) \\sqrt{2\\pi}\n$$\nSimplifying this expression:\n$$\n\\Sigma(r) = \\frac{P_{0} \\sqrt{2\\pi\\mu}}{\\Omega_{K}(r) \\sqrt{k_{B} T(r)}}\n$$\nFinally, we rearrange to solve for the midplane pressure $P_{0}(r)$:\n$$\nP_{0}(r) = \\frac{\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}}{\\sqrt{2\\pi \\mu}}\n$$\nThis is the desired analytical expression.\n\nPart 2: Numerical Evaluation of $P_{0}(r=2\\,\\mathrm{AU})$\n\nWe are given the following constants and functional forms:\n- $r = 2\\,\\mathrm{AU} = 2 \\times 1.495978707 \\times 10^{11}\\,\\mathrm{m} = 2.991957414 \\times 10^{11}\\,\\mathrm{m}$.\n- $\\Sigma(r) = \\Sigma_{0} \\left(\\frac{r}{r_{0}}\\right)^{-p}$ with $\\Sigma_{0} = 1.7 \\times 10^{4}\\,\\mathrm{kg\\,m^{-2}}$, $r_{0} = 1\\,\\mathrm{AU}$, $p=1.5$.\nAt $r=2\\,\\mathrm{AU}$, $\\frac{r}{r_{0}} = 2$. So, $\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times (2)^{-1.5}\\,\\mathrm{kg\\,m^{-2}}$.\n- $T(r) = T_{0} \\left(\\frac{r}{r_{0}}\\right)^{-q}$ with $T_{0} = 280\\,\\mathrm{K}$, $q=0.5$.\nAt $r=2\\,\\mathrm{AU}$, $T(2\\,\\mathrm{AU}) = 280 \\times (2)^{-0.5}\\,\\mathrm{K}$.\n- $\\Omega_{K}(r) = \\sqrt{\\frac{G M_{\\star}}{r^{3}}}$ with $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$ and $M_{\\star} = 1.9885 \\times 10^{30}\\,\\mathrm{kg}$.\n- $\\mu = 2.34\\,m_{p} = 2.34 \\times 1.6726219 \\times 10^{-27}\\,\\mathrm{kg} = 3.913935246 \\times 10^{-27}\\,\\mathrm{kg}$.\n- $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n\nNow, we compute the values of each term at $r = 2\\,\\mathrm{AU}$:\n- $\\Sigma(2\\,\\mathrm{AU}) = (1.7 \\times 10^{4}) \\times 2^{-1.5} \\approx 6010.415\\,\\mathrm{kg\\,m^{-2}}$.\n- $T(2\\,\\mathrm{AU}) = 280 \\times 2^{-0.5} \\approx 197.990\\,\\mathrm{K}$.\n- $\\Omega_{K}(2\\,\\mathrm{AU}) = \\sqrt{\\frac{(6.67430 \\times 10^{-11}) \\times (1.9885 \\times 10^{30})}{(2.991957414 \\times 10^{11})^{3}}} \\approx 7.039016 \\times 10^{-8}\\,\\mathrm{s^{-1}}$.\n\nLet us now compute the numerator and denominator of the expression for $P_0$:\n- Numerator: $\\Sigma(r) \\Omega_{K}(r) \\sqrt{k_{B} T(r)}$\n$\\sqrt{k_{B} T(2\\,\\mathrm{AU})} = \\sqrt{(1.380649 \\times 10^{-23}) \\times 197.990} \\approx \\sqrt{2.73350 \\times 10^{-21}} \\approx 5.22829 \\times 10^{-11}\\,\\mathrm{J^{1/2}}$.\nNumerator $\\approx (6010.415) \\times (7.039016 \\times 10^{-8}) \\times (5.22829 \\times 10^{-11}) \\approx 2.21273 \\times 10^{-14}\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$.\n- Denominator: $\\sqrt{2\\pi \\mu}$\n$\\sqrt{2\\pi \\times (3.913935 \\times 10^{-27})} \\approx \\sqrt{2.45917 \\times 10^{-26}} \\approx 1.56817 \\times 10^{-13}\\,\\mathrm{kg^{1/2}}$.\n\nFinally, we calculate $P_{0}(2\\,\\mathrm{AU})$:\n$$\nP_{0}(2\\,\\mathrm{AU}) = \\frac{2.21273 \\times 10^{-14}}{1.56817 \\times 10^{-13}} \\approx 0.141103\\,\\mathrm{Pa}\n$$\nRounding to three significant figures, the midplane pressure is $0.141\\,\\mathrm{Pa}$.\n\nPart 3: Influence of $P_{0}(r)$ on Condensation Fronts\n\nA volatile species with molar fraction $f_i$ will condense out of the gas phase when its partial pressure, $P_{i}(r) = f_{i}P_{0}(r)$, equals its saturation vapor pressure, $P_{\\mathrm{sat}}(T)$. The location where this occurs, $r_{\\mathrm{ice}}$, is the condensation front or \"ice line\". The condition is:\n$$\nf_{i} P_{0}(r_{\\mathrm{ice}}) = P_{\\mathrm{sat}}(T(r_{\\mathrm{ice}}))\n$$\nThe saturation vapor pressure is given by the Clausius-Clapeyron relation $P_{\\mathrm{sat}}(T) = P_{s}\\,\\exp(-A/T)$, which is a very strong function of temperature.\n\nBoth the midplane pressure $P_{0}(r)$ and the temperature $T(r)$ are decreasing functions of radius $r$. Consequently, both the partial pressure $P_{i}(r)$ and the saturation vapor pressure $P_{\\mathrm{sat}}(T(r))$ decrease with increasing radius. The ice line is located at the radius where the curves for these two pressures intersect. For condensation to happen at large radii (cold regions) and not at small radii (hot regions), the partial pressure $P_i(r)$ must be less than $P_{\\mathrm{sat}}(T(r))$ for $r < r_{\\mathrm{ice}}$ and greater than $P_{\\mathrm{sat}}(T(r))$ for $r > r_{\\mathrm{ice}}$.\n\nThe magnitude of the midplane pressure $P_{0}(r)$ directly sets the magnitude of the partial pressure $P_{i}(r)$. If we consider a disk with a higher overall midplane pressure (e.g., due to a larger surface density $\\Sigma_0$), the entire $P_{i}(r)$ curve is shifted upwards. The $P_{\\mathrm{sat}}(T(r))$ curve, which depends only on the temperature profile, remains unchanged.\n\nThe new, higher partial pressure curve will now intersect the saturation vapor pressure curve at a different location. Since the $P_{\\mathrm{sat}}(T(r))$ curve increases steeply towards smaller radii (higher temperatures), the upward-shifted $P_{i}(r)$ curve must intersect it at a point where $P_{\\mathrm{sat}}$ is higher. A higher value for $P_{\\mathrm{sat}}$ corresponds to a higher temperature $T$. Since temperature decreases with radius, a higher temperature is found at a smaller radius $r$.\n\nTherefore, a higher midplane pressure $P_{0}(r)$ allows a volatile species to condense at a higher temperature. In the context of a protoplanetary disk's radial structure, this means the condensation front $r_{\\mathrm{ice}}$ moves inward, closer to the star. Conversely, a lower midplane pressure pushes the condensation front outwards to colder regions of the disk.",
            "answer": "$$\n\\boxed{0.141}\n$$"
        },
        {
            "introduction": "The reality of condensation is more complex than the formation of single, isolated minerals; it involves competition and reaction between different solid phases as temperature changes. This computational practice  delves into this next level of realism by modeling the thermodynamic equilibrium between forsterite ($\\mathrm{Mg_2SiO_4}$) and enstatite ($\\mathrm{MgSiO_3}$), two of the most abundant silicates. By applying the principle of Gibbs free energy minimization subject to mass balance constraints, you will determine how the stable mineral assemblage changes as a function of temperature and the elemental Mg/Si ratio. This exercise provides a hands-on introduction to the methods used in geochemical modeling to predict the detailed mineralogy of planetary materials.",
            "id": "4157161",
            "problem": "Consider a simplified equilibrium condensation model in the context of the condensation sequence in the solar nebula: magnesium partitions between the orthosilicate forsterite $\\mathrm{Mg}_2\\mathrm{SiO}_4$ and the pyroxene enstatite $\\mathrm{MgSiO}_3$, possibly coexisting with silica $\\mathrm{SiO}_2$. Assume the following model ingredients, each stated as a fundamental law or core definition, and use International System of Units (SI) throughout.\n\n1. Chemical mass balance constraints for the condensed phases, expressed in terms of moles $n_{\\mathrm{Fo}}$, $n_{\\mathrm{En}}$, and $n_{\\mathrm{Q}}$ of forsterite, enstatite, and silica (quartz), respectively, and the available condensed magnesium and silicon $n_{\\mathrm{Mg},0}$ and $n_{\\mathrm{Si},0}$:\n   - $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$,\n   - $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$,\n   - $n_{\\mathrm{Fo}} \\ge 0$, $n_{\\mathrm{En}} \\ge 0$, $n_{\\mathrm{Q}} \\ge 0$.\n\n   These follow from conservation of atoms under ideal stoichiometry for $\\mathrm{Mg}_2\\mathrm{SiO}_4$, $\\mathrm{MgSiO}_3$, and $\\mathrm{SiO}_2$.\n\n2. The equilibrium thermodynamics of the silicate exchange reaction among pure solids,\n   $$\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3,$$\n   characterized by a standard reaction enthalpy $\\Delta H_r^\\circ$ and entropy $\\Delta S_r^\\circ$ that are temperature independent over the range of interest. The standard reaction Gibbs free energy is\n   $$\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ,$$\n   where $T$ is temperature in Kelvin and $\\Delta G_r^\\circ$ is in Joules per mole. Pure condensed phases have activity of unity; therefore, only the sign of $\\Delta G_r^\\circ(T)$ controls which assemblage of pure solids is thermodynamically favored.\n\n3. Total condensed-phase Gibbs energy minimization under the above constraints. Measure the total Gibbs energy relative to the enstatite-plus-silica reference such that the per-mole energy contribution of forsterite is $-\\,\\Delta G_r^\\circ(T)$ and the contributions of enstatite and silica are zero. The objective function to be minimized is then\n   $$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\,\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}},$$\n   subject to the mass balance constraints. This representation encodes the fact that $\\Delta G_r^\\circ(T) = 2\\,G_{\\mathrm{En}} - \\left(G_{\\mathrm{Fo}} + G_{\\mathrm{Q}}\\right)$, so a positive $\\Delta G_r^\\circ(T)$ implies that forsterite plus silica is more stable than enstatite, and a negative $\\Delta G_r^\\circ(T)$ implies the reverse.\n\nYour task is to implement a program that, given temperature $T$ in Kelvin and initial condensed abundances $n_{\\mathrm{Mg},0}$ and $n_{\\mathrm{Si},0}$ in moles, solves the constrained Gibbs minimization problem and reports how magnesium partitions between forsterite and enstatite. Specifically:\n\n- Use $\\Delta H_r^\\circ = -30000\\,\\mathrm{J\\,mol^{-1}}$ and $\\Delta S_r^\\circ = -30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- At each input $T$, compute $\\Delta G_r^\\circ(T)$ and minimize $G_{\\mathrm{tot}}(T)$ subject to the linear constraints. Note that this is a linear program with a one-dimensional decision due to the constraints; if $\\Delta G_r^\\circ(T) > 0$, minimizing $G_{\\mathrm{tot}}(T)$ requires maximizing $n_{\\mathrm{Fo}}$ within the feasible region; if $\\Delta G_r^\\circ(T) < 0$, minimizing $G_{\\mathrm{tot}}(T)$ requires minimizing $n_{\\mathrm{Fo}}$; for the boundary case $\\Delta G_r^\\circ(T) = 0$, you must choose the minimal feasible $n_{\\mathrm{Fo}}$ to ensure deterministic output.\n- Compute the magnesium partition fractions\n  $$f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}, \\quad f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}},$$\n  and also report the silica amount $n_{\\mathrm{Q}}$.\n\nAll outputs must be expressed as dimensionless decimal numbers for the fractions and moles for $n_{\\mathrm{Q}}$. Round all reported numbers to $6$ decimal places.\n\nTest Suite:\nProvide results for the following seven test cases, which together probe the high-temperature regime, the low-temperature regime, boundary conditions at stoichiometric ratios, and the reaction equilibrium boundary. Use $n_{\\mathrm{Si},0} = 1.0$ for all cases to interpret $n_{\\mathrm{Mg},0}$ as the magnesium-to-silicon atomic ratio.\n\n- Case $1$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $2$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $3$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.0$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $4$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.0$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $5$: $T = 1200.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 0.8$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $6$: $T = 800.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 0.8$, $n_{\\mathrm{Si},0} = 1.0$.\n- Case $7$: $T = 1000.0\\,\\mathrm{K}$, $n_{\\mathrm{Mg},0} = 1.07$, $n_{\\mathrm{Si},0} = 1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the form $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$ for the corresponding test case, all rounded to $6$ decimal places. For example: $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$.",
            "solution": "The problem as stated provides a complete and self-contained set of definitions, constraints, and objective criteria for determining the equilibrium mineralogical assemblage in a simplified chemical system. It is a well-posed constrained optimization problem based on fundamental principles of chemical thermodynamics. The data are physically and dimensionally consistent. The problem is therefore deemed **valid**.\n\nThe central task is to find the molar amounts of forsterite ($n_{\\mathrm{Fo}}$), enstatite ($n_{\\mathrm{En}}$), and silica ($n_{\\mathrm{Q}}$) that minimize the total Gibbs energy of the condensed phases, given by the objective function:\n$$G_{\\mathrm{tot}}(T; n_{\\mathrm{Fo}}, n_{\\mathrm{En}}, n_{\\mathrm{Q}}) = -\\,\\Delta G_r^\\circ(T)\\,n_{\\mathrm{Fo}}$$\nThis minimization is subject to the following linear constraints derived from mass balance and non-negativity of molar amounts:\n$1.$ $2\\,n_{\\mathrm{Fo}} + n_{\\mathrm{En}} = n_{\\mathrm{Mg},0}$ (Magnesium atom conservation)\n$2.$ $n_{\\mathrm{Fo}} + n_{\\mathrm{En}} + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$ (Silicon atom conservation)\n$3.$ $n_{\\mathrm{Fo}} \\ge 0$, $n_{\\mathrm{En}} \\ge 0$, $n_{\\mathrm{Q}} \\ge 0$\n\nThe optimization strategy depends on the sign of the coefficient of $n_{\\mathrm{Fo}}$ in the objective function, which is $-\\,\\Delta G_r^\\circ(T)$. The standard Gibbs free energy of the reaction $\\mathrm{Mg}_2\\mathrm{SiO}_4 + \\mathrm{SiO}_2 \\rightleftharpoons 2\\,\\mathrm{MgSiO}_3$ is given as $\\Delta G_r^\\circ(T) = \\Delta H_r^\\circ - T\\,\\Delta S_r^\\circ$. A key step is to find the equilibrium temperature, $T_{\\mathrm{eq}}$, where $\\Delta G_r^\\circ(T) = 0$.\n$$T_{\\mathrm{eq}} = \\frac{\\Delta H_r^\\circ}{\\Delta S_r^\\circ} = \\frac{-30000\\,\\mathrm{J\\,mol^{-1}}}{-30\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}} = 1000\\,\\mathrm{K}$$\nThe sign of $\\Delta G_r^\\circ(T)$, and thus the optimization goal, depends on the temperature $T$ relative to $T_{\\mathrm{eq}}$:\n- If $T > 1000\\,\\mathrm{K}$: Since $\\Delta S_r^\\circ < 0$, it follows that $\\Delta G_r^\\circ(T) > 0$. The objective function's coefficient $-\\,\\Delta G_r^\\circ(T)$ is negative. To minimize $G_{\\mathrm{tot}}$, we must **maximize** $n_{\\mathrm{Fo}}$.\n- If $T < 1000\\,\\mathrm{K}$: It follows that $\\Delta G_r^\\circ(T) < 0$. The coefficient $-\\,\\Delta G_r^\\circ(T)$ is positive. To minimize $G_{\\mathrm{tot}}$, we must **minimize** $n_{\\mathrm{Fo}}$.\n- If $T = 1000\\,\\mathrm{K}$: Here, $\\Delta G_r^\\circ(T) = 0$, making $G_{\\mathrm{tot}}=0$ for any feasible solution. The problem statement provides a deterministic rule to **minimize** $n_{\\mathrm{Fo}}$ in this boundary case.\n\nTo find the optimal value of $n_{\\mathrm{Fo}}$, we first define its feasible range. We can express $n_{\\mathrm{En}}$ and $n_{\\mathrm{Q}}$ in terms of $n_{\\mathrm{Fo}}$ and the initial abundances using the mass balance equations:\nFrom constraint $1$:\n$$n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$$\nSubstituting this into constraint $2$:\n$$n_{\\mathrm{Fo}} + (n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}) + n_{\\mathrm{Q}} = n_{\\mathrm{Si},0}$$\nSolving for $n_{\\mathrm{Q}}$:\n$$n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$$\nThe non-negativity constraints ($n_{\\mathrm{Fo}} \\ge 0, n_{\\mathrm{En}} \\ge 0, n_{\\mathrm{Q}} \\ge 0$) impose bounds on $n_{\\mathrm{Fo}}$:\n- $n_{\\mathrm{Fo}} \\ge 0$ is a direct constraint.\n- From $n_{\\mathrm{En}} \\ge 0$: $n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$.\n- From $n_{\\mathrm{Q}} \\ge 0$: $n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}} \\ge 0 \\implies n_{\\mathrm{Fo}} \\ge n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}$.\n\nCombining these defines the feasible interval for $n_{\\mathrm{Fo}}$:\n$$\\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0}) \\le n_{\\mathrm{Fo}} \\le \\frac{n_{\\mathrm{Mg},0}}{2}$$\nLet the lower bound be $n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$ and the upper bound be $n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$.\n\nThe solution for $n_{\\mathrm{Fo}}$ is therefore determined by the temperature:\n- For $T > 1000\\,\\mathrm{K}$, we maximize $n_{\\mathrm{Fo}}$, so the solution is $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,max}} = \\frac{n_{\\mathrm{Mg},0}}{2}$.\n- For $T \\le 1000\\,\\mathrm{K}$, we minimize $n_{\\mathrm{Fo}}$, so the solution is $n_{\\mathrm{Fo}} = n_{\\mathrm{Fo,min}} = \\max(0, n_{\\mathrm{Mg},0} - n_{\\mathrm{Si},0})$.\n\nWith the optimal value of $n_{\\mathrm{Fo}}$ determined, the remaining quantities are calculated as follows:\n$1.$ Calculate $n_{\\mathrm{En}} = n_{\\mathrm{Mg},0} - 2\\,n_{\\mathrm{Fo}}$.\n$2.$ Calculate $n_{\\mathrm{Q}} = n_{\\mathrm{Si},0} - n_{\\mathrm{Mg},0} + n_{\\mathrm{Fo}}$.\n$3.$ Compute the magnesium partition fractions:\n   - $f_{\\mathrm{Mg,Fo}} = \\frac{2\\,n_{\\mathrm{Fo}}}{n_{\\mathrm{Mg},0}}$\n   - $f_{\\mathrm{Mg,En}} = \\frac{n_{\\mathrm{En}}}{n_{\\mathrm{Mg},0}}$\n$4.$ The final result for each test case is the triplet $[f_{\\mathrm{Mg,Fo}}, f_{\\mathrm{Mg,En}}, n_{\\mathrm{Q}}]$, with each value rounded to $6$ decimal places. This logic is implemented for the provided test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained Gibbs minimization problem for magnesium silicate condensation.\n    \"\"\"\n\n    # Define the equilibrium temperature boundary based on provided thermodynamic data.\n    # T_eq = delta_H / delta_S = (-30000 J/mol) / (-30 J/mol/K) = 1000 K.\n    T_eq = 1000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T in K, n_Mg,0 in moles, n_Si,0 in moles)\n    test_cases = [\n        (1200.0, 1.07, 1.0),  # Case 1\n        (800.0, 1.07, 1.0),   # Case 2\n        (1200.0, 1.0, 1.0),   # Case 3\n        (800.0, 1.0, 1.0),    # Case 4\n        (1200.0, 0.8, 1.0),   # Case 5\n        (800.0, 0.8, 1.0),    # Case 6\n        (1000.0, 1.07, 1.0),  # Case 7\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, n_Mg0, n_Si0 = case\n\n        # Determine the optimal moles of forsterite (n_Fo) based on temperature.\n        # The objective is to minimize G_tot = -dG_r * n_Fo.\n        # If T > T_eq, dG_r > 0, so -dG_r < 0. We must MAXIMIZE n_Fo.\n        # If T <= T_eq, dG_r <= 0, so -dG_r >= 0. We must MINIMIZE n_Fo.\n\n        # The feasible range for n_Fo is derived from the non-negativity constraints:\n        # max(0, n_Mg0 - n_Si0) <= n_Fo <= n_Mg0 / 2\n        n_Fo_min = max(0, n_Mg0 - n_Si0)\n        n_Fo_max = n_Mg0 / 2.0\n        \n        n_Fo = 0.0\n        if T > T_eq:\n            # Maximize n_Fo\n            n_Fo = n_Fo_max\n        else: # T <= T_eq\n            # Minimize n_Fo\n            n_Fo = n_Fo_min\n            \n        # Calculate moles of enstatite and silica from mass balance.\n        # n_En = n_Mg0 - 2*n_Fo\n        # n_Q  = n_Si0 - n_Mg0 + n_Fo\n        n_En = n_Mg0 - 2.0 * n_Fo\n        n_Q = n_Si0 - n_Mg0 + n_Fo\n        \n        # Calculate magnesium partition fractions.\n        # Handle the case where n_Mg0 might be zero to avoid division by zero,\n        # although test cases have n_Mg0 > 0.\n        if n_Mg0 > 0:\n            f_Mg_Fo = (2.0 * n_Fo) / n_Mg0\n            f_Mg_En = n_En / n_Mg0\n        else:\n            f_Mg_Fo = 0.0\n            f_Mg_En = 0.0\n\n        # Store the rounded results for the current test case.\n        result = [\n            round(f_Mg_Fo, 6),\n            round(f_Mg_En, 6),\n            round(n_Q, 6)\n        ]\n        all_results.append(result)\n\n    # Format the final output string as specified.\n    # Example format: [[a1,b1,c1],[a2,b2,c2],...]\n    output_parts = []\n    for res in all_results:\n        # Format each number to 6 decimal places.\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        output_parts.append(formatted_res)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}