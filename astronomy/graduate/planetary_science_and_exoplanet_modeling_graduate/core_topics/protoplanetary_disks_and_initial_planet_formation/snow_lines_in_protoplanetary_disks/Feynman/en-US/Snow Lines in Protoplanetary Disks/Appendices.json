{
    "hands_on_practices": [
        {
            "introduction": "To begin our practical exploration, we will calculate the foundational location of the water snow line from first principles. This exercise demonstrates how the balance between stellar irradiation and thermal re-emission sets the temperature gradient in a protoplanetary disk. By applying the principles of radiative equilibrium, you will derive a simple power-law for the temperature profile and use it to compute a first-order estimate for the water snow line in a Solar System analog .",
            "id": "4157119",
            "problem": "Consider a passively irradiated protoplanetary disk around a Solar-type star, in the context of the condensation sequence in the solar nebula. The snow line for a volatile species is defined as the radial location where the disk midplane temperature falls below its condensation temperature at the local midplane pressure. Let the midplane temperature follow a power-law profile given by $T(r)=T_0 \\left(r/r_0\\right)^{-q}$, which can arise from radiative equilibrium in a centrally irradiated disk, and let the snow line radius for species $i$ satisfy $T(r)=T_c(P)$, where $T_c(P)$ is the condensation temperature at pressure $P$. \n\nUsing the radiative equilibrium principle that a body at distance $r$ from a star receives an irradiance scaling as $r^{-2}$ and re-emits thermally with $F=\\sigma T^4$ (where $\\sigma$ is the Stefan–Boltzmann constant), argue from first principles that $q$ is consistent with $q=\\frac{1}{2}$ for a passively heated, approximately geometrically thin disk. Under this approximation, adopt $r_0=1\\ \\mathrm{AU}$ and $T_0=280\\ \\mathrm{K}$ as a fiducial normalization for a Solar-luminosity star. For water, take the condensation temperature at a representative midplane pressure $P=10^{-5}\\ \\mathrm{bar}$ to be $T_c=160\\ \\mathrm{K}$, consistent with the range $150$–$170\\ \\mathrm{K}$ at $P\\sim 10^{-6}$–$10^{-4}\\ \\mathrm{bar}$. \n\nDerive an expression for the snow line radius $r_{\\mathrm{H_2O}}$ and compute its numerical value for water using the above parameters. Express the final answer in Astronomical Units (AU) and round your result to three significant figures.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- The system is a passively irradiated protoplanetary disk around a Solar-type star.\n- The context is the condensation sequence in the solar nebula.\n- The snow line is the radius where midplane temperature $T$ equals the condensation temperature $T_c$ at the local pressure $P$.\n- Midplane temperature profile: $T(r)=T_0 \\left(r/r_0\\right)^{-q}$.\n- Snow line condition: $T(r)=T_c(P)$.\n- Radiative equilibrium principle: Irradiance scales as $r^{-2}$, and thermal re-emission flux is $F=\\sigma T^4$.\n- Task 1: Argue from first principles that $q$ is consistent with $q=\\frac{1}{2}$ for a passively heated, approximately geometrically thin disk.\n- Normalization parameters: $r_0=1\\ \\mathrm{AU}$ and $T_0=280\\ \\mathrm{K}$.\n- Condensation temperature for water: $T_c=160\\ \\mathrm{K}$ at a representative pressure $P=10^{-5}\\ \\mathrm{bar}$.\n- Task 2: Derive an expression for the water snow line radius, $r_{\\mathrm{H_2O}}$.\n- Task 3: Compute the numerical value of $r_{\\mathrm{H_2O}}$ in AU, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, situated within the standard theoretical framework of planet formation and protoplanetary disk physics. The concepts of passive irradiation, temperature gradients, condensation fronts (snow lines), and radiative equilibrium are fundamental to the topic. The given temperature profile $T(r) \\propto r^{-q}$ is a standard model. The physical principles cited—the inverse-square law for stellar irradiance and the Stefan-Boltzmann law for thermal emission—are correct.\n\nThe problem is well-posed. It provides a clear set of tasks, all necessary parameters ($T_0, r_0, T_c$), and the physical context required to perform the derivations and calculations. The values provided for temperature at $1 \\text{ AU}$ and the condensation temperature of water at low pressure are physically realistic and consistent with established literature on the solar nebula. The language is objective and precise.\n\nThe problem requires a derivation based on first principles as supplied in the text, which is a valid scientific reasoning exercise. There are no internal contradictions, missing information, or pseudoscientific claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\n\nThe problem is divided into three parts: justifying the temperature profile exponent $q$, deriving the snow line radius, and calculating its value for water.\n\nFirst, we address the value of the exponent $q$ in the temperature profile $T(r)=T_0 \\left(r/r_0\\right)^{-q}$. The problem states that the disk is passively irradiated, meaning its temperature is determined by the balance between the energy absorbed from the central star and the energy it thermally re-emits.\n\nAccording to the problem statement, the irradiance (energy flux received) from the star at a radial distance $r$ scales as $r^{-2}$. Let us denote the absorbed flux as $F_{abs}$. Thus, we have the relationship:\n$$\nF_{abs}(r) \\propto \\frac{1}{r^2}\n$$\nThe problem also states that the disk re-emits this energy thermally, with the emitted flux $F_{em}$ given by the Stefan-Boltzmann law:\n$$\nF_{em}(r) = \\sigma T(r)^4\n$$\nwhere $\\sigma$ is the Stefan-Boltzmann constant and $T(r)$ is the local temperature of the disk.\n\nIn radiative equilibrium, the absorbed flux must equal the emitted flux, $F_{abs}(r) = F_{em}(r)$. Therefore, we can write:\n$$\n\\sigma T(r)^4 \\propto \\frac{1}{r^2}\n$$\nThis implies that the temperature $T(r)$ must depend on the radius $r$ as:\n$$\nT(r)^4 \\propto r^{-2}\n$$\nTaking the fourth root of both sides of the proportionality gives:\n$$\nT(r) \\propto (r^{-2})^{1/4} = r^{-2/4} = r^{-1/2}\n$$\nComparing this result with the given power-law temperature profile, $T(r) \\propto r^{-q}$, we identify the exponent $q$ as:\n$$\nq = \\frac{1}{2}\n$$\nThis justifies the value of $q$ based on the first principles provided in the problem for a simple, passively irradiated disk model.\n\nNext, we derive an expression for the water snow line, $r_{\\mathrm{H_2O}}$. The snow line is defined as the radius where the disk's midplane temperature equals the condensation temperature of water, $T_c$. We are given $T_c = 160\\ \\mathrm{K}$ for water.\nThe condition for the snow line is:\n$$\nT(r_{\\mathrm{H_2O}}) = T_c\n$$\nSubstituting the temperature profile expression with $q=\\frac{1}{2}$:\n$$\nT_0 \\left(\\frac{r_{\\mathrm{H_2O}}}{r_0}\\right)^{-1/2} = T_c\n$$\nWe now solve this equation for $r_{\\mathrm{H_2O}}$. First, we isolate the term containing the radius:\n$$\n\\left(\\frac{r_{\\mathrm{H_2O}}}{r_0}\\right)^{-1/2} = \\frac{T_c}{T_0}\n$$\nThe negative exponent can be written as an inversion:\n$$\n\\left(\\frac{r_0}{r_{\\mathrm{H_2O}}}\\right)^{1/2} = \\frac{T_c}{T_0}\n$$\nTo solve for $r_{\\mathrm{H_2O}}$, we square both sides of the equation:\n$$\n\\frac{r_0}{r_{\\mathrm{H_2O}}} = \\left(\\frac{T_c}{T_0}\\right)^2\n$$\nFinally, we rearrange the equation to find the expression for $r_{\\mathrm{H_2O}}$:\n$$\nr_{\\mathrm{H_2O}} = r_0 \\left(\\frac{T_c}{T_0}\\right)^{-2} = r_0 \\left(\\frac{T_0}{T_c}\\right)^2\n$$\nThis is the general expression for the snow line radius.\n\nFinally, we compute the numerical value for the water snow line radius using the provided parameters: $r_0=1\\ \\mathrm{AU}$, $T_0=280\\ \\mathrm{K}$, and $T_c=160\\ \\mathrm{K}$.\nSubstituting these values into our derived expression:\n$$\nr_{\\mathrm{H_2O}} = (1\\ \\mathrm{AU}) \\times \\left(\\frac{280\\ \\mathrm{K}}{160\\ \\mathrm{K}}\\right)^2\n$$\nWe calculate the ratio of the temperatures:\n$$\n\\frac{280}{160} = \\frac{28}{16} = \\frac{7}{4} = 1.75\n$$\nNow, we square this value:\n$$\nr_{\\mathrm{H_2O}} = (1\\ \\mathrm{AU}) \\times (1.75)^2 = 1 \\times 3.0625\\ \\mathrm{AU} = 3.0625\\ \\mathrm{AU}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\nr_{\\mathrm{H_2O}} \\approx 3.06\\ \\mathrm{AU}\n$$\nThus, based on this simplified model, the water snow line in the early solar nebula is located at approximately $3.06$ Astronomical Units from the Sun.",
            "answer": "$$\n\\boxed{3.06}\n$$"
        },
        {
            "introduction": "Moving beyond a fixed condensation temperature, this practice delves into the thermodynamic heart of the snow line: the saturation vapor pressure. Starting from the fundamental Clausius–Clapeyron relation, you will derive a more physically robust expression for the saturation pressure of water ice that accounts for the temperature dependence of its latent heat of sublimation. This advanced derivation  showcases how to apply core thermodynamic principles to refine our understanding of phase transitions under the low-pressure conditions of protoplanetary disks.",
            "id": "4177898",
            "problem": "In the midplane of a passively heated protoplanetary disk, the location of the water snow line depends sensitively on the saturation vapor pressure of water over ice at low pressures typical of disks. Starting from the Clausius–Clapeyron relation in the form $d\\ln P_{\\rm sat}/d(1/T)=-L/R$, where $P_{\\rm sat}(T)$ is the saturation vapor pressure of water over ice, $L(T)$ is the molar latent heat of sublimation, and $R$ is the universal molar gas constant, derive a closed-form expression for $P_{\\rm sat}(T)$ that incorporates a physically motivated temperature dependence of $L(T)$. Assume:\n- The water vapor obeys the ideal gas equation of state, and the condensed phase molar volume is negligible relative to the vapor-phase molar volume under disk conditions.\n- The difference in constant-pressure molar heat capacities between vapor and ice, $\\Delta c_p \\equiv c_{p,\\mathrm{vapor}} - c_{p,\\mathrm{ice}}$, is temperature-independent over the range of interest, so that Kirchhoff’s relation $dL/dT=\\Delta c_p$ holds and integrates to $L(T)=L(T_0)+\\Delta c_p\\,(T-T_0)$ for a chosen reference temperature $T_0$.\n- The boundary condition $P_{\\rm sat}(T_0)=P_0$ holds at the reference temperature $T_0$.\n\nUsing only these assumptions and starting relations, derive an analytic expression for $P_{\\rm sat}(T)$ in terms of $P_0$, $T$, $T_0$, $R$, $L(T_0)$, and $\\Delta c_p$. Provide your final expression as a single closed-form analytic expression. You do not need to evaluate numerically.",
            "solution": "The saturation vapor pressure of water over ice in a low-pressure environment is governed by phase equilibrium and thermodynamics. We begin from the Clausius–Clapeyron relation expressed in terms of the reciprocal of temperature,\n$$\n\\frac{d \\ln P_{\\rm sat}}{d\\!\\left( \\frac{1}{T} \\right)} \\;=\\; -\\,\\frac{L(T)}{R},\n$$\nwhere $L(T)$ is the molar latent heat of sublimation and $R$ is the universal molar gas constant. This form follows from the fundamental Clapeyron equation,\n$$\n\\frac{dP_{\\rm sat}}{dT} \\;=\\; \\frac{L(T)}{T\\,\\Delta v},\n$$\ncombined with the ideal gas approximation for the vapor phase $v_{\\rm vapor} \\approx \\frac{R T}{P_{\\rm sat}}$ and neglecting the condensed phase contribution to $\\Delta v$ under disk conditions ($\\Delta v \\approx v_{\\rm vapor}$), yielding\n$$\n\\frac{dP_{\\rm sat}}{dT} \\;\\approx\\; \\frac{L(T)}{T} \\,\\frac{P_{\\rm sat}}{R T}\n\\;\\;\\Rightarrow\\;\\; \\frac{d \\ln P_{\\rm sat}}{dT} \\;=\\; \\frac{L(T)}{R T^2}.\n$$\nBy the chain rule, since $\\frac{d(1/T)}{dT} = -\\,\\frac{1}{T^2}$, we obtain\n$$\n\\frac{d \\ln P_{\\rm sat}}{d\\!\\left( \\frac{1}{T} \\right)} \\;=\\; \\frac{d \\ln P_{\\rm sat}/dT}{d(1/T)/dT} \\;=\\; \\frac{L(T)/(R T^2)}{-\\,1/T^2} \\;=\\; -\\,\\frac{L(T)}{R},\n$$\nwhich is the given starting point.\n\nNext, we incorporate a physically motivated temperature dependence for the latent heat using Kirchhoff’s relation. Let $\\Delta c_p \\equiv c_{p,\\mathrm{vapor}} - c_{p,\\mathrm{ice}}$ be temperature-independent over the range of interest. Then\n$$\n\\frac{dL}{dT} \\;=\\; \\Delta c_p \\;\\;\\Rightarrow\\;\\; L(T) \\;=\\; L(T_0) + \\Delta c_p\\,(T - T_0),\n$$\nfor a chosen reference temperature $T_0$. We also impose the boundary condition $P_{\\rm sat}(T_0) = P_0$.\n\nIt is algebraically convenient to work with the form\n$$\n\\frac{d \\ln P_{\\rm sat}}{dT} \\;=\\; \\frac{L(T)}{R T^2}.\n$$\nIntegrating from $T_0$ to $T$ gives\n$$\n\\ln\\!\\left( \\frac{P_{\\rm sat}(T)}{P_0} \\right)\n\\;=\\;\n\\int_{T_0}^{T} \\frac{L(T')}{R\\,T'^{2}}\\,dT'\n\\;=\\;\n\\frac{1}{R} \\int_{T_0}^{T} \\frac{L(T_0) + \\Delta c_p\\,(T' - T_0)}{T'^{2}}\\,dT'.\n$$\nWe split the integral into two parts:\n$$\n\\frac{1}{R} \\left[ L(T_0) \\int_{T_0}^{T} \\frac{dT'}{T'^{2}}\n\\;+\\;\n\\Delta c_p \\int_{T_0}^{T} \\frac{T' - T_0}{T'^{2}}\\,dT' \\right].\n$$\nCompute each integral:\n\n1. The first integral is\n$$\n\\int_{T_0}^{T} \\frac{dT'}{T'^{2}} \\;=\\; \\left[ -\\,\\frac{1}{T'} \\right]_{T_0}^{T} \\;=\\; \\frac{1}{T_0} - \\frac{1}{T}.\n$$\n\n2. The second integral uses $\\frac{T' - T_0}{T'^{2}} = \\frac{1}{T'} - \\frac{T_0}{T'^{2}}$, so\n$$\n\\int_{T_0}^{T} \\frac{T' - T_0}{T'^{2}}\\,dT'\n\\;=\\;\n\\int_{T_0}^{T} \\frac{dT'}{T'}\n\\;-\\;\nT_0 \\int_{T_0}^{T} \\frac{dT'}{T'^{2}}\n\\;=\\;\n\\ln\\!\\left( \\frac{T}{T_0} \\right)\n\\;+\\;\nT_0 \\left( \\frac{1}{T} - \\frac{1}{T_0} \\right).\n$$\n\nCombining these, we obtain\n$$\n\\ln\\!\\left( \\frac{P_{\\rm sat}(T)}{P_0} \\right)\n\\;=\\;\n\\frac{L(T_0)}{R} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right)\n\\;+\\;\n\\frac{\\Delta c_p}{R} \\left[ \\ln\\!\\left( \\frac{T}{T_0} \\right)\n\\;+\\;\nT_0 \\left( \\frac{1}{T} - \\frac{1}{T_0} \\right) \\right].\n$$\nRegrouping the terms proportional to $\\left( \\frac{1}{T_0} - \\frac{1}{T} \\right)$ yields\n$$\n\\ln\\!\\left( \\frac{P_{\\rm sat}(T)}{P_0} \\right)\n\\;=\\;\n\\frac{L(T_0) - \\Delta c_p T_0}{R} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right)\n\\;+\\;\n\\frac{\\Delta c_p}{R} \\ln\\!\\left( \\frac{T}{T_0} \\right).\n$$\nExponentiating both sides provides the desired closed-form expression:\n$$\nP_{\\rm sat}(T)\n\\;=\\;\nP_0 \\left( \\frac{T}{T_0} \\right)^{\\Delta c_p / R}\n\\exp\\!\\left\\{\n\\frac{L(T_0) - \\Delta c_p T_0}{R} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right)\n\\right\\}.\n$$\n\nThis expression connects the saturation vapor pressure to temperature with two physically transparent corrections beyond the constant latent heat approximation: a modified exponential factor governed by $L(T_0) - \\Delta c_p T_0$, and a multiplicative power-law prefactor $\\left( T/T_0 \\right)^{\\Delta c_p / R}$ arising from the temperature dependence of $L(T)$ through the constant-pressure heat capacity difference.\n\nAssumptions and their implications:\n- Ideal gas behavior for the vapor is justified at the low pressures typical of protoplanetary disks; deviations can be treated via virial corrections or fugacity coefficients, which would modify the effective $R$ or introduce additional terms in $\\ln P_{\\rm sat}$.\n- Neglect of the condensed phase molar volume is appropriate because $v_{\\mathrm{ice}} \\ll v_{\\mathrm{vapor}}$ under disk conditions; retaining $v_{\\mathrm{ice}}$ would introduce small corrections to $\\Delta v$ and thus to the coefficient in the differential equation.\n- Treating $\\Delta c_p$ as temperature-independent is a controlled approximation over limited temperature ranges; if $\\Delta c_p$ varies with $T$, the power-law prefactor generalizes to an integral involving $\\Delta c_p(T)/T$, leading to non-power-law multiplicative factors.\n- For many astrophysical applications in snow line modeling, the simpler constant-$L$ form $P_{\\rm sat}(T) = P_0 \\exp\\!\\left[ \\frac{L_{\\mathrm{const}}}{R} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right]$ is a useful baseline. The expression derived here systematically improves upon that baseline when heat capacity differences are non-negligible.\n\nThis $P_{\\rm sat}(T)$ can be inserted into disk thermochemical models to determine the radius at which the local water partial pressure falls below $P_{\\rm sat}(T)$, identifying the water snow line under specified disk structure and composition.",
            "answer": "$$\\boxed{P_0 \\left( \\frac{T}{T_0} \\right)^{\\Delta c_p / R} \\exp\\!\\left[ \\frac{L(T_0) - \\Delta c_p T_0}{R} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right]}$$"
        },
        {
            "introduction": "This final practice transitions from analytical models to computational synthesis, challenging you to build a more realistic thermal model of a disk. You will implement a program that incorporates complex physical processes, including dust settling and an opacity that depends on the grain size distribution, to calculate the snow line location. By performing a parameter sweep, this exercise  provides direct, hands-on experience in assessing the sensitivity of theoretical predictions to key physical assumptions and develops essential skills in numerical modeling.",
            "id": "4177885",
            "problem": "Consider a passively irradiated, axisymmetric protoplanetary disk around a central star, treated in a vertically averaged, plane-parallel, grey-opacity approximation. Assume the midplane temperature at cylindrical radius $r$ is set by radiative equilibrium between the absorbed stellar flux and two-sided thermal re-emission. The absorbed flux is reduced by the finite optical depth of dust along the grazing direction of stellar rays and by geometric flaring. The goal is to compute the water snow line radius for given dust settling and grain size distribution parameters, and to assess its sensitivity via a parameter sweep.\n\nStart from the following fundamental base and core definitions:\n\n- Radiative equilibrium of a slab emitting from two faces: $2 \\sigma_{\\mathrm{SB}} T^4(r) = F_{\\mathrm{abs}}(r)$, where $\\sigma_{\\mathrm{SB}}$ is the Stefan–Boltzmann constant and $T(r)$ is the midplane temperature.\n- Stellar irradiating flux at radius $r$ incident at a grazing angle: $F_\\star(r) = \\phi_{\\mathrm{eff}} \\, (1 - A) \\, \\dfrac{L_\\star}{4 \\pi r^2}$, where $L_\\star$ is the stellar luminosity, $A$ is the albedo, and $\\phi_{\\mathrm{eff}}$ is an effective geometric factor that accounts for disk flaring and reduction of the intercepting surface by dust settling.\n- Absorption limited by optical depth along the grazing direction: $F_{\\mathrm{abs}}(r) = F_\\star(r)\\,\\big(1 - e^{-\\tau(r)}\\big)$, where $\\tau(r)$ is the dust optical depth.\n- Optical depth from grey opacity and effective dust surface density: $\\tau(r) = \\kappa \\, \\Sigma_{\\mathrm{dust,eff}}(r)$, where $\\kappa$ is the mass absorption coefficient (opacity) and $\\Sigma_{\\mathrm{dust,eff}}(r)$ is the dust surface density available to intercept stellar photons.\n- Gas surface density is modeled as a power law: $\\Sigma_g(r) = \\Sigma_{g,0} \\left( \\dfrac{r}{r_0} \\right)^{-p}$, with dust surface density $\\Sigma_d(r) = \\delta \\, \\Sigma_g(r)$, where $\\delta$ is the dust-to-gas mass ratio.\n- Settling reduces both the intercepting area and the effective dust column in the grazing layer according to the same factor $f_{\\mathrm{settle}}(s)$, using the idealization $f_{\\mathrm{settle}}(s) = \\dfrac{1}{1+s}$ with dimensionless settling parameter $s$. Hence $\\phi_{\\mathrm{eff}} = \\phi_0 \\, f_{\\mathrm{settle}}(s)$ and $\\Sigma_{\\mathrm{dust,eff}}(r) = f_{\\mathrm{settle}}(s)\\, \\Sigma_d(r)$.\n- The dust opacity $\\kappa$ is computed from a Mathis–Rumpl–Nordsieck (MRN) type power-law grain size distribution $n(a) \\propto a^{-q}$ on $a \\in [a_{\\min}, a_{\\max}]$, with absorption efficiency approximated as $Q_{\\mathrm{abs}}(a) = \\min\\!\\left(1, \\dfrac{a}{a_c}\\right)$, where $a_c$ is a characteristic size demarcating the transition between inefficient and efficient absorption. For solid grain material density $\\rho_s$, the grey opacity is\n$$\n\\kappa \\;=\\; \\dfrac{3}{4 \\rho_s} \\; \\dfrac{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} \\pi a^2 \\, Q_{\\mathrm{abs}}(a)\\, n(a)\\, da}{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} \\left(\\dfrac{4}{3}\\pi a^3 \\rho_s\\right) n(a)\\, da}\n\\;=\\; \\dfrac{3}{4 \\rho_s} \\; \\dfrac{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} a^2 \\, Q_{\\mathrm{abs}}(a)\\, a^{-q} \\, da}{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} a^{3-q} \\, da}.\n$$\nUse the piecewise form $Q_{\\mathrm{abs}}(a) = \\dfrac{a}{a_c}$ for $a \\le a_c$ and $Q_{\\mathrm{abs}}(a) = 1$ for $a \\ge a_c$, and evaluate the resulting integrals analytically.\n\nFrom these, derive the midplane temperature profile\n$$\nT(r) \\;=\\; \\left[ \\dfrac{\\phi_{\\mathrm{eff}} (1-A) L_\\star}{8 \\pi \\sigma_{\\mathrm{SB}} r^2} \\; \\left(1 - e^{-\\kappa \\, \\Sigma_{\\mathrm{dust,eff}}(r)}\\right) \\right]^{1/4}.\n$$\n\nDefine the water snow line radius $r_{\\mathrm{snow}}$ as the smallest $r$ for which $T(r) = T_{\\mathrm{snow}}$, with $T_{\\mathrm{snow}}$ the water sublimation threshold.\n\nYour task is to implement a program that:\n- Computes $\\kappa$ as a function of grain size distribution parameters $q$, $a_{\\min}$, $a_{\\max}$, and $a_c$.\n- Computes $T(r)$ on a continuous domain and finds $r_{\\mathrm{snow}}$ by solving $T(r) = T_{\\mathrm{snow}}$ with robust bracketing on a finite interval.\n- Performs a parameter sweep over the settling parameter $s$ and grain size slope $q$ for the test suite below.\n- Outputs the snow line radii in Astronomical Units (AU) as floats rounded to three decimals. If, for a given test case, no solution exists in the search domain because $T(r) < T_{\\mathrm{snow}}$ for all $r$ in the interval, return the sentinel value $-1.000$ for that case.\n\nUse the following scientifically consistent parameter values and units:\n- Stellar luminosity: $L_\\star = 10 \\, L_\\odot$, with $L_\\odot = 3.828 \\times 10^{26}\\,\\mathrm{W}$.\n- Stefan–Boltzmann constant: $\\sigma_{\\mathrm{SB}} = 5.670374419 \\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- Albedo: $A = 0.0$.\n- Geometric factor without settling: $\\phi_0 = 0.05$.\n- Gas surface density normalization: $\\Sigma_{g,0} = 100\\,\\mathrm{kg\\,m^{-2}}$ at $r_0 = 1\\,\\mathrm{AU}$.\n- Power-law index: $p = 1.0$.\n- Dust-to-gas mass ratio: $\\delta = 0.01$.\n- Grain material density: $\\rho_s = 2000\\,\\mathrm{kg\\,m^{-3}}$.\n- Grain size bounds: $a_{\\min} = 1.0 \\times 10^{-8}\\,\\mathrm{m}$, $a_{\\max} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$.\n- Absorption transition size: $a_c = 1.0 \\times 10^{-7}\\,\\mathrm{m}$.\n- Water snow temperature: $T_{\\mathrm{snow}} = 170\\,\\mathrm{K}$.\n- Astronomical Unit: $1\\,\\mathrm{AU} = 1.495978707 \\times 10^{11}\\,\\mathrm{m}$.\n- Search interval for the snow line: $r \\in [0.1\\,\\mathrm{AU},\\,50\\,\\mathrm{AU}]$.\n\nTest suite (each case is a pair $(s, q)$):\n- Case $1$: $s = 0.0$, $q = 3.5$.\n- Case $2$: $s = 5.0$, $q = 3.5$.\n- Case $3$: $s = 0.0$, $q = 3.0$.\n- Case $4$: $s = 0.0$, $q = 4.0$.\n- Case $5$: $s = 20.0$, $q = 3.5$.\n- Case $6$ (edge): $s = 1000.0$, $q = 3.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by the cases above, expressed in AU and rounded to three decimals. If a case has no solution in the search interval, include the sentinel $-1.000$. For example, an output could look like $[2.537,2.103,2.811,3.214,1.995,-1.000]$.\n\nThe problem requires:\n- Correct derivation and implementation of the opacity $\\kappa(q)$ using the stated idealizations.\n- Correct computation of $T(r)$ and robust root finding for $T(r) = T_{\\mathrm{snow}}$.\n- Handling the edge case where no snow line exists within the search interval.\n\nAnswer in Astronomical Units (AU), rounded to three decimals, and print a single line in the exact specified format.",
            "solution": "The user has provided a valid problem statement. The problem is scientifically grounded in the astrophysics of protoplanetary disks, is mathematically well-posed, and all necessary parameters and definitions are provided for a unique solution. The task is to compute the water snow line radius for several sets of physical parameters.\n\nThe solution proceeds in three main steps: first, we derive an analytical expression for the dust mass absorption coefficient (opacity) $\\kappa$ as a function of the grain size distribution parameter $q$; second, we construct the full expression for the midplane temperature $T(r)$; and third, we implement a numerical root-finding algorithm to solve for the snow line radius $r_{\\mathrm{snow}}$.\n\n### Step 1: Analytical Derivation of Dust Opacity $\\kappa$\n\nThe opacity $\\kappa$ is defined by the grain properties:\n$$\n\\kappa \\;=\\; \\dfrac{3}{4 \\rho_s} \\; \\dfrac{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} a^2 \\, Q_{\\mathrm{abs}}(a)\\, n(a)\\, da}{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} \\left(\\dfrac{4}{3}\\pi a^3 \\rho_s\\right) n(a)\\, da}\n$$\nGiven the grain size distribution $n(a) \\propto a^{-q}$, this simplifies to:\n$$\n\\kappa \\;=\\; \\dfrac{3}{4 \\rho_s} \\; \\dfrac{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} a^{2-q} \\, Q_{\\mathrm{abs}}(a) \\, da}{\\displaystyle \\int_{a_{\\min}}^{a_{\\max}} a^{3-q} \\, da} \\;=\\; \\dfrac{3}{4 \\rho_s} \\frac{N(q)}{D(q)}\n$$\nwhere $N(q)$ is the numerator integral and $D(q)$ is the denominator integral. The absorption efficiency $Q_{\\mathrm{abs}}(a)$ is a piecewise function: $Q_{\\mathrm{abs}}(a) = a/a_c$ for $a \\le a_c$ and $Q_{\\mathrm{abs}}(a) = 1$ for $a > a_c$. Since the grain size range $[a_{\\min}, a_{\\max}]$ ($[10^{-8}\\,\\mathrm{m}, 10^{-3}\\,\\mathrm{m}]$) contains the transition size $a_c$ ($10^{-7}\\,\\mathrm{m}$), the integrals must be split at $a=a_c$.\n\nThe denominator integral $D(q)$ is:\n$$\nD(q) = \\int_{a_{\\min}}^{a_{\\max}} a^{3-q} \\, da\n$$\nFor $q \\neq 4$, the integral evaluates to $D(q) = \\frac{a_{\\max}^{4-q} - a_{\\min}^{4-q}}{4-q}$. For the special case $q=4$, the integrand is $a^{-1}$, yielding $D(4) = \\ln(a_{\\max}/a_{\\min})$.\n\nThe numerator integral $N(q)$ is:\n$$\nN(q) = \\int_{a_{\\min}}^{a_c} a^{2-q} \\left(\\frac{a}{a_c}\\right) da + \\int_{a_c}^{a_{\\max}} a^{2-q} (1) da = \\frac{1}{a_c}\\int_{a_{\\min}}^{a_c} a^{3-q} da + \\int_{a_c}^{a_{\\max}} a^{2-q} da\n$$\nThis also has special cases. For $q \\neq 4$ and $q \\neq 3$:\n$$\nN(q) = \\frac{1}{a_c} \\left[\\frac{a^{4-q}}{4-q}\\right]_{a_{\\min}}^{a_c} + \\left[\\frac{a^{3-q}}{3-q}\\right]_{a_c}^{a_{\\max}} = \\frac{a_c^{4-q} - a_{\\min}^{4-q}}{a_c(4-q)} + \\frac{a_{\\max}^{3-q} - a_c^{3-q}}{3-q}\n$$\nFor the special case $q=3$:\n$$\nN(3) = \\frac{1}{a_c}\\int_{a_{\\min}}^{a_c} a^{0} da + \\int_{a_c}^{a_{\\max}} a^{-1} da = \\frac{a_c - a_{\\min}}{a_c} + \\ln\\left(\\frac{a_{\\max}}{a_c}\\right)\n$$\nFor the special case $q=4$:\n$$\nN(4) = \\frac{1}{a_c}\\int_{a_{\\min}}^{a_c} a^{-1} da + \\int_{a_c}^{a_{\\max}} a^{-2} da = \\frac{1}{a_c}\\ln\\left(\\frac{a_c}{a_{\\min}}\\right) + \\left[-\\frac{1}{a}\\right]_{a_c}^{a_{\\max}} = \\frac{1}{a_c}\\ln\\left(\\frac{a_c}{a_{\\min}}\\right) + \\frac{1}{a_c} - \\frac{1}{a_{\\max}}\n$$\nThese analytical expressions are implemented to compute $\\kappa$ for each test case.\n\n### Step 2: Midplane Temperature Profile $T(r)$\n\nThe midplane temperature $T(r)$ is given by the radiative equilibrium equation, which has been solved for $T(r)$:\n$$\nT(r) \\;=\\; \\left[ \\dfrac{\\phi_{\\mathrm{eff}} (1-A) L_\\star}{8 \\pi \\sigma_{\\mathrm{SB}} r^2} \\; \\left(1 - e^{-\\tau(r)}\\right) \\right]^{1/4}\n$$\nThe components of this equation are assembled as follows:\n- The settling factor is $f_{\\mathrm{settle}}(s) = \\frac{1}{1+s}$.\n- The effective geometric factor is $\\phi_{\\mathrm{eff}} = \\phi_0 f_{\\mathrm{settle}}(s) = \\frac{0.05}{1+s}$.\n- The effective dust surface density is $\\Sigma_{\\mathrm{dust,eff}}(r) = f_{\\mathrm{settle}}(s) \\Sigma_d(r)$.\n- The dust surface density is $\\Sigma_d(r) = \\delta \\Sigma_g(r)$, with $\\delta = 0.01$.\n- The gas surface density is $\\Sigma_g(r) = \\Sigma_{g,0} (r/r_0)^{-p}$. With the given parameters $\\Sigma_{g,0} = 100\\,\\mathrm{kg\\,m^{-2}}$, $r_0 = 1\\,\\mathrm{AU}$, and $p=1.0$, this is $\\Sigma_g(r) = 100 \\cdot (r_0/r)\\,\\mathrm{kg\\,m^{-2}}$.\n- Combining these, $\\Sigma_{\\mathrm{dust,eff}}(r) = \\frac{1}{1+s} \\cdot 0.01 \\cdot 100 \\cdot \\frac{r_0}{r} = \\frac{1}{1+s} \\frac{r_0}{r}$.\n- The optical depth is $\\tau(r) = \\kappa \\Sigma_{\\mathrm{dust,eff}}(r) = \\frac{\\kappa}{1+s} \\frac{r_0}{r}$.\n\nSubstituting these into the temperature equation gives a complete function for $T(r)$ that depends on the parameters $s$ and $q$ (via $\\kappa$). The other parameters like $L_\\star$, $A$, $\\sigma_{\\mathrm{SB}}$, etc., are fixed constants.\n\n### Step 3: Numerical Solution for the Snow Line Radius $r_{\\mathrm{snow}}$\n\nThe water snow line radius, $r_{\\mathrm{snow}}$, is the location where the midplane temperature equals the water sublimation temperature, $T(r_{\\mathrm{snow}}) = T_{\\mathrm{snow}} = 170\\,\\mathrm{K}$. This requires solving the transcendental equation $T(r) - T_{\\mathrm{snow}} = 0$ for $r$.\n\nThe function $T(r)$ is a strictly monotonically decreasing function for $r>0$. This property guarantees that if a solution exists, it is unique. A robust numerical root-finding algorithm, such as the Brent-Dekker method, is ideal for this task. This method is implemented in `scipy.optimize.brentq`.\n\nThe algorithm requires a search interval $[r_{\\min}, r_{\\max}]$ where the function to be solved, $f(r) = T(r) - T_{\\mathrm{snow}}$, has opposite signs at the boundaries, i.e., $f(r_{\\min}) \\cdot f(r_{\\max}) < 0$. Given the monotonic nature of $T(r)$, a solution exists within the search interval of $[0.1\\,\\mathrm{AU},\\,50\\,\\mathrm{AU}]$ if and only if $T(0.1\\,\\mathrm{AU}) > T_{\\mathrm{snow}}$ and $T(50\\,\\mathrm{AU}) < T_{\\mathrm{snow}}$.\n\nThe computational procedure for each test case $(s, q)$ is as follows:\n1.  All physical constants are defined in SI units.\n2.  The opacity $\\kappa$ is computed using the analytical formula derived in Step 1 for the given $q$.\n3.  The function $f(r) = T(r) - T_{\\mathrm{snow}}$ is constructed.\n4.  The values of $f(r)$ are checked at the boundaries of the search interval, $r_1=0.1\\,\\mathrm{AU}$ and $r_2=50\\,\\mathrm{AU}$.\n5.  If $f(r_1) > 0$ and $f(r_2) < 0$, `scipy.optimize.brentq` is called to find the root $r_{\\mathrm{snow}}$ in meters. The result is converted to AU, rounded to three decimal places, and recorded.\n6.  If the condition in step 5 is not met, no solution exists within the specified search domain. The sentinel value $-1.000$ is recorded for that case, as instructed.\n7.  The final list of results is formatted into a single, comma-separated string enclosed in square brackets.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the water snow line radius in a protoplanetary disk model for a suite of test cases.\n\n    The solution involves:\n    1. Analytically deriving and computing the dust opacity `kappa` based on grain size distribution.\n    2. Constructing the midplane temperature profile `T(r)`.\n    3. Using a numerical root-finder (`brentq`) to solve for the radius `r_snow` where `T(r_snow) = T_snow`.\n    \"\"\"\n\n    # Physical and Astronomical Constants in SI units\n    L_SUN = 3.828e26  # Solar luminosity in Watts\n    L_STAR = 10.0 * L_SUN\n    SIGMA_SB = 5.670374419e-8  # Stefan-Boltzmann constant in W m^-2 K^-4\n    AU = 1.495978707e11  # Astronomical Unit in meters\n    \n    # Model Parameters\n    A = 0.0  # Albedo\n    PHI0 = 0.05  # Geometric factor without settling\n    SIGMA_G0 = 100.0  # Gas surface density at r0 in kg m^-2\n    R0 = 1.0 * AU  # Normalization radius\n    P_INDEX = 1.0  # Surface density power-law index\n    DELTA = 0.01  # Dust-to-gas mass ratio\n    RHO_S = 2000.0  # Solid grain material density in kg m^-3\n    A_MIN = 1.0e-8  # Minimum grain size in meters\n    A_MAX = 1.0e-3  # Maximum grain size in meters\n    A_C = 1.0e-7   # Absorption transition size in meters\n    T_SNOW = 170.0  # Water snow temperature in Kelvin\n    \n    # Search Interval for the snow line\n    R_SEARCH_MIN = 0.1 * AU\n    R_SEARCH_MAX = 50.0 * AU\n\n    def compute_kappa(q):\n        \"\"\"Computes the grey dust opacity kappa based on grain size distribution.\"\"\"\n        \n        # Denominator Integral D\n        if q == 4.0:\n            D = np.log(A_MAX / A_MIN)\n        else:\n            D = (A_MAX**(4.0 - q) - A_MIN**(4.0 - q)) / (4.0 - q)\n\n        # Numerator Integral N\n        # First part of the integral (from a_min to a_c)\n        if q == 4.0:\n            N1 = (1.0 / A_C) * np.log(A_C / A_MIN)\n        else:\n            N1 = (1.0 / A_C) * (A_C**(4.0 - q) - A_MIN**(4.0 - q)) / (4.0 - q)\n        \n        # Second part of the integral (from a_c to a_max)\n        if q == 3.0:\n            N2 = np.log(A_MAX / A_C)\n        else:\n            N2 = (A_MAX**(3.0 - q) - A_C**(3.0 - q)) / (3.0 - q)\n            \n        N = N1 + N2\n        \n        kappa = (3.0 / (4.0 * RHO_S)) * (N / D)\n        return kappa\n\n    # Test cases: tuples of (settling_parameter s, grain_size_slope q)\n    test_cases = [\n        (0.0, 3.5),\n        (5.0, 3.5),\n        (0.0, 3.0),\n        (0.0, 4.0),\n        (20.0, 3.5),\n        (1000.0, 3.0),\n    ]\n\n    results = []\n\n    for s, q in test_cases:\n        kappa = compute_kappa(q)\n        f_settle = 1.0 / (1.0 + s)\n        phi_eff = PHI0 * f_settle\n\n        # Pre-calculate constant groups for the temperature calculation\n        C1 = phi_eff * (1.0 - A) * L_STAR / (8.0 * np.pi * SIGMA_SB)\n        C2 = kappa * f_settle * DELTA * SIGMA_G0 * R0\n\n        def temp_func(r):\n            \"\"\"Calculates the midplane temperature at radius r (in meters).\"\"\"\n            if r <= 0:\n                return np.inf\n            \n            tau_r = C2 / r\n            # Use np.expm1 for better numerical precision: 1 - exp(-x) = -expm1(-x)\n            absorption_term = -np.expm1(-tau_r)\n            \n            temp_fourth_power = (C1 / r**2) * absorption_term\n            return temp_fourth_power**0.25\n\n        # Define the function whose root we want to find: T(r) - T_snow = 0\n        root_func = lambda r: temp_func(r) - T_SNOW\n\n        # Check if a root exists within the search interval.\n        # T(r) is monotonically decreasing, so a root exists iff T(min) > T_snow and T(max) < T_snow.\n        val_at_min = root_func(R_SEARCH_MIN)\n        val_at_max = root_func(R_SEARCH_MAX)\n\n        if val_at_min > 0 and val_at_max < 0:\n            try:\n                r_snow_m = brentq(root_func, R_SEARCH_MIN, R_SEARCH_MAX)\n                r_snow_au = r_snow_m / AU\n                results.append(f\"{r_snow_au:.3f}\")\n            except (ValueError, RuntimeError):\n                # Safeguard: should not be reached due to the explicit check above.\n                results.append(\"-1.000\")\n        else:\n            # No solution in the interval (disk is either too hot or too cold everywhere).\n            results.append(\"-1.000\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}