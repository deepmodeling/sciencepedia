{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的模拟之前，通过标度关系建立物理直觉至关重要。本练习旨在推导金斯质量（$M_J$），即气体云开始引力坍缩所需的最小质量，与其数密度 $n$ 之间的基本关系。理解这种幂律依赖性是恒星形成理论的基石，能帮助我们从根本上把握引力与压力之间的抗衡。",
            "id": "1923005",
            "problem": "在恒星形成的研究中，一个关键概念是 Jeans 不稳定性，它描述了星际气体云在自身引力作用下发生坍缩的条件。考虑一个原恒星云的简化模型，将其视为一个温度恒为 $T$ 的均匀、球形、等温的气体云。该气体由平均质量均为 $\\mu$ 的粒子组成。该云的稳定性由导致其膨胀的内部热能和导致其收缩的自身引力势能之间的竞争决定。\n\n分析这个问题的一个常用方法是比较两个特征时标：一是云在没有压力的情况下因引力而坍缩所需的时间（自由下落时间, $t_{ff}$），二是压力波（以等温声速 $c_s$ 传播）穿过云层并对压缩做出反应所需的时间（$t_s$）。如果自由下落时间短于声波穿越时间，云就会变得不稳定并发生坍缩。发生这种不稳定性的最小质量被称为 Jeans 质量，记为 $M_J$。\n\n已知自由下落时间与质量密度 $\\rho$ 的关系为 $t_{ff} \\propto (G\\rho)^{-1/2}$，其中 $G$ 是引力常数。对于温度恒为 $T$ 的理想气体，等温声速 $c_s$ 仅取决于 $T$、$\\mu$ 和玻尔兹曼常数 $k_B$。\n\nJeans 质量 $M_J$ 与气体粒子的数密度 $n$ 存在幂律关系，形式为 $M_J \\propto n^{\\alpha}$。根据所述原理，确定指数 $\\alpha$ 的值。",
            "solution": "我们比较一个半径为 $R$、密度为 $\\rho$ 的均匀球状云的自由下落时间和声波穿越时间。自由下落时间的标度关系为 $t_{ff} \\propto (G \\rho)^{-1/2}$。声波穿越时间为 $t_{s} = R/c_{s}$，其中对于等温理想气体，声速为 $c_{s} = (k_{B}T/\\mu)^{1/2}$。\n\n在不稳定的阈值（Jeans 条件）下，我们设 $t_{ff} \\sim t_{s}$，得到\n$$\n\\frac{R}{c_{s}} \\propto (G \\rho)^{-1/2} \\quad \\Rightarrow \\quad R \\propto c_{s} (G \\rho)^{-1/2}.\n$$\n对于一个均匀球体，其质量为 $M = \\frac{4}{3}\\pi \\rho R^{3}$，因此 Jeans 质量的标度关系为\n$$\nM_{J} \\propto \\rho R^{3} \\propto \\rho \\left[c_{s} (G \\rho)^{-1/2}\\right]^{3} = c_{s}^{3} G^{-3/2} \\rho^{-1/2}.\n$$\n使用等温理想气体关系式 $c_{s}^{2} = k_{B}T/\\mu$，我们有 $c_{s}^{3} \\propto (k_{B}T)^{3/2} \\mu^{-3/2}$。因此，\n$$\nM_{J} \\propto (k_{B}T)^{3/2} \\mu^{-3/2} G^{-3/2} \\rho^{-1/2}.\n$$\n由于 $T$ 和 $\\mu$ 是固定的，其对数密度 $n$ 的依赖关系可由 $\\rho = \\mu n$ 得出，得到\n$$\nM_{J} \\propto \\rho^{-1/2} \\propto (\\mu n)^{-1/2} \\propto n^{-1/2}.\n$$\n因此，幂律指数为 $\\alpha = -\\frac{1}{2}$。",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "现在，我们将理论应用于实际的计算挑战中。模拟引力坍缩要求数值网格必须能够解析物理过程，否则将产生非物理的“人工碎裂”现象。本练习通过应用著名的特鲁洛夫判据（Truelove criterion），让您评估一个模拟设置是否满足分辨率要求，并理解为何当物理尺度无法被解析时，次网格模型（sub-grid models）成为必不可少的工具。",
            "id": "3537920",
            "problem": "考虑一个背景密度为 $\\rho_0$、声速为 $c_s$ 的均匀、等温、自引力气体，在一个间距为 $\\Delta x$ 的均匀笛卡尔网格上使用有限体积流体动力学求解器进行积分。这种介质中引力不稳定的开始可以通过对质量守恒方程、带有正压压力定律 $P(\\rho)$ 的动量守恒方程以及扰动的引力泊松方程进行线性化来分析。在基于网格的模拟中，一个实际的分辨率要求是，特征引力碎裂尺度必须至少被 $N_J$ 个网格单元覆盖，以避免人为碎裂。假设模拟区域包含的气体参数为 $c_s = 0.2\\,\\mathrm{km\\,s^{-1}}$，$\\rho_0 = 2\\times 10^{-21}\\,\\mathrm{g\\,cm^{-3}}$，网格间距 $\\Delta x = 0.5\\,\\mathrm{pc}$，并且采用 $N_J = 4$ 作为引力碎裂尺度的最小分辨率（以网格单元数计）。\n\n哪个选项正确地：\n(i) 定义了网格尺度 $\\Delta x$，\n(ii) 给出了等温、自引力介质线性稳定性分析得出的金斯长度的正确表达式，\n(iii) 以不等式形式陈述了正确的 Truelove 分辨率判据，\n(iv) 评估了以上数值以确定是否满足分辨率条件，以及\n(v) 解释了为什么在不满足条件时，必须使用关于坍缩、恒星形成和恒星反馈的次网格（sub-grid）方案？\n\nA. $\\Delta x$ 是一个立方网格单元的线性尺寸。金斯长度为 $\\lambda_J = \\sqrt{\\pi c_s^2/(G\\rho_0)}$。Truelove 判据为 $\\lambda_J/N_J \\ge \\Delta x$。当 $c_s = 0.2\\,\\mathrm{km\\,s^{-1}}$，$\\rho_0 = 2\\times 10^{-21}\\,\\mathrm{g\\,cm^{-3}}$ 时，$\\lambda_J \\approx 1.0\\,\\mathrm{pc}$，所以 $\\lambda_J/N_J \\approx 0.25\\,\\mathrm{pc}  \\Delta x$，该判据被违反。当判据被违反时，坍缩尺度上的压力梯度分辨率不足，导致虚假的数值碎裂和过度冷却；因此必须采用次网格坍缩/“汇”方案、与自由下落时间相关的恒星形成率闭合关系，并在可分辨的体积内注入来自恒星反馈的动量/能量，以捕捉缺失的物理过程。\n\nB. $\\Delta x$ 是沿一个轴投影的相邻单元中心之间的距离。金斯长度为 $\\lambda_J = \\sqrt{\\pi c_s^2/(G\\rho_0)}$。Truelove 判据为 $\\Delta x \\ge \\lambda_J/N_J$。使用给定数值，网格满足该判据，因此不需要特殊处理；格式中的数值扩散会抑制任何人为坍缩，而无需次网格模型。\n\nC. $\\Delta x$ 是网格中可分辨的最小波长。金斯长度为 $\\lambda_J = \\sqrt{c_s^2/(G\\rho_0)}$（没有 $\\pi$ 因子）。Truelove 判据为 $\\Delta x \\le \\lambda_J/N_J$。对于给定参数，不等式 $\\Delta x \\le \\lambda_J/N_J$ 成立，因此分辨率足够，次网格模型只会使解产生偏差。\n\nD. $\\Delta x$ 是一个立方网格单元的线性尺寸。金斯长度为 $\\lambda_J = \\sqrt{\\pi c_s^2/(G\\rho_0)}$。Truelove 判据为 $\\lambda_J/N_J \\ge \\Delta x$。对于给定参数，$\\lambda_J \\approx 3.1\\,\\mathrm{pc}$，因此 $\\lambda_J/N_J \\approx 0.78\\,\\mathrm{pc}  \\Delta x$，所以该判据得到满足，恒星形成和反馈的次网格模型是不必要的。\n\nE. $\\Delta x$ 是一个立方网格单元的线性尺寸。坍缩的开始由自由下落时间 $t_\\mathrm{ff}$ 控制，而不是一个长度尺度；正确的要求是一个时间标准 $\\Delta t \\le t_\\mathrm{ff}/N_t$，其中 $N_t$ 是某个整数。如果违反，可以通过 Courant–Friedrichs–Lewy (CFL) 条件减小时间步长来恢复稳定性，因此坍缩、恒星形成或反馈不需要次网格方案。",
            "solution": "用户希望我解决并分析一个计算天体物理学问题。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n问题陈述提供了以下信息：\n- 介质：均匀、等温、自引力气体。\n- 背景密度：$\\rho_0 = 2\\times 10^{-21}\\,\\mathrm{g\\,cm^{-3}}$。\n- 声速：$c_s = 0.2\\,\\mathrm{km\\,s^{-1}}$。\n- 网格类型：均匀笛卡尔网格。\n- 网格间距：$\\Delta x = 0.5\\,\\mathrm{pc}$。\n- 要求的金斯分辨率：$N_J = 4$ 个网格单元。\n- 问题要求找出正确回答以下五点的选项：(i) $\\Delta x$ 的定义，(ii) 金斯长度 $\\lambda_J$ 的表达式，(iii) Truelove 分辨率判据，(iv) 对判据的数值评估，以及 (v) 对次网格模型必要性的解释。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n1.  **科学基础**：该问题涉及金斯不稳定性及其数值分辨率（Truelove 判据），这些是计算天体物理学中，特别是在恒星形成研究中的基本且成熟的概念。提到的控制方程（守恒律、泊松方程）是正确的。为密度、声速和网格分辨率提供的物理参数对于分子云模拟是现实的。\n2.  **问题定义良好**：问题是适定的。它要求根据已建立的物理理论并进行标准计算，从几个选项中确定正确的陈述。所有必要的数据（$\\rho_0, c_s, \\Delta x, N_J$）都已提供。引力常数 $G$ 是一个普适常数。可以确定唯一的答案。\n3.  **客观性**：问题使用精确、客观的科学语言陈述。没有主观或模棱两可的术语。\n4.  **完整性和一致性**：问题是自洽且内部一致的。没有遗漏基本信息，也没有出现矛盾。\n5.  **其他缺陷**：问题没有表现出任何其他缺陷，例如过于琐碎、同义反复或基于非形式化的类比。它测试了其领域的核心知识。\n\n**第 3 步：结论与行动**\n\n此问题是**有效的**。我将进行完整的解答。\n\n### 基于原理的推导与评估\n\n问题的核心是根据给定的物理参数评估 Truelove 分辨率判据。这需要推导金斯长度，陈述判据，并进行计算。\n\n**1. 金斯长度 ($\\lambda_J$)**\n\n金斯长度是在静态、均匀、自引力介质中区分稳定振荡与不稳定引力坍缩的临界波长。它是通过对流体方程（质量守恒、动量守恒/欧拉方程和泊松方程）进行线性微扰分析得出的。对于压力为 $P = c_s^2 \\rho$ 的等温气体，小扰动的色散关系为：\n$$ \\omega^2 = c_s^2 k^2 - 4\\pi G \\rho_0 $$\n其中 $\\omega$ 是扰动频率， $k$ 是波数 ($k=2\\pi/\\lambda$)， $G$ 是引力常数， $\\rho_0$ 是背景密度。当波数小于金斯波数 $k_J$ 时，会发生不稳定性（$\\omega^2  0$）。临界点 $\\omega^2 = 0$ 定义了 $k_J$：\n$$ c_s^2 k_J^2 = 4\\pi G \\rho_0 \\implies k_J = \\frac{\\sqrt{4\\pi G \\rho_0}}{c_s} $$\n金斯长度 $\\lambda_J$ 是对应于此波数的波长：\n$$ \\lambda_J = \\frac{2\\pi}{k_J} = 2\\pi \\frac{c_s}{\\sqrt{4\\pi G \\rho_0}} = c_s \\sqrt{\\frac{4\\pi^2}{4\\pi G \\rho_0}} $$\n$$ \\lambda_J = \\sqrt{\\frac{\\pi c_s^2}{G \\rho_0}} $$\n这证实了金斯长度的正确表达式。\n\n**2. Truelove 分辨率判据**\n\n在基于网格的流体动力学模拟中，为了防止人为的数值碎裂，金斯长度必须由足够数量的网格单元解析。如果不是这样，数值格式就无法准确地表示抵抗小尺度坍缩的稳定压力梯度。Truelove 等人（1997年）的研究表明，金斯长度必须至少由 $N_J \\approx 4$ 个单元解析。这个条件，被称为 Truelove 判据，表示为：\n$$ \\frac{\\lambda_J}{\\Delta x} \\ge N_J \\quad \\text{或等价地} \\quad \\Delta x \\le \\frac{\\lambda_J}{N_J} $$\n$\\lambda_J/N_J \\ge \\Delta x$ 的形式也很常见。\n\n**3. 数值评估**\n\n我们已知：\n- $c_s = 0.2\\,\\mathrm{km\\,s^{-1}} = 2 \\times 10^4\\,\\mathrm{cm\\,s^{-1}}$\n- $\\rho_0 = 2 \\times 10^{-21}\\,\\mathrm{g\\,cm^{-3}}$\n- $\\Delta x = 0.5\\,\\mathrm{pc}$\n- $N_J = 4$\n\n我们使用物理常数：\n- $G \\approx 6.674 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$\n- $1\\,\\mathrm{pc} \\approx 3.086 \\times 10^{18}\\,\\mathrm{cm}$\n\n首先，计算金斯长度 $\\lambda_J$：\n$$ \\lambda_J = \\sqrt{\\frac{\\pi (2 \\times 10^4\\,\\mathrm{cm\\,s^{-1}})^2}{(6.674 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}})(2 \\times 10^{-21}\\,\\mathrm{g\\,cm^{-3}})}} $$\n$$ \\lambda_J = \\sqrt{\\frac{\\pi \\times 4 \\times 10^8}{1.3348 \\times 10^{-28}}}\\,\\mathrm{cm} = \\sqrt{\\frac{1.2566 \\times 10^9}{1.3348 \\times 10^{-28}}}\\,\\mathrm{cm} \\approx \\sqrt{9.414 \\times 10^{36}}\\,\\mathrm{cm} $$\n$$ \\lambda_J \\approx 3.068 \\times 10^{18}\\,\\mathrm{cm} $$\n为了与 $\\Delta x$ 比较，我们将 $\\lambda_J$ 转换为秒差距（parsec）：\n$$ \\lambda_J \\approx \\frac{3.068 \\times 10^{18}\\,\\mathrm{cm}}{3.086 \\times 10^{18}\\,\\mathrm{cm/pc}} \\approx 0.994\\,\\mathrm{pc} $$\n保留两位有效数字，$\\lambda_J \\approx 1.0\\,\\mathrm{pc}$。\n\n现在，我们检查 Truelove 判据，$\\Delta x \\le \\lambda_J / N_J$：\n$$ \\frac{\\lambda_J}{N_J} = \\frac{1.0\\,\\mathrm{pc}}{4} = 0.25\\,\\mathrm{pc} $$\n判据是 $\\Delta x \\le 0.25\\,\\mathrm{pc}$。给定的 $\\Delta x = 0.5\\,\\mathrm{pc}$，我们有：\n$$ 0.5\\,\\mathrm{pc} \\le 0.25\\,\\mathrm{pc} $$\n这个陈述是**错误的**。因此，分辨率判据被**违反**。\n\n**4. 违反判据的后果**\n\n当 Truelove 判据被违反时，网格太粗糙，无法解析金斯长度。随着坍缩的进行，密度增加，局域金斯长度收缩。一旦 $\\lambda_J$ 变得比网格尺度还小，模拟就无法再模拟抵抗坍缩的压力。这会导致不符合物理现实的、网格尺度上的碎裂。为避免这种情况，并模拟未解析的坍缩和恒星形成的物理过程，计算天体物理学家采用次网格模型。这些包括：\n- “汇”粒子（或恒星粒子）来表示未解析的坍缩核心，从网格中吸积质量。\n- 次网格恒星形成方案，通常将恒星形成率与局域气体密度和自由下落时间（$t_\\mathrm{ff} \\propto 1/\\sqrt{G\\rho}$）联系起来。\n- 次网格恒星反馈模型，将来自汇粒子的能量、动量、质量和辐射注入到周围的网格气体中，以表示来自新形成恒星的风、喷流和超新星的影响。\n\n### 逐项分析\n\n**A.**\n- (i) `$\\Delta x$ 是一个立方网格单元的线性尺寸。` **正确**。这是一个标准定义。\n- (ii) `金斯长度为 $\\lambda_J = \\sqrt{\\pi c_s^2/(G\\rho_0)}$。` **正确**。如上所述推导。\n- (iii) `Truelove 判据为 $\\lambda_J/N_J \\ge \\Delta x$。` **正确**。这是对该判据的有效陈述。\n- (iv) `...$\\lambda_J \\approx 1.0\\,\\mathrm{pc}$，所以 $\\lambda_J/N_J \\approx 0.25\\,\\mathrm{pc}  \\Delta x$，该判据被违反。` **正确**。计算与我们的推导相符，且判据被违反的结论是正确的。\n- (v) `当判据被违反时，压力梯度...分辨率不足...必须采用次网格...方案...` **正确**。这准确地描述了物理和数值上的后果，以及对坍缩、恒星形成和反馈的次网格模型的需要。\n**结论：正确。**\n\n**B.**\n- (iii) `Truelove 判据为 $\\Delta x \\ge \\lambda_J/N_J$。` **不正确**。这与正确的判据相反。需要更精细的网格（更小的 $\\Delta x$）才能满足判据，而不是更粗糙的网格。\n- (iv) `...网格满足该判据...` **不正确**。它被违反了。\n- (v) `...格式中的数值扩散会抑制任何人为坍缩...` **不正确**。依赖数值扩散不是一种有物理动机或可控的方法来处理引力坍缩；它是一种应被最小化的伪影。正确的解决方案是次网格模型。\n**结论：不正确。**\n\n**C.**\n- (i) `$\\Delta x$ 是网格中可分辨的最小波长。` **不正确**。可分辨的最小波长是 $2\\Delta x$（奈奎斯特极限）。\n- (ii) `金斯长度为 $\\lambda_J = \\sqrt{c_s^2/(G\\rho_0)}$（没有 $\\pi$ 因子）。` **不正确**。从第一性原理的推导包含一个 $\\pi$ 因子。这个表达式是一个数量级估计，而不是线性理论的正式结果。\n- (iv) `...不等式 $\\Delta x \\le \\lambda_J/N_J$ 成立...` **不正确**。如推导所示，该不等式被违反。\n**结论：不正确。**\n\n**D.**\n- (iv) `对于给定参数，$\\lambda_J \\approx 3.1\\,\\mathrm{pc}$...` **不正确**。这是一个计算错误。我们的计算正确地得出 $\\lambda_J \\approx 1.0\\,\\mathrm{pc}$。这个错误会传播到结论中。\n- (iv/v) `...所以该判据得到满足，因此次网格模型...是不必要的。` **不正确**。这个结论基于错误的计算。实际上判据被违反，次网格模型是必要的。\n**结论：不正确。**\n\n**E.**\n- 陈述要求是时间性的（$\\Delta t \\le t_\\mathrm{ff}/N_t$）而不是空间性的。 **不正确**。这将关于时间步长 $\\Delta t$ 的 Courant-Friedrichs-Lewy (CFL) 条件与关于网格间距 $\\Delta x$ 的 Truelove 条件混淆了。虽然时间步长控制对于准确性和稳定性至关重要，但它不能解决人为碎裂的问题，这是一个空间分辨率的问题。\n- `...可以通过减小时间步长来恢复稳定性...所以不需要次网格方案...` **不正确**。减小时间步长不能弥补空间分辨率的不足。这显示了对问题的根本误解。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在理解了基本的金斯长度分辨率要求后，我们来探讨一个更高级、更实际的模拟问题。对于一个受外部压力约束的云核，其稳定性是由全局性质决定的，而非仅由局部密度决定。本练习挑战您区分局部的金斯长度和全局的邦纳-埃伯特半径（Bonnor-Ebert radius），并为自适应网格加密（AMR）模拟选择正确的判据，这是精确模拟恒星形成过程的关键一步。",
            "id": "3531970",
            "problem": "一个自适应网格加密（AMR）代码被用于模拟一个自引力的、声速为 $c_s$ 的等温气体云，该气体云嵌入在一个施加近似均匀外部压力 $P_{\\mathrm{ext}}$ 的更热介质中。该设置可以实现两种不同的状态：（i）一个自引力主导且压力约束可忽略的区域（例如，在广延介质内的内部坍缩），以及（ii）一个准静态流体平衡的、受压力约束的核心，可以近似为一个截断的等温球体，通常称为 Bonnor-Ebert (BE) 球。该代码提供三种候选的加密触发器：（a）强制每个局部金斯长度内至少有 $N_J$ 个单元格，（b）强制每个压力截断的等温球体的 BE 半径内至少有 $N_{\\mathrm{BE}}$ 个单元格，以及（c）一个激波指示器，当检测到马赫数 $\\mathcal{M}  1$ 的超音速压缩流和大的压力跳跃时触发加密。\n\n从第一性原理出发，您可以假定以下基本出发点：\n- 在均匀、自引力、等温介质中，线性声-引力波的色散关系产生一个区分稳定与坍缩的临界波数。\n- 球对称下的流体静力学平衡要求 $\\mathrm{d}P/\\mathrm{d}r = -\\rho G M(r)/r^2$，且等温状态方程给出 $P = \\rho c_s^2$。\n- 对于包含表面压力的有界构型，其标量维里定理在平衡时为 $2 E_{\\mathrm{th}} + W + 3 P_{\\mathrm{ext}} V = 0$，其中 $E_{\\mathrm{th}}$ 是热能，$W$ 是引力势能，$V$ 是体积。\n\n以下哪个陈述正确地阐明了金斯长度和 Bonnor-Ebert 半径之间的物理区别，并指出了各自在何时是合适的 AMR 加密指南？\n\nA. 在自引力占主导地位且没有显著压力约束的区域（例如，在大型、近乎均匀的介质内的局部坍缩），局部的金斯长度是正确的加密目标；强制每个金斯长度内有固定数量的单元格有助于在 AMR 中抑制人为碎裂。\n\nB. 在嵌入具有近似均匀 $P_{\\mathrm{ext}}$ 的介质中的、受压力约束的、准静态流体平衡核心中，Bonnor-Ebert 半径提供了一个由 $P_{\\mathrm{ext}}$ 和 $c_s$ 决定的、具有物理意义且近乎固定的外部尺度，因此它是捕捉其全局稳定性和小振幅振荡的合适加密目标；一旦核心变为超临界并向中心凝聚，核心内部的加密应恢复为局部的金斯长度判据。\n\nC. 在固定的 $c_s$ 下，Bonnor-Ebert 半径随内部密度的增加而减小，而与 $P_{\\mathrm{ext}}$ 无关，因此使用它作为加密目标即使在 $P_{\\mathrm{ext}}$ 空间变化时也能自动跟随失控坍缩。\n\nD. 对于无自引力的超音速湍流中的激波捕捉，基于金斯长度或 Bonnor-Ebert 的加密都足够，因为这两个判据在致密的激波后气体中都会收紧；精确模拟激波结构不需要额外的基于激波的指示器。\n\nE. 在固定的 $c_s$ 下，金斯长度与局部密度的平方根成反比，而临界 Bonnor-Ebert 半径与外部压力的平方根成反比；因此，在一个 $P_{\\mathrm{ext}}$ 近乎均匀但内部密度梯度很强的环境中，一种混合策略，即在核心边界周围强制每个 Bonnor-Ebert 半径内的单元格数，并在坍缩内部强制每个金斯长度内的单元格数，能够高效且忠实地解析压力截断的稳定性和引力碎裂。\n\n选择所有适用选项。",
            "solution": "用户提供了一个关于计算天体物理学中自引力气体模拟的自适应网格加密（AMR）策略的问题。我将首先验证问题陈述，然后进行完整解答。\n\n### 第一步：提取已知条件\n\n问题提供了以下信息：\n- **系统**：一个自引力的、声速为 $c_s$ 的等温气体云，嵌入在一个具有均匀外部压力 $P_{\\mathrm{ext}}$ 的更热介质中。\n- **状态 (i)**：自引力主导区域，压力约束可忽略。\n- **状态 (ii)**：准静态流体平衡的、受压力约束的核心，近似为 Bonnor-Ebert (BE) 球。\n- **AMR 触发器 (a)**：维持每个局部金斯长度内至少有 $N_J$ 个单元格。\n- **AMR 触发器 (b)**：维持每个 BE 半径内至少有 $N_{\\mathrm{BE}}$ 个单元格。\n- **AMR 触发器 (c)**：一个用于马赫数 $\\mathcal{M}  1$ 的压缩流的激波指示器。\n- **基本原理 1**：线性声-引力波的色散关系决定了稳定性判据。\n- **基本原理 2**：球对称下的流体静力学平衡为 $\\mathrm{d}P/\\mathrm{d}r = -\\rho G M(r)/r^2$，等温状态方程为 $P = \\rho c_s^2$。\n- **基本原理 3**：有界、平衡构型的维里定理为 $2 E_{\\mathrm{th}} + W + 3 P_{\\mathrm{ext}} V = 0$。\n\n### 第二步：使用已知条件进行验证\n\n- **科学上成立**：该问题基于恒星形成和计算天体物理学中已确立的物理学。金斯不稳定性、Bonnor-Ebert 球、维里平衡和 AMR 加密判据等概念是基础且表述准确的。\n- **提法恰当**：任务是基于这些原理评估几个陈述。这是一个定义明确、有确定答案的概念性问题。\n- **客观性**：问题以精确的技术语言表达，没有主观或含糊的术语。\n- **完整性**：提供了足够的物理背景和基本出发点，以便对选项进行严格分析。没有缺失的定义或矛盾的约束。\n- **其他缺陷**：该问题没有表现出任何其他缺陷，例如不切实际、提法不当、过于简单或无法验证。\n\n### 第三步：结论与行动\n\n问题陈述有效。我现在将进行详细的推导和分析。\n\n### 从第一性原理推导\n\n为了评估这些选项，我们必须首先阐明金斯长度和 Bonnor-Ebert 半径的物理意义和标度关系。\n\n**1. 金斯长度 ($\\lambda_J$)**\n\n金斯长度是通过考虑一个无限、均匀、静态、自引力的等温介质（初始密度为 $\\rho_0$，声速为 $c_s$）中的线性微扰来推导的。线性化的流体方程和泊松方程得到声-引力波的色散关系：\n$$ \\omega^2 = c_s^2 k^2 - 4\\pi G \\rho_0 $$\n其中 $\\omega$ 是角频率， $k$ 是微扰的波数。\n\n如果 $\\omega^2  0$，微扰会指数增长（即不稳定）。这发生在以下情况：\n$$ c_s^2 k^2  4\\pi G \\rho_0 $$\n$$ k  \\frac{\\sqrt{4\\pi G \\rho_0}}{c_s} \\equiv k_J $$\n临界波数 $k_J$ 是金斯波数。相应的金斯长度 $\\lambda_J = 2\\pi/k_J$，是微扰必须具有的最小尺寸才能发生引力不稳定。金斯长度的一个常用定义是：\n$$ \\lambda_J = \\sqrt{\\frac{\\pi c_s^2}{G \\rho_0}} $$\n金斯长度的关键特性是：\n- 它是一个**局部**判据，取决于**局部**气体密度 $\\rho_0$ 和声速 $c_s$。\n- 它代表了热压力支撑被自引力克服的长度尺度。\n- 对于固定的声速 $c_s$，金斯长度的标度关系为 $\\lambda_J \\propto \\rho_0^{-1/2}$。当一个区域被压缩，密度增加时，局部的金斯长度会减小，这意味着越来越小的质量能够变得不稳定。\n- 在 AMR 模拟中，用足够数量的单元格（$N_J$，通常 $\\ge 4$）来解析金斯长度，被称为 Truelove 判据，该判据旨在防止人为碎裂——这是一种数值赝象，即未解析的坍缩导致虚假团块的产生。\n\n**2. Bonnor-Ebert (BE) 半径 ($R_{\\mathrm{BE}}$)**\n\nBonnor-Ebert 半径描述的是一个全局平衡状态，而非局部不稳定性。它适用于一个有限的、等温的、自引力的球体，该球体处于流体静力学平衡状态，并受恒定的外部压力 $P_{\\mathrm{ext}}$ 约束。\n\n根据流体静力学平衡条件 $\\mathrm{d}P/\\mathrm{d}r = -\\rho G M(r)/r^2$ 和等温状态方程 $P = \\rho c_s^2$，可以推导出等温球体的 Lane-Emden 方程。BE 球是该方程的一个解，其边界条件为在其表面半径 $R$ 处的压力等于外部压力：$P(R) = \\rho(R) c_s^2 = P_{\\mathrm{ext}}$。\n\n稳定性分析（使用维里定理或 Lane-Emden 解的性质）揭示出，对于给定的外部压力 $P_{\\mathrm{ext}}$ 和声速 $c_s$，存在一个可以保持稳定平衡的最大质量，即 Bonnor-Ebert 质量 $M_{\\mathrm{BE}}$。质量 $M  M_{\\mathrm{BE}}$ 的云团在全局上对坍缩是不稳定的。对应于这个临界稳定状态的半径是临界 Bonnor-Ebert 半径：\n$$ R_{\\mathrm{BE,crit}} \\approx 0.41 \\frac{c_s^2}{\\sqrt{G P_{\\mathrm{ext}}}} $$\nBonnor-Ebert 半径的关键特性是：\n- 它是一个**全局**尺度，描述整个受压力约束的物体。\n- 它由**外部**压力 $P_{\\mathrm{ext}}$ 和声速 $c_s$ 决定。\n- 对于固定的 $c_s$，临界 BE 半径的标度关系为 $R_{\\mathrm{BE,crit}} \\propto P_{\\mathrm{ext}}^{-1/2}$。\n\n这个区别至关重要：$\\lambda_J$ 是介质内部动态不稳定性的一个局部尺度，而 $R_{\\mathrm{BE}}$ 是一个压力截断物体的平衡和稳定性的全局尺度。\n\n### 逐项分析\n\n**A. 在自引力占主导地位且没有显著压力约束的区域（例如，在大型、近乎均匀的介质内的局部坍缩），局部的金斯长度是正确的加密目标；强制每个金斯长度内有固定数量的单元格有助于在 AMR 中抑制人为碎裂。**\n\n这个陈述准确地描述了金斯不稳定性是主导过程的物理状态。在一个大型气体云中，如果局部密度增强的尺度超过了局部的金斯长度，它们就会坍缩。这对应于问题的状态（i）。陈述的第二部分正确地指出了金斯长度加密在 AMR 代码中的目的：满足 Truelove et al. (1997) 判据，以防止人为碎裂的数值赝象。这是计算天体物理学中的标准实践。\n\n**结论：正确。**\n\n**B. 在嵌入具有近似均匀 $P_{\\mathrm{ext}}$ 的介质中的、受压力约束的、准静态流体平衡核心中，Bonnor-Ebert 半径提供了一个由 $P_{\\mathrm{ext}}$ 和 $c_s$ 决定的、具有物理意义且近乎固定的外部尺度，因此它是捕捉其全局稳定性和小振幅振荡的合适加密目标；一旦核心变为超临界并向中心凝聚，核心内部的加密应恢复为局部的金斯长度判据。**\n\n这个陈述正确地解决了状态（ii）。对于一个准静态流体平衡的、受压力约束的核心，其全局结构和稳定性的相关物理尺度确实是 Bonnor-Ebert 半径，它由 $P_{\\mathrm{ext}}$ 和 $c_s$ 设定。解析这个尺度对于准确模拟核心的平衡及其向不稳定性的过渡至关重要。该陈述接着正确地指出，一旦坍缩开始，中心密度会急剧增加，局部物理过程再次由引力和压力在不断减小的尺度上的竞争所主导。此时，坍缩区域内部的局部金斯长度成为需要解析的关键尺度，加密策略必须切换以跟随它。这描述了一种复杂且物理上正确的多阶段加密策略。\n\n**结论：正确。**\n\n**C. 在固定的 $c_s$ 下，Bonnor-Ebert 半径随内部密度的增加而减小，而与 $P_{\\mathrm{ext}}$ 无关，因此使用它作为加密目标即使在 $P_{\\mathrm{ext}}$ 空间变化时也能自动跟随失控坍缩。**\n\n这个陈述有根本性错误。Bonnor-Ebert 球的定义是其受到外部压力 $P_{\\mathrm{ext}}$ 的约束。其特征半径 $R_{\\mathrm{BE,crit}}$ 明确地依赖于 $P_{\\mathrm{ext}}$，关系为 $R_{\\mathrm{BE,crit}} \\propto P_{\\mathrm{ext}}^{-1/2}$。声称它“与 $P_{\\mathrm{ext}}$ 无关”是错误的。此外，对于 BE 平衡解族，半径和内部密度之间的关系是非单调的；对于固定的 $P_{\\mathrm{ext}}$，随着质量（和中心密度）的增加，半径首先增加到临界点，然后对于不稳定的解才开始减小。因此，BE 半径并不能提供一种简单、自动的方式来跟随失控坍缩。失控坍缩的合适尺度是局部的金斯长度。\n\n**结论：不正确。**\n\n**D. 对于无自引力的超音速湍流中的激波捕捉，基于金斯长度或 Bonnor-Ebert 的加密都足够，因为这两个判据在致密的激波后气体中都会收紧；没有额外的基于激波的指示器是精确模拟激波结构所必需的。**\n\n这个陈述错误地将基于引力的判据应用于一个纯粹的流体动力学问题。金斯长度和 Bonnor-Ebert 半径只有在存在自引力时才具有物理意义。虽然激波前沿确实会增加密度，这在形式上会减小计算出的金斯长度，但这并不是加密的正确物理动机。激波是流体动力学变量的急剧不连续面，要准确捕捉它们，需要专门的激波寻找算法（例如，基于压力梯度或速度散度 $\\nabla \\cdot \\mathbf{v}  0$）来精确地在激波前沿放置分辨率。为一个非引力问题依赖基于引力的判据，在概念上是错误的，在数值上是低效的，并且可能无法正确解析激波结构本身。声称不需要额外的激波指示器是错误的；它正是解决此类问题的主要工具。\n\n**结论：不正确。**\n\n**E. 在固定的 $c_s$ 下，金斯长度与局部密度的平方根成反比，而临界 Bonnor-Ebert 半径与外部压力的平方根成反比；因此，在一个 $P_{\\mathrm{ext}}$ 近乎均匀但内部密度梯度很强的环境中，一种混合策略，即在核心边界周围强制每个 Bonnor-Ebert 半径内的单元格数，并在坍缩内部强制每个金斯长度内的单元格数，能够高效且忠实地解析压力截断的稳定性和引力碎裂。**\n\n这个陈述清晰地总结了核心物理学及其对 AMR 的实际意义。它正确地陈述了标度关系：$\\lambda_J \\propto \\rho^{-1/2}$（局部）和 $R_{\\mathrm{BE,crit}} \\propto P_{\\mathrm{ext}}^{-1/2}$（全局）。基于这个正确的物理区别，它提出了一种混合 AMR 策略。这种策略是合理的：使用 BE 半径判据来解析受压力约束核心的全局结构和稳定性边界，并使用金斯长度判据来跟进局部引力占主导地位的致密内部的动态坍缩。这是对恒星形成问题中现代、基于物理动机的 AMR 方案的极好描述。它有效地结合了选项 A 和 B 中提出的正确观点。\n\n**结论：正确。**",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}