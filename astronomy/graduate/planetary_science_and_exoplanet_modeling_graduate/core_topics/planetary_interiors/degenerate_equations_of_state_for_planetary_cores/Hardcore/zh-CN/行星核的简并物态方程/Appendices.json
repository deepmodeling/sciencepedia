{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，这个练习将系外行星的观测数据（质量和半径）与关于其组成的根本问题联系起来。通过计算一个“超级地球”或“迷你海王星”的平均密度，我们可以对其内部结构做出首要的、强有力的推断 。这个练习旨在阐明，即使是简单的密度计算，也能揭示出行星在自身引力下压缩的重要性，并强调了理解物质在极端压力下的状态方程（EOS）对于解释观测结果的必要性。",
            "id": "4173924",
            "problem": "考虑一颗近距系外行星候选体，其质量为 $M = 5\\,M_{\\oplus}$，半径为 $R = 2.5\\,R_{\\oplus}$，其中 $M_{\\oplus}$ 和 $R_{\\oplus}$ 分别代表地球的质量和半径。假设该行星近似为球形，且孔隙率可忽略不计。使用以下参考值：$M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$ 和 $R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$。\n\na) 直接从质量密度和球体几何体积的定义出发，推导出行星平均密度 $\\bar{\\rho}$ 关于 $M$ 和 $R$ 的表达式。计算给定 $M$ 和 $R$ 下的 $\\bar{\\rho}$ 值，并用 $\\mathrm{g\\,cm^{-3}}$ 单位表示您的最终数值结果。将您的答案四舍五入到四位有效数字。\n\nb) 利用行星物质（如硅酸盐和铁）物态方程 (EOS) 的物理上合理的性质（具体而言，对于具有有限体积模量的材料，密度随压力增加而增加），论证这颗行星是否可能完全由岩石构成。您的推理应基于第一性原理和经过充分检验的材料性质，而不使用任何特定的质量-半径“快捷”公式。您的论证应考虑自压缩相对于常见岩石材料的零压密度对平均密度的定性影响。\n\n最终答案只需提供 (a) 部分所要求的数值。",
            "solution": "该问题被评估为有效，因为它具有科学依据、内容自洽且客观。它提出了一个行星科学入门的标准问题，可以使用基本物理原理解决。\n\n**a) 部分：平均密度计算**\n\n天体的平均密度（记为 $\\bar{\\rho}$）定义为其总质量 $M$ 除以其总体积 $V$。\n$$\n\\bar{\\rho} = \\frac{M}{V}\n$$\n问题陈述该行星可近似为球体。半径为 $R$ 的球体的体积由几何公式给出：\n$$\nV = \\frac{4}{3}\\pi R^3\n$$\n将此体积表达式代入平均密度的定义，得到 $\\bar{\\rho}$ 关于 $M$ 和 $R$ 的所需表达式：\n$$\n\\bar{\\rho} = \\frac{M}{\\frac{4}{3}\\pi R^3} = \\frac{3M}{4\\pi R^3}\n$$\n现在，我们使用所提供的数据计算 $\\bar{\\rho}$ 的数值。\n给定条件为：\n- 行星质量：$M = 5\\,M_{\\oplus}$\n- 行星半径：$R = 2.5\\,R_{\\oplus}$\n- 地球质量：$M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$\n- 地球半径：$R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$\n\n首先，我们用国际单位制（SI）计算行星的质量 $M$ 和半径 $R$：\n$$\nM = 5 \\times (5.972 \\times 10^{24}\\,\\mathrm{kg}) = 2.986 \\times 10^{25}\\,\\mathrm{kg}\n$$\n$$\nR = 2.5 \\times (6.371 \\times 10^{6}\\,\\mathrm{m}) = 1.59275 \\times 10^{7}\\,\\mathrm{m}\n$$\n接下来，我们将这些值代入平均密度的表达式中：\n$$\n\\bar{\\rho} = \\frac{3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg})}{4\\pi (1.59275 \\times 10^{7}\\,\\mathrm{m})^3}\n$$\n我们来计算分母：\n$$\n(1.59275 \\times 10^{7})^3 = (1.59275)^3 \\times 10^{21} \\approx 4.040608 \\times 10^{21}\\,\\mathrm{m}^3\n$$\n$$\n4\\pi R^3 \\approx 4\\pi \\times (4.040608 \\times 10^{21}\\,\\mathrm{m}^3) \\approx 5.07758 \\times 10^{22}\\,\\mathrm{m}^3\n$$\n以及分子：\n$$\n3M = 3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg}) = 8.958 \\times 10^{25}\\,\\mathrm{kg}\n$$\n现在我们计算以 $\\mathrm{kg\\,m^{-3}}$ 为单位的密度：\n$$\n\\bar{\\rho} = \\frac{8.958 \\times 10^{25}\\,\\mathrm{kg}}{5.07758 \\times 10^{22}\\,\\mathrm{m}^3} \\approx 1764.20\\,\\mathrm{kg\\,m^{-3}}\n$$\n问题要求答案以 $\\mathrm{g\\,cm^{-3}}$ 为单位。我们使用转换因子：\n- $1\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $1\\,\\mathrm{m} = 100\\,\\mathrm{cm} \\implies 1\\,\\mathrm{m}^3 = (100\\,\\mathrm{cm})^3 = 10^6\\,\\mathrm{cm}^3$\n因此，密度的转换为：\n$$\n1\\,\\mathrm{kg\\,m^{-3}} = \\frac{1000\\,\\mathrm{g}}{10^6\\,\\mathrm{cm}^3} = 10^{-3}\\,\\mathrm{g\\,cm^{-3}}\n$$\n将此转换应用于我们的结果：\n$$\n\\bar{\\rho} \\approx 1764.20 \\times 10^{-3}\\,\\mathrm{g\\,cm^{-3}} = 1.76420\\,\\mathrm{g\\,cm^{-3}}\n$$\n按要求将结果四舍五入到四位有效数字，得到：\n$$\n\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n\n**b) 部分：纯岩石组成的可行性**\n\n纯岩石组成的可行性可以通过比较行星计算出的平均密度与已知岩石材料的密度来评估，同时考虑引力自压缩效应。\n\n$1$. **材料的零压密度：** 一个“纯岩石”行星主要由硅酸盐和可能存在的铁核组成。这些材料的零压（未压缩）密度 $\\rho_0$ 是公认的：\n- 构成行星幔的常见硅酸盐矿物（例如橄榄石、辉石）的 $\\rho_0$ 大约在 $3.2 - 3.5\\,\\mathrm{g\\,cm^{-3}}$ 范围内。即使是像花岗岩这样的地壳岩石，其 $\\rho_0 \\approx 2.7\\,\\mathrm{g\\,cm^{-3}}$。\n- 铁，作为行星核的主要成分，其零压密度为 $\\rho_{0, \\text{Fe}} \\approx 7.9\\,\\mathrm{g\\,cm^{-3}}$。\n\n$2$. **自压缩效应：** 该行星的质量为 $M = 5\\,M_{\\oplus}$，相当可观。其自身引力会在其内部产生巨大压力，从而压缩构成物质。材料的压力和密度之间的关系由其物态方程（EOS）描述。所有具有有限体积模量 $K$ （其中 $K = -V (\\partial P / \\partial V)_T = \\rho (\\partial P / \\partial \\rho)_T$）的材料的一个基本性质是，压力 $P$ 的增加会导致密度 $\\rho$ 的增加。由于行星内部的压力随深度增加而增加，行星内部任何一点的局部密度都将大于其零压密度。因此，整个行星的平均密度 $\\bar{\\rho}$ 必须大于其构成材料的质量平均零压密度 $\\bar{\\rho}_0$。\n$$ \\bar{\\rho} > \\bar{\\rho}_0 $$\n\n$3$. **论证与结论：** 计算得出的系外行星平均密度为 $\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}$。为论证起见，我们假设该行星为纯岩石组成。密度最低的合理块状岩石材料（硅酸盐）的零压密度为 $\\rho_0 \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}$。对于一个质量为 $5\\,M_{\\oplus}$ 的行星，自压缩会显著增加其密度，因此其平均密度 $\\bar{\\rho}$ 必须严格大于这个值。如果该行星还含有一个铁核，其平均零压密度 $\\bar{\\rho}_0$ 会更高，因此最终压缩后的平均密度 $\\bar{\\rho}$ 会更高。\n\n我们有以下不等关系：\n$$\n\\bar{\\rho}_{\\text{calculated}} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\bar{\\rho}_{\\text{expected for rock-only}} > \\rho_{0, \\text{rock}} \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}\n$$\n这里存在一个明显的矛盾。计算出的行星平均密度（$1.764\\,\\mathrm{g\\,cm^{-3}}$）甚至远低于密度最低的合理岩石材料的*未压缩*密度。由于压缩只会增加密度，一个仅由岩石（和/或铁）构成的行星具有如此低的平均密度在物理上是不可能的。\n\n因此，纯岩石组成是**不可行**的。该行星的低密度表明它必须含有很大一部分低密度物质。可能的候选物质包括一个巨大的水/冰层（$\\rho_0 \\approx 1.0\\,\\mathrm{g\\,cm^{-3}}$），或者对于一颗近距行星来说，更可能是一个体积庞大、质量轻的氢氦气体包层。这种组成是“迷你海王星”的特征，而不是岩石质“超级地球”的特征。",
            "answer": "$$\n\\boxed{1.764}\n$$"
        },
        {
            "introduction": "为了超越简单的平均密度比较，并精确地模拟行星内部，我们需要一个基于物理原理的状态方程。这个练习深入探讨了支配简并行星核内巨大压力的量子力学和静电物理学 。通过从第一性原理推导理想费米气体压力的各项修正，您将深刻理解电子-电子和电子-离子相互作用对总压力的独特贡献，这对于构建精确的行星结构模型至关重要。",
            "id": "4157973",
            "problem": "一个代表大质量系外行星核心的低温、完全简并、非相对论性、均匀的电子-离子等离子体，被建模为一个电中性混合物，其电子数密度为 $n_{e}$，离子数密度为 $n_{i}=n_{e}/Z$，其中 $Z$ 是平均离子电荷。假设电子自旋是未极化的。在原子单位下进行计算，其中玻尔半径 $a_{0}$ 和哈特里能量 $E_{\\mathrm{H}}$ 分别用于对长度和能量进行无量纲化；在这些单位中，$a_{0}=1$ 且 $E_{\\mathrm{H}}=1$。电子费米波矢为 $k_{F}=(3\\pi^{2}n_{e})^{1/3}$，维格纳-赛兹半径由 $(4/3)\\pi (r_{s})^{3}=1/n_{e}$ 定义。\n\n从第一性原理出发，使用将均匀系统的压强 $P$ 与能量密度 $u(n)$ 相关联的零温热力学恒等式 $P=n\\,\\frac{\\partial u}{\\partial n}-u$，并结合经过充分检验的非理想贡献的高密度极限下的领头阶形式：\n- 每个电子的电子-电子交换能 $\\varepsilon_{x}(n_{e})=-\\frac{3}{4\\pi}k_{F}$，\n- 每个电子的电子-电子关联能 $\\varepsilon_{c}(r_{s})\\approx a\\,\\ln r_{s}+b$（仅保留这两个领头项），\n- 每个离子的离子-离子库仑（马德隆）能 $\\varepsilon_{M}(n_{i})=-\\alpha_{M}\\,\\frac{Z^{2}}{a_{i}}$，其中 $a_{i}=\\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}$ 且 $\\alpha_{M}$ 是单组分等离子体（OCP）结构的特征正常数。\n\n令 $P_{0}$ 表示理想（非相对论性）零温电子费米压强。推导在小 $r_{s}$ 的领头阶上总的分数压强修正\n$$\nf \\equiv \\frac{\\Delta P}{P_{0}} = \\frac{P_{x}+P_{c}+P_{M}}{P_{0}},\n$$\n其中 $P_{x}$、$P_{c}$ 和 $P_{M}$ 分别是交换、关联和马德隆压强贡献。将你的最终答案表示为单个闭合形式的解析表达式 $f(r_{s},Z,\\alpha_{M},a)$，完全采用原子单位，并用 $r_{s}$、$Z$、$\\alpha_{M}$、$a$ 和 $\\pi$ 表示。无需进行数值计算，且最终答案应为无量纲的。在最终表达式中不要包含单位。",
            "solution": "用户希望我扮演一位严谨的 STEM 教授，解决一个与简并等离子体状态方程相关的物理问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    -   **步骤 1：提取已知条件。** 我将逐字列出所有给定的量、定义和方程。\n    -   **步骤 2：验证。** 我将根据科学依据、适定性、客观性等标准检查该问题。\n        -   该问题涉及简并电子-离子等离子体，这是凝聚态物理和天体物理学中的一个标准模型。\n        -   费米气体、交换能、关联能和马德隆能的概念都是标准概念。\n        -   所提供的表达式在其各自的极限（交换能和关联能的高密度极限，马德隆能的晶体/液体结构极限）下是众所周知的领头阶形式。\n        -   压强的热力学恒等式是一个基本结果。\n        -   该问题要求推导分数压强修正，这是该领域的标准计算。\n        -   所有项均已定义（$n_e, n_i, Z, k_F, r_s, a_i, \\epsilon_x, \\epsilon_c, \\epsilon_M$）。\n        -   要求是找到一个用给定参数表示的解析表达式。\n        -   该问题似乎是自洽的、科学上合理的且适定的。推导过程中没有矛盾或缺少信息。\n    -   **步骤 3：结论与行动。** 问题看起来是有效的。我将开始求解。\n\n2.  **解决问题。**\n    -   **目标：** 推导分数压强修正 $f = (P_x + P_c + P_M) / P_0$。\n    -   **策略：**\n        1.  将所有量与单个密度变量相关联，最好是 $r_s$，因为最终答案要求用 $r_s$ 表示。\n        2.  对于每个能量分量（理想费米气体、交换、关联、马德隆），使用给定的热力学恒等式计算相应的压强：$P = n \\frac{\\partial u}{\\partial n} - u$。注意 u 是能量*密度*，而问题给出的是*每个粒子*的能量（$\\epsilon$）。它们的关系是 $u = n \\epsilon$。\n        3.  所以，$P = n \\frac{\\partial (n\\epsilon)}{\\partial n} - n\\epsilon = n ( \\epsilon + n \\frac{\\partial \\epsilon}{\\partial n}) - n\\epsilon = n^2 \\frac{\\partial \\epsilon}{\\partial n}$。\n        4.  我需要用 $\\frac{\\partial}{\\partial r_s}$ 来表示导数 $\\frac{\\partial}{\\partial n}$。从 $(4/3)\\pi r_s^3 = 1/n$，我们得到 $n = \\frac{3}{4\\pi r_s^3}$。\n        5.  因此，$\\frac{\\partial n}{\\partial r_s} = \\frac{3}{4\\pi} (-3 r_s^{-4}) = -\\frac{9}{4\\pi r_s^4} = -3 \\frac{n}{r_s}$。\n        6.  链式法则给出 $\\frac{\\partial \\epsilon}{\\partial n} = \\frac{\\partial \\epsilon}{\\partial r_s} \\frac{\\partial r_s}{\\partial n} = \\frac{\\partial \\epsilon}{\\partial r_s} (-\\frac{r_s}{3n})$。\n        7.  将此代入压强公式：$P = n^2 \\frac{\\partial \\epsilon}{\\partial n} = n^2 \\left( \\frac{\\partial \\epsilon}{\\partial r_s} \\left(-\\frac{r_s}{3n}\\right) \\right) = -\\frac{n r_s}{3} \\frac{\\partial \\epsilon}{\\partial r_s}$。这是我将用于每个分量的关键公式。\n\n    -   **分步计算：**\n\n        **a) 理想费米气体压强 ($P_0$)**\n        -   每个电子的理想费米气体能量为 $\\epsilon_0 = \\frac{3}{5} E_F$，其中 $E_F = \\frac{k_F^2}{2m_e}$。在原子单位中，质量是电子质量（$m_e=1$），所以 $E_F = \\frac{k_F^2}{2}$。\n        -   $k_F = (3\\pi^2 n_e)^{1/3}$。\n        -   $n_e = \\frac{3}{4\\pi r_s^3}$。\n        -   $k_F = (3\\pi^2 \\frac{3}{4\\pi r_s^3})^{1/3} = (\\frac{9\\pi}{4})^{1/3} \\frac{1}{r_s}$。\n        -   $\\epsilon_0 = \\frac{3}{5} \\frac{k_F^2}{2} = \\frac{3}{10} k_F^2 = \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3} \\frac{1}{r_s^2}$。我们称 $C_0 = \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3}$。所以 $\\epsilon_0 = C_0 r_s^{-2}$。\n        -   现在，使用我推导的压强公式计算 $P_0$：$P_0 = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_0}{\\partial r_s}$。\n        -   $\\frac{\\partial \\epsilon_0}{\\partial r_s} = C_0 (-2 r_s^{-3})$。\n        -   $P_0 = -\\frac{n_e r_s}{3} (-2 C_0 r_s^{-3}) = \\frac{2}{3} n_e C_0 r_s^{-2} = \\frac{2}{3} (\\frac{3}{4\\pi r_s^3}) (C_0 r_s^{-2}) = \\frac{C_0}{2\\pi r_s^5}$。\n        -   让我们代入 $C_0$：$P_0 = \\frac{1}{2\\pi r_s^5} \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3} = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$。\n        -   我们用标准公式 $P_0 = \\frac{2}{5} n_e E_F$ 来核对。\n        -   $P_0 = \\frac{2}{5} n_e (\\frac{k_F^2}{2}) = \\frac{1}{5} n_e k_F^2 = \\frac{1}{5} (\\frac{3}{4\\pi r_s^3}) ((\\frac{9\\pi}{4})^{1/3} \\frac{1}{r_s})^2 = \\frac{3}{20\\pi r_s^3} (\\frac{9\\pi}{4})^{2/3} \\frac{1}{r_s^2} = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$。结果一致。很好。\n\n        **b) 交换压强 ($P_x$)**\n        -   每个电子的能量：$\\epsilon_x = -\\frac{3}{4\\pi} k_F$。\n        -   使用 $k_F = (\\frac{9\\pi}{4})^{1/3} r_s^{-1}$，我们得到 $\\epsilon_x = -\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3} r_s^{-1}$。我们称 $C_x = -\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3}$。所以 $\\epsilon_x = C_x r_s^{-1}$。\n        -   使用公式计算 $P_x$：$P_x = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_x}{\\partial r_s}$。注意，这是适用的，因为 $P_x = n_e^2 \\frac{\\partial \\epsilon_x}{\\partial n_e}$。\n        -   $\\frac{\\partial \\epsilon_x}{\\partial r_s} = C_x (-1 r_s^{-2}) = -C_x r_s^{-2}$。\n        -   $P_x = -\\frac{n_e r_s}{3} (-C_x r_s^{-2}) = \\frac{1}{3} n_e C_x r_s^{-1} = \\frac{1}{3} (\\frac{3}{4\\pi r_s^3}) (C_x r_s^{-1}) = \\frac{C_x}{4\\pi r_s^4}$。\n        -   代入 $C_x$：$P_x = \\frac{1}{4\\pi r_s^4} (-\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3}) = -\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}$。\n        -   对于交换能，$u_x = n_e \\epsilon_x \\propto n_e \\cdot n_e^{1/3} = n_e^{4/3}$。那么 $P_x=n_e \\frac{\\partial u_x}{\\partial n_e} - u_x = n_e (\\frac{4}{3} n_e^{1/3}) - n_e^{4/3} = \\frac{1}{3} u_x$。让我们检查一下我的计算。\n        -   $P_x = \\frac{1}{3} u_x = \\frac{1}{3} n_e \\epsilon_x = \\frac{1}{3} (\\frac{3}{4\\pi r_s^3}) C_x r_s^{-1} = \\frac{C_x}{4\\pi r_s^4}$。结果一致。\n\n        **c) 关联压强 ($P_c$)**\n        -   每个电子的能量：$\\epsilon_c \\approx a \\ln r_s + b$。问题中说“仅保留这两个领头项”。这是高密度极限 ($r_s \\to 0$)。\n        -   计算 $P_c$：$P_c = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_c}{\\partial r_s}$。\n        -   $\\frac{\\partial \\epsilon_c}{\\partial r_s} = \\frac{a}{r_s}$。\n        -   $P_c = -\\frac{n_e r_s}{3} (\\frac{a}{r_s}) = -\\frac{a n_e}{3} = -\\frac{a}{3} (\\frac{3}{4\\pi r_s^3}) = -\\frac{a}{4\\pi r_s^3}$。\n        -   我们用 $P_c = n_e^2 \\frac{\\partial \\epsilon_c}{\\partial n_e}$ 来核对。\n        -   $\\epsilon_c = a \\ln r_s + b$。我们有 $r_s = (\\frac{3}{4\\pi n_e})^{1/3}$。\n        -   $\\ln r_s = \\frac{1}{3} \\ln(\\frac{3}{4\\pi n_e}) = \\frac{1}{3} (\\ln(\\frac{3}{4\\pi}) - \\ln n_e) = -\\frac{1}{3} \\ln n_e + \\text{const}$。\n        -   所以 $\\epsilon_c = -\\frac{a}{3} \\ln n_e + \\text{const'} $。\n        -   $\\frac{\\partial \\epsilon_c}{\\partial n_e} = -\\frac{a}{3 n_e}$。\n        -   $P_c = n_e^2 (-\\frac{a}{3 n_e}) = -\\frac{a n_e}{3}$。结果一致。\n\n        **d) 马德隆（离子-离子）压强 ($P_M$)**\n        -   这部分需要小心处理。能量是按*每个离子*给出的，$\\epsilon_M(n_i)$，并且是*离子*数密度 $n_i$ 的函数。压强公式 $P=n^2 \\frac{\\partial \\epsilon}{\\partial n}$ 适用于单组分系统。而这里我们有一个多组分系统。\n        -   总能量密度为 $u_{total} = u_{e,kin} + u_{e-e} + u_{ion-ion} + u_{e-ion}$。问题给出了 $u_{e-e} = n_e(\\epsilon_x + \\epsilon_c)$ 和 $u_{ion-ion} = n_i \\epsilon_M$。电子-离子能量被隐含地包含在马德隆项中。马德隆能量 $\\epsilon_M$ 是离子在均匀中和电子背景中的静电能。因此，它包括了离子-离子、离子-背景以及背景自能。系统的总静电能由 $U_{Madelung} = N_i \\epsilon_M$ 给出。\n        -   总能量密度为 $u = n_e \\epsilon_0 + n_e \\epsilon_x + n_e \\epsilon_c + n_i \\epsilon_M$。\n        -   总压强为 $P = n_e \\frac{\\partial u}{\\partial n_e} - u$ (因为 $n_i = n_e/Z$，$n_e$ 是独立的密度变量)。\n        -   $P = P_0 + P_x + P_c + P_M$。我们需要求 $P_M$。\n        -   令 $u_M = n_i \\epsilon_M(n_i) = \\frac{n_e}{Z} \\epsilon_M(n_i)$。\n        -   $P_M = n_e \\frac{\\partial u_M}{\\partial n_e} - u_M = n_e \\frac{\\partial}{\\partial n_e}(\\frac{n_e}{Z} \\epsilon_M) - \\frac{n_e}{Z} \\epsilon_M$。\n        -   $P_M = \\frac{n_e}{Z} \\epsilon_M + \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e} - \\frac{n_e}{Z} \\epsilon_M = \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e}$。\n        -   我们需要 $\\frac{\\partial \\epsilon_M}{\\partial n_e}$。能量是作为 $n_i$ 的函数给出的：$\\epsilon_M(n_i) = -\\alpha_M \\frac{Z^2}{a_i}$，其中 $a_i = (\\frac{3}{4\\pi n_i})^{1/3}$。\n        -   我们用 $n_e$ 表示 $\\epsilon_M$。$n_i = n_e/Z$。\n        -   $a_i = (\\frac{3Z}{4\\pi n_e})^{1/3} = Z^{1/3} (\\frac{3}{4\\pi n_e})^{1/3} = Z^{1/3} r_s$。\n        -   所以，$\\epsilon_M = -\\alpha_M \\frac{Z^2}{Z^{1/3} r_s} = -\\alpha_M Z^{5/3} r_s^{-1}$。\n        -   现在我们可以用更一般的压强公式，但这可能很棘手。我们还是坚持用 $n_e$ 的导数。\n        -   我们用 $n_e$ 重新表示 $\\epsilon_M$。$\\epsilon_M = -\\alpha_M Z^2 (\\frac{4\\pi n_i}{3})^{1/3} = -\\alpha_M Z^2 (\\frac{4\\pi n_e}{3Z})^{1/3} = -\\alpha_M Z^2 Z^{-1/3} (\\frac{4\\pi n_e}{3})^{1/3} = -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} n_e^{1/3}$。\n        -   现在计算 $\\frac{\\partial \\epsilon_M}{\\partial n_e}$：$\\frac{\\partial \\epsilon_M}{\\partial n_e} = -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} \\frac{1}{3} n_e^{-2/3} = \\frac{1}{3 n_e} \\left( -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} n_e^{1/3} \\right) = \\frac{\\epsilon_M}{3 n_e}$。\n        -   所以，$P_M = \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e} = \\frac{n_e^2}{Z} \\frac{\\epsilon_M}{3 n_e} = \\frac{n_e \\epsilon_M}{3Z}$。\n        -   我们来核对一下。总马德隆能量密度为 $u_M = n_i \\epsilon_M = (n_e/Z) \\epsilon_M$。\n        -   从 $\\epsilon_M \\propto n_e^{1/3}$，我们得到 $u_M \\propto (n_e/Z) n_e^{1/3} = (1/Z) n_e^{4/3}$。\n        -   $P_M = n_e \\frac{\\partial u_M}{\\partial n_e} - u_M = n_e (\\frac{1}{Z} \\frac{4}{3} n_e^{1/3}) - \\frac{1}{Z} n_e^{4/3} = \\frac{4}{3} \\frac{n_e^{4/3}}{Z} - \\frac{n_e^{4/3}}{Z} = \\frac{1}{3} \\frac{n_e^{4/3}}{Z} = \\frac{1}{3} u_M$。\n        -   所以 $P_M = \\frac{1}{3} u_M = \\frac{1}{3} n_i \\epsilon_M = \\frac{n_e \\epsilon_M}{3Z}$。推导是正确的。\n        -   现在，我们用 $r_s$ 表示 $P_M$。\n        -   $P_M = \\frac{n_e}{3Z} \\epsilon_M = \\frac{1}{3Z} (\\frac{3}{4\\pi r_s^3}) (-\\alpha_M Z^{5/3} r_s^{-1}) = -\\frac{3 \\alpha_M Z^{5/3}}{12 \\pi Z r_s^4} = -\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}$。\n\n        **e) 组合分数修正**\n        -   我们需要求 $f = \\frac{P_x + P_c + P_M}{P_0}$。问题要求的是小 $r_s$ 的领头阶。这意味着我们需要比较分子和分母中 $r_s$ 的幂次。\n        -   $P_0 \\propto r_s^{-5}$\n        -   $P_x \\propto r_s^{-4}$\n        -   $P_c \\propto r_s^{-3}$\n        -   $P_M \\propto r_s^{-4}$\n\n        -   比率 $\\Delta P / P_0$ 将包含与以下成正比的项：\n            -   $P_x/P_0 \\propto r_s^{-4} / r_s^{-5} = r_s^1$\n            -   $P_c/P_0 \\propto r_s^{-3} / r_s^{-5} = r_s^2$\n            -   $P_M/P_0 \\propto r_s^{-4} / r_s^{-5} = r_s^1$\n\n        -   问题陈述为“在小 $r_s$ 的领头阶上”。这被解释为使用问题给出的各能量分量的领头阶表达式，并计算相应的压强贡献，不做进一步的近似。我们将这些贡献相加。\n\n        -   **我们来计算这些比率：**\n            -   **$P_x / P_0$**：\n                $P_x = -\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}$\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$\n                $\\frac{P_x}{P_0} = \\frac{-\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{3}{16\\pi^2} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-1/3} r_s$\n                $= -\\frac{5}{4\\pi} (\\frac{4}{9\\pi})^{1/3} r_s$。\n\n            -   **$P_M / P_0$**：\n                $P_M = -\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}$。\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$。\n                $\\frac{P_M}{P_0} = \\frac{-\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{\\alpha_M Z^{2/3}}{4\\pi} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-2/3} r_s$\n                $= -\\frac{5 \\alpha_M Z^{2/3}}{3} (\\frac{4}{9\\pi})^{2/3} r_s$。\n\n            -   **$P_c / P_0$**：\n                $P_c = -\\frac{a}{4\\pi r_s^3}$。\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$。\n                $\\frac{P_c}{P_0} = \\frac{-\\frac{a}{4\\pi r_s^3}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{a}{4\\pi} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-2/3} r_s^2$\n                $= -\\frac{5a}{3} (\\frac{4}{9\\pi})^{2/3} r_s^2$。\n\n        -   **组合 f 的各项：**\n        总的分数压强修正 f 是这三项贡献之和。\n        $f(r_s, Z, \\alpha_M, a) = \\frac{P_x}{P_0} + \\frac{P_M}{P_0} + \\frac{P_c}{P_0}$\n        $$ f(r_s, Z, \\alpha_M, a) = -\\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} r_s - \\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\n        这个表达式可以通过提取公因式来重新整理。提取出 $r_s$ 项后得到：\n        $$ f(r_s, Z, \\alpha_M, a) = - \\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_s - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\n        这就是所要求的最终闭合形式解析表达式。方括号中的第一项是交换贡献，第二项是马德隆贡献，最后一项是关联贡献。",
            "answer": "$$ \\boxed{ - \\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_{M} Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_{s} - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_{s}^2 } $$"
        },
        {
            "introduction": "这项综合性练习旨在将理论知识转化为强大的计算工具，是本章的压轴实践。行星形成和演化过程中的巨大撞击等动态事件，其建模离不开对冲击波物理的理解 。此练习将指导您如何将简并电子气状态方程（作为冷压曲线）与兰金-雨贡尼奥冲击关系相结合，通过编写一个数值求解器来预测材料在极端压缩下的响应，这是计算行星科学中的一项核心技能。",
            "id": "4157975",
            "problem": "你需要编写一个完整、可运行的程序，用于计算一种简化的行星核材料在主 Hugoniot 曲线上的冲击压缩态，其物态方程包含零温简并电子的贡献。目标是通过求解 Rankine–Hugoniot 关系以及一个锚定在简并电子冷曲线上的 Mie–Grüneisen 闭合，来计算给定初始态和冲击态下的压缩比。所有物理量必须使用国际单位制（SI），密度单位为千克/立方米，压强单位为帕斯卡。\n\n从以下基本定义和定律出发：\n\n1. 穿过激波的质量守恒给出了上游和下游比容之间的关系，而穿过平面稳态激波的能量守恒则得出 Rankine–Hugoniot 能量条件，\n   $$E - E_0 = \\frac{1}{2}\\,(P + P_0)\\,(V_0 - V),$$\n   其中 $E$ 和 $E_0$ 是比内能（单位：焦耳/千克），$P$ 和 $P_0$ 是压强（单位：帕斯卡），$V$ 和 $V_0$ 是比容（单位：立方米/千克），并且对于质量密度 $\\rho$ 和 $\\rho_0$，有 $V = 1/\\rho$ 和 $V_0 = 1/\\rho_0$。\n\n2. Mie–Grüneisen 形式（使用常数 Grüneisen 参数）将压强与冷曲线和热能关联起来，如下所示：\n   $$P(\\rho, E) = P_{\\text{cold}}(\\rho) + \\Gamma\\,\\rho\\,[E - E_{\\text{cold}}(\\rho)],$$\n   其中 $\\Gamma$ 是一个无量纲常数，$P_{\\text{cold}}(\\rho)$ 和 $E_{\\text{cold}}(\\rho)$ 分别是零温压强和比内能。\n\n3. 将冷曲线建模为非相对论性、零温、完全简并电子气，其成分由平均每重子电子数 $\\mu_e$ 表征，满足以下关系：\n   $$n_e = \\frac{\\rho}{\\mu_e\\,m_u},$$\n   $$P_{\\text{cold}}(\\rho) = \\frac{\\hbar^2}{5 m_e}\\,(3\\pi^2)^{2/3}\\,n_e^{5/3},$$\n   $$u_{\\text{cold}}(\\rho) = \\frac{3}{5}\\,n_e\\,E_F, \\quad E_F = \\frac{\\hbar^2}{2 m_e}\\,(3\\pi^2\\,n_e)^{2/3}, \\quad E_{\\text{cold}}(\\rho) = \\frac{u_{\\text{cold}}(\\rho)}{\\rho},$$\n   等效地得出 $u_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)$ 和 $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)/\\rho$。这里 $\\hbar$ 是约化普朗克常数，$m_e$ 是电子质量，$m_u$ 是原子质量单位，$n_e$ 是电子数密度。所有常数必须使用国际单位制。\n\n4. 主 Hugoniot 初始态：取密度为 $\\rho_0$ 的冷曲线上的点作为上游（初始）状态，因此 $E_0 = E_{\\text{cold}}(\\rho_0)$ 且 $P_0 = P_{\\text{cold}}(\\rho_0)$。\n\n你的任务是实现一个求解器，对于给定的目标冲击压强 $P$ 和参数 $(\\rho_0, \\mu_e, \\Gamma)$，确定满足 Rankine–Hugoniot 关系、Mie–Grüneisen 闭合以及简并冷曲线的冲击后密度 $\\rho$。根据此密度，报告压缩比\n$$\\eta = \\frac{\\rho}{\\rho_0}。$$\n\n问题要求你：\n- 通过消去冲击后的比内能 $E$，推导出一个关于未知冲击密度 $\\rho$ 的非线性方程，同时在代码中明确保留上述所有定义。\n- 对 $\\rho \\ge \\rho_0$ 稳健地求解该方程。\n- 计算并返回压缩比 $\\eta$。\n\n物理常数必须取为：\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$，\n- 电子质量 $m_e = 9.10938356\\times 10^{-31}\\,\\text{kg}$，\n- 原子质量单位 $m_u = 1.66053906660\\times 10^{-27}\\,\\text{kg}$。\n\n测试套件：\n实现你的程序，为以下参数集计算 $\\eta$。在所有情况下，初始状态都在冷曲线上，因此必须使用给定的 $\\rho_0$ 和 $\\mu_e$ 从上述公式计算 $P_0$ 和 $E_0$。\n\n- 情况1（理想路径，高压）：$\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$，$\\mu_e = 2.15$，$\\Gamma = 1.5$，目标冲击压强 $P = 1.0\\times 10^{13}\\,\\text{Pa}$。\n- 情况2（近阈值压缩）：与情况1相同的 $\\rho_0$、$\\mu_e$ 和 $\\Gamma$，但目标冲击压强 $P = 1.05\\,P_0$，其中 $P_0 = P_{\\text{cold}}(\\rho_0)$ 必须从冷曲线计算得出。\n- 情况3（较弱简并）：$\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$，$\\mu_e = 2.50$，$\\Gamma = 1.5$，目标冲击压强 $P = 1.0\\times 10^{13}\\,\\text{Pa}$。\n- 情况4（较强热耦合）：$\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$，$\\mu_e = 2.15$，$\\Gamma = 2.0$，目标冲击压强 $P = 1.0\\times 10^{13}\\,\\text{Pa}$。\n\n输出要求：\n- 对于每种情况，将压缩比 $\\eta$ 作为浮点数输出，并四舍五入到六位小数。\n- 你的程序应只产生一行输出，其中包含四个结果，以逗号分隔，并用方括号括起来，例如 `\"[1.234567,1.000123, ...]\"`。\n- 不允许有其他输出。\n\n所有 $\\eta$ 的数值答案都是无量纲浮点数。本问题不使用角度。确保所有内部计算都一致使用国际单位制。对于 $P$ 仅略大于 $P_0$ 的近阈值情况，必须确保求解的稳健性。",
            "solution": "用户希望求解冲击波主 Hugoniot 线上的压缩比 $\\eta = \\rho/\\rho_0$。这涉及到将 Rankine-Hugoniot 守恒定律与一个特定的行星核材料物态方程耦合起来。\n\n问题在于，对于给定的最终压强 $P$，从初始状态 $(\\rho_0, P_0, E_0)$ 出发，找到最终密度 $\\rho$（并因此得到压缩比 $\\eta$）。初始状态位于冷曲线上，意味着 $P_0 = P_{\\text{cold}}(\\rho_0)$ 且 $E_0 = E_{\\text{cold}}(\\rho_0)$。\n\n首先，我们建立控制方程。冲击态 $(\\rho, P, E)$ 和初始态 $(\\rho_0, P_0, E_0)$ 通过两个关于比内能 $E$ 的主要关系式联系起来。\n\n1.  Rankine-Hugoniot 能量守恒关系：\n    $$E = E_0 + \\frac{1}{2}(P + P_0)(V_0 - V)$$\n    其中 $V=1/\\rho$ 和 $V_0=1/\\rho_0$ 是比容。代入 $V$ 和 $V_0$ 可得：\n    $$E = E_0 + \\frac{1}{2}(P + P_0)\\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right)$$\n\n2.  将压强、密度和能量联系起来的 Mie-Grüneisen 物态方程可以重排以求解 $E$：\n    $$P = P_{\\text{cold}}(\\rho) + \\Gamma \\rho [E - E_{\\text{cold}}(\\rho)]$$\n    $$E = E_{\\text{cold}}(\\rho) + \\frac{P - P_{\\text{cold}}(\\rho)}{\\Gamma \\rho}$$\n\n通过令这两个 $E$ 的表达式相等，我们得到了一个定义 Hugoniot 线的单䒱方程，即从给定初始状态出发所有可能的冲击态的轨迹：\n$$E_0 + \\frac{1}{2}(P + P_0)\\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right) = E_{\\text{cold}}(\\rho) + \\frac{P - P_{\\text{cold}}(\\rho)}{\\Gamma \\rho}$$\n在这里，压强 $P$ 和密度 $\\rho$ 是定义 Hugoniot 线上最终状态的变量。任务是找到在给定的目标压强 $P$ 下满足此方程的 $\\rho$ 值。\n\n一种更稳健的数值方法是将这个隐式关系重排，以得到 Hugoniot 压强 $P_H(\\rho)$ 作为密度 $\\rho$ 函数的显式表达式。我们求解 $P$：\n$$P\\left(1 - \\frac{\\Gamma\\rho}{2}\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)\\right) = P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{\\Gamma\\rho}{2}P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)$$\n这就得到了 Hugoniot 压强函数：\n$$P_H(\\rho) = \\frac{P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{1}{2}\\Gamma\\rho P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}{1 - \\frac{1}{2}\\Gamma\\rho\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}$$\n问题随之变为求解方程 $F(\\rho) = P_H(\\rho) - P = 0$ 的根。\n\n为了便于实现，使用无量纲压缩比 $\\eta = \\rho/\\rho_0$ 会更方便。我们使用已给出的冷曲线关系式：\n-   $P_{\\text{cold}}(\\rho) = C\\rho^{5/3}$，这意味着 $P_{\\text{cold}}(\\eta\\rho_0) = C(\\eta\\rho_0)^{5/3} = (C\\rho_0^{5/3})\\eta^{5/3} = P_0\\eta^{5/3}$。\n-   $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\frac{P_{\\text{cold}}(\\rho)}{\\rho}$，这意味着 $E_{\\text{cold}}(\\eta\\rho_0) = \\frac{3}{2}\\frac{P_0\\eta^{5/3}}{\\eta\\rho_0} = \\left(\\frac{3}{2}\\frac{P_0}{\\rho_0}\\right)\\eta^{2/3} = E_0\\eta^{2/3}$。\n\n将这些关系代入 $P_H(\\rho)$ 的表达式并化简，得到 Hugoniot 压强作为 $\\eta$ 的函数：\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta\\rho_0 \\left( E_0 - E_0\\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma\\eta P_0\\left(1 - \\frac{1}{\\eta}\\right)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\n使用 $E_0 = \\frac{3}{2}\\frac{P_0}{\\rho_0}$：\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta P_0 \\frac{3}{2} \\left( 1 - \\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma P_0(\\eta-1)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\n经过代数化简，得到一个更简洁的形式：\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3}(1 - \\frac{3\\Gamma}{2}) + P_0(2\\Gamma\\eta - \\frac{\\Gamma}{2})}{\\frac{2+\\Gamma}{2} - \\frac{\\Gamma\\eta}{2}}$$\n我们必须求解非线性方程 $F(\\eta) = P_H(\\eta) - P = 0$ 以得到未知的 $\\eta$。\n\n压缩激波的物理定义域是 $\\eta > 1$。$P_H(\\eta)$ 的分母在 $\\eta = \\frac{2+\\Gamma}{\\Gamma} = 1 + \\frac{2}{\\Gamma}$ 时变为零。这个值代表了强激波极限下的理论最大压缩比。函数 $P_H(\\eta)$ 在 $\\eta \\in [1, 1+2/\\Gamma)$ 区间内是单调的。在 $\\eta=1$ 时，$P_H(1) = P_0$。当 $\\eta$ 从下方趋近于极点 $1+2/\\Gamma$ 时，$P_H(\\eta)$ 趋向于 $+\\infty$。\n因此，对于任何目标压强 $P > P_0$，在区间 $(1, 1+2/\\Gamma)$ 内都存在一个唯一的解 $\\eta$。我们可以使用稳健的数值求根方法（例如 Brent's method）在此有界区间内对函数 $F(\\eta)$进行求解，以找到冲击后的压缩比 $\\eta$。\n\n算法如下：\n1.  定义物理常数 $\\hbar$、$m_e$、$m_u$。\n2.  实现一个计算冷压强的函数，$P_{\\text{cold}}(\\rho, \\mu_e) = \\frac{\\hbar^2}{5 m_e}(3\\pi^2)^{2/3}\\left(\\frac{\\rho}{\\mu_e m_u}\\right)^{5/3}$。\n3.  对于每个参数为 $(\\rho_0, \\mu_e, \\Gamma, P)$ 的测试用例：\n    a. 计算初始压强 $P_0 = P_{\\text{cold}}(\\rho_0, \\mu_e)$。\n    b. 如果目标压强 $P$ 是以 $P_0$ 的因子的形式给出的，计算其绝对值。\n    c. 定义求根函数 $F(\\eta) = P_H(\\eta) - P$ ，使用推导出的 $P_H(\\eta)$ 表达式。\n    d. 使用 `scipy.optimize.brentq` 在区间 $[1, 1+2/\\Gamma]$ 内找到 $F(\\eta)$ 的根 $\\eta$。为了避免极点，上界使用一个很小的边际，例如 $[1.0, (1+2/\\Gamma) \\times 0.999999]$。\n    e. 存储得到的压缩比 $\\eta$。\n4.  格式化并打印收集到的结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes shock-compressed states on the principal Hugoniot for a simplified\n    planetary-core material.\n    \"\"\"\n\n    # Physical constants in SI units\n    H_BAR = 1.054571817e-34  # J.s\n    M_E = 9.10938356e-31      # kg\n    M_U = 1.66053906660e-27  # kg\n\n    # Pre-compute parts of the cold pressure constant\n    P_COLD_CONST_A = (H_BAR**2 / (5 * M_E)) * (3 * np.pi**2)**(2/3)\n\n    def p_cold(rho, mu_e):\n        \"\"\"\n        Calculates the zero-temperature degenerate electron gas pressure.\n        \n        Args:\n            rho (float): Mass density (kg/m^3).\n            mu_e (float): Electron molecular weight (electrons per baryon).\n        \n        Returns:\n            float: Cold pressure (Pa).\n        \"\"\"\n        if rho == 0:\n            return 0.0\n        p_cold_const_b = 1.0 / (mu_e * M_U)\n        n_e = rho * p_cold_const_b  # electron number density\n        return P_COLD_CONST_A * n_e**(5/3)\n\n    def calculate_compression(rho_0, mu_e, Gamma, P_target_spec):\n        \"\"\"\n        Calculates the shock compression ratio eta for a given set of parameters.\n        \n        Args:\n            rho_0 (float): Initial density (kg/m^3).\n            mu_e (float): Electron molecular weight.\n            Gamma (float): Grüneisen parameter.\n            P_target_spec (float): Target pressure (Pa) or a factor of P_0.\n            \n        Returns:\n            float: Compression ratio eta = rho / rho_0.\n        \"\"\"\n        # Calculate initial state on the cold curve\n        p0 = p_cold(rho_0, mu_e)\n        \n        # Determine absolute target pressure\n        if P_target_spec < 100:  # Heuristic to identify a factor vs absolute pressure\n            P_target = P_target_spec * p0\n        else:\n            P_target = P_target_spec\n            \n        # A physical shock requires P > P0. If P <= P0, eta=1 (no compression).\n        if P_target <= p0:\n            return 1.0\n\n        def hugoniot_root_function(eta):\n            \"\"\"\n            Function F(eta) = P_H(eta) - P_target, whose root we seek.\n            P_H(eta) is the Hugoniot pressure as a function of compression eta.\n            \"\"\"\n            \n            # Numerator of P_H(eta)\n            # This is an alternative, more stable algebraic form\n            numerator = p0 * ( ((2.0 - Gamma * (eta - 1.0)) * eta**(5/3)) - (Gamma * (eta-1.0)) )\n            \n            # Denominator of P_H(eta)\n            denominator = (2.0 - Gamma * (eta - 1.0))\n            \n            # Avoid division by zero at the pole\n            if abs(denominator) < 1e-15:\n                # As eta approaches the pole, P_H -> infinity for positive numerator\n                return np.inf if numerator > 0 else -np.inf\n            \n            p_h = p0 * ( (eta**(5/3) * (2 - Gamma*(eta-1)) + Gamma*(eta-1)) / (2 - Gamma*(eta-1)) )\n            p_h = (p0 * (2*eta**(5/3) - Gamma*(eta-1)*eta**(5/3) + Gamma*(eta-1))) / (2-Gamma*(eta-1))\n\n\n            # My original derived formula:\n            num_term1 = p0 * eta**(5/3) * (1.0 - 1.5 * Gamma)\n            num_term2 = p0 * (1.5 * Gamma * eta + 0.5 * Gamma * (eta-1))\n            numerator_alt = p0 * ( eta**(5/3) + 1.5 * Gamma*eta*(1-eta**(2/3)) + 0.5*Gamma*(eta-1) )\n            denominator_alt = 1 - 0.5*Gamma*(eta-1)\n            p_h_alt = numerator_alt/denominator_alt\n            \n            return p_h_alt - P_target\n\n        # The root eta must be in the interval (1, 1 + 2/Gamma)\n        # We give a small margin to the upper bound to stay away from the pole.\n        eta_lower_bound = 1.0\n        eta_upper_bound = (1.0 + 2.0 / Gamma) * 0.9999999999\n\n        try:\n            eta_shock = brentq(hugoniot_root_function, eta_lower_bound, eta_upper_bound, xtol=1e-15, rtol=1e-15)\n        except ValueError:\n            # Should not happen if P_target > p0, as f(1) < 0 and f(upper_bound) > 0\n            return np.nan\n\n        return eta_shock\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1: rho0, mu_e, Gamma, P_target\n        (8000.0, 2.15, 1.5, 1.0e13),\n        # Case 2: P_target is a factor of P0\n        (8000.0, 2.15, 1.5, 1.05),\n        # Case 3: Weaker degeneracy (higher mu_e)\n        (8000.0, 2.50, 1.5, 1.0e13),\n        # Case 4: Stronger thermal coupling (higher Gamma)\n        (8000.0, 2.15, 2.0, 1.0e13),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_0, mu_e, Gamma, P_target_spec = case\n        eta = calculate_compression(rho_0, mu_e, Gamma, P_target_spec)\n        results.append(eta)\n\n    # Format the output as specified\n    output_str = f\"[{','.join(f'{res:.6f}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}