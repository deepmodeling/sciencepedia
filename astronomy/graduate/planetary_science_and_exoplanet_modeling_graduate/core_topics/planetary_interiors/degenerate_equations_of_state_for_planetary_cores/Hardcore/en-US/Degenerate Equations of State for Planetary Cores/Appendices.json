{
    "hands_on_practices": [
        {
            "introduction": "The analysis of exoplanets often begins with the most fundamental data we can gather: mass and radius. This exercise provides a first-hand look at how these two parameters can offer powerful initial constraints on a planet's bulk composition. By calculating the mean density of a hypothetical super-Earth and comparing it to the known densities of planetary materials, you will explore the critical role of gravitational self-compression and discover why a simple density value is not the full story, motivating the need for a sophisticated equation of state (EOS). ",
            "id": "4173924",
            "problem": "Consider a close-in exoplanet candidate with mass $M = 5\\,M_{\\oplus}$ and radius $R = 2.5\\,R_{\\oplus}$, where $M_{\\oplus}$ and $R_{\\oplus}$ denote Earth’s mass and radius, respectively. Assume the planet is approximately spherical and that porosity is negligible. Use the following reference values: $M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$ and $R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$. \n\na) Starting directly from the definitions of mass density and the geometric volume of a sphere, derive an expression for the mean density $\\bar{\\rho}$ of the planet in terms of $M$ and $R$. Compute the value of $\\bar{\\rho}$ for the given $M$ and $R$, and express your final numerical result in $\\mathrm{g\\,cm^{-3}}$. Round your answer to four significant figures.\n\nb) Using physically justified properties of the Equation of State (EOS) for planetary materials such as silicates and iron (specifically, that the density increases with pressure for materials with finite bulk modulus), argue whether a rock-only composition is feasible for this planet. Base your reasoning on first principles and well-tested material properties without using any particular mass–radius “shortcut” formula. Your argument should consider the qualitative effect of self-compression on the mean density relative to zero-pressure densities of common rocky materials.\n\nProvide only the numerical value requested in part (a) as your final answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, self-contained, and objective. It presents a standard problem in introductory planetary science that can be solved using fundamental physical principles.\n\n**Part (a): Mean Density Calculation**\n\nThe mean density, denoted by $\\bar{\\rho}$, of a celestial body is defined as its total mass $M$ divided by its total volume $V$.\n$$\n\\bar{\\rho} = \\frac{M}{V}\n$$\nThe problem states that the planet can be approximated as a sphere. The volume of a sphere of radius $R$ is given by the geometric formula:\n$$\nV = \\frac{4}{3}\\pi R^3\n$$\nSubstituting this expression for the volume into the definition of mean density yields the desired expression for $\\bar{\\rho}$ in terms of $M$ and $R$:\n$$\n\\bar{\\rho} = \\frac{M}{\\frac{4}{3}\\pi R^3} = \\frac{3M}{4\\pi R^3}\n$$\nNow, we compute the numerical value of $\\bar{\\rho}$ using the provided data.\nThe givens are:\n- Planet mass: $M = 5\\,M_{\\oplus}$\n- Planet radius: $R = 2.5\\,R_{\\oplus}$\n- Earth mass: $M_{\\oplus} = 5.972 \\times 10^{24}\\,\\mathrm{kg}$\n- Earth radius: $R_{\\oplus} = 6.371 \\times 10^{6}\\,\\mathrm{m}$\n\nFirst, we calculate the planet's mass $M$ and radius $R$ in SI units:\n$$\nM = 5 \\times (5.972 \\times 10^{24}\\,\\mathrm{kg}) = 2.986 \\times 10^{25}\\,\\mathrm{kg}\n$$\n$$\nR = 2.5 \\times (6.371 \\times 10^{6}\\,\\mathrm{m}) = 1.59275 \\times 10^{7}\\,\\mathrm{m}\n$$\nNext, we substitute these values into the expression for the mean density:\n$$\n\\bar{\\rho} = \\frac{3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg})}{4\\pi (1.59275 \\times 10^{7}\\,\\mathrm{m})^3}\n$$\nLet's evaluate the denominator:\n$$\n(1.59275 \\times 10^{7})^3 = (1.59275)^3 \\times 10^{21} \\approx 4.040608 \\times 10^{21}\\,\\mathrm{m}^3\n$$\n$$\n4\\pi R^3 \\approx 4\\pi \\times (4.040608 \\times 10^{21}\\,\\mathrm{m}^3) \\approx 5.07758 \\times 10^{22}\\,\\mathrm{m}^3\n$$\nAnd the numerator:\n$$\n3M = 3 \\times (2.986 \\times 10^{25}\\,\\mathrm{kg}) = 8.958 \\times 10^{25}\\,\\mathrm{kg}\n$$\nNow we compute the density in $\\mathrm{kg\\,m^{-3}}$:\n$$\n\\bar{\\rho} = \\frac{8.958 \\times 10^{25}\\,\\mathrm{kg}}{5.07758 \\times 10^{22}\\,\\mathrm{m}^3} \\approx 1764.20\\,\\mathrm{kg\\,m^{-3}}\n$$\nThe problem requires the answer in units of $\\mathrm{g\\,cm^{-3}}$. We use the conversion factors:\n- $1\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $1\\,\\mathrm{m} = 100\\,\\mathrm{cm} \\implies 1\\,\\mathrm{m}^3 = (100\\,\\mathrm{cm})^3 = 10^6\\,\\mathrm{cm}^3$\nTherefore, the conversion for density is:\n$$\n1\\,\\mathrm{kg\\,m^{-3}} = \\frac{1000\\,\\mathrm{g}}{10^6\\,\\mathrm{cm}^3} = 10^{-3}\\,\\mathrm{g\\,cm^{-3}}\n$$\nApplying this conversion to our result:\n$$\n\\bar{\\rho} \\approx 1764.20 \\times 10^{-3}\\,\\mathrm{g\\,cm^{-3}} = 1.76420\\,\\mathrm{g\\,cm^{-3}}\n$$\nRounding the result to four significant figures as requested gives:\n$$\n\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n\n**Part (b): Feasibility of a Rock-Only Composition**\n\nThe feasibility of a rock-only composition can be assessed by comparing the planet's calculated mean density to the known densities of rocky materials, considering the effect of gravitational self-compression.\n\n$1$. **Zero-Pressure Densities of Materials:** A \"rock-only\" planet is primarily composed of silicates and possibly an iron core. The zero-pressure (uncompressed) densities, $\\rho_0$, of these materials are well-established:\n- Common silicate minerals (e.g., olivine, pyroxene) that form planetary mantles have $\\rho_0$ in the range of approximately $3.2 - 3.5\\,\\mathrm{g\\,cm^{-3}}$. Even crustal rocks like granite have $\\rho_0 \\approx 2.7\\,\\mathrm{g\\,cm^{-3}}$.\n- Iron, the primary constituent of planetary cores, has a zero-pressure density of $\\rho_{0, \\text{Fe}} \\approx 7.9\\,\\mathrm{g\\,cm^{-3}}$.\n\n$2$. **Effect of Self-Compression:** The planet has a mass of $M = 5\\,M_{\\oplus}$, which is substantial. Its own gravity will generate immense pressures in its interior, compressing the constituent materials. The relationship between pressure and density for a material is described by its Equation of State (EOS). A fundamental property of all materials with a finite bulk modulus $K$ (where $K = -V (\\partial P / \\partial V)_T = \\rho (\\partial P / \\partial \\rho)_T$) is that an increase in pressure $P$ leads to an increase in density $\\rho$. Since pressure increases with depth inside a planet, the local density at any point inside the planet will be greater than its zero-pressure density. Consequently, the mean density $\\bar{\\rho}$ of the planet as a whole must be greater than the mass-averaged zero-pressure density $\\bar{\\rho}_0$ of its constituent materials.\n$$ \\bar{\\rho}  \\bar{\\rho}_0 $$\n\n$3$. **Argument and Conclusion:** The calculated mean density for the exoplanet is $\\bar{\\rho} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}$. Let us assume, for the sake of argument, that the planet has a rock-only composition. The least dense plausible bulk rocky material (silicates) has a zero-pressure density of $\\rho_0 \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}$. For a planet of $5\\,M_{\\oplus}$, self-compression would significantly increase its density, so its mean density $\\bar{\\rho}$ must be strictly greater than this value. If the planet also contained an iron core, its average zero-pressure density $\\bar{\\rho}_0$ would be even higher, and thus the final compressed mean density $\\bar{\\rho}$ would be higher still.\n\nWe have the following inequality:\n$$\n\\bar{\\rho}_{\\text{calculated}} \\approx 1.764\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\bar{\\rho}_{\\text{expected for rock-only}}  \\rho_{0, \\text{rock}} \\gtrsim 2.7\\,\\mathrm{g\\,cm^{-3}}\n$$\nThere is a clear contradiction. The calculated mean density of the planet ($1.764\\,\\mathrm{g\\,cm^{-3}}$) is substantially lower than even the *uncompressed* density of the least dense plausible rocky materials. Since compression can only increase density, it is physically impossible for a planet made only of rock (and/or iron) to have such a low mean density.\n\nTherefore, a rock-only composition is **not feasible**. The planet's low density indicates that it must possess a significant fraction of low-density materials. Plausible candidates include a massive water/ice layer ($\\rho_0 \\approx 1.0\\,\\mathrm{g\\,cm^{-3}}$) or, more likely for a close-in planet, a voluminous, low-mass envelope of hydrogen and helium gas. This composition is characteristic of a \"mini-Neptune\" rather than a rocky \"super-Earth\".",
            "answer": "$$\n\\boxed{1.764}\n$$"
        },
        {
            "introduction": "Having established the importance of the pressure-density relationship, we now delve into the microscopic physics that governs it within a planetary core. This problem guides you through a first-principles derivation of the pressure in a dense, degenerate electron-ion plasma—an excellent model for the state of matter in the deep interiors of giant planets and white dwarfs. By calculating the pressure contributions from quantum mechanical exchange and correlation effects, alongside classical Coulomb interactions, you will construct the key non-ideal components of a degenerate equation of state. ",
            "id": "4157973",
            "problem": "A cold, fully degenerate, nonrelativistic, uniform electron–ion plasma representative of a massive exoplanet core is modeled as a charge-neutral mixture with electron number density $n_{e}$ and ionic number density $n_{i}=n_{e}/Z$, where $Z$ is the mean ionic charge. Assume spin-unpolarized electrons. Work in atomic units, where the Bohr radius $a_{0}$ and the Hartree energy $E_{\\mathrm{H}}$ are used to nondimensionalize lengths and energies, respectively; in these units $a_{0}=1$ and $E_{\\mathrm{H}}=1$. The electron Fermi wavevector is $k_{F}=(3\\pi^{2}n_{e})^{1/3}$ and the Wigner–Seitz radius is defined by $(4/3)\\pi r_{s}^{3}=1/n_{e}$.\n\nStarting from first principles, use the zero-temperature thermodynamic identity relating pressure $P$ to the energy density $u(n)$ of a uniform system, $P=n\\,\\frac{\\partial u}{\\partial n}-u$, together with well-tested leading-order high-density forms for the non-ideal contributions:\n- electron–electron exchange energy per electron $\\varepsilon_{x}(n_{e})=-\\frac{3}{4\\pi}k_{F}$,\n- electron–electron correlation energy per electron $\\varepsilon_{c}(r_{s})\\approx a\\,\\ln r_{s}+b$ (retain only these two leading terms),\n- ion–ion Coulomb (Madelung) energy per ion $\\varepsilon_{M}(n_{i})=-\\alpha_{M}\\,\\frac{Z^{2}}{a_{i}}$, where $a_{i}=\\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}$ and $\\alpha_{M}$ is a positive constant characteristic of the One-Component Plasma (OCP) structure.\n\nLet $P_{0}$ denote the ideal (nonrelativistic) zero-temperature electron Fermi pressure. Derive, to leading order in small $r_{s}$, the combined fractional pressure correction\n$$\nf \\equiv \\frac{\\Delta P}{P_{0}} = \\frac{P_{x}+P_{c}+P_{M}}{P_{0}},\n$$\nwhere $P_{x}$, $P_{c}$, and $P_{M}$ are the exchange, correlation, and Madelung pressure contributions, respectively. Express your final answer as a single closed-form analytic expression $f(r_{s},Z,\\alpha_{M},a)$, entirely in atomic units and in terms of $r_{s}$, $Z$, $\\alpha_{M}$, $a$, and $\\pi$. No numerical evaluation is required, and the final answer should be dimensionless. Do not include units in your final expression.",
            "solution": "The user wants me to act as a meticulous STEM professor and solve a physics problem related to the equation of state of a degenerate plasma.\n\nHere's my plan:\n1.  **Validate the problem statement.**\n    -   **Step 1: Extract Givens.** I will list all the given quantities, definitions, and equations verbatim.\n    -   **Step 2: Validate.** I will check the problem against the criteria: Scientific Grounding, Well-Posedness, Objectivity, etc.\n        -   The problem deals with a degenerate electron-ion plasma, a standard model in condensed matter and astrophysics.\n        -   The concepts of Fermi gas, exchange energy, correlation energy, and Madelung energy are standard.\n        -   The expressions provided are well-known leading-order forms in their respective limits (high density for exchange and correlation, crystal/liquid structure for Madelung).\n        -   The thermodynamic identity for pressure is a fundamental result.\n        -   The problem asks for a derivation of a fractional pressure correction, which is a standard calculation in this field.\n        -   All terms are defined ($n_e, n_i, Z, k_F, r_s, a_i, \\epsilon_x, \\epsilon_c, \\epsilon_M$).\n        -   The request is to find an analytical expression in terms of given parameters.\n        -   The problem seems self-contained, scientifically sound, and well-posed. There are no contradictions or missing pieces of information needed for the derivation.\n    -   **Step 3: Verdict and Action.** The problem appears to be valid. I will proceed with the solution.\n\n2.  **Solve the problem.**\n    -   **Goal:** Derive the fractional pressure correction $f = (P_x + P_c + P_M) / P_0$.\n    -   **Strategy:**\n        1.  Relate all quantities to a single density variable, preferably $r_s$, since the final answer is requested in terms of $r_s$.\n        2.  For each energy component (ideal Fermi gas, exchange, correlation, Madelung), calculate the corresponding pressure using the given thermodynamic identity: $P = n \\frac{\\partial u}{\\partial n} - u$. Note that $u$ is the energy *density*, while the problem gives energies *per particle* ($\\epsilon$). The relation is $u = n \\epsilon$.\n        3.  So, $P = n \\frac{\\partial (n\\epsilon)}{\\partial n} - n\\epsilon = n ( \\epsilon + n \\frac{\\partial \\epsilon}{\\partial n}) - n\\epsilon = n^2 \\frac{\\partial \\epsilon}{\\partial n}$.\n        4.  I need to express the derivative $\\frac{\\partial}{\\partial n}$ in terms of $\\frac{\\partial}{\\partial r_s}$. From $(4/3)\\pi r_s^3 = 1/n$, we have $n = \\frac{3}{4\\pi r_s^3}$.\n        5.  Thus, $\\frac{\\partial n}{\\partial r_s} = \\frac{3}{4\\pi} (-3 r_s^{-4}) = -\\frac{9}{4\\pi r_s^4} = -3 \\frac{n}{r_s}$.\n        6.  The chain rule gives $\\frac{\\partial \\epsilon}{\\partial n} = \\frac{\\partial \\epsilon}{\\partial r_s} \\frac{\\partial r_s}{\\partial n} = \\frac{\\partial \\epsilon}{\\partial r_s} (-\\frac{r_s}{3n})$.\n        7.  Substituting this into the pressure formula: $P = n^2 \\frac{\\partial \\epsilon}{\\partial n} = n^2 \\left( \\frac{\\partial \\epsilon}{\\partial r_s} \\left(-\\frac{r_s}{3n}\\right) \\right) = -\\frac{n r_s}{3} \\frac{\\partial \\epsilon}{\\partial r_s}$. This is a key formula I will use for each component.\n\n    -   **Step-by-step Calculation:**\n\n        **a) Ideal Fermi Gas Pressure ($P_0$)**\n        -   The ideal Fermi gas energy per electron is $\\epsilon_0 = \\frac{3}{5} E_F$, where $E_F = \\frac{k_F^2}{2m_e}$. In atomic units, $m_e = 1/2$ is incorrect, energy is in Hartree, mass is electron mass ($m_e=1$). So $E_F = \\frac{k_F^2}{2}$.\n        -   $k_F = (3\\pi^2 n_e)^{1/3}$.\n        -   $n_e = \\frac{3}{4\\pi r_s^3}$.\n        -   $k_F = (3\\pi^2 \\frac{3}{4\\pi r_s^3})^{1/3} = (\\frac{9\\pi}{4})^{1/3} \\frac{1}{r_s}$.\n        -   $\\epsilon_0 = \\frac{3}{5} \\frac{k_F^2}{2} = \\frac{3}{10} k_F^2 = \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3} \\frac{1}{r_s^2}$. Let's call $C_0 = \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3}$. So $\\epsilon_0 = C_0 r_s^{-2}$.\n        -   Now, calculate $P_0$ using my derived pressure formula: $P_0 = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_0}{\\partial r_s}$.\n        -   $\\frac{\\partial \\epsilon_0}{\\partial r_s} = C_0 (-2 r_s^{-3})$.\n        -   $P_0 = -\\frac{n_e r_s}{3} (-2 C_0 r_s^{-3}) = \\frac{2}{3} n_e C_0 r_s^{-2} = \\frac{2}{3} (\\frac{3}{4\\pi r_s^3}) (C_0 r_s^{-2}) = \\frac{C_0}{2\\pi r_s^5}$.\n        -   Let's substitute $C_0$: $P_0 = \\frac{1}{2\\pi r_s^5} \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3} = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$.\n        -   Let's check this with the standard formula $P_0 = \\frac{2}{5} n_e E_F$.\n        -   $P_0 = \\frac{2}{5} n_e (\\frac{k_F^2}{2}) = \\frac{1}{5} n_e k_F^2 = \\frac{1}{5} (\\frac{3}{4\\pi r_s^3}) ((\\frac{9\\pi}{4})^{1/3} \\frac{1}{r_s})^2 = \\frac{3}{20\\pi r_s^3} (\\frac{9\\pi}{4})^{2/3} \\frac{1}{r_s^2} = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$. This matches. Good.\n\n        **b) Exchange Pressure ($P_x$)**\n        -   Energy per electron: $\\epsilon_x = -\\frac{3}{4\\pi} k_F$.\n        -   Using $k_F = (\\frac{9\\pi}{4})^{1/3} r_s^{-1}$, we get $\\epsilon_x = -\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3} r_s^{-1}$. Let's call $C_x = -\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3}$. So $\\epsilon_x = C_x r_s^{-1}$.\n        -   Calculate $P_x$ using the formula: $P_x = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_x}{\\partial r_s}$. Note that this applies because $P_x = n_e^2 \\frac{\\partial \\epsilon_x}{\\partial n_e}$.\n        -   $\\frac{\\partial \\epsilon_x}{\\partial r_s} = C_x (-1 r_s^{-2}) = -C_x r_s^{-2}$.\n        -   $P_x = -\\frac{n_e r_s}{3} (-C_x r_s^{-2}) = \\frac{1}{3} n_e C_x r_s^{-1} = \\frac{1}{3} (\\frac{3}{4\\pi r_s^3}) (C_x r_s^{-1}) = \\frac{C_x}{4\\pi r_s^4}$.\n        -   Substitute $C_x$: $P_x = \\frac{1}{4\\pi r_s^4} (-\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3}) = -\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}$.\n        -   The pressure is $1/3$ of the energy density for a photon gas ($u \\propto T^4, P=u/3$), but for exchange energy, $u_x = n_e \\epsilon_x \\propto n_e \\cdot n_e^{1/3} = n_e^{4/3}$. Then $P_x=n_e \\frac{\\partial u_x}{\\partial n_e} - u_x = n_e (\\frac{4}{3} n_e^{1/3}) - n_e^{4/3} = \\frac{1}{3} u_x$. Let's check my calculation.\n        -   $P_x = \\frac{1}{3} u_x = \\frac{1}{3} n_e \\epsilon_x = \\frac{1}{3} (\\frac{3}{4\\pi r_s^3}) C_x r_s^{-1} = \\frac{C_x}{4\\pi r_s^4}$. This matches.\n\n        **c) Correlation Pressure ($P_c$)**\n        -   Energy per electron: $\\epsilon_c \\approx a \\ln r_s + b$. The problem says \"retain only these two leading terms\". This is the high-density limit ($r_s \\to 0$).\n        -   Calculate $P_c$: $P_c = -\\frac{n_e r_s}{3} \\frac{\\partial \\epsilon_c}{\\partial r_s}$.\n        -   $\\frac{\\partial \\epsilon_c}{\\partial r_s} = \\frac{a}{r_s}$.\n        -   $P_c = -\\frac{n_e r_s}{3} (\\frac{a}{r_s}) = -\\frac{a n_e}{3} = -\\frac{a}{3} (\\frac{3}{4\\pi r_s^3}) = -\\frac{a}{4\\pi r_s^3}$.\n        -   Let's check this with $P_c = n_e^2 \\frac{\\partial \\epsilon_c}{\\partial n_e}$.\n        -   $\\epsilon_c = a \\ln r_s + b$. We have $r_s = (\\frac{3}{4\\pi n_e})^{1/3}$.\n        -   $\\ln r_s = \\frac{1}{3} \\ln(\\frac{3}{4\\pi n_e}) = \\frac{1}{3} (\\ln(\\frac{3}{4\\pi}) - \\ln n_e) = -\\frac{1}{3} \\ln n_e + \\text{const}$.\n        -   So $\\epsilon_c = -\\frac{a}{3} \\ln n_e + \\text{const'} $.\n        -   $\\frac{\\partial \\epsilon_c}{\\partial n_e} = -\\frac{a}{3 n_e}$.\n        -   $P_c = n_e^2 (-\\frac{a}{3 n_e}) = -\\frac{a n_e}{3}$. This matches.\n\n        **d) Madelung (Ion-Ion) Pressure ($P_M$)**\n        -   This part requires careful handling. The energy is given per *ion*, $\\epsilon_M(n_i)$, and is a function of the *ion* number density $n_i$. The pressure formula $P=n^2 \\frac{\\partial \\epsilon}{\\partial n}$ applies to a single component. Here we have a multi-component system.\n        -   The total energy density is $u_{total} = u_{e,kin} + u_{e-e} + u_{ion-ion} + u_{e-ion}$. The problem gives $u_{e-e} = n_e(\\epsilon_x + \\epsilon_c)$ and $u_{ion-ion} = n_i \\epsilon_M$. The electron-ion energy is implicitly part of the Madelung term. The Madelung energy $\\epsilon_M$ is the electrostatic energy of ions in a uniform neutralizing background of electrons. It thus includes the ion-ion, ion-background, and background self-energy. The total electrostatic energy of the system is what's given by $U_{Madelung} = N_i \\epsilon_M$.\n        -   The total energy density is $u = n_e \\epsilon_0 + n_e \\epsilon_x + n_e \\epsilon_c + n_i \\epsilon_M$.\n        -   The total pressure is $P = n_e \\frac{\\partial u}{\\partial n_e} - u$ (since $n_i = n_e/Z$, $n_e$ is the independent density variable).\n        -   $P = P_0 + P_x + P_c + P_M$. We need to find $P_M$.\n        -   Let $u_M = n_i \\epsilon_M(n_i) = \\frac{n_e}{Z} \\epsilon_M(n_i)$.\n        -   $P_M = n_e \\frac{\\partial u_M}{\\partial n_e} - u_M = n_e \\frac{\\partial}{\\partial n_e}(\\frac{n_e}{Z} \\epsilon_M) - \\frac{n_e}{Z} \\epsilon_M$.\n        -   $P_M = \\frac{n_e}{Z} \\epsilon_M + \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e} - \\frac{n_e}{Z} \\epsilon_M = \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e}$.\n        -   We need $\\frac{\\partial \\epsilon_M}{\\partial n_e}$. The energy is given as function of $n_i$: $\\epsilon_M(n_i) = -\\alpha_M \\frac{Z^2}{a_i}$ where $a_i = (\\frac{3}{4\\pi n_i})^{1/3}$.\n        -   Let's express $\\epsilon_M$ in terms of $n_e$. $n_i = n_e/Z$.\n        -   $a_i = (\\frac{3Z}{4\\pi n_e})^{1/3} = Z^{1/3} (\\frac{3}{4\\pi n_e})^{1/3} = Z^{1/3} r_s$.\n        -   So, $\\epsilon_M = -\\alpha_M \\frac{Z^2}{Z^{1/3} r_s} = -\\alpha_M Z^{5/3} r_s^{-1}$.\n        -   Now we can use the general pressure formula $P_M = -\\frac{(Total Number Density) \\times r_s}{3} \\frac{\\partial(\\text{Energy per electron})}{\\partial r_s}$. This might be tricky. Let's stick to the $n_e$ derivative.\n        -   Let's re-express $\\epsilon_M$ in terms of $n_e$. $\\epsilon_M = -\\alpha_M Z^2 (\\frac{4\\pi n_i}{3})^{1/3} = -\\alpha_M Z^2 (\\frac{4\\pi n_e}{3Z})^{1/3} = -\\alpha_M Z^2 Z^{-1/3} (\\frac{4\\pi n_e}{3})^{1/3} = -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} n_e^{1/3}$.\n        -   Now calculate $\\frac{\\partial \\epsilon_M}{\\partial n_e}$: $\\frac{\\partial \\epsilon_M}{\\partial n_e} = -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} \\frac{1}{3} n_e^{-2/3} = \\frac{1}{3 n_e} \\left( -\\alpha_M Z^{5/3} (\\frac{4\\pi}{3})^{1/3} n_e^{1/3} \\right) = \\frac{\\epsilon_M}{3 n_e}$.\n        -   So, $P_M = \\frac{n_e^2}{Z} \\frac{\\partial \\epsilon_M}{\\partial n_e} = \\frac{n_e^2}{Z} \\frac{\\epsilon_M}{3 n_e} = \\frac{n_e \\epsilon_M}{3Z}$.\n        -   Let's check this. The total Madelung energy density is $u_M = n_i \\epsilon_M = (n_e/Z) \\epsilon_M$.\n        -   From $\\epsilon_M \\propto n_e^{1/3}$, we get $u_M \\propto (n_e/Z) n_e^{1/3} = (1/Z) n_e^{4/3}$.\n        -   $P_M = n_e \\frac{\\partial u_M}{\\partial n_e} - u_M = n_e (\\frac{1}{Z} \\frac{4}{3} n_e^{1/3}) - \\frac{1}{Z} n_e^{4/3} = \\frac{4}{3} \\frac{n_e^{4/3}}{Z} - \\frac{n_e^{4/3}}{Z} = \\frac{1}{3} \\frac{n_e^{4/3}}{Z} = \\frac{1}{3} u_M$.\n        -   So $P_M = \\frac{1}{3} u_M = \\frac{1}{3} n_i \\epsilon_M = \\frac{n_e \\epsilon_M}{3Z}$. The derivation is correct.\n        -   Now, let's express $P_M$ in terms of $r_s$.\n        -   $P_M = \\frac{n_e}{3Z} \\epsilon_M = \\frac{1}{3Z} (\\frac{3}{4\\pi r_s^3}) (-\\alpha_M Z^{5/3} r_s^{-1}) = -\\frac{3 \\alpha_M Z^{5/3}}{12 \\pi Z r_s^4} = -\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}$.\n\n        **e) Assemble the Fractional Correction**\n        -   We need $f = \\frac{P_x + P_c + P_M}{P_0}$. The problem asks for the leading order in small $r_s$. This means we need to compare the powers of $r_s$ in the numerator and denominator.\n        -   $P_0 \\propto r_s^{-5}$\n        -   $P_x \\propto r_s^{-4}$\n        -   $P_c \\propto r_s^{-3}$\n        -   $P_M \\propto r_s^{-4}$\n\n        -   The ratio $\\Delta P / P_0$ will have terms proportional to:\n            -   $P_x/P_0 \\propto r_s^{-4} / r_s^{-5} = r_s^1$\n            -   $P_c/P_0 \\propto r_s^{-3} / r_s^{-5} = r_s^2$\n            -   $P_M/P_0 \\propto r_s^{-4} / r_s^{-5} = r_s^1$\n\n        -   The problem states \"to leading order in small $r_s$\". This is interpreted as using the leading-order expressions for the component energies as given, and calculating the corresponding pressure contributions without further approximation. We sum these contributions.\n\n        -   **Let's compute the ratios:**\n            -   **$P_x / P_0$**:\n                $P_x = -\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}$\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$\n                $\\frac{P_x}{P_0} = \\frac{-\\frac{3}{16\\pi^2} (\\frac{9\\pi}{4})^{1/3} r_s^{-4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{3}{16\\pi^2} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-1/3} r_s$\n                $= -\\frac{5}{4\\pi} (\\frac{4}{9\\pi})^{1/3} r_s$.\n\n            -   **$P_M / P_0$**:\n                $P_M = -\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}$.\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$.\n                $\\frac{P_M}{P_0} = \\frac{-\\frac{\\alpha_M Z^{2/3}}{4\\pi r_s^4}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{\\alpha_M Z^{2/3}}{4\\pi} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-2/3} r_s$\n                $= -\\frac{5 \\alpha_M Z^{2/3}}{3} (\\frac{4}{9\\pi})^{2/3} r_s$.\n\n            -   **$P_c / P_0$**:\n                $P_c = -\\frac{a}{4\\pi r_s^3}$.\n                $P_0 = \\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}$.\n                $\\frac{P_c}{P_0} = \\frac{-\\frac{a}{4\\pi r_s^3}}{\\frac{3}{20\\pi} (\\frac{9\\pi}{4})^{2/3} r_s^{-5}} = -\\frac{a}{4\\pi} \\frac{20\\pi}{3} (\\frac{9\\pi}{4})^{-2/3} r_s^2$\n                $= -\\frac{5a}{3} (\\frac{4}{9\\pi})^{2/3} r_s^2$.\n\n        -   **Combine the terms for $f$**:\n        The combined fractional pressure correction $f$ is the sum of these three contributions.\n        $f(r_s, Z, \\alpha_M, a) = \\frac{P_x}{P_0} + \\frac{P_M}{P_0} + \\frac{P_c}{P_0}$\n        $$ f(r_s, Z, \\alpha_M, a) = -\\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} r_s - \\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\n        This expression can be rearranged by factoring out common terms. Factoring out the $r_s$ terms yields:\n        $$ f(r_s, Z, \\alpha_M, a) = - \\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_M Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_s - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_s^2 $$\n        This is the final closed-form analytic expression required.",
            "answer": "$$ \\boxed{ - \\left[ \\frac{5}{4\\pi} \\left(\\frac{4}{9\\pi}\\right)^{1/3} + \\frac{5 \\alpha_{M} Z^{2/3}}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} \\right] r_{s} - \\frac{5a}{3} \\left(\\frac{4}{9\\pi}\\right)^{2/3} r_{s}^2 } $$"
        },
        {
            "introduction": "This final practice bridges the gap between fundamental theory and practical application by tasking you with a computational challenge. You will implement the degenerate electron gas equation of state as a \"cold curve\" within a broader thermodynamic framework used to model dynamic processes like planetary collisions. By solving the Rankine-Hugoniot equations for a shock wave, you will simulate how a material responds to extreme compression, demonstrating how the theoretical EOS developed in the previous exercise serves as a critical input for modeling complex and violent events in planetary science. ",
            "id": "4157975",
            "problem": "You are to write a complete, runnable program that computes shock-compressed states on the principal Hugoniot for a simplified planetary-core material whose equation of state includes a zero-temperature degenerate electron contribution. The goal is to compute the compression ratio for specified initial and shocked states by solving the Rankine–Hugoniot relations coupled with a Mie–Grüneisen closure anchored to a degenerate-electron cold curve. All quantities must be handled in the International System of Units (SI), with density in kilograms per cubic meter and pressure in Pascals.\n\nStart from the following foundational definitions and laws:\n\n1. Mass conservation across a shock gives the relation between upstream and downstream specific volumes, and energy conservation across a planar steady shock yields the Rankine–Hugoniot energy condition,\n   $$E - E_0 = \\frac{1}{2}\\,(P + P_0)\\,(V_0 - V),$$\n   where $E$ and $E_0$ are the specific internal energies (in joules per kilogram), $P$ and $P_0$ are the pressures (in Pascals), and $V$ and $V_0$ are the specific volumes (in cubic meters per kilogram) with $V = 1/\\rho$ and $V_0 = 1/\\rho_0$ for mass densities $\\rho$ and $\\rho_0$.\n\n2. The Mie–Grüneisen form (with a constant Grüneisen parameter) relates pressure to a cold curve and thermal energy as\n   $$P(\\rho, E) = P_{\\text{cold}}(\\rho) + \\Gamma\\,\\rho\\,[E - E_{\\text{cold}}(\\rho)],$$\n   where $\\Gamma$ is a dimensionless constant and $P_{\\text{cold}}(\\rho)$ and $E_{\\text{cold}}(\\rho)$ are the zero-temperature pressure and specific internal energy, respectively.\n\n3. Model the cold curve as the nonrelativistic, zero-temperature, fully degenerate electron gas for a composition characterized by the electron molecular weight $\\mu_e$ (electrons per baryon), with\n   $$n_e = \\frac{\\rho}{\\mu_e\\,m_u},$$\n   $$P_{\\text{cold}}(\\rho) = \\frac{\\hbar^2}{5 m_e}\\,(3\\pi^2)^{2/3}\\,n_e^{5/3},$$\n   $$u_{\\text{cold}}(\\rho) = \\frac{3}{5}\\,n_e\\,E_F, \\quad E_F = \\frac{\\hbar^2}{2 m_e}\\,(3\\pi^2\\,n_e)^{2/3}, \\quad E_{\\text{cold}}(\\rho) = \\frac{u_{\\text{cold}}(\\rho)}{\\rho},$$\n   equivalently yielding $u_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)$ and $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\,P_{\\text{cold}}(\\rho)/\\rho$. Here $\\hbar$ is the reduced Planck constant, $m_e$ is the electron mass, $m_u$ is the atomic mass unit, and $n_e$ is the electron number density. All constants must be used in SI units.\n\n4. Principal Hugoniot initial state: take the upstream (initial) state on the cold curve at density $\\rho_0$ so that $E_0 = E_{\\text{cold}}(\\rho_0)$ and $P_0 = P_{\\text{cold}}(\\rho_0)$.\n\nYour task is to implement a solver that, for a specified target shocked pressure $P$ and parameters $(\\rho_0,\\mu_e,\\Gamma)$, determines the shocked density $\\rho$ that satisfies the Rankine–Hugoniot relation together with the Mie–Grüneisen closure and the degenerate cold curve. From this density, report the compression ratio\n$$\\eta = \\frac{\\rho}{\\rho_0}.$$\n\nThe problem requires you to:\n- Derive a single nonlinear equation for the unknown shocked density $\\rho$ by eliminating the shocked specific internal energy $E$ using the Rankine–Hugoniot energy relation, while keeping all definitions above explicit in your code.\n- Solve this equation robustly for $\\rho \\ge \\rho_0$.\n- Compute and return the compression ratio $\\eta$.\n\nPhysical constants must be taken as:\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$,\n- Electron mass $m_e = 9.10938356\\times 10^{-31}\\,\\text{kg}$,\n- Atomic mass unit $m_u = 1.66053906660\\times 10^{-27}\\,\\text{kg}$.\n\nTest Suite:\nImplement your program to compute $\\eta$ for the following parameter sets. In all cases, the initial state is on the cold curve, so $P_0$ and $E_0$ must be computed from the formulas above using the given $\\rho_0$ and $\\mu_e$.\n\n- Case 1 (happy path, high pressure): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.15$, $\\Gamma = 1.5$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n- Case 2 (near-threshold compression): same $\\rho_0$, $\\mu_e$, and $\\Gamma$ as Case 1, but target shocked pressure $P = 1.05\\,P_0$, where $P_0 = P_{\\text{cold}}(\\rho_0)$ must be computed from the cold curve.\n- Case 3 (weaker degeneracy): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.50$, $\\Gamma = 1.5$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n- Case 4 (stronger thermal coupling): $\\rho_0 = 8000\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu_e = 2.15$, $\\Gamma = 2.0$, target shocked pressure $P = 1.0\\times 10^{13}\\,\\text{Pa}$.\n\nOutput Requirements:\n- For each case, output the compression ratio $\\eta$ as a floating-point number rounded to six decimal places.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, \"[1.234567,1.000123, ...]\".\n- No other output is permitted.\n\nAll numerical answers for $\\eta$ are dimensionless floats. Angles are not used in this problem. Ensure all internal computations use SI units consistently. Robustness must be ensured for the near-threshold case where $P$ is only slightly greater than $P_0$.",
            "solution": "The user wants to solve for the compression ratio $\\eta = \\rho/\\rho_0$ on the a shock wave's principal Hugoniot. This involves coupling the Rankine-Hugoniot conservation laws with a specified equation of state for a planetary-core material.\n\nThe problem is to find the final density $\\rho$ (and thus the compression $\\eta$) for a given final pressure $P$, starting from an initial state $(\\rho_0, P_0, E_0)$. The initial state is on the cold curve, meaning $P_0 = P_{\\text{cold}}(\\rho_0)$ and $E_0 = E_{\\text{cold}}(\\rho_0)$.\n\nFirst, we establish the governing equations. The shocked state $(\\rho, P, E)$ and initial state $(\\rho_0, P_0, E_0)$ are linked by two primary relations for the specific internal energy $E$.\n\n1.  The Rankine-Hugoniot energy conservation relation:\n    $$E = E_0 + \\frac{1}{2}(P + P_0)(V_0 - V)$$\n    where $V=1/\\rho$ and $V_0=1/\\rho_0$ are the specific volumes. Substituting for $V$ and $V_0$ gives:\n    $$E = E_0 + \\frac{1}{2}(P + P_0)\\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right)$$\n\n2.  The Mie-Grüneisen equation of state, which relates pressure, density, and energy, can be rearranged to solve for $E$:\n    $$P = P_{\\text{cold}}(\\rho) + \\Gamma \\rho [E - E_{\\text{cold}}(\\rho)]$$\n    $$E = E_{\\text{cold}}(\\rho) + \\frac{P - P_{\\text{cold}}(\\rho)}{\\Gamma \\rho}$$\n\nBy equating these two expressions for $E$, we obtain a single equation that defines the Hugoniot, the locus of all possible shocked states from the given initial state:\n$$E_0 + \\frac{1}{2}(P + P_0)\\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right) = E_{\\text{cold}}(\\rho) + \\frac{P - P_{\\text{cold}}(\\rho)}{\\Gamma \\rho}$$\nHere, the pressure $P$ and density $\\rho$ are the variables defining the final state on the Hugoniot. The task is to find the value of $\\rho$ that satisfies this equation for a given target pressure $P$.\n\nA more robust numerical approach is to rearrange this implicit relation to find an explicit expression for the Hugoniot pressure, $P_H(\\rho)$, as a function of density $\\rho$. We solve for $P$:\n$$P\\left(1 - \\frac{\\Gamma\\rho}{2}\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)\\right) = P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{\\Gamma\\rho}{2}P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)$$\nThis yields the Hugoniot pressure function:\n$$P_H(\\rho) = \\frac{P_{\\text{cold}}(\\rho) + \\Gamma\\rho \\left( E_0 - E_{\\text{cold}}(\\rho) \\right) + \\frac{1}{2}\\Gamma\\rho P_0\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}{1 - \\frac{1}{2}\\Gamma\\rho\\left(\\frac{1}{\\rho_0}-\\frac{1}{\\rho}\\right)}$$\nThe problem then becomes finding the root of the equation $F(\\rho) = P_H(\\rho) - P = 0$.\n\nFor implementation, it is convenient to work with the dimensionless compression ratio $\\eta = \\rho/\\rho_0$. We use the provided cold curve relations:\n-   $P_{\\text{cold}}(\\rho) = C\\rho^{5/3}$, which implies $P_{\\text{cold}}(\\eta\\rho_0) = C(\\eta\\rho_0)^{5/3} = (C\\rho_0^{5/3})\\eta^{5/3} = P_0\\eta^{5/3}$.\n-   $E_{\\text{cold}}(\\rho) = \\frac{3}{2}\\frac{P_{\\text{cold}}(\\rho)}{\\rho}$, which implies $E_{\\text{cold}}(\\eta\\rho_0) = \\frac{3}{2}\\frac{P_0\\eta^{5/3}}{\\eta\\rho_0} = \\left(\\frac{3}{2}\\frac{P_0}{\\rho_0}\\right)\\eta^{2/3} = E_0\\eta^{2/3}$.\n\nSubstituting these into the expression for $P_H(\\rho)$ and simplifying gives the Hugoniot pressure as a function of $\\eta$:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta\\rho_0 \\left( E_0 - E_0\\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma\\eta P_0\\left(1 - \\frac{1}{\\eta}\\right)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\nUsing $E_0 = \\frac{3}{2}\\frac{P_0}{\\rho_0}$:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3} + \\Gamma\\eta P_0 \\frac{3}{2} \\left( 1 - \\eta^{2/3} \\right) + \\frac{1}{2}\\Gamma P_0(\\eta-1)}{1 - \\frac{1}{2}\\Gamma(\\eta-1)}$$\nAfter algebraic simplification, a cleaner form is:\n$$P_H(\\eta) = \\frac{P_0\\eta^{5/3}(1 - \\frac{3\\Gamma}{2}) + P_0(2\\Gamma\\eta - \\frac{\\Gamma}{2})}{\\frac{2+\\Gamma}{2} - \\frac{\\Gamma\\eta}{2}}$$\nWe must solve the nonlinear equation $F(\\eta) = P_H(\\eta) - P = 0$ for the unknown $\\eta$.\n\nThe physical domain for a compressive shock is $\\eta  1$. The denominator of $P_H(\\eta)$ becomes zero when $\\eta = \\frac{2+\\Gamma}{\\Gamma} = 1 + \\frac{2}{\\Gamma}$. This value represents the theoretical maximum compression in the strong shock limit. The function $P_H(\\eta)$ is monotonic for $\\eta \\in [1, 1+2/\\Gamma)$. At $\\eta=1$, $P_H(1) = P_0$. As $\\eta$ approaches the pole $1+2/\\Gamma$ from below, $P_H(\\eta)$ tends to $+\\infty$.\nTherefore, for any target pressure $P  P_0$, a unique solution for $\\eta$ exists in the interval $(1, 1+2/\\Gamma)$. We can employ a robust numerical root-finding method, such as Brent's method, on the function $F(\\eta)$ within this bounded interval to find the shocked compression $\\eta$.\n\nThe algorithm is as follows:\n1.  Define the physical constants $\\hbar$, $m_e$, $m_u$.\n2.  Implement a function for the cold pressure, $P_{\\text{cold}}(\\rho, \\mu_e) = \\frac{\\hbar^2}{5 m_e}(3\\pi^2)^{2/3}\\left(\\frac{\\rho}{\\mu_e m_u}\\right)^{5/3}$.\n3.  For each test case with parameters $(\\rho_0, \\mu_e, \\Gamma, P)$:\n    a. Calculate the initial pressure $P_0 = P_{\\text{cold}}(\\rho_0, \\mu_e)$.\n    b. If the target pressure $P$ is given as a factor of $P_0$, compute its absolute value.\n    c. Define the root function $F(\\eta) = P_H(\\eta) - P$ using the derived expression for $P_H(\\eta)$.\n    d. Use `scipy.optimize.brentq` to find the root $\\eta$ of $F(\\eta)$ in the interval $[1, 1+2/\\Gamma]$. A small margin is used for the upper bound to avoid the pole, e.g., $[1.0, (1+2/\\Gamma) \\times 0.999999]$.\n    e. Store the resulting compression ratio $\\eta$.\n4.  Format and print the collected results.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes shock-compressed states on the principal Hugoniot for a simplified\n    planetary-core material.\n    \"\"\"\n\n    # Physical constants in SI units\n    H_BAR = 1.054571817e-34  # J.s\n    M_E = 9.10938356e-31      # kg\n    M_U = 1.66053906660e-27  # kg\n\n    # Pre-compute parts of the cold pressure constant\n    P_COLD_CONST_A = (H_BAR**2 / (5 * M_E)) * (3 * np.pi**2)**(2/3)\n\n    def p_cold(rho, mu_e):\n        \"\"\"\n        Calculates the zero-temperature degenerate electron gas pressure.\n        \n        Args:\n            rho (float): Mass density (kg/m^3).\n            mu_e (float): Electron molecular weight (electrons per baryon).\n        \n        Returns:\n            float: Cold pressure (Pa).\n        \"\"\"\n        if rho = 0:\n            return 0.0\n        p_cold_const_b = 1.0 / (mu_e * M_U)\n        n_e = rho * p_cold_const_b  # electron number density\n        return P_COLD_CONST_A * n_e**(5/3)\n\n    def calculate_compression(rho_0, mu_e, Gamma, P_target_spec):\n        \"\"\"\n        Calculates the shock compression ratio eta for a given set of parameters.\n        \n        Args:\n            rho_0 (float): Initial density (kg/m^3).\n            mu_e (float): Electron molecular weight.\n            Gamma (float): Grüneisen parameter.\n            P_target_spec (float): Target pressure (Pa) or a factor of P_0.\n            \n        Returns:\n            float: Compression ratio eta = rho / rho_0.\n        \"\"\"\n        # Calculate initial state on the cold curve\n        p0 = p_cold(rho_0, mu_e)\n        \n        # Determine absolute target pressure\n        if P_target_spec  100:  # Heuristic to identify a factor vs absolute pressure\n            P_target = P_target_spec * p0\n        else:\n            P_target = P_target_spec\n            \n        # A physical shock requires P  P0. If P=P0, eta=1 (no compression).\n        if P_target = p0:\n            return 1.0\n\n        def hugoniot_root_function(eta):\n            \"\"\"\n            Function F(eta) = P_H(eta) - P_target, whose root we seek.\n            P_H(eta) is the Hugoniot pressure as a function of compression eta.\n            \"\"\"\n            \n            # This is the P_H(eta) derived in the solution text\n            numerator = p0 * (eta**(5/3) + 1.5 * Gamma * eta * (1 - eta**(2/3)) + 0.5 * Gamma * (eta - 1))\n            denominator = 1 - 0.5 * Gamma * (eta - 1)\n            \n            # Avoid division by zero at the pole\n            if abs(denominator)  1e-15:\n                # As eta approaches the pole, P_H -> infinity for positive numerator\n                return np.inf if numerator  0 else -np.inf\n            \n            p_h = numerator / denominator\n            \n            return p_h - P_target\n\n        # The root eta must be in the interval (1, 1 + 2/Gamma)\n        # We give a small margin to the upper bound to stay away from the pole.\n        eta_lower_bound = 1.0\n        eta_upper_bound = (1.0 + 2.0 / Gamma) * 0.9999999999\n\n        try:\n            eta_shock = brentq(hugoniot_root_function, eta_lower_bound, eta_upper_bound, xtol=1e-15, rtol=1e-15)\n        except ValueError:\n            # Should not happen if P_target  p0, as f(1)  0 and f(upper_bound)  0\n            return np.nan\n\n        return eta_shock\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1: rho0, mu_e, Gamma, P_target\n        (8000.0, 2.15, 1.5, 1.0e13),\n        # Case 2: P_target is a factor of P0\n        (8000.0, 2.15, 1.5, 1.05),\n        # Case 3: Weaker degeneracy (higher mu_e)\n        (8000.0, 2.50, 1.5, 1.0e13),\n        # Case 4: Stronger thermal coupling (higher Gamma)\n        (8000.0, 2.15, 2.0, 1.0e13),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_0, mu_e, Gamma, P_target_spec = case\n        eta = calculate_compression(rho_0, mu_e, Gamma, P_target_spec)\n        results.append(eta)\n\n    # Format the output as specified\n    output_str = f\"[{','.join(f'{res:.6f}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}