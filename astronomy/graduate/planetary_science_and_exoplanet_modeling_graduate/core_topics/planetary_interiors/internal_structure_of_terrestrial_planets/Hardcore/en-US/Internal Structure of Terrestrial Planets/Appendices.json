{
    "hands_on_practices": [
        {
            "introduction": "The rigid lithosphere acts as a thermal boundary layer for a planet, controlling the rate of heat loss from the interior. Understanding how thermal disturbances within this layer evolve is key to interpreting surface heat flow measurements and a planet's thermal history. This exercise guides you through a fundamental derivation of the thermal diffusion timescale, showing how the lithosphere's thickness and thermal properties dictate how quickly it can respond to changes in temperature, such as those from mantle plumes or tectonic events.",
            "id": "4165553",
            "problem": "A stagnant-lid terrestrial planet can be idealized as a plane-parallel lithospheric slab of thickness $\\delta$ with constant thermal diffusivity $\\kappa$, overlying a vigorously convecting mantle that maintains an effectively constant basal temperature. The planetary surface is radiatively cooled at a nearly constant temperature. Assume one-dimensional vertical heat transport and small-amplitude thermal perturbations to a steady linear geotherm. Starting only from energy conservation with Fourier’s law and the one-dimensional diffusion equation, derive the e-folding timescale that controls the slowest decaying mode of thermal perturbations in the slab and thus the relaxation of surface heat-flow anomalies. Explicitly relate this timescale to $\\delta$ and $\\kappa$ by solving the eigenvalue problem implied by fixed-temperature boundary conditions at the surface and at the base of the lithosphere.\n\nThen, evaluate the timescale for Venus-like parameters: use $\\delta = 200\\ \\mathrm{km}$ and $\\kappa = 8.0 \\times 10^{-7}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$. Express the final timescale in $\\mathrm{Myr}$, where $1\\ \\mathrm{Myr} = 10^{6}\\ \\mathrm{yr}$ and $1\\ \\mathrm{yr} = 3.15576 \\times 10^{7}\\ \\mathrm{s}$. Round your answer to three significant figures.\n\nProvide only the numerical value of the timescale in $\\mathrm{Myr}$ as your final answer.",
            "solution": "The problem asks for the e-folding timescale of the slowest decaying thermal perturbation in a plane-parallel lithospheric slab. The problem is physically and mathematically well-posed and contains all necessary information for a solution.\n\nThe governing equation for heat transport is the one-dimensional heat diffusion equation, derived from energy conservation and Fourier's law:\n$$\n\\frac{\\partial T}{\\partial t} = \\kappa \\frac{\\partial^2 T}{\\partial z^2}\n$$\nHere, $T(z, t)$ is the temperature at vertical position $z$ and time $t$, and $\\kappa$ is the constant thermal diffusivity. We define the coordinate system such that the planetary surface is at $z=0$ and the base of the lithosphere is at $z=\\delta$.\n\nThe total temperature profile $T(z, t)$ is decomposed into a steady-state linear geotherm, $T_{ss}(z)$, and a time-dependent perturbation, $\\theta(z, t)$:\n$$\nT(z, t) = T_{ss}(z) + \\theta(z, t)\n$$\nThe steady-state profile $T_{ss}(z)$ satisfies the diffusion equation with the time derivative set to zero:\n$$\n\\frac{d^2 T_{ss}}{dz^2} = 0\n$$\nThe problem specifies fixed-temperature boundary conditions. Let the surface temperature be $T_s$ and the basal temperature be $T_m$. The boundary conditions for the total temperature are:\n$$\nT(0, t) = T_s\n$$\n$$\nT(\\delta, t) = T_m\n$$\nThe steady-state solution that satisfies these boundary conditions is a linear temperature profile:\n$$\nT_{ss}(z) = (T_m - T_s)\\frac{z}{\\delta} + T_s\n$$\nSubstituting the decomposition $T(z, t) = T_{ss}(z) + \\theta(z, t)$ into the heat diffusion equation yields:\n$$\n\\frac{\\partial}{\\partial t} (T_{ss}(z) + \\theta(z, t)) = \\kappa \\frac{\\partial^2}{\\partial z^2} (T_{ss}(z) + \\theta(z, t))\n$$\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\kappa \\frac{\\partial^2 T_{ss}}{\\partial z^2} + \\kappa \\frac{\\partial^2 \\theta}{\\partial z^2}\n$$\nSince $\\frac{\\partial^2 T_{ss}}{\\partial z^2} = 0$, the perturbation $\\theta(z, t)$ itself must satisfy the heat diffusion equation:\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\kappa \\frac{\\partial^2 \\theta}{\\partial z^2}\n$$\nThe boundary conditions for the perturbation are found by applying the total temperature boundary conditions:\nAt $z=0$: $T(0, t) = T_{ss}(0) + \\theta(0, t) = T_s$. Since $T_{ss}(0) = T_s$, we have $\\theta(0, t) = 0$.\nAt $z=\\delta$: $T(\\delta, t) = T_{ss}(\\delta) + \\theta(\\delta, t) = T_m$. Since $T_{ss}(\\delta) = T_m$, we have $\\theta(\\delta, t) = 0$.\n\nWe now solve the partial differential equation for $\\theta(z, t)$ with homogeneous Dirichlet boundary conditions, $\\theta(0, t) = 0$ and $\\theta(\\delta, t) = 0$, using the method of separation of variables. Let $\\theta(z, t) = Z(z) \\mathcal{T}(t)$. Substituting this into the PDE gives:\n$$\nZ(z) \\frac{d\\mathcal{T}}{dt} = \\kappa \\mathcal{T}(t) \\frac{d^2 Z}{dz^2}\n$$\nSeparating the variables, we get:\n$$\n\\frac{1}{\\kappa \\mathcal{T}} \\frac{d\\mathcal{T}}{dt} = \\frac{1}{Z} \\frac{d^2 Z}{dz^2} = -k^2\n$$\nwhere $-k^2$ is the separation constant. This gives two ordinary differential equations:\n$1$. Time equation: $\\frac{d\\mathcal{T}}{dt} = -k^2 \\kappa \\mathcal{T}$. The solution is $\\mathcal{T}(t) = C \\exp(-k^2 \\kappa t)$, which describes exponential decay with an e-folding timescale of $\\tau = 1/(k^2 \\kappa)$.\n$2$. Space equation: $\\frac{d^2 Z}{dz^2} + k^2 Z = 0$. The general solution is $Z(z) = A \\sin(kz) + B \\cos(kz)$.\n\nApplying the boundary conditions for $\\theta(z, t)$ to the spatial solution $Z(z)$:\nThe condition $Z(0) = 0$ implies $A \\sin(0) + B \\cos(0) = 0$, which gives $B = 0$.\nThe solution is now $Z(z) = A \\sin(kz)$.\nThe condition $Z(\\delta) = 0$ implies $A \\sin(k\\delta) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sin(k\\delta) = 0$.\nThis condition quantizes the possible values of $k$:\n$$\nk\\delta = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\nThe case $n=0$ is excluded as it leads to the trivial solution $Z(z)=0$. The eigenvalues are therefore $k_n = \\frac{n\\pi}{\\delta}$.\n\nEach integer $n$ corresponds to a specific mode of decay with its own e-folding timescale $\\tau_n$:\n$$\n\\tau_n = \\frac{1}{k_n^2 \\kappa} = \\frac{1}{\\left(\\frac{n\\pi}{\\delta}\\right)^2 \\kappa} = \\frac{\\delta^2}{n^2 \\pi^2 \\kappa}\n$$\nThe problem asks for the timescale of the slowest decaying mode. This corresponds to the largest e-folding time $\\tau_n$. The timescale is maximized for the smallest possible value of $n$, which is $n=1$. This is the fundamental mode.\nThe slowest e-folding timescale, which we will call $\\tau$, is thus:\n$$\n\\tau = \\tau_1 = \\frac{\\delta^2}{\\pi^2 \\kappa}\n$$\nThis expression relates the timescale to the lithospheric thickness $\\delta$ and the thermal diffusivity $\\kappa$.\n\nNow, we evaluate this timescale for the given parameters for Venus:\nLithospheric thickness: $\\delta = 200\\ \\mathrm{km} = 200 \\times 10^3\\ \\mathrm{m} = 2 \\times 10^5\\ \\mathrm{m}$.\nThermal diffusivity: $\\kappa = 8.0 \\times 10^{-7}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$.\n\nSubstituting these values into the expression for $\\tau$:\n$$\n\\tau = \\frac{(2 \\times 10^5\\ \\mathrm{m})^2}{\\pi^2 (8.0 \\times 10^{-7}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1})} = \\frac{4 \\times 10^{10}\\ \\mathrm{m}^2}{\\pi^2 \\times 8.0 \\times 10^{-7}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}}\n$$\n$$\n\\tau = \\frac{4}{8.0 \\pi^2} \\times 10^{17}\\ \\mathrm{s} = \\frac{0.5}{\\pi^2} \\times 10^{17}\\ \\mathrm{s} \\approx 5.066059 \\times 10^{15}\\ \\mathrm{s}\n$$\nThe problem requires the answer in Megayears (Myr). We are given the conversion factors:\n$1\\ \\mathrm{yr} = 3.15576 \\times 10^7\\ \\mathrm{s}$\n$1\\ \\mathrm{Myr} = 10^6\\ \\mathrm{yr} = 10^6 \\times (3.15576 \\times 10^7\\ \\mathrm{s}) = 3.15576 \\times 10^{13}\\ \\mathrm{s}$\n\nConverting the timescale $\\tau$ from seconds to Myr:\n$$\n\\tau (\\mathrm{Myr}) = \\frac{\\tau (\\mathrm{s})}{3.15576 \\times 10^{13}\\ \\mathrm{s/Myr}} = \\frac{5.066059 \\times 10^{15}}{3.15576 \\times 10^{13}}\n$$\n$$\n\\tau (\\mathrm{Myr}) \\approx 160.535\n$$\nRounding the result to three significant figures, we get $161$.\nThe slowest relaxation timescale for thermal anomalies in the Venusian lithosphere under these assumptions is approximately $161$ Myr.",
            "answer": "$$\\boxed{161}$$"
        },
        {
            "introduction": "While the lithosphere cools by slow conduction, a planet's mantle loses the vast majority of its heat through vigorous convection. Characterizing the timescale of this motion is crucial for understanding a planet's thermal evolution, magnetic field generation, and surface tectonics. In this practice, you will use scaling analysis—a powerful tool in geodynamics—to derive the convective overturn time and see how it depends on fundamental planetary parameters like size, gravity, and mantle viscosity.",
            "id": "4165547",
            "problem": "A rocky super-Earth is modeled as having an isoviscous, incompressible mantle obeying the Boussinesq approximation at effectively infinite Prandtl number, convecting beneath a mobile lid. Consider a plane-parallel convecting mantle layer of thickness $D$ with constant thermal diffusivity $\\kappa$, thermal expansivity $\\alpha$, density $\\rho$, dynamic viscosity $\\eta$, gravitational acceleration $g$, and superadiabatic temperature contrast across the layer $\\Delta T$. In such convection, the characteristic convective velocity non-dimensionalized by $\\kappa/D$ follows a power-law in the Rayleigh number with exponent $\\gamma$ appropriate to the mobile-lid, isoviscous regime.\n\nStarting from fundamental balances of buoyancy, viscous resistance, and heat diffusion that underlie thermal convection scalings, derive an analytic expression for the convective overturn time $t$ in terms of $D$, $\\kappa$, $\\rho$, $g$, $\\alpha$, $\\Delta T$, $\\eta$, and $\\gamma$. Then evaluate $t$ numerically for a super-Earth mantle with the following properties:\n- $D = 4.33 \\times 10^{6}\\ \\mathrm{m}$,\n- $\\kappa = 1.00 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$,\n- $\\alpha = 2.00 \\times 10^{-5}\\ \\mathrm{K^{-1}}$,\n- $\\Delta T = 2.50 \\times 10^{3}\\ \\mathrm{K}$,\n- $\\rho = 4.50 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$,\n- $\\eta = 1.00 \\times 10^{22}\\ \\mathrm{Pa\\ s}$,\n- $g = 2.20 \\times 10^{1}\\ \\mathrm{m\\ s^{-2}}$,\nand adopt the canonical mobile-lid, isoviscous exponent $\\gamma = 2/3$. Neglect any order-unity prefactors in the scaling.\n\nExpress the final time in mega-years (Myr). Round your answer to three significant figures. The final answer must be a single number.",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of fluid dynamics and planetary science, specifically the theory of thermal convection. The setup is well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe objective is to first derive an analytical expression for the convective overturn time, $t$, and then to calculate its numerical value for a given set of planetary parameters. The analysis will rely on scaling arguments, neglecting order-unity prefactors as instructed.\n\nThe convective overturn time, $t$, is the characteristic time it takes for a fluid parcel to traverse the convecting layer. For a layer of thickness $D$, this time is determined by the characteristic convective velocity, $u$. The scaling relationship is:\n$$\nt \\sim \\frac{D}{u}\n$$\nThe problem states that the characteristic convective velocity, when non-dimensionalized, follows a power-law relationship with the Rayleigh number, $Ra$. The non-dimensional velocity, $u'$, is defined by scaling the dimensional velocity $u$ with the thermal diffusion velocity, $\\kappa/D$:\n$$\nu' = \\frac{u}{\\kappa/D}\n$$\nThe scaling law for $u'$ in the mobile-lid, isoviscous regime is given as:\n$$\nu' \\sim Ra^{\\gamma}\n$$\nwhere $\\gamma$ is the power-law exponent. Combining these two expressions allows us to find the dimensional velocity $u$:\n$$\nu = u' \\frac{\\kappa}{D} \\sim \\left( Ra^{\\gamma} \\right) \\frac{\\kappa}{D}\n$$\nThe Rayleigh number, $Ra$, is a dimensionless parameter that characterizes the ratio of thermally-driven buoyancy forces to viscous and diffusive dissipative forces. For the system described, it is defined as:\n$$\nRa = \\frac{\\alpha g \\rho \\Delta T D^3}{\\eta \\kappa}\n$$\nwhere $\\alpha$ is the thermal expansivity, $g$ is the gravitational acceleration, $\\rho$ is the density, $\\Delta T$ is the superadiabatic temperature contrast, $D$ is the layer thickness, $\\eta$ is the dynamic viscosity, and $\\kappa$ is the thermal diffusivity.\n\nWe can now substitute the expression for $u$ into the definition of the overturn time $t$:\n$$\nt \\sim \\frac{D}{u} \\sim \\frac{D}{(\\kappa/D) Ra^{\\gamma}} = \\frac{D^2}{\\kappa} Ra^{-\\gamma}\n$$\nThe term $D^2/\\kappa$ represents the characteristic time for heat to diffuse across the layer. The overturn time is thus the diffusion time modulated by the vigor of convection, as represented by $Ra^{-\\gamma}$. Substituting the full expression for the Rayleigh number yields the final analytical expression for the overturn time $t$ in terms of the fundamental physical parameters:\n$$\nt \\sim \\frac{D^2}{\\kappa} \\left( \\frac{\\alpha g \\rho \\Delta T D^3}{\\eta \\kappa} \\right)^{-\\gamma}\n$$\nThis is the required analytical expression.\n\nNext, we evaluate this expression numerically using the provided data for the super-Earth:\n-   $D = 4.33 \\times 10^{6}\\ \\mathrm{m}$\n-   $\\kappa = 1.00 \\times 10^{-6}\\ \\mathrm{m^{2}\\ s^{-1}}$\n-   $\\alpha = 2.00 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n-   $\\Delta T = 2.50 \\times 10^{3}\\ \\mathrm{K}$\n-   $\\rho = 4.50 \\times 10^{3}\\ \\mathrm{kg\\ m^{-3}}$\n-   $\\eta = 1.00 \\times 10^{22}\\ \\mathrm{Pa\\ s}$\n-   $g = 2.20 \\times 10^{1}\\ \\mathrm{m\\ s^{-2}}$\n-   $\\gamma = 2/3$\n\nFirst, we calculate the Rayleigh number, $Ra$:\n$$\nRa = \\frac{(2.00 \\times 10^{-5}) (2.20 \\times 10^{1}) (4.50 \\times 10^{3}) (2.50 \\times 10^{3}) (4.33 \\times 10^{6})^3}{(1.00 \\times 10^{22}) (1.00 \\times 10^{-6})}\n$$\nThe numerator can be calculated as:\n$$\n\\text{Numerator} = (2.00 \\times 2.20 \\times 4.50 \\times 2.50) \\times (4.33)^3 \\times 10^{-5+1+3+3+(6 \\times 3)}\n$$\n$$\n\\text{Numerator} = (49.5) \\times (81.221237) \\times 10^{20} \\approx 4.02045 \\times 10^{23}\n$$\nThe denominator is:\n$$\n\\text{Denominator} = (1.00 \\times 10^{22}) \\times (1.00 \\times 10^{-6}) = 1.00 \\times 10^{16}\n$$\nThus, the Rayleigh number is:\n$$\nRa = \\frac{4.02045 \\times 10^{23}}{1.00 \\times 10^{16}} \\approx 4.02045 \\times 10^7\n$$\nNow, we calculate the overturn time $t$ using the derived scaling relationship $t \\sim (D^2/\\kappa) Ra^{-\\gamma}$:\n$$\nt \\approx \\frac{(4.33 \\times 10^{6})^2}{1.00 \\times 10^{-6}} (4.02045 \\times 10^7)^{-2/3}\n$$\nFirst, calculate the thermal diffusion time, $t_{diff} = D^2/\\kappa$:\n$$\nt_{diff} = \\frac{1.87489 \\times 10^{13}\\ \\mathrm{m^2}}{1.00 \\times 10^{-6}\\ \\mathrm{m^2 s^{-1}}} = 1.87489 \\times 10^{19}\\ \\mathrm{s}\n$$\nNext, calculate the term $Ra^{-2/3}$:\n$$\nRa^{-2/3} = (4.02045 \\times 10^7)^{-2/3} = ((4.02045 \\times 10^7)^{1/3})^{-2}\n$$\n$$\n(4.02045 \\times 10^7)^{1/3} = (40.2045 \\times 10^6)^{1/3} = (40.2045)^{1/3} \\times 10^2 \\approx 3.4259 \\times 10^2\n$$\n$$\nRa^{-2/3} \\approx (3.4259 \\times 10^2)^{-2} \\approx \\frac{1}{11.7368 \\times 10^4} \\approx \\frac{1}{1.17368 \\times 10^5} \\approx 8.5201 \\times 10^{-6}\n$$\nNow, we compute the overturn time $t$ in seconds:\n$$\nt \\approx (1.87489 \\times 10^{19}\\ \\mathrm{s}) \\times (8.5201 \\times 10^{-6}) \\approx 1.5974 \\times 10^{14}\\ \\mathrm{s}\n$$\nFinally, we convert the time from seconds to mega-years (Myr). There are approximately $3.15576 \\times 10^7$ seconds in a year, and $10^6$ years in a mega-year.\n$$\n1\\ \\mathrm{Myr} = 10^6\\ \\mathrm{years} \\times 3.15576 \\times 10^7\\ \\mathrm{s/year} \\approx 3.15576 \\times 10^{13}\\ \\mathrm{s}\n$$\n$$\nt\\ (\\mathrm{Myr}) = \\frac{1.5974 \\times 10^{14}\\ \\mathrm{s}}{3.15576 \\times 10^{13}\\ \\mathrm{s/Myr}} \\approx 5.0618\\ \\mathrm{Myr}\n$$\nRounding the result to three significant figures gives $5.06$ Myr.",
            "answer": "$$\\boxed{5.06}$$"
        },
        {
            "introduction": "Geophysical data provides the ultimate constraint on our models of planetary interiors. This computational exercise puts you in the role of a planetary seismologist, tasked with inferring the mantle's attenuation structure from the vibrations of the planet itself (its normal modes). You will apply damped least-squares inversion, a cornerstone of geophysical inverse theory, to build a model of the quality factor $Q$ and then test its consistency with physical theories of how attenuation relates to mantle temperature and grain size.",
            "id": "4165558",
            "problem": "You are given an idealized linear inverse problem for a spherically symmetric terrestrial planet’s mantle that uses normal mode splitting information to infer radial attenuation, expressed through the quality factor $Q$ of three concentric mantle layers. The three layers are lithosphere, upper mantle, and lower mantle. The forward model assumes that each observed mode’s inverse quality factor $q_i$ is a weighted average of the layers’ inverse quality factors $m_j = 1/Q_j$, with known sensitivity weights. Specifically, the forward relation is\n$$\nq_i = \\sum_{j=1}^{3} w_{ij} \\, m_j,\n$$\nwhere $i \\in \\{1,\\dots,5\\}$ indexes the five observed normal modes and $j \\in \\{1,2,3\\}$ indexes the layers. The weights $w_{ij}$ encode the radial sensitivity of mode $i$ to layer $j$ and satisfy $\\sum_{j} w_{ij} = 1$ for each $i$. The objective is to estimate the layer-wise quality factors $Q_j$ from the observed $q_i$ by solving a damped least-squares inverse problem, and then to quantitatively examine how attenuation correlates with mantle temperature and grain size using a physically motivated scaling.\n\nFundamental base:\n- Define the quality factor $Q$ for a viscoelastic material: $Q$ is dimensionless and quantifies the ratio of stored to dissipated energy per cycle; higher $Q$ means lower attenuation. For normal modes, small perturbations in structure and attenuation lead to measurable mode frequency splittings and linewidths that can be linearly related to internal $Q$ structure through sensitivity kernels. In this simplified setting, each mode’s inverse quality factor $q_i$ is a linear functional of the radial inverse $Q$ structure, discretized into three layers as above.\n- Use least-squares theory to solve the linear inverse problem. With a damping parameter $\\lambda  0$, solve for $m = (m_1,m_2,m_3)^\\top$ via the normal equations\n$$\n\\left( G^\\top G + \\lambda^2 I \\right) m = G^\\top d,\n$$\nwhere $G$ is the $5 \\times 3$ matrix of weights $w_{ij}$, $d$ is the $5 \\times 1$ vector with components $q_i$, and $I$ is the identity matrix. Then set $Q_j = 1/m_j$.\n- Model the dependence of attenuation on temperature $T$ and grain size $d$ with a broad-band, power-law background consistent with an Andrade-type anelasticity: for a reference angular frequency $\\omega_0$, define the predicted inverse quality factor for layer $j$ as\n$$\nm^{\\mathrm{pred}}_j = A \\left( \\frac{\\omega_{\\mathrm{ref}}}{\\omega_0} \\right)^{\\alpha} \\left( \\frac{T_j}{T_0} \\right)^{\\beta} \\left( \\frac{d_j}{d_0} \\right)^{-p},\n$$\nwhere $A$, $\\alpha$, $\\beta$, and $p$ are positive constants, $T_0$ and $d_0$ are reference values, and $\\omega_{\\mathrm{ref}}$ is a representative angular frequency for the set of modes. This captures that inverse $Q$ increases with temperature and decreases with grain size in the mantle.\n\nComputational tasks:\n1. For each test case, solve the damped least-squares inverse problem to obtain $m_j$ and $Q_j = 1/m_j$.\n2. For each test case, compute $m^{\\mathrm{pred}}_j$ using the scaling above and then compute the Pearson correlation coefficient\n$$\nr = \\frac{\\mathrm{cov}(m, m^{\\mathrm{pred}})}{\\sigma_m \\, \\sigma_{m^{\\mathrm{pred}}}},\n$$\nwhere $\\mathrm{cov}$ denotes covariance and $\\sigma$ denotes the standard deviation. If $\\sigma_m = 0$ or $\\sigma_{m^{\\mathrm{pred}}} = 0$, set $r = 0$.\n3. For each test case, compute the root-mean-square misfit\n$$\n\\mathrm{RMS} = \\sqrt{ \\frac{1}{5} \\sum_{i=1}^{5} \\left( q_i - \\sum_{j=1}^{3} w_{ij} m_j \\right)^2 }.\n$$\n\nUnits and constants:\n- Quality factor $Q$ is dimensionless.\n- Temperature $T$ is in $\\mathrm{K}$.\n- Grain size $d$ is in $\\mathrm{m}$.\n- Frequencies are in $\\mathrm{Hz}$ (use angular frequency only in the ratio form; here we set $\\omega_{\\mathrm{ref}} / \\omega_0 = 1$ by choosing $\\omega_{\\mathrm{ref}} = \\omega_0$).\n- Use $A = 0.005$, $\\alpha = 0.2$, $\\beta = 1.5$, $p = 0.5$, $T_0 = 1500 \\,\\mathrm{K}$, $d_0 = 1\\times 10^{-3} \\,\\mathrm{m}$, and $\\omega_0 = 0.01 \\,\\mathrm{Hz}$ with $\\omega_{\\mathrm{ref}} = 0.01 \\,\\mathrm{Hz}$, so that $\\left( \\omega_{\\mathrm{ref}} / \\omega_0 \\right)^{\\alpha} = 1$. Use a damping parameter $\\lambda = 1\\times 10^{-6}$.\n\nSensitivity weights $w_{ij}$ (rows are modes $i=1$ to $i=5$, columns are layers $j=1$ lithosphere, $j=2$ upper mantle, $j=3$ lower mantle):\n- Mode $1$: $[\\,0.1,\\,0.3,\\,0.6\\,]$\n- Mode $2$: $[\\,0.15,\\,0.45,\\,0.4\\,]$\n- Mode $3$: $[\\,0.25,\\,0.5,\\,0.25\\,]$\n- Mode $4$: $[\\,0.35,\\,0.5,\\,0.15\\,]$\n- Mode $5$: $[\\,0.5,\\,0.45,\\,0.05\\,]$\n\nMode frequencies (for context, in $\\mathrm{Hz}$): $[\\,0.003,\\,0.005,\\,0.01,\\,0.02,\\,0.04\\,]$.\n\nTest suite:\n- Test case $1$ (Earth-like mantle):\n  - Observed inverse mode quality factors $q$: $[\\,0.0050000,\\,0.0058333,\\,0.0062500,\\,0.0064167,\\,0.0064167\\,]$.\n  - Layer temperatures $T$: $[\\,1200,\\,1600,\\,1900\\,]$ $\\mathrm{K}$.\n  - Layer grain sizes $d$: $[\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.0\\times 10^{-3}\\,]$ $\\mathrm{m}$.\n- Test case $2$ (hotter upper mantle, finer grains):\n  - Observed $q$: $[\\,0.0068167,\\,0.0082250,\\,0.0089167,\\,0.0091833,\\,0.0091583\\,]$.\n  - $T$: $[\\,1300,\\,1700,\\,1800\\,]$ $\\mathrm{K}$.\n  - $d$: $[\\,1.0\\times 10^{-3},\\,4.0\\times 10^{-4},\\,1.5\\times 10^{-3}\\,]$ $\\mathrm{m}$.\n- Test case $3$ (cold, coarse-grained mantle):\n  - Observed $q$: $[\\,0.0027333,\\,0.0031000,\\,0.0033333,\\,0.0034667,\\,0.0035667\\,]$.\n  - $T$: $[\\,1100,\\,1300,\\,1500\\,]$ $\\mathrm{K}$.\n  - $d$: $[\\,2.5\\times 10^{-3},\\,2.0\\times 10^{-3},\\,2.5\\times 10^{-3}\\,]$ $\\mathrm{m}$.\n- Test case $4$ (attenuating lower mantle):\n  - Observed $q$: $[\\,0.0038000,\\,0.0032000,\\,0.0027500,\\,0.0024500,\\,0.0021500\\,]$.\n  - $T$: $[\\,1100,\\,1300,\\,1800\\,]$ $\\mathrm{K}$.\n  - $d$: $[\\,2.0\\times 10^{-3},\\,2.0\\times 10^{-3},\\,5.0\\times 10^{-4}\\,]$ $\\mathrm{m}$.\n\nAlgorithmic specification:\n- Implement the damped least-squares solution for $m$ using the normal equations above and compute $Q_j = 1/m_j$ for each layer.\n- Compute $m^{\\mathrm{pred}}_j$ using the power-law scaling with the given constants and inputs.\n- Compute $r$ and $\\mathrm{RMS}$ as defined.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of five floats in the order $[\\,Q_{\\mathrm{lith}},\\,Q_{\\mathrm{upper}},\\,Q_{\\mathrm{lower}},\\,r,\\,\\mathrm{RMS}\\,]$, so the final output is a list of these lists, for example $[[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n,o],[p,q,r,s,t]]$. All $Q$ values and $r$ are dimensionless, and $\\mathrm{RMS}$ is dimensionless.",
            "solution": "The user has provided a problem statement that requires the solution of a linear inverse problem in the context of planetary seismology, followed by a comparison with a physical scaling law for material attenuation. The validation and solution process is as follows.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n\n- **Forward Model:** A linear relationship between observed inverse mode quality factors, $q_i$, and layer inverse quality factors, $m_j = 1/Q_j$, is given by $q_i = \\sum_{j=1}^{3} w_{ij} m_j$ for $i=1,\\dots,5$ modes and $j=1,2,3$ layers.\n- **Inverse Problem Formulation:** The model parameter vector $m = (m_1, m_2, m_3)^\\top$ is to be found by solving the damped least-squares normal equations: $( G^\\top G + \\lambda^2 I ) m = G^\\top d$, where $G$ is the $5 \\times 3$ matrix of weights $w_{ij}$, $d$ is the $5 \\times 1$ data vector of $q_i$, $I$ is the identity matrix, and $\\lambda$ is a damping parameter.\n- **Physical Scaling Law:** A predicted inverse quality factor $m^{\\mathrm{pred}}_j$ for each layer is given by the power-law relation: $m^{\\mathrm{pred}}_j = A \\left( \\frac{\\omega_{\\mathrm{ref}}}{\\omega_0} \\right)^{\\alpha} \\left( \\frac{T_j}{T_0} \\right)^{\\beta} \\left( \\frac{d_j}{d_0} \\right)^{-p}$.\n- **Required Computations:** For each test case, we must compute:\n    1. The layer quality factors $Q_j = 1/m_j$.\n    2. The Pearson correlation coefficient, $r$, between the inverted model $m$ and the predicted model $m^{\\mathrm{pred}}$. If the standard deviation of either vector is zero, $r=0$.\n    3. The root-mean-square (RMS) misfit: $\\mathrm{RMS} = \\sqrt{ \\frac{1}{5} \\sum_{i=1}^{5} (q_i - (Gm)_i)^2 }$.\n- **Constants and Parameters:**\n    - Damping parameter: $\\lambda = 1 \\times 10^{-6}$.\n    - Scaling law constants: $A = 0.005$, $\\alpha = 0.2$, $\\beta = 1.5$, $p = 0.5$.\n    - Reference values: $T_0 = 1500 \\,\\mathrm{K}$, $d_0 = 1\\times 10^{-3} \\,\\mathrm{m}$.\n    - Frequency ratio: $(\\omega_{\\mathrm{ref}} / \\omega_0)^{\\alpha} = 1$.\n- **Sensitivity Matrix $G$ (weights $w_{ij}$):**\n$$ G = \\begin{pmatrix} 0.1  0.3  0.6 \\\\ 0.15  0.45  0.4 \\\\ 0.25  0.5  0.25 \\\\ 0.35  0.5  0.15 \\\\ 0.5  0.45  0.05 \\end{pmatrix} $$\n- **Test Cases:** Four test cases are provided, each with a vector of observed inverse quality factors $q_i$, layer temperatures $T_j$, and layer grain sizes $d_j$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is firmly rooted in geophysical inverse theory and solid-earth geophysics. The use of normal mode splitting data for inferring mantle structure, the linear forward model, damped least-squares inversion, and the physically-motivated power-law for attenuation are all standard concepts in the field. The provided data values are physically plausible. The problem is valid.\n- **Well-Posed:** The problem is mathematically and computationally well-posed. The inverse problem is an overdetermined system ($5$ equations, $3$ unknowns). The use of a non-zero damping parameter $\\lambda$ ensures that the matrix $(G^\\top G + \\lambda^2 I)$ is positive definite and thus invertible, guaranteeing a unique and stable solution for $m$. The definitions for $r$ and RMS are standard and unambiguous. The problem is valid.\n- **Objective:** The problem is stated with clear, precise, and objective language. All necessary parameters and data are explicitly provided. The problem is valid.\n- **Self-Contained and Consistent:** The problem provides all necessary information for its solution. A check of the sensitivity weights confirms that the rows sum to $1$ ($\\sum_{j} w_{ij} = 1$), as stated. There are no internal contradictions. The problem is valid.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid** on all criteria. A solution will be developed and implemented.\n\n### **Solution Derivation and Implementation Strategy**\n\nThe solution proceeds by implementing the three computational tasks for each of the four test cases.\n\n**1. Damped Least-Squares Inversion**\nThe core of the problem is to solve the linear system $(G^\\top G + \\lambda^2 I) m = G^\\top d$ for the vector $m = [m_1, m_2, m_3]^\\top$.\n- The sensitivity matrix $G$ and the damping parameter $\\lambda = 1 \\times 10^{-6}$ are constant for all test cases. We can pre-compute the system matrix $A_{\\text{norm}} = G^\\top G + \\lambda^2 I$.\n- For each test case, the data vector $d$ is given by the observed $q_i$. We form the right-hand side vector $b_{\\text{norm}} = G^\\top d$.\n- We solve the system $A_{\\text{norm}} m = b_{\\text{norm}}$ using a standard linear algebra solver, such as `numpy.linalg.solve`.\n- Once the vector $m$ is found, the quality factors for each layer are calculated as $Q_j = 1/m_j$.\n\n**2. Physical Model Correlation**\nNext, we calculate the predicted inverse quality factors, $m^{\\mathrm{pred}}_j$, using the provided scaling law and then compute the correlation with the inverted $m_j$.\n- The scaling law simplifies, since $(\\omega_{\\mathrm{ref}} / \\omega_0)^{\\alpha} = 1$, to:\n$$ m^{\\mathrm{pred}}_j = A \\left( \\frac{T_j}{T_0} \\right)^{\\beta} \\left( \\frac{d_j}{d_0} \\right)^{-p} $$\n- Using the given constants ($A=0.005$, $\\beta=1.5$, $p=0.5$, $T_0=1500$, $d_0=10^{-3}$) and the per-case layer temperatures $T_j$ and grain sizes $d_j$, we compute the vector $m^{\\mathrm{pred}} = [m^{\\mathrm{pred}}_1, m^{\\mathrm{pred}}_2, m^{\\mathrm{pred}}_3]^\\top$.\n- The Pearson correlation coefficient $r$ between the vectors $m$ and $m^{\\mathrm{pred}}$ is computed. The problem specifies that if the standard deviation of either vector is zero, $r$ should be set to $0$. This condition is handled before using a standard library function like `numpy.corrcoef`.\n\n**3. RMS Misfit Calculation**\nFinally, we quantify the goodness of fit of our inverted model $m$ to the observed data $d$.\n- We first compute the predicted data from our inverted model: $d^{\\text{pred}} = G m$.\n- The residual vector is $res = d - d^{\\text{pred}}$.\n- The RMS misfit is the square root of the mean of the squared residuals:\n$$ \\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} res_i^2} $$\nwhere $N=5$ is the number of observations.\n\nThis entire procedure is applied to each of the four test cases. The final output is an aggregation of the five calculated values ($Q_1, Q_2, Q_3, r, \\mathrm{RMS}$) for each case, formatted as a list of lists.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of geophysical inverse problems to determine mantle quality factors.\n\n    For each test case, this function:\n    1. Solves a damped least-squares problem to find layer inverse quality factors (m).\n    2. Calculates the layer quality factors (Q = 1/m).\n    3. Computes a predicted inverse quality factor (m_pred) based on a physical scaling law.\n    4. Calculates the Pearson correlation coefficient (r) between m and m_pred.\n    5. Computes the root-mean-square (RMS) misfit between observed and predicted data.\n    \"\"\"\n    \n    # Define constants and fixed parameters as per the problem statement\n    # Sensitivity weights matrix G, connecting observations to model parameters\n    G = np.array([\n        [0.1, 0.3, 0.6],\n        [0.15, 0.45, 0.4],\n        [0.25, 0.5, 0.25],\n        [0.35, 0.5, 0.15],\n        [0.5, 0.45, 0.05]\n    ], dtype=float)\n\n    # Damping parameter for the least-squares inversion\n    lamb = 1e-6\n\n    # Constants for the physical attenuation scaling law\n    A = 0.005\n    beta = 1.5\n    p = 0.5\n    T0 = 1500.0  # Reference Temperature in Kelvin\n    d0 = 1e-3    # Reference grain size in meters\n    # The frequency term (omega_ref / omega_0)^alpha evaluates to 1 and is omitted.\n\n    # Pre-compute the constant parts of the normal equations matrix for efficiency\n    G_T = G.T\n    G_T_G = G_T @ G\n    lambda_sq_I = lamb**2 * np.identity(G.shape[1])\n    A_norm = G_T_G + lambda_sq_I\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (Earth-like mantle)\n        {\n            \"q_obs\": np.array([0.0050000, 0.0058333, 0.0062500, 0.0064167, 0.0064167]),\n            \"T_layers\": np.array([1200, 1600, 1900]),\n            \"d_grains\": np.array([1.0e-3, 5.0e-4, 2.0e-3])\n        },\n        # Test case 2 (hotter upper mantle, finer grains)\n        {\n            \"q_obs\": np.array([0.0068167, 0.0082250, 0.0089167, 0.0091833, 0.0091583]),\n            \"T_layers\": np.array([1300, 1700, 1800]),\n            \"d_grains\": np.array([1.0e-3, 4.0e-4, 1.5e-3])\n        },\n        # Test case 3 (cold, coarse-grained mantle)\n        {\n            \"q_obs\": np.array([0.0027333, 0.0031000, 0.0033333, 0.0034667, 0.0035667]),\n            \"T_layers\": np.array([1100, 1300, 1500]),\n            \"d_grains\": np.array([2.5e-3, 2.0e-3, 2.5e-3])\n        },\n        # Test case 4 (attenuating lower mantle)\n        {\n            \"q_obs\": np.array([0.0038000, 0.0032000, 0.0027500, 0.0024500, 0.0021500]),\n            \"T_layers\": np.array([1100, 1300, 1800]),\n            \"d_grains\": np.array([2.0e-3, 2.0e-3, 5.0e-4])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        d_vec = case[\"q_obs\"]\n        T = case[\"T_layers\"]\n        d_grain = case[\"d_grains\"]\n\n        # Task 1: Solve damped least-squares for m and compute Q\n        b_norm = G_T @ d_vec\n        m = np.linalg.solve(A_norm, b_norm)\n        Q_layers = 1.0 / m\n        \n        # Task 2: Compute predicted m and Pearson correlation r\n        m_pred = A * (T / T0)**beta * (d_grain / d0)**(-p)\n        \n        # Calculate correlation coefficient, handling zero standard deviation as per instructions\n        if np.std(m, ddof=0) == 0 or np.std(m_pred, ddof=0) == 0:\n            r = 0.0\n        else:\n            r_matrix = np.corrcoef(m, m_pred)\n            r = r_matrix[0, 1]\n\n        # Task 3: Compute RMS misfit\n        d_pred = G @ m\n        residuals = d_vec - d_pred\n        rms = np.sqrt(np.mean(residuals**2))\n        \n        # Assemble results for the current case: [Q_lith, Q_upper, Q_lower, r, RMS]\n        case_results = [\n            Q_layers[0],\n            Q_layers[1],\n            Q_layers[2],\n            r,\n            rms\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    inner_strs = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}