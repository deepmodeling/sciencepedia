{
    "hands_on_practices": [
        {
            "introduction": "多方球模型是理解自引力流体结构的一种强大简化工具。本练习使用 $n=1$ 的多方模型（气态巨行星的一种经典近似）从流体静力学平衡的第一性原理出发，推导质量-半径关系。通过这个实践，你将发现一个令人惊讶的结果：对于这类理想化行星，其半径与质量无关，这为理解真实气态巨行星观测到的相对平坦的M-R关系提供了一个基准。",
            "id": "4166849",
            "problem": "一个冷的氢氦 (H–He) 巨行星可以用多方内层来近似。假设一个球对称的、自引力的流体处于流体静力学平衡中，并遵循多方关系 $P = K \\rho^{1 + 1/n}$，其中指数 $n = 1$，$P$ 是压强，$\\rho$ 是质量密度，$K$ 是一个包含热力学状态和成分信息的常数。从流体静力学平衡基本方程 $dP/dr = - G M(r) \\rho / r^{2}$ 和质量连续性方程 $dM/dr = 4 \\pi r^{2} \\rho$ 出发，推导 $n=1$ 多方模型所蕴含的质量-半径标度关系，并得到行星半径 $R$ 关于 $K$ 和 $G$ 的表达式。其中 $G$ 是引力常数，$M(r)$ 是半径 $r$ 内包含的质量。\n\n选择一个 $K$ 值，使得一个质量为 $1\\,M_J$（$M_J$ 是木星质量）的 $n=1$ 多方模型能够重现木星半径 $R_J$。使用这个相同的 $K$ 值，计算质量分别为 $0.3\\,M_J$ 和 $3\\,M_J$ 的行星的半径（以 $R_J$ 为单位）。将你的两个半径值四舍五入到四位有效数字，并以木星半径 ($R_J$) 为单位表示。\n\n最后，定性地评论你所得到的质量依赖关系与基于真实的氢氦物态方程 (EOS) 对冷的、无辐射的巨行星的计算预期相比如何，并利用可压缩性和简并性的第一性原理来解释任何差异的物理根源。最终的数值答案应该是质量为 $0.3\\,M_J$ 和 $3\\,M_J$ 的两个半径，以 $R_J$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求基于指数为 $n=1$ 的多方物态方程来分析行星结构。分析过程是通过求解该特定情况下的恒星结构方程来推导质量-半径关系，然后用该关系来计算不同质量行星的半径。\n\n提供的基本控制方程是：\n1.  流体静力学平衡方程：\n    $$ \\frac{dP}{dr} = - \\frac{G M(r) \\rho(r)}{r^2} $$\n2.  质量连续性方程：\n    $$ \\frac{dM(r)}{dr} = 4 \\pi r^2 \\rho(r) $$\n3.  指数为 $n=1$ 的多方物态方程：\n    $$ P = K \\rho^{1 + 1/n} = K \\rho^2 $$\n在这些方程中，$P$ 是压强，$\\rho$ 是质量密度，$r$ 是从中心开始的径向坐标，$M(r)$ 是半径 $r$ 内包含的质量，$G$ 是引力常数，$K$ 是多方常数。\n\n为了求解这个方程组，我们采用 Lane-Emden 形式。这涉及到将密度和半径归一化为无量纲变量。我们定义一个无量纲函数 $\\theta(\\xi)$ 和一个无量纲半径 $\\xi$ 如下：\n$$ \\rho(r) = \\rho_c \\theta^n(\\xi) = \\rho_c \\theta(\\xi) \\quad (\\text{对于 } n=1) $$\n$$ r = a \\xi $$\n其中 $\\rho_c$ 是中心密度，$a$ 是一个特征长度尺度。将这些代入控制方程，可以得到关于 $\\theta(\\xi)$ 的二阶常微分方程，即 Lane-Emden 方程。\n\n首先，我们通过对流体静力学平衡方程求导，将其与质量连续性方程结合起来：\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho}\\frac{dP}{dr}\\right) = -G \\frac{dM(r)}{dr} = -4\\pi G r^2\\rho $$\n接下来，我们代入多方关系 $P = K\\rho^{1+1/n}$。压强梯度为 $\\frac{dP}{dr} = K(1+\\frac{1}{n})\\rho^{1/n}\\frac{d\\rho}{dr}$。对于 $n=1$，这变成 $\\frac{dP}{dr} = 2K\\rho\\frac{d\\rho}{dr}$。结构方程变为：\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} (2K\\rho\\frac{d\\rho}{dr})\\right) = \\frac{d}{dr}\\left(2Kr^2\\frac{d\\rho}{dr}\\right) = -4\\pi G r^2\\rho $$\n代入 $\\rho = \\rho_c\\theta$ 和 $r = a\\xi$，我们得到：\n$$ \\frac{d}{a d\\xi}\\left(2K(a\\xi)^2 \\frac{d(\\rho_c\\theta)}{a d\\xi}\\right) = -4\\pi G (a\\xi)^2 (\\rho_c\\theta) $$\n$$ \\frac{2K\\rho_c a^2}{a^2} \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -4\\pi G a^2 \\xi^2 \\rho_c\\theta $$\n$$ \\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -\\frac{2\\pi G a^2}{K} \\xi^2 \\theta $$\n为了得到 Lane-Emden 方程的标准形式，我们选择长度尺度 $a$ 使得右侧的系数为 1。\n$$ a^2 = \\frac{K}{2\\pi G} \\implies a = \\sqrt{\\frac{K}{2\\pi G}} $$\n做出这个选择后，$n=1$ 的 Lane-Emden 方程为：\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2 \\frac{d\\theta}{d\\xi}\\right) = -\\theta $$\n物理上合理的解在中心处 ($\\xi=0$) 必须是有限的，因此我们施加边界条件 $\\theta(0)=1$ 和 $\\frac{d\\theta}{d\\xi}|_{\\xi=0}=0$。满足这些条件的解是：\n$$ \\theta(\\xi) = \\frac{\\sin(\\xi)}{\\xi} $$\n行星的表面 $R$ 定义为密度首次变为零的半径处。这对应于 $\\theta(\\xi)$ 的第一个非平凡根，我们记为 $\\xi_1$。对于 $\\theta(\\xi) = \\frac{\\sin(\\xi)}{\\xi}$，这发生在 $\\sin(\\xi_1) = 0$ 时，即 $\\xi_1 = \\pi$。\n\n因此，行星的总半径为 $R = a \\xi_1 = a \\pi$。代入 $a$ 的表达式：\n$$ R = \\pi \\sqrt{\\frac{K}{2\\pi G}} = \\sqrt{\\frac{\\pi^2 K}{2\\pi G}} = \\sqrt{\\frac{\\pi K}{2G}} $$\n这就是所求的半径 $R$ 的表达式。这个结果的一个关键特征是 $R$ 仅依赖于常数 $K$ 和 $G$。它与行星的总质量 $M$ 或其中心密度 $\\rho_c$ 无关。这就为 $n=1$ 的多方模型建立了质量-半径标度关系：对于给定的 $K$ 值，半径是恒定的。\n\n问题陈述，对于质量 $M=1\\,M_J$，半径为 $R=1\\,R_J$。这使我们能够确定常数 $K$ 的值。我们称之为 $K_J$。\n$$ R_J = \\sqrt{\\frac{\\pi K_J}{2G}} $$\n然后，我们被要求计算质量为 $0.3\\,M_J$ 和 $3\\,M_J$ 的行星的半径，假设它们遵循相同的物理规律（即，具有相同常数 $K_J$ 的 $n=1$ 多方模型）。\n根据我们推导出的质量-半径关系，半径与质量无关。因此，这两颗行星的半径将与木星质量行星的半径相同。\n质量为 $0.3\\,M_J$ 的行星半径：$R_{0.3} = \\sqrt{\\frac{\\pi K_J}{2G}} = R_J$。\n质量为 $3\\,M_J$ 的行星半径：$R_{3.0} = \\sqrt{\\frac{\\pi K_J}{2G}} = R_J$。\n以木星半径 ($R_J$) 为单位表示并四舍五入到四位有效数字，两个半径均为 $1.000$。\n\n问题还要求与现实模型进行定性比较。$n=1$ 多方模型预测的半径与质量无关 ($R \\propto M^0$)，这为大约 $0.5$ 到 $5$ 个木星质量范围内的气态巨行星的行为提供了一个惊人合理的初步近似，在该质量范围内，观测到的质量-半径关系相对平坦。\n\n然而，单一的多方指数是一种过度简化。氢氦混合物的真实物态方程 (EOS) 是复杂的。差异的产生是因为该模型未能解释随着质量增加，行星内部物理状态的变化。随着质量和中心压强的增加，电子简并压在支撑行星抵抗引力坍缩方面变得越来越重要。对于质量非常大的巨行星和褐矮星，其物态方程接近于非相对论性简并费米气体，其压强-密度关系为 $P \\propto \\rho^{5/3}$。这对应于多方指数 $n = \\frac{1}{5/3 - 1} = \\frac{3}{2}$。对于 $n=3/2$ 的多方模型，质量-半径关系为 $R \\propto M^{-1/3}$，意味着半径随质量增加而减小。\n\n因此，现实模型预测，一个冷的氢氦行星的半径并非恒定不变。对于低质量行星，它随质量增加而增大；在几倍木星质量附近达到一个平台期或最大值；然后随着简并压占据主导地位，在更大质量时半径开始减小。$n=1$ 模型人为地用“平台”区域的物理规律来代表整个质量范围，因此错过了在更大质量处的拐点和随后的收缩。例如，一个真实的质量为 $3\\,M_J$ 的行星的半径会比木星略小。这种差异的物理根源在于，简单的 $P=K\\rho^2$ 关系无法捕捉到向电子简并态主导状态的转变。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n1.000 & 1.000\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "真实的系外行星并非均匀的球体，而是具有复杂的多层结构。这个编程练习将挑战你构建一个实用的双层模型（岩石核心+气体包层），以探究系外行星科学中的一个核心问题：一个低质量行星的半径在多大程度上由其固体核心贡献，又在多大程度上由其气体包层贡献？通过计算匹配观测半径所需的最小包层质量，这项实践将让你直接体验行星特征分析中的简并性问题以及大气成分的影响。",
            "id": "4166861",
            "problem": "您的任务是构建一个双层系外行星结构模型，以估算在给定总质量的情况下再现指定行星半径所需的最小包层质量分数，并测试该最小包层分数对包层金属丰度的敏感性。该模型必须基于基本物理原理和广泛接受的近似方法。目标系统是一颗类亚海王星行星，其总质量为 $M$，观测半径为 $R_{\\mathrm{obs}}$。该行星被建模为一个类地岩石核心，其质量为 $M_{\\mathrm{c}}$，上覆一个质量为 $M_{\\mathrm{env}}$ 的等温氢氦包层，该包层富含重分子（金属丰度），其特征在于质量分数 $Z_{\\mathrm{env}}$。包层质量分数定义为 $f_{\\mathrm{env}} = M_{\\mathrm{env}} / M$，目标是确定使模型半径 $R$ 等于或超过 $R_{\\mathrm{obs}}$ 的最小 $f_{\\mathrm{env}}$。\n\n您的程序必须实现以下物理原理和近似方法，并严格使用国际单位制 (SI) 进行操作：\n\n- 该模型包括一个岩石核心和一个气体包层。核心质量为 $M_{\\mathrm{c}} = (1 - f_{\\mathrm{env}}) M$，包层质量为 $M_{\\mathrm{env}} = f_{\\mathrm{env}} M$。\n- 核心半径 $R_{\\mathrm{c}}$ 遵循一个广泛用于类地成分的近似质量-半径关系：$R_{\\mathrm{c}} = R_\\oplus \\left( \\frac{M_{\\mathrm{c}}}{M_\\oplus} \\right)^\\alpha$，其中 $R_\\oplus$ 和 $M_\\oplus$ 分别是地球半径和地球质量，$\\alpha$ 是一个常数指数，取值为 $0.27$。\n- 包层被视为温度为 $T$ 的等温层，并遵循理想气体定律。通过 $\\frac{dP}{dz} = -\\rho g$ 实施流体静力平衡，其中 $P$ 是压力，$z$ 是高度，$\\rho$ 是质量密度，$g$ 是局部引力加速度。结合理想气体定律 $P = \\rho R_{\\mathrm{gas}} T$（其中 $R_{\\mathrm{gas}} = \\frac{k_{\\mathrm{B}}}{\\mu m_{\\mathrm{H}}}$），可获得指数压力剖面 $P(z) = P_{\\mathrm{b}} \\exp\\left(-\\frac{z}{H}\\right)$，其中 $P_{\\mathrm{b}}$ 是包层底部（核心顶部）的压力，$H = \\frac{k_{\\mathrm{B}} T}{\\mu m_{\\mathrm{H}} g}$ 是标高。此处，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$m_{\\mathrm{H}}$ 是原子质量单位（一个氢原子的质量），$\\mu$ 是以原子质量单位表示的无量纲平均分子量。\n- 平均分子量 $\\mu$ 是使用质量分数为氢氦和重分子的混合物进行近似计算的。设氢氦组分的平均分子量为 $\\mu_{\\mathrm{HHe}}$，重分子组分的平均分子量为 $\\mu_Z$。对于重分子质量分数为 $Z_{\\mathrm{env}}$ 的情况，近似为\n$$\n\\mu(Z_{\\mathrm{env}}) = \\left( \\frac{1 - Z_{\\mathrm{env}}}{\\mu_{\\mathrm{HHe}}} + \\frac{Z_{\\mathrm{env}}}{\\mu_Z} \\right)^{-1}.\n$$\n- 光球层压力（凌日半径处的压力）固定为 $P_{\\mathrm{ph}}$。包层厚度近似为\n$$\n\\Delta R = \n\\begin{cases}\n0, & P_{\\mathrm{b}} \\le P_{\\mathrm{ph}}, \\\\\nH \\ln\\left( \\frac{P_{\\mathrm{b}}}{P_{\\mathrm{ph}}} \\right), & P_{\\mathrm{b}} > P_{\\mathrm{ph}},\n\\end{cases}\n$$\n其中 $H$ 使用表面引力 $g = \\frac{G M}{R^2}$ 和一个针对 $R$ 的迭代不动点方案进行评估，因为 $R = R_{\\mathrm{c}} + \\Delta R$ 会影响 $g$。\n- 包层质量通过流体静力柱与底部压力相关联：\n$$\nM_{\\mathrm{env}} = 4 \\pi R_{\\mathrm{c}}^2 \\frac{P_{\\mathrm{b}}}{g_{\\mathrm{b}}}\n$$\n其中 $g_{\\mathrm{b}}$ 是在底部半径处评估的引力加速度。在此模型中，为保持迭代一致性，使用评估 $H$ 时相同的 $g$ 来近似 $g_{\\mathrm{b}}$。因此，$P_{\\mathrm{b}} \\approx \\frac{M_{\\mathrm{env}} g}{4 \\pi R_{\\mathrm{c}}^2}$。\n\n算法任务是，对于给定的 $Z_{\\mathrm{env}}$，确定最小的 $f_{\\mathrm{env}}$，使得模型半径 $R = R_{\\mathrm{c}} + \\Delta R$ 大于或等于 $R_{\\mathrm{obs}}$。这应通过在物理上合理的区间 $[0, f_{\\mathrm{max}}]$ 上对 $f_{\\mathrm{env}}$ 进行单调求根和二分法来解决，其中 $f_{\\mathrm{max}}$ 是选定的上限。\n\n科学真实性要求：\n- 使用 $G$ 代表牛顿引力常数，$k_{\\mathrm{B}}$ 代表玻尔兹曼常数，$m_{\\mathrm{H}}$ 代表氢原子质量。\n- 使用 $M_\\oplus$ 和 $R_\\oplus$ 分别代表地球质量和半径来定义 $M$ 和 $R_{\\mathrm{obs}}$。\n- 使用 $\\mu_{\\mathrm{HHe}} = 2.3$ 作为典型的氢氦混合物平均分子量，$\\mu_Z = 18$ 作为代表性重分子（如水）的平均分子量，单位为原子质量单位。\n\n情景输入参数：\n- 行星总质量 $M = 5 M_\\oplus$。\n- 观测半径 $R_{\\mathrm{obs}} = 2.5 R_\\oplus$。\n- 岩石核心质量-半径指数 $\\alpha = 0.27$。\n- 用于金属丰度敏感性分析的等温包层温度 $T = 800\\,\\mathrm{K}$。\n- 光球层压力 $P_{\\mathrm{ph}} = 2.0 \\times 10^4\\,\\mathrm{Pa}$。\n- 待测试的金属丰度案例 $Z_{\\mathrm{env}} \\in \\{0.0, 0.5, 0.9\\}$。\n- 另外，包括一个 $Z_{\\mathrm{env}} = 0.0$ 和一个更冷的包层温度 $T = 400\\,\\mathrm{K}$ 的边缘案例，以探测边界条件。\n\n您的程序必须：\n- 在给定的 $f_{\\mathrm{env}}$ 和 $Z_{\\mathrm{env}}$ 下，为 $R$ 实现一个迭代不动点更新，直到收敛至一个容差（例如，$R$ 的分数变化小于 $10^{-8}$）。\n- 在每个测试案例中，对 $f_{\\mathrm{env}}$ 使用二分法来寻找使 $R \\ge R_{\\mathrm{obs}}$ 的最小包层分数，搜索区间为 $f_{\\mathrm{env}} \\in [0, 0.5]$，如果在此区间内未找到解，则返回 $f_{\\mathrm{max}}$。\n- 在所有计算中，将 $M$ 和 $R_{\\mathrm{obs}}$ 内部转换为国际单位制 (SI) 单位。\n- 将最终结果以无量纲小数分数的形式输出 $f_{\\mathrm{env}}$，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的结果，以逗号分隔的列表形式包含在方括号中，并按上述順序列出。例如，格式为 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是相应测试案例的最小 $f_{\\mathrm{env}}$，四舍五入到六位小数，并表示为无量纲小数分数。",
            "solution": "目标是估算，对于一个总质量为 $M$、观测半径为 $R_{\\mathrm{obs}}$ 的行星，在包层金属丰度为 $Z_{\\mathrm{env}}$ 的条件下，使其模型半径 $R \\ge R_{\\mathrm{obs}}$ 所需的最小包层质量分数 $f_{\\mathrm{env}}$。该模型将行星视为一个岩石核心加上一个等温理想气体包层。解决方案从流体静力平衡和理想气体定律出发，并结合岩石核心的质量-半径关系。\n\n步骤 1 (核心半径模型): 假设核心为类地成分。对于核心质量 $M_{\\mathrm{c}} = (1 - f_{\\mathrm{env}}) M$，采用一个广泛使用的幂律关系\n$$\nR_{\\mathrm{c}} = R_\\oplus \\left( \\frac{M_{\\mathrm{c}}}{M_\\oplus} \\right)^\\alpha,\n$$\n其中 $\\alpha = 0.27$ 代表岩石物质的可压缩性。此关系基于行星内部模型，并得到了跨越超级地球质量范围的类地成分的经验支持。\n\n步骤 2 (包层热力学与流体静力学): 包层在温度 $T$ 下是等温的，并遵循理想气体定律，\n$$\nP = \\rho R_{\\mathrm{gas}} T,\n$$\n其中 $R_{\\mathrm{gas}} = \\frac{k_{\\mathrm{B}}}{\\mu m_{\\mathrm{H}}}$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$m_{\\mathrm{H}}$ 是一个氢原子的质量，$\\mu$ 是以原子质量单位表示的平均分子量。流体静力平衡，\n$$\n\\frac{dP}{dz} = -\\rho g,\n$$\n与理想气体定律相结合，得出指数压力剖面，\n$$\nP(z) = P_{\\mathrm{b}} \\exp\\left(-\\frac{z}{H}\\right), \\quad H = \\frac{k_{\\mathrm{B}} T}{\\mu m_{\\mathrm{H}} g},\n$$\n其中 $H$ 是标高，$g$ 是半径 $R = R_{\\mathrm{c}} + \\Delta R$ 处的引力加速度。从底部压力 $P_{\\mathrm{b}}$ 到光球层压力 $P_{\\mathrm{ph}}$ 的包层厚度则为\n$$\n\\Delta R = \n\\begin{cases}\n0, & P_{\\mathrm{b}} \\le P_{\\mathrm{ph}}, \\\\\nH \\ln\\left( \\frac{P_{\\mathrm{b}}}{P_{\\mathrm{ph}}} \\right), & P_{\\mathrm{b}} > P_{\\mathrm{ph}}.\n\\end{cases}\n$$\n\n步骤 3 (含金属丰度的平均分子量): 包层的平均分子量是根据氢氦和重分子的质量分数估算的。对于氢氦平均分子量 $\\mu_{\\mathrm{HHe}}$ 和重分子平均分子量 $\\mu_Z$，混合物的平均分子量近似为\n$$\n\\mu(Z_{\\mathrm{env}}) = \\left( \\frac{1 - Z_{\\mathrm{env}}}{\\mu_{\\mathrm{HHe}}} + \\frac{Z_{\\mathrm{env}}}{\\mu_Z} \\right)^{-1}.\n$$\n这是通过将质量分数转换为数密度分数 $n_i \\propto \\frac{w_i}{\\mu_i}$，并将平均分子量定义为单位质量总数密度分数的倒数而得出的。\n\n步骤 4 (包层质量与底部压力): 核心上方流体静力柱的质量为 $\\Sigma = \\int_0^\\infty \\rho\\,dz = \\frac{P_{\\mathrm{b}}}{g}$。因此，覆盖在核心表面的包层质量为\n$$\nM_{\\mathrm{env}} = 4 \\pi R_{\\mathrm{c}}^2 \\Sigma = 4 \\pi R_{\\mathrm{c}}^2 \\frac{P_{\\mathrm{b}}}{g}.\n$$\n求解底部压力可得\n$$\nP_{\\mathrm{b}} = \\frac{M_{\\mathrm{env}} g}{4 \\pi R_{\\mathrm{c}}^2} = \\frac{f_{\\mathrm{env}} M g}{4 \\pi R_{\\mathrm{c}}^2}.\n$$\n该表达式将包层质量分数、引力和核心半径耦合在一起。请注意，$g = \\frac{G M}{R^2}$（其中 $R = R_{\\mathrm{c}} + \\Delta R$）本身是总半径的函数，因此需要对 $R$ 进行迭代以确保一致性。\n\n步骤 5 (半径的不动点迭代): 对于给定的 $f_{\\mathrm{env}}$ 和 $Z_{\\mathrm{env}}$，计算 $M_{\\mathrm{c}}$ 和 $R_{\\mathrm{c}}$。用 $R_{\\mathrm{c}}$ 初始化 $R$，然后迭代以下步骤直至收敛：\n- 计算 $g = \\frac{G M}{R^2}$。\n- 通过 $\\mu(Z_{\\mathrm{env}})$ 计算 $\\mu$。\n- 计算 $H = \\frac{k_{\\mathrm{B}} T}{\\mu m_{\\mathrm{H}} g}$。\n- 计算 $P_{\\mathrm{b}} = \\frac{f_{\\mathrm{env}} M g}{4 \\pi R_{\\mathrm{c}}^2}$。\n- 如果 $P_{\\mathrm{b}} > P_{\\mathrm{ph}}$，则根据 $H$ 和对数关系计算 $\\Delta R$，否则设 $\\Delta R = 0$。\n- 更新 $R \\leftarrow R_{\\mathrm{c}} + \\Delta R$ 并重复，直到 $R$ 的分数变化小于某个容差（例如，$10^{-8}$）。\n\n这个不动点方案是稳定的，因为 $\\Delta R$ 对 $g$ 和 $R$ 的变化响应平滑，并且对数函数确保了压力比的单调性。\n\n步骤 6 (包层分数的求根区间法): 将函数 $R(f_{\\mathrm{env}}; Z_{\\mathrm{env}})$ 定义为迭代方案收敛后的半径。注意以下定性行为：\n- 当 $f_{\\mathrm{env}} \\to 0$ 时，$R \\to R_{\\mathrm{c}}$，对于亚海王星目标，通常 $R  R_{\\mathrm{obs}}$，因为仅核心本身太致密了。\n- 随着 $f_{\\mathrm{env}}$ 增加，底部压力 $P_{\\mathrm{b}}$ 增加，从而增大了 $\\Delta R$。尽管随着核心质量降低 $R_{\\mathrm{c}}$ 会减小，但包层厚度通常占主导地位，导致 $R$ 增加。更高的 $Z_{\\mathrm{env}}$ 会增加 $\\mu$，这会减小标高 $H$，从而减小 $\\Delta R$，因此需要更大的 $f_{\\mathrm{env}}$ 才能达到相同的 $R_{\\mathrm{obs}}$。\n\n在 $f_{\\mathrm{env}} \\in [0, f_{\\mathrm{max}}]$（其中 $f_{\\mathrm{max}} = 0.5$）上使用二分法，找到使 $R(f_{\\mathrm{env}}; Z_{\\mathrm{env}}) \\ge R_{\\mathrm{obs}}$ 的最小分数。如果 $R(0; Z_{\\mathrm{env}}) \\ge R_{\\mathrm{obs}}$，则最小分数为 $0$。如果 $R(f_{\\mathrm{max}}; Z_{\\mathrm{env}})  R_{\\mathrm{obs}}$，则返回 $f_{\\mathrm{max}}$ 以表示该区间不足以找到解。\n\n步骤 7 (单位与常数): 使用 $M_\\oplus$ 和 $R_\\oplus$ 将 $M$ 和 $R_{\\mathrm{obs}}$ 从地球单位转换为国际单位制 (SI) 单位。使用：\n- $G$ 代表牛顿引力常数，\n- $k_{\\mathrm{B}}$ 代表玻尔兹曼常数，\n- $m_{\\mathrm{H}}$ 代表氢原子质量，\n- $\\mu_{\\mathrm{HHe}} = 2.3$，\n- $\\mu_Z = 18$，\n- $P_{\\mathrm{ph}} = 2.0 \\times 10^4\\,\\mathrm{Pa}$。\n\n步骤 8 (测试套件与输出): 评估指定的四个测试案例的最小 $f_{\\mathrm{env}}$：\n- 案例 1：$Z_{\\mathrm{env}} = 0.0$, $T = 800\\,\\mathrm{K}$。\n- 案例 2：$Z_{\\mathrm{env}} = 0.5$, $T = 800\\,\\mathrm{K}$。\n- 案例 3：$Z_{\\mathrm{env}} = 0.9$, $T = 800\\,\\mathrm{K}$。\n- 案例 4：$Z_{\\mathrm{env}} = 0.0$, $T = 400\\,\\mathrm{K}$。\n将每个结果四舍五入到六位小数，并以 $[x_1,x_2,x_3,x_4]$ 的格式单行输出，其中 $x_i$ 是无量纲小数分数。\n\n该方法通过流体静力平衡和理想气体定律将系外行星的质量-半径关系与大气结构联系起来，将包层金属丰度转化为对标高的平均分子量效应，并采用一种迭代的、物理上一致的半径计算方法，结合对包层质量分数的求根区间法。模型关于 $Z_{\\mathrm{env}}$ 的行为在物理上是直观的：更大的 $\\mu$ 会减小 $H$，从而提高了达到给定 $R_{\\mathrm{obs}}$ 所需的 $f_{\\mathrm{env}}$。低温边缘案例进一步减小了 $H$，作为一个边界条件，增加了最小分数并测试了算法的鲁棒性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nG = 6.67430e-11            # Gravitational constant, m^3 kg^-1 s^-2\nk_B = 1.380649e-23         # Boltzmann constant, J K^-1\nm_H = 1.6735575e-27        # Mass of hydrogen atom, kg\n\n# Earth reference values (SI units)\nM_EARTH = 5.9722e24        # kg\nR_EARTH = 6.371e6          # m\n\n# Model parameters\nalpha_core = 0.27          # Core mass-radius exponent for Earth-like composition\nmu_HHe = 2.3               # Mean molecular weight of H/He mixture (amu)\nmu_Z = 18.0                # Representative heavy molecule mean molecular weight (amu), e.g., H2O\nP_ph = 2.0e4               # Photospheric pressure, Pa\n\n# Target planet properties (SI units)\nM_total = 5.0 * M_EARTH\nR_obs = 2.5 * R_EARTH\n\ndef mu_mix(Z, mu_hhe=mu_HHe, muz=mu_Z):\n    \"\"\"\n    Mean molecular weight (dimensionless, in atomic mass units) for a mixture with\n    heavy-molecule mass fraction Z using mass-fraction harmonic mean:\n    1/mu = (1-Z)/mu_hhe + Z/muz\n    \"\"\"\n    return 1.0 / ((1.0 - Z) / mu_hhe + Z / muz)\n\ndef core_radius(M_core, alpha=alpha_core):\n    \"\"\"\n    Earth-like rocky core mass-radius relationship:\n    R_c = R_EARTH * (M_core / M_EARTH)^alpha\n    \"\"\"\n    if M_core = 0.0:\n        return 0.0\n    return R_EARTH * (M_core / M_EARTH) ** alpha\n\ndef model_radius(f_env, Z_env, T, M_tot=M_total, R_target_obs=R_obs, max_iter=200, tol=1e-10):\n    \"\"\"\n    Compute the self-consistent total radius for given envelope fraction f_env and metallicity Z_env.\n    Iterates gravity and scale height until radius converges.\n    \"\"\"\n    # Core mass and radius\n    M_core = max((1.0 - f_env) * M_tot, 0.0)\n    R_c = core_radius(M_core)\n\n    # Initialize radius\n    R = max(R_c, 1.0)  # avoid division by zero\n\n    # Precompute mean molecular weight\n    mu = mu_mix(Z_env)\n\n    # Fixed-point iteration\n    for _ in range(max_iter):\n        # Surface gravity at current radius\n        g = G * M_tot / (R ** 2) if R > 0 else 0.0\n\n        # Scale height\n        H = k_B * T / (mu * m_H * g) if g > 0 else 0.0\n\n        # Base pressure from envelope mass fraction\n        P_b = (f_env * M_tot * g) / (4.0 * np.pi * max(R_c, 1.0)**2) if R_c > 0 and g > 0 else 0.0\n\n        # Envelope thickness\n        if P_b = P_ph or H == 0.0:\n            delta_R = 0.0\n        else:\n            delta_R = H * np.log(P_b / P_ph)\n\n        R_new = R_c + max(delta_R, 0.0)\n\n        # Convergence check\n        if R > 0:\n            if abs(R_new - R) / R  tol:\n                R = R_new\n                break\n        if abs(R_new - R)  (tol * R_EARTH):\n            R = R_new\n            break\n\n        R = R_new\n\n    return R\n\ndef find_min_f_env(Z_env, T, M_tot=M_total, R_target_obs=R_obs, f_max=0.5, tol=1e-12, max_bisect_iter=80):\n    \"\"\"\n    Find the minimal f_env such that model_radius(f_env, Z_env, T) = R_target_obs using bisection.\n    \"\"\"\n    # Evaluate at lower bound\n    R_low = model_radius(0.0, Z_env, T, M_tot, R_target_obs)\n    if R_low >= R_target_obs:\n        return 0.0\n\n    # Evaluate at upper bound\n    R_high = model_radius(f_max, Z_env, T, M_tot, R_target_obs)\n    if R_high  R_target_obs:\n        # No solution within bracket; return f_max as indicator\n        return f_max\n\n    # Bisection\n    lo = 0.0\n    hi = f_max\n    for _ in range(max_bisect_iter):\n        mid = 0.5 * (lo + hi)\n        R_mid = model_radius(mid, Z_env, T, M_tot, R_target_obs)\n        if R_mid >= R_target_obs:\n            hi = mid\n        else:\n            lo = mid\n        if hi - lo  tol:\n            break\n\n    return hi\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Z_env, T_K)\n    test_cases = [\n        (0.0, 800.0),  # Case 1: pure H/He, nominal temperature\n        (0.5, 800.0),  # Case 2: moderate metallicity\n        (0.9, 800.0),  # Case 3: very metal-rich envelope\n        (0.0, 400.0),  # Case 4: cold-envelope edge case\n    ]\n\n    results = []\n    for Z_env, T in test_cases:\n        f_min = find_min_f_env(Z_env, T)\n        # Round to six decimal places\n        results.append(f\"{f_min:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "我们关于系外行星M-R关系的知识建立在巡天数据之上，而这些数据本身会受到探测极限的内在影响。这个高级模拟练习将超越单个天体的建模，进入族群层面的分析。通过创建一个虚拟的行星宇宙，并用模拟的凌星和径向速度巡天对其进行“观测”，这项实践将量化观测选择效应如何扭曲真实的内在质量-半径关系——这是解读系外行星统计分布的一个关键概念。",
            "id": "4166852",
            "problem": "一项模拟系外行星巡天旨在从探测到的行星中恢复岩石行星质量-半径关系的斜率，并量化由探测阈值引入的偏差。从经典力学的基本定律和理想化的测量模型出发，设计一个程序，该程序生成一个围绕类日恒星运行的岩石行星合成群体，并应用基于凌星和径向速度测量的探测标准。目标是估计恢复的质量-半径关系的对数斜率，并将其与输入斜率进行比较。\n\n假设存在一颗质量为 $M_\\star$、半径为 $R_\\star$ 的恒星，在整个巡天过程中其参数保持不变。生成一个包含 $N$ 颗岩石行星的群体，其半径 $R$ 在 $[R_{\\min}, R_{\\max}]$ 区间内呈对数均匀分布，轨道周期 $P$ 在 $[P_{\\min}, P_{\\max}]$ 区间内呈对数均匀分布。对于每颗行星，其真实质量 $M$ 通过带有内禀对数正态离散的幂律关系确定：\n$$\nM = k\\, R^{\\gamma_{\\mathrm{in}}} \\times \\exp(\\epsilon), \\quad \\epsilon \\sim \\mathcal{N}(0, \\sigma_{\\ln M}^2),\n$$\n其中 $k$ 是一个归一化常数，$\\gamma_{\\mathrm{in}}$ 是输入的对数斜率，$\\sigma_{\\ln M}$ 是内禀对数离散。\n\n使用以下物理和探测模型作为基础：\n- 牛顿二体动力学和开普勒定律决定了半长轴 $a$ 和凌星几何构型。对于一个轨道周期为 $P$、围绕质量为 $M_\\star$ 的恒星做圆形轨道运动的行星，其半长轴由下式给出：\n$$\na = \\left( \\frac{G M_\\star}{4 \\pi^2} P^2 \\right)^{1/3},\n$$\n其中 $G$ 是引力常数，$P$ 以秒为单位表示。几何凌星概率为 $p_{\\mathrm{tr}} = R_\\star / a$。\n- 在每次凌星的噪声不相关以及小行星近似的假设下，重复凌星的信噪比为\n$$\n\\mathrm{SNR}_{\\mathrm{tr}} = \\delta \\, \\frac{\\sqrt{N_{\\mathrm{tr}}}}{\\sigma_{\\mathrm{phot}}}, \\quad \\delta = \\left(\\frac{R_p}{R_\\star}\\right)^2, \\quad N_{\\mathrm{tr}} = \\frac{T_{\\mathrm{obs}}}{P},\n$$\n其中 $R_p$ 是行星半径，$\\sigma_{\\mathrm{phot}}$ 是每次凌星的相对光度噪声，$T_{\\mathrm{obs}}$ 是观测基线。如果概率为 $p_{\\mathrm{tr}}$ 的伯努利试验成功，并且 $\\mathrm{SNR}_{\\mathrm{tr}} \\ge \\mathrm{SNR}_{\\min}$，则认为该行星被凌星法探测到。\n- 对于圆形轨道且 $M \\ll M_\\star$ 的情况，径向速度 (RV) 半振幅为\n$$\nK = \\left(\\frac{2 \\pi G}{P}\\right)^{1/3} \\frac{M \\sin i}{M_\\star^{2/3}},\n$$\n对于凌星行星，$\\sin i \\approx 1$。如果 $K \\ge K_{\\min}$，则认为该行星的质量可通过径向速度法测量。为了对恢复质量中的测量不确定度进行建模，假设径向速度仪器的噪声基底 $\\sigma_{\\mathrm{RV}}$ 产生的信噪比为 $ \\mathrm{SNR}_{\\mathrm{RV}} = K / \\sigma_{\\mathrm{RV}}$，并存在一个离散度如下的对数正态测量误差：\n$$\n\\sigma_{\\ln M,\\mathrm{meas}} = \\min\\left(0.3, \\frac{1}{\\max(\\mathrm{SNR}_{\\mathrm{RV}}, 10^{-6})}\\right),\n$$\n因此，观测质量为\n$$\nM_{\\mathrm{obs}} = M \\times \\exp(\\eta), \\quad \\eta \\sim \\mathcal{N}(0, \\sigma_{\\ln M,\\mathrm{meas}}^2).\n$$\n\n从通过凌星和径向速度标准的探测样本中，通过最小二乘法在对数空间中拟合一条直线来恢复斜率，\n$$\n\\ln M_{\\mathrm{obs}} = c + \\gamma_{\\mathrm{rec}} \\ln R,\n$$\n其中 $c$ 是截距，$\\gamma_{\\mathrm{rec}}$ 是恢复的斜率。计算偏差\n$$\n\\Delta \\gamma = \\gamma_{\\mathrm{rec}} - \\gamma_{\\mathrm{in}}.\n$$\n\n所有物理量必须使用以下单位进行处理：\n- 质量 $M$ 以地球质量为单位，\n- 半径 $R$ 以地球半径为单位，\n- 周期 $P$ 以天为单位，\n- 凌星光度噪声 $\\sigma_{\\mathrm{phot}}$ 作为无量纲的分数，\n- 径向速度阈值 $K_{\\min}$ 和仪器噪声 $\\sigma_{\\mathrm{RV}}$ 以米/秒为单位，\n- 观测基线 $T_{\\mathrm{obs}}$ 以天为单位。\n角度应隐式地以弧度处理，对于凌星行星，$\\sin i \\approx 1$。\n\n你的程序必须实现以上内容，并为以下测试套件生成结果。每个测试用例由一个元组定义 $(\\gamma_{\\mathrm{in}}, k, \\sigma_{\\ln M}, K_{\\min}, \\mathrm{SNR}_{\\min}, N, R_{\\min}, R_{\\max}, P_{\\min}, P_{\\max}, T_{\\mathrm{obs}}, \\sigma_{\\mathrm{phot}}, \\sigma_{\\mathrm{RV}}, M_\\star/M_\\odot, R_\\star/R_\\odot, \\text{seed})$：\n- 测试用例 1: $(3.7, 1.0, 0.2, 1.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50\\times 10^{-6}, 1.0, 1.0, 1.0, 123)$。\n- 测试用例 2: $(3.7, 1.0, 0.2, 2.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50\\times 10^{-6}, 1.0, 1.0, 1.0, 124)$。\n- 测试用例 3: $(3.7, 1.0, 0.2, 0.5, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50\\times 10^{-6}, 1.0, 1.0, 1.0, 125)$。\n- 测试用例 4: $(3.7, 1.0, 0.0, 1.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50\\times 10^{-6}, 1.0, 1.0, 1.0, 126)$。\n\n对于每个测试用例，计算偏差 $\\Delta \\gamma$（浮点数）。你的程序应该生成单行输出，其中包含四个偏差值，形式为用方括号括起来的逗号分隔列表，例如 $[\\Delta\\gamma_1,\\Delta\\gamma_2,\\Delta\\gamma_3,\\Delta\\gamma_4]$。不应打印任何其他文本。",
            "solution": "该问题要求设计一个计算模拟程序，用以估计恢复岩石系外行星质量-半径关系斜率时产生的观测偏差。该过程基于天体力学的第一性原理和简化的天文探测技术模型。解决方案涉及合成一个行星群体，应用真实的探测过滤器，并对最终的“已探测”样本进行统计分析。\n\n解决方案的核心是为每个测试用例执行一个多步算法。所有物理量都统一转换并在国际单位制 (SI) 中处理，以确保物理定律应用的正确性，而质量和半径的最终结果则保持其指定的单位，即地球质量 ($M_\\oplus$) 和地球半径 ($R_\\oplus$) 。\n\n以下物理常数用于单位转换：\n- 引力常数: $G \\approx 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$\n- 太阳质量: $M_\\odot \\approx 1.98847 \\times 10^{30} \\, \\mathrm{kg}$\n- 太阳半径: $R_\\odot \\approx 6.957 \\times 10^8 \\, \\mathrm{m}$\n- 地球质量: $M_\\oplus \\approx 5.9722 \\times 10^{24} \\, \\mathrm{kg}$\n- 地球半径: $R_\\oplus \\approx 6.3781 \\times 10^6 \\, \\mathrm{m}$\n- 每天的秒数: $86400$\n\n算法步骤如下：\n\n1.  **行星群体合成：** 生成一个包含 $N$ 颗行星的群体。半径 $R$ 和轨道周期 $P$ 分别从区间 $[R_{\\min}, R_{\\max}]$ 和 $[P_{\\min}, P_{\\max}]$ 上的对数均匀分布中抽取。变量 $x$ 的对数均匀分布等价于其对数 $\\ln x$ 是均匀分布的。例如，对于半径 $R$，我们生成的值满足 $\\ln R \\sim \\mathcal{U}(\\ln R_{\\min}, \\ln R_{\\max})$。然后，通过指定的带有内禀对数正态离散的幂律关系，根据其半径 $R$ 为每颗行星分配真实质量 $M$：\n    $$\n    M = k\\, R^{\\gamma_{\\mathrm{in}}} \\times \\exp(\\epsilon), \\quad \\text{where } \\epsilon \\sim \\mathcal{N}(0, \\sigma_{\\ln M}^2)\n    $$\n    此处，$\\gamma_{\\mathrm{in}}$ 是双对数空间中真实的潜在斜率，$\\sigma_{\\ln M}$ 量化了给定半径下行星成分的自然多样性。所有随机过程均使用带种子的伪随机数生成器，以确保可复现性。\n\n2.  **凌星探测过滤器：** 一个两阶段过滤器模拟通过凌星法探测行星的过程。\n    - **步骤 2a：几何概率：** 为了让行星从我们的视线方向凌越其恒星，其轨道必须有正确的朝向。对于圆形轨道，这种朝向的几何概率为 $p_{\\mathrm{tr}} = R_\\star / a$，其中 $R_\\star$ 是恒星半径，$a$ 是轨道半长轴。半长轴由开普勒第三定律确定：\n      $$\n      a = \\left( \\frac{G M_\\star}{4 \\pi^2} P^2 \\right)^{1/3}\n      $$\n      其中 $M_\\star$ 是恒星质量，$P$ 是以秒为单位的轨道周期。对每颗行星进行成功概率为 $p_{\\mathrm{tr}}$ 的伯努利试验，以确定它是否发生凌星。\n    - **步骤 2b：信噪比 (SNR)：** 凌星信号必须足够强，才能在望远镜的光度噪声之上被探测到。凌星信噪比建模为：\n      $$\n      \\mathrm{SNR}_{\\mathrm{tr}} = \\delta \\, \\frac{\\sqrt{N_{\\mathrm{tr}}}}{\\sigma_{\\mathrm{phot}}}\n      $$\n      此处，$\\delta = (R/R_\\star)^2$ 是凌星深度，$N_{\\mathrm{tr}} = T_{\\mathrm{obs}}/P$ 是在持续时间为 $T_{\\mathrm{obs}}$ 的巡天期间观测到的凌星次数，$\\sigma_{\\mathrm{phot}}$ 是单次凌星的光度精度。只有 $\\mathrm{SNR}_{\\mathrm{tr}} \\ge \\mathrm{SNR}_{\\min}$ 的行星才被认为被探测到。\n\n3.  **径向速度 (RV) 证认过滤器：** 要测量行星的质量，需要进行后续测量，通常使用径向速度法。通过了凌星过滤器的行星，如果其 RV 信号特征可探测，则被视为“已证认”。对于凌星行星（其轨道倾角 $i \\approx 90^\\circ$ 且 $\\sin i \\approx 1$），RV 半振幅 K 由下式给出：\n    $$\n    K = \\left(\\frac{2 \\pi G}{P}\\right)^{1/3} \\frac{M}{M_\\star^{2/3}}\n    $$\n    如果该信号超过最小阈值，即 $K \\ge K_{\\min}$，则认为行星的质量是可测量的。\n\n4.  **质量测量不确定度：** 观测质量并非真实质量，而是受到测量误差的影响。该误差被建模为依赖于 RV 信号的强度。RV 测量的信噪比为 $\\mathrm{SNR}_{\\mathrm{RV}} = K / \\sigma_{\\mathrm{RV}}$，其中 $\\sigma_{\\mathrm{RV}}$ 是仪器的噪声基底。质量对数的不确定度则建模为：\n    $$\n    \\sigma_{\\ln M,\\mathrm{meas}} = \\min\\left(0.3, \\frac{1}{\\max(\\mathrm{SNR}_{\\mathrm{RV}}, 10^{-6})}\\right)\n    $$\n    然后，通过从以真实质量 M 为中心、具有计算出的离散度的对数正态分布中抽样，来模拟观测质量 $M_{\\mathrm{obs}}$：\n    $$\n    M_{\\mathrm{obs}} = M \\times \\exp(\\eta), \\quad \\text{where } \\eta \\sim \\mathcal{N}(0, \\sigma_{\\ln M,\\mathrm{meas}}^2)\n    $$\n    $\\max$ 函数内的 $10^{-6}$ 项是为防止除零错误的数值保护措施。\n\n5.  **质量-半径斜率的恢复与偏差计算：** 从通过所有过滤器并已模拟出观测质量的最终行星样本中，恢复质量-半径关系的斜率。这是通过对对数数据执行线性最小二乘回归来实现的：\n    $$\n    \\ln M_{\\mathrm{obs}} = c + \\gamma_{\\mathrm{rec}} \\ln R\n    $$\n    最佳拟合线的斜率即为恢复的斜率 $\\gamma_{\\mathrm{rec}}$。探测偏差则被量化为该恢复斜率与真实的输入斜率之差：\n    $$\n    \\Delta \\gamma = \\gamma_{\\mathrm{rec}} - \\gamma_{\\mathrm{in}}\n    $$\n此过程被封装在一个程序中，该程序遍历所提供的测试用例（每个用例都有一套独特的参数），并计算相应的偏差 $\\Delta \\gamma$。该实现严重依赖 NumPy 库提供的矢量化操作，以便对庞大的行星群体进行高效计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the exoplanet detection bias simulation for the given test cases.\n    \"\"\"\n    # Physical constants in SI units\n    M_SUN_KG = 1.98847e30\n    R_SUN_M = 6.957e8\n    M_EARTH_KG = 5.9722e24\n    R_EARTH_M = 6.3781e6\n    G_SI = 6.67430e-11  # m^3 kg^-1 s^-2\n    DAY_S = 86400.0\n\n    test_cases = [\n        # (gamma_in, k, sigma_ln_M, K_min, SNR_min, N, R_min, R_max, P_min, P_max, T_obs, sigma_phot, sigma_RV, M_star/M_sun, R_star/R_sun, seed)\n        (3.7, 1.0, 0.2, 1.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50e-6, 1.0, 1.0, 1.0, 123),\n        (3.7, 1.0, 0.2, 2.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50e-6, 1.0, 1.0, 1.0, 124),\n        (3.7, 1.0, 0.2, 0.5, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50e-6, 1.0, 1.0, 1.0, 125),\n        (3.7, 1.0, 0.0, 1.0, 7.0, 200000, 0.5, 1.8, 2.0, 100.0, 1095.0, 50e-6, 1.0, 1.0, 1.0, 126),\n    ]\n\n    results = []\n\n    for params in test_cases:\n        gamma_in, k, sigma_ln_M, K_min, SNR_min, N, R_min, R_max, P_min, P_max, T_obs, sigma_phot, sigma_RV, M_star_msun, R_star_rsun, seed = params\n\n        rng = np.random.default_rng(seed)\n\n        # 1. Generate Planet Population\n        log_R_earth = rng.uniform(np.log(R_min), np.log(R_max), N)\n        R_earth = np.exp(log_R_earth)  # In Earth radii\n        log_P_days = rng.uniform(np.log(P_min), np.log(P_max), N)\n        P_days = np.exp(log_P_days)    # In days\n\n        # 2. Assign True Mass\n        epsilon = rng.normal(0, sigma_ln_M, N)\n        M_true_earth = k * (R_earth ** gamma_in) * np.exp(epsilon)  # In Earth masses\n\n        # Convert to SI for physics calculations\n        M_star_kg = M_star_msun * M_SUN_KG\n        R_star_m = R_star_rsun * R_SUN_M\n        P_s = P_days * DAY_S\n        R_m = R_earth * R_EARTH_M\n        M_true_kg = M_true_earth * M_EARTH_KG\n\n        # 3. Apply Detection Filters\n        # 3a. Transit Geometric Probability\n        a_m = ((G_SI * M_star_kg * P_s**2) / (4 * np.pi**2))**(1.0/3.0)\n        p_tr = np.clip(R_star_m / a_m, 0, 1)\n        \n        # Bernoulli trial for transit geometry\n        is_transiting_idx = np.where(rng.random(N)  p_tr)[0]\n        \n        if is_transiting_idx.size == 0:\n            results.append(0.0)\n            continue\n            \n        # 3b. Transit SNR\n        N_tr = T_obs / P_days[is_transiting_idx]\n        delta = (R_m[is_transiting_idx] / R_star_m)**2\n        SNR_tr = delta * np.sqrt(N_tr) / sigma_phot\n        \n        passes_snr_mask = SNR_tr >= SNR_min\n        passes_snr_idx = is_transiting_idx[passes_snr_mask]\n        \n        if passes_snr_idx.size == 0:\n            results.append(0.0)\n            continue\n            \n        # 3c. RV Confirmation\n        K_ms = ((2 * np.pi * G_SI) / P_s[passes_snr_idx])**(1.0/3.0) * M_true_kg[passes_snr_idx] / (M_star_kg**(2.0/3.0))\n        \n        passes_rv_mask = K_ms >= K_min\n        detected_idx = passes_snr_idx[passes_rv_mask]\n        \n        if detected_idx.size  2:\n            results.append(0.0) # Cannot fit a line with  2 points\n            continue\n\n        # 4. Model Mass Measurement Uncertainty\n        K_detected_ms = K_ms[passes_rv_mask]\n        SNR_rv = K_detected_ms / sigma_RV\n        \n        sigma_ln_M_meas = np.minimum(0.3, 1.0 / np.maximum(SNR_rv, 1e-6))\n        \n        eta = rng.normal(0, 1.0, detected_idx.size) * sigma_ln_M_meas\n        \n        M_obs_earth = M_true_earth[detected_idx] * np.exp(eta)\n        \n        # 5. Recover Slope and Calculate Bias\n        R_detected_earth = R_earth[detected_idx]\n        log_R_det = np.log(R_detected_earth)\n        log_M_obs = np.log(M_obs_earth)\n        \n        # Linear regression using numpy.polyfit\n        gamma_rec, _ = np.polyfit(log_R_det, log_M_obs, 1)\n        \n        delta_gamma = gamma_rec - gamma_in\n        results.append(delta_gamma)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}