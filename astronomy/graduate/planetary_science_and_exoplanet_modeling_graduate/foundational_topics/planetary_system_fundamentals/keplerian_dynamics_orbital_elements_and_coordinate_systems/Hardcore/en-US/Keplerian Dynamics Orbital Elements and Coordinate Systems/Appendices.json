{
    "hands_on_practices": [
        {
            "introduction": "Mastering Keplerian dynamics begins with a firm grasp of the orbit's fundamental geometry. The polar equation of an ellipse, which relates an object's distance $r$ from its star to its angular position or true anomaly $f$, is a cornerstone of this field. This exercise  provides hands-on practice in inverting this relationship to determine where an object is in its orbit based on its distance, a crucial skill for calculating ephemerides and understanding orbital motion.",
            "id": "4166339",
            "problem": "A bound exoplanet orbits a star under Newtonian gravity in a fixed plane. Use an inertial polar coordinate system in the orbital plane with origin at the star (focus) and the polar angle $f$ measured from periapsis (the true anomaly). The orbit is elliptical with semimajor axis $a$ and eccentricity $e$, with $0 \\le e  1$. Starting from first principles appropriate to central-force motion and the definition of the true anomaly, derive an expression for the true anomaly $f$ at which the radial distance equals a specified value $r^{\\ast}$, in terms of $a$, $e$, and $r^{\\ast}$. Carefully discuss the multiplicity of solutions as a function of $r^{\\ast}$, including all degenerate cases that can occur for $e=0$ and for extreme radii. Then, for the concrete case $a=1.5\\,\\mathrm{AU}$, $e=0.3$, and $r^{\\ast}=1.5\\,\\mathrm{AU}$, compute all admissible values of $f$ in radians. Express both values of $f$ in radians and round each to $5$ significant figures. If there are two branches, present both values in increasing order of $f$.",
            "solution": "The problem asks for the derivation of an expression for the true anomaly $f$ at a specified radial distance $r^{\\ast}$ for a body in an elliptical Keplerian orbit, a discussion of the number of possible solutions, and a specific numerical calculation.\n\nThe foundation of this problem lies in the solution to the two-body problem under a central, inverse-square gravitational force. Starting from Newton's law of universal gravitation, the equation of motion for the relative position vector $\\vec{r}$ of the planet with respect to the star is solved. The solution for the trajectory, expressed in a polar coordinate system $(r, f)$ with the origin at the central star (one of the foci of the ellipse) and the angle $f$ (the true anomaly) measured from the direction of periapsis, is given by the conic section equation:\n$$r(f) = \\frac{p}{1 + e \\cos(f)}$$\nwhere $e$ is the eccentricity of the orbit and $p$ is the semi-latus rectum. For a bound, elliptical orbit, the eccentricity is in the range $0 \\le e  1$. The semi-latus rectum $p$ is related to the semi-major axis $a$ and the eccentricity $e$ by the formula $p = a(1 - e^2)$. Substituting this into the orbit equation gives the standard form for an elliptical orbit:\n$$r(f) = \\frac{a(1 - e^2)}{1 + e \\cos(f)}$$\n\nTo find the true anomaly $f$ at which the radial distance is a specified value $r^{\\ast}$, we set $r = r^{\\ast}$ in this equation:\n$$r^{\\ast} = \\frac{a(1 - e^2)}{1 + e \\cos(f)}$$\nOur goal is to solve this equation for $f$. We begin by isolating the term $\\cos(f)$:\n$$1 + e \\cos(f) = \\frac{a(1 - e^2)}{r^{\\ast}}$$\n$$e \\cos(f) = \\frac{a(1 - e^2)}{r^{\\ast}} - 1$$\nAssuming $e \\neq 0$, we can divide by $e$ to obtain the expression for $\\cos(f)$:\n$$\\cos(f) = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right)$$\nThe true anomaly $f$ can then be found by taking the arccosine of this expression. Since the cosine function is even, $\\cos(f) = \\cos(-f)$, and periodic with period $2\\pi$, for a given value of $\\cos(f)$ in the range $(-1, 1)$, there are two solutions for $f$ in the interval $[0, 2\\pi)$. If we let $C = \\frac{1}{e} \\left( \\frac{a(1-e^2)}{r^{\\ast}} - 1 \\right)$, then the solutions are:\n$$f = \\pm \\arccos\\left[ \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right) \\right]$$\nConventionally, the true anomaly is taken in the range $[0, 2\\pi)$. If $f_1 = \\arccos(C)$ is the principal value (which lies in $[0, \\pi]$), then the two unique solutions in $[0, 2\\pi)$ are $f_1$ and $f_2 = 2\\pi - f_1$.\n\nNext, we discuss the multiplicity of solutions. The existence of real solutions for $f$ depends on the value of $C$, which must be in the range $[-1, 1]$. The allowed range of radial distances in an elliptical orbit is from the periapsis distance, $r_p = a(1-e)$, to the apoapsis distance, $r_a = a(1+e)$.\n\n1.  **Intermediate Radii ($r_p  r^{\\ast}  r_a$):**\n    For any radius $r^{\\ast}$ strictly between the minimum and maximum values, it can be shown that $-1  C  1$. In this case, $\\arccos(C)$ is well-defined and yields a value in $(0, \\pi)$. This gives **two distinct solutions** for $f$ in $[0, 2\\pi)$, corresponding to the two points on the ellipse (symmetric with respect to the major axis) that share the same radial distance from the focus.\n\n2.  **Extreme Radii ($r^{\\ast} = r_p$ or $r^{\\ast} = r_a$):**\n    If $r^{\\ast} = r_p = a(1-e)$, then\n    $$C = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{a(1-e)} - 1 \\right) = \\frac{1}{e} \\left( (1+e) - 1 \\right) = 1$$\n    This gives $\\cos(f)=1$, so $f=0$. There is **one unique solution** in $[0, 2\\pi)$. This is the periapsis.\n    If $r^{\\ast} = r_a = a(1+e)$, then\n    $$C = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{a(1+e)} - 1 \\right) = \\frac{1}{e} \\left( (1-e) - 1 \\right) = -1$$\n    This gives $\\cos(f)=-1$, so $f=\\pi$. There is **one unique solution** in $[0, 2\\pi)$. This is the apoapsis.\n\n3.  **Unreachable Radii ($r^{\\ast}  r_p$ or $r^{\\ast} > r_a$):**\n    If $r^{\\ast}$ is outside the physical bounds of the orbit, it can be shown that $|C| > 1$. In this case, there is **no real solution** for $f$, as expected.\n\n4.  **Degenerate Case: Circular Orbit ($e=0$):**\n    If the orbit is circular, $e=0$. Our derived expression for $\\cos(f)$ involves division by $e$ and is thus singular. We must return to the orbit equation: $r(f) = a(1-0^2)/(1+0) = a$. The radius is constant.\n    - If the specified radius $r^{\\ast}$ equals $a$, then the condition $r^{\\ast}=a$ is met for **all values of $f$**. The solution is indeterminate. It should be noted that for a perfect circle, the concept of a unique periapsis is ill-defined; any point can be chosen as the reference for $f=0$.\n    - If $r^{\\ast} \\neq a$, the condition is never met, and there are **no solutions** for $f$.\n\nNow, we perform the specific calculation for the case $a=1.5\\,\\mathrm{AU}$, $e=0.3$, and $r^{\\ast}=1.5\\,\\mathrm{AU}$.\nFirst, we note that $r^{\\ast} = a$. This is a special case. The periapsis and apoapsis distances are:\n$r_p = a(1-e) = 1.5(1-0.3) = 1.5(0.7) = 1.05\\,\\mathrm{AU}$\n$r_a = a(1+e) = 1.5(1+0.3) = 1.5(1.3) = 1.95\\,\\mathrm{AU}$\nSince $1.05  1.5  1.95$, the distance $r^{\\ast}=1.5\\,\\mathrm{AU}$ is reachable, and we expect two distinct solutions for $f$.\n\nWe use the derived formula for $\\cos(f)$:\n$$\\cos(f) = \\frac{1}{e} \\left( \\frac{a(1 - e^2)}{r^{\\ast}} - 1 \\right)$$\nSubstituting the given values, and noting that $a/r^{\\ast} = 1$:\n$$\\cos(f) = \\frac{1}{0.3} \\left( \\frac{1.5(1 - 0.3^2)}{1.5} - 1 \\right)$$\n$$\\cos(f) = \\frac{1}{0.3} \\left( (1 - 0.09) - 1 \\right) = \\frac{1}{0.3} (-0.09)$$\n$$\\cos(f) = -0.3$$\nThe two solutions for $f$ in the interval $[0, 2\\pi)$ are given by $f_1 = \\arccos(-0.3)$ and $f_2 = 2\\pi - \\arccos(-0.3)$.\nWe now compute the numerical values in radians.\n$$f_1 = \\arccos(-0.3) \\approx 1.87548898... \\,\\mathrm{rad}$$\n$$f_2 = 2\\pi - f_1 \\approx 6.28318530... - 1.87548898... \\approx 4.40769632... \\,\\mathrm{rad}$$\nRounding each value to $5$ significant figures:\n$$f_1 \\approx 1.8755 \\,\\mathrm{rad}$$\n$$f_2 \\approx 4.4077 \\,\\mathrm{rad}$$\nThese are the two admissible values of the true anomaly $f$, presented in increasing order. Geometrically, these correspond to the points where the orbit intersects the semi-minor axis.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.8755  4.4077 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While orbital geometry describes the path, predicting an object's motion requires relating its position to time. This involves solving the celebrated Kepler's equation, which connects the smoothly flowing mean anomaly $M(t)$ to the physical position via the eccentric and true anomalies. This comprehensive practice  guides you through building a complete radial velocity model from first principles, including the vital numerical task of accounting for finite exposure times, which can \"smear\" the instantaneous velocity signal in real observations.",
            "id": "4166315",
            "problem": "Consider a single, non-interacting, star–planet two-body system modeled by Keplerian dynamics. The orbit is bound and elliptical with orbital period $P$, eccentricity $e$, argument of periastron $\\omega$, and mean anomaly at reference epoch $M_0$. The systemic line-of-sight velocity of the stellar barycenter is $\\gamma$. Assume the orbital plane is fixed and the orbital elements are defined in the standard way for osculating Keplerian elements. Angles must be treated in radians.\n\nStarting from the fundamental laws and core definitions of Keplerian motion and Newtonian two-body dynamics, implement the following in a program:\n\n1. Use the mean motion $n$ and the mean anomaly $M(t)$ at time $t$ defined by $n = 2\\pi/P$ and $M(t) = M_0 + n\\,t$. Solve Kepler’s equation $M(t) = E(t) - e \\sin E(t)$ for the eccentric anomaly $E(t)$ for each time $t$ in the observing window. Then map $E(t)$ to the true anomaly $f(t)$ through the standard relation between eccentric and true anomalies. Do not assume any small-$e$ approximation; the solution must be robust for $0 \\le e  1$.\n\n2. Construct the line-of-sight stellar radial velocity as a function of time, $v_r(t)$, by projecting the orbital motion into the observer’s line-of-sight using the orbital elements. Adopt a fixed semi-amplitude $K = 4.0$ meters per second for all test cases, and include the systemic velocity $\\gamma$ additively. Express all velocities in meters per second and all times in days. Angles must be in radians.\n\n3. Model finite integration time effects for each exposure by computing the time-averaged velocity over each exposure window of duration $\\Delta t$, namely the value\n$$\\bar{v}_r = \\frac{1}{\\Delta t}\\int_{t_{\\mathrm{start}}}^{t_{\\mathrm{start}}+\\Delta t} v_r(t)\\,dt.$$\nFor each test case, define a sequence of exposure start times spanning a specified observing window and compute, for each exposure, both the averaged velocity $\\bar{v}_r$ and the instantaneous velocity evaluated at the exposure midpoint $v_r(t_{\\mathrm{start}} + \\Delta t/2)$. For each test case, report the maximum absolute difference (in meters per second) between these two values across all exposures in the window:\n$$D_{\\max} = \\max_{\\text{exposures}} \\left|\\bar{v}_r - v_r\\!\\left(t_{\\mathrm{start}}+\\frac{\\Delta t}{2}\\right)\\right|.$$\nReturn $D_{\\max}$ as a floating-point number in meters per second for each test case.\n\nYou must implement a numerically stable solver for Kepler’s equation and a numerically accurate time-integration routine for the averaging. You must not assume any special-case simplifications for $e=0$ or near-parabolic regimes; the implementation must be uniformly valid for all test cases as specified.\n\nPhysical units and angle units:\n- Period $P$ and all times are in days.\n- Velocities must be expressed in meters per second.\n- All angles ($\\omega$, $M_0$, and anomalies) must be in radians.\n\nTest suite:\nProvide results for the following four parameter sets. For each, construct the specified observing window and exposures, compute $D_{\\max}$, and include it in the final output list.\n\n- Case 1 (moderate eccentricity, short exposures):\n  - $P = 7.0$ days, $e = 0.3$, $\\omega = 1.0$ radians, $M_0 = 0.5$ radians, $\\gamma = 2.0$ meters per second.\n  - Observing window: total duration $T = 3.0$ days.\n  - Exposure cadence: start times at $t = 0, 0.5, 1.0, 1.5, 2.0, 2.5$ days.\n  - Exposure duration: $\\Delta t = 0.25$ days.\n\n- Case 2 (circular orbit, long exposures relative to cadence):\n  - $P = 3.0$ days, $e = 0.0$, $\\omega = 2.0$ radians, $M_0 = 1.0$ radians, $\\gamma = -1.0$ meters per second.\n  - Observing window: total duration $T = 3.0$ days.\n  - Exposure cadence: start times at $t = 0, 0.6, 1.2, 1.8, 2.4$ days.\n  - Exposure duration: $\\Delta t = 0.6$ days.\n\n- Case 3 (high eccentricity, very short exposures):\n  - $P = 10.0$ days, $e = 0.85$, $\\omega = 0.3$ radians, $M_0 = 1.4$ radians, $\\gamma = 5.0$ meters per second.\n  - Observing window: total duration $T = 10.0$ days.\n  - Exposure cadence: start times at $t = 0, 1, 2, \\ldots, 9$ days (integer days).\n  - Exposure duration: $\\Delta t = 0.05$ days.\n\n- Case 4 (short period, substantial exposure duration):\n  - $P = 1.0$ day, $e = 0.5$, $\\omega = 1.2$ radians, $M_0 = 0.1$ radians, $\\gamma = 0.0$ meters per second.\n  - Observing window: total duration $T = 1.5$ days.\n  - Exposure cadence: start times at $t = 0, 0.5, 1.0$ days.\n  - Exposure duration: $\\Delta t = 0.5$ days.\n\nFinal output format:\nYour program should produce a single line of output containing the four $D_{\\max}$ values corresponding to the above cases, as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each value must be a floating-point number in meters per second. Angles must be treated in radians throughout and no other text should be printed.",
            "solution": "The problem requires the calculation of the maximum discrepancy between the time-averaged stellar radial velocity over a finite exposure and the instantaneous velocity at the exposure's midpoint. This discrepancy arises from the non-linear variation of the radial velocity during the exposure time, an effect often termed \"velocity smearing.\" The solution involves modeling the Keplerian orbit, solving for the star's motion, and performing numerical integration. The entire process can be broken down into a sequence of steps derived from the fundamental principles of two-body dynamics.\n\nFirst, we define the time-dependent state of the planet in its orbit. The mean motion, $n$, is the average angular speed, defined as $n = 2\\pi/P$, where $P$ is the orbital period. The mean anomaly, $M(t)$, represents the angle a fictitious body moving at a constant angular speed $n$ would have. It is given by $M(t) = M_0 + n \\cdot t$, where $M_0$ is the mean anomaly at the reference epoch $t=0$.\n\nThe position of the body in an elliptical orbit is described by the eccentric anomaly, $E(t)$. The relationship between mean anomaly and eccentric anomaly is given by Kepler's equation:\n$$M(t) = E(t) - e \\sin(E(t))$$\nHere, $e$ is the orbital eccentricity. This is a transcendental equation for $E(t)$ and does not have a general closed-form solution. We must solve it numerically. A robust and efficient method is the Newton-Raphson iteration. To find the root of the function $g(E) = E - e \\sin(E) - M = 0$, we use the iterative scheme:\n$$E_{k+1} = E_k - \\frac{g(E_k)}{g'(E_k)} = E_k - \\frac{E_k - e\\sin(E_k) - M}{1 - e\\cos(E_k)}$$\nStarting with an initial guess, typically $E_0 = M$, the iteration converges rapidly to the correct value of $E$ for a given $M$ and $e \\in [0, 1)$.\n\nOnce the eccentric anomaly $E(t)$ is found, we can determine the true anomaly, $f(t)$, which is the actual angle between the position of the planet and the point of periastron, as seen from the focus of the ellipse. The relationship between $E$ and $f$ is given by:\n$$\\tan\\left(\\frac{f}{2}\\right) = \\sqrt{\\frac{1+e}{1-e}} \\tan\\left(\\frac{E}{2}\\right)$$\nFor numerical stability and to correctly handle all quadrants, it is preferable to compute $f(t)$ using the two-argument arctangent function, $\\operatorname{atan2}(y, x)$:\n$$f(t) = \\operatorname{atan2}\\left(\\sqrt{1-e^2}\\sin(E(t)), \\cos(E(t)) - e\\right)$$\n\nThe primary observable is the star's radial velocity, $v_r(t)$, which is the component of its orbital velocity along the observer's line-of-sight. The standard model for the radial velocity, as a function of the orbital elements and true anomaly, is:\n$$v_r(t) = K(\\cos(\\omega + f(t))) + \\gamma$$\nIn this expression, $K$ is the velocity semi-amplitude, $\\omega$ is the argument of periastron (the angle from the ascending node to the periastron), and $\\gamma$ is the systemic velocity of the star-planet system's barycenter. A fixed semi-amplitude $K = 4.0 \\, \\text{m/s}$ is used for all cases.\n\nThe problem then requires us to model the effect of a finite exposure time, $\\Delta t$. The measured velocity for an exposure starting at $t_{\\mathrm{start}}$ is not an instantaneous value but an average over the interval $[t_{\\mathrm{start}}, t_{\\mathrm{start}}+\\Delta t]$. This time-averaged velocity, $\\bar{v}_r$, is defined by the integral:\n$$\\bar{v}_r = \\frac{1}{\\Delta t}\\int_{t_{\\mathrm{start}}}^{t_{\\mathrm{start}}+\\Delta t} v_r(t)\\,dt$$\nSince $v_r(t)$ has a complex dependency on time through the anomalies, this integral must be computed numerically. A high-accuracy numerical quadrature method is suitable for this task.\n\nFor comparison, we also compute the instantaneous velocity at the midpoint of the exposure, $t_{\\mathrm{mid}} = t_{\\mathrm{start}} + \\Delta t/2$, which is $v_r(t_{\\mathrm{mid}})$. The core task is to find the maximum absolute difference, $D_{\\max}$, between these two quantities over a series of specified exposures:\n$$D_{\\max} = \\max_{\\text{exposures}} \\left|\\bar{v}_r - v_r\\left(t_{\\mathrm{mid}}\\right)\\right|$$\n\nThe overall algorithm for each test case is as follows:\n1.  Given the parameters $P$, $e$, $\\omega$, $M_0$, $\\gamma$, and the observing schedule (a set of $t_{\\mathrm{start}}$ values and a fixed $\\Delta t$).\n2.  Initialize a variable for the maximum difference, $D_{\\max} = 0$.\n3.  For each exposure start time $t_{\\mathrm{start}}$ in the schedule:\n    a. Define the full time-dependent radial velocity function, $v_r(t)$, which involves solving Kepler's equation for any given $t$.\n    b. Compute the midpoint velocity $v_r(t_{\\mathrm{mid}})$ by evaluating this function at $t_{\\mathrm{mid}} = t_{\\mathrm{start}} + \\Delta t/2$.\n    c. Compute the averaged velocity $\\bar{v}_r$ by numerically integrating $v_r(t)$ from $t_{\\mathrm{start}}$ to $t_{\\mathrm{start}} + \\Delta t$ and dividing the result by $\\Delta t$.\n    d. Calculate the difference $|\\bar{v}_r - v_r(t_{\\mathrm{mid}})|$.\n    e. Update $D_{\\max}$ to be the maximum of its current value and this new difference.\n4.  After iterating through all exposures, the final value of $D_{\\max}$ is the result for the given test case. This procedure is repeated for all four parameter sets provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the maximum difference between time-averaged and midpoint-instantaneous\n    radial velocity for several exoplanet systems.\n    \"\"\"\n\n    # The semi-amplitude K is fixed for all test cases as per the problem statement.\n    K_ms = 4.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing the orbital parameters and observing schedule.\n    test_cases = [\n        # Case 1: moderate eccentricity, short exposures\n        {\n            \"P_days\": 7.0, \"e\": 0.3, \"omega_rad\": 1.0, \"M0_rad\": 0.5, \"gamma_ms\": 2.0,\n            \"t_starts_days\": [0.0, 0.5, 1.0, 1.5, 2.0, 2.5],\n            \"delta_t_days\": 0.25\n        },\n        # Case 2: circular orbit, long exposures relative to cadence\n        {\n            \"P_days\": 3.0, \"e\": 0.0, \"omega_rad\": 2.0, \"M0_rad\": 1.0, \"gamma_ms\": -1.0,\n            \"t_starts_days\": [0.0, 0.6, 1.2, 1.8, 2.4],\n            \"delta_t_days\": 0.6\n        },\n        # Case 3: high eccentricity, very short exposures\n        {\n            \"P_days\": 10.0, \"e\": 0.85, \"omega_rad\": 0.3, \"M0_rad\": 1.4, \"gamma_ms\": 5.0,\n            \"t_starts_days\": np.arange(0.0, 10.0, 1.0),\n            \"delta_t_days\": 0.05\n        },\n        # Case 4: short period, substantial exposure duration\n        {\n            \"P_days\": 1.0, \"e\": 0.5, \"omega_rad\": 1.2, \"M0_rad\": 0.1, \"gamma_ms\": 0.0,\n            \"t_starts_days\": [0.0, 0.5, 1.0],\n            \"delta_t_days\": 0.5\n        }\n    ]\n\n    def solve_kepler(M, e):\n        \"\"\"\n        Solves Kepler's equation M = E - e*sin(E) for E using Newton-Raphson method.\n        \n        Args:\n            M (float): Mean anomaly in radians.\n            e (float): Eccentricity.\n            \n        Returns:\n            float: Eccentric anomaly E in radians.\n        \"\"\"\n        if e == 0.0:\n            return M\n        \n        # Initial guess for E\n        E = M\n        \n        # Iterate using Newton-Raphson until desired precision is reached.\n        for _ in range(100): # Max 100 iterations is a safe limit\n            f_E = E - e * np.sin(E) - M\n            fp_E = 1 - e * np.cos(E)\n            delta_E = f_E / fp_E\n            E = E - delta_E\n            if np.abs(delta_E)  1e-12:\n                break\n        return E\n\n    def calculate_vr(t, P, e, omega, M0, gamma, K):\n        \"\"\"\n        Calculates the instantaneous radial velocity at a given time t.\n        \n        Args:\n            t (float): Time in days.\n            P (float): Period in days.\n            e (float): Eccentricity.\n            omega (float): Argument of periastron in radians.\n            M0 (float): Mean anomaly at epoch in radians.\n            gamma (float): Systemic velocity in m/s.\n            K (float): Velocity semi-amplitude in m/s.\n            \n        Returns:\n            float: Instantaneous radial velocity in m/s.\n        \"\"\"\n        # Calculate mean motion\n        n = 2 * np.pi / P\n        \n        # Calculate mean anomaly at time t\n        M = M0 + n * t\n        \n        # Solve Kepler's equation for eccentric anomaly E\n        E = solve_kepler(M, e)\n        \n        # Calculate true anomaly f from E\n        # Use atan2 for numerical stability and correct quadrant\n        f = np.arctan2(np.sqrt(1 - e**2) * np.sin(E), np.cos(E) - e)\n        \n        # Calculate radial velocity\n        vr = K * (np.cos(omega + f)) + gamma\n        \n        return vr\n\n    results = []\n    for case in test_cases:\n        P = case[\"P_days\"]\n        e = case[\"e\"]\n        omega = case[\"omega_rad\"]\n        M0 = case[\"M0_rad\"]\n        gamma = case[\"gamma_ms\"]\n        delta_t = case[\"delta_t_days\"]\n        t_starts = case[\"t_starts_days\"]\n        \n        max_diff = 0.0\n        \n        # Define the arguments for the radial velocity function\n        vr_args = (P, e, omega, M0, gamma, K_ms)\n\n        for t_start in t_starts:\n            # Time at the midpoint of the exposure\n            t_mid = t_start + delta_t / 2.0\n            \n            # 1. Calculate instantaneous velocity at the midpoint\n            vr_mid = calculate_vr(t_mid, *vr_args)\n            \n            # 2. Calculate time-averaged velocity over the exposure\n            # Use scipy.integrate.quad for high-precision numerical integration\n            integral_val, _ = quad(calculate_vr, t_start, t_start + delta_t, args=vr_args)\n            vr_avg = integral_val / delta_t\n            \n            # 3. Compute the absolute difference and update the maximum\n            current_diff = np.abs(vr_avg - vr_mid)\n            if current_diff > max_diff:\n                max_diff = current_diff\n                \n        results.append(max_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A key challenge in astrophysics is inverting observational data to uniquely determine a system's physical parameters, but this is not always possible due to geometric degeneracies. This exercise  explores a classic degeneracy in astrometry where different orbital orientations can project onto the sky in identical ways. It powerfully demonstrates how combining sky-plane motion with line-of-sight velocity data can break this ambiguity, revealing the true three-dimensional nature of the system.",
            "id": "4166325",
            "problem": "Consider a star’s reflex motion induced by a single planet in a two-body Keplerian system. Let the star’s orbit about the system barycenter be specified by the classical orbital elements: semi-major axis $a$, eccentricity $e$, inclination $i$, longitude of the ascending node $\\Omega$, argument of periastron $\\omega$, orbital period $P$, and time of periastron passage $T_{\\mathrm{p}}$. The apparent astrometric motion measured on the sky consists of the two coordinates in the plane of the sky, which we denote by $(x,y)$, defined with respect to a right-handed inertial frame in which $\\hat{z}$ lies along the observer’s line of sight. The mapping from the perifocal frame (in which the orbit lies in the $z=0$ plane and the true anomaly is $f$) to the $(x,y,z)$ frame is obtained by a sequence of three rigid rotations determined by $(\\Omega,i,\\omega)$ and applied to the instantaneous position and velocity vectors.\n\nFrom first principles of rigid-body rotations and the definition of the perifocal basis, analyze the effect of the transformation $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ on the sky-plane astrometric coordinates $(x,y)$ at all epochs and on the line-of-sight component of the velocity $v_{z}$. Use only the properties of rotation matrices and their action on vectors confined to the perifocal plane to argue whether the astrometric solution exhibits a degeneracy under this transformation and whether the sign of $v_{z}$ changes. Then assess how auxiliary Radial Velocity (RV) information, which measures the time series of $v_{z}(t)$ relative to the barycenter, breaks or does not break this degeneracy.\n\nWhich of the following statements are correct?\n\nA. Pure astrometric position fitting in the plane of the sky is invariant under $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ for any values of $e$ and $i$, because the projected coordinates $(x(t),y(t))$ are unchanged at all epochs.\n\nB. The predicted line-of-sight velocity $v_{z}(t)$ changes sign under $(\\Omega,\\omega)\\rightarrow(\\Omega+\\pi,\\omega+\\pi)$ while its amplitude and timing remain the same, so a joint astrometry+RV fit selects a unique $(\\Omega,\\omega)$ up to the intrinsic labeling of the ascending node.\n\nC. The degeneracy can be removed using sky-plane proper motion curvature alone, without RV, provided a sufficiently long astrometric time baseline is available, because the sense of motion along the apparent ellipse uniquely identifies the ascending node.\n\nD. A single contemporaneous measurement of the sign of $v_{z}$ at a known true anomaly $f$ (or equivalently at a known epoch tied to $T_{\\mathrm{p}}$) is sufficient to distinguish between $(\\Omega,\\omega)$ and $(\\Omega+\\pi,\\omega+\\pi)$.\n\nE. For a perfectly circular orbit with $e=0$, the pair $(\\Omega,\\omega)$ is ill-defined and therefore the $(\\Omega,\\omega)\\leftrightarrow(\\Omega+\\pi,\\omega+\\pi)$ degeneracy does not arise in astrometric fits.",
            "solution": "This problem analyzes a classic degeneracy in orbital mechanics where two different spatial orientations of an orbit produce the same projection onto the plane of the sky. We must determine how the transformation $(\\Omega, \\omega) \\rightarrow (\\Omega+\\pi, \\omega+\\pi)$ affects the observable astrometric position $(x, y)$ and the line-of-sight velocity $v_z$.\n\nLet the star's position vector in its orbital plane (the perifocal frame) be $\\vec{r}_{\\text{peri}}(t)$, which depends on the true anomaly $f(t)$. This vector is transformed into the observer's frame $(\\vec{r}_{\\text{obs}} = (x, y, z)^T)$ via a rotation matrix $R$ determined by the orientation angles $(\\Omega, i, \\omega)$. The standard rotation is $R = R_z(\\Omega)R_x(i)R_z(\\omega)$.\n\nUnder the transformation $(\\Omega, \\omega) \\rightarrow (\\Omega', \\omega') = (\\Omega+\\pi, \\omega+\\pi)$, the new rotation matrix becomes:\n$$ R' = R_z(\\Omega+\\pi) R_x(i) R_z(\\omega+\\pi) $$\nUsing the property that a rotation by $\\pi$ corresponds to multiplication by $R_z(\\pi) = \\text{diag}(-1, -1, 1)$, we can show that $R' = R_z(\\pi) R R_z(\\pi)$. The new observed position vector is:\n$$ \\vec{r}'_{\\text{obs}} = R' \\vec{r}_{\\text{peri}} = \\left( R_z(\\pi) R R_z(\\pi) \\right) \\vec{r}_{\\text{peri}} $$\nSince the perifocal vector has no $z$-component, $R_z(\\pi) \\vec{r}_{\\text{peri}} = -\\vec{r}_{\\text{peri}}$. This leads to a remarkably simple result:\n$$ \\vec{r}'_{\\text{obs}} = -R_z(\\pi) (R \\vec{r}_{\\text{peri}}) = -R_z(\\pi) \\vec{r}_{\\text{obs}} = - \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} x \\\\ y \\\\ -z \\end{pmatrix} $$\nThis shows that the astrometric coordinates on the sky are unchanged, $(x'(t), y'(t)) = (x(t), y(t))$, while the line-of-sight coordinate is inverted, $z'(t) = -z(t)$. Consequently, the line-of-sight velocity also inverts:\n$$ v'_z(t) = \\frac{d z'}{dt} = -\\frac{d z}{dt} = -v_z(t) $$\n\nWith these results, we can evaluate each statement:\n\n**A. Correct.** As derived, the projected coordinates $(x(t), y(t))$ are identical under the transformation. Therefore, a fit based purely on astrometric position data cannot distinguish between the two models, leading to a perfect degeneracy.\n\n**B. Correct.** The line-of-sight velocity $v_z(t)$ flips its sign. Observed RV data will match the sign of only one of the two degenerate models, thus breaking the degeneracy and uniquely identifying the true orientation (i.e., identifying which node is the ascending node).\n\n**C. Incorrect.** The proper motion on the sky, $(\\dot{x}(t), \\dot{y}(t))$, and any higher time derivatives (curvature) are also identical for both models, since the position functions $x(t)$ and $y(t)$ are identical. The sense of motion (clockwise vs. counter-clockwise) is also unchanged. Therefore, astrometric data alone, regardless of its duration or precision, cannot resolve the ambiguity.\n\n**D. Correct.** Since the two models predict RV curves with opposite signs ($v_{z,1}(t)$ and $v_{z,2}(t) = -v_{z,1}(t)$), a single RV measurement is sufficient to break the degeneracy, as long as it is not taken at a moment when $v_z(t) = 0$. Comparing the sign of the measured RV to the two predictions will immediately rule out one model.\n\n**E. Incorrect.** This geometric degeneracy is a property of the projection and is independent of the eccentricity. It persists for circular orbits ($e=0$). While $\\omega$ becomes ill-defined, its role is absorbed into the argument of latitude $u = \\omega + f$, and the transformation still results in an identical sky projection with a flipped RV curve.\n\nTherefore, statements A, B, and D are correct.",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}